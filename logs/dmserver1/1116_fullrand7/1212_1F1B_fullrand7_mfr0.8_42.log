
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 12. (ê¸ˆ) 23:11:20 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1212_1F1B_fullrand7_mfr0.8_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.8) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-12 23:11:27,317 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank3]:2025-12-12 23:11:27,331 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank0]:2025-12-12 23:11:27,436 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:"
[rank1]:2025-12-12 23:11:27,433 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:"
[rank2]:2025-12-12 23:11:27,531 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-12 23:11:27,544 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-12 23:11:27,576 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 23:11:27,578 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 23:11:27,696 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-12 23:11:27,698 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 23:11:27,701 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-12 23:11:27,702 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-12-12 23:11:27,687 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 23:11:27,689 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 23:11:28,100 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-12 23:11:30,888 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-12 23:11:30,819 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-12 23:11:30,857 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 23:11:30,884 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-12 23:11:30,884 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 23:11:31,038 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 23:11:31,081 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 23:11:31,082 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-12 23:11:31,107 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-12 23:11:31,107 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-12 23:11:31,071 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 23:11:31,071 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-12 23:11:31,072 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-12 23:11:31,302 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 23:11:31,302 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 23:11:31,303 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-12 23:11:31,269 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-12 23:11:31,308 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 23:11:31,336 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-12 23:11:31,336 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 23:11:31,520 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 23:11:31,520 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-12 23:11:31,521 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run btr34ojs
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.8_42_dm1/20251212-2311/wandb/run-20251212_231131-btr34ojs
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/btr34ojs
[rank3]:2025-12-12 23:11:33,115 - INFO - WandB logging enabled
[rank3]:2025-12-12 23:11:33,115 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-12 23:11:33,152 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 23:11:33,185 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-12 23:11:33,185 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-12 23:11:33,374 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 23:11:33,375 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-12 23:11:33,376 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-12 23:11:33,393 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 23:11:33,393 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank0]:2025-12-12 23:11:33,393 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 23:11:33,394 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-12 23:11:33,394 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-12 23:11:33,393 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-12 23:11:33,393 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 23:11:35,196 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-12 23:11:35,196 - INFO - Finished loading the checkpoint in 1.80 seconds.
[rank0]:2025-12-12 23:11:35,196 - INFO - Training starts at step 1
[rank0]:2025-12-12 23:11:40,824 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  9.19GiB(19.34%)  tps: 3,363  tflops: 26.29  mfu: 8.43%
[rank0]:2025-12-12 23:11:40,824 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 23:11:40,798 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5372  memory: 12.97GiB(27.31%)  tps: 4,287  tflops: 33.52  mfu: 10.74%
[rank3]:2025-12-12 23:11:40,799 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-12 23:11:40,787 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  4.63GiB(9.75%)  tps: 3,300  tflops: 25.80  mfu: 8.27%
[rank2]:2025-12-12 23:11:40,788 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 23:11:40,790 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  6.76GiB(14.24%)  tps: 3,456  tflops: 27.02  mfu: 8.66%
[rank1]:2025-12-12 23:11:40,790 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 23:13:42,859 - INFO - Avg. fwd time: 13.2770 / Avg. bwd time: 41.6692 / Avg. batch time: 512.0588 (ms) / GPU bubble ratio: 14.16%
[rank2]:2025-12-12 23:13:42,884 - INFO - Avg. fwd time: 7.2814 / Avg. bwd time: 18.9452 / Avg. batch time: 544.1484 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-12-12 23:13:42,912 - INFO - Avg. fwd time: 9.3957 / Avg. bwd time: 23.9345 / Avg. batch time: 583.1032 (ms) / GPU bubble ratio: 54.27%
[rank0]:2025-12-12 23:13:42,941 - INFO - Avg. fwd time: 7.3252 / Avg. bwd time: 23.5622 / Avg. batch time: 620.2002 (ms) / GPU bubble ratio: 60.16%
[rank0]:2025-12-12 23:15:45,673 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 23:15:50,669 - INFO - Avg. fwd time: 13.3692 / Avg. bwd time: 41.8436 / Avg. batch time: 514.0919 (ms) / GPU bubble ratio: 14.08%
[rank1]:2025-12-12 23:15:50,721 - INFO - Avg. fwd time: 9.4053 / Avg. bwd time: 23.9857 / Avg. batch time: 584.4300 (ms) / GPU bubble ratio: 54.29%
[rank2]:2025-12-12 23:15:50,693 - INFO - Avg. fwd time: 7.2748 / Avg. bwd time: 18.9847 / Avg. batch time: 545.7824 (ms) / GPU bubble ratio: 61.51%
[rank0]:2025-12-12 23:15:50,750 - INFO - Avg. fwd time: 7.3279 / Avg. bwd time: 23.5948 / Avg. batch time: 621.1696 (ms) / GPU bubble ratio: 60.17%
[rank1]:2025-12-12 23:15:50,775 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7093  memory:  9.03GiB(19.01%)  tps: 6,423  tflops: 50.21  mfu: 16.09%
[rank2]:2025-12-12 23:15:50,771 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7093  memory:  6.43GiB(13.53%)  tps: 6,423  tflops: 50.21  mfu: 16.09%
[rank3]:2025-12-12 23:15:50,783 - INFO -  step: 50  loss:  9.9083  grad_norm: 12.7093  memory: 16.39GiB(34.50%)  tps: 6,423  tflops: 50.21  mfu: 16.09%
[rank0]:2025-12-12 23:15:50,785 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7093  memory: 12.97GiB(27.31%)  tps: 6,424  tflops: 50.22  mfu: 16.09%
[rank3]:2025-12-12 23:16:41,827 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-12 23:17:33,122 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-12 23:17:33,249 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-12-12 23:17:50,374 - INFO - Avg. fwd time: 9.5157 / Avg. bwd time: 23.1415 / Avg. batch time: 573.1950 (ms) / GPU bubble ratio: 54.42%
[rank2]:2025-12-12 23:17:50,358 - INFO - Avg. fwd time: 7.3718 / Avg. bwd time: 18.3137 / Avg. batch time: 535.5142 (ms) / GPU bubble ratio: 61.63%
[rank3]:2025-12-12 23:17:50,344 - INFO - Avg. fwd time: 13.4697 / Avg. bwd time: 40.5684 / Avg. batch time: 504.6537 (ms) / GPU bubble ratio: 14.34%
[rank0]:2025-12-12 23:17:50,379 - INFO - Avg. fwd time: 7.4112 / Avg. bwd time: 22.0500 / Avg. batch time: 608.2139 (ms) / GPU bubble ratio: 61.25%
[rank3]:2025-12-12 23:18:07,476 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-12 23:18:07,660 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2318_max_batch_time.svg
[rank3]:			> Batch Time: 537.99 ms, GPU Bubble Ratio: 53.90%, 50.40%, 60.92%, 17.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-30ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-207ms    | [S0,MB2,B]  232-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  288-23-312ms   | [S0,MB7,F]  312-6-319ms    | [S0,MB4,B]  344-23-367ms   | [S0,MB5,B]  401-23-424ms   | [S0,MB6,B]  458-23-481ms   | [S0,MB7,B]  514-23-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  208-24-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  264-24-288ms   | [S1,MB6,F]  288-9-297ms    | [S1,MB4,B]  319-24-344ms   | [S1,MB7,F]  344-9-353ms    | [S1,MB5,B]  377-24-401ms   | [S1,MB6,B]  434-23-458ms   | [S1,MB7,B]  490-23-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  208-6-215ms    | [S2,MB3,B]  245-19-264ms   | [S2,MB5,F]  264-6-271ms    | [S2,MB4,B]  300-19-319ms   | [S2,MB6,F]  319-7-326ms    | [S2,MB5,B]  358-19-377ms   | [S2,MB7,F]  377-7-384ms    | [S2,MB6,B]  415-19-434ms   | [S2,MB7,B]  471-19-490ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-189ms   AFR(10):0.9655 | [S3,MB3,F]  189-13-202ms   | [S3,MB3,B]  202-42-245ms   AFR(10):0.9655 | [S3,MB4,F]  245-13-258ms   | [S3,MB4,B]  258-41-300ms   AFR(10):0.9655 | [S3,MB5,F]  300-14-315ms   | [S3,MB5,B]  315-42-358ms   AFR(10):0.9655 | [S3,MB6,F]  358-13-371ms   | [S3,MB6,B]  371-43-415ms   AFR(10):0.9655 | [S3,MB7,F]  415-13-429ms   | [S3,MB7,B]  429-42-471ms   AFR(10):0.9655
[rank3]:2025-12-12 23:18:07,799 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2318_min_batch_time.svg
[rank3]:			> Batch Time: 328.82 ms, GPU Bubble Ratio: 82.28%, 50.83%, 61.59%, 14.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-30ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-157ms    | [S0,MB3,B]  185-0-185ms    | [S0,MB7,F]  185-6-192ms    | [S0,MB4,B]  220-0-220ms    | [S0,MB5,B]  257-0-257ms    | [S0,MB6,B]  293-0-293ms    | [S0,MB7,B]  328-0-328ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-124ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-9-159ms    | [S1,MB3,B]  174-11-185ms   | [S1,MB6,F]  185-9-195ms    | [S1,MB4,B]  209-11-220ms   | [S1,MB7,F]  220-9-230ms    | [S1,MB5,B]  246-11-257ms   | [S1,MB6,B]  282-10-293ms   | [S1,MB7,B]  318-10-328ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  63-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-6-111ms    | [S2,MB2,B]  130-8-139ms    | [S2,MB4,F]  139-6-146ms    | [S2,MB3,B]  166-8-174ms    | [S2,MB5,F]  174-6-181ms    | [S2,MB4,B]  201-8-209ms    | [S2,MB6,F]  209-7-216ms    | [S2,MB5,B]  238-8-246ms    | [S2,MB7,F]  246-7-253ms    | [S2,MB6,B]  273-8-282ms    | [S2,MB7,B]  309-8-318ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-63ms     AFR(10):0.9655 | [S3,MB1,F]  63-10-74ms     | [S3,MB1,B]  74-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-109ms    | [S3,MB2,B]  109-21-130ms   AFR(10):0.9655 | [S3,MB3,F]  130-13-144ms   | [S3,MB3,B]  144-21-166ms   AFR(10):0.9655 | [S3,MB4,F]  166-13-179ms   | [S3,MB4,B]  179-21-201ms   AFR(10):0.9655 | [S3,MB5,F]  201-14-215ms   | [S3,MB5,B]  215-22-238ms   AFR(10):0.9655 | [S3,MB6,F]  238-13-252ms   | [S3,MB6,B]  252-21-273ms   AFR(10):0.9655 | [S3,MB7,F]  273-13-287ms   | [S3,MB7,B]  287-21-309ms   AFR(10):0.9655
[rank3]:2025-12-12 23:18:07,954 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2318_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 358.95 ms, GPU Bubble Ratio: 40.74%, 29.32%, 44.35%, 13.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-30ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  169-23-193ms   | [S0,MB5,F]  193-6-200ms    | [S0,MB2,B]  204-23-227ms   | [S0,MB6,F]  227-6-234ms    | [S0,MB3,B]  239-23-263ms   | [S0,MB7,F]  263-6-269ms    | [S0,MB4,B]  274-23-298ms   | [S0,MB5,B]  311-23-335ms   | [S0,MB6,B]  346-12-358ms   | [S0,MB7,B]  358-0-358ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  145-24-169ms   | [S1,MB4,F]  169-9-178ms    | [S1,MB2,B]  180-24-204ms   | [S1,MB5,F]  204-9-213ms    | [S1,MB3,B]  215-24-239ms   | [S1,MB6,F]  239-9-248ms    | [S1,MB4,B]  250-24-274ms   | [S1,MB7,F]  274-9-283ms    | [S1,MB5,B]  287-24-311ms   | [S1,MB6,B]  322-23-346ms   | [S1,MB7,B]  348-10-358ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  126-19-145ms   | [S2,MB3,F]  145-6-152ms    | [S2,MB2,B]  161-19-180ms   | [S2,MB4,F]  180-6-187ms    | [S2,MB3,B]  196-19-215ms   | [S2,MB5,F]  215-6-222ms    | [S2,MB4,B]  231-19-250ms   | [S2,MB6,F]  250-7-257ms    | [S2,MB5,B]  268-19-287ms   | [S2,MB7,F]  287-7-294ms    | [S2,MB6,B]  303-19-322ms   | [S2,MB7,B]  339-8-348ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-32-126ms    AFR(10):0.9655 | [S3,MB2,F]  126-13-139ms   | [S3,MB2,B]  139-21-161ms   AFR(10):0.9655 | [S3,MB3,F]  161-13-174ms   | [S3,MB3,B]  174-21-196ms   AFR(10):0.9655 | [S3,MB4,F]  196-13-209ms   | [S3,MB4,B]  209-21-231ms   AFR(10):0.9655 | [S3,MB5,F]  231-14-246ms   | [S3,MB5,B]  246-22-268ms   AFR(10):0.9655 | [S3,MB6,F]  268-13-282ms   | [S3,MB6,B]  282-21-303ms   AFR(10):0.9655 | [S3,MB7,F]  303-13-317ms   | [S3,MB7,B]  317-21-339ms   AFR(10):0.9655
[rank3]:2025-12-12 23:18:07,955 - INFO - 	> Batch Time: 358.95 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.33)
[rank0]:2025-12-12 23:19:30,387 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 23:19:34,998 - INFO - Avg. fwd time: 7.4759 / Avg. bwd time: 17.6005 / Avg. batch time: 513.1745 (ms) / GPU bubble ratio: 60.91%
[rank2]:2025-12-12 23:19:35,004 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank3]:2025-12-12 23:19:34,974 - INFO - Avg. fwd time: 13.6276 / Avg. bwd time: 37.6547 / Avg. batch time: 482.6336 (ms) / GPU bubble ratio: 15.00%
[rank3]:2025-12-12 23:19:34,979 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.10(0.13)/0.40, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-12 23:19:35,052 - INFO - Avg. fwd time: 7.5467 / Avg. bwd time: 19.4513 / Avg. batch time: 583.0294 (ms) / GPU bubble ratio: 62.95%
[rank0]:2025-12-12 23:19:35,059 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-12 23:19:35,027 - INFO - Avg. fwd time: 9.6469 / Avg. bwd time: 22.0870 / Avg. batch time: 550.0236 (ms) / GPU bubble ratio: 53.84%
[rank1]:2025-12-12 23:19:35,034 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-12 23:19:35,077 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.9833  memory:  9.36GiB(19.71%)  tps: 7,304  tflops: 57.10  mfu: 18.30%
[rank2]:2025-12-12 23:19:35,073 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.9833  memory:  6.51GiB(13.70%)  tps: 7,304  tflops: 57.10  mfu: 18.30%
[rank3]:2025-12-12 23:19:35,086 - INFO -  step: 100  loss:  8.7570  grad_norm:  5.9833  memory: 16.88GiB(35.53%)  tps: 7,304  tflops: 57.10  mfu: 18.30%
[rank0]:2025-12-12 23:19:35,088 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.9833  memory: 12.97GiB(27.31%)  tps: 7,304  tflops: 57.10  mfu: 18.30%
[rank0]:2025-12-12 23:19:35,146 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251212_2319_stage0_step100.svg
[rank1]:2025-12-12 23:19:35,145 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251212_2319_stage1_step100.svg
[rank2]:2025-12-12 23:19:35,147 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251212_2319_stage2_step100.svg
[rank3]:2025-12-12 23:19:35,225 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2319_real_step100_rank3.svg
[rank3]:			> Batch Time: 572.31 ms, GPU Bubble Ratio: 62.90%, 54.52%, 64.04%, 30.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  127-16-143ms   | [S0,MB4,F]  144-7-151ms    | [S0,MB1,B]  189-16-206ms   | [S0,MB5,F]  206-6-212ms    | [S0,MB2,B]  253-16-269ms   | [S0,MB6,F]  269-6-276ms    | [S0,MB3,B]  317-16-334ms   | [S0,MB7,F]  334-6-340ms    | [S0,MB4,B]  380-23-404ms   | [S0,MB5,B]  442-23-466ms   | [S0,MB6,B]  499-19-519ms   | [S0,MB7,B]  553-19-572ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-45ms      | [S1,MB0,B]  101-21-122ms   | [S1,MB3,F]  125-9-135ms    | [S1,MB1,B]  163-21-184ms   | [S1,MB4,F]  187-9-197ms    | [S1,MB2,B]  226-21-248ms   | [S1,MB5,F]  251-9-260ms    | [S1,MB3,B]  288-24-312ms   | [S1,MB6,F]  316-9-325ms    | [S1,MB4,B]  351-24-375ms   | [S1,MB7,F]  379-9-388ms    | [S1,MB5,B]  415-24-439ms   | [S1,MB6,B]  472-24-496ms   | [S1,MB7,B]  525-23-549ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  79-16-95ms     | [S2,MB2,F]  99-7-106ms     | [S2,MB1,B]  141-16-158ms   | [S2,MB3,F]  161-6-168ms    | [S2,MB2,B]  202-19-221ms   | [S2,MB4,F]  225-7-232ms    | [S2,MB3,B]  264-19-283ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB4,B]  326-19-346ms   | [S2,MB6,F]  349-7-356ms    | [S2,MB5,B]  391-19-410ms   | [S2,MB7,F]  413-7-420ms    | [S2,MB6,B]  450-19-469ms   | [S2,MB7,B]  503-18-521ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-25-74ms     | [S3,MB1,F]  77-13-91ms     | [S3,MB1,B]  96-40-137ms    | [S3,MB2,F]  140-11-152ms   | [S3,MB2,B]  157-39-197ms   | [S3,MB3,F]  201-14-215ms   | [S3,MB3,B]  220-38-259ms   | [S3,MB4,F]  262-13-276ms   | [S3,MB4,B]  283-38-321ms   | [S3,MB5,F]  325-13-338ms   | [S3,MB5,B]  345-40-386ms   | [S3,MB6,F]  389-13-403ms   | [S3,MB6,B]  408-36-445ms   | [S3,MB7,F]  448-15-463ms   | [S3,MB7,B]  470-30-500ms  
[rank3]:2025-12-12 23:19:35,268 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251212_2319_stage3_step100.svg
[rank1]:2025-12-12 23:21:32,453 - INFO - Avg. fwd time: 9.6326 / Avg. bwd time: 22.1404 / Avg. batch time: 547.1786 (ms) / GPU bubble ratio: 53.55%
[rank2]:2025-12-12 23:21:32,425 - INFO - Avg. fwd time: 7.4604 / Avg. bwd time: 17.7084 / Avg. batch time: 510.2236 (ms) / GPU bubble ratio: 60.54%
[rank3]:2025-12-12 23:21:32,401 - INFO - Avg. fwd time: 13.6721 / Avg. bwd time: 37.1978 / Avg. batch time: 479.6092 (ms) / GPU bubble ratio: 15.15%
[rank0]:2025-12-12 23:21:32,477 - INFO - Avg. fwd time: 7.5591 / Avg. bwd time: 19.5667 / Avg. batch time: 580.2634 (ms) / GPU bubble ratio: 62.60%
[rank0]:2025-12-12 23:23:18,430 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-12 23:23:22,786 - INFO - Avg. fwd time: 9.6558 / Avg. bwd time: 21.9583 / Avg. batch time: 539.6262 (ms) / GPU bubble ratio: 53.13%
[rank1]:2025-12-12 23:23:22,793 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-12 23:23:22,735 - INFO - Avg. fwd time: 13.7402 / Avg. bwd time: 36.1388 / Avg. batch time: 472.3061 (ms) / GPU bubble ratio: 15.51%
[rank3]:2025-12-12 23:23:22,740 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.27)/0.40, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-12 23:23:22,758 - INFO - Avg. fwd time: 7.4708 / Avg. bwd time: 17.6268 / Avg. batch time: 502.7380 (ms) / GPU bubble ratio: 60.06%
[rank2]:2025-12-12 23:23:22,764 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank0]:2025-12-12 23:23:22,813 - INFO - Avg. fwd time: 7.6116 / Avg. bwd time: 19.3445 / Avg. batch time: 572.6113 (ms) / GPU bubble ratio: 62.34%
[rank0]:2025-12-12 23:23:22,821 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 23:23:22,850 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.8332  memory: 13.29GiB(27.97%)  tps: 7,193  tflops: 56.24  mfu: 18.02%
[rank1]:2025-12-12 23:23:22,839 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.8332  memory:  9.36GiB(19.71%)  tps: 7,193  tflops: 56.24  mfu: 18.02%
[rank3]:2025-12-12 23:23:22,847 - INFO -  step: 150  loss:  4.1424  grad_norm:  3.8332  memory: 17.37GiB(36.56%)  tps: 7,194  tflops: 56.24  mfu: 18.02%
[rank2]:2025-12-12 23:23:22,835 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.8332  memory:  6.51GiB(13.70%)  tps: 7,193  tflops: 56.24  mfu: 18.02%
[rank2]:2025-12-12 23:25:07,852 - INFO - Avg. fwd time: 7.4802 / Avg. bwd time: 17.5748 / Avg. batch time: 493.9161 (ms) / GPU bubble ratio: 59.42%
[rank3]:2025-12-12 23:25:07,828 - INFO - Avg. fwd time: 13.8094 / Avg. bwd time: 34.9467 / Avg. batch time: 463.5591 (ms) / GPU bubble ratio: 15.86%
[rank1]:2025-12-12 23:25:07,879 - INFO - Avg. fwd time: 9.6892 / Avg. bwd time: 21.7248 / Avg. batch time: 530.7224 (ms) / GPU bubble ratio: 52.65%
[rank0]:2025-12-12 23:25:07,902 - INFO - Avg. fwd time: 7.6579 / Avg. bwd time: 18.9395 / Avg. batch time: 563.3653 (ms) / GPU bubble ratio: 62.23%
[rank0]:2025-12-12 23:26:46,378 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 23:26:50,398 - INFO - Avg. fwd time: 7.5034 / Avg. bwd time: 17.4311 / Avg. batch time: 485.8677 (ms) / GPU bubble ratio: 58.94%
[rank2]:2025-12-12 23:26:50,404 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank3]:2025-12-12 23:26:50,375 - INFO - Avg. fwd time: 13.8774 / Avg. bwd time: 33.8934 / Avg. batch time: 455.7093 (ms) / GPU bubble ratio: 16.14%
[rank3]:2025-12-12 23:26:50,380 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.38(0.40)/0.40, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 23:26:50,426 - INFO - Avg. fwd time: 9.7299 / Avg. bwd time: 21.4530 / Avg. batch time: 522.5647 (ms) / GPU bubble ratio: 52.26%
[rank1]:2025-12-12 23:26:50,433 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 23:26:50,475 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.6309  memory:  9.36GiB(19.71%)  tps: 7,891  tflops: 61.69  mfu: 19.77%
[rank2]:2025-12-12 23:26:50,471 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.6309  memory:  6.51GiB(13.70%)  tps: 7,891  tflops: 61.69  mfu: 19.77%
[rank3]:2025-12-12 23:26:50,480 - INFO -  step: 200  loss:  1.5965  grad_norm:  1.6309  memory: 17.37GiB(36.56%)  tps: 7,891  tflops: 61.69  mfu: 19.77%
[rank0]:2025-12-12 23:26:50,449 - INFO - Avg. fwd time: 7.7101 / Avg. bwd time: 18.3036 / Avg. batch time: 554.8697 (ms) / GPU bubble ratio: 62.49%
[rank0]:2025-12-12 23:26:50,457 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-12 23:26:50,486 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.6309  memory: 13.29GiB(27.97%)  tps: 7,891  tflops: 61.69  mfu: 19.77%
[rank1]:2025-12-12 23:26:50,535 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251212_2326_stage1_step200.svg
[rank2]:2025-12-12 23:26:50,536 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251212_2326_stage2_step200.svg
[rank0]:2025-12-12 23:26:50,535 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251212_2326_stage0_step200.svg
[rank3]:2025-12-12 23:26:50,623 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2326_real_step200_rank3.svg
[rank3]:			> Batch Time: 486.52 ms, GPU Bubble Ratio: 65.51%, 51.00%, 60.58%, 34.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  107-4-112ms    | [S0,MB4,F]  112-8-120ms    | [S0,MB1,B]  170-4-175ms    | [S0,MB5,F]  175-6-181ms    | [S0,MB2,B]  235-4-240ms    | [S0,MB6,F]  240-6-247ms    | [S0,MB3,B]  295-4-300ms    | [S0,MB7,F]  300-6-306ms    | [S0,MB4,B]  342-23-366ms   | [S0,MB5,B]  387-23-411ms   | [S0,MB6,B]  431-18-449ms   | [S0,MB7,B]  469-17-486ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  89-12-102ms    | [S1,MB3,F]  105-10-116ms   | [S1,MB1,B]  152-12-165ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  217-12-230ms   | [S1,MB5,F]  233-8-242ms    | [S1,MB3,B]  265-24-290ms   | [S1,MB6,F]  293-9-303ms    | [S1,MB4,B]  312-24-337ms   | [S1,MB7,F]  341-9-350ms    | [S1,MB5,B]  359-24-383ms   | [S1,MB6,B]  403-24-428ms   | [S1,MB7,B]  444-21-466ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  75-8-84ms      | [S2,MB2,F]  88-8-96ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  193-19-212ms   | [S2,MB4,F]  216-7-223ms    | [S2,MB3,B]  241-19-260ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  288-19-307ms   | [S2,MB6,F]  311-7-318ms    | [S2,MB5,B]  334-19-354ms   | [S2,MB7,F]  357-7-364ms    | [S2,MB6,B]  380-19-399ms   | [S2,MB7,B]  424-16-440ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-22-70ms     | [S3,MB1,F]  74-13-87ms     | [S3,MB1,B]  93-39-133ms    | [S3,MB2,F]  137-11-149ms   | [S3,MB2,B]  155-33-188ms   | [S3,MB3,F]  191-15-207ms   | [S3,MB3,B]  213-22-236ms   | [S3,MB4,F]  239-14-254ms   | [S3,MB4,B]  260-22-283ms   | [S3,MB5,F]  286-14-301ms   | [S3,MB5,B]  307-22-329ms   | [S3,MB6,F]  333-14-347ms   | [S3,MB6,B]  353-21-375ms   | [S3,MB7,F]  379-14-393ms   | [S3,MB7,B]  399-21-421ms  
[rank3]:2025-12-12 23:26:50,666 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251212_2326_stage3_step200.svg
[rank2]:2025-12-12 23:28:28,924 - INFO - Avg. fwd time: 7.5252 / Avg. bwd time: 17.2973 / Avg. batch time: 477.3789 (ms) / GPU bubble ratio: 58.40%
[rank3]:2025-12-12 23:28:28,900 - INFO - Avg. fwd time: 13.9369 / Avg. bwd time: 32.8053 / Avg. batch time: 447.3729 (ms) / GPU bubble ratio: 16.41%
[rank1]:2025-12-12 23:28:28,951 - INFO - Avg. fwd time: 9.7704 / Avg. bwd time: 21.1902 / Avg. batch time: 513.9570 (ms) / GPU bubble ratio: 51.81%
[rank0]:2025-12-12 23:28:28,974 - INFO - Avg. fwd time: 7.7551 / Avg. bwd time: 17.4401 / Avg. batch time: 545.9462 (ms) / GPU bubble ratio: 63.08%
[rank0]:2025-12-12 23:30:03,257 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 23:30:07,086 - INFO - Avg. fwd time: 13.9864 / Avg. bwd time: 31.9258 / Avg. batch time: 440.6455 (ms) / GPU bubble ratio: 16.65%
[rank3]:2025-12-12 23:30:07,091 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-12 23:30:07,177 - INFO -  step: 250  loss:  1.2135  grad_norm:  0.5681  memory: 17.37GiB(36.56%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank1]:2025-12-12 23:30:07,138 - INFO - Avg. fwd time: 9.8029 / Avg. bwd time: 20.9809 / Avg. batch time: 506.9583 (ms) / GPU bubble ratio: 51.42%
[rank1]:2025-12-12 23:30:07,145 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 23:30:07,161 - INFO - Avg. fwd time: 7.7901 / Avg. bwd time: 16.7311 / Avg. batch time: 538.6931 (ms) / GPU bubble ratio: 63.58%
[rank0]:2025-12-12 23:30:07,169 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 23:30:07,110 - INFO - Avg. fwd time: 7.5419 / Avg. bwd time: 17.1923 / Avg. batch time: 470.4828 (ms) / GPU bubble ratio: 57.94%
[rank2]:2025-12-12 23:30:07,116 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 23:30:07,187 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5681  memory:  9.36GiB(19.71%)  tps: 8,329  tflops: 65.11  mfu: 20.87%
[rank0]:2025-12-12 23:30:07,197 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5681  memory: 13.29GiB(27.97%)  tps: 8,329  tflops: 65.11  mfu: 20.87%
[rank2]:2025-12-12 23:30:07,183 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5681  memory:  6.51GiB(13.70%)  tps: 8,329  tflops: 65.11  mfu: 20.87%
[rank3]:2025-12-12 23:31:46,890 - INFO - Avg. fwd time: 14.0235 / Avg. bwd time: 31.2985 / Avg. batch time: 435.8630 (ms) / GPU bubble ratio: 16.81%
[rank2]:2025-12-12 23:31:46,914 - INFO - Avg. fwd time: 7.5550 / Avg. bwd time: 17.1062 / Avg. batch time: 465.5577 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-12-12 23:31:46,941 - INFO - Avg. fwd time: 9.8274 / Avg. bwd time: 20.8110 / Avg. batch time: 501.9827 (ms) / GPU bubble ratio: 51.17%
[rank0]:2025-12-12 23:31:46,965 - INFO - Avg. fwd time: 7.8163 / Avg. bwd time: 16.1646 / Avg. batch time: 533.4932 (ms) / GPU bubble ratio: 64.04%
[rank0]:2025-12-12 23:33:22,811 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 23:33:26,749 - INFO - Avg. fwd time: 14.0527 / Avg. bwd time: 30.7810 / Avg. batch time: 431.9043 (ms) / GPU bubble ratio: 16.96%
[rank3]:2025-12-12 23:33:26,754 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 23:33:26,801 - INFO - Avg. fwd time: 9.8471 / Avg. bwd time: 20.6695 / Avg. batch time: 497.8638 (ms) / GPU bubble ratio: 50.96%
[rank1]:2025-12-12 23:33:26,808 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 23:33:26,850 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4884  memory:  9.36GiB(19.71%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank2]:2025-12-12 23:33:26,773 - INFO - Avg. fwd time: 7.5659 / Avg. bwd time: 17.0351 / Avg. batch time: 461.4819 (ms) / GPU bubble ratio: 57.35%
[rank2]:2025-12-12 23:33:26,779 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 23:33:26,847 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4884  memory:  6.51GiB(13.70%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank0]:2025-12-12 23:33:26,825 - INFO - Avg. fwd time: 7.8381 / Avg. bwd time: 15.6907 / Avg. batch time: 529.1884 (ms) / GPU bubble ratio: 64.43%
[rank0]:2025-12-12 23:33:26,833 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 23:33:26,861 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4884  memory: 13.29GiB(27.97%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank3]:2025-12-12 23:33:26,856 - INFO -  step: 300  loss:  0.5428  grad_norm:  0.4884  memory: 17.37GiB(36.56%)  tps: 8,205  tflops: 64.14  mfu: 20.56%
[rank1]:2025-12-12 23:33:26,910 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251212_2333_stage1_step300.svg
[rank2]:2025-12-12 23:33:26,910 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251212_2333_stage2_step300.svg
[rank0]:2025-12-12 23:33:26,910 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251212_2333_stage0_step300.svg
[rank3]:2025-12-12 23:33:26,999 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2333_real_step300_rank3.svg
[rank3]:			> Batch Time: 484.77 ms, GPU Bubble Ratio: 69.55%, 51.84%, 60.44%, 34.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  233-0-233ms    | [S0,MB6,F]  233-6-239ms    | [S0,MB3,B]  294-0-294ms    | [S0,MB7,F]  294-6-301ms    | [S0,MB4,B]  341-23-365ms   | [S0,MB5,B]  386-23-409ms   | [S0,MB6,B]  430-18-448ms   | [S0,MB7,B]  468-16-484ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  217-10-227ms   | [S1,MB5,F]  231-8-240ms    | [S1,MB3,B]  264-24-289ms   | [S1,MB6,F]  293-9-302ms    | [S1,MB4,B]  311-24-336ms   | [S1,MB7,F]  340-9-349ms    | [S1,MB5,B]  357-24-382ms   | [S1,MB6,B]  401-24-426ms   | [S1,MB7,B]  442-21-463ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  192-19-211ms   | [S2,MB4,F]  215-7-222ms    | [S2,MB3,B]  240-19-259ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  287-19-306ms   | [S2,MB6,F]  310-7-317ms    | [S2,MB5,B]  333-19-352ms   | [S2,MB7,F]  356-7-363ms    | [S2,MB6,B]  379-19-398ms   | [S2,MB7,B]  423-16-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-148ms   | [S3,MB2,B]  153-33-187ms   | [S3,MB3,F]  190-16-207ms   | [S3,MB3,B]  213-22-235ms   | [S3,MB4,F]  239-15-254ms   | [S3,MB4,B]  260-22-282ms   | [S3,MB5,F]  285-14-300ms   | [S3,MB5,B]  306-21-328ms   | [S3,MB6,F]  331-14-346ms   | [S3,MB6,B]  352-21-374ms   | [S3,MB7,F]  377-14-392ms   | [S3,MB7,B]  398-21-420ms  
[rank3]:2025-12-12 23:33:27,043 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251212_2333_stage3_step300.svg
[rank2]:2025-12-12 23:35:06,974 - INFO - Avg. fwd time: 7.5749 / Avg. bwd time: 16.9746 / Avg. batch time: 458.1299 (ms) / GPU bubble ratio: 57.13%
[rank3]:2025-12-12 23:35:06,949 - INFO - Avg. fwd time: 14.0777 / Avg. bwd time: 30.3500 / Avg. batch time: 428.6125 (ms) / GPU bubble ratio: 17.08%
[rank1]:2025-12-12 23:35:07,002 - INFO - Avg. fwd time: 9.8635 / Avg. bwd time: 20.5510 / Avg. batch time: 494.4808 (ms) / GPU bubble ratio: 50.79%
[rank0]:2025-12-12 23:35:07,027 - INFO - Avg. fwd time: 7.8561 / Avg. bwd time: 15.2731 / Avg. batch time: 525.6432 (ms) / GPU bubble ratio: 64.80%
[rank0]:2025-12-12 23:36:42,131 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 23:36:46,092 - INFO - Avg. fwd time: 7.5832 / Avg. bwd time: 16.9237 / Avg. batch time: 454.8894 (ms) / GPU bubble ratio: 56.90%
[rank3]:2025-12-12 23:36:46,067 - INFO - Avg. fwd time: 14.1016 / Avg. bwd time: 29.9371 / Avg. batch time: 425.4583 (ms) / GPU bubble ratio: 17.19%
[rank1]:2025-12-12 23:36:46,120 - INFO - Avg. fwd time: 9.8787 / Avg. bwd time: 20.4493 / Avg. batch time: 491.2025 (ms) / GPU bubble ratio: 50.61%
[rank0]:2025-12-12 23:36:46,145 - INFO - Avg. fwd time: 7.8724 / Avg. bwd time: 14.9182 / Avg. batch time: 522.2327 (ms) / GPU bubble ratio: 65.09%
[rank0]:2025-12-12 23:36:46,181 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2007  memory: 13.29GiB(27.97%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank2]:2025-12-12 23:36:46,167 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2007  memory:  6.51GiB(13.70%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank3]:2025-12-12 23:36:46,174 - INFO -  step: 350  loss:  0.3203  grad_norm:  0.2007  memory: 17.37GiB(36.56%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank1]:2025-12-12 23:36:46,170 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2007  memory:  9.36GiB(19.71%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank0]:2025-12-12 23:38:24,857 - INFO - Avg. fwd time: 7.8869 / Avg. bwd time: 14.6240 / Avg. batch time: 519.1553 (ms) / GPU bubble ratio: 65.31%
[rank2]:2025-12-12 23:38:24,803 - INFO - Avg. fwd time: 7.5903 / Avg. bwd time: 16.8797 / Avg. batch time: 451.9642 (ms) / GPU bubble ratio: 56.69%
[rank3]:2025-12-12 23:38:24,778 - INFO - Avg. fwd time: 14.1229 / Avg. bwd time: 29.5641 / Avg. batch time: 422.6073 (ms) / GPU bubble ratio: 17.30%
[rank1]:2025-12-12 23:38:24,832 - INFO - Avg. fwd time: 9.8931 / Avg. bwd time: 20.3612 / Avg. batch time: 488.2377 (ms) / GPU bubble ratio: 50.43%
[rank0]:2025-12-12 23:39:59,519 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 23:40:03,476 - INFO - Avg. fwd time: 14.1380 / Avg. bwd time: 29.2418 / Avg. batch time: 420.1184 (ms) / GPU bubble ratio: 17.40%
[rank2]:2025-12-12 23:40:03,501 - INFO - Avg. fwd time: 7.5967 / Avg. bwd time: 16.8411 / Avg. batch time: 449.4092 (ms) / GPU bubble ratio: 56.50%
[rank0]:2025-12-12 23:40:03,556 - INFO - Avg. fwd time: 7.8994 / Avg. bwd time: 14.3538 / Avg. batch time: 516.4655 (ms) / GPU bubble ratio: 65.53%
[rank1]:2025-12-12 23:40:03,531 - INFO - Avg. fwd time: 9.9050 / Avg. bwd time: 20.2842 / Avg. batch time: 485.6469 (ms) / GPU bubble ratio: 50.27%
[rank1]:2025-12-12 23:40:03,582 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1045  memory:  9.36GiB(19.71%)  tps: 8,299  tflops: 64.88  mfu: 20.80%
[rank3]:2025-12-12 23:40:03,587 - INFO -  step: 400  loss:  0.2776  grad_norm:  0.1045  memory: 17.37GiB(36.56%)  tps: 8,299  tflops: 64.88  mfu: 20.80%
[rank2]:2025-12-12 23:40:03,578 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1045  memory:  6.51GiB(13.70%)  tps: 8,299  tflops: 64.88  mfu: 20.80%
[rank0]:2025-12-12 23:40:03,592 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1045  memory: 13.29GiB(27.97%)  tps: 8,299  tflops: 64.88  mfu: 20.80%
[rank0]:2025-12-12 23:40:03,645 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251212_2340_stage0_step400.svg
[rank1]:2025-12-12 23:40:03,645 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251212_2340_stage1_step400.svg
[rank2]:2025-12-12 23:40:03,645 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251212_2340_stage2_step400.svg
[rank3]:2025-12-12 23:40:03,739 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2340_real_step400_rank3.svg
[rank3]:			> Batch Time: 484.52 ms, GPU Bubble Ratio: 69.65%, 51.75%, 60.41%, 34.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-9-27ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  232-0-232ms    | [S0,MB6,F]  232-6-238ms    | [S0,MB3,B]  294-0-294ms    | [S0,MB7,F]  294-6-301ms    | [S0,MB4,B]  341-23-365ms   | [S0,MB5,B]  386-23-409ms   | [S0,MB6,B]  430-18-448ms   | [S0,MB7,B]  467-16-484ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-173ms    | [S1,MB2,B]  216-10-226ms   | [S1,MB5,F]  230-8-239ms    | [S1,MB3,B]  264-24-289ms   | [S1,MB6,F]  292-9-301ms    | [S1,MB4,B]  311-24-336ms   | [S1,MB7,F]  340-9-349ms    | [S1,MB5,B]  357-24-382ms   | [S1,MB6,B]  401-25-427ms   | [S1,MB7,B]  442-21-464ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  191-19-210ms   | [S2,MB4,F]  214-7-221ms    | [S2,MB3,B]  240-19-259ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  287-19-306ms   | [S2,MB6,F]  310-6-317ms    | [S2,MB5,B]  333-19-352ms   | [S2,MB7,F]  356-7-363ms    | [S2,MB6,B]  379-19-398ms   | [S2,MB7,B]  423-16-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  153-33-186ms   | [S3,MB3,F]  190-16-206ms   | [S3,MB3,B]  212-22-235ms   | [S3,MB4,F]  238-15-253ms   | [S3,MB4,B]  260-22-282ms   | [S3,MB5,F]  285-14-300ms   | [S3,MB5,B]  306-21-328ms   | [S3,MB6,F]  331-14-346ms   | [S3,MB6,B]  352-21-374ms   | [S3,MB7,F]  377-14-392ms   | [S3,MB7,B]  398-21-419ms  
[rank3]:2025-12-12 23:40:03,791 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251212_2340_stage3_step400.svg
[rank3]:2025-12-12 23:40:26,431 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 23:40:26,622 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-12 23:40:26,665 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 23:40:26,645 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 23:41:43,217 - INFO - Avg. fwd time: 9.9140 / Avg. bwd time: 20.2159 / Avg. batch time: 483.6401 (ms) / GPU bubble ratio: 50.16%
[rank3]:2025-12-12 23:41:43,159 - INFO - Avg. fwd time: 14.1535 / Avg. bwd time: 28.9845 / Avg. batch time: 418.1541 (ms) / GPU bubble ratio: 17.47%
[rank2]:2025-12-12 23:41:43,187 - INFO - Avg. fwd time: 7.6015 / Avg. bwd time: 16.8057 / Avg. batch time: 447.4196 (ms) / GPU bubble ratio: 56.36%
[rank0]:2025-12-12 23:41:43,243 - INFO - Avg. fwd time: 7.9100 / Avg. bwd time: 14.1266 / Avg. batch time: 514.3685 (ms) / GPU bubble ratio: 65.73%
[rank0]:2025-12-12 23:43:17,896 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 23:43:21,834 - INFO - Avg. fwd time: 7.6058 / Avg. bwd time: 16.7743 / Avg. batch time: 445.3897 (ms) / GPU bubble ratio: 56.21%
[rank3]:2025-12-12 23:43:21,809 - INFO - Avg. fwd time: 14.1666 / Avg. bwd time: 28.7279 / Avg. batch time: 416.1791 (ms) / GPU bubble ratio: 17.55%
[rank1]:2025-12-12 23:43:21,864 - INFO - Avg. fwd time: 9.9225 / Avg. bwd time: 20.1555 / Avg. batch time: 481.5831 (ms) / GPU bubble ratio: 50.03%
[rank1]:2025-12-12 23:43:21,918 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1132  memory:  9.36GiB(19.71%)  tps: 8,261  tflops: 64.58  mfu: 20.70%
[rank0]:2025-12-12 23:43:21,893 - INFO - Avg. fwd time: 7.9195 / Avg. bwd time: 13.9122 / Avg. batch time: 512.2337 (ms) / GPU bubble ratio: 65.90%
[rank0]:2025-12-12 23:43:21,929 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1132  memory: 13.29GiB(27.97%)  tps: 8,261  tflops: 64.58  mfu: 20.70%
[rank2]:2025-12-12 23:43:21,915 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1132  memory:  6.51GiB(13.70%)  tps: 8,261  tflops: 64.58  mfu: 20.70%
[rank3]:2025-12-12 23:43:21,923 - INFO -  step: 450  loss:  0.2641  grad_norm:  0.1132  memory: 17.37GiB(36.56%)  tps: 8,261  tflops: 64.58  mfu: 20.70%
[rank2]:2025-12-12 23:44:59,882 - INFO - Avg. fwd time: 7.6097 / Avg. bwd time: 16.7464 / Avg. batch time: 443.4111 (ms) / GPU bubble ratio: 56.06%
[rank3]:2025-12-12 23:44:59,856 - INFO - Avg. fwd time: 14.1785 / Avg. bwd time: 28.4780 / Avg. batch time: 414.2497 (ms) / GPU bubble ratio: 17.62%
[rank1]:2025-12-12 23:44:59,912 - INFO - Avg. fwd time: 9.9309 / Avg. bwd time: 20.1010 / Avg. batch time: 479.5730 (ms) / GPU bubble ratio: 49.90%
[rank0]:2025-12-12 23:44:59,939 - INFO - Avg. fwd time: 7.9283 / Avg. bwd time: 13.7234 / Avg. batch time: 510.1562 (ms) / GPU bubble ratio: 66.05%
[rank0]:2025-12-12 23:46:36,150 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 23:46:40,089 - INFO - Avg. fwd time: 14.1894 / Avg. bwd time: 28.3196 / Avg. batch time: 413.0530 (ms) / GPU bubble ratio: 17.67%
[rank2]:2025-12-12 23:46:40,115 - INFO - Avg. fwd time: 7.6134 / Avg. bwd time: 16.7211 / Avg. batch time: 442.1698 (ms) / GPU bubble ratio: 55.97%
[rank2]:2025-12-12 23:46:40,193 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1012  memory:  6.51GiB(13.70%)  tps: 8,263  tflops: 64.60  mfu: 20.70%
[rank1]:2025-12-12 23:46:40,145 - INFO - Avg. fwd time: 9.9356 / Avg. bwd time: 20.0509 / Avg. batch time: 478.3113 (ms) / GPU bubble ratio: 49.85%
[rank1]:2025-12-12 23:46:40,197 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1012  memory:  9.36GiB(19.71%)  tps: 8,263  tflops: 64.60  mfu: 20.70%
[rank0]:2025-12-12 23:46:40,172 - INFO - Avg. fwd time: 7.9355 / Avg. bwd time: 13.5620 / Avg. batch time: 508.8308 (ms) / GPU bubble ratio: 66.20%
[rank0]:2025-12-12 23:46:40,208 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1012  memory: 13.29GiB(27.97%)  tps: 8,263  tflops: 64.60  mfu: 20.70%
[rank3]:2025-12-12 23:46:40,203 - INFO -  step: 500  loss:  0.2441  grad_norm:  0.1012  memory: 17.37GiB(36.56%)  tps: 8,263  tflops: 64.60  mfu: 20.70%
[rank2]:2025-12-12 23:46:40,256 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251212_2346_stage2_step500.svg
[rank1]:2025-12-12 23:46:40,255 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251212_2346_stage1_step500.svg
[rank0]:2025-12-12 23:46:40,256 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251212_2346_stage0_step500.svg
[rank3]:2025-12-12 23:46:40,344 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2346_real_step500_rank3.svg
[rank3]:			> Batch Time: 484.67 ms, GPU Bubble Ratio: 69.43%, 51.97%, 60.44%, 34.22%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  232-0-232ms    | [S0,MB6,F]  232-6-239ms    | [S0,MB3,B]  294-0-294ms    | [S0,MB7,F]  294-6-301ms    | [S0,MB4,B]  342-23-365ms   | [S0,MB5,B]  386-23-410ms   | [S0,MB6,B]  430-18-449ms   | [S0,MB7,B]  467-16-484ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  216-10-227ms   | [S1,MB5,F]  231-8-239ms    | [S1,MB3,B]  265-24-289ms   | [S1,MB6,F]  293-9-302ms    | [S1,MB4,B]  312-24-336ms   | [S1,MB7,F]  340-9-349ms    | [S1,MB5,B]  357-25-382ms   | [S1,MB6,B]  402-24-427ms   | [S1,MB7,B]  443-20-464ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  192-19-211ms   | [S2,MB4,F]  215-7-222ms    | [S2,MB3,B]  241-19-260ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  287-19-307ms   | [S2,MB6,F]  310-7-317ms    | [S2,MB5,B]  333-19-352ms   | [S2,MB7,F]  356-7-363ms    | [S2,MB6,B]  379-19-398ms   | [S2,MB7,B]  423-16-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-33-187ms   | [S3,MB3,F]  191-16-207ms   | [S3,MB3,B]  213-22-235ms   | [S3,MB4,F]  239-15-254ms   | [S3,MB4,B]  260-22-282ms   | [S3,MB5,F]  286-14-301ms   | [S3,MB5,B]  307-21-328ms   | [S3,MB6,F]  332-14-346ms   | [S3,MB6,B]  352-21-374ms   | [S3,MB7,F]  377-14-392ms   | [S3,MB7,B]  398-21-420ms  
[rank3]:2025-12-12 23:46:40,386 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251212_2346_stage3_step500.svg
[rank2]:2025-12-12 23:48:19,844 - INFO - Avg. fwd time: 7.6166 / Avg. bwd time: 16.6972 / Avg. batch time: 440.9187 (ms) / GPU bubble ratio: 55.89%
[rank3]:2025-12-12 23:48:19,817 - INFO - Avg. fwd time: 14.1975 / Avg. bwd time: 28.1593 / Avg. batch time: 411.8187 (ms) / GPU bubble ratio: 17.72%
[rank1]:2025-12-12 23:48:19,874 - INFO - Avg. fwd time: 9.9407 / Avg. bwd time: 20.0050 / Avg. batch time: 477.0386 (ms) / GPU bubble ratio: 49.78%
[rank0]:2025-12-12 23:48:19,901 - INFO - Avg. fwd time: 7.9425 / Avg. bwd time: 13.4251 / Avg. batch time: 507.5025 (ms) / GPU bubble ratio: 66.32%
[rank0]:2025-12-12 23:49:55,488 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 23:49:59,456 - INFO - Avg. fwd time: 7.6196 / Avg. bwd time: 16.6757 / Avg. batch time: 439.7620 (ms) / GPU bubble ratio: 55.80%
[rank1]:2025-12-12 23:49:59,487 - INFO - Avg. fwd time: 9.9454 / Avg. bwd time: 19.9631 / Avg. batch time: 475.8646 (ms) / GPU bubble ratio: 49.72%
[rank3]:2025-12-12 23:49:59,430 - INFO - Avg. fwd time: 14.2070 / Avg. bwd time: 28.0119 / Avg. batch time: 410.7000 (ms) / GPU bubble ratio: 17.76%
[rank2]:2025-12-12 23:49:59,535 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0734  memory:  6.51GiB(13.70%)  tps: 8,219  tflops: 64.25  mfu: 20.59%
[rank0]:2025-12-12 23:49:59,514 - INFO - Avg. fwd time: 7.9487 / Avg. bwd time: 13.2919 / Avg. batch time: 506.2764 (ms) / GPU bubble ratio: 66.44%
[rank0]:2025-12-12 23:49:59,550 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0734  memory: 13.29GiB(27.97%)  tps: 8,219  tflops: 64.25  mfu: 20.59%
[rank1]:2025-12-12 23:49:59,539 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0734  memory:  9.36GiB(19.71%)  tps: 8,219  tflops: 64.25  mfu: 20.59%
[rank3]:2025-12-12 23:49:59,544 - INFO -  step: 550  loss:  0.2391  grad_norm:  0.0734  memory: 17.37GiB(36.56%)  tps: 8,219  tflops: 64.25  mfu: 20.59%
[rank3]:2025-12-12 23:51:38,042 - INFO - Avg. fwd time: 14.2165 / Avg. bwd time: 27.8492 / Avg. batch time: 409.4578 (ms) / GPU bubble ratio: 17.81%
[rank2]:2025-12-12 23:51:38,069 - INFO - Avg. fwd time: 7.6224 / Avg. bwd time: 16.6561 / Avg. batch time: 438.4858 (ms) / GPU bubble ratio: 55.70%
[rank1]:2025-12-12 23:51:38,100 - INFO - Avg. fwd time: 9.9504 / Avg. bwd time: 19.9250 / Avg. batch time: 474.5732 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-12-12 23:51:38,128 - INFO - Avg. fwd time: 7.9547 / Avg. bwd time: 13.1621 / Avg. batch time: 504.9372 (ms) / GPU bubble ratio: 66.54%
[rank0]:2025-12-12 23:53:11,718 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 23:53:15,630 - INFO - Avg. fwd time: 7.6251 / Avg. bwd time: 16.6384 / Avg. batch time: 437.1020 (ms) / GPU bubble ratio: 55.59%
[rank3]:2025-12-12 23:53:15,603 - INFO - Avg. fwd time: 14.2242 / Avg. bwd time: 27.6746 / Avg. batch time: 408.1055 (ms) / GPU bubble ratio: 17.87%
[rank0]:2025-12-12 23:53:15,690 - INFO - Avg. fwd time: 7.9603 / Avg. bwd time: 13.0512 / Avg. batch time: 503.4955 (ms) / GPU bubble ratio: 66.62%
[rank0]:2025-12-12 23:53:15,725 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0886  memory: 13.29GiB(27.97%)  tps: 8,352  tflops: 65.29  mfu: 20.93%
[rank2]:2025-12-12 23:53:15,711 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0886  memory:  6.51GiB(13.70%)  tps: 8,352  tflops: 65.29  mfu: 20.93%
[rank1]:2025-12-12 23:53:15,662 - INFO - Avg. fwd time: 9.9560 / Avg. bwd time: 19.8910 / Avg. batch time: 473.1744 (ms) / GPU bubble ratio: 49.54%
[rank1]:2025-12-12 23:53:15,715 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0886  memory:  9.36GiB(19.71%)  tps: 8,352  tflops: 65.29  mfu: 20.93%
[rank3]:2025-12-12 23:53:15,706 - INFO -  step: 600  loss:  0.2345  grad_norm:  0.0886  memory: 17.37GiB(36.56%)  tps: 8,352  tflops: 65.30  mfu: 20.93%
[rank0]:2025-12-12 23:53:15,774 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251212_2353_stage0_step600.svg
[rank2]:2025-12-12 23:53:15,777 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251212_2353_stage2_step600.svg
[rank1]:2025-12-12 23:53:15,774 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251212_2353_stage1_step600.svg
[rank3]:2025-12-12 23:53:15,858 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2353_real_step600_rank3.svg
[rank3]:			> Batch Time: 469.81 ms, GPU Bubble Ratio: 67.70%, 50.33%, 59.23%, 35.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  162-0-162ms    | [S0,MB5,F]  162-6-169ms    | [S0,MB2,B]  222-0-222ms    | [S0,MB6,F]  222-6-229ms    | [S0,MB3,B]  282-0-282ms    | [S0,MB7,F]  282-6-288ms    | [S0,MB4,B]  328-23-352ms   | [S0,MB5,B]  372-23-396ms   | [S0,MB6,B]  416-22-438ms   | [S0,MB7,B]  453-16-469ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  146-10-157ms   | [S1,MB4,F]  160-8-169ms    | [S1,MB2,B]  206-10-217ms   | [S1,MB5,F]  220-8-229ms    | [S1,MB3,B]  252-24-277ms   | [S1,MB6,F]  280-9-289ms    | [S1,MB4,B]  298-24-323ms   | [S1,MB7,F]  326-9-336ms    | [S1,MB5,B]  343-25-368ms   | [S1,MB6,B]  387-24-412ms   | [S1,MB7,B]  428-21-449ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  132-8-141ms    | [S2,MB3,F]  144-6-151ms    | [S2,MB2,B]  182-19-201ms   | [S2,MB4,F]  204-6-211ms    | [S2,MB3,B]  228-19-247ms   | [S2,MB5,F]  251-7-258ms    | [S2,MB4,B]  274-19-293ms   | [S2,MB6,F]  297-7-304ms    | [S2,MB5,B]  319-19-338ms   | [S2,MB7,F]  342-7-349ms    | [S2,MB6,B]  365-19-384ms   | [S2,MB7,B]  409-16-425ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  91-35-127ms    | [S3,MB2,F]  131-14-145ms   | [S3,MB2,B]  151-25-177ms   | [S3,MB3,F]  180-14-195ms   | [S3,MB3,B]  201-21-223ms   | [S3,MB4,F]  226-14-241ms   | [S3,MB4,B]  247-21-268ms   | [S3,MB5,F]  272-14-287ms   | [S3,MB5,B]  293-21-314ms   | [S3,MB6,F]  318-14-332ms   | [S3,MB6,B]  338-21-359ms   | [S3,MB7,F]  363-14-378ms   | [S3,MB7,B]  383-21-405ms  
[rank3]:2025-12-12 23:53:15,902 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251212_2353_stage3_step600.svg
[rank3]:2025-12-12 23:54:54,284 - INFO - Avg. fwd time: 14.2309 / Avg. bwd time: 27.5385 / Avg. batch time: 407.0555 (ms) / GPU bubble ratio: 17.91%
[rank2]:2025-12-12 23:54:54,312 - INFO - Avg. fwd time: 7.6274 / Avg. bwd time: 16.6219 / Avg. batch time: 436.0428 (ms) / GPU bubble ratio: 55.51%
[rank1]:2025-12-12 23:54:54,344 - INFO - Avg. fwd time: 9.9602 / Avg. bwd time: 19.8592 / Avg. batch time: 472.1038 (ms) / GPU bubble ratio: 49.47%
[rank0]:2025-12-12 23:54:54,372 - INFO - Avg. fwd time: 7.9652 / Avg. bwd time: 12.9414 / Avg. batch time: 502.3841 (ms) / GPU bubble ratio: 66.71%
[rank0]:2025-12-12 23:56:28,225 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 23:56:32,084 - INFO - Avg. fwd time: 7.6296 / Avg. bwd time: 16.6068 / Avg. batch time: 434.8912 (ms) / GPU bubble ratio: 55.42%
[rank3]:2025-12-12 23:56:32,056 - INFO - Avg. fwd time: 14.2373 / Avg. bwd time: 27.3934 / Avg. batch time: 405.9305 (ms) / GPU bubble ratio: 17.96%
[rank2]:2025-12-12 23:56:32,166 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory:  6.51GiB(13.70%)  tps: 8,340  tflops: 65.20  mfu: 20.90%
[rank1]:2025-12-12 23:56:32,116 - INFO - Avg. fwd time: 9.9643 / Avg. bwd time: 19.8305 / Avg. batch time: 470.9444 (ms) / GPU bubble ratio: 49.39%
[rank1]:2025-12-12 23:56:32,169 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory:  9.36GiB(19.71%)  tps: 8,340  tflops: 65.20  mfu: 20.90%
[rank3]:2025-12-12 23:56:32,161 - INFO -  step: 650  loss:  0.2450  grad_norm:  0.0683  memory: 17.37GiB(36.56%)  tps: 8,340  tflops: 65.20  mfu: 20.90%
[rank0]:2025-12-12 23:56:32,144 - INFO - Avg. fwd time: 7.9696 / Avg. bwd time: 12.8470 / Avg. batch time: 501.1866 (ms) / GPU bubble ratio: 66.77%
[rank0]:2025-12-12 23:56:32,180 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory: 13.29GiB(27.97%)  tps: 8,340  tflops: 65.20  mfu: 20.90%
[rank3]:2025-12-12 23:58:11,045 - INFO - Avg. fwd time: 14.2419 / Avg. bwd time: 27.2904 / Avg. batch time: 405.1329 (ms) / GPU bubble ratio: 17.99%
[rank2]:2025-12-12 23:58:11,074 - INFO - Avg. fwd time: 7.6316 / Avg. bwd time: 16.5924 / Avg. batch time: 434.0680 (ms) / GPU bubble ratio: 55.35%
[rank1]:2025-12-12 23:58:11,106 - INFO - Avg. fwd time: 9.9682 / Avg. bwd time: 19.8020 / Avg. batch time: 470.1043 (ms) / GPU bubble ratio: 49.34%
[rank0]:2025-12-12 23:58:11,135 - INFO - Avg. fwd time: 7.9739 / Avg. bwd time: 12.7525 / Avg. batch time: 500.3130 (ms) / GPU bubble ratio: 66.86%
[rank0]:2025-12-12 23:59:46,004 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 23:59:49,904 - INFO - Avg. fwd time: 14.2466 / Avg. bwd time: 27.1923 / Avg. batch time: 404.3750 (ms) / GPU bubble ratio: 18.02%
[rank2]:2025-12-12 23:59:49,932 - INFO - Avg. fwd time: 7.6333 / Avg. bwd time: 16.5789 / Avg. batch time: 433.2860 (ms) / GPU bubble ratio: 55.30%
[rank1]:2025-12-12 23:59:49,965 - INFO - Avg. fwd time: 9.9712 / Avg. bwd time: 19.7754 / Avg. batch time: 469.3080 (ms) / GPU bubble ratio: 49.29%
[rank0]:2025-12-12 23:59:49,994 - INFO - Avg. fwd time: 7.9776 / Avg. bwd time: 12.6706 / Avg. batch time: 499.4842 (ms) / GPU bubble ratio: 66.93%
[rank2]:2025-12-12 23:59:50,015 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0739  memory:  6.51GiB(13.70%)  tps: 8,281  tflops: 64.74  mfu: 20.75%
[rank1]:2025-12-12 23:59:50,019 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0739  memory:  9.36GiB(19.71%)  tps: 8,281  tflops: 64.74  mfu: 20.75%
[rank1]:2025-12-12 23:59:50,080 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251212_2359_stage1_step700.svg
[rank3]:2025-12-12 23:59:50,023 - INFO -  step: 700  loss:  0.2044  grad_norm:  0.0739  memory: 17.37GiB(36.56%)  tps: 8,281  tflops: 64.73  mfu: 20.75%
[rank0]:2025-12-12 23:59:50,030 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0739  memory: 13.29GiB(27.97%)  tps: 8,281  tflops: 64.74  mfu: 20.75%
[rank0]:2025-12-12 23:59:50,082 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251212_2359_stage0_step700.svg
[rank2]:2025-12-12 23:59:50,080 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251212_2359_stage2_step700.svg
[rank3]:2025-12-12 23:59:50,161 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251212_2359_real_step700_rank3.svg
[rank3]:			> Batch Time: 482.94 ms, GPU Bubble Ratio: 68.70%, 51.80%, 60.34%, 34.42%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  230-0-230ms    | [S0,MB6,F]  230-6-237ms    | [S0,MB3,B]  293-0-293ms    | [S0,MB7,F]  293-6-300ms    | [S0,MB4,B]  340-23-363ms   | [S0,MB5,B]  384-23-408ms   | [S0,MB6,B]  429-21-450ms   | [S0,MB7,B]  466-16-482ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-19ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  164-8-173ms    | [S1,MB2,B]  214-10-225ms   | [S1,MB5,F]  229-8-237ms    | [S1,MB3,B]  263-24-287ms   | [S1,MB6,F]  291-9-300ms    | [S1,MB4,B]  310-24-334ms   | [S1,MB7,F]  338-9-347ms    | [S1,MB5,B]  356-25-381ms   | [S1,MB6,B]  400-24-425ms   | [S1,MB7,B]  441-20-461ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  136-8-145ms    | [S2,MB3,F]  148-6-155ms    | [S2,MB2,B]  190-19-209ms   | [S2,MB4,F]  213-7-220ms    | [S2,MB3,B]  239-19-258ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  285-19-305ms   | [S2,MB6,F]  308-7-315ms    | [S2,MB5,B]  331-19-351ms   | [S2,MB7,F]  354-7-361ms    | [S2,MB6,B]  377-19-397ms   | [S2,MB7,B]  421-16-437ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  91-39-131ms    | [S3,MB2,F]  135-12-147ms   | [S3,MB2,B]  153-32-185ms   | [S3,MB3,F]  188-16-205ms   | [S3,MB3,B]  212-22-234ms   | [S3,MB4,F]  237-14-252ms   | [S3,MB4,B]  258-21-280ms   | [S3,MB5,F]  284-14-299ms   | [S3,MB5,B]  305-21-326ms   | [S3,MB6,F]  330-14-344ms   | [S3,MB6,B]  351-21-372ms   | [S3,MB7,F]  376-14-390ms   | [S3,MB7,B]  396-21-418ms  
[rank3]:2025-12-12 23:59:50,206 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251212_2359_stage3_step700.svg
[rank2]:2025-12-13 00:01:28,886 - INFO - Avg. fwd time: 7.6349 / Avg. bwd time: 16.5664 / Avg. batch time: 432.5612 (ms) / GPU bubble ratio: 55.24%
[rank3]:2025-12-13 00:01:28,857 - INFO - Avg. fwd time: 14.2499 / Avg. bwd time: 27.1003 / Avg. batch time: 403.6566 (ms) / GPU bubble ratio: 18.05%
[rank0]:2025-12-13 00:01:28,948 - INFO - Avg. fwd time: 7.9811 / Avg. bwd time: 12.5991 / Avg. batch time: 498.7171 (ms) / GPU bubble ratio: 66.99%
[rank1]:2025-12-13 00:01:28,919 - INFO - Avg. fwd time: 9.9742 / Avg. bwd time: 19.7508 / Avg. batch time: 468.5707 (ms) / GPU bubble ratio: 49.25%
[rank0]:2025-12-13 00:03:04,343 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-13 00:03:08,222 - INFO - Avg. fwd time: 14.2538 / Avg. bwd time: 27.0232 / Avg. batch time: 403.0641 (ms) / GPU bubble ratio: 18.07%
[rank2]:2025-12-13 00:03:08,251 - INFO - Avg. fwd time: 7.6365 / Avg. bwd time: 16.5545 / Avg. batch time: 431.9471 (ms) / GPU bubble ratio: 55.20%
[rank1]:2025-12-13 00:03:08,285 - INFO - Avg. fwd time: 9.9773 / Avg. bwd time: 19.7273 / Avg. batch time: 467.9403 (ms) / GPU bubble ratio: 49.22%
[rank1]:2025-12-13 00:03:08,340 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0806  memory:  9.36GiB(19.71%)  tps: 8,261  tflops: 64.58  mfu: 20.70%
[rank3]:2025-12-13 00:03:08,334 - INFO -  step: 750  loss:  0.2425  grad_norm:  0.0806  memory: 17.37GiB(36.56%)  tps: 8,262  tflops: 64.59  mfu: 20.70%
[rank0]:2025-12-13 00:03:08,315 - INFO - Avg. fwd time: 7.9847 / Avg. bwd time: 12.5311 / Avg. batch time: 498.0619 (ms) / GPU bubble ratio: 67.05%
[rank0]:2025-12-13 00:03:08,351 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0806  memory: 13.29GiB(27.97%)  tps: 8,261  tflops: 64.58  mfu: 20.70%
[rank2]:2025-12-13 00:03:08,336 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0806  memory:  6.51GiB(13.70%)  tps: 8,261  tflops: 64.58  mfu: 20.70%
[rank3]:2025-12-13 00:04:46,649 - INFO - Avg. fwd time: 14.2572 / Avg. bwd time: 26.9331 / Avg. batch time: 402.3611 (ms) / GPU bubble ratio: 18.10%
[rank2]:2025-12-13 00:04:46,679 - INFO - Avg. fwd time: 7.6380 / Avg. bwd time: 16.5435 / Avg. batch time: 431.2250 (ms) / GPU bubble ratio: 55.14%
[rank1]:2025-12-13 00:04:46,712 - INFO - Avg. fwd time: 9.9799 / Avg. bwd time: 19.7057 / Avg. batch time: 467.2065 (ms) / GPU bubble ratio: 49.17%
[rank0]:2025-12-13 00:04:46,742 - INFO - Avg. fwd time: 7.9880 / Avg. bwd time: 12.4587 / Avg. batch time: 497.3034 (ms) / GPU bubble ratio: 67.11%
[rank0]:2025-12-13 00:06:21,249 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-13 00:06:25,212 - INFO - Avg. fwd time: 14.2605 / Avg. bwd time: 26.8511 / Avg. batch time: 401.7234 (ms) / GPU bubble ratio: 18.13%
[rank2]:2025-12-13 00:06:25,242 - INFO - Avg. fwd time: 7.6395 / Avg. bwd time: 16.5333 / Avg. batch time: 430.5692 (ms) / GPU bubble ratio: 55.09%
[rank1]:2025-12-13 00:06:25,276 - INFO - Avg. fwd time: 9.9828 / Avg. bwd time: 19.6856 / Avg. batch time: 466.5406 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-12-13 00:06:25,306 - INFO - Avg. fwd time: 7.9913 / Avg. bwd time: 12.3985 / Avg. batch time: 496.6149 (ms) / GPU bubble ratio: 67.15%
[rank3]:2025-12-13 00:06:25,336 - INFO -  step: 800  loss:  0.2460  grad_norm:  0.0718  memory: 17.37GiB(36.56%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank3]:2025-12-13 00:06:25,337 - INFO -  final step: 800  loss:  0.2460  grad_norm:  0.0718  tps: 8,460  tflops: 66.14  mfu: 19.52%
[rank3]:2025-12-13 00:06:25,337 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-13 00:06:25,338 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.8_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank2]:2025-12-13 00:06:25,327 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0718  memory:  6.51GiB(13.70%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank2]:2025-12-13 00:06:25,328 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0718  tps: 8,454  tflops: 66.09  mfu: 19.38%
[rank2]:2025-12-13 00:06:25,328 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-13 00:06:25,328 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.8_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank1]:2025-12-13 00:06:25,331 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0718  memory:  9.36GiB(19.71%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank1]:2025-12-13 00:06:25,331 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0718  tps: 8,456  tflops: 66.10  mfu: 19.40%
[rank1]:2025-12-13 00:06:25,331 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-13 00:06:25,332 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.8_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-12-13 00:06:25,342 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0718  memory: 13.29GiB(27.97%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank0]:2025-12-13 00:06:25,342 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0718  tps: 8,455  tflops: 66.10  mfu: 19.39%
[rank0]:2025-12-13 00:06:25,342 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-13 00:06:25,343 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.8_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank0]:2025-12-13 00:06:27,334 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-13 00:06:27,408 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251213_0006_stage1_final800.svg
[rank0]:2025-12-13 00:06:27,409 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251213_0006_stage0_final800.svg
[rank2]:2025-12-13 00:06:27,407 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251213_0006_stage2_final800.svg
[rank3]:2025-12-13 00:06:27,489 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251213_0006_real_final800_rank3.svg
[rank3]:			> Batch Time: 481.19 ms, GPU Bubble Ratio: 69.21%, 51.56%, 60.21%, 34.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  165-0-165ms    | [S0,MB5,F]  165-6-172ms    | [S0,MB2,B]  229-0-229ms    | [S0,MB6,F]  229-6-236ms    | [S0,MB3,B]  291-0-291ms    | [S0,MB7,F]  291-6-298ms    | [S0,MB4,B]  338-23-362ms   | [S0,MB5,B]  383-23-407ms   | [S0,MB6,B]  427-18-446ms   | [S0,MB7,B]  464-16-481ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  149-10-160ms   | [S1,MB4,F]  164-8-172ms    | [S1,MB2,B]  213-10-224ms   | [S1,MB5,F]  228-8-237ms    | [S1,MB3,B]  262-24-286ms   | [S1,MB6,F]  290-9-299ms    | [S1,MB4,B]  309-24-333ms   | [S1,MB7,F]  337-9-346ms    | [S1,MB5,B]  355-24-379ms   | [S1,MB6,B]  399-24-423ms   | [S1,MB7,B]  439-21-460ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  136-8-144ms    | [S2,MB3,F]  148-6-155ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  212-7-219ms    | [S2,MB3,B]  237-19-257ms   | [S2,MB5,F]  260-7-267ms    | [S2,MB4,B]  284-19-303ms   | [S2,MB6,F]  307-7-314ms    | [S2,MB5,B]  330-19-349ms   | [S2,MB7,F]  353-7-360ms    | [S2,MB6,B]  376-19-395ms   | [S2,MB7,B]  420-16-436ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-39-131ms    | [S3,MB2,F]  134-12-147ms   | [S3,MB2,B]  153-32-185ms   | [S3,MB3,F]  188-15-203ms   | [S3,MB3,B]  210-22-232ms   | [S3,MB4,F]  236-14-251ms   | [S3,MB4,B]  257-21-279ms   | [S3,MB5,F]  283-14-297ms   | [S3,MB5,B]  303-21-325ms   | [S3,MB6,F]  329-14-343ms   | [S3,MB6,B]  349-21-371ms   | [S3,MB7,F]  374-14-389ms   | [S3,MB7,B]  395-21-416ms  
[rank2]:2025-12-13 00:06:27,561 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251213_0006_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank1]:2025-12-13 00:06:27,560 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251213_0006_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank0]:2025-12-13 00:06:27,568 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251213_0006_rank0_stage0.svg
[rank0]:	> Counts Sum: 321280, Total Sum: 1728640 (18.59%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.2, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.12, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank3]:2025-12-13 00:06:27,624 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251213_0006_thry_final800_rank3.svg
[rank3]:			> Batch Time: 330.19 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB0,B]  100-20-120ms   | [S0,MB4,F]  120-10-130ms   | [S0,MB1,B]  130-20-150ms   | [S0,MB5,F]  150-10-160ms   | [S0,MB2,B]  160-20-180ms   | [S0,MB6,F]  180-10-190ms   | [S0,MB3,B]  190-20-210ms   | [S0,MB7,F]  210-10-220ms   | [S0,MB4,B]  220-20-240ms   | [S0,MB5,B]  250-20-270ms   | [S0,MB6,B]  280-20-300ms   | [S0,MB7,B]  310-20-330ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB0,B]  80-20-100ms    | [S1,MB3,F]  100-10-110ms   | [S1,MB1,B]  110-20-130ms   | [S1,MB4,F]  130-10-140ms   | [S1,MB2,B]  140-20-160ms   | [S1,MB5,F]  160-10-170ms   | [S1,MB3,B]  170-20-190ms   | [S1,MB6,F]  190-10-200ms   | [S1,MB4,B]  200-20-220ms   | [S1,MB7,F]  220-10-230ms   | [S1,MB5,B]  230-20-250ms   | [S1,MB6,B]  260-20-280ms   | [S1,MB7,B]  290-20-310ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB0,B]  60-20-80ms     | [S2,MB2,F]  80-10-90ms     | [S2,MB1,B]  90-20-110ms    | [S2,MB3,F]  110-10-120ms   | [S2,MB2,B]  120-20-140ms   | [S2,MB4,F]  140-10-150ms   | [S2,MB3,B]  150-20-170ms   | [S2,MB5,F]  170-10-180ms   | [S2,MB4,B]  180-20-200ms   | [S2,MB6,F]  200-10-210ms   | [S2,MB5,B]  210-20-230ms   | [S2,MB7,F]  230-10-240ms   | [S2,MB6,B]  240-20-260ms   | [S2,MB7,B]  270-20-290ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB0,B]  40-20-60ms     | [S3,MB1,F]  60-10-70ms     | [S3,MB1,B]  70-20-90ms     | [S3,MB2,F]  90-10-100ms    | [S3,MB2,B]  100-20-120ms   | [S3,MB3,F]  120-10-130ms   | [S3,MB3,B]  130-20-150ms   | [S3,MB4,F]  150-10-160ms   | [S3,MB4,B]  160-20-180ms   | [S3,MB5,F]  180-10-190ms   | [S3,MB5,B]  190-20-210ms   | [S3,MB6,F]  210-10-220ms   | [S3,MB6,B]  220-20-240ms   | [S3,MB7,F]  240-10-250ms   | [S3,MB7,B]  250-20-270ms  
[rank3]:2025-12-13 00:06:27,672 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251213_0006_stage3_final800.svg
[rank3]:2025-12-13 00:06:27,804 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251213_0006_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [75.85, 75.34, 74.14, 75.68, 76.19, 76.19, 74.31, 74.48, 75.34, 74.82, 76.54, 74.48, 77.22, 74.48, 75.68, 74.82, 77.05, 76.36, 75.0, 74.48, 77.05, 75.68, 74.31, 76.71, 76.88, 74.31, 75.68, 74.82, 76.54]
[rank1]:2025-12-13 00:06:29,404 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251213_0006_stage1.svg
[rank1]:2025-12-13 00:06:29,408 - INFO - Destroying the purge thread.
[rank0]:2025-12-13 00:06:29,437 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251213_0006_stage0.svg
[rank2]:2025-12-13 00:06:29,392 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251213_0006_stage2.svg
[rank2]:2025-12-13 00:06:29,395 - INFO - Destroying the purge thread.
[rank0]:2025-12-13 00:06:29,441 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-13 00:06:29,623 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251213_0006_stage3.svg
[rank3]:2025-12-13 00:06:29,627 - INFO - Destroying the purge thread.
[rank1]:2025-12-13 00:06:29,721 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank2]:2025-12-13 00:06:29,743 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 315-340
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.87311
[rank3]:wandb:               final/avg_loss 0.24603
[rank3]:wandb:             final/avg_mfu(%) 19.52151
[rank3]:wandb:             final/avg_tflops 66.13937
[rank3]:wandb:    final/avg_throughput(tps) 8460.38156
[rank3]:wandb:              final/grad_norm 0.07181
[rank3]:wandb:               final/max_loss 0.24603
[rank3]:wandb:                    grad_norm 0.07181
[rank3]:wandb: loss_metrics/global_avg_loss 0.24603
[rank3]:wandb: loss_metrics/global_max_loss 0.24603
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1212_1F1B_fullrand7_mfr0.8_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/btr34ojs
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.8_42_dm1/20251212-2311/wandb/run-20251212_231131-btr34ojs/logs
[rank3]:2025-12-13 00:06:30,735 - INFO - Process group destroyed
[rank0]:2025-12-13 00:06:31,441 - INFO - Training completed
[rank0]:2025-12-13 00:06:31,441 - INFO - Destroying the purge thread.
[rank0]:2025-12-13 00:06:31,706 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.11', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.1', 'layers.0', 'tok_embeddings', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.7', 'layers.5', 'layers.6', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'norm', 'output', 'layers.13', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1212_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
