
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 23. (í™”) 23:50:55 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1223_1F1B_fullrand7_mfr0.6_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.6) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.6
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-23 23:51:01,275 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank2]:"
[rank3]:2025-12-23 23:51:01,235 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank0]:2025-12-23 23:51:01,484 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank0]:"
[rank1]:2025-12-23 23:51:01,450 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank1]:"
[rank2]:2025-12-23 23:51:01,455 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-23 23:51:01,457 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-23 23:51:01,402 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-23 23:51:01,404 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-23 23:51:01,637 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-23 23:51:01,640 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 23:51:01,695 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-23 23:51:01,698 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 23:51:01,701 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-23 23:51:01,702 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-23 23:51:02,089 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-23 23:51:04,862 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-23 23:51:04,898 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-23 23:51:04,902 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-23 23:51:04,929 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-23 23:51:04,929 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-23 23:51:05,052 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-23 23:51:05,091 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-23 23:51:05,092 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-23 23:51:05,118 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-23 23:51:05,118 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-23 23:51:05,112 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-23 23:51:05,112 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-23 23:51:05,112 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-23 23:51:05,317 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-23 23:51:05,317 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-23 23:51:05,317 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 6l6y5xl7
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.6_42_dm1/20251223-2351/wandb/run-20251223_235105-6l6y5xl7
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/6l6y5xl7
[rank3]:2025-12-23 23:51:07,149 - WandB logging enabled
[rank3]:2025-12-23 23:51:07,149 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-23 23:51:07,190 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-23 23:51:07,219 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-23 23:51:07,219 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-23 23:51:07,407 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-23 23:51:07,407 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-23 23:51:07,408 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-12-23 23:51:07,680 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-23 23:51:07,721 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-23 23:51:07,750 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-23 23:51:07,750 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-23 23:51:07,936 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-23 23:51:07,937 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-23 23:51:07,937 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank1]:2025-12-23 23:51:07,954 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-23 23:51:07,954 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank0]:2025-12-23 23:51:07,955 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-23 23:51:07,955 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-23 23:51:07,955 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-23 23:51:07,955 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-23 23:51:07,963 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-23 23:51:09,860 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-23 23:51:09,861 - Finished loading the checkpoint in 1.91 seconds.
[rank0]:2025-12-23 23:51:09,861 - Training starts at step 1
[rank2]:2025-12-23 23:51:15,429 -  step:  1  loss: -8.0000  grad_norm: 116.5364  memory:  5.20GiB(10.94%)  tps: 3,113  tflops: 24.34  mfu: 7.80%
[rank2]:2025-12-23 23:51:15,429 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-23 23:51:15,439 -  step:  1  loss: 10.6088  grad_norm: 116.5364  memory: 12.97GiB(27.31%)  tps: 3,974  tflops: 31.06  mfu: 9.96%
[rank3]:2025-12-23 23:51:15,440 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-23 23:51:15,468 -  step:  1  loss: -8.0000  grad_norm: 116.5364  memory:  9.62GiB(20.24%)  tps: 3,158  tflops: 24.69  mfu: 7.91%
[rank0]:2025-12-23 23:51:15,468 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-23 23:51:15,432 -  step:  1  loss: -8.0000  grad_norm: 116.5364  memory:  7.10GiB(14.94%)  tps: 4,250  tflops: 33.22  mfu: 10.65%
[rank1]:2025-12-23 23:51:15,432 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-23 23:53:15,613 - Avg. fwd time: 12.4943 / Avg. bwd time: 40.8891 / Avg. batch time: 499.1012 (ms) / GPU bubble ratio: 14.43%
[rank2]:2025-12-23 23:53:15,638 - Avg. fwd time: 7.2439 / Avg. bwd time: 19.6185 / Avg. batch time: 531.6158 (ms) / GPU bubble ratio: 59.58%
[rank1]:2025-12-23 23:53:15,667 - Avg. fwd time: 9.4192 / Avg. bwd time: 25.0560 / Avg. batch time: 571.7914 (ms) / GPU bubble ratio: 51.77%
[rank0]:2025-12-23 23:53:15,697 - Avg. fwd time: 7.6118 / Avg. bwd time: 24.9573 / Avg. batch time: 610.5842 (ms) / GPU bubble ratio: 57.33%
[rank0]:2025-12-23 23:55:16,568 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 23:55:21,486 - Avg. fwd time: 12.6071 / Avg. bwd time: 41.0242 / Avg. batch time: 501.0054 (ms) / GPU bubble ratio: 14.36%
[rank2]:2025-12-23 23:55:21,511 - Avg. fwd time: 7.2386 / Avg. bwd time: 19.6521 / Avg. batch time: 533.1749 (ms) / GPU bubble ratio: 59.65%
[rank1]:2025-12-23 23:55:21,541 - Avg. fwd time: 9.4177 / Avg. bwd time: 25.1034 / Avg. batch time: 573.0006 (ms) / GPU bubble ratio: 51.80%
[rank1]:2025-12-23 23:55:21,596 -  step: 50  loss: -8.0000  grad_norm: 12.8232  memory:  9.50GiB(19.99%)  tps: 6,523  tflops: 50.99  mfu: 16.34%
[rank3]:2025-12-23 23:55:21,604 -  step: 50  loss:  9.9108  grad_norm: 12.8232  memory: 16.39GiB(34.50%)  tps: 6,523  tflops: 50.99  mfu: 16.34%
[rank2]:2025-12-23 23:55:21,592 -  step: 50  loss: -8.0000  grad_norm: 12.8232  memory:  6.98GiB(14.69%)  tps: 6,523  tflops: 50.99  mfu: 16.34%
[rank0]:2025-12-23 23:55:21,571 - Avg. fwd time: 7.6114 / Avg. bwd time: 24.9909 / Avg. batch time: 611.4298 (ms) / GPU bubble ratio: 57.34%
[rank0]:2025-12-23 23:55:21,607 -  step: 50  loss: -8.0000  grad_norm: 12.8232  memory: 13.42GiB(28.26%)  tps: 6,523  tflops: 51.00  mfu: 16.34%
[rank3]:2025-12-23 23:56:06,785 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-23 23:56:57,312 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-23 23:56:57,627 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-12-23 23:57:16,854 - Avg. fwd time: 9.3957 / Avg. bwd time: 23.9957 / Avg. batch time: 558.3026 (ms) / GPU bubble ratio: 52.15%
[rank0]:2025-12-23 23:57:16,859 - Avg. fwd time: 7.6054 / Avg. bwd time: 23.0067 / Avg. batch time: 594.5923 (ms) / GPU bubble ratio: 58.81%
[rank2]:2025-12-23 23:57:16,839 - Avg. fwd time: 7.2298 / Avg. bwd time: 18.7880 / Avg. batch time: 519.7256 (ms) / GPU bubble ratio: 59.95%
[rank3]:2025-12-23 23:57:16,824 - Avg. fwd time: 12.5491 / Avg. bwd time: 39.5285 / Avg. batch time: 488.5499 (ms) / GPU bubble ratio: 14.72%
[rank3]:2025-12-23 23:57:29,444 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-23 23:57:29,798 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251223_2357_max_batch_time.svg
[rank3]:			> Batch Time: 534.52 ms, GPU Bubble Ratio: 50.87%, 48.08%, 59.48%, 18.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-25-153ms   | [S0,MB4,F]  153-7-160ms    | [S0,MB1,B]  179-25-204ms   | [S0,MB5,F]  204-7-211ms    | [S0,MB2,B]  233-25-259ms   | [S0,MB6,F]  259-7-266ms    | [S0,MB3,B]  288-25-313ms   | [S0,MB7,F]  313-7-321ms    | [S0,MB4,B]  343-25-368ms   | [S0,MB5,B]  398-25-423ms   | [S0,MB6,B]  454-25-479ms   | [S0,MB7,B]  509-25-534ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  154-25-179ms   | [S1,MB4,F]  179-9-188ms    | [S1,MB2,B]  208-25-233ms   | [S1,MB5,F]  233-9-243ms    | [S1,MB3,B]  263-25-288ms   | [S1,MB6,F]  288-9-297ms    | [S1,MB4,B]  317-25-343ms   | [S1,MB7,F]  343-9-352ms    | [S1,MB5,B]  373-25-398ms   | [S1,MB6,B]  428-25-454ms   | [S1,MB7,B]  484-25-509ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  134-19-154ms   | [S2,MB3,F]  154-7-161ms    | [S2,MB2,B]  188-19-208ms   | [S2,MB4,F]  208-7-215ms    | [S2,MB3,B]  243-19-263ms   | [S2,MB5,F]  263-6-270ms    | [S2,MB4,B]  297-19-317ms   | [S2,MB6,F]  317-7-324ms    | [S2,MB5,B]  353-19-373ms   | [S2,MB7,F]  373-7-380ms    | [S2,MB6,B]  409-19-428ms   | [S2,MB7,B]  464-19-484ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-12-147ms   | [S3,MB2,B]  147-41-188ms   AFR(10):0.9655 | [S3,MB3,F]  188-12-201ms   | [S3,MB3,B]  201-42-243ms   AFR(10):0.9655 | [S3,MB4,F]  243-12-256ms   | [S3,MB4,B]  256-41-297ms   AFR(10):0.9655 | [S3,MB5,F]  297-14-311ms   | [S3,MB5,B]  311-41-353ms   AFR(10):0.9655 | [S3,MB6,F]  353-13-366ms   | [S3,MB6,B]  366-42-409ms   AFR(10):0.9655 | [S3,MB7,F]  409-13-422ms   | [S3,MB7,B]  422-41-464ms   AFR(10):0.9655
[rank3]:2025-12-23 23:57:29,925 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251223_2357_min_batch_time.svg
[rank3]:			> Batch Time: 323.15 ms, GPU Bubble Ratio: 81.10%, 49.63%, 60.85%, 15.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-7-90ms      | [S0,MB1,B]  114-0-114ms    | [S0,MB5,F]  114-7-122ms    | [S0,MB2,B]  148-0-148ms    | [S0,MB6,F]  148-7-155ms    | [S0,MB3,B]  182-0-182ms    | [S0,MB7,F]  182-7-189ms    | [S0,MB4,B]  217-0-217ms    | [S0,MB5,B]  252-0-252ms    | [S0,MB6,B]  287-0-287ms    | [S0,MB7,B]  323-0-323ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-9-92ms      | [S1,MB1,B]  103-11-114ms   | [S1,MB4,F]  114-9-124ms    | [S1,MB2,B]  137-10-148ms   | [S1,MB5,F]  148-9-157ms    | [S1,MB3,B]  171-11-182ms   | [S1,MB6,F]  182-9-191ms    | [S1,MB4,B]  206-10-217ms   | [S1,MB7,F]  217-9-226ms    | [S1,MB5,B]  241-11-252ms   | [S1,MB6,B]  276-10-287ms   | [S1,MB7,B]  312-10-323ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  63-8-72ms      | [S2,MB2,F]  72-7-79ms      | [S2,MB1,B]  95-8-103ms     | [S2,MB3,F]  103-7-110ms    | [S2,MB2,B]  129-8-137ms    | [S2,MB4,F]  137-7-144ms    | [S2,MB3,B]  162-8-171ms    | [S2,MB5,F]  171-6-178ms    | [S2,MB4,B]  197-8-206ms    | [S2,MB6,F]  206-7-213ms    | [S2,MB5,B]  233-8-241ms    | [S2,MB7,F]  241-7-248ms    | [S2,MB6,B]  268-8-276ms    | [S2,MB7,B]  303-8-312ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-20-63ms     AFR(10):0.9655 | [S3,MB1,F]  63-10-74ms     | [S3,MB1,B]  74-20-95ms     AFR(10):0.9655 | [S3,MB2,F]  95-12-108ms    | [S3,MB2,B]  108-21-129ms   AFR(10):0.9655 | [S3,MB3,F]  129-12-141ms   | [S3,MB3,B]  141-21-162ms   AFR(10):0.9655 | [S3,MB4,F]  162-12-175ms   | [S3,MB4,B]  175-22-197ms   AFR(10):0.9655 | [S3,MB5,F]  197-14-211ms   | [S3,MB5,B]  211-21-233ms   AFR(10):0.9655 | [S3,MB6,F]  233-13-246ms   | [S3,MB6,B]  246-21-268ms   AFR(10):0.9655 | [S3,MB7,F]  268-13-281ms   | [S3,MB7,B]  281-22-303ms   AFR(10):0.9655
[rank3]:2025-12-23 23:57:30,074 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251223_2357_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 385.39 ms, GPU Bubble Ratio: 41.34%, 31.72%, 46.72%, 12.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-25-153ms   | [S0,MB4,F]  153-7-160ms    | [S0,MB1,B]  179-25-204ms   | [S0,MB5,F]  204-7-211ms    | [S0,MB2,B]  214-25-239ms   | [S0,MB6,F]  239-7-246ms    | [S0,MB3,B]  248-25-273ms   | [S0,MB7,F]  273-7-281ms    | [S0,MB4,B]  301-25-326ms   | [S0,MB5,B]  336-25-361ms   | [S0,MB6,B]  371-13-385ms   | [S0,MB7,B]  385-0-385ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  154-25-179ms   | [S1,MB4,F]  179-9-188ms    | [S1,MB2,B]  188-25-214ms   | [S1,MB5,F]  214-9-223ms    | [S1,MB3,B]  223-25-248ms   | [S1,MB6,F]  248-9-257ms    | [S1,MB4,B]  276-25-301ms   | [S1,MB7,F]  301-9-310ms    | [S1,MB5,B]  311-25-336ms   | [S1,MB6,B]  346-25-371ms   | [S1,MB7,B]  374-10-385ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  134-19-154ms   | [S2,MB3,F]  154-7-161ms    | [S2,MB2,B]  168-19-187ms   | [S2,MB4,F]  188-7-195ms    | [S2,MB3,B]  201-19-221ms   | [S2,MB5,F]  223-6-230ms    | [S2,MB4,B]  256-19-276ms   | [S2,MB6,F]  276-7-283ms    | [S2,MB5,B]  291-19-311ms   | [S2,MB7,F]  311-7-318ms    | [S2,MB6,B]  326-19-346ms   | [S2,MB7,B]  365-8-374ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-12-147ms   | [S3,MB2,B]  147-21-168ms   AFR(10):0.9655 | [S3,MB3,F]  168-12-180ms   | [S3,MB3,B]  180-21-201ms   AFR(10):0.9655 | [S3,MB4,F]  201-12-214ms   | [S3,MB4,B]  214-41-256ms   AFR(10):0.9655 | [S3,MB5,F]  256-14-270ms   | [S3,MB5,B]  270-21-291ms   AFR(10):0.9655 | [S3,MB6,F]  291-13-305ms   | [S3,MB6,B]  305-21-326ms   AFR(10):0.9655 | [S3,MB7,F]  326-13-339ms   | [S3,MB7,B]  339-26-365ms   AFR(10):0.9655
[rank3]:2025-12-23 23:57:30,074 - 	> Batch Time: 385.39 ms (Average Freeze Ratio: 0.26, Time Reduction Rate: 0.28)
[rank3]:2025-12-23 23:58:55,963 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.21(0.27)/0.80
[rank0]:2025-12-23 23:58:56,195 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-23 23:58:56,195 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.11(0.15)/0.45, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-23 23:58:56,173 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank2]:2025-12-23 23:58:56,149 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-23 23:59:00,522 - Avg. fwd time: 9.4232 / Avg. bwd time: 23.5675 / Avg. batch time: 539.1319 (ms) / GPU bubble ratio: 51.05%
[rank2]:2025-12-23 23:59:00,497 - Avg. fwd time: 7.2304 / Avg. bwd time: 18.4227 / Avg. batch time: 502.5604 (ms) / GPU bubble ratio: 59.16%
[rank3]:2025-12-23 23:59:00,475 - Avg. fwd time: 12.4130 / Avg. bwd time: 37.6733 / Avg. batch time: 472.6056 (ms) / GPU bubble ratio: 15.22%
[rank0]:2025-12-23 23:59:00,549 - Avg. fwd time: 7.6009 / Avg. bwd time: 21.9636 / Avg. batch time: 571.5957 (ms) / GPU bubble ratio: 58.62%
[rank0]:2025-12-23 23:59:00,584 -  step: 100  loss: -8.0000  grad_norm:  4.9459  memory: 13.42GiB(28.26%)  tps: 7,482  tflops: 58.49  mfu: 18.75%
[rank1]:2025-12-23 23:59:00,574 -  step: 100  loss: -8.0000  grad_norm:  4.9459  memory:  9.50GiB(19.99%)  tps: 7,482  tflops: 58.49  mfu: 18.75%
[rank2]:2025-12-23 23:59:00,570 -  step: 100  loss: -8.0000  grad_norm:  4.9459  memory:  6.98GiB(14.69%)  tps: 7,482  tflops: 58.49  mfu: 18.75%
[rank3]:2025-12-23 23:59:00,582 -  step: 100  loss:  8.6426  grad_norm:  4.9459  memory: 16.39GiB(34.50%)  tps: 7,482  tflops: 58.49  mfu: 18.75%
[rank0]:2025-12-23 23:59:00,643 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251223_2359_stage0_step100.svg
[rank1]:2025-12-23 23:59:00,642 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251223_2359_stage1_step100.svg
[rank2]:2025-12-23 23:59:00,645 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251223_2359_stage2_step100.svg
[rank3]:2025-12-23 23:59:00,731 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251223_2359_step100_rank3.svg
[rank3]:			> Batch Time: 585.62 ms, GPU Bubble Ratio: 56.65%, 53.01%, 63.49%, 28.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-172ms   | [S0,MB4,F]  172-7-179ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  268-25-293ms   | [S0,MB6,F]  293-7-300ms    | [S0,MB3,B]  329-25-354ms   | [S0,MB7,F]  354-7-361ms    | [S0,MB4,B]  393-25-418ms   | [S0,MB5,B]  451-25-476ms   | [S0,MB6,B]  513-24-537ms   | [S0,MB7,B]  568-17-585ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  116-25-142ms   | [S1,MB3,F]  145-9-154ms    | [S1,MB1,B]  177-25-203ms   | [S1,MB4,F]  206-9-215ms    | [S1,MB2,B]  237-25-263ms   | [S1,MB5,F]  266-9-275ms    | [S1,MB3,B]  298-25-324ms   | [S1,MB6,F]  327-9-336ms    | [S1,MB4,B]  362-25-388ms   | [S1,MB7,F]  391-9-400ms    | [S1,MB5,B]  422-25-448ms   | [S1,MB6,B]  484-25-509ms   | [S1,MB7,B]  542-22-564ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  214-19-233ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  274-19-294ms   | [S2,MB5,F]  296-7-303ms    | [S2,MB4,B]  338-19-358ms   | [S2,MB6,F]  361-7-368ms    | [S2,MB5,B]  399-19-419ms   | [S2,MB7,F]  421-7-428ms    | [S2,MB6,B]  461-19-481ms   | [S2,MB7,B]  522-16-539ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-12-165ms   | [S3,MB2,B]  171-37-208ms   | [S3,MB3,F]  212-12-224ms   | [S3,MB3,B]  231-38-269ms   | [S3,MB4,F]  273-12-285ms   | [S3,MB4,B]  291-42-333ms   | [S3,MB5,F]  337-12-350ms   | [S3,MB5,B]  355-38-394ms   | [S3,MB6,F]  397-12-409ms   | [S3,MB6,B]  416-39-456ms   | [S3,MB7,F]  460-12-472ms   | [S3,MB7,B]  479-40-519ms  
[rank0]:2025-12-23 23:59:00,735 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251223_2359_stage0.svg
[rank1]:2025-12-23 23:59:00,732 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251223_2359_stage1.svg
[rank2]:2025-12-23 23:59:00,739 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251223_2359_stage2.svg
[rank3]:2025-12-23 23:59:00,777 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251223_2359_stage3_step100.svg
[rank3]:2025-12-23 23:59:00,871 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251223_2359_stage3.svg
[rank3]:2025-12-24 00:00:54,837 - Avg. fwd time: 12.3853 / Avg. bwd time: 37.3636 / Avg. batch time: 469.8934 (ms) / GPU bubble ratio: 15.30%
[rank2]:2025-12-24 00:00:54,858 - Avg. fwd time: 7.2293 / Avg. bwd time: 18.6063 / Avg. batch time: 499.5786 (ms) / GPU bubble ratio: 58.63%
[rank1]:2025-12-24 00:00:54,883 - Avg. fwd time: 9.4353 / Avg. bwd time: 23.8026 / Avg. batch time: 535.8026 (ms) / GPU bubble ratio: 50.37%
[rank0]:2025-12-24 00:00:54,903 - Avg. fwd time: 7.6036 / Avg. bwd time: 22.3151 / Avg. batch time: 568.0358 (ms) / GPU bubble ratio: 57.86%
[rank3]:2025-12-24 00:02:39,973 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.48(0.53)/0.80
[rank1]:2025-12-24 00:02:40,167 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank2]:2025-12-24 00:02:40,149 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank0]:2025-12-24 00:02:40,188 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 00:02:40,189 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.27(0.30)/0.45, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-24 00:02:44,313 - Avg. fwd time: 7.2289 / Avg. bwd time: 18.6636 / Avg. batch time: 494.6767 (ms) / GPU bubble ratio: 58.13%
[rank3]:2025-12-24 00:02:44,293 - Avg. fwd time: 12.3942 / Avg. bwd time: 36.8450 / Avg. batch time: 465.8073 (ms) / GPU bubble ratio: 15.43%
[rank1]:2025-12-24 00:02:44,334 - Avg. fwd time: 9.4457 / Avg. bwd time: 23.8959 / Avg. batch time: 530.1339 (ms) / GPU bubble ratio: 49.69%
[rank1]:2025-12-24 00:02:44,378 -  step: 150  loss: -8.0000  grad_norm:  6.5551  memory:  9.50GiB(19.99%)  tps: 7,321  tflops: 57.23  mfu: 18.34%
[rank2]:2025-12-24 00:02:44,374 -  step: 150  loss: -8.0000  grad_norm:  6.5551  memory:  6.98GiB(14.69%)  tps: 7,321  tflops: 57.23  mfu: 18.34%
[rank0]:2025-12-24 00:02:44,353 - Avg. fwd time: 7.6044 / Avg. bwd time: 22.4430 / Avg. batch time: 561.7239 (ms) / GPU bubble ratio: 57.21%
[rank0]:2025-12-24 00:02:44,389 -  step: 150  loss: -8.0000  grad_norm:  6.5551  memory: 13.42GiB(28.26%)  tps: 7,321  tflops: 57.23  mfu: 18.34%
[rank3]:2025-12-24 00:02:44,387 -  step: 150  loss:  3.7241  grad_norm:  6.5551  memory: 16.39GiB(34.50%)  tps: 7,321  tflops: 57.23  mfu: 18.34%
[rank3]:2025-12-24 00:04:28,248 - Avg. fwd time: 12.3310 / Avg. bwd time: 36.1477 / Avg. batch time: 459.7182 (ms) / GPU bubble ratio: 15.64%
[rank0]:2025-12-24 00:04:28,302 - Avg. fwd time: 7.6067 / Avg. bwd time: 22.5240 / Avg. batch time: 553.2495 (ms) / GPU bubble ratio: 56.43%
[rank1]:2025-12-24 00:04:28,285 - Avg. fwd time: 9.4564 / Avg. bwd time: 23.9450 / Avg. batch time: 522.6124 (ms) / GPU bubble ratio: 48.87%
[rank2]:2025-12-24 00:04:28,265 - Avg. fwd time: 7.2293 / Avg. bwd time: 18.7123 / Avg. batch time: 488.0070 (ms) / GPU bubble ratio: 57.47%
[rank3]:2025-12-24 00:06:03,928 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.76(0.80)/0.80
[rank0]:2025-12-24 00:06:04,125 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 00:06:04,126 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.43(0.45)/0.45, [MB7] 0.95(1.00)/1.00
[rank1]:2025-12-24 00:06:04,116 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-24 00:06:04,099 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank3]:2025-12-24 00:06:07,991 - Avg. fwd time: 12.2893 / Avg. bwd time: 35.4144 / Avg. batch time: 453.5143 (ms) / GPU bubble ratio: 15.85%
[rank3]:2025-12-24 00:06:08,065 -  step: 200  loss:  1.3348  grad_norm:  4.5731  memory: 16.39GiB(34.50%)  tps: 8,044  tflops: 62.89  mfu: 20.16%
[rank0]:2025-12-24 00:06:08,030 - Avg. fwd time: 7.6104 / Avg. bwd time: 22.5003 / Avg. batch time: 544.2694 (ms) / GPU bubble ratio: 55.74%
[rank0]:2025-12-24 00:06:08,066 -  step: 200  loss: -8.0000  grad_norm:  4.5731  memory: 13.42GiB(28.26%)  tps: 8,044  tflops: 62.89  mfu: 20.16%
[rank1]:2025-12-24 00:06:08,024 - Avg. fwd time: 9.4686 / Avg. bwd time: 23.9718 / Avg. batch time: 514.7423 (ms) / GPU bubble ratio: 48.03%
[rank1]:2025-12-24 00:06:08,055 -  step: 200  loss: -8.0000  grad_norm:  4.5731  memory:  9.50GiB(19.99%)  tps: 8,044  tflops: 62.89  mfu: 20.16%
[rank2]:2025-12-24 00:06:08,006 - Avg. fwd time: 7.2307 / Avg. bwd time: 18.7115 / Avg. batch time: 480.9765 (ms) / GPU bubble ratio: 56.85%
[rank2]:2025-12-24 00:06:08,052 -  step: 200  loss: -8.0000  grad_norm:  4.5731  memory:  6.98GiB(14.69%)  tps: 8,044  tflops: 62.89  mfu: 20.16%
[rank0]:2025-12-24 00:06:08,116 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251224_0006_stage0_step200.svg
[rank1]:2025-12-24 00:06:08,116 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251224_0006_stage1_step200.svg
[rank2]:2025-12-24 00:06:08,120 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251224_0006_stage2_step200.svg
[rank3]:2025-12-24 00:06:08,210 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0006_step200_rank3.svg
[rank3]:			> Batch Time: 480.83 ms, GPU Bubble Ratio: 50.53%, 43.94%, 56.87%, 29.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-241ms    | [S0,MB2,B]  252-25-277ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  295-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  356-25-381ms   | [S0,MB5,B]  409-25-434ms   | [S0,MB6,B]  454-19-473ms   | [S0,MB7,B]  475-5-480ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  207-9-216ms    | [S1,MB2,B]  221-25-247ms   | [S1,MB5,F]  250-9-260ms    | [S1,MB3,B]  264-26-290ms   | [S1,MB6,F]  294-9-303ms    | [S1,MB4,B]  325-25-351ms   | [S1,MB7,F]  354-9-364ms    | [S1,MB5,B]  380-25-405ms   | [S1,MB6,B]  424-25-450ms   | [S1,MB7,B]  457-13-470ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  197-20-217ms   | [S2,MB4,F]  219-7-227ms    | [S2,MB3,B]  239-20-260ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  301-20-321ms   | [S2,MB6,F]  323-7-330ms    | [S2,MB5,B]  356-20-376ms   | [S2,MB7,F]  378-7-385ms    | [S2,MB6,B]  401-20-421ms   | [S2,MB7,B]  445-8-454ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-12-165ms   | [S3,MB2,B]  170-21-192ms   | [S3,MB3,F]  195-10-206ms   | [S3,MB3,B]  212-22-235ms   | [S3,MB4,F]  238-10-249ms   | [S3,MB4,B]  255-41-296ms   | [S3,MB5,F]  299-13-313ms   | [S3,MB5,B]  319-32-352ms   | [S3,MB6,F]  354-12-367ms   | [S3,MB6,B]  374-22-396ms   | [S3,MB7,F]  400-11-411ms   | [S3,MB7,B]  416-23-440ms  
[rank3]:2025-12-24 00:06:08,255 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251224_0006_stage3_step200.svg
[rank0]:2025-12-24 00:06:08,454 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0006_stage0.svg
[rank1]:2025-12-24 00:06:08,453 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0006_stage1.svg
[rank2]:2025-12-24 00:06:08,512 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0006_stage2.svg
[rank3]:2025-12-24 00:06:08,608 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0006_stage3.svg
[rank3]:2025-12-24 00:07:44,452 - Avg. fwd time: 12.2372 / Avg. bwd time: 34.7422 / Avg. batch time: 447.7215 (ms) / GPU bubble ratio: 16.06%
[rank0]:2025-12-24 00:07:44,494 - Avg. fwd time: 7.6134 / Avg. bwd time: 22.3379 / Avg. batch time: 535.2284 (ms) / GPU bubble ratio: 55.23%
[rank2]:2025-12-24 00:07:44,469 - Avg. fwd time: 7.2331 / Avg. bwd time: 18.7110 / Avg. batch time: 474.5179 (ms) / GPU bubble ratio: 56.26%
[rank1]:2025-12-24 00:07:44,487 - Avg. fwd time: 9.4874 / Avg. bwd time: 23.9965 / Avg. batch time: 507.5306 (ms) / GPU bubble ratio: 47.22%
[rank3]:2025-12-24 00:09:15,621 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.79(0.80)/0.80
[rank2]:2025-12-24 00:09:15,784 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 00:09:15,799 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-24 00:09:15,802 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 00:09:15,803 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.45)/0.45, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-24 00:09:19,562 - Avg. fwd time: 7.2354 / Avg. bwd time: 18.7139 / Avg. batch time: 468.8882 (ms) / GPU bubble ratio: 55.73%
[rank2]:2025-12-24 00:09:19,610 -  step: 250  loss: -8.0000  grad_norm:  7.9174  memory:  6.98GiB(14.69%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank1]:2025-12-24 00:09:19,582 - Avg. fwd time: 9.5038 / Avg. bwd time: 24.0198 / Avg. batch time: 501.2920 (ms) / GPU bubble ratio: 46.50%
[rank1]:2025-12-24 00:09:19,614 -  step: 250  loss: -8.0000  grad_norm:  7.9174  memory:  9.50GiB(19.99%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank0]:2025-12-24 00:09:19,588 - Avg. fwd time: 7.6143 / Avg. bwd time: 22.1794 / Avg. batch time: 527.5344 (ms) / GPU bubble ratio: 54.82%
[rank0]:2025-12-24 00:09:19,624 -  step: 250  loss: -8.0000  grad_norm:  7.9174  memory: 13.42GiB(28.26%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank3]:2025-12-24 00:09:19,546 - Avg. fwd time: 12.1964 / Avg. bwd time: 34.1506 / Avg. batch time: 442.6631 (ms) / GPU bubble ratio: 16.24%
[rank3]:2025-12-24 00:09:19,623 -  step: 250  loss:  0.4434  grad_norm:  7.9174  memory: 16.39GiB(34.50%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank3]:2025-12-24 00:10:55,145 - Avg. fwd time: 12.1644 / Avg. bwd time: 33.6746 / Avg. batch time: 438.6002 (ms) / GPU bubble ratio: 16.39%
[rank2]:2025-12-24 00:10:55,161 - Avg. fwd time: 7.2374 / Avg. bwd time: 18.7169 / Avg. batch time: 464.3591 (ms) / GPU bubble ratio: 55.29%
[rank0]:2025-12-24 00:10:55,187 - Avg. fwd time: 7.6147 / Avg. bwd time: 22.0756 / Avg. batch time: 521.4404 (ms) / GPU bubble ratio: 54.45%
[rank1]:2025-12-24 00:10:55,180 - Avg. fwd time: 9.5190 / Avg. bwd time: 24.0398 / Avg. batch time: 496.2553 (ms) / GPU bubble ratio: 45.90%
[rank3]:2025-12-24 00:12:26,376 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.79(0.80)/0.80
[rank2]:2025-12-24 00:12:26,544 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-24 00:12:26,563 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 00:12:26,564 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.45)/0.45, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 00:12:26,560 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-24 00:12:30,311 - Avg. fwd time: 7.2387 / Avg. bwd time: 18.7187 / Avg. batch time: 460.4103 (ms) / GPU bubble ratio: 54.90%
[rank2]:2025-12-24 00:12:30,360 -  step: 300  loss: -8.0000  grad_norm:  0.2403  memory:  6.98GiB(14.69%)  tps: 8,589  tflops: 67.15  mfu: 21.52%
[rank3]:2025-12-24 00:12:30,294 - Avg. fwd time: 12.1238 / Avg. bwd time: 33.2703 / Avg. batch time: 435.0392 (ms) / GPU bubble ratio: 16.52%
[rank3]:2025-12-24 00:12:30,372 -  step: 300  loss:  0.2779  grad_norm:  0.2403  memory: 16.39GiB(34.50%)  tps: 8,589  tflops: 67.15  mfu: 21.52%
[rank0]:2025-12-24 00:12:30,338 - Avg. fwd time: 7.6156 / Avg. bwd time: 21.9855 / Avg. batch time: 516.1811 (ms) / GPU bubble ratio: 54.12%
[rank0]:2025-12-24 00:12:30,374 -  step: 300  loss: -8.0000  grad_norm:  0.2403  memory: 13.42GiB(28.26%)  tps: 8,589  tflops: 67.15  mfu: 21.52%
[rank1]:2025-12-24 00:12:30,330 - Avg. fwd time: 9.5331 / Avg. bwd time: 24.0583 / Avg. batch time: 491.8935 (ms) / GPU bubble ratio: 45.37%
[rank1]:2025-12-24 00:12:30,363 -  step: 300  loss: -8.0000  grad_norm:  0.2403  memory:  9.50GiB(19.99%)  tps: 8,589  tflops: 67.15  mfu: 21.52%
[rank2]:2025-12-24 00:12:30,423 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251224_0012_stage2_step300.svg
[rank0]:2025-12-24 00:12:30,423 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251224_0012_stage0_step300.svg
[rank1]:2025-12-24 00:12:30,424 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251224_0012_stage1_step300.svg
[rank3]:2025-12-24 00:12:30,513 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0012_step300_rank3.svg
[rank3]:			> Batch Time: 455.00 ms, GPU Bubble Ratio: 50.06%, 40.54%, 54.25%, 29.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  251-25-276ms   | [S0,MB6,F]  277-7-284ms    | [S0,MB3,B]  294-25-319ms   | [S0,MB7,F]  319-7-326ms    | [S0,MB4,B]  354-25-379ms   | [S0,MB5,B]  396-25-422ms   | [S0,MB6,B]  438-14-452ms   | [S0,MB7,B]  455-0-455ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  117-25-143ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  177-25-203ms   | [S1,MB4,F]  206-9-215ms    | [S1,MB2,B]  220-25-246ms   | [S1,MB5,F]  250-9-259ms    | [S1,MB3,B]  262-26-288ms   | [S1,MB6,F]  292-10-302ms   | [S1,MB4,B]  323-25-348ms   | [S1,MB7,F]  352-9-361ms    | [S1,MB5,B]  367-26-393ms   | [S1,MB6,B]  408-26-434ms   | [S1,MB7,B]  439-11-451ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-173ms   | [S2,MB3,F]  176-6-183ms    | [S2,MB2,B]  196-20-216ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  237-20-257ms   | [S2,MB5,F]  260-7-267ms    | [S2,MB4,B]  299-20-319ms   | [S2,MB6,F]  321-7-328ms    | [S2,MB5,B]  343-20-363ms   | [S2,MB7,F]  365-7-372ms    | [S2,MB6,B]  384-20-404ms   | [S2,MB7,B]  427-9-436ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  92-10-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-11-164ms   | [S3,MB2,B]  170-21-191ms   | [S3,MB3,F]  194-10-205ms   | [S3,MB3,B]  211-21-232ms   | [S3,MB4,F]  236-10-246ms   | [S3,MB4,B]  252-41-294ms   | [S3,MB5,F]  297-12-310ms   | [S3,MB5,B]  316-21-337ms   | [S3,MB6,F]  341-11-352ms   | [S3,MB6,B]  358-21-379ms   | [S3,MB7,F]  383-10-394ms   | [S3,MB7,B]  399-23-422ms  
[rank3]:2025-12-24 00:12:30,557 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251224_0012_stage3_step300.svg
[rank2]:2025-12-24 00:12:31,031 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0012_stage2.svg
[rank0]:2025-12-24 00:12:31,027 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0012_stage0.svg
[rank1]:2025-12-24 00:12:31,070 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0012_stage1.svg
[rank3]:2025-12-24 00:12:31,171 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0012_stage3.svg
[rank3]:2025-12-24 00:14:06,431 - Avg. fwd time: 12.0882 / Avg. bwd time: 32.9592 / Avg. batch time: 432.2670 (ms) / GPU bubble ratio: 16.63%
[rank2]:2025-12-24 00:14:06,448 - Avg. fwd time: 7.2392 / Avg. bwd time: 18.7165 / Avg. batch time: 457.3341 (ms) / GPU bubble ratio: 54.60%
[rank0]:2025-12-24 00:14:06,476 - Avg. fwd time: 7.6149 / Avg. bwd time: 21.8801 / Avg. batch time: 511.8628 (ms) / GPU bubble ratio: 53.90%
[rank1]:2025-12-24 00:14:06,468 - Avg. fwd time: 9.5446 / Avg. bwd time: 24.0672 / Avg. batch time: 488.4351 (ms) / GPU bubble ratio: 44.95%
[rank0]:2025-12-24 00:15:38,814 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-24 00:15:42,587 - Avg. fwd time: 7.2401 / Avg. bwd time: 18.7158 / Avg. batch time: 454.8369 (ms) / GPU bubble ratio: 54.35%
[rank0]:2025-12-24 00:15:42,615 - Avg. fwd time: 7.6154 / Avg. bwd time: 21.8019 / Avg. batch time: 508.3820 (ms) / GPU bubble ratio: 53.71%
[rank3]:2025-12-24 00:15:42,569 - Avg. fwd time: 12.0634 / Avg. bwd time: 32.7075 / Avg. batch time: 430.0559 (ms) / GPU bubble ratio: 16.72%
[rank1]:2025-12-24 00:15:42,607 - Avg. fwd time: 9.5511 / Avg. bwd time: 24.0733 / Avg. batch time: 485.6324 (ms) / GPU bubble ratio: 44.61%
[rank2]:2025-12-24 00:15:42,636 -  step: 350  loss: -8.0000  grad_norm:  0.1123  memory:  6.98GiB(14.69%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank0]:2025-12-24 00:15:42,650 -  step: 350  loss: -8.0000  grad_norm:  0.1123  memory: 13.42GiB(28.26%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank3]:2025-12-24 00:15:42,649 -  step: 350  loss:  0.2217  grad_norm:  0.1123  memory: 16.39GiB(34.50%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank1]:2025-12-24 00:15:42,640 -  step: 350  loss: -8.0000  grad_norm:  0.1123  memory:  9.50GiB(19.99%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank3]:2025-12-24 00:17:18,349 - Avg. fwd time: 12.0418 / Avg. bwd time: 32.4841 / Avg. batch time: 428.0951 (ms) / GPU bubble ratio: 16.79%
[rank2]:2025-12-24 00:17:18,367 - Avg. fwd time: 7.2414 / Avg. bwd time: 18.7146 / Avg. batch time: 452.6237 (ms) / GPU bubble ratio: 54.12%
[rank0]:2025-12-24 00:17:18,395 - Avg. fwd time: 7.6155 / Avg. bwd time: 21.7496 / Avg. batch time: 505.2447 (ms) / GPU bubble ratio: 53.50%
[rank1]:2025-12-24 00:17:18,387 - Avg. fwd time: 9.5559 / Avg. bwd time: 24.0788 / Avg. batch time: 483.1452 (ms) / GPU bubble ratio: 44.31%
[rank0]:2025-12-24 00:18:50,307 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 00:18:54,128 - Avg. fwd time: 12.0231 / Avg. bwd time: 32.2871 / Avg. batch time: 426.3695 (ms) / GPU bubble ratio: 16.86%
[rank1]:2025-12-24 00:18:54,166 - Avg. fwd time: 9.5608 / Avg. bwd time: 24.0853 / Avg. batch time: 480.9656 (ms) / GPU bubble ratio: 44.04%
[rank2]:2025-12-24 00:18:54,146 - Avg. fwd time: 7.2432 / Avg. bwd time: 18.7140 / Avg. batch time: 450.6789 (ms) / GPU bubble ratio: 53.92%
[rank0]:2025-12-24 00:18:54,175 - Avg. fwd time: 7.6160 / Avg. bwd time: 21.6845 / Avg. batch time: 502.5082 (ms) / GPU bubble ratio: 53.35%
[rank3]:2025-12-24 00:18:54,209 -  step: 400  loss:  0.2100  grad_norm:  0.1189  memory: 16.39GiB(34.50%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank1]:2025-12-24 00:18:54,200 -  step: 400  loss: -8.0000  grad_norm:  0.1189  memory:  9.50GiB(19.99%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank1]:2025-12-24 00:18:54,264 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251224_0018_stage1_step400.svg
[rank2]:2025-12-24 00:18:54,197 -  step: 400  loss: -8.0000  grad_norm:  0.1189  memory:  6.98GiB(14.69%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank2]:2025-12-24 00:18:54,266 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251224_0018_stage2_step400.svg
[rank0]:2025-12-24 00:18:54,211 -  step: 400  loss: -8.0000  grad_norm:  0.1189  memory: 13.42GiB(28.26%)  tps: 8,553  tflops: 66.86  mfu: 21.43%
[rank0]:2025-12-24 00:18:54,265 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251224_0018_stage0_step400.svg
[rank3]:2025-12-24 00:18:54,359 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0018_step400_rank3.svg
[rank3]:			> Batch Time: 465.50 ms, GPU Bubble Ratio: 51.47%, 42.01%, 55.35%, 28.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  295-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  356-25-381ms   | [S0,MB5,B]  398-25-423ms   | [S0,MB6,B]  440-13-453ms   | [S0,MB7,B]  465-0-465ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  207-9-216ms    | [S1,MB2,B]  221-25-247ms   | [S1,MB5,F]  251-9-260ms    | [S1,MB3,B]  264-26-290ms   | [S1,MB6,F]  294-9-303ms    | [S1,MB4,B]  325-25-351ms   | [S1,MB7,F]  355-9-364ms    | [S1,MB5,B]  369-25-394ms   | [S1,MB6,B]  410-26-436ms   | [S1,MB7,B]  449-12-461ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-6-183ms    | [S2,MB2,B]  197-20-217ms   | [S2,MB4,F]  220-6-227ms    | [S2,MB3,B]  239-20-259ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  301-20-321ms   | [S2,MB6,F]  324-7-331ms    | [S2,MB5,B]  345-20-365ms   | [S2,MB7,F]  367-7-374ms    | [S2,MB6,B]  386-20-407ms   | [S2,MB7,B]  437-8-445ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-12-165ms   | [S3,MB2,B]  171-21-192ms   | [S3,MB3,F]  196-11-207ms   | [S3,MB3,B]  213-21-234ms   | [S3,MB4,F]  238-11-249ms   | [S3,MB4,B]  255-41-296ms   | [S3,MB5,F]  300-12-312ms   | [S3,MB5,B]  318-21-339ms   | [S3,MB6,F]  343-10-354ms   | [S3,MB6,B]  360-21-381ms   | [S3,MB7,F]  385-10-396ms   | [S3,MB7,B]  402-32-434ms  
[rank3]:2025-12-24 00:18:54,408 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251224_0018_stage3_step400.svg
[rank1]:2025-12-24 00:18:55,109 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0018_stage1.svg
[rank2]:2025-12-24 00:18:55,131 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0018_stage2.svg
[rank0]:2025-12-24 00:18:55,117 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0018_stage0.svg
[rank3]:2025-12-24 00:18:55,290 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0018_stage3.svg
[rank3]:2025-12-24 00:19:16,914 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 00:19:17,103 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 00:19:17,123 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 00:19:17,125 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-24 00:20:29,864 - Avg. fwd time: 11.9965 / Avg. bwd time: 32.0724 / Avg. batch time: 424.4383 (ms) / GPU bubble ratio: 16.94%
[rank2]:2025-12-24 00:20:29,883 - Avg. fwd time: 7.2436 / Avg. bwd time: 18.7116 / Avg. batch time: 448.5974 (ms) / GPU bubble ratio: 53.71%
[rank1]:2025-12-24 00:20:29,904 - Avg. fwd time: 9.5673 / Avg. bwd time: 24.0908 / Avg. batch time: 478.6790 (ms) / GPU bubble ratio: 43.75%
[rank0]:2025-12-24 00:20:29,912 - Avg. fwd time: 7.6157 / Avg. bwd time: 21.6410 / Avg. batch time: 499.8363 (ms) / GPU bubble ratio: 53.17%
[rank0]:2025-12-24 00:22:00,359 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 00:22:04,079 - Avg. fwd time: 11.9739 / Avg. bwd time: 31.8770 / Avg. batch time: 422.6938 (ms) / GPU bubble ratio: 17.01%
[rank2]:2025-12-24 00:22:04,098 - Avg. fwd time: 7.2436 / Avg. bwd time: 18.7088 / Avg. batch time: 446.6787 (ms) / GPU bubble ratio: 53.52%
[rank1]:2025-12-24 00:22:04,119 - Avg. fwd time: 9.5712 / Avg. bwd time: 24.0938 / Avg. batch time: 476.5885 (ms) / GPU bubble ratio: 43.49%
[rank0]:2025-12-24 00:22:04,128 - Avg. fwd time: 7.6147 / Avg. bwd time: 21.5842 / Avg. batch time: 497.2950 (ms) / GPU bubble ratio: 53.03%
[rank3]:2025-12-24 00:22:04,163 -  step: 450  loss:  0.2240  grad_norm:  0.1177  memory: 16.39GiB(34.50%)  tps: 8,625  tflops: 67.43  mfu: 21.61%
[rank2]:2025-12-24 00:22:04,150 -  step: 450  loss: -8.0000  grad_norm:  0.1177  memory:  6.98GiB(14.69%)  tps: 8,625  tflops: 67.43  mfu: 21.61%
[rank1]:2025-12-24 00:22:04,153 -  step: 450  loss: -8.0000  grad_norm:  0.1177  memory:  9.50GiB(19.99%)  tps: 8,625  tflops: 67.43  mfu: 21.61%
[rank0]:2025-12-24 00:22:04,164 -  step: 450  loss: -8.0000  grad_norm:  0.1177  memory: 13.42GiB(28.26%)  tps: 8,625  tflops: 67.43  mfu: 21.61%
[rank3]:2025-12-24 00:23:38,687 - Avg. fwd time: 11.9591 / Avg. bwd time: 31.7077 / Avg. batch time: 421.2210 (ms) / GPU bubble ratio: 17.07%
[rank1]:2025-12-24 00:23:38,728 - Avg. fwd time: 9.5747 / Avg. bwd time: 24.0980 / Avg. batch time: 474.7997 (ms) / GPU bubble ratio: 43.26%
[rank0]:2025-12-24 00:23:38,737 - Avg. fwd time: 7.6140 / Avg. bwd time: 21.5356 / Avg. batch time: 495.1061 (ms) / GPU bubble ratio: 52.90%
[rank2]:2025-12-24 00:23:38,706 - Avg. fwd time: 7.2443 / Avg. bwd time: 18.7067 / Avg. batch time: 445.0490 (ms) / GPU bubble ratio: 53.35%
[rank0]:2025-12-24 00:25:10,245 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 00:25:14,023 - Avg. fwd time: 11.9486 / Avg. bwd time: 31.5570 / Avg. batch time: 419.9317 (ms) / GPU bubble ratio: 17.12%
[rank2]:2025-12-24 00:25:14,042 - Avg. fwd time: 7.2451 / Avg. bwd time: 18.7043 / Avg. batch time: 443.6177 (ms) / GPU bubble ratio: 53.20%
[rank0]:2025-12-24 00:25:14,074 - Avg. fwd time: 7.6143 / Avg. bwd time: 21.5127 / Avg. batch time: 493.3044 (ms) / GPU bubble ratio: 52.76%
[rank3]:2025-12-24 00:25:14,108 -  step: 500  loss:  0.2156  grad_norm:  0.1233  memory: 16.39GiB(34.50%)  tps: 8,626  tflops: 67.43  mfu: 21.61%
[rank1]:2025-12-24 00:25:14,064 - Avg. fwd time: 9.5791 / Avg. bwd time: 24.1032 / Avg. batch time: 473.2275 (ms) / GPU bubble ratio: 43.06%
[rank1]:2025-12-24 00:25:14,099 -  step: 500  loss: -8.0000  grad_norm:  0.1233  memory:  9.50GiB(19.99%)  tps: 8,626  tflops: 67.43  mfu: 21.61%
[rank1]:2025-12-24 00:25:14,158 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251224_0025_stage1_step500.svg
[rank2]:2025-12-24 00:25:14,095 -  step: 500  loss: -8.0000  grad_norm:  0.1233  memory:  6.98GiB(14.69%)  tps: 8,626  tflops: 67.43  mfu: 21.61%
[rank2]:2025-12-24 00:25:14,159 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251224_0025_stage2_step500.svg
[rank0]:2025-12-24 00:25:14,110 -  step: 500  loss: -8.0000  grad_norm:  0.1233  memory: 13.42GiB(28.26%)  tps: 8,626  tflops: 67.43  mfu: 21.61%
[rank0]:2025-12-24 00:25:14,165 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251224_0025_stage0_step500.svg
[rank3]:2025-12-24 00:25:14,254 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0025_step500_rank3.svg
[rank3]:			> Batch Time: 458.75 ms, GPU Bubble Ratio: 50.10%, 40.98%, 54.71%, 29.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  252-25-277ms   | [S0,MB6,F]  277-7-284ms    | [S0,MB3,B]  295-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  354-25-380ms   | [S0,MB5,B]  398-25-423ms   | [S0,MB6,B]  439-16-455ms   | [S0,MB7,B]  458-0-458ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  206-9-216ms    | [S1,MB2,B]  221-26-247ms   | [S1,MB5,F]  250-9-260ms    | [S1,MB3,B]  263-26-290ms   | [S1,MB6,F]  294-10-304ms   | [S1,MB4,B]  323-25-349ms   | [S1,MB7,F]  353-9-362ms    | [S1,MB5,B]  368-26-394ms   | [S1,MB6,B]  410-26-436ms   | [S1,MB7,B]  440-12-452ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  197-20-217ms   | [S2,MB4,F]  219-7-226ms    | [S2,MB3,B]  239-20-259ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  300-19-320ms   | [S2,MB6,F]  322-7-329ms    | [S2,MB5,B]  344-20-364ms   | [S2,MB7,F]  367-7-374ms    | [S2,MB6,B]  386-20-406ms   | [S2,MB7,B]  428-8-436ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-13-166ms   | [S3,MB2,B]  171-21-192ms   | [S3,MB3,F]  195-10-206ms   | [S3,MB3,B]  212-21-234ms   | [S3,MB4,F]  237-10-248ms   | [S3,MB4,B]  254-41-295ms   | [S3,MB5,F]  298-12-311ms   | [S3,MB5,B]  318-21-339ms   | [S3,MB6,F]  343-11-354ms   | [S3,MB6,B]  360-21-381ms   | [S3,MB7,F]  384-10-395ms   | [S3,MB7,B]  401-22-424ms  
[rank3]:2025-12-24 00:25:14,298 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251224_0025_stage3_step500.svg
[rank2]:2025-12-24 00:25:15,284 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0025_stage2.svg
[rank0]:2025-12-24 00:25:15,280 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0025_stage0.svg
[rank1]:2025-12-24 00:25:15,271 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0025_stage1.svg
[rank3]:2025-12-24 00:25:15,428 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0025_stage3.svg
[rank3]:2025-12-24 00:26:50,955 - Avg. fwd time: 11.9403 / Avg. bwd time: 31.4255 / Avg. batch time: 418.8135 (ms) / GPU bubble ratio: 17.16%
[rank0]:2025-12-24 00:26:51,007 - Avg. fwd time: 7.6145 / Avg. bwd time: 21.5004 / Avg. batch time: 491.7866 (ms) / GPU bubble ratio: 52.64%
[rank2]:2025-12-24 00:26:50,974 - Avg. fwd time: 7.2459 / Avg. bwd time: 18.7021 / Avg. batch time: 442.3982 (ms) / GPU bubble ratio: 53.08%
[rank1]:2025-12-24 00:26:50,997 - Avg. fwd time: 9.5827 / Avg. bwd time: 24.1080 / Avg. batch time: 471.8820 (ms) / GPU bubble ratio: 42.88%
[rank0]:2025-12-24 00:28:22,556 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 00:28:26,364 - Avg. fwd time: 11.9336 / Avg. bwd time: 31.3065 / Avg. batch time: 417.8076 (ms) / GPU bubble ratio: 17.21%
[rank1]:2025-12-24 00:28:26,406 - Avg. fwd time: 9.5861 / Avg. bwd time: 24.1121 / Avg. batch time: 470.6398 (ms) / GPU bubble ratio: 42.72%
[rank0]:2025-12-24 00:28:26,416 - Avg. fwd time: 7.6148 / Avg. bwd time: 21.4783 / Avg. batch time: 490.3205 (ms) / GPU bubble ratio: 52.53%
[rank2]:2025-12-24 00:28:26,384 - Avg. fwd time: 7.2467 / Avg. bwd time: 18.6997 / Avg. batch time: 441.2732 (ms) / GPU bubble ratio: 52.96%
[rank2]:2025-12-24 00:28:26,438 -  step: 550  loss: -8.0000  grad_norm:  0.1026  memory:  6.98GiB(14.69%)  tps: 8,518  tflops: 66.59  mfu: 21.34%
[rank3]:2025-12-24 00:28:26,450 -  step: 550  loss:  0.2222  grad_norm:  0.1026  memory: 16.39GiB(34.50%)  tps: 8,518  tflops: 66.59  mfu: 21.34%
[rank1]:2025-12-24 00:28:26,441 -  step: 550  loss: -8.0000  grad_norm:  0.1026  memory:  9.50GiB(19.99%)  tps: 8,518  tflops: 66.59  mfu: 21.34%
[rank0]:2025-12-24 00:28:26,452 -  step: 550  loss: -8.0000  grad_norm:  0.1026  memory: 13.42GiB(28.26%)  tps: 8,518  tflops: 66.59  mfu: 21.34%
[rank2]:2025-12-24 00:30:01,280 - Avg. fwd time: 7.2472 / Avg. bwd time: 18.6969 / Avg. batch time: 440.1180 (ms) / GPU bubble ratio: 52.84%
[rank1]:2025-12-24 00:30:01,305 - Avg. fwd time: 9.5879 / Avg. bwd time: 24.1129 / Avg. batch time: 469.3790 (ms) / GPU bubble ratio: 42.56%
[rank3]:2025-12-24 00:30:01,260 - Avg. fwd time: 11.9202 / Avg. bwd time: 31.1889 / Avg. batch time: 416.7605 (ms) / GPU bubble ratio: 17.25%
[rank0]:2025-12-24 00:30:01,316 - Avg. fwd time: 7.6146 / Avg. bwd time: 21.4564 / Avg. batch time: 488.8739 (ms) / GPU bubble ratio: 52.43%
[rank0]:2025-12-24 00:31:32,343 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 00:31:36,111 - Avg. fwd time: 11.9067 / Avg. bwd time: 31.0813 / Avg. batch time: 415.7902 (ms) / GPU bubble ratio: 17.29%
[rank0]:2025-12-24 00:31:36,166 - Avg. fwd time: 7.6143 / Avg. bwd time: 21.4378 / Avg. batch time: 487.5393 (ms) / GPU bubble ratio: 52.33%
[rank2]:2025-12-24 00:31:36,132 - Avg. fwd time: 7.2474 / Avg. bwd time: 18.6937 / Avg. batch time: 439.0490 (ms) / GPU bubble ratio: 52.73%
[rank2]:2025-12-24 00:31:36,188 -  step: 600  loss: -8.0000  grad_norm:  0.1220  memory:  6.98GiB(14.69%)  tps: 8,635  tflops: 67.50  mfu: 21.63%
[rank3]:2025-12-24 00:31:36,200 -  step: 600  loss:  0.2184  grad_norm:  0.1220  memory: 16.39GiB(34.50%)  tps: 8,635  tflops: 67.50  mfu: 21.64%
[rank1]:2025-12-24 00:31:36,154 - Avg. fwd time: 9.5905 / Avg. bwd time: 24.1137 / Avg. batch time: 468.2055 (ms) / GPU bubble ratio: 42.41%
[rank1]:2025-12-24 00:31:36,191 -  step: 600  loss: -8.0000  grad_norm:  0.1220  memory:  9.50GiB(19.99%)  tps: 8,635  tflops: 67.50  mfu: 21.63%
[rank1]:2025-12-24 00:31:36,251 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251224_0031_stage1_step600.svg
[rank0]:2025-12-24 00:31:36,202 -  step: 600  loss: -8.0000  grad_norm:  0.1220  memory: 13.42GiB(28.26%)  tps: 8,635  tflops: 67.50  mfu: 21.63%
[rank0]:2025-12-24 00:31:36,252 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251224_0031_stage0_step600.svg
[rank2]:2025-12-24 00:31:36,255 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251224_0031_stage2_step600.svg
[rank3]:2025-12-24 00:31:36,343 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0031_step600_rank3.svg
[rank3]:			> Batch Time: 458.50 ms, GPU Bubble Ratio: 49.12%, 41.21%, 54.87%, 29.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-172ms   | [S0,MB4,F]  172-7-179ms    | [S0,MB1,B]  207-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  250-25-276ms   | [S0,MB6,F]  276-7-283ms    | [S0,MB3,B]  293-25-319ms   | [S0,MB7,F]  319-7-326ms    | [S0,MB4,B]  353-25-378ms   | [S0,MB5,B]  396-25-421ms   | [S0,MB6,B]  437-20-458ms   | [S0,MB7,B]  458-0-458ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  116-25-142ms   | [S1,MB3,F]  145-9-154ms    | [S1,MB1,B]  177-25-202ms   | [S1,MB4,F]  206-9-215ms    | [S1,MB2,B]  219-25-245ms   | [S1,MB5,F]  249-9-258ms    | [S1,MB3,B]  262-26-288ms   | [S1,MB6,F]  292-10-302ms   | [S1,MB4,B]  322-25-348ms   | [S1,MB7,F]  352-9-361ms    | [S1,MB5,B]  366-25-392ms   | [S1,MB6,B]  408-26-434ms   | [S1,MB7,B]  438-11-449ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-112ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  153-19-173ms   | [S2,MB3,F]  175-6-182ms    | [S2,MB2,B]  195-20-215ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  237-20-257ms   | [S2,MB5,F]  260-7-267ms    | [S2,MB4,B]  298-19-318ms   | [S2,MB6,F]  320-7-327ms    | [S2,MB5,B]  342-20-362ms   | [S2,MB7,F]  365-7-372ms    | [S2,MB6,B]  384-20-404ms   | [S2,MB7,B]  425-8-434ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-40-148ms   | [S3,MB2,F]  152-11-163ms   | [S3,MB2,B]  169-21-190ms   | [S3,MB3,F]  194-10-205ms   | [S3,MB3,B]  211-21-232ms   | [S3,MB4,F]  235-10-246ms   | [S3,MB4,B]  252-41-293ms   | [S3,MB5,F]  297-12-309ms   | [S3,MB5,B]  316-21-337ms   | [S3,MB6,F]  340-11-351ms   | [S3,MB6,B]  357-21-379ms   | [S3,MB7,F]  382-10-393ms   | [S3,MB7,B]  399-23-422ms  
[rank3]:2025-12-24 00:31:36,389 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251224_0031_stage3_step600.svg
[rank1]:2025-12-24 00:31:37,592 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0031_stage1.svg
[rank0]:2025-12-24 00:31:37,611 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0031_stage0.svg
[rank2]:2025-12-24 00:31:37,700 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0031_stage2.svg
[rank3]:2025-12-24 00:31:37,804 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0031_stage3.svg
[rank3]:2025-12-24 00:33:12,222 - Avg. fwd time: 11.8970 / Avg. bwd time: 30.9812 / Avg. batch time: 414.9118 (ms) / GPU bubble ratio: 17.33%
[rank1]:2025-12-24 00:33:12,267 - Avg. fwd time: 9.5929 / Avg. bwd time: 24.1151 / Avg. batch time: 467.1835 (ms) / GPU bubble ratio: 42.28%
[rank0]:2025-12-24 00:33:12,278 - Avg. fwd time: 7.6140 / Avg. bwd time: 21.4087 / Avg. batch time: 486.2884 (ms) / GPU bubble ratio: 52.25%
[rank2]:2025-12-24 00:33:12,243 - Avg. fwd time: 7.2481 / Avg. bwd time: 18.6915 / Avg. batch time: 438.0990 (ms) / GPU bubble ratio: 52.63%
[rank0]:2025-12-24 00:34:43,711 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 00:34:47,457 - Avg. fwd time: 11.8926 / Avg. bwd time: 30.8923 / Avg. batch time: 414.1657 (ms) / GPU bubble ratio: 17.36%
[rank1]:2025-12-24 00:34:47,501 - Avg. fwd time: 9.5951 / Avg. bwd time: 24.1178 / Avg. batch time: 466.2776 (ms) / GPU bubble ratio: 42.16%
[rank0]:2025-12-24 00:34:47,513 - Avg. fwd time: 7.6139 / Avg. bwd time: 21.3925 / Avg. batch time: 485.2292 (ms) / GPU bubble ratio: 52.18%
[rank2]:2025-12-24 00:34:47,478 - Avg. fwd time: 7.2489 / Avg. bwd time: 18.6897 / Avg. batch time: 437.2681 (ms) / GPU bubble ratio: 52.54%
[rank2]:2025-12-24 00:34:47,534 -  step: 650  loss: -8.0000  grad_norm:  0.1037  memory:  6.98GiB(14.69%)  tps: 8,563  tflops: 66.94  mfu: 21.45%
[rank3]:2025-12-24 00:34:47,547 -  step: 650  loss:  0.2272  grad_norm:  0.1037  memory: 16.39GiB(34.50%)  tps: 8,563  tflops: 66.94  mfu: 21.45%
[rank1]:2025-12-24 00:34:47,538 -  step: 650  loss: -8.0000  grad_norm:  0.1037  memory:  9.50GiB(19.99%)  tps: 8,562  tflops: 66.94  mfu: 21.45%
[rank0]:2025-12-24 00:34:47,549 -  step: 650  loss: -8.0000  grad_norm:  0.1037  memory: 13.42GiB(28.26%)  tps: 8,563  tflops: 66.94  mfu: 21.45%
[rank2]:2025-12-24 00:36:22,472 - Avg. fwd time: 7.2497 / Avg. bwd time: 18.6880 / Avg. batch time: 436.5104 (ms) / GPU bubble ratio: 52.46%
[rank3]:2025-12-24 00:36:22,451 - Avg. fwd time: 11.8879 / Avg. bwd time: 30.8121 / Avg. batch time: 413.4875 (ms) / GPU bubble ratio: 17.39%
[rank1]:2025-12-24 00:36:22,496 - Avg. fwd time: 9.5969 / Avg. bwd time: 24.1208 / Avg. batch time: 465.4471 (ms) / GPU bubble ratio: 42.05%
[rank0]:2025-12-24 00:36:22,508 - Avg. fwd time: 7.6140 / Avg. bwd time: 21.3695 / Avg. batch time: 484.2031 (ms) / GPU bubble ratio: 52.11%
[rank0]:2025-12-24 00:37:53,931 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 00:37:57,748 - Avg. fwd time: 11.8844 / Avg. bwd time: 30.7393 / Avg. batch time: 412.8781 (ms) / GPU bubble ratio: 17.41%
[rank2]:2025-12-24 00:37:57,770 - Avg. fwd time: 7.2503 / Avg. bwd time: 18.6864 / Avg. batch time: 435.8262 (ms) / GPU bubble ratio: 52.39%
[rank2]:2025-12-24 00:37:57,828 -  step: 700  loss: -8.0000  grad_norm:  0.0990  memory:  6.98GiB(14.69%)  tps: 8,610  tflops: 67.31  mfu: 21.57%
[rank3]:2025-12-24 00:37:57,840 -  step: 700  loss:  0.1881  grad_norm:  0.0990  memory: 16.39GiB(34.50%)  tps: 8,610  tflops: 67.31  mfu: 21.57%
[rank1]:2025-12-24 00:37:57,794 - Avg. fwd time: 9.5982 / Avg. bwd time: 24.1237 / Avg. batch time: 464.6980 (ms) / GPU bubble ratio: 41.95%
[rank1]:2025-12-24 00:37:57,831 -  step: 700  loss: -8.0000  grad_norm:  0.0990  memory:  9.50GiB(19.99%)  tps: 8,610  tflops: 67.31  mfu: 21.57%
[rank0]:2025-12-24 00:37:57,806 - Avg. fwd time: 7.6139 / Avg. bwd time: 21.3551 / Avg. batch time: 483.3137 (ms) / GPU bubble ratio: 52.05%
[rank0]:2025-12-24 00:37:57,842 -  step: 700  loss: -8.0000  grad_norm:  0.0990  memory: 13.42GiB(28.26%)  tps: 8,610  tflops: 67.31  mfu: 21.57%
[rank0]:2025-12-24 00:37:57,893 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251224_0037_stage0_step700.svg
[rank2]:2025-12-24 00:37:57,895 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251224_0037_stage2_step700.svg
[rank1]:2025-12-24 00:37:57,893 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251224_0037_stage1_step700.svg
[rank3]:2025-12-24 00:37:57,981 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0037_step700_rank3.svg
[rank3]:			> Batch Time: 462.75 ms, GPU Bubble Ratio: 49.86%, 41.47%, 55.11%, 29.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-234ms   | [S0,MB5,F]  234-7-241ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  296-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  357-25-382ms   | [S0,MB5,B]  399-25-424ms   | [S0,MB6,B]  441-18-460ms   | [S0,MB7,B]  462-0-462ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  207-9-216ms    | [S1,MB2,B]  222-25-248ms   | [S1,MB5,F]  251-9-261ms    | [S1,MB3,B]  264-26-290ms   | [S1,MB6,F]  294-9-304ms    | [S1,MB4,B]  326-25-352ms   | [S1,MB7,F]  355-9-364ms    | [S1,MB5,B]  369-26-395ms   | [S1,MB6,B]  411-26-438ms   | [S1,MB7,B]  443-12-456ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  220-7-227ms    | [S2,MB3,B]  240-20-260ms   | [S2,MB5,F]  262-7-270ms    | [S2,MB4,B]  302-20-322ms   | [S2,MB6,F]  324-7-331ms    | [S2,MB5,B]  345-20-365ms   | [S2,MB7,F]  368-7-375ms    | [S2,MB6,B]  388-20-408ms   | [S2,MB7,B]  431-8-440ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-102ms    | [S3,MB1,B]  109-40-149ms   | [S3,MB2,F]  153-12-165ms   | [S3,MB2,B]  171-21-193ms   | [S3,MB3,F]  196-11-207ms   | [S3,MB3,B]  213-21-235ms   | [S3,MB4,F]  238-11-249ms   | [S3,MB4,B]  255-41-297ms   | [S3,MB5,F]  300-12-313ms   | [S3,MB5,B]  319-21-340ms   | [S3,MB6,F]  344-10-355ms   | [S3,MB6,B]  361-21-383ms   | [S3,MB7,F]  386-11-397ms   | [S3,MB7,B]  403-23-427ms  
[rank3]:2025-12-24 00:37:58,027 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251224_0037_stage3_step700.svg
[rank0]:2025-12-24 00:37:59,484 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0037_stage0.svg
[rank1]:2025-12-24 00:37:59,468 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0037_stage1.svg
[rank2]:2025-12-24 00:37:59,541 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0037_stage2.svg
[rank3]:2025-12-24 00:37:59,686 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0037_stage3.svg
[rank3]:2025-12-24 00:39:35,250 - Avg. fwd time: 11.8751 / Avg. bwd time: 30.6860 / Avg. batch time: 412.3771 (ms) / GPU bubble ratio: 17.43%
[rank0]:2025-12-24 00:39:35,310 - Avg. fwd time: 7.6135 / Avg. bwd time: 21.3487 / Avg. batch time: 482.5867 (ms) / GPU bubble ratio: 51.99%
[rank2]:2025-12-24 00:39:35,271 - Avg. fwd time: 7.2503 / Avg. bwd time: 18.6840 / Avg. batch time: 435.2790 (ms) / GPU bubble ratio: 52.34%
[rank1]:2025-12-24 00:39:35,295 - Avg. fwd time: 9.6003 / Avg. bwd time: 24.1241 / Avg. batch time: 464.0767 (ms) / GPU bubble ratio: 41.86%
[rank0]:2025-12-24 00:41:06,173 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 00:41:09,920 - Avg. fwd time: 11.8639 / Avg. bwd time: 30.6182 / Avg. batch time: 411.7452 (ms) / GPU bubble ratio: 17.46%
[rank2]:2025-12-24 00:41:09,942 - Avg. fwd time: 7.2505 / Avg. bwd time: 18.6816 / Avg. batch time: 434.5822 (ms) / GPU bubble ratio: 52.26%
[rank2]:2025-12-24 00:41:10,001 -  step: 750  loss: -8.0000  grad_norm:  0.1288  memory:  6.98GiB(14.69%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank1]:2025-12-24 00:41:09,966 - Avg. fwd time: 9.6017 / Avg. bwd time: 24.1248 / Avg. batch time: 463.3136 (ms) / GPU bubble ratio: 41.76%
[rank1]:2025-12-24 00:41:10,004 -  step: 750  loss: -8.0000  grad_norm:  0.1288  memory:  9.50GiB(19.99%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank0]:2025-12-24 00:41:09,979 - Avg. fwd time: 7.6129 / Avg. bwd time: 21.3327 / Avg. batch time: 481.6975 (ms) / GPU bubble ratio: 51.93%
[rank0]:2025-12-24 00:41:10,015 -  step: 750  loss: -8.0000  grad_norm:  0.1288  memory: 13.42GiB(28.26%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank3]:2025-12-24 00:41:10,013 -  step: 750  loss:  0.2273  grad_norm:  0.1288  memory: 16.39GiB(34.50%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank3]:2025-12-24 00:42:45,628 - Avg. fwd time: 11.8556 / Avg. bwd time: 30.5810 / Avg. batch time: 411.3810 (ms) / GPU bubble ratio: 17.47%
[rank2]:2025-12-24 00:42:45,650 - Avg. fwd time: 7.2511 / Avg. bwd time: 18.6796 / Avg. batch time: 434.1551 (ms) / GPU bubble ratio: 52.22%
[rank1]:2025-12-24 00:42:45,675 - Avg. fwd time: 9.6016 / Avg. bwd time: 24.1248 / Avg. batch time: 462.8227 (ms) / GPU bubble ratio: 41.70%
[rank0]:2025-12-24 00:42:45,688 - Avg. fwd time: 7.6125 / Avg. bwd time: 21.3120 / Avg. batch time: 481.0360 (ms) / GPU bubble ratio: 51.90%
[rank0]:2025-12-24 00:44:17,459 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 00:44:21,245 - Avg. fwd time: 11.8519 / Avg. bwd time: 30.5283 / Avg. batch time: 410.9300 (ms) / GPU bubble ratio: 17.49%
[rank0]:2025-12-24 00:44:21,306 - Avg. fwd time: 7.6126 / Avg. bwd time: 21.3050 / Avg. batch time: 480.4030 (ms) / GPU bubble ratio: 51.84%
[rank3]:2025-12-24 00:44:21,340 -  step: 800  loss:  0.2322  grad_norm:  0.1154  memory: 16.39GiB(34.50%)  tps: 8,563  tflops: 66.95  mfu: 21.46%
[rank3]:2025-12-24 00:44:21,341 - â„¹ï¸ final step: 800  loss:  0.2322  grad_norm:  0.1154  tps: 8,720  tflops: 68.17  mfu: 20.08%
[rank3]:2025-12-24 00:44:21,341 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 00:44:21,342 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-24 00:44:21,268 - Avg. fwd time: 7.2516 / Avg. bwd time: 18.6778 / Avg. batch time: 433.6467 (ms) / GPU bubble ratio: 52.16%
[rank2]:2025-12-24 00:44:21,328 -  step: 800  loss: -8.0000  grad_norm:  0.1154  memory:  6.98GiB(14.69%)  tps: 8,563  tflops: 66.94  mfu: 21.46%
[rank2]:2025-12-24 00:44:21,328 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1154  tps: 8,714  tflops: 68.12  mfu: 19.95%
[rank2]:2025-12-24 00:44:21,328 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 00:44:21,328 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 00:44:21,293 - Avg. fwd time: 9.6028 / Avg. bwd time: 24.1262 / Avg. batch time: 462.2623 (ms) / GPU bubble ratio: 41.63%
[rank1]:2025-12-24 00:44:21,331 -  step: 800  loss: -8.0000  grad_norm:  0.1154  memory:  9.50GiB(19.99%)  tps: 8,563  tflops: 66.94  mfu: 21.46%
[rank1]:2025-12-24 00:44:21,331 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1154  tps: 8,721  tflops: 68.18  mfu: 20.12%
[rank1]:2025-12-24 00:44:21,331 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 00:44:21,332 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 00:44:21,342 -  step: 800  loss: -8.0000  grad_norm:  0.1154  memory: 13.42GiB(28.26%)  tps: 8,563  tflops: 66.94  mfu: 21.46%
[rank0]:2025-12-24 00:44:21,342 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1154  tps: 8,714  tflops: 68.12  mfu: 19.96%
[rank0]:2025-12-24 00:44:21,342 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 00:44:21,343 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 00:44:23,153 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-24 00:44:23,226 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251224_0044_stage2_final800.svg
[rank1]:2025-12-24 00:44:23,226 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251224_0044_stage1_final800.svg
[rank0]:2025-12-24 00:44:23,226 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251224_0044_stage0_final800.svg
[rank3]:2025-12-24 00:44:23,310 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0044_final800_rank3.svg
[rank3]:			> Batch Time: 461.25 ms, GPU Bubble Ratio: 50.50%, 41.57%, 55.03%, 29.63%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  252-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  296-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  356-25-381ms   | [S0,MB5,B]  399-25-424ms   | [S0,MB6,B]  441-15-456ms   | [S0,MB7,B]  461-0-461ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  177-25-203ms   | [S1,MB4,F]  206-9-215ms    | [S1,MB2,B]  221-25-247ms   | [S1,MB5,F]  251-9-260ms    | [S1,MB3,B]  264-26-290ms   | [S1,MB6,F]  294-9-304ms    | [S1,MB4,B]  325-25-351ms   | [S1,MB7,F]  354-9-364ms    | [S1,MB5,B]  369-25-395ms   | [S1,MB6,B]  411-26-437ms   | [S1,MB7,B]  444-12-456ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-173ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  197-20-217ms   | [S2,MB4,F]  220-7-227ms    | [S2,MB3,B]  239-20-260ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  301-19-321ms   | [S2,MB6,F]  323-7-330ms    | [S2,MB5,B]  345-20-365ms   | [S2,MB7,F]  368-7-375ms    | [S2,MB6,B]  388-20-408ms   | [S2,MB7,B]  431-8-440ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-12-164ms   | [S3,MB2,B]  170-21-191ms   | [S3,MB3,F]  196-10-207ms   | [S3,MB3,B]  213-21-234ms   | [S3,MB4,F]  238-10-249ms   | [S3,MB4,B]  255-41-296ms   | [S3,MB5,F]  300-12-312ms   | [S3,MB5,B]  319-21-340ms   | [S3,MB6,F]  344-11-355ms   | [S3,MB6,B]  361-21-383ms   | [S3,MB7,F]  386-11-397ms   | [S3,MB7,B]  403-23-427ms  
[rank0]:2025-12-24 00:44:23,381 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251224_0044_rank0_stage0.svg
[rank0]:	> Counts Sum: 315600, Total Sum: 1728640 (18.26%), Ratio(%) per element: [21.4, 22.6, 20.37, 21.91, 21.74, 19.17, 20.03, 20.54, 20.2, 21.4, 20.71, 19.86, 19.52, 20.54, 19.86, 19.34, 18.49, 19.34, 18.66, 18.32, 18.66, 17.12, 17.12, 17.46, 16.95, 17.46, 16.6, 16.6, 15.23, 16.43, 14.72, 15.23, 14.72, 15.23, 13.52, 15.06, 13.18]
[rank3]:2025-12-24 00:44:23,442 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251224_0044_thry_final800_rank3.svg
[rank3]:			> Batch Time: 297.34 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB0,B]  90-18-108ms    | [S0,MB4,F]  108-9-117ms    | [S0,MB1,B]  117-18-135ms   | [S0,MB5,F]  135-9-144ms    | [S0,MB2,B]  144-18-162ms   | [S0,MB6,F]  162-9-171ms    | [S0,MB3,B]  171-18-189ms   | [S0,MB7,F]  189-9-198ms    | [S0,MB4,B]  198-18-216ms   | [S0,MB5,B]  225-18-243ms   | [S0,MB6,B]  252-18-270ms   | [S0,MB7,B]  279-18-297ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-18ms       | [S1,MB1,F]  18-9-27ms      | [S1,MB2,F]  27-9-36ms      | [S1,MB0,B]  72-18-90ms     | [S1,MB3,F]  90-9-99ms      | [S1,MB1,B]  99-18-117ms    | [S1,MB4,F]  117-9-126ms    | [S1,MB2,B]  126-18-144ms   | [S1,MB5,F]  144-9-153ms    | [S1,MB3,B]  153-18-171ms   | [S1,MB6,F]  171-9-180ms    | [S1,MB4,B]  180-18-198ms   | [S1,MB7,F]  198-9-207ms    | [S1,MB5,B]  207-18-225ms   | [S1,MB6,B]  234-18-252ms   | [S1,MB7,B]  261-18-279ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  18-9-27ms      | [S2,MB1,F]  27-9-36ms      | [S2,MB0,B]  54-18-72ms     | [S2,MB2,F]  72-9-81ms      | [S2,MB1,B]  81-18-99ms     | [S2,MB3,F]  99-9-108ms     | [S2,MB2,B]  108-18-126ms   | [S2,MB4,F]  126-9-135ms    | [S2,MB3,B]  135-18-153ms   | [S2,MB5,F]  153-9-162ms    | [S2,MB4,B]  162-18-180ms   | [S2,MB6,F]  180-9-189ms    | [S2,MB5,B]  189-18-207ms   | [S2,MB7,F]  207-9-216ms    | [S2,MB6,B]  216-18-234ms   | [S2,MB7,B]  243-18-261ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  27-9-36ms      | [S3,MB0,B]  36-18-54ms     | [S3,MB1,F]  54-9-63ms      | [S3,MB1,B]  63-18-81ms     | [S3,MB2,F]  81-9-90ms      | [S3,MB2,B]  90-18-108ms    | [S3,MB3,F]  108-9-117ms    | [S3,MB3,B]  117-18-135ms   | [S3,MB4,F]  135-9-144ms    | [S3,MB4,B]  144-18-162ms   | [S3,MB5,F]  162-9-171ms    | [S3,MB5,B]  171-18-189ms   | [S3,MB6,F]  189-9-198ms    | [S3,MB6,B]  198-18-216ms   | [S3,MB7,F]  216-9-225ms    | [S3,MB7,B]  225-18-243ms  
[rank2]:2025-12-24 00:44:23,379 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251224_0044_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank1]:2025-12-24 00:44:23,371 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251224_0044_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank3]:2025-12-24 00:44:23,490 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251224_0044_stage3_final800.svg
[rank3]:2025-12-24 00:44:23,628 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251224_0044_rank3_stage3.svg
[rank3]:	> Counts Sum: 769600, Total Sum: 1354880 (56.80%), Ratio(%) per element: [57.7, 57.36, 56.67, 57.02, 55.47, 57.53, 56.16, 56.67, 58.04, 56.33, 57.7, 55.47, 57.53, 55.3, 57.19, 57.02, 57.7, 56.33, 56.67, 56.67, 56.84, 56.5, 57.53, 56.5, 56.67, 56.16, 56.67, 55.82, 57.87]
[rank1]:2025-12-24 00:44:25,228 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0044_stage1.svg
[rank1]:2025-12-24 00:44:25,231 - Destroying the purge thread.
[rank0]:2025-12-24 00:44:25,247 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0044_stage0.svg
[rank0]:2025-12-24 00:44:25,250 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-24 00:44:25,268 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0044_stage2.svg
[rank2]:2025-12-24 00:44:25,271 - Destroying the purge thread.
[rank3]:2025-12-24 00:44:25,554 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251224_0044_stage3.svg
[rank3]:2025-12-24 00:44:25,558 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-24 00:44:25,617 - Process group destroyed
[rank1]:2025-12-24 00:44:25,707 - Process group destroyed
[rank3]:wandb: uploading history steps 16-16, summary, console lines 318-334
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.75778
[rank3]:wandb:               final/avg_loss 0.23215
[rank3]:wandb:             final/avg_mfu(%) 20.07823
[rank3]:wandb:             final/avg_tflops 68.16931
[rank3]:wandb:    final/avg_throughput(tps) 8720.04674
[rank3]:wandb:              final/grad_norm 0.11537
[rank3]:wandb:               final/max_loss 0.23215
[rank3]:wandb:                    grad_norm 0.11537
[rank3]:wandb: loss_metrics/global_avg_loss 0.23215
[rank3]:wandb: loss_metrics/global_max_loss 0.23215
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1223_1F1B_fullrand7_mfr0.6_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/6l6y5xl7
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.6_42_dm1/20251223-2351/wandb/run-20251223_235105-6l6y5xl7/logs
[rank3]:2025-12-24 00:44:27,133 - Process group destroyed
[rank0]:2025-12-24 00:44:27,251 - Training completed
[rank0]:2025-12-24 00:44:27,251 - Destroying the purge thread.
[rank0]:2025-12-24 00:44:27,339 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.9', 'layers.10', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'tok_embeddings', 'layers.1', 'layers.3', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.14', 'output', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1223_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.6
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.7', 'layers.4', 'layers.5', 'layers.6'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
