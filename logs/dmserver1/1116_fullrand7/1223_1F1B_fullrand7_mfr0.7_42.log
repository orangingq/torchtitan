
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 23. (í™”) 19:19:00 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1223_1F1B_fullrand7_mfr0.7_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.7) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-23 19:19:06,814 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:2025-12-23 19:19:06,761 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank0]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank0]:"
[rank3]:2025-12-23 19:19:06,899 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank2]:2025-12-23 19:19:06,967 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-23 19:19:06,969 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 19:19:07,044 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-23 19:19:07,020 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank1]:"
[rank3]:2025-12-23 19:19:07,110 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-23 19:19:07,112 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 19:19:07,046 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 19:19:07,049 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-23 19:19:07,050 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-23 19:19:07,212 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-23 19:19:07,214 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 19:19:07,433 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-23 19:19:10,357 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-23 19:19:10,397 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-23 19:19:10,425 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-23 19:19:10,425 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-23 19:19:10,599 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-23 19:19:10,600 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-23 19:19:10,600 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-23 19:19:10,583 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-23 19:19:10,729 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-23 19:19:10,770 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-23 19:19:10,771 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-23 19:19:10,797 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-23 19:19:10,797 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-23 19:19:10,980 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-23 19:19:11,022 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-23 19:19:11,049 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-23 19:19:11,050 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-23 19:19:10,977 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-23 19:19:10,977 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-23 19:19:10,977 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-23 19:19:11,244 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-23 19:19:11,244 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-23 19:19:11,244 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run asmjrdf1
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.7_42_dm1/20251223-1919/wandb/run-20251223_191911-asmjrdf1
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/asmjrdf1
[rank3]:2025-12-23 19:19:12,940 - WandB logging enabled
[rank3]:2025-12-23 19:19:12,940 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-23 19:19:12,979 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-23 19:19:13,009 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-23 19:19:13,010 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-23 19:19:13,202 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-23 19:19:13,202 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-23 19:19:13,203 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-23 19:19:13,218 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-23 19:19:13,218 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-23 19:19:13,218 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-23 19:19:13,218 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank0]:2025-12-23 19:19:13,218 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-23 19:19:13,219 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-23 19:19:13,219 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-23 19:19:15,097 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-23 19:19:15,097 - Finished loading the checkpoint in 1.88 seconds.
[rank0]:2025-12-23 19:19:15,097 - Training starts at step 1
[rank0]:2025-12-23 19:19:20,756 -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory:  9.62GiB(20.24%)  tps: 3,281  tflops: 25.65  mfu: 8.22%
[rank0]:2025-12-23 19:19:20,757 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-23 19:19:20,721 -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory:  5.20GiB(10.94%)  tps: 3,174  tflops: 24.81  mfu: 7.95%
[rank2]:2025-12-23 19:19:20,721 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-23 19:19:20,722 -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory:  7.10GiB(14.94%)  tps: 3,378  tflops: 26.41  mfu: 8.46%
[rank1]:2025-12-23 19:19:20,722 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-23 19:19:20,728 -  step:  1  loss: 10.6088  grad_norm: 116.5367  memory: 12.97GiB(27.31%)  tps: 4,230  tflops: 33.07  mfu: 10.60%
[rank3]:2025-12-23 19:19:20,729 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-23 19:21:19,886 - Avg. fwd time: 12.2323 / Avg. bwd time: 40.5041 / Avg. batch time: 493.8960 (ms) / GPU bubble ratio: 14.58%
[rank2]:2025-12-23 19:21:19,911 - Avg. fwd time: 7.2387 / Avg. bwd time: 19.5484 / Avg. batch time: 526.4686 (ms) / GPU bubble ratio: 59.30%
[rank1]:2025-12-23 19:21:19,941 - Avg. fwd time: 9.3470 / Avg. bwd time: 24.9420 / Avg. batch time: 566.6647 (ms) / GPU bubble ratio: 51.59%
[rank0]:2025-12-23 19:21:19,970 - Avg. fwd time: 7.5729 / Avg. bwd time: 24.8856 / Avg. batch time: 605.3244 (ms) / GPU bubble ratio: 57.10%
[rank0]:2025-12-23 19:23:20,802 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-23 19:23:25,737 - Avg. fwd time: 7.2356 / Avg. bwd time: 19.6129 / Avg. batch time: 530.4624 (ms) / GPU bubble ratio: 59.51%
[rank3]:2025-12-23 19:23:25,712 - Avg. fwd time: 12.4782 / Avg. bwd time: 40.8135 / Avg. batch time: 498.2652 (ms) / GPU bubble ratio: 14.44%
[rank1]:2025-12-23 19:23:25,767 - Avg. fwd time: 9.3759 / Avg. bwd time: 25.0457 / Avg. batch time: 570.3029 (ms) / GPU bubble ratio: 51.71%
[rank2]:2025-12-23 19:23:25,818 -  step: 50  loss: -8.0000  grad_norm: 12.8804  memory:  6.98GiB(14.69%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank3]:2025-12-23 19:23:25,830 -  step: 50  loss:  9.9131  grad_norm: 12.8804  memory: 16.39GiB(34.50%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank1]:2025-12-23 19:23:25,822 -  step: 50  loss: -8.0000  grad_norm: 12.8804  memory:  9.50GiB(19.99%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank0]:2025-12-23 19:23:25,797 - Avg. fwd time: 7.5887 / Avg. bwd time: 24.9469 / Avg. batch time: 608.6481 (ms) / GPU bubble ratio: 57.24%
[rank0]:2025-12-23 19:23:25,833 -  step: 50  loss: -8.0000  grad_norm: 12.8804  memory: 13.42GiB(28.26%)  tps: 6,552  tflops: 51.22  mfu: 16.42%
[rank3]:2025-12-23 19:24:10,958 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-23 19:25:01,325 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-23 19:25:01,642 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-23 19:25:20,848 - Avg. fwd time: 7.2286 / Avg. bwd time: 18.7588 / Avg. batch time: 517.5128 (ms) / GPU bubble ratio: 59.83%
[rank3]:2025-12-23 19:25:20,834 - Avg. fwd time: 12.4311 / Avg. bwd time: 39.3728 / Avg. batch time: 486.3207 (ms) / GPU bubble ratio: 14.78%
[rank1]:2025-12-23 19:25:20,864 - Avg. fwd time: 9.3756 / Avg. bwd time: 23.9610 / Avg. batch time: 556.1002 (ms) / GPU bubble ratio: 52.04%
[rank0]:2025-12-23 19:25:20,868 - Avg. fwd time: 7.5878 / Avg. bwd time: 22.9727 / Avg. batch time: 592.3273 (ms) / GPU bubble ratio: 58.72%
[rank3]:2025-12-23 19:25:33,444 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-23 19:25:33,795 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1925_max_batch_time.svg
[rank3]:			> Batch Time: 531.66 ms, GPU Bubble Ratio: 50.65%, 47.65%, 59.26%, 18.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-25-153ms   | [S0,MB4,F]  153-7-160ms    | [S0,MB1,B]  179-25-204ms   | [S0,MB5,F]  204-7-211ms    | [S0,MB2,B]  232-25-257ms   | [S0,MB6,F]  257-7-264ms    | [S0,MB3,B]  287-25-312ms   | [S0,MB7,F]  312-7-319ms    | [S0,MB4,B]  341-25-366ms   | [S0,MB5,B]  396-25-421ms   | [S0,MB6,B]  451-25-476ms   | [S0,MB7,B]  506-25-531ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  154-25-179ms   | [S1,MB4,F]  179-9-188ms    | [S1,MB2,B]  206-25-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  261-25-287ms   | [S1,MB6,F]  287-9-296ms    | [S1,MB4,B]  316-25-341ms   | [S1,MB7,F]  341-9-350ms    | [S1,MB5,B]  370-25-396ms   | [S1,MB6,B]  426-25-451ms   | [S1,MB7,B]  481-25-506ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  134-19-154ms   | [S2,MB3,F]  154-7-161ms    | [S2,MB2,B]  187-19-206ms   | [S2,MB4,F]  206-7-213ms    | [S2,MB3,B]  241-19-261ms   | [S2,MB5,F]  261-7-268ms    | [S2,MB4,B]  296-19-316ms   | [S2,MB6,F]  316-7-323ms    | [S2,MB5,B]  351-19-370ms   | [S2,MB7,F]  370-7-378ms    | [S2,MB6,B]  406-19-426ms   | [S2,MB7,B]  461-19-481ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-11-146ms   | [S3,MB2,B]  146-41-187ms   AFR(10):0.9655 | [S3,MB3,F]  187-12-199ms   | [S3,MB3,B]  199-42-241ms   AFR(10):0.9655 | [S3,MB4,F]  241-12-254ms   | [S3,MB4,B]  254-41-296ms   AFR(10):0.9655 | [S3,MB5,F]  296-13-309ms   | [S3,MB5,B]  309-41-351ms   AFR(10):0.9655 | [S3,MB6,F]  351-13-364ms   | [S3,MB6,B]  364-41-406ms   AFR(10):0.9655 | [S3,MB7,F]  406-13-419ms   | [S3,MB7,B]  419-42-461ms   AFR(10):0.9655
[rank3]:2025-12-23 19:25:33,922 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1925_min_batch_time.svg
[rank3]:			> Batch Time: 321.38 ms, GPU Bubble Ratio: 81.01%, 49.13%, 60.65%, 15.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  82-0-82ms      | [S0,MB4,F]  82-7-90ms      | [S0,MB1,B]  114-0-114ms    | [S0,MB5,F]  114-7-122ms    | [S0,MB2,B]  147-0-147ms    | [S0,MB6,F]  147-7-155ms    | [S0,MB3,B]  182-0-182ms    | [S0,MB7,F]  182-7-189ms    | [S0,MB4,B]  216-0-216ms    | [S0,MB5,B]  251-0-251ms    | [S0,MB6,B]  286-0-286ms    | [S0,MB7,B]  321-0-321ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  72-10-82ms     | [S1,MB3,F]  82-9-92ms      | [S1,MB1,B]  103-11-114ms   | [S1,MB4,F]  114-9-124ms    | [S1,MB2,B]  136-10-147ms   | [S1,MB5,F]  147-9-157ms    | [S1,MB3,B]  170-11-182ms   | [S1,MB6,F]  182-9-191ms    | [S1,MB4,B]  205-10-216ms   | [S1,MB7,F]  216-9-225ms    | [S1,MB5,B]  240-11-251ms   | [S1,MB6,B]  275-10-286ms   | [S1,MB7,B]  310-10-321ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  63-8-72ms      | [S2,MB2,F]  72-7-79ms      | [S2,MB1,B]  95-8-103ms     | [S2,MB3,F]  103-7-110ms    | [S2,MB2,B]  128-8-136ms    | [S2,MB4,F]  136-7-143ms    | [S2,MB3,B]  162-8-170ms    | [S2,MB5,F]  170-7-177ms    | [S2,MB4,B]  197-8-205ms    | [S2,MB6,F]  205-7-212ms    | [S2,MB5,B]  231-8-240ms    | [S2,MB7,F]  240-7-247ms    | [S2,MB6,B]  266-8-275ms    | [S2,MB7,B]  301-8-310ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-20-63ms     AFR(10):0.9655 | [S3,MB1,F]  63-11-74ms     | [S3,MB1,B]  74-20-95ms     AFR(10):0.9655 | [S3,MB2,F]  95-11-107ms    | [S3,MB2,B]  107-21-128ms   AFR(10):0.9655 | [S3,MB3,F]  128-12-141ms   | [S3,MB3,B]  141-21-162ms   AFR(10):0.9655 | [S3,MB4,F]  162-12-175ms   | [S3,MB4,B]  175-22-197ms   AFR(10):0.9655 | [S3,MB5,F]  197-13-210ms   | [S3,MB5,B]  210-21-231ms   AFR(10):0.9655 | [S3,MB6,F]  231-13-245ms   | [S3,MB6,B]  245-21-266ms   AFR(10):0.9655 | [S3,MB7,F]  266-13-279ms   | [S3,MB7,B]  279-22-301ms   AFR(10):0.9655
[rank3]:2025-12-23 19:25:34,058 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1925_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 368.03 ms, GPU Bubble Ratio: 39.42%, 28.59%, 44.20%, 13.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-25-153ms   | [S0,MB4,F]  153-7-160ms    | [S0,MB1,B]  179-25-204ms   | [S0,MB5,F]  204-7-211ms    | [S0,MB2,B]  214-25-239ms   | [S0,MB6,F]  239-7-246ms    | [S0,MB3,B]  249-25-274ms   | [S0,MB7,F]  274-7-281ms    | [S0,MB4,B]  288-25-314ms   | [S0,MB5,B]  323-25-348ms   | [S0,MB6,B]  357-10-368ms   | [S0,MB7,B]  368-0-368ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  154-25-179ms   | [S1,MB4,F]  179-9-188ms    | [S1,MB2,B]  188-25-214ms   | [S1,MB5,F]  214-9-223ms    | [S1,MB3,B]  223-25-249ms   | [S1,MB6,F]  249-9-258ms    | [S1,MB4,B]  263-25-288ms   | [S1,MB7,F]  288-9-298ms    | [S1,MB5,B]  298-25-323ms   | [S1,MB6,B]  333-24-357ms   | [S1,MB7,B]  357-10-368ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  134-19-154ms   | [S2,MB3,F]  154-7-161ms    | [S2,MB2,B]  167-19-186ms   | [S2,MB4,F]  188-7-196ms    | [S2,MB3,B]  201-19-221ms   | [S2,MB5,F]  223-7-230ms    | [S2,MB4,B]  243-19-263ms   | [S2,MB6,F]  263-7-270ms    | [S2,MB5,B]  278-19-298ms   | [S2,MB7,F]  298-7-305ms    | [S2,MB6,B]  313-19-333ms   | [S2,MB7,B]  348-8-357ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-11-146ms   | [S3,MB2,B]  146-21-167ms   AFR(10):0.9655 | [S3,MB3,F]  167-12-179ms   | [S3,MB3,B]  179-21-201ms   AFR(10):0.9655 | [S3,MB4,F]  201-12-213ms   | [S3,MB4,B]  213-29-243ms   AFR(10):0.9655 | [S3,MB5,F]  243-13-257ms   | [S3,MB5,B]  257-21-278ms   AFR(10):0.9655 | [S3,MB6,F]  278-13-291ms   | [S3,MB6,B]  291-21-313ms   AFR(10):0.9655 | [S3,MB7,F]  313-13-326ms   | [S3,MB7,B]  326-22-348ms   AFR(10):0.9655
[rank3]:2025-12-23 19:25:34,059 - 	> Batch Time: 368.03 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.31)
[rank3]:2025-12-23 19:26:58,451 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.17(0.20)/0.60, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-23 19:26:58,632 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-23 19:26:58,658 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.02(0.03)/0.08, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-23 19:26:58,679 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-23 19:26:58,680 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.16(0.19)/0.57, [MB7] 0.27(0.33)/1.00
[rank3]:2025-12-23 19:27:03,040 - Avg. fwd time: 12.3028 / Avg. bwd time: 37.3321 / Avg. batch time: 468.9543 (ms) / GPU bubble ratio: 15.33%
[rank2]:2025-12-23 19:27:03,062 - Avg. fwd time: 7.2324 / Avg. bwd time: 18.3986 / Avg. batch time: 498.9110 (ms) / GPU bubble ratio: 58.90%
[rank2]:2025-12-23 19:27:03,135 -  step: 100  loss: -8.0000  grad_norm:  5.6399  memory:  6.98GiB(14.69%)  tps: 7,539  tflops: 58.94  mfu: 18.89%
[rank3]:2025-12-23 19:27:03,148 -  step: 100  loss:  8.6532  grad_norm:  5.6399  memory: 16.39GiB(34.50%)  tps: 7,539  tflops: 58.94  mfu: 18.89%
[rank1]:2025-12-23 19:27:03,087 - Avg. fwd time: 9.4132 / Avg. bwd time: 23.5421 / Avg. batch time: 535.6636 (ms) / GPU bubble ratio: 50.78%
[rank1]:2025-12-23 19:27:03,139 -  step: 100  loss: -8.0000  grad_norm:  5.6399  memory:  9.50GiB(19.99%)  tps: 7,539  tflops: 58.94  mfu: 18.89%
[rank0]:2025-12-23 19:27:03,114 - Avg. fwd time: 7.5882 / Avg. bwd time: 21.8411 / Avg. batch time: 568.0577 (ms) / GPU bubble ratio: 58.55%
[rank0]:2025-12-23 19:27:03,150 -  step: 100  loss: -8.0000  grad_norm:  5.6399  memory: 13.42GiB(28.26%)  tps: 7,539  tflops: 58.94  mfu: 18.89%
[rank2]:2025-12-23 19:27:03,208 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_1927_stage2_step100.svg
[rank1]:2025-12-23 19:27:03,208 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_1927_stage1_step100.svg
[rank0]:2025-12-23 19:27:03,208 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_1927_stage0_step100.svg
[rank2]:2025-12-23 19:27:03,298 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1927_stage2.svg
[rank3]:2025-12-23 19:27:03,285 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1927_step100_rank3.svg
[rank3]:			> Batch Time: 574.11 ms, GPU Bubble Ratio: 56.88%, 51.81%, 62.78%, 29.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-172ms   | [S0,MB4,F]  172-7-179ms    | [S0,MB1,B]  207-25-232ms   | [S0,MB5,F]  232-7-239ms    | [S0,MB2,B]  267-25-292ms   | [S0,MB6,F]  292-7-299ms    | [S0,MB3,B]  328-25-353ms   | [S0,MB7,F]  353-7-360ms    | [S0,MB4,B]  389-25-414ms   | [S0,MB5,B]  449-25-474ms   | [S0,MB6,B]  509-18-527ms   | [S0,MB7,B]  556-17-574ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  116-25-142ms   | [S1,MB3,F]  145-9-154ms    | [S1,MB1,B]  177-25-202ms   | [S1,MB4,F]  205-9-215ms    | [S1,MB2,B]  236-25-262ms   | [S1,MB5,F]  265-9-274ms    | [S1,MB3,B]  297-25-323ms   | [S1,MB6,F]  326-9-336ms    | [S1,MB4,B]  359-25-384ms   | [S1,MB7,F]  388-9-397ms    | [S1,MB5,B]  421-25-446ms   | [S1,MB6,B]  482-24-506ms   | [S1,MB7,B]  529-23-553ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  153-19-173ms   | [S2,MB3,F]  175-7-182ms    | [S2,MB2,B]  212-19-232ms   | [S2,MB4,F]  234-7-242ms    | [S2,MB3,B]  273-19-293ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB4,B]  335-19-355ms   | [S2,MB6,F]  357-7-365ms    | [S2,MB5,B]  397-19-417ms   | [S2,MB7,F]  419-7-426ms    | [S2,MB6,B]  459-19-479ms   | [S2,MB7,B]  509-16-526ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-102ms    | [S3,MB1,B]  108-40-148ms   | [S3,MB2,F]  152-13-165ms   | [S3,MB2,B]  171-37-208ms   | [S3,MB3,F]  211-12-223ms   | [S3,MB3,B]  230-38-268ms   | [S3,MB4,F]  272-12-284ms   | [S3,MB4,B]  291-39-330ms   | [S3,MB5,F]  334-12-346ms   | [S3,MB5,B]  353-40-393ms   | [S3,MB6,F]  396-12-408ms   | [S3,MB6,B]  415-39-455ms   | [S3,MB7,F]  457-12-470ms   | [S3,MB7,B]  477-30-507ms  
[rank3]:2025-12-23 19:27:03,328 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_1927_stage3_step100.svg
[rank1]:2025-12-23 19:27:03,298 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1927_stage1.svg
[rank0]:2025-12-23 19:27:03,298 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1927_stage0.svg
[rank3]:2025-12-23 19:27:03,418 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1927_stage3.svg
[rank2]:2025-12-23 19:28:57,453 - Avg. fwd time: 7.2343 / Avg. bwd time: 18.5824 / Avg. batch time: 496.7234 (ms) / GPU bubble ratio: 58.42%
[rank3]:2025-12-23 19:28:57,432 - Avg. fwd time: 12.3046 / Avg. bwd time: 37.0930 / Avg. batch time: 467.0497 (ms) / GPU bubble ratio: 15.39%
[rank0]:2025-12-23 19:28:57,498 - Avg. fwd time: 7.5953 / Avg. bwd time: 22.2140 / Avg. batch time: 565.2236 (ms) / GPU bubble ratio: 57.81%
[rank1]:2025-12-23 19:28:57,478 - Avg. fwd time: 9.4345 / Avg. bwd time: 23.7614 / Avg. batch time: 533.0379 (ms) / GPU bubble ratio: 50.18%
[rank3]:2025-12-23 19:30:39,765 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.34(0.40)/0.60, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-23 19:30:39,945 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-23 19:30:39,967 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.04(0.05)/0.08, [MB7] 0.60(0.67)/1.00
[rank0]:2025-12-23 19:30:39,988 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-23 19:30:39,989 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.35(0.38)/0.57, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-23 19:30:44,109 - Avg. fwd time: 7.2354 / Avg. bwd time: 18.6497 / Avg. batch time: 489.6677 (ms) / GPU bubble ratio: 57.71%
[rank3]:2025-12-23 19:30:44,090 - Avg. fwd time: 12.2861 / Avg. bwd time: 36.3325 / Avg. batch time: 460.8133 (ms) / GPU bubble ratio: 15.60%
[rank0]:2025-12-23 19:30:44,150 - Avg. fwd time: 7.5981 / Avg. bwd time: 22.3417 / Avg. batch time: 556.9688 (ms) / GPU bubble ratio: 57.00%
[rank0]:2025-12-23 19:30:44,186 -  step: 150  loss: -8.0000  grad_norm: 118.6467  memory: 13.42GiB(28.26%)  tps: 7,412  tflops: 57.95  mfu: 18.57%
[rank1]:2025-12-23 19:30:44,132 - Avg. fwd time: 9.4503 / Avg. bwd time: 23.8955 / Avg. batch time: 525.4127 (ms) / GPU bubble ratio: 49.23%
[rank1]:2025-12-23 19:30:44,175 -  step: 150  loss: -8.0000  grad_norm: 118.6467  memory:  9.50GiB(19.99%)  tps: 7,412  tflops: 57.95  mfu: 18.57%
[rank2]:2025-12-23 19:30:44,171 -  step: 150  loss: -8.0000  grad_norm: 118.6467  memory:  6.98GiB(14.69%)  tps: 7,412  tflops: 57.95  mfu: 18.57%
[rank3]:2025-12-23 19:30:44,184 -  step: 150  loss:  5.0990  grad_norm: 118.6467  memory: 16.39GiB(34.50%)  tps: 7,412  tflops: 57.95  mfu: 18.57%
[rank2]:2025-12-23 19:32:26,088 - Avg. fwd time: 7.2380 / Avg. bwd time: 18.7099 / Avg. batch time: 482.1226 (ms) / GPU bubble ratio: 56.94%
[rank3]:2025-12-23 19:32:26,071 - Avg. fwd time: 12.2407 / Avg. bwd time: 35.5058 / Avg. batch time: 453.8316 (ms) / GPU bubble ratio: 15.83%
[rank1]:2025-12-23 19:32:26,109 - Avg. fwd time: 9.4713 / Avg. bwd time: 23.9733 / Avg. batch time: 517.1875 (ms) / GPU bubble ratio: 48.27%
[rank0]:2025-12-23 19:32:26,126 - Avg. fwd time: 7.6019 / Avg. bwd time: 22.3801 / Avg. batch time: 547.7417 (ms) / GPU bubble ratio: 56.21%
[rank3]:2025-12-23 19:33:56,835 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.55(0.60)/0.60, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-23 19:33:57,006 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-23 19:33:57,022 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.07(0.08)/0.08, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-23 19:33:57,030 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-23 19:33:57,031 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.57)/0.57, [MB7] 0.95(1.00)/1.00
[rank2]:2025-12-23 19:34:00,706 - Avg. fwd time: 7.2422 / Avg. bwd time: 18.7234 / Avg. batch time: 472.6359 (ms) / GPU bubble ratio: 56.05%
[rank3]:2025-12-23 19:34:00,690 - Avg. fwd time: 12.1507 / Avg. bwd time: 34.5118 / Avg. batch time: 445.1552 (ms) / GPU bubble ratio: 16.14%
[rank1]:2025-12-23 19:34:00,724 - Avg. fwd time: 9.4979 / Avg. bwd time: 24.0330 / Avg. batch time: 506.8700 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-12-23 19:34:00,730 - Avg. fwd time: 7.6082 / Avg. bwd time: 22.3282 / Avg. batch time: 536.2150 (ms) / GPU bubble ratio: 55.34%
[rank2]:2025-12-23 19:34:00,752 -  step: 200  loss: -8.0000  grad_norm:  2.3593  memory:  6.98GiB(14.69%)  tps: 8,335  tflops: 65.16  mfu: 20.88%
[rank2]:2025-12-23 19:34:00,815 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_1934_stage2_step200.svg
[rank3]:2025-12-23 19:34:00,764 -  step: 200  loss:  1.1950  grad_norm:  2.3593  memory: 16.39GiB(34.50%)  tps: 8,335  tflops: 65.16  mfu: 20.88%
[rank1]:2025-12-23 19:34:00,756 -  step: 200  loss: -8.0000  grad_norm:  2.3593  memory:  9.50GiB(19.99%)  tps: 8,335  tflops: 65.16  mfu: 20.88%
[rank1]:2025-12-23 19:34:00,815 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_1934_stage1_step200.svg
[rank0]:2025-12-23 19:34:00,766 -  step: 200  loss: -8.0000  grad_norm:  2.3593  memory: 13.42GiB(28.26%)  tps: 8,335  tflops: 65.16  mfu: 20.88%
[rank0]:2025-12-23 19:34:00,815 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_1934_stage0_step200.svg
[rank3]:2025-12-23 19:34:00,901 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1934_step200_rank3.svg
[rank3]:			> Batch Time: 446.14 ms, GPU Bubble Ratio: 47.91%, 38.71%, 53.22%, 31.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  251-25-277ms   | [S0,MB6,F]  277-7-284ms    | [S0,MB3,B]  294-25-319ms   | [S0,MB7,F]  319-7-326ms    | [S0,MB4,B]  341-25-367ms   | [S0,MB5,B]  384-25-409ms   | [S0,MB6,B]  423-13-436ms   | [S0,MB7,B]  441-5-446ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-143ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  177-25-203ms   | [S1,MB4,F]  206-9-215ms    | [S1,MB2,B]  221-25-246ms   | [S1,MB5,F]  250-9-259ms    | [S1,MB3,B]  262-26-289ms   | [S1,MB6,F]  292-9-302ms    | [S1,MB4,B]  310-26-336ms   | [S1,MB7,F]  340-10-350ms   | [S1,MB5,B]  353-27-381ms   | [S1,MB6,B]  394-25-420ms   | [S1,MB7,B]  423-13-436ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  153-19-173ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  196-20-217ms   | [S2,MB4,F]  219-7-226ms    | [S2,MB3,B]  238-20-259ms   | [S2,MB5,F]  261-7-268ms    | [S2,MB4,B]  286-20-306ms   | [S2,MB6,F]  308-7-315ms    | [S2,MB5,B]  328-20-349ms   | [S2,MB7,F]  351-7-359ms    | [S2,MB6,B]  370-20-390ms   | [S2,MB7,B]  411-8-420ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  92-10-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-11-164ms   | [S3,MB2,B]  169-22-191ms   | [S3,MB3,F]  195-11-206ms   | [S3,MB3,B]  212-21-233ms   | [S3,MB4,F]  237-10-248ms   | [S3,MB4,B]  253-27-281ms   | [S3,MB5,F]  284-10-295ms   | [S3,MB5,B]  301-22-323ms   | [S3,MB6,F]  327-10-338ms   | [S3,MB6,B]  343-21-365ms   | [S3,MB7,F]  368-10-379ms   | [S3,MB7,B]  385-22-407ms  
[rank3]:2025-12-23 19:34:00,945 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_1934_stage3_step200.svg
[rank2]:2025-12-23 19:34:01,157 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1934_stage2.svg
[rank1]:2025-12-23 19:34:01,154 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1934_stage1.svg
[rank0]:2025-12-23 19:34:01,155 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1934_stage0.svg
[rank3]:2025-12-23 19:34:01,283 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1934_stage3.svg
[rank3]:2025-12-23 19:35:34,063 - Avg. fwd time: 12.0883 / Avg. bwd time: 33.7187 / Avg. batch time: 438.3097 (ms) / GPU bubble ratio: 16.39%
[rank2]:2025-12-23 19:35:34,079 - Avg. fwd time: 7.2444 / Avg. bwd time: 18.7245 / Avg. batch time: 465.1337 (ms) / GPU bubble ratio: 55.34%
[rank1]:2025-12-23 19:35:34,097 - Avg. fwd time: 9.5237 / Avg. bwd time: 24.0629 / Avg. batch time: 498.6270 (ms) / GPU bubble ratio: 46.11%
[rank0]:2025-12-23 19:35:34,104 - Avg. fwd time: 7.6112 / Avg. bwd time: 22.1625 / Avg. batch time: 526.3399 (ms) / GPU bubble ratio: 54.75%
[rank3]:2025-12-23 19:37:03,463 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.59(0.60)/0.60, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-23 19:37:03,636 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-23 19:37:03,651 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.09(0.08)/0.08, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-23 19:37:03,655 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-23 19:37:03,656 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.57(0.57)/0.57, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-23 19:37:07,317 - Avg. fwd time: 12.0412 / Avg. bwd time: 33.1328 / Avg. batch time: 433.2422 (ms) / GPU bubble ratio: 16.58%
[rank2]:2025-12-23 19:37:07,333 - Avg. fwd time: 7.2433 / Avg. bwd time: 18.7239 / Avg. batch time: 459.4859 (ms) / GPU bubble ratio: 54.79%
[rank1]:2025-12-23 19:37:07,352 - Avg. fwd time: 9.5343 / Avg. bwd time: 24.0686 / Avg. batch time: 492.3317 (ms) / GPU bubble ratio: 45.40%
[rank0]:2025-12-23 19:37:07,359 - Avg. fwd time: 7.6120 / Avg. bwd time: 22.0040 / Avg. batch time: 518.5874 (ms) / GPU bubble ratio: 54.31%
[rank3]:2025-12-23 19:37:07,393 -  step: 250  loss:  0.3969  grad_norm:  0.7721  memory: 16.39GiB(34.50%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank2]:2025-12-23 19:37:07,380 -  step: 250  loss: -8.0000  grad_norm:  0.7721  memory:  6.98GiB(14.69%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank1]:2025-12-23 19:37:07,384 -  step: 250  loss: -8.0000  grad_norm:  0.7721  memory:  9.50GiB(19.99%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank0]:2025-12-23 19:37:07,395 -  step: 250  loss: -8.0000  grad_norm:  0.7721  memory: 13.42GiB(28.26%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank3]:2025-12-23 19:38:39,890 - Avg. fwd time: 12.0004 / Avg. bwd time: 32.5835 / Avg. batch time: 428.5188 (ms) / GPU bubble ratio: 16.77%
[rank2]:2025-12-23 19:38:39,906 - Avg. fwd time: 7.2449 / Avg. bwd time: 18.7291 / Avg. batch time: 454.3018 (ms) / GPU bubble ratio: 54.26%
[rank1]:2025-12-23 19:38:39,925 - Avg. fwd time: 9.5535 / Avg. bwd time: 24.0923 / Avg. batch time: 486.6759 (ms) / GPU bubble ratio: 44.69%
[rank0]:2025-12-23 19:38:39,932 - Avg. fwd time: 7.6125 / Avg. bwd time: 21.9033 / Avg. batch time: 511.9171 (ms) / GPU bubble ratio: 53.87%
[rank3]:2025-12-23 19:40:09,059 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.59(0.60)/0.60, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-23 19:40:09,233 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-23 19:40:09,248 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.09(0.08)/0.08, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-23 19:40:09,251 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-23 19:40:09,252 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.57(0.57)/0.57, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-23 19:40:12,849 - Avg. fwd time: 11.9654 / Avg. bwd time: 32.1587 / Avg. batch time: 424.8389 (ms) / GPU bubble ratio: 16.91%
[rank2]:2025-12-23 19:40:12,866 - Avg. fwd time: 7.2446 / Avg. bwd time: 18.7308 / Avg. batch time: 450.2312 (ms) / GPU bubble ratio: 53.85%
[rank1]:2025-12-23 19:40:12,886 - Avg. fwd time: 9.5622 / Avg. bwd time: 24.0985 / Avg. batch time: 482.1568 (ms) / GPU bubble ratio: 44.15%
[rank0]:2025-12-23 19:40:12,894 - Avg. fwd time: 7.6125 / Avg. bwd time: 21.8141 / Avg. batch time: 506.5256 (ms) / GPU bubble ratio: 53.52%
[rank0]:2025-12-23 19:40:12,930 -  step: 300  loss: -8.0000  grad_norm:  0.1757  memory: 13.42GiB(28.26%)  tps: 8,831  tflops: 69.03  mfu: 22.13%
[rank3]:2025-12-23 19:40:12,928 -  step: 300  loss:  0.2760  grad_norm:  0.1757  memory: 16.39GiB(34.50%)  tps: 8,831  tflops: 69.03  mfu: 22.13%
[rank2]:2025-12-23 19:40:12,915 -  step: 300  loss: -8.0000  grad_norm:  0.1757  memory:  6.98GiB(14.69%)  tps: 8,831  tflops: 69.03  mfu: 22.13%
[rank2]:2025-12-23 19:40:12,977 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_1940_stage2_step300.svg
[rank1]:2025-12-23 19:40:12,919 -  step: 300  loss: -8.0000  grad_norm:  0.1757  memory:  9.50GiB(19.99%)  tps: 8,831  tflops: 69.03  mfu: 22.13%
[rank1]:2025-12-23 19:40:12,978 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_1940_stage1_step300.svg
[rank0]:2025-12-23 19:40:12,977 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_1940_stage0_step300.svg
[rank3]:2025-12-23 19:40:13,069 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1940_step300_rank3.svg
[rank3]:			> Batch Time: 448.25 ms, GPU Bubble Ratio: 49.39%, 39.85%, 53.61%, 29.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-234ms   | [S0,MB5,F]  234-7-241ms    | [S0,MB2,B]  252-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  295-25-320ms   | [S0,MB7,F]  320-7-327ms    | [S0,MB4,B]  350-25-376ms   | [S0,MB5,B]  392-25-417ms   | [S0,MB6,B]  432-14-446ms   | [S0,MB7,B]  448-0-448ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  117-25-143ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  207-9-216ms    | [S1,MB2,B]  221-25-247ms   | [S1,MB5,F]  251-9-260ms    | [S1,MB3,B]  263-26-290ms   | [S1,MB6,F]  294-10-304ms   | [S1,MB4,B]  319-26-345ms   | [S1,MB7,F]  349-9-358ms    | [S1,MB5,B]  362-26-388ms   | [S1,MB6,B]  403-25-428ms   | [S1,MB7,B]  432-12-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-20-174ms   | [S2,MB3,F]  176-6-183ms    | [S2,MB2,B]  197-20-217ms   | [S2,MB4,F]  220-7-227ms    | [S2,MB3,B]  239-20-259ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  295-20-315ms   | [S2,MB6,F]  318-7-325ms    | [S2,MB5,B]  338-20-358ms   | [S2,MB7,F]  361-7-368ms    | [S2,MB6,B]  380-20-400ms   | [S2,MB7,B]  420-8-429ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  92-11-103ms    | [S3,MB1,B]  109-40-149ms   | [S3,MB2,F]  152-12-165ms   | [S3,MB2,B]  171-21-192ms   | [S3,MB3,F]  196-11-207ms   | [S3,MB3,B]  213-21-234ms   | [S3,MB4,F]  238-11-249ms   | [S3,MB4,B]  254-36-290ms   | [S3,MB5,F]  294-11-305ms   | [S3,MB5,B]  312-21-333ms   | [S3,MB6,F]  337-11-348ms   | [S3,MB6,B]  354-21-375ms   | [S3,MB7,F]  378-10-389ms   | [S3,MB7,B]  395-21-417ms  
[rank3]:2025-12-23 19:40:13,112 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_1940_stage3_step300.svg
[rank2]:2025-12-23 19:40:13,567 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1940_stage2.svg
[rank1]:2025-12-23 19:40:13,567 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1940_stage1.svg
[rank0]:2025-12-23 19:40:13,569 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1940_stage0.svg
[rank3]:2025-12-23 19:40:13,711 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1940_stage3.svg
[rank3]:2025-12-23 19:41:44,758 - Avg. fwd time: 11.9319 / Avg. bwd time: 31.7257 / Avg. batch time: 421.1077 (ms) / GPU bubble ratio: 17.06%
[rank2]:2025-12-23 19:41:44,776 - Avg. fwd time: 7.2470 / Avg. bwd time: 18.7361 / Avg. batch time: 446.2245 (ms) / GPU bubble ratio: 53.42%
[rank1]:2025-12-23 19:41:44,796 - Avg. fwd time: 9.5823 / Avg. bwd time: 24.1305 / Avg. batch time: 477.8358 (ms) / GPU bubble ratio: 43.56%
[rank0]:2025-12-23 19:41:44,804 - Avg. fwd time: 7.6111 / Avg. bwd time: 21.7073 / Avg. batch time: 501.3237 (ms) / GPU bubble ratio: 53.21%
[rank0]:2025-12-23 19:43:12,927 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-23 19:43:16,522 - Avg. fwd time: 11.9052 / Avg. bwd time: 31.3819 / Avg. batch time: 418.1432 (ms) / GPU bubble ratio: 17.18%
[rank2]:2025-12-23 19:43:16,539 - Avg. fwd time: 7.2484 / Avg. bwd time: 18.7373 / Avg. batch time: 442.9766 (ms) / GPU bubble ratio: 53.07%
[rank1]:2025-12-23 19:43:16,559 - Avg. fwd time: 9.5975 / Avg. bwd time: 24.1420 / Avg. batch time: 474.2749 (ms) / GPU bubble ratio: 43.09%
[rank0]:2025-12-23 19:43:16,567 - Avg. fwd time: 7.6120 / Avg. bwd time: 21.6334 / Avg. batch time: 497.0225 (ms) / GPU bubble ratio: 52.93%
[rank0]:2025-12-23 19:43:16,602 -  step: 350  loss: -8.0000  grad_norm:  0.1024  memory: 13.42GiB(28.26%)  tps: 8,920  tflops: 69.73  mfu: 22.35%
[rank3]:2025-12-23 19:43:16,601 -  step: 350  loss:  0.2228  grad_norm:  0.1024  memory: 16.39GiB(34.50%)  tps: 8,920  tflops: 69.73  mfu: 22.35%
[rank2]:2025-12-23 19:43:16,588 -  step: 350  loss: -8.0000  grad_norm:  0.1024  memory:  6.98GiB(14.69%)  tps: 8,920  tflops: 69.73  mfu: 22.35%
[rank1]:2025-12-23 19:43:16,592 -  step: 350  loss: -8.0000  grad_norm:  0.1024  memory:  9.50GiB(19.99%)  tps: 8,920  tflops: 69.73  mfu: 22.35%
[rank3]:2025-12-23 19:44:49,081 - Avg. fwd time: 11.8790 / Avg. bwd time: 31.1060 / Avg. batch time: 415.7256 (ms) / GPU bubble ratio: 17.28%
[rank2]:2025-12-23 19:44:49,099 - Avg. fwd time: 7.2489 / Avg. bwd time: 18.7376 / Avg. batch time: 440.3122 (ms) / GPU bubble ratio: 52.79%
[rank1]:2025-12-23 19:44:49,119 - Avg. fwd time: 9.6052 / Avg. bwd time: 24.1536 / Avg. batch time: 471.3590 (ms) / GPU bubble ratio: 42.70%
[rank0]:2025-12-23 19:44:49,131 - Avg. fwd time: 7.6118 / Avg. bwd time: 21.5809 / Avg. batch time: 493.5614 (ms) / GPU bubble ratio: 52.68%
[rank0]:2025-12-23 19:46:17,090 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 19:46:20,757 - Avg. fwd time: 11.8589 / Avg. bwd time: 30.8301 / Avg. batch time: 413.3572 (ms) / GPU bubble ratio: 17.38%
[rank2]:2025-12-23 19:46:20,774 - Avg. fwd time: 7.2505 / Avg. bwd time: 18.7385 / Avg. batch time: 437.7303 (ms) / GPU bubble ratio: 52.50%
[rank1]:2025-12-23 19:46:20,796 - Avg. fwd time: 9.6196 / Avg. bwd time: 24.1825 / Avg. batch time: 468.6325 (ms) / GPU bubble ratio: 42.30%
[rank0]:2025-12-23 19:46:20,804 - Avg. fwd time: 7.6119 / Avg. bwd time: 21.5191 / Avg. batch time: 490.2670 (ms) / GPU bubble ratio: 52.47%
[rank0]:2025-12-23 19:46:20,840 -  step: 400  loss: -8.0000  grad_norm:  0.1165  memory: 13.42GiB(28.26%)  tps: 8,893  tflops: 69.52  mfu: 22.28%
[rank3]:2025-12-23 19:46:20,838 -  step: 400  loss:  0.2100  grad_norm:  0.1165  memory: 16.39GiB(34.50%)  tps: 8,893  tflops: 69.52  mfu: 22.28%
[rank2]:2025-12-23 19:46:20,826 -  step: 400  loss: -8.0000  grad_norm:  0.1165  memory:  6.98GiB(14.69%)  tps: 8,893  tflops: 69.52  mfu: 22.28%
[rank1]:2025-12-23 19:46:20,829 -  step: 400  loss: -8.0000  grad_norm:  0.1165  memory:  9.50GiB(19.99%)  tps: 8,893  tflops: 69.52  mfu: 22.28%
[rank1]:2025-12-23 19:46:20,891 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_1946_stage1_step400.svg
[rank0]:2025-12-23 19:46:20,892 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_1946_stage0_step400.svg
[rank3]:2025-12-23 19:46:20,976 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1946_step400_rank3.svg
[rank3]:			> Batch Time: 441.75 ms, GPU Bubble Ratio: 48.88%, 37.28%, 52.81%, 30.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-241ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  296-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  342-25-367ms   | [S0,MB5,B]  384-25-409ms   | [S0,MB6,B]  424-12-437ms   | [S0,MB7,B]  441-0-441ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  207-9-216ms    | [S1,MB2,B]  222-26-248ms   | [S1,MB5,F]  251-9-261ms    | [S1,MB3,B]  264-26-290ms   | [S1,MB6,F]  294-10-304ms   | [S1,MB4,B]  310-26-336ms   | [S1,MB7,F]  340-10-351ms   | [S1,MB5,B]  353-27-380ms   | [S1,MB6,B]  394-27-421ms   | [S1,MB7,B]  424-12-437ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  220-7-227ms    | [S2,MB3,B]  239-20-259ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  285-20-305ms   | [S2,MB6,F]  308-7-315ms    | [S2,MB5,B]  328-20-349ms   | [S2,MB7,F]  351-7-359ms    | [S2,MB6,B]  370-20-390ms   | [S2,MB7,B]  410-9-420ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-103ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-13-165ms   | [S3,MB2,B]  171-21-192ms   | [S3,MB3,F]  196-10-207ms   | [S3,MB3,B]  213-21-234ms   | [S3,MB4,F]  237-10-248ms   | [S3,MB4,B]  254-26-280ms   | [S3,MB5,F]  284-11-295ms   | [S3,MB5,B]  302-21-323ms   | [S3,MB6,F]  327-10-338ms   | [S3,MB6,B]  344-21-365ms   | [S3,MB7,F]  369-10-380ms   | [S3,MB7,B]  385-21-407ms  
[rank2]:2025-12-23 19:46:20,892 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_1946_stage2_step400.svg
[rank3]:2025-12-23 19:46:21,023 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_1946_stage3_step400.svg
[rank0]:2025-12-23 19:46:21,736 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1946_stage0.svg
[rank2]:2025-12-23 19:46:21,745 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1946_stage2.svg
[rank1]:2025-12-23 19:46:21,733 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1946_stage1.svg
[rank3]:2025-12-23 19:46:21,866 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1946_stage3.svg
[rank3]:2025-12-23 19:46:42,793 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-23 19:46:42,969 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-23 19:46:42,988 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-23 19:46:42,991 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-23 19:47:53,053 - Avg. fwd time: 7.6117 / Avg. bwd time: 21.4772 / Avg. batch time: 487.2775 (ms) / GPU bubble ratio: 52.24%
[rank2]:2025-12-23 19:47:53,024 - Avg. fwd time: 7.2518 / Avg. bwd time: 18.7388 / Avg. batch time: 435.3522 (ms) / GPU bubble ratio: 52.24%
[rank3]:2025-12-23 19:47:53,003 - Avg. fwd time: 11.8391 / Avg. bwd time: 30.5725 / Avg. batch time: 411.1388 (ms) / GPU bubble ratio: 17.47%
[rank1]:2025-12-23 19:47:53,044 - Avg. fwd time: 9.6303 / Avg. bwd time: 24.1978 / Avg. batch time: 466.0693 (ms) / GPU bubble ratio: 41.93%
[rank0]:2025-12-23 19:49:20,512 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-23 19:49:24,093 - Avg. fwd time: 11.8244 / Avg. bwd time: 30.3427 / Avg. batch time: 409.1825 (ms) / GPU bubble ratio: 17.56%
[rank2]:2025-12-23 19:49:24,113 - Avg. fwd time: 7.2527 / Avg. bwd time: 18.7387 / Avg. batch time: 433.2257 (ms) / GPU bubble ratio: 52.00%
[rank1]:2025-12-23 19:49:24,134 - Avg. fwd time: 9.6406 / Avg. bwd time: 24.2166 / Avg. batch time: 463.8100 (ms) / GPU bubble ratio: 41.60%
[rank0]:2025-12-23 19:49:24,143 - Avg. fwd time: 7.6107 / Avg. bwd time: 21.4176 / Avg. batch time: 484.5584 (ms) / GPU bubble ratio: 52.07%
[rank0]:2025-12-23 19:49:24,179 -  step: 450  loss: -8.0000  grad_norm:  0.1127  memory: 13.42GiB(28.26%)  tps: 8,936  tflops: 69.86  mfu: 22.39%
[rank3]:2025-12-23 19:49:24,177 -  step: 450  loss:  0.2237  grad_norm:  0.1127  memory: 16.39GiB(34.50%)  tps: 8,937  tflops: 69.86  mfu: 22.39%
[rank2]:2025-12-23 19:49:24,165 -  step: 450  loss: -8.0000  grad_norm:  0.1127  memory:  6.98GiB(14.69%)  tps: 8,936  tflops: 69.86  mfu: 22.39%
[rank1]:2025-12-23 19:49:24,168 -  step: 450  loss: -8.0000  grad_norm:  0.1127  memory:  9.50GiB(19.99%)  tps: 8,936  tflops: 69.86  mfu: 22.39%
[rank0]:2025-12-23 19:50:55,823 - Avg. fwd time: 7.6103 / Avg. bwd time: 21.3721 / Avg. batch time: 482.2612 (ms) / GPU bubble ratio: 51.92%
[rank3]:2025-12-23 19:50:55,773 - Avg. fwd time: 11.8122 / Avg. bwd time: 30.1492 / Avg. batch time: 407.5362 (ms) / GPU bubble ratio: 17.63%
[rank2]:2025-12-23 19:50:55,792 - Avg. fwd time: 7.2531 / Avg. bwd time: 18.7386 / Avg. batch time: 431.4275 (ms) / GPU bubble ratio: 51.80%
[rank1]:2025-12-23 19:50:55,813 - Avg. fwd time: 9.6485 / Avg. bwd time: 24.2364 / Avg. batch time: 461.9231 (ms) / GPU bubble ratio: 41.32%
[rank0]:2025-12-23 19:52:23,611 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 19:52:27,239 - Avg. fwd time: 11.8006 / Avg. bwd time: 29.9736 / Avg. batch time: 406.0390 (ms) / GPU bubble ratio: 17.69%
[rank1]:2025-12-23 19:52:27,281 - Avg. fwd time: 9.6556 / Avg. bwd time: 24.2453 / Avg. batch time: 460.1418 (ms) / GPU bubble ratio: 41.06%
[rank3]:2025-12-23 19:52:27,325 -  step: 500  loss:  0.2155  grad_norm:  0.1189  memory: 16.39GiB(34.50%)  tps: 8,946  tflops: 69.94  mfu: 22.42%
[rank2]:2025-12-23 19:52:27,259 - Avg. fwd time: 7.2537 / Avg. bwd time: 18.7378 / Avg. batch time: 429.7913 (ms) / GPU bubble ratio: 51.62%
[rank2]:2025-12-23 19:52:27,312 -  step: 500  loss: -8.0000  grad_norm:  0.1189  memory:  6.98GiB(14.69%)  tps: 8,946  tflops: 69.93  mfu: 22.41%
[rank0]:2025-12-23 19:52:27,290 - Avg. fwd time: 7.6101 / Avg. bwd time: 21.3345 / Avg. batch time: 480.1354 (ms) / GPU bubble ratio: 51.77%
[rank0]:2025-12-23 19:52:27,326 -  step: 500  loss: -8.0000  grad_norm:  0.1189  memory: 13.42GiB(28.26%)  tps: 8,946  tflops: 69.93  mfu: 22.41%
[rank1]:2025-12-23 19:52:27,316 -  step: 500  loss: -8.0000  grad_norm:  0.1189  memory:  9.50GiB(19.99%)  tps: 8,946  tflops: 69.93  mfu: 22.41%
[rank1]:2025-12-23 19:52:27,374 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_1952_stage1_step500.svg
[rank2]:2025-12-23 19:52:27,374 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_1952_stage2_step500.svg
[rank0]:2025-12-23 19:52:27,375 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_1952_stage0_step500.svg
[rank3]:2025-12-23 19:52:27,461 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1952_step500_rank3.svg
[rank3]:			> Batch Time: 438.25 ms, GPU Bubble Ratio: 47.95%, 37.22%, 52.45%, 30.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-234ms   | [S0,MB5,F]  234-7-241ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  296-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  341-25-366ms   | [S0,MB5,B]  383-25-408ms   | [S0,MB6,B]  421-15-436ms   | [S0,MB7,B]  438-0-438ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  207-9-216ms    | [S1,MB2,B]  222-26-248ms   | [S1,MB5,F]  251-9-261ms    | [S1,MB3,B]  264-26-291ms   | [S1,MB6,F]  294-10-304ms   | [S1,MB4,B]  308-27-335ms   | [S1,MB7,F]  340-10-350ms   | [S1,MB5,B]  352-27-380ms   | [S1,MB6,B]  391-25-417ms   | [S1,MB7,B]  421-12-433ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  220-7-227ms    | [S2,MB3,B]  239-20-260ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  284-20-304ms   | [S2,MB6,F]  307-7-314ms    | [S2,MB5,B]  326-20-346ms   | [S2,MB7,F]  350-7-358ms    | [S2,MB6,B]  368-20-388ms   | [S2,MB7,B]  408-9-417ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-103ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-13-166ms   | [S3,MB2,B]  172-21-193ms   | [S3,MB3,F]  196-10-207ms   | [S3,MB3,B]  213-21-234ms   | [S3,MB4,F]  238-10-249ms   | [S3,MB4,B]  254-24-279ms   | [S3,MB5,F]  282-11-293ms   | [S3,MB5,B]  299-21-320ms   | [S3,MB6,F]  324-10-335ms   | [S3,MB6,B]  341-21-363ms   | [S3,MB7,F]  366-10-377ms   | [S3,MB7,B]  383-21-405ms  
[rank3]:2025-12-23 19:52:27,503 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_1952_stage3_step500.svg
[rank1]:2025-12-23 19:52:28,466 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1952_stage1.svg
[rank2]:2025-12-23 19:52:28,504 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1952_stage2.svg
[rank0]:2025-12-23 19:52:28,480 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1952_stage0.svg
[rank3]:2025-12-23 19:52:28,605 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1952_stage3.svg
[rank2]:2025-12-23 19:54:00,141 - Avg. fwd time: 7.2547 / Avg. bwd time: 18.7377 / Avg. batch time: 428.1978 (ms) / GPU bubble ratio: 51.44%
[rank3]:2025-12-23 19:54:00,121 - Avg. fwd time: 11.7900 / Avg. bwd time: 29.7977 / Avg. batch time: 404.5465 (ms) / GPU bubble ratio: 17.76%
[rank0]:2025-12-23 19:54:00,173 - Avg. fwd time: 7.6101 / Avg. bwd time: 21.3245 / Avg. batch time: 478.2747 (ms) / GPU bubble ratio: 51.60%
[rank1]:2025-12-23 19:54:00,163 - Avg. fwd time: 9.6623 / Avg. bwd time: 24.2613 / Avg. batch time: 458.4599 (ms) / GPU bubble ratio: 40.80%
[rank0]:2025-12-23 19:55:27,858 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-23 19:55:31,562 - Avg. fwd time: 7.2557 / Avg. bwd time: 18.7368 / Avg. batch time: 426.7525 (ms) / GPU bubble ratio: 51.27%
[rank0]:2025-12-23 19:55:31,595 - Avg. fwd time: 7.6102 / Avg. bwd time: 21.3066 / Avg. batch time: 476.5151 (ms) / GPU bubble ratio: 51.45%
[rank3]:2025-12-23 19:55:31,543 - Avg. fwd time: 11.7778 / Avg. bwd time: 29.6439 / Avg. batch time: 403.2180 (ms) / GPU bubble ratio: 17.82%
[rank1]:2025-12-23 19:55:31,585 - Avg. fwd time: 9.6688 / Avg. bwd time: 24.2716 / Avg. batch time: 456.9155 (ms) / GPU bubble ratio: 40.57%
[rank1]:2025-12-23 19:55:31,620 -  step: 550  loss: -8.0000  grad_norm:  0.0995  memory:  9.50GiB(19.99%)  tps: 8,890  tflops: 69.50  mfu: 22.27%
[rank2]:2025-12-23 19:55:31,616 -  step: 550  loss: -8.0000  grad_norm:  0.0995  memory:  6.98GiB(14.69%)  tps: 8,890  tflops: 69.50  mfu: 22.27%
[rank0]:2025-12-23 19:55:31,630 -  step: 550  loss: -8.0000  grad_norm:  0.0995  memory: 13.42GiB(28.26%)  tps: 8,890  tflops: 69.50  mfu: 22.27%
[rank3]:2025-12-23 19:55:31,629 -  step: 550  loss:  0.2233  grad_norm:  0.0995  memory: 16.39GiB(34.50%)  tps: 8,890  tflops: 69.50  mfu: 22.27%
[rank3]:2025-12-23 19:57:03,293 - Avg. fwd time: 11.7686 / Avg. bwd time: 29.5222 / Avg. batch time: 402.1709 (ms) / GPU bubble ratio: 17.86%
[rank1]:2025-12-23 19:57:03,336 - Avg. fwd time: 9.6728 / Avg. bwd time: 24.2783 / Avg. batch time: 455.6684 (ms) / GPU bubble ratio: 40.39%
[rank2]:2025-12-23 19:57:03,314 - Avg. fwd time: 7.2560 / Avg. bwd time: 18.7353 / Avg. batch time: 425.6005 (ms) / GPU bubble ratio: 51.14%
[rank0]:2025-12-23 19:57:03,346 - Avg. fwd time: 7.6100 / Avg. bwd time: 21.2738 / Avg. batch time: 474.9798 (ms) / GPU bubble ratio: 51.35%
[rank0]:2025-12-23 19:58:31,391 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-23 19:58:35,074 - Avg. fwd time: 7.2562 / Avg. bwd time: 18.7337 / Avg. batch time: 424.5794 (ms) / GPU bubble ratio: 51.03%
[rank1]:2025-12-23 19:58:35,097 - Avg. fwd time: 9.6763 / Avg. bwd time: 24.2756 / Avg. batch time: 454.5252 (ms) / GPU bubble ratio: 40.24%
[rank3]:2025-12-23 19:58:35,054 - Avg. fwd time: 11.7612 / Avg. bwd time: 29.4144 / Avg. batch time: 401.2479 (ms) / GPU bubble ratio: 17.90%
[rank3]:2025-12-23 19:58:35,142 -  step: 600  loss:  0.2175  grad_norm:  0.1203  memory: 16.39GiB(34.50%)  tps: 8,928  tflops: 69.80  mfu: 22.37%
[rank0]:2025-12-23 19:58:35,107 - Avg. fwd time: 7.6099 / Avg. bwd time: 21.2432 / Avg. batch time: 473.5728 (ms) / GPU bubble ratio: 51.26%
[rank0]:2025-12-23 19:58:35,143 -  step: 600  loss: -8.0000  grad_norm:  0.1203  memory: 13.42GiB(28.26%)  tps: 8,928  tflops: 69.79  mfu: 22.37%
[rank2]:2025-12-23 19:58:35,129 -  step: 600  loss: -8.0000  grad_norm:  0.1203  memory:  6.98GiB(14.69%)  tps: 8,928  tflops: 69.80  mfu: 22.37%
[rank1]:2025-12-23 19:58:35,133 -  step: 600  loss: -8.0000  grad_norm:  0.1203  memory:  9.50GiB(19.99%)  tps: 8,928  tflops: 69.80  mfu: 22.37%
[rank2]:2025-12-23 19:58:35,192 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_1958_stage2_step600.svg
[rank1]:2025-12-23 19:58:35,192 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_1958_stage1_step600.svg
[rank0]:2025-12-23 19:58:35,192 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_1958_stage0_step600.svg
[rank3]:2025-12-23 19:58:35,277 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_1958_step600_rank3.svg
[rank3]:			> Batch Time: 445.75 ms, GPU Bubble Ratio: 49.18%, 39.75%, 53.53%, 29.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-172ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-241ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  295-25-320ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  349-25-374ms   | [S0,MB5,B]  391-25-416ms   | [S0,MB6,B]  429-13-443ms   | [S0,MB7,B]  445-0-445ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  116-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  178-25-203ms   | [S1,MB4,F]  207-9-216ms    | [S1,MB2,B]  221-26-247ms   | [S1,MB5,F]  251-9-260ms    | [S1,MB3,B]  264-26-290ms   | [S1,MB6,F]  294-9-303ms    | [S1,MB4,B]  318-26-344ms   | [S1,MB7,F]  348-9-357ms    | [S1,MB5,B]  361-26-387ms   | [S1,MB6,B]  402-24-426ms   | [S1,MB7,B]  430-11-442ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-6-183ms    | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  220-6-227ms    | [S2,MB3,B]  239-20-260ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  294-20-314ms   | [S2,MB6,F]  316-7-323ms    | [S2,MB5,B]  336-20-357ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  378-20-398ms   | [S2,MB7,B]  418-8-427ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-103ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-13-166ms   | [S3,MB2,B]  171-21-193ms   | [S3,MB3,F]  196-11-207ms   | [S3,MB3,B]  213-21-234ms   | [S3,MB4,F]  238-11-249ms   | [S3,MB4,B]  255-34-290ms   | [S3,MB5,F]  292-11-304ms   | [S3,MB5,B]  310-21-331ms   | [S3,MB6,F]  335-10-346ms   | [S3,MB6,B]  352-21-373ms   | [S3,MB7,F]  377-11-388ms   | [S3,MB7,B]  393-21-415ms  
[rank3]:2025-12-23 19:58:35,321 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_1958_stage3_step600.svg
[rank0]:2025-12-23 19:58:36,528 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1958_stage0.svg
[rank1]:2025-12-23 19:58:36,529 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1958_stage1.svg
[rank2]:2025-12-23 19:58:36,547 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1958_stage2.svg
[rank3]:2025-12-23 19:58:36,663 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_1958_stage3.svg
[rank3]:2025-12-23 20:00:09,072 - Avg. fwd time: 11.7545 / Avg. bwd time: 29.3343 / Avg. batch time: 400.5538 (ms) / GPU bubble ratio: 17.94%
[rank2]:2025-12-23 20:00:09,093 - Avg. fwd time: 7.2558 / Avg. bwd time: 18.7318 / Avg. batch time: 423.8156 (ms) / GPU bubble ratio: 50.95%
[rank1]:2025-12-23 20:00:09,117 - Avg. fwd time: 9.6757 / Avg. bwd time: 24.2649 / Avg. batch time: 453.6339 (ms) / GPU bubble ratio: 40.14%
[rank0]:2025-12-23 20:00:09,128 - Avg. fwd time: 7.6099 / Avg. bwd time: 21.2168 / Avg. batch time: 472.4411 (ms) / GPU bubble ratio: 51.19%
[rank0]:2025-12-23 20:01:37,088 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-23 20:01:40,759 - Avg. fwd time: 11.7493 / Avg. bwd time: 29.2328 / Avg. batch time: 399.7005 (ms) / GPU bubble ratio: 17.97%
[rank2]:2025-12-23 20:01:40,779 - Avg. fwd time: 7.2561 / Avg. bwd time: 18.7301 / Avg. batch time: 422.8771 (ms) / GPU bubble ratio: 50.84%
[rank2]:2025-12-23 20:01:40,834 -  step: 650  loss: -8.0000  grad_norm:  0.1030  memory:  6.98GiB(14.69%)  tps: 8,823  tflops: 68.97  mfu: 22.11%
[rank1]:2025-12-23 20:01:40,802 - Avg. fwd time: 9.6795 / Avg. bwd time: 24.2725 / Avg. batch time: 452.6388 (ms) / GPU bubble ratio: 39.99%
[rank1]:2025-12-23 20:01:40,838 -  step: 650  loss: -8.0000  grad_norm:  0.1030  memory:  9.50GiB(19.99%)  tps: 8,823  tflops: 68.97  mfu: 22.11%
[rank0]:2025-12-23 20:01:40,813 - Avg. fwd time: 7.6094 / Avg. bwd time: 21.1848 / Avg. batch time: 471.2202 (ms) / GPU bubble ratio: 51.12%
[rank0]:2025-12-23 20:01:40,849 -  step: 650  loss: -8.0000  grad_norm:  0.1030  memory: 13.42GiB(28.26%)  tps: 8,823  tflops: 68.97  mfu: 22.11%
[rank3]:2025-12-23 20:01:40,847 -  step: 650  loss:  0.2269  grad_norm:  0.1030  memory: 16.39GiB(34.50%)  tps: 8,823  tflops: 68.97  mfu: 22.11%
[rank3]:2025-12-23 20:03:13,278 - Avg. fwd time: 11.7449 / Avg. bwd time: 29.1637 / Avg. batch time: 399.1123 (ms) / GPU bubble ratio: 18.00%
[rank2]:2025-12-23 20:03:13,299 - Avg. fwd time: 7.2553 / Avg. bwd time: 18.7281 / Avg. batch time: 422.2120 (ms) / GPU bubble ratio: 50.77%
[rank0]:2025-12-23 20:03:13,335 - Avg. fwd time: 7.6095 / Avg. bwd time: 21.1606 / Avg. batch time: 470.2497 (ms) / GPU bubble ratio: 51.06%
[rank1]:2025-12-23 20:03:13,323 - Avg. fwd time: 9.6788 / Avg. bwd time: 24.2657 / Avg. batch time: 451.8749 (ms) / GPU bubble ratio: 39.90%
[rank0]:2025-12-23 20:04:40,822 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 20:04:44,399 - Avg. fwd time: 11.7380 / Avg. bwd time: 29.0589 / Avg. batch time: 398.2191 (ms) / GPU bubble ratio: 18.04%
[rank2]:2025-12-23 20:04:44,420 - Avg. fwd time: 7.2559 / Avg. bwd time: 18.7265 / Avg. batch time: 421.2448 (ms) / GPU bubble ratio: 50.66%
[rank2]:2025-12-23 20:04:44,478 -  step: 700  loss: -8.0000  grad_norm:  0.0974  memory:  6.98GiB(14.69%)  tps: 8,922  tflops: 69.75  mfu: 22.35%
[rank0]:2025-12-23 20:04:44,456 - Avg. fwd time: 7.6091 / Avg. bwd time: 21.1467 / Avg. batch time: 469.0973 (ms) / GPU bubble ratio: 50.96%
[rank0]:2025-12-23 20:04:44,492 -  step: 700  loss: -8.0000  grad_norm:  0.0974  memory: 13.42GiB(28.26%)  tps: 8,922  tflops: 69.75  mfu: 22.35%
[rank1]:2025-12-23 20:04:44,444 - Avg. fwd time: 9.6833 / Avg. bwd time: 24.2777 / Avg. batch time: 450.8760 (ms) / GPU bubble ratio: 39.74%
[rank1]:2025-12-23 20:04:44,481 -  step: 700  loss: -8.0000  grad_norm:  0.0974  memory:  9.50GiB(19.99%)  tps: 8,922  tflops: 69.75  mfu: 22.35%
[rank3]:2025-12-23 20:04:44,490 -  step: 700  loss:  0.1882  grad_norm:  0.0974  memory: 16.39GiB(34.50%)  tps: 8,922  tflops: 69.75  mfu: 22.35%
[rank2]:2025-12-23 20:04:44,542 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_2004_stage2_step700.svg
[rank0]:2025-12-23 20:04:44,542 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_2004_stage0_step700.svg
[rank1]:2025-12-23 20:04:44,542 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_2004_stage1_step700.svg
[rank3]:2025-12-23 20:04:44,627 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_2004_step700_rank3.svg
[rank3]:			> Batch Time: 439.50 ms, GPU Bubble Ratio: 47.62%, 37.25%, 52.65%, 31.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-172ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-241ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  296-25-321ms   | [S0,MB7,F]  322-7-329ms    | [S0,MB4,B]  340-25-366ms   | [S0,MB5,B]  383-25-408ms   | [S0,MB6,B]  421-17-438ms   | [S0,MB7,B]  439-0-439ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  177-25-203ms   | [S1,MB4,F]  206-9-216ms    | [S1,MB2,B]  222-26-248ms   | [S1,MB5,F]  251-9-261ms    | [S1,MB3,B]  264-26-291ms   | [S1,MB6,F]  294-9-304ms    | [S1,MB4,B]  308-26-335ms   | [S1,MB7,F]  339-10-349ms   | [S1,MB5,B]  351-27-379ms   | [S1,MB6,B]  391-26-418ms   | [S1,MB7,B]  421-12-434ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-6-183ms    | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  220-7-227ms    | [S2,MB3,B]  240-20-260ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  284-20-304ms   | [S2,MB6,F]  306-7-314ms    | [S2,MB5,B]  325-20-346ms   | [S2,MB7,F]  350-7-357ms    | [S2,MB6,B]  367-20-387ms   | [S2,MB7,B]  407-8-416ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-11-103ms    | [S3,MB1,B]  109-40-149ms   | [S3,MB2,F]  152-13-166ms   | [S3,MB2,B]  171-21-193ms   | [S3,MB3,F]  197-11-208ms   | [S3,MB3,B]  214-21-235ms   | [S3,MB4,F]  238-11-249ms   | [S3,MB4,B]  255-23-278ms   | [S3,MB5,F]  282-11-293ms   | [S3,MB5,B]  299-21-320ms   | [S3,MB6,F]  324-10-335ms   | [S3,MB6,B]  341-21-362ms   | [S3,MB7,F]  366-10-376ms   | [S3,MB7,B]  382-21-404ms  
[rank3]:2025-12-23 20:04:44,672 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_2004_stage3_step700.svg
[rank2]:2025-12-23 20:04:46,172 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2004_stage2.svg
[rank0]:2025-12-23 20:04:46,152 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2004_stage0.svg
[rank1]:2025-12-23 20:04:46,152 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2004_stage1.svg
[rank3]:2025-12-23 20:04:46,290 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2004_stage3.svg
[rank3]:2025-12-23 20:06:17,639 - Avg. fwd time: 11.7289 / Avg. bwd time: 28.9768 / Avg. batch time: 397.4899 (ms) / GPU bubble ratio: 18.07%
[rank0]:2025-12-23 20:06:17,699 - Avg. fwd time: 7.6088 / Avg. bwd time: 21.1340 / Avg. batch time: 468.1063 (ms) / GPU bubble ratio: 50.88%
[rank2]:2025-12-23 20:06:17,661 - Avg. fwd time: 7.2563 / Avg. bwd time: 18.7252 / Avg. batch time: 420.4669 (ms) / GPU bubble ratio: 50.57%
[rank1]:2025-12-23 20:06:17,685 - Avg. fwd time: 9.6857 / Avg. bwd time: 24.2808 / Avg. batch time: 450.0284 (ms) / GPU bubble ratio: 39.62%
[rank0]:2025-12-23 20:07:45,854 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-23 20:07:49,473 - Avg. fwd time: 11.7233 / Avg. bwd time: 28.8999 / Avg. batch time: 396.8305 (ms) / GPU bubble ratio: 18.10%
[rank0]:2025-12-23 20:07:49,532 - Avg. fwd time: 7.6084 / Avg. bwd time: 21.1234 / Avg. batch time: 467.2130 (ms) / GPU bubble ratio: 50.80%
[rank0]:2025-12-23 20:07:49,567 -  step: 750  loss: -8.0000  grad_norm:  0.1280  memory: 13.42GiB(28.26%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank2]:2025-12-23 20:07:49,495 - Avg. fwd time: 7.2567 / Avg. bwd time: 18.7236 / Avg. batch time: 419.7412 (ms) / GPU bubble ratio: 50.48%
[rank2]:2025-12-23 20:07:49,553 -  step: 750  loss: -8.0000  grad_norm:  0.1280  memory:  6.98GiB(14.69%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank1]:2025-12-23 20:07:49,519 - Avg. fwd time: 9.6887 / Avg. bwd time: 24.2846 / Avg. batch time: 449.2475 (ms) / GPU bubble ratio: 39.50%
[rank1]:2025-12-23 20:07:49,557 -  step: 750  loss: -8.0000  grad_norm:  0.1280  memory:  9.50GiB(19.99%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank3]:2025-12-23 20:07:49,566 -  step: 750  loss:  0.2274  grad_norm:  0.1280  memory: 16.39GiB(34.50%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank3]:2025-12-23 20:09:20,685 - Avg. fwd time: 11.7183 / Avg. bwd time: 28.8199 / Avg. batch time: 396.1496 (ms) / GPU bubble ratio: 18.14%
[rank2]:2025-12-23 20:09:20,707 - Avg. fwd time: 7.2572 / Avg. bwd time: 18.7220 / Avg. batch time: 418.9985 (ms) / GPU bubble ratio: 50.40%
[rank0]:2025-12-23 20:09:20,745 - Avg. fwd time: 7.6081 / Avg. bwd time: 21.1024 / Avg. batch time: 466.2793 (ms) / GPU bubble ratio: 50.74%
[rank1]:2025-12-23 20:09:20,732 - Avg. fwd time: 9.6921 / Avg. bwd time: 24.2924 / Avg. batch time: 448.4743 (ms) / GPU bubble ratio: 39.38%
[rank0]:2025-12-23 20:10:49,007 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-23 20:10:52,699 - Avg. fwd time: 7.6081 / Avg. bwd time: 21.0970 / Avg. batch time: 465.5216 (ms) / GPU bubble ratio: 50.67%
[rank1]:2025-12-23 20:10:52,686 - Avg. fwd time: 9.6922 / Avg. bwd time: 24.2940 / Avg. batch time: 447.8026 (ms) / GPU bubble ratio: 39.28%
[rank2]:2025-12-23 20:10:52,661 - Avg. fwd time: 7.2575 / Avg. bwd time: 18.7212 / Avg. batch time: 418.3722 (ms) / GPU bubble ratio: 50.32%
[rank2]:2025-12-23 20:10:52,721 -  step: 800  loss: -8.0000  grad_norm:  0.1134  memory:  6.98GiB(14.69%)  tps: 8,945  tflops: 69.93  mfu: 22.41%
[rank2]:2025-12-23 20:10:52,721 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1134  tps: 8,978  tflops: 70.19  mfu: 20.59%
[rank2]:2025-12-23 20:10:52,721 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-23 20:10:52,722 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-23 20:10:52,639 - Avg. fwd time: 11.7112 / Avg. bwd time: 28.7553 / Avg. batch time: 395.5759 (ms) / GPU bubble ratio: 18.16%
[rank3]:2025-12-23 20:10:52,733 -  step: 800  loss:  0.2322  grad_norm:  0.1134  memory: 16.39GiB(34.50%)  tps: 8,945  tflops: 69.93  mfu: 22.41%
[rank3]:2025-12-23 20:10:52,734 - â„¹ï¸ final step: 800  loss:  0.2322  grad_norm:  0.1134  tps: 8,986  tflops: 70.25  mfu: 20.74%
[rank3]:2025-12-23 20:10:52,734 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-23 20:10:52,735 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-23 20:10:52,735 -  step: 800  loss: -8.0000  grad_norm:  0.1134  memory: 13.42GiB(28.26%)  tps: 8,945  tflops: 69.93  mfu: 22.41%
[rank0]:2025-12-23 20:10:52,735 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1134  tps: 8,979  tflops: 70.19  mfu: 20.60%
[rank0]:2025-12-23 20:10:52,735 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-23 20:10:52,736 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-23 20:10:52,724 -  step: 800  loss: -8.0000  grad_norm:  0.1134  memory:  9.50GiB(19.99%)  tps: 8,945  tflops: 69.93  mfu: 22.41%
[rank1]:2025-12-23 20:10:52,724 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1134  tps: 8,980  tflops: 70.20  mfu: 20.62%
[rank1]:2025-12-23 20:10:52,724 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-23 20:10:52,725 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-23 20:10:54,772 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-23 20:10:54,849 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251223_2010_stage0_final800.svg
[rank1]:2025-12-23 20:10:54,847 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251223_2010_stage1_final800.svg
[rank2]:2025-12-23 20:10:54,848 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251223_2010_stage2_final800.svg
[rank3]:2025-12-23 20:10:54,929 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_2010_final800_rank3.svg
[rank3]:			> Batch Time: 444.50 ms, GPU Bubble Ratio: 49.03%, 38.80%, 53.21%, 31.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  208-25-233ms   | [S0,MB5,F]  233-7-240ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  296-25-321ms   | [S0,MB7,F]  321-7-328ms    | [S0,MB4,B]  345-25-370ms   | [S0,MB5,B]  387-25-412ms   | [S0,MB6,B]  426-13-440ms   | [S0,MB7,B]  444-0-444ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  177-25-203ms   | [S1,MB4,F]  206-9-216ms    | [S1,MB2,B]  222-25-248ms   | [S1,MB5,F]  251-9-261ms    | [S1,MB3,B]  264-26-291ms   | [S1,MB6,F]  294-9-304ms    | [S1,MB4,B]  313-26-339ms   | [S1,MB7,F]  343-9-353ms    | [S1,MB5,B]  356-27-383ms   | [S1,MB6,B]  397-25-423ms   | [S1,MB7,B]  427-12-439ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  154-19-174ms   | [S2,MB3,F]  176-7-183ms    | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  220-7-227ms    | [S2,MB3,B]  240-20-260ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  289-20-309ms   | [S2,MB6,F]  311-7-318ms    | [S2,MB5,B]  331-20-352ms   | [S2,MB7,F]  355-7-362ms    | [S2,MB6,B]  373-20-394ms   | [S2,MB7,B]  414-9-423ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-40-149ms   | [S3,MB2,F]  152-12-165ms   | [S3,MB2,B]  170-21-192ms   | [S3,MB3,F]  196-11-207ms   | [S3,MB3,B]  213-21-235ms   | [S3,MB4,F]  238-11-249ms   | [S3,MB4,B]  255-26-282ms   | [S3,MB5,F]  287-11-299ms   | [S3,MB5,B]  305-21-326ms   | [S3,MB6,F]  330-11-341ms   | [S3,MB6,B]  347-21-368ms   | [S3,MB7,F]  372-10-383ms   | [S3,MB7,B]  389-21-410ms  
[rank0]:2025-12-23 20:10:55,006 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251223_2010_rank0_stage0.svg
[rank0]:	> Counts Sum: 337440, Total Sum: 1728640 (19.52%), Ratio(%) per element: [22.77, 23.11, 22.6, 23.11, 22.94, 21.06, 21.4, 21.91, 21.57, 22.6, 22.08, 21.74, 21.06, 21.57, 21.23, 20.54, 19.52, 21.06, 20.2, 19.86, 19.69, 18.49, 18.32, 19.0, 17.8, 19.34, 17.97, 17.63, 16.6, 17.29, 15.92, 16.26, 15.75, 15.92, 14.21, 16.26, 13.69]
[rank1]:2025-12-23 20:10:54,994 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251223_2010_rank1_stage1.svg
[rank1]:	> Counts Sum: 293520, Total Sum: 2102400 (13.96%), Ratio(%) per element: [14.04, 13.69, 14.21, 14.55, 14.04, 13.69, 14.21, 13.52, 14.55, 14.21, 14.55, 14.04, 13.69, 13.18, 14.21, 14.04, 13.18, 14.55, 14.04, 13.35, 14.38, 14.38, 13.52, 13.69, 14.38, 14.21, 13.69, 13.52, 13.69, 14.72, 14.21, 14.55, 13.18, 14.04, 13.01, 14.04, 14.21, 13.86, 14.89, 13.86, 13.52, 14.38, 13.52, 13.35, 13.69]
[rank2]:2025-12-23 20:10:55,004 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251223_2010_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank3]:2025-12-23 20:10:55,059 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251223_2010_thry_final800_rank3.svg
[rank3]:			> Batch Time: 297.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB0,B]  90-18-108ms    | [S0,MB4,F]  108-9-117ms    | [S0,MB1,B]  117-18-135ms   | [S0,MB5,F]  135-9-144ms    | [S0,MB2,B]  144-18-162ms   | [S0,MB6,F]  162-9-171ms    | [S0,MB3,B]  171-18-189ms   | [S0,MB7,F]  189-9-198ms    | [S0,MB4,B]  198-18-216ms   | [S0,MB5,B]  225-18-243ms   | [S0,MB6,B]  252-18-270ms   | [S0,MB7,B]  279-18-297ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-18ms       | [S1,MB1,F]  18-9-27ms      | [S1,MB2,F]  27-9-36ms      | [S1,MB0,B]  72-18-90ms     | [S1,MB3,F]  90-9-99ms      | [S1,MB1,B]  99-18-117ms    | [S1,MB4,F]  117-9-126ms    | [S1,MB2,B]  126-18-144ms   | [S1,MB5,F]  144-9-153ms    | [S1,MB3,B]  153-18-171ms   | [S1,MB6,F]  171-9-180ms    | [S1,MB4,B]  180-18-198ms   | [S1,MB7,F]  198-9-207ms    | [S1,MB5,B]  207-18-225ms   | [S1,MB6,B]  234-18-252ms   | [S1,MB7,B]  261-18-279ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  18-9-27ms      | [S2,MB1,F]  27-9-36ms      | [S2,MB0,B]  54-18-72ms     | [S2,MB2,F]  72-9-81ms      | [S2,MB1,B]  81-18-99ms     | [S2,MB3,F]  99-9-108ms     | [S2,MB2,B]  108-18-126ms   | [S2,MB4,F]  126-9-135ms    | [S2,MB3,B]  135-18-153ms   | [S2,MB5,F]  153-9-162ms    | [S2,MB4,B]  162-18-180ms   | [S2,MB6,F]  180-9-189ms    | [S2,MB5,B]  189-18-207ms   | [S2,MB7,F]  207-9-216ms    | [S2,MB6,B]  216-18-234ms   | [S2,MB7,B]  243-18-261ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  27-9-36ms      | [S3,MB0,B]  36-18-54ms     | [S3,MB1,F]  54-9-63ms      | [S3,MB1,B]  63-18-81ms     | [S3,MB2,F]  81-9-90ms      | [S3,MB2,B]  90-18-108ms    | [S3,MB3,F]  108-9-117ms    | [S3,MB3,B]  117-18-135ms   | [S3,MB4,F]  135-9-144ms    | [S3,MB4,B]  144-18-162ms   | [S3,MB5,F]  162-9-171ms    | [S3,MB5,B]  171-18-189ms   | [S3,MB6,F]  189-9-198ms    | [S3,MB6,B]  198-18-216ms   | [S3,MB7,F]  216-9-225ms    | [S3,MB7,B]  225-18-243ms  
[rank3]:2025-12-23 20:10:55,107 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251223_2010_stage3_final800.svg
[rank3]:2025-12-23 20:10:55,240 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251223_2010_rank3_stage3.svg
[rank3]:	> Counts Sum: 894080, Total Sum: 1354880 (65.99%), Ratio(%) per element: [65.75, 65.58, 65.23, 66.95, 64.21, 67.12, 65.58, 64.89, 66.6, 65.41, 66.78, 65.58, 67.97, 65.23, 67.63, 65.06, 67.12, 65.75, 66.09, 65.58, 67.12, 65.06, 66.26, 65.92, 66.43, 65.23, 65.41, 64.55, 67.46]
[rank1]:2025-12-23 20:10:56,822 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2010_stage1.svg
[rank0]:2025-12-23 20:10:56,853 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2010_stage0.svg
[rank0]:2025-12-23 20:10:56,857 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-23 20:10:56,826 - Destroying the purge thread.
[rank1]:2025-12-23 20:10:56,880 - Process group destroyed
[rank2]:2025-12-23 20:10:56,876 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2010_stage2.svg
[rank2]:2025-12-23 20:10:56,879 - Destroying the purge thread.
[rank3]:2025-12-23 20:10:57,091 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251223_2010_stage3.svg
[rank3]:2025-12-23 20:10:57,095 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-23 20:10:57,332 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 313-334
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.64672
[rank3]:wandb:               final/avg_loss 0.23221
[rank3]:wandb:             final/avg_mfu(%) 20.74258
[rank3]:wandb:             final/avg_tflops 70.24527
[rank3]:wandb:    final/avg_throughput(tps) 8985.59822
[rank3]:wandb:              final/grad_norm 0.11337
[rank3]:wandb:               final/max_loss 0.23221
[rank3]:wandb:                    grad_norm 0.11337
[rank3]:wandb: loss_metrics/global_avg_loss 0.23221
[rank3]:wandb: loss_metrics/global_max_loss 0.23221
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1223_1F1B_fullrand7_mfr0.7_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/asmjrdf1
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.7_42_dm1/20251223-1919/wandb/run-20251223_191911-asmjrdf1/logs
[rank3]:2025-12-23 20:10:58,323 - Process group destroyed
[rank0]:2025-12-23 20:10:58,857 - Training completed
[rank0]:2025-12-23 20:10:58,858 - Destroying the purge thread.
[rank0]:2025-12-23 20:10:58,917 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.11', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.1', 'tok_embeddings', 'layers.2', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.5', 'layers.7', 'layers.6', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.14', 'output', 'layers.13', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1223_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
