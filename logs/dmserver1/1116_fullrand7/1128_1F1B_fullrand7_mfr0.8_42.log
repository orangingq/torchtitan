
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 01. (ì›”) 00:29:49 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.8_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.8) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-01 00:29:55,281 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-12-01 00:29:55,433 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-01 00:29:55,435 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-01 00:29:55,440 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank3]:2025-12-01 00:29:55,390 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-12-01 00:29:55,480 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank1]:2025-12-01 00:29:55,480 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-12-01 00:29:55,556 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-01 00:29:55,558 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-01 00:29:55,566 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 00:29:55,707 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-01 00:29:55,709 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-01 00:29:55,713 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-01 00:29:55,713 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 00:29:55,714 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-12-01 00:29:55,711 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-01 00:29:55,713 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-01 00:29:55,715 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 00:29:56,107 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-01 00:29:58,761 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-01 00:29:58,850 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-01 00:29:58,908 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-01 00:29:58,948 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 00:29:58,949 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-01 00:29:58,890 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-01 00:29:58,918 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-01 00:29:58,918 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-01 00:29:58,977 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-01 00:29:58,977 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-01 00:29:58,965 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-01 00:29:58,994 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 00:29:59,017 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-01 00:29:59,017 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-01 00:29:59,099 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-01 00:29:59,099 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-01 00:29:59,100 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-01 00:29:59,170 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 00:29:59,170 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-01 00:29:59,171 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-01 00:29:59,202 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 00:29:59,202 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-01 00:29:59,202 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 55fdxrqa
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.8_42_dm1/20251201-0029/wandb/run-20251201_002959-55fdxrqa
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/55fdxrqa
[rank3]:2025-12-01 00:30:01,240 - INFO - WandB logging enabled
[rank3]:2025-12-01 00:30:01,241 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-01 00:30:01,277 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-01 00:30:01,305 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-01 00:30:01,306 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-01 00:30:01,513 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank0]:2025-12-01 00:30:01,513 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 00:30:01,514 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-01 00:30:01,521 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-01 00:30:01,513 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-01 00:30:01,496 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-01 00:30:01,497 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-01 00:30:01,498 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-01 00:30:01,513 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-01 00:30:01,513 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 00:30:03,502 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-01 00:30:03,502 - INFO - Finished loading the checkpoint in 1.98 seconds.
[rank0]:2025-12-01 00:30:03,502 - INFO - Training starts at step 1
[rank2]:2025-12-01 00:30:09,374 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  4.59GiB(9.67%)  tps: 3,126  tflops: 24.43  mfu: 7.83%
[rank2]:2025-12-01 00:30:09,374 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-01 00:30:09,419 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  9.17GiB(19.29%)  tps: 3,130  tflops: 24.47  mfu: 7.84%
[rank0]:2025-12-01 00:30:09,419 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-01 00:30:09,377 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  6.72GiB(14.15%)  tps: 3,156  tflops: 24.67  mfu: 7.91%
[rank1]:2025-12-01 00:30:09,377 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-01 00:30:09,385 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 12.97GiB(27.31%)  tps: 4,043  tflops: 31.60  mfu: 10.13%
[rank3]:2025-12-01 00:30:09,386 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-01 00:32:17,413 - INFO - Avg. fwd time: 7.4890 / Avg. bwd time: 19.8272 / Avg. batch time: 571.4095 (ms) / GPU bubble ratio: 61.76%
[rank3]:2025-12-01 00:32:17,388 - INFO - Avg. fwd time: 13.0870 / Avg. bwd time: 43.9376 / Avg. batch time: 538.0273 (ms) / GPU bubble ratio: 15.21%
[rank1]:2025-12-01 00:32:17,443 - INFO - Avg. fwd time: 9.6191 / Avg. bwd time: 25.0543 / Avg. batch time: 611.9100 (ms) / GPU bubble ratio: 54.67%
[rank0]:2025-12-01 00:32:17,473 - INFO - Avg. fwd time: 7.7643 / Avg. bwd time: 25.5796 / Avg. batch time: 651.3885 (ms) / GPU bubble ratio: 59.05%
[rank0]:2025-12-01 00:34:26,292 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 00:34:31,572 - INFO - Avg. fwd time: 7.4895 / Avg. bwd time: 19.8722 / Avg. batch time: 573.3562 (ms) / GPU bubble ratio: 61.82%
[rank3]:2025-12-01 00:34:31,547 - INFO - Avg. fwd time: 13.1895 / Avg. bwd time: 44.1394 / Avg. batch time: 540.3878 (ms) / GPU bubble ratio: 15.13%
[rank1]:2025-12-01 00:34:31,602 - INFO - Avg. fwd time: 9.6343 / Avg. bwd time: 25.1206 / Avg. batch time: 613.5328 (ms) / GPU bubble ratio: 54.68%
[rank1]:2025-12-01 00:34:31,657 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  8.99GiB(18.92%)  tps: 6,122  tflops: 47.86  mfu: 15.34%
[rank2]:2025-12-01 00:34:31,654 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  6.39GiB(13.45%)  tps: 6,122  tflops: 47.86  mfu: 15.34%
[rank3]:2025-12-01 00:34:31,666 - INFO -  step: 50  loss:  9.9211  grad_norm: 12.8635  memory: 16.39GiB(34.50%)  tps: 6,122  tflops: 47.86  mfu: 15.34%
[rank0]:2025-12-01 00:34:31,632 - INFO - Avg. fwd time: 7.7679 / Avg. bwd time: 25.6253 / Avg. batch time: 652.6670 (ms) / GPU bubble ratio: 59.07%
[rank0]:2025-12-01 00:34:31,668 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory: 12.97GiB(27.31%)  tps: 6,123  tflops: 47.86  mfu: 15.34%
[rank3]:2025-12-01 00:35:25,297 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-01 00:36:19,167 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-01 00:36:19,295 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-01 00:36:37,473 - INFO - Avg. fwd time: 13.3560 / Avg. bwd time: 42.7944 / Avg. batch time: 530.9373 (ms) / GPU bubble ratio: 15.39%
[rank0]:2025-12-01 00:36:37,508 - INFO - Avg. fwd time: 7.8665 / Avg. bwd time: 23.9526 / Avg. batch time: 639.5562 (ms) / GPU bubble ratio: 60.20%
[rank2]:2025-12-01 00:36:37,487 - INFO - Avg. fwd time: 7.5957 / Avg. bwd time: 19.1931 / Avg. batch time: 563.0584 (ms) / GPU bubble ratio: 61.94%
[rank1]:2025-12-01 00:36:37,504 - INFO - Avg. fwd time: 9.7651 / Avg. bwd time: 24.2694 / Avg. batch time: 602.2576 (ms) / GPU bubble ratio: 54.79%
[rank3]:2025-12-01 00:36:55,680 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-01 00:36:55,853 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0036_max_batch_time.svg
[rank3]:			> Batch Time: 559.80 ms, GPU Bubble Ratio: 52.13%, 50.36%, 60.85%, 18.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  132-26-158ms   | [S0,MB4,F]  158-7-165ms    | [S0,MB1,B]  186-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  242-25-268ms   | [S0,MB6,F]  268-7-275ms    | [S0,MB3,B]  301-25-326ms   | [S0,MB7,F]  326-7-334ms    | [S0,MB4,B]  359-25-385ms   | [S0,MB5,B]  417-25-442ms   | [S0,MB6,B]  476-25-501ms   | [S0,MB7,B]  534-25-559ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-132ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  161-25-186ms   | [S1,MB4,F]  186-9-196ms    | [S1,MB2,B]  217-25-242ms   | [S1,MB5,F]  242-9-252ms    | [S1,MB3,B]  275-25-301ms   | [S1,MB6,F]  301-9-310ms    | [S1,MB4,B]  334-25-359ms   | [S1,MB7,F]  359-9-368ms    | [S1,MB5,B]  392-25-417ms   | [S1,MB6,B]  451-25-476ms   | [S1,MB7,B]  509-25-534ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  197-19-217ms   | [S2,MB4,F]  217-7-224ms    | [S2,MB3,B]  255-19-275ms   | [S2,MB5,F]  275-7-283ms    | [S2,MB4,B]  314-19-334ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  372-19-392ms   | [S2,MB7,F]  392-7-399ms    | [S2,MB6,B]  431-19-451ms   | [S2,MB7,B]  489-19-509ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-10-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-43-197ms   AFR(10):0.9655 | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB4,F]  255-13-269ms   | [S3,MB4,B]  269-45-314ms   AFR(10):0.9655 | [S3,MB5,F]  314-13-327ms   | [S3,MB5,B]  327-44-372ms   AFR(10):0.9655 | [S3,MB6,F]  372-13-385ms   | [S3,MB6,B]  385-45-431ms   AFR(10):0.9655 | [S3,MB7,F]  431-13-444ms   | [S3,MB7,B]  444-44-489ms   AFR(10):0.9655
[rank3]:2025-12-01 00:36:55,979 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0036_min_batch_time.svg
[rank3]:			> Batch Time: 338.37 ms, GPU Bubble Ratio: 81.73%, 49.50%, 60.40%, 15.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  88-0-88ms      | [S0,MB4,F]  88-7-95ms      | [S0,MB1,B]  121-0-121ms    | [S0,MB5,F]  121-7-128ms    | [S0,MB2,B]  156-0-156ms    | [S0,MB6,F]  156-7-163ms    | [S0,MB3,B]  193-0-193ms    | [S0,MB7,F]  193-7-200ms    | [S0,MB4,B]  229-0-229ms    | [S0,MB5,B]  266-0-266ms    | [S0,MB6,B]  302-0-302ms    | [S0,MB7,B]  338-0-338ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  76-11-88ms     | [S1,MB3,F]  88-9-97ms      | [S1,MB1,B]  109-11-121ms   | [S1,MB4,F]  121-9-131ms    | [S1,MB2,B]  144-11-156ms   | [S1,MB5,F]  156-9-166ms    | [S1,MB3,B]  181-11-193ms   | [S1,MB6,F]  193-9-202ms    | [S1,MB4,B]  217-11-229ms   | [S1,MB7,F]  229-9-238ms    | [S1,MB5,B]  254-11-266ms   | [S1,MB6,B]  290-11-302ms   | [S1,MB7,B]  326-11-338ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  67-9-76ms      | [S2,MB2,F]  76-7-83ms      | [S2,MB1,B]  100-9-109ms    | [S2,MB3,F]  109-7-117ms    | [S2,MB2,B]  135-9-144ms    | [S2,MB4,F]  144-7-152ms    | [S2,MB3,B]  172-9-181ms    | [S2,MB5,F]  181-7-188ms    | [S2,MB4,B]  208-9-217ms    | [S2,MB6,F]  217-7-224ms    | [S2,MB5,B]  244-9-254ms    | [S2,MB7,F]  254-7-261ms    | [S2,MB6,B]  281-9-290ms    | [S2,MB7,B]  317-9-326ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-22-67ms     AFR(10):0.9655 | [S3,MB1,F]  67-10-78ms     | [S3,MB1,B]  78-22-100ms    AFR(10):0.9655 | [S3,MB2,F]  100-12-113ms   | [S3,MB2,B]  113-22-135ms   AFR(10):0.9655 | [S3,MB3,F]  135-13-149ms   | [S3,MB3,B]  149-22-172ms   AFR(10):0.9655 | [S3,MB4,F]  172-13-185ms   | [S3,MB4,B]  185-22-208ms   AFR(10):0.9655 | [S3,MB5,F]  208-13-221ms   | [S3,MB5,B]  221-23-244ms   AFR(10):0.9655 | [S3,MB6,F]  244-13-258ms   | [S3,MB6,B]  258-22-281ms   AFR(10):0.9655 | [S3,MB7,F]  281-13-294ms   | [S3,MB7,B]  294-22-317ms   AFR(10):0.9655
[rank3]:2025-12-01 00:36:56,116 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0036_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 371.02 ms, GPU Bubble Ratio: 38.36%, 28.69%, 43.81%, 13.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  132-26-158ms   | [S0,MB4,F]  158-7-165ms    | [S0,MB1,B]  178-25-204ms   | [S0,MB5,F]  204-7-211ms    | [S0,MB2,B]  213-25-239ms   | [S0,MB6,F]  239-7-246ms    | [S0,MB3,B]  250-25-275ms   | [S0,MB7,F]  275-7-282ms    | [S0,MB4,B]  285-25-311ms   | [S0,MB5,B]  322-25-348ms   | [S0,MB6,B]  358-12-371ms   | [S0,MB7,B]  371-0-371ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-132ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  153-25-178ms   | [S1,MB4,F]  178-9-187ms    | [S1,MB2,B]  188-25-213ms   | [S1,MB5,F]  213-9-222ms    | [S1,MB3,B]  224-25-250ms   | [S1,MB6,F]  250-9-259ms    | [S1,MB4,B]  260-25-285ms   | [S1,MB7,F]  285-9-295ms    | [S1,MB5,B]  297-25-322ms   | [S1,MB6,B]  333-25-358ms   | [S1,MB7,B]  359-11-371ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  133-19-153ms   | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  168-19-188ms   | [S2,MB4,F]  188-7-195ms    | [S2,MB3,B]  204-19-224ms   | [S2,MB5,F]  224-7-232ms    | [S2,MB4,B]  240-19-260ms   | [S2,MB6,F]  260-7-267ms    | [S2,MB5,B]  277-19-297ms   | [S2,MB7,F]  297-7-304ms    | [S2,MB6,B]  313-19-333ms   | [S2,MB7,B]  350-9-359ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-10-98ms     | [S3,MB1,B]  98-34-133ms    AFR(10):0.9655 | [S3,MB2,F]  133-12-145ms   | [S3,MB2,B]  145-22-168ms   AFR(10):0.9655 | [S3,MB3,F]  168-13-182ms   | [S3,MB3,B]  182-22-204ms   AFR(10):0.9655 | [S3,MB4,F]  204-13-218ms   | [S3,MB4,B]  218-22-240ms   AFR(10):0.9655 | [S3,MB5,F]  240-13-254ms   | [S3,MB5,B]  254-23-277ms   AFR(10):0.9655 | [S3,MB6,F]  277-13-291ms   | [S3,MB6,B]  291-22-313ms   AFR(10):0.9655 | [S3,MB7,F]  313-13-327ms   | [S3,MB7,B]  327-22-350ms   AFR(10):0.9655
[rank3]:2025-12-01 00:36:56,117 - INFO - 	> Batch Time: 371.02 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.34)
[rank0]:2025-12-01 00:38:24,201 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 00:38:29,111 - INFO - Avg. fwd time: 13.6736 / Avg. bwd time: 39.8468 / Avg. batch time: 509.9391 (ms) / GPU bubble ratio: 16.04%
[rank3]:2025-12-01 00:38:29,115 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.10(0.13)/0.40, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-01 00:38:29,136 - INFO - Avg. fwd time: 7.7079 / Avg. bwd time: 18.4766 / Avg. batch time: 541.6928 (ms) / GPU bubble ratio: 61.33%
[rank2]:2025-12-01 00:38:29,141 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-01 00:38:29,191 - INFO - Avg. fwd time: 8.0166 / Avg. bwd time: 21.1245 / Avg. batch time: 615.3019 (ms) / GPU bubble ratio: 62.11%
[rank0]:2025-12-01 00:38:29,199 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.18)/0.53, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-01 00:38:29,165 - INFO - Avg. fwd time: 9.9180 / Avg. bwd time: 23.1991 / Avg. batch time: 580.0776 (ms) / GPU bubble ratio: 54.33%
[rank1]:2025-12-01 00:38:29,172 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-01 00:38:29,216 - INFO -  step: 100  loss: -8.0000  grad_norm:  6.0082  memory:  9.36GiB(19.71%)  tps: 6,897  tflops: 53.92  mfu: 17.28%
[rank3]:2025-12-01 00:38:29,225 - INFO -  step: 100  loss:  8.7565  grad_norm:  6.0082  memory: 16.88GiB(35.53%)  tps: 6,897  tflops: 53.92  mfu: 17.28%
[rank2]:2025-12-01 00:38:29,213 - INFO -  step: 100  loss: -8.0000  grad_norm:  6.0082  memory:  6.51GiB(13.70%)  tps: 6,897  tflops: 53.92  mfu: 17.28%
[rank2]:2025-12-01 00:38:29,285 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0038_stage2_step100.svg
[rank0]:2025-12-01 00:38:29,227 - INFO -  step: 100  loss: -8.0000  grad_norm:  6.0082  memory: 12.97GiB(27.31%)  tps: 6,897  tflops: 53.92  mfu: 17.28%
[rank0]:2025-12-01 00:38:29,285 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0038_stage0_step100.svg
[rank1]:2025-12-01 00:38:29,285 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0038_stage1_step100.svg
[rank3]:2025-12-01 00:38:29,365 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0038_real_step100_rank3.svg
[rank3]:			> Batch Time: 611.88 ms, GPU Bubble Ratio: 62.84%, 55.63%, 64.93%, 30.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  134-17-151ms   | [S0,MB4,F]  151-7-158ms    | [S0,MB1,B]  200-17-217ms   | [S0,MB5,F]  217-7-224ms    | [S0,MB2,B]  268-17-286ms   | [S0,MB6,F]  286-7-293ms    | [S0,MB3,B]  339-17-356ms   | [S0,MB7,F]  356-7-363ms    | [S0,MB4,B]  408-25-433ms   | [S0,MB5,B]  473-25-499ms   | [S0,MB6,B]  535-21-556ms   | [S0,MB7,B]  590-21-611ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  37-9-46ms      | [S1,MB0,B]  106-22-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  173-22-195ms   | [S1,MB4,F]  198-9-208ms    | [S1,MB2,B]  241-22-263ms   | [S1,MB5,F]  267-9-276ms    | [S1,MB3,B]  309-25-334ms   | [S1,MB6,F]  338-9-347ms    | [S1,MB4,B]  377-25-403ms   | [S1,MB7,F]  406-9-416ms    | [S1,MB5,B]  445-25-470ms   | [S1,MB6,B]  506-25-531ms   | [S1,MB7,B]  562-24-587ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  83-17-101ms    | [S2,MB2,F]  104-7-112ms    | [S2,MB1,B]  151-17-168ms   | [S2,MB3,F]  171-7-178ms    | [S2,MB2,B]  216-20-236ms   | [S2,MB4,F]  239-7-246ms    | [S2,MB3,B]  284-19-304ms   | [S2,MB5,F]  307-7-315ms    | [S2,MB4,B]  352-20-372ms   | [S2,MB6,F]  376-7-383ms    | [S2,MB5,B]  420-19-440ms   | [S2,MB7,F]  443-7-450ms    | [S2,MB6,B]  483-20-503ms   | [S2,MB7,B]  540-19-559ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-26-78ms     | [S3,MB1,F]  82-13-96ms     | [S3,MB1,B]  103-42-146ms   | [S3,MB2,F]  149-11-161ms   | [S3,MB2,B]  168-43-211ms   | [S3,MB3,F]  214-13-228ms   | [S3,MB3,B]  235-44-279ms   | [S3,MB4,F]  283-13-296ms   | [S3,MB4,B]  303-44-348ms   | [S3,MB5,F]  351-14-365ms   | [S3,MB5,B]  372-43-415ms   | [S3,MB6,F]  418-13-432ms   | [S3,MB6,B]  439-38-478ms   | [S3,MB7,F]  481-15-497ms   | [S3,MB7,B]  505-30-536ms  
[rank3]:2025-12-01 00:38:29,407 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0038_stage3_step100.svg
[rank3]:2025-12-01 00:40:33,088 - INFO - Avg. fwd time: 13.7261 / Avg. bwd time: 39.4005 / Avg. batch time: 507.0487 (ms) / GPU bubble ratio: 16.18%
[rank0]:2025-12-01 00:40:33,168 - INFO - Avg. fwd time: 8.0239 / Avg. bwd time: 21.2338 / Avg. batch time: 612.6861 (ms) / GPU bubble ratio: 61.80%
[rank2]:2025-12-01 00:40:33,113 - INFO - Avg. fwd time: 7.6903 / Avg. bwd time: 18.5771 / Avg. batch time: 538.8725 (ms) / GPU bubble ratio: 61.00%
[rank1]:2025-12-01 00:40:33,142 - INFO - Avg. fwd time: 9.9062 / Avg. bwd time: 23.2468 / Avg. batch time: 577.3552 (ms) / GPU bubble ratio: 54.06%
[rank0]:2025-12-01 00:42:24,157 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 00:42:28,712 - INFO - Avg. fwd time: 7.7012 / Avg. bwd time: 18.4946 / Avg. batch time: 530.3091 (ms) / GPU bubble ratio: 60.48%
[rank2]:2025-12-01 00:42:28,718 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank3]:2025-12-01 00:42:28,688 - INFO - Avg. fwd time: 13.8424 / Avg. bwd time: 38.1657 / Avg. batch time: 498.6733 (ms) / GPU bubble ratio: 16.57%
[rank3]:2025-12-01 00:42:28,693 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.27)/0.40, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank1]:2025-12-01 00:42:28,741 - INFO - Avg. fwd time: 9.9345 / Avg. bwd time: 23.0666 / Avg. batch time: 568.7301 (ms) / GPU bubble ratio: 53.58%
[rank1]:2025-12-01 00:42:28,748 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank2]:2025-12-01 00:42:28,792 - INFO -  step: 150  loss: -8.0000  grad_norm:  5.0652  memory:  6.51GiB(13.70%)  tps: 6,839  tflops: 53.46  mfu: 17.14%
[rank0]:2025-12-01 00:42:28,770 - INFO - Avg. fwd time: 8.0694 / Avg. bwd time: 21.0043 / Avg. batch time: 603.9949 (ms) / GPU bubble ratio: 61.49%
[rank0]:2025-12-01 00:42:28,778 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.35)/0.53, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-01 00:42:28,806 - INFO -  step: 150  loss: -8.0000  grad_norm:  5.0652  memory: 13.29GiB(27.97%)  tps: 6,839  tflops: 53.46  mfu: 17.14%
[rank3]:2025-12-01 00:42:28,804 - INFO -  step: 150  loss:  4.0844  grad_norm:  5.0652  memory: 17.37GiB(36.56%)  tps: 6,839  tflops: 53.46  mfu: 17.14%
[rank1]:2025-12-01 00:42:28,795 - INFO -  step: 150  loss: -8.0000  grad_norm:  5.0652  memory:  9.36GiB(19.71%)  tps: 6,839  tflops: 53.46  mfu: 17.14%
[rank3]:2025-12-01 00:44:18,874 - INFO - Avg. fwd time: 13.9718 / Avg. bwd time: 36.8120 / Avg. batch time: 488.9777 (ms) / GPU bubble ratio: 16.91%
[rank2]:2025-12-01 00:44:18,898 - INFO - Avg. fwd time: 7.7113 / Avg. bwd time: 18.4448 / Avg. batch time: 520.5936 (ms) / GPU bubble ratio: 59.81%
[rank0]:2025-12-01 00:44:18,952 - INFO - Avg. fwd time: 8.1154 / Avg. bwd time: 20.5369 / Avg. batch time: 593.9004 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-12-01 00:44:18,927 - INFO - Avg. fwd time: 9.9703 / Avg. bwd time: 22.8334 / Avg. batch time: 558.9398 (ms) / GPU bubble ratio: 53.05%
[rank0]:2025-12-01 00:46:02,765 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 00:46:07,059 - INFO - Avg. fwd time: 7.7364 / Avg. bwd time: 18.3026 / Avg. batch time: 512.1989 (ms) / GPU bubble ratio: 59.33%
[rank2]:2025-12-01 00:46:07,065 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank3]:2025-12-01 00:46:07,035 - INFO - Avg. fwd time: 14.0861 / Avg. bwd time: 35.6678 / Avg. batch time: 480.7429 (ms) / GPU bubble ratio: 17.20%
[rank3]:2025-12-01 00:46:07,040 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.38(0.40)/0.40, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-01 00:46:07,113 - INFO - Avg. fwd time: 8.1788 / Avg. bwd time: 19.8617 / Avg. batch time: 585.0863 (ms) / GPU bubble ratio: 61.66%
[rank0]:2025-12-01 00:46:07,121 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.53)/0.53, [MB7] 0.95(1.00)/1.00
[rank1]:2025-12-01 00:46:07,088 - INFO - Avg. fwd time: 10.0139 / Avg. bwd time: 22.5635 / Avg. batch time: 550.4319 (ms) / GPU bubble ratio: 52.65%
[rank1]:2025-12-01 00:46:07,095 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-01 00:46:07,139 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4871  memory:  9.36GiB(19.71%)  tps: 7,504  tflops: 58.66  mfu: 18.80%
[rank2]:2025-12-01 00:46:07,135 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4871  memory:  6.51GiB(13.70%)  tps: 7,504  tflops: 58.66  mfu: 18.80%
[rank2]:2025-12-01 00:46:07,200 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0046_stage2_step200.svg
[rank3]:2025-12-01 00:46:07,144 - INFO -  step: 200  loss:  1.5742  grad_norm:  1.4871  memory: 17.37GiB(36.56%)  tps: 7,504  tflops: 58.66  mfu: 18.80%
[rank0]:2025-12-01 00:46:07,149 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4871  memory: 13.29GiB(27.97%)  tps: 7,504  tflops: 58.66  mfu: 18.80%
[rank0]:2025-12-01 00:46:07,200 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0046_stage0_step200.svg
[rank1]:2025-12-01 00:46:07,200 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0046_stage1_step200.svg
[rank3]:2025-12-01 00:46:07,286 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0046_real_step200_rank3.svg
[rank3]:			> Batch Time: 520.34 ms, GPU Bubble Ratio: 64.90%, 52.03%, 61.41%, 34.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-10-39ms     | [S0,MB0,B]  113-5-118ms    | [S0,MB4,F]  118-8-127ms    | [S0,MB1,B]  180-5-186ms    | [S0,MB5,F]  186-6-193ms    | [S0,MB2,B]  251-5-256ms    | [S0,MB6,F]  257-6-263ms    | [S0,MB3,B]  315-5-320ms    | [S0,MB7,F]  320-6-327ms    | [S0,MB4,B]  365-26-391ms   | [S0,MB5,B]  413-25-438ms   | [S0,MB6,B]  460-20-480ms   | [S0,MB7,B]  501-19-520ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  94-13-108ms    | [S1,MB3,F]  111-11-123ms   | [S1,MB1,B]  162-13-175ms   | [S1,MB4,F]  179-9-188ms    | [S1,MB2,B]  233-13-246ms   | [S1,MB5,F]  250-9-259ms    | [S1,MB3,B]  284-25-310ms   | [S1,MB6,F]  313-9-323ms    | [S1,MB4,B]  333-26-359ms   | [S1,MB7,F]  363-9-373ms    | [S1,MB5,B]  383-26-409ms   | [S1,MB6,B]  430-26-456ms   | [S1,MB7,B]  474-22-497ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  80-9-89ms      | [S2,MB2,F]  93-9-102ms     | [S2,MB1,B]  147-9-157ms    | [S2,MB3,F]  160-7-167ms    | [S2,MB2,B]  207-20-227ms   | [S2,MB4,F]  231-7-238ms    | [S2,MB3,B]  259-20-279ms   | [S2,MB5,F]  283-7-290ms    | [S2,MB4,B]  308-20-329ms   | [S2,MB6,F]  332-7-339ms    | [S2,MB5,B]  358-20-378ms   | [S2,MB7,F]  382-7-389ms    | [S2,MB6,B]  407-20-427ms   | [S2,MB7,B]  454-17-471ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-23-75ms     | [S3,MB1,F]  78-14-93ms     | [S3,MB1,B]  100-42-142ms   | [S3,MB2,F]  146-11-157ms   | [S3,MB2,B]  164-37-202ms   | [S3,MB3,F]  206-17-223ms   | [S3,MB3,B]  231-23-254ms   | [S3,MB4,F]  257-15-273ms   | [S3,MB4,B]  280-22-303ms   | [S3,MB5,F]  307-15-322ms   | [S3,MB5,B]  329-23-353ms   | [S3,MB6,F]  356-15-372ms   | [S3,MB6,B]  379-22-402ms   | [S3,MB7,F]  405-15-420ms   | [S3,MB7,B]  427-22-450ms  
[rank3]:2025-12-01 00:46:07,330 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0046_stage3_step200.svg
[rank2]:2025-12-01 00:47:51,218 - INFO - Avg. fwd time: 7.7602 / Avg. bwd time: 18.1718 / Avg. batch time: 503.4729 (ms) / GPU bubble ratio: 58.79%
[rank3]:2025-12-01 00:47:51,193 - INFO - Avg. fwd time: 14.2019 / Avg. bwd time: 34.4864 / Avg. batch time: 472.1540 (ms) / GPU bubble ratio: 17.50%
[rank0]:2025-12-01 00:47:51,272 - INFO - Avg. fwd time: 8.2334 / Avg. bwd time: 18.9412 / Avg. batch time: 575.9582 (ms) / GPU bubble ratio: 62.25%
[rank1]:2025-12-01 00:47:51,247 - INFO - Avg. fwd time: 10.0574 / Avg. bwd time: 22.2977 / Avg. batch time: 541.5972 (ms) / GPU bubble ratio: 52.21%
[rank0]:2025-12-01 00:49:30,935 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 00:49:34,984 - INFO - Avg. fwd time: 7.7778 / Avg. bwd time: 18.0682 / Avg. batch time: 496.3455 (ms) / GPU bubble ratio: 58.34%
[rank2]:2025-12-01 00:49:34,991 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-01 00:49:34,960 - INFO - Avg. fwd time: 14.2900 / Avg. bwd time: 33.5344 / Avg. batch time: 465.1880 (ms) / GPU bubble ratio: 17.75%
[rank3]:2025-12-01 00:49:34,965 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-01 00:49:35,013 - INFO - Avg. fwd time: 10.0892 / Avg. bwd time: 22.0836 / Avg. batch time: 534.3790 (ms) / GPU bubble ratio: 51.84%
[rank1]:2025-12-01 00:49:35,020 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 00:49:35,061 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.3187  memory:  6.51GiB(13.70%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank3]:2025-12-01 00:49:35,054 - INFO -  step: 250  loss:  1.1926  grad_norm:  0.3187  memory: 17.37GiB(36.56%)  tps: 7,880  tflops: 61.61  mfu: 19.75%
[rank0]:2025-12-01 00:49:35,039 - INFO - Avg. fwd time: 8.2749 / Avg. bwd time: 18.1857 / Avg. batch time: 568.4998 (ms) / GPU bubble ratio: 62.76%
[rank0]:2025-12-01 00:49:35,047 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.53)/0.53, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 00:49:35,075 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.3187  memory: 13.29GiB(27.97%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank1]:2025-12-01 00:49:35,064 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.3187  memory:  9.36GiB(19.71%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank3]:2025-12-01 00:51:20,835 - INFO - Avg. fwd time: 14.3500 / Avg. bwd time: 32.8886 / Avg. batch time: 460.4573 (ms) / GPU bubble ratio: 17.93%
[rank1]:2025-12-01 00:51:20,889 - INFO - Avg. fwd time: 10.1148 / Avg. bwd time: 21.9080 / Avg. batch time: 529.4431 (ms) / GPU bubble ratio: 51.61%
[rank2]:2025-12-01 00:51:20,860 - INFO - Avg. fwd time: 7.7920 / Avg. bwd time: 17.9842 / Avg. batch time: 491.4837 (ms) / GPU bubble ratio: 58.04%
[rank0]:2025-12-01 00:51:20,915 - INFO - Avg. fwd time: 8.3078 / Avg. bwd time: 17.5829 / Avg. batch time: 563.3629 (ms) / GPU bubble ratio: 63.23%
[rank0]:2025-12-01 00:53:02,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 00:53:06,861 - INFO - Avg. fwd time: 7.8043 / Avg. bwd time: 17.9163 / Avg. batch time: 487.4862 (ms) / GPU bubble ratio: 57.79%
[rank2]:2025-12-01 00:53:06,867 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-01 00:53:06,836 - INFO - Avg. fwd time: 14.4011 / Avg. bwd time: 32.3550 / Avg. batch time: 456.5655 (ms) / GPU bubble ratio: 18.07%
[rank3]:2025-12-01 00:53:06,841 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 00:53:06,917 - INFO - Avg. fwd time: 8.3359 / Avg. bwd time: 17.0801 / Avg. batch time: 559.1389 (ms) / GPU bubble ratio: 63.64%
[rank0]:2025-12-01 00:53:06,924 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.53)/0.53, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-01 00:53:06,891 - INFO - Avg. fwd time: 10.1366 / Avg. bwd time: 21.7624 / Avg. batch time: 525.3845 (ms) / GPU bubble ratio: 51.43%
[rank1]:2025-12-01 00:53:06,897 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 00:53:06,938 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4858  memory:  6.51GiB(13.70%)  tps: 7,733  tflops: 60.45  mfu: 19.38%
[rank3]:2025-12-01 00:53:06,948 - INFO -  step: 300  loss:  0.5523  grad_norm:  0.4858  memory: 17.37GiB(36.56%)  tps: 7,732  tflops: 60.45  mfu: 19.37%
[rank0]:2025-12-01 00:53:06,953 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4858  memory: 13.29GiB(27.97%)  tps: 7,733  tflops: 60.45  mfu: 19.38%
[rank0]:2025-12-01 00:53:07,001 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0053_stage0_step300.svg
[rank1]:2025-12-01 00:53:06,942 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4858  memory:  9.36GiB(19.71%)  tps: 7,733  tflops: 60.45  mfu: 19.38%
[rank1]:2025-12-01 00:53:07,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0053_stage1_step300.svg
[rank2]:2025-12-01 00:53:07,003 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0053_stage2_step300.svg
[rank3]:2025-12-01 00:53:07,094 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0053_real_step300_rank3.svg
[rank3]:			> Batch Time: 517.06 ms, GPU Bubble Ratio: 68.91%, 52.72%, 61.11%, 35.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB5,F]  177-6-184ms    | [S0,MB2,B]  248-0-248ms    | [S0,MB6,F]  248-6-254ms    | [S0,MB3,B]  313-0-313ms    | [S0,MB7,F]  313-6-320ms    | [S0,MB4,B]  363-26-389ms   | [S0,MB5,B]  410-25-436ms   | [S0,MB6,B]  456-20-477ms   | [S0,MB7,B]  498-19-517ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  160-11-172ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  231-11-242ms   | [S1,MB5,F]  246-9-255ms    | [S1,MB3,B]  282-25-308ms   | [S1,MB6,F]  311-9-321ms    | [S1,MB4,B]  331-26-357ms   | [S1,MB7,F]  361-9-370ms    | [S1,MB5,B]  380-26-406ms   | [S1,MB6,B]  427-26-453ms   | [S1,MB7,B]  472-22-494ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-155ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  205-20-226ms   | [S2,MB4,F]  229-7-236ms    | [S2,MB3,B]  257-20-277ms   | [S2,MB5,F]  280-7-288ms    | [S2,MB4,B]  306-20-326ms   | [S2,MB6,F]  330-7-337ms    | [S2,MB5,B]  355-20-375ms   | [S2,MB7,F]  378-7-386ms    | [S2,MB6,B]  403-20-423ms   | [S2,MB7,B]  451-17-469ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-42-141ms    | [S3,MB2,F]  144-11-156ms   | [S3,MB2,B]  163-37-200ms   | [S3,MB3,F]  204-17-221ms   | [S3,MB3,B]  228-23-252ms   | [S3,MB4,F]  255-15-271ms   | [S3,MB4,B]  278-22-301ms   | [S3,MB5,F]  304-15-320ms   | [S3,MB5,B]  327-22-350ms   | [S3,MB6,F]  353-15-369ms   | [S3,MB6,B]  375-22-398ms   | [S3,MB7,F]  402-15-417ms   | [S3,MB7,B]  424-22-447ms  
[rank3]:2025-12-01 00:53:07,137 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0053_stage3_step300.svg
[rank3]:2025-12-01 00:54:53,723 - INFO - Avg. fwd time: 14.4434 / Avg. bwd time: 31.9392 / Avg. batch time: 453.5540 (ms) / GPU bubble ratio: 18.19%
[rank2]:2025-12-01 00:54:53,749 - INFO - Avg. fwd time: 7.8148 / Avg. bwd time: 17.8586 / Avg. batch time: 484.4237 (ms) / GPU bubble ratio: 57.60%
[rank0]:2025-12-01 00:54:53,805 - INFO - Avg. fwd time: 8.3594 / Avg. bwd time: 16.6372 / Avg. batch time: 555.8843 (ms) / GPU bubble ratio: 64.03%
[rank1]:2025-12-01 00:54:53,779 - INFO - Avg. fwd time: 10.1554 / Avg. bwd time: 21.6398 / Avg. batch time: 522.2712 (ms) / GPU bubble ratio: 51.30%
[rank0]:2025-12-01 00:56:35,023 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 00:56:39,253 - INFO - Avg. fwd time: 7.8240 / Avg. bwd time: 17.8099 / Avg. batch time: 481.2959 (ms) / GPU bubble ratio: 57.39%
[rank3]:2025-12-01 00:56:39,227 - INFO - Avg. fwd time: 14.4877 / Avg. bwd time: 31.5167 / Avg. batch time: 450.5045 (ms) / GPU bubble ratio: 18.31%
[rank0]:2025-12-01 00:56:39,309 - INFO - Avg. fwd time: 8.3804 / Avg. bwd time: 16.2603 / Avg. batch time: 552.5991 (ms) / GPU bubble ratio: 64.33%
[rank1]:2025-12-01 00:56:39,283 - INFO - Avg. fwd time: 10.1725 / Avg. bwd time: 21.5361 / Avg. batch time: 519.1028 (ms) / GPU bubble ratio: 51.13%
[rank2]:2025-12-01 00:56:39,331 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.3678  memory:  6.51GiB(13.70%)  tps: 7,714  tflops: 60.30  mfu: 19.33%
[rank3]:2025-12-01 00:56:39,337 - INFO -  step: 350  loss:  0.3318  grad_norm:  0.3678  memory: 17.37GiB(36.56%)  tps: 7,714  tflops: 60.31  mfu: 19.33%
[rank0]:2025-12-01 00:56:39,345 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.3678  memory: 13.29GiB(27.97%)  tps: 7,714  tflops: 60.30  mfu: 19.33%
[rank1]:2025-12-01 00:56:39,335 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.3678  memory:  9.36GiB(19.71%)  tps: 7,714  tflops: 60.30  mfu: 19.33%
[rank3]:2025-12-01 00:58:24,105 - INFO - Avg. fwd time: 14.5294 / Avg. bwd time: 31.1195 / Avg. batch time: 447.6405 (ms) / GPU bubble ratio: 18.42%
[rank1]:2025-12-01 00:58:24,161 - INFO - Avg. fwd time: 10.1877 / Avg. bwd time: 21.4473 / Avg. batch time: 516.1405 (ms) / GPU bubble ratio: 50.97%
[rank2]:2025-12-01 00:58:24,131 - INFO - Avg. fwd time: 7.8322 / Avg. bwd time: 17.7684 / Avg. batch time: 478.3661 (ms) / GPU bubble ratio: 57.19%
[rank0]:2025-12-01 00:58:24,188 - INFO - Avg. fwd time: 8.3989 / Avg. bwd time: 15.9472 / Avg. batch time: 549.5392 (ms) / GPU bubble ratio: 64.56%
[rank0]:2025-12-01 01:00:04,593 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 01:00:08,819 - INFO - Avg. fwd time: 14.5636 / Avg. bwd time: 30.7712 / Avg. batch time: 445.1108 (ms) / GPU bubble ratio: 18.52%
[rank2]:2025-12-01 01:00:08,845 - INFO - Avg. fwd time: 7.8394 / Avg. bwd time: 17.7312 / Avg. batch time: 475.7777 (ms) / GPU bubble ratio: 57.00%
[rank1]:2025-12-01 01:00:08,876 - INFO - Avg. fwd time: 10.2005 / Avg. bwd time: 21.3675 / Avg. batch time: 513.5204 (ms) / GPU bubble ratio: 50.82%
[rank0]:2025-12-01 01:00:08,903 - INFO - Avg. fwd time: 8.4143 / Avg. bwd time: 15.6600 / Avg. batch time: 546.8283 (ms) / GPU bubble ratio: 64.78%
[rank0]:2025-12-01 01:00:08,939 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1117  memory: 13.29GiB(27.97%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank3]:2025-12-01 01:00:08,934 - INFO -  step: 400  loss:  0.2897  grad_norm:  0.1117  memory: 17.37GiB(36.56%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank2]:2025-12-01 01:00:08,925 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1117  memory:  6.51GiB(13.70%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank2]:2025-12-01 01:00:08,993 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0100_stage2_step400.svg
[rank1]:2025-12-01 01:00:08,929 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1117  memory:  9.36GiB(19.71%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank1]:2025-12-01 01:00:08,992 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0100_stage1_step400.svg
[rank0]:2025-12-01 01:00:08,991 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0100_stage0_step400.svg
[rank3]:2025-12-01 01:00:09,077 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0100_real_step400_rank3.svg
[rank3]:			> Batch Time: 515.84 ms, GPU Bubble Ratio: 68.91%, 52.71%, 61.05%, 34.99%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB5,F]  177-6-184ms    | [S0,MB2,B]  248-0-248ms    | [S0,MB6,F]  248-6-255ms    | [S0,MB3,B]  313-0-313ms    | [S0,MB7,F]  313-6-319ms    | [S0,MB4,B]  362-26-388ms   | [S0,MB5,B]  409-25-435ms   | [S0,MB6,B]  456-20-476ms   | [S0,MB7,B]  496-19-515ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  160-11-172ms   | [S1,MB4,F]  175-8-184ms    | [S1,MB2,B]  231-11-242ms   | [S1,MB5,F]  246-8-255ms    | [S1,MB3,B]  282-25-308ms   | [S1,MB6,F]  311-9-320ms    | [S1,MB4,B]  331-26-357ms   | [S1,MB7,F]  361-9-370ms    | [S1,MB5,B]  380-26-406ms   | [S1,MB6,B]  427-26-453ms   | [S1,MB7,B]  471-22-493ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-155ms    | [S2,MB3,F]  158-7-166ms    | [S2,MB2,B]  205-20-226ms   | [S2,MB4,F]  229-7-236ms    | [S2,MB3,B]  256-20-276ms   | [S2,MB5,F]  280-7-288ms    | [S2,MB4,B]  306-20-326ms   | [S2,MB6,F]  330-7-337ms    | [S2,MB5,B]  355-20-375ms   | [S2,MB7,F]  378-7-386ms    | [S2,MB6,B]  403-20-423ms   | [S2,MB7,B]  450-17-467ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-42-140ms    | [S3,MB2,F]  144-11-155ms   | [S3,MB2,B]  162-37-200ms   | [S3,MB3,F]  204-17-221ms   | [S3,MB3,B]  228-23-252ms   | [S3,MB4,F]  255-15-270ms   | [S3,MB4,B]  278-22-301ms   | [S3,MB5,F]  304-15-320ms   | [S3,MB5,B]  327-22-350ms   | [S3,MB6,F]  353-15-369ms   | [S3,MB6,B]  376-22-398ms   | [S3,MB7,F]  402-15-417ms   | [S3,MB7,B]  424-22-447ms  
[rank3]:2025-12-01 01:00:09,123 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0100_stage3_step400.svg
[rank3]:2025-12-01 01:00:33,369 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-01 01:00:33,494 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-01 01:00:33,520 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-01 01:00:33,541 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-01 01:01:54,893 - INFO - Avg. fwd time: 14.5870 / Avg. bwd time: 30.5162 / Avg. batch time: 443.2432 (ms) / GPU bubble ratio: 18.59%
[rank2]:2025-12-01 01:01:54,919 - INFO - Avg. fwd time: 7.8451 / Avg. bwd time: 17.6971 / Avg. batch time: 473.8843 (ms) / GPU bubble ratio: 56.88%
[rank1]:2025-12-01 01:01:54,950 - INFO - Avg. fwd time: 10.2106 / Avg. bwd time: 21.2948 / Avg. batch time: 511.5966 (ms) / GPU bubble ratio: 50.73%
[rank0]:2025-12-01 01:01:54,978 - INFO - Avg. fwd time: 8.4282 / Avg. bwd time: 15.4176 / Avg. batch time: 544.8268 (ms) / GPU bubble ratio: 64.99%
[rank0]:2025-12-01 01:03:35,320 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 01:03:39,498 - INFO - Avg. fwd time: 14.6123 / Avg. bwd time: 30.2371 / Avg. batch time: 441.1964 (ms) / GPU bubble ratio: 18.68%
[rank2]:2025-12-01 01:03:39,525 - INFO - Avg. fwd time: 7.8501 / Avg. bwd time: 17.6677 / Avg. batch time: 471.7890 (ms) / GPU bubble ratio: 56.73%
[rank1]:2025-12-01 01:03:39,556 - INFO - Avg. fwd time: 10.2200 / Avg. bwd time: 21.2323 / Avg. batch time: 509.4781 (ms) / GPU bubble ratio: 50.61%
[rank0]:2025-12-01 01:03:39,584 - INFO - Avg. fwd time: 8.4424 / Avg. bwd time: 15.1901 / Avg. batch time: 542.6585 (ms) / GPU bubble ratio: 65.16%
[rank0]:2025-12-01 01:03:39,620 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1404  memory: 13.29GiB(27.97%)  tps: 7,777  tflops: 60.79  mfu: 19.49%
[rank3]:2025-12-01 01:03:39,614 - INFO -  step: 450  loss:  0.2758  grad_norm:  0.1404  memory: 17.37GiB(36.56%)  tps: 7,777  tflops: 60.80  mfu: 19.49%
[rank2]:2025-12-01 01:03:39,606 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1404  memory:  6.51GiB(13.70%)  tps: 7,777  tflops: 60.79  mfu: 19.49%
[rank1]:2025-12-01 01:03:39,609 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1404  memory:  9.36GiB(19.71%)  tps: 7,777  tflops: 60.79  mfu: 19.49%
[rank3]:2025-12-01 01:05:23,436 - INFO - Avg. fwd time: 14.6388 / Avg. bwd time: 29.9622 / Avg. batch time: 439.1928 (ms) / GPU bubble ratio: 18.76%
[rank2]:2025-12-01 01:05:23,463 - INFO - Avg. fwd time: 7.8549 / Avg. bwd time: 17.6423 / Avg. batch time: 469.7416 (ms) / GPU bubble ratio: 56.58%
[rank1]:2025-12-01 01:05:23,494 - INFO - Avg. fwd time: 10.2292 / Avg. bwd time: 21.1777 / Avg. batch time: 507.4120 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-12-01 01:05:23,523 - INFO - Avg. fwd time: 8.4535 / Avg. bwd time: 14.9890 / Avg. batch time: 540.5339 (ms) / GPU bubble ratio: 65.30%
[rank0]:2025-12-01 01:07:06,179 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 01:07:10,363 - INFO - Avg. fwd time: 14.6552 / Avg. bwd time: 29.8150 / Avg. batch time: 438.1398 (ms) / GPU bubble ratio: 18.80%
[rank2]:2025-12-01 01:07:10,390 - INFO - Avg. fwd time: 7.8593 / Avg. bwd time: 17.6187 / Avg. batch time: 468.6495 (ms) / GPU bubble ratio: 56.51%
[rank1]:2025-12-01 01:07:10,422 - INFO - Avg. fwd time: 10.2371 / Avg. bwd time: 21.1269 / Avg. batch time: 506.3002 (ms) / GPU bubble ratio: 50.44%
[rank1]:2025-12-01 01:07:10,476 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1489  memory:  9.36GiB(19.71%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank0]:2025-12-01 01:07:10,451 - INFO - Avg. fwd time: 8.4633 / Avg. bwd time: 14.8084 / Avg. batch time: 539.3657 (ms) / GPU bubble ratio: 65.48%
[rank0]:2025-12-01 01:07:10,486 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1489  memory: 13.29GiB(27.97%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank3]:2025-12-01 01:07:10,482 - INFO -  step: 500  loss:  0.2571  grad_norm:  0.1489  memory: 17.37GiB(36.56%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank2]:2025-12-01 01:07:10,472 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1489  memory:  6.51GiB(13.70%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank2]:2025-12-01 01:07:10,536 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0107_stage2_step500.svg
[rank1]:2025-12-01 01:07:10,534 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0107_stage1_step500.svg
[rank0]:2025-12-01 01:07:10,534 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0107_stage0_step500.svg
[rank3]:2025-12-01 01:07:10,627 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0107_real_step500_rank3.svg
[rank3]:			> Batch Time: 517.86 ms, GPU Bubble Ratio: 68.88%, 52.77%, 61.17%, 34.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-184ms    | [S0,MB2,B]  248-0-248ms    | [S0,MB6,F]  248-6-255ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-320ms    | [S0,MB4,B]  363-26-389ms   | [S0,MB5,B]  411-25-436ms   | [S0,MB6,B]  458-20-478ms   | [S0,MB7,B]  498-19-517ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  160-11-172ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  231-11-242ms   | [S1,MB5,F]  246-9-255ms    | [S1,MB3,B]  283-25-308ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  332-25-358ms   | [S1,MB7,F]  361-9-371ms    | [S1,MB5,B]  381-26-407ms   | [S1,MB6,B]  428-25-454ms   | [S1,MB7,B]  473-22-495ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-155ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  205-20-226ms   | [S2,MB4,F]  229-7-236ms    | [S2,MB3,B]  257-20-277ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  307-20-327ms   | [S2,MB6,F]  330-7-338ms    | [S2,MB5,B]  355-20-376ms   | [S2,MB7,F]  379-7-387ms    | [S2,MB6,B]  404-20-425ms   | [S2,MB7,B]  452-17-469ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-42-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-37-200ms   | [S3,MB3,F]  204-17-221ms   | [S3,MB3,B]  229-23-252ms   | [S3,MB4,F]  256-15-271ms   | [S3,MB4,B]  278-22-301ms   | [S3,MB5,F]  305-15-321ms   | [S3,MB5,B]  327-22-350ms   | [S3,MB6,F]  354-15-369ms   | [S3,MB6,B]  376-22-399ms   | [S3,MB7,F]  403-15-418ms   | [S3,MB7,B]  425-22-448ms  
[rank3]:2025-12-01 01:07:10,669 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0107_stage3_step500.svg
[rank3]:2025-12-01 01:08:56,761 - INFO - Avg. fwd time: 14.6740 / Avg. bwd time: 29.6589 / Avg. batch time: 437.0355 (ms) / GPU bubble ratio: 18.85%
[rank2]:2025-12-01 01:08:56,788 - INFO - Avg. fwd time: 7.8634 / Avg. bwd time: 17.5975 / Avg. batch time: 467.5353 (ms) / GPU bubble ratio: 56.43%
[rank1]:2025-12-01 01:08:56,820 - INFO - Avg. fwd time: 10.2446 / Avg. bwd time: 21.0813 / Avg. batch time: 505.1702 (ms) / GPU bubble ratio: 50.39%
[rank0]:2025-12-01 01:08:56,849 - INFO - Avg. fwd time: 8.4721 / Avg. bwd time: 14.6622 / Avg. batch time: 538.1824 (ms) / GPU bubble ratio: 65.61%
[rank0]:2025-12-01 01:10:38,769 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 01:10:43,021 - INFO - Avg. fwd time: 7.8671 / Avg. bwd time: 17.5780 / Avg. batch time: 466.4887 (ms) / GPU bubble ratio: 56.36%
[rank3]:2025-12-01 01:10:42,993 - INFO - Avg. fwd time: 14.6905 / Avg. bwd time: 29.5164 / Avg. batch time: 436.0213 (ms) / GPU bubble ratio: 18.89%
[rank1]:2025-12-01 01:10:43,053 - INFO - Avg. fwd time: 10.2515 / Avg. bwd time: 21.0397 / Avg. batch time: 504.1095 (ms) / GPU bubble ratio: 50.34%
[rank0]:2025-12-01 01:10:43,082 - INFO - Avg. fwd time: 8.4799 / Avg. bwd time: 14.5210 / Avg. batch time: 537.0730 (ms) / GPU bubble ratio: 65.74%
[rank2]:2025-12-01 01:10:43,104 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0811  memory:  6.51GiB(13.70%)  tps: 7,705  tflops: 60.24  mfu: 19.31%
[rank3]:2025-12-01 01:10:43,113 - INFO -  step: 550  loss:  0.2505  grad_norm:  0.0811  memory: 17.37GiB(36.56%)  tps: 7,705  tflops: 60.24  mfu: 19.31%
[rank1]:2025-12-01 01:10:43,108 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0811  memory:  9.36GiB(19.71%)  tps: 7,705  tflops: 60.24  mfu: 19.31%
[rank0]:2025-12-01 01:10:43,118 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0811  memory: 13.29GiB(27.97%)  tps: 7,705  tflops: 60.24  mfu: 19.31%
[rank3]:2025-12-01 01:12:27,844 - INFO - Avg. fwd time: 14.7091 / Avg. bwd time: 29.3439 / Avg. batch time: 434.7832 (ms) / GPU bubble ratio: 18.94%
[rank1]:2025-12-01 01:12:27,906 - INFO - Avg. fwd time: 10.2582 / Avg. bwd time: 21.0032 / Avg. batch time: 502.8321 (ms) / GPU bubble ratio: 50.26%
[rank2]:2025-12-01 01:12:27,873 - INFO - Avg. fwd time: 7.8707 / Avg. bwd time: 17.5609 / Avg. batch time: 465.2207 (ms) / GPU bubble ratio: 56.27%
[rank0]:2025-12-01 01:12:27,935 - INFO - Avg. fwd time: 8.4871 / Avg. bwd time: 14.3835 / Avg. batch time: 535.7519 (ms) / GPU bubble ratio: 65.85%
[rank0]:2025-12-01 01:14:06,988 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 01:14:11,081 - INFO - Avg. fwd time: 14.7280 / Avg. bwd time: 29.1431 / Avg. batch time: 433.3167 (ms) / GPU bubble ratio: 19.00%
[rank1]:2025-12-01 01:14:11,142 - INFO - Avg. fwd time: 10.2643 / Avg. bwd time: 20.9702 / Avg. batch time: 501.3301 (ms) / GPU bubble ratio: 50.16%
[rank2]:2025-12-01 01:14:11,110 - INFO - Avg. fwd time: 7.8740 / Avg. bwd time: 17.5450 / Avg. batch time: 463.7269 (ms) / GPU bubble ratio: 56.15%
[rank2]:2025-12-01 01:14:11,194 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0900  memory:  6.51GiB(13.70%)  tps: 7,874  tflops: 61.55  mfu: 19.73%
[rank3]:2025-12-01 01:14:11,188 - INFO -  step: 600  loss:  0.2481  grad_norm:  0.0900  memory: 17.37GiB(36.56%)  tps: 7,874  tflops: 61.56  mfu: 19.73%
[rank1]:2025-12-01 01:14:11,197 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0900  memory:  9.36GiB(19.71%)  tps: 7,874  tflops: 61.55  mfu: 19.73%
[rank0]:2025-12-01 01:14:11,172 - INFO - Avg. fwd time: 8.4933 / Avg. bwd time: 14.2575 / Avg. batch time: 534.2077 (ms) / GPU bubble ratio: 65.93%
[rank0]:2025-12-01 01:14:11,208 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0900  memory: 13.29GiB(27.97%)  tps: 7,874  tflops: 61.55  mfu: 19.73%
[rank0]:2025-12-01 01:14:11,257 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0114_stage0_step600.svg
[rank2]:2025-12-01 01:14:11,257 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0114_stage2_step600.svg
[rank1]:2025-12-01 01:14:11,258 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0114_stage1_step600.svg
[rank3]:2025-12-01 01:14:11,343 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0114_real_step600_rank3.svg
[rank3]:			> Batch Time: 497.08 ms, GPU Bubble Ratio: 67.65%, 50.75%, 59.54%, 36.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  173-0-173ms    | [S0,MB5,F]  173-6-179ms    | [S0,MB2,B]  233-0-233ms    | [S0,MB6,F]  233-6-240ms    | [S0,MB3,B]  295-0-295ms    | [S0,MB7,F]  295-6-302ms    | [S0,MB4,B]  344-26-370ms   | [S0,MB5,B]  392-25-417ms   | [S0,MB6,B]  437-20-458ms   | [S0,MB7,B]  478-19-497ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  156-11-167ms   | [S1,MB4,F]  171-9-180ms    | [S1,MB2,B]  216-11-228ms   | [S1,MB5,F]  231-9-240ms    | [S1,MB3,B]  264-25-290ms   | [S1,MB6,F]  293-9-303ms    | [S1,MB4,B]  313-26-339ms   | [S1,MB7,F]  342-9-352ms    | [S1,MB5,B]  362-26-388ms   | [S1,MB6,B]  408-26-434ms   | [S1,MB7,B]  452-22-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  141-9-151ms    | [S2,MB3,F]  154-7-161ms    | [S2,MB2,B]  190-20-211ms   | [S2,MB4,F]  214-7-221ms    | [S2,MB3,B]  239-20-259ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  288-20-308ms   | [S2,MB6,F]  311-7-319ms    | [S2,MB5,B]  336-20-356ms   | [S2,MB7,F]  360-7-367ms    | [S2,MB6,B]  385-20-405ms   | [S2,MB7,B]  431-17-449ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-38-136ms    | [S3,MB2,F]  140-15-155ms   | [S3,MB2,B]  163-22-185ms   | [S3,MB3,F]  189-15-204ms   | [S3,MB3,B]  211-22-234ms   | [S3,MB4,F]  238-15-253ms   | [S3,MB4,B]  260-22-282ms   | [S3,MB5,F]  286-15-301ms   | [S3,MB5,B]  308-22-331ms   | [S3,MB6,F]  335-15-350ms   | [S3,MB6,B]  357-22-379ms   | [S3,MB7,F]  383-15-398ms   | [S3,MB7,B]  405-22-428ms  
[rank3]:2025-12-01 01:14:11,387 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0114_stage3_step600.svg
[rank3]:2025-12-01 01:15:55,803 - INFO - Avg. fwd time: 14.7402 / Avg. bwd time: 28.9957 / Avg. batch time: 432.2252 (ms) / GPU bubble ratio: 19.05%
[rank1]:2025-12-01 01:15:55,865 - INFO - Avg. fwd time: 10.2693 / Avg. bwd time: 20.9383 / Avg. batch time: 500.2213 (ms) / GPU bubble ratio: 50.09%
[rank2]:2025-12-01 01:15:55,832 - INFO - Avg. fwd time: 7.8767 / Avg. bwd time: 17.5297 / Avg. batch time: 462.6286 (ms) / GPU bubble ratio: 56.07%
[rank0]:2025-12-01 01:15:55,895 - INFO - Avg. fwd time: 8.4993 / Avg. bwd time: 14.1417 / Avg. batch time: 533.0647 (ms) / GPU bubble ratio: 66.02%
[rank0]:2025-12-01 01:17:35,113 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 01:17:39,152 - INFO - Avg. fwd time: 14.7557 / Avg. bwd time: 28.8238 / Avg. batch time: 430.9630 (ms) / GPU bubble ratio: 19.10%
[rank1]:2025-12-01 01:17:39,214 - INFO - Avg. fwd time: 10.2741 / Avg. bwd time: 20.9103 / Avg. batch time: 498.9259 (ms) / GPU bubble ratio: 50.00%
[rank2]:2025-12-01 01:17:39,181 - INFO - Avg. fwd time: 7.8795 / Avg. bwd time: 17.5161 / Avg. batch time: 461.3421 (ms) / GPU bubble ratio: 55.96%
[rank0]:2025-12-01 01:17:39,245 - INFO - Avg. fwd time: 8.5062 / Avg. bwd time: 14.0346 / Avg. batch time: 531.7477 (ms) / GPU bubble ratio: 66.09%
[rank3]:2025-12-01 01:17:39,261 - INFO -  step: 650  loss:  0.2525  grad_norm:  0.0786  memory: 17.37GiB(36.56%)  tps: 7,874  tflops: 61.56  mfu: 19.73%
[rank1]:2025-12-01 01:17:39,270 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0786  memory:  9.36GiB(19.71%)  tps: 7,874  tflops: 61.56  mfu: 19.73%
[rank2]:2025-12-01 01:17:39,266 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0786  memory:  6.51GiB(13.70%)  tps: 7,874  tflops: 61.56  mfu: 19.73%
[rank0]:2025-12-01 01:17:39,281 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0786  memory: 13.29GiB(27.97%)  tps: 7,874  tflops: 61.56  mfu: 19.73%
[rank3]:2025-12-01 01:19:24,635 - INFO - Avg. fwd time: 14.7668 / Avg. bwd time: 28.7197 / Avg. batch time: 430.2126 (ms) / GPU bubble ratio: 19.13%
[rank2]:2025-12-01 01:19:24,665 - INFO - Avg. fwd time: 7.8821 / Avg. bwd time: 17.5034 / Avg. batch time: 460.5696 (ms) / GPU bubble ratio: 55.91%
[rank1]:2025-12-01 01:19:24,699 - INFO - Avg. fwd time: 10.2785 / Avg. bwd time: 20.8833 / Avg. batch time: 498.1464 (ms) / GPU bubble ratio: 49.96%
[rank0]:2025-12-01 01:19:24,730 - INFO - Avg. fwd time: 8.5112 / Avg. bwd time: 13.9346 / Avg. batch time: 530.9364 (ms) / GPU bubble ratio: 66.18%
[rank0]:2025-12-01 01:21:05,842 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 01:21:10,011 - INFO - Avg. fwd time: 14.7771 / Avg. bwd time: 28.6222 / Avg. batch time: 429.5108 (ms) / GPU bubble ratio: 19.17%
[rank1]:2025-12-01 01:21:10,074 - INFO - Avg. fwd time: 10.2824 / Avg. bwd time: 20.8580 / Avg. batch time: 497.4153 (ms) / GPU bubble ratio: 49.92%
[rank2]:2025-12-01 01:21:10,040 - INFO - Avg. fwd time: 7.8844 / Avg. bwd time: 17.4916 / Avg. batch time: 459.8468 (ms) / GPU bubble ratio: 55.85%
[rank0]:2025-12-01 01:21:10,105 - INFO - Avg. fwd time: 8.5156 / Avg. bwd time: 13.8482 / Avg. batch time: 530.1729 (ms) / GPU bubble ratio: 66.25%
[rank0]:2025-12-01 01:21:10,141 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1365  memory: 13.29GiB(27.97%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank3]:2025-12-01 01:21:10,135 - INFO -  step: 700  loss:  0.2146  grad_norm:  0.1365  memory: 17.37GiB(36.56%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank1]:2025-12-01 01:21:10,131 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1365  memory:  9.36GiB(19.71%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank1]:2025-12-01 01:21:10,192 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0121_stage1_step700.svg
[rank2]:2025-12-01 01:21:10,127 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1365  memory:  6.51GiB(13.70%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank2]:2025-12-01 01:21:10,192 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0121_stage2_step700.svg
[rank0]:2025-12-01 01:21:10,191 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0121_stage0_step700.svg
[rank3]:2025-12-01 01:21:10,275 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0121_real_step700_rank3.svg
[rank3]:			> Batch Time: 516.53 ms, GPU Bubble Ratio: 68.25%, 52.60%, 61.04%, 35.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB5,F]  177-6-184ms    | [S0,MB2,B]  247-0-247ms    | [S0,MB6,F]  247-6-254ms    | [S0,MB3,B]  312-0-312ms    | [S0,MB7,F]  312-6-319ms    | [S0,MB4,B]  362-26-388ms   | [S0,MB5,B]  410-25-435ms   | [S0,MB6,B]  457-23-480ms   | [S0,MB7,B]  497-19-516ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  160-11-172ms   | [S1,MB4,F]  175-9-184ms    | [S1,MB2,B]  230-11-242ms   | [S1,MB5,F]  245-9-255ms    | [S1,MB3,B]  281-25-307ms   | [S1,MB6,F]  311-9-320ms    | [S1,MB4,B]  331-26-357ms   | [S1,MB7,F]  361-9-370ms    | [S1,MB5,B]  380-26-406ms   | [S1,MB6,B]  427-26-453ms   | [S1,MB7,B]  471-22-493ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  145-9-155ms    | [S2,MB3,F]  158-7-165ms    | [S2,MB2,B]  205-20-225ms   | [S2,MB4,F]  229-7-236ms    | [S2,MB3,B]  256-20-276ms   | [S2,MB5,F]  280-7-287ms    | [S2,MB4,B]  306-20-326ms   | [S2,MB6,F]  329-7-337ms    | [S2,MB5,B]  354-20-375ms   | [S2,MB7,F]  378-7-386ms    | [S2,MB6,B]  403-20-423ms   | [S2,MB7,B]  451-17-468ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-42-140ms    | [S3,MB2,F]  144-11-155ms   | [S3,MB2,B]  162-37-200ms   | [S3,MB3,F]  203-17-221ms   | [S3,MB3,B]  228-23-251ms   | [S3,MB4,F]  255-15-270ms   | [S3,MB4,B]  277-22-300ms   | [S3,MB5,F]  304-15-319ms   | [S3,MB5,B]  327-22-349ms   | [S3,MB6,F]  353-15-368ms   | [S3,MB6,B]  375-22-398ms   | [S3,MB7,F]  401-15-417ms   | [S3,MB7,B]  424-22-447ms  
[rank3]:2025-12-01 01:21:10,321 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0121_stage3_step700.svg
[rank3]:2025-12-01 01:22:55,457 - INFO - Avg. fwd time: 14.7860 / Avg. bwd time: 28.5306 / Avg. batch time: 428.8423 (ms) / GPU bubble ratio: 19.19%
[rank1]:2025-12-01 01:22:55,520 - INFO - Avg. fwd time: 10.2860 / Avg. bwd time: 20.8343 / Avg. batch time: 496.7363 (ms) / GPU bubble ratio: 49.88%
[rank2]:2025-12-01 01:22:55,486 - INFO - Avg. fwd time: 7.8865 / Avg. bwd time: 17.4804 / Avg. batch time: 459.1750 (ms) / GPU bubble ratio: 55.80%
[rank0]:2025-12-01 01:22:55,551 - INFO - Avg. fwd time: 8.5196 / Avg. bwd time: 13.7723 / Avg. batch time: 529.4638 (ms) / GPU bubble ratio: 66.32%
[rank0]:2025-12-01 01:24:36,787 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 01:24:40,859 - INFO - Avg. fwd time: 14.7943 / Avg. bwd time: 28.4467 / Avg. batch time: 428.2318 (ms) / GPU bubble ratio: 19.22%
[rank2]:2025-12-01 01:24:40,889 - INFO - Avg. fwd time: 7.8884 / Avg. bwd time: 17.4695 / Avg. batch time: 458.5450 (ms) / GPU bubble ratio: 55.76%
[rank1]:2025-12-01 01:24:40,923 - INFO - Avg. fwd time: 10.2891 / Avg. bwd time: 20.8114 / Avg. batch time: 496.0975 (ms) / GPU bubble ratio: 49.85%
[rank3]:2025-12-01 01:24:40,974 - INFO -  step: 750  loss:  0.2559  grad_norm:  0.0957  memory: 17.37GiB(36.56%)  tps: 7,771  tflops: 60.75  mfu: 19.47%
[rank2]:2025-12-01 01:24:40,976 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0957  memory:  6.51GiB(13.70%)  tps: 7,770  tflops: 60.75  mfu: 19.47%
[rank0]:2025-12-01 01:24:40,955 - INFO - Avg. fwd time: 8.5231 / Avg. bwd time: 13.6999 / Avg. batch time: 528.7958 (ms) / GPU bubble ratio: 66.38%
[rank0]:2025-12-01 01:24:40,991 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0957  memory: 13.29GiB(27.97%)  tps: 7,770  tflops: 60.75  mfu: 19.47%
[rank1]:2025-12-01 01:24:40,980 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0957  memory:  9.36GiB(19.71%)  tps: 7,770  tflops: 60.75  mfu: 19.47%
[rank3]:2025-12-01 01:26:25,433 - INFO - Avg. fwd time: 14.8028 / Avg. bwd time: 28.3507 / Avg. batch time: 427.5252 (ms) / GPU bubble ratio: 19.25%
[rank1]:2025-12-01 01:26:25,498 - INFO - Avg. fwd time: 10.2921 / Avg. bwd time: 20.7906 / Avg. batch time: 495.3655 (ms) / GPU bubble ratio: 49.80%
[rank2]:2025-12-01 01:26:25,463 - INFO - Avg. fwd time: 7.8902 / Avg. bwd time: 17.4595 / Avg. batch time: 457.8204 (ms) / GPU bubble ratio: 55.70%
[rank0]:2025-12-01 01:26:25,530 - INFO - Avg. fwd time: 8.5265 / Avg. bwd time: 13.6239 / Avg. batch time: 528.0378 (ms) / GPU bubble ratio: 66.44%
[rank0]:2025-12-01 01:28:05,973 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 01:28:10,249 - INFO - Avg. fwd time: 7.8920 / Avg. bwd time: 17.4502 / Avg. batch time: 457.1753 (ms) / GPU bubble ratio: 55.65%
[rank3]:2025-12-01 01:28:10,218 - INFO - Avg. fwd time: 14.8126 / Avg. bwd time: 28.2630 / Avg. batch time: 426.8968 (ms) / GPU bubble ratio: 19.28%
[rank0]:2025-12-01 01:28:10,316 - INFO - Avg. fwd time: 8.5301 / Avg. bwd time: 13.5597 / Avg. batch time: 527.3618 (ms) / GPU bubble ratio: 66.49%
[rank1]:2025-12-01 01:28:10,284 - INFO - Avg. fwd time: 10.2952 / Avg. bwd time: 20.7711 / Avg. batch time: 494.7128 (ms) / GPU bubble ratio: 49.76%
[rank2]:2025-12-01 01:28:10,338 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0698  memory:  6.51GiB(13.70%)  tps: 7,826  tflops: 61.18  mfu: 19.61%
[rank2]:2025-12-01 01:28:10,338 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0698  tps: 7,977  tflops: 62.36  mfu: 18.28%
[rank2]:2025-12-01 01:28:10,338 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-01 01:28:10,339 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-01 01:28:10,346 - INFO -  step: 800  loss:  0.2594  grad_norm:  0.0698  memory: 17.37GiB(36.56%)  tps: 7,825  tflops: 61.18  mfu: 19.61%
[rank3]:2025-12-01 01:28:10,347 - INFO -  final step: 800  loss:  0.2594  grad_norm:  0.0698  tps: 7,983  tflops: 62.41  mfu: 18.41%
[rank3]:2025-12-01 01:28:10,347 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-01 01:28:10,348 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-01 01:28:10,352 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0698  memory: 13.29GiB(27.97%)  tps: 7,826  tflops: 61.18  mfu: 19.61%
[rank0]:2025-12-01 01:28:10,352 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0698  tps: 7,978  tflops: 62.36  mfu: 18.28%
[rank0]:2025-12-01 01:28:10,352 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-01 01:28:10,353 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-01 01:28:10,341 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0698  memory:  9.36GiB(19.71%)  tps: 7,826  tflops: 61.18  mfu: 19.61%
[rank1]:2025-12-01 01:28:10,341 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0698  tps: 7,978  tflops: 62.37  mfu: 18.28%
[rank1]:2025-12-01 01:28:10,341 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-01 01:28:10,342 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-01 01:28:12,391 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-01 01:28:12,462 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251201_0128_stage2_final800.svg
[rank0]:2025-12-01 01:28:12,462 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251201_0128_stage0_final800.svg
[rank1]:2025-12-01 01:28:12,462 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251201_0128_stage1_final800.svg
[rank3]:2025-12-01 01:28:12,542 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0128_real_final800_rank3.svg
[rank3]:			> Batch Time: 514.41 ms, GPU Bubble Ratio: 68.71%, 52.48%, 60.94%, 35.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  176-0-176ms    | [S0,MB5,F]  176-6-183ms    | [S0,MB2,B]  246-0-246ms    | [S0,MB6,F]  246-6-253ms    | [S0,MB3,B]  311-0-311ms    | [S0,MB7,F]  312-6-318ms    | [S0,MB4,B]  361-26-387ms   | [S0,MB5,B]  408-25-434ms   | [S0,MB6,B]  455-20-475ms   | [S0,MB7,B]  495-19-514ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-105ms    | [S1,MB3,F]  108-11-120ms   | [S1,MB1,B]  159-11-171ms   | [S1,MB4,F]  175-9-184ms    | [S1,MB2,B]  229-11-241ms   | [S1,MB5,F]  245-9-254ms    | [S1,MB3,B]  280-25-306ms   | [S1,MB6,F]  309-9-319ms    | [S1,MB4,B]  330-25-356ms   | [S1,MB7,F]  359-9-369ms    | [S1,MB5,B]  378-26-405ms   | [S1,MB6,B]  425-25-451ms   | [S1,MB7,B]  469-22-491ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  145-9-154ms    | [S2,MB3,F]  158-7-165ms    | [S2,MB2,B]  204-20-224ms   | [S2,MB4,F]  228-7-235ms    | [S2,MB3,B]  255-20-275ms   | [S2,MB5,F]  279-7-286ms    | [S2,MB4,B]  304-20-324ms   | [S2,MB6,F]  328-7-335ms    | [S2,MB5,B]  353-20-373ms   | [S2,MB7,F]  377-7-384ms    | [S2,MB6,B]  402-20-422ms   | [S2,MB7,B]  448-17-466ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-41-140ms    | [S3,MB2,F]  143-12-156ms   | [S3,MB2,B]  163-37-201ms   | [S3,MB3,F]  202-15-218ms   | [S3,MB3,B]  227-23-250ms   | [S3,MB4,F]  254-15-269ms   | [S3,MB4,B]  276-22-299ms   | [S3,MB5,F]  303-15-318ms   | [S3,MB5,B]  325-22-348ms   | [S3,MB6,F]  352-15-367ms   | [S3,MB6,B]  374-22-397ms   | [S3,MB7,F]  400-15-415ms   | [S3,MB7,B]  423-22-445ms  
[rank0]:2025-12-01 01:28:12,615 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251201_0128_rank0_stage0.svg
[rank0]:	> Counts Sum: 331760, Total Sum: 1728640 (19.19%), Ratio(%) per element: [22.6, 23.11, 22.08, 22.94, 22.77, 20.37, 20.89, 21.74, 20.89, 22.26, 21.74, 21.23, 20.71, 21.57, 21.06, 20.37, 19.34, 20.03, 19.86, 19.69, 19.52, 18.15, 17.97, 18.66, 17.29, 19.17, 17.63, 17.63, 15.75, 16.95, 15.58, 16.09, 15.58, 15.58, 13.86, 15.75, 13.52]
[rank1]:2025-12-01 01:28:12,610 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251201_0128_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank2]:2025-12-01 01:28:12,616 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251201_0128_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank3]:2025-12-01 01:28:12,671 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251201_0128_thry_final800_rank3.svg
[rank3]:			> Batch Time: 343.94 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-31ms     | [S0,MB3,F]  31-10-41ms     | [S0,MB0,B]  104-20-125ms   | [S0,MB4,F]  125-10-135ms   | [S0,MB1,B]  135-20-156ms   | [S0,MB5,F]  156-10-166ms   | [S0,MB2,B]  166-20-187ms   | [S0,MB6,F]  187-10-198ms   | [S0,MB3,B]  198-20-218ms   | [S0,MB7,F]  218-10-229ms   | [S0,MB4,B]  229-20-250ms   | [S0,MB5,B]  260-20-281ms   | [S0,MB6,B]  291-20-312ms   | [S0,MB7,B]  323-20-343ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-41ms     | [S1,MB0,B]  83-20-104ms    | [S1,MB3,F]  104-10-114ms   | [S1,MB1,B]  114-20-135ms   | [S1,MB4,F]  135-10-145ms   | [S1,MB2,B]  145-20-166ms   | [S1,MB5,F]  166-10-177ms   | [S1,MB3,B]  177-20-198ms   | [S1,MB6,F]  198-10-208ms   | [S1,MB4,B]  208-20-229ms   | [S1,MB7,F]  229-10-239ms   | [S1,MB5,B]  239-20-260ms   | [S1,MB6,B]  270-20-291ms   | [S1,MB7,B]  302-20-323ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms     | [S2,MB1,F]  31-10-41ms     | [S2,MB0,B]  62-20-83ms     | [S2,MB2,F]  83-10-93ms     | [S2,MB1,B]  93-20-114ms    | [S2,MB3,F]  114-10-125ms   | [S2,MB2,B]  125-20-145ms   | [S2,MB4,F]  145-10-156ms   | [S2,MB3,B]  156-20-177ms   | [S2,MB5,F]  177-10-187ms   | [S2,MB4,B]  187-20-208ms   | [S2,MB6,F]  208-10-218ms   | [S2,MB5,B]  218-20-239ms   | [S2,MB7,F]  239-10-250ms   | [S2,MB6,B]  250-20-270ms   | [S2,MB7,B]  281-20-302ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms     | [S3,MB0,B]  41-20-62ms     | [S3,MB1,F]  62-10-72ms     | [S3,MB1,B]  72-20-93ms     | [S3,MB2,F]  93-10-104ms    | [S3,MB2,B]  104-20-125ms   | [S3,MB3,F]  125-10-135ms   | [S3,MB3,B]  135-20-156ms   | [S3,MB4,F]  156-10-166ms   | [S3,MB4,B]  166-20-187ms   | [S3,MB5,F]  187-10-198ms   | [S3,MB5,B]  198-20-218ms   | [S3,MB6,F]  218-10-229ms   | [S3,MB6,B]  229-20-250ms   | [S3,MB7,F]  250-10-260ms   | [S3,MB7,B]  260-20-281ms  
[rank3]:2025-12-01 01:28:12,718 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251201_0128_stage3_final800.svg
[rank3]:2025-12-01 01:28:12,850 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251201_0128_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [75.85, 75.34, 74.14, 75.68, 76.19, 76.19, 74.31, 74.48, 75.34, 74.82, 76.54, 74.48, 77.22, 74.48, 75.68, 74.82, 77.05, 76.36, 75.0, 74.48, 77.05, 75.68, 74.31, 76.71, 76.88, 74.31, 75.68, 74.82, 76.54]
[rank2]:2025-12-01 01:28:14,455 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251201_0128_stage2.svg
[rank2]:2025-12-01 01:28:14,457 - INFO - Destroying the purge thread.
[rank0]:2025-12-01 01:28:14,518 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251201_0128_stage0.svg
[rank0]:2025-12-01 01:28:14,521 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-01 01:28:14,471 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251201_0128_stage1.svg
[rank1]:2025-12-01 01:28:14,475 - INFO - Destroying the purge thread.
[rank1]:2025-12-01 01:28:14,632 - INFO - Process group destroyed
[rank2]:2025-12-01 01:28:14,643 - INFO - Process group destroyed
[rank3]:2025-12-01 01:28:14,674 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251201_0128_stage3.svg
[rank3]:2025-12-01 01:28:14,678 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 313-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.10475
[rank3]:wandb:               final/avg_loss 0.25937
[rank3]:wandb:             final/avg_mfu(%) 18.41106
[rank3]:wandb:             final/avg_tflops 62.40707
[rank3]:wandb:    final/avg_throughput(tps) 7982.95485
[rank3]:wandb:              final/grad_norm 0.06979
[rank3]:wandb:               final/max_loss 0.25937
[rank3]:wandb:                    grad_norm 0.06979
[rank3]:wandb: loss_metrics/global_avg_loss 0.25937
[rank3]:wandb: loss_metrics/global_max_loss 0.25937
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.8_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/55fdxrqa
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.8_42_dm1/20251201-0029/wandb/run-20251201_002959-55fdxrqa/logs
[rank3]:2025-12-01 01:28:16,102 - INFO - Process group destroyed
[rank0]:2025-12-01 01:28:16,521 - INFO - Training completed
[rank0]:2025-12-01 01:28:16,522 - INFO - Destroying the purge thread.
[rank0]:2025-12-01 01:28:16,607 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.6', 'layers.4', 'layers.8', 'layers.7'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.0', 'layers.1', 'layers.3', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.14', 'norm', 'layers.15', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
