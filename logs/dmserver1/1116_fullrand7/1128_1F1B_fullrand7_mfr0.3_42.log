
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 01. (ì›”) 01:28:18 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.3_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.3) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.3
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-01 01:28:24,591 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-12-01 01:28:24,604 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-12-01 01:28:24,799 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-12-01 01:28:24,772 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-12-01 01:28:24,815 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-01 01:28:24,817 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-01 01:28:24,823 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-01 01:28:24,825 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-01 01:28:24,827 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank2]:2025-12-01 01:28:24,820 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 01:28:25,018 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-01 01:28:25,000 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-01 01:28:25,003 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-01 01:28:25,008 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 01:28:25,020 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-01 01:28:25,024 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-01 01:28:25,024 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 01:28:25,025 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-12-01 01:28:25,415 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-01 01:28:28,107 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-01 01:28:28,179 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-01 01:28:28,145 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 01:28:28,173 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-01 01:28:28,173 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-01 01:28:28,325 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-01 01:28:28,369 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 01:28:28,370 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-01 01:28:28,395 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-01 01:28:28,395 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-01 01:28:28,362 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 01:28:28,362 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-01 01:28:28,363 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-01 01:28:28,588 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 01:28:28,588 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-01 01:28:28,589 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-01 01:28:28,575 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-01 01:28:28,615 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-01 01:28:28,640 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-01 01:28:28,640 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-01 01:28:28,821 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-01 01:28:28,821 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-01 01:28:28,821 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run l32fdy29
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.3_42_dm1/20251201-0128/wandb/run-20251201_012829-l32fdy29
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/l32fdy29
[rank3]:2025-12-01 01:28:30,845 - INFO - WandB logging enabled
[rank3]:2025-12-01 01:28:30,846 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-01 01:28:30,885 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-01 01:28:30,911 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-01 01:28:30,911 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-01 01:28:31,102 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-01 01:28:31,102 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-01 01:28:31,103 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-01 01:28:31,118 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-01 01:28:31,118 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 01:28:31,118 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank0]:2025-12-01 01:28:31,118 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 01:28:31,118 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-01 01:28:31,118 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-01 01:28:31,118 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 01:28:33,061 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-01 01:28:33,061 - INFO - Finished loading the checkpoint in 1.94 seconds.
[rank0]:2025-12-01 01:28:33,061 - INFO - Training starts at step 1
[rank3]:2025-12-01 01:28:38,932 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 12.97GiB(27.31%)  tps: 4,073  tflops: 31.84  mfu: 10.21%
[rank3]:2025-12-01 01:28:38,933 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-01 01:28:38,921 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  4.59GiB(9.67%)  tps: 3,180  tflops: 24.86  mfu: 7.97%
[rank2]:2025-12-01 01:28:38,921 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-01 01:28:38,925 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  6.72GiB(14.15%)  tps: 3,040  tflops: 23.77  mfu: 7.62%
[rank1]:2025-12-01 01:28:38,925 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-01 01:28:38,959 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  9.17GiB(19.29%)  tps: 3,095  tflops: 24.19  mfu: 7.75%
[rank0]:2025-12-01 01:28:38,959 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-01 01:30:47,090 - INFO - Avg. fwd time: 7.4903 / Avg. bwd time: 19.8491 / Avg. batch time: 572.1457 (ms) / GPU bubble ratio: 61.77%
[rank3]:2025-12-01 01:30:47,065 - INFO - Avg. fwd time: 13.1370 / Avg. bwd time: 43.9824 / Avg. batch time: 538.8982 (ms) / GPU bubble ratio: 15.21%
[rank1]:2025-12-01 01:30:47,119 - INFO - Avg. fwd time: 9.6467 / Avg. bwd time: 25.0687 / Avg. batch time: 612.6683 (ms) / GPU bubble ratio: 54.67%
[rank0]:2025-12-01 01:30:47,149 - INFO - Avg. fwd time: 7.7729 / Avg. bwd time: 25.5907 / Avg. batch time: 652.1050 (ms) / GPU bubble ratio: 59.07%
[rank0]:2025-12-01 01:32:56,085 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 01:33:01,365 - INFO - Avg. fwd time: 7.4906 / Avg. bwd time: 19.8891 / Avg. batch time: 573.9869 (ms) / GPU bubble ratio: 61.84%
[rank3]:2025-12-01 01:33:01,340 - INFO - Avg. fwd time: 13.2220 / Avg. bwd time: 44.1851 / Avg. batch time: 541.0762 (ms) / GPU bubble ratio: 15.12%
[rank1]:2025-12-01 01:33:01,394 - INFO - Avg. fwd time: 9.6585 / Avg. bwd time: 25.1292 / Avg. batch time: 614.1981 (ms) / GPU bubble ratio: 54.69%
[rank1]:2025-12-01 01:33:01,449 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  8.99GiB(18.92%)  tps: 6,116  tflops: 47.81  mfu: 15.32%
[rank2]:2025-12-01 01:33:01,446 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  6.39GiB(13.45%)  tps: 6,116  tflops: 47.81  mfu: 15.32%
[rank3]:2025-12-01 01:33:01,458 - INFO -  step: 50  loss:  9.9211  grad_norm: 12.8635  memory: 16.39GiB(34.50%)  tps: 6,116  tflops: 47.81  mfu: 15.32%
[rank0]:2025-12-01 01:33:01,424 - INFO - Avg. fwd time: 7.7744 / Avg. bwd time: 25.6321 / Avg. batch time: 653.3085 (ms) / GPU bubble ratio: 59.09%
[rank0]:2025-12-01 01:33:01,460 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory: 12.97GiB(27.31%)  tps: 6,117  tflops: 47.82  mfu: 15.33%
[rank3]:2025-12-01 01:33:55,103 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-01 01:34:48,925 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-01 01:34:49,052 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-01 01:35:07,258 - INFO - Avg. fwd time: 13.3807 / Avg. bwd time: 42.8231 / Avg. batch time: 531.4082 (ms) / GPU bubble ratio: 15.39%
[rank1]:2025-12-01 01:35:07,289 - INFO - Avg. fwd time: 9.7857 / Avg. bwd time: 24.2750 / Avg. batch time: 602.7273 (ms) / GPU bubble ratio: 54.79%
[rank2]:2025-12-01 01:35:07,272 - INFO - Avg. fwd time: 7.5960 / Avg. bwd time: 19.2076 / Avg. batch time: 563.4975 (ms) / GPU bubble ratio: 61.95%
[rank0]:2025-12-01 01:35:07,294 - INFO - Avg. fwd time: 7.8698 / Avg. bwd time: 23.9564 / Avg. batch time: 639.9977 (ms) / GPU bubble ratio: 60.22%
[rank3]:2025-12-01 01:35:25,494 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-01 01:35:25,667 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0135_max_batch_time.svg
[rank3]:			> Batch Time: 559.02 ms, GPU Bubble Ratio: 52.05%, 50.21%, 60.78%, 18.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  132-26-158ms   | [S0,MB4,F]  158-7-165ms    | [S0,MB1,B]  186-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  243-25-269ms   | [S0,MB6,F]  269-7-276ms    | [S0,MB3,B]  301-25-326ms   | [S0,MB7,F]  326-7-333ms    | [S0,MB4,B]  359-25-385ms   | [S0,MB5,B]  416-25-442ms   | [S0,MB6,B]  475-25-501ms   | [S0,MB7,B]  533-25-559ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-132ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  161-25-186ms   | [S1,MB4,F]  186-9-196ms    | [S1,MB2,B]  218-25-243ms   | [S1,MB5,F]  243-9-252ms    | [S1,MB3,B]  275-25-301ms   | [S1,MB6,F]  301-9-310ms    | [S1,MB4,B]  334-25-359ms   | [S1,MB7,F]  359-9-369ms    | [S1,MB5,B]  391-25-416ms   | [S1,MB6,B]  450-25-475ms   | [S1,MB7,B]  508-25-533ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  198-19-218ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  255-19-275ms   | [S2,MB5,F]  275-7-282ms    | [S2,MB4,B]  314-19-334ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  371-19-391ms   | [S2,MB7,F]  391-7-398ms    | [S2,MB6,B]  430-19-450ms   | [S2,MB7,B]  488-19-508ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-11-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-44-198ms   AFR(10):0.9655 | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB4,F]  255-13-269ms   | [S3,MB4,B]  269-45-314ms   AFR(10):0.9655 | [S3,MB5,F]  314-13-327ms   | [S3,MB5,B]  327-44-371ms   AFR(10):0.9655 | [S3,MB6,F]  371-13-385ms   | [S3,MB6,B]  385-44-430ms   AFR(10):0.9655 | [S3,MB7,F]  430-13-443ms   | [S3,MB7,B]  443-44-488ms   AFR(10):0.9655
[rank3]:2025-12-01 01:35:25,791 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0135_min_batch_time.svg
[rank3]:			> Batch Time: 338.40 ms, GPU Bubble Ratio: 81.71%, 49.41%, 60.39%, 15.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  88-0-88ms      | [S0,MB4,F]  88-7-95ms      | [S0,MB1,B]  121-0-121ms    | [S0,MB5,F]  121-7-129ms    | [S0,MB2,B]  156-0-156ms    | [S0,MB6,F]  156-7-164ms    | [S0,MB3,B]  193-0-193ms    | [S0,MB7,F]  193-7-200ms    | [S0,MB4,B]  229-0-229ms    | [S0,MB5,B]  265-0-265ms    | [S0,MB6,B]  302-0-302ms    | [S0,MB7,B]  338-0-338ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  76-11-88ms     | [S1,MB3,F]  88-9-97ms      | [S1,MB1,B]  110-11-121ms   | [S1,MB4,F]  121-9-131ms    | [S1,MB2,B]  145-11-156ms   | [S1,MB5,F]  156-9-166ms    | [S1,MB3,B]  181-11-193ms   | [S1,MB6,F]  193-9-202ms    | [S1,MB4,B]  217-11-229ms   | [S1,MB7,F]  229-9-238ms    | [S1,MB5,B]  253-11-265ms   | [S1,MB6,B]  290-11-302ms   | [S1,MB7,B]  326-11-338ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  67-9-76ms      | [S2,MB2,F]  76-7-83ms      | [S2,MB1,B]  100-9-110ms    | [S2,MB3,F]  110-7-117ms    | [S2,MB2,B]  135-9-145ms    | [S2,MB4,F]  145-7-152ms    | [S2,MB3,B]  171-9-181ms    | [S2,MB5,F]  181-7-188ms    | [S2,MB4,B]  208-9-217ms    | [S2,MB6,F]  217-7-224ms    | [S2,MB5,B]  244-9-253ms    | [S2,MB7,F]  253-7-261ms    | [S2,MB6,B]  281-9-290ms    | [S2,MB7,B]  317-9-326ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-22-67ms     AFR(10):0.9655 | [S3,MB1,F]  67-11-78ms     | [S3,MB1,B]  78-22-100ms    AFR(10):0.9655 | [S3,MB2,F]  100-12-113ms   | [S3,MB2,B]  113-22-135ms   AFR(10):0.9655 | [S3,MB3,F]  135-13-149ms   | [S3,MB3,B]  149-22-171ms   AFR(10):0.9655 | [S3,MB4,F]  171-13-185ms   | [S3,MB4,B]  185-22-208ms   AFR(10):0.9655 | [S3,MB5,F]  208-13-221ms   | [S3,MB5,B]  221-23-244ms   AFR(10):0.9655 | [S3,MB6,F]  244-13-258ms   | [S3,MB6,B]  258-22-281ms   AFR(10):0.9655 | [S3,MB7,F]  281-13-294ms   | [S3,MB7,B]  294-22-317ms   AFR(10):0.9655
[rank3]:2025-12-01 01:35:25,929 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0135_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 456.36 ms, GPU Bubble Ratio: 46.99%, 41.94%, 54.29%, 11.22%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  132-26-158ms   | [S0,MB4,F]  158-7-165ms    | [S0,MB1,B]  186-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  243-25-269ms   | [S0,MB6,F]  269-7-276ms    | [S0,MB3,B]  301-25-326ms   | [S0,MB7,F]  326-7-333ms    | [S0,MB4,B]  337-25-363ms   | [S0,MB5,B]  394-25-420ms   | [S0,MB6,B]  431-25-456ms   | [S0,MB7,B]  456-0-456ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-132ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  161-25-186ms   | [S1,MB4,F]  186-9-196ms    | [S1,MB2,B]  218-25-243ms   | [S1,MB5,F]  243-9-252ms    | [S1,MB3,B]  275-25-301ms   | [S1,MB6,F]  301-9-310ms    | [S1,MB4,B]  311-25-337ms   | [S1,MB7,F]  337-9-346ms    | [S1,MB5,B]  369-25-394ms   | [S1,MB6,B]  406-25-431ms   | [S1,MB7,B]  444-11-456ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  198-19-218ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  255-19-275ms   | [S2,MB5,F]  275-7-282ms    | [S2,MB4,B]  291-19-311ms   | [S2,MB6,F]  311-7-319ms    | [S2,MB5,B]  349-19-369ms   | [S2,MB7,F]  369-7-376ms    | [S2,MB6,B]  386-19-406ms   | [S2,MB7,B]  435-9-444ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-11-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-44-198ms   AFR(10):0.9655 | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB4,F]  255-13-269ms   | [S3,MB4,B]  269-22-291ms   AFR(10):0.9655 | [S3,MB5,F]  291-13-305ms   | [S3,MB5,B]  305-44-349ms   AFR(10):0.9655 | [S3,MB6,F]  349-13-363ms   | [S3,MB6,B]  363-22-386ms   AFR(10):0.9655 | [S3,MB7,F]  386-13-399ms   | [S3,MB7,B]  399-35-435ms   AFR(10):0.9655
[rank3]:2025-12-01 01:35:25,929 - INFO - 	> Batch Time: 456.36 ms (Average Freeze Ratio: 0.17, Time Reduction Rate: 0.18)
[rank0]:2025-12-01 01:37:01,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 01:37:07,019 - INFO - Avg. fwd time: 13.5635 / Avg. bwd time: 41.2468 / Avg. batch time: 520.4719 (ms) / GPU bubble ratio: 15.75%
[rank3]:2025-12-01 01:37:07,024 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.10(0.13)/0.40
[rank2]:2025-12-01 01:37:07,044 - INFO - Avg. fwd time: 7.7070 / Avg. bwd time: 18.4819 / Avg. batch time: 552.2241 (ms) / GPU bubble ratio: 62.06%
[rank2]:2025-12-01 01:37:07,050 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-01 01:37:07,073 - INFO - Avg. fwd time: 9.9246 / Avg. bwd time: 23.1720 / Avg. batch time: 590.5711 (ms) / GPU bubble ratio: 55.17%
[rank1]:2025-12-01 01:37:07,080 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-01 01:37:07,125 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1434  memory:  9.36GiB(19.71%)  tps: 6,669  tflops: 52.13  mfu: 16.71%
[rank3]:2025-12-01 01:37:07,134 - INFO -  step: 100  loss:  8.6902  grad_norm:  8.1434  memory: 17.37GiB(36.56%)  tps: 6,669  tflops: 52.14  mfu: 16.71%
[rank0]:2025-12-01 01:37:07,100 - INFO - Avg. fwd time: 8.0193 / Avg. bwd time: 21.2402 / Avg. batch time: 625.7657 (ms) / GPU bubble ratio: 62.59%
[rank0]:2025-12-01 01:37:07,107 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.01)/0.02, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-01 01:37:07,136 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1434  memory: 12.97GiB(27.31%)  tps: 6,669  tflops: 52.13  mfu: 16.71%
[rank2]:2025-12-01 01:37:07,121 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1434  memory:  6.51GiB(13.70%)  tps: 6,669  tflops: 52.13  mfu: 16.71%
[rank2]:2025-12-01 01:37:07,194 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0137_stage2_step100.svg
[rank1]:2025-12-01 01:37:07,194 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0137_stage1_step100.svg
[rank0]:2025-12-01 01:37:07,194 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0137_stage0_step100.svg
[rank3]:2025-12-01 01:37:07,277 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0137_real_step100_rank3.svg
[rank3]:			> Batch Time: 639.36 ms, GPU Bubble Ratio: 63.79%, 57.59%, 66.44%, 29.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  147-17-165ms   | [S0,MB4,F]  165-7-172ms    | [S0,MB1,B]  212-17-229ms   | [S0,MB5,F]  229-6-236ms    | [S0,MB2,B]  284-17-301ms   | [S0,MB6,F]  301-7-308ms    | [S0,MB3,B]  355-17-372ms   | [S0,MB7,F]  372-7-379ms    | [S0,MB4,B]  422-25-448ms   | [S0,MB5,B]  487-25-512ms   | [S0,MB6,B]  553-25-579ms   | [S0,MB7,B]  618-21-639ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  37-9-46ms      | [S1,MB0,B]  120-22-142ms   | [S1,MB3,F]  146-9-156ms    | [S1,MB1,B]  185-22-207ms   | [S1,MB4,F]  211-9-220ms    | [S1,MB2,B]  256-22-278ms   | [S1,MB5,F]  282-9-291ms    | [S1,MB3,B]  324-25-349ms   | [S1,MB6,F]  353-9-362ms    | [S1,MB4,B]  392-25-417ms   | [S1,MB7,F]  421-9-430ms    | [S1,MB5,B]  458-25-484ms   | [S1,MB6,B]  524-25-549ms   | [S1,MB7,B]  590-24-614ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  97-17-115ms    | [S2,MB2,F]  118-7-126ms    | [S2,MB1,B]  163-17-180ms   | [S2,MB3,F]  183-7-190ms    | [S2,MB2,B]  231-20-251ms   | [S2,MB4,F]  254-7-262ms    | [S2,MB3,B]  299-19-319ms   | [S2,MB5,F]  323-7-330ms    | [S2,MB4,B]  367-20-387ms   | [S2,MB6,F]  390-7-398ms    | [S2,MB5,B]  433-19-453ms   | [S2,MB7,F]  457-7-464ms    | [S2,MB6,B]  501-20-521ms   | [S2,MB7,B]  567-19-586ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-40-92ms     | [S3,MB1,F]  96-11-107ms    | [S3,MB1,B]  114-43-158ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB2,B]  181-44-226ms   | [S3,MB3,F]  229-13-243ms   | [S3,MB3,B]  249-44-294ms   | [S3,MB4,F]  298-13-312ms   | [S3,MB4,B]  319-44-363ms   | [S3,MB5,F]  366-14-380ms   | [S3,MB5,B]  387-41-428ms   | [S3,MB6,F]  432-13-445ms   | [S3,MB6,B]  452-44-497ms   | [S3,MB7,F]  500-14-514ms   | [S3,MB7,B]  522-41-563ms  
[rank3]:2025-12-01 01:37:07,321 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0137_stage3_step100.svg
[rank3]:2025-12-01 01:39:13,197 - INFO - Avg. fwd time: 13.6539 / Avg. bwd time: 40.8526 / Avg. batch time: 518.0181 (ms) / GPU bubble ratio: 15.82%
[rank2]:2025-12-01 01:39:13,222 - INFO - Avg. fwd time: 7.6903 / Avg. bwd time: 18.5848 / Avg. batch time: 549.8174 (ms) / GPU bubble ratio: 61.77%
[rank1]:2025-12-01 01:39:13,251 - INFO - Avg. fwd time: 9.9108 / Avg. bwd time: 23.2190 / Avg. batch time: 588.2925 (ms) / GPU bubble ratio: 54.95%
[rank0]:2025-12-01 01:39:13,277 - INFO - Avg. fwd time: 8.0333 / Avg. bwd time: 21.0228 / Avg. batch time: 623.2618 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-12-01 01:41:16,262 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 01:41:21,154 - INFO - Avg. fwd time: 13.6639 / Avg. bwd time: 40.8852 / Avg. batch time: 518.4261 (ms) / GPU bubble ratio: 15.82%
[rank3]:2025-12-01 01:41:21,159 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.24(0.27)/0.40
[rank2]:2025-12-01 01:41:21,179 - INFO - Avg. fwd time: 7.7010 / Avg. bwd time: 18.4977 / Avg. batch time: 550.0223 (ms) / GPU bubble ratio: 61.89%
[rank2]:2025-12-01 01:41:21,185 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-01 01:41:21,207 - INFO - Avg. fwd time: 9.9324 / Avg. bwd time: 23.0171 / Avg. batch time: 588.3981 (ms) / GPU bubble ratio: 55.20%
[rank1]:2025-12-01 01:41:21,214 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-01 01:41:21,267 - INFO -  step: 150  loss:  3.8533  grad_norm:  5.9724  memory: 17.37GiB(36.56%)  tps: 6,447  tflops: 50.40  mfu: 16.15%
[rank0]:2025-12-01 01:41:21,234 - INFO - Avg. fwd time: 8.0641 / Avg. bwd time: 20.6800 / Avg. batch time: 623.1187 (ms) / GPU bubble ratio: 63.10%
[rank0]:2025-12-01 01:41:21,241 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.01)/0.02, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-01 01:41:21,270 - INFO -  step: 150  loss: -8.0000  grad_norm:  5.9724  memory: 13.21GiB(27.80%)  tps: 6,447  tflops: 50.40  mfu: 16.15%
[rank2]:2025-12-01 01:41:21,255 - INFO -  step: 150  loss: -8.0000  grad_norm:  5.9724  memory:  6.51GiB(13.70%)  tps: 6,447  tflops: 50.40  mfu: 16.15%
[rank1]:2025-12-01 01:41:21,259 - INFO -  step: 150  loss: -8.0000  grad_norm:  5.9724  memory:  9.36GiB(19.71%)  tps: 6,447  tflops: 50.40  mfu: 16.15%
[rank3]:2025-12-01 01:43:25,890 - INFO - Avg. fwd time: 13.7020 / Avg. bwd time: 40.5987 / Avg. batch time: 516.5068 (ms) / GPU bubble ratio: 15.90%
[rank2]:2025-12-01 01:43:25,914 - INFO - Avg. fwd time: 7.7108 / Avg. bwd time: 18.4444 / Avg. batch time: 547.9678 (ms) / GPU bubble ratio: 61.82%
[rank0]:2025-12-01 01:43:25,968 - INFO - Avg. fwd time: 8.1222 / Avg. bwd time: 20.2613 / Avg. batch time: 620.6748 (ms) / GPU bubble ratio: 63.42%
[rank1]:2025-12-01 01:43:25,942 - INFO - Avg. fwd time: 9.9642 / Avg. bwd time: 22.7652 / Avg. batch time: 586.2211 (ms) / GPU bubble ratio: 55.34%
[rank0]:2025-12-01 01:45:22,238 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 01:45:27,087 - INFO - Avg. fwd time: 13.7674 / Avg. bwd time: 40.0765 / Avg. batch time: 513.0740 (ms) / GPU bubble ratio: 16.05%
[rank3]:2025-12-01 01:45:27,092 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.38(0.40)/0.40
[rank1]:2025-12-01 01:45:27,139 - INFO - Avg. fwd time: 10.0038 / Avg. bwd time: 22.4760 / Avg. batch time: 582.4582 (ms) / GPU bubble ratio: 55.39%
[rank1]:2025-12-01 01:45:27,146 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-01 01:45:27,111 - INFO - Avg. fwd time: 7.7341 / Avg. bwd time: 18.2976 / Avg. batch time: 544.3394 (ms) / GPU bubble ratio: 61.74%
[rank2]:2025-12-01 01:45:27,117 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank2]:2025-12-01 01:45:27,187 - INFO -  step: 200  loss: -8.0000  grad_norm:  4.7625  memory:  6.51GiB(13.70%)  tps: 6,662  tflops: 52.08  mfu: 16.69%
[rank3]:2025-12-01 01:45:27,199 - INFO -  step: 200  loss:  1.2793  grad_norm:  4.7625  memory: 17.37GiB(36.56%)  tps: 6,662  tflops: 52.08  mfu: 16.69%
[rank0]:2025-12-01 01:45:27,165 - INFO - Avg. fwd time: 8.1707 / Avg. bwd time: 19.5972 / Avg. batch time: 616.6635 (ms) / GPU bubble ratio: 63.98%
[rank0]:2025-12-01 01:45:27,172 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.03(0.02)/0.02, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-01 01:45:27,201 - INFO -  step: 200  loss: -8.0000  grad_norm:  4.7625  memory: 13.23GiB(27.85%)  tps: 6,662  tflops: 52.08  mfu: 16.69%
[rank1]:2025-12-01 01:45:27,190 - INFO -  step: 200  loss: -8.0000  grad_norm:  4.7625  memory:  9.36GiB(19.71%)  tps: 6,662  tflops: 52.08  mfu: 16.69%
[rank1]:2025-12-01 01:45:27,251 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0145_stage1_step200.svg
[rank2]:2025-12-01 01:45:27,251 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0145_stage2_step200.svg
[rank0]:2025-12-01 01:45:27,251 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0145_stage0_step200.svg
[rank3]:2025-12-01 01:45:27,341 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0145_real_step200_rank3.svg
[rank3]:			> Batch Time: 593.89 ms, GPU Bubble Ratio: 69.34%, 58.38%, 66.29%, 31.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-38ms      | [S0,MB0,B]  129-4-133ms    | [S0,MB4,F]  134-8-142ms    | [S0,MB1,B]  195-4-199ms    | [S0,MB5,F]  199-6-206ms    | [S0,MB2,B]  272-4-276ms    | [S0,MB6,F]  276-6-283ms    | [S0,MB3,B]  354-4-358ms    | [S0,MB7,F]  358-6-365ms    | [S0,MB4,B]  419-26-445ms   | [S0,MB5,B]  470-25-496ms   | [S0,MB6,B]  529-25-554ms   | [S0,MB7,B]  574-19-593ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  111-13-124ms   | [S1,MB3,F]  128-11-139ms   | [S1,MB1,B]  176-13-189ms   | [S1,MB4,F]  193-9-202ms    | [S1,MB2,B]  254-13-267ms   | [S1,MB5,F]  270-9-279ms    | [S1,MB3,B]  323-25-348ms   | [S1,MB6,F]  352-9-361ms    | [S1,MB4,B]  385-25-410ms   | [S1,MB7,F]  417-9-427ms    | [S1,MB5,B]  440-25-466ms   | [S1,MB6,B]  499-25-525ms   | [S1,MB7,B]  548-22-570ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  96-9-106ms     | [S2,MB2,F]  109-9-118ms    | [S2,MB1,B]  161-9-171ms    | [S2,MB3,F]  174-7-181ms    | [S2,MB2,B]  228-20-248ms   | [S2,MB4,F]  252-7-259ms    | [S2,MB3,B]  298-20-318ms   | [S2,MB5,F]  321-7-328ms    | [S2,MB4,B]  360-20-380ms   | [S2,MB6,F]  383-7-391ms    | [S2,MB5,B]  415-20-435ms   | [S2,MB7,F]  439-7-446ms    | [S2,MB6,B]  476-20-496ms   | [S2,MB7,B]  527-17-544ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-39-91ms     | [S3,MB1,F]  95-11-106ms    | [S3,MB1,B]  113-43-156ms   | [S3,MB2,F]  160-12-172ms   | [S3,MB2,B]  179-43-223ms   | [S3,MB3,F]  227-13-240ms   | [S3,MB3,B]  248-44-292ms   | [S3,MB4,F]  296-13-310ms   | [S3,MB4,B]  317-39-356ms   | [S3,MB5,F]  359-17-376ms   | [S3,MB5,B]  384-23-408ms   | [S3,MB6,F]  414-11-425ms   | [S3,MB6,B]  433-38-471ms   | [S3,MB7,F]  475-17-492ms   | [S3,MB7,B]  499-25-524ms  
[rank3]:2025-12-01 01:45:27,385 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0145_stage3_step200.svg
[rank3]:2025-12-01 01:47:27,760 - INFO - Avg. fwd time: 13.8200 / Avg. bwd time: 39.6319 / Avg. batch time: 510.1367 (ms) / GPU bubble ratio: 16.18%
[rank2]:2025-12-01 01:47:27,784 - INFO - Avg. fwd time: 7.7560 / Avg. bwd time: 18.1596 / Avg. batch time: 541.3129 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-12-01 01:47:27,813 - INFO - Avg. fwd time: 10.0413 / Avg. bwd time: 22.1851 / Avg. batch time: 579.2878 (ms) / GPU bubble ratio: 55.50%
[rank0]:2025-12-01 01:47:27,838 - INFO - Avg. fwd time: 8.2219 / Avg. bwd time: 18.7531 / Avg. batch time: 613.2192 (ms) / GPU bubble ratio: 64.81%
[rank0]:2025-12-01 01:49:23,715 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 01:49:28,412 - INFO - Avg. fwd time: 7.7730 / Avg. bwd time: 18.0497 / Avg. batch time: 538.9072 (ms) / GPU bubble ratio: 61.67%
[rank2]:2025-12-01 01:49:28,418 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-01 01:49:28,388 - INFO - Avg. fwd time: 13.8603 / Avg. bwd time: 39.2868 / Avg. batch time: 507.8524 (ms) / GPU bubble ratio: 16.28%
[rank3]:2025-12-01 01:49:28,393 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.41(0.40)/0.40
[rank1]:2025-12-01 01:49:28,440 - INFO - Avg. fwd time: 10.0701 / Avg. bwd time: 21.9509 / Avg. batch time: 576.7593 (ms) / GPU bubble ratio: 55.58%
[rank1]:2025-12-01 01:49:28,447 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 01:49:28,466 - INFO - Avg. fwd time: 8.2626 / Avg. bwd time: 18.0774 / Avg. batch time: 610.4709 (ms) / GPU bubble ratio: 65.48%
[rank0]:2025-12-01 01:49:28,473 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.03(0.02)/0.02, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 01:49:28,488 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9601  memory:  6.51GiB(13.70%)  tps: 6,790  tflops: 53.08  mfu: 17.01%
[rank3]:2025-12-01 01:49:28,500 - INFO -  step: 250  loss:  0.4331  grad_norm:  0.9601  memory: 17.37GiB(36.56%)  tps: 6,790  tflops: 53.08  mfu: 17.01%
[rank1]:2025-12-01 01:49:28,491 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9601  memory:  9.36GiB(19.71%)  tps: 6,790  tflops: 53.08  mfu: 17.01%
[rank0]:2025-12-01 01:49:28,502 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9601  memory: 13.23GiB(27.85%)  tps: 6,790  tflops: 53.08  mfu: 17.01%
[rank3]:2025-12-01 01:51:29,294 - INFO - Avg. fwd time: 13.8923 / Avg. bwd time: 39.0193 / Avg. batch time: 506.1000 (ms) / GPU bubble ratio: 16.36%
[rank2]:2025-12-01 01:51:29,319 - INFO - Avg. fwd time: 7.7869 / Avg. bwd time: 17.9602 / Avg. batch time: 537.0630 (ms) / GPU bubble ratio: 61.65%
[rank1]:2025-12-01 01:51:29,347 - INFO - Avg. fwd time: 10.0942 / Avg. bwd time: 21.7594 / Avg. batch time: 574.8137 (ms) / GPU bubble ratio: 55.67%
[rank0]:2025-12-01 01:51:29,373 - INFO - Avg. fwd time: 8.2960 / Avg. bwd time: 17.5240 / Avg. batch time: 608.3475 (ms) / GPU bubble ratio: 66.05%
[rank0]:2025-12-01 01:53:25,266 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 01:53:30,019 - INFO - Avg. fwd time: 13.9218 / Avg. bwd time: 38.7861 / Avg. batch time: 504.5731 (ms) / GPU bubble ratio: 16.43%
[rank3]:2025-12-01 01:53:30,024 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.41(0.40)/0.40
[rank0]:2025-12-01 01:53:30,099 - INFO - Avg. fwd time: 8.3235 / Avg. bwd time: 17.0469 / Avg. batch time: 606.5122 (ms) / GPU bubble ratio: 66.54%
[rank1]:2025-12-01 01:53:30,073 - INFO - Avg. fwd time: 10.1147 / Avg. bwd time: 21.6013 / Avg. batch time: 573.1280 (ms) / GPU bubble ratio: 55.73%
[rank1]:2025-12-01 01:53:30,080 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 01:53:30,044 - INFO - Avg. fwd time: 7.7986 / Avg. bwd time: 17.8861 / Avg. batch time: 535.4581 (ms) / GPU bubble ratio: 61.63%
[rank2]:2025-12-01 01:53:30,050 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 01:53:30,121 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2625  memory:  6.51GiB(13.70%)  tps: 6,781  tflops: 53.01  mfu: 16.99%
[rank3]:2025-12-01 01:53:30,133 - INFO -  step: 300  loss:  0.2786  grad_norm:  0.2625  memory: 17.37GiB(36.56%)  tps: 6,781  tflops: 53.01  mfu: 16.99%
[rank0]:2025-12-01 01:53:30,106 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.03(0.02)/0.02, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 01:53:30,135 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2625  memory: 13.23GiB(27.85%)  tps: 6,781  tflops: 53.01  mfu: 16.99%
[rank0]:2025-12-01 01:53:30,182 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0153_stage0_step300.svg
[rank1]:2025-12-01 01:53:30,124 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2625  memory:  9.36GiB(19.71%)  tps: 6,781  tflops: 53.01  mfu: 16.99%
[rank1]:2025-12-01 01:53:30,183 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0153_stage1_step300.svg
[rank2]:2025-12-01 01:53:30,185 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0153_stage2_step300.svg
[rank3]:2025-12-01 01:53:30,271 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0153_real_step300_rank3.svg
[rank3]:			> Batch Time: 589.94 ms, GPU Bubble Ratio: 72.57%, 59.02%, 66.05%, 30.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  126-0-126ms    | [S0,MB4,F]  126-8-135ms    | [S0,MB1,B]  192-0-192ms    | [S0,MB5,F]  192-6-199ms    | [S0,MB2,B]  270-0-270ms    | [S0,MB6,F]  270-6-277ms    | [S0,MB3,B]  353-0-353ms    | [S0,MB7,F]  353-6-359ms    | [S0,MB4,B]  418-26-444ms   | [S0,MB5,B]  468-25-494ms   | [S0,MB6,B]  527-22-549ms   | [S0,MB7,B]  571-18-589ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  109-11-121ms   | [S1,MB3,F]  125-11-136ms   | [S1,MB1,B]  175-11-187ms   | [S1,MB4,F]  190-9-199ms    | [S1,MB2,B]  253-11-265ms   | [S1,MB5,F]  268-8-277ms    | [S1,MB3,B]  322-25-347ms   | [S1,MB6,F]  351-9-360ms    | [S1,MB4,B]  385-25-410ms   | [S1,MB7,F]  416-9-425ms    | [S1,MB5,B]  439-25-465ms   | [S1,MB6,B]  498-25-523ms   | [S1,MB7,B]  546-21-568ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  95-9-104ms     | [S2,MB2,F]  108-9-117ms    | [S2,MB1,B]  161-9-170ms    | [S2,MB3,F]  174-7-181ms    | [S2,MB2,B]  228-20-248ms   | [S2,MB4,F]  252-7-259ms    | [S2,MB3,B]  297-20-317ms   | [S2,MB5,F]  320-7-327ms    | [S2,MB4,B]  359-20-379ms   | [S2,MB6,F]  383-7-390ms    | [S2,MB5,B]  414-20-434ms   | [S2,MB7,F]  438-7-445ms    | [S2,MB6,B]  474-20-494ms   | [S2,MB7,B]  525-17-542ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-38-90ms     | [S3,MB1,F]  93-11-105ms    | [S3,MB1,B]  112-43-155ms   | [S3,MB2,F]  159-12-172ms   | [S3,MB2,B]  179-44-223ms   | [S3,MB3,F]  226-13-239ms   | [S3,MB3,B]  247-44-291ms   | [S3,MB4,F]  295-13-309ms   | [S3,MB4,B]  315-39-355ms   | [S3,MB5,F]  358-17-375ms   | [S3,MB5,B]  383-23-406ms   | [S3,MB6,F]  412-11-424ms   | [S3,MB6,B]  431-37-469ms   | [S3,MB7,F]  472-18-491ms   | [S3,MB7,B]  498-23-521ms  
[rank3]:2025-12-01 01:53:30,314 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0153_stage3_step300.svg
[rank3]:2025-12-01 01:55:29,868 - INFO - Avg. fwd time: 13.9527 / Avg. bwd time: 38.5336 / Avg. batch time: 502.8950 (ms) / GPU bubble ratio: 16.51%
[rank2]:2025-12-01 01:55:29,894 - INFO - Avg. fwd time: 7.8084 / Avg. bwd time: 17.8229 / Avg. batch time: 533.7494 (ms) / GPU bubble ratio: 61.58%
[rank0]:2025-12-01 01:55:29,950 - INFO - Avg. fwd time: 8.3465 / Avg. bwd time: 16.6572 / Avg. batch time: 604.6048 (ms) / GPU bubble ratio: 66.92%
[rank1]:2025-12-01 01:55:29,923 - INFO - Avg. fwd time: 10.1316 / Avg. bwd time: 21.4671 / Avg. batch time: 571.3494 (ms) / GPU bubble ratio: 55.76%
[rank0]:2025-12-01 01:57:25,860 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 01:57:30,650 - INFO - Avg. fwd time: 13.9766 / Avg. bwd time: 38.3648 / Avg. batch time: 501.8124 (ms) / GPU bubble ratio: 16.56%
[rank2]:2025-12-01 01:57:30,676 - INFO - Avg. fwd time: 7.8180 / Avg. bwd time: 17.7691 / Avg. batch time: 532.6077 (ms) / GPU bubble ratio: 61.57%
[rank0]:2025-12-01 01:57:30,732 - INFO - Avg. fwd time: 8.3676 / Avg. bwd time: 16.3239 / Avg. batch time: 603.2972 (ms) / GPU bubble ratio: 67.26%
[rank1]:2025-12-01 01:57:30,705 - INFO - Avg. fwd time: 10.1474 / Avg. bwd time: 21.3520 / Avg. batch time: 570.1475 (ms) / GPU bubble ratio: 55.80%
[rank3]:2025-12-01 01:57:30,766 - INFO -  step: 350  loss:  0.2230  grad_norm:  0.1238  memory: 17.37GiB(36.56%)  tps: 6,809  tflops: 53.23  mfu: 17.06%
[rank2]:2025-12-01 01:57:30,754 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1238  memory:  6.51GiB(13.70%)  tps: 6,809  tflops: 53.23  mfu: 17.06%
[rank0]:2025-12-01 01:57:30,769 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1238  memory: 13.23GiB(27.85%)  tps: 6,809  tflops: 53.23  mfu: 17.06%
[rank1]:2025-12-01 01:57:30,757 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1238  memory:  9.36GiB(19.71%)  tps: 6,809  tflops: 53.23  mfu: 17.06%
[rank2]:2025-12-01 01:59:30,696 - INFO - Avg. fwd time: 7.8255 / Avg. bwd time: 17.7213 / Avg. batch time: 531.3662 (ms) / GPU bubble ratio: 61.54%
[rank3]:2025-12-01 01:59:30,670 - INFO - Avg. fwd time: 13.9988 / Avg. bwd time: 38.1858 / Avg. batch time: 500.6222 (ms) / GPU bubble ratio: 16.61%
[rank0]:2025-12-01 01:59:30,753 - INFO - Avg. fwd time: 8.3853 / Avg. bwd time: 16.0347 / Avg. batch time: 601.9105 (ms) / GPU bubble ratio: 67.54%
[rank1]:2025-12-01 01:59:30,726 - INFO - Avg. fwd time: 10.1602 / Avg. bwd time: 21.2512 / Avg. batch time: 568.8541 (ms) / GPU bubble ratio: 55.82%
[rank0]:2025-12-01 02:01:26,243 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 02:01:31,021 - INFO - Avg. fwd time: 14.0116 / Avg. bwd time: 38.0522 / Avg. batch time: 499.7115 (ms) / GPU bubble ratio: 16.65%
[rank2]:2025-12-01 02:01:31,047 - INFO - Avg. fwd time: 7.8321 / Avg. bwd time: 17.6785 / Avg. batch time: 530.4013 (ms) / GPU bubble ratio: 61.52%
[rank2]:2025-12-01 02:01:31,127 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0671  memory:  6.51GiB(13.70%)  tps: 6,816  tflops: 53.28  mfu: 17.08%
[rank0]:2025-12-01 02:01:31,106 - INFO - Avg. fwd time: 8.4008 / Avg. bwd time: 15.7801 / Avg. batch time: 600.8092 (ms) / GPU bubble ratio: 67.80%
[rank0]:2025-12-01 02:01:31,142 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0671  memory: 13.23GiB(27.85%)  tps: 6,816  tflops: 53.28  mfu: 17.08%
[rank1]:2025-12-01 02:01:31,078 - INFO - Avg. fwd time: 10.1711 / Avg. bwd time: 21.1607 / Avg. batch time: 567.8347 (ms) / GPU bubble ratio: 55.86%
[rank1]:2025-12-01 02:01:31,131 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0671  memory:  9.36GiB(19.71%)  tps: 6,816  tflops: 53.28  mfu: 17.08%
[rank3]:2025-12-01 02:01:31,140 - INFO -  step: 400  loss:  0.2104  grad_norm:  0.0671  memory: 17.37GiB(36.56%)  tps: 6,816  tflops: 53.29  mfu: 17.08%
[rank2]:2025-12-01 02:01:31,199 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0201_stage2_step400.svg
[rank0]:2025-12-01 02:01:31,195 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0201_stage0_step400.svg
[rank1]:2025-12-01 02:01:31,195 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0201_stage1_step400.svg
[rank3]:2025-12-01 02:01:31,277 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0201_real_step400_rank3.svg
[rank3]:			> Batch Time: 586.42 ms, GPU Bubble Ratio: 71.82%, 58.89%, 65.94%, 31.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  124-0-124ms    | [S0,MB4,F]  124-8-132ms    | [S0,MB1,B]  190-0-190ms    | [S0,MB5,F]  190-6-196ms    | [S0,MB2,B]  268-0-268ms    | [S0,MB6,F]  268-6-275ms    | [S0,MB3,B]  349-0-349ms    | [S0,MB7,F]  349-6-356ms    | [S0,MB4,B]  415-26-441ms   | [S0,MB5,B]  465-25-491ms   | [S0,MB6,B]  523-25-548ms   | [S0,MB7,B]  567-18-586ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  107-11-119ms   | [S1,MB3,F]  122-11-133ms   | [S1,MB1,B]  173-11-184ms   | [S1,MB4,F]  188-8-197ms    | [S1,MB2,B]  251-11-263ms   | [S1,MB5,F]  266-8-275ms    | [S1,MB3,B]  319-25-344ms   | [S1,MB6,F]  347-9-356ms    | [S1,MB4,B]  382-25-407ms   | [S1,MB7,F]  413-9-423ms    | [S1,MB5,B]  436-25-462ms   | [S1,MB6,B]  494-25-519ms   | [S1,MB7,B]  542-21-563ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  92-9-102ms     | [S2,MB2,F]  105-9-114ms    | [S2,MB1,B]  158-9-167ms    | [S2,MB3,F]  171-7-178ms    | [S2,MB2,B]  226-20-246ms   | [S2,MB4,F]  250-7-257ms    | [S2,MB3,B]  293-20-313ms   | [S2,MB5,F]  317-7-324ms    | [S2,MB4,B]  357-19-377ms   | [S2,MB6,F]  381-7-388ms    | [S2,MB5,B]  411-20-431ms   | [S2,MB7,F]  434-7-441ms    | [S2,MB6,B]  471-20-491ms   | [S2,MB7,B]  522-17-539ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-36-87ms     | [S3,MB1,F]  91-11-103ms    | [S3,MB1,B]  110-43-153ms   | [S3,MB2,F]  157-12-169ms   | [S3,MB2,B]  176-44-221ms   | [S3,MB3,F]  224-12-237ms   | [S3,MB3,B]  244-44-289ms   | [S3,MB4,F]  292-14-306ms   | [S3,MB4,B]  313-38-352ms   | [S3,MB5,F]  356-17-373ms   | [S3,MB5,B]  380-23-403ms   | [S3,MB6,F]  409-11-421ms   | [S3,MB6,B]  428-37-466ms   | [S3,MB7,F]  469-18-487ms   | [S3,MB7,B]  494-23-518ms  
[rank3]:2025-12-01 02:01:31,324 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0201_stage3_step400.svg
[rank3]:2025-12-01 02:01:58,969 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-01 02:01:59,096 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-01 02:01:59,141 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-01 02:01:59,120 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-01 02:03:31,650 - INFO - Avg. fwd time: 14.0201 / Avg. bwd time: 37.9426 / Avg. batch time: 498.9505 (ms) / GPU bubble ratio: 16.68%
[rank2]:2025-12-01 02:03:31,677 - INFO - Avg. fwd time: 7.8371 / Avg. bwd time: 17.6398 / Avg. batch time: 529.6301 (ms) / GPU bubble ratio: 61.52%
[rank1]:2025-12-01 02:03:31,707 - INFO - Avg. fwd time: 10.1794 / Avg. bwd time: 21.0807 / Avg. batch time: 567.0197 (ms) / GPU bubble ratio: 55.90%
[rank0]:2025-12-01 02:03:31,735 - INFO - Avg. fwd time: 8.4143 / Avg. bwd time: 15.5444 / Avg. batch time: 599.9209 (ms) / GPU bubble ratio: 68.05%
[rank0]:2025-12-01 02:05:28,138 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 02:05:32,888 - INFO - Avg. fwd time: 14.0235 / Avg. bwd time: 37.8759 / Avg. batch time: 498.4849 (ms) / GPU bubble ratio: 16.71%
[rank1]:2025-12-01 02:05:32,946 - INFO - Avg. fwd time: 10.1872 / Avg. bwd time: 21.0101 / Avg. batch time: 566.4760 (ms) / GPU bubble ratio: 55.94%
[rank2]:2025-12-01 02:05:32,915 - INFO - Avg. fwd time: 7.8416 / Avg. bwd time: 17.6054 / Avg. batch time: 529.1265 (ms) / GPU bubble ratio: 61.53%
[rank0]:2025-12-01 02:05:32,974 - INFO - Avg. fwd time: 8.4262 / Avg. bwd time: 15.3359 / Avg. batch time: 599.3138 (ms) / GPU bubble ratio: 68.28%
[rank3]:2025-12-01 02:05:33,008 - INFO -  step: 450  loss:  0.2254  grad_norm:  0.0907  memory: 17.37GiB(36.56%)  tps: 6,774  tflops: 52.96  mfu: 16.97%
[rank1]:2025-12-01 02:05:32,999 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0907  memory:  9.36GiB(19.71%)  tps: 6,774  tflops: 52.96  mfu: 16.97%
[rank2]:2025-12-01 02:05:32,996 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0907  memory:  6.51GiB(13.70%)  tps: 6,774  tflops: 52.96  mfu: 16.97%
[rank0]:2025-12-01 02:05:33,010 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0907  memory: 13.23GiB(27.85%)  tps: 6,774  tflops: 52.96  mfu: 16.97%
[rank3]:2025-12-01 02:07:33,564 - INFO - Avg. fwd time: 14.0325 / Avg. bwd time: 37.7889 / Avg. batch time: 497.9000 (ms) / GPU bubble ratio: 16.74%
[rank2]:2025-12-01 02:07:33,591 - INFO - Avg. fwd time: 7.8457 / Avg. bwd time: 17.5746 / Avg. batch time: 528.5032 (ms) / GPU bubble ratio: 61.52%
[rank1]:2025-12-01 02:07:33,621 - INFO - Avg. fwd time: 10.1944 / Avg. bwd time: 20.9469 / Avg. batch time: 565.8152 (ms) / GPU bubble ratio: 55.97%
[rank0]:2025-12-01 02:07:33,650 - INFO - Avg. fwd time: 8.4371 / Avg. bwd time: 15.1589 / Avg. batch time: 598.5978 (ms) / GPU bubble ratio: 68.47%
[rank0]:2025-12-01 02:09:30,388 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 02:09:35,164 - INFO - Avg. fwd time: 14.0358 / Avg. bwd time: 37.7431 / Avg. batch time: 497.5912 (ms) / GPU bubble ratio: 16.75%
[rank2]:2025-12-01 02:09:35,191 - INFO - Avg. fwd time: 7.8497 / Avg. bwd time: 17.5469 / Avg. batch time: 528.1661 (ms) / GPU bubble ratio: 61.53%
[rank0]:2025-12-01 02:09:35,251 - INFO - Avg. fwd time: 8.4473 / Avg. bwd time: 15.0002 / Avg. batch time: 598.1834 (ms) / GPU bubble ratio: 68.64%
[rank1]:2025-12-01 02:09:35,222 - INFO - Avg. fwd time: 10.2009 / Avg. bwd time: 20.8907 / Avg. batch time: 565.4491 (ms) / GPU bubble ratio: 56.01%
[rank1]:2025-12-01 02:09:35,276 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0908  memory:  9.36GiB(19.71%)  tps: 6,763  tflops: 52.87  mfu: 16.94%
[rank2]:2025-12-01 02:09:35,273 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0908  memory:  6.51GiB(13.70%)  tps: 6,763  tflops: 52.87  mfu: 16.94%
[rank0]:2025-12-01 02:09:35,287 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0908  memory: 13.23GiB(27.85%)  tps: 6,763  tflops: 52.87  mfu: 16.94%
[rank0]:2025-12-01 02:09:35,336 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0209_stage0_step500.svg
[rank3]:2025-12-01 02:09:35,285 - INFO -  step: 500  loss:  0.2170  grad_norm:  0.0908  memory: 17.37GiB(36.56%)  tps: 6,763  tflops: 52.87  mfu: 16.94%
[rank1]:2025-12-01 02:09:35,336 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0209_stage1_step500.svg
[rank2]:2025-12-01 02:09:35,336 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0209_stage2_step500.svg
[rank3]:2025-12-01 02:09:35,426 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0209_real_step500_rank3.svg
[rank3]:			> Batch Time: 590.95 ms, GPU Bubble Ratio: 71.94%, 59.15%, 66.19%, 30.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  128-0-128ms    | [S0,MB4,F]  128-8-137ms    | [S0,MB1,B]  193-0-193ms    | [S0,MB5,F]  193-6-200ms    | [S0,MB2,B]  272-0-272ms    | [S0,MB6,F]  272-6-278ms    | [S0,MB3,B]  353-0-353ms    | [S0,MB7,F]  353-6-360ms    | [S0,MB4,B]  418-26-444ms   | [S0,MB5,B]  469-25-494ms   | [S0,MB6,B]  528-25-553ms   | [S0,MB7,B]  572-18-590ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  111-11-123ms   | [S1,MB3,F]  126-11-138ms   | [S1,MB1,B]  176-11-188ms   | [S1,MB4,F]  191-9-200ms    | [S1,MB2,B]  255-11-266ms   | [S1,MB5,F]  270-9-279ms    | [S1,MB3,B]  323-25-348ms   | [S1,MB6,F]  352-9-361ms    | [S1,MB4,B]  385-25-411ms   | [S1,MB7,F]  417-9-426ms    | [S1,MB5,B]  440-25-465ms   | [S1,MB6,B]  498-25-524ms   | [S1,MB7,B]  546-21-568ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  96-9-106ms     | [S2,MB2,F]  109-9-119ms    | [S2,MB1,B]  162-9-171ms    | [S2,MB3,F]  175-7-182ms    | [S2,MB2,B]  229-20-250ms   | [S2,MB4,F]  253-7-260ms    | [S2,MB3,B]  298-20-318ms   | [S2,MB5,F]  321-7-329ms    | [S2,MB4,B]  360-20-380ms   | [S2,MB6,F]  384-7-391ms    | [S2,MB5,B]  414-20-434ms   | [S2,MB7,F]  438-7-445ms    | [S2,MB6,B]  475-20-495ms   | [S2,MB7,B]  526-17-543ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-40-91ms     | [S3,MB1,F]  95-11-106ms    | [S3,MB1,B]  113-43-157ms   | [S3,MB2,F]  160-12-173ms   | [S3,MB2,B]  180-44-224ms   | [S3,MB3,F]  228-13-241ms   | [S3,MB3,B]  248-44-293ms   | [S3,MB4,F]  296-13-310ms   | [S3,MB4,B]  316-38-355ms   | [S3,MB5,F]  359-17-377ms   | [S3,MB5,B]  384-23-407ms   | [S3,MB6,F]  413-11-425ms   | [S3,MB6,B]  432-38-470ms   | [S3,MB7,F]  474-18-492ms   | [S3,MB7,B]  499-23-522ms  
[rank3]:2025-12-01 02:09:35,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0209_stage3_step500.svg
[rank3]:2025-12-01 02:11:35,262 - INFO - Avg. fwd time: 14.0479 / Avg. bwd time: 37.6437 / Avg. batch time: 496.9252 (ms) / GPU bubble ratio: 16.78%
[rank1]:2025-12-01 02:11:35,321 - INFO - Avg. fwd time: 10.2071 / Avg. bwd time: 20.8396 / Avg. batch time: 564.7496 (ms) / GPU bubble ratio: 56.02%
[rank2]:2025-12-01 02:11:35,290 - INFO - Avg. fwd time: 7.8537 / Avg. bwd time: 17.5221 / Avg. batch time: 527.4947 (ms) / GPU bubble ratio: 61.52%
[rank0]:2025-12-01 02:11:35,350 - INFO - Avg. fwd time: 8.4565 / Avg. bwd time: 14.8558 / Avg. batch time: 597.4396 (ms) / GPU bubble ratio: 68.78%
[rank0]:2025-12-01 02:13:31,270 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 02:13:36,066 - INFO - Avg. fwd time: 14.0553 / Avg. bwd time: 37.5798 / Avg. batch time: 496.5034 (ms) / GPU bubble ratio: 16.80%
[rank2]:2025-12-01 02:13:36,094 - INFO - Avg. fwd time: 7.8571 / Avg. bwd time: 17.4989 / Avg. batch time: 527.0480 (ms) / GPU bubble ratio: 61.51%
[rank3]:2025-12-01 02:13:36,190 - INFO -  step: 550  loss:  0.2237  grad_norm:  0.0739  memory: 17.37GiB(36.56%)  tps: 6,801  tflops: 53.17  mfu: 17.04%
[rank1]:2025-12-01 02:13:36,126 - INFO - Avg. fwd time: 10.2124 / Avg. bwd time: 20.7928 / Avg. batch time: 564.2780 (ms) / GPU bubble ratio: 56.04%
[rank1]:2025-12-01 02:13:36,180 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0739  memory:  9.36GiB(19.71%)  tps: 6,801  tflops: 53.17  mfu: 17.04%
[rank2]:2025-12-01 02:13:36,177 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0739  memory:  6.51GiB(13.70%)  tps: 6,801  tflops: 53.17  mfu: 17.04%
[rank0]:2025-12-01 02:13:36,155 - INFO - Avg. fwd time: 8.4647 / Avg. bwd time: 14.7243 / Avg. batch time: 596.9270 (ms) / GPU bubble ratio: 68.92%
[rank0]:2025-12-01 02:13:36,191 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0739  memory: 13.23GiB(27.85%)  tps: 6,801  tflops: 53.17  mfu: 17.04%
[rank3]:2025-12-01 02:15:37,588 - INFO - Avg. fwd time: 14.0582 / Avg. bwd time: 37.5443 / Avg. batch time: 496.2695 (ms) / GPU bubble ratio: 16.82%
[rank2]:2025-12-01 02:15:37,616 - INFO - Avg. fwd time: 7.8603 / Avg. bwd time: 17.4778 / Avg. batch time: 526.7912 (ms) / GPU bubble ratio: 61.52%
[rank1]:2025-12-01 02:15:37,648 - INFO - Avg. fwd time: 10.2170 / Avg. bwd time: 20.7502 / Avg. batch time: 564.0014 (ms) / GPU bubble ratio: 56.08%
[rank0]:2025-12-01 02:15:37,678 - INFO - Avg. fwd time: 8.4723 / Avg. bwd time: 14.5970 / Avg. batch time: 596.6140 (ms) / GPU bubble ratio: 69.07%
[rank0]:2025-12-01 02:17:34,309 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 02:17:39,150 - INFO - Avg. fwd time: 14.0605 / Avg. bwd time: 37.5142 / Avg. batch time: 496.0694 (ms) / GPU bubble ratio: 16.83%
[rank1]:2025-12-01 02:17:39,211 - INFO - Avg. fwd time: 10.2211 / Avg. bwd time: 20.7111 / Avg. batch time: 563.7635 (ms) / GPU bubble ratio: 56.11%
[rank2]:2025-12-01 02:17:39,179 - INFO - Avg. fwd time: 7.8634 / Avg. bwd time: 17.4584 / Avg. batch time: 526.5708 (ms) / GPU bubble ratio: 61.53%
[rank0]:2025-12-01 02:17:39,241 - INFO - Avg. fwd time: 8.4793 / Avg. bwd time: 14.4883 / Avg. batch time: 596.3422 (ms) / GPU bubble ratio: 69.19%
[rank0]:2025-12-01 02:17:39,278 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.1015  memory: 13.23GiB(27.85%)  tps: 6,740  tflops: 52.69  mfu: 16.89%
[rank3]:2025-12-01 02:17:39,275 - INFO -  step: 600  loss:  0.2200  grad_norm:  0.1015  memory: 17.37GiB(36.56%)  tps: 6,740  tflops: 52.69  mfu: 16.89%
[rank1]:2025-12-01 02:17:39,266 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.1015  memory:  9.36GiB(19.71%)  tps: 6,740  tflops: 52.69  mfu: 16.89%
[rank1]:2025-12-01 02:17:39,327 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0217_stage1_step600.svg
[rank2]:2025-12-01 02:17:39,263 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.1015  memory:  6.51GiB(13.70%)  tps: 6,740  tflops: 52.69  mfu: 16.89%
[rank2]:2025-12-01 02:17:39,327 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0217_stage2_step600.svg
[rank0]:2025-12-01 02:17:39,327 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0217_stage0_step600.svg
[rank3]:2025-12-01 02:17:39,413 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0217_real_step600_rank3.svg
[rank3]:			> Batch Time: 589.97 ms, GPU Bubble Ratio: 71.90%, 59.12%, 66.17%, 30.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  128-0-128ms    | [S0,MB4,F]  128-8-137ms    | [S0,MB1,B]  193-0-193ms    | [S0,MB5,F]  193-6-200ms    | [S0,MB2,B]  271-0-271ms    | [S0,MB6,F]  271-6-278ms    | [S0,MB3,B]  353-0-353ms    | [S0,MB7,F]  353-6-360ms    | [S0,MB4,B]  418-26-444ms   | [S0,MB5,B]  469-25-495ms   | [S0,MB6,B]  528-25-553ms   | [S0,MB7,B]  571-18-589ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  111-11-123ms   | [S1,MB3,F]  126-11-138ms   | [S1,MB1,B]  176-11-188ms   | [S1,MB4,F]  192-8-201ms    | [S1,MB2,B]  254-11-266ms   | [S1,MB5,F]  269-8-278ms    | [S1,MB3,B]  323-25-348ms   | [S1,MB6,F]  352-9-361ms    | [S1,MB4,B]  386-25-411ms   | [S1,MB7,F]  417-9-426ms    | [S1,MB5,B]  440-25-465ms   | [S1,MB6,B]  498-25-523ms   | [S1,MB7,B]  546-21-568ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  97-9-106ms     | [S2,MB2,F]  110-9-119ms    | [S2,MB1,B]  162-9-171ms    | [S2,MB3,F]  175-7-182ms    | [S2,MB2,B]  229-20-249ms   | [S2,MB4,F]  253-7-260ms    | [S2,MB3,B]  298-20-318ms   | [S2,MB5,F]  321-7-328ms    | [S2,MB4,B]  360-19-380ms   | [S2,MB6,F]  384-7-391ms    | [S2,MB5,B]  414-20-435ms   | [S2,MB7,F]  438-7-445ms    | [S2,MB6,B]  475-20-495ms   | [S2,MB7,B]  525-17-542ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-40-92ms     | [S3,MB1,F]  95-11-107ms    | [S3,MB1,B]  114-43-157ms   | [S3,MB2,F]  160-12-173ms   | [S3,MB2,B]  180-44-224ms   | [S3,MB3,F]  227-13-240ms   | [S3,MB3,B]  248-44-292ms   | [S3,MB4,F]  296-13-310ms   | [S3,MB4,B]  317-39-356ms   | [S3,MB5,F]  359-17-377ms   | [S3,MB5,B]  384-23-407ms   | [S3,MB6,F]  413-11-425ms   | [S3,MB6,B]  432-37-470ms   | [S3,MB7,F]  473-17-491ms   | [S3,MB7,B]  498-23-521ms  
[rank3]:2025-12-01 02:17:39,457 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0217_stage3_step600.svg
[rank1]:2025-12-01 02:19:39,876 - INFO - Avg. fwd time: 10.2255 / Avg. bwd time: 20.6756 / Avg. batch time: 563.3567 (ms) / GPU bubble ratio: 56.12%
[rank3]:2025-12-01 02:19:39,815 - INFO - Avg. fwd time: 14.0673 / Avg. bwd time: 37.4552 / Avg. batch time: 495.6787 (ms) / GPU bubble ratio: 16.85%
[rank2]:2025-12-01 02:19:39,844 - INFO - Avg. fwd time: 7.8662 / Avg. bwd time: 17.4407 / Avg. batch time: 526.1804 (ms) / GPU bubble ratio: 61.52%
[rank0]:2025-12-01 02:19:39,907 - INFO - Avg. fwd time: 8.4854 / Avg. bwd time: 14.3878 / Avg. batch time: 595.9039 (ms) / GPU bubble ratio: 69.29%
[rank0]:2025-12-01 02:21:35,020 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 02:21:39,737 - INFO - Avg. fwd time: 7.8687 / Avg. bwd time: 17.4245 / Avg. batch time: 525.6776 (ms) / GPU bubble ratio: 61.51%
[rank3]:2025-12-01 02:21:39,708 - INFO - Avg. fwd time: 14.0769 / Avg. bwd time: 37.3824 / Avg. batch time: 495.1973 (ms) / GPU bubble ratio: 16.87%
[rank0]:2025-12-01 02:21:39,800 - INFO - Avg. fwd time: 8.4914 / Avg. bwd time: 14.2945 / Avg. batch time: 595.3582 (ms) / GPU bubble ratio: 69.38%
[rank2]:2025-12-01 02:21:39,822 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0759  memory:  6.51GiB(13.70%)  tps: 6,811  tflops: 53.24  mfu: 17.07%
[rank1]:2025-12-01 02:21:39,770 - INFO - Avg. fwd time: 10.2302 / Avg. bwd time: 20.6435 / Avg. batch time: 562.8394 (ms) / GPU bubble ratio: 56.12%
[rank1]:2025-12-01 02:21:39,826 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0759  memory:  9.36GiB(19.71%)  tps: 6,811  tflops: 53.24  mfu: 17.07%
[rank3]:2025-12-01 02:21:39,834 - INFO -  step: 650  loss:  0.2309  grad_norm:  0.0759  memory: 17.37GiB(36.56%)  tps: 6,811  tflops: 53.24  mfu: 17.07%
[rank0]:2025-12-01 02:21:39,836 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0759  memory: 13.23GiB(27.85%)  tps: 6,811  tflops: 53.24  mfu: 17.07%
[rank3]:2025-12-01 02:23:39,596 - INFO - Avg. fwd time: 14.0826 / Avg. bwd time: 37.3197 / Avg. batch time: 494.7653 (ms) / GPU bubble ratio: 16.89%
[rank2]:2025-12-01 02:23:39,625 - INFO - Avg. fwd time: 7.8708 / Avg. bwd time: 17.4088 / Avg. batch time: 525.2253 (ms) / GPU bubble ratio: 61.50%
[rank1]:2025-12-01 02:23:39,659 - INFO - Avg. fwd time: 10.2339 / Avg. bwd time: 20.6127 / Avg. batch time: 562.3726 (ms) / GPU bubble ratio: 56.12%
[rank0]:2025-12-01 02:23:39,690 - INFO - Avg. fwd time: 8.4967 / Avg. bwd time: 14.2084 / Avg. batch time: 594.8637 (ms) / GPU bubble ratio: 69.47%
[rank0]:2025-12-01 02:25:34,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-01 02:25:39,481 - INFO - Avg. fwd time: 10.2366 / Avg. bwd time: 20.5837 / Avg. batch time: 561.9311 (ms) / GPU bubble ratio: 56.12%
[rank3]:2025-12-01 02:25:39,418 - INFO - Avg. fwd time: 14.0865 / Avg. bwd time: 37.2622 / Avg. batch time: 494.3547 (ms) / GPU bubble ratio: 16.90%
[rank0]:2025-12-01 02:25:39,512 - INFO - Avg. fwd time: 8.5015 / Avg. bwd time: 14.1280 / Avg. batch time: 594.3963 (ms) / GPU bubble ratio: 69.54%
[rank2]:2025-12-01 02:25:39,448 - INFO - Avg. fwd time: 7.8728 / Avg. bwd time: 17.3943 / Avg. batch time: 524.7968 (ms) / GPU bubble ratio: 61.48%
[rank1]:2025-12-01 02:25:39,537 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0773  memory:  9.36GiB(19.71%)  tps: 6,835  tflops: 53.43  mfu: 17.13%
[rank3]:2025-12-01 02:25:39,546 - INFO -  step: 700  loss:  0.1903  grad_norm:  0.0773  memory: 17.37GiB(36.56%)  tps: 6,835  tflops: 53.43  mfu: 17.13%
[rank0]:2025-12-01 02:25:39,548 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0773  memory: 13.23GiB(27.85%)  tps: 6,835  tflops: 53.43  mfu: 17.13%
[rank0]:2025-12-01 02:25:39,600 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0225_stage0_step700.svg
[rank2]:2025-12-01 02:25:39,534 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0773  memory:  6.51GiB(13.70%)  tps: 6,835  tflops: 53.43  mfu: 17.13%
[rank2]:2025-12-01 02:25:39,601 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0225_stage2_step700.svg
[rank1]:2025-12-01 02:25:39,607 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0225_stage1_step700.svg
[rank3]:2025-12-01 02:25:39,685 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0225_real_step700_rank3.svg
[rank3]:			> Batch Time: 589.48 ms, GPU Bubble Ratio: 71.90%, 59.10%, 66.11%, 31.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  127-0-127ms    | [S0,MB4,F]  127-8-136ms    | [S0,MB1,B]  192-0-192ms    | [S0,MB5,F]  192-6-199ms    | [S0,MB2,B]  270-0-270ms    | [S0,MB6,F]  270-6-277ms    | [S0,MB3,B]  351-0-351ms    | [S0,MB7,F]  351-6-358ms    | [S0,MB4,B]  418-26-444ms   | [S0,MB5,B]  467-25-493ms   | [S0,MB6,B]  526-25-551ms   | [S0,MB7,B]  570-18-589ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  110-11-122ms   | [S1,MB3,F]  125-11-136ms   | [S1,MB1,B]  175-11-187ms   | [S1,MB4,F]  190-9-199ms    | [S1,MB2,B]  253-11-265ms   | [S1,MB5,F]  268-8-277ms    | [S1,MB3,B]  321-25-346ms   | [S1,MB6,F]  350-9-359ms    | [S1,MB4,B]  385-25-410ms   | [S1,MB7,F]  416-9-426ms    | [S1,MB5,B]  438-25-464ms   | [S1,MB6,B]  496-25-522ms   | [S1,MB7,B]  545-22-567ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  95-9-105ms     | [S2,MB2,F]  108-9-117ms    | [S2,MB1,B]  161-9-170ms    | [S2,MB3,F]  174-7-181ms    | [S2,MB2,B]  228-20-248ms   | [S2,MB4,F]  252-7-259ms    | [S2,MB3,B]  295-20-315ms   | [S2,MB5,F]  319-7-326ms    | [S2,MB4,B]  360-19-380ms   | [S2,MB6,F]  383-7-390ms    | [S2,MB5,B]  413-20-433ms   | [S2,MB7,F]  436-7-444ms    | [S2,MB6,B]  473-20-493ms   | [S2,MB7,B]  524-17-542ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-39-90ms     | [S3,MB1,F]  94-11-105ms    | [S3,MB1,B]  113-43-156ms   | [S3,MB2,F]  159-12-171ms   | [S3,MB2,B]  179-44-223ms   | [S3,MB3,F]  226-13-239ms   | [S3,MB3,B]  247-43-291ms   | [S3,MB4,F]  294-13-308ms   | [S3,MB4,B]  315-39-355ms   | [S3,MB5,F]  358-17-375ms   | [S3,MB5,B]  383-23-406ms   | [S3,MB6,F]  412-11-423ms   | [S3,MB6,B]  430-37-468ms   | [S3,MB7,F]  471-18-490ms   | [S3,MB7,B]  497-23-520ms  
[rank3]:2025-12-01 02:25:39,738 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0225_stage3_step700.svg
[rank3]:2025-12-01 02:27:40,131 - INFO - Avg. fwd time: 14.0889 / Avg. bwd time: 37.2235 / Avg. batch time: 494.0810 (ms) / GPU bubble ratio: 16.92%
[rank2]:2025-12-01 02:27:40,161 - INFO - Avg. fwd time: 7.8745 / Avg. bwd time: 17.3806 / Avg. batch time: 524.5274 (ms) / GPU bubble ratio: 61.48%
[rank1]:2025-12-01 02:27:40,195 - INFO - Avg. fwd time: 10.2392 / Avg. bwd time: 20.5568 / Avg. batch time: 561.6483 (ms) / GPU bubble ratio: 56.13%
[rank0]:2025-12-01 02:27:40,226 - INFO - Avg. fwd time: 8.5057 / Avg. bwd time: 14.0537 / Avg. batch time: 594.0891 (ms) / GPU bubble ratio: 69.62%
[rank0]:2025-12-01 02:29:37,011 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 02:29:41,795 - INFO - Avg. fwd time: 14.0907 / Avg. bwd time: 37.2105 / Avg. batch time: 494.0100 (ms) / GPU bubble ratio: 16.92%
[rank2]:2025-12-01 02:29:41,825 - INFO - Avg. fwd time: 7.8766 / Avg. bwd time: 17.3681 / Avg. batch time: 524.4404 (ms) / GPU bubble ratio: 61.49%
[rank1]:2025-12-01 02:29:41,859 - INFO - Avg. fwd time: 10.2416 / Avg. bwd time: 20.5317 / Avg. batch time: 561.5500 (ms) / GPU bubble ratio: 56.16%
[rank3]:2025-12-01 02:29:41,924 - INFO -  step: 750  loss:  0.2293  grad_norm:  0.0919  memory: 17.37GiB(36.56%)  tps: 6,760  tflops: 52.84  mfu: 16.94%
[rank2]:2025-12-01 02:29:41,912 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0919  memory:  6.51GiB(13.70%)  tps: 6,760  tflops: 52.84  mfu: 16.94%
[rank0]:2025-12-01 02:29:41,890 - INFO - Avg. fwd time: 8.5095 / Avg. bwd time: 13.9840 / Avg. batch time: 593.9671 (ms) / GPU bubble ratio: 69.70%
[rank0]:2025-12-01 02:29:41,926 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0919  memory: 13.23GiB(27.85%)  tps: 6,760  tflops: 52.84  mfu: 16.94%
[rank1]:2025-12-01 02:29:41,916 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0919  memory:  9.36GiB(19.71%)  tps: 6,760  tflops: 52.84  mfu: 16.94%
[rank3]:2025-12-01 02:31:42,746 - INFO - Avg. fwd time: 14.0920 / Avg. bwd time: 37.1859 / Avg. batch time: 493.8389 (ms) / GPU bubble ratio: 16.93%
[rank2]:2025-12-01 02:31:42,776 - INFO - Avg. fwd time: 7.8784 / Avg. bwd time: 17.3563 / Avg. batch time: 524.2552 (ms) / GPU bubble ratio: 61.49%
[rank1]:2025-12-01 02:31:42,811 - INFO - Avg. fwd time: 10.2439 / Avg. bwd time: 20.5081 / Avg. batch time: 561.3540 (ms) / GPU bubble ratio: 56.17%
[rank0]:2025-12-01 02:31:42,843 - INFO - Avg. fwd time: 8.5130 / Avg. bwd time: 13.9194 / Avg. batch time: 593.7484 (ms) / GPU bubble ratio: 69.78%
[rank0]:2025-12-01 02:33:38,092 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 02:33:42,836 - INFO - Avg. fwd time: 14.0974 / Avg. bwd time: 37.1417 / Avg. batch time: 493.5454 (ms) / GPU bubble ratio: 16.95%
[rank1]:2025-12-01 02:33:42,901 - INFO - Avg. fwd time: 10.2467 / Avg. bwd time: 20.4863 / Avg. batch time: 561.0364 (ms) / GPU bubble ratio: 56.18%
[rank2]:2025-12-01 02:33:42,867 - INFO - Avg. fwd time: 7.8802 / Avg. bwd time: 17.3453 / Avg. batch time: 523.9464 (ms) / GPU bubble ratio: 61.48%
[rank0]:2025-12-01 02:33:42,934 - INFO - Avg. fwd time: 8.5164 / Avg. bwd time: 13.8590 / Avg. batch time: 593.4106 (ms) / GPU bubble ratio: 69.83%
[rank1]:2025-12-01 02:33:42,959 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0786  memory:  9.36GiB(19.71%)  tps: 6,797  tflops: 53.14  mfu: 17.03%
[rank1]:2025-12-01 02:33:42,959 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0786  tps: 7,115  tflops: 55.62  mfu: 16.27%
[rank1]:2025-12-01 02:33:42,959 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-01 02:33:42,960 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-01 02:33:42,968 - INFO -  step: 800  loss:  0.2337  grad_norm:  0.0786  memory: 17.37GiB(36.56%)  tps: 6,797  tflops: 53.14  mfu: 17.03%
[rank3]:2025-12-01 02:33:42,968 - INFO -  final step: 800  loss:  0.2337  grad_norm:  0.0786  tps: 7,120  tflops: 55.66  mfu: 16.43%
[rank3]:2025-12-01 02:33:42,969 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-01 02:33:42,970 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-01 02:33:42,955 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0786  memory:  6.51GiB(13.70%)  tps: 6,797  tflops: 53.14  mfu: 17.03%
[rank2]:2025-12-01 02:33:42,956 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0786  tps: 7,116  tflops: 55.63  mfu: 16.29%
[rank2]:2025-12-01 02:33:42,956 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-01 02:33:42,956 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-01 02:33:42,970 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0786  memory: 13.23GiB(27.85%)  tps: 6,797  tflops: 53.14  mfu: 17.03%
[rank0]:2025-12-01 02:33:42,970 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0786  tps: 7,115  tflops: 55.62  mfu: 16.28%
[rank0]:2025-12-01 02:33:42,970 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-01 02:33:42,971 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-01 02:33:44,962 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-01 02:33:45,036 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251201_0233_stage1_final800.svg
[rank2]:2025-12-01 02:33:45,036 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251201_0233_stage2_final800.svg
[rank0]:2025-12-01 02:33:45,035 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251201_0233_stage0_final800.svg
[rank3]:2025-12-01 02:33:45,117 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0233_real_final800_rank3.svg
[rank3]:			> Batch Time: 587.50 ms, GPU Bubble Ratio: 71.82%, 58.89%, 65.97%, 30.99%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  125-0-125ms    | [S0,MB4,F]  126-8-134ms    | [S0,MB1,B]  191-0-191ms    | [S0,MB5,F]  191-6-198ms    | [S0,MB2,B]  269-0-269ms    | [S0,MB6,F]  269-6-276ms    | [S0,MB3,B]  349-0-349ms    | [S0,MB7,F]  351-6-357ms    | [S0,MB4,B]  415-26-441ms   | [S0,MB5,B]  465-25-491ms   | [S0,MB6,B]  524-25-550ms   | [S0,MB7,B]  568-19-587ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  108-11-120ms   | [S1,MB3,F]  124-11-135ms   | [S1,MB1,B]  174-11-185ms   | [S1,MB4,F]  189-9-198ms    | [S1,MB2,B]  251-11-263ms   | [S1,MB5,F]  267-9-276ms    | [S1,MB3,B]  319-25-344ms   | [S1,MB6,F]  348-9-357ms    | [S1,MB4,B]  383-25-408ms   | [S1,MB7,F]  413-9-423ms    | [S1,MB5,B]  436-25-462ms   | [S1,MB6,B]  495-25-520ms   | [S1,MB7,B]  543-22-565ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  93-9-103ms     | [S2,MB2,F]  106-9-116ms    | [S2,MB1,B]  159-9-168ms    | [S2,MB3,F]  172-7-179ms    | [S2,MB2,B]  226-20-246ms   | [S2,MB4,F]  250-7-257ms    | [S2,MB3,B]  294-20-314ms   | [S2,MB5,F]  317-7-325ms    | [S2,MB4,B]  358-20-378ms   | [S2,MB6,F]  381-7-388ms    | [S2,MB5,B]  411-20-431ms   | [S2,MB7,F]  435-7-442ms    | [S2,MB6,B]  472-20-492ms   | [S2,MB7,B]  522-17-539ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-37-88ms     | [S3,MB1,F]  92-11-104ms    | [S3,MB1,B]  111-43-154ms   | [S3,MB2,F]  158-11-169ms   | [S3,MB2,B]  177-44-221ms   | [S3,MB3,F]  224-13-238ms   | [S3,MB3,B]  245-44-289ms   | [S3,MB4,F]  292-13-306ms   | [S3,MB4,B]  313-39-352ms   | [S3,MB5,F]  356-17-373ms   | [S3,MB5,B]  380-23-404ms   | [S3,MB6,F]  410-11-422ms   | [S3,MB6,B]  428-38-467ms   | [S3,MB7,F]  470-17-488ms   | [S3,MB7,B]  495-23-518ms  
[rank1]:2025-12-01 02:33:45,189 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251201_0233_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank3]:2025-12-01 02:33:45,248 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251201_0233_thry_final800_rank3.svg
[rank3]:			> Batch Time: 337.03 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB0,B]  102-20-122ms   | [S0,MB4,F]  122-10-132ms   | [S0,MB1,B]  132-20-153ms   | [S0,MB5,F]  153-10-163ms   | [S0,MB2,B]  163-20-183ms   | [S0,MB6,F]  183-10-194ms   | [S0,MB3,B]  194-20-214ms   | [S0,MB7,F]  214-10-224ms   | [S0,MB4,B]  224-20-245ms   | [S0,MB5,B]  255-20-275ms   | [S0,MB6,B]  285-20-306ms   | [S0,MB7,B]  316-20-337ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB0,B]  81-20-102ms    | [S1,MB3,F]  102-10-112ms   | [S1,MB1,B]  112-20-132ms   | [S1,MB4,F]  132-10-142ms   | [S1,MB2,B]  142-20-163ms   | [S1,MB5,F]  163-10-173ms   | [S1,MB3,B]  173-20-194ms   | [S1,MB6,F]  194-10-204ms   | [S1,MB4,B]  204-20-224ms   | [S1,MB7,F]  224-10-234ms   | [S1,MB5,B]  234-20-255ms   | [S1,MB6,B]  265-20-285ms   | [S1,MB7,B]  296-20-316ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB0,B]  61-20-81ms     | [S2,MB2,F]  81-10-91ms     | [S2,MB1,B]  91-20-112ms    | [S2,MB3,F]  112-10-122ms   | [S2,MB2,B]  122-20-142ms   | [S2,MB4,F]  142-10-153ms   | [S2,MB3,B]  153-20-173ms   | [S2,MB5,F]  173-10-183ms   | [S2,MB4,B]  183-20-204ms   | [S2,MB6,F]  204-10-214ms   | [S2,MB5,B]  214-20-234ms   | [S2,MB7,F]  234-10-245ms   | [S2,MB6,B]  245-20-265ms   | [S2,MB7,B]  275-20-296ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB0,B]  40-20-61ms     | [S3,MB1,F]  61-10-71ms     | [S3,MB1,B]  71-20-91ms     | [S3,MB2,F]  91-10-102ms    | [S3,MB2,B]  102-20-122ms   | [S3,MB3,F]  122-10-132ms   | [S3,MB3,B]  132-20-153ms   | [S3,MB4,F]  153-10-163ms   | [S3,MB4,B]  163-20-183ms   | [S3,MB5,F]  183-10-194ms   | [S3,MB5,B]  194-20-214ms   | [S3,MB6,F]  214-10-224ms   | [S3,MB6,B]  224-20-245ms   | [S3,MB7,F]  245-10-255ms   | [S3,MB7,B]  255-20-275ms  
[rank2]:2025-12-01 02:33:45,196 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251201_0233_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank0]:2025-12-01 02:33:45,188 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251201_0233_rank0_stage0.svg
[rank0]:	> Counts Sum: 228960, Total Sum: 1728640 (13.25%), Ratio(%) per element: [14.38, 14.21, 13.35, 13.86, 13.52, 13.52, 14.04, 14.21, 14.04, 13.69, 13.01, 13.86, 13.35, 13.52, 13.86, 13.18, 12.84, 13.52, 13.52, 12.67, 13.18, 12.67, 13.18, 12.5, 13.18, 13.01, 13.01, 13.18, 12.84, 13.18, 12.5, 12.5, 12.15, 13.01, 12.84, 12.5, 12.32]
[rank3]:2025-12-01 02:33:45,295 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251201_0233_stage3_final800.svg
[rank3]:2025-12-01 02:33:45,429 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251201_0233_rank3_stage3.svg
[rank3]:	> Counts Sum: 396240, Total Sum: 1354880 (29.25%), Ratio(%) per element: [29.28, 29.96, 28.76, 29.45, 29.1, 29.79, 28.76, 28.42, 30.82, 28.25, 30.65, 28.42, 30.65, 27.73, 29.62, 29.1, 29.1, 29.28, 28.42, 29.79, 30.65, 29.45, 28.25, 29.62, 28.42, 28.76, 29.62, 28.42, 29.45]
[rank1]:2025-12-01 02:33:47,062 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251201_0233_stage1.svg
[rank1]:2025-12-01 02:33:47,065 - INFO - Destroying the purge thread.
[rank2]:2025-12-01 02:33:47,058 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251201_0233_stage2.svg
[rank2]:2025-12-01 02:33:47,061 - INFO - Destroying the purge thread.
[rank2]:2025-12-01 02:33:47,144 - INFO - Process group destroyed
[rank0]:2025-12-01 02:33:47,092 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251201_0233_stage0.svg
[rank0]:2025-12-01 02:33:47,095 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-01 02:33:47,179 - INFO - Process group destroyed
[rank3]:2025-12-01 02:33:47,335 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251201_0233_stage3.svg
[rank3]:2025-12-01 02:33:47,339 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 335-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.60241
[rank3]:wandb:               final/avg_loss 0.23367
[rank3]:wandb:             final/avg_mfu(%) 16.42556
[rank3]:wandb:             final/avg_tflops 55.65894
[rank3]:wandb:    final/avg_throughput(tps) 7119.75105
[rank3]:wandb:              final/grad_norm 0.07863
[rank3]:wandb:               final/max_loss 0.23367
[rank3]:wandb:                    grad_norm 0.07863
[rank3]:wandb: loss_metrics/global_avg_loss 0.23367
[rank3]:wandb: loss_metrics/global_max_loss 0.23367
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.3_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/l32fdy29
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.3_42_dm1/20251201-0128/wandb/run-20251201_012829-l32fdy29/logs
[rank3]:2025-12-01 02:33:48,695 - INFO - Process group destroyed
[rank0]:2025-12-01 02:33:49,096 - INFO - Training completed
[rank0]:2025-12-01 02:33:49,096 - INFO - Destroying the purge thread.
[rank0]:2025-12-01 02:33:49,188 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.8', 'layers.4', 'layers.6'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.2', 'layers.0', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'output', 'layers.13', 'layers.14'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.3
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
