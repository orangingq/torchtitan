
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 23. (í™”) 20:11:00 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1223_1F1B_fullrand7_mfr0.8_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.8) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-23 20:11:07,245 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank0]:"
[rank1]:2025-12-23 20:11:07,245 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank1]:"
[rank2]:2025-12-23 20:11:07,342 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank2]:"
[rank3]:2025-12-23 20:11:07,459 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank0]:2025-12-23 20:11:07,486 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-23 20:11:07,488 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 20:11:07,490 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-23 20:11:07,491 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-23 20:11:07,481 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-23 20:11:07,483 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-23 20:11:07,547 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-23 20:11:07,550 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-23 20:11:07,633 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-23 20:11:07,636 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-23 20:11:07,878 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-23 20:11:11,036 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-23 20:11:11,073 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-23 20:11:11,176 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-23 20:11:11,100 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-23 20:11:11,100 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-23 20:11:11,284 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-23 20:11:11,284 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-23 20:11:11,285 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-23 20:11:11,326 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-23 20:11:11,364 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-23 20:11:11,365 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-23 20:11:11,389 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-23 20:11:11,389 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-23 20:11:11,576 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-23 20:11:11,577 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-23 20:11:11,577 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 2ar7wbr9
[rank2]:2025-12-23 20:11:12,796 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-23 20:11:12,837 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-23 20:11:12,866 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-23 20:11:12,866 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-23 20:11:13,076 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-23 20:11:13,076 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-23 20:11:13,077 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.8_42_dm1/20251223-2011/wandb/run-20251223_201112-2ar7wbr9
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2ar7wbr9
[rank3]:2025-12-23 20:11:13,391 - WandB logging enabled
[rank3]:2025-12-23 20:11:13,391 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-23 20:11:13,431 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-23 20:11:13,459 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-23 20:11:13,459 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-23 20:11:13,664 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank0]:2025-12-23 20:11:13,664 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-23 20:11:13,664 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-23 20:11:13,665 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-23 20:11:13,647 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-23 20:11:13,647 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-23 20:11:13,648 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-23 20:11:13,664 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-23 20:11:13,664 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-23 20:11:13,664 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-23 20:11:15,616 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-23 20:11:15,616 - Finished loading the checkpoint in 1.95 seconds.
[rank0]:2025-12-23 20:11:15,616 - Training starts at step 1
[rank3]:2025-12-23 20:11:21,196 -  step:  1  loss: 10.6088  grad_norm: 116.5369  memory: 12.97GiB(27.31%)  tps: 4,221  tflops: 33.00  mfu: 10.58%
[rank3]:2025-12-23 20:11:21,197 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-23 20:11:21,188 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  7.10GiB(14.94%)  tps: 3,240  tflops: 25.33  mfu: 8.12%
[rank1]:2025-12-23 20:11:21,189 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-23 20:11:21,185 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  5.20GiB(10.94%)  tps: 3,925  tflops: 30.69  mfu: 9.84%
[rank2]:2025-12-23 20:11:21,185 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-23 20:11:21,226 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  9.62GiB(20.24%)  tps: 3,323  tflops: 25.97  mfu: 8.33%
[rank0]:2025-12-23 20:11:21,226 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-23 20:13:21,412 - Avg. fwd time: 12.5101 / Avg. bwd time: 40.9124 / Avg. batch time: 499.4393 (ms) / GPU bubble ratio: 14.43%
[rank2]:2025-12-23 20:13:21,437 - Avg. fwd time: 7.2590 / Avg. bwd time: 19.6229 / Avg. batch time: 532.0341 (ms) / GPU bubble ratio: 59.58%
[rank1]:2025-12-23 20:13:21,467 - Avg. fwd time: 9.4187 / Avg. bwd time: 25.0634 / Avg. batch time: 572.1760 (ms) / GPU bubble ratio: 51.79%
[rank0]:2025-12-23 20:13:21,497 - Avg. fwd time: 7.6147 / Avg. bwd time: 24.9609 / Avg. batch time: 610.8781 (ms) / GPU bubble ratio: 57.34%
[rank0]:2025-12-23 20:15:22,301 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 20:15:27,199 - Avg. fwd time: 12.6041 / Avg. bwd time: 41.0297 / Avg. batch time: 501.0293 (ms) / GPU bubble ratio: 14.36%
[rank2]:2025-12-23 20:15:27,224 - Avg. fwd time: 7.2538 / Avg. bwd time: 19.6553 / Avg. batch time: 533.2452 (ms) / GPU bubble ratio: 59.63%
[rank1]:2025-12-23 20:15:27,255 - Avg. fwd time: 9.4129 / Avg. bwd time: 25.1156 / Avg. batch time: 573.0604 (ms) / GPU bubble ratio: 51.80%
[rank1]:2025-12-23 20:15:27,310 -  step: 50  loss: -8.0000  grad_norm: 12.8488  memory:  9.50GiB(19.99%)  tps: 6,524  tflops: 51.00  mfu: 16.35%
[rank0]:2025-12-23 20:15:27,284 - Avg. fwd time: 7.6120 / Avg. bwd time: 24.9915 / Avg. batch time: 611.4269 (ms) / GPU bubble ratio: 57.34%
[rank0]:2025-12-23 20:15:27,321 -  step: 50  loss: -8.0000  grad_norm: 12.8488  memory: 13.42GiB(28.26%)  tps: 6,524  tflops: 51.01  mfu: 16.35%
[rank3]:2025-12-23 20:15:27,318 -  step: 50  loss:  9.9169  grad_norm: 12.8488  memory: 16.39GiB(34.50%)  tps: 6,524  tflops: 51.00  mfu: 16.35%
[rank2]:2025-12-23 20:15:27,306 -  step: 50  loss: -8.0000  grad_norm: 12.8488  memory:  6.98GiB(14.69%)  tps: 6,524  tflops: 51.00  mfu: 16.35%
[rank3]:2025-12-23 20:16:12,341 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-23 20:17:02,590 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-23 20:17:02,902 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-23 20:17:22,080 - Avg. fwd time: 7.2435 / Avg. bwd time: 18.7884 / Avg. batch time: 518.9173 (ms) / GPU bubble ratio: 59.87%
[rank3]:2025-12-23 20:17:22,066 - Avg. fwd time: 12.4829 / Avg. bwd time: 39.4901 / Avg. batch time: 487.7086 (ms) / GPU bubble ratio: 14.75%
[rank1]:2025-12-23 20:17:22,096 - Avg. fwd time: 9.3940 / Avg. bwd time: 24.0051 / Avg. batch time: 557.4886 (ms) / GPU bubble ratio: 52.07%
[rank0]:2025-12-23 20:17:22,101 - Avg. fwd time: 7.6047 / Avg. bwd time: 23.0043 / Avg. batch time: 593.7388 (ms) / GPU bubble ratio: 58.76%
[rank3]:2025-12-23 20:17:34,652 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-23 20:17:35,002 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2017_max_batch_time.svg
[rank3]:			> Batch Time: 530.66 ms, GPU Bubble Ratio: 50.54%, 47.69%, 59.18%, 18.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-25-153ms   | [S0,MB4,F]  153-7-160ms    | [S0,MB1,B]  179-25-204ms   | [S0,MB5,F]  204-7-211ms    | [S0,MB2,B]  231-25-257ms   | [S0,MB6,F]  257-7-264ms    | [S0,MB3,B]  286-25-311ms   | [S0,MB7,F]  311-7-318ms    | [S0,MB4,B]  340-25-365ms   | [S0,MB5,B]  395-25-420ms   | [S0,MB6,B]  450-25-475ms   | [S0,MB7,B]  505-25-530ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  153-25-179ms   | [S1,MB4,F]  179-9-188ms    | [S1,MB2,B]  206-25-231ms   | [S1,MB5,F]  231-9-241ms    | [S1,MB3,B]  261-25-286ms   | [S1,MB6,F]  286-9-295ms    | [S1,MB4,B]  315-25-340ms   | [S1,MB7,F]  340-9-349ms    | [S1,MB5,B]  370-25-395ms   | [S1,MB6,B]  425-25-450ms   | [S1,MB7,B]  480-25-505ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  186-19-206ms   | [S2,MB4,F]  206-7-213ms    | [S2,MB3,B]  241-19-261ms   | [S2,MB5,F]  261-7-268ms    | [S2,MB4,B]  295-19-315ms   | [S2,MB6,F]  315-7-322ms    | [S2,MB5,B]  350-19-370ms   | [S2,MB7,F]  370-7-377ms    | [S2,MB6,B]  405-19-425ms   | [S2,MB7,B]  460-19-480ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-11-145ms   | [S3,MB2,B]  145-41-186ms   AFR(10):0.9655 | [S3,MB3,F]  186-12-199ms   | [S3,MB3,B]  199-41-241ms   AFR(10):0.9655 | [S3,MB4,F]  241-12-253ms   | [S3,MB4,B]  253-41-295ms   AFR(10):0.9655 | [S3,MB5,F]  295-13-308ms   | [S3,MB5,B]  308-41-350ms   AFR(10):0.9655 | [S3,MB6,F]  350-13-363ms   | [S3,MB6,B]  363-41-405ms   AFR(10):0.9655 | [S3,MB7,F]  405-13-418ms   | [S3,MB7,B]  418-41-460ms   AFR(10):0.9655
[rank3]:2025-12-23 20:17:35,126 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2017_min_batch_time.svg
[rank3]:			> Batch Time: 319.93 ms, GPU Bubble Ratio: 80.93%, 49.18%, 60.46%, 15.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  82-0-82ms      | [S0,MB4,F]  82-7-89ms      | [S0,MB1,B]  114-0-114ms    | [S0,MB5,F]  114-7-121ms    | [S0,MB2,B]  147-0-147ms    | [S0,MB6,F]  147-7-154ms    | [S0,MB3,B]  181-0-181ms    | [S0,MB7,F]  181-7-188ms    | [S0,MB4,B]  215-0-215ms    | [S0,MB5,B]  250-0-250ms    | [S0,MB6,B]  284-0-284ms    | [S0,MB7,B]  319-0-319ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  71-10-82ms     | [S1,MB3,F]  82-9-91ms      | [S1,MB1,B]  103-10-114ms   | [S1,MB4,F]  114-9-123ms    | [S1,MB2,B]  136-10-147ms   | [S1,MB5,F]  147-9-156ms    | [S1,MB3,B]  170-11-181ms   | [S1,MB6,F]  181-9-190ms    | [S1,MB4,B]  204-10-215ms   | [S1,MB7,F]  215-9-224ms    | [S1,MB5,B]  239-11-250ms   | [S1,MB6,B]  273-10-284ms   | [S1,MB7,B]  309-10-319ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  63-8-71ms      | [S2,MB2,F]  71-7-78ms      | [S2,MB1,B]  95-8-103ms     | [S2,MB3,F]  103-7-110ms    | [S2,MB2,B]  127-8-136ms    | [S2,MB4,F]  136-7-143ms    | [S2,MB3,B]  161-8-170ms    | [S2,MB5,F]  170-7-177ms    | [S2,MB4,B]  196-8-204ms    | [S2,MB6,F]  204-7-211ms    | [S2,MB5,B]  230-8-239ms    | [S2,MB7,F]  239-7-246ms    | [S2,MB6,B]  265-8-273ms    | [S2,MB7,B]  300-8-309ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-20-63ms     AFR(10):0.9655 | [S3,MB1,F]  63-10-74ms     | [S3,MB1,B]  74-20-95ms     AFR(10):0.9655 | [S3,MB2,F]  95-11-106ms    | [S3,MB2,B]  106-20-127ms   AFR(10):0.9655 | [S3,MB3,F]  127-12-140ms   | [S3,MB3,B]  140-21-161ms   AFR(10):0.9655 | [S3,MB4,F]  161-12-174ms   | [S3,MB4,B]  174-22-196ms   AFR(10):0.9655 | [S3,MB5,F]  196-13-209ms   | [S3,MB5,B]  209-21-230ms   AFR(10):0.9655 | [S3,MB6,F]  230-13-243ms   | [S3,MB6,B]  243-21-265ms   AFR(10):0.9655 | [S3,MB7,F]  265-13-278ms   | [S3,MB7,B]  278-22-300ms   AFR(10):0.9655
[rank3]:2025-12-23 20:17:35,260 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2017_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 351.01 ms, GPU Bubble Ratio: 36.47%, 25.36%, 41.49%, 13.96%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-25-153ms   | [S0,MB4,F]  153-7-160ms    | [S0,MB1,B]  171-25-196ms   | [S0,MB5,F]  196-7-203ms    | [S0,MB2,B]  205-25-231ms   | [S0,MB6,F]  231-7-238ms    | [S0,MB3,B]  240-25-265ms   | [S0,MB7,F]  265-7-272ms    | [S0,MB4,B]  274-25-300ms   | [S0,MB5,B]  309-25-334ms   | [S0,MB6,B]  340-10-351ms   | [S0,MB7,B]  351-0-351ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  146-25-171ms   | [S1,MB4,F]  171-9-180ms    | [S1,MB2,B]  180-25-205ms   | [S1,MB5,F]  205-9-215ms    | [S1,MB3,B]  215-25-240ms   | [S1,MB6,F]  240-9-249ms    | [S1,MB4,B]  249-25-274ms   | [S1,MB7,F]  274-9-284ms    | [S1,MB5,B]  284-25-309ms   | [S1,MB6,B]  316-24-340ms   | [S1,MB7,B]  340-10-351ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  126-19-146ms   | [S2,MB3,F]  146-7-153ms    | [S2,MB2,B]  158-19-178ms   | [S2,MB4,F]  180-7-187ms    | [S2,MB3,B]  192-19-212ms   | [S2,MB5,F]  215-7-222ms    | [S2,MB4,B]  227-19-246ms   | [S2,MB6,F]  249-7-256ms    | [S2,MB5,B]  261-19-281ms   | [S2,MB7,F]  284-7-291ms    | [S2,MB6,B]  296-19-316ms   | [S2,MB7,B]  331-8-340ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-32-126ms    AFR(10):0.9655 | [S3,MB2,F]  126-11-137ms   | [S3,MB2,B]  137-20-158ms   AFR(10):0.9655 | [S3,MB3,F]  158-12-171ms   | [S3,MB3,B]  171-21-192ms   AFR(10):0.9655 | [S3,MB4,F]  192-12-205ms   | [S3,MB4,B]  205-22-227ms   AFR(10):0.9655 | [S3,MB5,F]  227-13-240ms   | [S3,MB5,B]  240-21-261ms   AFR(10):0.9655 | [S3,MB6,F]  261-13-274ms   | [S3,MB6,B]  274-21-296ms   AFR(10):0.9655 | [S3,MB7,F]  296-13-309ms   | [S3,MB7,B]  309-22-331ms   AFR(10):0.9655
[rank3]:2025-12-23 20:17:35,261 - 	> Batch Time: 351.01 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.34)
[rank3]:2025-12-23 20:18:56,830 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.10(0.13)/0.40, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-23 20:18:57,006 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-23 20:18:57,053 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-23 20:18:57,032 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.02(0.03)/0.08, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-23 20:18:57,054 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.16(0.19)/0.57, [MB7] 0.27(0.33)/1.00
[rank3]:2025-12-23 20:19:01,597 - Avg. fwd time: 12.3071 / Avg. bwd time: 37.0182 / Avg. batch time: 466.5091 (ms) / GPU bubble ratio: 15.41%
[rank2]:2025-12-23 20:19:01,619 - Avg. fwd time: 7.2434 / Avg. bwd time: 18.4312 / Avg. batch time: 496.4607 (ms) / GPU bubble ratio: 58.63%
[rank2]:2025-12-23 20:19:01,692 -  step: 100  loss: -8.0000  grad_norm:  7.2120  memory:  6.98GiB(14.69%)  tps: 7,642  tflops: 59.74  mfu: 19.15%
[rank3]:2025-12-23 20:19:01,704 -  step: 100  loss:  8.6608  grad_norm:  7.2120  memory: 16.39GiB(34.50%)  tps: 7,642  tflops: 59.74  mfu: 19.15%
[rank1]:2025-12-23 20:19:01,644 - Avg. fwd time: 9.4352 / Avg. bwd time: 23.6357 / Avg. batch time: 533.3566 (ms) / GPU bubble ratio: 50.40%
[rank1]:2025-12-23 20:19:01,695 -  step: 100  loss: -8.0000  grad_norm:  7.2120  memory:  9.50GiB(19.99%)  tps: 7,642  tflops: 59.75  mfu: 19.15%
[rank0]:2025-12-23 20:19:01,670 - Avg. fwd time: 7.6025 / Avg. bwd time: 21.8674 / Avg. batch time: 565.7805 (ms) / GPU bubble ratio: 58.33%
[rank0]:2025-12-23 20:19:01,706 -  step: 100  loss: -8.0000  grad_norm:  7.2120  memory: 13.42GiB(28.26%)  tps: 7,642  tflops: 59.74  mfu: 19.15%
[rank2]:2025-12-23 20:19:01,764 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2019_stage2_step100.svg
[rank1]:2025-12-23 20:19:01,764 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2019_stage1_step100.svg
[rank0]:2025-12-23 20:19:01,764 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2019_stage0_step100.svg
[rank2]:2025-12-23 20:19:01,865 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2019_stage2.svg
[rank3]:2025-12-23 20:19:01,847 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2019_step100_rank3.svg
[rank3]:			> Batch Time: 562.16 ms, GPU Bubble Ratio: 55.88%, 50.81%, 61.98%, 30.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-172ms   | [S0,MB4,F]  172-7-179ms    | [S0,MB1,B]  206-25-231ms   | [S0,MB5,F]  231-7-238ms    | [S0,MB2,B]  265-25-290ms   | [S0,MB6,F]  290-7-297ms    | [S0,MB3,B]  325-25-350ms   | [S0,MB7,F]  350-7-357ms    | [S0,MB4,B]  388-25-413ms   | [S0,MB5,B]  449-25-474ms   | [S0,MB6,B]  500-18-518ms   | [S0,MB7,B]  544-17-562ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  116-25-142ms   | [S1,MB3,F]  145-9-154ms    | [S1,MB1,B]  176-25-201ms   | [S1,MB4,F]  204-9-214ms    | [S1,MB2,B]  234-25-260ms   | [S1,MB5,F]  263-9-273ms    | [S1,MB3,B]  295-25-320ms   | [S1,MB6,F]  324-9-333ms    | [S1,MB4,B]  357-25-383ms   | [S1,MB7,F]  386-9-395ms    | [S1,MB5,B]  420-25-445ms   | [S1,MB6,B]  472-24-497ms   | [S1,MB7,B]  517-24-541ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-19-112ms    | [S2,MB2,F]  115-7-122ms    | [S2,MB1,B]  152-19-172ms   | [S2,MB3,F]  174-7-181ms    | [S2,MB2,B]  210-19-230ms   | [S2,MB4,F]  233-7-240ms    | [S2,MB3,B]  271-19-291ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB4,B]  334-19-354ms   | [S2,MB6,F]  356-7-363ms    | [S2,MB5,B]  396-19-416ms   | [S2,MB7,F]  418-7-425ms    | [S2,MB6,B]  449-20-469ms   | [S2,MB7,B]  497-16-514ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-39-147ms   | [S3,MB2,F]  150-11-162ms   | [S3,MB2,B]  168-37-206ms   | [S3,MB3,F]  209-12-221ms   | [S3,MB3,B]  228-37-266ms   | [S3,MB4,F]  269-12-282ms   | [S3,MB4,B]  289-39-328ms   | [S3,MB5,F]  332-12-345ms   | [S3,MB5,B]  352-39-392ms   | [S3,MB6,F]  395-12-407ms   | [S3,MB6,B]  414-30-445ms   | [S3,MB7,F]  448-11-459ms   | [S3,MB7,B]  465-26-492ms  
[rank3]:2025-12-23 20:19:01,889 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2019_stage3_step100.svg
[rank1]:2025-12-23 20:19:01,876 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2019_stage1.svg
[rank0]:2025-12-23 20:19:01,876 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2019_stage0.svg
[rank3]:2025-12-23 20:19:01,978 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2019_stage3.svg
[rank3]:2025-12-23 20:20:54,253 - Avg. fwd time: 12.2640 / Avg. bwd time: 36.6759 / Avg. batch time: 463.4125 (ms) / GPU bubble ratio: 15.51%
[rank2]:2025-12-23 20:20:54,275 - Avg. fwd time: 7.2422 / Avg. bwd time: 18.6156 / Avg. batch time: 493.0662 (ms) / GPU bubble ratio: 58.05%
[rank0]:2025-12-23 20:20:54,319 - Avg. fwd time: 7.5996 / Avg. bwd time: 22.2343 / Avg. batch time: 561.6754 (ms) / GPU bubble ratio: 57.51%
[rank1]:2025-12-23 20:20:54,299 - Avg. fwd time: 9.4373 / Avg. bwd time: 23.8313 / Avg. batch time: 529.4835 (ms) / GPU bubble ratio: 49.73%
[rank3]:2025-12-23 20:22:34,445 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.27)/0.40, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-23 20:22:34,624 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank0]:2025-12-23 20:22:34,667 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-23 20:22:34,668 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.35(0.38)/0.57, [MB7] 0.59(0.67)/1.00
[rank1]:2025-12-23 20:22:34,647 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.04(0.06)/0.08, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-23 20:22:38,592 - Avg. fwd time: 12.1887 / Avg. bwd time: 35.8121 / Avg. batch time: 455.8854 (ms) / GPU bubble ratio: 15.77%
[rank3]:2025-12-23 20:22:38,687 -  step: 150  loss:  3.8135  grad_norm:  4.4651  memory: 16.39GiB(34.50%)  tps: 7,551  tflops: 59.03  mfu: 18.92%
[rank2]:2025-12-23 20:22:38,611 - Avg. fwd time: 7.2428 / Avg. bwd time: 18.6809 / Avg. batch time: 484.7241 (ms) / GPU bubble ratio: 57.21%
[rank2]:2025-12-23 20:22:38,674 -  step: 150  loss: -8.0000  grad_norm:  4.4651  memory:  6.98GiB(14.69%)  tps: 7,551  tflops: 59.03  mfu: 18.92%
[rank0]:2025-12-23 20:22:38,652 - Avg. fwd time: 7.6022 / Avg. bwd time: 22.3603 / Avg. batch time: 552.1343 (ms) / GPU bubble ratio: 56.59%
[rank0]:2025-12-23 20:22:38,688 -  step: 150  loss: -8.0000  grad_norm:  4.4651  memory: 13.42GiB(28.26%)  tps: 7,551  tflops: 59.03  mfu: 18.92%
[rank1]:2025-12-23 20:22:38,634 - Avg. fwd time: 9.4586 / Avg. bwd time: 23.9696 / Avg. batch time: 520.5828 (ms) / GPU bubble ratio: 48.63%
[rank1]:2025-12-23 20:22:38,678 -  step: 150  loss: -8.0000  grad_norm:  4.4651  memory:  9.50GiB(19.99%)  tps: 7,551  tflops: 59.03  mfu: 18.92%
[rank3]:2025-12-23 20:24:16,825 - Avg. fwd time: 12.1042 / Avg. bwd time: 34.7772 / Avg. batch time: 446.9204 (ms) / GPU bubble ratio: 16.08%
[rank2]:2025-12-23 20:24:16,843 - Avg. fwd time: 7.2468 / Avg. bwd time: 18.7425 / Avg. batch time: 475.1977 (ms) / GPU bubble ratio: 56.25%
[rank0]:2025-12-23 20:24:16,882 - Avg. fwd time: 7.6069 / Avg. bwd time: 22.3941 / Avg. batch time: 540.9341 (ms) / GPU bubble ratio: 55.63%
[rank1]:2025-12-23 20:24:16,865 - Avg. fwd time: 9.4906 / Avg. bwd time: 24.0635 / Avg. batch time: 510.3785 (ms) / GPU bubble ratio: 47.41%
[rank3]:2025-12-23 20:25:46,337 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.38(0.40)/0.40, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-23 20:25:46,505 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-23 20:25:46,521 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.09(0.08)/0.08, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-23 20:25:46,529 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-23 20:25:46,530 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.57)/0.57, [MB7] 0.95(1.00)/1.00
[rank3]:2025-12-23 20:25:50,041 - Avg. fwd time: 12.0247 / Avg. bwd time: 33.8036 / Avg. batch time: 438.4883 (ms) / GPU bubble ratio: 16.39%
[rank3]:2025-12-23 20:25:50,115 -  step: 200  loss:  1.4925  grad_norm:  1.8242  memory: 16.39GiB(34.50%)  tps: 8,559  tflops: 66.91  mfu: 21.45%
[rank2]:2025-12-23 20:25:50,057 - Avg. fwd time: 7.2531 / Avg. bwd time: 18.7498 / Avg. batch time: 465.9458 (ms) / GPU bubble ratio: 55.35%
[rank2]:2025-12-23 20:25:50,102 -  step: 200  loss: -8.0000  grad_norm:  1.8242  memory:  6.98GiB(14.69%)  tps: 8,559  tflops: 66.91  mfu: 21.45%
[rank1]:2025-12-23 20:25:50,075 - Avg. fwd time: 9.5366 / Avg. bwd time: 24.1420 / Avg. batch time: 500.2622 (ms) / GPU bubble ratio: 46.14%
[rank1]:2025-12-23 20:25:50,107 -  step: 200  loss: -8.0000  grad_norm:  1.8242  memory:  9.50GiB(19.99%)  tps: 8,559  tflops: 66.91  mfu: 21.45%
[rank0]:2025-12-23 20:25:50,081 - Avg. fwd time: 7.6124 / Avg. bwd time: 22.3417 / Avg. batch time: 529.4174 (ms) / GPU bubble ratio: 54.74%
[rank0]:2025-12-23 20:25:50,117 -  step: 200  loss: -8.0000  grad_norm:  1.8242  memory: 13.42GiB(28.26%)  tps: 8,559  tflops: 66.91  mfu: 21.45%
[rank2]:2025-12-23 20:25:50,166 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2025_stage2_step200.svg
[rank1]:2025-12-23 20:25:50,169 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2025_stage1_step200.svg
[rank0]:2025-12-23 20:25:50,166 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2025_stage0_step200.svg
[rank3]:2025-12-23 20:25:50,256 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2025_step200_rank3.svg
[rank3]:			> Batch Time: 437.36 ms, GPU Bubble Ratio: 46.94%, 36.31%, 52.23%, 31.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  205-25-230ms   | [S0,MB5,F]  230-7-237ms    | [S0,MB2,B]  247-25-272ms   | [S0,MB6,F]  272-7-279ms    | [S0,MB3,B]  290-25-316ms   | [S0,MB7,F]  316-7-323ms    | [S0,MB4,B]  334-25-360ms   | [S0,MB5,B]  377-25-402ms   | [S0,MB6,B]  414-13-428ms   | [S0,MB7,B]  432-5-437ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  174-25-199ms   | [S1,MB4,F]  203-9-212ms    | [S1,MB2,B]  216-26-242ms   | [S1,MB5,F]  245-9-255ms    | [S1,MB3,B]  258-26-285ms   | [S1,MB6,F]  289-10-299ms   | [S1,MB4,B]  302-27-329ms   | [S1,MB7,F]  333-10-343ms   | [S1,MB5,B]  345-27-373ms   | [S1,MB6,B]  384-27-411ms   | [S1,MB7,B]  415-13-428ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  150-20-170ms   | [S2,MB3,F]  172-7-179ms    | [S2,MB2,B]  192-20-212ms   | [S2,MB4,F]  214-7-221ms    | [S2,MB3,B]  234-20-254ms   | [S2,MB5,F]  256-7-264ms    | [S2,MB4,B]  276-20-296ms   | [S2,MB6,F]  300-7-307ms    | [S2,MB5,B]  318-20-338ms   | [S2,MB7,F]  344-7-351ms    | [S2,MB6,B]  360-20-381ms   | [S2,MB7,B]  402-8-411ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-37-145ms   | [S3,MB2,F]  149-11-160ms   | [S3,MB2,B]  165-21-187ms   | [S3,MB3,F]  190-10-201ms   | [S3,MB3,B]  206-22-228ms   | [S3,MB4,F]  232-10-243ms   | [S3,MB4,B]  249-22-271ms   | [S3,MB5,F]  275-11-286ms   | [S3,MB5,B]  291-21-313ms   | [S3,MB6,F]  317-10-328ms   | [S3,MB6,B]  334-21-356ms   | [S3,MB7,F]  359-10-370ms   | [S3,MB7,B]  376-23-399ms  
[rank3]:2025-12-23 20:25:50,300 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2025_stage3_step200.svg
[rank2]:2025-12-23 20:25:50,505 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2025_stage2.svg
[rank0]:2025-12-23 20:25:50,502 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2025_stage0.svg
[rank1]:2025-12-23 20:25:50,554 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2025_stage1.svg
[rank3]:2025-12-23 20:25:50,642 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2025_stage3.svg
[rank3]:2025-12-23 20:27:18,847 - Avg. fwd time: 11.9423 / Avg. bwd time: 32.7695 / Avg. batch time: 429.5705 (ms) / GPU bubble ratio: 16.73%
[rank1]:2025-12-23 20:27:18,882 - Avg. fwd time: 9.5862 / Avg. bwd time: 24.2497 / Avg. batch time: 490.2034 (ms) / GPU bubble ratio: 44.78%
[rank2]:2025-12-23 20:27:18,863 - Avg. fwd time: 7.2626 / Avg. bwd time: 18.7559 / Avg. batch time: 456.3603 (ms) / GPU bubble ratio: 54.39%
[rank0]:2025-12-23 20:27:18,889 - Avg. fwd time: 7.6153 / Avg. bwd time: 22.1788 / Avg. batch time: 517.7808 (ms) / GPU bubble ratio: 53.97%
[rank3]:2025-12-23 20:28:43,079 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-23 20:28:43,257 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.09(0.08)/0.08, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-23 20:28:43,240 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-23 20:28:43,260 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-23 20:28:43,261 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.57(0.57)/0.57, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-23 20:28:46,831 - Avg. fwd time: 9.6279 / Avg. bwd time: 24.3457 / Avg. batch time: 482.1286 (ms) / GPU bubble ratio: 43.63%
[rank1]:2025-12-23 20:28:46,863 -  step: 250  loss: -8.0000  grad_norm:  0.9588  memory:  9.50GiB(19.99%)  tps: 9,269  tflops: 72.46  mfu: 23.23%
[rank3]:2025-12-23 20:28:46,795 - Avg. fwd time: 11.8793 / Avg. bwd time: 31.9321 / Avg. batch time: 422.3811 (ms) / GPU bubble ratio: 17.02%
[rank3]:2025-12-23 20:28:46,872 -  step: 250  loss:  0.5584  grad_norm:  0.9588  memory: 16.39GiB(34.50%)  tps: 9,269  tflops: 72.46  mfu: 23.23%
[rank2]:2025-12-23 20:28:46,811 - Avg. fwd time: 7.2702 / Avg. bwd time: 18.7638 / Avg. batch time: 448.6051 (ms) / GPU bubble ratio: 53.57%
[rank2]:2025-12-23 20:28:46,859 -  step: 250  loss: -8.0000  grad_norm:  0.9588  memory:  6.98GiB(14.69%)  tps: 9,269  tflops: 72.46  mfu: 23.23%
[rank0]:2025-12-23 20:28:46,838 - Avg. fwd time: 7.6167 / Avg. bwd time: 22.0259 / Avg. batch time: 508.2465 (ms) / GPU bubble ratio: 53.34%
[rank0]:2025-12-23 20:28:46,874 -  step: 250  loss: -8.0000  grad_norm:  0.9588  memory: 13.42GiB(28.26%)  tps: 9,269  tflops: 72.46  mfu: 23.23%
[rank3]:2025-12-23 20:30:16,670 - Avg. fwd time: 11.8445 / Avg. bwd time: 31.3295 / Avg. batch time: 417.2858 (ms) / GPU bubble ratio: 17.23%
[rank2]:2025-12-23 20:30:16,687 - Avg. fwd time: 7.2759 / Avg. bwd time: 18.7715 / Avg. batch time: 443.0449 (ms) / GPU bubble ratio: 52.97%
[rank1]:2025-12-23 20:30:16,707 - Avg. fwd time: 9.6537 / Avg. bwd time: 24.3972 / Avg. batch time: 476.1549 (ms) / GPU bubble ratio: 42.79%
[rank0]:2025-12-23 20:30:16,714 - Avg. fwd time: 7.6181 / Avg. bwd time: 21.9271 / Avg. batch time: 501.2971 (ms) / GPU bubble ratio: 52.85%
[rank3]:2025-12-23 20:31:43,148 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-23 20:31:43,332 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-23 20:31:43,332 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.57(0.57)/0.57, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-23 20:31:43,313 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-23 20:31:43,328 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.09(0.08)/0.08, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-23 20:31:46,879 - Avg. fwd time: 7.6195 / Avg. bwd time: 21.8417 / Avg. batch time: 495.6313 (ms) / GPU bubble ratio: 52.45%
[rank2]:2025-12-23 20:31:46,853 - Avg. fwd time: 7.2815 / Avg. bwd time: 18.7798 / Avg. batch time: 438.5661 (ms) / GPU bubble ratio: 52.46%
[rank2]:2025-12-23 20:31:46,901 -  step: 300  loss: -8.0000  grad_norm:  0.3815  memory:  6.98GiB(14.69%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank3]:2025-12-23 20:31:46,835 - Avg. fwd time: 11.8194 / Avg. bwd time: 30.8428 / Avg. batch time: 413.1911 (ms) / GPU bubble ratio: 17.40%
[rank3]:2025-12-23 20:31:46,913 -  step: 300  loss:  0.3184  grad_norm:  0.3815  memory: 16.39GiB(34.50%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank1]:2025-12-23 20:31:46,872 - Avg. fwd time: 9.6754 / Avg. bwd time: 24.4451 / Avg. batch time: 471.3648 (ms) / GPU bubble ratio: 42.09%
[rank1]:2025-12-23 20:31:46,905 -  step: 300  loss: -8.0000  grad_norm:  0.3815  memory:  9.50GiB(19.99%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank0]:2025-12-23 20:31:46,915 -  step: 300  loss: -8.0000  grad_norm:  0.3815  memory: 13.42GiB(28.26%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank0]:2025-12-23 20:31:46,964 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2031_stage0_step300.svg
[rank2]:2025-12-23 20:31:46,962 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2031_stage2_step300.svg
[rank1]:2025-12-23 20:31:46,964 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2031_stage1_step300.svg
[rank3]:2025-12-23 20:31:47,052 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2031_step300_rank3.svg
[rank3]:			> Batch Time: 433.25 ms, GPU Bubble Ratio: 47.45%, 35.85%, 51.50%, 31.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  207-25-232ms   | [S0,MB5,F]  232-7-239ms    | [S0,MB2,B]  250-25-275ms   | [S0,MB6,F]  275-7-282ms    | [S0,MB3,B]  293-25-318ms   | [S0,MB7,F]  318-7-325ms    | [S0,MB4,B]  337-25-362ms   | [S0,MB5,B]  380-25-406ms   | [S0,MB6,B]  417-14-431ms   | [S0,MB7,B]  433-0-433ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  117-25-143ms   | [S1,MB3,F]  146-9-156ms    | [S1,MB1,B]  176-25-201ms   | [S1,MB4,F]  205-9-214ms    | [S1,MB2,B]  219-26-245ms   | [S1,MB5,F]  248-9-258ms    | [S1,MB3,B]  261-26-288ms   | [S1,MB6,F]  291-10-302ms   | [S1,MB4,B]  304-27-332ms   | [S1,MB7,F]  335-10-346ms   | [S1,MB5,B]  349-28-377ms   | [S1,MB6,B]  386-27-413ms   | [S1,MB7,B]  417-12-429ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  33-6-40ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  116-6-123ms    | [S2,MB1,B]  152-20-172ms   | [S2,MB3,F]  174-7-181ms    | [S2,MB2,B]  195-20-215ms   | [S2,MB4,F]  217-7-224ms    | [S2,MB3,B]  237-20-257ms   | [S2,MB5,F]  259-7-267ms    | [S2,MB4,B]  278-20-299ms   | [S2,MB6,F]  303-7-310ms    | [S2,MB5,B]  320-20-341ms   | [S2,MB7,F]  347-7-354ms    | [S2,MB6,B]  362-20-383ms   | [S2,MB7,B]  403-8-411ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  49-39-88ms     | [S3,MB1,F]  92-10-103ms    | [S3,MB1,B]  109-38-147ms   | [S3,MB2,F]  150-12-163ms   | [S3,MB2,B]  168-21-190ms   | [S3,MB3,F]  193-10-204ms   | [S3,MB3,B]  210-21-232ms   | [S3,MB4,F]  235-10-246ms   | [S3,MB4,B]  252-21-273ms   | [S3,MB5,F]  277-10-288ms   | [S3,MB5,B]  293-21-315ms   | [S3,MB6,F]  319-11-330ms   | [S3,MB6,B]  336-21-357ms   | [S3,MB7,F]  361-11-372ms   | [S3,MB7,B]  378-21-399ms  
[rank3]:2025-12-23 20:31:47,095 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2031_stage3_step300.svg
[rank0]:2025-12-23 20:31:47,551 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2031_stage0.svg
[rank2]:2025-12-23 20:31:47,543 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2031_stage2.svg
[rank1]:2025-12-23 20:31:47,561 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2031_stage1.svg
[rank3]:2025-12-23 20:31:47,680 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2031_stage3.svg
[rank0]:2025-12-23 20:33:17,205 - Avg. fwd time: 7.6194 / Avg. bwd time: 21.7380 / Avg. batch time: 490.6601 (ms) / GPU bubble ratio: 52.13%
[rank2]:2025-12-23 20:33:17,178 - Avg. fwd time: 7.2874 / Avg. bwd time: 18.7874 / Avg. batch time: 434.7872 (ms) / GPU bubble ratio: 52.02%
[rank1]:2025-12-23 20:33:17,198 - Avg. fwd time: 9.6927 / Avg. bwd time: 24.4772 / Avg. batch time: 467.2606 (ms) / GPU bubble ratio: 41.50%
[rank3]:2025-12-23 20:33:17,161 - Avg. fwd time: 11.7939 / Avg. bwd time: 30.4323 / Avg. batch time: 409.7020 (ms) / GPU bubble ratio: 17.55%
[rank0]:2025-12-23 20:34:42,260 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-23 20:34:45,733 - Avg. fwd time: 11.7661 / Avg. bwd time: 30.0356 / Avg. batch time: 406.3176 (ms) / GPU bubble ratio: 17.70%
[rank1]:2025-12-23 20:34:45,771 - Avg. fwd time: 9.7120 / Avg. bwd time: 24.5063 / Avg. batch time: 463.3011 (ms) / GPU bubble ratio: 40.91%
[rank1]:2025-12-23 20:34:45,804 -  step: 350  loss: -8.0000  grad_norm:  0.4563  memory:  9.50GiB(19.99%)  tps: 9,158  tflops: 71.60  mfu: 22.95%
[rank2]:2025-12-23 20:34:45,751 - Avg. fwd time: 7.2926 / Avg. bwd time: 18.7940 / Avg. batch time: 431.1239 (ms) / GPU bubble ratio: 51.59%
[rank2]:2025-12-23 20:34:45,800 -  step: 350  loss: -8.0000  grad_norm:  0.4563  memory:  6.98GiB(14.69%)  tps: 9,158  tflops: 71.60  mfu: 22.95%
[rank0]:2025-12-23 20:34:45,778 - Avg. fwd time: 7.6215 / Avg. bwd time: 21.6675 / Avg. batch time: 485.9852 (ms) / GPU bubble ratio: 51.79%
[rank0]:2025-12-23 20:34:45,814 -  step: 350  loss: -8.0000  grad_norm:  0.4563  memory: 13.42GiB(28.26%)  tps: 9,158  tflops: 71.60  mfu: 22.95%
[rank3]:2025-12-23 20:34:45,813 -  step: 350  loss:  0.2512  grad_norm:  0.4563  memory: 16.39GiB(34.50%)  tps: 9,158  tflops: 71.60  mfu: 22.95%
[rank3]:2025-12-23 20:36:14,446 - Avg. fwd time: 11.7395 / Avg. bwd time: 29.6795 / Avg. batch time: 403.2637 (ms) / GPU bubble ratio: 17.83%
[rank1]:2025-12-23 20:36:14,484 - Avg. fwd time: 9.7296 / Avg. bwd time: 24.5448 / Avg. batch time: 459.8420 (ms) / GPU bubble ratio: 40.37%
[rank2]:2025-12-23 20:36:14,464 - Avg. fwd time: 7.2961 / Avg. bwd time: 18.7990 / Avg. batch time: 427.8296 (ms) / GPU bubble ratio: 51.20%
[rank0]:2025-12-23 20:36:14,492 - Avg. fwd time: 7.6227 / Avg. bwd time: 21.6188 / Avg. batch time: 481.9831 (ms) / GPU bubble ratio: 51.46%
[rank0]:2025-12-23 20:37:39,329 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-23 20:37:42,951 - Avg. fwd time: 9.7421 / Avg. bwd time: 24.5751 / Avg. batch time: 456.8282 (ms) / GPU bubble ratio: 39.90%
[rank2]:2025-12-23 20:37:42,930 - Avg. fwd time: 7.2990 / Avg. bwd time: 18.8008 / Avg. batch time: 424.9458 (ms) / GPU bubble ratio: 50.86%
[rank0]:2025-12-23 20:37:42,959 - Avg. fwd time: 7.6234 / Avg. bwd time: 21.5572 / Avg. batch time: 478.4111 (ms) / GPU bubble ratio: 51.20%
[rank3]:2025-12-23 20:37:42,912 - Avg. fwd time: 11.7136 / Avg. bwd time: 29.3710 / Avg. batch time: 400.5944 (ms) / GPU bubble ratio: 17.95%
[rank1]:2025-12-23 20:37:42,985 -  step: 400  loss: -8.0000  grad_norm:  0.1576  memory:  9.50GiB(19.99%)  tps: 9,247  tflops: 72.29  mfu: 23.17%
[rank1]:2025-12-23 20:37:43,046 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2037_stage1_step400.svg
[rank2]:2025-12-23 20:37:42,981 -  step: 400  loss: -8.0000  grad_norm:  0.1576  memory:  6.98GiB(14.69%)  tps: 9,247  tflops: 72.29  mfu: 23.17%
[rank2]:2025-12-23 20:37:43,046 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2037_stage2_step400.svg
[rank0]:2025-12-23 20:37:42,995 -  step: 400  loss: -8.0000  grad_norm:  0.1576  memory: 13.42GiB(28.26%)  tps: 9,247  tflops: 72.29  mfu: 23.17%
[rank0]:2025-12-23 20:37:43,047 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2037_stage0_step400.svg
[rank3]:2025-12-23 20:37:42,993 -  step: 400  loss:  0.2268  grad_norm:  0.1576  memory: 16.39GiB(34.50%)  tps: 9,247  tflops: 72.29  mfu: 23.17%
[rank3]:2025-12-23 20:37:43,129 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2037_step400_rank3.svg
[rank3]:			> Batch Time: 431.00 ms, GPU Bubble Ratio: 47.61%, 35.74%, 51.48%, 31.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  205-25-230ms   | [S0,MB5,F]  230-7-237ms    | [S0,MB2,B]  247-25-273ms   | [S0,MB6,F]  273-7-280ms    | [S0,MB3,B]  290-25-315ms   | [S0,MB7,F]  315-7-322ms    | [S0,MB4,B]  334-25-359ms   | [S0,MB5,B]  376-25-401ms   | [S0,MB6,B]  414-13-427ms   | [S0,MB7,B]  431-0-431ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  174-25-199ms   | [S1,MB4,F]  203-9-212ms    | [S1,MB2,B]  216-25-242ms   | [S1,MB5,F]  246-9-255ms    | [S1,MB3,B]  258-26-285ms   | [S1,MB6,F]  288-10-298ms   | [S1,MB4,B]  301-27-328ms   | [S1,MB7,F]  332-10-342ms   | [S1,MB5,B]  345-27-373ms   | [S1,MB6,B]  383-28-411ms   | [S1,MB7,B]  414-12-426ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  150-20-170ms   | [S2,MB3,F]  172-7-179ms    | [S2,MB2,B]  192-20-213ms   | [S2,MB4,F]  215-7-222ms    | [S2,MB3,B]  234-20-254ms   | [S2,MB5,F]  256-7-264ms    | [S2,MB4,B]  276-20-296ms   | [S2,MB6,F]  299-7-307ms    | [S2,MB5,B]  317-20-338ms   | [S2,MB7,F]  343-7-351ms    | [S2,MB6,B]  359-20-379ms   | [S2,MB7,B]  399-8-408ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  92-10-102ms    | [S3,MB1,B]  108-36-145ms   | [S3,MB2,F]  149-12-161ms   | [S3,MB2,B]  166-21-187ms   | [S3,MB3,F]  191-10-202ms   | [S3,MB3,B]  208-21-229ms   | [S3,MB4,F]  232-10-243ms   | [S3,MB4,B]  249-21-271ms   | [S3,MB5,F]  274-10-285ms   | [S3,MB5,B]  291-21-312ms   | [S3,MB6,F]  316-10-327ms   | [S3,MB6,B]  332-21-354ms   | [S3,MB7,F]  357-10-368ms   | [S3,MB7,B]  374-21-396ms  
[rank3]:2025-12-23 20:37:43,176 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2037_stage3_step400.svg
[rank1]:2025-12-23 20:37:43,899 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2037_stage1.svg
[rank2]:2025-12-23 20:37:43,875 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2037_stage2.svg
[rank0]:2025-12-23 20:37:43,887 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2037_stage0.svg
[rank3]:2025-12-23 20:37:44,023 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2037_stage3.svg
[rank3]:2025-12-23 20:38:04,440 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-23 20:38:04,629 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-23 20:38:04,609 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-23 20:38:04,631 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-23 20:39:12,797 - Avg. fwd time: 7.3021 / Avg. bwd time: 18.8036 / Avg. batch time: 422.6093 (ms) / GPU bubble ratio: 50.58%
[rank3]:2025-12-23 20:39:12,779 - Avg. fwd time: 11.6938 / Avg. bwd time: 29.1188 / Avg. batch time: 398.4165 (ms) / GPU bubble ratio: 18.05%
[rank1]:2025-12-23 20:39:12,819 - Avg. fwd time: 9.7497 / Avg. bwd time: 24.5827 / Avg. batch time: 454.2633 (ms) / GPU bubble ratio: 39.54%
[rank0]:2025-12-23 20:39:12,828 - Avg. fwd time: 7.6229 / Avg. bwd time: 21.5151 / Avg. batch time: 475.4364 (ms) / GPU bubble ratio: 50.97%
[rank0]:2025-12-23 20:40:37,355 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-23 20:40:40,799 - Avg. fwd time: 7.3039 / Avg. bwd time: 18.8054 / Avg. batch time: 420.2762 (ms) / GPU bubble ratio: 50.30%
[rank3]:2025-12-23 20:40:40,780 - Avg. fwd time: 11.6703 / Avg. bwd time: 28.8703 / Avg. batch time: 396.2507 (ms) / GPU bubble ratio: 18.15%
[rank1]:2025-12-23 20:40:40,820 - Avg. fwd time: 9.7612 / Avg. bwd time: 24.6032 / Avg. batch time: 451.7960 (ms) / GPU bubble ratio: 39.15%
[rank1]:2025-12-23 20:40:40,854 -  step: 450  loss: -8.0000  grad_norm:  0.1813  memory:  9.50GiB(19.99%)  tps: 9,211  tflops: 72.01  mfu: 23.08%
[rank0]:2025-12-23 20:40:40,829 - Avg. fwd time: 7.6228 / Avg. bwd time: 21.4557 / Avg. batch time: 472.5155 (ms) / GPU bubble ratio: 50.77%
[rank0]:2025-12-23 20:40:40,865 -  step: 450  loss: -8.0000  grad_norm:  0.1813  memory: 13.42GiB(28.26%)  tps: 9,211  tflops: 72.01  mfu: 23.08%
[rank2]:2025-12-23 20:40:40,851 -  step: 450  loss: -8.0000  grad_norm:  0.1813  memory:  6.98GiB(14.69%)  tps: 9,211  tflops: 72.01  mfu: 23.08%
[rank3]:2025-12-23 20:40:40,863 -  step: 450  loss:  0.2335  grad_norm:  0.1813  memory: 16.39GiB(34.50%)  tps: 9,211  tflops: 72.01  mfu: 23.08%
[rank3]:2025-12-23 20:42:08,638 - Avg. fwd time: 11.6485 / Avg. bwd time: 28.6333 / Avg. batch time: 394.1947 (ms) / GPU bubble ratio: 18.25%
[rank0]:2025-12-23 20:42:08,689 - Avg. fwd time: 7.6227 / Avg. bwd time: 21.4110 / Avg. batch time: 469.8484 (ms) / GPU bubble ratio: 50.56%
[rank1]:2025-12-23 20:42:08,679 - Avg. fwd time: 9.7731 / Avg. bwd time: 24.6334 / Avg. batch time: 449.5345 (ms) / GPU bubble ratio: 38.77%
[rank2]:2025-12-23 20:42:08,657 - Avg. fwd time: 7.3060 / Avg. bwd time: 18.8071 / Avg. batch time: 418.0696 (ms) / GPU bubble ratio: 50.03%
[rank0]:2025-12-23 20:43:34,719 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 20:43:38,283 - Avg. fwd time: 11.6343 / Avg. bwd time: 28.4799 / Avg. batch time: 392.8510 (ms) / GPU bubble ratio: 18.31%
[rank0]:2025-12-23 20:43:38,333 - Avg. fwd time: 7.6225 / Avg. bwd time: 21.3739 / Avg. batch time: 467.8890 (ms) / GPU bubble ratio: 50.42%
[rank1]:2025-12-23 20:43:38,324 - Avg. fwd time: 9.7793 / Avg. bwd time: 24.6424 / Avg. batch time: 447.9142 (ms) / GPU bubble ratio: 38.52%
[rank2]:2025-12-23 20:43:38,302 - Avg. fwd time: 7.3074 / Avg. bwd time: 18.8068 / Avg. batch time: 416.5881 (ms) / GPU bubble ratio: 49.85%
[rank2]:2025-12-23 20:43:38,355 -  step: 500  loss: -8.0000  grad_norm:  0.1603  memory:  6.98GiB(14.69%)  tps: 9,230  tflops: 72.16  mfu: 23.13%
[rank3]:2025-12-23 20:43:38,367 -  step: 500  loss:  0.2269  grad_norm:  0.1603  memory: 16.39GiB(34.50%)  tps: 9,230  tflops: 72.16  mfu: 23.13%
[rank0]:2025-12-23 20:43:38,370 -  step: 500  loss: -8.0000  grad_norm:  0.1603  memory: 13.42GiB(28.26%)  tps: 9,230  tflops: 72.16  mfu: 23.13%
[rank0]:2025-12-23 20:43:38,417 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2043_stage0_step500.svg
[rank1]:2025-12-23 20:43:38,359 -  step: 500  loss: -8.0000  grad_norm:  0.1603  memory:  9.50GiB(19.99%)  tps: 9,230  tflops: 72.16  mfu: 23.13%
[rank1]:2025-12-23 20:43:38,417 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2043_stage1_step500.svg
[rank2]:2025-12-23 20:43:38,416 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2043_stage2_step500.svg
[rank3]:2025-12-23 20:43:38,504 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2043_step500_rank3.svg
[rank3]:			> Batch Time: 432.75 ms, GPU Bubble Ratio: 47.16%, 35.94%, 51.73%, 31.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  206-25-231ms   | [S0,MB5,F]  231-7-238ms    | [S0,MB2,B]  249-25-274ms   | [S0,MB6,F]  274-7-281ms    | [S0,MB3,B]  292-25-318ms   | [S0,MB7,F]  318-7-325ms    | [S0,MB4,B]  337-25-362ms   | [S0,MB5,B]  380-25-406ms   | [S0,MB6,B]  415-15-430ms   | [S0,MB7,B]  432-0-432ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  117-25-143ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  175-25-201ms   | [S1,MB4,F]  204-9-214ms    | [S1,MB2,B]  217-26-244ms   | [S1,MB5,F]  247-9-257ms    | [S1,MB3,B]  260-26-287ms   | [S1,MB6,F]  291-10-301ms   | [S1,MB4,B]  304-27-332ms   | [S1,MB7,F]  335-10-346ms   | [S1,MB5,B]  349-27-377ms   | [S1,MB6,B]  384-26-411ms   | [S1,MB7,B]  415-12-428ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  151-20-171ms   | [S2,MB3,F]  173-7-181ms    | [S2,MB2,B]  193-20-214ms   | [S2,MB4,F]  216-7-223ms    | [S2,MB3,B]  235-20-255ms   | [S2,MB5,F]  258-7-266ms    | [S2,MB4,B]  277-20-297ms   | [S2,MB6,F]  302-7-310ms    | [S2,MB5,B]  319-20-339ms   | [S2,MB7,F]  347-7-354ms    | [S2,MB6,B]  361-20-381ms   | [S2,MB7,B]  402-8-411ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  92-10-102ms    | [S3,MB1,B]  108-38-146ms   | [S3,MB2,F]  150-11-162ms   | [S3,MB2,B]  167-21-188ms   | [S3,MB3,F]  192-10-203ms   | [S3,MB3,B]  209-21-230ms   | [S3,MB4,F]  234-10-245ms   | [S3,MB4,B]  250-21-272ms   | [S3,MB5,F]  275-10-286ms   | [S3,MB5,B]  292-21-314ms   | [S3,MB6,F]  317-10-328ms   | [S3,MB6,B]  334-21-356ms   | [S3,MB7,F]  359-11-370ms   | [S3,MB7,B]  376-21-398ms  
[rank3]:2025-12-23 20:43:38,546 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2043_stage3_step500.svg
[rank0]:2025-12-23 20:43:39,507 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2043_stage0.svg
[rank1]:2025-12-23 20:43:39,518 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2043_stage1.svg
[rank2]:2025-12-23 20:43:39,483 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2043_stage2.svg
[rank3]:2025-12-23 20:43:39,625 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2043_stage3.svg
[rank0]:2025-12-23 20:45:09,230 - Avg. fwd time: 7.6229 / Avg. bwd time: 21.3639 / Avg. batch time: 466.1468 (ms) / GPU bubble ratio: 50.25%
[rank3]:2025-12-23 20:45:09,178 - Avg. fwd time: 11.6217 / Avg. bwd time: 28.3231 / Avg. batch time: 391.4973 (ms) / GPU bubble ratio: 18.38%
[rank1]:2025-12-23 20:45:09,220 - Avg. fwd time: 9.7855 / Avg. bwd time: 24.6515 / Avg. batch time: 446.3325 (ms) / GPU bubble ratio: 38.28%
[rank2]:2025-12-23 20:45:09,198 - Avg. fwd time: 7.3082 / Avg. bwd time: 18.8062 / Avg. batch time: 415.1314 (ms) / GPU bubble ratio: 49.67%
[rank0]:2025-12-23 20:46:35,139 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-23 20:46:38,682 - Avg. fwd time: 11.6109 / Avg. bwd time: 28.1831 / Avg. batch time: 390.2906 (ms) / GPU bubble ratio: 18.43%
[rank0]:2025-12-23 20:46:38,734 - Avg. fwd time: 7.6236 / Avg. bwd time: 21.3462 / Avg. batch time: 464.5018 (ms) / GPU bubble ratio: 50.11%
[rank0]:2025-12-23 20:46:38,770 -  step: 550  loss: -8.0000  grad_norm:  0.1660  memory: 13.42GiB(28.26%)  tps: 9,082  tflops: 71.00  mfu: 22.76%
[rank3]:2025-12-23 20:46:38,768 -  step: 550  loss:  0.2319  grad_norm:  0.1660  memory: 16.39GiB(34.50%)  tps: 9,082  tflops: 71.00  mfu: 22.76%
[rank2]:2025-12-23 20:46:38,702 - Avg. fwd time: 7.3093 / Avg. bwd time: 18.8055 / Avg. batch time: 413.8100 (ms) / GPU bubble ratio: 49.51%
[rank2]:2025-12-23 20:46:38,756 -  step: 550  loss: -8.0000  grad_norm:  0.1660  memory:  6.98GiB(14.69%)  tps: 9,082  tflops: 71.00  mfu: 22.76%
[rank1]:2025-12-23 20:46:38,724 - Avg. fwd time: 9.7909 / Avg. bwd time: 24.6586 / Avg. batch time: 444.8887 (ms) / GPU bubble ratio: 38.05%
[rank1]:2025-12-23 20:46:38,759 -  step: 550  loss: -8.0000  grad_norm:  0.1660  memory:  9.50GiB(19.99%)  tps: 9,082  tflops: 71.00  mfu: 22.76%
[rank3]:2025-12-23 20:48:06,779 - Avg. fwd time: 11.5981 / Avg. bwd time: 28.0245 / Avg. batch time: 388.9264 (ms) / GPU bubble ratio: 18.50%
[rank2]:2025-12-23 20:48:06,799 - Avg. fwd time: 7.3110 / Avg. bwd time: 18.8064 / Avg. batch time: 412.3456 (ms) / GPU bubble ratio: 49.33%
[rank1]:2025-12-23 20:48:06,821 - Avg. fwd time: 9.7990 / Avg. bwd time: 24.6745 / Avg. batch time: 443.3595 (ms) / GPU bubble ratio: 37.80%
[rank0]:2025-12-23 20:48:06,833 - Avg. fwd time: 7.6239 / Avg. bwd time: 21.3148 / Avg. batch time: 462.6876 (ms) / GPU bubble ratio: 49.96%
[rank0]:2025-12-23 20:49:30,370 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 20:49:33,844 - Avg. fwd time: 11.5836 / Avg. bwd time: 27.8596 / Avg. batch time: 387.5015 (ms) / GPU bubble ratio: 18.57%
[rank0]:2025-12-23 20:49:33,898 - Avg. fwd time: 7.6248 / Avg. bwd time: 21.2861 / Avg. batch time: 460.8141 (ms) / GPU bubble ratio: 49.81%
[rank2]:2025-12-23 20:49:33,864 - Avg. fwd time: 7.3126 / Avg. bwd time: 18.8075 / Avg. batch time: 410.8298 (ms) / GPU bubble ratio: 49.14%
[rank1]:2025-12-23 20:49:33,887 - Avg. fwd time: 9.8088 / Avg. bwd time: 24.6867 / Avg. batch time: 441.7474 (ms) / GPU bubble ratio: 37.53%
[rank1]:2025-12-23 20:49:33,923 -  step: 600  loss: -8.0000  grad_norm:  0.1181  memory:  9.50GiB(19.99%)  tps: 9,354  tflops: 73.12  mfu: 23.44%
[rank3]:2025-12-23 20:49:33,932 -  step: 600  loss:  0.2299  grad_norm:  0.1181  memory: 16.39GiB(34.50%)  tps: 9,354  tflops: 73.12  mfu: 23.44%
[rank0]:2025-12-23 20:49:33,934 -  step: 600  loss: -8.0000  grad_norm:  0.1181  memory: 13.42GiB(28.26%)  tps: 9,354  tflops: 73.12  mfu: 23.44%
[rank0]:2025-12-23 20:49:33,984 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2049_stage0_step600.svg
[rank2]:2025-12-23 20:49:33,920 -  step: 600  loss: -8.0000  grad_norm:  0.1181  memory:  6.98GiB(14.69%)  tps: 9,354  tflops: 73.12  mfu: 23.44%
[rank2]:2025-12-23 20:49:33,984 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2049_stage2_step600.svg
[rank1]:2025-12-23 20:49:33,984 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2049_stage1_step600.svg
[rank3]:2025-12-23 20:49:34,073 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2049_step600_rank3.svg
[rank3]:			> Batch Time: 417.75 ms, GPU Bubble Ratio: 45.65%, 33.08%, 49.89%, 32.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  195-25-220ms   | [S0,MB5,F]  220-7-227ms    | [S0,MB2,B]  237-25-262ms   | [S0,MB6,F]  262-7-269ms    | [S0,MB3,B]  281-25-306ms   | [S0,MB7,F]  306-7-313ms    | [S0,MB4,B]  325-25-350ms   | [S0,MB5,B]  368-25-394ms   | [S0,MB6,B]  401-13-415ms   | [S0,MB7,B]  417-0-417ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  117-25-143ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  164-25-189ms   | [S1,MB4,F]  193-9-202ms    | [S1,MB2,B]  205-26-232ms   | [S1,MB5,F]  235-10-246ms   | [S1,MB3,B]  248-27-275ms   | [S1,MB6,F]  279-10-290ms   | [S1,MB4,B]  292-27-320ms   | [S1,MB7,F]  324-10-334ms   | [S1,MB5,B]  337-28-365ms   | [S1,MB6,B]  371-26-397ms   | [S1,MB7,B]  401-12-414ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  140-20-160ms   | [S2,MB3,F]  162-7-169ms    | [S2,MB2,B]  181-20-201ms   | [S2,MB4,F]  204-7-211ms    | [S2,MB3,B]  222-20-243ms   | [S2,MB5,F]  247-7-254ms    | [S2,MB4,B]  264-20-284ms   | [S2,MB6,F]  290-7-298ms    | [S2,MB5,B]  306-20-326ms   | [S2,MB7,F]  335-7-342ms    | [S2,MB6,B]  347-20-367ms   | [S2,MB7,B]  387-9-396ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  92-11-103ms    | [S3,MB1,B]  108-26-135ms   | [S3,MB2,F]  138-10-149ms   | [S3,MB2,B]  155-21-176ms   | [S3,MB3,F]  179-10-190ms   | [S3,MB3,B]  196-21-218ms   | [S3,MB4,F]  221-10-232ms   | [S3,MB4,B]  238-21-259ms   | [S3,MB5,F]  262-10-273ms   | [S3,MB5,B]  279-21-301ms   | [S3,MB6,F]  304-10-315ms   | [S3,MB6,B]  321-21-342ms   | [S3,MB7,F]  345-10-356ms   | [S3,MB7,B]  362-21-384ms  
[rank3]:2025-12-23 20:49:34,117 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2049_stage3_step600.svg
[rank2]:2025-12-23 20:49:35,296 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2049_stage2.svg
[rank1]:2025-12-23 20:49:35,333 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2049_stage1.svg
[rank0]:2025-12-23 20:49:35,323 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2049_stage0.svg
[rank3]:2025-12-23 20:49:35,465 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2049_stage3.svg
[rank2]:2025-12-23 20:51:03,331 - Avg. fwd time: 7.3140 / Avg. bwd time: 18.8083 / Avg. batch time: 409.6342 (ms) / GPU bubble ratio: 48.98%
[rank3]:2025-12-23 20:51:03,310 - Avg. fwd time: 11.5712 / Avg. bwd time: 27.7294 / Avg. batch time: 386.3674 (ms) / GPU bubble ratio: 18.63%
[rank1]:2025-12-23 20:51:03,354 - Avg. fwd time: 9.8152 / Avg. bwd time: 24.6944 / Avg. batch time: 440.4625 (ms) / GPU bubble ratio: 37.32%
[rank0]:2025-12-23 20:51:03,366 - Avg. fwd time: 7.6252 / Avg. bwd time: 21.2614 / Avg. batch time: 459.2941 (ms) / GPU bubble ratio: 49.69%
[rank0]:2025-12-23 20:52:27,234 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-23 20:52:30,796 - Avg. fwd time: 7.3154 / Avg. bwd time: 18.8097 / Avg. batch time: 408.3663 (ms) / GPU bubble ratio: 48.82%
[rank2]:2025-12-23 20:52:30,853 -  step: 650  loss: -8.0000  grad_norm:  0.1070  memory:  6.98GiB(14.69%)  tps: 9,260  tflops: 72.39  mfu: 23.20%
[rank3]:2025-12-23 20:52:30,775 - Avg. fwd time: 11.5573 / Avg. bwd time: 27.5931 / Avg. batch time: 385.1762 (ms) / GPU bubble ratio: 18.69%
[rank0]:2025-12-23 20:52:30,831 - Avg. fwd time: 7.6254 / Avg. bwd time: 21.2300 / Avg. batch time: 457.7644 (ms) / GPU bubble ratio: 49.57%
[rank1]:2025-12-23 20:52:30,820 - Avg. fwd time: 9.8230 / Avg. bwd time: 24.7102 / Avg. batch time: 439.1557 (ms) / GPU bubble ratio: 37.09%
[rank1]:2025-12-23 20:52:30,856 -  step: 650  loss: -8.0000  grad_norm:  0.1070  memory:  9.52GiB(20.03%)  tps: 9,260  tflops: 72.39  mfu: 23.20%
[rank3]:2025-12-23 20:52:30,865 -  step: 650  loss:  0.2350  grad_norm:  0.1070  memory: 16.39GiB(34.50%)  tps: 9,260  tflops: 72.39  mfu: 23.20%
[rank0]:2025-12-23 20:52:30,867 -  step: 650  loss: -8.0000  grad_norm:  0.1070  memory: 13.42GiB(28.26%)  tps: 9,260  tflops: 72.39  mfu: 23.20%
[rank2]:2025-12-23 20:53:59,367 - Avg. fwd time: 7.3158 / Avg. bwd time: 18.8086 / Avg. batch time: 407.3982 (ms) / GPU bubble ratio: 48.70%
[rank3]:2025-12-23 20:53:59,345 - Avg. fwd time: 11.5448 / Avg. bwd time: 27.4914 / Avg. batch time: 384.2822 (ms) / GPU bubble ratio: 18.73%
[rank1]:2025-12-23 20:53:59,391 - Avg. fwd time: 9.8261 / Avg. bwd time: 24.7173 / Avg. batch time: 438.1389 (ms) / GPU bubble ratio: 36.93%
[rank0]:2025-12-23 20:53:59,403 - Avg. fwd time: 7.6252 / Avg. bwd time: 21.2067 / Avg. batch time: 456.5444 (ms) / GPU bubble ratio: 49.48%
[rank0]:2025-12-23 20:55:24,336 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-23 20:55:27,772 - Avg. fwd time: 7.3159 / Avg. bwd time: 18.8070 / Avg. batch time: 406.4461 (ms) / GPU bubble ratio: 48.58%
[rank3]:2025-12-23 20:55:27,750 - Avg. fwd time: 11.5329 / Avg. bwd time: 27.3931 / Avg. batch time: 383.4010 (ms) / GPU bubble ratio: 18.78%
[rank1]:2025-12-23 20:55:27,796 - Avg. fwd time: 9.8285 / Avg. bwd time: 24.7233 / Avg. batch time: 437.1341 (ms) / GPU bubble ratio: 36.77%
[rank2]:2025-12-23 20:55:27,830 -  step: 700  loss: -8.0000  grad_norm:  0.1523  memory:  6.98GiB(14.69%)  tps: 9,258  tflops: 72.37  mfu: 23.20%
[rank0]:2025-12-23 20:55:27,808 - Avg. fwd time: 7.6250 / Avg. bwd time: 21.1924 / Avg. batch time: 455.3944 (ms) / GPU bubble ratio: 49.38%
[rank0]:2025-12-23 20:55:27,844 -  step: 700  loss: -8.0000  grad_norm:  0.1523  memory: 13.42GiB(28.26%)  tps: 9,258  tflops: 72.37  mfu: 23.20%
[rank3]:2025-12-23 20:55:27,842 -  step: 700  loss:  0.1968  grad_norm:  0.1523  memory: 16.39GiB(34.50%)  tps: 9,258  tflops: 72.37  mfu: 23.20%
[rank1]:2025-12-23 20:55:27,833 -  step: 700  loss: -8.0000  grad_norm:  0.1523  memory:  9.56GiB(20.12%)  tps: 9,258  tflops: 72.37  mfu: 23.20%
[rank1]:2025-12-23 20:55:27,897 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2055_stage1_step700.svg
[rank2]:2025-12-23 20:55:27,895 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2055_stage2_step700.svg
[rank0]:2025-12-23 20:55:27,897 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2055_stage0_step700.svg
[rank3]:2025-12-23 20:55:27,984 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2055_step700_rank3.svg
[rank3]:			> Batch Time: 431.75 ms, GPU Bubble Ratio: 46.62%, 35.81%, 51.68%, 31.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  204-25-229ms   | [S0,MB5,F]  229-7-236ms    | [S0,MB2,B]  246-25-272ms   | [S0,MB6,F]  272-7-279ms    | [S0,MB3,B]  289-25-314ms   | [S0,MB7,F]  315-7-322ms    | [S0,MB4,B]  333-25-358ms   | [S0,MB5,B]  376-25-401ms   | [S0,MB6,B]  412-17-430ms   | [S0,MB7,B]  431-0-431ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  173-25-199ms   | [S1,MB4,F]  202-9-212ms    | [S1,MB2,B]  215-26-241ms   | [S1,MB5,F]  245-9-254ms    | [S1,MB3,B]  257-26-284ms   | [S1,MB6,F]  287-10-298ms   | [S1,MB4,B]  300-27-328ms   | [S1,MB7,F]  331-10-342ms   | [S1,MB5,B]  345-27-373ms   | [S1,MB6,B]  382-27-409ms   | [S1,MB7,B]  412-12-425ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  149-20-169ms   | [S2,MB3,F]  172-7-179ms    | [S2,MB2,B]  191-20-211ms   | [S2,MB4,F]  214-7-221ms    | [S2,MB3,B]  233-20-253ms   | [S2,MB5,F]  256-7-263ms    | [S2,MB4,B]  274-20-295ms   | [S2,MB6,F]  298-7-306ms    | [S2,MB5,B]  316-20-336ms   | [S2,MB7,F]  343-7-350ms    | [S2,MB6,B]  358-20-378ms   | [S2,MB7,B]  399-8-408ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-36-145ms   | [S3,MB2,F]  148-11-160ms   | [S3,MB2,B]  165-21-186ms   | [S3,MB3,F]  190-10-201ms   | [S3,MB3,B]  207-21-228ms   | [S3,MB4,F]  231-10-242ms   | [S3,MB4,B]  248-21-270ms   | [S3,MB5,F]  273-10-284ms   | [S3,MB5,B]  290-21-311ms   | [S3,MB6,F]  315-10-326ms   | [S3,MB6,B]  332-21-353ms   | [S3,MB7,F]  357-10-368ms   | [S3,MB7,B]  374-21-395ms  
[rank3]:2025-12-23 20:55:28,030 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2055_stage3_step700.svg
[rank2]:2025-12-23 20:55:29,506 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2055_stage2.svg
[rank0]:2025-12-23 20:55:29,513 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2055_stage0.svg
[rank1]:2025-12-23 20:55:29,543 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2055_stage1.svg
[rank3]:2025-12-23 20:55:29,652 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2055_stage3.svg
[rank0]:2025-12-23 20:56:58,083 - Avg. fwd time: 7.6251 / Avg. bwd time: 21.1801 / Avg. batch time: 454.3576 (ms) / GPU bubble ratio: 49.28%
[rank3]:2025-12-23 20:56:58,024 - Avg. fwd time: 11.5214 / Avg. bwd time: 27.3056 / Avg. batch time: 382.6098 (ms) / GPU bubble ratio: 18.82%
[rank2]:2025-12-23 20:56:58,046 - Avg. fwd time: 7.3161 / Avg. bwd time: 18.8056 / Avg. batch time: 405.6036 (ms) / GPU bubble ratio: 48.48%
[rank1]:2025-12-23 20:56:58,070 - Avg. fwd time: 9.8304 / Avg. bwd time: 24.7276 / Avg. batch time: 436.2319 (ms) / GPU bubble ratio: 36.62%
[rank0]:2025-12-23 20:58:23,679 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-23 20:58:27,194 - Avg. fwd time: 7.6250 / Avg. bwd time: 21.1697 / Avg. batch time: 453.4704 (ms) / GPU bubble ratio: 49.20%
[rank3]:2025-12-23 20:58:27,135 - Avg. fwd time: 11.5145 / Avg. bwd time: 27.2305 / Avg. batch time: 381.9532 (ms) / GPU bubble ratio: 18.85%
[rank2]:2025-12-23 20:58:27,157 - Avg. fwd time: 7.3166 / Avg. bwd time: 18.8052 / Avg. batch time: 404.8869 (ms) / GPU bubble ratio: 48.39%
[rank2]:2025-12-23 20:58:27,216 -  step: 750  loss: -8.0000  grad_norm:  0.1811  memory:  6.98GiB(14.69%)  tps: 9,133  tflops: 71.40  mfu: 22.88%
[rank1]:2025-12-23 20:58:27,181 - Avg. fwd time: 9.8331 / Avg. bwd time: 24.7312 / Avg. batch time: 435.4519 (ms) / GPU bubble ratio: 36.50%
[rank1]:2025-12-23 20:58:27,220 -  step: 750  loss: -8.0000  grad_norm:  0.1811  memory:  9.56GiB(20.12%)  tps: 9,133  tflops: 71.40  mfu: 22.88%
[rank0]:2025-12-23 20:58:27,230 -  step: 750  loss: -8.0000  grad_norm:  0.1811  memory: 13.42GiB(28.26%)  tps: 9,133  tflops: 71.40  mfu: 22.88%
[rank3]:2025-12-23 20:58:27,229 -  step: 750  loss:  0.2393  grad_norm:  0.1811  memory: 16.39GiB(34.50%)  tps: 9,133  tflops: 71.40  mfu: 22.89%
[rank3]:2025-12-23 20:59:55,177 - Avg. fwd time: 11.5054 / Avg. bwd time: 27.1440 / Avg. batch time: 381.1957 (ms) / GPU bubble ratio: 18.89%
[rank2]:2025-12-23 20:59:55,200 - Avg. fwd time: 7.3176 / Avg. bwd time: 18.8057 / Avg. batch time: 404.0741 (ms) / GPU bubble ratio: 48.28%
[rank1]:2025-12-23 20:59:55,225 - Avg. fwd time: 9.8374 / Avg. bwd time: 24.7411 / Avg. batch time: 434.6119 (ms) / GPU bubble ratio: 36.35%
[rank0]:2025-12-23 20:59:55,238 - Avg. fwd time: 7.6251 / Avg. bwd time: 21.1492 / Avg. batch time: 452.4712 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-12-23 21:01:20,354 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-23 21:01:23,943 - Avg. fwd time: 11.4978 / Avg. bwd time: 27.0679 / Avg. batch time: 380.5313 (ms) / GPU bubble ratio: 18.92%
[rank2]:2025-12-23 21:01:23,966 - Avg. fwd time: 7.3186 / Avg. bwd time: 18.8062 / Avg. batch time: 403.3583 (ms) / GPU bubble ratio: 48.19%
[rank1]:2025-12-23 21:01:23,991 - Avg. fwd time: 9.8413 / Avg. bwd time: 24.7496 / Avg. batch time: 433.8644 (ms) / GPU bubble ratio: 36.22%
[rank0]:2025-12-23 21:01:24,004 - Avg. fwd time: 7.6260 / Avg. bwd time: 21.1455 / Avg. batch time: 451.6474 (ms) / GPU bubble ratio: 49.04%
[rank3]:2025-12-23 21:01:24,039 -  step: 800  loss:  0.2424  grad_norm:  0.1077  memory: 16.39GiB(34.50%)  tps: 9,267  tflops: 72.44  mfu: 23.22%
[rank3]:2025-12-23 21:01:24,039 - â„¹ï¸ final step: 800  loss:  0.2424  grad_norm:  0.1077  tps: 9,252  tflops: 72.33  mfu: 21.38%
[rank3]:2025-12-23 21:01:24,040 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-23 21:01:24,041 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-23 21:01:24,026 -  step: 800  loss: -8.0000  grad_norm:  0.1077  memory:  6.98GiB(14.69%)  tps: 9,266  tflops: 72.44  mfu: 23.22%
[rank2]:2025-12-23 21:01:24,026 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1077  tps: 9,250  tflops: 72.31  mfu: 21.34%
[rank2]:2025-12-23 21:01:24,026 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-23 21:01:24,027 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-23 21:01:24,030 -  step: 800  loss: -8.0000  grad_norm:  0.1077  memory:  9.56GiB(20.12%)  tps: 9,266  tflops: 72.44  mfu: 23.22%
[rank1]:2025-12-23 21:01:24,030 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1077  tps: 9,244  tflops: 72.27  mfu: 21.24%
[rank1]:2025-12-23 21:01:24,030 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-23 21:01:24,031 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-23 21:01:24,040 -  step: 800  loss: -8.0000  grad_norm:  0.1077  memory: 13.42GiB(28.26%)  tps: 9,266  tflops: 72.44  mfu: 23.22%
[rank0]:2025-12-23 21:01:24,040 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1077  tps: 9,245  tflops: 72.27  mfu: 21.25%
[rank0]:2025-12-23 21:01:24,040 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-23 21:01:24,041 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-23 21:01:26,410 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251223_2101_stage1_final800.svg
[rank0]:2025-12-23 21:01:26,338 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-23 21:01:26,410 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251223_2101_stage0_final800.svg
[rank2]:2025-12-23 21:01:26,408 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251223_2101_stage2_final800.svg
[rank3]:2025-12-23 21:01:26,492 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2101_final800_rank3.svg
[rank3]:			> Batch Time: 428.75 ms, GPU Bubble Ratio: 47.03%, 35.28%, 51.26%, 31.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  148-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  202-25-228ms   | [S0,MB5,F]  228-7-235ms    | [S0,MB2,B]  245-25-270ms   | [S0,MB6,F]  271-7-278ms    | [S0,MB3,B]  288-25-313ms   | [S0,MB7,F]  313-7-320ms    | [S0,MB4,B]  332-25-357ms   | [S0,MB5,B]  375-25-400ms   | [S0,MB6,B]  411-14-425ms   | [S0,MB7,B]  428-0-428ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  117-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  172-25-198ms   | [S1,MB4,F]  201-9-210ms    | [S1,MB2,B]  214-26-240ms   | [S1,MB5,F]  244-9-253ms    | [S1,MB3,B]  256-26-283ms   | [S1,MB6,F]  286-10-296ms   | [S1,MB4,B]  299-27-327ms   | [S1,MB7,F]  330-10-341ms   | [S1,MB5,B]  343-27-371ms   | [S1,MB6,B]  381-26-407ms   | [S1,MB7,B]  411-12-424ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  148-20-168ms   | [S2,MB3,F]  170-7-177ms    | [S2,MB2,B]  190-20-210ms   | [S2,MB4,F]  213-7-220ms    | [S2,MB3,B]  232-20-252ms   | [S2,MB5,F]  254-7-262ms    | [S2,MB4,B]  273-20-294ms   | [S2,MB6,F]  297-7-305ms    | [S2,MB5,B]  315-20-335ms   | [S2,MB7,F]  342-7-349ms    | [S2,MB6,B]  357-20-377ms   | [S2,MB7,B]  397-9-406ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  92-10-102ms    | [S3,MB1,B]  108-35-144ms   | [S3,MB2,F]  147-11-158ms   | [S3,MB2,B]  164-21-185ms   | [S3,MB3,F]  189-10-199ms   | [S3,MB3,B]  205-21-227ms   | [S3,MB4,F]  230-10-241ms   | [S3,MB4,B]  247-21-268ms   | [S3,MB5,F]  272-10-283ms   | [S3,MB5,B]  289-21-310ms   | [S3,MB6,F]  314-11-325ms   | [S3,MB6,B]  331-21-352ms   | [S3,MB7,F]  355-11-366ms   | [S3,MB7,B]  372-21-394ms  
[rank2]:2025-12-23 21:01:26,560 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251223_2101_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank1]:2025-12-23 21:01:26,563 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251223_2101_rank1_stage1.svg
[rank1]:	> Counts Sum: 293760, Total Sum: 2102400 (13.97%), Ratio(%) per element: [14.04, 13.69, 14.21, 14.55, 14.04, 13.69, 14.21, 13.52, 14.55, 14.21, 14.55, 14.04, 13.69, 13.18, 14.21, 14.04, 13.18, 14.55, 14.04, 13.35, 14.38, 14.38, 13.52, 13.69, 14.38, 14.38, 13.69, 13.52, 13.86, 14.72, 14.21, 14.72, 13.18, 14.04, 13.01, 14.04, 14.21, 13.86, 14.89, 13.86, 13.52, 14.38, 13.52, 13.35, 13.69]
[rank0]:2025-12-23 21:01:26,571 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251223_2101_rank0_stage0.svg
[rank0]:	> Counts Sum: 337440, Total Sum: 1728640 (19.52%), Ratio(%) per element: [22.77, 23.11, 22.6, 23.11, 22.94, 21.06, 21.4, 21.91, 21.57, 22.6, 22.08, 21.74, 21.06, 21.57, 21.23, 20.54, 19.52, 21.06, 20.2, 19.86, 19.69, 18.49, 18.32, 19.0, 17.8, 19.34, 17.97, 17.63, 16.6, 17.29, 15.92, 16.26, 15.75, 15.92, 14.21, 16.26, 13.69]
[rank3]:2025-12-23 21:01:26,628 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251223_2101_thry_final800_rank3.svg
[rank3]:			> Batch Time: 296.62 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  89-17-107ms    | [S0,MB4,F]  107-8-116ms    | [S0,MB1,B]  116-17-134ms   | [S0,MB5,F]  134-8-143ms    | [S0,MB2,B]  143-17-161ms   | [S0,MB6,F]  161-8-170ms    | [S0,MB3,B]  170-17-188ms   | [S0,MB7,F]  188-8-197ms    | [S0,MB4,B]  197-17-215ms   | [S0,MB5,B]  224-17-242ms   | [S0,MB6,B]  251-17-269ms   | [S0,MB7,B]  278-17-296ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-35ms      | [S1,MB0,B]  71-17-89ms     | [S1,MB3,F]  89-8-98ms      | [S1,MB1,B]  98-17-116ms    | [S1,MB4,F]  116-8-125ms    | [S1,MB2,B]  125-17-143ms   | [S1,MB5,F]  143-8-152ms    | [S1,MB3,B]  152-17-170ms   | [S1,MB6,F]  170-8-179ms    | [S1,MB4,B]  179-17-197ms   | [S1,MB7,F]  197-8-206ms    | [S1,MB5,B]  206-17-224ms   | [S1,MB6,B]  233-17-251ms   | [S1,MB7,B]  260-17-278ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-35ms      | [S2,MB0,B]  53-17-71ms     | [S2,MB2,F]  71-8-80ms      | [S2,MB1,B]  80-17-98ms     | [S2,MB3,F]  98-8-107ms     | [S2,MB2,B]  107-17-125ms   | [S2,MB4,F]  125-8-134ms    | [S2,MB3,B]  134-17-152ms   | [S2,MB5,F]  152-8-161ms    | [S2,MB4,B]  161-17-179ms   | [S2,MB6,F]  179-8-188ms    | [S2,MB5,B]  188-17-206ms   | [S2,MB7,F]  206-8-215ms    | [S2,MB6,B]  215-17-233ms   | [S2,MB7,B]  242-17-260ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-35ms      | [S3,MB0,B]  35-17-53ms     | [S3,MB1,F]  53-8-62ms      | [S3,MB1,B]  62-17-80ms     | [S3,MB2,F]  80-8-89ms      | [S3,MB2,B]  89-17-107ms    | [S3,MB3,F]  107-8-116ms    | [S3,MB3,B]  116-17-134ms   | [S3,MB4,F]  134-8-143ms    | [S3,MB4,B]  143-17-161ms   | [S3,MB5,F]  161-8-170ms    | [S3,MB5,B]  170-17-188ms   | [S3,MB6,F]  188-8-197ms    | [S3,MB6,B]  197-17-215ms   | [S3,MB7,F]  215-8-224ms    | [S3,MB7,B]  224-17-242ms  
[rank3]:2025-12-23 21:01:26,675 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251223_2101_stage3_final800.svg
[rank3]:2025-12-23 21:01:26,808 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251223_2101_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [75.85, 75.34, 74.14, 75.68, 76.19, 76.19, 74.31, 74.48, 75.34, 74.82, 76.54, 74.48, 77.22, 74.48, 75.68, 74.82, 77.05, 76.36, 75.0, 74.48, 77.05, 75.68, 74.31, 76.71, 76.88, 74.31, 75.68, 74.82, 76.54]
[rank2]:2025-12-23 21:01:28,392 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2101_stage2.svg
[rank2]:2025-12-23 21:01:28,395 - Destroying the purge thread.
[rank1]:2025-12-23 21:01:28,459 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2101_stage1.svg
[rank1]:2025-12-23 21:01:28,462 - Destroying the purge thread.
[rank0]:2025-12-23 21:01:28,437 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2101_stage0.svg
[rank0]:2025-12-23 21:01:28,440 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-23 21:01:28,671 - Process group destroyed
[rank1]:2025-12-23 21:01:28,722 - Process group destroyed
[rank3]:2025-12-23 21:01:28,666 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1/afr_time_plot/251223_2101_stage3.svg
[rank3]:2025-12-23 21:01:28,670 - Destroying the purge thread.
[rank3]:wandb: uploading history steps 15-15, summary, console lines 313-332
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.54184
[rank3]:wandb:               final/avg_loss 0.24245
[rank3]:wandb:             final/avg_mfu(%) 21.38148
[rank3]:wandb:             final/avg_tflops 72.32535
[rank3]:wandb:    final/avg_throughput(tps) 9251.67624
[rank3]:wandb:              final/grad_norm 0.10774
[rank3]:wandb:               final/max_loss 0.24245
[rank3]:wandb:                    grad_norm 0.10774
[rank3]:wandb: loss_metrics/global_avg_loss 0.24245
[rank3]:wandb: loss_metrics/global_max_loss 0.24245
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1223_1F1B_fullrand7_mfr0.8_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/2ar7wbr9
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.8_42_dm1/20251223-2011/wandb/run-20251223_201112-2ar7wbr9/logs
[rank3]:2025-12-23 21:01:30,256 - Process group destroyed
[rank0]:2025-12-23 21:01:30,441 - Training completed
[rank0]:2025-12-23 21:01:30,441 - Destroying the purge thread.
[rank0]:2025-12-23 21:01:30,727 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.4', 'layers.6', 'layers.5', 'layers.7'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.0', 'layers.1', 'layers.3', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.9', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.13', 'output', 'layers.14', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1223_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
