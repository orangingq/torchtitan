
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 01:58:55 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1223_1F1B_fullrand7_mfr0.9_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.9) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.9
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-24 01:59:02,137 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank2]:2025-12-24 01:59:02,137 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank2]:"
[rank1]:2025-12-24 01:59:02,241 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank1]:"
[rank0]:2025-12-24 01:59:02,292 - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank0]:"
[rank3]:2025-12-24 01:59:02,357 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 01:59:02,359 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-24 01:59:02,364 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 01:59:02,366 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-24 01:59:02,492 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 01:59:02,495 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 01:59:02,522 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 01:59:02,525 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 01:59:02,528 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 01:59:02,529 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-24 01:59:02,916 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-24 01:59:05,651 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-24 01:59:05,721 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 01:59:05,761 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 01:59:05,787 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-24 01:59:05,787 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-24 01:59:05,800 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 01:59:05,838 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 01:59:05,839 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-24 01:59:05,863 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-24 01:59:05,864 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-24 01:59:05,980 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 01:59:05,980 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 01:59:05,981 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-24 01:59:06,070 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 01:59:06,070 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 01:59:06,071 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-24 01:59:06,352 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 01:59:06,392 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 01:59:06,417 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-24 01:59:06,417 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank2]:2025-12-24 01:59:06,658 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 01:59:06,659 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 01:59:06,659 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: setting up run z2q6q6ai
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.9_42_dm1/20251224-0159/wandb/run-20251224_015906-z2q6q6ai
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/z2q6q6ai
[rank3]:2025-12-24 01:59:07,928 - WandB logging enabled
[rank3]:2025-12-24 01:59:07,928 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 01:59:07,969 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 01:59:07,998 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-24 01:59:07,998 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-24 01:59:08,201 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-24 01:59:08,185 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 01:59:08,185 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 01:59:08,201 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:2025-12-24 01:59:08,186 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-12-24 01:59:08,201 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 01:59:08,201 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 01:59:08,201 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-24 01:59:08,200 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-24 01:59:08,201 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 01:59:10,202 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 01:59:10,202 - Finished loading the checkpoint in 2.00 seconds.
[rank0]:2025-12-24 01:59:10,202 - Training starts at step 1
[rank3]:2025-12-24 01:59:15,689 -  step:  1  loss: 10.6088  grad_norm: 116.5368  memory: 12.97GiB(27.31%)  tps: 4,246  tflops: 33.19  mfu: 10.64%
[rank3]:2025-12-24 01:59:15,690 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 01:59:15,683 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory:  7.10GiB(14.94%)  tps: 3,303  tflops: 25.82  mfu: 8.28%
[rank1]:2025-12-24 01:59:15,688 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-24 01:59:15,680 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory:  5.20GiB(10.94%)  tps: 3,528  tflops: 27.58  mfu: 8.84%
[rank2]:2025-12-24 01:59:15,680 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 01:59:15,716 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory:  9.62GiB(20.24%)  tps: 3,317  tflops: 25.93  mfu: 8.31%
[rank0]:2025-12-24 01:59:15,717 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 02:01:14,688 - Avg. fwd time: 9.3210 / Avg. bwd time: 24.9372 / Avg. batch time: 565.6226 (ms) / GPU bubble ratio: 51.55%
[rank0]:2025-12-24 02:01:14,718 - Avg. fwd time: 7.5638 / Avg. bwd time: 24.8832 / Avg. batch time: 604.2421 (ms) / GPU bubble ratio: 57.04%
[rank3]:2025-12-24 02:01:14,633 - Avg. fwd time: 12.1730 / Avg. bwd time: 40.4711 / Avg. batch time: 493.1212 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 02:01:14,658 - Avg. fwd time: 7.2266 / Avg. bwd time: 19.5688 / Avg. batch time: 525.6477 (ms) / GPU bubble ratio: 59.22%
[rank0]:2025-12-24 02:03:15,509 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-24 02:03:20,461 - Avg. fwd time: 9.3529 / Avg. bwd time: 25.0450 / Avg. batch time: 569.8119 (ms) / GPU bubble ratio: 51.71%
[rank3]:2025-12-24 02:03:20,406 - Avg. fwd time: 12.4540 / Avg. bwd time: 40.7967 / Avg. batch time: 497.9069 (ms) / GPU bubble ratio: 14.44%
[rank2]:2025-12-24 02:03:20,431 - Avg. fwd time: 7.2368 / Avg. bwd time: 19.6301 / Avg. batch time: 530.0858 (ms) / GPU bubble ratio: 59.45%
[rank1]:2025-12-24 02:03:20,515 -  step: 50  loss: -8.0000  grad_norm: 12.9861  memory:  9.50GiB(19.99%)  tps: 6,558  tflops: 51.27  mfu: 16.43%
[rank0]:2025-12-24 02:03:20,490 - Avg. fwd time: 7.5803 / Avg. bwd time: 24.9484 / Avg. batch time: 608.1383 (ms) / GPU bubble ratio: 57.21%
[rank0]:2025-12-24 02:03:20,526 -  step: 50  loss: -8.0000  grad_norm: 12.9861  memory: 13.42GiB(28.26%)  tps: 6,559  tflops: 51.27  mfu: 16.43%
[rank3]:2025-12-24 02:03:20,524 -  step: 50  loss:  9.9193  grad_norm: 12.9861  memory: 16.88GiB(35.53%)  tps: 6,558  tflops: 51.27  mfu: 16.43%
[rank2]:2025-12-24 02:03:20,512 -  step: 50  loss: -8.0000  grad_norm: 12.9861  memory:  6.98GiB(14.69%)  tps: 6,558  tflops: 51.27  mfu: 16.43%
[rank3]:2025-12-24 02:04:05,665 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-24 02:04:56,109 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-24 02:04:56,421 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-12-24 02:05:15,630 - Avg. fwd time: 9.3524 / Avg. bwd time: 23.9613 / Avg. batch time: 555.9326 (ms) / GPU bubble ratio: 52.06%
[rank3]:2025-12-24 02:05:15,600 - Avg. fwd time: 12.4403 / Avg. bwd time: 39.3556 / Avg. batch time: 486.2410 (ms) / GPU bubble ratio: 14.78%
[rank0]:2025-12-24 02:05:15,635 - Avg. fwd time: 7.5823 / Avg. bwd time: 22.9755 / Avg. batch time: 592.1593 (ms) / GPU bubble ratio: 58.72%
[rank2]:2025-12-24 02:05:15,614 - Avg. fwd time: 7.2343 / Avg. bwd time: 18.7747 / Avg. batch time: 517.4214 (ms) / GPU bubble ratio: 59.79%
[rank3]:2025-12-24 02:05:28,208 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-24 02:05:28,560 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0205_max_batch_time.svg
[rank3]:			> Batch Time: 532.73 ms, GPU Bubble Ratio: 50.76%, 47.88%, 59.29%, 18.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-25-153ms   | [S0,MB4,F]  153-7-160ms    | [S0,MB1,B]  179-25-204ms   | [S0,MB5,F]  204-7-211ms    | [S0,MB2,B]  233-25-258ms   | [S0,MB6,F]  258-7-265ms    | [S0,MB3,B]  287-25-313ms   | [S0,MB7,F]  313-7-320ms    | [S0,MB4,B]  342-25-367ms   | [S0,MB5,B]  396-25-422ms   | [S0,MB6,B]  452-25-477ms   | [S0,MB7,B]  507-25-532ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  154-25-179ms   | [S1,MB4,F]  179-9-188ms    | [S1,MB2,B]  208-25-233ms   | [S1,MB5,F]  233-9-242ms    | [S1,MB3,B]  262-25-287ms   | [S1,MB6,F]  287-9-297ms    | [S1,MB4,B]  317-25-342ms   | [S1,MB7,F]  342-9-351ms    | [S1,MB5,B]  371-25-396ms   | [S1,MB6,B]  426-25-452ms   | [S1,MB7,B]  482-25-507ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  134-19-154ms   | [S2,MB3,F]  154-7-161ms    | [S2,MB2,B]  188-19-208ms   | [S2,MB4,F]  208-7-215ms    | [S2,MB3,B]  242-19-262ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  297-19-317ms   | [S2,MB6,F]  317-7-324ms    | [S2,MB5,B]  351-19-371ms   | [S2,MB7,F]  371-7-378ms    | [S2,MB6,B]  406-19-426ms   | [S2,MB7,B]  462-19-482ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-12-146ms   | [S3,MB2,B]  146-41-188ms   AFR(10):0.9655 | [S3,MB3,F]  188-12-200ms   | [S3,MB3,B]  200-41-242ms   AFR(10):0.9655 | [S3,MB4,F]  242-12-255ms   | [S3,MB4,B]  255-41-297ms   AFR(10):0.9655 | [S3,MB5,F]  297-13-310ms   | [S3,MB5,B]  310-41-351ms   AFR(10):0.9655 | [S3,MB6,F]  351-13-365ms   | [S3,MB6,B]  365-41-406ms   AFR(10):0.9655 | [S3,MB7,F]  406-13-420ms   | [S3,MB7,B]  420-41-462ms   AFR(10):0.9655
[rank3]:2025-12-24 02:05:28,690 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0205_min_batch_time.svg
[rank3]:			> Batch Time: 322.60 ms, GPU Bubble Ratio: 81.12%, 49.51%, 60.73%, 15.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  82-0-82ms      | [S0,MB4,F]  82-7-90ms      | [S0,MB1,B]  114-0-114ms    | [S0,MB5,F]  114-7-121ms    | [S0,MB2,B]  148-0-148ms    | [S0,MB6,F]  148-7-155ms    | [S0,MB3,B]  182-0-182ms    | [S0,MB7,F]  182-7-189ms    | [S0,MB4,B]  217-0-217ms    | [S0,MB5,B]  252-0-252ms    | [S0,MB6,B]  286-0-286ms    | [S0,MB7,B]  322-0-322ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  72-10-82ms     | [S1,MB3,F]  82-9-92ms      | [S1,MB1,B]  103-10-114ms   | [S1,MB4,F]  114-9-123ms    | [S1,MB2,B]  137-10-148ms   | [S1,MB5,F]  148-9-157ms    | [S1,MB3,B]  171-11-182ms   | [S1,MB6,F]  182-9-191ms    | [S1,MB4,B]  206-11-217ms   | [S1,MB7,F]  217-9-226ms    | [S1,MB5,B]  240-11-252ms   | [S1,MB6,B]  275-10-286ms   | [S1,MB7,B]  311-10-322ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  63-8-72ms      | [S2,MB2,F]  72-7-79ms      | [S2,MB1,B]  95-8-103ms     | [S2,MB3,F]  103-7-110ms    | [S2,MB2,B]  128-8-137ms    | [S2,MB4,F]  137-7-144ms    | [S2,MB3,B]  162-8-171ms    | [S2,MB5,F]  171-7-178ms    | [S2,MB4,B]  197-8-206ms    | [S2,MB6,F]  206-7-213ms    | [S2,MB5,B]  232-8-240ms    | [S2,MB7,F]  240-7-248ms    | [S2,MB6,B]  267-8-275ms    | [S2,MB7,B]  303-8-311ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-20-63ms     AFR(10):0.9655 | [S3,MB1,F]  63-10-74ms     | [S3,MB1,B]  74-20-95ms     AFR(10):0.9655 | [S3,MB2,F]  95-12-107ms    | [S3,MB2,B]  107-20-128ms   AFR(10):0.9655 | [S3,MB3,F]  128-12-141ms   | [S3,MB3,B]  141-21-162ms   AFR(10):0.9655 | [S3,MB4,F]  162-12-175ms   | [S3,MB4,B]  175-22-197ms   AFR(10):0.9655 | [S3,MB5,F]  197-13-210ms   | [S3,MB5,B]  210-21-232ms   AFR(10):0.9655 | [S3,MB6,F]  232-13-245ms   | [S3,MB6,B]  245-21-267ms   AFR(10):0.9655 | [S3,MB7,F]  267-13-281ms   | [S3,MB7,B]  281-22-303ms   AFR(10):0.9655
[rank3]:2025-12-24 02:05:28,831 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0205_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 338.07 ms, GPU Bubble Ratio: 34.08%, 22.27%, 39.17%, 14.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  124-25-149ms   | [S0,MB4,F]  149-7-156ms    | [S0,MB1,B]  158-25-183ms   | [S0,MB5,F]  183-7-191ms    | [S0,MB2,B]  193-25-218ms   | [S0,MB6,F]  218-7-225ms    | [S0,MB3,B]  227-25-252ms   | [S0,MB7,F]  252-7-260ms    | [S0,MB4,B]  262-25-287ms   | [S0,MB5,B]  296-25-322ms   | [S0,MB6,B]  327-10-338ms   | [S0,MB7,B]  338-0-338ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  98-25-124ms    | [S1,MB3,F]  124-9-133ms    | [S1,MB1,B]  133-25-158ms   | [S1,MB4,F]  158-9-167ms    | [S1,MB2,B]  167-25-193ms   | [S1,MB5,F]  193-9-202ms    | [S1,MB3,B]  202-25-227ms   | [S1,MB6,F]  227-9-236ms    | [S1,MB4,B]  236-25-262ms   | [S1,MB7,F]  262-9-271ms    | [S1,MB5,B]  271-25-296ms   | [S1,MB6,B]  302-24-327ms   | [S1,MB7,B]  327-10-338ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  78-19-98ms     | [S2,MB2,F]  98-7-105ms     | [S2,MB1,B]  110-19-130ms   | [S2,MB3,F]  133-7-140ms    | [S2,MB2,B]  144-19-164ms   | [S2,MB4,F]  167-7-174ms    | [S2,MB3,B]  178-19-197ms   | [S2,MB5,F]  202-7-209ms    | [S2,MB4,B]  213-19-232ms   | [S2,MB6,F]  236-7-243ms    | [S2,MB5,B]  247-19-267ms   | [S2,MB7,F]  271-7-278ms    | [S2,MB6,B]  282-19-302ms   | [S2,MB7,B]  318-8-327ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-35-78ms     AFR(10):0.9655 | [S3,MB1,F]  78-10-89ms     | [S3,MB1,B]  89-20-110ms    AFR(10):0.9655 | [S3,MB2,F]  110-12-123ms   | [S3,MB2,B]  123-20-144ms   AFR(10):0.9655 | [S3,MB3,F]  144-12-156ms   | [S3,MB3,B]  156-21-178ms   AFR(10):0.9655 | [S3,MB4,F]  178-12-190ms   | [S3,MB4,B]  190-22-213ms   AFR(10):0.9655 | [S3,MB5,F]  213-13-226ms   | [S3,MB5,B]  226-21-247ms   AFR(10):0.9655 | [S3,MB6,F]  247-13-261ms   | [S3,MB6,B]  261-21-282ms   AFR(10):0.9655 | [S3,MB7,F]  282-13-296ms   | [S3,MB7,B]  296-22-318ms   AFR(10):0.9655
[rank3]:2025-12-24 02:05:28,832 - 	> Batch Time: 338.07 ms (Average Freeze Ratio: 0.34, Time Reduction Rate: 0.37)
[rank3]:2025-12-24 02:06:47,735 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.07(0.07)/0.20, [MB1] 0.28(0.33)/1.00, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-24 02:06:47,920 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.01)/0.04, [MB7] 0.27(0.33)/1.00
[rank2]:2025-12-24 02:06:47,896 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-24 02:06:47,941 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 02:06:47,941 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.16(0.19)/0.57, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-24 02:06:52,629 - Avg. fwd time: 9.4213 / Avg. bwd time: 23.6393 / Avg. batch time: 529.0661 (ms) / GPU bubble ratio: 50.01%
[rank3]:2025-12-24 02:06:52,582 - Avg. fwd time: 12.2709 / Avg. bwd time: 36.5363 / Avg. batch time: 462.3220 (ms) / GPU bubble ratio: 15.54%
[rank2]:2025-12-24 02:06:52,603 - Avg. fwd time: 7.2410 / Avg. bwd time: 18.4287 / Avg. batch time: 492.2933 (ms) / GPU bubble ratio: 58.29%
[rank2]:2025-12-24 02:06:52,677 -  step: 100  loss: -8.0000  grad_norm:  8.1989  memory:  6.98GiB(14.69%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank0]:2025-12-24 02:06:52,656 - Avg. fwd time: 7.5822 / Avg. bwd time: 21.8493 / Avg. batch time: 561.4569 (ms) / GPU bubble ratio: 58.06%
[rank1]:2025-12-24 02:06:52,681 -  step: 100  loss: -8.0000  grad_norm:  8.1989  memory:  9.50GiB(19.99%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank1]:2025-12-24 02:06:52,750 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0206_stage1_step100.svg
[rank3]:2025-12-24 02:06:52,690 -  step: 100  loss:  8.7384  grad_norm:  8.1989  memory: 16.88GiB(35.53%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank2]:2025-12-24 02:06:52,750 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0206_stage2_step100.svg
[rank0]:2025-12-24 02:06:52,692 -  step: 100  loss: -8.0000  grad_norm:  8.1989  memory: 13.42GiB(28.26%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank0]:2025-12-24 02:06:52,751 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0206_stage0_step100.svg
[rank1]:2025-12-24 02:06:52,851 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0206_stage1.svg
[rank3]:2025-12-24 02:06:52,829 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0206_step100_rank3.svg
[rank3]:			> Batch Time: 545.14 ms, GPU Bubble Ratio: 54.54%, 49.66%, 60.71%, 30.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  146-25-171ms   | [S0,MB4,F]  171-7-178ms    | [S0,MB1,B]  204-25-229ms   | [S0,MB5,F]  229-7-236ms    | [S0,MB2,B]  264-25-289ms   | [S0,MB6,F]  289-7-296ms    | [S0,MB3,B]  325-25-350ms   | [S0,MB7,F]  350-7-357ms    | [S0,MB4,B]  388-25-413ms   | [S0,MB5,B]  439-25-464ms   | [S0,MB6,B]  487-18-505ms   | [S0,MB7,B]  527-17-545ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB0,B]  115-25-141ms   | [S1,MB3,F]  144-9-153ms    | [S1,MB1,B]  174-25-199ms   | [S1,MB4,F]  202-9-212ms    | [S1,MB2,B]  233-25-258ms   | [S1,MB5,F]  262-9-271ms    | [S1,MB3,B]  295-25-320ms   | [S1,MB6,F]  324-9-333ms    | [S1,MB4,B]  357-25-382ms   | [S1,MB7,F]  386-9-395ms    | [S1,MB5,B]  410-25-435ms   | [S1,MB6,B]  458-25-484ms   | [S1,MB7,B]  502-21-524ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  92-19-112ms    | [S2,MB2,F]  114-6-121ms    | [S2,MB1,B]  150-19-170ms   | [S2,MB3,F]  172-7-179ms    | [S2,MB2,B]  209-19-229ms   | [S2,MB4,F]  231-7-238ms    | [S2,MB3,B]  271-19-291ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB4,B]  333-19-353ms   | [S2,MB6,F]  355-7-362ms    | [S2,MB5,B]  386-19-406ms   | [S2,MB7,F]  408-7-416ms    | [S2,MB6,B]  435-20-455ms   | [S2,MB7,B]  482-16-499ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-38-87ms     | [S3,MB1,F]  90-10-101ms    | [S3,MB1,B]  107-37-145ms   | [S3,MB2,F]  148-12-160ms   | [S3,MB2,B]  166-37-204ms   | [S3,MB3,F]  208-12-221ms   | [S3,MB3,B]  226-39-266ms   | [S3,MB4,F]  270-12-282ms   | [S3,MB4,B]  288-39-328ms   | [S3,MB5,F]  332-12-344ms   | [S3,MB5,B]  350-30-381ms   | [S3,MB6,F]  385-11-396ms   | [S3,MB6,B]  402-27-430ms   | [S3,MB7,F]  433-11-445ms   | [S3,MB7,B]  452-28-480ms  
[rank3]:2025-12-24 02:06:52,871 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0206_stage3_step100.svg
[rank2]:2025-12-24 02:06:52,842 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0206_stage2.svg
[rank0]:2025-12-24 02:06:52,852 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0206_stage0.svg
[rank3]:2025-12-24 02:06:52,964 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0206_stage3.svg
[rank0]:2025-12-24 02:08:44,123 - Avg. fwd time: 7.5899 / Avg. bwd time: 22.2257 / Avg. batch time: 557.0136 (ms) / GPU bubble ratio: 57.18%
[rank3]:2025-12-24 02:08:44,059 - Avg. fwd time: 12.2977 / Avg. bwd time: 36.1097 / Avg. batch time: 459.1146 (ms) / GPU bubble ratio: 15.65%
[rank2]:2025-12-24 02:08:44,080 - Avg. fwd time: 7.2377 / Avg. bwd time: 18.6151 / Avg. batch time: 488.8063 (ms) / GPU bubble ratio: 57.69%
[rank1]:2025-12-24 02:08:44,103 - Avg. fwd time: 9.4429 / Avg. bwd time: 23.8084 / Avg. batch time: 524.8244 (ms) / GPU bubble ratio: 49.31%
[rank3]:2025-12-24 02:10:23,113 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.10(0.13)/0.20, [MB1] 0.59(0.67)/1.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank1]:2025-12-24 02:10:23,305 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.02(0.02)/0.04, [MB7] 0.60(0.67)/1.00
[rank0]:2025-12-24 02:10:23,326 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 02:10:23,327 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.35(0.38)/0.57, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-24 02:10:23,286 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank3]:2025-12-24 02:10:27,250 - Avg. fwd time: 12.2307 / Avg. bwd time: 35.2300 / Avg. batch time: 451.5264 (ms) / GPU bubble ratio: 15.91%
[rank2]:2025-12-24 02:10:27,269 - Avg. fwd time: 7.2412 / Avg. bwd time: 18.6821 / Avg. batch time: 480.3901 (ms) / GPU bubble ratio: 56.83%
[rank1]:2025-12-24 02:10:27,290 - Avg. fwd time: 9.4631 / Avg. bwd time: 23.9270 / Avg. batch time: 515.7323 (ms) / GPU bubble ratio: 48.21%
[rank1]:2025-12-24 02:10:27,334 -  step: 150  loss: -8.0000  grad_norm:  5.2232  memory:  9.50GiB(19.99%)  tps: 7,633  tflops: 59.67  mfu: 19.12%
[rank0]:2025-12-24 02:10:27,309 - Avg. fwd time: 7.5975 / Avg. bwd time: 22.3557 / Avg. batch time: 547.2913 (ms) / GPU bubble ratio: 56.22%
[rank0]:2025-12-24 02:10:27,345 -  step: 150  loss: -8.0000  grad_norm:  5.2232  memory: 13.42GiB(28.26%)  tps: 7,633  tflops: 59.67  mfu: 19.12%
[rank3]:2025-12-24 02:10:27,343 -  step: 150  loss:  4.0834  grad_norm:  5.2232  memory: 16.88GiB(35.53%)  tps: 7,633  tflops: 59.67  mfu: 19.13%
[rank2]:2025-12-24 02:10:27,330 -  step: 150  loss: -8.0000  grad_norm:  5.2232  memory:  6.98GiB(14.69%)  tps: 7,633  tflops: 59.67  mfu: 19.12%
[rank3]:2025-12-24 02:12:05,496 - Avg. fwd time: 12.1528 / Avg. bwd time: 34.2781 / Avg. batch time: 443.2870 (ms) / GPU bubble ratio: 16.21%
[rank1]:2025-12-24 02:12:05,535 - Avg. fwd time: 9.4951 / Avg. bwd time: 24.0160 / Avg. batch time: 506.2280 (ms) / GPU bubble ratio: 47.04%
[rank2]:2025-12-24 02:12:05,513 - Avg. fwd time: 7.2460 / Avg. bwd time: 18.7419 / Avg. batch time: 471.5771 (ms) / GPU bubble ratio: 55.91%
[rank0]:2025-12-24 02:12:05,552 - Avg. fwd time: 7.6034 / Avg. bwd time: 22.3903 / Avg. batch time: 536.7807 (ms) / GPU bubble ratio: 55.30%
[rank3]:2025-12-24 02:13:32,307 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.17(0.20)/0.20, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-24 02:13:32,494 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.04(0.04)/0.04, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-24 02:13:32,477 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank0]:2025-12-24 02:13:32,503 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 02:13:32,503 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.57)/0.57, [MB7] 0.95(1.00)/1.00
[rank1]:2025-12-24 02:13:35,995 - Avg. fwd time: 9.5532 / Avg. bwd time: 24.1684 / Avg. batch time: 494.6465 (ms) / GPU bubble ratio: 45.46%
[rank2]:2025-12-24 02:13:35,975 - Avg. fwd time: 7.2575 / Avg. bwd time: 18.7537 / Avg. batch time: 460.5012 (ms) / GPU bubble ratio: 54.81%
[rank2]:2025-12-24 02:13:36,023 -  step: 200  loss: -8.0000  grad_norm:  1.4352  memory:  6.98GiB(14.69%)  tps: 8,683  tflops: 67.88  mfu: 21.76%
[rank3]:2025-12-24 02:13:35,959 - Avg. fwd time: 12.0438 / Avg. bwd time: 33.1061 / Avg. batch time: 433.0323 (ms) / GPU bubble ratio: 16.59%
[rank0]:2025-12-24 02:13:36,001 - Avg. fwd time: 7.6111 / Avg. bwd time: 22.3424 / Avg. batch time: 524.0517 (ms) / GPU bubble ratio: 54.27%
[rank0]:2025-12-24 02:13:36,037 -  step: 200  loss: -8.0000  grad_norm:  1.4352  memory: 13.42GiB(28.26%)  tps: 8,683  tflops: 67.88  mfu: 21.76%
[rank1]:2025-12-24 02:13:36,027 -  step: 200  loss: -8.0000  grad_norm:  1.4352  memory:  9.56GiB(20.12%)  tps: 8,683  tflops: 67.88  mfu: 21.76%
[rank1]:2025-12-24 02:13:36,088 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0213_stage1_step200.svg
[rank2]:2025-12-24 02:13:36,088 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0213_stage2_step200.svg
[rank3]:2025-12-24 02:13:36,034 -  step: 200  loss:  1.6308  grad_norm:  1.4352  memory: 16.88GiB(35.53%)  tps: 8,683  tflops: 67.88  mfu: 21.76%
[rank0]:2025-12-24 02:13:36,088 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0213_stage0_step200.svg
[rank3]:2025-12-24 02:13:36,181 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0213_step200_rank3.svg
[rank3]:			> Batch Time: 423.39 ms, GPU Bubble Ratio: 45.03%, 32.97%, 50.50%, 33.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  147-25-172ms   | [S0,MB4,F]  172-7-179ms    | [S0,MB1,B]  188-25-214ms   | [S0,MB5,F]  214-7-221ms    | [S0,MB2,B]  231-25-257ms   | [S0,MB6,F]  257-7-264ms    | [S0,MB3,B]  276-25-301ms   | [S0,MB7,F]  301-7-308ms    | [S0,MB4,B]  320-25-345ms   | [S0,MB5,B]  364-25-389ms   | [S0,MB6,B]  400-13-413ms   | [S0,MB7,B]  418-5-423ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  35-9-45ms      | [S1,MB0,B]  116-25-141ms   | [S1,MB3,F]  145-9-154ms    | [S1,MB1,B]  157-25-183ms   | [S1,MB4,F]  187-9-197ms    | [S1,MB2,B]  200-26-226ms   | [S1,MB5,F]  230-10-240ms   | [S1,MB3,B]  243-27-271ms   | [S1,MB6,F]  274-10-284ms   | [S1,MB4,B]  287-27-315ms   | [S1,MB7,F]  318-10-329ms   | [S1,MB5,B]  333-28-361ms   | [S1,MB6,B]  368-28-396ms   | [S1,MB7,B]  400-14-414ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  33-6-39ms      | [S2,MB0,B]  92-20-112ms    | [S2,MB2,F]  114-6-121ms    | [S2,MB1,B]  133-20-153ms   | [S2,MB3,F]  156-7-163ms    | [S2,MB2,B]  175-20-195ms   | [S2,MB4,F]  198-7-205ms    | [S2,MB3,B]  218-20-238ms   | [S2,MB5,F]  242-7-249ms    | [S2,MB4,B]  259-20-280ms   | [S2,MB6,F]  285-7-293ms    | [S2,MB5,B]  302-20-322ms   | [S2,MB7,F]  331-7-338ms    | [S2,MB6,B]  344-20-365ms   | [S2,MB7,B]  385-8-394ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-38-87ms     | [S3,MB1,F]  91-10-101ms    | [S3,MB1,B]  107-20-128ms   | [S3,MB2,F]  132-10-142ms   | [S3,MB2,B]  148-22-170ms   | [S3,MB3,F]  174-10-184ms   | [S3,MB3,B]  190-22-213ms   | [S3,MB4,F]  216-10-227ms   | [S3,MB4,B]  233-21-255ms   | [S3,MB5,F]  258-10-269ms   | [S3,MB5,B]  274-22-297ms   | [S3,MB6,F]  300-10-311ms   | [S3,MB6,B]  317-22-339ms   | [S3,MB7,F]  343-10-354ms   | [S3,MB7,B]  360-21-381ms  
[rank3]:2025-12-24 02:13:36,229 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0213_stage3_step200.svg
[rank0]:2025-12-24 02:13:36,441 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0213_stage0.svg
[rank1]:2025-12-24 02:13:36,427 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0213_stage1.svg
[rank2]:2025-12-24 02:13:36,441 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0213_stage2.svg
[rank3]:2025-12-24 02:13:36,570 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0213_stage3.svg
[rank3]:2025-12-24 02:15:02,911 - Avg. fwd time: 11.9480 / Avg. bwd time: 32.0056 / Avg. batch time: 423.5769 (ms) / GPU bubble ratio: 16.99%
[rank2]:2025-12-24 02:15:02,928 - Avg. fwd time: 7.2717 / Avg. bwd time: 18.7697 / Avg. batch time: 450.4141 (ms) / GPU bubble ratio: 53.75%
[rank0]:2025-12-24 02:15:02,955 - Avg. fwd time: 7.6172 / Avg. bwd time: 22.1849 / Avg. batch time: 511.9656 (ms) / GPU bubble ratio: 53.43%
[rank1]:2025-12-24 02:15:02,948 - Avg. fwd time: 9.6170 / Avg. bwd time: 24.3115 / Avg. batch time: 484.1894 (ms) / GPU bubble ratio: 43.94%
[rank3]:2025-12-24 02:16:25,500 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.21(0.20)/0.20, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-24 02:16:25,688 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 02:16:25,688 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.57(0.57)/0.57, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 02:16:25,684 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.04(0.04)/0.04, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-24 02:16:25,667 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 02:16:29,122 - Avg. fwd time: 9.6696 / Avg. bwd time: 24.4350 / Avg. batch time: 475.8430 (ms) / GPU bubble ratio: 42.66%
[rank3]:2025-12-24 02:16:29,086 - Avg. fwd time: 11.8687 / Avg. bwd time: 31.1251 / Avg. batch time: 416.0045 (ms) / GPU bubble ratio: 17.32%
[rank2]:2025-12-24 02:16:29,102 - Avg. fwd time: 7.2828 / Avg. bwd time: 18.7837 / Avg. batch time: 442.2865 (ms) / GPU bubble ratio: 52.85%
[rank2]:2025-12-24 02:16:29,150 -  step: 250  loss: -8.0000  grad_norm:  0.4686  memory:  6.98GiB(14.69%)  tps: 9,464  tflops: 73.98  mfu: 23.71%
[rank0]:2025-12-24 02:16:29,129 - Avg. fwd time: 7.6205 / Avg. bwd time: 22.0350 / Avg. batch time: 502.1388 (ms) / GPU bubble ratio: 52.75%
[rank0]:2025-12-24 02:16:29,165 -  step: 250  loss: -8.0000  grad_norm:  0.4686  memory: 13.42GiB(28.26%)  tps: 9,464  tflops: 73.98  mfu: 23.71%
[rank1]:2025-12-24 02:16:29,155 -  step: 250  loss: -8.0000  grad_norm:  0.4686  memory:  9.56GiB(20.12%)  tps: 9,464  tflops: 73.98  mfu: 23.71%
[rank3]:2025-12-24 02:16:29,161 -  step: 250  loss:  0.5389  grad_norm:  0.4686  memory: 16.88GiB(35.53%)  tps: 9,464  tflops: 73.98  mfu: 23.71%
[rank0]:2025-12-24 02:17:54,824 - Avg. fwd time: 7.6235 / Avg. bwd time: 21.9383 / Avg. batch time: 493.8600 (ms) / GPU bubble ratio: 52.11%
[rank1]:2025-12-24 02:17:54,816 - Avg. fwd time: 9.7096 / Avg. bwd time: 24.5329 / Avg. batch time: 468.5849 (ms) / GPU bubble ratio: 41.54%
[rank3]:2025-12-24 02:17:54,779 - Avg. fwd time: 11.7973 / Avg. bwd time: 30.3580 / Avg. batch time: 409.3924 (ms) / GPU bubble ratio: 17.62%
[rank2]:2025-12-24 02:17:54,796 - Avg. fwd time: 7.2928 / Avg. bwd time: 18.7979 / Avg. batch time: 435.2221 (ms) / GPU bubble ratio: 52.04%
[rank3]:2025-12-24 02:19:17,882 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.21(0.20)/0.20, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-24 02:19:18,058 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-24 02:19:18,077 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 02:19:18,078 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.57(0.57)/0.57, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 02:19:18,073 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.04(0.04)/0.04, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-24 02:19:21,464 - Avg. fwd time: 11.7425 / Avg. bwd time: 29.7663 / Avg. batch time: 404.3137 (ms) / GPU bubble ratio: 17.87%
[rank2]:2025-12-24 02:19:21,481 - Avg. fwd time: 7.2997 / Avg. bwd time: 18.8082 / Avg. batch time: 429.7677 (ms) / GPU bubble ratio: 51.40%
[rank0]:2025-12-24 02:19:21,509 - Avg. fwd time: 7.6260 / Avg. bwd time: 21.8541 / Avg. batch time: 487.3732 (ms) / GPU bubble ratio: 51.61%
[rank1]:2025-12-24 02:19:21,502 - Avg. fwd time: 9.7470 / Avg. bwd time: 24.6231 / Avg. batch time: 462.9950 (ms) / GPU bubble ratio: 40.61%
[rank1]:2025-12-24 02:19:21,535 -  step: 300  loss: -8.0000  grad_norm:  1.0818  memory:  9.56GiB(20.12%)  tps: 9,505  tflops: 74.30  mfu: 23.81%
[rank3]:2025-12-24 02:19:21,539 -  step: 300  loss:  0.3511  grad_norm:  1.0818  memory: 16.88GiB(35.53%)  tps: 9,505  tflops: 74.30  mfu: 23.82%
[rank2]:2025-12-24 02:19:21,531 -  step: 300  loss: -8.0000  grad_norm:  1.0818  memory:  6.98GiB(14.69%)  tps: 9,505  tflops: 74.30  mfu: 23.81%
[rank2]:2025-12-24 02:19:21,594 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0219_stage2_step300.svg
[rank0]:2025-12-24 02:19:21,545 -  step: 300  loss: -8.0000  grad_norm:  1.0818  memory: 13.42GiB(28.26%)  tps: 9,505  tflops: 74.30  mfu: 23.81%
[rank0]:2025-12-24 02:19:21,594 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0219_stage0_step300.svg
[rank1]:2025-12-24 02:19:21,593 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0219_stage1_step300.svg
[rank3]:2025-12-24 02:19:21,686 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0219_step300_rank3.svg
[rank3]:			> Batch Time: 414.00 ms, GPU Bubble Ratio: 44.95%, 31.00%, 49.21%, 33.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  146-25-171ms   | [S0,MB4,F]  171-7-178ms    | [S0,MB1,B]  188-25-213ms   | [S0,MB5,F]  213-7-220ms    | [S0,MB2,B]  230-25-256ms   | [S0,MB6,F]  256-7-263ms    | [S0,MB3,B]  275-25-300ms   | [S0,MB7,F]  300-7-308ms    | [S0,MB4,B]  320-25-345ms   | [S0,MB5,B]  363-25-388ms   | [S0,MB6,B]  397-14-411ms   | [S0,MB7,B]  414-0-414ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  115-25-141ms   | [S1,MB3,F]  144-9-153ms    | [S1,MB1,B]  156-26-182ms   | [S1,MB4,F]  186-9-195ms    | [S1,MB2,B]  198-26-225ms   | [S1,MB5,F]  229-10-239ms   | [S1,MB3,B]  242-27-269ms   | [S1,MB6,F]  273-10-284ms   | [S1,MB4,B]  286-28-315ms   | [S1,MB7,F]  318-10-329ms   | [S1,MB5,B]  332-28-360ms   | [S1,MB6,B]  364-29-393ms   | [S1,MB7,B]  397-13-410ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  33-6-40ms      | [S2,MB0,B]  91-20-111ms    | [S2,MB2,F]  114-7-121ms    | [S2,MB1,B]  132-20-153ms   | [S2,MB3,F]  155-7-162ms    | [S2,MB2,B]  173-20-193ms   | [S2,MB4,F]  197-7-204ms    | [S2,MB3,B]  214-20-235ms   | [S2,MB5,F]  240-7-247ms    | [S2,MB4,B]  256-20-276ms   | [S2,MB6,F]  284-7-292ms    | [S2,MB5,B]  298-20-318ms   | [S2,MB7,F]  330-7-337ms    | [S2,MB6,B]  341-20-361ms   | [S2,MB7,B]  380-9-389ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  49-37-86ms     | [S3,MB1,F]  90-10-100ms    | [S3,MB1,B]  106-20-127ms   | [S3,MB2,F]  131-10-141ms   | [S3,MB2,B]  147-21-168ms   | [S3,MB3,F]  171-10-182ms   | [S3,MB3,B]  188-21-209ms   | [S3,MB4,F]  213-10-224ms   | [S3,MB4,B]  229-21-251ms   | [S3,MB5,F]  254-10-265ms   | [S3,MB5,B]  271-21-293ms   | [S3,MB6,F]  296-10-307ms   | [S3,MB6,B]  313-21-335ms   | [S3,MB7,F]  339-10-350ms   | [S3,MB7,B]  356-21-377ms  
[rank3]:2025-12-24 02:19:21,730 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0219_stage3_step300.svg
[rank0]:2025-12-24 02:19:22,196 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0219_stage0.svg
[rank1]:2025-12-24 02:19:22,173 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0219_stage1.svg
[rank2]:2025-12-24 02:19:22,209 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0219_stage2.svg
[rank3]:2025-12-24 02:19:22,325 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0219_stage3.svg
[rank1]:2025-12-24 02:20:48,449 - Avg. fwd time: 9.7784 / Avg. bwd time: 24.6962 / Avg. batch time: 458.2415 (ms) / GPU bubble ratio: 39.81%
[rank3]:2025-12-24 02:20:48,411 - Avg. fwd time: 11.6937 / Avg. bwd time: 29.2619 / Avg. batch time: 399.9651 (ms) / GPU bubble ratio: 18.08%
[rank2]:2025-12-24 02:20:48,428 - Avg. fwd time: 7.3061 / Avg. bwd time: 18.8173 / Avg. batch time: 425.1383 (ms) / GPU bubble ratio: 50.84%
[rank0]:2025-12-24 02:20:48,456 - Avg. fwd time: 7.6277 / Avg. bwd time: 21.7518 / Avg. batch time: 481.7414 (ms) / GPU bubble ratio: 51.21%
[rank0]:2025-12-24 02:22:10,232 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-24 02:22:13,663 - Avg. fwd time: 9.8079 / Avg. bwd time: 24.7520 / Avg. batch time: 453.7433 (ms) / GPU bubble ratio: 39.07%
[rank3]:2025-12-24 02:22:13,626 - Avg. fwd time: 11.6495 / Avg. bwd time: 28.7891 / Avg. batch time: 395.9193 (ms) / GPU bubble ratio: 18.29%
[rank3]:2025-12-24 02:22:13,702 -  step: 350  loss:  0.2621  grad_norm:  0.1562  memory: 16.88GiB(35.53%)  tps: 9,517  tflops: 74.40  mfu: 23.85%
[rank2]:2025-12-24 02:22:13,643 - Avg. fwd time: 7.3107 / Avg. bwd time: 18.8230 / Avg. batch time: 420.8172 (ms) / GPU bubble ratio: 50.32%
[rank2]:2025-12-24 02:22:13,693 -  step: 350  loss: -8.0000  grad_norm:  0.1562  memory:  6.98GiB(14.69%)  tps: 9,517  tflops: 74.40  mfu: 23.85%
[rank0]:2025-12-24 02:22:13,671 - Avg. fwd time: 7.6307 / Avg. bwd time: 21.6818 / Avg. batch time: 476.5132 (ms) / GPU bubble ratio: 50.79%
[rank0]:2025-12-24 02:22:13,707 -  step: 350  loss: -8.0000  grad_norm:  0.1562  memory: 13.42GiB(28.26%)  tps: 9,517  tflops: 74.40  mfu: 23.85%
[rank1]:2025-12-24 02:22:13,697 -  step: 350  loss: -8.0000  grad_norm:  0.1562  memory:  9.56GiB(20.12%)  tps: 9,517  tflops: 74.40  mfu: 23.85%
[rank3]:2025-12-24 02:23:40,131 - Avg. fwd time: 11.6130 / Avg. bwd time: 28.4194 / Avg. batch time: 392.7357 (ms) / GPU bubble ratio: 18.45%
[rank1]:2025-12-24 02:23:40,170 - Avg. fwd time: 9.8306 / Avg. bwd time: 24.8036 / Avg. batch time: 450.2029 (ms) / GPU bubble ratio: 38.46%
[rank2]:2025-12-24 02:23:40,149 - Avg. fwd time: 7.3154 / Avg. bwd time: 18.8292 / Avg. batch time: 417.3945 (ms) / GPU bubble ratio: 49.89%
[rank0]:2025-12-24 02:23:40,178 - Avg. fwd time: 7.6330 / Avg. bwd time: 21.6344 / Avg. batch time: 472.4151 (ms) / GPU bubble ratio: 50.44%
[rank0]:2025-12-24 02:25:03,021 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-24 02:25:06,510 - Avg. fwd time: 9.8508 / Avg. bwd time: 24.8500 / Avg. batch time: 447.1421 (ms) / GPU bubble ratio: 37.92%
[rank3]:2025-12-24 02:25:06,469 - Avg. fwd time: 11.5828 / Avg. bwd time: 28.0985 / Avg. batch time: 389.9723 (ms) / GPU bubble ratio: 18.60%
[rank2]:2025-12-24 02:25:06,487 - Avg. fwd time: 7.3196 / Avg. bwd time: 18.8333 / Avg. batch time: 414.4195 (ms) / GPU bubble ratio: 49.51%
[rank2]:2025-12-24 02:25:06,540 -  step: 400  loss: -8.0000  grad_norm:  0.1676  memory:  6.98GiB(14.69%)  tps: 9,479  tflops: 74.10  mfu: 23.75%
[rank0]:2025-12-24 02:25:06,518 - Avg. fwd time: 7.6352 / Avg. bwd time: 21.5754 / Avg. batch time: 468.7885 (ms) / GPU bubble ratio: 50.15%
[rank0]:2025-12-24 02:25:06,554 -  step: 400  loss: -8.0000  grad_norm:  0.1676  memory: 13.42GiB(28.26%)  tps: 9,479  tflops: 74.10  mfu: 23.75%
[rank1]:2025-12-24 02:25:06,544 -  step: 400  loss: -8.0000  grad_norm:  0.1676  memory:  9.56GiB(20.12%)  tps: 9,479  tflops: 74.10  mfu: 23.75%
[rank1]:2025-12-24 02:25:06,606 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0225_stage1_step400.svg
[rank3]:2025-12-24 02:25:06,550 -  step: 400  loss:  0.2321  grad_norm:  0.1676  memory: 16.88GiB(35.53%)  tps: 9,479  tflops: 74.10  mfu: 23.75%
[rank2]:2025-12-24 02:25:06,607 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0225_stage2_step400.svg
[rank0]:2025-12-24 02:25:06,608 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0225_stage0_step400.svg
[rank3]:2025-12-24 02:25:06,693 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0225_step400_rank3.svg
[rank3]:			> Batch Time: 414.00 ms, GPU Bubble Ratio: 45.19%, 31.37%, 49.23%, 33.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  146-25-171ms   | [S0,MB4,F]  171-7-178ms    | [S0,MB1,B]  187-25-213ms   | [S0,MB5,F]  213-7-220ms    | [S0,MB2,B]  230-25-255ms   | [S0,MB6,F]  256-7-263ms    | [S0,MB3,B]  274-25-300ms   | [S0,MB7,F]  300-7-307ms    | [S0,MB4,B]  320-25-345ms   | [S0,MB5,B]  363-25-389ms   | [S0,MB6,B]  396-13-409ms   | [S0,MB7,B]  414-0-414ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  115-25-141ms   | [S1,MB3,F]  144-9-154ms    | [S1,MB1,B]  157-26-183ms   | [S1,MB4,F]  186-9-195ms    | [S1,MB2,B]  198-26-225ms   | [S1,MB5,F]  228-10-239ms   | [S1,MB3,B]  242-27-269ms   | [S1,MB6,F]  273-10-283ms   | [S1,MB4,B]  286-28-314ms   | [S1,MB7,F]  318-10-329ms   | [S1,MB5,B]  332-28-360ms   | [S1,MB6,B]  365-28-393ms   | [S1,MB7,B]  396-13-409ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  33-6-40ms      | [S2,MB0,B]  91-20-111ms    | [S2,MB2,F]  114-6-121ms    | [S2,MB1,B]  132-20-153ms   | [S2,MB3,F]  155-7-162ms    | [S2,MB2,B]  173-20-194ms   | [S2,MB4,F]  196-7-204ms    | [S2,MB3,B]  215-20-235ms   | [S2,MB5,F]  240-7-247ms    | [S2,MB4,B]  256-20-277ms   | [S2,MB6,F]  284-7-292ms    | [S2,MB5,B]  298-20-318ms   | [S2,MB7,F]  330-7-337ms    | [S2,MB6,B]  341-20-362ms   | [S2,MB7,B]  381-9-390ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-37-86ms     | [S3,MB1,F]  90-10-100ms    | [S3,MB1,B]  107-20-127ms   | [S3,MB2,F]  131-10-141ms   | [S3,MB2,B]  147-21-168ms   | [S3,MB3,F]  172-10-182ms   | [S3,MB3,B]  188-21-210ms   | [S3,MB4,F]  213-10-224ms   | [S3,MB4,B]  230-21-251ms   | [S3,MB5,F]  255-10-265ms   | [S3,MB5,B]  271-21-293ms   | [S3,MB6,F]  296-10-307ms   | [S3,MB6,B]  313-21-334ms   | [S3,MB7,F]  340-10-350ms   | [S3,MB7,B]  356-21-378ms  
[rank3]:2025-12-24 02:25:06,741 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0225_stage3_step400.svg
[rank1]:2025-12-24 02:25:07,445 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0225_stage1.svg
[rank2]:2025-12-24 02:25:07,478 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0225_stage2.svg
[rank0]:2025-12-24 02:25:07,485 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0225_stage0.svg
[rank3]:2025-12-24 02:25:07,588 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0225_stage3.svg
[rank3]:2025-12-24 02:25:27,335 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 02:25:27,533 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 02:25:27,512 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 02:25:27,535 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 02:26:33,029 - Avg. fwd time: 9.8690 / Avg. bwd time: 24.8899 / Avg. batch time: 444.1582 (ms) / GPU bubble ratio: 37.39%
[rank2]:2025-12-24 02:26:33,007 - Avg. fwd time: 7.3221 / Avg. bwd time: 18.8367 / Avg. batch time: 411.5117 (ms) / GPU bubble ratio: 49.15%
[rank3]:2025-12-24 02:26:32,989 - Avg. fwd time: 11.5512 / Avg. bwd time: 27.7794 / Avg. batch time: 387.2286 (ms) / GPU bubble ratio: 18.74%
[rank0]:2025-12-24 02:26:33,038 - Avg. fwd time: 7.6362 / Avg. bwd time: 21.5355 / Avg. batch time: 465.3809 (ms) / GPU bubble ratio: 49.85%
[rank0]:2025-12-24 02:27:55,531 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 02:27:58,847 - Avg. fwd time: 11.5246 / Avg. bwd time: 27.5173 / Avg. batch time: 384.9723 (ms) / GPU bubble ratio: 18.87%
[rank2]:2025-12-24 02:27:58,866 - Avg. fwd time: 7.3252 / Avg. bwd time: 18.8398 / Avg. batch time: 409.0883 (ms) / GPU bubble ratio: 48.83%
[rank0]:2025-12-24 02:27:58,897 - Avg. fwd time: 7.6367 / Avg. bwd time: 21.4779 / Avg. batch time: 462.4338 (ms) / GPU bubble ratio: 49.63%
[rank1]:2025-12-24 02:27:58,888 - Avg. fwd time: 9.8848 / Avg. bwd time: 24.9251 / Avg. batch time: 441.6696 (ms) / GPU bubble ratio: 36.95%
[rank1]:2025-12-24 02:27:58,922 -  step: 450  loss: -8.0000  grad_norm:  0.1145  memory:  9.56GiB(20.12%)  tps: 9,505  tflops: 74.30  mfu: 23.82%
[rank3]:2025-12-24 02:27:58,916 -  step: 450  loss:  0.2388  grad_norm:  0.1145  memory: 16.88GiB(35.53%)  tps: 9,506  tflops: 74.31  mfu: 23.82%
[rank2]:2025-12-24 02:27:58,918 -  step: 450  loss: -8.0000  grad_norm:  0.1145  memory:  6.98GiB(14.69%)  tps: 9,505  tflops: 74.30  mfu: 23.82%
[rank0]:2025-12-24 02:27:58,933 -  step: 450  loss: -8.0000  grad_norm:  0.1145  memory: 13.42GiB(28.26%)  tps: 9,505  tflops: 74.30  mfu: 23.82%
[rank3]:2025-12-24 02:29:24,169 - Avg. fwd time: 11.4983 / Avg. bwd time: 27.2599 / Avg. batch time: 382.7688 (ms) / GPU bubble ratio: 18.99%
[rank2]:2025-12-24 02:29:24,188 - Avg. fwd time: 7.3282 / Avg. bwd time: 18.8435 / Avg. batch time: 406.7370 (ms) / GPU bubble ratio: 48.52%
[rank1]:2025-12-24 02:29:24,210 - Avg. fwd time: 9.8992 / Avg. bwd time: 24.9588 / Avg. batch time: 439.2765 (ms) / GPU bubble ratio: 36.52%
[rank0]:2025-12-24 02:29:24,219 - Avg. fwd time: 7.6374 / Avg. bwd time: 21.4342 / Avg. batch time: 459.6328 (ms) / GPU bubble ratio: 49.40%
[rank0]:2025-12-24 02:30:45,950 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 02:30:49,376 - Avg. fwd time: 11.4746 / Avg. bwd time: 27.0250 / Avg. batch time: 380.7625 (ms) / GPU bubble ratio: 19.11%
[rank2]:2025-12-24 02:30:49,395 - Avg. fwd time: 7.3296 / Avg. bwd time: 18.8446 / Avg. batch time: 404.5966 (ms) / GPU bubble ratio: 48.25%
[rank1]:2025-12-24 02:30:49,418 - Avg. fwd time: 9.9127 / Avg. bwd time: 24.9843 / Avg. batch time: 437.0637 (ms) / GPU bubble ratio: 36.12%
[rank1]:2025-12-24 02:30:49,453 -  step: 500  loss: -8.0000  grad_norm:  0.1242  memory:  9.56GiB(20.12%)  tps: 9,608  tflops: 75.11  mfu: 24.07%
[rank3]:2025-12-24 02:30:49,459 -  step: 500  loss:  0.2316  grad_norm:  0.1242  memory: 16.88GiB(35.53%)  tps: 9,607  tflops: 75.10  mfu: 24.07%
[rank2]:2025-12-24 02:30:49,449 -  step: 500  loss: -8.0000  grad_norm:  0.1242  memory:  6.98GiB(14.69%)  tps: 9,608  tflops: 75.11  mfu: 24.07%
[rank2]:2025-12-24 02:30:49,512 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0230_stage2_step500.svg
[rank0]:2025-12-24 02:30:49,428 - Avg. fwd time: 7.6383 / Avg. bwd time: 21.3986 / Avg. batch time: 457.0807 (ms) / GPU bubble ratio: 49.18%
[rank0]:2025-12-24 02:30:49,464 -  step: 500  loss: -8.0000  grad_norm:  0.1242  memory: 13.42GiB(28.26%)  tps: 9,608  tflops: 75.11  mfu: 24.07%
[rank0]:2025-12-24 02:30:49,511 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0230_stage0_step500.svg
[rank1]:2025-12-24 02:30:49,511 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0230_stage1_step500.svg
[rank3]:2025-12-24 02:30:49,601 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0230_step500_rank3.svg
[rank3]:			> Batch Time: 403.75 ms, GPU Bubble Ratio: 43.23%, 29.24%, 48.09%, 35.10%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  135-25-160ms   | [S0,MB4,F]  160-7-167ms    | [S0,MB1,B]  177-25-202ms   | [S0,MB5,F]  202-7-209ms    | [S0,MB2,B]  221-25-246ms   | [S0,MB6,F]  246-7-253ms    | [S0,MB3,B]  265-25-291ms   | [S0,MB7,F]  291-7-298ms    | [S0,MB4,B]  310-25-335ms   | [S0,MB5,B]  353-25-378ms   | [S0,MB6,B]  386-15-401ms   | [S0,MB7,B]  403-0-403ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  104-25-129ms   | [S1,MB3,F]  133-9-142ms    | [S1,MB1,B]  145-26-171ms   | [S1,MB4,F]  175-10-185ms   | [S1,MB2,B]  188-27-215ms   | [S1,MB5,F]  219-10-230ms   | [S1,MB3,B]  232-27-260ms   | [S1,MB6,F]  263-10-274ms   | [S1,MB4,B]  276-28-304ms   | [S1,MB7,F]  308-10-319ms   | [S1,MB5,B]  321-28-350ms   | [S1,MB6,B]  354-28-382ms   | [S1,MB7,B]  386-12-398ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  33-6-40ms      | [S2,MB0,B]  80-20-100ms    | [S2,MB2,F]  102-6-109ms    | [S2,MB1,B]  120-20-141ms   | [S2,MB3,F]  143-7-150ms    | [S2,MB2,B]  161-20-181ms   | [S2,MB4,F]  186-7-194ms    | [S2,MB3,B]  202-20-223ms   | [S2,MB5,F]  231-7-238ms    | [S2,MB4,B]  244-20-264ms   | [S2,MB6,F]  275-7-282ms    | [S2,MB5,B]  286-20-307ms   | [S2,MB7,F]  320-7-327ms    | [S2,MB6,B]  330-20-351ms   | [S2,MB7,B]  370-9-379ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-26-75ms     | [S3,MB1,F]  78-10-89ms     | [S3,MB1,B]  95-20-115ms    | [S3,MB2,F]  119-10-129ms   | [S3,MB2,B]  135-21-156ms   | [S3,MB3,F]  160-10-170ms   | [S3,MB3,B]  176-21-197ms   | [S3,MB4,F]  201-10-212ms   | [S3,MB4,B]  218-21-239ms   | [S3,MB5,F]  243-10-253ms   | [S3,MB5,B]  259-21-281ms   | [S3,MB6,F]  285-10-296ms   | [S3,MB6,B]  301-21-323ms   | [S3,MB7,F]  329-10-340ms   | [S3,MB7,B]  345-21-366ms  
[rank3]:2025-12-24 02:30:49,644 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0230_stage3_step500.svg
[rank1]:2025-12-24 02:30:50,587 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0230_stage1.svg
[rank2]:2025-12-24 02:30:50,637 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0230_stage2.svg
[rank0]:2025-12-24 02:30:50,631 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0230_stage0.svg
[rank3]:2025-12-24 02:30:50,734 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0230_stage3.svg
[rank1]:2025-12-24 02:32:15,977 - Avg. fwd time: 9.9222 / Avg. bwd time: 25.0088 / Avg. batch time: 434.9812 (ms) / GPU bubble ratio: 35.76%
[rank2]:2025-12-24 02:32:15,955 - Avg. fwd time: 7.3320 / Avg. bwd time: 18.8473 / Avg. batch time: 402.5633 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-12-24 02:32:15,987 - Avg. fwd time: 7.6388 / Avg. bwd time: 21.3890 / Avg. batch time: 454.8226 (ms) / GPU bubble ratio: 48.94%
[rank3]:2025-12-24 02:32:15,935 - Avg. fwd time: 11.4513 / Avg. bwd time: 26.8004 / Avg. batch time: 378.8326 (ms) / GPU bubble ratio: 19.22%
[rank0]:2025-12-24 02:33:38,764 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-24 02:33:42,208 - Avg. fwd time: 9.9317 / Avg. bwd time: 25.0293 / Avg. batch time: 433.3199 (ms) / GPU bubble ratio: 35.45%
[rank2]:2025-12-24 02:33:42,185 - Avg. fwd time: 7.3337 / Avg. bwd time: 18.8481 / Avg. batch time: 400.9608 (ms) / GPU bubble ratio: 47.76%
[rank0]:2025-12-24 02:33:42,218 - Avg. fwd time: 7.6402 / Avg. bwd time: 21.3719 / Avg. batch time: 452.9522 (ms) / GPU bubble ratio: 48.76%
[rank3]:2025-12-24 02:33:42,164 - Avg. fwd time: 11.4335 / Avg. bwd time: 26.6276 / Avg. batch time: 377.3419 (ms) / GPU bubble ratio: 19.31%
[rank1]:2025-12-24 02:33:42,244 -  step: 550  loss: -8.0000  grad_norm:  0.1051  memory:  9.56GiB(20.12%)  tps: 9,482  tflops: 74.13  mfu: 23.76%
[rank2]:2025-12-24 02:33:42,240 -  step: 550  loss: -8.0000  grad_norm:  0.1051  memory:  6.98GiB(14.69%)  tps: 9,482  tflops: 74.13  mfu: 23.76%
[rank0]:2025-12-24 02:33:42,254 -  step: 550  loss: -8.0000  grad_norm:  0.1051  memory: 13.42GiB(28.26%)  tps: 9,482  tflops: 74.13  mfu: 23.76%
[rank3]:2025-12-24 02:33:42,249 -  step: 550  loss:  0.2364  grad_norm:  0.1051  memory: 16.88GiB(35.53%)  tps: 9,482  tflops: 74.13  mfu: 23.76%
[rank2]:2025-12-24 02:35:08,406 - Avg. fwd time: 7.3353 / Avg. bwd time: 18.8485 / Avg. batch time: 399.5631 (ms) / GPU bubble ratio: 47.58%
[rank1]:2025-12-24 02:35:08,429 - Avg. fwd time: 9.9399 / Avg. bwd time: 25.0499 / Avg. batch time: 431.8904 (ms) / GPU bubble ratio: 35.19%
[rank3]:2025-12-24 02:35:08,386 - Avg. fwd time: 11.4195 / Avg. bwd time: 26.4781 / Avg. batch time: 376.0476 (ms) / GPU bubble ratio: 19.38%
[rank0]:2025-12-24 02:35:08,440 - Avg. fwd time: 7.6411 / Avg. bwd time: 21.3409 / Avg. batch time: 451.2362 (ms) / GPU bubble ratio: 48.62%
[rank0]:2025-12-24 02:36:31,054 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 02:36:34,501 - Avg. fwd time: 7.3366 / Avg. bwd time: 18.8485 / Avg. batch time: 398.2848 (ms) / GPU bubble ratio: 47.40%
[rank2]:2025-12-24 02:36:34,556 -  step: 600  loss: -8.0000  grad_norm:  0.1350  memory:  6.98GiB(14.69%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank1]:2025-12-24 02:36:34,523 - Avg. fwd time: 9.9479 / Avg. bwd time: 25.0659 / Avg. batch time: 430.5618 (ms) / GPU bubble ratio: 34.94%
[rank1]:2025-12-24 02:36:34,560 -  step: 600  loss: -8.0000  grad_norm:  0.1350  memory:  9.56GiB(20.12%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank3]:2025-12-24 02:36:34,480 - Avg. fwd time: 11.4071 / Avg. bwd time: 26.3412 / Avg. batch time: 374.8642 (ms) / GPU bubble ratio: 19.44%
[rank3]:2025-12-24 02:36:34,566 -  step: 600  loss:  0.2301  grad_norm:  0.1350  memory: 16.88GiB(35.53%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank0]:2025-12-24 02:36:34,534 - Avg. fwd time: 7.6418 / Avg. bwd time: 21.3118 / Avg. batch time: 449.6448 (ms) / GPU bubble ratio: 48.49%
[rank0]:2025-12-24 02:36:34,570 -  step: 600  loss: -8.0000  grad_norm:  0.1350  memory: 13.42GiB(28.26%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank2]:2025-12-24 02:36:34,620 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0236_stage2_step600.svg
[rank1]:2025-12-24 02:36:34,619 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0236_stage1_step600.svg
[rank0]:2025-12-24 02:36:34,620 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0236_stage0_step600.svg
[rank3]:2025-12-24 02:36:34,711 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0236_step600_rank3.svg
[rank3]:			> Batch Time: 412.00 ms, GPU Bubble Ratio: 44.78%, 31.24%, 49.13%, 33.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  146-25-171ms   | [S0,MB4,F]  171-7-178ms    | [S0,MB1,B]  187-25-212ms   | [S0,MB5,F]  212-7-220ms    | [S0,MB2,B]  230-25-255ms   | [S0,MB6,F]  255-7-262ms    | [S0,MB3,B]  274-25-299ms   | [S0,MB7,F]  299-7-306ms    | [S0,MB4,B]  319-25-344ms   | [S0,MB5,B]  362-25-388ms   | [S0,MB6,B]  395-13-409ms   | [S0,MB7,B]  412-0-412ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  115-25-140ms   | [S1,MB3,F]  144-9-153ms    | [S1,MB1,B]  156-26-182ms   | [S1,MB4,F]  185-9-195ms    | [S1,MB2,B]  198-26-224ms   | [S1,MB5,F]  228-10-238ms   | [S1,MB3,B]  241-27-268ms   | [S1,MB6,F]  272-10-282ms   | [S1,MB4,B]  285-28-313ms   | [S1,MB7,F]  317-10-328ms   | [S1,MB5,B]  331-28-359ms   | [S1,MB6,B]  364-27-392ms   | [S1,MB7,B]  395-12-408ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  33-6-40ms      | [S2,MB0,B]  91-20-111ms    | [S2,MB2,F]  113-6-120ms    | [S2,MB1,B]  132-20-152ms   | [S2,MB3,F]  154-7-162ms    | [S2,MB2,B]  173-20-193ms   | [S2,MB4,F]  196-7-203ms    | [S2,MB3,B]  214-20-234ms   | [S2,MB5,F]  239-7-246ms    | [S2,MB4,B]  255-20-276ms   | [S2,MB6,F]  284-7-291ms    | [S2,MB5,B]  297-20-318ms   | [S2,MB7,F]  329-7-336ms    | [S2,MB6,B]  340-20-361ms   | [S2,MB7,B]  380-9-389ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-37-86ms     | [S3,MB1,F]  90-10-100ms    | [S3,MB1,B]  106-20-127ms   | [S3,MB2,F]  130-10-141ms   | [S3,MB2,B]  147-21-168ms   | [S3,MB3,F]  171-10-182ms   | [S3,MB3,B]  188-21-209ms   | [S3,MB4,F]  212-10-223ms   | [S3,MB4,B]  229-21-250ms   | [S3,MB5,F]  254-10-265ms   | [S3,MB5,B]  271-21-292ms   | [S3,MB6,F]  296-10-307ms   | [S3,MB6,B]  313-21-334ms   | [S3,MB7,F]  339-10-350ms   | [S3,MB7,B]  356-21-377ms  
[rank3]:2025-12-24 02:36:34,756 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0236_stage3_step600.svg
[rank1]:2025-12-24 02:36:35,943 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0236_stage1.svg
[rank2]:2025-12-24 02:36:35,997 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0236_stage2.svg
[rank0]:2025-12-24 02:36:36,006 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0236_stage0.svg
[rank3]:2025-12-24 02:36:36,109 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0236_stage3.svg
[rank2]:2025-12-24 02:38:01,846 - Avg. fwd time: 7.3385 / Avg. bwd time: 18.8493 / Avg. batch time: 397.0863 (ms) / GPU bubble ratio: 47.24%
[rank1]:2025-12-24 02:38:01,870 - Avg. fwd time: 9.9543 / Avg. bwd time: 25.0782 / Avg. batch time: 429.2998 (ms) / GPU bubble ratio: 34.72%
[rank3]:2025-12-24 02:38:01,825 - Avg. fwd time: 11.3950 / Avg. bwd time: 26.2116 / Avg. batch time: 373.7376 (ms) / GPU bubble ratio: 19.50%
[rank0]:2025-12-24 02:38:01,881 - Avg. fwd time: 7.6424 / Avg. bwd time: 21.2872 / Avg. batch time: 448.1445 (ms) / GPU bubble ratio: 48.36%
[rank0]:2025-12-24 02:39:23,764 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 02:39:27,162 - Avg. fwd time: 11.3820 / Avg. bwd time: 26.0762 / Avg. batch time: 372.5723 (ms) / GPU bubble ratio: 19.57%
[rank2]:2025-12-24 02:39:27,183 - Avg. fwd time: 7.3403 / Avg. bwd time: 18.8507 / Avg. batch time: 395.8413 (ms) / GPU bubble ratio: 47.07%
[rank2]:2025-12-24 02:39:27,240 -  step: 650  loss: -8.0000  grad_norm:  0.1441  memory:  6.98GiB(14.69%)  tps: 9,488  tflops: 74.17  mfu: 23.77%
[rank1]:2025-12-24 02:39:27,207 - Avg. fwd time: 9.9615 / Avg. bwd time: 25.0948 / Avg. batch time: 428.0279 (ms) / GPU bubble ratio: 34.48%
[rank1]:2025-12-24 02:39:27,244 -  step: 650  loss: -8.0000  grad_norm:  0.1441  memory:  9.56GiB(20.12%)  tps: 9,488  tflops: 74.17  mfu: 23.77%
[rank3]:2025-12-24 02:39:27,250 -  step: 650  loss:  0.2383  grad_norm:  0.1441  memory: 16.88GiB(35.53%)  tps: 9,488  tflops: 74.17  mfu: 23.77%
[rank0]:2025-12-24 02:39:27,219 - Avg. fwd time: 7.6420 / Avg. bwd time: 21.2556 / Avg. batch time: 446.6478 (ms) / GPU bubble ratio: 48.24%
[rank0]:2025-12-24 02:39:27,255 -  step: 650  loss: -8.0000  grad_norm:  0.1441  memory: 13.42GiB(28.26%)  tps: 9,488  tflops: 74.17  mfu: 23.77%
[rank2]:2025-12-24 02:40:52,773 - Avg. fwd time: 7.3411 / Avg. bwd time: 18.8506 / Avg. batch time: 394.7478 (ms) / GPU bubble ratio: 46.92%
[rank1]:2025-12-24 02:40:52,797 - Avg. fwd time: 9.9680 / Avg. bwd time: 25.1088 / Avg. batch time: 426.8993 (ms) / GPU bubble ratio: 34.27%
[rank3]:2025-12-24 02:40:52,752 - Avg. fwd time: 11.3712 / Avg. bwd time: 25.9580 / Avg. batch time: 371.5531 (ms) / GPU bubble ratio: 19.63%
[rank0]:2025-12-24 02:40:52,809 - Avg. fwd time: 7.6423 / Avg. bwd time: 21.2333 / Avg. batch time: 445.3117 (ms) / GPU bubble ratio: 48.13%
[rank0]:2025-12-24 02:42:15,476 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 02:42:18,893 - Avg. fwd time: 7.3416 / Avg. bwd time: 18.8504 / Avg. batch time: 393.7952 (ms) / GPU bubble ratio: 46.79%
[rank0]:2025-12-24 02:42:18,929 - Avg. fwd time: 7.6427 / Avg. bwd time: 21.2202 / Avg. batch time: 444.1649 (ms) / GPU bubble ratio: 48.01%
[rank3]:2025-12-24 02:42:18,871 - Avg. fwd time: 11.3605 / Avg. bwd time: 25.8558 / Avg. batch time: 370.6696 (ms) / GPU bubble ratio: 19.68%
[rank1]:2025-12-24 02:42:18,917 - Avg. fwd time: 9.9737 / Avg. bwd time: 25.1198 / Avg. batch time: 425.9046 (ms) / GPU bubble ratio: 34.08%
[rank2]:2025-12-24 02:42:18,951 -  step: 700  loss: -8.0000  grad_norm:  0.0967  memory:  6.98GiB(14.69%)  tps: 9,542  tflops: 74.59  mfu: 23.91%
[rank2]:2025-12-24 02:42:19,016 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0242_stage2_step700.svg
[rank0]:2025-12-24 02:42:18,965 -  step: 700  loss: -8.0000  grad_norm:  0.0967  memory: 13.42GiB(28.26%)  tps: 9,542  tflops: 74.59  mfu: 23.91%
[rank0]:2025-12-24 02:42:19,017 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0242_stage0_step700.svg
[rank3]:2025-12-24 02:42:18,961 -  step: 700  loss:  0.2000  grad_norm:  0.0967  memory: 16.88GiB(35.53%)  tps: 9,542  tflops: 74.59  mfu: 23.91%
[rank1]:2025-12-24 02:42:18,955 -  step: 700  loss: -8.0000  grad_norm:  0.0967  memory:  9.56GiB(20.12%)  tps: 9,542  tflops: 74.59  mfu: 23.91%
[rank1]:2025-12-24 02:42:19,016 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0242_stage1_step700.svg
[rank3]:2025-12-24 02:42:19,104 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0242_step700_rank3.svg
[rank3]:			> Batch Time: 416.50 ms, GPU Bubble Ratio: 44.48%, 31.93%, 49.67%, 33.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  147-25-173ms   | [S0,MB4,F]  173-7-180ms    | [S0,MB1,B]  189-25-214ms   | [S0,MB5,F]  214-7-221ms    | [S0,MB2,B]  232-25-257ms   | [S0,MB6,F]  257-7-264ms    | [S0,MB3,B]  275-25-301ms   | [S0,MB7,F]  301-7-308ms    | [S0,MB4,B]  321-25-346ms   | [S0,MB5,B]  364-25-389ms   | [S0,MB6,B]  397-17-414ms   | [S0,MB7,B]  416-0-416ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  116-25-142ms   | [S1,MB3,F]  146-9-155ms    | [S1,MB1,B]  158-26-184ms   | [S1,MB4,F]  187-9-197ms    | [S1,MB2,B]  200-26-227ms   | [S1,MB5,F]  230-10-241ms   | [S1,MB3,B]  243-27-270ms   | [S1,MB6,F]  274-10-284ms   | [S1,MB4,B]  287-28-315ms   | [S1,MB7,F]  319-10-330ms   | [S1,MB5,B]  332-28-360ms   | [S1,MB6,B]  366-27-394ms   | [S1,MB7,B]  397-12-410ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  33-6-40ms      | [S2,MB0,B]  93-20-113ms    | [S2,MB2,F]  115-6-122ms    | [S2,MB1,B]  133-20-154ms   | [S2,MB3,F]  156-7-163ms    | [S2,MB2,B]  174-20-194ms   | [S2,MB4,F]  198-7-205ms    | [S2,MB3,B]  215-20-236ms   | [S2,MB5,F]  241-7-248ms    | [S2,MB4,B]  257-20-277ms   | [S2,MB6,F]  286-7-293ms    | [S2,MB5,B]  299-20-319ms   | [S2,MB7,F]  330-7-338ms    | [S2,MB6,B]  342-20-363ms   | [S2,MB7,B]  382-9-391ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-39-88ms     | [S3,MB1,F]  91-10-102ms    | [S3,MB1,B]  108-20-128ms   | [S3,MB2,F]  132-10-142ms   | [S3,MB2,B]  148-21-169ms   | [S3,MB3,F]  173-10-183ms   | [S3,MB3,B]  189-21-210ms   | [S3,MB4,F]  214-10-225ms   | [S3,MB4,B]  230-21-252ms   | [S3,MB5,F]  255-10-266ms   | [S3,MB5,B]  272-21-294ms   | [S3,MB6,F]  297-10-308ms   | [S3,MB6,B]  314-21-335ms   | [S3,MB7,F]  340-10-351ms   | [S3,MB7,B]  358-21-379ms  
[rank3]:2025-12-24 02:42:19,151 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0242_stage3_step700.svg
[rank1]:2025-12-24 02:42:20,592 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0242_stage1.svg
[rank2]:2025-12-24 02:42:20,666 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0242_stage2.svg
[rank0]:2025-12-24 02:42:20,663 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0242_stage0.svg
[rank3]:2025-12-24 02:42:20,753 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0242_stage3.svg
[rank2]:2025-12-24 02:43:45,982 - Avg. fwd time: 7.3420 / Avg. bwd time: 18.8502 / Avg. batch time: 392.7869 (ms) / GPU bubble ratio: 46.65%
[rank3]:2025-12-24 02:43:45,960 - Avg. fwd time: 11.3488 / Avg. bwd time: 25.7457 / Avg. batch time: 369.7156 (ms) / GPU bubble ratio: 19.73%
[rank0]:2025-12-24 02:43:46,019 - Avg. fwd time: 7.6432 / Avg. bwd time: 21.2084 / Avg. batch time: 442.9698 (ms) / GPU bubble ratio: 47.89%
[rank1]:2025-12-24 02:43:46,006 - Avg. fwd time: 9.9790 / Avg. bwd time: 25.1292 / Avg. batch time: 424.8536 (ms) / GPU bubble ratio: 33.89%
[rank0]:2025-12-24 02:45:09,078 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-24 02:45:12,501 - Avg. fwd time: 7.3425 / Avg. bwd time: 18.8497 / Avg. batch time: 391.9993 (ms) / GPU bubble ratio: 46.55%
[rank0]:2025-12-24 02:45:12,539 - Avg. fwd time: 7.6434 / Avg. bwd time: 21.1984 / Avg. batch time: 442.0386 (ms) / GPU bubble ratio: 47.80%
[rank1]:2025-12-24 02:45:12,526 - Avg. fwd time: 9.9829 / Avg. bwd time: 25.1391 / Avg. batch time: 424.0356 (ms) / GPU bubble ratio: 33.74%
[rank1]:2025-12-24 02:45:12,564 -  step: 750  loss: -8.0000  grad_norm:  0.1295  memory:  9.56GiB(20.12%)  tps: 9,437  tflops: 73.78  mfu: 23.65%
[rank3]:2025-12-24 02:45:12,479 - Avg. fwd time: 11.3404 / Avg. bwd time: 25.6624 / Avg. batch time: 368.9891 (ms) / GPU bubble ratio: 19.77%
[rank3]:2025-12-24 02:45:12,570 -  step: 750  loss:  0.2402  grad_norm:  0.1295  memory: 16.88GiB(35.53%)  tps: 9,437  tflops: 73.78  mfu: 23.65%
[rank2]:2025-12-24 02:45:12,560 -  step: 750  loss: -8.0000  grad_norm:  0.1295  memory:  6.98GiB(14.69%)  tps: 9,437  tflops: 73.78  mfu: 23.65%
[rank0]:2025-12-24 02:45:12,575 -  step: 750  loss: -8.0000  grad_norm:  0.1295  memory: 13.42GiB(28.26%)  tps: 9,437  tflops: 73.78  mfu: 23.65%
[rank2]:2025-12-24 02:46:37,640 - Avg. fwd time: 7.3431 / Avg. bwd time: 18.8495 / Avg. batch time: 391.1031 (ms) / GPU bubble ratio: 46.42%
[rank1]:2025-12-24 02:46:37,665 - Avg. fwd time: 9.9877 / Avg. bwd time: 25.1474 / Avg. batch time: 423.1023 (ms) / GPU bubble ratio: 33.57%
[rank0]:2025-12-24 02:46:37,678 - Avg. fwd time: 7.6436 / Avg. bwd time: 21.1780 / Avg. batch time: 440.9455 (ms) / GPU bubble ratio: 47.71%
[rank3]:2025-12-24 02:46:37,618 - Avg. fwd time: 11.3306 / Avg. bwd time: 25.5657 / Avg. batch time: 368.1498 (ms) / GPU bubble ratio: 19.82%
[rank0]:2025-12-24 02:48:00,633 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 02:48:04,088 - Avg. fwd time: 7.3438 / Avg. bwd time: 18.8493 / Avg. batch time: 390.3975 (ms) / GPU bubble ratio: 46.33%
[rank3]:2025-12-24 02:48:04,065 - Avg. fwd time: 11.3234 / Avg. bwd time: 25.4898 / Avg. batch time: 367.4973 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-24 02:48:04,149 -  step: 800  loss: -8.0000  grad_norm:  0.1122  memory:  6.98GiB(14.69%)  tps: 9,548  tflops: 74.65  mfu: 23.92%
[rank2]:2025-12-24 02:48:04,149 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1122  tps: 9,481  tflops: 74.12  mfu: 21.84%
[rank2]:2025-12-24 02:48:04,149 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 02:48:04,150 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 02:48:04,113 - Avg. fwd time: 9.9917 / Avg. bwd time: 25.1563 / Avg. batch time: 422.3653 (ms) / GPU bubble ratio: 33.43%
[rank1]:2025-12-24 02:48:04,152 -  step: 800  loss: -8.0000  grad_norm:  0.1122  memory:  9.56GiB(20.12%)  tps: 9,548  tflops: 74.65  mfu: 23.92%
[rank1]:2025-12-24 02:48:04,152 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1122  tps: 9,479  tflops: 74.10  mfu: 21.81%
[rank1]:2025-12-24 02:48:04,152 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 02:48:04,153 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 02:48:04,158 -  step: 800  loss:  0.2447  grad_norm:  0.1122  memory: 16.88GiB(35.53%)  tps: 9,549  tflops: 74.65  mfu: 23.93%
[rank3]:2025-12-24 02:48:04,159 - â„¹ï¸ final step: 800  loss:  0.2447  grad_norm:  0.1122  tps: 9,486  tflops: 74.16  mfu: 21.95%
[rank3]:2025-12-24 02:48:04,159 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 02:48:04,160 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 02:48:04,127 - Avg. fwd time: 7.6444 / Avg. bwd time: 21.1739 / Avg. batch time: 440.1250 (ms) / GPU bubble ratio: 47.62%
[rank0]:2025-12-24 02:48:04,163 -  step: 800  loss: -8.0000  grad_norm:  0.1122  memory: 13.42GiB(28.26%)  tps: 9,548  tflops: 74.65  mfu: 23.92%
[rank0]:2025-12-24 02:48:04,163 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1122  tps: 9,479  tflops: 74.10  mfu: 21.81%
[rank0]:2025-12-24 02:48:04,163 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 02:48:04,164 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 02:48:06,400 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-24 02:48:06,472 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251224_0248_stage2_final800.svg
[rank1]:2025-12-24 02:48:06,472 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251224_0248_stage1_final800.svg
[rank0]:2025-12-24 02:48:06,472 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251224_0248_stage0_final800.svg
[rank3]:2025-12-24 02:48:06,559 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0248_final800_rank3.svg
[rank3]:			> Batch Time: 414.50 ms, GPU Bubble Ratio: 45.13%, 31.65%, 49.50%, 33.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  145-25-171ms   | [S0,MB4,F]  171-7-178ms    | [S0,MB1,B]  187-25-213ms   | [S0,MB5,F]  213-7-220ms    | [S0,MB2,B]  230-25-255ms   | [S0,MB6,F]  256-7-263ms    | [S0,MB3,B]  274-25-300ms   | [S0,MB7,F]  300-7-307ms    | [S0,MB4,B]  320-25-345ms   | [S0,MB5,B]  363-25-388ms   | [S0,MB6,B]  397-14-411ms   | [S0,MB7,B]  414-0-414ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  35-9-45ms      | [S1,MB0,B]  115-25-140ms   | [S1,MB3,F]  144-9-153ms    | [S1,MB1,B]  156-25-182ms   | [S1,MB4,F]  186-9-195ms    | [S1,MB2,B]  198-26-225ms   | [S1,MB5,F]  228-10-239ms   | [S1,MB3,B]  242-27-269ms   | [S1,MB6,F]  273-10-283ms   | [S1,MB4,B]  286-28-314ms   | [S1,MB7,F]  318-10-329ms   | [S1,MB5,B]  331-28-360ms   | [S1,MB6,B]  365-28-393ms   | [S1,MB7,B]  397-13-410ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB0,B]  91-20-111ms    | [S2,MB2,F]  113-6-120ms    | [S2,MB1,B]  132-20-152ms   | [S2,MB3,F]  154-7-162ms    | [S2,MB2,B]  173-20-193ms   | [S2,MB4,F]  196-7-203ms    | [S2,MB3,B]  214-20-235ms   | [S2,MB5,F]  240-7-247ms    | [S2,MB4,B]  256-20-276ms   | [S2,MB6,F]  284-7-292ms    | [S2,MB5,B]  298-20-318ms   | [S2,MB7,F]  329-7-337ms    | [S2,MB6,B]  341-20-361ms   | [S2,MB7,B]  381-9-390ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-86ms     | [S3,MB1,F]  89-10-100ms    | [S3,MB1,B]  106-20-127ms   | [S3,MB2,F]  130-10-141ms   | [S3,MB2,B]  147-21-168ms   | [S3,MB3,F]  171-10-182ms   | [S3,MB3,B]  188-21-209ms   | [S3,MB4,F]  213-10-224ms   | [S3,MB4,B]  230-21-251ms   | [S3,MB5,F]  254-10-265ms   | [S3,MB5,B]  271-21-293ms   | [S3,MB6,F]  296-10-307ms   | [S3,MB6,B]  313-21-334ms   | [S3,MB7,F]  339-10-350ms   | [S3,MB7,B]  356-21-378ms  
[rank2]:2025-12-24 02:48:06,628 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251224_0248_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank1]:2025-12-24 02:48:06,620 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251224_0248_rank1_stage1.svg
[rank1]:	> Counts Sum: 282800, Total Sum: 2102400 (13.45%), Ratio(%) per element: [14.21, 13.35, 13.18, 13.86, 12.67, 13.52, 13.35, 13.18, 13.35, 13.52, 13.35, 13.52, 13.35, 13.69, 13.52, 12.84, 12.84, 13.52, 13.01, 13.18, 13.01, 13.86, 13.69, 13.35, 13.86, 14.21, 13.01, 13.86, 13.35, 14.55, 13.69, 13.52, 14.04, 13.35, 13.52, 13.01, 13.18, 13.52, 13.18, 13.52, 12.84, 13.52, 13.86, 13.18, 13.35]
[rank3]:2025-12-24 02:48:06,694 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251224_0248_thry_final800_rank3.svg
[rank3]:			> Batch Time: 297.13 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB0,B]  90-18-108ms    | [S0,MB4,F]  108-9-117ms    | [S0,MB1,B]  117-18-135ms   | [S0,MB5,F]  135-9-144ms    | [S0,MB2,B]  144-18-162ms   | [S0,MB6,F]  162-9-171ms    | [S0,MB3,B]  171-18-189ms   | [S0,MB7,F]  189-9-198ms    | [S0,MB4,B]  198-18-216ms   | [S0,MB5,B]  225-18-243ms   | [S0,MB6,B]  252-18-270ms   | [S0,MB7,B]  279-18-297ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-18ms       | [S1,MB1,F]  18-9-27ms      | [S1,MB2,F]  27-9-36ms      | [S1,MB0,B]  72-18-90ms     | [S1,MB3,F]  90-9-99ms      | [S1,MB1,B]  99-18-117ms    | [S1,MB4,F]  117-9-126ms    | [S1,MB2,B]  126-18-144ms   | [S1,MB5,F]  144-9-153ms    | [S1,MB3,B]  153-18-171ms   | [S1,MB6,F]  171-9-180ms    | [S1,MB4,B]  180-18-198ms   | [S1,MB7,F]  198-9-207ms    | [S1,MB5,B]  207-18-225ms   | [S1,MB6,B]  234-18-252ms   | [S1,MB7,B]  261-18-279ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  18-9-27ms      | [S2,MB1,F]  27-9-36ms      | [S2,MB0,B]  54-18-72ms     | [S2,MB2,F]  72-9-81ms      | [S2,MB1,B]  81-18-99ms     | [S2,MB3,F]  99-9-108ms     | [S2,MB2,B]  108-18-126ms   | [S2,MB4,F]  126-9-135ms    | [S2,MB3,B]  135-18-153ms   | [S2,MB5,F]  153-9-162ms    | [S2,MB4,B]  162-18-180ms   | [S2,MB6,F]  180-9-189ms    | [S2,MB5,B]  189-18-207ms   | [S2,MB7,F]  207-9-216ms    | [S2,MB6,B]  216-18-234ms   | [S2,MB7,B]  243-18-261ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  27-9-36ms      | [S3,MB0,B]  36-18-54ms     | [S3,MB1,F]  54-9-63ms      | [S3,MB1,B]  63-18-81ms     | [S3,MB2,F]  81-9-90ms      | [S3,MB2,B]  90-18-108ms    | [S3,MB3,F]  108-9-117ms    | [S3,MB3,B]  117-18-135ms   | [S3,MB4,F]  135-9-144ms    | [S3,MB4,B]  144-18-162ms   | [S3,MB5,F]  162-9-171ms    | [S3,MB5,B]  171-18-189ms   | [S3,MB6,F]  189-9-198ms    | [S3,MB6,B]  198-18-216ms   | [S3,MB7,F]  216-9-225ms    | [S3,MB7,B]  225-18-243ms  
[rank0]:2025-12-24 02:48:06,630 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251224_0248_rank0_stage0.svg
[rank0]:	> Counts Sum: 337440, Total Sum: 1728640 (19.52%), Ratio(%) per element: [22.77, 23.11, 22.6, 23.11, 22.94, 21.06, 21.4, 21.91, 21.57, 22.6, 22.08, 21.74, 21.06, 21.57, 21.23, 20.54, 19.52, 21.06, 20.2, 19.86, 19.69, 18.49, 18.32, 19.0, 17.8, 19.34, 17.97, 17.63, 16.6, 17.29, 15.92, 16.26, 15.75, 15.92, 14.21, 16.26, 13.69]
[rank3]:2025-12-24 02:48:06,745 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251224_0248_stage3_final800.svg
[rank3]:2025-12-24 02:48:06,884 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251224_0248_rank3_stage3.svg
[rank3]:	> Counts Sum: 1147840, Total Sum: 1354880 (84.72%), Ratio(%) per element: [85.78, 84.07, 83.56, 84.76, 85.61, 86.13, 83.39, 84.07, 85.61, 83.9, 85.1, 84.24, 85.78, 82.7, 84.93, 85.27, 86.13, 85.27, 84.24, 84.58, 86.98, 85.1, 83.9, 84.58, 84.41, 84.58, 84.07, 83.21, 84.76]
[rank1]:2025-12-24 02:48:08,442 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0248_stage1.svg
[rank1]:2025-12-24 02:48:08,445 - Destroying the purge thread.
[rank2]:2025-12-24 02:48:08,536 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0248_stage2.svg
[rank2]:2025-12-24 02:48:08,539 - Destroying the purge thread.
[rank0]:2025-12-24 02:48:08,532 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0248_stage0.svg
[rank0]:2025-12-24 02:48:08,535 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-24 02:48:08,605 - Process group destroyed
[rank1]:2025-12-24 02:48:08,710 - Process group destroyed
[rank3]:2025-12-24 02:48:08,804 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251224_0248_stage3.svg
[rank3]:2025-12-24 02:48:08,808 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.4543
[rank3]:wandb:               final/avg_loss 0.24469
[rank3]:wandb:             final/avg_mfu(%) 21.94996
[rank3]:wandb:             final/avg_tflops 74.15844
[rank3]:wandb:    final/avg_throughput(tps) 9486.16083
[rank3]:wandb:              final/grad_norm 0.11217
[rank3]:wandb:               final/max_loss 0.24469
[rank3]:wandb:                    grad_norm 0.11217
[rank3]:wandb: loss_metrics/global_avg_loss 0.24469
[rank3]:wandb: loss_metrics/global_max_loss 0.24469
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1223_1F1B_fullrand7_mfr0.9_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/z2q6q6ai
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.9_42_dm1/20251224-0159/wandb/run-20251224_015906-z2q6q6ai/logs
[rank0]:2025-12-24 02:48:10,536 - Training completed
[rank0]:2025-12-24 02:48:10,536 - Destroying the purge thread.
[rank3]:2025-12-24 02:48:10,645 - Process group destroyed
[rank0]:2025-12-24 02:48:10,701 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.5', 'layers.4', 'layers.7', 'layers.6'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.3', 'layers.2', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.13', 'norm', 'layers.14', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1223.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:1223: everything same as 1212, but debugged a bug in requires_grad in pytorch pipelining
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1223_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
