
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 12. (ê¸ˆ) 02:39:49 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1212_1F1B_fullrand7_mfr0.3_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.3) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.3
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-12 02:39:55,960 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:"
[rank3]:2025-12-12 02:39:55,960 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank2]:2025-12-12 02:39:56,042 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank1]:2025-12-12 02:39:56,096 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:"
[rank0]:2025-12-12 02:39:56,206 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 02:39:56,157 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 02:39:56,160 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 02:39:56,208 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 02:39:56,212 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-12 02:39:56,213 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-12-12 02:39:56,280 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-12 02:39:56,283 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-12 02:39:56,333 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 02:39:56,336 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 02:39:56,600 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-12 02:39:59,315 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-12 02:39:59,467 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 02:39:59,505 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 02:39:59,507 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-12 02:39:59,567 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 02:39:59,531 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-12 02:39:59,531 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 02:39:59,566 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-12 02:39:59,613 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 02:39:59,640 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-12 02:39:59,640 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 02:39:59,613 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 02:39:59,639 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-12 02:39:59,640 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 02:39:59,717 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 02:39:59,717 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 02:39:59,717 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-12 02:39:59,832 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 02:39:59,832 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-12 02:39:59,833 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-12 02:39:59,837 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 02:39:59,838 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-12 02:39:59,838 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run gmd85rcf
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.3_42_dm1/20251212-0239/wandb/run-20251212_024000-gmd85rcf
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/gmd85rcf
[rank3]:2025-12-12 02:40:01,916 - INFO - WandB logging enabled
[rank3]:2025-12-12 02:40:01,916 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-12 02:40:01,954 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 02:40:01,983 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-12 02:40:01,984 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 02:40:02,185 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-12 02:40:02,169 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 02:40:02,170 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-12 02:40:02,170 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-12 02:40:02,185 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-12 02:40:02,186 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 02:40:02,185 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank0]:2025-12-12 02:40:02,185 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 02:40:02,185 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-12 02:40:02,185 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-12 02:40:04,104 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-12 02:40:04,104 - INFO - Finished loading the checkpoint in 1.92 seconds.
[rank0]:2025-12-12 02:40:04,104 - INFO - Training starts at step 1
[rank3]:2025-12-12 02:40:09,720 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5372  memory: 12.97GiB(27.31%)  tps: 4,221  tflops: 33.00  mfu: 10.58%
[rank3]:2025-12-12 02:40:09,721 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 02:40:09,718 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  6.76GiB(14.24%)  tps: 3,243  tflops: 25.35  mfu: 8.13%
[rank1]:2025-12-12 02:40:09,718 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-12 02:40:09,710 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  4.63GiB(9.75%)  tps: 3,246  tflops: 25.37  mfu: 8.13%
[rank2]:2025-12-12 02:40:09,710 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-12 02:40:09,750 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  9.19GiB(19.34%)  tps: 3,199  tflops: 25.01  mfu: 8.01%
[rank0]:2025-12-12 02:40:09,750 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 02:42:12,054 - INFO - Avg. fwd time: 13.3268 / Avg. bwd time: 41.7580 / Avg. batch time: 513.1702 (ms) / GPU bubble ratio: 14.13%
[rank2]:2025-12-12 02:42:12,078 - INFO - Avg. fwd time: 7.2689 / Avg. bwd time: 18.9547 / Avg. batch time: 545.2033 (ms) / GPU bubble ratio: 61.52%
[rank0]:2025-12-12 02:42:12,135 - INFO - Avg. fwd time: 7.3922 / Avg. bwd time: 23.5509 / Avg. batch time: 621.4361 (ms) / GPU bubble ratio: 60.17%
[rank1]:2025-12-12 02:42:12,107 - INFO - Avg. fwd time: 9.3836 / Avg. bwd time: 23.9323 / Avg. batch time: 584.2145 (ms) / GPU bubble ratio: 54.38%
[rank0]:2025-12-12 02:44:15,200 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 02:44:20,227 - INFO - Avg. fwd time: 7.2690 / Avg. bwd time: 18.9944 / Avg. batch time: 547.1552 (ms) / GPU bubble ratio: 61.60%
[rank3]:2025-12-12 02:44:20,203 - INFO - Avg. fwd time: 13.4347 / Avg. bwd time: 41.9539 / Avg. batch time: 515.4828 (ms) / GPU bubble ratio: 14.04%
[rank2]:2025-12-12 02:44:20,306 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.9678  memory:  6.43GiB(13.53%)  tps: 6,407  tflops: 50.09  mfu: 16.05%
[rank3]:2025-12-12 02:44:20,318 - INFO -  step: 50  loss:  9.9243  grad_norm: 12.9678  memory: 16.39GiB(34.50%)  tps: 6,407  tflops: 50.09  mfu: 16.05%
[rank1]:2025-12-12 02:44:20,256 - INFO - Avg. fwd time: 9.4037 / Avg. bwd time: 23.9892 / Avg. batch time: 585.8391 (ms) / GPU bubble ratio: 54.40%
[rank1]:2025-12-12 02:44:20,309 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.9678  memory:  9.03GiB(19.01%)  tps: 6,407  tflops: 50.09  mfu: 16.05%
[rank0]:2025-12-12 02:44:20,284 - INFO - Avg. fwd time: 7.3812 / Avg. bwd time: 23.5881 / Avg. batch time: 622.6364 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-12-12 02:44:20,320 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.9678  memory: 12.97GiB(27.31%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank3]:2025-12-12 02:45:11,522 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-12 02:46:02,926 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-12 02:46:03,050 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-12 02:46:20,189 - INFO - Avg. fwd time: 13.5349 / Avg. bwd time: 40.6740 / Avg. batch time: 506.0010 (ms) / GPU bubble ratio: 14.29%
[rank2]:2025-12-12 02:46:20,203 - INFO - Avg. fwd time: 7.3677 / Avg. bwd time: 18.3219 / Avg. batch time: 536.8574 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-12-12 02:46:20,223 - INFO - Avg. fwd time: 7.4598 / Avg. bwd time: 22.0460 / Avg. batch time: 609.6280 (ms) / GPU bubble ratio: 61.28%
[rank1]:2025-12-12 02:46:20,218 - INFO - Avg. fwd time: 9.5142 / Avg. bwd time: 23.1454 / Avg. batch time: 574.5640 (ms) / GPU bubble ratio: 54.53%
[rank3]:2025-12-12 02:46:37,345 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-12 02:46:37,520 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0246_max_batch_time.svg
[rank3]:			> Batch Time: 537.70 ms, GPU Bubble Ratio: 53.81%, 50.37%, 60.89%, 17.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  232-23-256ms   | [S0,MB6,F]  256-6-262ms    | [S0,MB3,B]  288-23-311ms   | [S0,MB7,F]  311-6-318ms    | [S0,MB4,B]  343-23-367ms   | [S0,MB5,B]  400-23-424ms   | [S0,MB6,B]  457-23-481ms   | [S0,MB7,B]  514-23-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  208-24-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  263-24-288ms   | [S1,MB6,F]  288-9-297ms    | [S1,MB4,B]  319-24-343ms   | [S1,MB7,F]  343-9-353ms    | [S1,MB5,B]  376-24-400ms   | [S1,MB6,B]  433-23-457ms   | [S1,MB7,B]  490-23-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  208-7-215ms    | [S2,MB3,B]  244-19-263ms   | [S2,MB5,F]  263-6-270ms    | [S2,MB4,B]  300-19-319ms   | [S2,MB6,F]  319-6-326ms    | [S2,MB5,B]  357-19-376ms   | [S2,MB7,F]  376-7-383ms    | [S2,MB6,B]  414-19-433ms   | [S2,MB7,B]  471-19-490ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-189ms   AFR(10):0.9655 | [S3,MB3,F]  189-13-202ms   | [S3,MB3,B]  202-42-244ms   AFR(10):0.9655 | [S3,MB4,F]  244-13-258ms   | [S3,MB4,B]  258-42-300ms   AFR(10):0.9655 | [S3,MB5,F]  300-14-315ms   | [S3,MB5,B]  315-42-357ms   AFR(10):0.9655 | [S3,MB6,F]  357-13-371ms   | [S3,MB6,B]  371-43-414ms   AFR(10):0.9655 | [S3,MB7,F]  414-13-428ms   | [S3,MB7,B]  428-42-471ms   AFR(10):0.9655
[rank3]:2025-12-12 02:46:37,647 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0246_min_batch_time.svg
[rank3]:			> Batch Time: 328.82 ms, GPU Bubble Ratio: 82.18%, 50.83%, 61.60%, 14.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-157ms    | [S0,MB3,B]  185-0-185ms    | [S0,MB7,F]  185-6-192ms    | [S0,MB4,B]  221-0-221ms    | [S0,MB5,B]  258-0-258ms    | [S0,MB6,B]  293-0-293ms    | [S0,MB7,B]  328-0-328ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-125ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-9-159ms    | [S1,MB3,B]  174-11-185ms   | [S1,MB6,F]  185-9-194ms    | [S1,MB4,B]  210-11-221ms   | [S1,MB7,F]  221-9-230ms    | [S1,MB5,B]  246-11-258ms   | [S1,MB6,B]  282-10-293ms   | [S1,MB7,B]  318-10-328ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  64-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-6-111ms    | [S2,MB2,B]  131-8-139ms    | [S2,MB4,F]  139-7-146ms    | [S2,MB3,B]  165-8-174ms    | [S2,MB5,F]  174-6-181ms    | [S2,MB4,B]  201-8-210ms    | [S2,MB6,F]  210-6-217ms    | [S2,MB5,B]  238-8-246ms    | [S2,MB7,F]  246-7-253ms    | [S2,MB6,B]  273-8-282ms    | [S2,MB7,B]  309-8-318ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-64ms     AFR(10):0.9655 | [S3,MB1,F]  64-11-75ms     | [S3,MB1,B]  75-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-109ms    | [S3,MB2,B]  109-21-131ms   AFR(10):0.9655 | [S3,MB3,F]  131-13-144ms   | [S3,MB3,B]  144-21-165ms   AFR(10):0.9655 | [S3,MB4,F]  165-13-179ms   | [S3,MB4,B]  179-21-201ms   AFR(10):0.9655 | [S3,MB5,F]  201-14-216ms   | [S3,MB5,B]  216-22-238ms   AFR(10):0.9655 | [S3,MB6,F]  238-13-251ms   | [S3,MB6,B]  251-21-273ms   AFR(10):0.9655 | [S3,MB7,F]  273-13-287ms   | [S3,MB7,B]  287-21-309ms   AFR(10):0.9655
[rank3]:2025-12-12 02:46:37,790 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0246_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 439.97 ms, GPU Bubble Ratio: 51.59%, 42.33%, 54.60%, 11.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  232-23-256ms   | [S0,MB6,F]  256-6-262ms    | [S0,MB3,B]  279-23-303ms   | [S0,MB7,F]  303-6-310ms    | [S0,MB4,B]  335-23-359ms   | [S0,MB5,B]  392-23-416ms   | [S0,MB6,B]  428-11-439ms   | [S0,MB7,B]  439-0-439ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  208-24-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  255-24-279ms   | [S1,MB6,F]  279-9-289ms    | [S1,MB4,B]  311-24-335ms   | [S1,MB7,F]  335-9-344ms    | [S1,MB5,B]  368-24-392ms   | [S1,MB6,B]  404-23-428ms   | [S1,MB7,B]  429-10-439ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  208-7-215ms    | [S2,MB3,B]  236-19-255ms   | [S2,MB5,F]  255-6-262ms    | [S2,MB4,B]  292-19-311ms   | [S2,MB6,F]  311-6-318ms    | [S2,MB5,B]  349-19-368ms   | [S2,MB7,F]  368-7-375ms    | [S2,MB6,B]  384-19-404ms   | [S2,MB7,B]  420-8-429ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-189ms   AFR(10):0.9655 | [S3,MB3,F]  189-13-202ms   | [S3,MB3,B]  202-34-236ms   AFR(10):0.9655 | [S3,MB4,F]  236-13-250ms   | [S3,MB4,B]  250-42-292ms   AFR(10):0.9655 | [S3,MB5,F]  292-14-306ms   | [S3,MB5,B]  306-42-349ms   AFR(10):0.9655 | [S3,MB6,F]  349-13-363ms   | [S3,MB6,B]  363-21-384ms   AFR(10):0.9655 | [S3,MB7,F]  384-13-398ms   | [S3,MB7,B]  398-21-420ms   AFR(10):0.9655
[rank3]:2025-12-12 02:46:37,791 - INFO - 	> Batch Time: 439.97 ms (Average Freeze Ratio: 0.18, Time Reduction Rate: 0.18)
[rank0]:2025-12-12 02:48:09,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 02:48:14,335 - INFO - Avg. fwd time: 7.4697 / Avg. bwd time: 17.6014 / Avg. batch time: 526.1392 (ms) / GPU bubble ratio: 61.88%
[rank2]:2025-12-12 02:48:14,341 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank3]:2025-12-12 02:48:14,311 - INFO - Avg. fwd time: 13.6479 / Avg. bwd time: 39.2651 / Avg. batch time: 495.6011 (ms) / GPU bubble ratio: 14.59%
[rank3]:2025-12-12 02:48:14,316 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.10(0.13)/0.40, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-12 02:48:14,388 - INFO - Avg. fwd time: 7.5874 / Avg. bwd time: 19.4410 / Avg. batch time: 595.9659 (ms) / GPU bubble ratio: 63.72%
[rank0]:2025-12-12 02:48:14,395 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-12 02:48:14,424 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1133  memory: 12.97GiB(27.31%)  tps: 6,999  tflops: 54.71  mfu: 17.54%
[rank2]:2025-12-12 02:48:14,410 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1133  memory:  6.51GiB(13.70%)  tps: 6,999  tflops: 54.71  mfu: 17.54%
[rank3]:2025-12-12 02:48:14,422 - INFO -  step: 100  loss:  8.7083  grad_norm:  8.1133  memory: 17.37GiB(36.56%)  tps: 6,999  tflops: 54.71  mfu: 17.54%
[rank1]:2025-12-12 02:48:14,364 - INFO - Avg. fwd time: 9.6465 / Avg. bwd time: 22.0559 / Avg. batch time: 562.9398 (ms) / GPU bubble ratio: 54.95%
[rank1]:2025-12-12 02:48:14,371 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-12 02:48:14,413 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1133  memory:  9.36GiB(19.71%)  tps: 6,999  tflops: 54.71  mfu: 17.54%
[rank0]:2025-12-12 02:48:14,483 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0248_stage0_step100.svg
[rank2]:2025-12-12 02:48:14,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0248_stage2_step100.svg
[rank1]:2025-12-12 02:48:14,482 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0248_stage1_step100.svg
[rank3]:2025-12-12 02:48:14,566 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0248_real_step100_rank3.svg
[rank3]:			> Batch Time: 609.81 ms, GPU Bubble Ratio: 65.19%, 57.27%, 66.25%, 28.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  138-16-154ms   | [S0,MB4,F]  154-7-162ms    | [S0,MB1,B]  199-16-215ms   | [S0,MB5,F]  215-6-222ms    | [S0,MB2,B]  266-16-283ms   | [S0,MB6,F]  283-6-289ms    | [S0,MB3,B]  336-16-352ms   | [S0,MB7,F]  352-6-359ms    | [S0,MB4,B]  400-23-424ms   | [S0,MB5,B]  464-23-488ms   | [S0,MB6,B]  529-19-549ms   | [S0,MB7,B]  590-19-609ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-45ms      | [S1,MB0,B]  111-21-133ms   | [S1,MB3,F]  136-9-146ms    | [S1,MB1,B]  172-21-194ms   | [S1,MB4,F]  197-9-206ms    | [S1,MB2,B]  240-21-261ms   | [S1,MB5,F]  265-8-274ms    | [S1,MB3,B]  306-24-330ms   | [S1,MB6,F]  334-9-343ms    | [S1,MB4,B]  371-24-395ms   | [S1,MB7,F]  398-9-408ms    | [S1,MB5,B]  437-24-461ms   | [S1,MB6,B]  502-24-526ms   | [S1,MB7,B]  563-23-586ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  90-16-106ms    | [S2,MB2,F]  110-7-117ms    | [S2,MB1,B]  151-16-167ms   | [S2,MB3,F]  171-6-178ms    | [S2,MB2,B]  216-19-235ms   | [S2,MB4,F]  239-7-246ms    | [S2,MB3,B]  282-19-302ms   | [S2,MB5,F]  305-6-312ms    | [S2,MB4,B]  347-19-366ms   | [S2,MB6,F]  369-7-376ms    | [S2,MB5,B]  413-19-432ms   | [S2,MB7,F]  435-7-442ms    | [S2,MB6,B]  480-19-499ms   | [S2,MB7,B]  541-18-560ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  88-11-100ms    | [S3,MB1,B]  106-40-146ms   | [S3,MB2,F]  150-13-163ms   | [S3,MB2,B]  169-42-211ms   | [S3,MB3,F]  215-13-228ms   | [S3,MB3,B]  234-43-277ms   | [S3,MB4,F]  281-13-295ms   | [S3,MB4,B]  300-41-342ms   | [S3,MB5,F]  345-14-360ms   | [S3,MB5,B]  366-42-408ms   | [S3,MB6,F]  411-14-426ms   | [S3,MB6,B]  432-42-475ms   | [S3,MB7,F]  478-14-492ms   | [S3,MB7,B]  498-39-537ms  
[rank3]:2025-12-12 02:48:14,608 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0248_stage3_step100.svg
[rank2]:2025-12-12 02:50:15,901 - INFO - Avg. fwd time: 7.4534 / Avg. bwd time: 17.7077 / Avg. batch time: 524.7940 (ms) / GPU bubble ratio: 61.64%
[rank3]:2025-12-12 02:50:15,877 - INFO - Avg. fwd time: 13.7073 / Avg. bwd time: 39.0328 / Avg. batch time: 494.2029 (ms) / GPU bubble ratio: 14.63%
[rank0]:2025-12-12 02:50:15,953 - INFO - Avg. fwd time: 7.5971 / Avg. bwd time: 19.5527 / Avg. batch time: 594.8048 (ms) / GPU bubble ratio: 63.48%
[rank1]:2025-12-12 02:50:15,929 - INFO - Avg. fwd time: 9.6334 / Avg. bwd time: 22.1018 / Avg. batch time: 561.7138 (ms) / GPU bubble ratio: 54.80%
[rank0]:2025-12-12 02:52:14,496 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-12 02:52:19,372 - INFO - Avg. fwd time: 7.6483 / Avg. bwd time: 19.3215 / Avg. batch time: 595.5868 (ms) / GPU bubble ratio: 63.77%
[rank2]:2025-12-12 02:52:19,318 - INFO - Avg. fwd time: 7.4618 / Avg. bwd time: 17.6218 / Avg. batch time: 525.7755 (ms) / GPU bubble ratio: 61.83%
[rank2]:2025-12-12 02:52:19,324 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-12 02:52:19,344 - INFO - Avg. fwd time: 9.6475 / Avg. bwd time: 21.8970 / Avg. batch time: 562.5882 (ms) / GPU bubble ratio: 55.14%
[rank1]:2025-12-12 02:52:19,351 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-12 02:52:19,294 - INFO - Avg. fwd time: 13.7097 / Avg. bwd time: 39.1795 / Avg. batch time: 495.3965 (ms) / GPU bubble ratio: 14.59%
[rank3]:2025-12-12 02:52:19,299 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.24(0.27)/0.40, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 02:52:19,380 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 02:52:19,408 - INFO -  step: 150  loss: -8.0000  grad_norm:  8.7893  memory: 13.29GiB(27.97%)  tps: 6,688  tflops: 52.28  mfu: 16.76%
[rank2]:2025-12-12 02:52:19,393 - INFO -  step: 150  loss: -8.0000  grad_norm:  8.7893  memory:  6.51GiB(13.70%)  tps: 6,688  tflops: 52.28  mfu: 16.76%
[rank1]:2025-12-12 02:52:19,397 - INFO -  step: 150  loss: -8.0000  grad_norm:  8.7893  memory:  9.36GiB(19.71%)  tps: 6,688  tflops: 52.28  mfu: 16.76%
[rank3]:2025-12-12 02:52:19,406 - INFO -  step: 150  loss:  3.9724  grad_norm:  8.7893  memory: 17.37GiB(36.56%)  tps: 6,688  tflops: 52.28  mfu: 16.76%
[rank1]:2025-12-12 02:54:17,399 - INFO - Avg. fwd time: 9.6765 / Avg. bwd time: 21.6426 / Avg. batch time: 559.6652 (ms) / GPU bubble ratio: 55.23%
[rank3]:2025-12-12 02:54:17,348 - INFO - Avg. fwd time: 13.7276 / Avg. bwd time: 38.8333 / Avg. batch time: 492.7653 (ms) / GPU bubble ratio: 14.67%
[rank2]:2025-12-12 02:54:17,372 - INFO - Avg. fwd time: 7.4695 / Avg. bwd time: 17.5648 / Avg. batch time: 522.9940 (ms) / GPU bubble ratio: 61.71%
[rank0]:2025-12-12 02:54:17,422 - INFO - Avg. fwd time: 7.6922 / Avg. bwd time: 18.9105 / Avg. batch time: 592.3133 (ms) / GPU bubble ratio: 64.07%
[rank0]:2025-12-12 02:56:08,189 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 02:56:12,729 - INFO - Avg. fwd time: 13.7733 / Avg. bwd time: 38.3591 / Avg. batch time: 489.3428 (ms) / GPU bubble ratio: 14.77%
[rank3]:2025-12-12 02:56:12,736 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.38(0.40)/0.40, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-12 02:56:12,753 - INFO - Avg. fwd time: 7.4911 / Avg. bwd time: 17.4151 / Avg. batch time: 519.3530 (ms) / GPU bubble ratio: 61.64%
[rank2]:2025-12-12 02:56:12,759 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-12 02:56:12,780 - INFO - Avg. fwd time: 9.7130 / Avg. bwd time: 21.3495 / Avg. batch time: 555.8622 (ms) / GPU bubble ratio: 55.29%
[rank1]:2025-12-12 02:56:12,786 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 02:56:12,828 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.6454  memory:  9.36GiB(19.71%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank0]:2025-12-12 02:56:12,803 - INFO - Avg. fwd time: 7.7445 / Avg. bwd time: 18.2729 / Avg. batch time: 588.1859 (ms) / GPU bubble ratio: 64.61%
[rank0]:2025-12-12 02:56:12,810 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-12 02:56:12,839 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.6454  memory: 13.29GiB(27.97%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank3]:2025-12-12 02:56:12,837 - INFO -  step: 200  loss:  1.3218  grad_norm:  3.6454  memory: 17.37GiB(36.56%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank2]:2025-12-12 02:56:12,825 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.6454  memory:  6.51GiB(13.70%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank2]:2025-12-12 02:56:12,888 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0256_stage2_step200.svg
[rank1]:2025-12-12 02:56:12,888 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0256_stage1_step200.svg
[rank0]:2025-12-12 02:56:12,890 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0256_stage0_step200.svg
[rank3]:2025-12-12 02:56:12,989 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0256_real_step200_rank3.svg
[rank3]:			> Batch Time: 552.56 ms, GPU Bubble Ratio: 69.59%, 57.33%, 65.38%, 30.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  106-4-111ms    | [S0,MB4,F]  111-8-119ms    | [S0,MB1,B]  170-4-175ms    | [S0,MB5,F]  175-6-182ms    | [S0,MB2,B]  243-4-248ms    | [S0,MB6,F]  248-6-254ms    | [S0,MB3,B]  314-4-319ms    | [S0,MB7,F]  319-6-326ms    | [S0,MB4,B]  369-23-393ms   | [S0,MB5,B]  432-23-456ms   | [S0,MB6,B]  492-18-510ms   | [S0,MB7,B]  535-17-552ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  88-12-101ms    | [S1,MB3,F]  104-10-115ms   | [S1,MB1,B]  152-12-165ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  225-12-237ms   | [S1,MB5,F]  241-8-250ms    | [S1,MB3,B]  285-24-309ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  340-24-364ms   | [S1,MB7,F]  368-9-377ms    | [S1,MB5,B]  405-24-429ms   | [S1,MB6,B]  464-24-488ms   | [S1,MB7,B]  510-21-531ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-83ms      | [S2,MB2,F]  87-8-95ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  151-6-157ms    | [S2,MB2,B]  200-19-220ms   | [S2,MB4,F]  223-6-230ms    | [S2,MB3,B]  261-19-280ms   | [S2,MB5,F]  283-7-290ms    | [S2,MB4,B]  315-19-334ms   | [S2,MB6,F]  338-7-345ms    | [S2,MB5,B]  380-19-400ms   | [S2,MB7,F]  403-7-410ms    | [S2,MB6,B]  442-19-461ms   | [S2,MB7,B]  491-16-507ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  73-13-87ms     | [S3,MB1,B]  92-40-133ms    | [S3,MB2,F]  137-11-148ms   | [S3,MB2,B]  154-41-195ms   | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  218-37-255ms   | [S3,MB4,F]  259-16-275ms   | [S3,MB4,B]  282-28-310ms   | [S3,MB5,F]  314-11-326ms   | [S3,MB5,B]  333-42-375ms   | [S3,MB6,F]  379-13-393ms   | [S3,MB6,B]  399-37-437ms   | [S3,MB7,F]  440-16-457ms   | [S3,MB7,B]  463-24-487ms  
[rank3]:2025-12-12 02:56:13,036 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0256_stage3_step200.svg
[rank3]:2025-12-12 02:58:07,893 - INFO - Avg. fwd time: 13.8153 / Avg. bwd time: 37.9653 / Avg. batch time: 486.5514 (ms) / GPU bubble ratio: 14.86%
[rank2]:2025-12-12 02:58:07,916 - INFO - Avg. fwd time: 7.5111 / Avg. bwd time: 17.2742 / Avg. batch time: 516.4710 (ms) / GPU bubble ratio: 61.61%
[rank1]:2025-12-12 02:58:07,943 - INFO - Avg. fwd time: 9.7495 / Avg. bwd time: 21.0626 / Avg. batch time: 552.8252 (ms) / GPU bubble ratio: 55.41%
[rank0]:2025-12-12 02:58:07,966 - INFO - Avg. fwd time: 7.7874 / Avg. bwd time: 17.4079 / Avg. batch time: 584.8143 (ms) / GPU bubble ratio: 65.53%
[rank0]:2025-12-12 02:59:58,431 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 03:00:02,863 - INFO - Avg. fwd time: 13.8407 / Avg. bwd time: 37.6600 / Avg. batch time: 484.3310 (ms) / GPU bubble ratio: 14.93%
[rank3]:2025-12-12 03:00:02,867 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.41(0.40)/0.40, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 03:00:02,886 - INFO - Avg. fwd time: 7.5268 / Avg. bwd time: 17.1628 / Avg. batch time: 514.1250 (ms) / GPU bubble ratio: 61.58%
[rank2]:2025-12-12 03:00:02,892 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 03:00:02,914 - INFO - Avg. fwd time: 9.7769 / Avg. bwd time: 20.8337 / Avg. batch time: 550.3576 (ms) / GPU bubble ratio: 55.50%
[rank1]:2025-12-12 03:00:02,921 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-12 03:00:02,971 - INFO -  step: 250  loss:  0.4368  grad_norm:  0.9397  memory: 17.37GiB(36.56%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank0]:2025-12-12 03:00:02,937 - INFO - Avg. fwd time: 7.8204 / Avg. bwd time: 16.6974 / Avg. batch time: 582.0763 (ms) / GPU bubble ratio: 66.30%
[rank0]:2025-12-12 03:00:02,945 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 03:00:02,973 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9397  memory: 13.29GiB(27.97%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank2]:2025-12-12 03:00:02,959 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9397  memory:  6.51GiB(13.70%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank1]:2025-12-12 03:00:02,962 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9397  memory:  9.36GiB(19.71%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank3]:2025-12-12 03:01:58,160 - INFO - Avg. fwd time: 13.8615 / Avg. bwd time: 37.4306 / Avg. batch time: 482.6585 (ms) / GPU bubble ratio: 14.98%
[rank0]:2025-12-12 03:01:58,235 - INFO - Avg. fwd time: 7.8466 / Avg. bwd time: 16.1307 / Avg. batch time: 579.9716 (ms) / GPU bubble ratio: 66.93%
[rank2]:2025-12-12 03:01:58,183 - INFO - Avg. fwd time: 7.5390 / Avg. bwd time: 17.0705 / Avg. batch time: 512.3481 (ms) / GPU bubble ratio: 61.57%
[rank1]:2025-12-12 03:01:58,211 - INFO - Avg. fwd time: 9.7977 / Avg. bwd time: 20.6444 / Avg. batch time: 548.4771 (ms) / GPU bubble ratio: 55.60%
[rank0]:2025-12-12 03:03:48,637 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 03:03:53,213 - INFO - Avg. fwd time: 7.5493 / Avg. bwd time: 16.9937 / Avg. batch time: 510.7586 (ms) / GPU bubble ratio: 61.56%
[rank1]:2025-12-12 03:03:53,240 - INFO - Avg. fwd time: 9.8160 / Avg. bwd time: 20.4871 / Avg. batch time: 546.8028 (ms) / GPU bubble ratio: 55.67%
[rank1]:2025-12-12 03:03:53,248 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-12 03:03:53,189 - INFO - Avg. fwd time: 13.8794 / Avg. bwd time: 37.2245 / Avg. batch time: 481.1574 (ms) / GPU bubble ratio: 15.03%
[rank3]:2025-12-12 03:03:53,194 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.41(0.40)/0.40, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 03:03:53,265 - INFO - Avg. fwd time: 7.8678 / Avg. bwd time: 15.6563 / Avg. batch time: 578.1079 (ms) / GPU bubble ratio: 67.45%
[rank0]:2025-12-12 03:03:53,272 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 03:03:53,219 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 03:03:53,286 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3286  memory:  6.51GiB(13.70%)  tps: 7,113  tflops: 55.61  mfu: 17.82%
[rank1]:2025-12-12 03:03:53,290 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3286  memory:  9.36GiB(19.71%)  tps: 7,113  tflops: 55.61  mfu: 17.82%
[rank1]:2025-12-12 03:03:53,348 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0303_stage1_step300.svg
[rank3]:2025-12-12 03:03:53,298 - INFO -  step: 300  loss:  0.2792  grad_norm:  0.3286  memory: 17.37GiB(36.56%)  tps: 7,113  tflops: 55.61  mfu: 17.82%
[rank0]:2025-12-12 03:03:53,301 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3286  memory: 13.29GiB(27.97%)  tps: 7,113  tflops: 55.61  mfu: 17.82%
[rank0]:2025-12-12 03:03:53,349 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0303_stage0_step300.svg
[rank2]:2025-12-12 03:03:53,347 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0303_stage2_step300.svg
[rank3]:2025-12-12 03:03:53,437 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0303_real_step300_rank3.svg
[rank3]:			> Batch Time: 563.72 ms, GPU Bubble Ratio: 73.82%, 59.16%, 66.17%, 29.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  241-0-241ms    | [S0,MB6,F]  241-6-247ms    | [S0,MB3,B]  318-0-318ms    | [S0,MB7,F]  318-6-325ms    | [S0,MB4,B]  381-23-405ms   | [S0,MB5,B]  445-23-469ms   | [S0,MB6,B]  504-18-523ms   | [S0,MB7,B]  547-16-563ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-175ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  239-8-247ms    | [S1,MB3,B]  289-24-313ms   | [S1,MB6,F]  316-8-325ms    | [S1,MB4,B]  352-24-376ms   | [S1,MB7,F]  380-9-389ms    | [S1,MB5,B]  418-24-442ms   | [S1,MB6,B]  476-24-500ms   | [S1,MB7,B]  523-20-543ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-6-230ms    | [S2,MB3,B]  264-19-283ms   | [S2,MB5,F]  287-6-294ms    | [S2,MB4,B]  327-19-347ms   | [S2,MB6,F]  350-6-357ms    | [S2,MB5,B]  393-19-413ms   | [S2,MB7,F]  416-7-423ms    | [S2,MB6,B]  454-19-473ms   | [S2,MB7,B]  503-16-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-133ms    | [S3,MB2,F]  136-11-148ms   | [S3,MB2,B]  154-41-195ms   | [S3,MB3,F]  198-13-212ms   | [S3,MB3,B]  218-41-259ms   | [S3,MB4,F]  263-14-277ms   | [S3,MB4,B]  283-38-322ms   | [S3,MB5,F]  326-13-340ms   | [S3,MB5,B]  346-42-388ms   | [S3,MB6,F]  392-14-406ms   | [S3,MB6,B]  412-36-449ms   | [S3,MB7,F]  452-17-470ms   | [S3,MB7,B]  476-22-498ms  
[rank3]:2025-12-12 03:03:53,480 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0303_stage3_step300.svg
[rank3]:2025-12-12 03:05:46,916 - INFO - Avg. fwd time: 13.8883 / Avg. bwd time: 36.9803 / Avg. batch time: 479.3095 (ms) / GPU bubble ratio: 15.10%
[rank2]:2025-12-12 03:05:46,941 - INFO - Avg. fwd time: 7.5582 / Avg. bwd time: 16.9283 / Avg. batch time: 508.8840 (ms) / GPU bubble ratio: 61.51%
[rank1]:2025-12-12 03:05:46,969 - INFO - Avg. fwd time: 9.8324 / Avg. bwd time: 20.3554 / Avg. batch time: 544.8575 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-12 03:05:46,994 - INFO - Avg. fwd time: 7.8864 / Avg. bwd time: 15.2388 / Avg. batch time: 576.0041 (ms) / GPU bubble ratio: 67.88%
[rank0]:2025-12-12 03:07:37,179 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 03:07:41,736 - INFO - Avg. fwd time: 13.9018 / Avg. bwd time: 36.8234 / Avg. batch time: 478.1715 (ms) / GPU bubble ratio: 15.13%
[rank2]:2025-12-12 03:07:41,760 - INFO - Avg. fwd time: 7.5659 / Avg. bwd time: 16.8718 / Avg. batch time: 507.6802 (ms) / GPU bubble ratio: 61.49%
[rank1]:2025-12-12 03:07:41,788 - INFO - Avg. fwd time: 9.8455 / Avg. bwd time: 20.2398 / Avg. batch time: 543.5895 (ms) / GPU bubble ratio: 55.72%
[rank1]:2025-12-12 03:07:41,838 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1381  memory:  9.36GiB(19.71%)  tps: 7,169  tflops: 56.04  mfu: 17.96%
[rank0]:2025-12-12 03:07:41,813 - INFO - Avg. fwd time: 7.9026 / Avg. bwd time: 14.8829 / Avg. batch time: 574.6000 (ms) / GPU bubble ratio: 68.28%
[rank0]:2025-12-12 03:07:41,849 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1381  memory: 13.29GiB(27.97%)  tps: 7,169  tflops: 56.04  mfu: 17.96%
[rank3]:2025-12-12 03:07:41,847 - INFO -  step: 350  loss:  0.2240  grad_norm:  0.1381  memory: 17.37GiB(36.56%)  tps: 7,169  tflops: 56.04  mfu: 17.96%
[rank2]:2025-12-12 03:07:41,835 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1381  memory:  6.51GiB(13.70%)  tps: 7,169  tflops: 56.04  mfu: 17.96%
[rank1]:2025-12-12 03:09:35,606 - INFO - Avg. fwd time: 9.8583 / Avg. bwd time: 20.1413 / Avg. batch time: 542.1597 (ms) / GPU bubble ratio: 55.73%
[rank3]:2025-12-12 03:09:35,552 - INFO - Avg. fwd time: 13.9020 / Avg. bwd time: 36.6565 / Avg. batch time: 476.8386 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-12 03:09:35,577 - INFO - Avg. fwd time: 7.5730 / Avg. bwd time: 16.8223 / Avg. batch time: 506.2992 (ms) / GPU bubble ratio: 61.45%
[rank0]:2025-12-12 03:09:35,631 - INFO - Avg. fwd time: 7.9166 / Avg. bwd time: 14.5873 / Avg. batch time: 573.0522 (ms) / GPU bubble ratio: 68.58%
[rank0]:2025-12-12 03:11:25,801 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-12 03:11:30,449 - INFO - Avg. fwd time: 9.8682 / Avg. bwd time: 20.0526 / Avg. batch time: 541.2224 (ms) / GPU bubble ratio: 55.77%
[rank3]:2025-12-12 03:11:30,395 - INFO - Avg. fwd time: 13.9112 / Avg. bwd time: 36.5440 / Avg. batch time: 476.0083 (ms) / GPU bubble ratio: 15.20%
[rank0]:2025-12-12 03:11:30,475 - INFO - Avg. fwd time: 7.9291 / Avg. bwd time: 14.3157 / Avg. batch time: 572.0116 (ms) / GPU bubble ratio: 68.89%
[rank2]:2025-12-12 03:11:30,420 - INFO - Avg. fwd time: 7.5790 / Avg. bwd time: 16.7785 / Avg. batch time: 505.4124 (ms) / GPU bubble ratio: 61.45%
[rank2]:2025-12-12 03:11:30,496 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0712  memory:  6.51GiB(13.70%)  tps: 7,165  tflops: 56.01  mfu: 17.95%
[rank1]:2025-12-12 03:11:30,500 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0712  memory:  9.36GiB(19.71%)  tps: 7,165  tflops: 56.01  mfu: 17.95%
[rank1]:2025-12-12 03:11:30,563 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0311_stage1_step400.svg
[rank3]:2025-12-12 03:11:30,508 - INFO -  step: 400  loss:  0.2107  grad_norm:  0.0712  memory: 17.37GiB(36.56%)  tps: 7,165  tflops: 56.01  mfu: 17.95%
[rank0]:2025-12-12 03:11:30,511 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0712  memory: 13.29GiB(27.97%)  tps: 7,165  tflops: 56.01  mfu: 17.95%
[rank0]:2025-12-12 03:11:30,564 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0311_stage0_step400.svg
[rank2]:2025-12-12 03:11:30,564 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0311_stage2_step400.svg
[rank3]:2025-12-12 03:11:30,648 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0311_real_step400_rank3.svg
[rank3]:			> Batch Time: 559.19 ms, GPU Bubble Ratio: 73.69%, 58.97%, 65.97%, 29.60%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-246ms    | [S0,MB3,B]  316-0-316ms    | [S0,MB7,F]  316-6-323ms    | [S0,MB4,B]  377-23-401ms   | [S0,MB5,B]  442-23-465ms   | [S0,MB6,B]  501-17-518ms   | [S0,MB7,B]  542-16-559ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  287-24-311ms   | [S1,MB6,F]  314-8-323ms    | [S1,MB4,B]  348-24-372ms   | [S1,MB7,F]  376-9-385ms    | [S1,MB5,B]  414-24-438ms   | [S1,MB6,B]  473-24-497ms   | [S1,MB7,B]  518-20-539ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  222-6-229ms    | [S2,MB3,B]  262-19-281ms   | [S2,MB5,F]  285-6-292ms    | [S2,MB4,B]  324-19-343ms   | [S2,MB6,F]  346-6-353ms    | [S2,MB5,B]  389-19-409ms   | [S2,MB7,F]  412-7-419ms    | [S2,MB6,B]  450-19-469ms   | [S2,MB7,B]  499-16-515ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  198-12-211ms   | [S3,MB3,B]  217-40-258ms   | [S3,MB4,F]  261-15-276ms   | [S3,MB4,B]  282-36-318ms   | [S3,MB5,F]  322-14-336ms   | [S3,MB5,B]  342-42-385ms   | [S3,MB6,F]  388-14-402ms   | [S3,MB6,B]  409-37-446ms   | [S3,MB7,F]  449-17-466ms   | [S3,MB7,B]  472-22-495ms  
[rank3]:2025-12-12 03:11:30,696 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0311_stage3_step400.svg
[rank3]:2025-12-12 03:11:57,096 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 03:11:57,308 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 03:11:57,332 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-12 03:11:57,351 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-12 03:13:25,579 - INFO - Avg. fwd time: 13.9129 / Avg. bwd time: 36.4565 / Avg. batch time: 475.3303 (ms) / GPU bubble ratio: 15.23%
[rank2]:2025-12-12 03:13:25,605 - INFO - Avg. fwd time: 7.5838 / Avg. bwd time: 16.7396 / Avg. batch time: 504.7265 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-12-12 03:13:25,634 - INFO - Avg. fwd time: 9.8755 / Avg. bwd time: 19.9742 / Avg. batch time: 540.4941 (ms) / GPU bubble ratio: 55.82%
[rank0]:2025-12-12 03:13:25,660 - INFO - Avg. fwd time: 7.9397 / Avg. bwd time: 14.0878 / Avg. batch time: 571.1927 (ms) / GPU bubble ratio: 69.15%
[rank0]:2025-12-12 03:15:16,886 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 03:15:21,436 - INFO - Avg. fwd time: 13.9182 / Avg. bwd time: 36.4104 / Avg. batch time: 474.9970 (ms) / GPU bubble ratio: 15.24%
[rank2]:2025-12-12 03:15:21,462 - INFO - Avg. fwd time: 7.5874 / Avg. bwd time: 16.7046 / Avg. batch time: 504.3444 (ms) / GPU bubble ratio: 61.47%
[rank1]:2025-12-12 03:15:21,492 - INFO - Avg. fwd time: 9.8798 / Avg. bwd time: 19.9023 / Avg. batch time: 540.0668 (ms) / GPU bubble ratio: 55.88%
[rank1]:2025-12-12 03:15:21,543 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0923  memory:  9.36GiB(19.71%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank3]:2025-12-12 03:15:21,552 - INFO -  step: 450  loss:  0.2258  grad_norm:  0.0923  memory: 17.37GiB(36.56%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank0]:2025-12-12 03:15:21,518 - INFO - Avg. fwd time: 7.9484 / Avg. bwd time: 13.8726 / Avg. batch time: 570.6814 (ms) / GPU bubble ratio: 69.41%
[rank0]:2025-12-12 03:15:21,554 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0923  memory: 13.29GiB(27.97%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank2]:2025-12-12 03:15:21,539 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0923  memory:  6.51GiB(13.70%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank3]:2025-12-12 03:17:16,257 - INFO - Avg. fwd time: 13.9196 / Avg. bwd time: 36.3359 / Avg. batch time: 474.4069 (ms) / GPU bubble ratio: 15.25%
[rank0]:2025-12-12 03:17:16,339 - INFO - Avg. fwd time: 7.9562 / Avg. bwd time: 13.6825 / Avg. batch time: 569.9378 (ms) / GPU bubble ratio: 69.63%
[rank2]:2025-12-12 03:17:16,283 - INFO - Avg. fwd time: 7.5911 / Avg. bwd time: 16.6730 / Avg. batch time: 503.7182 (ms) / GPU bubble ratio: 61.46%
[rank1]:2025-12-12 03:17:16,313 - INFO - Avg. fwd time: 9.8861 / Avg. bwd time: 19.8391 / Avg. batch time: 539.4010 (ms) / GPU bubble ratio: 55.91%
[rank0]:2025-12-12 03:19:07,939 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 03:19:12,515 - INFO - Avg. fwd time: 7.5945 / Avg. bwd time: 16.6446 / Avg. batch time: 503.4864 (ms) / GPU bubble ratio: 61.49%
[rank3]:2025-12-12 03:19:12,489 - INFO - Avg. fwd time: 13.9251 / Avg. bwd time: 36.3070 / Avg. batch time: 474.2124 (ms) / GPU bubble ratio: 15.26%
[rank0]:2025-12-12 03:19:12,572 - INFO - Avg. fwd time: 7.9633 / Avg. bwd time: 13.5206 / Avg. batch time: 569.6009 (ms) / GPU bubble ratio: 69.83%
[rank0]:2025-12-12 03:19:12,608 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0932  memory: 13.29GiB(27.97%)  tps: 7,091  tflops: 55.43  mfu: 17.77%
[rank2]:2025-12-12 03:19:12,594 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0932  memory:  6.51GiB(13.70%)  tps: 7,091  tflops: 55.43  mfu: 17.77%
[rank1]:2025-12-12 03:19:12,546 - INFO - Avg. fwd time: 9.8906 / Avg. bwd time: 19.7812 / Avg. batch time: 539.1310 (ms) / GPU bubble ratio: 55.97%
[rank1]:2025-12-12 03:19:12,597 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0932  memory:  9.36GiB(19.71%)  tps: 7,091  tflops: 55.43  mfu: 17.77%
[rank3]:2025-12-12 03:19:12,606 - INFO -  step: 500  loss:  0.2171  grad_norm:  0.0932  memory: 17.37GiB(36.56%)  tps: 7,091  tflops: 55.43  mfu: 17.77%
[rank0]:2025-12-12 03:19:12,658 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0319_stage0_step500.svg
[rank2]:2025-12-12 03:19:12,657 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0319_stage2_step500.svg
[rank1]:2025-12-12 03:19:12,657 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0319_stage1_step500.svg
[rank3]:2025-12-12 03:19:12,744 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0319_real_step500_rank3.svg
[rank3]:			> Batch Time: 564.17 ms, GPU Bubble Ratio: 73.78%, 59.33%, 66.25%, 29.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-246ms    | [S0,MB3,B]  317-0-317ms    | [S0,MB7,F]  317-6-324ms    | [S0,MB4,B]  381-23-405ms   | [S0,MB5,B]  446-23-469ms   | [S0,MB6,B]  505-18-524ms   | [S0,MB7,B]  547-16-564ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  288-24-312ms   | [S1,MB6,F]  315-8-324ms    | [S1,MB4,B]  352-24-376ms   | [S1,MB7,F]  379-9-389ms    | [S1,MB5,B]  418-24-442ms   | [S1,MB6,B]  477-24-501ms   | [S1,MB7,B]  523-20-543ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  150-6-156ms    | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  264-19-283ms   | [S2,MB5,F]  286-7-293ms    | [S2,MB4,B]  328-19-347ms   | [S2,MB6,F]  350-7-357ms    | [S2,MB5,B]  394-19-413ms   | [S2,MB7,F]  416-7-423ms    | [S2,MB6,B]  454-19-473ms   | [S2,MB7,B]  503-16-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-41-259ms   | [S3,MB4,F]  262-13-276ms   | [S3,MB4,B]  282-40-322ms   | [S3,MB5,F]  326-14-341ms   | [S3,MB5,B]  346-42-389ms   | [S3,MB6,F]  392-14-406ms   | [S3,MB6,B]  413-37-450ms   | [S3,MB7,F]  453-17-470ms   | [S3,MB7,B]  477-22-499ms  
[rank3]:2025-12-12 03:19:12,787 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0319_stage3_step500.svg
[rank3]:2025-12-12 03:21:06,494 - INFO - Avg. fwd time: 13.9243 / Avg. bwd time: 36.2149 / Avg. batch time: 473.4708 (ms) / GPU bubble ratio: 15.28%
[rank2]:2025-12-12 03:21:06,520 - INFO - Avg. fwd time: 7.5982 / Avg. bwd time: 16.6190 / Avg. batch time: 502.7421 (ms) / GPU bubble ratio: 61.46%
[rank1]:2025-12-12 03:21:06,551 - INFO - Avg. fwd time: 9.8961 / Avg. bwd time: 19.7302 / Avg. batch time: 538.3548 (ms) / GPU bubble ratio: 55.97%
[rank0]:2025-12-12 03:21:06,578 - INFO - Avg. fwd time: 7.9698 / Avg. bwd time: 13.3832 / Avg. batch time: 568.7623 (ms) / GPU bubble ratio: 69.97%
[rank0]:2025-12-12 03:22:56,787 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 03:23:01,361 - INFO - Avg. fwd time: 13.9256 / Avg. bwd time: 36.1600 / Avg. batch time: 473.0378 (ms) / GPU bubble ratio: 15.30%
[rank2]:2025-12-12 03:23:01,388 - INFO - Avg. fwd time: 7.6011 / Avg. bwd time: 16.5953 / Avg. batch time: 502.2813 (ms) / GPU bubble ratio: 61.46%
[rank1]:2025-12-12 03:23:01,419 - INFO - Avg. fwd time: 9.9005 / Avg. bwd time: 19.6828 / Avg. batch time: 537.8617 (ms) / GPU bubble ratio: 56.00%
[rank0]:2025-12-12 03:23:01,446 - INFO - Avg. fwd time: 7.9753 / Avg. bwd time: 13.2494 / Avg. batch time: 568.2106 (ms) / GPU bubble ratio: 70.12%
[rank0]:2025-12-12 03:23:01,482 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0725  memory: 13.29GiB(27.97%)  tps: 7,159  tflops: 55.96  mfu: 17.94%
[rank2]:2025-12-12 03:23:01,467 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0725  memory:  6.51GiB(13.70%)  tps: 7,159  tflops: 55.96  mfu: 17.94%
[rank1]:2025-12-12 03:23:01,471 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0725  memory:  9.36GiB(19.71%)  tps: 7,159  tflops: 55.96  mfu: 17.94%
[rank3]:2025-12-12 03:23:01,480 - INFO -  step: 550  loss:  0.2240  grad_norm:  0.0725  memory: 17.37GiB(36.56%)  tps: 7,159  tflops: 55.96  mfu: 17.94%
[rank2]:2025-12-12 03:24:57,177 - INFO - Avg. fwd time: 7.6036 / Avg. bwd time: 16.5735 / Avg. batch time: 502.0639 (ms) / GPU bubble ratio: 61.48%
[rank3]:2025-12-12 03:24:57,150 - INFO - Avg. fwd time: 13.9303 / Avg. bwd time: 36.1325 / Avg. batch time: 472.8524 (ms) / GPU bubble ratio: 15.30%
[rank0]:2025-12-12 03:24:57,236 - INFO - Avg. fwd time: 7.9804 / Avg. bwd time: 13.1192 / Avg. batch time: 567.9108 (ms) / GPU bubble ratio: 70.28%
[rank1]:2025-12-12 03:24:57,208 - INFO - Avg. fwd time: 9.9046 / Avg. bwd time: 19.6394 / Avg. batch time: 537.6150 (ms) / GPU bubble ratio: 56.04%
[rank0]:2025-12-12 03:26:48,489 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 03:26:53,127 - INFO - Avg. fwd time: 13.9346 / Avg. bwd time: 36.1118 / Avg. batch time: 472.7190 (ms) / GPU bubble ratio: 15.30%
[rank0]:2025-12-12 03:26:53,214 - INFO - Avg. fwd time: 7.9852 / Avg. bwd time: 13.0078 / Avg. batch time: 567.6751 (ms) / GPU bubble ratio: 70.42%
[rank2]:2025-12-12 03:26:53,155 - INFO - Avg. fwd time: 7.6061 / Avg. bwd time: 16.5536 / Avg. batch time: 501.9024 (ms) / GPU bubble ratio: 61.49%
[rank2]:2025-12-12 03:26:53,236 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0988  memory:  6.51GiB(13.70%)  tps: 7,069  tflops: 55.26  mfu: 17.71%
[rank1]:2025-12-12 03:26:53,186 - INFO - Avg. fwd time: 9.9084 / Avg. bwd time: 19.5996 / Avg. batch time: 537.4268 (ms) / GPU bubble ratio: 56.08%
[rank1]:2025-12-12 03:26:53,239 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0988  memory:  9.36GiB(19.71%)  tps: 7,069  tflops: 55.26  mfu: 17.71%
[rank3]:2025-12-12 03:26:53,248 - INFO -  step: 600  loss:  0.2202  grad_norm:  0.0988  memory: 17.37GiB(36.56%)  tps: 7,069  tflops: 55.26  mfu: 17.71%
[rank0]:2025-12-12 03:26:53,250 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0988  memory: 13.29GiB(27.97%)  tps: 7,069  tflops: 55.26  mfu: 17.71%
[rank0]:2025-12-12 03:26:53,301 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0326_stage0_step600.svg
[rank2]:2025-12-12 03:26:53,301 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0326_stage2_step600.svg
[rank1]:2025-12-12 03:26:53,300 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0326_stage1_step600.svg
[rank3]:2025-12-12 03:26:53,386 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0326_real_step600_rank3.svg
[rank3]:			> Batch Time: 564.20 ms, GPU Bubble Ratio: 73.16%, 59.33%, 66.30%, 29.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-173ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  318-0-318ms    | [S0,MB7,F]  318-6-325ms    | [S0,MB4,B]  383-23-407ms   | [S0,MB5,B]  447-23-470ms   | [S0,MB6,B]  506-22-528ms   | [S0,MB7,B]  547-16-564ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  289-24-313ms   | [S1,MB6,F]  317-8-326ms    | [S1,MB4,B]  353-24-377ms   | [S1,MB7,F]  381-9-390ms    | [S1,MB5,B]  419-24-443ms   | [S1,MB6,B]  478-24-502ms   | [S1,MB7,B]  523-20-543ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-6-229ms    | [S2,MB3,B]  265-19-284ms   | [S2,MB5,F]  288-6-295ms    | [S2,MB4,B]  329-19-348ms   | [S2,MB6,F]  352-6-359ms    | [S2,MB5,B]  395-19-414ms   | [S2,MB7,F]  418-7-425ms    | [S2,MB6,B]  455-19-474ms   | [S2,MB7,B]  504-16-520ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  91-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  217-42-259ms   | [S3,MB4,F]  263-13-277ms   | [S3,MB4,B]  283-40-324ms   | [S3,MB5,F]  328-14-342ms   | [S3,MB5,B]  348-41-389ms   | [S3,MB6,F]  393-14-408ms   | [S3,MB6,B]  414-37-451ms   | [S3,MB7,F]  454-17-471ms   | [S3,MB7,B]  477-22-500ms  
[rank3]:2025-12-12 03:26:53,431 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0326_stage3_step600.svg
[rank3]:2025-12-12 03:28:47,709 - INFO - Avg. fwd time: 13.9357 / Avg. bwd time: 36.0545 / Avg. batch time: 472.2707 (ms) / GPU bubble ratio: 15.32%
[rank2]:2025-12-12 03:28:47,738 - INFO - Avg. fwd time: 7.6085 / Avg. bwd time: 16.5355 / Avg. batch time: 501.4544 (ms) / GPU bubble ratio: 61.48%
[rank1]:2025-12-12 03:28:47,770 - INFO - Avg. fwd time: 9.9121 / Avg. bwd time: 19.5635 / Avg. batch time: 536.9537 (ms) / GPU bubble ratio: 56.08%
[rank0]:2025-12-12 03:28:47,798 - INFO - Avg. fwd time: 7.9896 / Avg. bwd time: 12.8978 / Avg. batch time: 567.1580 (ms) / GPU bubble ratio: 70.54%
[rank0]:2025-12-12 03:30:36,900 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 03:30:41,338 - INFO - Avg. fwd time: 13.9353 / Avg. bwd time: 35.9838 / Avg. batch time: 471.7048 (ms) / GPU bubble ratio: 15.34%
[rank2]:2025-12-12 03:30:41,366 - INFO - Avg. fwd time: 7.6110 / Avg. bwd time: 16.5189 / Avg. batch time: 500.8741 (ms) / GPU bubble ratio: 61.46%
[rank0]:2025-12-12 03:30:41,426 - INFO - Avg. fwd time: 7.9934 / Avg. bwd time: 12.8029 / Avg. batch time: 566.5100 (ms) / GPU bubble ratio: 70.63%
[rank1]:2025-12-12 03:30:41,398 - INFO - Avg. fwd time: 9.9153 / Avg. bwd time: 19.5299 / Avg. batch time: 536.3481 (ms) / GPU bubble ratio: 56.08%
[rank1]:2025-12-12 03:30:41,451 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0737  memory:  9.36GiB(19.71%)  tps: 7,179  tflops: 56.12  mfu: 17.99%
[rank3]:2025-12-12 03:30:41,460 - INFO -  step: 650  loss:  0.2308  grad_norm:  0.0737  memory: 17.37GiB(36.56%)  tps: 7,179  tflops: 56.13  mfu: 17.99%
[rank2]:2025-12-12 03:30:41,447 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0737  memory:  6.51GiB(13.70%)  tps: 7,179  tflops: 56.12  mfu: 17.99%
[rank0]:2025-12-12 03:30:41,462 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0737  memory: 13.29GiB(27.97%)  tps: 7,179  tflops: 56.12  mfu: 17.99%
[rank3]:2025-12-12 03:32:35,404 - INFO - Avg. fwd time: 13.9371 / Avg. bwd time: 35.9275 / Avg. batch time: 471.2733 (ms) / GPU bubble ratio: 15.35%
[rank2]:2025-12-12 03:32:35,433 - INFO - Avg. fwd time: 7.6132 / Avg. bwd time: 16.5033 / Avg. batch time: 500.4249 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-12-12 03:32:35,465 - INFO - Avg. fwd time: 9.9183 / Avg. bwd time: 19.4989 / Avg. batch time: 535.8770 (ms) / GPU bubble ratio: 56.08%
[rank0]:2025-12-12 03:32:35,494 - INFO - Avg. fwd time: 7.9969 / Avg. bwd time: 12.7080 / Avg. batch time: 566.0002 (ms) / GPU bubble ratio: 70.74%
[rank0]:2025-12-12 03:34:24,885 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 03:34:29,425 - INFO - Avg. fwd time: 13.9378 / Avg. bwd time: 35.8754 / Avg. batch time: 470.8693 (ms) / GPU bubble ratio: 15.37%
[rank2]:2025-12-12 03:34:29,453 - INFO - Avg. fwd time: 7.6152 / Avg. bwd time: 16.4887 / Avg. batch time: 500.0052 (ms) / GPU bubble ratio: 61.43%
[rank0]:2025-12-12 03:34:29,515 - INFO - Avg. fwd time: 8.0002 / Avg. bwd time: 12.6260 / Avg. batch time: 565.5242 (ms) / GPU bubble ratio: 70.82%
[rank1]:2025-12-12 03:34:29,486 - INFO - Avg. fwd time: 9.9214 / Avg. bwd time: 19.4700 / Avg. batch time: 535.4363 (ms) / GPU bubble ratio: 56.09%
[rank1]:2025-12-12 03:34:29,540 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0746  memory:  9.36GiB(19.71%)  tps: 7,183  tflops: 56.15  mfu: 18.00%
[rank3]:2025-12-12 03:34:29,548 - INFO -  step: 700  loss:  0.1905  grad_norm:  0.0746  memory: 17.37GiB(36.56%)  tps: 7,183  tflops: 56.16  mfu: 18.00%
[rank2]:2025-12-12 03:34:29,536 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0746  memory:  6.51GiB(13.70%)  tps: 7,183  tflops: 56.15  mfu: 18.00%
[rank0]:2025-12-12 03:34:29,550 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0746  memory: 13.29GiB(27.97%)  tps: 7,183  tflops: 56.15  mfu: 18.00%
[rank0]:2025-12-12 03:34:29,603 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0334_stage0_step700.svg
[rank1]:2025-12-12 03:34:29,600 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0334_stage1_step700.svg
[rank2]:2025-12-12 03:34:29,601 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0334_stage2_step700.svg
[rank3]:2025-12-12 03:34:29,687 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0334_real_step700_rank3.svg
[rank3]:			> Batch Time: 561.75 ms, GPU Bubble Ratio: 73.11%, 59.05%, 66.12%, 29.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  317-0-317ms    | [S0,MB7,F]  317-6-324ms    | [S0,MB4,B]  380-23-404ms   | [S0,MB5,B]  445-23-468ms   | [S0,MB6,B]  503-21-525ms   | [S0,MB7,B]  545-16-561ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  288-24-312ms   | [S1,MB6,F]  315-8-324ms    | [S1,MB4,B]  350-24-375ms   | [S1,MB7,F]  378-9-387ms    | [S1,MB5,B]  417-24-441ms   | [S1,MB6,B]  474-24-499ms   | [S1,MB7,B]  521-20-541ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-6-229ms    | [S2,MB3,B]  264-19-283ms   | [S2,MB5,F]  286-7-293ms    | [S2,MB4,B]  326-19-345ms   | [S2,MB6,F]  349-7-356ms    | [S2,MB5,B]  393-19-412ms   | [S2,MB7,F]  415-7-422ms    | [S2,MB6,B]  452-19-471ms   | [S2,MB7,B]  502-16-518ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-41-258ms   | [S3,MB4,F]  262-14-276ms   | [S3,MB4,B]  282-39-321ms   | [S3,MB5,F]  325-13-339ms   | [S3,MB5,B]  345-42-387ms   | [S3,MB6,F]  391-14-405ms   | [S3,MB6,B]  411-36-447ms   | [S3,MB7,F]  451-17-468ms   | [S3,MB7,B]  475-22-497ms  
[rank3]:2025-12-12 03:34:29,732 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0334_stage3_step700.svg
[rank3]:2025-12-12 03:36:24,402 - INFO - Avg. fwd time: 13.9411 / Avg. bwd time: 35.8421 / Avg. batch time: 470.6349 (ms) / GPU bubble ratio: 15.38%
[rank2]:2025-12-12 03:36:24,431 - INFO - Avg. fwd time: 7.6169 / Avg. bwd time: 16.4751 / Avg. batch time: 499.7679 (ms) / GPU bubble ratio: 61.43%
[rank1]:2025-12-12 03:36:24,464 - INFO - Avg. fwd time: 9.9249 / Avg. bwd time: 19.4429 / Avg. batch time: 535.1802 (ms) / GPU bubble ratio: 56.10%
[rank0]:2025-12-12 03:36:24,493 - INFO - Avg. fwd time: 8.0035 / Avg. bwd time: 12.5542 / Avg. batch time: 565.2367 (ms) / GPU bubble ratio: 70.90%
[rank0]:2025-12-12 03:38:15,874 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 03:38:20,436 - INFO - Avg. fwd time: 13.9457 / Avg. bwd time: 35.8346 / Avg. batch time: 470.6089 (ms) / GPU bubble ratio: 15.38%
[rank2]:2025-12-12 03:38:20,466 - INFO - Avg. fwd time: 7.6184 / Avg. bwd time: 16.4623 / Avg. batch time: 499.7203 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-12-12 03:38:20,499 - INFO - Avg. fwd time: 9.9284 / Avg. bwd time: 19.4176 / Avg. batch time: 535.1168 (ms) / GPU bubble ratio: 56.13%
[rank1]:2025-12-12 03:38:20,554 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0887  memory:  9.36GiB(19.71%)  tps: 7,092  tflops: 55.44  mfu: 17.77%
[rank3]:2025-12-12 03:38:20,563 - INFO -  step: 750  loss:  0.2298  grad_norm:  0.0887  memory: 17.37GiB(36.56%)  tps: 7,092  tflops: 55.44  mfu: 17.77%
[rank2]:2025-12-12 03:38:20,551 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0887  memory:  6.51GiB(13.70%)  tps: 7,092  tflops: 55.44  mfu: 17.77%
[rank0]:2025-12-12 03:38:20,529 - INFO - Avg. fwd time: 8.0068 / Avg. bwd time: 12.4860 / Avg. batch time: 565.1448 (ms) / GPU bubble ratio: 70.99%
[rank0]:2025-12-12 03:38:20,565 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0887  memory: 13.29GiB(27.97%)  tps: 7,092  tflops: 55.44  mfu: 17.77%
[rank3]:2025-12-12 03:40:15,789 - INFO - Avg. fwd time: 13.9506 / Avg. bwd time: 35.8139 / Avg. batch time: 470.4840 (ms) / GPU bubble ratio: 15.38%
[rank2]:2025-12-12 03:40:15,819 - INFO - Avg. fwd time: 7.6199 / Avg. bwd time: 16.4504 / Avg. batch time: 499.5763 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-12-12 03:40:15,853 - INFO - Avg. fwd time: 9.9322 / Avg. bwd time: 19.3938 / Avg. batch time: 534.9568 (ms) / GPU bubble ratio: 56.14%
[rank0]:2025-12-12 03:40:15,882 - INFO - Avg. fwd time: 8.0096 / Avg. bwd time: 12.4132 / Avg. batch time: 564.9566 (ms) / GPU bubble ratio: 71.08%
[rank0]:2025-12-12 03:42:05,353 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 03:42:09,851 - INFO - Avg. fwd time: 13.9523 / Avg. bwd time: 35.7700 / Avg. batch time: 470.1515 (ms) / GPU bubble ratio: 15.39%
[rank2]:2025-12-12 03:42:09,881 - INFO - Avg. fwd time: 7.6216 / Avg. bwd time: 16.4392 / Avg. batch time: 499.2316 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-12-12 03:42:09,914 - INFO - Avg. fwd time: 9.9352 / Avg. bwd time: 19.3719 / Avg. batch time: 534.5977 (ms) / GPU bubble ratio: 56.14%
[rank1]:2025-12-12 03:42:09,970 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0773  memory:  9.36GiB(19.71%)  tps: 7,142  tflops: 55.83  mfu: 17.89%
[rank1]:2025-12-12 03:42:09,970 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0773  tps: 7,467  tflops: 58.37  mfu: 17.09%
[rank1]:2025-12-12 03:42:09,970 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-12 03:42:09,971 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-12 03:42:09,978 - INFO -  step: 800  loss:  0.2341  grad_norm:  0.0773  memory: 17.37GiB(36.56%)  tps: 7,142  tflops: 55.83  mfu: 17.89%
[rank3]:2025-12-12 03:42:09,979 - INFO -  final step: 800  loss:  0.2341  grad_norm:  0.0773  tps: 7,471  tflops: 58.41  mfu: 17.23%
[rank3]:2025-12-12 03:42:09,979 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-12 03:42:09,980 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 03:42:09,944 - INFO - Avg. fwd time: 8.0124 / Avg. bwd time: 12.3529 / Avg. batch time: 564.5731 (ms) / GPU bubble ratio: 71.14%
[rank0]:2025-12-12 03:42:09,980 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0773  memory: 13.29GiB(27.97%)  tps: 7,142  tflops: 55.83  mfu: 17.89%
[rank0]:2025-12-12 03:42:09,980 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0773  tps: 7,466  tflops: 58.37  mfu: 17.08%
[rank0]:2025-12-12 03:42:09,980 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-12 03:42:09,981 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-12 03:42:09,966 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0773  memory:  6.51GiB(13.70%)  tps: 7,142  tflops: 55.83  mfu: 17.89%
[rank2]:2025-12-12 03:42:09,966 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0773  tps: 7,467  tflops: 58.37  mfu: 17.09%
[rank2]:2025-12-12 03:42:09,966 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-12 03:42:09,967 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 03:42:11,881 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-12 03:42:11,950 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251212_0342_stage1_final800.svg
[rank0]:2025-12-12 03:42:11,952 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251212_0342_stage0_final800.svg
[rank2]:2025-12-12 03:42:11,950 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251212_0342_stage2_final800.svg
[rank3]:2025-12-12 03:42:12,039 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0342_real_final800_rank3.svg
[rank3]:			> Batch Time: 560.25 ms, GPU Bubble Ratio: 73.61%, 58.94%, 66.00%, 29.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  168-6-174ms    | [S0,MB2,B]  241-0-241ms    | [S0,MB6,F]  241-6-247ms    | [S0,MB3,B]  317-0-317ms    | [S0,MB7,F]  317-6-324ms    | [S0,MB4,B]  378-23-402ms   | [S0,MB5,B]  443-23-466ms   | [S0,MB6,B]  502-18-520ms   | [S0,MB7,B]  543-16-560ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-175ms    | [S1,MB2,B]  225-10-235ms   | [S1,MB5,F]  239-8-248ms    | [S1,MB3,B]  287-24-312ms   | [S1,MB6,F]  315-9-324ms    | [S1,MB4,B]  349-24-373ms   | [S1,MB7,F]  377-9-386ms    | [S1,MB5,B]  415-24-439ms   | [S1,MB6,B]  474-24-498ms   | [S1,MB7,B]  519-20-540ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-6-230ms    | [S2,MB3,B]  263-19-282ms   | [S2,MB5,F]  286-7-293ms    | [S2,MB4,B]  325-19-344ms   | [S2,MB6,F]  347-7-354ms    | [S2,MB5,B]  391-19-410ms   | [S2,MB7,F]  414-7-421ms    | [S2,MB6,B]  451-19-470ms   | [S2,MB7,B]  500-16-516ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-133ms    | [S3,MB2,F]  136-11-148ms   | [S3,MB2,B]  154-41-195ms   | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  218-40-259ms   | [S3,MB4,F]  262-15-277ms   | [S3,MB4,B]  283-38-321ms   | [S3,MB5,F]  323-13-337ms   | [S3,MB5,B]  343-42-386ms   | [S3,MB6,F]  389-13-403ms   | [S3,MB6,B]  409-37-447ms   | [S3,MB7,F]  450-16-467ms   | [S3,MB7,B]  473-22-496ms  
[rank2]:2025-12-12 03:42:12,100 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251212_0342_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank1]:2025-12-12 03:42:12,097 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251212_0342_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank3]:2025-12-12 03:42:12,176 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251212_0342_thry_final800_rank3.svg
[rank3]:			> Batch Time: 327.32 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  99-19-119ms    | [S0,MB4,F]  119-9-128ms    | [S0,MB1,B]  128-19-148ms   | [S0,MB5,F]  148-9-158ms    | [S0,MB2,B]  158-19-178ms   | [S0,MB6,F]  178-9-188ms    | [S0,MB3,B]  188-19-208ms   | [S0,MB7,F]  208-9-218ms    | [S0,MB4,B]  218-19-238ms   | [S0,MB5,B]  247-19-267ms   | [S0,MB6,B]  277-19-297ms   | [S0,MB7,B]  307-19-327ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB0,B]  79-19-99ms     | [S1,MB3,F]  99-9-109ms     | [S1,MB1,B]  109-19-128ms   | [S1,MB4,F]  128-9-138ms    | [S1,MB2,B]  138-19-158ms   | [S1,MB5,F]  158-9-168ms    | [S1,MB3,B]  168-19-188ms   | [S1,MB6,F]  188-9-198ms    | [S1,MB4,B]  198-19-218ms   | [S1,MB7,F]  218-9-228ms    | [S1,MB5,B]  228-19-247ms   | [S1,MB6,B]  257-19-277ms   | [S1,MB7,B]  287-19-307ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB0,B]  59-19-79ms     | [S2,MB2,F]  79-9-89ms      | [S2,MB1,B]  89-19-109ms    | [S2,MB3,F]  109-9-119ms    | [S2,MB2,B]  119-19-138ms   | [S2,MB4,F]  138-9-148ms    | [S2,MB3,B]  148-19-168ms   | [S2,MB5,F]  168-9-178ms    | [S2,MB4,B]  178-19-198ms   | [S2,MB6,F]  198-9-208ms    | [S2,MB5,B]  208-19-228ms   | [S2,MB7,F]  228-9-238ms    | [S2,MB6,B]  238-19-257ms   | [S2,MB7,B]  267-19-287ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB0,B]  39-19-59ms     | [S3,MB1,F]  59-9-69ms      | [S3,MB1,B]  69-19-89ms     | [S3,MB2,F]  89-9-99ms      | [S3,MB2,B]  99-19-119ms    | [S3,MB3,F]  119-9-128ms    | [S3,MB3,B]  128-19-148ms   | [S3,MB4,F]  148-9-158ms    | [S3,MB4,B]  158-19-178ms   | [S3,MB5,F]  178-9-188ms    | [S3,MB5,B]  188-19-208ms   | [S3,MB6,F]  208-9-218ms    | [S3,MB6,B]  218-19-238ms   | [S3,MB7,F]  238-9-247ms    | [S3,MB7,B]  247-19-267ms  
[rank0]:2025-12-12 03:42:12,114 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251212_0342_rank0_stage0.svg
[rank0]:	> Counts Sum: 321360, Total Sum: 1728640 (18.59%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.2, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.29, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank3]:2025-12-12 03:42:12,225 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251212_0342_stage3_final800.svg
[rank3]:2025-12-12 03:42:12,361 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251212_0342_rank3_stage3.svg
[rank3]:	> Counts Sum: 396240, Total Sum: 1354880 (29.25%), Ratio(%) per element: [29.62, 30.13, 28.76, 29.45, 29.28, 29.96, 28.76, 28.42, 30.3, 28.25, 30.47, 28.42, 30.65, 27.91, 29.28, 29.28, 29.45, 29.1, 28.93, 29.28, 30.13, 29.62, 28.59, 28.93, 28.59, 29.45, 29.45, 28.42, 29.1]
[rank1]:2025-12-12 03:42:13,954 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251212_0342_stage1.svg
[rank1]:2025-12-12 03:42:13,957 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 03:42:14,000 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251212_0342_stage0.svg
[rank0]:2025-12-12 03:42:14,004 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-12 03:42:13,937 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251212_0342_stage2.svg
[rank2]:2025-12-12 03:42:13,940 - INFO - Destroying the purge thread.
[rank1]:2025-12-12 03:42:14,073 - INFO - Process group destroyed
[rank2]:2025-12-12 03:42:14,042 - INFO - Process group destroyed
[rank3]:2025-12-12 03:42:14,182 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251212_0342_stage3.svg
[rank3]:2025-12-12 03:42:14,186 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 315-338
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.38587
[rank3]:wandb:               final/avg_loss 0.23406
[rank3]:wandb:             final/avg_mfu(%) 17.23088
[rank3]:wandb:             final/avg_tflops 58.40695
[rank3]:wandb:    final/avg_throughput(tps) 7471.26989
[rank3]:wandb:              final/grad_norm 0.07727
[rank3]:wandb:               final/max_loss 0.23406
[rank3]:wandb:                    grad_norm 0.07727
[rank3]:wandb: loss_metrics/global_avg_loss 0.23406
[rank3]:wandb: loss_metrics/global_max_loss 0.23406
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1212_1F1B_fullrand7_mfr0.3_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/gmd85rcf
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.3_42_dm1/20251212-0239/wandb/run-20251212_024000-gmd85rcf/logs
[rank3]:2025-12-12 03:42:15,599 - INFO - Process group destroyed
[rank0]:2025-12-12 03:42:16,004 - INFO - Training completed
[rank0]:2025-12-12 03:42:16,004 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 03:42:16,063 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.0', 'layers.2', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.8', 'layers.5', 'layers.6', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'output', 'layers.15', 'layers.14', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1212_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.3
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
