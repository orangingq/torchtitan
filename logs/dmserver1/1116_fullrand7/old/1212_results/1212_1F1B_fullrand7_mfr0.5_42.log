
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 12. (ê¸ˆ) 04:43:07 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1212_1F1B_fullrand7_mfr0.5_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.5) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.5
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-12 04:43:14,056 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank0]:2025-12-12 04:43:14,047 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:"
[rank1]:2025-12-12 04:43:14,056 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:"
[rank3]:2025-12-12 04:43:14,208 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank2]:2025-12-12 04:43:14,363 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-12 04:43:14,365 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 04:43:14,346 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-12 04:43:14,349 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 04:43:14,352 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-12 04:43:14,353 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-12-12 04:43:14,353 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 04:43:14,355 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-12 04:43:14,457 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 04:43:14,460 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 04:43:14,719 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-12 04:43:18,082 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-12 04:43:18,223 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-12 04:43:18,266 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 04:43:18,226 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 04:43:18,271 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 04:43:18,273 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-12 04:43:18,292 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-12 04:43:18,293 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 04:43:18,332 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-12 04:43:18,370 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 04:43:18,297 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-12 04:43:18,297 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-12 04:43:18,482 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 04:43:18,482 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-12 04:43:18,483 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-12 04:43:18,397 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-12 04:43:18,397 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 04:43:18,500 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 04:43:18,500 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 04:43:18,501 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-12 04:43:18,589 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 04:43:18,590 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-12 04:43:18,590 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 0kx3kmlf
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.5_42_dm1/20251212-0443/wandb/run-20251212_044319-0kx3kmlf
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/0kx3kmlf
[rank3]:2025-12-12 04:43:20,712 - INFO - WandB logging enabled
[rank3]:2025-12-12 04:43:20,712 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-12 04:43:20,752 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 04:43:20,782 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-12 04:43:20,782 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-12 04:43:20,980 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 04:43:20,981 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-12 04:43:20,982 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank2]:2025-12-12 04:43:20,997 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-12 04:43:20,998 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 04:43:20,998 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank0]:2025-12-12 04:43:20,998 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 04:43:20,998 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-12 04:43:20,999 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-12 04:43:20,998 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 04:43:23,080 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-12 04:43:23,080 - INFO - Finished loading the checkpoint in 2.08 seconds.
[rank0]:2025-12-12 04:43:23,080 - INFO - Training starts at step 1
[rank2]:2025-12-12 04:43:28,763 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5365  memory:  4.63GiB(9.75%)  tps: 3,122  tflops: 24.41  mfu: 7.82%
[rank2]:2025-12-12 04:43:28,763 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 04:43:28,773 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5365  memory:  6.76GiB(14.24%)  tps: 3,150  tflops: 24.63  mfu: 7.89%
[rank1]:2025-12-12 04:43:28,774 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 04:43:28,772 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5365  memory: 12.97GiB(27.31%)  tps: 4,087  tflops: 31.95  mfu: 10.24%
[rank0]:2025-12-12 04:43:28,800 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5365  memory:  9.19GiB(19.34%)  tps: 3,112  tflops: 24.33  mfu: 7.80%
[rank3]:2025-12-12 04:43:28,773 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-12 04:43:28,800 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 04:45:31,048 - INFO - Avg. fwd time: 9.3439 / Avg. bwd time: 23.8888 / Avg. batch time: 584.1481 (ms) / GPU bubble ratio: 54.49%
[rank3]:2025-12-12 04:45:30,995 - INFO - Avg. fwd time: 13.3144 / Avg. bwd time: 41.7587 / Avg. batch time: 513.1627 (ms) / GPU bubble ratio: 14.14%
[rank2]:2025-12-12 04:45:31,019 - INFO - Avg. fwd time: 7.2824 / Avg. bwd time: 18.9433 / Avg. batch time: 545.1997 (ms) / GPU bubble ratio: 61.52%
[rank0]:2025-12-12 04:45:31,076 - INFO - Avg. fwd time: 7.3507 / Avg. bwd time: 23.5351 / Avg. batch time: 621.2019 (ms) / GPU bubble ratio: 60.22%
[rank0]:2025-12-12 04:47:34,103 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:47:39,112 - INFO - Avg. fwd time: 13.4260 / Avg. bwd time: 41.9453 / Avg. batch time: 515.4357 (ms) / GPU bubble ratio: 14.06%
[rank2]:2025-12-12 04:47:39,137 - INFO - Avg. fwd time: 7.2836 / Avg. bwd time: 18.9857 / Avg. batch time: 547.1071 (ms) / GPU bubble ratio: 61.59%
[rank3]:2025-12-12 04:47:39,229 - INFO -  step: 50  loss:  9.9111  grad_norm: 12.7545  memory: 16.39GiB(34.50%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank0]:2025-12-12 04:47:39,194 - INFO - Avg. fwd time: 7.3518 / Avg. bwd time: 23.5738 / Avg. batch time: 622.4468 (ms) / GPU bubble ratio: 60.25%
[rank0]:2025-12-12 04:47:39,230 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7545  memory: 12.97GiB(27.31%)  tps: 6,412  tflops: 50.12  mfu: 16.06%
[rank1]:2025-12-12 04:47:39,166 - INFO - Avg. fwd time: 9.3445 / Avg. bwd time: 23.9497 / Avg. batch time: 585.7352 (ms) / GPU bubble ratio: 54.53%
[rank1]:2025-12-12 04:47:39,219 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7545  memory:  9.03GiB(19.01%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank2]:2025-12-12 04:47:39,216 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7545  memory:  6.43GiB(13.53%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank3]:2025-12-12 04:48:30,415 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-12 04:49:21,754 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-12 04:49:21,878 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-12 04:49:39,014 - INFO - Avg. fwd time: 7.3808 / Avg. bwd time: 18.3146 / Avg. batch time: 536.7492 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-12-12 04:49:39,030 - INFO - Avg. fwd time: 9.4555 / Avg. bwd time: 23.1120 / Avg. batch time: 574.4035 (ms) / GPU bubble ratio: 54.64%
[rank3]:2025-12-12 04:49:39,000 - INFO - Avg. fwd time: 13.5246 / Avg. bwd time: 40.6605 / Avg. batch time: 505.8972 (ms) / GPU bubble ratio: 14.31%
[rank0]:2025-12-12 04:49:39,035 - INFO - Avg. fwd time: 7.4351 / Avg. bwd time: 22.0331 / Avg. batch time: 609.4005 (ms) / GPU bubble ratio: 61.32%
[rank3]:2025-12-12 04:49:56,159 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-12 04:49:56,341 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0449_max_batch_time.svg
[rank3]:			> Batch Time: 537.63 ms, GPU Bubble Ratio: 53.85%, 50.54%, 60.86%, 17.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  231-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  287-23-311ms   | [S0,MB7,F]  311-6-318ms    | [S0,MB4,B]  343-23-367ms   | [S0,MB5,B]  401-23-424ms   | [S0,MB6,B]  457-23-481ms   | [S0,MB7,B]  513-23-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  207-24-231ms   | [S1,MB5,F]  231-9-241ms    | [S1,MB3,B]  263-24-287ms   | [S1,MB6,F]  287-8-296ms    | [S1,MB4,B]  319-24-343ms   | [S1,MB7,F]  343-9-352ms    | [S1,MB5,B]  377-23-401ms   | [S1,MB6,B]  433-23-457ms   | [S1,MB7,B]  490-23-513ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  188-19-207ms   | [S2,MB4,F]  207-7-214ms    | [S2,MB3,B]  244-19-263ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  300-19-319ms   | [S2,MB6,F]  319-7-326ms    | [S2,MB5,B]  358-19-377ms   | [S2,MB7,F]  377-7-384ms    | [S2,MB6,B]  414-19-433ms   | [S2,MB7,B]  471-19-490ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-188ms   AFR(10):0.9655 | [S3,MB3,F]  188-13-202ms   | [S3,MB3,B]  202-42-244ms   AFR(10):0.9655 | [S3,MB4,F]  244-14-258ms   | [S3,MB4,B]  258-41-300ms   AFR(10):0.9655 | [S3,MB5,F]  300-14-315ms   | [S3,MB5,B]  315-43-358ms   AFR(10):0.9655 | [S3,MB6,F]  358-13-371ms   | [S3,MB6,B]  371-43-414ms   AFR(10):0.9655 | [S3,MB7,F]  414-14-428ms   | [S3,MB7,B]  428-42-471ms   AFR(10):0.9655
[rank3]:2025-12-12 04:49:56,465 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0449_min_batch_time.svg
[rank3]:			> Batch Time: 329.37 ms, GPU Bubble Ratio: 82.25%, 51.13%, 61.62%, 14.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-157ms    | [S0,MB3,B]  185-0-185ms    | [S0,MB7,F]  185-6-192ms    | [S0,MB4,B]  221-0-221ms    | [S0,MB5,B]  258-0-258ms    | [S0,MB6,B]  293-0-293ms    | [S0,MB7,B]  329-0-329ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-124ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-9-159ms    | [S1,MB3,B]  174-11-185ms   | [S1,MB6,F]  185-8-194ms    | [S1,MB4,B]  210-11-221ms   | [S1,MB7,F]  221-9-230ms    | [S1,MB5,B]  247-11-258ms   | [S1,MB6,B]  282-10-293ms   | [S1,MB7,B]  318-10-329ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  64-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-7-111ms    | [S2,MB2,B]  131-8-139ms    | [S2,MB4,F]  139-7-146ms    | [S2,MB3,B]  166-8-174ms    | [S2,MB5,F]  174-7-181ms    | [S2,MB4,B]  201-8-210ms    | [S2,MB6,F]  210-7-217ms    | [S2,MB5,B]  238-8-247ms    | [S2,MB7,F]  247-7-254ms    | [S2,MB6,B]  273-8-282ms    | [S2,MB7,B]  310-8-318ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-64ms     AFR(10):0.9655 | [S3,MB1,F]  64-10-75ms     | [S3,MB1,B]  75-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-109ms    | [S3,MB2,B]  109-21-131ms   AFR(10):0.9655 | [S3,MB3,F]  131-13-144ms   | [S3,MB3,B]  144-21-166ms   AFR(10):0.9655 | [S3,MB4,F]  166-14-180ms   | [S3,MB4,B]  180-21-201ms   AFR(10):0.9655 | [S3,MB5,F]  201-14-216ms   | [S3,MB5,B]  216-22-238ms   AFR(10):0.9655 | [S3,MB6,F]  238-13-252ms   | [S3,MB6,B]  252-21-273ms   AFR(10):0.9655 | [S3,MB7,F]  273-14-288ms   | [S3,MB7,B]  288-21-310ms   AFR(10):0.9655
[rank3]:2025-12-12 04:49:56,606 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0449_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 407.35 ms, GPU Bubble Ratio: 47.64%, 37.93%, 50.92%, 11.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  231-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  267-23-290ms   | [S0,MB7,F]  290-6-297ms    | [S0,MB4,B]  322-23-346ms   | [S0,MB5,B]  359-23-383ms   | [S0,MB6,B]  394-12-407ms   | [S0,MB7,B]  407-0-407ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  207-24-231ms   | [S1,MB5,F]  231-9-241ms    | [S1,MB3,B]  242-24-267ms   | [S1,MB6,F]  267-8-276ms    | [S1,MB4,B]  298-24-322ms   | [S1,MB7,F]  322-9-332ms    | [S1,MB5,B]  335-23-359ms   | [S1,MB6,B]  370-23-394ms   | [S1,MB7,B]  396-10-407ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  188-19-207ms   | [S2,MB4,F]  207-7-214ms    | [S2,MB3,B]  223-19-242ms   | [S2,MB5,F]  242-7-249ms    | [S2,MB4,B]  279-19-298ms   | [S2,MB6,F]  298-7-305ms    | [S2,MB5,B]  316-19-335ms   | [S2,MB7,F]  335-7-342ms    | [S2,MB6,B]  351-19-370ms   | [S2,MB7,B]  388-8-396ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-188ms   AFR(10):0.9655 | [S3,MB3,F]  188-13-202ms   | [S3,MB3,B]  202-21-223ms   AFR(10):0.9655 | [S3,MB4,F]  223-14-237ms   | [S3,MB4,B]  237-41-279ms   AFR(10):0.9655 | [S3,MB5,F]  279-14-294ms   | [S3,MB5,B]  294-22-316ms   AFR(10):0.9655 | [S3,MB6,F]  316-13-330ms   | [S3,MB6,B]  330-21-351ms   AFR(10):0.9655 | [S3,MB7,F]  351-14-366ms   | [S3,MB7,B]  366-21-388ms   AFR(10):0.9655
[rank3]:2025-12-12 04:49:56,607 - INFO - 	> Batch Time: 407.35 ms (Average Freeze Ratio: 0.23, Time Reduction Rate: 0.24)
[rank0]:2025-12-12 04:51:24,504 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:51:29,341 - INFO - Avg. fwd time: 13.6700 / Avg. bwd time: 38.5921 / Avg. batch time: 490.7650 (ms) / GPU bubble ratio: 14.81%
[rank3]:2025-12-12 04:51:29,347 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-12 04:51:29,366 - INFO - Avg. fwd time: 7.4822 / Avg. bwd time: 17.5968 / Avg. batch time: 521.3015 (ms) / GPU bubble ratio: 61.51%
[rank2]:2025-12-12 04:51:29,372 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-12 04:51:29,395 - INFO - Avg. fwd time: 9.5951 / Avg. bwd time: 22.0392 / Avg. batch time: 558.0881 (ms) / GPU bubble ratio: 54.65%
[rank1]:2025-12-12 04:51:29,401 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-12 04:51:29,419 - INFO - Avg. fwd time: 7.5682 / Avg. bwd time: 19.4328 / Avg. batch time: 591.0662 (ms) / GPU bubble ratio: 63.45%
[rank0]:2025-12-12 04:51:29,427 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.47, [MB7] 0.27(0.33)/1.00
[rank2]:2025-12-12 04:51:29,441 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1754  memory:  6.51GiB(13.70%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank2]:2025-12-12 04:51:29,513 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0451_stage2_step100.svg
[rank1]:2025-12-12 04:51:29,444 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1754  memory:  9.36GiB(19.71%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank1]:2025-12-12 04:51:29,513 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0451_stage1_step100.svg
[rank0]:2025-12-12 04:51:29,455 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1754  memory: 12.97GiB(27.31%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank0]:2025-12-12 04:51:29,513 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0451_stage0_step100.svg
[rank3]:2025-12-12 04:51:29,454 - INFO -  step: 100  loss:  8.6727  grad_norm:  8.1754  memory: 17.37GiB(36.56%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank3]:2025-12-12 04:51:29,603 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0451_real_step100_rank3.svg
[rank3]:			> Batch Time: 602.81 ms, GPU Bubble Ratio: 64.78%, 56.89%, 65.87%, 28.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  138-16-154ms   | [S0,MB4,F]  154-7-161ms    | [S0,MB1,B]  199-16-215ms   | [S0,MB5,F]  215-6-222ms    | [S0,MB2,B]  267-16-283ms   | [S0,MB6,F]  283-6-290ms    | [S0,MB3,B]  334-16-350ms   | [S0,MB7,F]  351-6-357ms    | [S0,MB4,B]  398-23-422ms   | [S0,MB5,B]  462-23-485ms   | [S0,MB6,B]  524-19-543ms   | [S0,MB7,B]  583-19-602ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  111-21-133ms   | [S1,MB3,F]  136-9-146ms    | [S1,MB1,B]  173-21-194ms   | [S1,MB4,F]  197-9-207ms    | [S1,MB2,B]  240-21-261ms   | [S1,MB5,F]  265-9-274ms    | [S1,MB3,B]  305-24-329ms   | [S1,MB6,F]  333-9-342ms    | [S1,MB4,B]  368-24-393ms   | [S1,MB7,F]  396-9-405ms    | [S1,MB5,B]  435-24-459ms   | [S1,MB6,B]  496-24-520ms   | [S1,MB7,B]  557-23-580ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  90-16-106ms    | [S2,MB2,F]  110-7-117ms    | [S2,MB1,B]  151-16-168ms   | [S2,MB3,F]  171-6-178ms    | [S2,MB2,B]  216-19-235ms   | [S2,MB4,F]  238-7-246ms    | [S2,MB3,B]  281-19-300ms   | [S2,MB5,F]  303-7-310ms    | [S2,MB4,B]  344-19-364ms   | [S2,MB6,F]  367-7-374ms    | [S2,MB5,B]  410-19-429ms   | [S2,MB7,F]  433-7-440ms    | [S2,MB6,B]  474-19-493ms   | [S2,MB7,B]  535-18-553ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  88-11-100ms    | [S3,MB1,B]  106-40-146ms   | [S3,MB2,F]  150-13-163ms   | [S3,MB2,B]  169-41-211ms   | [S3,MB3,F]  214-13-228ms   | [S3,MB3,B]  234-42-276ms   | [S3,MB4,F]  279-14-294ms   | [S3,MB4,B]  300-39-339ms   | [S3,MB5,F]  343-14-357ms   | [S3,MB5,B]  364-42-406ms   | [S3,MB6,F]  409-14-423ms   | [S3,MB6,B]  429-38-468ms   | [S3,MB7,F]  472-14-487ms   | [S3,MB7,B]  493-38-532ms  
[rank3]:2025-12-12 04:51:29,646 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0451_stage3_step100.svg
[rank2]:2025-12-12 04:53:28,276 - INFO - Avg. fwd time: 7.4650 / Avg. bwd time: 17.7036 / Avg. batch time: 518.2710 (ms) / GPU bubble ratio: 61.15%
[rank3]:2025-12-12 04:53:28,252 - INFO - Avg. fwd time: 13.7135 / Avg. bwd time: 38.1596 / Avg. batch time: 487.6791 (ms) / GPU bubble ratio: 14.91%
[rank1]:2025-12-12 04:53:28,304 - INFO - Avg. fwd time: 9.5876 / Avg. bwd time: 22.0938 / Avg. batch time: 555.1699 (ms) / GPU bubble ratio: 54.35%
[rank0]:2025-12-12 04:53:28,328 - INFO - Avg. fwd time: 7.5793 / Avg. bwd time: 19.5480 / Avg. batch time: 588.2189 (ms) / GPU bubble ratio: 63.11%
[rank0]:2025-12-12 04:55:22,119 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 04:55:26,865 - INFO - Avg. fwd time: 13.7574 / Avg. bwd time: 37.8982 / Avg. batch time: 485.9640 (ms) / GPU bubble ratio: 14.96%
[rank2]:2025-12-12 04:55:26,888 - INFO - Avg. fwd time: 7.4741 / Avg. bwd time: 17.6179 / Avg. batch time: 516.3409 (ms) / GPU bubble ratio: 61.12%
[rank2]:2025-12-12 04:55:26,894 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-12 04:55:26,915 - INFO - Avg. fwd time: 9.6061 / Avg. bwd time: 21.8961 / Avg. batch time: 553.1445 (ms) / GPU bubble ratio: 54.44%
[rank1]:2025-12-12 04:55:26,922 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-12 04:55:26,870 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 04:55:26,942 - INFO - Avg. fwd time: 7.6320 / Avg. bwd time: 19.3201 / Avg. batch time: 586.1001 (ms) / GPU bubble ratio: 63.21%
[rank0]:2025-12-12 04:55:26,950 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.27(0.32)/0.47, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-12 04:55:26,964 - INFO -  step: 150  loss: -8.0000  grad_norm:  8.5753  memory:  6.51GiB(13.70%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank1]:2025-12-12 04:55:26,967 - INFO -  step: 150  loss: -8.0000  grad_norm:  8.5753  memory:  9.36GiB(19.71%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank3]:2025-12-12 04:55:26,976 - INFO -  step: 150  loss:  3.8707  grad_norm:  8.5753  memory: 17.37GiB(36.56%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank0]:2025-12-12 04:55:26,978 - INFO -  step: 150  loss: -8.0000  grad_norm:  8.5753  memory: 13.29GiB(27.97%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank3]:2025-12-12 04:57:18,555 - INFO - Avg. fwd time: 13.8364 / Avg. bwd time: 37.0526 / Avg. batch time: 480.0054 (ms) / GPU bubble ratio: 15.19%
[rank1]:2025-12-12 04:57:18,605 - INFO - Avg. fwd time: 9.6429 / Avg. bwd time: 21.6572 / Avg. batch time: 547.0081 (ms) / GPU bubble ratio: 54.22%
[rank2]:2025-12-12 04:57:18,578 - INFO - Avg. fwd time: 7.4814 / Avg. bwd time: 17.5661 / Avg. batch time: 510.3077 (ms) / GPU bubble ratio: 60.73%
[rank0]:2025-12-12 04:57:18,628 - INFO - Avg. fwd time: 7.6775 / Avg. bwd time: 18.9173 / Avg. batch time: 579.6287 (ms) / GPU bubble ratio: 63.29%
[rank0]:2025-12-12 04:59:04,164 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:59:08,500 - INFO - Avg. fwd time: 13.8994 / Avg. bwd time: 36.2947 / Avg. batch time: 474.7318 (ms) / GPU bubble ratio: 15.41%
[rank3]:2025-12-12 04:59:08,504 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 04:59:08,550 - INFO - Avg. fwd time: 9.6830 / Avg. bwd time: 21.3759 / Avg. batch time: 541.4248 (ms) / GPU bubble ratio: 54.11%
[rank2]:2025-12-12 04:59:08,523 - INFO - Avg. fwd time: 7.5029 / Avg. bwd time: 17.4216 / Avg. batch time: 504.8522 (ms) / GPU bubble ratio: 60.50%
[rank2]:2025-12-12 04:59:08,529 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank3]:2025-12-12 04:59:08,607 - INFO -  step: 200  loss:  1.2752  grad_norm:  2.4158  memory: 17.37GiB(36.56%)  tps: 7,393  tflops: 57.79  mfu: 18.52%
[rank1]:2025-12-12 04:59:08,557 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 04:59:08,599 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.4158  memory:  9.36GiB(19.71%)  tps: 7,392  tflops: 57.79  mfu: 18.52%
[rank2]:2025-12-12 04:59:08,595 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.4158  memory:  6.51GiB(13.70%)  tps: 7,392  tflops: 57.79  mfu: 18.52%
[rank2]:2025-12-12 04:59:08,661 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0459_stage2_step200.svg
[rank0]:2025-12-12 04:59:08,574 - INFO - Avg. fwd time: 7.7290 / Avg. bwd time: 18.3088 / Avg. batch time: 573.7165 (ms) / GPU bubble ratio: 63.69%
[rank0]:2025-12-12 04:59:08,581 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.43(0.47)/0.47, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-12 04:59:08,610 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.4158  memory: 13.29GiB(27.97%)  tps: 7,392  tflops: 57.79  mfu: 18.52%
[rank0]:2025-12-12 04:59:08,660 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0459_stage0_step200.svg
[rank3]:2025-12-12 04:59:08,751 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0459_real_step200_rank3.svg
[rank3]:			> Batch Time: 527.62 ms, GPU Bubble Ratio: 67.41%, 55.26%, 63.68%, 32.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  106-4-111ms    | [S0,MB4,F]  111-8-120ms    | [S0,MB1,B]  170-4-175ms    | [S0,MB5,F]  175-6-182ms    | [S0,MB2,B]  243-4-248ms    | [S0,MB6,F]  248-6-255ms    | [S0,MB3,B]  316-4-320ms    | [S0,MB7,F]  320-6-327ms    | [S0,MB4,B]  365-23-389ms   | [S0,MB5,B]  421-23-445ms   | [S0,MB6,B]  471-22-493ms   | [S0,MB7,B]  510-17-527ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  89-12-101ms    | [S1,MB3,F]  105-10-115ms   | [S1,MB1,B]  152-12-165ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  225-12-238ms   | [S1,MB5,F]  241-8-250ms    | [S1,MB3,B]  284-24-309ms   | [S1,MB6,F]  314-9-323ms    | [S1,MB4,B]  335-24-360ms   | [S1,MB7,F]  363-9-372ms    | [S1,MB5,B]  392-24-417ms   | [S1,MB6,B]  442-24-467ms   | [S1,MB7,B]  485-21-506ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  75-8-83ms      | [S2,MB2,F]  87-8-96ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  151-6-158ms    | [S2,MB2,B]  201-19-220ms   | [S2,MB4,F]  224-7-231ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  283-7-290ms    | [S2,MB4,B]  311-19-330ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  368-19-387ms   | [S2,MB7,F]  391-7-398ms    | [S2,MB6,B]  420-19-439ms   | [S2,MB7,B]  466-16-482ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-21-70ms     | [S3,MB1,F]  73-13-87ms     | [S3,MB1,B]  93-40-133ms    | [S3,MB2,F]  137-11-148ms   | [S3,MB2,B]  154-41-196ms   | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  218-36-254ms   | [S3,MB4,F]  259-16-275ms   | [S3,MB4,B]  281-22-304ms   | [S3,MB5,F]  309-11-321ms   | [S3,MB5,B]  327-35-363ms   | [S3,MB6,F]  366-18-385ms   | [S3,MB6,B]  391-23-414ms   | [S3,MB7,F]  418-15-433ms   | [S3,MB7,B]  440-22-462ms  
[rank1]:2025-12-12 04:59:08,661 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0459_stage1_step200.svg
[rank3]:2025-12-12 04:59:08,797 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0459_stage3_step200.svg
[rank1]:2025-12-12 05:00:57,287 - INFO - Avg. fwd time: 9.7216 / Avg. bwd time: 21.0969 / Avg. batch time: 536.4093 (ms) / GPU bubble ratio: 54.04%
[rank3]:2025-12-12 05:00:57,236 - INFO - Avg. fwd time: 13.9508 / Avg. bwd time: 35.6195 / Avg. batch time: 469.9800 (ms) / GPU bubble ratio: 15.62%
[rank2]:2025-12-12 05:00:57,260 - INFO - Avg. fwd time: 7.5233 / Avg. bwd time: 17.2846 / Avg. batch time: 499.9748 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-12-12 05:00:57,310 - INFO - Avg. fwd time: 7.7733 / Avg. bwd time: 17.4437 / Avg. batch time: 568.3773 (ms) / GPU bubble ratio: 64.51%
[rank0]:2025-12-12 05:02:41,639 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-12 05:02:45,931 - INFO - Avg. fwd time: 9.7510 / Avg. bwd time: 20.8739 / Avg. batch time: 532.4013 (ms) / GPU bubble ratio: 53.98%
[rank1]:2025-12-12 05:02:45,938 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-12 05:02:45,880 - INFO - Avg. fwd time: 13.9955 / Avg. bwd time: 35.0824 / Avg. batch time: 466.2305 (ms) / GPU bubble ratio: 15.79%
[rank3]:2025-12-12 05:02:45,885 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 05:02:45,904 - INFO - Avg. fwd time: 7.5389 / Avg. bwd time: 17.1754 / Avg. batch time: 496.0694 (ms) / GPU bubble ratio: 60.14%
[rank2]:2025-12-12 05:02:45,910 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 05:02:45,955 - INFO - Avg. fwd time: 7.8070 / Avg. bwd time: 16.7318 / Avg. batch time: 564.1071 (ms) / GPU bubble ratio: 65.20%
[rank0]:2025-12-12 05:02:45,962 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.47)/0.47, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 05:02:45,990 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5830  memory: 13.29GiB(27.97%)  tps: 7,537  tflops: 58.92  mfu: 18.88%
[rank1]:2025-12-12 05:02:45,980 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5830  memory:  9.36GiB(19.71%)  tps: 7,537  tflops: 58.92  mfu: 18.88%
[rank3]:2025-12-12 05:02:45,988 - INFO -  step: 250  loss:  0.4201  grad_norm:  0.5830  memory: 17.37GiB(36.56%)  tps: 7,537  tflops: 58.92  mfu: 18.89%
[rank2]:2025-12-12 05:02:45,976 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5830  memory:  6.51GiB(13.70%)  tps: 7,537  tflops: 58.92  mfu: 18.88%
[rank3]:2025-12-12 05:04:34,392 - INFO - Avg. fwd time: 14.0288 / Avg. bwd time: 34.6404 / Avg. batch time: 463.1172 (ms) / GPU bubble ratio: 15.93%
[rank0]:2025-12-12 05:04:34,468 - INFO - Avg. fwd time: 7.8333 / Avg. bwd time: 16.1640 / Avg. batch time: 560.5533 (ms) / GPU bubble ratio: 65.75%
[rank1]:2025-12-12 05:04:34,444 - INFO - Avg. fwd time: 9.7744 / Avg. bwd time: 20.6893 / Avg. batch time: 529.0643 (ms) / GPU bubble ratio: 53.94%
[rank2]:2025-12-12 05:04:34,416 - INFO - Avg. fwd time: 7.5512 / Avg. bwd time: 17.0847 / Avg. batch time: 492.8257 (ms) / GPU bubble ratio: 60.01%
[rank0]:2025-12-12 05:06:18,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:06:22,922 - INFO - Avg. fwd time: 14.0572 / Avg. bwd time: 34.2715 / Avg. batch time: 460.5280 (ms) / GPU bubble ratio: 16.05%
[rank3]:2025-12-12 05:06:22,927 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.00(0.00)/0.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 05:06:22,947 - INFO - Avg. fwd time: 7.5613 / Avg. bwd time: 17.0093 / Avg. batch time: 490.1274 (ms) / GPU bubble ratio: 59.90%
[rank0]:2025-12-12 05:06:22,998 - INFO - Avg. fwd time: 7.8557 / Avg. bwd time: 15.6900 / Avg. batch time: 557.6000 (ms) / GPU bubble ratio: 66.22%
[rank0]:2025-12-12 05:06:23,005 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.47)/0.47, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 05:06:22,974 - INFO - Avg. fwd time: 9.7939 / Avg. bwd time: 20.5362 / Avg. batch time: 526.2903 (ms) / GPU bubble ratio: 53.90%
[rank1]:2025-12-12 05:06:22,980 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 05:06:23,023 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1793  memory:  9.36GiB(19.71%)  tps: 7,549  tflops: 59.01  mfu: 18.91%
[rank3]:2025-12-12 05:06:23,032 - INFO -  step: 300  loss:  0.2874  grad_norm:  0.1793  memory: 17.37GiB(36.56%)  tps: 7,549  tflops: 59.01  mfu: 18.91%
[rank2]:2025-12-12 05:06:22,952 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 05:06:23,019 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1793  memory:  6.51GiB(13.70%)  tps: 7,549  tflops: 59.01  mfu: 18.91%
[rank0]:2025-12-12 05:06:23,034 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1793  memory: 13.29GiB(27.97%)  tps: 7,549  tflops: 59.01  mfu: 18.91%
[rank0]:2025-12-12 05:06:23,081 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0506_stage0_step300.svg
[rank1]:2025-12-12 05:06:23,081 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0506_stage1_step300.svg
[rank2]:2025-12-12 05:06:23,082 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0506_stage2_step300.svg
[rank3]:2025-12-12 05:06:23,168 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0506_real_step300_rank3.svg
[rank3]:			> Batch Time: 525.81 ms, GPU Bubble Ratio: 71.91%, 56.08%, 63.68%, 32.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-247ms    | [S0,MB3,B]  315-0-315ms    | [S0,MB7,F]  315-6-322ms    | [S0,MB4,B]  365-23-389ms   | [S0,MB5,B]  422-23-445ms   | [S0,MB6,B]  470-18-488ms   | [S0,MB7,B]  509-16-525ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  239-8-247ms    | [S1,MB3,B]  283-24-308ms   | [S1,MB6,F]  313-8-322ms    | [S1,MB4,B]  335-24-359ms   | [S1,MB7,F]  363-9-372ms    | [S1,MB5,B]  393-24-417ms   | [S1,MB6,B]  442-24-466ms   | [S1,MB7,B]  484-20-505ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-6-230ms    | [S2,MB3,B]  259-19-279ms   | [S2,MB5,F]  282-7-289ms    | [S2,MB4,B]  311-19-330ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  369-19-388ms   | [S2,MB7,F]  391-7-398ms    | [S2,MB6,B]  420-19-439ms   | [S2,MB7,B]  465-16-481ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  154-41-195ms   | [S3,MB3,F]  198-13-212ms   | [S3,MB3,B]  218-36-254ms   | [S3,MB4,F]  258-17-275ms   | [S3,MB4,B]  281-22-304ms   | [S3,MB5,F]  309-11-321ms   | [S3,MB5,B]  328-35-363ms   | [S3,MB6,F]  367-18-385ms   | [S3,MB6,B]  391-22-413ms   | [S3,MB7,F]  418-15-433ms   | [S3,MB7,B]  439-21-461ms  
[rank3]:2025-12-12 05:06:23,211 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0506_stage3_step300.svg
[rank0]:2025-12-12 05:08:11,563 - INFO - Avg. fwd time: 7.8742 / Avg. bwd time: 15.2723 / Avg. batch time: 555.1090 (ms) / GPU bubble ratio: 66.64%
[rank3]:2025-12-12 05:08:11,485 - INFO - Avg. fwd time: 14.0803 / Avg. bwd time: 33.9583 / Avg. batch time: 458.3224 (ms) / GPU bubble ratio: 16.15%
[rank1]:2025-12-12 05:08:11,539 - INFO - Avg. fwd time: 9.8105 / Avg. bwd time: 20.4055 / Avg. batch time: 523.9565 (ms) / GPU bubble ratio: 53.86%
[rank2]:2025-12-12 05:08:11,510 - INFO - Avg. fwd time: 7.5698 / Avg. bwd time: 16.9456 / Avg. batch time: 487.8646 (ms) / GPU bubble ratio: 59.80%
[rank0]:2025-12-12 05:09:55,714 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 05:09:59,995 - INFO - Avg. fwd time: 14.1005 / Avg. bwd time: 33.6895 / Avg. batch time: 456.4276 (ms) / GPU bubble ratio: 16.24%
[rank2]:2025-12-12 05:10:00,020 - INFO - Avg. fwd time: 7.5777 / Avg. bwd time: 16.8903 / Avg. batch time: 485.8878 (ms) / GPU bubble ratio: 59.71%
[rank0]:2025-12-12 05:10:00,073 - INFO - Avg. fwd time: 7.8912 / Avg. bwd time: 14.9174 / Avg. batch time: 552.9432 (ms) / GPU bubble ratio: 67.00%
[rank0]:2025-12-12 05:10:00,109 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0953  memory: 13.29GiB(27.97%)  tps: 7,548  tflops: 59.00  mfu: 18.91%
[rank1]:2025-12-12 05:10:00,048 - INFO - Avg. fwd time: 9.8257 / Avg. bwd time: 20.2932 / Avg. batch time: 521.9194 (ms) / GPU bubble ratio: 53.83%
[rank1]:2025-12-12 05:10:00,098 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0953  memory:  9.36GiB(19.71%)  tps: 7,548  tflops: 59.00  mfu: 18.91%
[rank3]:2025-12-12 05:10:00,107 - INFO -  step: 350  loss:  0.2273  grad_norm:  0.0953  memory: 17.37GiB(36.56%)  tps: 7,548  tflops: 59.00  mfu: 18.91%
[rank2]:2025-12-12 05:10:00,094 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0953  memory:  6.51GiB(13.70%)  tps: 7,548  tflops: 59.00  mfu: 18.91%
[rank3]:2025-12-12 05:11:48,401 - INFO - Avg. fwd time: 14.1160 / Avg. bwd time: 33.4549 / Avg. batch time: 454.7549 (ms) / GPU bubble ratio: 16.31%
[rank1]:2025-12-12 05:11:48,454 - INFO - Avg. fwd time: 9.8390 / Avg. bwd time: 20.1959 / Avg. batch time: 520.1189 (ms) / GPU bubble ratio: 53.80%
[rank2]:2025-12-12 05:11:48,426 - INFO - Avg. fwd time: 7.5844 / Avg. bwd time: 16.8424 / Avg. batch time: 484.1414 (ms) / GPU bubble ratio: 59.64%
[rank0]:2025-12-12 05:11:48,480 - INFO - Avg. fwd time: 7.9055 / Avg. bwd time: 14.6220 / Avg. batch time: 551.0288 (ms) / GPU bubble ratio: 67.29%
[rank0]:2025-12-12 05:13:32,352 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:13:36,628 - INFO - Avg. fwd time: 14.1279 / Avg. bwd time: 33.2477 / Avg. batch time: 453.2645 (ms) / GPU bubble ratio: 16.38%
[rank2]:2025-12-12 05:13:36,654 - INFO - Avg. fwd time: 7.5901 / Avg. bwd time: 16.7996 / Avg. batch time: 482.5875 (ms) / GPU bubble ratio: 59.57%
[rank1]:2025-12-12 05:13:36,682 - INFO - Avg. fwd time: 9.8507 / Avg. bwd time: 20.1096 / Avg. batch time: 518.5163 (ms) / GPU bubble ratio: 53.78%
[rank0]:2025-12-12 05:13:36,708 - INFO - Avg. fwd time: 7.9180 / Avg. bwd time: 14.3506 / Avg. batch time: 549.3242 (ms) / GPU bubble ratio: 67.57%
[rank0]:2025-12-12 05:13:36,743 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0606  memory: 13.29GiB(27.97%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank3]:2025-12-12 05:13:36,742 - INFO -  step: 400  loss:  0.2128  grad_norm:  0.0606  memory: 17.37GiB(36.56%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank2]:2025-12-12 05:13:36,729 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0606  memory:  6.51GiB(13.70%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank2]:2025-12-12 05:13:36,796 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0513_stage2_step400.svg
[rank1]:2025-12-12 05:13:36,733 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0606  memory:  9.36GiB(19.71%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank1]:2025-12-12 05:13:36,796 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0513_stage1_step400.svg
[rank0]:2025-12-12 05:13:36,794 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0513_stage0_step400.svg
[rank3]:2025-12-12 05:13:36,877 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0513_real_step400_rank3.svg
[rank3]:			> Batch Time: 524.08 ms, GPU Bubble Ratio: 71.90%, 56.00%, 63.64%, 32.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-173ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-246ms    | [S0,MB3,B]  315-0-315ms    | [S0,MB7,F]  315-6-321ms    | [S0,MB4,B]  364-23-388ms   | [S0,MB5,B]  421-23-445ms   | [S0,MB6,B]  469-18-487ms   | [S0,MB7,B]  507-16-524ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  283-24-307ms   | [S1,MB6,F]  313-8-322ms    | [S1,MB4,B]  334-24-359ms   | [S1,MB7,F]  362-9-372ms    | [S1,MB5,B]  391-24-416ms   | [S1,MB6,B]  441-24-465ms   | [S1,MB7,B]  482-20-503ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  222-6-229ms    | [S2,MB3,B]  259-19-278ms   | [S2,MB5,F]  282-6-288ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  367-19-386ms   | [S2,MB7,F]  390-7-397ms    | [S2,MB6,B]  418-19-437ms   | [S2,MB7,B]  463-16-479ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  257-16-274ms   | [S3,MB4,B]  280-22-303ms   | [S3,MB5,F]  309-11-321ms   | [S3,MB5,B]  327-35-362ms   | [S3,MB6,F]  366-18-384ms   | [S3,MB6,B]  390-22-412ms   | [S3,MB7,F]  417-14-431ms   | [S3,MB7,B]  438-21-460ms  
[rank3]:2025-12-12 05:13:36,924 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0513_stage3_step400.svg
[rank3]:2025-12-12 05:14:01,414 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 05:14:01,633 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 05:14:01,656 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-12 05:14:01,676 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-12 05:15:24,885 - INFO - Avg. fwd time: 14.1383 / Avg. bwd time: 33.0627 / Avg. batch time: 451.9235 (ms) / GPU bubble ratio: 16.44%
[rank2]:2025-12-12 05:15:24,911 - INFO - Avg. fwd time: 7.5950 / Avg. bwd time: 16.7618 / Avg. batch time: 481.2188 (ms) / GPU bubble ratio: 59.51%
[rank1]:2025-12-12 05:15:24,940 - INFO - Avg. fwd time: 9.8606 / Avg. bwd time: 20.0332 / Avg. batch time: 517.1037 (ms) / GPU bubble ratio: 53.75%
[rank0]:2025-12-12 05:15:24,966 - INFO - Avg. fwd time: 7.9291 / Avg. bwd time: 14.1222 / Avg. batch time: 547.8238 (ms) / GPU bubble ratio: 67.80%
[rank0]:2025-12-12 05:17:08,679 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 05:17:12,940 - INFO - Avg. fwd time: 7.5991 / Avg. bwd time: 16.7275 / Avg. batch time: 479.9648 (ms) / GPU bubble ratio: 59.45%
[rank3]:2025-12-12 05:17:12,914 - INFO - Avg. fwd time: 14.1463 / Avg. bwd time: 32.8983 / Avg. batch time: 450.7208 (ms) / GPU bubble ratio: 16.50%
[rank1]:2025-12-12 05:17:12,969 - INFO - Avg. fwd time: 9.8692 / Avg. bwd time: 19.9650 / Avg. batch time: 515.8067 (ms) / GPU bubble ratio: 53.73%
[rank0]:2025-12-12 05:17:12,995 - INFO - Avg. fwd time: 7.9384 / Avg. bwd time: 13.9071 / Avg. batch time: 546.4461 (ms) / GPU bubble ratio: 68.02%
[rank2]:2025-12-12 05:17:13,016 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0785  memory:  6.51GiB(13.70%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank3]:2025-12-12 05:17:13,029 - INFO -  step: 450  loss:  0.2257  grad_norm:  0.0785  memory: 17.37GiB(36.56%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank1]:2025-12-12 05:17:13,020 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0785  memory:  9.36GiB(19.71%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank0]:2025-12-12 05:17:13,031 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0785  memory: 13.29GiB(27.97%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank2]:2025-12-12 05:19:00,967 - INFO - Avg. fwd time: 7.6028 / Avg. bwd time: 16.6964 / Avg. batch time: 478.8315 (ms) / GPU bubble ratio: 59.40%
[rank3]:2025-12-12 05:19:00,937 - INFO - Avg. fwd time: 14.1538 / Avg. bwd time: 32.7498 / Avg. batch time: 449.6347 (ms) / GPU bubble ratio: 16.55%
[rank1]:2025-12-12 05:19:00,997 - INFO - Avg. fwd time: 9.8773 / Avg. bwd time: 19.9039 / Avg. batch time: 514.6344 (ms) / GPU bubble ratio: 53.71%
[rank0]:2025-12-12 05:19:01,023 - INFO - Avg. fwd time: 7.9467 / Avg. bwd time: 13.7169 / Avg. batch time: 545.2012 (ms) / GPU bubble ratio: 68.21%
[rank0]:2025-12-12 05:20:44,823 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:20:49,054 - INFO - Avg. fwd time: 14.1611 / Avg. bwd time: 32.6173 / Avg. batch time: 448.6691 (ms) / GPU bubble ratio: 16.59%
[rank2]:2025-12-12 05:20:49,080 - INFO - Avg. fwd time: 7.6063 / Avg. bwd time: 16.6685 / Avg. batch time: 477.8245 (ms) / GPU bubble ratio: 59.36%
[rank1]:2025-12-12 05:20:49,111 - INFO - Avg. fwd time: 9.8849 / Avg. bwd time: 19.8491 / Avg. batch time: 513.5930 (ms) / GPU bubble ratio: 53.68%
[rank3]:2025-12-12 05:20:49,172 - INFO -  step: 500  loss:  0.2182  grad_norm:  0.0879  memory: 17.37GiB(36.56%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank0]:2025-12-12 05:20:49,137 - INFO - Avg. fwd time: 7.9545 / Avg. bwd time: 13.5550 / Avg. batch time: 544.0953 (ms) / GPU bubble ratio: 68.37%
[rank0]:2025-12-12 05:20:49,173 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0879  memory: 13.29GiB(27.97%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank2]:2025-12-12 05:20:49,159 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0879  memory:  6.51GiB(13.70%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank2]:2025-12-12 05:20:49,221 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0520_stage2_step500.svg
[rank1]:2025-12-12 05:20:49,162 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0879  memory:  9.36GiB(19.71%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank1]:2025-12-12 05:20:49,221 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0520_stage1_step500.svg
[rank0]:2025-12-12 05:20:49,221 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0520_stage0_step500.svg
[rank3]:2025-12-12 05:20:49,308 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0520_real_step500_rank3.svg
[rank3]:			> Batch Time: 523.25 ms, GPU Bubble Ratio: 71.70%, 55.84%, 63.54%, 32.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-246ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-321ms    | [S0,MB4,B]  364-23-387ms   | [S0,MB5,B]  421-23-445ms   | [S0,MB6,B]  468-18-487ms   | [S0,MB7,B]  506-16-523ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  238-8-246ms    | [S1,MB3,B]  283-24-307ms   | [S1,MB6,F]  313-9-322ms    | [S1,MB4,B]  334-24-358ms   | [S1,MB7,F]  362-9-371ms    | [S1,MB5,B]  392-24-416ms   | [S1,MB6,B]  440-24-465ms   | [S1,MB7,B]  482-20-502ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  259-19-278ms   | [S2,MB5,F]  282-7-289ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  368-19-387ms   | [S2,MB7,F]  390-7-397ms    | [S2,MB6,B]  418-19-437ms   | [S2,MB7,B]  462-16-478ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  218-36-254ms   | [S3,MB4,F]  257-16-274ms   | [S3,MB4,B]  280-22-303ms   | [S3,MB5,F]  309-11-321ms   | [S3,MB5,B]  327-35-362ms   | [S3,MB6,F]  366-17-384ms   | [S3,MB6,B]  389-22-412ms   | [S3,MB7,F]  416-14-431ms   | [S3,MB7,B]  437-21-459ms  
[rank3]:2025-12-12 05:20:49,350 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0520_stage3_step500.svg
[rank3]:2025-12-12 05:22:37,412 - INFO - Avg. fwd time: 14.1691 / Avg. bwd time: 32.4978 / Avg. batch time: 447.8129 (ms) / GPU bubble ratio: 16.63%
[rank2]:2025-12-12 05:22:37,439 - INFO - Avg. fwd time: 7.6095 / Avg. bwd time: 16.6429 / Avg. batch time: 476.9549 (ms) / GPU bubble ratio: 59.32%
[rank1]:2025-12-12 05:22:37,469 - INFO - Avg. fwd time: 9.8915 / Avg. bwd time: 19.7992 / Avg. batch time: 512.6919 (ms) / GPU bubble ratio: 53.67%
[rank0]:2025-12-12 05:22:37,496 - INFO - Avg. fwd time: 7.9617 / Avg. bwd time: 13.4179 / Avg. batch time: 543.1374 (ms) / GPU bubble ratio: 68.51%
[rank0]:2025-12-12 05:24:21,334 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 05:24:25,628 - INFO - Avg. fwd time: 7.6126 / Avg. bwd time: 16.6195 / Avg. batch time: 476.1339 (ms) / GPU bubble ratio: 59.29%
[rank3]:2025-12-12 05:24:25,600 - INFO - Avg. fwd time: 14.1755 / Avg. bwd time: 32.3893 / Avg. batch time: 447.0269 (ms) / GPU bubble ratio: 16.67%
[rank0]:2025-12-12 05:24:25,685 - INFO - Avg. fwd time: 7.9682 / Avg. bwd time: 13.2839 / Avg. batch time: 542.2356 (ms) / GPU bubble ratio: 68.65%
[rank0]:2025-12-12 05:24:25,721 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0701  memory: 13.29GiB(27.97%)  tps: 7,566  tflops: 59.15  mfu: 18.96%
[rank2]:2025-12-12 05:24:25,707 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0701  memory:  6.51GiB(13.70%)  tps: 7,566  tflops: 59.15  mfu: 18.96%
[rank1]:2025-12-12 05:24:25,658 - INFO - Avg. fwd time: 9.8978 / Avg. bwd time: 19.7540 / Avg. batch time: 511.8435 (ms) / GPU bubble ratio: 53.65%
[rank1]:2025-12-12 05:24:25,710 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0701  memory:  9.36GiB(19.71%)  tps: 7,566  tflops: 59.15  mfu: 18.96%
[rank3]:2025-12-12 05:24:25,719 - INFO -  step: 550  loss:  0.2257  grad_norm:  0.0701  memory: 17.37GiB(36.56%)  tps: 7,566  tflops: 59.15  mfu: 18.96%
[rank3]:2025-12-12 05:26:13,704 - INFO - Avg. fwd time: 14.1797 / Avg. bwd time: 32.2888 / Avg. batch time: 446.2842 (ms) / GPU bubble ratio: 16.70%
[rank2]:2025-12-12 05:26:13,732 - INFO - Avg. fwd time: 7.6153 / Avg. bwd time: 16.5980 / Avg. batch time: 475.3604 (ms) / GPU bubble ratio: 59.25%
[rank1]:2025-12-12 05:26:13,763 - INFO - Avg. fwd time: 9.9036 / Avg. bwd time: 19.7127 / Avg. batch time: 511.0466 (ms) / GPU bubble ratio: 53.64%
[rank0]:2025-12-12 05:26:13,790 - INFO - Avg. fwd time: 7.9739 / Avg. bwd time: 13.1617 / Avg. batch time: 541.3901 (ms) / GPU bubble ratio: 68.77%
[rank0]:2025-12-12 05:27:57,503 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:28:01,796 - INFO - Avg. fwd time: 14.1848 / Avg. bwd time: 32.1960 / Avg. batch time: 445.6080 (ms) / GPU bubble ratio: 16.73%
[rank0]:2025-12-12 05:28:01,882 - INFO - Avg. fwd time: 7.9794 / Avg. bwd time: 13.0504 / Avg. batch time: 540.6174 (ms) / GPU bubble ratio: 68.88%
[rank2]:2025-12-12 05:28:01,824 - INFO - Avg. fwd time: 7.6178 / Avg. bwd time: 16.5782 / Avg. batch time: 474.6528 (ms) / GPU bubble ratio: 59.22%
[rank2]:2025-12-12 05:28:01,904 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0924  memory:  6.51GiB(13.70%)  tps: 7,578  tflops: 59.24  mfu: 18.99%
[rank3]:2025-12-12 05:28:01,916 - INFO -  step: 600  loss:  0.2203  grad_norm:  0.0924  memory: 17.37GiB(36.56%)  tps: 7,578  tflops: 59.24  mfu: 18.99%
[rank1]:2025-12-12 05:28:01,855 - INFO - Avg. fwd time: 9.9089 / Avg. bwd time: 19.6749 / Avg. batch time: 510.3183 (ms) / GPU bubble ratio: 53.62%
[rank1]:2025-12-12 05:28:01,907 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0924  memory:  9.36GiB(19.71%)  tps: 7,578  tflops: 59.24  mfu: 18.99%
[rank0]:2025-12-12 05:28:01,918 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0924  memory: 13.29GiB(27.97%)  tps: 7,578  tflops: 59.24  mfu: 18.99%
[rank0]:2025-12-12 05:28:01,967 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0528_stage0_step600.svg
[rank2]:2025-12-12 05:28:01,969 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0528_stage2_step600.svg
[rank1]:2025-12-12 05:28:01,969 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0528_stage1_step600.svg
[rank3]:2025-12-12 05:28:02,053 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0528_real_step600_rank3.svg
[rank3]:			> Batch Time: 522.78 ms, GPU Bubble Ratio: 70.95%, 55.93%, 63.58%, 32.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-111ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-245ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-321ms    | [S0,MB4,B]  364-23-388ms   | [S0,MB5,B]  421-23-444ms   | [S0,MB6,B]  468-22-491ms   | [S0,MB7,B]  506-16-522ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-173ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  282-24-306ms   | [S1,MB6,F]  312-8-321ms    | [S1,MB4,B]  334-24-359ms   | [S1,MB7,F]  362-9-371ms    | [S1,MB5,B]  391-24-416ms   | [S1,MB6,B]  440-24-465ms   | [S1,MB7,B]  482-20-502ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  221-6-228ms    | [S2,MB3,B]  258-19-277ms   | [S2,MB5,F]  281-6-288ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  367-19-386ms   | [S2,MB7,F]  390-7-397ms    | [S2,MB6,B]  418-19-437ms   | [S2,MB7,B]  462-16-478ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-85ms     | [S3,MB1,B]  91-40-132ms    | [S3,MB2,F]  135-11-146ms   | [S3,MB2,B]  152-41-193ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  256-17-273ms   | [S3,MB4,B]  280-22-302ms   | [S3,MB5,F]  309-11-321ms   | [S3,MB5,B]  327-35-362ms   | [S3,MB6,F]  366-17-383ms   | [S3,MB6,B]  389-22-411ms   | [S3,MB7,F]  416-14-431ms   | [S3,MB7,B]  437-21-459ms  
[rank3]:2025-12-12 05:28:02,097 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0528_stage3_step600.svg
[rank2]:2025-12-12 05:29:50,108 - INFO - Avg. fwd time: 7.6200 / Avg. bwd time: 16.5602 / Avg. batch time: 474.0302 (ms) / GPU bubble ratio: 59.19%
[rank3]:2025-12-12 05:29:50,080 - INFO - Avg. fwd time: 14.1896 / Avg. bwd time: 32.1117 / Avg. batch time: 444.9931 (ms) / GPU bubble ratio: 16.76%
[rank1]:2025-12-12 05:29:50,140 - INFO - Avg. fwd time: 9.9138 / Avg. bwd time: 19.6404 / Avg. batch time: 509.6781 (ms) / GPU bubble ratio: 53.61%
[rank0]:2025-12-12 05:29:50,169 - INFO - Avg. fwd time: 7.9843 / Avg. bwd time: 12.9399 / Avg. batch time: 539.9359 (ms) / GPU bubble ratio: 69.00%
[rank0]:2025-12-12 05:31:34,145 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 05:31:38,378 - INFO - Avg. fwd time: 14.1950 / Avg. bwd time: 32.0344 / Avg. batch time: 444.4428 (ms) / GPU bubble ratio: 16.79%
[rank1]:2025-12-12 05:31:38,438 - INFO - Avg. fwd time: 9.9183 / Avg. bwd time: 19.6082 / Avg. batch time: 509.0882 (ms) / GPU bubble ratio: 53.60%
[rank2]:2025-12-12 05:31:38,407 - INFO - Avg. fwd time: 7.6222 / Avg. bwd time: 16.5437 / Avg. batch time: 473.4571 (ms) / GPU bubble ratio: 59.17%
[rank0]:2025-12-12 05:31:38,467 - INFO - Avg. fwd time: 7.9887 / Avg. bwd time: 12.8450 / Avg. batch time: 539.3076 (ms) / GPU bubble ratio: 69.10%
[rank3]:2025-12-12 05:31:38,501 - INFO -  step: 650  loss:  0.2316  grad_norm:  0.0710  memory: 17.37GiB(36.56%)  tps: 7,565  tflops: 59.14  mfu: 18.95%
[rank1]:2025-12-12 05:31:38,492 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0710  memory:  9.36GiB(19.71%)  tps: 7,565  tflops: 59.14  mfu: 18.95%
[rank2]:2025-12-12 05:31:38,488 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0710  memory:  6.51GiB(13.70%)  tps: 7,565  tflops: 59.14  mfu: 18.95%
[rank0]:2025-12-12 05:31:38,502 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0710  memory: 13.29GiB(27.97%)  tps: 7,565  tflops: 59.14  mfu: 18.95%
[rank1]:2025-12-12 05:33:26,600 - INFO - Avg. fwd time: 9.9220 / Avg. bwd time: 19.5782 / Avg. batch time: 508.5281 (ms) / GPU bubble ratio: 53.59%
[rank2]:2025-12-12 05:33:26,568 - INFO - Avg. fwd time: 7.6241 / Avg. bwd time: 16.5280 / Avg. batch time: 472.9125 (ms) / GPU bubble ratio: 59.14%
[rank0]:2025-12-12 05:33:26,629 - INFO - Avg. fwd time: 7.9928 / Avg. bwd time: 12.7500 / Avg. batch time: 538.7124 (ms) / GPU bubble ratio: 69.20%
[rank3]:2025-12-12 05:33:26,539 - INFO - Avg. fwd time: 14.1993 / Avg. bwd time: 31.9619 / Avg. batch time: 443.9215 (ms) / GPU bubble ratio: 16.81%
[rank0]:2025-12-12 05:35:10,420 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:35:14,638 - INFO - Avg. fwd time: 14.2024 / Avg. bwd time: 31.8949 / Avg. batch time: 443.4281 (ms) / GPU bubble ratio: 16.83%
[rank1]:2025-12-12 05:35:14,699 - INFO - Avg. fwd time: 9.9254 / Avg. bwd time: 19.5502 / Avg. batch time: 507.9985 (ms) / GPU bubble ratio: 53.58%
[rank2]:2025-12-12 05:35:14,667 - INFO - Avg. fwd time: 7.6257 / Avg. bwd time: 16.5134 / Avg. batch time: 472.3974 (ms) / GPU bubble ratio: 59.12%
[rank2]:2025-12-12 05:35:14,749 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0721  memory:  6.51GiB(13.70%)  tps: 7,576  tflops: 59.23  mfu: 18.98%
[rank3]:2025-12-12 05:35:14,762 - INFO -  step: 700  loss:  0.1910  grad_norm:  0.0721  memory: 17.37GiB(36.56%)  tps: 7,576  tflops: 59.23  mfu: 18.98%
[rank0]:2025-12-12 05:35:14,728 - INFO - Avg. fwd time: 7.9966 / Avg. bwd time: 12.6681 / Avg. batch time: 538.1499 (ms) / GPU bubble ratio: 69.28%
[rank0]:2025-12-12 05:35:14,764 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0721  memory: 13.29GiB(27.97%)  tps: 7,576  tflops: 59.23  mfu: 18.98%
[rank1]:2025-12-12 05:35:14,753 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0721  memory:  9.36GiB(19.71%)  tps: 7,576  tflops: 59.23  mfu: 18.98%
[rank1]:2025-12-12 05:35:14,815 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0535_stage1_step700.svg
[rank2]:2025-12-12 05:35:14,815 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0535_stage2_step700.svg
[rank0]:2025-12-12 05:35:14,813 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0535_stage0_step700.svg
[rank3]:2025-12-12 05:35:14,897 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0535_real_step700_rank3.svg
[rank3]:			> Batch Time: 523.05 ms, GPU Bubble Ratio: 71.05%, 55.86%, 63.54%, 32.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-321ms    | [S0,MB4,B]  364-23-388ms   | [S0,MB5,B]  420-23-444ms   | [S0,MB6,B]  468-22-490ms   | [S0,MB7,B]  506-16-523ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  282-24-306ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  334-24-359ms   | [S1,MB7,F]  362-9-372ms    | [S1,MB5,B]  391-24-416ms   | [S1,MB6,B]  440-24-465ms   | [S1,MB7,B]  482-20-502ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  258-19-277ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  367-19-386ms   | [S2,MB7,F]  390-7-397ms    | [S2,MB6,B]  417-19-437ms   | [S2,MB7,B]  462-16-478ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  217-35-252ms   | [S3,MB4,F]  256-17-274ms   | [S3,MB4,B]  280-22-303ms   | [S3,MB5,F]  309-11-321ms   | [S3,MB5,B]  326-35-362ms   | [S3,MB6,F]  366-17-383ms   | [S3,MB6,B]  389-22-411ms   | [S3,MB7,F]  416-15-431ms   | [S3,MB7,B]  437-21-459ms  
[rank3]:2025-12-12 05:35:14,941 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0535_stage3_step700.svg
[rank2]:2025-12-12 05:37:02,879 - INFO - Avg. fwd time: 7.6272 / Avg. bwd time: 16.4997 / Avg. batch time: 471.9305 (ms) / GPU bubble ratio: 59.10%
[rank3]:2025-12-12 05:37:02,850 - INFO - Avg. fwd time: 14.2050 / Avg. bwd time: 31.8317 / Avg. batch time: 442.9643 (ms) / GPU bubble ratio: 16.86%
[rank1]:2025-12-12 05:37:02,912 - INFO - Avg. fwd time: 9.9285 / Avg. bwd time: 19.5239 / Avg. batch time: 507.5182 (ms) / GPU bubble ratio: 53.57%
[rank0]:2025-12-12 05:37:02,942 - INFO - Avg. fwd time: 8.0000 / Avg. bwd time: 12.5961 / Avg. batch time: 537.6389 (ms) / GPU bubble ratio: 69.35%
[rank0]:2025-12-12 05:38:46,774 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 05:38:51,047 - INFO - Avg. fwd time: 14.2085 / Avg. bwd time: 31.7736 / Avg. batch time: 442.5475 (ms) / GPU bubble ratio: 16.88%
[rank1]:2025-12-12 05:38:51,110 - INFO - Avg. fwd time: 9.9315 / Avg. bwd time: 19.4995 / Avg. batch time: 507.0699 (ms) / GPU bubble ratio: 53.57%
[rank2]:2025-12-12 05:38:51,077 - INFO - Avg. fwd time: 7.6287 / Avg. bwd time: 16.4869 / Avg. batch time: 471.4940 (ms) / GPU bubble ratio: 59.08%
[rank0]:2025-12-12 05:38:51,139 - INFO - Avg. fwd time: 8.0033 / Avg. bwd time: 12.5272 / Avg. batch time: 537.1615 (ms) / GPU bubble ratio: 69.42%
[rank0]:2025-12-12 05:38:51,175 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0852  memory: 13.29GiB(27.97%)  tps: 7,571  tflops: 59.18  mfu: 18.97%
[rank1]:2025-12-12 05:38:51,164 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0852  memory:  9.36GiB(19.71%)  tps: 7,571  tflops: 59.18  mfu: 18.97%
[rank3]:2025-12-12 05:38:51,173 - INFO -  step: 750  loss:  0.2304  grad_norm:  0.0852  memory: 17.37GiB(36.56%)  tps: 7,571  tflops: 59.19  mfu: 18.97%
[rank2]:2025-12-12 05:38:51,161 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0852  memory:  6.51GiB(13.70%)  tps: 7,571  tflops: 59.18  mfu: 18.97%
[rank3]:2025-12-12 05:40:39,096 - INFO - Avg. fwd time: 14.2099 / Avg. bwd time: 31.7191 / Avg. batch time: 442.1360 (ms) / GPU bubble ratio: 16.90%
[rank2]:2025-12-12 05:40:39,126 - INFO - Avg. fwd time: 7.6301 / Avg. bwd time: 16.4749 / Avg. batch time: 471.0655 (ms) / GPU bubble ratio: 59.06%
[rank0]:2025-12-12 05:40:39,189 - INFO - Avg. fwd time: 8.0063 / Avg. bwd time: 12.4542 / Avg. batch time: 536.6958 (ms) / GPU bubble ratio: 69.50%
[rank1]:2025-12-12 05:40:39,159 - INFO - Avg. fwd time: 9.9342 / Avg. bwd time: 19.4766 / Avg. batch time: 506.6315 (ms) / GPU bubble ratio: 53.56%
[rank0]:2025-12-12 05:42:22,884 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:42:27,187 - INFO - Avg. fwd time: 14.2123 / Avg. bwd time: 31.6678 / Avg. batch time: 441.7622 (ms) / GPU bubble ratio: 16.91%
[rank1]:2025-12-12 05:42:27,250 - INFO - Avg. fwd time: 9.9366 / Avg. bwd time: 19.4548 / Avg. batch time: 506.2298 (ms) / GPU bubble ratio: 53.55%
[rank2]:2025-12-12 05:42:27,217 - INFO - Avg. fwd time: 7.6316 / Avg. bwd time: 16.4636 / Avg. batch time: 470.6741 (ms) / GPU bubble ratio: 59.05%
[rank2]:2025-12-12 05:42:27,302 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0741  memory:  6.51GiB(13.70%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank2]:2025-12-12 05:42:27,302 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0741  tps: 7,848  tflops: 61.35  mfu: 17.94%
[rank2]:2025-12-12 05:42:27,302 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-12 05:42:27,303 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-12 05:42:27,315 - INFO -  step: 800  loss:  0.2345  grad_norm:  0.0741  memory: 17.37GiB(36.56%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank3]:2025-12-12 05:42:27,315 - INFO -  final step: 800  loss:  0.2345  grad_norm:  0.0741  tps: 7,854  tflops: 61.40  mfu: 18.08%
[rank3]:2025-12-12 05:42:27,316 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-12 05:42:27,316 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 05:42:27,281 - INFO - Avg. fwd time: 8.0092 / Avg. bwd time: 12.3932 / Avg. batch time: 536.2688 (ms) / GPU bubble ratio: 69.56%
[rank0]:2025-12-12 05:42:27,316 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0741  memory: 13.29GiB(27.97%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank0]:2025-12-12 05:42:27,317 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0741  tps: 7,848  tflops: 61.35  mfu: 17.94%
[rank0]:2025-12-12 05:42:27,317 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-12 05:42:27,317 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-12 05:42:27,306 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0741  memory:  9.36GiB(19.71%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank1]:2025-12-12 05:42:27,306 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0741  tps: 7,848  tflops: 61.35  mfu: 17.95%
[rank1]:2025-12-12 05:42:27,306 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-12 05:42:27,307 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 05:42:29,271 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-12 05:42:29,340 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank0/251212_0542_stage0_final800.svg
[rank1]:2025-12-12 05:42:29,340 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank1/251212_0542_stage1_final800.svg
[rank2]:2025-12-12 05:42:29,340 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank2/251212_0542_stage2_final800.svg
[rank3]:2025-12-12 05:42:29,422 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0542_real_final800_rank3.svg
[rank3]:			> Batch Time: 525.59 ms, GPU Bubble Ratio: 71.80%, 56.10%, 63.70%, 32.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-247ms    | [S0,MB3,B]  316-0-316ms    | [S0,MB7,F]  316-6-322ms    | [S0,MB4,B]  365-23-389ms   | [S0,MB5,B]  422-23-446ms   | [S0,MB6,B]  470-18-489ms   | [S0,MB7,B]  508-16-525ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  239-8-247ms    | [S1,MB3,B]  284-24-308ms   | [S1,MB6,F]  314-9-323ms    | [S1,MB4,B]  336-24-360ms   | [S1,MB7,F]  364-9-373ms    | [S1,MB5,B]  393-24-417ms   | [S1,MB6,B]  442-24-467ms   | [S1,MB7,B]  484-20-505ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-7-230ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  282-7-289ms    | [S2,MB4,B]  311-19-331ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  369-19-388ms   | [S2,MB7,F]  391-7-398ms    | [S2,MB6,B]  420-19-439ms   | [S2,MB7,B]  465-16-481ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-148ms   | [S3,MB2,B]  154-41-195ms   | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  218-36-255ms   | [S3,MB4,F]  258-16-275ms   | [S3,MB4,B]  281-22-304ms   | [S3,MB5,F]  310-12-322ms   | [S3,MB5,B]  328-35-364ms   | [S3,MB6,F]  367-17-385ms   | [S3,MB6,B]  391-22-413ms   | [S3,MB7,F]  418-14-433ms   | [S3,MB7,B]  439-21-461ms  
[rank1]:2025-12-12 05:42:29,489 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_params_histogram/251212_0542_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank2]:2025-12-12 05:42:29,494 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_params_histogram/251212_0542_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank0]:2025-12-12 05:42:29,492 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_params_histogram/251212_0542_rank0_stage0.svg
[rank0]:	> Counts Sum: 316000, Total Sum: 1728640 (18.28%), Ratio(%) per element: [21.57, 22.6, 20.37, 22.08, 21.74, 19.34, 20.03, 20.71, 20.2, 21.4, 20.71, 19.86, 19.52, 20.54, 19.86, 19.34, 18.49, 19.34, 18.66, 18.32, 18.66, 17.12, 17.12, 17.46, 16.95, 17.46, 16.6, 16.6, 15.23, 16.43, 14.72, 15.23, 14.72, 15.41, 13.52, 15.06, 13.18]
[rank3]:2025-12-12 05:42:29,551 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/pipeline_schedule/251212_0542_thry_final800_rank3.svg
[rank3]:			> Batch Time: 329.63 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  99-19-119ms    | [S0,MB4,F]  119-9-129ms    | [S0,MB1,B]  129-19-149ms   | [S0,MB5,F]  149-9-159ms    | [S0,MB2,B]  159-19-179ms   | [S0,MB6,F]  179-9-189ms    | [S0,MB3,B]  189-19-209ms   | [S0,MB7,F]  209-9-219ms    | [S0,MB4,B]  219-19-239ms   | [S0,MB5,B]  249-19-269ms   | [S0,MB6,B]  279-19-299ms   | [S0,MB7,B]  309-19-329ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB0,B]  79-19-99ms     | [S1,MB3,F]  99-9-109ms     | [S1,MB1,B]  109-19-129ms   | [S1,MB4,F]  129-9-139ms    | [S1,MB2,B]  139-19-159ms   | [S1,MB5,F]  159-9-169ms    | [S1,MB3,B]  169-19-189ms   | [S1,MB6,F]  189-9-199ms    | [S1,MB4,B]  199-19-219ms   | [S1,MB7,F]  219-9-229ms    | [S1,MB5,B]  229-19-249ms   | [S1,MB6,B]  259-19-279ms   | [S1,MB7,B]  289-19-309ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB0,B]  59-19-79ms     | [S2,MB2,F]  79-9-89ms      | [S2,MB1,B]  89-19-109ms    | [S2,MB3,F]  109-9-119ms    | [S2,MB2,B]  119-19-139ms   | [S2,MB4,F]  139-9-149ms    | [S2,MB3,B]  149-19-169ms   | [S2,MB5,F]  169-9-179ms    | [S2,MB4,B]  179-19-199ms   | [S2,MB6,F]  199-9-209ms    | [S2,MB5,B]  209-19-229ms   | [S2,MB7,F]  229-9-239ms    | [S2,MB6,B]  239-19-259ms   | [S2,MB7,B]  269-19-289ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB0,B]  39-19-59ms     | [S3,MB1,F]  59-9-69ms      | [S3,MB1,B]  69-19-89ms     | [S3,MB2,F]  89-9-99ms      | [S3,MB2,B]  99-19-119ms    | [S3,MB3,F]  119-9-129ms    | [S3,MB3,B]  129-19-149ms   | [S3,MB4,F]  149-9-159ms    | [S3,MB4,B]  159-19-179ms   | [S3,MB5,F]  179-9-189ms    | [S3,MB5,B]  189-19-209ms   | [S3,MB6,F]  209-9-219ms    | [S3,MB6,B]  219-19-239ms   | [S3,MB7,F]  239-9-249ms    | [S3,MB7,B]  249-19-269ms  
[rank3]:2025-12-12 05:42:29,598 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_ratio_history/rank3/251212_0542_stage3_final800.svg
[rank3]:2025-12-12 05:42:29,729 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/frozen_params_histogram/251212_0542_rank3_stage3.svg
[rank3]:	> Counts Sum: 645120, Total Sum: 1354880 (47.61%), Ratio(%) per element: [48.28, 47.43, 46.74, 47.77, 46.74, 47.94, 48.45, 47.77, 47.94, 47.26, 47.77, 46.74, 48.11, 46.74, 47.77, 47.77, 47.77, 47.6, 47.08, 48.11, 48.8, 47.6, 47.43, 47.94, 47.77, 46.57, 47.26, 47.6, 47.94]
[rank0]:2025-12-12 05:42:31,330 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/afr_time_plot/251212_0542_stage0.svg
[rank0]:2025-12-12 05:42:31,333 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-12 05:42:31,346 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/afr_time_plot/251212_0542_stage1.svg
[rank1]:2025-12-12 05:42:31,349 - INFO - Destroying the purge thread.
[rank2]:2025-12-12 05:42:31,346 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/afr_time_plot/251212_0542_stage2.svg
[rank2]:2025-12-12 05:42:31,349 - INFO - Destroying the purge thread.
[rank3]:2025-12-12 05:42:31,592 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1/afr_time_plot/251212_0542_stage3.svg
[rank3]:2025-12-12 05:42:31,596 - INFO - Destroying the purge thread.
[rank1]:2025-12-12 05:42:31,651 - INFO - Process group destroyed
[rank2]:2025-12-12 05:42:31,651 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.17238
[rank3]:wandb:               final/avg_loss 0.23448
[rank3]:wandb:             final/avg_mfu(%) 18.08376
[rank3]:wandb:             final/avg_tflops 61.39543
[rank3]:wandb:    final/avg_throughput(tps) 7853.54873
[rank3]:wandb:              final/grad_norm 0.07411
[rank3]:wandb:               final/max_loss 0.23448
[rank3]:wandb:                    grad_norm 0.07411
[rank3]:wandb: loss_metrics/global_avg_loss 0.23448
[rank3]:wandb: loss_metrics/global_max_loss 0.23448
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1212_1F1B_fullrand7_mfr0.5_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/0kx3kmlf
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.5_42_dm1/20251212-0443/wandb/run-20251212_044319-0kx3kmlf/logs
[rank0]:2025-12-12 05:42:33,333 - INFO - Training completed
[rank0]:2025-12-12 05:42:33,334 - INFO - Destroying the purge thread.
[rank3]:2025-12-12 05:42:33,625 - INFO - Process group destroyed
[rank0]:2025-12-12 05:42:33,633 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.1', 'layers.2', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.6', 'layers.8', 'layers.5'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'output', 'layers.14', 'layers.13', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1212_1F1B_fullrand7_mfr0.5_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.5
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
