
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 12. (ê¸ˆ) 22:14:39 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1212_1F1B_fullrand7_mfr0.7_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.7) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-12 22:14:47,552 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:"
[rank1]:2025-12-12 22:14:47,560 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:"
[rank3]:2025-12-12 22:14:47,559 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank2]:2025-12-12 22:14:47,558 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank0]:2025-12-12 22:14:47,958 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-12 22:14:47,961 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 22:14:47,965 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-12 22:14:47,966 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-12-12 22:14:47,953 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 22:14:47,955 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-12 22:14:47,946 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 22:14:47,949 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-12 22:14:47,947 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-12 22:14:47,949 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 22:14:48,375 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-12 22:14:51,268 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-12 22:14:51,426 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 22:14:51,427 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-12 22:14:51,428 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-12 22:14:51,487 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 22:14:51,513 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-12 22:14:51,514 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 22:14:51,489 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 22:14:51,490 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-12 22:14:51,517 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-12 22:14:51,517 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-12 22:14:51,485 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 22:14:51,512 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-12 22:14:51,513 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 22:14:51,747 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 22:14:51,747 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-12 22:14:51,747 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-12 22:14:51,745 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 22:14:51,745 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 22:14:51,745 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-12 22:14:51,740 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 22:14:51,740 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-12 22:14:51,740 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run jije6bvg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.7_42_dm1/20251212-2214/wandb/run-20251212_221453-jije6bvg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/jije6bvg
[rank3]:2025-12-12 22:14:54,451 - INFO - WandB logging enabled
[rank3]:2025-12-12 22:14:54,452 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-12 22:14:54,490 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 22:14:54,517 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-12 22:14:54,518 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-12 22:14:54,738 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 22:14:54,739 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank0]:2025-12-12 22:14:54,739 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 22:14:54,739 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-12 22:14:54,739 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-12 22:14:54,738 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-12 22:14:54,721 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 22:14:54,722 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-12 22:14:54,723 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-12 22:14:54,738 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 22:14:56,850 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-12 22:14:56,850 - INFO - Finished loading the checkpoint in 2.11 seconds.
[rank0]:2025-12-12 22:14:56,850 - INFO - Training starts at step 1
[rank2]:2025-12-12 22:15:02,406 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  4.63GiB(9.75%)  tps: 3,001  tflops: 23.46  mfu: 7.52%
[rank2]:2025-12-12 22:15:02,406 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 22:15:02,408 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  6.76GiB(14.24%)  tps: 3,001  tflops: 23.46  mfu: 7.52%
[rank0]:2025-12-12 22:15:02,437 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  9.19GiB(19.34%)  tps: 2,993  tflops: 23.40  mfu: 7.50%
[rank1]:2025-12-12 22:15:02,414 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-12 22:15:02,437 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 22:15:02,417 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5369  memory: 12.97GiB(27.31%)  tps: 4,136  tflops: 32.33  mfu: 10.36%
[rank3]:2025-12-12 22:15:02,418 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 22:17:02,821 - INFO - Avg. fwd time: 12.8506 / Avg. bwd time: 41.0653 / Avg. batch time: 503.7994 (ms) / GPU bubble ratio: 14.39%
[rank0]:2025-12-12 22:17:02,902 - INFO - Avg. fwd time: 7.3091 / Avg. bwd time: 23.4896 / Avg. batch time: 611.5227 (ms) / GPU bubble ratio: 59.71%
[rank1]:2025-12-12 22:17:02,874 - INFO - Avg. fwd time: 9.2701 / Avg. bwd time: 23.7840 / Avg. batch time: 574.5478 (ms) / GPU bubble ratio: 53.98%
[rank2]:2025-12-12 22:17:02,845 - INFO - Avg. fwd time: 7.2484 / Avg. bwd time: 18.8866 / Avg. batch time: 535.7245 (ms) / GPU bubble ratio: 60.97%
[rank0]:2025-12-12 22:19:05,516 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 22:19:10,510 - INFO - Avg. fwd time: 13.1368 / Avg. bwd time: 41.5137 / Avg. batch time: 509.5837 (ms) / GPU bubble ratio: 14.20%
[rank2]:2025-12-12 22:19:10,535 - INFO - Avg. fwd time: 7.2564 / Avg. bwd time: 18.9531 / Avg. batch time: 541.1961 (ms) / GPU bubble ratio: 61.26%
[rank1]:2025-12-12 22:19:10,563 - INFO - Avg. fwd time: 9.3378 / Avg. bwd time: 23.9060 / Avg. batch time: 579.7955 (ms) / GPU bubble ratio: 54.13%
[rank3]:2025-12-12 22:19:10,625 - INFO -  step: 50  loss:  9.9216  grad_norm: 12.8177  memory: 16.39GiB(34.50%)  tps: 6,469  tflops: 50.57  mfu: 16.21%
[rank2]:2025-12-12 22:19:10,613 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8177  memory:  6.43GiB(13.53%)  tps: 6,469  tflops: 50.57  mfu: 16.21%
[rank1]:2025-12-12 22:19:10,617 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8177  memory:  9.03GiB(19.01%)  tps: 6,469  tflops: 50.57  mfu: 16.21%
[rank0]:2025-12-12 22:19:10,592 - INFO - Avg. fwd time: 7.3205 / Avg. bwd time: 23.5508 / Avg. batch time: 616.4575 (ms) / GPU bubble ratio: 59.94%
[rank0]:2025-12-12 22:19:10,627 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8177  memory: 12.97GiB(27.31%)  tps: 6,469  tflops: 50.57  mfu: 16.21%
[rank3]:2025-12-12 22:20:01,803 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-12 22:20:53,120 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-12 22:20:53,261 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-12 22:21:10,399 - INFO - Avg. fwd time: 7.3585 / Avg. bwd time: 18.2937 / Avg. batch time: 532.6696 (ms) / GPU bubble ratio: 61.47%
[rank0]:2025-12-12 22:21:10,419 - INFO - Avg. fwd time: 7.4103 / Avg. bwd time: 22.0191 / Avg. batch time: 605.3044 (ms) / GPU bubble ratio: 61.10%
[rank3]:2025-12-12 22:21:10,385 - INFO - Avg. fwd time: 13.3276 / Avg. bwd time: 40.3615 / Avg. batch time: 501.8587 (ms) / GPU bubble ratio: 14.42%
[rank1]:2025-12-12 22:21:10,414 - INFO - Avg. fwd time: 9.4735 / Avg. bwd time: 23.0922 / Avg. batch time: 570.3371 (ms) / GPU bubble ratio: 54.32%
[rank3]:2025-12-12 22:21:27,538 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-12 22:21:27,765 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2221_max_batch_time.svg
[rank3]:			> Batch Time: 537.79 ms, GPU Bubble Ratio: 53.87%, 50.31%, 60.89%, 17.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-30ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-207ms    | [S0,MB2,B]  231-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  287-23-311ms   | [S0,MB7,F]  311-6-318ms    | [S0,MB4,B]  344-23-368ms   | [S0,MB5,B]  401-23-425ms   | [S0,MB6,B]  457-23-481ms   | [S0,MB7,B]  514-23-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  207-24-231ms   | [S1,MB5,F]  231-9-241ms    | [S1,MB3,B]  263-24-287ms   | [S1,MB6,F]  287-9-297ms    | [S1,MB4,B]  320-24-344ms   | [S1,MB7,F]  344-9-353ms    | [S1,MB5,B]  377-24-401ms   | [S1,MB6,B]  433-24-457ms   | [S1,MB7,B]  490-23-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  188-19-207ms   | [S2,MB4,F]  207-6-214ms    | [S2,MB3,B]  244-19-263ms   | [S2,MB5,F]  263-6-270ms    | [S2,MB4,B]  301-19-320ms   | [S2,MB6,F]  320-6-327ms    | [S2,MB5,B]  358-19-377ms   | [S2,MB7,F]  377-6-384ms    | [S2,MB6,B]  414-19-433ms   | [S2,MB7,B]  471-19-490ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-188ms   AFR(10):0.9655 | [S3,MB3,F]  188-13-202ms   | [S3,MB3,B]  202-42-244ms   AFR(10):0.9655 | [S3,MB4,F]  244-14-258ms   | [S3,MB4,B]  258-42-301ms   AFR(10):0.9655 | [S3,MB5,F]  301-14-315ms   | [S3,MB5,B]  315-43-358ms   AFR(10):0.9655 | [S3,MB6,F]  358-13-371ms   | [S3,MB6,B]  371-42-414ms   AFR(10):0.9655 | [S3,MB7,F]  414-14-428ms   | [S3,MB7,B]  428-42-471ms   AFR(10):0.9655
[rank3]:2025-12-12 22:21:27,892 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2221_min_batch_time.svg
[rank3]:			> Batch Time: 328.99 ms, GPU Bubble Ratio: 82.26%, 50.82%, 61.63%, 14.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-30ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-157ms    | [S0,MB3,B]  185-0-185ms    | [S0,MB7,F]  185-6-192ms    | [S0,MB4,B]  221-0-221ms    | [S0,MB5,B]  257-0-257ms    | [S0,MB6,B]  292-0-292ms    | [S0,MB7,B]  328-0-328ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-125ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-9-159ms    | [S1,MB3,B]  174-11-185ms   | [S1,MB6,F]  185-9-194ms    | [S1,MB4,B]  210-11-221ms   | [S1,MB7,F]  221-9-230ms    | [S1,MB5,B]  246-11-257ms   | [S1,MB6,B]  282-10-292ms   | [S1,MB7,B]  318-10-328ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  64-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-6-111ms    | [S2,MB2,B]  130-8-139ms    | [S2,MB4,F]  139-6-146ms    | [S2,MB3,B]  165-8-174ms    | [S2,MB5,F]  174-6-181ms    | [S2,MB4,B]  201-8-210ms    | [S2,MB6,F]  210-6-217ms    | [S2,MB5,B]  238-8-246ms    | [S2,MB7,F]  246-6-253ms    | [S2,MB6,B]  273-8-282ms    | [S2,MB7,B]  309-8-318ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-64ms     AFR(10):0.9655 | [S3,MB1,F]  64-10-74ms     | [S3,MB1,B]  74-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-109ms    | [S3,MB2,B]  109-21-130ms   AFR(10):0.9655 | [S3,MB3,F]  130-13-144ms   | [S3,MB3,B]  144-21-165ms   AFR(10):0.9655 | [S3,MB4,F]  165-14-180ms   | [S3,MB4,B]  180-21-201ms   AFR(10):0.9655 | [S3,MB5,F]  201-14-215ms   | [S3,MB5,B]  215-22-238ms   AFR(10):0.9655 | [S3,MB6,F]  238-13-251ms   | [S3,MB6,B]  251-21-273ms   AFR(10):0.9655 | [S3,MB7,F]  273-14-287ms   | [S3,MB7,B]  287-21-309ms   AFR(10):0.9655
[rank3]:2025-12-12 22:21:28,031 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2221_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 374.79 ms, GPU Bubble Ratio: 43.13%, 32.21%, 46.69%, 12.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-30ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-207ms    | [S0,MB2,B]  219-23-243ms   | [S0,MB6,F]  243-6-250ms    | [S0,MB3,B]  254-23-278ms   | [S0,MB7,F]  278-6-285ms    | [S0,MB4,B]  290-23-314ms   | [S0,MB5,B]  327-23-350ms   | [S0,MB6,B]  362-12-374ms   | [S0,MB7,B]  374-0-374ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  195-24-219ms   | [S1,MB5,F]  219-9-229ms    | [S1,MB3,B]  230-24-254ms   | [S1,MB6,F]  254-9-264ms    | [S1,MB4,B]  266-24-290ms   | [S1,MB7,F]  290-9-300ms    | [S1,MB5,B]  303-24-327ms   | [S1,MB6,B]  338-24-362ms   | [S1,MB7,B]  364-10-374ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  176-19-195ms   | [S2,MB4,F]  195-6-202ms    | [S2,MB3,B]  211-19-230ms   | [S2,MB5,F]  230-6-237ms    | [S2,MB4,B]  247-19-266ms   | [S2,MB6,F]  266-6-273ms    | [S2,MB5,B]  284-19-303ms   | [S2,MB7,F]  303-6-310ms    | [S2,MB6,B]  319-19-338ms   | [S2,MB7,B]  355-8-364ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-29-176ms   AFR(10):0.9655 | [S3,MB3,F]  176-13-190ms   | [S3,MB3,B]  190-21-211ms   AFR(10):0.9655 | [S3,MB4,F]  211-14-225ms   | [S3,MB4,B]  225-21-247ms   AFR(10):0.9655 | [S3,MB5,F]  247-14-261ms   | [S3,MB5,B]  261-22-284ms   AFR(10):0.9655 | [S3,MB6,F]  284-13-297ms   | [S3,MB6,B]  297-21-319ms   AFR(10):0.9655 | [S3,MB7,F]  319-14-333ms   | [S3,MB7,B]  333-21-355ms   AFR(10):0.9655
[rank3]:2025-12-12 22:21:28,032 - INFO - 	> Batch Time: 374.79 ms (Average Freeze Ratio: 0.28, Time Reduction Rate: 0.30)
[rank0]:2025-12-12 22:22:53,054 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 22:22:57,761 - INFO - Avg. fwd time: 13.5130 / Avg. bwd time: 37.9160 / Avg. batch time: 483.9348 (ms) / GPU bubble ratio: 14.98%
[rank3]:2025-12-12 22:22:57,766 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.17(0.20)/0.60, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-12 22:22:57,785 - INFO - Avg. fwd time: 7.4647 / Avg. bwd time: 17.5827 / Avg. batch time: 514.4496 (ms) / GPU bubble ratio: 61.05%
[rank2]:2025-12-12 22:22:57,791 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-12 22:22:57,838 - INFO - Avg. fwd time: 7.5461 / Avg. bwd time: 19.4252 / Avg. batch time: 584.2303 (ms) / GPU bubble ratio: 63.07%
[rank0]:2025-12-12 22:22:57,845 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.48, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-12 22:22:57,813 - INFO - Avg. fwd time: 9.6143 / Avg. bwd time: 22.0433 / Avg. batch time: 551.2711 (ms) / GPU bubble ratio: 54.06%
[rank1]:2025-12-12 22:22:57,820 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-12 22:22:57,863 - INFO -  step: 100  loss: -8.0000  grad_norm:  6.6353  memory:  9.36GiB(19.71%)  tps: 7,210  tflops: 56.36  mfu: 18.07%
[rank3]:2025-12-12 22:22:57,872 - INFO -  step: 100  loss:  8.6799  grad_norm:  6.6353  memory: 17.37GiB(36.56%)  tps: 7,210  tflops: 56.36  mfu: 18.07%
[rank2]:2025-12-12 22:22:57,859 - INFO -  step: 100  loss: -8.0000  grad_norm:  6.6353  memory:  6.51GiB(13.70%)  tps: 7,210  tflops: 56.36  mfu: 18.07%
[rank2]:2025-12-12 22:22:57,948 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2222_stage2_step100.svg
[rank0]:2025-12-12 22:22:57,874 - INFO -  step: 100  loss: -8.0000  grad_norm:  6.6353  memory: 12.97GiB(27.31%)  tps: 7,210  tflops: 56.36  mfu: 18.07%
[rank0]:2025-12-12 22:22:57,948 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2222_stage0_step100.svg
[rank1]:2025-12-12 22:22:57,948 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2222_stage1_step100.svg
[rank3]:2025-12-12 22:22:58,012 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2222_real_step100_rank3.svg
[rank3]:			> Batch Time: 587.78 ms, GPU Bubble Ratio: 63.90%, 55.69%, 64.99%, 29.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  130-16-146ms   | [S0,MB4,F]  146-7-153ms    | [S0,MB1,B]  193-16-209ms   | [S0,MB5,F]  209-6-216ms    | [S0,MB2,B]  257-16-274ms   | [S0,MB6,F]  274-6-281ms    | [S0,MB3,B]  323-16-339ms   | [S0,MB7,F]  339-6-346ms    | [S0,MB4,B]  386-23-410ms   | [S0,MB5,B]  447-23-470ms   | [S0,MB6,B]  509-19-528ms   | [S0,MB7,B]  568-19-587ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  103-21-125ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  166-21-187ms   | [S1,MB4,F]  191-9-200ms    | [S1,MB2,B]  231-21-253ms   | [S1,MB5,F]  256-9-265ms    | [S1,MB3,B]  294-24-318ms   | [S1,MB6,F]  321-9-331ms    | [S1,MB4,B]  357-24-381ms   | [S1,MB7,F]  385-9-394ms    | [S1,MB5,B]  419-24-444ms   | [S1,MB6,B]  482-24-506ms   | [S1,MB7,B]  541-23-565ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  82-16-98ms     | [S2,MB2,F]  102-7-109ms    | [S2,MB1,B]  145-16-161ms   | [S2,MB3,F]  165-6-171ms    | [S2,MB2,B]  207-19-226ms   | [S2,MB4,F]  230-7-237ms    | [S2,MB3,B]  270-19-289ms   | [S2,MB5,F]  292-7-299ms    | [S2,MB4,B]  333-19-352ms   | [S2,MB6,F]  355-7-362ms    | [S2,MB5,B]  395-19-414ms   | [S2,MB7,F]  418-7-425ms    | [S2,MB6,B]  459-19-479ms   | [S2,MB7,B]  519-18-537ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-28-77ms     | [S3,MB1,F]  80-12-93ms     | [S3,MB1,B]  99-40-140ms    | [S3,MB2,F]  143-11-155ms   | [S3,MB2,B]  161-41-202ms   | [S3,MB3,F]  206-14-220ms   | [S3,MB3,B]  225-38-264ms   | [S3,MB4,F]  268-14-282ms   | [S3,MB4,B]  289-38-328ms   | [S3,MB5,F]  331-14-346ms   | [S3,MB5,B]  352-38-390ms   | [S3,MB6,F]  394-13-407ms   | [S3,MB6,B]  414-40-454ms   | [S3,MB7,F]  458-13-472ms   | [S3,MB7,B]  477-36-514ms  
[rank3]:2025-12-12 22:22:58,056 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2222_stage3_step100.svg
[rank2]:2025-12-12 22:24:56,065 - INFO - Avg. fwd time: 7.4502 / Avg. bwd time: 17.6925 / Avg. batch time: 512.1494 (ms) / GPU bubble ratio: 60.73%
[rank3]:2025-12-12 22:24:56,041 - INFO - Avg. fwd time: 13.5754 / Avg. bwd time: 37.5168 / Avg. batch time: 481.6020 (ms) / GPU bubble ratio: 15.13%
[rank1]:2025-12-12 22:24:56,093 - INFO - Avg. fwd time: 9.6127 / Avg. bwd time: 22.1028 / Avg. batch time: 549.0745 (ms) / GPU bubble ratio: 53.79%
[rank0]:2025-12-12 22:24:56,117 - INFO - Avg. fwd time: 7.5596 / Avg. bwd time: 19.5420 / Avg. batch time: 582.1041 (ms) / GPU bubble ratio: 62.75%
[rank0]:2025-12-12 22:26:43,452 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 22:26:47,919 - INFO - Avg. fwd time: 7.4616 / Avg. bwd time: 17.6130 / Avg. batch time: 505.5744 (ms) / GPU bubble ratio: 60.32%
[rank2]:2025-12-12 22:26:47,925 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-12 22:26:47,946 - INFO - Avg. fwd time: 9.6373 / Avg. bwd time: 21.9231 / Avg. batch time: 542.4306 (ms) / GPU bubble ratio: 53.45%
[rank1]:2025-12-12 22:26:47,953 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-12 22:26:47,896 - INFO - Avg. fwd time: 13.6497 / Avg. bwd time: 36.6017 / Avg. batch time: 475.2292 (ms) / GPU bubble ratio: 15.41%
[rank3]:2025-12-12 22:26:47,901 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.34(0.40)/0.60, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-12 22:26:47,995 - INFO -  step: 150  loss: -8.0000  grad_norm:  4.3077  memory:  6.51GiB(13.70%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank0]:2025-12-12 22:26:47,974 - INFO - Avg. fwd time: 7.6139 / Avg. bwd time: 19.3199 / Avg. batch time: 575.3717 (ms) / GPU bubble ratio: 62.55%
[rank0]:2025-12-12 22:26:47,981 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.32)/0.48, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 22:26:48,010 - INFO -  step: 150  loss: -8.0000  grad_norm:  4.3077  memory: 13.29GiB(27.97%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank1]:2025-12-12 22:26:47,999 - INFO -  step: 150  loss: -8.0000  grad_norm:  4.3077  memory:  9.36GiB(19.71%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank3]:2025-12-12 22:26:48,008 - INFO -  step: 150  loss:  3.8096  grad_norm:  4.3077  memory: 17.37GiB(36.56%)  tps: 7,119  tflops: 55.66  mfu: 17.84%
[rank2]:2025-12-12 22:28:37,077 - INFO - Avg. fwd time: 7.4708 / Avg. bwd time: 17.5638 / Avg. batch time: 499.2709 (ms) / GPU bubble ratio: 59.89%
[rank3]:2025-12-12 22:28:37,053 - INFO - Avg. fwd time: 13.7176 / Avg. bwd time: 35.7198 / Avg. batch time: 469.0468 (ms) / GPU bubble ratio: 15.68%
[rank1]:2025-12-12 22:28:37,104 - INFO - Avg. fwd time: 9.6718 / Avg. bwd time: 21.6878 / Avg. batch time: 536.0181 (ms) / GPU bubble ratio: 53.20%
[rank0]:2025-12-12 22:28:37,127 - INFO - Avg. fwd time: 7.6606 / Avg. bwd time: 18.9187 / Avg. batch time: 568.6213 (ms) / GPU bubble ratio: 62.61%
[rank0]:2025-12-12 22:30:17,216 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 22:30:21,382 - INFO - Avg. fwd time: 7.4933 / Avg. bwd time: 17.4231 / Avg. batch time: 491.6710 (ms) / GPU bubble ratio: 59.46%
[rank2]:2025-12-12 22:30:21,388 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank3]:2025-12-12 22:30:21,359 - INFO - Avg. fwd time: 13.7861 / Avg. bwd time: 34.7212 / Avg. batch time: 461.6582 (ms) / GPU bubble ratio: 15.94%
[rank3]:2025-12-12 22:30:21,364 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.55(0.60)/0.60, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 22:30:21,410 - INFO - Avg. fwd time: 9.7120 / Avg. bwd time: 21.4165 / Avg. batch time: 528.2826 (ms) / GPU bubble ratio: 52.86%
[rank1]:2025-12-12 22:30:21,416 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 22:30:21,458 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.3766  memory:  9.36GiB(19.71%)  tps: 7,675  tflops: 60.00  mfu: 19.23%
[rank0]:2025-12-12 22:30:21,433 - INFO - Avg. fwd time: 7.7134 / Avg. bwd time: 18.2875 / Avg. batch time: 560.5566 (ms) / GPU bubble ratio: 62.89%
[rank0]:2025-12-12 22:30:21,440 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.48)/0.48, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-12 22:30:21,469 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.3766  memory: 13.29GiB(27.97%)  tps: 7,675  tflops: 60.00  mfu: 19.23%
[rank0]:2025-12-12 22:30:21,519 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2230_stage0_step200.svg
[rank2]:2025-12-12 22:30:21,454 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.3766  memory:  6.51GiB(13.70%)  tps: 7,675  tflops: 60.00  mfu: 19.23%
[rank2]:2025-12-12 22:30:21,518 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2230_stage2_step200.svg
[rank3]:2025-12-12 22:30:21,467 - INFO -  step: 200  loss:  1.2423  grad_norm:  2.3766  memory: 17.37GiB(36.56%)  tps: 7,676  tflops: 60.00  mfu: 19.23%
[rank1]:2025-12-12 22:30:21,518 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2230_stage1_step200.svg
[rank3]:2025-12-12 22:30:21,605 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2230_real_step200_rank3.svg
[rank3]:			> Batch Time: 505.47 ms, GPU Bubble Ratio: 66.80%, 53.04%, 62.08%, 32.96%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  106-4-111ms    | [S0,MB4,F]  111-8-120ms    | [S0,MB1,B]  170-4-175ms    | [S0,MB5,F]  175-6-182ms    | [S0,MB2,B]  242-4-247ms    | [S0,MB6,F]  247-6-254ms    | [S0,MB3,B]  312-4-317ms    | [S0,MB7,F]  317-6-324ms    | [S0,MB4,B]  361-23-385ms   | [S0,MB5,B]  406-23-430ms   | [S0,MB6,B]  451-18-469ms   | [S0,MB7,B]  488-16-505ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  88-12-101ms    | [S1,MB3,F]  104-10-115ms   | [S1,MB1,B]  152-12-165ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  224-12-237ms   | [S1,MB5,F]  241-8-249ms    | [S1,MB3,B]  282-24-306ms   | [S1,MB6,F]  311-8-320ms    | [S1,MB4,B]  331-24-356ms   | [S1,MB7,F]  359-9-369ms    | [S1,MB5,B]  378-25-403ms   | [S1,MB6,B]  422-24-447ms   | [S1,MB7,B]  464-21-485ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-83ms      | [S2,MB2,F]  87-8-96ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  151-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-7-230ms    | [S2,MB3,B]  257-19-277ms   | [S2,MB5,F]  280-7-287ms    | [S2,MB4,B]  307-19-326ms   | [S2,MB6,F]  330-7-337ms    | [S2,MB5,B]  354-19-373ms   | [S2,MB7,F]  376-6-383ms    | [S2,MB6,B]  400-19-419ms   | [S2,MB7,B]  444-16-460ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-21-69ms     | [S3,MB1,F]  73-13-87ms     | [S3,MB1,B]  93-40-133ms    | [S3,MB2,F]  137-11-148ms   | [S3,MB2,B]  154-40-195ms   | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  218-34-253ms   | [S3,MB4,F]  256-16-272ms   | [S3,MB4,B]  278-22-301ms   | [S3,MB5,F]  305-15-321ms   | [S3,MB5,B]  327-21-348ms   | [S3,MB6,F]  352-14-366ms   | [S3,MB6,B]  372-22-395ms   | [S3,MB7,F]  398-14-413ms   | [S3,MB7,B]  419-22-441ms  
[rank3]:2025-12-12 22:30:21,649 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2230_stage3_step200.svg
[rank2]:2025-12-12 22:32:04,733 - INFO - Avg. fwd time: 7.5148 / Avg. bwd time: 17.2895 / Avg. batch time: 485.2319 (ms) / GPU bubble ratio: 59.11%
[rank3]:2025-12-12 22:32:04,710 - INFO - Avg. fwd time: 13.8490 / Avg. bwd time: 33.8716 / Avg. batch time: 455.3561 (ms) / GPU bubble ratio: 16.16%
[rank1]:2025-12-12 22:32:04,760 - INFO - Avg. fwd time: 9.7513 / Avg. bwd time: 21.1504 / Avg. batch time: 521.7249 (ms) / GPU bubble ratio: 52.62%
[rank0]:2025-12-12 22:32:04,784 - INFO - Avg. fwd time: 7.7582 / Avg. bwd time: 17.4250 / Avg. batch time: 553.6823 (ms) / GPU bubble ratio: 63.61%
[rank0]:2025-12-12 22:33:44,699 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 22:33:48,790 - INFO - Avg. fwd time: 7.5306 / Avg. bwd time: 17.1816 / Avg. batch time: 480.5190 (ms) / GPU bubble ratio: 58.86%
[rank2]:2025-12-12 22:33:48,796 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 22:33:48,817 - INFO - Avg. fwd time: 9.7820 / Avg. bwd time: 20.9324 / Avg. batch time: 516.8985 (ms) / GPU bubble ratio: 52.46%
[rank1]:2025-12-12 22:33:48,824 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-12 22:33:48,766 - INFO - Avg. fwd time: 13.9027 / Avg. bwd time: 33.2438 / Avg. batch time: 450.8015 (ms) / GPU bubble ratio: 16.33%
[rank3]:2025-12-12 22:33:48,771 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.59(0.60)/0.60, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 22:33:48,841 - INFO - Avg. fwd time: 7.7918 / Avg. bwd time: 16.7158 / Avg. batch time: 548.5925 (ms) / GPU bubble ratio: 64.26%
[rank0]:2025-12-12 22:33:48,848 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.48)/0.48, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 22:33:48,862 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5845  memory:  6.51GiB(13.70%)  tps: 7,899  tflops: 61.75  mfu: 19.79%
[rank1]:2025-12-12 22:33:48,866 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5845  memory:  9.36GiB(19.71%)  tps: 7,899  tflops: 61.75  mfu: 19.79%
[rank3]:2025-12-12 22:33:48,875 - INFO -  step: 250  loss:  0.4144  grad_norm:  0.5845  memory: 17.37GiB(36.56%)  tps: 7,899  tflops: 61.75  mfu: 19.79%
[rank0]:2025-12-12 22:33:48,877 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.5845  memory: 13.29GiB(27.97%)  tps: 7,899  tflops: 61.75  mfu: 19.79%
[rank2]:2025-12-12 22:35:31,434 - INFO - Avg. fwd time: 7.5433 / Avg. bwd time: 17.0943 / Avg. batch time: 475.9936 (ms) / GPU bubble ratio: 58.59%
[rank3]:2025-12-12 22:35:31,410 - INFO - Avg. fwd time: 13.9397 / Avg. bwd time: 32.6618 / Avg. batch time: 446.4104 (ms) / GPU bubble ratio: 16.49%
[rank1]:2025-12-12 22:35:31,462 - INFO - Avg. fwd time: 9.8063 / Avg. bwd time: 20.7588 / Avg. batch time: 512.2935 (ms) / GPU bubble ratio: 52.27%
[rank0]:2025-12-12 22:35:31,485 - INFO - Avg. fwd time: 7.8192 / Avg. bwd time: 16.1512 / Avg. batch time: 543.7749 (ms) / GPU bubble ratio: 64.73%
[rank0]:2025-12-12 22:37:10,675 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 22:37:14,744 - INFO - Avg. fwd time: 13.9732 / Avg. bwd time: 32.2057 / Avg. batch time: 443.0425 (ms) / GPU bubble ratio: 16.61%
[rank3]:2025-12-12 22:37:14,750 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.59(0.60)/0.60, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 22:37:14,797 - INFO - Avg. fwd time: 9.8277 / Avg. bwd time: 20.6127 / Avg. batch time: 508.7430 (ms) / GPU bubble ratio: 52.13%
[rank1]:2025-12-12 22:37:14,803 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 22:37:14,821 - INFO - Avg. fwd time: 7.8422 / Avg. bwd time: 15.6792 / Avg. batch time: 540.0469 (ms) / GPU bubble ratio: 65.16%
[rank0]:2025-12-12 22:37:14,828 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.48)/0.48, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 22:37:14,769 - INFO - Avg. fwd time: 7.5541 / Avg. bwd time: 17.0219 / Avg. batch time: 472.5162 (ms) / GPU bubble ratio: 58.39%
[rank2]:2025-12-12 22:37:14,775 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 22:37:14,842 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1885  memory:  6.51GiB(13.70%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank3]:2025-12-12 22:37:14,855 - INFO -  step: 300  loss:  0.2887  grad_norm:  0.1885  memory: 17.37GiB(36.56%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank1]:2025-12-12 22:37:14,846 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1885  memory:  9.36GiB(19.71%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank1]:2025-12-12 22:37:14,906 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2237_stage1_step300.svg
[rank0]:2025-12-12 22:37:14,857 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1885  memory: 13.29GiB(27.97%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank0]:2025-12-12 22:37:14,905 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2237_stage0_step300.svg
[rank2]:2025-12-12 22:37:14,906 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2237_stage2_step300.svg
[rank3]:2025-12-12 22:37:14,991 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2237_real_step300_rank3.svg
[rank3]:			> Batch Time: 503.09 ms, GPU Bubble Ratio: 70.60%, 53.77%, 61.96%, 33.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  238-0-238ms    | [S0,MB6,F]  238-6-245ms    | [S0,MB3,B]  310-0-310ms    | [S0,MB7,F]  310-6-317ms    | [S0,MB4,B]  360-23-384ms   | [S0,MB5,B]  406-23-429ms   | [S0,MB6,B]  449-18-468ms   | [S0,MB7,B]  486-16-503ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  222-10-233ms   | [S1,MB5,F]  237-8-245ms    | [S1,MB3,B]  279-24-303ms   | [S1,MB6,F]  309-9-318ms    | [S1,MB4,B]  331-24-355ms   | [S1,MB7,F]  359-9-368ms    | [S1,MB5,B]  377-24-402ms   | [S1,MB6,B]  421-24-445ms   | [S1,MB7,B]  461-20-482ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  198-19-217ms   | [S2,MB4,F]  221-6-228ms    | [S2,MB3,B]  254-19-273ms   | [S2,MB5,F]  277-7-284ms    | [S2,MB4,B]  306-19-325ms   | [S2,MB6,F]  329-7-336ms    | [S2,MB5,B]  352-19-372ms   | [S2,MB7,F]  375-7-382ms    | [S2,MB6,B]  398-19-417ms   | [S2,MB7,B]  442-16-458ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-39-193ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-32-249ms   | [S3,MB4,F]  253-17-270ms   | [S3,MB4,B]  276-22-299ms   | [S3,MB5,F]  305-15-320ms   | [S3,MB5,B]  326-21-347ms   | [S3,MB6,F]  351-14-365ms   | [S3,MB6,B]  372-21-393ms   | [S3,MB7,F]  397-14-411ms   | [S3,MB7,B]  417-21-438ms  
[rank3]:2025-12-12 22:37:15,033 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2237_stage3_step300.svg
[rank3]:2025-12-12 22:38:56,717 - INFO - Avg. fwd time: 14.0014 / Avg. bwd time: 31.7505 / Avg. batch time: 439.5672 (ms) / GPU bubble ratio: 16.73%
[rank2]:2025-12-12 22:38:56,742 - INFO - Avg. fwd time: 7.5639 / Avg. bwd time: 16.9607 / Avg. batch time: 468.9840 (ms) / GPU bubble ratio: 58.17%
[rank1]:2025-12-12 22:38:56,770 - INFO - Avg. fwd time: 9.8446 / Avg. bwd time: 20.4924 / Avg. batch time: 505.1610 (ms) / GPU bubble ratio: 51.96%
[rank0]:2025-12-12 22:38:56,795 - INFO - Avg. fwd time: 7.8622 / Avg. bwd time: 15.2634 / Avg. batch time: 536.3211 (ms) / GPU bubble ratio: 65.50%
[rank0]:2025-12-12 22:40:35,215 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 22:40:39,230 - INFO - Avg. fwd time: 7.5722 / Avg. bwd time: 16.9071 / Avg. batch time: 466.1817 (ms) / GPU bubble ratio: 57.99%
[rank3]:2025-12-12 22:40:39,205 - INFO - Avg. fwd time: 14.0270 / Avg. bwd time: 31.3879 / Avg. batch time: 436.8455 (ms) / GPU bubble ratio: 16.83%
[rank1]:2025-12-12 22:40:39,259 - INFO - Avg. fwd time: 9.8611 / Avg. bwd time: 20.3864 / Avg. batch time: 502.3087 (ms) / GPU bubble ratio: 51.83%
[rank0]:2025-12-12 22:40:39,284 - INFO - Avg. fwd time: 7.8792 / Avg. bwd time: 14.9085 / Avg. batch time: 533.3373 (ms) / GPU bubble ratio: 65.82%
[rank2]:2025-12-12 22:40:39,305 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0828  memory:  6.51GiB(13.70%)  tps: 8,013  tflops: 62.64  mfu: 20.08%
[rank3]:2025-12-12 22:40:39,320 - INFO -  step: 350  loss:  0.2304  grad_norm:  0.0828  memory: 17.37GiB(36.56%)  tps: 8,013  tflops: 62.64  mfu: 20.08%
[rank1]:2025-12-12 22:40:39,309 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0828  memory:  9.36GiB(19.71%)  tps: 8,013  tflops: 62.64  mfu: 20.08%
[rank0]:2025-12-12 22:40:39,320 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0828  memory: 13.29GiB(27.97%)  tps: 8,013  tflops: 62.64  mfu: 20.08%
[rank2]:2025-12-12 22:42:22,073 - INFO - Avg. fwd time: 7.5790 / Avg. bwd time: 16.8605 / Avg. batch time: 463.8760 (ms) / GPU bubble ratio: 57.85%
[rank3]:2025-12-12 22:42:22,047 - INFO - Avg. fwd time: 14.0464 / Avg. bwd time: 31.0898 / Avg. batch time: 434.6108 (ms) / GPU bubble ratio: 16.92%
[rank1]:2025-12-12 22:42:22,102 - INFO - Avg. fwd time: 9.8737 / Avg. bwd time: 20.2941 / Avg. batch time: 499.9661 (ms) / GPU bubble ratio: 51.73%
[rank0]:2025-12-12 22:42:22,127 - INFO - Avg. fwd time: 7.8936 / Avg. bwd time: 14.6135 / Avg. batch time: 530.8799 (ms) / GPU bubble ratio: 66.08%
[rank0]:2025-12-12 22:43:59,949 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 22:44:03,995 - INFO - Avg. fwd time: 7.5853 / Avg. bwd time: 16.8193 / Avg. batch time: 461.5595 (ms) / GPU bubble ratio: 57.70%
[rank3]:2025-12-12 22:44:03,969 - INFO - Avg. fwd time: 14.0599 / Avg. bwd time: 30.7991 / Avg. batch time: 432.3596 (ms) / GPU bubble ratio: 17.00%
[rank1]:2025-12-12 22:44:04,023 - INFO - Avg. fwd time: 9.8848 / Avg. bwd time: 20.2143 / Avg. batch time: 497.6150 (ms) / GPU bubble ratio: 51.61%
[rank0]:2025-12-12 22:44:04,050 - INFO - Avg. fwd time: 7.9064 / Avg. bwd time: 14.3431 / Avg. batch time: 528.4332 (ms) / GPU bubble ratio: 66.32%
[rank0]:2025-12-12 22:44:04,086 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0564  memory: 13.29GiB(27.97%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank2]:2025-12-12 22:44:04,071 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0564  memory:  6.51GiB(13.70%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank3]:2025-12-12 22:44:04,083 - INFO -  step: 400  loss:  0.2141  grad_norm:  0.0564  memory: 17.37GiB(36.56%)  tps: 8,002  tflops: 62.55  mfu: 20.05%
[rank1]:2025-12-12 22:44:04,075 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0564  memory:  9.36GiB(19.71%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank1]:2025-12-12 22:44:04,140 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2244_stage1_step400.svg
[rank0]:2025-12-12 22:44:04,164 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2244_stage0_step400.svg
[rank2]:2025-12-12 22:44:04,143 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2244_stage2_step400.svg
[rank3]:2025-12-12 22:44:04,225 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2244_real_step400_rank3.svg
[rank3]:			> Batch Time: 487.92 ms, GPU Bubble Ratio: 69.78%, 52.40%, 60.78%, 33.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  235-0-235ms    | [S0,MB6,F]  235-6-241ms    | [S0,MB3,B]  299-0-299ms    | [S0,MB7,F]  299-6-305ms    | [S0,MB4,B]  346-23-369ms   | [S0,MB5,B]  390-23-414ms   | [S0,MB6,B]  434-18-452ms   | [S0,MB7,B]  471-16-487ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  219-10-229ms   | [S1,MB5,F]  233-8-242ms    | [S1,MB3,B]  269-24-293ms   | [S1,MB6,F]  297-8-306ms    | [S1,MB4,B]  316-24-340ms   | [S1,MB7,F]  344-9-353ms    | [S1,MB5,B]  362-24-387ms   | [S1,MB6,B]  406-24-430ms   | [S1,MB7,B]  446-20-467ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  194-19-213ms   | [S2,MB4,F]  217-6-224ms    | [S2,MB3,B]  245-19-264ms   | [S2,MB5,F]  268-6-275ms    | [S2,MB4,B]  292-19-311ms   | [S2,MB6,F]  314-7-321ms    | [S2,MB5,B]  338-19-357ms   | [S2,MB7,F]  360-7-367ms    | [S2,MB6,B]  383-19-402ms   | [S2,MB7,B]  427-16-443ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-36-189ms   | [S3,MB3,F]  193-15-208ms   | [S3,MB3,B]  214-25-240ms   | [S3,MB4,F]  243-15-259ms   | [S3,MB4,B]  264-21-286ms   | [S3,MB5,F]  290-14-305ms   | [S3,MB5,B]  311-21-333ms   | [S3,MB6,F]  336-14-351ms   | [S3,MB6,B]  357-21-378ms   | [S3,MB7,F]  382-14-396ms   | [S3,MB7,B]  402-21-423ms  
[rank3]:2025-12-12 22:44:04,273 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2244_stage3_step400.svg
[rank3]:2025-12-12 22:44:27,269 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 22:44:27,488 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-12 22:44:27,507 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 22:44:27,465 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 22:45:45,300 - INFO - Avg. fwd time: 7.5907 / Avg. bwd time: 16.7830 / Avg. batch time: 459.3447 (ms) / GPU bubble ratio: 57.55%
[rank3]:2025-12-12 22:45:45,274 - INFO - Avg. fwd time: 14.0676 / Avg. bwd time: 30.5248 / Avg. batch time: 430.1811 (ms) / GPU bubble ratio: 17.07%
[rank1]:2025-12-12 22:45:45,329 - INFO - Avg. fwd time: 9.8935 / Avg. bwd time: 20.1443 / Avg. batch time: 495.3661 (ms) / GPU bubble ratio: 51.49%
[rank0]:2025-12-12 22:45:45,355 - INFO - Avg. fwd time: 7.9178 / Avg. bwd time: 14.1165 / Avg. batch time: 526.1007 (ms) / GPU bubble ratio: 66.49%
[rank0]:2025-12-12 22:47:22,473 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 22:47:26,450 - INFO - Avg. fwd time: 7.5951 / Avg. bwd time: 16.7499 / Avg. batch time: 457.3556 (ms) / GPU bubble ratio: 57.42%
[rank3]:2025-12-12 22:47:26,424 - INFO - Avg. fwd time: 14.0757 / Avg. bwd time: 30.2799 / Avg. batch time: 428.2465 (ms) / GPU bubble ratio: 17.14%
[rank1]:2025-12-12 22:47:26,480 - INFO - Avg. fwd time: 9.9005 / Avg. bwd time: 20.0808 / Avg. batch time: 493.3434 (ms) / GPU bubble ratio: 51.38%
[rank0]:2025-12-12 22:47:26,505 - INFO - Avg. fwd time: 7.9276 / Avg. bwd time: 13.9023 / Avg. batch time: 524.0040 (ms) / GPU bubble ratio: 66.67%
[rank0]:2025-12-12 22:47:26,542 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0766  memory: 13.29GiB(27.97%)  tps: 8,093  tflops: 63.26  mfu: 20.28%
[rank2]:2025-12-12 22:47:26,527 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0766  memory:  6.51GiB(13.70%)  tps: 8,093  tflops: 63.26  mfu: 20.28%
[rank3]:2025-12-12 22:47:26,540 - INFO -  step: 450  loss:  0.2267  grad_norm:  0.0766  memory: 17.37GiB(36.56%)  tps: 8,093  tflops: 63.27  mfu: 20.28%
[rank1]:2025-12-12 22:47:26,531 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0766  memory:  9.36GiB(19.71%)  tps: 8,093  tflops: 63.26  mfu: 20.28%
[rank3]:2025-12-12 22:49:07,921 - INFO - Avg. fwd time: 14.0840 / Avg. bwd time: 30.0686 / Avg. batch time: 426.5978 (ms) / GPU bubble ratio: 17.20%
[rank0]:2025-12-12 22:49:08,004 - INFO - Avg. fwd time: 7.9358 / Avg. bwd time: 13.7128 / Avg. batch time: 522.2124 (ms) / GPU bubble ratio: 66.84%
[rank2]:2025-12-12 22:49:07,947 - INFO - Avg. fwd time: 7.5990 / Avg. bwd time: 16.7198 / Avg. batch time: 455.6588 (ms) / GPU bubble ratio: 57.30%
[rank1]:2025-12-12 22:49:07,978 - INFO - Avg. fwd time: 9.9072 / Avg. bwd time: 20.0240 / Avg. batch time: 491.6231 (ms) / GPU bubble ratio: 51.29%
[rank0]:2025-12-12 22:50:45,564 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 22:50:49,550 - INFO - Avg. fwd time: 7.6028 / Avg. bwd time: 16.6926 / Avg. batch time: 454.1630 (ms) / GPU bubble ratio: 57.20%
[rank3]:2025-12-12 22:50:49,523 - INFO - Avg. fwd time: 14.0916 / Avg. bwd time: 29.8822 / Avg. batch time: 425.1451 (ms) / GPU bubble ratio: 17.25%
[rank0]:2025-12-12 22:50:49,607 - INFO - Avg. fwd time: 7.9438 / Avg. bwd time: 13.5515 / Avg. batch time: 520.6257 (ms) / GPU bubble ratio: 66.97%
[rank0]:2025-12-12 22:50:49,643 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0852  memory: 13.29GiB(27.97%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank2]:2025-12-12 22:50:49,628 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0852  memory:  6.51GiB(13.70%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank3]:2025-12-12 22:50:49,641 - INFO -  step: 500  loss:  0.2183  grad_norm:  0.0852  memory: 17.37GiB(36.56%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank1]:2025-12-12 22:50:49,580 - INFO - Avg. fwd time: 9.9131 / Avg. bwd time: 19.9713 / Avg. batch time: 490.0984 (ms) / GPU bubble ratio: 51.22%
[rank1]:2025-12-12 22:50:49,632 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0852  memory:  9.36GiB(19.71%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank0]:2025-12-12 22:50:49,692 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2250_stage0_step500.svg
[rank2]:2025-12-12 22:50:49,691 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2250_stage2_step500.svg
[rank1]:2025-12-12 22:50:49,692 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2250_stage1_step500.svg
[rank3]:2025-12-12 22:50:49,777 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2250_real_step500_rank3.svg
[rank3]:			> Batch Time: 486.22 ms, GPU Bubble Ratio: 69.48%, 52.25%, 60.69%, 33.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  235-0-235ms    | [S0,MB6,F]  235-6-241ms    | [S0,MB3,B]  297-0-297ms    | [S0,MB7,F]  297-6-304ms    | [S0,MB4,B]  344-23-368ms   | [S0,MB5,B]  388-23-412ms   | [S0,MB6,B]  432-18-451ms   | [S0,MB7,B]  469-16-486ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  219-10-229ms   | [S1,MB5,F]  233-8-242ms    | [S1,MB3,B]  268-24-292ms   | [S1,MB6,F]  295-8-304ms    | [S1,MB4,B]  314-24-339ms   | [S1,MB7,F]  343-9-352ms    | [S1,MB5,B]  360-25-385ms   | [S1,MB6,B]  404-24-429ms   | [S1,MB7,B]  445-20-465ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  150-6-156ms    | [S2,MB2,B]  194-19-213ms   | [S2,MB4,F]  217-7-224ms    | [S2,MB3,B]  243-19-262ms   | [S2,MB5,F]  266-7-273ms    | [S2,MB4,B]  290-19-310ms   | [S2,MB6,F]  313-7-320ms    | [S2,MB5,B]  336-19-355ms   | [S2,MB7,F]  358-7-365ms    | [S2,MB6,B]  381-19-401ms   | [S2,MB7,B]  425-16-441ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-36-189ms   | [S3,MB3,F]  193-15-208ms   | [S3,MB3,B]  214-24-238ms   | [S3,MB4,F]  242-15-257ms   | [S3,MB4,B]  263-21-285ms   | [S3,MB5,F]  289-14-303ms   | [S3,MB5,B]  309-21-331ms   | [S3,MB6,F]  334-14-349ms   | [S3,MB6,B]  355-21-376ms   | [S3,MB7,F]  380-14-394ms   | [S3,MB7,B]  400-21-422ms  
[rank3]:2025-12-12 22:50:49,819 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2250_stage3_step500.svg
[rank2]:2025-12-12 22:52:30,659 - INFO - Avg. fwd time: 7.6064 / Avg. bwd time: 16.6681 / Avg. batch time: 452.6645 (ms) / GPU bubble ratio: 57.10%
[rank3]:2025-12-12 22:52:30,633 - INFO - Avg. fwd time: 14.0978 / Avg. bwd time: 29.6948 / Avg. batch time: 423.6630 (ms) / GPU bubble ratio: 17.31%
[rank1]:2025-12-12 22:52:30,690 - INFO - Avg. fwd time: 9.9191 / Avg. bwd time: 19.9250 / Avg. batch time: 488.5744 (ms) / GPU bubble ratio: 51.13%
[rank0]:2025-12-12 22:52:30,717 - INFO - Avg. fwd time: 7.9513 / Avg. bwd time: 13.4149 / Avg. batch time: 519.0488 (ms) / GPU bubble ratio: 67.07%
[rank0]:2025-12-12 22:54:07,746 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 22:54:11,704 - INFO - Avg. fwd time: 14.1028 / Avg. bwd time: 29.5281 / Avg. batch time: 422.3399 (ms) / GPU bubble ratio: 17.35%
[rank2]:2025-12-12 22:54:11,730 - INFO - Avg. fwd time: 7.6096 / Avg. bwd time: 16.6456 / Avg. batch time: 451.3045 (ms) / GPU bubble ratio: 57.00%
[rank2]:2025-12-12 22:54:11,809 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0682  memory:  6.51GiB(13.70%)  tps: 8,104  tflops: 63.35  mfu: 20.30%
[rank1]:2025-12-12 22:54:11,761 - INFO - Avg. fwd time: 9.9251 / Avg. bwd time: 19.8823 / Avg. batch time: 487.1898 (ms) / GPU bubble ratio: 51.05%
[rank1]:2025-12-12 22:54:11,813 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0682  memory:  9.36GiB(19.71%)  tps: 8,104  tflops: 63.35  mfu: 20.30%
[rank0]:2025-12-12 22:54:11,788 - INFO - Avg. fwd time: 7.9580 / Avg. bwd time: 13.2818 / Avg. batch time: 517.6144 (ms) / GPU bubble ratio: 67.17%
[rank0]:2025-12-12 22:54:11,824 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0682  memory: 13.29GiB(27.97%)  tps: 8,104  tflops: 63.35  mfu: 20.30%
[rank3]:2025-12-12 22:54:11,822 - INFO -  step: 550  loss:  0.2255  grad_norm:  0.0682  memory: 17.37GiB(36.56%)  tps: 8,104  tflops: 63.35  mfu: 20.30%
[rank2]:2025-12-12 22:55:53,907 - INFO - Avg. fwd time: 7.6124 / Avg. bwd time: 16.6247 / Avg. batch time: 450.3000 (ms) / GPU bubble ratio: 56.94%
[rank3]:2025-12-12 22:55:53,879 - INFO - Avg. fwd time: 14.1092 / Avg. bwd time: 29.4013 / Avg. batch time: 421.3680 (ms) / GPU bubble ratio: 17.39%
[rank0]:2025-12-12 22:55:53,965 - INFO - Avg. fwd time: 7.9639 / Avg. bwd time: 13.1519 / Avg. batch time: 516.5480 (ms) / GPU bubble ratio: 67.30%
[rank1]:2025-12-12 22:55:53,938 - INFO - Avg. fwd time: 9.9304 / Avg. bwd time: 19.8427 / Avg. batch time: 486.1722 (ms) / GPU bubble ratio: 51.01%
[rank0]:2025-12-12 22:57:31,915 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 22:57:36,064 - INFO - Avg. fwd time: 7.6151 / Avg. bwd time: 16.6057 / Avg. batch time: 449.3781 (ms) / GPU bubble ratio: 56.88%
[rank3]:2025-12-12 22:57:36,037 - INFO - Avg. fwd time: 14.1149 / Avg. bwd time: 29.2847 / Avg. batch time: 420.4762 (ms) / GPU bubble ratio: 17.43%
[rank1]:2025-12-12 22:57:36,095 - INFO - Avg. fwd time: 9.9361 / Avg. bwd time: 19.8067 / Avg. batch time: 485.2382 (ms) / GPU bubble ratio: 50.96%
[rank2]:2025-12-12 22:57:36,145 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0919  memory:  6.51GiB(13.70%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank0]:2025-12-12 22:57:36,123 - INFO - Avg. fwd time: 7.9692 / Avg. bwd time: 13.0405 / Avg. batch time: 515.5690 (ms) / GPU bubble ratio: 67.40%
[rank0]:2025-12-12 22:57:36,159 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0919  memory: 13.29GiB(27.97%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank3]:2025-12-12 22:57:36,157 - INFO -  step: 600  loss:  0.2209  grad_norm:  0.0919  memory: 17.37GiB(36.56%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank1]:2025-12-12 22:57:36,148 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0919  memory:  9.36GiB(19.71%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank1]:2025-12-12 22:57:36,210 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2257_stage1_step600.svg
[rank2]:2025-12-12 22:57:36,210 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2257_stage2_step600.svg
[rank0]:2025-12-12 22:57:36,209 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2257_stage0_step600.svg
[rank3]:2025-12-12 22:57:36,294 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2257_real_step600_rank3.svg
[rank3]:			> Batch Time: 501.47 ms, GPU Bubble Ratio: 69.85%, 53.64%, 61.98%, 33.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  237-0-237ms    | [S0,MB6,F]  237-6-244ms    | [S0,MB3,B]  308-0-308ms    | [S0,MB7,F]  308-6-315ms    | [S0,MB4,B]  358-23-382ms   | [S0,MB5,B]  403-23-427ms   | [S0,MB6,B]  447-22-469ms   | [S0,MB7,B]  484-16-501ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  221-10-232ms   | [S1,MB5,F]  235-8-244ms    | [S1,MB3,B]  277-24-301ms   | [S1,MB6,F]  307-9-316ms    | [S1,MB4,B]  328-24-353ms   | [S1,MB7,F]  356-9-365ms    | [S1,MB5,B]  375-24-400ms   | [S1,MB6,B]  419-24-444ms   | [S1,MB7,B]  460-21-481ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  197-19-216ms   | [S2,MB4,F]  220-6-227ms    | [S2,MB3,B]  252-19-272ms   | [S2,MB5,F]  275-7-282ms    | [S2,MB4,B]  304-19-323ms   | [S2,MB6,F]  327-7-334ms    | [S2,MB5,B]  351-19-370ms   | [S2,MB7,F]  373-6-380ms    | [S2,MB6,B]  396-19-416ms   | [S2,MB7,B]  440-16-456ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-85ms     | [S3,MB1,B]  91-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  152-39-192ms   | [S3,MB3,F]  195-15-210ms   | [S3,MB3,B]  216-31-248ms   | [S3,MB4,F]  251-16-268ms   | [S3,MB4,B]  275-22-297ms   | [S3,MB5,F]  303-15-318ms   | [S3,MB5,B]  324-21-345ms   | [S3,MB6,F]  349-14-364ms   | [S3,MB6,B]  370-21-391ms   | [S3,MB7,F]  395-14-409ms   | [S3,MB7,B]  415-21-437ms  
[rank3]:2025-12-12 22:57:36,338 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2257_stage3_step600.svg
[rank3]:2025-12-12 22:59:19,136 - INFO - Avg. fwd time: 14.1201 / Avg. bwd time: 29.1956 / Avg. batch time: 419.8040 (ms) / GPU bubble ratio: 17.46%
[rank2]:2025-12-12 22:59:19,164 - INFO - Avg. fwd time: 7.6174 / Avg. bwd time: 16.5880 / Avg. batch time: 448.6988 (ms) / GPU bubble ratio: 56.84%
[rank1]:2025-12-12 22:59:19,196 - INFO - Avg. fwd time: 9.9408 / Avg. bwd time: 19.7739 / Avg. batch time: 484.5549 (ms) / GPU bubble ratio: 50.94%
[rank0]:2025-12-12 22:59:19,224 - INFO - Avg. fwd time: 7.9739 / Avg. bwd time: 12.9304 / Avg. batch time: 514.8436 (ms) / GPU bubble ratio: 67.52%
[rank0]:2025-12-12 23:00:56,905 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 23:01:00,879 - INFO - Avg. fwd time: 14.1244 / Avg. bwd time: 29.0871 / Avg. batch time: 418.9586 (ms) / GPU bubble ratio: 17.49%
[rank2]:2025-12-12 23:01:00,908 - INFO - Avg. fwd time: 7.6197 / Avg. bwd time: 16.5717 / Avg. batch time: 447.8276 (ms) / GPU bubble ratio: 56.78%
[rank1]:2025-12-12 23:01:00,939 - INFO - Avg. fwd time: 9.9463 / Avg. bwd time: 19.7435 / Avg. batch time: 483.6706 (ms) / GPU bubble ratio: 50.89%
[rank1]:2025-12-12 23:01:00,992 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0701  memory:  9.36GiB(19.71%)  tps: 7,998  tflops: 62.53  mfu: 20.04%
[rank0]:2025-12-12 23:01:00,967 - INFO - Avg. fwd time: 7.9785 / Avg. bwd time: 12.8359 / Avg. batch time: 513.9205 (ms) / GPU bubble ratio: 67.60%
[rank0]:2025-12-12 23:01:01,003 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0701  memory: 13.29GiB(27.97%)  tps: 7,998  tflops: 62.53  mfu: 20.04%
[rank2]:2025-12-12 23:01:00,989 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0701  memory:  6.51GiB(13.70%)  tps: 7,998  tflops: 62.53  mfu: 20.04%
[rank3]:2025-12-12 23:01:01,001 - INFO -  step: 650  loss:  0.2303  grad_norm:  0.0701  memory: 17.37GiB(36.56%)  tps: 7,998  tflops: 62.53  mfu: 20.04%
[rank3]:2025-12-12 23:02:44,029 - INFO - Avg. fwd time: 14.1310 / Avg. bwd time: 29.0142 / Avg. batch time: 418.4327 (ms) / GPU bubble ratio: 17.51%
[rank2]:2025-12-12 23:02:44,058 - INFO - Avg. fwd time: 7.6215 / Avg. bwd time: 16.5561 / Avg. batch time: 447.2787 (ms) / GPU bubble ratio: 56.76%
[rank1]:2025-12-12 23:02:44,090 - INFO - Avg. fwd time: 9.9497 / Avg. bwd time: 19.7160 / Avg. batch time: 483.1250 (ms) / GPU bubble ratio: 50.88%
[rank0]:2025-12-12 23:02:44,118 - INFO - Avg. fwd time: 7.9821 / Avg. bwd time: 12.7407 / Avg. batch time: 513.3359 (ms) / GPU bubble ratio: 67.70%
[rank0]:2025-12-12 23:04:21,037 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 23:04:25,024 - INFO - Avg. fwd time: 7.6234 / Avg. bwd time: 16.5420 / Avg. batch time: 446.3932 (ms) / GPU bubble ratio: 56.69%
[rank1]:2025-12-12 23:04:25,057 - INFO - Avg. fwd time: 9.9544 / Avg. bwd time: 19.6896 / Avg. batch time: 482.2228 (ms) / GPU bubble ratio: 50.82%
[rank3]:2025-12-12 23:04:24,996 - INFO - Avg. fwd time: 14.1361 / Avg. bwd time: 28.9035 / Avg. batch time: 417.5703 (ms) / GPU bubble ratio: 17.54%
[rank0]:2025-12-12 23:04:25,085 - INFO - Avg. fwd time: 7.9861 / Avg. bwd time: 12.6590 / Avg. batch time: 512.4026 (ms) / GPU bubble ratio: 67.77%
[rank0]:2025-12-12 23:04:25,121 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0734  memory: 13.29GiB(27.97%)  tps: 8,027  tflops: 62.75  mfu: 20.11%
[rank2]:2025-12-12 23:04:25,107 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0734  memory:  6.51GiB(13.70%)  tps: 8,027  tflops: 62.75  mfu: 20.11%
[rank1]:2025-12-12 23:04:25,110 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0734  memory:  9.36GiB(19.71%)  tps: 8,027  tflops: 62.75  mfu: 20.11%
[rank3]:2025-12-12 23:04:25,119 - INFO -  step: 700  loss:  0.1911  grad_norm:  0.0734  memory: 17.37GiB(36.56%)  tps: 8,027  tflops: 62.75  mfu: 20.11%
[rank0]:2025-12-12 23:04:25,173 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2304_stage0_step700.svg
[rank2]:2025-12-12 23:04:25,172 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2304_stage2_step700.svg
[rank1]:2025-12-12 23:04:25,173 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2304_stage1_step700.svg
[rank3]:2025-12-12 23:04:25,256 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2304_real_step700_rank3.svg
[rank3]:			> Batch Time: 486.39 ms, GPU Bubble Ratio: 68.86%, 52.17%, 60.71%, 33.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  234-0-234ms    | [S0,MB6,F]  234-6-241ms    | [S0,MB3,B]  297-0-297ms    | [S0,MB7,F]  297-6-304ms    | [S0,MB4,B]  344-23-368ms   | [S0,MB5,B]  389-23-413ms   | [S0,MB6,B]  432-21-454ms   | [S0,MB7,B]  469-16-486ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  218-10-229ms   | [S1,MB5,F]  232-8-241ms    | [S1,MB3,B]  267-24-292ms   | [S1,MB6,F]  295-9-304ms    | [S1,MB4,B]  314-24-339ms   | [S1,MB7,F]  342-9-352ms    | [S1,MB5,B]  360-25-385ms   | [S1,MB6,B]  404-24-429ms   | [S1,MB7,B]  445-20-466ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  193-19-213ms   | [S2,MB4,F]  216-7-223ms    | [S2,MB3,B]  243-19-262ms   | [S2,MB5,F]  266-7-273ms    | [S2,MB4,B]  290-19-309ms   | [S2,MB6,F]  313-7-320ms    | [S2,MB5,B]  336-19-355ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  381-19-401ms   | [S2,MB7,B]  426-16-442ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-35-188ms   | [S3,MB3,F]  192-16-208ms   | [S3,MB3,B]  215-23-238ms   | [S3,MB4,F]  242-15-257ms   | [S3,MB4,B]  263-21-285ms   | [S3,MB5,F]  288-14-303ms   | [S3,MB5,B]  309-21-331ms   | [S3,MB6,F]  334-14-349ms   | [S3,MB6,B]  355-21-377ms   | [S3,MB7,F]  380-14-395ms   | [S3,MB7,B]  401-21-422ms  
[rank3]:2025-12-12 23:04:25,301 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2304_stage3_step700.svg
[rank2]:2025-12-12 23:06:06,846 - INFO - Avg. fwd time: 7.6252 / Avg. bwd time: 16.5288 / Avg. batch time: 445.7010 (ms) / GPU bubble ratio: 56.65%
[rank1]:2025-12-12 23:06:06,879 - INFO - Avg. fwd time: 9.9585 / Avg. bwd time: 19.6653 / Avg. batch time: 481.5182 (ms) / GPU bubble ratio: 50.78%
[rank3]:2025-12-12 23:06:06,818 - INFO - Avg. fwd time: 14.1389 / Avg. bwd time: 28.8161 / Avg. batch time: 416.8827 (ms) / GPU bubble ratio: 17.57%
[rank0]:2025-12-12 23:06:06,908 - INFO - Avg. fwd time: 7.9898 / Avg. bwd time: 12.5875 / Avg. batch time: 511.6683 (ms) / GPU bubble ratio: 67.83%
[rank0]:2025-12-12 23:07:44,757 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 23:07:48,776 - INFO - Avg. fwd time: 7.6272 / Avg. bwd time: 16.5168 / Avg. batch time: 445.0748 (ms) / GPU bubble ratio: 56.60%
[rank1]:2025-12-12 23:07:48,809 - INFO - Avg. fwd time: 9.9620 / Avg. bwd time: 19.6423 / Avg. batch time: 480.8835 (ms) / GPU bubble ratio: 50.75%
[rank3]:2025-12-12 23:07:48,746 - INFO - Avg. fwd time: 14.1430 / Avg. bwd time: 28.7372 / Avg. batch time: 416.2760 (ms) / GPU bubble ratio: 17.59%
[rank0]:2025-12-12 23:07:48,838 - INFO - Avg. fwd time: 7.9932 / Avg. bwd time: 12.5193 / Avg. batch time: 511.0048 (ms) / GPU bubble ratio: 67.89%
[rank0]:2025-12-12 23:07:48,874 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0824  memory: 13.29GiB(27.97%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank2]:2025-12-12 23:07:48,860 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0824  memory:  6.51GiB(13.70%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank1]:2025-12-12 23:07:48,863 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0824  memory:  9.36GiB(19.71%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank3]:2025-12-12 23:07:48,872 - INFO -  step: 750  loss:  0.2307  grad_norm:  0.0824  memory: 17.37GiB(36.56%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank2]:2025-12-12 23:09:30,103 - INFO - Avg. fwd time: 7.6288 / Avg. bwd time: 16.5052 / Avg. batch time: 444.3941 (ms) / GPU bubble ratio: 56.55%
[rank3]:2025-12-12 23:09:30,072 - INFO - Avg. fwd time: 14.1463 / Avg. bwd time: 28.6528 / Avg. batch time: 415.6131 (ms) / GPU bubble ratio: 17.62%
[rank1]:2025-12-12 23:09:30,136 - INFO - Avg. fwd time: 9.9650 / Avg. bwd time: 19.6208 / Avg. batch time: 480.1976 (ms) / GPU bubble ratio: 50.71%
[rank0]:2025-12-12 23:09:30,166 - INFO - Avg. fwd time: 7.9962 / Avg. bwd time: 12.4466 / Avg. batch time: 510.2906 (ms) / GPU bubble ratio: 67.95%
[rank0]:2025-12-12 23:11:08,173 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 23:11:12,178 - INFO - Avg. fwd time: 14.1516 / Avg. bwd time: 28.5852 / Avg. batch time: 415.1138 (ms) / GPU bubble ratio: 17.64%
[rank0]:2025-12-12 23:11:12,271 - INFO - Avg. fwd time: 7.9993 / Avg. bwd time: 12.3864 / Avg. batch time: 509.7425 (ms) / GPU bubble ratio: 68.01%
[rank2]:2025-12-12 23:11:12,208 - INFO - Avg. fwd time: 7.6303 / Avg. bwd time: 16.4940 / Avg. batch time: 443.8773 (ms) / GPU bubble ratio: 56.52%
[rank1]:2025-12-12 23:11:12,241 - INFO - Avg. fwd time: 9.9678 / Avg. bwd time: 19.6002 / Avg. batch time: 479.6731 (ms) / GPU bubble ratio: 50.69%
[rank1]:2025-12-12 23:11:12,296 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0705  memory:  9.36GiB(19.71%)  tps: 8,054  tflops: 62.96  mfu: 20.18%
[rank1]:2025-12-12 23:11:12,297 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0705  tps: 8,239  tflops: 64.41  mfu: 18.83%
[rank1]:2025-12-12 23:11:12,297 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-12 23:11:12,297 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.7_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-12-12 23:11:12,307 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0705  memory: 13.29GiB(27.97%)  tps: 8,054  tflops: 62.96  mfu: 20.18%
[rank0]:2025-12-12 23:11:12,307 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0705  tps: 8,238  tflops: 64.40  mfu: 18.83%
[rank0]:2025-12-12 23:11:12,307 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-12 23:11:12,308 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.7_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-12-12 23:11:12,293 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0705  memory:  6.51GiB(13.70%)  tps: 8,054  tflops: 62.96  mfu: 20.18%
[rank2]:2025-12-12 23:11:12,293 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0705  tps: 8,239  tflops: 64.40  mfu: 18.83%
[rank2]:2025-12-12 23:11:12,293 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-12 23:11:12,294 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.7_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-12-12 23:11:12,305 - INFO -  step: 800  loss:  0.2347  grad_norm:  0.0705  memory: 17.37GiB(36.56%)  tps: 8,054  tflops: 62.96  mfu: 20.18%
[rank3]:2025-12-12 23:11:12,306 - INFO -  final step: 800  loss:  0.2347  grad_norm:  0.0705  tps: 8,246  tflops: 64.46  mfu: 19.00%
[rank3]:2025-12-12 23:11:12,306 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-12 23:11:12,307 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.7_42_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-12-12 23:11:14,189 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-12 23:11:14,262 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank0/251212_2311_stage0_final800.svg
[rank2]:2025-12-12 23:11:14,263 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank2/251212_2311_stage2_final800.svg
[rank1]:2025-12-12 23:11:14,262 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank1/251212_2311_stage1_final800.svg
[rank3]:2025-12-12 23:11:14,342 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2311_real_final800_rank3.svg
[rank3]:			> Batch Time: 494.92 ms, GPU Bubble Ratio: 70.06%, 53.08%, 61.39%, 34.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  236-0-236ms    | [S0,MB6,F]  236-6-243ms    | [S0,MB3,B]  303-0-303ms    | [S0,MB7,F]  303-6-310ms    | [S0,MB4,B]  351-23-375ms   | [S0,MB5,B]  396-23-420ms   | [S0,MB6,B]  440-18-459ms   | [S0,MB7,B]  478-16-494ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-98ms     | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  220-10-231ms   | [S1,MB5,F]  234-8-243ms    | [S1,MB3,B]  273-24-297ms   | [S1,MB6,F]  301-9-310ms    | [S1,MB4,B]  321-24-346ms   | [S1,MB7,F]  349-9-359ms    | [S1,MB5,B]  368-24-392ms   | [S1,MB6,B]  412-24-436ms   | [S1,MB7,B]  453-20-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  196-19-215ms   | [S2,MB4,F]  218-6-225ms    | [S2,MB3,B]  248-19-267ms   | [S2,MB5,F]  271-7-278ms    | [S2,MB4,B]  297-19-316ms   | [S2,MB6,F]  320-7-327ms    | [S2,MB5,B]  343-19-362ms   | [S2,MB7,F]  366-7-373ms    | [S2,MB6,B]  389-19-408ms   | [S2,MB7,B]  434-16-450ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-37-190ms   | [S3,MB3,F]  194-15-209ms   | [S3,MB3,B]  216-26-243ms   | [S3,MB4,F]  247-15-262ms   | [S3,MB4,B]  268-22-291ms   | [S3,MB5,F]  295-14-310ms   | [S3,MB5,B]  316-21-338ms   | [S3,MB6,F]  342-14-356ms   | [S3,MB6,B]  362-21-384ms   | [S3,MB7,F]  388-14-402ms   | [S3,MB7,B]  408-21-430ms  
[rank1]:2025-12-12 23:11:14,415 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251212_2311_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank0]:2025-12-12 23:11:14,419 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251212_2311_rank0_stage0.svg
[rank0]:	> Counts Sum: 321040, Total Sum: 1728640 (18.57%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.03, 19.86, 20.71, 20.03, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.12, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.06, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank2]:2025-12-12 23:11:14,420 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251212_2311_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank3]:2025-12-12 23:11:14,472 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/pipeline_schedule/251212_2311_thry_final800_rank3.svg
[rank3]:			> Batch Time: 329.22 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  99-19-119ms    | [S0,MB4,F]  119-9-129ms    | [S0,MB1,B]  129-19-149ms   | [S0,MB5,F]  149-9-159ms    | [S0,MB2,B]  159-19-179ms   | [S0,MB6,F]  179-9-189ms    | [S0,MB3,B]  189-19-209ms   | [S0,MB7,F]  209-9-219ms    | [S0,MB4,B]  219-19-239ms   | [S0,MB5,B]  249-19-269ms   | [S0,MB6,B]  279-19-299ms   | [S0,MB7,B]  309-19-329ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB0,B]  79-19-99ms     | [S1,MB3,F]  99-9-109ms     | [S1,MB1,B]  109-19-129ms   | [S1,MB4,F]  129-9-139ms    | [S1,MB2,B]  139-19-159ms   | [S1,MB5,F]  159-9-169ms    | [S1,MB3,B]  169-19-189ms   | [S1,MB6,F]  189-9-199ms    | [S1,MB4,B]  199-19-219ms   | [S1,MB7,F]  219-9-229ms    | [S1,MB5,B]  229-19-249ms   | [S1,MB6,B]  259-19-279ms   | [S1,MB7,B]  289-19-309ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB0,B]  59-19-79ms     | [S2,MB2,F]  79-9-89ms      | [S2,MB1,B]  89-19-109ms    | [S2,MB3,F]  109-9-119ms    | [S2,MB2,B]  119-19-139ms   | [S2,MB4,F]  139-9-149ms    | [S2,MB3,B]  149-19-169ms   | [S2,MB5,F]  169-9-179ms    | [S2,MB4,B]  179-19-199ms   | [S2,MB6,F]  199-9-209ms    | [S2,MB5,B]  209-19-229ms   | [S2,MB7,F]  229-9-239ms    | [S2,MB6,B]  239-19-259ms   | [S2,MB7,B]  269-19-289ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB0,B]  39-19-59ms     | [S3,MB1,F]  59-9-69ms      | [S3,MB1,B]  69-19-89ms     | [S3,MB2,F]  89-9-99ms      | [S3,MB2,B]  99-19-119ms    | [S3,MB3,F]  119-9-129ms    | [S3,MB3,B]  129-19-149ms   | [S3,MB4,F]  149-9-159ms    | [S3,MB4,B]  159-19-179ms   | [S3,MB5,F]  179-9-189ms    | [S3,MB5,B]  189-19-209ms   | [S3,MB6,F]  209-9-219ms    | [S3,MB6,B]  219-19-239ms   | [S3,MB7,F]  239-9-249ms    | [S3,MB7,B]  249-19-269ms  
[rank3]:2025-12-12 23:11:14,519 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_ratio_history/rank3/251212_2311_stage3_final800.svg
[rank3]:2025-12-12 23:11:14,656 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/frozen_params_histogram/251212_2311_rank3_stage3.svg
[rank3]:	> Counts Sum: 894080, Total Sum: 1354880 (65.99%), Ratio(%) per element: [65.92, 65.58, 65.41, 67.29, 64.72, 66.95, 65.92, 65.23, 66.6, 65.23, 66.78, 65.75, 67.8, 64.89, 66.78, 64.89, 66.95, 65.92, 66.26, 65.23, 66.95, 65.58, 65.92, 65.75, 66.6, 65.23, 65.75, 64.55, 67.12]
[rank0]:2025-12-12 23:11:16,287 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251212_2311_stage0.svg
[rank1]:2025-12-12 23:11:16,291 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251212_2311_stage1.svg
[rank1]:2025-12-12 23:11:16,294 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 23:11:16,290 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-12 23:11:16,296 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251212_2311_stage2.svg
[rank2]:2025-12-12 23:11:16,299 - INFO - Destroying the purge thread.
[rank3]:2025-12-12 23:11:16,506 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1/afr_time_plot/251212_2311_stage3.svg
[rank3]:2025-12-12 23:11:16,510 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-12-12 23:11:16,693 - INFO - Process group destroyed
[rank2]:2025-12-12 23:11:16,697 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 315-340
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.97385
[rank3]:wandb:               final/avg_loss 0.23465
[rank3]:wandb:             final/avg_mfu(%) 18.99556
[rank3]:wandb:             final/avg_tflops 64.46268
[rank3]:wandb:    final/avg_throughput(tps) 8245.90366
[rank3]:wandb:              final/grad_norm 0.07048
[rank3]:wandb:               final/max_loss 0.23465
[rank3]:wandb:                    grad_norm 0.07048
[rank3]:wandb: loss_metrics/global_avg_loss 0.23465
[rank3]:wandb: loss_metrics/global_max_loss 0.23465
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1212_1F1B_fullrand7_mfr0.7_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/jije6bvg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.7_42_dm1/20251212-2214/wandb/run-20251212_221453-jije6bvg/logs
[rank0]:2025-12-12 23:11:18,290 - INFO - Training completed
[rank0]:2025-12-12 23:11:18,290 - INFO - Destroying the purge thread.
[rank3]:2025-12-12 23:11:18,344 - INFO - Process group destroyed
[rank0]:2025-12-12 23:11:18,714 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.7', 'layers.6', 'layers.5', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.9', 'layers.10', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.3', 'layers.2', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'output', 'layers.14', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1212_1F1B_fullrand7_mfr0.7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
