
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 12. (ê¸ˆ) 05:42:36 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1212_1F1B_fullrand7_mfr0.6_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.6) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.6
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-12 05:42:42,499 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:"
[rank2]:2025-12-12 05:42:42,499 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank0]:2025-12-12 05:42:42,665 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:"
[rank1]:2025-12-12 05:42:42,715 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 05:42:42,717 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-12 05:42:42,727 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-12 05:42:42,729 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-12 05:42:42,703 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank0]:2025-12-12 05:42:42,859 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-12 05:42:42,862 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 05:42:42,864 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-12 05:42:42,866 - INFO - Loading tokenizer from tokenizer.json
[rank3]:2025-12-12 05:42:42,906 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 05:42:42,909 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 05:42:43,257 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-12 05:42:46,370 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-12 05:42:46,380 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-12 05:42:46,411 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 05:42:46,438 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-12 05:42:46,438 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 05:42:46,419 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 05:42:46,449 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-12 05:42:46,449 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 05:42:46,557 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-12 05:42:46,623 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 05:42:46,623 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-12 05:42:46,624 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-12 05:42:46,641 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 05:42:46,641 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-12 05:42:46,642 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-12 05:42:46,707 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 05:42:46,746 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 05:42:46,747 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-12 05:42:46,773 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-12 05:42:46,773 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 05:42:46,969 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 05:42:46,970 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 05:42:46,970 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run f13s3m4i
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.6_42_dm1/20251212-0542/wandb/run-20251212_054247-f13s3m4i
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/f13s3m4i
[rank3]:2025-12-12 05:42:48,703 - INFO - WandB logging enabled
[rank3]:2025-12-12 05:42:48,704 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-12 05:42:48,743 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 05:42:48,773 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-12 05:42:48,773 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-12 05:42:48,982 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-12 05:42:48,982 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 05:42:48,981 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:2025-12-12 05:42:48,964 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 05:42:48,965 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 05:42:48,982 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-12 05:42:48,966 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-12 05:42:48,982 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 05:42:48,982 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-12 05:42:48,982 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-12 05:42:51,117 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-12 05:42:51,117 - INFO - Finished loading the checkpoint in 2.14 seconds.
[rank0]:2025-12-12 05:42:51,118 - INFO - Training starts at step 1
[rank0]:2025-12-12 05:42:56,774 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory:  9.19GiB(19.34%)  tps: 3,268  tflops: 25.54  mfu: 8.19%
[rank0]:2025-12-12 05:42:56,775 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 05:42:56,741 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory:  6.76GiB(14.24%)  tps: 3,175  tflops: 24.82  mfu: 7.95%
[rank1]:2025-12-12 05:42:56,741 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 05:42:56,747 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5371  memory: 12.97GiB(27.31%)  tps: 4,096  tflops: 32.02  mfu: 10.26%
[rank3]:2025-12-12 05:42:56,747 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-12 05:42:56,736 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory:  4.63GiB(9.75%)  tps: 3,174  tflops: 24.81  mfu: 7.95%
[rank2]:2025-12-12 05:42:56,737 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 05:44:58,751 - INFO - Avg. fwd time: 13.2873 / Avg. bwd time: 41.7019 / Avg. batch time: 512.3925 (ms) / GPU bubble ratio: 14.15%
[rank1]:2025-12-12 05:44:58,803 - INFO - Avg. fwd time: 9.3178 / Avg. bwd time: 23.8848 / Avg. batch time: 583.3576 (ms) / GPU bubble ratio: 54.47%
[rank0]:2025-12-12 05:44:58,832 - INFO - Avg. fwd time: 7.3441 / Avg. bwd time: 23.5416 / Avg. batch time: 620.3827 (ms) / GPU bubble ratio: 60.17%
[rank2]:2025-12-12 05:44:58,775 - INFO - Avg. fwd time: 7.2723 / Avg. bwd time: 18.9508 / Avg. batch time: 544.4204 (ms) / GPU bubble ratio: 61.47%
[rank0]:2025-12-12 05:47:01,667 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 05:47:06,693 - INFO - Avg. fwd time: 7.2719 / Avg. bwd time: 18.9900 / Avg. batch time: 546.2759 (ms) / GPU bubble ratio: 61.54%
[rank1]:2025-12-12 05:47:06,721 - INFO - Avg. fwd time: 9.3297 / Avg. bwd time: 23.9490 / Avg. batch time: 584.9066 (ms) / GPU bubble ratio: 54.48%
[rank3]:2025-12-12 05:47:06,669 - INFO - Avg. fwd time: 13.3951 / Avg. bwd time: 41.8823 / Avg. batch time: 514.6037 (ms) / GPU bubble ratio: 14.07%
[rank2]:2025-12-12 05:47:06,771 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.4932  memory:  6.43GiB(13.53%)  tps: 6,422  tflops: 50.20  mfu: 16.09%
[rank0]:2025-12-12 05:47:06,750 - INFO - Avg. fwd time: 7.3459 / Avg. bwd time: 23.5740 / Avg. batch time: 621.5900 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-12-12 05:47:06,785 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.4932  memory: 12.97GiB(27.31%)  tps: 6,422  tflops: 50.21  mfu: 16.09%
[rank1]:2025-12-12 05:47:06,774 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.4932  memory:  9.03GiB(19.01%)  tps: 6,422  tflops: 50.20  mfu: 16.09%
[rank3]:2025-12-12 05:47:06,783 - INFO -  step: 50  loss:  9.9052  grad_norm: 12.4932  memory: 16.39GiB(34.50%)  tps: 6,422  tflops: 50.20  mfu: 16.09%
[rank3]:2025-12-12 05:47:57,940 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-12 05:48:49,291 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-12 05:48:49,415 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-12 05:49:06,507 - INFO - Avg. fwd time: 13.5002 / Avg. bwd time: 40.6153 / Avg. batch time: 505.2695 (ms) / GPU bubble ratio: 14.32%
[rank2]:2025-12-12 05:49:06,521 - INFO - Avg. fwd time: 7.3684 / Avg. bwd time: 18.3170 / Avg. batch time: 536.1228 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-12-12 05:49:06,541 - INFO - Avg. fwd time: 7.4300 / Avg. bwd time: 22.0322 / Avg. batch time: 608.7582 (ms) / GPU bubble ratio: 61.28%
[rank1]:2025-12-12 05:49:06,536 - INFO - Avg. fwd time: 9.4462 / Avg. bwd time: 23.1125 / Avg. batch time: 573.7823 (ms) / GPU bubble ratio: 54.60%
[rank3]:2025-12-12 05:49:23,629 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-12 05:49:23,801 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0549_max_batch_time.svg
[rank3]:			> Batch Time: 536.67 ms, GPU Bubble Ratio: 53.78%, 50.44%, 60.84%, 17.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-200ms   | [S0,MB5,F]  200-6-207ms    | [S0,MB2,B]  231-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  287-23-311ms   | [S0,MB7,F]  311-6-318ms    | [S0,MB4,B]  343-23-367ms   | [S0,MB5,B]  399-23-423ms   | [S0,MB6,B]  456-23-480ms   | [S0,MB7,B]  513-23-536ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  207-24-231ms   | [S1,MB5,F]  231-9-241ms    | [S1,MB3,B]  263-24-287ms   | [S1,MB6,F]  287-9-296ms    | [S1,MB4,B]  319-24-343ms   | [S1,MB7,F]  343-8-352ms    | [S1,MB5,B]  375-24-399ms   | [S1,MB6,B]  432-23-456ms   | [S1,MB7,B]  489-23-513ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  188-18-207ms   | [S2,MB4,F]  207-6-214ms    | [S2,MB3,B]  244-19-263ms   | [S2,MB5,F]  263-6-270ms    | [S2,MB4,B]  300-19-319ms   | [S2,MB6,F]  319-6-326ms    | [S2,MB5,B]  356-19-375ms   | [S2,MB7,F]  375-7-382ms    | [S2,MB6,B]  413-19-432ms   | [S2,MB7,B]  470-19-489ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-188ms   AFR(10):0.9655 | [S3,MB3,F]  188-13-202ms   | [S3,MB3,B]  202-42-244ms   AFR(10):0.9655 | [S3,MB4,F]  244-13-258ms   | [S3,MB4,B]  258-41-300ms   AFR(10):0.9655 | [S3,MB5,F]  300-14-314ms   | [S3,MB5,B]  314-42-356ms   AFR(10):0.9655 | [S3,MB6,F]  356-13-370ms   | [S3,MB6,B]  370-43-413ms   AFR(10):0.9655 | [S3,MB7,F]  413-13-427ms   | [S3,MB7,B]  427-42-470ms   AFR(10):0.9655
[rank3]:2025-12-12 05:49:23,926 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0549_min_batch_time.svg
[rank3]:			> Batch Time: 327.87 ms, GPU Bubble Ratio: 82.19%, 50.92%, 61.51%, 14.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-156ms    | [S0,MB3,B]  184-0-184ms    | [S0,MB7,F]  184-6-191ms    | [S0,MB4,B]  220-0-220ms    | [S0,MB5,B]  257-0-257ms    | [S0,MB6,B]  292-0-292ms    | [S0,MB7,B]  327-0-327ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-124ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-9-159ms    | [S1,MB3,B]  173-11-184ms   | [S1,MB6,F]  184-9-193ms    | [S1,MB4,B]  209-10-220ms   | [S1,MB7,F]  220-8-229ms    | [S1,MB5,B]  246-11-257ms   | [S1,MB6,B]  281-10-292ms   | [S1,MB7,B]  317-10-327ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  63-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-6-111ms    | [S2,MB2,B]  130-8-139ms    | [S2,MB4,F]  139-6-146ms    | [S2,MB3,B]  165-8-173ms    | [S2,MB5,F]  173-6-180ms    | [S2,MB4,B]  200-8-209ms    | [S2,MB6,F]  209-6-216ms    | [S2,MB5,B]  237-8-246ms    | [S2,MB7,F]  246-7-253ms    | [S2,MB6,B]  272-8-281ms    | [S2,MB7,B]  308-8-317ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-63ms     AFR(10):0.9655 | [S3,MB1,F]  63-10-74ms     | [S3,MB1,B]  74-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-109ms    | [S3,MB2,B]  109-21-130ms   AFR(10):0.9655 | [S3,MB3,F]  130-13-143ms   | [S3,MB3,B]  143-21-165ms   AFR(10):0.9655 | [S3,MB4,F]  165-13-179ms   | [S3,MB4,B]  179-21-200ms   AFR(10):0.9655 | [S3,MB5,F]  200-14-215ms   | [S3,MB5,B]  215-22-237ms   AFR(10):0.9655 | [S3,MB6,F]  237-13-250ms   | [S3,MB6,B]  250-21-272ms   AFR(10):0.9655 | [S3,MB7,F]  272-13-286ms   | [S3,MB7,B]  286-21-308ms   AFR(10):0.9655
[rank3]:2025-12-12 05:49:24,064 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0549_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 389.89 ms, GPU Bubble Ratio: 45.42%, 35.14%, 48.80%, 12.42%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-200ms   | [S0,MB5,F]  200-6-207ms    | [S0,MB2,B]  211-23-235ms   | [S0,MB6,F]  235-6-242ms    | [S0,MB3,B]  246-23-270ms   | [S0,MB7,F]  270-6-277ms    | [S0,MB4,B]  285-23-309ms   | [S0,MB5,B]  342-23-366ms   | [S0,MB6,B]  377-12-389ms   | [S0,MB7,B]  389-0-389ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  187-24-211ms   | [S1,MB5,F]  211-9-220ms    | [S1,MB3,B]  222-24-246ms   | [S1,MB6,F]  246-9-255ms    | [S1,MB4,B]  261-24-285ms   | [S1,MB7,F]  285-8-294ms    | [S1,MB5,B]  318-24-342ms   | [S1,MB6,B]  353-23-377ms   | [S1,MB7,B]  379-10-389ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  168-18-187ms   | [S2,MB4,F]  187-6-194ms    | [S2,MB3,B]  203-19-222ms   | [S2,MB5,F]  222-6-229ms    | [S2,MB4,B]  242-19-261ms   | [S2,MB6,F]  261-6-268ms    | [S2,MB5,B]  299-19-318ms   | [S2,MB7,F]  318-7-325ms    | [S2,MB6,B]  334-19-353ms   | [S2,MB7,B]  370-8-379ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-21-168ms   AFR(10):0.9655 | [S3,MB3,F]  168-13-181ms   | [S3,MB3,B]  181-21-203ms   AFR(10):0.9655 | [S3,MB4,F]  203-13-217ms   | [S3,MB4,B]  217-25-242ms   AFR(10):0.9655 | [S3,MB5,F]  242-14-257ms   | [S3,MB5,B]  257-42-299ms   AFR(10):0.9655 | [S3,MB6,F]  299-13-313ms   | [S3,MB6,B]  313-21-334ms   AFR(10):0.9655 | [S3,MB7,F]  334-13-348ms   | [S3,MB7,B]  348-21-370ms   AFR(10):0.9655
[rank3]:2025-12-12 05:49:24,064 - INFO - 	> Batch Time: 389.89 ms (Average Freeze Ratio: 0.26, Time Reduction Rate: 0.27)
[rank0]:2025-12-12 05:50:49,974 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:50:54,735 - INFO - Avg. fwd time: 13.6039 / Avg. bwd time: 38.2990 / Avg. batch time: 487.6590 (ms) / GPU bubble ratio: 14.85%
[rank3]:2025-12-12 05:50:54,740 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.21(0.27)/0.80, [MB5] 0.00(0.00)/0.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-12 05:50:54,759 - INFO - Avg. fwd time: 7.4732 / Avg. bwd time: 17.5990 / Avg. batch time: 518.2106 (ms) / GPU bubble ratio: 61.29%
[rank2]:2025-12-12 05:50:54,765 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-12 05:50:54,834 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1816  memory:  6.51GiB(13.70%)  tps: 7,184  tflops: 56.16  mfu: 18.00%
[rank0]:2025-12-12 05:50:54,812 - INFO - Avg. fwd time: 7.5639 / Avg. bwd time: 19.4317 / Avg. batch time: 587.9460 (ms) / GPU bubble ratio: 63.27%
[rank0]:2025-12-12 05:50:54,819 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-12 05:50:54,848 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1816  memory: 12.97GiB(27.31%)  tps: 7,184  tflops: 56.16  mfu: 18.00%
[rank1]:2025-12-12 05:50:54,788 - INFO - Avg. fwd time: 9.5915 / Avg. bwd time: 22.0469 / Avg. batch time: 554.9877 (ms) / GPU bubble ratio: 54.39%
[rank1]:2025-12-12 05:50:54,794 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-12 05:50:54,837 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1816  memory:  9.36GiB(19.71%)  tps: 7,184  tflops: 56.16  mfu: 18.00%
[rank3]:2025-12-12 05:50:54,846 - INFO -  step: 100  loss:  8.6857  grad_norm:  8.1816  memory: 17.37GiB(36.56%)  tps: 7,184  tflops: 56.16  mfu: 18.00%
[rank2]:2025-12-12 05:50:54,908 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0550_stage2_step100.svg
[rank0]:2025-12-12 05:50:54,907 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0550_stage0_step100.svg
[rank1]:2025-12-12 05:50:54,908 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0550_stage1_step100.svg
[rank3]:2025-12-12 05:50:54,984 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0550_real_step100_rank3.svg
[rank3]:			> Batch Time: 599.77 ms, GPU Bubble Ratio: 64.60%, 56.71%, 65.70%, 29.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  139-16-155ms   | [S0,MB4,F]  156-7-163ms    | [S0,MB1,B]  200-16-216ms   | [S0,MB5,F]  216-6-223ms    | [S0,MB2,B]  266-16-282ms   | [S0,MB6,F]  282-6-289ms    | [S0,MB3,B]  330-16-347ms   | [S0,MB7,F]  347-6-354ms    | [S0,MB4,B]  393-23-417ms   | [S0,MB5,B]  455-23-479ms   | [S0,MB6,B]  519-19-538ms   | [S0,MB7,B]  580-19-599ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-45ms      | [S1,MB0,B]  113-21-134ms   | [S1,MB3,F]  137-9-147ms    | [S1,MB1,B]  173-21-195ms   | [S1,MB4,F]  198-9-207ms    | [S1,MB2,B]  240-21-261ms   | [S1,MB5,F]  264-9-274ms    | [S1,MB3,B]  301-24-325ms   | [S1,MB6,F]  329-9-338ms    | [S1,MB4,B]  364-24-388ms   | [S1,MB7,F]  392-9-401ms    | [S1,MB5,B]  428-24-452ms   | [S1,MB6,B]  491-24-515ms   | [S1,MB7,B]  553-23-577ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  91-16-107ms    | [S2,MB2,F]  111-7-118ms    | [S2,MB1,B]  152-16-168ms   | [S2,MB3,F]  172-6-179ms    | [S2,MB2,B]  215-19-234ms   | [S2,MB4,F]  238-7-245ms    | [S2,MB3,B]  277-19-296ms   | [S2,MB5,F]  300-7-307ms    | [S2,MB4,B]  340-19-359ms   | [S2,MB6,F]  362-7-369ms    | [S2,MB5,B]  404-19-423ms   | [S2,MB7,F]  427-7-434ms    | [S2,MB6,B]  469-19-488ms   | [S2,MB7,B]  531-18-549ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-86ms     | [S3,MB1,F]  90-11-101ms    | [S3,MB1,B]  107-40-147ms   | [S3,MB2,F]  151-12-163ms   | [S3,MB2,B]  169-41-210ms   | [S3,MB3,F]  214-13-228ms   | [S3,MB3,B]  234-38-272ms   | [S3,MB4,F]  276-13-289ms   | [S3,MB4,B]  296-38-335ms   | [S3,MB5,F]  338-14-352ms   | [S3,MB5,B]  359-39-398ms   | [S3,MB6,F]  403-13-416ms   | [S3,MB6,B]  422-41-464ms   | [S3,MB7,F]  467-14-482ms   | [S3,MB7,B]  487-40-527ms  
[rank3]:2025-12-12 05:50:55,027 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0550_stage3_step100.svg
[rank2]:2025-12-12 05:52:52,686 - INFO - Avg. fwd time: 7.4579 / Avg. bwd time: 17.7060 / Avg. batch time: 514.8002 (ms) / GPU bubble ratio: 60.90%
[rank3]:2025-12-12 05:52:52,662 - INFO - Avg. fwd time: 13.6521 / Avg. bwd time: 37.7803 / Avg. batch time: 484.2048 (ms) / GPU bubble ratio: 15.02%
[rank0]:2025-12-12 05:52:52,738 - INFO - Avg. fwd time: 7.5763 / Avg. bwd time: 19.5480 / Avg. batch time: 584.7337 (ms) / GPU bubble ratio: 62.89%
[rank1]:2025-12-12 05:52:52,714 - INFO - Avg. fwd time: 9.5825 / Avg. bwd time: 22.1049 / Avg. batch time: 551.6949 (ms) / GPU bubble ratio: 54.05%
[rank0]:2025-12-12 05:54:42,410 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 05:54:46,794 - INFO - Avg. fwd time: 13.7208 / Avg. bwd time: 37.0979 / Avg. batch time: 479.3356 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-12 05:54:46,817 - INFO - Avg. fwd time: 7.4679 / Avg. bwd time: 17.6227 / Avg. batch time: 509.7205 (ms) / GPU bubble ratio: 60.62%
[rank2]:2025-12-12 05:54:46,823 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-12 05:54:46,844 - INFO - Avg. fwd time: 9.6086 / Avg. bwd time: 21.9135 / Avg. batch time: 546.5276 (ms) / GPU bubble ratio: 53.86%
[rank1]:2025-12-12 05:54:46,851 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-12 05:54:46,799 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.48(0.53)/0.80, [MB5] 0.00(0.00)/0.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-12 05:54:46,893 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.9449  memory:  6.51GiB(13.70%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank0]:2025-12-12 05:54:46,872 - INFO - Avg. fwd time: 7.6295 / Avg. bwd time: 19.3224 / Avg. batch time: 579.4816 (ms) / GPU bubble ratio: 62.79%
[rank0]:2025-12-12 05:54:46,879 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 05:54:46,907 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.9449  memory: 13.29GiB(27.97%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank1]:2025-12-12 05:54:46,897 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.9449  memory:  9.36GiB(19.71%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank3]:2025-12-12 05:54:46,905 - INFO -  step: 150  loss:  3.8830  grad_norm:  3.9449  memory: 17.37GiB(36.56%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank3]:2025-12-12 05:56:37,898 - INFO - Avg. fwd time: 13.7841 / Avg. bwd time: 36.3355 / Avg. batch time: 473.9801 (ms) / GPU bubble ratio: 15.41%
[rank2]:2025-12-12 05:56:37,921 - INFO - Avg. fwd time: 7.4768 / Avg. bwd time: 17.5707 / Avg. batch time: 504.2242 (ms) / GPU bubble ratio: 60.26%
[rank1]:2025-12-12 05:56:37,948 - INFO - Avg. fwd time: 9.6434 / Avg. bwd time: 21.6748 / Avg. batch time: 540.9284 (ms) / GPU bubble ratio: 53.68%
[rank0]:2025-12-12 05:56:37,971 - INFO - Avg. fwd time: 7.6755 / Avg. bwd time: 18.9185 / Avg. batch time: 573.5416 (ms) / GPU bubble ratio: 62.91%
[rank0]:2025-12-12 05:58:20,469 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 05:58:24,743 - INFO - Avg. fwd time: 13.8572 / Avg. bwd time: 35.4533 / Avg. batch time: 467.5881 (ms) / GPU bubble ratio: 15.63%
[rank3]:2025-12-12 05:58:24,749 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.76(0.80)/0.80, [MB5] 0.00(0.00)/0.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 05:58:24,794 - INFO - Avg. fwd time: 9.6879 / Avg. bwd time: 21.3922 / Avg. batch time: 534.1878 (ms) / GPU bubble ratio: 53.45%
[rank1]:2025-12-12 05:58:24,801 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-12 05:58:24,767 - INFO - Avg. fwd time: 7.4981 / Avg. bwd time: 17.4250 / Avg. batch time: 497.6417 (ms) / GPU bubble ratio: 59.93%
[rank2]:2025-12-12 05:58:24,773 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank0]:2025-12-12 05:58:24,818 - INFO - Avg. fwd time: 7.7258 / Avg. bwd time: 18.2827 / Avg. batch time: 566.4598 (ms) / GPU bubble ratio: 63.27%
[rank0]:2025-12-12 05:58:24,825 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-12 05:58:24,853 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.3598  memory: 13.29GiB(27.97%)  tps: 7,517  tflops: 58.77  mfu: 18.84%
[rank3]:2025-12-12 05:58:24,851 - INFO -  step: 200  loss:  1.2533  grad_norm:  2.3598  memory: 17.37GiB(36.56%)  tps: 7,518  tflops: 58.77  mfu: 18.84%
[rank1]:2025-12-12 05:58:24,843 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.3598  memory:  9.36GiB(19.71%)  tps: 7,517  tflops: 58.77  mfu: 18.84%
[rank1]:2025-12-12 05:58:24,903 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0558_stage1_step200.svg
[rank2]:2025-12-12 05:58:24,839 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.3598  memory:  6.51GiB(13.70%)  tps: 7,517  tflops: 58.77  mfu: 18.84%
[rank2]:2025-12-12 05:58:24,902 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0558_stage2_step200.svg
[rank0]:2025-12-12 05:58:24,903 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0558_stage0_step200.svg
[rank3]:2025-12-12 05:58:24,993 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0558_real_step200_rank3.svg
[rank3]:			> Batch Time: 518.95 ms, GPU Bubble Ratio: 67.72%, 54.38%, 63.13%, 31.77%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  106-4-111ms    | [S0,MB4,F]  111-8-120ms    | [S0,MB1,B]  170-4-175ms    | [S0,MB5,F]  175-6-181ms    | [S0,MB2,B]  236-4-241ms    | [S0,MB6,F]  241-6-248ms    | [S0,MB3,B]  299-4-303ms    | [S0,MB7,F]  304-6-310ms    | [S0,MB4,B]  347-23-370ms   | [S0,MB5,B]  401-23-424ms   | [S0,MB6,B]  459-18-477ms   | [S0,MB7,B]  502-16-518ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  88-12-101ms    | [S1,MB3,F]  104-10-115ms   | [S1,MB1,B]  152-12-165ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  218-12-231ms   | [S1,MB5,F]  235-8-243ms    | [S1,MB3,B]  268-24-293ms   | [S1,MB6,F]  297-9-306ms    | [S1,MB4,B]  317-24-341ms   | [S1,MB7,F]  345-9-355ms    | [S1,MB5,B]  373-24-397ms   | [S1,MB6,B]  431-24-455ms   | [S1,MB7,B]  477-21-498ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  75-8-83ms      | [S2,MB2,F]  87-8-96ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  194-19-213ms   | [S2,MB4,F]  217-6-224ms    | [S2,MB3,B]  244-19-263ms   | [S2,MB5,F]  267-7-274ms    | [S2,MB4,B]  292-19-312ms   | [S2,MB6,F]  315-7-322ms    | [S2,MB5,B]  348-19-367ms   | [S2,MB7,F]  371-6-378ms    | [S2,MB6,B]  409-19-428ms   | [S2,MB7,B]  458-16-474ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-21-69ms     | [S3,MB1,F]  73-13-87ms     | [S3,MB1,B]  93-40-133ms    | [S3,MB2,F]  137-11-148ms   | [S3,MB2,B]  154-35-189ms   | [S3,MB3,F]  193-17-210ms   | [S3,MB3,B]  216-22-239ms   | [S3,MB4,F]  243-15-258ms   | [S3,MB4,B]  264-22-287ms   | [S3,MB5,F]  291-12-304ms   | [S3,MB5,B]  310-33-344ms   | [S3,MB6,F]  347-14-362ms   | [S3,MB6,B]  367-36-403ms   | [S3,MB7,F]  407-18-426ms   | [S3,MB7,B]  432-23-455ms  
[rank3]:2025-12-12 05:58:25,039 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0558_stage3_step200.svg
[rank3]:2025-12-12 06:00:10,189 - INFO - Avg. fwd time: 13.9128 / Avg. bwd time: 34.6752 / Avg. batch time: 461.8043 (ms) / GPU bubble ratio: 15.83%
[rank2]:2025-12-12 06:00:10,212 - INFO - Avg. fwd time: 7.5191 / Avg. bwd time: 17.2888 / Avg. batch time: 491.7778 (ms) / GPU bubble ratio: 59.64%
[rank0]:2025-12-12 06:00:10,262 - INFO - Avg. fwd time: 7.7691 / Avg. bwd time: 17.4183 / Avg. batch time: 560.1100 (ms) / GPU bubble ratio: 64.03%
[rank1]:2025-12-12 06:00:10,239 - INFO - Avg. fwd time: 9.7308 / Avg. bwd time: 21.1151 / Avg. batch time: 528.1673 (ms) / GPU bubble ratio: 53.28%
[rank0]:2025-12-12 06:01:50,284 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 06:01:54,372 - INFO - Avg. fwd time: 7.5353 / Avg. bwd time: 17.1808 / Avg. batch time: 486.4883 (ms) / GPU bubble ratio: 59.36%
[rank2]:2025-12-12 06:01:54,378 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-12 06:01:54,349 - INFO - Avg. fwd time: 13.9497 / Avg. bwd time: 33.9904 / Avg. batch time: 456.6109 (ms) / GPU bubble ratio: 16.01%
[rank3]:2025-12-12 06:01:54,354 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.79(0.80)/0.80, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 06:01:54,423 - INFO - Avg. fwd time: 7.8027 / Avg. bwd time: 16.7084 / Avg. batch time: 554.4302 (ms) / GPU bubble ratio: 64.63%
[rank0]:2025-12-12 06:01:54,430 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 06:01:54,399 - INFO - Avg. fwd time: 9.7640 / Avg. bwd time: 20.8954 / Avg. batch time: 522.7520 (ms) / GPU bubble ratio: 53.08%
[rank1]:2025-12-12 06:01:54,406 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 06:01:54,448 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.3433  memory:  9.36GiB(19.71%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank2]:2025-12-12 06:01:54,444 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.3433  memory:  6.51GiB(13.70%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank3]:2025-12-12 06:01:54,457 - INFO -  step: 250  loss:  0.4524  grad_norm:  0.3433  memory: 17.37GiB(36.56%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank0]:2025-12-12 06:01:54,459 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.3433  memory: 13.29GiB(27.97%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank3]:2025-12-12 06:03:38,659 - INFO - Avg. fwd time: 13.9767 / Avg. bwd time: 33.4366 / Avg. batch time: 452.4284 (ms) / GPU bubble ratio: 16.16%
[rank1]:2025-12-12 06:03:38,712 - INFO - Avg. fwd time: 9.7918 / Avg. bwd time: 20.7144 / Avg. batch time: 518.3823 (ms) / GPU bubble ratio: 52.92%
[rank2]:2025-12-12 06:03:38,684 - INFO - Avg. fwd time: 7.5480 / Avg. bwd time: 17.0919 / Avg. batch time: 482.2268 (ms) / GPU bubble ratio: 59.12%
[rank0]:2025-12-12 06:03:38,736 - INFO - Avg. fwd time: 7.8291 / Avg. bwd time: 16.1428 / Avg. batch time: 549.8444 (ms) / GPU bubble ratio: 65.12%
[rank0]:2025-12-12 06:05:18,780 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 06:05:22,849 - INFO - Avg. fwd time: 13.9996 / Avg. bwd time: 32.9715 / Avg. batch time: 448.8969 (ms) / GPU bubble ratio: 16.29%
[rank3]:2025-12-12 06:05:22,857 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.79(0.80)/0.80, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 06:05:22,925 - INFO - Avg. fwd time: 7.8518 / Avg. bwd time: 15.6699 / Avg. batch time: 545.9739 (ms) / GPU bubble ratio: 65.53%
[rank2]:2025-12-12 06:05:22,873 - INFO - Avg. fwd time: 7.5585 / Avg. bwd time: 17.0181 / Avg. batch time: 478.6255 (ms) / GPU bubble ratio: 58.92%
[rank2]:2025-12-12 06:05:22,879 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 06:05:22,947 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1292  memory:  6.51GiB(13.70%)  tps: 7,858  tflops: 61.43  mfu: 19.69%
[rank1]:2025-12-12 06:05:22,901 - INFO - Avg. fwd time: 9.8146 / Avg. bwd time: 20.5652 / Avg. batch time: 514.6919 (ms) / GPU bubble ratio: 52.78%
[rank1]:2025-12-12 06:05:22,908 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 06:05:22,950 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1292  memory:  9.36GiB(19.71%)  tps: 7,858  tflops: 61.43  mfu: 19.69%
[rank3]:2025-12-12 06:05:22,959 - INFO -  step: 300  loss:  0.3006  grad_norm:  0.1292  memory: 17.37GiB(36.56%)  tps: 7,858  tflops: 61.43  mfu: 19.69%
[rank0]:2025-12-12 06:05:22,933 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 06:05:22,961 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1292  memory: 13.29GiB(27.97%)  tps: 7,858  tflops: 61.43  mfu: 19.69%
[rank0]:2025-12-12 06:05:23,009 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0605_stage0_step300.svg
[rank2]:2025-12-12 06:05:23,011 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0605_stage2_step300.svg
[rank1]:2025-12-12 06:05:23,010 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0605_stage1_step300.svg
[rank3]:2025-12-12 06:05:23,096 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0605_real_step300_rank3.svg
[rank3]:			> Batch Time: 502.00 ms, GPU Bubble Ratio: 70.59%, 53.76%, 61.90%, 33.15%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  234-0-234ms    | [S0,MB6,F]  234-6-241ms    | [S0,MB3,B]  296-0-296ms    | [S0,MB7,F]  296-6-303ms    | [S0,MB4,B]  344-23-367ms   | [S0,MB5,B]  389-23-413ms   | [S0,MB6,B]  444-18-462ms   | [S0,MB7,B]  485-16-502ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  218-10-229ms   | [S1,MB5,F]  232-8-241ms    | [S1,MB3,B]  267-24-291ms   | [S1,MB6,F]  295-9-304ms    | [S1,MB4,B]  313-24-338ms   | [S1,MB7,F]  342-9-352ms    | [S1,MB5,B]  360-25-386ms   | [S1,MB6,B]  415-24-439ms   | [S1,MB7,B]  460-20-481ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  193-19-213ms   | [S2,MB4,F]  216-6-223ms    | [S2,MB3,B]  243-19-262ms   | [S2,MB5,F]  265-7-272ms    | [S2,MB4,B]  289-19-309ms   | [S2,MB6,F]  312-7-319ms    | [S2,MB5,B]  336-19-356ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  393-19-412ms   | [S2,MB7,B]  441-16-457ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-35-188ms   | [S3,MB3,F]  192-16-209ms   | [S3,MB3,B]  215-22-238ms   | [S3,MB4,F]  241-15-256ms   | [S3,MB4,B]  262-21-284ms   | [S3,MB5,F]  288-14-302ms   | [S3,MB5,B]  308-23-331ms   | [S3,MB6,F]  335-11-346ms   | [S3,MB6,B]  352-35-387ms   | [S3,MB7,F]  391-17-408ms   | [S3,MB7,B]  415-22-437ms  
[rank3]:2025-12-12 06:05:23,138 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0605_stage3_step300.svg
[rank3]:2025-12-12 06:07:07,884 - INFO - Avg. fwd time: 14.0197 / Avg. bwd time: 32.6088 / Avg. batch time: 446.2085 (ms) / GPU bubble ratio: 16.40%
[rank0]:2025-12-12 06:07:07,962 - INFO - Avg. fwd time: 7.8706 / Avg. bwd time: 15.2530 / Avg. batch time: 543.0195 (ms) / GPU bubble ratio: 65.93%
[rank2]:2025-12-12 06:07:07,909 - INFO - Avg. fwd time: 7.5671 / Avg. bwd time: 16.9546 / Avg. batch time: 475.9074 (ms) / GPU bubble ratio: 58.78%
[rank1]:2025-12-12 06:07:07,937 - INFO - Avg. fwd time: 9.8332 / Avg. bwd time: 20.4359 / Avg. batch time: 511.8941 (ms) / GPU bubble ratio: 52.69%
[rank0]:2025-12-12 06:08:49,235 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 06:08:53,427 - INFO - Avg. fwd time: 14.0502 / Avg. bwd time: 32.3231 / Avg. batch time: 444.1390 (ms) / GPU bubble ratio: 16.47%
[rank2]:2025-12-12 06:08:53,452 - INFO - Avg. fwd time: 7.5747 / Avg. bwd time: 16.8994 / Avg. batch time: 473.7651 (ms) / GPU bubble ratio: 58.67%
[rank0]:2025-12-12 06:08:53,505 - INFO - Avg. fwd time: 7.8872 / Avg. bwd time: 14.8974 / Avg. batch time: 540.6788 (ms) / GPU bubble ratio: 66.29%
[rank1]:2025-12-12 06:08:53,480 - INFO - Avg. fwd time: 9.8489 / Avg. bwd time: 20.3252 / Avg. batch time: 509.6885 (ms) / GPU bubble ratio: 52.64%
[rank1]:2025-12-12 06:08:53,530 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1008  memory:  9.36GiB(19.71%)  tps: 7,780  tflops: 60.82  mfu: 19.49%
[rank3]:2025-12-12 06:08:53,539 - INFO -  step: 350  loss:  0.2300  grad_norm:  0.1008  memory: 17.37GiB(36.56%)  tps: 7,781  tflops: 60.82  mfu: 19.50%
[rank2]:2025-12-12 06:08:53,526 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1008  memory:  6.51GiB(13.70%)  tps: 7,780  tflops: 60.82  mfu: 19.49%
[rank0]:2025-12-12 06:08:53,540 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1008  memory: 13.29GiB(27.97%)  tps: 7,780  tflops: 60.82  mfu: 19.49%
[rank3]:2025-12-12 06:10:38,521 - INFO - Avg. fwd time: 14.0680 / Avg. bwd time: 32.0614 / Avg. batch time: 442.1904 (ms) / GPU bubble ratio: 16.54%
[rank2]:2025-12-12 06:10:38,546 - INFO - Avg. fwd time: 7.5814 / Avg. bwd time: 16.8515 / Avg. batch time: 471.7584 (ms) / GPU bubble ratio: 58.57%
[rank1]:2025-12-12 06:10:38,575 - INFO - Avg. fwd time: 9.8626 / Avg. bwd time: 20.2289 / Avg. batch time: 507.6261 (ms) / GPU bubble ratio: 52.58%
[rank0]:2025-12-12 06:10:38,600 - INFO - Avg. fwd time: 7.9014 / Avg. bwd time: 14.6020 / Avg. batch time: 538.4994 (ms) / GPU bubble ratio: 66.57%
[rank0]:2025-12-12 06:12:19,491 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 06:12:23,701 - INFO - Avg. fwd time: 14.0867 / Avg. bwd time: 31.8298 / Avg. batch time: 440.5006 (ms) / GPU bubble ratio: 16.61%
[rank2]:2025-12-12 06:12:23,726 - INFO - Avg. fwd time: 7.5873 / Avg. bwd time: 16.8091 / Avg. batch time: 470.0209 (ms) / GPU bubble ratio: 58.48%
[rank2]:2025-12-12 06:12:23,802 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0611  memory:  6.51GiB(13.70%)  tps: 7,792  tflops: 60.91  mfu: 19.52%
[rank1]:2025-12-12 06:12:23,755 - INFO - Avg. fwd time: 9.8739 / Avg. bwd time: 20.1437 / Avg. batch time: 505.8385 (ms) / GPU bubble ratio: 52.53%
[rank1]:2025-12-12 06:12:23,805 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0611  memory:  9.36GiB(19.71%)  tps: 7,792  tflops: 60.91  mfu: 19.52%
[rank0]:2025-12-12 06:12:23,780 - INFO - Avg. fwd time: 7.9140 / Avg. bwd time: 14.3307 / Avg. batch time: 536.6107 (ms) / GPU bubble ratio: 66.84%
[rank0]:2025-12-12 06:12:23,816 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0611  memory: 13.29GiB(27.97%)  tps: 7,792  tflops: 60.91  mfu: 19.52%
[rank3]:2025-12-12 06:12:23,814 - INFO -  step: 400  loss:  0.2138  grad_norm:  0.0611  memory: 17.37GiB(36.56%)  tps: 7,792  tflops: 60.91  mfu: 19.52%
[rank2]:2025-12-12 06:12:23,868 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0612_stage2_step400.svg
[rank1]:2025-12-12 06:12:23,868 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0612_stage1_step400.svg
[rank0]:2025-12-12 06:12:23,868 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0612_stage0_step400.svg
[rank3]:2025-12-12 06:12:23,951 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0612_real_step400_rank3.svg
[rank3]:			> Batch Time: 511.45 ms, GPU Bubble Ratio: 71.26%, 54.78%, 62.68%, 31.96%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-173ms    | [S0,MB2,B]  233-0-233ms    | [S0,MB6,F]  233-6-240ms    | [S0,MB3,B]  296-0-296ms    | [S0,MB7,F]  296-6-303ms    | [S0,MB4,B]  343-23-367ms   | [S0,MB5,B]  398-23-421ms   | [S0,MB6,B]  454-18-472ms   | [S0,MB7,B]  494-16-511ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  217-10-228ms   | [S1,MB5,F]  231-8-240ms    | [S1,MB3,B]  266-24-291ms   | [S1,MB6,F]  294-9-304ms    | [S1,MB4,B]  313-24-338ms   | [S1,MB7,F]  341-9-351ms    | [S1,MB5,B]  369-24-394ms   | [S1,MB6,B]  425-24-450ms   | [S1,MB7,B]  470-20-491ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  193-19-212ms   | [S2,MB4,F]  215-6-222ms    | [S2,MB3,B]  242-19-262ms   | [S2,MB5,F]  265-7-272ms    | [S2,MB4,B]  289-19-308ms   | [S2,MB6,F]  312-7-319ms    | [S2,MB5,B]  345-19-364ms   | [S2,MB7,F]  368-7-375ms    | [S2,MB6,B]  403-19-422ms   | [S2,MB7,B]  451-16-467ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  153-35-188ms   | [S3,MB3,F]  191-17-209ms   | [S3,MB3,B]  215-22-237ms   | [S3,MB4,F]  241-14-256ms   | [S3,MB4,B]  262-21-284ms   | [S3,MB5,F]  288-12-300ms   | [S3,MB5,B]  307-33-340ms   | [S3,MB6,F]  344-13-357ms   | [S3,MB6,B]  362-35-398ms   | [S3,MB7,F]  402-18-420ms   | [S3,MB7,B]  425-22-447ms  
[rank3]:2025-12-12 06:12:23,998 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0612_stage3_step400.svg
[rank3]:2025-12-12 06:12:47,528 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 06:12:47,761 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-12 06:12:47,780 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 06:12:47,738 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-12 06:14:07,676 - INFO - Avg. fwd time: 14.0958 / Avg. bwd time: 31.5883 / Avg. batch time: 438.6331 (ms) / GPU bubble ratio: 16.68%
[rank2]:2025-12-12 06:14:07,701 - INFO - Avg. fwd time: 7.5922 / Avg. bwd time: 16.7713 / Avg. batch time: 468.1489 (ms) / GPU bubble ratio: 58.37%
[rank1]:2025-12-12 06:14:07,730 - INFO - Avg. fwd time: 9.8834 / Avg. bwd time: 20.0690 / Avg. batch time: 503.9193 (ms) / GPU bubble ratio: 52.45%
[rank0]:2025-12-12 06:14:07,755 - INFO - Avg. fwd time: 7.9252 / Avg. bwd time: 14.1033 / Avg. batch time: 534.6030 (ms) / GPU bubble ratio: 67.04%
[rank0]:2025-12-12 06:15:47,329 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 06:15:51,386 - INFO - Avg. fwd time: 14.1026 / Avg. bwd time: 31.3704 / Avg. batch time: 436.9322 (ms) / GPU bubble ratio: 16.74%
[rank2]:2025-12-12 06:15:51,412 - INFO - Avg. fwd time: 7.5964 / Avg. bwd time: 16.7375 / Avg. batch time: 466.4141 (ms) / GPU bubble ratio: 58.26%
[rank1]:2025-12-12 06:15:51,446 - INFO - Avg. fwd time: 9.8918 / Avg. bwd time: 20.0026 / Avg. batch time: 502.1395 (ms) / GPU bubble ratio: 52.37%
[rank1]:2025-12-12 06:15:51,497 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0753  memory:  9.36GiB(19.71%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank3]:2025-12-12 06:15:51,505 - INFO -  step: 450  loss:  0.2265  grad_norm:  0.0753  memory: 17.37GiB(36.56%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank0]:2025-12-12 06:15:51,472 - INFO - Avg. fwd time: 7.9352 / Avg. bwd time: 13.8886 / Avg. batch time: 532.7483 (ms) / GPU bubble ratio: 67.23%
[rank0]:2025-12-12 06:15:51,508 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0753  memory: 13.29GiB(27.97%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank2]:2025-12-12 06:15:51,493 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0753  memory:  6.51GiB(13.70%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank3]:2025-12-12 06:17:35,136 - INFO - Avg. fwd time: 14.1089 / Avg. bwd time: 31.1769 / Avg. batch time: 435.4189 (ms) / GPU bubble ratio: 16.80%
[rank2]:2025-12-12 06:17:35,163 - INFO - Avg. fwd time: 7.6002 / Avg. bwd time: 16.7069 / Avg. batch time: 464.8684 (ms) / GPU bubble ratio: 58.17%
[rank1]:2025-12-12 06:17:35,192 - INFO - Avg. fwd time: 9.8996 / Avg. bwd time: 19.9433 / Avg. batch time: 500.5569 (ms) / GPU bubble ratio: 52.30%
[rank0]:2025-12-12 06:17:35,219 - INFO - Avg. fwd time: 7.9439 / Avg. bwd time: 13.6990 / Avg. batch time: 531.0943 (ms) / GPU bubble ratio: 67.40%
[rank0]:2025-12-12 06:19:14,852 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-12 06:19:18,970 - INFO - Avg. fwd time: 9.9068 / Avg. bwd time: 19.8901 / Avg. batch time: 499.1393 (ms) / GPU bubble ratio: 52.24%
[rank2]:2025-12-12 06:19:18,940 - INFO - Avg. fwd time: 7.6038 / Avg. bwd time: 16.6792 / Avg. batch time: 463.4825 (ms) / GPU bubble ratio: 58.09%
[rank3]:2025-12-12 06:19:18,914 - INFO - Avg. fwd time: 14.1164 / Avg. bwd time: 31.0016 / Avg. batch time: 434.0643 (ms) / GPU bubble ratio: 16.85%
[rank0]:2025-12-12 06:19:18,997 - INFO - Avg. fwd time: 7.9518 / Avg. bwd time: 13.5373 / Avg. batch time: 529.6126 (ms) / GPU bubble ratio: 67.54%
[rank0]:2025-12-12 06:19:19,033 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0853  memory: 13.29GiB(27.97%)  tps: 7,895  tflops: 61.72  mfu: 19.78%
[rank1]:2025-12-12 06:19:19,022 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0853  memory:  9.36GiB(19.71%)  tps: 7,895  tflops: 61.72  mfu: 19.78%
[rank2]:2025-12-12 06:19:19,018 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0853  memory:  6.51GiB(13.70%)  tps: 7,895  tflops: 61.72  mfu: 19.78%
[rank3]:2025-12-12 06:19:19,031 - INFO -  step: 500  loss:  0.2191  grad_norm:  0.0853  memory: 17.37GiB(36.56%)  tps: 7,895  tflops: 61.72  mfu: 19.78%
[rank0]:2025-12-12 06:19:19,080 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0619_stage0_step500.svg
[rank1]:2025-12-12 06:19:19,080 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0619_stage1_step500.svg
[rank2]:2025-12-12 06:19:19,080 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0619_stage2_step500.svg
[rank3]:2025-12-12 06:19:19,171 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0619_real_step500_rank3.svg
[rank3]:			> Batch Time: 501.97 ms, GPU Bubble Ratio: 70.50%, 53.84%, 61.98%, 33.03%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  233-0-233ms    | [S0,MB6,F]  233-6-240ms    | [S0,MB3,B]  296-0-296ms    | [S0,MB7,F]  296-6-303ms    | [S0,MB4,B]  344-23-367ms   | [S0,MB5,B]  389-23-413ms   | [S0,MB6,B]  443-18-462ms   | [S0,MB7,B]  485-16-501ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  217-10-228ms   | [S1,MB5,F]  232-8-240ms    | [S1,MB3,B]  267-24-291ms   | [S1,MB6,F]  295-9-304ms    | [S1,MB4,B]  314-24-338ms   | [S1,MB7,F]  342-9-351ms    | [S1,MB5,B]  361-24-385ms   | [S1,MB6,B]  415-24-439ms   | [S1,MB7,B]  461-20-481ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  193-19-212ms   | [S2,MB4,F]  216-6-223ms    | [S2,MB3,B]  242-19-261ms   | [S2,MB5,F]  265-7-272ms    | [S2,MB4,B]  289-19-309ms   | [S2,MB6,F]  312-7-319ms    | [S2,MB5,B]  336-19-355ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  392-19-412ms   | [S2,MB7,B]  442-16-458ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-35-188ms   | [S3,MB3,F]  191-17-209ms   | [S3,MB3,B]  215-22-237ms   | [S3,MB4,F]  241-14-256ms   | [S3,MB4,B]  262-22-284ms   | [S3,MB5,F]  288-14-302ms   | [S3,MB5,B]  308-22-331ms   | [S3,MB6,F]  335-11-346ms   | [S3,MB6,B]  352-35-387ms   | [S3,MB7,F]  391-17-409ms   | [S3,MB7,B]  414-22-437ms  
[rank3]:2025-12-12 06:19:19,215 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0619_stage3_step500.svg
[rank2]:2025-12-12 06:21:02,998 - INFO - Avg. fwd time: 7.6070 / Avg. bwd time: 16.6540 / Avg. batch time: 462.2786 (ms) / GPU bubble ratio: 58.01%
[rank3]:2025-12-12 06:21:02,972 - INFO - Avg. fwd time: 14.1205 / Avg. bwd time: 30.8464 / Avg. batch time: 432.8606 (ms) / GPU bubble ratio: 16.89%
[rank0]:2025-12-12 06:21:03,056 - INFO - Avg. fwd time: 7.9590 / Avg. bwd time: 13.3999 / Avg. batch time: 528.3217 (ms) / GPU bubble ratio: 67.66%
[rank1]:2025-12-12 06:21:03,029 - INFO - Avg. fwd time: 9.9132 / Avg. bwd time: 19.8413 / Avg. batch time: 497.9071 (ms) / GPU bubble ratio: 52.19%
[rank0]:2025-12-12 06:22:42,823 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 06:22:46,947 - INFO - Avg. fwd time: 7.6100 / Avg. bwd time: 16.6305 / Avg. batch time: 461.1706 (ms) / GPU bubble ratio: 57.95%
[rank3]:2025-12-12 06:22:46,920 - INFO - Avg. fwd time: 14.1249 / Avg. bwd time: 30.7058 / Avg. batch time: 431.7752 (ms) / GPU bubble ratio: 16.94%
[rank0]:2025-12-12 06:22:47,006 - INFO - Avg. fwd time: 7.9653 / Avg. bwd time: 13.2662 / Avg. batch time: 527.1336 (ms) / GPU bubble ratio: 67.78%
[rank1]:2025-12-12 06:22:46,978 - INFO - Avg. fwd time: 9.9193 / Avg. bwd time: 19.7968 / Avg. batch time: 496.7722 (ms) / GPU bubble ratio: 52.15%
[rank1]:2025-12-12 06:22:47,031 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0677  memory:  9.36GiB(19.71%)  tps: 7,877  tflops: 61.58  mfu: 19.74%
[rank2]:2025-12-12 06:22:47,027 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0677  memory:  6.51GiB(13.70%)  tps: 7,877  tflops: 61.58  mfu: 19.74%
[rank3]:2025-12-12 06:22:47,040 - INFO -  step: 550  loss:  0.2238  grad_norm:  0.0677  memory: 17.37GiB(36.56%)  tps: 7,877  tflops: 61.58  mfu: 19.74%
[rank0]:2025-12-12 06:22:47,042 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0677  memory: 13.29GiB(27.97%)  tps: 7,877  tflops: 61.58  mfu: 19.74%
[rank3]:2025-12-12 06:24:30,576 - INFO - Avg. fwd time: 14.1296 / Avg. bwd time: 30.5716 / Avg. batch time: 430.7261 (ms) / GPU bubble ratio: 16.98%
[rank1]:2025-12-12 06:24:30,634 - INFO - Avg. fwd time: 9.9248 / Avg. bwd time: 19.7563 / Avg. batch time: 495.6751 (ms) / GPU bubble ratio: 52.10%
[rank2]:2025-12-12 06:24:30,603 - INFO - Avg. fwd time: 7.6128 / Avg. bwd time: 16.6092 / Avg. batch time: 460.0965 (ms) / GPU bubble ratio: 57.88%
[rank0]:2025-12-12 06:24:30,662 - INFO - Avg. fwd time: 7.9712 / Avg. bwd time: 13.1360 / Avg. batch time: 525.9871 (ms) / GPU bubble ratio: 67.90%
[rank0]:2025-12-12 06:26:10,144 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 06:26:14,267 - INFO - Avg. fwd time: 14.1331 / Avg. bwd time: 30.4495 / Avg. batch time: 429.7672 (ms) / GPU bubble ratio: 17.01%
[rank2]:2025-12-12 06:26:14,294 - INFO - Avg. fwd time: 7.6153 / Avg. bwd time: 16.5894 / Avg. batch time: 459.1172 (ms) / GPU bubble ratio: 57.82%
[rank1]:2025-12-12 06:26:14,326 - INFO - Avg. fwd time: 9.9297 / Avg. bwd time: 19.7191 / Avg. batch time: 494.6753 (ms) / GPU bubble ratio: 52.05%
[rank2]:2025-12-12 06:26:14,375 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0905  memory:  6.51GiB(13.70%)  tps: 7,902  tflops: 61.77  mfu: 19.80%
[rank1]:2025-12-12 06:26:14,379 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0905  memory:  9.36GiB(19.71%)  tps: 7,902  tflops: 61.77  mfu: 19.80%
[rank0]:2025-12-12 06:26:14,354 - INFO - Avg. fwd time: 7.9764 / Avg. bwd time: 13.0243 / Avg. batch time: 524.9413 (ms) / GPU bubble ratio: 68.00%
[rank0]:2025-12-12 06:26:14,390 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0905  memory: 13.29GiB(27.97%)  tps: 7,902  tflops: 61.77  mfu: 19.80%
[rank0]:2025-12-12 06:26:14,440 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0626_stage0_step600.svg
[rank3]:2025-12-12 06:26:14,388 - INFO -  step: 600  loss:  0.2210  grad_norm:  0.0905  memory: 17.37GiB(36.56%)  tps: 7,902  tflops: 61.77  mfu: 19.80%
[rank2]:2025-12-12 06:26:14,439 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0626_stage2_step600.svg
[rank1]:2025-12-12 06:26:14,439 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0626_stage1_step600.svg
[rank3]:2025-12-12 06:26:14,530 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0626_real_step600_rank3.svg
[rank3]:			> Batch Time: 501.47 ms, GPU Bubble Ratio: 69.80%, 53.92%, 62.03%, 33.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-111ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  232-0-232ms    | [S0,MB6,F]  232-6-239ms    | [S0,MB3,B]  295-0-295ms    | [S0,MB7,F]  295-6-302ms    | [S0,MB4,B]  343-23-367ms   | [S0,MB5,B]  389-23-413ms   | [S0,MB6,B]  443-22-465ms   | [S0,MB7,B]  484-16-501ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  164-8-173ms    | [S1,MB2,B]  216-10-227ms   | [S1,MB5,F]  231-8-239ms    | [S1,MB3,B]  266-24-290ms   | [S1,MB6,F]  293-9-303ms    | [S1,MB4,B]  313-24-338ms   | [S1,MB7,F]  341-9-351ms    | [S1,MB5,B]  361-24-385ms   | [S1,MB6,B]  414-24-439ms   | [S1,MB7,B]  460-20-481ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  192-19-211ms   | [S2,MB4,F]  215-6-222ms    | [S2,MB3,B]  242-19-261ms   | [S2,MB5,F]  264-7-271ms    | [S2,MB4,B]  289-19-308ms   | [S2,MB6,F]  311-6-318ms    | [S2,MB5,B]  336-19-356ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  392-19-411ms   | [S2,MB7,B]  441-16-457ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-85ms     | [S3,MB1,B]  91-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  152-35-187ms   | [S3,MB3,F]  191-17-208ms   | [S3,MB3,B]  214-22-237ms   | [S3,MB4,F]  240-15-255ms   | [S3,MB4,B]  261-21-283ms   | [S3,MB5,F]  287-14-301ms   | [S3,MB5,B]  308-23-331ms   | [S3,MB6,F]  335-11-346ms   | [S3,MB6,B]  352-35-388ms   | [S3,MB7,F]  391-16-407ms   | [S3,MB7,B]  415-22-437ms  
[rank3]:2025-12-12 06:26:14,575 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0626_stage3_step600.svg
[rank2]:2025-12-12 06:27:58,061 - INFO - Avg. fwd time: 7.6176 / Avg. bwd time: 16.5715 / Avg. batch time: 458.2190 (ms) / GPU bubble ratio: 57.77%
[rank3]:2025-12-12 06:27:58,033 - INFO - Avg. fwd time: 14.1365 / Avg. bwd time: 30.3354 / Avg. batch time: 428.8668 (ms) / GPU bubble ratio: 17.04%
[rank1]:2025-12-12 06:27:58,093 - INFO - Avg. fwd time: 9.9341 / Avg. bwd time: 19.6852 / Avg. batch time: 493.7601 (ms) / GPU bubble ratio: 52.01%
[rank0]:2025-12-12 06:27:58,121 - INFO - Avg. fwd time: 7.9812 / Avg. bwd time: 12.9140 / Avg. batch time: 523.9838 (ms) / GPU bubble ratio: 68.10%
[rank0]:2025-12-12 06:29:37,705 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 06:29:41,776 - INFO - Avg. fwd time: 14.1411 / Avg. bwd time: 30.2313 / Avg. batch time: 428.0613 (ms) / GPU bubble ratio: 17.07%
[rank2]:2025-12-12 06:29:41,804 - INFO - Avg. fwd time: 7.6198 / Avg. bwd time: 16.5548 / Avg. batch time: 457.3940 (ms) / GPU bubble ratio: 57.72%
[rank2]:2025-12-12 06:29:41,886 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0699  memory:  6.51GiB(13.70%)  tps: 7,896  tflops: 61.72  mfu: 19.78%
[rank1]:2025-12-12 06:29:41,836 - INFO - Avg. fwd time: 9.9379 / Avg. bwd time: 19.6534 / Avg. batch time: 492.9185 (ms) / GPU bubble ratio: 51.97%
[rank1]:2025-12-12 06:29:41,890 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0699  memory:  9.36GiB(19.71%)  tps: 7,896  tflops: 61.72  mfu: 19.78%
[rank0]:2025-12-12 06:29:41,865 - INFO - Avg. fwd time: 7.9855 / Avg. bwd time: 12.8191 / Avg. batch time: 523.1029 (ms) / GPU bubble ratio: 68.18%
[rank0]:2025-12-12 06:29:41,900 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0699  memory: 13.29GiB(27.97%)  tps: 7,896  tflops: 61.72  mfu: 19.78%
[rank3]:2025-12-12 06:29:41,899 - INFO -  step: 650  loss:  0.2312  grad_norm:  0.0699  memory: 17.37GiB(36.56%)  tps: 7,896  tflops: 61.72  mfu: 19.78%
[rank3]:2025-12-12 06:31:25,522 - INFO - Avg. fwd time: 14.1443 / Avg. bwd time: 30.1360 / Avg. batch time: 427.3206 (ms) / GPU bubble ratio: 17.10%
[rank2]:2025-12-12 06:31:25,551 - INFO - Avg. fwd time: 7.6216 / Avg. bwd time: 16.5391 / Avg. batch time: 456.6360 (ms) / GPU bubble ratio: 57.67%
[rank1]:2025-12-12 06:31:25,583 - INFO - Avg. fwd time: 9.9413 / Avg. bwd time: 19.6239 / Avg. batch time: 492.1462 (ms) / GPU bubble ratio: 51.94%
[rank0]:2025-12-12 06:31:25,612 - INFO - Avg. fwd time: 7.9894 / Avg. bwd time: 12.7240 / Avg. batch time: 522.2930 (ms) / GPU bubble ratio: 68.27%
[rank0]:2025-12-12 06:33:05,177 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 06:33:09,236 - INFO - Avg. fwd time: 14.1466 / Avg. bwd time: 30.0468 / Avg. batch time: 426.6183 (ms) / GPU bubble ratio: 17.13%
[rank2]:2025-12-12 06:33:09,266 - INFO - Avg. fwd time: 7.6233 / Avg. bwd time: 16.5245 / Avg. batch time: 455.9179 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-12-12 06:33:09,349 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0713  memory:  6.51GiB(13.70%)  tps: 7,897  tflops: 61.74  mfu: 19.79%
[rank1]:2025-12-12 06:33:09,298 - INFO - Avg. fwd time: 9.9442 / Avg. bwd time: 19.5965 / Avg. batch time: 491.4157 (ms) / GPU bubble ratio: 51.91%
[rank1]:2025-12-12 06:33:09,353 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0713  memory:  9.36GiB(19.71%)  tps: 7,897  tflops: 61.74  mfu: 19.79%
[rank3]:2025-12-12 06:33:09,361 - INFO -  step: 700  loss:  0.1916  grad_norm:  0.0713  memory: 17.37GiB(36.56%)  tps: 7,897  tflops: 61.74  mfu: 19.79%
[rank0]:2025-12-12 06:33:09,327 - INFO - Avg. fwd time: 7.9930 / Avg. bwd time: 12.6415 / Avg. batch time: 521.5287 (ms) / GPU bubble ratio: 68.35%
[rank0]:2025-12-12 06:33:09,364 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0713  memory: 13.29GiB(27.97%)  tps: 7,897  tflops: 61.74  mfu: 19.79%
[rank0]:2025-12-12 06:33:09,415 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0633_stage0_step700.svg
[rank2]:2025-12-12 06:33:09,419 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0633_stage2_step700.svg
[rank1]:2025-12-12 06:33:09,416 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0633_stage1_step700.svg
[rank3]:2025-12-12 06:33:09,521 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0633_real_step700_rank3.svg
[rank3]:			> Batch Time: 501.17 ms, GPU Bubble Ratio: 69.88%, 53.84%, 61.94%, 33.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  233-0-233ms    | [S0,MB6,F]  233-6-240ms    | [S0,MB3,B]  295-0-295ms    | [S0,MB7,F]  295-6-302ms    | [S0,MB4,B]  342-23-366ms   | [S0,MB5,B]  389-23-412ms   | [S0,MB6,B]  443-21-465ms   | [S0,MB7,B]  484-16-501ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  217-10-228ms   | [S1,MB5,F]  231-8-240ms    | [S1,MB3,B]  266-24-290ms   | [S1,MB6,F]  294-9-303ms    | [S1,MB4,B]  312-24-337ms   | [S1,MB7,F]  341-9-350ms    | [S1,MB5,B]  360-24-385ms   | [S1,MB6,B]  415-24-439ms   | [S1,MB7,B]  460-20-481ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  193-19-212ms   | [S2,MB4,F]  215-7-222ms    | [S2,MB3,B]  242-19-261ms   | [S2,MB5,F]  264-7-271ms    | [S2,MB4,B]  288-19-307ms   | [S2,MB6,F]  311-7-318ms    | [S2,MB5,B]  336-19-355ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  392-19-411ms   | [S2,MB7,B]  441-16-457ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  153-35-188ms   | [S3,MB3,F]  191-16-208ms   | [S3,MB3,B]  214-22-236ms   | [S3,MB4,F]  240-15-255ms   | [S3,MB4,B]  261-21-283ms   | [S3,MB5,F]  287-14-301ms   | [S3,MB5,B]  307-23-331ms   | [S3,MB6,F]  334-11-346ms   | [S3,MB6,B]  352-35-388ms   | [S3,MB7,F]  391-16-407ms   | [S3,MB7,B]  415-22-437ms  
[rank3]:2025-12-12 06:33:09,588 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0633_stage3_step700.svg
[rank3]:2025-12-12 06:34:54,282 - INFO - Avg. fwd time: 14.1502 / Avg. bwd time: 29.9853 / Avg. batch time: 426.1594 (ms) / GPU bubble ratio: 17.15%
[rank2]:2025-12-12 06:34:54,312 - INFO - Avg. fwd time: 7.6247 / Avg. bwd time: 16.5106 / Avg. batch time: 455.4658 (ms) / GPU bubble ratio: 57.61%
[rank1]:2025-12-12 06:34:54,344 - INFO - Avg. fwd time: 9.9468 / Avg. bwd time: 19.5698 / Avg. batch time: 490.9492 (ms) / GPU bubble ratio: 51.90%
[rank0]:2025-12-12 06:34:54,374 - INFO - Avg. fwd time: 7.9964 / Avg. bwd time: 12.5693 / Avg. batch time: 521.0311 (ms) / GPU bubble ratio: 68.42%
[rank0]:2025-12-12 06:36:34,137 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 06:36:38,229 - INFO - Avg. fwd time: 14.1526 / Avg. bwd time: 29.9098 / Avg. batch time: 425.5760 (ms) / GPU bubble ratio: 17.17%
[rank1]:2025-12-12 06:36:38,292 - INFO - Avg. fwd time: 9.9492 / Avg. bwd time: 19.5458 / Avg. batch time: 490.3447 (ms) / GPU bubble ratio: 51.88%
[rank2]:2025-12-12 06:36:38,259 - INFO - Avg. fwd time: 7.6263 / Avg. bwd time: 16.4980 / Avg. batch time: 454.8714 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-12-12 06:36:38,355 - INFO -  step: 750  loss:  0.2306  grad_norm:  0.0808  memory: 17.37GiB(36.56%)  tps: 7,840  tflops: 61.29  mfu: 19.64%
[rank0]:2025-12-12 06:36:38,321 - INFO - Avg. fwd time: 7.9994 / Avg. bwd time: 12.5008 / Avg. batch time: 520.3958 (ms) / GPU bubble ratio: 68.49%
[rank0]:2025-12-12 06:36:38,357 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0808  memory: 13.29GiB(27.97%)  tps: 7,839  tflops: 61.29  mfu: 19.64%
[rank1]:2025-12-12 06:36:38,346 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0808  memory:  9.36GiB(19.71%)  tps: 7,839  tflops: 61.29  mfu: 19.64%
[rank2]:2025-12-12 06:36:38,343 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0808  memory:  6.51GiB(13.70%)  tps: 7,839  tflops: 61.29  mfu: 19.64%
[rank3]:2025-12-12 06:38:23,273 - INFO - Avg. fwd time: 14.1577 / Avg. bwd time: 29.8623 / Avg. batch time: 425.2261 (ms) / GPU bubble ratio: 17.18%
[rank1]:2025-12-12 06:38:23,336 - INFO - Avg. fwd time: 9.9515 / Avg. bwd time: 19.5220 / Avg. batch time: 489.9606 (ms) / GPU bubble ratio: 51.88%
[rank2]:2025-12-12 06:38:23,303 - INFO - Avg. fwd time: 7.6275 / Avg. bwd time: 16.4858 / Avg. batch time: 454.5004 (ms) / GPU bubble ratio: 57.56%
[rank0]:2025-12-12 06:38:23,366 - INFO - Avg. fwd time: 8.0023 / Avg. bwd time: 12.4277 / Avg. batch time: 519.9837 (ms) / GPU bubble ratio: 68.57%
[rank0]:2025-12-12 06:40:03,316 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 06:40:07,438 - INFO - Avg. fwd time: 14.1611 / Avg. bwd time: 29.8005 / Avg. batch time: 424.7511 (ms) / GPU bubble ratio: 17.20%
[rank1]:2025-12-12 06:40:07,502 - INFO - Avg. fwd time: 9.9537 / Avg. bwd time: 19.5007 / Avg. batch time: 489.4609 (ms) / GPU bubble ratio: 51.86%
[rank2]:2025-12-12 06:40:07,468 - INFO - Avg. fwd time: 7.6289 / Avg. bwd time: 16.4745 / Avg. batch time: 454.0101 (ms) / GPU bubble ratio: 57.53%
[rank0]:2025-12-12 06:40:07,533 - INFO - Avg. fwd time: 8.0049 / Avg. bwd time: 12.3670 / Avg. batch time: 519.4578 (ms) / GPU bubble ratio: 68.63%
[rank3]:2025-12-12 06:40:07,566 - INFO -  step: 800  loss:  0.2349  grad_norm:  0.0706  memory: 17.37GiB(36.56%)  tps: 7,831  tflops: 61.22  mfu: 19.62%
[rank3]:2025-12-12 06:40:07,567 - INFO -  final step: 800  loss:  0.2349  grad_norm:  0.0706  tps: 8,100  tflops: 63.32  mfu: 18.65%
[rank3]:2025-12-12 06:40:07,567 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-12 06:40:07,568 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-12 06:40:07,558 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0706  memory:  9.36GiB(19.71%)  tps: 7,831  tflops: 61.22  mfu: 19.62%
[rank1]:2025-12-12 06:40:07,558 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0706  tps: 8,094  tflops: 63.28  mfu: 18.52%
[rank1]:2025-12-12 06:40:07,558 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-12 06:40:07,559 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-12 06:40:07,554 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0706  memory:  6.51GiB(13.70%)  tps: 7,831  tflops: 61.22  mfu: 19.62%
[rank2]:2025-12-12 06:40:07,554 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0706  tps: 8,094  tflops: 63.28  mfu: 18.52%
[rank2]:2025-12-12 06:40:07,554 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-12 06:40:07,555 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 06:40:07,568 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0706  memory: 13.29GiB(27.97%)  tps: 7,831  tflops: 61.22  mfu: 19.62%
[rank0]:2025-12-12 06:40:07,569 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0706  tps: 8,095  tflops: 63.28  mfu: 18.53%
[rank0]:2025-12-12 06:40:07,569 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-12 06:40:07,569 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 06:40:09,527 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-12 06:40:09,598 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251212_0640_stage1_final800.svg
[rank2]:2025-12-12 06:40:09,598 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251212_0640_stage2_final800.svg
[rank0]:2025-12-12 06:40:09,601 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251212_0640_stage0_final800.svg
[rank3]:2025-12-12 06:40:09,686 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0640_real_final800_rank3.svg
[rank3]:			> Batch Time: 505.03 ms, GPU Bubble Ratio: 70.70%, 54.20%, 62.21%, 33.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  234-0-234ms    | [S0,MB6,F]  234-6-241ms    | [S0,MB3,B]  297-0-297ms    | [S0,MB7,F]  297-6-304ms    | [S0,MB4,B]  345-23-369ms   | [S0,MB5,B]  392-23-415ms   | [S0,MB6,B]  447-18-466ms   | [S0,MB7,B]  488-16-505ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  218-10-229ms   | [S1,MB5,F]  232-8-241ms    | [S1,MB3,B]  267-24-292ms   | [S1,MB6,F]  295-9-304ms    | [S1,MB4,B]  315-24-339ms   | [S1,MB7,F]  343-9-353ms    | [S1,MB5,B]  363-24-388ms   | [S1,MB6,B]  419-24-443ms   | [S1,MB7,B]  464-20-484ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  194-19-213ms   | [S2,MB4,F]  216-6-223ms    | [S2,MB3,B]  243-19-262ms   | [S2,MB5,F]  266-7-273ms    | [S2,MB4,B]  290-19-310ms   | [S2,MB6,F]  313-7-320ms    | [S2,MB5,B]  339-19-358ms   | [S2,MB7,F]  362-7-369ms    | [S2,MB6,B]  396-19-415ms   | [S2,MB7,B]  444-16-460ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-35-189ms   | [S3,MB3,F]  192-16-209ms   | [S3,MB3,B]  216-22-238ms   | [S3,MB4,F]  242-15-257ms   | [S3,MB4,B]  263-22-285ms   | [S3,MB5,F]  289-14-303ms   | [S3,MB5,B]  309-23-333ms   | [S3,MB6,F]  337-11-349ms   | [S3,MB6,B]  355-36-391ms   | [S3,MB7,F]  395-16-411ms   | [S3,MB7,B]  417-22-440ms  
[rank1]:2025-12-12 06:40:09,746 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251212_0640_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank2]:2025-12-12 06:40:09,751 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251212_0640_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank0]:2025-12-12 06:40:09,761 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251212_0640_rank0_stage0.svg
[rank0]:	> Counts Sum: 321200, Total Sum: 1728640 (18.58%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.03, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.12, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank3]:2025-12-12 06:40:09,817 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251212_0640_thry_final800_rank3.svg
[rank3]:			> Batch Time: 329.05 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  99-19-119ms    | [S0,MB4,F]  119-9-129ms    | [S0,MB1,B]  129-19-149ms   | [S0,MB5,F]  149-9-159ms    | [S0,MB2,B]  159-19-179ms   | [S0,MB6,F]  179-9-189ms    | [S0,MB3,B]  189-19-209ms   | [S0,MB7,F]  209-9-219ms    | [S0,MB4,B]  219-19-239ms   | [S0,MB5,B]  249-19-269ms   | [S0,MB6,B]  279-19-299ms   | [S0,MB7,B]  309-19-329ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB0,B]  79-19-99ms     | [S1,MB3,F]  99-9-109ms     | [S1,MB1,B]  109-19-129ms   | [S1,MB4,F]  129-9-139ms    | [S1,MB2,B]  139-19-159ms   | [S1,MB5,F]  159-9-169ms    | [S1,MB3,B]  169-19-189ms   | [S1,MB6,F]  189-9-199ms    | [S1,MB4,B]  199-19-219ms   | [S1,MB7,F]  219-9-229ms    | [S1,MB5,B]  229-19-249ms   | [S1,MB6,B]  259-19-279ms   | [S1,MB7,B]  289-19-309ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB0,B]  59-19-79ms     | [S2,MB2,F]  79-9-89ms      | [S2,MB1,B]  89-19-109ms    | [S2,MB3,F]  109-9-119ms    | [S2,MB2,B]  119-19-139ms   | [S2,MB4,F]  139-9-149ms    | [S2,MB3,B]  149-19-169ms   | [S2,MB5,F]  169-9-179ms    | [S2,MB4,B]  179-19-199ms   | [S2,MB6,F]  199-9-209ms    | [S2,MB5,B]  209-19-229ms   | [S2,MB7,F]  229-9-239ms    | [S2,MB6,B]  239-19-259ms   | [S2,MB7,B]  269-19-289ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB0,B]  39-19-59ms     | [S3,MB1,F]  59-9-69ms      | [S3,MB1,B]  69-19-89ms     | [S3,MB2,F]  89-9-99ms      | [S3,MB2,B]  99-19-119ms    | [S3,MB3,F]  119-9-129ms    | [S3,MB3,B]  129-19-149ms   | [S3,MB4,F]  149-9-159ms    | [S3,MB4,B]  159-19-179ms   | [S3,MB5,F]  179-9-189ms    | [S3,MB5,B]  189-19-209ms   | [S3,MB6,F]  209-9-219ms    | [S3,MB6,B]  219-19-239ms   | [S3,MB7,F]  239-9-249ms    | [S3,MB7,B]  249-19-269ms  
[rank3]:2025-12-12 06:40:09,865 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251212_0640_stage3_final800.svg
[rank3]:2025-12-12 06:40:09,999 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251212_0640_rank3_stage3.svg
[rank3]:	> Counts Sum: 769600, Total Sum: 1354880 (56.80%), Ratio(%) per element: [57.7, 57.19, 56.67, 56.67, 55.82, 57.7, 55.99, 56.5, 57.53, 56.84, 57.36, 55.82, 57.87, 55.13, 57.53, 57.02, 58.04, 56.16, 56.5, 56.33, 57.02, 56.84, 57.36, 56.5, 56.5, 56.67, 56.5, 55.65, 57.7]
[rank1]:2025-12-12 06:40:11,593 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251212_0640_stage1.svg
[rank1]:2025-12-12 06:40:11,596 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 06:40:11,631 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251212_0640_stage0.svg
[rank0]:2025-12-12 06:40:11,635 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-12 06:40:11,631 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251212_0640_stage2.svg
[rank2]:2025-12-12 06:40:11,634 - INFO - Destroying the purge thread.
[rank3]:2025-12-12 06:40:11,823 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251212_0640_stage3.svg
[rank3]:2025-12-12 06:40:11,827 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-12 06:40:12,021 - INFO - Process group destroyed
[rank1]:2025-12-12 06:40:12,038 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 315-338
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.04563
[rank3]:wandb:               final/avg_loss 0.23486
[rank3]:wandb:             final/avg_mfu(%) 18.65247
[rank3]:wandb:             final/avg_tflops 63.31894
[rank3]:wandb:    final/avg_throughput(tps) 8099.59973
[rank3]:wandb:              final/grad_norm 0.07063
[rank3]:wandb:               final/max_loss 0.23486
[rank3]:wandb:                    grad_norm 0.07063
[rank3]:wandb: loss_metrics/global_avg_loss 0.23486
[rank3]:wandb: loss_metrics/global_max_loss 0.23486
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1212_1F1B_fullrand7_mfr0.6_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/f13s3m4i
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.6_42_dm1/20251212-0542/wandb/run-20251212_054247-f13s3m4i/logs
[rank3]:2025-12-12 06:40:12,994 - INFO - Process group destroyed
[rank0]:2025-12-12 06:40:13,635 - INFO - Training completed
[rank0]:2025-12-12 06:40:13,635 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 06:40:14,009 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.4', 'layers.8', 'layers.7', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.2', 'layers.1', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'output', 'layers.15', 'layers.13'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1212_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.6
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
