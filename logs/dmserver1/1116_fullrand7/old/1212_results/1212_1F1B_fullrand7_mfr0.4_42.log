
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 12. (ê¸ˆ) 03:42:18 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1212_1F1B_fullrand7_mfr0.4_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.4) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.4
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-12 03:42:24,534 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:"
[rank1]:2025-12-12 03:42:24,534 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:"
[rank2]:2025-12-12 03:42:24,519 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank0]:2025-12-12 03:42:24,837 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 03:42:24,829 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 03:42:24,832 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-12 03:42:24,789 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-12 03:42:24,791 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 03:42:24,839 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 03:42:24,841 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-12 03:42:24,842 - INFO - Loading tokenizer from tokenizer.json
[rank3]:2025-12-12 03:42:24,899 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:2025-12-12 03:42:25,054 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 03:42:25,057 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 03:42:25,225 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-12 03:42:28,110 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-12 03:42:28,261 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 03:42:28,303 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 03:42:28,304 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-12 03:42:28,327 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-12 03:42:28,327 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-12 03:42:28,266 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-12 03:42:28,309 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 03:42:28,333 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-12 03:42:28,333 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 03:42:28,534 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 03:42:28,534 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 03:42:28,535 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-12 03:42:28,535 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 03:42:28,535 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-12 03:42:28,535 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-12 03:42:28,581 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-12 03:42:28,620 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 03:42:28,646 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-12 03:42:28,647 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 03:42:28,831 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 03:42:28,832 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-12 03:42:28,832 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run xy02tfhe
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.4_42_dm1/20251212-0342/wandb/run-20251212_034229-xy02tfhe
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/xy02tfhe
[rank3]:2025-12-12 03:42:30,783 - INFO - WandB logging enabled
[rank3]:2025-12-12 03:42:30,784 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-12 03:42:30,826 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 03:42:30,856 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-12 03:42:30,857 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 03:42:31,067 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 03:42:31,068 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank0]:2025-12-12 03:42:31,068 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 03:42:31,069 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-12 03:42:31,069 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-12 03:42:31,067 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-12 03:42:31,049 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 03:42:31,050 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-12 03:42:31,051 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-12 03:42:31,067 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 03:42:33,034 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-12 03:42:33,034 - INFO - Finished loading the checkpoint in 1.97 seconds.
[rank0]:2025-12-12 03:42:33,034 - INFO - Training starts at step 1
[rank2]:2025-12-12 03:42:38,651 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  4.63GiB(9.75%)  tps: 3,168  tflops: 24.77  mfu: 7.94%
[rank2]:2025-12-12 03:42:38,651 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 03:42:38,660 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 12.97GiB(27.31%)  tps: 4,184  tflops: 32.71  mfu: 10.48%
[rank3]:2025-12-12 03:42:38,660 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 03:42:38,656 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  6.76GiB(14.24%)  tps: 3,265  tflops: 25.53  mfu: 8.18%
[rank1]:2025-12-12 03:42:38,656 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-12 03:42:38,685 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  9.19GiB(19.34%)  tps: 3,156  tflops: 24.68  mfu: 7.91%
[rank0]:2025-12-12 03:42:38,685 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-12 03:44:40,798 - INFO - Avg. fwd time: 13.3009 / Avg. bwd time: 41.7271 / Avg. batch time: 512.7097 (ms) / GPU bubble ratio: 14.14%
[rank2]:2025-12-12 03:44:40,822 - INFO - Avg. fwd time: 7.2740 / Avg. bwd time: 18.9488 / Avg. batch time: 544.7457 (ms) / GPU bubble ratio: 61.49%
[rank1]:2025-12-12 03:44:40,850 - INFO - Avg. fwd time: 9.3808 / Avg. bwd time: 23.9015 / Avg. batch time: 583.7969 (ms) / GPU bubble ratio: 54.39%
[rank0]:2025-12-12 03:44:40,878 - INFO - Avg. fwd time: 7.3524 / Avg. bwd time: 23.5359 / Avg. batch time: 620.8815 (ms) / GPU bubble ratio: 60.20%
[rank0]:2025-12-12 03:46:43,922 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 03:46:48,928 - INFO - Avg. fwd time: 13.4167 / Avg. bwd time: 41.9284 / Avg. batch time: 515.1621 (ms) / GPU bubble ratio: 14.05%
[rank2]:2025-12-12 03:46:48,953 - INFO - Avg. fwd time: 7.2745 / Avg. bwd time: 18.9879 / Avg. batch time: 546.8360 (ms) / GPU bubble ratio: 61.58%
[rank1]:2025-12-12 03:46:48,982 - INFO - Avg. fwd time: 9.3823 / Avg. bwd time: 23.9592 / Avg. batch time: 585.5489 (ms) / GPU bubble ratio: 54.45%
[rank1]:2025-12-12 03:46:49,035 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.9717  memory:  9.03GiB(19.01%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank0]:2025-12-12 03:46:49,010 - INFO - Avg. fwd time: 7.3609 / Avg. bwd time: 23.5726 / Avg. batch time: 622.3119 (ms) / GPU bubble ratio: 60.23%
[rank0]:2025-12-12 03:46:49,046 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.9717  memory: 12.97GiB(27.31%)  tps: 6,413  tflops: 50.14  mfu: 16.07%
[rank3]:2025-12-12 03:46:49,044 - INFO -  step: 50  loss:  9.9225  grad_norm: 12.9717  memory: 16.39GiB(34.50%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank2]:2025-12-12 03:46:49,032 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.9717  memory:  6.43GiB(13.53%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank3]:2025-12-12 03:47:40,197 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-12 03:48:31,559 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-12 03:48:31,681 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-12 03:48:48,816 - INFO - Avg. fwd time: 7.3734 / Avg. bwd time: 18.3169 / Avg. batch time: 536.5223 (ms) / GPU bubble ratio: 61.69%
[rank0]:2025-12-12 03:48:48,837 - INFO - Avg. fwd time: 7.4426 / Avg. bwd time: 22.0308 / Avg. batch time: 609.2948 (ms) / GPU bubble ratio: 61.30%
[rank3]:2025-12-12 03:48:48,801 - INFO - Avg. fwd time: 13.5167 / Avg. bwd time: 40.6455 / Avg. batch time: 505.6639 (ms) / GPU bubble ratio: 14.31%
[rank1]:2025-12-12 03:48:48,832 - INFO - Avg. fwd time: 9.4904 / Avg. bwd time: 23.1211 / Avg. batch time: 574.2542 (ms) / GPU bubble ratio: 54.57%
[rank3]:2025-12-12 03:49:05,954 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-12 03:49:06,128 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0349_max_batch_time.svg
[rank3]:			> Batch Time: 537.88 ms, GPU Bubble Ratio: 53.85%, 50.46%, 60.90%, 17.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-207ms    | [S0,MB2,B]  232-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  288-23-312ms   | [S0,MB7,F]  312-6-318ms    | [S0,MB4,B]  344-23-367ms   | [S0,MB5,B]  400-23-423ms   | [S0,MB6,B]  457-23-481ms   | [S0,MB7,B]  514-23-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  208-24-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  264-24-288ms   | [S1,MB6,F]  288-9-297ms    | [S1,MB4,B]  319-24-344ms   | [S1,MB7,F]  344-9-353ms    | [S1,MB5,B]  376-24-400ms   | [S1,MB6,B]  433-23-457ms   | [S1,MB7,B]  490-23-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  208-6-215ms    | [S2,MB3,B]  245-19-264ms   | [S2,MB5,F]  264-6-271ms    | [S2,MB4,B]  300-19-319ms   | [S2,MB6,F]  319-7-326ms    | [S2,MB5,B]  357-19-376ms   | [S2,MB7,F]  376-7-383ms    | [S2,MB6,B]  414-19-433ms   | [S2,MB7,B]  471-19-490ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-189ms   AFR(10):0.9655 | [S3,MB3,F]  189-13-202ms   | [S3,MB3,B]  202-42-245ms   AFR(10):0.9655 | [S3,MB4,F]  245-13-258ms   | [S3,MB4,B]  258-42-300ms   AFR(10):0.9655 | [S3,MB5,F]  300-14-315ms   | [S3,MB5,B]  315-41-357ms   AFR(10):0.9655 | [S3,MB6,F]  357-13-370ms   | [S3,MB6,B]  370-43-414ms   AFR(10):0.9655 | [S3,MB7,F]  414-14-428ms   | [S3,MB7,B]  428-42-471ms   AFR(10):0.9655
[rank3]:2025-12-12 03:49:06,252 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0349_min_batch_time.svg
[rank3]:			> Batch Time: 328.78 ms, GPU Bubble Ratio: 82.19%, 50.93%, 61.57%, 14.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-157ms    | [S0,MB3,B]  185-0-185ms    | [S0,MB7,F]  185-6-192ms    | [S0,MB4,B]  220-0-220ms    | [S0,MB5,B]  257-0-257ms    | [S0,MB6,B]  293-0-293ms    | [S0,MB7,B]  328-0-328ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-124ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-9-159ms    | [S1,MB3,B]  174-11-185ms   | [S1,MB6,F]  185-9-194ms    | [S1,MB4,B]  209-11-220ms   | [S1,MB7,F]  220-9-229ms    | [S1,MB5,B]  246-11-257ms   | [S1,MB6,B]  282-10-293ms   | [S1,MB7,B]  317-10-328ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  64-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-6-111ms    | [S2,MB2,B]  131-8-139ms    | [S2,MB4,F]  139-6-146ms    | [S2,MB3,B]  166-8-174ms    | [S2,MB5,F]  174-6-181ms    | [S2,MB4,B]  201-8-209ms    | [S2,MB6,F]  209-7-216ms    | [S2,MB5,B]  237-8-246ms    | [S2,MB7,F]  246-7-253ms    | [S2,MB6,B]  273-8-282ms    | [S2,MB7,B]  309-8-317ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-64ms     AFR(10):0.9655 | [S3,MB1,F]  64-11-75ms     | [S3,MB1,B]  75-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-109ms    | [S3,MB2,B]  109-21-131ms   AFR(10):0.9655 | [S3,MB3,F]  131-13-144ms   | [S3,MB3,B]  144-21-166ms   AFR(10):0.9655 | [S3,MB4,F]  166-13-179ms   | [S3,MB4,B]  179-21-201ms   AFR(10):0.9655 | [S3,MB5,F]  201-14-215ms   | [S3,MB5,B]  215-22-237ms   AFR(10):0.9655 | [S3,MB6,F]  237-13-251ms   | [S3,MB6,B]  251-21-273ms   AFR(10):0.9655 | [S3,MB7,F]  273-14-287ms   | [S3,MB7,B]  287-21-309ms   AFR(10):0.9655
[rank3]:2025-12-12 03:49:06,393 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0349_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 422.73 ms, GPU Bubble Ratio: 49.62%, 40.07%, 52.73%, 11.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-207ms    | [S0,MB2,B]  232-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  267-23-290ms   | [S0,MB7,F]  290-6-297ms    | [S0,MB4,B]  318-23-342ms   | [S0,MB5,B]  374-23-398ms   | [S0,MB6,B]  410-12-422ms   | [S0,MB7,B]  422-0-422ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  208-24-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  243-24-267ms   | [S1,MB6,F]  267-9-276ms    | [S1,MB4,B]  294-24-318ms   | [S1,MB7,F]  318-9-327ms    | [S1,MB5,B]  350-24-374ms   | [S1,MB6,B]  386-23-410ms   | [S1,MB7,B]  411-10-422ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  208-6-215ms    | [S2,MB3,B]  224-19-243ms   | [S2,MB5,F]  243-6-250ms    | [S2,MB4,B]  275-19-294ms   | [S2,MB6,F]  294-7-301ms    | [S2,MB5,B]  331-19-350ms   | [S2,MB7,F]  350-7-357ms    | [S2,MB6,B]  367-19-386ms   | [S2,MB7,B]  403-8-411ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  147-41-189ms   AFR(10):0.9655 | [S3,MB3,F]  189-13-202ms   | [S3,MB3,B]  202-21-224ms   AFR(10):0.9655 | [S3,MB4,F]  224-13-237ms   | [S3,MB4,B]  237-38-275ms   AFR(10):0.9655 | [S3,MB5,F]  275-14-289ms   | [S3,MB5,B]  289-41-331ms   AFR(10):0.9655 | [S3,MB6,F]  331-13-345ms   | [S3,MB6,B]  345-21-367ms   AFR(10):0.9655 | [S3,MB7,F]  367-14-381ms   | [S3,MB7,B]  381-21-403ms   AFR(10):0.9655
[rank3]:2025-12-12 03:49:06,393 - INFO - 	> Batch Time: 422.73 ms (Average Freeze Ratio: 0.21, Time Reduction Rate: 0.21)
[rank0]:2025-12-12 03:50:35,975 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 03:50:40,883 - INFO - Avg. fwd time: 7.4749 / Avg. bwd time: 17.5976 / Avg. batch time: 523.3073 (ms) / GPU bubble ratio: 61.67%
[rank2]:2025-12-12 03:50:40,889 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank3]:2025-12-12 03:50:40,859 - INFO - Avg. fwd time: 13.6542 / Avg. bwd time: 38.8754 / Avg. batch time: 492.7958 (ms) / GPU bubble ratio: 14.72%
[rank3]:2025-12-12 03:50:40,864 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.07(0.07)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-12 03:50:40,911 - INFO - Avg. fwd time: 9.6248 / Avg. bwd time: 22.0404 / Avg. batch time: 560.1339 (ms) / GPU bubble ratio: 54.77%
[rank1]:2025-12-12 03:50:40,918 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank2]:2025-12-12 03:50:40,957 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1724  memory:  6.51GiB(13.70%)  tps: 7,064  tflops: 55.23  mfu: 17.70%
[rank0]:2025-12-12 03:50:40,936 - INFO - Avg. fwd time: 7.5749 / Avg. bwd time: 19.4282 / Avg. batch time: 593.1400 (ms) / GPU bubble ratio: 63.58%
[rank0]:2025-12-12 03:50:40,943 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-12 03:50:40,971 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1724  memory: 12.97GiB(27.31%)  tps: 7,064  tflops: 55.23  mfu: 17.70%
[rank3]:2025-12-12 03:50:40,970 - INFO -  step: 100  loss:  8.6877  grad_norm:  8.1724  memory: 17.37GiB(36.56%)  tps: 7,064  tflops: 55.23  mfu: 17.70%
[rank1]:2025-12-12 03:50:40,961 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1724  memory:  9.36GiB(19.71%)  tps: 7,064  tflops: 55.23  mfu: 17.70%
[rank1]:2025-12-12 03:50:41,030 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0350_stage1_step100.svg
[rank2]:2025-12-12 03:50:41,031 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0350_stage2_step100.svg
[rank0]:2025-12-12 03:50:41,030 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0350_stage0_step100.svg
[rank3]:2025-12-12 03:50:41,113 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0350_real_step100_rank3.svg
[rank3]:			> Batch Time: 606.30 ms, GPU Bubble Ratio: 64.99%, 57.10%, 66.08%, 28.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  140-16-156ms   | [S0,MB4,F]  156-7-163ms    | [S0,MB1,B]  200-16-217ms   | [S0,MB5,F]  217-6-224ms    | [S0,MB2,B]  268-16-284ms   | [S0,MB6,F]  284-6-291ms    | [S0,MB3,B]  335-16-352ms   | [S0,MB7,F]  352-6-358ms    | [S0,MB4,B]  398-23-422ms   | [S0,MB5,B]  463-23-486ms   | [S0,MB6,B]  527-19-547ms   | [S0,MB7,B]  587-19-606ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  113-21-134ms   | [S1,MB3,F]  138-9-147ms    | [S1,MB1,B]  174-21-195ms   | [S1,MB4,F]  199-9-208ms    | [S1,MB2,B]  241-21-263ms   | [S1,MB5,F]  266-9-275ms    | [S1,MB3,B]  306-24-330ms   | [S1,MB6,F]  334-9-343ms    | [S1,MB4,B]  369-24-393ms   | [S1,MB7,F]  396-9-406ms    | [S1,MB5,B]  435-24-459ms   | [S1,MB6,B]  500-24-524ms   | [S1,MB7,B]  560-23-584ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  91-16-108ms    | [S2,MB2,F]  111-7-119ms    | [S2,MB1,B]  153-16-169ms   | [S2,MB3,F]  172-6-179ms    | [S2,MB2,B]  217-19-236ms   | [S2,MB4,F]  240-7-247ms    | [S2,MB3,B]  282-19-301ms   | [S2,MB5,F]  304-6-311ms    | [S2,MB4,B]  344-19-364ms   | [S2,MB6,F]  367-7-374ms    | [S2,MB5,B]  411-19-430ms   | [S2,MB7,F]  433-7-441ms    | [S2,MB6,B]  477-19-497ms   | [S2,MB7,B]  538-18-557ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-38-86ms     | [S3,MB1,F]  90-11-101ms    | [S3,MB1,B]  107-40-148ms   | [S3,MB2,F]  151-12-164ms   | [S3,MB2,B]  170-42-212ms   | [S3,MB3,F]  216-13-229ms   | [S3,MB3,B]  235-41-277ms   | [S3,MB4,F]  280-14-295ms   | [S3,MB4,B]  301-38-340ms   | [S3,MB5,F]  343-14-358ms   | [S3,MB5,B]  363-41-405ms   | [S3,MB6,F]  410-14-424ms   | [S3,MB6,B]  429-42-472ms   | [S3,MB7,F]  476-14-490ms   | [S3,MB7,B]  496-38-535ms  
[rank3]:2025-12-12 03:50:41,155 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0350_stage3_step100.svg
[rank3]:2025-12-12 03:52:39,681 - INFO - Avg. fwd time: 13.6903 / Avg. bwd time: 38.3811 / Avg. batch time: 489.1758 (ms) / GPU bubble ratio: 14.84%
[rank2]:2025-12-12 03:52:39,705 - INFO - Avg. fwd time: 7.4580 / Avg. bwd time: 17.7051 / Avg. batch time: 519.7532 (ms) / GPU bubble ratio: 61.27%
[rank1]:2025-12-12 03:52:39,733 - INFO - Avg. fwd time: 9.6166 / Avg. bwd time: 22.0979 / Avg. batch time: 556.6999 (ms) / GPU bubble ratio: 54.42%
[rank0]:2025-12-12 03:52:39,757 - INFO - Avg. fwd time: 7.5873 / Avg. bwd time: 19.5430 / Avg. batch time: 589.7802 (ms) / GPU bubble ratio: 63.20%
[rank0]:2025-12-12 03:54:33,573 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-12 03:54:38,292 - INFO - Avg. fwd time: 7.6370 / Avg. bwd time: 19.3143 / Avg. batch time: 587.3794 (ms) / GPU bubble ratio: 63.29%
[rank3]:2025-12-12 03:54:38,214 - INFO - Avg. fwd time: 13.7381 / Avg. bwd time: 38.0829 / Avg. batch time: 487.1838 (ms) / GPU bubble ratio: 14.91%
[rank3]:2025-12-12 03:54:38,220 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.10(0.13)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-12 03:54:38,238 - INFO - Avg. fwd time: 7.4670 / Avg. bwd time: 17.6217 / Avg. batch time: 517.5521 (ms) / GPU bubble ratio: 61.22%
[rank2]:2025-12-12 03:54:38,244 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank2]:2025-12-12 03:54:38,313 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.0031  memory:  6.51GiB(13.70%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank1]:2025-12-12 03:54:38,265 - INFO - Avg. fwd time: 9.6386 / Avg. bwd time: 21.9021 / Avg. batch time: 554.4057 (ms) / GPU bubble ratio: 54.49%
[rank1]:2025-12-12 03:54:38,271 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank1]:2025-12-12 03:54:38,317 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.0031  memory:  9.36GiB(19.71%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank0]:2025-12-12 03:54:38,299 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 03:54:38,328 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.0031  memory: 13.29GiB(27.97%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank3]:2025-12-12 03:54:38,326 - INFO -  step: 150  loss:  3.8836  grad_norm:  6.0031  memory: 17.37GiB(36.56%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank3]:2025-12-12 03:56:31,824 - INFO - Avg. fwd time: 13.8012 / Avg. bwd time: 37.4155 / Avg. batch time: 482.5165 (ms) / GPU bubble ratio: 15.08%
[rank2]:2025-12-12 03:56:31,847 - INFO - Avg. fwd time: 7.4753 / Avg. bwd time: 17.5676 / Avg. batch time: 512.7512 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-12-12 03:56:31,874 - INFO - Avg. fwd time: 9.6693 / Avg. bwd time: 21.6559 / Avg. batch time: 549.4812 (ms) / GPU bubble ratio: 54.39%
[rank0]:2025-12-12 03:56:31,897 - INFO - Avg. fwd time: 7.6823 / Avg. bwd time: 18.9083 / Avg. batch time: 582.1105 (ms) / GPU bubble ratio: 63.46%
[rank0]:2025-12-12 03:58:21,380 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 03:58:25,854 - INFO - Avg. fwd time: 13.8472 / Avg. bwd time: 36.9748 / Avg. batch time: 479.5702 (ms) / GPU bubble ratio: 15.22%
[rank3]:2025-12-12 03:58:25,860 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.17(0.20)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-12 03:58:25,878 - INFO - Avg. fwd time: 7.4967 / Avg. bwd time: 17.4194 / Avg. batch time: 509.5996 (ms) / GPU bubble ratio: 60.89%
[rank2]:2025-12-12 03:58:25,884 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-12 03:58:25,905 - INFO - Avg. fwd time: 9.7060 / Avg. bwd time: 21.3641 / Avg. batch time: 546.1626 (ms) / GPU bubble ratio: 54.49%
[rank1]:2025-12-12 03:58:25,912 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 03:58:25,954 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.6809  memory:  9.36GiB(19.71%)  tps: 7,197  tflops: 56.27  mfu: 18.03%
[rank3]:2025-12-12 03:58:25,963 - INFO -  step: 200  loss:  1.3231  grad_norm:  3.6809  memory: 17.37GiB(36.56%)  tps: 7,197  tflops: 56.27  mfu: 18.03%
[rank0]:2025-12-12 03:58:25,929 - INFO - Avg. fwd time: 7.7330 / Avg. bwd time: 18.2719 / Avg. batch time: 578.4516 (ms) / GPU bubble ratio: 64.04%
[rank0]:2025-12-12 03:58:25,936 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-12 03:58:25,964 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.6809  memory: 13.29GiB(27.97%)  tps: 7,197  tflops: 56.27  mfu: 18.03%
[rank2]:2025-12-12 03:58:25,950 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.6809  memory:  6.51GiB(13.70%)  tps: 7,197  tflops: 56.27  mfu: 18.03%
[rank2]:2025-12-12 03:58:26,015 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0358_stage2_step200.svg
[rank1]:2025-12-12 03:58:26,016 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0358_stage1_step200.svg
[rank0]:2025-12-12 03:58:26,016 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0358_stage0_step200.svg
[rank3]:2025-12-12 03:58:26,104 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0358_real_step200_rank3.svg
[rank3]:			> Batch Time: 546.47 ms, GPU Bubble Ratio: 69.31%, 56.92%, 64.99%, 30.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  106-4-111ms    | [S0,MB4,F]  111-8-120ms    | [S0,MB1,B]  170-4-175ms    | [S0,MB5,F]  175-6-182ms    | [S0,MB2,B]  243-4-248ms    | [S0,MB6,F]  248-6-255ms    | [S0,MB3,B]  317-4-322ms    | [S0,MB7,F]  322-6-329ms    | [S0,MB4,B]  368-23-391ms   | [S0,MB5,B]  428-23-451ms   | [S0,MB6,B]  486-18-505ms   | [S0,MB7,B]  529-16-546ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  89-12-101ms    | [S1,MB3,F]  105-10-115ms   | [S1,MB1,B]  152-12-165ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  225-12-238ms   | [S1,MB5,F]  241-8-250ms    | [S1,MB3,B]  285-24-309ms   | [S1,MB6,F]  315-9-324ms    | [S1,MB4,B]  338-24-362ms   | [S1,MB7,F]  366-9-375ms    | [S1,MB5,B]  400-24-424ms   | [S1,MB6,B]  459-24-483ms   | [S1,MB7,B]  505-20-525ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  75-8-83ms      | [S2,MB2,F]  87-8-96ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  151-6-158ms    | [S2,MB2,B]  201-19-220ms   | [S2,MB4,F]  224-6-231ms    | [S2,MB3,B]  261-19-280ms   | [S2,MB5,F]  284-6-291ms    | [S2,MB4,B]  313-19-333ms   | [S2,MB6,F]  336-7-343ms    | [S2,MB5,B]  376-19-395ms   | [S2,MB7,F]  398-7-405ms    | [S2,MB6,B]  436-19-455ms   | [S2,MB7,B]  485-16-501ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-21-70ms     | [S3,MB1,F]  73-13-87ms     | [S3,MB1,B]  93-40-133ms    | [S3,MB2,F]  137-11-148ms   | [S3,MB2,B]  154-41-196ms   | [S3,MB3,F]  199-13-213ms   | [S3,MB3,B]  219-36-256ms   | [S3,MB4,F]  259-16-276ms   | [S3,MB4,B]  282-23-306ms   | [S3,MB5,F]  312-12-324ms   | [S3,MB5,B]  330-40-370ms   | [S3,MB6,F]  374-14-389ms   | [S3,MB6,B]  395-36-431ms   | [S3,MB7,F]  435-17-452ms   | [S3,MB7,B]  458-23-482ms  
[rank3]:2025-12-12 03:58:26,149 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0358_stage3_step200.svg
[rank3]:2025-12-12 04:00:17,217 - INFO - Avg. fwd time: 13.8931 / Avg. bwd time: 36.4311 / Avg. batch time: 475.7633 (ms) / GPU bubble ratio: 15.38%
[rank2]:2025-12-12 04:00:17,240 - INFO - Avg. fwd time: 7.5165 / Avg. bwd time: 17.2801 / Avg. batch time: 505.6935 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-12-12 04:00:17,267 - INFO - Avg. fwd time: 9.7426 / Avg. bwd time: 21.0800 / Avg. batch time: 542.1036 (ms) / GPU bubble ratio: 54.51%
[rank0]:2025-12-12 04:00:17,290 - INFO - Avg. fwd time: 7.7769 / Avg. bwd time: 17.4072 / Avg. batch time: 574.0618 (ms) / GPU bubble ratio: 64.90%
[rank0]:2025-12-12 04:02:03,940 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 04:02:08,239 - INFO - Avg. fwd time: 13.9323 / Avg. bwd time: 35.9844 / Avg. batch time: 472.6535 (ms) / GPU bubble ratio: 15.51%
[rank3]:2025-12-12 04:02:08,248 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.21(0.20)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 04:02:08,263 - INFO - Avg. fwd time: 7.5318 / Avg. bwd time: 17.1692 / Avg. batch time: 502.4471 (ms) / GPU bubble ratio: 60.67%
[rank2]:2025-12-12 04:02:08,269 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 04:02:08,290 - INFO - Avg. fwd time: 9.7706 / Avg. bwd time: 20.8521 / Avg. batch time: 538.7256 (ms) / GPU bubble ratio: 54.53%
[rank1]:2025-12-12 04:02:08,297 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 04:02:08,339 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.6428  memory:  9.36GiB(19.71%)  tps: 7,367  tflops: 57.60  mfu: 18.46%
[rank0]:2025-12-12 04:02:08,313 - INFO - Avg. fwd time: 7.8104 / Avg. bwd time: 16.6966 / Avg. batch time: 570.4145 (ms) / GPU bubble ratio: 65.63%
[rank0]:2025-12-12 04:02:08,321 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 04:02:08,349 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.6428  memory: 13.29GiB(27.97%)  tps: 7,367  tflops: 57.60  mfu: 18.46%
[rank3]:2025-12-12 04:02:08,347 - INFO -  step: 250  loss:  0.4390  grad_norm:  0.6428  memory: 17.37GiB(36.56%)  tps: 7,367  tflops: 57.60  mfu: 18.46%
[rank2]:2025-12-12 04:02:08,335 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.6428  memory:  6.51GiB(13.70%)  tps: 7,367  tflops: 57.60  mfu: 18.46%
[rank3]:2025-12-12 04:03:59,397 - INFO - Avg. fwd time: 13.9612 / Avg. bwd time: 35.6285 / Avg. batch time: 470.1629 (ms) / GPU bubble ratio: 15.62%
[rank2]:2025-12-12 04:03:59,422 - INFO - Avg. fwd time: 7.5443 / Avg. bwd time: 17.0792 / Avg. batch time: 499.8458 (ms) / GPU bubble ratio: 60.59%
[rank0]:2025-12-12 04:03:59,473 - INFO - Avg. fwd time: 7.8375 / Avg. bwd time: 16.1305 / Avg. batch time: 567.4849 (ms) / GPU bubble ratio: 66.21%
[rank1]:2025-12-12 04:03:59,449 - INFO - Avg. fwd time: 9.7930 / Avg. bwd time: 20.6655 / Avg. batch time: 536.0180 (ms) / GPU bubble ratio: 54.54%
[rank0]:2025-12-12 04:05:46,940 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:05:51,328 - INFO - Avg. fwd time: 13.9893 / Avg. bwd time: 35.3749 / Avg. batch time: 468.4283 (ms) / GPU bubble ratio: 15.69%
[rank3]:2025-12-12 04:05:51,333 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.21(0.20)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 04:05:51,352 - INFO - Avg. fwd time: 7.5546 / Avg. bwd time: 17.0038 / Avg. batch time: 498.0120 (ms) / GPU bubble ratio: 60.55%
[rank2]:2025-12-12 04:05:51,358 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 04:05:51,426 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2332  memory:  6.51GiB(13.70%)  tps: 7,344  tflops: 57.41  mfu: 18.40%
[rank0]:2025-12-12 04:05:51,404 - INFO - Avg. fwd time: 7.8600 / Avg. bwd time: 15.6565 / Avg. batch time: 565.3766 (ms) / GPU bubble ratio: 66.72%
[rank0]:2025-12-12 04:05:51,411 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 04:05:51,440 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2332  memory: 13.29GiB(27.97%)  tps: 7,344  tflops: 57.41  mfu: 18.40%
[rank1]:2025-12-12 04:05:51,380 - INFO - Avg. fwd time: 9.8115 / Avg. bwd time: 20.5091 / Avg. batch time: 534.0933 (ms) / GPU bubble ratio: 54.58%
[rank1]:2025-12-12 04:05:51,387 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 04:05:51,429 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2332  memory:  9.36GiB(19.71%)  tps: 7,344  tflops: 57.41  mfu: 18.40%
[rank3]:2025-12-12 04:05:51,438 - INFO -  step: 300  loss:  0.2834  grad_norm:  0.2332  memory: 17.37GiB(36.56%)  tps: 7,344  tflops: 57.41  mfu: 18.40%
[rank2]:2025-12-12 04:05:51,488 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0405_stage2_step300.svg
[rank0]:2025-12-12 04:05:51,488 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0405_stage0_step300.svg
[rank1]:2025-12-12 04:05:51,487 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0405_stage1_step300.svg
[rank3]:2025-12-12 04:05:51,573 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0405_real_step300_rank3.svg
[rank3]:			> Batch Time: 542.25 ms, GPU Bubble Ratio: 72.74%, 57.46%, 64.80%, 30.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  168-0-168ms    | [S0,MB5,F]  168-6-174ms    | [S0,MB2,B]  241-0-241ms    | [S0,MB6,F]  241-6-247ms    | [S0,MB3,B]  315-0-315ms    | [S0,MB7,F]  315-6-322ms    | [S0,MB4,B]  365-23-389ms   | [S0,MB5,B]  425-23-449ms   | [S0,MB6,B]  484-18-502ms   | [S0,MB7,B]  525-16-542ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-175ms    | [S1,MB2,B]  225-10-235ms   | [S1,MB5,F]  239-8-248ms    | [S1,MB3,B]  284-24-308ms   | [S1,MB6,F]  314-8-323ms    | [S1,MB4,B]  335-24-360ms   | [S1,MB7,F]  363-9-373ms    | [S1,MB5,B]  398-24-422ms   | [S1,MB6,B]  455-24-480ms   | [S1,MB7,B]  502-20-522ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-6-230ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  283-7-290ms    | [S2,MB4,B]  311-19-330ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  373-19-393ms   | [S2,MB7,F]  396-7-403ms    | [S2,MB6,B]  433-19-452ms   | [S2,MB7,B]  482-16-498ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-133ms    | [S3,MB2,F]  136-11-148ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  218-36-254ms   | [S3,MB4,F]  258-17-276ms   | [S3,MB4,B]  281-22-304ms   | [S3,MB5,F]  309-12-322ms   | [S3,MB5,B]  328-40-368ms   | [S3,MB6,F]  372-14-386ms   | [S3,MB6,B]  392-36-428ms   | [S3,MB7,F]  431-17-449ms   | [S3,MB7,B]  456-22-479ms  
[rank3]:2025-12-12 04:05:51,615 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0405_stage3_step300.svg
[rank3]:2025-12-12 04:07:42,546 - INFO - Avg. fwd time: 14.0041 / Avg. bwd time: 35.1215 / Avg. batch time: 466.6023 (ms) / GPU bubble ratio: 15.77%
[rank2]:2025-12-12 04:07:42,571 - INFO - Avg. fwd time: 7.5630 / Avg. bwd time: 16.9395 / Avg. batch time: 496.1529 (ms) / GPU bubble ratio: 60.49%
[rank1]:2025-12-12 04:07:42,599 - INFO - Avg. fwd time: 9.8269 / Avg. bwd time: 20.3773 / Avg. batch time: 532.1601 (ms) / GPU bubble ratio: 54.59%
[rank0]:2025-12-12 04:07:42,623 - INFO - Avg. fwd time: 7.8798 / Avg. bwd time: 15.2398 / Avg. batch time: 563.2887 (ms) / GPU bubble ratio: 67.16%
[rank0]:2025-12-12 04:09:30,055 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 04:09:34,468 - INFO - Avg. fwd time: 14.0205 / Avg. bwd time: 34.9406 / Avg. batch time: 465.3340 (ms) / GPU bubble ratio: 15.83%
[rank2]:2025-12-12 04:09:34,492 - INFO - Avg. fwd time: 7.5708 / Avg. bwd time: 16.8837 / Avg. batch time: 494.8145 (ms) / GPU bubble ratio: 60.46%
[rank1]:2025-12-12 04:09:34,521 - INFO - Avg. fwd time: 9.8405 / Avg. bwd time: 20.2629 / Avg. batch time: 530.7588 (ms) / GPU bubble ratio: 54.63%
[rank0]:2025-12-12 04:09:34,545 - INFO - Avg. fwd time: 7.8969 / Avg. bwd time: 14.8840 / Avg. batch time: 561.7549 (ms) / GPU bubble ratio: 67.56%
[rank3]:2025-12-12 04:09:34,583 - INFO -  step: 350  loss:  0.2249  grad_norm:  0.1051  memory: 17.37GiB(36.56%)  tps: 7,342  tflops: 57.40  mfu: 18.40%
[rank2]:2025-12-12 04:09:34,567 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1051  memory:  6.51GiB(13.70%)  tps: 7,342  tflops: 57.40  mfu: 18.40%
[rank1]:2025-12-12 04:09:34,570 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1051  memory:  9.36GiB(19.71%)  tps: 7,342  tflops: 57.40  mfu: 18.40%
[rank0]:2025-12-12 04:09:34,581 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1051  memory: 13.29GiB(27.97%)  tps: 7,342  tflops: 57.40  mfu: 18.40%
[rank3]:2025-12-12 04:11:25,719 - INFO - Avg. fwd time: 14.0329 / Avg. bwd time: 34.7563 / Avg. batch time: 464.0027 (ms) / GPU bubble ratio: 15.88%
[rank2]:2025-12-12 04:11:25,744 - INFO - Avg. fwd time: 7.5773 / Avg. bwd time: 16.8350 / Avg. batch time: 493.4223 (ms) / GPU bubble ratio: 60.42%
[rank1]:2025-12-12 04:11:25,773 - INFO - Avg. fwd time: 9.8520 / Avg. bwd time: 20.1638 / Avg. batch time: 529.3097 (ms) / GPU bubble ratio: 54.63%
[rank0]:2025-12-12 04:11:25,798 - INFO - Avg. fwd time: 7.9123 / Avg. bwd time: 14.5887 / Avg. batch time: 560.1967 (ms) / GPU bubble ratio: 67.87%
[rank0]:2025-12-12 04:13:13,497 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:13:17,929 - INFO - Avg. fwd time: 14.0400 / Avg. bwd time: 34.6301 / Avg. batch time: 463.0818 (ms) / GPU bubble ratio: 15.92%
[rank2]:2025-12-12 04:13:17,954 - INFO - Avg. fwd time: 7.5833 / Avg. bwd time: 16.7918 / Avg. batch time: 492.4522 (ms) / GPU bubble ratio: 60.40%
[rank2]:2025-12-12 04:13:18,035 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0632  memory:  6.51GiB(13.70%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank1]:2025-12-12 04:13:17,983 - INFO - Avg. fwd time: 9.8626 / Avg. bwd time: 20.0761 / Avg. batch time: 528.2898 (ms) / GPU bubble ratio: 54.66%
[rank1]:2025-12-12 04:13:18,038 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0632  memory:  9.36GiB(19.71%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank0]:2025-12-12 04:13:18,013 - INFO - Avg. fwd time: 7.9259 / Avg. bwd time: 14.3172 / Avg. batch time: 559.0790 (ms) / GPU bubble ratio: 68.17%
[rank0]:2025-12-12 04:13:18,049 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0632  memory: 13.29GiB(27.97%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank3]:2025-12-12 04:13:18,047 - INFO -  step: 400  loss:  0.2117  grad_norm:  0.0632  memory: 17.37GiB(36.56%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank2]:2025-12-12 04:13:18,103 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0413_stage2_step400.svg
[rank1]:2025-12-12 04:13:18,102 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0413_stage1_step400.svg
[rank0]:2025-12-12 04:13:18,114 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0413_stage0_step400.svg
[rank3]:2025-12-12 04:13:18,202 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0413_real_step400_rank3.svg
[rank3]:			> Batch Time: 543.23 ms, GPU Bubble Ratio: 72.89%, 57.58%, 64.90%, 30.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  168-0-168ms    | [S0,MB5,F]  168-6-174ms    | [S0,MB2,B]  241-0-241ms    | [S0,MB6,F]  241-6-248ms    | [S0,MB3,B]  316-0-316ms    | [S0,MB7,F]  316-6-322ms    | [S0,MB4,B]  365-23-388ms   | [S0,MB5,B]  425-23-449ms   | [S0,MB6,B]  484-17-502ms   | [S0,MB7,B]  526-16-543ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  225-10-236ms   | [S1,MB5,F]  239-8-248ms    | [S1,MB3,B]  284-24-308ms   | [S1,MB6,F]  314-8-323ms    | [S1,MB4,B]  335-24-359ms   | [S1,MB7,F]  363-9-372ms    | [S1,MB5,B]  397-24-422ms   | [S1,MB6,B]  456-24-480ms   | [S1,MB7,B]  502-20-522ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-220ms   | [S2,MB4,F]  223-6-230ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  282-6-289ms    | [S2,MB4,B]  310-19-330ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  373-19-392ms   | [S2,MB7,F]  396-7-403ms    | [S2,MB6,B]  434-19-453ms   | [S2,MB7,B]  482-16-498ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-133ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  218-36-255ms   | [S3,MB4,F]  258-16-275ms   | [S3,MB4,B]  281-22-304ms   | [S3,MB5,F]  309-11-321ms   | [S3,MB5,B]  327-41-368ms   | [S3,MB6,F]  372-14-386ms   | [S3,MB6,B]  392-36-429ms   | [S3,MB7,F]  432-17-449ms   | [S3,MB7,B]  455-22-478ms  
[rank3]:2025-12-12 04:13:18,249 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0413_stage3_step400.svg
[rank3]:2025-12-12 04:13:43,748 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 04:13:43,978 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 04:13:44,000 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-12 04:13:44,021 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-12 04:15:10,087 - INFO - Avg. fwd time: 14.0510 / Avg. bwd time: 34.5099 / Avg. batch time: 462.2386 (ms) / GPU bubble ratio: 15.96%
[rank2]:2025-12-12 04:15:10,113 - INFO - Avg. fwd time: 7.5884 / Avg. bwd time: 16.7535 / Avg. batch time: 491.5889 (ms) / GPU bubble ratio: 60.39%
[rank1]:2025-12-12 04:15:10,142 - INFO - Avg. fwd time: 9.8715 / Avg. bwd time: 19.9986 / Avg. batch time: 527.3820 (ms) / GPU bubble ratio: 54.69%
[rank0]:2025-12-12 04:15:10,170 - INFO - Avg. fwd time: 7.9374 / Avg. bwd time: 14.0894 / Avg. batch time: 558.0847 (ms) / GPU bubble ratio: 68.43%
[rank0]:2025-12-12 04:16:57,319 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 04:17:01,689 - INFO - Avg. fwd time: 14.0594 / Avg. bwd time: 34.3985 / Avg. batch time: 461.4390 (ms) / GPU bubble ratio: 15.99%
[rank2]:2025-12-12 04:17:01,715 - INFO - Avg. fwd time: 7.5925 / Avg. bwd time: 16.7188 / Avg. batch time: 490.7422 (ms) / GPU bubble ratio: 60.37%
[rank1]:2025-12-12 04:17:01,744 - INFO - Avg. fwd time: 9.8791 / Avg. bwd time: 19.9293 / Avg. batch time: 526.4956 (ms) / GPU bubble ratio: 54.71%
[rank0]:2025-12-12 04:17:01,770 - INFO - Avg. fwd time: 7.9470 / Avg. bwd time: 13.8743 / Avg. batch time: 557.1169 (ms) / GPU bubble ratio: 68.67%
[rank3]:2025-12-12 04:17:01,804 - INFO -  step: 450  loss:  0.2253  grad_norm:  0.0806  memory: 17.37GiB(36.56%)  tps: 7,322  tflops: 57.24  mfu: 18.35%
[rank2]:2025-12-12 04:17:01,792 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0806  memory:  6.51GiB(13.70%)  tps: 7,322  tflops: 57.24  mfu: 18.35%
[rank1]:2025-12-12 04:17:01,795 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0806  memory:  9.36GiB(19.71%)  tps: 7,322  tflops: 57.24  mfu: 18.35%
[rank0]:2025-12-12 04:17:01,806 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0806  memory: 13.29GiB(27.97%)  tps: 7,322  tflops: 57.24  mfu: 18.35%
[rank3]:2025-12-12 04:18:53,247 - INFO - Avg. fwd time: 14.0698 / Avg. bwd time: 34.2939 / Avg. batch time: 460.7057 (ms) / GPU bubble ratio: 16.02%
[rank2]:2025-12-12 04:18:53,273 - INFO - Avg. fwd time: 7.5963 / Avg. bwd time: 16.6871 / Avg. batch time: 489.9629 (ms) / GPU bubble ratio: 60.35%
[rank0]:2025-12-12 04:18:53,329 - INFO - Avg. fwd time: 7.9559 / Avg. bwd time: 13.6845 / Avg. batch time: 556.2308 (ms) / GPU bubble ratio: 68.88%
[rank1]:2025-12-12 04:18:53,303 - INFO - Avg. fwd time: 9.8862 / Avg. bwd time: 19.8674 / Avg. batch time: 525.6803 (ms) / GPU bubble ratio: 54.72%
[rank0]:2025-12-12 04:20:39,707 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:20:43,993 - INFO - Avg. fwd time: 14.0743 / Avg. bwd time: 34.1758 / Avg. batch time: 459.8375 (ms) / GPU bubble ratio: 16.06%
[rank2]:2025-12-12 04:20:44,020 - INFO - Avg. fwd time: 7.5996 / Avg. bwd time: 16.6589 / Avg. batch time: 489.0600 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-12-12 04:20:44,050 - INFO - Avg. fwd time: 9.8927 / Avg. bwd time: 19.8116 / Avg. batch time: 524.7433 (ms) / GPU bubble ratio: 54.71%
[rank0]:2025-12-12 04:20:44,076 - INFO - Avg. fwd time: 7.9636 / Avg. bwd time: 13.5229 / Avg. batch time: 555.2280 (ms) / GPU bubble ratio: 69.04%
[rank3]:2025-12-12 04:20:44,110 - INFO -  step: 500  loss:  0.2179  grad_norm:  0.0883  memory: 17.37GiB(36.56%)  tps: 7,370  tflops: 57.62  mfu: 18.47%
[rank2]:2025-12-12 04:20:44,098 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0883  memory:  6.51GiB(13.70%)  tps: 7,370  tflops: 57.62  mfu: 18.47%
[rank1]:2025-12-12 04:20:44,101 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0883  memory:  9.36GiB(19.71%)  tps: 7,370  tflops: 57.62  mfu: 18.47%
[rank0]:2025-12-12 04:20:44,112 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0883  memory: 13.29GiB(27.97%)  tps: 7,370  tflops: 57.62  mfu: 18.47%
[rank0]:2025-12-12 04:20:44,169 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0420_stage0_step500.svg
[rank2]:2025-12-12 04:20:44,163 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0420_stage2_step500.svg
[rank1]:2025-12-12 04:20:44,160 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0420_stage1_step500.svg
[rank3]:2025-12-12 04:20:44,251 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0420_real_step500_rank3.svg
[rank3]:			> Batch Time: 530.20 ms, GPU Bubble Ratio: 72.07%, 56.48%, 64.03%, 31.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-246ms    | [S0,MB3,B]  315-0-315ms    | [S0,MB7,F]  315-6-321ms    | [S0,MB4,B]  365-23-389ms   | [S0,MB5,B]  416-23-440ms   | [S0,MB6,B]  471-18-490ms   | [S0,MB7,B]  513-16-530ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  283-24-307ms   | [S1,MB6,F]  313-9-322ms    | [S1,MB4,B]  334-24-358ms   | [S1,MB7,F]  363-9-373ms    | [S1,MB5,B]  388-24-412ms   | [S1,MB6,B]  444-24-468ms   | [S1,MB7,B]  489-20-510ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  259-19-278ms   | [S2,MB5,F]  282-7-289ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  332-7-339ms    | [S2,MB5,B]  363-19-383ms   | [S2,MB7,F]  386-7-393ms    | [S2,MB6,B]  421-19-440ms   | [S2,MB7,B]  469-16-485ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  257-17-275ms   | [S3,MB4,B]  281-22-303ms   | [S3,MB5,F]  308-13-322ms   | [S3,MB5,B]  328-29-357ms   | [S3,MB6,F]  362-12-374ms   | [S3,MB6,B]  380-35-416ms   | [S3,MB7,F]  419-17-437ms   | [S3,MB7,B]  442-22-465ms  
[rank3]:2025-12-12 04:20:44,294 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0420_stage3_step500.svg
[rank3]:2025-12-12 04:22:35,216 - INFO - Avg. fwd time: 14.0807 / Avg. bwd time: 34.0762 / Avg. batch time: 459.1215 (ms) / GPU bubble ratio: 16.09%
[rank2]:2025-12-12 04:22:35,243 - INFO - Avg. fwd time: 7.6028 / Avg. bwd time: 16.6331 / Avg. batch time: 488.3298 (ms) / GPU bubble ratio: 60.30%
[rank1]:2025-12-12 04:22:35,273 - INFO - Avg. fwd time: 9.8988 / Avg. bwd time: 19.7609 / Avg. batch time: 523.9840 (ms) / GPU bubble ratio: 54.72%
[rank0]:2025-12-12 04:22:35,300 - INFO - Avg. fwd time: 7.9711 / Avg. bwd time: 13.3857 / Avg. batch time: 554.4123 (ms) / GPU bubble ratio: 69.18%
[rank0]:2025-12-12 04:24:22,064 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 04:24:26,499 - INFO - Avg. fwd time: 14.0865 / Avg. bwd time: 33.9914 / Avg. batch time: 458.5198 (ms) / GPU bubble ratio: 16.12%
[rank2]:2025-12-12 04:24:26,526 - INFO - Avg. fwd time: 7.6059 / Avg. bwd time: 16.6097 / Avg. batch time: 487.6967 (ms) / GPU bubble ratio: 60.28%
[rank0]:2025-12-12 04:24:26,584 - INFO - Avg. fwd time: 7.9775 / Avg. bwd time: 13.2521 / Avg. batch time: 553.6985 (ms) / GPU bubble ratio: 69.33%
[rank3]:2025-12-12 04:24:26,618 - INFO -  step: 550  loss:  0.2246  grad_norm:  0.0718  memory: 17.37GiB(36.56%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank2]:2025-12-12 04:24:26,606 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0718  memory:  6.51GiB(13.70%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank1]:2025-12-12 04:24:26,557 - INFO - Avg. fwd time: 9.9046 / Avg. bwd time: 19.7149 / Avg. batch time: 523.3240 (ms) / GPU bubble ratio: 54.72%
[rank1]:2025-12-12 04:24:26,609 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0718  memory:  9.36GiB(19.71%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank0]:2025-12-12 04:24:26,620 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0718  memory: 13.29GiB(27.97%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank3]:2025-12-12 04:26:16,969 - INFO - Avg. fwd time: 14.0894 / Avg. bwd time: 33.8881 / Avg. batch time: 457.7570 (ms) / GPU bubble ratio: 16.15%
[rank2]:2025-12-12 04:26:16,996 - INFO - Avg. fwd time: 7.6085 / Avg. bwd time: 16.5882 / Avg. batch time: 486.9100 (ms) / GPU bubble ratio: 60.24%
[rank1]:2025-12-12 04:26:17,027 - INFO - Avg. fwd time: 9.9101 / Avg. bwd time: 19.6730 / Avg. batch time: 522.5112 (ms) / GPU bubble ratio: 54.71%
[rank0]:2025-12-12 04:26:17,055 - INFO - Avg. fwd time: 7.9838 / Avg. bwd time: 13.1223 / Avg. batch time: 552.8393 (ms) / GPU bubble ratio: 69.46%
[rank0]:2025-12-12 04:28:03,936 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:28:08,380 - INFO - Avg. fwd time: 14.0946 / Avg. bwd time: 33.8185 / Avg. batch time: 457.2710 (ms) / GPU bubble ratio: 16.18%
[rank1]:2025-12-12 04:28:08,438 - INFO - Avg. fwd time: 9.9151 / Avg. bwd time: 19.6341 / Avg. batch time: 521.9758 (ms) / GPU bubble ratio: 54.71%
[rank2]:2025-12-12 04:28:08,407 - INFO - Avg. fwd time: 7.6111 / Avg. bwd time: 16.5684 / Avg. batch time: 486.3973 (ms) / GPU bubble ratio: 60.23%
[rank0]:2025-12-12 04:28:08,467 - INFO - Avg. fwd time: 7.9897 / Avg. bwd time: 13.0109 / Avg. batch time: 552.2627 (ms) / GPU bubble ratio: 69.58%
[rank3]:2025-12-12 04:28:08,501 - INFO -  step: 600  loss:  0.2205  grad_norm:  0.0960  memory: 17.37GiB(36.56%)  tps: 7,384  tflops: 57.73  mfu: 18.50%
[rank1]:2025-12-12 04:28:08,492 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0960  memory:  9.36GiB(19.71%)  tps: 7,384  tflops: 57.73  mfu: 18.50%
[rank2]:2025-12-12 04:28:08,489 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0960  memory:  6.51GiB(13.70%)  tps: 7,384  tflops: 57.73  mfu: 18.50%
[rank0]:2025-12-12 04:28:08,503 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0960  memory: 13.29GiB(27.97%)  tps: 7,384  tflops: 57.73  mfu: 18.50%
[rank0]:2025-12-12 04:28:08,552 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0428_stage0_step600.svg
[rank1]:2025-12-12 04:28:08,552 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0428_stage1_step600.svg
[rank2]:2025-12-12 04:28:08,552 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0428_stage2_step600.svg
[rank3]:2025-12-12 04:28:08,639 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0428_real_step600_rank3.svg
[rank3]:			> Batch Time: 541.70 ms, GPU Bubble Ratio: 72.03%, 57.51%, 64.87%, 31.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-173ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-320ms    | [S0,MB4,B]  364-23-388ms   | [S0,MB5,B]  425-23-449ms   | [S0,MB6,B]  483-22-505ms   | [S0,MB7,B]  525-16-541ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  151-10-161ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  282-24-307ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  334-24-359ms   | [S1,MB7,F]  362-9-372ms    | [S1,MB5,B]  397-24-422ms   | [S1,MB6,B]  455-24-479ms   | [S1,MB7,B]  501-20-521ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  198-19-218ms   | [S2,MB4,F]  221-6-228ms    | [S2,MB3,B]  258-19-277ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  373-19-392ms   | [S2,MB7,F]  396-7-403ms    | [S2,MB6,B]  432-19-451ms   | [S2,MB7,B]  480-16-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  257-17-274ms   | [S3,MB4,B]  280-22-303ms   | [S3,MB5,F]  309-11-320ms   | [S3,MB5,B]  326-41-368ms   | [S3,MB6,F]  372-14-386ms   | [S3,MB6,B]  391-36-427ms   | [S3,MB7,F]  431-17-448ms   | [S3,MB7,B]  454-22-477ms  
[rank3]:2025-12-12 04:28:08,685 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0428_stage3_step600.svg
[rank3]:2025-12-12 04:29:59,485 - INFO - Avg. fwd time: 14.0976 / Avg. bwd time: 33.7449 / Avg. batch time: 456.7377 (ms) / GPU bubble ratio: 16.20%
[rank1]:2025-12-12 04:29:59,546 - INFO - Avg. fwd time: 9.9199 / Avg. bwd time: 19.5986 / Avg. batch time: 521.4193 (ms) / GPU bubble ratio: 54.71%
[rank2]:2025-12-12 04:29:59,514 - INFO - Avg. fwd time: 7.6134 / Avg. bwd time: 16.5503 / Avg. batch time: 485.8620 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-12-12 04:29:59,574 - INFO - Avg. fwd time: 7.9947 / Avg. bwd time: 12.9010 / Avg. batch time: 551.6650 (ms) / GPU bubble ratio: 69.70%
[rank0]:2025-12-12 04:31:46,969 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 04:31:51,347 - INFO - Avg. fwd time: 14.1053 / Avg. bwd time: 33.6958 / Avg. batch time: 456.4140 (ms) / GPU bubble ratio: 16.21%
[rank2]:2025-12-12 04:31:51,375 - INFO - Avg. fwd time: 7.6157 / Avg. bwd time: 16.5334 / Avg. batch time: 485.5125 (ms) / GPU bubble ratio: 60.21%
[rank1]:2025-12-12 04:31:51,407 - INFO - Avg. fwd time: 9.9241 / Avg. bwd time: 19.5656 / Avg. batch time: 521.0517 (ms) / GPU bubble ratio: 54.72%
[rank0]:2025-12-12 04:31:51,435 - INFO - Avg. fwd time: 7.9998 / Avg. bwd time: 12.8063 / Avg. batch time: 551.2640 (ms) / GPU bubble ratio: 69.81%
[rank3]:2025-12-12 04:31:51,469 - INFO -  step: 650  loss:  0.2313  grad_norm:  0.0722  memory: 17.37GiB(36.56%)  tps: 7,348  tflops: 57.45  mfu: 18.41%
[rank2]:2025-12-12 04:31:51,456 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0722  memory:  6.51GiB(13.70%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank1]:2025-12-12 04:31:51,460 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0722  memory:  9.36GiB(19.71%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank0]:2025-12-12 04:31:51,471 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0722  memory: 13.29GiB(27.97%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank3]:2025-12-12 04:33:42,874 - INFO - Avg. fwd time: 14.1123 / Avg. bwd time: 33.6453 / Avg. batch time: 456.0736 (ms) / GPU bubble ratio: 16.23%
[rank2]:2025-12-12 04:33:42,903 - INFO - Avg. fwd time: 7.6178 / Avg. bwd time: 16.5176 / Avg. batch time: 485.1463 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-12-12 04:33:42,935 - INFO - Avg. fwd time: 9.9280 / Avg. bwd time: 19.5350 / Avg. batch time: 520.6677 (ms) / GPU bubble ratio: 54.73%
[rank0]:2025-12-12 04:33:42,964 - INFO - Avg. fwd time: 8.0041 / Avg. bwd time: 12.7115 / Avg. batch time: 550.8456 (ms) / GPU bubble ratio: 69.91%
[rank0]:2025-12-12 04:35:30,055 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:35:34,421 - INFO - Avg. fwd time: 14.1168 / Avg. bwd time: 33.6019 / Avg. batch time: 455.7696 (ms) / GPU bubble ratio: 16.24%
[rank2]:2025-12-12 04:35:34,449 - INFO - Avg. fwd time: 7.6197 / Avg. bwd time: 16.5029 / Avg. batch time: 484.8209 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-12-12 04:35:34,482 - INFO - Avg. fwd time: 9.9315 / Avg. bwd time: 19.5063 / Avg. batch time: 520.3243 (ms) / GPU bubble ratio: 54.74%
[rank0]:2025-12-12 04:35:34,510 - INFO - Avg. fwd time: 8.0078 / Avg. bwd time: 12.6294 / Avg. batch time: 550.4689 (ms) / GPU bubble ratio: 70.01%
[rank0]:2025-12-12 04:35:34,546 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0736  memory: 13.29GiB(27.97%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank3]:2025-12-12 04:35:34,545 - INFO -  step: 700  loss:  0.1908  grad_norm:  0.0736  memory: 17.37GiB(36.56%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank2]:2025-12-12 04:35:34,532 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0736  memory:  6.51GiB(13.70%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank2]:2025-12-12 04:35:34,601 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0435_stage2_step700.svg
[rank1]:2025-12-12 04:35:34,535 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0736  memory:  9.36GiB(19.71%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank1]:2025-12-12 04:35:34,602 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0435_stage1_step700.svg
[rank0]:2025-12-12 04:35:34,599 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0435_stage0_step700.svg
[rank3]:2025-12-12 04:35:34,703 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0435_real_step700_rank3.svg
[rank3]:			> Batch Time: 540.72 ms, GPU Bubble Ratio: 72.06%, 57.38%, 64.75%, 30.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  315-0-315ms    | [S0,MB7,F]  315-6-321ms    | [S0,MB4,B]  365-23-388ms   | [S0,MB5,B]  424-23-448ms   | [S0,MB6,B]  482-21-504ms   | [S0,MB7,B]  524-16-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  238-8-246ms    | [S1,MB3,B]  283-24-307ms   | [S1,MB6,F]  313-9-322ms    | [S1,MB4,B]  335-24-359ms   | [S1,MB7,F]  363-9-372ms    | [S1,MB5,B]  396-24-421ms   | [S1,MB6,B]  454-24-478ms   | [S1,MB7,B]  500-20-520ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  259-19-278ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  311-19-330ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  372-19-391ms   | [S2,MB7,F]  395-7-402ms    | [S2,MB6,B]  432-19-451ms   | [S2,MB7,B]  480-16-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  257-17-274ms   | [S3,MB4,B]  281-22-303ms   | [S3,MB5,F]  309-12-321ms   | [S3,MB5,B]  328-39-367ms   | [S3,MB6,F]  371-14-385ms   | [S3,MB6,B]  391-36-427ms   | [S3,MB7,F]  430-17-447ms   | [S3,MB7,B]  454-22-477ms  
[rank3]:2025-12-12 04:35:34,749 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0435_stage3_step700.svg
[rank3]:2025-12-12 04:37:25,252 - INFO - Avg. fwd time: 14.1203 / Avg. bwd time: 33.5405 / Avg. batch time: 455.3325 (ms) / GPU bubble ratio: 16.26%
[rank2]:2025-12-12 04:37:25,281 - INFO - Avg. fwd time: 7.6214 / Avg. bwd time: 16.4893 / Avg. batch time: 484.3840 (ms) / GPU bubble ratio: 60.18%
[rank1]:2025-12-12 04:37:25,314 - INFO - Avg. fwd time: 9.9349 / Avg. bwd time: 19.4801 / Avg. batch time: 519.8718 (ms) / GPU bubble ratio: 54.73%
[rank0]:2025-12-12 04:37:25,350 - INFO - Avg. fwd time: 8.0112 / Avg. bwd time: 12.5576 / Avg. batch time: 549.9848 (ms) / GPU bubble ratio: 70.08%
[rank0]:2025-12-12 04:39:12,533 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 04:39:16,949 - INFO - Avg. fwd time: 14.1250 / Avg. bwd time: 33.5039 / Avg. batch time: 455.0878 (ms) / GPU bubble ratio: 16.27%
[rank2]:2025-12-12 04:39:16,978 - INFO - Avg. fwd time: 7.6230 / Avg. bwd time: 16.4765 / Avg. batch time: 484.1200 (ms) / GPU bubble ratio: 60.18%
[rank1]:2025-12-12 04:39:17,011 - INFO - Avg. fwd time: 9.9380 / Avg. bwd time: 19.4548 / Avg. batch time: 519.5909 (ms) / GPU bubble ratio: 54.74%
[rank0]:2025-12-12 04:39:17,040 - INFO - Avg. fwd time: 8.0144 / Avg. bwd time: 12.4893 / Avg. batch time: 549.6743 (ms) / GPU bubble ratio: 70.16%
[rank3]:2025-12-12 04:39:17,074 - INFO -  step: 750  loss:  0.2303  grad_norm:  0.0860  memory: 17.37GiB(36.56%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank2]:2025-12-12 04:39:17,062 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0860  memory:  6.51GiB(13.70%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank1]:2025-12-12 04:39:17,065 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0860  memory:  9.36GiB(19.71%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank0]:2025-12-12 04:39:17,076 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0860  memory: 13.29GiB(27.97%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank3]:2025-12-12 04:41:08,673 - INFO - Avg. fwd time: 14.1291 / Avg. bwd time: 33.4720 / Avg. batch time: 454.8737 (ms) / GPU bubble ratio: 16.28%
[rank2]:2025-12-12 04:41:08,703 - INFO - Avg. fwd time: 7.6244 / Avg. bwd time: 16.4642 / Avg. batch time: 483.8858 (ms) / GPU bubble ratio: 60.17%
[rank1]:2025-12-12 04:41:08,736 - INFO - Avg. fwd time: 9.9408 / Avg. bwd time: 19.4306 / Avg. batch time: 519.3400 (ms) / GPU bubble ratio: 54.76%
[rank0]:2025-12-12 04:41:08,766 - INFO - Avg. fwd time: 8.0173 / Avg. bwd time: 12.4163 / Avg. batch time: 549.3951 (ms) / GPU bubble ratio: 70.25%
[rank0]:2025-12-12 04:42:54,785 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 04:42:59,225 - INFO - Avg. fwd time: 14.1318 / Avg. bwd time: 33.4170 / Avg. batch time: 454.4880 (ms) / GPU bubble ratio: 16.30%
[rank2]:2025-12-12 04:42:59,256 - INFO - Avg. fwd time: 7.6259 / Avg. bwd time: 16.4529 / Avg. batch time: 483.4844 (ms) / GPU bubble ratio: 60.16%
[rank1]:2025-12-12 04:42:59,289 - INFO - Avg. fwd time: 9.9436 / Avg. bwd time: 19.4091 / Avg. batch time: 518.9266 (ms) / GPU bubble ratio: 54.75%
[rank0]:2025-12-12 04:42:59,319 - INFO - Avg. fwd time: 8.0200 / Avg. bwd time: 12.3558 / Avg. batch time: 548.9552 (ms) / GPU bubble ratio: 70.31%
[rank0]:2025-12-12 04:42:59,355 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0750  memory: 13.29GiB(27.97%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank0]:2025-12-12 04:42:59,355 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0750  tps: 7,671  tflops: 59.97  mfu: 17.54%
[rank0]:2025-12-12 04:42:59,355 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-12 04:42:59,356 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-12 04:42:59,353 - INFO -  step: 800  loss:  0.2344  grad_norm:  0.0750  memory: 17.37GiB(36.56%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank3]:2025-12-12 04:42:59,354 - INFO -  final step: 800  loss:  0.2344  grad_norm:  0.0750  tps: 7,676  tflops: 60.01  mfu: 17.69%
[rank3]:2025-12-12 04:42:59,354 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-12 04:42:59,355 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-12 04:42:59,340 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0750  memory:  6.51GiB(13.70%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank2]:2025-12-12 04:42:59,341 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0750  tps: 7,671  tflops: 59.97  mfu: 17.54%
[rank2]:2025-12-12 04:42:59,341 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-12 04:42:59,341 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-12 04:42:59,344 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0750  memory:  9.36GiB(19.71%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank1]:2025-12-12 04:42:59,344 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0750  tps: 7,671  tflops: 59.97  mfu: 17.55%
[rank1]:2025-12-12 04:42:59,344 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-12 04:42:59,345 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 04:43:01,355 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-12 04:43:01,425 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251212_0443_stage2_final800.svg
[rank1]:2025-12-12 04:43:01,424 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251212_0443_stage1_final800.svg
[rank0]:2025-12-12 04:43:01,424 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251212_0443_stage0_final800.svg
[rank3]:2025-12-12 04:43:01,506 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0443_real_final800_rank3.svg
[rank3]:			> Batch Time: 542.27 ms, GPU Bubble Ratio: 72.71%, 57.50%, 64.84%, 30.96%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  241-6-247ms    | [S0,MB3,B]  316-0-316ms    | [S0,MB7,F]  316-6-323ms    | [S0,MB4,B]  366-23-390ms   | [S0,MB5,B]  425-23-449ms   | [S0,MB6,B]  483-18-502ms   | [S0,MB7,B]  525-16-542ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-98ms     | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  239-8-248ms    | [S1,MB3,B]  284-24-309ms   | [S1,MB6,F]  314-9-323ms    | [S1,MB4,B]  336-24-360ms   | [S1,MB7,F]  364-9-373ms    | [S1,MB5,B]  397-24-422ms   | [S1,MB6,B]  455-24-479ms   | [S1,MB7,B]  501-20-522ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  138-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-6-230ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  283-7-290ms    | [S2,MB4,B]  312-19-331ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  373-19-392ms   | [S2,MB7,F]  396-7-403ms    | [S2,MB6,B]  433-19-452ms   | [S2,MB7,B]  481-16-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-133ms    | [S3,MB2,F]  136-11-148ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  198-13-212ms   | [S3,MB3,B]  218-36-255ms   | [S3,MB4,F]  259-16-275ms   | [S3,MB4,B]  282-22-304ms   | [S3,MB5,F]  310-12-323ms   | [S3,MB5,B]  329-39-369ms   | [S3,MB6,F]  371-13-385ms   | [S3,MB6,B]  391-36-428ms   | [S3,MB7,F]  431-17-448ms   | [S3,MB7,B]  455-22-478ms  
[rank2]:2025-12-12 04:43:01,581 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251212_0443_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank1]:2025-12-12 04:43:01,574 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251212_0443_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank0]:2025-12-12 04:43:01,582 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251212_0443_rank0_stage0.svg
[rank0]:	> Counts Sum: 321200, Total Sum: 1728640 (18.58%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.03, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.12, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank3]:2025-12-12 04:43:01,636 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251212_0443_thry_final800_rank3.svg
[rank3]:			> Batch Time: 329.29 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  99-19-119ms    | [S0,MB4,F]  119-9-129ms    | [S0,MB1,B]  129-19-149ms   | [S0,MB5,F]  149-9-159ms    | [S0,MB2,B]  159-19-179ms   | [S0,MB6,F]  179-9-189ms    | [S0,MB3,B]  189-19-209ms   | [S0,MB7,F]  209-9-219ms    | [S0,MB4,B]  219-19-239ms   | [S0,MB5,B]  249-19-269ms   | [S0,MB6,B]  279-19-299ms   | [S0,MB7,B]  309-19-329ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB0,B]  79-19-99ms     | [S1,MB3,F]  99-9-109ms     | [S1,MB1,B]  109-19-129ms   | [S1,MB4,F]  129-9-139ms    | [S1,MB2,B]  139-19-159ms   | [S1,MB5,F]  159-9-169ms    | [S1,MB3,B]  169-19-189ms   | [S1,MB6,F]  189-9-199ms    | [S1,MB4,B]  199-19-219ms   | [S1,MB7,F]  219-9-229ms    | [S1,MB5,B]  229-19-249ms   | [S1,MB6,B]  259-19-279ms   | [S1,MB7,B]  289-19-309ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB0,B]  59-19-79ms     | [S2,MB2,F]  79-9-89ms      | [S2,MB1,B]  89-19-109ms    | [S2,MB3,F]  109-9-119ms    | [S2,MB2,B]  119-19-139ms   | [S2,MB4,F]  139-9-149ms    | [S2,MB3,B]  149-19-169ms   | [S2,MB5,F]  169-9-179ms    | [S2,MB4,B]  179-19-199ms   | [S2,MB6,F]  199-9-209ms    | [S2,MB5,B]  209-19-229ms   | [S2,MB7,F]  229-9-239ms    | [S2,MB6,B]  239-19-259ms   | [S2,MB7,B]  269-19-289ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB0,B]  39-19-59ms     | [S3,MB1,F]  59-9-69ms      | [S3,MB1,B]  69-19-89ms     | [S3,MB2,F]  89-9-99ms      | [S3,MB2,B]  99-19-119ms    | [S3,MB3,F]  119-9-129ms    | [S3,MB3,B]  129-19-149ms   | [S3,MB4,F]  149-9-159ms    | [S3,MB4,B]  159-19-179ms   | [S3,MB5,F]  179-9-189ms    | [S3,MB5,B]  189-19-209ms   | [S3,MB6,F]  209-9-219ms    | [S3,MB6,B]  219-19-239ms   | [S3,MB7,F]  239-9-249ms    | [S3,MB7,B]  249-19-269ms  
[rank3]:2025-12-12 04:43:01,684 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251212_0443_stage3_final800.svg
[rank3]:2025-12-12 04:43:01,818 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251212_0443_rank3_stage3.svg
[rank3]:	> Counts Sum: 520640, Total Sum: 1354880 (38.43%), Ratio(%) per element: [38.86, 38.69, 37.5, 38.01, 37.32, 39.21, 38.86, 38.18, 38.18, 37.5, 39.38, 38.18, 39.38, 38.18, 39.21, 38.52, 38.86, 38.86, 37.15, 37.67, 39.38, 39.04, 38.01, 38.52, 38.18, 38.18, 38.52, 37.84, 38.86]
[rank0]:2025-12-12 04:43:03,415 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251212_0443_stage0.svg
[rank0]:2025-12-12 04:43:03,418 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-12 04:43:03,496 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251212_0443_stage2.svg
[rank2]:2025-12-12 04:43:03,499 - INFO - Destroying the purge thread.
[rank1]:2025-12-12 04:43:03,452 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251212_0443_stage1.svg
[rank1]:2025-12-12 04:43:03,455 - INFO - Destroying the purge thread.
[rank3]:2025-12-12 04:43:03,641 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251212_0443_stage3.svg
[rank3]:2025-12-12 04:43:03,645 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-12 04:43:03,821 - INFO - Process group destroyed
[rank1]:2025-12-12 04:43:03,827 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 16-16, summary, console lines 320-338
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.26881
[rank3]:wandb:               final/avg_loss 0.23443
[rank3]:wandb:             final/avg_mfu(%) 17.68886
[rank3]:wandb:             final/avg_tflops 60.0086
[rank3]:wandb:    final/avg_throughput(tps) 7676.14902
[rank3]:wandb:              final/grad_norm 0.07499
[rank3]:wandb:               final/max_loss 0.23443
[rank3]:wandb:                    grad_norm 0.07499
[rank3]:wandb: loss_metrics/global_avg_loss 0.23443
[rank3]:wandb: loss_metrics/global_max_loss 0.23443
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1212_1F1B_fullrand7_mfr0.4_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/xy02tfhe
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.4_42_dm1/20251212-0342/wandb/run-20251212_034229-xy02tfhe/logs
[rank3]:2025-12-12 04:43:04,798 - INFO - Process group destroyed
[rank0]:2025-12-12 04:43:05,419 - INFO - Training completed
[rank0]:2025-12-12 04:43:05,419 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 04:43:05,815 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.2', 'layers.0', 'layers.3', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.8', 'layers.6', 'layers.5', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.13', 'output', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1212_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.4
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
