
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 12. (ê¸ˆ) 06:40:16 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1212_1F1B_fullrand7_mfr0.9_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver

âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.9) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
1212: everything same as 1128, but qp solver -> lp solver
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.9
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-12 06:40:22,298 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank0]:1212: everything same as 1128, but qp solver -> lp solver
[rank0]:"
[rank2]:2025-12-12 06:40:22,412 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank2]:1212: everything same as 1128, but qp solver -> lp solver
[rank2]:"
[rank0]:2025-12-12 06:40:22,453 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-12 06:40:22,456 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 06:40:22,459 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-12 06:40:22,460 - INFO - Loading tokenizer from tokenizer.json
[rank3]:2025-12-12 06:40:22,414 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank1]:2025-12-12 06:40:22,515 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank1]:1212: everything same as 1128, but qp solver -> lp solver
[rank1]:"
[rank2]:2025-12-12 06:40:22,661 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-12 06:40:22,664 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-12 06:40:22,665 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-12 06:40:22,668 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-12 06:40:22,726 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-12 06:40:22,728 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-12 06:40:22,835 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-12 06:40:26,072 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-12 06:40:26,267 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 06:40:26,224 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 06:40:26,262 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 06:40:26,263 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-12-12 06:40:26,307 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 06:40:26,336 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-12 06:40:26,336 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-12 06:40:26,288 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank2]:2025-12-12 06:40:26,333 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-12 06:40:26,288 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-12 06:40:26,370 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 06:40:26,397 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-12 06:40:26,397 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 06:40:26,521 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-12 06:40:26,521 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-12 06:40:26,521 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-12 06:40:26,481 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 06:40:26,481 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-12 06:40:26,482 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-12 06:40:26,581 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-12 06:40:26,581 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-12 06:40:26,582 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run idu76s32
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.9_42_dm1/20251212-0640/wandb/run-20251212_064027-idu76s32
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/idu76s32
[rank3]:2025-12-12 06:40:28,758 - INFO - WandB logging enabled
[rank3]:2025-12-12 06:40:28,758 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-12 06:40:28,799 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-12 06:40:28,827 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-12 06:40:28,827 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-12 06:40:29,040 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 06:40:29,040 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank2]:2025-12-12 06:40:29,040 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-12 06:40:29,022 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-12 06:40:29,040 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 06:40:29,040 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank3]:2025-12-12 06:40:29,022 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-12 06:40:29,023 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-12-12 06:40:29,040 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-12 06:40:29,040 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-12 06:40:31,049 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-12 06:40:31,049 - INFO - Finished loading the checkpoint in 2.01 seconds.
[rank0]:2025-12-12 06:40:31,050 - INFO - Training starts at step 1
[rank3]:2025-12-12 06:40:36,667 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5372  memory: 12.97GiB(27.31%)  tps: 4,166  tflops: 32.57  mfu: 10.44%
[rank3]:2025-12-12 06:40:36,668 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 06:40:36,663 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  6.76GiB(14.24%)  tps: 3,164  tflops: 24.74  mfu: 7.93%
[rank1]:2025-12-12 06:40:36,663 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-12 06:40:36,657 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  4.63GiB(9.75%)  tps: 3,185  tflops: 24.90  mfu: 7.98%
[rank2]:2025-12-12 06:40:36,658 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-12 06:40:36,695 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory:  9.19GiB(19.34%)  tps: 3,141  tflops: 24.56  mfu: 7.87%
[rank0]:2025-12-12 06:40:36,695 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-12 06:42:38,330 - INFO - Avg. fwd time: 9.3086 / Avg. bwd time: 23.8780 / Avg. batch time: 581.2544 (ms) / GPU bubble ratio: 54.32%
[rank3]:2025-12-12 06:42:38,278 - INFO - Avg. fwd time: 13.1785 / Avg. bwd time: 41.5475 / Avg. batch time: 510.3049 (ms) / GPU bubble ratio: 14.21%
[rank2]:2025-12-12 06:42:38,302 - INFO - Avg. fwd time: 7.2673 / Avg. bwd time: 18.9386 / Avg. batch time: 542.3006 (ms) / GPU bubble ratio: 61.34%
[rank0]:2025-12-12 06:42:38,358 - INFO - Avg. fwd time: 7.3342 / Avg. bwd time: 23.5280 / Avg. batch time: 618.2888 (ms) / GPU bubble ratio: 60.07%
[rank0]:2025-12-12 06:44:40,754 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-12 06:44:45,782 - INFO - Avg. fwd time: 9.3222 / Avg. bwd time: 23.9382 / Avg. batch time: 582.7921 (ms) / GPU bubble ratio: 54.34%
[rank0]:2025-12-12 06:44:45,811 - INFO - Avg. fwd time: 7.3360 / Avg. bwd time: 23.5652 / Avg. batch time: 619.4541 (ms) / GPU bubble ratio: 60.09%
[rank3]:2025-12-12 06:44:45,730 - INFO - Avg. fwd time: 13.2870 / Avg. bwd time: 41.7311 / Avg. batch time: 512.5071 (ms) / GPU bubble ratio: 14.12%
[rank2]:2025-12-12 06:44:45,754 - INFO - Avg. fwd time: 7.2664 / Avg. bwd time: 18.9760 / Avg. batch time: 544.1462 (ms) / GPU bubble ratio: 61.42%
[rank1]:2025-12-12 06:44:45,835 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8201  memory:  9.03GiB(19.01%)  tps: 6,444  tflops: 50.38  mfu: 16.15%
[rank0]:2025-12-12 06:44:45,847 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8201  memory: 12.97GiB(27.31%)  tps: 6,444  tflops: 50.38  mfu: 16.15%
[rank3]:2025-12-12 06:44:45,844 - INFO -  step: 50  loss:  9.9198  grad_norm: 12.8201  memory: 16.39GiB(34.50%)  tps: 6,444  tflops: 50.37  mfu: 16.15%
[rank2]:2025-12-12 06:44:45,832 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8201  memory:  6.43GiB(13.53%)  tps: 6,444  tflops: 50.37  mfu: 16.15%
[rank3]:2025-12-12 06:45:36,805 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-12 06:46:28,037 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-12 06:46:28,161 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-12 06:46:45,270 - INFO - Avg. fwd time: 7.3652 / Avg. bwd time: 18.3038 / Avg. batch time: 534.1536 (ms) / GPU bubble ratio: 61.56%
[rank3]:2025-12-12 06:46:45,255 - INFO - Avg. fwd time: 13.4055 / Avg. bwd time: 40.4707 / Avg. batch time: 503.3297 (ms) / GPU bubble ratio: 14.37%
[rank1]:2025-12-12 06:46:45,285 - INFO - Avg. fwd time: 9.4423 / Avg. bwd time: 23.1001 / Avg. batch time: 571.8196 (ms) / GPU bubble ratio: 54.47%
[rank0]:2025-12-12 06:46:45,290 - INFO - Avg. fwd time: 7.4224 / Avg. bwd time: 22.0238 / Avg. batch time: 606.7799 (ms) / GPU bubble ratio: 61.18%
[rank3]:2025-12-12 06:47:02,365 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-12 06:47:02,540 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0647_max_batch_time.svg
[rank3]:			> Batch Time: 535.90 ms, GPU Bubble Ratio: 53.71%, 50.34%, 60.79%, 17.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  125-23-149ms   | [S0,MB4,F]  149-6-156ms    | [S0,MB1,B]  177-23-200ms   | [S0,MB5,F]  200-6-207ms    | [S0,MB2,B]  231-23-255ms   | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  287-23-310ms   | [S0,MB7,F]  310-6-317ms    | [S0,MB4,B]  342-23-366ms   | [S0,MB5,B]  400-23-423ms   | [S0,MB6,B]  456-23-480ms   | [S0,MB7,B]  512-23-535ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  101-24-125ms   | [S1,MB3,F]  125-8-134ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  207-24-231ms   | [S1,MB5,F]  231-8-240ms    | [S1,MB3,B]  263-24-287ms   | [S1,MB6,F]  287-9-296ms    | [S1,MB4,B]  318-24-342ms   | [S1,MB7,F]  342-9-352ms    | [S1,MB5,B]  376-24-400ms   | [S1,MB6,B]  432-23-456ms   | [S1,MB7,B]  488-23-512ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  133-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  188-18-207ms   | [S2,MB4,F]  207-6-214ms    | [S2,MB3,B]  244-19-263ms   | [S2,MB5,F]  263-6-270ms    | [S2,MB4,B]  299-19-318ms   | [S2,MB6,F]  318-7-325ms    | [S2,MB5,B]  357-19-376ms   | [S2,MB7,F]  376-6-383ms    | [S2,MB6,B]  413-19-432ms   | [S2,MB7,B]  469-19-488ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-133ms    AFR(10):0.9655 | [S3,MB2,F]  133-13-147ms   | [S3,MB2,B]  147-41-188ms   AFR(10):0.9655 | [S3,MB3,F]  188-13-201ms   | [S3,MB3,B]  201-42-244ms   AFR(10):0.9655 | [S3,MB4,F]  244-14-258ms   | [S3,MB4,B]  258-41-299ms   AFR(10):0.9655 | [S3,MB5,F]  299-14-314ms   | [S3,MB5,B]  314-42-357ms   AFR(10):0.9655 | [S3,MB6,F]  357-13-370ms   | [S3,MB6,B]  370-42-413ms   AFR(10):0.9655 | [S3,MB7,F]  413-14-427ms   | [S3,MB7,B]  427-41-469ms   AFR(10):0.9655
[rank3]:2025-12-12 06:47:02,668 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0647_min_batch_time.svg
[rank3]:			> Batch Time: 328.17 ms, GPU Bubble Ratio: 82.17%, 50.94%, 61.53%, 14.77%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-157ms    | [S0,MB3,B]  185-0-185ms    | [S0,MB7,F]  185-6-192ms    | [S0,MB4,B]  220-0-220ms    | [S0,MB5,B]  257-0-257ms    | [S0,MB6,B]  292-0-292ms    | [S0,MB7,B]  328-0-328ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-124ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-8-159ms    | [S1,MB3,B]  174-11-185ms   | [S1,MB6,F]  185-9-194ms    | [S1,MB4,B]  209-11-220ms   | [S1,MB7,F]  220-9-230ms    | [S1,MB5,B]  246-11-257ms   | [S1,MB6,B]  281-10-292ms   | [S1,MB7,B]  317-10-328ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  63-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-6-111ms    | [S2,MB2,B]  130-8-139ms    | [S2,MB4,F]  139-6-146ms    | [S2,MB3,B]  165-8-174ms    | [S2,MB5,F]  174-6-181ms    | [S2,MB4,B]  201-8-209ms    | [S2,MB6,F]  209-7-216ms    | [S2,MB5,B]  237-8-246ms    | [S2,MB7,F]  246-6-253ms    | [S2,MB6,B]  273-8-281ms    | [S2,MB7,B]  308-8-317ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-63ms     AFR(10):0.9655 | [S3,MB1,F]  63-10-74ms     | [S3,MB1,B]  74-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-109ms    | [S3,MB2,B]  109-21-130ms   AFR(10):0.9655 | [S3,MB3,F]  130-13-143ms   | [S3,MB3,B]  143-21-165ms   AFR(10):0.9655 | [S3,MB4,F]  165-14-179ms   | [S3,MB4,B]  179-21-201ms   AFR(10):0.9655 | [S3,MB5,F]  201-14-215ms   | [S3,MB5,B]  215-22-237ms   AFR(10):0.9655 | [S3,MB6,F]  237-13-251ms   | [S3,MB6,B]  251-21-273ms   AFR(10):0.9655 | [S3,MB7,F]  273-14-287ms   | [S3,MB7,B]  287-21-308ms   AFR(10):0.9655
[rank3]:2025-12-12 06:47:02,807 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0647_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 342.94 ms, GPU Bubble Ratio: 37.93%, 26.21%, 41.78%, 14.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  122-23-145ms   | [S0,MB4,F]  145-6-152ms    | [S0,MB1,B]  155-23-178ms   | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  188-23-212ms   | [S0,MB6,F]  212-6-219ms    | [S0,MB3,B]  223-23-247ms   | [S0,MB7,F]  247-6-254ms    | [S0,MB4,B]  259-23-282ms   | [S0,MB5,B]  295-23-319ms   | [S0,MB6,B]  330-12-342ms   | [S0,MB7,B]  342-0-342ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-37ms      | [S1,MB0,B]  97-24-122ms    | [S1,MB3,F]  122-8-130ms    | [S1,MB1,B]  130-24-155ms   | [S1,MB4,F]  155-9-164ms    | [S1,MB2,B]  164-24-188ms   | [S1,MB5,F]  188-8-197ms    | [S1,MB3,B]  199-24-223ms   | [S1,MB6,F]  223-9-232ms    | [S1,MB4,B]  235-24-259ms   | [S1,MB7,F]  259-9-268ms    | [S1,MB5,B]  271-24-295ms   | [S1,MB6,B]  306-23-330ms   | [S1,MB7,B]  332-10-342ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  78-19-97ms     | [S2,MB2,F]  97-6-104ms     | [S2,MB1,B]  110-19-130ms   | [S2,MB3,F]  130-6-137ms    | [S2,MB2,B]  145-18-164ms   | [S2,MB4,F]  164-6-171ms    | [S2,MB3,B]  180-19-199ms   | [S2,MB5,F]  199-6-206ms    | [S2,MB4,B]  216-19-235ms   | [S2,MB6,F]  235-7-242ms    | [S2,MB5,B]  252-19-271ms   | [S2,MB7,F]  271-6-278ms    | [S2,MB6,B]  287-19-306ms   | [S2,MB7,B]  323-8-332ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-35-78ms     AFR(10):0.9655 | [S3,MB1,F]  78-10-89ms     | [S3,MB1,B]  89-21-110ms    AFR(10):0.9655 | [S3,MB2,F]  110-13-124ms   | [S3,MB2,B]  124-21-145ms   AFR(10):0.9655 | [S3,MB3,F]  145-13-158ms   | [S3,MB3,B]  158-21-180ms   AFR(10):0.9655 | [S3,MB4,F]  180-14-194ms   | [S3,MB4,B]  194-21-216ms   AFR(10):0.9655 | [S3,MB5,F]  216-14-230ms   | [S3,MB5,B]  230-22-252ms   AFR(10):0.9655 | [S3,MB6,F]  252-13-266ms   | [S3,MB6,B]  266-21-287ms   AFR(10):0.9655 | [S3,MB7,F]  287-14-301ms   | [S3,MB7,B]  301-21-323ms   AFR(10):0.9655
[rank3]:2025-12-12 06:47:02,807 - INFO - 	> Batch Time: 342.94 ms (Average Freeze Ratio: 0.33, Time Reduction Rate: 0.36)
[rank0]:2025-12-12 06:48:22,454 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 06:48:26,881 - INFO - Avg. fwd time: 13.5684 / Avg. bwd time: 37.1347 / Avg. batch time: 477.9576 (ms) / GPU bubble ratio: 15.13%
[rank3]:2025-12-12 06:48:26,886 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.07(0.07)/0.20, [MB1] 0.28(0.33)/1.00, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-12 06:48:26,905 - INFO - Avg. fwd time: 7.4699 / Avg. bwd time: 17.5931 / Avg. batch time: 508.4367 (ms) / GPU bubble ratio: 60.56%
[rank2]:2025-12-12 06:48:26,911 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank3]:2025-12-12 06:48:26,993 - INFO -  step: 100  loss:  8.8867  grad_norm:  5.1429  memory: 17.37GiB(36.56%)  tps: 7,409  tflops: 57.92  mfu: 18.56%
[rank1]:2025-12-12 06:48:26,934 - INFO - Avg. fwd time: 9.5898 / Avg. bwd time: 22.0568 / Avg. batch time: 545.2987 (ms) / GPU bubble ratio: 53.57%
[rank1]:2025-12-12 06:48:26,941 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-12 06:48:26,984 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.1429  memory:  9.36GiB(19.71%)  tps: 7,409  tflops: 57.92  mfu: 18.56%
[rank2]:2025-12-12 06:48:26,981 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.1429  memory:  6.51GiB(13.70%)  tps: 7,409  tflops: 57.92  mfu: 18.56%
[rank0]:2025-12-12 06:48:26,959 - INFO - Avg. fwd time: 7.5547 / Avg. bwd time: 19.4318 / Avg. batch time: 578.2400 (ms) / GPU bubble ratio: 62.66%
[rank0]:2025-12-12 06:48:26,967 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-12 06:48:26,995 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.1429  memory: 12.97GiB(27.31%)  tps: 7,409  tflops: 57.92  mfu: 18.56%
[rank1]:2025-12-12 06:48:27,062 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0648_stage1_step100.svg
[rank2]:2025-12-12 06:48:27,055 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0648_stage2_step100.svg
[rank0]:2025-12-12 06:48:27,054 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0648_stage0_step100.svg
[rank3]:2025-12-12 06:48:27,133 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0648_real_step100_rank3.svg
[rank3]:			> Batch Time: 558.30 ms, GPU Bubble Ratio: 61.93%, 53.38%, 63.14%, 31.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  126-16-143ms   | [S0,MB4,F]  143-7-150ms    | [S0,MB1,B]  188-16-204ms   | [S0,MB5,F]  204-6-211ms    | [S0,MB2,B]  249-16-266ms   | [S0,MB6,F]  266-6-273ms    | [S0,MB3,B]  312-16-329ms   | [S0,MB7,F]  329-6-336ms    | [S0,MB4,B]  378-23-402ms   | [S0,MB5,B]  436-23-459ms   | [S0,MB6,B]  490-19-509ms   | [S0,MB7,B]  539-19-558ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  35-9-45ms      | [S1,MB0,B]  100-21-121ms   | [S1,MB3,F]  125-9-134ms    | [S1,MB1,B]  162-21-183ms   | [S1,MB4,F]  186-9-195ms    | [S1,MB2,B]  223-21-245ms   | [S1,MB5,F]  248-8-257ms    | [S1,MB3,B]  284-24-308ms   | [S1,MB6,F]  311-9-320ms    | [S1,MB4,B]  348-24-373ms   | [S1,MB7,F]  376-9-385ms    | [S1,MB5,B]  408-24-432ms   | [S1,MB6,B]  462-24-486ms   | [S1,MB7,B]  511-23-535ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  78-16-95ms     | [S2,MB2,F]  98-7-106ms     | [S2,MB1,B]  140-16-157ms   | [S2,MB3,F]  160-6-167ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  259-19-279ms   | [S2,MB5,F]  282-7-289ms    | [S2,MB4,B]  324-19-343ms   | [S2,MB6,F]  347-7-354ms    | [S2,MB5,B]  384-19-403ms   | [S2,MB7,F]  406-7-413ms    | [S2,MB6,B]  440-19-459ms   | [S2,MB7,B]  490-18-508ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-25-74ms     | [S3,MB1,F]  77-13-90ms     | [S3,MB1,B]  96-38-135ms    | [S3,MB2,F]  139-12-151ms   | [S3,MB2,B]  156-37-194ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-37-255ms   | [S3,MB4,F]  258-13-271ms   | [S3,MB4,B]  278-40-319ms   | [S3,MB5,F]  323-13-336ms   | [S3,MB5,B]  342-36-379ms   | [S3,MB6,F]  382-15-397ms   | [S3,MB6,B]  404-30-435ms   | [S3,MB7,F]  438-14-452ms   | [S3,MB7,B]  459-26-486ms  
[rank3]:2025-12-12 06:48:27,175 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0648_stage3_step100.svg
[rank3]:2025-12-12 06:50:22,279 - INFO - Avg. fwd time: 13.5979 / Avg. bwd time: 36.5919 / Avg. batch time: 473.9792 (ms) / GPU bubble ratio: 15.29%
[rank1]:2025-12-12 06:50:22,332 - INFO - Avg. fwd time: 9.5825 / Avg. bwd time: 22.1103 / Avg. batch time: 541.4880 (ms) / GPU bubble ratio: 53.18%
[rank2]:2025-12-12 06:50:22,304 - INFO - Avg. fwd time: 7.4542 / Avg. bwd time: 17.7015 / Avg. batch time: 504.5361 (ms) / GPU bubble ratio: 60.11%
[rank0]:2025-12-12 06:50:22,356 - INFO - Avg. fwd time: 7.5650 / Avg. bwd time: 19.5503 / Avg. batch time: 574.4949 (ms) / GPU bubble ratio: 62.24%
[rank0]:2025-12-12 06:52:06,264 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 06:52:10,504 - INFO - Avg. fwd time: 13.6913 / Avg. bwd time: 35.4482 / Avg. batch time: 465.8647 (ms) / GPU bubble ratio: 15.62%
[rank3]:2025-12-12 06:52:10,509 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.10(0.13)/0.20, [MB1] 0.59(0.67)/1.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-12 06:52:10,527 - INFO - Avg. fwd time: 7.4652 / Avg. bwd time: 17.6189 / Avg. batch time: 496.2376 (ms) / GPU bubble ratio: 59.56%
[rank2]:2025-12-12 06:52:10,533 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank2]:2025-12-12 06:52:10,603 - INFO -  step: 150  loss: -8.0000  grad_norm:  2.2625  memory:  6.51GiB(13.70%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank1]:2025-12-12 06:52:10,554 - INFO - Avg. fwd time: 9.6109 / Avg. bwd time: 21.9305 / Avg. batch time: 533.1233 (ms) / GPU bubble ratio: 52.67%
[rank1]:2025-12-12 06:52:10,561 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank1]:2025-12-12 06:52:10,607 - INFO -  step: 150  loss: -8.0000  grad_norm:  2.2625  memory:  9.36GiB(19.71%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank0]:2025-12-12 06:52:10,582 - INFO - Avg. fwd time: 7.6198 / Avg. bwd time: 19.3290 / Avg. batch time: 566.0481 (ms) / GPU bubble ratio: 61.91%
[rank0]:2025-12-12 06:52:10,589 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-12 06:52:10,618 - INFO -  step: 150  loss: -8.0000  grad_norm:  2.2625  memory: 13.29GiB(27.97%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank3]:2025-12-12 06:52:10,614 - INFO -  step: 150  loss:  4.7088  grad_norm:  2.2625  memory: 17.37GiB(36.56%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank2]:2025-12-12 06:53:55,021 - INFO - Avg. fwd time: 7.4748 / Avg. bwd time: 17.5660 / Avg. batch time: 487.9647 (ms) / GPU bubble ratio: 58.95%
[rank1]:2025-12-12 06:53:55,048 - INFO - Avg. fwd time: 9.6487 / Avg. bwd time: 21.6937 / Avg. batch time: 524.7431 (ms) / GPU bubble ratio: 52.22%
[rank3]:2025-12-12 06:53:54,998 - INFO - Avg. fwd time: 13.7629 / Avg. bwd time: 34.3004 / Avg. batch time: 457.6239 (ms) / GPU bubble ratio: 15.98%
[rank0]:2025-12-12 06:53:55,071 - INFO - Avg. fwd time: 7.6664 / Avg. bwd time: 18.9245 / Avg. batch time: 557.3266 (ms) / GPU bubble ratio: 61.83%
[rank0]:2025-12-12 06:55:30,267 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 06:55:34,120 - INFO - Avg. fwd time: 13.8405 / Avg. bwd time: 33.0764 / Avg. batch time: 448.4269 (ms) / GPU bubble ratio: 16.30%
[rank3]:2025-12-12 06:55:34,125 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.17(0.20)/0.20, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 06:55:34,171 - INFO - Avg. fwd time: 9.6941 / Avg. bwd time: 21.4286 / Avg. batch time: 515.2178 (ms) / GPU bubble ratio: 51.67%
[rank2]:2025-12-12 06:55:34,143 - INFO - Avg. fwd time: 7.4986 / Avg. bwd time: 17.4233 / Avg. batch time: 478.5501 (ms) / GPU bubble ratio: 58.34%
[rank2]:2025-12-12 06:55:34,149 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank0]:2025-12-12 06:55:34,194 - INFO - Avg. fwd time: 7.7180 / Avg. bwd time: 18.2895 / Avg. batch time: 547.4685 (ms) / GPU bubble ratio: 62.00%
[rank0]:2025-12-12 06:55:34,202 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank3]:2025-12-12 06:55:34,204 - INFO -  step: 200  loss:  2.8927  grad_norm:  1.4236  memory: 17.37GiB(36.56%)  tps: 8,048  tflops: 62.91  mfu: 20.16%
[rank1]:2025-12-12 06:55:34,178 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-12 06:55:34,219 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4236  memory:  9.36GiB(19.71%)  tps: 8,047  tflops: 62.91  mfu: 20.16%
[rank2]:2025-12-12 06:55:34,216 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4236  memory:  6.51GiB(13.70%)  tps: 8,047  tflops: 62.91  mfu: 20.16%
[rank0]:2025-12-12 06:55:34,231 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4236  memory: 13.29GiB(27.97%)  tps: 8,047  tflops: 62.91  mfu: 20.16%
[rank0]:2025-12-12 06:55:34,282 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0655_stage0_step200.svg
[rank1]:2025-12-12 06:55:34,284 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0655_stage1_step200.svg
[rank2]:2025-12-12 06:55:34,281 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0655_stage2_step200.svg
[rank3]:2025-12-12 06:55:34,373 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0655_real_step200_rank3.svg
[rank3]:			> Batch Time: 468.86 ms, GPU Bubble Ratio: 64.15%, 49.23%, 59.06%, 35.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  105-4-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  162-4-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  219-4-224ms    | [S0,MB6,F]  224-6-231ms    | [S0,MB3,B]  277-4-282ms    | [S0,MB7,F]  282-6-289ms    | [S0,MB4,B]  325-23-348ms   | [S0,MB5,B]  369-23-393ms   | [S0,MB6,B]  413-18-432ms   | [S0,MB7,B]  451-17-468ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  88-12-100ms    | [S1,MB3,F]  104-10-114ms   | [S1,MB1,B]  145-12-157ms   | [S1,MB4,F]  161-8-169ms    | [S1,MB2,B]  201-12-214ms   | [S1,MB5,F]  218-8-226ms    | [S1,MB3,B]  248-24-272ms   | [S1,MB6,F]  276-9-285ms    | [S1,MB4,B]  294-24-319ms   | [S1,MB7,F]  323-9-332ms    | [S1,MB5,B]  340-25-365ms   | [S1,MB6,B]  385-24-410ms   | [S1,MB7,B]  426-21-447ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-83ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  131-8-139ms    | [S2,MB3,F]  143-6-150ms    | [S2,MB2,B]  177-19-197ms   | [S2,MB4,F]  200-7-207ms    | [S2,MB3,B]  223-19-243ms   | [S2,MB5,F]  246-7-253ms    | [S2,MB4,B]  270-19-289ms   | [S2,MB6,F]  293-7-300ms    | [S2,MB5,B]  316-19-335ms   | [S2,MB7,F]  339-7-346ms    | [S2,MB6,B]  363-19-382ms   | [S2,MB7,B]  407-16-423ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-33-126ms    | [S3,MB2,F]  129-15-145ms   | [S3,MB2,B]  150-21-172ms   | [S3,MB3,F]  176-14-190ms   | [S3,MB3,B]  196-22-218ms   | [S3,MB4,F]  222-14-236ms   | [S3,MB4,B]  242-22-265ms   | [S3,MB5,F]  268-14-283ms   | [S3,MB5,B]  289-21-311ms   | [S3,MB6,F]  315-14-329ms   | [S3,MB6,B]  335-22-357ms   | [S3,MB7,F]  361-14-376ms   | [S3,MB7,B]  381-22-404ms  
[rank3]:2025-12-12 06:55:34,418 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0655_stage3_step200.svg
[rank3]:2025-12-12 06:57:10,597 - INFO - Avg. fwd time: 13.9060 / Avg. bwd time: 31.9423 / Avg. batch time: 439.8117 (ms) / GPU bubble ratio: 16.60%
[rank1]:2025-12-12 06:57:10,648 - INFO - Avg. fwd time: 9.7403 / Avg. bwd time: 21.1668 / Avg. batch time: 506.3296 (ms) / GPU bubble ratio: 51.17%
[rank2]:2025-12-12 06:57:10,620 - INFO - Avg. fwd time: 7.5212 / Avg. bwd time: 17.2880 / Avg. batch time: 469.7834 (ms) / GPU bubble ratio: 57.75%
[rank0]:2025-12-12 06:57:10,671 - INFO - Avg. fwd time: 7.7631 / Avg. bwd time: 17.4263 / Avg. batch time: 538.2633 (ms) / GPU bubble ratio: 62.56%
[rank0]:2025-12-12 06:58:43,075 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 06:58:46,841 - INFO - Avg. fwd time: 13.9555 / Avg. bwd time: 31.0345 / Avg. batch time: 432.8934 (ms) / GPU bubble ratio: 16.86%
[rank3]:2025-12-12 06:58:46,856 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.21(0.20)/0.20, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 06:58:46,866 - INFO - Avg. fwd time: 7.5386 / Avg. bwd time: 17.1834 / Avg. batch time: 462.6946 (ms) / GPU bubble ratio: 57.26%
[rank2]:2025-12-12 06:58:46,872 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 06:58:46,893 - INFO - Avg. fwd time: 9.7757 / Avg. bwd time: 20.9617 / Avg. batch time: 499.1545 (ms) / GPU bubble ratio: 50.74%
[rank1]:2025-12-12 06:58:46,900 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 06:58:46,917 - INFO - Avg. fwd time: 7.7973 / Avg. bwd time: 16.7178 / Avg. batch time: 530.8303 (ms) / GPU bubble ratio: 63.05%
[rank0]:2025-12-12 06:58:46,924 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 06:58:46,953 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4017  memory: 13.29GiB(27.97%)  tps: 8,501  tflops: 66.46  mfu: 21.30%
[rank3]:2025-12-12 06:58:46,926 - INFO -  step: 250  loss:  2.8097  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,501  tflops: 66.46  mfu: 21.30%
[rank2]:2025-12-12 06:58:46,938 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4017  memory:  6.51GiB(13.70%)  tps: 8,501  tflops: 66.46  mfu: 21.30%
[rank1]:2025-12-12 06:58:46,942 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4017  memory:  9.36GiB(19.71%)  tps: 8,501  tflops: 66.46  mfu: 21.30%
[rank3]:2025-12-12 07:00:22,358 - INFO - Avg. fwd time: 13.9892 / Avg. bwd time: 30.2582 / Avg. batch time: 426.9059 (ms) / GPU bubble ratio: 17.08%
[rank2]:2025-12-12 07:00:22,382 - INFO - Avg. fwd time: 7.5524 / Avg. bwd time: 17.0976 / Avg. batch time: 456.5663 (ms) / GPU bubble ratio: 56.81%
[rank1]:2025-12-12 07:00:22,409 - INFO - Avg. fwd time: 9.8041 / Avg. bwd time: 20.7931 / Avg. batch time: 492.9489 (ms) / GPU bubble ratio: 50.34%
[rank0]:2025-12-12 07:00:22,433 - INFO - Avg. fwd time: 7.8248 / Avg. bwd time: 16.1535 / Avg. batch time: 524.4131 (ms) / GPU bubble ratio: 63.42%
[rank0]:2025-12-12 07:01:55,025 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 07:01:58,789 - INFO - Avg. fwd time: 14.0250 / Avg. bwd time: 29.6497 / Avg. batch time: 422.2861 (ms) / GPU bubble ratio: 17.26%
[rank3]:2025-12-12 07:01:58,803 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.21(0.20)/0.20, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-12 07:01:58,813 - INFO - Avg. fwd time: 7.5643 / Avg. bwd time: 17.0272 / Avg. batch time: 451.8303 (ms) / GPU bubble ratio: 56.46%
[rank2]:2025-12-12 07:01:58,819 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-12 07:01:58,841 - INFO - Avg. fwd time: 9.8285 / Avg. bwd time: 20.6533 / Avg. batch time: 488.1520 (ms) / GPU bubble ratio: 50.05%
[rank1]:2025-12-12 07:01:58,848 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-12 07:01:58,865 - INFO - Avg. fwd time: 7.8484 / Avg. bwd time: 15.6818 / Avg. batch time: 519.4449 (ms) / GPU bubble ratio: 63.76%
[rank0]:2025-12-12 07:01:58,873 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-12 07:01:58,875 - INFO -  step: 300  loss:  2.7401  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank2]:2025-12-12 07:01:58,887 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1177  memory:  6.51GiB(13.70%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank2]:2025-12-12 07:01:58,949 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0701_stage2_step300.svg
[rank1]:2025-12-12 07:01:58,891 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1177  memory:  9.36GiB(19.71%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank1]:2025-12-12 07:01:58,948 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0701_stage1_step300.svg
[rank0]:2025-12-12 07:01:58,901 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1177  memory: 13.29GiB(27.97%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank0]:2025-12-12 07:01:58,948 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0701_stage0_step300.svg
[rank3]:2025-12-12 07:01:59,037 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0701_real_step300_rank3.svg
[rank3]:			> Batch Time: 464.41 ms, GPU Bubble Ratio: 68.07%, 49.63%, 58.68%, 35.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  160-0-160ms    | [S0,MB5,F]  160-6-167ms    | [S0,MB2,B]  217-0-217ms    | [S0,MB6,F]  217-6-223ms    | [S0,MB3,B]  276-0-276ms    | [S0,MB7,F]  276-6-283ms    | [S0,MB4,B]  322-23-346ms   | [S0,MB5,B]  367-23-390ms   | [S0,MB6,B]  410-18-429ms   | [S0,MB7,B]  447-16-464ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  144-11-155ms   | [S1,MB4,F]  158-8-167ms    | [S1,MB2,B]  200-10-211ms   | [S1,MB5,F]  215-8-224ms    | [S1,MB3,B]  246-24-271ms   | [S1,MB6,F]  274-9-284ms    | [S1,MB4,B]  292-24-317ms   | [S1,MB7,F]  321-9-330ms    | [S1,MB5,B]  338-25-363ms   | [S1,MB6,B]  382-24-407ms   | [S1,MB7,B]  423-20-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  130-8-139ms    | [S2,MB3,F]  142-6-149ms    | [S2,MB2,B]  176-19-195ms   | [S2,MB4,F]  199-7-206ms    | [S2,MB3,B]  222-19-241ms   | [S2,MB5,F]  245-7-252ms    | [S2,MB4,B]  268-19-287ms   | [S2,MB6,F]  290-7-298ms    | [S2,MB5,B]  313-19-333ms   | [S2,MB7,F]  336-7-343ms    | [S2,MB6,B]  359-19-378ms   | [S2,MB7,B]  403-16-419ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-33-125ms    | [S3,MB2,F]  129-14-143ms   | [S3,MB2,B]  149-21-171ms   | [S3,MB3,F]  175-14-189ms   | [S3,MB3,B]  195-21-217ms   | [S3,MB4,F]  220-14-235ms   | [S3,MB4,B]  241-21-262ms   | [S3,MB5,F]  266-14-281ms   | [S3,MB5,B]  287-21-308ms   | [S3,MB6,F]  312-14-326ms   | [S3,MB6,B]  332-21-354ms   | [S3,MB7,F]  357-14-372ms   | [S3,MB7,B]  378-21-400ms  
[rank3]:2025-12-12 07:01:59,080 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0701_stage3_step300.svg
[rank3]:2025-12-12 07:03:35,323 - INFO - Avg. fwd time: 14.0553 / Avg. bwd time: 29.1307 / Avg. batch time: 418.3474 (ms) / GPU bubble ratio: 17.42%
[rank2]:2025-12-12 07:03:35,348 - INFO - Avg. fwd time: 7.5742 / Avg. bwd time: 16.9681 / Avg. batch time: 447.8319 (ms) / GPU bubble ratio: 56.16%
[rank0]:2025-12-12 07:03:35,401 - INFO - Avg. fwd time: 7.8681 / Avg. bwd time: 15.2661 / Avg. batch time: 515.2457 (ms) / GPU bubble ratio: 64.08%
[rank1]:2025-12-12 07:03:35,376 - INFO - Avg. fwd time: 9.8480 / Avg. bwd time: 20.5345 / Avg. batch time: 484.1020 (ms) / GPU bubble ratio: 49.79%
[rank0]:2025-12-12 07:05:07,196 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 07:05:10,924 - INFO - Avg. fwd time: 7.5827 / Avg. bwd time: 16.9174 / Avg. batch time: 444.0696 (ms) / GPU bubble ratio: 55.86%
[rank3]:2025-12-12 07:05:10,900 - INFO - Avg. fwd time: 14.0739 / Avg. bwd time: 28.6561 / Avg. batch time: 414.6713 (ms) / GPU bubble ratio: 17.56%
[rank1]:2025-12-12 07:05:10,953 - INFO - Avg. fwd time: 9.8654 / Avg. bwd time: 20.4350 / Avg. batch time: 480.3005 (ms) / GPU bubble ratio: 49.53%
[rank1]:2025-12-12 07:05:11,003 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1289  memory:  9.36GiB(19.71%)  tps: 8,528  tflops: 66.67  mfu: 21.37%
[rank2]:2025-12-12 07:05:10,999 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1289  memory:  6.51GiB(13.70%)  tps: 8,528  tflops: 66.67  mfu: 21.37%
[rank0]:2025-12-12 07:05:10,978 - INFO - Avg. fwd time: 7.8852 / Avg. bwd time: 14.9120 / Avg. batch time: 511.3157 (ms) / GPU bubble ratio: 64.33%
[rank0]:2025-12-12 07:05:11,013 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1289  memory: 13.29GiB(27.97%)  tps: 8,528  tflops: 66.67  mfu: 21.37%
[rank3]:2025-12-12 07:05:10,988 - INFO -  step: 350  loss:  2.7605  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,528  tflops: 66.67  mfu: 21.37%
[rank2]:2025-12-12 07:06:47,342 - INFO - Avg. fwd time: 7.5903 / Avg. bwd time: 16.8748 / Avg. batch time: 441.1084 (ms) / GPU bubble ratio: 55.63%
[rank3]:2025-12-12 07:06:47,317 - INFO - Avg. fwd time: 14.0959 / Avg. bwd time: 28.2757 / Avg. batch time: 411.7826 (ms) / GPU bubble ratio: 17.68%
[rank1]:2025-12-12 07:06:47,372 - INFO - Avg. fwd time: 9.8793 / Avg. bwd time: 20.3489 / Avg. batch time: 477.3121 (ms) / GPU bubble ratio: 49.34%
[rank0]:2025-12-12 07:06:47,397 - INFO - Avg. fwd time: 7.8996 / Avg. bwd time: 14.6179 / Avg. batch time: 508.2126 (ms) / GPU bubble ratio: 64.55%
[rank0]:2025-12-12 07:08:20,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-12 07:08:23,867 - INFO - Avg. fwd time: 7.5970 / Avg. bwd time: 16.8376 / Avg. batch time: 438.5592 (ms) / GPU bubble ratio: 55.43%
[rank3]:2025-12-12 07:08:23,841 - INFO - Avg. fwd time: 14.1170 / Avg. bwd time: 27.9464 / Avg. batch time: 409.2971 (ms) / GPU bubble ratio: 17.78%
[rank1]:2025-12-12 07:08:23,896 - INFO - Avg. fwd time: 9.8916 / Avg. bwd time: 20.2735 / Avg. batch time: 474.7403 (ms) / GPU bubble ratio: 49.17%
[rank1]:2025-12-12 07:08:23,947 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0526  memory:  9.36GiB(19.71%)  tps: 8,492  tflops: 66.38  mfu: 21.28%
[rank2]:2025-12-12 07:08:23,943 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0526  memory:  6.51GiB(13.70%)  tps: 8,492  tflops: 66.38  mfu: 21.28%
[rank0]:2025-12-12 07:08:23,921 - INFO - Avg. fwd time: 7.9126 / Avg. bwd time: 14.3484 / Avg. batch time: 505.5422 (ms) / GPU bubble ratio: 64.77%
[rank0]:2025-12-12 07:08:23,957 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0526  memory: 13.29GiB(27.97%)  tps: 8,492  tflops: 66.38  mfu: 21.28%
[rank3]:2025-12-12 07:08:23,932 - INFO -  step: 400  loss:  2.7752  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,492  tflops: 66.38  mfu: 21.28%
[rank1]:2025-12-12 07:08:24,009 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0708_stage1_step400.svg
[rank2]:2025-12-12 07:08:24,009 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0708_stage2_step400.svg
[rank0]:2025-12-12 07:08:24,009 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0708_stage0_step400.svg
[rank3]:2025-12-12 07:08:24,093 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0708_real_step400_rank3.svg
[rank3]:			> Batch Time: 464.52 ms, GPU Bubble Ratio: 68.27%, 49.70%, 58.61%, 35.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  160-0-160ms    | [S0,MB5,F]  160-6-167ms    | [S0,MB2,B]  217-0-217ms    | [S0,MB6,F]  217-6-223ms    | [S0,MB3,B]  276-0-276ms    | [S0,MB7,F]  276-6-283ms    | [S0,MB4,B]  322-23-346ms   | [S0,MB5,B]  366-23-390ms   | [S0,MB6,B]  410-18-428ms   | [S0,MB7,B]  447-16-464ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  144-10-155ms   | [S1,MB4,F]  158-8-167ms    | [S1,MB2,B]  200-10-211ms   | [S1,MB5,F]  215-8-224ms    | [S1,MB3,B]  246-24-271ms   | [S1,MB6,F]  274-9-283ms    | [S1,MB4,B]  292-24-317ms   | [S1,MB7,F]  320-9-330ms    | [S1,MB5,B]  337-24-362ms   | [S1,MB6,B]  381-25-407ms   | [S1,MB7,B]  422-21-443ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  130-8-139ms    | [S2,MB3,F]  142-6-149ms    | [S2,MB2,B]  176-19-195ms   | [S2,MB4,F]  199-6-206ms    | [S2,MB3,B]  222-19-241ms   | [S2,MB5,F]  245-7-252ms    | [S2,MB4,B]  267-19-287ms   | [S2,MB6,F]  291-7-298ms    | [S2,MB5,B]  313-19-332ms   | [S2,MB7,F]  336-7-343ms    | [S2,MB6,B]  359-19-378ms   | [S2,MB7,B]  403-16-419ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-33-125ms    | [S3,MB2,F]  129-14-143ms   | [S3,MB2,B]  149-21-171ms   | [S3,MB3,F]  174-14-189ms   | [S3,MB3,B]  195-21-217ms   | [S3,MB4,F]  220-14-235ms   | [S3,MB4,B]  241-21-262ms   | [S3,MB5,F]  266-14-280ms   | [S3,MB5,B]  286-21-308ms   | [S3,MB6,F]  311-14-326ms   | [S3,MB6,B]  332-21-354ms   | [S3,MB7,F]  357-14-372ms   | [S3,MB7,B]  377-21-399ms  
[rank3]:2025-12-12 07:08:24,140 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0708_stage3_step400.svg
[rank3]:2025-12-12 07:08:45,979 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-12 07:08:46,193 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-12 07:08:46,169 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-12 07:08:46,211 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-12 07:09:59,600 - INFO - Avg. fwd time: 14.1303 / Avg. bwd time: 27.6291 / Avg. batch time: 406.8470 (ms) / GPU bubble ratio: 17.89%
[rank1]:2025-12-12 07:09:59,655 - INFO - Avg. fwd time: 9.9026 / Avg. bwd time: 20.2061 / Avg. batch time: 472.2366 (ms) / GPU bubble ratio: 48.99%
[rank2]:2025-12-12 07:09:59,625 - INFO - Avg. fwd time: 7.6024 / Avg. bwd time: 16.8034 / Avg. batch time: 436.0802 (ms) / GPU bubble ratio: 55.23%
[rank0]:2025-12-12 07:09:59,681 - INFO - Avg. fwd time: 7.9236 / Avg. bwd time: 14.1223 / Avg. batch time: 502.9522 (ms) / GPU bubble ratio: 64.93%
[rank0]:2025-12-12 07:11:32,134 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-12 07:11:35,911 - INFO - Avg. fwd time: 7.6067 / Avg. bwd time: 16.7729 / Avg. batch time: 434.0286 (ms) / GPU bubble ratio: 55.06%
[rank3]:2025-12-12 07:11:35,885 - INFO - Avg. fwd time: 14.1457 / Avg. bwd time: 27.3659 / Avg. batch time: 404.8493 (ms) / GPU bubble ratio: 17.97%
[rank1]:2025-12-12 07:11:35,941 - INFO - Avg. fwd time: 9.9117 / Avg. bwd time: 20.1463 / Avg. batch time: 470.1650 (ms) / GPU bubble ratio: 48.86%
[rank1]:2025-12-12 07:11:35,992 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0894  memory:  9.36GiB(19.71%)  tps: 8,531  tflops: 66.69  mfu: 21.38%
[rank2]:2025-12-12 07:11:35,988 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0894  memory:  6.51GiB(13.70%)  tps: 8,531  tflops: 66.69  mfu: 21.38%
[rank0]:2025-12-12 07:11:35,967 - INFO - Avg. fwd time: 7.9329 / Avg. bwd time: 13.9086 / Avg. batch time: 500.8038 (ms) / GPU bubble ratio: 65.11%
[rank0]:2025-12-12 07:11:36,003 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0894  memory: 13.29GiB(27.97%)  tps: 8,531  tflops: 66.69  mfu: 21.38%
[rank3]:2025-12-12 07:11:35,977 - INFO -  step: 450  loss:  2.7411  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,531  tflops: 66.69  mfu: 21.38%
[rank3]:2025-12-12 07:13:11,532 - INFO - Avg. fwd time: 14.1555 / Avg. bwd time: 27.1122 / Avg. batch time: 402.8827 (ms) / GPU bubble ratio: 18.06%
[rank2]:2025-12-12 07:13:11,558 - INFO - Avg. fwd time: 7.6107 / Avg. bwd time: 16.7461 / Avg. batch time: 432.0140 (ms) / GPU bubble ratio: 54.90%
[rank1]:2025-12-12 07:13:11,588 - INFO - Avg. fwd time: 9.9204 / Avg. bwd time: 20.0940 / Avg. batch time: 468.1342 (ms) / GPU bubble ratio: 48.71%
[rank0]:2025-12-12 07:13:11,614 - INFO - Avg. fwd time: 7.9412 / Avg. bwd time: 13.7200 / Avg. batch time: 498.7029 (ms) / GPU bubble ratio: 65.25%
[rank0]:2025-12-12 07:14:43,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 07:14:47,075 - INFO - Avg. fwd time: 14.1638 / Avg. bwd time: 26.8811 / Avg. batch time: 401.0874 (ms) / GPU bubble ratio: 18.13%
[rank2]:2025-12-12 07:14:47,102 - INFO - Avg. fwd time: 7.6144 / Avg. bwd time: 16.7225 / Avg. batch time: 430.1770 (ms) / GPU bubble ratio: 54.74%
[rank1]:2025-12-12 07:14:47,132 - INFO - Avg. fwd time: 9.9282 / Avg. bwd time: 20.0471 / Avg. batch time: 466.2817 (ms) / GPU bubble ratio: 48.57%
[rank0]:2025-12-12 07:14:47,159 - INFO - Avg. fwd time: 7.9489 / Avg. bwd time: 13.5595 / Avg. batch time: 496.7883 (ms) / GPU bubble ratio: 65.36%
[rank0]:2025-12-12 07:14:47,195 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0858  memory: 13.29GiB(27.97%)  tps: 8,569  tflops: 66.99  mfu: 21.47%
[rank3]:2025-12-12 07:14:47,169 - INFO -  step: 500  loss:  2.7158  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,569  tflops: 66.99  mfu: 21.47%
[rank2]:2025-12-12 07:14:47,180 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0858  memory:  6.51GiB(13.70%)  tps: 8,569  tflops: 66.99  mfu: 21.47%
[rank2]:2025-12-12 07:14:47,243 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0714_stage2_step500.svg
[rank1]:2025-12-12 07:14:47,184 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0858  memory:  9.36GiB(19.71%)  tps: 8,569  tflops: 66.99  mfu: 21.47%
[rank1]:2025-12-12 07:14:47,241 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0714_stage1_step500.svg
[rank0]:2025-12-12 07:14:47,242 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0714_stage0_step500.svg
[rank3]:2025-12-12 07:14:47,330 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0714_real_step500_rank3.svg
[rank3]:			> Batch Time: 455.69 ms, GPU Bubble Ratio: 67.40%, 48.67%, 57.85%, 36.60%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  152-0-152ms    | [S0,MB5,F]  152-6-159ms    | [S0,MB2,B]  207-0-207ms    | [S0,MB6,F]  207-6-214ms    | [S0,MB3,B]  266-0-266ms    | [S0,MB7,F]  266-6-273ms    | [S0,MB4,B]  312-23-336ms   | [S0,MB5,B]  357-23-380ms   | [S0,MB6,B]  400-18-419ms   | [S0,MB7,B]  438-16-455ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  136-11-147ms   | [S1,MB4,F]  150-8-159ms    | [S1,MB2,B]  191-10-202ms   | [S1,MB5,F]  206-8-214ms    | [S1,MB3,B]  237-24-261ms   | [S1,MB6,F]  264-9-273ms    | [S1,MB4,B]  282-24-307ms   | [S1,MB7,F]  311-9-320ms    | [S1,MB5,B]  328-25-353ms   | [S1,MB6,B]  372-24-397ms   | [S1,MB7,B]  414-20-435ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  122-8-131ms    | [S2,MB3,F]  134-6-141ms    | [S2,MB2,B]  167-19-186ms   | [S2,MB4,F]  190-7-197ms    | [S2,MB3,B]  212-19-232ms   | [S2,MB5,F]  235-7-242ms    | [S2,MB4,B]  258-19-278ms   | [S2,MB6,F]  281-7-288ms    | [S2,MB5,B]  304-19-323ms   | [S2,MB7,F]  327-7-334ms    | [S2,MB6,B]  349-19-369ms   | [S2,MB7,B]  394-16-410ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-25-117ms    | [S3,MB2,F]  121-14-135ms   | [S3,MB2,B]  141-21-162ms   | [S3,MB3,F]  166-14-180ms   | [S3,MB3,B]  186-21-207ms   | [S3,MB4,F]  211-14-225ms   | [S3,MB4,B]  231-21-253ms   | [S3,MB5,F]  257-14-271ms   | [S3,MB5,B]  277-21-299ms   | [S3,MB6,F]  302-14-317ms   | [S3,MB6,B]  323-21-344ms   | [S3,MB7,F]  348-14-362ms   | [S3,MB7,B]  368-21-390ms  
[rank3]:2025-12-12 07:14:47,373 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0714_stage3_step500.svg
[rank3]:2025-12-12 07:16:22,602 - INFO - Avg. fwd time: 14.1707 / Avg. bwd time: 26.6674 / Avg. batch time: 399.4197 (ms) / GPU bubble ratio: 18.21%
[rank1]:2025-12-12 07:16:22,659 - INFO - Avg. fwd time: 9.9355 / Avg. bwd time: 20.0047 / Avg. batch time: 464.5862 (ms) / GPU bubble ratio: 48.44%
[rank2]:2025-12-12 07:16:22,628 - INFO - Avg. fwd time: 7.6181 / Avg. bwd time: 16.7016 / Avg. batch time: 428.4949 (ms) / GPU bubble ratio: 54.60%
[rank0]:2025-12-12 07:16:22,686 - INFO - Avg. fwd time: 7.9561 / Avg. bwd time: 13.4235 / Avg. batch time: 495.0382 (ms) / GPU bubble ratio: 65.45%
[rank0]:2025-12-12 07:17:55,012 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 07:17:58,813 - INFO - Avg. fwd time: 14.1801 / Avg. bwd time: 26.4924 / Avg. batch time: 398.0832 (ms) / GPU bubble ratio: 18.26%
[rank1]:2025-12-12 07:17:58,871 - INFO - Avg. fwd time: 9.9410 / Avg. bwd time: 19.9664 / Avg. batch time: 463.2054 (ms) / GPU bubble ratio: 48.35%
[rank2]:2025-12-12 07:17:58,840 - INFO - Avg. fwd time: 7.6215 / Avg. bwd time: 16.6830 / Avg. batch time: 427.1243 (ms) / GPU bubble ratio: 54.48%
[rank0]:2025-12-12 07:17:58,898 - INFO - Avg. fwd time: 7.9623 / Avg. bwd time: 13.2908 / Avg. batch time: 493.6057 (ms) / GPU bubble ratio: 65.55%
[rank0]:2025-12-12 07:17:58,934 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0642  memory: 13.29GiB(27.97%)  tps: 8,545  tflops: 66.80  mfu: 21.41%
[rank3]:2025-12-12 07:17:58,908 - INFO -  step: 550  loss:  2.6997  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,545  tflops: 66.80  mfu: 21.41%
[rank1]:2025-12-12 07:17:58,923 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0642  memory:  9.36GiB(19.71%)  tps: 8,545  tflops: 66.80  mfu: 21.41%
[rank2]:2025-12-12 07:17:58,919 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0642  memory:  6.51GiB(13.70%)  tps: 8,545  tflops: 66.80  mfu: 21.41%
[rank3]:2025-12-12 07:19:35,272 - INFO - Avg. fwd time: 14.1905 / Avg. bwd time: 26.3385 / Avg. batch time: 396.9271 (ms) / GPU bubble ratio: 18.31%
[rank1]:2025-12-12 07:19:35,331 - INFO - Avg. fwd time: 9.9462 / Avg. bwd time: 19.9309 / Avg. batch time: 462.0070 (ms) / GPU bubble ratio: 48.27%
[rank2]:2025-12-12 07:19:35,299 - INFO - Avg. fwd time: 7.6244 / Avg. bwd time: 16.6660 / Avg. batch time: 425.9373 (ms) / GPU bubble ratio: 54.38%
[rank0]:2025-12-12 07:19:35,358 - INFO - Avg. fwd time: 7.9680 / Avg. bwd time: 13.1615 / Avg. batch time: 492.3593 (ms) / GPU bubble ratio: 65.67%
[rank0]:2025-12-12 07:21:07,933 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 07:21:11,761 - INFO - Avg. fwd time: 14.2009 / Avg. bwd time: 26.1979 / Avg. batch time: 395.8752 (ms) / GPU bubble ratio: 18.36%
[rank1]:2025-12-12 07:21:11,820 - INFO - Avg. fwd time: 9.9507 / Avg. bwd time: 19.8992 / Avg. batch time: 460.9200 (ms) / GPU bubble ratio: 48.19%
[rank2]:2025-12-12 07:21:11,788 - INFO - Avg. fwd time: 7.6270 / Avg. bwd time: 16.6502 / Avg. batch time: 424.8557 (ms) / GPU bubble ratio: 54.29%
[rank2]:2025-12-12 07:21:11,869 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0879  memory:  6.51GiB(13.70%)  tps: 8,491  tflops: 66.38  mfu: 21.28%
[rank0]:2025-12-12 07:21:11,848 - INFO - Avg. fwd time: 7.9732 / Avg. bwd time: 13.0509 / Avg. batch time: 491.2279 (ms) / GPU bubble ratio: 65.76%
[rank0]:2025-12-12 07:21:11,884 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0879  memory: 13.29GiB(27.97%)  tps: 8,491  tflops: 66.38  mfu: 21.28%
[rank3]:2025-12-12 07:21:11,859 - INFO -  step: 600  loss:  2.7124  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,491  tflops: 66.38  mfu: 21.28%
[rank1]:2025-12-12 07:21:11,873 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0879  memory:  9.36GiB(19.71%)  tps: 8,491  tflops: 66.38  mfu: 21.28%
[rank1]:2025-12-12 07:21:11,932 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0721_stage1_step600.svg
[rank2]:2025-12-12 07:21:11,934 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0721_stage2_step600.svg
[rank0]:2025-12-12 07:21:11,931 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0721_stage0_step600.svg
[rank3]:2025-12-12 07:21:12,020 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0721_real_step600_rank3.svg
[rank3]:			> Batch Time: 465.08 ms, GPU Bubble Ratio: 67.35%, 49.74%, 58.72%, 35.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  160-0-160ms    | [S0,MB5,F]  160-6-166ms    | [S0,MB2,B]  217-0-217ms    | [S0,MB6,F]  217-6-224ms    | [S0,MB3,B]  276-0-276ms    | [S0,MB7,F]  276-6-283ms    | [S0,MB4,B]  323-23-347ms   | [S0,MB5,B]  367-23-391ms   | [S0,MB6,B]  411-22-433ms   | [S0,MB7,B]  448-16-465ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-113ms   | [S1,MB1,B]  143-11-154ms   | [S1,MB4,F]  158-8-167ms    | [S1,MB2,B]  201-10-211ms   | [S1,MB5,F]  215-8-224ms    | [S1,MB3,B]  247-24-271ms   | [S1,MB6,F]  274-9-283ms    | [S1,MB4,B]  293-24-318ms   | [S1,MB7,F]  321-9-330ms    | [S1,MB5,B]  339-24-364ms   | [S1,MB6,B]  382-25-407ms   | [S1,MB7,B]  423-21-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  130-8-138ms    | [S2,MB3,F]  142-6-149ms    | [S2,MB2,B]  176-19-196ms   | [S2,MB4,F]  199-6-206ms    | [S2,MB3,B]  222-19-242ms   | [S2,MB5,F]  245-7-252ms    | [S2,MB4,B]  268-19-288ms   | [S2,MB6,F]  291-7-298ms    | [S2,MB5,B]  314-19-334ms   | [S2,MB7,F]  337-7-344ms    | [S2,MB6,B]  359-19-379ms   | [S2,MB7,B]  403-16-419ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  91-32-124ms    | [S3,MB2,F]  128-15-144ms   | [S3,MB2,B]  150-21-171ms   | [S3,MB3,F]  175-14-189ms   | [S3,MB3,B]  195-21-217ms   | [S3,MB4,F]  221-14-235ms   | [S3,MB4,B]  241-21-263ms   | [S3,MB5,F]  267-14-281ms   | [S3,MB5,B]  287-21-309ms   | [S3,MB6,F]  313-14-327ms   | [S3,MB6,B]  333-21-354ms   | [S3,MB7,F]  358-14-373ms   | [S3,MB7,B]  379-21-400ms  
[rank3]:2025-12-12 07:21:12,065 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0721_stage3_step600.svg
[rank3]:2025-12-12 07:22:48,389 - INFO - Avg. fwd time: 14.2103 / Avg. bwd time: 26.0675 / Avg. batch time: 394.9013 (ms) / GPU bubble ratio: 18.40%
[rank1]:2025-12-12 07:22:48,448 - INFO - Avg. fwd time: 9.9549 / Avg. bwd time: 19.8698 / Avg. batch time: 459.9349 (ms) / GPU bubble ratio: 48.12%
[rank2]:2025-12-12 07:22:48,416 - INFO - Avg. fwd time: 7.6297 / Avg. bwd time: 16.6357 / Avg. batch time: 423.8763 (ms) / GPU bubble ratio: 54.20%
[rank0]:2025-12-12 07:22:48,476 - INFO - Avg. fwd time: 7.9780 / Avg. bwd time: 12.9415 / Avg. batch time: 490.2017 (ms) / GPU bubble ratio: 65.86%
[rank0]:2025-12-12 07:24:20,573 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 07:24:24,341 - INFO - Avg. fwd time: 14.2169 / Avg. bwd time: 25.9354 / Avg. batch time: 393.8884 (ms) / GPU bubble ratio: 18.45%
[rank1]:2025-12-12 07:24:24,402 - INFO - Avg. fwd time: 9.9591 / Avg. bwd time: 19.8434 / Avg. batch time: 458.8926 (ms) / GPU bubble ratio: 48.04%
[rank0]:2025-12-12 07:24:24,430 - INFO - Avg. fwd time: 7.9825 / Avg. bwd time: 12.8476 / Avg. batch time: 489.1225 (ms) / GPU bubble ratio: 65.93%
[rank2]:2025-12-12 07:24:24,369 - INFO - Avg. fwd time: 7.6320 / Avg. bwd time: 16.6224 / Avg. batch time: 422.8384 (ms) / GPU bubble ratio: 54.11%
[rank3]:2025-12-12 07:24:24,441 - INFO -  step: 650  loss:  2.7252  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,508  tflops: 66.51  mfu: 21.32%
[rank1]:2025-12-12 07:24:24,455 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0705  memory:  9.36GiB(19.71%)  tps: 8,508  tflops: 66.51  mfu: 21.32%
[rank0]:2025-12-12 07:24:24,466 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0705  memory: 13.29GiB(27.97%)  tps: 8,508  tflops: 66.51  mfu: 21.32%
[rank2]:2025-12-12 07:24:24,452 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0705  memory:  6.51GiB(13.70%)  tps: 8,508  tflops: 66.51  mfu: 21.32%
[rank3]:2025-12-12 07:26:00,503 - INFO - Avg. fwd time: 14.2237 / Avg. bwd time: 25.8178 / Avg. batch time: 392.9955 (ms) / GPU bubble ratio: 18.49%
[rank2]:2025-12-12 07:26:00,531 - INFO - Avg. fwd time: 7.6339 / Avg. bwd time: 16.6102 / Avg. batch time: 421.9225 (ms) / GPU bubble ratio: 54.03%
[rank0]:2025-12-12 07:26:00,599 - INFO - Avg. fwd time: 7.9865 / Avg. bwd time: 12.7533 / Avg. batch time: 488.1685 (ms) / GPU bubble ratio: 66.01%
[rank1]:2025-12-12 07:26:00,564 - INFO - Avg. fwd time: 9.9624 / Avg. bwd time: 19.8189 / Avg. batch time: 457.9726 (ms) / GPU bubble ratio: 47.98%
[rank0]:2025-12-12 07:27:33,065 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 07:27:36,842 - INFO - Avg. fwd time: 14.2305 / Avg. bwd time: 25.7130 / Avg. batch time: 392.2054 (ms) / GPU bubble ratio: 18.53%
[rank2]:2025-12-12 07:27:36,871 - INFO - Avg. fwd time: 7.6357 / Avg. bwd time: 16.5989 / Avg. batch time: 421.1108 (ms) / GPU bubble ratio: 53.96%
[rank3]:2025-12-12 07:27:36,943 - INFO -  step: 700  loss:  2.7618  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,511  tflops: 66.54  mfu: 21.33%
[rank2]:2025-12-12 07:27:36,954 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0700  memory:  6.51GiB(13.70%)  tps: 8,511  tflops: 66.54  mfu: 21.33%
[rank0]:2025-12-12 07:27:36,933 - INFO - Avg. fwd time: 7.9901 / Avg. bwd time: 12.6718 / Avg. batch time: 487.3181 (ms) / GPU bubble ratio: 66.08%
[rank0]:2025-12-12 07:27:36,968 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0700  memory: 13.29GiB(27.97%)  tps: 8,511  tflops: 66.54  mfu: 21.33%
[rank1]:2025-12-12 07:27:36,904 - INFO - Avg. fwd time: 9.9657 / Avg. bwd time: 19.7960 / Avg. batch time: 457.1544 (ms) / GPU bubble ratio: 47.92%
[rank1]:2025-12-12 07:27:36,958 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0700  memory:  9.36GiB(19.71%)  tps: 8,511  tflops: 66.54  mfu: 21.33%
[rank2]:2025-12-12 07:27:37,020 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0727_stage2_step700.svg
[rank0]:2025-12-12 07:27:37,019 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0727_stage0_step700.svg
[rank1]:2025-12-12 07:27:37,020 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0727_stage1_step700.svg
[rank3]:2025-12-12 07:27:37,107 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0727_real_step700_rank3.svg
[rank3]:			> Batch Time: 465.81 ms, GPU Bubble Ratio: 67.52%, 49.85%, 58.74%, 35.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  161-0-161ms    | [S0,MB5,F]  161-6-168ms    | [S0,MB2,B]  218-0-218ms    | [S0,MB6,F]  218-6-224ms    | [S0,MB3,B]  277-0-277ms    | [S0,MB7,F]  277-6-284ms    | [S0,MB4,B]  323-23-347ms   | [S0,MB5,B]  368-23-391ms   | [S0,MB6,B]  412-21-434ms   | [S0,MB7,B]  449-16-465ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-19ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  145-11-156ms   | [S1,MB4,F]  159-8-168ms    | [S1,MB2,B]  201-10-212ms   | [S1,MB5,F]  216-8-225ms    | [S1,MB3,B]  247-24-272ms   | [S1,MB6,F]  275-8-284ms    | [S1,MB4,B]  293-24-318ms   | [S1,MB7,F]  322-9-331ms    | [S1,MB5,B]  339-25-364ms   | [S1,MB6,B]  383-25-408ms   | [S1,MB7,B]  424-21-445ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  131-8-140ms    | [S2,MB3,F]  143-6-150ms    | [S2,MB2,B]  177-19-196ms   | [S2,MB4,F]  200-6-207ms    | [S2,MB3,B]  223-19-242ms   | [S2,MB5,F]  246-7-253ms    | [S2,MB4,B]  269-19-289ms   | [S2,MB6,F]  292-7-299ms    | [S2,MB5,B]  314-19-334ms   | [S2,MB7,F]  337-7-345ms    | [S2,MB6,B]  360-19-380ms   | [S2,MB7,B]  405-16-421ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-34-126ms    | [S3,MB2,F]  130-15-145ms   | [S3,MB2,B]  150-21-172ms   | [S3,MB3,F]  176-14-190ms   | [S3,MB3,B]  196-21-218ms   | [S3,MB4,F]  222-14-236ms   | [S3,MB4,B]  242-21-264ms   | [S3,MB5,F]  268-14-282ms   | [S3,MB5,B]  288-21-310ms   | [S3,MB6,F]  313-14-328ms   | [S3,MB6,B]  334-21-355ms   | [S3,MB7,F]  359-14-374ms   | [S3,MB7,B]  380-21-401ms  
[rank3]:2025-12-12 07:27:37,153 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0727_stage3_step700.svg
[rank3]:2025-12-12 07:29:12,876 - INFO - Avg. fwd time: 14.2359 / Avg. bwd time: 25.6066 / Avg. batch time: 391.3920 (ms) / GPU bubble ratio: 18.56%
[rank2]:2025-12-12 07:29:12,905 - INFO - Avg. fwd time: 7.6375 / Avg. bwd time: 16.5886 / Avg. batch time: 420.2954 (ms) / GPU bubble ratio: 53.89%
[rank0]:2025-12-12 07:29:12,967 - INFO - Avg. fwd time: 7.9935 / Avg. bwd time: 12.6006 / Avg. batch time: 486.4671 (ms) / GPU bubble ratio: 66.13%
[rank1]:2025-12-12 07:29:12,938 - INFO - Avg. fwd time: 9.9690 / Avg. bwd time: 19.7748 / Avg. batch time: 456.3337 (ms) / GPU bubble ratio: 47.86%
[rank0]:2025-12-12 07:30:45,795 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-12 07:30:49,613 - INFO - Avg. fwd time: 14.2437 / Avg. bwd time: 25.5209 / Avg. batch time: 390.7632 (ms) / GPU bubble ratio: 18.59%
[rank2]:2025-12-12 07:30:49,642 - INFO - Avg. fwd time: 7.6392 / Avg. bwd time: 16.5791 / Avg. batch time: 419.6484 (ms) / GPU bubble ratio: 53.83%
[rank3]:2025-12-12 07:30:49,715 - INFO -  step: 750  loss:  2.7103  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,499  tflops: 66.44  mfu: 21.30%
[rank1]:2025-12-12 07:30:49,676 - INFO - Avg. fwd time: 9.9725 / Avg. bwd time: 19.7553 / Avg. batch time: 455.6810 (ms) / GPU bubble ratio: 47.81%
[rank1]:2025-12-12 07:30:49,730 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0773  memory:  9.36GiB(19.71%)  tps: 8,499  tflops: 66.44  mfu: 21.30%
[rank0]:2025-12-12 07:30:49,705 - INFO - Avg. fwd time: 7.9969 / Avg. bwd time: 12.5330 / Avg. batch time: 485.7882 (ms) / GPU bubble ratio: 66.19%
[rank0]:2025-12-12 07:30:49,741 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0773  memory: 13.29GiB(27.97%)  tps: 8,499  tflops: 66.44  mfu: 21.30%
[rank2]:2025-12-12 07:30:49,727 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0773  memory:  6.51GiB(13.70%)  tps: 8,499  tflops: 66.44  mfu: 21.30%
[rank2]:2025-12-12 07:32:25,412 - INFO - Avg. fwd time: 7.6408 / Avg. bwd time: 16.5702 / Avg. batch time: 418.8958 (ms) / GPU bubble ratio: 53.76%
[rank3]:2025-12-12 07:32:25,382 - INFO - Avg. fwd time: 14.2475 / Avg. bwd time: 25.4259 / Avg. batch time: 390.0274 (ms) / GPU bubble ratio: 18.62%
[rank1]:2025-12-12 07:32:25,446 - INFO - Avg. fwd time: 9.9758 / Avg. bwd time: 19.7370 / Avg. batch time: 454.9231 (ms) / GPU bubble ratio: 47.75%
[rank0]:2025-12-12 07:32:25,476 - INFO - Avg. fwd time: 7.9999 / Avg. bwd time: 12.4609 / Avg. batch time: 485.0050 (ms) / GPU bubble ratio: 66.25%
[rank0]:2025-12-12 07:33:58,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-12 07:34:01,888 - INFO - Avg. fwd time: 14.2541 / Avg. bwd time: 25.3481 / Avg. batch time: 389.4537 (ms) / GPU bubble ratio: 18.65%
[rank2]:2025-12-12 07:34:01,918 - INFO - Avg. fwd time: 7.6425 / Avg. bwd time: 16.5619 / Avg. batch time: 418.3063 (ms) / GPU bubble ratio: 53.71%
[rank1]:2025-12-12 07:34:01,952 - INFO - Avg. fwd time: 9.9790 / Avg. bwd time: 19.7199 / Avg. batch time: 454.3282 (ms) / GPU bubble ratio: 47.71%
[rank0]:2025-12-12 07:34:01,982 - INFO - Avg. fwd time: 8.0030 / Avg. bwd time: 12.4011 / Avg. batch time: 484.3868 (ms) / GPU bubble ratio: 66.30%
[rank2]:2025-12-12 07:34:02,004 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0668  memory:  6.51GiB(13.70%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank2]:2025-12-12 07:34:02,004 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0668  tps: 8,662  tflops: 67.71  mfu: 19.85%
[rank2]:2025-12-12 07:34:02,004 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-12 07:34:02,004 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-12 07:34:01,992 - INFO -  step: 800  loss:  2.6894  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank3]:2025-12-12 07:34:01,992 - INFO -  final step: 800  loss:  2.6894  grad_norm:  0.0000  tps: 8,668  tflops: 67.77  mfu: 19.99%
[rank3]:2025-12-12 07:34:01,993 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-12 07:34:01,994 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-12 07:34:02,007 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0668  memory:  9.36GiB(19.71%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank1]:2025-12-12 07:34:02,007 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0668  tps: 8,662  tflops: 67.71  mfu: 19.84%
[rank1]:2025-12-12 07:34:02,007 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-12 07:34:02,008 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 07:34:02,018 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0668  memory: 13.29GiB(27.97%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank0]:2025-12-12 07:34:02,018 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0668  tps: 8,661  tflops: 67.71  mfu: 19.84%
[rank0]:2025-12-12 07:34:02,018 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-12 07:34:02,019 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-12 07:34:03,933 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-12 07:34:04,007 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251212_0734_stage0_final800.svg
[rank2]:2025-12-12 07:34:04,011 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251212_0734_stage2_final800.svg
[rank3]:2025-12-12 07:34:04,091 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0734_real_final800_rank3.svg
[rank3]:			> Batch Time: 465.44 ms, GPU Bubble Ratio: 68.13%, 49.83%, 58.78%, 35.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  160-0-160ms    | [S0,MB5,F]  160-6-167ms    | [S0,MB2,B]  217-0-217ms    | [S0,MB6,F]  217-6-224ms    | [S0,MB3,B]  277-0-277ms    | [S0,MB7,F]  277-6-283ms    | [S0,MB4,B]  323-23-347ms   | [S0,MB5,B]  367-23-391ms   | [S0,MB6,B]  411-18-430ms   | [S0,MB7,B]  448-16-465ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-99ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  144-11-155ms   | [S1,MB4,F]  158-8-167ms    | [S1,MB2,B]  201-10-212ms   | [S1,MB5,F]  215-8-224ms    | [S1,MB3,B]  247-24-271ms   | [S1,MB6,F]  275-9-284ms    | [S1,MB4,B]  293-24-318ms   | [S1,MB7,F]  321-9-331ms    | [S1,MB5,B]  339-24-363ms   | [S1,MB6,B]  383-24-407ms   | [S1,MB7,B]  423-21-445ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  130-8-138ms    | [S2,MB3,F]  142-6-149ms    | [S2,MB2,B]  176-19-196ms   | [S2,MB4,F]  199-6-206ms    | [S2,MB3,B]  222-19-242ms   | [S2,MB5,F]  245-7-252ms    | [S2,MB4,B]  268-19-288ms   | [S2,MB6,F]  291-7-298ms    | [S2,MB5,B]  314-19-333ms   | [S2,MB7,F]  337-7-344ms    | [S2,MB6,B]  360-19-379ms   | [S2,MB7,B]  404-16-420ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-33-125ms    | [S3,MB2,F]  128-14-143ms   | [S3,MB2,B]  150-21-171ms   | [S3,MB3,F]  175-14-189ms   | [S3,MB3,B]  195-21-217ms   | [S3,MB4,F]  221-14-235ms   | [S3,MB4,B]  242-21-263ms   | [S3,MB5,F]  267-14-281ms   | [S3,MB5,B]  287-21-309ms   | [S3,MB6,F]  312-14-327ms   | [S3,MB6,B]  333-21-355ms   | [S3,MB7,F]  358-14-373ms   | [S3,MB7,B]  379-21-400ms  
[rank1]:2025-12-12 07:34:04,007 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251212_0734_stage1_final800.svg
[rank1]:2025-12-12 07:34:04,155 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251212_0734_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank0]:2025-12-12 07:34:04,162 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251212_0734_rank0_stage0.svg
[rank0]:	> Counts Sum: 321200, Total Sum: 1728640 (18.58%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.03, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.12, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank2]:2025-12-12 07:34:04,166 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251212_0734_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank3]:2025-12-12 07:34:04,222 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251212_0734_thry_final800_rank3.svg
[rank3]:			> Batch Time: 330.98 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB0,B]  100-20-120ms   | [S0,MB4,F]  120-10-130ms   | [S0,MB1,B]  130-20-150ms   | [S0,MB5,F]  150-10-160ms   | [S0,MB2,B]  160-20-180ms   | [S0,MB6,F]  180-10-190ms   | [S0,MB3,B]  190-20-210ms   | [S0,MB7,F]  210-10-220ms   | [S0,MB4,B]  220-20-240ms   | [S0,MB5,B]  250-20-270ms   | [S0,MB6,B]  280-20-300ms   | [S0,MB7,B]  310-20-330ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB0,B]  80-20-100ms    | [S1,MB3,F]  100-10-110ms   | [S1,MB1,B]  110-20-130ms   | [S1,MB4,F]  130-10-140ms   | [S1,MB2,B]  140-20-160ms   | [S1,MB5,F]  160-10-170ms   | [S1,MB3,B]  170-20-190ms   | [S1,MB6,F]  190-10-200ms   | [S1,MB4,B]  200-20-220ms   | [S1,MB7,F]  220-10-230ms   | [S1,MB5,B]  230-20-250ms   | [S1,MB6,B]  260-20-280ms   | [S1,MB7,B]  290-20-310ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB0,B]  60-20-80ms     | [S2,MB2,F]  80-10-90ms     | [S2,MB1,B]  90-20-110ms    | [S2,MB3,F]  110-10-120ms   | [S2,MB2,B]  120-20-140ms   | [S2,MB4,F]  140-10-150ms   | [S2,MB3,B]  150-20-170ms   | [S2,MB5,F]  170-10-180ms   | [S2,MB4,B]  180-20-200ms   | [S2,MB6,F]  200-10-210ms   | [S2,MB5,B]  210-20-230ms   | [S2,MB7,F]  230-10-240ms   | [S2,MB6,B]  240-20-260ms   | [S2,MB7,B]  270-20-290ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB0,B]  40-20-60ms     | [S3,MB1,F]  60-10-70ms     | [S3,MB1,B]  70-20-90ms     | [S3,MB2,F]  90-10-100ms    | [S3,MB2,B]  100-20-120ms   | [S3,MB3,F]  120-10-130ms   | [S3,MB3,B]  130-20-150ms   | [S3,MB4,F]  150-10-160ms   | [S3,MB4,B]  160-20-180ms   | [S3,MB5,F]  180-10-190ms   | [S3,MB5,B]  190-20-210ms   | [S3,MB6,F]  210-10-220ms   | [S3,MB6,B]  220-20-240ms   | [S3,MB7,F]  240-10-250ms   | [S3,MB7,B]  250-20-270ms  
[rank3]:2025-12-12 07:34:04,269 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251212_0734_stage3_final800.svg
[rank3]:2025-12-12 07:34:04,404 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251212_0734_rank3_stage3.svg
[rank3]:	> Counts Sum: 1147840, Total Sum: 1354880 (84.72%), Ratio(%) per element: [85.78, 84.07, 83.56, 84.76, 85.61, 86.13, 83.39, 84.07, 85.61, 83.9, 85.1, 84.24, 85.78, 82.7, 84.93, 85.27, 86.13, 85.27, 84.24, 84.58, 86.98, 85.1, 83.9, 84.58, 84.41, 84.58, 84.07, 83.21, 84.76]
[rank1]:2025-12-12 07:34:05,994 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251212_0734_stage1.svg
[rank1]:2025-12-12 07:34:05,998 - INFO - Destroying the purge thread.
[rank2]:2025-12-12 07:34:05,993 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251212_0734_stage2.svg
[rank2]:2025-12-12 07:34:05,996 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 07:34:06,033 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251212_0734_stage0.svg
[rank0]:2025-12-12 07:34:06,036 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-12 07:34:06,248 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251212_0734_stage3.svg
[rank3]:2025-12-12 07:34:06,252 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-12-12 07:34:06,353 - INFO - Process group destroyed
[rank2]:2025-12-12 07:34:06,375 - INFO - Process group destroyed
[rank3]:wandb: uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–†â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–†â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.78018
[rank3]:wandb:               final/avg_loss 2.6894
[rank3]:wandb:             final/avg_mfu(%) 19.98992
[rank3]:wandb:             final/avg_tflops 67.76533
[rank3]:wandb:    final/avg_throughput(tps) 8668.3704
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 2.6894
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.6894
[rank3]:wandb: loss_metrics/global_max_loss 2.6894
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1212_1F1B_fullrand7_mfr0.9_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/idu76s32
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.9_42_dm1/20251212-0640/wandb/run-20251212_064027-idu76s32/logs
[rank3]:2025-12-12 07:34:07,849 - INFO - Process group destroyed
[rank0]:2025-12-12 07:34:08,036 - INFO - Training completed
[rank0]:2025-12-12 07:34:08,037 - INFO - Destroying the purge thread.
[rank0]:2025-12-12 07:34:08,348 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.8', 'layers.7', 'layers.4', 'layers.5'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.2', 'layers.0', 'layers.1', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.11', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.13', 'output', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1212.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), lp solver -> qp solver
[rank3]:1212: everything same as 1128, but qp solver -> lp solver
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1212_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
