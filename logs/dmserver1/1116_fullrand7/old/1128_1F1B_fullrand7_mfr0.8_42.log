
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 28. (ê¸ˆ) 22:53:27 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.8_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.8) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-28 22:53:33,764 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-11-28 22:53:33,806 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:2025-11-28 22:53:33,769 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank1]:2025-11-28 22:53:33,770 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-28 22:53:34,053 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 22:53:34,055 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 22:53:34,059 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 22:53:34,060 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-11-28 22:53:34,061 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 22:53:34,063 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-28 22:53:34,068 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 22:53:34,126 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 22:53:34,129 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-28 22:53:34,070 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 22:53:34,455 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-28 22:53:37,330 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-28 22:53:37,482 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 22:53:37,531 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 22:53:37,532 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-28 22:53:37,560 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-28 22:53:37,560 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 22:53:37,481 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-28 22:53:37,531 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 22:53:37,567 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-28 22:53:37,568 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 22:53:37,757 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 22:53:37,757 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-28 22:53:37,758 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-28 22:53:37,764 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 22:53:37,765 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-28 22:53:37,765 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-28 22:53:38,198 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-28 22:53:38,238 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 22:53:38,269 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-28 22:53:38,269 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-28 22:53:38,467 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 22:53:38,468 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-28 22:53:38,468 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run goqi6nte
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.8_42_dm1/20251128-2253/wandb/run-20251128_225338-goqi6nte
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/goqi6nte
[rank3]:2025-11-28 22:53:39,614 - INFO - WandB logging enabled
[rank3]:2025-11-28 22:53:39,614 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-28 22:53:39,652 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 22:53:39,679 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-28 22:53:39,679 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-28 22:53:39,862 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 22:53:39,862 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-28 22:53:39,863 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-11-28 22:53:39,883 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank0]:2025-11-28 22:53:39,884 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 22:53:39,884 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-28 22:53:39,885 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-28 22:53:39,881 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-28 22:53:39,879 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-28 22:53:39,880 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 22:53:42,424 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-28 22:53:42,424 - INFO - Finished loading the checkpoint in 2.54 seconds.
[rank0]:2025-11-28 22:53:42,424 - INFO - Training starts at step 1
[rank3]:2025-11-28 22:53:48,085 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5371  memory: 12.97GiB(27.31%)  tps: 3,887  tflops: 30.38  mfu: 9.74%
[rank3]:2025-11-28 22:53:48,085 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 22:53:48,074 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory:  4.63GiB(9.75%)  tps: 3,108  tflops: 24.30  mfu: 7.79%
[rank2]:2025-11-28 22:53:48,075 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-28 22:53:48,077 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory:  6.76GiB(14.24%)  tps: 3,330  tflops: 26.04  mfu: 8.34%
[rank1]:2025-11-28 22:53:48,078 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 22:53:48,098 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory:  9.19GiB(19.34%)  tps: 3,101  tflops: 24.24  mfu: 7.77%
[rank0]:2025-11-28 22:53:48,098 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 22:55:50,249 - INFO - Avg. fwd time: 13.2599 / Avg. bwd time: 41.6565 / Avg. batch time: 511.9032 (ms) / GPU bubble ratio: 14.18%
[rank2]:2025-11-28 22:55:50,289 - INFO - Avg. fwd time: 7.2731 / Avg. bwd time: 18.9764 / Avg. batch time: 544.0063 (ms) / GPU bubble ratio: 61.40%
[rank0]:2025-11-28 22:55:50,320 - INFO - Avg. fwd time: 7.3707 / Avg. bwd time: 23.5751 / Avg. batch time: 620.5163 (ms) / GPU bubble ratio: 60.10%
[rank1]:2025-11-28 22:55:50,324 - INFO - Avg. fwd time: 9.4190 / Avg. bwd time: 23.9717 / Avg. batch time: 583.1898 (ms) / GPU bubble ratio: 54.20%
[rank0]:2025-11-28 22:57:53,668 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 22:57:58,499 - INFO - Avg. fwd time: 7.2849 / Avg. bwd time: 19.0284 / Avg. batch time: 547.0735 (ms) / GPU bubble ratio: 61.52%
[rank3]:2025-11-28 22:57:58,460 - INFO - Avg. fwd time: 13.4291 / Avg. bwd time: 41.9398 / Avg. batch time: 515.3746 (ms) / GPU bubble ratio: 14.05%
[rank0]:2025-11-28 22:57:58,530 - INFO - Avg. fwd time: 7.3758 / Avg. bwd time: 23.6210 / Avg. batch time: 622.7796 (ms) / GPU bubble ratio: 60.18%
[rank1]:2025-11-28 22:57:58,534 - INFO - Avg. fwd time: 9.4446 / Avg. bwd time: 24.0485 / Avg. batch time: 585.8851 (ms) / GPU bubble ratio: 54.27%
[rank2]:2025-11-28 22:57:58,761 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.5962  memory:  6.43GiB(13.53%)  tps: 6,405  tflops: 50.07  mfu: 16.05%
[rank3]:2025-11-28 22:57:58,773 - INFO -  step: 50  loss:  9.9101  grad_norm: 12.5962  memory: 16.39GiB(34.50%)  tps: 6,405  tflops: 50.07  mfu: 16.05%
[rank0]:2025-11-28 22:57:58,775 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.5962  memory: 12.97GiB(27.31%)  tps: 6,405  tflops: 50.07  mfu: 16.05%
[rank1]:2025-11-28 22:57:58,765 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.5962  memory:  9.03GiB(19.01%)  tps: 6,405  tflops: 50.07  mfu: 16.05%
[rank3]:2025-11-28 22:58:49,984 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-28 22:59:41,210 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-28 22:59:41,545 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-28 22:59:58,668 - INFO - Avg. fwd time: 13.5286 / Avg. bwd time: 40.6563 / Avg. batch time: 505.8475 (ms) / GPU bubble ratio: 14.31%
[rank2]:2025-11-28 22:59:58,683 - INFO - Avg. fwd time: 7.3816 / Avg. bwd time: 18.3548 / Avg. batch time: 536.7253 (ms) / GPU bubble ratio: 61.64%
[rank0]:2025-11-28 22:59:58,705 - INFO - Avg. fwd time: 7.4542 / Avg. bwd time: 22.0732 / Avg. batch time: 609.6794 (ms) / GPU bubble ratio: 61.26%
[rank1]:2025-11-28 22:59:58,700 - INFO - Avg. fwd time: 9.5428 / Avg. bwd time: 23.2004 / Avg. batch time: 574.5398 (ms) / GPU bubble ratio: 54.41%
[rank3]:2025-11-28 23:00:15,808 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-28 23:00:15,987 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2300_max_batch_time.svg
[rank3]:			> Batch Time: 541.30 ms, GPU Bubble Ratio: 54.16%, 50.54%, 61.10%, 17.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  126-23-150ms   | [S0,MB4,F]  150-6-157ms    | [S0,MB1,B]  178-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  233-23-257ms   | [S0,MB6,F]  257-6-263ms    | [S0,MB3,B]  289-23-313ms   | [S0,MB7,F]  313-6-320ms    | [S0,MB4,B]  346-23-370ms   | [S0,MB5,B]  403-23-427ms   | [S0,MB6,B]  460-23-484ms   | [S0,MB7,B]  517-23-541ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-24-126ms   | [S1,MB3,F]  126-8-135ms    | [S1,MB1,B]  153-24-178ms   | [S1,MB4,F]  178-9-187ms    | [S1,MB2,B]  209-24-233ms   | [S1,MB5,F]  233-9-242ms    | [S1,MB3,B]  265-24-289ms   | [S1,MB6,F]  289-9-299ms    | [S1,MB4,B]  322-24-346ms   | [S1,MB7,F]  346-9-355ms    | [S1,MB5,B]  379-24-403ms   | [S1,MB6,B]  436-24-460ms   | [S1,MB7,B]  493-23-517ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-6-109ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  190-19-209ms   | [S2,MB4,F]  209-6-216ms    | [S2,MB3,B]  246-19-265ms   | [S2,MB5,F]  265-6-272ms    | [S2,MB4,B]  303-19-322ms   | [S2,MB6,F]  322-6-329ms    | [S2,MB5,B]  360-19-379ms   | [S2,MB7,F]  379-7-386ms    | [S2,MB6,B]  417-19-436ms   | [S2,MB7,B]  474-19-493ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-148ms   | [S3,MB2,B]  148-41-190ms   AFR(10):0.9655 | [S3,MB3,F]  190-13-203ms   | [S3,MB3,B]  203-42-246ms   AFR(10):0.9655 | [S3,MB4,F]  246-14-260ms   | [S3,MB4,B]  260-42-303ms   AFR(10):0.9655 | [S3,MB5,F]  303-14-317ms   | [S3,MB5,B]  317-42-360ms   AFR(10):0.9655 | [S3,MB6,F]  360-14-374ms   | [S3,MB6,B]  374-42-417ms   AFR(10):0.9655 | [S3,MB7,F]  417-13-431ms   | [S3,MB7,B]  431-43-474ms   AFR(10):0.9655
[rank3]:2025-11-28 23:00:16,142 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2300_min_batch_time.svg
[rank3]:			> Batch Time: 330.11 ms, GPU Bubble Ratio: 82.31%, 50.86%, 61.68%, 14.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  151-0-151ms    | [S0,MB6,F]  151-6-157ms    | [S0,MB3,B]  186-0-186ms    | [S0,MB7,F]  186-6-193ms    | [S0,MB4,B]  222-0-222ms    | [S0,MB5,B]  258-0-258ms    | [S0,MB6,B]  294-0-294ms    | [S0,MB7,B]  330-0-330ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  105-10-115ms   | [S1,MB4,F]  115-9-125ms    | [S1,MB2,B]  140-10-151ms   | [S1,MB5,F]  151-9-160ms    | [S1,MB3,B]  175-11-186ms   | [S1,MB6,F]  186-9-195ms    | [S1,MB4,B]  211-11-222ms   | [S1,MB7,F]  222-9-231ms    | [S1,MB5,B]  247-11-258ms   | [S1,MB6,B]  283-10-294ms   | [S1,MB7,B]  319-10-330ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  64-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-105ms     | [S2,MB3,F]  105-7-112ms    | [S2,MB2,B]  131-8-140ms    | [S2,MB4,F]  140-6-147ms    | [S2,MB3,B]  166-8-175ms    | [S2,MB5,F]  175-6-182ms    | [S2,MB4,B]  202-8-211ms    | [S2,MB6,F]  211-6-218ms    | [S2,MB5,B]  239-8-247ms    | [S2,MB7,F]  247-7-254ms    | [S2,MB6,B]  275-8-283ms    | [S2,MB7,B]  310-8-319ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-21-64ms     AFR(10):0.9655 | [S3,MB1,F]  64-11-75ms     | [S3,MB1,B]  75-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-110ms    | [S3,MB2,B]  110-21-131ms   AFR(10):0.9655 | [S3,MB3,F]  131-13-145ms   | [S3,MB3,B]  145-21-166ms   AFR(10):0.9655 | [S3,MB4,F]  166-14-180ms   | [S3,MB4,B]  180-21-202ms   AFR(10):0.9655 | [S3,MB5,F]  202-14-216ms   | [S3,MB5,B]  216-22-239ms   AFR(10):0.9655 | [S3,MB6,F]  239-14-253ms   | [S3,MB6,B]  253-21-275ms   AFR(10):0.9655 | [S3,MB7,F]  275-13-289ms   | [S3,MB7,B]  289-21-310ms   AFR(10):0.9655
[rank3]:2025-11-28 23:00:25,778 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2300_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 360.53 ms, GPU Bubble Ratio: 40.97%, 29.39%, 44.51%, 13.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-23ms      | [S0,MB3,F]  23-7-31ms      | [S0,MB0,B]  126-23-150ms   | [S0,MB4,F]  150-6-157ms    | [S0,MB1,B]  170-23-193ms   | [S0,MB5,F]  193-6-200ms    | [S0,MB2,B]  205-23-229ms   | [S0,MB6,F]  229-6-235ms    | [S0,MB3,B]  240-23-264ms   | [S0,MB7,F]  264-6-270ms    | [S0,MB4,B]  276-23-299ms   | [S0,MB5,B]  312-23-336ms   | [S0,MB6,B]  348-11-360ms   | [S0,MB7,B]  360-0-360ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-24-126ms   | [S1,MB3,F]  126-8-135ms    | [S1,MB1,B]  145-24-170ms   | [S1,MB4,F]  170-9-179ms    | [S1,MB2,B]  181-24-205ms   | [S1,MB5,F]  205-9-214ms    | [S1,MB3,B]  216-24-240ms   | [S1,MB6,F]  240-9-249ms    | [S1,MB4,B]  251-24-276ms   | [S1,MB7,F]  276-9-285ms    | [S1,MB5,B]  288-24-312ms   | [S1,MB6,B]  324-23-348ms   | [S1,MB7,B]  349-10-360ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-6-109ms    | [S2,MB1,B]  126-19-145ms   | [S2,MB3,F]  145-7-152ms    | [S2,MB2,B]  162-19-181ms   | [S2,MB4,F]  181-6-188ms    | [S2,MB3,B]  197-19-216ms   | [S2,MB5,F]  216-6-223ms    | [S2,MB4,B]  232-19-251ms   | [S2,MB6,F]  251-6-258ms    | [S2,MB5,B]  269-19-288ms   | [S2,MB7,F]  288-7-295ms    | [S2,MB6,B]  305-19-324ms   | [S2,MB7,B]  341-8-349ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  43-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-32-126ms    AFR(10):0.9655 | [S3,MB2,F]  126-13-140ms   | [S3,MB2,B]  140-21-162ms   AFR(10):0.9655 | [S3,MB3,F]  162-13-175ms   | [S3,MB3,B]  175-21-197ms   AFR(10):0.9655 | [S3,MB4,F]  197-14-211ms   | [S3,MB4,B]  211-21-232ms   AFR(10):0.9655 | [S3,MB5,F]  232-14-247ms   | [S3,MB5,B]  247-22-269ms   AFR(10):0.9655 | [S3,MB6,F]  269-14-283ms   | [S3,MB6,B]  283-21-305ms   AFR(10):0.9655 | [S3,MB7,F]  305-13-319ms   | [S3,MB7,B]  319-21-341ms   AFR(10):0.9655
[rank3]:2025-11-28 23:00:25,779 - INFO - 	> Batch Time: 360.53 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.33)
[rank0]:2025-11-28 23:01:48,240 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 23:01:52,708 - INFO - Avg. fwd time: 7.5890 / Avg. bwd time: 19.4835 / Avg. batch time: 583.7619 (ms) / GPU bubble ratio: 62.90%
[rank2]:2025-11-28 23:01:52,674 - INFO - Avg. fwd time: 7.4877 / Avg. bwd time: 17.6172 / Avg. batch time: 513.6757 (ms) / GPU bubble ratio: 60.90%
[rank1]:2025-11-28 23:01:52,711 - INFO - Avg. fwd time: 9.6786 / Avg. bwd time: 22.1127 / Avg. batch time: 550.6038 (ms) / GPU bubble ratio: 53.81%
[rank3]:2025-11-28 23:01:52,635 - INFO - Avg. fwd time: 13.6609 / Avg. bwd time: 37.7441 / Avg. batch time: 483.6285 (ms) / GPU bubble ratio: 14.97%
[rank3]:2025-11-28 23:01:52,644 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.10(0.13)/0.40, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-11-28 23:01:52,897 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank2]:2025-11-28 23:01:52,850 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-11-28 23:01:52,911 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.9769  memory:  6.51GiB(13.70%)  tps: 6,997  tflops: 54.70  mfu: 17.53%
[rank1]:2025-11-28 23:01:52,876 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-11-28 23:01:52,915 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.9769  memory:  9.36GiB(19.71%)  tps: 6,997  tflops: 54.70  mfu: 17.53%
[rank3]:2025-11-28 23:01:52,924 - INFO -  step: 100  loss:  8.7539  grad_norm:  5.9769  memory: 16.88GiB(35.53%)  tps: 6,997  tflops: 54.70  mfu: 17.53%
[rank0]:2025-11-28 23:01:52,926 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.9769  memory: 12.97GiB(27.31%)  tps: 6,997  tflops: 54.70  mfu: 17.53%
[rank0]:2025-11-28 23:01:53,003 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2301_stage0_step100.svg
[rank2]:2025-11-28 23:01:53,002 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2301_stage2_step100.svg
[rank1]:2025-11-28 23:01:53,003 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2301_stage1_step100.svg
[rank3]:2025-11-28 23:01:53,067 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2301_real_step100_rank3.svg
[rank3]:			> Batch Time: 572.84 ms, GPU Bubble Ratio: 62.82%, 54.29%, 64.01%, 30.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  128-16-144ms   | [S0,MB4,F]  144-7-151ms    | [S0,MB1,B]  190-16-207ms   | [S0,MB5,F]  207-6-214ms    | [S0,MB2,B]  254-16-271ms   | [S0,MB6,F]  271-6-278ms    | [S0,MB3,B]  319-16-335ms   | [S0,MB7,F]  335-6-342ms    | [S0,MB4,B]  381-23-404ms   | [S0,MB5,B]  442-23-466ms   | [S0,MB6,B]  500-19-519ms   | [S0,MB7,B]  553-19-572ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  101-21-122ms   | [S1,MB3,F]  126-9-135ms    | [S1,MB1,B]  164-21-185ms   | [S1,MB4,F]  189-9-198ms    | [S1,MB2,B]  228-21-249ms   | [S1,MB5,F]  253-9-262ms    | [S1,MB3,B]  289-24-313ms   | [S1,MB6,F]  317-9-326ms    | [S1,MB4,B]  351-24-376ms   | [S1,MB7,F]  379-9-389ms    | [S1,MB5,B]  415-24-439ms   | [S1,MB6,B]  472-24-497ms   | [S1,MB7,B]  526-23-550ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-40ms      | [S2,MB0,B]  79-16-96ms     | [S2,MB2,F]  99-7-107ms     | [S2,MB1,B]  142-16-159ms   | [S2,MB3,F]  162-7-169ms    | [S2,MB2,B]  203-19-223ms   | [S2,MB4,F]  226-7-233ms    | [S2,MB3,B]  265-19-284ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB4,B]  327-19-346ms   | [S2,MB6,F]  350-7-357ms    | [S2,MB5,B]  390-19-410ms   | [S2,MB7,F]  413-7-420ms    | [S2,MB6,B]  450-19-469ms   | [S2,MB7,B]  504-18-523ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  49-25-74ms     | [S3,MB1,F]  78-13-91ms     | [S3,MB1,B]  97-40-137ms    | [S3,MB2,F]  141-11-153ms   | [S3,MB2,B]  159-39-199ms   | [S3,MB3,F]  202-14-216ms   | [S3,MB3,B]  221-38-260ms   | [S3,MB4,F]  263-13-277ms   | [S3,MB4,B]  283-38-322ms   | [S3,MB5,F]  326-13-339ms   | [S3,MB5,B]  345-40-386ms   | [S3,MB6,F]  389-13-403ms   | [S3,MB6,B]  409-36-445ms   | [S3,MB7,F]  448-15-464ms   | [S3,MB7,B]  471-30-501ms  
[rank3]:2025-11-28 23:01:53,111 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2301_stage3_step100.svg
[rank3]:2025-11-28 23:03:49,999 - INFO - Avg. fwd time: 13.6899 / Avg. bwd time: 37.2737 / Avg. batch time: 480.3327 (ms) / GPU bubble ratio: 15.12%
[rank2]:2025-11-28 23:03:50,067 - INFO - Avg. fwd time: 7.4675 / Avg. bwd time: 17.7372 / Avg. batch time: 510.5445 (ms) / GPU bubble ratio: 60.51%
[rank0]:2025-11-28 23:03:50,106 - INFO - Avg. fwd time: 7.5918 / Avg. bwd time: 19.6015 / Avg. batch time: 580.8039 (ms) / GPU bubble ratio: 62.54%
[rank1]:2025-11-28 23:03:50,108 - INFO - Avg. fwd time: 9.6557 / Avg. bwd time: 22.1867 / Avg. batch time: 547.5952 (ms) / GPU bubble ratio: 53.48%
[rank0]:2025-11-28 23:05:36,163 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 23:05:40,469 - INFO - Avg. fwd time: 13.7543 / Avg. bwd time: 36.1462 / Avg. batch time: 472.4605 (ms) / GPU bubble ratio: 15.51%
[rank3]:2025-11-28 23:05:40,474 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.27)/0.40, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-11-28 23:05:40,494 - INFO - Avg. fwd time: 7.4767 / Avg. bwd time: 17.6540 / Avg. batch time: 502.5610 (ms) / GPU bubble ratio: 60.00%
[rank2]:2025-11-28 23:05:40,500 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-11-28 23:05:40,522 - INFO - Avg. fwd time: 9.6759 / Avg. bwd time: 21.9980 / Avg. batch time: 539.5441 (ms) / GPU bubble ratio: 53.04%
[rank1]:2025-11-28 23:05:40,528 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank1]:2025-11-28 23:05:40,575 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.4047  memory:  9.36GiB(19.71%)  tps: 7,197  tflops: 56.26  mfu: 18.03%
[rank0]:2025-11-28 23:05:40,550 - INFO - Avg. fwd time: 7.6462 / Avg. bwd time: 19.3586 / Avg. batch time: 572.6337 (ms) / GPU bubble ratio: 62.27%
[rank0]:2025-11-28 23:05:40,558 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-11-28 23:05:40,586 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.4047  memory: 13.29GiB(27.97%)  tps: 7,197  tflops: 56.26  mfu: 18.03%
[rank3]:2025-11-28 23:05:40,584 - INFO -  step: 150  loss:  4.2141  grad_norm:  6.4047  memory: 17.37GiB(36.56%)  tps: 7,197  tflops: 56.26  mfu: 18.03%
[rank2]:2025-11-28 23:05:40,572 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.4047  memory:  6.51GiB(13.70%)  tps: 7,197  tflops: 56.26  mfu: 18.03%
[rank3]:2025-11-28 23:07:25,423 - INFO - Avg. fwd time: 13.8225 / Avg. bwd time: 35.0673 / Avg. batch time: 464.6015 (ms) / GPU bubble ratio: 15.82%
[rank2]:2025-11-28 23:07:25,488 - INFO - Avg. fwd time: 7.4833 / Avg. bwd time: 17.6133 / Avg. batch time: 494.6821 (ms) / GPU bubble ratio: 59.41%
[rank1]:2025-11-28 23:07:25,528 - INFO - Avg. fwd time: 9.7040 / Avg. bwd time: 21.7934 / Avg. batch time: 531.5924 (ms) / GPU bubble ratio: 52.60%
[rank0]:2025-11-28 23:07:25,525 - INFO - Avg. fwd time: 7.6843 / Avg. bwd time: 18.9937 / Avg. batch time: 564.3600 (ms) / GPU bubble ratio: 62.18%
[rank0]:2025-11-28 23:09:04,115 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:09:07,922 - INFO - Avg. fwd time: 13.8904 / Avg. bwd time: 33.9354 / Avg. batch time: 456.1315 (ms) / GPU bubble ratio: 16.12%
[rank3]:2025-11-28 23:09:07,928 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.38(0.40)/0.40, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-11-28 23:09:07,993 - INFO - Avg. fwd time: 7.5092 / Avg. bwd time: 17.4630 / Avg. batch time: 486.0506 (ms) / GPU bubble ratio: 58.90%
[rank1]:2025-11-28 23:09:08,034 - INFO - Avg. fwd time: 9.7470 / Avg. bwd time: 21.5011 / Avg. batch time: 522.8332 (ms) / GPU bubble ratio: 52.19%
[rank0]:2025-11-28 23:09:08,030 - INFO - Avg. fwd time: 7.7384 / Avg. bwd time: 18.3540 / Avg. batch time: 555.2388 (ms) / GPU bubble ratio: 62.41%
[rank2]:2025-11-28 23:09:08,134 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-11-28 23:09:08,158 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-11-28 23:09:08,196 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.5395  memory:  9.36GiB(19.71%)  tps: 7,891  tflops: 61.69  mfu: 19.77%
[rank0]:2025-11-28 23:09:08,178 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank0]:2025-11-28 23:09:08,206 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.5395  memory: 13.29GiB(27.97%)  tps: 7,891  tflops: 61.69  mfu: 19.77%
[rank3]:2025-11-28 23:09:08,201 - INFO -  step: 200  loss:  1.7163  grad_norm:  1.5395  memory: 17.37GiB(36.56%)  tps: 7,892  tflops: 61.69  mfu: 19.77%
[rank2]:2025-11-28 23:09:08,192 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.5395  memory:  6.51GiB(13.70%)  tps: 7,891  tflops: 61.69  mfu: 19.77%
[rank2]:2025-11-28 23:09:08,258 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2309_stage2_step200.svg
[rank1]:2025-11-28 23:09:08,259 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2309_stage1_step200.svg
[rank0]:2025-11-28 23:09:08,259 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2309_stage0_step200.svg
[rank3]:2025-11-28 23:09:08,348 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2309_real_step200_rank3.svg
[rank3]:			> Batch Time: 485.33 ms, GPU Bubble Ratio: 65.33%, 50.83%, 60.46%, 34.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  107-4-112ms    | [S0,MB4,F]  112-8-120ms    | [S0,MB1,B]  170-4-174ms    | [S0,MB5,F]  174-6-181ms    | [S0,MB2,B]  235-4-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  294-4-299ms    | [S0,MB7,F]  299-6-306ms    | [S0,MB4,B]  341-23-365ms   | [S0,MB5,B]  386-24-410ms   | [S0,MB6,B]  430-18-448ms   | [S0,MB7,B]  468-17-485ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  89-12-102ms    | [S1,MB3,F]  105-10-116ms   | [S1,MB1,B]  152-12-164ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  217-12-229ms   | [S1,MB5,F]  233-8-242ms    | [S1,MB3,B]  264-24-289ms   | [S1,MB6,F]  292-9-302ms    | [S1,MB4,B]  311-24-336ms   | [S1,MB7,F]  339-9-349ms    | [S1,MB5,B]  357-24-382ms   | [S1,MB6,B]  401-24-426ms   | [S1,MB7,B]  442-22-464ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  75-8-84ms      | [S2,MB2,F]  88-8-96ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  192-19-212ms   | [S2,MB4,F]  215-7-222ms    | [S2,MB3,B]  240-19-259ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  287-19-306ms   | [S2,MB6,F]  310-7-317ms    | [S2,MB5,B]  333-19-352ms   | [S2,MB7,F]  356-7-363ms    | [S2,MB6,B]  379-19-398ms   | [S2,MB7,B]  423-16-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-22-70ms     | [S3,MB1,F]  74-13-87ms     | [S3,MB1,B]  93-39-133ms    | [S3,MB2,F]  137-11-148ms   | [S3,MB2,B]  154-33-187ms   | [S3,MB3,F]  191-15-206ms   | [S3,MB3,B]  212-22-234ms   | [S3,MB4,F]  238-14-253ms   | [S3,MB4,B]  259-22-281ms   | [S3,MB5,F]  285-14-299ms   | [S3,MB5,B]  305-22-327ms   | [S3,MB6,F]  331-14-346ms   | [S3,MB6,B]  352-21-374ms   | [S3,MB7,F]  377-14-392ms   | [S3,MB7,B]  398-21-419ms  
[rank3]:2025-11-28 23:09:08,394 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2309_stage3_step200.svg
[rank3]:2025-11-28 23:10:46,611 - INFO - Avg. fwd time: 13.9543 / Avg. bwd time: 32.7934 / Avg. batch time: 447.3919 (ms) / GPU bubble ratio: 16.41%
[rank2]:2025-11-28 23:10:46,636 - INFO - Avg. fwd time: 7.5343 / Avg. bwd time: 17.3222 / Avg. batch time: 477.1872 (ms) / GPU bubble ratio: 58.33%
[rank1]:2025-11-28 23:10:46,664 - INFO - Avg. fwd time: 9.7914 / Avg. bwd time: 21.2282 / Avg. batch time: 513.8500 (ms) / GPU bubble ratio: 51.71%
[rank0]:2025-11-28 23:10:46,688 - INFO - Avg. fwd time: 7.7859 / Avg. bwd time: 17.4566 / Avg. batch time: 545.9185 (ms) / GPU bubble ratio: 63.01%
[rank0]:2025-11-28 23:12:21,286 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 23:12:24,939 - INFO - Avg. fwd time: 14.0013 / Avg. bwd time: 31.9993 / Avg. batch time: 441.3386 (ms) / GPU bubble ratio: 16.62%
[rank3]:2025-11-28 23:12:24,947 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-28 23:12:25,007 - INFO - Avg. fwd time: 7.5500 / Avg. bwd time: 17.2267 / Avg. batch time: 471.0010 (ms) / GPU bubble ratio: 57.92%
[rank1]:2025-11-28 23:12:25,046 - INFO - Avg. fwd time: 9.8215 / Avg. bwd time: 21.0393 / Avg. batch time: 507.5793 (ms) / GPU bubble ratio: 51.36%
[rank0]:2025-11-28 23:12:25,001 - INFO - Avg. fwd time: 7.8176 / Avg. bwd time: 16.8120 / Avg. batch time: 539.4210 (ms) / GPU bubble ratio: 63.47%
[rank2]:2025-11-28 23:12:25,140 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-28 23:12:25,164 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-28 23:12:25,183 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank3]:2025-11-28 23:12:25,191 - INFO -  step: 250  loss:  1.2799  grad_norm:  0.4432  memory: 17.37GiB(36.56%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank2]:2025-11-28 23:12:25,197 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4432  memory:  6.51GiB(13.70%)  tps: 8,317  tflops: 65.01  mfu: 20.84%
[rank1]:2025-11-28 23:12:25,201 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4432  memory:  9.36GiB(19.71%)  tps: 8,317  tflops: 65.01  mfu: 20.84%
[rank0]:2025-11-28 23:12:25,212 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4432  memory: 13.29GiB(27.97%)  tps: 8,317  tflops: 65.01  mfu: 20.84%
[rank3]:2025-11-28 23:14:04,921 - INFO - Avg. fwd time: 14.0429 / Avg. bwd time: 31.3262 / Avg. batch time: 436.2219 (ms) / GPU bubble ratio: 16.80%
[rank2]:2025-11-28 23:14:04,988 - INFO - Avg. fwd time: 7.5655 / Avg. bwd time: 17.1371 / Avg. batch time: 465.7551 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-11-28 23:14:04,982 - INFO - Avg. fwd time: 7.8472 / Avg. bwd time: 16.2099 / Avg. batch time: 533.9009 (ms) / GPU bubble ratio: 63.95%
[rank1]:2025-11-28 23:14:05,025 - INFO - Avg. fwd time: 9.8491 / Avg. bwd time: 20.8635 / Avg. batch time: 502.2909 (ms) / GPU bubble ratio: 51.08%
[rank0]:2025-11-28 23:15:41,103 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:15:45,039 - INFO - Avg. fwd time: 14.0717 / Avg. bwd time: 30.7681 / Avg. batch time: 431.9297 (ms) / GPU bubble ratio: 16.95%
[rank3]:2025-11-28 23:15:45,044 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-28 23:15:45,064 - INFO - Avg. fwd time: 7.5774 / Avg. bwd time: 17.0637 / Avg. batch time: 461.3604 (ms) / GPU bubble ratio: 57.27%
[rank2]:2025-11-28 23:15:45,070 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-28 23:15:45,093 - INFO - Avg. fwd time: 9.8696 / Avg. bwd time: 20.7170 / Avg. batch time: 497.8525 (ms) / GPU bubble ratio: 50.85%
[rank1]:2025-11-28 23:15:45,100 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-28 23:15:45,118 - INFO - Avg. fwd time: 7.8709 / Avg. bwd time: 15.7102 / Avg. batch time: 529.2732 (ms) / GPU bubble ratio: 64.36%
[rank0]:2025-11-28 23:15:45,126 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-28 23:15:45,154 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.6250  memory: 13.29GiB(27.97%)  tps: 8,194  tflops: 64.06  mfu: 20.53%
[rank3]:2025-11-28 23:15:45,149 - INFO -  step: 300  loss:  0.5887  grad_norm:  0.6250  memory: 17.37GiB(36.56%)  tps: 8,194  tflops: 64.06  mfu: 20.53%
[rank2]:2025-11-28 23:15:45,139 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.6250  memory:  6.51GiB(13.70%)  tps: 8,194  tflops: 64.06  mfu: 20.53%
[rank2]:2025-11-28 23:15:45,203 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2315_stage2_step300.svg
[rank1]:2025-11-28 23:15:45,143 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.6250  memory:  9.36GiB(19.71%)  tps: 8,194  tflops: 64.06  mfu: 20.53%
[rank1]:2025-11-28 23:15:45,203 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2315_stage1_step300.svg
[rank0]:2025-11-28 23:15:45,204 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2315_stage0_step300.svg
[rank3]:2025-11-28 23:15:45,290 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2315_real_step300_rank3.svg
[rank3]:			> Batch Time: 484.53 ms, GPU Bubble Ratio: 69.41%, 51.67%, 60.31%, 34.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  233-0-233ms    | [S0,MB6,F]  233-6-239ms    | [S0,MB3,B]  294-0-294ms    | [S0,MB7,F]  294-6-301ms    | [S0,MB4,B]  342-23-365ms   | [S0,MB5,B]  386-23-409ms   | [S0,MB6,B]  430-18-449ms   | [S0,MB7,B]  467-16-484ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-99ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  216-10-227ms   | [S1,MB5,F]  231-8-240ms    | [S1,MB3,B]  264-24-289ms   | [S1,MB6,F]  293-9-302ms    | [S1,MB4,B]  311-24-336ms   | [S1,MB7,F]  340-9-349ms    | [S1,MB5,B]  357-24-382ms   | [S1,MB6,B]  401-25-427ms   | [S1,MB7,B]  442-21-464ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-83ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  192-19-211ms   | [S2,MB4,F]  215-7-222ms    | [S2,MB3,B]  240-19-259ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  287-19-306ms   | [S2,MB6,F]  310-7-317ms    | [S2,MB5,B]  333-19-352ms   | [S2,MB7,F]  356-7-363ms    | [S2,MB6,B]  378-19-398ms   | [S2,MB7,B]  423-16-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-39-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-33-187ms   | [S3,MB3,F]  190-16-207ms   | [S3,MB3,B]  213-22-235ms   | [S3,MB4,F]  239-15-254ms   | [S3,MB4,B]  260-21-282ms   | [S3,MB5,F]  285-14-300ms   | [S3,MB5,B]  306-21-328ms   | [S3,MB6,F]  331-14-346ms   | [S3,MB6,B]  352-21-373ms   | [S3,MB7,F]  377-14-392ms   | [S3,MB7,B]  398-21-419ms  
[rank3]:2025-11-28 23:15:45,332 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2315_stage3_step300.svg
[rank3]:2025-11-28 23:17:25,127 - INFO - Avg. fwd time: 14.0978 / Avg. bwd time: 30.3743 / Avg. batch time: 428.9490 (ms) / GPU bubble ratio: 17.06%
[rank2]:2025-11-28 23:17:25,198 - INFO - Avg. fwd time: 7.5863 / Avg. bwd time: 17.0091 / Avg. batch time: 458.3373 (ms) / GPU bubble ratio: 57.07%
[rank0]:2025-11-28 23:17:25,192 - INFO - Avg. fwd time: 7.8887 / Avg. bwd time: 15.3325 / Avg. batch time: 526.0864 (ms) / GPU bubble ratio: 64.69%
[rank1]:2025-11-28 23:17:25,236 - INFO - Avg. fwd time: 9.8851 / Avg. bwd time: 20.6106 / Avg. batch time: 494.8081 (ms) / GPU bubble ratio: 50.69%
[rank0]:2025-11-28 23:19:00,485 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 23:19:04,237 - INFO - Avg. fwd time: 14.1217 / Avg. bwd time: 29.9355 / Avg. batch time: 425.5842 (ms) / GPU bubble ratio: 17.18%
[rank0]:2025-11-28 23:19:04,301 - INFO - Avg. fwd time: 7.9060 / Avg. bwd time: 14.9554 / Avg. batch time: 522.4657 (ms) / GPU bubble ratio: 64.99%
[rank2]:2025-11-28 23:19:04,307 - INFO - Avg. fwd time: 7.5951 / Avg. bwd time: 16.9558 / Avg. batch time: 454.8937 (ms) / GPU bubble ratio: 56.82%
[rank1]:2025-11-28 23:19:04,344 - INFO - Avg. fwd time: 9.9018 / Avg. bwd time: 20.5040 / Avg. batch time: 491.3286 (ms) / GPU bubble ratio: 50.49%
[rank1]:2025-11-28 23:19:04,501 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2163  memory:  9.36GiB(19.71%)  tps: 8,218  tflops: 64.25  mfu: 20.59%
[rank3]:2025-11-28 23:19:04,503 - INFO -  step: 350  loss:  0.3412  grad_norm:  0.2163  memory: 17.37GiB(36.56%)  tps: 8,219  tflops: 64.25  mfu: 20.59%
[rank2]:2025-11-28 23:19:04,497 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2163  memory:  6.51GiB(13.70%)  tps: 8,218  tflops: 64.25  mfu: 20.59%
[rank0]:2025-11-28 23:19:04,511 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2163  memory: 13.29GiB(27.97%)  tps: 8,218  tflops: 64.25  mfu: 20.59%
[rank3]:2025-11-28 23:20:43,224 - INFO - Avg. fwd time: 14.1447 / Avg. bwd time: 29.5431 / Avg. batch time: 422.5891 (ms) / GPU bubble ratio: 17.30%
[rank2]:2025-11-28 23:20:43,250 - INFO - Avg. fwd time: 7.6030 / Avg. bwd time: 16.9094 / Avg. batch time: 451.8318 (ms) / GPU bubble ratio: 56.60%
[rank0]:2025-11-28 23:20:43,305 - INFO - Avg. fwd time: 7.9209 / Avg. bwd time: 14.6439 / Avg. batch time: 519.2504 (ms) / GPU bubble ratio: 65.23%
[rank1]:2025-11-28 23:20:43,279 - INFO - Avg. fwd time: 9.9162 / Avg. bwd time: 20.4108 / Avg. batch time: 488.2316 (ms) / GPU bubble ratio: 50.31%
[rank0]:2025-11-28 23:22:18,146 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:22:21,918 - INFO - Avg. fwd time: 14.1610 / Avg. bwd time: 29.2443 / Avg. batch time: 420.3017 (ms) / GPU bubble ratio: 17.38%
[rank0]:2025-11-28 23:22:21,981 - INFO - Avg. fwd time: 7.9320 / Avg. bwd time: 14.3990 / Avg. batch time: 516.7859 (ms) / GPU bubble ratio: 65.43%
[rank2]:2025-11-28 23:22:21,983 - INFO - Avg. fwd time: 7.6087 / Avg. bwd time: 16.8746 / Avg. batch time: 449.4933 (ms) / GPU bubble ratio: 56.43%
[rank1]:2025-11-28 23:22:22,026 - INFO - Avg. fwd time: 9.9269 / Avg. bwd time: 20.3409 / Avg. batch time: 485.8587 (ms) / GPU bubble ratio: 50.16%
[rank1]:2025-11-28 23:22:22,180 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1103  memory:  9.36GiB(19.71%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank3]:2025-11-28 23:22:22,185 - INFO -  step: 400  loss:  0.3024  grad_norm:  0.1103  memory: 17.37GiB(36.56%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank2]:2025-11-28 23:22:22,176 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1103  memory:  6.51GiB(13.70%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank2]:2025-11-28 23:22:22,243 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2322_stage2_step400.svg
[rank1]:2025-11-28 23:22:22,244 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2322_stage1_step400.svg
[rank0]:2025-11-28 23:22:22,191 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1103  memory: 13.29GiB(27.97%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank0]:2025-11-28 23:22:22,244 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2322_stage0_step400.svg
[rank3]:2025-11-28 23:22:22,325 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2322_real_step400_rank3.svg
[rank3]:			> Batch Time: 483.77 ms, GPU Bubble Ratio: 69.52%, 51.67%, 60.28%, 34.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  231-0-231ms    | [S0,MB6,F]  231-6-238ms    | [S0,MB3,B]  293-0-293ms    | [S0,MB7,F]  293-6-300ms    | [S0,MB4,B]  341-23-365ms   | [S0,MB5,B]  385-23-409ms   | [S0,MB6,B]  430-18-448ms   | [S0,MB7,B]  467-16-483ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-173ms    | [S1,MB2,B]  215-10-226ms   | [S1,MB5,F]  229-8-238ms    | [S1,MB3,B]  263-24-288ms   | [S1,MB6,F]  292-9-301ms    | [S1,MB4,B]  311-24-336ms   | [S1,MB7,F]  339-9-348ms    | [S1,MB5,B]  357-24-382ms   | [S1,MB6,B]  401-25-426ms   | [S1,MB7,B]  442-21-463ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  136-8-145ms    | [S2,MB3,F]  148-6-155ms    | [S2,MB2,B]  190-19-210ms   | [S2,MB4,F]  213-6-220ms    | [S2,MB3,B]  239-19-258ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  286-19-306ms   | [S2,MB6,F]  309-7-316ms    | [S2,MB5,B]  332-19-352ms   | [S2,MB7,F]  355-7-362ms    | [S2,MB6,B]  378-19-397ms   | [S2,MB7,B]  422-16-438ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-39-131ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  153-33-186ms   | [S3,MB3,F]  189-16-205ms   | [S3,MB3,B]  212-22-234ms   | [S3,MB4,F]  238-15-253ms   | [S3,MB4,B]  259-22-281ms   | [S3,MB5,F]  285-14-300ms   | [S3,MB5,B]  306-21-327ms   | [S3,MB6,F]  331-14-345ms   | [S3,MB6,B]  351-21-373ms   | [S3,MB7,F]  376-14-391ms   | [S3,MB7,B]  397-21-419ms  
[rank3]:2025-11-28 23:22:22,371 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2322_stage3_step400.svg
[rank3]:2025-11-28 23:22:45,094 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-28 23:22:45,314 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 23:22:45,290 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-28 23:22:45,334 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-11-28 23:24:01,767 - INFO - Avg. fwd time: 14.1796 / Avg. bwd time: 28.9789 / Avg. batch time: 418.3023 (ms) / GPU bubble ratio: 17.46%
[rank2]:2025-11-28 23:24:01,835 - INFO - Avg. fwd time: 7.6147 / Avg. bwd time: 16.8379 / Avg. batch time: 447.4655 (ms) / GPU bubble ratio: 56.28%
[rank1]:2025-11-28 23:24:01,873 - INFO - Avg. fwd time: 9.9358 / Avg. bwd time: 20.2687 / Avg. batch time: 483.8099 (ms) / GPU bubble ratio: 50.06%
[rank0]:2025-11-28 23:24:01,828 - INFO - Avg. fwd time: 7.9434 / Avg. bwd time: 14.1574 / Avg. batch time: 514.6384 (ms) / GPU bubble ratio: 65.64%
[rank0]:2025-11-28 23:25:36,762 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-28 23:25:40,702 - INFO - Avg. fwd time: 7.6193 / Avg. bwd time: 16.8058 / Avg. batch time: 445.3252 (ms) / GPU bubble ratio: 56.12%
[rank1]:2025-11-28 23:25:40,732 - INFO - Avg. fwd time: 9.9450 / Avg. bwd time: 20.2059 / Avg. batch time: 481.6477 (ms) / GPU bubble ratio: 49.92%
[rank3]:2025-11-28 23:25:40,676 - INFO - Avg. fwd time: 14.1940 / Avg. bwd time: 28.7061 / Avg. batch time: 416.2092 (ms) / GPU bubble ratio: 17.54%
[rank2]:2025-11-28 23:25:40,780 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1228  memory:  6.51GiB(13.70%)  tps: 8,250  tflops: 64.49  mfu: 20.67%
[rank1]:2025-11-28 23:25:40,783 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1228  memory:  9.36GiB(19.71%)  tps: 8,250  tflops: 64.49  mfu: 20.67%
[rank0]:2025-11-28 23:25:40,758 - INFO - Avg. fwd time: 7.9539 / Avg. bwd time: 13.9317 / Avg. batch time: 512.3995 (ms) / GPU bubble ratio: 65.83%
[rank0]:2025-11-28 23:25:40,794 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1228  memory: 13.29GiB(27.97%)  tps: 8,250  tflops: 64.49  mfu: 20.67%
[rank3]:2025-11-28 23:25:40,788 - INFO -  step: 450  loss:  0.2774  grad_norm:  0.1228  memory: 17.37GiB(36.56%)  tps: 8,250  tflops: 64.49  mfu: 20.67%
[rank3]:2025-11-28 23:27:18,668 - INFO - Avg. fwd time: 14.2060 / Avg. bwd time: 28.4747 / Avg. batch time: 414.4307 (ms) / GPU bubble ratio: 17.61%
[rank2]:2025-11-28 23:27:18,736 - INFO - Avg. fwd time: 7.6233 / Avg. bwd time: 16.7813 / Avg. batch time: 443.5091 (ms) / GPU bubble ratio: 55.98%
[rank0]:2025-11-28 23:27:18,731 - INFO - Avg. fwd time: 7.9616 / Avg. bwd time: 13.7604 / Avg. batch time: 510.4901 (ms) / GPU bubble ratio: 65.96%
[rank1]:2025-11-28 23:27:18,774 - INFO - Avg. fwd time: 9.9534 / Avg. bwd time: 20.1566 / Avg. batch time: 479.8028 (ms) / GPU bubble ratio: 49.80%
[rank0]:2025-11-28 23:28:55,197 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 23:28:59,016 - INFO - Avg. fwd time: 7.9688 / Avg. bwd time: 13.5885 / Avg. batch time: 509.0766 (ms) / GPU bubble ratio: 66.12%
[rank3]:2025-11-28 23:28:58,955 - INFO - Avg. fwd time: 14.2181 / Avg. bwd time: 28.3058 / Avg. batch time: 413.1590 (ms) / GPU bubble ratio: 17.66%
[rank2]:2025-11-28 23:28:59,023 - INFO - Avg. fwd time: 7.6272 / Avg. bwd time: 16.7555 / Avg. batch time: 442.1959 (ms) / GPU bubble ratio: 55.89%
[rank1]:2025-11-28 23:28:59,061 - INFO - Avg. fwd time: 9.9586 / Avg. bwd time: 20.1034 / Avg. batch time: 478.4640 (ms) / GPU bubble ratio: 49.74%
[rank1]:2025-11-28 23:28:59,212 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1254  memory:  9.36GiB(19.71%)  tps: 8,257  tflops: 64.55  mfu: 20.69%
[rank0]:2025-11-28 23:28:59,223 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1254  memory: 13.29GiB(27.97%)  tps: 8,257  tflops: 64.55  mfu: 20.69%
[rank3]:2025-11-28 23:28:59,218 - INFO -  step: 500  loss:  0.2590  grad_norm:  0.1254  memory: 17.37GiB(36.56%)  tps: 8,257  tflops: 64.55  mfu: 20.69%
[rank2]:2025-11-28 23:28:59,208 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1254  memory:  6.51GiB(13.70%)  tps: 8,257  tflops: 64.55  mfu: 20.69%
[rank1]:2025-11-28 23:28:59,272 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2328_stage1_step500.svg
[rank0]:2025-11-28 23:28:59,273 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2328_stage0_step500.svg
[rank2]:2025-11-28 23:28:59,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2328_stage2_step500.svg
[rank3]:2025-11-28 23:28:59,357 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2328_real_step500_rank3.svg
[rank3]:			> Batch Time: 485.28 ms, GPU Bubble Ratio: 69.42%, 51.87%, 60.37%, 34.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  233-0-233ms    | [S0,MB6,F]  233-6-240ms    | [S0,MB3,B]  294-0-294ms    | [S0,MB7,F]  294-6-301ms    | [S0,MB4,B]  342-23-366ms   | [S0,MB5,B]  386-23-410ms   | [S0,MB6,B]  430-18-449ms   | [S0,MB7,B]  468-16-485ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-99ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  217-10-228ms   | [S1,MB5,F]  232-8-240ms    | [S1,MB3,B]  265-24-289ms   | [S1,MB6,F]  293-8-302ms    | [S1,MB4,B]  312-24-336ms   | [S1,MB7,F]  340-9-350ms    | [S1,MB5,B]  358-25-383ms   | [S1,MB6,B]  402-24-427ms   | [S1,MB7,B]  443-20-464ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  192-19-212ms   | [S2,MB4,F]  215-7-222ms    | [S2,MB3,B]  240-19-260ms   | [S2,MB5,F]  263-7-270ms    | [S2,MB4,B]  287-19-307ms   | [S2,MB6,F]  310-7-318ms    | [S2,MB5,B]  333-19-353ms   | [S2,MB7,F]  356-7-363ms    | [S2,MB6,B]  379-19-398ms   | [S2,MB7,B]  423-16-440ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-148ms   | [S3,MB2,B]  154-33-188ms   | [S3,MB3,F]  191-16-207ms   | [S3,MB3,B]  213-22-235ms   | [S3,MB4,F]  239-15-254ms   | [S3,MB4,B]  260-22-282ms   | [S3,MB5,F]  286-14-301ms   | [S3,MB5,B]  307-21-328ms   | [S3,MB6,F]  332-14-346ms   | [S3,MB6,B]  352-21-374ms   | [S3,MB7,F]  377-15-392ms   | [S3,MB7,B]  398-21-420ms  
[rank3]:2025-11-28 23:28:59,399 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2328_stage3_step500.svg
[rank2]:2025-11-28 23:30:39,121 - INFO - Avg. fwd time: 7.6308 / Avg. bwd time: 16.7320 / Avg. batch time: 440.9235 (ms) / GPU bubble ratio: 55.80%
[rank1]:2025-11-28 23:30:39,152 - INFO - Avg. fwd time: 9.9638 / Avg. bwd time: 20.0549 / Avg. batch time: 477.1688 (ms) / GPU bubble ratio: 49.67%
[rank3]:2025-11-28 23:30:39,094 - INFO - Avg. fwd time: 14.2297 / Avg. bwd time: 28.1390 / Avg. batch time: 411.8998 (ms) / GPU bubble ratio: 17.71%
[rank0]:2025-11-28 23:30:39,180 - INFO - Avg. fwd time: 7.9759 / Avg. bwd time: 13.4432 / Avg. batch time: 507.7200 (ms) / GPU bubble ratio: 66.25%
[rank0]:2025-11-28 23:32:15,036 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 23:32:18,812 - INFO - Avg. fwd time: 14.2404 / Avg. bwd time: 28.0051 / Avg. batch time: 410.9024 (ms) / GPU bubble ratio: 17.75%
[rank0]:2025-11-28 23:32:18,876 - INFO - Avg. fwd time: 7.9820 / Avg. bwd time: 13.3236 / Avg. batch time: 506.6295 (ms) / GPU bubble ratio: 66.36%
[rank2]:2025-11-28 23:32:18,883 - INFO - Avg. fwd time: 7.6337 / Avg. bwd time: 16.7135 / Avg. batch time: 439.8961 (ms) / GPU bubble ratio: 55.72%
[rank1]:2025-11-28 23:32:18,920 - INFO - Avg. fwd time: 9.9685 / Avg. bwd time: 20.0173 / Avg. batch time: 476.1256 (ms) / GPU bubble ratio: 49.62%
[rank0]:2025-11-28 23:32:19,083 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0841  memory: 13.29GiB(27.97%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank3]:2025-11-28 23:32:19,078 - INFO -  step: 550  loss:  0.2525  grad_norm:  0.0841  memory: 17.37GiB(36.56%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank2]:2025-11-28 23:32:19,069 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0841  memory:  6.51GiB(13.70%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank1]:2025-11-28 23:32:19,073 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0841  memory:  9.36GiB(19.71%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank3]:2025-11-28 23:33:57,694 - INFO - Avg. fwd time: 14.2512 / Avg. bwd time: 27.8403 / Avg. batch time: 409.6565 (ms) / GPU bubble ratio: 17.80%
[rank0]:2025-11-28 23:33:57,755 - INFO - Avg. fwd time: 7.9887 / Avg. bwd time: 13.1864 / Avg. batch time: 505.2846 (ms) / GPU bubble ratio: 66.47%
[rank2]:2025-11-28 23:33:57,762 - INFO - Avg. fwd time: 7.6368 / Avg. bwd time: 16.6937 / Avg. batch time: 438.6194 (ms) / GPU bubble ratio: 55.62%
[rank1]:2025-11-28 23:33:57,799 - INFO - Avg. fwd time: 9.9731 / Avg. bwd time: 19.9769 / Avg. batch time: 474.8282 (ms) / GPU bubble ratio: 49.54%
[rank0]:2025-11-28 23:35:31,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:35:35,651 - INFO - Avg. fwd time: 14.2608 / Avg. bwd time: 27.6582 / Avg. batch time: 408.2592 (ms) / GPU bubble ratio: 17.86%
[rank2]:2025-11-28 23:35:35,679 - INFO - Avg. fwd time: 7.6399 / Avg. bwd time: 16.6759 / Avg. batch time: 437.1960 (ms) / GPU bubble ratio: 55.51%
[rank1]:2025-11-28 23:35:35,711 - INFO - Avg. fwd time: 9.9790 / Avg. bwd time: 19.9416 / Avg. batch time: 473.3935 (ms) / GPU bubble ratio: 49.44%
[rank0]:2025-11-28 23:35:35,739 - INFO - Avg. fwd time: 7.9948 / Avg. bwd time: 13.0696 / Avg. batch time: 503.8065 (ms) / GPU bubble ratio: 66.55%
[rank0]:2025-11-28 23:35:35,775 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0935  memory: 13.29GiB(27.97%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank3]:2025-11-28 23:35:35,755 - INFO -  step: 600  loss:  0.2492  grad_norm:  0.0935  memory: 17.37GiB(36.56%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank2]:2025-11-28 23:35:35,760 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0935  memory:  6.51GiB(13.70%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank1]:2025-11-28 23:35:35,764 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0935  memory:  9.36GiB(19.71%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank0]:2025-11-28 23:35:35,825 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2335_stage0_step600.svg
[rank2]:2025-11-28 23:35:35,825 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2335_stage2_step600.svg
[rank1]:2025-11-28 23:35:35,825 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2335_stage1_step600.svg
[rank3]:2025-11-28 23:35:35,915 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2335_real_step600_rank3.svg
[rank3]:			> Batch Time: 471.16 ms, GPU Bubble Ratio: 67.68%, 50.32%, 59.22%, 35.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  162-0-162ms    | [S0,MB5,F]  162-6-169ms    | [S0,MB2,B]  223-0-223ms    | [S0,MB6,F]  223-6-229ms    | [S0,MB3,B]  283-0-283ms    | [S0,MB7,F]  283-6-289ms    | [S0,MB4,B]  329-23-353ms   | [S0,MB5,B]  373-23-397ms   | [S0,MB6,B]  417-22-439ms   | [S0,MB7,B]  454-16-471ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  146-10-157ms   | [S1,MB4,F]  160-8-169ms    | [S1,MB2,B]  206-10-217ms   | [S1,MB5,F]  221-8-230ms    | [S1,MB3,B]  253-24-277ms   | [S1,MB6,F]  281-9-290ms    | [S1,MB4,B]  299-24-324ms   | [S1,MB7,F]  327-9-337ms    | [S1,MB5,B]  345-25-370ms   | [S1,MB6,B]  388-24-413ms   | [S1,MB7,B]  429-21-451ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  132-8-141ms    | [S2,MB3,F]  144-6-151ms    | [S2,MB2,B]  182-19-201ms   | [S2,MB4,F]  205-7-212ms    | [S2,MB3,B]  228-19-248ms   | [S2,MB5,F]  251-7-258ms    | [S2,MB4,B]  274-19-294ms   | [S2,MB6,F]  297-7-304ms    | [S2,MB5,B]  320-19-340ms   | [S2,MB7,F]  343-7-350ms    | [S2,MB6,B]  366-19-385ms   | [S2,MB7,B]  410-16-426ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-35-127ms    | [S3,MB2,F]  131-14-145ms   | [S3,MB2,B]  151-25-177ms   | [S3,MB3,F]  181-14-195ms   | [S3,MB3,B]  201-21-223ms   | [S3,MB4,F]  227-14-241ms   | [S3,MB4,B]  247-21-269ms   | [S3,MB5,F]  273-14-288ms   | [S3,MB5,B]  294-21-315ms   | [S3,MB6,F]  319-14-333ms   | [S3,MB6,B]  339-21-361ms   | [S3,MB7,F]  364-14-379ms   | [S3,MB7,B]  385-21-406ms  
[rank3]:2025-11-28 23:35:35,962 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2335_stage3_step600.svg
[rank3]:2025-11-28 23:37:14,602 - INFO - Avg. fwd time: 14.2679 / Avg. bwd time: 27.5413 / Avg. batch time: 407.3700 (ms) / GPU bubble ratio: 17.89%
[rank0]:2025-11-28 23:37:14,664 - INFO - Avg. fwd time: 7.9990 / Avg. bwd time: 12.9702 / Avg. batch time: 502.8635 (ms) / GPU bubble ratio: 66.64%
[rank2]:2025-11-28 23:37:14,670 - INFO - Avg. fwd time: 7.6419 / Avg. bwd time: 16.6616 / Avg. batch time: 436.3054 (ms) / GPU bubble ratio: 55.44%
[rank1]:2025-11-28 23:37:14,707 - INFO - Avg. fwd time: 9.9826 / Avg. bwd time: 19.9125 / Avg. batch time: 472.4885 (ms) / GPU bubble ratio: 49.38%
[rank0]:2025-11-28 23:38:49,239 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 23:38:52,892 - INFO - Avg. fwd time: 14.2795 / Avg. bwd time: 27.3940 / Avg. batch time: 406.2716 (ms) / GPU bubble ratio: 17.94%
[rank2]:2025-11-28 23:38:52,961 - INFO - Avg. fwd time: 7.6446 / Avg. bwd time: 16.6462 / Avg. batch time: 435.1824 (ms) / GPU bubble ratio: 55.35%
[rank0]:2025-11-28 23:38:52,959 - INFO - Avg. fwd time: 8.0043 / Avg. bwd time: 12.8695 / Avg. batch time: 501.6906 (ms) / GPU bubble ratio: 66.71%
[rank1]:2025-11-28 23:38:53,003 - INFO - Avg. fwd time: 9.9872 / Avg. bwd time: 19.8815 / Avg. batch time: 471.3549 (ms) / GPU bubble ratio: 49.31%
[rank3]:2025-11-28 23:38:53,141 - INFO -  step: 650  loss:  0.2542  grad_norm:  0.0784  memory: 17.37GiB(36.56%)  tps: 8,301  tflops: 64.89  mfu: 20.80%
[rank2]:2025-11-28 23:38:53,146 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0784  memory:  6.51GiB(13.70%)  tps: 8,301  tflops: 64.89  mfu: 20.80%
[rank1]:2025-11-28 23:38:53,149 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0784  memory:  9.36GiB(19.71%)  tps: 8,301  tflops: 64.89  mfu: 20.80%
[rank0]:2025-11-28 23:38:53,160 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0784  memory: 13.29GiB(27.97%)  tps: 8,301  tflops: 64.89  mfu: 20.80%
[rank3]:2025-11-28 23:40:32,195 - INFO - Avg. fwd time: 14.2839 / Avg. bwd time: 27.2843 / Avg. batch time: 405.4185 (ms) / GPU bubble ratio: 17.97%
[rank2]:2025-11-28 23:40:32,224 - INFO - Avg. fwd time: 7.6466 / Avg. bwd time: 16.6319 / Avg. batch time: 434.3078 (ms) / GPU bubble ratio: 55.28%
[rank1]:2025-11-28 23:40:32,257 - INFO - Avg. fwd time: 9.9911 / Avg. bwd time: 19.8516 / Avg. batch time: 470.4635 (ms) / GPU bubble ratio: 49.25%
[rank0]:2025-11-28 23:40:32,286 - INFO - Avg. fwd time: 8.0085 / Avg. bwd time: 12.7709 / Avg. batch time: 500.7636 (ms) / GPU bubble ratio: 66.80%
[rank0]:2025-11-28 23:42:07,310 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:42:11,032 - INFO - Avg. fwd time: 14.2888 / Avg. bwd time: 27.1936 / Avg. batch time: 404.7224 (ms) / GPU bubble ratio: 18.00%
[rank2]:2025-11-28 23:42:11,099 - INFO - Avg. fwd time: 7.6484 / Avg. bwd time: 16.6205 / Avg. batch time: 433.5930 (ms) / GPU bubble ratio: 55.22%
[rank1]:2025-11-28 23:42:11,137 - INFO - Avg. fwd time: 9.9948 / Avg. bwd time: 19.8280 / Avg. batch time: 469.7343 (ms) / GPU bubble ratio: 49.21%
[rank0]:2025-11-28 23:42:11,093 - INFO - Avg. fwd time: 8.0121 / Avg. bwd time: 12.6959 / Avg. batch time: 500.0045 (ms) / GPU bubble ratio: 66.87%
[rank3]:2025-11-28 23:42:11,288 - INFO -  step: 700  loss:  0.2162  grad_norm:  0.1257  memory: 17.37GiB(36.56%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank2]:2025-11-28 23:42:11,279 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1257  memory:  6.51GiB(13.70%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank2]:2025-11-28 23:42:11,344 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2342_stage2_step700.svg
[rank1]:2025-11-28 23:42:11,283 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1257  memory:  9.36GiB(19.71%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank1]:2025-11-28 23:42:11,347 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2342_stage1_step700.svg
[rank0]:2025-11-28 23:42:11,294 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1257  memory: 13.29GiB(27.97%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank0]:2025-11-28 23:42:11,347 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2342_stage0_step700.svg
[rank3]:2025-11-28 23:42:11,430 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2342_real_step700_rank3.svg
[rank3]:			> Batch Time: 483.66 ms, GPU Bubble Ratio: 68.66%, 51.63%, 60.27%, 34.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  231-0-231ms    | [S0,MB6,F]  231-6-238ms    | [S0,MB3,B]  293-0-293ms    | [S0,MB7,F]  293-6-300ms    | [S0,MB4,B]  340-23-364ms   | [S0,MB5,B]  385-23-409ms   | [S0,MB6,B]  429-21-451ms   | [S0,MB7,B]  466-16-483ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-173ms    | [S1,MB2,B]  215-10-226ms   | [S1,MB5,F]  229-8-238ms    | [S1,MB3,B]  264-24-288ms   | [S1,MB6,F]  291-9-300ms    | [S1,MB4,B]  310-24-335ms   | [S1,MB7,F]  339-9-349ms    | [S1,MB5,B]  357-25-382ms   | [S1,MB6,B]  401-24-425ms   | [S1,MB7,B]  442-20-463ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  136-8-145ms    | [S2,MB3,F]  149-6-155ms    | [S2,MB2,B]  190-19-210ms   | [S2,MB4,F]  213-7-220ms    | [S2,MB3,B]  239-19-258ms   | [S2,MB5,F]  262-7-269ms    | [S2,MB4,B]  286-19-305ms   | [S2,MB6,F]  309-7-316ms    | [S2,MB5,B]  332-19-352ms   | [S2,MB7,F]  355-7-362ms    | [S2,MB6,B]  378-19-397ms   | [S2,MB7,B]  422-16-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-39-131ms    | [S3,MB2,F]  135-12-147ms   | [S3,MB2,B]  153-32-186ms   | [S3,MB3,F]  189-16-205ms   | [S3,MB3,B]  211-22-234ms   | [S3,MB4,F]  237-15-252ms   | [S3,MB4,B]  258-22-280ms   | [S3,MB5,F]  284-14-299ms   | [S3,MB5,B]  305-21-327ms   | [S3,MB6,F]  330-14-345ms   | [S3,MB6,B]  351-21-373ms   | [S3,MB7,F]  376-14-391ms   | [S3,MB7,B]  397-21-419ms  
[rank3]:2025-11-28 23:42:11,476 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2342_stage3_step700.svg
[rank3]:2025-11-28 23:43:50,142 - INFO - Avg. fwd time: 14.2913 / Avg. bwd time: 27.0976 / Avg. batch time: 403.9645 (ms) / GPU bubble ratio: 18.03%
[rank0]:2025-11-28 23:43:50,204 - INFO - Avg. fwd time: 8.0157 / Avg. bwd time: 12.6206 / Avg. batch time: 499.1928 (ms) / GPU bubble ratio: 66.93%
[rank2]:2025-11-28 23:43:50,212 - INFO - Avg. fwd time: 7.6502 / Avg. bwd time: 16.6082 / Avg. batch time: 432.8313 (ms) / GPU bubble ratio: 55.16%
[rank1]:2025-11-28 23:43:50,250 - INFO - Avg. fwd time: 9.9983 / Avg. bwd time: 19.8021 / Avg. batch time: 468.9542 (ms) / GPU bubble ratio: 49.16%
[rank0]:2025-11-28 23:45:25,899 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 23:45:29,783 - INFO - Avg. fwd time: 14.2960 / Avg. bwd time: 27.0169 / Avg. batch time: 403.3475 (ms) / GPU bubble ratio: 18.06%
[rank2]:2025-11-28 23:45:29,813 - INFO - Avg. fwd time: 7.6520 / Avg. bwd time: 16.5966 / Avg. batch time: 432.1954 (ms) / GPU bubble ratio: 55.12%
[rank3]:2025-11-28 23:45:29,895 - INFO -  step: 750  loss:  0.2572  grad_norm:  0.0979  memory: 17.37GiB(36.56%)  tps: 8,250  tflops: 64.49  mfu: 20.67%
[rank2]:2025-11-28 23:45:29,897 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0979  memory:  6.51GiB(13.70%)  tps: 8,249  tflops: 64.49  mfu: 20.67%
[rank1]:2025-11-28 23:45:29,846 - INFO - Avg. fwd time: 10.0017 / Avg. bwd time: 19.7775 / Avg. batch time: 468.3009 (ms) / GPU bubble ratio: 49.13%
[rank1]:2025-11-28 23:45:29,900 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0979  memory:  9.36GiB(19.71%)  tps: 8,249  tflops: 64.49  mfu: 20.67%
[rank0]:2025-11-28 23:45:29,875 - INFO - Avg. fwd time: 8.0191 / Avg. bwd time: 12.5493 / Avg. batch time: 498.5105 (ms) / GPU bubble ratio: 66.99%
[rank0]:2025-11-28 23:45:29,911 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0979  memory: 13.29GiB(27.97%)  tps: 8,249  tflops: 64.49  mfu: 20.67%
[rank3]:2025-11-28 23:47:08,292 - INFO - Avg. fwd time: 14.3003 / Avg. bwd time: 26.9374 / Avg. batch time: 402.7405 (ms) / GPU bubble ratio: 18.09%
[rank0]:2025-11-28 23:47:08,353 - INFO - Avg. fwd time: 8.0218 / Avg. bwd time: 12.4835 / Avg. batch time: 497.8495 (ms) / GPU bubble ratio: 67.05%
[rank2]:2025-11-28 23:47:08,360 - INFO - Avg. fwd time: 7.6534 / Avg. bwd time: 16.5872 / Avg. batch time: 431.5722 (ms) / GPU bubble ratio: 55.07%
[rank1]:2025-11-28 23:47:08,399 - INFO - Avg. fwd time: 10.0043 / Avg. bwd time: 19.7582 / Avg. batch time: 467.6648 (ms) / GPU bubble ratio: 49.09%
[rank0]:2025-11-28 23:48:43,116 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:48:46,918 - INFO - Avg. fwd time: 14.3042 / Avg. bwd time: 26.8474 / Avg. batch time: 402.0408 (ms) / GPU bubble ratio: 18.11%
[rank2]:2025-11-28 23:48:46,987 - INFO - Avg. fwd time: 7.6550 / Avg. bwd time: 16.5768 / Avg. batch time: 430.8550 (ms) / GPU bubble ratio: 55.01%
[rank0]:2025-11-28 23:48:46,982 - INFO - Avg. fwd time: 8.0249 / Avg. bwd time: 12.4191 / Avg. batch time: 497.0924 (ms) / GPU bubble ratio: 67.10%
[rank1]:2025-11-28 23:48:47,026 - INFO - Avg. fwd time: 10.0071 / Avg. bwd time: 19.7374 / Avg. batch time: 466.9350 (ms) / GPU bubble ratio: 49.04%
[rank3]:2025-11-28 23:48:47,178 - INFO -  step: 800  loss:  0.2612  grad_norm:  0.0702  memory: 17.37GiB(36.56%)  tps: 8,305  tflops: 64.92  mfu: 20.81%
[rank3]:2025-11-28 23:48:47,179 - INFO -  final step: 800  loss:  0.2612  grad_norm:  0.0702  tps: 8,421  tflops: 65.83  mfu: 19.39%
[rank3]:2025-11-28 23:48:47,179 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-28 23:48:47,180 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-28 23:48:47,170 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0702  memory:  6.51GiB(13.70%)  tps: 8,305  tflops: 64.93  mfu: 20.81%
[rank2]:2025-11-28 23:48:47,170 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0702  tps: 8,416  tflops: 65.79  mfu: 19.27%
[rank2]:2025-11-28 23:48:47,170 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 23:48:47,171 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-28 23:48:47,174 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0702  memory:  9.36GiB(19.71%)  tps: 8,305  tflops: 64.93  mfu: 20.81%
[rank1]:2025-11-28 23:48:47,174 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0702  tps: 8,417  tflops: 65.80  mfu: 19.31%
[rank1]:2025-11-28 23:48:47,174 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-28 23:48:47,175 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 23:48:47,185 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0702  memory: 13.29GiB(27.97%)  tps: 8,305  tflops: 64.93  mfu: 20.81%
[rank0]:2025-11-28 23:48:47,185 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0702  tps: 8,416  tflops: 65.79  mfu: 19.27%
[rank0]:2025-11-28 23:48:47,185 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 23:48:47,186 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 23:48:49,309 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-28 23:48:49,377 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank2/251128_2348_stage2_final800.svg
[rank1]:2025-11-28 23:48:49,378 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank1/251128_2348_stage1_final800.svg
[rank0]:2025-11-28 23:48:49,378 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank0/251128_2348_stage0_final800.svg
[rank3]:2025-11-28 23:48:49,458 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2348_real_final800_rank3.svg
[rank3]:			> Batch Time: 481.94 ms, GPU Bubble Ratio: 69.18%, 51.51%, 60.16%, 34.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-113ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-172ms    | [S0,MB2,B]  230-0-230ms    | [S0,MB6,F]  230-6-236ms    | [S0,MB3,B]  292-0-292ms    | [S0,MB7,F]  292-6-299ms    | [S0,MB4,B]  339-23-363ms   | [S0,MB5,B]  384-23-407ms   | [S0,MB6,B]  428-18-446ms   | [S0,MB7,B]  465-16-481ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-99ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  149-11-160ms   | [S1,MB4,F]  164-8-173ms    | [S1,MB2,B]  213-10-224ms   | [S1,MB5,F]  228-8-237ms    | [S1,MB3,B]  262-24-287ms   | [S1,MB6,F]  290-9-299ms    | [S1,MB4,B]  309-24-334ms   | [S1,MB7,F]  338-9-347ms    | [S1,MB5,B]  355-24-380ms   | [S1,MB6,B]  399-24-424ms   | [S1,MB7,B]  440-21-461ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-83ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  136-8-144ms    | [S2,MB3,F]  148-6-155ms    | [S2,MB2,B]  189-19-209ms   | [S2,MB4,F]  212-7-219ms    | [S2,MB3,B]  238-19-257ms   | [S2,MB5,F]  261-7-268ms    | [S2,MB4,B]  285-19-304ms   | [S2,MB6,F]  307-7-315ms    | [S2,MB5,B]  330-19-350ms   | [S2,MB7,F]  353-7-361ms    | [S2,MB6,B]  376-19-396ms   | [S2,MB7,B]  420-16-436ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-38-131ms    | [S3,MB2,F]  134-13-147ms   | [S3,MB2,B]  153-32-185ms   | [S3,MB3,F]  188-15-203ms   | [S3,MB3,B]  210-22-233ms   | [S3,MB4,F]  236-14-251ms   | [S3,MB4,B]  257-21-279ms   | [S3,MB5,F]  283-14-298ms   | [S3,MB5,B]  304-21-326ms   | [S3,MB6,F]  329-14-344ms   | [S3,MB6,B]  349-21-371ms   | [S3,MB7,F]  375-14-389ms   | [S3,MB7,B]  395-21-417ms  
[rank3]:2025-11-28 23:48:49,588 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/pipeline_schedule/251128_2348_thry_final800_rank3.svg
[rank3]:			> Batch Time: 331.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB0,B]  100-20-120ms   | [S0,MB4,F]  120-10-130ms   | [S0,MB1,B]  130-20-150ms   | [S0,MB5,F]  150-10-160ms   | [S0,MB2,B]  160-20-180ms   | [S0,MB6,F]  180-10-190ms   | [S0,MB3,B]  190-20-210ms   | [S0,MB7,F]  210-10-220ms   | [S0,MB4,B]  220-20-240ms   | [S0,MB5,B]  250-20-270ms   | [S0,MB6,B]  280-20-301ms   | [S0,MB7,B]  311-20-331ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB0,B]  80-20-100ms    | [S1,MB3,F]  100-10-110ms   | [S1,MB1,B]  110-20-130ms   | [S1,MB4,F]  130-10-140ms   | [S1,MB2,B]  140-20-160ms   | [S1,MB5,F]  160-10-170ms   | [S1,MB3,B]  170-20-190ms   | [S1,MB6,F]  190-10-200ms   | [S1,MB4,B]  200-20-220ms   | [S1,MB7,F]  220-10-230ms   | [S1,MB5,B]  230-20-250ms   | [S1,MB6,B]  260-20-280ms   | [S1,MB7,B]  290-20-311ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB0,B]  60-20-80ms     | [S2,MB2,F]  80-10-90ms     | [S2,MB1,B]  90-20-110ms    | [S2,MB3,F]  110-10-120ms   | [S2,MB2,B]  120-20-140ms   | [S2,MB4,F]  140-10-150ms   | [S2,MB3,B]  150-20-170ms   | [S2,MB5,F]  170-10-180ms   | [S2,MB4,B]  180-20-200ms   | [S2,MB6,F]  200-10-210ms   | [S2,MB5,B]  210-20-230ms   | [S2,MB7,F]  230-10-240ms   | [S2,MB6,B]  240-20-260ms   | [S2,MB7,B]  270-20-290ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB0,B]  40-20-60ms     | [S3,MB1,F]  60-10-70ms     | [S3,MB1,B]  70-20-90ms     | [S3,MB2,F]  90-10-100ms    | [S3,MB2,B]  100-20-120ms   | [S3,MB3,F]  120-10-130ms   | [S3,MB3,B]  130-20-150ms   | [S3,MB4,F]  150-10-160ms   | [S3,MB4,B]  160-20-180ms   | [S3,MB5,F]  180-10-190ms   | [S3,MB5,B]  190-20-210ms   | [S3,MB6,F]  210-10-220ms   | [S3,MB6,B]  220-20-240ms   | [S3,MB7,F]  240-10-250ms   | [S3,MB7,B]  250-20-270ms  
[rank2]:2025-11-28 23:48:49,531 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251128_2348_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank2]:2025-11-28 23:48:49,532 - INFO - Destroying the purge thread.
[rank1]:2025-11-28 23:48:49,530 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251128_2348_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank1]:2025-11-28 23:48:49,530 - INFO - Destroying the purge thread.
[rank0]:2025-11-28 23:48:49,538 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251128_2348_rank0_stage0.svg
[rank0]:	> Counts Sum: 321360, Total Sum: 1728640 (18.59%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.2, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.29, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank0]:2025-11-28 23:48:49,539 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-28 23:48:49,635 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_ratio_history/rank3/251128_2348_stage3_final800.svg
[rank3]:2025-11-28 23:48:49,766 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1/frozen_params_histogram/251128_2348_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [75.85, 75.34, 74.14, 75.68, 76.19, 76.19, 74.31, 74.48, 75.34, 74.82, 76.54, 74.48, 77.22, 74.48, 75.68, 74.82, 77.05, 76.36, 75.0, 74.48, 77.05, 75.68, 74.31, 76.71, 76.88, 74.31, 75.68, 74.82, 76.54]
[rank3]:2025-11-28 23:48:49,767 - INFO - Destroying the purge thread.
[rank2]:2025-11-28 23:48:49,739 - INFO - Process group destroyed
[rank1]:2025-11-28 23:48:49,723 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 313-335
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.89116
[rank3]:wandb:               final/avg_loss 0.26118
[rank3]:wandb:             final/avg_mfu(%) 19.38966
[rank3]:wandb:             final/avg_tflops 65.83254
[rank3]:wandb:    final/avg_throughput(tps) 8421.1323
[rank3]:wandb:              final/grad_norm 0.07024
[rank3]:wandb:               final/max_loss 0.26118
[rank3]:wandb:                    grad_norm 0.07024
[rank3]:wandb: loss_metrics/global_avg_loss 0.26118
[rank3]:wandb: loss_metrics/global_max_loss 0.26118
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.8_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/goqi6nte
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.8_42_dm1/20251128-2253/wandb/run-20251128_225338-goqi6nte/logs
[rank3]:2025-11-28 23:48:51,247 - INFO - Process group destroyed
[rank0]:2025-11-28 23:48:51,539 - INFO - Training completed
[rank0]:2025-11-28 23:48:51,539 - INFO - Destroying the purge thread.
[rank0]:2025-11-28 23:48:51,785 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'layers.1', 'tok_embeddings', 'layers.3'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.9', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.7', 'layers.4', 'layers.5'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'layers.13', 'layers.14', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.8_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
