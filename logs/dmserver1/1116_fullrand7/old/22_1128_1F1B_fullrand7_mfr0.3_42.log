
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 30. (ì¼) 19:44:15 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.3_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.3) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.3
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-30 19:44:21,604 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank1]:2025-11-30 19:44:21,781 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-30 19:44:21,783 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-30 19:44:21,786 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank3]:2025-11-30 19:44:21,859 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-30 19:44:21,888 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-11-30 19:44:21,902 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-11-30 19:44:22,049 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-30 19:44:22,052 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-30 19:44:22,054 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-30 19:44:22,118 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-30 19:44:22,121 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-30 19:44:22,124 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-30 19:44:22,124 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-30 19:44:22,125 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-11-30 19:44:22,144 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-30 19:44:22,147 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-30 19:44:22,150 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-30 19:44:22,503 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-11-30 19:44:25,115 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-30 19:44:25,153 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-30 19:44:25,181 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-30 19:44:25,181 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-30 19:44:25,281 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-30 19:44:25,366 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-30 19:44:25,366 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-30 19:44:25,366 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-30 19:44:25,432 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-30 19:44:25,470 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-30 19:44:25,471 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-30 19:44:25,497 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-30 19:44:25,497 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-30 19:44:25,530 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-30 19:44:25,568 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-30 19:44:25,595 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-30 19:44:25,596 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-30 19:44:25,701 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-30 19:44:25,701 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-30 19:44:25,701 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-30 19:44:25,779 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-30 19:44:25,779 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-30 19:44:25,780 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run tiihpjd3
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.3_42_dm1/20251130-1944/wandb/run-20251130_194426-tiihpjd3
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/tiihpjd3
[rank3]:2025-11-30 19:44:27,610 - INFO - WandB logging enabled
[rank3]:2025-11-30 19:44:27,611 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-30 19:44:27,651 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-30 19:44:27,680 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-30 19:44:27,681 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-30 19:44:27,890 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank0]:2025-11-30 19:44:27,890 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-30 19:44:27,891 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-30 19:44:27,891 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1.
[rank0]:2025-11-30 19:44:27,891 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1/step-800.
[rank3]:2025-11-30 19:44:27,872 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-30 19:44:27,873 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-30 19:44:27,874 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-30 19:44:27,890 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-30 19:44:27,891 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1.
[rank2]:2025-11-30 19:44:27,895 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-30 19:44:27,897 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1.
[rank1]:2025-11-30 19:44:27,890 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-30 19:44:27,891 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1.
[rank0]:2025-11-30 19:44:30,157 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-30 19:44:30,158 - INFO - Finished loading the checkpoint in 2.27 seconds.
[rank0]:2025-11-30 19:44:30,158 - INFO - Training starts at step 1
[rank2]:2025-11-30 19:44:35,921 - INFO -  step:  1  loss: -8.0000  grad_norm:  0.0834  memory:  4.59GiB(9.67%)  tps: 3,165  tflops: 24.74  mfu: 7.93%
[rank2]:2025-11-30 19:44:35,921 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-30 19:44:35,957 - INFO -  step:  1  loss: -8.0000  grad_norm:  0.0834  memory:  9.17GiB(19.29%)  tps: 3,125  tflops: 24.43  mfu: 7.83%
[rank0]:2025-11-30 19:44:35,958 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-30 19:44:35,931 - INFO -  step:  1  loss:  0.2057  grad_norm:  0.0834  memory: 12.97GiB(27.31%)  tps: 3,959  tflops: 30.95  mfu: 9.92%
[rank3]:2025-11-30 19:44:35,932 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-30 19:44:35,937 - INFO -  step:  1  loss: -8.0000  grad_norm:  0.0834  memory:  6.72GiB(14.15%)  tps: 3,039  tflops: 23.76  mfu: 7.61%
[rank1]:2025-11-30 19:44:35,937 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-30 19:46:42,061 - INFO - Avg. fwd time: 7.3896 / Avg. bwd time: 19.8428 / Avg. batch time: 560.9264 (ms) / GPU bubble ratio: 61.16%
[rank1]:2025-11-30 19:46:42,090 - INFO - Avg. fwd time: 9.4924 / Avg. bwd time: 24.9764 / Avg. batch time: 601.3984 (ms) / GPU bubble ratio: 54.15%
[rank3]:2025-11-30 19:46:42,030 - INFO - Avg. fwd time: 12.5945 / Avg. bwd time: 43.1190 / Avg. batch time: 527.6836 (ms) / GPU bubble ratio: 15.53%
[rank0]:2025-11-30 19:46:42,104 - INFO - Avg. fwd time: 7.6996 / Avg. bwd time: 25.5895 / Avg. batch time: 640.9838 (ms) / GPU bubble ratio: 58.45%
[rank0]:2025-11-30 19:48:50,496 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-30 19:48:55,625 - INFO - Avg. fwd time: 7.4185 / Avg. bwd time: 19.9108 / Avg. batch time: 567.0120 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-11-30 19:48:55,654 - INFO - Avg. fwd time: 9.5518 / Avg. bwd time: 25.1128 / Avg. batch time: 607.1650 (ms) / GPU bubble ratio: 54.33%
[rank0]:2025-11-30 19:48:55,668 - INFO - Avg. fwd time: 7.7292 / Avg. bwd time: 25.6564 / Avg. batch time: 646.3401 (ms) / GPU bubble ratio: 58.68%
[rank3]:2025-11-30 19:48:55,593 - INFO - Avg. fwd time: 12.8909 / Avg. bwd time: 43.6480 / Avg. batch time: 534.1417 (ms) / GPU bubble ratio: 15.32%
[rank2]:2025-11-30 19:48:55,836 - INFO -  step: 50  loss: -8.0000  grad_norm:  0.1166  memory:  6.39GiB(13.45%)  tps: 6,178  tflops: 48.29  mfu: 15.48%
[rank1]:2025-11-30 19:48:55,839 - INFO -  step: 50  loss: -8.0000  grad_norm:  0.1166  memory:  8.99GiB(18.92%)  tps: 6,178  tflops: 48.30  mfu: 15.48%
[rank0]:2025-11-30 19:48:55,850 - INFO -  step: 50  loss: -8.0000  grad_norm:  0.1166  memory: 12.97GiB(27.31%)  tps: 6,178  tflops: 48.30  mfu: 15.48%
[rank3]:2025-11-30 19:48:55,848 - INFO -  step: 50  loss:  0.2228  grad_norm:  0.1166  memory: 16.39GiB(34.50%)  tps: 6,178  tflops: 48.29  mfu: 15.48%
[rank3]:2025-11-30 19:49:49,276 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-30 19:50:42,746 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-30 19:50:43,005 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-30 19:51:01,135 - INFO - Avg. fwd time: 13.1179 / Avg. bwd time: 42.4037 / Avg. batch time: 525.9528 (ms) / GPU bubble ratio: 15.55%
[rank1]:2025-11-30 19:51:01,168 - INFO - Avg. fwd time: 9.6858 / Avg. bwd time: 24.2784 / Avg. batch time: 597.1748 (ms) / GPU bubble ratio: 54.50%
[rank2]:2025-11-30 19:51:01,150 - INFO - Avg. fwd time: 7.5362 / Avg. bwd time: 19.2322 / Avg. batch time: 558.0011 (ms) / GPU bubble ratio: 61.62%
[rank0]:2025-11-30 19:51:01,174 - INFO - Avg. fwd time: 7.8320 / Avg. bwd time: 23.9824 / Avg. batch time: 634.4930 (ms) / GPU bubble ratio: 59.89%
[rank3]:2025-11-30 19:51:19,273 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-30 19:51:19,479 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251130_1951_max_batch_time.svg
[rank3]:			> Batch Time: 559.19 ms, GPU Bubble Ratio: 51.99%, 50.10%, 60.70%, 18.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  133-26-159ms   | [S0,MB4,F]  159-6-166ms    | [S0,MB1,B]  187-25-213ms   | [S0,MB5,F]  213-7-220ms    | [S0,MB2,B]  243-25-269ms   | [S0,MB6,F]  269-7-276ms    | [S0,MB3,B]  300-25-326ms   | [S0,MB7,F]  326-7-333ms    | [S0,MB4,B]  359-25-384ms   | [S0,MB5,B]  417-25-442ms   | [S0,MB6,B]  474-25-500ms   | [S0,MB7,B]  533-25-559ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-133ms   | [S1,MB3,F]  133-9-142ms    | [S1,MB1,B]  161-25-187ms   | [S1,MB4,F]  187-9-196ms    | [S1,MB2,B]  218-25-243ms   | [S1,MB5,F]  243-9-252ms    | [S1,MB3,B]  275-25-300ms   | [S1,MB6,F]  300-9-310ms    | [S1,MB4,B]  333-25-359ms   | [S1,MB7,F]  359-9-368ms    | [S1,MB5,B]  391-25-417ms   | [S1,MB6,B]  449-25-474ms   | [S1,MB7,B]  508-25-533ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-20-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  255-20-275ms   | [S2,MB5,F]  275-7-282ms    | [S2,MB4,B]  313-20-333ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  371-20-391ms   | [S2,MB7,F]  391-7-398ms    | [S2,MB6,B]  429-19-449ms   | [S2,MB7,B]  488-20-508ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-10-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-44-198ms   AFR(10):0.9655 | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB4,F]  255-13-269ms   | [S3,MB4,B]  269-44-313ms   AFR(10):0.9655 | [S3,MB5,F]  313-13-326ms   | [S3,MB5,B]  326-44-371ms   AFR(10):0.9655 | [S3,MB6,F]  371-13-385ms   | [S3,MB6,B]  385-44-429ms   AFR(10):0.9655 | [S3,MB7,F]  429-13-443ms   | [S3,MB7,B]  443-45-488ms   AFR(10):0.9655
[rank3]:2025-11-30 19:51:19,610 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251130_1951_min_batch_time.svg
[rank3]:			> Batch Time: 337.11 ms, GPU Bubble Ratio: 81.70%, 49.26%, 60.26%, 15.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  88-0-88ms      | [S0,MB4,F]  88-6-95ms      | [S0,MB1,B]  121-0-121ms    | [S0,MB5,F]  121-7-128ms    | [S0,MB2,B]  156-0-156ms    | [S0,MB6,F]  156-7-163ms    | [S0,MB3,B]  192-0-192ms    | [S0,MB7,F]  192-7-199ms    | [S0,MB4,B]  228-0-228ms    | [S0,MB5,B]  264-0-264ms    | [S0,MB6,B]  301-0-301ms    | [S0,MB7,B]  337-0-337ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  76-11-88ms     | [S1,MB3,F]  88-9-97ms      | [S1,MB1,B]  109-11-121ms   | [S1,MB4,F]  121-9-131ms    | [S1,MB2,B]  144-11-156ms   | [S1,MB5,F]  156-9-165ms    | [S1,MB3,B]  180-11-192ms   | [S1,MB6,F]  192-9-201ms    | [S1,MB4,B]  216-11-228ms   | [S1,MB7,F]  228-9-237ms    | [S1,MB5,B]  252-11-264ms   | [S1,MB6,B]  289-11-301ms   | [S1,MB7,B]  325-11-337ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  67-9-76ms      | [S2,MB2,F]  76-7-83ms      | [S2,MB1,B]  100-9-109ms    | [S2,MB3,F]  109-7-116ms    | [S2,MB2,B]  135-9-144ms    | [S2,MB4,F]  144-7-151ms    | [S2,MB3,B]  171-9-180ms    | [S2,MB5,F]  180-7-187ms    | [S2,MB4,B]  207-9-216ms    | [S2,MB6,F]  216-7-223ms    | [S2,MB5,B]  243-9-252ms    | [S2,MB7,F]  252-7-260ms    | [S2,MB6,B]  279-9-289ms    | [S2,MB7,B]  316-9-325ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-22-67ms     AFR(10):0.9655 | [S3,MB1,F]  67-10-78ms     | [S3,MB1,B]  78-22-100ms    AFR(10):0.9655 | [S3,MB2,F]  100-12-112ms   | [S3,MB2,B]  112-22-135ms   AFR(10):0.9655 | [S3,MB3,F]  135-13-148ms   | [S3,MB3,B]  148-22-171ms   AFR(10):0.9655 | [S3,MB4,F]  171-13-184ms   | [S3,MB4,B]  184-22-207ms   AFR(10):0.9655 | [S3,MB5,F]  207-13-220ms   | [S3,MB5,B]  220-23-243ms   AFR(10):0.9655 | [S3,MB6,F]  243-13-257ms   | [S3,MB6,B]  257-22-279ms   AFR(10):0.9655 | [S3,MB7,F]  279-13-293ms   | [S3,MB7,B]  293-22-316ms   AFR(10):0.9655
[rank3]:2025-11-30 19:51:36,078 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251130_1951_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 456.20 ms, GPU Bubble Ratio: 49.83%, 41.78%, 54.17%, 11.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  133-26-159ms   | [S0,MB4,F]  159-6-166ms    | [S0,MB1,B]  187-25-213ms   | [S0,MB5,F]  213-7-220ms    | [S0,MB2,B]  243-25-269ms   | [S0,MB6,F]  269-7-276ms    | [S0,MB3,B]  300-25-326ms   | [S0,MB7,F]  326-7-333ms    | [S0,MB4,B]  337-25-362ms   | [S0,MB5,B]  394-25-420ms   | [S0,MB6,B]  444-11-456ms   | [S0,MB7,B]  456-0-456ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-133ms   | [S1,MB3,F]  133-9-142ms    | [S1,MB1,B]  161-25-187ms   | [S1,MB4,F]  187-9-196ms    | [S1,MB2,B]  218-25-243ms   | [S1,MB5,F]  243-9-252ms    | [S1,MB3,B]  275-25-300ms   | [S1,MB6,F]  300-9-310ms    | [S1,MB4,B]  311-25-337ms   | [S1,MB7,F]  337-9-346ms    | [S1,MB5,B]  369-25-394ms   | [S1,MB6,B]  419-25-444ms   | [S1,MB7,B]  444-11-456ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-20-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  198-19-218ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  255-20-275ms   | [S2,MB5,F]  275-7-282ms    | [S2,MB4,B]  291-20-311ms   | [S2,MB6,F]  311-7-318ms    | [S2,MB5,B]  349-19-369ms   | [S2,MB7,F]  369-7-376ms    | [S2,MB6,B]  399-19-419ms   | [S2,MB7,B]  435-9-444ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-10-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-44-198ms   AFR(10):0.9655 | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB4,F]  255-13-269ms   | [S3,MB4,B]  269-22-291ms   AFR(10):0.9655 | [S3,MB5,F]  291-13-304ms   | [S3,MB5,B]  304-44-349ms   AFR(10):0.9655 | [S3,MB6,F]  349-13-363ms   | [S3,MB6,B]  363-35-399ms   AFR(10):0.9655 | [S3,MB7,F]  399-13-412ms   | [S3,MB7,B]  412-22-435ms   AFR(10):0.9655
[rank3]:2025-11-30 19:51:36,078 - INFO - 	> Batch Time: 456.20 ms (Average Freeze Ratio: 0.19, Time Reduction Rate: 0.18)
[rank0]:2025-11-30 19:53:11,554 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-30 19:53:16,520 - INFO - Avg. fwd time: 13.2821 / Avg. bwd time: 40.8021 / Avg. batch time: 514.6532 (ms) / GPU bubble ratio: 15.93%
[rank1]:2025-11-30 19:53:16,580 - INFO - Avg. fwd time: 9.8377 / Avg. bwd time: 23.1487 / Avg. batch time: 585.2230 (ms) / GPU bubble ratio: 54.91%
[rank0]:2025-11-30 19:53:16,592 - INFO - Avg. fwd time: 7.9884 / Avg. bwd time: 21.1618 / Avg. batch time: 620.9988 (ms) / GPU bubble ratio: 62.45%
[rank2]:2025-11-30 19:53:16,551 - INFO - Avg. fwd time: 7.6548 / Avg. bwd time: 18.4839 / Avg. batch time: 545.8690 (ms) / GPU bubble ratio: 61.69%
[rank3]:2025-11-30 19:53:16,534 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.10(0.13)/0.40, [MB7] 0.28(0.33)/1.00
[rank2]:2025-11-30 19:53:16,690 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-11-30 19:53:16,717 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-11-30 19:53:16,758 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.1018  memory:  9.36GiB(19.71%)  tps: 6,279  tflops: 49.09  mfu: 15.73%
[rank0]:2025-11-30 19:53:16,740 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.18)/0.54, [MB7] 0.27(0.33)/1.00
[rank0]:2025-11-30 19:53:16,769 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.1018  memory: 12.97GiB(27.31%)  tps: 6,279  tflops: 49.09  mfu: 15.73%
[rank2]:2025-11-30 19:53:16,755 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.1018  memory:  6.51GiB(13.70%)  tps: 6,279  tflops: 49.09  mfu: 15.73%
[rank3]:2025-11-30 19:53:16,767 - INFO -  step: 100  loss:  0.2077  grad_norm:  0.1018  memory: 16.88GiB(35.53%)  tps: 6,279  tflops: 49.09  mfu: 15.73%
[rank1]:2025-11-30 19:53:16,827 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251130_1953_stage1_step100.svg
[rank0]:2025-11-30 19:53:16,828 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251130_1953_stage0_step100.svg
[rank2]:2025-11-30 19:53:16,827 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251130_1953_stage2_step100.svg
[rank3]:2025-11-30 19:53:16,910 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251130_1953_real_step100_rank3.svg
[rank3]:			> Batch Time: 637.30 ms, GPU Bubble Ratio: 64.38%, 57.58%, 66.34%, 29.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  145-17-163ms   | [S0,MB4,F]  163-7-170ms    | [S0,MB1,B]  211-17-228ms   | [S0,MB5,F]  228-6-235ms    | [S0,MB2,B]  281-17-298ms   | [S0,MB6,F]  298-6-305ms    | [S0,MB3,B]  352-17-369ms   | [S0,MB7,F]  370-6-376ms    | [S0,MB4,B]  421-25-446ms   | [S0,MB5,B]  484-25-510ms   | [S0,MB6,B]  550-21-572ms   | [S0,MB7,B]  616-21-637ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  118-22-140ms   | [S1,MB3,F]  144-9-154ms    | [S1,MB1,B]  183-22-205ms   | [S1,MB4,F]  209-9-218ms    | [S1,MB2,B]  254-22-276ms   | [S1,MB5,F]  279-9-289ms    | [S1,MB3,B]  322-25-347ms   | [S1,MB6,F]  351-9-360ms    | [S1,MB4,B]  390-25-415ms   | [S1,MB7,F]  419-9-428ms    | [S1,MB5,B]  455-25-480ms   | [S1,MB6,B]  522-25-547ms   | [S1,MB7,B]  588-24-612ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  95-17-113ms    | [S2,MB2,F]  116-7-124ms    | [S2,MB1,B]  161-17-178ms   | [S2,MB3,F]  181-7-188ms    | [S2,MB2,B]  228-20-249ms   | [S2,MB4,F]  252-7-259ms    | [S2,MB3,B]  297-20-317ms   | [S2,MB5,F]  320-7-328ms    | [S2,MB4,B]  365-20-385ms   | [S2,MB6,F]  389-7-396ms    | [S2,MB5,B]  430-20-450ms   | [S2,MB7,F]  454-7-461ms    | [S2,MB6,B]  498-20-518ms   | [S2,MB7,B]  565-19-584ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-38-90ms     | [S3,MB1,F]  94-11-105ms    | [S3,MB1,B]  112-43-156ms   | [S3,MB2,F]  159-13-172ms   | [S3,MB2,B]  179-44-224ms   | [S3,MB3,F]  227-12-240ms   | [S3,MB3,B]  247-44-291ms   | [S3,MB4,F]  295-13-309ms   | [S3,MB4,B]  316-44-360ms   | [S3,MB5,F]  364-13-377ms   | [S3,MB5,B]  384-40-425ms   | [S3,MB6,F]  429-13-442ms   | [S3,MB6,B]  449-44-494ms   | [S3,MB7,F]  497-13-511ms   | [S3,MB7,B]  518-42-560ms  
[rank3]:2025-11-30 19:53:16,952 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251130_1953_stage3_step100.svg
[rank3]:2025-11-30 19:55:23,965 - INFO - Avg. fwd time: 13.3384 / Avg. bwd time: 40.7193 / Avg. batch time: 514.4020 (ms) / GPU bubble ratio: 15.93%
[rank1]:2025-11-30 19:55:24,029 - INFO - Avg. fwd time: 9.8241 / Avg. bwd time: 23.2236 / Avg. batch time: 585.0183 (ms) / GPU bubble ratio: 54.81%
[rank0]:2025-11-30 19:55:24,041 - INFO - Avg. fwd time: 7.9943 / Avg. bwd time: 21.2731 / Avg. batch time: 620.7872 (ms) / GPU bubble ratio: 62.28%
[rank2]:2025-11-30 19:55:23,999 - INFO - Avg. fwd time: 7.6412 / Avg. bwd time: 18.6052 / Avg. batch time: 545.7773 (ms) / GPU bubble ratio: 61.53%
[rank0]:2025-11-30 19:57:26,700 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-30 19:57:31,603 - INFO - Avg. fwd time: 7.6576 / Avg. bwd time: 18.5209 / Avg. batch time: 546.2058 (ms) / GPU bubble ratio: 61.66%
[rank2]:2025-11-30 19:57:31,610 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank3]:2025-11-30 19:57:31,578 - INFO - Avg. fwd time: 13.3777 / Avg. bwd time: 40.7395 / Avg. batch time: 514.9637 (ms) / GPU bubble ratio: 15.93%
[rank3]:2025-11-30 19:57:31,582 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.24(0.27)/0.40, [MB7] 0.59(0.67)/1.00
[rank1]:2025-11-30 19:57:31,633 - INFO - Avg. fwd time: 9.8515 / Avg. bwd time: 23.0217 / Avg. batch time: 585.1987 (ms) / GPU bubble ratio: 55.06%
[rank1]:2025-11-30 19:57:31,640 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank0]:2025-11-30 19:57:31,663 - INFO - Avg. fwd time: 8.0423 / Avg. bwd time: 21.0156 / Avg. batch time: 620.7943 (ms) / GPU bubble ratio: 62.55%
[rank0]:2025-11-30 19:57:31,671 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.36)/0.54, [MB7] 0.59(0.67)/1.00
[rank0]:2025-11-30 19:57:31,699 - INFO -  step: 150  loss: -8.0000  grad_norm:  0.0553  memory: 13.29GiB(27.97%)  tps: 6,427  tflops: 50.24  mfu: 16.10%
[rank2]:2025-11-30 19:57:31,685 - INFO -  step: 150  loss: -8.0000  grad_norm:  0.0553  memory:  6.51GiB(13.70%)  tps: 6,427  tflops: 50.24  mfu: 16.10%
[rank3]:2025-11-30 19:57:31,697 - INFO -  step: 150  loss:  0.2168  grad_norm:  0.0553  memory: 16.88GiB(35.53%)  tps: 6,427  tflops: 50.24  mfu: 16.10%
[rank1]:2025-11-30 19:57:31,688 - INFO -  step: 150  loss: -8.0000  grad_norm:  0.0553  memory:  9.36GiB(19.71%)  tps: 6,427  tflops: 50.24  mfu: 16.10%
[rank3]:2025-11-30 19:59:33,921 - INFO - Avg. fwd time: 13.4368 / Avg. bwd time: 40.3447 / Avg. batch time: 512.3395 (ms) / GPU bubble ratio: 16.02%
[rank2]:2025-11-30 19:59:33,947 - INFO - Avg. fwd time: 7.6683 / Avg. bwd time: 18.4800 / Avg. batch time: 543.5058 (ms) / GPU bubble ratio: 61.51%
[rank0]:2025-11-30 19:59:33,988 - INFO - Avg. fwd time: 8.0809 / Avg. bwd time: 20.5813 / Avg. batch time: 617.5557 (ms) / GPU bubble ratio: 62.87%
[rank1]:2025-11-30 19:59:33,976 - INFO - Avg. fwd time: 9.8829 / Avg. bwd time: 22.7987 / Avg. batch time: 582.2968 (ms) / GPU bubble ratio: 55.10%
[rank0]:2025-11-30 20:01:30,343 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-30 20:01:35,044 - INFO - Avg. fwd time: 7.6968 / Avg. bwd time: 18.3192 / Avg. batch time: 540.2074 (ms) / GPU bubble ratio: 61.47%
[rank1]:2025-11-30 20:01:35,072 - INFO - Avg. fwd time: 9.9296 / Avg. bwd time: 22.4777 / Avg. batch time: 578.7375 (ms) / GPU bubble ratio: 55.20%
[rank3]:2025-11-30 20:01:35,017 - INFO - Avg. fwd time: 13.5010 / Avg. bwd time: 39.8628 / Avg. batch time: 509.2298 (ms) / GPU bubble ratio: 16.17%
[rank3]:2025-11-30 20:01:35,026 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.38(0.40)/0.40, [MB7] 0.93(1.00)/1.00
[rank0]:2025-11-30 20:01:35,085 - INFO - Avg. fwd time: 8.1483 / Avg. bwd time: 19.8911 / Avg. batch time: 613.6054 (ms) / GPU bubble ratio: 63.44%
[rank2]:2025-11-30 20:01:35,171 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank2]:2025-11-30 20:01:35,231 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0934  memory:  6.51GiB(13.70%)  tps: 6,727  tflops: 52.59  mfu: 16.86%
[rank0]:2025-11-30 20:01:35,217 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.54)/0.54, [MB7] 0.95(1.00)/1.00
[rank0]:2025-11-30 20:01:35,245 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0934  memory: 13.29GiB(27.97%)  tps: 6,727  tflops: 52.59  mfu: 16.86%
[rank1]:2025-11-30 20:01:35,195 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-11-30 20:01:35,235 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0934  memory:  9.36GiB(19.71%)  tps: 6,727  tflops: 52.59  mfu: 16.86%
[rank3]:2025-11-30 20:01:35,243 - INFO -  step: 200  loss:  0.1964  grad_norm:  0.0934  memory: 17.37GiB(36.56%)  tps: 6,727  tflops: 52.59  mfu: 16.86%
[rank2]:2025-11-30 20:01:35,296 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251130_2001_stage2_step200.svg
[rank0]:2025-11-30 20:01:35,295 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251130_2001_stage0_step200.svg
[rank1]:2025-11-30 20:01:35,296 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251130_2001_stage1_step200.svg
[rank3]:2025-11-30 20:01:35,384 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251130_2001_real_step200_rank3.svg
[rank3]:			> Batch Time: 587.12 ms, GPU Bubble Ratio: 69.07%, 58.06%, 66.01%, 30.91%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-10-39ms     | [S0,MB0,B]  111-5-116ms    | [S0,MB4,F]  116-8-125ms    | [S0,MB1,B]  180-5-185ms    | [S0,MB5,F]  185-6-192ms    | [S0,MB2,B]  256-5-261ms    | [S0,MB6,F]  261-6-268ms    | [S0,MB3,B]  335-5-341ms    | [S0,MB7,F]  341-6-347ms    | [S0,MB4,B]  401-26-427ms   | [S0,MB5,B]  451-25-476ms   | [S0,MB6,B]  514-20-534ms   | [S0,MB7,B]  568-19-587ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  93-13-106ms    | [S1,MB3,F]  110-11-121ms   | [S1,MB1,B]  161-13-174ms   | [S1,MB4,F]  178-8-187ms    | [S1,MB2,B]  237-13-251ms   | [S1,MB5,F]  254-8-263ms    | [S1,MB3,B]  304-25-330ms   | [S1,MB6,F]  333-9-343ms    | [S1,MB4,B]  368-25-394ms   | [S1,MB7,F]  399-9-409ms    | [S1,MB5,B]  421-25-447ms   | [S1,MB6,B]  485-25-510ms   | [S1,MB7,B]  542-22-564ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  212-20-232ms   | [S2,MB4,F]  235-7-243ms    | [S2,MB3,B]  280-20-300ms   | [S2,MB5,F]  303-7-310ms    | [S2,MB4,B]  343-20-363ms   | [S2,MB6,F]  367-7-374ms    | [S2,MB5,B]  396-20-416ms   | [S2,MB7,F]  420-7-427ms    | [S2,MB6,B]  462-20-482ms   | [S2,MB7,B]  522-17-539ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-43-207ms   | [S3,MB3,F]  210-13-224ms   | [S3,MB3,B]  231-43-274ms   | [S3,MB4,F]  278-13-292ms   | [S3,MB4,B]  299-38-338ms   | [S3,MB5,F]  341-17-359ms   | [S3,MB5,B]  366-23-390ms   | [S3,MB6,F]  395-11-406ms   | [S3,MB6,B]  413-43-457ms   | [S3,MB7,F]  460-13-474ms   | [S3,MB7,B]  481-37-519ms  
[rank3]:2025-11-30 20:01:35,429 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251130_2001_stage3_step200.svg
[rank3]:2025-11-30 20:03:35,647 - INFO - Avg. fwd time: 13.5714 / Avg. bwd time: 39.4336 / Avg. batch time: 506.5663 (ms) / GPU bubble ratio: 16.29%
[rank2]:2025-11-30 20:03:35,673 - INFO - Avg. fwd time: 7.7246 / Avg. bwd time: 18.1656 / Avg. batch time: 537.4334 (ms) / GPU bubble ratio: 61.46%
[rank0]:2025-11-30 20:03:35,728 - INFO - Avg. fwd time: 8.2066 / Avg. bwd time: 18.9268 / Avg. batch time: 610.2327 (ms) / GPU bubble ratio: 64.43%
[rank1]:2025-11-30 20:03:35,702 - INFO - Avg. fwd time: 9.9754 / Avg. bwd time: 22.1669 / Avg. batch time: 575.7282 (ms) / GPU bubble ratio: 55.34%
[rank0]:2025-11-30 20:05:31,189 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-30 20:05:35,732 - INFO - Avg. fwd time: 13.6123 / Avg. bwd time: 39.1447 / Avg. batch time: 504.7244 (ms) / GPU bubble ratio: 16.38%
[rank3]:2025-11-30 20:05:35,741 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.41(0.40)/0.40, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-30 20:05:35,802 - INFO - Avg. fwd time: 8.2450 / Avg. bwd time: 18.2356 / Avg. batch time: 607.8393 (ms) / GPU bubble ratio: 65.15%
[rank2]:2025-11-30 20:05:35,759 - INFO - Avg. fwd time: 7.7426 / Avg. bwd time: 18.0590 / Avg. batch time: 535.4670 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-11-30 20:05:35,789 - INFO - Avg. fwd time: 10.0054 / Avg. bwd time: 21.9483 / Avg. batch time: 573.5917 (ms) / GPU bubble ratio: 55.43%
[rank2]:2025-11-30 20:05:35,874 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-30 20:05:35,897 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-11-30 20:05:35,945 - INFO -  step: 250  loss:  0.2191  grad_norm:  0.0681  memory: 17.37GiB(36.56%)  tps: 6,807  tflops: 53.21  mfu: 17.06%
[rank0]:2025-11-30 20:05:35,919 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.54)/0.54, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-30 20:05:35,947 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0681  memory: 13.29GiB(27.97%)  tps: 6,807  tflops: 53.21  mfu: 17.06%
[rank2]:2025-11-30 20:05:35,933 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0681  memory:  6.51GiB(13.70%)  tps: 6,807  tflops: 53.21  mfu: 17.06%
[rank1]:2025-11-30 20:05:35,937 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0681  memory:  9.36GiB(19.71%)  tps: 6,807  tflops: 53.21  mfu: 17.06%
[rank3]:2025-11-30 20:07:36,064 - INFO - Avg. fwd time: 13.6542 / Avg. bwd time: 38.8595 / Avg. batch time: 502.9172 (ms) / GPU bubble ratio: 16.47%
[rank0]:2025-11-30 20:07:36,133 - INFO - Avg. fwd time: 8.2818 / Avg. bwd time: 17.5890 / Avg. batch time: 605.5093 (ms) / GPU bubble ratio: 65.82%
[rank1]:2025-11-30 20:07:36,120 - INFO - Avg. fwd time: 10.0353 / Avg. bwd time: 21.7398 / Avg. batch time: 571.5070 (ms) / GPU bubble ratio: 55.52%
[rank2]:2025-11-30 20:07:36,092 - INFO - Avg. fwd time: 7.7610 / Avg. bwd time: 17.9576 / Avg. batch time: 533.5424 (ms) / GPU bubble ratio: 61.44%
[rank0]:2025-11-30 20:09:31,487 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-30 20:09:36,257 - INFO - Avg. fwd time: 7.7754 / Avg. bwd time: 17.8740 / Avg. batch time: 531.8961 (ms) / GPU bubble ratio: 61.42%
[rank3]:2025-11-30 20:09:36,230 - INFO - Avg. fwd time: 13.6813 / Avg. bwd time: 38.6250 / Avg. batch time: 501.3671 (ms) / GPU bubble ratio: 16.54%
[rank3]:2025-11-30 20:09:36,235 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.41(0.40)/0.40, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-30 20:09:36,313 - INFO - Avg. fwd time: 8.3111 / Avg. bwd time: 17.0538 / Avg. batch time: 603.5277 (ms) / GPU bubble ratio: 66.38%
[rank1]:2025-11-30 20:09:36,286 - INFO - Avg. fwd time: 10.0600 / Avg. bwd time: 21.5681 / Avg. batch time: 569.7309 (ms) / GPU bubble ratio: 55.59%
[rank1]:2025-11-30 20:09:36,293 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-30 20:09:36,263 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-30 20:09:36,335 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0769  memory:  6.51GiB(13.70%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank3]:2025-11-30 20:09:36,347 - INFO -  step: 300  loss:  0.2344  grad_norm:  0.0769  memory: 17.37GiB(36.56%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank0]:2025-11-30 20:09:36,321 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.54)/0.54, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-30 20:09:36,350 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0769  memory: 13.29GiB(27.97%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank0]:2025-11-30 20:09:36,400 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251130_2009_stage0_step300.svg
[rank1]:2025-11-30 20:09:36,338 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0769  memory:  9.36GiB(19.71%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank1]:2025-11-30 20:09:36,398 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251130_2009_stage1_step300.svg
[rank2]:2025-11-30 20:09:36,401 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251130_2009_stage2_step300.svg
[rank3]:2025-11-30 20:09:36,491 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251130_2009_real_step300_rank3.svg
[rank3]:			> Batch Time: 585.39 ms, GPU Bubble Ratio: 72.63%, 58.88%, 65.89%, 30.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-184ms    | [S0,MB2,B]  254-0-254ms    | [S0,MB6,F]  254-6-261ms    | [S0,MB3,B]  336-0-336ms    | [S0,MB7,F]  336-6-342ms    | [S0,MB4,B]  401-26-427ms   | [S0,MB5,B]  451-25-476ms   | [S0,MB6,B]  515-20-535ms   | [S0,MB7,B]  566-18-585ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-172ms   | [S1,MB4,F]  176-8-185ms    | [S1,MB2,B]  238-11-249ms   | [S1,MB5,F]  253-8-262ms    | [S1,MB3,B]  305-25-331ms   | [S1,MB6,F]  334-9-343ms    | [S1,MB4,B]  368-25-394ms   | [S1,MB7,F]  399-9-409ms    | [S1,MB5,B]  422-25-447ms   | [S1,MB6,B]  486-25-511ms   | [S1,MB7,B]  541-21-562ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  212-20-232ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  280-20-300ms   | [S2,MB5,F]  304-7-311ms    | [S2,MB4,B]  343-19-363ms   | [S2,MB6,F]  367-7-374ms    | [S2,MB5,B]  397-20-417ms   | [S2,MB7,F]  420-7-428ms    | [S2,MB6,B]  462-20-482ms   | [S2,MB7,B]  521-17-538ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-43-207ms   | [S3,MB3,F]  211-13-224ms   | [S3,MB3,B]  231-44-275ms   | [S3,MB4,F]  279-13-292ms   | [S3,MB4,B]  299-38-338ms   | [S3,MB5,F]  342-17-360ms   | [S3,MB5,B]  366-23-389ms   | [S3,MB6,F]  395-11-407ms   | [S3,MB6,B]  414-43-457ms   | [S3,MB7,F]  461-13-475ms   | [S3,MB7,B]  482-35-518ms  
[rank3]:2025-11-30 20:09:36,535 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251130_2009_stage3_step300.svg
[rank3]:2025-11-30 20:11:35,309 - INFO - Avg. fwd time: 13.7169 / Avg. bwd time: 38.3882 / Avg. batch time: 499.8388 (ms) / GPU bubble ratio: 16.60%
[rank1]:2025-11-30 20:11:35,364 - INFO - Avg. fwd time: 10.0777 / Avg. bwd time: 21.4440 / Avg. batch time: 568.0826 (ms) / GPU bubble ratio: 55.61%
[rank2]:2025-11-30 20:11:35,334 - INFO - Avg. fwd time: 7.7863 / Avg. bwd time: 17.8134 / Avg. batch time: 530.3379 (ms) / GPU bubble ratio: 61.38%
[rank0]:2025-11-30 20:11:35,377 - INFO - Avg. fwd time: 8.3328 / Avg. bwd time: 16.6495 / Avg. batch time: 601.7288 (ms) / GPU bubble ratio: 66.79%
[rank0]:2025-11-30 20:13:30,630 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-30 20:13:35,280 - INFO - Avg. fwd time: 7.7974 / Avg. bwd time: 17.7531 / Avg. batch time: 529.1115 (ms) / GPU bubble ratio: 61.37%
[rank3]:2025-11-30 20:13:35,253 - INFO - Avg. fwd time: 13.7423 / Avg. bwd time: 38.2085 / Avg. batch time: 498.6859 (ms) / GPU bubble ratio: 16.66%
[rank1]:2025-11-30 20:13:35,309 - INFO - Avg. fwd time: 10.0961 / Avg. bwd time: 21.3196 / Avg. batch time: 566.7625 (ms) / GPU bubble ratio: 55.66%
[rank0]:2025-11-30 20:13:35,322 - INFO - Avg. fwd time: 8.3544 / Avg. bwd time: 16.2462 / Avg. batch time: 600.2586 (ms) / GPU bubble ratio: 67.21%
[rank2]:2025-11-30 20:13:35,461 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0773  memory:  6.51GiB(13.70%)  tps: 6,852  tflops: 53.56  mfu: 17.17%
[rank0]:2025-11-30 20:13:35,475 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0773  memory: 13.29GiB(27.97%)  tps: 6,852  tflops: 53.56  mfu: 17.17%
[rank3]:2025-11-30 20:13:35,473 - INFO -  step: 350  loss:  0.2080  grad_norm:  0.0773  memory: 17.37GiB(36.56%)  tps: 6,852  tflops: 53.56  mfu: 17.17%
[rank1]:2025-11-30 20:13:35,465 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0773  memory:  9.36GiB(19.71%)  tps: 6,852  tflops: 53.56  mfu: 17.17%
[rank2]:2025-11-30 20:15:34,876 - INFO - Avg. fwd time: 7.8071 / Avg. bwd time: 17.7013 / Avg. batch time: 527.9222 (ms) / GPU bubble ratio: 61.35%
[rank1]:2025-11-30 20:15:34,906 - INFO - Avg. fwd time: 10.1123 / Avg. bwd time: 21.2126 / Avg. batch time: 565.4946 (ms) / GPU bubble ratio: 55.68%
[rank3]:2025-11-30 20:15:34,849 - INFO - Avg. fwd time: 13.7715 / Avg. bwd time: 38.0291 / Avg. batch time: 497.5572 (ms) / GPU bubble ratio: 16.71%
[rank0]:2025-11-30 20:15:34,934 - INFO - Avg. fwd time: 8.3732 / Avg. bwd time: 15.9128 / Avg. batch time: 598.8632 (ms) / GPU bubble ratio: 67.56%
[rank0]:2025-11-30 20:17:30,160 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-30 20:17:34,837 - INFO - Avg. fwd time: 7.8146 / Avg. bwd time: 17.6629 / Avg. batch time: 527.1623 (ms) / GPU bubble ratio: 61.34%
[rank1]:2025-11-30 20:17:34,865 - INFO - Avg. fwd time: 10.1249 / Avg. bwd time: 21.1323 / Avg. batch time: 564.6744 (ms) / GPU bubble ratio: 55.72%
[rank3]:2025-11-30 20:17:34,810 - INFO - Avg. fwd time: 13.7901 / Avg. bwd time: 37.9140 / Avg. batch time: 496.8436 (ms) / GPU bubble ratio: 16.75%
[rank0]:2025-11-30 20:17:34,878 - INFO - Avg. fwd time: 8.3874 / Avg. bwd time: 15.6514 / Avg. batch time: 597.9453 (ms) / GPU bubble ratio: 67.84%
[rank0]:2025-11-30 20:17:35,030 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0585  memory: 13.29GiB(27.97%)  tps: 6,839  tflops: 53.47  mfu: 17.14%
[rank2]:2025-11-30 20:17:35,015 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0585  memory:  6.51GiB(13.70%)  tps: 6,839  tflops: 53.47  mfu: 17.14%
[rank1]:2025-11-30 20:17:35,019 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0585  memory:  9.36GiB(19.71%)  tps: 6,839  tflops: 53.47  mfu: 17.14%
[rank3]:2025-11-30 20:17:35,028 - INFO -  step: 400  loss:  0.2047  grad_norm:  0.0585  memory: 17.37GiB(36.56%)  tps: 6,839  tflops: 53.47  mfu: 17.14%
[rank0]:2025-11-30 20:17:35,083 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251130_2017_stage0_step400.svg
[rank2]:2025-11-30 20:17:35,084 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251130_2017_stage2_step400.svg
[rank1]:2025-11-30 20:17:35,084 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251130_2017_stage1_step400.svg
[rank3]:2025-11-30 20:17:35,165 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251130_2017_real_step400_rank3.svg
[rank3]:			> Batch Time: 585.39 ms, GPU Bubble Ratio: 72.71%, 58.71%, 65.85%, 31.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB5,F]  177-6-184ms    | [S0,MB2,B]  255-0-255ms    | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  336-0-336ms    | [S0,MB7,F]  336-6-342ms    | [S0,MB4,B]  402-26-428ms   | [S0,MB5,B]  452-25-478ms   | [S0,MB6,B]  514-20-534ms   | [S0,MB7,B]  566-18-585ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  160-11-172ms   | [S1,MB4,F]  176-8-185ms    | [S1,MB2,B]  238-11-250ms   | [S1,MB5,F]  253-8-262ms    | [S1,MB3,B]  305-25-331ms   | [S1,MB6,F]  334-9-343ms    | [S1,MB4,B]  368-25-394ms   | [S1,MB7,F]  400-9-410ms    | [S1,MB5,B]  423-25-449ms   | [S1,MB6,B]  485-25-511ms   | [S1,MB7,B]  541-21-563ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-155ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  212-20-233ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  280-20-300ms   | [S2,MB5,F]  303-7-311ms    | [S2,MB4,B]  343-20-363ms   | [S2,MB6,F]  366-7-374ms    | [S2,MB5,B]  397-20-418ms   | [S2,MB7,F]  421-7-429ms    | [S2,MB6,B]  462-20-482ms   | [S2,MB7,B]  520-17-537ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-44-207ms   | [S3,MB3,F]  211-12-224ms   | [S3,MB3,B]  230-44-275ms   | [S3,MB4,F]  278-13-292ms   | [S3,MB4,B]  300-38-338ms   | [S3,MB5,F]  342-17-359ms   | [S3,MB5,B]  366-23-389ms   | [S3,MB6,F]  396-11-408ms   | [S3,MB6,B]  415-42-457ms   | [S3,MB7,F]  461-15-476ms   | [S3,MB7,B]  483-34-517ms  
[rank3]:2025-11-30 20:17:35,221 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251130_2017_stage3_step400.svg
[rank3]:2025-11-30 20:18:02,828 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-30 20:18:02,974 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-30 20:18:02,998 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-30 20:18:03,019 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-11-30 20:19:35,334 - INFO - Avg. fwd time: 13.8060 / Avg. bwd time: 37.8159 / Avg. batch time: 496.2402 (ms) / GPU bubble ratio: 16.78%
[rank0]:2025-11-30 20:19:35,404 - INFO - Avg. fwd time: 8.4019 / Avg. bwd time: 15.3924 / Avg. batch time: 597.1569 (ms) / GPU bubble ratio: 68.12%
[rank1]:2025-11-30 20:19:35,390 - INFO - Avg. fwd time: 10.1371 / Avg. bwd time: 21.0480 / Avg. batch time: 563.9881 (ms) / GPU bubble ratio: 55.76%
[rank2]:2025-11-30 20:19:35,362 - INFO - Avg. fwd time: 7.8221 / Avg. bwd time: 17.6226 / Avg. batch time: 526.5415 (ms) / GPU bubble ratio: 61.34%
