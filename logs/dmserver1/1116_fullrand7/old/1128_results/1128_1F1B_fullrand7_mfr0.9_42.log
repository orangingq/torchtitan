
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 01. (ì›”) 05:42:11 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.9_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.9) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.9
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-01 05:42:17,452 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-12-01 05:42:17,483 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-12-01 05:42:17,632 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-01 05:42:17,634 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-01 05:42:17,636 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank1]:2025-12-01 05:42:17,627 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-12-01 05:42:17,672 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-12-01 05:42:17,686 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-01 05:42:17,689 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-01 05:42:17,692 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-01 05:42:17,692 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 05:42:17,694 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-12-01 05:42:17,821 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-01 05:42:17,824 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-01 05:42:17,828 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank2]:2025-12-01 05:42:17,880 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-01 05:42:17,882 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-01 05:42:17,886 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 05:42:18,074 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-01 05:42:20,910 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-01 05:42:21,097 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-01 05:42:21,138 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 05:42:21,075 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-01 05:42:21,116 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 05:42:21,117 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-01 05:42:21,146 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-01 05:42:21,146 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-01 05:42:21,166 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-01 05:42:21,166 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-01 05:42:21,163 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-01 05:42:21,197 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 05:42:21,220 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-01 05:42:21,220 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-01 05:42:21,348 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 05:42:21,348 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-01 05:42:21,349 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-01 05:42:21,363 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-01 05:42:21,363 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-01 05:42:21,363 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-01 05:42:21,411 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 05:42:21,411 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-01 05:42:21,412 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run e84pmu3j
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.9_42_dm1/20251201-0542/wandb/run-20251201_054222-e84pmu3j
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/e84pmu3j
[rank3]:2025-12-01 05:42:23,447 - INFO - WandB logging enabled
[rank3]:2025-12-01 05:42:23,448 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-01 05:42:23,488 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-01 05:42:23,517 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-01 05:42:23,518 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-01 05:42:23,730 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-01 05:42:23,730 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 05:42:23,729 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:2025-12-01 05:42:23,714 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 05:42:23,730 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 05:42:23,730 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-01 05:42:23,730 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-01 05:42:23,714 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-01 05:42:23,715 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-01 05:42:23,729 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 05:42:25,802 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-01 05:42:25,802 - INFO - Finished loading the checkpoint in 2.07 seconds.
[rank0]:2025-12-01 05:42:25,802 - INFO - Training starts at step 1
[rank2]:2025-12-01 05:42:31,677 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  4.59GiB(9.67%)  tps: 3,109  tflops: 24.31  mfu: 7.79%
[rank2]:2025-12-01 05:42:31,678 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-01 05:42:31,716 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  9.17GiB(19.29%)  tps: 3,091  tflops: 24.17  mfu: 7.75%
[rank0]:2025-12-01 05:42:31,716 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-01 05:42:31,680 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  6.72GiB(14.15%)  tps: 3,126  tflops: 24.44  mfu: 7.83%
[rank1]:2025-12-01 05:42:31,680 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-01 05:42:31,690 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 12.97GiB(27.31%)  tps: 3,997  tflops: 31.24  mfu: 10.01%
[rank3]:2025-12-01 05:42:31,690 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-01 05:44:39,806 - INFO - Avg. fwd time: 7.4931 / Avg. bwd time: 19.8359 / Avg. batch time: 571.7921 (ms) / GPU bubble ratio: 61.76%
[rank3]:2025-12-01 05:44:39,781 - INFO - Avg. fwd time: 13.1127 / Avg. bwd time: 43.9529 / Avg. batch time: 538.5177 (ms) / GPU bubble ratio: 15.23%
[rank0]:2025-12-01 05:44:39,866 - INFO - Avg. fwd time: 7.7690 / Avg. bwd time: 25.5946 / Avg. batch time: 651.8175 (ms) / GPU bubble ratio: 59.05%
[rank1]:2025-12-01 05:44:39,836 - INFO - Avg. fwd time: 9.6323 / Avg. bwd time: 25.0603 / Avg. batch time: 612.3242 (ms) / GPU bubble ratio: 54.67%
[rank0]:2025-12-01 05:46:48,614 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 05:46:53,878 - INFO - Avg. fwd time: 7.4967 / Avg. bwd time: 19.8757 / Avg. batch time: 573.2765 (ms) / GPU bubble ratio: 61.80%
[rank3]:2025-12-01 05:46:53,853 - INFO - Avg. fwd time: 13.1977 / Avg. bwd time: 44.1178 / Avg. batch time: 540.3690 (ms) / GPU bubble ratio: 15.15%
[rank1]:2025-12-01 05:46:53,907 - INFO - Avg. fwd time: 9.6521 / Avg. bwd time: 25.1222 / Avg. batch time: 613.4875 (ms) / GPU bubble ratio: 54.65%
[rank1]:2025-12-01 05:46:53,962 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  8.99GiB(18.92%)  tps: 6,122  tflops: 47.86  mfu: 15.34%
[rank0]:2025-12-01 05:46:53,938 - INFO - Avg. fwd time: 7.7664 / Avg. bwd time: 25.6349 / Avg. batch time: 652.6295 (ms) / GPU bubble ratio: 59.06%
[rank0]:2025-12-01 05:46:53,974 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory: 12.97GiB(27.31%)  tps: 6,122  tflops: 47.86  mfu: 15.34%
[rank2]:2025-12-01 05:46:53,959 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  6.39GiB(13.45%)  tps: 6,122  tflops: 47.86  mfu: 15.34%
[rank3]:2025-12-01 05:46:53,971 - INFO -  step: 50  loss:  9.9211  grad_norm: 12.8635  memory: 16.39GiB(34.50%)  tps: 6,122  tflops: 47.86  mfu: 15.34%
[rank3]:2025-12-01 05:47:47,564 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-01 05:48:41,339 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-01 05:48:41,467 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-01 05:48:59,661 - INFO - Avg. fwd time: 13.3553 / Avg. bwd time: 42.7625 / Avg. batch time: 530.7301 (ms) / GPU bubble ratio: 15.41%
[rank1]:2025-12-01 05:48:59,692 - INFO - Avg. fwd time: 9.7752 / Avg. bwd time: 24.2661 / Avg. batch time: 602.0329 (ms) / GPU bubble ratio: 54.76%
[rank0]:2025-12-01 05:48:59,697 - INFO - Avg. fwd time: 7.8640 / Avg. bwd time: 23.9589 / Avg. batch time: 639.3328 (ms) / GPU bubble ratio: 60.18%
[rank2]:2025-12-01 05:48:59,676 - INFO - Avg. fwd time: 7.6018 / Avg. bwd time: 19.1945 / Avg. batch time: 562.8056 (ms) / GPU bubble ratio: 61.91%
[rank3]:2025-12-01 05:49:17,876 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-01 05:49:18,050 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0549_max_batch_time.svg
[rank3]:			> Batch Time: 559.06 ms, GPU Bubble Ratio: 52.07%, 50.27%, 60.79%, 18.04%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  132-26-158ms   | [S0,MB4,F]  158-7-165ms    | [S0,MB1,B]  186-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  243-25-268ms   | [S0,MB6,F]  268-7-275ms    | [S0,MB3,B]  300-25-326ms   | [S0,MB7,F]  326-7-333ms    | [S0,MB4,B]  359-25-385ms   | [S0,MB5,B]  416-25-442ms   | [S0,MB6,B]  475-25-501ms   | [S0,MB7,B]  533-25-559ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-132ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  161-25-186ms   | [S1,MB4,F]  186-9-196ms    | [S1,MB2,B]  217-25-243ms   | [S1,MB5,F]  243-9-252ms    | [S1,MB3,B]  275-25-300ms   | [S1,MB6,F]  300-9-310ms    | [S1,MB4,B]  334-25-359ms   | [S1,MB7,F]  359-9-368ms    | [S1,MB5,B]  391-25-416ms   | [S1,MB6,B]  450-25-475ms   | [S1,MB7,B]  508-25-533ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  197-19-217ms   | [S2,MB4,F]  217-7-225ms    | [S2,MB3,B]  255-19-275ms   | [S2,MB5,F]  275-7-282ms    | [S2,MB4,B]  314-19-334ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  371-19-391ms   | [S2,MB7,F]  391-7-398ms    | [S2,MB6,B]  430-19-450ms   | [S2,MB7,B]  488-19-508ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-10-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-153ms   | [S3,MB2,B]  153-44-197ms   AFR(10):0.9655 | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB4,F]  255-13-268ms   | [S3,MB4,B]  268-45-314ms   AFR(10):0.9655 | [S3,MB5,F]  314-13-327ms   | [S3,MB5,B]  327-44-371ms   AFR(10):0.9655 | [S3,MB6,F]  371-13-385ms   | [S3,MB6,B]  385-45-430ms   AFR(10):0.9655 | [S3,MB7,F]  430-13-443ms   | [S3,MB7,B]  443-44-488ms   AFR(10):0.9655
[rank3]:2025-12-01 05:49:18,176 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0549_min_batch_time.svg
[rank3]:			> Batch Time: 337.94 ms, GPU Bubble Ratio: 81.70%, 49.42%, 60.33%, 15.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  88-0-88ms      | [S0,MB4,F]  88-7-95ms      | [S0,MB1,B]  121-0-121ms    | [S0,MB5,F]  121-7-128ms    | [S0,MB2,B]  156-0-156ms    | [S0,MB6,F]  156-7-163ms    | [S0,MB3,B]  193-0-193ms    | [S0,MB7,F]  193-7-200ms    | [S0,MB4,B]  229-0-229ms    | [S0,MB5,B]  265-0-265ms    | [S0,MB6,B]  302-0-302ms    | [S0,MB7,B]  337-0-337ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  76-11-88ms     | [S1,MB3,F]  88-9-97ms      | [S1,MB1,B]  109-11-121ms   | [S1,MB4,F]  121-9-131ms    | [S1,MB2,B]  144-11-156ms   | [S1,MB5,F]  156-9-166ms    | [S1,MB3,B]  181-11-193ms   | [S1,MB6,F]  193-9-202ms    | [S1,MB4,B]  217-11-229ms   | [S1,MB7,F]  229-9-238ms    | [S1,MB5,B]  253-11-265ms   | [S1,MB6,B]  290-11-302ms   | [S1,MB7,B]  326-11-337ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  67-9-76ms      | [S2,MB2,F]  76-7-83ms      | [S2,MB1,B]  100-9-109ms    | [S2,MB3,F]  109-7-117ms    | [S2,MB2,B]  135-9-144ms    | [S2,MB4,F]  144-7-152ms    | [S2,MB3,B]  171-9-181ms    | [S2,MB5,F]  181-7-188ms    | [S2,MB4,B]  207-9-217ms    | [S2,MB6,F]  217-7-224ms    | [S2,MB5,B]  244-9-253ms    | [S2,MB7,F]  253-7-261ms    | [S2,MB6,B]  281-9-290ms    | [S2,MB7,B]  316-9-326ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-22-67ms     AFR(10):0.9655 | [S3,MB1,F]  67-10-78ms     | [S3,MB1,B]  78-22-100ms    AFR(10):0.9655 | [S3,MB2,F]  100-12-113ms   | [S3,MB2,B]  113-22-135ms   AFR(10):0.9655 | [S3,MB3,F]  135-13-149ms   | [S3,MB3,B]  149-22-171ms   AFR(10):0.9655 | [S3,MB4,F]  171-13-185ms   | [S3,MB4,B]  185-22-207ms   AFR(10):0.9655 | [S3,MB5,F]  207-13-221ms   | [S3,MB5,B]  221-23-244ms   AFR(10):0.9655 | [S3,MB6,F]  244-13-258ms   | [S3,MB6,B]  258-22-281ms   AFR(10):0.9655 | [S3,MB7,F]  281-13-294ms   | [S3,MB7,B]  294-22-316ms   AFR(10):0.9655
[rank3]:2025-12-01 05:49:18,315 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0549_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 353.94 ms, GPU Bubble Ratio: 35.48%, 25.22%, 41.08%, 14.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  128-26-154ms   | [S0,MB4,F]  154-7-161ms    | [S0,MB1,B]  163-25-188ms   | [S0,MB5,F]  188-7-195ms    | [S0,MB2,B]  197-25-223ms   | [S0,MB6,F]  223-7-230ms    | [S0,MB3,B]  232-25-258ms   | [S0,MB7,F]  258-7-265ms    | [S0,MB4,B]  269-25-294ms   | [S0,MB5,B]  305-25-331ms   | [S0,MB6,B]  342-11-353ms   | [S0,MB7,B]  353-0-353ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  103-25-128ms   | [S1,MB3,F]  128-9-137ms    | [S1,MB1,B]  137-25-163ms   | [S1,MB4,F]  163-9-172ms    | [S1,MB2,B]  172-25-197ms   | [S1,MB5,F]  197-9-207ms    | [S1,MB3,B]  207-25-232ms   | [S1,MB6,F]  232-9-242ms    | [S1,MB4,B]  243-25-269ms   | [S1,MB7,F]  269-9-278ms    | [S1,MB5,B]  280-25-305ms   | [S1,MB6,B]  317-25-342ms   | [S1,MB7,B]  342-11-353ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  83-20-103ms    | [S2,MB2,F]  103-7-110ms    | [S2,MB1,B]  116-19-136ms   | [S2,MB3,F]  137-7-145ms    | [S2,MB2,B]  151-19-171ms   | [S2,MB4,F]  172-7-179ms    | [S2,MB3,B]  187-19-207ms   | [S2,MB5,F]  207-7-214ms    | [S2,MB4,B]  223-19-243ms   | [S2,MB6,F]  243-7-251ms    | [S2,MB5,B]  260-19-280ms   | [S2,MB7,F]  280-7-287ms    | [S2,MB6,B]  297-19-317ms   | [S2,MB7,B]  332-9-342ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-38-83ms     AFR(10):0.9655 | [S3,MB1,F]  83-10-94ms     | [S3,MB1,B]  94-22-116ms    AFR(10):0.9655 | [S3,MB2,F]  116-12-129ms   | [S3,MB2,B]  129-22-151ms   AFR(10):0.9655 | [S3,MB3,F]  151-13-165ms   | [S3,MB3,B]  165-22-187ms   AFR(10):0.9655 | [S3,MB4,F]  187-13-201ms   | [S3,MB4,B]  201-22-223ms   AFR(10):0.9655 | [S3,MB5,F]  223-13-237ms   | [S3,MB5,B]  237-23-260ms   AFR(10):0.9655 | [S3,MB6,F]  260-13-274ms   | [S3,MB6,B]  274-22-297ms   AFR(10):0.9655 | [S3,MB7,F]  297-13-310ms   | [S3,MB7,B]  310-22-332ms   AFR(10):0.9655
[rank3]:2025-12-01 05:49:18,316 - INFO - 	> Batch Time: 353.94 ms (Average Freeze Ratio: 0.34, Time Reduction Rate: 0.37)
[rank0]:2025-12-01 05:50:42,949 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 05:50:47,711 - INFO - Avg. fwd time: 7.7131 / Avg. bwd time: 18.4797 / Avg. batch time: 536.9883 (ms) / GPU bubble ratio: 60.98%
[rank3]:2025-12-01 05:50:47,685 - INFO - Avg. fwd time: 13.7149 / Avg. bwd time: 39.2159 / Avg. batch time: 505.2556 (ms) / GPU bubble ratio: 16.19%
[rank3]:2025-12-01 05:50:47,690 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.07(0.07)/0.20, [MB1] 0.28(0.33)/1.00, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-01 05:50:47,740 - INFO - Avg. fwd time: 9.9221 / Avg. bwd time: 23.2017 / Avg. batch time: 575.3954 (ms) / GPU bubble ratio: 53.95%
[rank1]:2025-12-01 05:50:47,747 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-01 05:50:47,792 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.1513  memory:  9.36GiB(19.71%)  tps: 7,007  tflops: 54.78  mfu: 17.56%
[rank0]:2025-12-01 05:50:47,766 - INFO - Avg. fwd time: 8.0171 / Avg. bwd time: 21.1315 / Avg. batch time: 610.6291 (ms) / GPU bubble ratio: 61.81%
[rank0]:2025-12-01 05:50:47,774 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.18)/0.54, [MB7] 0.27(0.33)/1.00
[rank2]:2025-12-01 05:50:47,717 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-01 05:50:47,788 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.1513  memory:  6.51GiB(13.70%)  tps: 7,007  tflops: 54.78  mfu: 17.56%
[rank3]:2025-12-01 05:50:47,800 - INFO -  step: 100  loss:  8.8898  grad_norm:  5.1513  memory: 16.88GiB(35.53%)  tps: 7,007  tflops: 54.78  mfu: 17.56%
[rank1]:2025-12-01 05:50:47,860 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0550_stage1_step100.svg
[rank0]:2025-12-01 05:50:47,802 - INFO -  step: 100  loss: -8.0000  grad_norm:  5.1513  memory: 12.97GiB(27.31%)  tps: 7,007  tflops: 54.78  mfu: 17.56%
[rank0]:2025-12-01 05:50:47,860 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0550_stage0_step100.svg
[rank2]:2025-12-01 05:50:47,860 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0550_stage2_step100.svg
[rank3]:2025-12-01 05:50:47,938 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0550_real_step100_rank3.svg
[rank3]:			> Batch Time: 589.38 ms, GPU Bubble Ratio: 61.38%, 53.86%, 63.58%, 31.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  133-17-151ms   | [S0,MB4,F]  151-7-158ms    | [S0,MB1,B]  198-17-216ms   | [S0,MB5,F]  215-7-222ms    | [S0,MB2,B]  264-17-281ms   | [S0,MB6,F]  281-7-288ms    | [S0,MB3,B]  332-17-349ms   | [S0,MB7,F]  349-7-356ms    | [S0,MB4,B]  398-25-424ms   | [S0,MB5,B]  458-25-484ms   | [S0,MB6,B]  516-21-537ms   | [S0,MB7,B]  568-21-589ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  37-9-46ms      | [S1,MB0,B]  106-22-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  171-22-193ms   | [S1,MB4,F]  197-9-206ms    | [S1,MB2,B]  236-22-259ms   | [S1,MB5,F]  262-9-272ms    | [S1,MB3,B]  301-25-326ms   | [S1,MB6,F]  330-9-339ms    | [S1,MB4,B]  368-25-393ms   | [S1,MB7,F]  397-9-406ms    | [S1,MB5,B]  429-25-455ms   | [S1,MB6,B]  487-25-512ms   | [S1,MB7,B]  540-24-564ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  83-17-100ms    | [S2,MB2,F]  104-7-112ms    | [S2,MB1,B]  149-17-166ms   | [S2,MB3,F]  169-7-176ms    | [S2,MB2,B]  211-20-231ms   | [S2,MB4,F]  235-7-242ms    | [S2,MB3,B]  276-19-296ms   | [S2,MB5,F]  300-7-307ms    | [S2,MB4,B]  343-20-363ms   | [S2,MB6,F]  366-7-374ms    | [S2,MB5,B]  405-20-425ms   | [S2,MB7,F]  428-7-435ms    | [S2,MB6,B]  463-20-484ms   | [S2,MB7,B]  517-19-536ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-26-78ms     | [S3,MB1,F]  82-14-96ms     | [S3,MB1,B]  102-41-144ms   | [S3,MB2,F]  147-12-159ms   | [S3,MB2,B]  166-40-206ms   | [S3,MB3,F]  210-14-224ms   | [S3,MB3,B]  231-40-271ms   | [S3,MB4,F]  275-13-288ms   | [S3,MB4,B]  295-42-338ms   | [S3,MB5,F]  342-13-355ms   | [S3,MB5,B]  362-38-400ms   | [S3,MB6,F]  403-16-420ms   | [S3,MB6,B]  427-30-458ms   | [S3,MB7,F]  462-16-478ms   | [S3,MB7,B]  485-28-513ms  
[rank3]:2025-12-01 05:50:47,980 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0550_stage3_step100.svg
[rank2]:2025-12-01 05:52:49,660 - INFO - Avg. fwd time: 7.6961 / Avg. bwd time: 18.5817 / Avg. batch time: 533.0686 (ms) / GPU bubble ratio: 60.56%
[rank3]:2025-12-01 05:52:49,635 - INFO - Avg. fwd time: 13.7903 / Avg. bwd time: 38.6357 / Avg. batch time: 501.2955 (ms) / GPU bubble ratio: 16.34%
[rank0]:2025-12-01 05:52:49,715 - INFO - Avg. fwd time: 8.0270 / Avg. bwd time: 21.2433 / Avg. batch time: 606.9179 (ms) / GPU bubble ratio: 61.42%
[rank1]:2025-12-01 05:52:49,689 - INFO - Avg. fwd time: 9.9171 / Avg. bwd time: 23.2543 / Avg. batch time: 571.5729 (ms) / GPU bubble ratio: 53.57%
[rank0]:2025-12-01 05:54:39,793 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 05:54:44,276 - INFO - Avg. fwd time: 13.9306 / Avg. bwd time: 37.4335 / Avg. batch time: 493.0658 (ms) / GPU bubble ratio: 16.66%
[rank3]:2025-12-01 05:54:44,281 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.10(0.13)/0.20, [MB1] 0.59(0.67)/1.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-01 05:54:44,301 - INFO - Avg. fwd time: 7.7083 / Avg. bwd time: 18.4996 / Avg. batch time: 524.6585 (ms) / GPU bubble ratio: 60.04%
[rank2]:2025-12-01 05:54:44,307 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank2]:2025-12-01 05:54:44,380 - INFO -  step: 150  loss: -8.0000  grad_norm:  2.4453  memory:  6.51GiB(13.70%)  tps: 6,925  tflops: 54.14  mfu: 17.35%
[rank0]:2025-12-01 05:54:44,358 - INFO - Avg. fwd time: 8.0746 / Avg. bwd time: 21.0140 / Avg. batch time: 598.4079 (ms) / GPU bubble ratio: 61.11%
[rank0]:2025-12-01 05:54:44,366 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.36)/0.54, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-01 05:54:44,394 - INFO -  step: 150  loss: -8.0000  grad_norm:  2.4453  memory: 13.29GiB(27.97%)  tps: 6,925  tflops: 54.14  mfu: 17.35%
[rank1]:2025-12-01 05:54:44,329 - INFO - Avg. fwd time: 9.9474 / Avg. bwd time: 23.0755 / Avg. batch time: 563.1250 (ms) / GPU bubble ratio: 53.09%
[rank1]:2025-12-01 05:54:44,336 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank1]:2025-12-01 05:54:44,383 - INFO -  step: 150  loss: -8.0000  grad_norm:  2.4453  memory:  9.36GiB(19.71%)  tps: 6,925  tflops: 54.14  mfu: 17.35%
[rank3]:2025-12-01 05:54:44,390 - INFO -  step: 150  loss:  4.7092  grad_norm:  2.4453  memory: 17.37GiB(36.56%)  tps: 6,925  tflops: 54.14  mfu: 17.35%
[rank3]:2025-12-01 05:56:35,252 - INFO - Avg. fwd time: 14.0580 / Avg. bwd time: 36.2283 / Avg. batch time: 484.7500 (ms) / GPU bubble ratio: 17.01%
[rank2]:2025-12-01 05:56:35,276 - INFO - Avg. fwd time: 7.7179 / Avg. bwd time: 18.4491 / Avg. batch time: 516.2994 (ms) / GPU bubble ratio: 59.45%
[rank0]:2025-12-01 05:56:35,330 - INFO - Avg. fwd time: 8.1203 / Avg. bwd time: 20.5453 / Avg. batch time: 589.6639 (ms) / GPU bubble ratio: 61.11%
[rank1]:2025-12-01 05:56:35,304 - INFO - Avg. fwd time: 9.9793 / Avg. bwd time: 22.8328 / Avg. batch time: 554.6777 (ms) / GPU bubble ratio: 52.68%
[rank0]:2025-12-01 05:58:16,603 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 05:58:20,736 - INFO - Avg. fwd time: 7.7433 / Avg. bwd time: 18.3076 / Avg. batch time: 506.7495 (ms) / GPU bubble ratio: 58.87%
[rank2]:2025-12-01 05:58:20,742 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank0]:2025-12-01 05:58:20,791 - INFO - Avg. fwd time: 8.1822 / Avg. bwd time: 19.8682 / Avg. batch time: 579.7005 (ms) / GPU bubble ratio: 61.29%
[rank3]:2025-12-01 05:58:20,712 - INFO - Avg. fwd time: 14.1809 / Avg. bwd time: 34.9355 / Avg. batch time: 475.3988 (ms) / GPU bubble ratio: 17.35%
[rank3]:2025-12-01 05:58:20,716 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.17(0.20)/0.20, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank3]:2025-12-01 05:58:20,801 - INFO -  step: 200  loss:  2.9189  grad_norm:  0.6602  memory: 17.37GiB(36.56%)  tps: 7,571  tflops: 59.19  mfu: 18.97%
[rank1]:2025-12-01 05:58:20,765 - INFO - Avg. fwd time: 10.0211 / Avg. bwd time: 22.5631 / Avg. batch time: 545.0238 (ms) / GPU bubble ratio: 52.17%
[rank1]:2025-12-01 05:58:20,772 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-01 05:58:20,812 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.6602  memory:  6.51GiB(13.70%)  tps: 7,570  tflops: 59.18  mfu: 18.97%
[rank2]:2025-12-01 05:58:20,877 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0558_stage2_step200.svg
[rank0]:2025-12-01 05:58:20,798 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.51(0.54)/0.54, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-01 05:58:20,827 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.6602  memory: 13.29GiB(27.97%)  tps: 7,570  tflops: 59.18  mfu: 18.97%
[rank0]:2025-12-01 05:58:20,876 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0558_stage0_step200.svg
[rank1]:2025-12-01 05:58:20,816 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.6602  memory:  9.36GiB(19.71%)  tps: 7,570  tflops: 59.18  mfu: 18.97%
[rank1]:2025-12-01 05:58:20,877 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0558_stage1_step200.svg
[rank3]:2025-12-01 05:58:20,965 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0558_real_step200_rank3.svg
[rank3]:			> Batch Time: 500.61 ms, GPU Bubble Ratio: 63.52%, 50.09%, 59.84%, 36.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-10-39ms     | [S0,MB0,B]  111-5-117ms    | [S0,MB4,F]  117-8-125ms    | [S0,MB1,B]  173-5-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  233-5-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  295-5-300ms    | [S0,MB7,F]  300-6-307ms    | [S0,MB4,B]  345-26-371ms   | [S0,MB5,B]  393-25-419ms   | [S0,MB6,B]  440-20-460ms   | [S0,MB7,B]  481-19-500ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  93-13-106ms    | [S1,MB3,F]  110-11-121ms   | [S1,MB1,B]  154-13-168ms   | [S1,MB4,F]  171-9-180ms    | [S1,MB2,B]  215-13-228ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  264-25-290ms   | [S1,MB6,F]  293-9-303ms    | [S1,MB4,B]  314-26-340ms   | [S1,MB7,F]  344-9-354ms    | [S1,MB5,B]  363-26-389ms   | [S1,MB6,B]  410-25-436ms   | [S1,MB7,B]  455-22-477ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  140-9-149ms    | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  189-20-210ms   | [S2,MB4,F]  213-7-220ms    | [S2,MB3,B]  239-20-259ms   | [S2,MB5,F]  262-7-270ms    | [S2,MB4,B]  289-20-309ms   | [S2,MB6,F]  313-7-320ms    | [S2,MB5,B]  338-20-358ms   | [S2,MB7,F]  362-7-369ms    | [S2,MB6,B]  387-20-407ms   | [S2,MB7,B]  434-17-451ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-36-135ms    | [S3,MB2,F]  138-15-154ms   | [S3,MB2,B]  162-22-185ms   | [S3,MB3,F]  188-15-203ms   | [S3,MB3,B]  210-23-234ms   | [S3,MB4,F]  237-14-252ms   | [S3,MB4,B]  259-23-283ms   | [S3,MB5,F]  287-15-303ms   | [S3,MB5,B]  310-22-333ms   | [S3,MB6,F]  336-15-351ms   | [S3,MB6,B]  358-23-382ms   | [S3,MB7,F]  385-15-400ms   | [S3,MB7,B]  407-23-431ms  
[rank3]:2025-12-01 05:58:21,010 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0558_stage3_step200.svg
[rank3]:2025-12-01 06:00:03,441 - INFO - Avg. fwd time: 14.2885 / Avg. bwd time: 33.7339 / Avg. batch time: 466.6094 (ms) / GPU bubble ratio: 17.67%
[rank2]:2025-12-01 06:00:03,466 - INFO - Avg. fwd time: 7.7675 / Avg. bwd time: 18.1758 / Avg. batch time: 497.8305 (ms) / GPU bubble ratio: 58.31%
[rank0]:2025-12-01 06:00:03,520 - INFO - Avg. fwd time: 8.2362 / Avg. bwd time: 18.9470 / Avg. batch time: 570.3736 (ms) / GPU bubble ratio: 61.87%
[rank1]:2025-12-01 06:00:03,494 - INFO - Avg. fwd time: 10.0627 / Avg. bwd time: 22.2958 / Avg. batch time: 535.9935 (ms) / GPU bubble ratio: 51.70%
[rank0]:2025-12-01 06:01:42,017 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 06:01:46,029 - INFO - Avg. fwd time: 14.3734 / Avg. bwd time: 32.7719 / Avg. batch time: 459.5617 (ms) / GPU bubble ratio: 17.93%
[rank3]:2025-12-01 06:01:46,042 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.21(0.20)/0.20, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-01 06:01:46,082 - INFO - Avg. fwd time: 10.0947 / Avg. bwd time: 22.0821 / Avg. batch time: 528.6971 (ms) / GPU bubble ratio: 51.31%
[rank1]:2025-12-01 06:01:46,089 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 06:01:46,053 - INFO - Avg. fwd time: 7.7856 / Avg. bwd time: 18.0717 / Avg. batch time: 490.6260 (ms) / GPU bubble ratio: 57.84%
[rank2]:2025-12-01 06:01:46,059 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 06:01:46,130 - INFO -  step: 250  loss: -8.0000  grad_norm:  1.2032  memory:  6.51GiB(13.70%)  tps: 7,980  tflops: 62.38  mfu: 19.99%
[rank0]:2025-12-01 06:01:46,108 - INFO - Avg. fwd time: 8.2783 / Avg. bwd time: 18.1923 / Avg. batch time: 562.8415 (ms) / GPU bubble ratio: 62.38%
[rank0]:2025-12-01 06:01:46,116 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.54)/0.54, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 06:01:46,144 - INFO -  step: 250  loss: -8.0000  grad_norm:  1.2032  memory: 13.29GiB(27.97%)  tps: 7,980  tflops: 62.38  mfu: 19.99%
[rank3]:2025-12-01 06:01:46,118 - INFO -  step: 250  loss:  2.8610  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 7,980  tflops: 62.38  mfu: 19.99%
[rank1]:2025-12-01 06:01:46,134 - INFO -  step: 250  loss: -8.0000  grad_norm:  1.2032  memory:  9.36GiB(19.71%)  tps: 7,980  tflops: 62.38  mfu: 19.99%
[rank2]:2025-12-01 06:03:27,841 - INFO - Avg. fwd time: 7.8004 / Avg. bwd time: 17.9880 / Avg. batch time: 484.3890 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-12-01 06:03:27,816 - INFO - Avg. fwd time: 14.4374 / Avg. bwd time: 31.9476 / Avg. batch time: 453.4511 (ms) / GPU bubble ratio: 18.17%
[rank0]:2025-12-01 06:03:27,896 - INFO - Avg. fwd time: 8.3113 / Avg. bwd time: 17.5901 / Avg. batch time: 556.3343 (ms) / GPU bubble ratio: 62.75%
[rank1]:2025-12-01 06:03:27,870 - INFO - Avg. fwd time: 10.1211 / Avg. bwd time: 21.9088 / Avg. batch time: 522.3893 (ms) / GPU bubble ratio: 50.95%
[rank0]:2025-12-01 06:05:06,504 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 06:05:10,514 - INFO - Avg. fwd time: 14.4964 / Avg. bwd time: 31.3021 / Avg. batch time: 448.7376 (ms) / GPU bubble ratio: 18.35%
[rank3]:2025-12-01 06:05:10,527 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.21(0.20)/0.20, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 06:05:10,539 - INFO - Avg. fwd time: 7.8132 / Avg. bwd time: 17.9207 / Avg. batch time: 479.5729 (ms) / GPU bubble ratio: 57.07%
[rank2]:2025-12-01 06:05:10,545 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-01 06:05:10,568 - INFO - Avg. fwd time: 10.1435 / Avg. bwd time: 21.7660 / Avg. batch time: 517.5170 (ms) / GPU bubble ratio: 50.67%
[rank1]:2025-12-01 06:05:10,575 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-01 06:05:10,605 - INFO -  step: 300  loss:  2.7787  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,012  tflops: 62.64  mfu: 20.08%
[rank0]:2025-12-01 06:05:10,595 - INFO - Avg. fwd time: 8.3393 / Avg. bwd time: 17.0879 / Avg. batch time: 551.3003 (ms) / GPU bubble ratio: 63.10%
[rank0]:2025-12-01 06:05:10,602 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.54)/0.54, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 06:05:10,631 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4111  memory: 13.29GiB(27.97%)  tps: 8,012  tflops: 62.64  mfu: 20.08%
[rank2]:2025-12-01 06:05:10,616 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4111  memory:  6.51GiB(13.70%)  tps: 8,012  tflops: 62.64  mfu: 20.08%
[rank1]:2025-12-01 06:05:10,620 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4111  memory:  9.36GiB(19.71%)  tps: 8,012  tflops: 62.64  mfu: 20.08%
[rank1]:2025-12-01 06:05:10,679 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0605_stage1_step300.svg
[rank0]:2025-12-01 06:05:10,680 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0605_stage0_step300.svg
[rank2]:2025-12-01 06:05:10,679 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0605_stage2_step300.svg
[rank3]:2025-12-01 06:05:10,770 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0605_real_step300_rank3.svg
[rank3]:			> Batch Time: 496.16 ms, GPU Bubble Ratio: 67.55%, 50.60%, 59.43%, 36.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  171-0-171ms    | [S0,MB5,F]  171-6-178ms    | [S0,MB2,B]  231-0-231ms    | [S0,MB6,F]  231-6-238ms    | [S0,MB3,B]  293-0-293ms    | [S0,MB7,F]  293-7-300ms    | [S0,MB4,B]  343-26-369ms   | [S0,MB5,B]  390-25-415ms   | [S0,MB6,B]  436-20-456ms   | [S0,MB7,B]  477-19-496ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  154-11-165ms   | [S1,MB4,F]  169-9-178ms    | [S1,MB2,B]  214-11-226ms   | [S1,MB5,F]  229-9-238ms    | [S1,MB3,B]  263-25-288ms   | [S1,MB6,F]  292-9-301ms    | [S1,MB4,B]  311-25-337ms   | [S1,MB7,F]  341-9-351ms    | [S1,MB5,B]  360-26-386ms   | [S1,MB6,B]  406-25-432ms   | [S1,MB7,B]  451-22-473ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  139-9-148ms    | [S2,MB3,F]  152-7-159ms    | [S2,MB2,B]  188-20-209ms   | [S2,MB4,F]  212-7-219ms    | [S2,MB3,B]  237-20-257ms   | [S2,MB5,F]  261-7-268ms    | [S2,MB4,B]  286-20-306ms   | [S2,MB6,F]  309-7-317ms    | [S2,MB5,B]  334-20-355ms   | [S2,MB7,F]  358-7-365ms    | [S2,MB6,B]  382-20-403ms   | [S2,MB7,B]  430-17-447ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-35-134ms    | [S3,MB2,F]  138-15-153ms   | [S3,MB2,B]  161-22-183ms   | [S3,MB3,F]  187-15-202ms   | [S3,MB3,B]  209-22-232ms   | [S3,MB4,F]  236-15-251ms   | [S3,MB4,B]  258-22-280ms   | [S3,MB5,F]  284-15-299ms   | [S3,MB5,B]  307-22-329ms   | [S3,MB6,F]  333-15-348ms   | [S3,MB6,B]  355-22-378ms   | [S3,MB7,F]  381-15-396ms   | [S3,MB7,B]  404-22-426ms  
[rank3]:2025-12-01 06:05:10,813 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0605_stage3_step300.svg
[rank3]:2025-12-01 06:06:53,325 - INFO - Avg. fwd time: 14.5467 / Avg. bwd time: 30.7529 / Avg. batch time: 444.7304 (ms) / GPU bubble ratio: 18.51%
[rank2]:2025-12-01 06:06:53,351 - INFO - Avg. fwd time: 7.8240 / Avg. bwd time: 17.8640 / Avg. batch time: 475.5180 (ms) / GPU bubble ratio: 56.78%
[rank1]:2025-12-01 06:06:53,381 - INFO - Avg. fwd time: 10.1628 / Avg. bwd time: 21.6455 / Avg. batch time: 513.4156 (ms) / GPU bubble ratio: 50.44%
[rank0]:2025-12-01 06:06:53,408 - INFO - Avg. fwd time: 8.3639 / Avg. bwd time: 16.6449 / Avg. batch time: 547.0638 (ms) / GPU bubble ratio: 63.43%
[rank0]:2025-12-01 06:08:31,324 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 06:08:35,276 - INFO - Avg. fwd time: 14.5872 / Avg. bwd time: 30.2499 / Avg. batch time: 441.0126 (ms) / GPU bubble ratio: 18.67%
[rank2]:2025-12-01 06:08:35,302 - INFO - Avg. fwd time: 7.8334 / Avg. bwd time: 17.8150 / Avg. batch time: 471.7234 (ms) / GPU bubble ratio: 56.50%
[rank1]:2025-12-01 06:08:35,332 - INFO - Avg. fwd time: 10.1799 / Avg. bwd time: 21.5430 / Avg. batch time: 509.5837 (ms) / GPU bubble ratio: 50.20%
[rank3]:2025-12-01 06:08:35,369 - INFO -  step: 350  loss:  2.7809  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank0]:2025-12-01 06:08:35,359 - INFO - Avg. fwd time: 8.3850 / Avg. bwd time: 16.2674 / Avg. batch time: 543.1178 (ms) / GPU bubble ratio: 63.69%
[rank0]:2025-12-01 06:08:35,395 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1013  memory: 13.29GiB(27.97%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank2]:2025-12-01 06:08:35,381 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1013  memory:  6.51GiB(13.70%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank1]:2025-12-01 06:08:35,384 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1013  memory:  9.36GiB(19.71%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank3]:2025-12-01 06:10:18,097 - INFO - Avg. fwd time: 14.6266 / Avg. bwd time: 29.8490 / Avg. batch time: 438.1081 (ms) / GPU bubble ratio: 18.79%
[rank2]:2025-12-01 06:10:18,123 - INFO - Avg. fwd time: 7.8414 / Avg. bwd time: 17.7734 / Avg. batch time: 468.7524 (ms) / GPU bubble ratio: 56.28%
[rank1]:2025-12-01 06:10:18,154 - INFO - Avg. fwd time: 10.1944 / Avg. bwd time: 21.4542 / Avg. batch time: 506.5808 (ms) / GPU bubble ratio: 50.02%
[rank0]:2025-12-01 06:10:18,181 - INFO - Avg. fwd time: 8.4027 / Avg. bwd time: 15.9539 / Avg. batch time: 540.0107 (ms) / GPU bubble ratio: 63.92%
[rank0]:2025-12-01 06:11:56,876 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 06:12:00,978 - INFO - Avg. fwd time: 7.8485 / Avg. bwd time: 17.7373 / Avg. batch time: 466.1779 (ms) / GPU bubble ratio: 56.09%
[rank3]:2025-12-01 06:12:00,952 - INFO - Avg. fwd time: 14.6618 / Avg. bwd time: 29.5004 / Avg. batch time: 435.5912 (ms) / GPU bubble ratio: 18.89%
[rank3]:2025-12-01 06:12:01,047 - INFO -  step: 400  loss:  2.8053  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 7,966  tflops: 62.27  mfu: 19.96%
[rank1]:2025-12-01 06:12:01,009 - INFO - Avg. fwd time: 10.2075 / Avg. bwd time: 21.3766 / Avg. batch time: 503.9796 (ms) / GPU bubble ratio: 49.86%
[rank0]:2025-12-01 06:12:01,037 - INFO - Avg. fwd time: 8.4186 / Avg. bwd time: 15.6670 / Avg. batch time: 537.3190 (ms) / GPU bubble ratio: 64.14%
[rank0]:2025-12-01 06:12:01,072 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0565  memory: 13.29GiB(27.97%)  tps: 7,966  tflops: 62.27  mfu: 19.96%
[rank2]:2025-12-01 06:12:01,058 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0565  memory:  6.51GiB(13.70%)  tps: 7,966  tflops: 62.27  mfu: 19.96%
[rank2]:2025-12-01 06:12:01,124 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0612_stage2_step400.svg
[rank1]:2025-12-01 06:12:01,062 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0565  memory:  9.36GiB(19.71%)  tps: 7,966  tflops: 62.27  mfu: 19.96%
[rank1]:2025-12-01 06:12:01,124 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0612_stage1_step400.svg
[rank0]:2025-12-01 06:12:01,124 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0612_stage0_step400.svg
[rank3]:2025-12-01 06:12:01,206 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0612_real_step400_rank3.svg
[rank3]:			> Batch Time: 496.69 ms, GPU Bubble Ratio: 67.65%, 50.65%, 59.45%, 36.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  110-8-118ms    | [S0,MB1,B]  171-0-171ms    | [S0,MB5,F]  171-6-177ms    | [S0,MB2,B]  231-0-231ms    | [S0,MB6,F]  231-6-238ms    | [S0,MB3,B]  293-0-293ms    | [S0,MB7,F]  293-6-300ms    | [S0,MB4,B]  343-26-369ms   | [S0,MB5,B]  390-25-416ms   | [S0,MB6,B]  437-20-457ms   | [S0,MB7,B]  477-19-496ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  154-11-165ms   | [S1,MB4,F]  169-8-178ms    | [S1,MB2,B]  214-11-225ms   | [S1,MB5,F]  229-9-238ms    | [S1,MB3,B]  263-25-288ms   | [S1,MB6,F]  292-9-301ms    | [S1,MB4,B]  312-26-338ms   | [S1,MB7,F]  341-9-351ms    | [S1,MB5,B]  360-26-387ms   | [S1,MB6,B]  407-26-433ms   | [S1,MB7,B]  451-22-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  139-9-148ms    | [S2,MB3,F]  152-7-159ms    | [S2,MB2,B]  188-20-209ms   | [S2,MB4,F]  212-7-219ms    | [S2,MB3,B]  237-20-258ms   | [S2,MB5,F]  261-7-268ms    | [S2,MB4,B]  286-20-306ms   | [S2,MB6,F]  310-7-317ms    | [S2,MB5,B]  335-20-355ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  383-20-404ms   | [S2,MB7,B]  430-17-447ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-35-134ms    | [S3,MB2,F]  138-15-153ms   | [S3,MB2,B]  160-22-183ms   | [S3,MB3,F]  187-15-202ms   | [S3,MB3,B]  209-22-232ms   | [S3,MB4,F]  236-15-251ms   | [S3,MB4,B]  258-22-281ms   | [S3,MB5,F]  285-15-300ms   | [S3,MB5,B]  307-22-330ms   | [S3,MB6,F]  333-15-348ms   | [S3,MB6,B]  356-22-378ms   | [S3,MB7,F]  382-15-397ms   | [S3,MB7,B]  404-22-427ms  
[rank3]:2025-12-01 06:12:01,252 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0612_stage3_step400.svg
[rank3]:2025-12-01 06:12:24,585 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-01 06:12:24,723 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-01 06:12:24,748 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-01 06:12:24,770 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-01 06:13:42,989 - INFO - Avg. fwd time: 14.6890 / Avg. bwd time: 29.1637 / Avg. batch time: 433.1038 (ms) / GPU bubble ratio: 19.00%
[rank2]:2025-12-01 06:13:43,016 - INFO - Avg. fwd time: 7.8544 / Avg. bwd time: 17.7053 / Avg. batch time: 463.6671 (ms) / GPU bubble ratio: 55.90%
[rank1]:2025-12-01 06:13:43,047 - INFO - Avg. fwd time: 10.2187 / Avg. bwd time: 21.3090 / Avg. batch time: 501.4475 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-12-01 06:13:43,075 - INFO - Avg. fwd time: 8.4315 / Avg. bwd time: 15.4249 / Avg. batch time: 534.7036 (ms) / GPU bubble ratio: 64.31%
[rank0]:2025-12-01 06:15:21,547 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 06:15:25,578 - INFO - Avg. fwd time: 7.8593 / Avg. bwd time: 17.6773 / Avg. batch time: 461.5835 (ms) / GPU bubble ratio: 55.74%
[rank1]:2025-12-01 06:15:25,609 - INFO - Avg. fwd time: 10.2286 / Avg. bwd time: 21.2492 / Avg. batch time: 499.3470 (ms) / GPU bubble ratio: 49.57%
[rank3]:2025-12-01 06:15:25,551 - INFO - Avg. fwd time: 14.7141 / Avg. bwd time: 28.8853 / Avg. batch time: 431.0671 (ms) / GPU bubble ratio: 19.09%
[rank0]:2025-12-01 06:15:25,637 - INFO - Avg. fwd time: 8.4430 / Avg. bwd time: 15.1974 / Avg. batch time: 532.5313 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-12-01 06:15:25,673 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1013  memory: 13.29GiB(27.97%)  tps: 8,008  tflops: 62.60  mfu: 20.06%
[rank2]:2025-12-01 06:15:25,659 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1013  memory:  6.51GiB(13.70%)  tps: 8,008  tflops: 62.60  mfu: 20.06%
[rank1]:2025-12-01 06:15:25,662 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1013  memory:  9.36GiB(19.71%)  tps: 8,008  tflops: 62.60  mfu: 20.06%
[rank3]:2025-12-01 06:15:25,648 - INFO -  step: 450  loss:  2.7791  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,008  tflops: 62.60  mfu: 20.06%
[rank2]:2025-12-01 06:17:07,411 - INFO - Avg. fwd time: 7.8638 / Avg. bwd time: 17.6522 / Avg. batch time: 459.5284 (ms) / GPU bubble ratio: 55.58%
[rank3]:2025-12-01 06:17:07,384 - INFO - Avg. fwd time: 14.7342 / Avg. bwd time: 28.6147 / Avg. batch time: 429.0537 (ms) / GPU bubble ratio: 19.17%
[rank1]:2025-12-01 06:17:07,443 - INFO - Avg. fwd time: 10.2370 / Avg. bwd time: 21.1955 / Avg. batch time: 497.2710 (ms) / GPU bubble ratio: 49.43%
[rank0]:2025-12-01 06:17:07,471 - INFO - Avg. fwd time: 8.4535 / Avg. bwd time: 14.9963 / Avg. batch time: 530.3902 (ms) / GPU bubble ratio: 64.63%
[rank0]:2025-12-01 06:18:45,363 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 06:18:49,294 - INFO - Avg. fwd time: 14.7533 / Avg. bwd time: 28.3702 / Avg. batch time: 427.2418 (ms) / GPU bubble ratio: 19.25%
[rank0]:2025-12-01 06:18:49,382 - INFO - Avg. fwd time: 8.4627 / Avg. bwd time: 14.8155 / Avg. batch time: 528.4702 (ms) / GPU bubble ratio: 64.76%
[rank2]:2025-12-01 06:18:49,321 - INFO - Avg. fwd time: 7.8682 / Avg. bwd time: 17.6306 / Avg. batch time: 457.6810 (ms) / GPU bubble ratio: 55.43%
[rank3]:2025-12-01 06:18:49,392 - INFO -  step: 500  loss:  2.7682  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,042  tflops: 62.87  mfu: 20.15%
[rank1]:2025-12-01 06:18:49,353 - INFO - Avg. fwd time: 10.2449 / Avg. bwd time: 21.1482 / Avg. batch time: 495.4097 (ms) / GPU bubble ratio: 49.31%
[rank1]:2025-12-01 06:18:49,407 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1131  memory:  9.36GiB(19.71%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank0]:2025-12-01 06:18:49,418 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1131  memory: 13.29GiB(27.97%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank0]:2025-12-01 06:18:49,467 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0618_stage0_step500.svg
[rank2]:2025-12-01 06:18:49,404 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1131  memory:  6.51GiB(13.70%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank2]:2025-12-01 06:18:49,465 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0618_stage2_step500.svg
[rank1]:2025-12-01 06:18:49,466 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0618_stage1_step500.svg
[rank3]:2025-12-01 06:18:49,556 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0618_real_step500_rank3.svg
[rank3]:			> Batch Time: 484.83 ms, GPU Bubble Ratio: 66.77%, 49.39%, 58.42%, 37.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  162-0-162ms    | [S0,MB5,F]  162-6-168ms    | [S0,MB2,B]  221-0-221ms    | [S0,MB6,F]  221-6-227ms    | [S0,MB3,B]  283-0-283ms    | [S0,MB7,F]  283-6-290ms    | [S0,MB4,B]  332-26-358ms   | [S0,MB5,B]  379-25-404ms   | [S0,MB6,B]  425-20-446ms   | [S0,MB7,B]  465-19-484ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  144-11-156ms   | [S1,MB4,F]  160-9-169ms    | [S1,MB2,B]  203-11-215ms   | [S1,MB5,F]  219-9-228ms    | [S1,MB3,B]  252-25-277ms   | [S1,MB6,F]  281-9-290ms    | [S1,MB4,B]  300-26-326ms   | [S1,MB7,F]  330-9-340ms    | [S1,MB5,B]  349-26-375ms   | [S1,MB6,B]  395-26-421ms   | [S1,MB7,B]  440-22-462ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  130-9-139ms    | [S2,MB3,F]  143-7-150ms    | [S2,MB2,B]  178-20-199ms   | [S2,MB4,F]  202-7-209ms    | [S2,MB3,B]  226-20-246ms   | [S2,MB5,F]  250-7-257ms    | [S2,MB4,B]  275-20-295ms   | [S2,MB6,F]  299-7-306ms    | [S2,MB5,B]  323-20-343ms   | [S2,MB7,F]  347-7-354ms    | [S2,MB6,B]  372-20-392ms   | [S2,MB7,B]  419-17-436ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-26-125ms    | [S3,MB2,F]  128-14-143ms   | [S3,MB2,B]  151-22-173ms   | [S3,MB3,F]  177-15-192ms   | [S3,MB3,B]  199-22-221ms   | [S3,MB4,F]  225-15-240ms   | [S3,MB4,B]  247-22-269ms   | [S3,MB5,F]  273-15-289ms   | [S3,MB5,B]  295-22-318ms   | [S3,MB6,F]  322-15-337ms   | [S3,MB6,B]  344-22-367ms   | [S3,MB7,F]  370-15-386ms   | [S3,MB7,B]  393-22-415ms  
[rank3]:2025-12-01 06:18:49,599 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0618_stage3_step500.svg
[rank2]:2025-12-01 06:20:31,126 - INFO - Avg. fwd time: 7.8722 / Avg. bwd time: 17.6107 / Avg. batch time: 455.9716 (ms) / GPU bubble ratio: 55.29%
[rank3]:2025-12-01 06:20:31,098 - INFO - Avg. fwd time: 14.7696 / Avg. bwd time: 28.1422 / Avg. batch time: 425.5412 (ms) / GPU bubble ratio: 19.33%
[rank0]:2025-12-01 06:20:31,187 - INFO - Avg. fwd time: 8.4713 / Avg. bwd time: 14.6693 / Avg. batch time: 526.6966 (ms) / GPU bubble ratio: 64.85%
[rank1]:2025-12-01 06:20:31,157 - INFO - Avg. fwd time: 10.2520 / Avg. bwd time: 21.1053 / Avg. batch time: 493.6888 (ms) / GPU bubble ratio: 49.19%
[rank0]:2025-12-01 06:22:09,639 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 06:22:13,729 - INFO - Avg. fwd time: 7.8757 / Avg. bwd time: 17.5930 / Avg. batch time: 454.6053 (ms) / GPU bubble ratio: 55.18%
[rank3]:2025-12-01 06:22:13,701 - INFO - Avg. fwd time: 14.7878 / Avg. bwd time: 27.9578 / Avg. batch time: 424.2053 (ms) / GPU bubble ratio: 19.39%
[rank1]:2025-12-01 06:22:13,761 - INFO - Avg. fwd time: 10.2586 / Avg. bwd time: 21.0664 / Avg. batch time: 492.3115 (ms) / GPU bubble ratio: 49.10%
[rank1]:2025-12-01 06:22:13,815 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0827  memory:  9.36GiB(19.71%)  tps: 8,015  tflops: 62.66  mfu: 20.08%
[rank2]:2025-12-01 06:22:13,812 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0827  memory:  6.51GiB(13.70%)  tps: 8,015  tflops: 62.66  mfu: 20.08%
[rank0]:2025-12-01 06:22:13,790 - INFO - Avg. fwd time: 8.4791 / Avg. bwd time: 14.5282 / Avg. batch time: 525.2722 (ms) / GPU bubble ratio: 64.96%
[rank0]:2025-12-01 06:22:13,827 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0827  memory: 13.29GiB(27.97%)  tps: 8,015  tflops: 62.66  mfu: 20.08%
[rank3]:2025-12-01 06:22:13,801 - INFO -  step: 550  loss:  2.7411  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,015  tflops: 62.66  mfu: 20.08%
[rank1]:2025-12-01 06:23:56,697 - INFO - Avg. fwd time: 10.2644 / Avg. bwd time: 21.0308 / Avg. batch time: 491.1225 (ms) / GPU bubble ratio: 49.02%
[rank2]:2025-12-01 06:23:56,664 - INFO - Avg. fwd time: 7.8790 / Avg. bwd time: 17.5764 / Avg. batch time: 453.4263 (ms) / GPU bubble ratio: 55.09%
[rank3]:2025-12-01 06:23:56,636 - INFO - Avg. fwd time: 14.8056 / Avg. bwd time: 27.7969 / Avg. batch time: 423.0544 (ms) / GPU bubble ratio: 19.44%
[rank0]:2025-12-01 06:23:56,727 - INFO - Avg. fwd time: 8.4860 / Avg. bwd time: 14.3907 / Avg. batch time: 524.0394 (ms) / GPU bubble ratio: 65.08%
[rank0]:2025-12-01 06:25:35,511 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 06:25:39,628 - INFO - Avg. fwd time: 7.8820 / Avg. bwd time: 17.5616 / Avg. batch time: 452.3587 (ms) / GPU bubble ratio: 55.00%
[rank3]:2025-12-01 06:25:39,599 - INFO - Avg. fwd time: 14.8224 / Avg. bwd time: 27.6503 / Avg. batch time: 422.0124 (ms) / GPU bubble ratio: 19.49%
[rank1]:2025-12-01 06:25:39,660 - INFO - Avg. fwd time: 10.2698 / Avg. bwd time: 20.9981 / Avg. batch time: 490.0448 (ms) / GPU bubble ratio: 48.96%
[rank1]:2025-12-01 06:25:39,715 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0887  memory:  9.36GiB(19.71%)  tps: 7,957  tflops: 62.21  mfu: 19.94%
[rank0]:2025-12-01 06:25:39,690 - INFO - Avg. fwd time: 8.4924 / Avg. bwd time: 14.2651 / Avg. batch time: 522.9212 (ms) / GPU bubble ratio: 65.18%
[rank0]:2025-12-01 06:25:39,726 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0887  memory: 13.29GiB(27.97%)  tps: 7,957  tflops: 62.21  mfu: 19.94%
[rank2]:2025-12-01 06:25:39,712 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0887  memory:  6.51GiB(13.70%)  tps: 7,957  tflops: 62.21  mfu: 19.94%
[rank3]:2025-12-01 06:25:39,700 - INFO -  step: 600  loss:  2.7497  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 7,957  tflops: 62.21  mfu: 19.94%
[rank1]:2025-12-01 06:25:39,776 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0625_stage1_step600.svg
[rank0]:2025-12-01 06:25:39,775 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0625_stage0_step600.svg
[rank2]:2025-12-01 06:25:39,776 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0625_stage2_step600.svg
[rank3]:2025-12-01 06:25:39,861 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0625_real_step600_rank3.svg
[rank3]:			> Batch Time: 497.09 ms, GPU Bubble Ratio: 67.59%, 50.67%, 59.44%, 36.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  170-0-170ms    | [S0,MB5,F]  170-6-177ms    | [S0,MB2,B]  231-0-231ms    | [S0,MB6,F]  231-6-237ms    | [S0,MB3,B]  294-0-294ms    | [S0,MB7,F]  294-6-300ms    | [S0,MB4,B]  343-26-369ms   | [S0,MB5,B]  390-25-416ms   | [S0,MB6,B]  437-20-458ms   | [S0,MB7,B]  478-19-497ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  153-11-165ms   | [S1,MB4,F]  169-8-178ms    | [S1,MB2,B]  213-11-225ms   | [S1,MB5,F]  229-9-238ms    | [S1,MB3,B]  263-25-288ms   | [S1,MB6,F]  292-9-301ms    | [S1,MB4,B]  312-26-338ms   | [S1,MB7,F]  341-9-351ms    | [S1,MB5,B]  360-26-387ms   | [S1,MB6,B]  407-26-433ms   | [S1,MB7,B]  452-22-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  139-9-148ms    | [S2,MB3,F]  152-7-159ms    | [S2,MB2,B]  188-20-209ms   | [S2,MB4,F]  212-7-219ms    | [S2,MB3,B]  237-20-258ms   | [S2,MB5,F]  261-7-268ms    | [S2,MB4,B]  286-20-307ms   | [S2,MB6,F]  310-7-317ms    | [S2,MB5,B]  335-20-355ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  384-20-404ms   | [S2,MB7,B]  431-17-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-35-134ms    | [S3,MB2,F]  137-15-153ms   | [S3,MB2,B]  160-22-183ms   | [S3,MB3,F]  187-15-202ms   | [S3,MB3,B]  209-22-232ms   | [S3,MB4,F]  236-15-251ms   | [S3,MB4,B]  258-22-281ms   | [S3,MB5,F]  285-15-300ms   | [S3,MB5,B]  307-22-330ms   | [S3,MB6,F]  333-15-349ms   | [S3,MB6,B]  356-22-379ms   | [S3,MB7,F]  382-15-397ms   | [S3,MB7,B]  405-22-428ms  
[rank3]:2025-12-01 06:25:39,904 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0625_stage3_step600.svg
[rank3]:2025-12-01 06:27:22,589 - INFO - Avg. fwd time: 14.8378 / Avg. bwd time: 27.5131 / Avg. batch time: 421.0348 (ms) / GPU bubble ratio: 19.53%
[rank1]:2025-12-01 06:27:22,651 - INFO - Avg. fwd time: 10.2748 / Avg. bwd time: 20.9687 / Avg. batch time: 489.0554 (ms) / GPU bubble ratio: 48.89%
[rank2]:2025-12-01 06:27:22,618 - INFO - Avg. fwd time: 7.8847 / Avg. bwd time: 17.5480 / Avg. batch time: 451.3770 (ms) / GPU bubble ratio: 54.92%
[rank0]:2025-12-01 06:27:22,681 - INFO - Avg. fwd time: 8.4982 / Avg. bwd time: 14.1501 / Avg. batch time: 521.8940 (ms) / GPU bubble ratio: 65.28%
[rank0]:2025-12-01 06:29:00,769 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 06:29:04,813 - INFO - Avg. fwd time: 7.8872 / Avg. bwd time: 17.5357 / Avg. batch time: 450.3149 (ms) / GPU bubble ratio: 54.84%
[rank3]:2025-12-01 06:29:04,784 - INFO - Avg. fwd time: 14.8495 / Avg. bwd time: 27.3720 / Avg. batch time: 419.9948 (ms) / GPU bubble ratio: 19.58%
[rank1]:2025-12-01 06:29:04,846 - INFO - Avg. fwd time: 10.2796 / Avg. bwd time: 20.9416 / Avg. batch time: 487.9867 (ms) / GPU bubble ratio: 48.82%
[rank0]:2025-12-01 06:29:04,877 - INFO - Avg. fwd time: 8.5036 / Avg. bwd time: 14.0436 / Avg. batch time: 520.7909 (ms) / GPU bubble ratio: 65.36%
[rank0]:2025-12-01 06:29:04,912 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0772  memory: 13.29GiB(27.97%)  tps: 7,985  tflops: 62.42  mfu: 20.01%
[rank2]:2025-12-01 06:29:04,898 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0772  memory:  6.51GiB(13.70%)  tps: 7,985  tflops: 62.42  mfu: 20.01%
[rank3]:2025-12-01 06:29:04,887 - INFO -  step: 650  loss:  2.7627  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 7,985  tflops: 62.42  mfu: 20.01%
[rank1]:2025-12-01 06:29:04,902 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0772  memory:  9.36GiB(19.71%)  tps: 7,985  tflops: 62.42  mfu: 20.01%
[rank2]:2025-12-01 06:30:47,256 - INFO - Avg. fwd time: 7.8895 / Avg. bwd time: 17.5242 / Avg. batch time: 449.3876 (ms) / GPU bubble ratio: 54.76%
[rank3]:2025-12-01 06:30:47,226 - INFO - Avg. fwd time: 14.8610 / Avg. bwd time: 27.2477 / Avg. batch time: 419.0879 (ms) / GPU bubble ratio: 19.62%
[rank1]:2025-12-01 06:30:47,290 - INFO - Avg. fwd time: 10.2835 / Avg. bwd time: 20.9162 / Avg. batch time: 487.0519 (ms) / GPU bubble ratio: 48.75%
[rank0]:2025-12-01 06:30:47,320 - INFO - Avg. fwd time: 8.5084 / Avg. bwd time: 13.9440 / Avg. batch time: 519.8233 (ms) / GPU bubble ratio: 65.45%
[rank0]:2025-12-01 06:32:25,835 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 06:32:29,856 - INFO - Avg. fwd time: 14.8717 / Avg. bwd time: 27.1362 / Avg. batch time: 418.2780 (ms) / GPU bubble ratio: 19.66%
[rank1]:2025-12-01 06:32:29,920 - INFO - Avg. fwd time: 10.2873 / Avg. bwd time: 20.8929 / Avg. batch time: 486.2158 (ms) / GPU bubble ratio: 48.70%
[rank2]:2025-12-01 06:32:29,886 - INFO - Avg. fwd time: 7.8917 / Avg. bwd time: 17.5137 / Avg. batch time: 448.5594 (ms) / GPU bubble ratio: 54.69%
[rank2]:2025-12-01 06:32:29,972 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0957  memory:  6.51GiB(13.70%)  tps: 7,989  tflops: 62.46  mfu: 20.02%
[rank0]:2025-12-01 06:32:29,951 - INFO - Avg. fwd time: 8.5129 / Avg. bwd time: 13.8581 / Avg. batch time: 518.9583 (ms) / GPU bubble ratio: 65.51%
[rank0]:2025-12-01 06:32:29,986 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0957  memory: 13.29GiB(27.97%)  tps: 7,989  tflops: 62.46  mfu: 20.02%
[rank3]:2025-12-01 06:32:29,961 - INFO -  step: 700  loss:  2.7816  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 7,989  tflops: 62.46  mfu: 20.02%
[rank1]:2025-12-01 06:32:29,976 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0957  memory:  9.36GiB(19.71%)  tps: 7,989  tflops: 62.46  mfu: 20.02%
[rank1]:2025-12-01 06:32:30,037 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0632_stage1_step700.svg
[rank2]:2025-12-01 06:32:30,038 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0632_stage2_step700.svg
[rank0]:2025-12-01 06:32:30,038 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0632_stage0_step700.svg
[rank3]:2025-12-01 06:32:30,124 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0632_real_step700_rank3.svg
[rank3]:			> Batch Time: 498.06 ms, GPU Bubble Ratio: 67.04%, 50.72%, 59.50%, 36.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-118ms    | [S0,MB1,B]  171-0-171ms    | [S0,MB5,F]  171-6-178ms    | [S0,MB2,B]  232-0-232ms    | [S0,MB6,F]  232-6-239ms    | [S0,MB3,B]  295-0-295ms    | [S0,MB7,F]  295-6-301ms    | [S0,MB4,B]  344-26-370ms   | [S0,MB5,B]  391-25-417ms   | [S0,MB6,B]  438-23-462ms   | [S0,MB7,B]  479-19-498ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  154-11-166ms   | [S1,MB4,F]  170-9-179ms    | [S1,MB2,B]  215-11-227ms   | [S1,MB5,F]  230-9-239ms    | [S1,MB3,B]  264-25-290ms   | [S1,MB6,F]  293-9-302ms    | [S1,MB4,B]  313-26-339ms   | [S1,MB7,F]  342-9-352ms    | [S1,MB5,B]  361-26-388ms   | [S1,MB6,B]  409-26-435ms   | [S1,MB7,B]  453-22-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  140-9-149ms    | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  190-20-210ms   | [S2,MB4,F]  213-7-221ms    | [S2,MB3,B]  239-20-259ms   | [S2,MB5,F]  262-7-270ms    | [S2,MB4,B]  287-20-308ms   | [S2,MB6,F]  311-7-319ms    | [S2,MB5,B]  336-20-356ms   | [S2,MB7,F]  360-7-367ms    | [S2,MB6,B]  385-20-405ms   | [S2,MB7,B]  432-17-449ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-36-135ms    | [S3,MB2,F]  138-15-154ms   | [S3,MB2,B]  162-22-185ms   | [S3,MB3,F]  188-15-203ms   | [S3,MB3,B]  211-22-233ms   | [S3,MB4,F]  237-15-252ms   | [S3,MB4,B]  260-22-282ms   | [S3,MB5,F]  286-15-301ms   | [S3,MB5,B]  308-22-331ms   | [S3,MB6,F]  334-15-350ms   | [S3,MB6,B]  357-22-380ms   | [S3,MB7,F]  383-15-398ms   | [S3,MB7,B]  406-22-429ms  
[rank3]:2025-12-01 06:32:30,170 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0632_stage3_step700.svg
[rank3]:2025-12-01 06:34:12,222 - INFO - Avg. fwd time: 14.8813 / Avg. bwd time: 27.0235 / Avg. batch time: 417.4480 (ms) / GPU bubble ratio: 19.69%
[rank2]:2025-12-01 06:34:12,252 - INFO - Avg. fwd time: 7.8938 / Avg. bwd time: 17.5040 / Avg. batch time: 447.7299 (ms) / GPU bubble ratio: 54.62%
[rank1]:2025-12-01 06:34:12,286 - INFO - Avg. fwd time: 10.2910 / Avg. bwd time: 20.8712 / Avg. batch time: 485.3801 (ms) / GPU bubble ratio: 48.64%
[rank0]:2025-12-01 06:34:12,317 - INFO - Avg. fwd time: 8.5173 / Avg. bwd time: 13.7828 / Avg. batch time: 518.0957 (ms) / GPU bubble ratio: 65.57%
[rank0]:2025-12-01 06:35:51,288 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 06:35:55,360 - INFO - Avg. fwd time: 14.8925 / Avg. bwd time: 26.9343 / Avg. batch time: 416.8211 (ms) / GPU bubble ratio: 19.72%
[rank2]:2025-12-01 06:35:55,390 - INFO - Avg. fwd time: 7.8957 / Avg. bwd time: 17.4950 / Avg. batch time: 447.0866 (ms) / GPU bubble ratio: 54.57%
[rank1]:2025-12-01 06:35:55,425 - INFO - Avg. fwd time: 10.2943 / Avg. bwd time: 20.8506 / Avg. batch time: 484.7304 (ms) / GPU bubble ratio: 48.60%
[rank0]:2025-12-01 06:35:55,456 - INFO - Avg. fwd time: 8.5214 / Avg. bwd time: 13.7114 / Avg. batch time: 517.4211 (ms) / GPU bubble ratio: 65.63%
[rank3]:2025-12-01 06:35:55,467 - INFO -  step: 750  loss:  2.7353  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 7,973  tflops: 62.33  mfu: 19.98%
[rank2]:2025-12-01 06:35:55,478 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0984  memory:  6.51GiB(13.70%)  tps: 7,973  tflops: 62.33  mfu: 19.98%
[rank1]:2025-12-01 06:35:55,481 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0984  memory:  9.36GiB(19.71%)  tps: 7,973  tflops: 62.33  mfu: 19.98%
[rank0]:2025-12-01 06:35:55,492 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0984  memory: 13.29GiB(27.97%)  tps: 7,973  tflops: 62.33  mfu: 19.98%
[rank3]:2025-12-01 06:37:37,472 - INFO - Avg. fwd time: 14.9002 / Avg. bwd time: 26.8337 / Avg. batch time: 416.0753 (ms) / GPU bubble ratio: 19.76%
[rank2]:2025-12-01 06:37:37,503 - INFO - Avg. fwd time: 7.8976 / Avg. bwd time: 17.4865 / Avg. batch time: 446.3254 (ms) / GPU bubble ratio: 54.50%
[rank1]:2025-12-01 06:37:37,538 - INFO - Avg. fwd time: 10.2973 / Avg. bwd time: 20.8317 / Avg. batch time: 483.9635 (ms) / GPU bubble ratio: 48.54%
[rank0]:2025-12-01 06:37:37,570 - INFO - Avg. fwd time: 8.5249 / Avg. bwd time: 13.6360 / Avg. batch time: 516.6294 (ms) / GPU bubble ratio: 65.68%
[rank0]:2025-12-01 06:39:16,289 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 06:39:20,389 - INFO - Avg. fwd time: 14.9096 / Avg. bwd time: 26.7528 / Avg. batch time: 415.5013 (ms) / GPU bubble ratio: 19.78%
[rank2]:2025-12-01 06:39:20,421 - INFO - Avg. fwd time: 7.8994 / Avg. bwd time: 17.4785 / Avg. batch time: 445.7377 (ms) / GPU bubble ratio: 54.45%
[rank1]:2025-12-01 06:39:20,456 - INFO - Avg. fwd time: 10.3001 / Avg. bwd time: 20.8132 / Avg. batch time: 483.3683 (ms) / GPU bubble ratio: 48.51%
[rank1]:2025-12-01 06:39:20,513 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0664  memory:  9.36GiB(19.71%)  tps: 7,991  tflops: 62.47  mfu: 20.02%
[rank1]:2025-12-01 06:39:20,514 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0664  tps: 8,146  tflops: 63.68  mfu: 18.67%
[rank1]:2025-12-01 06:39:20,514 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-01 06:39:20,515 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-01 06:39:20,488 - INFO - Avg. fwd time: 8.5285 / Avg. bwd time: 13.5723 / Avg. batch time: 516.0125 (ms) / GPU bubble ratio: 65.74%
[rank0]:2025-12-01 06:39:20,524 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0664  memory: 13.29GiB(27.97%)  tps: 7,991  tflops: 62.47  mfu: 20.02%
[rank0]:2025-12-01 06:39:20,524 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0664  tps: 8,146  tflops: 63.68  mfu: 18.66%
[rank0]:2025-12-01 06:39:20,524 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-01 06:39:20,525 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-01 06:39:20,498 - INFO -  step: 800  loss:  2.7281  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 7,991  tflops: 62.47  mfu: 20.02%
[rank3]:2025-12-01 06:39:20,499 - INFO -  final step: 800  loss:  2.7281  grad_norm:  0.0000  tps: 8,151  tflops: 63.72  mfu: 18.80%
[rank3]:2025-12-01 06:39:20,499 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-01 06:39:20,500 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-01 06:39:20,510 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0664  memory:  6.51GiB(13.70%)  tps: 7,991  tflops: 62.47  mfu: 20.02%
[rank2]:2025-12-01 06:39:20,510 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0664  tps: 8,146  tflops: 63.68  mfu: 18.67%
[rank2]:2025-12-01 06:39:20,510 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-01 06:39:20,511 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-01 06:39:22,413 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-01 06:39:22,484 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank2/251201_0639_stage2_final800.svg
[rank1]:2025-12-01 06:39:22,483 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank1/251201_0639_stage1_final800.svg
[rank0]:2025-12-01 06:39:22,484 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank0/251201_0639_stage0_final800.svg
[rank3]:2025-12-01 06:39:22,565 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0639_real_final800_rank3.svg
[rank3]:			> Batch Time: 496.92 ms, GPU Bubble Ratio: 67.59%, 50.72%, 59.51%, 36.58%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  171-0-171ms    | [S0,MB5,F]  171-6-177ms    | [S0,MB2,B]  231-0-231ms    | [S0,MB6,F]  231-6-238ms    | [S0,MB3,B]  294-0-294ms    | [S0,MB7,F]  294-6-301ms    | [S0,MB4,B]  343-26-369ms   | [S0,MB5,B]  390-25-416ms   | [S0,MB6,B]  437-20-458ms   | [S0,MB7,B]  477-19-496ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-105ms    | [S1,MB3,F]  108-11-120ms   | [S1,MB1,B]  154-11-165ms   | [S1,MB4,F]  169-9-178ms    | [S1,MB2,B]  214-11-226ms   | [S1,MB5,F]  229-9-238ms    | [S1,MB3,B]  263-25-289ms   | [S1,MB6,F]  292-9-302ms    | [S1,MB4,B]  312-26-338ms   | [S1,MB7,F]  341-9-351ms    | [S1,MB5,B]  361-26-387ms   | [S1,MB6,B]  407-25-433ms   | [S1,MB7,B]  451-22-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  139-9-148ms    | [S2,MB3,F]  152-7-159ms    | [S2,MB2,B]  189-20-209ms   | [S2,MB4,F]  212-7-219ms    | [S2,MB3,B]  238-20-258ms   | [S2,MB5,F]  261-7-269ms    | [S2,MB4,B]  286-20-307ms   | [S2,MB6,F]  310-7-318ms    | [S2,MB5,B]  335-20-355ms   | [S2,MB7,F]  359-7-366ms    | [S2,MB6,B]  384-20-404ms   | [S2,MB7,B]  431-17-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  99-35-134ms    | [S3,MB2,F]  137-15-153ms   | [S3,MB2,B]  161-22-183ms   | [S3,MB3,F]  187-15-202ms   | [S3,MB3,B]  209-22-232ms   | [S3,MB4,F]  236-15-251ms   | [S3,MB4,B]  258-22-281ms   | [S3,MB5,F]  285-15-300ms   | [S3,MB5,B]  307-22-330ms   | [S3,MB6,F]  334-15-349ms   | [S3,MB6,B]  356-22-379ms   | [S3,MB7,F]  382-15-397ms   | [S3,MB7,B]  405-22-428ms  
[rank1]:2025-12-01 06:39:22,628 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251201_0639_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank0]:2025-12-01 06:39:22,639 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251201_0639_rank0_stage0.svg
[rank0]:	> Counts Sum: 332000, Total Sum: 1728640 (19.21%), Ratio(%) per element: [22.6, 23.11, 22.08, 22.94, 22.77, 20.54, 20.89, 21.74, 20.89, 22.26, 21.74, 21.23, 20.71, 21.57, 21.06, 20.37, 19.34, 20.03, 19.86, 19.69, 19.52, 18.15, 18.15, 18.66, 17.29, 19.17, 17.63, 17.63, 15.92, 16.95, 15.58, 16.09, 15.58, 15.58, 13.86, 15.75, 13.52]
[rank2]:2025-12-01 06:39:22,634 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251201_0639_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank3]:2025-12-01 06:39:22,696 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/pipeline_schedule/251201_0639_thry_final800_rank3.svg
[rank3]:			> Batch Time: 346.57 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-21ms     | [S0,MB2,F]  21-10-31ms     | [S0,MB3,F]  31-10-42ms     | [S0,MB0,B]  105-21-126ms   | [S0,MB4,F]  126-10-136ms   | [S0,MB1,B]  136-21-157ms   | [S0,MB5,F]  157-10-168ms   | [S0,MB2,B]  168-21-189ms   | [S0,MB6,F]  189-10-199ms   | [S0,MB3,B]  199-21-220ms   | [S0,MB7,F]  220-10-231ms   | [S0,MB4,B]  231-21-252ms   | [S0,MB5,B]  262-21-283ms   | [S0,MB6,B]  294-21-315ms   | [S0,MB7,B]  325-21-346ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-21ms     | [S1,MB1,F]  21-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB0,B]  84-21-105ms    | [S1,MB3,F]  105-10-115ms   | [S1,MB1,B]  115-21-136ms   | [S1,MB4,F]  136-10-147ms   | [S1,MB2,B]  147-21-168ms   | [S1,MB5,F]  168-10-178ms   | [S1,MB3,B]  178-21-199ms   | [S1,MB6,F]  199-10-210ms   | [S1,MB4,B]  210-21-231ms   | [S1,MB7,F]  231-10-241ms   | [S1,MB5,B]  241-21-262ms   | [S1,MB6,B]  273-21-294ms   | [S1,MB7,B]  304-21-325ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-10-31ms     | [S2,MB1,F]  31-10-42ms     | [S2,MB0,B]  63-21-84ms     | [S2,MB2,F]  84-10-94ms     | [S2,MB1,B]  94-21-115ms    | [S2,MB3,F]  115-10-126ms   | [S2,MB2,B]  126-21-147ms   | [S2,MB4,F]  147-10-157ms   | [S2,MB3,B]  157-21-178ms   | [S2,MB5,F]  178-10-189ms   | [S2,MB4,B]  189-21-210ms   | [S2,MB6,F]  210-10-220ms   | [S2,MB5,B]  220-21-241ms   | [S2,MB7,F]  241-10-252ms   | [S2,MB6,B]  252-21-273ms   | [S2,MB7,B]  283-21-304ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-42ms     | [S3,MB0,B]  42-21-63ms     | [S3,MB1,F]  63-10-73ms     | [S3,MB1,B]  73-21-94ms     | [S3,MB2,F]  94-10-105ms    | [S3,MB2,B]  105-21-126ms   | [S3,MB3,F]  126-10-136ms   | [S3,MB3,B]  136-21-157ms   | [S3,MB4,F]  157-10-168ms   | [S3,MB4,B]  168-21-189ms   | [S3,MB5,F]  189-10-199ms   | [S3,MB5,B]  199-21-220ms   | [S3,MB6,F]  220-10-231ms   | [S3,MB6,B]  231-21-252ms   | [S3,MB7,F]  252-10-262ms   | [S3,MB7,B]  262-21-283ms  
[rank3]:2025-12-01 06:39:22,743 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_ratio_history/rank3/251201_0639_stage3_final800.svg
[rank3]:2025-12-01 06:39:22,877 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/frozen_params_histogram/251201_0639_rank3_stage3.svg
[rank3]:	> Counts Sum: 1147840, Total Sum: 1354880 (84.72%), Ratio(%) per element: [85.78, 84.07, 83.56, 84.76, 85.61, 86.13, 83.39, 84.07, 85.61, 83.9, 85.1, 84.24, 85.78, 82.7, 84.93, 85.27, 86.13, 85.27, 84.24, 84.58, 86.98, 85.1, 83.9, 84.58, 84.41, 84.58, 84.07, 83.21, 84.76]
[rank2]:2025-12-01 06:39:24,480 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251201_0639_stage2.svg
[rank2]:2025-12-01 06:39:24,483 - INFO - Destroying the purge thread.
[rank1]:2025-12-01 06:39:24,481 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251201_0639_stage1.svg
[rank1]:2025-12-01 06:39:24,485 - INFO - Destroying the purge thread.
[rank0]:2025-12-01 06:39:24,495 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251201_0639_stage0.svg
[rank0]:2025-12-01 06:39:24,498 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-01 06:39:24,708 - INFO - Process group destroyed
[rank3]:2025-12-01 06:39:24,721 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1/afr_time_plot/251201_0639_stage3.svg
[rank3]:2025-12-01 06:39:24,725 - INFO - Destroying the purge thread.
[rank2]:2025-12-01 06:39:24,718 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 335-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–†â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–†â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.01997
[rank3]:wandb:               final/avg_loss 2.72809
[rank3]:wandb:             final/avg_mfu(%) 18.79825
[rank3]:wandb:             final/avg_tflops 63.72317
[rank3]:wandb:    final/avg_throughput(tps) 8151.30792
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 2.72809
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.72809
[rank3]:wandb: loss_metrics/global_max_loss 2.72809
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.9_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/e84pmu3j
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.9_42_dm1/20251201-0542/wandb/run-20251201_054222-e84pmu3j/logs
[rank3]:2025-12-01 06:39:26,286 - INFO - Process group destroyed
[rank0]:2025-12-01 06:39:26,498 - INFO - Training completed
[rank0]:2025-12-01 06:39:26,499 - INFO - Destroying the purge thread.
[rank0]:2025-12-01 06:39:26,750 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings', 'layers.2', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.6', 'layers.8', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.10', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.14', 'output', 'norm', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.9_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
