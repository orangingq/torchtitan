
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 01. (ì›”) 04:40:36 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.6_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.6) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.6
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-01 04:40:42,537 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-12-01 04:40:42,537 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-12-01 04:40:42,741 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank1]:2025-12-01 04:40:42,697 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-12-01 04:40:42,770 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-01 04:40:42,772 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-01 04:40:42,774 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 04:40:42,764 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-01 04:40:42,766 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-01 04:40:42,771 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-01 04:40:42,771 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 04:40:42,772 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-12-01 04:40:42,912 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-01 04:40:42,914 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-01 04:40:42,918 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank2]:2025-12-01 04:40:42,971 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-01 04:40:42,973 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-01 04:40:42,976 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-12-01 04:40:43,161 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-01 04:40:46,115 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-01 04:40:46,266 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-01 04:40:46,315 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 04:40:46,317 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-01 04:40:46,343 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-01 04:40:46,343 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-01 04:40:46,283 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-01 04:40:46,326 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-01 04:40:46,352 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-01 04:40:46,352 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-01 04:40:46,261 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-01 04:40:46,314 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 04:40:46,341 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-01 04:40:46,342 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-01 04:40:46,564 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-01 04:40:46,564 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-01 04:40:46,565 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-01 04:40:46,568 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-01 04:40:46,568 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-01 04:40:46,568 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-01 04:40:46,568 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-01 04:40:46,568 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-01 04:40:46,569 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run xkq6jr38
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.6_42_dm1/20251201-0440/wandb/run-20251201_044047-xkq6jr38
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/xkq6jr38
[rank3]:2025-12-01 04:40:48,341 - INFO - WandB logging enabled
[rank3]:2025-12-01 04:40:48,342 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-01 04:40:48,381 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-01 04:40:48,410 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-01 04:40:48,411 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-01 04:40:48,595 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-01 04:40:48,595 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-01 04:40:48,596 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-01 04:40:48,610 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-01 04:40:48,610 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 04:40:48,610 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank2]:2025-12-01 04:40:48,618 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 04:40:48,610 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-01 04:40:48,610 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-01 04:40:48,610 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-01 04:40:50,597 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-01 04:40:50,597 - INFO - Finished loading the checkpoint in 1.99 seconds.
[rank0]:2025-12-01 04:40:50,597 - INFO - Training starts at step 1
[rank2]:2025-12-01 04:40:56,432 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  4.59GiB(9.67%)  tps: 3,242  tflops: 25.35  mfu: 8.12%
[rank2]:2025-12-01 04:40:56,433 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-01 04:40:56,445 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 12.97GiB(27.31%)  tps: 4,065  tflops: 31.78  mfu: 10.19%
[rank3]:2025-12-01 04:40:56,446 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-01 04:40:56,435 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  6.72GiB(14.15%)  tps: 3,238  tflops: 25.31  mfu: 8.11%
[rank1]:2025-12-01 04:40:56,435 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-01 04:40:56,472 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  9.17GiB(19.29%)  tps: 3,226  tflops: 25.22  mfu: 8.08%
[rank0]:2025-12-01 04:40:56,473 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-01 04:43:04,802 - INFO - Avg. fwd time: 13.1726 / Avg. bwd time: 44.0353 / Avg. batch time: 539.4945 (ms) / GPU bubble ratio: 15.17%
[rank2]:2025-12-01 04:43:04,827 - INFO - Avg. fwd time: 7.4904 / Avg. bwd time: 19.8493 / Avg. batch time: 572.7955 (ms) / GPU bubble ratio: 61.82%
[rank0]:2025-12-01 04:43:04,887 - INFO - Avg. fwd time: 7.7796 / Avg. bwd time: 25.5869 / Avg. batch time: 652.8826 (ms) / GPU bubble ratio: 59.11%
[rank1]:2025-12-01 04:43:04,857 - INFO - Avg. fwd time: 9.6192 / Avg. bwd time: 25.0623 / Avg. batch time: 613.3048 (ms) / GPU bubble ratio: 54.76%
[rank0]:2025-12-01 04:45:13,828 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 04:45:19,073 - INFO - Avg. fwd time: 13.2411 / Avg. bwd time: 44.2105 / Avg. batch time: 541.3578 (ms) / GPU bubble ratio: 15.10%
[rank2]:2025-12-01 04:45:19,098 - INFO - Avg. fwd time: 7.4922 / Avg. bwd time: 19.8903 / Avg. batch time: 574.2937 (ms) / GPU bubble ratio: 61.86%
[rank1]:2025-12-01 04:45:19,127 - INFO - Avg. fwd time: 9.6266 / Avg. bwd time: 25.1252 / Avg. batch time: 614.4960 (ms) / GPU bubble ratio: 54.76%
[rank0]:2025-12-01 04:45:19,158 - INFO - Avg. fwd time: 7.7753 / Avg. bwd time: 25.6278 / Avg. batch time: 653.6801 (ms) / GPU bubble ratio: 59.12%
[rank0]:2025-12-01 04:45:19,194 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory: 12.97GiB(27.31%)  tps: 6,112  tflops: 47.78  mfu: 15.31%
[rank2]:2025-12-01 04:45:19,179 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  6.39GiB(13.45%)  tps: 6,111  tflops: 47.77  mfu: 15.31%
[rank1]:2025-12-01 04:45:19,183 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  8.99GiB(18.92%)  tps: 6,111  tflops: 47.77  mfu: 15.31%
[rank3]:2025-12-01 04:45:19,191 - INFO -  step: 50  loss:  9.9211  grad_norm: 12.8635  memory: 16.39GiB(34.50%)  tps: 6,111  tflops: 47.77  mfu: 15.31%
[rank3]:2025-12-01 04:46:12,839 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-01 04:47:06,706 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-01 04:47:06,834 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-01 04:47:25,085 - INFO - Avg. fwd time: 7.5971 / Avg. bwd time: 19.2090 / Avg. batch time: 563.7449 (ms) / GPU bubble ratio: 61.96%
[rank3]:2025-12-01 04:47:25,071 - INFO - Avg. fwd time: 13.3955 / Avg. bwd time: 42.8451 / Avg. batch time: 531.6408 (ms) / GPU bubble ratio: 15.37%
[rank0]:2025-12-01 04:47:25,107 - INFO - Avg. fwd time: 7.8699 / Avg. bwd time: 23.9517 / Avg. batch time: 640.3089 (ms) / GPU bubble ratio: 60.24%
[rank1]:2025-12-01 04:47:25,102 - INFO - Avg. fwd time: 9.7541 / Avg. bwd time: 24.2714 / Avg. batch time: 602.9628 (ms) / GPU bubble ratio: 54.86%
[rank3]:2025-12-01 04:47:43,325 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-01 04:47:43,501 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0447_max_batch_time.svg
[rank3]:			> Batch Time: 559.81 ms, GPU Bubble Ratio: 52.12%, 50.39%, 60.84%, 18.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-7-33ms      | [S0,MB0,B]  133-26-159ms   | [S0,MB4,F]  159-7-166ms    | [S0,MB1,B]  187-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  243-25-269ms   | [S0,MB6,F]  269-7-276ms    | [S0,MB3,B]  301-25-327ms   | [S0,MB7,F]  327-7-334ms    | [S0,MB4,B]  359-25-385ms   | [S0,MB5,B]  417-25-443ms   | [S0,MB6,B]  476-25-501ms   | [S0,MB7,B]  534-25-559ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-9-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-133ms   | [S1,MB3,F]  133-9-142ms    | [S1,MB1,B]  161-25-187ms   | [S1,MB4,F]  187-9-196ms    | [S1,MB2,B]  218-25-243ms   | [S1,MB5,F]  243-9-252ms    | [S1,MB3,B]  276-25-301ms   | [S1,MB6,F]  301-9-310ms    | [S1,MB4,B]  334-25-359ms   | [S1,MB7,F]  359-9-369ms    | [S1,MB5,B]  392-25-417ms   | [S1,MB6,B]  450-25-476ms   | [S1,MB7,B]  509-25-534ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  198-19-218ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  256-19-276ms   | [S2,MB5,F]  276-7-283ms    | [S2,MB4,B]  314-19-334ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  372-19-392ms   | [S2,MB7,F]  392-7-399ms    | [S2,MB6,B]  431-19-450ms   | [S2,MB7,B]  489-19-509ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-11-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-43-198ms   AFR(10):0.9655 | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  211-44-256ms   AFR(10):0.9655 | [S3,MB4,F]  256-13-269ms   | [S3,MB4,B]  269-44-314ms   AFR(10):0.9655 | [S3,MB5,F]  314-13-327ms   | [S3,MB5,B]  327-44-372ms   AFR(10):0.9655 | [S3,MB6,F]  372-13-386ms   | [S3,MB6,B]  386-44-431ms   AFR(10):0.9655 | [S3,MB7,F]  431-13-444ms   | [S3,MB7,B]  444-45-489ms   AFR(10):0.9655
[rank3]:2025-12-01 04:47:43,626 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0447_min_batch_time.svg
[rank3]:			> Batch Time: 338.80 ms, GPU Bubble Ratio: 81.71%, 49.64%, 60.44%, 15.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-7-33ms      | [S0,MB0,B]  88-0-88ms      | [S0,MB4,F]  88-7-95ms      | [S0,MB1,B]  122-0-122ms    | [S0,MB5,F]  122-7-129ms    | [S0,MB2,B]  157-0-157ms    | [S0,MB6,F]  157-7-164ms    | [S0,MB3,B]  193-0-193ms    | [S0,MB7,F]  193-7-200ms    | [S0,MB4,B]  229-0-229ms    | [S0,MB5,B]  266-0-266ms    | [S0,MB6,B]  302-0-302ms    | [S0,MB7,B]  338-0-338ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-9-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  76-11-88ms     | [S1,MB3,F]  88-9-97ms      | [S1,MB1,B]  110-11-122ms   | [S1,MB4,F]  122-9-131ms    | [S1,MB2,B]  145-11-157ms   | [S1,MB5,F]  157-9-166ms    | [S1,MB3,B]  181-11-193ms   | [S1,MB6,F]  193-9-203ms    | [S1,MB4,B]  217-11-229ms   | [S1,MB7,F]  229-9-239ms    | [S1,MB5,B]  254-11-266ms   | [S1,MB6,B]  291-11-302ms   | [S1,MB7,B]  327-11-338ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  67-9-76ms      | [S2,MB2,F]  76-7-83ms      | [S2,MB1,B]  100-9-110ms    | [S2,MB3,F]  110-7-117ms    | [S2,MB2,B]  136-9-145ms    | [S2,MB4,F]  145-7-152ms    | [S2,MB3,B]  172-9-181ms    | [S2,MB5,F]  181-7-189ms    | [S2,MB4,B]  208-9-217ms    | [S2,MB6,F]  217-7-225ms    | [S2,MB5,B]  245-9-254ms    | [S2,MB7,F]  254-7-261ms    | [S2,MB6,B]  281-9-291ms    | [S2,MB7,B]  317-9-327ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-22-67ms     AFR(10):0.9655 | [S3,MB1,F]  67-11-78ms     | [S3,MB1,B]  78-22-100ms    AFR(10):0.9655 | [S3,MB2,F]  100-12-113ms   | [S3,MB2,B]  113-22-136ms   AFR(10):0.9655 | [S3,MB3,F]  136-13-149ms   | [S3,MB3,B]  149-22-172ms   AFR(10):0.9655 | [S3,MB4,F]  172-13-185ms   | [S3,MB4,B]  185-22-208ms   AFR(10):0.9655 | [S3,MB5,F]  208-13-221ms   | [S3,MB5,B]  221-23-245ms   AFR(10):0.9655 | [S3,MB6,F]  245-13-258ms   | [S3,MB6,B]  258-22-281ms   AFR(10):0.9655 | [S3,MB7,F]  281-13-294ms   | [S3,MB7,B]  294-22-317ms   AFR(10):0.9655
[rank3]:2025-12-01 04:47:43,768 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0447_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 405.06 ms, GPU Bubble Ratio: 43.57%, 34.72%, 48.52%, 12.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-7-33ms      | [S0,MB0,B]  133-26-159ms   | [S0,MB4,F]  159-7-166ms    | [S0,MB1,B]  187-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  243-25-269ms   | [S0,MB6,F]  269-7-276ms    | [S0,MB3,B]  279-25-305ms   | [S0,MB7,F]  305-7-312ms    | [S0,MB4,B]  315-25-341ms   | [S0,MB5,B]  356-25-382ms   | [S0,MB6,B]  393-11-405ms   | [S0,MB7,B]  405-0-405ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-9-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-133ms   | [S1,MB3,F]  133-9-142ms    | [S1,MB1,B]  161-25-187ms   | [S1,MB4,F]  187-9-196ms    | [S1,MB2,B]  218-25-243ms   | [S1,MB5,F]  243-9-252ms    | [S1,MB3,B]  254-25-279ms   | [S1,MB6,F]  279-9-289ms    | [S1,MB4,B]  290-25-315ms   | [S1,MB7,F]  315-9-325ms    | [S1,MB5,B]  331-25-356ms   | [S1,MB6,B]  368-25-393ms   | [S1,MB7,B]  393-11-405ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  198-19-218ms   | [S2,MB4,F]  218-7-225ms    | [S2,MB3,B]  234-19-254ms   | [S2,MB5,F]  254-7-261ms    | [S2,MB4,B]  270-19-290ms   | [S2,MB6,F]  290-7-297ms    | [S2,MB5,B]  311-19-331ms   | [S2,MB7,F]  331-7-338ms    | [S2,MB6,B]  348-19-368ms   | [S2,MB7,B]  384-9-393ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-11-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-43-198ms   AFR(10):0.9655 | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  211-22-234ms   AFR(10):0.9655 | [S3,MB4,F]  234-13-247ms   | [S3,MB4,B]  247-22-270ms   AFR(10):0.9655 | [S3,MB5,F]  270-13-283ms   | [S3,MB5,B]  283-27-311ms   AFR(10):0.9655 | [S3,MB6,F]  311-13-325ms   | [S3,MB6,B]  325-22-348ms   AFR(10):0.9655 | [S3,MB7,F]  348-13-361ms   | [S3,MB7,B]  361-22-384ms   AFR(10):0.9655
[rank3]:2025-12-01 04:47:43,768 - INFO - 	> Batch Time: 405.06 ms (Average Freeze Ratio: 0.26, Time Reduction Rate: 0.28)
[rank0]:2025-12-01 04:49:15,234 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 04:49:20,332 - INFO - Avg. fwd time: 7.7093 / Avg. bwd time: 18.4876 / Avg. batch time: 546.7029 (ms) / GPU bubble ratio: 61.67%
[rank2]:2025-12-01 04:49:20,339 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank3]:2025-12-01 04:49:20,308 - INFO - Avg. fwd time: 13.6327 / Avg. bwd time: 40.4841 / Avg. batch time: 514.9392 (ms) / GPU bubble ratio: 15.93%
[rank3]:2025-12-01 04:49:20,312 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.21(0.27)/0.80, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-01 04:49:20,389 - INFO - Avg. fwd time: 8.0249 / Avg. bwd time: 21.1212 / Avg. batch time: 620.3413 (ms) / GPU bubble ratio: 62.41%
[rank0]:2025-12-01 04:49:20,396 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.18)/0.54, [MB7] 0.27(0.33)/1.00
[rank2]:2025-12-01 04:49:20,410 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1801  memory:  6.51GiB(13.70%)  tps: 6,792  tflops: 53.10  mfu: 17.02%
[rank1]:2025-12-01 04:49:20,362 - INFO - Avg. fwd time: 9.9030 / Avg. bwd time: 23.1859 / Avg. batch time: 585.0658 (ms) / GPU bubble ratio: 54.76%
[rank1]:2025-12-01 04:49:20,369 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-01 04:49:20,414 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1801  memory:  9.36GiB(19.71%)  tps: 6,792  tflops: 53.10  mfu: 17.02%
[rank3]:2025-12-01 04:49:20,422 - INFO -  step: 100  loss:  8.6678  grad_norm:  8.1801  memory: 17.37GiB(36.56%)  tps: 6,792  tflops: 53.10  mfu: 17.02%
[rank0]:2025-12-01 04:49:20,425 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1801  memory: 12.97GiB(27.31%)  tps: 6,792  tflops: 53.10  mfu: 17.02%
[rank0]:2025-12-01 04:49:20,483 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0449_stage0_step100.svg
[rank2]:2025-12-01 04:49:20,483 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0449_stage2_step100.svg
[rank1]:2025-12-01 04:49:20,483 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0449_stage1_step100.svg
[rank3]:2025-12-01 04:49:20,563 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0449_real_step100_rank3.svg
[rank3]:			> Batch Time: 631.81 ms, GPU Bubble Ratio: 64.03%, 57.10%, 66.02%, 29.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  147-17-164ms   | [S0,MB4,F]  164-7-172ms    | [S0,MB1,B]  212-17-229ms   | [S0,MB5,F]  229-6-236ms    | [S0,MB2,B]  283-17-300ms   | [S0,MB6,F]  300-7-307ms    | [S0,MB3,B]  352-17-369ms   | [S0,MB7,F]  369-7-376ms    | [S0,MB4,B]  418-25-444ms   | [S0,MB5,B]  481-25-507ms   | [S0,MB6,B]  545-21-567ms   | [S0,MB7,B]  610-21-631ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  37-9-46ms      | [S1,MB0,B]  119-22-142ms   | [S1,MB3,F]  145-9-155ms    | [S1,MB1,B]  184-22-207ms   | [S1,MB4,F]  210-9-220ms    | [S1,MB2,B]  255-22-278ms   | [S1,MB5,F]  281-9-290ms    | [S1,MB3,B]  322-25-347ms   | [S1,MB6,F]  350-9-360ms    | [S1,MB4,B]  388-25-413ms   | [S1,MB7,F]  417-9-426ms    | [S1,MB5,B]  453-25-478ms   | [S1,MB6,B]  516-25-541ms   | [S1,MB7,B]  582-24-607ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  97-17-114ms    | [S2,MB2,F]  118-7-125ms    | [S2,MB1,B]  162-17-179ms   | [S2,MB3,F]  183-7-190ms    | [S2,MB2,B]  230-20-250ms   | [S2,MB4,F]  254-7-261ms    | [S2,MB3,B]  297-20-317ms   | [S2,MB5,F]  320-7-327ms    | [S2,MB4,B]  363-20-383ms   | [S2,MB6,F]  386-7-393ms    | [S2,MB5,B]  428-19-448ms   | [S2,MB7,F]  451-7-458ms    | [S2,MB6,B]  493-20-513ms   | [S2,MB7,B]  559-19-578ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-40-92ms     | [S3,MB1,F]  95-11-107ms    | [S3,MB1,B]  114-43-157ms   | [S3,MB2,F]  161-13-174ms   | [S3,MB2,B]  180-44-225ms   | [S3,MB3,F]  229-13-242ms   | [S3,MB3,B]  249-43-292ms   | [S3,MB4,F]  295-14-310ms   | [S3,MB4,B]  317-41-358ms   | [S3,MB5,F]  361-13-375ms   | [S3,MB5,B]  382-40-423ms   | [S3,MB6,F]  426-14-440ms   | [S3,MB6,B]  447-41-488ms   | [S3,MB7,F]  491-13-505ms   | [S3,MB7,B]  512-42-555ms  
[rank3]:2025-12-01 04:49:20,605 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0449_stage3_step100.svg
[rank3]:2025-12-01 04:51:25,151 - INFO - Avg. fwd time: 13.7204 / Avg. bwd time: 39.9918 / Avg. batch time: 511.8803 (ms) / GPU bubble ratio: 16.06%
[rank2]:2025-12-01 04:51:25,176 - INFO - Avg. fwd time: 7.6923 / Avg. bwd time: 18.5909 / Avg. batch time: 543.6987 (ms) / GPU bubble ratio: 61.33%
[rank1]:2025-12-01 04:51:25,205 - INFO - Avg. fwd time: 9.8950 / Avg. bwd time: 23.2401 / Avg. batch time: 582.1898 (ms) / GPU bubble ratio: 54.47%
[rank0]:2025-12-01 04:51:25,231 - INFO - Avg. fwd time: 8.0324 / Avg. bwd time: 21.2318 / Avg. batch time: 617.5666 (ms) / GPU bubble ratio: 62.09%
[rank0]:2025-12-01 04:53:21,251 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 04:53:25,883 - INFO - Avg. fwd time: 13.8151 / Avg. bwd time: 39.2660 / Avg. batch time: 506.9933 (ms) / GPU bubble ratio: 16.24%
[rank3]:2025-12-01 04:53:25,889 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.48(0.53)/0.80, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-01 04:53:25,908 - INFO - Avg. fwd time: 7.7046 / Avg. bwd time: 18.5068 / Avg. batch time: 538.6097 (ms) / GPU bubble ratio: 61.07%
[rank2]:2025-12-01 04:53:25,914 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-01 04:53:25,936 - INFO - Avg. fwd time: 9.9199 / Avg. bwd time: 23.0464 / Avg. batch time: 577.0336 (ms) / GPU bubble ratio: 54.30%
[rank1]:2025-12-01 04:53:25,943 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank1]:2025-12-01 04:53:25,990 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.7058  memory:  9.36GiB(19.71%)  tps: 6,672  tflops: 52.16  mfu: 16.72%
[rank0]:2025-12-01 04:53:25,965 - INFO - Avg. fwd time: 8.0773 / Avg. bwd time: 20.9977 / Avg. batch time: 612.3392 (ms) / GPU bubble ratio: 62.01%
[rank0]:2025-12-01 04:53:25,973 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.36)/0.54, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-01 04:53:26,001 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.7058  memory: 13.29GiB(27.97%)  tps: 6,672  tflops: 52.16  mfu: 16.72%
[rank3]:2025-12-01 04:53:25,999 - INFO -  step: 150  loss:  3.9340  grad_norm:  3.7058  memory: 17.37GiB(36.56%)  tps: 6,672  tflops: 52.16  mfu: 16.72%
[rank2]:2025-12-01 04:53:25,987 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.7058  memory:  6.51GiB(13.70%)  tps: 6,672  tflops: 52.16  mfu: 16.72%
[rank2]:2025-12-01 04:55:24,145 - INFO - Avg. fwd time: 7.7137 / Avg. bwd time: 18.4552 / Avg. batch time: 533.4678 (ms) / GPU bubble ratio: 60.76%
[rank3]:2025-12-01 04:55:24,120 - INFO - Avg. fwd time: 13.9062 / Avg. bwd time: 38.4839 / Avg. batch time: 501.9076 (ms) / GPU bubble ratio: 16.49%
[rank1]:2025-12-01 04:55:24,173 - INFO - Avg. fwd time: 9.9558 / Avg. bwd time: 22.8022 / Avg. batch time: 571.7995 (ms) / GPU bubble ratio: 54.17%
[rank0]:2025-12-01 04:55:24,199 - INFO - Avg. fwd time: 8.1228 / Avg. bwd time: 20.5274 / Avg. batch time: 606.8051 (ms) / GPU bubble ratio: 62.23%
[rank0]:2025-12-01 04:57:13,200 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 04:57:17,704 - INFO - Avg. fwd time: 13.9813 / Avg. bwd time: 37.5723 / Avg. batch time: 495.4862 (ms) / GPU bubble ratio: 16.76%
[rank3]:2025-12-01 04:57:17,709 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.76(0.80)/0.80, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-01 04:57:17,728 - INFO - Avg. fwd time: 7.7376 / Avg. bwd time: 18.3089 / Avg. batch time: 526.8834 (ms) / GPU bubble ratio: 60.45%
[rank2]:2025-12-01 04:57:17,735 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-01 04:57:17,757 - INFO - Avg. fwd time: 9.9968 / Avg. bwd time: 22.5175 / Avg. batch time: 565.0891 (ms) / GPU bubble ratio: 53.97%
[rank1]:2025-12-01 04:57:17,764 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-01 04:57:17,808 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.5571  memory:  9.36GiB(19.71%)  tps: 7,068  tflops: 55.25  mfu: 17.71%
[rank0]:2025-12-01 04:57:17,783 - INFO - Avg. fwd time: 8.1849 / Avg. bwd time: 19.8506 / Avg. batch time: 599.7806 (ms) / GPU bubble ratio: 62.61%
[rank0]:2025-12-01 04:57:17,790 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.51(0.54)/0.54, [MB7] 0.95(1.00)/1.00
[rank0]:2025-12-01 04:57:17,819 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.5571  memory: 13.29GiB(27.97%)  tps: 7,068  tflops: 55.25  mfu: 17.71%
[rank3]:2025-12-01 04:57:17,817 - INFO -  step: 200  loss:  1.3289  grad_norm:  2.5571  memory: 17.37GiB(36.56%)  tps: 7,068  tflops: 55.25  mfu: 17.71%
[rank2]:2025-12-01 04:57:17,804 - INFO -  step: 200  loss: -8.0000  grad_norm:  2.5571  memory:  6.51GiB(13.70%)  tps: 7,068  tflops: 55.25  mfu: 17.71%
[rank2]:2025-12-01 04:57:17,870 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0457_stage2_step200.svg
[rank1]:2025-12-01 04:57:17,870 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0457_stage1_step200.svg
[rank0]:2025-12-01 04:57:17,868 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0457_stage0_step200.svg
[rank3]:2025-12-01 04:57:17,955 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0457_real_step200_rank3.svg
[rank3]:			> Batch Time: 549.20 ms, GPU Bubble Ratio: 66.84%, 54.85%, 63.50%, 33.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  112-5-117ms    | [S0,MB4,F]  117-8-126ms    | [S0,MB1,B]  180-5-185ms    | [S0,MB5,F]  185-6-192ms    | [S0,MB2,B]  256-5-262ms    | [S0,MB6,F]  262-6-269ms    | [S0,MB3,B]  333-5-338ms    | [S0,MB7,F]  338-6-345ms    | [S0,MB4,B]  385-26-411ms   | [S0,MB5,B]  433-25-459ms   | [S0,MB6,B]  487-20-507ms   | [S0,MB7,B]  530-19-549ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  93-13-107ms    | [S1,MB3,F]  110-11-122ms   | [S1,MB1,B]  161-13-175ms   | [S1,MB4,F]  178-9-188ms    | [S1,MB2,B]  238-13-251ms   | [S1,MB5,F]  255-9-264ms    | [S1,MB3,B]  300-25-326ms   | [S1,MB6,F]  331-9-341ms    | [S1,MB4,B]  354-25-379ms   | [S1,MB7,F]  383-9-393ms    | [S1,MB5,B]  403-26-430ms   | [S1,MB6,B]  457-25-483ms   | [S1,MB7,B]  503-22-526ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  79-9-88ms      | [S2,MB2,F]  92-9-101ms     | [S2,MB1,B]  147-9-156ms    | [S2,MB3,F]  160-7-167ms    | [S2,MB2,B]  212-20-233ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  275-20-296ms   | [S2,MB5,F]  299-7-306ms    | [S2,MB4,B]  328-20-349ms   | [S2,MB6,F]  352-7-359ms    | [S2,MB5,B]  378-20-398ms   | [S2,MB7,F]  402-7-409ms    | [S2,MB6,B]  434-20-454ms   | [S2,MB7,B]  482-17-499ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-22-74ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB1,B]  99-43-142ms    | [S3,MB2,F]  146-11-157ms   | [S3,MB2,B]  164-43-208ms   | [S3,MB3,F]  211-13-225ms   | [S3,MB3,B]  232-38-270ms   | [S3,MB4,F]  274-17-291ms   | [S3,MB4,B]  298-23-322ms   | [S3,MB5,F]  327-15-343ms   | [S3,MB5,B]  350-23-373ms   | [S3,MB6,F]  377-12-389ms   | [S3,MB6,B]  397-31-429ms   | [S3,MB7,F]  432-15-448ms   | [S3,MB7,B]  455-23-478ms  
[rank3]:2025-12-01 04:57:17,999 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0457_stage3_step200.svg
[rank3]:2025-12-01 04:59:10,052 - INFO - Avg. fwd time: 14.0533 / Avg. bwd time: 36.7802 / Avg. batch time: 489.8244 (ms) / GPU bubble ratio: 16.98%
[rank2]:2025-12-01 04:59:10,076 - INFO - Avg. fwd time: 7.7608 / Avg. bwd time: 18.1742 / Avg. batch time: 521.1145 (ms) / GPU bubble ratio: 60.19%
[rank1]:2025-12-01 04:59:10,105 - INFO - Avg. fwd time: 10.0379 / Avg. bwd time: 22.2381 / Avg. batch time: 559.2041 (ms) / GPU bubble ratio: 53.83%
[rank0]:2025-12-01 04:59:10,131 - INFO - Avg. fwd time: 8.2360 / Avg. bwd time: 18.9288 / Avg. batch time: 593.5792 (ms) / GPU bubble ratio: 63.39%
[rank0]:2025-12-01 05:00:57,259 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 05:01:01,630 - INFO - Avg. fwd time: 14.1195 / Avg. bwd time: 36.1003 / Avg. batch time: 485.0089 (ms) / GPU bubble ratio: 17.16%
[rank3]:2025-12-01 05:01:01,635 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.79(0.80)/0.80, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-01 05:01:01,684 - INFO - Avg. fwd time: 10.0712 / Avg. bwd time: 22.0185 / Avg. batch time: 554.1477 (ms) / GPU bubble ratio: 53.67%
[rank1]:2025-12-01 05:01:01,691 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 05:01:01,655 - INFO - Avg. fwd time: 7.7785 / Avg. bwd time: 18.0673 / Avg. batch time: 516.1409 (ms) / GPU bubble ratio: 59.94%
[rank2]:2025-12-01 05:01:01,661 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 05:01:01,710 - INFO - Avg. fwd time: 8.2758 / Avg. bwd time: 18.1737 / Avg. batch time: 588.2690 (ms) / GPU bubble ratio: 64.03%
[rank0]:2025-12-01 05:01:01,717 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.54)/0.54, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-01 05:01:01,735 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.8547  memory:  9.36GiB(19.71%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank2]:2025-12-01 05:01:01,731 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.8547  memory:  6.51GiB(13.70%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank0]:2025-12-01 05:01:01,746 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.8547  memory: 13.29GiB(27.97%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank3]:2025-12-01 05:01:01,744 - INFO -  step: 250  loss:  0.4441  grad_norm:  0.8547  memory: 17.37GiB(36.56%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank2]:2025-12-01 05:02:53,449 - INFO - Avg. fwd time: 7.7931 / Avg. bwd time: 17.9820 / Avg. batch time: 512.1778 (ms) / GPU bubble ratio: 59.74%
[rank3]:2025-12-01 05:02:53,424 - INFO - Avg. fwd time: 14.1743 / Avg. bwd time: 35.5521 / Avg. batch time: 481.1698 (ms) / GPU bubble ratio: 17.32%
[rank1]:2025-12-01 05:02:53,478 - INFO - Avg. fwd time: 10.0978 / Avg. bwd time: 21.8383 / Avg. batch time: 550.1142 (ms) / GPU bubble ratio: 53.56%
[rank0]:2025-12-01 05:02:53,504 - INFO - Avg. fwd time: 8.3077 / Avg. bwd time: 17.5712 / Avg. batch time: 584.0263 (ms) / GPU bubble ratio: 64.55%
[rank0]:2025-12-01 05:04:40,832 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 05:04:45,201 - INFO - Avg. fwd time: 14.2208 / Avg. bwd time: 35.0935 / Avg. batch time: 477.9645 (ms) / GPU bubble ratio: 17.46%
[rank3]:2025-12-01 05:04:45,206 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.79(0.80)/0.80, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-01 05:04:45,256 - INFO - Avg. fwd time: 10.1209 / Avg. bwd time: 21.6895 / Avg. batch time: 546.7515 (ms) / GPU bubble ratio: 53.46%
[rank1]:2025-12-01 05:04:45,263 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 05:04:45,226 - INFO - Avg. fwd time: 7.8052 / Avg. bwd time: 17.9111 / Avg. batch time: 508.8693 (ms) / GPU bubble ratio: 59.57%
[rank2]:2025-12-01 05:04:45,232 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-01 05:04:45,304 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1887  memory:  6.51GiB(13.70%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank3]:2025-12-01 05:04:45,316 - INFO -  step: 300  loss:  0.3072  grad_norm:  0.1887  memory: 17.37GiB(36.56%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank0]:2025-12-01 05:04:45,282 - INFO - Avg. fwd time: 8.3345 / Avg. bwd time: 17.0686 / Avg. batch time: 580.4905 (ms) / GPU bubble ratio: 64.99%
[rank0]:2025-12-01 05:04:45,289 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.54(0.54)/0.54, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-01 05:04:45,318 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1887  memory: 13.29GiB(27.97%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank1]:2025-12-01 05:04:45,307 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1887  memory:  9.36GiB(19.71%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank1]:2025-12-01 05:04:45,368 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0504_stage1_step300.svg
[rank2]:2025-12-01 05:04:45,374 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0504_stage2_step300.svg
[rank0]:2025-12-01 05:04:45,367 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0504_stage0_step300.svg
[rank3]:2025-12-01 05:04:45,456 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0504_real_step300_rank3.svg
[rank3]:			> Batch Time: 541.00 ms, GPU Bubble Ratio: 70.30%, 54.96%, 62.88%, 33.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  255-0-255ms    | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  333-0-333ms    | [S0,MB7,F]  333-7-340ms    | [S0,MB4,B]  385-26-411ms   | [S0,MB5,B]  433-25-459ms   | [S0,MB6,B]  481-20-501ms   | [S0,MB7,B]  522-19-541ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  238-11-249ms   | [S1,MB5,F]  253-9-262ms    | [S1,MB3,B]  300-25-326ms   | [S1,MB6,F]  331-9-341ms    | [S1,MB4,B]  354-25-380ms   | [S1,MB7,F]  384-9-393ms    | [S1,MB5,B]  404-26-430ms   | [S1,MB6,B]  452-25-477ms   | [S1,MB7,B]  496-22-518ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  147-9-156ms    | [S2,MB3,F]  159-7-167ms    | [S2,MB2,B]  212-20-233ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  275-20-295ms   | [S2,MB5,F]  298-7-306ms    | [S2,MB4,B]  329-20-349ms   | [S2,MB6,F]  353-7-360ms    | [S2,MB5,B]  378-20-399ms   | [S2,MB7,F]  402-7-409ms    | [S2,MB6,B]  428-20-448ms   | [S2,MB7,B]  475-17-492ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-43-207ms   | [S3,MB3,F]  211-13-224ms   | [S3,MB3,B]  231-38-270ms   | [S3,MB4,F]  273-17-291ms   | [S3,MB4,B]  298-23-321ms   | [S3,MB5,F]  327-15-343ms   | [S3,MB5,B]  350-22-373ms   | [S3,MB6,F]  377-15-392ms   | [S3,MB6,B]  399-23-423ms   | [S3,MB7,F]  426-15-442ms   | [S3,MB7,B]  449-22-472ms  
[rank3]:2025-12-01 05:04:45,498 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0504_stage3_step300.svg
[rank3]:2025-12-01 05:06:37,656 - INFO - Avg. fwd time: 14.2564 / Avg. bwd time: 34.7330 / Avg. batch time: 475.4541 (ms) / GPU bubble ratio: 17.57%
[rank1]:2025-12-01 05:06:37,712 - INFO - Avg. fwd time: 10.1393 / Avg. bwd time: 21.5612 / Avg. batch time: 544.1398 (ms) / GPU bubble ratio: 53.39%
[rank2]:2025-12-01 05:06:37,682 - INFO - Avg. fwd time: 7.8162 / Avg. bwd time: 17.8514 / Avg. batch time: 506.3202 (ms) / GPU bubble ratio: 59.44%
[rank0]:2025-12-01 05:06:37,738 - INFO - Avg. fwd time: 8.3589 / Avg. bwd time: 16.6258 / Avg. batch time: 577.7377 (ms) / GPU bubble ratio: 65.40%
[rank0]:2025-12-01 05:08:25,838 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 05:08:30,305 - INFO - Avg. fwd time: 14.2867 / Avg. bwd time: 34.4423 / Avg. batch time: 473.3979 (ms) / GPU bubble ratio: 17.65%
[rank2]:2025-12-01 05:08:30,331 - INFO - Avg. fwd time: 7.8258 / Avg. bwd time: 17.7997 / Avg. batch time: 504.2016 (ms) / GPU bubble ratio: 59.34%
[rank0]:2025-12-01 05:08:30,387 - INFO - Avg. fwd time: 8.3804 / Avg. bwd time: 16.2486 / Avg. batch time: 575.4450 (ms) / GPU bubble ratio: 65.76%
[rank1]:2025-12-01 05:08:30,361 - INFO - Avg. fwd time: 10.1560 / Avg. bwd time: 21.4512 / Avg. batch time: 541.9665 (ms) / GPU bubble ratio: 53.34%
[rank1]:2025-12-01 05:08:30,413 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.3061  memory:  9.36GiB(19.71%)  tps: 7,278  tflops: 56.90  mfu: 18.24%
[rank3]:2025-12-01 05:08:30,422 - INFO -  step: 350  loss:  0.2470  grad_norm:  0.3061  memory: 17.37GiB(36.56%)  tps: 7,278  tflops: 56.90  mfu: 18.24%
[rank2]:2025-12-01 05:08:30,409 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.3061  memory:  6.51GiB(13.70%)  tps: 7,278  tflops: 56.90  mfu: 18.24%
[rank0]:2025-12-01 05:08:30,424 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.3061  memory: 13.29GiB(27.97%)  tps: 7,278  tflops: 56.90  mfu: 18.24%
[rank3]:2025-12-01 05:10:22,793 - INFO - Avg. fwd time: 14.3133 / Avg. bwd time: 34.1800 / Avg. batch time: 471.5573 (ms) / GPU bubble ratio: 17.73%
[rank2]:2025-12-01 05:10:22,819 - INFO - Avg. fwd time: 7.8344 / Avg. bwd time: 17.7555 / Avg. batch time: 502.3051 (ms) / GPU bubble ratio: 59.24%
[rank1]:2025-12-01 05:10:22,849 - INFO - Avg. fwd time: 10.1702 / Avg. bwd time: 21.3556 / Avg. batch time: 540.0223 (ms) / GPU bubble ratio: 53.30%
[rank0]:2025-12-01 05:10:22,876 - INFO - Avg. fwd time: 8.3997 / Avg. bwd time: 15.9352 / Avg. batch time: 573.4008 (ms) / GPU bubble ratio: 66.05%
[rank0]:2025-12-01 05:12:10,755 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 05:12:15,233 - INFO - Avg. fwd time: 14.3358 / Avg. bwd time: 33.9495 / Avg. batch time: 469.9340 (ms) / GPU bubble ratio: 17.80%
[rank2]:2025-12-01 05:12:15,259 - INFO - Avg. fwd time: 7.8418 / Avg. bwd time: 17.7160 / Avg. batch time: 500.6297 (ms) / GPU bubble ratio: 59.16%
[rank1]:2025-12-01 05:12:15,289 - INFO - Avg. fwd time: 10.1825 / Avg. bwd time: 21.2708 / Avg. batch time: 538.3041 (ms) / GPU bubble ratio: 53.26%
[rank1]:2025-12-01 05:12:15,342 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0699  memory:  9.36GiB(19.71%)  tps: 7,284  tflops: 56.94  mfu: 18.25%
[rank3]:2025-12-01 05:12:15,351 - INFO -  step: 400  loss:  0.2266  grad_norm:  0.0699  memory: 17.37GiB(36.56%)  tps: 7,284  tflops: 56.94  mfu: 18.25%
[rank0]:2025-12-01 05:12:15,317 - INFO - Avg. fwd time: 8.4166 / Avg. bwd time: 15.6480 / Avg. batch time: 571.5979 (ms) / GPU bubble ratio: 66.32%
[rank0]:2025-12-01 05:12:15,353 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0699  memory: 13.29GiB(27.97%)  tps: 7,284  tflops: 56.94  mfu: 18.25%
[rank2]:2025-12-01 05:12:15,338 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0699  memory:  6.51GiB(13.70%)  tps: 7,284  tflops: 56.94  mfu: 18.25%
[rank2]:2025-12-01 05:12:15,405 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0512_stage2_step400.svg
[rank1]:2025-12-01 05:12:15,405 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0512_stage1_step400.svg
[rank0]:2025-12-01 05:12:15,406 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0512_stage0_step400.svg
[rank3]:2025-12-01 05:12:15,492 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0512_real_step400_rank3.svg
[rank3]:			> Batch Time: 546.59 ms, GPU Bubble Ratio: 70.61%, 55.63%, 63.29%, 33.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-10-39ms     | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  254-0-254ms    | [S0,MB6,F]  254-6-261ms    | [S0,MB3,B]  333-0-333ms    | [S0,MB7,F]  333-6-340ms    | [S0,MB4,B]  384-26-410ms   | [S0,MB5,B]  432-25-458ms   | [S0,MB6,B]  485-20-505ms   | [S0,MB7,B]  527-19-546ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-172ms   | [S1,MB4,F]  176-8-185ms    | [S1,MB2,B]  237-11-249ms   | [S1,MB5,F]  252-9-261ms    | [S1,MB3,B]  300-25-326ms   | [S1,MB6,F]  331-9-340ms    | [S1,MB4,B]  353-25-379ms   | [S1,MB7,F]  383-9-392ms    | [S1,MB5,B]  402-25-428ms   | [S1,MB6,B]  456-25-481ms   | [S1,MB7,B]  502-21-524ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  212-20-232ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  275-20-295ms   | [S2,MB5,F]  299-7-306ms    | [S2,MB4,B]  328-20-348ms   | [S2,MB6,F]  352-7-359ms    | [S2,MB5,B]  377-20-398ms   | [S2,MB7,F]  401-7-408ms    | [S2,MB6,B]  432-20-453ms   | [S2,MB7,B]  481-17-498ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-43-207ms   | [S3,MB3,F]  210-13-224ms   | [S3,MB3,B]  231-38-270ms   | [S3,MB4,F]  274-17-291ms   | [S3,MB4,B]  298-23-321ms   | [S3,MB5,F]  327-15-343ms   | [S3,MB5,B]  350-22-373ms   | [S3,MB6,F]  376-12-388ms   | [S3,MB6,B]  396-31-427ms   | [S3,MB7,F]  431-16-447ms   | [S3,MB7,B]  454-23-477ms  
[rank3]:2025-12-01 05:12:15,538 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0512_stage3_step400.svg
[rank3]:2025-12-01 05:12:40,894 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-01 05:12:41,011 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-01 05:12:41,035 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-01 05:12:41,057 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-01 05:14:07,014 - INFO - Avg. fwd time: 14.3591 / Avg. bwd time: 33.7168 / Avg. batch time: 468.2948 (ms) / GPU bubble ratio: 17.87%
[rank2]:2025-12-01 05:14:07,041 - INFO - Avg. fwd time: 7.8480 / Avg. bwd time: 17.6810 / Avg. batch time: 498.9635 (ms) / GPU bubble ratio: 59.07%
[rank1]:2025-12-01 05:14:07,071 - INFO - Avg. fwd time: 10.1929 / Avg. bwd time: 21.1975 / Avg. batch time: 536.6059 (ms) / GPU bubble ratio: 53.20%
[rank0]:2025-12-01 05:14:07,099 - INFO - Avg. fwd time: 8.4309 / Avg. bwd time: 15.4062 / Avg. batch time: 569.8217 (ms) / GPU bubble ratio: 66.53%
[rank0]:2025-12-01 05:15:54,127 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 05:15:58,478 - INFO - Avg. fwd time: 14.3788 / Avg. bwd time: 33.5056 / Avg. batch time: 466.7886 (ms) / GPU bubble ratio: 17.93%
[rank2]:2025-12-01 05:15:58,505 - INFO - Avg. fwd time: 7.8529 / Avg. bwd time: 17.6498 / Avg. batch time: 497.4060 (ms) / GPU bubble ratio: 58.98%
[rank1]:2025-12-01 05:15:58,536 - INFO - Avg. fwd time: 10.2015 / Avg. bwd time: 21.1320 / Avg. batch time: 535.0201 (ms) / GPU bubble ratio: 53.15%
[rank2]:2025-12-01 05:15:58,585 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.2705  memory:  6.51GiB(13.70%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank0]:2025-12-01 05:15:58,564 - INFO - Avg. fwd time: 8.4427 / Avg. bwd time: 15.1788 / Avg. batch time: 568.1662 (ms) / GPU bubble ratio: 66.74%
[rank0]:2025-12-01 05:15:58,600 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.2705  memory: 13.29GiB(27.97%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank1]:2025-12-01 05:15:58,589 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.2705  memory:  9.36GiB(19.71%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank3]:2025-12-01 05:15:58,598 - INFO -  step: 450  loss:  0.2387  grad_norm:  0.2705  memory: 17.37GiB(36.56%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank1]:2025-12-01 05:17:50,109 - INFO - Avg. fwd time: 10.2096 / Avg. bwd time: 21.0731 / Avg. batch time: 533.6171 (ms) / GPU bubble ratio: 53.10%
[rank3]:2025-12-01 05:17:50,050 - INFO - Avg. fwd time: 14.3969 / Avg. bwd time: 33.3176 / Avg. batch time: 465.4586 (ms) / GPU bubble ratio: 17.99%
[rank2]:2025-12-01 05:17:50,078 - INFO - Avg. fwd time: 7.8575 / Avg. bwd time: 17.6216 / Avg. batch time: 496.0282 (ms) / GPU bubble ratio: 58.91%
[rank0]:2025-12-01 05:17:50,136 - INFO - Avg. fwd time: 8.4535 / Avg. bwd time: 14.9777 / Avg. batch time: 566.7007 (ms) / GPU bubble ratio: 66.92%
[rank0]:2025-12-01 05:19:37,289 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 05:19:41,652 - INFO - Avg. fwd time: 14.4132 / Avg. bwd time: 33.1497 / Avg. batch time: 464.2654 (ms) / GPU bubble ratio: 18.04%
[rank2]:2025-12-01 05:19:41,680 - INFO - Avg. fwd time: 7.8618 / Avg. bwd time: 17.5961 / Avg. batch time: 494.7933 (ms) / GPU bubble ratio: 58.84%
[rank1]:2025-12-01 05:19:41,711 - INFO - Avg. fwd time: 10.2167 / Avg. bwd time: 21.0200 / Avg. batch time: 532.3581 (ms) / GPU bubble ratio: 53.06%
[rank1]:2025-12-01 05:19:41,765 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1006  memory:  9.36GiB(19.71%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank3]:2025-12-01 05:19:41,774 - INFO -  step: 500  loss:  0.2247  grad_norm:  0.1006  memory: 17.37GiB(36.56%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank2]:2025-12-01 05:19:41,761 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1006  memory:  6.51GiB(13.70%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank2]:2025-12-01 05:19:41,824 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0519_stage2_step500.svg
[rank0]:2025-12-01 05:19:41,740 - INFO - Avg. fwd time: 8.4635 / Avg. bwd time: 14.7970 / Avg. batch time: 565.3881 (ms) / GPU bubble ratio: 67.09%
[rank0]:2025-12-01 05:19:41,776 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1006  memory: 13.29GiB(27.97%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank0]:2025-12-01 05:19:41,824 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0519_stage0_step500.svg
[rank1]:2025-12-01 05:19:41,824 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0519_stage1_step500.svg
[rank3]:2025-12-01 05:19:41,910 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0519_real_step500_rank3.svg
[rank3]:			> Batch Time: 540.09 ms, GPU Bubble Ratio: 70.16%, 54.95%, 62.84%, 33.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  110-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  254-0-254ms    | [S0,MB6,F]  254-6-261ms    | [S0,MB3,B]  332-0-332ms    | [S0,MB7,F]  332-6-339ms    | [S0,MB4,B]  384-26-410ms   | [S0,MB5,B]  432-25-458ms   | [S0,MB6,B]  480-20-501ms   | [S0,MB7,B]  521-19-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  238-11-249ms   | [S1,MB5,F]  253-9-262ms    | [S1,MB3,B]  299-25-325ms   | [S1,MB6,F]  331-9-340ms    | [S1,MB4,B]  353-25-379ms   | [S1,MB7,F]  382-9-392ms    | [S1,MB5,B]  402-25-428ms   | [S1,MB6,B]  450-25-476ms   | [S1,MB7,B]  495-22-517ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  147-9-156ms    | [S2,MB3,F]  159-7-167ms    | [S2,MB2,B]  212-20-232ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  274-20-294ms   | [S2,MB5,F]  298-7-305ms    | [S2,MB4,B]  328-20-348ms   | [S2,MB6,F]  352-7-359ms    | [S2,MB5,B]  377-20-397ms   | [S2,MB7,F]  401-7-408ms    | [S2,MB6,B]  427-20-447ms   | [S2,MB7,B]  474-17-491ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-43-207ms   | [S3,MB3,F]  211-13-224ms   | [S3,MB3,B]  231-38-270ms   | [S3,MB4,F]  273-17-290ms   | [S3,MB4,B]  298-23-321ms   | [S3,MB5,F]  326-15-342ms   | [S3,MB5,B]  349-22-372ms   | [S3,MB6,F]  376-15-391ms   | [S3,MB6,B]  398-23-422ms   | [S3,MB7,F]  426-15-441ms   | [S3,MB7,B]  448-22-470ms  
[rank3]:2025-12-01 05:19:41,952 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0519_stage3_step500.svg
[rank3]:2025-12-01 05:21:33,511 - INFO - Avg. fwd time: 14.4281 / Avg. bwd time: 33.0003 / Avg. batch time: 463.2221 (ms) / GPU bubble ratio: 18.09%
[rank2]:2025-12-01 05:21:33,539 - INFO - Avg. fwd time: 7.8657 / Avg. bwd time: 17.5724 / Avg. batch time: 493.7355 (ms) / GPU bubble ratio: 58.78%
[rank1]:2025-12-01 05:21:33,571 - INFO - Avg. fwd time: 10.2236 / Avg. bwd time: 20.9711 / Avg. batch time: 531.2786 (ms) / GPU bubble ratio: 53.03%
[rank0]:2025-12-01 05:21:33,599 - INFO - Avg. fwd time: 8.4721 / Avg. bwd time: 14.6507 / Avg. batch time: 564.2554 (ms) / GPU bubble ratio: 67.22%
[rank0]:2025-12-01 05:23:20,847 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 05:23:25,264 - INFO - Avg. fwd time: 14.4420 / Avg. bwd time: 32.8647 / Avg. batch time: 462.2847 (ms) / GPU bubble ratio: 18.13%
[rank2]:2025-12-01 05:23:25,293 - INFO - Avg. fwd time: 7.8692 / Avg. bwd time: 17.5504 / Avg. batch time: 492.7626 (ms) / GPU bubble ratio: 58.73%
[rank1]:2025-12-01 05:23:25,324 - INFO - Avg. fwd time: 10.2298 / Avg. bwd time: 20.9266 / Avg. batch time: 530.2845 (ms) / GPU bubble ratio: 53.00%
[rank2]:2025-12-01 05:23:25,376 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0685  memory:  6.51GiB(13.70%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank0]:2025-12-01 05:23:25,354 - INFO - Avg. fwd time: 8.4801 / Avg. bwd time: 14.5096 / Avg. batch time: 563.2136 (ms) / GPU bubble ratio: 67.34%
[rank0]:2025-12-01 05:23:25,390 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0685  memory: 13.29GiB(27.97%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank3]:2025-12-01 05:23:25,388 - INFO -  step: 550  loss:  0.2271  grad_norm:  0.0685  memory: 17.37GiB(36.56%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank1]:2025-12-01 05:23:25,379 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0685  memory:  9.36GiB(19.71%)  tps: 7,327  tflops: 57.28  mfu: 18.36%
[rank3]:2025-12-01 05:25:16,907 - INFO - Avg. fwd time: 14.4555 / Avg. bwd time: 32.7375 / Avg. batch time: 461.3950 (ms) / GPU bubble ratio: 18.17%
[rank2]:2025-12-01 05:25:16,935 - INFO - Avg. fwd time: 7.8727 / Avg. bwd time: 17.5306 / Avg. batch time: 491.8406 (ms) / GPU bubble ratio: 58.68%
[rank1]:2025-12-01 05:25:16,967 - INFO - Avg. fwd time: 10.2357 / Avg. bwd time: 20.8866 / Avg. batch time: 529.3443 (ms) / GPU bubble ratio: 52.96%
[rank0]:2025-12-01 05:25:16,997 - INFO - Avg. fwd time: 8.4878 / Avg. bwd time: 14.3722 / Avg. batch time: 562.2321 (ms) / GPU bubble ratio: 67.47%
[rank0]:2025-12-01 05:27:04,080 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 05:27:08,518 - INFO - Avg. fwd time: 14.4671 / Avg. bwd time: 32.6213 / Avg. batch time: 460.5749 (ms) / GPU bubble ratio: 18.21%
[rank1]:2025-12-01 05:27:08,579 - INFO - Avg. fwd time: 10.2414 / Avg. bwd time: 20.8499 / Avg. batch time: 528.4768 (ms) / GPU bubble ratio: 52.93%
[rank2]:2025-12-01 05:27:08,546 - INFO - Avg. fwd time: 7.8759 / Avg. bwd time: 17.5120 / Avg. batch time: 490.9901 (ms) / GPU bubble ratio: 58.63%
[rank2]:2025-12-01 05:27:08,630 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0907  memory:  6.51GiB(13.70%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank0]:2025-12-01 05:27:08,608 - INFO - Avg. fwd time: 8.4949 / Avg. bwd time: 14.2463 / Avg. batch time: 561.3275 (ms) / GPU bubble ratio: 67.59%
[rank0]:2025-12-01 05:27:08,644 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0907  memory: 13.29GiB(27.97%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank3]:2025-12-01 05:27:08,642 - INFO -  step: 600  loss:  0.2237  grad_norm:  0.0907  memory: 17.37GiB(36.56%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank1]:2025-12-01 05:27:08,633 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0907  memory:  9.36GiB(19.71%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank2]:2025-12-01 05:27:08,694 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0527_stage2_step600.svg
[rank0]:2025-12-01 05:27:08,697 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0527_stage0_step600.svg
[rank1]:2025-12-01 05:27:08,694 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0527_stage1_step600.svg
[rank3]:2025-12-01 05:27:08,780 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0527_real_step600_rank3.svg
[rank3]:			> Batch Time: 540.11 ms, GPU Bubble Ratio: 70.16%, 54.98%, 62.89%, 33.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  254-0-254ms    | [S0,MB6,F]  254-6-261ms    | [S0,MB3,B]  332-0-332ms    | [S0,MB7,F]  332-6-339ms    | [S0,MB4,B]  384-26-410ms   | [S0,MB5,B]  432-25-458ms   | [S0,MB6,B]  480-20-500ms   | [S0,MB7,B]  521-19-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  237-11-249ms   | [S1,MB5,F]  252-9-262ms    | [S1,MB3,B]  299-25-325ms   | [S1,MB6,F]  330-9-340ms    | [S1,MB4,B]  353-25-379ms   | [S1,MB7,F]  382-9-392ms    | [S1,MB5,B]  402-25-428ms   | [S1,MB6,B]  451-25-477ms   | [S1,MB7,B]  495-22-517ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  212-20-232ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  274-20-294ms   | [S2,MB5,F]  298-7-305ms    | [S2,MB4,B]  328-20-348ms   | [S2,MB6,F]  351-7-358ms    | [S2,MB5,B]  377-20-397ms   | [S2,MB7,F]  401-7-408ms    | [S2,MB6,B]  427-20-447ms   | [S2,MB7,B]  474-17-492ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-43-207ms   | [S3,MB3,F]  210-13-224ms   | [S3,MB3,B]  231-38-269ms   | [S3,MB4,F]  273-17-290ms   | [S3,MB4,B]  297-23-321ms   | [S3,MB5,F]  326-15-342ms   | [S3,MB5,B]  349-22-372ms   | [S3,MB6,F]  375-15-390ms   | [S3,MB6,B]  398-24-422ms   | [S3,MB7,F]  426-15-441ms   | [S3,MB7,B]  448-22-471ms  
[rank3]:2025-12-01 05:27:08,823 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0527_stage3_step600.svg
[rank3]:2025-12-01 05:29:00,193 - INFO - Avg. fwd time: 14.4785 / Avg. bwd time: 32.5124 / Avg. batch time: 459.8022 (ms) / GPU bubble ratio: 18.24%
[rank2]:2025-12-01 05:29:00,223 - INFO - Avg. fwd time: 7.8790 / Avg. bwd time: 17.4955 / Avg. batch time: 490.2086 (ms) / GPU bubble ratio: 58.59%
[rank0]:2025-12-01 05:29:00,285 - INFO - Avg. fwd time: 8.5016 / Avg. bwd time: 14.1312 / Avg. batch time: 560.4986 (ms) / GPU bubble ratio: 67.70%
[rank1]:2025-12-01 05:29:00,255 - INFO - Avg. fwd time: 10.2463 / Avg. bwd time: 20.8165 / Avg. batch time: 527.6803 (ms) / GPU bubble ratio: 52.91%
[rank0]:2025-12-01 05:30:47,442 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-01 05:30:51,845 - INFO - Avg. fwd time: 7.8818 / Avg. bwd time: 17.4801 / Avg. batch time: 489.4913 (ms) / GPU bubble ratio: 58.55%
[rank3]:2025-12-01 05:30:51,816 - INFO - Avg. fwd time: 14.4891 / Avg. bwd time: 32.4142 / Avg. batch time: 459.1104 (ms) / GPU bubble ratio: 18.27%
[rank1]:2025-12-01 05:30:51,878 - INFO - Avg. fwd time: 10.2509 / Avg. bwd time: 20.7858 / Avg. batch time: 526.9510 (ms) / GPU bubble ratio: 52.88%
[rank0]:2025-12-01 05:30:51,908 - INFO - Avg. fwd time: 8.5073 / Avg. bwd time: 14.0246 / Avg. batch time: 559.7362 (ms) / GPU bubble ratio: 67.80%
[rank0]:2025-12-01 05:30:51,944 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0703  memory: 13.29GiB(27.97%)  tps: 7,337  tflops: 57.36  mfu: 18.38%
[rank2]:2025-12-01 05:30:51,930 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0703  memory:  6.51GiB(13.70%)  tps: 7,337  tflops: 57.36  mfu: 18.38%
[rank3]:2025-12-01 05:30:51,942 - INFO -  step: 650  loss:  0.2340  grad_norm:  0.0703  memory: 17.37GiB(36.56%)  tps: 7,337  tflops: 57.36  mfu: 18.38%
[rank1]:2025-12-01 05:30:51,933 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0703  memory:  9.36GiB(19.71%)  tps: 7,337  tflops: 57.36  mfu: 18.38%
[rank3]:2025-12-01 05:32:43,400 - INFO - Avg. fwd time: 14.4982 / Avg. bwd time: 32.3236 / Avg. batch time: 458.4678 (ms) / GPU bubble ratio: 18.30%
[rank0]:2025-12-01 05:32:43,494 - INFO - Avg. fwd time: 8.5125 / Avg. bwd time: 13.9251 / Avg. batch time: 559.0266 (ms) / GPU bubble ratio: 67.89%
[rank2]:2025-12-01 05:32:43,430 - INFO - Avg. fwd time: 7.8843 / Avg. bwd time: 17.4657 / Avg. batch time: 488.8245 (ms) / GPU bubble ratio: 58.51%
[rank1]:2025-12-01 05:32:43,464 - INFO - Avg. fwd time: 10.2550 / Avg. bwd time: 20.7571 / Avg. batch time: 526.2727 (ms) / GPU bubble ratio: 52.86%
[rank0]:2025-12-01 05:34:30,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-01 05:34:34,961 - INFO - Avg. fwd time: 7.8864 / Avg. bwd time: 17.4520 / Avg. batch time: 488.1871 (ms) / GPU bubble ratio: 58.48%
[rank3]:2025-12-01 05:34:34,931 - INFO - Avg. fwd time: 14.5059 / Avg. bwd time: 32.2381 / Avg. batch time: 457.8534 (ms) / GPU bubble ratio: 18.33%
[rank2]:2025-12-01 05:34:35,046 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0722  memory:  6.51GiB(13.70%)  tps: 7,343  tflops: 57.41  mfu: 18.40%
[rank0]:2025-12-01 05:34:35,024 - INFO - Avg. fwd time: 8.5177 / Avg. bwd time: 13.8391 / Avg. batch time: 558.3518 (ms) / GPU bubble ratio: 67.97%
[rank0]:2025-12-01 05:34:35,060 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0722  memory: 13.29GiB(27.97%)  tps: 7,343  tflops: 57.41  mfu: 18.40%
[rank1]:2025-12-01 05:34:34,994 - INFO - Avg. fwd time: 10.2585 / Avg. bwd time: 20.7300 / Avg. batch time: 525.6237 (ms) / GPU bubble ratio: 52.84%
[rank1]:2025-12-01 05:34:35,049 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0722  memory:  9.36GiB(19.71%)  tps: 7,343  tflops: 57.41  mfu: 18.40%
[rank3]:2025-12-01 05:34:35,058 - INFO -  step: 700  loss:  0.1940  grad_norm:  0.0722  memory: 17.37GiB(36.56%)  tps: 7,343  tflops: 57.41  mfu: 18.40%
[rank2]:2025-12-01 05:34:35,111 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0534_stage2_step700.svg
[rank0]:2025-12-01 05:34:35,114 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0534_stage0_step700.svg
[rank1]:2025-12-01 05:34:35,111 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0534_stage1_step700.svg
[rank3]:2025-12-01 05:34:35,197 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0534_real_step700_rank3.svg
[rank3]:			> Batch Time: 541.05 ms, GPU Bubble Ratio: 69.63%, 55.01%, 62.93%, 33.97%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  254-0-254ms    | [S0,MB6,F]  254-6-261ms    | [S0,MB3,B]  332-0-332ms    | [S0,MB7,F]  332-6-339ms    | [S0,MB4,B]  384-26-410ms   | [S0,MB5,B]  432-25-458ms   | [S0,MB6,B]  480-23-504ms   | [S0,MB7,B]  522-19-541ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  237-11-249ms   | [S1,MB5,F]  252-9-262ms    | [S1,MB3,B]  300-25-325ms   | [S1,MB6,F]  330-9-340ms    | [S1,MB4,B]  353-25-379ms   | [S1,MB7,F]  382-9-392ms    | [S1,MB5,B]  402-26-428ms   | [S1,MB6,B]  451-25-477ms   | [S1,MB7,B]  496-22-518ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  212-20-232ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  274-20-294ms   | [S2,MB5,F]  298-7-305ms    | [S2,MB4,B]  328-20-348ms   | [S2,MB6,F]  352-7-359ms    | [S2,MB5,B]  377-20-397ms   | [S2,MB7,F]  401-7-408ms    | [S2,MB6,B]  427-20-447ms   | [S2,MB7,B]  475-17-492ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-43-207ms   | [S3,MB3,F]  210-13-224ms   | [S3,MB3,B]  231-38-269ms   | [S3,MB4,F]  273-17-290ms   | [S3,MB4,B]  297-23-321ms   | [S3,MB5,F]  327-15-342ms   | [S3,MB5,B]  349-22-372ms   | [S3,MB6,F]  375-15-391ms   | [S3,MB6,B]  397-24-422ms   | [S3,MB7,F]  426-15-441ms   | [S3,MB7,B]  448-22-471ms  
[rank3]:2025-12-01 05:34:35,245 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0534_stage3_step700.svg
[rank3]:2025-12-01 05:36:27,232 - INFO - Avg. fwd time: 14.5096 / Avg. bwd time: 32.1748 / Avg. batch time: 457.3799 (ms) / GPU bubble ratio: 18.34%
[rank1]:2025-12-01 05:36:27,297 - INFO - Avg. fwd time: 10.2621 / Avg. bwd time: 20.7047 / Avg. batch time: 525.1447 (ms) / GPU bubble ratio: 52.83%
[rank2]:2025-12-01 05:36:27,263 - INFO - Avg. fwd time: 7.8886 / Avg. bwd time: 17.4392 / Avg. batch time: 487.7168 (ms) / GPU bubble ratio: 58.45%
[rank0]:2025-12-01 05:36:27,328 - INFO - Avg. fwd time: 8.5220 / Avg. bwd time: 13.7632 / Avg. batch time: 557.8452 (ms) / GPU bubble ratio: 68.04%
[rank0]:2025-12-01 05:38:14,438 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-01 05:38:18,844 - INFO - Avg. fwd time: 14.5161 / Avg. bwd time: 32.1012 / Avg. batch time: 456.8528 (ms) / GPU bubble ratio: 18.37%
[rank1]:2025-12-01 05:38:18,909 - INFO - Avg. fwd time: 10.2656 / Avg. bwd time: 20.6815 / Avg. batch time: 524.5893 (ms) / GPU bubble ratio: 52.81%
[rank2]:2025-12-01 05:38:18,874 - INFO - Avg. fwd time: 7.8907 / Avg. bwd time: 17.4275 / Avg. batch time: 487.1693 (ms) / GPU bubble ratio: 58.42%
[rank2]:2025-12-01 05:38:18,962 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0838  memory:  6.51GiB(13.70%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank3]:2025-12-01 05:38:18,974 - INFO -  step: 750  loss:  0.2341  grad_norm:  0.0838  memory: 17.37GiB(36.56%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank0]:2025-12-01 05:38:18,940 - INFO - Avg. fwd time: 8.5262 / Avg. bwd time: 13.6916 / Avg. batch time: 557.2647 (ms) / GPU bubble ratio: 68.10%
[rank0]:2025-12-01 05:38:18,976 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0838  memory: 13.29GiB(27.97%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank1]:2025-12-01 05:38:18,965 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0838  memory:  9.36GiB(19.71%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank3]:2025-12-01 05:40:11,207 - INFO - Avg. fwd time: 14.5199 / Avg. bwd time: 32.0506 / Avg. batch time: 456.4761 (ms) / GPU bubble ratio: 18.38%
[rank1]:2025-12-01 05:40:11,273 - INFO - Avg. fwd time: 10.2689 / Avg. bwd time: 20.6592 / Avg. batch time: 524.1956 (ms) / GPU bubble ratio: 52.80%
[rank2]:2025-12-01 05:40:11,239 - INFO - Avg. fwd time: 7.8926 / Avg. bwd time: 17.4162 / Avg. batch time: 486.7842 (ms) / GPU bubble ratio: 58.41%
[rank0]:2025-12-01 05:40:11,305 - INFO - Avg. fwd time: 8.5297 / Avg. bwd time: 13.6157 / Avg. batch time: 556.8449 (ms) / GPU bubble ratio: 68.18%
[rank0]:2025-12-01 05:41:58,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-01 05:42:02,971 - INFO - Avg. fwd time: 14.5254 / Avg. bwd time: 31.9899 / Avg. batch time: 456.0357 (ms) / GPU bubble ratio: 18.40%
[rank1]:2025-12-01 05:42:03,039 - INFO - Avg. fwd time: 10.2722 / Avg. bwd time: 20.6387 / Avg. batch time: 523.7342 (ms) / GPU bubble ratio: 52.78%
[rank2]:2025-12-01 05:42:03,004 - INFO - Avg. fwd time: 7.8945 / Avg. bwd time: 17.4058 / Avg. batch time: 486.3295 (ms) / GPU bubble ratio: 58.38%
[rank2]:2025-12-01 05:42:03,092 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0728  memory:  6.51GiB(13.70%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank2]:2025-12-01 05:42:03,092 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0728  tps: 7,575  tflops: 59.22  mfu: 17.35%
[rank2]:2025-12-01 05:42:03,092 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-01 05:42:03,071 - INFO - Avg. fwd time: 8.5335 / Avg. bwd time: 13.5517 / Avg. batch time: 556.3618 (ms) / GPU bubble ratio: 68.24%
[rank0]:2025-12-01 05:42:03,107 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0728  memory: 13.29GiB(27.97%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank0]:2025-12-01 05:42:03,107 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0728  tps: 7,575  tflops: 59.22  mfu: 17.35%
[rank0]:2025-12-01 05:42:03,107 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-01 05:42:03,108 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-01 05:42:03,096 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0728  memory:  9.36GiB(19.71%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank1]:2025-12-01 05:42:03,096 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0728  tps: 7,575  tflops: 59.22  mfu: 17.35%
[rank1]:2025-12-01 05:42:03,096 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-01 05:42:03,097 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-01 05:42:03,104 - INFO -  step: 800  loss:  0.2378  grad_norm:  0.0728  memory: 17.37GiB(36.56%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank3]:2025-12-01 05:42:03,105 - INFO -  final step: 800  loss:  0.2378  grad_norm:  0.0728  tps: 7,580  tflops: 59.25  mfu: 17.48%
[rank3]:2025-12-01 05:42:03,105 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-01 05:42:03,106 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-01 05:42:03,093 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-01 05:42:05,030 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-01 05:42:05,104 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251201_0542_stage0_final800.svg
[rank1]:2025-12-01 05:42:05,105 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251201_0542_stage1_final800.svg
[rank3]:2025-12-01 05:42:05,185 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0542_real_final800_rank3.svg
[rank3]:			> Batch Time: 544.12 ms, GPU Bubble Ratio: 70.43%, 55.34%, 63.14%, 34.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  255-0-255ms    | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  334-0-334ms    | [S0,MB7,F]  334-6-341ms    | [S0,MB4,B]  386-26-412ms   | [S0,MB5,B]  434-25-460ms   | [S0,MB6,B]  484-20-504ms   | [S0,MB7,B]  525-19-544ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-105ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  238-11-250ms   | [S1,MB5,F]  254-9-263ms    | [S1,MB3,B]  301-25-326ms   | [S1,MB6,F]  332-9-341ms    | [S1,MB4,B]  355-25-381ms   | [S1,MB7,F]  384-9-394ms    | [S1,MB5,B]  405-25-431ms   | [S1,MB6,B]  454-25-480ms   | [S1,MB7,B]  499-22-521ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  147-9-156ms    | [S2,MB3,F]  160-7-167ms    | [S2,MB2,B]  213-20-233ms   | [S2,MB4,F]  237-7-244ms    | [S2,MB3,B]  275-20-295ms   | [S2,MB5,F]  299-7-306ms    | [S2,MB4,B]  330-20-350ms   | [S2,MB6,F]  353-7-361ms    | [S2,MB5,B]  379-20-399ms   | [S2,MB7,F]  403-7-410ms    | [S2,MB6,B]  431-20-451ms   | [S2,MB7,B]  478-17-495ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-43-142ms    | [S3,MB2,F]  145-11-157ms   | [S3,MB2,B]  164-43-208ms   | [S3,MB3,F]  211-13-225ms   | [S3,MB3,B]  232-38-270ms   | [S3,MB4,F]  274-17-291ms   | [S3,MB4,B]  299-23-322ms   | [S3,MB5,F]  328-15-344ms   | [S3,MB5,B]  351-22-374ms   | [S3,MB6,F]  378-14-393ms   | [S3,MB6,B]  400-24-424ms   | [S3,MB7,F]  429-15-444ms   | [S3,MB7,B]  452-22-475ms  
[rank2]:2025-12-01 05:42:05,105 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251201_0542_stage2_final800.svg
[rank2]:2025-12-01 05:42:05,259 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251201_0542_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank0]:2025-12-01 05:42:05,259 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251201_0542_rank0_stage0.svg
[rank0]:	> Counts Sum: 332000, Total Sum: 1728640 (19.21%), Ratio(%) per element: [22.6, 23.11, 22.08, 22.94, 22.77, 20.54, 20.89, 21.74, 20.89, 22.26, 21.74, 21.23, 20.71, 21.57, 21.06, 20.37, 19.34, 20.03, 19.86, 19.69, 19.52, 18.15, 18.15, 18.66, 17.29, 19.17, 17.63, 17.63, 15.92, 16.95, 15.58, 16.09, 15.58, 15.58, 13.86, 15.75, 13.52]
[rank1]:2025-12-01 05:42:05,252 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251201_0542_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank3]:2025-12-01 05:42:05,316 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251201_0542_thry_final800_rank3.svg
[rank3]:			> Batch Time: 342.90 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-31ms     | [S0,MB3,F]  31-10-41ms     | [S0,MB0,B]  103-20-124ms   | [S0,MB4,F]  124-10-135ms   | [S0,MB1,B]  135-20-155ms   | [S0,MB5,F]  155-10-166ms   | [S0,MB2,B]  166-20-187ms   | [S0,MB6,F]  187-10-197ms   | [S0,MB3,B]  197-20-218ms   | [S0,MB7,F]  218-10-228ms   | [S0,MB4,B]  228-20-249ms   | [S0,MB5,B]  259-20-280ms   | [S0,MB6,B]  290-20-311ms   | [S0,MB7,B]  322-20-342ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-41ms     | [S1,MB0,B]  83-20-103ms    | [S1,MB3,F]  103-10-114ms   | [S1,MB1,B]  114-20-135ms   | [S1,MB4,F]  135-10-145ms   | [S1,MB2,B]  145-20-166ms   | [S1,MB5,F]  166-10-176ms   | [S1,MB3,B]  176-20-197ms   | [S1,MB6,F]  197-10-207ms   | [S1,MB4,B]  207-20-228ms   | [S1,MB7,F]  228-10-238ms   | [S1,MB5,B]  238-20-259ms   | [S1,MB6,B]  270-20-290ms   | [S1,MB7,B]  301-20-322ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms     | [S2,MB1,F]  31-10-41ms     | [S2,MB0,B]  62-20-83ms     | [S2,MB2,F]  83-10-93ms     | [S2,MB1,B]  93-20-114ms    | [S2,MB3,F]  114-10-124ms   | [S2,MB2,B]  124-20-145ms   | [S2,MB4,F]  145-10-155ms   | [S2,MB3,B]  155-20-176ms   | [S2,MB5,F]  176-10-187ms   | [S2,MB4,B]  187-20-207ms   | [S2,MB6,F]  207-10-218ms   | [S2,MB5,B]  218-20-238ms   | [S2,MB7,F]  238-10-249ms   | [S2,MB6,B]  249-20-270ms   | [S2,MB7,B]  280-20-301ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms     | [S3,MB0,B]  41-20-62ms     | [S3,MB1,F]  62-10-72ms     | [S3,MB1,B]  72-20-93ms     | [S3,MB2,F]  93-10-103ms    | [S3,MB2,B]  103-20-124ms   | [S3,MB3,F]  124-10-135ms   | [S3,MB3,B]  135-20-155ms   | [S3,MB4,F]  155-10-166ms   | [S3,MB4,B]  166-20-187ms   | [S3,MB5,F]  187-10-197ms   | [S3,MB5,B]  197-20-218ms   | [S3,MB6,F]  218-10-228ms   | [S3,MB6,B]  228-20-249ms   | [S3,MB7,F]  249-10-259ms   | [S3,MB7,B]  259-20-280ms  
[rank3]:2025-12-01 05:42:05,364 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251201_0542_stage3_final800.svg
[rank3]:2025-12-01 05:42:05,502 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251201_0542_rank3_stage3.svg
[rank3]:	> Counts Sum: 769600, Total Sum: 1354880 (56.80%), Ratio(%) per element: [57.7, 57.19, 56.67, 56.67, 55.82, 57.7, 55.99, 56.5, 57.53, 56.84, 57.36, 55.82, 57.87, 55.13, 57.53, 57.02, 58.04, 56.16, 56.5, 56.33, 57.02, 56.84, 57.36, 56.5, 56.5, 56.67, 56.5, 55.65, 57.7]
[rank0]:2025-12-01 05:42:07,102 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251201_0542_stage0.svg
[rank0]:2025-12-01 05:42:07,105 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-01 05:42:07,113 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251201_0542_stage1.svg
[rank1]:2025-12-01 05:42:07,116 - INFO - Destroying the purge thread.
[rank2]:2025-12-01 05:42:07,108 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251201_0542_stage2.svg
[rank2]:2025-12-01 05:42:07,111 - INFO - Destroying the purge thread.
[rank3]:2025-12-01 05:42:07,353 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251201_0542_stage3.svg
[rank3]:2025-12-01 05:42:07,357 - INFO - Destroying the purge thread.
[rank2]:2025-12-01 05:42:07,396 - INFO - Process group destroyed
[rank1]:2025-12-01 05:42:07,410 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.32316
[rank3]:wandb:               final/avg_loss 0.23782
[rank3]:wandb:             final/avg_mfu(%) 17.47583
[rank3]:wandb:             final/avg_tflops 59.25413
[rank3]:wandb:    final/avg_throughput(tps) 7579.63935
[rank3]:wandb:              final/grad_norm 0.07281
[rank3]:wandb:               final/max_loss 0.23782
[rank3]:wandb:                    grad_norm 0.07281
[rank3]:wandb: loss_metrics/global_avg_loss 0.23782
[rank3]:wandb: loss_metrics/global_max_loss 0.23782
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.6_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/xkq6jr38
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.6_42_dm1/20251201-0440/wandb/run-20251201_044047-xkq6jr38/logs
[rank3]:2025-12-01 05:42:08,358 - INFO - Process group destroyed
[rank0]:2025-12-01 05:42:09,105 - INFO - Training completed
[rank0]:2025-12-01 05:42:09,106 - INFO - Destroying the purge thread.
[rank0]:2025-12-01 05:42:09,416 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.6', 'layers.5', 'layers.4', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.0', 'tok_embeddings', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.9', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'layers.14', 'output', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.6
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
