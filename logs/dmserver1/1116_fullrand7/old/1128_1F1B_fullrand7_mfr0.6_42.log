
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 29. (í† ) 02:51:39 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.6_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.6) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.6
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-29 02:51:45,664 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-11-29 02:51:45,665 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-29 02:51:45,777 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank1]:2025-11-29 02:51:45,792 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-11-29 02:51:45,893 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-29 02:51:45,895 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-29 02:51:45,897 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank2]:2025-11-29 02:51:45,886 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-29 02:51:45,888 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-29 02:51:45,892 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-29 02:51:46,031 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-29 02:51:46,034 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-29 02:51:46,037 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-29 02:51:46,038 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-29 02:51:46,039 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-29 02:51:46,057 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-29 02:51:46,060 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-29 02:51:46,065 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-29 02:51:46,431 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-29 02:51:49,118 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-29 02:51:49,304 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-29 02:51:49,280 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-29 02:51:49,272 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-29 02:51:49,344 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-29 02:51:49,345 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-29 02:51:49,371 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-29 02:51:49,371 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-29 02:51:49,324 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-29 02:51:49,353 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-29 02:51:49,353 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-29 02:51:49,323 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-29 02:51:49,351 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-29 02:51:49,351 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-29 02:51:49,568 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-29 02:51:49,568 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-29 02:51:49,568 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-29 02:51:49,556 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-29 02:51:49,556 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-29 02:51:49,557 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-29 02:51:49,540 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-29 02:51:49,540 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-29 02:51:49,540 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run q7ieifzq
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.6_42_dm1/20251129-0251/wandb/run-20251129_025150-q7ieifzq
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/q7ieifzq
[rank3]:2025-11-29 02:51:51,460 - INFO - WandB logging enabled
[rank3]:2025-11-29 02:51:51,461 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-29 02:51:51,499 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-29 02:51:51,528 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-29 02:51:51,528 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-29 02:51:51,756 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-29 02:51:51,755 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-29 02:51:51,738 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-29 02:51:51,755 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:2025-11-29 02:51:51,739 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-29 02:51:51,740 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-29 02:51:51,754 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-29 02:51:51,755 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-29 02:51:51,756 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-29 02:51:51,756 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-29 02:51:54,554 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-29 02:51:54,554 - INFO - Finished loading the checkpoint in 2.80 seconds.
[rank0]:2025-11-29 02:51:54,554 - INFO - Training starts at step 1
[rank2]:2025-11-29 02:52:00,420 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  4.59GiB(9.67%)  tps: 2,953  tflops: 23.08  mfu: 7.40%
[rank2]:2025-11-29 02:52:00,420 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-29 02:52:00,425 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  6.72GiB(14.15%)  tps: 2,952  tflops: 23.08  mfu: 7.40%
[rank1]:2025-11-29 02:52:00,425 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-29 02:52:00,431 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 12.97GiB(27.31%)  tps: 3,669  tflops: 28.69  mfu: 9.19%
[rank3]:2025-11-29 02:52:00,432 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-29 02:52:00,459 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  9.17GiB(19.29%)  tps: 2,948  tflops: 23.05  mfu: 7.39%
[rank0]:2025-11-29 02:52:00,459 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-29 02:54:08,281 - INFO - Avg. fwd time: 7.4925 / Avg. bwd time: 19.8071 / Avg. batch time: 570.3153 (ms) / GPU bubble ratio: 61.71%
[rank3]:2025-11-29 02:54:08,250 - INFO - Avg. fwd time: 13.0493 / Avg. bwd time: 43.8145 / Avg. batch time: 536.8944 (ms) / GPU bubble ratio: 15.27%
[rank0]:2025-11-29 02:54:08,324 - INFO - Avg. fwd time: 7.7401 / Avg. bwd time: 25.5613 / Avg. batch time: 650.3564 (ms) / GPU bubble ratio: 59.04%
[rank1]:2025-11-29 02:54:08,311 - INFO - Avg. fwd time: 9.6020 / Avg. bwd time: 25.0063 / Avg. batch time: 610.8716 (ms) / GPU bubble ratio: 54.68%
[rank0]:2025-11-29 02:56:16,992 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-29 02:56:22,110 - INFO - Avg. fwd time: 7.5039 / Avg. bwd time: 19.8700 / Avg. batch time: 572.5677 (ms) / GPU bubble ratio: 61.75%
[rank3]:2025-11-29 02:56:22,079 - INFO - Avg. fwd time: 13.1756 / Avg. bwd time: 44.0444 / Avg. batch time: 539.6096 (ms) / GPU bubble ratio: 15.17%
[rank0]:2025-11-29 02:56:22,153 - INFO - Avg. fwd time: 7.7611 / Avg. bwd time: 25.6267 / Avg. batch time: 651.8834 (ms) / GPU bubble ratio: 59.03%
[rank1]:2025-11-29 02:56:22,140 - INFO - Avg. fwd time: 9.6493 / Avg. bwd time: 25.1072 / Avg. batch time: 612.7737 (ms) / GPU bubble ratio: 54.62%
[rank2]:2025-11-29 02:56:22,321 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  6.39GiB(13.45%)  tps: 6,131  tflops: 47.93  mfu: 15.36%
[rank3]:2025-11-29 02:56:22,334 - INFO -  step: 50  loss:  9.9211  grad_norm: 12.8635  memory: 16.39GiB(34.50%)  tps: 6,131  tflops: 47.93  mfu: 15.36%
[rank0]:2025-11-29 02:56:22,336 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory: 12.97GiB(27.31%)  tps: 6,131  tflops: 47.93  mfu: 15.36%
[rank1]:2025-11-29 02:56:22,325 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8635  memory:  8.99GiB(18.92%)  tps: 6,131  tflops: 47.93  mfu: 15.36%
[rank3]:2025-11-29 02:57:15,760 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-29 02:58:09,333 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-29 02:58:09,592 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-29 02:58:27,724 - INFO - Avg. fwd time: 13.3256 / Avg. bwd time: 42.6704 / Avg. batch time: 529.7666 (ms) / GPU bubble ratio: 15.44%
[rank1]:2025-11-29 02:58:27,757 - INFO - Avg. fwd time: 9.7719 / Avg. bwd time: 24.2557 / Avg. batch time: 601.0788 (ms) / GPU bubble ratio: 54.71%
[rank2]:2025-11-29 02:58:27,739 - INFO - Avg. fwd time: 7.6057 / Avg. bwd time: 19.1899 / Avg. batch time: 561.8693 (ms) / GPU bubble ratio: 61.85%
[rank0]:2025-11-29 02:58:27,762 - INFO - Avg. fwd time: 7.8584 / Avg. bwd time: 23.9535 / Avg. batch time: 638.3352 (ms) / GPU bubble ratio: 60.13%
[rank3]:2025-11-29 02:58:45,898 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-29 02:58:46,084 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0258_max_batch_time.svg
[rank3]:			> Batch Time: 560.45 ms, GPU Bubble Ratio: 52.19%, 50.33%, 60.91%, 17.99%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-7-33ms      | [S0,MB0,B]  132-26-158ms   | [S0,MB4,F]  158-7-166ms    | [S0,MB1,B]  186-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  244-25-269ms   | [S0,MB6,F]  269-6-276ms    | [S0,MB3,B]  301-25-327ms   | [S0,MB7,F]  327-7-334ms    | [S0,MB4,B]  360-25-386ms   | [S0,MB5,B]  418-25-443ms   | [S0,MB6,B]  476-25-502ms   | [S0,MB7,B]  534-25-560ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-9-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-132ms   | [S1,MB3,F]  132-9-142ms    | [S1,MB1,B]  161-25-186ms   | [S1,MB4,F]  186-9-196ms    | [S1,MB2,B]  219-25-244ms   | [S1,MB5,F]  244-9-254ms    | [S1,MB3,B]  276-25-301ms   | [S1,MB6,F]  301-9-311ms    | [S1,MB4,B]  335-25-360ms   | [S1,MB7,F]  360-9-370ms    | [S1,MB5,B]  393-25-418ms   | [S1,MB6,B]  451-25-476ms   | [S1,MB7,B]  509-25-534ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  219-7-226ms    | [S2,MB3,B]  256-19-276ms   | [S2,MB5,F]  276-7-283ms    | [S2,MB4,B]  315-19-335ms   | [S2,MB6,F]  335-7-342ms    | [S2,MB5,B]  373-19-393ms   | [S2,MB7,F]  393-7-400ms    | [S2,MB6,B]  431-19-451ms   | [S2,MB7,B]  489-19-509ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-11-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-44-199ms   AFR(10):0.9655 | [S3,MB3,F]  199-13-212ms   | [S3,MB3,B]  212-43-256ms   AFR(10):0.9655 | [S3,MB4,F]  256-13-270ms   | [S3,MB4,B]  270-45-315ms   AFR(10):0.9655 | [S3,MB5,F]  315-13-328ms   | [S3,MB5,B]  328-44-373ms   AFR(10):0.9655 | [S3,MB6,F]  373-13-386ms   | [S3,MB6,B]  386-44-431ms   AFR(10):0.9655 | [S3,MB7,F]  431-13-445ms   | [S3,MB7,B]  445-44-489ms   AFR(10):0.9655
[rank3]:2025-11-29 02:58:46,216 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0258_min_batch_time.svg
[rank3]:			> Batch Time: 337.69 ms, GPU Bubble Ratio: 81.64%, 49.31%, 60.36%, 15.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-7-33ms      | [S0,MB0,B]  88-0-88ms      | [S0,MB4,F]  88-7-95ms      | [S0,MB1,B]  121-0-121ms    | [S0,MB5,F]  121-7-128ms    | [S0,MB2,B]  156-0-156ms    | [S0,MB6,F]  156-6-163ms    | [S0,MB3,B]  193-0-193ms    | [S0,MB7,F]  193-7-200ms    | [S0,MB4,B]  229-0-229ms    | [S0,MB5,B]  265-0-265ms    | [S0,MB6,B]  301-0-301ms    | [S0,MB7,B]  337-0-337ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-9-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  76-11-88ms     | [S1,MB3,F]  88-9-97ms      | [S1,MB1,B]  110-11-121ms   | [S1,MB4,F]  121-9-131ms    | [S1,MB2,B]  145-11-156ms   | [S1,MB5,F]  156-9-166ms    | [S1,MB3,B]  181-11-193ms   | [S1,MB6,F]  193-9-202ms    | [S1,MB4,B]  217-11-229ms   | [S1,MB7,F]  229-9-238ms    | [S1,MB5,B]  253-11-265ms   | [S1,MB6,B]  289-11-301ms   | [S1,MB7,B]  326-11-337ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  67-9-76ms      | [S2,MB2,F]  76-7-83ms      | [S2,MB1,B]  100-9-110ms    | [S2,MB3,F]  110-7-117ms    | [S2,MB2,B]  135-9-145ms    | [S2,MB4,F]  145-7-152ms    | [S2,MB3,B]  171-9-181ms    | [S2,MB5,F]  181-7-188ms    | [S2,MB4,B]  208-9-217ms    | [S2,MB6,F]  217-7-224ms    | [S2,MB5,B]  244-9-253ms    | [S2,MB7,F]  253-7-260ms    | [S2,MB6,B]  280-9-289ms    | [S2,MB7,B]  316-9-326ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-22-67ms     AFR(10):0.9655 | [S3,MB1,F]  67-11-78ms     | [S3,MB1,B]  78-22-100ms    AFR(10):0.9655 | [S3,MB2,F]  100-12-113ms   | [S3,MB2,B]  113-22-135ms   AFR(10):0.9655 | [S3,MB3,F]  135-13-149ms   | [S3,MB3,B]  149-22-171ms   AFR(10):0.9655 | [S3,MB4,F]  171-13-185ms   | [S3,MB4,B]  185-22-208ms   AFR(10):0.9655 | [S3,MB5,F]  208-13-221ms   | [S3,MB5,B]  221-23-244ms   AFR(10):0.9655 | [S3,MB6,F]  244-13-257ms   | [S3,MB6,B]  257-22-280ms   AFR(10):0.9655 | [S3,MB7,F]  280-13-294ms   | [S3,MB7,B]  294-22-316ms   AFR(10):0.9655
[rank3]:2025-11-29 02:58:59,164 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0258_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 404.31 ms, GPU Bubble Ratio: 43.40%, 34.45%, 48.44%, 12.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-7-33ms      | [S0,MB0,B]  132-26-158ms   | [S0,MB4,F]  158-7-166ms    | [S0,MB1,B]  186-25-212ms   | [S0,MB5,F]  212-7-219ms    | [S0,MB2,B]  221-25-247ms   | [S0,MB6,F]  247-6-254ms    | [S0,MB3,B]  279-25-305ms   | [S0,MB7,F]  305-7-312ms    | [S0,MB4,B]  315-25-341ms   | [S0,MB5,B]  356-25-381ms   | [S0,MB6,B]  392-12-404ms   | [S0,MB7,B]  404-0-404ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-9-30ms      | [S1,MB2,F]  30-9-39ms      | [S1,MB0,B]  107-25-132ms   | [S1,MB3,F]  132-9-142ms    | [S1,MB1,B]  161-25-186ms   | [S1,MB4,F]  186-9-196ms    | [S1,MB2,B]  196-25-221ms   | [S1,MB5,F]  221-9-231ms    | [S1,MB3,B]  254-25-279ms   | [S1,MB6,F]  279-9-288ms    | [S1,MB4,B]  290-25-315ms   | [S1,MB7,F]  315-9-325ms    | [S1,MB5,B]  330-25-356ms   | [S1,MB6,B]  367-25-392ms   | [S1,MB7,B]  392-11-404ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  30-7-37ms      | [S2,MB0,B]  87-20-107ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-19-161ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  176-19-196ms   | [S2,MB4,F]  196-7-204ms    | [S2,MB3,B]  234-19-254ms   | [S2,MB5,F]  254-7-261ms    | [S2,MB4,B]  270-19-290ms   | [S2,MB6,F]  290-7-297ms    | [S2,MB5,B]  310-19-330ms   | [S2,MB7,F]  330-7-338ms    | [S2,MB6,B]  347-19-367ms   | [S2,MB7,B]  383-9-392ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  44-42-87ms     AFR(10):0.9655 | [S3,MB1,F]  87-11-98ms     | [S3,MB1,B]  98-43-141ms    AFR(10):0.9655 | [S3,MB2,F]  141-12-154ms   | [S3,MB2,B]  154-22-176ms   AFR(10):0.9655 | [S3,MB3,F]  176-13-190ms   | [S3,MB3,B]  190-43-234ms   AFR(10):0.9655 | [S3,MB4,F]  234-13-247ms   | [S3,MB4,B]  247-22-270ms   AFR(10):0.9655 | [S3,MB5,F]  270-13-283ms   | [S3,MB5,B]  283-27-310ms   AFR(10):0.9655 | [S3,MB6,F]  310-13-324ms   | [S3,MB6,B]  324-22-347ms   AFR(10):0.9655 | [S3,MB7,F]  347-13-360ms   | [S3,MB7,B]  360-22-383ms   AFR(10):0.9655
[rank3]:2025-11-29 02:58:59,165 - INFO - 	> Batch Time: 404.31 ms (Average Freeze Ratio: 0.26, Time Reduction Rate: 0.28)
[rank0]:2025-11-29 03:00:29,828 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 03:00:34,738 - INFO - Avg. fwd time: 13.5752 / Avg. bwd time: 40.1989 / Avg. batch time: 512.2967 (ms) / GPU bubble ratio: 16.03%
[rank3]:2025-11-29 03:00:34,754 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.28(0.33)/1.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.21(0.27)/0.80, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-11-29 03:00:34,772 - INFO - Avg. fwd time: 7.7192 / Avg. bwd time: 18.4492 / Avg. batch time: 544.4294 (ms) / GPU bubble ratio: 61.55%
[rank0]:2025-11-29 03:00:34,813 - INFO - Avg. fwd time: 8.0187 / Avg. bwd time: 21.1442 / Avg. batch time: 618.6532 (ms) / GPU bubble ratio: 62.29%
[rank1]:2025-11-29 03:00:34,801 - INFO - Avg. fwd time: 9.9215 / Avg. bwd time: 23.1407 / Avg. batch time: 583.3665 (ms) / GPU bubble ratio: 54.66%
[rank1]:2025-11-29 03:00:34,936 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-11-29 03:00:34,977 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1679  memory:  9.36GiB(19.71%)  tps: 6,485  tflops: 50.70  mfu: 16.25%
[rank3]:2025-11-29 03:00:34,986 - INFO -  step: 100  loss:  8.6863  grad_norm:  8.1679  memory: 17.37GiB(36.56%)  tps: 6,485  tflops: 50.70  mfu: 16.25%
[rank2]:2025-11-29 03:00:34,909 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-11-29 03:00:34,973 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1679  memory:  6.51GiB(13.70%)  tps: 6,485  tflops: 50.70  mfu: 16.25%
[rank0]:2025-11-29 03:00:34,959 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.18)/0.53, [MB7] 0.27(0.33)/1.00
[rank0]:2025-11-29 03:00:34,988 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1679  memory: 12.97GiB(27.31%)  tps: 6,485  tflops: 50.70  mfu: 16.25%
[rank1]:2025-11-29 03:00:35,065 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0300_stage1_step100.svg
[rank2]:2025-11-29 03:00:35,059 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0300_stage2_step100.svg
[rank0]:2025-11-29 03:00:35,065 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0300_stage0_step100.svg
[rank3]:2025-11-29 03:00:35,133 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0300_real_step100_rank3.svg
[rank3]:			> Batch Time: 632.84 ms, GPU Bubble Ratio: 64.03%, 57.01%, 66.02%, 29.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  147-17-164ms   | [S0,MB4,F]  164-7-172ms    | [S0,MB1,B]  212-17-229ms   | [S0,MB5,F]  229-7-236ms    | [S0,MB2,B]  282-17-299ms   | [S0,MB6,F]  299-7-306ms    | [S0,MB3,B]  350-17-367ms   | [S0,MB7,F]  368-7-375ms    | [S0,MB4,B]  418-25-443ms   | [S0,MB5,B]  482-25-508ms   | [S0,MB6,B]  547-21-568ms   | [S0,MB7,B]  611-21-632ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  24-9-33ms      | [S1,MB2,F]  37-9-46ms      | [S1,MB0,B]  119-22-142ms   | [S1,MB3,F]  145-9-155ms    | [S1,MB1,B]  184-22-207ms   | [S1,MB4,F]  210-9-220ms    | [S1,MB2,B]  254-22-277ms   | [S1,MB5,F]  280-9-290ms    | [S1,MB3,B]  320-25-345ms   | [S1,MB6,F]  349-9-358ms    | [S1,MB4,B]  387-25-413ms   | [S1,MB7,F]  416-9-426ms    | [S1,MB5,B]  453-25-479ms   | [S1,MB6,B]  518-25-543ms   | [S1,MB7,B]  583-24-607ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-9-30ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  97-17-114ms    | [S2,MB2,F]  118-7-125ms    | [S2,MB1,B]  162-17-179ms   | [S2,MB3,F]  183-7-190ms    | [S2,MB2,B]  229-20-249ms   | [S2,MB4,F]  253-7-260ms    | [S2,MB3,B]  295-20-315ms   | [S2,MB5,F]  318-7-326ms    | [S2,MB4,B]  362-20-382ms   | [S2,MB6,F]  386-7-393ms    | [S2,MB5,B]  429-20-449ms   | [S2,MB7,F]  452-7-459ms    | [S2,MB6,B]  494-20-514ms   | [S2,MB7,B]  560-19-579ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-40-92ms     | [S3,MB1,F]  95-11-107ms    | [S3,MB1,B]  114-43-157ms   | [S3,MB2,F]  161-13-174ms   | [S3,MB2,B]  181-43-224ms   | [S3,MB3,F]  228-13-241ms   | [S3,MB3,B]  249-40-290ms   | [S3,MB4,F]  293-13-307ms   | [S3,MB4,B]  314-43-357ms   | [S3,MB5,F]  361-14-375ms   | [S3,MB5,B]  382-41-423ms   | [S3,MB6,F]  427-14-441ms   | [S3,MB6,B]  448-41-489ms   | [S3,MB7,F]  493-13-506ms   | [S3,MB7,B]  514-42-557ms  
[rank3]:2025-11-29 03:00:35,177 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0300_stage3_step100.svg
[rank2]:2025-11-29 03:02:39,242 - INFO - Avg. fwd time: 7.6985 / Avg. bwd time: 18.5732 / Avg. batch time: 541.9181 (ms) / GPU bubble ratio: 61.22%
[rank3]:2025-11-29 03:02:39,211 - INFO - Avg. fwd time: 13.6620 / Avg. bwd time: 39.8030 / Avg. batch time: 509.8307 (ms) / GPU bubble ratio: 16.11%
[rank1]:2025-11-29 03:02:39,271 - INFO - Avg. fwd time: 9.9018 / Avg. bwd time: 23.2224 / Avg. batch time: 580.8839 (ms) / GPU bubble ratio: 54.38%
[rank0]:2025-11-29 03:02:39,283 - INFO - Avg. fwd time: 8.0243 / Avg. bwd time: 21.2590 / Avg. batch time: 616.2654 (ms) / GPU bubble ratio: 61.99%
[rank0]:2025-11-29 03:04:35,085 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 03:04:39,681 - INFO - Avg. fwd time: 13.7856 / Avg. bwd time: 39.0403 / Avg. batch time: 504.7391 (ms) / GPU bubble ratio: 16.27%
[rank3]:2025-11-29 03:04:39,686 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.48(0.53)/0.80, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank3]:2025-11-29 03:04:39,800 - INFO -  step: 150  loss:  4.0625  grad_norm:  3.1554  memory: 17.37GiB(36.56%)  tps: 6,692  tflops: 52.32  mfu: 16.77%
[rank2]:2025-11-29 03:04:39,707 - INFO - Avg. fwd time: 7.7101 / Avg. bwd time: 18.4913 / Avg. batch time: 536.5727 (ms) / GPU bubble ratio: 60.94%
[rank2]:2025-11-29 03:04:39,713 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank2]:2025-11-29 03:04:39,787 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.1554  memory:  6.51GiB(13.70%)  tps: 6,692  tflops: 52.32  mfu: 16.77%
[rank1]:2025-11-29 03:04:39,736 - INFO - Avg. fwd time: 9.9275 / Avg. bwd time: 23.0317 / Avg. batch time: 575.4011 (ms) / GPU bubble ratio: 54.18%
[rank1]:2025-11-29 03:04:39,743 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank1]:2025-11-29 03:04:39,791 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.1554  memory:  9.36GiB(19.71%)  tps: 6,692  tflops: 52.32  mfu: 16.77%
[rank0]:2025-11-29 03:04:39,766 - INFO - Avg. fwd time: 8.0741 / Avg. bwd time: 21.0058 / Avg. batch time: 610.6874 (ms) / GPU bubble ratio: 61.91%
[rank0]:2025-11-29 03:04:39,773 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.35)/0.53, [MB7] 0.59(0.67)/1.00
[rank0]:2025-11-29 03:04:39,802 - INFO -  step: 150  loss: -8.0000  grad_norm:  3.1554  memory: 13.29GiB(27.97%)  tps: 6,692  tflops: 52.32  mfu: 16.77%
[rank3]:2025-11-29 03:06:36,852 - INFO - Avg. fwd time: 13.8723 / Avg. bwd time: 38.3295 / Avg. batch time: 499.9432 (ms) / GPU bubble ratio: 16.47%
[rank2]:2025-11-29 03:06:36,881 - INFO - Avg. fwd time: 7.7161 / Avg. bwd time: 18.4516 / Avg. batch time: 531.6983 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-11-29 03:06:36,911 - INFO - Avg. fwd time: 9.9552 / Avg. bwd time: 22.8164 / Avg. batch time: 570.3949 (ms) / GPU bubble ratio: 54.04%
[rank0]:2025-11-29 03:06:36,924 - INFO - Avg. fwd time: 8.1123 / Avg. bwd time: 20.5756 / Avg. batch time: 605.3973 (ms) / GPU bubble ratio: 62.09%
[rank0]:2025-11-29 03:08:25,199 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 03:08:29,533 - INFO - Avg. fwd time: 13.9773 / Avg. bwd time: 37.3146 / Avg. batch time: 492.9216 (ms) / GPU bubble ratio: 16.75%
[rank3]:2025-11-29 03:08:29,542 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.76(0.80)/0.80, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-11-29 03:08:29,563 - INFO - Avg. fwd time: 7.7406 / Avg. bwd time: 18.3015 / Avg. batch time: 524.4744 (ms) / GPU bubble ratio: 60.28%
[rank1]:2025-11-29 03:08:29,592 - INFO - Avg. fwd time: 10.0002 / Avg. bwd time: 22.5149 / Avg. batch time: 562.9905 (ms) / GPU bubble ratio: 53.80%
[rank0]:2025-11-29 03:08:29,605 - INFO - Avg. fwd time: 8.1788 / Avg. bwd time: 19.8936 / Avg. batch time: 597.6554 (ms) / GPU bubble ratio: 62.42%
[rank2]:2025-11-29 03:08:29,671 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-11-29 03:08:29,696 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-11-29 03:08:29,717 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.53)/0.53, [MB7] 0.95(1.00)/1.00
[rank0]:2025-11-29 03:08:29,746 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4706  memory: 13.29GiB(27.97%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank3]:2025-11-29 03:08:29,744 - INFO -  step: 200  loss:  1.4326  grad_norm:  1.4706  memory: 17.37GiB(36.56%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank2]:2025-11-29 03:08:29,731 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4706  memory:  6.51GiB(13.70%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank2]:2025-11-29 03:08:29,796 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0308_stage2_step200.svg
[rank1]:2025-11-29 03:08:29,735 - INFO -  step: 200  loss: -8.0000  grad_norm:  1.4706  memory:  9.36GiB(19.71%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank1]:2025-11-29 03:08:29,796 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0308_stage1_step200.svg
[rank0]:2025-11-29 03:08:29,795 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0308_stage0_step200.svg
[rank3]:2025-11-29 03:08:29,886 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0308_real_step200_rank3.svg
[rank3]:			> Batch Time: 543.67 ms, GPU Bubble Ratio: 66.50%, 54.46%, 63.16%, 33.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-10-39ms     | [S0,MB0,B]  112-5-117ms    | [S0,MB4,F]  117-8-126ms    | [S0,MB1,B]  180-5-185ms    | [S0,MB5,F]  185-6-192ms    | [S0,MB2,B]  250-5-255ms    | [S0,MB6,F]  255-6-262ms    | [S0,MB3,B]  313-5-319ms    | [S0,MB7,F]  319-6-325ms    | [S0,MB4,B]  376-26-402ms   | [S0,MB5,B]  426-25-452ms   | [S0,MB6,B]  480-20-501ms   | [S0,MB7,B]  524-19-543ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-49ms     | [S1,MB0,B]  93-13-107ms    | [S1,MB3,F]  110-11-121ms   | [S1,MB1,B]  161-13-175ms   | [S1,MB4,F]  178-9-187ms    | [S1,MB2,B]  231-13-245ms   | [S1,MB5,F]  248-8-257ms    | [S1,MB3,B]  282-25-308ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  343-25-368ms   | [S1,MB7,F]  374-9-384ms    | [S1,MB5,B]  397-25-423ms   | [S1,MB6,B]  451-25-476ms   | [S1,MB7,B]  498-22-521ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  79-9-88ms      | [S2,MB2,F]  92-9-101ms     | [S2,MB1,B]  147-9-156ms    | [S2,MB3,F]  160-7-167ms    | [S2,MB2,B]  206-20-226ms   | [S2,MB4,F]  230-7-237ms    | [S2,MB3,B]  257-20-277ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  317-20-337ms   | [S2,MB6,F]  341-7-348ms    | [S2,MB5,B]  372-20-393ms   | [S2,MB7,F]  396-7-403ms    | [S2,MB6,B]  427-20-448ms   | [S2,MB7,B]  478-17-495ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-22-74ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB1,B]  99-43-142ms    | [S3,MB2,F]  145-11-157ms   | [S3,MB2,B]  164-37-201ms   | [S3,MB3,F]  204-17-222ms   | [S3,MB3,B]  229-23-252ms   | [S3,MB4,F]  256-11-267ms   | [S3,MB4,B]  274-38-313ms   | [S3,MB5,F]  316-17-334ms   | [S3,MB5,B]  341-23-365ms   | [S3,MB6,F]  371-13-384ms   | [S3,MB6,B]  391-31-422ms   | [S3,MB7,F]  426-17-443ms   | [S3,MB7,B]  450-23-474ms  
[rank3]:2025-11-29 03:08:29,931 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0308_stage3_step200.svg
[rank3]:2025-11-29 03:10:20,954 - INFO - Avg. fwd time: 14.0699 / Avg. bwd time: 36.4201 / Avg. batch time: 486.7247 (ms) / GPU bubble ratio: 17.01%
[rank2]:2025-11-29 03:10:20,980 - INFO - Avg. fwd time: 7.7651 / Avg. bwd time: 18.1590 / Avg. batch time: 518.1367 (ms) / GPU bubble ratio: 59.97%
[rank1]:2025-11-29 03:10:21,009 - INFO - Avg. fwd time: 10.0461 / Avg. bwd time: 22.2239 / Avg. batch time: 556.4865 (ms) / GPU bubble ratio: 53.61%
[rank0]:2025-11-29 03:10:21,035 - INFO - Avg. fwd time: 8.2363 / Avg. bwd time: 18.9376 / Avg. batch time: 590.8329 (ms) / GPU bubble ratio: 63.21%
[rank0]:2025-11-29 03:12:07,148 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-29 03:12:11,390 - INFO - Avg. fwd time: 7.7814 / Avg. bwd time: 18.0634 / Avg. batch time: 513.4071 (ms) / GPU bubble ratio: 59.73%
[rank3]:2025-11-29 03:12:11,347 - INFO - Avg. fwd time: 14.1374 / Avg. bwd time: 35.7606 / Avg. batch time: 482.1498 (ms) / GPU bubble ratio: 17.21%
[rank3]:2025-11-29 03:12:11,362 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.79(0.80)/0.80, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-29 03:12:11,432 - INFO - Avg. fwd time: 8.2741 / Avg. bwd time: 18.2525 / Avg. batch time: 585.7674 (ms) / GPU bubble ratio: 63.77%
[rank2]:2025-11-29 03:12:11,487 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 03:12:11,419 - INFO - Avg. fwd time: 10.0770 / Avg. bwd time: 22.0223 / Avg. batch time: 551.6452 (ms) / GPU bubble ratio: 53.45%
[rank0]:2025-11-29 03:12:11,533 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.51(0.53)/0.53, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-29 03:12:11,547 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4118  memory:  6.51GiB(13.70%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank1]:2025-11-29 03:12:11,512 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 03:12:11,551 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4118  memory:  9.36GiB(19.71%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank3]:2025-11-29 03:12:11,559 - INFO -  step: 250  loss:  0.5128  grad_norm:  0.4118  memory: 17.37GiB(36.56%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank0]:2025-11-29 03:12:11,561 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4118  memory: 13.29GiB(27.97%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank2]:2025-11-29 03:14:02,048 - INFO - Avg. fwd time: 7.7973 / Avg. bwd time: 17.9733 / Avg. batch time: 508.9478 (ms) / GPU bubble ratio: 59.49%
[rank3]:2025-11-29 03:14:02,003 - INFO - Avg. fwd time: 14.2016 / Avg. bwd time: 35.1342 / Avg. batch time: 477.8376 (ms) / GPU bubble ratio: 17.40%
[rank0]:2025-11-29 03:14:02,091 - INFO - Avg. fwd time: 8.3102 / Avg. bwd time: 17.6112 / Avg. batch time: 580.9853 (ms) / GPU bubble ratio: 64.31%
[rank1]:2025-11-29 03:14:02,077 - INFO - Avg. fwd time: 10.1056 / Avg. bwd time: 21.8287 / Avg. batch time: 547.0787 (ms) / GPU bubble ratio: 53.30%
[rank0]:2025-11-29 03:15:48,572 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-29 03:15:52,939 - INFO - Avg. fwd time: 7.8103 / Avg. bwd time: 17.8999 / Avg. batch time: 505.2752 (ms) / GPU bubble ratio: 59.29%
[rank2]:2025-11-29 03:15:52,945 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-11-29 03:15:52,913 - INFO - Avg. fwd time: 14.2548 / Avg. bwd time: 34.6186 / Avg. batch time: 474.2796 (ms) / GPU bubble ratio: 17.56%
[rank3]:2025-11-29 03:15:52,919 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 1.00(1.00)/1.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.79(0.80)/0.80, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 03:15:52,969 - INFO - Avg. fwd time: 10.1284 / Avg. bwd time: 21.6708 / Avg. batch time: 543.3247 (ms) / GPU bubble ratio: 53.18%
[rank1]:2025-11-29 03:15:52,976 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-29 03:15:52,996 - INFO - Avg. fwd time: 8.3392 / Avg. bwd time: 17.0801 / Avg. batch time: 577.0558 (ms) / GPU bubble ratio: 64.76%
[rank0]:2025-11-29 03:15:53,004 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.51(0.53)/0.53, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-29 03:15:53,032 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1641  memory: 13.29GiB(27.97%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank2]:2025-11-29 03:15:53,018 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1641  memory:  6.51GiB(13.70%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank2]:2025-11-29 03:15:53,081 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0315_stage2_step300.svg
[rank3]:2025-11-29 03:15:53,031 - INFO -  step: 300  loss:  0.3286  grad_norm:  0.1641  memory: 17.37GiB(36.56%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank1]:2025-11-29 03:15:53,022 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.1641  memory:  9.36GiB(19.71%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank1]:2025-11-29 03:15:53,083 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0315_stage1_step300.svg
[rank0]:2025-11-29 03:15:53,083 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0315_stage0_step300.svg
[rank3]:2025-11-29 03:15:53,180 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0315_real_step300_rank3.svg
[rank3]:			> Batch Time: 537.06 ms, GPU Bubble Ratio: 70.03%, 54.69%, 62.54%, 34.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  249-0-249ms    | [S0,MB6,F]  249-6-256ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-321ms    | [S0,MB4,B]  378-26-404ms   | [S0,MB5,B]  429-25-455ms   | [S0,MB6,B]  477-20-497ms   | [S0,MB7,B]  518-19-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-105ms    | [S1,MB3,F]  108-11-120ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  232-11-244ms   | [S1,MB5,F]  247-9-256ms    | [S1,MB3,B]  284-25-309ms   | [S1,MB6,F]  313-9-322ms    | [S1,MB4,B]  344-25-370ms   | [S1,MB7,F]  376-9-386ms    | [S1,MB5,B]  399-25-424ms   | [S1,MB6,B]  447-25-473ms   | [S1,MB7,B]  492-22-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  147-9-156ms    | [S2,MB3,F]  160-7-167ms    | [S2,MB2,B]  207-20-227ms   | [S2,MB4,F]  231-7-238ms    | [S2,MB3,B]  258-20-278ms   | [S2,MB5,F]  282-7-289ms    | [S2,MB4,B]  319-20-339ms   | [S2,MB6,F]  343-7-350ms    | [S2,MB5,B]  373-20-394ms   | [S2,MB7,F]  397-7-404ms    | [S2,MB6,B]  423-20-443ms   | [S2,MB7,B]  471-17-488ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  99-43-142ms    | [S3,MB2,F]  145-11-157ms   | [S3,MB2,B]  164-37-201ms   | [S3,MB3,F]  205-17-223ms   | [S3,MB3,B]  230-23-253ms   | [S3,MB4,F]  257-11-268ms   | [S3,MB4,B]  276-38-314ms   | [S3,MB5,F]  318-18-336ms   | [S3,MB5,B]  343-23-366ms   | [S3,MB6,F]  372-15-387ms   | [S3,MB6,B]  394-23-418ms   | [S3,MB7,F]  422-15-437ms   | [S3,MB7,B]  445-22-467ms  
[rank3]:2025-11-29 03:15:53,225 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0315_stage3_step300.svg
[rank2]:2025-11-29 03:17:44,324 - INFO - Avg. fwd time: 7.8205 / Avg. bwd time: 17.8468 / Avg. batch time: 502.8159 (ms) / GPU bubble ratio: 59.16%
[rank3]:2025-11-29 03:17:44,282 - INFO - Avg. fwd time: 14.2939 / Avg. bwd time: 34.2613 / Avg. batch time: 471.8532 (ms) / GPU bubble ratio: 17.68%
[rank1]:2025-11-29 03:17:44,353 - INFO - Avg. fwd time: 10.1465 / Avg. bwd time: 21.5558 / Avg. batch time: 540.8047 (ms) / GPU bubble ratio: 53.10%
[rank0]:2025-11-29 03:17:44,366 - INFO - Avg. fwd time: 8.3618 / Avg. bwd time: 16.6790 / Avg. batch time: 574.4080 (ms) / GPU bubble ratio: 65.12%
[rank0]:2025-11-29 03:19:31,534 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 03:19:35,809 - INFO - Avg. fwd time: 14.3305 / Avg. bwd time: 33.9279 / Avg. batch time: 469.5285 (ms) / GPU bubble ratio: 17.78%
[rank2]:2025-11-29 03:19:35,854 - INFO - Avg. fwd time: 7.8305 / Avg. bwd time: 17.7931 / Avg. batch time: 500.4179 (ms) / GPU bubble ratio: 59.04%
[rank1]:2025-11-29 03:19:35,883 - INFO - Avg. fwd time: 10.1641 / Avg. bwd time: 21.4400 / Avg. batch time: 538.3423 (ms) / GPU bubble ratio: 53.04%
[rank0]:2025-11-29 03:19:35,895 - INFO - Avg. fwd time: 8.3841 / Avg. bwd time: 16.2790 / Avg. batch time: 571.8147 (ms) / GPU bubble ratio: 65.49%
[rank0]:2025-11-29 03:19:36,035 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0882  memory: 13.29GiB(27.97%)  tps: 7,347  tflops: 57.44  mfu: 18.41%
[rank2]:2025-11-29 03:19:36,020 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0882  memory:  6.51GiB(13.70%)  tps: 7,347  tflops: 57.44  mfu: 18.41%
[rank3]:2025-11-29 03:19:36,033 - INFO -  step: 350  loss:  0.2466  grad_norm:  0.0882  memory: 17.37GiB(36.56%)  tps: 7,347  tflops: 57.44  mfu: 18.41%
[rank1]:2025-11-29 03:19:36,024 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0882  memory:  9.36GiB(19.71%)  tps: 7,347  tflops: 57.44  mfu: 18.41%
[rank2]:2025-11-29 03:21:27,211 - INFO - Avg. fwd time: 7.8389 / Avg. bwd time: 17.7451 / Avg. batch time: 498.2689 (ms) / GPU bubble ratio: 58.92%
[rank1]:2025-11-29 03:21:27,241 - INFO - Avg. fwd time: 10.1789 / Avg. bwd time: 21.3386 / Avg. batch time: 536.1399 (ms) / GPU bubble ratio: 52.97%
[rank3]:2025-11-29 03:21:27,184 - INFO - Avg. fwd time: 14.3602 / Avg. bwd time: 33.6294 / Avg. batch time: 467.4496 (ms) / GPU bubble ratio: 17.87%
[rank0]:2025-11-29 03:21:27,269 - INFO - Avg. fwd time: 8.4021 / Avg. bwd time: 15.9467 / Avg. batch time: 569.4981 (ms) / GPU bubble ratio: 65.80%
[rank0]:2025-11-29 03:23:13,910 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 03:23:18,212 - INFO - Avg. fwd time: 14.3792 / Avg. bwd time: 33.4000 / Avg. batch time: 465.8264 (ms) / GPU bubble ratio: 17.94%
[rank2]:2025-11-29 03:23:18,257 - INFO - Avg. fwd time: 7.8446 / Avg. bwd time: 17.7077 / Avg. batch time: 496.5920 (ms) / GPU bubble ratio: 58.84%
[rank1]:2025-11-29 03:23:18,286 - INFO - Avg. fwd time: 10.1880 / Avg. bwd time: 21.2601 / Avg. batch time: 534.4221 (ms) / GPU bubble ratio: 52.92%
[rank0]:2025-11-29 03:23:18,299 - INFO - Avg. fwd time: 8.4143 / Avg. bwd time: 15.6851 / Avg. batch time: 567.6890 (ms) / GPU bubble ratio: 66.04%
[rank0]:2025-11-29 03:23:18,435 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0563  memory: 13.29GiB(27.97%)  tps: 7,367  tflops: 57.59  mfu: 18.46%
[rank2]:2025-11-29 03:23:18,420 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0563  memory:  6.51GiB(13.70%)  tps: 7,367  tflops: 57.59  mfu: 18.46%
[rank2]:2025-11-29 03:23:18,492 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0323_stage2_step400.svg
[rank1]:2025-11-29 03:23:18,424 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0563  memory:  9.36GiB(19.71%)  tps: 7,367  tflops: 57.59  mfu: 18.46%
[rank1]:2025-11-29 03:23:18,489 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0323_stage1_step400.svg
[rank3]:2025-11-29 03:23:18,433 - INFO -  step: 400  loss:  0.2191  grad_norm:  0.0563  memory: 17.37GiB(36.56%)  tps: 7,367  tflops: 57.59  mfu: 18.46%
[rank0]:2025-11-29 03:23:18,489 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0323_stage0_step400.svg
[rank3]:2025-11-29 03:23:18,584 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0323_real_step400_rank3.svg
[rank3]:			> Batch Time: 540.41 ms, GPU Bubble Ratio: 70.44%, 55.28%, 62.92%, 33.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB5,F]  177-6-184ms    | [S0,MB2,B]  248-0-248ms    | [S0,MB6,F]  248-6-255ms    | [S0,MB3,B]  312-0-312ms    | [S0,MB7,F]  312-6-319ms    | [S0,MB4,B]  374-26-400ms   | [S0,MB5,B]  424-25-450ms   | [S0,MB6,B]  479-20-499ms   | [S0,MB7,B]  521-18-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  107-11-119ms   | [S1,MB1,B]  160-11-172ms   | [S1,MB4,F]  175-8-184ms    | [S1,MB2,B]  231-11-243ms   | [S1,MB5,F]  246-8-255ms    | [S1,MB3,B]  281-25-307ms   | [S1,MB6,F]  310-9-319ms    | [S1,MB4,B]  341-25-367ms   | [S1,MB7,F]  372-9-382ms    | [S1,MB5,B]  396-25-421ms   | [S1,MB6,B]  449-25-475ms   | [S1,MB7,B]  495-22-517ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-155ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  205-20-226ms   | [S2,MB4,F]  229-7-236ms    | [S2,MB3,B]  256-20-276ms   | [S2,MB5,F]  280-7-287ms    | [S2,MB4,B]  316-20-336ms   | [S2,MB6,F]  340-7-347ms    | [S2,MB5,B]  370-20-390ms   | [S2,MB7,F]  394-7-401ms    | [S2,MB6,B]  426-20-446ms   | [S2,MB7,B]  474-17-491ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-42-141ms    | [S3,MB2,F]  144-11-156ms   | [S3,MB2,B]  163-37-200ms   | [S3,MB3,F]  204-17-221ms   | [S3,MB3,B]  228-23-251ms   | [S3,MB4,F]  254-11-266ms   | [S3,MB4,B]  273-37-311ms   | [S3,MB5,F]  315-18-333ms   | [S3,MB5,B]  340-23-363ms   | [S3,MB6,F]  369-13-382ms   | [S3,MB6,B]  389-31-421ms   | [S3,MB7,F]  424-16-441ms   | [S3,MB7,B]  448-22-471ms  
[rank3]:2025-11-29 03:23:18,633 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0323_stage3_step400.svg
[rank3]:2025-11-29 03:23:43,736 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-29 03:23:43,900 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-29 03:23:43,854 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-29 03:23:43,879 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-11-29 03:25:08,743 - INFO - Avg. fwd time: 14.4017 / Avg. bwd time: 33.1443 / Avg. batch time: 464.0157 (ms) / GPU bubble ratio: 18.03%
[rank2]:2025-11-29 03:25:08,786 - INFO - Avg. fwd time: 7.8503 / Avg. bwd time: 17.6680 / Avg. batch time: 494.7446 (ms) / GPU bubble ratio: 58.74%
[rank1]:2025-11-29 03:25:08,816 - INFO - Avg. fwd time: 10.1982 / Avg. bwd time: 21.1786 / Avg. batch time: 532.5299 (ms) / GPU bubble ratio: 52.86%
[rank0]:2025-11-29 03:25:08,831 - INFO - Avg. fwd time: 8.4279 / Avg. bwd time: 15.4271 / Avg. batch time: 565.7051 (ms) / GPU bubble ratio: 66.27%
[rank0]:2025-11-29 03:26:54,765 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-29 03:26:59,094 - INFO - Avg. fwd time: 7.8549 / Avg. bwd time: 17.6329 / Avg. batch time: 492.9844 (ms) / GPU bubble ratio: 58.64%
[rank3]:2025-11-29 03:26:59,067 - INFO - Avg. fwd time: 14.4208 / Avg. bwd time: 32.9080 / Avg. batch time: 462.3199 (ms) / GPU bubble ratio: 18.10%
[rank1]:2025-11-29 03:26:59,126 - INFO - Avg. fwd time: 10.2067 / Avg. bwd time: 21.1073 / Avg. batch time: 530.7342 (ms) / GPU bubble ratio: 52.80%
[rank1]:2025-11-29 03:26:59,180 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0763  memory:  9.36GiB(19.71%)  tps: 7,422  tflops: 58.02  mfu: 18.60%
[rank2]:2025-11-29 03:26:59,177 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0763  memory:  6.51GiB(13.70%)  tps: 7,422  tflops: 58.02  mfu: 18.60%
[rank3]:2025-11-29 03:26:59,190 - INFO -  step: 450  loss:  0.2295  grad_norm:  0.0763  memory: 17.41GiB(36.64%)  tps: 7,422  tflops: 58.02  mfu: 18.60%
[rank0]:2025-11-29 03:26:59,155 - INFO - Avg. fwd time: 8.4391 / Avg. bwd time: 15.1868 / Avg. batch time: 563.8292 (ms) / GPU bubble ratio: 66.48%
[rank0]:2025-11-29 03:26:59,191 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0763  memory: 13.29GiB(27.97%)  tps: 7,422  tflops: 58.02  mfu: 18.60%
[rank2]:2025-11-29 03:28:49,221 - INFO - Avg. fwd time: 7.8591 / Avg. bwd time: 17.6061 / Avg. batch time: 491.6277 (ms) / GPU bubble ratio: 58.56%
[rank1]:2025-11-29 03:28:49,251 - INFO - Avg. fwd time: 10.2131 / Avg. bwd time: 21.0525 / Avg. batch time: 529.3493 (ms) / GPU bubble ratio: 52.75%
[rank3]:2025-11-29 03:28:49,179 - INFO - Avg. fwd time: 14.4366 / Avg. bwd time: 32.7242 / Avg. batch time: 461.0138 (ms) / GPU bubble ratio: 18.16%
[rank0]:2025-11-29 03:28:49,264 - INFO - Avg. fwd time: 8.4483 / Avg. bwd time: 15.0042 / Avg. batch time: 562.3822 (ms) / GPU bubble ratio: 66.64%
[rank0]:2025-11-29 03:30:35,233 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-29 03:30:39,474 - INFO - Avg. fwd time: 7.8632 / Avg. bwd time: 17.5782 / Avg. batch time: 490.2044 (ms) / GPU bubble ratio: 58.48%
[rank3]:2025-11-29 03:30:39,433 - INFO - Avg. fwd time: 14.4530 / Avg. bwd time: 32.5316 / Avg. batch time: 459.6429 (ms) / GPU bubble ratio: 18.22%
[rank0]:2025-11-29 03:30:39,517 - INFO - Avg. fwd time: 8.4574 / Avg. bwd time: 14.8122 / Avg. batch time: 560.8625 (ms) / GPU bubble ratio: 66.81%
[rank1]:2025-11-29 03:30:39,504 - INFO - Avg. fwd time: 10.2195 / Avg. bwd time: 20.9952 / Avg. batch time: 527.8973 (ms) / GPU bubble ratio: 52.70%
[rank2]:2025-11-29 03:30:39,626 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0831  memory:  6.51GiB(13.70%)  tps: 7,432  tflops: 58.10  mfu: 18.62%
[rank1]:2025-11-29 03:30:39,630 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0831  memory:  9.36GiB(19.71%)  tps: 7,432  tflops: 58.10  mfu: 18.62%
[rank1]:2025-11-29 03:30:39,689 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0330_stage1_step500.svg
[rank3]:2025-11-29 03:30:39,639 - INFO -  step: 500  loss:  0.2206  grad_norm:  0.0831  memory: 17.41GiB(36.64%)  tps: 7,432  tflops: 58.10  mfu: 18.62%
[rank0]:2025-11-29 03:30:39,641 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0831  memory: 13.29GiB(27.97%)  tps: 7,432  tflops: 58.10  mfu: 18.62%
[rank0]:2025-11-29 03:30:39,689 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0330_stage0_step500.svg
[rank2]:2025-11-29 03:30:39,688 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0330_stage2_step500.svg
[rank3]:2025-11-29 03:30:39,779 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0330_real_step500_rank3.svg
[rank3]:			> Batch Time: 533.97 ms, GPU Bubble Ratio: 69.84%, 54.56%, 62.43%, 34.08%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  248-0-248ms    | [S0,MB6,F]  248-6-255ms    | [S0,MB3,B]  313-0-313ms    | [S0,MB7,F]  313-6-320ms    | [S0,MB4,B]  376-26-402ms   | [S0,MB5,B]  426-25-452ms   | [S0,MB6,B]  474-20-495ms   | [S0,MB7,B]  515-18-533ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  231-11-243ms   | [S1,MB5,F]  246-9-255ms    | [S1,MB3,B]  283-25-308ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  343-25-369ms   | [S1,MB7,F]  374-9-384ms    | [S1,MB5,B]  397-25-422ms   | [S1,MB6,B]  445-25-470ms   | [S1,MB7,B]  489-22-511ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  205-20-226ms   | [S2,MB4,F]  229-7-237ms    | [S2,MB3,B]  257-20-278ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  318-20-338ms   | [S2,MB6,F]  342-7-349ms    | [S2,MB5,B]  371-20-392ms   | [S2,MB7,F]  395-7-402ms    | [S2,MB6,B]  421-20-442ms   | [S2,MB7,B]  468-17-485ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-37-201ms   | [S3,MB3,F]  204-17-221ms   | [S3,MB3,B]  229-23-252ms   | [S3,MB4,F]  256-11-268ms   | [S3,MB4,B]  275-38-313ms   | [S3,MB5,F]  316-18-335ms   | [S3,MB5,B]  341-23-365ms   | [S3,MB6,F]  370-15-385ms   | [S3,MB6,B]  392-23-416ms   | [S3,MB7,F]  420-15-435ms   | [S3,MB7,B]  442-22-465ms  
[rank3]:2025-11-29 03:30:39,821 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0330_stage3_step500.svg
[rank2]:2025-11-29 03:32:30,303 - INFO - Avg. fwd time: 7.8677 / Avg. bwd time: 17.5538 / Avg. batch time: 489.0238 (ms) / GPU bubble ratio: 58.41%
[rank1]:2025-11-29 03:32:30,335 - INFO - Avg. fwd time: 10.2261 / Avg. bwd time: 20.9447 / Avg. batch time: 526.6946 (ms) / GPU bubble ratio: 52.65%
[rank3]:2025-11-29 03:32:30,275 - INFO - Avg. fwd time: 14.4700 / Avg. bwd time: 32.3635 / Avg. batch time: 458.4821 (ms) / GPU bubble ratio: 18.28%
[rank0]:2025-11-29 03:32:30,364 - INFO - Avg. fwd time: 8.4662 / Avg. bwd time: 14.6581 / Avg. batch time: 559.6033 (ms) / GPU bubble ratio: 66.94%
[rank0]:2025-11-29 03:34:16,576 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-29 03:34:20,862 - INFO - Avg. fwd time: 7.8712 / Avg. bwd time: 17.5345 / Avg. batch time: 488.0974 (ms) / GPU bubble ratio: 58.36%
[rank3]:2025-11-29 03:34:20,818 - INFO - Avg. fwd time: 14.4837 / Avg. bwd time: 32.2329 / Avg. batch time: 457.5933 (ms) / GPU bubble ratio: 18.33%
[rank0]:2025-11-29 03:34:20,906 - INFO - Avg. fwd time: 8.4733 / Avg. bwd time: 14.5313 / Avg. batch time: 558.6135 (ms) / GPU bubble ratio: 67.05%
[rank1]:2025-11-29 03:34:20,891 - INFO - Avg. fwd time: 10.2319 / Avg. bwd time: 20.9055 / Avg. batch time: 525.7507 (ms) / GPU bubble ratio: 52.62%
[rank2]:2025-11-29 03:34:21,017 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0658  memory:  6.51GiB(13.70%)  tps: 7,401  tflops: 57.85  mfu: 18.54%
[rank3]:2025-11-29 03:34:21,030 - INFO -  step: 550  loss:  0.2228  grad_norm:  0.0658  memory: 17.41GiB(36.64%)  tps: 7,401  tflops: 57.85  mfu: 18.54%
[rank1]:2025-11-29 03:34:21,021 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0658  memory:  9.36GiB(19.71%)  tps: 7,400  tflops: 57.85  mfu: 18.54%
[rank0]:2025-11-29 03:34:21,031 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0658  memory: 13.29GiB(27.97%)  tps: 7,401  tflops: 57.85  mfu: 18.54%
[rank3]:2025-11-29 03:36:11,179 - INFO - Avg. fwd time: 14.4969 / Avg. bwd time: 32.0878 / Avg. batch time: 456.5674 (ms) / GPU bubble ratio: 18.37%
[rank2]:2025-11-29 03:36:11,222 - INFO - Avg. fwd time: 7.8748 / Avg. bwd time: 17.5138 / Avg. batch time: 487.0318 (ms) / GPU bubble ratio: 58.30%
[rank1]:2025-11-29 03:36:11,251 - INFO - Avg. fwd time: 10.2372 / Avg. bwd time: 20.8638 / Avg. batch time: 524.6672 (ms) / GPU bubble ratio: 52.58%
[rank0]:2025-11-29 03:36:11,266 - INFO - Avg. fwd time: 8.4805 / Avg. bwd time: 14.3861 / Avg. batch time: 557.4818 (ms) / GPU bubble ratio: 67.19%
[rank0]:2025-11-29 03:37:57,422 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-29 03:38:01,832 - INFO - Avg. fwd time: 7.8784 / Avg. bwd time: 17.4950 / Avg. batch time: 486.1130 (ms) / GPU bubble ratio: 58.24%
[rank1]:2025-11-29 03:38:01,865 - INFO - Avg. fwd time: 10.2428 / Avg. bwd time: 20.8257 / Avg. batch time: 523.7302 (ms) / GPU bubble ratio: 52.54%
[rank3]:2025-11-29 03:38:01,803 - INFO - Avg. fwd time: 14.5109 / Avg. bwd time: 31.9592 / Avg. batch time: 455.6825 (ms) / GPU bubble ratio: 18.42%
[rank0]:2025-11-29 03:38:01,895 - INFO - Avg. fwd time: 8.4879 / Avg. bwd time: 14.2618 / Avg. batch time: 556.5035 (ms) / GPU bubble ratio: 67.30%
[rank2]:2025-11-29 03:38:01,916 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0897  memory:  6.51GiB(13.70%)  tps: 7,417  tflops: 57.98  mfu: 18.58%
[rank1]:2025-11-29 03:38:01,920 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0897  memory:  9.36GiB(19.71%)  tps: 7,417  tflops: 57.98  mfu: 18.58%
[rank1]:2025-11-29 03:38:01,981 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0338_stage1_step600.svg
[rank3]:2025-11-29 03:38:01,929 - INFO -  step: 600  loss:  0.2222  grad_norm:  0.0897  memory: 17.41GiB(36.64%)  tps: 7,417  tflops: 57.98  mfu: 18.58%
[rank0]:2025-11-29 03:38:01,930 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0897  memory: 13.29GiB(27.97%)  tps: 7,417  tflops: 57.98  mfu: 18.58%
[rank0]:2025-11-29 03:38:01,980 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0338_stage0_step600.svg
[rank2]:2025-11-29 03:38:01,981 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0338_stage2_step600.svg
[rank3]:2025-11-29 03:38:02,069 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0338_real_step600_rank3.svg
[rank3]:			> Batch Time: 533.55 ms, GPU Bubble Ratio: 69.13%, 54.50%, 62.47%, 34.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB5,F]  177-6-184ms    | [S0,MB2,B]  247-0-247ms    | [S0,MB6,F]  247-6-254ms    | [S0,MB3,B]  313-0-313ms    | [S0,MB7,F]  313-6-319ms    | [S0,MB4,B]  375-26-401ms   | [S0,MB5,B]  426-25-452ms   | [S0,MB6,B]  474-24-499ms   | [S0,MB7,B]  514-19-533ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  107-11-119ms   | [S1,MB1,B]  160-11-172ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  231-11-242ms   | [S1,MB5,F]  246-9-255ms    | [S1,MB3,B]  282-25-307ms   | [S1,MB6,F]  311-9-320ms    | [S1,MB4,B]  342-25-368ms   | [S1,MB7,F]  374-9-383ms    | [S1,MB5,B]  396-25-422ms   | [S1,MB6,B]  445-25-471ms   | [S1,MB7,B]  489-22-511ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-155ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  205-20-226ms   | [S2,MB4,F]  229-7-236ms    | [S2,MB3,B]  257-20-277ms   | [S2,MB5,F]  280-7-288ms    | [S2,MB4,B]  317-20-337ms   | [S2,MB6,F]  341-7-348ms    | [S2,MB5,B]  371-20-391ms   | [S2,MB7,F]  395-7-402ms    | [S2,MB6,B]  422-20-442ms   | [S2,MB7,B]  468-17-485ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-37-200ms   | [S3,MB3,F]  204-17-221ms   | [S3,MB3,B]  229-23-252ms   | [S3,MB4,F]  255-11-267ms   | [S3,MB4,B]  274-38-312ms   | [S3,MB5,F]  316-18-334ms   | [S3,MB5,B]  341-23-364ms   | [S3,MB6,F]  369-15-385ms   | [S3,MB6,B]  392-23-416ms   | [S3,MB7,F]  420-15-435ms   | [S3,MB7,B]  442-22-465ms  
[rank3]:2025-11-29 03:38:02,114 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0338_stage3_step600.svg
[rank3]:2025-11-29 03:39:52,331 - INFO - Avg. fwd time: 14.5216 / Avg. bwd time: 31.8550 / Avg. batch time: 454.9543 (ms) / GPU bubble ratio: 18.45%
[rank2]:2025-11-29 03:39:52,372 - INFO - Avg. fwd time: 7.8812 / Avg. bwd time: 17.4804 / Avg. batch time: 485.3776 (ms) / GPU bubble ratio: 58.20%
[rank1]:2025-11-29 03:39:52,397 - INFO - Avg. fwd time: 10.2469 / Avg. bwd time: 20.7961 / Avg. batch time: 522.9805 (ms) / GPU bubble ratio: 52.51%
[rank0]:2025-11-29 03:39:52,414 - INFO - Avg. fwd time: 8.4932 / Avg. bwd time: 14.1573 / Avg. batch time: 555.7202 (ms) / GPU bubble ratio: 67.39%
[rank0]:2025-11-29 03:41:38,708 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-29 03:41:42,958 - INFO - Avg. fwd time: 7.8843 / Avg. bwd time: 17.4641 / Avg. batch time: 484.5745 (ms) / GPU bubble ratio: 58.15%
[rank3]:2025-11-29 03:41:42,916 - INFO - Avg. fwd time: 14.5335 / Avg. bwd time: 31.7436 / Avg. batch time: 454.1833 (ms) / GPU bubble ratio: 18.49%
[rank1]:2025-11-29 03:41:42,988 - INFO - Avg. fwd time: 10.2521 / Avg. bwd time: 20.7637 / Avg. batch time: 522.1611 (ms) / GPU bubble ratio: 52.48%
[rank0]:2025-11-29 03:41:43,003 - INFO - Avg. fwd time: 8.4995 / Avg. bwd time: 14.0439 / Avg. batch time: 554.8667 (ms) / GPU bubble ratio: 67.50%
[rank2]:2025-11-29 03:41:43,107 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0694  memory:  6.51GiB(13.70%)  tps: 7,407  tflops: 57.91  mfu: 18.56%
[rank1]:2025-11-29 03:41:43,110 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0694  memory:  9.36GiB(19.71%)  tps: 7,407  tflops: 57.91  mfu: 18.56%
[rank0]:2025-11-29 03:41:43,121 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0694  memory: 13.29GiB(27.97%)  tps: 7,407  tflops: 57.91  mfu: 18.56%
[rank3]:2025-11-29 03:41:43,119 - INFO -  step: 650  loss:  0.2330  grad_norm:  0.0694  memory: 17.41GiB(36.64%)  tps: 7,407  tflops: 57.91  mfu: 18.56%
[rank2]:2025-11-29 03:43:33,474 - INFO - Avg. fwd time: 7.8865 / Avg. bwd time: 17.4483 / Avg. batch time: 483.8092 (ms) / GPU bubble ratio: 58.11%
[rank3]:2025-11-29 03:43:33,445 - INFO - Avg. fwd time: 14.5414 / Avg. bwd time: 31.6405 / Avg. batch time: 453.4467 (ms) / GPU bubble ratio: 18.52%
[rank1]:2025-11-29 03:43:33,508 - INFO - Avg. fwd time: 10.2556 / Avg. bwd time: 20.7321 / Avg. batch time: 521.3755 (ms) / GPU bubble ratio: 52.45%
[rank0]:2025-11-29 03:43:33,543 - INFO - Avg. fwd time: 8.5048 / Avg. bwd time: 13.9385 / Avg. batch time: 554.0504 (ms) / GPU bubble ratio: 67.59%
[rank0]:2025-11-29 03:45:19,520 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 03:45:23,734 - INFO - Avg. fwd time: 14.5476 / Avg. bwd time: 31.5586 / Avg. batch time: 452.8636 (ms) / GPU bubble ratio: 18.55%
[rank2]:2025-11-29 03:45:23,777 - INFO - Avg. fwd time: 7.8881 / Avg. bwd time: 17.4347 / Avg. batch time: 483.2001 (ms) / GPU bubble ratio: 58.07%
[rank1]:2025-11-29 03:45:23,806 - INFO - Avg. fwd time: 10.2585 / Avg. bwd time: 20.7061 / Avg. batch time: 520.7480 (ms) / GPU bubble ratio: 52.43%
[rank0]:2025-11-29 03:45:23,820 - INFO - Avg. fwd time: 8.5091 / Avg. bwd time: 13.8589 / Avg. batch time: 553.3963 (ms) / GPU bubble ratio: 67.66%
[rank2]:2025-11-29 03:45:23,926 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0713  memory:  6.51GiB(13.70%)  tps: 7,420  tflops: 58.00  mfu: 18.59%
[rank1]:2025-11-29 03:45:23,929 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0713  memory:  9.36GiB(19.71%)  tps: 7,420  tflops: 58.00  mfu: 18.59%
[rank3]:2025-11-29 03:45:23,938 - INFO -  step: 700  loss:  0.1935  grad_norm:  0.0713  memory: 17.41GiB(36.64%)  tps: 7,420  tflops: 58.00  mfu: 18.59%
[rank0]:2025-11-29 03:45:23,941 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0713  memory: 13.29GiB(27.97%)  tps: 7,420  tflops: 58.00  mfu: 18.59%
[rank2]:2025-11-29 03:45:23,994 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0345_stage2_step700.svg
[rank1]:2025-11-29 03:45:23,993 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0345_stage1_step700.svg
[rank3]:2025-11-29 03:45:24,077 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0345_real_step700_rank3.svg
[rank3]:			> Batch Time: 535.03 ms, GPU Bubble Ratio: 69.34%, 54.68%, 62.62%, 34.15%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  109-0-109ms    | [S0,MB4,F]  109-8-118ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-184ms    | [S0,MB2,B]  248-0-248ms    | [S0,MB6,F]  248-6-255ms    | [S0,MB3,B]  313-0-313ms    | [S0,MB7,F]  313-6-319ms    | [S0,MB4,B]  375-26-401ms   | [S0,MB5,B]  427-25-452ms   | [S0,MB6,B]  475-23-499ms   | [S0,MB7,B]  516-19-535ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  92-11-104ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-172ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  231-11-243ms   | [S1,MB5,F]  246-9-255ms    | [S1,MB3,B]  282-25-307ms   | [S1,MB6,F]  311-9-320ms    | [S1,MB4,B]  342-25-368ms   | [S1,MB7,F]  374-9-383ms    | [S1,MB5,B]  396-25-422ms   | [S1,MB6,B]  446-25-472ms   | [S1,MB7,B]  490-22-512ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-30ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-87ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-166ms    | [S2,MB2,B]  205-20-226ms   | [S2,MB4,F]  229-7-237ms    | [S2,MB3,B]  257-20-277ms   | [S2,MB5,F]  280-7-288ms    | [S2,MB4,B]  317-20-337ms   | [S2,MB6,F]  341-7-348ms    | [S2,MB5,B]  371-20-391ms   | [S2,MB7,F]  395-7-402ms    | [S2,MB6,B]  422-20-442ms   | [S2,MB7,B]  470-17-487ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-37-201ms   | [S3,MB3,F]  204-17-221ms   | [S3,MB3,B]  229-23-252ms   | [S3,MB4,F]  255-11-267ms   | [S3,MB4,B]  274-38-312ms   | [S3,MB5,F]  316-18-334ms   | [S3,MB5,B]  341-23-364ms   | [S3,MB6,F]  370-15-385ms   | [S3,MB6,B]  392-24-416ms   | [S3,MB7,F]  421-15-436ms   | [S3,MB7,B]  444-22-466ms  
[rank0]:2025-11-29 03:45:23,994 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0345_stage0_step700.svg
[rank3]:2025-11-29 03:45:24,123 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0345_stage3_step700.svg
[rank3]:2025-11-29 03:47:15,053 - INFO - Avg. fwd time: 14.5530 / Avg. bwd time: 31.4880 / Avg. batch time: 452.3652 (ms) / GPU bubble ratio: 18.58%
[rank1]:2025-11-29 03:47:15,129 - INFO - Avg. fwd time: 10.2618 / Avg. bwd time: 20.6780 / Avg. batch time: 520.2212 (ms) / GPU bubble ratio: 52.42%
[rank2]:2025-11-29 03:47:15,099 - INFO - Avg. fwd time: 7.8896 / Avg. bwd time: 17.4205 / Avg. batch time: 482.6975 (ms) / GPU bubble ratio: 58.05%
[rank0]:2025-11-29 03:47:15,149 - INFO - Avg. fwd time: 8.5138 / Avg. bwd time: 13.7787 / Avg. batch time: 552.8412 (ms) / GPU bubble ratio: 67.74%
[rank0]:2025-11-29 03:49:01,349 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 03:49:05,709 - INFO - Avg. fwd time: 14.5608 / Avg. bwd time: 31.4071 / Avg. batch time: 451.8086 (ms) / GPU bubble ratio: 18.61%
[rank1]:2025-11-29 03:49:05,774 - INFO - Avg. fwd time: 10.2655 / Avg. bwd time: 20.6531 / Avg. batch time: 519.6260 (ms) / GPU bubble ratio: 52.40%
[rank2]:2025-11-29 03:49:05,739 - INFO - Avg. fwd time: 7.8918 / Avg. bwd time: 17.4082 / Avg. batch time: 482.1183 (ms) / GPU bubble ratio: 58.02%
[rank2]:2025-11-29 03:49:05,827 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0806  memory:  6.51GiB(13.70%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank3]:2025-11-29 03:49:05,840 - INFO -  step: 750  loss:  0.2327  grad_norm:  0.0806  memory: 17.41GiB(36.64%)  tps: 7,384  tflops: 57.72  mfu: 18.50%
[rank0]:2025-11-29 03:49:05,805 - INFO - Avg. fwd time: 8.5184 / Avg. bwd time: 13.7035 / Avg. batch time: 552.2205 (ms) / GPU bubble ratio: 67.81%
[rank0]:2025-11-29 03:49:05,841 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0806  memory: 13.29GiB(27.97%)  tps: 7,384  tflops: 57.72  mfu: 18.50%
[rank1]:2025-11-29 03:49:05,830 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0806  memory:  9.36GiB(19.71%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank3]:2025-11-29 03:50:56,802 - INFO - Avg. fwd time: 14.5657 / Avg. bwd time: 31.3550 / Avg. batch time: 451.4328 (ms) / GPU bubble ratio: 18.62%
[rank1]:2025-11-29 03:50:56,874 - INFO - Avg. fwd time: 10.2689 / Avg. bwd time: 20.6332 / Avg. batch time: 519.2226 (ms) / GPU bubble ratio: 52.39%
[rank2]:2025-11-29 03:50:56,845 - INFO - Avg. fwd time: 7.8934 / Avg. bwd time: 17.3983 / Avg. batch time: 481.7305 (ms) / GPU bubble ratio: 58.00%
[rank0]:2025-11-29 03:50:56,889 - INFO - Avg. fwd time: 8.5218 / Avg. bwd time: 13.6345 / Avg. batch time: 551.7949 (ms) / GPU bubble ratio: 67.88%
[rank0]:2025-11-29 03:52:43,176 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 03:52:47,450 - INFO - Avg. fwd time: 14.5719 / Avg. bwd time: 31.2896 / Avg. batch time: 450.9712 (ms) / GPU bubble ratio: 18.64%
[rank2]:2025-11-29 03:52:47,491 - INFO - Avg. fwd time: 7.8953 / Avg. bwd time: 17.3876 / Avg. batch time: 481.2521 (ms) / GPU bubble ratio: 57.97%
[rank0]:2025-11-29 03:52:47,533 - INFO - Avg. fwd time: 8.5258 / Avg. bwd time: 13.5657 / Avg. batch time: 551.2772 (ms) / GPU bubble ratio: 67.94%
[rank1]:2025-11-29 03:52:47,520 - INFO - Avg. fwd time: 10.2728 / Avg. bwd time: 20.6116 / Avg. batch time: 518.7277 (ms) / GPU bubble ratio: 52.37%
[rank0]:2025-11-29 03:52:47,652 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0686  memory: 13.29GiB(27.97%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank0]:2025-11-29 03:52:47,653 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0686  tps: 7,614  tflops: 59.52  mfu: 17.41%
[rank0]:2025-11-29 03:52:47,653 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-29 03:52:47,653 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-29 03:52:47,650 - INFO -  step: 800  loss:  0.2363  grad_norm:  0.0686  memory: 17.41GiB(36.64%)  tps: 7,387  tflops: 57.74  mfu: 18.51%
[rank3]:2025-11-29 03:52:47,651 - INFO -  final step: 800  loss:  0.2363  grad_norm:  0.0686  tps: 7,618  tflops: 59.56  mfu: 17.52%
[rank3]:2025-11-29 03:52:47,651 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-29 03:52:47,653 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-29 03:52:47,641 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0686  memory:  9.36GiB(19.71%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank1]:2025-11-29 03:52:47,642 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0686  tps: 7,614  tflops: 59.52  mfu: 17.41%
[rank1]:2025-11-29 03:52:47,642 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-29 03:52:47,643 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-29 03:52:47,637 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0686  memory:  6.51GiB(13.70%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank2]:2025-11-29 03:52:47,638 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0686  tps: 7,614  tflops: 59.52  mfu: 17.41%
[rank2]:2025-11-29 03:52:47,638 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-29 03:52:47,638 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-29 03:52:49,910 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-29 03:52:49,980 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank1/251129_0352_stage1_final800.svg
[rank2]:2025-11-29 03:52:49,981 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank2/251129_0352_stage2_final800.svg
[rank0]:2025-11-29 03:52:49,981 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank0/251129_0352_stage0_final800.svg
[rank3]:2025-11-29 03:52:50,062 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0352_real_final800_rank3.svg
[rank3]:			> Batch Time: 537.58 ms, GPU Bubble Ratio: 70.08%, 54.85%, 62.73%, 34.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-10-29ms     | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  110-0-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB5,F]  178-6-185ms    | [S0,MB2,B]  249-0-249ms    | [S0,MB6,F]  249-6-256ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-321ms    | [S0,MB4,B]  376-26-402ms   | [S0,MB5,B]  428-25-454ms   | [S0,MB6,B]  477-20-498ms   | [S0,MB7,B]  518-19-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-11-35ms     | [S1,MB2,F]  38-11-50ms     | [S1,MB0,B]  93-11-105ms    | [S1,MB3,F]  108-11-119ms   | [S1,MB1,B]  161-11-173ms   | [S1,MB4,F]  176-9-185ms    | [S1,MB2,B]  232-11-243ms   | [S1,MB5,F]  247-9-256ms    | [S1,MB3,B]  283-25-308ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  343-25-369ms   | [S1,MB7,F]  375-9-384ms    | [S1,MB5,B]  398-25-424ms   | [S1,MB6,B]  448-25-474ms   | [S1,MB7,B]  492-22-515ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-9-29ms      | [S2,MB1,F]  35-9-44ms      | [S2,MB0,B]  78-9-88ms      | [S2,MB2,F]  91-9-100ms     | [S2,MB1,B]  146-9-156ms    | [S2,MB3,F]  159-7-167ms    | [S2,MB2,B]  206-20-227ms   | [S2,MB4,F]  230-7-237ms    | [S2,MB3,B]  258-20-278ms   | [S2,MB5,F]  281-7-289ms    | [S2,MB4,B]  318-20-338ms   | [S2,MB6,F]  342-7-349ms    | [S2,MB5,B]  373-20-393ms   | [S2,MB7,F]  396-7-404ms    | [S2,MB6,B]  424-20-445ms   | [S2,MB7,B]  472-17-489ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-14-44ms     | [S3,MB0,B]  51-21-73ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB1,B]  98-43-141ms    | [S3,MB2,F]  145-11-156ms   | [S3,MB2,B]  163-37-201ms   | [S3,MB3,F]  205-17-222ms   | [S3,MB3,B]  229-23-253ms   | [S3,MB4,F]  256-11-268ms   | [S3,MB4,B]  275-38-313ms   | [S3,MB5,F]  317-17-334ms   | [S3,MB5,B]  342-23-365ms   | [S3,MB6,F]  371-15-386ms   | [S3,MB6,B]  393-24-418ms   | [S3,MB7,F]  423-15-438ms   | [S3,MB7,B]  445-22-468ms  
[rank0]:2025-11-29 03:52:50,138 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251129_0352_rank0_stage0.svg
[rank0]:	> Counts Sum: 326800, Total Sum: 1728640 (18.91%), Ratio(%) per element: [22.43, 23.11, 21.74, 22.6, 22.08, 20.2, 20.71, 21.4, 20.89, 21.91, 21.23, 20.71, 20.37, 21.23, 20.89, 19.52, 19.34, 19.86, 19.52, 19.52, 19.34, 17.97, 17.46, 18.15, 17.12, 18.32, 17.12, 17.29, 15.58, 16.6, 15.58, 15.75, 15.58, 15.58, 13.69, 15.58, 13.35]
[rank1]:2025-11-29 03:52:50,132 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251129_0352_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank2]:2025-11-29 03:52:50,144 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251129_0352_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank3]:2025-11-29 03:52:50,193 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/pipeline_schedule/251129_0352_thry_final800_rank3.svg
[rank3]:			> Batch Time: 342.82 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-31ms     | [S0,MB3,F]  31-10-41ms     | [S0,MB0,B]  103-20-124ms   | [S0,MB4,F]  124-10-135ms   | [S0,MB1,B]  135-20-155ms   | [S0,MB5,F]  155-10-166ms   | [S0,MB2,B]  166-20-186ms   | [S0,MB6,F]  186-10-197ms   | [S0,MB3,B]  197-20-218ms   | [S0,MB7,F]  218-10-228ms   | [S0,MB4,B]  228-20-249ms   | [S0,MB5,B]  259-20-280ms   | [S0,MB6,B]  290-20-311ms   | [S0,MB7,B]  322-20-342ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-41ms     | [S1,MB0,B]  83-20-103ms    | [S1,MB3,F]  103-10-114ms   | [S1,MB1,B]  114-20-135ms   | [S1,MB4,F]  135-10-145ms   | [S1,MB2,B]  145-20-166ms   | [S1,MB5,F]  166-10-176ms   | [S1,MB3,B]  176-20-197ms   | [S1,MB6,F]  197-10-207ms   | [S1,MB4,B]  207-20-228ms   | [S1,MB7,F]  228-10-238ms   | [S1,MB5,B]  238-20-259ms   | [S1,MB6,B]  270-20-290ms   | [S1,MB7,B]  301-20-322ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms     | [S2,MB1,F]  31-10-41ms     | [S2,MB0,B]  62-20-83ms     | [S2,MB2,F]  83-10-93ms     | [S2,MB1,B]  93-20-114ms    | [S2,MB3,F]  114-10-124ms   | [S2,MB2,B]  124-20-145ms   | [S2,MB4,F]  145-10-155ms   | [S2,MB3,B]  155-20-176ms   | [S2,MB5,F]  176-10-186ms   | [S2,MB4,B]  186-20-207ms   | [S2,MB6,F]  207-10-218ms   | [S2,MB5,B]  218-20-238ms   | [S2,MB7,F]  238-10-249ms   | [S2,MB6,B]  249-20-270ms   | [S2,MB7,B]  280-20-301ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms     | [S3,MB0,B]  41-20-62ms     | [S3,MB1,F]  62-10-72ms     | [S3,MB1,B]  72-20-93ms     | [S3,MB2,F]  93-10-103ms    | [S3,MB2,B]  103-20-124ms   | [S3,MB3,F]  124-10-135ms   | [S3,MB3,B]  135-20-155ms   | [S3,MB4,F]  155-10-166ms   | [S3,MB4,B]  166-20-186ms   | [S3,MB5,F]  186-10-197ms   | [S3,MB5,B]  197-20-218ms   | [S3,MB6,F]  218-10-228ms   | [S3,MB6,B]  228-20-249ms   | [S3,MB7,F]  249-10-259ms   | [S3,MB7,B]  259-20-280ms  
[rank3]:2025-11-29 03:52:50,241 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_ratio_history/rank3/251129_0352_stage3_final800.svg
[rank3]:2025-11-29 03:52:50,379 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/frozen_params_histogram/251129_0352_rank3_stage3.svg
[rank3]:	> Counts Sum: 769600, Total Sum: 1354880 (56.80%), Ratio(%) per element: [57.7, 57.19, 56.67, 56.67, 55.82, 57.7, 55.99, 56.5, 57.53, 56.84, 57.36, 55.82, 57.87, 55.13, 57.53, 57.02, 58.04, 56.16, 56.5, 56.33, 57.02, 56.84, 57.36, 56.5, 56.5, 56.67, 56.5, 55.65, 57.7]
[rank1]:2025-11-29 03:52:51,999 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251129_0352_stage1.svg
[rank1]:2025-11-29 03:52:52,005 - INFO - Destroying the purge thread.
[rank2]:2025-11-29 03:52:51,971 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251129_0352_stage2.svg
[rank2]:2025-11-29 03:52:51,974 - INFO - Destroying the purge thread.
[rank2]:2025-11-29 03:52:52,021 - INFO - Process group destroyed
[rank0]:2025-11-29 03:52:52,058 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251129_0352_stage0.svg
[rank0]:2025-11-29 03:52:52,061 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-29 03:52:52,235 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1/afr_time_plot/251129_0352_stage3.svg
[rank3]:2025-11-29 03:52:52,239 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-11-29 03:52:52,492 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 16-16, summary, console lines 335-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.30131
[rank3]:wandb:               final/avg_loss 0.23626
[rank3]:wandb:             final/avg_mfu(%) 17.52016
[rank3]:wandb:             final/avg_tflops 59.55518
[rank3]:wandb:    final/avg_throughput(tps) 7618.14844
[rank3]:wandb:              final/grad_norm 0.06855
[rank3]:wandb:               final/max_loss 0.23626
[rank3]:wandb:                    grad_norm 0.06855
[rank3]:wandb: loss_metrics/global_avg_loss 0.23626
[rank3]:wandb: loss_metrics/global_max_loss 0.23626
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.6_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/q7ieifzq
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.6_42_dm1/20251129-0251/wandb/run-20251129_025150-q7ieifzq/logs
[rank3]:2025-11-29 03:52:53,484 - INFO - Process group destroyed
[rank0]:2025-11-29 03:52:54,062 - INFO - Training completed
[rank0]:2025-11-29 03:52:54,062 - INFO - Destroying the purge thread.
[rank0]:2025-11-29 03:52:54,505 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.12', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.6', 'layers.4', 'layers.5', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.1', 'layers.0', 'layers.3', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.15', 'layers.13', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.6_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.6
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
