
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 29. (í† ) 00:51:10 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.4_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.4) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.4
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-29 00:51:16,788 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank1]:2025-11-29 00:51:16,924 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-29 00:51:16,861 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank2]:2025-11-29 00:51:16,955 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-29 00:51:16,959 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-29 00:51:17,022 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-29 00:51:17,066 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-29 00:51:17,068 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-29 00:51:17,072 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-29 00:51:17,073 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-29 00:51:17,131 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-29 00:51:17,134 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-29 00:51:17,236 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-29 00:51:17,238 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-29 00:51:17,443 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-29 00:51:20,482 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-29 00:51:20,637 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-29 00:51:20,680 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-29 00:51:20,681 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-29 00:51:20,708 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-29 00:51:20,709 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-29 00:51:20,645 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-29 00:51:20,685 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-29 00:51:20,712 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-29 00:51:20,712 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-29 00:51:20,782 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-29 00:51:20,822 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-29 00:51:20,905 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-29 00:51:20,905 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-29 00:51:20,906 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-29 00:51:20,849 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank2]:2025-11-29 00:51:20,905 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-29 00:51:20,850 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-29 00:51:20,905 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-29 00:51:20,906 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-29 00:51:21,033 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-29 00:51:21,033 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-29 00:51:21,034 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run diaobh72
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.4_42_dm1/20251129-0051/wandb/run-20251129_005121-diaobh72
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/diaobh72
[rank3]:2025-11-29 00:51:23,214 - INFO - WandB logging enabled
[rank3]:2025-11-29 00:51:23,215 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-29 00:51:23,254 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-29 00:51:23,284 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-29 00:51:23,284 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-29 00:51:23,477 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank0]:2025-11-29 00:51:23,477 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-29 00:51:23,478 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-29 00:51:23,478 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-29 00:51:23,477 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-29 00:51:23,477 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-29 00:51:23,467 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-29 00:51:23,467 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-29 00:51:23,467 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-29 00:51:23,477 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-29 00:51:26,024 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-29 00:51:26,024 - INFO - Finished loading the checkpoint in 2.55 seconds.
[rank0]:2025-11-29 00:51:26,024 - INFO - Training starts at step 1
[rank2]:2025-11-29 00:51:31,625 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  4.63GiB(9.75%)  tps: 2,995  tflops: 23.42  mfu: 7.51%
[rank1]:2025-11-29 00:51:31,628 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  6.76GiB(14.24%)  tps: 3,033  tflops: 23.71  mfu: 7.60%
[rank1]:2025-11-29 00:51:31,628 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-29 00:51:31,625 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-29 00:51:31,635 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5370  memory: 12.97GiB(27.31%)  tps: 3,911  tflops: 30.58  mfu: 9.80%
[rank3]:2025-11-29 00:51:31,636 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-29 00:51:31,663 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  9.19GiB(19.34%)  tps: 2,984  tflops: 23.32  mfu: 7.48%
[rank0]:2025-11-29 00:51:31,663 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-29 00:53:33,677 - INFO - Avg. fwd time: 13.2745 / Avg. bwd time: 41.6521 / Avg. batch time: 511.8609 (ms) / GPU bubble ratio: 14.15%
[rank0]:2025-11-29 00:53:33,747 - INFO - Avg. fwd time: 7.3560 / Avg. bwd time: 23.5405 / Avg. batch time: 620.2128 (ms) / GPU bubble ratio: 60.15%
[rank1]:2025-11-29 00:53:33,751 - INFO - Avg. fwd time: 9.3301 / Avg. bwd time: 23.8885 / Avg. batch time: 583.0743 (ms) / GPU bubble ratio: 54.42%
[rank2]:2025-11-29 00:53:33,716 - INFO - Avg. fwd time: 7.2648 / Avg. bwd time: 18.9565 / Avg. batch time: 543.9893 (ms) / GPU bubble ratio: 61.44%
[rank0]:2025-11-29 00:55:37,009 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-29 00:55:41,876 - INFO - Avg. fwd time: 9.3491 / Avg. bwd time: 23.9736 / Avg. batch time: 585.9140 (ms) / GPU bubble ratio: 54.50%
[rank0]:2025-11-29 00:55:41,872 - INFO - Avg. fwd time: 7.3723 / Avg. bwd time: 23.6000 / Avg. batch time: 622.6470 (ms) / GPU bubble ratio: 60.21%
[rank2]:2025-11-29 00:55:41,842 - INFO - Avg. fwd time: 7.2761 / Avg. bwd time: 19.0161 / Avg. batch time: 547.2023 (ms) / GPU bubble ratio: 61.56%
[rank3]:2025-11-29 00:55:41,803 - INFO - Avg. fwd time: 13.4464 / Avg. bwd time: 41.9453 / Avg. batch time: 515.4868 (ms) / GPU bubble ratio: 14.04%
[rank1]:2025-11-29 00:55:42,107 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8339  memory:  9.03GiB(19.01%)  tps: 6,410  tflops: 50.11  mfu: 16.06%
[rank0]:2025-11-29 00:55:42,118 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8339  memory: 12.97GiB(27.31%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank2]:2025-11-29 00:55:42,103 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.8339  memory:  6.43GiB(13.53%)  tps: 6,410  tflops: 50.11  mfu: 16.06%
[rank3]:2025-11-29 00:55:42,115 - INFO -  step: 50  loss:  9.9141  grad_norm: 12.8339  memory: 16.39GiB(34.50%)  tps: 6,410  tflops: 50.11  mfu: 16.06%
[rank3]:2025-11-29 00:56:33,280 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-29 00:57:24,495 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-29 00:57:24,818 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-29 00:57:41,921 - INFO - Avg. fwd time: 7.3734 / Avg. bwd time: 18.3450 / Avg. batch time: 536.8011 (ms) / GPU bubble ratio: 61.67%
[rank3]:2025-11-29 00:57:41,906 - INFO - Avg. fwd time: 13.5437 / Avg. bwd time: 40.6549 / Avg. batch time: 505.9116 (ms) / GPU bubble ratio: 14.30%
[rank1]:2025-11-29 00:57:41,938 - INFO - Avg. fwd time: 9.4590 / Avg. bwd time: 23.1359 / Avg. batch time: 574.5251 (ms) / GPU bubble ratio: 54.61%
[rank0]:2025-11-29 00:57:41,944 - INFO - Avg. fwd time: 7.4532 / Avg. bwd time: 22.0573 / Avg. batch time: 609.5292 (ms) / GPU bubble ratio: 61.27%
[rank3]:2025-11-29 00:57:59,027 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-29 00:57:59,202 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0057_max_batch_time.svg
[rank3]:			> Batch Time: 541.73 ms, GPU Bubble Ratio: 54.16%, 50.85%, 61.15%, 17.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  126-23-150ms   | [S0,MB4,F]  150-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  233-23-257ms   | [S0,MB6,F]  257-6-264ms    | [S0,MB3,B]  290-23-314ms   | [S0,MB7,F]  314-6-321ms    | [S0,MB4,B]  346-23-370ms   | [S0,MB5,B]  403-23-427ms   | [S0,MB6,B]  460-23-484ms   | [S0,MB7,B]  518-23-541ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-24-126ms   | [S1,MB3,F]  126-8-135ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  209-24-233ms   | [S1,MB5,F]  233-9-242ms    | [S1,MB3,B]  266-24-290ms   | [S1,MB6,F]  290-9-299ms    | [S1,MB4,B]  322-24-346ms   | [S1,MB7,F]  346-9-355ms    | [S1,MB5,B]  379-24-403ms   | [S1,MB6,B]  436-23-460ms   | [S1,MB7,B]  494-23-518ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-6-109ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  190-19-209ms   | [S2,MB4,F]  209-6-216ms    | [S2,MB3,B]  247-19-266ms   | [S2,MB5,F]  266-7-273ms    | [S2,MB4,B]  303-19-322ms   | [S2,MB6,F]  322-6-329ms    | [S2,MB5,B]  360-19-379ms   | [S2,MB7,F]  379-6-386ms    | [S2,MB6,B]  417-19-436ms   | [S2,MB7,B]  475-19-494ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-14-149ms   | [S3,MB2,B]  149-41-190ms   AFR(10):0.9655 | [S3,MB3,F]  190-13-204ms   | [S3,MB3,B]  204-42-247ms   AFR(10):0.9655 | [S3,MB4,F]  247-13-261ms   | [S3,MB4,B]  261-42-303ms   AFR(10):0.9655 | [S3,MB5,F]  303-14-317ms   | [S3,MB5,B]  317-42-360ms   AFR(10):0.9655 | [S3,MB6,F]  360-14-374ms   | [S3,MB6,B]  374-42-417ms   AFR(10):0.9655 | [S3,MB7,F]  417-13-431ms   | [S3,MB7,B]  431-43-475ms   AFR(10):0.9655
[rank3]:2025-11-29 00:57:59,327 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0057_min_batch_time.svg
[rank3]:			> Batch Time: 330.13 ms, GPU Bubble Ratio: 82.24%, 51.18%, 61.73%, 14.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  151-0-151ms    | [S0,MB6,F]  151-6-158ms    | [S0,MB3,B]  186-0-186ms    | [S0,MB7,F]  186-6-193ms    | [S0,MB4,B]  222-0-222ms    | [S0,MB5,B]  258-0-258ms    | [S0,MB6,B]  294-0-294ms    | [S0,MB7,B]  330-0-330ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-124ms    | [S1,MB2,B]  140-10-151ms   | [S1,MB5,F]  151-9-160ms    | [S1,MB3,B]  175-11-186ms   | [S1,MB6,F]  186-9-196ms    | [S1,MB4,B]  211-10-222ms   | [S1,MB7,F]  222-9-231ms    | [S1,MB5,B]  247-11-258ms   | [S1,MB6,B]  283-10-294ms   | [S1,MB7,B]  319-10-330ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  64-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-6-111ms    | [S2,MB2,B]  132-8-140ms    | [S2,MB4,F]  140-6-147ms    | [S2,MB3,B]  167-8-175ms    | [S2,MB5,F]  175-7-182ms    | [S2,MB4,B]  202-8-211ms    | [S2,MB6,F]  211-6-218ms    | [S2,MB5,B]  239-8-247ms    | [S2,MB7,F]  247-6-254ms    | [S2,MB6,B]  275-8-283ms    | [S2,MB7,B]  310-8-319ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-64ms     AFR(10):0.9655 | [S3,MB1,F]  64-11-75ms     | [S3,MB1,B]  75-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-14-110ms    | [S3,MB2,B]  110-21-132ms   AFR(10):0.9655 | [S3,MB3,F]  132-13-145ms   | [S3,MB3,B]  145-21-167ms   AFR(10):0.9655 | [S3,MB4,F]  167-13-181ms   | [S3,MB4,B]  181-21-202ms   AFR(10):0.9655 | [S3,MB5,F]  202-14-217ms   | [S3,MB5,B]  217-22-239ms   AFR(10):0.9655 | [S3,MB6,F]  239-14-253ms   | [S3,MB6,B]  253-21-275ms   AFR(10):0.9655 | [S3,MB7,F]  275-13-289ms   | [S3,MB7,B]  289-21-310ms   AFR(10):0.9655
[rank3]:2025-11-29 00:58:12,256 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0057_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 425.70 ms, GPU Bubble Ratio: 49.97%, 40.53%, 53.03%, 11.41%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  126-23-150ms   | [S0,MB4,F]  150-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  233-23-257ms   | [S0,MB6,F]  257-6-264ms    | [S0,MB3,B]  269-23-292ms   | [S0,MB7,F]  292-6-299ms    | [S0,MB4,B]  321-23-344ms   | [S0,MB5,B]  377-23-401ms   | [S0,MB6,B]  413-11-425ms   | [S0,MB7,B]  425-0-425ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  102-24-126ms   | [S1,MB3,F]  126-8-135ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  209-24-233ms   | [S1,MB5,F]  233-9-242ms    | [S1,MB3,B]  244-24-269ms   | [S1,MB6,F]  269-9-278ms    | [S1,MB4,B]  297-24-321ms   | [S1,MB7,F]  321-9-330ms    | [S1,MB5,B]  353-23-377ms   | [S1,MB6,B]  389-23-413ms   | [S1,MB7,B]  414-10-425ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-102ms    | [S2,MB2,F]  102-6-109ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-6-160ms    | [S2,MB2,B]  190-19-209ms   | [S2,MB4,F]  209-6-216ms    | [S2,MB3,B]  225-19-244ms   | [S2,MB5,F]  244-7-251ms    | [S2,MB4,B]  278-19-297ms   | [S2,MB6,F]  297-6-304ms    | [S2,MB5,B]  334-19-353ms   | [S2,MB7,F]  353-6-360ms    | [S2,MB6,B]  370-19-389ms   | [S2,MB7,B]  406-8-414ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-11-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-14-149ms   | [S3,MB2,B]  149-41-190ms   AFR(10):0.9655 | [S3,MB3,F]  190-13-204ms   | [S3,MB3,B]  204-21-225ms   AFR(10):0.9655 | [S3,MB4,F]  225-13-239ms   | [S3,MB4,B]  239-38-278ms   AFR(10):0.9655 | [S3,MB5,F]  278-14-292ms   | [S3,MB5,B]  292-42-334ms   AFR(10):0.9655 | [S3,MB6,F]  334-14-349ms   | [S3,MB6,B]  349-21-370ms   AFR(10):0.9655 | [S3,MB7,F]  370-13-384ms   | [S3,MB7,B]  384-21-406ms   AFR(10):0.9655
[rank3]:2025-11-29 00:58:12,257 - INFO - 	> Batch Time: 425.70 ms (Average Freeze Ratio: 0.21, Time Reduction Rate: 0.21)
[rank0]:2025-11-29 00:59:41,303 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 00:59:45,949 - INFO - Avg. fwd time: 13.6411 / Avg. bwd time: 38.8030 / Avg. batch time: 492.0256 (ms) / GPU bubble ratio: 14.73%
[rank3]:2025-11-29 00:59:45,958 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.07(0.07)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-11-29 00:59:45,986 - INFO - Avg. fwd time: 7.4798 / Avg. bwd time: 17.6025 / Avg. batch time: 522.1544 (ms) / GPU bubble ratio: 61.57%
[rank1]:2025-11-29 00:59:46,023 - INFO - Avg. fwd time: 9.6024 / Avg. bwd time: 22.0282 / Avg. batch time: 558.9538 (ms) / GPU bubble ratio: 54.73%
[rank0]:2025-11-29 00:59:46,022 - INFO - Avg. fwd time: 7.5882 / Avg. bwd time: 19.4648 / Avg. batch time: 591.9545 (ms) / GPU bubble ratio: 63.44%
[rank2]:2025-11-29 00:59:46,181 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-11-29 00:59:46,243 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1563  memory:  6.51GiB(13.70%)  tps: 6,711  tflops: 52.46  mfu: 16.82%
[rank1]:2025-11-29 00:59:46,208 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-11-29 00:59:46,247 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1563  memory:  9.36GiB(19.71%)  tps: 6,711  tflops: 52.46  mfu: 16.82%
[rank3]:2025-11-29 00:59:46,256 - INFO -  step: 100  loss:  8.6873  grad_norm:  8.1563  memory: 17.37GiB(36.56%)  tps: 6,711  tflops: 52.46  mfu: 16.82%
[rank0]:2025-11-29 00:59:46,229 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank0]:2025-11-29 00:59:46,258 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1563  memory: 12.97GiB(27.31%)  tps: 6,711  tflops: 52.46  mfu: 16.81%
[rank2]:2025-11-29 00:59:46,316 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0059_stage2_step100.svg
[rank1]:2025-11-29 00:59:46,317 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0059_stage1_step100.svg
[rank0]:2025-11-29 00:59:46,319 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0059_stage0_step100.svg
[rank3]:2025-11-29 00:59:46,404 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0059_real_step100_rank3.svg
[rank3]:			> Batch Time: 607.33 ms, GPU Bubble Ratio: 64.98%, 57.18%, 66.07%, 28.46%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  140-16-156ms   | [S0,MB4,F]  156-7-163ms    | [S0,MB1,B]  201-16-217ms   | [S0,MB5,F]  217-6-224ms    | [S0,MB2,B]  268-16-285ms   | [S0,MB6,F]  285-6-292ms    | [S0,MB3,B]  336-16-352ms   | [S0,MB7,F]  352-6-359ms    | [S0,MB4,B]  399-23-423ms   | [S0,MB5,B]  463-23-487ms   | [S0,MB6,B]  528-19-547ms   | [S0,MB7,B]  588-19-607ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-32ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  113-21-134ms   | [S1,MB3,F]  138-9-147ms    | [S1,MB1,B]  174-21-196ms   | [S1,MB4,F]  199-9-208ms    | [S1,MB2,B]  242-21-263ms   | [S1,MB5,F]  267-9-276ms    | [S1,MB3,B]  307-24-331ms   | [S1,MB6,F]  334-9-343ms    | [S1,MB4,B]  370-24-394ms   | [S1,MB7,F]  397-9-406ms    | [S1,MB5,B]  436-24-460ms   | [S1,MB6,B]  500-24-524ms   | [S1,MB7,B]  561-23-584ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  91-16-108ms    | [S2,MB2,F]  111-7-119ms    | [S2,MB1,B]  153-16-169ms   | [S2,MB3,F]  173-7-180ms    | [S2,MB2,B]  218-19-237ms   | [S2,MB4,F]  240-7-247ms    | [S2,MB3,B]  282-19-302ms   | [S2,MB5,F]  305-7-312ms    | [S2,MB4,B]  345-19-364ms   | [S2,MB6,F]  368-7-375ms    | [S2,MB5,B]  411-19-431ms   | [S2,MB7,F]  434-7-441ms    | [S2,MB6,B]  478-19-497ms   | [S2,MB7,B]  539-18-557ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-38-86ms     | [S3,MB1,F]  90-11-101ms    | [S3,MB1,B]  107-40-148ms   | [S3,MB2,F]  151-13-164ms   | [S3,MB2,B]  170-42-212ms   | [S3,MB3,F]  216-13-230ms   | [S3,MB3,B]  235-42-277ms   | [S3,MB4,F]  281-14-295ms   | [S3,MB4,B]  301-38-340ms   | [S3,MB5,F]  344-14-359ms   | [S3,MB5,B]  364-41-406ms   | [S3,MB6,F]  410-14-424ms   | [S3,MB6,B]  430-42-473ms   | [S3,MB7,F]  476-14-490ms   | [S3,MB7,B]  496-39-535ms  
[rank3]:2025-11-29 00:59:46,456 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0059_stage3_step100.svg
[rank3]:2025-11-29 01:01:44,791 - INFO - Avg. fwd time: 13.6856 / Avg. bwd time: 38.3480 / Avg. batch time: 488.7866 (ms) / GPU bubble ratio: 14.84%
[rank0]:2025-11-29 01:01:44,865 - INFO - Avg. fwd time: 7.5952 / Avg. bwd time: 19.5843 / Avg. batch time: 589.0656 (ms) / GPU bubble ratio: 63.09%
[rank2]:2025-11-29 01:01:44,829 - INFO - Avg. fwd time: 7.4616 / Avg. bwd time: 17.7243 / Avg. batch time: 519.0750 (ms) / GPU bubble ratio: 61.18%
[rank1]:2025-11-29 01:01:44,867 - INFO - Avg. fwd time: 9.5934 / Avg. bwd time: 22.1091 / Avg. batch time: 556.0008 (ms) / GPU bubble ratio: 54.38%
[rank0]:2025-11-29 01:03:39,025 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 01:03:43,666 - INFO - Avg. fwd time: 13.7417 / Avg. bwd time: 38.0573 / Avg. batch time: 486.9212 (ms) / GPU bubble ratio: 14.90%
[rank3]:2025-11-29 01:03:43,671 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.10(0.13)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-11-29 01:03:43,691 - INFO - Avg. fwd time: 7.4714 / Avg. bwd time: 17.6395 / Avg. batch time: 517.0479 (ms) / GPU bubble ratio: 61.15%
[rank2]:2025-11-29 01:03:43,696 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank3]:2025-11-29 01:03:43,781 - INFO -  step: 150  loss:  3.8574  grad_norm:  6.0289  memory: 17.37GiB(36.56%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank1]:2025-11-29 01:03:43,718 - INFO - Avg. fwd time: 9.6151 / Avg. bwd time: 21.9096 / Avg. batch time: 553.8833 (ms) / GPU bubble ratio: 54.47%
[rank1]:2025-11-29 01:03:43,725 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank1]:2025-11-29 01:03:43,771 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.0289  memory:  9.36GiB(19.71%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank0]:2025-11-29 01:03:43,747 - INFO - Avg. fwd time: 7.6492 / Avg. bwd time: 19.3375 / Avg. batch time: 586.8340 (ms) / GPU bubble ratio: 63.21%
[rank0]:2025-11-29 01:03:43,754 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-11-29 01:03:43,782 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.0289  memory: 13.29GiB(27.97%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank2]:2025-11-29 01:03:43,768 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.0289  memory:  6.51GiB(13.70%)  tps: 6,898  tflops: 53.92  mfu: 17.28%
[rank3]:2025-11-29 01:05:37,145 - INFO - Avg. fwd time: 13.8091 / Avg. bwd time: 37.4351 / Avg. batch time: 482.6217 (ms) / GPU bubble ratio: 15.06%
[rank1]:2025-11-29 01:05:37,247 - INFO - Avg. fwd time: 9.6466 / Avg. bwd time: 21.6972 / Avg. batch time: 549.3989 (ms) / GPU bubble ratio: 54.36%
[rank0]:2025-11-29 01:05:37,243 - INFO - Avg. fwd time: 7.6895 / Avg. bwd time: 18.9705 / Avg. batch time: 582.0427 (ms) / GPU bubble ratio: 63.36%
[rank2]:2025-11-29 01:05:37,209 - INFO - Avg. fwd time: 7.4770 / Avg. bwd time: 17.5977 / Avg. batch time: 512.6648 (ms) / GPU bubble ratio: 60.87%
[rank0]:2025-11-29 01:07:27,098 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 01:07:31,336 - INFO - Avg. fwd time: 13.8582 / Avg. bwd time: 36.9859 / Avg. batch time: 479.6632 (ms) / GPU bubble ratio: 15.20%
[rank3]:2025-11-29 01:07:31,373 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.17(0.20)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-11-29 01:07:31,403 - INFO - Avg. fwd time: 7.4997 / Avg. bwd time: 17.4449 / Avg. batch time: 509.5122 (ms) / GPU bubble ratio: 60.83%
[rank1]:2025-11-29 01:07:31,441 - INFO - Avg. fwd time: 9.6891 / Avg. bwd time: 21.3876 / Avg. batch time: 546.0806 (ms) / GPU bubble ratio: 54.47%
[rank0]:2025-11-29 01:07:31,437 - INFO - Avg. fwd time: 7.7442 / Avg. bwd time: 18.3285 / Avg. batch time: 578.3705 (ms) / GPU bubble ratio: 63.94%
[rank1]:2025-11-29 01:07:31,600 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-11-29 01:07:31,619 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank2]:2025-11-29 01:07:31,577 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank2]:2025-11-29 01:07:31,633 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.7159  memory:  6.51GiB(13.70%)  tps: 7,190  tflops: 56.21  mfu: 18.02%
[rank1]:2025-11-29 01:07:31,637 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.7159  memory:  9.36GiB(19.71%)  tps: 7,190  tflops: 56.21  mfu: 18.02%
[rank1]:2025-11-29 01:07:31,697 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0107_stage1_step200.svg
[rank3]:2025-11-29 01:07:31,646 - INFO -  step: 200  loss:  1.3354  grad_norm:  3.7159  memory: 17.37GiB(36.56%)  tps: 7,190  tflops: 56.21  mfu: 18.02%
[rank0]:2025-11-29 01:07:31,648 - INFO -  step: 200  loss: -8.0000  grad_norm:  3.7159  memory: 13.29GiB(27.97%)  tps: 7,190  tflops: 56.21  mfu: 18.02%
[rank0]:2025-11-29 01:07:31,697 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0107_stage0_step200.svg
[rank2]:2025-11-29 01:07:31,697 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0107_stage2_step200.svg
[rank3]:2025-11-29 01:07:31,784 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0107_real_step200_rank3.svg
[rank3]:			> Batch Time: 545.56 ms, GPU Bubble Ratio: 69.22%, 56.81%, 64.93%, 30.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  106-4-111ms    | [S0,MB4,F]  111-8-119ms    | [S0,MB1,B]  170-4-174ms    | [S0,MB5,F]  174-6-181ms    | [S0,MB2,B]  242-4-247ms    | [S0,MB6,F]  247-6-254ms    | [S0,MB3,B]  316-4-321ms    | [S0,MB7,F]  321-6-328ms    | [S0,MB4,B]  366-23-390ms   | [S0,MB5,B]  427-23-450ms   | [S0,MB6,B]  486-18-504ms   | [S0,MB7,B]  528-17-545ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  88-12-101ms    | [S1,MB3,F]  104-10-115ms   | [S1,MB1,B]  152-12-164ms   | [S1,MB4,F]  168-8-177ms    | [S1,MB2,B]  224-12-237ms   | [S1,MB5,F]  241-8-249ms    | [S1,MB3,B]  284-24-308ms   | [S1,MB6,F]  315-8-324ms    | [S1,MB4,B]  337-24-361ms   | [S1,MB7,F]  364-9-374ms    | [S1,MB5,B]  399-24-423ms   | [S1,MB6,B]  458-24-482ms   | [S1,MB7,B]  503-21-525ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  75-8-83ms      | [S2,MB2,F]  87-8-96ms      | [S2,MB1,B]  138-8-147ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-7-230ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  282-7-290ms    | [S2,MB4,B]  312-19-332ms   | [S2,MB6,F]  335-6-342ms    | [S2,MB5,B]  374-19-394ms   | [S2,MB7,F]  397-6-404ms    | [S2,MB6,B]  435-19-454ms   | [S2,MB7,B]  484-16-500ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-21-69ms     | [S3,MB1,F]  73-13-87ms     | [S3,MB1,B]  93-40-133ms    | [S3,MB2,F]  137-11-148ms   | [S3,MB2,B]  154-41-195ms   | [S3,MB3,F]  199-12-212ms   | [S3,MB3,B]  218-37-255ms   | [S3,MB4,F]  258-16-275ms   | [S3,MB4,B]  281-23-305ms   | [S3,MB5,F]  311-12-323ms   | [S3,MB5,B]  329-39-369ms   | [S3,MB6,F]  373-14-388ms   | [S3,MB6,B]  393-36-429ms   | [S3,MB7,F]  434-17-451ms   | [S3,MB7,B]  457-23-480ms  
[rank3]:2025-11-29 01:07:31,829 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0107_stage3_step200.svg
[rank2]:2025-11-29 01:09:22,894 - INFO - Avg. fwd time: 7.5227 / Avg. bwd time: 17.2986 / Avg. batch time: 505.4656 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-11-29 01:09:22,922 - INFO - Avg. fwd time: 9.7310 / Avg. bwd time: 21.0918 / Avg. batch time: 541.8722 (ms) / GPU bubble ratio: 54.49%
[rank3]:2025-11-29 01:09:22,869 - INFO - Avg. fwd time: 13.9047 / Avg. bwd time: 36.4207 / Avg. batch time: 475.7012 (ms) / GPU bubble ratio: 15.37%
[rank0]:2025-11-29 01:09:22,946 - INFO - Avg. fwd time: 7.7918 / Avg. bwd time: 17.4276 / Avg. batch time: 573.8161 (ms) / GPU bubble ratio: 64.84%
[rank0]:2025-11-29 01:11:09,536 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 01:11:13,684 - INFO - Avg. fwd time: 13.9368 / Avg. bwd time: 36.0235 / Avg. batch time: 472.9111 (ms) / GPU bubble ratio: 15.48%
[rank3]:2025-11-29 01:11:13,720 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.21(0.20)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-29 01:11:13,743 - INFO - Avg. fwd time: 7.8227 / Avg. bwd time: 16.7810 / Avg. batch time: 570.5578 (ms) / GPU bubble ratio: 65.50%
[rank2]:2025-11-29 01:11:13,753 - INFO - Avg. fwd time: 7.5376 / Avg. bwd time: 17.1990 / Avg. batch time: 502.5659 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-11-29 01:11:13,792 - INFO - Avg. fwd time: 9.7582 / Avg. bwd time: 20.8855 / Avg. batch time: 538.8582 (ms) / GPU bubble ratio: 54.51%
[rank2]:2025-11-29 01:11:13,914 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 01:11:13,936 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 01:11:13,974 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.6408  memory:  9.36GiB(19.71%)  tps: 7,369  tflops: 57.61  mfu: 18.46%
[rank3]:2025-11-29 01:11:13,982 - INFO -  step: 250  loss:  0.4470  grad_norm:  0.6408  memory: 17.37GiB(36.56%)  tps: 7,369  tflops: 57.61  mfu: 18.46%
[rank0]:2025-11-29 01:11:13,956 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-29 01:11:13,984 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.6408  memory: 13.29GiB(27.97%)  tps: 7,369  tflops: 57.61  mfu: 18.46%
[rank2]:2025-11-29 01:11:13,970 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.6408  memory:  6.51GiB(13.70%)  tps: 7,369  tflops: 57.61  mfu: 18.46%
[rank3]:2025-11-29 01:13:04,806 - INFO - Avg. fwd time: 13.9689 / Avg. bwd time: 35.6363 / Avg. batch time: 470.2075 (ms) / GPU bubble ratio: 15.60%
[rank0]:2025-11-29 01:13:04,863 - INFO - Avg. fwd time: 7.8519 / Avg. bwd time: 16.1763 / Avg. batch time: 567.4079 (ms) / GPU bubble ratio: 66.12%
[rank2]:2025-11-29 01:13:04,872 - INFO - Avg. fwd time: 7.5519 / Avg. bwd time: 17.1028 / Avg. batch time: 499.7626 (ms) / GPU bubble ratio: 60.53%
[rank1]:2025-11-29 01:13:04,910 - INFO - Avg. fwd time: 9.7853 / Avg. bwd time: 20.6878 / Avg. batch time: 535.9431 (ms) / GPU bubble ratio: 54.51%
[rank0]:2025-11-29 01:14:52,460 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 01:14:56,851 - INFO - Avg. fwd time: 13.9926 / Avg. bwd time: 35.3665 / Avg. batch time: 468.3151 (ms) / GPU bubble ratio: 15.68%
[rank3]:2025-11-29 01:14:56,856 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.21(0.20)/0.20, [MB5] 0.00(0.00)/0.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-29 01:14:56,876 - INFO - Avg. fwd time: 7.5626 / Avg. bwd time: 17.0227 / Avg. batch time: 497.7792 (ms) / GPU bubble ratio: 60.49%
[rank2]:2025-11-29 01:14:56,882 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 01:14:56,905 - INFO - Avg. fwd time: 9.8061 / Avg. bwd time: 20.5240 / Avg. batch time: 533.8712 (ms) / GPU bubble ratio: 54.55%
[rank1]:2025-11-29 01:14:56,911 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 01:14:56,955 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2439  memory:  9.36GiB(19.71%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank3]:2025-11-29 01:14:56,963 - INFO -  step: 300  loss:  0.2847  grad_norm:  0.2439  memory: 17.37GiB(36.56%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank0]:2025-11-29 01:14:56,929 - INFO - Avg. fwd time: 7.8756 / Avg. bwd time: 15.6750 / Avg. batch time: 565.1452 (ms) / GPU bubble ratio: 66.66%
[rank0]:2025-11-29 01:14:56,937 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-29 01:14:56,966 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2439  memory: 13.29GiB(27.97%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank2]:2025-11-29 01:14:56,951 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2439  memory:  6.51GiB(13.70%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank2]:2025-11-29 01:14:57,015 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0114_stage2_step300.svg
[rank1]:2025-11-29 01:14:57,014 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0114_stage1_step300.svg
[rank3]:2025-11-29 01:14:57,099 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0114_real_step300_rank3.svg
[rank3]:			> Batch Time: 542.27 ms, GPU Bubble Ratio: 72.70%, 57.41%, 64.74%, 30.93%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-247ms    | [S0,MB3,B]  316-0-316ms    | [S0,MB7,F]  316-6-323ms    | [S0,MB4,B]  366-23-389ms   | [S0,MB5,B]  426-23-449ms   | [S0,MB6,B]  483-18-501ms   | [S0,MB7,B]  525-16-542ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  284-24-308ms   | [S1,MB6,F]  314-8-323ms    | [S1,MB4,B]  336-24-360ms   | [S1,MB7,F]  364-9-373ms    | [S1,MB5,B]  398-24-422ms   | [S1,MB6,B]  455-24-479ms   | [S1,MB7,B]  501-20-522ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  223-7-230ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  282-7-290ms    | [S2,MB4,B]  311-19-331ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  373-19-393ms   | [S2,MB7,F]  396-7-403ms    | [S2,MB6,B]  433-19-452ms   | [S2,MB7,B]  482-16-498ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  198-13-212ms   | [S3,MB3,B]  218-36-254ms   | [S3,MB4,F]  258-17-275ms   | [S3,MB4,B]  281-22-304ms   | [S3,MB5,F]  310-12-322ms   | [S3,MB5,B]  328-40-368ms   | [S3,MB6,F]  372-14-386ms   | [S3,MB6,B]  392-36-429ms   | [S3,MB7,F]  431-17-449ms   | [S3,MB7,B]  455-22-478ms  
[rank0]:2025-11-29 01:14:57,015 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0114_stage0_step300.svg
[rank3]:2025-11-29 01:14:57,146 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0114_stage3_step300.svg
[rank3]:2025-11-29 01:16:47,863 - INFO - Avg. fwd time: 14.0083 / Avg. bwd time: 35.1335 / Avg. batch time: 466.6637 (ms) / GPU bubble ratio: 15.76%
[rank0]:2025-11-29 01:16:47,921 - INFO - Avg. fwd time: 7.8933 / Avg. bwd time: 15.2962 / Avg. batch time: 563.2618 (ms) / GPU bubble ratio: 67.06%
[rank2]:2025-11-29 01:16:47,930 - INFO - Avg. fwd time: 7.5711 / Avg. bwd time: 16.9650 / Avg. batch time: 496.1080 (ms) / GPU bubble ratio: 60.43%
[rank1]:2025-11-29 01:16:47,968 - INFO - Avg. fwd time: 9.8220 / Avg. bwd time: 20.4046 / Avg. batch time: 532.1303 (ms) / GPU bubble ratio: 54.56%
[rank0]:2025-11-29 01:18:35,691 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 01:18:39,904 - INFO - Avg. fwd time: 14.0261 / Avg. bwd time: 34.9411 / Avg. batch time: 465.3205 (ms) / GPU bubble ratio: 15.81%
[rank0]:2025-11-29 01:18:39,962 - INFO - Avg. fwd time: 7.9123 / Avg. bwd time: 14.9177 / Avg. batch time: 561.6503 (ms) / GPU bubble ratio: 67.48%
[rank2]:2025-11-29 01:18:39,971 - INFO - Avg. fwd time: 7.5794 / Avg. bwd time: 16.9060 / Avg. batch time: 494.6968 (ms) / GPU bubble ratio: 60.40%
[rank1]:2025-11-29 01:18:40,009 - INFO - Avg. fwd time: 9.8380 / Avg. bwd time: 20.2838 / Avg. batch time: 530.6499 (ms) / GPU bubble ratio: 54.59%
[rank0]:2025-11-29 01:18:40,212 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1071  memory: 13.29GiB(27.97%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank2]:2025-11-29 01:18:40,197 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1071  memory:  6.51GiB(13.70%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank1]:2025-11-29 01:18:40,201 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1071  memory:  9.36GiB(19.71%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank3]:2025-11-29 01:18:40,210 - INFO -  step: 350  loss:  0.2257  grad_norm:  0.1071  memory: 17.37GiB(36.56%)  tps: 7,339  tflops: 57.37  mfu: 18.39%
[rank3]:2025-11-29 01:20:31,237 - INFO - Avg. fwd time: 14.0407 / Avg. bwd time: 34.7450 / Avg. batch time: 463.9250 (ms) / GPU bubble ratio: 15.87%
[rank1]:2025-11-29 01:20:31,292 - INFO - Avg. fwd time: 9.8527 / Avg. bwd time: 20.1797 / Avg. batch time: 529.1433 (ms) / GPU bubble ratio: 54.59%
[rank2]:2025-11-29 01:20:31,262 - INFO - Avg. fwd time: 7.5867 / Avg. bwd time: 16.8549 / Avg. batch time: 493.2491 (ms) / GPU bubble ratio: 60.36%
[rank0]:2025-11-29 01:20:31,317 - INFO - Avg. fwd time: 7.9269 / Avg. bwd time: 14.6052 / Avg. batch time: 560.0200 (ms) / GPU bubble ratio: 67.81%
[rank0]:2025-11-29 01:22:18,665 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 01:22:22,883 - INFO - Avg. fwd time: 14.0485 / Avg. bwd time: 34.6254 / Avg. batch time: 463.0566 (ms) / GPU bubble ratio: 15.91%
[rank0]:2025-11-29 01:22:22,943 - INFO - Avg. fwd time: 7.9376 / Avg. bwd time: 14.3591 / Avg. batch time: 558.9683 (ms) / GPU bubble ratio: 68.09%
[rank2]:2025-11-29 01:22:22,952 - INFO - Avg. fwd time: 7.5920 / Avg. bwd time: 16.8163 / Avg. batch time: 492.3407 (ms) / GPU bubble ratio: 60.34%
[rank1]:2025-11-29 01:22:22,990 - INFO - Avg. fwd time: 9.8633 / Avg. bwd time: 20.1009 / Avg. batch time: 528.1875 (ms) / GPU bubble ratio: 54.62%
[rank3]:2025-11-29 01:22:23,188 - INFO -  step: 400  loss:  0.2113  grad_norm:  0.0632  memory: 17.37GiB(36.56%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank0]:2025-11-29 01:22:23,190 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0632  memory: 13.29GiB(27.97%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank2]:2025-11-29 01:22:23,175 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0632  memory:  6.51GiB(13.70%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank1]:2025-11-29 01:22:23,179 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0632  memory:  9.36GiB(19.71%)  tps: 7,348  tflops: 57.44  mfu: 18.41%
[rank0]:2025-11-29 01:22:23,242 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0122_stage0_step400.svg
[rank2]:2025-11-29 01:22:23,242 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0122_stage2_step400.svg
[rank1]:2025-11-29 01:22:23,242 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0122_stage1_step400.svg
[rank3]:2025-11-29 01:22:23,326 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0122_real_step400_rank3.svg
[rank3]:			> Batch Time: 540.72 ms, GPU Bubble Ratio: 72.78%, 57.32%, 64.68%, 30.97%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-173ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  313-0-313ms    | [S0,MB7,F]  313-6-320ms    | [S0,MB4,B]  363-23-387ms   | [S0,MB5,B]  425-23-448ms   | [S0,MB6,B]  482-18-500ms   | [S0,MB7,B]  524-16-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-173ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  282-24-306ms   | [S1,MB6,F]  311-9-321ms    | [S1,MB4,B]  333-24-358ms   | [S1,MB7,F]  361-9-371ms    | [S1,MB5,B]  396-24-421ms   | [S1,MB6,B]  454-24-479ms   | [S1,MB7,B]  499-20-520ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  221-6-228ms    | [S2,MB3,B]  258-19-277ms   | [S2,MB5,F]  280-7-287ms    | [S2,MB4,B]  309-19-328ms   | [S2,MB6,F]  332-7-339ms    | [S2,MB5,B]  372-19-391ms   | [S2,MB7,F]  395-6-402ms    | [S2,MB6,B]  432-19-451ms   | [S2,MB7,B]  480-16-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  152-41-194ms   | [S3,MB3,F]  197-13-210ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  256-17-273ms   | [S3,MB4,B]  279-22-302ms   | [S3,MB5,F]  308-11-319ms   | [S3,MB5,B]  326-41-367ms   | [S3,MB6,F]  371-14-385ms   | [S3,MB6,B]  391-36-427ms   | [S3,MB7,F]  430-17-448ms   | [S3,MB7,B]  454-22-477ms  
[rank3]:2025-11-29 01:22:23,371 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0122_stage3_step400.svg
[rank3]:2025-11-29 01:22:48,738 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-29 01:22:49,011 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-29 01:22:48,969 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-29 01:22:48,992 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-11-29 01:24:14,687 - INFO - Avg. fwd time: 14.0620 / Avg. bwd time: 34.4954 / Avg. batch time: 462.1581 (ms) / GPU bubble ratio: 15.95%
[rank0]:2025-11-29 01:24:14,746 - INFO - Avg. fwd time: 7.9494 / Avg. bwd time: 14.1163 / Avg. batch time: 557.9018 (ms) / GPU bubble ratio: 68.36%
[rank2]:2025-11-29 01:24:14,755 - INFO - Avg. fwd time: 7.5971 / Avg. bwd time: 16.7751 / Avg. batch time: 491.4186 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-11-29 01:24:14,793 - INFO - Avg. fwd time: 9.8742 / Avg. bwd time: 20.0183 / Avg. batch time: 527.2171 (ms) / GPU bubble ratio: 54.64%
[rank0]:2025-11-29 01:26:02,034 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 01:26:06,403 - INFO - Avg. fwd time: 14.0739 / Avg. bwd time: 34.3728 / Avg. batch time: 461.3051 (ms) / GPU bubble ratio: 15.98%
[rank2]:2025-11-29 01:26:06,430 - INFO - Avg. fwd time: 7.6013 / Avg. bwd time: 16.7383 / Avg. batch time: 490.5217 (ms) / GPU bubble ratio: 60.30%
[rank0]:2025-11-29 01:26:06,486 - INFO - Avg. fwd time: 7.9598 / Avg. bwd time: 13.8894 / Avg. batch time: 556.8817 (ms) / GPU bubble ratio: 68.61%
[rank1]:2025-11-29 01:26:06,460 - INFO - Avg. fwd time: 9.8837 / Avg. bwd time: 19.9454 / Avg. batch time: 526.2787 (ms) / GPU bubble ratio: 54.66%
[rank1]:2025-11-29 01:26:06,511 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0814  memory:  9.36GiB(19.71%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank3]:2025-11-29 01:26:06,520 - INFO -  step: 450  loss:  0.2255  grad_norm:  0.0814  memory: 17.37GiB(36.56%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank2]:2025-11-29 01:26:06,507 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0814  memory:  6.51GiB(13.70%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank0]:2025-11-29 01:26:06,522 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0814  memory: 13.29GiB(27.97%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank3]:2025-11-29 01:27:57,498 - INFO - Avg. fwd time: 14.0829 / Avg. bwd time: 34.2759 / Avg. batch time: 460.6235 (ms) / GPU bubble ratio: 16.01%
[rank2]:2025-11-29 01:27:57,563 - INFO - Avg. fwd time: 7.6048 / Avg. bwd time: 16.7095 / Avg. batch time: 489.8029 (ms) / GPU bubble ratio: 60.29%
[rank0]:2025-11-29 01:27:57,556 - INFO - Avg. fwd time: 7.9676 / Avg. bwd time: 13.7174 / Avg. batch time: 556.0619 (ms) / GPU bubble ratio: 68.80%
[rank1]:2025-11-29 01:27:57,601 - INFO - Avg. fwd time: 9.8912 / Avg. bwd time: 19.8892 / Avg. batch time: 525.5255 (ms) / GPU bubble ratio: 54.67%
[rank0]:2025-11-29 01:29:44,047 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 01:29:48,125 - INFO - Avg. fwd time: 14.0889 / Avg. bwd time: 34.1505 / Avg. batch time: 459.7083 (ms) / GPU bubble ratio: 16.05%
[rank0]:2025-11-29 01:29:48,185 - INFO - Avg. fwd time: 7.9752 / Avg. bwd time: 13.5451 / Avg. batch time: 555.0068 (ms) / GPU bubble ratio: 68.98%
[rank2]:2025-11-29 01:29:48,193 - INFO - Avg. fwd time: 7.6083 / Avg. bwd time: 16.6796 / Avg. batch time: 488.8551 (ms) / GPU bubble ratio: 60.25%
[rank1]:2025-11-29 01:29:48,233 - INFO - Avg. fwd time: 9.8991 / Avg. bwd time: 19.8310 / Avg. batch time: 524.5426 (ms) / GPU bubble ratio: 54.66%
[rank1]:2025-11-29 01:29:48,406 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0883  memory:  9.36GiB(19.71%)  tps: 7,384  tflops: 57.72  mfu: 18.50%
[rank3]:2025-11-29 01:29:48,415 - INFO -  step: 500  loss:  0.2179  grad_norm:  0.0883  memory: 17.37GiB(36.56%)  tps: 7,384  tflops: 57.72  mfu: 18.50%
[rank2]:2025-11-29 01:29:48,402 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0883  memory:  6.51GiB(13.70%)  tps: 7,384  tflops: 57.72  mfu: 18.50%
[rank0]:2025-11-29 01:29:48,417 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0883  memory: 13.29GiB(27.97%)  tps: 7,384  tflops: 57.72  mfu: 18.50%
[rank0]:2025-11-29 01:29:48,465 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0129_stage0_step500.svg
[rank1]:2025-11-29 01:29:48,465 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0129_stage1_step500.svg
[rank2]:2025-11-29 01:29:48,465 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0129_stage2_step500.svg
[rank3]:2025-11-29 01:29:48,552 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0129_real_step500_rank3.svg
[rank3]:			> Batch Time: 530.22 ms, GPU Bubble Ratio: 72.04%, 56.40%, 64.00%, 31.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-246ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-320ms    | [S0,MB4,B]  365-23-389ms   | [S0,MB5,B]  415-23-439ms   | [S0,MB6,B]  471-18-490ms   | [S0,MB7,B]  513-16-530ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  224-10-234ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  282-24-307ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  333-24-358ms   | [S1,MB7,F]  363-9-373ms    | [S1,MB5,B]  387-24-412ms   | [S1,MB6,B]  443-24-468ms   | [S1,MB7,B]  489-20-509ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  258-19-277ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  309-19-329ms   | [S2,MB6,F]  332-7-339ms    | [S2,MB5,B]  363-19-382ms   | [S2,MB7,F]  386-7-393ms    | [S2,MB6,B]  421-19-440ms   | [S2,MB7,B]  469-16-485ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-35-253ms   | [S3,MB4,F]  257-17-274ms   | [S3,MB4,B]  280-22-303ms   | [S3,MB5,F]  308-14-322ms   | [S3,MB5,B]  328-28-357ms   | [S3,MB6,F]  362-12-374ms   | [S3,MB6,B]  380-35-416ms   | [S3,MB7,F]  419-17-437ms   | [S3,MB7,B]  443-22-466ms  
[rank3]:2025-11-29 01:29:48,595 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0129_stage3_step500.svg
[rank3]:2025-11-29 01:31:39,484 - INFO - Avg. fwd time: 14.0968 / Avg. bwd time: 34.0420 / Avg. batch time: 458.9432 (ms) / GPU bubble ratio: 16.09%
[rank1]:2025-11-29 01:31:39,542 - INFO - Avg. fwd time: 9.9060 / Avg. bwd time: 19.7778 / Avg. batch time: 523.7366 (ms) / GPU bubble ratio: 54.66%
[rank2]:2025-11-29 01:31:39,511 - INFO - Avg. fwd time: 7.6115 / Avg. bwd time: 16.6524 / Avg. batch time: 488.0824 (ms) / GPU bubble ratio: 60.23%
[rank0]:2025-11-29 01:31:39,569 - INFO - Avg. fwd time: 7.9824 / Avg. bwd time: 13.3996 / Avg. batch time: 554.1395 (ms) / GPU bubble ratio: 69.13%
[rank0]:2025-11-29 01:33:26,207 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 01:33:30,400 - INFO - Avg. fwd time: 14.1031 / Avg. bwd time: 33.9604 / Avg. batch time: 458.3739 (ms) / GPU bubble ratio: 16.11%
[rank0]:2025-11-29 01:33:30,459 - INFO - Avg. fwd time: 7.9880 / Avg. bwd time: 13.2795 / Avg. batch time: 553.4703 (ms) / GPU bubble ratio: 69.26%
[rank1]:2025-11-29 01:33:30,506 - INFO - Avg. fwd time: 9.9117 / Avg. bwd time: 19.7363 / Avg. batch time: 523.1174 (ms) / GPU bubble ratio: 54.66%
[rank2]:2025-11-29 01:33:30,468 - INFO - Avg. fwd time: 7.6141 / Avg. bwd time: 16.6309 / Avg. batch time: 487.4880 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-11-29 01:33:30,704 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0710  memory: 13.29GiB(27.97%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank1]:2025-11-29 01:33:30,692 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0710  memory:  9.36GiB(19.71%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank3]:2025-11-29 01:33:30,701 - INFO -  step: 550  loss:  0.2245  grad_norm:  0.0710  memory: 17.37GiB(36.56%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank2]:2025-11-29 01:33:30,689 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0710  memory:  6.51GiB(13.70%)  tps: 7,371  tflops: 57.62  mfu: 18.47%
[rank3]:2025-11-29 01:35:20,632 - INFO - Avg. fwd time: 14.1078 / Avg. bwd time: 33.8540 / Avg. batch time: 457.6075 (ms) / GPU bubble ratio: 16.15%
[rank0]:2025-11-29 01:35:20,693 - INFO - Avg. fwd time: 7.9940 / Avg. bwd time: 13.1420 / Avg. batch time: 552.5957 (ms) / GPU bubble ratio: 69.40%
[rank1]:2025-11-29 01:35:20,744 - INFO - Avg. fwd time: 9.9177 / Avg. bwd time: 19.6927 / Avg. batch time: 522.2961 (ms) / GPU bubble ratio: 54.65%
[rank2]:2025-11-29 01:35:20,703 - INFO - Avg. fwd time: 7.6170 / Avg. bwd time: 16.6083 / Avg. batch time: 486.6933 (ms) / GPU bubble ratio: 60.18%
[rank0]:2025-11-29 01:37:07,494 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 01:37:11,941 - INFO - Avg. fwd time: 14.1130 / Avg. bwd time: 33.7764 / Avg. batch time: 457.0573 (ms) / GPU bubble ratio: 16.18%
[rank2]:2025-11-29 01:37:11,969 - INFO - Avg. fwd time: 7.6198 / Avg. bwd time: 16.5873 / Avg. batch time: 486.1188 (ms) / GPU bubble ratio: 60.16%
[rank1]:2025-11-29 01:37:12,000 - INFO - Avg. fwd time: 9.9240 / Avg. bwd time: 19.6524 / Avg. batch time: 521.6997 (ms) / GPU bubble ratio: 54.65%
[rank1]:2025-11-29 01:37:12,053 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0944  memory:  9.36GiB(19.71%)  tps: 7,402  tflops: 57.86  mfu: 18.55%
[rank0]:2025-11-29 01:37:12,028 - INFO - Avg. fwd time: 7.9997 / Avg. bwd time: 13.0245 / Avg. batch time: 551.9526 (ms) / GPU bubble ratio: 69.53%
[rank0]:2025-11-29 01:37:12,064 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0944  memory: 13.29GiB(27.97%)  tps: 7,402  tflops: 57.86  mfu: 18.55%
[rank3]:2025-11-29 01:37:12,062 - INFO -  step: 600  loss:  0.2205  grad_norm:  0.0944  memory: 17.37GiB(36.56%)  tps: 7,402  tflops: 57.86  mfu: 18.55%
[rank2]:2025-11-29 01:37:12,049 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0944  memory:  6.51GiB(13.70%)  tps: 7,402  tflops: 57.86  mfu: 18.55%
[rank2]:2025-11-29 01:37:12,114 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0137_stage2_step600.svg
[rank1]:2025-11-29 01:37:12,113 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0137_stage1_step600.svg
[rank0]:2025-11-29 01:37:12,113 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0137_stage0_step600.svg
[rank3]:2025-11-29 01:37:12,197 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0137_real_step600_rank3.svg
[rank3]:			> Batch Time: 540.73 ms, GPU Bubble Ratio: 71.94%, 57.35%, 64.77%, 31.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  238-0-238ms    | [S0,MB6,F]  239-6-245ms    | [S0,MB3,B]  313-0-313ms    | [S0,MB7,F]  313-6-320ms    | [S0,MB4,B]  363-23-387ms   | [S0,MB5,B]  425-23-448ms   | [S0,MB6,B]  483-22-505ms   | [S0,MB7,B]  524-16-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-173ms    | [S1,MB2,B]  222-10-233ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  281-24-305ms   | [S1,MB6,F]  311-9-321ms    | [S1,MB4,B]  334-24-358ms   | [S1,MB7,F]  361-9-371ms    | [S1,MB5,B]  397-24-421ms   | [S1,MB6,B]  455-24-479ms   | [S1,MB7,B]  500-20-520ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  198-19-217ms   | [S2,MB4,F]  221-6-228ms    | [S2,MB3,B]  257-19-276ms   | [S2,MB5,F]  280-7-287ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  332-7-339ms    | [S2,MB5,B]  373-19-392ms   | [S2,MB7,F]  395-6-402ms    | [S2,MB6,B]  432-19-451ms   | [S2,MB7,B]  481-16-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  91-40-132ms    | [S3,MB2,F]  135-11-146ms   | [S3,MB2,B]  152-41-193ms   | [S3,MB3,F]  197-13-210ms   | [S3,MB3,B]  217-35-252ms   | [S3,MB4,F]  256-17-273ms   | [S3,MB4,B]  279-22-302ms   | [S3,MB5,F]  308-11-320ms   | [S3,MB5,B]  326-41-367ms   | [S3,MB6,F]  371-14-386ms   | [S3,MB6,B]  391-36-427ms   | [S3,MB7,F]  431-17-448ms   | [S3,MB7,B]  455-22-477ms  
[rank3]:2025-11-29 01:37:12,240 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0137_stage3_step600.svg
[rank3]:2025-11-29 01:39:02,670 - INFO - Avg. fwd time: 14.1165 / Avg. bwd time: 33.7041 / Avg. batch time: 456.5406 (ms) / GPU bubble ratio: 16.20%
[rank0]:2025-11-29 01:39:02,730 - INFO - Avg. fwd time: 8.0039 / Avg. bwd time: 12.9251 / Avg. batch time: 551.3818 (ms) / GPU bubble ratio: 69.63%
[rank2]:2025-11-29 01:39:02,740 - INFO - Avg. fwd time: 7.6217 / Avg. bwd time: 16.5710 / Avg. batch time: 485.6042 (ms) / GPU bubble ratio: 60.14%
[rank1]:2025-11-29 01:39:02,778 - INFO - Avg. fwd time: 9.9284 / Avg. bwd time: 19.6210 / Avg. batch time: 521.1670 (ms) / GPU bubble ratio: 54.64%
[rank0]:2025-11-29 01:40:50,114 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 01:40:54,276 - INFO - Avg. fwd time: 14.1232 / Avg. bwd time: 33.6534 / Avg. batch time: 456.2014 (ms) / GPU bubble ratio: 16.22%
[rank0]:2025-11-29 01:40:54,333 - INFO - Avg. fwd time: 8.0089 / Avg. bwd time: 12.8239 / Avg. batch time: 550.9525 (ms) / GPU bubble ratio: 69.75%
[rank2]:2025-11-29 01:40:54,347 - INFO - Avg. fwd time: 7.6243 / Avg. bwd time: 16.5533 / Avg. batch time: 485.2392 (ms) / GPU bubble ratio: 60.14%
[rank1]:2025-11-29 01:40:54,386 - INFO - Avg. fwd time: 9.9335 / Avg. bwd time: 19.5857 / Avg. batch time: 520.7784 (ms) / GPU bubble ratio: 54.65%
[rank1]:2025-11-29 01:40:54,566 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0720  memory:  9.36GiB(19.71%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank3]:2025-11-29 01:40:54,574 - INFO -  step: 650  loss:  0.2314  grad_norm:  0.0720  memory: 17.37GiB(36.56%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank0]:2025-11-29 01:40:54,576 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0720  memory: 13.29GiB(27.97%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank2]:2025-11-29 01:40:54,562 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0720  memory:  6.51GiB(13.70%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank3]:2025-11-29 01:42:45,778 - INFO - Avg. fwd time: 14.1277 / Avg. bwd time: 33.6002 / Avg. batch time: 455.8167 (ms) / GPU bubble ratio: 16.23%
[rank2]:2025-11-29 01:42:45,806 - INFO - Avg. fwd time: 7.6263 / Avg. bwd time: 16.5370 / Avg. batch time: 484.8316 (ms) / GPU bubble ratio: 60.13%
[rank1]:2025-11-29 01:42:45,838 - INFO - Avg. fwd time: 9.9374 / Avg. bwd time: 19.5533 / Avg. batch time: 520.3507 (ms) / GPU bubble ratio: 54.66%
[rank0]:2025-11-29 01:42:45,867 - INFO - Avg. fwd time: 8.0133 / Avg. bwd time: 12.7251 / Avg. batch time: 550.4891 (ms) / GPU bubble ratio: 69.86%
[rank0]:2025-11-29 01:44:32,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 01:44:36,966 - INFO - Avg. fwd time: 14.1316 / Avg. bwd time: 33.5610 / Avg. batch time: 455.5398 (ms) / GPU bubble ratio: 16.24%
[rank1]:2025-11-29 01:44:37,069 - INFO - Avg. fwd time: 9.9407 / Avg. bwd time: 19.5269 / Avg. batch time: 520.0363 (ms) / GPU bubble ratio: 54.67%
[rank0]:2025-11-29 01:44:37,023 - INFO - Avg. fwd time: 8.0167 / Avg. bwd time: 12.6498 / Avg. batch time: 550.1434 (ms) / GPU bubble ratio: 69.95%
[rank2]:2025-11-29 01:44:37,032 - INFO - Avg. fwd time: 7.6280 / Avg. bwd time: 16.5237 / Avg. batch time: 484.5356 (ms) / GPU bubble ratio: 60.12%
[rank1]:2025-11-29 01:44:37,251 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0732  memory:  9.36GiB(19.71%)  tps: 7,357  tflops: 57.52  mfu: 18.44%
[rank3]:2025-11-29 01:44:37,259 - INFO -  step: 700  loss:  0.1909  grad_norm:  0.0732  memory: 17.37GiB(36.56%)  tps: 7,358  tflops: 57.52  mfu: 18.44%
[rank0]:2025-11-29 01:44:37,262 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0732  memory: 13.29GiB(27.97%)  tps: 7,357  tflops: 57.52  mfu: 18.44%
[rank2]:2025-11-29 01:44:37,247 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0732  memory:  6.51GiB(13.70%)  tps: 7,357  tflops: 57.52  mfu: 18.44%
[rank1]:2025-11-29 01:44:37,312 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0144_stage1_step700.svg
[rank2]:2025-11-29 01:44:37,313 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0144_stage2_step700.svg
[rank0]:2025-11-29 01:44:37,313 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0144_stage0_step700.svg
[rank3]:2025-11-29 01:44:37,396 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0144_real_step700_rank3.svg
[rank3]:			> Batch Time: 540.22 ms, GPU Bubble Ratio: 72.01%, 57.33%, 64.71%, 30.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-173ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  314-0-314ms    | [S0,MB7,F]  314-6-321ms    | [S0,MB4,B]  364-23-388ms   | [S0,MB5,B]  424-23-448ms   | [S0,MB6,B]  482-21-503ms   | [S0,MB7,B]  523-16-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  283-24-307ms   | [S1,MB6,F]  312-9-321ms    | [S1,MB4,B]  334-24-359ms   | [S1,MB7,F]  362-9-372ms    | [S1,MB5,B]  396-24-421ms   | [S1,MB6,B]  454-24-478ms   | [S1,MB7,B]  500-20-520ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  221-7-228ms    | [S2,MB3,B]  258-19-278ms   | [S2,MB5,F]  281-7-288ms    | [S2,MB4,B]  310-19-329ms   | [S2,MB6,F]  333-7-340ms    | [S2,MB5,B]  372-19-391ms   | [S2,MB7,F]  395-6-402ms    | [S2,MB6,B]  431-19-450ms   | [S2,MB7,B]  480-16-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  257-16-274ms   | [S3,MB4,B]  280-22-303ms   | [S3,MB5,F]  309-12-321ms   | [S3,MB5,B]  327-39-367ms   | [S3,MB6,F]  370-14-385ms   | [S3,MB6,B]  390-36-427ms   | [S3,MB7,F]  429-17-447ms   | [S3,MB7,B]  454-22-477ms  
[rank3]:2025-11-29 01:44:37,442 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0144_stage3_step700.svg
[rank3]:2025-11-29 01:46:27,686 - INFO - Avg. fwd time: 14.1342 / Avg. bwd time: 33.4964 / Avg. batch time: 455.0707 (ms) / GPU bubble ratio: 16.27%
[rank0]:2025-11-29 01:46:27,747 - INFO - Avg. fwd time: 8.0201 / Avg. bwd time: 12.5742 / Avg. batch time: 549.6226 (ms) / GPU bubble ratio: 70.02%
[rank2]:2025-11-29 01:46:27,757 - INFO - Avg. fwd time: 7.6297 / Avg. bwd time: 16.5096 / Avg. batch time: 484.0647 (ms) / GPU bubble ratio: 60.11%
[rank1]:2025-11-29 01:46:27,794 - INFO - Avg. fwd time: 9.9438 / Avg. bwd time: 19.4993 / Avg. batch time: 519.5492 (ms) / GPU bubble ratio: 54.66%
[rank0]:2025-11-29 01:48:14,992 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 01:48:19,395 - INFO - Avg. fwd time: 14.1374 / Avg. bwd time: 33.4566 / Avg. batch time: 454.7831 (ms) / GPU bubble ratio: 16.28%
[rank1]:2025-11-29 01:48:19,457 - INFO - Avg. fwd time: 9.9467 / Avg. bwd time: 19.4731 / Avg. batch time: 519.2304 (ms) / GPU bubble ratio: 54.67%
[rank2]:2025-11-29 01:48:19,425 - INFO - Avg. fwd time: 7.6313 / Avg. bwd time: 16.4964 / Avg. batch time: 483.7608 (ms) / GPU bubble ratio: 60.10%
[rank0]:2025-11-29 01:48:19,487 - INFO - Avg. fwd time: 8.0235 / Avg. bwd time: 12.5025 / Avg. batch time: 549.2755 (ms) / GPU bubble ratio: 70.10%
[rank3]:2025-11-29 01:48:19,521 - INFO -  step: 750  loss:  0.2302  grad_norm:  0.0855  memory: 17.37GiB(36.56%)  tps: 7,372  tflops: 57.63  mfu: 18.47%
[rank1]:2025-11-29 01:48:19,512 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0855  memory:  9.36GiB(19.71%)  tps: 7,372  tflops: 57.63  mfu: 18.47%
[rank2]:2025-11-29 01:48:19,508 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0855  memory:  6.51GiB(13.70%)  tps: 7,372  tflops: 57.63  mfu: 18.47%
[rank0]:2025-11-29 01:48:19,523 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0855  memory: 13.29GiB(27.97%)  tps: 7,372  tflops: 57.63  mfu: 18.47%
[rank3]:2025-11-29 01:50:10,815 - INFO - Avg. fwd time: 14.1400 / Avg. bwd time: 33.4268 / Avg. batch time: 454.5715 (ms) / GPU bubble ratio: 16.29%
[rank2]:2025-11-29 01:50:10,887 - INFO - Avg. fwd time: 7.6325 / Avg. bwd time: 16.4856 / Avg. batch time: 483.5335 (ms) / GPU bubble ratio: 60.10%
[rank0]:2025-11-29 01:50:10,876 - INFO - Avg. fwd time: 8.0263 / Avg. bwd time: 12.4362 / Avg. batch time: 549.0105 (ms) / GPU bubble ratio: 70.18%
[rank1]:2025-11-29 01:50:10,924 - INFO - Avg. fwd time: 9.9489 / Avg. bwd time: 19.4518 / Avg. batch time: 518.9889 (ms) / GPU bubble ratio: 54.68%
[rank0]:2025-11-29 01:51:56,921 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 01:52:01,135 - INFO - Avg. fwd time: 14.1408 / Avg. bwd time: 33.3679 / Avg. batch time: 454.1386 (ms) / GPU bubble ratio: 16.31%
[rank0]:2025-11-29 01:52:01,197 - INFO - Avg. fwd time: 8.0292 / Avg. bwd time: 12.3715 / Avg. batch time: 548.5258 (ms) / GPU bubble ratio: 70.25%
[rank1]:2025-11-29 01:52:01,245 - INFO - Avg. fwd time: 9.9516 / Avg. bwd time: 19.4294 / Avg. batch time: 518.5317 (ms) / GPU bubble ratio: 54.67%
[rank2]:2025-11-29 01:52:01,208 - INFO - Avg. fwd time: 7.6341 / Avg. bwd time: 16.4739 / Avg. batch time: 483.0870 (ms) / GPU bubble ratio: 60.08%
[rank3]:2025-11-29 01:52:01,432 - INFO -  step: 800  loss:  0.2345  grad_norm:  0.0747  memory: 17.37GiB(36.56%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank3]:2025-11-29 01:52:01,433 - INFO -  final step: 800  loss:  0.2345  grad_norm:  0.0747  tps: 7,656  tflops: 59.85  mfu: 17.61%
[rank3]:2025-11-29 01:52:01,433 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-29 01:52:01,434 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-29 01:52:01,424 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0747  memory:  9.36GiB(19.71%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank1]:2025-11-29 01:52:01,424 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0747  tps: 7,651  tflops: 59.81  mfu: 17.48%
[rank1]:2025-11-29 01:52:01,424 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-29 01:52:01,425 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-29 01:52:01,420 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0747  memory:  6.51GiB(13.70%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank2]:2025-11-29 01:52:01,420 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0747  tps: 7,650  tflops: 59.81  mfu: 17.48%
[rank2]:2025-11-29 01:52:01,420 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-29 01:52:01,421 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-29 01:52:01,435 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0747  memory: 13.29GiB(27.97%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank0]:2025-11-29 01:52:01,435 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0747  tps: 7,650  tflops: 59.81  mfu: 17.48%
[rank0]:2025-11-29 01:52:01,435 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-29 01:52:01,435 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-29 01:52:03,461 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-29 01:52:03,533 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank1/251129_0152_stage1_final800.svg
[rank2]:2025-11-29 01:52:03,535 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank2/251129_0152_stage2_final800.svg
[rank0]:2025-11-29 01:52:03,535 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank0/251129_0152_stage0_final800.svg
[rank3]:2025-11-29 01:52:03,614 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0152_real_final800_rank3.svg
[rank3]:			> Batch Time: 541.78 ms, GPU Bubble Ratio: 72.66%, 57.42%, 64.76%, 31.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-247ms    | [S0,MB3,B]  315-0-315ms    | [S0,MB7,F]  316-6-322ms    | [S0,MB4,B]  366-23-389ms   | [S0,MB5,B]  424-23-448ms   | [S0,MB6,B]  482-18-501ms   | [S0,MB7,B]  525-16-541ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-98ms     | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  284-24-308ms   | [S1,MB6,F]  314-9-323ms    | [S1,MB4,B]  336-24-360ms   | [S1,MB7,F]  364-9-373ms    | [S1,MB5,B]  397-24-421ms   | [S1,MB6,B]  454-24-479ms   | [S1,MB7,B]  500-20-521ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  150-6-156ms    | [S2,MB2,B]  200-19-219ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  260-19-279ms   | [S2,MB5,F]  282-7-289ms    | [S2,MB4,B]  311-19-330ms   | [S2,MB6,F]  334-7-341ms    | [S2,MB5,B]  372-19-392ms   | [S2,MB7,F]  395-7-402ms    | [S2,MB6,B]  432-19-451ms   | [S2,MB7,B]  481-16-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  198-13-212ms   | [S3,MB3,B]  218-36-255ms   | [S3,MB4,F]  258-16-275ms   | [S3,MB4,B]  281-22-304ms   | [S3,MB5,F]  310-12-322ms   | [S3,MB5,B]  329-39-368ms   | [S3,MB6,F]  371-13-385ms   | [S3,MB6,B]  391-36-427ms   | [S3,MB7,F]  430-17-448ms   | [S3,MB7,B]  454-22-477ms  
[rank0]:2025-11-29 01:52:03,695 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251129_0152_rank0_stage0.svg
[rank0]:	> Counts Sum: 321360, Total Sum: 1728640 (18.59%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.2, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.29, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank3]:2025-11-29 01:52:03,743 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/pipeline_schedule/251129_0152_thry_final800_rank3.svg
[rank3]:			> Batch Time: 329.47 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  99-19-119ms    | [S0,MB4,F]  119-9-129ms    | [S0,MB1,B]  129-19-149ms   | [S0,MB5,F]  149-9-159ms    | [S0,MB2,B]  159-19-179ms   | [S0,MB6,F]  179-9-189ms    | [S0,MB3,B]  189-19-209ms   | [S0,MB7,F]  209-9-219ms    | [S0,MB4,B]  219-19-239ms   | [S0,MB5,B]  249-19-269ms   | [S0,MB6,B]  279-19-299ms   | [S0,MB7,B]  309-19-329ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB0,B]  79-19-99ms     | [S1,MB3,F]  99-9-109ms     | [S1,MB1,B]  109-19-129ms   | [S1,MB4,F]  129-9-139ms    | [S1,MB2,B]  139-19-159ms   | [S1,MB5,F]  159-9-169ms    | [S1,MB3,B]  169-19-189ms   | [S1,MB6,F]  189-9-199ms    | [S1,MB4,B]  199-19-219ms   | [S1,MB7,F]  219-9-229ms    | [S1,MB5,B]  229-19-249ms   | [S1,MB6,B]  259-19-279ms   | [S1,MB7,B]  289-19-309ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB0,B]  59-19-79ms     | [S2,MB2,F]  79-9-89ms      | [S2,MB1,B]  89-19-109ms    | [S2,MB3,F]  109-9-119ms    | [S2,MB2,B]  119-19-139ms   | [S2,MB4,F]  139-9-149ms    | [S2,MB3,B]  149-19-169ms   | [S2,MB5,F]  169-9-179ms    | [S2,MB4,B]  179-19-199ms   | [S2,MB6,F]  199-9-209ms    | [S2,MB5,B]  209-19-229ms   | [S2,MB7,F]  229-9-239ms    | [S2,MB6,B]  239-19-259ms   | [S2,MB7,B]  269-19-289ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB0,B]  39-19-59ms     | [S3,MB1,F]  59-9-69ms      | [S3,MB1,B]  69-19-89ms     | [S3,MB2,F]  89-9-99ms      | [S3,MB2,B]  99-19-119ms    | [S3,MB3,F]  119-9-129ms    | [S3,MB3,B]  129-19-149ms   | [S3,MB4,F]  149-9-159ms    | [S3,MB4,B]  159-19-179ms   | [S3,MB5,F]  179-9-189ms    | [S3,MB5,B]  189-19-209ms   | [S3,MB6,F]  209-9-219ms    | [S3,MB6,B]  219-19-239ms   | [S3,MB7,F]  239-9-249ms    | [S3,MB7,B]  249-19-269ms  
[rank1]:2025-11-29 01:52:03,679 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251129_0152_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank2]:2025-11-29 01:52:03,693 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251129_0152_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank3]:2025-11-29 01:52:03,791 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_ratio_history/rank3/251129_0152_stage3_final800.svg
[rank3]:2025-11-29 01:52:03,925 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/frozen_params_histogram/251129_0152_rank3_stage3.svg
[rank3]:	> Counts Sum: 520640, Total Sum: 1354880 (38.43%), Ratio(%) per element: [38.86, 38.69, 37.5, 38.01, 37.32, 39.21, 38.86, 38.18, 38.18, 37.5, 39.38, 38.18, 39.38, 38.18, 39.21, 38.52, 38.86, 38.86, 37.15, 37.67, 39.38, 39.04, 38.01, 38.52, 38.18, 38.18, 38.52, 37.84, 38.86]
[rank1]:2025-11-29 01:52:05,519 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251129_0152_stage1.svg
[rank1]:2025-11-29 01:52:05,522 - INFO - Destroying the purge thread.
[rank2]:2025-11-29 01:52:05,551 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251129_0152_stage2.svg
[rank2]:2025-11-29 01:52:05,554 - INFO - Destroying the purge thread.
[rank0]:2025-11-29 01:52:05,561 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251129_0152_stage0.svg
[rank0]:2025-11-29 01:52:05,563 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-29 01:52:05,731 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1/afr_time_plot/251129_0152_stage3.svg
[rank3]:2025-11-29 01:52:05,734 - INFO - Destroying the purge thread.
[rank1]:2025-11-29 01:52:05,710 - INFO - Process group destroyed
[rank2]:2025-11-29 01:52:05,722 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 313-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.28017
[rank3]:wandb:               final/avg_loss 0.2345
[rank3]:wandb:             final/avg_mfu(%) 17.61188
[rank3]:wandb:             final/avg_tflops 59.84934
[rank3]:wandb:    final/avg_throughput(tps) 7655.77716
[rank3]:wandb:              final/grad_norm 0.07471
[rank3]:wandb:               final/max_loss 0.2345
[rank3]:wandb:                    grad_norm 0.07471
[rank3]:wandb: loss_metrics/global_avg_loss 0.2345
[rank3]:wandb: loss_metrics/global_max_loss 0.2345
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.4_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/diaobh72
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.4_42_dm1/20251129-0051/wandb/run-20251129_005121-diaobh72/logs
[rank3]:2025-11-29 01:52:07,262 - INFO - Process group destroyed
[rank0]:2025-11-29 01:52:07,564 - INFO - Training completed
[rank0]:2025-11-29 01:52:07,564 - INFO - Destroying the purge thread.
[rank0]:2025-11-29 01:52:07,752 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.11', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.3', 'layers.2', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.6', 'layers.8', 'layers.5', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.13', 'layers.14', 'output', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.4_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.4
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
