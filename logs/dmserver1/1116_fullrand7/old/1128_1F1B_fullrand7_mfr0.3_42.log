
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 28. (ê¸ˆ) 23:48:53 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/1128_1F1B_fullrand7_mfr0.3_42.log
âœ”ï¸1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver
âœ”ï¸Running with fullrand7 (max_freeze_ratio=0.3) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml --job.description="1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.max_freeze_ratio=0.3
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-28 23:49:00,011 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank2]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:2025-11-28 23:49:00,013 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-28 23:49:00,093 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank0]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-28 23:49:00,327 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-28 23:49:00,263 - INFO - Starting job: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank1]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank0]:2025-11-28 23:49:00,329 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 23:49:00,333 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 23:49:00,334 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-11-28 23:49:00,249 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 23:49:00,252 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-28 23:49:00,262 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 23:49:00,264 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-28 23:49:00,451 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-28 23:49:00,453 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 23:49:00,737 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-28 23:49:03,597 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-28 23:49:03,726 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 23:49:03,768 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 23:49:03,815 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 23:49:03,816 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-28 23:49:03,844 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-28 23:49:03,844 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-28 23:49:03,766 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 23:49:03,791 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-28 23:49:03,792 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 23:49:03,775 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-28 23:49:03,817 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 23:49:03,842 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-28 23:49:03,843 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 23:49:04,039 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 23:49:04,039 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-28 23:49:04,039 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-28 23:49:03,998 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 23:49:03,998 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-28 23:49:03,999 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-28 23:49:04,036 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 23:49:04,036 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-28 23:49:04,036 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ekqqy9mu
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.3_42_dm1/20251128-2349/wandb/run-20251128_234905-ekqqy9mu
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ekqqy9mu
[rank3]:2025-11-28 23:49:06,376 - INFO - WandB logging enabled
[rank3]:2025-11-28 23:49:06,376 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-28 23:49:06,416 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 23:49:06,446 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-28 23:49:06,447 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-28 23:49:06,640 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 23:49:06,640 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-28 23:49:06,641 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-11-28 23:49:06,658 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank0]:2025-11-28 23:49:06,658 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 23:49:06,658 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-28 23:49:06,659 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-11-28 23:49:06,656 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-28 23:49:06,658 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-28 23:49:06,657 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 23:49:09,178 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-28 23:49:09,178 - INFO - Finished loading the checkpoint in 2.52 seconds.
[rank0]:2025-11-28 23:49:09,178 - INFO - Training starts at step 1
[rank3]:2025-11-28 23:49:14,805 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5375  memory: 12.97GiB(27.31%)  tps: 3,907  tflops: 30.55  mfu: 9.79%
[rank3]:2025-11-28 23:49:14,806 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 23:49:14,797 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5375  memory:  4.63GiB(9.75%)  tps: 2,985  tflops: 23.33  mfu: 7.48%
[rank2]:2025-11-28 23:49:14,797 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-28 23:49:14,799 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5375  memory:  6.76GiB(14.24%)  tps: 2,970  tflops: 23.22  mfu: 7.44%
[rank1]:2025-11-28 23:49:14,800 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 23:49:14,833 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5375  memory:  9.19GiB(19.34%)  tps: 2,974  tflops: 23.25  mfu: 7.45%
[rank0]:2025-11-28 23:49:14,834 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 23:51:16,901 - INFO - Avg. fwd time: 13.2840 / Avg. bwd time: 41.6535 / Avg. batch time: 512.1005 (ms) / GPU bubble ratio: 14.18%
[rank2]:2025-11-28 23:51:16,940 - INFO - Avg. fwd time: 7.2867 / Avg. bwd time: 18.9608 / Avg. batch time: 544.1971 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-11-28 23:51:16,975 - INFO - Avg. fwd time: 9.3941 / Avg. bwd time: 23.9240 / Avg. batch time: 583.3459 (ms) / GPU bubble ratio: 54.31%
[rank0]:2025-11-28 23:51:16,971 - INFO - Avg. fwd time: 7.3497 / Avg. bwd time: 23.5348 / Avg. batch time: 620.5584 (ms) / GPU bubble ratio: 60.18%
[rank0]:2025-11-28 23:53:20,284 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:53:25,075 - INFO - Avg. fwd time: 13.4449 / Avg. bwd time: 41.9411 / Avg. batch time: 515.5257 (ms) / GPU bubble ratio: 14.05%
[rank2]:2025-11-28 23:53:25,114 - INFO - Avg. fwd time: 7.2935 / Avg. bwd time: 19.0159 / Avg. batch time: 547.2165 (ms) / GPU bubble ratio: 61.54%
[rank1]:2025-11-28 23:53:25,149 - INFO - Avg. fwd time: 9.4156 / Avg. bwd time: 24.0035 / Avg. batch time: 585.9715 (ms) / GPU bubble ratio: 54.37%
[rank0]:2025-11-28 23:53:25,145 - INFO - Avg. fwd time: 7.3655 / Avg. bwd time: 23.5925 / Avg. batch time: 622.7565 (ms) / GPU bubble ratio: 60.23%
[rank1]:2025-11-28 23:53:25,380 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7776  memory:  9.03GiB(19.01%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank2]:2025-11-28 23:53:25,376 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7776  memory:  6.43GiB(13.53%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank3]:2025-11-28 23:53:25,389 - INFO -  step: 50  loss:  9.9162  grad_norm: 12.7776  memory: 16.39GiB(34.50%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank0]:2025-11-28 23:53:25,391 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7776  memory: 12.97GiB(27.31%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank3]:2025-11-28 23:54:16,611 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-28 23:55:07,806 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-28 23:55:08,126 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-28 23:55:25,222 - INFO - Avg. fwd time: 13.5449 / Avg. bwd time: 40.6543 / Avg. batch time: 505.9771 (ms) / GPU bubble ratio: 14.31%
[rank2]:2025-11-28 23:55:25,238 - INFO - Avg. fwd time: 7.3888 / Avg. bwd time: 18.3448 / Avg. batch time: 536.8476 (ms) / GPU bubble ratio: 61.65%
[rank1]:2025-11-28 23:55:25,254 - INFO - Avg. fwd time: 9.5160 / Avg. bwd time: 23.1590 / Avg. batch time: 574.6010 (ms) / GPU bubble ratio: 54.51%
[rank0]:2025-11-28 23:55:25,260 - INFO - Avg. fwd time: 7.4456 / Avg. bwd time: 22.0507 / Avg. batch time: 609.6423 (ms) / GPU bubble ratio: 61.29%
[rank3]:2025-11-28 23:55:42,344 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-28 23:55:42,514 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251128_2355_max_batch_time.svg
[rank3]:			> Batch Time: 541.16 ms, GPU Bubble Ratio: 54.13%, 50.69%, 61.08%, 17.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  126-23-150ms   | [S0,MB4,F]  150-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  232-23-256ms   | [S0,MB6,F]  256-6-263ms    | [S0,MB3,B]  289-23-312ms   | [S0,MB7,F]  312-6-319ms    | [S0,MB4,B]  346-23-369ms   | [S0,MB5,B]  403-23-426ms   | [S0,MB6,B]  459-23-483ms   | [S0,MB7,B]  517-23-541ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  101-24-126ms   | [S1,MB3,F]  126-8-135ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  208-24-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  265-24-289ms   | [S1,MB6,F]  289-9-298ms    | [S1,MB4,B]  321-24-346ms   | [S1,MB7,F]  346-9-355ms    | [S1,MB5,B]  379-24-403ms   | [S1,MB6,B]  435-23-459ms   | [S1,MB7,B]  493-23-517ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  208-7-215ms    | [S2,MB3,B]  246-19-265ms   | [S2,MB5,F]  265-6-272ms    | [S2,MB4,B]  302-19-321ms   | [S2,MB6,F]  321-6-328ms    | [S2,MB5,B]  360-19-379ms   | [S2,MB7,F]  379-6-386ms    | [S2,MB6,B]  416-19-435ms   | [S2,MB7,B]  474-19-493ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-148ms   | [S3,MB2,B]  148-41-189ms   AFR(10):0.9655 | [S3,MB3,F]  189-14-203ms   | [S3,MB3,B]  203-42-246ms   AFR(10):0.9655 | [S3,MB4,F]  246-13-259ms   | [S3,MB4,B]  259-42-302ms   AFR(10):0.9655 | [S3,MB5,F]  302-14-317ms   | [S3,MB5,B]  317-42-360ms   AFR(10):0.9655 | [S3,MB6,F]  360-14-374ms   | [S3,MB6,B]  374-42-416ms   AFR(10):0.9655 | [S3,MB7,F]  416-14-431ms   | [S3,MB7,B]  431-43-474ms   AFR(10):0.9655
[rank3]:2025-11-28 23:55:42,642 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251128_2355_min_batch_time.svg
[rank3]:			> Batch Time: 329.81 ms, GPU Bubble Ratio: 82.23%, 50.99%, 61.65%, 14.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  83-0-83ms      | [S0,MB4,F]  83-6-90ms      | [S0,MB1,B]  115-0-115ms    | [S0,MB5,F]  115-6-122ms    | [S0,MB2,B]  150-0-150ms    | [S0,MB6,F]  150-6-157ms    | [S0,MB3,B]  186-0-186ms    | [S0,MB7,F]  186-6-193ms    | [S0,MB4,B]  222-0-222ms    | [S0,MB5,B]  258-0-258ms    | [S0,MB6,B]  294-0-294ms    | [S0,MB7,B]  329-0-329ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  72-10-83ms     | [S1,MB3,F]  83-8-92ms      | [S1,MB1,B]  104-10-115ms   | [S1,MB4,F]  115-9-125ms    | [S1,MB2,B]  139-10-150ms   | [S1,MB5,F]  150-9-159ms    | [S1,MB3,B]  175-11-186ms   | [S1,MB6,F]  186-9-195ms    | [S1,MB4,B]  211-10-222ms   | [S1,MB7,F]  222-9-231ms    | [S1,MB5,B]  247-11-258ms   | [S1,MB6,B]  283-10-294ms   | [S1,MB7,B]  319-10-329ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  64-8-72ms      | [S2,MB2,F]  72-6-79ms      | [S2,MB1,B]  96-8-104ms     | [S2,MB3,F]  104-7-111ms    | [S2,MB2,B]  131-8-139ms    | [S2,MB4,F]  139-7-146ms    | [S2,MB3,B]  166-8-175ms    | [S2,MB5,F]  175-6-182ms    | [S2,MB4,B]  202-8-211ms    | [S2,MB6,F]  211-6-218ms    | [S2,MB5,B]  238-8-247ms    | [S2,MB7,F]  247-6-254ms    | [S2,MB6,B]  274-8-283ms    | [S2,MB7,B]  310-8-319ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-21-64ms     AFR(10):0.9655 | [S3,MB1,F]  64-10-75ms     | [S3,MB1,B]  75-21-96ms     AFR(10):0.9655 | [S3,MB2,F]  96-13-110ms    | [S3,MB2,B]  110-21-131ms   AFR(10):0.9655 | [S3,MB3,F]  131-14-145ms   | [S3,MB3,B]  145-21-166ms   AFR(10):0.9655 | [S3,MB4,F]  166-13-180ms   | [S3,MB4,B]  180-21-202ms   AFR(10):0.9655 | [S3,MB5,F]  202-14-216ms   | [S3,MB5,B]  216-22-238ms   AFR(10):0.9655 | [S3,MB6,F]  238-14-253ms   | [S3,MB6,B]  253-21-274ms   AFR(10):0.9655 | [S3,MB7,F]  274-14-288ms   | [S3,MB7,B]  288-21-310ms   AFR(10):0.9655
[rank3]:2025-11-28 23:55:56,530 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251128_2355_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 442.33 ms, GPU Bubble Ratio: 51.82%, 42.64%, 54.76%, 10.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S0,MB0,B]  126-23-150ms   | [S0,MB4,F]  150-6-156ms    | [S0,MB1,B]  177-23-201ms   | [S0,MB5,F]  201-6-208ms    | [S0,MB2,B]  232-23-256ms   | [S0,MB6,F]  256-6-263ms    | [S0,MB3,B]  289-23-312ms   | [S0,MB7,F]  312-6-319ms    | [S0,MB4,B]  324-23-348ms   | [S0,MB5,B]  381-23-405ms   | [S0,MB6,B]  430-12-442ms   | [S0,MB7,B]  442-0-442ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB0,B]  101-24-126ms   | [S1,MB3,F]  126-8-135ms    | [S1,MB1,B]  153-24-177ms   | [S1,MB4,F]  177-9-186ms    | [S1,MB2,B]  208-24-232ms   | [S1,MB5,F]  232-9-241ms    | [S1,MB3,B]  265-24-289ms   | [S1,MB6,F]  289-9-298ms    | [S1,MB4,B]  300-24-324ms   | [S1,MB7,F]  324-9-333ms    | [S1,MB5,B]  357-24-381ms   | [S1,MB6,B]  406-23-430ms   | [S1,MB7,B]  431-10-442ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB0,B]  82-19-101ms    | [S2,MB2,F]  101-6-108ms    | [S2,MB1,B]  134-19-153ms   | [S2,MB3,F]  153-7-160ms    | [S2,MB2,B]  189-19-208ms   | [S2,MB4,F]  208-7-215ms    | [S2,MB3,B]  246-19-265ms   | [S2,MB5,F]  265-6-272ms    | [S2,MB4,B]  281-19-300ms   | [S2,MB6,F]  300-6-307ms    | [S2,MB5,B]  338-19-357ms   | [S2,MB7,F]  357-6-364ms    | [S2,MB6,B]  387-19-406ms   | [S2,MB7,B]  422-8-431ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  42-39-82ms     AFR(10):0.9655 | [S3,MB1,F]  82-10-93ms     | [S3,MB1,B]  93-40-134ms    AFR(10):0.9655 | [S3,MB2,F]  134-13-148ms   | [S3,MB2,B]  148-41-189ms   AFR(10):0.9655 | [S3,MB3,F]  189-14-203ms   | [S3,MB3,B]  203-42-246ms   AFR(10):0.9655 | [S3,MB4,F]  246-13-259ms   | [S3,MB4,B]  259-21-281ms   AFR(10):0.9655 | [S3,MB5,F]  281-14-295ms   | [S3,MB5,B]  295-42-338ms   AFR(10):0.9655 | [S3,MB6,F]  338-14-352ms   | [S3,MB6,B]  352-34-387ms   AFR(10):0.9655 | [S3,MB7,F]  387-14-401ms   | [S3,MB7,B]  401-21-422ms   AFR(10):0.9655
[rank3]:2025-11-28 23:55:56,531 - INFO - 	> Batch Time: 442.33 ms (Average Freeze Ratio: 0.18, Time Reduction Rate: 0.18)
[rank0]:2025-11-28 23:57:26,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 23:57:31,660 - INFO - Avg. fwd time: 13.5995 / Avg. bwd time: 39.0702 / Avg. batch time: 493.9333 (ms) / GPU bubble ratio: 14.69%
[rank3]:2025-11-28 23:57:31,671 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.10(0.13)/0.40, [MB7] 0.28(0.33)/1.00
[rank2]:2025-11-28 23:57:31,696 - INFO - Avg. fwd time: 7.4926 / Avg. bwd time: 17.6022 / Avg. batch time: 524.2900 (ms) / GPU bubble ratio: 61.71%
[rank1]:2025-11-28 23:57:31,733 - INFO - Avg. fwd time: 9.6480 / Avg. bwd time: 22.0444 / Avg. batch time: 561.4091 (ms) / GPU bubble ratio: 54.84%
[rank0]:2025-11-28 23:57:31,730 - INFO - Avg. fwd time: 7.5793 / Avg. bwd time: 19.4583 / Avg. batch time: 594.4352 (ms) / GPU bubble ratio: 63.61%
[rank2]:2025-11-28 23:57:31,891 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank3]:2025-11-28 23:57:31,965 - INFO -  step: 100  loss:  8.6870  grad_norm:  8.1236  memory: 16.88GiB(35.53%)  tps: 6,645  tflops: 51.94  mfu: 16.65%
[rank1]:2025-11-28 23:57:31,917 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-11-28 23:57:31,956 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1236  memory:  9.36GiB(19.71%)  tps: 6,645  tflops: 51.94  mfu: 16.65%
[rank0]:2025-11-28 23:57:31,938 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.16)/0.49, [MB7] 0.27(0.33)/1.00
[rank0]:2025-11-28 23:57:31,968 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1236  memory: 12.97GiB(27.31%)  tps: 6,645  tflops: 51.94  mfu: 16.65%
[rank2]:2025-11-28 23:57:31,952 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.1236  memory:  6.51GiB(13.70%)  tps: 6,645  tflops: 51.94  mfu: 16.65%
[rank3]:2025-11-28 23:57:32,108 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251128_2357_real_step100_rank3.svg
[rank3]:			> Batch Time: 607.33 ms, GPU Bubble Ratio: 64.98%, 57.16%, 66.06%, 28.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  138-16-155ms   | [S0,MB4,F]  155-7-162ms    | [S0,MB1,B]  199-16-216ms   | [S0,MB5,F]  216-6-223ms    | [S0,MB2,B]  266-16-283ms   | [S0,MB6,F]  283-6-289ms    | [S0,MB3,B]  335-16-351ms   | [S0,MB7,F]  351-6-358ms    | [S0,MB4,B]  399-23-423ms   | [S0,MB5,B]  462-23-485ms   | [S0,MB6,B]  527-19-546ms   | [S0,MB7,B]  588-19-607ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-45ms      | [S1,MB0,B]  112-21-133ms   | [S1,MB3,F]  137-9-146ms    | [S1,MB1,B]  173-21-194ms   | [S1,MB4,F]  198-9-207ms    | [S1,MB2,B]  240-21-261ms   | [S1,MB5,F]  265-9-274ms    | [S1,MB3,B]  305-24-330ms   | [S1,MB6,F]  333-9-342ms    | [S1,MB4,B]  370-24-394ms   | [S1,MB7,F]  398-9-407ms    | [S1,MB5,B]  434-24-459ms   | [S1,MB6,B]  499-24-523ms   | [S1,MB7,B]  561-23-584ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-40ms      | [S2,MB0,B]  90-16-107ms    | [S2,MB2,F]  110-7-118ms    | [S2,MB1,B]  152-16-168ms   | [S2,MB3,F]  171-6-178ms    | [S2,MB2,B]  216-19-235ms   | [S2,MB4,F]  238-7-245ms    | [S2,MB3,B]  281-19-300ms   | [S2,MB5,F]  304-7-311ms    | [S2,MB4,B]  346-19-365ms   | [S2,MB6,F]  369-7-376ms    | [S2,MB5,B]  410-19-429ms   | [S2,MB7,F]  433-7-440ms    | [S2,MB6,B]  477-19-496ms   | [S2,MB7,B]  540-18-558ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  89-11-100ms    | [S3,MB1,B]  106-40-147ms   | [S3,MB2,F]  150-12-163ms   | [S3,MB2,B]  168-42-210ms   | [S3,MB3,F]  214-13-227ms   | [S3,MB3,B]  233-43-276ms   | [S3,MB4,F]  280-13-294ms   | [S3,MB4,B]  300-41-341ms   | [S3,MB5,F]  344-15-360ms   | [S3,MB5,B]  366-38-405ms   | [S3,MB6,F]  409-14-423ms   | [S3,MB6,B]  428-43-472ms   | [S3,MB7,F]  476-13-489ms   | [S3,MB7,B]  495-41-537ms  
[rank1]:2025-11-28 23:57:32,028 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251128_2357_stage1_step100.svg
[rank0]:2025-11-28 23:57:32,028 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251128_2357_stage0_step100.svg
[rank2]:2025-11-28 23:57:32,026 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251128_2357_stage2_step100.svg
[rank3]:2025-11-28 23:57:32,151 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251128_2357_stage3_step100.svg
[rank3]:2025-11-28 23:59:33,444 - INFO - Avg. fwd time: 13.6271 / Avg. bwd time: 38.9503 / Avg. batch time: 493.1623 (ms) / GPU bubble ratio: 14.71%
[rank1]:2025-11-28 23:59:33,520 - INFO - Avg. fwd time: 9.6235 / Avg. bwd time: 22.1140 / Avg. batch time: 560.7863 (ms) / GPU bubble ratio: 54.72%
[rank2]:2025-11-28 23:59:33,482 - INFO - Avg. fwd time: 7.4720 / Avg. bwd time: 17.7238 / Avg. batch time: 523.6117 (ms) / GPU bubble ratio: 61.50%
[rank0]:2025-11-28 23:59:33,518 - INFO - Avg. fwd time: 7.5848 / Avg. bwd time: 19.5742 / Avg. batch time: 593.8629 (ms) / GPU bubble ratio: 63.41%
[rank0]:2025-11-29 00:01:30,876 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-29 00:01:35,593 - INFO - Avg. fwd time: 9.6371 / Avg. bwd time: 21.9094 / Avg. batch time: 560.7402 (ms) / GPU bubble ratio: 54.99%
[rank1]:2025-11-29 00:01:35,600 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank0]:2025-11-29 00:01:35,621 - INFO - Avg. fwd time: 7.6372 / Avg. bwd time: 19.3259 / Avg. batch time: 593.6907 (ms) / GPU bubble ratio: 63.67%
[rank2]:2025-11-29 00:01:35,565 - INFO - Avg. fwd time: 7.4801 / Avg. bwd time: 17.6386 / Avg. batch time: 523.7165 (ms) / GPU bubble ratio: 61.63%
[rank2]:2025-11-29 00:01:35,571 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank3]:2025-11-29 00:01:35,541 - INFO - Avg. fwd time: 13.6490 / Avg. bwd time: 38.9560 / Avg. batch time: 493.4597 (ms) / GPU bubble ratio: 14.72%
[rank3]:2025-11-29 00:01:35,546 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.24(0.27)/0.40, [MB7] 0.59(0.67)/1.00
[rank1]:2025-11-29 00:01:35,646 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.1721  memory:  9.36GiB(19.71%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank0]:2025-11-29 00:01:35,629 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.32)/0.49, [MB7] 0.59(0.67)/1.00
[rank0]:2025-11-29 00:01:35,657 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.1721  memory: 13.29GiB(27.97%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank2]:2025-11-29 00:01:35,643 - INFO -  step: 150  loss: -8.0000  grad_norm:  6.1721  memory:  6.51GiB(13.70%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank3]:2025-11-29 00:01:35,655 - INFO -  step: 150  loss:  3.8628  grad_norm:  6.1721  memory: 16.88GiB(35.53%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank3]:2025-11-29 00:03:32,305 - INFO - Avg. fwd time: 13.6787 / Avg. bwd time: 38.5806 / Avg. batch time: 490.7295 (ms) / GPU bubble ratio: 14.81%
[rank2]:2025-11-29 00:03:32,364 - INFO - Avg. fwd time: 7.4849 / Avg. bwd time: 17.5959 / Avg. batch time: 520.8731 (ms) / GPU bubble ratio: 61.48%
[rank1]:2025-11-29 00:03:32,403 - INFO - Avg. fwd time: 9.6609 / Avg. bwd time: 21.6895 / Avg. batch time: 557.7465 (ms) / GPU bubble ratio: 55.03%
[rank0]:2025-11-29 00:03:32,400 - INFO - Avg. fwd time: 7.6755 / Avg. bwd time: 18.9556 / Avg. batch time: 590.3777 (ms) / GPU bubble ratio: 63.91%
[rank0]:2025-11-29 00:05:23,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 00:05:27,762 - INFO - Avg. fwd time: 13.7139 / Avg. bwd time: 38.1052 / Avg. batch time: 487.4485 (ms) / GPU bubble ratio: 14.95%
[rank3]:2025-11-29 00:05:27,801 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.38(0.40)/0.40, [MB7] 0.93(1.00)/1.00
[rank2]:2025-11-29 00:05:27,833 - INFO - Avg. fwd time: 7.5070 / Avg. bwd time: 17.4422 / Avg. batch time: 517.3680 (ms) / GPU bubble ratio: 61.42%
[rank1]:2025-11-29 00:05:27,872 - INFO - Avg. fwd time: 9.6984 / Avg. bwd time: 21.3774 / Avg. batch time: 554.0267 (ms) / GPU bubble ratio: 55.13%
[rank0]:2025-11-29 00:05:27,868 - INFO - Avg. fwd time: 7.7289 / Avg. bwd time: 18.3136 / Avg. batch time: 586.2982 (ms) / GPU bubble ratio: 64.47%
[rank2]:2025-11-29 00:05:28,011 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-11-29 00:05:28,034 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-11-29 00:05:28,072 - INFO -  step: 200  loss: -8.0000  grad_norm:  4.7747  memory:  9.36GiB(19.71%)  tps: 7,049  tflops: 55.11  mfu: 17.66%
[rank3]:2025-11-29 00:05:28,080 - INFO -  step: 200  loss:  1.2997  grad_norm:  4.7747  memory: 17.37GiB(36.56%)  tps: 7,049  tflops: 55.11  mfu: 17.66%
[rank2]:2025-11-29 00:05:28,068 - INFO -  step: 200  loss: -8.0000  grad_norm:  4.7747  memory:  6.51GiB(13.70%)  tps: 7,049  tflops: 55.11  mfu: 17.66%
[rank0]:2025-11-29 00:05:28,054 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.46(0.49)/0.49, [MB7] 0.95(1.00)/1.00
[rank0]:2025-11-29 00:05:28,082 - INFO -  step: 200  loss: -8.0000  grad_norm:  4.7747  memory: 13.29GiB(27.97%)  tps: 7,049  tflops: 55.11  mfu: 17.66%
[rank0]:2025-11-29 00:05:28,134 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251129_0005_stage0_step200.svg
[rank1]:2025-11-29 00:05:28,133 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251129_0005_stage1_step200.svg
[rank2]:2025-11-29 00:05:28,138 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251129_0005_stage2_step200.svg
[rank3]:2025-11-29 00:05:28,224 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0005_real_step200_rank3.svg
[rank3]:			> Batch Time: 557.97 ms, GPU Bubble Ratio: 69.99%, 57.90%, 65.71%, 29.99%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  106-4-110ms    | [S0,MB4,F]  110-8-119ms    | [S0,MB1,B]  169-4-174ms    | [S0,MB5,F]  174-6-181ms    | [S0,MB2,B]  242-4-247ms    | [S0,MB6,F]  247-6-253ms    | [S0,MB3,B]  319-4-324ms    | [S0,MB7,F]  324-6-330ms    | [S0,MB4,B]  381-23-405ms   | [S0,MB5,B]  430-23-454ms   | [S0,MB6,B]  490-18-508ms   | [S0,MB7,B]  541-16-557ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  88-12-100ms    | [S1,MB3,F]  104-10-115ms   | [S1,MB1,B]  151-12-164ms   | [S1,MB4,F]  167-8-176ms    | [S1,MB2,B]  224-12-236ms   | [S1,MB5,F]  240-8-248ms    | [S1,MB3,B]  289-24-313ms   | [S1,MB6,F]  317-8-326ms    | [S1,MB4,B]  349-24-373ms   | [S1,MB7,F]  379-9-389ms    | [S1,MB5,B]  402-24-426ms   | [S1,MB6,B]  462-24-487ms   | [S1,MB7,B]  516-20-537ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  74-8-83ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  150-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-6-229ms    | [S2,MB3,B]  265-19-284ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB4,B]  325-19-344ms   | [S2,MB6,F]  348-7-355ms    | [S2,MB5,B]  377-19-397ms   | [S2,MB7,F]  400-7-407ms    | [S2,MB6,B]  440-19-459ms   | [S2,MB7,B]  497-16-513ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  198-13-211ms   | [S3,MB3,B]  217-42-260ms   | [S3,MB4,F]  263-13-277ms   | [S3,MB4,B]  283-36-320ms   | [S3,MB5,F]  323-18-341ms   | [S3,MB5,B]  347-22-370ms   | [S3,MB6,F]  376-11-388ms   | [S3,MB6,B]  394-41-435ms   | [S3,MB7,F]  438-13-452ms   | [S3,MB7,B]  459-35-495ms  
[rank3]:2025-11-29 00:05:28,268 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251129_0005_stage3_step200.svg
[rank3]:2025-11-29 00:07:22,288 - INFO - Avg. fwd time: 13.7540 / Avg. bwd time: 37.6567 / Avg. batch time: 484.3882 (ms) / GPU bubble ratio: 15.09%
[rank2]:2025-11-29 00:07:22,312 - INFO - Avg. fwd time: 7.5294 / Avg. bwd time: 17.2957 / Avg. batch time: 514.1692 (ms) / GPU bubble ratio: 61.37%
[rank0]:2025-11-29 00:07:22,364 - INFO - Avg. fwd time: 7.7749 / Avg. bwd time: 17.4135 / Avg. batch time: 582.5510 (ms) / GPU bubble ratio: 65.41%
[rank1]:2025-11-29 00:07:22,339 - INFO - Avg. fwd time: 9.7376 / Avg. bwd time: 21.0792 / Avg. batch time: 550.6334 (ms) / GPU bubble ratio: 55.23%
[rank0]:2025-11-29 00:09:11,931 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 00:09:16,145 - INFO - Avg. fwd time: 13.7729 / Avg. bwd time: 37.3557 / Avg. batch time: 482.2856 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-11-29 00:09:16,218 - INFO - Avg. fwd time: 7.5441 / Avg. bwd time: 17.1947 / Avg. batch time: 511.9235 (ms) / GPU bubble ratio: 61.34%
[rank0]:2025-11-29 00:09:16,197 - INFO - Avg. fwd time: 7.8048 / Avg. bwd time: 16.7671 / Avg. batch time: 579.9130 (ms) / GPU bubble ratio: 66.10%
[rank1]:2025-11-29 00:09:16,259 - INFO - Avg. fwd time: 9.7620 / Avg. bwd time: 20.8692 / Avg. batch time: 548.2474 (ms) / GPU bubble ratio: 55.30%
[rank3]:2025-11-29 00:09:16,185 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.41(0.40)/0.40, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-29 00:09:16,377 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-29 00:09:16,434 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9472  memory:  6.51GiB(13.70%)  tps: 7,174  tflops: 56.09  mfu: 17.98%
[rank0]:2025-11-29 00:09:16,419 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 00:09:16,400 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 00:09:16,437 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9472  memory:  9.36GiB(19.71%)  tps: 7,174  tflops: 56.09  mfu: 17.98%
[rank3]:2025-11-29 00:09:16,446 - INFO -  step: 250  loss:  0.4373  grad_norm:  0.9472  memory: 17.37GiB(36.56%)  tps: 7,175  tflops: 56.09  mfu: 17.98%
[rank0]:2025-11-29 00:09:16,448 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.9472  memory: 13.29GiB(27.97%)  tps: 7,174  tflops: 56.09  mfu: 17.98%
[rank3]:2025-11-29 00:11:10,398 - INFO - Avg. fwd time: 13.7933 / Avg. bwd time: 37.0641 / Avg. batch time: 480.2632 (ms) / GPU bubble ratio: 15.28%
[rank2]:2025-11-29 00:11:10,468 - INFO - Avg. fwd time: 7.5579 / Avg. bwd time: 17.0978 / Avg. batch time: 509.7641 (ms) / GPU bubble ratio: 61.31%
[rank0]:2025-11-29 00:11:10,449 - INFO - Avg. fwd time: 7.8335 / Avg. bwd time: 16.1629 / Avg. batch time: 577.3756 (ms) / GPU bubble ratio: 66.75%
[rank1]:2025-11-29 00:11:10,508 - INFO - Avg. fwd time: 9.7853 / Avg. bwd time: 20.6673 / Avg. batch time: 545.9523 (ms) / GPU bubble ratio: 55.38%
[rank0]:2025-11-29 00:13:00,315 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-29 00:13:04,848 - INFO - Avg. fwd time: 7.5691 / Avg. bwd time: 17.0192 / Avg. batch time: 507.9607 (ms) / GPU bubble ratio: 61.28%
[rank3]:2025-11-29 00:13:04,824 - INFO - Avg. fwd time: 13.8082 / Avg. bwd time: 36.8230 / Avg. batch time: 478.5695 (ms) / GPU bubble ratio: 15.36%
[rank3]:2025-11-29 00:13:04,829 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.41(0.40)/0.40, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 00:13:04,877 - INFO - Avg. fwd time: 9.8037 / Avg. bwd time: 20.5016 / Avg. batch time: 544.0387 (ms) / GPU bubble ratio: 55.44%
[rank1]:2025-11-29 00:13:04,883 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-29 00:13:04,926 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2925  memory:  9.36GiB(19.71%)  tps: 7,171  tflops: 56.06  mfu: 17.97%
[rank2]:2025-11-29 00:13:04,855 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-29 00:13:04,923 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2925  memory:  6.51GiB(13.70%)  tps: 7,171  tflops: 56.06  mfu: 17.97%
[rank0]:2025-11-29 00:13:04,901 - INFO - Avg. fwd time: 7.8573 / Avg. bwd time: 15.6625 / Avg. batch time: 575.2688 (ms) / GPU bubble ratio: 67.29%
[rank0]:2025-11-29 00:13:04,909 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.49(0.49)/0.49, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-29 00:13:04,937 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2925  memory: 13.29GiB(27.97%)  tps: 7,171  tflops: 56.06  mfu: 17.97%
[rank3]:2025-11-29 00:13:04,935 - INFO -  step: 300  loss:  0.3038  grad_norm:  0.2925  memory: 17.37GiB(36.56%)  tps: 7,171  tflops: 56.06  mfu: 17.97%
[rank1]:2025-11-29 00:13:05,013 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251129_0013_stage1_step300.svg
[rank2]:2025-11-29 00:13:04,999 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251129_0013_stage2_step300.svg
[rank0]:2025-11-29 00:13:05,014 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251129_0013_stage0_step300.svg
[rank3]:2025-11-29 00:13:05,075 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0013_real_step300_rank3.svg
[rank3]:			> Batch Time: 555.72 ms, GPU Bubble Ratio: 73.43%, 58.59%, 65.58%, 30.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  319-0-319ms    | [S0,MB7,F]  319-6-325ms    | [S0,MB4,B]  382-23-406ms   | [S0,MB5,B]  430-23-454ms   | [S0,MB6,B]  490-18-508ms   | [S0,MB7,B]  539-16-555ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  238-8-246ms    | [S1,MB3,B]  289-24-313ms   | [S1,MB6,F]  317-8-326ms    | [S1,MB4,B]  350-24-374ms   | [S1,MB7,F]  380-9-390ms    | [S1,MB5,B]  402-24-426ms   | [S1,MB6,B]  462-24-487ms   | [S1,MB7,B]  515-20-535ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  265-19-284ms   | [S2,MB5,F]  288-7-295ms    | [S2,MB4,B]  326-19-345ms   | [S2,MB6,F]  349-7-356ms    | [S2,MB5,B]  378-19-397ms   | [S2,MB7,F]  400-7-407ms    | [S2,MB6,B]  440-19-459ms   | [S2,MB7,B]  495-16-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  217-42-260ms   | [S3,MB4,F]  263-13-277ms   | [S3,MB4,B]  283-36-320ms   | [S3,MB5,F]  324-17-342ms   | [S3,MB5,B]  348-22-370ms   | [S3,MB6,F]  376-11-388ms   | [S3,MB6,B]  394-40-435ms   | [S3,MB7,F]  438-14-452ms   | [S3,MB7,B]  459-33-493ms  
[rank3]:2025-11-29 00:13:05,119 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251129_0013_stage3_step300.svg
[rank3]:2025-11-29 00:14:58,030 - INFO - Avg. fwd time: 13.8297 / Avg. bwd time: 36.5950 / Avg. batch time: 477.0061 (ms) / GPU bubble ratio: 15.43%
[rank0]:2025-11-29 00:14:58,082 - INFO - Avg. fwd time: 7.8743 / Avg. bwd time: 15.2844 / Avg. batch time: 573.4310 (ms) / GPU bubble ratio: 67.69%
[rank1]:2025-11-29 00:14:58,141 - INFO - Avg. fwd time: 9.8172 / Avg. bwd time: 20.3815 / Avg. batch time: 542.3477 (ms) / GPU bubble ratio: 55.45%
[rank2]:2025-11-29 00:14:58,101 - INFO - Avg. fwd time: 7.5779 / Avg. bwd time: 16.9614 / Avg. batch time: 506.3442 (ms) / GPU bubble ratio: 61.23%
[rank0]:2025-11-29 00:16:47,680 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 00:16:51,977 - INFO - Avg. fwd time: 13.8411 / Avg. bwd time: 36.4129 / Avg. batch time: 475.7274 (ms) / GPU bubble ratio: 15.49%
[rank0]:2025-11-29 00:16:52,028 - INFO - Avg. fwd time: 7.8915 / Avg. bwd time: 14.9065 / Avg. batch time: 571.8394 (ms) / GPU bubble ratio: 68.11%
[rank1]:2025-11-29 00:16:52,088 - INFO - Avg. fwd time: 9.8315 / Avg. bwd time: 20.2594 / Avg. batch time: 540.8987 (ms) / GPU bubble ratio: 55.49%
[rank2]:2025-11-29 00:16:52,048 - INFO - Avg. fwd time: 7.5863 / Avg. bwd time: 16.9023 / Avg. batch time: 504.9798 (ms) / GPU bubble ratio: 61.20%
[rank3]:2025-11-29 00:16:52,285 - INFO -  step: 350  loss:  0.2288  grad_norm:  0.1177  memory: 17.37GiB(36.56%)  tps: 7,207  tflops: 56.34  mfu: 18.06%
[rank1]:2025-11-29 00:16:52,277 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1177  memory:  9.36GiB(19.71%)  tps: 7,207  tflops: 56.34  mfu: 18.06%
[rank2]:2025-11-29 00:16:52,273 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1177  memory:  6.51GiB(13.70%)  tps: 7,207  tflops: 56.34  mfu: 18.06%
[rank0]:2025-11-29 00:16:52,288 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1177  memory: 13.29GiB(27.97%)  tps: 7,207  tflops: 56.34  mfu: 18.06%
[rank3]:2025-11-29 00:18:45,622 - INFO - Avg. fwd time: 13.8524 / Avg. bwd time: 36.2341 / Avg. batch time: 474.4662 (ms) / GPU bubble ratio: 15.55%
[rank2]:2025-11-29 00:18:45,647 - INFO - Avg. fwd time: 7.5937 / Avg. bwd time: 16.8517 / Avg. batch time: 503.6472 (ms) / GPU bubble ratio: 61.17%
[rank1]:2025-11-29 00:18:45,676 - INFO - Avg. fwd time: 9.8431 / Avg. bwd time: 20.1544 / Avg. batch time: 539.4973 (ms) / GPU bubble ratio: 55.52%
[rank0]:2025-11-29 00:18:45,701 - INFO - Avg. fwd time: 7.9063 / Avg. bwd time: 14.5948 / Avg. batch time: 570.3140 (ms) / GPU bubble ratio: 68.44%
[rank0]:2025-11-29 00:20:34,953 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 00:20:39,270 - INFO - Avg. fwd time: 13.8560 / Avg. bwd time: 36.1141 / Avg. batch time: 473.5955 (ms) / GPU bubble ratio: 15.59%
[rank0]:2025-11-29 00:20:39,322 - INFO - Avg. fwd time: 7.9170 / Avg. bwd time: 14.3495 / Avg. batch time: 569.2378 (ms) / GPU bubble ratio: 68.71%
[rank1]:2025-11-29 00:20:39,382 - INFO - Avg. fwd time: 9.8518 / Avg. bwd time: 20.0748 / Avg. batch time: 538.5166 (ms) / GPU bubble ratio: 55.54%
[rank2]:2025-11-29 00:20:39,341 - INFO - Avg. fwd time: 7.5992 / Avg. bwd time: 16.8130 / Avg. batch time: 502.7207 (ms) / GPU bubble ratio: 61.15%
[rank3]:2025-11-29 00:20:39,578 - INFO -  step: 400  loss:  0.2131  grad_norm:  0.0670  memory: 17.37GiB(36.56%)  tps: 7,208  tflops: 56.35  mfu: 18.06%
[rank1]:2025-11-29 00:20:39,569 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0670  memory:  9.36GiB(19.71%)  tps: 7,208  tflops: 56.35  mfu: 18.06%
[rank2]:2025-11-29 00:20:39,565 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0670  memory:  6.51GiB(13.70%)  tps: 7,208  tflops: 56.35  mfu: 18.06%
[rank0]:2025-11-29 00:20:39,580 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0670  memory: 13.29GiB(27.97%)  tps: 7,208  tflops: 56.35  mfu: 18.06%
[rank0]:2025-11-29 00:20:39,634 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251129_0020_stage0_step400.svg
[rank1]:2025-11-29 00:20:39,634 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251129_0020_stage1_step400.svg
[rank2]:2025-11-29 00:20:39,635 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251129_0020_stage2_step400.svg
[rank3]:2025-11-29 00:20:39,724 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0020_real_step400_rank3.svg
[rank3]:			> Batch Time: 552.20 ms, GPU Bubble Ratio: 73.39%, 58.35%, 65.41%, 30.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-173ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  317-0-317ms    | [S0,MB7,F]  317-6-324ms    | [S0,MB4,B]  380-23-404ms   | [S0,MB5,B]  429-23-453ms   | [S0,MB6,B]  488-17-505ms   | [S0,MB7,B]  535-16-552ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-19ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  237-8-246ms    | [S1,MB3,B]  288-24-312ms   | [S1,MB6,F]  315-8-324ms    | [S1,MB4,B]  348-24-372ms   | [S1,MB7,F]  379-9-388ms    | [S1,MB5,B]  401-24-425ms   | [S1,MB6,B]  460-24-484ms   | [S1,MB7,B]  511-20-532ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-8-28ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  86-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  221-6-228ms    | [S2,MB3,B]  263-19-283ms   | [S2,MB5,F]  286-7-293ms    | [S2,MB4,B]  324-19-343ms   | [S2,MB6,F]  346-7-354ms    | [S2,MB5,B]  377-19-396ms   | [S2,MB7,F]  399-7-407ms    | [S2,MB6,B]  437-19-457ms   | [S2,MB7,B]  492-16-508ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  152-41-194ms   | [S3,MB3,F]  197-12-210ms   | [S3,MB3,B]  217-41-258ms   | [S3,MB4,F]  262-13-276ms   | [S3,MB4,B]  282-35-318ms   | [S3,MB5,F]  322-17-340ms   | [S3,MB5,B]  346-22-368ms   | [S3,MB6,F]  375-11-387ms   | [S3,MB6,B]  393-40-433ms   | [S3,MB7,F]  436-14-451ms   | [S3,MB7,B]  457-31-489ms  
[rank3]:2025-11-29 00:20:39,773 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251129_0020_stage3_step400.svg
[rank3]:2025-11-29 00:21:05,803 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-29 00:21:06,036 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-29 00:21:06,013 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-29 00:21:06,054 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-11-29 00:22:33,429 - INFO - Avg. fwd time: 13.8608 / Avg. bwd time: 36.0029 / Avg. batch time: 472.8032 (ms) / GPU bubble ratio: 15.63%
[rank0]:2025-11-29 00:22:33,481 - INFO - Avg. fwd time: 7.9284 / Avg. bwd time: 14.1074 / Avg. batch time: 568.2634 (ms) / GPU bubble ratio: 68.98%
[rank1]:2025-11-29 00:22:33,541 - INFO - Avg. fwd time: 9.8618 / Avg. bwd time: 19.9923 / Avg. batch time: 537.6414 (ms) / GPU bubble ratio: 55.58%
[rank2]:2025-11-29 00:22:33,500 - INFO - Avg. fwd time: 7.6048 / Avg. bwd time: 16.7727 / Avg. batch time: 501.9021 (ms) / GPU bubble ratio: 61.14%
[rank0]:2025-11-29 00:24:23,515 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 00:24:27,999 - INFO - Avg. fwd time: 13.8563 / Avg. bwd time: 35.9292 / Avg. batch time: 472.2243 (ms) / GPU bubble ratio: 15.66%
[rank1]:2025-11-29 00:24:28,055 - INFO - Avg. fwd time: 9.8709 / Avg. bwd time: 19.9195 / Avg. batch time: 536.9570 (ms) / GPU bubble ratio: 55.62%
[rank2]:2025-11-29 00:24:28,025 - INFO - Avg. fwd time: 7.6096 / Avg. bwd time: 16.7367 / Avg. batch time: 501.2709 (ms) / GPU bubble ratio: 61.14%
[rank0]:2025-11-29 00:24:28,081 - INFO - Avg. fwd time: 7.9379 / Avg. bwd time: 13.8804 / Avg. batch time: 567.4915 (ms) / GPU bubble ratio: 69.24%
[rank0]:2025-11-29 00:24:28,116 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0828  memory: 13.29GiB(27.97%)  tps: 7,169  tflops: 56.04  mfu: 17.96%
[rank1]:2025-11-29 00:24:28,106 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0828  memory:  9.36GiB(19.71%)  tps: 7,169  tflops: 56.04  mfu: 17.96%
[rank2]:2025-11-29 00:24:28,102 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0828  memory:  6.51GiB(13.70%)  tps: 7,169  tflops: 56.04  mfu: 17.96%
[rank3]:2025-11-29 00:24:28,115 - INFO -  step: 450  loss:  0.2259  grad_norm:  0.0828  memory: 17.37GiB(36.56%)  tps: 7,169  tflops: 56.05  mfu: 17.96%
[rank3]:2025-11-29 00:26:21,649 - INFO - Avg. fwd time: 13.8574 / Avg. bwd time: 35.8485 / Avg. batch time: 471.6282 (ms) / GPU bubble ratio: 15.69%
[rank0]:2025-11-29 00:26:21,701 - INFO - Avg. fwd time: 7.9453 / Avg. bwd time: 13.7086 / Avg. batch time: 566.7429 (ms) / GPU bubble ratio: 69.43%
[rank2]:2025-11-29 00:26:21,719 - INFO - Avg. fwd time: 7.6135 / Avg. bwd time: 16.7085 / Avg. batch time: 500.6323 (ms) / GPU bubble ratio: 61.13%
[rank1]:2025-11-29 00:26:21,758 - INFO - Avg. fwd time: 9.8781 / Avg. bwd time: 19.8634 / Avg. batch time: 536.2777 (ms) / GPU bubble ratio: 55.63%
[rank0]:2025-11-29 00:28:12,021 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 00:28:16,311 - INFO - Avg. fwd time: 13.8537 / Avg. bwd time: 35.7946 / Avg. batch time: 471.2082 (ms) / GPU bubble ratio: 15.71%
[rank0]:2025-11-29 00:28:16,364 - INFO - Avg. fwd time: 7.9529 / Avg. bwd time: 13.5363 / Avg. batch time: 566.1597 (ms) / GPU bubble ratio: 69.64%
[rank2]:2025-11-29 00:28:16,382 - INFO - Avg. fwd time: 7.6171 / Avg. bwd time: 16.6789 / Avg. batch time: 500.1678 (ms) / GPU bubble ratio: 61.14%
[rank1]:2025-11-29 00:28:16,423 - INFO - Avg. fwd time: 9.8855 / Avg. bwd time: 19.8039 / Avg. batch time: 535.7675 (ms) / GPU bubble ratio: 55.67%
[rank3]:2025-11-29 00:28:16,615 - INFO -  step: 500  loss:  0.2179  grad_norm:  0.0907  memory: 17.37GiB(36.56%)  tps: 7,170  tflops: 56.05  mfu: 17.97%
[rank2]:2025-11-29 00:28:16,602 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0907  memory:  6.51GiB(13.70%)  tps: 7,170  tflops: 56.05  mfu: 17.97%
[rank0]:2025-11-29 00:28:16,617 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0907  memory: 13.29GiB(27.97%)  tps: 7,170  tflops: 56.05  mfu: 17.97%
[rank0]:2025-11-29 00:28:16,664 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251129_0028_stage0_step500.svg
[rank1]:2025-11-29 00:28:16,606 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0907  memory:  9.36GiB(19.71%)  tps: 7,170  tflops: 56.05  mfu: 17.97%
[rank1]:2025-11-29 00:28:16,664 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251129_0028_stage1_step500.svg
[rank2]:2025-11-29 00:28:16,664 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251129_0028_stage2_step500.svg
[rank3]:2025-11-29 00:28:16,752 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0028_real_step500_rank3.svg
[rank3]:			> Batch Time: 558.17 ms, GPU Bubble Ratio: 73.49%, 58.70%, 65.77%, 30.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-246ms    | [S0,MB3,B]  318-0-318ms    | [S0,MB7,F]  318-6-325ms    | [S0,MB4,B]  381-23-405ms   | [S0,MB5,B]  430-23-454ms   | [S0,MB6,B]  491-18-509ms   | [S0,MB7,B]  541-16-558ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  238-8-246ms    | [S1,MB3,B]  289-24-313ms   | [S1,MB6,F]  317-9-326ms    | [S1,MB4,B]  349-24-373ms   | [S1,MB7,F]  379-9-388ms    | [S1,MB5,B]  402-24-426ms   | [S1,MB6,B]  463-24-487ms   | [S1,MB7,B]  517-20-537ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  265-19-284ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB4,B]  325-19-344ms   | [S2,MB6,F]  347-7-354ms    | [S2,MB5,B]  377-19-397ms   | [S2,MB7,F]  400-7-407ms    | [S2,MB6,B]  440-19-460ms   | [S2,MB7,B]  498-16-514ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  218-42-260ms   | [S3,MB4,F]  263-13-277ms   | [S3,MB4,B]  283-36-319ms   | [S3,MB5,F]  323-17-341ms   | [S3,MB5,B]  348-22-370ms   | [S3,MB6,F]  376-11-388ms   | [S3,MB6,B]  394-41-435ms   | [S3,MB7,F]  439-14-453ms   | [S3,MB7,B]  460-35-495ms  
[rank3]:2025-11-29 00:28:16,795 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251129_0028_stage3_step500.svg
[rank3]:2025-11-29 00:30:09,815 - INFO - Avg. fwd time: 13.8569 / Avg. bwd time: 35.6963 / Avg. batch time: 470.4808 (ms) / GPU bubble ratio: 15.74%
[rank2]:2025-11-29 00:30:09,842 - INFO - Avg. fwd time: 7.6209 / Avg. bwd time: 16.6525 / Avg. batch time: 499.4272 (ms) / GPU bubble ratio: 61.12%
[rank0]:2025-11-29 00:30:09,900 - INFO - Avg. fwd time: 7.9596 / Avg. bwd time: 13.3911 / Avg. batch time: 565.3205 (ms) / GPU bubble ratio: 69.79%
[rank1]:2025-11-29 00:30:09,873 - INFO - Avg. fwd time: 9.8926 / Avg. bwd time: 19.7518 / Avg. batch time: 534.9924 (ms) / GPU bubble ratio: 55.67%
[rank0]:2025-11-29 00:31:59,078 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 00:32:03,385 - INFO - Avg. fwd time: 13.8568 / Avg. bwd time: 35.6346 / Avg. batch time: 470.0101 (ms) / GPU bubble ratio: 15.76%
[rank0]:2025-11-29 00:32:03,437 - INFO - Avg. fwd time: 7.9651 / Avg. bwd time: 13.2711 / Avg. batch time: 564.7379 (ms) / GPU bubble ratio: 69.92%
[rank1]:2025-11-29 00:32:03,497 - INFO - Avg. fwd time: 9.8987 / Avg. bwd time: 19.7107 / Avg. batch time: 534.4600 (ms) / GPU bubble ratio: 55.68%
[rank2]:2025-11-29 00:32:03,457 - INFO - Avg. fwd time: 7.6238 / Avg. bwd time: 16.6315 / Avg. batch time: 498.9245 (ms) / GPU bubble ratio: 61.11%
[rank0]:2025-11-29 00:32:03,692 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0719  memory: 13.29GiB(27.97%)  tps: 7,215  tflops: 56.41  mfu: 18.08%
[rank1]:2025-11-29 00:32:03,681 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0719  memory:  9.36GiB(19.71%)  tps: 7,215  tflops: 56.41  mfu: 18.08%
[rank3]:2025-11-29 00:32:03,690 - INFO -  step: 550  loss:  0.2243  grad_norm:  0.0719  memory: 17.37GiB(36.56%)  tps: 7,215  tflops: 56.41  mfu: 18.08%
[rank2]:2025-11-29 00:32:03,677 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0719  memory:  6.51GiB(13.70%)  tps: 7,215  tflops: 56.41  mfu: 18.08%
[rank3]:2025-11-29 00:33:57,712 - INFO - Avg. fwd time: 13.8520 / Avg. bwd time: 35.5873 / Avg. batch time: 469.6242 (ms) / GPU bubble ratio: 15.78%
[rank2]:2025-11-29 00:33:57,786 - INFO - Avg. fwd time: 7.6266 / Avg. bwd time: 16.6089 / Avg. batch time: 498.5044 (ms) / GPU bubble ratio: 61.11%
[rank0]:2025-11-29 00:33:57,764 - INFO - Avg. fwd time: 7.9710 / Avg. bwd time: 13.1334 / Avg. batch time: 564.2316 (ms) / GPU bubble ratio: 70.08%
[rank1]:2025-11-29 00:33:57,826 - INFO - Avg. fwd time: 9.9055 / Avg. bwd time: 19.6662 / Avg. batch time: 534.0064 (ms) / GPU bubble ratio: 55.70%
[rank0]:2025-11-29 00:35:47,759 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 00:35:52,328 - INFO - Avg. fwd time: 13.8483 / Avg. bwd time: 35.5490 / Avg. batch time: 469.3131 (ms) / GPU bubble ratio: 15.80%
[rank2]:2025-11-29 00:35:52,355 - INFO - Avg. fwd time: 7.6295 / Avg. bwd time: 16.5878 / Avg. batch time: 498.1631 (ms) / GPU bubble ratio: 61.11%
[rank1]:2025-11-29 00:35:52,386 - INFO - Avg. fwd time: 9.9126 / Avg. bwd time: 19.6255 / Avg. batch time: 533.6345 (ms) / GPU bubble ratio: 55.72%
[rank2]:2025-11-29 00:35:52,436 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0969  memory:  6.51GiB(13.70%)  tps: 7,162  tflops: 55.99  mfu: 17.95%
[rank0]:2025-11-29 00:35:52,414 - INFO - Avg. fwd time: 7.9767 / Avg. bwd time: 13.0155 / Avg. batch time: 563.8127 (ms) / GPU bubble ratio: 70.21%
[rank0]:2025-11-29 00:35:52,450 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0969  memory: 13.29GiB(27.97%)  tps: 7,162  tflops: 55.99  mfu: 17.95%
[rank1]:2025-11-29 00:35:52,439 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0969  memory:  9.36GiB(19.71%)  tps: 7,162  tflops: 55.99  mfu: 17.95%
[rank1]:2025-11-29 00:35:52,498 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251129_0035_stage1_step600.svg
[rank3]:2025-11-29 00:35:52,448 - INFO -  step: 600  loss:  0.2210  grad_norm:  0.0969  memory: 17.37GiB(36.56%)  tps: 7,162  tflops: 55.99  mfu: 17.95%
[rank2]:2025-11-29 00:35:52,514 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251129_0035_stage2_step600.svg
[rank0]:2025-11-29 00:35:52,512 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251129_0035_stage0_step600.svg
[rank3]:2025-11-29 00:35:52,583 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0035_real_step600_rank3.svg
[rank3]:			> Batch Time: 555.17 ms, GPU Bubble Ratio: 72.73%, 58.49%, 65.67%, 30.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  166-0-166ms    | [S0,MB5,F]  166-6-173ms    | [S0,MB2,B]  238-0-238ms    | [S0,MB6,F]  238-6-245ms    | [S0,MB3,B]  317-0-317ms    | [S0,MB7,F]  317-6-323ms    | [S0,MB4,B]  379-23-403ms   | [S0,MB5,B]  427-23-451ms   | [S0,MB6,B]  488-22-511ms   | [S0,MB7,B]  538-16-555ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  101-11-112ms   | [S1,MB1,B]  150-10-161ms   | [S1,MB4,F]  165-8-173ms    | [S1,MB2,B]  222-10-233ms   | [S1,MB5,F]  237-8-245ms    | [S1,MB3,B]  288-24-312ms   | [S1,MB6,F]  315-9-324ms    | [S1,MB4,B]  348-24-372ms   | [S1,MB7,F]  378-9-387ms    | [S1,MB5,B]  399-24-424ms   | [S1,MB6,B]  461-24-485ms   | [S1,MB7,B]  515-20-535ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  73-8-82ms      | [S2,MB2,F]  85-8-94ms      | [S2,MB1,B]  137-8-145ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  198-19-217ms   | [S2,MB4,F]  221-7-228ms    | [S2,MB3,B]  263-19-282ms   | [S2,MB5,F]  286-7-293ms    | [S2,MB4,B]  323-19-342ms   | [S2,MB6,F]  346-7-353ms    | [S2,MB5,B]  375-19-394ms   | [S2,MB7,F]  398-7-405ms    | [S2,MB6,B]  438-19-457ms   | [S2,MB7,B]  495-16-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-68ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-146ms   | [S3,MB2,B]  152-41-193ms   | [S3,MB3,F]  197-13-210ms   | [S3,MB3,B]  216-41-258ms   | [S3,MB4,F]  262-13-276ms   | [S3,MB4,B]  282-35-318ms   | [S3,MB5,F]  322-17-340ms   | [S3,MB5,B]  345-22-368ms   | [S3,MB6,F]  374-11-385ms   | [S3,MB6,B]  392-41-433ms   | [S3,MB7,F]  437-14-451ms   | [S3,MB7,B]  457-35-493ms  
[rank3]:2025-11-29 00:35:52,628 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251129_0035_stage3_step600.svg
[rank3]:2025-11-29 00:37:45,776 - INFO - Avg. fwd time: 13.8481 / Avg. bwd time: 35.4918 / Avg. batch time: 468.8734 (ms) / GPU bubble ratio: 15.82%
[rank2]:2025-11-29 00:37:45,847 - INFO - Avg. fwd time: 7.6315 / Avg. bwd time: 16.5715 / Avg. batch time: 497.7155 (ms) / GPU bubble ratio: 61.10%
[rank0]:2025-11-29 00:37:45,828 - INFO - Avg. fwd time: 7.9805 / Avg. bwd time: 12.9158 / Avg. batch time: 563.3014 (ms) / GPU bubble ratio: 70.32%
[rank1]:2025-11-29 00:37:45,888 - INFO - Avg. fwd time: 9.9182 / Avg. bwd time: 19.5942 / Avg. batch time: 533.1638 (ms) / GPU bubble ratio: 55.72%
[rank0]:2025-11-29 00:39:34,708 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-29 00:39:38,922 - INFO - Avg. fwd time: 13.8541 / Avg. bwd time: 35.4230 / Avg. batch time: 468.3955 (ms) / GPU bubble ratio: 15.84%
[rank0]:2025-11-29 00:39:38,973 - INFO - Avg. fwd time: 7.9854 / Avg. bwd time: 12.8148 / Avg. batch time: 562.7327 (ms) / GPU bubble ratio: 70.43%
[rank2]:2025-11-29 00:39:38,994 - INFO - Avg. fwd time: 7.6340 / Avg. bwd time: 16.5535 / Avg. batch time: 497.2102 (ms) / GPU bubble ratio: 61.08%
[rank1]:2025-11-29 00:39:39,034 - INFO - Avg. fwd time: 9.9251 / Avg. bwd time: 19.5604 / Avg. batch time: 532.6366 (ms) / GPU bubble ratio: 55.71%
[rank1]:2025-11-29 00:39:39,206 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0726  memory:  9.36GiB(19.71%)  tps: 7,225  tflops: 56.48  mfu: 18.10%
[rank3]:2025-11-29 00:39:39,215 - INFO -  step: 650  loss:  0.2317  grad_norm:  0.0726  memory: 17.37GiB(36.56%)  tps: 7,225  tflops: 56.48  mfu: 18.10%
[rank2]:2025-11-29 00:39:39,203 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0726  memory:  6.51GiB(13.70%)  tps: 7,225  tflops: 56.48  mfu: 18.10%
[rank0]:2025-11-29 00:39:39,218 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0726  memory: 13.29GiB(27.97%)  tps: 7,225  tflops: 56.48  mfu: 18.10%
[rank2]:2025-11-29 00:41:32,414 - INFO - Avg. fwd time: 7.6361 / Avg. bwd time: 16.5373 / Avg. batch time: 496.7259 (ms) / GPU bubble ratio: 61.07%
[rank1]:2025-11-29 00:41:32,446 - INFO - Avg. fwd time: 9.9305 / Avg. bwd time: 19.5292 / Avg. batch time: 532.1327 (ms) / GPU bubble ratio: 55.71%
[rank3]:2025-11-29 00:41:32,385 - INFO - Avg. fwd time: 13.8574 / Avg. bwd time: 35.3600 / Avg. batch time: 467.9350 (ms) / GPU bubble ratio: 15.86%
[rank0]:2025-11-29 00:41:32,475 - INFO - Avg. fwd time: 7.9894 / Avg. bwd time: 12.7161 / Avg. batch time: 562.1917 (ms) / GPU bubble ratio: 70.54%
[rank0]:2025-11-29 00:43:21,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 00:43:25,499 - INFO - Avg. fwd time: 13.8596 / Avg. bwd time: 35.3099 / Avg. batch time: 467.5708 (ms) / GPU bubble ratio: 15.87%
[rank2]:2025-11-29 00:43:25,570 - INFO - Avg. fwd time: 7.6381 / Avg. bwd time: 16.5242 / Avg. batch time: 496.3417 (ms) / GPU bubble ratio: 61.06%
[rank0]:2025-11-29 00:43:25,549 - INFO - Avg. fwd time: 7.9928 / Avg. bwd time: 12.6409 / Avg. batch time: 561.7584 (ms) / GPU bubble ratio: 70.62%
[rank1]:2025-11-29 00:43:25,609 - INFO - Avg. fwd time: 9.9357 / Avg. bwd time: 19.5041 / Avg. batch time: 531.7301 (ms) / GPU bubble ratio: 55.71%
[rank1]:2025-11-29 00:43:25,788 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0777  memory:  9.36GiB(19.71%)  tps: 7,231  tflops: 56.53  mfu: 18.12%
[rank3]:2025-11-29 00:43:25,797 - INFO -  step: 700  loss:  0.1921  grad_norm:  0.0777  memory: 17.37GiB(36.56%)  tps: 7,231  tflops: 56.53  mfu: 18.12%
[rank2]:2025-11-29 00:43:25,784 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0777  memory:  6.51GiB(13.70%)  tps: 7,231  tflops: 56.53  mfu: 18.12%
[rank2]:2025-11-29 00:43:25,850 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251129_0043_stage2_step700.svg
[rank0]:2025-11-29 00:43:25,799 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0777  memory: 13.29GiB(27.97%)  tps: 7,231  tflops: 56.53  mfu: 18.12%
[rank0]:2025-11-29 00:43:25,849 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251129_0043_stage0_step700.svg
[rank1]:2025-11-29 00:43:25,849 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251129_0043_stage1_step700.svg
[rank3]:2025-11-29 00:43:25,936 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0043_real_step700_rank3.svg
[rank3]:			> Batch Time: 554.19 ms, GPU Bubble Ratio: 72.75%, 58.37%, 65.55%, 30.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  103-0-103ms    | [S0,MB4,F]  103-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  239-0-239ms    | [S0,MB6,F]  239-6-246ms    | [S0,MB3,B]  317-0-317ms    | [S0,MB7,F]  317-6-324ms    | [S0,MB4,B]  380-23-404ms   | [S0,MB5,B]  428-23-451ms   | [S0,MB6,B]  489-21-510ms   | [S0,MB7,B]  537-16-554ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  87-10-98ms     | [S1,MB3,F]  102-11-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  165-8-174ms    | [S1,MB2,B]  223-10-234ms   | [S1,MB5,F]  238-8-246ms    | [S1,MB3,B]  288-24-312ms   | [S1,MB6,F]  316-9-325ms    | [S1,MB4,B]  348-24-372ms   | [S1,MB7,F]  378-9-388ms    | [S1,MB5,B]  400-24-425ms   | [S1,MB6,B]  461-24-485ms   | [S1,MB7,B]  514-20-534ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  149-6-156ms    | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  264-19-283ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB4,B]  324-19-343ms   | [S2,MB6,F]  346-7-353ms    | [S2,MB5,B]  376-19-395ms   | [S2,MB7,F]  399-7-406ms    | [S2,MB6,B]  439-19-458ms   | [S2,MB7,B]  494-16-510ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  135-11-147ms   | [S3,MB2,B]  153-41-194ms   | [S3,MB3,F]  197-13-211ms   | [S3,MB3,B]  217-41-259ms   | [S3,MB4,F]  262-13-276ms   | [S3,MB4,B]  282-36-319ms   | [S3,MB5,F]  322-17-340ms   | [S3,MB5,B]  346-22-368ms   | [S3,MB6,F]  374-11-386ms   | [S3,MB6,B]  392-40-433ms   | [S3,MB7,F]  437-14-451ms   | [S3,MB7,B]  457-34-491ms  
[rank3]:2025-11-29 00:43:25,982 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251129_0043_stage3_step700.svg
[rank0]:2025-11-29 00:45:19,539 - INFO - Avg. fwd time: 7.9964 / Avg. bwd time: 12.5653 / Avg. batch time: 561.4124 (ms) / GPU bubble ratio: 70.70%
[rank3]:2025-11-29 00:45:19,487 - INFO - Avg. fwd time: 13.8607 / Avg. bwd time: 35.2701 / Avg. batch time: 467.2816 (ms) / GPU bubble ratio: 15.89%
[rank2]:2025-11-29 00:45:19,557 - INFO - Avg. fwd time: 7.6399 / Avg. bwd time: 16.5100 / Avg. batch time: 496.0485 (ms) / GPU bubble ratio: 61.05%
[rank1]:2025-11-29 00:45:19,598 - INFO - Avg. fwd time: 9.9400 / Avg. bwd time: 19.4767 / Avg. batch time: 531.4169 (ms) / GPU bubble ratio: 55.72%
[rank0]:2025-11-29 00:47:09,811 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-29 00:47:14,355 - INFO - Avg. fwd time: 7.6416 / Avg. bwd time: 16.4967 / Avg. batch time: 495.8915 (ms) / GPU bubble ratio: 61.06%
[rank3]:2025-11-29 00:47:14,326 - INFO - Avg. fwd time: 13.8595 / Avg. bwd time: 35.2520 / Avg. batch time: 467.1444 (ms) / GPU bubble ratio: 15.90%
[rank1]:2025-11-29 00:47:14,388 - INFO - Avg. fwd time: 9.9438 / Avg. bwd time: 19.4505 / Avg. batch time: 531.2397 (ms) / GPU bubble ratio: 55.73%
[rank2]:2025-11-29 00:47:14,439 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0888  memory:  6.51GiB(13.70%)  tps: 7,165  tflops: 56.02  mfu: 17.95%
[rank3]:2025-11-29 00:47:14,451 - INFO -  step: 750  loss:  0.2306  grad_norm:  0.0888  memory: 17.37GiB(36.56%)  tps: 7,165  tflops: 56.02  mfu: 17.95%
[rank0]:2025-11-29 00:47:14,417 - INFO - Avg. fwd time: 8.0000 / Avg. bwd time: 12.4936 / Avg. batch time: 561.2063 (ms) / GPU bubble ratio: 70.79%
[rank0]:2025-11-29 00:47:14,453 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0888  memory: 13.29GiB(27.97%)  tps: 7,165  tflops: 56.02  mfu: 17.95%
[rank1]:2025-11-29 00:47:14,442 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0888  memory:  9.36GiB(19.71%)  tps: 7,165  tflops: 56.02  mfu: 17.95%
[rank3]:2025-11-29 00:49:08,394 - INFO - Avg. fwd time: 13.8612 / Avg. bwd time: 35.2323 / Avg. batch time: 467.0140 (ms) / GPU bubble ratio: 15.90%
[rank0]:2025-11-29 00:49:08,446 - INFO - Avg. fwd time: 8.0027 / Avg. bwd time: 12.4276 / Avg. batch time: 561.0164 (ms) / GPU bubble ratio: 70.87%
[rank2]:2025-11-29 00:49:08,466 - INFO - Avg. fwd time: 7.6428 / Avg. bwd time: 16.4859 / Avg. batch time: 495.7444 (ms) / GPU bubble ratio: 61.06%
[rank1]:2025-11-29 00:49:08,507 - INFO - Avg. fwd time: 9.9462 / Avg. bwd time: 19.4293 / Avg. batch time: 531.0758 (ms) / GPU bubble ratio: 55.75%
[rank0]:2025-11-29 00:50:57,423 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-29 00:51:01,708 - INFO - Avg. fwd time: 13.8651 / Avg. bwd time: 35.1841 / Avg. batch time: 466.6740 (ms) / GPU bubble ratio: 15.92%
[rank0]:2025-11-29 00:51:01,760 - INFO - Avg. fwd time: 8.0060 / Avg. bwd time: 12.3630 / Avg. batch time: 560.6186 (ms) / GPU bubble ratio: 70.93%
[rank2]:2025-11-29 00:51:01,780 - INFO - Avg. fwd time: 7.6443 / Avg. bwd time: 16.4741 / Avg. batch time: 495.3861 (ms) / GPU bubble ratio: 61.05%
[rank1]:2025-11-29 00:51:01,823 - INFO - Avg. fwd time: 9.9492 / Avg. bwd time: 19.4067 / Avg. batch time: 530.7038 (ms) / GPU bubble ratio: 55.75%
[rank0]:2025-11-29 00:51:02,004 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0762  memory: 13.29GiB(27.97%)  tps: 7,200  tflops: 56.29  mfu: 18.04%
[rank0]:2025-11-29 00:51:02,004 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0762  tps: 7,491  tflops: 58.56  mfu: 17.11%
[rank0]:2025-11-29 00:51:02,004 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-29 00:51:02,005 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-29 00:51:01,994 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0762  memory:  9.36GiB(19.71%)  tps: 7,200  tflops: 56.29  mfu: 18.04%
[rank1]:2025-11-29 00:51:01,994 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0762  tps: 7,491  tflops: 58.56  mfu: 17.11%
[rank1]:2025-11-29 00:51:01,994 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-29 00:51:01,995 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-29 00:51:02,002 - INFO -  step: 800  loss:  0.2345  grad_norm:  0.0762  memory: 17.37GiB(36.56%)  tps: 7,200  tflops: 56.29  mfu: 18.04%
[rank3]:2025-11-29 00:51:02,003 - INFO -  final step: 800  loss:  0.2345  grad_norm:  0.0762  tps: 7,496  tflops: 58.60  mfu: 17.25%
[rank3]:2025-11-29 00:51:02,003 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-29 00:51:02,004 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-29 00:51:01,990 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0762  memory:  6.51GiB(13.70%)  tps: 7,200  tflops: 56.29  mfu: 18.04%
[rank2]:2025-11-29 00:51:01,990 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0762  tps: 7,491  tflops: 58.56  mfu: 17.11%
[rank2]:2025-11-29 00:51:01,990 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-29 00:51:01,991 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-29 00:51:03,997 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-29 00:51:04,070 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank0/251129_0051_stage0_final800.svg
[rank1]:2025-11-29 00:51:04,070 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank1/251129_0051_stage1_final800.svg
[rank3]:2025-11-29 00:51:04,154 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0051_real_final800_rank3.svg
[rank3]:			> Batch Time: 554.22 ms, GPU Bubble Ratio: 73.32%, 58.43%, 65.53%, 29.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  104-0-104ms    | [S0,MB4,F]  104-8-112ms    | [S0,MB1,B]  167-0-167ms    | [S0,MB5,F]  167-6-174ms    | [S0,MB2,B]  240-0-240ms    | [S0,MB6,F]  240-6-247ms    | [S0,MB3,B]  319-0-319ms    | [S0,MB7,F]  319-6-326ms    | [S0,MB4,B]  382-23-405ms   | [S0,MB5,B]  430-23-454ms   | [S0,MB6,B]  489-18-508ms   | [S0,MB7,B]  537-16-554ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-11-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB0,B]  88-10-98ms     | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  151-10-162ms   | [S1,MB4,F]  166-8-174ms    | [S1,MB2,B]  224-10-235ms   | [S1,MB5,F]  238-8-247ms    | [S1,MB3,B]  290-24-314ms   | [S1,MB6,F]  317-9-326ms    | [S1,MB4,B]  350-24-374ms   | [S1,MB7,F]  380-9-389ms    | [S1,MB5,B]  402-24-427ms   | [S1,MB6,B]  462-24-486ms   | [S1,MB7,B]  513-20-534ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB0,B]  74-8-82ms      | [S2,MB2,F]  86-8-95ms      | [S2,MB1,B]  137-8-146ms    | [S2,MB3,F]  150-6-157ms    | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  222-7-229ms    | [S2,MB3,B]  265-19-284ms   | [S2,MB5,F]  288-7-295ms    | [S2,MB4,B]  326-19-345ms   | [S2,MB6,F]  348-7-355ms    | [S2,MB5,B]  378-19-397ms   | [S2,MB7,F]  401-7-408ms    | [S2,MB6,B]  439-19-458ms   | [S2,MB7,B]  494-16-510ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB0,B]  48-20-69ms     | [S3,MB1,F]  72-13-86ms     | [S3,MB1,B]  92-40-132ms    | [S3,MB2,F]  136-11-147ms   | [S3,MB2,B]  153-41-195ms   | [S3,MB3,F]  198-13-212ms   | [S3,MB3,B]  218-42-260ms   | [S3,MB4,F]  264-13-278ms   | [S3,MB4,B]  283-36-320ms   | [S3,MB5,F]  324-17-342ms   | [S3,MB5,B]  348-22-371ms   | [S3,MB6,F]  377-11-389ms   | [S3,MB6,B]  394-40-435ms   | [S3,MB7,F]  438-15-453ms   | [S3,MB7,B]  459-33-492ms  
[rank2]:2025-11-29 00:51:04,071 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank2/251129_0051_stage2_final800.svg
[rank1]:2025-11-29 00:51:04,217 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251129_0051_rank1_stage1.svg
[rank1]:	> Counts Sum: 272160, Total Sum: 2102400 (12.95%), Ratio(%) per element: [12.84, 12.84, 12.84, 13.52, 12.32, 13.18, 13.18, 12.84, 12.67, 13.18, 12.84, 12.5, 13.01, 12.84, 13.18, 12.67, 12.84, 12.84, 13.01, 13.35, 13.01, 12.84, 12.84, 12.84, 13.01, 13.52, 12.67, 13.01, 12.84, 13.52, 13.01, 13.18, 13.18, 12.84, 12.84, 12.5, 13.18, 12.67, 13.18, 12.67, 12.67, 13.01, 13.01, 13.18, 12.67]
[rank2]:2025-11-29 00:51:04,226 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251129_0051_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.01, 12.67, 13.35, 13.35, 12.67, 12.67, 13.35, 13.01, 12.67, 13.01, 13.01, 12.84, 12.5, 13.01, 13.01, 12.67, 13.01, 12.84, 13.35, 13.01, 13.69, 12.5, 12.84, 13.18, 12.84, 13.35, 12.84, 13.01, 12.67, 13.01, 13.01, 13.01, 12.84, 13.01, 12.67, 12.5]
[rank0]:2025-11-29 00:51:04,222 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251129_0051_rank0_stage0.svg
[rank0]:	> Counts Sum: 321200, Total Sum: 1728640 (18.58%), Ratio(%) per element: [21.91, 22.6, 21.23, 22.6, 21.91, 19.69, 20.54, 20.89, 20.54, 21.91, 20.89, 20.03, 19.86, 20.71, 20.2, 19.34, 18.83, 19.52, 19.52, 19.17, 19.17, 17.63, 17.12, 17.46, 16.95, 17.97, 16.6, 16.78, 15.23, 16.43, 15.23, 15.23, 15.41, 15.58, 13.69, 15.58, 13.35]
[rank3]:2025-11-29 00:51:04,289 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/pipeline_schedule/251129_0051_thry_final800_rank3.svg
[rank3]:			> Batch Time: 326.74 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB0,B]  99-19-118ms    | [S0,MB4,F]  118-9-128ms    | [S0,MB1,B]  128-19-148ms   | [S0,MB5,F]  148-9-158ms    | [S0,MB2,B]  158-19-178ms   | [S0,MB6,F]  178-9-188ms    | [S0,MB3,B]  188-19-207ms   | [S0,MB7,F]  207-9-217ms    | [S0,MB4,B]  217-19-237ms   | [S0,MB5,B]  247-19-267ms   | [S0,MB6,B]  277-19-297ms   | [S0,MB7,B]  306-19-326ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB0,B]  79-19-99ms     | [S1,MB3,F]  99-9-108ms     | [S1,MB1,B]  108-19-128ms   | [S1,MB4,F]  128-9-138ms    | [S1,MB2,B]  138-19-158ms   | [S1,MB5,F]  158-9-168ms    | [S1,MB3,B]  168-19-188ms   | [S1,MB6,F]  188-9-198ms    | [S1,MB4,B]  198-19-217ms   | [S1,MB7,F]  217-9-227ms    | [S1,MB5,B]  227-19-247ms   | [S1,MB6,B]  257-19-277ms   | [S1,MB7,B]  287-19-306ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB0,B]  59-19-79ms     | [S2,MB2,F]  79-9-89ms      | [S2,MB1,B]  89-19-108ms    | [S2,MB3,F]  108-9-118ms    | [S2,MB2,B]  118-19-138ms   | [S2,MB4,F]  138-9-148ms    | [S2,MB3,B]  148-19-168ms   | [S2,MB5,F]  168-9-178ms    | [S2,MB4,B]  178-19-198ms   | [S2,MB6,F]  198-9-207ms    | [S2,MB5,B]  207-19-227ms   | [S2,MB7,F]  227-9-237ms    | [S2,MB6,B]  237-19-257ms   | [S2,MB7,B]  267-19-287ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB0,B]  39-19-59ms     | [S3,MB1,F]  59-9-69ms      | [S3,MB1,B]  69-19-89ms     | [S3,MB2,F]  89-9-99ms      | [S3,MB2,B]  99-19-118ms    | [S3,MB3,F]  118-9-128ms    | [S3,MB3,B]  128-19-148ms   | [S3,MB4,F]  148-9-158ms    | [S3,MB4,B]  158-19-178ms   | [S3,MB5,F]  178-9-188ms    | [S3,MB5,B]  188-19-207ms   | [S3,MB6,F]  207-9-217ms    | [S3,MB6,B]  217-19-237ms   | [S3,MB7,F]  237-9-247ms    | [S3,MB7,B]  247-19-267ms  
[rank3]:2025-11-29 00:51:04,339 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_ratio_history/rank3/251129_0051_stage3_final800.svg
[rank3]:2025-11-29 00:51:04,478 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/frozen_params_histogram/251129_0051_rank3_stage3.svg
[rank3]:	> Counts Sum: 396240, Total Sum: 1354880 (29.25%), Ratio(%) per element: [29.28, 30.13, 29.28, 28.93, 29.28, 29.96, 28.76, 28.42, 29.96, 28.59, 29.62, 28.25, 30.82, 28.59, 29.28, 29.1, 29.62, 28.93, 28.25, 29.45, 31.16, 29.79, 29.1, 29.1, 28.25, 29.1, 29.28, 28.59, 29.1]
[rank0]:2025-11-29 00:51:06,000 - INFO - Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251129_0051_stage0.svg
[rank0]:2025-11-29 00:51:06,002 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-29 00:51:06,010 - INFO - Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251129_0051_stage1.svg
[rank1]:2025-11-29 00:51:06,013 - INFO - Destroying the purge thread.
[rank2]:2025-11-29 00:51:06,064 - INFO - Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251129_0051_stage2.svg
[rank2]:2025-11-29 00:51:06,067 - INFO - Destroying the purge thread.
[rank3]:2025-11-29 00:51:06,342 - INFO - Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1/afr_time_plot/251129_0051_stage3.svg
[rank3]:2025-11-29 00:51:06,346 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-11-29 00:51:06,507 - INFO - Process group destroyed
[rank2]:2025-11-29 00:51:06,507 - INFO - Process group destroyed
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.37123
[rank3]:wandb:               final/avg_loss 0.23445
[rank3]:wandb:             final/avg_mfu(%) 17.24916
[rank3]:wandb:             final/avg_tflops 58.60248
[rank3]:wandb:    final/avg_throughput(tps) 7496.28132
[rank3]:wandb:              final/grad_norm 0.07616
[rank3]:wandb:               final/max_loss 0.23445
[rank3]:wandb:                    grad_norm 0.07616
[rank3]:wandb: loss_metrics/global_avg_loss 0.23445
[rank3]:wandb: loss_metrics/global_max_loss 0.23445
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_1F1B_fullrand7_mfr0.3_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ekqqy9mu
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.3_42_dm1/20251128-2349/wandb/run-20251128_234905-ekqqy9mu/logs
[rank3]:2025-11-29 00:51:07,514 - INFO - Process group destroyed
[rank0]:2025-11-29 00:51:08,003 - INFO - Training completed
[rank0]:2025-11-29 00:51:08,003 - INFO - Destroying the purge thread.
[rank0]:2025-11-29 00:51:08,495 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'layers.1', 'tok_embeddings', 'layers.3'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.8', 'layers.5', 'layers.6'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.13', 'norm', 'layers.15', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_fullrand7/config_1128.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "1116: TimelyFreeze (fullrand7) configuration experiment on different max_freeze_ratio values.
[rank3]:1128: fixed a bug in freezing ratio calculation (should be based on total layers, not unfrozen layers), dp solver -> qp solver"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1128_1F1B_fullrand7_mfr0.3_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.3
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
