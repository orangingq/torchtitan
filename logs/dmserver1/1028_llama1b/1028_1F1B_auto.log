
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 29. (ìˆ˜) 05:50:48 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/1028_1F1B_auto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with auto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-10-29 05:50:54,371 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-29 05:50:54,380 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 05:50:54,484 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-29 05:50:54,434 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 05:50:54,613 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 05:50:54,615 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 05:50:54,578 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 05:50:54,580 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 05:50:54,691 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 05:50:54,694 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 05:50:54,751 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 05:50:54,754 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 05:50:54,759 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 05:50:56,044 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 05:50:56,494 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 05:50:59,271 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 05:50:59,317 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 05:50:59,319 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-29 05:50:59,368 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-29 05:50:59,369 - INFO - Compiling each TransformerBlock with torch.compile
[rank2]:2025-10-29 05:50:59,369 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-29 05:50:59,366 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 05:50:59,511 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 05:50:59,564 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 05:50:59,564 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 05:50:59,565 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank0]:2025-10-29 05:50:59,556 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 05:50:59,557 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank0]:2025-10-29 05:50:59,557 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 05:50:59,603 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 05:50:59,604 - INFO - Compiling each TransformerBlock with torch.compile
[rank0]:2025-10-29 05:50:59,604 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 05:50:59,684 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 05:50:59,723 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 05:50:59,724 - INFO - Compiling the loss function with torch.compile
[rank1]:2025-10-29 05:50:59,773 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 05:50:59,774 - INFO - Compiling each TransformerBlock with torch.compile
[rank1]:2025-10-29 05:50:59,774 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-29 05:50:59,776 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 05:50:59,776 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 05:50:59,776 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-29 05:50:59,953 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 05:50:59,954 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 05:50:59,954 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 04zhyqw3
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1028_1F1B_auto_dm1/20251029-0550/wandb/run-20251029_055100-04zhyqw3
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_1F1B_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/04zhyqw3
[rank3]:2025-10-29 05:51:01,774 - INFO - WandB logging enabled
[rank3]:2025-10-29 05:51:01,775 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 05:51:01,814 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 05:51:01,817 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-29 05:51:01,869 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 05:51:01,871 - INFO - Compiling each TransformerBlock with torch.compile
[rank3]:2025-10-29 05:51:01,871 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-29 05:51:02,085 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 05:51:02,085 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-29 05:51:02,069 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 05:51:02,069 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 05:51:02,070 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 05:51:02,085 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 05:51:02,085 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 05:51:02,085 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1028_1F1B_auto_dm1
[rank0]:2025-10-29 05:51:02,085 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 05:51:02,085 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 05:51:02,089 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 05:51:02,085 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 05:51:02,085 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 05:51:07,495 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1600 (warmup 100)
[rank0]:2025-10-29 05:51:07,495 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 05:51:10,409 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 05:51:10,409 - INFO - Finished loading the checkpoint in 2.91 seconds.
[rank0]:2025-10-29 05:51:10,409 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank0]:  warnings.warn(
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank1]:  warnings.warn(
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank2]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 05:51:22,810 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4627  memory:  4.61GiB(9.71%)  tps: 697  tflops: 5.45  mfu: 1.75%
[rank2]:2025-10-29 05:51:22,810 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 05:51:22,820 - INFO -  step:  1  loss:  9.8292  grad_norm: 53.4627  memory: 12.99GiB(27.34%)  tps: 780  tflops: 6.10  mfu: 1.95%
[rank3]:2025-10-29 05:51:22,820 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 05:51:22,849 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4627  memory:  9.52GiB(20.03%)  tps: 703  tflops: 5.50  mfu: 1.76%
[rank0]:2025-10-29 05:51:22,849 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 05:51:22,818 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4627  memory:  6.98GiB(14.69%)  tps: 709  tflops: 5.55  mfu: 1.78%
[rank1]:2025-10-29 05:51:22,818 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 05:51:38,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,139 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:51:38,140 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,112 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,112 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,113 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,113 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,113 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,114 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,114 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,114 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,115 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,115 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,115 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,115 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,116 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,116 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:51:38,116 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,166 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,167 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,168 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,168 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,168 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,168 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:51:38,168 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,195 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,195 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,195 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,195 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,195 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,195 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,195 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:51:38,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:53:10,574 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 05:53:12,839 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.7537  memory: 13.29GiB(27.97%)  tps: 7,299  tflops: 57.06  mfu: 18.29%
[rank2]:2025-10-29 05:53:12,825 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.7537  memory:  6.43GiB(13.53%)  tps: 7,297  tflops: 57.05  mfu: 18.28%
[rank1]:2025-10-29 05:53:12,828 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.7537  memory:  9.26GiB(19.50%)  tps: 7,298  tflops: 57.05  mfu: 18.29%
[rank3]:2025-10-29 05:53:12,837 - INFO -  step: 50  loss:  9.4386  grad_norm: 21.7537  memory: 16.43GiB(34.58%)  tps: 7,297  tflops: 57.05  mfu: 18.28%
[rank3]:2025-10-29 05:53:13,086 - INFO - Avg. fwd time: 13.8686 / Avg. bwd time: 36.4886 / Avg. batch time: 439.5888 (ms) / GPU bubble ratio: 8.36%
[rank0]:2025-10-29 05:53:13,147 - INFO - Avg. fwd time: 8.6304 / Avg. bwd time: 23.8412 / Avg. batch time: 543.1110 (ms) / GPU bubble ratio: 52.17%
[rank2]:2025-10-29 05:53:13,144 - INFO - Avg. fwd time: 8.2015 / Avg. bwd time: 18.5200 / Avg. batch time: 470.1121 (ms) / GPU bubble ratio: 54.53%
[rank1]:2025-10-29 05:53:13,177 - INFO - Avg. fwd time: 10.4434 / Avg. bwd time: 23.8143 / Avg. batch time: 507.2712 (ms) / GPU bubble ratio: 45.97%
[rank2]:2025-10-29 05:53:35,102 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-29 05:53:35,106 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 05:53:35,114 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-29 05:53:35,118 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-29 05:53:57,404 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.5754e+00
[rank2]:2025-10-29 05:53:57,389 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0669e+00
[rank1]:2025-10-29 05:53:57,393 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4037e+00
[rank3]:2025-10-29 05:53:57,400 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3184e+00
[rank2]:2025-10-29 05:54:19,374 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5401e+00
[rank1]:2025-10-29 05:54:19,387 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7038e+00
[rank3]:2025-10-29 05:54:19,391 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1837e+01
[rank0]:2025-10-29 05:54:19,394 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.7002e+00
[rank0]:2025-10-29 05:54:41,072 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.5243e+00
[rank2]:2025-10-29 05:54:41,057 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6472e+00
[rank1]:2025-10-29 05:54:41,061 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2326e+00
[rank3]:2025-10-29 05:54:41,061 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2265e+01
[rank0]:2025-10-29 05:55:01,004 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:55:03,186 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.8893e+00
[rank0]:2025-10-29 05:55:03,187 - INFO -  step: 100  loss: -4.0000  grad_norm: 43.9045  memory: 13.29GiB(27.97%)  tps: 7,424  tflops: 58.04  mfu: 18.60%
[rank2]:2025-10-29 05:55:03,166 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3579e+00
[rank2]:2025-10-29 05:55:03,167 - INFO -  step: 100  loss: -4.0000  grad_norm: 43.9045  memory:  6.43GiB(13.53%)  tps: 7,424  tflops: 58.04  mfu: 18.60%
[rank1]:2025-10-29 05:55:03,178 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.7793e+00
[rank1]:2025-10-29 05:55:03,179 - INFO -  step: 100  loss: -4.0000  grad_norm: 43.9045  memory:  9.26GiB(19.50%)  tps: 7,424  tflops: 58.03  mfu: 18.60%
[rank3]:2025-10-29 05:55:03,178 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8792e+00
[rank3]:2025-10-29 05:55:03,180 - INFO -  step: 100  loss:  7.3327  grad_norm: 43.9045  memory: 16.43GiB(34.58%)  tps: 7,424  tflops: 58.04  mfu: 18.60%
[rank0]:2025-10-29 05:55:03,268 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0555_stage0_step100.svg
[rank2]:2025-10-29 05:55:03,266 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0555_stage2_step100.svg
[rank1]:2025-10-29 05:55:03,276 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0555_stage1_step100.svg
[rank3]:2025-10-29 05:55:03,386 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0555_real_step100_rank3.svg
[rank3]:> Batch Time: 498.80 ms, GPU Bubble Ratio: 48.04%, 45.17%, 57.58%, 18.63%
[rank3]:2025-10-29 05:55:03,452 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0555_stage3_step100.svg
[rank3]:2025-10-29 05:55:03,653 - INFO - Avg. fwd time: 13.9712 / Avg. bwd time: 36.3809 / Avg. batch time: 436.3980 (ms) / GPU bubble ratio: 7.70%
[rank2]:2025-10-29 05:55:03,728 - INFO - Avg. fwd time: 7.9617 / Avg. bwd time: 18.3296 / Avg. batch time: 466.2202 (ms) / GPU bubble ratio: 54.89%
[rank0]:2025-10-29 05:55:03,729 - INFO - Avg. fwd time: 8.4181 / Avg. bwd time: 23.8335 / Avg. batch time: 539.2743 (ms) / GPU bubble ratio: 52.16%
[rank1]:2025-10-29 05:55:03,757 - INFO - Avg. fwd time: 10.2537 / Avg. bwd time: 23.9869 / Avg. batch time: 503.5017 (ms) / GPU bubble ratio: 45.60%
[rank0]:2025-10-29 05:55:25,598 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.2591e+00
[rank2]:2025-10-29 05:55:25,582 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3685e+00
[rank1]:2025-10-29 05:55:25,583 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.4189e+00
[rank3]:2025-10-29 05:55:25,587 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5542e+00
[rank2]:2025-10-29 05:55:47,610 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3084e+00
[rank0]:2025-10-29 05:55:47,630 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.4730e+00
[rank1]:2025-10-29 05:55:47,622 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.8822e+00
[rank3]:2025-10-29 05:55:47,622 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8172e+00
[rank1]:2025-10-29 05:56:10,011 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9524e+00
[rank3]:2025-10-29 05:56:10,015 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0943e+00
[rank2]:2025-10-29 05:56:10,011 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0515e+00
[rank0]:2025-10-29 05:56:10,027 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.0506e+00
[rank2]:2025-10-29 05:56:31,765 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8059e+00
[rank0]:2025-10-29 05:56:31,781 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.4097e+00
[rank1]:2025-10-29 05:56:31,777 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3079e+00
[rank3]:2025-10-29 05:56:31,777 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7980e+00
[rank0]:2025-10-29 05:56:51,490 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:56:53,655 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3659e+00
[rank1]:2025-10-29 05:56:53,656 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.7351  memory:  9.26GiB(19.50%)  tps: 7,415  tflops: 57.97  mfu: 18.58%
[rank3]:2025-10-29 05:56:53,663 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6767e+00
[rank3]:2025-10-29 05:56:53,665 - INFO -  step: 150  loss:  1.7812  grad_norm: 22.7351  memory: 16.43GiB(34.58%)  tps: 7,415  tflops: 57.96  mfu: 18.58%
[rank2]:2025-10-29 05:56:53,659 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.3892e-01
[rank2]:2025-10-29 05:56:53,659 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.7351  memory:  6.43GiB(13.53%)  tps: 7,414  tflops: 57.96  mfu: 18.58%
[rank0]:2025-10-29 05:56:53,675 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1331e+00
[rank0]:2025-10-29 05:56:53,675 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.7351  memory: 13.29GiB(27.97%)  tps: 7,414  tflops: 57.96  mfu: 18.58%
[rank2]:2025-10-29 05:56:54,153 - INFO - Avg. fwd time: 7.8797 / Avg. bwd time: 18.2048 / Avg. batch time: 464.8041 (ms) / GPU bubble ratio: 55.10%
[rank3]:2025-10-29 05:56:54,131 - INFO - Avg. fwd time: 14.1097 / Avg. bwd time: 36.1918 / Avg. batch time: 435.0014 (ms) / GPU bubble ratio: 7.49%
[rank0]:2025-10-29 05:56:54,209 - INFO - Avg. fwd time: 8.3512 / Avg. bwd time: 23.7407 / Avg. batch time: 537.5254 (ms) / GPU bubble ratio: 52.24%
[rank1]:2025-10-29 05:56:54,182 - INFO - Avg. fwd time: 10.1847 / Avg. bwd time: 23.8008 / Avg. batch time: 501.8636 (ms) / GPU bubble ratio: 45.83%
[rank2]:2025-10-29 05:57:15,426 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4426e+01
[rank0]:2025-10-29 05:57:15,443 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.0164e+01
[rank1]:2025-10-29 05:57:15,438 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8404e+01
[rank3]:2025-10-29 05:57:15,438 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3520e+01
[rank2]:2025-10-29 05:57:36,802 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6532e+00
[rank0]:2025-10-29 05:57:36,818 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6208e+00
[rank1]:2025-10-29 05:57:36,806 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3404e+00
[rank3]:2025-10-29 05:57:36,813 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2398e+00
[rank2]:2025-10-29 05:57:58,437 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1831e+00
[rank0]:2025-10-29 05:57:58,457 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2985e+00
[rank3]:2025-10-29 05:57:58,454 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3295e+00
[rank1]:2025-10-29 05:57:58,453 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5345e+00
[rank3]:2025-10-29 05:58:19,990 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6523e+01
[rank2]:2025-10-29 05:58:19,979 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0430e+01
[rank1]:2025-10-29 05:58:19,983 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4251e+01
[rank0]:2025-10-29 05:58:19,994 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.1019e+01
[rank0]:2025-10-29 05:58:39,296 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:58:41,464 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5672e+00
[rank2]:2025-10-29 05:58:41,464 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5662  memory:  6.43GiB(13.53%)  tps: 7,599  tflops: 59.41  mfu: 19.04%
[rank2]:2025-10-29 05:58:41,464 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 05:58:41,472 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0585e+00
[rank1]:2025-10-29 05:58:41,472 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5662  memory:  9.26GiB(19.50%)  tps: 7,598  tflops: 59.40  mfu: 19.04%
[rank1]:2025-10-29 05:58:41,472 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 05:58:41,483 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.4817e-01
[rank0]:2025-10-29 05:58:41,484 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5662  memory: 13.29GiB(27.97%)  tps: 7,599  tflops: 59.40  mfu: 19.04%
[rank0]:2025-10-29 05:58:41,484 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 05:58:41,479 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6168e+00
[rank3]:2025-10-29 05:58:41,481 - INFO -  step: 200  loss:  0.1673  grad_norm:  0.5662  memory: 16.43GiB(34.58%)  tps: 7,598  tflops: 59.40  mfu: 19.04%
[rank3]:2025-10-29 05:58:41,481 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 05:59:00,003 - INFO - validate step: 200  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 22,094
[rank1]:2025-10-29 05:58:59,989 - INFO - validate step: 200  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 22,121
[rank0]:2025-10-29 05:58:59,980 - INFO - validate step: 200  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 22,145
[rank3]:2025-10-29 05:59:00,010 - INFO - validate step: 200  loss:  0.3066  memory: 16.43GiB(34.58%)  tps: 22,108
[rank2]:2025-10-29 05:59:00,096 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0559_stage2_step200.svg
[rank1]:2025-10-29 05:59:00,093 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0558_stage1_step200.svg
[rank0]:2025-10-29 05:59:00,085 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0558_stage0_step200.svg
[rank3]:2025-10-29 05:59:00,201 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0559_real_step200_rank3.svg
[rank3]:> Batch Time: 495.23 ms, GPU Bubble Ratio: 47.94%, 44.92%, 57.74%, 18.71%
[rank3]:2025-10-29 05:59:00,275 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0559_stage3_step200.svg
[rank3]:2025-10-29 05:59:01,403 - INFO - Avg. fwd time: 14.0918 / Avg. bwd time: 36.0007 / Avg. batch time: 432.9265 (ms) / GPU bubble ratio: 7.43%
[rank2]:2025-10-29 05:59:01,756 - INFO - Avg. fwd time: 7.8471 / Avg. bwd time: 17.8785 / Avg. batch time: 462.2507 (ms) / GPU bubble ratio: 55.48%
[rank1]:2025-10-29 05:59:01,796 - INFO - Avg. fwd time: 10.1640 / Avg. bwd time: 23.6762 / Avg. batch time: 499.1630 (ms) / GPU bubble ratio: 45.76%
[rank0]:2025-10-29 05:59:01,830 - INFO - Avg. fwd time: 8.3292 / Avg. bwd time: 23.4514 / Avg. batch time: 534.5167 (ms) / GPU bubble ratio: 52.43%
[rank3]:2025-10-29 05:59:20,900 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1847e-01
[rank2]:2025-10-29 05:59:20,888 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0053e+00
[rank1]:2025-10-29 05:59:20,892 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.5342e-01
[rank0]:2025-10-29 05:59:20,904 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.1821e+00
[rank0]:2025-10-29 05:59:39,996 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.5157e+00
[rank3]:2025-10-29 05:59:39,991 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1892e+00
[rank2]:2025-10-29 05:59:39,976 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.9273e-01
[rank1]:2025-10-29 05:59:39,984 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.7925e-01
[rank3]:2025-10-29 05:59:59,333 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.7204e-01
[rank2]:2025-10-29 05:59:59,320 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9992e-01
[rank1]:2025-10-29 05:59:59,324 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.4718e-01
[rank0]:2025-10-29 05:59:59,335 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6191e+00
[rank2]:2025-10-29 06:00:18,567 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2992e+00
[rank1]:2025-10-29 06:00:18,575 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.2487e-01
[rank0]:2025-10-29 06:00:18,587 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.8176e+00
[rank3]:2025-10-29 06:00:18,589 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4625e+00
[rank0]:2025-10-29 06:00:35,842 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:00:37,795 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8223e-01
[rank2]:2025-10-29 06:00:37,795 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1163  memory:  6.43GiB(13.53%)  tps: 8,377  tflops: 65.49  mfu: 20.99%
[rank1]:2025-10-29 06:00:37,799 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4160e+00
[rank1]:2025-10-29 06:00:37,799 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1163  memory:  9.26GiB(19.50%)  tps: 8,375  tflops: 65.48  mfu: 20.99%
[rank0]:2025-10-29 06:00:37,810 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4442e+00
[rank0]:2025-10-29 06:00:37,810 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1163  memory: 13.29GiB(27.97%)  tps: 8,374  tflops: 65.46  mfu: 20.98%
[rank3]:2025-10-29 06:00:37,806 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3375e+00
[rank3]:2025-10-29 06:00:37,808 - INFO -  step: 250  loss:  0.1073  grad_norm:  0.1163  memory: 16.43GiB(34.58%)  tps: 8,377  tflops: 65.48  mfu: 20.99%
[rank3]:2025-10-29 06:00:37,974 - INFO - Avg. fwd time: 14.0931 / Avg. bwd time: 34.8078 / Avg. batch time: 423.3752 (ms) / GPU bubble ratio: 7.60%
[rank2]:2025-10-29 06:00:37,999 - INFO - Avg. fwd time: 7.8251 / Avg. bwd time: 16.7025 / Avg. batch time: 451.4803 (ms) / GPU bubble ratio: 56.54%
[rank0]:2025-10-29 06:00:38,029 - INFO - Avg. fwd time: 8.3761 / Avg. bwd time: 22.4668 / Avg. batch time: 522.3312 (ms) / GPU bubble ratio: 52.76%
[rank1]:2025-10-29 06:00:38,071 - INFO - Avg. fwd time: 10.1361 / Avg. bwd time: 22.6494 / Avg. batch time: 487.3943 (ms) / GPU bubble ratio: 46.19%
[rank2]:2025-10-29 06:00:57,346 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3544e+00
[rank1]:2025-10-29 06:00:57,354 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.3779e-01
[rank0]:2025-10-29 06:00:57,365 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.9913e-01
[rank3]:2025-10-29 06:00:57,362 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1653e+00
[rank2]:2025-10-29 06:01:16,779 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5570e-01
[rank1]:2025-10-29 06:01:16,783 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5941e+00
[rank0]:2025-10-29 06:01:16,794 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.2566e+00
[rank3]:2025-10-29 06:01:16,790 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1890e+00
[rank2]:2025-10-29 06:01:36,093 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.2383e-01
[rank1]:2025-10-29 06:01:36,101 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0169e+00
[rank0]:2025-10-29 06:01:36,113 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1878e+00
[rank3]:2025-10-29 06:01:36,113 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8228e-01
[rank2]:2025-10-29 06:01:55,604 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6283e-01
[rank1]:2025-10-29 06:01:55,608 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.3436e-01
[rank0]:2025-10-29 06:01:55,619 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0798e+00
[rank3]:2025-10-29 06:01:55,616 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8732e-01
[rank0]:2025-10-29 06:02:12,754 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:02:14,698 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.0131e+00
[rank0]:2025-10-29 06:02:14,698 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0790  memory: 13.29GiB(27.97%)  tps: 8,455  tflops: 66.10  mfu: 21.19%
[rank3]:2025-10-29 06:02:14,694 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2175e+00
[rank3]:2025-10-29 06:02:14,696 - INFO -  step: 300  loss:  0.1129  grad_norm:  0.0790  memory: 16.43GiB(34.58%)  tps: 8,455  tflops: 66.10  mfu: 21.19%
[rank2]:2025-10-29 06:02:14,678 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2619e+00
[rank2]:2025-10-29 06:02:14,679 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0790  memory:  6.43GiB(13.53%)  tps: 8,456  tflops: 66.10  mfu: 21.19%
[rank1]:2025-10-29 06:02:14,682 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.0874e+00
[rank1]:2025-10-29 06:02:14,683 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0790  memory:  9.26GiB(19.50%)  tps: 8,456  tflops: 66.10  mfu: 21.19%
[rank1]:2025-10-29 06:02:14,771 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0602_stage1_step300.svg
[rank0]:2025-10-29 06:02:14,769 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0602_stage0_step300.svg
[rank2]:2025-10-29 06:02:14,776 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0602_stage2_step300.svg
[rank3]:2025-10-29 06:02:14,881 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0602_real_step300_rank3.svg
[rank3]:> Batch Time: 484.64 ms, GPU Bubble Ratio: 48.86%, 44.93%, 59.25%, 18.38%
[rank3]:2025-10-29 06:02:14,948 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0602_stage3_step300.svg
[rank0]:2025-10-29 06:02:15,415 - INFO - Avg. fwd time: 8.3416 / Avg. bwd time: 21.7393 / Avg. batch time: 513.1774 (ms) / GPU bubble ratio: 53.11%
[rank3]:2025-10-29 06:02:15,346 - INFO - Avg. fwd time: 14.1507 / Avg. bwd time: 33.9807 / Avg. batch time: 416.8274 (ms) / GPU bubble ratio: 7.62%
[rank2]:2025-10-29 06:02:15,366 - INFO - Avg. fwd time: 7.8010 / Avg. bwd time: 15.7685 / Avg. batch time: 444.0519 (ms) / GPU bubble ratio: 57.54%
[rank1]:2025-10-29 06:02:15,389 - INFO - Avg. fwd time: 10.1042 / Avg. bwd time: 21.7901 / Avg. batch time: 479.0858 (ms) / GPU bubble ratio: 46.74%
[rank3]:2025-10-29 06:02:34,315 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4395e+00
[rank0]:2025-10-29 06:02:34,319 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2513e+01
[rank2]:2025-10-29 06:02:34,303 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1790e+00
[rank1]:2025-10-29 06:02:34,307 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.3020e+00
[rank3]:2025-10-29 06:02:53,464 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0122e+00
[rank2]:2025-10-29 06:02:53,449 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7713e+00
[rank1]:2025-10-29 06:02:53,453 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6569e+00
[rank0]:2025-10-29 06:02:53,468 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7565e+00
[rank2]:2025-10-29 06:03:12,387 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3949e-01
[rank1]:2025-10-29 06:03:12,391 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.4274e-01
[rank3]:2025-10-29 06:03:12,404 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1409e-01
[rank0]:2025-10-29 06:03:12,399 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1832e+00
[rank2]:2025-10-29 06:03:31,445 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6909e+00
[rank1]:2025-10-29 06:03:31,449 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6916e-01
[rank3]:2025-10-29 06:03:31,460 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9692e-01
[rank0]:2025-10-29 06:03:31,464 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5150e-01
[rank0]:2025-10-29 06:03:48,764 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:03:50,742 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2278e+00
[rank3]:2025-10-29 06:03:50,744 - INFO -  step: 350  loss:  0.1118  grad_norm:  0.1104  memory: 16.43GiB(34.58%)  tps: 8,529  tflops: 66.68  mfu: 21.37%
[rank0]:2025-10-29 06:03:50,739 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5142e+00
[rank0]:2025-10-29 06:03:50,740 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1104  memory: 13.29GiB(27.97%)  tps: 8,530  tflops: 66.68  mfu: 21.37%
[rank2]:2025-10-29 06:03:50,727 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3770e+00
[rank2]:2025-10-29 06:03:50,728 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1104  memory:  6.43GiB(13.53%)  tps: 8,529  tflops: 66.68  mfu: 21.37%
[rank1]:2025-10-29 06:03:50,731 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.5624e-01
[rank1]:2025-10-29 06:03:50,732 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1104  memory:  9.26GiB(19.50%)  tps: 8,529  tflops: 66.68  mfu: 21.37%
[rank3]:2025-10-29 06:03:50,909 - INFO - Avg. fwd time: 14.1458 / Avg. bwd time: 33.4401 / Avg. batch time: 412.2249 (ms) / GPU bubble ratio: 7.65%
[rank2]:2025-10-29 06:03:50,934 - INFO - Avg. fwd time: 7.7867 / Avg. bwd time: 15.2420 / Avg. batch time: 438.8618 (ms) / GPU bubble ratio: 58.02%
[rank1]:2025-10-29 06:03:50,995 - INFO - Avg. fwd time: 10.0839 / Avg. bwd time: 21.1630 / Avg. batch time: 473.2495 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-29 06:03:50,961 - INFO - Avg. fwd time: 8.3194 / Avg. bwd time: 21.1633 / Avg. batch time: 506.6905 (ms) / GPU bubble ratio: 53.45%
[rank2]:2025-10-29 06:04:09,985 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0869e+00
[rank1]:2025-10-29 06:04:09,989 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.4334e-01
[rank3]:2025-10-29 06:04:10,001 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1057e-01
[rank0]:2025-10-29 06:04:10,004 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8932e-01
[rank2]:2025-10-29 06:04:29,427 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0242e-01
[rank1]:2025-10-29 06:04:29,431 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.7507e-01
[rank3]:2025-10-29 06:04:29,439 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9688e-01
[rank0]:2025-10-29 06:04:29,439 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0989e+00
[rank2]:2025-10-29 06:04:48,639 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9504e-01
[rank1]:2025-10-29 06:04:48,642 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.7353e-01
[rank3]:2025-10-29 06:04:48,654 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1819e-01
[rank0]:2025-10-29 06:04:48,658 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8952e-01
[rank2]:2025-10-29 06:05:07,992 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0680e-01
[rank1]:2025-10-29 06:05:07,996 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.3658e-01
[rank3]:2025-10-29 06:05:08,004 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0317e+00
[rank0]:2025-10-29 06:05:08,003 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7079e+00
[rank0]:2025-10-29 06:05:25,427 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:05:27,391 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8954e-01
[rank2]:2025-10-29 06:05:27,391 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1347  memory:  6.43GiB(13.53%)  tps: 8,475  tflops: 66.25  mfu: 21.23%
[rank2]:2025-10-29 06:05:27,391 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 06:05:27,395 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.8626e-01
[rank1]:2025-10-29 06:05:27,395 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1347  memory:  9.26GiB(19.50%)  tps: 8,475  tflops: 66.25  mfu: 21.23%
[rank1]:2025-10-29 06:05:27,395 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 06:05:27,406 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0252e+00
[rank3]:2025-10-29 06:05:27,408 - INFO -  step: 400  loss:  0.1086  grad_norm:  0.1347  memory: 16.43GiB(34.58%)  tps: 8,475  tflops: 66.25  mfu: 21.23%
[rank3]:2025-10-29 06:05:27,409 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 06:05:27,410 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9047e-01
[rank0]:2025-10-29 06:05:27,411 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1347  memory: 13.29GiB(27.97%)  tps: 8,474  tflops: 66.25  mfu: 21.23%
[rank0]:2025-10-29 06:05:27,411 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 06:05:42,493 - INFO - validate step: 400  loss:  0.2977  memory: 16.43GiB(34.58%)  tps: 27,155
[rank0]:2025-10-29 06:05:42,462 - INFO - validate step: 400  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,214
[rank2]:2025-10-29 06:05:42,488 - INFO - validate step: 400  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 27,132
[rank1]:2025-10-29 06:05:42,473 - INFO - validate step: 400  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 27,165
[rank0]:2025-10-29 06:05:42,582 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0605_stage0_step400.svg
[rank2]:2025-10-29 06:05:42,579 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0605_stage2_step400.svg
[rank1]:2025-10-29 06:05:42,576 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0605_stage1_step400.svg
[rank3]:2025-10-29 06:05:42,680 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0605_real_step400_rank3.svg
[rank3]:> Batch Time: 464.68 ms, GPU Bubble Ratio: 48.17%, 45.22%, 59.29%, 18.59%
[rank3]:2025-10-29 06:05:42,755 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0605_stage3_step400.svg
[rank3]:2025-10-29 06:05:42,894 - INFO - Avg. fwd time: 14.1924 / Avg. bwd time: 33.0162 / Avg. batch time: 408.9974 (ms) / GPU bubble ratio: 7.66%
[rank0]:2025-10-29 06:05:42,912 - INFO - Avg. fwd time: 8.3004 / Avg. bwd time: 20.6049 / Avg. batch time: 501.6864 (ms) / GPU bubble ratio: 53.91%
[rank2]:2025-10-29 06:05:42,958 - INFO - Avg. fwd time: 7.7752 / Avg. bwd time: 14.7462 / Avg. batch time: 435.0851 (ms) / GPU bubble ratio: 58.59%
[rank1]:2025-10-29 06:05:42,992 - INFO - Avg. fwd time: 10.0668 / Avg. bwd time: 20.5772 / Avg. batch time: 468.8707 (ms) / GPU bubble ratio: 47.71%
[rank1]:2025-10-29 06:06:01,873 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2237e+00
[rank3]:2025-10-29 06:06:01,881 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2984e-01
[rank0]:2025-10-29 06:06:01,880 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4079e+00
[rank2]:2025-10-29 06:06:01,869 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1840e-01
[rank2]:2025-10-29 06:06:21,340 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5004e+00
[rank1]:2025-10-29 06:06:21,343 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1575e+00
[rank3]:2025-10-29 06:06:21,355 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6912e+00
[rank0]:2025-10-29 06:06:21,359 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5562e-01
[rank2]:2025-10-29 06:06:40,609 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0268e-01
[rank1]:2025-10-29 06:06:40,613 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.7096e-01
[rank3]:2025-10-29 06:06:40,620 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5621e-01
[rank0]:2025-10-29 06:06:40,621 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.5260e-01
[rank2]:2025-10-29 06:07:00,017 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.8665e-01
[rank1]:2025-10-29 06:07:00,021 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.5801e-01
[rank0]:2025-10-29 06:07:00,036 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8239e-01
[rank3]:2025-10-29 06:07:00,034 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2594e+00
[rank0]:2025-10-29 06:07:17,608 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:07:19,551 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0044e+00
[rank2]:2025-10-29 06:07:19,551 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1210  memory:  6.43GiB(13.53%)  tps: 8,440  tflops: 65.98  mfu: 21.15%
[rank1]:2025-10-29 06:07:19,555 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6262e+00
[rank1]:2025-10-29 06:07:19,555 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1210  memory:  9.26GiB(19.50%)  tps: 8,438  tflops: 65.97  mfu: 21.14%
[rank0]:2025-10-29 06:07:19,562 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3027e+00
[rank0]:2025-10-29 06:07:19,563 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1210  memory: 13.29GiB(27.97%)  tps: 8,437  tflops: 65.95  mfu: 21.14%
[rank3]:2025-10-29 06:07:19,562 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7406e+00
[rank3]:2025-10-29 06:07:19,564 - INFO -  step: 450  loss:  0.1209  grad_norm:  0.1210  memory: 16.43GiB(34.58%)  tps: 8,439  tflops: 65.97  mfu: 21.15%
[rank3]:2025-10-29 06:07:19,988 - INFO - Avg. fwd time: 14.2289 / Avg. bwd time: 32.6965 / Avg. batch time: 406.5742 (ms) / GPU bubble ratio: 7.67%
[rank2]:2025-10-29 06:07:20,004 - INFO - Avg. fwd time: 7.7676 / Avg. bwd time: 14.4011 / Avg. batch time: 432.3586 (ms) / GPU bubble ratio: 58.98%
[rank1]:2025-10-29 06:07:20,026 - INFO - Avg. fwd time: 10.0568 / Avg. bwd time: 20.1658 / Avg. batch time: 465.7253 (ms) / GPU bubble ratio: 48.09%
[rank0]:2025-10-29 06:07:20,051 - INFO - Avg. fwd time: 8.2875 / Avg. bwd time: 20.1436 / Avg. batch time: 498.0406 (ms) / GPU bubble ratio: 54.33%
[rank2]:2025-10-29 06:07:38,856 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1704e+00
[rank1]:2025-10-29 06:07:38,860 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.6917e-01
[rank0]:2025-10-29 06:07:38,876 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4187e-01
[rank3]:2025-10-29 06:07:38,872 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1470e-01
[rank1]:2025-10-29 06:07:58,333 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.2412e-01
[rank0]:2025-10-29 06:07:58,341 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.2186e-01
[rank3]:2025-10-29 06:07:58,341 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1061e+00
[rank2]:2025-10-29 06:07:58,329 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5893e-01
[rank0]:2025-10-29 06:08:17,703 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4032e-01
[rank3]:2025-10-29 06:08:17,700 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9717e+00
[rank2]:2025-10-29 06:08:17,683 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0617e+00
[rank1]:2025-10-29 06:08:17,687 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1007e+00
[rank0]:2025-10-29 06:08:37,011 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4426e+00
[rank3]:2025-10-29 06:08:37,012 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0367e+00
[rank2]:2025-10-29 06:08:37,000 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2896e-01
[rank1]:2025-10-29 06:08:37,004 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6045e+00
[rank0]:2025-10-29 06:08:54,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:08:56,264 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8742e+00
[rank2]:2025-10-29 06:08:56,264 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1338  memory:  6.43GiB(13.53%)  tps: 8,470  tflops: 66.22  mfu: 21.22%
[rank1]:2025-10-29 06:08:56,268 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3558e+00
[rank1]:2025-10-29 06:08:56,268 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1338  memory:  9.26GiB(19.50%)  tps: 8,470  tflops: 66.22  mfu: 21.22%
[rank0]:2025-10-29 06:08:56,283 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6602e+00
[rank0]:2025-10-29 06:08:56,284 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1338  memory: 13.29GiB(27.97%)  tps: 8,470  tflops: 66.21  mfu: 21.22%
[rank3]:2025-10-29 06:08:56,287 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6306e+00
[rank3]:2025-10-29 06:08:56,289 - INFO -  step: 500  loss:  0.1007  grad_norm:  0.1338  memory: 16.43GiB(34.58%)  tps: 8,469  tflops: 66.21  mfu: 21.22%
[rank2]:2025-10-29 06:08:56,369 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0608_stage2_step500.svg
[rank1]:2025-10-29 06:08:56,366 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0608_stage1_step500.svg
[rank0]:2025-10-29 06:08:56,368 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0608_stage0_step500.svg
[rank3]:2025-10-29 06:08:56,474 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0608_real_step500_rank3.svg
[rank3]:> Batch Time: 440.07 ms, GPU Bubble Ratio: 51.45%, 48.25%, 62.16%, 17.23%
[rank3]:2025-10-29 06:08:56,541 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0608_stage3_step500.svg
[rank0]:2025-10-29 06:08:56,698 - INFO - Avg. fwd time: 8.2773 / Avg. bwd time: 19.8590 / Avg. batch time: 495.4786 (ms) / GPU bubble ratio: 54.57%
[rank3]:2025-10-29 06:08:56,703 - INFO - Avg. fwd time: 14.2595 / Avg. bwd time: 32.4783 / Avg. batch time: 404.9643 (ms) / GPU bubble ratio: 7.67%
[rank2]:2025-10-29 06:08:56,747 - INFO - Avg. fwd time: 7.7611 / Avg. bwd time: 14.1294 / Avg. batch time: 430.4418 (ms) / GPU bubble ratio: 59.32%
[rank1]:2025-10-29 06:08:56,782 - INFO - Avg. fwd time: 10.0473 / Avg. bwd time: 19.8462 / Avg. batch time: 463.4815 (ms) / GPU bubble ratio: 48.40%
[rank3]:2025-10-29 06:09:15,596 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0469e+00
[rank2]:2025-10-29 06:09:15,584 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8930e-01
[rank1]:2025-10-29 06:09:15,589 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5939e+00
[rank0]:2025-10-29 06:09:15,596 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.7327e+00
[rank3]:2025-10-29 06:09:34,520 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2978e+00
[rank2]:2025-10-29 06:09:34,504 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9486e-01
[rank1]:2025-10-29 06:09:34,508 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9060e+00
[rank0]:2025-10-29 06:09:34,523 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1127e+00
[rank0]:2025-10-29 06:09:53,612 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0746e+00
[rank3]:2025-10-29 06:09:53,612 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6572e+00
[rank2]:2025-10-29 06:09:53,601 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6867e+00
[rank1]:2025-10-29 06:09:53,604 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7278e+00
[rank2]:2025-10-29 06:10:12,395 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1307e+00
[rank1]:2025-10-29 06:10:12,399 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.8315e-01
[rank0]:2025-10-29 06:10:12,414 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7082e-01
[rank3]:2025-10-29 06:10:12,417 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4519e+00
[rank0]:2025-10-29 06:10:29,668 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:10:31,576 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9503e+00
[rank0]:2025-10-29 06:10:31,576 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0955  memory: 13.29GiB(27.97%)  tps: 8,597  tflops: 67.21  mfu: 21.54%
[rank3]:2025-10-29 06:10:31,578 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2245e+00
[rank3]:2025-10-29 06:10:31,580 - INFO -  step: 550  loss:  0.1137  grad_norm:  0.0955  memory: 16.43GiB(34.58%)  tps: 8,597  tflops: 67.21  mfu: 21.54%
[rank2]:2025-10-29 06:10:31,564 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0183e-01
[rank2]:2025-10-29 06:10:31,564 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0955  memory:  6.43GiB(13.53%)  tps: 8,596  tflops: 67.20  mfu: 21.54%
[rank1]:2025-10-29 06:10:31,568 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1439e+00
[rank1]:2025-10-29 06:10:31,568 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0955  memory:  9.26GiB(19.50%)  tps: 8,596  tflops: 67.20  mfu: 21.54%
[rank3]:2025-10-29 06:10:31,741 - INFO - Avg. fwd time: 14.2349 / Avg. bwd time: 32.2120 / Avg. batch time: 402.5268 (ms) / GPU bubble ratio: 7.69%
[rank2]:2025-10-29 06:10:31,769 - INFO - Avg. fwd time: 7.7545 / Avg. bwd time: 13.8910 / Avg. batch time: 427.7977 (ms) / GPU bubble ratio: 59.52%
[rank1]:2025-10-29 06:10:31,824 - INFO - Avg. fwd time: 10.0377 / Avg. bwd time: 19.5628 / Avg. batch time: 460.5447 (ms) / GPU bubble ratio: 48.58%
[rank0]:2025-10-29 06:10:31,794 - INFO - Avg. fwd time: 8.2664 / Avg. bwd time: 19.5621 / Avg. batch time: 492.2103 (ms) / GPU bubble ratio: 54.77%
[rank0]:2025-10-29 06:10:50,609 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7286e-01
[rank3]:2025-10-29 06:10:50,606 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1737e+00
[rank2]:2025-10-29 06:10:50,589 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2471e+00
[rank1]:2025-10-29 06:10:50,593 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1952e+00
[rank1]:2025-10-29 06:11:09,899 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.8908e-01
[rank0]:2025-10-29 06:11:09,906 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1957e+00
[rank3]:2025-10-29 06:11:09,906 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0298e-01
[rank2]:2025-10-29 06:11:09,894 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0535e-01
[rank0]:2025-10-29 06:11:29,364 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0743e-01
[rank3]:2025-10-29 06:11:29,361 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5319e-01
[rank2]:2025-10-29 06:11:29,345 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1882e+00
[rank1]:2025-10-29 06:11:29,349 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.0277e-01
[rank0]:2025-10-29 06:11:48,772 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1319e+00
[rank3]:2025-10-29 06:11:48,772 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8051e+00
[rank2]:2025-10-29 06:11:48,760 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1056e+00
[rank1]:2025-10-29 06:11:48,764 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0068e+00
[rank0]:2025-10-29 06:12:05,883 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:12:07,811 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8479e+00
[rank0]:2025-10-29 06:12:07,812 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0959  memory: 13.29GiB(27.97%)  tps: 8,512  tflops: 66.55  mfu: 21.33%
[rank0]:2025-10-29 06:12:07,812 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 06:12:07,816 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1285e-01
[rank3]:2025-10-29 06:12:07,818 - INFO -  step: 600  loss:  0.1225  grad_norm:  0.0959  memory: 16.43GiB(34.58%)  tps: 8,512  tflops: 66.55  mfu: 21.33%
[rank3]:2025-10-29 06:12:07,819 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 06:12:07,792 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8950e-01
[rank2]:2025-10-29 06:12:07,792 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0959  memory:  6.43GiB(13.53%)  tps: 8,513  tflops: 66.55  mfu: 21.33%
[rank2]:2025-10-29 06:12:07,792 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 06:12:07,796 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8234e+00
[rank1]:2025-10-29 06:12:07,796 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0959  memory:  9.26GiB(19.50%)  tps: 8,513  tflops: 66.55  mfu: 21.33%
[rank1]:2025-10-29 06:12:07,796 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 06:12:23,000 - INFO - validate step: 600  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 26,970
[rank2]:2025-10-29 06:12:23,027 - INFO - validate step: 600  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,887
[rank3]:2025-10-29 06:12:23,033 - INFO - validate step: 600  loss:  0.2985  memory: 16.43GiB(34.58%)  tps: 26,924
[rank1]:2025-10-29 06:12:23,013 - INFO - validate step: 600  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 26,917
[rank0]:2025-10-29 06:12:23,115 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0612_stage0_step600.svg
[rank2]:2025-10-29 06:12:23,113 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0612_stage2_step600.svg
[rank1]:2025-10-29 06:12:23,115 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0612_stage1_step600.svg
[rank3]:2025-10-29 06:12:23,231 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0612_real_step600_rank3.svg
[rank3]:> Batch Time: 437.67 ms, GPU Bubble Ratio: 51.24%, 48.09%, 62.04%, 17.30%
[rank3]:2025-10-29 06:12:23,304 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0612_stage3_step600.svg
[rank2]:2025-10-29 06:12:23,718 - INFO - Avg. fwd time: 7.7487 / Avg. bwd time: 13.6684 / Avg. batch time: 426.0937 (ms) / GPU bubble ratio: 59.79%
[rank3]:2025-10-29 06:12:23,698 - INFO - Avg. fwd time: 14.2457 / Avg. bwd time: 32.0224 / Avg. batch time: 401.0097 (ms) / GPU bubble ratio: 7.70%
[rank1]:2025-10-29 06:12:23,745 - INFO - Avg. fwd time: 10.0290 / Avg. bwd time: 19.3016 / Avg. batch time: 458.5743 (ms) / GPU bubble ratio: 48.83%
[rank0]:2025-10-29 06:12:23,768 - INFO - Avg. fwd time: 8.2574 / Avg. bwd time: 19.3413 / Avg. batch time: 489.9945 (ms) / GPU bubble ratio: 54.94%
[rank0]:2025-10-29 06:12:42,554 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2784e+00
[rank2]:2025-10-29 06:12:42,542 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9999e-01
[rank3]:2025-10-29 06:12:42,554 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7362e-01
[rank1]:2025-10-29 06:12:42,546 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.1518e-01
[rank1]:2025-10-29 06:13:01,523 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2072e+00
[rank0]:2025-10-29 06:13:01,538 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2323e+00
[rank2]:2025-10-29 06:13:01,519 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.2946e-01
[rank3]:2025-10-29 06:13:01,535 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4799e-01
[rank2]:2025-10-29 06:13:20,729 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1542e-01
[rank1]:2025-10-29 06:13:20,733 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0028e-01
[rank0]:2025-10-29 06:13:20,741 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.7742e-01
[rank3]:2025-10-29 06:13:20,741 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6762e+00
[rank2]:2025-10-29 06:13:40,005 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2178e+00
[rank0]:2025-10-29 06:13:40,027 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6030e+00
[rank3]:2025-10-29 06:13:40,021 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3144e+00
[rank1]:2025-10-29 06:13:40,009 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4543e+00
[rank0]:2025-10-29 06:13:57,116 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:13:59,021 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9167e+00
[rank2]:2025-10-29 06:13:59,022 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1230  memory:  6.43GiB(13.53%)  tps: 8,534  tflops: 66.71  mfu: 21.38%
[rank0]:2025-10-29 06:13:59,032 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.6603e+00
[rank0]:2025-10-29 06:13:59,033 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1230  memory: 13.29GiB(27.97%)  tps: 8,530  tflops: 66.69  mfu: 21.37%
[rank3]:2025-10-29 06:13:59,050 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0423e+00
[rank3]:2025-10-29 06:13:59,052 - INFO -  step: 650  loss:  0.1518  grad_norm:  0.1230  memory: 16.43GiB(34.58%)  tps: 8,532  tflops: 66.70  mfu: 21.38%
[rank1]:2025-10-29 06:13:59,025 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.5313e+00
[rank1]:2025-10-29 06:13:59,025 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1230  memory:  9.26GiB(19.50%)  tps: 8,532  tflops: 66.70  mfu: 21.38%
[rank2]:2025-10-29 06:13:59,239 - INFO - Avg. fwd time: 7.7457 / Avg. bwd time: 13.5342 / Avg. batch time: 424.6731 (ms) / GPU bubble ratio: 59.91%
[rank0]:2025-10-29 06:13:59,266 - INFO - Avg. fwd time: 8.2518 / Avg. bwd time: 19.1565 / Avg. batch time: 488.2069 (ms) / GPU bubble ratio: 55.09%
[rank3]:2025-10-29 06:13:59,219 - INFO - Avg. fwd time: 14.2404 / Avg. bwd time: 31.8786 / Avg. batch time: 399.7512 (ms) / GPU bubble ratio: 7.70%
[rank1]:2025-10-29 06:13:59,301 - INFO - Avg. fwd time: 10.0249 / Avg. bwd time: 19.1410 / Avg. batch time: 456.9885 (ms) / GPU bubble ratio: 48.94%
[rank1]:2025-10-29 06:14:18,211 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5118e+00
[rank2]:2025-10-29 06:14:18,207 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3178e+00
[rank0]:2025-10-29 06:14:18,227 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9776e-01
[rank3]:2025-10-29 06:14:18,223 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9587e+00
[rank1]:2025-10-29 06:14:37,634 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.1177e-01
[rank2]:2025-10-29 06:14:37,630 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8386e-02
[rank0]:2025-10-29 06:14:37,642 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.0209e-01
[rank3]:2025-10-29 06:14:37,642 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4243e-01
[rank2]:2025-10-29 06:14:56,658 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5661e+00
[rank0]:2025-10-29 06:14:56,678 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6068e-01
[rank3]:2025-10-29 06:14:56,674 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5083e+00
[rank1]:2025-10-29 06:14:56,662 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9642e+00
[rank2]:2025-10-29 06:15:16,031 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3274e+00
[rank0]:2025-10-29 06:15:16,043 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3620e+00
[rank1]:2025-10-29 06:15:16,035 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.1769e+00
[rank3]:2025-10-29 06:15:16,044 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.6239e+00
[rank0]:2025-10-29 06:15:32,999 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:15:34,899 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8197e+00
[rank1]:2025-10-29 06:15:34,900 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0923  memory:  9.26GiB(19.50%)  tps: 8,545  tflops: 66.80  mfu: 21.41%
[rank3]:2025-10-29 06:15:34,911 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1649e+00
[rank2]:2025-10-29 06:15:34,895 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5334e+00
[rank2]:2025-10-29 06:15:34,896 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0923  memory:  6.43GiB(13.53%)  tps: 8,545  tflops: 66.80  mfu: 21.41%
[rank0]:2025-10-29 06:15:34,915 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3739e+00
[rank0]:2025-10-29 06:15:34,915 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0923  memory: 13.29GiB(27.97%)  tps: 8,544  tflops: 66.79  mfu: 21.41%
[rank0]:2025-10-29 06:15:35,004 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0615_stage0_step700.svg
[rank1]:2025-10-29 06:15:35,004 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0615_stage1_step700.svg
[rank3]:2025-10-29 06:15:34,914 - INFO -  step: 700  loss:  0.1147  grad_norm:  0.0923  memory: 16.43GiB(34.58%)  tps: 8,546  tflops: 66.81  mfu: 21.41%
[rank2]:2025-10-29 06:15:35,004 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0615_stage2_step700.svg
[rank3]:2025-10-29 06:15:35,111 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0615_real_step700_rank3.svg
[rank3]:> Batch Time: 436.40 ms, GPU Bubble Ratio: 51.13%, 48.02%, 61.97%, 17.33%
[rank3]:2025-10-29 06:15:35,181 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0615_stage3_step700.svg
[rank0]:2025-10-29 06:15:35,341 - INFO - Avg. fwd time: 8.2461 / Avg. bwd time: 18.9899 / Avg. batch time: 486.4112 (ms) / GPU bubble ratio: 55.21%
[rank3]:2025-10-29 06:15:35,346 - INFO - Avg. fwd time: 14.2376 / Avg. bwd time: 31.7343 / Avg. batch time: 398.5097 (ms) / GPU bubble ratio: 7.71%
[rank2]:2025-10-29 06:15:35,385 - INFO - Avg. fwd time: 7.7420 / Avg. bwd time: 13.3806 / Avg. batch time: 423.2489 (ms) / GPU bubble ratio: 60.08%
[rank1]:2025-10-29 06:15:35,419 - INFO - Avg. fwd time: 10.0197 / Avg. bwd time: 18.9605 / Avg. batch time: 455.3795 (ms) / GPU bubble ratio: 49.09%
[rank2]:2025-10-29 06:15:54,142 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8200e-01
[rank0]:2025-10-29 06:15:54,154 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.8231e-01
[rank1]:2025-10-29 06:15:54,146 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.3968e-01
[rank3]:2025-10-29 06:15:54,154 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3406e+00
[rank2]:2025-10-29 06:16:13,323 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1749e+00
[rank0]:2025-10-29 06:16:13,342 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3889e-01
[rank1]:2025-10-29 06:16:13,327 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9463e+00
[rank3]:2025-10-29 06:16:13,338 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0872e+00
[rank2]:2025-10-29 06:16:32,651 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3379e+00
[rank0]:2025-10-29 06:16:32,663 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.5517e+00
[rank1]:2025-10-29 06:16:32,655 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6146e+00
[rank3]:2025-10-29 06:16:32,665 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7328e+00
[rank0]:2025-10-29 06:16:51,905 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.6579e-01
[rank1]:2025-10-29 06:16:51,889 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0378e+00
[rank3]:2025-10-29 06:16:51,901 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0520e-01
[rank2]:2025-10-29 06:16:51,885 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4791e-01
[rank0]:2025-10-29 06:17:09,083 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:17:10,984 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4046e-01
[rank2]:2025-10-29 06:17:10,984 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1105  memory:  6.43GiB(13.53%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank0]:2025-10-29 06:17:10,995 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.5452e-01
[rank0]:2025-10-29 06:17:10,996 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1105  memory: 13.29GiB(27.97%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank1]:2025-10-29 06:17:10,987 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8236e-01
[rank1]:2025-10-29 06:17:10,988 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1105  memory:  9.26GiB(19.50%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank3]:2025-10-29 06:17:10,996 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3062e-01
[rank3]:2025-10-29 06:17:10,998 - INFO -  step: 750  loss:  0.1161  grad_norm:  0.1105  memory: 16.43GiB(34.58%)  tps: 8,526  tflops: 66.65  mfu: 21.36%
[rank3]:2025-10-29 06:17:11,424 - INFO - Avg. fwd time: 14.2321 / Avg. bwd time: 31.6112 / Avg. batch time: 397.4249 (ms) / GPU bubble ratio: 7.72%
[rank2]:2025-10-29 06:17:11,443 - INFO - Avg. fwd time: 7.7395 / Avg. bwd time: 13.2692 / Avg. batch time: 422.0787 (ms) / GPU bubble ratio: 60.18%
[rank0]:2025-10-29 06:17:11,492 - INFO - Avg. fwd time: 8.2413 / Avg. bwd time: 18.8260 / Avg. batch time: 484.9256 (ms) / GPU bubble ratio: 55.35%
[rank1]:2025-10-29 06:17:11,466 - INFO - Avg. fwd time: 10.0164 / Avg. bwd time: 18.8265 / Avg. batch time: 454.0736 (ms) / GPU bubble ratio: 49.18%
[rank2]:2025-10-29 06:17:29,986 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1221e-01
[rank0]:2025-10-29 06:17:30,006 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9307e-01
[rank1]:2025-10-29 06:17:29,990 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0439e-01
[rank3]:2025-10-29 06:17:30,008 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0082e-01
[rank1]:2025-10-29 06:17:49,177 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2289e+00
[rank0]:2025-10-29 06:17:49,184 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0748e+00
[rank3]:2025-10-29 06:17:49,185 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6117e+00
[rank2]:2025-10-29 06:17:49,173 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1210e+00
[rank2]:2025-10-29 06:18:08,369 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1275e+00
[rank0]:2025-10-29 06:18:08,388 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3016e-01
[rank1]:2025-10-29 06:18:08,372 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.3399e-01
[rank3]:2025-10-29 06:18:08,384 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0929e+00
[rank2]:2025-10-29 06:18:27,894 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0817e-01
[rank0]:2025-10-29 06:18:27,905 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3219e+00
[rank1]:2025-10-29 06:18:27,898 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1583e+00
[rank3]:2025-10-29 06:18:27,906 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2953e+00
[rank0]:2025-10-29 06:18:45,371 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:18:47,362 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8434e+00
[rank0]:2025-10-29 06:18:47,363 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1201  memory: 13.29GiB(27.97%)  tps: 8,501  tflops: 66.46  mfu: 21.30%
[rank0]:2025-10-29 06:18:47,363 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 06:18:47,346 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8489e+00
[rank1]:2025-10-29 06:18:47,347 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1201  memory:  9.26GiB(19.50%)  tps: 8,502  tflops: 66.46  mfu: 21.30%
[rank1]:2025-10-29 06:18:47,347 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 06:18:47,358 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1912e+00
[rank3]:2025-10-29 06:18:47,360 - INFO -  step: 800  loss:  0.1081  grad_norm:  0.1201  memory: 16.43GiB(34.58%)  tps: 8,501  tflops: 66.46  mfu: 21.30%
[rank3]:2025-10-29 06:18:47,360 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 06:18:47,342 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9837e+00
[rank2]:2025-10-29 06:18:47,343 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1201  memory:  6.43GiB(13.53%)  tps: 8,502  tflops: 66.46  mfu: 21.30%
[rank2]:2025-10-29 06:18:47,343 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 06:19:02,447 - INFO - validate step: 800  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,155
[rank0]:2025-10-29 06:19:02,448 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:19:02,454 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 06:19:02,458 - INFO - validate step: 800  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 27,106
[rank1]:2025-10-29 06:19:02,459 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:19:02,478 - INFO - validate step: 800  loss:  0.2955  memory: 16.43GiB(34.58%)  tps: 27,095
[rank3]:2025-10-29 06:19:02,479 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:19:02,473 - INFO - validate step: 800  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 27,073
[rank2]:2025-10-29 06:19:02,473 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:19:04,228 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.75 seconds.
[rank1]:2025-10-29 06:19:04,773 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.31 seconds.
[rank3]:2025-10-29 06:19:05,610 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.13 seconds.
[rank0]:2025-10-29 06:19:06,090 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 06:19:06,098 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.65 seconds.
[rank1]:2025-10-29 06:19:06,187 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0619_stage1_step800.svg
[rank2]:2025-10-29 06:19:06,189 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0619_stage2_step800.svg
[rank0]:2025-10-29 06:19:06,389 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0619_stage0_step800.svg
[rank3]:2025-10-29 06:19:06,429 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0619_real_step800_rank3.svg
[rank3]:> Batch Time: 435.79 ms, GPU Bubble Ratio: 51.08%, 47.99%, 61.93%, 17.35%
[rank3]:2025-10-29 06:19:06,504 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0619_stage3_step800.svg
[rank0]:2025-10-29 06:19:07,456 - INFO - Avg. fwd time: 8.2371 / Avg. bwd time: 18.7230 / Avg. batch time: 483.8597 (ms) / GPU bubble ratio: 55.43%
[rank2]:2025-10-29 06:19:07,499 - INFO - Avg. fwd time: 7.7369 / Avg. bwd time: 13.1641 / Avg. batch time: 421.2559 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-29 06:19:07,534 - INFO - Avg. fwd time: 10.0122 / Avg. bwd time: 18.7032 / Avg. batch time: 453.1246 (ms) / GPU bubble ratio: 49.30%
[rank3]:2025-10-29 06:19:07,512 - INFO - Avg. fwd time: 14.2366 / Avg. bwd time: 31.5249 / Avg. batch time: 396.7288 (ms) / GPU bubble ratio: 7.72%
[rank0]:2025-10-29 06:19:26,611 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.1434e+00
[rank1]:2025-10-29 06:19:26,603 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7175e+00
[rank3]:2025-10-29 06:19:26,611 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2244e+00
[rank2]:2025-10-29 06:19:26,599 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.8032e-01
[rank3]:2025-10-29 06:19:29,221 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 06:19:29,513 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 06:19:29,492 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 06:19:29,475 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 06:19:45,677 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3339e+00
[rank0]:2025-10-29 06:19:45,697 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.0734e-01
[rank3]:2025-10-29 06:19:45,693 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.7450e-01
[rank1]:2025-10-29 06:19:45,681 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.2221e-01
[rank1]:2025-10-29 06:20:04,769 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.5000e-01
[rank2]:2025-10-29 06:20:04,764 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3405e-01
[rank0]:2025-10-29 06:20:04,776 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.8271e-01
[rank3]:2025-10-29 06:20:04,776 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.9579e-01
[rank2]:2025-10-29 06:20:24,027 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0116e+00
[rank0]:2025-10-29 06:20:24,046 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6328e+00
[rank3]:2025-10-29 06:20:24,042 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7334e+00
[rank1]:2025-10-29 06:20:24,031 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.7822e+00
[rank0]:2025-10-29 06:20:41,944 - INFO - [GC] Peforming periodical GC collection 0.23 seconds
[rank0]:2025-10-29 06:20:43,909 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.9060e-01
[rank0]:2025-10-29 06:20:43,909 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1223  memory: 13.29GiB(27.97%)  tps: 8,074  tflops: 63.12  mfu: 20.23%
[rank3]:2025-10-29 06:20:43,909 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9446e-01
[rank3]:2025-10-29 06:20:43,911 - INFO -  step: 850  loss:  0.1599  grad_norm:  0.1223  memory: 16.43GiB(34.58%)  tps: 8,076  tflops: 63.14  mfu: 20.24%
[rank1]:2025-10-29 06:20:43,901 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1879e+00
[rank1]:2025-10-29 06:20:43,902 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1223  memory:  9.26GiB(19.50%)  tps: 8,075  tflops: 63.13  mfu: 20.23%
[rank2]:2025-10-29 06:20:43,897 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4643e-01
[rank2]:2025-10-29 06:20:43,898 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1223  memory:  6.43GiB(13.53%)  tps: 8,077  tflops: 63.14  mfu: 20.24%
[rank3]:2025-10-29 06:20:44,079 - INFO - Avg. fwd time: 14.2464 / Avg. bwd time: 31.4679 / Avg. batch time: 396.3207 (ms) / GPU bubble ratio: 7.72%
[rank2]:2025-10-29 06:20:44,104 - INFO - Avg. fwd time: 7.7343 / Avg. bwd time: 13.0701 / Avg. batch time: 420.7472 (ms) / GPU bubble ratio: 60.44%
[rank0]:2025-10-29 06:20:44,131 - INFO - Avg. fwd time: 8.2341 / Avg. bwd time: 18.6006 / Avg. batch time: 483.1115 (ms) / GPU bubble ratio: 55.56%
[rank1]:2025-10-29 06:20:44,164 - INFO - Avg. fwd time: 10.0082 / Avg. bwd time: 18.5902 / Avg. batch time: 452.5018 (ms) / GPU bubble ratio: 49.44%
[rank0]:2025-10-29 06:21:03,032 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.4239e-01
[rank3]:2025-10-29 06:21:03,029 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2098e-01
[rank1]:2025-10-29 06:21:03,017 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.2183e-01
[rank2]:2025-10-29 06:21:03,013 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.6245e-01
[rank2]:2025-10-29 06:21:22,417 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2464e-01
[rank0]:2025-10-29 06:21:22,429 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8560e+00
[rank3]:2025-10-29 06:21:22,429 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4865e-01
[rank1]:2025-10-29 06:21:22,422 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0686e+00
[rank0]:2025-10-29 06:21:41,879 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3910e+00
[rank3]:2025-10-29 06:21:41,875 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9323e+00
[rank1]:2025-10-29 06:21:41,863 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8233e+00
[rank2]:2025-10-29 06:21:41,859 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3859e+00
[rank2]:2025-10-29 06:22:01,175 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1788e+00
[rank0]:2025-10-29 06:22:01,187 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2372e+01
[rank3]:2025-10-29 06:22:01,187 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.6053e+00
[rank1]:2025-10-29 06:22:01,179 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2360e+01
[rank0]:2025-10-29 06:22:18,628 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:22:20,504 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9308e+00
[rank2]:2025-10-29 06:22:20,504 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1068  memory:  6.43GiB(13.53%)  tps: 8,480  tflops: 66.29  mfu: 21.25%
[rank0]:2025-10-29 06:22:20,519 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7371e+00
[rank0]:2025-10-29 06:22:20,519 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1068  memory: 13.29GiB(27.97%)  tps: 8,480  tflops: 66.29  mfu: 21.25%
[rank3]:2025-10-29 06:22:20,519 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9208e+00
[rank3]:2025-10-29 06:22:20,521 - INFO -  step: 900  loss:  0.1353  grad_norm:  0.1068  memory: 16.43GiB(34.58%)  tps: 8,480  tflops: 66.29  mfu: 21.25%
[rank1]:2025-10-29 06:22:20,507 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8088e+00
[rank1]:2025-10-29 06:22:20,512 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1068  memory:  9.26GiB(19.50%)  tps: 8,479  tflops: 66.29  mfu: 21.25%
[rank2]:2025-10-29 06:22:20,599 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0622_stage2_step900.svg
[rank0]:2025-10-29 06:22:20,599 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0622_stage0_step900.svg
[rank1]:2025-10-29 06:22:20,596 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0622_stage1_step900.svg
[rank3]:2025-10-29 06:22:20,705 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0622_real_step900_rank3.svg
[rank3]:> Batch Time: 435.57 ms, GPU Bubble Ratio: 51.08%, 48.01%, 61.93%, 17.35%
[rank3]:2025-10-29 06:22:20,770 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0622_stage3_step900.svg
[rank2]:2025-10-29 06:22:21,190 - INFO - Avg. fwd time: 7.7319 / Avg. bwd time: 12.9702 / Avg. batch time: 420.2276 (ms) / GPU bubble ratio: 60.59%
[rank0]:2025-10-29 06:22:21,240 - INFO - Avg. fwd time: 8.2301 / Avg. bwd time: 18.4775 / Avg. batch time: 482.3387 (ms) / GPU bubble ratio: 55.70%
[rank3]:2025-10-29 06:22:21,169 - INFO - Avg. fwd time: 14.2649 / Avg. bwd time: 31.3989 / Avg. batch time: 395.8805 (ms) / GPU bubble ratio: 7.72%
[rank1]:2025-10-29 06:22:21,217 - INFO - Avg. fwd time: 10.0041 / Avg. bwd time: 18.4732 / Avg. batch time: 451.8642 (ms) / GPU bubble ratio: 49.58%
[rank2]:2025-10-29 06:22:40,222 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5696e+00
[rank0]:2025-10-29 06:22:40,234 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4793e+00
[rank3]:2025-10-29 06:22:40,234 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8168e+00
[rank1]:2025-10-29 06:22:40,226 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.4329e+00
[rank0]:2025-10-29 06:22:59,490 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3151e+00
[rank3]:2025-10-29 06:22:59,493 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2838e+00
[rank1]:2025-10-29 06:22:59,479 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.9366e+00
[rank2]:2025-10-29 06:22:59,475 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5001e+00
[rank2]:2025-10-29 06:23:19,085 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8721e-01
[rank0]:2025-10-29 06:23:19,097 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7094e+00
[rank3]:2025-10-29 06:23:19,097 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0946e-01
[rank1]:2025-10-29 06:23:19,089 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.4642e-01
[rank2]:2025-10-29 06:23:38,214 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.7583e-01
[rank0]:2025-10-29 06:23:38,230 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0766e-01
[rank3]:2025-10-29 06:23:38,230 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.7461e-01
[rank1]:2025-10-29 06:23:38,218 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.1866e-01
[rank0]:2025-10-29 06:23:55,847 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:23:57,776 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6015e+00
[rank3]:2025-10-29 06:23:57,778 - INFO -  step: 950  loss:  0.0839  grad_norm:  0.0843  memory: 16.43GiB(34.58%)  tps: 8,423  tflops: 65.85  mfu: 21.11%
[rank1]:2025-10-29 06:23:57,768 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6176e+00
[rank1]:2025-10-29 06:23:57,773 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0843  memory:  9.26GiB(19.50%)  tps: 8,423  tflops: 65.85  mfu: 21.10%
[rank2]:2025-10-29 06:23:57,764 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1401e+00
[rank2]:2025-10-29 06:23:57,765 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0843  memory:  6.43GiB(13.53%)  tps: 8,423  tflops: 65.85  mfu: 21.11%
[rank0]:2025-10-29 06:23:57,776 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3352e+00
[rank0]:2025-10-29 06:23:57,777 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0843  memory: 13.29GiB(27.97%)  tps: 8,423  tflops: 65.85  mfu: 21.10%
[rank0]:2025-10-29 06:23:57,959 - INFO - Avg. fwd time: 8.2270 / Avg. bwd time: 18.3302 / Avg. batch time: 481.8335 (ms) / GPU bubble ratio: 55.91%
[rank3]:2025-10-29 06:23:57,949 - INFO - Avg. fwd time: 14.2859 / Avg. bwd time: 31.3567 / Avg. batch time: 395.6817 (ms) / GPU bubble ratio: 7.72%
[rank2]:2025-10-29 06:23:57,973 - INFO - Avg. fwd time: 7.7307 / Avg. bwd time: 12.9115 / Avg. batch time: 419.9521 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-29 06:23:58,034 - INFO - Avg. fwd time: 10.0021 / Avg. bwd time: 18.4019 / Avg. batch time: 451.5163 (ms) / GPU bubble ratio: 49.67%
[rank3]:2025-10-29 06:24:17,100 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9517e+00
[rank1]:2025-10-29 06:24:17,088 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4145e+00
[rank2]:2025-10-29 06:24:17,084 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9119e-01
[rank0]:2025-10-29 06:24:17,099 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5026e-01
[rank1]:2025-10-29 06:24:36,237 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5357e+00
[rank2]:2025-10-29 06:24:36,233 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5018e+00
[rank0]:2025-10-29 06:24:36,245 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0498e+00
[rank3]:2025-10-29 06:24:36,245 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0931e+00
[rank1]:2025-10-29 06:24:55,147 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5754e+00
[rank2]:2025-10-29 06:24:55,143 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6767e+00
[rank0]:2025-10-29 06:24:55,159 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6559e+00
[rank3]:2025-10-29 06:24:55,159 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8155e+00
[rank3]:2025-10-29 06:25:14,179 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0289e-01
[rank1]:2025-10-29 06:25:14,171 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3747e+00
[rank2]:2025-10-29 06:25:14,167 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8365e-01
[rank0]:2025-10-29 06:25:14,178 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.7432e-01
[rank0]:2025-10-29 06:25:31,114 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:25:32,993 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4654e+00
[rank3]:2025-10-29 06:25:32,995 - INFO -  step: 1000  loss:  0.1123  grad_norm:  0.0807  memory: 16.43GiB(34.58%)  tps: 8,604  tflops: 67.26  mfu: 21.56%
[rank3]:2025-10-29 06:25:32,995 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 06:25:32,981 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3467e+00
[rank1]:2025-10-29 06:25:32,982 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0807  memory:  9.26GiB(19.50%)  tps: 8,604  tflops: 67.26  mfu: 21.56%
[rank1]:2025-10-29 06:25:32,982 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 06:25:32,977 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0631e+00
[rank2]:2025-10-29 06:25:32,978 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0807  memory:  6.43GiB(13.53%)  tps: 8,605  tflops: 67.27  mfu: 21.56%
[rank2]:2025-10-29 06:25:32,978 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 06:25:32,993 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0133e+00
[rank0]:2025-10-29 06:25:32,993 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0807  memory: 13.29GiB(27.97%)  tps: 8,604  tflops: 67.26  mfu: 21.56%
[rank0]:2025-10-29 06:25:32,993 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 06:25:48,161 - INFO - validate step: 1000  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,978
[rank0]:2025-10-29 06:25:48,133 - INFO - validate step: 1000  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,055
[rank3]:2025-10-29 06:25:48,166 - INFO - validate step: 1000  loss:  0.2952  memory: 16.43GiB(34.58%)  tps: 27,002
[rank1]:2025-10-29 06:25:48,146 - INFO - validate step: 1000  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 27,011
[rank2]:2025-10-29 06:25:48,248 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0625_stage2_step1000.svg
[rank0]:2025-10-29 06:25:48,249 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0625_stage0_step1000.svg
[rank1]:2025-10-29 06:25:48,246 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0625_stage1_step1000.svg
[rank3]:2025-10-29 06:25:48,356 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0625_real_step1000_rank3.svg
[rank3]:> Batch Time: 435.52 ms, GPU Bubble Ratio: 51.50%, 48.04%, 61.95%, 17.35%
[rank3]:2025-10-29 06:25:48,423 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0625_stage3_step1000.svg
[rank0]:2025-10-29 06:25:48,581 - INFO - Avg. fwd time: 8.2228 / Avg. bwd time: 18.1750 / Avg. batch time: 480.8402 (ms) / GPU bubble ratio: 56.08%
[rank3]:2025-10-29 06:25:48,601 - INFO - Avg. fwd time: 14.2825 / Avg. bwd time: 31.2840 / Avg. batch time: 395.0415 (ms) / GPU bubble ratio: 7.72%
[rank2]:2025-10-29 06:25:48,616 - INFO - Avg. fwd time: 7.7285 / Avg. bwd time: 12.8366 / Avg. batch time: 419.2174 (ms) / GPU bubble ratio: 60.76%
[rank1]:2025-10-29 06:25:48,650 - INFO - Avg. fwd time: 9.9987 / Avg. bwd time: 18.3136 / Avg. batch time: 450.6897 (ms) / GPU bubble ratio: 49.74%
[rank2]:2025-10-29 06:26:07,491 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9884e+00
[rank0]:2025-10-29 06:26:07,503 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6785e+00
[rank3]:2025-10-29 06:26:07,503 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7938e+00
[rank1]:2025-10-29 06:26:07,496 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3759e+00
[rank2]:2025-10-29 06:26:26,202 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9785e+00
[rank0]:2025-10-29 06:26:26,218 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2809e-01
[rank3]:2025-10-29 06:26:26,221 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9802e+00
[rank1]:2025-10-29 06:26:26,206 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8842e+00
[rank1]:2025-10-29 06:26:45,304 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2562e+00
[rank2]:2025-10-29 06:26:45,302 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4208e+00
[rank0]:2025-10-29 06:26:45,312 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9467e+00
[rank3]:2025-10-29 06:26:45,312 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7474e+00
[rank2]:2025-10-29 06:27:04,078 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9301e+00
[rank0]:2025-10-29 06:27:04,093 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6816e+00
[rank3]:2025-10-29 06:27:04,099 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1692e+00
[rank1]:2025-10-29 06:27:04,082 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4660e+00
[rank0]:2025-10-29 06:27:21,087 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:27:23,005 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4037e-01
[rank2]:2025-10-29 06:27:23,006 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1014  memory:  6.43GiB(13.53%)  tps: 8,637  tflops: 67.52  mfu: 21.64%
[rank0]:2025-10-29 06:27:23,017 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1165e+00
[rank0]:2025-10-29 06:27:23,017 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1014  memory: 13.29GiB(27.97%)  tps: 8,634  tflops: 67.49  mfu: 21.63%
[rank3]:2025-10-29 06:27:23,017 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.2222e-01
[rank3]:2025-10-29 06:27:23,019 - INFO -  step: 1050  loss:  0.1070  grad_norm:  0.1014  memory: 16.43GiB(34.58%)  tps: 8,637  tflops: 67.52  mfu: 21.64%
[rank1]:2025-10-29 06:27:23,010 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.7021e-01
[rank1]:2025-10-29 06:27:23,010 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1014  memory:  9.26GiB(19.50%)  tps: 8,636  tflops: 67.51  mfu: 21.64%
[rank3]:2025-10-29 06:27:23,444 - INFO - Avg. fwd time: 14.2662 / Avg. bwd time: 31.2030 / Avg. batch time: 394.2338 (ms) / GPU bubble ratio: 7.73%
[rank2]:2025-10-29 06:27:23,463 - INFO - Avg. fwd time: 7.7266 / Avg. bwd time: 12.7839 / Avg. batch time: 418.3757 (ms) / GPU bubble ratio: 60.78%
[rank0]:2025-10-29 06:27:23,513 - INFO - Avg. fwd time: 8.2191 / Avg. bwd time: 18.0348 / Avg. batch time: 479.7843 (ms) / GPU bubble ratio: 56.22%
[rank1]:2025-10-29 06:27:23,488 - INFO - Avg. fwd time: 9.9963 / Avg. bwd time: 18.2495 / Avg. batch time: 449.7815 (ms) / GPU bubble ratio: 49.76%
[rank1]:2025-10-29 06:27:42,068 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3969e+00
[rank2]:2025-10-29 06:27:42,064 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.6083e-01
[rank0]:2025-10-29 06:27:42,079 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9340e+00
[rank3]:2025-10-29 06:27:42,084 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0934e+00
[rank1]:2025-10-29 06:28:01,395 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.7616e-01
[rank2]:2025-10-29 06:28:01,391 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7310e-01
[rank0]:2025-10-29 06:28:01,403 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3879e+00
[rank3]:2025-10-29 06:28:01,409 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2359e-01
[rank2]:2025-10-29 06:28:20,173 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9107e+00
[rank0]:2025-10-29 06:28:20,188 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0429e+00
[rank3]:2025-10-29 06:28:20,189 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6044e+00
[rank1]:2025-10-29 06:28:20,177 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3714e+00
[rank0]:2025-10-29 06:28:39,441 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4043e+00
[rank3]:2025-10-29 06:28:39,441 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9246e+00
[rank1]:2025-10-29 06:28:39,433 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0826e+00
[rank2]:2025-10-29 06:28:39,429 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4307e+00
[rank0]:2025-10-29 06:28:56,289 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:28:58,221 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1804e+00
[rank2]:2025-10-29 06:28:58,221 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0871  memory:  6.43GiB(13.53%)  tps: 8,604  tflops: 67.26  mfu: 21.56%
[rank0]:2025-10-29 06:28:58,236 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8083e+00
[rank0]:2025-10-29 06:28:58,237 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0871  memory: 13.29GiB(27.97%)  tps: 8,603  tflops: 67.26  mfu: 21.56%
[rank3]:2025-10-29 06:28:58,236 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1581e+00
[rank3]:2025-10-29 06:28:58,238 - INFO -  step: 1100  loss:  0.1321  grad_norm:  0.0871  memory: 16.43GiB(34.58%)  tps: 8,603  tflops: 67.26  mfu: 21.56%
[rank1]:2025-10-29 06:28:58,224 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.4488e-01
[rank1]:2025-10-29 06:28:58,225 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0871  memory:  9.26GiB(19.50%)  tps: 8,604  tflops: 67.26  mfu: 21.56%
[rank2]:2025-10-29 06:28:58,323 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0628_stage2_step1100.svg
[rank0]:2025-10-29 06:28:58,321 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0628_stage0_step1100.svg
[rank1]:2025-10-29 06:28:58,318 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0628_stage1_step1100.svg
[rank3]:2025-10-29 06:28:58,430 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0628_real_step1100_rank3.svg
[rank3]:> Batch Time: 434.83 ms, GPU Bubble Ratio: 51.73%, 47.98%, 62.25%, 17.37%
[rank3]:2025-10-29 06:28:58,498 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0628_stage3_step1100.svg
[rank0]:2025-10-29 06:28:58,661 - INFO - Avg. fwd time: 8.2163 / Avg. bwd time: 17.9256 / Avg. batch time: 479.0628 (ms) / GPU bubble ratio: 56.34%
[rank2]:2025-10-29 06:28:58,708 - INFO - Avg. fwd time: 7.7253 / Avg. bwd time: 12.7278 / Avg. batch time: 417.8383 (ms) / GPU bubble ratio: 60.84%
[rank3]:2025-10-29 06:28:58,687 - INFO - Avg. fwd time: 14.2624 / Avg. bwd time: 31.1511 / Avg. batch time: 393.7668 (ms) / GPU bubble ratio: 7.74%
[rank1]:2025-10-29 06:28:58,745 - INFO - Avg. fwd time: 9.9946 / Avg. bwd time: 18.1841 / Avg. batch time: 449.1766 (ms) / GPU bubble ratio: 49.81%
[rank2]:2025-10-29 06:29:17,564 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7352e-01
[rank0]:2025-10-29 06:29:17,576 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2692e+00
[rank3]:2025-10-29 06:29:17,580 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1712e+00
[rank1]:2025-10-29 06:29:17,568 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0131e+00
[rank1]:2025-10-29 06:29:36,533 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6293e+00
[rank2]:2025-10-29 06:29:36,529 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6954e-01
[rank0]:2025-10-29 06:29:36,544 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8083e+00
[rank3]:2025-10-29 06:29:36,545 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9728e-01
[rank0]:2025-10-29 06:29:55,542 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9118e+00
[rank3]:2025-10-29 06:29:55,549 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6007e-01
[rank1]:2025-10-29 06:29:55,534 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5579e+00
[rank2]:2025-10-29 06:29:55,530 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8746e-01
[rank2]:2025-10-29 06:30:14,728 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.2857e-01
[rank0]:2025-10-29 06:30:14,744 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2139e-01
[rank3]:2025-10-29 06:30:14,744 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4839e-01
[rank1]:2025-10-29 06:30:14,732 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.0305e-01
[rank0]:2025-10-29 06:30:32,255 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:30:34,229 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9842e-02
[rank2]:2025-10-29 06:30:34,229 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1075  memory:  6.43GiB(13.53%)  tps: 8,533  tflops: 66.70  mfu: 21.38%
[rank0]:2025-10-29 06:30:34,240 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6909e-01
[rank0]:2025-10-29 06:30:34,241 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1075  memory: 13.29GiB(27.97%)  tps: 8,533  tflops: 66.71  mfu: 21.38%
[rank3]:2025-10-29 06:30:34,240 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7130e-01
[rank3]:2025-10-29 06:30:34,242 - INFO -  step: 1150  loss:  0.1056  grad_norm:  0.1075  memory: 16.43GiB(34.58%)  tps: 8,533  tflops: 66.71  mfu: 21.38%
[rank1]:2025-10-29 06:30:34,233 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.8233e-01
[rank1]:2025-10-29 06:30:34,233 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1075  memory:  9.26GiB(19.50%)  tps: 8,533  tflops: 66.70  mfu: 21.38%
[rank2]:2025-10-29 06:30:34,443 - INFO - Avg. fwd time: 7.7240 / Avg. bwd time: 12.6793 / Avg. batch time: 417.3673 (ms) / GPU bubble ratio: 60.89%
[rank0]:2025-10-29 06:30:34,428 - INFO - Avg. fwd time: 8.2135 / Avg. bwd time: 17.8094 / Avg. batch time: 478.4085 (ms) / GPU bubble ratio: 56.48%
[rank3]:2025-10-29 06:30:34,425 - INFO - Avg. fwd time: 14.2611 / Avg. bwd time: 31.1004 / Avg. batch time: 393.3277 (ms) / GPU bubble ratio: 7.74%
[rank1]:2025-10-29 06:30:34,505 - INFO - Avg. fwd time: 9.9930 / Avg. bwd time: 18.1263 / Avg. batch time: 448.6465 (ms) / GPU bubble ratio: 49.86%
[rank1]:2025-10-29 06:30:53,437 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.9621e+00
[rank2]:2025-10-29 06:30:53,433 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7971e+00
[rank0]:2025-10-29 06:30:53,448 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1930e+00
[rank3]:2025-10-29 06:30:53,449 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5571e+00
[rank2]:2025-10-29 06:31:13,006 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8591e-01
[rank0]:2025-10-29 06:31:13,018 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6128e+00
[rank3]:2025-10-29 06:31:13,018 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7865e+00
[rank1]:2025-10-29 06:31:13,010 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2889e+00
[rank2]:2025-10-29 06:31:31,845 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.3669e-01
[rank3]:2025-10-29 06:31:31,861 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7333e-01
[rank0]:2025-10-29 06:31:31,861 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7477e-01
[rank1]:2025-10-29 06:31:31,849 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.9678e-01
[rank2]:2025-10-29 06:31:51,065 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1630e-01
[rank3]:2025-10-29 06:31:51,084 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8446e-01
[rank0]:2025-10-29 06:31:51,077 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0348e+00
[rank1]:2025-10-29 06:31:51,069 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5048e-01
[rank0]:2025-10-29 06:32:08,103 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:32:10,024 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.4874e-01
[rank1]:2025-10-29 06:32:10,024 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1227  memory:  9.26GiB(19.50%)  tps: 8,552  tflops: 66.86  mfu: 21.43%
[rank1]:2025-10-29 06:32:10,025 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 06:32:10,020 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.9512e-01
[rank2]:2025-10-29 06:32:10,021 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1227  memory:  6.43GiB(13.53%)  tps: 8,552  tflops: 66.86  mfu: 21.43%
[rank2]:2025-10-29 06:32:10,021 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 06:32:10,041 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2775e-01
[rank3]:2025-10-29 06:32:10,043 - INFO -  step: 1200  loss:  0.1349  grad_norm:  0.1227  memory: 16.43GiB(34.58%)  tps: 8,551  tflops: 66.85  mfu: 21.43%
[rank3]:2025-10-29 06:32:10,043 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:32:10,035 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3027e+00
[rank0]:2025-10-29 06:32:10,036 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1227  memory: 13.29GiB(27.97%)  tps: 8,552  tflops: 66.85  mfu: 21.43%
[rank0]:2025-10-29 06:32:10,036 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:32:25,139 - INFO - validate step: 1200  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,121
[rank1]:2025-10-29 06:32:25,151 - INFO - validate step: 1200  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 27,079
[rank2]:2025-10-29 06:32:25,165 - INFO - validate step: 1200  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 27,046
[rank3]:2025-10-29 06:32:25,172 - INFO - validate step: 1200  loss:  0.2956  memory: 16.43GiB(34.58%)  tps: 27,077
[rank1]:2025-10-29 06:32:25,253 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0632_stage1_step1200.svg
[rank2]:2025-10-29 06:32:25,257 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0632_stage2_step1200.svg
[rank0]:2025-10-29 06:32:25,257 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0632_stage0_step1200.svg
[rank3]:2025-10-29 06:32:25,364 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0632_real_step1200_rank3.svg
[rank3]:> Batch Time: 434.72 ms, GPU Bubble Ratio: 51.81%, 47.99%, 62.26%, 17.36%
[rank3]:2025-10-29 06:32:25,434 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0632_stage3_step1200.svg
[rank2]:2025-10-29 06:32:25,877 - INFO - Avg. fwd time: 7.7233 / Avg. bwd time: 12.6225 / Avg. batch time: 417.0241 (ms) / GPU bubble ratio: 60.97%
[rank3]:2025-10-29 06:32:25,852 - INFO - Avg. fwd time: 14.2666 / Avg. bwd time: 31.0597 / Avg. batch time: 393.0246 (ms) / GPU bubble ratio: 7.74%
[rank0]:2025-10-29 06:32:25,929 - INFO - Avg. fwd time: 8.2113 / Avg. bwd time: 17.7035 / Avg. batch time: 477.8890 (ms) / GPU bubble ratio: 56.62%
[rank1]:2025-10-29 06:32:25,905 - INFO - Avg. fwd time: 9.9919 / Avg. bwd time: 18.0609 / Avg. batch time: 448.2382 (ms) / GPU bubble ratio: 49.93%
[rank2]:2025-10-29 06:32:44,536 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8496e-01
[rank3]:2025-10-29 06:32:44,548 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.6503e-01
[rank0]:2025-10-29 06:32:44,547 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6055e+00
[rank1]:2025-10-29 06:32:44,540 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.3404e-01
[rank2]:2025-10-29 06:33:03,546 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.2136e-01
[rank3]:2025-10-29 06:33:03,562 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2879e-01
[rank0]:2025-10-29 06:33:03,562 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9087e-01
[rank1]:2025-10-29 06:33:03,550 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4214e-01
[rank2]:2025-10-29 06:33:22,871 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0970e+00
[rank3]:2025-10-29 06:33:22,883 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0008e+00
[rank0]:2025-10-29 06:33:22,883 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3427e+00
[rank1]:2025-10-29 06:33:22,876 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8497e+00
[rank2]:2025-10-29 06:33:41,998 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4792e+00
[rank3]:2025-10-29 06:33:42,014 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0999e+00
[rank0]:2025-10-29 06:33:42,014 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4294e+00
[rank1]:2025-10-29 06:33:42,002 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.3549e+00
[rank0]:2025-10-29 06:33:59,615 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 06:34:01,489 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.4106e+00
[rank1]:2025-10-29 06:34:01,493 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1044  memory:  9.26GiB(19.50%)  tps: 8,503  tflops: 66.47  mfu: 21.31%
[rank2]:2025-10-29 06:34:01,485 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6222e+00
[rank2]:2025-10-29 06:34:01,485 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1044  memory:  6.43GiB(13.53%)  tps: 8,505  tflops: 66.49  mfu: 21.31%
[rank3]:2025-10-29 06:34:01,497 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5119e+00
[rank3]:2025-10-29 06:34:01,499 - INFO -  step: 1250  loss:  0.1298  grad_norm:  0.1044  memory: 16.43GiB(34.58%)  tps: 8,504  tflops: 66.48  mfu: 21.31%
[rank0]:2025-10-29 06:34:01,496 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4178e+00
[rank0]:2025-10-29 06:34:01,497 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1044  memory: 13.29GiB(27.97%)  tps: 8,502  tflops: 66.46  mfu: 21.30%
[rank2]:2025-10-29 06:34:01,693 - INFO - Avg. fwd time: 7.7223 / Avg. bwd time: 12.5914 / Avg. batch time: 416.7013 (ms) / GPU bubble ratio: 61.00%
[rank3]:2025-10-29 06:34:01,674 - INFO - Avg. fwd time: 14.2680 / Avg. bwd time: 31.0255 / Avg. batch time: 392.7464 (ms) / GPU bubble ratio: 7.74%
[rank0]:2025-10-29 06:34:01,681 - INFO - Avg. fwd time: 8.2093 / Avg. bwd time: 17.6200 / Avg. batch time: 477.4387 (ms) / GPU bubble ratio: 56.72%
[rank1]:2025-10-29 06:34:01,752 - INFO - Avg. fwd time: 9.9906 / Avg. bwd time: 18.0230 / Avg. batch time: 447.8766 (ms) / GPU bubble ratio: 49.96%
[rank2]:2025-10-29 06:34:20,550 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2587e+00
[rank3]:2025-10-29 06:34:20,566 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1568e-01
[rank0]:2025-10-29 06:34:20,566 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8134e+00
[rank1]:2025-10-29 06:34:20,554 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.4244e-01
[rank1]:2025-10-29 06:34:39,952 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3365e+00
[rank2]:2025-10-29 06:34:39,948 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6358e+00
[rank3]:2025-10-29 06:34:39,960 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.6433e+00
[rank0]:2025-10-29 06:34:39,959 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5269e+00
[rank1]:2025-10-29 06:34:59,249 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6069e+00
[rank2]:2025-10-29 06:34:59,245 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9026e+00
[rank3]:2025-10-29 06:34:59,268 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8097e+00
[rank0]:2025-10-29 06:34:59,261 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8552e+00
[rank0]:2025-10-29 06:35:18,576 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8877e+00
[rank1]:2025-10-29 06:35:18,568 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0132e+00
[rank2]:2025-10-29 06:35:18,565 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5166e-01
[rank3]:2025-10-29 06:35:18,576 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1446e+00
[rank0]:2025-10-29 06:35:36,004 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:35:37,901 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.0355e-01
[rank1]:2025-10-29 06:35:37,901 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1083  memory:  9.26GiB(19.50%)  tps: 8,497  tflops: 66.43  mfu: 21.29%
[rank2]:2025-10-29 06:35:37,897 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.8592e-01
[rank2]:2025-10-29 06:35:37,898 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1083  memory:  6.43GiB(13.53%)  tps: 8,498  tflops: 66.43  mfu: 21.29%
[rank3]:2025-10-29 06:35:37,913 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2408e+00
[rank3]:2025-10-29 06:35:37,914 - INFO -  step: 1300  loss:  0.1208  grad_norm:  0.1083  memory: 16.43GiB(34.58%)  tps: 8,497  tflops: 66.42  mfu: 21.29%
[rank0]:2025-10-29 06:35:37,912 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4598e+00
[rank0]:2025-10-29 06:35:37,913 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1083  memory: 13.29GiB(27.97%)  tps: 8,497  tflops: 66.42  mfu: 21.29%
[rank0]:2025-10-29 06:35:38,001 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0635_stage0_step1300.svg
[rank1]:2025-10-29 06:35:37,998 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0635_stage1_step1300.svg
[rank2]:2025-10-29 06:35:38,008 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0635_stage2_step1300.svg
[rank3]:2025-10-29 06:35:38,109 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0635_real_step1300_rank3.svg
[rank3]:> Batch Time: 432.01 ms, GPU Bubble Ratio: 55.96%, 48.21%, 62.04%, 16.83%
[rank3]:2025-10-29 06:35:38,182 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0635_stage3_step1300.svg
[rank3]:2025-10-29 06:35:38,356 - INFO - Avg. fwd time: 14.2803 / Avg. bwd time: 30.9981 / Avg. batch time: 392.6085 (ms) / GPU bubble ratio: 7.74%
[rank0]:2025-10-29 06:35:38,345 - INFO - Avg. fwd time: 8.2073 / Avg. bwd time: 17.5296 / Avg. batch time: 477.0926 (ms) / GPU bubble ratio: 56.84%
[rank1]:2025-10-29 06:35:38,427 - INFO - Avg. fwd time: 9.9893 / Avg. bwd time: 17.9711 / Avg. batch time: 447.6275 (ms) / GPU bubble ratio: 50.03%
[rank2]:2025-10-29 06:35:38,394 - INFO - Avg. fwd time: 7.7216 / Avg. bwd time: 12.5474 / Avg. batch time: 416.5054 (ms) / GPU bubble ratio: 61.07%
[rank3]:2025-10-29 06:35:57,216 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9223e-01
[rank0]:2025-10-29 06:35:57,215 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7028e-01
[rank1]:2025-10-29 06:35:57,208 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8601e-01
[rank2]:2025-10-29 06:35:57,204 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5541e-01
[rank3]:2025-10-29 06:36:16,337 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2918e+00
[rank0]:2025-10-29 06:36:16,337 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4137e-01
[rank1]:2025-10-29 06:36:16,325 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3455e+00
[rank2]:2025-10-29 06:36:16,321 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2159e+00
[rank1]:2025-10-29 06:36:35,920 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.2439e-01
[rank2]:2025-10-29 06:36:35,915 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4845e-01
[rank3]:2025-10-29 06:36:35,927 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.0112e-01
[rank0]:2025-10-29 06:36:35,927 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4168e+00
[rank1]:2025-10-29 06:36:54,909 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3454e+00
[rank2]:2025-10-29 06:36:54,906 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0201e+00
[rank3]:2025-10-29 06:36:54,921 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7868e+00
[rank0]:2025-10-29 06:36:54,921 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0605e+00
[rank0]:2025-10-29 06:37:12,446 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:37:14,383 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2423e-01
[rank2]:2025-10-29 06:37:14,383 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1002  memory:  6.43GiB(13.53%)  tps: 8,490  tflops: 66.37  mfu: 21.27%
[rank3]:2025-10-29 06:37:14,394 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2141e+00
[rank3]:2025-10-29 06:37:14,396 - INFO -  step: 1350  loss:  0.1481  grad_norm:  0.1002  memory: 16.43GiB(34.58%)  tps: 8,491  tflops: 66.38  mfu: 21.27%
[rank0]:2025-10-29 06:37:14,394 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.7658e-01
[rank0]:2025-10-29 06:37:14,395 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1002  memory: 13.29GiB(27.97%)  tps: 8,491  tflops: 66.38  mfu: 21.27%
[rank1]:2025-10-29 06:37:14,387 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7271e+00
[rank1]:2025-10-29 06:37:14,387 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1002  memory:  9.26GiB(19.50%)  tps: 8,490  tflops: 66.37  mfu: 21.27%
[rank3]:2025-10-29 06:37:14,821 - INFO - Avg. fwd time: 14.2876 / Avg. bwd time: 30.9657 / Avg. batch time: 392.3920 (ms) / GPU bubble ratio: 7.74%
[rank1]:2025-10-29 06:37:14,867 - INFO - Avg. fwd time: 9.9869 / Avg. bwd time: 17.9331 / Avg. batch time: 447.3586 (ms) / GPU bubble ratio: 50.07%
[rank2]:2025-10-29 06:37:14,842 - INFO - Avg. fwd time: 7.7201 / Avg. bwd time: 12.5171 / Avg. batch time: 416.2746 (ms) / GPU bubble ratio: 61.11%
[rank0]:2025-10-29 06:37:14,893 - INFO - Avg. fwd time: 8.2046 / Avg. bwd time: 17.4454 / Avg. batch time: 476.7346 (ms) / GPU bubble ratio: 56.96%
[rank1]:2025-10-29 06:37:33,687 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.8850e-01
[rank2]:2025-10-29 06:37:33,683 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.1324e-01
[rank3]:2025-10-29 06:37:33,699 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0195e+00
[rank0]:2025-10-29 06:37:33,699 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3196e+00
[rank1]:2025-10-29 06:37:53,003 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4710e+00
[rank2]:2025-10-29 06:37:52,999 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2861e-01
[rank3]:2025-10-29 06:37:53,011 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7893e+00
[rank0]:2025-10-29 06:37:53,011 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2310e+00
[rank2]:2025-10-29 06:38:12,069 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.1841e-01
[rank0]:2025-10-29 06:38:12,084 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8726e-01
[rank3]:2025-10-29 06:38:12,085 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1289e+00
[rank1]:2025-10-29 06:38:12,072 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.3925e-01
[rank3]:2025-10-29 06:38:31,140 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0929e-01
[rank1]:2025-10-29 06:38:31,130 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.5781e-01
[rank2]:2025-10-29 06:38:31,126 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3069e-01
[rank0]:2025-10-29 06:38:31,138 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7419e+00
[rank0]:2025-10-29 06:38:48,023 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:38:49,892 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7172e+00
[rank1]:2025-10-29 06:38:49,892 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0728  memory:  9.26GiB(19.50%)  tps: 8,578  tflops: 67.06  mfu: 21.49%
[rank1]:2025-10-29 06:38:49,892 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 06:38:49,888 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7087e+00
[rank2]:2025-10-29 06:38:49,888 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0728  memory:  6.43GiB(13.53%)  tps: 8,578  tflops: 67.06  mfu: 21.49%
[rank2]:2025-10-29 06:38:49,888 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 06:38:49,903 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4968e+00
[rank0]:2025-10-29 06:38:49,904 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0728  memory: 13.29GiB(27.97%)  tps: 8,577  tflops: 67.05  mfu: 21.49%
[rank0]:2025-10-29 06:38:49,904 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 06:38:49,904 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7142e+00
[rank3]:2025-10-29 06:38:49,906 - INFO -  step: 1400  loss:  0.0968  grad_norm:  0.0728  memory: 16.43GiB(34.58%)  tps: 8,577  tflops: 67.05  mfu: 21.49%
[rank3]:2025-10-29 06:38:49,906 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 06:39:05,031 - INFO - validate step: 1400  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,079
[rank3]:2025-10-29 06:39:05,064 - INFO - validate step: 1400  loss:  0.2942  memory: 16.43GiB(34.58%)  tps: 27,023
[rank1]:2025-10-29 06:39:05,044 - INFO - validate step: 1400  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 27,035
[rank2]:2025-10-29 06:39:05,058 - INFO - validate step: 1400  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 27,002
[rank0]:2025-10-29 06:39:05,155 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0639_stage0_step1400.svg
[rank1]:2025-10-29 06:39:05,153 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0639_stage1_step1400.svg
[rank2]:2025-10-29 06:39:05,154 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0639_stage2_step1400.svg
[rank3]:2025-10-29 06:39:05,259 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0639_real_step1400_rank3.svg
[rank3]:> Batch Time: 431.88 ms, GPU Bubble Ratio: 56.00%, 48.23%, 62.03%, 16.82%
[rank3]:2025-10-29 06:39:05,331 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0639_stage3_step1400.svg
[rank2]:2025-10-29 06:39:05,532 - INFO - Avg. fwd time: 7.7193 / Avg. bwd time: 12.4815 / Avg. batch time: 416.0110 (ms) / GPU bubble ratio: 61.15%
[rank0]:2025-10-29 06:39:05,491 - INFO - Avg. fwd time: 8.2029 / Avg. bwd time: 17.3785 / Avg. batch time: 476.3559 (ms) / GPU bubble ratio: 57.04%
[rank3]:2025-10-29 06:39:05,503 - INFO - Avg. fwd time: 14.2897 / Avg. bwd time: 30.9382 / Avg. batch time: 392.1755 (ms) / GPU bubble ratio: 7.74%
[rank1]:2025-10-29 06:39:05,566 - INFO - Avg. fwd time: 9.9855 / Avg. bwd time: 17.8914 / Avg. batch time: 447.0520 (ms) / GPU bubble ratio: 50.11%
[rank3]:2025-10-29 06:39:24,511 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5737e+00
[rank1]:2025-10-29 06:39:24,503 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8107e+00
[rank2]:2025-10-29 06:39:24,499 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1047e+00
[rank0]:2025-10-29 06:39:24,511 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8942e+00
[rank2]:2025-10-29 06:39:43,186 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2698e+00
[rank0]:2025-10-29 06:39:43,202 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4327e-01
[rank3]:2025-10-29 06:39:43,202 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1199e-01
[rank1]:2025-10-29 06:39:43,190 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0796e+00
[rank1]:2025-10-29 06:40:02,278 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.9250e+00
[rank2]:2025-10-29 06:40:02,274 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3062e+00
[rank0]:2025-10-29 06:40:02,286 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0484e+00
[rank3]:2025-10-29 06:40:02,286 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7374e+00
[rank2]:2025-10-29 06:40:21,438 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8817e-01
[rank0]:2025-10-29 06:40:21,454 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.4653e-01
[rank3]:2025-10-29 06:40:21,454 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.9758e-01
[rank1]:2025-10-29 06:40:21,442 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.5127e-01
[rank0]:2025-10-29 06:40:38,935 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 06:40:40,898 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0556e+00
[rank0]:2025-10-29 06:40:40,899 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1007  memory: 13.29GiB(27.97%)  tps: 8,545  tflops: 66.80  mfu: 21.41%
[rank3]:2025-10-29 06:40:40,899 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8903e-01
[rank3]:2025-10-29 06:40:40,900 - INFO -  step: 1450  loss:  0.1028  grad_norm:  0.1007  memory: 16.43GiB(34.58%)  tps: 8,548  tflops: 66.82  mfu: 21.42%
[rank1]:2025-10-29 06:40:40,891 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5136e+00
[rank1]:2025-10-29 06:40:40,895 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1007  memory:  9.26GiB(19.50%)  tps: 8,547  tflops: 66.81  mfu: 21.41%
[rank2]:2025-10-29 06:40:40,887 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3829e-01
[rank2]:2025-10-29 06:40:40,887 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1007  memory:  6.43GiB(13.53%)  tps: 8,549  tflops: 66.83  mfu: 21.42%
[rank0]:2025-10-29 06:40:41,088 - INFO - Avg. fwd time: 8.2009 / Avg. bwd time: 17.3064 / Avg. batch time: 475.8701 (ms) / GPU bubble ratio: 57.12%
[rank3]:2025-10-29 06:40:41,079 - INFO - Avg. fwd time: 14.2849 / Avg. bwd time: 30.9005 / Avg. batch time: 391.8204 (ms) / GPU bubble ratio: 7.74%
[rank2]:2025-10-29 06:40:41,104 - INFO - Avg. fwd time: 7.7185 / Avg. bwd time: 12.4523 / Avg. batch time: 415.6394 (ms) / GPU bubble ratio: 61.18%
[rank1]:2025-10-29 06:40:41,164 - INFO - Avg. fwd time: 9.9844 / Avg. bwd time: 17.8562 / Avg. batch time: 446.6436 (ms) / GPU bubble ratio: 50.13%
[rank3]:2025-10-29 06:41:00,245 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3385e+00
[rank1]:2025-10-29 06:41:00,233 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1305e+00
[rank2]:2025-10-29 06:41:00,230 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1633e+00
[rank0]:2025-10-29 06:41:00,245 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9343e-01
[rank1]:2025-10-29 06:41:19,686 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5605e+00
[rank2]:2025-10-29 06:41:19,682 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9940e-01
[rank0]:2025-10-29 06:41:19,693 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4201e+00
[rank3]:2025-10-29 06:41:19,694 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0156e-01
[rank1]:2025-10-29 06:41:38,926 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.4319e+00
[rank2]:2025-10-29 06:41:38,922 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4763e+00
[rank0]:2025-10-29 06:41:38,938 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0842e+00
[rank3]:2025-10-29 06:41:38,938 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8168e+00
[rank1]:2025-10-29 06:41:58,450 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1116e+00
[rank2]:2025-10-29 06:41:58,447 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3615e-01
[rank0]:2025-10-29 06:41:58,458 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5799e-01
[rank3]:2025-10-29 06:41:58,459 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6124e-01
[rank0]:2025-10-29 06:42:15,417 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:42:17,341 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.5962e-01
[rank3]:2025-10-29 06:42:17,343 - INFO -  step: 1500  loss:  0.1362  grad_norm:  0.0931  memory: 16.43GiB(34.58%)  tps: 8,494  tflops: 66.40  mfu: 21.28%
[rank1]:2025-10-29 06:42:17,329 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0230e-01
[rank1]:2025-10-29 06:42:17,329 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0931  memory:  9.26GiB(19.50%)  tps: 8,495  tflops: 66.41  mfu: 21.29%
[rank2]:2025-10-29 06:42:17,325 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4247e+00
[rank2]:2025-10-29 06:42:17,326 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0931  memory:  6.43GiB(13.53%)  tps: 8,495  tflops: 66.41  mfu: 21.29%
[rank0]:2025-10-29 06:42:17,341 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5289e+00
[rank0]:2025-10-29 06:42:17,341 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0931  memory: 13.29GiB(27.97%)  tps: 8,494  tflops: 66.40  mfu: 21.28%
[rank1]:2025-10-29 06:42:17,429 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0642_stage1_step1500.svg
[rank2]:2025-10-29 06:42:17,432 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0642_stage2_step1500.svg
[rank0]:2025-10-29 06:42:17,431 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0642_stage0_step1500.svg
[rank3]:2025-10-29 06:42:17,533 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0642_real_step1500_rank3.svg
[rank3]:> Batch Time: 431.79 ms, GPU Bubble Ratio: 56.02%, 48.23%, 62.03%, 16.82%
[rank3]:2025-10-29 06:42:17,605 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0642_stage3_step1500.svg
[rank3]:2025-10-29 06:42:18,007 - INFO - Avg. fwd time: 14.2948 / Avg. bwd time: 30.8808 / Avg. batch time: 391.7294 (ms) / GPU bubble ratio: 7.74%
[rank1]:2025-10-29 06:42:18,060 - INFO - Avg. fwd time: 9.9833 / Avg. bwd time: 17.8126 / Avg. batch time: 446.4846 (ms) / GPU bubble ratio: 50.20%
[rank2]:2025-10-29 06:42:18,031 - INFO - Avg. fwd time: 7.7179 / Avg. bwd time: 12.4149 / Avg. batch time: 415.5236 (ms) / GPU bubble ratio: 61.24%
[rank0]:2025-10-29 06:42:18,086 - INFO - Avg. fwd time: 8.1994 / Avg. bwd time: 17.2392 / Avg. batch time: 475.6404 (ms) / GPU bubble ratio: 57.21%
[rank1]:2025-10-29 06:42:36,889 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3376e+00
[rank2]:2025-10-29 06:42:36,885 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1158e+00
[rank0]:2025-10-29 06:42:36,897 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3139e+00
[rank3]:2025-10-29 06:42:36,897 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7859e+00
[rank1]:2025-10-29 06:42:56,191 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.4540e-01
[rank2]:2025-10-29 06:42:56,187 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0601e+00
[rank0]:2025-10-29 06:42:56,203 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0050e+00
[rank3]:2025-10-29 06:42:56,203 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1615e+00
[rank2]:2025-10-29 06:43:15,575 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3051e-01
[rank0]:2025-10-29 06:43:15,587 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4203e+00
[rank3]:2025-10-29 06:43:15,587 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0627e+00
[rank1]:2025-10-29 06:43:15,580 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5673e+00
[rank3]:2025-10-29 06:43:34,944 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4412e-01
[rank1]:2025-10-29 06:43:34,931 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6666e-01
[rank2]:2025-10-29 06:43:34,928 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9989e-01
[rank0]:2025-10-29 06:43:34,943 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5724e-01
[rank0]:2025-10-29 06:43:52,284 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:43:54,241 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9196e+00
[rank0]:2025-10-29 06:43:54,242 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0976  memory: 13.29GiB(27.97%)  tps: 8,454  tflops: 66.09  mfu: 21.18%
[rank3]:2025-10-29 06:43:54,242 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2025e+00
[rank3]:2025-10-29 06:43:54,243 - INFO -  step: 1550  loss:  0.1135  grad_norm:  0.0976  memory: 16.43GiB(34.58%)  tps: 8,454  tflops: 66.09  mfu: 21.18%
[rank1]:2025-10-29 06:43:54,234 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9601e+00
[rank1]:2025-10-29 06:43:54,234 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0976  memory:  9.26GiB(19.50%)  tps: 8,454  tflops: 66.09  mfu: 21.18%
[rank2]:2025-10-29 06:43:54,230 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.6786e-01
[rank2]:2025-10-29 06:43:54,230 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0976  memory:  6.43GiB(13.53%)  tps: 8,454  tflops: 66.09  mfu: 21.18%
[rank0]:2025-10-29 06:43:54,430 - INFO - Avg. fwd time: 8.1980 / Avg. bwd time: 17.1853 / Avg. batch time: 475.4457 (ms) / GPU bubble ratio: 57.29%
[rank3]:2025-10-29 06:43:54,422 - INFO - Avg. fwd time: 14.3025 / Avg. bwd time: 30.8641 / Avg. batch time: 391.6479 (ms) / GPU bubble ratio: 7.74%
[rank1]:2025-10-29 06:43:54,507 - INFO - Avg. fwd time: 9.9824 / Avg. bwd time: 17.7889 / Avg. batch time: 446.3482 (ms) / GPU bubble ratio: 50.22%
[rank2]:2025-10-29 06:43:54,444 - INFO - Avg. fwd time: 7.7173 / Avg. bwd time: 12.3955 / Avg. batch time: 415.4114 (ms) / GPU bubble ratio: 61.27%
[rank1]:2025-10-29 06:44:13,196 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.0815e+00
[rank2]:2025-10-29 06:44:13,193 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.2336e-01
[rank0]:2025-10-29 06:44:13,208 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2264e+00
[rank3]:2025-10-29 06:44:13,208 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6629e-01
[rank3]:2025-10-29 06:44:32,419 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9936e+00
[rank1]:2025-10-29 06:44:32,411 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3579e+00
[rank2]:2025-10-29 06:44:32,407 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0728e+00
[rank0]:2025-10-29 06:44:32,418 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3171e+00
[rank1]:2025-10-29 06:44:51,035 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.7625e+00
[rank2]:2025-10-29 06:44:51,031 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4254e+00
[rank0]:2025-10-29 06:44:51,047 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0660e+00
[rank3]:2025-10-29 06:44:51,053 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2962e+00
[rank3]:2025-10-29 06:45:10,243 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0007e+00
[rank1]:2025-10-29 06:45:10,235 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9349e+00
[rank2]:2025-10-29 06:45:10,231 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1271e-01
[rank0]:2025-10-29 06:45:10,243 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1362e+00
[rank0]:2025-10-29 06:45:27,198 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:45:29,132 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.8432e-01
[rank1]:2025-10-29 06:45:29,133 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1172  memory:  9.26GiB(19.50%)  tps: 8,632  tflops: 67.48  mfu: 21.63%
[rank1]:2025-10-29 06:45:29,133 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.1172  tps: 8,555  tflops: 66.88  mfu: 20.39%
[rank1]:2025-10-29 06:45:29,133 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 06:45:29,128 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5052e-01
[rank2]:2025-10-29 06:45:29,129 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1172  memory:  6.43GiB(13.53%)  tps: 8,632  tflops: 67.48  mfu: 21.63%
[rank2]:2025-10-29 06:45:29,129 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.1172  tps: 8,554  tflops: 66.87  mfu: 20.39%
[rank2]:2025-10-29 06:45:29,129 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 06:45:29,144 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3446e+00
[rank0]:2025-10-29 06:45:29,144 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1172  memory: 13.29GiB(27.97%)  tps: 8,632  tflops: 67.48  mfu: 21.63%
[rank0]:2025-10-29 06:45:29,145 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.1172  tps: 8,554  tflops: 66.87  mfu: 20.39%
[rank0]:2025-10-29 06:45:29,145 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 06:45:29,144 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8671e-01
[rank3]:2025-10-29 06:45:29,146 - INFO -  step: 1600  loss:  0.1267  grad_norm:  0.1172  memory: 16.43GiB(34.58%)  tps: 8,632  tflops: 67.48  mfu: 21.63%
[rank3]:2025-10-29 06:45:29,147 - INFO -  final step: 1600  loss:  0.1267  grad_norm:  0.1172  tps: 8,561  tflops: 66.92  mfu: 20.39%
[rank3]:2025-10-29 06:45:29,147 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 06:45:44,270 - INFO - validate step: 1600  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,081
[rank0]:2025-10-29 06:45:44,271 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:45:44,273 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-29 06:45:44,302 - INFO - validate step: 1600  loss:  0.2958  memory: 16.43GiB(34.58%)  tps: 27,029
[rank3]:2025-10-29 06:45:44,303 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:45:44,305 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-29 06:45:44,298 - INFO - validate step: 1600  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 27,004
[rank2]:2025-10-29 06:45:44,299 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:45:44,300 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-29 06:45:44,282 - INFO - validate step: 1600  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 27,038
[rank1]:2025-10-29 06:45:44,283 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:45:44,285 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-29 06:45:47,233 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 06:45:47,333 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank2/251029_0645_stage2_final1600.svg
[rank1]:2025-10-29 06:45:47,328 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank1/251029_0645_stage1_final1600.svg
[rank0]:2025-10-29 06:45:47,330 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank0/251029_0645_stage0_final1600.svg
[rank3]:2025-10-29 06:45:47,431 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0645_real_final1600_rank3.svg
[rank3]:> Batch Time: 431.72 ms, GPU Bubble Ratio: 56.03%, 48.24%, 62.04%, 16.82%
[rank2]:2025-10-29 06:45:47,550 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/frozen_params_histogram/251029_0645_rank2_stage2.svg
[rank2]:	> Counts Sum: 3348, Total Sum: 5580 (60.00%), Ratio(%) per element: [96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 46.45, 46.45, 46.45, 46.45, 46.45, 46.45, 46.45, 46.45, 46.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-29 06:45:47,551 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 06:45:47,532 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/frozen_params_histogram/251029_0645_rank1_stage1.svg
[rank1]:	> Counts Sum: 3222, Total Sum: 6975 (46.19%), Ratio(%) per element: [94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 93.54, 93.54, 93.54, 93.54, 93.54, 93.54, 93.54, 93.54, 93.54, 42.58, 42.58, 42.58, 42.58, 42.58, 42.58, 42.58, 42.58, 42.58, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-29 06:45:47,532 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 06:45:47,551 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/frozen_params_histogram/251029_0645_rank0_stage0.svg
[rank0]:	> Counts Sum: 3582, Total Sum: 5735 (62.46%), Ratio(%) per element: [0.0, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 94.83, 65.16, 65.16, 65.16, 65.16, 65.16, 65.16, 65.16, 65.16, 65.16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-29 06:45:47,551 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 06:45:47,617 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/pipeline_schedule/251029_0645_thry_final1600_rank3.svg
[rank3]:> Batch Time: 332.61 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 06:45:47,689 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/freeze_ratio_history/rank3/251029_0645_stage3_final1600.svg
[rank3]:2025-10-29 06:45:47,872 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1/frozen_params_histogram/251029_0645_rank3_stage3.svg
[rank3]:	> Counts Sum: 2763, Total Sum: 4495 (61.47%), Ratio(%) per element: [99.35, 99.35, 99.35, 99.35, 99.35, 99.35, 99.35, 99.35, 99.35, 98.7, 98.7, 98.7, 98.7, 98.7, 98.7, 98.7, 98.7, 98.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-29 06:45:47,873 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-10-29 06:45:48,070 - INFO - Process group destroyed
[rank1]:2025-10-29 06:45:48,076 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 32-32, summary, console lines 481-488
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–‡â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.91387
[rank3]:wandb:               final/avg_loss 0.12667
[rank3]:wandb:             final/avg_mfu(%) 20.39257
[rank3]:wandb:             final/avg_tflops 66.92336
[rank3]:wandb:    final/avg_throughput(tps) 8560.66758
[rank3]:wandb:              final/grad_norm 0.11725
[rank3]:wandb:               final/max_loss 0.12667
[rank3]:wandb:                    grad_norm 0.11725
[rank3]:wandb: loss_metrics/global_avg_loss 0.12667
[rank3]:wandb: loss_metrics/global_max_loss 0.12667
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_1F1B_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/04zhyqw3
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1028_1F1B_auto_dm1/20251029-0550/wandb/run-20251029_055100-04zhyqw3/logs
[rank3]:2025-10-29 06:45:49,369 - INFO - Process group destroyed
[rank0]:2025-10-29 06:45:49,552 - INFO - Training completed
[rank0]:2025-10-29 06:45:49,552 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 06:45:49,628 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.9', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.0', 'layers.2', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.5', 'layers.6', 'layers.7', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'output', 'norm', 'layers.13', 'layers.15', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_1F1B_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1028_1F1B_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1028_1F1B_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1028_1F1B_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1028_1F1B_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_1F1B_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: True
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1028_1F1B_auto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1028_1F1B_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
