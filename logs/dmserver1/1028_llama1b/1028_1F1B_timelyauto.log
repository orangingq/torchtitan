
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2025. 10. 29. (Ïàò) 07:01:25 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/1028_1F1B_timelyauto.log
‚úîÔ∏èMain Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
‚úîÔ∏èRunning with timelyauto x 1F1B ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
[rank1]:2025-10-29 07:01:31,839 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 07:01:31,938 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 07:01:31,839 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 07:01:32,074 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 07:01:32,090 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 07:01:32,092 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 07:01:32,077 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 07:01:32,081 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-29 07:01:32,051 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 07:01:32,204 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 07:01:32,207 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 07:01:32,283 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 07:01:32,286 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 07:01:33,310 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 07:01:33,698 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 07:01:36,451 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 07:01:36,750 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-29 07:01:36,791 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 07:01:36,792 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 07:01:36,792 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 07:01:36,836 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 07:01:36,837 - INFO - Compiling each TransformerBlock with torch.compile
[rank0]:2025-10-29 07:01:36,837 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-29 07:01:36,902 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 07:01:36,915 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 07:01:36,944 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 07:01:36,945 - INFO - Compiling the loss function with torch.compile
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 07:01:36,992 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-29 07:01:36,993 - INFO - Compiling each TransformerBlock with torch.compile
[rank2]:2025-10-29 07:01:36,993 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-29 07:01:36,956 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 07:01:36,958 - INFO - Compiling the loss function with torch.compile
[rank1]:2025-10-29 07:01:37,006 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 07:01:37,007 - INFO - Compiling each TransformerBlock with torch.compile
[rank1]:2025-10-29 07:01:37,008 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-29 07:01:37,014 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 07:01:37,014 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 07:01:37,015 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-29 07:01:37,177 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 07:01:37,177 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 07:01:37,178 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-29 07:01:37,182 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 07:01:37,182 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 07:01:37,182 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run xy91cb66
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1028_1F1B_timelyauto_dm1/20251029-0701/wandb/run-20251029_070137-xy91cb66
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_1F1B_timelyauto_dm1
[rank3]:wandb: ‚≠êÔ∏è View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: üöÄ View run at https://wandb.ai/orangingq/torchtitan/runs/xy91cb66
[rank3]:2025-10-29 07:01:39,506 - INFO - WandB logging enabled
[rank3]:2025-10-29 07:01:39,507 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 07:01:39,545 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 07:01:39,547 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-29 07:01:39,596 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 07:01:39,599 - INFO - Compiling each TransformerBlock with torch.compile
[rank3]:2025-10-29 07:01:39,600 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-29 07:01:40,438 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 07:01:40,438 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-29 07:01:40,438 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 07:01:40,438 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-29 07:01:40,422 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 07:01:40,423 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 07:01:40,423 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 07:01:40,438 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 07:01:40,438 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 07:01:40,438 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1028_1F1B_timelyauto_dm1
[rank0]:2025-10-29 07:01:40,438 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 07:01:40,438 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 07:01:40,442 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-29 07:01:45,383 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1600 (warmup 100)
[rank0]:2025-10-29 07:01:45,383 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 07:01:49,497 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 07:01:49,497 - INFO - Finished loading the checkpoint in 4.11 seconds.
[rank0]:2025-10-29 07:01:49,498 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank0]:  warnings.warn(
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank1]:  warnings.warn(
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank2]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 07:02:02,046 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4624  memory:  6.98GiB(14.69%)  tps: 653  tflops: 5.11  mfu: 1.64%
[rank1]:2025-10-29 07:02:02,047 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 07:02:02,053 - INFO -  step:  1  loss:  9.8292  grad_norm: 53.4624  memory: 12.99GiB(27.34%)  tps: 728  tflops: 5.69  mfu: 1.82%
[rank3]:2025-10-29 07:02:02,053 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 07:02:02,043 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4624  memory:  4.61GiB(9.71%)  tps: 653  tflops: 5.10  mfu: 1.64%
[rank2]:2025-10-29 07:02:02,044 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 07:02:02,080 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4624  memory:  9.52GiB(20.03%)  tps: 648  tflops: 5.06  mfu: 1.62%
[rank0]:2025-10-29 07:02:02,080 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 07:02:17,302 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,303 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,304 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,305 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,305 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,306 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,306 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,307 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,307 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,309 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,310 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,363 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 07:02:17,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,310 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,311 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 07:02:17,311 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,391 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,391 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,335 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,336 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,336 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,336 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 07:02:17,336 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,393 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:02:17,393 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 07:03:49,751 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 07:03:52,026 - INFO -  step: 50  loss:  9.4396  grad_norm: 22.6465  memory: 16.43GiB(34.58%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank2]:2025-10-29 07:03:52,014 - INFO -  step: 50  loss: -4.0000  grad_norm: 22.6465  memory:  6.43GiB(13.53%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank0]:2025-10-29 07:03:52,028 - INFO -  step: 50  loss: -4.0000  grad_norm: 22.6465  memory: 13.29GiB(27.97%)  tps: 7,302  tflops: 57.08  mfu: 18.30%
[rank1]:2025-10-29 07:03:52,017 - INFO -  step: 50  loss: -4.0000  grad_norm: 22.6465  memory:  9.26GiB(19.50%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank3]:2025-10-29 07:03:52,268 - INFO - Avg. fwd time: 13.8015 / Avg. bwd time: 36.4069 / Avg. batch time: 438.6843 (ms) / GPU bubble ratio: 8.44%
[rank2]:2025-10-29 07:03:52,328 - INFO - Avg. fwd time: 8.1927 / Avg. bwd time: 18.5433 / Avg. batch time: 469.2361 (ms) / GPU bubble ratio: 54.42%
[rank0]:2025-10-29 07:03:52,329 - INFO - Avg. fwd time: 8.6415 / Avg. bwd time: 23.9621 / Avg. batch time: 542.3752 (ms) / GPU bubble ratio: 51.91%
[rank1]:2025-10-29 07:03:52,360 - INFO - Avg. fwd time: 10.4424 / Avg. bwd time: 23.8342 / Avg. batch time: 506.3992 (ms) / GPU bubble ratio: 45.85%
[rank3]:2025-10-29 07:04:14,100 - INFO - [Step 60] „Ä∞Ô∏è Monitoring Upperbound
[rank3]:2025-10-29 07:04:36,766 - INFO - [Step 70] ‚úîÔ∏è  Setting Upperbound
[rank3]:2025-10-29 07:04:37,072 - INFO - [Step 70] „Ä∞Ô∏è Monitoring Lowerbound
[rank3]:2025-10-29 07:04:37,089 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,093 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,102 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,101 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,131 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,161 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:04:37,108 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:04:37,127 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:04:37,151 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:04:37,174 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:04:37,198 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,117 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,144 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,173 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,202 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,196 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,228 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:04:37,223 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:04:37,247 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,230 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,259 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,493 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,518 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,536 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 07:04:37,560 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 07:04:37,519 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,520 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,542 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,562 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,563 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,564 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 07:04:37,565 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 07:05:10,385 - INFO - [Step 90] ‚úîÔ∏è  Setting Lowerbound
[rank3]:2025-10-29 07:05:10,830 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_0705_max_batch_time.svg
[rank3]:> Batch Time: 512.96 ms, GPU Bubble Ratio: 49.04%, 46.40%, 58.29%, 18.29%
[rank3]:2025-10-29 07:05:11,018 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_0705_min_batch_time.svg
[rank3]:> Batch Time: 358.31 ms, GPU Bubble Ratio: 81.49%, 31.97%, 47.71%, 17.28%
[rank3]:2025-10-29 07:05:11,219 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_0705_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.31 ms, GPU Bubble Ratio: 33.84%, 24.41%, 41.26%, 17.28%
[rank3]:2025-10-29 07:05:11,220 - INFO - 	> Batch Time: 358.31 ms (Average Freeze Ratio: 0.34, Time Reduction Rate: 0.30)
[rank0]:2025-10-29 07:05:27,315 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:05:29,054 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 07:05:29,054 - INFO -  step: 100  loss: -4.0000  grad_norm:  8.9079  memory: 13.31GiB(28.01%)  tps: 8,443  tflops: 66.00  mfu: 21.16%
[rank3]:2025-10-29 07:05:28,971 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 07:05:29,022 - INFO -  step: 100  loss:  9.8414  grad_norm:  0.0000  memory: 16.43GiB(34.58%)  tps: 8,446  tflops: 66.03  mfu: 21.16%
[rank2]:2025-10-29 07:05:29,038 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-10-29 07:05:29,039 - INFO -  step: 100  loss: -4.0000  grad_norm:  8.9079  memory:  6.43GiB(13.53%)  tps: 8,443  tflops: 66.01  mfu: 21.16%
[rank1]:2025-10-29 07:05:29,043 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 07:05:29,043 - INFO -  step: 100  loss: -4.0000  grad_norm:  8.9079  memory:  9.26GiB(19.50%)  tps: 8,443  tflops: 66.00  mfu: 21.16%
[rank1]:2025-10-29 07:05:29,134 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_0705_stage1_step100.svg
[rank0]:2025-10-29 07:05:29,134 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_0705_stage0_step100.svg
[rank2]:2025-10-29 07:05:29,133 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_0705_stage2_step100.svg
[rank3]:2025-10-29 07:05:29,233 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_0705_real_step100_rank3.svg
[rank3]:> Batch Time: 498.88 ms, GPU Bubble Ratio: 48.10%, 45.33%, 57.55%, 18.62%
[rank3]:2025-10-29 07:05:29,296 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_0705_stage3_step100.svg
[rank0]:2025-10-29 07:05:29,432 - INFO - Avg. fwd time: 8.4477 / Avg. bwd time: 18.0969 / Avg. batch time: 509.4623 (ms) / GPU bubble ratio: 58.32%
[rank3]:2025-10-29 07:05:29,481 - INFO - Avg. fwd time: 14.4852 / Avg. bwd time: 32.7134 / Avg. batch time: 412.1510 (ms) / GPU bubble ratio: 8.39%
[rank2]:2025-10-29 07:05:29,546 - INFO - Avg. fwd time: 7.9764 / Avg. bwd time: 17.9127 / Avg. batch time: 442.7955 (ms) / GPU bubble ratio: 53.23%
[rank1]:2025-10-29 07:05:29,579 - INFO - Avg. fwd time: 10.3157 / Avg. bwd time: 23.1036 / Avg. batch time: 479.0171 (ms) / GPU bubble ratio: 44.19%
[rank0]:2025-10-29 07:07:08,190 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:07:10,170 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 07:07:10,171 - INFO -  step: 150  loss: -4.0000  grad_norm: 17.4332  memory:  9.26GiB(19.50%)  tps: 8,101  tflops: 63.33  mfu: 20.30%
[rank0]:2025-10-29 07:07:10,180 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 07:07:10,181 - INFO -  step: 150  loss: -4.0000  grad_norm: 17.4332  memory: 13.31GiB(28.01%)  tps: 8,101  tflops: 63.33  mfu: 20.30%
[rank3]:2025-10-29 07:07:10,173 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 07:07:10,175 - INFO -  step: 150  loss:  4.1873  grad_norm: 17.4332  memory: 16.92GiB(35.61%)  tps: 8,099  tflops: 63.31  mfu: 20.29%
[rank2]:2025-10-29 07:07:10,164 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-10-29 07:07:10,164 - INFO -  step: 150  loss: -4.0000  grad_norm: 17.4332  memory:  6.45GiB(13.58%)  tps: 8,101  tflops: 63.33  mfu: 20.30%
[rank3]:2025-10-29 07:07:10,572 - INFO - Avg. fwd time: 14.7119 / Avg. bwd time: 31.4574 / Avg. batch time: 402.6236 (ms) / GPU bubble ratio: 8.26%
[rank2]:2025-10-29 07:07:10,595 - INFO - Avg. fwd time: 7.8975 / Avg. bwd time: 17.9825 / Avg. batch time: 432.5779 (ms) / GPU bubble ratio: 52.14%
[rank1]:2025-10-29 07:07:10,621 - INFO - Avg. fwd time: 10.2386 / Avg. bwd time: 23.1608 / Avg. batch time: 468.5501 (ms) / GPU bubble ratio: 42.97%
[rank0]:2025-10-29 07:07:10,644 - INFO - Avg. fwd time: 8.3730 / Avg. bwd time: 19.6803 / Avg. batch time: 500.3798 (ms) / GPU bubble ratio: 55.15%
[rank0]:2025-10-29 07:08:41,444 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 07:08:43,218 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:08:43,221 - INFO -  step: 200  loss:  2.2676  grad_norm: 20.7039  memory: 16.92GiB(35.61%)  tps: 8,804  tflops: 68.83  mfu: 22.06%
[rank3]:2025-10-29 07:08:43,221 - INFO - üîé  Running validation at step 200
[rank1]:2025-10-29 07:08:43,238 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:08:43,238 - INFO -  step: 200  loss: -4.0000  grad_norm: 20.7039  memory:  9.26GiB(19.50%)  tps: 8,802  tflops: 68.81  mfu: 22.05%
[rank1]:2025-10-29 07:08:43,239 - INFO - üîé  Running validation at step 200
[rank0]:2025-10-29 07:08:43,249 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:08:43,250 - INFO -  step: 200  loss: -4.0000  grad_norm: 20.7039  memory: 13.31GiB(28.01%)  tps: 8,802  tflops: 68.81  mfu: 22.05%
[rank0]:2025-10-29 07:08:43,250 - INFO - üîé  Running validation at step 200
[rank2]:2025-10-29 07:08:43,233 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:08:43,234 - INFO -  step: 200  loss: -4.0000  grad_norm: 20.7039  memory:  6.45GiB(13.58%)  tps: 8,802  tflops: 68.81  mfu: 22.05%
[rank2]:2025-10-29 07:08:43,234 - INFO - üîé  Running validation at step 200
[rank1]:2025-10-29 07:09:02,988 - INFO - validate step: 200  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 20,740
[rank0]:2025-10-29 07:09:02,974 - INFO - validate step: 200  loss: -1.0000  memory: 13.31GiB(28.01%)  tps: 20,766
[rank2]:2025-10-29 07:09:03,002 - INFO - validate step: 200  loss: -1.0000  memory:  6.45GiB(13.58%)  tps: 20,720
[rank3]:2025-10-29 07:09:03,005 - INFO - validate step: 200  loss:  0.6482  memory: 16.92GiB(35.61%)  tps: 20,705
[rank1]:2025-10-29 07:09:03,081 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_0709_stage1_step200.svg
[rank0]:2025-10-29 07:09:03,082 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_0709_stage0_step200.svg
[rank2]:2025-10-29 07:09:03,082 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_0709_stage2_step200.svg
[rank3]:2025-10-29 07:09:03,189 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_0709_real_step200_rank3.svg
[rank3]:> Batch Time: 454.89 ms, GPU Bubble Ratio: 45.76%, 41.39%, 54.57%, 19.37%
[rank3]:2025-10-29 07:09:03,255 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_0709_stage3_step200.svg
[rank1]:[rank1]:W1029 07:09:04.827000 3716970 site-packages/torch/_dynamo/convert_frame.py:1515] [0/8] torch._dynamo hit config.recompile_limit (8)
[rank1]:[rank1]:W1029 07:09:04.827000 3716970 site-packages/torch/_dynamo/convert_frame.py:1515] [0/8]    function: 'forward' (/home/shcho/torchtitan/torchtitan/models/llama3/model/model.py:284)
[rank1]:[rank1]:W1029 07:09:04.827000 3716970 site-packages/torch/_dynamo/convert_frame.py:1515] [0/8]    last reason: 0/7: tensor 'self._modules['attention']._modules['wk']._parameters['weight']' requires_grad mismatch. expected requires_grad=1. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
[rank1]:[rank1]:W1029 07:09:04.827000 3716970 site-packages/torch/_dynamo/convert_frame.py:1515] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
[rank1]:[rank1]:W1029 07:09:04.827000 3716970 site-packages/torch/_dynamo/convert_frame.py:1515] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html
[rank1]:2025-10-29 07:09:04,831 - INFO - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/stage.py", line 693, in forward_one_chunk
[rank1]:[rank1]:     output = self.forward_maybe_with_nosync(*composite_args, **composite_kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/stage.py", line 567, in forward_maybe_with_nosync
[rank1]:[rank1]:     out_val = self.submod(*args, **kwargs)
[rank1]:[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1780, in _wrapped_call_impl
[rank1]:[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1791, in _call_impl
[rank1]:[rank1]:     return forward_call(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/torchtitan/models/llama3/model/model.py", line 432, in forward
[rank1]:[rank1]:     h = layer(h, self.freqs_cis)
[rank1]:[rank1]:         ^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 418, in __call__
[rank1]:[rank1]:     return super().__call__(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1780, in _wrapped_call_impl
[rank1]:[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1791, in _call_impl
[rank1]:[rank1]:     return forward_call(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 895, in compile_wrapper
[rank1]:[rank1]:     return fn(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1780, in _wrapped_call_impl
[rank1]:[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1791, in _call_impl
[rank1]:[rank1]:     return forward_call(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 2034, in __call__
[rank1]:[rank1]:     result = self._torchdynamo_orig_backend(
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 701, in __call__
[rank1]:[rank1]:     result = _compile(
[rank1]:[rank1]:              ^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 1532, in _compile
[rank1]:[rank1]:     raise FailOnRecompileLimitHit(
[rank1]:[rank1]: torch._dynamo.exc.FailOnRecompileLimitHit: recompile_limit reached with fullgraph=True. Excessive recompilations can degrade performance due to the compilation overhead of each recompilation. To monitor recompilations, enable TORCH_LOGS=recompiles. If recompilations are expected, consider increasing torch._dynamo.config.cache_size_limit to an appropriate value.
[rank1]:
[rank1]:[rank1]: The above exception was the direct cause of the following exception:
[rank1]:
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 725, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 584, in train
[rank1]:[rank1]:     self.train_step(data_iterator)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 490, in train_step
[rank1]:[rank1]:     loss = self.forward_backward_step(input_dict, labels)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 447, in forward_backward_step
[rank1]:[rank1]:     self.pp_schedule.step(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/schedules.py", line 626, in step
[rank1]:[rank1]:     self._step_microbatches(args_split, kwargs_split, targets_split, losses)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/schedules.py", line 863, in _step_microbatches
[rank1]:[rank1]:     output = self._stage.forward_one_chunk(
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/stage.py", line 701, in forward_one_chunk
[rank1]:[rank1]:     raise RuntimeError(exc_msg) from e
[rank1]:[rank1]: RuntimeError: 
[rank1]:[rank1]:             [Stage 1] failed to run forward:
[rank1]:[rank1]:             args: ('Tensor(torch.Size([2, 1024, 2048]), grad=True, dtype=torch.float32)',)
[rank1]:[rank1]:             kwargs: {'input_batch': 'Tensor(torch.Size([2, 1024]), grad=False, dtype=torch.int64)'}
[rank1]:[rank1]:             
W1029 07:09:07.858000 3716953 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3716969 closing signal SIGTERM
W1029 07:09:07.861000 3716953 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3716971 closing signal SIGTERM
W1029 07:09:07.863000 3716953 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3716972 closing signal SIGTERM
E1029 07:09:08.358000 3716953 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 1 (pid: 3716970) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1029 07:09:08.374000 3716953 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_ul3ac1hy/eaa8c666-a646-448f-8f0f-203beaeb5599_q228gwy7/attempt_0/1/error.json)
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.2', 'tok_embeddings', 'layers.0', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.8', 'layers.5', 'layers.6', 'layers.7'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'norm', 'output', 'layers.14'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreeze‚è∞ Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_1F1B_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1028_1F1B_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1028_1F1B_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1028_1F1B_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_1F1B_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: True
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1028_1F1B_timelyauto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1028_1F1B_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-10-29_07:09:08
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 3716969)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 3716969
[2]:
  time      : 2025-10-29_07:09:08
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : -15 (pid: 3716971)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 3716971
[3]:
  time      : 2025-10-29_07:09:08
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : -15 (pid: 3716972)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 3716972
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-29_07:09:04
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3716970)
  error_file: /tmp/torchelastic_ul3ac1hy/eaa8c666-a646-448f-8f0f-203beaeb5599_q228gwy7/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/stage.py", line 693, in forward_one_chunk
      output = self.forward_maybe_with_nosync(*composite_args, **composite_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/stage.py", line 567, in forward_maybe_with_nosync
      out_val = self.submod(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1780, in _wrapped_call_impl
      return self._call_impl(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1791, in _call_impl
      return forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/torchtitan/models/llama3/model/model.py", line 432, in forward
      h = layer(h, self.freqs_cis)
          ^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 418, in __call__
      return super().__call__(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1780, in _wrapped_call_impl
      return self._call_impl(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1791, in _call_impl
      return forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 895, in compile_wrapper
      return fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1780, in _wrapped_call_impl
      return self._call_impl(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1791, in _call_impl
      return forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 2034, in __call__
      result = self._torchdynamo_orig_backend(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 701, in __call__
      result = _compile(
               ^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 1532, in _compile
      raise FailOnRecompileLimitHit(
  torch._dynamo.exc.FailOnRecompileLimitHit: recompile_limit reached with fullgraph=True. Excessive recompilations can degrade performance due to the compilation overhead of each recompilation. To monitor recompilations, enable TORCH_LOGS=recompiles. If recompilations are expected, consider increasing torch._dynamo.config.cache_size_limit to an appropriate value.
  
  The above exception was the direct cause of the following exception:
  
  Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 584, in train
      self.train_step(data_iterator)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 490, in train_step
      loss = self.forward_backward_step(input_dict, labels)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 447, in forward_backward_step
      self.pp_schedule.step(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/schedules.py", line 626, in step
      self._step_microbatches(args_split, kwargs_split, targets_split, losses)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/schedules.py", line 863, in _step_microbatches
      output = self._stage.forward_one_chunk(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/pipelining/stage.py", line 701, in forward_one_chunk
      raise RuntimeError(exc_msg) from e
  RuntimeError: 
              [Stage 1] failed to run forward:
              args: ('Tensor(torch.Size([2, 1024, 2048]), grad=True, dtype=torch.float32)',)
              kwargs: {'input_batch': 'Tensor(torch.Size([2, 1024]), grad=False, dtype=torch.int64)'}
              
  
============================================================

üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2025. 10. 29. (Ïàò) 14:53:02 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/1028_1F1B_timelyauto.log
‚úîÔ∏èMain Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
‚úîÔ∏èRunning with timelyauto x 1F1B ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
[rank3]:2025-10-29 14:53:08,793 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 14:53:08,825 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 14:53:08,774 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-29 14:53:08,765 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-29 14:53:09,116 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 14:53:09,118 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 14:53:09,057 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 14:53:09,059 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 14:53:09,114 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 14:53:09,116 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 14:53:09,172 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 14:53:09,175 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 14:53:09,180 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 14:53:10,265 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 14:53:10,653 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 14:53:13,762 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 14:53:13,820 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 14:53:13,762 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 14:53:13,820 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 14:53:13,847 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-29 14:53:13,847 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-29 14:53:13,845 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 14:53:13,846 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-29 14:53:13,954 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 14:53:14,045 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 14:53:14,046 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 14:53:14,046 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-29 14:53:14,100 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 14:53:14,046 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 14:53:14,046 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 14:53:14,047 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-29 14:53:14,138 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 14:53:14,139 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 14:53:14,163 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 14:53:14,163 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 14:53:14,338 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 14:53:14,338 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 14:53:14,338 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run pvh7ionq
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1028_1F1B_timelyauto_dm1/20251029-1453/wandb/run-20251029_145315-pvh7ionq
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_1F1B_timelyauto_dm1
[rank3]:wandb: ‚≠êÔ∏è View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: üöÄ View run at https://wandb.ai/orangingq/torchtitan/runs/pvh7ionq
[rank3]:2025-10-29 14:53:16,328 - INFO - WandB logging enabled
[rank3]:2025-10-29 14:53:16,329 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 14:53:16,368 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 14:53:16,396 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 14:53:16,397 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-29 14:53:16,591 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 14:53:16,575 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 14:53:16,576 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 14:53:16,577 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 14:53:16,591 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 14:53:16,591 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1028_1F1B_timelyauto_dm1
[rank0]:2025-10-29 14:53:16,591 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 14:53:16,591 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 14:53:16,591 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 14:53:22,110 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1600 (warmup 100)
[rank0]:2025-10-29 14:53:22,110 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 14:53:25,112 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 14:53:25,113 - INFO - Finished loading the checkpoint in 3.00 seconds.
[rank0]:2025-10-29 14:53:25,113 - INFO - Training starts at step 1
[rank3]:2025-10-29 14:53:28,905 - INFO -  step:  1  loss:  9.8313  grad_norm: 54.0699  memory: 12.97GiB(27.30%)  tps: 1,307  tflops: 10.22  mfu: 3.28%
[rank3]:2025-10-29 14:53:28,906 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 14:53:28,898 - INFO -  step:  1  loss: -4.0000  grad_norm: 54.0699  memory:  6.76GiB(14.24%)  tps: 1,087  tflops: 8.49  mfu: 2.72%
[rank1]:2025-10-29 14:53:28,898 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 14:53:28,895 - INFO -  step:  1  loss: -4.0000  grad_norm: 54.0699  memory:  4.63GiB(9.75%)  tps: 1,087  tflops: 8.50  mfu: 2.72%
[rank2]:2025-10-29 14:53:28,896 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 14:53:28,936 - INFO -  step:  1  loss: -4.0000  grad_norm: 54.0699  memory:  9.19GiB(19.34%)  tps: 1,107  tflops: 8.66  mfu: 2.77%
[rank0]:2025-10-29 14:53:28,936 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 14:53:45,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,128 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,128 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,128 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,128 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,129 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,129 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,129 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,129 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 14:53:45,130 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,151 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 14:53:45,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 14:53:45,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:53:45,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 14:55:26,930 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 14:55:29,405 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.3320  memory:  9.03GiB(19.01%)  tps: 6,662  tflops: 52.08  mfu: 16.69%
[rank2]:2025-10-29 14:55:29,401 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.3320  memory:  6.43GiB(13.53%)  tps: 6,662  tflops: 52.08  mfu: 16.69%
[rank0]:2025-10-29 14:55:29,416 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.3320  memory: 12.97GiB(27.31%)  tps: 6,664  tflops: 52.09  mfu: 16.70%
[rank3]:2025-10-29 14:55:29,413 - INFO -  step: 50  loss:  9.4541  grad_norm: 21.3320  memory: 16.39GiB(34.50%)  tps: 6,662  tflops: 52.08  mfu: 16.69%
[rank3]:2025-10-29 14:55:29,738 - INFO - Avg. fwd time: 12.1314 / Avg. bwd time: 39.9323 / Avg. batch time: 490.9308 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-10-29 14:55:29,776 - INFO - Avg. fwd time: 6.9496 / Avg. bwd time: 18.3276 / Avg. batch time: 521.3153 (ms) / GPU bubble ratio: 61.21%
[rank0]:2025-10-29 14:55:29,805 - INFO - Avg. fwd time: 7.3959 / Avg. bwd time: 23.6944 / Avg. batch time: 595.6828 (ms) / GPU bubble ratio: 58.25%
[rank1]:2025-10-29 14:55:29,809 - INFO - Avg. fwd time: 9.0408 / Avg. bwd time: 23.5131 / Avg. batch time: 559.1761 (ms) / GPU bubble ratio: 53.43%
[rank3]:2025-10-29 14:55:53,626 - INFO - [Step 60] „Ä∞Ô∏è Monitoring Upperbound
[rank3]:2025-10-29 14:56:18,335 - INFO - [Step 70] ‚úîÔ∏è  Setting Upperbound
[rank3]:2025-10-29 14:56:18,628 - INFO - [Step 70] „Ä∞Ô∏è Monitoring Lowerbound
[rank3]:2025-10-29 14:56:18,647 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,661 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,651 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,680 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,661 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,687 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:18,673 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:18,694 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:18,720 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:18,747 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,694 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,733 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,712 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,739 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,768 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,713 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,783 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:18,773 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:18,801 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:18,830 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,783 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,822 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,854 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,800 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,839 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 14:56:18,867 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,826 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,826 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,827 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 14:56:18,827 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,872 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 14:56:18,885 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 14:56:51,364 - INFO - [Step 90] ‚úîÔ∏è  Setting Lowerbound
[rank3]:2025-10-29 14:56:51,597 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1456_max_batch_time.svg
[rank3]:> Batch Time: 520.92 ms, GPU Bubble Ratio: 51.41%, 49.21%, 60.59%, 18.29%
[rank3]:2025-10-29 14:56:51,784 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1456_min_batch_time.svg
[rank3]:> Batch Time: 314.18 ms, GPU Bubble Ratio: 80.86%, 49.34%, 60.91%, 15.24%
[rank3]:2025-10-29 14:56:51,986 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1456_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 314.18 ms, GPU Bubble Ratio: 31.37%, 19.97%, 37.93%, 15.24%
[rank3]:2025-10-29 14:56:51,987 - INFO - 	> Batch Time: 314.18 ms (Average Freeze Ratio: 0.36, Time Reduction Rate: 0.40)
[rank0]:2025-10-29 14:57:08,387 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 14:57:10,123 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 14:57:10,197 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 14:57:10,197 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.9965  memory:  9.36GiB(19.71%)  tps: 8,128  tflops: 63.54  mfu: 20.36%
[rank3]:2025-10-29 14:57:10,177 - INFO -  step: 100  loss:  9.8397  grad_norm:  0.0000  memory: 16.39GiB(34.50%)  tps: 8,130  tflops: 63.56  mfu: 20.37%
[rank2]:2025-10-29 14:57:10,193 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-10-29 14:57:10,193 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.9965  memory:  6.51GiB(13.70%)  tps: 8,128  tflops: 63.54  mfu: 20.36%
[rank0]:2025-10-29 14:57:10,210 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-10-29 14:57:10,210 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.9965  memory: 12.97GiB(27.31%)  tps: 8,127  tflops: 63.54  mfu: 20.36%
[rank1]:2025-10-29 14:57:10,287 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1457_stage1_step100.svg
[rank2]:2025-10-29 14:57:10,288 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1457_stage2_step100.svg
[rank0]:2025-10-29 14:57:10,287 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1457_stage0_step100.svg
[rank3]:2025-10-29 14:57:10,400 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1457_real_step100_rank3.svg
[rank3]:> Batch Time: 514.24 ms, GPU Bubble Ratio: 51.10%, 49.00%, 60.38%, 18.36%
[rank3]:2025-10-29 14:57:10,465 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1457_stage3_step100.svg
[rank3]:2025-10-29 14:57:10,677 - INFO - Avg. fwd time: 12.5722 / Avg. bwd time: 34.5987 / Avg. batch time: 450.4164 (ms) / GPU bubble ratio: 16.22%
[rank2]:2025-10-29 14:57:10,735 - INFO - Avg. fwd time: 7.3231 / Avg. bwd time: 16.1046 / Avg. batch time: 479.8867 (ms) / GPU bubble ratio: 60.94%
[rank0]:2025-10-29 14:57:10,715 - INFO - Avg. fwd time: 7.7516 / Avg. bwd time: 17.8493 / Avg. batch time: 545.8473 (ms) / GPU bubble ratio: 62.48%
[rank1]:2025-10-29 14:57:10,770 - INFO - Avg. fwd time: 9.5241 / Avg. bwd time: 20.5780 / Avg. batch time: 514.8631 (ms) / GPU bubble ratio: 53.23%
[rank0]:2025-10-29 14:58:53,480 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 14:58:55,457 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 14:58:55,461 - INFO -  step: 150  loss:  4.5491  grad_norm: 13.2419  memory: 17.37GiB(36.56%)  tps: 7,781  tflops: 60.83  mfu: 19.50%
[rank1]:2025-10-29 14:58:55,467 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 14:58:55,467 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.2419  memory:  9.36GiB(19.71%)  tps: 7,782  tflops: 60.84  mfu: 19.50%
[rank2]:2025-10-29 14:58:55,462 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-10-29 14:58:55,463 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.2419  memory:  6.51GiB(13.70%)  tps: 7,782  tflops: 60.84  mfu: 19.50%
[rank0]:2025-10-29 14:58:55,479 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-10-29 14:58:55,479 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.2419  memory: 13.25GiB(27.89%)  tps: 7,782  tflops: 60.84  mfu: 19.50%
[rank3]:2025-10-29 14:58:55,903 - INFO - Avg. fwd time: 12.8366 / Avg. bwd time: 32.2325 / Avg. batch time: 434.2466 (ms) / GPU bubble ratio: 16.97%
[rank1]:2025-10-29 14:58:55,951 - INFO - Avg. fwd time: 9.5043 / Avg. bwd time: 20.8363 / Avg. batch time: 499.5250 (ms) / GPU bubble ratio: 51.41%
[rank2]:2025-10-29 14:58:55,925 - INFO - Avg. fwd time: 7.2719 / Avg. bwd time: 16.4821 / Avg. batch time: 464.0149 (ms) / GPU bubble ratio: 59.05%
[rank0]:2025-10-29 14:58:55,974 - INFO - Avg. fwd time: 7.8033 / Avg. bwd time: 18.2689 / Avg. batch time: 531.1703 (ms) / GPU bubble ratio: 60.73%
[rank0]:2025-10-29 15:00:30,364 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:00:32,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:00:32,233 - INFO -  step: 200  loss:  2.2170  grad_norm:  3.5685  memory: 17.37GiB(36.56%)  tps: 8,465  tflops: 66.18  mfu: 21.21%
[rank3]:2025-10-29 15:00:32,233 - INFO - üîé  Running validation at step 200
[rank1]:2025-10-29 15:00:32,248 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 15:00:32,248 - INFO -  step: 200  loss: -4.0000  grad_norm:  3.5685  memory:  9.42GiB(19.83%)  tps: 8,464  tflops: 66.17  mfu: 21.21%
[rank1]:2025-10-29 15:00:32,248 - INFO - üîé  Running validation at step 200
[rank2]:2025-10-29 15:00:32,244 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:00:32,244 - INFO -  step: 200  loss: -4.0000  grad_norm:  3.5685  memory:  6.51GiB(13.70%)  tps: 8,464  tflops: 66.17  mfu: 21.21%
[rank2]:2025-10-29 15:00:32,244 - INFO - üîé  Running validation at step 200
[rank0]:2025-10-29 15:00:32,260 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 15:00:32,260 - INFO -  step: 200  loss: -4.0000  grad_norm:  3.5685  memory: 13.25GiB(27.89%)  tps: 8,464  tflops: 66.17  mfu: 21.21%
[rank0]:2025-10-29 15:00:32,260 - INFO - üîé  Running validation at step 200
[rank0]:2025-10-29 15:00:53,614 - INFO - validate step: 200  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 19,182
[rank3]:2025-10-29 15:00:53,658 - INFO - validate step: 200  loss:  0.6520  memory: 17.37GiB(36.56%)  tps: 19,119
[rank1]:2025-10-29 15:00:53,631 - INFO - validate step: 200  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 19,156
[rank0]:2025-10-29 15:00:53,733 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1500_stage0_step200.svg
[rank2]:2025-10-29 15:00:53,651 - INFO - validate step: 200  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 19,135
[rank2]:2025-10-29 15:00:53,732 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1500_stage2_step200.svg
[rank1]:2025-10-29 15:00:53,731 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1500_stage1_step200.svg
[rank3]:2025-10-29 15:00:53,848 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1500_real_step200_rank3.svg
[rank3]:> Batch Time: 418.16 ms, GPU Bubble Ratio: 48.67%, 41.03%, 53.37%, 20.88%
[rank3]:2025-10-29 15:00:53,914 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1500_stage3_step200.svg
[rank3]:2025-10-29 15:00:54,093 - INFO - Avg. fwd time: 12.9768 / Avg. bwd time: 30.3560 / Avg. batch time: 420.0810 (ms) / GPU bubble ratio: 17.48%
[rank1]:2025-10-29 15:00:54,194 - INFO - Avg. fwd time: 9.5610 / Avg. bwd time: 20.5446 / Avg. batch time: 485.0010 (ms) / GPU bubble ratio: 50.34%
[rank0]:2025-10-29 15:00:54,152 - INFO - Avg. fwd time: 7.8815 / Avg. bwd time: 17.4880 / Avg. batch time: 516.3853 (ms) / GPU bubble ratio: 60.70%
[rank2]:2025-10-29 15:00:54,158 - INFO - Avg. fwd time: 7.2797 / Avg. bwd time: 16.4671 / Avg. batch time: 449.5417 (ms) / GPU bubble ratio: 57.74%
[rank0]:2025-10-29 15:02:22,629 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 15:02:24,377 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:02:24,430 - INFO -  step: 250  loss:  1.8078  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 9,025  tflops: 70.55  mfu: 22.61%
[rank1]:2025-10-29 15:02:24,449 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 15:02:24,450 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.3141  memory:  9.42GiB(19.83%)  tps: 9,020  tflops: 70.52  mfu: 22.60%
[rank2]:2025-10-29 15:02:24,445 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:02:24,445 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.3141  memory:  6.51GiB(13.70%)  tps: 9,023  tflops: 70.53  mfu: 22.61%
[rank0]:2025-10-29 15:02:24,460 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 15:02:24,461 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.3141  memory: 13.25GiB(27.89%)  tps: 9,017  tflops: 70.49  mfu: 22.59%
[rank3]:2025-10-29 15:02:24,671 - INFO - Avg. fwd time: 13.0684 / Avg. bwd time: 28.2647 / Avg. batch time: 403.7683 (ms) / GPU bubble ratio: 18.11%
[rank0]:2025-10-29 15:02:24,726 - INFO - Avg. fwd time: 7.9552 / Avg. bwd time: 16.0872 / Avg. batch time: 499.3155 (ms) / GPU bubble ratio: 61.48%
[rank2]:2025-10-29 15:02:24,736 - INFO - Avg. fwd time: 7.3090 / Avg. bwd time: 16.3097 / Avg. batch time: 432.9484 (ms) / GPU bubble ratio: 56.36%
[rank1]:2025-10-29 15:02:24,773 - INFO - Avg. fwd time: 9.6342 / Avg. bwd time: 20.1582 / Avg. batch time: 468.3177 (ms) / GPU bubble ratio: 49.11%
[rank0]:2025-10-29 15:03:53,179 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 15:03:55,164 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1503_rank1_trend_line.svg
[rank3]:2025-10-29 15:03:55,144 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1503_rank3_trend_line.svg
[rank2]:2025-10-29 15:03:55,154 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1503_rank2_trend_line.svg
[rank1]:2025-10-29 15:03:55,191 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-29 15:03:55,196 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-29 15:03:55,196 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.7226  memory:  9.42GiB(19.83%)  tps: 9,027  tflops: 70.57  mfu: 22.62%
[rank0]:2025-10-29 15:03:55,184 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1503_rank0_trend_line.svg
[rank0]:2025-10-29 15:03:55,191 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 15:03:55,196 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 15:03:55,197 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.7226  memory: 13.25GiB(27.89%)  tps: 9,028  tflops: 70.58  mfu: 22.62%
[rank2]:2025-10-29 15:03:55,191 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:03:55,195 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:03:55,196 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.7226  memory:  6.51GiB(13.70%)  tps: 9,027  tflops: 70.57  mfu: 22.62%
[rank1]:2025-10-29 15:03:55,461 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1503_stage1_step300.svg
[rank3]:2025-10-29 15:03:55,384 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1503_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 340.46 ms, GPU Bubble Ratio: 53.18%, 32.89%, 45.26%, 22.55%
[rank3]:2025-10-29 15:03:55,385 - INFO - 	> Batch Time: 340.46 ms (Average Freeze Ratio: 0.28)
[rank3]:2025-10-29 15:03:55,385 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:03:55,387 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:03:55,390 - INFO -  step: 300  loss:  1.6958  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 9,006  tflops: 70.41  mfu: 22.57%
[rank0]:2025-10-29 15:03:55,461 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1503_stage0_step300.svg
[rank2]:2025-10-29 15:03:55,460 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1503_stage2_step300.svg
[rank3]:2025-10-29 15:03:55,581 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1503_real_step300_rank3.svg
[rank3]:> Batch Time: 368.45 ms, GPU Bubble Ratio: 49.18%, 36.22%, 48.44%, 22.84%
[rank3]:2025-10-29 15:03:55,645 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1503_stage3_step300.svg
[rank1]:2025-10-29 15:03:56,056 - INFO - Avg. fwd time: 9.6852 / Avg. bwd time: 19.9048 / Avg. batch time: 457.3324 (ms) / GPU bubble ratio: 48.24%
[rank3]:2025-10-29 15:03:56,004 - INFO - Avg. fwd time: 13.1289 / Avg. bwd time: 26.8868 / Avg. batch time: 393.0285 (ms) / GPU bubble ratio: 18.55%
[rank2]:2025-10-29 15:03:56,026 - INFO - Avg. fwd time: 7.3312 / Avg. bwd time: 16.2039 / Avg. batch time: 422.0268 (ms) / GPU bubble ratio: 55.39%
[rank0]:2025-10-29 15:03:56,086 - INFO - Avg. fwd time: 8.0043 / Avg. bwd time: 15.1427 / Avg. batch time: 488.0778 (ms) / GPU bubble ratio: 62.06%
[rank0]:2025-10-29 15:05:26,627 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 15:05:28,493 - INFO -  step: 350  loss:  1.6475  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,799  tflops: 68.79  mfu: 22.05%
[rank2]:2025-10-29 15:05:28,508 - INFO -  step: 350  loss: -4.0000  grad_norm: 11.2855  memory:  6.51GiB(13.70%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank1]:2025-10-29 15:05:28,512 - INFO -  step: 350  loss: -4.0000  grad_norm: 11.2855  memory:  9.42GiB(19.83%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank0]:2025-10-29 15:05:28,525 - INFO -  step: 350  loss: -4.0000  grad_norm: 11.2855  memory: 13.25GiB(27.89%)  tps: 8,778  tflops: 68.62  mfu: 21.99%
[rank3]:2025-10-29 15:05:28,737 - INFO - Avg. fwd time: 13.1676 / Avg. bwd time: 26.0395 / Avg. batch time: 386.4200 (ms) / GPU bubble ratio: 18.83%
[rank2]:2025-10-29 15:05:28,804 - INFO - Avg. fwd time: 7.3444 / Avg. bwd time: 16.1402 / Avg. batch time: 415.2100 (ms) / GPU bubble ratio: 54.75%
[rank1]:2025-10-29 15:05:28,844 - INFO - Avg. fwd time: 9.6417 / Avg. bwd time: 20.5156 / Avg. batch time: 451.0128 (ms) / GPU bubble ratio: 46.51%
[rank0]:2025-10-29 15:05:28,841 - INFO - Avg. fwd time: 7.9454 / Avg. bwd time: 16.3123 / Avg. batch time: 482.5683 (ms) / GPU bubble ratio: 59.79%
[rank0]:2025-10-29 15:06:59,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:07:01,704 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1507_rank3_trend_line.svg
[rank2]:2025-10-29 15:07:01,711 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1507_rank2_trend_line.svg
[rank1]:2025-10-29 15:07:01,731 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1507_rank1_trend_line.svg
[rank1]:2025-10-29 15:07:01,769 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 15:07:01,775 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3982  memory:  9.42GiB(19.83%)  tps: 8,784  tflops: 68.67  mfu: 22.01%
[rank1]:2025-10-29 15:07:01,775 - INFO - üîé  Running validation at step 400
[rank2]:2025-10-29 15:07:01,769 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:07:01,773 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3982  memory:  6.51GiB(13.70%)  tps: 8,784  tflops: 68.67  mfu: 22.01%
[rank2]:2025-10-29 15:07:01,773 - INFO - üîé  Running validation at step 400
[rank0]:2025-10-29 15:07:01,761 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1507_rank0_trend_line.svg
[rank0]:2025-10-29 15:07:01,768 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 15:07:01,774 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3982  memory: 13.25GiB(27.89%)  tps: 8,785  tflops: 68.68  mfu: 22.01%
[rank0]:2025-10-29 15:07:01,774 - INFO - üîé  Running validation at step 400
[rank3]:2025-10-29 15:07:01,969 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1507_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 346.00 ms, GPU Bubble Ratio: 44.04%, 29.96%, 46.55%, 23.81%
[rank3]:2025-10-29 15:07:01,970 - INFO - 	> Batch Time: 346.00 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-29 15:07:01,970 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:07:01,975 - INFO -  step: 400  loss:  1.5893  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,763  tflops: 68.51  mfu: 21.96%
[rank3]:2025-10-29 15:07:01,976 - INFO - üîé  Running validation at step 400
[rank0]:2025-10-29 15:07:21,148 - INFO - validate step: 400  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 21,142
[rank1]:2025-10-29 15:07:21,167 - INFO - validate step: 400  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 21,122
[rank3]:2025-10-29 15:07:21,191 - INFO - validate step: 400  loss:  0.5754  memory: 17.37GiB(36.56%)  tps: 21,317
[rank2]:2025-10-29 15:07:21,184 - INFO - validate step: 400  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 21,102
[rank1]:2025-10-29 15:07:21,282 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1507_stage1_step400.svg
[rank2]:2025-10-29 15:07:21,272 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1507_stage2_step400.svg
[rank0]:2025-10-29 15:07:21,283 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1507_stage0_step400.svg
[rank3]:2025-10-29 15:07:21,392 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1507_real_step400_rank3.svg
[rank3]:> Batch Time: 358.48 ms, GPU Bubble Ratio: 41.88%, 30.98%, 48.27%, 23.89%
[rank3]:2025-10-29 15:07:21,463 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1507_stage3_step400.svg
[rank3]:2025-10-29 15:07:21,649 - INFO - Avg. fwd time: 13.2025 / Avg. bwd time: 25.2953 / Avg. batch time: 380.6233 (ms) / GPU bubble ratio: 19.08%
[rank2]:2025-10-29 15:07:21,714 - INFO - Avg. fwd time: 7.3567 / Avg. bwd time: 16.0853 / Avg. batch time: 409.2268 (ms) / GPU bubble ratio: 54.17%
[rank0]:2025-10-29 15:07:21,750 - INFO - Avg. fwd time: 7.9000 / Avg. bwd time: 17.3540 / Avg. batch time: 477.7585 (ms) / GPU bubble ratio: 57.71%
[rank1]:2025-10-29 15:07:21,750 - INFO - Avg. fwd time: 9.6099 / Avg. bwd time: 21.0579 / Avg. batch time: 445.4671 (ms) / GPU bubble ratio: 44.92%
[rank0]:2025-10-29 15:08:51,800 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 15:08:53,648 - INFO -  step: 450  loss: -4.0000  grad_norm: 32.1423  memory:  9.42GiB(19.83%)  tps: 8,858  tflops: 69.25  mfu: 22.20%
[rank3]:2025-10-29 15:08:53,628 - INFO -  step: 450  loss:  1.6383  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,862  tflops: 69.28  mfu: 22.21%
[rank2]:2025-10-29 15:08:53,644 - INFO -  step: 450  loss: -4.0000  grad_norm: 32.1423  memory:  6.51GiB(13.70%)  tps: 8,860  tflops: 69.26  mfu: 22.20%
[rank0]:2025-10-29 15:08:53,660 - INFO -  step: 450  loss: -4.0000  grad_norm: 32.1423  memory: 13.25GiB(27.89%)  tps: 8,855  tflops: 69.23  mfu: 22.19%
[rank3]:2025-10-29 15:08:54,043 - INFO - Avg. fwd time: 13.2287 / Avg. bwd time: 24.7253 / Avg. batch time: 376.1961 (ms) / GPU bubble ratio: 19.29%
[rank2]:2025-10-29 15:08:54,066 - INFO - Avg. fwd time: 7.3649 / Avg. bwd time: 16.0417 / Avg. batch time: 404.7391 (ms) / GPU bubble ratio: 53.74%
[rank1]:2025-10-29 15:08:54,092 - INFO - Avg. fwd time: 9.6438 / Avg. bwd time: 20.8219 / Avg. batch time: 440.8712 (ms) / GPU bubble ratio: 44.72%
[rank0]:2025-10-29 15:08:54,123 - INFO - Avg. fwd time: 7.8638 / Avg. bwd time: 18.1447 / Avg. batch time: 473.7329 (ms) / GPU bubble ratio: 56.08%
[rank0]:2025-10-29 15:10:23,959 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:10:25,776 - INFO -  step: 500  loss:  1.6212  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,890  tflops: 69.50  mfu: 22.28%
[rank0]:2025-10-29 15:10:25,807 - INFO -  step: 500  loss: -4.0000  grad_norm: 23.6803  memory: 13.25GiB(27.89%)  tps: 8,890  tflops: 69.50  mfu: 22.28%
[rank1]:2025-10-29 15:10:25,796 - INFO -  step: 500  loss: -4.0000  grad_norm: 23.6803  memory:  9.42GiB(19.83%)  tps: 8,890  tflops: 69.50  mfu: 22.28%
[rank2]:2025-10-29 15:10:25,792 - INFO -  step: 500  loss: -4.0000  grad_norm: 23.6803  memory:  6.51GiB(13.70%)  tps: 8,890  tflops: 69.50  mfu: 22.28%
[rank2]:2025-10-29 15:10:25,882 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1510_stage2_step500.svg
[rank0]:2025-10-29 15:10:25,881 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1510_stage0_step500.svg
[rank1]:2025-10-29 15:10:25,881 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1510_stage1_step500.svg
[rank3]:2025-10-29 15:10:26,008 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1510_real_step500_rank3.svg
[rank3]:> Batch Time: 361.91 ms, GPU Bubble Ratio: 31.85%, 34.72%, 48.77%, 24.87%
[rank3]:2025-10-29 15:10:26,073 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1510_stage3_step500.svg
[rank3]:2025-10-29 15:10:26,256 - INFO - Avg. fwd time: 13.2428 / Avg. bwd time: 24.3291 / Avg. batch time: 373.0840 (ms) / GPU bubble ratio: 19.43%
[rank1]:2025-10-29 15:10:26,355 - INFO - Avg. fwd time: 9.6658 / Avg. bwd time: 20.6342 / Avg. batch time: 437.5674 (ms) / GPU bubble ratio: 44.60%
[rank2]:2025-10-29 15:10:26,319 - INFO - Avg. fwd time: 7.3689 / Avg. bwd time: 16.0120 / Avg. batch time: 401.5206 (ms) / GPU bubble ratio: 53.42%
[rank0]:2025-10-29 15:10:26,355 - INFO - Avg. fwd time: 7.8384 / Avg. bwd time: 18.6915 / Avg. batch time: 470.8270 (ms) / GPU bubble ratio: 54.92%
[rank0]:2025-10-29 15:11:56,355 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 15:11:58,197 - INFO -  step: 550  loss: -4.0000  grad_norm: 10.3888  memory:  6.51GiB(13.70%)  tps: 8,865  tflops: 69.31  mfu: 22.21%
[rank3]:2025-10-29 15:11:58,181 - INFO -  step: 550  loss:  1.6413  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,866  tflops: 69.31  mfu: 22.21%
[rank0]:2025-10-29 15:11:58,212 - INFO -  step: 550  loss: -4.0000  grad_norm: 10.3888  memory: 13.25GiB(27.89%)  tps: 8,865  tflops: 69.31  mfu: 22.21%
[rank1]:2025-10-29 15:11:58,201 - INFO -  step: 550  loss: -4.0000  grad_norm: 10.3888  memory:  9.42GiB(19.83%)  tps: 8,865  tflops: 69.31  mfu: 22.21%
[rank2]:2025-10-29 15:11:58,493 - INFO - Avg. fwd time: 7.3741 / Avg. bwd time: 15.9848 / Avg. batch time: 398.5446 (ms) / GPU bubble ratio: 53.11%
[rank3]:2025-10-29 15:11:58,429 - INFO - Avg. fwd time: 13.2584 / Avg. bwd time: 23.9511 / Avg. batch time: 370.1348 (ms) / GPU bubble ratio: 19.58%
[rank0]:2025-10-29 15:11:58,528 - INFO - Avg. fwd time: 7.8145 / Avg. bwd time: 19.2166 / Avg. batch time: 468.1403 (ms) / GPU bubble ratio: 53.81%
[rank1]:2025-10-29 15:11:58,528 - INFO - Avg. fwd time: 9.6896 / Avg. bwd time: 20.4553 / Avg. batch time: 434.5030 (ms) / GPU bubble ratio: 44.50%
[rank0]:2025-10-29 15:13:28,632 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 15:13:30,794 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1513_rank1_trend_line.svg
[rank2]:2025-10-29 15:13:30,767 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1513_rank2_trend_line.svg
[rank3]:2025-10-29 15:13:30,769 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1513_rank3_trend_line.svg
[rank0]:2025-10-29 15:13:30,827 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1513_rank0_trend_line.svg
[rank0]:2025-10-29 15:13:30,834 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 15:13:30,841 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6770  memory: 13.25GiB(27.89%)  tps: 8,844  tflops: 69.14  mfu: 22.16%
[rank0]:2025-10-29 15:13:30,841 - INFO - üîé  Running validation at step 600
[rank1]:2025-10-29 15:13:30,835 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-29 15:13:30,840 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6770  memory:  9.42GiB(19.83%)  tps: 8,843  tflops: 69.13  mfu: 22.16%
[rank1]:2025-10-29 15:13:30,840 - INFO - üîé  Running validation at step 600
[rank2]:2025-10-29 15:13:30,835 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:13:30,840 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6770  memory:  6.51GiB(13.70%)  tps: 8,843  tflops: 69.13  mfu: 22.16%
[rank2]:2025-10-29 15:13:30,840 - INFO - üîé  Running validation at step 600
[rank3]:2025-10-29 15:13:31,048 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1513_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 347.15 ms, GPU Bubble Ratio: 37.24%, 32.37%, 47.03%, 24.07%
[rank3]:2025-10-29 15:13:31,049 - INFO - 	> Batch Time: 347.15 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-29 15:13:31,050 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:13:31,058 - INFO -  step: 600  loss:  1.5870  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,820  tflops: 68.95  mfu: 22.10%
[rank3]:2025-10-29 15:13:31,058 - INFO - üîé  Running validation at step 600
[rank0]:2025-10-29 15:13:50,440 - INFO - validate step: 600  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 20,899
[rank1]:2025-10-29 15:13:50,457 - INFO - validate step: 600  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,881
[rank2]:2025-10-29 15:13:50,476 - INFO - validate step: 600  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 20,861
[rank3]:2025-10-29 15:13:50,480 - INFO - validate step: 600  loss:  0.5784  memory: 17.37GiB(36.56%)  tps: 21,091
[rank0]:2025-10-29 15:13:50,560 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1513_stage0_step600.svg
[rank1]:2025-10-29 15:13:50,559 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1513_stage1_step600.svg
[rank2]:2025-10-29 15:13:50,558 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1513_stage2_step600.svg
[rank3]:2025-10-29 15:13:50,687 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1513_real_step600_rank3.svg
[rank3]:> Batch Time: 361.41 ms, GPU Bubble Ratio: 31.53%, 36.28%, 48.67%, 24.87%
[rank3]:2025-10-29 15:13:50,760 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1513_stage3_step600.svg
[rank2]:2025-10-29 15:13:51,141 - INFO - Avg. fwd time: 7.3783 / Avg. bwd time: 15.9635 / Avg. batch time: 396.1237 (ms) / GPU bubble ratio: 52.86%
[rank3]:2025-10-29 15:13:51,117 - INFO - Avg. fwd time: 13.2725 / Avg. bwd time: 23.6413 / Avg. batch time: 367.7255 (ms) / GPU bubble ratio: 19.69%
[rank1]:2025-10-29 15:13:51,172 - INFO - Avg. fwd time: 9.7085 / Avg. bwd time: 20.3086 / Avg. batch time: 432.0125 (ms) / GPU bubble ratio: 44.41%
[rank0]:2025-10-29 15:13:51,196 - INFO - Avg. fwd time: 7.7954 / Avg. bwd time: 19.6516 / Avg. batch time: 465.9631 (ms) / GPU bubble ratio: 52.88%
[rank0]:2025-10-29 15:15:20,603 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 15:15:22,444 - INFO -  step: 650  loss: -4.0000  grad_norm:  2.5495  memory:  6.51GiB(13.70%)  tps: 8,907  tflops: 69.63  mfu: 22.32%
[rank3]:2025-10-29 15:15:22,429 - INFO -  step: 650  loss:  1.6015  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,910  tflops: 69.65  mfu: 22.32%
[rank0]:2025-10-29 15:15:22,461 - INFO -  step: 650  loss: -4.0000  grad_norm:  2.5495  memory: 13.25GiB(27.89%)  tps: 8,902  tflops: 69.59  mfu: 22.31%
[rank1]:2025-10-29 15:15:22,448 - INFO -  step: 650  loss: -4.0000  grad_norm:  2.5495  memory:  9.42GiB(19.83%)  tps: 8,905  tflops: 69.62  mfu: 22.31%
[rank3]:2025-10-29 15:15:22,678 - INFO - Avg. fwd time: 13.2848 / Avg. bwd time: 23.4193 / Avg. batch time: 366.0105 (ms) / GPU bubble ratio: 19.77%
[rank2]:2025-10-29 15:15:22,741 - INFO - Avg. fwd time: 7.3823 / Avg. bwd time: 15.9524 / Avg. batch time: 394.3491 (ms) / GPU bubble ratio: 52.66%
[rank0]:2025-10-29 15:15:22,736 - INFO - Avg. fwd time: 7.8326 / Avg. bwd time: 19.0509 / Avg. batch time: 464.1427 (ms) / GPU bubble ratio: 53.66%
[rank1]:2025-10-29 15:15:22,782 - INFO - Avg. fwd time: 9.6853 / Avg. bwd time: 20.6148 / Avg. batch time: 430.4811 (ms) / GPU bubble ratio: 43.69%
[rank0]:2025-10-29 15:16:52,271 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 15:16:54,128 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.3669  memory:  9.42GiB(19.83%)  tps: 8,935  tflops: 69.85  mfu: 22.39%
[rank2]:2025-10-29 15:16:54,124 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.3669  memory:  6.51GiB(13.70%)  tps: 8,935  tflops: 69.85  mfu: 22.39%
[rank3]:2025-10-29 15:16:54,109 - INFO -  step: 700  loss:  1.5696  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,936  tflops: 69.85  mfu: 22.39%
[rank0]:2025-10-29 15:16:54,140 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.3669  memory: 13.25GiB(27.89%)  tps: 8,936  tflops: 69.85  mfu: 22.39%
[rank0]:2025-10-29 15:16:54,219 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1516_stage0_step700.svg
[rank1]:2025-10-29 15:16:54,218 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1516_stage1_step700.svg
[rank2]:2025-10-29 15:16:54,218 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1516_stage2_step700.svg
[rank3]:2025-10-29 15:16:54,342 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1516_real_step700_rank3.svg
[rank3]:> Batch Time: 361.49 ms, GPU Bubble Ratio: 31.67%, 34.49%, 48.66%, 24.95%
[rank3]:2025-10-29 15:16:54,412 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1516_stage3_step700.svg
[rank3]:2025-10-29 15:16:54,602 - INFO - Avg. fwd time: 13.2951 / Avg. bwd time: 23.1931 / Avg. batch time: 364.2422 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-10-29 15:16:54,664 - INFO - Avg. fwd time: 7.3854 / Avg. bwd time: 15.9377 / Avg. batch time: 392.5156 (ms) / GPU bubble ratio: 52.46%
[rank0]:2025-10-29 15:16:54,658 - INFO - Avg. fwd time: 7.8677 / Avg. bwd time: 18.4452 / Avg. batch time: 462.2449 (ms) / GPU bubble ratio: 54.46%
[rank1]:2025-10-29 15:16:54,705 - INFO - Avg. fwd time: 9.6619 / Avg. bwd time: 20.9167 / Avg. batch time: 428.8829 (ms) / GPU bubble ratio: 42.96%
[rank0]:2025-10-29 15:18:24,050 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 15:18:25,909 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2232  memory:  6.51GiB(13.70%)  tps: 8,925  tflops: 69.77  mfu: 22.36%
[rank3]:2025-10-29 15:18:25,894 - INFO -  step: 750  loss:  1.5960  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,925  tflops: 69.78  mfu: 22.36%
[rank0]:2025-10-29 15:18:25,925 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2232  memory: 13.25GiB(27.89%)  tps: 8,925  tflops: 69.77  mfu: 22.36%
[rank1]:2025-10-29 15:18:25,913 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2232  memory:  9.42GiB(19.83%)  tps: 8,925  tflops: 69.77  mfu: 22.36%
[rank3]:2025-10-29 15:18:26,319 - INFO - Avg. fwd time: 13.3031 / Avg. bwd time: 22.9983 / Avg. batch time: 362.7131 (ms) / GPU bubble ratio: 19.93%
[rank1]:2025-10-29 15:18:26,375 - INFO - Avg. fwd time: 9.6420 / Avg. bwd time: 21.1792 / Avg. batch time: 427.5584 (ms) / GPU bubble ratio: 42.33%
[rank2]:2025-10-29 15:18:26,343 - INFO - Avg. fwd time: 7.3882 / Avg. bwd time: 15.9264 / Avg. batch time: 390.9881 (ms) / GPU bubble ratio: 52.30%
[rank0]:2025-10-29 15:18:26,400 - INFO - Avg. fwd time: 7.8980 / Avg. bwd time: 17.9241 / Avg. batch time: 460.6632 (ms) / GPU bubble ratio: 55.16%
[rank0]:2025-10-29 15:19:55,678 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 15:19:57,935 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1519_rank2_trend_line.svg
[rank1]:2025-10-29 15:19:57,966 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1519_rank1_trend_line.svg
[rank1]:2025-10-29 15:19:58,003 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 15:19:58,009 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1232  memory:  9.42GiB(19.83%)  tps: 8,895  tflops: 69.54  mfu: 22.29%
[rank1]:2025-10-29 15:19:58,009 - INFO - üîé  Running validation at step 800
[rank2]:2025-10-29 15:19:58,002 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:19:58,008 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1232  memory:  6.51GiB(13.70%)  tps: 8,895  tflops: 69.54  mfu: 22.29%
[rank2]:2025-10-29 15:19:58,008 - INFO - üîé  Running validation at step 800
[rank3]:2025-10-29 15:19:57,990 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1519_rank3_trend_line.svg
[rank0]:2025-10-29 15:19:57,995 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1519_rank0_trend_line.svg
[rank0]:2025-10-29 15:19:58,003 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 15:19:58,009 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1232  memory: 13.25GiB(27.89%)  tps: 8,896  tflops: 69.55  mfu: 22.29%
[rank0]:2025-10-29 15:19:58,009 - INFO - üîé  Running validation at step 800
[rank3]:2025-10-29 15:19:58,218 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1519_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 346.50 ms, GPU Bubble Ratio: 42.66%, 29.42%, 47.05%, 23.92%
[rank3]:2025-10-29 15:19:58,218 - INFO - 	> Batch Time: 346.50 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-29 15:19:58,219 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:19:58,226 - INFO -  step: 800  loss:  1.5690  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,873  tflops: 69.36  mfu: 22.23%
[rank3]:2025-10-29 15:19:58,226 - INFO - üîé  Running validation at step 800
[rank2]:2025-10-29 15:20:18,559 - INFO - validate step: 800  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 19,931
[rank2]:2025-10-29 15:20:18,560 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 15:20:18,563 - INFO - validate step: 800  loss:  0.5618  memory: 17.37GiB(36.56%)  tps: 20,142
[rank3]:2025-10-29 15:20:18,564 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 15:20:18,521 - INFO - validate step: 800  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 19,969
[rank0]:2025-10-29 15:20:18,522 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 15:20:18,528 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 15:20:18,539 - INFO - validate step: 800  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 19,952
[rank1]:2025-10-29 15:20:18,540 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 15:20:20,689 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.13 seconds.
[rank1]:2025-10-29 15:20:20,954 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.41 seconds.
[rank3]:2025-10-29 15:20:22,256 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.69 seconds.
[rank0]:2025-10-29 15:20:22,357 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 15:20:22,365 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.84 seconds.
[rank2]:2025-10-29 15:20:22,454 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1520_stage2_step800.svg
[rank1]:2025-10-29 15:20:22,454 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1520_stage1_step800.svg
[rank3]:2025-10-29 15:20:22,715 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1520_real_step800_rank3.svg
[rank3]:> Batch Time: 356.98 ms, GPU Bubble Ratio: 39.36%, 30.41%, 47.99%, 24.05%
[rank0]:2025-10-29 15:20:22,714 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1520_stage0_step800.svg
[rank3]:2025-10-29 15:20:22,792 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1520_stage3_step800.svg
[rank2]:2025-10-29 15:20:23,940 - INFO - Avg. fwd time: 7.3899 / Avg. bwd time: 15.9171 / Avg. batch time: 389.7710 (ms) / GPU bubble ratio: 52.16%
[rank3]:2025-10-29 15:20:23,912 - INFO - Avg. fwd time: 13.3077 / Avg. bwd time: 22.8504 / Avg. batch time: 361.5405 (ms) / GPU bubble ratio: 19.99%
[rank0]:2025-10-29 15:20:23,976 - INFO - Avg. fwd time: 7.9202 / Avg. bwd time: 17.5319 / Avg. batch time: 459.4044 (ms) / GPU bubble ratio: 55.68%
[rank1]:2025-10-29 15:20:23,977 - INFO - Avg. fwd time: 9.6255 / Avg. bwd time: 21.3738 / Avg. batch time: 426.4938 (ms) / GPU bubble ratio: 41.85%
[rank3]:2025-10-29 15:20:44,635 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 15:20:44,839 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 15:20:44,816 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 15:20:44,865 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 15:21:54,350 - INFO - [GC] Peforming periodical GC collection 0.28 seconds
[rank3]:2025-10-29 15:21:56,182 - INFO -  step: 850  loss:  1.6094  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,392  tflops: 65.61  mfu: 21.03%
[rank1]:2025-10-29 15:21:56,201 - INFO -  step: 850  loss: -4.0000  grad_norm:  7.0883  memory:  9.42GiB(19.83%)  tps: 8,388  tflops: 65.57  mfu: 21.02%
[rank2]:2025-10-29 15:21:56,197 - INFO -  step: 850  loss: -4.0000  grad_norm:  7.0883  memory:  6.51GiB(13.70%)  tps: 8,390  tflops: 65.59  mfu: 21.02%
[rank0]:2025-10-29 15:21:56,212 - INFO -  step: 850  loss: -4.0000  grad_norm:  7.0883  memory: 13.25GiB(27.89%)  tps: 8,386  tflops: 65.55  mfu: 21.01%
[rank2]:2025-10-29 15:21:56,490 - INFO - Avg. fwd time: 7.3919 / Avg. bwd time: 15.9079 / Avg. batch time: 388.8428 (ms) / GPU bubble ratio: 52.06%
[rank3]:2025-10-29 15:21:56,427 - INFO - Avg. fwd time: 13.3143 / Avg. bwd time: 22.7332 / Avg. batch time: 360.6499 (ms) / GPU bubble ratio: 20.04%
[rank1]:2025-10-29 15:21:56,526 - INFO - Avg. fwd time: 9.6401 / Avg. bwd time: 21.2489 / Avg. batch time: 425.4929 (ms) / GPU bubble ratio: 41.92%
[rank0]:2025-10-29 15:21:56,525 - INFO - Avg. fwd time: 7.9049 / Avg. bwd time: 17.8644 / Avg. batch time: 458.6381 (ms) / GPU bubble ratio: 55.05%
[rank0]:2025-10-29 15:23:26,537 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 15:23:28,379 - INFO -  step: 900  loss: -4.0000  grad_norm: 12.4902  memory:  9.42GiB(19.83%)  tps: 8,887  tflops: 69.48  mfu: 22.27%
[rank2]:2025-10-29 15:23:28,374 - INFO -  step: 900  loss: -4.0000  grad_norm: 12.4902  memory:  6.51GiB(13.70%)  tps: 8,887  tflops: 69.48  mfu: 22.27%
[rank3]:2025-10-29 15:23:28,359 - INFO -  step: 900  loss:  1.6184  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,887  tflops: 69.48  mfu: 22.27%
[rank0]:2025-10-29 15:23:28,391 - INFO -  step: 900  loss: -4.0000  grad_norm: 12.4902  memory: 13.25GiB(27.89%)  tps: 8,887  tflops: 69.48  mfu: 22.27%
[rank1]:2025-10-29 15:23:28,466 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1523_stage1_step900.svg
[rank2]:2025-10-29 15:23:28,465 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1523_stage2_step900.svg
[rank0]:2025-10-29 15:23:28,465 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1523_stage0_step900.svg
[rank3]:2025-10-29 15:23:28,595 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1523_real_step900_rank3.svg
[rank3]:> Batch Time: 361.31 ms, GPU Bubble Ratio: 31.61%, 34.27%, 48.61%, 24.99%
[rank3]:2025-10-29 15:23:28,660 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1523_stage3_step900.svg
[rank3]:2025-10-29 15:23:29,014 - INFO - Avg. fwd time: 13.3197 / Avg. bwd time: 22.5984 / Avg. batch time: 359.5998 (ms) / GPU bubble ratio: 20.09%
[rank1]:2025-10-29 15:23:29,067 - INFO - Avg. fwd time: 9.6562 / Avg. bwd time: 21.1055 / Avg. batch time: 424.3549 (ms) / GPU bubble ratio: 42.01%
[rank2]:2025-10-29 15:23:29,039 - INFO - Avg. fwd time: 7.3938 / Avg. bwd time: 15.8996 / Avg. batch time: 387.7966 (ms) / GPU bubble ratio: 51.95%
[rank0]:2025-10-29 15:23:29,099 - INFO - Avg. fwd time: 7.8868 / Avg. bwd time: 18.2332 / Avg. batch time: 457.7386 (ms) / GPU bubble ratio: 54.35%
[rank0]:2025-10-29 15:24:59,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 15:25:00,978 - INFO -  step: 950  loss: -4.0000  grad_norm:  9.2434  memory:  9.42GiB(19.83%)  tps: 8,847  tflops: 69.16  mfu: 22.17%
[rank2]:2025-10-29 15:25:00,974 - INFO -  step: 950  loss: -4.0000  grad_norm:  9.2434  memory:  6.51GiB(13.70%)  tps: 8,847  tflops: 69.16  mfu: 22.17%
[rank3]:2025-10-29 15:25:00,959 - INFO -  step: 950  loss:  1.6004  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,847  tflops: 69.16  mfu: 22.17%
[rank0]:2025-10-29 15:25:00,990 - INFO -  step: 950  loss: -4.0000  grad_norm:  9.2434  memory: 13.25GiB(27.89%)  tps: 8,847  tflops: 69.16  mfu: 22.17%
[rank3]:2025-10-29 15:25:01,207 - INFO - Avg. fwd time: 13.3255 / Avg. bwd time: 22.4977 / Avg. batch time: 358.8289 (ms) / GPU bubble ratio: 20.13%
[rank2]:2025-10-29 15:25:01,269 - INFO - Avg. fwd time: 7.3957 / Avg. bwd time: 15.8961 / Avg. batch time: 386.9939 (ms) / GPU bubble ratio: 51.85%
[rank0]:2025-10-29 15:25:01,305 - INFO - Avg. fwd time: 7.8741 / Avg. bwd time: 18.5205 / Avg. batch time: 457.0602 (ms) / GPU bubble ratio: 53.80%
[rank1]:2025-10-29 15:25:01,306 - INFO - Avg. fwd time: 9.6693 / Avg. bwd time: 20.9988 / Avg. batch time: 423.4891 (ms) / GPU bubble ratio: 42.07%
[rank0]:2025-10-29 15:26:31,377 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 15:26:33,221 - INFO -  step: 1000  loss: -4.0000  grad_norm:  6.3061  memory:  6.51GiB(13.70%)  tps: 8,881  tflops: 69.42  mfu: 22.25%
[rank2]:2025-10-29 15:26:33,221 - INFO - üîé  Running validation at step 1000
[rank3]:2025-10-29 15:26:33,205 - INFO -  step: 1000  loss:  1.5540  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,881  tflops: 69.43  mfu: 22.25%
[rank3]:2025-10-29 15:26:33,206 - INFO - üîé  Running validation at step 1000
[rank0]:2025-10-29 15:26:33,237 - INFO -  step: 1000  loss: -4.0000  grad_norm:  6.3061  memory: 13.25GiB(27.89%)  tps: 8,880  tflops: 69.42  mfu: 22.25%
[rank0]:2025-10-29 15:26:33,237 - INFO - üîé  Running validation at step 1000
[rank1]:2025-10-29 15:26:33,225 - INFO -  step: 1000  loss: -4.0000  grad_norm:  6.3061  memory:  9.42GiB(19.83%)  tps: 8,881  tflops: 69.42  mfu: 22.25%
[rank1]:2025-10-29 15:26:33,226 - INFO - üîé  Running validation at step 1000
[rank1]:2025-10-29 15:26:52,727 - INFO - validate step: 1000  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 21,004
[rank2]:2025-10-29 15:26:52,746 - INFO - validate step: 1000  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 20,978
[rank3]:2025-10-29 15:26:52,751 - INFO - validate step: 1000  loss:  0.5557  memory: 17.37GiB(36.56%)  tps: 20,958
[rank0]:2025-10-29 15:26:52,709 - INFO - validate step: 1000  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 21,036
[rank1]:2025-10-29 15:26:52,829 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1526_stage1_step1000.svg
[rank2]:2025-10-29 15:26:52,827 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1526_stage2_step1000.svg
[rank0]:2025-10-29 15:26:52,830 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1526_stage0_step1000.svg
[rank3]:2025-10-29 15:26:52,952 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1526_real_step1000_rank3.svg
[rank3]:> Batch Time: 361.05 ms, GPU Bubble Ratio: 31.41%, 35.87%, 48.55%, 24.95%
[rank3]:2025-10-29 15:26:53,019 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1526_stage3_step1000.svg
[rank3]:2025-10-29 15:26:53,209 - INFO - Avg. fwd time: 13.3288 / Avg. bwd time: 22.3873 / Avg. batch time: 357.9583 (ms) / GPU bubble ratio: 20.18%
[rank0]:2025-10-29 15:26:53,306 - INFO - Avg. fwd time: 7.8589 / Avg. bwd time: 18.8191 / Avg. batch time: 456.2672 (ms) / GPU bubble ratio: 53.22%
[rank1]:2025-10-29 15:26:53,306 - INFO - Avg. fwd time: 9.6810 / Avg. bwd time: 20.8815 / Avg. batch time: 422.5044 (ms) / GPU bubble ratio: 42.13%
[rank2]:2025-10-29 15:26:53,270 - INFO - Avg. fwd time: 7.3967 / Avg. bwd time: 15.8891 / Avg. batch time: 386.0849 (ms) / GPU bubble ratio: 51.75%
[rank0]:2025-10-29 15:28:23,351 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 15:28:25,186 - INFO -  step: 1050  loss:  1.5605  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,863  tflops: 69.28  mfu: 22.21%
[rank0]:2025-10-29 15:28:25,217 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.0167  memory: 13.25GiB(27.89%)  tps: 8,856  tflops: 69.23  mfu: 22.19%
[rank2]:2025-10-29 15:28:25,201 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.0167  memory:  6.51GiB(13.70%)  tps: 8,861  tflops: 69.27  mfu: 22.20%
[rank1]:2025-10-29 15:28:25,206 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.0167  memory:  9.42GiB(19.83%)  tps: 8,858  tflops: 69.25  mfu: 22.20%
[rank2]:2025-10-29 15:28:25,636 - INFO - Avg. fwd time: 7.3976 / Avg. bwd time: 15.8833 / Avg. batch time: 385.3187 (ms) / GPU bubble ratio: 51.66%
[rank1]:2025-10-29 15:28:25,665 - INFO - Avg. fwd time: 9.6915 / Avg. bwd time: 20.7764 / Avg. batch time: 421.6701 (ms) / GPU bubble ratio: 42.20%
[rank3]:2025-10-29 15:28:25,610 - INFO - Avg. fwd time: 13.3321 / Avg. bwd time: 22.2892 / Avg. batch time: 357.1869 (ms) / GPU bubble ratio: 20.22%
[rank0]:2025-10-29 15:28:25,698 - INFO - Avg. fwd time: 7.8442 / Avg. bwd time: 19.0869 / Avg. batch time: 455.6037 (ms) / GPU bubble ratio: 52.71%
[rank0]:2025-10-29 15:29:55,691 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 15:29:57,557 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.0296  memory:  6.51GiB(13.70%)  tps: 8,870  tflops: 69.34  mfu: 22.23%
[rank1]:2025-10-29 15:29:57,561 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.0296  memory:  9.42GiB(19.83%)  tps: 8,870  tflops: 69.34  mfu: 22.23%
[rank3]:2025-10-29 15:29:57,541 - INFO -  step: 1100  loss:  1.5578  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,870  tflops: 69.34  mfu: 22.23%
[rank0]:2025-10-29 15:29:57,574 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.0296  memory: 13.25GiB(27.89%)  tps: 8,870  tflops: 69.34  mfu: 22.22%
[rank2]:2025-10-29 15:29:57,652 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1529_stage2_step1100.svg
[rank1]:2025-10-29 15:29:57,652 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1529_stage1_step1100.svg
[rank0]:2025-10-29 15:29:57,652 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1529_stage0_step1100.svg
[rank3]:2025-10-29 15:29:57,781 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1529_real_step1100_rank3.svg
[rank3]:> Batch Time: 360.92 ms, GPU Bubble Ratio: 31.29%, 35.97%, 48.52%, 24.94%
[rank3]:2025-10-29 15:29:57,849 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1529_stage3_step1100.svg
[rank3]:2025-10-29 15:29:58,040 - INFO - Avg. fwd time: 13.3350 / Avg. bwd time: 22.2130 / Avg. batch time: 356.5902 (ms) / GPU bubble ratio: 20.25%
[rank0]:2025-10-29 15:29:58,140 - INFO - Avg. fwd time: 7.8338 / Avg. bwd time: 19.2986 / Avg. batch time: 455.0743 (ms) / GPU bubble ratio: 52.30%
[rank2]:2025-10-29 15:29:58,104 - INFO - Avg. fwd time: 7.3986 / Avg. bwd time: 15.8801 / Avg. batch time: 384.6971 (ms) / GPU bubble ratio: 51.59%
[rank1]:2025-10-29 15:29:58,140 - INFO - Avg. fwd time: 9.7000 / Avg. bwd time: 20.6965 / Avg. batch time: 421.0027 (ms) / GPU bubble ratio: 42.24%
[rank0]:2025-10-29 15:31:28,427 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:31:30,293 - INFO -  step: 1150  loss:  1.5781  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,832  tflops: 69.05  mfu: 22.13%
[rank0]:2025-10-29 15:31:30,324 - INFO -  step: 1150  loss: -4.0000  grad_norm:  1.8483  memory: 13.25GiB(27.89%)  tps: 8,832  tflops: 69.05  mfu: 22.13%
[rank2]:2025-10-29 15:31:30,309 - INFO -  step: 1150  loss: -4.0000  grad_norm:  1.8483  memory:  6.51GiB(13.70%)  tps: 8,832  tflops: 69.05  mfu: 22.13%
[rank1]:2025-10-29 15:31:30,314 - INFO -  step: 1150  loss: -4.0000  grad_norm:  1.8483  memory:  9.42GiB(19.83%)  tps: 8,832  tflops: 69.05  mfu: 22.13%
[rank3]:2025-10-29 15:31:30,549 - INFO - Avg. fwd time: 13.3395 / Avg. bwd time: 22.1337 / Avg. batch time: 355.9820 (ms) / GPU bubble ratio: 20.28%
[rank0]:2025-10-29 15:31:30,650 - INFO - Avg. fwd time: 7.8240 / Avg. bwd time: 19.5270 / Avg. batch time: 454.5767 (ms) / GPU bubble ratio: 51.87%
[rank2]:2025-10-29 15:31:30,613 - INFO - Avg. fwd time: 7.4001 / Avg. bwd time: 15.8784 / Avg. batch time: 384.0993 (ms) / GPU bubble ratio: 51.52%
[rank1]:2025-10-29 15:31:30,650 - INFO - Avg. fwd time: 9.7104 / Avg. bwd time: 20.6137 / Avg. batch time: 420.3522 (ms) / GPU bubble ratio: 42.29%
[rank0]:2025-10-29 15:33:00,907 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 15:33:02,789 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2265  memory:  6.51GiB(13.70%)  tps: 8,858  tflops: 69.25  mfu: 22.20%
[rank2]:2025-10-29 15:33:02,789 - INFO - üîé  Running validation at step 1200
[rank1]:2025-10-29 15:33:02,793 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2265  memory:  9.42GiB(19.83%)  tps: 8,858  tflops: 69.25  mfu: 22.20%
[rank1]:2025-10-29 15:33:02,794 - INFO - üîé  Running validation at step 1200
[rank3]:2025-10-29 15:33:02,774 - INFO -  step: 1200  loss:  1.5608  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,858  tflops: 69.25  mfu: 22.20%
[rank3]:2025-10-29 15:33:02,774 - INFO - üîé  Running validation at step 1200
[rank0]:2025-10-29 15:33:02,805 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2265  memory: 13.25GiB(27.89%)  tps: 8,858  tflops: 69.25  mfu: 22.20%
[rank0]:2025-10-29 15:33:02,805 - INFO - üîé  Running validation at step 1200
[rank1]:2025-10-29 15:33:22,921 - INFO - validate step: 1200  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,351
[rank3]:2025-10-29 15:33:22,946 - INFO - validate step: 1200  loss:  0.5563  memory: 17.37GiB(36.56%)  tps: 20,306
[rank0]:2025-10-29 15:33:22,902 - INFO - validate step: 1200  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 20,381
[rank2]:2025-10-29 15:33:22,940 - INFO - validate step: 1200  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 20,327
[rank2]:2025-10-29 15:33:23,028 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1533_stage2_step1200.svg
[rank1]:2025-10-29 15:33:23,025 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1533_stage1_step1200.svg
[rank0]:2025-10-29 15:33:23,026 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1533_stage0_step1200.svg
[rank3]:2025-10-29 15:33:23,149 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1533_real_step1200_rank3.svg
[rank3]:> Batch Time: 360.91 ms, GPU Bubble Ratio: 31.19%, 36.01%, 48.49%, 24.93%
[rank3]:2025-10-29 15:33:23,217 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1533_stage3_step1200.svg
[rank2]:2025-10-29 15:33:23,610 - INFO - Avg. fwd time: 7.4018 / Avg. bwd time: 15.8775 / Avg. batch time: 383.5737 (ms) / GPU bubble ratio: 51.45%
[rank1]:2025-10-29 15:33:23,640 - INFO - Avg. fwd time: 9.7196 / Avg. bwd time: 20.5385 / Avg. batch time: 419.7849 (ms) / GPU bubble ratio: 42.34%
[rank3]:2025-10-29 15:33:23,585 - INFO - Avg. fwd time: 13.3445 / Avg. bwd time: 22.0628 / Avg. batch time: 355.4447 (ms) / GPU bubble ratio: 20.31%
[rank0]:2025-10-29 15:33:23,674 - INFO - Avg. fwd time: 7.8149 / Avg. bwd time: 19.7353 / Avg. batch time: 454.1475 (ms) / GPU bubble ratio: 51.47%
[rank0]:2025-10-29 15:34:53,701 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 15:34:55,536 - INFO -  step: 1250  loss:  1.5747  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,848  tflops: 69.17  mfu: 22.17%
[rank0]:2025-10-29 15:34:55,568 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2033  memory: 13.25GiB(27.89%)  tps: 8,840  tflops: 69.11  mfu: 22.15%
[rank2]:2025-10-29 15:34:55,552 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2033  memory:  6.51GiB(13.70%)  tps: 8,846  tflops: 69.15  mfu: 22.16%
[rank1]:2025-10-29 15:34:55,556 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2033  memory:  9.42GiB(19.83%)  tps: 8,843  tflops: 69.13  mfu: 22.16%
[rank3]:2025-10-29 15:34:55,786 - INFO - Avg. fwd time: 13.3466 / Avg. bwd time: 22.0044 / Avg. batch time: 354.9877 (ms) / GPU bubble ratio: 20.33%
[rank0]:2025-10-29 15:34:55,884 - INFO - Avg. fwd time: 7.8063 / Avg. bwd time: 19.8983 / Avg. batch time: 453.7368 (ms) / GPU bubble ratio: 51.15%
[rank2]:2025-10-29 15:34:55,848 - INFO - Avg. fwd time: 7.4022 / Avg. bwd time: 15.8754 / Avg. batch time: 383.0946 (ms) / GPU bubble ratio: 51.39%
[rank1]:2025-10-29 15:34:55,884 - INFO - Avg. fwd time: 9.7255 / Avg. bwd time: 20.4772 / Avg. batch time: 419.2705 (ms) / GPU bubble ratio: 42.37%
[rank0]:2025-10-29 15:36:25,986 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:36:27,808 - INFO -  step: 1300  loss:  1.5674  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,878  tflops: 69.41  mfu: 22.25%
[rank2]:2025-10-29 15:36:27,823 - INFO -  step: 1300  loss: -4.0000  grad_norm:  1.2999  memory:  6.51GiB(13.70%)  tps: 8,878  tflops: 69.41  mfu: 22.25%
[rank1]:2025-10-29 15:36:27,827 - INFO -  step: 1300  loss: -4.0000  grad_norm:  1.2999  memory:  9.42GiB(19.83%)  tps: 8,878  tflops: 69.41  mfu: 22.25%
[rank0]:2025-10-29 15:36:27,839 - INFO -  step: 1300  loss: -4.0000  grad_norm:  1.2999  memory: 13.25GiB(27.89%)  tps: 8,878  tflops: 69.41  mfu: 22.25%
[rank2]:2025-10-29 15:36:27,919 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1536_stage2_step1300.svg
[rank1]:2025-10-29 15:36:27,918 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1536_stage1_step1300.svg
[rank0]:2025-10-29 15:36:27,918 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1536_stage0_step1300.svg
[rank3]:2025-10-29 15:36:28,041 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1536_real_step1300_rank3.svg
[rank3]:> Batch Time: 360.91 ms, GPU Bubble Ratio: 29.49%, 36.04%, 48.47%, 24.93%
[rank3]:2025-10-29 15:36:28,109 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1536_stage3_step1300.svg
[rank3]:2025-10-29 15:36:28,298 - INFO - Avg. fwd time: 13.3495 / Avg. bwd time: 21.9431 / Avg. batch time: 354.5119 (ms) / GPU bubble ratio: 20.36%
[rank2]:2025-10-29 15:36:28,360 - INFO - Avg. fwd time: 7.4032 / Avg. bwd time: 15.8745 / Avg. batch time: 382.5958 (ms) / GPU bubble ratio: 51.33%
[rank0]:2025-10-29 15:36:28,395 - INFO - Avg. fwd time: 7.7974 / Avg. bwd time: 20.0751 / Avg. batch time: 453.3088 (ms) / GPU bubble ratio: 50.81%
[rank1]:2025-10-29 15:36:28,395 - INFO - Avg. fwd time: 9.7329 / Avg. bwd time: 20.4130 / Avg. batch time: 418.7301 (ms) / GPU bubble ratio: 42.41%
[rank0]:2025-10-29 15:37:58,424 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 15:38:00,266 - INFO -  step: 1350  loss: -4.0000  grad_norm:  3.2185  memory:  6.51GiB(13.70%)  tps: 8,862  tflops: 69.28  mfu: 22.20%
[rank1]:2025-10-29 15:38:00,271 - INFO -  step: 1350  loss: -4.0000  grad_norm:  3.2185  memory:  9.42GiB(19.83%)  tps: 8,862  tflops: 69.28  mfu: 22.20%
[rank0]:2025-10-29 15:38:00,282 - INFO -  step: 1350  loss: -4.0000  grad_norm:  3.2185  memory: 13.25GiB(27.89%)  tps: 8,862  tflops: 69.28  mfu: 22.20%
[rank3]:2025-10-29 15:38:00,251 - INFO -  step: 1350  loss:  1.5646  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,862  tflops: 69.28  mfu: 22.20%
[rank3]:2025-10-29 15:38:00,671 - INFO - Avg. fwd time: 13.3506 / Avg. bwd time: 21.8842 / Avg. batch time: 354.0415 (ms) / GPU bubble ratio: 20.38%
[rank2]:2025-10-29 15:38:00,698 - INFO - Avg. fwd time: 7.4035 / Avg. bwd time: 15.8720 / Avg. batch time: 382.1332 (ms) / GPU bubble ratio: 51.27%
[rank1]:2025-10-29 15:38:00,729 - INFO - Avg. fwd time: 9.7384 / Avg. bwd time: 20.3509 / Avg. batch time: 418.2303 (ms) / GPU bubble ratio: 42.44%
[rank0]:2025-10-29 15:38:00,764 - INFO - Avg. fwd time: 7.7883 / Avg. bwd time: 20.2368 / Avg. batch time: 452.9135 (ms) / GPU bubble ratio: 50.50%
[rank0]:2025-10-29 15:39:30,690 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:39:32,525 - INFO -  step: 1400  loss:  1.5647  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,878  tflops: 69.40  mfu: 22.25%
[rank3]:2025-10-29 15:39:32,526 - INFO - üîé  Running validation at step 1400
[rank0]:2025-10-29 15:39:32,557 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1356  memory: 13.25GiB(27.89%)  tps: 8,878  tflops: 69.40  mfu: 22.24%
[rank0]:2025-10-29 15:39:32,557 - INFO - üîé  Running validation at step 1400
[rank2]:2025-10-29 15:39:32,541 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1356  memory:  6.51GiB(13.70%)  tps: 8,878  tflops: 69.40  mfu: 22.24%
[rank2]:2025-10-29 15:39:32,541 - INFO - üîé  Running validation at step 1400
[rank1]:2025-10-29 15:39:32,545 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1356  memory:  9.42GiB(19.83%)  tps: 8,878  tflops: 69.40  mfu: 22.24%
[rank1]:2025-10-29 15:39:32,545 - INFO - üîé  Running validation at step 1400
[rank0]:2025-10-29 15:39:52,714 - INFO - validate step: 1400  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 20,321
[rank1]:2025-10-29 15:39:52,732 - INFO - validate step: 1400  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,291
[rank3]:2025-10-29 15:39:52,756 - INFO - validate step: 1400  loss:  0.5546  memory: 17.37GiB(36.56%)  tps: 20,248
[rank2]:2025-10-29 15:39:52,749 - INFO - validate step: 1400  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 20,269
[rank2]:2025-10-29 15:39:52,839 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1539_stage2_step1400.svg
[rank1]:2025-10-29 15:39:52,843 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1539_stage1_step1400.svg
[rank0]:2025-10-29 15:39:52,842 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1539_stage0_step1400.svg
[rank3]:2025-10-29 15:39:52,961 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1539_real_step1400_rank3.svg
[rank3]:> Batch Time: 360.82 ms, GPU Bubble Ratio: 29.39%, 36.07%, 48.45%, 24.92%
[rank3]:2025-10-29 15:39:53,033 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1539_stage3_step1400.svg
[rank3]:2025-10-29 15:39:53,224 - INFO - Avg. fwd time: 13.3522 / Avg. bwd time: 21.8383 / Avg. batch time: 353.6850 (ms) / GPU bubble ratio: 20.40%
[rank2]:2025-10-29 15:39:53,288 - INFO - Avg. fwd time: 7.4040 / Avg. bwd time: 15.8705 / Avg. batch time: 381.7581 (ms) / GPU bubble ratio: 51.23%
[rank0]:2025-10-29 15:39:53,324 - INFO - Avg. fwd time: 7.7815 / Avg. bwd time: 20.3662 / Avg. batch time: 452.5892 (ms) / GPU bubble ratio: 50.25%
[rank1]:2025-10-29 15:39:53,325 - INFO - Avg. fwd time: 9.7435 / Avg. bwd time: 20.3021 / Avg. batch time: 417.8241 (ms) / GPU bubble ratio: 42.47%
[rank0]:2025-10-29 15:41:23,450 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 15:41:25,284 - INFO -  step: 1450  loss:  1.5610  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,854  tflops: 69.21  mfu: 22.18%
[rank1]:2025-10-29 15:41:25,304 - INFO -  step: 1450  loss: -4.0000  grad_norm:  3.2675  memory:  9.42GiB(19.83%)  tps: 8,849  tflops: 69.18  mfu: 22.17%
[rank2]:2025-10-29 15:41:25,300 - INFO -  step: 1450  loss: -4.0000  grad_norm:  3.2675  memory:  6.51GiB(13.70%)  tps: 8,851  tflops: 69.20  mfu: 22.18%
[rank0]:2025-10-29 15:41:25,315 - INFO -  step: 1450  loss: -4.0000  grad_norm:  3.2675  memory: 13.25GiB(27.89%)  tps: 8,847  tflops: 69.16  mfu: 22.17%
[rank3]:2025-10-29 15:41:25,539 - INFO - Avg. fwd time: 13.3534 / Avg. bwd time: 21.7877 / Avg. batch time: 353.2864 (ms) / GPU bubble ratio: 20.42%
[rank1]:2025-10-29 15:41:25,640 - INFO - Avg. fwd time: 9.7485 / Avg. bwd time: 20.2491 / Avg. batch time: 417.4000 (ms) / GPU bubble ratio: 42.51%
[rank2]:2025-10-29 15:41:25,602 - INFO - Avg. fwd time: 7.4041 / Avg. bwd time: 15.8686 / Avg. batch time: 381.3663 (ms) / GPU bubble ratio: 51.18%
[rank0]:2025-10-29 15:41:25,640 - INFO - Avg. fwd time: 7.7734 / Avg. bwd time: 20.5067 / Avg. batch time: 452.2556 (ms) / GPU bubble ratio: 49.98%
[rank0]:2025-10-29 15:42:55,863 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:42:57,725 - INFO -  step: 1500  loss:  1.5642  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,862  tflops: 69.28  mfu: 22.21%
[rank1]:2025-10-29 15:42:57,744 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1448  memory:  9.42GiB(19.83%)  tps: 8,862  tflops: 69.28  mfu: 22.20%
[rank2]:2025-10-29 15:42:57,740 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1448  memory:  6.51GiB(13.70%)  tps: 8,862  tflops: 69.28  mfu: 22.20%
[rank0]:2025-10-29 15:42:57,757 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1448  memory: 13.25GiB(27.89%)  tps: 8,862  tflops: 69.28  mfu: 22.20%
[rank1]:2025-10-29 15:42:57,841 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1542_stage1_step1500.svg
[rank2]:2025-10-29 15:42:57,841 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1542_stage2_step1500.svg
[rank0]:2025-10-29 15:42:57,841 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1542_stage0_step1500.svg
[rank3]:2025-10-29 15:42:57,963 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1542_real_step1500_rank3.svg
[rank3]:> Batch Time: 360.80 ms, GPU Bubble Ratio: 29.35%, 36.08%, 48.44%, 24.91%
[rank3]:2025-10-29 15:42:58,035 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1542_stage3_step1500.svg
[rank3]:2025-10-29 15:42:58,399 - INFO - Avg. fwd time: 13.3558 / Avg. bwd time: 21.7421 / Avg. batch time: 352.9344 (ms) / GPU bubble ratio: 20.44%
[rank1]:2025-10-29 15:42:58,457 - INFO - Avg. fwd time: 9.7541 / Avg. bwd time: 20.2025 / Avg. batch time: 417.0351 (ms) / GPU bubble ratio: 42.53%
[rank2]:2025-10-29 15:42:58,426 - INFO - Avg. fwd time: 7.4049 / Avg. bwd time: 15.8681 / Avg. batch time: 381.0241 (ms) / GPU bubble ratio: 51.14%
[rank0]:2025-10-29 15:42:58,492 - INFO - Avg. fwd time: 7.7668 / Avg. bwd time: 20.6393 / Avg. batch time: 451.9790 (ms) / GPU bubble ratio: 49.72%
[rank0]:2025-10-29 15:44:28,559 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 15:44:30,420 - INFO -  step: 1550  loss:  1.5589  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,838  tflops: 69.09  mfu: 22.14%
[rank0]:2025-10-29 15:44:30,452 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1395  memory: 13.25GiB(27.89%)  tps: 8,838  tflops: 69.09  mfu: 22.14%
[rank1]:2025-10-29 15:44:30,439 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1395  memory:  9.42GiB(19.83%)  tps: 8,838  tflops: 69.09  mfu: 22.14%
[rank2]:2025-10-29 15:44:30,439 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1395  memory:  6.51GiB(13.70%)  tps: 8,837  tflops: 69.09  mfu: 22.14%
[rank3]:2025-10-29 15:44:30,679 - INFO - Avg. fwd time: 13.3573 / Avg. bwd time: 21.7045 / Avg. batch time: 352.6406 (ms) / GPU bubble ratio: 20.46%
[rank0]:2025-10-29 15:44:30,779 - INFO - Avg. fwd time: 7.7625 / Avg. bwd time: 20.7475 / Avg. batch time: 451.7222 (ms) / GPU bubble ratio: 49.51%
[rank1]:2025-10-29 15:44:30,779 - INFO - Avg. fwd time: 9.7592 / Avg. bwd time: 20.1666 / Avg. batch time: 416.7067 (ms) / GPU bubble ratio: 42.55%
[rank2]:2025-10-29 15:44:30,745 - INFO - Avg. fwd time: 7.4057 / Avg. bwd time: 15.8686 / Avg. batch time: 380.7159 (ms) / GPU bubble ratio: 51.09%
[rank0]:2025-10-29 15:46:01,209 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 15:46:03,901 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1546_rank1_trend_line.svg
[rank2]:2025-10-29 15:46:03,878 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1546_rank2_trend_line.svg
[rank3]:2025-10-29 15:46:03,894 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1546_rank3_trend_line.svg
[rank0]:2025-10-29 15:46:03,952 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251029_1546_rank0_trend_line.svg
[rank0]:2025-10-29 15:46:03,960 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 15:46:03,968 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1782  memory: 13.25GiB(27.89%)  tps: 8,760  tflops: 68.48  mfu: 21.95%
[rank0]:2025-10-29 15:46:03,968 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.1782  tps: 8,924  tflops: 69.77  mfu: 21.26%
[rank0]:2025-10-29 15:46:03,968 - INFO - üîé  Running validation at step 1600
[rank1]:2025-10-29 15:46:03,960 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-29 15:46:03,967 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1782  memory:  9.42GiB(19.83%)  tps: 8,759  tflops: 68.47  mfu: 21.95%
[rank1]:2025-10-29 15:46:03,968 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.1782  tps: 8,924  tflops: 69.76  mfu: 21.26%
[rank1]:2025-10-29 15:46:03,968 - INFO - üîé  Running validation at step 1600
[rank2]:2025-10-29 15:46:03,960 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 15:46:03,968 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1782  memory:  6.51GiB(13.70%)  tps: 8,759  tflops: 68.47  mfu: 21.95%
[rank2]:2025-10-29 15:46:03,968 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.1782  tps: 8,924  tflops: 69.77  mfu: 21.26%
[rank2]:2025-10-29 15:46:03,968 - INFO - üîé  Running validation at step 1600
[rank3]:2025-10-29 15:46:04,164 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1546_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 346.49 ms, GPU Bubble Ratio: 34.82%, 32.67%, 47.12%, 23.80%
[rank3]:2025-10-29 15:46:04,165 - INFO - 	> Batch Time: 346.49 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-29 15:46:04,166 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 15:46:04,173 - INFO -  step: 1600  loss:  1.5506  grad_norm:  0.0000  memory: 17.37GiB(36.56%)  tps: 8,738  tflops: 68.31  mfu: 21.89%
[rank3]:2025-10-29 15:46:04,173 - INFO -  final step: 1600  loss:  1.5506  grad_norm:  0.0000  tps: 8,930  tflops: 69.81  mfu: 21.28%
[rank3]:2025-10-29 15:46:04,174 - INFO - üîé  Running validation at step 1600
[rank0]:2025-10-29 15:46:23,383 - INFO - validate step: 1600  loss: -1.0000  memory: 13.25GiB(27.89%)  tps: 21,098
[rank0]:2025-10-29 15:46:23,384 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 15:46:23,386 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-29 15:46:23,402 - INFO - validate step: 1600  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 21,077
[rank1]:2025-10-29 15:46:23,403 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 15:46:23,405 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-29 15:46:23,424 - INFO - validate step: 1600  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 21,054
[rank2]:2025-10-29 15:46:23,425 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 15:46:23,427 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-29 15:46:23,425 - INFO - validate step: 1600  loss:  0.5562  memory: 17.37GiB(36.56%)  tps: 21,278
[rank3]:2025-10-29 15:46:23,425 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 15:46:23,427 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-29 15:46:26,038 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 15:46:26,131 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251029_1546_stage0_final1600.svg
[rank1]:2025-10-29 15:46:26,131 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251029_1546_stage1_final1600.svg
[rank2]:2025-10-29 15:46:26,139 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251029_1546_stage2_final1600.svg
[rank3]:2025-10-29 15:46:26,245 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1546_real_final1600_rank3.svg
[rank3]:> Batch Time: 360.83 ms, GPU Bubble Ratio: 29.30%, 36.08%, 48.42%, 24.92%
[rank1]:2025-10-29 15:46:26,330 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/frozen_params_histogram/251029_1546_rank1_stage1.svg
[rank0]:2025-10-29 15:46:26,347 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/frozen_params_histogram/251029_1546_rank0_stage0.svg
[rank1]:	> Counts Sum: 1963200, Total Sum: 2203200 (89.11%), Ratio(%) per element: [88.97, 89.13, 88.97, 89.13, 88.97, 88.88, 89.21, 89.21, 89.05, 89.05, 88.97, 88.97, 89.13, 89.13, 89.21, 88.97, 89.05, 88.97, 89.13, 89.29, 89.21, 89.29, 89.13, 89.21, 89.13, 89.05, 88.97, 89.29, 89.21, 89.21, 88.97, 89.05, 89.21, 88.88, 89.05, 89.13, 89.05, 89.13, 89.05, 89.29, 89.13, 89.29, 89.13, 89.05, 89.13]
[rank1]:2025-10-29 15:46:26,330 - INFO - Destroying the purge thread.
[rank0]:	> Counts Sum: 1718080, Total Sum: 1811520 (94.84%), Ratio(%) per element: [94.85, 94.52, 94.52, 94.19, 94.19, 94.44, 94.28, 94.44, 94.19, 94.28, 94.44, 94.85, 94.6, 94.6, 94.77, 94.6, 94.93, 94.68, 94.6, 95.17, 95.17, 95.01, 95.09, 95.09, 95.01, 95.01, 95.09, 95.17, 95.34, 95.5, 95.01, 94.77, 95.34, 95.34, 95.09, 95.5, 95.26]
[rank0]:2025-10-29 15:46:26,347 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 15:46:26,371 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/frozen_params_histogram/251029_1546_rank2_stage2.svg
[rank2]:	> Counts Sum: 1527360, Total Sum: 1762560 (86.66%), Ratio(%) per element: [86.6, 86.6, 86.6, 86.6, 86.51, 86.43, 86.51, 86.43, 86.68, 86.51, 86.6, 86.6, 86.43, 86.51, 86.84, 86.84, 86.6, 86.51, 86.68, 86.84, 86.6, 86.76, 86.76, 86.6, 87.0, 86.6, 86.76, 86.68, 86.68, 86.76, 86.76, 86.68, 86.84, 86.76, 86.6, 86.68]
[rank2]:2025-10-29 15:46:26,371 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 15:46:26,430 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/pipeline_schedule/251029_1546_thry_final1600_rank3.svg
[rank3]:> Batch Time: 315.69 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 15:46:26,509 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251029_1546_stage3_final1600.svg
[rank1]:2025-10-29 15:46:26,615 - INFO - Process group destroyed
[rank2]:2025-10-29 15:46:26,618 - INFO - Process group destroyed
[rank3]:2025-10-29 15:46:26,697 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1/frozen_params_histogram/251029_1546_rank3_stage3.svg
[rank3]:	> Counts Sum: 34880, Total Sum: 1419840 (2.46%), Ratio(%) per element: [1.55, 2.12, 1.38, 1.87, 2.04, 1.38, 2.04, 1.47, 1.87, 2.85, 2.69, 2.85, 2.53, 2.69, 2.61, 3.18, 2.61, 3.18, 2.36, 3.34, 3.02, 3.43, 2.85, 2.61, 2.12, 2.85, 2.77, 2.69, 2.12]
[rank3]:2025-10-29 15:46:26,697 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 32-32, summary, console lines 367-377
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) ‚ñÅ
[rank3]:wandb:               final/avg_loss ‚ñÅ
[rank3]:wandb:             final/avg_mfu(%) ‚ñÅ
[rank3]:wandb:             final/avg_tflops ‚ñÅ
[rank3]:wandb:    final/avg_throughput(tps) ‚ñÅ
[rank3]:wandb:              final/grad_norm ‚ñÅ
[rank3]:wandb:               final/max_loss ‚ñÅ
[rank3]:wandb:                    grad_norm ‚ñà‚ñÑ‚ñÅ‚ñÉ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
[rank3]:wandb: loss_metrics/global_avg_loss ‚ñà‚ñà‚ñà‚ñÑ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
[rank3]:wandb: loss_metrics/global_max_loss ‚ñà‚ñà‚ñà‚ñÑ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.83478
[rank3]:wandb:               final/avg_loss 1.55057
[rank3]:wandb:             final/avg_mfu(%) 21.27575
[rank3]:wandb:             final/avg_tflops 69.80817
[rank3]:wandb:    final/avg_throughput(tps) 8929.68562
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 1.55057
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 1.55057
[rank3]:wandb: loss_metrics/global_max_loss 1.55057
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: üöÄ View run 1028_1F1B_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/pvh7ionq
[rank3]:wandb: ‚≠êÔ∏è View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1028_1F1B_timelyauto_dm1/20251029-1453/wandb/run-20251029_145315-pvh7ionq/logs
[rank3]:2025-10-29 15:46:28,094 - INFO - Process group destroyed
[rank0]:2025-10-29 15:46:28,347 - INFO - Training completed
[rank0]:2025-10-29 15:46:28,348 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 15:46:28,691 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.4', 'layers.8', 'layers.7', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.2', 'layers.3', 'layers.0', 'layers.1'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'output', 'norm', 'layers.15', 'layers.13'}
[rank3]:----- TimelyFreeze‚è∞ Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_1F1B_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1028_1F1B_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1028_1F1B_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1028_1F1B_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1028_1F1B_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_1F1B_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1028_1F1B_timelyauto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1028_1F1B_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
