
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 29. (ìˆ˜) 00:52:36 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/1028_GPipe_apf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-10-29 00:52:42,765 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-29 00:52:42,697 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 00:52:42,697 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-29 00:52:42,926 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 00:52:43,470 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 00:52:43,474 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:52:43,479 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-29 00:52:43,488 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 00:52:43,490 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 00:52:43,478 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 00:52:43,481 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 00:52:43,507 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 00:52:43,511 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:52:43,903 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 00:52:44,315 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 00:52:47,335 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 00:52:47,493 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-29 00:52:47,543 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 00:52:47,544 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 00:52:47,544 - INFO - Compiling the loss function with torch.compile
[rank1]:2025-10-29 00:52:47,495 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 00:52:47,543 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 00:52:47,544 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 00:52:47,592 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 00:52:47,593 - INFO - Compiling each TransformerBlock with torch.compile
[rank0]:2025-10-29 00:52:47,593 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 00:52:47,591 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 00:52:47,593 - INFO - Compiling each TransformerBlock with torch.compile
[rank1]:2025-10-29 00:52:47,593 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 00:52:47,778 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 00:52:47,778 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 00:52:47,779 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-29 00:52:47,773 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 00:52:47,773 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 00:52:47,774 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-29 00:52:47,688 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 00:52:47,727 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 00:52:47,729 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-29 00:52:47,776 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-29 00:52:47,778 - INFO - Compiling each TransformerBlock with torch.compile
[rank2]:2025-10-29 00:52:47,778 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 00:52:47,952 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 00:52:47,952 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 00:52:47,952 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run wqc0c8u8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1028_GPipe_apf_dm1/20251029-0052/wandb/run-20251029_005248-wqc0c8u8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/wqc0c8u8
[rank3]:2025-10-29 00:52:49,517 - INFO - WandB logging enabled
[rank3]:2025-10-29 00:52:49,518 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 00:52:49,557 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 00:52:49,559 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-29 00:52:49,610 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 00:52:49,611 - INFO - Compiling each TransformerBlock with torch.compile
[rank3]:2025-10-29 00:52:49,612 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 00:52:49,800 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 00:52:49,801 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 00:52:49,802 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 00:52:49,816 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 00:52:49,816 - INFO - Compiling the loss function with torch.compile
[rank1]:2025-10-29 00:52:49,816 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 00:52:49,817 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 00:52:49,816 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1028_GPipe_apf_dm1
[rank0]:2025-10-29 00:52:49,816 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 00:52:49,817 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 00:52:49,820 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 00:52:49,816 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 00:52:49,816 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 00:52:55,442 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1600 (warmup 100)
[rank0]:2025-10-29 00:52:55,442 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 00:52:58,069 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 00:52:58,069 - INFO - Finished loading the checkpoint in 2.62 seconds.
[rank0]:2025-10-29 00:52:58,069 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank0]:  warnings.warn(
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank1]:  warnings.warn(
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank2]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 00:53:10,961 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4634  memory: 13.97GiB(29.42%)  tps: 700  tflops: 5.47  mfu: 1.75%
[rank0]:2025-10-29 00:53:10,961 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:53:10,932 - INFO -  step:  1  loss:  9.8292  grad_norm: 53.4634  memory: 19.81GiB(41.70%)  tps: 767  tflops: 5.99  mfu: 1.92%
[rank3]:2025-10-29 00:53:10,933 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 00:53:10,922 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4634  memory: 11.16GiB(23.50%)  tps: 706  tflops: 5.52  mfu: 1.77%
[rank2]:2025-10-29 00:53:10,922 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 00:53:10,927 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4634  memory: 13.84GiB(29.13%)  tps: 701  tflops: 5.48  mfu: 1.76%
[rank1]:2025-10-29 00:53:10,927 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:53:25,544 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,545 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,546 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,546 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,546 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,546 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,547 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,547 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,547 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,548 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,548 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,548 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,549 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,549 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,549 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:53:25,549 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:53:25,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,602 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,602 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,602 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,602 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,602 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:53:25,602 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,629 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:53:25,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:54:57,103 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 00:54:59,329 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.4697  memory: 16.11GiB(33.90%)  tps: 7,406  tflops: 57.90  mfu: 18.56%
[rank3]:2025-10-29 00:54:59,338 - INFO -  step: 50  loss:  9.4433  grad_norm: 21.4697  memory: 22.25GiB(46.84%)  tps: 7,406  tflops: 57.90  mfu: 18.56%
[rank0]:2025-10-29 00:54:59,340 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.4697  memory: 17.74GiB(37.35%)  tps: 7,407  tflops: 57.91  mfu: 18.56%
[rank2]:2025-10-29 00:54:59,325 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.4697  memory: 12.98GiB(27.32%)  tps: 7,406  tflops: 57.90  mfu: 18.56%
[rank3]:2025-10-29 00:54:59,554 - INFO - Avg. fwd time: 11.6824 / Avg. bwd time: 39.4592 / Avg. batch time: 433.1183 (ms) / GPU bubble ratio: 5.54%
[rank2]:2025-10-29 00:54:59,646 - INFO - Avg. fwd time: 7.6838 / Avg. bwd time: 18.6234 / Avg. batch time: 463.0468 (ms) / GPU bubble ratio: 54.55%
[rank1]:2025-10-29 00:54:59,706 - INFO - Avg. fwd time: 10.3538 / Avg. bwd time: 24.0457 / Avg. batch time: 500.9230 (ms) / GPU bubble ratio: 45.06%
[rank0]:2025-10-29 00:54:59,694 - INFO - Avg. fwd time: 8.8733 / Avg. bwd time: 24.0468 / Avg. batch time: 537.2064 (ms) / GPU bubble ratio: 50.98%
[rank1]:2025-10-29 00:55:21,322 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:21,333 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:21,318 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:21,947 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:55:38,221 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:38,221 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:38,220 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:40,839 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:02,816 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:56:02,829 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:56:02,813 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:56:05,384 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:56:21,334 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:21,335 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:56:21,334 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:56:23,883 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:56:38,599 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:56:40,180 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:40,180 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:40,181 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0156  memory: 16.11GiB(33.90%)  tps: 8,123  tflops: 63.50  mfu: 20.35%
[rank2]:2025-10-29 00:56:40,180 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:56:40,180 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0156  memory: 12.98GiB(27.32%)  tps: 8,123  tflops: 63.50  mfu: 20.35%
[rank0]:2025-10-29 00:56:40,181 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 8,124  tflops: 63.51  mfu: 20.36%
[rank3]:2025-10-29 00:56:42,763 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:56:42,766 - INFO -  step: 100  loss: 10.1871  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 7,921  tflops: 61.92  mfu: 19.85%
[rank2]:2025-10-29 00:56:42,862 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0056_stage2_step100.svg
[rank0]:2025-10-29 00:56:42,863 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0056_stage0_step100.svg
[rank1]:2025-10-29 00:56:42,863 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0056_stage1_step100.svg
[rank3]:2025-10-29 00:56:42,993 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0056_real_step100_rank3.svg
[rank3]:> Batch Time: 500.85 ms, GPU Bubble Ratio: 47.40%, 45.44%, 57.74%, 18.69%
[rank3]:2025-10-29 00:56:43,059 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0056_stage3_step100.svg
[rank3]:2025-10-29 00:56:43,243 - INFO - Avg. fwd time: 12.0774 / Avg. bwd time: 35.4674 / Avg. batch time: 400.5069 (ms) / GPU bubble ratio: 5.03%
[rank2]:2025-10-29 00:56:43,336 - INFO - Avg. fwd time: 7.7077 / Avg. bwd time: 17.7844 / Avg. batch time: 449.7394 (ms) / GPU bubble ratio: 54.65%
[rank0]:2025-10-29 00:56:43,384 - INFO - Avg. fwd time: 8.8336 / Avg. bwd time: 17.2791 / Avg. batch time: 518.0210 (ms) / GPU bubble ratio: 59.67%
[rank1]:2025-10-29 00:56:43,396 - INFO - Avg. fwd time: 10.2711 / Avg. bwd time: 23.3084 / Avg. batch time: 487.8086 (ms) / GPU bubble ratio: 44.93%
[rank2]:2025-10-29 00:57:05,003 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:05,006 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:05,017 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:07,578 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:23,579 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:23,580 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:23,580 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:26,121 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:42,368 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:42,367 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:42,368 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:44,785 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:00,757 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:58:00,756 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:00,757 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:03,339 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:23,129 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 00:58:25,337 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:25,338 - INFO -  step: 150  loss: -4.0000  grad_norm: 50.1679  memory: 17.74GiB(37.35%)  tps: 7,790  tflops: 60.90  mfu: 19.52%
[rank2]:2025-10-29 00:58:25,322 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:58:25,323 - INFO -  step: 150  loss: -4.0000  grad_norm: 50.1679  memory: 12.98GiB(27.32%)  tps: 7,791  tflops: 60.91  mfu: 19.52%
[rank1]:2025-10-29 00:58:25,326 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:25,326 - INFO -  step: 150  loss: -4.0000  grad_norm: 50.1679  memory: 16.11GiB(33.90%)  tps: 7,791  tflops: 60.91  mfu: 19.52%
[rank3]:2025-10-29 00:58:27,767 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:27,769 - INFO -  step: 150  loss:  7.3974  grad_norm: 50.1679  memory: 23.62GiB(49.72%)  tps: 7,802  tflops: 60.99  mfu: 19.55%
[rank3]:2025-10-29 00:58:28,094 - INFO - Avg. fwd time: 12.1965 / Avg. bwd time: 33.7071 / Avg. batch time: 386.2524 (ms) / GPU bubble ratio: 4.93%
[rank2]:2025-10-29 00:58:28,115 - INFO - Avg. fwd time: 7.7062 / Avg. bwd time: 17.4201 / Avg. batch time: 449.0016 (ms) / GPU bubble ratio: 55.23%
[rank0]:2025-10-29 00:58:28,148 - INFO - Avg. fwd time: 8.7104 / Avg. bwd time: 14.4480 / Avg. batch time: 514.1510 (ms) / GPU bubble ratio: 63.97%
[rank1]:2025-10-29 00:58:28,143 - INFO - Avg. fwd time: 10.2388 / Avg. bwd time: 22.9996 / Avg. batch time: 487.2100 (ms) / GPU bubble ratio: 45.42%
[rank0]:2025-10-29 00:58:44,024 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:58:44,023 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:44,024 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:46,394 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:02,339 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:59:02,339 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:59:02,339 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:59:04,800 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:59:20,991 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:59:20,991 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:20,991 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:59:23,338 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:39,397 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:59:39,396 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:59:39,397 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:59:41,802 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:01,361 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:00:03,548 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:00:03,549 - INFO -  step: 200  loss: -4.0000  grad_norm: 27.7911  memory: 12.98GiB(27.32%)  tps: 8,340  tflops: 65.20  mfu: 20.90%
[rank2]:2025-10-29 01:00:03,549 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 01:00:03,563 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:03,563 - INFO -  step: 200  loss: -4.0000  grad_norm: 27.7911  memory: 17.74GiB(37.35%)  tps: 8,340  tflops: 65.20  mfu: 20.90%
[rank0]:2025-10-29 01:00:03,563 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 01:00:03,552 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:03,552 - INFO -  step: 200  loss: -4.0000  grad_norm: 27.7911  memory: 16.11GiB(33.90%)  tps: 8,340  tflops: 65.20  mfu: 20.90%
[rank1]:2025-10-29 01:00:03,552 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 01:00:05,912 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:05,914 - INFO -  step: 200  loss:  5.3128  grad_norm: 27.7911  memory: 23.62GiB(49.72%)  tps: 8,347  tflops: 65.25  mfu: 20.91%
[rank3]:2025-10-29 01:00:05,915 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 01:00:23,867 - INFO - validate step: 200  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 20,174
[rank1]:2025-10-29 01:00:23,880 - INFO - validate step: 200  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 20,150
[rank3]:2025-10-29 01:00:23,902 - INFO - validate step: 200  loss:  1.0976  memory: 23.62GiB(49.72%)  tps: 22,772
[rank2]:2025-10-29 01:00:23,896 - INFO - validate step: 200  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 20,130
[rank0]:2025-10-29 01:00:23,977 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0100_stage0_step200.svg
[rank1]:2025-10-29 01:00:23,976 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0100_stage1_step200.svg
[rank2]:2025-10-29 01:00:23,985 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0100_stage2_step200.svg
[rank3]:2025-10-29 01:00:24,090 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0100_real_step200_rank3.svg
[rank3]:> Batch Time: 378.54 ms, GPU Bubble Ratio: 81.94%, 30.61%, 50.26%, 17.52%
[rank3]:2025-10-29 01:00:24,157 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0100_stage3_step200.svg
[rank3]:2025-10-29 01:00:26,476 - INFO - Avg. fwd time: 12.3325 / Avg. bwd time: 32.0224 / Avg. batch time: 373.4016 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 01:00:26,672 - INFO - Avg. fwd time: 7.7085 / Avg. bwd time: 17.0676 / Avg. batch time: 440.1501 (ms) / GPU bubble ratio: 54.97%
[rank1]:2025-10-29 01:00:26,863 - INFO - Avg. fwd time: 10.2494 / Avg. bwd time: 22.6794 / Avg. batch time: 478.5183 (ms) / GPU bubble ratio: 44.95%
[rank0]:2025-10-29 01:00:26,897 - INFO - Avg. fwd time: 8.6481 / Avg. bwd time: 11.7659 / Avg. batch time: 502.5514 (ms) / GPU bubble ratio: 67.50%
[rank0]:2025-10-29 01:00:39,660 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:39,659 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:00:39,659 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:42,161 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:54,955 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:54,954 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:00:54,954 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:57,295 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:01:10,123 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:10,123 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:10,124 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:12,464 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:25,384 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:01:25,384 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:25,384 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:27,791 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:39,283 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:01:40,566 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:01:40,566 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1097  memory: 16.11GiB(33.90%)  tps: 10,683  tflops: 83.51  mfu: 26.77%
[rank2]:2025-10-29 01:01:40,566 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:40,566 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1097  memory: 12.98GiB(27.32%)  tps: 10,685  tflops: 83.53  mfu: 26.77%
[rank0]:2025-10-29 01:01:40,566 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:40,567 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1097  memory: 17.74GiB(37.35%)  tps: 10,681  tflops: 83.50  mfu: 26.76%
[rank3]:2025-10-29 01:01:43,013 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:43,015 - INFO -  step: 250  loss:  4.6269  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,355  tflops: 80.95  mfu: 25.95%
[rank3]:2025-10-29 01:01:43,110 - INFO - Avg. fwd time: 12.4735 / Avg. bwd time: 29.3030 / Avg. batch time: 352.4639 (ms) / GPU bubble ratio: 5.18%
[rank2]:2025-10-29 01:01:43,830 - INFO - Avg. fwd time: 7.7142 / Avg. bwd time: 15.6208 / Avg. batch time: 419.6469 (ms) / GPU bubble ratio: 55.51%
[rank0]:2025-10-29 01:01:43,883 - INFO - Avg. fwd time: 8.7846 / Avg. bwd time: 9.9441 / Avg. batch time: 479.0514 (ms) / GPU bubble ratio: 68.72%
[rank1]:2025-10-29 01:01:43,883 - INFO - Avg. fwd time: 10.2145 / Avg. bwd time: 20.5893 / Avg. batch time: 455.5669 (ms) / GPU bubble ratio: 45.91%
[rank0]:2025-10-29 01:02:02,483 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:02,472 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:02,468 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:04,838 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:17,522 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:17,522 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:17,522 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:19,845 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:32,598 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:32,597 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:32,597 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:35,060 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:48,003 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:48,003 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:48,002 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:50,426 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:01,794 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-29 01:03:03,074 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:03:03,075 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,929  tflops: 77.62  mfu: 24.88%
[rank2]:2025-10-29 01:03:03,074 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:03,074 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0545  memory: 12.98GiB(27.32%)  tps: 9,929  tflops: 77.62  mfu: 24.88%
[rank0]:2025-10-29 01:03:03,074 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:03,075 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 9,929  tflops: 77.62  mfu: 24.88%
[rank3]:2025-10-29 01:03:05,437 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:05,439 - INFO -  step: 300  loss:  3.3161  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 9,939  tflops: 77.70  mfu: 24.90%
[rank0]:2025-10-29 01:03:05,512 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0103_stage0_step300.svg
[rank1]:2025-10-29 01:03:05,512 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0103_stage1_step300.svg
[rank2]:2025-10-29 01:03:05,514 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0103_stage2_step300.svg
[rank3]:2025-10-29 01:03:05,650 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0103_real_step300_rank3.svg
[rank3]:> Batch Time: 369.99 ms, GPU Bubble Ratio: 78.78%, 32.03%, 49.70%, 17.88%
[rank3]:2025-10-29 01:03:05,721 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0103_stage3_step300.svg
[rank0]:2025-10-29 01:03:06,034 - INFO - Avg. fwd time: 8.7968 / Avg. bwd time: 9.1291 / Avg. batch time: 465.1503 (ms) / GPU bubble ratio: 69.17%
[rank1]:2025-10-29 01:03:06,029 - INFO - Avg. fwd time: 10.1835 / Avg. bwd time: 19.3816 / Avg. batch time: 442.3545 (ms) / GPU bubble ratio: 46.53%
[rank3]:2025-10-29 01:03:05,996 - INFO - Avg. fwd time: 12.5274 / Avg. bwd time: 27.5388 / Avg. batch time: 338.5803 (ms) / GPU bubble ratio: 5.33%
[rank2]:2025-10-29 01:03:06,012 - INFO - Avg. fwd time: 7.7099 / Avg. bwd time: 14.8365 / Avg. batch time: 407.9044 (ms) / GPU bubble ratio: 55.78%
[rank0]:2025-10-29 01:03:18,563 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:03:18,563 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:18,563 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:20,906 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:33,767 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:03:33,767 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:33,767 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:36,244 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:54,794 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:54,779 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:03:54,780 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:57,299 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:10,351 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:10,352 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:10,352 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:12,696 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:24,090 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:04:25,372 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:25,372 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0346  memory: 12.98GiB(27.32%)  tps: 9,954  tflops: 77.82  mfu: 24.94%
[rank1]:2025-10-29 01:04:25,372 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:25,372 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,954  tflops: 77.82  mfu: 24.94%
[rank0]:2025-10-29 01:04:25,372 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:25,373 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0346  memory: 17.74GiB(37.35%)  tps: 9,954  tflops: 77.82  mfu: 24.94%
[rank0]:2025-10-29 01:04:25,427 - INFO - Avg. fwd time: 8.7534 / Avg. bwd time: 8.6948 / Avg. batch time: 456.2718 (ms) / GPU bubble ratio: 69.41%
[rank3]:2025-10-29 01:04:27,783 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:27,785 - INFO -  step: 350  loss:  2.1386  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 9,948  tflops: 77.77  mfu: 24.93%
[rank3]:2025-10-29 01:04:27,875 - INFO - Avg. fwd time: 12.5534 / Avg. bwd time: 26.5129 / Avg. batch time: 330.4543 (ms) / GPU bubble ratio: 5.42%
[rank1]:2025-10-29 01:04:27,887 - INFO - Avg. fwd time: 10.2077 / Avg. bwd time: 18.5161 / Avg. batch time: 434.1845 (ms) / GPU bubble ratio: 47.08%
[rank2]:2025-10-29 01:04:27,895 - INFO - Avg. fwd time: 7.7058 / Avg. bwd time: 14.3903 / Avg. batch time: 400.4409 (ms) / GPU bubble ratio: 55.86%
[rank0]:2025-10-29 01:04:40,450 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:40,450 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:40,450 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:42,777 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:55,595 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:55,595 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:55,596 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:57,937 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:10,494 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:10,494 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:05:10,494 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:12,990 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:25,726 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:25,725 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:05:25,725 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:28,191 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:39,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:05:40,965 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:40,965 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0057  memory: 12.98GiB(27.32%)  tps: 10,837  tflops: 84.72  mfu: 27.15%
[rank2]:2025-10-29 01:05:40,965 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 01:05:40,965 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:05:40,965 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,837  tflops: 84.72  mfu: 27.15%
[rank1]:2025-10-29 01:05:40,965 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 01:05:40,965 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:40,966 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0057  memory: 17.74GiB(37.35%)  tps: 10,837  tflops: 84.72  mfu: 27.15%
[rank0]:2025-10-29 01:05:40,966 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 01:05:43,364 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:43,366 - INFO -  step: 400  loss:  1.5954  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,839  tflops: 84.73  mfu: 27.16%
[rank3]:2025-10-29 01:05:43,367 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 01:05:58,108 - INFO - validate step: 400  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 23,895
[rank2]:2025-10-29 01:05:58,138 - INFO - validate step: 400  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 23,852
[rank1]:2025-10-29 01:05:58,123 - INFO - validate step: 400  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 23,873
[rank3]:2025-10-29 01:05:58,141 - INFO - validate step: 400  loss:  0.7895  memory: 23.62GiB(49.72%)  tps: 27,725
[rank0]:2025-10-29 01:05:58,222 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0105_stage0_step400.svg
[rank2]:2025-10-29 01:05:58,224 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0105_stage2_step400.svg
[rank1]:2025-10-29 01:05:58,221 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0105_stage1_step400.svg
[rank3]:2025-10-29 01:05:58,351 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0105_real_step400_rank3.svg
[rank3]:> Batch Time: 359.12 ms, GPU Bubble Ratio: 78.19%, 31.79%, 48.66%, 18.02%
[rank3]:2025-10-29 01:05:58,424 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0105_stage3_step400.svg
[rank3]:2025-10-29 01:05:58,611 - INFO - Avg. fwd time: 12.6241 / Avg. bwd time: 25.2129 / Avg. batch time: 320.5270 (ms) / GPU bubble ratio: 5.56%
[rank0]:2025-10-29 01:05:58,751 - INFO - Avg. fwd time: 8.7093 / Avg. bwd time: 7.7217 / Avg. batch time: 444.5719 (ms) / GPU bubble ratio: 70.43%
[rank2]:2025-10-29 01:05:58,706 - INFO - Avg. fwd time: 7.7013 / Avg. bwd time: 13.7195 / Avg. batch time: 391.4483 (ms) / GPU bubble ratio: 56.22%
[rank1]:2025-10-29 01:05:58,737 - INFO - Avg. fwd time: 10.1737 / Avg. bwd time: 17.3048 / Avg. batch time: 423.7187 (ms) / GPU bubble ratio: 48.12%
[rank2]:2025-10-29 01:06:20,212 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:20,213 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:20,227 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:06:22,725 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:35,599 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:35,599 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:35,599 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:06:37,947 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:50,624 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:50,624 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:50,624 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:06:52,961 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:07:05,674 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:05,674 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:05,675 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:08,136 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:19,776 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:07:21,048 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:21,049 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0511  memory: 17.74GiB(37.35%)  tps: 9,877  tflops: 77.21  mfu: 24.75%
[rank1]:2025-10-29 01:07:21,048 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:07:21,048 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,879  tflops: 77.23  mfu: 24.75%
[rank2]:2025-10-29 01:07:21,048 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:21,048 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0511  memory: 12.98GiB(27.32%)  tps: 9,881  tflops: 77.24  mfu: 24.76%
[rank3]:2025-10-29 01:07:23,564 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:23,566 - INFO -  step: 450  loss:  2.9266  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 9,590  tflops: 74.97  mfu: 24.03%
[rank0]:2025-10-29 01:07:23,870 - INFO - Avg. fwd time: 8.6822 / Avg. bwd time: 7.4795 / Avg. batch time: 440.7804 (ms) / GPU bubble ratio: 70.67%
[rank2]:2025-10-29 01:07:23,846 - INFO - Avg. fwd time: 7.6997 / Avg. bwd time: 13.4147 / Avg. batch time: 388.9409 (ms) / GPU bubble ratio: 56.57%
[rank1]:2025-10-29 01:07:23,862 - INFO - Avg. fwd time: 10.1490 / Avg. bwd time: 16.6398 / Avg. batch time: 420.3561 (ms) / GPU bubble ratio: 49.02%
[rank3]:2025-10-29 01:07:23,829 - INFO - Avg. fwd time: 12.6522 / Avg. bwd time: 24.7447 / Avg. batch time: 316.9260 (ms) / GPU bubble ratio: 5.60%
[rank0]:2025-10-29 01:07:36,148 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:36,148 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:07:36,148 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:38,503 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:51,211 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:51,210 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:07:51,210 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:53,563 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:06,475 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:06,474 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:06,474 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:08,951 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:21,590 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:21,589 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:21,589 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:24,072 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:44,227 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:08:46,397 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:46,397 - INFO -  step: 500  loss: -4.0000  grad_norm: 39.5555  memory: 12.98GiB(27.32%)  tps: 9,598  tflops: 75.03  mfu: 24.05%
[rank1]:2025-10-29 01:08:46,400 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:46,401 - INFO -  step: 500  loss: -4.0000  grad_norm: 39.5555  memory: 16.11GiB(33.90%)  tps: 9,598  tflops: 75.03  mfu: 24.05%
[rank0]:2025-10-29 01:08:46,412 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:46,412 - INFO -  step: 500  loss: -4.0000  grad_norm: 39.5555  memory: 17.74GiB(37.35%)  tps: 9,597  tflops: 75.02  mfu: 24.05%
[rank3]:2025-10-29 01:08:48,745 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:48,748 - INFO -  step: 500  loss:  2.7068  grad_norm: 39.5555  memory: 23.62GiB(49.72%)  tps: 9,617  tflops: 75.18  mfu: 24.10%
[rank0]:2025-10-29 01:08:48,821 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0108_stage0_step500.svg
[rank0]:2025-10-29 01:08:48,879 - INFO - Avg. fwd time: 8.6614 / Avg. bwd time: 7.1624 / Avg. batch time: 436.3898 (ms) / GPU bubble ratio: 70.99%
[rank2]:2025-10-29 01:08:48,823 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0108_stage2_step500.svg
[rank1]:2025-10-29 01:08:48,820 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0108_stage1_step500.svg
[rank3]:2025-10-29 01:08:48,944 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0108_real_step500_rank3.svg
[rank3]:> Batch Time: 295.44 ms, GPU Bubble Ratio: 73.48%, 41.03%, 53.44%, 16.45%
[rank3]:2025-10-29 01:08:49,010 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0108_stage3_step500.svg
[rank1]:2025-10-29 01:08:49,112 - INFO - Avg. fwd time: 10.1699 / Avg. bwd time: 16.1689 / Avg. batch time: 416.4135 (ms) / GPU bubble ratio: 49.40%
[rank3]:2025-10-29 01:08:49,121 - INFO - Avg. fwd time: 12.6773 / Avg. bwd time: 24.2545 / Avg. batch time: 313.1528 (ms) / GPU bubble ratio: 5.65%
[rank2]:2025-10-29 01:08:49,117 - INFO - Avg. fwd time: 7.6976 / Avg. bwd time: 13.1435 / Avg. batch time: 385.3247 (ms) / GPU bubble ratio: 56.73%
[rank0]:2025-10-29 01:09:01,740 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:01,740 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:01,740 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:04,116 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:16,799 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:16,798 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:16,798 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:19,222 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:32,056 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:32,055 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:32,056 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:34,521 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:47,211 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:47,211 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:47,211 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:49,552 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:01,054 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:10:02,313 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:02,314 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,793  tflops: 84.37  mfu: 27.04%
[rank0]:2025-10-29 01:10:02,359 - INFO - Avg. fwd time: 8.6402 / Avg. bwd time: 6.7571 / Avg. batch time: 430.7238 (ms) / GPU bubble ratio: 71.40%
[rank1]:2025-10-29 01:10:02,313 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:02,314 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,791  tflops: 84.36  mfu: 27.04%
[rank2]:2025-10-29 01:10:02,313 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:02,314 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1086  memory: 12.98GiB(27.32%)  tps: 10,791  tflops: 84.36  mfu: 27.04%
[rank3]:2025-10-29 01:10:04,651 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:04,653 - INFO -  step: 550  loss:  2.2812  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,792  tflops: 84.37  mfu: 27.04%
[rank2]:2025-10-29 01:10:04,766 - INFO - Avg. fwd time: 7.6956 / Avg. bwd time: 12.8580 / Avg. batch time: 380.8817 (ms) / GPU bubble ratio: 56.83%
[rank3]:2025-10-29 01:10:04,753 - INFO - Avg. fwd time: 12.7006 / Avg. bwd time: 23.7413 / Avg. batch time: 309.1833 (ms) / GPU bubble ratio: 5.71%
[rank1]:2025-10-29 01:10:04,819 - INFO - Avg. fwd time: 10.1498 / Avg. bwd time: 15.6409 / Avg. batch time: 411.2861 (ms) / GPU bubble ratio: 49.83%
[rank0]:2025-10-29 01:10:17,401 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:17,402 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:17,401 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:19,784 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:32,396 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:32,395 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:32,395 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:34,852 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:47,677 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:47,677 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:47,677 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:50,002 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:02,745 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:11:02,745 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:02,745 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:11:05,088 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:24,503 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:11:26,695 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:26,696 - INFO -  step: 600  loss: -4.0000  grad_norm: 22.8398  memory: 17.74GiB(37.35%)  tps: 9,708  tflops: 75.89  mfu: 24.33%
[rank0]:2025-10-29 01:11:26,696 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 01:11:26,680 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:11:26,681 - INFO -  step: 600  loss: -4.0000  grad_norm: 22.8398  memory: 12.98GiB(27.32%)  tps: 9,710  tflops: 75.91  mfu: 24.33%
[rank2]:2025-10-29 01:11:26,681 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 01:11:26,680 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:26,680 - INFO -  step: 600  loss: -4.0000  grad_norm: 22.8398  memory: 16.11GiB(33.90%)  tps: 9,710  tflops: 75.91  mfu: 24.33%
[rank1]:2025-10-29 01:11:26,681 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 01:11:29,129 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:11:29,131 - INFO -  step: 600  loss:  1.2878  grad_norm: 22.8398  memory: 23.62GiB(49.72%)  tps: 9,697  tflops: 75.81  mfu: 24.30%
[rank3]:2025-10-29 01:11:29,131 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 01:11:44,946 - INFO - validate step: 600  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 22,443
[rank2]:2025-10-29 01:11:44,971 - INFO - validate step: 600  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 22,394
[rank1]:2025-10-29 01:11:44,957 - INFO - validate step: 600  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 22,412
[rank3]:2025-10-29 01:11:44,976 - INFO - validate step: 600  loss:  0.4739  memory: 23.62GiB(49.72%)  tps: 25,851
[rank0]:2025-10-29 01:11:45,054 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0111_stage0_step600.svg
[rank2]:2025-10-29 01:11:45,054 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0111_stage2_step600.svg
[rank1]:2025-10-29 01:11:45,053 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0111_stage1_step600.svg
[rank3]:2025-10-29 01:11:45,169 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0111_real_step600_rank3.svg
[rank3]:> Batch Time: 292.14 ms, GPU Bubble Ratio: 73.22%, 41.09%, 53.12%, 16.52%
[rank3]:2025-10-29 01:11:45,237 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0111_stage3_step600.svg
[rank2]:2025-10-29 01:11:45,520 - INFO - Avg. fwd time: 7.6945 / Avg. bwd time: 12.7045 / Avg. batch time: 379.6517 (ms) / GPU bubble ratio: 57.02%
[rank1]:2025-10-29 01:11:45,536 - INFO - Avg. fwd time: 10.1335 / Avg. bwd time: 15.2869 / Avg. batch time: 409.5811 (ms) / GPU bubble ratio: 50.35%
[rank3]:2025-10-29 01:11:45,502 - INFO - Avg. fwd time: 12.7076 / Avg. bwd time: 23.5091 / Avg. batch time: 307.3380 (ms) / GPU bubble ratio: 5.73%
[rank0]:2025-10-29 01:11:45,544 - INFO - Avg. fwd time: 8.6231 / Avg. bwd time: 6.5887 / Avg. batch time: 428.7467 (ms) / GPU bubble ratio: 71.62%
[rank0]:2025-10-29 01:11:58,235 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:11:58,235 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:58,235 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:00,719 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:13,386 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:13,386 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:13,385 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:15,709 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:28,454 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:28,454 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:28,454 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:31,108 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:43,873 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:43,873 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:43,873 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:46,451 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:57,801 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:12:59,083 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:59,083 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 11,050  tflops: 86.38  mfu: 27.69%
[rank1]:2025-10-29 01:12:59,083 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:59,083 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 11,051  tflops: 86.40  mfu: 27.69%
[rank2]:2025-10-29 01:12:59,082 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:59,083 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0599  memory: 12.98GiB(27.32%)  tps: 11,054  tflops: 86.41  mfu: 27.70%
[rank0]:2025-10-29 01:12:59,141 - INFO - Avg. fwd time: 8.6081 / Avg. bwd time: 6.1495 / Avg. batch time: 424.4754 (ms) / GPU bubble ratio: 72.19%
[rank3]:2025-10-29 01:13:01,572 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:01,575 - INFO -  step: 650  loss:  1.0909  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,695  tflops: 83.61  mfu: 26.80%
[rank1]:2025-10-29 01:13:01,683 - INFO - Avg. fwd time: 10.1215 / Avg. bwd time: 14.8728 / Avg. batch time: 405.8323 (ms) / GPU bubble ratio: 50.73%
[rank2]:2025-10-29 01:13:01,690 - INFO - Avg. fwd time: 7.6932 / Avg. bwd time: 12.4681 / Avg. batch time: 376.4139 (ms) / GPU bubble ratio: 57.15%
[rank3]:2025-10-29 01:13:01,677 - INFO - Avg. fwd time: 12.7375 / Avg. bwd time: 23.0496 / Avg. batch time: 303.8780 (ms) / GPU bubble ratio: 5.79%
[rank0]:2025-10-29 01:13:14,438 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:14,437 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:14,437 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:16,898 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:29,619 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:29,619 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:29,619 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:32,105 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:44,781 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:44,781 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:44,781 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:47,292 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:00,022 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:00,022 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:00,022 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:02,460 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:13,670 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:14:14,949 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:14,949 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,798  tflops: 84.41  mfu: 27.06%
[rank1]:2025-10-29 01:14:14,949 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:14,949 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,798  tflops: 84.41  mfu: 27.06%
[rank2]:2025-10-29 01:14:14,949 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:14,949 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0405  memory: 12.98GiB(27.32%)  tps: 10,798  tflops: 84.41  mfu: 27.06%
[rank3]:2025-10-29 01:14:17,541 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:17,543 - INFO -  step: 700  loss:  0.8819  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,784  tflops: 84.30  mfu: 27.02%
[rank0]:2025-10-29 01:14:17,625 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0114_stage0_step700.svg
[rank1]:2025-10-29 01:14:17,623 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0114_stage1_step700.svg
[rank2]:2025-10-29 01:14:17,633 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0114_stage2_step700.svg
[rank3]:2025-10-29 01:14:17,746 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0114_real_step700_rank3.svg
[rank3]:> Batch Time: 289.11 ms, GPU Bubble Ratio: 72.98%, 45.86%, 52.74%, 15.94%
[rank3]:2025-10-29 01:14:17,818 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0114_stage3_step700.svg
[rank3]:2025-10-29 01:14:18,015 - INFO - Avg. fwd time: 12.7594 / Avg. bwd time: 22.5809 / Avg. batch time: 300.2767 (ms) / GPU bubble ratio: 5.85%
[rank1]:2025-10-29 01:14:18,137 - INFO - Avg. fwd time: 10.1083 / Avg. bwd time: 14.4552 / Avg. batch time: 402.1836 (ms) / GPU bubble ratio: 51.14%
[rank2]:2025-10-29 01:14:18,106 - INFO - Avg. fwd time: 7.6909 / Avg. bwd time: 12.2294 / Avg. batch time: 373.2799 (ms) / GPU bubble ratio: 57.31%
[rank0]:2025-10-29 01:14:18,150 - INFO - Avg. fwd time: 8.5914 / Avg. bwd time: 5.7059 / Avg. batch time: 420.2973 (ms) / GPU bubble ratio: 72.79%
[rank0]:2025-10-29 01:14:39,412 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:39,397 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:39,397 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:41,919 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:54,767 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:54,768 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:54,767 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:57,280 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:09,874 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:09,874 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:09,874 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:12,262 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:25,014 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:25,014 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:25,014 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:27,370 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:38,678 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:15:40,003 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:40,004 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,632  tflops: 75.29  mfu: 24.13%
[rank0]:2025-10-29 01:15:40,003 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:40,004 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 9,632  tflops: 75.29  mfu: 24.13%
[rank2]:2025-10-29 01:15:40,003 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:40,003 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0452  memory: 12.98GiB(27.32%)  tps: 9,632  tflops: 75.30  mfu: 24.13%
[rank3]:2025-10-29 01:15:42,455 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:42,457 - INFO -  step: 750  loss:  0.4738  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 9,648  tflops: 75.42  mfu: 24.17%
[rank2]:2025-10-29 01:15:42,751 - INFO - Avg. fwd time: 7.6898 / Avg. bwd time: 12.1497 / Avg. batch time: 372.9239 (ms) / GPU bubble ratio: 57.44%
[rank3]:2025-10-29 01:15:42,734 - INFO - Avg. fwd time: 12.7626 / Avg. bwd time: 22.4710 / Avg. batch time: 299.3952 (ms) / GPU bubble ratio: 5.85%
[rank1]:2025-10-29 01:15:42,769 - INFO - Avg. fwd time: 10.0974 / Avg. bwd time: 14.2530 / Avg. batch time: 401.5470 (ms) / GPU bubble ratio: 51.49%
[rank0]:2025-10-29 01:15:42,777 - INFO - Avg. fwd time: 8.5812 / Avg. bwd time: 5.6442 / Avg. batch time: 419.5359 (ms) / GPU bubble ratio: 72.87%
[rank1]:2025-10-29 01:15:55,121 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:55,121 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:55,121 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:57,460 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:10,252 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:16:10,252 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:10,251 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:12,654 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:25,272 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:16:25,272 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:25,271 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:27,603 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:40,432 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:40,432 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:16:40,433 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:42,795 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:16:54,245 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:16:55,535 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:55,536 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0035  memory: 12.98GiB(27.32%)  tps: 10,846  tflops: 84.79  mfu: 27.18%
[rank2]:2025-10-29 01:16:55,536 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:16:55,536 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:16:55,536 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,846  tflops: 84.79  mfu: 27.18%
[rank0]:2025-10-29 01:16:55,536 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 01:16:55,536 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:55,536 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,846  tflops: 84.79  mfu: 27.18%
[rank1]:2025-10-29 01:16:55,536 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 01:16:58,014 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:58,016 - INFO -  step: 800  loss:  0.3667  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,842  tflops: 84.76  mfu: 27.17%
[rank3]:2025-10-29 01:16:58,016 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 01:17:13,516 - INFO - validate step: 800  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 22,782
[rank1]:2025-10-29 01:17:13,517 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 01:17:13,532 - INFO - validate step: 800  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 22,761
[rank2]:2025-10-29 01:17:13,532 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:17:13,500 - INFO - validate step: 800  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 22,802
[rank0]:2025-10-29 01:17:13,501 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:17:13,508 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-10-29 01:17:13,535 - INFO - validate step: 800  loss:  0.3860  memory: 23.62GiB(49.72%)  tps: 26,395
[rank3]:2025-10-29 01:17:13,536 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 01:17:15,329 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.80 seconds.
[rank1]:2025-10-29 01:17:15,816 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.30 seconds.
[rank0]:2025-10-29 01:17:17,213 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 01:17:17,221 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.72 seconds.
[rank3]:2025-10-29 01:17:17,587 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.05 seconds.
[rank2]:2025-10-29 01:17:17,682 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0117_stage2_step800.svg
[rank0]:2025-10-29 01:17:17,681 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0117_stage0_step800.svg
[rank1]:2025-10-29 01:17:17,681 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0117_stage1_step800.svg
[rank0]:2025-10-29 01:17:17,847 - INFO - Avg. fwd time: 8.5703 / Avg. bwd time: 5.3416 / Avg. batch time: 416.3177 (ms) / GPU bubble ratio: 73.27%
[rank3]:2025-10-29 01:17:17,885 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0117_real_step800_rank3.svg
[rank3]:> Batch Time: 288.29 ms, GPU Bubble Ratio: 72.93%, 45.98%, 52.66%, 15.95%
[rank3]:2025-10-29 01:17:17,960 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0117_stage3_step800.svg
[rank1]:2025-10-29 01:17:18,938 - INFO - Avg. fwd time: 10.0890 / Avg. bwd time: 13.9729 / Avg. batch time: 398.6873 (ms) / GPU bubble ratio: 51.72%
[rank2]:2025-10-29 01:17:18,946 - INFO - Avg. fwd time: 7.6886 / Avg. bwd time: 11.9876 / Avg. batch time: 370.4073 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-29 01:17:18,965 - INFO - Avg. fwd time: 12.7827 / Avg. bwd time: 22.1474 / Avg. batch time: 296.9529 (ms) / GPU bubble ratio: 5.90%
[rank1]:2025-10-29 01:17:31,432 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:31,432 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:31,432 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:34,286 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:35,975 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 01:17:36,173 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 01:17:36,184 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 01:17:36,183 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 01:17:47,022 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:47,022 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:47,023 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:49,923 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:18:11,599 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:11,595 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:18:11,611 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:18:14,149 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:18:26,878 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:26,878 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:18:26,878 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:18:29,449 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:18:41,330 - INFO - [GC] Peforming periodical GC collection 0.29 seconds
[rank0]:2025-10-29 01:18:42,591 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:18:42,591 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 9,195  tflops: 71.88  mfu: 23.04%
[rank1]:2025-10-29 01:18:42,591 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:18:42,592 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,197  tflops: 71.90  mfu: 23.04%
[rank2]:2025-10-29 01:18:42,591 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:42,591 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0355  memory: 12.98GiB(27.32%)  tps: 9,198  tflops: 71.91  mfu: 23.05%
[rank0]:2025-10-29 01:18:42,635 - INFO - Avg. fwd time: 8.5669 / Avg. bwd time: 5.2946 / Avg. batch time: 415.8539 (ms) / GPU bubble ratio: 73.33%
[rank3]:2025-10-29 01:18:45,082 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:18:45,084 - INFO -  step: 850  loss:  0.4349  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 8,948  tflops: 69.95  mfu: 22.42%
[rank3]:2025-10-29 01:18:45,183 - INFO - Avg. fwd time: 12.7831 / Avg. bwd time: 22.0815 / Avg. batch time: 296.6716 (ms) / GPU bubble ratio: 5.98%
[rank1]:2025-10-29 01:18:45,187 - INFO - Avg. fwd time: 10.0821 / Avg. bwd time: 13.8624 / Avg. batch time: 398.3137 (ms) / GPU bubble ratio: 51.91%
[rank2]:2025-10-29 01:18:45,194 - INFO - Avg. fwd time: 7.6885 / Avg. bwd time: 11.9336 / Avg. batch time: 370.2003 (ms) / GPU bubble ratio: 57.60%
[rank1]:2025-10-29 01:18:57,644 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:57,643 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:18:57,644 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:00,067 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:12,907 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:12,908 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:12,907 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:15,385 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:28,172 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:28,172 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:28,172 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:30,646 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:43,275 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:43,274 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:43,275 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:46,122 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:57,651 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:19:58,899 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:58,899 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,736  tflops: 83.93  mfu: 26.90%
[rank2]:2025-10-29 01:19:58,899 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:58,899 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0451  memory: 12.98GiB(27.32%)  tps: 10,735  tflops: 83.93  mfu: 26.90%
[rank0]:2025-10-29 01:19:58,899 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:58,899 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,735  tflops: 83.92  mfu: 26.90%
[rank3]:2025-10-29 01:20:01,561 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:01,564 - INFO -  step: 900  loss:  0.5461  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,712  tflops: 83.74  mfu: 26.84%
[rank1]:2025-10-29 01:20:01,637 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0119_stage1_step900.svg
[rank2]:2025-10-29 01:20:01,639 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0119_stage2_step900.svg
[rank0]:2025-10-29 01:20:01,637 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0119_stage0_step900.svg
[rank3]:2025-10-29 01:20:01,758 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0120_real_step900_rank3.svg
[rank3]:> Batch Time: 287.88 ms, GPU Bubble Ratio: 72.93%, 45.97%, 52.60%, 15.96%
[rank3]:2025-10-29 01:20:01,825 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0120_stage3_step900.svg
[rank3]:2025-10-29 01:20:02,092 - INFO - Avg. fwd time: 12.8026 / Avg. bwd time: 21.7735 / Avg. batch time: 294.3351 (ms) / GPU bubble ratio: 6.02%
[rank1]:2025-10-29 01:20:02,127 - INFO - Avg. fwd time: 10.0751 / Avg. bwd time: 13.6017 / Avg. batch time: 396.1076 (ms) / GPU bubble ratio: 52.18%
[rank2]:2025-10-29 01:20:02,110 - INFO - Avg. fwd time: 7.6875 / Avg. bwd time: 11.7835 / Avg. batch time: 368.3114 (ms) / GPU bubble ratio: 57.71%
[rank0]:2025-10-29 01:20:02,135 - INFO - Avg. fwd time: 8.5571 / Avg. bwd time: 5.0007 / Avg. batch time: 413.3071 (ms) / GPU bubble ratio: 73.76%
[rank1]:2025-10-29 01:20:14,560 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:20:14,560 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:14,560 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:17,123 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:29,826 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:29,826 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:20:29,826 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:32,349 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:45,181 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:20:45,181 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:45,181 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:47,596 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:21:00,238 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:00,237 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:00,238 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:02,748 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:14,165 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:21:15,386 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:15,387 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,710  tflops: 83.73  mfu: 26.84%
[rank1]:2025-10-29 01:21:15,386 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:21:15,386 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,710  tflops: 83.73  mfu: 26.84%
[rank2]:2025-10-29 01:21:15,386 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:15,387 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0396  memory: 12.98GiB(27.32%)  tps: 10,710  tflops: 83.73  mfu: 26.84%
[rank3]:2025-10-29 01:21:17,886 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:17,888 - INFO -  step: 950  loss:  0.4561  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,733  tflops: 83.91  mfu: 26.89%
[rank3]:2025-10-29 01:21:18,084 - INFO - Avg. fwd time: 12.8176 / Avg. bwd time: 21.5385 / Avg. batch time: 292.5536 (ms) / GPU bubble ratio: 6.05%
[rank2]:2025-10-29 01:21:18,176 - INFO - Avg. fwd time: 7.6871 / Avg. bwd time: 11.6682 / Avg. batch time: 366.6023 (ms) / GPU bubble ratio: 57.76%
[rank1]:2025-10-29 01:21:18,207 - INFO - Avg. fwd time: 10.0710 / Avg. bwd time: 13.4249 / Avg. batch time: 394.1815 (ms) / GPU bubble ratio: 52.31%
[rank0]:2025-10-29 01:21:18,220 - INFO - Avg. fwd time: 8.5495 / Avg. bwd time: 4.7627 / Avg. batch time: 411.1028 (ms) / GPU bubble ratio: 74.09%
[rank1]:2025-10-29 01:21:39,633 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:39,633 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:39,651 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:42,033 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:21:54,673 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:54,673 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:54,673 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:57,057 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:09,850 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:09,850 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:09,850 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:12,232 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:24,861 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:24,861 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:24,861 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:27,301 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:38,701 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:22:39,970 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:39,971 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,685  tflops: 75.71  mfu: 24.27%
[rank1]:2025-10-29 01:22:39,971 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 01:22:39,970 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:39,971 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0030  memory: 12.98GiB(27.32%)  tps: 9,685  tflops: 75.71  mfu: 24.27%
[rank2]:2025-10-29 01:22:39,971 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 01:22:39,970 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:39,971 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 9,685  tflops: 75.71  mfu: 24.27%
[rank0]:2025-10-29 01:22:39,971 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 01:22:42,531 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:42,533 - INFO -  step: 1000  loss:  0.3180  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 9,678  tflops: 75.66  mfu: 24.25%
[rank3]:2025-10-29 01:22:42,533 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 01:22:57,989 - INFO - validate step: 1000  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 22,734
[rank3]:2025-10-29 01:22:58,023 - INFO - validate step: 1000  loss:  0.3340  memory: 23.62GiB(49.72%)  tps: 26,444
[rank1]:2025-10-29 01:22:58,004 - INFO - validate step: 1000  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 22,714
[rank1]:2025-10-29 01:22:58,101 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0122_stage1_step1000.svg
[rank2]:2025-10-29 01:22:58,022 - INFO - validate step: 1000  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 22,692
[rank2]:2025-10-29 01:22:58,109 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0122_stage2_step1000.svg
[rank0]:2025-10-29 01:22:58,101 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0122_stage0_step1000.svg
[rank0]:2025-10-29 01:22:58,150 - INFO - Avg. fwd time: 8.5429 / Avg. bwd time: 4.7544 / Avg. batch time: 410.9228 (ms) / GPU bubble ratio: 74.11%
[rank3]:2025-10-29 01:22:58,224 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0122_real_step1000_rank3.svg
[rank3]:> Batch Time: 286.25 ms, GPU Bubble Ratio: 76.39%, 45.67%, 52.34%, 15.60%
[rank3]:2025-10-29 01:22:58,293 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0122_stage3_step1000.svg
[rank1]:2025-10-29 01:22:58,400 - INFO - Avg. fwd time: 10.0644 / Avg. bwd time: 13.3312 / Avg. batch time: 394.0455 (ms) / GPU bubble ratio: 52.50%
[rank2]:2025-10-29 01:22:58,407 - INFO - Avg. fwd time: 7.6861 / Avg. bwd time: 11.6418 / Avg. batch time: 366.6038 (ms) / GPU bubble ratio: 57.82%
[rank3]:2025-10-29 01:22:58,396 - INFO - Avg. fwd time: 12.8147 / Avg. bwd time: 21.5113 / Avg. batch time: 292.2847 (ms) / GPU bubble ratio: 6.05%
[rank1]:2025-10-29 01:23:11,181 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:11,181 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:11,182 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:13,722 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:26,333 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:26,333 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:26,333 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:28,713 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:41,489 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:41,488 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:41,489 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:43,922 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:56,696 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:56,696 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:56,695 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:59,095 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:10,460 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:24:11,731 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:11,732 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 11,109  tflops: 86.84  mfu: 27.83%
[rank1]:2025-10-29 01:24:11,731 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:11,732 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 11,111  tflops: 86.86  mfu: 27.84%
[rank2]:2025-10-29 01:24:11,731 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:11,731 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0024  memory: 12.98GiB(27.32%)  tps: 11,114  tflops: 86.88  mfu: 27.85%
[rank3]:2025-10-29 01:24:14,132 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:14,134 - INFO -  step: 1050  loss:  0.2899  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,763  tflops: 84.14  mfu: 26.97%
[rank3]:2025-10-29 01:24:14,413 - INFO - Avg. fwd time: 12.8272 / Avg. bwd time: 21.2817 / Avg. batch time: 290.5263 (ms) / GPU bubble ratio: 6.08%
[rank2]:2025-10-29 01:24:14,432 - INFO - Avg. fwd time: 7.6852 / Avg. bwd time: 11.5283 / Avg. batch time: 365.0515 (ms) / GPU bubble ratio: 57.89%
[rank1]:2025-10-29 01:24:14,450 - INFO - Avg. fwd time: 10.0587 / Avg. bwd time: 13.1345 / Avg. batch time: 392.2550 (ms) / GPU bubble ratio: 52.70%
[rank0]:2025-10-29 01:24:14,461 - INFO - Avg. fwd time: 8.5350 / Avg. bwd time: 4.5172 / Avg. batch time: 408.8588 (ms) / GPU bubble ratio: 74.46%
[rank0]:2025-10-29 01:24:27,046 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:27,046 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:27,046 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:29,545 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:42,258 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:42,258 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:42,258 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:44,768 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:57,475 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:57,475 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:57,475 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:59,850 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:25:12,750 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:25:12,750 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:12,750 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:25:15,124 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:34,460 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:25:36,678 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:25:36,678 - INFO -  step: 1100  loss: -4.0000  grad_norm:  3.9353  memory: 16.11GiB(33.90%)  tps: 9,644  tflops: 75.39  mfu: 24.16%
[rank2]:2025-10-29 01:25:36,678 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:25:36,678 - INFO -  step: 1100  loss: -4.0000  grad_norm:  3.9353  memory: 12.98GiB(27.32%)  tps: 9,644  tflops: 75.39  mfu: 24.16%
[rank0]:2025-10-29 01:25:36,695 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:36,695 - INFO -  step: 1100  loss: -4.0000  grad_norm:  3.9353  memory: 17.74GiB(37.35%)  tps: 9,642  tflops: 75.38  mfu: 24.16%
[rank3]:2025-10-29 01:25:39,221 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:25:39,223 - INFO -  step: 1100  loss:  0.2674  grad_norm:  3.9353  memory: 23.62GiB(49.72%)  tps: 9,628  tflops: 75.27  mfu: 24.12%
[rank1]:2025-10-29 01:25:39,300 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0125_stage1_step1100.svg
[rank2]:2025-10-29 01:25:39,301 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0125_stage2_step1100.svg
[rank0]:2025-10-29 01:25:39,300 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0125_stage0_step1100.svg
[rank0]:2025-10-29 01:25:39,348 - INFO - Avg. fwd time: 8.5306 / Avg. bwd time: 4.4580 / Avg. batch time: 408.0995 (ms) / GPU bubble ratio: 74.54%
[rank3]:2025-10-29 01:25:39,409 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0125_real_step1100_rank3.svg
[rank3]:> Batch Time: 286.18 ms, GPU Bubble Ratio: 76.40%, 45.69%, 52.32%, 15.60%
[rank3]:2025-10-29 01:25:39,476 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0125_stage3_step1100.svg
[rank1]:2025-10-29 01:25:39,584 - INFO - Avg. fwd time: 10.0549 / Avg. bwd time: 13.0380 / Avg. batch time: 391.5812 (ms) / GPU bubble ratio: 52.82%
[rank2]:2025-10-29 01:25:39,592 - INFO - Avg. fwd time: 7.6849 / Avg. bwd time: 11.4851 / Avg. batch time: 364.5051 (ms) / GPU bubble ratio: 57.93%
[rank3]:2025-10-29 01:25:39,577 - INFO - Avg. fwd time: 12.8297 / Avg. bwd time: 21.2101 / Avg. batch time: 289.9549 (ms) / GPU bubble ratio: 6.08%
[rank1]:2025-10-29 01:25:52,217 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:25:52,217 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:52,218 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:25:54,710 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:07,545 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:07,545 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:07,545 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:09,923 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:22,611 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:22,611 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:22,610 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:24,989 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:37,739 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:37,739 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:37,739 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:40,245 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:51,659 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:26:52,945 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:52,945 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,744  tflops: 83.99  mfu: 26.92%
[rank1]:2025-10-29 01:26:52,945 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:52,945 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,741  tflops: 83.97  mfu: 26.91%
[rank2]:2025-10-29 01:26:52,944 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:52,945 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0012  memory: 12.98GiB(27.32%)  tps: 10,741  tflops: 83.97  mfu: 26.91%
[rank0]:2025-10-29 01:26:52,992 - INFO - Avg. fwd time: 8.5256 / Avg. bwd time: 4.3541 / Avg. batch time: 406.7293 (ms) / GPU bubble ratio: 74.67%
[rank3]:2025-10-29 01:26:55,511 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:55,513 - INFO -  step: 1150  loss:  0.2115  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,738  tflops: 83.95  mfu: 26.91%
[rank3]:2025-10-29 01:26:55,623 - INFO - Avg. fwd time: 12.8370 / Avg. bwd time: 21.1071 / Avg. batch time: 289.1700 (ms) / GPU bubble ratio: 6.09%
[rank2]:2025-10-29 01:26:55,633 - INFO - Avg. fwd time: 7.6845 / Avg. bwd time: 11.4286 / Avg. batch time: 363.4191 (ms) / GPU bubble ratio: 57.93%
[rank1]:2025-10-29 01:26:55,625 - INFO - Avg. fwd time: 10.0506 / Avg. bwd time: 12.9211 / Avg. batch time: 390.3442 (ms) / GPU bubble ratio: 52.92%
[rank1]:2025-10-29 01:27:08,123 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:08,123 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:08,124 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:10,521 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:23,461 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:27:23,460 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:23,460 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:25,873 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:38,470 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:27:38,470 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:38,469 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:40,936 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:27:53,764 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:53,763 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:53,764 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:56,194 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:07,672 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:28:08,990 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:08,991 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0009  memory: 12.98GiB(27.32%)  tps: 10,772  tflops: 84.21  mfu: 26.99%
[rank2]:2025-10-29 01:28:08,991 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 01:28:08,991 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:08,992 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,772  tflops: 84.21  mfu: 26.99%
[rank0]:2025-10-29 01:28:08,992 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 01:28:08,991 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:28:08,992 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,772  tflops: 84.21  mfu: 26.99%
[rank1]:2025-10-29 01:28:08,992 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 01:28:11,537 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:11,539 - INFO -  step: 1200  loss:  0.2243  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,775  tflops: 84.24  mfu: 27.00%
[rank3]:2025-10-29 01:28:11,540 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 01:28:27,081 - INFO - validate step: 1200  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 22,643
[rank2]:2025-10-29 01:28:27,126 - INFO - validate step: 1200  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 22,587
[rank3]:2025-10-29 01:28:27,115 - INFO - validate step: 1200  loss:  0.3216  memory: 23.62GiB(49.72%)  tps: 26,300
[rank1]:2025-10-29 01:28:27,098 - INFO - validate step: 1200  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 22,623
[rank2]:2025-10-29 01:28:27,217 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0128_stage2_step1200.svg
[rank0]:2025-10-29 01:28:27,215 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0128_stage0_step1200.svg
[rank1]:2025-10-29 01:28:27,215 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0128_stage1_step1200.svg
[rank3]:2025-10-29 01:28:27,328 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0128_real_step1200_rank3.svg
[rank3]:> Batch Time: 286.06 ms, GPU Bubble Ratio: 76.39%, 45.67%, 52.28%, 15.61%
[rank3]:2025-10-29 01:28:27,399 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0128_stage3_step1200.svg
[rank2]:2025-10-29 01:28:27,691 - INFO - Avg. fwd time: 7.6846 / Avg. bwd time: 11.3404 / Avg. batch time: 362.2259 (ms) / GPU bubble ratio: 57.98%
[rank3]:2025-10-29 01:28:27,672 - INFO - Avg. fwd time: 12.8505 / Avg. bwd time: 20.9199 / Avg. batch time: 287.7654 (ms) / GPU bubble ratio: 6.12%
[rank0]:2025-10-29 01:28:27,720 - INFO - Avg. fwd time: 8.5209 / Avg. bwd time: 4.1749 / Avg. batch time: 405.1509 (ms) / GPU bubble ratio: 74.93%
[rank1]:2025-10-29 01:28:27,710 - INFO - Avg. fwd time: 10.0477 / Avg. bwd time: 12.7688 / Avg. batch time: 388.9686 (ms) / GPU bubble ratio: 53.07%
[rank2]:2025-10-29 01:28:40,110 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:40,110 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:28:40,110 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:42,637 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:28:55,383 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:55,383 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:55,383 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:57,748 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:10,422 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:10,422 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:10,421 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:12,786 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:25,460 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:25,461 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:25,460 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:27,943 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:47,593 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:29:49,773 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:49,773 - INFO -  step: 1250  loss: -4.0000  grad_norm:  2.9720  memory: 16.11GiB(33.90%)  tps: 9,909  tflops: 77.46  mfu: 24.83%
[rank2]:2025-10-29 01:29:49,772 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:49,773 - INFO -  step: 1250  loss: -4.0000  grad_norm:  2.9720  memory: 12.98GiB(27.32%)  tps: 9,912  tflops: 77.49  mfu: 24.84%
[rank0]:2025-10-29 01:29:49,787 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:49,787 - INFO -  step: 1250  loss: -4.0000  grad_norm:  2.9720  memory: 17.74GiB(37.35%)  tps: 9,905  tflops: 77.43  mfu: 24.82%
[rank0]:2025-10-29 01:29:49,837 - INFO - Avg. fwd time: 8.5179 / Avg. bwd time: 4.1251 / Avg. batch time: 404.5650 (ms) / GPU bubble ratio: 75.00%
[rank3]:2025-10-29 01:29:52,326 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:52,329 - INFO -  step: 1250  loss:  0.2596  grad_norm:  2.9720  memory: 23.62GiB(49.72%)  tps: 9,614  tflops: 75.15  mfu: 24.09%
[rank3]:2025-10-29 01:29:52,437 - INFO - Avg. fwd time: 12.8515 / Avg. bwd time: 20.8646 / Avg. batch time: 287.3164 (ms) / GPU bubble ratio: 6.12%
[rank1]:2025-10-29 01:29:52,439 - INFO - Avg. fwd time: 10.0444 / Avg. bwd time: 12.6980 / Avg. batch time: 388.4479 (ms) / GPU bubble ratio: 53.16%
[rank2]:2025-10-29 01:29:52,447 - INFO - Avg. fwd time: 7.6840 / Avg. bwd time: 11.3098 / Avg. batch time: 361.8000 (ms) / GPU bubble ratio: 58.00%
[rank1]:2025-10-29 01:30:04,967 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:04,967 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:04,966 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:07,543 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:20,307 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:20,307 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:20,306 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:22,829 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:35,587 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:35,587 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:35,587 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:38,229 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:50,912 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:50,913 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:50,913 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:53,524 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:05,066 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:31:06,307 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:06,308 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0117  memory: 12.98GiB(27.32%)  tps: 10,704  tflops: 83.68  mfu: 26.82%
[rank1]:2025-10-29 01:31:06,307 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:31:06,308 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,704  tflops: 83.68  mfu: 26.82%
[rank0]:2025-10-29 01:31:06,307 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:06,308 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,706  tflops: 83.69  mfu: 26.82%
[rank3]:2025-10-29 01:31:08,957 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:08,960 - INFO -  step: 1300  loss:  0.2754  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,690  tflops: 83.57  mfu: 26.79%
[rank1]:2025-10-29 01:31:09,044 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0131_stage1_step1300.svg
[rank0]:2025-10-29 01:31:09,045 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0131_stage0_step1300.svg
[rank2]:2025-10-29 01:31:09,055 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0131_stage2_step1300.svg
[rank0]:2025-10-29 01:31:09,093 - INFO - Avg. fwd time: 8.5148 / Avg. bwd time: 4.0571 / Avg. batch time: 404.0435 (ms) / GPU bubble ratio: 75.11%
[rank3]:2025-10-29 01:31:09,162 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0131_real_step1300_rank3.svg
[rank3]:> Batch Time: 285.92 ms, GPU Bubble Ratio: 76.38%, 45.65%, 52.26%, 15.62%
[rank3]:2025-10-29 01:31:09,232 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0131_stage3_step1300.svg
[rank3]:2025-10-29 01:31:09,337 - INFO - Avg. fwd time: 12.8533 / Avg. bwd time: 20.7861 / Avg. batch time: 286.6875 (ms) / GPU bubble ratio: 6.13%
[rank1]:2025-10-29 01:31:09,341 - INFO - Avg. fwd time: 10.0412 / Avg. bwd time: 12.6088 / Avg. batch time: 388.0130 (ms) / GPU bubble ratio: 53.30%
[rank2]:2025-10-29 01:31:09,348 - INFO - Avg. fwd time: 7.6836 / Avg. bwd time: 11.2666 / Avg. batch time: 361.4808 (ms) / GPU bubble ratio: 58.06%
[rank1]:2025-10-29 01:31:21,890 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:21,891 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:21,890 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:24,482 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:31:37,175 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:37,175 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:37,174 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:39,658 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:52,508 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:31:52,508 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:52,507 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:55,361 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:07,958 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:07,958 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:07,958 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:10,731 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:22,284 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:32:23,555 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:23,563 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,604  tflops: 82.90  mfu: 26.57%
[rank1]:2025-10-29 01:32:23,554 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:23,563 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,604  tflops: 82.90  mfu: 26.57%
[rank2]:2025-10-29 01:32:23,554 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:23,555 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0098  memory: 12.98GiB(27.32%)  tps: 10,605  tflops: 82.90  mfu: 26.57%
[rank3]:2025-10-29 01:32:26,735 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:26,738 - INFO -  step: 1350  loss:  0.3014  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,533  tflops: 82.34  mfu: 26.39%
[rank3]:2025-10-29 01:32:27,012 - INFO - Avg. fwd time: 12.8598 / Avg. bwd time: 20.6332 / Avg. batch time: 285.5033 (ms) / GPU bubble ratio: 6.15%
[rank0]:2025-10-29 01:32:27,064 - INFO - Avg. fwd time: 8.5098 / Avg. bwd time: 3.8995 / Avg. batch time: 403.0010 (ms) / GPU bubble ratio: 75.37%
[rank1]:2025-10-29 01:32:27,053 - INFO - Avg. fwd time: 10.0375 / Avg. bwd time: 12.4848 / Avg. batch time: 387.1478 (ms) / GPU bubble ratio: 53.46%
[rank2]:2025-10-29 01:32:27,033 - INFO - Avg. fwd time: 7.6828 / Avg. bwd time: 11.1932 / Avg. batch time: 360.7632 (ms) / GPU bubble ratio: 58.14%
[rank0]:2025-10-29 01:32:39,540 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:39,540 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:39,540 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:42,087 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:54,686 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:54,686 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:54,686 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:57,286 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:33:10,113 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:10,113 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:33:10,113 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:33:12,614 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:33:25,361 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:33:25,361 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:25,361 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:33:27,987 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:39,334 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:33:40,596 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:33:40,596 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0080  memory: 12.98GiB(27.32%)  tps: 10,634  tflops: 83.13  mfu: 26.65%
[rank2]:2025-10-29 01:33:40,596 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:40,596 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:40,597 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,634  tflops: 83.13  mfu: 26.65%
[rank0]:2025-10-29 01:33:40,597 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 01:33:40,596 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:33:40,597 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,634  tflops: 83.13  mfu: 26.65%
[rank1]:2025-10-29 01:33:40,597 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 01:33:43,052 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:33:43,055 - INFO -  step: 1400  loss:  0.2272  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,734  tflops: 83.92  mfu: 26.90%
[rank3]:2025-10-29 01:33:43,055 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:57,767 - INFO - validate step: 1400  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 23,856
[rank1]:2025-10-29 01:33:57,782 - INFO - validate step: 1400  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 23,835
[rank2]:2025-10-29 01:33:57,797 - INFO - validate step: 1400  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 23,813
[rank3]:2025-10-29 01:33:57,800 - INFO - validate step: 1400  loss:  0.3191  memory: 23.62GiB(49.72%)  tps: 27,782
[rank0]:2025-10-29 01:33:57,882 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0133_stage0_step1400.svg
[rank1]:2025-10-29 01:33:57,881 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0133_stage1_step1400.svg
[rank2]:2025-10-29 01:33:57,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0133_stage2_step1400.svg
[rank3]:2025-10-29 01:33:57,991 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0133_real_step1400_rank3.svg
[rank3]:> Batch Time: 285.75 ms, GPU Bubble Ratio: 76.38%, 45.63%, 52.23%, 15.63%
[rank3]:2025-10-29 01:33:58,063 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0133_stage3_step1400.svg
[rank3]:2025-10-29 01:33:58,257 - INFO - Avg. fwd time: 12.8674 / Avg. bwd time: 20.5117 / Avg. batch time: 284.5830 (ms) / GPU bubble ratio: 6.17%
[rank0]:2025-10-29 01:33:58,394 - INFO - Avg. fwd time: 8.5059 / Avg. bwd time: 3.7738 / Avg. batch time: 401.8702 (ms) / GPU bubble ratio: 75.55%
[rank1]:2025-10-29 01:33:58,380 - INFO - Avg. fwd time: 10.0354 / Avg. bwd time: 12.3864 / Avg. batch time: 386.1614 (ms) / GPU bubble ratio: 53.55%
[rank2]:2025-10-29 01:33:58,348 - INFO - Avg. fwd time: 7.6825 / Avg. bwd time: 11.1355 / Avg. batch time: 359.8946 (ms) / GPU bubble ratio: 58.17%
[rank0]:2025-10-29 01:34:19,886 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:19,872 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:19,872 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:22,504 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:35,221 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:35,220 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:35,221 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:37,788 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:50,589 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:50,589 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:50,589 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:53,185 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:05,973 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:05,972 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:35:05,972 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:08,427 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:19,794 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:35:21,083 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:21,083 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 9,832  tflops: 76.87  mfu: 24.64%
[rank1]:2025-10-29 01:35:21,083 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:21,083 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,834  tflops: 76.88  mfu: 24.64%
[rank2]:2025-10-29 01:35:21,082 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:35:21,083 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0154  memory: 12.98GiB(27.32%)  tps: 9,836  tflops: 76.89  mfu: 24.65%
[rank0]:2025-10-29 01:35:21,130 - INFO - Avg. fwd time: 8.5043 / Avg. bwd time: 3.8132 / Avg. batch time: 401.8461 (ms) / GPU bubble ratio: 75.48%
[rank3]:2025-10-29 01:35:23,613 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:23,615 - INFO -  step: 1450  loss:  0.2133  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 9,546  tflops: 74.63  mfu: 23.92%
[rank2]:2025-10-29 01:35:23,733 - INFO - Avg. fwd time: 7.6823 / Avg. bwd time: 11.1378 / Avg. batch time: 359.8917 (ms) / GPU bubble ratio: 58.17%
[rank3]:2025-10-29 01:35:23,729 - INFO - Avg. fwd time: 12.8639 / Avg. bwd time: 20.5351 / Avg. batch time: 284.7278 (ms) / GPU bubble ratio: 6.16%
[rank1]:2025-10-29 01:35:23,726 - INFO - Avg. fwd time: 10.0329 / Avg. bwd time: 12.3611 / Avg. batch time: 386.1120 (ms) / GPU bubble ratio: 53.60%
[rank2]:2025-10-29 01:35:36,441 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:36,442 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:36,442 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:38,905 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:51,612 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:51,612 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:35:51,612 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:54,103 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:06,787 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:06,788 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:06,788 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:09,251 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:22,141 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:22,141 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:22,141 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:24,632 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:35,913 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:36:37,224 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:37,224 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0101  memory: 12.98GiB(27.32%)  tps: 10,759  tflops: 84.11  mfu: 26.96%
[rank0]:2025-10-29 01:36:37,224 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:37,225 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,759  tflops: 84.11  mfu: 26.96%
[rank1]:2025-10-29 01:36:37,224 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:37,225 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,759  tflops: 84.11  mfu: 26.96%
[rank3]:2025-10-29 01:36:39,785 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:39,787 - INFO -  step: 1500  loss:  0.2426  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,755  tflops: 84.08  mfu: 26.95%
[rank0]:2025-10-29 01:36:39,882 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0136_stage0_step1500.svg
[rank1]:2025-10-29 01:36:39,881 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0136_stage1_step1500.svg
[rank2]:2025-10-29 01:36:39,882 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0136_stage2_step1500.svg
[rank3]:2025-10-29 01:36:39,991 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0136_real_step1500_rank3.svg
[rank3]:> Batch Time: 285.71 ms, GPU Bubble Ratio: 76.38%, 45.61%, 52.22%, 15.64%
[rank3]:2025-10-29 01:36:40,064 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0136_stage3_step1500.svg
[rank3]:2025-10-29 01:36:40,344 - INFO - Avg. fwd time: 12.8720 / Avg. bwd time: 20.4086 / Avg. batch time: 283.7703 (ms) / GPU bubble ratio: 6.18%
[rank0]:2025-10-29 01:36:40,393 - INFO - Avg. fwd time: 8.5005 / Avg. bwd time: 3.6798 / Avg. batch time: 400.7797 (ms) / GPU bubble ratio: 75.69%
[rank1]:2025-10-29 01:36:40,383 - INFO - Avg. fwd time: 10.0311 / Avg. bwd time: 12.2594 / Avg. batch time: 385.1979 (ms) / GPU bubble ratio: 53.71%
[rank2]:2025-10-29 01:36:40,364 - INFO - Avg. fwd time: 7.6822 / Avg. bwd time: 11.0771 / Avg. batch time: 359.0982 (ms) / GPU bubble ratio: 58.21%
[rank2]:2025-10-29 01:36:52,758 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:52,759 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:52,759 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:55,389 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:08,109 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:08,109 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:37:08,109 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:10,563 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:37:23,188 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:23,189 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:23,189 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:25,632 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:38,469 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:38,469 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:37:38,468 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:40,989 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:52,375 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:37:53,646 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:53,647 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:53,647 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 10,719  tflops: 83.80  mfu: 26.86%
[rank0]:2025-10-29 01:37:53,647 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:53,647 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 10,719  tflops: 83.80  mfu: 26.86%
[rank0]:2025-10-29 01:37:53,710 - INFO - Avg. fwd time: 8.4970 / Avg. bwd time: 3.5727 / Avg. batch time: 399.7661 (ms) / GPU bubble ratio: 75.85%
[rank2]:2025-10-29 01:37:53,647 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0050  memory: 12.98GiB(27.32%)  tps: 10,719  tflops: 83.80  mfu: 26.86%
[rank3]:2025-10-29 01:37:56,172 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:56,174 - INFO -  step: 1550  loss:  0.2058  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 10,725  tflops: 83.84  mfu: 26.87%
[rank3]:2025-10-29 01:37:56,281 - INFO - Avg. fwd time: 12.8793 / Avg. bwd time: 20.3018 / Avg. batch time: 282.9668 (ms) / GPU bubble ratio: 6.19%
[rank1]:2025-10-29 01:37:56,289 - INFO - Avg. fwd time: 10.0293 / Avg. bwd time: 12.1775 / Avg. batch time: 384.3080 (ms) / GPU bubble ratio: 53.77%
[rank2]:2025-10-29 01:37:56,296 - INFO - Avg. fwd time: 7.6821 / Avg. bwd time: 11.0286 / Avg. batch time: 358.3066 (ms) / GPU bubble ratio: 58.22%
[rank2]:2025-10-29 01:38:08,941 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:08,941 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:08,942 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:38:11,367 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:24,183 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:24,183 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:24,184 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:38:26,619 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:48,127 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:48,141 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:48,126 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:38:50,784 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:39:03,507 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:39:03,508 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:39:03,508 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:06,081 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:39:17,600 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:39:18,916 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:39:18,917 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 9,607  tflops: 75.10  mfu: 24.07%
[rank0]:2025-10-29 01:39:18,917 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.0000  tps: 10,146  tflops: 79.32  mfu: 24.40%
[rank0]:2025-10-29 01:39:18,917 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 01:39:18,916 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:39:18,917 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 9,607  tflops: 75.10  mfu: 24.07%
[rank1]:2025-10-29 01:39:18,917 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.0000  tps: 10,147  tflops: 79.32  mfu: 24.41%
[rank1]:2025-10-29 01:39:18,917 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 01:39:18,916 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:39:18,916 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0008  memory: 12.98GiB(27.32%)  tps: 9,607  tflops: 75.10  mfu: 24.07%
[rank2]:2025-10-29 01:39:18,917 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.0008  tps: 10,148  tflops: 79.33  mfu: 24.41%
[rank2]:2025-10-29 01:39:18,917 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 01:39:21,354 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:21,356 - INFO -  step: 1600  loss:  0.2056  grad_norm:  0.0000  memory: 23.62GiB(49.72%)  tps: 9,617  tflops: 75.18  mfu: 24.10%
[rank3]:2025-10-29 01:39:21,357 - INFO -  final step: 1600  loss:  0.2056  grad_norm:  0.0000  tps: 10,080  tflops: 78.80  mfu: 24.23%
[rank3]:2025-10-29 01:39:21,357 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 01:39:36,722 - INFO - validate step: 1600  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 23,006
[rank0]:2025-10-29 01:39:36,722 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:39:36,725 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-29 01:39:36,738 - INFO - validate step: 1600  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 22,984
[rank1]:2025-10-29 01:39:36,739 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 01:39:36,741 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-29 01:39:36,754 - INFO - validate step: 1600  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 22,963
[rank2]:2025-10-29 01:39:36,755 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 01:39:36,757 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-29 01:39:36,756 - INFO - validate step: 1600  loss:  0.3198  memory: 23.62GiB(49.72%)  tps: 26,601
[rank3]:2025-10-29 01:39:36,757 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 01:39:36,759 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-29 01:39:38,982 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 01:39:39,071 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0139_stage2_final1600.svg
[rank0]:2025-10-29 01:39:39,069 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0139_stage0_final1600.svg
[rank1]:2025-10-29 01:39:39,070 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0139_stage1_final1600.svg
[rank3]:2025-10-29 01:39:39,172 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0139_real_final1600_rank3.svg
[rank3]:> Batch Time: 285.64 ms, GPU Bubble Ratio: 76.38%, 45.60%, 52.20%, 15.63%
[rank2]:2025-10-29 01:39:39,287 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0139_rank2_stage2.svg
[rank2]:	> Counts Sum: 4866, Total Sum: 5580 (87.20%), Ratio(%) per element: [89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 0.64]
[rank2]:2025-10-29 01:39:39,288 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 01:39:39,283 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0139_rank0_stage0.svg
[rank0]:	> Counts Sum: 5109, Total Sum: 5735 (89.08%), Ratio(%) per element: [89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 67.74]
[rank0]:2025-10-29 01:39:39,283 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 01:39:39,270 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0139_rank1_stage1.svg
[rank1]:	> Counts Sum: 6235, Total Sum: 6975 (89.39%), Ratio(%) per element: [89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 76.77]
[rank1]:2025-10-29 01:39:39,270 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 01:39:39,335 - INFO - Process group destroyed
[rank3]:2025-10-29 01:39:39,365 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0139_thry_final1600_rank3.svg
[rank3]:> Batch Time: 322.08 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 01:39:39,445 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0139_stage3_final1600.svg
[rank1]:2025-10-29 01:39:39,377 - INFO - Process group destroyed
[rank3]:2025-10-29 01:39:39,647 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0139_rank3_stage3.svg
[rank3]:	> Counts Sum: 4031, Total Sum: 4495 (89.68%), Ratio(%) per element: [89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67, 89.67]
[rank3]:2025-10-29 01:39:39,648 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 32-32, summary, console lines 478-488
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–ˆâ–…â–â–â–â–â–â–†â–â–„â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–ˆâ–†â–…â–„â–ƒâ–‚â–‚â–ƒâ–ƒâ–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ˆâ–†â–…â–„â–ƒâ–‚â–‚â–ƒâ–ƒâ–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.62534
[rank3]:wandb:               final/avg_loss 0.20557
[rank3]:wandb:             final/avg_mfu(%) 24.23454
[rank3]:wandb:             final/avg_tflops 78.80347
[rank3]:wandb:    final/avg_throughput(tps) 10080.3421
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.20557
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.20557
[rank3]:wandb: loss_metrics/global_max_loss 0.20557
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_apf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/wqc0c8u8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1028_GPipe_apf_dm1/20251029-0052/wandb/run-20251029_005248-wqc0c8u8/logs
[rank0]:2025-10-29 01:39:41,283 - INFO - Training completed
[rank0]:2025-10-29 01:39:41,283 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 01:39:41,439 - INFO - Process group destroyed
[rank0]:2025-10-29 01:39:41,500 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.5', 'layers.8', 'layers.6', 'layers.7'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.14', 'layers.15', 'layers.13', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_apf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1028_GPipe_apf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1028_GPipe_apf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1028_GPipe_apf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1028_GPipe_apf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_apf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: True
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1028_GPipe_apf_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1028_GPipe_apf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
