
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 29. (ìˆ˜) 13:53:09 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/1028_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-29 13:53:15,568 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 13:53:15,571 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 13:53:15,696 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-29 13:53:15,608 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 13:53:15,780 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 13:53:15,783 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 13:53:15,865 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 13:53:15,867 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 13:53:15,883 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 13:53:15,885 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 13:53:15,964 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 13:53:15,966 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 13:53:15,970 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 13:53:17,282 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 13:53:17,691 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 13:53:20,503 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 13:53:20,553 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 13:53:20,580 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-29 13:53:20,588 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 13:53:20,543 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 13:53:20,709 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 13:53:20,764 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 13:53:20,764 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 13:53:20,764 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-29 13:53:20,753 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 13:53:20,755 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 13:53:20,780 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 13:53:20,781 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 13:53:20,962 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 13:53:20,962 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 13:53:20,963 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 13:53:22,040 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 13:53:22,079 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 13:53:22,103 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 13:53:22,104 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-10-29 13:53:22,519 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 13:53:22,519 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 13:53:22,519 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: setting up run 8euq9798
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1028_GPipe_timelyapf_dm1/20251029-1353/wandb/run-20251029_135322-8euq9798
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/8euq9798
[rank3]:2025-10-29 13:53:23,111 - INFO - WandB logging enabled
[rank3]:2025-10-29 13:53:23,112 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 13:53:23,152 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 13:53:23,181 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 13:53:23,182 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 13:53:23,372 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 13:53:23,372 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 13:53:23,372 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1028_GPipe_timelyapf_dm1
[rank0]:2025-10-29 13:53:23,372 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 13:53:23,373 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-29 13:53:23,355 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 13:53:23,356 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 13:53:23,357 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 13:53:23,372 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 13:53:28,838 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1600 (warmup 100)
[rank0]:2025-10-29 13:53:28,838 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 13:53:31,640 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 13:53:31,640 - INFO - Finished loading the checkpoint in 2.80 seconds.
[rank0]:2025-10-29 13:53:31,641 - INFO - Training starts at step 1
[rank1]:2025-10-29 13:53:35,510 - INFO -  step:  1  loss: -4.0000  grad_norm: 54.0696  memory: 12.38GiB(26.05%)  tps: 1,220  tflops: 9.54  mfu: 3.06%
[rank1]:2025-10-29 13:53:35,511 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 13:53:35,518 - INFO -  step:  1  loss:  9.8313  grad_norm: 54.0696  memory: 24.19GiB(50.91%)  tps: 1,325  tflops: 10.36  mfu: 3.32%
[rank3]:2025-10-29 13:53:35,518 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 13:53:35,510 - INFO -  step:  1  loss: -4.0000  grad_norm: 54.0696  memory:  9.99GiB(21.03%)  tps: 1,095  tflops: 8.56  mfu: 2.74%
[rank2]:2025-10-29 13:53:35,510 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 13:53:35,546 - INFO -  step:  1  loss: -4.0000  grad_norm: 54.0696  memory: 12.80GiB(26.95%)  tps: 1,108  tflops: 8.66  mfu: 2.78%
[rank0]:2025-10-29 13:53:35,546 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 13:53:51,421 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,423 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,430 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,430 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,431 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,431 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,431 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,432 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,432 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,432 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,433 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,433 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,433 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,434 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,434 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 13:53:51,434 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 13:53:51,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,514 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,514 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:53:51,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,459 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,459 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 13:53:51,459 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 13:55:32,518 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 13:55:34,989 - INFO -  step: 50  loss: -4.0000  grad_norm: 20.9292  memory: 11.81GiB(24.85%)  tps: 6,719  tflops: 52.53  mfu: 16.84%
[rank0]:2025-10-29 13:55:35,004 - INFO -  step: 50  loss: -4.0000  grad_norm: 20.9292  memory: 16.57GiB(34.88%)  tps: 6,721  tflops: 52.54  mfu: 16.84%
[rank1]:2025-10-29 13:55:34,993 - INFO -  step: 50  loss: -4.0000  grad_norm: 20.9292  memory: 14.64GiB(30.82%)  tps: 6,719  tflops: 52.53  mfu: 16.84%
[rank3]:2025-10-29 13:55:35,001 - INFO -  step: 50  loss:  9.4575  grad_norm: 20.9292  memory: 26.98GiB(56.79%)  tps: 6,719  tflops: 52.53  mfu: 16.84%
[rank3]:2025-10-29 13:55:35,337 - INFO - Avg. fwd time: 10.4694 / Avg. bwd time: 42.2428 / Avg. batch time: 483.7291 (ms) / GPU bubble ratio: 12.82%
[rank1]:2025-10-29 13:55:35,446 - INFO - Avg. fwd time: 8.9457 / Avg. bwd time: 23.7029 / Avg. batch time: 552.6966 (ms) / GPU bubble ratio: 52.74%
[rank2]:2025-10-29 13:55:35,406 - INFO - Avg. fwd time: 6.8918 / Avg. bwd time: 18.3561 / Avg. batch time: 514.2678 (ms) / GPU bubble ratio: 60.72%
[rank0]:2025-10-29 13:55:35,452 - INFO - Avg. fwd time: 7.9642 / Avg. bwd time: 23.7748 / Avg. batch time: 589.5826 (ms) / GPU bubble ratio: 56.93%
[rank3]:2025-10-29 13:55:59,204 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 13:56:24,412 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 13:56:24,710 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-10-29 13:56:24,787 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:24,776 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:24,795 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:24,807 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:24,817 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:24,827 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:24,776 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:27,651 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,680 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,696 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,707 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,716 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 13:56:27,661 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 13:56:27,697 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 13:56:27,732 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:27,689 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:27,724 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:27,759 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,739 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,774 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,819 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:27,840 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:56:27,850 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 13:56:27,858 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 13:56:27,892 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 13:56:27,927 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:27,880 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:27,914 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 13:56:27,949 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:27,874 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 13:56:27,909 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 13:56:27,967 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 13:57:02,537 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 13:57:02,957 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1357_max_batch_time.svg
[rank3]:> Batch Time: 531.01 ms, GPU Bubble Ratio: 51.08%, 49.82%, 61.18%, 18.18%
[rank3]:2025-10-29 13:57:03,150 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1357_min_batch_time.svg
[rank3]:> Batch Time: 308.35 ms, GPU Bubble Ratio: 78.83%, 48.47%, 60.36%, 15.66%
[rank3]:2025-10-29 13:57:03,357 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1357_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 308.35 ms, GPU Bubble Ratio: 36.12%, 26.62%, 36.54%, 15.66%
[rank3]:2025-10-29 13:57:03,358 - INFO - 	> Batch Time: 308.35 ms (Average Freeze Ratio: 0.45, Time Reduction Rate: 0.42)
[rank0]:2025-10-29 13:57:20,782 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 13:57:22,367 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.07/0.20, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.28/0.85, [MB6] 0.31/0.92, [MB7] 0.33/1.00
[rank1]:2025-10-29 13:57:22,367 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 7,629  tflops: 59.64  mfu: 19.12%
[rank0]:2025-10-29 13:57:22,367 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.17/0.51, [MB5] 0.17/0.51, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-10-29 13:57:22,367 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 7,630  tflops: 59.65  mfu: 19.12%
[rank2]:2025-10-29 13:57:22,362 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-10-29 13:57:22,363 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 7,629  tflops: 59.64  mfu: 19.12%
[rank3]:2025-10-29 13:57:26,290 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 13:57:26,293 - INFO -  step: 100  loss: 10.1777  grad_norm:  0.0000  memory: 30.46GiB(64.11%)  tps: 7,361  tflops: 57.54  mfu: 18.44%
[rank1]:2025-10-29 13:57:26,420 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1357_stage1_step100.svg
[rank0]:2025-10-29 13:57:26,417 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1357_stage0_step100.svg
[rank2]:2025-10-29 13:57:26,412 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1357_stage2_step100.svg
[rank0]:2025-10-29 13:57:26,480 - INFO - Avg. fwd time: 8.3374 / Avg. bwd time: 17.1455 / Avg. batch time: 561.4644 (ms) / GPU bubble ratio: 63.69%
[rank3]:2025-10-29 13:57:26,569 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1357_real_step100_rank3.svg
[rank3]:> Batch Time: 517.88 ms, GPU Bubble Ratio: 50.28%, 49.23%, 60.69%, 18.41%
[rank3]:2025-10-29 13:57:26,651 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1357_stage3_step100.svg
[rank3]:2025-10-29 13:57:26,847 - INFO - Avg. fwd time: 11.3200 / Avg. bwd time: 36.6180 / Avg. batch time: 444.2209 (ms) / GPU bubble ratio: 13.67%
[rank2]:2025-10-29 13:57:26,889 - INFO - Avg. fwd time: 7.3702 / Avg. bwd time: 15.5545 / Avg. batch time: 496.7210 (ms) / GPU bubble ratio: 63.08%
[rank1]:2025-10-29 13:57:26,928 - INFO - Avg. fwd time: 9.5506 / Avg. bwd time: 20.1129 / Avg. batch time: 531.4310 (ms) / GPU bubble ratio: 55.35%
[rank0]:2025-10-29 13:59:10,309 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 13:59:12,125 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.34/0.51, [MB5] 0.34/0.51, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-10-29 13:59:12,126 - INFO -  step: 150  loss: -4.0000  grad_norm:  2.7515  memory: 16.77GiB(35.29%)  tps: 7,464  tflops: 58.35  mfu: 18.70%
[rank1]:2025-10-29 13:59:12,115 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.14/0.20, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.56/0.85, [MB6] 0.61/0.92, [MB7] 0.67/1.00
[rank1]:2025-10-29 13:59:12,116 - INFO -  step: 150  loss: -4.0000  grad_norm:  2.7515  memory: 15.05GiB(31.68%)  tps: 7,464  tflops: 58.35  mfu: 18.70%
[rank2]:2025-10-29 13:59:12,111 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-10-29 13:59:12,112 - INFO -  step: 150  loss: -4.0000  grad_norm:  2.7515  memory: 12.51GiB(26.33%)  tps: 7,464  tflops: 58.35  mfu: 18.70%
[rank3]:2025-10-29 13:59:14,765 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 13:59:14,769 - INFO -  step: 150  loss:  6.2222  grad_norm:  2.7515  memory: 31.41GiB(66.13%)  tps: 7,553  tflops: 59.04  mfu: 18.92%
[rank3]:2025-10-29 13:59:15,128 - INFO - Avg. fwd time: 11.8188 / Avg. bwd time: 32.6381 / Avg. batch time: 416.9734 (ms) / GPU bubble ratio: 14.71%
[rank1]:2025-10-29 13:59:15,167 - INFO - Avg. fwd time: 9.8210 / Avg. bwd time: 19.2036 / Avg. batch time: 517.8475 (ms) / GPU bubble ratio: 55.16%
[rank2]:2025-10-29 13:59:15,145 - INFO - Avg. fwd time: 7.5119 / Avg. bwd time: 14.7625 / Avg. batch time: 483.8296 (ms) / GPU bubble ratio: 63.17%
[rank0]:2025-10-29 13:59:15,189 - INFO - Avg. fwd time: 8.4630 / Avg. bwd time: 16.6600 / Avg. batch time: 547.5433 (ms) / GPU bubble ratio: 63.29%
[rank0]:2025-10-29 14:00:48,773 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 14:00:50,431 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.51/0.51, [MB5] 0.51/0.51, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 14:00:50,432 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3970  memory: 17.22GiB(36.24%)  tps: 8,333  tflops: 65.15  mfu: 20.88%
[rank0]:2025-10-29 14:00:50,432 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 14:00:50,432 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.85/0.85, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank1]:2025-10-29 14:00:50,433 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3970  memory: 15.21GiB(32.01%)  tps: 8,332  tflops: 65.14  mfu: 20.88%
[rank1]:2025-10-29 14:00:50,433 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 14:00:50,432 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 14:00:50,432 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3970  memory: 12.51GiB(26.33%)  tps: 8,332  tflops: 65.14  mfu: 20.88%
[rank2]:2025-10-29 14:00:50,433 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 14:00:53,016 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:00:53,019 - INFO -  step: 200  loss:  5.4154  grad_norm:  0.3970  memory: 31.41GiB(66.13%)  tps: 8,338  tflops: 65.18  mfu: 20.89%
[rank3]:2025-10-29 14:00:53,020 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 14:01:13,798 - INFO - validate step: 200  loss:  1.2124  memory: 31.41GiB(66.13%)  tps: 19,714
[rank0]:2025-10-29 14:01:13,749 - INFO - validate step: 200  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 17,566
[rank1]:2025-10-29 14:01:13,770 - INFO - validate step: 200  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 17,552
[rank2]:2025-10-29 14:01:13,789 - INFO - validate step: 200  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 17,537
[rank0]:2025-10-29 14:01:13,874 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1401_stage0_step200.svg
[rank1]:2025-10-29 14:01:13,875 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1401_stage1_step200.svg
[rank2]:2025-10-29 14:01:13,877 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1401_stage2_step200.svg
[rank3]:2025-10-29 14:01:14,000 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1401_real_step200_rank3.svg
[rank3]:> Batch Time: 376.21 ms, GPU Bubble Ratio: 46.12%, 42.27%, 56.40%, 20.28%
[rank3]:2025-10-29 14:01:14,068 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1401_stage3_step200.svg
[rank3]:2025-10-29 14:01:14,264 - INFO - Avg. fwd time: 12.1231 / Avg. bwd time: 30.2410 / Avg. batch time: 399.8121 (ms) / GPU bubble ratio: 15.23%
[rank0]:2025-10-29 14:01:14,304 - INFO - Avg. fwd time: 8.6300 / Avg. bwd time: 15.4011 / Avg. batch time: 530.9980 (ms) / GPU bubble ratio: 63.79%
[rank2]:2025-10-29 14:01:14,315 - INFO - Avg. fwd time: 7.6528 / Avg. bwd time: 13.8189 / Avg. batch time: 470.0361 (ms) / GPU bubble ratio: 63.46%
[rank1]:2025-10-29 14:01:14,349 - INFO - Avg. fwd time: 9.9882 / Avg. bwd time: 17.8779 / Avg. batch time: 502.6761 (ms) / GPU bubble ratio: 55.65%
[rank0]:2025-10-29 14:02:42,683 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 14:02:44,275 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 14:02:44,276 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 9,053  tflops: 70.77  mfu: 22.68%
[rank0]:2025-10-29 14:02:44,276 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.51/0.51, [MB5] 0.51/0.51, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank1]:2025-10-29 14:02:44,276 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.85/0.85, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank0]:2025-10-29 14:02:44,276 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 9,049  tflops: 70.74  mfu: 22.67%
[rank0]:2025-10-29 14:02:44,326 - INFO - Avg. fwd time: 8.7449 / Avg. bwd time: 12.3020 / Avg. batch time: 512.2788 (ms) / GPU bubble ratio: 67.13%
[rank1]:2025-10-29 14:02:44,276 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 9,051  tflops: 70.76  mfu: 22.68%
[rank3]:2025-10-29 14:02:46,879 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:02:46,882 - INFO -  step: 250  loss:  5.2182  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,801  tflops: 68.80  mfu: 22.05%
[rank3]:2025-10-29 14:02:47,078 - INFO - Avg. fwd time: 12.3783 / Avg. bwd time: 28.2833 / Avg. batch time: 385.9041 (ms) / GPU bubble ratio: 15.71%
[rank1]:2025-10-29 14:02:47,161 - INFO - Avg. fwd time: 10.1945 / Avg. bwd time: 16.3954 / Avg. batch time: 487.1797 (ms) / GPU bubble ratio: 56.34%
[rank2]:2025-10-29 14:02:47,115 - INFO - Avg. fwd time: 7.8317 / Avg. bwd time: 12.6720 / Avg. batch time: 456.1179 (ms) / GPU bubble ratio: 64.04%
[rank0]:2025-10-29 14:04:15,369 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 14:04:17,165 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1404_rank0_trend_line.svg
[rank3]:2025-10-29 14:04:17,154 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1404_rank3_trend_line.svg
[rank1]:2025-10-29 14:04:17,168 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1404_rank1_trend_line.svg
[rank1]:2025-10-29 14:04:17,175 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 14:04:17,177 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 14:04:17,177 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,818  tflops: 68.94  mfu: 22.09%
[rank2]:2025-10-29 14:04:17,155 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1404_rank2_trend_line.svg
[rank2]:2025-10-29 14:04:17,175 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 14:04:17,177 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 14:04:17,177 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,818  tflops: 68.93  mfu: 22.09%
[rank0]:2025-10-29 14:04:17,175 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 14:04:17,177 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 14:04:17,177 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,818  tflops: 68.94  mfu: 22.09%
[rank3]:2025-10-29 14:04:17,373 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1404_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 305.91 ms, GPU Bubble Ratio: 58.87%, 40.84%, 55.16%, 17.34%
[rank3]:2025-10-29 14:04:17,374 - INFO - 	> Batch Time: 305.91 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 14:04:17,374 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:04:20,056 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:04:20,059 - INFO -  step: 300  loss:  4.9864  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,792  tflops: 68.73  mfu: 22.03%
[rank0]:2025-10-29 14:04:20,130 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1404_stage0_step300.svg
[rank1]:2025-10-29 14:04:20,133 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1404_stage1_step300.svg
[rank2]:2025-10-29 14:04:20,129 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1404_stage2_step300.svg
[rank3]:2025-10-29 14:04:20,254 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1404_real_step300_rank3.svg
[rank3]:> Batch Time: 343.42 ms, GPU Bubble Ratio: 56.37%, 44.73%, 57.37%, 18.04%
[rank3]:2025-10-29 14:04:20,321 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1404_stage3_step300.svg
[rank3]:2025-10-29 14:04:20,670 - INFO - Avg. fwd time: 12.5414 / Avg. bwd time: 26.9942 / Avg. batch time: 376.7237 (ms) / GPU bubble ratio: 16.04%
[rank2]:2025-10-29 14:04:20,685 - INFO - Avg. fwd time: 7.9501 / Avg. bwd time: 11.9004 / Avg. batch time: 449.0600 (ms) / GPU bubble ratio: 64.64%
[rank0]:2025-10-29 14:04:20,707 - INFO - Avg. fwd time: 8.8119 / Avg. bwd time: 10.1513 / Avg. batch time: 501.9351 (ms) / GPU bubble ratio: 69.78%
[rank1]:2025-10-29 14:04:20,702 - INFO - Avg. fwd time: 10.3304 / Avg. bwd time: 15.4034 / Avg. batch time: 479.0704 (ms) / GPU bubble ratio: 57.03%
[rank0]:2025-10-29 14:05:49,402 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 14:05:51,014 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,730  tflops: 68.25  mfu: 21.87%
[rank1]:2025-10-29 14:05:51,015 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,730  tflops: 68.25  mfu: 21.87%
[rank2]:2025-10-29 14:05:51,014 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,730  tflops: 68.25  mfu: 21.87%
[rank0]:2025-10-29 14:05:51,063 - INFO - Avg. fwd time: 8.8504 / Avg. bwd time: 8.8284 / Avg. batch time: 495.3618 (ms) / GPU bubble ratio: 71.45%
[rank3]:2025-10-29 14:05:53,620 - INFO -  step: 350  loss:  4.7514  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,756  tflops: 68.45  mfu: 21.94%
[rank3]:2025-10-29 14:05:53,828 - INFO - Avg. fwd time: 12.6391 / Avg. bwd time: 26.2023 / Avg. batch time: 371.0688 (ms) / GPU bubble ratio: 16.26%
[rank2]:2025-10-29 14:05:53,866 - INFO - Avg. fwd time: 8.0210 / Avg. bwd time: 11.4230 / Avg. batch time: 444.5150 (ms) / GPU bubble ratio: 65.01%
[rank1]:2025-10-29 14:05:53,912 - INFO - Avg. fwd time: 10.4115 / Avg. bwd time: 14.7900 / Avg. batch time: 473.8726 (ms) / GPU bubble ratio: 57.45%
[rank0]:2025-10-29 14:07:21,945 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 14:07:23,797 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1407_rank3_trend_line.svg
[rank1]:2025-10-29 14:07:23,811 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1407_rank1_trend_line.svg
[rank1]:2025-10-29 14:07:23,831 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 14:07:23,834 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,826  tflops: 69.00  mfu: 22.11%
[rank1]:2025-10-29 14:07:23,834 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 14:07:23,807 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1407_rank0_trend_line.svg
[rank0]:2025-10-29 14:07:23,831 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 14:07:23,833 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,826  tflops: 69.00  mfu: 22.11%
[rank0]:2025-10-29 14:07:23,834 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 14:07:23,824 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1407_rank2_trend_line.svg
[rank2]:2025-10-29 14:07:23,832 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 14:07:23,834 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,826  tflops: 69.00  mfu: 22.11%
[rank2]:2025-10-29 14:07:23,834 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 14:07:24,022 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1407_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 306.50 ms, GPU Bubble Ratio: 66.66%, 43.79%, 56.90%, 17.38%
[rank3]:2025-10-29 14:07:24,023 - INFO - 	> Batch Time: 306.50 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 14:07:24,023 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:07:26,631 - INFO -  step: 400  loss:  4.5567  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,808  tflops: 68.86  mfu: 22.07%
[rank3]:2025-10-29 14:07:26,631 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 14:07:45,666 - INFO - validate step: 400  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 18,762
[rank2]:2025-10-29 14:07:45,706 - INFO - validate step: 400  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 18,728
[rank3]:2025-10-29 14:07:45,714 - INFO - validate step: 400  loss:  1.1831  memory: 31.41GiB(66.13%)  tps: 21,466
[rank1]:2025-10-29 14:07:45,689 - INFO - validate step: 400  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 18,742
[rank0]:2025-10-29 14:07:45,793 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1407_stage0_step400.svg
[rank2]:2025-10-29 14:07:45,792 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1407_stage2_step400.svg
[rank1]:2025-10-29 14:07:45,794 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1407_stage1_step400.svg
[rank0]:2025-10-29 14:07:45,844 - INFO - Avg. fwd time: 8.8849 / Avg. bwd time: 7.6634 / Avg. batch time: 489.5858 (ms) / GPU bubble ratio: 72.96%
[rank3]:2025-10-29 14:07:45,899 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1407_real_step400_rank3.svg
[rank3]:> Batch Time: 324.24 ms, GPU Bubble Ratio: 77.60%, 46.42%, 58.56%, 14.78%
[rank3]:2025-10-29 14:07:45,970 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1407_stage3_step400.svg
[rank2]:2025-10-29 14:07:46,208 - INFO - Avg. fwd time: 8.0849 / Avg. bwd time: 11.0044 / Avg. batch time: 440.5313 (ms) / GPU bubble ratio: 65.33%
[rank3]:2025-10-29 14:07:46,170 - INFO - Avg. fwd time: 12.7277 / Avg. bwd time: 25.5096 / Avg. batch time: 366.1348 (ms) / GPU bubble ratio: 16.45%
[rank1]:2025-10-29 14:07:46,255 - INFO - Avg. fwd time: 10.4842 / Avg. bwd time: 14.2519 / Avg. batch time: 469.3154 (ms) / GPU bubble ratio: 57.83%
[rank0]:2025-10-29 14:09:15,581 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 14:09:17,160 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,958  tflops: 70.03  mfu: 22.44%
[rank1]:2025-10-29 14:09:17,161 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,956  tflops: 70.01  mfu: 22.44%
[rank0]:2025-10-29 14:09:17,161 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,954  tflops: 69.99  mfu: 22.43%
[rank3]:2025-10-29 14:09:19,844 - INFO -  step: 450  loss:  5.4881  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,703  tflops: 68.04  mfu: 21.81%
[rank3]:2025-10-29 14:09:20,190 - INFO - Avg. fwd time: 12.8000 / Avg. bwd time: 24.9823 / Avg. batch time: 362.4207 (ms) / GPU bubble ratio: 16.60%
[rank0]:2025-10-29 14:09:20,229 - INFO - Avg. fwd time: 8.9134 / Avg. bwd time: 6.7701 / Avg. batch time: 486.0311 (ms) / GPU bubble ratio: 74.19%
[rank2]:2025-10-29 14:09:20,205 - INFO - Avg. fwd time: 8.1352 / Avg. bwd time: 10.6854 / Avg. batch time: 438.3389 (ms) / GPU bubble ratio: 65.65%
[rank1]:2025-10-29 14:09:20,222 - INFO - Avg. fwd time: 10.5436 / Avg. bwd time: 13.8424 / Avg. batch time: 466.6898 (ms) / GPU bubble ratio: 58.20%
[rank0]:2025-10-29 14:10:48,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 14:10:49,959 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,828  tflops: 69.01  mfu: 22.12%
[rank2]:2025-10-29 14:10:49,959 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,828  tflops: 69.01  mfu: 22.12%
[rank1]:2025-10-29 14:10:49,959 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,828  tflops: 69.01  mfu: 22.12%
[rank3]:2025-10-29 14:10:52,513 - INFO -  step: 500  loss:  5.8889  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,840  tflops: 69.11  mfu: 22.15%
[rank2]:2025-10-29 14:10:52,589 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1410_stage2_step500.svg
[rank1]:2025-10-29 14:10:52,588 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1410_stage1_step500.svg
[rank0]:2025-10-29 14:10:52,587 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1410_stage0_step500.svg
[rank0]:2025-10-29 14:10:52,639 - INFO - Avg. fwd time: 8.9308 / Avg. bwd time: 6.1551 / Avg. batch time: 482.6401 (ms) / GPU bubble ratio: 74.99%
[rank3]:2025-10-29 14:10:52,710 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1410_real_step500_rank3.svg
[rank3]:> Batch Time: 323.42 ms, GPU Bubble Ratio: 77.51%, 46.28%, 58.43%, 14.78%
[rank3]:2025-10-29 14:10:52,778 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1410_stage3_step500.svg
[rank3]:2025-10-29 14:10:52,976 - INFO - Avg. fwd time: 12.8464 / Avg. bwd time: 24.6123 / Avg. batch time: 359.7799 (ms) / GPU bubble ratio: 16.71%
[rank2]:2025-10-29 14:10:53,011 - INFO - Avg. fwd time: 8.1688 / Avg. bwd time: 10.4643 / Avg. batch time: 435.8896 (ms) / GPU bubble ratio: 65.80%
[rank1]:2025-10-29 14:10:53,057 - INFO - Avg. fwd time: 10.5825 / Avg. bwd time: 13.5589 / Avg. batch time: 463.9389 (ms) / GPU bubble ratio: 58.37%
[rank0]:2025-10-29 14:12:22,737 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 14:12:24,313 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,682  tflops: 67.87  mfu: 21.75%
[rank2]:2025-10-29 14:12:24,313 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,682  tflops: 67.87  mfu: 21.75%
[rank1]:2025-10-29 14:12:24,313 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,682  tflops: 67.87  mfu: 21.75%
[rank0]:2025-10-29 14:12:24,366 - INFO - Avg. fwd time: 8.9475 / Avg. bwd time: 5.5654 / Avg. batch time: 479.3339 (ms) / GPU bubble ratio: 75.78%
[rank3]:2025-10-29 14:12:27,367 - INFO -  step: 550  loss:  5.6315  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,637  tflops: 67.52  mfu: 21.64%
[rank2]:2025-10-29 14:12:27,606 - INFO - Avg. fwd time: 8.2008 / Avg. bwd time: 10.2519 / Avg. batch time: 433.4919 (ms) / GPU bubble ratio: 65.95%
[rank3]:2025-10-29 14:12:27,570 - INFO - Avg. fwd time: 12.8913 / Avg. bwd time: 24.2597 / Avg. batch time: 357.2690 (ms) / GPU bubble ratio: 16.81%
[rank1]:2025-10-29 14:12:27,651 - INFO - Avg. fwd time: 10.6193 / Avg. bwd time: 13.2860 / Avg. batch time: 461.2500 (ms) / GPU bubble ratio: 58.54%
[rank0]:2025-10-29 14:13:58,346 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 14:14:00,279 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1413_rank1_trend_line.svg
[rank3]:2025-10-29 14:14:00,272 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1413_rank3_trend_line.svg
[rank0]:2025-10-29 14:14:00,270 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1413_rank0_trend_line.svg
[rank0]:2025-10-29 14:14:00,286 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 14:14:00,288 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank0]:2025-10-29 14:14:00,289 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 14:14:00,260 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1413_rank2_trend_line.svg
[rank2]:2025-10-29 14:14:00,286 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 14:14:00,288 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank2]:2025-10-29 14:14:00,289 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 14:14:00,286 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 14:14:00,289 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank1]:2025-10-29 14:14:00,289 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 14:14:00,496 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1413_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 305.83 ms, GPU Bubble Ratio: 71.52%, 45.46%, 58.04%, 17.11%
[rank3]:2025-10-29 14:14:00,497 - INFO - 	> Batch Time: 305.83 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 14:14:00,498 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:14:03,419 - INFO -  step: 600  loss:  5.4275  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,529  tflops: 66.68  mfu: 21.37%
[rank3]:2025-10-29 14:14:03,420 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 14:14:22,553 - INFO - validate step: 600  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 18,397
[rank0]:2025-10-29 14:14:22,513 - INFO - validate step: 600  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 18,431
[rank1]:2025-10-29 14:14:22,534 - INFO - validate step: 600  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 18,414
[rank3]:2025-10-29 14:14:22,560 - INFO - validate step: 600  loss:  1.2158  memory: 31.41GiB(66.13%)  tps: 21,402
[rank2]:2025-10-29 14:14:22,640 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1414_stage2_step600.svg
[rank0]:2025-10-29 14:14:22,638 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1414_stage0_step600.svg
[rank1]:2025-10-29 14:14:22,638 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1414_stage1_step600.svg
[rank3]:2025-10-29 14:14:22,756 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1414_real_step600_rank3.svg
[rank3]:> Batch Time: 322.99 ms, GPU Bubble Ratio: 77.47%, 46.20%, 58.39%, 14.78%
[rank3]:2025-10-29 14:14:22,825 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1414_stage3_step600.svg
[rank1]:2025-10-29 14:14:23,206 - INFO - Avg. fwd time: 10.6505 / Avg. bwd time: 13.0621 / Avg. batch time: 460.6696 (ms) / GPU bubble ratio: 58.82%
[rank3]:2025-10-29 14:14:23,171 - INFO - Avg. fwd time: 12.9286 / Avg. bwd time: 23.9679 / Avg. batch time: 355.1913 (ms) / GPU bubble ratio: 16.90%
[rank2]:2025-10-29 14:14:23,186 - INFO - Avg. fwd time: 8.2274 / Avg. bwd time: 10.0772 / Avg. batch time: 433.1480 (ms) / GPU bubble ratio: 66.19%
[rank0]:2025-10-29 14:14:23,213 - INFO - Avg. fwd time: 8.9625 / Avg. bwd time: 5.0788 / Avg. batch time: 478.2500 (ms) / GPU bubble ratio: 76.51%
[rank0]:2025-10-29 14:15:51,565 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 14:15:53,163 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 9,041  tflops: 70.68  mfu: 22.65%
[rank0]:2025-10-29 14:15:53,164 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 9,037  tflops: 70.65  mfu: 22.64%
[rank1]:2025-10-29 14:15:53,164 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 9,039  tflops: 70.66  mfu: 22.65%
[rank0]:2025-10-29 14:15:53,215 - INFO - Avg. fwd time: 8.9751 / Avg. bwd time: 4.7247 / Avg. batch time: 476.2796 (ms) / GPU bubble ratio: 76.99%
[rank3]:2025-10-29 14:15:55,756 - INFO -  step: 650  loss:  5.1482  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,790  tflops: 68.72  mfu: 22.03%
[rank2]:2025-10-29 14:15:55,995 - INFO - Avg. fwd time: 8.2478 / Avg. bwd time: 9.9512 / Avg. batch time: 431.7151 (ms) / GPU bubble ratio: 66.28%
[rank3]:2025-10-29 14:15:55,957 - INFO - Avg. fwd time: 12.9585 / Avg. bwd time: 23.7604 / Avg. batch time: 353.7418 (ms) / GPU bubble ratio: 16.96%
[rank1]:2025-10-29 14:15:56,039 - INFO - Avg. fwd time: 10.6746 / Avg. bwd time: 12.9007 / Avg. batch time: 459.0658 (ms) / GPU bubble ratio: 58.92%
[rank0]:2025-10-29 14:17:24,197 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:17:25,808 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,842  tflops: 69.13  mfu: 22.16%
[rank0]:2025-10-29 14:17:25,808 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,842  tflops: 69.13  mfu: 22.16%
[rank1]:2025-10-29 14:17:25,808 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,842  tflops: 69.13  mfu: 22.16%
[rank3]:2025-10-29 14:17:28,419 - INFO -  step: 700  loss:  4.9785  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,841  tflops: 69.11  mfu: 22.15%
[rank2]:2025-10-29 14:17:28,499 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1417_stage2_step700.svg
[rank0]:2025-10-29 14:17:28,499 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1417_stage0_step700.svg
[rank1]:2025-10-29 14:17:28,501 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1417_stage1_step700.svg
[rank0]:2025-10-29 14:17:28,551 - INFO - Avg. fwd time: 8.9857 / Avg. bwd time: 4.3694 / Avg. batch time: 474.4581 (ms) / GPU bubble ratio: 77.48%
[rank3]:2025-10-29 14:17:28,610 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1417_real_step700_rank3.svg
[rank3]:> Batch Time: 322.71 ms, GPU Bubble Ratio: 77.43%, 46.17%, 58.37%, 14.78%
[rank3]:2025-10-29 14:17:28,680 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1417_stage3_step700.svg
[rank3]:2025-10-29 14:17:28,883 - INFO - Avg. fwd time: 12.9854 / Avg. bwd time: 23.5476 / Avg. batch time: 352.2271 (ms) / GPU bubble ratio: 17.02%
[rank2]:2025-10-29 14:17:28,920 - INFO - Avg. fwd time: 8.2669 / Avg. bwd time: 9.8231 / Avg. batch time: 430.4371 (ms) / GPU bubble ratio: 66.38%
[rank1]:2025-10-29 14:17:28,965 - INFO - Avg. fwd time: 10.6968 / Avg. bwd time: 12.7364 / Avg. batch time: 457.6141 (ms) / GPU bubble ratio: 59.03%
[rank0]:2025-10-29 14:18:57,146 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 14:18:58,761 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,813  tflops: 68.90  mfu: 22.08%
[rank1]:2025-10-29 14:18:58,761 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,813  tflops: 68.90  mfu: 22.08%
[rank2]:2025-10-29 14:18:58,761 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,813  tflops: 68.90  mfu: 22.08%
[rank3]:2025-10-29 14:19:01,373 - INFO -  step: 750  loss:  4.7417  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,813  tflops: 68.90  mfu: 22.08%
[rank3]:2025-10-29 14:19:01,727 - INFO - Avg. fwd time: 13.0095 / Avg. bwd time: 23.3644 / Avg. batch time: 350.9303 (ms) / GPU bubble ratio: 17.08%
[rank1]:2025-10-29 14:19:01,762 - INFO - Avg. fwd time: 10.7169 / Avg. bwd time: 12.5960 / Avg. batch time: 456.4689 (ms) / GPU bubble ratio: 59.14%
[rank2]:2025-10-29 14:19:01,744 - INFO - Avg. fwd time: 8.2839 / Avg. bwd time: 9.7138 / Avg. batch time: 429.4395 (ms) / GPU bubble ratio: 66.47%
[rank0]:2025-10-29 14:19:01,770 - INFO - Avg. fwd time: 8.9951 / Avg. bwd time: 4.0638 / Avg. batch time: 472.9956 (ms) / GPU bubble ratio: 77.91%
[rank0]:2025-10-29 14:20:29,458 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:20:31,517 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1420_rank2_trend_line.svg
[rank2]:2025-10-29 14:20:31,547 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 14:20:31,550 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 8,829  tflops: 69.02  mfu: 22.12%
[rank2]:2025-10-29 14:20:31,550 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 14:20:31,529 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1420_rank3_trend_line.svg
[rank0]:2025-10-29 14:20:31,528 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1420_rank0_trend_line.svg
[rank0]:2025-10-29 14:20:31,547 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 14:20:31,550 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 17.22GiB(36.24%)  tps: 8,829  tflops: 69.02  mfu: 22.12%
[rank0]:2025-10-29 14:20:31,550 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 14:20:31,540 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1420_rank1_trend_line.svg
[rank1]:2025-10-29 14:20:31,547 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-29 14:20:31,550 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 15.21GiB(32.01%)  tps: 8,829  tflops: 69.02  mfu: 22.12%
[rank1]:2025-10-29 14:20:31,550 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 14:20:31,746 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1420_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 304.70 ms, GPU Bubble Ratio: 73.60%, 46.03%, 58.45%, 16.78%
[rank3]:2025-10-29 14:20:31,747 - INFO - 	> Batch Time: 304.70 ms (Average Freeze Ratio: 0.28)
[rank3]:2025-10-29 14:20:31,748 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:20:34,298 - INFO -  step: 800  loss:  4.5434  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,816  tflops: 68.92  mfu: 22.09%
[rank3]:2025-10-29 14:20:34,299 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 14:20:53,373 - INFO - validate step: 800  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 18,770
[rank0]:2025-10-29 14:20:53,374 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 14:20:53,380 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 14:20:53,393 - INFO - validate step: 800  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 18,752
[rank1]:2025-10-29 14:20:53,394 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 14:20:53,412 - INFO - validate step: 800  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 18,736
[rank2]:2025-10-29 14:20:53,413 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 14:20:53,420 - INFO - validate step: 800  loss:  1.1851  memory: 31.41GiB(66.13%)  tps: 21,422
[rank3]:2025-10-29 14:20:53,422 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 14:20:55,275 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-29 14:20:55,818 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.42 seconds.
[rank3]:2025-10-29 14:20:56,912 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.49 seconds.
[rank0]:2025-10-29 14:20:57,227 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 14:20:57,237 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.86 seconds.
[rank1]:2025-10-29 14:20:57,325 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1420_stage1_step800.svg
[rank2]:2025-10-29 14:20:57,322 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1420_stage2_step800.svg
[rank0]:2025-10-29 14:20:57,455 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1420_stage0_step800.svg
[rank3]:2025-10-29 14:20:57,585 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1420_real_step800_rank3.svg
[rank3]:> Batch Time: 322.51 ms, GPU Bubble Ratio: 77.41%, 46.14%, 58.35%, 14.78%
[rank0]:2025-10-29 14:20:57,607 - INFO - Avg. fwd time: 9.0030 / Avg. bwd time: 3.8339 / Avg. batch time: 471.4478 (ms) / GPU bubble ratio: 78.22%
[rank3]:2025-10-29 14:20:57,665 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1420_stage3_step800.svg
[rank2]:2025-10-29 14:20:58,666 - INFO - Avg. fwd time: 8.2974 / Avg. bwd time: 9.6324 / Avg. batch time: 428.2401 (ms) / GPU bubble ratio: 66.51%
[rank3]:2025-10-29 14:20:58,697 - INFO - Avg. fwd time: 13.0289 / Avg. bwd time: 23.2269 / Avg. batch time: 349.9657 (ms) / GPU bubble ratio: 17.12%
[rank1]:2025-10-29 14:20:58,712 - INFO - Avg. fwd time: 10.7332 / Avg. bwd time: 12.4919 / Avg. batch time: 455.1606 (ms) / GPU bubble ratio: 59.18%
[rank3]:2025-10-29 14:21:24,308 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 14:21:24,519 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 14:21:24,552 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 14:21:24,579 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 14:22:49,352 - INFO - [GC] Peforming periodical GC collection 0.29 seconds
[rank2]:2025-10-29 14:22:51,378 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 6,944  tflops: 54.29  mfu: 17.40%
[rank1]:2025-10-29 14:22:51,395 - INFO -  step: 850  loss: -4.0000  grad_norm:  4.4978  memory: 15.21GiB(32.01%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank0]:2025-10-29 14:22:51,406 - INFO -  step: 850  loss: -4.0000  grad_norm:  4.4978  memory: 17.22GiB(36.24%)  tps: 6,940  tflops: 54.26  mfu: 17.39%
[rank3]:2025-10-29 14:22:54,076 - INFO -  step: 850  loss:  4.8996  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 6,790  tflops: 53.08  mfu: 17.01%
[rank2]:2025-10-29 14:22:54,310 - INFO - Avg. fwd time: 8.3106 / Avg. bwd time: 9.5476 / Avg. batch time: 429.2652 (ms) / GPU bubble ratio: 66.72%
[rank3]:2025-10-29 14:22:54,274 - INFO - Avg. fwd time: 13.0458 / Avg. bwd time: 23.1213 / Avg. batch time: 349.2425 (ms) / GPU bubble ratio: 17.15%
[rank1]:2025-10-29 14:22:54,420 - INFO - Avg. fwd time: 10.6400 / Avg. bwd time: 13.2312 / Avg. batch time: 458.0854 (ms) / GPU bubble ratio: 58.31%
[rank0]:2025-10-29 14:22:54,427 - INFO - Avg. fwd time: 8.9584 / Avg. bwd time: 4.9608 / Avg. batch time: 475.5599 (ms) / GPU bubble ratio: 76.58%
[rank0]:2025-10-29 14:24:43,990 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:24:46,004 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,147  tflops: 55.87  mfu: 17.91%
[rank1]:2025-10-29 14:24:46,020 - INFO -  step: 900  loss: -4.0000  grad_norm:  5.4077  memory: 15.21GiB(32.01%)  tps: 7,147  tflops: 55.87  mfu: 17.91%
[rank0]:2025-10-29 14:24:46,031 - INFO -  step: 900  loss: -4.0000  grad_norm:  5.4077  memory: 17.22GiB(36.24%)  tps: 7,147  tflops: 55.87  mfu: 17.91%
[rank3]:2025-10-29 14:24:48,513 - INFO -  step: 900  loss:  5.0816  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,159  tflops: 55.96  mfu: 17.94%
[rank1]:2025-10-29 14:24:48,588 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1424_stage1_step900.svg
[rank0]:2025-10-29 14:24:48,587 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1424_stage0_step900.svg
[rank2]:2025-10-29 14:24:48,588 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1424_stage2_step900.svg
[rank3]:2025-10-29 14:24:48,704 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1424_real_step900_rank3.svg
[rank3]:> Batch Time: 322.42 ms, GPU Bubble Ratio: 77.46%, 46.09%, 58.36%, 14.81%
[rank3]:2025-10-29 14:24:48,767 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1424_stage3_step900.svg
[rank3]:2025-10-29 14:24:49,111 - INFO - Avg. fwd time: 13.0562 / Avg. bwd time: 22.9930 / Avg. batch time: 348.2798 (ms) / GPU bubble ratio: 17.19%
[rank2]:2025-10-29 14:24:49,159 - INFO - Avg. fwd time: 8.3202 / Avg. bwd time: 9.4691 / Avg. batch time: 430.6715 (ms) / GPU bubble ratio: 66.96%
[rank1]:2025-10-29 14:24:49,207 - INFO - Avg. fwd time: 10.5439 / Avg. bwd time: 13.9608 / Avg. batch time: 461.3573 (ms) / GPU bubble ratio: 57.51%
[rank0]:2025-10-29 14:24:49,240 - INFO - Avg. fwd time: 8.9097 / Avg. bwd time: 6.0870 / Avg. batch time: 480.0011 (ms) / GPU bubble ratio: 75.01%
[rank0]:2025-10-29 14:26:38,668 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 14:26:40,679 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,144  tflops: 55.85  mfu: 17.90%
[rank1]:2025-10-29 14:26:40,696 - INFO -  step: 950  loss: -4.0000  grad_norm:  5.3208  memory: 15.21GiB(32.01%)  tps: 7,144  tflops: 55.85  mfu: 17.90%
[rank0]:2025-10-29 14:26:40,707 - INFO -  step: 950  loss: -4.0000  grad_norm:  5.3208  memory: 17.22GiB(36.24%)  tps: 7,144  tflops: 55.85  mfu: 17.90%
[rank3]:2025-10-29 14:26:43,277 - INFO -  step: 950  loss:  4.8660  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,138  tflops: 55.80  mfu: 17.89%
[rank2]:2025-10-29 14:26:43,514 - INFO - Avg. fwd time: 8.3280 / Avg. bwd time: 9.4097 / Avg. batch time: 431.5017 (ms) / GPU bubble ratio: 67.11%
[rank3]:2025-10-29 14:26:43,477 - INFO - Avg. fwd time: 13.0657 / Avg. bwd time: 22.8981 / Avg. batch time: 347.5812 (ms) / GPU bubble ratio: 17.23%
[rank1]:2025-10-29 14:26:43,627 - INFO - Avg. fwd time: 10.4713 / Avg. bwd time: 14.5275 / Avg. batch time: 463.6329 (ms) / GPU bubble ratio: 56.86%
[rank0]:2025-10-29 14:26:43,635 - INFO - Avg. fwd time: 8.8727 / Avg. bwd time: 6.9538 / Avg. batch time: 483.1736 (ms) / GPU bubble ratio: 73.80%
[rank0]:2025-10-29 14:28:33,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:28:35,247 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,150  tflops: 55.90  mfu: 17.92%
[rank2]:2025-10-29 14:28:35,248 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 14:28:35,264 - INFO -  step: 1000  loss: -4.0000  grad_norm: 12.7270  memory: 15.21GiB(32.01%)  tps: 7,150  tflops: 55.90  mfu: 17.92%
[rank1]:2025-10-29 14:28:35,265 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 14:28:35,276 - INFO -  step: 1000  loss: -4.0000  grad_norm: 12.7270  memory: 17.22GiB(36.24%)  tps: 7,150  tflops: 55.90  mfu: 17.92%
[rank0]:2025-10-29 14:28:35,276 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 14:28:38,579 - INFO -  step: 1000  loss:  4.7057  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,105  tflops: 55.54  mfu: 17.80%
[rank3]:2025-10-29 14:28:38,579 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 14:28:57,806 - INFO - validate step: 1000  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 18,158
[rank3]:2025-10-29 14:28:57,813 - INFO - validate step: 1000  loss:  1.1187  memory: 31.41GiB(66.13%)  tps: 21,298
[rank1]:2025-10-29 14:28:57,790 - INFO - validate step: 1000  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 18,185
[rank0]:2025-10-29 14:28:57,772 - INFO - validate step: 1000  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 18,208
[rank2]:2025-10-29 14:28:57,898 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1428_stage2_step1000.svg
[rank1]:2025-10-29 14:28:57,902 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1428_stage1_step1000.svg
[rank0]:2025-10-29 14:28:57,898 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1428_stage0_step1000.svg
[rank3]:2025-10-29 14:28:58,019 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1428_real_step1000_rank3.svg
[rank3]:> Batch Time: 322.30 ms, GPU Bubble Ratio: 77.51%, 46.07%, 58.38%, 14.83%
[rank3]:2025-10-29 14:28:58,087 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1428_stage3_step1000.svg
[rank3]:2025-10-29 14:28:58,290 - INFO - Avg. fwd time: 13.0741 / Avg. bwd time: 22.7939 / Avg. batch time: 346.8022 (ms) / GPU bubble ratio: 17.26%
[rank2]:2025-10-29 14:28:58,327 - INFO - Avg. fwd time: 8.3355 / Avg. bwd time: 9.3467 / Avg. batch time: 432.5674 (ms) / GPU bubble ratio: 67.30%
[rank1]:2025-10-29 14:28:58,442 - INFO - Avg. fwd time: 10.3932 / Avg. bwd time: 15.1239 / Avg. batch time: 466.2133 (ms) / GPU bubble ratio: 56.21%
[rank0]:2025-10-29 14:28:58,448 - INFO - Avg. fwd time: 8.8322 / Avg. bwd time: 7.8648 / Avg. batch time: 486.6977 (ms) / GPU bubble ratio: 72.55%
[rank0]:2025-10-29 14:30:48,254 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 14:30:50,259 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,285  tflops: 56.95  mfu: 18.25%
[rank1]:2025-10-29 14:30:50,277 - INFO -  step: 1050  loss: -4.0000  grad_norm:  6.7737  memory: 15.21GiB(32.01%)  tps: 7,283  tflops: 56.93  mfu: 18.25%
[rank0]:2025-10-29 14:30:50,287 - INFO -  step: 1050  loss: -4.0000  grad_norm:  6.7737  memory: 17.22GiB(36.24%)  tps: 7,281  tflops: 56.92  mfu: 18.24%
[rank3]:2025-10-29 14:30:52,940 - INFO -  step: 1050  loss:  4.5935  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,116  tflops: 55.63  mfu: 17.83%
[rank2]:2025-10-29 14:30:53,340 - INFO - Avg. fwd time: 8.3424 / Avg. bwd time: 9.2906 / Avg. batch time: 433.6739 (ms) / GPU bubble ratio: 67.47%
[rank3]:2025-10-29 14:30:53,293 - INFO - Avg. fwd time: 13.0821 / Avg. bwd time: 22.7029 / Avg. batch time: 346.1270 (ms) / GPU bubble ratio: 17.29%
[rank1]:2025-10-29 14:30:53,390 - INFO - Avg. fwd time: 10.3228 / Avg. bwd time: 15.6535 / Avg. batch time: 468.6755 (ms) / GPU bubble ratio: 55.66%
[rank0]:2025-10-29 14:30:53,424 - INFO - Avg. fwd time: 8.7977 / Avg. bwd time: 8.6866 / Avg. batch time: 490.0136 (ms) / GPU bubble ratio: 71.45%
[rank0]:2025-10-29 14:32:43,159 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 14:32:45,249 - INFO -  step: 1100  loss: -4.0000  grad_norm:  5.6201  memory: 17.22GiB(36.24%)  tps: 7,126  tflops: 55.71  mfu: 17.85%
[rank2]:2025-10-29 14:32:45,220 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,126  tflops: 55.71  mfu: 17.85%
[rank1]:2025-10-29 14:32:45,241 - INFO -  step: 1100  loss: -4.0000  grad_norm:  5.6201  memory: 15.21GiB(32.01%)  tps: 7,126  tflops: 55.71  mfu: 17.85%
[rank3]:2025-10-29 14:32:47,725 - INFO -  step: 1100  loss:  4.4835  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,137  tflops: 55.79  mfu: 17.88%
[rank2]:2025-10-29 14:32:47,804 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1432_stage2_step1100.svg
[rank1]:2025-10-29 14:32:47,813 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1432_stage1_step1100.svg
[rank0]:2025-10-29 14:32:47,802 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1432_stage0_step1100.svg
[rank3]:2025-10-29 14:32:47,914 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1432_real_step1100_rank3.svg
[rank3]:> Batch Time: 322.24 ms, GPU Bubble Ratio: 77.57%, 46.06%, 58.39%, 14.85%
[rank3]:2025-10-29 14:32:47,980 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1432_stage3_step1100.svg
[rank3]:2025-10-29 14:32:48,185 - INFO - Avg. fwd time: 13.0888 / Avg. bwd time: 22.6323 / Avg. batch time: 345.6046 (ms) / GPU bubble ratio: 17.31%
[rank2]:2025-10-29 14:32:48,221 - INFO - Avg. fwd time: 8.3480 / Avg. bwd time: 9.2474 / Avg. batch time: 434.3056 (ms) / GPU bubble ratio: 67.59%
[rank1]:2025-10-29 14:32:48,338 - INFO - Avg. fwd time: 10.2691 / Avg. bwd time: 16.0758 / Avg. batch time: 470.3837 (ms) / GPU bubble ratio: 55.19%
[rank0]:2025-10-29 14:32:48,345 - INFO - Avg. fwd time: 8.7718 / Avg. bwd time: 9.3322 / Avg. batch time: 492.3946 (ms) / GPU bubble ratio: 70.59%
[rank0]:2025-10-29 14:34:38,215 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 14:34:40,274 - INFO -  step: 1150  loss: -4.0000  grad_norm:  2.3832  memory: 15.21GiB(32.01%)  tps: 7,121  tflops: 55.67  mfu: 17.84%
[rank0]:2025-10-29 14:34:40,286 - INFO -  step: 1150  loss: -4.0000  grad_norm:  2.3832  memory: 17.22GiB(36.24%)  tps: 7,121  tflops: 55.67  mfu: 17.84%
[rank2]:2025-10-29 14:34:40,258 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,121  tflops: 55.67  mfu: 17.84%
[rank3]:2025-10-29 14:34:42,775 - INFO -  step: 1150  loss:  4.5171  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,121  tflops: 55.67  mfu: 17.84%
[rank3]:2025-10-29 14:34:42,982 - INFO - Avg. fwd time: 13.0964 / Avg. bwd time: 22.5572 / Avg. batch time: 345.0521 (ms) / GPU bubble ratio: 17.34%
[rank2]:2025-10-29 14:34:43,019 - INFO - Avg. fwd time: 8.3540 / Avg. bwd time: 9.2013 / Avg. batch time: 434.6407 (ms) / GPU bubble ratio: 67.69%
[rank1]:2025-10-29 14:34:43,139 - INFO - Avg. fwd time: 10.2117 / Avg. bwd time: 16.5321 / Avg. batch time: 471.8831 (ms) / GPU bubble ratio: 54.66%
[rank0]:2025-10-29 14:34:43,145 - INFO - Avg. fwd time: 8.7452 / Avg. bwd time: 10.0225 / Avg. batch time: 494.6151 (ms) / GPU bubble ratio: 69.64%
[rank0]:2025-10-29 14:36:33,112 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:36:35,169 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,129  tflops: 55.73  mfu: 17.86%
[rank2]:2025-10-29 14:36:35,170 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 14:36:35,187 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2781  memory: 15.21GiB(32.01%)  tps: 7,129  tflops: 55.73  mfu: 17.86%
[rank1]:2025-10-29 14:36:35,187 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 14:36:35,199 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2781  memory: 17.22GiB(36.24%)  tps: 7,129  tflops: 55.73  mfu: 17.86%
[rank0]:2025-10-29 14:36:35,199 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 14:36:37,823 - INFO -  step: 1200  loss:  4.4464  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,121  tflops: 55.67  mfu: 17.84%
[rank3]:2025-10-29 14:36:37,823 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 14:36:56,778 - INFO - validate step: 1200  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 18,982
[rank2]:2025-10-29 14:36:56,813 - INFO - validate step: 1200  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 18,925
[rank1]:2025-10-29 14:36:56,798 - INFO - validate step: 1200  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 18,953
[rank3]:2025-10-29 14:36:56,821 - INFO - validate step: 1200  loss:  1.0988  memory: 31.41GiB(66.13%)  tps: 21,562
[rank2]:2025-10-29 14:36:56,901 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1436_stage2_step1200.svg
[rank1]:2025-10-29 14:36:56,908 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1436_stage1_step1200.svg
[rank0]:2025-10-29 14:36:56,902 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1436_stage0_step1200.svg
[rank3]:2025-10-29 14:36:57,016 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1436_real_step1200_rank3.svg
[rank3]:> Batch Time: 322.25 ms, GPU Bubble Ratio: 77.64%, 46.06%, 58.41%, 14.87%
[rank3]:2025-10-29 14:36:57,086 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1436_stage3_step1200.svg
[rank3]:2025-10-29 14:36:57,446 - INFO - Avg. fwd time: 13.1033 / Avg. bwd time: 22.4902 / Avg. batch time: 344.5666 (ms) / GPU bubble ratio: 17.36%
[rank2]:2025-10-29 14:36:57,488 - INFO - Avg. fwd time: 8.3596 / Avg. bwd time: 9.1603 / Avg. batch time: 435.4931 (ms) / GPU bubble ratio: 67.82%
[rank1]:2025-10-29 14:36:57,538 - INFO - Avg. fwd time: 10.1589 / Avg. bwd time: 16.9426 / Avg. batch time: 473.7778 (ms) / GPU bubble ratio: 54.24%
[rank0]:2025-10-29 14:36:57,572 - INFO - Avg. fwd time: 8.7211 / Avg. bwd time: 10.6529 / Avg. batch time: 497.1704 (ms) / GPU bubble ratio: 68.83%
[rank0]:2025-10-29 14:38:47,275 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 14:38:49,304 - INFO -  step: 1250  loss: -4.0000  grad_norm:  2.7047  memory: 15.21GiB(32.01%)  tps: 7,281  tflops: 56.92  mfu: 18.24%
[rank0]:2025-10-29 14:38:49,316 - INFO -  step: 1250  loss: -4.0000  grad_norm:  2.7047  memory: 17.22GiB(36.24%)  tps: 7,279  tflops: 56.91  mfu: 18.24%
[rank2]:2025-10-29 14:38:49,287 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,283  tflops: 56.94  mfu: 18.25%
[rank3]:2025-10-29 14:38:51,954 - INFO -  step: 1250  loss:  4.5517  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,115  tflops: 55.62  mfu: 17.83%
[rank3]:2025-10-29 14:38:52,157 - INFO - Avg. fwd time: 13.1077 / Avg. bwd time: 22.4350 / Avg. batch time: 344.1505 (ms) / GPU bubble ratio: 17.38%
[rank2]:2025-10-29 14:38:52,194 - INFO - Avg. fwd time: 8.3634 / Avg. bwd time: 9.1273 / Avg. batch time: 435.9871 (ms) / GPU bubble ratio: 67.91%
[rank1]:2025-10-29 14:38:52,307 - INFO - Avg. fwd time: 10.1158 / Avg. bwd time: 17.2661 / Avg. batch time: 475.0926 (ms) / GPU bubble ratio: 53.89%
[rank0]:2025-10-29 14:38:52,313 - INFO - Avg. fwd time: 8.6998 / Avg. bwd time: 11.1488 / Avg. batch time: 498.9990 (ms) / GPU bubble ratio: 68.18%
[rank0]:2025-10-29 14:40:42,290 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:40:44,310 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,122  tflops: 55.68  mfu: 17.85%
[rank1]:2025-10-29 14:40:44,327 - INFO -  step: 1300  loss: -4.0000  grad_norm:  5.5829  memory: 15.21GiB(32.01%)  tps: 7,122  tflops: 55.68  mfu: 17.85%
[rank0]:2025-10-29 14:40:44,340 - INFO -  step: 1300  loss: -4.0000  grad_norm:  5.5829  memory: 17.22GiB(36.24%)  tps: 7,122  tflops: 55.68  mfu: 17.85%
[rank3]:2025-10-29 14:40:46,817 - INFO -  step: 1300  loss:  4.5759  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,132  tflops: 55.76  mfu: 17.87%
[rank2]:2025-10-29 14:40:46,900 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1440_stage2_step1300.svg
[rank1]:2025-10-29 14:40:46,899 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1440_stage1_step1300.svg
[rank0]:2025-10-29 14:40:46,897 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1440_stage0_step1300.svg
[rank3]:2025-10-29 14:40:47,014 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1440_real_step1300_rank3.svg
[rank3]:> Batch Time: 333.22 ms, GPU Bubble Ratio: 56.18%, 44.63%, 59.78%, 17.69%
[rank3]:2025-10-29 14:40:47,082 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1440_stage3_step1300.svg
[rank3]:2025-10-29 14:40:47,284 - INFO - Avg. fwd time: 13.1134 / Avg. bwd time: 22.3776 / Avg. batch time: 343.7281 (ms) / GPU bubble ratio: 17.40%
[rank2]:2025-10-29 14:40:47,320 - INFO - Avg. fwd time: 8.3678 / Avg. bwd time: 9.0932 / Avg. batch time: 436.7374 (ms) / GPU bubble ratio: 68.02%
[rank1]:2025-10-29 14:40:47,435 - INFO - Avg. fwd time: 10.0701 / Avg. bwd time: 17.6196 / Avg. batch time: 476.7339 (ms) / GPU bubble ratio: 53.53%
[rank0]:2025-10-29 14:40:47,442 - INFO - Avg. fwd time: 8.6785 / Avg. bwd time: 11.6861 / Avg. batch time: 501.1968 (ms) / GPU bubble ratio: 67.49%
[rank0]:2025-10-29 14:42:37,087 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:42:39,096 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,137  tflops: 55.79  mfu: 17.88%
[rank1]:2025-10-29 14:42:39,113 - INFO -  step: 1350  loss: -4.0000  grad_norm:  9.0376  memory: 15.21GiB(32.01%)  tps: 7,137  tflops: 55.79  mfu: 17.88%
[rank0]:2025-10-29 14:42:39,125 - INFO -  step: 1350  loss: -4.0000  grad_norm:  9.0376  memory: 17.22GiB(36.24%)  tps: 7,137  tflops: 55.79  mfu: 17.88%
[rank3]:2025-10-29 14:42:41,757 - INFO -  step: 1350  loss:  4.5023  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,127  tflops: 55.72  mfu: 17.86%
[rank3]:2025-10-29 14:42:42,104 - INFO - Avg. fwd time: 13.1178 / Avg. bwd time: 22.3235 / Avg. batch time: 343.3206 (ms) / GPU bubble ratio: 17.42%
[rank2]:2025-10-29 14:42:42,152 - INFO - Avg. fwd time: 8.3716 / Avg. bwd time: 9.0614 / Avg. batch time: 437.3841 (ms) / GPU bubble ratio: 68.11%
[rank1]:2025-10-29 14:42:42,199 - INFO - Avg. fwd time: 10.0277 / Avg. bwd time: 17.9441 / Avg. batch time: 478.2050 (ms) / GPU bubble ratio: 53.21%
[rank0]:2025-10-29 14:42:42,234 - INFO - Avg. fwd time: 8.6582 / Avg. bwd time: 12.1816 / Avg. batch time: 503.1823 (ms) / GPU bubble ratio: 66.87%
[rank0]:2025-10-29 14:44:31,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:44:33,700 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,148  tflops: 55.88  mfu: 17.91%
[rank2]:2025-10-29 14:44:33,700 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 14:44:33,730 - INFO -  step: 1400  loss: -4.0000  grad_norm:  4.3619  memory: 17.22GiB(36.24%)  tps: 7,148  tflops: 55.88  mfu: 17.91%
[rank0]:2025-10-29 14:44:33,730 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 14:44:33,717 - INFO -  step: 1400  loss: -4.0000  grad_norm:  4.3619  memory: 15.21GiB(32.01%)  tps: 7,148  tflops: 55.88  mfu: 17.91%
[rank1]:2025-10-29 14:44:33,717 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 14:44:36,157 - INFO -  step: 1400  loss:  4.5561  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,161  tflops: 55.98  mfu: 17.94%
[rank3]:2025-10-29 14:44:36,158 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 14:44:55,359 - INFO - validate step: 1400  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 18,937
[rank1]:2025-10-29 14:44:55,378 - INFO - validate step: 1400  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 18,910
[rank2]:2025-10-29 14:44:55,395 - INFO - validate step: 1400  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 18,880
[rank3]:2025-10-29 14:44:55,404 - INFO - validate step: 1400  loss:  1.1004  memory: 31.41GiB(66.13%)  tps: 21,284
[rank0]:2025-10-29 14:44:55,487 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1444_stage0_step1400.svg
[rank1]:2025-10-29 14:44:55,487 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1444_stage1_step1400.svg
[rank2]:2025-10-29 14:44:55,487 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1444_stage2_step1400.svg
[rank3]:2025-10-29 14:44:55,604 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1444_real_step1400_rank3.svg
[rank3]:> Batch Time: 345.02 ms, GPU Bubble Ratio: 43.25%, 37.27%, 61.15%, 20.51%
[rank3]:2025-10-29 14:44:55,676 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1444_stage3_step1400.svg
[rank2]:2025-10-29 14:44:55,918 - INFO - Avg. fwd time: 8.3750 / Avg. bwd time: 9.0369 / Avg. batch time: 437.7295 (ms) / GPU bubble ratio: 68.18%
[rank3]:2025-10-29 14:44:55,881 - INFO - Avg. fwd time: 13.1221 / Avg. bwd time: 22.2825 / Avg. batch time: 343.0212 (ms) / GPU bubble ratio: 17.43%
[rank0]:2025-10-29 14:44:56,034 - INFO - Avg. fwd time: 8.6432 / Avg. bwd time: 12.5778 / Avg. batch time: 504.5991 (ms) / GPU bubble ratio: 66.36%
[rank1]:2025-10-29 14:44:56,027 - INFO - Avg. fwd time: 9.9946 / Avg. bwd time: 18.2056 / Avg. batch time: 479.2113 (ms) / GPU bubble ratio: 52.92%
[rank0]:2025-10-29 14:46:45,866 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 14:46:47,937 - INFO -  step: 1450  loss: -4.0000  grad_norm:  1.4817  memory: 17.22GiB(36.24%)  tps: 7,277  tflops: 56.89  mfu: 18.23%
[rank2]:2025-10-29 14:46:47,909 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,281  tflops: 56.92  mfu: 18.24%
[rank1]:2025-10-29 14:46:47,926 - INFO -  step: 1450  loss: -4.0000  grad_norm:  1.4817  memory: 15.21GiB(32.01%)  tps: 7,279  tflops: 56.90  mfu: 18.24%
[rank3]:2025-10-29 14:46:50,501 - INFO -  step: 1450  loss:  4.5121  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,118  tflops: 55.64  mfu: 17.83%
[rank3]:2025-10-29 14:46:50,708 - INFO - Avg. fwd time: 13.1269 / Avg. bwd time: 22.2387 / Avg. batch time: 342.7020 (ms) / GPU bubble ratio: 17.44%
[rank2]:2025-10-29 14:46:50,745 - INFO - Avg. fwd time: 8.3785 / Avg. bwd time: 9.0099 / Avg. batch time: 437.8606 (ms) / GPU bubble ratio: 68.23%
[rank1]:2025-10-29 14:46:50,855 - INFO - Avg. fwd time: 9.9581 / Avg. bwd time: 18.4887 / Avg. batch time: 480.0623 (ms) / GPU bubble ratio: 52.59%
[rank0]:2025-10-29 14:46:50,862 - INFO - Avg. fwd time: 8.6254 / Avg. bwd time: 13.0082 / Avg. batch time: 505.8978 (ms) / GPU bubble ratio: 65.79%
[rank0]:2025-10-29 14:48:40,276 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 14:48:42,362 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3716  memory: 17.22GiB(36.24%)  tps: 7,159  tflops: 55.97  mfu: 17.94%
[rank1]:2025-10-29 14:48:42,351 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3716  memory: 15.21GiB(32.01%)  tps: 7,159  tflops: 55.97  mfu: 17.94%
[rank2]:2025-10-29 14:48:42,334 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,159  tflops: 55.97  mfu: 17.94%
[rank3]:2025-10-29 14:48:44,854 - INFO -  step: 1500  loss:  4.4802  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,164  tflops: 56.00  mfu: 17.95%
[rank0]:2025-10-29 14:48:44,938 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1448_stage0_step1500.svg
[rank1]:2025-10-29 14:48:44,939 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1448_stage1_step1500.svg
[rank2]:2025-10-29 14:48:44,940 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1448_stage2_step1500.svg
[rank3]:2025-10-29 14:48:45,053 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1448_real_step1500_rank3.svg
[rank3]:> Batch Time: 375.98 ms, GPU Bubble Ratio: 32.53%, 30.74%, 64.34%, 27.07%
[rank3]:2025-10-29 14:48:45,124 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1448_stage3_step1500.svg
[rank3]:2025-10-29 14:48:45,477 - INFO - Avg. fwd time: 13.1307 / Avg. bwd time: 22.1962 / Avg. batch time: 342.3858 (ms) / GPU bubble ratio: 17.46%
[rank1]:2025-10-29 14:48:45,575 - INFO - Avg. fwd time: 9.9237 / Avg. bwd time: 18.7544 / Avg. batch time: 481.2304 (ms) / GPU bubble ratio: 52.33%
[rank2]:2025-10-29 14:48:45,527 - INFO - Avg. fwd time: 8.3816 / Avg. bwd time: 8.9848 / Avg. batch time: 438.3599 (ms) / GPU bubble ratio: 68.31%
[rank0]:2025-10-29 14:48:45,611 - INFO - Avg. fwd time: 8.6092 / Avg. bwd time: 13.4076 / Avg. batch time: 507.4810 (ms) / GPU bubble ratio: 65.29%
[rank0]:2025-10-29 14:50:34,951 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 14:50:37,025 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.2794  memory: 15.21GiB(32.01%)  tps: 7,144  tflops: 55.85  mfu: 17.90%
[rank2]:2025-10-29 14:50:37,008 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,144  tflops: 55.85  mfu: 17.90%
[rank0]:2025-10-29 14:50:37,038 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.2794  memory: 17.22GiB(36.24%)  tps: 7,144  tflops: 55.85  mfu: 17.90%
[rank3]:2025-10-29 14:50:39,608 - INFO -  step: 1550  loss:  4.4608  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,139  tflops: 55.81  mfu: 17.89%
[rank2]:2025-10-29 14:50:39,855 - INFO - Avg. fwd time: 8.3839 / Avg. bwd time: 8.9645 / Avg. batch time: 438.6181 (ms) / GPU bubble ratio: 68.36%
[rank3]:2025-10-29 14:50:39,818 - INFO - Avg. fwd time: 13.1334 / Avg. bwd time: 22.1615 / Avg. batch time: 342.1235 (ms) / GPU bubble ratio: 17.47%
[rank0]:2025-10-29 14:50:39,979 - INFO - Avg. fwd time: 8.5962 / Avg. bwd time: 13.7285 / Avg. batch time: 508.6027 (ms) / GPU bubble ratio: 64.88%
[rank1]:2025-10-29 14:50:39,971 - INFO - Avg. fwd time: 9.8959 / Avg. bwd time: 18.9648 / Avg. batch time: 482.0198 (ms) / GPU bubble ratio: 52.10%
[rank0]:2025-10-29 14:52:29,543 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 14:52:32,370 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1452_rank2_trend_line.svg
[rank2]:2025-10-29 14:52:32,426 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:52:32,381 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1452_rank3_trend_line.svg
[rank0]:2025-10-29 14:52:32,419 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1452_rank0_trend_line.svg
[rank0]:2025-10-29 14:52:32,426 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.25/0.25, [MB7] 1.00/1.00
[rank0]:2025-10-29 14:52:32,430 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2330  memory: 17.22GiB(36.24%)  tps: 7,099  tflops: 55.50  mfu: 17.79%
[rank0]:2025-10-29 14:52:32,430 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.2330  tps: 7,959  tflops: 62.22  mfu: 19.10%
[rank0]:2025-10-29 14:52:32,430 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 14:52:32,414 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_1452_rank1_trend_line.svg
[rank1]:2025-10-29 14:52:32,426 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 14:52:32,430 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2330  memory: 15.21GiB(32.01%)  tps: 7,098  tflops: 55.49  mfu: 17.79%
[rank1]:2025-10-29 14:52:32,431 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.2330  tps: 7,962  tflops: 62.24  mfu: 19.11%
[rank1]:2025-10-29 14:52:32,431 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 14:52:32,430 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 12.51GiB(26.33%)  tps: 7,097  tflops: 55.48  mfu: 17.78%
[rank2]:2025-10-29 14:52:32,430 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.0000  tps: 7,959  tflops: 62.22  mfu: 19.10%
[rank2]:2025-10-29 14:52:32,430 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 14:52:32,616 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1452_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 302.17 ms, GPU Bubble Ratio: 44.78%, 26.22%, 58.86%, 15.91%
[rank3]:2025-10-29 14:52:32,616 - INFO - 	> Batch Time: 302.17 ms (Average Freeze Ratio: 0.35)
[rank3]:2025-10-29 14:52:32,618 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 14:52:35,227 - INFO -  step: 1600  loss:  4.4310  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 7,085  tflops: 55.39  mfu: 17.75%
[rank3]:2025-10-29 14:52:35,228 - INFO -  final step: 1600  loss:  4.4310  grad_norm:  0.0000  tps: 7,913  tflops: 61.86  mfu: 18.99%
[rank3]:2025-10-29 14:52:35,228 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 14:52:54,230 - INFO - validate step: 1600  loss: -1.0000  memory: 17.22GiB(36.24%)  tps: 18,789
[rank0]:2025-10-29 14:52:54,231 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 14:52:54,233 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-29 14:52:54,249 - INFO - validate step: 1600  loss: -1.0000  memory: 15.21GiB(32.01%)  tps: 18,773
[rank1]:2025-10-29 14:52:54,250 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 14:52:54,252 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-29 14:52:54,266 - INFO - validate step: 1600  loss: -1.0000  memory: 12.51GiB(26.33%)  tps: 18,758
[rank2]:2025-10-29 14:52:54,266 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 14:52:54,268 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-29 14:52:54,274 - INFO - validate step: 1600  loss:  1.0962  memory: 31.41GiB(66.13%)  tps: 21,508
[rank3]:2025-10-29 14:52:54,276 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 14:52:54,281 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-29 14:52:56,891 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 14:52:56,983 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_1452_stage0_final1600.svg
[rank1]:2025-10-29 14:52:56,983 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_1452_stage1_final1600.svg
[rank2]:2025-10-29 14:52:56,982 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_1452_stage2_final1600.svg
[rank3]:2025-10-29 14:52:57,100 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1452_real_final1600_rank3.svg
[rank3]:> Batch Time: 379.27 ms, GPU Bubble Ratio: 32.82%, 30.22%, 64.65%, 27.70%
[rank0]:2025-10-29 14:52:57,200 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_1452_rank0_stage0.svg
[rank0]:	> Counts Sum: 1647360, Total Sum: 1811520 (90.94%), Ratio(%) per element: [90.6, 91.01, 91.17, 91.01, 90.93, 90.35, 90.84, 91.58, 91.33, 90.84, 91.33, 90.76, 91.25, 91.17, 90.19, 91.17, 91.01, 90.68, 91.17, 90.93, 91.25, 90.44, 91.01, 91.09, 90.84, 90.68, 91.09, 90.76, 91.01, 91.01, 91.01, 90.27, 91.58, 90.6, 90.35, 91.42, 90.76]
[rank0]:2025-10-29 14:52:57,200 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 14:52:57,191 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_1452_rank1_stage1.svg
[rank1]:	> Counts Sum: 1992080, Total Sum: 2203200 (90.42%), Ratio(%) per element: [90.11, 90.11, 89.95, 90.44, 90.19, 90.76, 90.6, 90.76, 90.68, 90.44, 90.76, 90.11, 90.19, 90.6, 90.52, 90.68, 90.6, 90.52, 89.95, 90.27, 89.95, 90.44, 90.52, 89.95, 90.44, 90.11, 90.27, 90.19, 90.44, 90.6, 90.84, 90.35, 90.68, 90.44, 90.11, 90.11, 90.44, 90.6, 90.93, 90.6, 90.68, 90.52, 90.6, 90.27, 90.27]
[rank1]:2025-10-29 14:52:57,192 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 14:52:57,199 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_1452_rank2_stage2.svg
[rank2]:	> Counts Sum: 1527360, Total Sum: 1762560 (86.66%), Ratio(%) per element: [86.6, 86.76, 86.76, 86.51, 86.51, 86.51, 86.84, 86.68, 86.51, 86.68, 86.84, 86.68, 86.6, 86.84, 86.35, 86.76, 86.51, 86.68, 86.68, 86.6, 86.6, 86.6, 86.43, 86.76, 86.76, 86.68, 86.43, 86.51, 86.68, 86.92, 86.84, 86.51, 86.76, 86.6, 86.6, 86.84]
[rank2]:2025-10-29 14:52:57,199 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 14:52:57,284 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_1452_thry_final1600_rank3.svg
[rank3]:> Batch Time: 324.45 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 14:52:57,356 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_1452_stage3_final1600.svg
[rank1]:2025-10-29 14:52:57,519 - INFO - Process group destroyed
[rank2]:2025-10-29 14:52:57,526 - INFO - Process group destroyed
[rank3]:2025-10-29 14:52:57,539 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_1452_rank3_stage3.svg
[rank3]:	> Counts Sum: 34880, Total Sum: 1419840 (2.46%), Ratio(%) per element: [2.45, 2.77, 2.36, 2.36, 2.45, 2.69, 2.53, 2.94, 3.26, 2.85, 2.45, 1.87, 2.61, 2.94, 2.61, 2.28, 2.28, 3.02, 3.34, 2.36, 2.45, 2.53, 2.2, 2.53, 2.04, 2.53, 2.28, 2.12, 0.0]
[rank3]:2025-10-29 14:52:57,540 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–ˆâ–ƒâ–‚â–‚â–‚â–â–â–‚â–ƒâ–‚â–‚â–‚â–‚â–â–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ˆâ–ƒâ–‚â–‚â–‚â–â–â–‚â–ƒâ–‚â–‚â–‚â–‚â–â–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.07054
[rank3]:wandb:               final/avg_loss 4.43103
[rank3]:wandb:             final/avg_mfu(%) 18.99332
[rank3]:wandb:             final/avg_tflops 61.85959
[rank3]:wandb:    final/avg_throughput(tps) 7912.92256
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 4.43103
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 4.43103
[rank3]:wandb: loss_metrics/global_max_loss 4.43103
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/8euq9798
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1028_GPipe_timelyapf_dm1/20251029-1353/wandb/run-20251029_135322-8euq9798/logs
[rank0]:2025-10-29 14:52:59,201 - INFO - Training completed
[rank0]:2025-10-29 14:52:59,201 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 14:52:59,267 - INFO - Process group destroyed
[rank0]:2025-10-29 14:52:59,664 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.9', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.3', 'layers.2', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.4', 'layers.7', 'layers.5', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.15', 'output', 'layers.14', 'layers.13'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1028_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1028_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1028_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1028_GPipe_timelyapf_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1028_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
