
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 29. (ìˆ˜) 04:00:23 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/1028_1F1B_nofreeze.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with nofreeze x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-29 04:00:29,253 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-29 04:00:29,253 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 04:00:29,360 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 04:00:29,442 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 04:00:29,855 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 04:00:29,857 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 04:00:29,861 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-29 04:00:29,859 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 04:00:29,861 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 04:00:29,875 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 04:00:29,878 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 04:00:29,834 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 04:00:29,836 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 04:00:30,315 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 04:00:30,719 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 04:00:33,501 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 04:00:33,492 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 04:00:33,533 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 04:00:33,534 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-29 04:00:33,580 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank0]:2025-10-29 04:00:33,649 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 04:00:33,582 - INFO - Compiling each TransformerBlock with torch.compile
[rank2]:2025-10-29 04:00:33,582 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-29 04:00:33,655 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-29 04:00:33,693 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 04:00:33,694 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 04:00:33,695 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 04:00:33,741 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 04:00:33,743 - INFO - Compiling each TransformerBlock with torch.compile
[rank0]:2025-10-29 04:00:33,743 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-29 04:00:33,757 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 04:00:33,757 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 04:00:33,758 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-29 04:00:33,699 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 04:00:33,701 - INFO - Compiling the loss function with torch.compile
[rank1]:2025-10-29 04:00:33,747 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 04:00:33,749 - INFO - Compiling each TransformerBlock with torch.compile
[rank1]:2025-10-29 04:00:33,749 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-29 04:00:33,935 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 04:00:33,936 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 04:00:33,936 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-29 04:00:33,937 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 04:00:33,937 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 04:00:33,938 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run yhfema0e
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1028_1F1B_nofreeze_dm1/20251029-0400/wandb/run-20251029_040034-yhfema0e
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/yhfema0e
[rank3]:2025-10-29 04:00:35,785 - INFO - WandB logging enabled
[rank3]:2025-10-29 04:00:35,786 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 04:00:35,827 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 04:00:35,829 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-29 04:00:35,879 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 04:00:35,880 - INFO - Compiling each TransformerBlock with torch.compile
[rank3]:2025-10-29 04:00:35,881 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-29 04:00:36,109 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 04:00:36,110 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-29 04:00:36,109 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 04:00:36,110 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 04:00:36,110 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1028_1F1B_nofreeze_dm1
[rank0]:2025-10-29 04:00:36,110 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 04:00:36,110 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 04:00:36,114 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-29 04:00:36,093 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 04:00:36,094 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 04:00:36,095 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 04:00:36,109 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 04:00:36,110 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 04:00:40,753 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1600 (warmup 100)
[rank0]:2025-10-29 04:00:40,754 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 04:00:43,462 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 04:00:43,462 - INFO - Finished loading the checkpoint in 2.71 seconds.
[rank0]:2025-10-29 04:00:43,462 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank0]:  warnings.warn(
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank1]:  warnings.warn(
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank2]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 04:00:56,692 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4633  memory:  4.61GiB(9.71%)  tps: 707  tflops: 5.53  mfu: 1.77%
[rank2]:2025-10-29 04:00:56,692 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 04:00:56,702 - INFO -  step:  1  loss:  9.8292  grad_norm: 53.4633  memory: 12.99GiB(27.34%)  tps: 785  tflops: 6.14  mfu: 1.97%
[rank3]:2025-10-29 04:00:56,703 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 04:00:56,698 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4633  memory:  6.98GiB(14.69%)  tps: 712  tflops: 5.57  mfu: 1.79%
[rank1]:2025-10-29 04:00:56,698 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 04:00:56,732 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4633  memory:  9.52GiB(20.03%)  tps: 711  tflops: 5.56  mfu: 1.78%
[rank0]:2025-10-29 04:00:56,732 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 04:01:12,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,097 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,098 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,098 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,098 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,099 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,099 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,099 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,100 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,100 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,100 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,101 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,101 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,101 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,101 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:01:12,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:01:12,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,152 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:01:12,153 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:01:12,181 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:02:44,395 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:02:46,629 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.6146  memory:  9.26GiB(19.50%)  tps: 7,303  tflops: 57.09  mfu: 18.30%
[rank2]:2025-10-29 04:02:46,625 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.6146  memory:  6.43GiB(13.53%)  tps: 7,303  tflops: 57.09  mfu: 18.30%
[rank3]:2025-10-29 04:02:46,638 - INFO -  step: 50  loss:  9.4394  grad_norm: 21.6146  memory: 16.43GiB(34.58%)  tps: 7,303  tflops: 57.09  mfu: 18.30%
[rank0]:2025-10-29 04:02:46,640 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.6146  memory: 13.29GiB(27.97%)  tps: 7,304  tflops: 57.10  mfu: 18.30%
[rank2]:2025-10-29 04:02:46,942 - INFO - Avg. fwd time: 8.2397 / Avg. bwd time: 18.5427 / Avg. batch time: 470.4705 (ms) / GPU bubble ratio: 54.46%
[rank3]:2025-10-29 04:02:46,885 - INFO - Avg. fwd time: 13.8125 / Avg. bwd time: 36.5287 / Avg. batch time: 440.0093 (ms) / GPU bubble ratio: 8.47%
[rank0]:2025-10-29 04:02:46,946 - INFO - Avg. fwd time: 8.6797 / Avg. bwd time: 23.9475 / Avg. batch time: 543.5136 (ms) / GPU bubble ratio: 51.98%
[rank1]:2025-10-29 04:02:46,974 - INFO - Avg. fwd time: 10.4812 / Avg. bwd time: 23.8261 / Avg. batch time: 507.6513 (ms) / GPU bubble ratio: 45.94%
[rank0]:2025-10-29 04:04:35,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:04:37,456 - INFO -  step: 100  loss: -4.0000  grad_norm: 37.4180  memory:  9.26GiB(19.50%)  tps: 7,392  tflops: 57.79  mfu: 18.52%
[rank0]:2025-10-29 04:04:37,467 - INFO -  step: 100  loss: -4.0000  grad_norm: 37.4180  memory: 13.29GiB(27.97%)  tps: 7,392  tflops: 57.79  mfu: 18.52%
[rank3]:2025-10-29 04:04:37,465 - INFO -  step: 100  loss:  6.9248  grad_norm: 37.4180  memory: 16.43GiB(34.58%)  tps: 7,392  tflops: 57.79  mfu: 18.52%
[rank2]:2025-10-29 04:04:37,452 - INFO -  step: 100  loss: -4.0000  grad_norm: 37.4180  memory:  6.43GiB(13.53%)  tps: 7,392  tflops: 57.79  mfu: 18.52%
[rank3]:2025-10-29 04:04:37,663 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0404_real_step100_rank3.svg
[rank3]:> Batch Time: 499.13 ms, GPU Bubble Ratio: 47.93%, 45.20%, 57.46%, 18.65%
[rank3]:2025-10-29 04:04:37,880 - INFO - Avg. fwd time: 13.7800 / Avg. bwd time: 36.5748 / Avg. batch time: 436.6513 (ms) / GPU bubble ratio: 7.74%
[rank1]:2025-10-29 04:04:37,973 - INFO - Avg. fwd time: 10.2669 / Avg. bwd time: 23.9849 / Avg. batch time: 504.0726 (ms) / GPU bubble ratio: 45.64%
[rank0]:2025-10-29 04:04:37,942 - INFO - Avg. fwd time: 8.4456 / Avg. bwd time: 24.0446 / Avg. batch time: 540.0207 (ms) / GPU bubble ratio: 51.87%
[rank2]:2025-10-29 04:04:37,941 - INFO - Avg. fwd time: 7.9831 / Avg. bwd time: 18.6513 / Avg. batch time: 466.7999 (ms) / GPU bubble ratio: 54.35%
[rank0]:2025-10-29 04:06:26,585 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:06:28,735 - INFO -  step: 150  loss: -4.0000  grad_norm: 55.6253  memory:  9.26GiB(19.50%)  tps: 7,362  tflops: 57.55  mfu: 18.45%
[rank2]:2025-10-29 04:06:28,732 - INFO -  step: 150  loss: -4.0000  grad_norm: 55.6253  memory:  6.43GiB(13.53%)  tps: 7,362  tflops: 57.55  mfu: 18.45%
[rank0]:2025-10-29 04:06:28,746 - INFO -  step: 150  loss: -4.0000  grad_norm: 55.6253  memory: 13.29GiB(27.97%)  tps: 7,362  tflops: 57.55  mfu: 18.45%
[rank3]:2025-10-29 04:06:28,744 - INFO -  step: 150  loss:  1.2693  grad_norm: 55.6253  memory: 16.43GiB(34.58%)  tps: 7,362  tflops: 57.55  mfu: 18.45%
[rank3]:2025-10-29 04:06:29,208 - INFO - Avg. fwd time: 13.7830 / Avg. bwd time: 36.5977 / Avg. batch time: 435.7888 (ms) / GPU bubble ratio: 7.51%
[rank2]:2025-10-29 04:06:29,232 - INFO - Avg. fwd time: 7.8957 / Avg. bwd time: 18.6731 / Avg. batch time: 466.1042 (ms) / GPU bubble ratio: 54.40%
[rank0]:2025-10-29 04:06:29,290 - INFO - Avg. fwd time: 8.3713 / Avg. bwd time: 24.0663 / Avg. batch time: 539.3581 (ms) / GPU bubble ratio: 51.89%
[rank1]:2025-10-29 04:06:29,261 - INFO - Avg. fwd time: 10.1895 / Avg. bwd time: 24.0190 / Avg. batch time: 503.3907 (ms) / GPU bubble ratio: 45.64%
[rank0]:2025-10-29 04:08:18,009 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:08:20,264 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.9191  memory:  9.26GiB(19.50%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank1]:2025-10-29 04:08:20,264 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 04:08:20,272 - INFO -  step: 200  loss:  0.1581  grad_norm:  0.9191  memory: 16.43GiB(34.58%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank3]:2025-10-29 04:08:20,273 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 04:08:20,275 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.9191  memory: 13.29GiB(27.97%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank0]:2025-10-29 04:08:20,275 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 04:08:20,260 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.9191  memory:  6.43GiB(13.53%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank2]:2025-10-29 04:08:20,260 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 04:08:37,936 - INFO - validate step: 200  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 23,179
[rank3]:2025-10-29 04:08:37,955 - INFO - validate step: 200  loss:  0.3050  memory: 16.43GiB(34.58%)  tps: 23,166
[rank0]:2025-10-29 04:08:37,922 - INFO - validate step: 200  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 23,211
[rank2]:2025-10-29 04:08:37,948 - INFO - validate step: 200  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 23,158
[rank3]:2025-10-29 04:08:38,137 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0408_real_step200_rank3.svg
[rank3]:> Batch Time: 499.80 ms, GPU Bubble Ratio: 47.92%, 45.21%, 57.51%, 18.64%
[rank3]:2025-10-29 04:08:38,356 - INFO - Avg. fwd time: 13.8131 / Avg. bwd time: 36.6448 / Avg. batch time: 435.9368 (ms) / GPU bubble ratio: 7.40%
[rank2]:2025-10-29 04:08:38,416 - INFO - Avg. fwd time: 7.8603 / Avg. bwd time: 18.6883 / Avg. batch time: 466.1468 (ms) / GPU bubble ratio: 54.44%
[rank1]:2025-10-29 04:08:38,448 - INFO - Avg. fwd time: 10.1624 / Avg. bwd time: 24.0440 / Avg. batch time: 503.4545 (ms) / GPU bubble ratio: 45.65%
[rank0]:2025-10-29 04:08:38,418 - INFO - Avg. fwd time: 8.3442 / Avg. bwd time: 24.0855 / Avg. batch time: 539.4413 (ms) / GPU bubble ratio: 51.91%
[rank0]:2025-10-29 04:10:26,917 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 04:10:29,165 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1912  memory:  6.43GiB(13.53%)  tps: 7,366  tflops: 57.58  mfu: 18.46%
[rank1]:2025-10-29 04:10:29,169 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1912  memory:  9.26GiB(19.50%)  tps: 7,365  tflops: 57.57  mfu: 18.45%
[rank3]:2025-10-29 04:10:29,177 - INFO -  step: 250  loss:  0.1053  grad_norm:  0.1912  memory: 16.43GiB(34.58%)  tps: 7,366  tflops: 57.58  mfu: 18.46%
[rank0]:2025-10-29 04:10:29,180 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1912  memory: 13.29GiB(27.97%)  tps: 7,363  tflops: 57.56  mfu: 18.45%
[rank3]:2025-10-29 04:10:29,433 - INFO - Avg. fwd time: 13.8111 / Avg. bwd time: 36.6247 / Avg. batch time: 435.4552 (ms) / GPU bubble ratio: 7.34%
[rank1]:2025-10-29 04:10:29,528 - INFO - Avg. fwd time: 10.1351 / Avg. bwd time: 24.0634 / Avg. batch time: 503.0513 (ms) / GPU bubble ratio: 45.61%
[rank0]:2025-10-29 04:10:29,495 - INFO - Avg. fwd time: 8.3201 / Avg. bwd time: 24.0995 / Avg. batch time: 539.0563 (ms) / GPU bubble ratio: 51.89%
[rank2]:2025-10-29 04:10:29,495 - INFO - Avg. fwd time: 7.8309 / Avg. bwd time: 18.7020 / Avg. batch time: 465.7394 (ms) / GPU bubble ratio: 54.42%
[rank0]:2025-10-29 04:12:18,645 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:12:20,902 - INFO -  step: 300  loss:  0.1118  grad_norm:  0.1297  memory: 16.43GiB(34.58%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank1]:2025-10-29 04:12:20,893 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1297  memory:  9.26GiB(19.50%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank2]:2025-10-29 04:12:20,890 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1297  memory:  6.43GiB(13.53%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank0]:2025-10-29 04:12:20,904 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1297  memory: 13.29GiB(27.97%)  tps: 7,332  tflops: 57.32  mfu: 18.37%
[rank3]:2025-10-29 04:12:21,088 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0412_real_step300_rank3.svg
[rank3]:> Batch Time: 499.85 ms, GPU Bubble Ratio: 47.89%, 45.18%, 57.49%, 18.65%
[rank3]:2025-10-29 04:12:21,533 - INFO - Avg. fwd time: 13.8405 / Avg. bwd time: 36.6609 / Avg. batch time: 435.7641 (ms) / GPU bubble ratio: 7.29%
[rank1]:2025-10-29 04:12:21,588 - INFO - Avg. fwd time: 10.1197 / Avg. bwd time: 24.0770 / Avg. batch time: 503.4238 (ms) / GPU bubble ratio: 45.66%
[rank2]:2025-10-29 04:12:21,558 - INFO - Avg. fwd time: 7.8137 / Avg. bwd time: 18.7105 / Avg. batch time: 466.1003 (ms) / GPU bubble ratio: 54.47%
[rank0]:2025-10-29 04:12:21,617 - INFO - Avg. fwd time: 8.3069 / Avg. bwd time: 24.1092 / Avg. batch time: 539.4437 (ms) / GPU bubble ratio: 51.93%
[rank0]:2025-10-29 04:14:09,665 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:14:11,943 - INFO -  step: 350  loss:  0.1113  grad_norm:  0.1993  memory: 16.43GiB(34.58%)  tps: 7,378  tflops: 57.67  mfu: 18.49%
[rank1]:2025-10-29 04:14:11,934 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1993  memory:  9.26GiB(19.50%)  tps: 7,377  tflops: 57.67  mfu: 18.49%
[rank2]:2025-10-29 04:14:11,931 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1993  memory:  6.43GiB(13.53%)  tps: 7,377  tflops: 57.67  mfu: 18.49%
[rank0]:2025-10-29 04:14:11,946 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1993  memory: 13.29GiB(27.97%)  tps: 7,377  tflops: 57.67  mfu: 18.48%
[rank3]:2025-10-29 04:14:12,198 - INFO - Avg. fwd time: 13.8268 / Avg. bwd time: 36.6319 / Avg. batch time: 435.3174 (ms) / GPU bubble ratio: 7.27%
[rank2]:2025-10-29 04:14:12,258 - INFO - Avg. fwd time: 7.8034 / Avg. bwd time: 18.7154 / Avg. batch time: 465.5923 (ms) / GPU bubble ratio: 54.43%
[rank0]:2025-10-29 04:14:12,261 - INFO - Avg. fwd time: 8.2984 / Avg. bwd time: 24.1164 / Avg. batch time: 538.9463 (ms) / GPU bubble ratio: 51.88%
[rank1]:2025-10-29 04:14:12,291 - INFO - Avg. fwd time: 10.1114 / Avg. bwd time: 24.0862 / Avg. batch time: 502.9207 (ms) / GPU bubble ratio: 45.60%
[rank0]:2025-10-29 04:16:00,639 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:16:02,895 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2263  memory:  9.26GiB(19.50%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank1]:2025-10-29 04:16:02,895 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 04:16:02,891 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2263  memory:  6.43GiB(13.53%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank2]:2025-10-29 04:16:02,892 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 04:16:02,906 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2263  memory: 13.29GiB(27.97%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank0]:2025-10-29 04:16:02,906 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 04:16:02,903 - INFO -  step: 400  loss:  0.1076  grad_norm:  0.2263  memory: 16.43GiB(34.58%)  tps: 7,383  tflops: 57.72  mfu: 18.50%
[rank3]:2025-10-29 04:16:02,904 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 04:16:18,072 - INFO - validate step: 400  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,009
[rank3]:2025-10-29 04:16:18,105 - INFO - validate step: 400  loss:  0.2967  memory: 16.43GiB(34.58%)  tps: 26,948
[rank1]:2025-10-29 04:16:18,086 - INFO - validate step: 400  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 26,963
[rank2]:2025-10-29 04:16:18,099 - INFO - validate step: 400  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,936
[rank3]:2025-10-29 04:16:18,296 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0416_real_step400_rank3.svg
[rank3]:> Batch Time: 499.29 ms, GPU Bubble Ratio: 47.79%, 45.08%, 57.43%, 18.68%
[rank0]:2025-10-29 04:16:18,587 - INFO - Avg. fwd time: 8.2928 / Avg. bwd time: 24.1253 / Avg. batch time: 538.6931 (ms) / GPU bubble ratio: 51.86%
[rank3]:2025-10-29 04:16:18,526 - INFO - Avg. fwd time: 13.8167 / Avg. bwd time: 36.6262 / Avg. batch time: 435.0991 (ms) / GPU bubble ratio: 7.25%
[rank1]:2025-10-29 04:16:18,616 - INFO - Avg. fwd time: 10.1061 / Avg. bwd time: 24.0977 / Avg. batch time: 502.6592 (ms) / GPU bubble ratio: 45.56%
[rank2]:2025-10-29 04:16:18,583 - INFO - Avg. fwd time: 7.7957 / Avg. bwd time: 18.7220 / Avg. batch time: 465.3218 (ms) / GPU bubble ratio: 54.41%
[rank0]:2025-10-29 04:18:07,449 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:18:09,672 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2292  memory:  9.26GiB(19.50%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank2]:2025-10-29 04:18:09,668 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2292  memory:  6.43GiB(13.53%)  tps: 7,343  tflops: 57.40  mfu: 18.40%
[rank0]:2025-10-29 04:18:09,683 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2292  memory: 13.29GiB(27.97%)  tps: 7,340  tflops: 57.38  mfu: 18.39%
[rank3]:2025-10-29 04:18:09,681 - INFO -  step: 450  loss:  0.1217  grad_norm:  0.2292  memory: 16.43GiB(34.58%)  tps: 7,342  tflops: 57.40  mfu: 18.40%
[rank3]:2025-10-29 04:18:10,155 - INFO - Avg. fwd time: 13.8171 / Avg. bwd time: 36.6371 / Avg. batch time: 435.1153 (ms) / GPU bubble ratio: 7.24%
[rank2]:2025-10-29 04:18:10,181 - INFO - Avg. fwd time: 7.7906 / Avg. bwd time: 18.7289 / Avg. batch time: 465.3900 (ms) / GPU bubble ratio: 54.41%
[rank0]:2025-10-29 04:18:10,243 - INFO - Avg. fwd time: 8.2895 / Avg. bwd time: 24.1323 / Avg. batch time: 538.7890 (ms) / GPU bubble ratio: 51.86%
[rank1]:2025-10-29 04:18:10,212 - INFO - Avg. fwd time: 10.1035 / Avg. bwd time: 24.1084 / Avg. batch time: 502.7390 (ms) / GPU bubble ratio: 45.56%
[rank0]:2025-10-29 04:19:57,994 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:20:00,182 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3873  memory: 13.29GiB(27.97%)  tps: 7,414  tflops: 57.96  mfu: 18.58%
[rank3]:2025-10-29 04:20:00,189 - INFO -  step: 500  loss:  0.1003  grad_norm:  0.3873  memory: 16.43GiB(34.58%)  tps: 7,413  tflops: 57.95  mfu: 18.57%
[rank1]:2025-10-29 04:20:00,171 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3873  memory:  9.26GiB(19.50%)  tps: 7,414  tflops: 57.96  mfu: 18.58%
[rank2]:2025-10-29 04:20:00,167 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3873  memory:  6.43GiB(13.53%)  tps: 7,414  tflops: 57.96  mfu: 18.58%
[rank3]:2025-10-29 04:20:00,375 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0420_real_step500_rank3.svg
[rank3]:> Batch Time: 499.14 ms, GPU Bubble Ratio: 47.77%, 45.03%, 57.39%, 18.69%
[rank3]:2025-10-29 04:20:00,599 - INFO - Avg. fwd time: 13.8012 / Avg. bwd time: 36.6110 / Avg. batch time: 434.7345 (ms) / GPU bubble ratio: 7.23%
[rank2]:2025-10-29 04:20:00,658 - INFO - Avg. fwd time: 7.7857 / Avg. bwd time: 18.7323 / Avg. batch time: 464.9712 (ms) / GPU bubble ratio: 54.37%
[rank0]:2025-10-29 04:20:00,661 - INFO - Avg. fwd time: 8.2851 / Avg. bwd time: 24.1367 / Avg. batch time: 538.3721 (ms) / GPU bubble ratio: 51.82%
[rank1]:2025-10-29 04:20:00,691 - INFO - Avg. fwd time: 10.0994 / Avg. bwd time: 24.1143 / Avg. batch time: 502.3204 (ms) / GPU bubble ratio: 45.51%
[rank0]:2025-10-29 04:21:49,097 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:21:51,352 - INFO -  step: 550  loss:  0.1120  grad_norm:  0.1241  memory: 16.43GiB(34.58%)  tps: 7,369  tflops: 57.61  mfu: 18.47%
[rank1]:2025-10-29 04:21:51,344 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1241  memory:  9.26GiB(19.50%)  tps: 7,369  tflops: 57.61  mfu: 18.46%
[rank2]:2025-10-29 04:21:51,340 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1241  memory:  6.43GiB(13.53%)  tps: 7,369  tflops: 57.61  mfu: 18.46%
[rank0]:2025-10-29 04:21:51,355 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1241  memory: 13.29GiB(27.97%)  tps: 7,369  tflops: 57.61  mfu: 18.46%
[rank3]:2025-10-29 04:21:51,599 - INFO - Avg. fwd time: 13.7976 / Avg. bwd time: 36.6017 / Avg. batch time: 434.5727 (ms) / GPU bubble ratio: 7.22%
[rank2]:2025-10-29 04:21:51,658 - INFO - Avg. fwd time: 7.7801 / Avg. bwd time: 18.7333 / Avg. batch time: 464.8413 (ms) / GPU bubble ratio: 54.37%
[rank0]:2025-10-29 04:21:51,661 - INFO - Avg. fwd time: 8.2807 / Avg. bwd time: 24.1380 / Avg. batch time: 538.2471 (ms) / GPU bubble ratio: 51.82%
[rank1]:2025-10-29 04:21:51,691 - INFO - Avg. fwd time: 10.0943 / Avg. bwd time: 24.1167 / Avg. batch time: 502.1916 (ms) / GPU bubble ratio: 45.50%
[rank0]:2025-10-29 04:23:41,847 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:23:44,104 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1540  memory:  9.26GiB(19.50%)  tps: 7,265  tflops: 56.79  mfu: 18.20%
[rank1]:2025-10-29 04:23:44,104 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 04:23:44,112 - INFO -  step: 600  loss:  0.1219  grad_norm:  0.1540  memory: 16.43GiB(34.58%)  tps: 7,265  tflops: 56.80  mfu: 18.20%
[rank3]:2025-10-29 04:23:44,113 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 04:23:44,100 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1540  memory:  6.43GiB(13.53%)  tps: 7,265  tflops: 56.79  mfu: 18.20%
[rank2]:2025-10-29 04:23:44,101 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 04:23:44,115 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1540  memory: 13.29GiB(27.97%)  tps: 7,265  tflops: 56.79  mfu: 18.20%
[rank0]:2025-10-29 04:23:44,115 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 04:23:59,435 - INFO - validate step: 600  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 26,737
[rank1]:2025-10-29 04:23:59,445 - INFO - validate step: 600  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 26,701
[rank3]:2025-10-29 04:23:59,462 - INFO - validate step: 600  loss:  0.2986  memory: 16.43GiB(34.58%)  tps: 26,687
[rank2]:2025-10-29 04:23:59,457 - INFO - validate step: 600  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,673
[rank3]:2025-10-29 04:23:59,647 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0423_real_step600_rank3.svg
[rank3]:> Batch Time: 499.79 ms, GPU Bubble Ratio: 47.83%, 45.11%, 57.46%, 18.67%
[rank3]:2025-10-29 04:24:00,101 - INFO - Avg. fwd time: 13.8331 / Avg. bwd time: 36.6556 / Avg. batch time: 435.2188 (ms) / GPU bubble ratio: 7.19%
[rank2]:2025-10-29 04:24:00,128 - INFO - Avg. fwd time: 7.7755 / Avg. bwd time: 18.7342 / Avg. batch time: 465.5166 (ms) / GPU bubble ratio: 54.44%
[rank1]:2025-10-29 04:24:00,160 - INFO - Avg. fwd time: 10.0899 / Avg. bwd time: 24.1194 / Avg. batch time: 502.8702 (ms) / GPU bubble ratio: 45.58%
[rank0]:2025-10-29 04:24:00,192 - INFO - Avg. fwd time: 8.2769 / Avg. bwd time: 24.1395 / Avg. batch time: 538.9292 (ms) / GPU bubble ratio: 51.88%
[rank0]:2025-10-29 04:25:49,259 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 04:25:51,528 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1897  memory: 13.29GiB(27.97%)  tps: 7,308  tflops: 57.13  mfu: 18.31%
[rank1]:2025-10-29 04:25:51,518 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1897  memory:  9.26GiB(19.50%)  tps: 7,310  tflops: 57.14  mfu: 18.31%
[rank2]:2025-10-29 04:25:51,513 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1897  memory:  6.43GiB(13.53%)  tps: 7,311  tflops: 57.15  mfu: 18.32%
[rank3]:2025-10-29 04:25:51,525 - INFO -  step: 650  loss:  0.1511  grad_norm:  0.1897  memory: 16.43GiB(34.58%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank3]:2025-10-29 04:25:51,786 - INFO - Avg. fwd time: 13.8412 / Avg. bwd time: 36.6723 / Avg. batch time: 435.3712 (ms) / GPU bubble ratio: 7.18%
[rank2]:2025-10-29 04:25:51,846 - INFO - Avg. fwd time: 7.7730 / Avg. bwd time: 18.7360 / Avg. batch time: 465.6399 (ms) / GPU bubble ratio: 54.46%
[rank0]:2025-10-29 04:25:51,848 - INFO - Avg. fwd time: 8.2746 / Avg. bwd time: 24.1400 / Avg. batch time: 539.0620 (ms) / GPU bubble ratio: 51.89%
[rank1]:2025-10-29 04:25:51,879 - INFO - Avg. fwd time: 10.0875 / Avg. bwd time: 24.1224 / Avg. batch time: 502.9982 (ms) / GPU bubble ratio: 45.59%
[rank0]:2025-10-29 04:27:41,218 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:27:43,488 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1599  memory: 13.29GiB(27.97%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank1]:2025-10-29 04:27:43,477 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1599  memory:  9.26GiB(19.50%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank2]:2025-10-29 04:27:43,474 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1599  memory:  6.43GiB(13.53%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank3]:2025-10-29 04:27:43,486 - INFO -  step: 700  loss:  0.1140  grad_norm:  0.1599  memory: 16.43GiB(34.58%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank3]:2025-10-29 04:27:43,677 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0427_real_step700_rank3.svg
[rank3]:> Batch Time: 500.21 ms, GPU Bubble Ratio: 47.88%, 45.15%, 57.49%, 18.65%
[rank3]:2025-10-29 04:27:43,905 - INFO - Avg. fwd time: 13.8513 / Avg. bwd time: 36.6916 / Avg. batch time: 435.5653 (ms) / GPU bubble ratio: 7.17%
[rank0]:2025-10-29 04:27:43,966 - INFO - Avg. fwd time: 8.2715 / Avg. bwd time: 24.1406 / Avg. batch time: 539.2297 (ms) / GPU bubble ratio: 51.91%
[rank1]:2025-10-29 04:27:43,997 - INFO - Avg. fwd time: 10.0849 / Avg. bwd time: 24.1250 / Avg. batch time: 503.1648 (ms) / GPU bubble ratio: 45.61%
[rank2]:2025-10-29 04:27:43,964 - INFO - Avg. fwd time: 7.7698 / Avg. bwd time: 18.7372 / Avg. batch time: 465.8043 (ms) / GPU bubble ratio: 54.48%
[rank0]:2025-10-29 04:29:32,883 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:29:35,159 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1958  memory:  6.43GiB(13.53%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank3]:2025-10-29 04:29:35,171 - INFO -  step: 750  loss:  0.1154  grad_norm:  0.1958  memory: 16.43GiB(34.58%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank0]:2025-10-29 04:29:35,173 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1958  memory: 13.29GiB(27.97%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank1]:2025-10-29 04:29:35,162 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1958  memory:  9.26GiB(19.50%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank3]:2025-10-29 04:29:35,670 - INFO - Avg. fwd time: 13.8533 / Avg. bwd time: 36.6997 / Avg. batch time: 435.6131 (ms) / GPU bubble ratio: 7.16%
[rank1]:2025-10-29 04:29:35,729 - INFO - Avg. fwd time: 10.0832 / Avg. bwd time: 24.1280 / Avg. batch time: 503.2452 (ms) / GPU bubble ratio: 45.62%
[rank2]:2025-10-29 04:29:35,697 - INFO - Avg. fwd time: 7.7676 / Avg. bwd time: 18.7395 / Avg. batch time: 465.8805 (ms) / GPU bubble ratio: 54.48%
[rank0]:2025-10-29 04:29:35,762 - INFO - Avg. fwd time: 8.2695 / Avg. bwd time: 24.1418 / Avg. batch time: 539.3129 (ms) / GPU bubble ratio: 51.92%
[rank0]:2025-10-29 04:31:25,452 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:31:27,703 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2026  memory:  6.43GiB(13.53%)  tps: 7,279  tflops: 56.90  mfu: 18.24%
[rank2]:2025-10-29 04:31:27,703 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 04:31:27,733 - INFO -  step: 800  loss:  0.1084  grad_norm:  0.2026  memory: 16.43GiB(34.58%)  tps: 7,278  tflops: 56.89  mfu: 18.24%
[rank3]:2025-10-29 04:31:27,734 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:31:27,706 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2026  memory:  9.26GiB(19.50%)  tps: 7,279  tflops: 56.90  mfu: 18.24%
[rank1]:2025-10-29 04:31:27,707 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 04:31:27,718 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2026  memory: 13.29GiB(27.97%)  tps: 7,279  tflops: 56.90  mfu: 18.24%
[rank0]:2025-10-29 04:31:27,718 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:31:42,958 - INFO - validate step: 800  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 26,857
[rank1]:2025-10-29 04:31:42,958 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:31:42,945 - INFO - validate step: 800  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 26,899
[rank0]:2025-10-29 04:31:42,946 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:31:42,952 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 04:31:42,972 - INFO - validate step: 800  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,827
[rank2]:2025-10-29 04:31:42,972 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:31:42,976 - INFO - validate step: 800  loss:  0.2941  memory: 16.43GiB(34.58%)  tps: 26,874
[rank3]:2025-10-29 04:31:42,977 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:31:44,814 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.84 seconds.
[rank1]:2025-10-29 04:31:45,357 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.40 seconds.
[rank0]:2025-10-29 04:31:46,653 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 04:31:46,654 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.71 seconds.
[rank3]:2025-10-29 04:31:46,702 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.73 seconds.
[rank3]:2025-10-29 04:31:46,917 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0431_real_step800_rank3.svg
[rank3]:> Batch Time: 500.68 ms, GPU Bubble Ratio: 47.92%, 45.20%, 57.53%, 18.64%
[rank3]:2025-10-29 04:31:47,867 - INFO - Avg. fwd time: 13.8676 / Avg. bwd time: 36.7259 / Avg. batch time: 435.9023 (ms) / GPU bubble ratio: 7.15%
[rank0]:2025-10-29 04:31:47,897 - INFO - Avg. fwd time: 8.2681 / Avg. bwd time: 24.1438 / Avg. batch time: 539.5842 (ms) / GPU bubble ratio: 51.95%
[rank2]:2025-10-29 04:31:47,897 - INFO - Avg. fwd time: 7.7657 / Avg. bwd time: 18.7410 / Avg. batch time: 466.1482 (ms) / GPU bubble ratio: 54.51%
[rank1]:2025-10-29 04:31:47,929 - INFO - Avg. fwd time: 10.0818 / Avg. bwd time: 24.1300 / Avg. batch time: 503.5145 (ms) / GPU bubble ratio: 45.64%
[rank3]:2025-10-29 04:32:13,187 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 04:32:13,434 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 04:32:13,461 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 04:32:13,487 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 04:33:37,163 - INFO - [GC] Peforming periodical GC collection 0.24 seconds
[rank3]:2025-10-29 04:33:39,403 - INFO -  step: 850  loss:  0.1588  grad_norm:  0.2550  memory: 16.43GiB(34.58%)  tps: 7,036  tflops: 55.01  mfu: 17.63%
[rank1]:2025-10-29 04:33:39,395 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2550  memory:  9.26GiB(19.50%)  tps: 7,036  tflops: 55.00  mfu: 17.63%
[rank0]:2025-10-29 04:33:39,406 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2550  memory: 13.29GiB(27.97%)  tps: 7,034  tflops: 54.99  mfu: 17.62%
[rank2]:2025-10-29 04:33:39,391 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2550  memory:  6.43GiB(13.53%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank3]:2025-10-29 04:33:39,637 - INFO - Avg. fwd time: 13.8698 / Avg. bwd time: 36.7549 / Avg. batch time: 436.1440 (ms) / GPU bubble ratio: 7.14%
[rank1]:2025-10-29 04:33:39,728 - INFO - Avg. fwd time: 10.0816 / Avg. bwd time: 24.1341 / Avg. batch time: 503.7892 (ms) / GPU bubble ratio: 45.67%
[rank0]:2025-10-29 04:33:39,698 - INFO - Avg. fwd time: 8.2674 / Avg. bwd time: 24.1459 / Avg. batch time: 539.8646 (ms) / GPU bubble ratio: 51.97%
[rank2]:2025-10-29 04:33:39,696 - INFO - Avg. fwd time: 7.7642 / Avg. bwd time: 18.7434 / Avg. batch time: 466.4174 (ms) / GPU bubble ratio: 54.53%
[rank0]:2025-10-29 04:35:28,255 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:35:30,456 - INFO -  step: 900  loss:  0.1335  grad_norm:  0.1947  memory: 16.43GiB(34.58%)  tps: 7,377  tflops: 57.67  mfu: 18.48%
[rank1]:2025-10-29 04:35:30,447 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1947  memory:  9.26GiB(19.50%)  tps: 7,377  tflops: 57.67  mfu: 18.48%
[rank0]:2025-10-29 04:35:30,458 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1947  memory: 13.29GiB(27.97%)  tps: 7,377  tflops: 57.67  mfu: 18.48%
[rank2]:2025-10-29 04:35:30,443 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1947  memory:  6.43GiB(13.53%)  tps: 7,377  tflops: 57.67  mfu: 18.48%
[rank3]:2025-10-29 04:35:30,652 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0435_real_step900_rank3.svg
[rank3]:> Batch Time: 500.59 ms, GPU Bubble Ratio: 47.91%, 45.18%, 57.52%, 18.64%
[rank3]:2025-10-29 04:35:31,099 - INFO - Avg. fwd time: 13.8638 / Avg. bwd time: 36.7468 / Avg. batch time: 436.0186 (ms) / GPU bubble ratio: 7.14%
[rank1]:2025-10-29 04:35:31,158 - INFO - Avg. fwd time: 10.0796 / Avg. bwd time: 24.1355 / Avg. batch time: 503.6886 (ms) / GPU bubble ratio: 45.66%
[rank0]:2025-10-29 04:35:31,190 - INFO - Avg. fwd time: 8.2651 / Avg. bwd time: 24.1467 / Avg. batch time: 539.7652 (ms) / GPU bubble ratio: 51.96%
[rank2]:2025-10-29 04:35:31,126 - INFO - Avg. fwd time: 7.7620 / Avg. bwd time: 18.7441 / Avg. batch time: 466.3150 (ms) / GPU bubble ratio: 54.53%
[rank0]:2025-10-29 04:37:19,285 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:37:21,513 - INFO -  step: 950  loss:  0.0825  grad_norm:  0.1332  memory: 16.43GiB(34.58%)  tps: 7,376  tflops: 57.67  mfu: 18.48%
[rank1]:2025-10-29 04:37:21,505 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1332  memory:  9.26GiB(19.50%)  tps: 7,376  tflops: 57.67  mfu: 18.48%
[rank0]:2025-10-29 04:37:21,516 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1332  memory: 13.29GiB(27.97%)  tps: 7,376  tflops: 57.67  mfu: 18.48%
[rank2]:2025-10-29 04:37:21,501 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1332  memory:  6.43GiB(13.53%)  tps: 7,376  tflops: 57.67  mfu: 18.48%
[rank3]:2025-10-29 04:37:21,767 - INFO - Avg. fwd time: 13.8567 / Avg. bwd time: 36.7386 / Avg. batch time: 435.8889 (ms) / GPU bubble ratio: 7.14%
[rank0]:2025-10-29 04:37:21,829 - INFO - Avg. fwd time: 8.2641 / Avg. bwd time: 24.1477 / Avg. batch time: 539.6181 (ms) / GPU bubble ratio: 51.95%
[rank2]:2025-10-29 04:37:21,822 - INFO - Avg. fwd time: 7.7611 / Avg. bwd time: 18.7457 / Avg. batch time: 466.1663 (ms) / GPU bubble ratio: 54.51%
[rank1]:2025-10-29 04:37:21,856 - INFO - Avg. fwd time: 10.0791 / Avg. bwd time: 24.1380 / Avg. batch time: 503.5415 (ms) / GPU bubble ratio: 45.64%
[rank0]:2025-10-29 04:39:11,028 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:39:13,294 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1238  memory: 13.29GiB(27.97%)  tps: 7,329  tflops: 57.29  mfu: 18.36%
[rank0]:2025-10-29 04:39:13,294 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 04:39:13,283 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1238  memory:  9.26GiB(19.50%)  tps: 7,329  tflops: 57.29  mfu: 18.36%
[rank1]:2025-10-29 04:39:13,283 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 04:39:13,279 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1238  memory:  6.43GiB(13.53%)  tps: 7,329  tflops: 57.29  mfu: 18.36%
[rank2]:2025-10-29 04:39:13,279 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 04:39:13,291 - INFO -  step: 1000  loss:  0.1091  grad_norm:  0.1238  memory: 16.43GiB(34.58%)  tps: 7,329  tflops: 57.29  mfu: 18.36%
[rank3]:2025-10-29 04:39:13,292 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:39:28,461 - INFO - validate step: 1000  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,006
[rank1]:2025-10-29 04:39:28,475 - INFO - validate step: 1000  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 26,963
[rank2]:2025-10-29 04:39:28,488 - INFO - validate step: 1000  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,933
[rank3]:2025-10-29 04:39:28,492 - INFO - validate step: 1000  loss:  0.2944  memory: 16.43GiB(34.58%)  tps: 26,949
[rank3]:2025-10-29 04:39:28,683 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0439_real_step1000_rank3.svg
[rank3]:> Batch Time: 500.58 ms, GPU Bubble Ratio: 47.90%, 45.17%, 57.52%, 18.64%
[rank3]:2025-10-29 04:39:28,914 - INFO - Avg. fwd time: 13.8588 / Avg. bwd time: 36.7436 / Avg. batch time: 435.9227 (ms) / GPU bubble ratio: 7.14%
[rank0]:2025-10-29 04:39:28,975 - INFO - Avg. fwd time: 8.2626 / Avg. bwd time: 24.1493 / Avg. batch time: 539.6324 (ms) / GPU bubble ratio: 51.95%
[rank1]:2025-10-29 04:39:29,008 - INFO - Avg. fwd time: 10.0780 / Avg. bwd time: 24.1407 / Avg. batch time: 503.5560 (ms) / GPU bubble ratio: 45.64%
[rank2]:2025-10-29 04:39:28,975 - INFO - Avg. fwd time: 7.7595 / Avg. bwd time: 18.7475 / Avg. batch time: 466.1793 (ms) / GPU bubble ratio: 54.51%
[rank0]:2025-10-29 04:41:18,235 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:41:20,497 - INFO -  step: 1050  loss:  0.1025  grad_norm:  0.1585  memory: 16.43GiB(34.58%)  tps: 7,314  tflops: 57.18  mfu: 18.33%
[rank1]:2025-10-29 04:41:20,489 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1585  memory:  9.26GiB(19.50%)  tps: 7,313  tflops: 57.17  mfu: 18.32%
[rank0]:2025-10-29 04:41:20,500 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1585  memory: 13.29GiB(27.97%)  tps: 7,312  tflops: 57.16  mfu: 18.32%
[rank2]:2025-10-29 04:41:20,485 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1585  memory:  6.43GiB(13.53%)  tps: 7,315  tflops: 57.18  mfu: 18.33%
[rank3]:2025-10-29 04:41:20,999 - INFO - Avg. fwd time: 13.8630 / Avg. bwd time: 36.7495 / Avg. batch time: 435.9914 (ms) / GPU bubble ratio: 7.13%
[rank1]:2025-10-29 04:41:21,060 - INFO - Avg. fwd time: 10.0772 / Avg. bwd time: 24.1435 / Avg. batch time: 503.6475 (ms) / GPU bubble ratio: 45.64%
[rank2]:2025-10-29 04:41:21,027 - INFO - Avg. fwd time: 7.7582 / Avg. bwd time: 18.7491 / Avg. batch time: 466.2678 (ms) / GPU bubble ratio: 54.52%
[rank0]:2025-10-29 04:41:21,093 - INFO - Avg. fwd time: 8.2616 / Avg. bwd time: 24.1506 / Avg. batch time: 539.7277 (ms) / GPU bubble ratio: 51.96%
[rank0]:2025-10-29 04:43:11,075 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:43:13,361 - INFO -  step: 1100  loss:  0.1254  grad_norm:  0.1522  memory: 16.43GiB(34.58%)  tps: 7,258  tflops: 56.74  mfu: 18.19%
[rank1]:2025-10-29 04:43:13,353 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1522  memory:  9.26GiB(19.50%)  tps: 7,258  tflops: 56.74  mfu: 18.19%
[rank0]:2025-10-29 04:43:13,364 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1522  memory: 13.29GiB(27.97%)  tps: 7,258  tflops: 56.74  mfu: 18.19%
[rank2]:2025-10-29 04:43:13,349 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1522  memory:  6.43GiB(13.53%)  tps: 7,258  tflops: 56.74  mfu: 18.19%
[rank3]:2025-10-29 04:43:13,559 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0443_real_step1100_rank3.svg
[rank3]:> Batch Time: 500.93 ms, GPU Bubble Ratio: 47.94%, 45.21%, 57.55%, 18.63%
[rank3]:2025-10-29 04:43:13,791 - INFO - Avg. fwd time: 13.8787 / Avg. bwd time: 36.7724 / Avg. batch time: 436.2724 (ms) / GPU bubble ratio: 7.12%
[rank1]:2025-10-29 04:43:13,891 - INFO - Avg. fwd time: 10.0761 / Avg. bwd time: 24.1434 / Avg. batch time: 503.9109 (ms) / GPU bubble ratio: 45.67%
[rank0]:2025-10-29 04:43:13,857 - INFO - Avg. fwd time: 8.2600 / Avg. bwd time: 24.1501 / Avg. batch time: 539.9882 (ms) / GPU bubble ratio: 51.98%
[rank2]:2025-10-29 04:43:13,858 - INFO - Avg. fwd time: 7.7570 / Avg. bwd time: 18.7492 / Avg. batch time: 466.5319 (ms) / GPU bubble ratio: 54.55%
[rank0]:2025-10-29 04:45:03,555 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:45:05,849 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1862  memory: 13.29GiB(27.97%)  tps: 7,283  tflops: 56.93  mfu: 18.25%
[rank1]:2025-10-29 04:45:05,838 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1862  memory:  9.26GiB(19.50%)  tps: 7,283  tflops: 56.93  mfu: 18.25%
[rank2]:2025-10-29 04:45:05,835 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1862  memory:  6.43GiB(13.53%)  tps: 7,283  tflops: 56.93  mfu: 18.25%
[rank3]:2025-10-29 04:45:05,847 - INFO -  step: 1150  loss:  0.1056  grad_norm:  0.1862  memory: 16.43GiB(34.58%)  tps: 7,283  tflops: 56.93  mfu: 18.25%
[rank3]:2025-10-29 04:45:06,109 - INFO - Avg. fwd time: 13.8884 / Avg. bwd time: 36.7879 / Avg. batch time: 436.4529 (ms) / GPU bubble ratio: 7.11%
[rank0]:2025-10-29 04:45:06,176 - INFO - Avg. fwd time: 8.2585 / Avg. bwd time: 24.1503 / Avg. batch time: 540.1851 (ms) / GPU bubble ratio: 52.00%
[rank1]:2025-10-29 04:45:06,210 - INFO - Avg. fwd time: 10.0747 / Avg. bwd time: 24.1438 / Avg. batch time: 504.1098 (ms) / GPU bubble ratio: 45.70%
[rank2]:2025-10-29 04:45:06,178 - INFO - Avg. fwd time: 7.7557 / Avg. bwd time: 18.7502 / Avg. batch time: 466.7302 (ms) / GPU bubble ratio: 54.57%
[rank0]:2025-10-29 04:46:55,771 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:46:58,085 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2102  memory:  9.26GiB(19.50%)  tps: 7,298  tflops: 57.05  mfu: 18.29%
[rank1]:2025-10-29 04:46:58,085 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:46:58,096 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2102  memory: 13.29GiB(27.97%)  tps: 7,298  tflops: 57.05  mfu: 18.29%
[rank0]:2025-10-29 04:46:58,096 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 04:46:58,081 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2102  memory:  6.43GiB(13.53%)  tps: 7,298  tflops: 57.05  mfu: 18.29%
[rank2]:2025-10-29 04:46:58,082 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 04:46:58,093 - INFO -  step: 1200  loss:  0.1317  grad_norm:  0.2102  memory: 16.43GiB(34.58%)  tps: 7,298  tflops: 57.06  mfu: 18.29%
[rank3]:2025-10-29 04:46:58,094 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 04:47:13,299 - INFO - validate step: 1200  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 26,923
[rank0]:2025-10-29 04:47:13,286 - INFO - validate step: 1200  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 26,966
[rank2]:2025-10-29 04:47:13,313 - INFO - validate step: 1200  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,893
[rank3]:2025-10-29 04:47:13,318 - INFO - validate step: 1200  loss:  0.2937  memory: 16.43GiB(34.58%)  tps: 26,907
[rank3]:2025-10-29 04:47:13,525 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0447_real_step1200_rank3.svg
[rank3]:> Batch Time: 501.38 ms, GPU Bubble Ratio: 47.99%, 45.26%, 57.58%, 18.61%
[rank3]:2025-10-29 04:47:13,978 - INFO - Avg. fwd time: 13.8966 / Avg. bwd time: 36.8017 / Avg. batch time: 436.6084 (ms) / GPU bubble ratio: 7.11%
[rank2]:2025-10-29 04:47:14,007 - INFO - Avg. fwd time: 7.7553 / Avg. bwd time: 18.7519 / Avg. batch time: 466.9059 (ms) / GPU bubble ratio: 54.58%
[rank1]:2025-10-29 04:47:14,041 - INFO - Avg. fwd time: 10.0747 / Avg. bwd time: 24.1457 / Avg. batch time: 504.2891 (ms) / GPU bubble ratio: 45.71%
[rank0]:2025-10-29 04:47:14,074 - INFO - Avg. fwd time: 8.2577 / Avg. bwd time: 24.1508 / Avg. batch time: 540.3631 (ms) / GPU bubble ratio: 52.02%
[rank0]:2025-10-29 04:49:04,284 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:49:06,560 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1883  memory:  9.26GiB(19.50%)  tps: 7,233  tflops: 56.54  mfu: 18.12%
[rank0]:2025-10-29 04:49:06,571 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1883  memory: 13.29GiB(27.97%)  tps: 7,231  tflops: 56.53  mfu: 18.12%
[rank2]:2025-10-29 04:49:06,556 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1883  memory:  6.43GiB(13.53%)  tps: 7,234  tflops: 56.55  mfu: 18.13%
[rank3]:2025-10-29 04:49:06,568 - INFO -  step: 1250  loss:  0.1253  grad_norm:  0.1883  memory: 16.43GiB(34.58%)  tps: 7,234  tflops: 56.55  mfu: 18.12%
[rank3]:2025-10-29 04:49:06,826 - INFO - Avg. fwd time: 13.9092 / Avg. bwd time: 36.8204 / Avg. batch time: 436.8404 (ms) / GPU bubble ratio: 7.10%
[rank2]:2025-10-29 04:49:06,885 - INFO - Avg. fwd time: 7.7542 / Avg. bwd time: 18.7528 / Avg. batch time: 467.1233 (ms) / GPU bubble ratio: 54.60%
[rank1]:2025-10-29 04:49:06,917 - INFO - Avg. fwd time: 10.0734 / Avg. bwd time: 24.1461 / Avg. batch time: 504.5064 (ms) / GPU bubble ratio: 45.74%
[rank0]:2025-10-29 04:49:06,887 - INFO - Avg. fwd time: 8.2565 / Avg. bwd time: 24.1510 / Avg. batch time: 540.5801 (ms) / GPU bubble ratio: 52.04%
[rank0]:2025-10-29 04:50:57,448 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:50:59,687 - INFO -  step: 1300  loss:  0.1145  grad_norm:  0.1708  memory: 16.43GiB(34.58%)  tps: 7,242  tflops: 56.62  mfu: 18.15%
[rank1]:2025-10-29 04:50:59,679 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1708  memory:  9.26GiB(19.50%)  tps: 7,242  tflops: 56.61  mfu: 18.15%
[rank0]:2025-10-29 04:50:59,689 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1708  memory: 13.29GiB(27.97%)  tps: 7,242  tflops: 56.61  mfu: 18.15%
[rank2]:2025-10-29 04:50:59,675 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1708  memory:  6.43GiB(13.53%)  tps: 7,242  tflops: 56.61  mfu: 18.15%
[rank3]:2025-10-29 04:50:59,888 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0450_real_step1300_rank3.svg
[rank3]:> Batch Time: 502.05 ms, GPU Bubble Ratio: 48.06%, 45.32%, 57.64%, 18.59%
[rank3]:2025-10-29 04:51:00,125 - INFO - Avg. fwd time: 13.9262 / Avg. bwd time: 36.8461 / Avg. batch time: 437.1578 (ms) / GPU bubble ratio: 7.09%
[rank0]:2025-10-29 04:51:00,185 - INFO - Avg. fwd time: 8.2558 / Avg. bwd time: 24.1513 / Avg. batch time: 540.8832 (ms) / GPU bubble ratio: 52.07%
[rank2]:2025-10-29 04:51:00,191 - INFO - Avg. fwd time: 7.7536 / Avg. bwd time: 18.7538 / Avg. batch time: 467.4254 (ms) / GPU bubble ratio: 54.63%
[rank1]:2025-10-29 04:51:00,224 - INFO - Avg. fwd time: 10.0730 / Avg. bwd time: 24.1468 / Avg. batch time: 504.8092 (ms) / GPU bubble ratio: 45.77%
[rank0]:2025-10-29 04:52:50,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:52:52,895 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1459  memory:  6.43GiB(13.53%)  tps: 7,236  tflops: 56.56  mfu: 18.13%
[rank3]:2025-10-29 04:52:52,907 - INFO -  step: 1350  loss:  0.1363  grad_norm:  0.1459  memory: 16.43GiB(34.58%)  tps: 7,236  tflops: 56.56  mfu: 18.13%
[rank1]:2025-10-29 04:52:52,898 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1459  memory:  9.26GiB(19.50%)  tps: 7,236  tflops: 56.56  mfu: 18.13%
[rank0]:2025-10-29 04:52:52,909 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1459  memory: 13.29GiB(27.97%)  tps: 7,236  tflops: 56.56  mfu: 18.13%
[rank3]:2025-10-29 04:52:53,383 - INFO - Avg. fwd time: 13.9396 / Avg. bwd time: 36.8657 / Avg. batch time: 437.4009 (ms) / GPU bubble ratio: 7.08%
[rank1]:2025-10-29 04:52:53,447 - INFO - Avg. fwd time: 10.0718 / Avg. bwd time: 24.1473 / Avg. batch time: 505.0699 (ms) / GPU bubble ratio: 45.80%
[rank0]:2025-10-29 04:52:53,481 - INFO - Avg. fwd time: 8.2545 / Avg. bwd time: 24.1514 / Avg. batch time: 541.1435 (ms) / GPU bubble ratio: 52.09%
[rank2]:2025-10-29 04:52:53,413 - INFO - Avg. fwd time: 7.7526 / Avg. bwd time: 18.7549 / Avg. batch time: 467.6850 (ms) / GPU bubble ratio: 54.66%
[rank0]:2025-10-29 04:54:43,796 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:54:46,075 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1177  memory:  9.26GiB(19.50%)  tps: 7,238  tflops: 56.59  mfu: 18.14%
[rank1]:2025-10-29 04:54:46,075 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 04:54:46,084 - INFO -  step: 1400  loss:  0.0919  grad_norm:  0.1177  memory: 16.43GiB(34.58%)  tps: 7,238  tflops: 56.59  mfu: 18.14%
[rank3]:2025-10-29 04:54:46,085 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 04:54:46,086 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1177  memory: 13.29GiB(27.97%)  tps: 7,238  tflops: 56.59  mfu: 18.14%
[rank0]:2025-10-29 04:54:46,086 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 04:54:46,071 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1177  memory:  6.43GiB(13.53%)  tps: 7,238  tflops: 56.59  mfu: 18.14%
[rank2]:2025-10-29 04:54:46,072 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 04:55:01,393 - INFO - validate step: 1400  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 26,740
[rank3]:2025-10-29 04:55:01,413 - INFO - validate step: 1400  loss:  0.2914  memory: 16.43GiB(34.58%)  tps: 26,724
[rank0]:2025-10-29 04:55:01,380 - INFO - validate step: 1400  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 26,782
[rank2]:2025-10-29 04:55:01,408 - INFO - validate step: 1400  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,709
[rank3]:2025-10-29 04:55:01,605 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0455_real_step1400_rank3.svg
[rank3]:> Batch Time: 502.56 ms, GPU Bubble Ratio: 48.12%, 45.38%, 57.68%, 18.57%
[rank3]:2025-10-29 04:55:01,835 - INFO - Avg. fwd time: 13.9517 / Avg. bwd time: 36.8857 / Avg. batch time: 437.6409 (ms) / GPU bubble ratio: 7.07%
[rank1]:2025-10-29 04:55:01,929 - INFO - Avg. fwd time: 10.0716 / Avg. bwd time: 24.1485 / Avg. batch time: 505.3000 (ms) / GPU bubble ratio: 45.82%
[rank0]:2025-10-29 04:55:01,897 - INFO - Avg. fwd time: 8.2539 / Avg. bwd time: 24.1517 / Avg. batch time: 541.3726 (ms) / GPU bubble ratio: 52.11%
[rank2]:2025-10-29 04:55:01,896 - INFO - Avg. fwd time: 7.7523 / Avg. bwd time: 18.7559 / Avg. batch time: 467.9128 (ms) / GPU bubble ratio: 54.68%
[rank0]:2025-10-29 04:56:51,931 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 04:56:54,195 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1520  memory:  6.43GiB(13.53%)  tps: 7,263  tflops: 56.78  mfu: 18.20%
[rank1]:2025-10-29 04:56:54,199 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1520  memory:  9.26GiB(19.50%)  tps: 7,262  tflops: 56.77  mfu: 18.20%
[rank3]:2025-10-29 04:56:54,207 - INFO -  step: 1450  loss:  0.0968  grad_norm:  0.1520  memory: 16.43GiB(34.58%)  tps: 7,263  tflops: 56.78  mfu: 18.20%
[rank0]:2025-10-29 04:56:54,210 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1520  memory: 13.29GiB(27.97%)  tps: 7,261  tflops: 56.76  mfu: 18.19%
[rank3]:2025-10-29 04:56:54,476 - INFO - Avg. fwd time: 13.9581 / Avg. bwd time: 36.8968 / Avg. batch time: 437.7702 (ms) / GPU bubble ratio: 7.07%
[rank1]:2025-10-29 04:56:54,569 - INFO - Avg. fwd time: 10.0707 / Avg. bwd time: 24.1490 / Avg. batch time: 505.4424 (ms) / GPU bubble ratio: 45.84%
[rank0]:2025-10-29 04:56:54,536 - INFO - Avg. fwd time: 8.2528 / Avg. bwd time: 24.1517 / Avg. batch time: 541.5147 (ms) / GPU bubble ratio: 52.13%
[rank2]:2025-10-29 04:56:54,536 - INFO - Avg. fwd time: 7.7514 / Avg. bwd time: 18.7567 / Avg. batch time: 468.0547 (ms) / GPU bubble ratio: 54.69%
[rank0]:2025-10-29 04:58:44,918 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:58:47,208 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1608  memory:  9.26GiB(19.50%)  tps: 7,249  tflops: 56.67  mfu: 18.16%
[rank3]:2025-10-29 04:58:47,216 - INFO -  step: 1500  loss:  0.1273  grad_norm:  0.1608  memory: 16.43GiB(34.58%)  tps: 7,249  tflops: 56.67  mfu: 18.16%
[rank0]:2025-10-29 04:58:47,218 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1608  memory: 13.29GiB(27.97%)  tps: 7,249  tflops: 56.67  mfu: 18.16%
[rank2]:2025-10-29 04:58:47,204 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1608  memory:  6.43GiB(13.53%)  tps: 7,249  tflops: 56.67  mfu: 18.16%
[rank3]:2025-10-29 04:58:47,411 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0458_real_step1500_rank3.svg
[rank3]:> Batch Time: 502.86 ms, GPU Bubble Ratio: 48.15%, 45.42%, 57.71%, 18.56%
[rank3]:2025-10-29 04:58:47,875 - INFO - Avg. fwd time: 13.9690 / Avg. bwd time: 36.9127 / Avg. batch time: 437.9695 (ms) / GPU bubble ratio: 7.06%
[rank2]:2025-10-29 04:58:47,904 - INFO - Avg. fwd time: 7.7506 / Avg. bwd time: 18.7572 / Avg. batch time: 468.2667 (ms) / GPU bubble ratio: 54.71%
[rank1]:2025-10-29 04:58:47,939 - INFO - Avg. fwd time: 10.0701 / Avg. bwd time: 24.1497 / Avg. batch time: 505.6560 (ms) / GPU bubble ratio: 45.86%
[rank0]:2025-10-29 04:58:47,973 - INFO - Avg. fwd time: 8.2519 / Avg. bwd time: 24.1516 / Avg. batch time: 541.7278 (ms) / GPU bubble ratio: 52.15%
[rank0]:2025-10-29 05:00:37,076 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:00:39,362 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1594  memory:  9.26GiB(19.50%)  tps: 7,304  tflops: 57.10  mfu: 18.30%
[rank3]:2025-10-29 05:00:39,369 - INFO -  step: 1550  loss:  0.1064  grad_norm:  0.1594  memory: 16.43GiB(34.58%)  tps: 7,304  tflops: 57.10  mfu: 18.30%
[rank0]:2025-10-29 05:00:39,368 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1594  memory: 13.29GiB(27.97%)  tps: 7,305  tflops: 57.10  mfu: 18.30%
[rank2]:2025-10-29 05:00:39,353 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1594  memory:  6.43GiB(13.53%)  tps: 7,305  tflops: 57.10  mfu: 18.30%
[rank3]:2025-10-29 05:00:39,631 - INFO - Avg. fwd time: 13.9683 / Avg. bwd time: 36.9134 / Avg. batch time: 437.9690 (ms) / GPU bubble ratio: 7.06%
[rank2]:2025-10-29 05:00:39,695 - INFO - Avg. fwd time: 7.7503 / Avg. bwd time: 18.7585 / Avg. batch time: 468.2551 (ms) / GPU bubble ratio: 54.71%
[rank1]:2025-10-29 05:00:39,728 - INFO - Avg. fwd time: 10.0697 / Avg. bwd time: 24.1509 / Avg. batch time: 505.6456 (ms) / GPU bubble ratio: 45.86%
[rank0]:2025-10-29 05:00:39,693 - INFO - Avg. fwd time: 8.2512 / Avg. bwd time: 24.1520 / Avg. batch time: 541.7171 (ms) / GPU bubble ratio: 52.15%
[rank0]:2025-10-29 05:02:30,132 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:02:32,447 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2003  memory:  6.43GiB(13.53%)  tps: 7,244  tflops: 56.63  mfu: 18.15%
[rank2]:2025-10-29 05:02:32,447 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.2003  tps: 7,489  tflops: 58.55  mfu: 17.80%
[rank2]:2025-10-29 05:02:32,447 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 05:02:32,459 - INFO -  step: 1600  loss:  0.1220  grad_norm:  0.2003  memory: 16.43GiB(34.58%)  tps: 7,244  tflops: 56.63  mfu: 18.15%
[rank3]:2025-10-29 05:02:32,460 - INFO -  final step: 1600  loss:  0.1220  grad_norm:  0.2003  tps: 7,494  tflops: 58.58  mfu: 17.81%
[rank3]:2025-10-29 05:02:32,460 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 05:02:32,450 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2003  memory:  9.26GiB(19.50%)  tps: 7,244  tflops: 56.63  mfu: 18.15%
[rank1]:2025-10-29 05:02:32,451 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.2003  tps: 7,489  tflops: 58.55  mfu: 17.80%
[rank1]:2025-10-29 05:02:32,451 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 05:02:32,462 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2003  memory: 13.29GiB(27.97%)  tps: 7,244  tflops: 56.63  mfu: 18.15%
[rank0]:2025-10-29 05:02:32,462 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.2003  tps: 7,489  tflops: 58.55  mfu: 17.80%
[rank0]:2025-10-29 05:02:32,462 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 05:02:47,606 - INFO - validate step: 1600  loss: -1.0000  memory:  9.26GiB(19.50%)  tps: 27,028
[rank1]:2025-10-29 05:02:47,606 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 05:02:47,608 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-29 05:02:47,593 - INFO - validate step: 1600  loss: -1.0000  memory: 13.29GiB(27.97%)  tps: 27,071
[rank0]:2025-10-29 05:02:47,594 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 05:02:47,596 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-29 05:02:47,619 - INFO - validate step: 1600  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 26,997
[rank2]:2025-10-29 05:02:47,620 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 05:02:47,622 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-29 05:02:47,624 - INFO - validate step: 1600  loss:  0.2933  memory: 16.43GiB(34.58%)  tps: 27,014
[rank3]:2025-10-29 05:02:47,625 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 05:02:47,627 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-29 05:02:50,327 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 05:02:50,344 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 05:02:50,345 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 05:02:50,345 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 05:02:50,548 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0502_real_final1600_rank3.svg
[rank3]:> Batch Time: 503.04 ms, GPU Bubble Ratio: 48.17%, 45.43%, 57.72%, 18.55%
[rank3]:2025-10-29 05:02:50,745 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251029_0502_thry_final1600_rank3.svg
[rank3]:> Batch Time: 330.71 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 05:02:50,746 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 05:02:50,795 - INFO - Process group destroyed
[rank1]:2025-10-29 05:02:50,787 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–†â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.18627
[rank3]:wandb:               final/avg_loss 0.12205
[rank3]:wandb:             final/avg_mfu(%) 17.80943
[rank3]:wandb:             final/avg_tflops 58.585
[rank3]:wandb:    final/avg_throughput(tps) 7494.04578
[rank3]:wandb:              final/grad_norm 0.20029
[rank3]:wandb:               final/max_loss 0.12205
[rank3]:wandb:                    grad_norm 0.20029
[rank3]:wandb: loss_metrics/global_avg_loss 0.12205
[rank3]:wandb: loss_metrics/global_max_loss 0.12205
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/yhfema0e
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1028_1F1B_nofreeze_dm1/20251029-0400/wandb/run-20251029_040034-yhfema0e/logs
[rank0]:2025-10-29 05:02:52,345 - INFO - Training completed
[rank0]:2025-10-29 05:02:52,345 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 05:02:52,504 - INFO - Process group destroyed
[rank0]:2025-10-29 05:02:52,500 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.10', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.2', 'tok_embeddings', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.6', 'layers.7', 'layers.8', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.15', 'layers.14', 'layers.13', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1028_1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1028_1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1028_1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: True
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1028_1F1B_nofreeze_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1028_1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
