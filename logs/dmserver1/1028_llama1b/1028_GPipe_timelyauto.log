
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 29. (ìˆ˜) 03:20:52 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/1028_GPipe_timelyauto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-10-29 03:20:58,727 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-29 03:20:58,643 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 03:20:58,644 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-29 03:20:58,881 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 03:20:59,422 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 03:20:59,425 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:20:59,428 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-29 03:20:59,431 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 03:20:59,433 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 03:20:59,444 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 03:20:59,449 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 03:20:59,453 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 03:20:59,456 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:20:59,873 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 03:21:00,284 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 03:21:03,204 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 03:21:03,288 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 03:21:03,326 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 03:21:03,327 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-29 03:21:03,373 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank0]:2025-10-29 03:21:03,415 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 03:21:03,375 - INFO - Compiling each TransformerBlock with torch.compile
[rank2]:2025-10-29 03:21:03,375 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:21:03,379 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 03:21:03,417 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 03:21:03,418 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 03:21:03,455 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 03:21:03,456 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 03:21:03,457 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 03:21:03,505 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 03:21:03,506 - INFO - Compiling each TransformerBlock with torch.compile
[rank0]:2025-10-29 03:21:03,506 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:21:03,465 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 03:21:03,466 - INFO - Compiling each TransformerBlock with torch.compile
[rank1]:2025-10-29 03:21:03,466 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 03:21:03,548 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 03:21:03,549 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 03:21:03,549 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-29 03:21:03,679 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 03:21:03,679 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 03:21:03,679 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-29 03:21:03,644 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 03:21:03,644 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 03:21:03,645 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run f6kka0sq
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1028_GPipe_timelyauto_dm1/20251029-0321/wandb/run-20251029_032104-f6kka0sq
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/f6kka0sq
[rank3]:2025-10-29 03:21:05,489 - INFO - WandB logging enabled
[rank3]:2025-10-29 03:21:05,490 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 03:21:05,529 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 03:21:05,531 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-29 03:21:05,578 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 03:21:05,579 - INFO - Compiling each TransformerBlock with torch.compile
[rank3]:2025-10-29 03:21:05,580 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 03:21:05,758 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 03:21:05,759 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 03:21:05,759 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 03:21:05,774 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 03:21:05,775 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-29 03:21:05,774 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 03:21:05,774 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 03:21:05,774 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1028_GPipe_timelyauto_dm1
[rank0]:2025-10-29 03:21:05,774 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:21:05,774 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 03:21:05,776 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 03:21:05,774 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 03:21:05,774 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-29 03:21:10,018 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1600 (warmup 100)
[rank0]:2025-10-29 03:21:10,018 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 03:21:13,898 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 03:21:13,898 - INFO - Finished loading the checkpoint in 3.88 seconds.
[rank0]:2025-10-29 03:21:13,898 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank0]:  warnings.warn(
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank1]:  warnings.warn(
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank2]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank3]:  warnings.warn(
[rank3]:2025-10-29 03:21:26,826 - INFO -  step:  1  loss:  9.8292  grad_norm: 53.4627  memory: 19.81GiB(41.70%)  tps: 769  tflops: 6.01  mfu: 1.93%
[rank3]:2025-10-29 03:21:26,827 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 03:21:26,854 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4627  memory: 13.97GiB(29.42%)  tps: 700  tflops: 5.47  mfu: 1.75%
[rank2]:2025-10-29 03:21:26,815 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4627  memory: 11.16GiB(23.50%)  tps: 698  tflops: 5.45  mfu: 1.75%
[rank0]:2025-10-29 03:21:26,854 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 03:21:26,816 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 03:21:26,819 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.4627  memory: 13.84GiB(29.13%)  tps: 700  tflops: 5.47  mfu: 1.75%
[rank1]:2025-10-29 03:21:26,824 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 03:21:41,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,531 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,534 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,534 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,535 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,535 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,536 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,537 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,537 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,538 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:21:41,538 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,561 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,562 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,563 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,563 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,563 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,563 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,563 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:21:41,563 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,592 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:21:41,592 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:21:41,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:12,550 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:23:14,771 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.6393  memory: 17.74GiB(37.35%)  tps: 7,439  tflops: 58.16  mfu: 18.64%
[rank3]:2025-10-29 03:23:14,767 - INFO -  step: 50  loss:  9.4397  grad_norm: 21.6393  memory: 22.25GiB(46.84%)  tps: 7,438  tflops: 58.14  mfu: 18.64%
[rank1]:2025-10-29 03:23:14,758 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.6393  memory: 16.11GiB(33.90%)  tps: 7,438  tflops: 58.15  mfu: 18.64%
[rank2]:2025-10-29 03:23:14,754 - INFO -  step: 50  loss: -4.0000  grad_norm: 21.6393  memory: 12.98GiB(27.32%)  tps: 7,438  tflops: 58.14  mfu: 18.64%
[rank3]:2025-10-29 03:23:14,986 - INFO - Avg. fwd time: 11.5962 / Avg. bwd time: 39.2155 / Avg. batch time: 430.5198 (ms) / GPU bubble ratio: 5.58%
[rank2]:2025-10-29 03:23:15,077 - INFO - Avg. fwd time: 7.6897 / Avg. bwd time: 18.6384 / Avg. batch time: 460.4881 (ms) / GPU bubble ratio: 54.26%
[rank0]:2025-10-29 03:23:15,124 - INFO - Avg. fwd time: 8.9023 / Avg. bwd time: 23.9711 / Avg. batch time: 534.6700 (ms) / GPU bubble ratio: 50.81%
[rank1]:2025-10-29 03:23:15,137 - INFO - Avg. fwd time: 10.3604 / Avg. bwd time: 24.0911 / Avg. batch time: 498.4487 (ms) / GPU bubble ratio: 44.71%
[rank3]:2025-10-29 03:23:36,346 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 03:23:58,542 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank0]:2025-10-29 03:23:58,914 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:58,931 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:58,865 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-29 03:23:58,908 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:58,923 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:58,935 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:58,944 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:58,924 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:58,943 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:58,956 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:58,965 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:58,975 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:58,916 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:58,927 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:58,937 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:58,945 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:58,959 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:58,982 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:58,943 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:58,952 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:58,960 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:58,968 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:58,952 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:58,964 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:58,981 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:23:59,008 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:59,073 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:59,000 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:23:59,068 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:59,092 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:23:59,128 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:59,109 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:23:59,145 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:24:31,766 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 03:24:32,200 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0324_max_batch_time.svg
[rank3]:> Batch Time: 514.70 ms, GPU Bubble Ratio: 48.30%, 45.81%, 58.36%, 18.44%
[rank3]:2025-10-29 03:24:32,384 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0324_min_batch_time.svg
[rank3]:> Batch Time: 366.77 ms, GPU Bubble Ratio: 80.78%, 31.89%, 48.85%, 17.72%
[rank3]:2025-10-29 03:24:32,582 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0324_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 366.77 ms, GPU Bubble Ratio: 34.57%, 24.65%, 42.83%, 17.72%
[rank3]:2025-10-29 03:24:32,583 - INFO - 	> Batch Time: 366.77 ms (Average Freeze Ratio: 0.36, Time Reduction Rate: 0.29)
[rank0]:2025-10-29 03:24:47,455 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:24:49,025 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.15/0.44, [MB7] 0.33/1.00
[rank0]:2025-10-29 03:24:49,051 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.07, [MB7] 0.33/1.00
[rank0]:2025-10-29 03:24:49,051 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 8,689  tflops: 67.93  mfu: 21.77%
[rank3]:2025-10-29 03:24:49,018 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 03:24:49,050 - INFO -  step: 100  loss: 10.1879  grad_norm:  0.0000  memory: 24.75GiB(52.11%)  tps: 8,689  tflops: 67.93  mfu: 21.77%
[rank1]:2025-10-29 03:24:49,051 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.04/0.12, [MB7] 0.33/1.00
[rank1]:2025-10-29 03:24:49,051 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 8,688  tflops: 67.92  mfu: 21.77%
[rank1]:2025-10-29 03:24:49,130 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0324_stage1_step100.svg
[rank2]:2025-10-29 03:24:49,049 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 8,688  tflops: 67.92  mfu: 21.77%
[rank2]:2025-10-29 03:24:49,130 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0324_stage2_step100.svg
[rank0]:2025-10-29 03:24:49,131 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0324_stage0_step100.svg
[rank0]:2025-10-29 03:24:49,176 - INFO - Avg. fwd time: 8.8599 / Avg. bwd time: 17.2720 / Avg. batch time: 499.8870 (ms) / GPU bubble ratio: 58.18%
[rank3]:2025-10-29 03:24:49,227 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0324_real_step100_rank3.svg
[rank3]:> Batch Time: 499.97 ms, GPU Bubble Ratio: 47.33%, 45.21%, 57.66%, 18.73%
[rank3]:2025-10-29 03:24:49,289 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0324_stage3_step100.svg
[rank3]:2025-10-29 03:24:49,431 - INFO - Avg. fwd time: 12.0910 / Avg. bwd time: 35.5413 / Avg. batch time: 401.2233 (ms) / GPU bubble ratio: 5.03%
[rank1]:2025-10-29 03:24:49,532 - INFO - Avg. fwd time: 10.2855 / Avg. bwd time: 23.3642 / Avg. batch time: 469.7104 (ms) / GPU bubble ratio: 42.69%
[rank2]:2025-10-29 03:24:49,476 - INFO - Avg. fwd time: 7.7204 / Avg. bwd time: 17.8180 / Avg. batch time: 431.7141 (ms) / GPU bubble ratio: 52.68%
[rank0]:2025-10-29 03:26:20,095 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:26:21,755 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.29/0.44, [MB7] 0.67/1.00
[rank2]:2025-10-29 03:26:21,755 - INFO -  step: 150  loss: -4.0000  grad_norm:  6.2363  memory: 12.98GiB(27.32%)  tps: 8,837  tflops: 69.08  mfu: 22.14%
[rank1]:2025-10-29 03:26:21,762 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.08/0.12, [MB7] 0.67/1.00
[rank1]:2025-10-29 03:26:21,762 - INFO -  step: 150  loss: -4.0000  grad_norm:  6.2363  memory: 16.11GiB(33.90%)  tps: 8,836  tflops: 69.08  mfu: 22.14%
[rank0]:2025-10-29 03:26:21,747 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.05/0.07, [MB7] 0.67/1.00
[rank0]:2025-10-29 03:26:21,748 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 8,837  tflops: 69.09  mfu: 22.14%
[rank3]:2025-10-29 03:26:21,755 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 03:26:21,757 - INFO -  step: 150  loss:  6.5732  grad_norm:  6.2363  memory: 25.20GiB(53.05%)  tps: 8,837  tflops: 69.08  mfu: 22.14%
[rank1]:2025-10-29 03:26:22,168 - INFO - Avg. fwd time: 10.2312 / Avg. bwd time: 23.4008 / Avg. batch time: 451.2004 (ms) / GPU bubble ratio: 40.37%
[rank2]:2025-10-29 03:26:22,139 - INFO - Avg. fwd time: 7.7204 / Avg. bwd time: 17.6921 / Avg. batch time: 411.4916 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-29 03:26:22,173 - INFO - Avg. fwd time: 8.8136 / Avg. bwd time: 17.2909 / Avg. batch time: 481.1213 (ms) / GPU bubble ratio: 56.59%
[rank3]:2025-10-29 03:26:22,119 - INFO - Avg. fwd time: 12.3246 / Avg. bwd time: 32.9256 / Avg. batch time: 381.0461 (ms) / GPU bubble ratio: 5.00%
[rank0]:2025-10-29 03:27:46,190 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:27:47,807 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.07/0.07, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:27:47,808 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 9,519  tflops: 74.41  mfu: 23.85%
[rank0]:2025-10-29 03:27:47,808 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 03:27:47,808 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:27:47,810 - INFO -  step: 200  loss:  5.1502  grad_norm:  0.0646  memory: 25.20GiB(53.05%)  tps: 9,520  tflops: 74.42  mfu: 23.85%
[rank3]:2025-10-29 03:27:47,810 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 03:27:47,811 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.12/0.12, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:27:47,811 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0646  memory: 16.11GiB(33.90%)  tps: 9,520  tflops: 74.42  mfu: 23.85%
[rank1]:2025-10-29 03:27:47,811 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 03:27:47,808 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.44/0.44, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:27:47,808 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0646  memory: 12.98GiB(27.32%)  tps: 9,520  tflops: 74.42  mfu: 23.85%
[rank2]:2025-10-29 03:27:47,808 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 03:28:07,999 - INFO - validate step: 200  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 20,290
[rank2]:2025-10-29 03:28:08,014 - INFO - validate step: 200  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 20,272
[rank0]:2025-10-29 03:28:07,982 - INFO - validate step: 200  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 20,303
[rank3]:2025-10-29 03:28:08,019 - INFO - validate step: 200  loss:  1.1115  memory: 25.20GiB(53.05%)  tps: 20,270
[rank1]:2025-10-29 03:28:08,094 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0328_stage1_step200.svg
[rank2]:2025-10-29 03:28:08,094 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0328_stage2_step200.svg
[rank0]:2025-10-29 03:28:08,095 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0328_stage0_step200.svg
[rank3]:2025-10-29 03:28:08,205 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0328_real_step200_rank3.svg
[rank3]:> Batch Time: 406.85 ms, GPU Bubble Ratio: 39.65%, 34.26%, 50.24%, 22.49%
[rank3]:2025-10-29 03:28:08,272 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0328_stage3_step200.svg
[rank3]:2025-10-29 03:28:14,084 - INFO - Avg. fwd time: 12.4101 / Avg. bwd time: 31.7226 / Avg. batch time: 371.6282 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 03:28:14,931 - INFO - Avg. fwd time: 7.7216 / Avg. bwd time: 17.3560 / Avg. batch time: 401.4533 (ms) / GPU bubble ratio: 50.03%
[rank1]:2025-10-29 03:28:15,115 - INFO - Avg. fwd time: 10.2345 / Avg. bwd time: 23.1319 / Avg. batch time: 441.2009 (ms) / GPU bubble ratio: 39.50%
[rank0]:2025-10-29 03:28:16,094 - INFO - Avg. fwd time: 8.7447 / Avg. bwd time: 14.4299 / Avg. batch time: 468.0271 (ms) / GPU bubble ratio: 60.39%
[rank0]:2025-10-29 03:29:18,247 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-10-29 03:29:19,527 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.07/0.07, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:29:19,527 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 11,450  tflops: 89.51  mfu: 28.69%
[rank3]:2025-10-29 03:29:19,517 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:29:19,526 - INFO -  step: 250  loss:  4.6690  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 11,456  tflops: 89.56  mfu: 28.71%
[rank2]:2025-10-29 03:29:19,516 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.44/0.44, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:29:19,525 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 11,456  tflops: 89.55  mfu: 28.70%
[rank1]:2025-10-29 03:29:19,527 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.12/0.12, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:29:19,527 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 11,453  tflops: 89.53  mfu: 28.70%
[rank0]:2025-10-29 03:29:19,572 - INFO - Avg. fwd time: 8.8927 / Avg. bwd time: 11.5052 / Avg. batch time: 444.1160 (ms) / GPU bubble ratio: 63.26%
[rank3]:2025-10-29 03:29:19,629 - INFO - Avg. fwd time: 12.7026 / Avg. bwd time: 28.9273 / Avg. batch time: 351.3022 (ms) / GPU bubble ratio: 5.20%
[rank2]:2025-10-29 03:29:19,647 - INFO - Avg. fwd time: 7.8746 / Avg. bwd time: 15.4880 / Avg. batch time: 382.1764 (ms) / GPU bubble ratio: 51.10%
[rank1]:2025-10-29 03:29:19,657 - INFO - Avg. fwd time: 10.1912 / Avg. bwd time: 20.4845 / Avg. batch time: 418.7713 (ms) / GPU bubble ratio: 41.40%
[rank0]:2025-10-29 03:30:22,227 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:30:23,710 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0330_rank0_trend_line.svg
[rank3]:2025-10-29 03:30:23,700 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0330_rank3_trend_line.svg
[rank2]:2025-10-29 03:30:23,700 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0330_rank2_trend_line.svg
[rank2]:2025-10-29 03:30:23,717 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:30:23,719 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:30:23,720 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,761  tflops: 99.76  mfu: 31.98%
[rank1]:2025-10-29 03:30:23,711 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0330_rank1_trend_line.svg
[rank1]:2025-10-29 03:30:23,717 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:30:23,719 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:30:23,720 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,762  tflops: 99.76  mfu: 31.98%
[rank0]:2025-10-29 03:30:23,717 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:30:23,719 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:30:23,719 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,762  tflops: 99.76  mfu: 31.98%
[rank3]:2025-10-29 03:30:23,906 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0330_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 306.07 ms, GPU Bubble Ratio: 62.12%, 29.86%, 46.60%, 18.19%
[rank3]:2025-10-29 03:30:23,906 - INFO - 	> Batch Time: 306.07 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 03:30:23,907 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:30:23,909 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:30:23,911 - INFO -  step: 300  loss:  4.1758  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,724  tflops: 99.47  mfu: 31.88%
[rank1]:2025-10-29 03:30:23,979 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0330_stage1_step300.svg
[rank0]:2025-10-29 03:30:23,979 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0330_stage0_step300.svg
[rank2]:2025-10-29 03:30:23,980 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0330_stage2_step300.svg
[rank3]:2025-10-29 03:30:24,090 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0330_real_step300_rank3.svg
[rank3]:> Batch Time: 372.46 ms, GPU Bubble Ratio: 81.66%, 31.06%, 48.87%, 17.69%
[rank3]:2025-10-29 03:30:24,153 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0330_stage3_step300.svg
[rank3]:2025-10-29 03:30:24,422 - INFO - Avg. fwd time: 12.7888 / Avg. bwd time: 26.8720 / Avg. batch time: 335.3639 (ms) / GPU bubble ratio: 5.39%
[rank2]:2025-10-29 03:30:24,435 - INFO - Avg. fwd time: 7.8405 / Avg. bwd time: 14.0566 / Avg. batch time: 364.1654 (ms) / GPU bubble ratio: 51.90%
[rank1]:2025-10-29 03:30:24,450 - INFO - Avg. fwd time: 10.1539 / Avg. bwd time: 18.5470 / Avg. batch time: 398.3277 (ms) / GPU bubble ratio: 42.36%
[rank0]:2025-10-29 03:30:24,456 - INFO - Avg. fwd time: 8.8040 / Avg. bwd time: 9.4938 / Avg. batch time: 421.2239 (ms) / GPU bubble ratio: 65.25%
[rank0]:2025-10-29 03:31:26,757 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 03:31:28,049 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,735  tflops: 99.55  mfu: 31.91%
[rank0]:2025-10-29 03:31:28,048 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,735  tflops: 99.55  mfu: 31.91%
[rank2]:2025-10-29 03:31:28,047 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,735  tflops: 99.56  mfu: 31.91%
[rank3]:2025-10-29 03:31:28,048 - INFO -  step: 350  loss:  3.6717  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,773  tflops: 99.85  mfu: 32.00%
[rank1]:2025-10-29 03:31:28,180 - INFO - Avg. fwd time: 10.1312 / Avg. bwd time: 17.3585 / Avg. batch time: 385.5987 (ms) / GPU bubble ratio: 42.97%
[rank0]:2025-10-29 03:31:28,094 - INFO - Avg. fwd time: 8.7488 / Avg. bwd time: 8.2566 / Avg. batch time: 406.9889 (ms) / GPU bubble ratio: 66.57%
[rank2]:2025-10-29 03:31:28,170 - INFO - Avg. fwd time: 7.8192 / Avg. bwd time: 13.1773 / Avg. batch time: 352.9268 (ms) / GPU bubble ratio: 52.41%
[rank3]:2025-10-29 03:31:28,151 - INFO - Avg. fwd time: 12.8666 / Avg. bwd time: 25.5719 / Avg. batch time: 325.4864 (ms) / GPU bubble ratio: 5.52%
[rank0]:2025-10-29 03:32:30,768 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:32:32,303 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0332_rank2_trend_line.svg
[rank3]:2025-10-29 03:32:32,309 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0332_rank3_trend_line.svg
[rank1]:2025-10-29 03:32:32,316 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0332_rank1_trend_line.svg
[rank1]:2025-10-29 03:32:32,325 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:32:32,327 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,745  tflops: 99.63  mfu: 31.93%
[rank1]:2025-10-29 03:32:32,327 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 03:32:32,318 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0332_rank0_trend_line.svg
[rank0]:2025-10-29 03:32:32,325 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:32:32,327 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,745  tflops: 99.63  mfu: 31.93%
[rank0]:2025-10-29 03:32:32,327 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 03:32:32,325 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:32:32,327 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,744  tflops: 99.63  mfu: 31.93%
[rank2]:2025-10-29 03:32:32,327 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 03:32:32,513 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0332_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 293.77 ms, GPU Bubble Ratio: 65.78%, 33.64%, 49.31%, 17.59%
[rank3]:2025-10-29 03:32:32,514 - INFO - 	> Batch Time: 293.77 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 03:32:32,514 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:32:32,518 - INFO -  step: 400  loss:  3.1953  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,707  tflops: 99.34  mfu: 31.84%
[rank3]:2025-10-29 03:32:32,519 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 03:32:49,449 - INFO - validate step: 400  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 23,923
[rank0]:2025-10-29 03:32:49,433 - INFO - validate step: 400  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 23,945
[rank2]:2025-10-29 03:32:49,465 - INFO - validate step: 400  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 23,901
[rank3]:2025-10-29 03:32:49,470 - INFO - validate step: 400  loss:  1.0542  memory: 25.20GiB(53.05%)  tps: 24,166
[rank1]:2025-10-29 03:32:49,547 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0332_stage1_step400.svg
[rank0]:2025-10-29 03:32:49,552 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0332_stage0_step400.svg
[rank0]:2025-10-29 03:32:49,600 - INFO - Avg. fwd time: 8.7026 / Avg. bwd time: 7.1671 / Avg. batch time: 394.5407 (ms) / GPU bubble ratio: 67.82%
[rank2]:2025-10-29 03:32:49,547 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0332_stage2_step400.svg
[rank3]:2025-10-29 03:32:49,657 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0332_real_step400_rank3.svg
[rank3]:> Batch Time: 340.66 ms, GPU Bubble Ratio: 80.07%, 29.30%, 46.14%, 18.16%
[rank3]:2025-10-29 03:32:49,728 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0332_stage3_step400.svg
[rank2]:2025-10-29 03:32:49,823 - INFO - Avg. fwd time: 7.8020 / Avg. bwd time: 12.4042 / Avg. batch time: 343.1147 (ms) / GPU bubble ratio: 52.89%
[rank3]:2025-10-29 03:32:49,823 - INFO - Avg. fwd time: 12.9191 / Avg. bwd time: 24.4544 / Avg. batch time: 316.8719 (ms) / GPU bubble ratio: 5.64%
[rank1]:2025-10-29 03:32:49,833 - INFO - Avg. fwd time: 10.1143 / Avg. bwd time: 16.3128 / Avg. batch time: 374.4746 (ms) / GPU bubble ratio: 43.54%
[rank0]:2025-10-29 03:33:52,415 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:33:53,687 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,756  tflops: 99.72  mfu: 31.96%
[rank3]:2025-10-29 03:33:53,688 - INFO -  step: 450  loss:  5.2476  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,757  tflops: 99.73  mfu: 31.96%
[rank0]:2025-10-29 03:33:53,688 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,749  tflops: 99.67  mfu: 31.94%
[rank1]:2025-10-29 03:33:53,689 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,752  tflops: 99.69  mfu: 31.95%
[rank2]:2025-10-29 03:33:53,997 - INFO - Avg. fwd time: 7.7896 / Avg. bwd time: 11.8125 / Avg. batch time: 335.6833 (ms) / GPU bubble ratio: 53.28%
[rank3]:2025-10-29 03:33:53,983 - INFO - Avg. fwd time: 12.9714 / Avg. bwd time: 23.5857 / Avg. batch time: 310.2741 (ms) / GPU bubble ratio: 5.74%
[rank0]:2025-10-29 03:33:54,019 - INFO - Avg. fwd time: 8.6673 / Avg. bwd time: 6.3316 / Avg. batch time: 385.0962 (ms) / GPU bubble ratio: 68.84%
[rank1]:2025-10-29 03:33:54,012 - INFO - Avg. fwd time: 10.1025 / Avg. bwd time: 15.5133 / Avg. batch time: 366.0435 (ms) / GPU bubble ratio: 44.02%
[rank0]:2025-10-29 03:34:56,311 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:34:57,532 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,832  tflops: 100.31  mfu: 32.15%
[rank0]:2025-10-29 03:34:57,532 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,831  tflops: 100.31  mfu: 32.15%
[rank2]:2025-10-29 03:34:57,530 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,832  tflops: 100.31  mfu: 32.15%
[rank2]:2025-10-29 03:34:57,604 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0334_stage2_step500.svg
[rank3]:2025-10-29 03:34:57,531 - INFO -  step: 500  loss:  6.1424  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,832  tflops: 100.31  mfu: 32.15%
[rank1]:2025-10-29 03:34:57,603 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0334_stage1_step500.svg
[rank0]:2025-10-29 03:34:57,604 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0334_stage0_step500.svg
[rank0]:2025-10-29 03:34:57,651 - INFO - Avg. fwd time: 8.6428 / Avg. bwd time: 5.7565 / Avg. batch time: 378.4720 (ms) / GPU bubble ratio: 69.56%
[rank3]:2025-10-29 03:34:57,711 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0334_real_step500_rank3.svg
[rank3]:> Batch Time: 290.14 ms, GPU Bubble Ratio: 76.66%, 45.94%, 58.29%, 14.77%
[rank3]:2025-10-29 03:34:57,775 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0334_stage3_step500.svg
[rank2]:2025-10-29 03:34:57,867 - INFO - Avg. fwd time: 7.7800 / Avg. bwd time: 11.4039 / Avg. batch time: 330.4543 (ms) / GPU bubble ratio: 53.56%
[rank3]:2025-10-29 03:34:57,871 - INFO - Avg. fwd time: 12.9951 / Avg. bwd time: 22.9947 / Avg. batch time: 305.6858 (ms) / GPU bubble ratio: 5.81%
[rank1]:2025-10-29 03:34:57,877 - INFO - Avg. fwd time: 10.0925 / Avg. bwd time: 14.9605 / Avg. batch time: 360.1206 (ms) / GPU bubble ratio: 44.35%
[rank0]:2025-10-29 03:36:00,201 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 03:36:01,447 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,817  tflops: 100.20  mfu: 32.11%
[rank0]:2025-10-29 03:36:01,447 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,817  tflops: 100.20  mfu: 32.11%
[rank2]:2025-10-29 03:36:01,445 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,817  tflops: 100.20  mfu: 32.11%
[rank3]:2025-10-29 03:36:01,446 - INFO -  step: 550  loss:  5.6060  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,817  tflops: 100.20  mfu: 32.12%
[rank0]:2025-10-29 03:36:01,494 - INFO - Avg. fwd time: 8.6187 / Avg. bwd time: 5.2049 / Avg. batch time: 372.0943 (ms) / GPU bubble ratio: 70.28%
[rank2]:2025-10-29 03:36:01,571 - INFO - Avg. fwd time: 7.7712 / Avg. bwd time: 11.0126 / Avg. batch time: 325.4085 (ms) / GPU bubble ratio: 53.82%
[rank3]:2025-10-29 03:36:01,552 - INFO - Avg. fwd time: 13.0221 / Avg. bwd time: 22.4114 / Avg. batch time: 301.1884 (ms) / GPU bubble ratio: 5.88%
[rank1]:2025-10-29 03:36:01,579 - INFO - Avg. fwd time: 10.0836 / Avg. bwd time: 14.4323 / Avg. batch time: 354.4146 (ms) / GPU bubble ratio: 44.66%
[rank0]:2025-10-29 03:37:04,060 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:37:05,642 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0337_rank2_trend_line.svg
[rank2]:2025-10-29 03:37:05,665 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:37:05,667 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,756  tflops: 99.72  mfu: 31.96%
[rank2]:2025-10-29 03:37:05,667 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 03:37:05,656 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0337_rank3_trend_line.svg
[rank0]:2025-10-29 03:37:05,658 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0337_rank0_trend_line.svg
[rank0]:2025-10-29 03:37:05,665 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:37:05,668 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,756  tflops: 99.72  mfu: 31.96%
[rank0]:2025-10-29 03:37:05,668 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 03:37:05,655 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0337_rank1_trend_line.svg
[rank1]:2025-10-29 03:37:05,665 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:37:05,667 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,756  tflops: 99.72  mfu: 31.96%
[rank1]:2025-10-29 03:37:05,668 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 03:37:05,853 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0337_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 286.05 ms, GPU Bubble Ratio: 68.91%, 37.00%, 51.71%, 16.98%
[rank3]:2025-10-29 03:37:05,854 - INFO - 	> Batch Time: 286.05 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 03:37:05,854 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:37:05,859 - INFO -  step: 600  loss:  5.1598  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,718  tflops: 99.43  mfu: 31.87%
[rank3]:2025-10-29 03:37:05,859 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 03:37:22,295 - INFO - validate step: 600  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 24,634
[rank1]:2025-10-29 03:37:22,311 - INFO - validate step: 600  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 24,611
[rank2]:2025-10-29 03:37:22,326 - INFO - validate step: 600  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 24,589
[rank2]:2025-10-29 03:37:22,402 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0337_stage2_step600.svg
[rank3]:2025-10-29 03:37:22,329 - INFO - validate step: 600  loss:  1.1235  memory: 25.20GiB(53.05%)  tps: 24,871
[rank0]:2025-10-29 03:37:22,406 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0337_stage0_step600.svg
[rank1]:2025-10-29 03:37:22,403 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0337_stage1_step600.svg
[rank3]:2025-10-29 03:37:22,508 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0337_real_step600_rank3.svg
[rank3]:> Batch Time: 288.68 ms, GPU Bubble Ratio: 76.58%, 45.77%, 58.12%, 14.82%
[rank3]:2025-10-29 03:37:22,573 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0337_stage3_step600.svg
[rank2]:2025-10-29 03:37:22,856 - INFO - Avg. fwd time: 7.7635 / Avg. bwd time: 10.6896 / Avg. batch time: 321.2834 (ms) / GPU bubble ratio: 54.05%
[rank3]:2025-10-29 03:37:22,842 - INFO - Avg. fwd time: 13.0470 / Avg. bwd time: 21.9320 / Avg. batch time: 297.5158 (ms) / GPU bubble ratio: 5.94%
[rank0]:2025-10-29 03:37:22,881 - INFO - Avg. fwd time: 8.5987 / Avg. bwd time: 4.7499 / Avg. batch time: 366.8727 (ms) / GPU bubble ratio: 70.89%
[rank1]:2025-10-29 03:37:22,872 - INFO - Avg. fwd time: 10.0757 / Avg. bwd time: 13.9957 / Avg. batch time: 349.7457 (ms) / GPU bubble ratio: 44.94%
[rank0]:2025-10-29 03:38:24,923 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:38:26,185 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,828  tflops: 100.29  mfu: 32.14%
[rank3]:2025-10-29 03:38:26,186 - INFO -  step: 650  loss:  4.6402  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,829  tflops: 100.29  mfu: 32.14%
[rank0]:2025-10-29 03:38:26,186 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,822  tflops: 100.24  mfu: 32.13%
[rank0]:2025-10-29 03:38:26,235 - INFO - Avg. fwd time: 8.5852 / Avg. bwd time: 4.4187 / Avg. batch time: 362.9899 (ms) / GPU bubble ratio: 71.34%
[rank1]:2025-10-29 03:38:26,186 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,825  tflops: 100.26  mfu: 32.13%
[rank3]:2025-10-29 03:38:26,293 - INFO - Avg. fwd time: 13.0637 / Avg. bwd time: 21.5805 / Avg. batch time: 294.8111 (ms) / GPU bubble ratio: 5.99%
[rank1]:2025-10-29 03:38:26,320 - INFO - Avg. fwd time: 10.0695 / Avg. bwd time: 13.6770 / Avg. batch time: 346.2646 (ms) / GPU bubble ratio: 45.14%
[rank2]:2025-10-29 03:38:26,310 - INFO - Avg. fwd time: 7.7580 / Avg. bwd time: 10.4543 / Avg. batch time: 318.2019 (ms) / GPU bubble ratio: 54.21%
[rank0]:2025-10-29 03:39:28,653 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:39:29,945 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,848  tflops: 100.44  mfu: 32.19%
[rank3]:2025-10-29 03:39:29,946 - INFO -  step: 700  loss:  4.1714  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,848  tflops: 100.44  mfu: 32.19%
[rank1]:2025-10-29 03:39:29,947 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,848  tflops: 100.44  mfu: 32.19%
[rank1]:2025-10-29 03:39:30,025 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0339_stage1_step700.svg
[rank0]:2025-10-29 03:39:29,947 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,848  tflops: 100.44  mfu: 32.19%
[rank0]:2025-10-29 03:39:30,025 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0339_stage0_step700.svg
[rank2]:2025-10-29 03:39:30,025 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0339_stage2_step700.svg
[rank0]:2025-10-29 03:39:30,074 - INFO - Avg. fwd time: 8.5702 / Avg. bwd time: 4.0864 / Avg. batch time: 359.0697 (ms) / GPU bubble ratio: 71.80%
[rank3]:2025-10-29 03:39:30,124 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0339_real_step700_rank3.svg
[rank3]:> Batch Time: 287.63 ms, GPU Bubble Ratio: 76.52%, 45.68%, 58.02%, 14.85%
[rank3]:2025-10-29 03:39:30,190 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0339_stage3_step700.svg
[rank1]:2025-10-29 03:39:30,295 - INFO - Avg. fwd time: 10.0621 / Avg. bwd time: 13.3557 / Avg. batch time: 342.7486 (ms) / GPU bubble ratio: 45.34%
[rank2]:2025-10-29 03:39:30,285 - INFO - Avg. fwd time: 7.7517 / Avg. bwd time: 10.2171 / Avg. batch time: 315.0901 (ms) / GPU bubble ratio: 54.38%
[rank3]:2025-10-29 03:39:30,286 - INFO - Avg. fwd time: 13.0752 / Avg. bwd time: 21.2311 / Avg. batch time: 292.0796 (ms) / GPU bubble ratio: 6.04%
[rank0]:2025-10-29 03:40:32,673 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:40:33,960 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,797  tflops: 100.04  mfu: 32.06%
[rank3]:2025-10-29 03:40:33,961 - INFO -  step: 750  loss:  3.6686  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,797  tflops: 100.04  mfu: 32.07%
[rank1]:2025-10-29 03:40:33,961 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,797  tflops: 100.04  mfu: 32.06%
[rank0]:2025-10-29 03:40:33,961 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,797  tflops: 100.04  mfu: 32.06%
[rank3]:2025-10-29 03:40:34,256 - INFO - Avg. fwd time: 13.0884 / Avg. bwd time: 20.9315 / Avg. batch time: 289.7649 (ms) / GPU bubble ratio: 6.08%
[rank1]:2025-10-29 03:40:34,288 - INFO - Avg. fwd time: 10.0569 / Avg. bwd time: 13.0809 / Avg. batch time: 339.8130 (ms) / GPU bubble ratio: 45.53%
[rank0]:2025-10-29 03:40:34,296 - INFO - Avg. fwd time: 8.5579 / Avg. bwd time: 3.8006 / Avg. batch time: 355.7900 (ms) / GPU bubble ratio: 72.21%
[rank2]:2025-10-29 03:40:34,271 - INFO - Avg. fwd time: 7.7471 / Avg. bwd time: 10.0142 / Avg. batch time: 312.4978 (ms) / GPU bubble ratio: 54.53%
[rank0]:2025-10-29 03:41:36,811 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:41:38,569 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0341_rank1_trend_line.svg
[rank1]:2025-10-29 03:41:38,577 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:41:38,580 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,678  tflops: 99.11  mfu: 31.77%
[rank1]:2025-10-29 03:41:38,580 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 03:41:38,570 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0341_rank0_trend_line.svg
[rank0]:2025-10-29 03:41:38,577 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:41:38,580 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,677  tflops: 99.11  mfu: 31.76%
[rank0]:2025-10-29 03:41:38,580 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 03:41:38,555 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0341_rank2_trend_line.svg
[rank2]:2025-10-29 03:41:38,577 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:41:38,580 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,677  tflops: 99.10  mfu: 31.76%
[rank2]:2025-10-29 03:41:38,580 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 03:41:38,563 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0341_rank3_trend_line.svg
[rank3]:2025-10-29 03:41:38,762 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0341_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 282.74 ms, GPU Bubble Ratio: 70.42%, 38.65%, 52.88%, 16.64%
[rank3]:2025-10-29 03:41:38,762 - INFO - 	> Batch Time: 282.74 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 03:41:38,763 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:41:38,768 - INFO -  step: 800  loss:  3.1881  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,641  tflops: 98.82  mfu: 31.67%
[rank3]:2025-10-29 03:41:38,768 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 03:41:54,710 - INFO - validate step: 800  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 25,394
[rank0]:2025-10-29 03:41:54,711 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 03:41:54,720 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 03:41:54,741 - INFO - validate step: 800  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 25,345
[rank2]:2025-10-29 03:41:54,742 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 03:41:54,746 - INFO - validate step: 800  loss:  1.0599  memory: 25.20GiB(53.05%)  tps: 25,639
[rank3]:2025-10-29 03:41:54,748 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:41:54,726 - INFO - validate step: 800  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 25,370
[rank1]:2025-10-29 03:41:54,726 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 03:41:56,664 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.92 seconds.
[rank1]:2025-10-29 03:41:57,085 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.36 seconds.
[rank3]:2025-10-29 03:41:58,328 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.58 seconds.
[rank0]:2025-10-29 03:41:58,641 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 03:41:58,648 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.94 seconds.
[rank2]:2025-10-29 03:41:58,734 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0341_stage2_step800.svg
[rank1]:2025-10-29 03:41:58,733 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0341_stage1_step800.svg
[rank0]:2025-10-29 03:41:58,937 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0341_stage0_step800.svg
[rank3]:2025-10-29 03:41:58,974 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0341_real_step800_rank3.svg
[rank3]:> Batch Time: 287.22 ms, GPU Bubble Ratio: 76.51%, 45.65%, 58.00%, 14.86%
[rank0]:2025-10-29 03:41:59,046 - INFO - Avg. fwd time: 8.5489 / Avg. bwd time: 3.5856 / Avg. batch time: 353.3454 (ms) / GPU bubble ratio: 72.53%
[rank3]:2025-10-29 03:41:59,089 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0341_stage3_step800.svg
[rank2]:2025-10-29 03:41:59,188 - INFO - Avg. fwd time: 7.7434 / Avg. bwd time: 9.8609 / Avg. batch time: 310.5748 (ms) / GPU bubble ratio: 54.65%
[rank3]:2025-10-29 03:41:59,217 - INFO - Avg. fwd time: 13.0938 / Avg. bwd time: 20.7190 / Avg. batch time: 288.0897 (ms) / GPU bubble ratio: 6.10%
[rank1]:2025-10-29 03:41:59,354 - INFO - Avg. fwd time: 10.0530 / Avg. bwd time: 12.8729 / Avg. batch time: 337.6293 (ms) / GPU bubble ratio: 45.68%
[rank3]:2025-10-29 03:42:13,492 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 03:42:13,703 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 03:42:13,704 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 03:42:13,692 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 03:43:01,804 - INFO - [GC] Peforming periodical GC collection 0.29 seconds
[rank1]:2025-10-29 03:43:03,090 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 11,983  tflops: 93.68  mfu: 30.02%
[rank0]:2025-10-29 03:43:03,090 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 11,980  tflops: 93.66  mfu: 30.02%
[rank2]:2025-10-29 03:43:03,089 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 11,986  tflops: 93.70  mfu: 30.03%
[rank3]:2025-10-29 03:43:03,090 - INFO -  step: 850  loss:  4.5518  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 11,987  tflops: 93.71  mfu: 30.03%
[rank0]:2025-10-29 03:43:03,136 - INFO - Avg. fwd time: 8.5411 / Avg. bwd time: 3.3637 / Avg. batch time: 350.8039 (ms) / GPU bubble ratio: 72.85%
[rank2]:2025-10-29 03:43:03,212 - INFO - Avg. fwd time: 7.7400 / Avg. bwd time: 9.7034 / Avg. batch time: 308.5552 (ms) / GPU bubble ratio: 54.77%
[rank3]:2025-10-29 03:43:03,195 - INFO - Avg. fwd time: 13.1021 / Avg. bwd time: 20.4875 / Avg. batch time: 286.2972 (ms) / GPU bubble ratio: 6.14%
[rank1]:2025-10-29 03:43:03,221 - INFO - Avg. fwd time: 10.0495 / Avg. bwd time: 12.6599 / Avg. batch time: 335.3466 (ms) / GPU bubble ratio: 45.82%
[rank0]:2025-10-29 03:44:05,677 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:44:06,901 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,838  tflops: 100.36  mfu: 32.17%
[rank2]:2025-10-29 03:44:06,900 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,838  tflops: 100.36  mfu: 32.17%
[rank3]:2025-10-29 03:44:06,901 - INFO -  step: 900  loss:  6.0942  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,839  tflops: 100.37  mfu: 32.17%
[rank1]:2025-10-29 03:44:06,902 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,838  tflops: 100.36  mfu: 32.17%
[rank1]:2025-10-29 03:44:06,974 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0344_stage1_step900.svg
[rank0]:2025-10-29 03:44:06,974 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0344_stage0_step900.svg
[rank2]:2025-10-29 03:44:06,974 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0344_stage2_step900.svg
[rank3]:2025-10-29 03:44:07,084 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0344_real_step900_rank3.svg
[rank3]:> Batch Time: 286.83 ms, GPU Bubble Ratio: 76.49%, 45.61%, 57.97%, 14.88%
[rank3]:2025-10-29 03:44:07,147 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0344_stage3_step900.svg
[rank2]:2025-10-29 03:44:07,418 - INFO - Avg. fwd time: 7.7364 / Avg. bwd time: 9.5637 / Avg. batch time: 306.8030 (ms) / GPU bubble ratio: 54.89%
[rank3]:2025-10-29 03:44:07,402 - INFO - Avg. fwd time: 13.1125 / Avg. bwd time: 20.2832 / Avg. batch time: 284.7304 (ms) / GPU bubble ratio: 6.17%
[rank1]:2025-10-29 03:44:07,435 - INFO - Avg. fwd time: 10.0460 / Avg. bwd time: 12.4714 / Avg. batch time: 333.3601 (ms) / GPU bubble ratio: 45.96%
[rank0]:2025-10-29 03:44:07,444 - INFO - Avg. fwd time: 8.5321 / Avg. bwd time: 3.1677 / Avg. batch time: 348.5793 (ms) / GPU bubble ratio: 73.15%
[rank0]:2025-10-29 03:45:09,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:45:11,021 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,776  tflops: 99.88  mfu: 32.01%
[rank1]:2025-10-29 03:45:11,023 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,776  tflops: 99.88  mfu: 32.01%
[rank3]:2025-10-29 03:45:11,022 - INFO -  step: 950  loss:  5.6552  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,776  tflops: 99.88  mfu: 32.01%
[rank0]:2025-10-29 03:45:11,023 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,776  tflops: 99.88  mfu: 32.01%
[rank0]:2025-10-29 03:45:11,071 - INFO - Avg. fwd time: 8.5260 / Avg. bwd time: 3.0170 / Avg. batch time: 346.8773 (ms) / GPU bubble ratio: 73.38%
[rank3]:2025-10-29 03:45:11,130 - INFO - Avg. fwd time: 13.1223 / Avg. bwd time: 20.1297 / Avg. batch time: 283.5686 (ms) / GPU bubble ratio: 6.19%
[rank2]:2025-10-29 03:45:11,148 - INFO - Avg. fwd time: 7.7345 / Avg. bwd time: 9.4575 / Avg. batch time: 305.4658 (ms) / GPU bubble ratio: 54.98%
[rank1]:2025-10-29 03:45:11,157 - INFO - Avg. fwd time: 10.0442 / Avg. bwd time: 12.3277 / Avg. batch time: 331.8427 (ms) / GPU bubble ratio: 46.07%
[rank0]:2025-10-29 03:46:14,131 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:46:15,411 - INFO -  step: 1000  loss:  5.1620  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,723  tflops: 99.46  mfu: 31.88%
[rank3]:2025-10-29 03:46:15,411 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 03:46:15,411 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,723  tflops: 99.46  mfu: 31.88%
[rank0]:2025-10-29 03:46:15,412 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 03:46:15,412 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,723  tflops: 99.46  mfu: 31.88%
[rank1]:2025-10-29 03:46:15,412 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 03:46:15,410 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,723  tflops: 99.46  mfu: 31.88%
[rank2]:2025-10-29 03:46:15,410 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 03:46:31,191 - INFO - validate step: 1000  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 25,959
[rank1]:2025-10-29 03:46:31,208 - INFO - validate step: 1000  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 25,932
[rank2]:2025-10-29 03:46:31,223 - INFO - validate step: 1000  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 25,903
[rank3]:2025-10-29 03:46:31,226 - INFO - validate step: 1000  loss:  1.1124  memory: 25.20GiB(53.05%)  tps: 25,902
[rank0]:2025-10-29 03:46:31,303 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0346_stage0_step1000.svg
[rank1]:2025-10-29 03:46:31,308 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0346_stage1_step1000.svg
[rank2]:2025-10-29 03:46:31,303 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0346_stage2_step1000.svg
[rank0]:2025-10-29 03:46:31,353 - INFO - Avg. fwd time: 8.5193 / Avg. bwd time: 2.8583 / Avg. batch time: 345.1427 (ms) / GPU bubble ratio: 73.63%
[rank3]:2025-10-29 03:46:31,408 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0346_real_step1000_rank3.svg
[rank3]:> Batch Time: 286.79 ms, GPU Bubble Ratio: 76.49%, 45.62%, 57.98%, 14.87%
[rank3]:2025-10-29 03:46:31,487 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0346_stage3_step1000.svg
[rank1]:2025-10-29 03:46:31,595 - INFO - Avg. fwd time: 10.0412 / Avg. bwd time: 12.1739 / Avg. batch time: 330.3025 (ms) / GPU bubble ratio: 46.19%
[rank2]:2025-10-29 03:46:31,584 - INFO - Avg. fwd time: 7.7318 / Avg. bwd time: 9.3442 / Avg. batch time: 304.1203 (ms) / GPU bubble ratio: 55.08%
[rank3]:2025-10-29 03:46:31,590 - INFO - Avg. fwd time: 13.1255 / Avg. bwd time: 19.9836 / Avg. batch time: 282.4105 (ms) / GPU bubble ratio: 6.21%
[rank0]:2025-10-29 03:47:34,265 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 03:47:35,542 - INFO -  step: 1050  loss:  4.6639  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,738  tflops: 99.58  mfu: 31.92%
[rank0]:2025-10-29 03:47:35,543 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,730  tflops: 99.52  mfu: 31.90%
[rank1]:2025-10-29 03:47:35,543 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,733  tflops: 99.54  mfu: 31.91%
[rank2]:2025-10-29 03:47:35,541 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,737  tflops: 99.57  mfu: 31.91%
[rank0]:2025-10-29 03:47:35,903 - INFO - Avg. fwd time: 8.5136 / Avg. bwd time: 2.7155 / Avg. batch time: 343.5756 (ms) / GPU bubble ratio: 73.85%
[rank1]:2025-10-29 03:47:35,893 - INFO - Avg. fwd time: 10.0387 / Avg. bwd time: 12.0368 / Avg. batch time: 328.9065 (ms) / GPU bubble ratio: 46.31%
[rank2]:2025-10-29 03:47:35,875 - INFO - Avg. fwd time: 7.7294 / Avg. bwd time: 9.2427 / Avg. batch time: 302.8961 (ms) / GPU bubble ratio: 55.17%
[rank3]:2025-10-29 03:47:35,858 - INFO - Avg. fwd time: 13.1324 / Avg. bwd time: 19.8413 / Avg. batch time: 281.3151 (ms) / GPU bubble ratio: 6.23%
[rank0]:2025-10-29 03:48:37,915 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:48:39,231 - INFO -  step: 1100  loss:  4.1424  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,863  tflops: 100.56  mfu: 32.23%
[rank0]:2025-10-29 03:48:39,232 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,863  tflops: 100.55  mfu: 32.23%
[rank1]:2025-10-29 03:48:39,232 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,863  tflops: 100.55  mfu: 32.23%
[rank2]:2025-10-29 03:48:39,230 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,863  tflops: 100.55  mfu: 32.23%
[rank0]:2025-10-29 03:48:39,308 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0348_stage0_step1100.svg
[rank1]:2025-10-29 03:48:39,309 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0348_stage1_step1100.svg
[rank0]:2025-10-29 03:48:39,358 - INFO - Avg. fwd time: 8.5084 / Avg. bwd time: 2.6040 / Avg. batch time: 342.2256 (ms) / GPU bubble ratio: 74.02%
[rank2]:2025-10-29 03:48:39,309 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0348_stage2_step1100.svg
[rank3]:2025-10-29 03:48:39,412 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0348_real_step1100_rank3.svg
[rank3]:> Batch Time: 286.50 ms, GPU Bubble Ratio: 76.48%, 45.60%, 57.96%, 14.88%
[rank3]:2025-10-29 03:48:39,476 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0348_stage3_step1100.svg
[rank1]:2025-10-29 03:48:39,586 - INFO - Avg. fwd time: 10.0365 / Avg. bwd time: 11.9297 / Avg. batch time: 327.6931 (ms) / GPU bubble ratio: 46.37%
[rank2]:2025-10-29 03:48:39,578 - INFO - Avg. fwd time: 7.7273 / Avg. bwd time: 9.1633 / Avg. batch time: 301.8173 (ms) / GPU bubble ratio: 55.23%
[rank3]:2025-10-29 03:48:39,580 - INFO - Avg. fwd time: 13.1387 / Avg. bwd time: 19.7177 / Avg. batch time: 280.3686 (ms) / GPU bubble ratio: 6.25%
[rank0]:2025-10-29 03:49:41,833 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:49:43,132 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,820  tflops: 100.22  mfu: 32.12%
[rank1]:2025-10-29 03:49:43,132 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,820  tflops: 100.22  mfu: 32.12%
[rank2]:2025-10-29 03:49:43,130 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,820  tflops: 100.22  mfu: 32.12%
[rank3]:2025-10-29 03:49:43,131 - INFO -  step: 1150  loss:  3.6875  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,820  tflops: 100.22  mfu: 32.12%
[rank0]:2025-10-29 03:49:43,181 - INFO - Avg. fwd time: 8.5025 / Avg. bwd time: 2.4850 / Avg. batch time: 340.8254 (ms) / GPU bubble ratio: 74.21%
[rank1]:2025-10-29 03:49:43,271 - INFO - Avg. fwd time: 10.0338 / Avg. bwd time: 11.8150 / Avg. batch time: 326.4383 (ms) / GPU bubble ratio: 46.46%
[rank2]:2025-10-29 03:49:43,265 - INFO - Avg. fwd time: 7.7248 / Avg. bwd time: 9.0782 / Avg. batch time: 300.7067 (ms) / GPU bubble ratio: 55.30%
[rank3]:2025-10-29 03:49:43,244 - INFO - Avg. fwd time: 13.1457 / Avg. bwd time: 19.5869 / Avg. batch time: 279.3692 (ms) / GPU bubble ratio: 6.27%
[rank0]:2025-10-29 03:50:45,670 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:50:46,965 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,834  tflops: 100.33  mfu: 32.16%
[rank1]:2025-10-29 03:50:46,965 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 03:50:46,963 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,834  tflops: 100.33  mfu: 32.16%
[rank2]:2025-10-29 03:50:46,964 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 03:50:46,964 - INFO -  step: 1200  loss:  3.1730  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,834  tflops: 100.33  mfu: 32.16%
[rank3]:2025-10-29 03:50:46,965 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 03:50:46,965 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,834  tflops: 100.33  mfu: 32.16%
[rank0]:2025-10-29 03:50:46,965 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 03:51:02,749 - INFO - validate step: 1200  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 25,951
[rank1]:2025-10-29 03:51:02,766 - INFO - validate step: 1200  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 25,923
[rank2]:2025-10-29 03:51:02,782 - INFO - validate step: 1200  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 25,895
[rank3]:2025-10-29 03:51:02,786 - INFO - validate step: 1200  loss:  1.0809  memory: 25.20GiB(53.05%)  tps: 25,891
[rank0]:2025-10-29 03:51:02,867 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0351_stage0_step1200.svg
[rank1]:2025-10-29 03:51:02,866 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0351_stage1_step1200.svg
[rank2]:2025-10-29 03:51:02,866 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0351_stage2_step1200.svg
[rank3]:2025-10-29 03:51:02,969 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0351_real_step1200_rank3.svg
[rank3]:> Batch Time: 286.28 ms, GPU Bubble Ratio: 76.47%, 45.58%, 57.95%, 14.89%
[rank3]:2025-10-29 03:51:03,036 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0351_stage3_step1200.svg
[rank3]:2025-10-29 03:51:03,309 - INFO - Avg. fwd time: 13.1506 / Avg. bwd time: 19.4744 / Avg. batch time: 278.4989 (ms) / GPU bubble ratio: 6.28%
[rank0]:2025-10-29 03:51:03,354 - INFO - Avg. fwd time: 8.4978 / Avg. bwd time: 2.3764 / Avg. batch time: 339.5948 (ms) / GPU bubble ratio: 74.38%
[rank1]:2025-10-29 03:51:03,344 - INFO - Avg. fwd time: 10.0324 / Avg. bwd time: 11.7111 / Avg. batch time: 325.3389 (ms) / GPU bubble ratio: 46.53%
[rank2]:2025-10-29 03:51:03,326 - INFO - Avg. fwd time: 7.7231 / Avg. bwd time: 9.0011 / Avg. batch time: 299.7369 (ms) / GPU bubble ratio: 55.36%
[rank0]:2025-10-29 03:52:05,903 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 03:52:07,170 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,720  tflops: 99.44  mfu: 31.87%
[rank2]:2025-10-29 03:52:07,168 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,723  tflops: 99.46  mfu: 31.88%
[rank3]:2025-10-29 03:52:07,169 - INFO -  step: 1250  loss:  4.9655  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,724  tflops: 99.47  mfu: 31.88%
[rank0]:2025-10-29 03:52:07,171 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,716  tflops: 99.41  mfu: 31.86%
[rank0]:2025-10-29 03:52:07,222 - INFO - Avg. fwd time: 8.4940 / Avg. bwd time: 2.2906 / Avg. batch time: 338.6099 (ms) / GPU bubble ratio: 74.52%
[rank3]:2025-10-29 03:52:07,281 - INFO - Avg. fwd time: 13.1509 / Avg. bwd time: 19.3913 / Avg. batch time: 277.8277 (ms) / GPU bubble ratio: 6.30%
[rank1]:2025-10-29 03:52:07,308 - INFO - Avg. fwd time: 10.0306 / Avg. bwd time: 11.6276 / Avg. batch time: 324.4583 (ms) / GPU bubble ratio: 46.60%
[rank2]:2025-10-29 03:52:07,296 - INFO - Avg. fwd time: 7.7213 / Avg. bwd time: 8.9395 / Avg. batch time: 298.9609 (ms) / GPU bubble ratio: 55.42%
[rank0]:2025-10-29 03:53:09,948 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:53:11,187 - INFO -  step: 1300  loss:  6.0283  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,797  tflops: 100.04  mfu: 32.06%
[rank0]:2025-10-29 03:53:11,188 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,797  tflops: 100.04  mfu: 32.06%
[rank1]:2025-10-29 03:53:11,188 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,796  tflops: 100.04  mfu: 32.06%
[rank2]:2025-10-29 03:53:11,186 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,797  tflops: 100.04  mfu: 32.06%
[rank2]:2025-10-29 03:53:11,279 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0353_stage2_step1300.svg
[rank0]:2025-10-29 03:53:11,279 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0353_stage0_step1300.svg
[rank0]:2025-10-29 03:53:11,329 - INFO - Avg. fwd time: 8.4907 / Avg. bwd time: 2.1980 / Avg. batch time: 337.5898 (ms) / GPU bubble ratio: 74.67%
[rank1]:2025-10-29 03:53:11,279 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0353_stage1_step1300.svg
[rank3]:2025-10-29 03:53:11,388 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0353_real_step1300_rank3.svg
[rank3]:> Batch Time: 286.29 ms, GPU Bubble Ratio: 76.48%, 45.59%, 57.96%, 14.88%
[rank3]:2025-10-29 03:53:11,457 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0353_stage3_step1300.svg
[rank1]:2025-10-29 03:53:11,564 - INFO - Avg. fwd time: 10.0298 / Avg. bwd time: 11.5390 / Avg. batch time: 323.5499 (ms) / GPU bubble ratio: 46.67%
[rank2]:2025-10-29 03:53:11,553 - INFO - Avg. fwd time: 7.7202 / Avg. bwd time: 8.8740 / Avg. batch time: 298.1637 (ms) / GPU bubble ratio: 55.48%
[rank3]:2025-10-29 03:53:11,557 - INFO - Avg. fwd time: 13.1537 / Avg. bwd time: 19.3039 / Avg. batch time: 277.1426 (ms) / GPU bubble ratio: 6.31%
[rank0]:2025-10-29 03:54:14,235 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:54:15,507 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,737  tflops: 99.57  mfu: 31.91%
[rank1]:2025-10-29 03:54:15,507 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,737  tflops: 99.57  mfu: 31.91%
[rank2]:2025-10-29 03:54:15,505 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,737  tflops: 99.57  mfu: 31.91%
[rank3]:2025-10-29 03:54:15,506 - INFO -  step: 1350  loss:  5.5887  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,737  tflops: 99.57  mfu: 31.91%
[rank1]:2025-10-29 03:54:15,851 - INFO - Avg. fwd time: 10.0282 / Avg. bwd time: 11.4566 / Avg. batch time: 322.7191 (ms) / GPU bubble ratio: 46.74%
[rank2]:2025-10-29 03:54:15,831 - INFO - Avg. fwd time: 7.7186 / Avg. bwd time: 8.8131 / Avg. batch time: 297.4350 (ms) / GPU bubble ratio: 55.54%
[rank3]:2025-10-29 03:54:15,812 - INFO - Avg. fwd time: 13.1599 / Avg. bwd time: 19.2168 / Avg. batch time: 276.4886 (ms) / GPU bubble ratio: 6.32%
[rank0]:2025-10-29 03:54:15,861 - INFO - Avg. fwd time: 8.4867 / Avg. bwd time: 2.1126 / Avg. batch time: 336.6558 (ms) / GPU bubble ratio: 74.81%
[rank0]:2025-10-29 03:55:18,402 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:55:19,669 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,768  tflops: 99.81  mfu: 31.99%
[rank0]:2025-10-29 03:55:19,669 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 03:55:19,669 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,768  tflops: 99.81  mfu: 31.99%
[rank1]:2025-10-29 03:55:19,669 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 03:55:19,667 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,768  tflops: 99.81  mfu: 31.99%
[rank2]:2025-10-29 03:55:19,667 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 03:55:19,668 - INFO -  step: 1400  loss:  5.1675  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,768  tflops: 99.81  mfu: 31.99%
[rank3]:2025-10-29 03:55:19,669 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 03:55:35,639 - INFO - validate step: 1400  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 25,648
[rank1]:2025-10-29 03:55:35,656 - INFO - validate step: 1400  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 25,621
[rank2]:2025-10-29 03:55:35,672 - INFO - validate step: 1400  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 25,593
[rank3]:2025-10-29 03:55:35,676 - INFO - validate step: 1400  loss:  1.0695  memory: 25.20GiB(53.05%)  tps: 25,590
[rank1]:2025-10-29 03:55:35,760 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0355_stage1_step1400.svg
[rank2]:2025-10-29 03:55:35,760 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0355_stage2_step1400.svg
[rank0]:2025-10-29 03:55:35,761 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0355_stage0_step1400.svg
[rank0]:2025-10-29 03:55:35,813 - INFO - Avg. fwd time: 8.4843 / Avg. bwd time: 2.0446 / Avg. batch time: 335.9177 (ms) / GPU bubble ratio: 74.93%
[rank3]:2025-10-29 03:55:35,863 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0355_real_step1400_rank3.svg
[rank3]:> Batch Time: 286.26 ms, GPU Bubble Ratio: 76.48%, 45.59%, 57.96%, 14.88%
[rank3]:2025-10-29 03:55:35,951 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0355_stage3_step1400.svg
[rank1]:2025-10-29 03:55:36,062 - INFO - Avg. fwd time: 10.0277 / Avg. bwd time: 11.3917 / Avg. batch time: 322.0644 (ms) / GPU bubble ratio: 46.79%
[rank2]:2025-10-29 03:55:36,051 - INFO - Avg. fwd time: 7.7179 / Avg. bwd time: 8.7651 / Avg. batch time: 296.8615 (ms) / GPU bubble ratio: 55.58%
[rank3]:2025-10-29 03:55:36,058 - INFO - Avg. fwd time: 13.1654 / Avg. bwd time: 19.1505 / Avg. batch time: 275.9975 (ms) / GPU bubble ratio: 6.33%
[rank0]:2025-10-29 03:56:38,860 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 03:56:40,145 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,703  tflops: 99.31  mfu: 31.83%
[rank2]:2025-10-29 03:56:40,143 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,707  tflops: 99.33  mfu: 31.84%
[rank3]:2025-10-29 03:56:40,144 - INFO -  step: 1450  loss:  4.6693  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,707  tflops: 99.34  mfu: 31.84%
[rank0]:2025-10-29 03:56:40,145 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,700  tflops: 99.28  mfu: 31.82%
[rank0]:2025-10-29 03:56:40,195 - INFO - Avg. fwd time: 8.4812 / Avg. bwd time: 1.9705 / Avg. batch time: 335.1207 (ms) / GPU bubble ratio: 75.05%
[rank3]:2025-10-29 03:56:40,258 - INFO - Avg. fwd time: 13.1702 / Avg. bwd time: 19.0768 / Avg. batch time: 275.4414 (ms) / GPU bubble ratio: 6.34%
[rank1]:2025-10-29 03:56:40,284 - INFO - Avg. fwd time: 10.0265 / Avg. bwd time: 11.3203 / Avg. batch time: 321.3570 (ms) / GPU bubble ratio: 46.86%
[rank2]:2025-10-29 03:56:40,274 - INFO - Avg. fwd time: 7.7167 / Avg. bwd time: 8.7125 / Avg. batch time: 296.2430 (ms) / GPU bubble ratio: 55.63%
[rank0]:2025-10-29 03:57:43,014 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:57:44,325 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,764  tflops: 99.78  mfu: 31.98%
[rank2]:2025-10-29 03:57:44,323 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,764  tflops: 99.78  mfu: 31.98%
[rank3]:2025-10-29 03:57:44,324 - INFO -  step: 1500  loss:  4.1672  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,765  tflops: 99.79  mfu: 31.98%
[rank0]:2025-10-29 03:57:44,325 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,764  tflops: 99.78  mfu: 31.98%
[rank0]:2025-10-29 03:57:44,409 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0357_stage0_step1500.svg
[rank1]:2025-10-29 03:57:44,410 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0357_stage1_step1500.svg
[rank2]:2025-10-29 03:57:44,410 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0357_stage2_step1500.svg
[rank3]:2025-10-29 03:57:44,508 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0357_real_step1500_rank3.svg
[rank3]:> Batch Time: 286.25 ms, GPU Bubble Ratio: 76.47%, 45.60%, 57.97%, 14.88%
[rank3]:2025-10-29 03:57:44,577 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0357_stage3_step1500.svg
[rank3]:2025-10-29 03:57:44,847 - INFO - Avg. fwd time: 13.1738 / Avg. bwd time: 19.0108 / Avg. batch time: 274.9357 (ms) / GPU bubble ratio: 6.35%
[rank0]:2025-10-29 03:57:44,896 - INFO - Avg. fwd time: 8.4786 / Avg. bwd time: 1.9016 / Avg. batch time: 334.3895 (ms) / GPU bubble ratio: 75.17%
[rank1]:2025-10-29 03:57:44,886 - INFO - Avg. fwd time: 10.0257 / Avg. bwd time: 11.2542 / Avg. batch time: 320.7087 (ms) / GPU bubble ratio: 46.92%
[rank2]:2025-10-29 03:57:44,866 - INFO - Avg. fwd time: 7.7158 / Avg. bwd time: 8.6638 / Avg. batch time: 295.6767 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-10-29 03:58:47,059 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:58:48,361 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,793  tflops: 100.01  mfu: 32.05%
[rank1]:2025-10-29 03:58:48,361 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,793  tflops: 100.01  mfu: 32.05%
[rank2]:2025-10-29 03:58:48,359 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,793  tflops: 100.01  mfu: 32.05%
[rank3]:2025-10-29 03:58:48,360 - INFO -  step: 1550  loss:  3.6636  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,793  tflops: 100.01  mfu: 32.05%
[rank0]:2025-10-29 03:58:48,412 - INFO - Avg. fwd time: 8.4760 / Avg. bwd time: 1.8463 / Avg. batch time: 333.7213 (ms) / GPU bubble ratio: 75.26%
[rank1]:2025-10-29 03:58:48,502 - INFO - Avg. fwd time: 10.0243 / Avg. bwd time: 11.2004 / Avg. batch time: 320.1082 (ms) / GPU bubble ratio: 46.96%
[rank2]:2025-10-29 03:58:48,492 - INFO - Avg. fwd time: 7.7146 / Avg. bwd time: 8.6242 / Avg. batch time: 295.1445 (ms) / GPU bubble ratio: 55.71%
[rank3]:2025-10-29 03:58:48,476 - INFO - Avg. fwd time: 13.1740 / Avg. bwd time: 18.9535 / Avg. batch time: 274.4737 (ms) / GPU bubble ratio: 6.36%
[rank0]:2025-10-29 03:59:51,122 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:59:53,280 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0359_rank0_trend_line.svg
[rank2]:2025-10-29 03:59:53,263 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0359_rank2_trend_line.svg
[rank2]:2025-10-29 03:59:53,304 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:59:53,308 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 12.98GiB(27.32%)  tps: 12,613  tflops: 98.60  mfu: 31.60%
[rank2]:2025-10-29 03:59:53,308 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.0000  tps: 12,220  tflops: 95.53  mfu: 29.66%
[rank2]:2025-10-29 03:59:53,308 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 03:59:53,268 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0359_rank1_trend_line.svg
[rank1]:2025-10-29 03:59:53,304 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:59:53,308 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 16.11GiB(33.90%)  tps: 12,613  tflops: 98.61  mfu: 31.60%
[rank1]:2025-10-29 03:59:53,308 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.0000  tps: 12,220  tflops: 95.53  mfu: 29.66%
[rank1]:2025-10-29 03:59:53,309 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 03:59:53,296 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0359_rank3_trend_line.svg
[rank0]:2025-10-29 03:59:53,304 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:59:53,309 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 17.74GiB(37.35%)  tps: 12,613  tflops: 98.61  mfu: 31.60%
[rank0]:2025-10-29 03:59:53,309 - INFO -  final step: 1600  loss: -4.0000  grad_norm:  0.0000  tps: 12,220  tflops: 95.53  mfu: 29.66%
[rank0]:2025-10-29 03:59:53,309 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 03:59:53,482 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0359_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 279.11 ms, GPU Bubble Ratio: 72.54%, 41.03%, 54.58%, 16.13%
[rank3]:2025-10-29 03:59:53,482 - INFO - 	> Batch Time: 279.11 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-29 03:59:53,484 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:59:53,489 - INFO -  step: 1600  loss:  3.1632  grad_norm:  0.0000  memory: 25.20GiB(53.05%)  tps: 12,578  tflops: 98.33  mfu: 31.52%
[rank3]:2025-10-29 03:59:53,490 - INFO -  final step: 1600  loss:  3.1632  grad_norm:  0.0000  tps: 12,229  tflops: 95.60  mfu: 29.66%
[rank3]:2025-10-29 03:59:53,490 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 04:00:14,012 - INFO - validate step: 1600  loss: -1.0000  memory: 17.74GiB(37.35%)  tps: 19,784
[rank0]:2025-10-29 04:00:14,013 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:00:14,016 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-29 04:00:14,026 - INFO - validate step: 1600  loss: -1.0000  memory: 16.11GiB(33.90%)  tps: 19,771
[rank1]:2025-10-29 04:00:14,027 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 04:00:14,029 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-29 04:00:14,044 - INFO - validate step: 1600  loss:  1.1162  memory: 25.20GiB(53.05%)  tps: 19,929
[rank3]:2025-10-29 04:00:14,046 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:00:14,048 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-29 04:00:14,043 - INFO - validate step: 1600  loss: -1.0000  memory: 12.98GiB(27.32%)  tps: 19,754
[rank2]:2025-10-29 04:00:14,044 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:00:14,046 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-29 04:00:16,991 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 04:00:17,085 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0400_stage0_final1600.svg
[rank2]:2025-10-29 04:00:17,083 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0400_stage2_final1600.svg
[rank1]:2025-10-29 04:00:17,085 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0400_stage1_final1600.svg
[rank3]:2025-10-29 04:00:17,175 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0400_real_final1600_rank3.svg
[rank3]:> Batch Time: 286.10 ms, GPU Bubble Ratio: 76.46%, 45.58%, 57.96%, 14.89%
[rank0]:2025-10-29 04:00:17,300 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0400_rank0_stage0.svg
[rank0]:	> Counts Sum: 1567800, Total Sum: 1811520 (86.55%), Ratio(%) per element: [86.68, 86.51, 86.35, 86.43, 86.27, 86.51, 86.19, 86.68, 86.35, 86.35, 86.27, 86.6, 86.51, 86.43, 86.6, 86.43, 86.43, 86.6, 86.6, 86.51, 86.76, 86.51, 86.68, 86.68, 86.76, 86.43, 86.6, 86.92, 86.68, 86.6, 86.43, 86.6, 86.51, 86.51, 86.84, 86.51, 86.68]
[rank0]:2025-10-29 04:00:17,300 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 04:00:17,301 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0400_rank2_stage2.svg
[rank2]:	> Counts Sum: 1516360, Total Sum: 1762560 (86.03%), Ratio(%) per element: [85.62, 85.86, 85.37, 85.86, 85.53, 85.53, 85.53, 85.53, 85.94, 85.94, 85.53, 85.62, 85.86, 86.02, 85.94, 86.19, 85.62, 85.94, 86.27, 86.51, 86.02, 85.94, 86.43, 86.19, 86.35, 86.19, 86.19, 86.35, 86.11, 86.51, 86.51, 86.51, 86.43, 86.43, 86.27, 86.27]
[rank2]:2025-10-29 04:00:17,301 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 04:00:17,291 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0400_rank1_stage1.svg
[rank1]:	> Counts Sum: 1905160, Total Sum: 2203200 (86.47%), Ratio(%) per element: [86.51, 86.19, 86.11, 85.94, 86.35, 86.27, 86.27, 85.86, 85.94, 86.76, 86.51, 86.35, 86.11, 86.35, 86.51, 86.51, 86.51, 86.35, 86.68, 86.68, 86.27, 86.43, 86.6, 86.43, 86.35, 86.43, 86.51, 86.51, 86.27, 86.68, 86.43, 86.51, 86.68, 86.92, 86.6, 86.68, 86.6, 86.68, 86.51, 86.6, 86.84, 86.68, 86.76, 86.51, 86.76]
[rank1]:2025-10-29 04:00:17,292 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 04:00:17,355 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0400_thry_final1600_rank3.svg
[rank3]:> Batch Time: 323.53 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-10-29 04:00:17,364 - INFO - Process group destroyed
[rank1]:2025-10-29 04:00:17,356 - INFO - Process group destroyed
[rank3]:2025-10-29 04:00:17,425 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0400_stage3_final1600.svg
[rank3]:2025-10-29 04:00:17,605 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0400_rank3_stage3.svg
[rank3]:	> Counts Sum: 34880, Total Sum: 1419840 (2.46%), Ratio(%) per element: [1.47, 1.55, 1.87, 1.79, 1.47, 1.71, 1.71, 1.71, 1.47, 2.45, 2.36, 2.69, 2.45, 2.28, 2.69, 2.28, 2.69, 2.2, 3.02, 3.18, 3.02, 3.18, 3.34, 2.94, 3.34, 3.51, 2.69, 3.26, 2.77]
[rank3]:2025-10-29 04:00:17,606 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–ˆâ–„â–ƒâ–ƒâ–‚â–‚â–â–ƒâ–„â–ƒâ–ƒâ–‚â–‚â–‚â–â–‚â–„â–ƒâ–ƒâ–‚â–‚â–‚â–â–ƒâ–„â–ƒâ–ƒâ–ƒâ–‚â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ˆâ–„â–ƒâ–ƒâ–‚â–‚â–â–ƒâ–„â–ƒâ–ƒâ–‚â–‚â–‚â–â–‚â–„â–ƒâ–ƒâ–‚â–‚â–‚â–â–ƒâ–„â–ƒâ–ƒâ–ƒâ–‚â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.33979
[rank3]:wandb:               final/avg_loss 3.16324
[rank3]:wandb:             final/avg_mfu(%) 29.65751
[rank3]:wandb:             final/avg_tflops 95.59916
[rank3]:wandb:    final/avg_throughput(tps) 12228.80358
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 3.16324
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 3.16324
[rank3]:wandb: loss_metrics/global_max_loss 3.16324
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/f6kka0sq
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1028_GPipe_timelyauto_dm1/20251029-0321/wandb/run-20251029_032104-f6kka0sq/logs
[rank3]:2025-10-29 04:00:18,875 - INFO - Process group destroyed
[rank0]:2025-10-29 04:00:19,300 - INFO - Training completed
[rank0]:2025-10-29 04:00:19,301 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 04:00:19,421 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.10', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.1', 'layers.2', 'tok_embeddings', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.8', 'layers.4', 'layers.6'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'output', 'layers.14', 'norm', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1028_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1028_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1028_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1028_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: True
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1028_GPipe_timelyauto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1028_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
