
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2026. 01. 01. (Î™©) 03:54:45 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_1F1B_nofreeze_42.log
‚úîÔ∏èMain Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

‚úîÔ∏èRunning with nofreeze x 1F1B ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
[rank0]:2026-01-01 03:54:53,555 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank3]:2026-01-01 03:54:53,468 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:"
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2026-01-01 03:54:53,468 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank1]:2026-01-01 03:54:53,754 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank3]:2026-01-01 03:54:53,728 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 03:54:53,730 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-01 03:54:53,743 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 03:54:53,746 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 03:54:53,792 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 03:54:53,795 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 03:54:53,800 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 03:54:53,801 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-01 03:54:53,940 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 03:54:53,943 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 03:54:54,196 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2026-01-01 03:54:57,229 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 03:54:57,268 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 03:54:57,293 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-01 03:54:57,293 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-01 03:54:57,509 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 03:54:57,509 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 03:54:57,510 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2026-01-01 03:54:57,678 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2026-01-01 03:54:57,824 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 03:54:57,863 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 03:54:57,865 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 03:54:57,891 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-01 03:54:57,891 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2026-01-01 03:54:58,003 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 03:54:58,041 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 03:54:58,067 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-01 03:54:58,067 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 03:54:58,107 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 03:54:58,107 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 03:54:58,108 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2026-01-01 03:54:58,249 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 03:54:58,249 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 03:54:58,249 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run xocziltm
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_1F1B_nofreeze_42_dm1/20260101-0354/wandb/run-20260101_035458-xocziltm
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_1F1B_nofreeze_42_dm1
[rank3]:wandb: ‚≠êÔ∏è View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: üöÄ View run at https://wandb.ai/orangingq/torchtitan/runs/xocziltm
[rank3]:2026-01-01 03:54:59,520 - WandB logging enabled
[rank3]:2026-01-01 03:54:59,520 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 03:54:59,561 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 03:54:59,591 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2026-01-01 03:54:59,591 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2026-01-01 03:54:59,791 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-01 03:54:59,791 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 03:54:59,791 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_1F1B_nofreeze_42_dm1
[rank0]:2026-01-01 03:54:59,792 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-01 03:54:59,775 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 03:54:59,776 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 03:54:59,792 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank3]:2026-01-01 03:54:59,776 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2026-01-01 03:54:59,791 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 03:54:59,792 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2026-01-01 03:55:02,356 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 03:55:02,356 - Finished loading the checkpoint in 2.56 seconds.
[rank2]:2026-01-01 03:55:02,404 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2026-01-01 03:55:02,405 - Freezable Parameters: [Stage 2] 56 params
[rank1]:2026-01-01 03:55:02,410 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank0]:2026-01-01 03:55:02,406 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank1]:2026-01-01 03:55:02,410 - Freezable Parameters: [Stage 1] 70 params
[rank0]:2026-01-01 03:55:02,406 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2026-01-01 03:55:02,406 - Training starts at step 1
[rank3]:2026-01-01 03:55:02,416 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2026-01-01 03:55:02,417 - Freezable Parameters: [Stage 3] 42 params
[rank2]:2026-01-01 03:55:07,468 -  step:  1  loss: -4.0000  grad_norm:  9.9054  memory:  7.27GiB(15.31%)  tps: 3,476  tflops: 27.18  mfu: 8.71%
[rank2]:2026-01-01 03:55:07,468 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 03:55:07,469 -  step:  1  loss: -4.0000  grad_norm:  9.9054  memory: 12.09GiB(25.46%)  tps: 3,212  tflops: 25.11  mfu: 8.05%
[rank1]:2026-01-01 03:55:07,470 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 03:55:07,471 -  step:  1  loss: 10.6092  grad_norm:  9.9054  memory: 20.97GiB(44.14%)  tps: 4,144  tflops: 32.40  mfu: 10.38%
[rank3]:2026-01-01 03:55:07,471 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 03:55:07,496 -  step:  1  loss: -4.0000  grad_norm:  9.9054  memory: 13.12GiB(27.62%)  tps: 3,402  tflops: 26.59  mfu: 8.52%
[rank0]:2026-01-01 03:55:07,496 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 03:58:30,157 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 03:58:34,243 - Avg. fwd time: 33.4242 / Avg. bwd time: 53.0464 / Avg. batch time: 837.2148 (ms) / GPU bubble ratio: 17.37%
[rank0]:2026-01-01 03:58:34,359 - Avg. fwd time: 26.2047 / Avg. bwd time: 28.3562 / Avg. batch time: 1040.2451 (ms) / GPU bubble ratio: 58.04%
[rank2]:2026-01-01 03:58:34,280 - Avg. fwd time: 25.7955 / Avg. bwd time: 30.2163 / Avg. batch time: 900.5152 (ms) / GPU bubble ratio: 50.24%
[rank2]:2026-01-01 03:58:34,362 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory:  7.27GiB(15.31%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank1]:2026-01-01 03:58:34,324 - Avg. fwd time: 32.7606 / Avg. bwd time: 38.2287 / Avg. batch time: 978.1391 (ms) / GPU bubble ratio: 41.94%
[rank1]:2026-01-01 03:58:34,362 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 12.09GiB(25.46%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank3]:2026-01-01 03:58:34,363 -  step: 50  loss: 12.4624  grad_norm:  8.4069  memory: 20.97GiB(44.14%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank0]:2026-01-01 03:58:34,362 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 13.12GiB(27.62%)  tps: 7,762  tflops: 60.68  mfu: 19.45%
[rank0]:2026-01-01 04:02:01,942 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:02:06,017 - Avg. fwd time: 33.5112 / Avg. bwd time: 53.1550 / Avg. batch time: 838.6512 (ms) / GPU bubble ratio: 17.33%
[rank1]:2026-01-01 04:02:06,099 - Avg. fwd time: 32.7960 / Avg. bwd time: 38.2643 / Avg. batch time: 978.7827 (ms) / GPU bubble ratio: 41.92%
[rank1]:2026-01-01 04:02:06,137 -  step: 100  loss: -4.0000  grad_norm:  7.6134  memory: 12.09GiB(25.46%)  tps: 7,737  tflops: 60.48  mfu: 19.38%
[rank0]:2026-01-01 04:02:06,134 - Avg. fwd time: 26.2159 / Avg. bwd time: 28.4295 / Avg. batch time: 1040.4998 (ms) / GPU bubble ratio: 57.99%
[rank0]:2026-01-01 04:02:06,138 -  step: 100  loss: -4.0000  grad_norm:  7.6134  memory: 13.12GiB(27.62%)  tps: 7,737  tflops: 60.48  mfu: 19.38%
[rank2]:2026-01-01 04:02:06,054 - Avg. fwd time: 25.8082 / Avg. bwd time: 30.2288 / Avg. batch time: 901.5283 (ms) / GPU bubble ratio: 50.27%
[rank2]:2026-01-01 04:02:06,137 -  step: 100  loss: -4.0000  grad_norm:  7.6134  memory:  7.27GiB(15.31%)  tps: 7,737  tflops: 60.48  mfu: 19.38%
[rank3]:2026-01-01 04:02:06,139 -  step: 100  loss: 13.1176  grad_norm:  7.6134  memory: 20.97GiB(44.14%)  tps: 7,737  tflops: 60.48  mfu: 19.38%
[rank3]:2026-01-01 04:02:06,306 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0402_step100_rank3.svg
[rank3]:			> Batch Time: 1034.31 ms, GPU Bubble Ratio: 57.75%, 45.15%, 56.75%, 33.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  384-28-412ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  595-28-623ms   | [S0,MB7,F]  623-25-649ms   | [S0,MB4,B]  701-28-729ms   | [S0,MB5,B]  803-28-831ms   | [S0,MB6,B]  903-28-931ms   | [S0,MB7,B]  1006-28-1034ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-37-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-32-519ms   | [S1,MB3,B]  546-38-584ms   | [S1,MB6,F]  591-32-624ms   | [S1,MB4,B]  652-38-690ms   | [S1,MB7,F]  697-32-730ms   | [S1,MB5,B]  758-38-796ms   | [S1,MB6,B]  859-37-897ms   | [S1,MB7,B]  961-38-999ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  438-25-463ms   | [S2,MB3,B]  505-30-535ms   | [S2,MB5,F]  543-25-569ms   | [S2,MB4,B]  611-30-642ms   | [S2,MB6,F]  649-25-675ms   | [S2,MB5,B]  717-30-748ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  822-30-853ms   | [S2,MB7,B]  924-30-955ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-283ms   | [S3,MB2,F]  291-33-324ms   | [S3,MB2,B]  336-53-390ms   | [S3,MB3,F]  397-34-431ms   | [S3,MB3,B]  442-53-496ms   | [S3,MB4,F]  502-33-536ms   | [S3,MB4,B]  548-53-601ms   | [S3,MB5,F]  608-33-642ms   | [S3,MB5,B]  654-53-708ms   | [S3,MB6,F]  714-33-748ms   | [S3,MB6,B]  760-53-813ms   | [S3,MB7,F]  819-33-853ms   | [S3,MB7,B]  864-52-917ms  
[rank0]:2026-01-01 04:05:33,881 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:05:38,017 - Avg. fwd time: 33.5506 / Avg. bwd time: 53.2039 / Avg. batch time: 839.3266 (ms) / GPU bubble ratio: 17.31%
[rank2]:2026-01-01 04:05:38,055 - Avg. fwd time: 25.8144 / Avg. bwd time: 30.2345 / Avg. batch time: 902.1724 (ms) / GPU bubble ratio: 50.30%
[rank1]:2026-01-01 04:05:38,100 - Avg. fwd time: 32.8110 / Avg. bwd time: 38.2771 / Avg. batch time: 979.2973 (ms) / GPU bubble ratio: 41.93%
[rank1]:2026-01-01 04:05:38,138 -  step: 150  loss: -4.0000  grad_norm:  8.3966  memory: 12.09GiB(25.46%)  tps: 7,728  tflops: 60.42  mfu: 19.36%
[rank3]:2026-01-01 04:05:38,140 -  step: 150  loss: 11.1266  grad_norm:  8.3966  memory: 20.97GiB(44.14%)  tps: 7,728  tflops: 60.42  mfu: 19.36%
[rank0]:2026-01-01 04:05:38,135 - Avg. fwd time: 26.2213 / Avg. bwd time: 28.4547 / Avg. batch time: 1040.8836 (ms) / GPU bubble ratio: 57.98%
[rank0]:2026-01-01 04:05:38,139 -  step: 150  loss: -4.0000  grad_norm:  8.3966  memory: 13.12GiB(27.62%)  tps: 7,728  tflops: 60.42  mfu: 19.36%
[rank2]:2026-01-01 04:05:38,138 -  step: 150  loss: -4.0000  grad_norm:  8.3966  memory:  7.27GiB(15.31%)  tps: 7,728  tflops: 60.42  mfu: 19.36%
[rank0]:2026-01-01 04:09:05,916 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:09:10,140 - Avg. fwd time: 33.5822 / Avg. bwd time: 53.2387 / Avg. batch time: 839.8431 (ms) / GPU bubble ratio: 17.30%
[rank2]:2026-01-01 04:09:10,178 - Avg. fwd time: 25.8224 / Avg. bwd time: 30.2404 / Avg. batch time: 902.6100 (ms) / GPU bubble ratio: 50.31%
[rank1]:2026-01-01 04:09:10,225 - Avg. fwd time: 32.8236 / Avg. bwd time: 38.2869 / Avg. batch time: 979.6908 (ms) / GPU bubble ratio: 41.93%
[rank1]:2026-01-01 04:09:10,264 -  step: 200  loss: -4.0000  grad_norm: 36.8421  memory: 12.09GiB(25.46%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank0]:2026-01-01 04:09:10,261 - Avg. fwd time: 26.2286 / Avg. bwd time: 28.4698 / Avg. batch time: 1041.2195 (ms) / GPU bubble ratio: 57.97%
[rank0]:2026-01-01 04:09:10,264 -  step: 200  loss: -4.0000  grad_norm: 36.8421  memory: 13.12GiB(27.62%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank3]:2026-01-01 04:09:10,266 -  step: 200  loss: 10.3045  grad_norm: 36.8421  memory: 20.97GiB(44.14%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank2]:2026-01-01 04:09:10,264 -  step: 200  loss: -4.0000  grad_norm: 36.8421  memory:  7.27GiB(15.31%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank3]:2026-01-01 04:09:10,409 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0409_step200_rank3.svg
[rank3]:			> Batch Time: 1041.41 ms, GPU Bubble Ratio: 57.91%, 45.33%, 56.89%, 33.10%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  279-28-308ms   | [S0,MB4,F]  308-25-333ms   | [S0,MB1,B]  386-28-414ms   | [S0,MB5,F]  414-25-440ms   | [S0,MB2,B]  492-28-521ms   | [S0,MB6,F]  521-25-546ms   | [S0,MB3,B]  598-28-626ms   | [S0,MB7,F]  627-25-652ms   | [S0,MB4,B]  705-28-733ms   | [S0,MB5,B]  808-28-836ms   | [S0,MB6,B]  910-28-938ms   | [S0,MB7,B]  1013-28-1041ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  231-38-269ms   | [S1,MB3,F]  276-32-308ms   | [S1,MB1,B]  336-38-375ms   | [S1,MB4,F]  382-33-415ms   | [S1,MB2,B]  443-38-481ms   | [S1,MB5,F]  489-32-522ms   | [S1,MB3,B]  549-38-588ms   | [S1,MB6,F]  595-33-628ms   | [S1,MB4,B]  656-38-694ms   | [S1,MB7,F]  701-33-734ms   | [S1,MB5,B]  762-38-801ms   | [S1,MB6,B]  865-37-903ms   | [S1,MB7,B]  968-38-1006ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  190-30-220ms   | [S2,MB2,F]  228-25-253ms   | [S2,MB1,B]  296-30-326ms   | [S2,MB3,F]  333-25-359ms   | [S2,MB2,B]  403-30-433ms   | [S2,MB4,F]  440-25-466ms   | [S2,MB3,B]  509-30-539ms   | [S2,MB5,F]  546-25-572ms   | [S2,MB4,B]  616-30-646ms   | [S2,MB6,F]  653-25-679ms   | [S2,MB5,B]  722-30-752ms   | [S2,MB7,F]  759-25-785ms   | [S2,MB6,B]  828-30-858ms   | [S2,MB7,B]  932-30-962ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  127-52-180ms   | [S3,MB1,F]  187-33-220ms   | [S3,MB1,B]  232-53-286ms   | [S3,MB2,F]  293-34-327ms   | [S3,MB2,B]  339-53-392ms   | [S3,MB3,F]  399-34-433ms   | [S3,MB3,B]  445-53-499ms   | [S3,MB4,F]  506-34-540ms   | [S3,MB4,B]  551-53-605ms   | [S3,MB5,F]  612-34-646ms   | [S3,MB5,B]  658-53-711ms   | [S3,MB6,F]  719-34-753ms   | [S3,MB6,B]  765-53-818ms   | [S3,MB7,F]  825-34-859ms   | [S3,MB7,B]  871-53-924ms  
[rank0]:2026-01-01 04:12:38,193 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:12:42,270 - Avg. fwd time: 33.5918 / Avg. bwd time: 53.2475 / Avg. batch time: 839.9799 (ms) / GPU bubble ratio: 17.29%
[rank1]:2026-01-01 04:12:42,354 - Avg. fwd time: 32.8272 / Avg. bwd time: 38.2895 / Avg. batch time: 979.7990 (ms) / GPU bubble ratio: 41.93%
[rank2]:2026-01-01 04:12:42,308 - Avg. fwd time: 25.8241 / Avg. bwd time: 30.2426 / Avg. batch time: 902.7451 (ms) / GPU bubble ratio: 50.31%
[rank2]:2026-01-01 04:12:42,393 -  step: 250  loss: -4.0000  grad_norm:  7.6771  memory:  7.27GiB(15.31%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank3]:2026-01-01 04:12:42,394 -  step: 250  loss: 12.5261  grad_norm:  7.6771  memory: 20.97GiB(44.14%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank1]:2026-01-01 04:12:42,393 -  step: 250  loss: -4.0000  grad_norm:  7.6771  memory: 12.09GiB(25.46%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank0]:2026-01-01 04:12:42,389 - Avg. fwd time: 26.2322 / Avg. bwd time: 28.4782 / Avg. batch time: 1041.2983 (ms) / GPU bubble ratio: 57.97%
[rank0]:2026-01-01 04:12:42,393 -  step: 250  loss: -4.0000  grad_norm:  7.6771  memory: 13.12GiB(27.62%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank0]:2026-01-01 04:16:10,084 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:16:14,170 - Avg. fwd time: 33.5915 / Avg. bwd time: 53.2469 / Avg. batch time: 839.9643 (ms) / GPU bubble ratio: 17.29%
[rank1]:2026-01-01 04:16:14,255 - Avg. fwd time: 32.8264 / Avg. bwd time: 38.2869 / Avg. batch time: 979.7057 (ms) / GPU bubble ratio: 41.93%
[rank2]:2026-01-01 04:16:14,209 - Avg. fwd time: 25.8239 / Avg. bwd time: 30.2430 / Avg. batch time: 902.6825 (ms) / GPU bubble ratio: 50.31%
[rank3]:2026-01-01 04:16:14,295 -  step: 300  loss: 12.9460  grad_norm:  7.3828  memory: 20.97GiB(44.14%)  tps: 7,732  tflops: 60.45  mfu: 19.37%
[rank0]:2026-01-01 04:16:14,290 - Avg. fwd time: 26.2319 / Avg. bwd time: 28.4821 / Avg. batch time: 1041.1802 (ms) / GPU bubble ratio: 57.96%
[rank0]:2026-01-01 04:16:14,294 -  step: 300  loss: -4.0000  grad_norm:  7.3828  memory: 13.12GiB(27.62%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank1]:2026-01-01 04:16:14,293 -  step: 300  loss: -4.0000  grad_norm:  7.3828  memory: 12.09GiB(25.46%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank2]:2026-01-01 04:16:14,294 -  step: 300  loss: -4.0000  grad_norm:  7.3828  memory:  7.27GiB(15.31%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank3]:2026-01-01 04:16:14,440 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0416_step300_rank3.svg
[rank3]:			> Batch Time: 1036.86 ms, GPU Bubble Ratio: 57.84%, 45.30%, 56.83%, 33.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-307ms   | [S0,MB4,F]  307-25-332ms   | [S0,MB1,B]  385-28-413ms   | [S0,MB5,F]  414-25-439ms   | [S0,MB2,B]  490-28-518ms   | [S0,MB6,F]  518-25-544ms   | [S0,MB3,B]  595-28-623ms   | [S0,MB7,F]  624-25-649ms   | [S0,MB4,B]  702-28-730ms   | [S0,MB5,B]  804-28-832ms   | [S0,MB6,B]  905-28-933ms   | [S0,MB7,B]  1008-28-1036ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  230-37-268ms   | [S1,MB3,F]  275-32-308ms   | [S1,MB1,B]  336-38-374ms   | [S1,MB4,F]  381-32-414ms   | [S1,MB2,B]  441-38-479ms   | [S1,MB5,F]  486-32-519ms   | [S1,MB3,B]  546-38-585ms   | [S1,MB6,F]  592-32-625ms   | [S1,MB4,B]  653-38-691ms   | [S1,MB7,F]  698-32-731ms   | [S1,MB5,B]  759-38-797ms   | [S1,MB6,B]  860-37-898ms   | [S1,MB7,B]  963-38-1001ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-220ms   | [S2,MB2,F]  227-25-253ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  332-25-358ms   | [S2,MB2,B]  400-30-431ms   | [S2,MB4,F]  438-25-464ms   | [S2,MB3,B]  506-30-536ms   | [S2,MB5,F]  543-25-569ms   | [S2,MB4,B]  612-30-642ms   | [S2,MB6,F]  649-25-675ms   | [S2,MB5,B]  718-30-748ms   | [S2,MB7,F]  756-25-782ms   | [S2,MB6,B]  823-30-854ms   | [S2,MB7,B]  925-30-956ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-52-179ms   | [S3,MB1,F]  186-33-220ms   | [S3,MB1,B]  232-53-285ms   | [S3,MB2,F]  292-33-326ms   | [S3,MB2,B]  337-53-390ms   | [S3,MB3,F]  397-33-431ms   | [S3,MB3,B]  443-53-496ms   | [S3,MB4,F]  503-33-537ms   | [S3,MB4,B]  548-53-601ms   | [S3,MB5,F]  609-33-643ms   | [S3,MB5,B]  654-53-707ms   | [S3,MB6,F]  715-33-749ms   | [S3,MB6,B]  761-53-814ms   | [S3,MB7,F]  820-33-854ms   | [S3,MB7,B]  866-53-919ms  
[rank0]:2026-01-01 04:19:42,115 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:19:46,258 - Avg. fwd time: 33.5949 / Avg. bwd time: 53.2496 / Avg. batch time: 840.0113 (ms) / GPU bubble ratio: 17.29%
[rank1]:2026-01-01 04:19:46,343 - Avg. fwd time: 32.8279 / Avg. bwd time: 38.2872 / Avg. batch time: 979.7422 (ms) / GPU bubble ratio: 41.93%
[rank2]:2026-01-01 04:19:46,296 - Avg. fwd time: 25.8247 / Avg. bwd time: 30.2441 / Avg. batch time: 902.7357 (ms) / GPU bubble ratio: 50.31%
[rank3]:2026-01-01 04:19:46,384 -  step: 350  loss: 11.1892  grad_norm:  7.1193  memory: 20.97GiB(44.14%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank1]:2026-01-01 04:19:46,382 -  step: 350  loss: -4.0000  grad_norm:  7.1193  memory: 12.09GiB(25.46%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank0]:2026-01-01 04:19:46,379 - Avg. fwd time: 26.2343 / Avg. bwd time: 28.4867 / Avg. batch time: 1041.2014 (ms) / GPU bubble ratio: 57.96%
[rank0]:2026-01-01 04:19:46,383 -  step: 350  loss: -4.0000  grad_norm:  7.1193  memory: 13.12GiB(27.62%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank2]:2026-01-01 04:19:46,382 -  step: 350  loss: -4.0000  grad_norm:  7.1193  memory:  7.27GiB(15.31%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank0]:2026-01-01 04:23:14,183 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 04:23:18,452 - Avg. fwd time: 25.8268 / Avg. bwd time: 30.2459 / Avg. batch time: 902.8212 (ms) / GPU bubble ratio: 50.31%
[rank3]:2026-01-01 04:23:18,413 - Avg. fwd time: 33.6016 / Avg. bwd time: 53.2570 / Avg. batch time: 840.1199 (ms) / GPU bubble ratio: 17.29%
[rank1]:2026-01-01 04:23:18,499 - Avg. fwd time: 32.8315 / Avg. bwd time: 38.2890 / Avg. batch time: 979.8208 (ms) / GPU bubble ratio: 41.93%
[rank1]:2026-01-01 04:23:18,540 -  step: 400  loss: -4.0000  grad_norm: 37.4439  memory: 12.09GiB(25.46%)  tps: 7,723  tflops: 60.37  mfu: 19.35%
[rank2]:2026-01-01 04:23:18,540 -  step: 400  loss: -4.0000  grad_norm: 37.4439  memory:  7.27GiB(15.31%)  tps: 7,723  tflops: 60.37  mfu: 19.35%
[rank3]:2026-01-01 04:23:18,542 -  step: 400  loss: 10.2841  grad_norm: 37.4439  memory: 20.97GiB(44.14%)  tps: 7,723  tflops: 60.37  mfu: 19.35%
[rank0]:2026-01-01 04:23:18,536 - Avg. fwd time: 26.2370 / Avg. bwd time: 28.4913 / Avg. batch time: 1041.2715 (ms) / GPU bubble ratio: 57.95%
[rank0]:2026-01-01 04:23:18,540 -  step: 400  loss: -4.0000  grad_norm: 37.4439  memory: 13.12GiB(27.62%)  tps: 7,723  tflops: 60.37  mfu: 19.35%
[rank3]:2026-01-01 04:23:18,690 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0423_step400_rank3.svg
[rank3]:			> Batch Time: 1041.41 ms, GPU Bubble Ratio: 57.89%, 45.28%, 56.90%, 33.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  279-28-308ms   | [S0,MB4,F]  308-25-333ms   | [S0,MB1,B]  385-28-413ms   | [S0,MB5,F]  414-25-439ms   | [S0,MB2,B]  491-28-519ms   | [S0,MB6,F]  519-25-545ms   | [S0,MB3,B]  598-28-626ms   | [S0,MB7,F]  626-25-652ms   | [S0,MB4,B]  704-28-733ms   | [S0,MB5,B]  806-28-834ms   | [S0,MB6,B]  909-28-937ms   | [S0,MB7,B]  1013-28-1041ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  231-38-269ms   | [S1,MB3,F]  276-32-309ms   | [S1,MB1,B]  336-38-374ms   | [S1,MB4,F]  381-33-414ms   | [S1,MB2,B]  442-38-480ms   | [S1,MB5,F]  487-33-520ms   | [S1,MB3,B]  548-38-587ms   | [S1,MB6,F]  594-33-627ms   | [S1,MB4,B]  655-38-694ms   | [S1,MB7,F]  701-33-734ms   | [S1,MB5,B]  761-38-799ms   | [S1,MB6,B]  864-38-902ms   | [S1,MB7,B]  968-38-1006ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  98-25-123ms    | [S2,MB0,B]  190-30-221ms   | [S2,MB2,F]  228-25-254ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  333-25-359ms   | [S2,MB2,B]  401-30-431ms   | [S2,MB4,F]  439-25-465ms   | [S2,MB3,B]  508-30-538ms   | [S2,MB5,F]  545-25-571ms   | [S2,MB4,B]  615-30-645ms   | [S2,MB6,F]  652-25-678ms   | [S2,MB5,B]  720-30-750ms   | [S2,MB7,F]  758-25-784ms   | [S2,MB6,B]  828-30-858ms   | [S2,MB7,B]  931-30-961ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-52-180ms   | [S3,MB1,F]  187-33-220ms   | [S3,MB1,B]  232-53-285ms   | [S3,MB2,F]  292-33-326ms   | [S3,MB2,B]  338-53-392ms   | [S3,MB3,F]  398-34-432ms   | [S3,MB3,B]  444-53-498ms   | [S3,MB4,F]  505-34-539ms   | [S3,MB4,B]  551-53-605ms   | [S3,MB5,F]  611-33-645ms   | [S3,MB5,B]  657-53-711ms   | [S3,MB6,F]  717-34-751ms   | [S3,MB6,B]  763-53-817ms   | [S3,MB7,F]  824-34-859ms   | [S3,MB7,B]  871-53-924ms  
[rank3]:2026-01-01 04:23:42,597 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 04:23:42,743 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 04:23:42,813 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 04:23:42,784 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 04:26:46,126 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:26:50,200 - Avg. fwd time: 33.5984 / Avg. bwd time: 53.2539 / Avg. batch time: 840.0639 (ms) / GPU bubble ratio: 17.29%
[rank1]:2026-01-01 04:26:50,286 - Avg. fwd time: 32.8303 / Avg. bwd time: 38.2870 / Avg. batch time: 979.7547 (ms) / GPU bubble ratio: 41.93%
[rank2]:2026-01-01 04:26:50,239 - Avg. fwd time: 25.8259 / Avg. bwd time: 30.2456 / Avg. batch time: 902.7700 (ms) / GPU bubble ratio: 50.31%
[rank0]:2026-01-01 04:26:50,323 - Avg. fwd time: 26.2359 / Avg. bwd time: 28.4927 / Avg. batch time: 1041.1941 (ms) / GPU bubble ratio: 57.95%
[rank0]:2026-01-01 04:26:50,327 -  step: 450  loss: -4.0000  grad_norm:  6.7546  memory: 13.12GiB(27.62%)  tps: 7,736  tflops: 60.48  mfu: 19.38%
[rank3]:2026-01-01 04:26:50,328 -  step: 450  loss: 12.7481  grad_norm:  6.7546  memory: 20.97GiB(44.14%)  tps: 7,736  tflops: 60.48  mfu: 19.38%
[rank1]:2026-01-01 04:26:50,326 -  step: 450  loss: -4.0000  grad_norm:  6.7546  memory: 12.09GiB(25.46%)  tps: 7,736  tflops: 60.48  mfu: 19.38%
[rank2]:2026-01-01 04:26:50,326 -  step: 450  loss: -4.0000  grad_norm:  6.7546  memory:  7.27GiB(15.31%)  tps: 7,736  tflops: 60.48  mfu: 19.38%
[rank0]:2026-01-01 04:30:17,947 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:30:22,031 - Avg. fwd time: 33.5948 / Avg. bwd time: 53.2507 / Avg. batch time: 840.0056 (ms) / GPU bubble ratio: 17.29%
[rank2]:2026-01-01 04:30:22,070 - Avg. fwd time: 25.8249 / Avg. bwd time: 30.2452 / Avg. batch time: 902.6875 (ms) / GPU bubble ratio: 50.31%
[rank2]:2026-01-01 04:30:22,158 -  step: 500  loss: -4.0000  grad_norm:  7.5511  memory:  7.27GiB(15.31%)  tps: 7,734  tflops: 60.46  mfu: 19.38%
[rank3]:2026-01-01 04:30:22,160 -  step: 500  loss: 12.9581  grad_norm:  7.5511  memory: 20.97GiB(44.14%)  tps: 7,735  tflops: 60.47  mfu: 19.38%
[rank1]:2026-01-01 04:30:22,117 - Avg. fwd time: 32.8297 / Avg. bwd time: 38.2865 / Avg. batch time: 979.6603 (ms) / GPU bubble ratio: 41.93%
[rank1]:2026-01-01 04:30:22,158 -  step: 500  loss: -4.0000  grad_norm:  7.5511  memory: 12.09GiB(25.46%)  tps: 7,734  tflops: 60.46  mfu: 19.38%
[rank0]:2026-01-01 04:30:22,155 - Avg. fwd time: 26.2350 / Avg. bwd time: 28.4937 / Avg. batch time: 1041.0909 (ms) / GPU bubble ratio: 57.95%
[rank0]:2026-01-01 04:30:22,158 -  step: 500  loss: -4.0000  grad_norm:  7.5511  memory: 13.12GiB(27.62%)  tps: 7,734  tflops: 60.46  mfu: 19.38%
[rank3]:2026-01-01 04:30:22,303 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0430_step500_rank3.svg
[rank3]:			> Batch Time: 1035.83 ms, GPU Bubble Ratio: 57.79%, 45.21%, 56.80%, 33.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-307ms   | [S0,MB4,F]  307-25-332ms   | [S0,MB1,B]  384-28-412ms   | [S0,MB5,F]  412-25-438ms   | [S0,MB2,B]  489-28-517ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  595-28-623ms   | [S0,MB7,F]  624-25-649ms   | [S0,MB4,B]  703-28-731ms   | [S0,MB5,B]  803-28-831ms   | [S0,MB6,B]  903-28-931ms   | [S0,MB7,B]  1007-28-1035ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  230-37-268ms   | [S1,MB3,F]  275-32-308ms   | [S1,MB1,B]  335-38-373ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-32-519ms   | [S1,MB3,B]  546-38-585ms   | [S1,MB6,F]  592-32-625ms   | [S1,MB4,B]  654-38-692ms   | [S1,MB7,F]  699-32-732ms   | [S1,MB5,B]  758-38-796ms   | [S1,MB6,B]  859-37-897ms   | [S1,MB7,B]  963-38-1001ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-220ms   | [S2,MB2,F]  227-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  399-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  505-30-535ms   | [S2,MB5,F]  543-25-568ms   | [S2,MB4,B]  613-30-643ms   | [S2,MB6,F]  650-25-676ms   | [S2,MB5,B]  717-30-748ms   | [S2,MB7,F]  754-25-780ms   | [S2,MB6,B]  822-30-853ms   | [S2,MB7,B]  924-30-955ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-52-179ms   | [S3,MB1,F]  186-32-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  291-33-325ms   | [S3,MB2,B]  336-52-389ms   | [S3,MB3,F]  397-33-431ms   | [S3,MB3,B]  442-53-496ms   | [S3,MB4,F]  502-34-536ms   | [S3,MB4,B]  548-53-602ms   | [S3,MB5,F]  610-33-644ms   | [S3,MB5,B]  655-53-708ms   | [S3,MB6,F]  714-33-748ms   | [S3,MB6,B]  760-53-813ms   | [S3,MB7,F]  820-33-854ms   | [S3,MB7,B]  865-53-918ms  
[rank0]:2026-01-01 04:33:49,815 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:33:53,958 - Avg. fwd time: 33.5936 / Avg. bwd time: 53.2502 / Avg. batch time: 839.9892 (ms) / GPU bubble ratio: 17.29%
[rank2]:2026-01-01 04:33:53,998 - Avg. fwd time: 25.8251 / Avg. bwd time: 30.2457 / Avg. batch time: 902.6765 (ms) / GPU bubble ratio: 50.31%
[rank1]:2026-01-01 04:33:54,046 - Avg. fwd time: 32.8295 / Avg. bwd time: 38.2862 / Avg. batch time: 979.6405 (ms) / GPU bubble ratio: 41.93%
[rank1]:2026-01-01 04:33:54,087 -  step: 550  loss: -4.0000  grad_norm:  6.5587  memory: 12.09GiB(25.46%)  tps: 7,731  tflops: 60.44  mfu: 19.37%
[rank2]:2026-01-01 04:33:54,088 -  step: 550  loss: -4.0000  grad_norm:  6.5587  memory:  7.27GiB(15.31%)  tps: 7,731  tflops: 60.44  mfu: 19.37%
[rank0]:2026-01-01 04:33:54,084 - Avg. fwd time: 26.2339 / Avg. bwd time: 28.4946 / Avg. batch time: 1041.0612 (ms) / GPU bubble ratio: 57.94%
[rank0]:2026-01-01 04:33:54,088 -  step: 550  loss: -4.0000  grad_norm:  6.5587  memory: 13.12GiB(27.62%)  tps: 7,731  tflops: 60.44  mfu: 19.37%
[rank3]:2026-01-01 04:33:54,090 -  step: 550  loss: 11.0990  grad_norm:  6.5587  memory: 20.97GiB(44.14%)  tps: 7,731  tflops: 60.44  mfu: 19.37%
[rank0]:2026-01-01 04:37:21,713 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:37:25,941 - Avg. fwd time: 33.5961 / Avg. bwd time: 53.2531 / Avg. batch time: 840.0301 (ms) / GPU bubble ratio: 17.29%
[rank2]:2026-01-01 04:37:25,982 - Avg. fwd time: 25.8260 / Avg. bwd time: 30.2467 / Avg. batch time: 902.7029 (ms) / GPU bubble ratio: 50.31%
[rank1]:2026-01-01 04:37:26,030 - Avg. fwd time: 32.8308 / Avg. bwd time: 38.2873 / Avg. batch time: 979.6618 (ms) / GPU bubble ratio: 41.92%
[rank1]:2026-01-01 04:37:26,072 -  step: 600  loss: -4.0000  grad_norm: 34.2327  memory: 12.09GiB(25.46%)  tps: 7,729  tflops: 60.42  mfu: 19.37%
[rank2]:2026-01-01 04:37:26,072 -  step: 600  loss: -4.0000  grad_norm: 34.2327  memory:  7.27GiB(15.31%)  tps: 7,729  tflops: 60.42  mfu: 19.37%
[rank0]:2026-01-01 04:37:26,068 - Avg. fwd time: 26.2347 / Avg. bwd time: 28.4965 / Avg. batch time: 1041.0767 (ms) / GPU bubble ratio: 57.94%
[rank0]:2026-01-01 04:37:26,072 -  step: 600  loss: -4.0000  grad_norm: 34.2327  memory: 13.12GiB(27.62%)  tps: 7,729  tflops: 60.42  mfu: 19.37%
[rank3]:2026-01-01 04:37:26,074 -  step: 600  loss: 10.0152  grad_norm: 34.2327  memory: 20.97GiB(44.14%)  tps: 7,729  tflops: 60.42  mfu: 19.37%
[rank3]:2026-01-01 04:37:26,222 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0437_step600_rank3.svg
[rank3]:			> Batch Time: 1040.89 ms, GPU Bubble Ratio: 57.89%, 45.31%, 56.87%, 33.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  279-28-308ms   | [S0,MB4,F]  308-25-333ms   | [S0,MB1,B]  385-28-414ms   | [S0,MB5,F]  414-25-439ms   | [S0,MB2,B]  491-28-519ms   | [S0,MB6,F]  519-25-545ms   | [S0,MB3,B]  598-28-626ms   | [S0,MB7,F]  626-25-652ms   | [S0,MB4,B]  705-28-734ms   | [S0,MB5,B]  808-28-836ms   | [S0,MB6,B]  909-28-938ms   | [S0,MB7,B]  1012-28-1040ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  231-38-269ms   | [S1,MB3,F]  276-32-308ms   | [S1,MB1,B]  336-38-375ms   | [S1,MB4,F]  382-33-415ms   | [S1,MB2,B]  442-38-480ms   | [S1,MB5,F]  487-33-520ms   | [S1,MB3,B]  549-38-587ms   | [S1,MB6,F]  594-33-627ms   | [S1,MB4,B]  656-38-695ms   | [S1,MB7,F]  702-33-735ms   | [S1,MB5,B]  762-38-801ms   | [S1,MB6,B]  864-37-902ms   | [S1,MB7,B]  968-38-1006ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  190-30-220ms   | [S2,MB2,F]  228-25-253ms   | [S2,MB1,B]  295-30-326ms   | [S2,MB3,F]  333-25-359ms   | [S2,MB2,B]  401-30-432ms   | [S2,MB4,F]  439-25-464ms   | [S2,MB3,B]  508-30-538ms   | [S2,MB5,F]  546-25-571ms   | [S2,MB4,B]  616-30-646ms   | [S2,MB6,F]  653-25-679ms   | [S2,MB5,B]  722-30-752ms   | [S2,MB7,F]  759-25-785ms   | [S2,MB6,B]  828-30-858ms   | [S2,MB7,B]  931-30-961ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  127-52-180ms   | [S3,MB1,F]  187-33-220ms   | [S3,MB1,B]  232-53-285ms   | [S3,MB2,F]  292-33-326ms   | [S3,MB2,B]  338-53-391ms   | [S3,MB3,F]  398-34-433ms   | [S3,MB3,B]  444-53-498ms   | [S3,MB4,F]  505-34-539ms   | [S3,MB4,B]  552-53-605ms   | [S3,MB5,F]  612-33-646ms   | [S3,MB5,B]  658-53-712ms   | [S3,MB6,F]  719-34-753ms   | [S3,MB6,B]  764-53-818ms   | [S3,MB7,F]  825-34-859ms   | [S3,MB7,B]  871-53-924ms  
[rank0]:2026-01-01 04:40:53,950 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 04:40:58,073 - Avg. fwd time: 25.8261 / Avg. bwd time: 30.2470 / Avg. batch time: 902.7246 (ms) / GPU bubble ratio: 50.31%
[rank3]:2026-01-01 04:40:58,033 - Avg. fwd time: 33.5970 / Avg. bwd time: 53.2542 / Avg. batch time: 840.0443 (ms) / GPU bubble ratio: 17.29%
[rank1]:2026-01-01 04:40:58,121 - Avg. fwd time: 32.8315 / Avg. bwd time: 38.2882 / Avg. batch time: 979.6787 (ms) / GPU bubble ratio: 41.92%
[rank2]:2026-01-01 04:40:58,162 -  step: 650  loss: -4.0000  grad_norm:  8.4311  memory:  7.27GiB(15.31%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank0]:2026-01-01 04:40:58,159 - Avg. fwd time: 26.2349 / Avg. bwd time: 28.4978 / Avg. batch time: 1041.0903 (ms) / GPU bubble ratio: 57.94%
[rank0]:2026-01-01 04:40:58,162 -  step: 650  loss: -4.0000  grad_norm:  8.4311  memory: 13.12GiB(27.62%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank3]:2026-01-01 04:40:58,164 -  step: 650  loss: 12.3055  grad_norm:  8.4311  memory: 20.97GiB(44.14%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank1]:2026-01-01 04:40:58,162 -  step: 650  loss: -4.0000  grad_norm:  8.4311  memory: 12.09GiB(25.46%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank0]:2026-01-01 04:44:25,841 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:44:29,919 - Avg. fwd time: 33.5961 / Avg. bwd time: 53.2525 / Avg. batch time: 840.0211 (ms) / GPU bubble ratio: 17.29%
[rank2]:2026-01-01 04:44:29,960 - Avg. fwd time: 25.8257 / Avg. bwd time: 30.2468 / Avg. batch time: 902.6878 (ms) / GPU bubble ratio: 50.31%
[rank1]:2026-01-01 04:44:30,009 - Avg. fwd time: 32.8316 / Avg. bwd time: 38.2888 / Avg. batch time: 979.6381 (ms) / GPU bubble ratio: 41.92%
[rank0]:2026-01-01 04:44:30,047 - Avg. fwd time: 26.2345 / Avg. bwd time: 28.4987 / Avg. batch time: 1041.0469 (ms) / GPU bubble ratio: 57.94%
[rank0]:2026-01-01 04:44:30,050 -  step: 700  loss: -4.0000  grad_norm:  7.5655  memory: 13.12GiB(27.62%)  tps: 7,732  tflops: 60.45  mfu: 19.37%
[rank2]:2026-01-01 04:44:30,050 -  step: 700  loss: -4.0000  grad_norm:  7.5655  memory:  7.27GiB(15.31%)  tps: 7,732  tflops: 60.45  mfu: 19.37%
[rank1]:2026-01-01 04:44:30,050 -  step: 700  loss: -4.0000  grad_norm:  7.5655  memory: 12.09GiB(25.46%)  tps: 7,732  tflops: 60.45  mfu: 19.37%
[rank3]:2026-01-01 04:44:30,052 -  step: 700  loss: 13.1112  grad_norm:  7.5655  memory: 20.97GiB(44.14%)  tps: 7,732  tflops: 60.45  mfu: 19.37%
[rank3]:2026-01-01 04:44:30,204 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0444_step700_rank3.svg
[rank3]:			> Batch Time: 1035.88 ms, GPU Bubble Ratio: 57.78%, 45.25%, 56.79%, 33.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  278-28-307ms   | [S0,MB4,F]  307-25-332ms   | [S0,MB1,B]  384-28-413ms   | [S0,MB5,F]  413-25-438ms   | [S0,MB2,B]  490-28-519ms   | [S0,MB6,F]  519-25-544ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  624-25-650ms   | [S0,MB4,B]  702-28-731ms   | [S0,MB5,B]  803-28-831ms   | [S0,MB6,B]  904-28-932ms   | [S0,MB7,B]  1007-28-1035ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  230-37-268ms   | [S1,MB3,F]  275-32-307ms   | [S1,MB1,B]  335-38-374ms   | [S1,MB4,F]  381-32-414ms   | [S1,MB2,B]  441-38-480ms   | [S1,MB5,F]  487-32-519ms   | [S1,MB3,B]  547-38-586ms   | [S1,MB6,F]  592-32-625ms   | [S1,MB4,B]  654-38-692ms   | [S1,MB7,F]  699-33-732ms   | [S1,MB5,B]  759-38-797ms   | [S1,MB6,B]  859-37-897ms   | [S1,MB7,B]  962-38-1000ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  227-25-252ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  332-25-358ms   | [S2,MB2,B]  401-30-431ms   | [S2,MB4,F]  438-25-464ms   | [S2,MB3,B]  507-30-537ms   | [S2,MB5,F]  544-25-570ms   | [S2,MB4,B]  613-30-644ms   | [S2,MB6,F]  650-25-676ms   | [S2,MB5,B]  718-30-749ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  925-30-956ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-52-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  291-33-325ms   | [S3,MB2,B]  337-52-390ms   | [S3,MB3,F]  397-33-431ms   | [S3,MB3,B]  443-53-497ms   | [S3,MB4,F]  504-33-538ms   | [S3,MB4,B]  549-53-603ms   | [S3,MB5,F]  610-33-644ms   | [S3,MB5,B]  656-52-709ms   | [S3,MB6,F]  715-33-749ms   | [S3,MB6,B]  760-52-813ms   | [S3,MB7,F]  820-33-854ms   | [S3,MB7,B]  866-53-919ms  
[rank0]:2026-01-01 04:47:57,995 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:48:02,156 - Avg. fwd time: 33.5980 / Avg. bwd time: 53.2555 / Avg. batch time: 840.0575 (ms) / GPU bubble ratio: 17.29%
[rank2]:2026-01-01 04:48:02,197 - Avg. fwd time: 25.8259 / Avg. bwd time: 30.2470 / Avg. batch time: 902.7333 (ms) / GPU bubble ratio: 50.31%
[rank0]:2026-01-01 04:48:02,286 - Avg. fwd time: 26.2343 / Avg. bwd time: 28.4998 / Avg. batch time: 1041.0893 (ms) / GPU bubble ratio: 57.94%
[rank0]:2026-01-01 04:48:02,290 -  step: 750  loss: -4.0000  grad_norm:  5.6820  memory: 13.12GiB(27.62%)  tps: 7,720  tflops: 60.35  mfu: 19.34%
[rank3]:2026-01-01 04:48:02,291 -  step: 750  loss: 11.0736  grad_norm:  5.6820  memory: 20.97GiB(44.14%)  tps: 7,720  tflops: 60.35  mfu: 19.34%
[rank2]:2026-01-01 04:48:02,289 -  step: 750  loss: -4.0000  grad_norm:  5.6820  memory:  7.27GiB(15.31%)  tps: 7,720  tflops: 60.35  mfu: 19.34%
[rank1]:2026-01-01 04:48:02,247 - Avg. fwd time: 32.8329 / Avg. bwd time: 38.2900 / Avg. batch time: 979.6822 (ms) / GPU bubble ratio: 41.92%
[rank1]:2026-01-01 04:48:02,289 -  step: 750  loss: -4.0000  grad_norm:  5.6820  memory: 12.09GiB(25.46%)  tps: 7,720  tflops: 60.35  mfu: 19.34%
[rank0]:2026-01-01 04:51:30,011 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 04:51:34,297 - Avg. fwd time: 25.8264 / Avg. bwd time: 30.2477 / Avg. batch time: 902.7529 (ms) / GPU bubble ratio: 50.31%
[rank3]:2026-01-01 04:51:34,255 - Avg. fwd time: 33.6000 / Avg. bwd time: 53.2575 / Avg. batch time: 840.0867 (ms) / GPU bubble ratio: 17.29%
[rank1]:2026-01-01 04:51:34,347 - Avg. fwd time: 32.8345 / Avg. bwd time: 38.2919 / Avg. batch time: 979.7002 (ms) / GPU bubble ratio: 41.92%
[rank1]:2026-01-01 04:51:34,389 -  step: 800  loss: -4.0000  grad_norm: 31.3495  memory: 12.09GiB(25.46%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank1]:2026-01-01 04:51:34,390 - ‚ÑπÔ∏è final step: 800  loss: -4.0000  grad_norm: 31.3495  tps: 8,199  tflops: 64.10  mfu: 18.70%
[rank1]:2026-01-01 04:51:34,390 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 04:51:34,390 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 04:51:34,389 -  step: 800  loss: -4.0000  grad_norm: 31.3495  memory:  7.27GiB(15.31%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank2]:2026-01-01 04:51:34,390 - ‚ÑπÔ∏è final step: 800  loss: -4.0000  grad_norm: 31.3495  tps: 8,201  tflops: 64.11  mfu: 18.74%
[rank2]:2026-01-01 04:51:34,390 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 04:51:34,390 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 04:51:34,391 -  step: 800  loss:  9.8078  grad_norm: 31.3495  memory: 20.97GiB(44.14%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank3]:2026-01-01 04:51:34,392 - ‚ÑπÔ∏è final step: 800  loss:  9.8078  grad_norm: 31.3495  tps: 8,205  tflops: 64.14  mfu: 18.84%
[rank3]:2026-01-01 04:51:34,393 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 04:51:34,393 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 04:51:34,386 - Avg. fwd time: 26.2344 / Avg. bwd time: 28.5010 / Avg. batch time: 1041.1056 (ms) / GPU bubble ratio: 57.94%
[rank0]:2026-01-01 04:51:34,390 -  step: 800  loss: -4.0000  grad_norm: 31.3495  memory: 13.12GiB(27.62%)  tps: 7,725  tflops: 60.39  mfu: 19.36%
[rank0]:2026-01-01 04:51:34,390 - ‚ÑπÔ∏è final step: 800  loss: -4.0000  grad_norm: 31.3495  tps: 8,200  tflops: 64.11  mfu: 18.73%
[rank0]:2026-01-01 04:51:34,390 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 04:51:34,391 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 04:51:37,031 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-01 04:51:37,045 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-01 04:51:37,046 - Destroying the purge thread.
[rank2]:2026-01-01 04:51:37,045 - Destroying the purge thread.
[rank3]:2026-01-01 04:51:37,185 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0451_final800_rank3.svg
[rank3]:			> Batch Time: 1038.38 ms, GPU Bubble Ratio: 57.83%, 45.25%, 56.83%, 33.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  279-28-307ms   | [S0,MB4,F]  307-25-333ms   | [S0,MB1,B]  385-28-413ms   | [S0,MB5,F]  413-25-439ms   | [S0,MB2,B]  491-28-519ms   | [S0,MB6,F]  519-25-545ms   | [S0,MB3,B]  597-28-625ms   | [S0,MB7,F]  625-25-651ms   | [S0,MB4,B]  703-28-731ms   | [S0,MB5,B]  805-28-833ms   | [S0,MB6,B]  907-28-935ms   | [S0,MB7,B]  1010-28-1038ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  230-38-268ms   | [S1,MB3,F]  275-32-308ms   | [S1,MB1,B]  336-38-374ms   | [S1,MB4,F]  381-32-414ms   | [S1,MB2,B]  442-38-480ms   | [S1,MB5,F]  487-32-520ms   | [S1,MB3,B]  547-38-586ms   | [S1,MB6,F]  593-33-626ms   | [S1,MB4,B]  654-38-692ms   | [S1,MB7,F]  699-33-732ms   | [S1,MB5,B]  760-38-798ms   | [S1,MB6,B]  862-37-900ms   | [S1,MB7,B]  965-38-1003ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  190-30-220ms   | [S2,MB2,F]  227-25-253ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  333-25-358ms   | [S2,MB2,B]  401-30-431ms   | [S2,MB4,F]  439-25-464ms   | [S2,MB3,B]  507-30-537ms   | [S2,MB5,F]  545-25-570ms   | [S2,MB4,B]  613-30-643ms   | [S2,MB6,F]  651-25-676ms   | [S2,MB5,B]  720-30-750ms   | [S2,MB7,F]  757-25-782ms   | [S2,MB6,B]  826-30-856ms   | [S2,MB7,B]  928-30-958ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-52-180ms   | [S3,MB1,F]  187-33-220ms   | [S3,MB1,B]  232-53-285ms   | [S3,MB2,F]  292-33-326ms   | [S3,MB2,B]  338-53-391ms   | [S3,MB3,F]  398-33-432ms   | [S3,MB3,B]  444-53-497ms   | [S3,MB4,F]  504-34-538ms   | [S3,MB4,B]  550-53-603ms   | [S3,MB5,F]  610-34-644ms   | [S3,MB5,B]  656-53-709ms   | [S3,MB6,F]  716-33-750ms   | [S3,MB6,B]  762-53-816ms   | [S3,MB7,F]  822-33-856ms   | [S3,MB7,B]  868-53-922ms  
[rank1]:2026-01-01 04:51:37,290 - Process group destroyed
[rank2]:2026-01-01 04:51:37,277 - Process group destroyed
[rank3]:2026-01-01 04:51:37,320 - ‚úÖ Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1/pipeline_schedule/260101_0451_thry_final800_rank3.svg
[rank3]:			> Batch Time: 976.55 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-29-29ms      | [S0,MB1,F]  29-29-59ms     | [S0,MB2,F]  59-29-88ms     | [S0,MB3,F]  88-29-118ms    | [S0,MB0,B]  295-59-355ms   | [S0,MB4,F]  355-29-384ms   | [S0,MB1,B]  384-59-443ms   | [S0,MB5,F]  443-29-473ms   | [S0,MB2,B]  473-59-532ms   | [S0,MB6,F]  532-29-562ms   | [S0,MB3,B]  562-59-621ms   | [S0,MB7,F]  621-29-651ms   | [S0,MB4,B]  651-59-710ms   | [S0,MB5,B]  739-59-798ms   | [S0,MB6,B]  828-59-887ms   | [S0,MB7,B]  917-59-976ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  29-29-59ms     | [S1,MB1,F]  59-29-88ms     | [S1,MB2,F]  88-29-118ms    | [S1,MB0,B]  236-59-295ms   | [S1,MB3,F]  295-29-325ms   | [S1,MB1,B]  325-59-384ms   | [S1,MB4,F]  384-29-414ms   | [S1,MB2,B]  414-59-473ms   | [S1,MB5,F]  473-29-503ms   | [S1,MB3,B]  503-59-562ms   | [S1,MB6,F]  562-29-591ms   | [S1,MB4,B]  591-59-651ms   | [S1,MB7,F]  651-29-680ms   | [S1,MB5,B]  680-59-739ms   | [S1,MB6,B]  769-59-828ms   | [S1,MB7,B]  858-59-917ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  59-29-88ms     | [S2,MB1,F]  88-29-118ms    | [S2,MB0,B]  177-59-236ms   | [S2,MB2,F]  236-29-266ms   | [S2,MB1,B]  266-59-325ms   | [S2,MB3,F]  325-29-355ms   | [S2,MB2,B]  355-59-414ms   | [S2,MB4,F]  414-29-443ms   | [S2,MB3,B]  443-59-503ms   | [S2,MB5,F]  503-29-532ms   | [S2,MB4,B]  532-59-591ms   | [S2,MB6,F]  591-29-621ms   | [S2,MB5,B]  621-59-680ms   | [S2,MB7,F]  680-29-710ms   | [S2,MB6,B]  710-59-769ms   | [S2,MB7,B]  798-59-858ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  88-29-118ms    | [S3,MB0,B]  118-59-177ms   | [S3,MB1,F]  177-29-207ms   | [S3,MB1,B]  207-59-266ms   | [S3,MB2,F]  266-29-295ms   | [S3,MB2,B]  295-59-355ms   | [S3,MB3,F]  355-29-384ms   | [S3,MB3,B]  384-59-443ms   | [S3,MB4,F]  443-29-473ms   | [S3,MB4,B]  473-59-532ms   | [S3,MB5,F]  532-29-562ms   | [S3,MB5,B]  562-59-621ms   | [S3,MB6,F]  621-29-651ms   | [S3,MB6,B]  651-59-710ms   | [S3,MB7,F]  710-29-739ms   | [S3,MB7,B]  739-59-798ms  
[rank3]:2026-01-01 04:51:37,321 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 268-285
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) ‚ñÅ
[rank3]:wandb:               final/avg_loss ‚ñÅ
[rank3]:wandb:             final/avg_mfu(%) ‚ñÅ
[rank3]:wandb:             final/avg_tflops ‚ñÅ
[rank3]:wandb:    final/avg_throughput(tps) ‚ñÅ
[rank3]:wandb:              final/grad_norm ‚ñÅ
[rank3]:wandb:               final/max_loss ‚ñÅ
[rank3]:wandb:                    grad_norm ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñá‚ñÇ‚ñÅ‚ñÅ‚ñá
[rank3]:wandb: loss_metrics/global_avg_loss ‚ñÉ‚ñá‚ñà‚ñÑ‚ñÇ‚ñá‚ñà‚ñÑ‚ñÇ‚ñá‚ñà‚ñÑ‚ñÅ‚ñÜ‚ñà‚ñÑ‚ñÅ
[rank3]:wandb: loss_metrics/global_max_loss ‚ñÉ‚ñá‚ñà‚ñÑ‚ñÇ‚ñá‚ñà‚ñÑ‚ñÇ‚ñá‚ñà‚ñÑ‚ñÅ‚ñÜ‚ñà‚ñÑ‚ñÅ
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.99387
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 18.84079
[rank3]:wandb:             final/avg_tflops 64.13964
[rank3]:wandb:    final/avg_throughput(tps) 8204.58128
[rank3]:wandb:              final/grad_norm 31.34948
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 31.34948
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: üöÄ View run 1231_1F1B_nofreeze_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/xocziltm
[rank3]:wandb: ‚≠êÔ∏è View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_1F1B_nofreeze_42_dm1/20260101-0354/wandb/run-20260101_035458-xocziltm/logs
[rank3]:2026-01-01 04:51:38,848 - Process group destroyed
[rank0]:2026-01-01 04:51:39,046 - Training completed
[rank0]:2026-01-01 04:51:39,046 - Destroying the purge thread.
[rank0]:2026-01-01 04:51:39,293 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.1', 'layers.2', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.12', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.15', 'norm', 'layers.14', 'layers.13'}
[rank3]:----- TimelyFreeze‚è∞ Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_1F1B_nofreeze_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_1F1B_nofreeze_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_1F1B_nofreeze_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_1F1B_nofreeze_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_1F1B_nofreeze_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_1F1B_nofreeze_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_1F1B_nofreeze_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_1F1B_nofreeze_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
