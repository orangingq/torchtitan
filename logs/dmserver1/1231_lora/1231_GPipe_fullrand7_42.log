
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 19:50:31 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_GPipe_fullrand7_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-31 19:50:39,276 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2025-12-31 19:50:39,274 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank0]:2025-12-31 19:50:39,428 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank3]:2025-12-31 19:50:39,634 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 19:50:39,637 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-31 19:50:39,677 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:2025-12-31 19:50:39,638 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 19:50:39,640 - Building 1-D device mesh with ['pp'], [4]
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank0]:2025-12-31 19:50:39,750 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 19:50:39,752 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 19:50:39,756 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 19:50:39,757 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-31 19:50:39,906 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 19:50:39,908 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 19:50:40,158 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-31 19:50:44,802 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-31 19:50:44,950 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 19:50:44,992 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 19:50:45,024 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-31 19:50:45,025 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-31 19:50:44,969 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 19:50:45,011 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 19:50:45,013 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 19:50:45,040 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-31 19:50:45,040 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-31 19:50:45,225 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 19:50:45,225 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 19:50:45,226 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-31 19:50:45,176 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 19:50:45,227 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 19:50:45,253 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-31 19:50:45,254 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-31 19:50:45,237 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 19:50:45,237 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 19:50:45,237 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-31 19:50:45,494 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 19:50:45,495 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 19:50:45,495 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run kr2gczla
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_GPipe_fullrand7_42_dm1/20251231-1950/wandb/run-20251231_195046-kr2gczla
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_GPipe_fullrand7_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/kr2gczla
[rank3]:2025-12-31 19:50:47,522 - WandB logging enabled
[rank3]:2025-12-31 19:50:47,523 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 19:50:47,561 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 19:50:47,590 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-31 19:50:47,590 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-31 19:50:47,784 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 19:50:47,784 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 19:50:47,785 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-31 19:50:47,800 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 19:50:47,801 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_GPipe_fullrand7_42_dm1
[rank0]:2025-12-31 19:50:47,801 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 19:50:47,801 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 19:50:47,801 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-31 19:50:47,800 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-31 19:50:47,801 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-31 19:50:50,436 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank2]:2025-12-31 19:50:50,424 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank1]:2025-12-31 19:50:50,437 - Freezable Parameters: [Stage 1] 70 params
[rank2]:2025-12-31 19:50:50,425 - Freezable Parameters: [Stage 2] 56 params
[rank0]:2025-12-31 19:50:50,379 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 19:50:50,379 - Finished loading the checkpoint in 2.58 seconds.
[rank0]:2025-12-31 19:50:50,424 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2025-12-31 19:50:50,424 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2025-12-31 19:50:50,424 - Training starts at step 1
[rank3]:2025-12-31 19:50:50,441 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2025-12-31 19:50:50,442 - Freezable Parameters: [Stage 3] 42 params
[rank3]:2025-12-31 19:50:55,588 -  step:  1  loss: 10.6088  grad_norm:  5.6781  memory: 29.95GiB(63.04%)  tps: 4,084  tflops: 31.93  mfu: 10.23%
[rank3]:2025-12-31 19:50:55,588 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 19:50:55,583 -  step:  1  loss: -8.0000  grad_norm:  5.6781  memory: 13.85GiB(29.15%)  tps: 3,094  tflops: 24.19  mfu: 7.75%
[rank1]:2025-12-31 19:50:55,610 -  step:  1  loss: -8.0000  grad_norm:  5.6781  memory: 17.18GiB(36.17%)  tps: 3,156  tflops: 24.67  mfu: 7.91%
[rank1]:2025-12-31 19:50:55,611 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 19:50:55,615 -  step:  1  loss: -8.0000  grad_norm:  5.6781  memory: 14.51GiB(30.55%)  tps: 3,090  tflops: 24.16  mfu: 7.74%
[rank0]:2025-12-31 19:50:55,615 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 19:50:55,584 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 19:52:30,366 - Avg. fwd time: 12.2068 / Avg. bwd time: 12.8447 / Avg. batch time: 419.5230 (ms) / GPU bubble ratio: 52.23%
[rank3]:2025-12-31 19:52:30,348 - Avg. fwd time: 16.4088 / Avg. bwd time: 24.7598 / Avg. batch time: 390.0704 (ms) / GPU bubble ratio: 15.57%
[rank1]:2025-12-31 19:52:30,390 - Avg. fwd time: 15.3824 / Avg. bwd time: 16.4903 / Avg. batch time: 457.3174 (ms) / GPU bubble ratio: 44.24%
[rank0]:2025-12-31 19:52:30,408 - Avg. fwd time: 13.4659 / Avg. bwd time: 12.2376 / Avg. batch time: 488.3049 (ms) / GPU bubble ratio: 57.89%
[rank0]:2025-12-31 19:54:06,203 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 19:54:10,173 - Avg. fwd time: 15.4290 / Avg. bwd time: 16.5378 / Avg. batch time: 458.1698 (ms) / GPU bubble ratio: 44.18%
[rank1]:2025-12-31 19:54:10,193 -  step: 50  loss: -8.0000  grad_norm:  4.3532  memory: 17.18GiB(36.17%)  tps: 8,252  tflops: 64.51  mfu: 20.68%
[rank2]:2025-12-31 19:54:10,147 - Avg. fwd time: 12.2252 / Avg. bwd time: 12.8732 / Avg. batch time: 420.8445 (ms) / GPU bubble ratio: 52.29%
[rank2]:2025-12-31 19:54:10,193 -  step: 50  loss: -8.0000  grad_norm:  4.3532  memory: 13.85GiB(29.15%)  tps: 8,251  tflops: 64.50  mfu: 20.67%
[rank0]:2025-12-31 19:54:10,190 - Avg. fwd time: 13.4381 / Avg. bwd time: 12.2672 / Avg. batch time: 488.7114 (ms) / GPU bubble ratio: 57.92%
[rank0]:2025-12-31 19:54:10,193 -  step: 50  loss: -8.0000  grad_norm:  4.3532  memory: 14.51GiB(30.55%)  tps: 8,252  tflops: 64.51  mfu: 20.68%
[rank3]:2025-12-31 19:54:10,129 - Avg. fwd time: 16.4974 / Avg. bwd time: 24.9768 / Avg. batch time: 391.8579 (ms) / GPU bubble ratio: 15.33%
[rank3]:2025-12-31 19:54:10,195 -  step: 50  loss: 12.4620  grad_norm:  4.3532  memory: 29.95GiB(63.04%)  tps: 8,251  tflops: 64.50  mfu: 20.67%
[rank3]:2025-12-31 19:54:46,168 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-31 19:55:26,285 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-31 19:55:26,396 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-31 19:55:49,410 - Avg. fwd time: 12.2364 / Avg. bwd time: 12.8012 / Avg. batch time: 421.3339 (ms) / GPU bubble ratio: 52.46%
[rank1]:2025-12-31 19:55:49,430 - Avg. fwd time: 15.4591 / Avg. bwd time: 16.4484 / Avg. batch time: 458.3910 (ms) / GPU bubble ratio: 44.31%
[rank0]:2025-12-31 19:55:49,435 - Avg. fwd time: 13.4469 / Avg. bwd time: 11.2964 / Avg. batch time: 487.7810 (ms) / GPU bubble ratio: 59.42%
[rank3]:2025-12-31 19:55:49,392 - Avg. fwd time: 16.5553 / Avg. bwd time: 25.0351 / Avg. batch time: 392.5743 (ms) / GPU bubble ratio: 15.25%
[rank3]:2025-12-31 19:56:04,656 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-31 19:56:04,912 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_1956_max_batch_time.svg
[rank3]:			> Batch Time: 422.35 ms, GPU Bubble Ratio: 51.08%, 39.27%, 52.16%, 19.91%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  230-12-242ms   | [S0,MB1,B]  255-12-268ms   | [S0,MB2,B]  281-12-293ms   | [S0,MB3,B]  306-12-319ms   | [S0,MB4,B]  332-12-344ms   | [S0,MB5,B]  358-12-370ms   | [S0,MB6,B]  384-12-396ms   | [S0,MB7,B]  410-12-422ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-44ms     | [S1,MB2,F]  44-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-138ms   | [S1,MB0,B]  214-16-230ms   | [S1,MB1,B]  239-16-255ms   | [S1,MB2,B]  264-16-281ms   | [S1,MB3,B]  290-16-306ms   | [S1,MB4,B]  315-16-332ms   | [S1,MB5,B]  341-16-358ms   | [S1,MB6,B]  367-16-384ms   | [S1,MB7,B]  393-16-410ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  44-12-57ms     | [S2,MB2,F]  60-12-72ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-119ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  138-12-150ms   | [S2,MB0,B]  201-12-214ms   | [S2,MB1,B]  226-13-239ms   | [S2,MB2,B]  251-12-264ms   | [S2,MB3,B]  277-12-290ms   | [S2,MB4,B]  303-12-315ms   | [S2,MB5,B]  328-12-341ms   | [S2,MB6,B]  354-12-367ms   | [S2,MB7,B]  380-13-393ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-16-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-24-201ms   AFR(10):0.9762 | [S3,MB1,B]  201-25-226ms   AFR(10):0.9762 | [S3,MB2,B]  226-25-251ms   AFR(10):0.9762 | [S3,MB3,B]  251-25-277ms   AFR(10):0.9762 | [S3,MB4,B]  277-25-303ms   AFR(10):0.9762 | [S3,MB5,B]  303-25-328ms   AFR(10):0.9762 | [S3,MB6,B]  328-25-354ms   AFR(10):0.9762 | [S3,MB7,B]  354-25-380ms   AFR(10):0.9762
[rank3]:2025-12-31 19:56:05,040 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_1956_min_batch_time.svg
[rank3]:			> Batch Time: 398.44 ms, GPU Bubble Ratio: 72.93%, 38.75%, 51.66%, 17.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  226-0-226ms    | [S0,MB1,B]  250-0-250ms    | [S0,MB2,B]  275-0-275ms    | [S0,MB3,B]  299-0-299ms    | [S0,MB4,B]  324-0-324ms    | [S0,MB5,B]  348-0-348ms    | [S0,MB6,B]  373-0-373ms    | [S0,MB7,B]  398-0-398ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-44ms     | [S1,MB2,F]  44-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-138ms   | [S1,MB0,B]  211-14-226ms   | [S1,MB1,B]  235-14-250ms   | [S1,MB2,B]  260-14-275ms   | [S1,MB3,B]  284-14-299ms   | [S1,MB4,B]  309-14-324ms   | [S1,MB5,B]  333-15-348ms   | [S1,MB6,B]  358-15-373ms   | [S1,MB7,B]  383-15-398ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  44-12-57ms     | [S2,MB2,F]  60-12-72ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-119ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  138-12-150ms   | [S2,MB0,B]  200-11-211ms   | [S2,MB1,B]  224-11-235ms   | [S2,MB2,B]  248-11-260ms   | [S2,MB3,B]  272-11-284ms   | [S2,MB4,B]  297-11-309ms   | [S2,MB5,B]  322-11-333ms   | [S2,MB6,B]  346-11-358ms   | [S2,MB7,B]  371-11-383ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-16-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-23-200ms   AFR(10):0.9762 | [S3,MB1,B]  200-24-224ms   AFR(10):0.9762 | [S3,MB2,B]  224-24-248ms   AFR(10):0.9762 | [S3,MB3,B]  248-24-272ms   AFR(10):0.9762 | [S3,MB4,B]  272-24-297ms   AFR(10):0.9762 | [S3,MB5,B]  297-24-322ms   AFR(10):0.9762 | [S3,MB6,B]  322-24-346ms   AFR(10):0.9762 | [S3,MB7,B]  346-24-371ms   AFR(10):0.9762
[rank3]:2025-12-31 19:56:05,178 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_1956_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 399.93 ms, GPU Bubble Ratio: 51.39%, 36.32%, 49.78%, 17.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  229-12-241ms   | [S0,MB1,B]  253-12-265ms   | [S0,MB2,B]  277-12-290ms   | [S0,MB3,B]  302-12-315ms   | [S0,MB4,B]  327-12-339ms   | [S0,MB5,B]  352-12-364ms   | [S0,MB6,B]  377-12-389ms   | [S0,MB7,B]  399-0-399ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-44ms     | [S1,MB2,F]  44-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-138ms   | [S1,MB0,B]  212-16-229ms   | [S1,MB1,B]  237-16-253ms   | [S1,MB2,B]  261-16-277ms   | [S1,MB3,B]  286-16-302ms   | [S1,MB4,B]  311-16-327ms   | [S1,MB5,B]  335-16-352ms   | [S1,MB6,B]  360-16-377ms   | [S1,MB7,B]  384-15-399ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  44-12-57ms     | [S2,MB2,F]  60-12-72ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-119ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  138-12-150ms   | [S2,MB0,B]  200-12-212ms   | [S2,MB1,B]  224-13-237ms   | [S2,MB2,B]  248-12-261ms   | [S2,MB3,B]  273-12-286ms   | [S2,MB4,B]  298-12-311ms   | [S2,MB5,B]  322-12-335ms   | [S2,MB6,B]  347-12-360ms   | [S2,MB7,B]  373-11-384ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-16-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-23-200ms   AFR(10):0.9762 | [S3,MB1,B]  200-24-224ms   AFR(10):0.9762 | [S3,MB2,B]  224-24-248ms   AFR(10):0.9762 | [S3,MB3,B]  248-25-273ms   AFR(10):0.9762 | [S3,MB4,B]  273-24-298ms   AFR(10):0.9762 | [S3,MB5,B]  298-24-322ms   AFR(10):0.9762 | [S3,MB6,B]  322-24-347ms   AFR(10):0.9762 | [S3,MB7,B]  347-25-373ms   AFR(10):0.9762
[rank3]:2025-12-31 19:56:05,179 - 	> Batch Time: 399.93 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.05)
[rank2]:2025-12-31 19:57:24,862 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank3]:2025-12-31 19:57:24,815 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.26(0.33)/1.00, [MB1] 0.26(0.33)/1.00, [MB2] 0.26(0.33)/1.00, [MB3] 0.10(0.13)/0.40, [MB4] 0.26(0.33)/1.00, [MB5] 0.26(0.33)/1.00, [MB6] 0.26(0.33)/1.00, [MB7] 0.00(0.00)/0.00
[rank1]:2025-12-31 19:57:24,896 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-31 19:57:24,901 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 19:57:24,902 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-31 19:57:28,933 - Avg. fwd time: 15.4864 / Avg. bwd time: 16.6190 / Avg. batch time: 459.6798 (ms) / GPU bubble ratio: 44.13%
[rank1]:2025-12-31 19:57:28,953 -  step: 100  loss: -8.0000  grad_norm:  3.3786  memory: 17.18GiB(36.17%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank2]:2025-12-31 19:57:28,901 - Avg. fwd time: 12.2440 / Avg. bwd time: 12.7703 / Avg. batch time: 421.4888 (ms) / GPU bubble ratio: 52.52%
[rank2]:2025-12-31 19:57:28,953 -  step: 100  loss: -8.0000  grad_norm:  3.3786  memory: 13.85GiB(29.15%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank0]:2025-12-31 19:57:28,950 - Avg. fwd time: 13.4572 / Avg. bwd time: 10.8992 / Avg. batch time: 487.5657 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-12-31 19:57:28,954 -  step: 100  loss: -8.0000  grad_norm:  3.3786  memory: 14.51GiB(30.55%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank3]:2025-12-31 19:57:28,882 - Avg. fwd time: 16.5938 / Avg. bwd time: 25.0061 / Avg. batch time: 392.5419 (ms) / GPU bubble ratio: 15.22%
[rank3]:2025-12-31 19:57:28,956 -  step: 100  loss: 13.1172  grad_norm:  3.3786  memory: 29.95GiB(63.04%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank1]:2025-12-31 19:57:29,015 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_1957_stage1_step100.svg
[rank2]:2025-12-31 19:57:29,015 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_1957_stage2_step100.svg
[rank0]:2025-12-31 19:57:29,016 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_1957_stage0_step100.svg
[rank3]:2025-12-31 19:57:29,092 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_1957_step100_rank3.svg
[rank3]:			> Batch Time: 497.88 ms, GPU Bubble Ratio: 58.61%, 46.80%, 59.54%, 32.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  326-12-338ms   | [S0,MB2,B]  351-12-363ms   | [S0,MB3,B]  376-12-388ms   | [S0,MB4,B]  401-12-414ms   | [S0,MB5,B]  426-12-439ms   | [S0,MB6,B]  458-12-470ms   | [S0,MB7,B]  486-11-497ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-87ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-135ms   | [S1,MB6,F]  144-15-159ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  331-16-347ms   | [S1,MB3,B]  356-16-372ms   | [S1,MB4,B]  381-16-398ms   | [S1,MB5,B]  406-16-423ms   | [S1,MB6,B]  432-18-450ms   | [S1,MB7,B]  458-23-482ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  165-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  290-12-303ms   | [S2,MB2,B]  315-12-328ms   | [S2,MB3,B]  340-12-353ms   | [S2,MB4,B]  365-12-378ms   | [S2,MB5,B]  390-12-403ms   | [S2,MB6,B]  416-12-429ms   | [S2,MB7,B]  439-12-451ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  65-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-24-258ms   | [S3,MB1,B]  258-24-283ms   | [S3,MB2,B]  283-24-308ms   | [S3,MB3,B]  308-25-333ms   | [S3,MB4,B]  333-25-359ms   | [S3,MB5,B]  359-25-384ms   | [S3,MB6,B]  384-25-409ms   | [S3,MB7,B]  409-25-435ms  
[rank3]:2025-12-31 19:57:29,133 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_1957_stage3_step100.svg
[rank1]:2025-12-31 19:57:29,204 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_1957_rank1_stage1.svg
[rank1]:	> Counts Sum: 51920, Total Sum: 134400 (38.63%), Ratio(%) per element: [37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 41.66, 41.66, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 41.66, 41.66, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5]
[rank2]:2025-12-31 19:57:29,189 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_1957_rank2_stage2.svg
[rank2]:	> Counts Sum: 41520, Total Sum: 107520 (38.62%), Ratio(%) per element: [37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 41.66, 37.5, 41.66]
[rank0]:2025-12-31 19:57:29,191 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_1957_rank0_stage0.svg
[rank0]:	> Counts Sum: 41520, Total Sum: 107520 (38.62%), Ratio(%) per element: [41.66, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5]
[rank3]:2025-12-31 19:57:29,272 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_1957_rank3_stage3.svg
[rank3]:	> Counts Sum: 53360, Total Sum: 80640 (66.17%), Ratio(%) per element: [58.33, 70.83, 79.16, 66.66, 70.83, 58.33, 62.5, 66.66, 75.0, 66.66, 66.66, 70.83, 58.33, 70.83, 66.66, 62.5, 62.5, 66.66, 66.66, 66.66, 58.33, 75.0, 75.0, 54.16, 62.5, 62.5, 66.66, 62.5, 62.5, 70.83, 70.83, 66.66, 62.5, 66.66, 70.83, 62.5, 66.66, 75.0, 58.33, 66.66, 66.66, 62.5]
[rank1]:2025-12-31 19:57:29,293 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_1957_stage1.svg
[rank2]:2025-12-31 19:57:29,279 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_1957_stage2.svg
[rank0]:2025-12-31 19:57:29,280 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_1957_stage0.svg
[rank3]:2025-12-31 19:57:29,361 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_1957_stage3.svg
[rank1]:2025-12-31 19:59:10,470 - Avg. fwd time: 15.4983 / Avg. bwd time: 16.7946 / Avg. batch time: 460.9436 (ms) / GPU bubble ratio: 43.95%
[rank0]:2025-12-31 19:59:10,486 - Avg. fwd time: 13.4586 / Avg. bwd time: 11.1650 / Avg. batch time: 489.1781 (ms) / GPU bubble ratio: 59.73%
[rank2]:2025-12-31 19:59:10,443 - Avg. fwd time: 12.2499 / Avg. bwd time: 12.7959 / Avg. batch time: 421.8772 (ms) / GPU bubble ratio: 52.51%
[rank3]:2025-12-31 19:59:10,425 - Avg. fwd time: 16.6218 / Avg. bwd time: 25.0488 / Avg. batch time: 393.0490 (ms) / GPU bubble ratio: 15.18%
[rank3]:2025-12-31 20:00:47,601 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.60(0.67)/1.00, [MB1] 0.60(0.67)/1.00, [MB2] 0.60(0.67)/1.00, [MB3] 0.24(0.27)/0.40, [MB4] 0.60(0.67)/1.00, [MB5] 0.60(0.67)/1.00, [MB6] 0.60(0.67)/1.00, [MB7] 0.00(0.00)/0.00
[rank1]:2025-12-31 20:00:47,686 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank0]:2025-12-31 20:00:47,687 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 20:00:47,688 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank2]:2025-12-31 20:00:47,649 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank2]:2025-12-31 20:00:51,732 - Avg. fwd time: 12.2550 / Avg. bwd time: 12.8150 / Avg. batch time: 422.0938 (ms) / GPU bubble ratio: 52.48%
[rank3]:2025-12-31 20:00:51,714 - Avg. fwd time: 16.6465 / Avg. bwd time: 25.0704 / Avg. batch time: 393.3806 (ms) / GPU bubble ratio: 15.16%
[rank1]:2025-12-31 20:00:51,760 - Avg. fwd time: 15.5097 / Avg. bwd time: 16.9452 / Avg. batch time: 461.9457 (ms) / GPU bubble ratio: 43.79%
[rank1]:2025-12-31 20:00:51,781 -  step: 150  loss: -8.0000  grad_norm:  4.1175  memory: 17.18GiB(36.17%)  tps: 8,078  tflops: 63.15  mfu: 20.24%
[rank0]:2025-12-31 20:00:51,778 - Avg. fwd time: 13.4579 / Avg. bwd time: 11.3291 / Avg. batch time: 490.2796 (ms) / GPU bubble ratio: 59.55%
[rank0]:2025-12-31 20:00:51,782 -  step: 150  loss: -8.0000  grad_norm:  4.1175  memory: 14.51GiB(30.55%)  tps: 8,078  tflops: 63.15  mfu: 20.24%
[rank2]:2025-12-31 20:00:51,781 -  step: 150  loss: -8.0000  grad_norm:  4.1175  memory: 13.85GiB(29.15%)  tps: 8,078  tflops: 63.15  mfu: 20.24%
[rank3]:2025-12-31 20:00:51,784 -  step: 150  loss: 11.1241  grad_norm:  4.1175  memory: 29.95GiB(63.04%)  tps: 8,078  tflops: 63.15  mfu: 20.24%
[rank3]:2025-12-31 20:02:32,478 - Avg. fwd time: 16.6684 / Avg. bwd time: 25.0743 / Avg. batch time: 393.5609 (ms) / GPU bubble ratio: 15.15%
[rank2]:2025-12-31 20:02:32,497 - Avg. fwd time: 12.2596 / Avg. bwd time: 12.8215 / Avg. batch time: 422.1597 (ms) / GPU bubble ratio: 52.47%
[rank0]:2025-12-31 20:02:32,536 - Avg. fwd time: 13.4578 / Avg. bwd time: 11.4241 / Avg. batch time: 490.6823 (ms) / GPU bubble ratio: 59.43%
[rank1]:2025-12-31 20:02:32,523 - Avg. fwd time: 15.5191 / Avg. bwd time: 17.0473 / Avg. batch time: 462.4668 (ms) / GPU bubble ratio: 43.66%
[rank3]:2025-12-31 20:04:07,550 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.93(1.00)/1.00, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.38(0.40)/0.40, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.00(0.00)/0.00
[rank2]:2025-12-31 20:04:07,608 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-31 20:04:07,630 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 20:04:07,630 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-12-31 20:04:07,634 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank3]:2025-12-31 20:04:11,561 - Avg. fwd time: 16.6857 / Avg. bwd time: 25.0621 / Avg. batch time: 393.5790 (ms) / GPU bubble ratio: 15.14%
[rank3]:2025-12-31 20:04:11,619 -  step: 200  loss: 10.2906  grad_norm: 17.1682  memory: 29.95GiB(63.04%)  tps: 8,199  tflops: 64.10  mfu: 20.54%
[rank2]:2025-12-31 20:04:11,580 - Avg. fwd time: 12.2635 / Avg. bwd time: 12.8258 / Avg. batch time: 422.0621 (ms) / GPU bubble ratio: 52.44%
[rank2]:2025-12-31 20:04:11,617 -  step: 200  loss: -8.0000  grad_norm: 17.1682  memory: 13.85GiB(29.15%)  tps: 8,199  tflops: 64.09  mfu: 20.54%
[rank2]:2025-12-31 20:04:11,671 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_2004_stage2_step200.svg
[rank0]:2025-12-31 20:04:11,613 - Avg. fwd time: 13.4588 / Avg. bwd time: 11.4102 / Avg. batch time: 489.9461 (ms) / GPU bubble ratio: 59.39%
[rank0]:2025-12-31 20:04:11,617 -  step: 200  loss: -8.0000  grad_norm: 17.1682  memory: 14.51GiB(30.55%)  tps: 8,199  tflops: 64.09  mfu: 20.54%
[rank0]:2025-12-31 20:04:11,669 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_2004_stage0_step200.svg
[rank1]:2025-12-31 20:04:11,607 - Avg. fwd time: 15.5278 / Avg. bwd time: 17.0903 / Avg. batch time: 462.4988 (ms) / GPU bubble ratio: 43.58%
[rank1]:2025-12-31 20:04:11,617 -  step: 200  loss: -8.0000  grad_norm: 17.1682  memory: 17.18GiB(36.17%)  tps: 8,199  tflops: 64.09  mfu: 20.54%
[rank1]:2025-12-31 20:04:11,668 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_2004_stage1_step200.svg
[rank3]:2025-12-31 20:04:11,760 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2004_step200_rank3.svg
[rank3]:			> Batch Time: 481.46 ms, GPU Bubble Ratio: 59.25%, 45.24%, 58.28%, 30.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  326-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  400-12-412ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  455-12-468ms   | [S0,MB7,B]  479-2-481ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  145-15-160ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  282-16-298ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-347ms   | [S1,MB3,B]  356-16-372ms   | [S1,MB4,B]  380-16-397ms   | [S1,MB5,B]  405-16-422ms   | [S1,MB6,B]  430-20-450ms   | [S1,MB7,B]  456-19-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-130ms   | [S2,MB5,F]  142-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  191-12-203ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  314-12-327ms   | [S2,MB3,B]  339-12-352ms   | [S2,MB4,B]  364-12-377ms   | [S2,MB5,B]  389-12-402ms   | [S2,MB6,B]  414-12-427ms   | [S2,MB7,B]  436-11-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-107ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  188-16-204ms   | [S3,MB7,F]  212-16-229ms   | [S3,MB0,B]  235-23-259ms   | [S3,MB1,B]  259-24-283ms   | [S3,MB2,B]  283-24-307ms   | [S3,MB3,B]  307-25-333ms   | [S3,MB4,B]  333-24-357ms   | [S3,MB5,B]  357-24-382ms   | [S3,MB6,B]  382-24-407ms   | [S3,MB7,B]  407-26-433ms  
[rank3]:2025-12-31 20:04:11,803 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_2004_stage3_step200.svg
[rank2]:2025-12-31 20:04:11,843 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2004_rank2_stage2.svg
[rank2]:	> Counts Sum: 69920, Total Sum: 465920 (15.01%), Ratio(%) per element: [14.42, 16.34, 14.42, 14.42, 15.38, 14.42, 17.3, 13.46, 15.38, 16.34, 15.38, 14.42, 16.34, 15.38, 15.38, 12.5, 16.34, 14.42, 15.38, 15.38, 11.53, 15.38, 15.38, 13.46, 16.34, 12.5, 15.38, 17.3, 14.42, 15.38, 15.38, 15.38, 14.42, 11.53, 15.38, 14.42, 17.3, 16.34, 12.5, 14.42, 16.34, 15.38, 15.38, 13.46, 15.38, 13.46, 16.34, 13.46, 16.34, 15.38, 15.38, 13.46, 16.34, 13.46, 15.38, 18.26]
[rank0]:2025-12-31 20:04:11,835 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2004_rank0_stage0.svg
[rank0]:	> Counts Sum: 69920, Total Sum: 465920 (15.01%), Ratio(%) per element: [16.34, 17.3, 17.3, 17.3, 17.3, 18.26, 18.26, 18.26, 16.34, 16.34, 15.38, 18.26, 17.3, 15.38, 16.34, 17.3, 15.38, 14.42, 16.34, 16.34, 16.34, 15.38, 15.38, 16.34, 17.3, 14.42, 16.34, 16.34, 15.38, 14.42, 11.53, 17.3, 14.42, 16.34, 13.46, 16.34, 15.38, 11.53, 14.42, 13.46, 15.38, 15.38, 14.42, 11.53, 13.46, 13.46, 16.34, 11.53, 10.57, 10.57, 13.46, 11.53, 14.42, 12.5, 9.61, 8.65]
[rank1]:2025-12-31 20:04:11,847 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2004_rank1_stage1.svg
[rank1]:	> Counts Sum: 87360, Total Sum: 582400 (15.00%), Ratio(%) per element: [14.42, 16.34, 13.46, 15.38, 11.53, 14.42, 14.42, 14.42, 13.46, 15.38, 17.3, 15.38, 16.34, 16.34, 14.42, 14.42, 17.3, 13.46, 16.34, 16.34, 13.46, 12.5, 14.42, 12.5, 15.38, 16.34, 16.34, 14.42, 15.38, 15.38, 15.38, 14.42, 15.38, 17.3, 13.46, 16.34, 16.34, 16.34, 14.42, 12.5, 12.5, 14.42, 15.38, 18.26, 16.34, 16.34, 15.38, 16.34, 14.42, 12.5, 13.46, 15.38, 17.3, 12.5, 16.34, 13.46, 15.38, 16.34, 15.38, 17.3, 14.42, 15.38, 15.38, 16.34, 13.46, 13.46, 15.38, 13.46, 13.46, 15.38]
[rank3]:2025-12-31 20:04:11,943 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2004_rank3_stage3.svg
[rank3]:	> Counts Sum: 189600, Total Sum: 349440 (54.26%), Ratio(%) per element: [53.84, 50.96, 56.73, 59.61, 51.92, 49.03, 50.96, 52.88, 60.57, 54.8, 59.61, 54.8, 53.84, 59.61, 51.92, 50.96, 54.8, 51.92, 59.61, 53.84, 51.92, 58.65, 58.65, 44.23, 53.84, 50.0, 58.65, 51.92, 54.8, 58.65, 64.42, 50.0, 54.8, 52.88, 53.84, 55.76, 49.03, 53.84, 47.11, 55.76, 53.84, 53.84]
[rank0]:2025-12-31 20:04:12,172 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2004_stage0.svg
[rank1]:2025-12-31 20:04:12,186 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2004_stage1.svg
[rank2]:2025-12-31 20:04:12,195 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2004_stage2.svg
[rank3]:2025-12-31 20:04:12,292 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2004_stage3.svg
[rank2]:2025-12-31 20:05:50,109 - Avg. fwd time: 12.2655 / Avg. bwd time: 12.8241 / Avg. batch time: 421.8247 (ms) / GPU bubble ratio: 52.42%
[rank3]:2025-12-31 20:05:50,090 - Avg. fwd time: 16.6943 / Avg. bwd time: 25.0348 / Avg. batch time: 393.4116 (ms) / GPU bubble ratio: 15.14%
[rank0]:2025-12-31 20:05:50,143 - Avg. fwd time: 13.4633 / Avg. bwd time: 11.3424 / Avg. batch time: 488.7495 (ms) / GPU bubble ratio: 59.40%
[rank1]:2025-12-31 20:05:50,137 - Avg. fwd time: 15.5378 / Avg. bwd time: 17.1149 / Avg. batch time: 462.3414 (ms) / GPU bubble ratio: 43.50%
[rank3]:2025-12-31 20:07:24,203 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(1.00)/1.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 0.40(0.40)/0.40, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.00(0.00)/0.00
[rank1]:2025-12-31 20:07:24,296 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-31 20:07:24,286 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 20:07:24,287 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-31 20:07:24,264 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-31 20:07:28,149 - Avg. fwd time: 16.6960 / Avg. bwd time: 25.0019 / Avg. batch time: 393.1498 (ms) / GPU bubble ratio: 15.15%
[rank1]:2025-12-31 20:07:28,197 - Avg. fwd time: 15.5442 / Avg. bwd time: 17.1597 / Avg. batch time: 462.2377 (ms) / GPU bubble ratio: 43.40%
[rank1]:2025-12-31 20:07:28,208 -  step: 250  loss: -8.0000  grad_norm:  2.9429  memory: 17.18GiB(36.17%)  tps: 8,334  tflops: 65.15  mfu: 20.88%
[rank0]:2025-12-31 20:07:28,204 - Avg. fwd time: 13.4662 / Avg. bwd time: 11.2870 / Avg. batch time: 487.8238 (ms) / GPU bubble ratio: 59.41%
[rank0]:2025-12-31 20:07:28,208 -  step: 250  loss: -8.0000  grad_norm:  2.9429  memory: 14.51GiB(30.55%)  tps: 8,334  tflops: 65.15  mfu: 20.88%
[rank2]:2025-12-31 20:07:28,168 - Avg. fwd time: 12.2658 / Avg. bwd time: 12.8212 / Avg. batch time: 421.4675 (ms) / GPU bubble ratio: 52.38%
[rank2]:2025-12-31 20:07:28,208 -  step: 250  loss: -8.0000  grad_norm:  2.9429  memory: 13.85GiB(29.15%)  tps: 8,334  tflops: 65.15  mfu: 20.88%
[rank3]:2025-12-31 20:07:28,210 -  step: 250  loss: 12.5257  grad_norm:  2.9429  memory: 29.95GiB(63.04%)  tps: 8,334  tflops: 65.15  mfu: 20.88%
[rank2]:2025-12-31 20:09:06,653 - Avg. fwd time: 12.2661 / Avg. bwd time: 12.8189 / Avg. batch time: 421.1621 (ms) / GPU bubble ratio: 52.35%
[rank3]:2025-12-31 20:09:06,633 - Avg. fwd time: 16.6968 / Avg. bwd time: 24.9744 / Avg. batch time: 392.9261 (ms) / GPU bubble ratio: 15.16%
[rank0]:2025-12-31 20:09:06,694 - Avg. fwd time: 13.4742 / Avg. bwd time: 11.2418 / Avg. batch time: 487.2285 (ms) / GPU bubble ratio: 59.42%
[rank1]:2025-12-31 20:09:06,687 - Avg. fwd time: 15.5483 / Avg. bwd time: 17.2237 / Avg. batch time: 462.3023 (ms) / GPU bubble ratio: 43.29%
[rank3]:2025-12-31 20:10:41,063 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(1.00)/1.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 0.40(0.40)/0.40, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.00(0.00)/0.00
[rank2]:2025-12-31 20:10:41,126 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-31 20:10:41,149 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 20:10:41,150 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-31 20:10:41,157 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-31 20:10:45,025 - Avg. fwd time: 16.7016 / Avg. bwd time: 24.9601 / Avg. batch time: 392.8391 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-31 20:10:45,045 - Avg. fwd time: 12.2669 / Avg. bwd time: 12.8177 / Avg. batch time: 421.0102 (ms) / GPU bubble ratio: 52.33%
[rank2]:2025-12-31 20:10:45,087 -  step: 300  loss: -8.0000  grad_norm:  3.1019  memory: 13.85GiB(29.15%)  tps: 8,322  tflops: 65.06  mfu: 20.85%
[rank0]:2025-12-31 20:10:45,083 - Avg. fwd time: 13.4786 / Avg. bwd time: 11.2048 / Avg. batch time: 486.7024 (ms) / GPU bubble ratio: 59.43%
[rank0]:2025-12-31 20:10:45,088 -  step: 300  loss: -8.0000  grad_norm:  3.1019  memory: 14.51GiB(30.55%)  tps: 8,322  tflops: 65.06  mfu: 20.85%
[rank1]:2025-12-31 20:10:45,075 - Avg. fwd time: 15.5546 / Avg. bwd time: 17.2571 / Avg. batch time: 462.3302 (ms) / GPU bubble ratio: 43.22%
[rank1]:2025-12-31 20:10:45,087 -  step: 300  loss: -8.0000  grad_norm:  3.1019  memory: 17.18GiB(36.17%)  tps: 8,322  tflops: 65.06  mfu: 20.85%
[rank3]:2025-12-31 20:10:45,090 -  step: 300  loss: 12.9454  grad_norm:  3.1019  memory: 29.95GiB(63.04%)  tps: 8,322  tflops: 65.06  mfu: 20.85%
[rank2]:2025-12-31 20:10:45,140 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_2010_stage2_step300.svg
[rank0]:2025-12-31 20:10:45,140 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_2010_stage0_step300.svg
[rank1]:2025-12-31 20:10:45,141 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_2010_stage1_step300.svg
[rank3]:2025-12-31 20:10:45,235 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2010_step300_rank3.svg
[rank3]:			> Batch Time: 480.50 ms, GPU Bubble Ratio: 59.60%, 44.68%, 58.23%, 30.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-12-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  302-12-314ms   | [S0,MB1,B]  327-12-339ms   | [S0,MB2,B]  351-12-363ms   | [S0,MB3,B]  376-12-388ms   | [S0,MB4,B]  400-12-413ms   | [S0,MB5,B]  426-12-439ms   | [S0,MB6,B]  457-12-470ms   | [S0,MB7,B]  480-0-480ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB3,F]  73-15-88ms     | [S1,MB4,F]  97-15-113ms    | [S1,MB5,F]  121-15-137ms   | [S1,MB6,F]  146-15-161ms   | [S1,MB7,F]  170-15-186ms   | [S1,MB0,B]  282-16-298ms   | [S1,MB1,B]  307-16-323ms   | [S1,MB2,B]  331-16-347ms   | [S1,MB3,B]  356-16-373ms   | [S1,MB4,B]  381-16-397ms   | [S1,MB5,B]  405-16-422ms   | [S1,MB6,B]  430-22-452ms   | [S1,MB7,B]  458-19-478ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-106ms    | [S2,MB4,F]  117-12-130ms   | [S2,MB5,F]  142-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  191-12-203ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  339-12-352ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  388-12-401ms   | [S2,MB6,B]  412-12-425ms   | [S2,MB7,B]  436-11-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-83ms     | [S3,MB2,F]  90-16-107ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  139-16-156ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  188-16-204ms   | [S3,MB7,F]  212-17-229ms   | [S3,MB0,B]  235-24-259ms   | [S3,MB1,B]  259-24-283ms   | [S3,MB2,B]  283-24-307ms   | [S3,MB3,B]  307-25-332ms   | [S3,MB4,B]  332-24-357ms   | [S3,MB5,B]  357-24-382ms   | [S3,MB6,B]  382-24-406ms   | [S3,MB7,B]  406-26-432ms  
[rank2]:2025-12-31 20:10:45,313 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2010_rank2_stage2.svg
[rank2]:	> Counts Sum: 114720, Total Sum: 824320 (13.92%), Ratio(%) per element: [13.58, 14.67, 13.58, 13.58, 14.13, 13.58, 15.21, 13.04, 14.13, 14.67, 14.13, 13.58, 14.67, 14.13, 14.13, 12.5, 14.67, 13.58, 14.13, 14.13, 11.95, 14.13, 14.13, 13.04, 14.67, 12.5, 14.13, 15.21, 13.58, 14.13, 14.13, 14.13, 13.58, 11.95, 14.13, 13.58, 15.21, 14.67, 12.5, 13.58, 14.67, 14.13, 14.13, 13.04, 14.13, 13.04, 14.67, 13.04, 14.67, 14.13, 14.13, 13.04, 14.67, 13.04, 14.13, 15.76]
[rank0]:2025-12-31 20:10:45,312 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2010_rank0_stage0.svg
[rank0]:	> Counts Sum: 114720, Total Sum: 824320 (13.92%), Ratio(%) per element: [14.67, 15.21, 15.21, 15.21, 15.21, 15.76, 15.76, 15.76, 14.67, 14.67, 14.13, 15.76, 15.21, 14.13, 14.67, 15.21, 14.13, 13.58, 14.67, 14.67, 14.67, 14.13, 14.13, 14.67, 15.21, 13.58, 14.67, 14.67, 14.13, 13.58, 11.95, 15.21, 13.58, 14.67, 13.04, 14.67, 14.13, 11.95, 13.58, 13.04, 14.13, 14.13, 13.58, 11.95, 13.04, 13.04, 14.67, 11.95, 11.41, 11.41, 13.04, 11.95, 13.58, 12.5, 10.86, 10.32]
[rank3]:2025-12-31 20:10:45,279 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_2010_stage3_step300.svg
[rank1]:2025-12-31 20:10:45,327 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2010_rank1_stage1.svg
[rank1]:	> Counts Sum: 143360, Total Sum: 1030400 (13.91%), Ratio(%) per element: [13.58, 14.67, 13.04, 14.13, 11.95, 13.58, 13.58, 13.58, 13.04, 14.13, 15.21, 14.13, 14.67, 14.67, 13.58, 13.58, 15.21, 13.04, 14.67, 14.67, 13.04, 12.5, 13.58, 12.5, 14.13, 14.67, 14.67, 13.58, 14.13, 14.13, 14.13, 13.58, 14.13, 15.21, 13.04, 14.67, 14.67, 14.67, 13.58, 12.5, 12.5, 13.58, 14.13, 15.76, 14.67, 14.67, 14.13, 14.67, 13.58, 12.5, 13.04, 14.13, 15.21, 12.5, 14.67, 13.04, 14.13, 14.67, 14.13, 15.21, 13.58, 14.13, 14.13, 14.67, 13.04, 13.04, 14.13, 13.04, 13.04, 14.13]
[rank3]:2025-12-31 20:10:45,422 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2010_rank3_stage3.svg
[rank3]:	> Counts Sum: 404800, Total Sum: 618240 (65.48%), Ratio(%) per element: [63.58, 63.04, 66.3, 70.1, 64.67, 62.5, 66.3, 65.21, 69.02, 64.67, 69.02, 64.67, 64.13, 68.47, 64.67, 63.04, 66.3, 64.13, 68.47, 65.76, 64.13, 67.93, 67.39, 58.69, 64.13, 63.04, 68.47, 63.04, 66.3, 67.39, 72.28, 64.13, 65.21, 65.21, 65.21, 66.3, 61.95, 64.67, 61.41, 67.39, 66.3, 65.21]
[rank2]:2025-12-31 20:10:45,920 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2010_stage2.svg
[rank0]:2025-12-31 20:10:45,910 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2010_stage0.svg
[rank1]:2025-12-31 20:10:45,924 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2010_stage1.svg
[rank3]:2025-12-31 20:10:46,019 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2010_stage3.svg
[rank3]:2025-12-31 20:12:24,335 - Avg. fwd time: 16.7081 / Avg. bwd time: 24.9541 / Avg. batch time: 392.8375 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-31 20:12:24,356 - Avg. fwd time: 12.2682 / Avg. bwd time: 12.8190 / Avg. batch time: 420.9885 (ms) / GPU bubble ratio: 52.33%
[rank0]:2025-12-31 20:12:24,392 - Avg. fwd time: 13.4831 / Avg. bwd time: 11.1738 / Avg. batch time: 486.3299 (ms) / GPU bubble ratio: 59.44%
[rank1]:2025-12-31 20:12:24,384 - Avg. fwd time: 15.5624 / Avg. bwd time: 17.2813 / Avg. batch time: 462.4333 (ms) / GPU bubble ratio: 43.18%
[rank0]:2025-12-31 20:13:59,092 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 20:14:03,080 - Avg. fwd time: 13.4854 / Avg. bwd time: 11.1475 / Avg. batch time: 486.0515 (ms) / GPU bubble ratio: 59.46%
[rank1]:2025-12-31 20:14:03,071 - Avg. fwd time: 15.5681 / Avg. bwd time: 17.3167 / Avg. batch time: 462.5666 (ms) / GPU bubble ratio: 43.13%
[rank1]:2025-12-31 20:14:03,083 -  step: 350  loss: -8.0000  grad_norm:  3.2555  memory: 17.18GiB(36.17%)  tps: 8,275  tflops: 64.69  mfu: 20.73%
[rank2]:2025-12-31 20:14:03,043 - Avg. fwd time: 12.2697 / Avg. bwd time: 12.8191 / Avg. batch time: 420.9383 (ms) / GPU bubble ratio: 52.32%
[rank2]:2025-12-31 20:14:03,083 -  step: 350  loss: -8.0000  grad_norm:  3.2555  memory: 13.85GiB(29.15%)  tps: 8,275  tflops: 64.69  mfu: 20.73%
[rank3]:2025-12-31 20:14:03,022 - Avg. fwd time: 16.7141 / Avg. bwd time: 24.9481 / Avg. batch time: 392.8321 (ms) / GPU bubble ratio: 15.16%
[rank3]:2025-12-31 20:14:03,086 -  step: 350  loss: 11.1852  grad_norm:  3.2555  memory: 29.95GiB(63.04%)  tps: 8,275  tflops: 64.69  mfu: 20.73%
[rank0]:2025-12-31 20:14:03,084 -  step: 350  loss: -8.0000  grad_norm:  3.2555  memory: 14.51GiB(30.55%)  tps: 8,275  tflops: 64.69  mfu: 20.73%
[rank3]:2025-12-31 20:15:41,629 - Avg. fwd time: 16.7164 / Avg. bwd time: 24.9370 / Avg. batch time: 392.7548 (ms) / GPU bubble ratio: 15.16%
[rank0]:2025-12-31 20:15:41,688 - Avg. fwd time: 13.4879 / Avg. bwd time: 11.1242 / Avg. batch time: 485.7772 (ms) / GPU bubble ratio: 59.47%
[rank1]:2025-12-31 20:15:41,680 - Avg. fwd time: 15.5718 / Avg. bwd time: 17.3511 / Avg. batch time: 462.6413 (ms) / GPU bubble ratio: 43.07%
[rank2]:2025-12-31 20:15:41,651 - Avg. fwd time: 12.2704 / Avg. bwd time: 12.8184 / Avg. batch time: 420.8180 (ms) / GPU bubble ratio: 52.30%
[rank0]:2025-12-31 20:17:16,061 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 20:17:20,025 - Avg. fwd time: 12.2709 / Avg. bwd time: 12.8211 / Avg. batch time: 420.7012 (ms) / GPU bubble ratio: 52.29%
[rank3]:2025-12-31 20:17:20,003 - Avg. fwd time: 16.7178 / Avg. bwd time: 24.9245 / Avg. batch time: 392.6596 (ms) / GPU bubble ratio: 15.16%
[rank3]:2025-12-31 20:17:20,068 -  step: 400  loss: 10.2708  grad_norm: 16.0563  memory: 29.95GiB(63.04%)  tps: 8,318  tflops: 65.02  mfu: 20.84%
[rank0]:2025-12-31 20:17:20,062 - Avg. fwd time: 13.4887 / Avg. bwd time: 11.1037 / Avg. batch time: 485.4724 (ms) / GPU bubble ratio: 59.47%
[rank0]:2025-12-31 20:17:20,067 -  step: 400  loss: -8.0000  grad_norm: 16.0563  memory: 14.51GiB(30.55%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank0]:2025-12-31 20:17:20,121 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_2017_stage0_step400.svg
[rank1]:2025-12-31 20:17:20,054 - Avg. fwd time: 15.5737 / Avg. bwd time: 17.3732 / Avg. batch time: 462.6428 (ms) / GPU bubble ratio: 43.03%
[rank1]:2025-12-31 20:17:20,066 -  step: 400  loss: -8.0000  grad_norm: 16.0563  memory: 17.18GiB(36.17%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank1]:2025-12-31 20:17:20,121 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_2017_stage1_step400.svg
[rank2]:2025-12-31 20:17:20,066 -  step: 400  loss: -8.0000  grad_norm: 16.0563  memory: 13.85GiB(29.15%)  tps: 8,317  tflops: 65.02  mfu: 20.84%
[rank2]:2025-12-31 20:17:20,121 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_2017_stage2_step400.svg
[rank3]:2025-12-31 20:17:20,205 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2017_step400_rank3.svg
[rank3]:			> Batch Time: 481.00 ms, GPU Bubble Ratio: 59.66%, 44.81%, 58.31%, 31.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-12-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  349-12-362ms   | [S0,MB3,B]  374-12-387ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  456-12-469ms   | [S0,MB7,B]  481-0-481ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  121-15-136ms   | [S1,MB6,F]  145-15-161ms   | [S1,MB7,F]  170-15-185ms   | [S1,MB0,B]  282-16-298ms   | [S1,MB1,B]  305-16-322ms   | [S1,MB2,B]  330-16-346ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  379-16-395ms   | [S1,MB5,B]  404-16-421ms   | [S1,MB6,B]  429-22-451ms   | [S1,MB7,B]  456-19-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-130ms   | [S2,MB5,F]  142-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  191-12-203ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  387-12-400ms   | [S2,MB6,B]  412-12-425ms   | [S2,MB7,B]  435-11-447ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-107ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  212-16-229ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-307ms   | [S3,MB3,B]  307-25-332ms   | [S3,MB4,B]  332-24-356ms   | [S3,MB5,B]  356-24-381ms   | [S3,MB6,B]  381-24-406ms   | [S3,MB7,B]  406-25-432ms  
[rank3]:2025-12-31 20:17:20,251 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_2017_stage3_step400.svg
[rank0]:2025-12-31 20:17:20,289 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2017_rank0_stage0.svg
[rank0]:	> Counts Sum: 159520, Total Sum: 1182720 (13.49%), Ratio(%) per element: [14.01, 14.39, 14.39, 14.39, 14.39, 14.77, 14.77, 14.77, 14.01, 14.01, 13.63, 14.77, 14.39, 13.63, 14.01, 14.39, 13.63, 13.25, 14.01, 14.01, 14.01, 13.63, 13.63, 14.01, 14.39, 13.25, 14.01, 14.01, 13.63, 13.25, 12.12, 14.39, 13.25, 14.01, 12.87, 14.01, 13.63, 12.12, 13.25, 12.87, 13.63, 13.63, 13.25, 12.12, 12.87, 12.87, 14.01, 12.12, 11.74, 11.74, 12.87, 12.12, 13.25, 12.5, 11.36, 10.98]
[rank1]:2025-12-31 20:17:20,302 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2017_rank1_stage1.svg
[rank1]:	> Counts Sum: 199360, Total Sum: 1478400 (13.48%), Ratio(%) per element: [13.25, 14.01, 12.87, 13.63, 12.12, 13.25, 13.25, 13.25, 12.87, 13.63, 14.39, 13.63, 14.01, 14.01, 13.25, 13.25, 14.39, 12.87, 14.01, 14.01, 12.87, 12.5, 13.25, 12.5, 13.63, 14.01, 14.01, 13.25, 13.63, 13.63, 13.63, 13.25, 13.63, 14.39, 12.87, 14.01, 14.01, 14.01, 13.25, 12.5, 12.5, 13.25, 13.63, 14.77, 14.01, 14.01, 13.63, 14.01, 13.25, 12.5, 12.87, 13.63, 14.39, 12.5, 14.01, 12.87, 13.63, 14.01, 13.63, 14.39, 13.25, 13.63, 13.63, 14.01, 12.87, 12.87, 13.63, 12.87, 12.87, 13.63]
[rank2]:2025-12-31 20:17:20,292 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2017_rank2_stage2.svg
[rank2]:	> Counts Sum: 159520, Total Sum: 1182720 (13.49%), Ratio(%) per element: [13.25, 14.01, 13.25, 13.25, 13.63, 13.25, 14.39, 12.87, 13.63, 14.01, 13.63, 13.25, 14.01, 13.63, 13.63, 12.5, 14.01, 13.25, 13.63, 13.63, 12.12, 13.63, 13.63, 12.87, 14.01, 12.5, 13.63, 14.39, 13.25, 13.63, 13.63, 13.63, 13.25, 12.12, 13.63, 13.25, 14.39, 14.01, 12.5, 13.25, 14.01, 13.63, 13.63, 12.87, 13.63, 12.87, 14.01, 12.87, 14.01, 13.63, 13.63, 12.87, 14.01, 12.87, 13.63, 14.77]
[rank3]:2025-12-31 20:17:20,390 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2017_rank3_stage3.svg
[rank3]:	> Counts Sum: 620000, Total Sum: 887040 (69.90%), Ratio(%) per element: [67.8, 68.93, 70.83, 72.34, 68.56, 67.04, 69.69, 70.45, 72.34, 70.07, 71.96, 68.56, 68.18, 71.21, 69.31, 68.18, 70.45, 68.18, 71.96, 70.07, 68.56, 72.34, 71.59, 65.9, 69.69, 68.18, 72.34, 68.18, 70.45, 72.34, 76.13, 68.93, 70.45, 68.93, 70.07, 70.45, 67.04, 69.31, 67.8, 70.83, 70.07, 69.69]
[rank0]:2025-12-31 20:17:21,131 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2017_stage0.svg
[rank2]:2025-12-31 20:17:21,149 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2017_stage2.svg
[rank1]:2025-12-31 20:17:21,149 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2017_stage1.svg
[rank3]:2025-12-31 20:17:21,236 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2017_stage3.svg
[rank3]:2025-12-31 20:17:43,527 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 20:17:43,615 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 20:17:43,629 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 20:17:43,593 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-31 20:18:58,870 - Avg. fwd time: 16.7161 / Avg. bwd time: 24.9084 / Avg. batch time: 392.5130 (ms) / GPU bubble ratio: 15.16%
[rank0]:2025-12-31 20:18:58,929 - Avg. fwd time: 13.4893 / Avg. bwd time: 11.0851 / Avg. batch time: 485.0816 (ms) / GPU bubble ratio: 59.47%
[rank1]:2025-12-31 20:18:58,920 - Avg. fwd time: 15.5752 / Avg. bwd time: 17.3795 / Avg. batch time: 462.5222 (ms) / GPU bubble ratio: 43.00%
[rank2]:2025-12-31 20:18:58,891 - Avg. fwd time: 12.2707 / Avg. bwd time: 12.8204 / Avg. batch time: 420.5390 (ms) / GPU bubble ratio: 52.27%
[rank0]:2025-12-31 20:20:32,885 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-31 20:20:36,771 - Avg. fwd time: 12.2700 / Avg. bwd time: 12.8181 / Avg. batch time: 420.3609 (ms) / GPU bubble ratio: 52.25%
[rank1]:2025-12-31 20:20:36,802 - Avg. fwd time: 15.5774 / Avg. bwd time: 17.3908 / Avg. batch time: 462.4208 (ms) / GPU bubble ratio: 42.96%
[rank3]:2025-12-31 20:20:36,749 - Avg. fwd time: 16.7135 / Avg. bwd time: 24.8936 / Avg. batch time: 392.3687 (ms) / GPU bubble ratio: 15.17%
[rank3]:2025-12-31 20:20:36,818 -  step: 450  loss: 12.7476  grad_norm:  3.1072  memory: 29.95GiB(63.04%)  tps: 8,327  tflops: 65.10  mfu: 20.87%
[rank0]:2025-12-31 20:20:36,812 - Avg. fwd time: 13.4901 / Avg. bwd time: 11.0682 / Avg. batch time: 484.7431 (ms) / GPU bubble ratio: 59.47%
[rank0]:2025-12-31 20:20:36,816 -  step: 450  loss: -8.0000  grad_norm:  3.1072  memory: 14.51GiB(30.55%)  tps: 8,327  tflops: 65.10  mfu: 20.87%
[rank2]:2025-12-31 20:20:36,815 -  step: 450  loss: -8.0000  grad_norm:  3.1072  memory: 13.85GiB(29.15%)  tps: 8,327  tflops: 65.10  mfu: 20.87%
[rank1]:2025-12-31 20:20:36,815 -  step: 450  loss: -8.0000  grad_norm:  3.1072  memory: 17.18GiB(36.17%)  tps: 8,327  tflops: 65.10  mfu: 20.87%
[rank3]:2025-12-31 20:22:14,919 - Avg. fwd time: 16.7115 / Avg. bwd time: 24.8798 / Avg. batch time: 392.2382 (ms) / GPU bubble ratio: 15.17%
[rank2]:2025-12-31 20:22:14,941 - Avg. fwd time: 12.2696 / Avg. bwd time: 12.8168 / Avg. batch time: 420.2027 (ms) / GPU bubble ratio: 52.24%
[rank1]:2025-12-31 20:22:14,974 - Avg. fwd time: 15.5781 / Avg. bwd time: 17.4089 / Avg. batch time: 462.3810 (ms) / GPU bubble ratio: 42.93%
[rank0]:2025-12-31 20:22:14,984 - Avg. fwd time: 13.4911 / Avg. bwd time: 11.0532 / Avg. batch time: 484.4904 (ms) / GPU bubble ratio: 59.47%
[rank0]:2025-12-31 20:23:49,694 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 20:23:53,671 - Avg. fwd time: 13.4918 / Avg. bwd time: 11.0399 / Avg. batch time: 484.3830 (ms) / GPU bubble ratio: 59.48%
[rank1]:2025-12-31 20:23:53,661 - Avg. fwd time: 15.5790 / Avg. bwd time: 17.4425 / Avg. batch time: 462.4669 (ms) / GPU bubble ratio: 42.88%
[rank1]:2025-12-31 20:23:53,674 -  step: 500  loss: -8.0000  grad_norm:  3.0997  memory: 17.18GiB(36.17%)  tps: 8,323  tflops: 65.06  mfu: 20.85%
[rank2]:2025-12-31 20:23:53,625 - Avg. fwd time: 12.2694 / Avg. bwd time: 12.8154 / Avg. batch time: 420.0826 (ms) / GPU bubble ratio: 52.23%
[rank2]:2025-12-31 20:23:53,674 -  step: 500  loss: -8.0000  grad_norm:  3.0997  memory: 13.85GiB(29.15%)  tps: 8,323  tflops: 65.06  mfu: 20.85%
[rank3]:2025-12-31 20:23:53,603 - Avg. fwd time: 16.7103 / Avg. bwd time: 24.8690 / Avg. batch time: 392.1384 (ms) / GPU bubble ratio: 15.17%
[rank3]:2025-12-31 20:23:53,677 -  step: 500  loss: 12.9574  grad_norm:  3.0997  memory: 29.95GiB(63.04%)  tps: 8,323  tflops: 65.06  mfu: 20.85%
[rank0]:2025-12-31 20:23:53,675 -  step: 500  loss: -8.0000  grad_norm:  3.0997  memory: 14.51GiB(30.55%)  tps: 8,323  tflops: 65.06  mfu: 20.85%
[rank0]:2025-12-31 20:23:53,725 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_2023_stage0_step500.svg
[rank1]:2025-12-31 20:23:53,725 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_2023_stage1_step500.svg
[rank2]:2025-12-31 20:23:53,726 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_2023_stage2_step500.svg
[rank3]:2025-12-31 20:23:53,825 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2023_step500_rank3.svg
[rank3]:			> Batch Time: 482.25 ms, GPU Bubble Ratio: 59.70%, 44.29%, 58.40%, 31.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-108ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-338ms   | [S0,MB2,B]  349-12-362ms   | [S0,MB3,B]  374-12-386ms   | [S0,MB4,B]  400-12-412ms   | [S0,MB5,B]  428-12-441ms   | [S0,MB6,B]  459-12-471ms   | [S0,MB7,B]  482-0-482ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  97-15-112ms    | [S1,MB5,F]  121-15-137ms   | [S1,MB6,F]  145-15-161ms   | [S1,MB7,F]  170-15-185ms   | [S1,MB0,B]  281-16-298ms   | [S1,MB1,B]  305-16-322ms   | [S1,MB2,B]  329-16-346ms   | [S1,MB3,B]  355-16-371ms   | [S1,MB4,B]  379-16-395ms   | [S1,MB5,B]  404-17-421ms   | [S1,MB6,B]  430-24-455ms   | [S1,MB7,B]  459-19-478ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-130ms   | [S2,MB5,F]  142-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  288-12-301ms   | [S2,MB2,B]  312-12-325ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  362-12-375ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  411-12-424ms   | [S2,MB7,B]  436-11-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-107ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-25-331ms   | [S3,MB4,B]  331-24-355ms   | [S3,MB5,B]  355-24-380ms   | [S3,MB6,B]  380-24-404ms   | [S3,MB7,B]  404-25-430ms  
[rank3]:2025-12-31 20:23:53,870 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_2023_stage3_step500.svg
[rank0]:2025-12-31 20:23:53,898 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2023_rank0_stage0.svg
[rank0]:	> Counts Sum: 204320, Total Sum: 1541120 (13.26%), Ratio(%) per element: [13.66, 13.95, 13.95, 13.95, 13.95, 14.24, 14.24, 14.24, 13.66, 13.66, 13.37, 14.24, 13.95, 13.37, 13.66, 13.95, 13.37, 13.08, 13.66, 13.66, 13.66, 13.37, 13.37, 13.66, 13.95, 13.08, 13.66, 13.66, 13.37, 13.08, 12.2, 13.95, 13.08, 13.66, 12.79, 13.66, 13.37, 12.2, 13.08, 12.79, 13.37, 13.37, 13.08, 12.2, 12.79, 12.79, 13.66, 12.2, 11.91, 11.91, 12.79, 12.2, 13.08, 12.5, 11.62, 11.33]
[rank1]:2025-12-31 20:23:53,911 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2023_rank1_stage1.svg
[rank1]:	> Counts Sum: 255360, Total Sum: 1926400 (13.26%), Ratio(%) per element: [13.08, 13.66, 12.79, 13.37, 12.2, 13.08, 13.08, 13.08, 12.79, 13.37, 13.95, 13.37, 13.66, 13.66, 13.08, 13.08, 13.95, 12.79, 13.66, 13.66, 12.79, 12.5, 13.08, 12.5, 13.37, 13.66, 13.66, 13.08, 13.37, 13.37, 13.37, 13.08, 13.37, 13.95, 12.79, 13.66, 13.66, 13.66, 13.08, 12.5, 12.5, 13.08, 13.37, 14.24, 13.66, 13.66, 13.37, 13.66, 13.08, 12.5, 12.79, 13.37, 13.95, 12.5, 13.66, 12.79, 13.37, 13.66, 13.37, 13.95, 13.08, 13.37, 13.37, 13.66, 12.79, 12.79, 13.37, 12.79, 12.79, 13.37]
[rank2]:2025-12-31 20:23:53,897 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2023_rank2_stage2.svg
[rank2]:	> Counts Sum: 204320, Total Sum: 1541120 (13.26%), Ratio(%) per element: [13.08, 13.66, 13.08, 13.08, 13.37, 13.08, 13.95, 12.79, 13.37, 13.66, 13.37, 13.08, 13.66, 13.37, 13.37, 12.5, 13.66, 13.08, 13.37, 13.37, 12.2, 13.37, 13.37, 12.79, 13.66, 12.5, 13.37, 13.95, 13.08, 13.37, 13.37, 13.37, 13.08, 12.2, 13.37, 13.08, 13.95, 13.66, 12.5, 13.08, 13.66, 13.37, 13.37, 12.79, 13.37, 12.79, 13.66, 12.79, 13.66, 13.37, 13.37, 12.79, 13.66, 12.79, 13.37, 14.24]
[rank3]:2025-12-31 20:23:54,021 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2023_rank3_stage3.svg
[rank3]:	> Counts Sum: 835200, Total Sum: 1155840 (72.26%), Ratio(%) per element: [70.63, 71.22, 72.09, 74.12, 71.22, 70.05, 71.8, 72.67, 74.12, 72.09, 73.54, 71.51, 70.63, 72.67, 71.8, 71.22, 73.54, 70.93, 74.41, 72.38, 71.51, 74.7, 74.12, 69.47, 71.8, 70.93, 73.83, 70.93, 72.09, 74.12, 77.32, 71.8, 73.25, 71.51, 72.09, 72.67, 70.34, 72.38, 70.34, 72.67, 72.38, 71.8]
[rank0]:2025-12-31 20:23:54,993 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2023_stage0.svg
[rank1]:2025-12-31 20:23:55,023 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2023_stage1.svg
[rank2]:2025-12-31 20:23:55,018 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2023_stage2.svg
[rank3]:2025-12-31 20:23:55,255 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2023_stage3.svg
[rank2]:2025-12-31 20:25:33,484 - Avg. fwd time: 12.2692 / Avg. bwd time: 12.8141 / Avg. batch time: 419.9967 (ms) / GPU bubble ratio: 52.22%
[rank3]:2025-12-31 20:25:33,461 - Avg. fwd time: 16.7085 / Avg. bwd time: 24.8574 / Avg. batch time: 392.0280 (ms) / GPU bubble ratio: 15.18%
[rank1]:2025-12-31 20:25:33,515 - Avg. fwd time: 15.5812 / Avg. bwd time: 17.4651 / Avg. batch time: 462.5289 (ms) / GPU bubble ratio: 42.84%
[rank0]:2025-12-31 20:25:33,525 - Avg. fwd time: 13.4928 / Avg. bwd time: 11.0278 / Avg. batch time: 484.2720 (ms) / GPU bubble ratio: 59.49%
[rank0]:2025-12-31 20:27:07,619 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 20:27:11,524 - Avg. fwd time: 16.7071 / Avg. bwd time: 24.8471 / Avg. batch time: 391.9307 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-31 20:27:11,547 - Avg. fwd time: 12.2690 / Avg. bwd time: 12.8131 / Avg. batch time: 419.8807 (ms) / GPU bubble ratio: 52.21%
[rank2]:2025-12-31 20:27:11,595 -  step: 550  loss: -8.0000  grad_norm:  2.9643  memory: 13.85GiB(29.15%)  tps: 8,278  tflops: 64.71  mfu: 20.74%
[rank1]:2025-12-31 20:27:11,581 - Avg. fwd time: 15.5808 / Avg. bwd time: 17.4754 / Avg. batch time: 462.4685 (ms) / GPU bubble ratio: 42.82%
[rank1]:2025-12-31 20:27:11,595 -  step: 550  loss: -8.0000  grad_norm:  2.9643  memory: 17.18GiB(36.17%)  tps: 8,278  tflops: 64.71  mfu: 20.74%
[rank0]:2025-12-31 20:27:11,591 - Avg. fwd time: 13.4946 / Avg. bwd time: 11.0167 / Avg. batch time: 484.0531 (ms) / GPU bubble ratio: 59.49%
[rank0]:2025-12-31 20:27:11,595 -  step: 550  loss: -8.0000  grad_norm:  2.9643  memory: 14.51GiB(30.55%)  tps: 8,278  tflops: 64.71  mfu: 20.74%
[rank3]:2025-12-31 20:27:11,598 -  step: 550  loss: 11.0947  grad_norm:  2.9643  memory: 29.95GiB(63.04%)  tps: 8,278  tflops: 64.72  mfu: 20.74%
[rank3]:2025-12-31 20:28:48,948 - Avg. fwd time: 16.7059 / Avg. bwd time: 24.8378 / Avg. batch time: 391.8436 (ms) / GPU bubble ratio: 15.18%
[rank1]:2025-12-31 20:28:49,001 - Avg. fwd time: 15.5797 / Avg. bwd time: 17.4620 / Avg. batch time: 462.2656 (ms) / GPU bubble ratio: 42.82%
[rank2]:2025-12-31 20:28:48,971 - Avg. fwd time: 12.2688 / Avg. bwd time: 12.8135 / Avg. batch time: 419.7819 (ms) / GPU bubble ratio: 52.20%
[rank0]:2025-12-31 20:28:49,013 - Avg. fwd time: 13.4939 / Avg. bwd time: 11.0068 / Avg. batch time: 483.6979 (ms) / GPU bubble ratio: 59.48%
[rank0]:2025-12-31 20:30:23,279 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 20:30:27,237 - Avg. fwd time: 16.7047 / Avg. bwd time: 24.8285 / Avg. batch time: 391.7589 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 20:30:27,265 - Avg. fwd time: 12.2686 / Avg. bwd time: 12.8132 / Avg. batch time: 419.6819 (ms) / GPU bubble ratio: 52.19%
[rank3]:2025-12-31 20:30:27,313 -  step: 600  loss: 10.0019  grad_norm: 14.9754  memory: 29.95GiB(63.04%)  tps: 8,372  tflops: 65.44  mfu: 20.98%
[rank2]:2025-12-31 20:30:27,310 -  step: 600  loss: -8.0000  grad_norm: 14.9754  memory: 13.85GiB(29.15%)  tps: 8,371  tflops: 65.44  mfu: 20.98%
[rank2]:2025-12-31 20:30:27,385 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_2030_stage2_step600.svg
[rank1]:2025-12-31 20:30:27,295 - Avg. fwd time: 15.5811 / Avg. bwd time: 17.4783 / Avg. batch time: 462.2686 (ms) / GPU bubble ratio: 42.79%
[rank1]:2025-12-31 20:30:27,310 -  step: 600  loss: -8.0000  grad_norm: 14.9754  memory: 17.18GiB(36.17%)  tps: 8,371  tflops: 65.44  mfu: 20.98%
[rank1]:2025-12-31 20:30:27,364 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_2030_stage1_step600.svg
[rank0]:2025-12-31 20:30:27,307 - Avg. fwd time: 13.4936 / Avg. bwd time: 10.9973 / Avg. batch time: 483.5666 (ms) / GPU bubble ratio: 59.48%
[rank0]:2025-12-31 20:30:27,311 -  step: 600  loss: -8.0000  grad_norm: 14.9754  memory: 14.51GiB(30.55%)  tps: 8,371  tflops: 65.44  mfu: 20.98%
[rank0]:2025-12-31 20:30:27,365 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_2030_stage0_step600.svg
[rank3]:2025-12-31 20:30:27,467 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2030_step600_rank3.svg
[rank3]:			> Batch Time: 479.00 ms, GPU Bubble Ratio: 59.55%, 44.43%, 58.18%, 31.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-312ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  349-12-361ms   | [S0,MB3,B]  374-12-386ms   | [S0,MB4,B]  398-12-411ms   | [S0,MB5,B]  425-12-437ms   | [S0,MB6,B]  455-12-467ms   | [S0,MB7,B]  479-0-479ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  144-15-160ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  305-16-321ms   | [S1,MB2,B]  329-16-345ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  379-16-395ms   | [S1,MB5,B]  403-16-420ms   | [S1,MB6,B]  427-23-451ms   | [S1,MB7,B]  455-19-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  288-12-301ms   | [S2,MB2,B]  312-12-325ms   | [S2,MB3,B]  337-12-350ms   | [S2,MB4,B]  361-12-374ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  411-12-423ms   | [S2,MB7,B]  433-11-444ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-257ms   | [S3,MB1,B]  257-23-281ms   | [S3,MB2,B]  281-23-305ms   | [S3,MB3,B]  305-24-330ms   | [S3,MB4,B]  330-24-354ms   | [S3,MB5,B]  355-24-379ms   | [S3,MB6,B]  379-24-404ms   | [S3,MB7,B]  404-25-430ms  
[rank3]:2025-12-31 20:30:27,512 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_2030_stage3_step600.svg
[rank2]:2025-12-31 20:30:27,577 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2030_rank2_stage2.svg
[rank2]:	> Counts Sum: 249120, Total Sum: 1899520 (13.11%), Ratio(%) per element: [12.97, 13.44, 12.97, 12.97, 13.2, 12.97, 13.67, 12.73, 13.2, 13.44, 13.2, 12.97, 13.44, 13.2, 13.2, 12.5, 13.44, 12.97, 13.2, 13.2, 12.26, 13.2, 13.2, 12.73, 13.44, 12.5, 13.2, 13.67, 12.97, 13.2, 13.2, 13.2, 12.97, 12.26, 13.2, 12.97, 13.67, 13.44, 12.5, 12.97, 13.44, 13.2, 13.2, 12.73, 13.2, 12.73, 13.44, 12.73, 13.44, 13.2, 13.2, 12.73, 13.44, 12.73, 13.2, 13.91]
[rank1]:2025-12-31 20:30:27,548 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2030_rank1_stage1.svg
[rank1]:	> Counts Sum: 311360, Total Sum: 2374400 (13.11%), Ratio(%) per element: [12.97, 13.44, 12.73, 13.2, 12.26, 12.97, 12.97, 12.97, 12.73, 13.2, 13.67, 13.2, 13.44, 13.44, 12.97, 12.97, 13.67, 12.73, 13.44, 13.44, 12.73, 12.5, 12.97, 12.5, 13.2, 13.44, 13.44, 12.97, 13.2, 13.2, 13.2, 12.97, 13.2, 13.67, 12.73, 13.44, 13.44, 13.44, 12.97, 12.5, 12.5, 12.97, 13.2, 13.91, 13.44, 13.44, 13.2, 13.44, 12.97, 12.5, 12.73, 13.2, 13.67, 12.5, 13.44, 12.73, 13.2, 13.44, 13.2, 13.67, 12.97, 13.2, 13.2, 13.44, 12.73, 12.73, 13.2, 12.73, 12.73, 13.2]
[rank0]:2025-12-31 20:30:27,535 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2030_rank0_stage0.svg
[rank0]:	> Counts Sum: 249120, Total Sum: 1899520 (13.11%), Ratio(%) per element: [13.44, 13.67, 13.67, 13.67, 13.67, 13.91, 13.91, 13.91, 13.44, 13.44, 13.2, 13.91, 13.67, 13.2, 13.44, 13.67, 13.2, 12.97, 13.44, 13.44, 13.44, 13.2, 13.2, 13.44, 13.67, 12.97, 13.44, 13.44, 13.2, 12.97, 12.26, 13.67, 12.97, 13.44, 12.73, 13.44, 13.2, 12.26, 12.97, 12.73, 13.2, 13.2, 12.97, 12.26, 12.73, 12.73, 13.44, 12.26, 12.02, 12.02, 12.73, 12.26, 12.97, 12.5, 11.79, 11.55]
[rank3]:2025-12-31 20:30:27,655 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2030_rank3_stage3.svg
[rank3]:	> Counts Sum: 1050400, Total Sum: 1424640 (73.73%), Ratio(%) per element: [72.4, 72.4, 73.58, 75.94, 73.34, 72.16, 72.87, 74.05, 75.7, 73.11, 74.29, 72.87, 72.4, 74.76, 73.58, 72.87, 75.7, 72.87, 75.23, 73.58, 73.11, 75.7, 75.0, 71.69, 73.82, 72.4, 75.23, 72.16, 73.58, 74.76, 78.3, 74.29, 74.52, 73.11, 73.34, 73.82, 71.93, 73.58, 72.16, 74.05, 73.58, 72.64]
[rank0]:2025-12-31 20:30:28,874 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2030_stage0.svg
[rank1]:2025-12-31 20:30:28,898 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2030_stage1.svg
[rank3]:2025-12-31 20:30:29,012 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2030_stage3.svg
[rank2]:2025-12-31 20:30:29,120 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2030_stage2.svg
[rank3]:2025-12-31 20:32:07,113 - Avg. fwd time: 16.7040 / Avg. bwd time: 24.8209 / Avg. batch time: 391.6894 (ms) / GPU bubble ratio: 15.19%
[rank0]:2025-12-31 20:32:07,181 - Avg. fwd time: 13.4936 / Avg. bwd time: 10.9889 / Avg. batch time: 483.4553 (ms) / GPU bubble ratio: 59.49%
[rank1]:2025-12-31 20:32:07,170 - Avg. fwd time: 15.5815 / Avg. bwd time: 17.4872 / Avg. batch time: 462.2767 (ms) / GPU bubble ratio: 42.77%
[rank2]:2025-12-31 20:32:07,137 - Avg. fwd time: 12.2686 / Avg. bwd time: 12.8121 / Avg. batch time: 419.5945 (ms) / GPU bubble ratio: 52.18%
[rank0]:2025-12-31 20:33:41,800 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-31 20:33:45,739 - Avg. fwd time: 12.2688 / Avg. bwd time: 12.8123 / Avg. batch time: 419.5754 (ms) / GPU bubble ratio: 52.18%
[rank3]:2025-12-31 20:33:45,715 - Avg. fwd time: 16.7055 / Avg. bwd time: 24.8192 / Avg. batch time: 391.6860 (ms) / GPU bubble ratio: 15.19%
[rank0]:2025-12-31 20:33:45,785 - Avg. fwd time: 13.4952 / Avg. bwd time: 10.9815 / Avg. batch time: 483.3924 (ms) / GPU bubble ratio: 59.49%
[rank0]:2025-12-31 20:33:45,790 -  step: 650  loss: -8.0000  grad_norm:  3.5292  memory: 14.51GiB(30.55%)  tps: 8,255  tflops: 64.53  mfu: 20.68%
[rank2]:2025-12-31 20:33:45,789 -  step: 650  loss: -8.0000  grad_norm:  3.5292  memory: 13.85GiB(29.15%)  tps: 8,255  tflops: 64.53  mfu: 20.68%
[rank3]:2025-12-31 20:33:45,792 -  step: 650  loss: 12.3049  grad_norm:  3.5292  memory: 29.95GiB(63.04%)  tps: 8,255  tflops: 64.53  mfu: 20.68%
[rank1]:2025-12-31 20:33:45,773 - Avg. fwd time: 15.5835 / Avg. bwd time: 17.4992 / Avg. batch time: 462.3253 (ms) / GPU bubble ratio: 42.75%
[rank1]:2025-12-31 20:33:45,789 -  step: 650  loss: -8.0000  grad_norm:  3.5292  memory: 17.18GiB(36.17%)  tps: 8,255  tflops: 64.53  mfu: 20.68%
[rank1]:2025-12-31 20:35:24,677 - Avg. fwd time: 15.5859 / Avg. bwd time: 17.5187 / Avg. batch time: 462.4395 (ms) / GPU bubble ratio: 42.73%
[rank3]:2025-12-31 20:35:24,620 - Avg. fwd time: 16.7075 / Avg. bwd time: 24.8191 / Avg. batch time: 391.7006 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 20:35:24,644 - Avg. fwd time: 12.2693 / Avg. bwd time: 12.8126 / Avg. batch time: 419.5771 (ms) / GPU bubble ratio: 52.18%
[rank0]:2025-12-31 20:35:24,689 - Avg. fwd time: 13.4960 / Avg. bwd time: 10.9748 / Avg. batch time: 483.3985 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 20:36:59,402 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 20:37:03,308 - Avg. fwd time: 12.2694 / Avg. bwd time: 12.8121 / Avg. batch time: 419.5473 (ms) / GPU bubble ratio: 52.17%
[rank3]:2025-12-31 20:37:03,283 - Avg. fwd time: 16.7083 / Avg. bwd time: 24.8167 / Avg. batch time: 391.6856 (ms) / GPU bubble ratio: 15.19%
[rank1]:2025-12-31 20:37:03,344 - Avg. fwd time: 15.5874 / Avg. bwd time: 17.5350 / Avg. batch time: 462.5084 (ms) / GPU bubble ratio: 42.71%
[rank1]:2025-12-31 20:37:03,360 -  step: 700  loss: -8.0000  grad_norm:  3.0930  memory: 17.18GiB(36.17%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank0]:2025-12-31 20:37:03,356 - Avg. fwd time: 13.4963 / Avg. bwd time: 10.9683 / Avg. batch time: 483.3661 (ms) / GPU bubble ratio: 59.51%
[rank0]:2025-12-31 20:37:03,361 -  step: 700  loss: -8.0000  grad_norm:  3.0930  memory: 14.51GiB(30.55%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank2]:2025-12-31 20:37:03,360 -  step: 700  loss: -8.0000  grad_norm:  3.0930  memory: 13.85GiB(29.15%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank3]:2025-12-31 20:37:03,363 -  step: 700  loss: 13.1107  grad_norm:  3.0930  memory: 29.95GiB(63.04%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank1]:2025-12-31 20:37:03,415 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_2037_stage1_step700.svg
[rank0]:2025-12-31 20:37:03,415 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_2037_stage0_step700.svg
[rank2]:2025-12-31 20:37:03,418 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_2037_stage2_step700.svg
[rank3]:2025-12-31 20:37:03,507 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2037_step700_rank3.svg
[rank3]:			> Batch Time: 482.25 ms, GPU Bubble Ratio: 59.75%, 44.09%, 58.37%, 31.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-14-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-108ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  427-12-439ms   | [S0,MB6,B]  459-12-471ms   | [S0,MB7,B]  482-0-482ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  97-15-112ms    | [S1,MB5,F]  121-15-137ms   | [S1,MB6,F]  146-15-161ms   | [S1,MB7,F]  170-15-186ms   | [S1,MB0,B]  282-16-298ms   | [S1,MB1,B]  305-16-322ms   | [S1,MB2,B]  330-16-346ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  379-16-395ms   | [S1,MB5,B]  404-18-422ms   | [S1,MB6,B]  429-24-454ms   | [S1,MB7,B]  458-19-478ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  387-12-400ms   | [S2,MB6,B]  412-12-425ms   | [S2,MB7,B]  436-11-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  212-16-229ms   | [S3,MB0,B]  235-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-25-332ms   | [S3,MB4,B]  331-24-356ms   | [S3,MB5,B]  356-24-381ms   | [S3,MB6,B]  381-24-405ms   | [S3,MB7,B]  406-26-432ms  
[rank1]:2025-12-31 20:37:03,599 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2037_rank1_stage1.svg
[rank1]:	> Counts Sum: 367360, Total Sum: 2822400 (13.02%), Ratio(%) per element: [12.89, 13.29, 12.69, 13.09, 12.3, 12.89, 12.89, 12.89, 12.69, 13.09, 13.49, 13.09, 13.29, 13.29, 12.89, 12.89, 13.49, 12.69, 13.29, 13.29, 12.69, 12.5, 12.89, 12.5, 13.09, 13.29, 13.29, 12.89, 13.09, 13.09, 13.09, 12.89, 13.09, 13.49, 12.69, 13.29, 13.29, 13.29, 12.89, 12.5, 12.5, 12.89, 13.09, 13.69, 13.29, 13.29, 13.09, 13.29, 12.89, 12.5, 12.69, 13.09, 13.49, 12.5, 13.29, 12.69, 13.09, 13.29, 13.09, 13.49, 12.89, 13.09, 13.09, 13.29, 12.69, 12.69, 13.09, 12.69, 12.69, 13.09]
[rank0]:2025-12-31 20:37:03,584 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2037_rank0_stage0.svg
[rank0]:	> Counts Sum: 293920, Total Sum: 2257920 (13.02%), Ratio(%) per element: [13.29, 13.49, 13.49, 13.49, 13.49, 13.69, 13.69, 13.69, 13.29, 13.29, 13.09, 13.69, 13.49, 13.09, 13.29, 13.49, 13.09, 12.89, 13.29, 13.29, 13.29, 13.09, 13.09, 13.29, 13.49, 12.89, 13.29, 13.29, 13.09, 12.89, 12.3, 13.49, 12.89, 13.29, 12.69, 13.29, 13.09, 12.3, 12.89, 12.69, 13.09, 13.09, 12.89, 12.3, 12.69, 12.69, 13.29, 12.3, 12.1, 12.1, 12.69, 12.3, 12.89, 12.5, 11.9, 11.7]
[rank2]:2025-12-31 20:37:03,597 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2037_rank2_stage2.svg
[rank2]:	> Counts Sum: 293920, Total Sum: 2257920 (13.02%), Ratio(%) per element: [12.89, 13.29, 12.89, 12.89, 13.09, 12.89, 13.49, 12.69, 13.09, 13.29, 13.09, 12.89, 13.29, 13.09, 13.09, 12.5, 13.29, 12.89, 13.09, 13.09, 12.3, 13.09, 13.09, 12.69, 13.29, 12.5, 13.09, 13.49, 12.89, 13.09, 13.09, 13.09, 12.89, 12.3, 13.09, 12.89, 13.49, 13.29, 12.5, 12.89, 13.29, 13.09, 13.09, 12.69, 13.09, 12.69, 13.29, 12.69, 13.29, 13.09, 13.09, 12.69, 13.29, 12.69, 13.09, 13.69]
[rank3]:2025-12-31 20:37:03,555 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_2037_stage3_step700.svg
[rank3]:2025-12-31 20:37:03,697 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2037_rank3_stage3.svg
[rank3]:	> Counts Sum: 1265600, Total Sum: 1693440 (74.74%), Ratio(%) per element: [73.01, 73.61, 74.2, 76.58, 74.0, 73.41, 74.2, 75.0, 76.78, 74.4, 75.79, 74.0, 73.61, 75.79, 74.6, 74.2, 76.58, 73.8, 76.38, 74.6, 74.0, 76.19, 75.79, 73.01, 75.19, 73.41, 75.79, 73.41, 74.4, 75.59, 77.97, 75.39, 75.79, 74.0, 74.6, 74.8, 73.01, 74.6, 73.41, 75.19, 74.8, 73.8]
[rank1]:2025-12-31 20:37:05,201 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2037_stage1.svg
[rank0]:2025-12-31 20:37:05,186 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2037_stage0.svg
[rank2]:2025-12-31 20:37:05,234 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2037_stage2.svg
[rank3]:2025-12-31 20:37:05,315 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2037_stage3.svg
[rank3]:2025-12-31 20:38:43,361 - Avg. fwd time: 16.7077 / Avg. bwd time: 24.8115 / Avg. batch time: 391.6384 (ms) / GPU bubble ratio: 15.19%
[rank1]:2025-12-31 20:38:43,418 - Avg. fwd time: 15.5885 / Avg. bwd time: 17.5424 / Avg. batch time: 462.5137 (ms) / GPU bubble ratio: 42.69%
[rank2]:2025-12-31 20:38:43,386 - Avg. fwd time: 12.2693 / Avg. bwd time: 12.8119 / Avg. batch time: 419.4995 (ms) / GPU bubble ratio: 52.17%
[rank0]:2025-12-31 20:38:43,430 - Avg. fwd time: 13.4954 / Avg. bwd time: 10.9622 / Avg. batch time: 483.2748 (ms) / GPU bubble ratio: 59.51%
[rank0]:2025-12-31 20:40:17,925 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 20:40:21,847 - Avg. fwd time: 16.7074 / Avg. bwd time: 24.8064 / Avg. batch time: 391.5931 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 20:40:21,872 - Avg. fwd time: 12.2693 / Avg. bwd time: 12.8112 / Avg. batch time: 419.4410 (ms) / GPU bubble ratio: 52.16%
[rank2]:2025-12-31 20:40:21,921 -  step: 750  loss: -8.0000  grad_norm:  2.2408  memory: 13.85GiB(29.15%)  tps: 8,251  tflops: 64.51  mfu: 20.67%
[rank0]:2025-12-31 20:40:21,917 - Avg. fwd time: 13.4948 / Avg. bwd time: 10.9565 / Avg. batch time: 483.2139 (ms) / GPU bubble ratio: 59.52%
[rank0]:2025-12-31 20:40:21,921 -  step: 750  loss: -8.0000  grad_norm:  2.2408  memory: 14.51GiB(30.55%)  tps: 8,251  tflops: 64.51  mfu: 20.67%
[rank1]:2025-12-31 20:40:21,904 - Avg. fwd time: 15.5898 / Avg. bwd time: 17.5561 / Avg. batch time: 462.5422 (ms) / GPU bubble ratio: 42.67%
[rank1]:2025-12-31 20:40:21,921 -  step: 750  loss: -8.0000  grad_norm:  2.2408  memory: 17.18GiB(36.17%)  tps: 8,251  tflops: 64.51  mfu: 20.67%
[rank3]:2025-12-31 20:40:21,923 -  step: 750  loss: 11.0703  grad_norm:  2.2408  memory: 29.95GiB(63.04%)  tps: 8,252  tflops: 64.51  mfu: 20.68%
[rank3]:2025-12-31 20:42:00,223 - Avg. fwd time: 16.7065 / Avg. bwd time: 24.8008 / Avg. batch time: 391.5386 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 20:42:00,249 - Avg. fwd time: 12.2692 / Avg. bwd time: 12.8111 / Avg. batch time: 419.3755 (ms) / GPU bubble ratio: 52.16%
[rank1]:2025-12-31 20:42:00,281 - Avg. fwd time: 15.5909 / Avg. bwd time: 17.5662 / Avg. batch time: 462.5452 (ms) / GPU bubble ratio: 42.65%
[rank0]:2025-12-31 20:42:00,294 - Avg. fwd time: 13.4947 / Avg. bwd time: 10.9510 / Avg. batch time: 483.1368 (ms) / GPU bubble ratio: 59.52%
[rank0]:2025-12-31 20:43:34,537 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 20:43:38,491 - Avg. fwd time: 16.7060 / Avg. bwd time: 24.7960 / Avg. batch time: 391.4955 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 20:43:38,517 - Avg. fwd time: 12.2693 / Avg. bwd time: 12.8106 / Avg. batch time: 419.3211 (ms) / GPU bubble ratio: 52.15%
[rank2]:2025-12-31 20:43:38,565 -  step: 800  loss: -8.0000  grad_norm: 13.8673  memory: 13.85GiB(29.15%)  tps: 8,332  tflops: 65.13  mfu: 20.88%
[rank2]:2025-12-31 20:43:38,565 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8673  tps: 8,776  tflops: 68.61  mfu: 19.98%
[rank2]:2025-12-31 20:43:38,565 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 20:43:38,566 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 20:43:38,561 - Avg. fwd time: 13.4951 / Avg. bwd time: 10.9459 / Avg. batch time: 483.0452 (ms) / GPU bubble ratio: 59.52%
[rank0]:2025-12-31 20:43:38,565 -  step: 800  loss: -8.0000  grad_norm: 13.8673  memory: 14.51GiB(30.55%)  tps: 8,332  tflops: 65.13  mfu: 20.88%
[rank0]:2025-12-31 20:43:38,565 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8673  tps: 8,777  tflops: 68.61  mfu: 19.98%
[rank0]:2025-12-31 20:43:38,565 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 20:43:38,566 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 20:43:38,548 - Avg. fwd time: 15.5918 / Avg. bwd time: 17.5716 / Avg. batch time: 462.5262 (ms) / GPU bubble ratio: 42.64%
[rank1]:2025-12-31 20:43:38,565 -  step: 800  loss: -8.0000  grad_norm: 13.8673  memory: 17.18GiB(36.17%)  tps: 8,332  tflops: 65.13  mfu: 20.88%
[rank1]:2025-12-31 20:43:38,565 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8673  tps: 8,777  tflops: 68.62  mfu: 19.99%
[rank1]:2025-12-31 20:43:38,565 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 20:43:38,566 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-31 20:43:38,567 -  step: 800  loss:  9.7916  grad_norm: 13.8673  memory: 29.95GiB(63.04%)  tps: 8,332  tflops: 65.14  mfu: 20.88%
[rank3]:2025-12-31 20:43:38,568 - â„¹ï¸ final step: 800  loss:  9.7916  grad_norm: 13.8673  tps: 8,784  tflops: 68.67  mfu: 20.12%
[rank3]:2025-12-31 20:43:38,568 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 20:43:38,569 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 20:43:40,575 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-31 20:43:40,649 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank2/251231_2043_stage2_final800.svg
[rank0]:2025-12-31 20:43:40,668 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank0/251231_2043_stage0_final800.svg
[rank1]:2025-12-31 20:43:40,649 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank1/251231_2043_stage1_final800.svg
[rank3]:2025-12-31 20:43:40,734 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2043_final800_rank3.svg
[rank3]:			> Batch Time: 480.25 ms, GPU Bubble Ratio: 59.61%, 44.93%, 58.25%, 31.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  400-12-412ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  456-12-469ms   | [S0,MB7,B]  480-0-480ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  121-15-136ms   | [S1,MB6,F]  145-15-160ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-346ms   | [S1,MB3,B]  355-16-372ms   | [S1,MB4,B]  380-16-396ms   | [S1,MB5,B]  405-16-421ms   | [S1,MB6,B]  430-21-451ms   | [S1,MB7,B]  456-19-476ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  339-12-351ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  388-12-401ms   | [S2,MB6,B]  413-12-426ms   | [S2,MB7,B]  436-11-447ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  212-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-307ms   | [S3,MB3,B]  307-25-332ms   | [S3,MB4,B]  332-24-357ms   | [S3,MB5,B]  357-24-381ms   | [S3,MB6,B]  381-24-406ms   | [S3,MB7,B]  406-25-432ms  
[rank2]:2025-12-31 20:43:40,819 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2043_rank2_stage2.svg
[rank2]:	> Counts Sum: 338720, Total Sum: 2616320 (12.95%), Ratio(%) per element: [12.84, 13.18, 12.84, 12.84, 13.01, 12.84, 13.35, 12.67, 13.01, 13.18, 13.01, 12.84, 13.18, 13.01, 13.01, 12.5, 13.18, 12.84, 13.01, 13.01, 12.32, 13.01, 13.01, 12.67, 13.18, 12.5, 13.01, 13.35, 12.84, 13.01, 13.01, 13.01, 12.84, 12.32, 13.01, 12.84, 13.35, 13.18, 12.5, 12.84, 13.18, 13.01, 13.01, 12.67, 13.01, 12.67, 13.18, 12.67, 13.18, 13.01, 13.01, 12.67, 13.18, 12.67, 13.01, 13.52]
[rank0]:2025-12-31 20:43:40,845 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2043_rank0_stage0.svg
[rank0]:	> Counts Sum: 338720, Total Sum: 2616320 (12.95%), Ratio(%) per element: [13.18, 13.35, 13.35, 13.35, 13.35, 13.52, 13.52, 13.52, 13.18, 13.18, 13.01, 13.52, 13.35, 13.01, 13.18, 13.35, 13.01, 12.84, 13.18, 13.18, 13.18, 13.01, 13.01, 13.18, 13.35, 12.84, 13.18, 13.18, 13.01, 12.84, 12.32, 13.35, 12.84, 13.18, 12.67, 13.18, 13.01, 12.32, 12.84, 12.67, 13.01, 13.01, 12.84, 12.32, 12.67, 12.67, 13.18, 12.32, 12.15, 12.15, 12.67, 12.32, 12.84, 12.5, 11.98, 11.81]
[rank1]:2025-12-31 20:43:40,832 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2043_rank1_stage1.svg
[rank1]:	> Counts Sum: 423360, Total Sum: 3270400 (12.95%), Ratio(%) per element: [12.84, 13.18, 12.67, 13.01, 12.32, 12.84, 12.84, 12.84, 12.67, 13.01, 13.35, 13.01, 13.18, 13.18, 12.84, 12.84, 13.35, 12.67, 13.18, 13.18, 12.67, 12.5, 12.84, 12.5, 13.01, 13.18, 13.18, 12.84, 13.01, 13.01, 13.01, 12.84, 13.01, 13.35, 12.67, 13.18, 13.18, 13.18, 12.84, 12.5, 12.5, 12.84, 13.01, 13.52, 13.18, 13.18, 13.01, 13.18, 12.84, 12.5, 12.67, 13.01, 13.35, 12.5, 13.18, 12.67, 13.01, 13.18, 13.01, 13.35, 12.84, 13.01, 13.01, 13.18, 12.67, 12.67, 13.01, 12.67, 12.67, 13.01]
[rank3]:2025-12-31 20:43:40,868 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/pipeline_schedule/251231_2043_thry_final800_rank3.svg
[rank3]:			> Batch Time: 478.11 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-14-28ms     | [S0,MB2,F]  28-14-43ms     | [S0,MB3,F]  43-14-57ms     | [S0,MB4,F]  57-14-72ms     | [S0,MB5,F]  72-14-86ms     | [S0,MB6,F]  86-14-101ms    | [S0,MB7,F]  101-14-115ms   | [S0,MB0,B]  246-28-275ms   | [S0,MB1,B]  275-28-304ms   | [S0,MB2,B]  304-28-333ms   | [S0,MB3,B]  333-28-362ms   | [S0,MB4,B]  362-28-391ms   | [S0,MB5,B]  391-28-420ms   | [S0,MB6,B]  420-28-449ms   | [S0,MB7,B]  449-28-478ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-14-28ms     | [S1,MB1,F]  28-14-43ms     | [S1,MB2,F]  43-14-57ms     | [S1,MB3,F]  57-14-72ms     | [S1,MB4,F]  72-14-86ms     | [S1,MB5,F]  86-14-101ms    | [S1,MB6,F]  101-14-115ms   | [S1,MB7,F]  115-14-130ms   | [S1,MB0,B]  217-28-246ms   | [S1,MB1,B]  246-28-275ms   | [S1,MB2,B]  275-28-304ms   | [S1,MB3,B]  304-28-333ms   | [S1,MB4,B]  333-28-362ms   | [S1,MB5,B]  362-28-391ms   | [S1,MB6,B]  391-28-420ms   | [S1,MB7,B]  420-28-449ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-14-43ms     | [S2,MB1,F]  43-14-57ms     | [S2,MB2,F]  57-14-72ms     | [S2,MB3,F]  72-14-86ms     | [S2,MB4,F]  86-14-101ms    | [S2,MB5,F]  101-14-115ms   | [S2,MB6,F]  115-14-130ms   | [S2,MB7,F]  130-14-144ms   | [S2,MB0,B]  188-28-217ms   | [S2,MB1,B]  217-28-246ms   | [S2,MB2,B]  246-28-275ms   | [S2,MB3,B]  275-28-304ms   | [S2,MB4,B]  304-28-333ms   | [S2,MB5,B]  333-28-362ms   | [S2,MB6,B]  362-28-391ms   | [S2,MB7,B]  391-28-420ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  43-14-57ms     | [S3,MB1,F]  57-14-72ms     | [S3,MB2,F]  72-14-86ms     | [S3,MB3,F]  86-14-101ms    | [S3,MB4,F]  101-14-115ms   | [S3,MB5,F]  115-14-130ms   | [S3,MB6,F]  130-14-144ms   | [S3,MB7,F]  144-14-159ms   | [S3,MB0,B]  159-28-188ms   | [S3,MB1,B]  188-28-217ms   | [S3,MB2,B]  217-28-246ms   | [S3,MB3,B]  246-28-275ms   | [S3,MB4,B]  275-28-304ms   | [S3,MB5,B]  304-28-333ms   | [S3,MB6,B]  333-28-362ms   | [S3,MB7,B]  362-28-391ms  
[rank3]:2025-12-31 20:43:40,916 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_ratio_history/rank3/251231_2043_stage3_final800.svg
[rank3]:2025-12-31 20:43:41,061 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/frozen_params_histogram/251231_2043_rank3_stage3.svg
[rank3]:	> Counts Sum: 1480800, Total Sum: 1962240 (75.46%), Ratio(%) per element: [74.65, 74.14, 75.0, 76.54, 74.48, 74.31, 74.82, 75.51, 76.71, 75.51, 76.54, 75.0, 74.82, 76.19, 75.17, 75.17, 77.22, 74.65, 76.71, 75.17, 75.34, 76.71, 76.54, 73.97, 76.02, 74.14, 76.54, 74.65, 75.0, 76.19, 78.08, 75.68, 76.71, 75.0, 75.17, 75.85, 74.14, 75.17, 73.8, 76.02, 75.85, 74.48]
[rank2]:2025-12-31 20:43:42,707 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2043_stage2.svg
[rank2]:2025-12-31 20:43:42,710 - Destroying the purge thread.
[rank0]:2025-12-31 20:43:42,720 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2043_stage0.svg
[rank0]:2025-12-31 20:43:42,723 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-31 20:43:42,699 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2043_stage1.svg
[rank1]:2025-12-31 20:43:42,702 - Destroying the purge thread.
[rank3]:2025-12-31 20:43:42,920 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1/afr_time_plot/251231_2043_stage3.svg
[rank3]:2025-12-31 20:43:42,924 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-31 20:43:43,071 - Process group destroyed
[rank1]:2025-12-31 20:43:43,040 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 340-361
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–‚â–‚â–‚â–ˆâ–â–â–â–‡â–â–â–â–‡â–‚â–â–â–†
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.73053
[rank3]:wandb:               final/avg_loss 9.79156
[rank3]:wandb:             final/avg_mfu(%) 20.12382
[rank3]:wandb:             final/avg_tflops 68.66727
[rank3]:wandb:    final/avg_throughput(tps) 8783.74443
[rank3]:wandb:              final/grad_norm 13.86732
[rank3]:wandb:               final/max_loss 9.79156
[rank3]:wandb:                    grad_norm 13.86732
[rank3]:wandb: loss_metrics/global_avg_loss 9.79156
[rank3]:wandb: loss_metrics/global_max_loss 9.79156
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_GPipe_fullrand7_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/kr2gczla
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_GPipe_fullrand7_42_dm1/20251231-1950/wandb/run-20251231_195046-kr2gczla/logs
[rank3]:2025-12-31 20:43:44,534 - Process group destroyed
[rank0]:2025-12-31 20:43:44,723 - Training completed
[rank0]:2025-12-31 20:43:44,724 - Destroying the purge thread.
[rank0]:2025-12-31 20:43:45,043 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.9', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.3', 'layers.0', 'layers.1', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.8', 'layers.5', 'layers.6', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'layers.14', 'norm', 'output'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_GPipe_fullrand7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_GPipe_fullrand7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_GPipe_fullrand7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_GPipe_fullrand7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_GPipe_fullrand7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_GPipe_fullrand7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_GPipe_fullrand7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_GPipe_fullrand7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
