
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 18:29:50 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_InterleavedZeroBubble_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with auto x InterleavedZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2026-01-01 18:29:58,198 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2026-01-01 18:29:58,193 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank0]:2026-01-01 18:29:58,345 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank1]:2026-01-01 18:29:58,386 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank3]:2026-01-01 18:29:58,508 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 18:29:58,511 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-01 18:29:58,498 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 18:29:58,501 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 18:29:58,662 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 18:29:58,666 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 18:29:58,670 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 18:29:58,671 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-01 18:29:58,688 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 18:29:58,690 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 18:29:59,066 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2026-01-01 18:30:01,865 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2026-01-01 18:30:01,996 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 18:30:02,037 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 18:30:02,013 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 18:30:02,051 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 18:30:02,052 - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2026-01-01 18:30:01,970 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 18:30:02,012 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 18:30:02,038 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2026-01-01 18:30:02,050 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2026-01-01 18:30:02,052 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank1]:2026-01-01 18:30:02,063 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2026-01-01 18:30:02,075 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2026-01-01 18:30:02,078 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank0]:2026-01-01 18:30:02,079 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2026-01-01 18:30:02,092 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2026-01-01 18:30:02,093 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank2]:2026-01-01 18:30:02,238 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 18:30:02,238 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 18:30:02,238 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2026-01-01 18:30:02,265 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 18:30:02,265 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 18:30:02,266 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2026-01-01 18:30:02,294 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 18:30:02,294 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 18:30:02,295 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run pat9fubh
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_InterleavedZeroBubble_auto_42_dm1/20260101-1830/wandb/run-20260101_183003-pat9fubh
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/pat9fubh
[rank3]:2026-01-01 18:30:04,401 - WandB logging enabled
[rank3]:2026-01-01 18:30:04,401 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 18:30:04,439 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 18:30:04,467 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2026-01-01 18:30:04,480 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2026-01-01 18:30:04,482 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank0]:2026-01-01 18:30:04,686 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_InterleavedZeroBubble_auto_42_dm1
[rank0]:2026-01-01 18:30:04,687 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 18:30:04,687 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 18:30:04,687 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2026-01-01 18:30:04,687 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 18:30:04,686 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-01 18:30:04,670 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 18:30:04,670 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 18:30:04,671 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2026-01-01 18:30:04,686 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 18:30:07,334 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 18:30:07,334 - Finished loading the checkpoint in 2.65 seconds.
[rank0]:2026-01-01 18:30:07,359 - [LoRA] [Stage 0] trainable num params: 28 / 47 = 59.57% (size: 1,409,024 / 385,720,320 = 0.37%)
[rank2]:2026-01-01 18:30:07,357 - [LoRA] [Stage 2] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank0]:2026-01-01 18:30:07,381 - [LoRA] [Stage 4] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank0]:2026-01-01 18:30:07,382 - Freezable Parameters: [Stage 0] 28 params, [Stage 4] 28 params
[rank0]:2026-01-01 18:30:07,382 - Training starts at step 1
[rank3]:2026-01-01 18:30:07,389 - [LoRA] [Stage 3] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank3]:2026-01-01 18:30:07,401 - [LoRA] [Stage 7] trainable num params: 14 / 25 = 56.00% (size: 704,512 / 324,196,352 = 0.22%)
[rank3]:2026-01-01 18:30:07,402 - Freezable Parameters: [Stage 3] 28 params, [Stage 7] 14 params
[rank1]:2026-01-01 18:30:07,370 - [LoRA] [Stage 1] trainable num params: 42 / 69 = 60.87% (size: 2,113,536 / 184,578,048 = 1.15%)
[rank2]:2026-01-01 18:30:07,382 - [LoRA] [Stage 6] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank2]:2026-01-01 18:30:07,383 - Freezable Parameters: [Stage 2] 28 params, [Stage 6] 28 params
[rank1]:2026-01-01 18:30:07,392 - [LoRA] [Stage 5] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank1]:2026-01-01 18:30:07,392 - Freezable Parameters: [Stage 1] 42 params, [Stage 5] 28 params
[rank2]:2026-01-01 18:30:13,197 -  step:  1  loss: -4.0000  grad_norm:  9.9909  memory: 14.23GiB(29.96%)  tps: 2,930  tflops: 22.90  mfu: 7.34%
[rank2]:2026-01-01 18:30:13,198 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 18:30:13,210 -  step:  1  loss: -4.0000  grad_norm:  9.9909  memory: 19.62GiB(41.30%)  tps: 2,933  tflops: 22.93  mfu: 7.35%
[rank0]:2026-01-01 18:30:13,231 -  step:  1  loss: -4.0000  grad_norm:  9.9909  memory: 13.98GiB(29.42%)  tps: 2,931  tflops: 22.91  mfu: 7.34%
[rank3]:2026-01-01 18:30:13,199 -  step:  1  loss: 10.6092  grad_norm:  9.9909  memory: 30.44GiB(64.07%)  tps: 3,742  tflops: 29.25  mfu: 9.38%
[rank0]:2026-01-01 18:30:13,231 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 18:30:13,200 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 18:30:13,211 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 18:34:10,704 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 18:34:15,583 - Avg. fwd time: 13.3042 / Avg. bwd-weight time: 2.0685 / Avg. bwd-input time: 15.0447 / Avg. batch time: 1131.6909 (ms) / GPU bubble ratio: 57.00%
[rank3]:2026-01-01 18:34:15,533 - Avg. fwd time: 17.0102 / Avg. bwd-weight time: 1.5159 / Avg. bwd-input time: 26.3499 / Avg. batch time: 1065.9207 (ms) / GPU bubble ratio: 32.64%
[rank1]:2026-01-01 18:34:15,618 - Avg. fwd time: 16.6890 / Avg. bwd-weight time: 2.9214 / Avg. bwd-input time: 18.9335 / Avg. batch time: 1189.3483 (ms) / GPU bubble ratio: 48.15%
[rank1]:2026-01-01 18:34:15,632 -  step: 50  loss: -4.0000  grad_norm:  8.4748  memory: 19.62GiB(41.30%)  tps: 6,623  tflops: 51.78  mfu: 16.60%
[rank2]:2026-01-01 18:34:15,632 -  step: 50  loss: -4.0000  grad_norm:  8.4748  memory: 14.23GiB(29.96%)  tps: 6,623  tflops: 51.78  mfu: 16.59%
[rank3]:2026-01-01 18:34:15,632 -  step: 50  loss: 12.4624  grad_norm:  8.4748  memory: 30.44GiB(64.07%)  tps: 6,623  tflops: 51.78  mfu: 16.59%
[rank0]:2026-01-01 18:34:15,629 - Avg. fwd time: 13.6849 / Avg. full-bwd time: 14.5027 (Avg. bwd-weight time: 1.3570 / Avg. bwd-input time: 15.0276) / Avg. batch time: 1218.4892 (ms) / GPU bubble ratio: 61.75%
[rank0]:2026-01-01 18:34:15,632 -  step: 50  loss: -4.0000  grad_norm:  8.4748  memory: 13.98GiB(29.42%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank3]:2026-01-01 18:35:00,252 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank0]:2026-01-01 18:35:00,254 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2026-01-01 18:35:00,253 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2026-01-01 18:35:00,252 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2026-01-01 18:35:49,824 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 5.5028e+00
[rank1]:2026-01-01 18:35:49,823 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.7895e+00
[rank2]:2026-01-01 18:35:49,823 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.6378e+00
[rank3]:2026-01-01 18:35:49,822 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.3424e+00
[rank1]:2026-01-01 18:36:39,257 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.2815e+00
[rank2]:2026-01-01 18:36:39,256 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.3986e+00
[rank3]:2026-01-01 18:36:39,256 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.3932e+00
[rank0]:2026-01-01 18:36:39,258 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.6828e+01
[rank0]:2026-01-01 18:37:28,762 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.6721e+00
[rank2]:2026-01-01 18:37:28,761 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9103e+00
[rank1]:2026-01-01 18:37:28,761 - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.7059e+00
[rank3]:2026-01-01 18:37:28,760 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2583e+00
[rank2]:2026-01-01 18:38:17,945 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.5848e+00
[rank1]:2026-01-01 18:38:17,945 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.2409e+00
[rank3]:2026-01-01 18:38:17,944 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3612e+00
[rank0]:2026-01-01 18:38:17,944 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 18:38:17,947 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.2591e+00
[rank2]:2026-01-01 18:38:22,792 - Avg. fwd time: 13.3134 / Avg. bwd-weight time: 2.0721 / Avg. bwd-input time: 15.0462 / Avg. batch time: 1133.1644 (ms) / GPU bubble ratio: 57.03%
[rank3]:2026-01-01 18:38:22,737 - Avg. fwd time: 17.0779 / Avg. bwd-weight time: 1.5155 / Avg. bwd-input time: 26.4089 / Avg. batch time: 1067.4478 (ms) / GPU bubble ratio: 32.55%
[rank0]:2026-01-01 18:38:22,831 - Avg. fwd time: 13.7301 / Avg. full-bwd time: 12.1475 (Avg. bwd-weight time: 1.3514 / Avg. bwd-input time: 15.0344) / Avg. batch time: 1217.5915 (ms) / GPU bubble ratio: 63.21%
[rank0]:2026-01-01 18:38:22,834 -  step: 100  loss: -4.0000  grad_norm:  7.0230  memory: 13.98GiB(29.42%)  tps: 6,628  tflops: 51.81  mfu: 16.61%
[rank2]:2026-01-01 18:38:22,834 -  step: 100  loss: -4.0000  grad_norm:  7.0230  memory: 14.23GiB(29.96%)  tps: 6,628  tflops: 51.81  mfu: 16.61%
[rank2]:2026-01-01 18:38:22,906 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1838_stage2_step100.svg
[rank1]:2026-01-01 18:38:22,827 - Avg. fwd time: 16.6981 / Avg. bwd-weight time: 2.7530 / Avg. bwd-input time: 18.9455 / Avg. batch time: 1190.2966 (ms) / GPU bubble ratio: 48.39%
[rank1]:2026-01-01 18:38:22,834 -  step: 100  loss: -4.0000  grad_norm:  7.0230  memory: 19.62GiB(41.30%)  tps: 6,628  tflops: 51.81  mfu: 16.61%
[rank1]:2026-01-01 18:38:22,909 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1838_stage1_step100.svg
[rank3]:2026-01-01 18:38:22,835 -  step: 100  loss: 13.1176  grad_norm:  7.0230  memory: 30.44GiB(64.07%)  tps: 6,628  tflops: 51.81  mfu: 16.61%
[rank0]:2026-01-01 18:38:22,907 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1838_stage0_step100.svg
[rank2]:2026-01-01 18:38:22,954 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1838_stage6_step100.svg
[rank1]:2026-01-01 18:38:22,955 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1838_stage5_step100.svg
[rank0]:2026-01-01 18:38:22,955 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1838_stage4_step100.svg
[rank2]:2026-01-01 18:38:23,090 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank2_stage2.svg
[rank2]:	> Counts Sum: 0, Total Sum: 140 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 18:38:23,097 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank1_stage1.svg
[rank1]:	> Counts Sum: 28, Total Sum: 210 (13.33%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 18:38:23,088 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank0_stage0.svg
[rank0]:	> Counts Sum: 56, Total Sum: 140 (40.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 18:38:23,193 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1838_step100_rank3.svg
[rank3]:			> Batch Time: 1206.26 ms, GPU Bubble Ratio: 66.28%, 51.31%, 59.70%, 40.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  186-14-201ms   | [S4,MB3,F]  244-14-258ms   | [S4,MB0,BI] 387-14-401ms   | [S4,MB0,BW] 401-1-402ms    | [S0,MB4,F]  402-12-415ms   | [S4,MB1,BI] 455-15-471ms   | [S4,MB1,BW] 471-1-472ms    | [S0,MB5,F]  472-12-485ms   | [S4,MB2,BI] 532-15-547ms   | [S4,MB2,BW] 547-1-548ms    | [S0,MB6,F]  549-13-562ms   | [S4,MB3,BI] 600-17-617ms   | [S4,MB3,BW] 617-1-618ms    | [S0,MB7,F]  618-15-633ms   | [S0,MB0,B]  654-7-662ms    | [S4,MB4,F]  662-14-676ms   | [S0,MB1,B]  705-7-713ms    | [S4,MB5,F]  713-13-726ms   | [S0,MB2,B]  750-7-757ms    | [S4,MB6,F]  757-12-770ms   | [S0,MB3,B]  794-7-801ms    | [S4,MB7,F]  801-12-813ms   | [S4,MB4,BI] 852-15-867ms   | [S4,MB4,BW] 867-1-868ms    | [S4,MB5,BI] 939-14-953ms   | [S4,MB5,BW] 953-1-954ms    | [S4,MB6,BI] 1002-14-1016ms | [S4,MB6,BW] 1016-1-1017ms  | [S4,MB7,BI] 1079-14-1093ms | [S4,MB7,BW] 1093-2-1095ms  | [S0,MB4,B]  1108-6-1114ms  | [S0,MB5,B]  1144-6-1150ms  | [S0,MB6,B]  1172-6-1178ms  | [S0,MB7,B]  1200-6-1206ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  186-19-205ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  263-12-276ms   | [S5,MB2,F]  282-12-295ms   | [S5,MB0,BI] 363-14-378ms   | [S5,MB3,F]  378-15-394ms   | [S5,MB1,BI] 432-14-447ms   | [S5,MB0,BW] 447-3-450ms    | [S1,MB4,F]  456-19-476ms   | [S5,MB2,BI] 503-15-519ms   | [S5,MB1,BW] 519-1-520ms    | [S1,MB5,F]  532-19-552ms   | [S5,MB3,BI] 574-16-591ms   | [S5,MB2,BW] 591-2-594ms    | [S1,MB6,F]  602-20-623ms   | [S1,MB0,BI] 623-24-647ms   | [S5,MB3,BW] 647-2-650ms    | [S1,MB7,F]  655-20-676ms   | [S1,MB1,BI] 675-23-698ms   | [S1,MB0,BW] 698-0-698ms    | [S5,MB4,F]  706-14-720ms   | [S1,MB2,BI] 720-22-743ms   | [S1,MB1,BW] 743-0-743ms    | [S5,MB5,F]  750-13-764ms   | [S1,MB3,BI] 764-22-787ms   | [S1,MB2,BW] 787-0-787ms    | [S5,MB6,F]  794-13-807ms   | [S5,MB4,BI] 830-15-845ms   | [S1,MB3,BW] 845-0-845ms    | [S5,MB7,F]  853-13-866ms   | [S5,MB5,BI] 905-15-920ms   | [S5,MB4,BW] 920-1-922ms    | [S5,MB6,BI] 980-14-995ms   | [S5,MB5,BW] 994-2-997ms    | [S5,MB7,BI] 1057-14-1071ms | [S5,MB6,BW] 1072-2-1075ms  | [S1,MB4,BI] 1079-21-1101ms | [S5,MB7,BW] 1101-2-1104ms  | [S1,MB5,BI] 1115-21-1137ms | [S1,MB4,BW] 1137-0-1137ms  | [S1,MB6,BI] 1143-21-1165ms | [S1,MB5,BW] 1165-0-1165ms  | [S1,MB7,BI] 1172-22-1194ms | [S1,MB6,BW] 1193-0-1193ms  | [S1,MB7,BW] 1194-0-1194ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  205-12-218ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  276-12-289ms   | [S6,MB0,BI] 342-14-357ms   | [S6,MB2,F]  357-14-371ms   | [S6,MB1,BI] 411-15-426ms   | [S6,MB3,F]  426-14-440ms   | [S6,MB2,BI] 483-14-497ms   | [S6,MB0,BW] 497-2-500ms    | [S2,MB4,F]  505-13-518ms   | [S6,MB3,BI] 553-15-568ms   | [S6,MB1,BW] 568-2-570ms    | [S2,MB5,F]  578-13-591ms   | [S2,MB0,BI] 596-15-612ms   | [S6,MB2,BW] 612-2-614ms    | [S2,MB6,F]  626-13-640ms   | [S2,MB1,BI] 640-15-656ms   | [S6,MB3,BW] 656-1-657ms    | [S2,MB7,F]  677-13-690ms   | [S2,MB2,BI] 690-15-706ms   | [S2,MB0,BW] 706-1-707ms    | [S6,MB4,F]  721-13-735ms   | [S2,MB3,BI] 735-15-750ms   | [S2,MB1,BW] 750-1-752ms    | [S6,MB5,F]  765-13-778ms   | [S6,MB4,BI] 808-15-823ms   | [S2,MB2,BW] 824-2-826ms    | [S6,MB6,F]  831-13-844ms   | [S6,MB5,BI] 883-15-898ms   | [S2,MB3,BW] 899-2-901ms    | [S6,MB7,F]  906-13-919ms   | [S6,MB6,BI] 959-15-974ms   | [S6,MB4,BW] 974-2-976ms    | [S6,MB7,BI] 1037-14-1051ms | [S6,MB5,BW] 1051-2-1053ms  | [S2,MB4,BI] 1058-14-1073ms | [S6,MB6,BW] 1072-2-1075ms  | [S2,MB5,BI] 1094-14-1109ms | [S6,MB7,BW] 1108-2-1111ms  | [S2,MB6,BI] 1115-14-1130ms | [S2,MB4,BW] 1129-1-1130ms  | [S2,MB7,BI] 1143-14-1158ms | [S2,MB5,BW] 1157-1-1158ms  | [S2,MB6,BW] 1158-1-1159ms  | [S2,MB7,BW] 1159-1-1160ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-173ms   | [S3,MB3,F]  218-12-231ms   | [S7,MB0,F]  270-18-288ms   | [S7,MB0,BI] 300-35-335ms   | [S7,MB1,F]  335-20-356ms   | [S7,MB1,BI] 368-35-404ms   | [S7,MB2,F]  404-23-428ms   | [S7,MB2,BI] 440-36-476ms   | [S7,MB3,F]  476-22-499ms   | [S7,MB3,BI] 510-36-546ms   | [S7,MB0,BW] 546-1-547ms    | [S3,MB4,F]  554-15-569ms   | [S3,MB0,BI] 568-18-587ms   | [S7,MB1,BW] 587-2-589ms    | [S3,MB5,F]  598-13-612ms   | [S3,MB1,BI] 611-18-629ms   | [S7,MB2,BW] 629-1-631ms    | [S3,MB6,F]  641-13-655ms   | [S3,MB2,BI] 654-16-671ms   | [S7,MB3,BW] 671-0-672ms    | [S3,MB7,F]  691-13-705ms   | [S3,MB3,BI] 704-16-721ms   | [S3,MB0,BW] 721-1-723ms    | [S7,MB4,F]  736-18-755ms   | [S7,MB4,BI] 766-35-802ms   | [S3,MB1,BW] 801-2-804ms    | [S7,MB5,F]  809-19-829ms   | [S7,MB5,BI] 841-35-877ms   | [S3,MB2,BW] 876-2-879ms    | [S7,MB6,F]  884-20-905ms   | [S7,MB6,BI] 916-35-952ms   | [S3,MB3,BW] 952-2-954ms    | [S7,MB7,F]  959-22-982ms   | [S7,MB7,BI] 993-35-1029ms  | [S7,MB4,BW] 1029-1-1030ms  | [S3,MB4,BI] 1030-17-1048ms | [S7,MB5,BW] 1047-0-1048ms  | [S3,MB5,BI] 1048-17-1066ms | [S7,MB6,BW] 1065-0-1066ms  | [S3,MB6,BI] 1066-16-1082ms | [S7,MB7,BW] 1082-0-1083ms  | [S3,MB7,BI] 1087-16-1104ms | [S3,MB4,BW] 1103-1-1104ms  | [S3,MB5,BW] 1104-1-1105ms  | [S3,MB6,BW] 1106-1-1107ms  | [S3,MB7,BW] 1107-1-1108ms 
[rank0]:2026-01-01 18:38:23,215 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank0_stage4.svg
[rank0]:	> Counts Sum: 0, Total Sum: 140 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 18:38:23,218 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank2_stage6.svg
[rank2]:	> Counts Sum: 0, Total Sum: 140 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 18:38:23,223 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank1_stage5.svg
[rank1]:	> Counts Sum: 0, Total Sum: 140 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 18:38:23,237 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1838_stage3_step100.svg
[rank3]:2026-01-01 18:38:23,275 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1838_stage7_step100.svg
[rank3]:2026-01-01 18:38:23,410 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank3_stage3.svg
[rank3]:	> Counts Sum: 28, Total Sum: 140 (20.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]
[rank3]:2026-01-01 18:38:23,500 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1838_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 70 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 18:39:07,824 - Freezing Ratio: [Stage2] 0.50, [Stage6] 0.00, Threshold: 6.2464e+00
[rank1]:2026-01-01 18:39:07,825 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.8195e+00
[rank3]:2026-01-01 18:39:07,824 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.0498e+00
[rank0]:2026-01-01 18:39:07,826 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 5.6347e+00
[rank0]:2026-01-01 18:39:57,166 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.7127e+01
[rank2]:2026-01-01 18:39:57,165 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.2216e+00
[rank3]:2026-01-01 18:39:57,164 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6975e+00
[rank1]:2026-01-01 18:39:57,165 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 5.4970e+00
[rank2]:2026-01-01 18:40:46,464 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0218e+45
[rank1]:2026-01-01 18:40:46,464 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.4525e+00
[rank3]:2026-01-01 18:40:46,463 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6367e+00
[rank0]:2026-01-01 18:40:46,464 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.7608e+00
[rank2]:2026-01-01 18:41:35,748 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.6612e+00
[rank3]:2026-01-01 18:41:35,748 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0598e+00
[rank1]:2026-01-01 18:41:35,749 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.9781e+00
[rank0]:2026-01-01 18:41:35,749 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.3127e+00
[rank0]:2026-01-01 18:42:24,968 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 18:42:24,972 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 6.0715e+00
[rank2]:2026-01-01 18:42:24,956 - Freezing Ratio: [Stage2] 0.50, [Stage6] 0.00, Threshold: 6.4932e+00
[rank1]:2026-01-01 18:42:24,967 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 3.8513e+00
[rank3]:2026-01-01 18:42:24,956 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.0604e+00
[rank2]:2026-01-01 18:42:29,897 - Avg. fwd time: 13.3242 / Avg. bwd-weight time: 2.0114 / Avg. bwd-input time: 15.0521 / Avg. batch time: 1133.9992 (ms) / GPU bubble ratio: 57.12%
[rank1]:2026-01-01 18:42:29,930 - Avg. fwd time: 16.6824 / Avg. bwd-weight time: 2.3518 / Avg. bwd-input time: 18.9305 / Avg. batch time: 1189.9679 (ms) / GPU bubble ratio: 48.95%
[rank1]:2026-01-01 18:42:29,941 -  step: 150  loss: -4.0000  grad_norm:  4.1772  memory: 19.62GiB(41.30%)  tps: 6,630  tflops: 51.83  mfu: 16.61%
[rank3]:2026-01-01 18:42:29,851 - Avg. fwd time: 17.1182 / Avg. bwd-weight time: 1.3416 / Avg. bwd-input time: 26.4499 / Avg. batch time: 1067.3310 (ms) / GPU bubble ratio: 32.68%
[rank3]:2026-01-01 18:42:29,942 -  step: 150  loss: 11.1266  grad_norm:  4.1772  memory: 30.44GiB(64.07%)  tps: 6,630  tflops: 51.83  mfu: 16.61%
[rank0]:2026-01-01 18:42:29,938 - Avg. fwd time: 13.7649 / Avg. full-bwd time: 10.3839 (Avg. bwd-weight time: 1.3479 / Avg. bwd-input time: 15.0405) / Avg. batch time: 1216.6320 (ms) / GPU bubble ratio: 64.29%
[rank0]:2026-01-01 18:42:29,942 -  step: 150  loss: -4.0000  grad_norm:  4.1772  memory: 13.98GiB(29.42%)  tps: 6,630  tflops: 51.83  mfu: 16.61%
[rank2]:2026-01-01 18:42:29,941 -  step: 150  loss: -4.0000  grad_norm:  4.1772  memory: 14.23GiB(29.96%)  tps: 6,630  tflops: 51.83  mfu: 16.61%
[rank2]:2026-01-01 18:43:14,369 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.1816e+00
[rank1]:2026-01-01 18:43:14,370 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 5.5170e+00
[rank3]:2026-01-01 18:43:14,368 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.8146e+00
[rank0]:2026-01-01 18:43:14,370 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.6619e+01
[rank0]:2026-01-01 18:44:03,706 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 3.8649e+00
[rank2]:2026-01-01 18:44:03,705 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.7677e-01
[rank1]:2026-01-01 18:44:03,705 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.0299e+00
[rank3]:2026-01-01 18:44:03,704 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 9.7652e-01
[rank2]:2026-01-01 18:44:52,887 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.6597e+00
[rank3]:2026-01-01 18:44:52,886 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2975e+44
[rank1]:2026-01-01 18:44:52,888 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 4.0000e+00
[rank0]:2026-01-01 18:44:52,888 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.50, Threshold: 2.3053e+00
[rank0]:2026-01-01 18:45:41,912 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.0000e+00
[rank3]:2026-01-01 18:45:41,910 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0056e+01
[rank2]:2026-01-01 18:45:41,911 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3180e+01
[rank1]:2026-01-01 18:45:41,911 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2026-01-01 18:46:31,425 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3820e+00
[rank2]:2026-01-01 18:46:31,425 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.3898e+00
[rank1]:2026-01-01 18:46:31,426 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.7160e-01
[rank0]:2026-01-01 18:46:31,425 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 18:46:31,428 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 7.2968e+40
[rank3]:2026-01-01 18:46:36,355 - Avg. fwd time: 17.1581 / Avg. bwd-weight time: 1.3417 / Avg. bwd-input time: 26.4901 / Avg. batch time: 1068.0418 (ms) / GPU bubble ratio: 32.60%
[rank3]:2026-01-01 18:46:36,450 -  step: 200  loss: 10.3045  grad_norm:  5.7724  memory: 30.44GiB(64.07%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank2]:2026-01-01 18:46:36,408 - Avg. fwd time: 13.3277 / Avg. bwd-weight time: 1.9059 / Avg. bwd-input time: 15.0458 / Avg. batch time: 1134.0305 (ms) / GPU bubble ratio: 57.28%
[rank2]:2026-01-01 18:46:36,449 -  step: 200  loss: -4.0000  grad_norm:  5.7724  memory: 14.23GiB(29.96%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank1]:2026-01-01 18:46:36,438 - Avg. fwd time: 16.6794 / Avg. bwd-weight time: 2.0890 / Avg. bwd-input time: 18.9248 / Avg. batch time: 1189.7771 (ms) / GPU bubble ratio: 49.31%
[rank1]:2026-01-01 18:46:36,449 -  step: 200  loss: -4.0000  grad_norm:  5.7724  memory: 19.62GiB(41.30%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank0]:2026-01-01 18:46:36,446 - Avg. fwd time: 13.8013 / Avg. full-bwd time: 9.1610 (Avg. bwd-weight time: 1.2790 / Avg. bwd-input time: 15.0440) / Avg. batch time: 1215.7865 (ms) / GPU bubble ratio: 65.07%
[rank0]:2026-01-01 18:46:36,449 -  step: 200  loss: -4.0000  grad_norm:  5.7724  memory: 13.98GiB(29.42%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank0]:2026-01-01 18:46:36,506 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1846_stage0_step200.svg
[rank2]:2026-01-01 18:46:36,508 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1846_stage2_step200.svg
[rank2]:2026-01-01 18:46:36,552 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1846_stage6_step200.svg
[rank1]:2026-01-01 18:46:36,505 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1846_stage1_step200.svg
[rank1]:2026-01-01 18:46:36,548 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1846_stage5_step200.svg
[rank0]:2026-01-01 18:46:36,548 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1846_stage4_step200.svg
[rank0]:2026-01-01 18:46:36,674 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank0_stage0.svg
[rank0]:	> Counts Sum: 210, Total Sum: 420 (50.00%), Ratio(%) per element: [93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66]
[rank2]:2026-01-01 18:46:36,685 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank2_stage2.svg
[rank2]:	> Counts Sum: 84, Total Sum: 420 (20.00%), Ratio(%) per element: [26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33]
[rank1]:2026-01-01 18:46:36,684 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank1_stage1.svg
[rank1]:	> Counts Sum: 406, Total Sum: 630 (64.44%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank0]:2026-01-01 18:46:36,800 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank0_stage4.svg
[rank0]:	> Counts Sum: 14, Total Sum: 420 (3.33%), Ratio(%) per element: [6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 18:46:36,856 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1846_step200_rank3.svg
[rank3]:			> Batch Time: 1217.29 ms, GPU Bubble Ratio: 66.51%, 49.20%, 61.16%, 40.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S4,MB0,BI] 388-14-402ms   | [S4,MB0,BW] 402-1-403ms    | [S0,MB4,F]  404-12-416ms   | [S4,MB1,BI] 457-15-473ms   | [S4,MB1,BW] 473-1-474ms    | [S0,MB5,F]  474-13-487ms   | [S4,MB2,BI] 535-15-551ms   | [S4,MB2,BW] 551-1-552ms    | [S0,MB6,F]  552-13-565ms   | [S4,MB3,BI] 603-17-620ms   | [S4,MB3,BW] 621-1-622ms    | [S0,MB7,F]  622-15-637ms   | [S0,MB0,B]  658-7-666ms    | [S4,MB4,F]  666-14-680ms   | [S0,MB1,B]  710-7-718ms    | [S4,MB5,F]  718-13-731ms   | [S0,MB2,B]  755-7-762ms    | [S4,MB6,F]  762-13-775ms   | [S0,MB3,B]  799-7-806ms    | [S4,MB7,F]  807-13-820ms   | [S4,MB4,BI] 858-15-873ms   | [S4,MB4,BW] 873-1-874ms    | [S4,MB5,BI] 946-14-960ms   | [S4,MB5,BW] 960-1-961ms    | [S4,MB6,BI] 1010-14-1024ms | [S4,MB6,BW] 1024-1-1025ms  | [S4,MB7,BI] 1088-14-1102ms | [S4,MB7,BW] 1102-2-1104ms  | [S0,MB4,B]  1116-6-1122ms  | [S0,MB5,B]  1153-6-1159ms  | [S0,MB6,B]  1182-6-1188ms  | [S0,MB7,B]  1211-6-1217ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 365-14-380ms   | [S5,MB3,F]  380-15-395ms   | [S5,MB1,BI] 434-14-449ms   | [S5,MB0,BW] 449-3-452ms    | [S1,MB4,F]  459-19-479ms   | [S5,MB2,BI] 506-15-522ms   | [S5,MB1,BW] 521-1-523ms    | [S1,MB5,F]  536-19-556ms   | [S5,MB3,BI] 578-16-595ms   | [S5,MB2,BW] 595-2-598ms    | [S1,MB6,F]  606-20-627ms   | [S1,MB0,BI] 627-24-651ms   | [S5,MB3,BW] 651-2-654ms    | [S1,MB7,F]  659-20-680ms   | [S1,MB1,BI] 680-23-703ms   | [S1,MB0,BW] 703-3-707ms    | [S5,MB4,F]  711-14-725ms   | [S1,MB2,BI] 725-23-748ms   | [S1,MB1,BW] 748-3-752ms    | [S5,MB5,F]  755-13-769ms   | [S1,MB3,BI] 769-23-793ms   | [S1,MB2,BW] 792-3-796ms    | [S5,MB6,F]  800-13-814ms   | [S5,MB4,BI] 835-15-851ms   | [S1,MB3,BW] 851-3-855ms    | [S5,MB7,F]  858-13-872ms   | [S5,MB5,BI] 910-15-925ms   | [S5,MB4,BW] 925-1-927ms    | [S5,MB6,BI] 988-14-1002ms  | [S5,MB5,BW] 1002-2-1005ms  | [S5,MB7,BI] 1066-14-1080ms | [S5,MB6,BW] 1080-2-1083ms  | [S1,MB4,BI] 1087-21-1109ms | [S5,MB7,BW] 1109-2-1112ms  | [S1,MB5,BI] 1124-22-1146ms | [S1,MB4,BW] 1146-3-1150ms  | [S1,MB6,BI] 1153-22-1175ms | [S1,MB5,BW] 1175-3-1179ms  | [S1,MB7,BI] 1181-22-1203ms | [S1,MB6,BW] 1204-3-1208ms  | [S1,MB7,BW] 1207-1-1208ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB0,BI] 343-14-358ms   | [S6,MB2,F]  358-14-373ms   | [S6,MB1,BI] 412-15-427ms   | [S6,MB3,F]  428-14-442ms   | [S6,MB2,BI] 485-14-500ms   | [S6,MB0,BW] 500-2-502ms    | [S2,MB4,F]  507-13-520ms   | [S6,MB3,BI] 556-15-572ms   | [S6,MB1,BW] 572-2-574ms    | [S2,MB5,F]  581-13-595ms   | [S2,MB0,BI] 600-15-616ms   | [S6,MB2,BW] 616-2-618ms    | [S2,MB6,F]  630-13-644ms   | [S2,MB1,BI] 644-15-659ms   | [S6,MB3,BW] 659-1-661ms    | [S2,MB7,F]  681-13-694ms   | [S2,MB2,BI] 694-15-710ms   | [S2,MB0,BW] 710-0-710ms    | [S6,MB4,F]  726-13-739ms   | [S2,MB3,BI] 739-15-755ms   | [S2,MB1,BW] 754-0-754ms    | [S6,MB5,F]  770-13-784ms   | [S6,MB4,BI] 813-15-829ms   | [S2,MB2,BW] 829-0-829ms    | [S6,MB6,F]  836-13-850ms   | [S6,MB5,BI] 888-15-904ms   | [S2,MB3,BW] 904-0-904ms    | [S6,MB7,F]  911-13-924ms   | [S6,MB6,BI] 966-15-981ms   | [S6,MB4,BW] 981-2-984ms    | [S6,MB7,BI] 1044-14-1059ms | [S6,MB5,BW] 1059-2-1062ms  | [S2,MB4,BI] 1065-14-1080ms | [S6,MB6,BW] 1080-2-1083ms  | [S2,MB5,BI] 1102-14-1117ms | [S6,MB7,BW] 1116-2-1119ms  | [S2,MB6,BI] 1123-14-1138ms | [S2,MB4,BW] 1137-0-1137ms  | [S2,MB7,BI] 1152-14-1167ms | [S2,MB5,BW] 1166-0-1166ms  | [S2,MB6,BW] 1166-0-1166ms  | [S2,MB7,BW] 1166-0-1166ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-289ms   | [S7,MB0,BI] 301-35-337ms   | [S7,MB1,F]  337-21-359ms   | [S7,MB1,BI] 370-36-406ms   | [S7,MB2,F]  406-23-430ms   | [S7,MB2,BI] 442-36-479ms   | [S7,MB3,F]  478-22-501ms   | [S7,MB3,BI] 514-36-550ms   | [S7,MB0,BW] 550-1-551ms    | [S3,MB4,F]  558-15-573ms   | [S3,MB0,BI] 572-18-590ms   | [S7,MB1,BW] 591-2-593ms    | [S3,MB5,F]  602-13-616ms   | [S3,MB1,BI] 616-17-633ms   | [S7,MB2,BW] 633-1-634ms    | [S3,MB6,F]  645-13-659ms   | [S3,MB2,BI] 659-16-675ms   | [S7,MB3,BW] 675-0-675ms    | [S3,MB7,F]  696-13-709ms   | [S3,MB3,BI] 709-16-725ms   | [S3,MB0,BW] 725-1-727ms    | [S7,MB4,F]  741-18-760ms   | [S7,MB4,BI] 771-35-807ms   | [S3,MB1,BW] 807-2-809ms    | [S7,MB5,F]  815-20-835ms   | [S7,MB5,BI] 846-35-882ms   | [S3,MB2,BW] 882-2-885ms    | [S7,MB6,F]  890-20-910ms   | [S7,MB6,BI] 924-36-960ms   | [S3,MB3,BW] 960-2-962ms    | [S7,MB7,F]  967-22-989ms   | [S7,MB7,BI] 1001-36-1037ms | [S7,MB4,BW] 1037-1-1038ms  | [S3,MB4,BI] 1039-17-1056ms | [S7,MB5,BW] 1055-0-1056ms  | [S3,MB5,BI] 1056-17-1074ms | [S7,MB6,BW] 1073-0-1074ms  | [S3,MB6,BI] 1074-16-1090ms | [S7,MB7,BW] 1091-1-1092ms  | [S3,MB7,BI] 1095-17-1112ms | [S3,MB4,BW] 1112-1-1113ms  | [S3,MB5,BW] 1113-1-1114ms  | [S3,MB6,BW] 1114-1-1115ms  | [S3,MB7,BW] 1116-1-1118ms 
[rank2]:2026-01-01 18:46:36,815 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank2_stage6.svg
[rank2]:	> Counts Sum: 0, Total Sum: 420 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 18:46:36,820 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank1_stage5.svg
[rank1]:	> Counts Sum: 28, Total Sum: 420 (6.67%), Ratio(%) per element: [13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 18:46:36,906 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1846_stage3_step200.svg
[rank3]:2026-01-01 18:46:36,953 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1846_stage7_step200.svg
[rank3]:2026-01-01 18:46:37,092 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank3_stage3.svg
[rank3]:	> Counts Sum: 140, Total Sum: 420 (33.33%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33]
[rank3]:2026-01-01 18:46:37,187 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1846_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 210 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 18:47:21,501 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.5118e+00
[rank2]:2026-01-01 18:47:21,501 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.4434e+44
[rank1]:2026-01-01 18:47:21,502 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.0000e+00
[rank0]:2026-01-01 18:47:21,502 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.1870e+00
[rank3]:2026-01-01 18:48:10,968 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.3568e+44
[rank1]:2026-01-01 18:48:10,969 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2026-01-01 18:48:10,969 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5971e+00
[rank0]:2026-01-01 18:48:10,970 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.50, Threshold: 1.8742e+00
[rank0]:2026-01-01 18:49:00,173 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.0000e+00
[rank3]:2026-01-01 18:49:00,172 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0630e+01
[rank1]:2026-01-01 18:49:00,174 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8082e+01
[rank2]:2026-01-01 18:49:00,173 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.0420e+01
[rank0]:2026-01-01 18:49:49,758 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 9.0867e+40
[rank1]:2026-01-01 18:49:49,757 - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 9.3163e-01
[rank3]:2026-01-01 18:49:49,756 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.2963e+00
[rank2]:2026-01-01 18:49:49,757 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.2804e+00
[rank0]:2026-01-01 18:50:39,115 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 18:50:39,119 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.6287e+00
[rank1]:2026-01-01 18:50:39,113 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.8530e+00
[rank3]:2026-01-01 18:50:39,100 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.7048e+00
[rank2]:2026-01-01 18:50:39,101 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.0000e+00
[rank3]:2026-01-01 18:50:43,953 - Avg. fwd time: 17.1787 / Avg. bwd-weight time: 1.3099 / Avg. bwd-input time: 26.5069 / Avg. batch time: 1068.4142 (ms) / GPU bubble ratio: 32.62%
[rank2]:2026-01-01 18:50:44,003 - Avg. fwd time: 13.3299 / Avg. bwd-weight time: 1.8573 / Avg. bwd-input time: 15.0451 / Avg. batch time: 1134.8629 (ms) / GPU bubble ratio: 57.38%
[rank1]:2026-01-01 18:50:44,039 - Avg. fwd time: 16.6909 / Avg. bwd-weight time: 2.0971 / Avg. bwd-input time: 18.9360 / Avg. batch time: 1190.8212 (ms) / GPU bubble ratio: 49.31%
[rank1]:2026-01-01 18:50:44,045 -  step: 250  loss: -4.0000  grad_norm:  7.2120  memory: 19.62GiB(41.30%)  tps: 6,617  tflops: 51.73  mfu: 16.58%
[rank3]:2026-01-01 18:50:44,046 -  step: 250  loss: 12.5261  grad_norm:  7.2120  memory: 30.44GiB(64.07%)  tps: 6,617  tflops: 51.73  mfu: 16.58%
[rank2]:2026-01-01 18:50:44,045 -  step: 250  loss: -4.0000  grad_norm:  7.2120  memory: 14.29GiB(30.09%)  tps: 6,617  tflops: 51.73  mfu: 16.58%
[rank0]:2026-01-01 18:50:44,042 - Avg. fwd time: 13.8215 / Avg. full-bwd time: 8.4263 (Avg. bwd-weight time: 1.2377 / Avg. bwd-input time: 15.0428) / Avg. batch time: 1216.0113 (ms) / GPU bubble ratio: 65.56%
[rank0]:2026-01-01 18:50:44,046 -  step: 250  loss: -4.0000  grad_norm:  7.2120  memory: 13.98GiB(29.42%)  tps: 6,617  tflops: 51.73  mfu: 16.58%
[rank3]:2026-01-01 18:51:28,525 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.3510e+44
[rank1]:2026-01-01 18:51:28,526 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.6008e+00
[rank2]:2026-01-01 18:51:28,526 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.2912e+44
[rank0]:2026-01-01 18:51:28,527 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 2.6362e+00
[rank3]:2026-01-01 18:52:17,765 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.7108e+00
[rank1]:2026-01-01 18:52:17,767 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8322e+00
[rank2]:2026-01-01 18:52:17,766 - Freezing Ratio: [Stage2] 0.50, [Stage6] 0.00, Threshold: 4.6353e+00
[rank0]:2026-01-01 18:52:17,767 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 4.0837e+00
[rank0]:2026-01-01 18:53:07,008 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 2.2561e+01
[rank3]:2026-01-01 18:53:07,007 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.3713e+01
[rank1]:2026-01-01 18:53:07,009 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.1819e+01
[rank2]:2026-01-01 18:53:07,007 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.9463e+01
[rank1]:2026-01-01 18:53:56,220 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.4898e+00
[rank3]:2026-01-01 18:53:56,218 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2497e+00
[rank2]:2026-01-01 18:53:56,218 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.3325e+00
[rank0]:2026-01-01 18:53:56,220 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 3.3516e+00
[rank1]:2026-01-01 18:54:45,668 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.2669e+38
[rank3]:2026-01-01 18:54:45,667 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.6803e+00
[rank2]:2026-01-01 18:54:45,667 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.2481e+00
[rank0]:2026-01-01 18:54:45,667 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 18:54:45,670 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 3.1291e+00
[rank3]:2026-01-01 18:54:50,476 - Avg. fwd time: 17.1931 / Avg. bwd-weight time: 1.3466 / Avg. bwd-input time: 26.5182 / Avg. batch time: 1068.8997 (ms) / GPU bubble ratio: 32.55%
[rank3]:2026-01-01 18:54:50,572 -  step: 300  loss: 12.9460  grad_norm:  2.6062  memory: 30.44GiB(64.07%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank1]:2026-01-01 18:54:50,567 - Avg. fwd time: 16.6945 / Avg. bwd-weight time: 2.1223 / Avg. bwd-input time: 18.9381 / Avg. batch time: 1191.0081 (ms) / GPU bubble ratio: 49.28%
[rank1]:2026-01-01 18:54:50,571 -  step: 300  loss: -4.0000  grad_norm:  2.6062  memory: 19.62GiB(41.30%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank2]:2026-01-01 18:54:50,527 - Avg. fwd time: 13.3308 / Avg. bwd-weight time: 1.8359 / Avg. bwd-input time: 15.0433 / Avg. batch time: 1134.8859 (ms) / GPU bubble ratio: 57.41%
[rank2]:2026-01-01 18:54:50,571 -  step: 300  loss: -4.0000  grad_norm:  2.6062  memory: 14.29GiB(30.09%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank0]:2026-01-01 18:54:50,564 - Avg. fwd time: 13.8472 / Avg. full-bwd time: 7.6846 (Avg. bwd-weight time: 1.2547 / Avg. bwd-input time: 15.0445) / Avg. batch time: 1215.4736 (ms) / GPU bubble ratio: 65.99%
[rank0]:2026-01-01 18:54:50,571 -  step: 300  loss: -4.0000  grad_norm:  2.6062  memory: 13.98GiB(29.42%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank0]:2026-01-01 18:54:50,623 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1854_stage0_step300.svg
[rank1]:2026-01-01 18:54:50,622 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1854_stage1_step300.svg
[rank1]:2026-01-01 18:54:50,663 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1854_stage5_step300.svg
[rank2]:2026-01-01 18:54:50,622 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1854_stage2_step300.svg
[rank2]:2026-01-01 18:54:50,663 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1854_stage6_step300.svg
[rank0]:2026-01-01 18:54:50,664 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1854_stage4_step300.svg
[rank1]:2026-01-01 18:54:50,803 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank1_stage1.svg
[rank1]:	> Counts Sum: 504, Total Sum: 1050 (48.00%), Ratio(%) per element: [52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0]
[rank2]:2026-01-01 18:54:50,791 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank2_stage2.svg
[rank2]:	> Counts Sum: 182, Total Sum: 700 (26.00%), Ratio(%) per element: [32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]
[rank0]:2026-01-01 18:54:50,804 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank0_stage0.svg
[rank0]:	> Counts Sum: 406, Total Sum: 700 (58.00%), Ratio(%) per element: [96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]
[rank3]:2026-01-01 18:54:50,909 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1854_step300_rank3.svg
[rank3]:			> Batch Time: 1214.26 ms, GPU Bubble Ratio: 66.47%, 49.16%, 59.92%, 40.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S4,MB0,BI] 388-14-402ms   | [S4,MB0,BW] 402-1-403ms    | [S0,MB4,F]  403-12-416ms   | [S4,MB1,BI] 458-15-474ms   | [S4,MB1,BW] 474-1-475ms    | [S0,MB5,F]  475-12-488ms   | [S4,MB2,BI] 536-15-551ms   | [S4,MB2,BW] 551-1-552ms    | [S0,MB6,F]  552-13-565ms   | [S4,MB3,BI] 605-17-622ms   | [S4,MB3,BW] 622-1-623ms    | [S0,MB7,F]  623-16-639ms   | [S0,MB0,B]  660-7-667ms    | [S4,MB4,F]  665-14-679ms   | [S0,MB1,B]  710-7-718ms    | [S4,MB5,F]  716-13-730ms   | [S0,MB2,B]  754-7-761ms    | [S4,MB6,F]  761-12-774ms   | [S0,MB3,B]  798-7-805ms    | [S4,MB7,F]  805-13-818ms   | [S4,MB4,BI] 858-15-873ms   | [S4,MB4,BW] 873-1-874ms    | [S4,MB5,BI] 943-14-957ms   | [S4,MB5,BW] 957-1-958ms    | [S4,MB6,BI] 1007-14-1021ms | [S4,MB6,BW] 1021-1-1022ms  | [S4,MB7,BI] 1084-14-1098ms | [S4,MB7,BW] 1098-2-1100ms  | [S0,MB4,B]  1113-6-1119ms  | [S0,MB5,B]  1150-6-1156ms  | [S0,MB6,B]  1179-6-1185ms  | [S0,MB7,B]  1208-6-1214ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 365-14-380ms   | [S5,MB3,F]  379-15-395ms   | [S5,MB1,BI] 435-14-450ms   | [S5,MB0,BW] 450-3-453ms    | [S1,MB4,F]  459-19-479ms   | [S5,MB2,BI] 506-15-521ms   | [S5,MB1,BW] 521-1-523ms    | [S1,MB5,F]  536-19-556ms   | [S5,MB3,BI] 579-16-596ms   | [S5,MB2,BW] 596-2-599ms    | [S1,MB6,F]  607-20-628ms   | [S1,MB0,BI] 628-24-652ms   | [S5,MB3,BW] 652-2-655ms    | [S1,MB7,F]  659-20-680ms   | [S1,MB1,BI] 680-23-703ms   | [S1,MB0,BW] 703-3-707ms    | [S5,MB4,F]  710-14-724ms   | [S1,MB2,BI] 724-23-748ms   | [S1,MB1,BW] 747-3-751ms    | [S5,MB5,F]  755-13-769ms   | [S1,MB3,BI] 768-23-792ms   | [S1,MB2,BW] 791-3-795ms    | [S5,MB6,F]  799-13-813ms   | [S5,MB4,BI] 835-15-851ms   | [S1,MB3,BW] 851-3-855ms    | [S5,MB7,F]  858-13-872ms   | [S5,MB5,BI] 909-15-924ms   | [S5,MB4,BW] 924-1-926ms    | [S5,MB6,BI] 985-14-1000ms  | [S5,MB5,BW] 999-2-1002ms   | [S5,MB7,BI] 1063-14-1077ms | [S5,MB6,BW] 1077-2-1080ms  | [S1,MB4,BI] 1084-21-1106ms | [S5,MB7,BW] 1106-2-1109ms  | [S1,MB5,BI] 1120-21-1142ms | [S1,MB4,BW] 1142-3-1146ms  | [S1,MB6,BI] 1149-22-1171ms | [S1,MB5,BW] 1171-3-1175ms  | [S1,MB7,BI] 1178-22-1200ms | [S1,MB6,BW] 1200-3-1204ms  | [S1,MB7,BW] 1204-1-1205ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB0,BI] 343-14-358ms   | [S6,MB2,F]  358-14-373ms   | [S6,MB1,BI] 413-15-428ms   | [S6,MB3,F]  429-14-443ms   | [S6,MB2,BI] 485-14-500ms   | [S6,MB0,BW] 499-2-502ms    | [S2,MB4,F]  507-13-520ms   | [S6,MB3,BI] 557-15-573ms   | [S6,MB1,BW] 572-2-575ms    | [S2,MB5,F]  583-13-596ms   | [S2,MB0,BI] 600-16-616ms   | [S6,MB2,BW] 617-2-619ms    | [S2,MB6,F]  631-13-645ms   | [S2,MB1,BI] 645-15-660ms   | [S6,MB3,BW] 660-1-662ms    | [S2,MB7,F]  681-13-695ms   | [S2,MB2,BI] 695-15-710ms   | [S2,MB0,BW] 710-1-712ms    | [S6,MB4,F]  725-13-739ms   | [S2,MB3,BI] 739-15-754ms   | [S2,MB1,BW] 754-1-756ms    | [S6,MB5,F]  769-13-783ms   | [S6,MB4,BI] 814-15-829ms   | [S2,MB2,BW] 829-2-831ms    | [S6,MB6,F]  836-13-850ms   | [S6,MB5,BI] 887-15-903ms   | [S2,MB3,BW] 902-2-905ms    | [S6,MB7,F]  910-13-923ms   | [S6,MB6,BI] 963-15-979ms   | [S6,MB4,BW] 979-2-981ms    | [S6,MB7,BI] 1041-14-1056ms | [S6,MB5,BW] 1056-2-1059ms  | [S2,MB4,BI] 1063-14-1078ms | [S6,MB6,BW] 1077-2-1080ms  | [S2,MB5,BI] 1099-14-1114ms | [S6,MB7,BW] 1114-2-1117ms  | [S2,MB6,BI] 1120-14-1135ms | [S2,MB4,BW] 1135-1-1137ms  | [S2,MB7,BI] 1149-14-1164ms | [S2,MB5,BW] 1163-1-1164ms  | [S2,MB6,BW] 1164-1-1165ms  | [S2,MB7,BW] 1166-1-1167ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-289ms   | [S7,MB0,BI] 301-35-337ms   | [S7,MB1,F]  337-21-358ms   | [S7,MB1,BI] 371-36-407ms   | [S7,MB2,F]  407-23-430ms   | [S7,MB2,BI] 442-36-478ms   | [S7,MB3,F]  478-23-501ms   | [S7,MB3,BI] 514-36-551ms   | [S7,MB0,BW] 550-1-552ms    | [S3,MB4,F]  558-15-573ms   | [S3,MB0,BI] 572-18-591ms   | [S7,MB1,BW] 591-2-593ms    | [S3,MB5,F]  603-13-616ms   | [S3,MB1,BI] 616-17-634ms   | [S7,MB2,BW] 634-1-635ms    | [S3,MB6,F]  646-13-660ms   | [S3,MB2,BI] 660-16-676ms   | [S7,MB3,BW] 676-0-677ms    | [S3,MB7,F]  696-13-709ms   | [S3,MB3,BI] 709-16-725ms   | [S3,MB0,BW] 726-1-727ms    | [S7,MB4,F]  740-18-759ms   | [S7,MB4,BI] 771-35-807ms   | [S3,MB1,BW] 807-2-810ms    | [S7,MB5,F]  815-19-834ms   | [S7,MB5,BI] 846-35-881ms   | [S3,MB2,BW] 881-2-883ms    | [S7,MB6,F]  888-20-908ms   | [S7,MB6,BI] 921-35-957ms   | [S3,MB3,BW] 957-2-959ms    | [S7,MB7,F]  965-22-987ms   | [S7,MB7,BI] 999-36-1035ms  | [S7,MB4,BW] 1035-1-1036ms  | [S3,MB4,BI] 1036-17-1053ms | [S7,MB5,BW] 1053-0-1054ms  | [S3,MB5,BI] 1054-17-1071ms | [S7,MB6,BW] 1071-0-1072ms  | [S3,MB6,BI] 1072-16-1088ms | [S7,MB7,BW] 1088-0-1089ms  | [S3,MB7,BI] 1092-16-1109ms | [S3,MB4,BW] 1109-1-1110ms  | [S3,MB5,BW] 1110-1-1111ms  | [S3,MB6,BW] 1111-1-1112ms  | [S3,MB7,BW] 1112-1-1114ms 
[rank2]:2026-01-01 18:54:50,917 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank2_stage6.svg
[rank2]:	> Counts Sum: 14, Total Sum: 700 (2.00%), Ratio(%) per element: [4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 18:54:50,931 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank0_stage4.svg
[rank0]:	> Counts Sum: 28, Total Sum: 700 (4.00%), Ratio(%) per element: [8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 18:54:50,953 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1854_stage3_step300.svg
[rank3]:2026-01-01 18:54:50,995 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1854_stage7_step300.svg
[rank1]:2026-01-01 18:54:50,928 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank1_stage5.svg
[rank1]:	> Counts Sum: 28, Total Sum: 700 (4.00%), Ratio(%) per element: [8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 18:54:51,128 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank3_stage3.svg
[rank3]:	> Counts Sum: 196, Total Sum: 700 (28.00%), Ratio(%) per element: [28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0]
[rank3]:2026-01-01 18:54:51,218 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1854_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 350 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 18:55:35,309 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 1.9171e+01
[rank3]:2026-01-01 18:55:35,308 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6089e+01
[rank1]:2026-01-01 18:55:35,310 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.7484e+01
[rank2]:2026-01-01 18:55:35,309 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.4287e+01
[rank1]:2026-01-01 18:56:24,427 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 8.1126e+00
[rank3]:2026-01-01 18:56:24,426 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.6634e+00
[rank2]:2026-01-01 18:56:24,426 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.5115e+00
[rank0]:2026-01-01 18:56:24,426 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 6.9129e+00
[rank2]:2026-01-01 18:57:13,698 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.6454e+00
[rank0]:2026-01-01 18:57:13,699 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 3.8800e+00
[rank1]:2026-01-01 18:57:13,699 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.6574e+00
[rank3]:2026-01-01 18:57:13,697 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.5406e+00
[rank1]:2026-01-01 18:58:02,753 - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 7.0930e+44
[rank3]:2026-01-01 18:58:02,751 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1251e+00
[rank2]:2026-01-01 18:58:02,751 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0854e+00
[rank0]:2026-01-01 18:58:02,752 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 2.6819e+00
[rank1]:2026-01-01 18:58:51,894 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.0881e+00
[rank3]:2026-01-01 18:58:51,883 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6389e+00
[rank2]:2026-01-01 18:58:51,882 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.0000e+00
[rank0]:2026-01-01 18:58:51,896 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 18:58:51,901 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 8.8009e+39
[rank3]:2026-01-01 18:58:56,763 - Avg. fwd time: 17.1878 / Avg. bwd-weight time: 1.2387 / Avg. bwd-input time: 26.5083 / Avg. batch time: 1068.0379 (ms) / GPU bubble ratio: 32.68%
[rank2]:2026-01-01 18:58:56,815 - Avg. fwd time: 13.3261 / Avg. bwd-weight time: 1.7144 / Avg. bwd-input time: 15.0325 / Avg. batch time: 1134.3499 (ms) / GPU bubble ratio: 57.58%
[rank0]:2026-01-01 18:58:56,857 - Avg. fwd time: 13.8753 / Avg. full-bwd time: 6.9985 (Avg. bwd-weight time: 1.2677 / Avg. bwd-input time: 15.0441) / Avg. batch time: 1214.6753 (ms) / GPU bubble ratio: 66.37%
[rank0]:2026-01-01 18:58:56,861 -  step: 350  loss: -4.0000  grad_norm:  4.0780  memory: 13.98GiB(29.42%)  tps: 6,652  tflops: 52.00  mfu: 16.67%
[rank1]:2026-01-01 18:58:56,854 - Avg. fwd time: 16.6989 / Avg. bwd-weight time: 2.1418 / Avg. bwd-input time: 18.9394 / Avg. batch time: 1190.8715 (ms) / GPU bubble ratio: 49.24%
[rank1]:2026-01-01 18:58:56,860 -  step: 350  loss: -4.0000  grad_norm:  4.0780  memory: 19.62GiB(41.30%)  tps: 6,652  tflops: 52.01  mfu: 16.67%
[rank3]:2026-01-01 18:58:56,861 -  step: 350  loss: 11.1892  grad_norm:  4.0780  memory: 30.44GiB(64.07%)  tps: 6,652  tflops: 52.01  mfu: 16.67%
[rank2]:2026-01-01 18:58:56,860 -  step: 350  loss: -4.0000  grad_norm:  4.0780  memory: 14.29GiB(30.09%)  tps: 6,652  tflops: 52.00  mfu: 16.67%
[rank1]:2026-01-01 18:59:41,279 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 4.4414e+00
[rank3]:2026-01-01 18:59:41,278 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.8747e+00
[rank2]:2026-01-01 18:59:41,279 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.5802e+43
[rank0]:2026-01-01 18:59:41,280 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.5521e+01
[rank1]:2026-01-01 19:00:30,543 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.4330e+00
[rank3]:2026-01-01 19:00:30,542 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5858e+00
[rank2]:2026-01-01 19:00:30,543 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.3146e+00
[rank0]:2026-01-01 19:00:30,544 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.4723e+00
[rank0]:2026-01-01 19:01:19,849 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.4569e+00
[rank1]:2026-01-01 19:01:19,849 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.5038e+00
[rank3]:2026-01-01 19:01:19,848 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.5942e+00
[rank2]:2026-01-01 19:01:19,848 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2867e+00
[rank1]:2026-01-01 19:02:08,956 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3410e+00
[rank3]:2026-01-01 19:02:08,954 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7656e+00
[rank2]:2026-01-01 19:02:08,955 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.3889e+00
[rank0]:2026-01-01 19:02:08,956 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.9774e+00
[rank3]:2026-01-01 19:02:58,362 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.8530e+00
[rank2]:2026-01-01 19:02:58,362 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.9531e+00
[rank0]:2026-01-01 19:02:58,362 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 19:02:58,366 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.5919e+01
[rank1]:2026-01-01 19:02:58,363 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 5.3761e+00
[rank3]:2026-01-01 19:03:03,273 - Avg. fwd time: 17.1834 / Avg. bwd-weight time: 1.1573 / Avg. bwd-input time: 26.4987 / Avg. batch time: 1067.4341 (ms) / GPU bubble ratio: 32.79%
[rank3]:2026-01-01 19:03:03,369 -  step: 400  loss: 10.2841  grad_norm:  5.8768  memory: 30.44GiB(64.07%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank2]:2026-01-01 19:03:03,326 - Avg. fwd time: 13.3222 / Avg. bwd-weight time: 1.6546 / Avg. bwd-input time: 15.0252 / Avg. batch time: 1133.8448 (ms) / GPU bubble ratio: 57.66%
[rank2]:2026-01-01 19:03:03,368 -  step: 400  loss: -4.0000  grad_norm:  5.8768  memory: 14.29GiB(30.09%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank0]:2026-01-01 19:03:03,365 - Avg. fwd time: 13.8696 / Avg. full-bwd time: 6.9809 (Avg. bwd-weight time: 1.2779 / Avg. bwd-input time: 15.0437) / Avg. batch time: 1214.4124 (ms) / GPU bubble ratio: 66.38%
[rank0]:2026-01-01 19:03:03,369 -  step: 400  loss: -4.0000  grad_norm:  5.8768  memory: 13.98GiB(29.42%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank1]:2026-01-01 19:03:03,358 - Avg. fwd time: 16.6974 / Avg. bwd-weight time: 2.1523 / Avg. bwd-input time: 18.9381 / Avg. batch time: 1190.6349 (ms) / GPU bubble ratio: 49.22%
[rank1]:2026-01-01 19:03:03,368 -  step: 400  loss: -4.0000  grad_norm:  5.8768  memory: 19.62GiB(41.30%)  tps: 6,646  tflops: 51.96  mfu: 16.65%
[rank1]:2026-01-01 19:03:03,424 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1903_stage1_step400.svg
[rank2]:2026-01-01 19:03:03,432 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1903_stage2_step400.svg
[rank0]:2026-01-01 19:03:03,425 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1903_stage0_step400.svg
[rank0]:2026-01-01 19:03:03,470 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1903_stage4_step400.svg
[rank1]:2026-01-01 19:03:03,469 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1903_stage5_step400.svg
[rank2]:2026-01-01 19:03:03,481 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1903_stage6_step400.svg
[rank0]:2026-01-01 19:03:03,597 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank0_stage0.svg
[rank0]:	> Counts Sum: 574, Total Sum: 980 (58.57%), Ratio(%) per element: [97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]
[rank1]:2026-01-01 19:03:03,606 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank1_stage1.svg
[rank1]:	> Counts Sum: 700, Total Sum: 1470 (47.62%), Ratio(%) per element: [51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85]
[rank2]:2026-01-01 19:03:03,613 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank2_stage2.svg
[rank2]:	> Counts Sum: 462, Total Sum: 980 (47.14%), Ratio(%) per element: [51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 51.42, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85]
[rank1]:2026-01-01 19:03:03,732 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank1_stage5.svg
[rank1]:	> Counts Sum: 28, Total Sum: 980 (2.86%), Ratio(%) per element: [5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 19:03:03,713 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1903_step400_rank3.svg
[rank3]:			> Batch Time: 1215.29 ms, GPU Bubble Ratio: 66.48%, 49.14%, 61.14%, 41.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  186-14-201ms   | [S4,MB3,F]  244-14-259ms   | [S4,MB0,BI] 388-14-402ms   | [S4,MB0,BW] 402-1-403ms    | [S0,MB4,F]  403-12-416ms   | [S4,MB1,BI] 457-15-472ms   | [S4,MB1,BW] 473-1-474ms    | [S0,MB5,F]  474-12-487ms   | [S4,MB2,BI] 535-15-550ms   | [S4,MB2,BW] 551-1-552ms    | [S0,MB6,F]  552-13-565ms   | [S4,MB3,BI] 604-17-621ms   | [S4,MB3,BW] 621-1-622ms    | [S0,MB7,F]  622-15-637ms   | [S0,MB0,B]  658-7-666ms    | [S4,MB4,F]  666-14-680ms   | [S0,MB1,B]  710-7-718ms    | [S4,MB5,F]  718-13-731ms   | [S0,MB2,B]  755-7-762ms    | [S4,MB6,F]  762-12-775ms   | [S0,MB3,B]  800-7-807ms    | [S4,MB7,F]  807-13-820ms   | [S4,MB4,BI] 858-15-873ms   | [S4,MB4,BW] 873-1-874ms    | [S4,MB5,BI] 944-14-958ms   | [S4,MB5,BW] 958-1-959ms    | [S4,MB6,BI] 1008-14-1022ms | [S4,MB6,BW] 1022-1-1023ms  | [S4,MB7,BI] 1086-14-1100ms | [S4,MB7,BW] 1100-2-1102ms  | [S0,MB4,B]  1115-6-1121ms  | [S0,MB5,B]  1151-6-1157ms  | [S0,MB6,B]  1180-6-1186ms  | [S0,MB7,B]  1209-6-1215ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  186-19-206ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  263-12-276ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 364-14-379ms   | [S5,MB3,F]  379-15-395ms   | [S5,MB1,BI] 434-14-448ms   | [S5,MB0,BW] 448-3-452ms    | [S1,MB4,F]  458-19-478ms   | [S5,MB2,BI] 505-15-521ms   | [S5,MB1,BW] 521-1-522ms    | [S1,MB5,F]  535-19-555ms   | [S5,MB3,BI] 578-16-595ms   | [S5,MB2,BW] 595-3-598ms    | [S1,MB6,F]  606-20-627ms   | [S1,MB0,BI] 627-24-651ms   | [S5,MB3,BW] 651-2-654ms    | [S1,MB7,F]  659-20-680ms   | [S1,MB1,BI] 680-23-703ms   | [S1,MB0,BW] 703-3-707ms    | [S5,MB4,F]  710-14-725ms   | [S1,MB2,BI] 724-23-748ms   | [S1,MB1,BW] 748-3-752ms    | [S5,MB5,F]  755-13-769ms   | [S1,MB3,BI] 769-23-793ms   | [S1,MB2,BW] 792-3-796ms    | [S5,MB6,F]  800-13-814ms   | [S5,MB4,BI] 835-15-851ms   | [S1,MB3,BW] 851-3-855ms    | [S5,MB7,F]  858-13-872ms   | [S5,MB5,BI] 909-15-925ms   | [S5,MB4,BW] 925-1-926ms    | [S5,MB6,BI] 986-14-1000ms  | [S5,MB5,BW] 1000-2-1003ms  | [S5,MB7,BI] 1064-14-1079ms | [S5,MB6,BW] 1079-2-1082ms  | [S1,MB4,BI] 1085-21-1107ms | [S5,MB7,BW] 1107-2-1110ms  | [S1,MB5,BI] 1122-21-1144ms | [S1,MB4,BW] 1144-3-1148ms  | [S1,MB6,BI] 1151-22-1173ms | [S1,MB5,BW] 1173-3-1177ms  | [S1,MB7,BI] 1180-22-1202ms | [S1,MB6,BW] 1202-3-1206ms  | [S1,MB7,BW] 1205-1-1206ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-160ms   | [S2,MB3,F]  206-12-218ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  277-12-289ms   | [S6,MB0,BI] 343-14-358ms   | [S6,MB2,F]  358-14-372ms   | [S6,MB1,BI] 412-15-427ms   | [S6,MB3,F]  427-14-442ms   | [S6,MB2,BI] 484-14-499ms   | [S6,MB0,BW] 499-2-501ms    | [S2,MB4,F]  507-13-520ms   | [S6,MB3,BI] 556-15-571ms   | [S6,MB1,BW] 571-2-574ms    | [S2,MB5,F]  581-13-595ms   | [S2,MB0,BI] 599-16-615ms   | [S6,MB2,BW] 615-2-617ms    | [S2,MB6,F]  630-13-644ms   | [S2,MB1,BI] 644-15-659ms   | [S6,MB3,BW] 659-1-661ms    | [S2,MB7,F]  681-13-694ms   | [S2,MB2,BI] 694-15-710ms   | [S2,MB0,BW] 710-0-710ms    | [S6,MB4,F]  726-13-739ms   | [S2,MB3,BI] 739-15-755ms   | [S2,MB1,BW] 755-0-755ms    | [S6,MB5,F]  770-13-784ms   | [S6,MB4,BI] 813-15-829ms   | [S2,MB2,BW] 829-0-829ms    | [S6,MB6,F]  836-13-850ms   | [S6,MB5,BI] 888-15-903ms   | [S2,MB3,BW] 903-0-903ms    | [S6,MB7,F]  910-13-923ms   | [S6,MB6,BI] 964-15-980ms   | [S6,MB4,BW] 979-2-982ms    | [S6,MB7,BI] 1043-14-1057ms | [S6,MB5,BW] 1057-2-1060ms  | [S2,MB4,BI] 1064-14-1079ms | [S6,MB6,BW] 1078-2-1081ms  | [S2,MB5,BI] 1101-14-1116ms | [S6,MB7,BW] 1115-2-1118ms  | [S2,MB6,BI] 1121-14-1136ms | [S2,MB4,BW] 1136-0-1136ms  | [S2,MB7,BI] 1150-14-1165ms | [S2,MB5,BW] 1165-0-1165ms  | [S2,MB6,BW] 1165-0-1165ms  | [S2,MB7,BW] 1165-0-1165ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-173ms   | [S3,MB3,F]  218-12-231ms   | [S7,MB0,F]  270-18-289ms   | [S7,MB0,BI] 301-35-336ms   | [S7,MB1,F]  336-21-358ms   | [S7,MB1,BI] 370-36-406ms   | [S7,MB2,F]  405-23-428ms   | [S7,MB2,BI] 441-36-477ms   | [S7,MB3,F]  478-23-501ms   | [S7,MB3,BI] 513-36-550ms   | [S7,MB0,BW] 549-1-551ms    | [S3,MB4,F]  557-14-572ms   | [S3,MB0,BI] 572-18-590ms   | [S7,MB1,BW] 590-2-592ms    | [S3,MB5,F]  602-13-615ms   | [S3,MB1,BI] 615-17-633ms   | [S7,MB2,BW] 633-1-634ms    | [S3,MB6,F]  645-13-658ms   | [S3,MB2,BI] 659-15-674ms   | [S7,MB3,BW] 675-0-675ms    | [S3,MB7,F]  696-13-709ms   | [S3,MB3,BI] 709-15-724ms   | [S3,MB0,BW] 725-0-725ms    | [S7,MB4,F]  741-18-759ms   | [S7,MB4,BI] 772-35-807ms   | [S3,MB1,BW] 807-0-807ms    | [S7,MB5,F]  815-19-834ms   | [S7,MB5,BI] 846-35-882ms   | [S3,MB2,BW] 882-0-882ms    | [S7,MB6,F]  889-20-909ms   | [S7,MB6,BI] 922-36-958ms   | [S3,MB3,BW] 958-0-958ms    | [S7,MB7,F]  966-22-988ms   | [S7,MB7,BI] 1000-36-1036ms | [S7,MB4,BW] 1036-1-1037ms  | [S3,MB4,BI] 1037-17-1055ms | [S7,MB5,BW] 1055-0-1055ms  | [S3,MB5,BI] 1056-17-1073ms | [S7,MB6,BW] 1073-0-1074ms  | [S3,MB6,BI] 1074-16-1090ms | [S7,MB7,BW] 1090-0-1091ms  | [S3,MB7,BI] 1093-16-1110ms | [S3,MB4,BW] 1110-0-1110ms  | [S3,MB5,BW] 1110-0-1110ms  | [S3,MB6,BW] 1110-0-1110ms  | [S3,MB7,BW] 1110-0-1110ms 
[rank3]:2026-01-01 19:03:03,762 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1903_stage3_step400.svg
[rank2]:2026-01-01 19:03:03,743 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank2_stage6.svg
[rank2]:	> Counts Sum: 28, Total Sum: 980 (2.86%), Ratio(%) per element: [5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 19:03:03,724 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank0_stage4.svg
[rank0]:	> Counts Sum: 28, Total Sum: 980 (2.86%), Ratio(%) per element: [5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 5.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 19:03:03,807 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1903_stage7_step400.svg
[rank3]:2026-01-01 19:03:03,934 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank3_stage3.svg
[rank3]:	> Counts Sum: 476, Total Sum: 980 (48.57%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57]
[rank3]:2026-01-01 19:03:04,022 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1903_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 490 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 19:03:31,940 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 19:03:32,079 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 19:03:32,111 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 19:03:32,105 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 19:03:48,192 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3337e+00
[rank3]:2026-01-01 19:03:48,191 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.4883e+00
[rank2]:2026-01-01 19:03:48,192 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.2674e+00
[rank0]:2026-01-01 19:03:48,193 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.5822e+00
[rank0]:2026-01-01 19:04:37,326 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.9171e+00
[rank1]:2026-01-01 19:04:37,326 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.0247e+00
[rank3]:2026-01-01 19:04:37,324 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.2348e+00
[rank2]:2026-01-01 19:04:37,325 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.9799e+00
[rank1]:2026-01-01 19:05:26,327 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.3896e+00
[rank2]:2026-01-01 19:05:26,326 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.3827e+00
[rank3]:2026-01-01 19:05:26,325 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.0052e+00
[rank0]:2026-01-01 19:05:26,327 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 6.3555e+00
[rank2]:2026-01-01 19:06:15,319 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.3982e+01
[rank3]:2026-01-01 19:06:15,318 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3678e+01
[rank0]:2026-01-01 19:06:15,319 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 2.5583e+01
[rank1]:2026-01-01 19:06:15,320 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.5534e+01
[rank0]:2026-01-01 19:07:04,221 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 19:07:04,226 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 3.6999e+00
[rank1]:2026-01-01 19:07:04,226 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.1282e+00
[rank3]:2026-01-01 19:07:04,206 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.8859e+00
[rank2]:2026-01-01 19:07:04,206 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.8973e+00
[rank3]:2026-01-01 19:07:09,030 - Avg. fwd time: 17.1726 / Avg. bwd-weight time: 1.0941 / Avg. bwd-input time: 26.4858 / Avg. batch time: 1066.6944 (ms) / GPU bubble ratio: 32.87%
[rank2]:2026-01-01 19:07:09,082 - Avg. fwd time: 13.3181 / Avg. bwd-weight time: 1.6078 / Avg. bwd-input time: 15.0190 / Avg. batch time: 1133.3012 (ms) / GPU bubble ratio: 57.72%
[rank0]:2026-01-01 19:07:09,123 - Avg. fwd time: 13.8802 / Avg. full-bwd time: 6.6620 (Avg. bwd-weight time: 1.2859 / Avg. bwd-input time: 15.0428) / Avg. batch time: 1213.7376 (ms) / GPU bubble ratio: 66.55%
[rank0]:2026-01-01 19:07:09,127 -  step: 450  loss: -4.0000  grad_norm:  6.2897  memory: 13.98GiB(29.42%)  tps: 6,667  tflops: 52.12  mfu: 16.70%
[rank1]:2026-01-01 19:07:09,121 - Avg. fwd time: 16.6936 / Avg. bwd-weight time: 2.1311 / Avg. bwd-input time: 18.9323 / Avg. batch time: 1190.1809 (ms) / GPU bubble ratio: 49.24%
[rank1]:2026-01-01 19:07:09,127 -  step: 450  loss: -4.0000  grad_norm:  6.2897  memory: 19.62GiB(41.30%)  tps: 6,667  tflops: 52.12  mfu: 16.70%
[rank3]:2026-01-01 19:07:09,127 -  step: 450  loss: 12.7481  grad_norm:  6.2897  memory: 30.44GiB(64.07%)  tps: 6,667  tflops: 52.12  mfu: 16.70%
[rank2]:2026-01-01 19:07:09,127 -  step: 450  loss: -4.0000  grad_norm:  6.2897  memory: 14.29GiB(30.09%)  tps: 6,667  tflops: 52.12  mfu: 16.70%
[rank0]:2026-01-01 19:07:53,476 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 2.9230e+00
[rank1]:2026-01-01 19:07:53,476 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3179e+38
[rank2]:2026-01-01 19:07:53,475 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.3978e+00
[rank3]:2026-01-01 19:07:53,474 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.6976e+00
[rank2]:2026-01-01 19:08:42,378 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7360e+01
[rank3]:2026-01-01 19:08:42,379 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9830e+01
[rank0]:2026-01-01 19:08:42,378 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 2.2040e+01
[rank1]:2026-01-01 19:08:42,379 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.2071e+01
[rank3]:2026-01-01 19:09:31,366 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.8901e+00
[rank2]:2026-01-01 19:09:31,367 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.4542e+00
[rank0]:2026-01-01 19:09:31,367 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 6.0572e+00
[rank1]:2026-01-01 19:09:31,368 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 7.2306e+00
[rank0]:2026-01-01 19:10:20,566 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.00, Threshold: 3.5772e+00
[rank1]:2026-01-01 19:10:20,566 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.1039e+00
[rank3]:2026-01-01 19:10:20,565 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.1336e+00
[rank2]:2026-01-01 19:10:20,565 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.2167e+00
[rank3]:2026-01-01 19:11:09,477 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9647e+00
[rank2]:2026-01-01 19:11:09,478 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3594e+00
[rank0]:2026-01-01 19:11:09,476 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 19:11:09,479 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 9.7738e-01
[rank1]:2026-01-01 19:11:09,480 - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 4.0795e+44
[rank3]:2026-01-01 19:11:14,276 - Avg. fwd time: 17.1617 / Avg. bwd-weight time: 1.0428 / Avg. bwd-input time: 26.4718 / Avg. batch time: 1066.0905 (ms) / GPU bubble ratio: 32.95%
[rank2]:2026-01-01 19:11:14,327 - Avg. fwd time: 13.3144 / Avg. bwd-weight time: 1.5676 / Avg. bwd-input time: 15.0138 / Avg. batch time: 1132.7628 (ms) / GPU bubble ratio: 57.77%
[rank0]:2026-01-01 19:11:14,368 - Avg. fwd time: 13.8951 / Avg. full-bwd time: 6.2699 (Avg. bwd-weight time: 1.2926 / Avg. bwd-input time: 15.0404) / Avg. batch time: 1213.0190 (ms) / GPU bubble ratio: 66.77%
[rank0]:2026-01-01 19:11:14,372 -  step: 500  loss: -4.0000  grad_norm:  6.5259  memory: 13.98GiB(29.42%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank1]:2026-01-01 19:11:14,361 - Avg. fwd time: 16.6953 / Avg. bwd-weight time: 2.1746 / Avg. bwd-input time: 18.9318 / Avg. batch time: 1189.9359 (ms) / GPU bubble ratio: 49.17%
[rank1]:2026-01-01 19:11:14,371 -  step: 500  loss: -4.0000  grad_norm:  6.5259  memory: 19.62GiB(41.30%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank3]:2026-01-01 19:11:14,372 -  step: 500  loss: 12.9581  grad_norm:  6.5259  memory: 30.44GiB(64.07%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank2]:2026-01-01 19:11:14,371 -  step: 500  loss: -4.0000  grad_norm:  6.5259  memory: 14.29GiB(30.09%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank2]:2026-01-01 19:11:14,422 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1911_stage2_step500.svg
[rank0]:2026-01-01 19:11:14,423 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1911_stage0_step500.svg
[rank0]:2026-01-01 19:11:14,463 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1911_stage4_step500.svg
[rank1]:2026-01-01 19:11:14,423 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1911_stage1_step500.svg
[rank1]:2026-01-01 19:11:14,464 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1911_stage5_step500.svg
[rank2]:2026-01-01 19:11:14,463 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1911_stage6_step500.svg
[rank2]:2026-01-01 19:11:14,588 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank2_stage2.svg
[rank2]:	> Counts Sum: 742, Total Sum: 1260 (58.89%), Ratio(%) per element: [62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55]
[rank0]:2026-01-01 19:11:14,588 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank0_stage0.svg
[rank0]:	> Counts Sum: 784, Total Sum: 1260 (62.22%), Ratio(%) per element: [97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66]
[rank1]:2026-01-01 19:11:14,601 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank1_stage1.svg
[rank1]:	> Counts Sum: 854, Total Sum: 1890 (45.19%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank3]:2026-01-01 19:11:14,693 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1911_step500_rank3.svg
[rank3]:			> Batch Time: 1201.00 ms, GPU Bubble Ratio: 70.25%, 48.67%, 60.82%, 41.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  71-14-85ms     | [S4,MB1,F]  128-14-142ms   | [S4,MB2,F]  186-14-200ms   | [S4,MB3,F]  243-14-258ms   | [S4,MB0,BI] 386-14-400ms   | [S4,MB0,BW] 400-1-401ms    | [S0,MB4,F]  401-12-414ms   | [S4,MB1,BI] 455-15-471ms   | [S4,MB1,BW] 470-1-471ms    | [S0,MB5,F]  472-12-484ms   | [S4,MB2,BI] 532-15-547ms   | [S4,MB2,BW] 547-1-548ms    | [S0,MB6,F]  548-13-561ms   | [S4,MB3,BI] 599-17-616ms   | [S4,MB3,BW] 616-1-617ms    | [S0,MB7,F]  617-15-633ms   | [S0,MB0,B]  654-0-654ms    | [S4,MB4,F]  655-15-670ms   | [S0,MB1,B]  705-0-705ms    | [S4,MB5,F]  706-15-721ms   | [S0,MB2,B]  749-0-749ms    | [S4,MB6,F]  751-14-765ms   | [S0,MB3,B]  793-0-793ms    | [S4,MB7,F]  795-14-809ms   | [S4,MB4,BI] 852-15-867ms   | [S4,MB4,BW] 867-1-868ms    | [S4,MB5,BI] 937-14-951ms   | [S4,MB5,BW] 951-1-952ms    | [S4,MB6,BI] 1000-14-1014ms | [S4,MB6,BW] 1014-1-1015ms  | [S4,MB7,BI] 1078-14-1092ms | [S4,MB7,BW] 1092-2-1094ms  | [S0,MB4,B]  1106-0-1106ms  | [S0,MB5,B]  1143-0-1143ms  | [S0,MB6,B]  1172-0-1172ms  | [S0,MB7,B]  1201-0-1201ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  128-19-147ms   | [S1,MB3,F]  186-19-205ms   | [S5,MB0,F]  243-12-256ms   | [S5,MB1,F]  262-12-275ms   | [S5,MB2,F]  282-12-294ms   | [S5,MB0,BI] 362-14-377ms   | [S5,MB3,F]  377-15-393ms   | [S5,MB1,BI] 432-14-447ms   | [S5,MB0,BW] 447-3-450ms    | [S1,MB4,F]  456-19-476ms   | [S5,MB2,BI] 502-15-517ms   | [S5,MB1,BW] 517-1-518ms    | [S1,MB5,F]  532-19-552ms   | [S5,MB3,BI] 574-16-591ms   | [S5,MB2,BW] 591-3-594ms    | [S1,MB6,F]  602-20-622ms   | [S1,MB0,BI] 622-24-646ms   | [S5,MB3,BW] 646-2-649ms    | [S1,MB7,F]  654-20-675ms   | [S1,MB1,BI] 674-22-697ms   | [S1,MB0,BW] 697-3-701ms    | [S5,MB4,F]  704-14-719ms   | [S1,MB2,BI] 719-23-742ms   | [S1,MB1,BW] 742-3-746ms    | [S5,MB5,F]  749-13-762ms   | [S1,MB3,BI] 763-23-786ms   | [S1,MB2,BW] 786-3-790ms    | [S5,MB6,F]  793-13-806ms   | [S5,MB4,BI] 829-15-845ms   | [S1,MB3,BW] 845-3-849ms    | [S5,MB7,F]  852-13-866ms   | [S5,MB5,BI] 903-15-918ms   | [S5,MB4,BW] 918-1-920ms    | [S5,MB6,BI] 979-14-993ms   | [S5,MB5,BW] 993-2-995ms    | [S5,MB7,BI] 1056-14-1070ms | [S5,MB6,BW] 1070-2-1072ms  | [S1,MB4,BI] 1077-21-1099ms | [S5,MB7,BW] 1099-2-1101ms  | [S1,MB5,BI] 1114-21-1136ms | [S1,MB4,BW] 1135-3-1138ms  | [S1,MB6,BI] 1142-22-1164ms | [S1,MB5,BW] 1164-3-1167ms  | [S1,MB7,BI] 1171-22-1193ms | [S1,MB6,BW] 1193-3-1196ms  | [S1,MB7,BW] 1197-1-1198ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-102ms    | [S2,MB2,F]  147-12-160ms   | [S2,MB3,F]  205-12-217ms   | [S6,MB0,F]  256-12-269ms   | [S6,MB1,F]  275-12-288ms   | [S6,MB0,BI] 341-14-356ms   | [S6,MB2,F]  356-14-370ms   | [S6,MB1,BI] 410-15-426ms   | [S6,MB3,F]  425-14-440ms   | [S6,MB2,BI] 481-14-495ms   | [S6,MB0,BW] 495-2-498ms    | [S2,MB4,F]  503-13-516ms   | [S6,MB3,BI] 552-15-567ms   | [S6,MB1,BW] 567-2-570ms    | [S2,MB5,F]  577-13-591ms   | [S2,MB0,BI] 595-16-611ms   | [S6,MB2,BW] 611-1-613ms    | [S2,MB6,F]  626-13-640ms   | [S2,MB1,BI] 639-15-654ms   | [S6,MB3,BW] 655-1-656ms    | [S2,MB7,F]  676-13-689ms   | [S2,MB2,BI] 689-15-704ms   | [S2,MB0,BW] 705-0-705ms    | [S6,MB4,F]  720-13-734ms   | [S2,MB3,BI] 734-15-749ms   | [S2,MB1,BW] 749-0-749ms    | [S6,MB5,F]  764-13-777ms   | [S6,MB4,BI] 808-15-823ms   | [S2,MB2,BW] 823-0-823ms    | [S6,MB6,F]  831-13-844ms   | [S6,MB5,BI] 881-15-896ms   | [S2,MB3,BW] 897-0-897ms    | [S6,MB7,F]  904-13-917ms   | [S6,MB6,BI] 957-15-972ms   | [S6,MB4,BW] 972-2-975ms    | [S6,MB7,BI] 1034-14-1049ms | [S6,MB5,BW] 1049-2-1051ms  | [S2,MB4,BI] 1056-14-1071ms | [S6,MB6,BW] 1070-2-1073ms  | [S2,MB5,BI] 1092-14-1107ms | [S6,MB7,BW] 1107-2-1110ms  | [S2,MB6,BI] 1113-14-1128ms | [S2,MB4,BW] 1128-0-1128ms  | [S2,MB7,BI] 1142-14-1157ms | [S2,MB5,BW] 1156-0-1156ms  | [S2,MB6,BW] 1156-0-1156ms  | [S2,MB7,BW] 1156-0-1156ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  102-12-115ms   | [S3,MB2,F]  160-12-173ms   | [S3,MB3,F]  217-12-230ms   | [S7,MB0,F]  269-18-288ms   | [S7,MB0,BI] 299-35-335ms   | [S7,MB1,F]  335-21-356ms   | [S7,MB1,BI] 368-35-404ms   | [S7,MB2,F]  404-22-427ms   | [S7,MB2,BI] 438-36-474ms   | [S7,MB3,F]  474-23-497ms   | [S7,MB3,BI] 509-36-545ms   | [S7,MB0,BW] 545-1-547ms    | [S3,MB4,F]  553-14-567ms   | [S3,MB0,BI] 567-18-585ms   | [S7,MB1,BW] 585-2-588ms    | [S3,MB5,F]  598-13-611ms   | [S3,MB1,BI] 611-17-629ms   | [S7,MB2,BW] 629-1-630ms    | [S3,MB6,F]  641-13-654ms   | [S3,MB2,BI] 654-16-670ms   | [S7,MB3,BW] 670-0-671ms    | [S3,MB7,F]  690-13-703ms   | [S3,MB3,BI] 703-16-719ms   | [S3,MB0,BW] 719-0-719ms    | [S7,MB4,F]  735-18-754ms   | [S7,MB4,BI] 766-35-801ms   | [S3,MB1,BW] 801-0-801ms    | [S7,MB5,F]  809-19-828ms   | [S7,MB5,BI] 839-35-875ms   | [S3,MB2,BW] 875-0-875ms    | [S7,MB6,F]  882-20-903ms   | [S7,MB6,BI] 915-35-951ms   | [S3,MB3,BW] 951-0-951ms    | [S7,MB7,F]  958-22-980ms   | [S7,MB7,BI] 991-35-1027ms  | [S7,MB4,BW] 1027-1-1028ms  | [S3,MB4,BI] 1028-16-1045ms | [S7,MB5,BW] 1046-0-1047ms  | [S3,MB5,BI] 1047-17-1064ms | [S7,MB6,BW] 1064-0-1064ms  | [S3,MB6,BI] 1064-15-1080ms | [S7,MB7,BW] 1080-0-1080ms  | [S3,MB7,BI] 1085-16-1101ms | [S3,MB4,BW] 1102-0-1102ms  | [S3,MB5,BW] 1102-0-1102ms  | [S3,MB6,BW] 1102-0-1102ms  | [S3,MB7,BW] 1102-0-1102ms 
[rank2]:2026-01-01 19:11:14,715 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank2_stage6.svg
[rank2]:	> Counts Sum: 42, Total Sum: 1260 (3.33%), Ratio(%) per element: [6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 19:11:14,712 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank0_stage4.svg
[rank0]:	> Counts Sum: 28, Total Sum: 1260 (2.22%), Ratio(%) per element: [4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 19:11:14,727 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank1_stage5.svg
[rank1]:	> Counts Sum: 28, Total Sum: 1260 (2.22%), Ratio(%) per element: [4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 4.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 19:11:14,737 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1911_stage3_step500.svg
[rank3]:2026-01-01 19:11:14,777 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1911_stage7_step500.svg
[rank3]:2026-01-01 19:11:14,903 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank3_stage3.svg
[rank3]:	> Counts Sum: 756, Total Sum: 1260 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank3]:2026-01-01 19:11:14,991 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1911_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 630 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 19:11:59,083 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.0000e+00
[rank1]:2026-01-01 19:11:59,084 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.1084e+00
[rank0]:2026-01-01 19:11:59,084 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 2.1165e+40
[rank3]:2026-01-01 19:11:59,082 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6739e+00
[rank3]:2026-01-01 19:12:48,308 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.1695e+00
[rank2]:2026-01-01 19:12:48,309 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 9.1864e+43
[rank0]:2026-01-01 19:12:48,310 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.6211e+01
[rank1]:2026-01-01 19:12:48,309 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 5.2666e+00
[rank3]:2026-01-01 19:13:37,462 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5299e+00
[rank2]:2026-01-01 19:13:37,462 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.2344e+00
[rank1]:2026-01-01 19:13:37,463 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3993e+00
[rank0]:2026-01-01 19:13:37,463 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.6638e+00
[rank2]:2026-01-01 19:14:26,566 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7744e+00
[rank0]:2026-01-01 19:14:26,567 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.50, Threshold: 1.4019e+00
[rank1]:2026-01-01 19:14:26,566 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.9067e+00
[rank3]:2026-01-01 19:14:26,565 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1247e+00
[rank2]:2026-01-01 19:15:15,324 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.0655e+01
[rank0]:2026-01-01 19:15:15,339 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 19:15:15,344 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.0000e+00
[rank1]:2026-01-01 19:15:15,343 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.2440e+01
[rank3]:2026-01-01 19:15:15,325 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3158e+01
[rank3]:2026-01-01 19:15:20,175 - Avg. fwd time: 17.1508 / Avg. bwd-weight time: 1.0009 / Avg. bwd-input time: 26.4589 / Avg. batch time: 1065.5350 (ms) / GPU bubble ratio: 33.01%
[rank2]:2026-01-01 19:15:20,226 - Avg. fwd time: 13.3111 / Avg. bwd-weight time: 1.5171 / Avg. bwd-input time: 15.0089 / Avg. batch time: 1132.3355 (ms) / GPU bubble ratio: 57.84%
[rank0]:2026-01-01 19:15:20,266 - Avg. fwd time: 13.8945 / Avg. full-bwd time: 6.1981 (Avg. bwd-weight time: 1.2736 / Avg. bwd-input time: 15.0368) / Avg. batch time: 1212.6173 (ms) / GPU bubble ratio: 66.82%
[rank0]:2026-01-01 19:15:20,270 -  step: 550  loss: -4.0000  grad_norm:  3.9805  memory: 13.98GiB(29.42%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank1]:2026-01-01 19:15:20,259 - Avg. fwd time: 16.6919 / Avg. bwd-weight time: 2.1527 / Avg. bwd-input time: 18.9270 / Avg. batch time: 1189.5310 (ms) / GPU bubble ratio: 49.19%
[rank1]:2026-01-01 19:15:20,269 -  step: 550  loss: -4.0000  grad_norm:  3.9805  memory: 19.62GiB(41.30%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank3]:2026-01-01 19:15:20,270 -  step: 550  loss: 11.0990  grad_norm:  3.9805  memory: 30.44GiB(64.07%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank2]:2026-01-01 19:15:20,269 -  step: 550  loss: -4.0000  grad_norm:  3.9805  memory: 14.29GiB(30.09%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank2]:2026-01-01 19:16:04,523 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5105e+00
[rank1]:2026-01-01 19:16:04,524 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.8314e-01
[rank0]:2026-01-01 19:16:04,524 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 2.1657e+40
[rank3]:2026-01-01 19:16:04,522 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.4964e+00
[rank2]:2026-01-01 19:16:53,862 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.9450e+00
[rank1]:2026-01-01 19:16:53,863 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.3640e+00
[rank0]:2026-01-01 19:16:53,863 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.4006e+00
[rank3]:2026-01-01 19:16:53,862 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1336e+00
[rank2]:2026-01-01 19:17:42,938 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.9823e+00
[rank1]:2026-01-01 19:17:42,939 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5510e+00
[rank0]:2026-01-01 19:17:42,939 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.50, Threshold: 1.5728e+00
[rank3]:2026-01-01 19:17:42,938 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.2821e+00
[rank1]:2026-01-01 19:18:31,828 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.4668e+01
[rank0]:2026-01-01 19:18:31,827 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.0000e+00
[rank3]:2026-01-01 19:18:31,826 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9653e+01
[rank2]:2026-01-01 19:18:31,827 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7507e+01
[rank2]:2026-01-01 19:19:20,940 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6311e+00
[rank1]:2026-01-01 19:19:20,940 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0533e+00
[rank0]:2026-01-01 19:19:20,939 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 19:19:20,943 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 5.8335e+40
[rank3]:2026-01-01 19:19:20,939 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6718e+00
[rank3]:2026-01-01 19:19:25,860 - Avg. fwd time: 17.1444 / Avg. bwd-weight time: 0.9662 / Avg. bwd-input time: 26.4504 / Avg. batch time: 1065.1403 (ms) / GPU bubble ratio: 33.06%
[rank2]:2026-01-01 19:19:25,911 - Avg. fwd time: 13.3090 / Avg. bwd-weight time: 1.4913 / Avg. bwd-input time: 15.0054 / Avg. batch time: 1131.9592 (ms) / GPU bubble ratio: 57.87%
[rank2]:2026-01-01 19:19:25,957 -  step: 600  loss: -4.0000  grad_norm:  5.3699  memory: 14.29GiB(30.09%)  tps: 6,669  tflops: 52.13  mfu: 16.71%
[rank1]:2026-01-01 19:19:25,951 - Avg. fwd time: 16.6896 / Avg. bwd-weight time: 2.1370 / Avg. bwd-input time: 18.9235 / Avg. batch time: 1189.1831 (ms) / GPU bubble ratio: 49.21%
[rank1]:2026-01-01 19:19:25,957 -  step: 600  loss: -4.0000  grad_norm:  5.3699  memory: 19.62GiB(41.30%)  tps: 6,669  tflops: 52.13  mfu: 16.71%
[rank1]:2026-01-01 19:19:26,009 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1919_stage1_step600.svg
[rank0]:2026-01-01 19:19:25,954 - Avg. fwd time: 13.8950 / Avg. full-bwd time: 6.1384 (Avg. bwd-weight time: 1.2576 / Avg. bwd-input time: 15.0348) / Avg. batch time: 1212.2666 (ms) / GPU bubble ratio: 66.86%
[rank0]:2026-01-01 19:19:25,958 -  step: 600  loss: -4.0000  grad_norm:  5.3699  memory: 13.98GiB(29.42%)  tps: 6,669  tflops: 52.13  mfu: 16.71%
[rank0]:2026-01-01 19:19:26,010 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1919_stage0_step600.svg
[rank3]:2026-01-01 19:19:25,958 -  step: 600  loss: 10.0152  grad_norm:  5.3699  memory: 30.44GiB(64.07%)  tps: 6,669  tflops: 52.13  mfu: 16.71%
[rank2]:2026-01-01 19:19:26,010 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1919_stage2_step600.svg
[rank2]:2026-01-01 19:19:26,052 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1919_stage6_step600.svg
[rank1]:2026-01-01 19:19:26,051 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1919_stage5_step600.svg
[rank0]:2026-01-01 19:19:26,052 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1919_stage4_step600.svg
[rank2]:2026-01-01 19:19:26,178 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank2_stage2.svg
[rank2]:	> Counts Sum: 1022, Total Sum: 1540 (66.36%), Ratio(%) per element: [69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 69.09, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63]
[rank1]:2026-01-01 19:19:26,187 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank1_stage1.svg
[rank1]:	> Counts Sum: 1064, Total Sum: 2310 (46.06%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81]
[rank0]:2026-01-01 19:19:26,180 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank0_stage0.svg
[rank0]:	> Counts Sum: 952, Total Sum: 1540 (61.82%), Ratio(%) per element: [98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45, 25.45]
[rank2]:2026-01-01 19:19:26,306 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank2_stage6.svg
[rank2]:	> Counts Sum: 56, Total Sum: 1540 (3.64%), Ratio(%) per element: [7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 19:19:26,310 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank1_stage5.svg
[rank1]:	> Counts Sum: 28, Total Sum: 1540 (1.82%), Ratio(%) per element: [3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 3.63, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 19:19:26,306 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank0_stage4.svg
[rank0]:	> Counts Sum: 56, Total Sum: 1540 (3.64%), Ratio(%) per element: [7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 19:19:26,279 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1919_step600_rank3.svg
[rank3]:			> Batch Time: 1207.28 ms, GPU Bubble Ratio: 66.29%, 51.29%, 60.94%, 41.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-85ms     | [S4,MB1,F]  128-14-143ms   | [S4,MB2,F]  186-14-200ms   | [S4,MB3,F]  243-14-258ms   | [S4,MB0,BI] 386-14-400ms   | [S4,MB0,BW] 400-1-401ms    | [S0,MB4,F]  401-12-414ms   | [S4,MB1,BI] 455-15-471ms   | [S4,MB1,BW] 471-1-472ms    | [S0,MB5,F]  472-12-485ms   | [S4,MB2,BI] 532-15-548ms   | [S4,MB2,BW] 548-1-549ms    | [S0,MB6,F]  548-13-561ms   | [S4,MB3,BI] 600-17-617ms   | [S4,MB3,BW] 617-1-618ms    | [S0,MB7,F]  618-15-634ms   | [S0,MB0,B]  655-7-662ms    | [S4,MB4,F]  660-14-674ms   | [S0,MB1,B]  706-7-713ms    | [S4,MB5,F]  711-13-724ms   | [S0,MB2,B]  750-7-757ms    | [S4,MB6,F]  755-12-767ms   | [S0,MB3,B]  794-7-801ms    | [S4,MB7,F]  799-13-812ms   | [S4,MB4,BI] 853-15-868ms   | [S4,MB4,BW] 868-1-869ms    | [S4,MB5,BI] 939-14-953ms   | [S4,MB5,BW] 953-1-954ms    | [S4,MB6,BI] 1002-14-1016ms | [S4,MB6,BW] 1016-1-1017ms  | [S4,MB7,BI] 1079-14-1093ms | [S4,MB7,BW] 1093-2-1095ms  | [S0,MB4,B]  1107-6-1113ms  | [S0,MB5,B]  1144-6-1150ms  | [S0,MB6,B]  1172-6-1178ms  | [S0,MB7,B]  1201-6-1207ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  128-19-147ms   | [S1,MB3,F]  186-19-205ms   | [S5,MB0,F]  243-12-256ms   | [S5,MB1,F]  263-12-275ms   | [S5,MB2,F]  282-12-295ms   | [S5,MB0,BI] 363-14-378ms   | [S5,MB3,F]  378-15-394ms   | [S5,MB1,BI] 432-14-447ms   | [S5,MB0,BW] 447-3-451ms    | [S1,MB4,F]  457-19-476ms   | [S5,MB2,BI] 503-15-518ms   | [S5,MB1,BW] 518-1-519ms    | [S1,MB5,F]  533-19-553ms   | [S5,MB3,BI] 575-16-592ms   | [S5,MB2,BW] 592-3-595ms    | [S1,MB6,F]  603-20-623ms   | [S1,MB0,BI] 623-24-647ms   | [S5,MB3,BW] 647-2-650ms    | [S1,MB7,F]  655-20-676ms   | [S1,MB1,BI] 676-22-699ms   | [S1,MB0,BW] 699-0-699ms    | [S5,MB4,F]  706-14-721ms   | [S1,MB2,BI] 721-22-744ms   | [S1,MB1,BW] 743-0-743ms    | [S5,MB5,F]  751-13-765ms   | [S1,MB3,BI] 764-23-787ms   | [S1,MB2,BW] 787-0-787ms    | [S5,MB6,F]  795-13-808ms   | [S5,MB4,BI] 831-15-847ms   | [S1,MB3,BW] 846-0-846ms    | [S5,MB7,F]  854-13-867ms   | [S5,MB5,BI] 905-15-920ms   | [S5,MB4,BW] 920-1-922ms    | [S5,MB6,BI] 980-14-995ms   | [S5,MB5,BW] 995-2-998ms    | [S5,MB7,BI] 1057-14-1071ms | [S5,MB6,BW] 1072-2-1075ms  | [S1,MB4,BI] 1078-21-1100ms | [S5,MB7,BW] 1100-2-1103ms  | [S1,MB5,BI] 1115-21-1137ms | [S1,MB4,BW] 1136-0-1136ms  | [S1,MB6,BI] 1143-21-1165ms | [S1,MB5,BW] 1165-0-1165ms  | [S1,MB7,BI] 1171-22-1193ms | [S1,MB6,BW] 1194-0-1194ms  | [S1,MB7,BW] 1197-0-1197ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-102ms    | [S2,MB2,F]  147-12-160ms   | [S2,MB3,F]  205-12-218ms   | [S6,MB0,F]  256-12-269ms   | [S6,MB1,F]  276-12-288ms   | [S6,MB0,BI] 342-14-356ms   | [S6,MB2,F]  356-14-371ms   | [S6,MB1,BI] 411-15-426ms   | [S6,MB3,F]  426-14-440ms   | [S6,MB2,BI] 482-14-496ms   | [S6,MB0,BW] 496-2-499ms    | [S2,MB4,F]  504-13-517ms   | [S6,MB3,BI] 553-15-568ms   | [S6,MB1,BW] 569-2-571ms    | [S2,MB5,F]  579-13-592ms   | [S2,MB0,BI] 596-15-612ms   | [S6,MB2,BW] 613-1-614ms    | [S2,MB6,F]  627-13-640ms   | [S2,MB1,BI] 641-15-656ms   | [S6,MB3,BW] 656-1-657ms    | [S2,MB7,F]  678-13-691ms   | [S2,MB2,BI] 691-15-706ms   | [S2,MB0,BW] 706-0-706ms    | [S6,MB4,F]  722-13-736ms   | [S2,MB3,BI] 736-15-751ms   | [S2,MB1,BW] 751-0-751ms    | [S6,MB5,F]  766-13-779ms   | [S6,MB4,BI] 810-15-825ms   | [S2,MB2,BW] 825-0-825ms    | [S6,MB6,F]  832-13-845ms   | [S6,MB5,BI] 884-15-899ms   | [S2,MB3,BW] 899-0-899ms    | [S6,MB7,F]  906-13-919ms   | [S6,MB6,BI] 959-15-974ms   | [S6,MB4,BW] 974-2-976ms    | [S6,MB7,BI] 1036-14-1051ms | [S6,MB5,BW] 1051-2-1053ms  | [S2,MB4,BI] 1057-14-1071ms | [S6,MB6,BW] 1071-2-1074ms  | [S2,MB5,BI] 1093-14-1107ms | [S6,MB7,BW] 1108-2-1111ms  | [S2,MB6,BI] 1114-14-1128ms | [S2,MB4,BW] 1129-0-1129ms  | [S2,MB7,BI] 1143-14-1157ms | [S2,MB5,BW] 1157-0-1157ms  | [S2,MB6,BW] 1157-0-1157ms  | [S2,MB7,BW] 1157-0-1157ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-57ms     | [S3,MB1,F]  102-12-115ms   | [S3,MB2,F]  160-12-173ms   | [S3,MB3,F]  217-12-230ms   | [S7,MB0,F]  269-18-288ms   | [S7,MB0,BI] 300-35-335ms   | [S7,MB1,F]  335-21-356ms   | [S7,MB1,BI] 368-35-404ms   | [S7,MB2,F]  404-22-427ms   | [S7,MB2,BI] 439-36-475ms   | [S7,MB3,F]  475-23-498ms   | [S7,MB3,BI] 510-36-547ms   | [S7,MB0,BW] 546-1-548ms    | [S3,MB4,F]  554-14-569ms   | [S3,MB0,BI] 568-18-586ms   | [S7,MB1,BW] 586-2-588ms    | [S3,MB5,F]  599-13-612ms   | [S3,MB1,BI] 612-17-630ms   | [S7,MB2,BW] 629-1-630ms    | [S3,MB6,F]  642-13-655ms   | [S3,MB2,BI] 655-15-671ms   | [S7,MB3,BW] 671-0-672ms    | [S3,MB7,F]  692-13-705ms   | [S3,MB3,BI] 705-15-721ms   | [S3,MB0,BW] 721-0-721ms    | [S7,MB4,F]  737-18-756ms   | [S7,MB4,BI] 767-35-803ms   | [S3,MB1,BW] 803-0-803ms    | [S7,MB5,F]  810-19-829ms   | [S7,MB5,BI] 842-35-877ms   | [S3,MB2,BW] 877-0-877ms    | [S7,MB6,F]  885-20-905ms   | [S7,MB6,BI] 916-36-952ms   | [S3,MB3,BW] 952-0-952ms    | [S7,MB7,F]  959-22-981ms   | [S7,MB7,BI] 993-35-1029ms  | [S7,MB4,BW] 1029-1-1030ms  | [S3,MB4,BI] 1030-17-1047ms | [S7,MB5,BW] 1046-0-1047ms  | [S3,MB5,BI] 1047-17-1065ms | [S7,MB6,BW] 1064-0-1065ms  | [S3,MB6,BI] 1065-16-1081ms | [S7,MB7,BW] 1081-0-1082ms  | [S3,MB7,BI] 1086-16-1102ms | [S3,MB4,BW] 1103-0-1103ms  | [S3,MB5,BW] 1103-0-1103ms  | [S3,MB6,BW] 1103-0-1103ms  | [S3,MB7,BW] 1103-0-1103ms 
[rank3]:2026-01-01 19:19:26,324 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1919_stage3_step600.svg
[rank3]:2026-01-01 19:19:26,365 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1919_stage7_step600.svg
[rank3]:2026-01-01 19:19:26,491 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank3_stage3.svg
[rank3]:	> Counts Sum: 1036, Total Sum: 1540 (67.27%), Ratio(%) per element: [67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27]
[rank3]:2026-01-01 19:19:26,581 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1919_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 770 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 19:20:10,823 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.0000e+00
[rank1]:2026-01-01 19:20:10,823 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.0030e+45
[rank0]:2026-01-01 19:20:10,824 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 3.9777e+00
[rank3]:2026-01-01 19:20:10,822 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.5310e+00
[rank0]:2026-01-01 19:20:59,919 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 2.7078e+00
[rank2]:2026-01-01 19:20:59,918 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.8843e+44
[rank1]:2026-01-01 19:20:59,919 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.2125e+00
[rank3]:2026-01-01 19:20:59,917 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6775e+00
[rank3]:2026-01-01 19:21:49,109 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6435e+00
[rank0]:2026-01-01 19:21:49,110 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.5438e+00
[rank2]:2026-01-01 19:21:49,109 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.2100e+00
[rank1]:2026-01-01 19:21:49,110 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.4839e+00
[rank0]:2026-01-01 19:22:38,422 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.8163e+01
[rank2]:2026-01-01 19:22:38,421 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.6348e+00
[rank1]:2026-01-01 19:22:38,422 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 7.3216e+00
[rank3]:2026-01-01 19:22:38,420 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.4551e+00
[rank0]:2026-01-01 19:23:27,593 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 19:23:27,598 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.2190e+00
[rank2]:2026-01-01 19:23:27,578 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5510e+00
[rank1]:2026-01-01 19:23:27,592 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.5836e+00
[rank3]:2026-01-01 19:23:27,579 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.7626e+00
[rank3]:2026-01-01 19:23:32,405 - Avg. fwd time: 17.1367 / Avg. bwd-weight time: 0.9366 / Avg. bwd-input time: 26.4416 / Avg. batch time: 1064.7854 (ms) / GPU bubble ratio: 33.11%
[rank0]:2026-01-01 19:23:32,497 - Avg. fwd time: 13.8890 / Avg. full-bwd time: 6.1927 (Avg. bwd-weight time: 1.2647 / Avg. bwd-input time: 15.0334) / Avg. batch time: 1212.1953 (ms) / GPU bubble ratio: 66.82%
[rank0]:2026-01-01 19:23:32,501 -  step: 650  loss: -4.0000  grad_norm:  7.9288  memory: 13.98GiB(29.42%)  tps: 6,645  tflops: 51.95  mfu: 16.65%
[rank2]:2026-01-01 19:23:32,457 - Avg. fwd time: 13.3064 / Avg. bwd-weight time: 1.4545 / Avg. bwd-input time: 15.0015 / Avg. batch time: 1131.7241 (ms) / GPU bubble ratio: 57.92%
[rank2]:2026-01-01 19:23:32,501 -  step: 650  loss: -4.0000  grad_norm:  7.9288  memory: 14.29GiB(30.09%)  tps: 6,645  tflops: 51.95  mfu: 16.65%
[rank1]:2026-01-01 19:23:32,496 - Avg. fwd time: 16.6892 / Avg. bwd-weight time: 2.1728 / Avg. bwd-input time: 18.9241 / Avg. batch time: 1189.1550 (ms) / GPU bubble ratio: 49.16%
[rank1]:2026-01-01 19:23:32,501 -  step: 650  loss: -4.0000  grad_norm:  7.9288  memory: 19.62GiB(41.30%)  tps: 6,645  tflops: 51.95  mfu: 16.65%
[rank3]:2026-01-01 19:23:32,501 -  step: 650  loss: 12.3055  grad_norm:  7.9288  memory: 30.44GiB(64.07%)  tps: 6,646  tflops: 51.95  mfu: 16.65%
[rank0]:2026-01-01 19:24:16,760 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.50, Threshold: 1.7637e+00
[rank2]:2026-01-01 19:24:16,759 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.2699e+00
[rank1]:2026-01-01 19:24:16,759 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.3155e+00
[rank3]:2026-01-01 19:24:16,758 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5256e+00
[rank0]:2026-01-01 19:25:05,497 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.0000e+00
[rank2]:2026-01-01 19:25:05,496 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6937e+01
[rank1]:2026-01-01 19:25:05,497 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.8820e+01
[rank3]:2026-01-01 19:25:05,495 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9148e+01
[rank2]:2026-01-01 19:25:54,676 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6754e+00
[rank0]:2026-01-01 19:25:54,677 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.0210e+40
[rank1]:2026-01-01 19:25:54,677 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0661e+00
[rank3]:2026-01-01 19:25:54,675 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.7641e+00
[rank3]:2026-01-01 19:26:43,996 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9872e+00
[rank2]:2026-01-01 19:26:43,997 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.0000e+00
[rank0]:2026-01-01 19:26:43,997 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.9054e+00
[rank1]:2026-01-01 19:26:43,997 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.1196e+00
[rank2]:2026-01-01 19:27:33,023 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.2848e+44
[rank1]:2026-01-01 19:27:33,024 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.6001e-01
[rank0]:2026-01-01 19:27:33,022 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 19:27:33,026 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.0520e+00
[rank3]:2026-01-01 19:27:33,023 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.8742e-01
[rank3]:2026-01-01 19:27:37,821 - Avg. fwd time: 17.1300 / Avg. bwd-weight time: 0.9114 / Avg. bwd-input time: 26.4324 / Avg. batch time: 1064.4027 (ms) / GPU bubble ratio: 33.15%
[rank1]:2026-01-01 19:27:37,911 - Avg. fwd time: 16.6857 / Avg. bwd-weight time: 2.1554 / Avg. bwd-input time: 18.9205 / Avg. batch time: 1188.7738 (ms) / GPU bubble ratio: 49.18%
[rank1]:2026-01-01 19:27:37,918 -  step: 700  loss: -4.0000  grad_norm:  6.9847  memory: 19.62GiB(41.30%)  tps: 6,676  tflops: 52.19  mfu: 16.73%
[rank2]:2026-01-01 19:27:37,872 - Avg. fwd time: 13.3045 / Avg. bwd-weight time: 1.4213 / Avg. bwd-input time: 14.9982 / Avg. batch time: 1131.3455 (ms) / GPU bubble ratio: 57.96%
[rank2]:2026-01-01 19:27:37,918 -  step: 700  loss: -4.0000  grad_norm:  6.9847  memory: 14.29GiB(30.09%)  tps: 6,676  tflops: 52.19  mfu: 16.73%
[rank0]:2026-01-01 19:27:37,915 - Avg. fwd time: 13.8892 / Avg. full-bwd time: 6.1415 (Avg. bwd-weight time: 1.2516 / Avg. bwd-input time: 15.0311) / Avg. batch time: 1211.8205 (ms) / GPU bubble ratio: 66.86%
[rank0]:2026-01-01 19:27:37,918 -  step: 700  loss: -4.0000  grad_norm:  6.9847  memory: 13.98GiB(29.42%)  tps: 6,676  tflops: 52.19  mfu: 16.73%
[rank3]:2026-01-01 19:27:37,918 -  step: 700  loss: 13.1112  grad_norm:  6.9847  memory: 30.44GiB(64.07%)  tps: 6,676  tflops: 52.19  mfu: 16.73%
[rank1]:2026-01-01 19:27:37,973 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1927_stage1_step700.svg
[rank1]:2026-01-01 19:27:38,016 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1927_stage5_step700.svg
[rank2]:2026-01-01 19:27:37,973 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1927_stage2_step700.svg
[rank2]:2026-01-01 19:27:38,016 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1927_stage6_step700.svg
[rank0]:2026-01-01 19:27:37,974 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1927_stage0_step700.svg
[rank0]:2026-01-01 19:27:38,018 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1927_stage4_step700.svg
[rank2]:2026-01-01 19:27:38,145 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank2_stage2.svg
[rank2]:	> Counts Sum: 1302, Total Sum: 1820 (71.54%), Ratio(%) per element: [73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 73.84, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23]
[rank0]:2026-01-01 19:27:38,157 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank0_stage0.svg
[rank0]:	> Counts Sum: 1106, Total Sum: 1820 (60.77%), Ratio(%) per element: [98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07]
[rank1]:2026-01-01 19:27:38,157 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank1_stage1.svg
[rank1]:	> Counts Sum: 1232, Total Sum: 2730 (45.13%), Ratio(%) per element: [47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53]
[rank3]:2026-01-01 19:27:38,265 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1927_step700_rank3.svg
[rank3]:			> Batch Time: 1202.25 ms, GPU Bubble Ratio: 66.21%, 51.25%, 60.86%, 41.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  70-14-85ms     | [S4,MB1,F]  128-14-142ms   | [S4,MB2,F]  185-14-199ms   | [S4,MB3,F]  243-14-257ms   | [S4,MB0,BI] 385-14-399ms   | [S4,MB0,BW] 399-1-400ms    | [S0,MB4,F]  400-12-413ms   | [S4,MB1,BI] 454-15-469ms   | [S4,MB1,BW] 470-1-471ms    | [S0,MB5,F]  471-12-484ms   | [S4,MB2,BI] 531-15-546ms   | [S4,MB2,BW] 546-1-547ms    | [S0,MB6,F]  547-13-560ms   | [S4,MB3,BI] 599-17-616ms   | [S4,MB3,BW] 616-1-617ms    | [S0,MB7,F]  617-16-633ms   | [S0,MB0,B]  653-7-660ms    | [S4,MB4,F]  660-14-674ms   | [S0,MB1,B]  704-7-711ms    | [S4,MB5,F]  711-13-725ms   | [S0,MB2,B]  748-7-755ms    | [S4,MB6,F]  755-12-768ms   | [S0,MB3,B]  792-7-799ms    | [S4,MB7,F]  799-12-812ms   | [S4,MB4,BI] 851-15-866ms   | [S4,MB4,BW] 866-1-867ms    | [S4,MB5,BI] 935-14-949ms   | [S4,MB5,BW] 949-1-950ms    | [S4,MB6,BI] 999-14-1013ms  | [S4,MB6,BW] 1013-1-1014ms  | [S4,MB7,BI] 1075-14-1089ms | [S4,MB7,BW] 1089-2-1091ms  | [S0,MB4,B]  1104-6-1110ms  | [S0,MB5,B]  1140-6-1146ms  | [S0,MB6,B]  1168-6-1174ms  | [S0,MB7,B]  1196-6-1202ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  70-19-89ms     | [S1,MB2,F]  128-19-147ms   | [S1,MB3,F]  185-19-204ms   | [S5,MB0,F]  243-12-255ms   | [S5,MB1,F]  262-12-274ms   | [S5,MB2,F]  281-12-294ms   | [S5,MB0,BI] 362-14-377ms   | [S5,MB3,F]  376-15-392ms   | [S5,MB1,BI] 431-14-445ms   | [S5,MB0,BW] 445-3-449ms    | [S1,MB4,F]  455-19-475ms   | [S5,MB2,BI] 501-15-517ms   | [S5,MB1,BW] 517-1-518ms    | [S1,MB5,F]  531-19-551ms   | [S5,MB3,BI] 573-16-590ms   | [S5,MB2,BW] 590-2-593ms    | [S1,MB6,F]  601-20-622ms   | [S1,MB0,BI] 621-24-645ms   | [S5,MB3,BW] 645-2-648ms    | [S1,MB7,F]  653-20-674ms   | [S1,MB1,BI] 674-22-697ms   | [S1,MB0,BW] 697-0-697ms    | [S5,MB4,F]  704-14-719ms   | [S1,MB2,BI] 718-22-741ms   | [S1,MB1,BW] 741-0-741ms    | [S5,MB5,F]  748-13-762ms   | [S1,MB3,BI] 762-22-785ms   | [S1,MB2,BW] 785-0-785ms    | [S5,MB6,F]  792-13-806ms   | [S5,MB4,BI] 828-15-843ms   | [S1,MB3,BW] 844-0-844ms    | [S5,MB7,F]  851-13-865ms   | [S5,MB5,BI] 901-15-917ms   | [S5,MB4,BW] 917-1-918ms    | [S5,MB6,BI] 977-14-991ms   | [S5,MB5,BW] 991-2-994ms    | [S5,MB7,BI] 1053-14-1067ms | [S5,MB6,BW] 1068-2-1071ms  | [S1,MB4,BI] 1075-21-1097ms | [S5,MB7,BW] 1096-2-1099ms  | [S1,MB5,BI] 1111-21-1133ms | [S1,MB4,BW] 1133-0-1133ms  | [S1,MB6,BI] 1139-21-1161ms | [S1,MB5,BW] 1161-0-1161ms  | [S1,MB7,BI] 1168-22-1190ms | [S1,MB6,BW] 1189-0-1189ms  | [S1,MB7,BW] 1190-0-1190ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  89-12-102ms    | [S2,MB2,F]  147-12-159ms   | [S2,MB3,F]  204-12-217ms   | [S6,MB0,F]  255-12-268ms   | [S6,MB1,F]  274-12-287ms   | [S6,MB0,BI] 340-14-355ms   | [S6,MB2,F]  355-14-370ms   | [S6,MB1,BI] 409-15-425ms   | [S6,MB3,F]  424-14-439ms   | [S6,MB2,BI] 480-14-495ms   | [S6,MB0,BW] 495-2-497ms    | [S2,MB4,F]  502-13-515ms   | [S6,MB3,BI] 551-15-566ms   | [S6,MB1,BW] 566-2-569ms    | [S2,MB5,F]  576-13-590ms   | [S2,MB0,BI] 594-15-610ms   | [S6,MB2,BW] 610-1-612ms    | [S2,MB6,F]  624-13-638ms   | [S2,MB1,BI] 638-15-654ms   | [S6,MB3,BW] 654-1-656ms    | [S2,MB7,F]  675-13-689ms   | [S2,MB2,BI] 689-15-704ms   | [S2,MB0,BW] 704-0-704ms    | [S6,MB4,F]  719-13-733ms   | [S2,MB3,BI] 733-15-748ms   | [S2,MB1,BW] 748-0-748ms    | [S6,MB5,F]  763-13-777ms   | [S6,MB4,BI] 806-15-822ms   | [S2,MB2,BW] 821-0-821ms    | [S6,MB6,F]  829-13-842ms   | [S6,MB5,BI] 880-15-895ms   | [S2,MB3,BW] 895-0-895ms    | [S6,MB7,F]  902-13-916ms   | [S6,MB6,BI] 955-15-970ms   | [S6,MB4,BW] 970-2-973ms    | [S6,MB7,BI] 1032-14-1047ms | [S6,MB5,BW] 1047-2-1050ms  | [S2,MB4,BI] 1054-14-1068ms | [S6,MB6,BW] 1068-2-1071ms  | [S2,MB5,BI] 1090-14-1104ms | [S6,MB7,BW] 1104-2-1107ms  | [S2,MB6,BI] 1111-14-1125ms | [S2,MB4,BW] 1125-0-1125ms  | [S2,MB7,BI] 1139-14-1153ms | [S2,MB5,BW] 1153-0-1153ms  | [S2,MB6,BW] 1153-0-1153ms  | [S2,MB7,BW] 1153-0-1153ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-57ms     | [S3,MB1,F]  102-12-115ms   | [S3,MB2,F]  159-12-172ms   | [S3,MB3,F]  217-12-229ms   | [S7,MB0,F]  268-18-287ms   | [S7,MB0,BI] 299-35-334ms   | [S7,MB1,F]  334-21-355ms   | [S7,MB1,BI] 367-35-403ms   | [S7,MB2,F]  403-22-425ms   | [S7,MB2,BI] 438-36-474ms   | [S7,MB3,F]  474-22-496ms   | [S7,MB3,BI] 509-36-545ms   | [S7,MB0,BW] 545-1-546ms    | [S3,MB4,F]  552-14-567ms   | [S3,MB0,BI] 567-18-585ms   | [S7,MB1,BW] 585-2-587ms    | [S3,MB5,F]  597-13-610ms   | [S3,MB1,BI] 610-17-628ms   | [S7,MB2,BW] 627-1-628ms    | [S3,MB6,F]  640-13-653ms   | [S3,MB2,BI] 653-15-669ms   | [S7,MB3,BW] 669-0-670ms    | [S3,MB7,F]  690-12-703ms   | [S3,MB3,BI] 703-15-718ms   | [S3,MB0,BW] 719-0-719ms    | [S7,MB4,F]  734-18-753ms   | [S7,MB4,BI] 765-35-800ms   | [S3,MB1,BW] 800-0-800ms    | [S7,MB5,F]  807-19-826ms   | [S7,MB5,BI] 839-35-874ms   | [S3,MB2,BW] 874-0-874ms    | [S7,MB6,F]  881-20-901ms   | [S7,MB6,BI] 913-35-949ms   | [S3,MB3,BW] 949-0-949ms    | [S7,MB7,F]  956-22-978ms   | [S7,MB7,BI] 990-35-1025ms  | [S7,MB4,BW] 1025-1-1026ms  | [S3,MB4,BI] 1027-16-1043ms | [S7,MB5,BW] 1044-0-1044ms  | [S3,MB5,BI] 1045-17-1062ms | [S7,MB6,BW] 1062-0-1063ms  | [S3,MB6,BI] 1063-15-1079ms | [S7,MB7,BW] 1079-0-1079ms  | [S3,MB7,BI] 1083-16-1099ms | [S3,MB4,BW] 1100-0-1100ms  | [S3,MB5,BW] 1100-0-1100ms  | [S3,MB6,BW] 1100-0-1100ms  | [S3,MB7,BW] 1100-0-1100ms 
[rank1]:2026-01-01 19:27:38,282 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank1_stage5.svg
[rank1]:	> Counts Sum: 28, Total Sum: 1820 (1.54%), Ratio(%) per element: [3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 3.07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 19:27:38,270 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank2_stage6.svg
[rank2]:	> Counts Sum: 70, Total Sum: 1820 (3.85%), Ratio(%) per element: [7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 19:27:38,283 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank0_stage4.svg
[rank0]:	> Counts Sum: 70, Total Sum: 1820 (3.85%), Ratio(%) per element: [7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 19:27:38,316 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1927_stage3_step700.svg
[rank3]:2026-01-01 19:27:38,361 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1927_stage7_step700.svg
[rank3]:2026-01-01 19:27:38,497 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank3_stage3.svg
[rank3]:	> Counts Sum: 1316, Total Sum: 1820 (72.31%), Ratio(%) per element: [72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3]
[rank3]:2026-01-01 19:27:38,589 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1927_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 910 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 19:28:22,793 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 9.7408e-01
[rank2]:2026-01-01 19:28:22,792 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.8685e+00
[rank0]:2026-01-01 19:28:22,793 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.5373e+00
[rank3]:2026-01-01 19:28:22,791 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8708e+00
[rank2]:2026-01-01 19:29:11,879 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.6464e+00
[rank1]:2026-01-01 19:29:11,879 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 6.5156e+00
[rank3]:2026-01-01 19:29:11,878 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.5519e+00
[rank0]:2026-01-01 19:29:11,880 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.7108e+01
[rank2]:2026-01-01 19:30:01,061 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.8103e+00
[rank1]:2026-01-01 19:30:01,062 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.8137e+00
[rank0]:2026-01-01 19:30:01,062 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.3342e+00
[rank3]:2026-01-01 19:30:01,061 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0138e+00
[rank2]:2026-01-01 19:30:50,076 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.1629e+00
[rank1]:2026-01-01 19:30:50,076 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.6824e+00
[rank0]:2026-01-01 19:30:50,077 - Freezing Ratio: [Stage0] 1.00, [Stage4] 0.50, Threshold: 1.7204e+00
[rank3]:2026-01-01 19:30:50,075 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3699e+00
[rank2]:2026-01-01 19:31:38,866 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.8116e+01
[rank1]:2026-01-01 19:31:38,886 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.9267e+01
[rank3]:2026-01-01 19:31:38,867 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9390e+01
[rank0]:2026-01-01 19:31:38,882 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 19:31:38,887 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.0000e+00
[rank2]:2026-01-01 19:31:43,784 - Avg. fwd time: 13.3030 / Avg. bwd-weight time: 1.4086 / Avg. bwd-input time: 14.9962 / Avg. batch time: 1131.1152 (ms) / GPU bubble ratio: 57.98%
[rank3]:2026-01-01 19:31:43,733 - Avg. fwd time: 17.1252 / Avg. bwd-weight time: 0.8894 / Avg. bwd-input time: 26.4253 / Avg. batch time: 1064.0910 (ms) / GPU bubble ratio: 33.18%
[rank2]:2026-01-01 19:31:43,828 -  step: 750  loss: -4.0000  grad_norm:  3.9181  memory: 14.29GiB(30.09%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank1]:2026-01-01 19:31:43,818 - Avg. fwd time: 16.6815 / Avg. bwd-weight time: 2.1158 / Avg. bwd-input time: 18.9162 / Avg. batch time: 1188.4554 (ms) / GPU bubble ratio: 49.23%
[rank1]:2026-01-01 19:31:43,828 -  step: 750  loss: -4.0000  grad_norm:  3.9181  memory: 19.62GiB(41.30%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank3]:2026-01-01 19:31:43,829 -  step: 750  loss: 11.0736  grad_norm:  3.9181  memory: 30.44GiB(64.07%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank0]:2026-01-01 19:31:43,825 - Avg. fwd time: 13.8900 / Avg. full-bwd time: 6.0973 (Avg. bwd-weight time: 1.2405 / Avg. bwd-input time: 15.0294) / Avg. batch time: 1211.5763 (ms) / GPU bubble ratio: 66.89%
[rank0]:2026-01-01 19:31:43,828 -  step: 750  loss: -4.0000  grad_norm:  3.9181  memory: 13.98GiB(29.42%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank2]:2026-01-01 19:32:28,024 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6535e+00
[rank0]:2026-01-01 19:32:28,025 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 3.0074e+40
[rank1]:2026-01-01 19:32:28,025 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1436e+00
[rank3]:2026-01-01 19:32:28,024 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6166e+00
[rank3]:2026-01-01 19:33:17,123 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5345e+00
[rank2]:2026-01-01 19:33:17,124 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.2821e+00
[rank0]:2026-01-01 19:33:17,125 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.6266e+00
[rank1]:2026-01-01 19:33:17,124 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 4.0000e+00
[rank0]:2026-01-01 19:34:06,156 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.2404e+00
[rank2]:2026-01-01 19:34:06,155 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5159e+00
[rank1]:2026-01-01 19:34:06,155 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2026-01-01 19:34:06,154 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8840e+00
[rank0]:2026-01-01 19:34:55,322 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 4.9628e+00
[rank2]:2026-01-01 19:34:55,321 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.7729e+00
[rank1]:2026-01-01 19:34:55,322 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.1558e+00
[rank3]:2026-01-01 19:34:55,320 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.4865e+00
[rank0]:2026-01-01 19:35:44,484 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 19:35:44,488 - Freezing Ratio: [Stage0] 0.50, [Stage4] 0.00, Threshold: 1.8221e+01
[rank1]:2026-01-01 19:35:44,485 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 6.3958e+00
[rank2]:2026-01-01 19:35:44,485 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.7283e+00
[rank3]:2026-01-01 19:35:44,484 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.5526e+00
[rank3]:2026-01-01 19:35:49,403 - Avg. fwd time: 17.1203 / Avg. bwd-weight time: 0.8703 / Avg. bwd-input time: 26.4196 / Avg. batch time: 1063.8125 (ms) / GPU bubble ratio: 33.21%
[rank0]:2026-01-01 19:35:49,495 - Avg. fwd time: 13.8852 / Avg. full-bwd time: 6.1441 (Avg. bwd-weight time: 1.2474 / Avg. bwd-input time: 15.0287) / Avg. batch time: 1211.3591 (ms) / GPU bubble ratio: 66.85%
[rank0]:2026-01-01 19:35:49,499 -  step: 800  loss: -4.0000  grad_norm:  4.9694  memory: 13.98GiB(29.42%)  tps: 6,669  tflops: 52.14  mfu: 16.71%
[rank0]:2026-01-01 19:35:49,499 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  4.9694  tps: 7,056  tflops: 55.16  mfu: 16.12%
[rank0]:2026-01-01 19:35:49,499 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 19:35:49,500 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 19:35:49,488 - Avg. fwd time: 16.6776 / Avg. bwd-weight time: 2.0677 / Avg. bwd-input time: 18.9121 / Avg. batch time: 1188.1003 (ms) / GPU bubble ratio: 49.29%
[rank1]:2026-01-01 19:35:49,498 -  step: 800  loss: -4.0000  grad_norm:  4.9694  memory: 19.62GiB(41.30%)  tps: 6,669  tflops: 52.14  mfu: 16.71%
[rank1]:2026-01-01 19:35:49,498 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  4.9694  tps: 7,056  tflops: 55.16  mfu: 16.12%
[rank1]:2026-01-01 19:35:49,498 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 19:35:49,499 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 19:35:49,454 - Avg. fwd time: 13.3016 / Avg. bwd-weight time: 1.3977 / Avg. bwd-input time: 14.9941 / Avg. batch time: 1130.8296 (ms) / GPU bubble ratio: 57.99%
[rank2]:2026-01-01 19:35:49,498 -  step: 800  loss: -4.0000  grad_norm:  4.9694  memory: 14.29GiB(30.09%)  tps: 6,669  tflops: 52.14  mfu: 16.71%
[rank2]:2026-01-01 19:35:49,498 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  4.9694  tps: 7,056  tflops: 55.16  mfu: 16.12%
[rank2]:2026-01-01 19:35:49,498 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 19:35:49,499 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 19:35:49,499 -  step: 800  loss:  9.8078  grad_norm:  4.9694  memory: 30.44GiB(64.07%)  tps: 6,669  tflops: 52.14  mfu: 16.71%
[rank3]:2026-01-01 19:35:49,500 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm:  4.9694  tps: 7,060  tflops: 55.19  mfu: 16.24%
[rank3]:2026-01-01 19:35:49,500 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 19:35:49,501 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 19:35:51,713 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-01 19:35:51,791 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1935_stage0_final800.svg
[rank1]:2026-01-01 19:35:51,790 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1935_stage1_final800.svg
[rank2]:2026-01-01 19:35:51,793 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1935_stage2_final800.svg
[rank0]:2026-01-01 19:35:51,837 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/260101_1935_stage4_final800.svg
[rank1]:2026-01-01 19:35:51,835 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/260101_1935_stage5_final800.svg
[rank2]:2026-01-01 19:35:51,843 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/260101_1935_stage6_final800.svg
[rank0]:2026-01-01 19:35:51,968 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank0_stage0.svg
[rank0]:	> Counts Sum: 1260, Total Sum: 2100 (60.00%), Ratio(%) per element: [98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33, 21.33]
[rank1]:2026-01-01 19:35:51,975 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank1_stage1.svg
[rank1]:	> Counts Sum: 1610, Total Sum: 3150 (51.11%), Ratio(%) per element: [53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0]
[rank2]:2026-01-01 19:35:51,981 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank2_stage2.svg
[rank2]:	> Counts Sum: 1582, Total Sum: 2100 (75.33%), Ratio(%) per element: [77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33]
[rank0]:2026-01-01 19:35:52,094 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank0_stage4.svg
[rank0]:	> Counts Sum: 84, Total Sum: 2100 (4.00%), Ratio(%) per element: [8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 19:35:52,094 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-01 19:35:52,101 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank1_stage5.svg
[rank1]:	> Counts Sum: 42, Total Sum: 2100 (2.00%), Ratio(%) per element: [4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 19:35:52,101 - Destroying the purge thread.
[rank3]:2026-01-01 19:35:52,069 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1935_final800_rank3.svg
[rank3]:			> Batch Time: 1209.27 ms, GPU Bubble Ratio: 66.35%, 49.13%, 60.96%, 41.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  128-14-143ms   | [S4,MB2,F]  186-14-201ms   | [S4,MB3,F]  244-14-258ms   | [S4,MB0,BI] 387-14-401ms   | [S4,MB0,BW] 401-1-402ms    | [S0,MB4,F]  402-12-415ms   | [S4,MB1,BI] 456-15-471ms   | [S4,MB1,BW] 471-1-472ms    | [S0,MB5,F]  473-12-485ms   | [S4,MB2,BI] 533-15-548ms   | [S4,MB2,BW] 548-1-549ms    | [S0,MB6,F]  549-13-562ms   | [S4,MB3,BI] 601-17-618ms   | [S4,MB3,BW] 618-1-619ms    | [S0,MB7,F]  619-15-634ms   | [S0,MB0,B]  655-7-663ms    | [S4,MB4,F]  662-14-676ms   | [S0,MB1,B]  706-7-714ms    | [S4,MB5,F]  713-13-727ms   | [S0,MB2,B]  751-7-758ms    | [S4,MB6,F]  757-12-770ms   | [S0,MB3,B]  795-7-802ms    | [S4,MB7,F]  802-13-815ms   | [S4,MB4,BI] 854-15-869ms   | [S4,MB4,BW] 869-1-870ms    | [S4,MB5,BI] 940-14-954ms   | [S4,MB5,BW] 954-1-955ms    | [S4,MB6,BI] 1003-14-1017ms | [S4,MB6,BW] 1017-1-1018ms  | [S4,MB7,BI] 1080-14-1094ms | [S4,MB7,BW] 1094-2-1096ms  | [S0,MB4,B]  1109-6-1115ms  | [S0,MB5,B]  1145-6-1151ms  | [S0,MB6,B]  1174-6-1180ms  | [S0,MB7,B]  1203-6-1209ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  128-19-148ms   | [S1,MB3,F]  186-19-205ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  263-12-276ms   | [S5,MB2,F]  282-12-295ms   | [S5,MB0,BI] 363-14-378ms   | [S5,MB3,F]  378-15-394ms   | [S5,MB1,BI] 433-14-447ms   | [S5,MB0,BW] 447-3-451ms    | [S1,MB4,F]  457-19-477ms   | [S5,MB2,BI] 504-15-519ms   | [S5,MB1,BW] 519-1-520ms    | [S1,MB5,F]  533-19-553ms   | [S5,MB3,BI] 575-16-592ms   | [S5,MB2,BW] 592-2-595ms    | [S1,MB6,F]  603-20-624ms   | [S1,MB0,BI] 624-24-648ms   | [S5,MB3,BW] 648-2-651ms    | [S1,MB7,F]  655-20-676ms   | [S1,MB1,BI] 676-23-699ms   | [S1,MB0,BW] 699-3-703ms    | [S5,MB4,F]  706-14-721ms   | [S1,MB2,BI] 721-22-744ms   | [S1,MB1,BW] 744-3-747ms    | [S5,MB5,F]  751-13-765ms   | [S1,MB3,BI] 765-23-788ms   | [S1,MB2,BW] 788-3-792ms    | [S5,MB6,F]  795-13-809ms   | [S5,MB4,BI] 831-15-847ms   | [S1,MB3,BW] 846-3-850ms    | [S5,MB7,F]  854-13-867ms   | [S5,MB5,BI] 905-15-921ms   | [S5,MB4,BW] 921-1-922ms    | [S5,MB6,BI] 981-14-996ms   | [S5,MB5,BW] 996-2-999ms    | [S5,MB7,BI] 1058-14-1072ms | [S5,MB6,BW] 1073-2-1076ms  | [S1,MB4,BI] 1080-21-1102ms | [S5,MB7,BW] 1101-2-1104ms  | [S1,MB5,BI] 1116-21-1138ms | [S1,MB4,BW] 1138-3-1141ms  | [S1,MB6,BI] 1145-22-1167ms | [S1,MB5,BW] 1167-3-1170ms  | [S1,MB7,BI] 1173-22-1195ms | [S1,MB6,BW] 1195-3-1198ms  | [S1,MB7,BW] 1198-1-1199ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-160ms   | [S2,MB3,F]  205-12-218ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  276-12-289ms   | [S6,MB0,BI] 342-14-357ms   | [S6,MB2,F]  357-14-371ms   | [S6,MB1,BI] 411-15-426ms   | [S6,MB3,F]  426-14-441ms   | [S6,MB2,BI] 483-14-497ms   | [S6,MB0,BW] 497-2-500ms    | [S2,MB4,F]  505-13-518ms   | [S6,MB3,BI] 554-15-569ms   | [S6,MB1,BW] 569-2-571ms    | [S2,MB5,F]  579-13-592ms   | [S2,MB0,BI] 597-15-613ms   | [S6,MB2,BW] 613-1-615ms    | [S2,MB6,F]  627-13-641ms   | [S2,MB1,BI] 641-15-656ms   | [S6,MB3,BW] 656-1-658ms    | [S2,MB7,F]  678-13-691ms   | [S2,MB2,BI] 691-15-706ms   | [S2,MB0,BW] 706-0-706ms    | [S6,MB4,F]  722-13-736ms   | [S2,MB3,BI] 736-15-751ms   | [S2,MB1,BW] 751-0-751ms    | [S6,MB5,F]  766-13-779ms   | [S6,MB4,BI] 809-15-824ms   | [S2,MB2,BW] 824-0-824ms    | [S6,MB6,F]  832-13-845ms   | [S6,MB5,BI] 884-15-899ms   | [S2,MB3,BW] 899-0-899ms    | [S6,MB7,F]  907-13-920ms   | [S6,MB6,BI] 960-15-975ms   | [S6,MB4,BW] 975-2-978ms    | [S6,MB7,BI] 1037-14-1052ms | [S6,MB5,BW] 1052-2-1054ms  | [S2,MB4,BI] 1058-14-1073ms | [S6,MB6,BW] 1073-2-1076ms  | [S2,MB5,BI] 1095-14-1110ms | [S6,MB7,BW] 1109-2-1112ms  | [S2,MB6,BI] 1116-14-1131ms | [S2,MB4,BW] 1130-0-1130ms  | [S2,MB7,BI] 1144-14-1159ms | [S2,MB5,BW] 1159-0-1159ms  | [S2,MB6,BW] 1159-0-1159ms  | [S2,MB7,BW] 1160-0-1160ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-115ms   | [S3,MB2,F]  160-12-173ms   | [S3,MB3,F]  218-12-231ms   | [S7,MB0,F]  270-18-288ms   | [S7,MB0,BI] 300-35-335ms   | [S7,MB1,F]  335-21-357ms   | [S7,MB1,BI] 368-35-404ms   | [S7,MB2,F]  404-23-428ms   | [S7,MB2,BI] 440-36-476ms   | [S7,MB3,F]  476-23-499ms   | [S7,MB3,BI] 511-36-547ms   | [S7,MB0,BW] 547-1-548ms    | [S3,MB4,F]  554-14-569ms   | [S3,MB0,BI] 569-18-588ms   | [S7,MB1,BW] 587-2-590ms    | [S3,MB5,F]  599-13-612ms   | [S3,MB1,BI] 612-17-630ms   | [S7,MB2,BW] 630-1-631ms    | [S3,MB6,F]  642-13-655ms   | [S3,MB2,BI] 655-16-671ms   | [S7,MB3,BW] 671-0-672ms    | [S3,MB7,F]  692-13-705ms   | [S3,MB3,BI] 705-15-721ms   | [S3,MB0,BW] 721-0-721ms    | [S7,MB4,F]  736-18-755ms   | [S7,MB4,BI] 767-35-803ms   | [S3,MB1,BW] 802-0-802ms    | [S7,MB5,F]  810-19-829ms   | [S7,MB5,BI] 842-35-877ms   | [S3,MB2,BW] 877-0-877ms    | [S7,MB6,F]  885-20-905ms   | [S7,MB6,BI] 917-35-953ms   | [S3,MB3,BW] 953-0-953ms    | [S7,MB7,F]  961-22-983ms   | [S7,MB7,BI] 994-35-1030ms  | [S7,MB4,BW] 1030-1-1031ms  | [S3,MB4,BI] 1031-17-1049ms | [S7,MB5,BW] 1048-0-1049ms  | [S3,MB5,BI] 1049-17-1067ms | [S7,MB6,BW] 1066-0-1067ms  | [S3,MB6,BI] 1067-16-1084ms | [S7,MB7,BW] 1084-0-1085ms  | [S3,MB7,BI] 1088-16-1105ms | [S3,MB4,BW] 1104-0-1104ms  | [S3,MB5,BW] 1105-0-1105ms  | [S3,MB6,BW] 1106-0-1106ms  | [S3,MB7,BW] 1106-0-1106ms 
[rank2]:2026-01-01 19:35:52,119 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank2_stage6.svg
[rank2]:	> Counts Sum: 70, Total Sum: 2100 (3.33%), Ratio(%) per element: [6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 19:35:52,119 - Destroying the purge thread.
[rank1]:2026-01-01 19:35:52,279 - Process group destroyed
[rank2]:2026-01-01 19:35:52,280 - Process group destroyed
[rank3]:2026-01-01 19:35:52,400 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/pipeline_schedule/260101_1935_thry_final800_rank3.svg
[rank3]:			> Batch Time: 775.96 ms, GPU Bubble Ratio: 5.88%, 5.88%, 5.88%, 5.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S4,MB0,F]  60-15-76ms     | [S4,MB1,F]  76-15-91ms     | [S4,MB2,F]  91-15-106ms    | [S4,MB3,F]  106-15-121ms   | [S4,MB0,BI] 167-15-182ms   | [S4,MB0,BW] 182-15-197ms   | [S0,MB4,F]  197-15-213ms   | [S4,MB1,BI] 213-15-228ms   | [S4,MB1,BW] 228-15-243ms   | [S0,MB5,F]  243-15-258ms   | [S4,MB2,BI] 258-15-273ms   | [S4,MB2,BW] 273-15-289ms   | [S0,MB6,F]  289-15-304ms   | [S4,MB3,BI] 304-15-319ms   | [S4,MB3,BW] 319-15-334ms   | [S0,MB7,F]  334-15-349ms   | [S0,MB0,B]  349-30-380ms   | [S4,MB4,F]  380-15-395ms   | [S0,MB1,B]  395-30-426ms   | [S4,MB5,F]  426-15-441ms   | [S0,MB2,B]  441-30-471ms   | [S4,MB6,F]  471-15-486ms   | [S0,MB3,B]  486-30-517ms   | [S4,MB7,F]  517-15-532ms   | [S4,MB4,BI] 532-15-547ms   | [S4,MB4,BW] 547-15-562ms   | [S4,MB5,BI] 562-15-578ms   | [S4,MB5,BW] 578-15-593ms   | [S4,MB6,BI] 593-15-608ms   | [S4,MB6,BW] 608-15-623ms   | [S4,MB7,BI] 623-15-639ms   | [S4,MB7,BW] 639-15-654ms   | [S0,MB4,B]  654-30-684ms   | [S0,MB5,B]  684-30-715ms   | [S0,MB6,B]  715-30-745ms   | [S0,MB7,B]  745-30-775ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  30-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S5,MB0,F]  76-15-91ms     | [S5,MB1,F]  91-15-106ms    | [S5,MB2,F]  106-15-121ms   | [S5,MB0,BI] 152-15-167ms   | [S5,MB3,F]  167-15-182ms   | [S5,MB1,BI] 182-15-197ms   | [S5,MB0,BW] 197-15-213ms   | [S1,MB4,F]  213-15-228ms   | [S5,MB2,BI] 228-15-243ms   | [S5,MB1,BW] 243-15-258ms   | [S1,MB5,F]  258-15-273ms   | [S5,MB3,BI] 273-15-289ms   | [S5,MB2,BW] 289-15-304ms   | [S1,MB6,F]  304-15-319ms   | [S1,MB0,BI] 319-15-334ms   | [S5,MB3,BW] 334-15-349ms   | [S1,MB7,F]  349-15-365ms   | [S1,MB1,BI] 365-15-380ms   | [S1,MB0,BW] 380-15-395ms   | [S5,MB4,F]  395-15-410ms   | [S1,MB2,BI] 410-15-426ms   | [S1,MB1,BW] 426-15-441ms   | [S5,MB5,F]  441-15-456ms   | [S1,MB3,BI] 456-15-471ms   | [S1,MB2,BW] 471-15-486ms   | [S5,MB6,F]  486-15-502ms   | [S5,MB4,BI] 502-15-517ms   | [S1,MB3,BW] 517-15-532ms   | [S5,MB7,F]  532-15-547ms   | [S5,MB5,BI] 547-15-562ms   | [S5,MB4,BW] 562-15-578ms   | [S5,MB6,BI] 578-15-593ms   | [S5,MB5,BW] 593-15-608ms   | [S5,MB7,BI] 608-15-623ms   | [S5,MB6,BW] 623-15-639ms   | [S1,MB4,BI] 639-15-654ms   | [S5,MB7,BW] 654-15-669ms   | [S1,MB5,BI] 669-15-684ms   | [S1,MB4,BW] 684-15-699ms   | [S1,MB6,BI] 699-15-715ms   | [S1,MB5,BW] 715-15-730ms   | [S1,MB7,BI] 730-15-745ms   | [S1,MB6,BW] 745-15-760ms   | [S1,MB7,BW] 760-15-775ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-15-45ms     | [S2,MB1,F]  45-15-60ms     | [S2,MB2,F]  60-15-76ms     | [S2,MB3,F]  76-15-91ms     | [S6,MB0,F]  91-15-106ms    | [S6,MB1,F]  106-15-121ms   | [S6,MB0,BI] 136-15-152ms   | [S6,MB2,F]  152-15-167ms   | [S6,MB1,BI] 167-15-182ms   | [S6,MB3,F]  182-15-197ms   | [S6,MB2,BI] 197-15-213ms   | [S6,MB0,BW] 213-15-228ms   | [S2,MB4,F]  228-15-243ms   | [S6,MB3,BI] 243-15-258ms   | [S6,MB1,BW] 258-15-273ms   | [S2,MB5,F]  273-15-289ms   | [S2,MB0,BI] 289-15-304ms   | [S6,MB2,BW] 304-15-319ms   | [S2,MB6,F]  319-15-334ms   | [S2,MB1,BI] 334-15-349ms   | [S6,MB3,BW] 349-15-365ms   | [S2,MB7,F]  365-15-380ms   | [S2,MB2,BI] 380-15-395ms   | [S2,MB0,BW] 395-15-410ms   | [S6,MB4,F]  410-15-426ms   | [S2,MB3,BI] 426-15-441ms   | [S2,MB1,BW] 441-15-456ms   | [S6,MB5,F]  456-15-471ms   | [S6,MB4,BI] 471-15-486ms   | [S2,MB2,BW] 486-15-502ms   | [S6,MB6,F]  502-15-517ms   | [S6,MB5,BI] 517-15-532ms   | [S2,MB3,BW] 532-15-547ms   | [S6,MB7,F]  547-15-562ms   | [S6,MB6,BI] 562-15-578ms   | [S6,MB4,BW] 578-15-593ms   | [S6,MB7,BI] 593-15-608ms   | [S6,MB5,BW] 608-15-623ms   | [S2,MB4,BI] 623-15-639ms   | [S6,MB6,BW] 639-15-654ms   | [S2,MB5,BI] 654-15-669ms   | [S6,MB7,BW] 669-15-684ms   | [S2,MB6,BI] 684-15-699ms   | [S2,MB4,BW] 699-15-715ms   | [S2,MB7,BI] 715-15-730ms   | [S2,MB5,BW] 730-15-745ms   | [S2,MB6,BW] 745-15-760ms   | [S2,MB7,BW] 760-15-775ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-15-60ms     | [S3,MB1,F]  60-15-76ms     | [S3,MB2,F]  76-15-91ms     | [S3,MB3,F]  91-15-106ms    | [S7,MB0,F]  106-15-121ms   | [S7,MB0,BI] 121-15-136ms   | [S7,MB1,F]  136-15-152ms   | [S7,MB1,BI] 152-15-167ms   | [S7,MB2,F]  167-15-182ms   | [S7,MB2,BI] 182-15-197ms   | [S7,MB3,F]  197-15-213ms   | [S7,MB3,BI] 213-15-228ms   | [S7,MB0,BW] 228-15-243ms   | [S3,MB4,F]  243-15-258ms   | [S3,MB0,BI] 258-15-273ms   | [S7,MB1,BW] 273-15-289ms   | [S3,MB5,F]  289-15-304ms   | [S3,MB1,BI] 304-15-319ms   | [S7,MB2,BW] 319-15-334ms   | [S3,MB6,F]  334-15-349ms   | [S3,MB2,BI] 349-15-365ms   | [S7,MB3,BW] 365-15-380ms   | [S3,MB7,F]  380-15-395ms   | [S3,MB3,BI] 395-15-410ms   | [S3,MB0,BW] 410-15-426ms   | [S7,MB4,F]  426-15-441ms   | [S7,MB4,BI] 441-15-456ms   | [S3,MB1,BW] 456-15-471ms   | [S7,MB5,F]  471-15-486ms   | [S7,MB5,BI] 486-15-502ms   | [S3,MB2,BW] 502-15-517ms   | [S7,MB6,F]  517-15-532ms   | [S7,MB6,BI] 532-15-547ms   | [S3,MB3,BW] 547-15-562ms   | [S7,MB7,F]  562-15-578ms   | [S7,MB7,BI] 578-15-593ms   | [S7,MB4,BW] 593-15-608ms   | [S3,MB4,BI] 608-15-623ms   | [S7,MB5,BW] 623-15-639ms   | [S3,MB5,BI] 639-15-654ms   | [S7,MB6,BW] 654-15-669ms   | [S3,MB6,BI] 669-15-684ms   | [S7,MB7,BW] 684-15-699ms   | [S3,MB7,BI] 699-15-715ms   | [S3,MB4,BW] 715-15-730ms   | [S3,MB5,BW] 730-15-745ms   | [S3,MB6,BW] 745-15-760ms   | [S3,MB7,BW] 760-15-775ms  
[rank3]:2026-01-01 19:35:52,449 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1935_stage3_final800.svg
[rank3]:2026-01-01 19:35:52,495 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/260101_1935_stage7_final800.svg
[rank3]:2026-01-01 19:35:52,625 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank3_stage3.svg
[rank3]:	> Counts Sum: 1596, Total Sum: 2100 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank3]:2026-01-01 19:35:52,714 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1/frozen_params_histogram/260101_1935_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 1050 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 19:35:52,715 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 389-411
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‡â–…â–‚â–„â–…â–â–‚â–„â–„â–…â–‚â–„â–†â–…â–‚â–ƒ
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.64122
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 16.23701
[rank3]:wandb:             final/avg_tflops 55.19353
[rank3]:wandb:    final/avg_throughput(tps) 7060.21711
[rank3]:wandb:              final/grad_norm 4.96935
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 4.96935
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_InterleavedZeroBubble_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/pat9fubh
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_InterleavedZeroBubble_auto_42_dm1/20260101-1830/wandb/run-20260101_183003-pat9fubh/logs
[rank3]:2026-01-01 19:35:53,804 - Process group destroyed
[rank0]:2026-01-01 19:35:54,095 - Training completed
[rank0]:2026-01-01 19:35:54,095 - Destroying the purge thread.
[rank0]:2026-01-01 19:35:54,321 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: InterleavedZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_InterleavedZeroBubble_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
