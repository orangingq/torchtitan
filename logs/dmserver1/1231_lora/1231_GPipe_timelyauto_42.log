
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 21:37:02 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_GPipe_timelyauto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-31 21:37:10,282 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2025-12-31 21:37:10,268 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank1]:2025-12-31 21:37:10,398 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank3]:2025-12-31 21:37:10,511 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 21:37:10,513 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-31 21:37:10,502 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 21:37:10,504 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-31 21:37:10,625 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 21:37:10,627 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 21:37:10,637 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank0]:2025-12-31 21:37:10,801 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 21:37:10,803 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 21:37:10,807 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 21:37:10,808 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-31 21:37:11,188 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-31 21:37:13,778 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 21:37:13,816 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 21:37:13,842 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-31 21:37:13,842 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-31 21:37:13,982 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 21:37:14,028 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 21:37:14,048 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank2]:2025-12-31 21:37:14,030 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 21:37:14,030 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 21:37:14,048 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-31 21:37:14,031 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-31 21:37:14,145 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-31 21:37:14,292 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 21:37:14,240 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 21:37:14,240 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 21:37:14,240 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-31 21:37:14,330 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 21:37:14,331 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 21:37:14,355 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-31 21:37:14,355 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-31 21:37:14,552 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 21:37:14,552 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 21:37:14,553 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run r86pdenw
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_GPipe_timelyauto_42_dm1/20251231-2137/wandb/run-20251231_213715-r86pdenw
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_GPipe_timelyauto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/r86pdenw
[rank3]:2025-12-31 21:37:16,343 - WandB logging enabled
[rank3]:2025-12-31 21:37:16,343 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 21:37:16,382 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 21:37:16,411 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-31 21:37:16,411 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-31 21:37:16,597 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 21:37:16,598 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 21:37:16,599 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-12-31 21:37:16,614 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-31 21:37:16,613 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-31 21:37:16,613 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 21:37:16,614 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_GPipe_timelyauto_42_dm1
[rank0]:2025-12-31 21:37:16,614 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 21:37:16,614 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 21:37:16,614 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-31 21:37:19,176 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 21:37:19,177 - Finished loading the checkpoint in 2.56 seconds.
[rank3]:2025-12-31 21:37:19,238 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2025-12-31 21:37:19,239 - Freezable Parameters: [Stage 3] 42 params
[rank1]:2025-12-31 21:37:19,234 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2025-12-31 21:37:19,234 - Freezable Parameters: [Stage 1] 70 params
[rank2]:2025-12-31 21:37:19,223 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2025-12-31 21:37:19,224 - Freezable Parameters: [Stage 2] 56 params
[rank0]:2025-12-31 21:37:19,222 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2025-12-31 21:37:19,222 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2025-12-31 21:37:19,223 - Training starts at step 1
[rank1]:2025-12-31 21:37:24,282 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 17.18GiB(36.17%)  tps: 3,196  tflops: 24.98  mfu: 8.01%
[rank1]:2025-12-31 21:37:24,283 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 21:37:24,260 -  step:  1  loss: 10.6088  grad_norm:  5.6782  memory: 29.95GiB(63.04%)  tps: 4,161  tflops: 32.53  mfu: 10.43%
[rank3]:2025-12-31 21:37:24,261 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 21:37:24,256 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 13.85GiB(29.15%)  tps: 3,139  tflops: 24.54  mfu: 7.87%
[rank2]:2025-12-31 21:37:24,256 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 21:37:24,288 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 14.51GiB(30.55%)  tps: 3,291  tflops: 25.73  mfu: 8.25%
[rank0]:2025-12-31 21:37:24,288 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 21:38:59,873 - Avg. fwd time: 12.2576 / Avg. bwd time: 12.9213 / Avg. batch time: 424.7976 (ms) / GPU bubble ratio: 52.58%
[rank1]:2025-12-31 21:38:59,897 - Avg. fwd time: 15.4838 / Avg. bwd time: 16.4370 / Avg. batch time: 461.3621 (ms) / GPU bubble ratio: 44.65%
[rank3]:2025-12-31 21:38:59,854 - Avg. fwd time: 16.6207 / Avg. bwd time: 25.2562 / Avg. batch time: 395.1739 (ms) / GPU bubble ratio: 15.22%
[rank0]:2025-12-31 21:38:59,914 - Avg. fwd time: 13.4223 / Avg. bwd time: 12.2945 / Avg. batch time: 492.0258 (ms) / GPU bubble ratio: 58.19%
[rank0]:2025-12-31 21:40:36,063 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 21:40:39,975 - Avg. fwd time: 16.6565 / Avg. bwd time: 25.3557 / Avg. batch time: 395.9284 (ms) / GPU bubble ratio: 15.11%
[rank1]:2025-12-31 21:40:40,018 - Avg. fwd time: 15.5072 / Avg. bwd time: 16.4587 / Avg. batch time: 461.1285 (ms) / GPU bubble ratio: 44.54%
[rank1]:2025-12-31 21:40:40,039 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 17.18GiB(36.17%)  tps: 8,202  tflops: 64.12  mfu: 20.55%
[rank2]:2025-12-31 21:40:39,994 - Avg. fwd time: 12.2680 / Avg. bwd time: 12.9370 / Avg. batch time: 425.0459 (ms) / GPU bubble ratio: 52.56%
[rank2]:2025-12-31 21:40:40,039 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 13.85GiB(29.15%)  tps: 8,201  tflops: 64.11  mfu: 20.55%
[rank3]:2025-12-31 21:40:40,040 -  step: 50  loss: 12.4620  grad_norm:  4.3533  memory: 29.95GiB(63.04%)  tps: 8,201  tflops: 64.11  mfu: 20.55%
[rank0]:2025-12-31 21:40:40,036 - Avg. fwd time: 13.4106 / Avg. bwd time: 12.3098 / Avg. batch time: 491.3822 (ms) / GPU bubble ratio: 58.13%
[rank0]:2025-12-31 21:40:40,039 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 14.51GiB(30.55%)  tps: 8,202  tflops: 64.12  mfu: 20.55%
[rank3]:2025-12-31 21:41:15,992 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-31 21:41:56,113 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-31 21:41:56,218 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-31 21:42:19,280 - Avg. fwd time: 12.2734 / Avg. bwd time: 12.8521 / Avg. batch time: 424.4212 (ms) / GPU bubble ratio: 52.64%
[rank3]:2025-12-31 21:42:19,262 - Avg. fwd time: 16.6665 / Avg. bwd time: 25.3147 / Avg. batch time: 395.5655 (ms) / GPU bubble ratio: 15.10%
[rank1]:2025-12-31 21:42:19,300 - Avg. fwd time: 15.5203 / Avg. bwd time: 16.3722 / Avg. batch time: 460.3776 (ms) / GPU bubble ratio: 44.58%
[rank0]:2025-12-31 21:42:19,305 - Avg. fwd time: 13.4236 / Avg. bwd time: 11.3291 / Avg. batch time: 489.5480 (ms) / GPU bubble ratio: 59.55%
[rank3]:2025-12-31 21:42:34,538 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-31 21:42:34,793 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2142_max_batch_time.svg
[rank3]:			> Batch Time: 423.12 ms, GPU Bubble Ratio: 51.16%, 39.23%, 52.14%, 19.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  230-12-242ms   | [S0,MB1,B]  255-12-268ms   | [S0,MB2,B]  281-12-293ms   | [S0,MB3,B]  307-12-319ms   | [S0,MB4,B]  332-12-345ms   | [S0,MB5,B]  358-12-371ms   | [S0,MB6,B]  384-12-396ms   | [S0,MB7,B]  410-12-423ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-44ms     | [S1,MB2,F]  44-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-139ms   | [S1,MB0,B]  214-16-230ms   | [S1,MB1,B]  239-16-255ms   | [S1,MB2,B]  264-16-281ms   | [S1,MB3,B]  290-16-307ms   | [S1,MB4,B]  316-16-332ms   | [S1,MB5,B]  342-16-358ms   | [S1,MB6,B]  367-16-384ms   | [S1,MB7,B]  393-16-410ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  44-12-57ms     | [S2,MB2,F]  60-12-73ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-120ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  139-12-151ms   | [S2,MB0,B]  201-13-214ms   | [S2,MB1,B]  226-13-239ms   | [S2,MB2,B]  251-12-264ms   | [S2,MB3,B]  277-12-290ms   | [S2,MB4,B]  303-12-316ms   | [S2,MB5,B]  329-12-342ms   | [S2,MB6,B]  354-13-367ms   | [S2,MB7,B]  380-13-393ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-16-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-25-201ms   AFR(10):0.9762 | [S3,MB1,B]  201-25-226ms   AFR(10):0.9762 | [S3,MB2,B]  226-25-251ms   AFR(10):0.9762 | [S3,MB3,B]  251-25-277ms   AFR(10):0.9762 | [S3,MB4,B]  277-25-303ms   AFR(10):0.9762 | [S3,MB5,B]  303-25-329ms   AFR(10):0.9762 | [S3,MB6,B]  329-25-354ms   AFR(10):0.9762 | [S3,MB7,B]  354-26-380ms   AFR(10):0.9762
[rank3]:2025-12-31 21:42:34,919 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2142_min_batch_time.svg
[rank3]:			> Batch Time: 399.03 ms, GPU Bubble Ratio: 73.00%, 38.66%, 51.64%, 17.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  226-0-226ms    | [S0,MB1,B]  251-0-251ms    | [S0,MB2,B]  275-0-275ms    | [S0,MB3,B]  299-0-299ms    | [S0,MB4,B]  324-0-324ms    | [S0,MB5,B]  349-0-349ms    | [S0,MB6,B]  374-0-374ms    | [S0,MB7,B]  399-0-399ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-44ms     | [S1,MB2,F]  44-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-139ms   | [S1,MB0,B]  211-14-226ms   | [S1,MB1,B]  236-14-251ms   | [S1,MB2,B]  260-14-275ms   | [S1,MB3,B]  284-14-299ms   | [S1,MB4,B]  309-15-324ms   | [S1,MB5,B]  334-15-349ms   | [S1,MB6,B]  359-15-374ms   | [S1,MB7,B]  383-15-399ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  44-12-57ms     | [S2,MB2,F]  60-12-73ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-120ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  139-12-151ms   | [S2,MB0,B]  199-11-211ms   | [S2,MB1,B]  224-11-236ms   | [S2,MB2,B]  248-11-260ms   | [S2,MB3,B]  273-11-284ms   | [S2,MB4,B]  297-11-309ms   | [S2,MB5,B]  322-11-334ms   | [S2,MB6,B]  347-11-359ms   | [S2,MB7,B]  372-11-383ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-16-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-23-199ms   AFR(10):0.9762 | [S3,MB1,B]  199-24-224ms   AFR(10):0.9762 | [S3,MB2,B]  224-24-248ms   AFR(10):0.9762 | [S3,MB3,B]  248-24-273ms   AFR(10):0.9762 | [S3,MB4,B]  273-24-297ms   AFR(10):0.9762 | [S3,MB5,B]  297-24-322ms   AFR(10):0.9762 | [S3,MB6,B]  322-24-347ms   AFR(10):0.9762 | [S3,MB7,B]  347-24-372ms   AFR(10):0.9762
[rank3]:2025-12-31 21:42:35,063 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2142_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 400.32 ms, GPU Bubble Ratio: 51.45%, 36.21%, 49.72%, 17.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  229-12-241ms   | [S0,MB1,B]  254-12-266ms   | [S0,MB2,B]  278-12-291ms   | [S0,MB3,B]  303-12-315ms   | [S0,MB4,B]  327-12-340ms   | [S0,MB5,B]  352-12-364ms   | [S0,MB6,B]  378-12-390ms   | [S0,MB7,B]  400-0-400ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-44ms     | [S1,MB2,F]  44-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-139ms   | [S1,MB0,B]  212-16-229ms   | [S1,MB1,B]  237-16-254ms   | [S1,MB2,B]  262-16-278ms   | [S1,MB3,B]  286-16-303ms   | [S1,MB4,B]  311-16-327ms   | [S1,MB5,B]  335-16-352ms   | [S1,MB6,B]  361-16-378ms   | [S1,MB7,B]  385-15-400ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  44-12-57ms     | [S2,MB2,F]  60-12-73ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-120ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  139-12-151ms   | [S2,MB0,B]  199-13-212ms   | [S2,MB1,B]  224-13-237ms   | [S2,MB2,B]  249-12-262ms   | [S2,MB3,B]  273-12-286ms   | [S2,MB4,B]  298-12-311ms   | [S2,MB5,B]  322-12-335ms   | [S2,MB6,B]  348-13-361ms   | [S2,MB7,B]  373-11-385ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-16-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-23-199ms   AFR(10):0.9762 | [S3,MB1,B]  199-24-224ms   AFR(10):0.9762 | [S3,MB2,B]  224-24-249ms   AFR(10):0.9762 | [S3,MB3,B]  249-24-273ms   AFR(10):0.9762 | [S3,MB4,B]  273-24-298ms   AFR(10):0.9762 | [S3,MB5,B]  298-24-322ms   AFR(10):0.9762 | [S3,MB6,B]  322-25-348ms   AFR(10):0.9762 | [S3,MB7,B]  348-24-373ms   AFR(10):0.9762
[rank3]:2025-12-31 21:42:35,064 - 	> Batch Time: 400.32 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.05)
[rank2]:2025-12-31 21:43:54,775 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank3]:2025-12-31 21:43:54,778 - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-12-31 21:43:54,779 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank0]:2025-12-31 21:43:54,776 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 21:43:54,780 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank3]:2025-12-31 21:43:58,742 - Avg. fwd time: 16.6742 / Avg. bwd time: 25.2245 / Avg. batch time: 394.8494 (ms) / GPU bubble ratio: 15.11%
[rank3]:2025-12-31 21:43:58,810 -  step: 100  loss: 13.1172  grad_norm:  3.2841  memory: 29.95GiB(63.04%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank2]:2025-12-31 21:43:58,760 - Avg. fwd time: 12.2763 / Avg. bwd time: 12.8149 / Avg. batch time: 423.8984 (ms) / GPU bubble ratio: 52.65%
[rank2]:2025-12-31 21:43:58,808 -  step: 100  loss: -8.0000  grad_norm:  3.2841  memory: 13.85GiB(29.15%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank1]:2025-12-31 21:43:58,788 - Avg. fwd time: 15.5413 / Avg. bwd time: 16.5422 / Avg. batch time: 461.2553 (ms) / GPU bubble ratio: 44.35%
[rank1]:2025-12-31 21:43:58,808 -  step: 100  loss: -8.0000  grad_norm:  3.2841  memory: 17.18GiB(36.17%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank0]:2025-12-31 21:43:58,805 - Avg. fwd time: 13.4258 / Avg. bwd time: 10.9267 / Avg. batch time: 488.9089 (ms) / GPU bubble ratio: 60.15%
[rank0]:2025-12-31 21:43:58,808 -  step: 100  loss: -8.0000  grad_norm:  3.2841  memory: 14.51GiB(30.55%)  tps: 8,243  tflops: 64.44  mfu: 20.65%
[rank2]:2025-12-31 21:43:58,869 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2143_stage2_step100.svg
[rank1]:2025-12-31 21:43:58,869 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2143_stage1_step100.svg
[rank0]:2025-12-31 21:43:58,869 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2143_stage0_step100.svg
[rank3]:2025-12-31 21:43:58,948 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2143_step100_rank3.svg
[rank3]:			> Batch Time: 496.17 ms, GPU Bubble Ratio: 58.55%, 46.91%, 59.35%, 32.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  79-12-92ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-312ms   | [S0,MB1,B]  325-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  401-12-413ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  454-12-467ms   | [S0,MB7,B]  484-11-496ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  51-15-66ms     | [S1,MB3,F]  72-15-87ms     | [S1,MB4,F]  96-15-111ms    | [S1,MB5,F]  120-15-135ms   | [S1,MB6,F]  144-15-159ms   | [S1,MB7,F]  168-15-184ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-347ms   | [S1,MB3,B]  356-16-372ms   | [S1,MB4,B]  381-16-397ms   | [S1,MB5,B]  406-16-423ms   | [S1,MB6,B]  432-17-449ms   | [S1,MB7,B]  455-23-478ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  47-12-60ms     | [S2,MB2,F]  68-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  165-12-178ms   | [S2,MB7,F]  189-12-201ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  314-12-327ms   | [S2,MB3,B]  339-12-352ms   | [S2,MB4,B]  364-13-377ms   | [S2,MB5,B]  390-12-403ms   | [S2,MB6,B]  416-13-429ms   | [S2,MB7,B]  439-12-451ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  65-16-82ms     | [S3,MB2,F]  89-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  186-16-203ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  233-24-258ms   | [S3,MB1,B]  258-25-283ms   | [S3,MB2,B]  283-25-308ms   | [S3,MB3,B]  308-25-333ms   | [S3,MB4,B]  333-25-358ms   | [S3,MB5,B]  358-25-383ms   | [S3,MB6,B]  383-26-409ms   | [S3,MB7,B]  409-25-435ms  
[rank3]:2025-12-31 21:43:58,990 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2143_stage3_step100.svg
[rank0]:2025-12-31 21:43:59,040 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2143_rank0_stage0.svg
[rank0]:	> Counts Sum: 41520, Total Sum: 107520 (38.62%), Ratio(%) per element: [37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5]
[rank1]:2025-12-31 21:43:59,055 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2143_rank1_stage1.svg
[rank1]:	> Counts Sum: 51920, Total Sum: 134400 (38.63%), Ratio(%) per element: [37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5]
[rank2]:2025-12-31 21:43:59,041 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2143_rank2_stage2.svg
[rank2]:	> Counts Sum: 41520, Total Sum: 107520 (38.62%), Ratio(%) per element: [41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5]
[rank0]:2025-12-31 21:43:59,129 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2143_stage0.svg
[rank3]:2025-12-31 21:43:59,132 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2143_rank3_stage3.svg
[rank3]:	> Counts Sum: 53360, Total Sum: 80640 (66.17%), Ratio(%) per element: [79.16, 75.0, 75.0, 66.66, 66.66, 75.0, 66.66, 62.5, 75.0, 70.83, 66.66, 70.83, 62.5, 66.66, 66.66, 79.16, 62.5, 62.5, 66.66, 70.83, 83.33, 70.83, 70.83, 70.83, 79.16, 70.83, 62.5, 66.66, 62.5, 58.33, 54.16, 54.16, 62.5, 58.33, 58.33, 62.5, 58.33, 62.5, 50.0, 58.33, 58.33, 58.33]
[rank3]:2025-12-31 21:43:59,222 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2143_stage3.svg
[rank1]:2025-12-31 21:43:59,143 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2143_stage1.svg
[rank2]:2025-12-31 21:43:59,133 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2143_stage2.svg
[rank2]:2025-12-31 21:45:40,060 - Avg. fwd time: 12.2786 / Avg. bwd time: 12.8378 / Avg. batch time: 423.8065 (ms) / GPU bubble ratio: 52.59%
[rank3]:2025-12-31 21:45:40,038 - Avg. fwd time: 16.6807 / Avg. bwd time: 25.2238 / Avg. batch time: 394.8597 (ms) / GPU bubble ratio: 15.10%
[rank0]:2025-12-31 21:45:40,104 - Avg. fwd time: 13.4321 / Avg. bwd time: 11.1833 / Avg. batch time: 490.0311 (ms) / GPU bubble ratio: 59.81%
[rank1]:2025-12-31 21:45:40,086 - Avg. fwd time: 15.5431 / Avg. bwd time: 16.7016 / Avg. batch time: 462.0492 (ms) / GPU bubble ratio: 44.17%
[rank3]:2025-12-31 21:47:16,165 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-12-31 21:47:16,182 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-12-31 21:47:16,164 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank0]:2025-12-31 21:47:16,174 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 21:47:16,178 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-12-31 21:47:20,169 - Avg. fwd time: 16.6826 / Avg. bwd time: 25.1949 / Avg. batch time: 394.6211 (ms) / GPU bubble ratio: 15.10%
[rank2]:2025-12-31 21:47:20,187 - Avg. fwd time: 12.2801 / Avg. bwd time: 12.8448 / Avg. batch time: 423.4030 (ms) / GPU bubble ratio: 52.53%
[rank0]:2025-12-31 21:47:20,232 - Avg. fwd time: 13.4336 / Avg. bwd time: 11.2659 / Avg. batch time: 490.0057 (ms) / GPU bubble ratio: 59.67%
[rank0]:2025-12-31 21:47:20,236 -  step: 150  loss: -8.0000  grad_norm:  4.1207  memory: 14.51GiB(30.55%)  tps: 8,134  tflops: 63.59  mfu: 20.38%
[rank3]:2025-12-31 21:47:20,238 -  step: 150  loss: 11.1241  grad_norm:  4.1207  memory: 29.95GiB(63.04%)  tps: 8,134  tflops: 63.59  mfu: 20.38%
[rank1]:2025-12-31 21:47:20,214 - Avg. fwd time: 15.5437 / Avg. bwd time: 16.8435 / Avg. batch time: 462.5027 (ms) / GPU bubble ratio: 43.98%
[rank1]:2025-12-31 21:47:20,235 -  step: 150  loss: -8.0000  grad_norm:  4.1207  memory: 17.18GiB(36.17%)  tps: 8,134  tflops: 63.59  mfu: 20.38%
[rank2]:2025-12-31 21:47:20,235 -  step: 150  loss: -8.0000  grad_norm:  4.1207  memory: 13.85GiB(29.15%)  tps: 8,134  tflops: 63.59  mfu: 20.38%
[rank1]:2025-12-31 21:49:00,383 - Avg. fwd time: 15.5428 / Avg. bwd time: 16.8953 / Avg. batch time: 462.3958 (ms) / GPU bubble ratio: 43.88%
[rank2]:2025-12-31 21:49:00,357 - Avg. fwd time: 12.2807 / Avg. bwd time: 12.8457 / Avg. batch time: 423.0641 (ms) / GPU bubble ratio: 52.49%
[rank3]:2025-12-31 21:49:00,337 - Avg. fwd time: 16.6922 / Avg. bwd time: 25.1625 / Avg. batch time: 394.4242 (ms) / GPU bubble ratio: 15.11%
[rank0]:2025-12-31 21:49:00,395 - Avg. fwd time: 13.4336 / Avg. bwd time: 11.3783 / Avg. batch time: 489.9583 (ms) / GPU bubble ratio: 59.49%
[rank2]:2025-12-31 21:50:35,450 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:50:35,452 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-31 21:50:35,458 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-31 21:50:35,448 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 21:50:35,452 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:50:39,364 - Avg. fwd time: 16.6978 / Avg. bwd time: 25.1179 / Avg. batch time: 394.1030 (ms) / GPU bubble ratio: 15.12%
[rank2]:2025-12-31 21:50:39,383 - Avg. fwd time: 12.2813 / Avg. bwd time: 12.8435 / Avg. batch time: 422.6111 (ms) / GPU bubble ratio: 52.44%
[rank2]:2025-12-31 21:50:39,418 -  step: 200  loss: -8.0000  grad_norm: 17.1685  memory: 13.85GiB(29.15%)  tps: 8,226  tflops: 64.30  mfu: 20.61%
[rank2]:2025-12-31 21:50:39,471 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2150_stage2_step200.svg
[rank3]:2025-12-31 21:50:39,421 -  step: 200  loss: 10.2906  grad_norm: 17.1685  memory: 29.95GiB(63.04%)  tps: 8,226  tflops: 64.30  mfu: 20.61%
[rank1]:2025-12-31 21:50:39,409 - Avg. fwd time: 15.5426 / Avg. bwd time: 16.9639 / Avg. batch time: 462.3647 (ms) / GPU bubble ratio: 43.76%
[rank1]:2025-12-31 21:50:39,418 -  step: 200  loss: -8.0000  grad_norm: 17.1685  memory: 17.18GiB(36.17%)  tps: 8,226  tflops: 64.30  mfu: 20.61%
[rank1]:2025-12-31 21:50:39,470 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2150_stage1_step200.svg
[rank0]:2025-12-31 21:50:39,415 - Avg. fwd time: 13.4361 / Avg. bwd time: 11.3688 / Avg. batch time: 489.2530 (ms) / GPU bubble ratio: 59.44%
[rank0]:2025-12-31 21:50:39,419 -  step: 200  loss: -8.0000  grad_norm: 17.1685  memory: 14.51GiB(30.55%)  tps: 8,226  tflops: 64.30  mfu: 20.61%
[rank0]:2025-12-31 21:50:39,471 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2150_stage0_step200.svg
[rank3]:2025-12-31 21:50:39,560 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2150_step200_rank3.svg
[rank3]:			> Batch Time: 480.75 ms, GPU Bubble Ratio: 59.17%, 45.45%, 58.23%, 31.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  374-12-387ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  424-12-436ms   | [S0,MB6,B]  454-12-466ms   | [S0,MB7,B]  478-2-480ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  145-15-160ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-346ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  379-16-395ms   | [S1,MB5,B]  404-16-420ms   | [S1,MB6,B]  429-19-449ms   | [S1,MB7,B]  454-19-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  362-12-375ms   | [S2,MB5,B]  387-12-400ms   | [S2,MB6,B]  413-12-426ms   | [S2,MB7,B]  434-11-446ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-283ms   | [S3,MB2,B]  283-24-307ms   | [S3,MB3,B]  307-24-331ms   | [S3,MB4,B]  331-24-356ms   | [S3,MB5,B]  356-24-381ms   | [S3,MB6,B]  381-25-406ms   | [S3,MB7,B]  406-24-431ms  
[rank2]:2025-12-31 21:50:39,640 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2150_rank2_stage2.svg
[rank2]:	> Counts Sum: 69920, Total Sum: 465920 (15.01%), Ratio(%) per element: [17.3, 18.26, 17.3, 17.3, 18.26, 16.34, 18.26, 15.38, 15.38, 17.3, 17.3, 17.3, 16.34, 16.34, 17.3, 15.38, 17.3, 16.34, 15.38, 18.26, 16.34, 18.26, 17.3, 16.34, 18.26, 18.26, 14.42, 18.26, 16.34, 14.42, 16.34, 15.38, 14.42, 14.42, 14.42, 13.46, 14.42, 13.46, 11.53, 13.46, 13.46, 12.5, 12.5, 10.57, 14.42, 12.5, 13.46, 11.53, 10.57, 11.53, 12.5, 10.57, 11.53, 12.5, 11.53, 10.57]
[rank3]:2025-12-31 21:50:39,605 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2150_stage3_step200.svg
[rank1]:2025-12-31 21:50:39,649 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2150_rank1_stage1.svg
[rank1]:	> Counts Sum: 87360, Total Sum: 582400 (15.00%), Ratio(%) per element: [18.26, 18.26, 19.23, 18.26, 19.23, 18.26, 17.3, 17.3, 18.26, 18.26, 18.26, 19.23, 18.26, 18.26, 18.26, 16.34, 17.3, 17.3, 18.26, 17.3, 16.34, 16.34, 16.34, 17.3, 17.3, 17.3, 15.38, 15.38, 12.5, 14.42, 13.46, 15.38, 13.46, 13.46, 13.46, 14.42, 13.46, 11.53, 17.3, 14.42, 13.46, 14.42, 13.46, 13.46, 12.5, 11.53, 13.46, 12.5, 13.46, 12.5, 12.5, 14.42, 12.5, 12.5, 13.46, 11.53, 12.5, 12.5, 13.46, 14.42, 13.46, 12.5, 12.5, 10.57, 12.5, 13.46, 11.53, 16.34, 11.53, 14.42]
[rank0]:2025-12-31 21:50:39,639 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2150_rank0_stage0.svg
[rank0]:	> Counts Sum: 69920, Total Sum: 465920 (15.01%), Ratio(%) per element: [15.38, 16.34, 15.38, 17.3, 18.26, 17.3, 17.3, 18.26, 17.3, 15.38, 16.34, 17.3, 17.3, 16.34, 17.3, 18.26, 16.34, 17.3, 16.34, 17.3, 15.38, 15.38, 16.34, 18.26, 17.3, 18.26, 18.26, 18.26, 14.42, 13.46, 13.46, 15.38, 12.5, 14.42, 12.5, 15.38, 13.46, 11.53, 13.46, 12.5, 12.5, 12.5, 13.46, 11.53, 13.46, 11.53, 12.5, 11.53, 13.46, 13.46, 10.57, 14.42, 13.46, 14.42, 11.53, 11.53]
[rank3]:2025-12-31 21:50:39,744 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2150_rank3_stage3.svg
[rank3]:	> Counts Sum: 189600, Total Sum: 349440 (54.26%), Ratio(%) per element: [67.3, 68.26, 65.38, 63.46, 64.42, 63.46, 67.3, 63.46, 65.38, 64.42, 65.38, 66.34, 56.73, 63.46, 55.76, 62.5, 54.8, 61.53, 57.69, 62.5, 59.61, 64.42, 66.34, 59.61, 63.46, 61.53, 62.5, 55.76, 34.61, 33.65, 37.5, 40.38, 42.3, 38.46, 36.53, 40.38, 34.61, 40.38, 35.57, 39.42, 36.53, 35.57]
[rank0]:2025-12-31 21:50:39,984 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2150_stage0.svg
[rank2]:2025-12-31 21:50:39,990 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2150_stage2.svg
[rank1]:2025-12-31 21:50:39,991 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2150_stage1.svg
[rank3]:2025-12-31 21:50:40,084 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2150_stage3.svg
[rank2]:2025-12-31 21:52:17,841 - Avg. fwd time: 12.2815 / Avg. bwd time: 12.8398 / Avg. batch time: 422.2233 (ms) / GPU bubble ratio: 52.40%
[rank3]:2025-12-31 21:52:17,822 - Avg. fwd time: 16.7027 / Avg. bwd time: 25.0765 / Avg. batch time: 393.8002 (ms) / GPU bubble ratio: 15.13%
[rank0]:2025-12-31 21:52:17,876 - Avg. fwd time: 13.4394 / Avg. bwd time: 11.3053 / Avg. batch time: 488.0845 (ms) / GPU bubble ratio: 59.44%
[rank1]:2025-12-31 21:52:17,869 - Avg. fwd time: 15.5501 / Avg. bwd time: 16.9909 / Avg. batch time: 462.1778 (ms) / GPU bubble ratio: 43.67%
[rank2]:2025-12-31 21:53:51,720 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:53:51,721 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-31 21:53:51,743 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-31 21:53:51,726 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 21:53:51,730 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-31 21:53:55,594 - Avg. fwd time: 12.2820 / Avg. bwd time: 12.8374 / Avg. batch time: 421.8077 (ms) / GPU bubble ratio: 52.36%
[rank3]:2025-12-31 21:53:55,575 - Avg. fwd time: 16.7009 / Avg. bwd time: 25.0395 / Avg. batch time: 393.4813 (ms) / GPU bubble ratio: 15.14%
[rank1]:2025-12-31 21:53:55,623 - Avg. fwd time: 15.5575 / Avg. bwd time: 17.0150 / Avg. batch time: 461.9446 (ms) / GPU bubble ratio: 43.59%
[rank1]:2025-12-31 21:53:55,633 -  step: 250  loss: -8.0000  grad_norm:  2.9426  memory: 17.18GiB(36.17%)  tps: 8,350  tflops: 65.28  mfu: 20.92%
[rank0]:2025-12-31 21:53:55,630 - Avg. fwd time: 13.4416 / Avg. bwd time: 11.2547 / Avg. batch time: 487.0645 (ms) / GPU bubble ratio: 59.44%
[rank0]:2025-12-31 21:53:55,634 -  step: 250  loss: -8.0000  grad_norm:  2.9426  memory: 14.51GiB(30.55%)  tps: 8,350  tflops: 65.28  mfu: 20.92%
[rank2]:2025-12-31 21:53:55,633 -  step: 250  loss: -8.0000  grad_norm:  2.9426  memory: 13.85GiB(29.15%)  tps: 8,350  tflops: 65.28  mfu: 20.92%
[rank3]:2025-12-31 21:53:55,636 -  step: 250  loss: 12.5257  grad_norm:  2.9426  memory: 29.95GiB(63.04%)  tps: 8,350  tflops: 65.28  mfu: 20.92%
[rank3]:2025-12-31 21:55:33,962 - Avg. fwd time: 16.7017 / Avg. bwd time: 25.0133 / Avg. batch time: 393.2730 (ms) / GPU bubble ratio: 15.14%
[rank2]:2025-12-31 21:55:33,983 - Avg. fwd time: 12.2827 / Avg. bwd time: 12.8362 / Avg. batch time: 421.5242 (ms) / GPU bubble ratio: 52.33%
[rank0]:2025-12-31 21:55:34,018 - Avg. fwd time: 13.4510 / Avg. bwd time: 11.2139 / Avg. batch time: 486.5020 (ms) / GPU bubble ratio: 59.44%
[rank1]:2025-12-31 21:55:34,010 - Avg. fwd time: 15.5684 / Avg. bwd time: 17.0649 / Avg. batch time: 462.0181 (ms) / GPU bubble ratio: 43.49%
[rank2]:2025-12-31 21:57:08,148 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-31 21:57:08,143 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 21:57:08,147 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:57:08,150 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-31 21:57:08,158 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-31 21:57:12,064 - Avg. fwd time: 13.4519 / Avg. bwd time: 11.1792 / Avg. batch time: 485.9092 (ms) / GPU bubble ratio: 59.45%
[rank0]:2025-12-31 21:57:12,068 -  step: 300  loss: -8.0000  grad_norm:  3.1026  memory: 14.51GiB(30.55%)  tps: 8,341  tflops: 65.20  mfu: 20.90%
[rank2]:2025-12-31 21:57:12,030 - Avg. fwd time: 12.2833 / Avg. bwd time: 12.8354 / Avg. batch time: 421.2471 (ms) / GPU bubble ratio: 52.30%
[rank2]:2025-12-31 21:57:12,068 -  step: 300  loss: -8.0000  grad_norm:  3.1026  memory: 13.85GiB(29.15%)  tps: 8,341  tflops: 65.20  mfu: 20.90%
[rank3]:2025-12-31 21:57:12,010 - Avg. fwd time: 16.7009 / Avg. bwd time: 24.9880 / Avg. batch time: 393.0596 (ms) / GPU bubble ratio: 15.15%
[rank3]:2025-12-31 21:57:12,071 -  step: 300  loss: 12.9454  grad_norm:  3.1026  memory: 29.95GiB(63.04%)  tps: 8,341  tflops: 65.20  mfu: 20.90%
[rank1]:2025-12-31 21:57:12,057 - Avg. fwd time: 15.5748 / Avg. bwd time: 17.0960 / Avg. batch time: 461.9744 (ms) / GPU bubble ratio: 43.42%
[rank1]:2025-12-31 21:57:12,068 -  step: 300  loss: -8.0000  grad_norm:  3.1026  memory: 17.18GiB(36.17%)  tps: 8,341  tflops: 65.20  mfu: 20.90%
[rank1]:2025-12-31 21:57:12,118 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2157_stage1_step300.svg
[rank0]:2025-12-31 21:57:12,119 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2157_stage0_step300.svg
[rank2]:2025-12-31 21:57:12,120 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2157_stage2_step300.svg
[rank0]:2025-12-31 21:57:12,291 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2157_rank0_stage0.svg
[rank0]:	> Counts Sum: 114720, Total Sum: 824320 (13.92%), Ratio(%) per element: [14.13, 14.67, 14.13, 15.21, 15.76, 15.21, 15.21, 15.76, 15.21, 14.13, 14.67, 15.21, 15.21, 14.67, 15.21, 15.76, 14.67, 15.21, 14.67, 15.21, 14.13, 14.13, 14.67, 15.76, 15.21, 15.76, 15.76, 15.76, 13.58, 13.04, 13.04, 14.13, 12.5, 13.58, 12.5, 14.13, 13.04, 11.95, 13.04, 12.5, 12.5, 12.5, 13.04, 11.95, 13.04, 11.95, 12.5, 11.95, 13.04, 13.04, 11.41, 13.58, 13.04, 13.58, 11.95, 11.95]
[rank2]:2025-12-31 21:57:12,293 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2157_rank2_stage2.svg
[rank2]:	> Counts Sum: 114720, Total Sum: 824320 (13.92%), Ratio(%) per element: [15.21, 15.76, 15.21, 15.21, 15.76, 14.67, 15.76, 14.13, 14.13, 15.21, 15.21, 15.21, 14.67, 14.67, 15.21, 14.13, 15.21, 14.67, 14.13, 15.76, 14.67, 15.76, 15.21, 14.67, 15.76, 15.76, 13.58, 15.76, 14.67, 13.58, 14.67, 14.13, 13.58, 13.58, 13.58, 13.04, 13.58, 13.04, 11.95, 13.04, 13.04, 12.5, 12.5, 11.41, 13.58, 12.5, 13.04, 11.95, 11.41, 11.95, 12.5, 11.41, 11.95, 12.5, 11.95, 11.41]
[rank3]:2025-12-31 21:57:12,211 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2157_step300_rank3.svg
[rank3]:			> Batch Time: 478.50 ms, GPU Bubble Ratio: 59.47%, 45.08%, 58.00%, 30.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-14-80ms     | [S0,MB6,F]  80-12-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-314ms   | [S0,MB1,B]  326-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  456-12-468ms   | [S0,MB7,B]  478-0-478ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  121-15-136ms   | [S1,MB6,F]  145-15-161ms   | [S1,MB7,F]  170-15-185ms   | [S1,MB0,B]  282-16-298ms   | [S1,MB1,B]  306-16-323ms   | [S1,MB2,B]  330-16-346ms   | [S1,MB3,B]  355-16-371ms   | [S1,MB4,B]  379-16-395ms   | [S1,MB5,B]  403-16-420ms   | [S1,MB6,B]  430-20-450ms   | [S1,MB7,B]  456-19-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-106ms    | [S2,MB4,F]  117-12-130ms   | [S2,MB5,F]  142-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-13-277ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-325ms   | [S2,MB3,B]  337-12-350ms   | [S2,MB4,B]  361-12-374ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  412-12-425ms   | [S2,MB7,B]  433-11-445ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-107ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-257ms   | [S3,MB1,B]  257-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-24-330ms   | [S3,MB4,B]  330-24-355ms   | [S3,MB5,B]  354-24-379ms   | [S3,MB6,B]  379-25-405ms   | [S3,MB7,B]  405-24-430ms  
[rank3]:2025-12-31 21:57:12,255 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2157_stage3_step300.svg
[rank1]:2025-12-31 21:57:12,299 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2157_rank1_stage1.svg
[rank1]:	> Counts Sum: 143360, Total Sum: 1030400 (13.91%), Ratio(%) per element: [15.76, 15.76, 16.3, 15.76, 16.3, 15.76, 15.21, 15.21, 15.76, 15.76, 15.76, 16.3, 15.76, 15.76, 15.76, 14.67, 15.21, 15.21, 15.76, 15.21, 14.67, 14.67, 14.67, 15.21, 15.21, 15.21, 14.13, 14.13, 12.5, 13.58, 13.04, 14.13, 13.04, 13.04, 13.04, 13.58, 13.04, 11.95, 15.21, 13.58, 13.04, 13.58, 13.04, 13.04, 12.5, 11.95, 13.04, 12.5, 13.04, 12.5, 12.5, 13.58, 12.5, 12.5, 13.04, 11.95, 12.5, 12.5, 13.04, 13.58, 13.04, 12.5, 12.5, 11.41, 12.5, 13.04, 11.95, 14.67, 11.95, 13.58]
[rank3]:2025-12-31 21:57:12,400 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2157_rank3_stage3.svg
[rank3]:	> Counts Sum: 404800, Total Sum: 618240 (65.48%), Ratio(%) per element: [75.0, 74.45, 71.19, 71.19, 73.36, 71.19, 72.82, 71.19, 72.28, 72.28, 72.82, 73.36, 68.47, 71.73, 67.39, 71.73, 66.84, 70.65, 66.3, 70.1, 70.65, 72.28, 72.82, 67.93, 69.56, 70.65, 71.73, 65.76, 53.26, 52.17, 54.89, 55.97, 57.06, 55.43, 53.8, 55.97, 53.26, 55.43, 52.71, 56.52, 54.89, 52.71]
[rank0]:2025-12-31 21:57:12,890 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2157_stage0.svg
[rank1]:2025-12-31 21:57:12,887 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2157_stage1.svg
[rank2]:2025-12-31 21:57:12,904 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2157_stage2.svg
[rank3]:2025-12-31 21:57:12,985 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2157_stage3.svg
[rank3]:2025-12-31 21:58:50,876 - Avg. fwd time: 16.7007 / Avg. bwd time: 24.9651 / Avg. batch time: 392.8692 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-31 21:58:50,897 - Avg. fwd time: 12.2834 / Avg. bwd time: 12.8351 / Avg. batch time: 421.0323 (ms) / GPU bubble ratio: 52.27%
[rank1]:2025-12-31 21:58:50,926 - Avg. fwd time: 15.5761 / Avg. bwd time: 17.1259 / Avg. batch time: 461.9385 (ms) / GPU bubble ratio: 43.37%
[rank0]:2025-12-31 21:58:50,935 - Avg. fwd time: 13.4559 / Avg. bwd time: 11.1498 / Avg. batch time: 485.4266 (ms) / GPU bubble ratio: 59.45%
[rank0]:2025-12-31 22:00:24,931 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-31 22:00:28,858 - Avg. fwd time: 12.2835 / Avg. bwd time: 12.8355 / Avg. batch time: 420.8887 (ms) / GPU bubble ratio: 52.26%
[rank3]:2025-12-31 22:00:28,837 - Avg. fwd time: 16.7038 / Avg. bwd time: 24.9495 / Avg. batch time: 392.7659 (ms) / GPU bubble ratio: 15.16%
[rank1]:2025-12-31 22:00:28,886 - Avg. fwd time: 15.5800 / Avg. bwd time: 17.1317 / Avg. batch time: 461.8581 (ms) / GPU bubble ratio: 43.34%
[rank1]:2025-12-31 22:00:28,898 -  step: 350  loss: -8.0000  grad_norm:  3.2540  memory: 17.18GiB(36.17%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank0]:2025-12-31 22:00:28,894 - Avg. fwd time: 13.4569 / Avg. bwd time: 11.1244 / Avg. batch time: 484.9562 (ms) / GPU bubble ratio: 59.45%
[rank0]:2025-12-31 22:00:28,898 -  step: 350  loss: -8.0000  grad_norm:  3.2540  memory: 14.51GiB(30.55%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank2]:2025-12-31 22:00:28,898 -  step: 350  loss: -8.0000  grad_norm:  3.2540  memory: 13.85GiB(29.15%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank3]:2025-12-31 22:00:28,900 -  step: 350  loss: 11.1852  grad_norm:  3.2540  memory: 29.95GiB(63.04%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank2]:2025-12-31 22:02:07,075 - Avg. fwd time: 12.2832 / Avg. bwd time: 12.8334 / Avg. batch time: 420.7116 (ms) / GPU bubble ratio: 52.24%
[rank3]:2025-12-31 22:02:07,054 - Avg. fwd time: 16.7047 / Avg. bwd time: 24.9324 / Avg. batch time: 392.6320 (ms) / GPU bubble ratio: 15.16%
[rank1]:2025-12-31 22:02:07,104 - Avg. fwd time: 15.5838 / Avg. bwd time: 17.1572 / Avg. batch time: 461.8838 (ms) / GPU bubble ratio: 43.29%
[rank0]:2025-12-31 22:02:07,112 - Avg. fwd time: 13.4558 / Avg. bwd time: 11.1022 / Avg. batch time: 484.6373 (ms) / GPU bubble ratio: 59.46%
[rank0]:2025-12-31 22:03:41,253 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 22:03:45,212 - Avg. fwd time: 12.2832 / Avg. bwd time: 12.8317 / Avg. batch time: 420.5653 (ms) / GPU bubble ratio: 52.23%
[rank3]:2025-12-31 22:03:45,190 - Avg. fwd time: 16.7062 / Avg. bwd time: 24.9178 / Avg. batch time: 392.5241 (ms) / GPU bubble ratio: 15.17%
[rank1]:2025-12-31 22:03:45,243 - Avg. fwd time: 15.5868 / Avg. bwd time: 17.1776 / Avg. batch time: 461.8923 (ms) / GPU bubble ratio: 43.25%
[rank1]:2025-12-31 22:03:45,255 -  step: 400  loss: -8.0000  grad_norm: 16.0565  memory: 17.18GiB(36.17%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank0]:2025-12-31 22:03:45,251 - Avg. fwd time: 13.4557 / Avg. bwd time: 11.0829 / Avg. batch time: 484.3431 (ms) / GPU bubble ratio: 59.47%
[rank0]:2025-12-31 22:03:45,255 -  step: 400  loss: -8.0000  grad_norm: 16.0565  memory: 14.51GiB(30.55%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank2]:2025-12-31 22:03:45,255 -  step: 400  loss: -8.0000  grad_norm: 16.0565  memory: 13.85GiB(29.15%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank2]:2025-12-31 22:03:45,311 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2203_stage2_step400.svg
[rank3]:2025-12-31 22:03:45,258 -  step: 400  loss: 10.2708  grad_norm: 16.0565  memory: 29.95GiB(63.04%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank1]:2025-12-31 22:03:45,309 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2203_stage1_step400.svg
[rank0]:2025-12-31 22:03:45,309 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2203_stage0_step400.svg
[rank3]:2025-12-31 22:03:45,407 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2203_step400_rank3.svg
[rank3]:			> Batch Time: 478.50 ms, GPU Bubble Ratio: 59.52%, 44.78%, 58.10%, 30.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  326-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  374-12-386ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  424-12-437ms   | [S0,MB6,B]  455-12-467ms   | [S0,MB7,B]  478-0-478ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-30ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  121-15-136ms   | [S1,MB6,F]  145-15-161ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-346ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  379-16-396ms   | [S1,MB5,B]  403-16-420ms   | [S1,MB6,B]  429-21-450ms   | [S1,MB7,B]  455-19-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-130ms   | [S2,MB5,F]  142-12-154ms   | [S2,MB6,F]  166-12-179ms   | [S2,MB7,F]  191-12-203ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  290-12-303ms   | [S2,MB2,B]  314-12-327ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  387-12-400ms   | [S2,MB6,B]  414-12-426ms   | [S2,MB7,B]  435-11-446ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-107ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  188-16-204ms   | [S3,MB7,F]  212-16-229ms   | [S3,MB0,B]  235-23-259ms   | [S3,MB1,B]  258-24-283ms   | [S3,MB2,B]  283-24-307ms   | [S3,MB3,B]  307-24-332ms   | [S3,MB4,B]  332-24-356ms   | [S3,MB5,B]  356-24-381ms   | [S3,MB6,B]  381-25-407ms   | [S3,MB7,B]  407-24-432ms  
[rank1]:2025-12-31 22:03:45,490 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2203_rank1_stage1.svg
[rank1]:	> Counts Sum: 199360, Total Sum: 1478400 (13.48%), Ratio(%) per element: [14.77, 14.77, 15.15, 14.77, 15.15, 14.77, 14.39, 14.39, 14.77, 14.77, 14.77, 15.15, 14.77, 14.77, 14.77, 14.01, 14.39, 14.39, 14.77, 14.39, 14.01, 14.01, 14.01, 14.39, 14.39, 14.39, 13.63, 13.63, 12.5, 13.25, 12.87, 13.63, 12.87, 12.87, 12.87, 13.25, 12.87, 12.12, 14.39, 13.25, 12.87, 13.25, 12.87, 12.87, 12.5, 12.12, 12.87, 12.5, 12.87, 12.5, 12.5, 13.25, 12.5, 12.5, 12.87, 12.12, 12.5, 12.5, 12.87, 13.25, 12.87, 12.5, 12.5, 11.74, 12.5, 12.87, 12.12, 14.01, 12.12, 13.25]
[rank0]:2025-12-31 22:03:45,477 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2203_rank0_stage0.svg
[rank0]:	> Counts Sum: 159520, Total Sum: 1182720 (13.49%), Ratio(%) per element: [13.63, 14.01, 13.63, 14.39, 14.77, 14.39, 14.39, 14.77, 14.39, 13.63, 14.01, 14.39, 14.39, 14.01, 14.39, 14.77, 14.01, 14.39, 14.01, 14.39, 13.63, 13.63, 14.01, 14.77, 14.39, 14.77, 14.77, 14.77, 13.25, 12.87, 12.87, 13.63, 12.5, 13.25, 12.5, 13.63, 12.87, 12.12, 12.87, 12.5, 12.5, 12.5, 12.87, 12.12, 12.87, 12.12, 12.5, 12.12, 12.87, 12.87, 11.74, 13.25, 12.87, 13.25, 12.12, 12.12]
[rank2]:2025-12-31 22:03:45,484 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2203_rank2_stage2.svg
[rank2]:	> Counts Sum: 159520, Total Sum: 1182720 (13.49%), Ratio(%) per element: [14.39, 14.77, 14.39, 14.39, 14.77, 14.01, 14.77, 13.63, 13.63, 14.39, 14.39, 14.39, 14.01, 14.01, 14.39, 13.63, 14.39, 14.01, 13.63, 14.77, 14.01, 14.77, 14.39, 14.01, 14.77, 14.77, 13.25, 14.77, 14.01, 13.25, 14.01, 13.63, 13.25, 13.25, 13.25, 12.87, 13.25, 12.87, 12.12, 12.87, 12.87, 12.5, 12.5, 11.74, 13.25, 12.5, 12.87, 12.12, 11.74, 12.12, 12.5, 11.74, 12.12, 12.5, 12.12, 11.74]
[rank3]:2025-12-31 22:03:45,458 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2203_stage3_step400.svg
[rank3]:2025-12-31 22:03:45,607 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2203_rank3_stage3.svg
[rank3]:	> Counts Sum: 620000, Total Sum: 887040 (69.90%), Ratio(%) per element: [76.89, 76.89, 74.62, 75.37, 76.51, 74.62, 76.13, 75.37, 75.0, 76.13, 76.51, 76.51, 73.1, 74.62, 70.07, 74.62, 70.07, 73.1, 70.83, 73.48, 73.86, 74.24, 75.0, 72.72, 73.48, 73.48, 74.62, 70.83, 60.22, 59.46, 61.74, 62.87, 63.25, 61.74, 60.98, 61.74, 59.84, 61.74, 59.46, 62.12, 60.98, 60.6]
[rank1]:2025-12-31 22:03:46,325 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2203_stage1.svg
[rank0]:2025-12-31 22:03:46,336 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2203_stage0.svg
[rank2]:2025-12-31 22:03:46,351 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2203_stage2.svg
[rank3]:2025-12-31 22:03:46,550 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2203_stage3.svg
[rank3]:2025-12-31 22:04:08,815 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 22:04:08,905 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 22:04:08,920 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 22:04:08,885 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 22:05:24,437 - Avg. fwd time: 15.5877 / Avg. bwd time: 17.1964 / Avg. batch time: 461.9138 (ms) / GPU bubble ratio: 43.22%
[rank2]:2025-12-31 22:05:24,407 - Avg. fwd time: 12.2825 / Avg. bwd time: 12.8293 / Avg. batch time: 420.4599 (ms) / GPU bubble ratio: 52.22%
[rank3]:2025-12-31 22:05:24,386 - Avg. fwd time: 16.7056 / Avg. bwd time: 24.9024 / Avg. batch time: 392.3939 (ms) / GPU bubble ratio: 15.17%
[rank0]:2025-12-31 22:05:24,446 - Avg. fwd time: 13.4553 / Avg. bwd time: 11.0655 / Avg. batch time: 484.1077 (ms) / GPU bubble ratio: 59.48%
[rank0]:2025-12-31 22:06:58,668 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-31 22:07:02,560 - Avg. fwd time: 12.2814 / Avg. bwd time: 12.8268 / Avg. batch time: 420.2764 (ms) / GPU bubble ratio: 52.21%
[rank3]:2025-12-31 22:07:02,538 - Avg. fwd time: 16.7035 / Avg. bwd time: 24.8860 / Avg. batch time: 392.2429 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-31 22:07:02,604 -  step: 450  loss: -8.0000  grad_norm:  3.1077  memory: 13.85GiB(29.15%)  tps: 8,302  tflops: 64.90  mfu: 20.80%
[rank0]:2025-12-31 22:07:02,601 - Avg. fwd time: 13.4567 / Avg. bwd time: 11.0498 / Avg. batch time: 483.8946 (ms) / GPU bubble ratio: 59.48%
[rank0]:2025-12-31 22:07:02,605 -  step: 450  loss: -8.0000  grad_norm:  3.1077  memory: 14.51GiB(30.55%)  tps: 8,302  tflops: 64.90  mfu: 20.80%
[rank1]:2025-12-31 22:07:02,591 - Avg. fwd time: 15.5896 / Avg. bwd time: 17.2225 / Avg. batch time: 461.9245 (ms) / GPU bubble ratio: 43.17%
[rank1]:2025-12-31 22:07:02,604 -  step: 450  loss: -8.0000  grad_norm:  3.1077  memory: 17.18GiB(36.17%)  tps: 8,302  tflops: 64.90  mfu: 20.80%
[rank3]:2025-12-31 22:07:02,607 -  step: 450  loss: 12.7476  grad_norm:  3.1077  memory: 29.95GiB(63.04%)  tps: 8,302  tflops: 64.90  mfu: 20.80%
[rank3]:2025-12-31 22:08:40,735 - Avg. fwd time: 16.7014 / Avg. bwd time: 24.8705 / Avg. batch time: 392.0993 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-31 22:08:40,759 - Avg. fwd time: 12.2805 / Avg. bwd time: 12.8246 / Avg. batch time: 420.1010 (ms) / GPU bubble ratio: 52.19%
[rank1]:2025-12-31 22:08:40,789 - Avg. fwd time: 15.5899 / Avg. bwd time: 17.2458 / Avg. batch time: 461.9210 (ms) / GPU bubble ratio: 43.13%
[rank0]:2025-12-31 22:08:40,798 - Avg. fwd time: 13.4570 / Avg. bwd time: 11.0358 / Avg. batch time: 483.6909 (ms) / GPU bubble ratio: 59.49%
[rank0]:2025-12-31 22:10:14,911 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 22:10:18,765 - Avg. fwd time: 16.7001 / Avg. bwd time: 24.8568 / Avg. batch time: 391.9774 (ms) / GPU bubble ratio: 15.19%
[rank1]:2025-12-31 22:10:18,819 - Avg. fwd time: 15.5888 / Avg. bwd time: 17.2597 / Avg. batch time: 461.8672 (ms) / GPU bubble ratio: 43.10%
[rank2]:2025-12-31 22:10:18,788 - Avg. fwd time: 12.2798 / Avg. bwd time: 12.8232 / Avg. batch time: 419.9508 (ms) / GPU bubble ratio: 52.18%
[rank0]:2025-12-31 22:10:18,829 - Avg. fwd time: 13.4565 / Avg. bwd time: 11.0232 / Avg. batch time: 483.4564 (ms) / GPU bubble ratio: 59.49%
[rank0]:2025-12-31 22:10:18,834 -  step: 500  loss: -8.0000  grad_norm:  3.1005  memory: 14.51GiB(30.55%)  tps: 8,349  tflops: 65.27  mfu: 20.92%
[rank3]:2025-12-31 22:10:18,836 -  step: 500  loss: 12.9574  grad_norm:  3.1005  memory: 29.95GiB(63.04%)  tps: 8,350  tflops: 65.27  mfu: 20.92%
[rank1]:2025-12-31 22:10:18,833 -  step: 500  loss: -8.0000  grad_norm:  3.1005  memory: 17.18GiB(36.17%)  tps: 8,349  tflops: 65.27  mfu: 20.92%
[rank1]:2025-12-31 22:10:18,883 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2210_stage1_step500.svg
[rank2]:2025-12-31 22:10:18,833 -  step: 500  loss: -8.0000  grad_norm:  3.1005  memory: 13.85GiB(29.15%)  tps: 8,349  tflops: 65.27  mfu: 20.92%
[rank2]:2025-12-31 22:10:18,884 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2210_stage2_step500.svg
[rank0]:2025-12-31 22:10:18,884 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2210_stage0_step500.svg
[rank3]:2025-12-31 22:10:18,972 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2210_step500_rank3.svg
[rank3]:			> Batch Time: 478.00 ms, GPU Bubble Ratio: 59.48%, 44.55%, 58.02%, 31.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-12-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-312ms   | [S0,MB1,B]  324-12-337ms   | [S0,MB2,B]  349-12-361ms   | [S0,MB3,B]  372-12-384ms   | [S0,MB4,B]  397-12-409ms   | [S0,MB5,B]  424-12-436ms   | [S0,MB6,B]  454-12-466ms   | [S0,MB7,B]  478-0-478ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  144-15-160ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  280-16-296ms   | [S1,MB1,B]  304-16-321ms   | [S1,MB2,B]  328-16-345ms   | [S1,MB3,B]  352-16-369ms   | [S1,MB4,B]  377-16-393ms   | [S1,MB5,B]  401-16-418ms   | [S1,MB6,B]  427-22-449ms   | [S1,MB7,B]  454-19-473ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  165-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  288-12-301ms   | [S2,MB2,B]  312-12-325ms   | [S2,MB3,B]  336-12-349ms   | [S2,MB4,B]  360-12-373ms   | [S2,MB5,B]  385-12-398ms   | [S2,MB6,B]  411-12-424ms   | [S2,MB7,B]  433-11-444ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  187-16-203ms   | [S3,MB7,F]  211-16-227ms   | [S3,MB0,B]  233-23-257ms   | [S3,MB1,B]  257-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-24-330ms   | [S3,MB4,B]  330-24-354ms   | [S3,MB5,B]  354-24-378ms   | [S3,MB6,B]  378-25-404ms   | [S3,MB7,B]  404-24-428ms  
[rank3]:2025-12-31 22:10:19,014 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2210_stage3_step500.svg
[rank1]:2025-12-31 22:10:19,064 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2210_rank1_stage1.svg
[rank1]:	> Counts Sum: 255360, Total Sum: 1926400 (13.26%), Ratio(%) per element: [14.24, 14.24, 14.53, 14.24, 14.53, 14.24, 13.95, 13.95, 14.24, 14.24, 14.24, 14.53, 14.24, 14.24, 14.24, 13.66, 13.95, 13.95, 14.24, 13.95, 13.66, 13.66, 13.66, 13.95, 13.95, 13.95, 13.37, 13.37, 12.5, 13.08, 12.79, 13.37, 12.79, 12.79, 12.79, 13.08, 12.79, 12.2, 13.95, 13.08, 12.79, 13.08, 12.79, 12.79, 12.5, 12.2, 12.79, 12.5, 12.79, 12.5, 12.5, 13.08, 12.5, 12.5, 12.79, 12.2, 12.5, 12.5, 12.79, 13.08, 12.79, 12.5, 12.5, 11.91, 12.5, 12.79, 12.2, 13.66, 12.2, 13.08]
[rank2]:2025-12-31 22:10:19,052 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2210_rank2_stage2.svg
[rank2]:	> Counts Sum: 204320, Total Sum: 1541120 (13.26%), Ratio(%) per element: [13.95, 14.24, 13.95, 13.95, 14.24, 13.66, 14.24, 13.37, 13.37, 13.95, 13.95, 13.95, 13.66, 13.66, 13.95, 13.37, 13.95, 13.66, 13.37, 14.24, 13.66, 14.24, 13.95, 13.66, 14.24, 14.24, 13.08, 14.24, 13.66, 13.08, 13.66, 13.37, 13.08, 13.08, 13.08, 12.79, 13.08, 12.79, 12.2, 12.79, 12.79, 12.5, 12.5, 11.91, 13.08, 12.5, 12.79, 12.2, 11.91, 12.2, 12.5, 11.91, 12.2, 12.5, 12.2, 11.91]
[rank0]:2025-12-31 22:10:19,052 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2210_rank0_stage0.svg
[rank0]:	> Counts Sum: 204320, Total Sum: 1541120 (13.26%), Ratio(%) per element: [13.37, 13.66, 13.37, 13.95, 14.24, 13.95, 13.95, 14.24, 13.95, 13.37, 13.66, 13.95, 13.95, 13.66, 13.95, 14.24, 13.66, 13.95, 13.66, 13.95, 13.37, 13.37, 13.66, 14.24, 13.95, 14.24, 14.24, 14.24, 13.08, 12.79, 12.79, 13.37, 12.5, 13.08, 12.5, 13.37, 12.79, 12.2, 12.79, 12.5, 12.5, 12.5, 12.79, 12.2, 12.79, 12.2, 12.5, 12.2, 12.79, 12.79, 11.91, 13.08, 12.79, 13.08, 12.2, 12.2]
[rank3]:2025-12-31 22:10:19,154 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2210_rank3_stage3.svg
[rank3]:	> Counts Sum: 835200, Total Sum: 1155840 (72.26%), Ratio(%) per element: [78.19, 77.61, 76.74, 76.45, 77.32, 75.87, 76.74, 76.74, 76.45, 77.61, 77.9, 77.32, 75.29, 75.87, 72.96, 76.74, 72.09, 75.29, 73.83, 75.29, 75.0, 75.58, 76.16, 75.58, 74.41, 75.29, 77.03, 72.96, 64.82, 63.66, 65.69, 66.56, 66.27, 65.11, 64.53, 65.69, 64.24, 65.11, 63.08, 66.27, 64.82, 64.53]
[rank1]:2025-12-31 22:10:20,141 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2210_stage1.svg
[rank2]:2025-12-31 22:10:20,170 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2210_stage2.svg
[rank0]:2025-12-31 22:10:20,153 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2210_stage0.svg
[rank3]:2025-12-31 22:10:20,229 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2210_stage3.svg
[rank3]:2025-12-31 22:11:58,114 - Avg. fwd time: 16.6989 / Avg. bwd time: 24.8447 / Avg. batch time: 391.8686 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 22:11:58,137 - Avg. fwd time: 12.2792 / Avg. bwd time: 12.8219 / Avg. batch time: 419.8288 (ms) / GPU bubble ratio: 52.17%
[rank1]:2025-12-31 22:11:58,170 - Avg. fwd time: 15.5886 / Avg. bwd time: 17.2745 / Avg. batch time: 461.8437 (ms) / GPU bubble ratio: 43.07%
[rank0]:2025-12-31 22:11:58,180 - Avg. fwd time: 13.4570 / Avg. bwd time: 11.0118 / Avg. batch time: 483.2673 (ms) / GPU bubble ratio: 59.49%
[rank0]:2025-12-31 22:13:32,442 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 22:13:36,343 - Avg. fwd time: 16.6983 / Avg. bwd time: 24.8351 / Avg. batch time: 391.7855 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 22:13:36,367 - Avg. fwd time: 12.2788 / Avg. bwd time: 12.8207 / Avg. batch time: 419.7242 (ms) / GPU bubble ratio: 52.16%
[rank3]:2025-12-31 22:13:36,412 -  step: 550  loss: 11.0947  grad_norm:  2.9615  memory: 29.95GiB(63.04%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank1]:2025-12-31 22:13:36,395 - Avg. fwd time: 15.5909 / Avg. bwd time: 17.2907 / Avg. batch time: 461.8601 (ms) / GPU bubble ratio: 43.04%
[rank1]:2025-12-31 22:13:36,409 -  step: 550  loss: -8.0000  grad_norm:  2.9615  memory: 17.18GiB(36.17%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank0]:2025-12-31 22:13:36,405 - Avg. fwd time: 13.4569 / Avg. bwd time: 11.0016 / Avg. batch time: 483.1303 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 22:13:36,410 -  step: 550  loss: -8.0000  grad_norm:  2.9615  memory: 14.51GiB(30.55%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank2]:2025-12-31 22:13:36,409 -  step: 550  loss: -8.0000  grad_norm:  2.9615  memory: 13.85GiB(29.15%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank2]:2025-12-31 22:15:14,697 - Avg. fwd time: 12.2784 / Avg. bwd time: 12.8198 / Avg. batch time: 419.6172 (ms) / GPU bubble ratio: 52.15%
[rank3]:2025-12-31 22:15:14,673 - Avg. fwd time: 16.6975 / Avg. bwd time: 24.8252 / Avg. batch time: 391.6976 (ms) / GPU bubble ratio: 15.19%
[rank1]:2025-12-31 22:15:14,729 - Avg. fwd time: 15.5906 / Avg. bwd time: 17.3084 / Avg. batch time: 461.8694 (ms) / GPU bubble ratio: 43.02%
[rank0]:2025-12-31 22:15:14,740 - Avg. fwd time: 13.4579 / Avg. bwd time: 10.9922 / Avg. batch time: 483.0084 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 22:16:48,675 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 22:16:52,642 - Avg. fwd time: 16.6966 / Avg. bwd time: 24.8155 / Avg. batch time: 391.6101 (ms) / GPU bubble ratio: 15.20%
[rank1]:2025-12-31 22:16:52,697 - Avg. fwd time: 15.5913 / Avg. bwd time: 17.3143 / Avg. batch time: 461.8234 (ms) / GPU bubble ratio: 43.00%
[rank1]:2025-12-31 22:16:52,712 -  step: 600  loss: -8.0000  grad_norm: 14.9752  memory: 17.18GiB(36.17%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank0]:2025-12-31 22:16:52,708 - Avg. fwd time: 13.4585 / Avg. bwd time: 10.9836 / Avg. batch time: 482.8368 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 22:16:52,712 -  step: 600  loss: -8.0000  grad_norm: 14.9752  memory: 14.51GiB(30.55%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank2]:2025-12-31 22:16:52,666 - Avg. fwd time: 12.2781 / Avg. bwd time: 12.8185 / Avg. batch time: 419.5097 (ms) / GPU bubble ratio: 52.14%
[rank2]:2025-12-31 22:16:52,712 -  step: 600  loss: -8.0000  grad_norm: 14.9752  memory: 13.85GiB(29.15%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank3]:2025-12-31 22:16:52,714 -  step: 600  loss: 10.0019  grad_norm: 14.9752  memory: 29.95GiB(63.04%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank1]:2025-12-31 22:16:52,764 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2216_stage1_step600.svg
[rank0]:2025-12-31 22:16:52,764 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2216_stage0_step600.svg
[rank2]:2025-12-31 22:16:52,764 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2216_stage2_step600.svg
[rank3]:2025-12-31 22:16:52,853 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2216_step600_rank3.svg
[rank3]:			> Batch Time: 479.00 ms, GPU Bubble Ratio: 59.54%, 44.83%, 58.16%, 31.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-313ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  349-12-361ms   | [S0,MB3,B]  373-12-385ms   | [S0,MB4,B]  397-12-410ms   | [S0,MB5,B]  423-12-435ms   | [S0,MB6,B]  455-12-467ms   | [S0,MB7,B]  479-0-479ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  121-15-136ms   | [S1,MB6,F]  145-15-161ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  305-16-322ms   | [S1,MB2,B]  329-16-346ms   | [S1,MB3,B]  353-16-370ms   | [S1,MB4,B]  377-16-394ms   | [S1,MB5,B]  402-16-419ms   | [S1,MB6,B]  427-21-449ms   | [S1,MB7,B]  454-19-473ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  165-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  288-12-301ms   | [S2,MB2,B]  312-12-325ms   | [S2,MB3,B]  337-12-350ms   | [S2,MB4,B]  361-12-374ms   | [S2,MB5,B]  385-12-398ms   | [S2,MB6,B]  411-12-424ms   | [S2,MB7,B]  432-11-444ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-257ms   | [S3,MB1,B]  257-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-24-330ms   | [S3,MB4,B]  330-24-354ms   | [S3,MB5,B]  354-24-379ms   | [S3,MB6,B]  379-25-405ms   | [S3,MB7,B]  405-24-429ms  
[rank3]:2025-12-31 22:16:52,897 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2216_stage3_step600.svg
[rank0]:2025-12-31 22:16:52,935 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2216_rank0_stage0.svg
[rank0]:	> Counts Sum: 249120, Total Sum: 1899520 (13.11%), Ratio(%) per element: [13.2, 13.44, 13.2, 13.67, 13.91, 13.67, 13.67, 13.91, 13.67, 13.2, 13.44, 13.67, 13.67, 13.44, 13.67, 13.91, 13.44, 13.67, 13.44, 13.67, 13.2, 13.2, 13.44, 13.91, 13.67, 13.91, 13.91, 13.91, 12.97, 12.73, 12.73, 13.2, 12.5, 12.97, 12.5, 13.2, 12.73, 12.26, 12.73, 12.5, 12.5, 12.5, 12.73, 12.26, 12.73, 12.26, 12.5, 12.26, 12.73, 12.73, 12.02, 12.97, 12.73, 12.97, 12.26, 12.26]
[rank2]:2025-12-31 22:16:52,932 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2216_rank2_stage2.svg
[rank2]:	> Counts Sum: 249120, Total Sum: 1899520 (13.11%), Ratio(%) per element: [13.67, 13.91, 13.67, 13.67, 13.91, 13.44, 13.91, 13.2, 13.2, 13.67, 13.67, 13.67, 13.44, 13.44, 13.67, 13.2, 13.67, 13.44, 13.2, 13.91, 13.44, 13.91, 13.67, 13.44, 13.91, 13.91, 12.97, 13.91, 13.44, 12.97, 13.44, 13.2, 12.97, 12.97, 12.97, 12.73, 12.97, 12.73, 12.26, 12.73, 12.73, 12.5, 12.5, 12.02, 12.97, 12.5, 12.73, 12.26, 12.02, 12.26, 12.5, 12.02, 12.26, 12.5, 12.26, 12.02]
[rank1]:2025-12-31 22:16:52,948 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2216_rank1_stage1.svg
[rank1]:	> Counts Sum: 311360, Total Sum: 2374400 (13.11%), Ratio(%) per element: [13.91, 13.91, 14.15, 13.91, 14.15, 13.91, 13.67, 13.67, 13.91, 13.91, 13.91, 14.15, 13.91, 13.91, 13.91, 13.44, 13.67, 13.67, 13.91, 13.67, 13.44, 13.44, 13.44, 13.67, 13.67, 13.67, 13.2, 13.2, 12.5, 12.97, 12.73, 13.2, 12.73, 12.73, 12.73, 12.97, 12.73, 12.26, 13.67, 12.97, 12.73, 12.97, 12.73, 12.73, 12.5, 12.26, 12.73, 12.5, 12.73, 12.5, 12.5, 12.97, 12.5, 12.5, 12.73, 12.26, 12.5, 12.5, 12.73, 12.97, 12.73, 12.5, 12.5, 12.02, 12.5, 12.73, 12.26, 13.44, 12.26, 12.97]
[rank3]:2025-12-31 22:16:53,037 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2216_rank3_stage3.svg
[rank3]:	> Counts Sum: 1050400, Total Sum: 1424640 (73.73%), Ratio(%) per element: [79.95, 79.0, 78.06, 78.3, 78.77, 77.83, 78.77, 78.53, 77.35, 78.53, 79.71, 79.24, 76.65, 77.59, 73.82, 77.12, 73.58, 75.47, 74.52, 75.7, 75.7, 76.17, 76.88, 75.94, 75.0, 75.7, 77.12, 74.52, 66.98, 66.5, 67.68, 68.39, 67.92, 67.21, 66.74, 67.68, 66.98, 67.21, 65.56, 68.39, 66.98, 66.74]
[rank1]:2025-12-31 22:16:54,298 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2216_stage1.svg
[rank0]:2025-12-31 22:16:54,299 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2216_stage0.svg
[rank2]:2025-12-31 22:16:54,302 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2216_stage2.svg
[rank3]:2025-12-31 22:16:54,352 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2216_stage3.svg
[rank3]:2025-12-31 22:18:31,943 - Avg. fwd time: 16.6950 / Avg. bwd time: 24.8055 / Avg. batch time: 391.5160 (ms) / GPU bubble ratio: 15.20%
[rank2]:2025-12-31 22:18:31,967 - Avg. fwd time: 12.2776 / Avg. bwd time: 12.8185 / Avg. batch time: 419.4104 (ms) / GPU bubble ratio: 52.13%
[rank1]:2025-12-31 22:18:31,999 - Avg. fwd time: 15.5911 / Avg. bwd time: 17.3156 / Avg. batch time: 461.7358 (ms) / GPU bubble ratio: 42.99%
[rank0]:2025-12-31 22:18:32,010 - Avg. fwd time: 13.4578 / Avg. bwd time: 10.9755 / Avg. batch time: 482.6323 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 22:20:06,063 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 22:20:09,948 - Avg. fwd time: 16.6947 / Avg. bwd time: 24.7989 / Avg. batch time: 391.4588 (ms) / GPU bubble ratio: 15.20%
[rank2]:2025-12-31 22:20:09,973 - Avg. fwd time: 12.2772 / Avg. bwd time: 12.8172 / Avg. batch time: 419.3381 (ms) / GPU bubble ratio: 52.13%
[rank2]:2025-12-31 22:20:10,018 -  step: 650  loss: -8.0000  grad_norm:  3.5295  memory: 13.85GiB(29.15%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank0]:2025-12-31 22:20:10,015 - Avg. fwd time: 13.4583 / Avg. bwd time: 10.9682 / Avg. batch time: 482.4848 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 22:20:10,019 -  step: 650  loss: -8.0000  grad_norm:  3.5295  memory: 14.51GiB(30.55%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank1]:2025-12-31 22:20:10,003 - Avg. fwd time: 15.5905 / Avg. bwd time: 17.3197 / Avg. batch time: 461.6934 (ms) / GPU bubble ratio: 42.97%
[rank1]:2025-12-31 22:20:10,018 -  step: 650  loss: -8.0000  grad_norm:  3.5295  memory: 17.18GiB(36.17%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank3]:2025-12-31 22:20:10,021 -  step: 650  loss: 12.3049  grad_norm:  3.5295  memory: 29.95GiB(63.04%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank3]:2025-12-31 22:21:48,156 - Avg. fwd time: 16.6952 / Avg. bwd time: 24.7947 / Avg. batch time: 391.4278 (ms) / GPU bubble ratio: 15.20%
[rank2]:2025-12-31 22:21:48,181 - Avg. fwd time: 12.2773 / Avg. bwd time: 12.8173 / Avg. batch time: 419.2938 (ms) / GPU bubble ratio: 52.12%
[rank0]:2025-12-31 22:21:48,227 - Avg. fwd time: 13.4593 / Avg. bwd time: 10.9618 / Avg. batch time: 482.3899 (ms) / GPU bubble ratio: 59.50%
[rank1]:2025-12-31 22:21:48,215 - Avg. fwd time: 15.5907 / Avg. bwd time: 17.3271 / Avg. batch time: 461.6938 (ms) / GPU bubble ratio: 42.96%
[rank0]:2025-12-31 22:23:22,233 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 22:23:26,083 - Avg. fwd time: 16.6944 / Avg. bwd time: 24.7903 / Avg. batch time: 391.3864 (ms) / GPU bubble ratio: 15.20%
[rank2]:2025-12-31 22:23:26,108 - Avg. fwd time: 12.2775 / Avg. bwd time: 12.8172 / Avg. batch time: 419.2387 (ms) / GPU bubble ratio: 52.11%
[rank2]:2025-12-31 22:23:26,156 -  step: 700  loss: -8.0000  grad_norm:  3.0926  memory: 13.85GiB(29.15%)  tps: 8,353  tflops: 65.30  mfu: 20.93%
[rank0]:2025-12-31 22:23:26,152 - Avg. fwd time: 13.4596 / Avg. bwd time: 10.9559 / Avg. batch time: 482.2560 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 22:23:26,156 -  step: 700  loss: -8.0000  grad_norm:  3.0926  memory: 14.51GiB(30.55%)  tps: 8,353  tflops: 65.30  mfu: 20.93%
[rank1]:2025-12-31 22:23:26,140 - Avg. fwd time: 15.5919 / Avg. bwd time: 17.3286 / Avg. batch time: 461.6506 (ms) / GPU bubble ratio: 42.95%
[rank1]:2025-12-31 22:23:26,156 -  step: 700  loss: -8.0000  grad_norm:  3.0926  memory: 17.18GiB(36.17%)  tps: 8,353  tflops: 65.30  mfu: 20.93%
[rank1]:2025-12-31 22:23:26,210 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2223_stage1_step700.svg
[rank3]:2025-12-31 22:23:26,158 -  step: 700  loss: 13.1107  grad_norm:  3.0926  memory: 29.95GiB(63.04%)  tps: 8,353  tflops: 65.30  mfu: 20.93%
[rank2]:2025-12-31 22:23:26,210 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2223_stage2_step700.svg
[rank0]:2025-12-31 22:23:26,210 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2223_stage0_step700.svg
[rank3]:2025-12-31 22:23:26,300 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2223_step700_rank3.svg
[rank3]:			> Batch Time: 478.25 ms, GPU Bubble Ratio: 59.45%, 44.87%, 57.98%, 30.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-12-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-312ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  349-12-361ms   | [S0,MB3,B]  374-12-386ms   | [S0,MB4,B]  398-12-411ms   | [S0,MB5,B]  425-12-437ms   | [S0,MB6,B]  455-12-467ms   | [S0,MB7,B]  478-0-478ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  144-15-160ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  280-16-296ms   | [S1,MB1,B]  305-16-321ms   | [S1,MB2,B]  329-16-345ms   | [S1,MB3,B]  354-16-370ms   | [S1,MB4,B]  378-16-395ms   | [S1,MB5,B]  403-16-420ms   | [S1,MB6,B]  429-21-451ms   | [S1,MB7,B]  455-18-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  362-12-375ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  413-13-426ms   | [S2,MB7,B]  435-11-446ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-107ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  212-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-24-331ms   | [S3,MB4,B]  331-24-355ms   | [S3,MB5,B]  355-24-380ms   | [S3,MB6,B]  380-25-406ms   | [S3,MB7,B]  407-24-431ms  
[rank0]:2025-12-31 22:23:26,383 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2223_rank0_stage0.svg
[rank0]:	> Counts Sum: 293920, Total Sum: 2257920 (13.02%), Ratio(%) per element: [13.09, 13.29, 13.09, 13.49, 13.69, 13.49, 13.49, 13.69, 13.49, 13.09, 13.29, 13.49, 13.49, 13.29, 13.49, 13.69, 13.29, 13.49, 13.29, 13.49, 13.09, 13.09, 13.29, 13.69, 13.49, 13.69, 13.69, 13.69, 12.89, 12.69, 12.69, 13.09, 12.5, 12.89, 12.5, 13.09, 12.69, 12.3, 12.69, 12.5, 12.5, 12.5, 12.69, 12.3, 12.69, 12.3, 12.5, 12.3, 12.69, 12.69, 12.1, 12.89, 12.69, 12.89, 12.3, 12.3]
[rank1]:2025-12-31 22:23:26,396 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2223_rank1_stage1.svg
[rank1]:	> Counts Sum: 367360, Total Sum: 2822400 (13.02%), Ratio(%) per element: [13.69, 13.69, 13.88, 13.69, 13.88, 13.69, 13.49, 13.49, 13.69, 13.69, 13.69, 13.88, 13.69, 13.69, 13.69, 13.29, 13.49, 13.49, 13.69, 13.49, 13.29, 13.29, 13.29, 13.49, 13.49, 13.49, 13.09, 13.09, 12.5, 12.89, 12.69, 13.09, 12.69, 12.69, 12.69, 12.89, 12.69, 12.3, 13.49, 12.89, 12.69, 12.89, 12.69, 12.69, 12.5, 12.3, 12.69, 12.5, 12.69, 12.5, 12.5, 12.89, 12.5, 12.5, 12.69, 12.3, 12.5, 12.5, 12.69, 12.89, 12.69, 12.5, 12.5, 12.1, 12.5, 12.69, 12.3, 13.29, 12.3, 12.89]
[rank3]:2025-12-31 22:23:26,348 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2223_stage3_step700.svg
[rank2]:2025-12-31 22:23:26,383 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2223_rank2_stage2.svg
[rank2]:	> Counts Sum: 293920, Total Sum: 2257920 (13.02%), Ratio(%) per element: [13.49, 13.69, 13.49, 13.49, 13.69, 13.29, 13.69, 13.09, 13.09, 13.49, 13.49, 13.49, 13.29, 13.29, 13.49, 13.09, 13.49, 13.29, 13.09, 13.69, 13.29, 13.69, 13.49, 13.29, 13.69, 13.69, 12.89, 13.69, 13.29, 12.89, 13.29, 13.09, 12.89, 12.89, 12.89, 12.69, 12.89, 12.69, 12.3, 12.69, 12.69, 12.5, 12.5, 12.1, 12.89, 12.5, 12.69, 12.3, 12.1, 12.3, 12.5, 12.1, 12.3, 12.5, 12.3, 12.1]
[rank3]:2025-12-31 22:23:26,490 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2223_rank3_stage3.svg
[rank3]:	> Counts Sum: 1265600, Total Sum: 1693440 (74.74%), Ratio(%) per element: [80.55, 79.36, 78.57, 79.16, 79.36, 78.57, 79.36, 79.56, 77.97, 78.96, 79.96, 79.56, 77.57, 78.37, 75.0, 76.98, 74.2, 76.19, 75.99, 76.19, 76.38, 76.38, 77.77, 76.78, 75.79, 76.38, 77.38, 75.79, 68.25, 68.25, 69.64, 69.64, 69.44, 68.65, 68.05, 69.04, 68.84, 68.84, 67.65, 70.23, 69.24, 68.84]
[rank1]:2025-12-31 22:23:27,977 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2223_stage1.svg
[rank2]:2025-12-31 22:23:28,053 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2223_stage2.svg
[rank0]:2025-12-31 22:23:28,006 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2223_stage0.svg
[rank3]:2025-12-31 22:23:28,121 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2223_stage3.svg
[rank3]:2025-12-31 22:25:05,621 - Avg. fwd time: 16.6940 / Avg. bwd time: 24.7863 / Avg. batch time: 391.3498 (ms) / GPU bubble ratio: 15.21%
[rank2]:2025-12-31 22:25:05,648 - Avg. fwd time: 12.2777 / Avg. bwd time: 12.8171 / Avg. batch time: 419.1993 (ms) / GPU bubble ratio: 52.11%
[rank0]:2025-12-31 22:25:05,690 - Avg. fwd time: 13.4597 / Avg. bwd time: 10.9504 / Avg. batch time: 482.1036 (ms) / GPU bubble ratio: 59.49%
[rank1]:2025-12-31 22:25:05,677 - Avg. fwd time: 15.5925 / Avg. bwd time: 17.3235 / Avg. batch time: 461.5862 (ms) / GPU bubble ratio: 42.95%
[rank0]:2025-12-31 22:26:39,835 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 22:26:43,776 - Avg. fwd time: 16.6955 / Avg. bwd time: 24.7847 / Avg. batch time: 391.3486 (ms) / GPU bubble ratio: 15.21%
[rank2]:2025-12-31 22:26:43,801 - Avg. fwd time: 12.2778 / Avg. bwd time: 12.8169 / Avg. batch time: 419.1856 (ms) / GPU bubble ratio: 52.11%
[rank0]:2025-12-31 22:26:43,846 - Avg. fwd time: 13.4603 / Avg. bwd time: 10.9452 / Avg. batch time: 482.0212 (ms) / GPU bubble ratio: 59.49%
[rank3]:2025-12-31 22:26:43,853 -  step: 750  loss: 11.0703  grad_norm:  2.2439  memory: 29.95GiB(63.04%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank1]:2025-12-31 22:26:43,833 - Avg. fwd time: 15.5930 / Avg. bwd time: 17.3246 / Avg. batch time: 461.5829 (ms) / GPU bubble ratio: 42.95%
[rank1]:2025-12-31 22:26:43,850 -  step: 750  loss: -8.0000  grad_norm:  2.2439  memory: 17.18GiB(36.17%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank2]:2025-12-31 22:26:43,850 -  step: 750  loss: -8.0000  grad_norm:  2.2439  memory: 13.85GiB(29.15%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank0]:2025-12-31 22:26:43,850 -  step: 750  loss: -8.0000  grad_norm:  2.2439  memory: 14.51GiB(30.55%)  tps: 8,288  tflops: 64.79  mfu: 20.77%
[rank3]:2025-12-31 22:28:22,101 - Avg. fwd time: 16.6961 / Avg. bwd time: 24.7814 / Avg. batch time: 391.3265 (ms) / GPU bubble ratio: 15.21%
[rank0]:2025-12-31 22:28:22,172 - Avg. fwd time: 13.4619 / Avg. bwd time: 10.9403 / Avg. batch time: 481.9661 (ms) / GPU bubble ratio: 59.50%
[rank2]:2025-12-31 22:28:22,128 - Avg. fwd time: 12.2779 / Avg. bwd time: 12.8165 / Avg. batch time: 419.1531 (ms) / GPU bubble ratio: 52.10%
[rank1]:2025-12-31 22:28:22,159 - Avg. fwd time: 15.5935 / Avg. bwd time: 17.3309 / Avg. batch time: 461.5995 (ms) / GPU bubble ratio: 42.94%
[rank0]:2025-12-31 22:29:56,642 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 22:30:00,607 - Avg. fwd time: 16.6966 / Avg. bwd time: 24.7778 / Avg. batch time: 391.3011 (ms) / GPU bubble ratio: 15.21%
[rank2]:2025-12-31 22:30:00,634 - Avg. fwd time: 12.2779 / Avg. bwd time: 12.8162 / Avg. batch time: 419.1193 (ms) / GPU bubble ratio: 52.10%
[rank2]:2025-12-31 22:30:00,681 -  step: 800  loss: -8.0000  grad_norm: 13.8701  memory: 13.85GiB(29.15%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank2]:2025-12-31 22:30:00,681 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8701  tps: 8,795  tflops: 68.76  mfu: 20.02%
[rank2]:2025-12-31 22:30:00,681 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 22:30:00,682 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 22:30:00,678 - Avg. fwd time: 13.4630 / Avg. bwd time: 10.9355 / Avg. batch time: 481.9435 (ms) / GPU bubble ratio: 59.50%
[rank0]:2025-12-31 22:30:00,682 -  step: 800  loss: -8.0000  grad_norm: 13.8701  memory: 14.51GiB(30.55%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank0]:2025-12-31 22:30:00,682 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8701  tps: 8,797  tflops: 68.77  mfu: 20.05%
[rank0]:2025-12-31 22:30:00,682 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 22:30:00,682 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-31 22:30:00,684 -  step: 800  loss:  9.7916  grad_norm: 13.8701  memory: 29.95GiB(63.04%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank3]:2025-12-31 22:30:00,685 - â„¹ï¸ final step: 800  loss:  9.7916  grad_norm: 13.8701  tps: 8,802  tflops: 68.81  mfu: 20.18%
[rank3]:2025-12-31 22:30:00,685 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 22:30:00,686 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 22:30:00,664 - Avg. fwd time: 15.5939 / Avg. bwd time: 17.3437 / Avg. batch time: 461.6447 (ms) / GPU bubble ratio: 42.92%
[rank1]:2025-12-31 22:30:00,681 -  step: 800  loss: -8.0000  grad_norm: 13.8701  memory: 17.18GiB(36.17%)  tps: 8,324  tflops: 65.07  mfu: 20.86%
[rank1]:2025-12-31 22:30:00,681 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8701  tps: 8,796  tflops: 68.76  mfu: 20.03%
[rank1]:2025-12-31 22:30:00,681 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 22:30:00,682 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 22:30:02,980 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-31 22:30:03,055 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank1/251231_2230_stage1_final800.svg
[rank0]:2025-12-31 22:30:03,057 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank0/251231_2230_stage0_final800.svg
[rank2]:2025-12-31 22:30:03,055 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank2/251231_2230_stage2_final800.svg
[rank3]:2025-12-31 22:30:03,144 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2230_final800_rank3.svg
[rank3]:			> Batch Time: 479.25 ms, GPU Bubble Ratio: 59.57%, 45.26%, 58.14%, 30.93%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  326-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  400-12-412ms   | [S0,MB5,B]  425-12-438ms   | [S0,MB6,B]  455-12-468ms   | [S0,MB7,B]  479-0-479ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  121-15-136ms   | [S1,MB6,F]  145-15-160ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-347ms   | [S1,MB3,B]  355-16-371ms   | [S1,MB4,B]  380-16-396ms   | [S1,MB5,B]  404-16-421ms   | [S1,MB6,B]  430-19-450ms   | [S1,MB7,B]  455-19-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  314-12-327ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  388-12-401ms   | [S2,MB6,B]  414-12-427ms   | [S2,MB7,B]  435-11-447ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-283ms   | [S3,MB2,B]  283-24-307ms   | [S3,MB3,B]  307-24-332ms   | [S3,MB4,B]  332-24-356ms   | [S3,MB5,B]  356-24-381ms   | [S3,MB6,B]  381-25-407ms   | [S3,MB7,B]  407-24-432ms  
[rank1]:2025-12-31 22:30:03,238 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2230_rank1_stage1.svg
[rank1]:	> Counts Sum: 423360, Total Sum: 3270400 (12.95%), Ratio(%) per element: [13.52, 13.52, 13.69, 13.52, 13.69, 13.52, 13.35, 13.35, 13.52, 13.52, 13.52, 13.69, 13.52, 13.52, 13.52, 13.18, 13.35, 13.35, 13.52, 13.35, 13.18, 13.18, 13.18, 13.35, 13.35, 13.35, 13.01, 13.01, 12.5, 12.84, 12.67, 13.01, 12.67, 12.67, 12.67, 12.84, 12.67, 12.32, 13.35, 12.84, 12.67, 12.84, 12.67, 12.67, 12.5, 12.32, 12.67, 12.5, 12.67, 12.5, 12.5, 12.84, 12.5, 12.5, 12.67, 12.32, 12.5, 12.5, 12.67, 12.84, 12.67, 12.5, 12.5, 12.15, 12.5, 12.67, 12.32, 13.18, 12.32, 12.84]
[rank0]:2025-12-31 22:30:03,227 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2230_rank0_stage0.svg
[rank2]:2025-12-31 22:30:03,229 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2230_rank2_stage2.svg
[rank0]:	> Counts Sum: 338720, Total Sum: 2616320 (12.95%), Ratio(%) per element: [13.01, 13.18, 13.01, 13.35, 13.52, 13.35, 13.35, 13.52, 13.35, 13.01, 13.18, 13.35, 13.35, 13.18, 13.35, 13.52, 13.18, 13.35, 13.18, 13.35, 13.01, 13.01, 13.18, 13.52, 13.35, 13.52, 13.52, 13.52, 12.84, 12.67, 12.67, 13.01, 12.5, 12.84, 12.5, 13.01, 12.67, 12.32, 12.67, 12.5, 12.5, 12.5, 12.67, 12.32, 12.67, 12.32, 12.5, 12.32, 12.67, 12.67, 12.15, 12.84, 12.67, 12.84, 12.32, 12.32]
[rank2]:	> Counts Sum: 338720, Total Sum: 2616320 (12.95%), Ratio(%) per element: [13.35, 13.52, 13.35, 13.35, 13.52, 13.18, 13.52, 13.01, 13.01, 13.35, 13.35, 13.35, 13.18, 13.18, 13.35, 13.01, 13.35, 13.18, 13.01, 13.52, 13.18, 13.52, 13.35, 13.18, 13.52, 13.52, 12.84, 13.52, 13.18, 12.84, 13.18, 13.01, 12.84, 12.84, 12.84, 12.67, 12.84, 12.67, 12.32, 12.67, 12.67, 12.5, 12.5, 12.15, 12.84, 12.5, 12.67, 12.32, 12.15, 12.32, 12.5, 12.15, 12.32, 12.5, 12.32, 12.15]
[rank3]:2025-12-31 22:30:03,283 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/pipeline_schedule/251231_2230_thry_final800_rank3.svg
[rank3]:			> Batch Time: 477.79 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-14-28ms     | [S0,MB2,F]  28-14-43ms     | [S0,MB3,F]  43-14-57ms     | [S0,MB4,F]  57-14-72ms     | [S0,MB5,F]  72-14-86ms     | [S0,MB6,F]  86-14-101ms    | [S0,MB7,F]  101-14-115ms   | [S0,MB0,B]  246-28-275ms   | [S0,MB1,B]  275-28-304ms   | [S0,MB2,B]  304-28-333ms   | [S0,MB3,B]  333-28-361ms   | [S0,MB4,B]  361-28-390ms   | [S0,MB5,B]  390-28-419ms   | [S0,MB6,B]  419-28-448ms   | [S0,MB7,B]  448-28-477ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-14-28ms     | [S1,MB1,F]  28-14-43ms     | [S1,MB2,F]  43-14-57ms     | [S1,MB3,F]  57-14-72ms     | [S1,MB4,F]  72-14-86ms     | [S1,MB5,F]  86-14-101ms    | [S1,MB6,F]  101-14-115ms   | [S1,MB7,F]  115-14-130ms   | [S1,MB0,B]  217-28-246ms   | [S1,MB1,B]  246-28-275ms   | [S1,MB2,B]  275-28-304ms   | [S1,MB3,B]  304-28-333ms   | [S1,MB4,B]  333-28-361ms   | [S1,MB5,B]  361-28-390ms   | [S1,MB6,B]  390-28-419ms   | [S1,MB7,B]  419-28-448ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-14-43ms     | [S2,MB1,F]  43-14-57ms     | [S2,MB2,F]  57-14-72ms     | [S2,MB3,F]  72-14-86ms     | [S2,MB4,F]  86-14-101ms    | [S2,MB5,F]  101-14-115ms   | [S2,MB6,F]  115-14-130ms   | [S2,MB7,F]  130-14-144ms   | [S2,MB0,B]  188-28-217ms   | [S2,MB1,B]  217-28-246ms   | [S2,MB2,B]  246-28-275ms   | [S2,MB3,B]  275-28-304ms   | [S2,MB4,B]  304-28-333ms   | [S2,MB5,B]  333-28-361ms   | [S2,MB6,B]  361-28-390ms   | [S2,MB7,B]  390-28-419ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  43-14-57ms     | [S3,MB1,F]  57-14-72ms     | [S3,MB2,F]  72-14-86ms     | [S3,MB3,F]  86-14-101ms    | [S3,MB4,F]  101-14-115ms   | [S3,MB5,F]  115-14-130ms   | [S3,MB6,F]  130-14-144ms   | [S3,MB7,F]  144-14-159ms   | [S3,MB0,B]  159-28-188ms   | [S3,MB1,B]  188-28-217ms   | [S3,MB2,B]  217-28-246ms   | [S3,MB3,B]  246-28-275ms   | [S3,MB4,B]  275-28-304ms   | [S3,MB5,B]  304-28-333ms   | [S3,MB6,B]  333-28-361ms   | [S3,MB7,B]  361-28-390ms  
[rank3]:2025-12-31 22:30:03,332 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_ratio_history/rank3/251231_2230_stage3_final800.svg
[rank3]:2025-12-31 22:30:03,477 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/frozen_params_histogram/251231_2230_rank3_stage3.svg
[rank3]:	> Counts Sum: 1480800, Total Sum: 1962240 (75.46%), Ratio(%) per element: [80.99, 79.28, 78.76, 79.62, 79.62, 78.76, 79.45, 79.62, 78.59, 79.62, 80.13, 79.96, 78.25, 78.59, 75.68, 77.39, 75.17, 76.88, 77.22, 76.54, 76.71, 77.39, 77.73, 77.73, 76.36, 76.54, 77.91, 76.36, 69.52, 69.69, 70.71, 71.06, 70.89, 70.37, 69.69, 70.2, 70.2, 70.03, 69.0, 71.06, 70.37, 69.69]
[rank1]:2025-12-31 22:30:05,087 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2230_stage1.svg
[rank1]:2025-12-31 22:30:05,091 - Destroying the purge thread.
[rank0]:2025-12-31 22:30:05,122 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2230_stage0.svg
[rank0]:2025-12-31 22:30:05,127 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-31 22:30:05,150 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2230_stage2.svg
[rank2]:2025-12-31 22:30:05,154 - Destroying the purge thread.
[rank3]:2025-12-31 22:30:05,317 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1/afr_time_plot/251231_2230_stage3.svg
[rank3]:2025-12-31 22:30:05,321 - Destroying the purge thread.
[rank1]:2025-12-31 22:30:05,346 - Process group destroyed
[rank2]:2025-12-31 22:30:05,333 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 345-361
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–‚â–â–‚â–ˆâ–â–â–â–‡â–â–â–â–‡â–‚â–â–â–†
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.72264
[rank3]:wandb:               final/avg_loss 9.79156
[rank3]:wandb:             final/avg_mfu(%) 20.17523
[rank3]:wandb:             final/avg_tflops 68.81269
[rank3]:wandb:    final/avg_throughput(tps) 8802.34597
[rank3]:wandb:              final/grad_norm 13.87013
[rank3]:wandb:               final/max_loss 9.79156
[rank3]:wandb:                    grad_norm 13.87013
[rank3]:wandb: loss_metrics/global_avg_loss 9.79156
[rank3]:wandb: loss_metrics/global_max_loss 9.79156
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_GPipe_timelyauto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/r86pdenw
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_GPipe_timelyauto_42_dm1/20251231-2137/wandb/run-20251231_213715-r86pdenw/logs
[rank3]:2025-12-31 22:30:06,874 - Process group destroyed
[rank0]:2025-12-31 22:30:07,127 - Training completed
[rank0]:2025-12-31 22:30:07,128 - Destroying the purge thread.
[rank0]:2025-12-31 22:30:07,356 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.9', 'layers.10', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.5', 'layers.4', 'layers.8', 'layers.6'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.1', 'layers.2', 'layers.0', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'norm', 'layers.13', 'output', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_GPipe_timelyauto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_GPipe_timelyauto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_GPipe_timelyauto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_GPipe_timelyauto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_GPipe_timelyauto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_GPipe_timelyauto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_GPipe_timelyauto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_GPipe_timelyauto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
