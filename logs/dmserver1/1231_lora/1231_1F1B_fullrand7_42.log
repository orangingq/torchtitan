
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 01:08:31 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_1F1B_fullrand7_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2026-01-01 01:08:38,863 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank0]:2026-01-01 01:08:38,932 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank2]:2026-01-01 01:08:39,031 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 01:08:39,033 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 01:08:39,143 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 01:08:39,145 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 01:08:39,149 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 01:08:39,151 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-01 01:08:39,101 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank3]:2026-01-01 01:08:39,112 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank1]:2026-01-01 01:08:39,442 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 01:08:39,446 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-01 01:08:39,449 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 01:08:39,451 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 01:08:39,534 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2026-01-01 01:08:42,324 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2026-01-01 01:08:42,470 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 01:08:42,510 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 01:08:42,511 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 01:08:42,537 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-01 01:08:42,537 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 01:08:42,754 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 01:08:42,754 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 01:08:42,754 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2026-01-01 01:08:42,810 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 01:08:42,847 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 01:08:42,874 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-01 01:08:42,875 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-01 01:08:43,091 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 01:08:43,092 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 01:08:43,092 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2026-01-01 01:08:43,035 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 01:08:43,077 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 01:08:43,107 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-01 01:08:43,107 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2026-01-01 01:08:43,341 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 01:08:43,341 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 01:08:43,342 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run eqsaqxhg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_1F1B_fullrand7_42_dm1/20260101-0108/wandb/run-20260101_010843-eqsaqxhg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_1F1B_fullrand7_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/eqsaqxhg
[rank3]:2026-01-01 01:08:45,159 - WandB logging enabled
[rank3]:2026-01-01 01:08:45,160 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 01:08:45,200 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 01:08:45,230 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2026-01-01 01:08:45,230 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 01:08:45,461 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_1F1B_fullrand7_42_dm1
[rank0]:2026-01-01 01:08:45,461 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 01:08:45,461 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 01:08:45,461 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2026-01-01 01:08:45,461 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 01:08:45,461 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-01 01:08:45,444 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 01:08:45,445 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 01:08:45,446 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2026-01-01 01:08:45,461 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 01:08:48,045 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank2]:2026-01-01 01:08:48,092 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2026-01-01 01:08:48,093 - Freezable Parameters: [Stage 2] 56 params
[rank0]:2026-01-01 01:08:48,045 - Finished loading the checkpoint in 2.58 seconds.
[rank0]:2026-01-01 01:08:48,092 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2026-01-01 01:08:48,093 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2026-01-01 01:08:48,093 - Training starts at step 1
[rank1]:2026-01-01 01:08:48,107 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2026-01-01 01:08:48,107 - Freezable Parameters: [Stage 1] 70 params
[rank3]:2026-01-01 01:08:48,112 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2026-01-01 01:08:48,113 - Freezable Parameters: [Stage 3] 42 params
[rank3]:2026-01-01 01:08:53,160 -  step:  1  loss: 10.6092  grad_norm:  9.9055  memory: 20.97GiB(44.14%)  tps: 4,118  tflops: 32.19  mfu: 10.32%
[rank3]:2026-01-01 01:08:53,160 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 01:08:53,183 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory: 13.12GiB(27.62%)  tps: 3,070  tflops: 24.00  mfu: 7.69%
[rank0]:2026-01-01 01:08:53,183 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 01:08:53,157 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory: 12.09GiB(25.46%)  tps: 3,179  tflops: 24.85  mfu: 7.96%
[rank1]:2026-01-01 01:08:53,157 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-01 01:08:53,157 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory:  7.27GiB(15.31%)  tps: 3,251  tflops: 25.41  mfu: 8.15%
[rank2]:2026-01-01 01:08:53,157 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 01:12:15,390 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 01:12:19,458 - Avg. fwd time: 33.2801 / Avg. bwd time: 52.8728 / Avg. batch time: 834.5548 (ms) / GPU bubble ratio: 17.41%
[rank3]:2026-01-01 01:12:19,578 -  step: 50  loss: 12.4624  grad_norm:  8.4069  memory: 20.97GiB(44.14%)  tps: 7,779  tflops: 60.81  mfu: 19.49%
[rank1]:2026-01-01 01:12:19,539 - Avg. fwd time: 32.7391 / Avg. bwd time: 38.1894 / Avg. batch time: 975.3313 (ms) / GPU bubble ratio: 41.82%
[rank1]:2026-01-01 01:12:19,577 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 12.09GiB(25.46%)  tps: 7,778  tflops: 60.81  mfu: 19.49%
[rank2]:2026-01-01 01:12:19,495 - Avg. fwd time: 25.7924 / Avg. bwd time: 30.2266 / Avg. batch time: 897.7989 (ms) / GPU bubble ratio: 50.08%
[rank2]:2026-01-01 01:12:19,577 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory:  7.27GiB(15.31%)  tps: 7,778  tflops: 60.81  mfu: 19.49%
[rank0]:2026-01-01 01:12:19,574 - Avg. fwd time: 26.2139 / Avg. bwd time: 28.3450 / Avg. batch time: 1037.6128 (ms) / GPU bubble ratio: 57.94%
[rank0]:2026-01-01 01:12:19,577 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 13.12GiB(27.62%)  tps: 7,779  tflops: 60.82  mfu: 19.49%
[rank3]:2026-01-01 01:12:57,379 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2026-01-01 01:13:39,587 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2026-01-01 01:13:39,774 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2026-01-01 01:13:39,733 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2026-01-01 01:13:39,802 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2026-01-01 01:14:21,994 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2026-01-01 01:14:22,230 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2026-01-01 01:15:43,414 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank1]:2026-01-01 01:15:43,681 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2026-01-01 01:15:43,665 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 01:15:43,680 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2026-01-01 01:15:43,680 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2026-01-01 01:15:43,824 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0115_max_batch_time.svg
[rank3]:			> Batch Time: 873.94 ms, GPU Bubble Ratio: 49.90%, 34.96%, 48.69%, 20.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  236-28-264ms   | [S0,MB4,F]  264-25-290ms   | [S0,MB1,B]  323-28-351ms   | [S0,MB5,F]  351-25-377ms   | [S0,MB2,B]  409-28-437ms   | [S0,MB6,F]  437-25-463ms   | [S0,MB3,B]  496-28-524ms   | [S0,MB7,F]  524-25-550ms   | [S0,MB4,B]  584-28-612ms   | [S0,MB5,B]  671-28-699ms   | [S0,MB6,B]  758-28-786ms   | [S0,MB7,B]  845-28-873ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-123ms    | [S1,MB0,B]  198-38-236ms   | [S1,MB3,F]  236-32-269ms   | [S1,MB1,B]  284-38-323ms   | [S1,MB4,F]  323-33-356ms   | [S1,MB2,B]  370-38-409ms   | [S1,MB5,F]  409-33-442ms   | [S1,MB3,B]  457-38-496ms   | [S1,MB6,F]  496-32-529ms   | [S1,MB4,B]  545-38-584ms   | [S1,MB7,F]  584-32-616ms   | [S1,MB5,B]  633-38-671ms   | [S1,MB6,B]  720-37-758ms   | [S1,MB7,B]  807-38-845ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  168-30-198ms   | [S2,MB2,F]  198-25-224ms   | [S2,MB1,B]  254-30-284ms   | [S2,MB3,F]  284-25-310ms   | [S2,MB2,B]  340-30-370ms   | [S2,MB4,F]  370-25-396ms   | [S2,MB3,B]  427-30-457ms   | [S2,MB5,F]  457-25-483ms   | [S2,MB4,B]  515-30-545ms   | [S2,MB6,F]  545-25-571ms   | [S2,MB5,B]  602-30-633ms   | [S2,MB7,F]  633-25-658ms   | [S2,MB6,B]  690-30-720ms   | [S2,MB7,B]  777-30-807ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  115-52-168ms   AFR(10):0.9762 | [S3,MB1,F]  168-33-201ms   | [S3,MB1,B]  201-53-254ms   AFR(10):0.9762 | [S3,MB2,F]  254-33-287ms   | [S3,MB2,B]  287-52-340ms   AFR(10):0.9762 | [S3,MB3,F]  340-33-374ms   | [S3,MB3,B]  374-53-427ms   AFR(10):0.9762 | [S3,MB4,F]  427-34-461ms   | [S3,MB4,B]  461-53-515ms   AFR(10):0.9762 | [S3,MB5,F]  515-34-549ms   | [S3,MB5,B]  549-53-602ms   AFR(10):0.9762 | [S3,MB6,F]  602-33-636ms   | [S3,MB6,B]  636-53-690ms   AFR(10):0.9762 | [S3,MB7,F]  690-33-723ms   | [S3,MB7,B]  723-53-777ms   AFR(10):0.9762
[rank3]:2026-01-01 01:15:43,956 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0115_min_batch_time.svg
[rank3]:			> Batch Time: 831.14 ms, GPU Bubble Ratio: 74.75%, 33.60%, 47.56%, 17.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  231-0-231ms    | [S0,MB4,F]  231-25-257ms   | [S0,MB1,B]  316-0-316ms    | [S0,MB5,F]  316-25-342ms   | [S0,MB2,B]  402-0-402ms    | [S0,MB6,F]  402-25-427ms   | [S0,MB3,B]  487-0-487ms    | [S0,MB7,F]  487-25-513ms   | [S0,MB4,B]  573-0-573ms    | [S0,MB5,B]  659-0-659ms    | [S0,MB6,B]  745-0-745ms    | [S0,MB7,B]  831-0-831ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-123ms    | [S1,MB0,B]  195-36-231ms   | [S1,MB3,F]  231-32-264ms   | [S1,MB1,B]  280-36-316ms   | [S1,MB4,F]  316-33-349ms   | [S1,MB2,B]  365-36-402ms   | [S1,MB5,F]  402-33-435ms   | [S1,MB3,B]  451-36-487ms   | [S1,MB6,F]  487-32-520ms   | [S1,MB4,B]  537-36-573ms   | [S1,MB7,F]  573-32-606ms   | [S1,MB5,B]  623-36-659ms   | [S1,MB6,B]  709-36-745ms   | [S1,MB7,B]  795-36-831ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  166-28-195ms   | [S2,MB2,F]  195-25-221ms   | [S2,MB1,B]  251-28-280ms   | [S2,MB3,F]  280-25-306ms   | [S2,MB2,B]  336-28-365ms   | [S2,MB4,F]  365-25-391ms   | [S2,MB3,B]  422-28-451ms   | [S2,MB5,F]  451-25-477ms   | [S2,MB4,B]  508-28-537ms   | [S2,MB6,F]  537-25-563ms   | [S2,MB5,B]  594-28-623ms   | [S2,MB7,F]  623-25-649ms   | [S2,MB6,B]  680-28-709ms   | [S2,MB7,B]  766-28-795ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  115-50-166ms   AFR(10):0.9762 | [S3,MB1,F]  166-33-199ms   | [S3,MB1,B]  199-51-251ms   AFR(10):0.9762 | [S3,MB2,F]  251-33-285ms   | [S3,MB2,B]  285-51-336ms   AFR(10):0.9762 | [S3,MB3,F]  336-33-370ms   | [S3,MB3,B]  370-52-422ms   AFR(10):0.9762 | [S3,MB4,F]  422-34-456ms   | [S3,MB4,B]  456-51-508ms   AFR(10):0.9762 | [S3,MB5,F]  508-34-542ms   | [S3,MB5,B]  542-52-594ms   AFR(10):0.9762 | [S3,MB6,F]  594-33-628ms   | [S3,MB6,B]  628-52-680ms   AFR(10):0.9762 | [S3,MB7,F]  680-33-714ms   | [S3,MB7,B]  714-51-766ms   AFR(10):0.9762
[rank3]:2026-01-01 01:15:44,099 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0115_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 832.99 ms, GPU Bubble Ratio: 50.84%, 32.02%, 46.35%, 17.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  234-28-263ms   | [S0,MB4,F]  263-25-289ms   | [S0,MB1,B]  320-28-348ms   | [S0,MB5,F]  348-25-374ms   | [S0,MB2,B]  406-28-434ms   | [S0,MB6,F]  434-25-460ms   | [S0,MB3,B]  493-28-521ms   | [S0,MB7,F]  521-25-547ms   | [S0,MB4,B]  579-28-607ms   | [S0,MB5,B]  665-28-694ms   | [S0,MB6,B]  750-28-779ms   | [S0,MB7,B]  832-0-832ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-123ms    | [S1,MB0,B]  196-38-234ms   | [S1,MB3,F]  234-32-267ms   | [S1,MB1,B]  281-38-320ms   | [S1,MB4,F]  320-33-353ms   | [S1,MB2,B]  367-38-406ms   | [S1,MB5,F]  406-33-439ms   | [S1,MB3,B]  454-38-493ms   | [S1,MB6,F]  493-32-526ms   | [S1,MB4,B]  540-38-579ms   | [S1,MB7,F]  579-32-612ms   | [S1,MB5,B]  627-38-665ms   | [S1,MB6,B]  713-37-750ms   | [S1,MB7,B]  796-36-832ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  166-30-196ms   | [S2,MB2,F]  196-25-222ms   | [S2,MB1,B]  251-30-281ms   | [S2,MB3,F]  281-25-307ms   | [S2,MB2,B]  337-30-367ms   | [S2,MB4,F]  367-25-393ms   | [S2,MB3,B]  424-30-454ms   | [S2,MB5,F]  454-25-480ms   | [S2,MB4,B]  510-30-540ms   | [S2,MB6,F]  540-25-566ms   | [S2,MB5,B]  596-30-627ms   | [S2,MB7,F]  627-25-652ms   | [S2,MB6,B]  682-30-713ms   | [S2,MB7,B]  768-28-796ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  115-50-166ms   AFR(10):0.9762 | [S3,MB1,F]  166-33-199ms   | [S3,MB1,B]  199-51-251ms   AFR(10):0.9762 | [S3,MB2,F]  251-33-285ms   | [S3,MB2,B]  285-52-337ms   AFR(10):0.9762 | [S3,MB3,F]  337-33-371ms   | [S3,MB3,B]  371-53-424ms   AFR(10):0.9762 | [S3,MB4,F]  424-34-458ms   | [S3,MB4,B]  458-51-510ms   AFR(10):0.9762 | [S3,MB5,F]  510-34-544ms   | [S3,MB5,B]  544-52-596ms   AFR(10):0.9762 | [S3,MB6,F]  596-33-630ms   | [S3,MB6,B]  630-52-682ms   AFR(10):0.9762 | [S3,MB7,F]  682-33-716ms   | [S3,MB7,B]  716-51-768ms   AFR(10):0.9762
[rank3]:2026-01-01 01:15:44,100 - 	> Batch Time: 832.99 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.05)
[rank3]:2026-01-01 01:15:44,101 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.98(1.00)/1.00, [MB1] 0.98(1.00)/1.00, [MB2] 0.98(0.40)/0.40, [MB3] 0.98(0.00)/0.00, [MB4] 0.98(1.00)/1.00, [MB5] 0.98(1.00)/1.00, [MB6] 0.98(1.00)/1.00, [MB7] 0.98(1.00)/1.00
[rank3]:2026-01-01 01:15:47,958 - Avg. fwd time: 33.4165 / Avg. bwd time: 52.7234 / Avg. batch time: 834.4676 (ms) / GPU bubble ratio: 17.42%
[rank3]:2026-01-01 01:15:48,047 -  step: 100  loss: 13.1176  grad_norm:  6.3665  memory: 20.97GiB(44.14%)  tps: 7,859  tflops: 61.44  mfu: 19.69%
[rank0]:2026-01-01 01:15:48,042 - Avg. fwd time: 26.1697 / Avg. bwd time: 22.6853 / Avg. batch time: 1030.3599 (ms) / GPU bubble ratio: 62.07%
[rank0]:2026-01-01 01:15:48,046 -  step: 100  loss: -4.0000  grad_norm:  6.3665  memory: 13.14GiB(27.66%)  tps: 7,859  tflops: 61.44  mfu: 19.69%
[rank2]:2026-01-01 01:15:47,993 - Avg. fwd time: 25.8063 / Avg. bwd time: 29.9216 / Avg. batch time: 897.7934 (ms) / GPU bubble ratio: 50.34%
[rank2]:2026-01-01 01:15:48,046 -  step: 100  loss: -4.0000  grad_norm:  6.3665  memory:  7.27GiB(15.31%)  tps: 7,859  tflops: 61.44  mfu: 19.69%
[rank1]:2026-01-01 01:15:48,036 - Avg. fwd time: 32.7536 / Avg. bwd time: 37.8105 / Avg. batch time: 974.5166 (ms) / GPU bubble ratio: 42.07%
[rank1]:2026-01-01 01:15:48,046 -  step: 100  loss: -4.0000  grad_norm:  6.3665  memory: 12.15GiB(25.58%)  tps: 7,859  tflops: 61.44  mfu: 19.69%
[rank1]:2026-01-01 01:15:48,105 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0115_stage1_step100.svg
[rank0]:2026-01-01 01:15:48,106 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0115_stage0_step100.svg
[rank2]:2026-01-01 01:15:48,106 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0115_stage2_step100.svg
[rank3]:2026-01-01 01:15:48,180 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0115_step100_rank3.svg
[rank3]:			> Batch Time: 991.00 ms, GPU Bubble Ratio: 79.03%, 44.45%, 56.08%, 31.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-26-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-106ms    | [S0,MB0,B]  274-0-274ms    | [S0,MB4,F]  274-25-299ms   | [S0,MB1,B]  377-0-377ms    | [S0,MB5,F]  377-25-402ms   | [S0,MB2,B]  483-0-483ms    | [S0,MB6,F]  483-25-508ms   | [S0,MB3,B]  586-0-586ms    | [S0,MB7,F]  588-25-613ms   | [S0,MB4,B]  690-0-690ms    | [S0,MB5,B]  790-0-790ms    | [S0,MB6,B]  891-0-891ms    | [S0,MB7,B]  991-0-991ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  227-36-263ms   | [S1,MB3,F]  270-32-303ms   | [S1,MB1,B]  330-36-366ms   | [S1,MB4,F]  374-32-406ms   | [S1,MB2,B]  435-36-471ms   | [S1,MB5,F]  479-32-512ms   | [S1,MB3,B]  539-36-576ms   | [S1,MB6,F]  582-32-615ms   | [S1,MB4,B]  642-36-679ms   | [S1,MB7,F]  686-32-719ms   | [S1,MB5,B]  747-36-783ms   | [S1,MB6,B]  847-36-883ms   | [S1,MB7,B]  948-35-984ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-28-216ms   | [S2,MB2,F]  224-25-249ms   | [S2,MB1,B]  291-28-320ms   | [S2,MB3,F]  327-25-353ms   | [S2,MB2,B]  396-28-425ms   | [S2,MB4,F]  432-25-458ms   | [S2,MB3,B]  500-28-529ms   | [S2,MB5,F]  536-25-561ms   | [S2,MB4,B]  603-28-632ms   | [S2,MB6,F]  639-25-665ms   | [S2,MB5,B]  707-28-736ms   | [S2,MB7,F]  743-25-769ms   | [S2,MB6,B]  812-28-841ms   | [S2,MB7,B]  913-28-942ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-50-177ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  229-51-281ms   | [S3,MB2,F]  288-33-322ms   | [S3,MB2,B]  334-51-385ms   | [S3,MB3,F]  393-33-426ms   | [S3,MB3,B]  438-51-490ms   | [S3,MB4,F]  497-33-531ms   | [S3,MB4,B]  542-51-594ms   | [S3,MB5,F]  600-33-634ms   | [S3,MB5,B]  645-52-698ms   | [S3,MB6,F]  703-34-737ms   | [S3,MB6,B]  749-52-801ms   | [S3,MB7,F]  808-33-842ms   | [S3,MB7,B]  854-51-905ms  
[rank3]:2026-01-01 01:15:48,221 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0115_stage3_step100.svg
[rank1]:2026-01-01 01:15:48,292 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0115_rank1_stage1.svg
[rank1]:	> Counts Sum: 44800, Total Sum: 44800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-01 01:15:48,284 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0115_rank0_stage0.svg
[rank0]:	> Counts Sum: 35840, Total Sum: 35840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-01 01:15:48,323 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0115_stage0.svg
[rank2]:2026-01-01 01:15:48,282 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0115_rank2_stage2.svg
[rank2]:	> Counts Sum: 35840, Total Sum: 35840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-01 01:15:48,321 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0115_stage2.svg
[rank1]:2026-01-01 01:15:48,331 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0115_stage1.svg
[rank3]:2026-01-01 01:15:48,361 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0115_rank3_stage3.svg
[rank3]:	> Counts Sum: 26240, Total Sum: 26880 (97.62%), Ratio(%) per element: [93.75, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 87.5, 87.5, 100.0, 87.5, 100.0, 100.0, 87.5, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 87.5, 100.0, 93.75, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0]
[rank3]:2026-01-01 01:15:48,399 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0115_stage3.svg
[rank3]:2026-01-01 01:19:13,057 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.60(0.67)/1.00, [MB1] 0.60(0.67)/1.00, [MB2] 0.24(0.27)/0.40, [MB3] 0.00(0.00)/0.00, [MB4] 0.60(0.67)/1.00, [MB5] 0.60(0.67)/1.00, [MB6] 0.60(0.67)/1.00, [MB7] 0.60(0.67)/1.00
[rank2]:2026-01-01 01:19:13,201 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2026-01-01 01:19:13,243 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank0]:2026-01-01 01:19:13,266 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 01:19:13,267 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank3]:2026-01-01 01:19:17,367 - Avg. fwd time: 33.4823 / Avg. bwd time: 52.6658 / Avg. batch time: 834.5179 (ms) / GPU bubble ratio: 17.42%
[rank2]:2026-01-01 01:19:17,404 - Avg. fwd time: 25.8150 / Avg. bwd time: 29.9979 / Avg. batch time: 897.2360 (ms) / GPU bubble ratio: 50.24%
[rank1]:2026-01-01 01:19:17,448 - Avg. fwd time: 32.7735 / Avg. bwd time: 37.9179 / Avg. batch time: 973.5881 (ms) / GPU bubble ratio: 41.91%
[rank3]:2026-01-01 01:19:17,484 -  step: 150  loss: 11.1266  grad_norm:  7.2074  memory: 20.97GiB(44.14%)  tps: 7,823  tflops: 61.16  mfu: 19.60%
[rank0]:2026-01-01 01:19:17,479 - Avg. fwd time: 26.1894 / Avg. bwd time: 24.3491 / Avg. batch time: 1029.0967 (ms) / GPU bubble ratio: 60.71%
[rank0]:2026-01-01 01:19:17,483 -  step: 150  loss: -4.0000  grad_norm:  7.2074  memory: 13.14GiB(27.66%)  tps: 7,823  tflops: 61.16  mfu: 19.60%
[rank2]:2026-01-01 01:19:17,482 -  step: 150  loss: -4.0000  grad_norm:  7.2074  memory:  7.27GiB(15.31%)  tps: 7,823  tflops: 61.16  mfu: 19.60%
[rank1]:2026-01-01 01:19:17,482 -  step: 150  loss: -4.0000  grad_norm:  7.2074  memory: 12.15GiB(25.58%)  tps: 7,823  tflops: 61.16  mfu: 19.60%
[rank3]:2026-01-01 01:22:41,676 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.93(1.00)/1.00, [MB1] 0.93(1.00)/1.00, [MB2] 0.38(0.40)/0.40, [MB3] 0.00(0.00)/0.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2026-01-01 01:22:41,894 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank1]:2026-01-01 01:22:41,934 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank0]:2026-01-01 01:22:41,944 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 01:22:41,944 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank2]:2026-01-01 01:22:46,095 - Avg. fwd time: 25.8314 / Avg. bwd time: 30.0349 / Avg. batch time: 897.4212 (ms) / GPU bubble ratio: 50.20%
[rank3]:2026-01-01 01:22:46,058 - Avg. fwd time: 33.5779 / Avg. bwd time: 52.6414 / Avg. batch time: 835.0653 (ms) / GPU bubble ratio: 17.40%
[rank1]:2026-01-01 01:22:46,139 - Avg. fwd time: 32.8067 / Avg. bwd time: 37.9818 / Avg. batch time: 973.5273 (ms) / GPU bubble ratio: 41.83%
[rank1]:2026-01-01 01:22:46,149 -  step: 200  loss: -4.0000  grad_norm: 33.1414  memory: 12.15GiB(25.58%)  tps: 7,852  tflops: 61.38  mfu: 19.67%
[rank0]:2026-01-01 01:22:46,145 - Avg. fwd time: 26.2141 / Avg. bwd time: 25.0633 / Avg. batch time: 1027.8514 (ms) / GPU bubble ratio: 60.09%
[rank0]:2026-01-01 01:22:46,150 -  step: 200  loss: -4.0000  grad_norm: 33.1414  memory: 13.14GiB(27.66%)  tps: 7,852  tflops: 61.38  mfu: 19.67%
[rank0]:2026-01-01 01:22:46,201 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0122_stage0_step200.svg
[rank2]:2026-01-01 01:22:46,149 -  step: 200  loss: -4.0000  grad_norm: 33.1414  memory:  7.27GiB(15.31%)  tps: 7,852  tflops: 61.38  mfu: 19.67%
[rank2]:2026-01-01 01:22:46,201 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0122_stage2_step200.svg
[rank3]:2026-01-01 01:22:46,151 -  step: 200  loss: 10.3045  grad_norm: 33.1414  memory: 20.97GiB(44.14%)  tps: 7,852  tflops: 61.38  mfu: 19.67%
[rank1]:2026-01-01 01:22:46,201 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0122_stage1_step200.svg
[rank3]:2026-01-01 01:22:46,297 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0122_step200_rank3.svg
[rank3]:			> Batch Time: 1013.69 ms, GPU Bubble Ratio: 58.55%, 43.86%, 55.78%, 31.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  278-28-307ms   | [S0,MB4,F]  307-25-332ms   | [S0,MB1,B]  383-28-412ms   | [S0,MB5,F]  412-25-438ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  624-25-650ms   | [S0,MB4,B]  701-28-730ms   | [S0,MB5,B]  803-28-831ms   | [S0,MB6,B]  904-28-933ms   | [S0,MB7,B]  1004-9-1013ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-33-137ms   | [S1,MB0,B]  229-38-268ms   | [S1,MB3,F]  275-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-33-413ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-33-519ms   | [S1,MB3,B]  547-38-585ms   | [S1,MB6,F]  592-33-625ms   | [S1,MB4,B]  652-38-691ms   | [S1,MB7,F]  698-33-731ms   | [S1,MB5,B]  758-38-796ms   | [S1,MB6,B]  860-38-898ms   | [S1,MB7,B]  961-36-997ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  506-30-536ms   | [S2,MB5,F]  544-25-569ms   | [S2,MB4,B]  612-30-642ms   | [S2,MB6,F]  649-25-675ms   | [S2,MB5,B]  717-30-747ms   | [S2,MB7,F]  755-25-780ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  926-28-954ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  127-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-283ms   | [S3,MB2,F]  291-34-325ms   | [S3,MB2,B]  337-52-389ms   | [S3,MB3,F]  397-34-431ms   | [S3,MB3,B]  442-54-496ms   | [S3,MB4,F]  503-34-537ms   | [S3,MB4,B]  549-52-602ms   | [S3,MB5,F]  609-34-643ms   | [S3,MB5,B]  655-52-708ms   | [S3,MB6,F]  714-34-748ms   | [S3,MB6,B]  760-52-813ms   | [S3,MB7,F]  820-34-855ms   | [S3,MB7,B]  866-52-919ms  
[rank0]:2026-01-01 01:22:46,367 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0122_rank0_stage0.svg
[rank0]:	> Counts Sum: 51520, Total Sum: 215040 (23.96%), Ratio(%) per element: [25.0, 26.04, 25.0, 26.04, 25.0, 26.04, 26.04, 27.08, 23.95, 25.0, 26.04, 26.04, 26.04, 23.95, 25.0, 25.0, 25.0, 23.95, 25.0, 23.95, 25.0, 26.04, 25.0, 25.0, 25.0, 22.91, 25.0, 23.95, 25.0, 22.91, 23.95, 26.04, 23.95, 26.04, 25.0, 25.0, 23.95, 19.79, 25.0, 20.83, 23.95, 23.95, 21.87, 21.87, 22.91, 22.91, 27.08, 21.87, 20.83, 21.87, 20.83, 19.79, 21.87, 20.83, 20.83, 17.7]
[rank2]:2026-01-01 01:22:46,368 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0122_rank2_stage2.svg
[rank2]:	> Counts Sum: 51520, Total Sum: 215040 (23.96%), Ratio(%) per element: [22.91, 23.95, 25.0, 21.87, 26.04, 23.95, 25.0, 21.87, 25.0, 26.04, 23.95, 22.91, 25.0, 23.95, 25.0, 20.83, 23.95, 23.95, 26.04, 23.95, 22.91, 23.95, 23.95, 21.87, 25.0, 20.83, 23.95, 26.04, 22.91, 23.95, 22.91, 22.91, 23.95, 23.95, 23.95, 23.95, 26.04, 25.0, 21.87, 22.91, 23.95, 25.0, 26.04, 25.0, 23.95, 23.95, 25.0, 22.91, 23.95, 23.95, 23.95, 22.91, 23.95, 22.91, 23.95, 26.04]
[rank3]:2026-01-01 01:22:46,341 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0122_stage3_step200.svg
[rank1]:2026-01-01 01:22:46,384 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0122_rank1_stage1.svg
[rank1]:	> Counts Sum: 64400, Total Sum: 268800 (23.96%), Ratio(%) per element: [21.87, 25.0, 22.91, 25.0, 21.87, 22.91, 21.87, 22.91, 26.04, 25.0, 25.0, 23.95, 25.0, 25.0, 23.95, 25.0, 26.04, 21.87, 27.08, 23.95, 21.87, 25.0, 21.87, 21.87, 22.91, 25.0, 25.0, 22.91, 26.04, 23.95, 25.0, 23.95, 23.95, 26.04, 22.91, 26.04, 25.0, 23.95, 22.91, 23.95, 22.91, 22.91, 22.91, 26.04, 25.0, 25.0, 23.95, 25.0, 22.91, 20.83, 21.87, 23.95, 26.04, 21.87, 23.95, 21.87, 25.0, 23.95, 26.04, 25.0, 21.87, 23.95, 25.0, 26.04, 20.83, 21.87, 25.0, 21.87, 26.04, 25.0]
[rank3]:2026-01-01 01:22:46,477 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0122_rank3_stage3.svg
[rank3]:	> Counts Sum: 101520, Total Sum: 161280 (62.95%), Ratio(%) per element: [61.45, 60.41, 66.66, 67.7, 59.37, 58.33, 60.41, 64.58, 68.75, 64.58, 66.66, 62.5, 65.62, 65.62, 56.25, 58.33, 62.5, 61.45, 67.7, 61.45, 64.58, 65.62, 65.62, 56.25, 65.62, 58.33, 69.79, 64.58, 65.62, 66.66, 71.87, 60.41, 58.33, 60.41, 59.37, 67.7, 59.37, 57.29, 56.25, 66.66, 60.41, 62.5]
[rank1]:2026-01-01 01:22:46,547 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0122_stage1.svg
[rank0]:2026-01-01 01:22:46,531 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0122_stage0.svg
[rank2]:2026-01-01 01:22:46,534 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0122_stage2.svg
[rank3]:2026-01-01 01:22:46,636 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0122_stage3.svg
[rank3]:2026-01-01 01:26:07,621 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(1.00)/1.00, [MB1] 1.00(1.00)/1.00, [MB2] 0.40(0.40)/0.40, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2026-01-01 01:26:07,829 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2026-01-01 01:26:07,869 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 01:26:07,870 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2026-01-01 01:26:07,869 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2026-01-01 01:26:11,859 - Avg. fwd time: 33.6782 / Avg. bwd time: 52.6285 / Avg. batch time: 835.7602 (ms) / GPU bubble ratio: 17.39%
[rank1]:2026-01-01 01:26:11,938 - Avg. fwd time: 32.8378 / Avg. bwd time: 38.0229 / Avg. batch time: 973.7731 (ms) / GPU bubble ratio: 41.78%
[rank2]:2026-01-01 01:26:11,895 - Avg. fwd time: 25.8458 / Avg. bwd time: 30.0542 / Avg. batch time: 897.8654 (ms) / GPU bubble ratio: 50.19%
[rank2]:2026-01-01 01:26:11,948 -  step: 250  loss: -4.0000  grad_norm:  6.0160  memory:  7.27GiB(15.31%)  tps: 7,961  tflops: 62.24  mfu: 19.95%
[rank0]:2026-01-01 01:26:11,945 - Avg. fwd time: 26.2236 / Avg. bwd time: 25.0523 / Avg. batch time: 1023.8203 (ms) / GPU bubble ratio: 59.93%
[rank0]:2026-01-01 01:26:11,949 -  step: 250  loss: -4.0000  grad_norm:  6.0160  memory: 13.14GiB(27.66%)  tps: 7,961  tflops: 62.24  mfu: 19.95%
[rank3]:2026-01-01 01:26:11,950 -  step: 250  loss: 12.5261  grad_norm:  6.0160  memory: 20.97GiB(44.14%)  tps: 7,961  tflops: 62.24  mfu: 19.95%
[rank1]:2026-01-01 01:26:11,948 -  step: 250  loss: -4.0000  grad_norm:  6.0160  memory: 12.15GiB(25.58%)  tps: 7,961  tflops: 62.24  mfu: 19.95%
[rank3]:2026-01-01 01:29:33,198 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(1.00)/1.00, [MB1] 1.00(1.00)/1.00, [MB2] 0.40(0.40)/0.40, [MB3] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2026-01-01 01:29:33,409 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2026-01-01 01:29:33,449 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 01:29:33,449 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2026-01-01 01:29:33,449 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2026-01-01 01:29:37,438 - Avg. fwd time: 33.7498 / Avg. bwd time: 52.6309 / Avg. batch time: 836.3529 (ms) / GPU bubble ratio: 17.37%
[rank1]:2026-01-01 01:29:37,518 - Avg. fwd time: 32.8591 / Avg. bwd time: 38.0505 / Avg. batch time: 974.0447 (ms) / GPU bubble ratio: 41.76%
[rank2]:2026-01-01 01:29:37,474 - Avg. fwd time: 25.8547 / Avg. bwd time: 30.0672 / Avg. batch time: 898.2754 (ms) / GPU bubble ratio: 50.20%
[rank2]:2026-01-01 01:29:37,529 -  step: 300  loss: -4.0000  grad_norm:  6.1262  memory:  7.27GiB(15.31%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank0]:2026-01-01 01:29:37,526 - Avg. fwd time: 26.2294 / Avg. bwd time: 25.0451 / Avg. batch time: 1021.2429 (ms) / GPU bubble ratio: 59.83%
[rank0]:2026-01-01 01:29:37,530 -  step: 300  loss: -4.0000  grad_norm:  6.1262  memory: 13.14GiB(27.66%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank3]:2026-01-01 01:29:37,531 -  step: 300  loss: 12.9460  grad_norm:  6.1262  memory: 20.97GiB(44.14%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank1]:2026-01-01 01:29:37,529 -  step: 300  loss: -4.0000  grad_norm:  6.1262  memory: 12.15GiB(25.58%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank1]:2026-01-01 01:29:37,581 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0129_stage1_step300.svg
[rank2]:2026-01-01 01:29:37,581 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0129_stage2_step300.svg
[rank0]:2026-01-01 01:29:37,580 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0129_stage0_step300.svg
[rank3]:2026-01-01 01:29:37,677 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0129_step300_rank3.svg
[rank3]:			> Batch Time: 1004.50 ms, GPU Bubble Ratio: 59.25%, 43.53%, 55.48%, 31.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  383-28-412ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  489-28-517ms   | [S0,MB6,F]  517-25-543ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  624-25-649ms   | [S0,MB4,B]  701-28-730ms   | [S0,MB5,B]  803-28-832ms   | [S0,MB6,B]  904-28-932ms   | [S0,MB7,B]  1004-0-1004ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-372ms   | [S1,MB4,F]  379-33-412ms   | [S1,MB2,B]  440-38-478ms   | [S1,MB5,F]  485-32-518ms   | [S1,MB3,B]  546-38-585ms   | [S1,MB6,F]  592-33-625ms   | [S1,MB4,B]  652-38-690ms   | [S1,MB7,F]  698-33-731ms   | [S1,MB5,B]  758-38-796ms   | [S1,MB6,B]  860-37-898ms   | [S1,MB7,B]  961-36-997ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  293-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  399-30-429ms   | [S2,MB4,F]  436-25-462ms   | [S2,MB3,B]  505-30-536ms   | [S2,MB5,F]  543-25-568ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  648-25-674ms   | [S2,MB5,B]  717-30-747ms   | [S2,MB7,F]  754-25-780ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  925-28-954ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-51-178ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-283ms   | [S3,MB2,F]  290-34-324ms   | [S3,MB2,B]  336-52-389ms   | [S3,MB3,F]  396-34-430ms   | [S3,MB3,B]  442-53-496ms   | [S3,MB4,F]  502-34-537ms   | [S3,MB4,B]  548-52-601ms   | [S3,MB5,F]  608-34-643ms   | [S3,MB5,B]  655-52-707ms   | [S3,MB6,F]  714-34-748ms   | [S3,MB6,B]  760-52-812ms   | [S3,MB7,F]  820-34-854ms   | [S3,MB7,B]  866-52-918ms  
[rank2]:2026-01-01 01:29:37,750 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0129_rank2_stage2.svg
[rank2]:	> Counts Sum: 73920, Total Sum: 394240 (18.75%), Ratio(%) per element: [18.18, 18.75, 19.31, 17.61, 19.88, 18.75, 19.31, 17.61, 19.31, 19.88, 18.75, 18.18, 19.31, 18.75, 19.31, 17.04, 18.75, 18.75, 19.88, 18.75, 18.18, 18.75, 18.75, 17.61, 19.31, 17.04, 18.75, 19.88, 18.18, 18.75, 18.18, 18.18, 18.75, 18.75, 18.75, 18.75, 19.88, 19.31, 17.61, 18.18, 18.75, 19.31, 19.88, 19.31, 18.75, 18.75, 19.31, 18.18, 18.75, 18.75, 18.75, 18.18, 18.75, 18.18, 18.75, 19.88]
[rank0]:2026-01-01 01:29:37,749 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0129_rank0_stage0.svg
[rank0]:	> Counts Sum: 73920, Total Sum: 394240 (18.75%), Ratio(%) per element: [19.31, 19.88, 19.31, 19.88, 19.31, 19.88, 19.88, 20.45, 18.75, 19.31, 19.88, 19.88, 19.88, 18.75, 19.31, 19.31, 19.31, 18.75, 19.31, 18.75, 19.31, 19.88, 19.31, 19.31, 19.31, 18.18, 19.31, 18.75, 19.31, 18.18, 18.75, 19.88, 18.75, 19.88, 19.31, 19.31, 18.75, 16.47, 19.31, 17.04, 18.75, 18.75, 17.61, 17.61, 18.18, 18.18, 20.45, 17.61, 17.04, 17.61, 17.04, 16.47, 17.61, 17.04, 17.04, 15.34]
[rank3]:2026-01-01 01:29:37,720 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0129_stage3_step300.svg
[rank1]:2026-01-01 01:29:37,765 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0129_rank1_stage1.svg
[rank1]:	> Counts Sum: 92400, Total Sum: 492800 (18.75%), Ratio(%) per element: [17.61, 19.31, 18.18, 19.31, 17.61, 18.18, 17.61, 18.18, 19.88, 19.31, 19.31, 18.75, 19.31, 19.31, 18.75, 19.31, 19.88, 17.61, 20.45, 18.75, 17.61, 19.31, 17.61, 17.61, 18.18, 19.31, 19.31, 18.18, 19.88, 18.75, 19.31, 18.75, 18.75, 19.88, 18.18, 19.88, 19.31, 18.75, 18.18, 18.75, 18.18, 18.18, 18.18, 19.88, 19.31, 19.31, 18.75, 19.31, 18.18, 17.04, 17.61, 18.75, 19.88, 17.61, 18.75, 17.61, 19.31, 18.75, 19.88, 19.31, 17.61, 18.75, 19.31, 19.88, 17.04, 17.61, 19.31, 17.61, 19.88, 19.31]
[rank3]:2026-01-01 01:29:37,857 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0129_rank3_stage3.svg
[rank3]:	> Counts Sum: 209120, Total Sum: 295680 (70.73%), Ratio(%) per element: [68.18, 68.18, 72.15, 75.0, 68.75, 68.18, 70.45, 72.15, 73.29, 72.72, 72.72, 68.75, 71.02, 72.15, 67.61, 68.18, 69.88, 71.02, 73.29, 70.45, 71.02, 71.02, 72.15, 66.47, 71.02, 69.31, 73.29, 72.15, 73.29, 72.72, 77.27, 68.75, 68.75, 69.31, 68.75, 73.29, 68.75, 66.47, 68.75, 73.29, 69.88, 70.45]
[rank2]:2026-01-01 01:29:38,037 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0129_stage2.svg
[rank0]:2026-01-01 01:29:38,032 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0129_stage0.svg
[rank1]:2026-01-01 01:29:38,059 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0129_stage1.svg
[rank3]:2026-01-01 01:29:38,143 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0129_stage3.svg
[rank0]:2026-01-01 01:32:58,801 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 01:33:02,828 - Avg. fwd time: 33.7793 / Avg. bwd time: 52.6017 / Avg. batch time: 836.3471 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 01:33:02,866 - Avg. fwd time: 25.8588 / Avg. bwd time: 30.0738 / Avg. batch time: 898.1504 (ms) / GPU bubble ratio: 50.18%
[rank2]:2026-01-01 01:33:02,921 -  step: 350  loss: -4.0000  grad_norm:  6.3503  memory:  7.27GiB(15.31%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank0]:2026-01-01 01:33:02,918 - Avg. fwd time: 26.2308 / Avg. bwd time: 25.0371 / Avg. batch time: 1018.9699 (ms) / GPU bubble ratio: 59.75%
[rank0]:2026-01-01 01:33:02,922 -  step: 350  loss: -4.0000  grad_norm:  6.3503  memory: 13.14GiB(27.66%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank1]:2026-01-01 01:33:02,910 - Avg. fwd time: 32.8673 / Avg. bwd time: 38.0636 / Avg. batch time: 973.8164 (ms) / GPU bubble ratio: 41.73%
[rank1]:2026-01-01 01:33:02,921 -  step: 350  loss: -4.0000  grad_norm:  6.3503  memory: 12.15GiB(25.58%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank3]:2026-01-01 01:33:02,923 -  step: 350  loss: 11.1892  grad_norm:  6.3503  memory: 20.97GiB(44.14%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank0]:2026-01-01 01:36:23,282 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 01:36:27,386 - Avg. fwd time: 33.7884 / Avg. bwd time: 52.5630 / Avg. batch time: 836.1072 (ms) / GPU bubble ratio: 17.38%
[rank1]:2026-01-01 01:36:27,469 - Avg. fwd time: 32.8698 / Avg. bwd time: 38.0691 / Avg. batch time: 973.3945 (ms) / GPU bubble ratio: 41.70%
[rank3]:2026-01-01 01:36:27,483 -  step: 400  loss: 10.2841  grad_norm: 33.4623  memory: 20.97GiB(44.14%)  tps: 8,010  tflops: 62.61  mfu: 20.07%
[rank2]:2026-01-01 01:36:27,424 - Avg. fwd time: 25.8608 / Avg. bwd time: 30.0773 / Avg. batch time: 897.8079 (ms) / GPU bubble ratio: 50.16%
[rank2]:2026-01-01 01:36:27,481 -  step: 400  loss: -4.0000  grad_norm: 33.4623  memory:  7.27GiB(15.31%)  tps: 8,009  tflops: 62.61  mfu: 20.07%
[rank0]:2026-01-01 01:36:27,477 - Avg. fwd time: 26.2306 / Avg. bwd time: 25.0302 / Avg. batch time: 1017.0165 (ms) / GPU bubble ratio: 59.68%
[rank0]:2026-01-01 01:36:27,481 -  step: 400  loss: -4.0000  grad_norm: 33.4623  memory: 13.14GiB(27.66%)  tps: 8,009  tflops: 62.61  mfu: 20.07%
[rank1]:2026-01-01 01:36:27,481 -  step: 400  loss: -4.0000  grad_norm: 33.4623  memory: 12.15GiB(25.58%)  tps: 8,009  tflops: 62.61  mfu: 20.07%
[rank1]:2026-01-01 01:36:27,535 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0136_stage1_step400.svg
[rank2]:2026-01-01 01:36:27,535 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0136_stage2_step400.svg
[rank0]:2026-01-01 01:36:27,535 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0136_stage0_step400.svg
[rank3]:2026-01-01 01:36:27,625 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0136_step400_rank3.svg
[rank3]:			> Batch Time: 1004.00 ms, GPU Bubble Ratio: 59.16%, 43.41%, 55.38%, 31.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-307ms   | [S0,MB4,F]  307-25-332ms   | [S0,MB1,B]  384-28-412ms   | [S0,MB5,F]  412-25-438ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-544ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  625-25-650ms   | [S0,MB4,B]  702-28-731ms   | [S0,MB5,B]  804-28-832ms   | [S0,MB6,B]  905-28-933ms   | [S0,MB7,B]  1004-0-1004ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-33-137ms   | [S1,MB0,B]  229-38-268ms   | [S1,MB3,F]  275-32-308ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-33-413ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-32-519ms   | [S1,MB3,B]  547-38-585ms   | [S1,MB6,F]  592-33-625ms   | [S1,MB4,B]  653-38-691ms   | [S1,MB7,F]  699-33-732ms   | [S1,MB5,B]  758-38-797ms   | [S1,MB6,B]  860-37-898ms   | [S1,MB7,B]  961-36-997ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  506-30-536ms   | [S2,MB5,F]  544-25-569ms   | [S2,MB4,B]  612-30-642ms   | [S2,MB6,F]  650-25-675ms   | [S2,MB5,B]  718-30-748ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  926-28-954ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-51-179ms   | [S3,MB1,F]  186-33-220ms   | [S3,MB1,B]  232-52-284ms   | [S3,MB2,F]  291-34-325ms   | [S3,MB2,B]  337-52-389ms   | [S3,MB3,F]  397-34-431ms   | [S3,MB3,B]  442-53-496ms   | [S3,MB4,F]  503-34-537ms   | [S3,MB4,B]  549-52-602ms   | [S3,MB5,F]  609-34-644ms   | [S3,MB5,B]  655-52-708ms   | [S3,MB6,F]  715-34-749ms   | [S3,MB6,B]  761-52-813ms   | [S3,MB7,F]  820-34-855ms   | [S3,MB7,B]  866-52-919ms  
[rank3]:2026-01-01 01:36:27,671 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0136_stage3_step400.svg
[rank0]:2026-01-01 01:36:27,710 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0136_rank0_stage0.svg
[rank0]:	> Counts Sum: 96320, Total Sum: 573440 (16.80%), Ratio(%) per element: [17.18, 17.57, 17.18, 17.57, 17.18, 17.57, 17.57, 17.96, 16.79, 17.18, 17.57, 17.57, 17.57, 16.79, 17.18, 17.18, 17.18, 16.79, 17.18, 16.79, 17.18, 17.57, 17.18, 17.18, 17.18, 16.4, 17.18, 16.79, 17.18, 16.4, 16.79, 17.57, 16.79, 17.57, 17.18, 17.18, 16.79, 15.23, 17.18, 15.62, 16.79, 16.79, 16.01, 16.01, 16.4, 16.4, 17.96, 16.01, 15.62, 16.01, 15.62, 15.23, 16.01, 15.62, 15.62, 14.45]
[rank1]:2026-01-01 01:36:27,716 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0136_rank1_stage1.svg
[rank1]:	> Counts Sum: 120400, Total Sum: 716800 (16.80%), Ratio(%) per element: [16.01, 17.18, 16.4, 17.18, 16.01, 16.4, 16.01, 16.4, 17.57, 17.18, 17.18, 16.79, 17.18, 17.18, 16.79, 17.18, 17.57, 16.01, 17.96, 16.79, 16.01, 17.18, 16.01, 16.01, 16.4, 17.18, 17.18, 16.4, 17.57, 16.79, 17.18, 16.79, 16.79, 17.57, 16.4, 17.57, 17.18, 16.79, 16.4, 16.79, 16.4, 16.4, 16.4, 17.57, 17.18, 17.18, 16.79, 17.18, 16.4, 15.62, 16.01, 16.79, 17.57, 16.01, 16.79, 16.01, 17.18, 16.79, 17.57, 17.18, 16.01, 16.79, 17.18, 17.57, 15.62, 16.01, 17.18, 16.01, 17.57, 17.18]
[rank2]:2026-01-01 01:36:27,711 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0136_rank2_stage2.svg
[rank2]:	> Counts Sum: 96320, Total Sum: 573440 (16.80%), Ratio(%) per element: [16.4, 16.79, 17.18, 16.01, 17.57, 16.79, 17.18, 16.01, 17.18, 17.57, 16.79, 16.4, 17.18, 16.79, 17.18, 15.62, 16.79, 16.79, 17.57, 16.79, 16.4, 16.79, 16.79, 16.01, 17.18, 15.62, 16.79, 17.57, 16.4, 16.79, 16.4, 16.4, 16.79, 16.79, 16.79, 16.79, 17.57, 17.18, 16.01, 16.4, 16.79, 17.18, 17.57, 17.18, 16.79, 16.79, 17.18, 16.4, 16.79, 16.79, 16.79, 16.4, 16.79, 16.4, 16.79, 17.57]
[rank3]:2026-01-01 01:36:27,807 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0136_rank3_stage3.svg
[rank3]:	> Counts Sum: 316720, Total Sum: 430080 (73.64%), Ratio(%) per element: [71.09, 71.48, 74.6, 76.95, 71.87, 71.87, 74.6, 75.0, 76.17, 73.82, 75.39, 71.48, 73.04, 74.6, 71.09, 71.48, 73.43, 73.82, 76.17, 73.43, 74.21, 74.6, 74.6, 69.92, 73.82, 71.48, 75.39, 73.82, 75.78, 74.6, 79.29, 73.04, 72.65, 73.43, 73.04, 74.6, 71.48, 70.7, 72.26, 75.39, 74.21, 73.04]
[rank1]:2026-01-01 01:36:28,137 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0136_stage1.svg
[rank2]:2026-01-01 01:36:28,132 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0136_stage2.svg
[rank0]:2026-01-01 01:36:28,127 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0136_stage0.svg
[rank3]:2026-01-01 01:36:28,214 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0136_stage3.svg
[rank3]:2026-01-01 01:36:51,236 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 01:36:51,496 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 01:36:51,456 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 01:36:51,496 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 01:39:48,980 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 01:39:52,968 - Avg. fwd time: 33.8140 / Avg. bwd time: 52.5564 / Avg. batch time: 836.2559 (ms) / GPU bubble ratio: 17.37%
[rank3]:2026-01-01 01:39:53,065 -  step: 450  loss: 12.7481  grad_norm:  5.7361  memory: 20.97GiB(44.14%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank2]:2026-01-01 01:39:53,006 - Avg. fwd time: 25.8628 / Avg. bwd time: 30.0807 / Avg. batch time: 897.8763 (ms) / GPU bubble ratio: 50.15%
[rank2]:2026-01-01 01:39:53,063 -  step: 450  loss: -4.0000  grad_norm:  5.7361  memory:  7.27GiB(15.31%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank0]:2026-01-01 01:39:53,059 - Avg. fwd time: 26.2310 / Avg. bwd time: 25.0260 / Avg. batch time: 1015.8279 (ms) / GPU bubble ratio: 59.63%
[rank0]:2026-01-01 01:39:53,063 -  step: 450  loss: -4.0000  grad_norm:  5.7361  memory: 13.14GiB(27.66%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank1]:2026-01-01 01:39:53,051 - Avg. fwd time: 32.8728 / Avg. bwd time: 38.0748 / Avg. batch time: 973.3996 (ms) / GPU bubble ratio: 41.69%
[rank1]:2026-01-01 01:39:53,063 -  step: 450  loss: -4.0000  grad_norm:  5.7361  memory: 12.15GiB(25.58%)  tps: 7,970  tflops: 62.30  mfu: 19.97%
[rank0]:2026-01-01 01:43:14,116 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 01:43:18,096 - Avg. fwd time: 33.8318 / Avg. bwd time: 52.5488 / Avg. batch time: 836.3366 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 01:43:18,135 - Avg. fwd time: 25.8645 / Avg. bwd time: 30.0839 / Avg. batch time: 897.8927 (ms) / GPU bubble ratio: 50.15%
[rank1]:2026-01-01 01:43:18,180 - Avg. fwd time: 32.8753 / Avg. bwd time: 38.0792 / Avg. batch time: 973.3634 (ms) / GPU bubble ratio: 41.68%
[rank1]:2026-01-01 01:43:18,192 -  step: 500  loss: -4.0000  grad_norm:  6.3076  memory: 12.15GiB(25.58%)  tps: 7,987  tflops: 62.44  mfu: 20.01%
[rank3]:2026-01-01 01:43:18,195 -  step: 500  loss: 12.9581  grad_norm:  6.3076  memory: 20.97GiB(44.14%)  tps: 7,987  tflops: 62.44  mfu: 20.01%
[rank0]:2026-01-01 01:43:18,188 - Avg. fwd time: 26.2314 / Avg. bwd time: 25.0222 / Avg. batch time: 1014.8390 (ms) / GPU bubble ratio: 59.60%
[rank0]:2026-01-01 01:43:18,193 -  step: 500  loss: -4.0000  grad_norm:  6.3076  memory: 13.14GiB(27.66%)  tps: 7,987  tflops: 62.44  mfu: 20.01%
[rank0]:2026-01-01 01:43:18,243 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0143_stage0_step500.svg
[rank2]:2026-01-01 01:43:18,192 -  step: 500  loss: -4.0000  grad_norm:  6.3076  memory:  7.27GiB(15.31%)  tps: 7,987  tflops: 62.44  mfu: 20.01%
[rank2]:2026-01-01 01:43:18,243 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0143_stage2_step500.svg
[rank1]:2026-01-01 01:43:18,243 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0143_stage1_step500.svg
[rank3]:2026-01-01 01:43:18,338 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0143_step500_rank3.svg
[rank3]:			> Batch Time: 1001.50 ms, GPU Bubble Ratio: 59.16%, 43.49%, 55.38%, 31.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-28-306ms   | [S0,MB4,F]  306-25-331ms   | [S0,MB1,B]  382-28-411ms   | [S0,MB5,F]  411-25-436ms   | [S0,MB2,B]  488-28-517ms   | [S0,MB6,F]  517-25-542ms   | [S0,MB3,B]  595-28-623ms   | [S0,MB7,F]  623-25-649ms   | [S0,MB4,B]  701-28-730ms   | [S0,MB5,B]  802-28-830ms   | [S0,MB6,B]  902-28-930ms   | [S0,MB7,B]  1001-0-1001ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-306ms   | [S1,MB1,B]  333-38-372ms   | [S1,MB4,F]  379-32-412ms   | [S1,MB2,B]  439-38-478ms   | [S1,MB5,F]  485-32-517ms   | [S1,MB3,B]  546-38-584ms   | [S1,MB6,F]  592-32-625ms   | [S1,MB4,B]  652-38-691ms   | [S1,MB7,F]  698-33-731ms   | [S1,MB5,B]  757-38-795ms   | [S1,MB6,B]  857-37-895ms   | [S1,MB7,B]  958-36-994ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-218ms   | [S2,MB2,F]  226-25-251ms   | [S2,MB1,B]  293-30-323ms   | [S2,MB3,F]  330-25-356ms   | [S2,MB2,B]  399-30-429ms   | [S2,MB4,F]  436-25-462ms   | [S2,MB3,B]  505-30-535ms   | [S2,MB5,F]  543-25-568ms   | [S2,MB4,B]  611-30-642ms   | [S2,MB6,F]  649-25-675ms   | [S2,MB5,B]  717-30-747ms   | [S2,MB7,F]  754-25-780ms   | [S2,MB6,B]  821-30-851ms   | [S2,MB7,B]  923-28-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-219ms   | [S3,MB1,B]  230-52-282ms   | [S3,MB2,F]  290-34-324ms   | [S3,MB2,B]  336-52-389ms   | [S3,MB3,F]  396-33-429ms   | [S3,MB3,B]  442-53-495ms   | [S3,MB4,F]  502-34-536ms   | [S3,MB4,B]  548-52-601ms   | [S3,MB5,F]  608-34-642ms   | [S3,MB5,B]  655-52-707ms   | [S3,MB6,F]  714-34-748ms   | [S3,MB6,B]  760-52-812ms   | [S3,MB7,F]  818-34-852ms   | [S3,MB7,B]  864-51-915ms  
[rank3]:2026-01-01 01:43:18,381 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0143_stage3_step500.svg
[rank0]:2026-01-01 01:43:18,412 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0143_rank0_stage0.svg
[rank0]:	> Counts Sum: 118720, Total Sum: 752640 (15.77%), Ratio(%) per element: [16.07, 16.36, 16.07, 16.36, 16.07, 16.36, 16.36, 16.66, 15.77, 16.07, 16.36, 16.36, 16.36, 15.77, 16.07, 16.07, 16.07, 15.77, 16.07, 15.77, 16.07, 16.36, 16.07, 16.07, 16.07, 15.47, 16.07, 15.77, 16.07, 15.47, 15.77, 16.36, 15.77, 16.36, 16.07, 16.07, 15.77, 14.58, 16.07, 14.88, 15.77, 15.77, 15.17, 15.17, 15.47, 15.47, 16.66, 15.17, 14.88, 15.17, 14.88, 14.58, 15.17, 14.88, 14.88, 13.98]
[rank2]:2026-01-01 01:43:18,415 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0143_rank2_stage2.svg
[rank2]:	> Counts Sum: 118720, Total Sum: 752640 (15.77%), Ratio(%) per element: [15.47, 15.77, 16.07, 15.17, 16.36, 15.77, 16.07, 15.17, 16.07, 16.36, 15.77, 15.47, 16.07, 15.77, 16.07, 14.88, 15.77, 15.77, 16.36, 15.77, 15.47, 15.77, 15.77, 15.17, 16.07, 14.88, 15.77, 16.36, 15.47, 15.77, 15.47, 15.47, 15.77, 15.77, 15.77, 15.77, 16.36, 16.07, 15.17, 15.47, 15.77, 16.07, 16.36, 16.07, 15.77, 15.77, 16.07, 15.47, 15.77, 15.77, 15.77, 15.47, 15.77, 15.47, 15.77, 16.36]
[rank1]:2026-01-01 01:43:18,429 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0143_rank1_stage1.svg
[rank1]:	> Counts Sum: 148400, Total Sum: 940800 (15.77%), Ratio(%) per element: [15.17, 16.07, 15.47, 16.07, 15.17, 15.47, 15.17, 15.47, 16.36, 16.07, 16.07, 15.77, 16.07, 16.07, 15.77, 16.07, 16.36, 15.17, 16.66, 15.77, 15.17, 16.07, 15.17, 15.17, 15.47, 16.07, 16.07, 15.47, 16.36, 15.77, 16.07, 15.77, 15.77, 16.36, 15.47, 16.36, 16.07, 15.77, 15.47, 15.77, 15.47, 15.47, 15.47, 16.36, 16.07, 16.07, 15.77, 16.07, 15.47, 14.88, 15.17, 15.77, 16.36, 15.17, 15.77, 15.17, 16.07, 15.77, 16.36, 16.07, 15.17, 15.77, 16.07, 16.36, 14.88, 15.17, 16.07, 15.17, 16.36, 16.07]
[rank3]:2026-01-01 01:43:18,518 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0143_rank3_stage3.svg
[rank3]:	> Counts Sum: 424320, Total Sum: 564480 (75.17%), Ratio(%) per element: [72.91, 74.1, 75.59, 76.78, 73.8, 73.8, 75.29, 76.78, 76.48, 76.19, 75.89, 73.8, 74.1, 75.0, 73.21, 73.8, 75.29, 74.4, 77.38, 75.0, 75.59, 75.89, 76.48, 72.91, 76.19, 73.51, 76.78, 75.0, 76.19, 76.78, 80.05, 74.7, 75.0, 74.1, 75.0, 75.59, 73.21, 73.51, 74.1, 76.78, 75.0, 75.0]
[rank1]:2026-01-01 01:43:18,988 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0143_stage1.svg
[rank0]:2026-01-01 01:43:18,956 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0143_stage0.svg
[rank2]:2026-01-01 01:43:18,963 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0143_stage2.svg
[rank3]:2026-01-01 01:43:19,054 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0143_stage3.svg
[rank0]:2026-01-01 01:46:39,264 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2026-01-01 01:46:43,385 - Avg. fwd time: 32.8749 / Avg. bwd time: 38.0805 / Avg. batch time: 973.0644 (ms) / GPU bubble ratio: 41.66%
[rank3]:2026-01-01 01:46:43,300 - Avg. fwd time: 33.8318 / Avg. bwd time: 52.5247 / Avg. batch time: 836.1396 (ms) / GPU bubble ratio: 17.38%
[rank0]:2026-01-01 01:46:43,394 - Avg. fwd time: 26.2305 / Avg. bwd time: 25.0177 / Avg. batch time: 1013.7616 (ms) / GPU bubble ratio: 59.56%
[rank0]:2026-01-01 01:46:43,398 -  step: 550  loss: -4.0000  grad_norm:  5.8072  memory: 13.14GiB(27.66%)  tps: 7,984  tflops: 62.42  mfu: 20.01%
[rank2]:2026-01-01 01:46:43,339 - Avg. fwd time: 25.8646 / Avg. bwd time: 30.0853 / Avg. batch time: 897.6401 (ms) / GPU bubble ratio: 50.14%
[rank2]:2026-01-01 01:46:43,397 -  step: 550  loss: -4.0000  grad_norm:  5.8072  memory:  7.27GiB(15.31%)  tps: 7,984  tflops: 62.42  mfu: 20.01%
[rank1]:2026-01-01 01:46:43,397 -  step: 550  loss: -4.0000  grad_norm:  5.8072  memory: 12.15GiB(25.58%)  tps: 7,984  tflops: 62.42  mfu: 20.01%
[rank3]:2026-01-01 01:46:43,400 -  step: 550  loss: 11.0990  grad_norm:  5.8072  memory: 20.97GiB(44.14%)  tps: 7,984  tflops: 62.42  mfu: 20.01%
[rank0]:2026-01-01 01:50:03,928 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 01:50:08,066 - Avg. fwd time: 33.8357 / Avg. bwd time: 52.5081 / Avg. batch time: 836.0327 (ms) / GPU bubble ratio: 17.38%
[rank3]:2026-01-01 01:50:08,167 -  step: 600  loss: 10.0152  grad_norm: 30.8425  memory: 20.97GiB(44.14%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank1]:2026-01-01 01:50:08,152 - Avg. fwd time: 32.8757 / Avg. bwd time: 38.0822 / Avg. batch time: 972.8785 (ms) / GPU bubble ratio: 41.65%
[rank1]:2026-01-01 01:50:08,165 -  step: 600  loss: -4.0000  grad_norm: 30.8425  memory: 12.15GiB(25.58%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank0]:2026-01-01 01:50:08,161 - Avg. fwd time: 26.2307 / Avg. bwd time: 25.0146 / Avg. batch time: 1012.9280 (ms) / GPU bubble ratio: 59.53%
[rank0]:2026-01-01 01:50:08,165 -  step: 600  loss: -4.0000  grad_norm: 30.8425  memory: 13.14GiB(27.66%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank2]:2026-01-01 01:50:08,105 - Avg. fwd time: 25.8657 / Avg. bwd time: 30.0870 / Avg. batch time: 897.4898 (ms) / GPU bubble ratio: 50.13%
[rank2]:2026-01-01 01:50:08,165 -  step: 600  loss: -4.0000  grad_norm: 30.8425  memory:  7.27GiB(15.31%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank1]:2026-01-01 01:50:08,216 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0150_stage1_step600.svg
[rank0]:2026-01-01 01:50:08,218 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0150_stage0_step600.svg
[rank2]:2026-01-01 01:50:08,218 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0150_stage2_step600.svg
[rank3]:2026-01-01 01:50:08,311 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0150_step600_rank3.svg
[rank3]:			> Batch Time: 1002.00 ms, GPU Bubble Ratio: 59.07%, 43.24%, 55.28%, 31.10%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  383-28-412ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  624-25-650ms   | [S0,MB4,B]  700-28-729ms   | [S0,MB5,B]  803-28-831ms   | [S0,MB6,B]  904-28-932ms   | [S0,MB7,B]  1002-0-1002ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-33-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-33-413ms   | [S1,MB2,B]  441-38-479ms   | [S1,MB5,F]  486-33-519ms   | [S1,MB3,B]  547-38-585ms   | [S1,MB6,F]  592-33-625ms   | [S1,MB4,B]  651-38-690ms   | [S1,MB7,F]  697-33-730ms   | [S1,MB5,B]  757-38-796ms   | [S1,MB6,B]  859-38-897ms   | [S1,MB7,B]  959-36-995ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  98-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  506-30-537ms   | [S2,MB5,F]  544-25-570ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  648-25-674ms   | [S2,MB5,B]  717-30-747ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  924-28-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-50-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-283ms   | [S3,MB2,F]  291-34-325ms   | [S3,MB2,B]  337-53-390ms   | [S3,MB3,F]  397-34-431ms   | [S3,MB3,B]  443-53-497ms   | [S3,MB4,F]  503-34-538ms   | [S3,MB4,B]  549-51-601ms   | [S3,MB5,F]  607-34-642ms   | [S3,MB5,B]  653-52-706ms   | [S3,MB6,F]  714-34-748ms   | [S3,MB6,B]  760-52-813ms   | [S3,MB7,F]  819-34-854ms   | [S3,MB7,B]  865-52-918ms  
[rank3]:2026-01-01 01:50:08,355 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0150_stage3_step600.svg
[rank0]:2026-01-01 01:50:08,391 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0150_rank0_stage0.svg
[rank0]:	> Counts Sum: 141120, Total Sum: 931840 (15.14%), Ratio(%) per element: [15.38, 15.62, 15.38, 15.62, 15.38, 15.62, 15.62, 15.86, 15.14, 15.38, 15.62, 15.62, 15.62, 15.14, 15.38, 15.38, 15.38, 15.14, 15.38, 15.14, 15.38, 15.62, 15.38, 15.38, 15.38, 14.9, 15.38, 15.14, 15.38, 14.9, 15.14, 15.62, 15.14, 15.62, 15.38, 15.38, 15.14, 14.18, 15.38, 14.42, 15.14, 15.14, 14.66, 14.66, 14.9, 14.9, 15.86, 14.66, 14.42, 14.66, 14.42, 14.18, 14.66, 14.42, 14.42, 13.7]
[rank2]:2026-01-01 01:50:08,392 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0150_rank2_stage2.svg
[rank2]:	> Counts Sum: 141120, Total Sum: 931840 (15.14%), Ratio(%) per element: [14.9, 15.14, 15.38, 14.66, 15.62, 15.14, 15.38, 14.66, 15.38, 15.62, 15.14, 14.9, 15.38, 15.14, 15.38, 14.42, 15.14, 15.14, 15.62, 15.14, 14.9, 15.14, 15.14, 14.66, 15.38, 14.42, 15.14, 15.62, 14.9, 15.14, 14.9, 14.9, 15.14, 15.14, 15.14, 15.14, 15.62, 15.38, 14.66, 14.9, 15.14, 15.38, 15.62, 15.38, 15.14, 15.14, 15.38, 14.9, 15.14, 15.14, 15.14, 14.9, 15.14, 14.9, 15.14, 15.62]
[rank1]:2026-01-01 01:50:08,399 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0150_rank1_stage1.svg
[rank1]:	> Counts Sum: 176400, Total Sum: 1164800 (15.14%), Ratio(%) per element: [14.66, 15.38, 14.9, 15.38, 14.66, 14.9, 14.66, 14.9, 15.62, 15.38, 15.38, 15.14, 15.38, 15.38, 15.14, 15.38, 15.62, 14.66, 15.86, 15.14, 14.66, 15.38, 14.66, 14.66, 14.9, 15.38, 15.38, 14.9, 15.62, 15.14, 15.38, 15.14, 15.14, 15.62, 14.9, 15.62, 15.38, 15.14, 14.9, 15.14, 14.9, 14.9, 14.9, 15.62, 15.38, 15.38, 15.14, 15.38, 14.9, 14.42, 14.66, 15.14, 15.62, 14.66, 15.14, 14.66, 15.38, 15.14, 15.62, 15.38, 14.66, 15.14, 15.38, 15.62, 14.42, 14.66, 15.38, 14.66, 15.62, 15.38]
[rank3]:2026-01-01 01:50:08,493 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0150_rank3_stage3.svg
[rank3]:	> Counts Sum: 531920, Total Sum: 698880 (76.11%), Ratio(%) per element: [74.27, 74.75, 76.44, 77.64, 75.24, 74.75, 75.72, 77.4, 77.4, 76.44, 76.44, 74.75, 75.24, 75.96, 74.75, 74.51, 77.16, 75.96, 77.64, 75.72, 75.96, 77.16, 77.4, 74.75, 76.44, 74.75, 77.64, 75.96, 77.16, 77.4, 80.52, 76.44, 76.44, 75.24, 75.48, 76.68, 74.75, 74.75, 75.24, 77.16, 75.72, 75.24]
[rank0]:2026-01-01 01:50:09,058 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0150_stage0.svg
[rank2]:2026-01-01 01:50:09,063 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0150_stage2.svg
[rank3]:2026-01-01 01:50:09,150 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0150_stage3.svg
[rank1]:2026-01-01 01:50:09,075 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0150_stage1.svg
[rank0]:2026-01-01 01:53:30,303 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 01:53:34,297 - Avg. fwd time: 33.8518 / Avg. bwd time: 52.5115 / Avg. batch time: 836.1873 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 01:53:34,335 - Avg. fwd time: 25.8686 / Avg. bwd time: 30.0901 / Avg. batch time: 897.6094 (ms) / GPU bubble ratio: 50.13%
[rank3]:2026-01-01 01:53:34,397 -  step: 650  loss: 12.3055  grad_norm:  6.7301  memory: 20.97GiB(44.14%)  tps: 7,945  tflops: 62.11  mfu: 19.91%
[rank1]:2026-01-01 01:53:34,381 - Avg. fwd time: 32.8804 / Avg. bwd time: 38.0878 / Avg. batch time: 972.9713 (ms) / GPU bubble ratio: 41.65%
[rank1]:2026-01-01 01:53:34,395 -  step: 650  loss: -4.0000  grad_norm:  6.7301  memory: 12.15GiB(25.58%)  tps: 7,945  tflops: 62.11  mfu: 19.91%
[rank0]:2026-01-01 01:53:34,391 - Avg. fwd time: 26.2333 / Avg. bwd time: 25.0137 / Avg. batch time: 1012.4725 (ms) / GPU bubble ratio: 59.51%
[rank0]:2026-01-01 01:53:34,395 -  step: 650  loss: -4.0000  grad_norm:  6.7301  memory: 13.14GiB(27.66%)  tps: 7,945  tflops: 62.11  mfu: 19.91%
[rank2]:2026-01-01 01:53:34,395 -  step: 650  loss: -4.0000  grad_norm:  6.7301  memory:  7.27GiB(15.31%)  tps: 7,945  tflops: 62.11  mfu: 19.91%
[rank0]:2026-01-01 01:56:56,035 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 01:57:00,025 - Avg. fwd time: 33.8718 / Avg. bwd time: 52.5214 / Avg. batch time: 836.4264 (ms) / GPU bubble ratio: 17.37%
[rank3]:2026-01-01 01:57:00,128 -  step: 700  loss: 13.1112  grad_norm:  6.3289  memory: 20.97GiB(44.14%)  tps: 7,964  tflops: 62.26  mfu: 19.95%
[rank0]:2026-01-01 01:57:00,122 - Avg. fwd time: 26.2367 / Avg. bwd time: 25.0139 / Avg. batch time: 1012.2020 (ms) / GPU bubble ratio: 59.49%
[rank0]:2026-01-01 01:57:00,127 -  step: 700  loss: -4.0000  grad_norm:  6.3289  memory: 13.14GiB(27.66%)  tps: 7,964  tflops: 62.26  mfu: 19.95%
[rank2]:2026-01-01 01:57:00,065 - Avg. fwd time: 25.8726 / Avg. bwd time: 30.0942 / Avg. batch time: 897.8220 (ms) / GPU bubble ratio: 50.13%
[rank2]:2026-01-01 01:57:00,126 -  step: 700  loss: -4.0000  grad_norm:  6.3289  memory:  7.27GiB(15.31%)  tps: 7,964  tflops: 62.26  mfu: 19.95%
[rank1]:2026-01-01 01:57:00,112 - Avg. fwd time: 32.8872 / Avg. bwd time: 38.0955 / Avg. batch time: 973.1667 (ms) / GPU bubble ratio: 41.65%
[rank1]:2026-01-01 01:57:00,126 -  step: 700  loss: -4.0000  grad_norm:  6.3289  memory: 12.15GiB(25.58%)  tps: 7,964  tflops: 62.26  mfu: 19.95%
[rank1]:2026-01-01 01:57:00,179 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0157_stage1_step700.svg
[rank0]:2026-01-01 01:57:00,181 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0157_stage0_step700.svg
[rank2]:2026-01-01 01:57:00,181 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0157_stage2_step700.svg
[rank3]:2026-01-01 01:57:00,274 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0157_step700_rank3.svg
[rank3]:			> Batch Time: 1004.00 ms, GPU Bubble Ratio: 59.19%, 43.43%, 55.41%, 31.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  383-28-412ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-544ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  625-25-650ms   | [S0,MB4,B]  701-28-730ms   | [S0,MB5,B]  803-28-832ms   | [S0,MB6,B]  905-28-933ms   | [S0,MB7,B]  1004-0-1004ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-32-519ms   | [S1,MB3,B]  547-38-586ms   | [S1,MB6,F]  593-33-626ms   | [S1,MB4,B]  652-38-691ms   | [S1,MB7,F]  698-33-731ms   | [S1,MB5,B]  758-38-797ms   | [S1,MB6,B]  860-38-898ms   | [S1,MB7,B]  961-36-997ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  293-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  399-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  507-30-537ms   | [S2,MB5,F]  544-25-570ms   | [S2,MB4,B]  612-30-642ms   | [S2,MB6,F]  649-25-675ms   | [S2,MB5,B]  718-30-748ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  823-30-854ms   | [S2,MB7,B]  925-28-954ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  127-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-283ms   | [S3,MB2,F]  290-34-325ms   | [S3,MB2,B]  336-52-389ms   | [S3,MB3,F]  396-34-431ms   | [S3,MB3,B]  443-53-497ms   | [S3,MB4,F]  503-34-538ms   | [S3,MB4,B]  549-52-602ms   | [S3,MB5,F]  609-34-644ms   | [S3,MB5,B]  655-52-708ms   | [S3,MB6,F]  715-34-749ms   | [S3,MB6,B]  761-52-813ms   | [S3,MB7,F]  820-34-855ms   | [S3,MB7,B]  867-52-920ms  
[rank3]:2026-01-01 01:57:00,319 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0157_stage3_step700.svg
[rank0]:2026-01-01 01:57:00,352 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0157_rank0_stage0.svg
[rank0]:	> Counts Sum: 163520, Total Sum: 1111040 (14.72%), Ratio(%) per element: [14.91, 15.12, 14.91, 15.12, 14.91, 15.12, 15.12, 15.32, 14.71, 14.91, 15.12, 15.12, 15.12, 14.71, 14.91, 14.91, 14.91, 14.71, 14.91, 14.71, 14.91, 15.12, 14.91, 14.91, 14.91, 14.51, 14.91, 14.71, 14.91, 14.51, 14.71, 15.12, 14.71, 15.12, 14.91, 14.91, 14.71, 13.91, 14.91, 14.11, 14.71, 14.71, 14.31, 14.31, 14.51, 14.51, 15.32, 14.31, 14.11, 14.31, 14.11, 13.91, 14.31, 14.11, 14.11, 13.5]
[rank2]:2026-01-01 01:57:00,353 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0157_rank2_stage2.svg
[rank2]:	> Counts Sum: 163520, Total Sum: 1111040 (14.72%), Ratio(%) per element: [14.51, 14.71, 14.91, 14.31, 15.12, 14.71, 14.91, 14.31, 14.91, 15.12, 14.71, 14.51, 14.91, 14.71, 14.91, 14.11, 14.71, 14.71, 15.12, 14.71, 14.51, 14.71, 14.71, 14.31, 14.91, 14.11, 14.71, 15.12, 14.51, 14.71, 14.51, 14.51, 14.71, 14.71, 14.71, 14.71, 15.12, 14.91, 14.31, 14.51, 14.71, 14.91, 15.12, 14.91, 14.71, 14.71, 14.91, 14.51, 14.71, 14.71, 14.71, 14.51, 14.71, 14.51, 14.71, 15.12]
[rank1]:2026-01-01 01:57:00,362 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0157_rank1_stage1.svg
[rank1]:	> Counts Sum: 204400, Total Sum: 1388800 (14.72%), Ratio(%) per element: [14.31, 14.91, 14.51, 14.91, 14.31, 14.51, 14.31, 14.51, 15.12, 14.91, 14.91, 14.71, 14.91, 14.91, 14.71, 14.91, 15.12, 14.31, 15.32, 14.71, 14.31, 14.91, 14.31, 14.31, 14.51, 14.91, 14.91, 14.51, 15.12, 14.71, 14.91, 14.71, 14.71, 15.12, 14.51, 15.12, 14.91, 14.71, 14.51, 14.71, 14.51, 14.51, 14.51, 15.12, 14.91, 14.91, 14.71, 14.91, 14.51, 14.11, 14.31, 14.71, 15.12, 14.31, 14.71, 14.31, 14.91, 14.71, 15.12, 14.91, 14.31, 14.71, 14.91, 15.12, 14.11, 14.31, 14.91, 14.31, 15.12, 14.91]
[rank3]:2026-01-01 01:57:00,477 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0157_rank3_stage3.svg
[rank3]:	> Counts Sum: 639520, Total Sum: 833280 (76.75%), Ratio(%) per element: [75.0, 75.6, 76.81, 78.22, 76.2, 75.6, 76.61, 77.82, 78.42, 76.81, 77.01, 75.6, 75.8, 77.21, 75.8, 75.6, 78.22, 76.41, 78.22, 76.2, 77.01, 77.62, 77.62, 75.4, 77.41, 75.4, 77.62, 76.2, 77.41, 77.21, 80.44, 77.41, 77.21, 76.2, 76.2, 76.81, 75.2, 75.8, 75.8, 77.41, 76.81, 75.8]
[rank0]:2026-01-01 01:57:01,154 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0157_stage0.svg
[rank1]:2026-01-01 01:57:01,177 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0157_stage1.svg
[rank2]:2026-01-01 01:57:01,169 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0157_stage2.svg
[rank3]:2026-01-01 01:57:01,259 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0157_stage3.svg
[rank0]:2026-01-01 02:00:22,630 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 02:00:26,683 - Avg. fwd time: 33.8886 / Avg. bwd time: 52.5290 / Avg. batch time: 836.6202 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 02:00:26,723 - Avg. fwd time: 25.8762 / Avg. bwd time: 30.0977 / Avg. batch time: 897.9987 (ms) / GPU bubble ratio: 50.13%
[rank1]:2026-01-01 02:00:26,770 - Avg. fwd time: 32.8935 / Avg. bwd time: 38.1023 / Avg. batch time: 973.3285 (ms) / GPU bubble ratio: 41.65%
[rank1]:2026-01-01 02:00:26,784 -  step: 750  loss: -4.0000  grad_norm:  4.8490  memory: 12.15GiB(25.58%)  tps: 7,928  tflops: 61.98  mfu: 19.86%
[rank3]:2026-01-01 02:00:26,786 -  step: 750  loss: 11.0736  grad_norm:  4.8490  memory: 20.97GiB(44.14%)  tps: 7,928  tflops: 61.98  mfu: 19.86%
[rank0]:2026-01-01 02:00:26,780 - Avg. fwd time: 26.2399 / Avg. bwd time: 25.0138 / Avg. batch time: 1011.9634 (ms) / GPU bubble ratio: 59.48%
[rank0]:2026-01-01 02:00:26,785 -  step: 750  loss: -4.0000  grad_norm:  4.8490  memory: 13.14GiB(27.66%)  tps: 7,928  tflops: 61.98  mfu: 19.86%
[rank2]:2026-01-01 02:00:26,784 -  step: 750  loss: -4.0000  grad_norm:  4.8490  memory:  7.27GiB(15.31%)  tps: 7,928  tflops: 61.98  mfu: 19.86%
[rank0]:2026-01-01 02:03:47,788 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 02:03:51,915 - Avg. fwd time: 33.8965 / Avg. bwd time: 52.5275 / Avg. batch time: 836.6717 (ms) / GPU bubble ratio: 17.36%
[rank2]:2026-01-01 02:03:51,956 - Avg. fwd time: 25.8779 / Avg. bwd time: 30.0993 / Avg. batch time: 898.0277 (ms) / GPU bubble ratio: 50.13%
[rank0]:2026-01-01 02:03:52,015 - Avg. fwd time: 26.2412 / Avg. bwd time: 25.0126 / Avg. batch time: 1011.6171 (ms) / GPU bubble ratio: 59.47%
[rank1]:2026-01-01 02:03:52,004 - Avg. fwd time: 32.8964 / Avg. bwd time: 38.1058 / Avg. batch time: 973.3395 (ms) / GPU bubble ratio: 41.64%
[rank1]:2026-01-01 02:03:52,019 -  step: 800  loss: -4.0000  grad_norm: 27.2693  memory: 12.15GiB(25.58%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank1]:2026-01-01 02:03:52,019 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2693  tps: 8,417  tflops: 65.80  mfu: 19.19%
[rank1]:2026-01-01 02:03:52,019 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 02:03:52,020 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 02:03:52,021 -  step: 800  loss:  9.8078  grad_norm: 27.2693  memory: 20.97GiB(44.14%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank3]:2026-01-01 02:03:52,022 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm: 27.2693  tps: 8,423  tflops: 65.85  mfu: 19.32%
[rank3]:2026-01-01 02:03:52,023 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 02:03:52,024 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 02:03:52,019 -  step: 800  loss: -4.0000  grad_norm: 27.2693  memory:  7.27GiB(15.31%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank2]:2026-01-01 02:03:52,019 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2693  tps: 8,417  tflops: 65.80  mfu: 19.20%
[rank2]:2026-01-01 02:03:52,019 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 02:03:52,020 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 02:03:52,019 -  step: 800  loss: -4.0000  grad_norm: 27.2693  memory: 13.14GiB(27.66%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank0]:2026-01-01 02:03:52,019 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2693  tps: 8,416  tflops: 65.79  mfu: 19.17%
[rank0]:2026-01-01 02:03:52,019 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 02:03:52,020 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 02:03:54,080 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2026-01-01 02:03:54,145 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/260101_0203_stage1_final800.svg
[rank2]:2026-01-01 02:03:54,144 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/260101_0203_stage2_final800.svg
[rank0]:2026-01-01 02:03:54,147 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/260101_0203_stage0_final800.svg
[rank3]:2026-01-01 02:03:54,235 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0203_final800_rank3.svg
[rank3]:			> Batch Time: 1003.50 ms, GPU Bubble Ratio: 59.18%, 43.43%, 55.39%, 31.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  307-25-332ms   | [S0,MB1,B]  383-28-412ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  624-25-650ms   | [S0,MB4,B]  701-28-730ms   | [S0,MB5,B]  803-28-832ms   | [S0,MB6,B]  904-28-933ms   | [S0,MB7,B]  1003-0-1003ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  275-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-33-413ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-33-519ms   | [S1,MB3,B]  547-38-585ms   | [S1,MB6,F]  592-33-625ms   | [S1,MB4,B]  652-38-691ms   | [S1,MB7,F]  698-33-731ms   | [S1,MB5,B]  758-38-796ms   | [S1,MB6,B]  859-37-897ms   | [S1,MB7,B]  960-36-997ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  506-30-536ms   | [S2,MB5,F]  544-25-569ms   | [S2,MB4,B]  612-30-642ms   | [S2,MB6,F]  649-25-675ms   | [S2,MB5,B]  718-30-748ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  925-28-953ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  291-34-325ms   | [S3,MB2,B]  337-52-390ms   | [S3,MB3,F]  397-34-431ms   | [S3,MB3,B]  443-53-496ms   | [S3,MB4,F]  503-34-537ms   | [S3,MB4,B]  549-52-602ms   | [S3,MB5,F]  609-34-643ms   | [S3,MB5,B]  655-52-707ms   | [S3,MB6,F]  714-34-749ms   | [S3,MB6,B]  761-52-813ms   | [S3,MB7,F]  820-34-854ms   | [S3,MB7,B]  866-52-918ms  
[rank2]:2026-01-01 02:03:54,313 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0203_rank2_stage2.svg
[rank2]:	> Counts Sum: 185920, Total Sum: 1290240 (14.41%), Ratio(%) per element: [14.23, 14.4, 14.58, 14.06, 14.75, 14.4, 14.58, 14.06, 14.58, 14.75, 14.4, 14.23, 14.58, 14.4, 14.58, 13.88, 14.4, 14.4, 14.75, 14.4, 14.23, 14.4, 14.4, 14.06, 14.58, 13.88, 14.4, 14.75, 14.23, 14.4, 14.23, 14.23, 14.4, 14.4, 14.4, 14.4, 14.75, 14.58, 14.06, 14.23, 14.4, 14.58, 14.75, 14.58, 14.4, 14.4, 14.58, 14.23, 14.4, 14.4, 14.4, 14.23, 14.4, 14.23, 14.4, 14.75]
[rank1]:2026-01-01 02:03:54,329 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0203_rank1_stage1.svg
[rank1]:	> Counts Sum: 232400, Total Sum: 1612800 (14.41%), Ratio(%) per element: [14.06, 14.58, 14.23, 14.58, 14.06, 14.23, 14.06, 14.23, 14.75, 14.58, 14.58, 14.4, 14.58, 14.58, 14.4, 14.58, 14.75, 14.06, 14.93, 14.4, 14.06, 14.58, 14.06, 14.06, 14.23, 14.58, 14.58, 14.23, 14.75, 14.4, 14.58, 14.4, 14.4, 14.75, 14.23, 14.75, 14.58, 14.4, 14.23, 14.4, 14.23, 14.23, 14.23, 14.75, 14.58, 14.58, 14.4, 14.58, 14.23, 13.88, 14.06, 14.4, 14.75, 14.06, 14.4, 14.06, 14.58, 14.4, 14.75, 14.58, 14.06, 14.4, 14.58, 14.75, 13.88, 14.06, 14.58, 14.06, 14.75, 14.58]
[rank3]:2026-01-01 02:03:54,372 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/pipeline_schedule/260101_0203_thry_final800_rank3.svg
[rank3]:			> Batch Time: 979.98 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-29-29ms      | [S0,MB1,F]  29-29-59ms     | [S0,MB2,F]  59-29-89ms     | [S0,MB3,F]  89-29-118ms    | [S0,MB0,B]  296-59-356ms   | [S0,MB4,F]  356-29-386ms   | [S0,MB1,B]  386-59-445ms   | [S0,MB5,F]  445-29-475ms   | [S0,MB2,B]  475-59-534ms   | [S0,MB6,F]  534-29-564ms   | [S0,MB3,B]  564-59-623ms   | [S0,MB7,F]  623-29-653ms   | [S0,MB4,B]  653-59-712ms   | [S0,MB5,B]  742-59-801ms   | [S0,MB6,B]  831-59-890ms   | [S0,MB7,B]  920-59-979ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  29-29-59ms     | [S1,MB1,F]  59-29-89ms     | [S1,MB2,F]  89-29-118ms    | [S1,MB0,B]  237-59-296ms   | [S1,MB3,F]  296-29-326ms   | [S1,MB1,B]  326-59-386ms   | [S1,MB4,F]  386-29-415ms   | [S1,MB2,B]  415-59-475ms   | [S1,MB5,F]  475-29-504ms   | [S1,MB3,B]  504-59-564ms   | [S1,MB6,F]  564-29-593ms   | [S1,MB4,B]  593-59-653ms   | [S1,MB7,F]  653-29-683ms   | [S1,MB5,B]  683-59-742ms   | [S1,MB6,B]  772-59-831ms   | [S1,MB7,B]  861-59-920ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  59-29-89ms     | [S2,MB1,F]  89-29-118ms    | [S2,MB0,B]  178-59-237ms   | [S2,MB2,F]  237-29-267ms   | [S2,MB1,B]  267-59-326ms   | [S2,MB3,F]  326-29-356ms   | [S2,MB2,B]  356-59-415ms   | [S2,MB4,F]  415-29-445ms   | [S2,MB3,B]  445-59-504ms   | [S2,MB5,F]  504-29-534ms   | [S2,MB4,B]  534-59-593ms   | [S2,MB6,F]  593-29-623ms   | [S2,MB5,B]  623-59-683ms   | [S2,MB7,F]  683-29-712ms   | [S2,MB6,B]  712-59-772ms   | [S2,MB7,B]  801-59-861ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  89-29-118ms    | [S3,MB0,B]  118-59-178ms   | [S3,MB1,F]  178-29-207ms   | [S3,MB1,B]  207-59-267ms   | [S3,MB2,F]  267-29-296ms   | [S3,MB2,B]  296-59-356ms   | [S3,MB3,F]  356-29-386ms   | [S3,MB3,B]  386-59-445ms   | [S3,MB4,F]  445-29-475ms   | [S3,MB4,B]  475-59-534ms   | [S3,MB5,F]  534-29-564ms   | [S3,MB5,B]  564-59-623ms   | [S3,MB6,F]  623-29-653ms   | [S3,MB6,B]  653-59-712ms   | [S3,MB7,F]  712-29-742ms   | [S3,MB7,B]  742-59-801ms  
[rank0]:2026-01-01 02:03:54,326 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0203_rank0_stage0.svg
[rank0]:	> Counts Sum: 185920, Total Sum: 1290240 (14.41%), Ratio(%) per element: [14.58, 14.75, 14.58, 14.75, 14.58, 14.75, 14.75, 14.93, 14.4, 14.58, 14.75, 14.75, 14.75, 14.4, 14.58, 14.58, 14.58, 14.4, 14.58, 14.4, 14.58, 14.75, 14.58, 14.58, 14.58, 14.23, 14.58, 14.4, 14.58, 14.23, 14.4, 14.75, 14.4, 14.75, 14.58, 14.58, 14.4, 13.71, 14.58, 13.88, 14.4, 14.4, 14.06, 14.06, 14.23, 14.23, 14.93, 14.06, 13.88, 14.06, 13.88, 13.71, 14.06, 13.88, 13.88, 13.36]
[rank3]:2026-01-01 02:03:54,420 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/260101_0203_stage3_final800.svg
[rank3]:2026-01-01 02:03:54,559 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/frozen_params_histogram/260101_0203_rank3_stage3.svg
[rank3]:	> Counts Sum: 747120, Total Sum: 967680 (77.21%), Ratio(%) per element: [75.52, 76.04, 76.56, 78.47, 76.21, 76.73, 76.9, 77.77, 78.47, 77.6, 77.6, 76.38, 76.73, 77.6, 76.21, 76.38, 78.81, 76.73, 78.47, 76.73, 77.43, 77.95, 77.77, 76.38, 78.29, 76.04, 78.12, 77.08, 77.25, 77.6, 79.86, 77.6, 77.77, 76.73, 76.56, 77.77, 76.21, 76.21, 76.38, 78.29, 77.08, 76.21]
[rank1]:2026-01-01 02:03:55,271 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0203_stage1.svg
[rank1]:2026-01-01 02:03:55,273 - Destroying the purge thread.
[rank2]:2026-01-01 02:03:55,240 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0203_stage2.svg
[rank2]:2026-01-01 02:03:55,242 - Destroying the purge thread.
[rank2]:2026-01-01 02:03:55,392 - Process group destroyed
[rank0]:2026-01-01 02:03:55,348 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0203_stage0.svg
[rank0]:2026-01-01 02:03:55,350 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-01 02:03:55,406 - Process group destroyed
[rank3]:2026-01-01 02:03:55,474 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1/afr_time_plot/260101_0203_stage3.svg
[rank3]:2026-01-01 02:03:55,477 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 325-346
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–‚â–‚â–â–‚â–ˆâ–â–â–â–ˆâ–â–â–â–‡â–â–â–â–†
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.89033
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 19.32432
[rank3]:wandb:             final/avg_tflops 65.8467
[rank3]:wandb:    final/avg_throughput(tps) 8422.94377
[rank3]:wandb:              final/grad_norm 27.26929
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 27.26929
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_1F1B_fullrand7_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/eqsaqxhg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_1F1B_fullrand7_42_dm1/20260101-0108/wandb/run-20260101_010843-eqsaqxhg/logs
[rank3]:2026-01-01 02:03:56,965 - Process group destroyed
[rank0]:2026-01-01 02:03:57,350 - Training completed
[rank0]:2026-01-01 02:03:57,351 - Destroying the purge thread.
[rank0]:2026-01-01 02:03:57,419 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.2', 'layers.0', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.8', 'layers.6', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.11', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.14', 'norm', 'output', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_1F1B_fullrand7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_1F1B_fullrand7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_1F1B_fullrand7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_1F1B_fullrand7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_1F1B_fullrand7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_1F1B_fullrand7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_1F1B_fullrand7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_1F1B_fullrand7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
