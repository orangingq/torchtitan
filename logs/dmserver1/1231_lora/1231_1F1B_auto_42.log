
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 05:46:49 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_1F1B_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with auto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2026-01-01 05:46:56,809 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank1]:2026-01-01 05:46:56,892 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank2]:2026-01-01 05:46:56,892 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank3]:2026-01-01 05:46:57,021 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 05:46:57,023 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-01 05:46:57,171 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 05:46:57,175 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-01 05:46:57,184 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 05:46:57,209 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank2]:2026-01-01 05:46:57,186 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 05:46:57,426 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 05:46:57,428 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 05:46:57,432 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 05:46:57,433 - Loading tokenizer from tokenizer.json
[rank0]:2026-01-01 05:46:57,801 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2026-01-01 05:47:00,433 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 05:47:00,474 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 05:47:00,502 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-01 05:47:00,502 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-01 05:47:00,719 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 05:47:00,757 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 05:47:00,783 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-01 05:47:00,783 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2026-01-01 05:47:00,700 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 05:47:00,701 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 05:47:00,701 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2026-01-01 05:47:01,013 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 05:47:01,013 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 05:47:01,014 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run mhs3y6za
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_1F1B_auto_42_dm1/20260101-0547/wandb/run-20260101_054701-mhs3y6za
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_1F1B_auto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/mhs3y6za
[rank0]:2026-01-01 05:47:02,737 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2026-01-01 05:47:02,883 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 05:47:02,816 - WandB logging enabled
[rank3]:2026-01-01 05:47:02,816 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 05:47:02,857 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 05:47:02,886 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2026-01-01 05:47:02,887 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 05:47:02,920 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 05:47:02,921 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 05:47:02,947 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-01 05:47:02,948 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2026-01-01 05:47:03,072 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 05:47:03,073 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 05:47:03,074 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2026-01-01 05:47:03,136 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 05:47:03,136 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 05:47:03,136 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank0]:2026-01-01 05:47:03,153 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_1F1B_auto_42_dm1
[rank0]:2026-01-01 05:47:03,153 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 05:47:03,153 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 05:47:03,153 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2026-01-01 05:47:03,153 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 05:47:03,153 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-01 05:47:03,153 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 05:47:05,812 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 05:47:05,812 - Finished loading the checkpoint in 2.66 seconds.
[rank0]:2026-01-01 05:47:05,860 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2026-01-01 05:47:05,860 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2026-01-01 05:47:05,860 - Training starts at step 1
[rank3]:2026-01-01 05:47:05,878 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2026-01-01 05:47:05,879 - Freezable Parameters: [Stage 3] 42 params
[rank1]:2026-01-01 05:47:05,870 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2026-01-01 05:47:05,871 - Freezable Parameters: [Stage 1] 70 params
[rank2]:2026-01-01 05:47:05,858 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2026-01-01 05:47:05,859 - Freezable Parameters: [Stage 2] 56 params
[rank0]:2026-01-01 05:47:10,986 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory: 13.12GiB(27.62%)  tps: 4,063  tflops: 31.76  mfu: 10.18%
[rank0]:2026-01-01 05:47:10,986 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 05:47:10,962 -  step:  1  loss: 10.6092  grad_norm:  9.9055  memory: 20.97GiB(44.14%)  tps: 4,044  tflops: 31.61  mfu: 10.13%
[rank3]:2026-01-01 05:47:10,963 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 05:47:10,960 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory: 12.09GiB(25.46%)  tps: 3,212  tflops: 25.11  mfu: 8.05%
[rank1]:2026-01-01 05:47:10,960 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-01 05:47:10,959 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory:  7.27GiB(15.31%)  tps: 3,125  tflops: 24.43  mfu: 7.83%
[rank2]:2026-01-01 05:47:10,959 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 05:50:33,420 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 05:50:37,492 - Avg. fwd time: 33.3713 / Avg. bwd time: 52.9845 / Avg. batch time: 836.1368 (ms) / GPU bubble ratio: 17.38%
[rank2]:2026-01-01 05:50:37,529 - Avg. fwd time: 25.8314 / Avg. bwd time: 30.2188 / Avg. batch time: 899.5897 (ms) / GPU bubble ratio: 50.15%
[rank1]:2026-01-01 05:50:37,573 - Avg. fwd time: 32.7654 / Avg. bwd time: 38.2251 / Avg. batch time: 977.3232 (ms) / GPU bubble ratio: 41.89%
[rank3]:2026-01-01 05:50:37,611 -  step: 50  loss: 12.4624  grad_norm:  8.4069  memory: 20.97GiB(44.14%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank2]:2026-01-01 05:50:37,610 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory:  7.27GiB(15.31%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank0]:2026-01-01 05:50:37,607 - Avg. fwd time: 26.2052 / Avg. bwd time: 28.3475 / Avg. batch time: 1039.5190 (ms) / GPU bubble ratio: 58.02%
[rank0]:2026-01-01 05:50:37,610 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 13.12GiB(27.62%)  tps: 7,771  tflops: 60.75  mfu: 19.47%
[rank1]:2026-01-01 05:50:37,610 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 12.09GiB(25.46%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank3]:2026-01-01 05:51:15,644 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2026-01-01 05:51:15,646 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2026-01-01 05:51:15,646 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2026-01-01 05:51:15,646 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2026-01-01 05:51:57,917 - Freezing Ratio: [Stage3] 0.67, Threshold: 6.5834e+00
[rank0]:2026-01-01 05:51:57,917 - Freezing Ratio: [Stage0] 0.50, Threshold: 6.6343e+00
[rank2]:2026-01-01 05:51:57,917 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.8915e+00
[rank1]:2026-01-01 05:51:57,917 - Freezing Ratio: [Stage1] 0.00, Threshold: 8.6567e+00
[rank3]:2026-01-01 05:52:39,404 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8862e+01
[rank1]:2026-01-01 05:52:39,405 - Freezing Ratio: [Stage1] 0.20, Threshold: 3.2935e+01
[rank0]:2026-01-01 05:52:39,405 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.7449e+01
[rank2]:2026-01-01 05:52:39,404 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0700e+01
[rank2]:2026-01-01 05:53:20,595 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6857e+00
[rank3]:2026-01-01 05:53:20,595 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0957e+00
[rank0]:2026-01-01 05:53:20,595 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.4590e+00
[rank1]:2026-01-01 05:53:20,595 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8831e+00
[rank3]:2026-01-01 05:54:02,871 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7714e+00
[rank0]:2026-01-01 05:54:02,869 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 05:54:02,873 - Freezing Ratio: [Stage0] 0.50, Threshold: 6.7044e+35
[rank1]:2026-01-01 05:54:02,871 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5528e+35
[rank2]:2026-01-01 05:54:02,871 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0412e+36
[rank3]:2026-01-01 05:54:06,861 - Avg. fwd time: 33.4581 / Avg. bwd time: 52.8956 / Avg. batch time: 836.0535 (ms) / GPU bubble ratio: 17.37%
[rank1]:2026-01-01 05:54:06,943 - Avg. fwd time: 32.7902 / Avg. bwd time: 38.2132 / Avg. batch time: 976.1465 (ms) / GPU bubble ratio: 41.81%
[rank2]:2026-01-01 05:54:06,899 - Avg. fwd time: 25.8328 / Avg. bwd time: 30.1574 / Avg. batch time: 898.9201 (ms) / GPU bubble ratio: 50.17%
[rank3]:2026-01-01 05:54:06,968 -  step: 100  loss: 13.1176  grad_norm:  1.0903  memory: 20.97GiB(44.14%)  tps: 7,826  tflops: 61.18  mfu: 19.61%
[rank0]:2026-01-01 05:54:06,963 - Avg. fwd time: 26.1550 / Avg. bwd time: 24.5613 / Avg. batch time: 1034.0156 (ms) / GPU bubble ratio: 60.76%
[rank0]:2026-01-01 05:54:06,967 -  step: 100  loss: -4.0000  grad_norm:  1.0903  memory: 13.12GiB(27.62%)  tps: 7,826  tflops: 61.18  mfu: 19.61%
[rank0]:2026-01-01 05:54:07,040 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0554_stage0_step100.svg
[rank1]:2026-01-01 05:54:06,966 -  step: 100  loss: -4.0000  grad_norm:  1.0903  memory: 12.09GiB(25.46%)  tps: 7,826  tflops: 61.18  mfu: 19.61%
[rank1]:2026-01-01 05:54:07,042 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0554_stage1_step100.svg
[rank2]:2026-01-01 05:54:06,967 -  step: 100  loss: -4.0000  grad_norm:  1.0903  memory:  7.27GiB(15.31%)  tps: 7,826  tflops: 61.18  mfu: 19.61%
[rank2]:2026-01-01 05:54:07,038 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0554_stage2_step100.svg
[rank3]:2026-01-01 05:54:07,136 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0554_step100_rank3.svg
[rank3]:			> Batch Time: 1032.75 ms, GPU Bubble Ratio: 57.80%, 45.12%, 56.71%, 33.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-28-306ms   | [S0,MB4,F]  305-25-331ms   | [S0,MB1,B]  383-28-412ms   | [S0,MB5,F]  411-25-436ms   | [S0,MB2,B]  489-28-517ms   | [S0,MB6,F]  515-25-541ms   | [S0,MB3,B]  594-28-622ms   | [S0,MB7,F]  621-25-646ms   | [S0,MB4,B]  700-28-728ms   | [S0,MB5,B]  801-28-829ms   | [S0,MB6,B]  901-28-929ms   | [S0,MB7,B]  1004-28-1032ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-37-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  440-38-478ms   | [S1,MB5,F]  485-32-518ms   | [S1,MB3,B]  545-38-583ms   | [S1,MB6,F]  590-32-623ms   | [S1,MB4,B]  651-38-689ms   | [S1,MB7,F]  696-32-729ms   | [S1,MB5,B]  756-38-794ms   | [S1,MB6,B]  857-37-894ms   | [S1,MB7,B]  959-37-997ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  399-30-429ms   | [S2,MB4,F]  437-25-462ms   | [S2,MB3,B]  504-30-534ms   | [S2,MB5,F]  542-25-567ms   | [S2,MB4,B]  610-30-640ms   | [S2,MB6,F]  647-25-673ms   | [S2,MB5,B]  716-30-746ms   | [S2,MB7,F]  753-25-779ms   | [S2,MB6,B]  820-30-850ms   | [S2,MB7,B]  922-30-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  291-33-324ms   | [S3,MB2,B]  336-52-389ms   | [S3,MB3,F]  396-33-429ms   | [S3,MB3,B]  441-53-495ms   | [S3,MB4,F]  501-33-535ms   | [S3,MB4,B]  547-53-600ms   | [S3,MB5,F]  607-33-641ms   | [S3,MB5,B]  652-53-705ms   | [S3,MB6,F]  713-33-746ms   | [S3,MB6,B]  758-52-811ms   | [S3,MB7,F]  817-33-851ms   | [S3,MB7,B]  863-52-916ms  
[rank3]:2026-01-01 05:54:07,182 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0554_stage3_step100.svg
[rank0]:2026-01-01 05:54:07,212 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0554_rank0_stage0.svg
[rank0]:	> Counts Sum: 98, Total Sum: 280 (35.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 05:54:07,231 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0554_rank1_stage1.svg
[rank1]:	> Counts Sum: 14, Total Sum: 350 (4.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 05:54:07,208 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0554_rank2_stage2.svg
[rank2]:	> Counts Sum: 28, Total Sum: 280 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 05:54:07,327 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0554_rank3_stage3.svg
[rank3]:	> Counts Sum: 84, Total Sum: 210 (40.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 05:54:44,496 - Freezing Ratio: [Stage1] 0.40, Threshold: 7.7006e+01
[rank2]:2026-01-01 05:54:44,495 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.0406e+01
[rank3]:2026-01-01 05:54:44,495 - Freezing Ratio: [Stage3] 0.67, Threshold: 6.3976e+01
[rank0]:2026-01-01 05:54:44,496 - Freezing Ratio: [Stage0] 0.50, Threshold: 6.8545e+01
[rank2]:2026-01-01 05:55:25,871 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4891e+00
[rank3]:2026-01-01 05:55:25,870 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4789e+00
[rank0]:2026-01-01 05:55:25,871 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.3461e+00
[rank1]:2026-01-01 05:55:25,871 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5432e+00
[rank2]:2026-01-01 05:56:08,322 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.8446e+35
[rank3]:2026-01-01 05:56:08,322 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4554e+00
[rank0]:2026-01-01 05:56:08,323 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.6435e+00
[rank1]:2026-01-01 05:56:08,323 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.7496e+36
[rank2]:2026-01-01 05:56:49,385 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7336e+01
[rank3]:2026-01-01 05:56:49,384 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.0559e+01
[rank1]:2026-01-01 05:56:49,386 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8463e+01
[rank0]:2026-01-01 05:56:49,385 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.7795e+01
[rank3]:2026-01-01 05:57:30,361 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6023e+00
[rank1]:2026-01-01 05:57:30,365 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1751e+00
[rank0]:2026-01-01 05:57:30,367 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 05:57:30,372 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.0118e+00
[rank2]:2026-01-01 05:57:30,361 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.9705e+00
[rank2]:2026-01-01 05:57:34,554 - Avg. fwd time: 25.8399 / Avg. bwd time: 30.1614 / Avg. batch time: 897.9959 (ms) / GPU bubble ratio: 50.11%
[rank3]:2026-01-01 05:57:34,516 - Avg. fwd time: 33.4966 / Avg. bwd time: 52.7620 / Avg. batch time: 835.2569 (ms) / GPU bubble ratio: 17.38%
[rank1]:2026-01-01 05:57:34,599 - Avg. fwd time: 32.7895 / Avg. bwd time: 38.0483 / Avg. batch time: 974.8281 (ms) / GPU bubble ratio: 41.87%
[rank2]:2026-01-01 05:57:34,637 -  step: 150  loss: -4.0000  grad_norm:  8.3967  memory:  7.27GiB(15.31%)  tps: 7,889  tflops: 61.68  mfu: 19.77%
[rank3]:2026-01-01 05:57:34,639 -  step: 150  loss: 11.1266  grad_norm:  8.3967  memory: 20.97GiB(44.14%)  tps: 7,889  tflops: 61.68  mfu: 19.77%
[rank1]:2026-01-01 05:57:34,637 -  step: 150  loss: -4.0000  grad_norm:  8.3967  memory: 12.09GiB(25.46%)  tps: 7,889  tflops: 61.68  mfu: 19.77%
[rank0]:2026-01-01 05:57:34,634 - Avg. fwd time: 26.1023 / Avg. bwd time: 21.0258 / Avg. batch time: 1028.9470 (ms) / GPU bubble ratio: 63.36%
[rank0]:2026-01-01 05:57:34,638 -  step: 150  loss: -4.0000  grad_norm:  8.3967  memory: 13.12GiB(27.62%)  tps: 7,889  tflops: 61.68  mfu: 19.77%
[rank0]:2026-01-01 05:58:12,858 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.4853e+00
[rank2]:2026-01-01 05:58:12,858 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.3605e+00
[rank3]:2026-01-01 05:58:12,859 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.8189e+00
[rank1]:2026-01-01 05:58:12,858 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.6454e+36
[rank1]:2026-01-01 05:58:54,111 - Freezing Ratio: [Stage1] 0.40, Threshold: 5.6756e+01
[rank0]:2026-01-01 05:58:54,111 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.1650e+02
[rank2]:2026-01-01 05:58:54,110 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0734e+01
[rank3]:2026-01-01 05:58:54,110 - Freezing Ratio: [Stage3] 0.67, Threshold: 7.7538e+01
[rank3]:2026-01-01 05:59:35,130 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8102e+00
[rank1]:2026-01-01 05:59:35,131 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8601e+00
[rank0]:2026-01-01 05:59:35,131 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.9249e+00
[rank2]:2026-01-01 05:59:35,130 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2950e+00
[rank3]:2026-01-01 06:00:17,395 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.3366e+00
[rank1]:2026-01-01 06:00:17,396 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.9975e+35
[rank0]:2026-01-01 06:00:17,396 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.2790e+00
[rank2]:2026-01-01 06:00:17,396 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8900e+36
[rank3]:2026-01-01 06:00:58,555 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7803e+01
[rank0]:2026-01-01 06:00:58,553 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 06:00:58,557 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.6409e+01
[rank1]:2026-01-01 06:00:58,556 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.2155e+01
[rank2]:2026-01-01 06:00:58,555 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1616e+01
[rank3]:2026-01-01 06:01:02,675 - Avg. fwd time: 33.5265 / Avg. bwd time: 52.7427 / Avg. batch time: 835.3280 (ms) / GPU bubble ratio: 17.38%
[rank2]:2026-01-01 06:01:02,712 - Avg. fwd time: 25.8453 / Avg. bwd time: 30.1273 / Avg. batch time: 897.9397 (ms) / GPU bubble ratio: 50.13%
[rank3]:2026-01-01 06:01:02,774 -  step: 200  loss: 10.3045  grad_norm:  1.4385  memory: 20.97GiB(44.14%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank0]:2026-01-01 06:01:02,770 - Avg. fwd time: 26.0851 / Avg. bwd time: 19.4428 / Avg. batch time: 1027.1129 (ms) / GPU bubble ratio: 64.54%
[rank0]:2026-01-01 06:01:02,773 -  step: 200  loss: -4.0000  grad_norm:  1.4385  memory: 13.12GiB(27.62%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank1]:2026-01-01 06:01:02,757 - Avg. fwd time: 32.7974 / Avg. bwd time: 38.0238 / Avg. batch time: 974.6650 (ms) / GPU bubble ratio: 41.87%
[rank1]:2026-01-01 06:01:02,773 -  step: 200  loss: -4.0000  grad_norm:  1.4385  memory: 12.09GiB(25.46%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank2]:2026-01-01 06:01:02,773 -  step: 200  loss: -4.0000  grad_norm:  1.4385  memory:  7.27GiB(15.31%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank2]:2026-01-01 06:01:02,826 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0601_stage2_step200.svg
[rank0]:2026-01-01 06:01:02,827 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0601_stage0_step200.svg
[rank1]:2026-01-01 06:01:02,827 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0601_stage1_step200.svg
[rank3]:2026-01-01 06:01:02,922 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0601_step200_rank3.svg
[rank3]:			> Batch Time: 1009.77 ms, GPU Bubble Ratio: 74.46%, 43.97%, 55.56%, 31.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-6-283ms    | [S0,MB4,F]  284-24-308ms   | [S0,MB1,B]  382-6-388ms    | [S0,MB5,F]  389-25-415ms   | [S0,MB2,B]  487-6-493ms    | [S0,MB6,F]  495-25-521ms   | [S0,MB3,B]  593-6-599ms    | [S0,MB7,F]  601-25-626ms   | [S0,MB4,B]  698-6-704ms    | [S0,MB5,B]  800-6-806ms    | [S0,MB6,B]  901-6-907ms    | [S0,MB7,B]  1003-6-1009ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-37-266ms   | [S1,MB3,F]  274-32-306ms   | [S1,MB1,B]  334-38-372ms   | [S1,MB4,F]  379-33-412ms   | [S1,MB2,B]  439-38-477ms   | [S1,MB5,F]  484-32-517ms   | [S1,MB3,B]  544-38-582ms   | [S1,MB6,F]  589-33-622ms   | [S1,MB4,B]  650-38-688ms   | [S1,MB7,F]  695-33-728ms   | [S1,MB5,B]  756-38-794ms   | [S1,MB6,B]  857-37-894ms   | [S1,MB7,B]  959-37-996ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-219ms   | [S2,MB2,F]  226-25-251ms   | [S2,MB1,B]  293-30-323ms   | [S2,MB3,F]  330-25-356ms   | [S2,MB2,B]  398-30-428ms   | [S2,MB4,F]  435-25-461ms   | [S2,MB3,B]  503-30-534ms   | [S2,MB5,F]  541-25-566ms   | [S2,MB4,B]  609-30-639ms   | [S2,MB6,F]  646-25-672ms   | [S2,MB5,B]  715-30-745ms   | [S2,MB7,F]  752-25-778ms   | [S2,MB6,B]  820-30-850ms   | [S2,MB7,B]  922-30-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-51-178ms   | [S3,MB1,F]  185-33-219ms   | [S3,MB1,B]  230-52-283ms   | [S3,MB2,F]  290-33-324ms   | [S3,MB2,B]  336-52-388ms   | [S3,MB3,F]  395-33-429ms   | [S3,MB3,B]  441-52-494ms   | [S3,MB4,F]  500-34-534ms   | [S3,MB4,B]  546-52-599ms   | [S3,MB5,F]  606-34-640ms   | [S3,MB5,B]  652-52-704ms   | [S3,MB6,F]  712-34-746ms   | [S3,MB6,B]  757-52-810ms   | [S3,MB7,F]  817-33-851ms   | [S3,MB7,B]  863-52-916ms  
[rank3]:2026-01-01 06:01:02,968 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0601_stage3_step200.svg
[rank2]:2026-01-01 06:01:02,991 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0601_rank2_stage2.svg
[rank2]:	> Counts Sum: 112, Total Sum: 840 (13.33%), Ratio(%) per element: [26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 06:01:02,994 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0601_rank0_stage0.svg
[rank0]:	> Counts Sum: 378, Total Sum: 840 (45.00%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 06:01:03,010 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0601_rank1_stage1.svg
[rank1]:	> Counts Sum: 182, Total Sum: 1050 (17.33%), Ratio(%) per element: [53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:01:03,109 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0601_rank3_stage3.svg
[rank3]:	> Counts Sum: 280, Total Sum: 630 (44.44%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 06:01:40,071 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6579e+00
[rank3]:2026-01-01 06:01:40,072 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9844e+00
[rank0]:2026-01-01 06:01:40,072 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.9902e+00
[rank1]:2026-01-01 06:01:40,072 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0639e+00
[rank2]:2026-01-01 06:02:22,349 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0082e+36
[rank3]:2026-01-01 06:02:22,348 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7433e+00
[rank0]:2026-01-01 06:02:22,349 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.5363e+00
[rank1]:2026-01-01 06:02:22,349 - Freezing Ratio: [Stage1] 0.20, Threshold: 6.1640e+00
[rank2]:2026-01-01 06:03:03,458 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.0535e+01
[rank3]:2026-01-01 06:03:03,459 - Freezing Ratio: [Stage3] 0.67, Threshold: 6.4265e+01
[rank1]:2026-01-01 06:03:03,459 - Freezing Ratio: [Stage1] 0.40, Threshold: 7.7064e+01
[rank0]:2026-01-01 06:03:03,459 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.8572e+01
[rank2]:2026-01-01 06:03:44,665 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6518e+00
[rank3]:2026-01-01 06:03:44,665 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2426e+00
[rank1]:2026-01-01 06:03:44,665 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1324e+00
[rank0]:2026-01-01 06:03:44,665 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.9708e+00
[rank3]:2026-01-01 06:04:27,139 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.5388e+00
[rank1]:2026-01-01 06:04:27,139 - Freezing Ratio: [Stage1] 0.20, Threshold: 5.5575e+35
[rank0]:2026-01-01 06:04:27,145 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 06:04:27,150 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.2887e+00
[rank2]:2026-01-01 06:04:27,138 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.9186e+00
[rank3]:2026-01-01 06:04:31,123 - Avg. fwd time: 33.5375 / Avg. bwd time: 52.7269 / Avg. batch time: 835.2832 (ms) / GPU bubble ratio: 17.38%
[rank2]:2026-01-01 06:04:31,161 - Avg. fwd time: 25.8475 / Avg. bwd time: 30.0966 / Avg. batch time: 897.8419 (ms) / GPU bubble ratio: 50.15%
[rank2]:2026-01-01 06:04:31,221 -  step: 250  loss: -4.0000  grad_norm:  0.9355  memory:  7.27GiB(15.31%)  tps: 7,860  tflops: 61.45  mfu: 19.69%
[rank3]:2026-01-01 06:04:31,223 -  step: 250  loss: 12.5261  grad_norm:  0.9355  memory: 20.97GiB(44.14%)  tps: 7,860  tflops: 61.45  mfu: 19.69%
[rank1]:2026-01-01 06:04:31,205 - Avg. fwd time: 32.7985 / Avg. bwd time: 38.0075 / Avg. batch time: 974.5050 (ms) / GPU bubble ratio: 41.87%
[rank1]:2026-01-01 06:04:31,221 -  step: 250  loss: -4.0000  grad_norm:  0.9355  memory: 12.09GiB(25.46%)  tps: 7,860  tflops: 61.45  mfu: 19.69%
[rank0]:2026-01-01 06:04:31,218 - Avg. fwd time: 26.0733 / Avg. bwd time: 18.5811 / Avg. batch time: 1026.0487 (ms) / GPU bubble ratio: 65.18%
[rank0]:2026-01-01 06:04:31,222 -  step: 250  loss: -4.0000  grad_norm:  0.9355  memory: 13.12GiB(27.62%)  tps: 7,860  tflops: 61.45  mfu: 19.69%
[rank0]:2026-01-01 06:05:08,212 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.2860e+01
[rank2]:2026-01-01 06:05:08,212 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1904e+01
[rank3]:2026-01-01 06:05:08,212 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4459e+01
[rank1]:2026-01-01 06:05:08,212 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3141e+01
[rank1]:2026-01-01 06:05:49,165 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4527e+00
[rank3]:2026-01-01 06:05:49,165 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3514e+00
[rank0]:2026-01-01 06:05:49,165 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0976e+00
[rank2]:2026-01-01 06:05:49,165 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3253e-01
[rank0]:2026-01-01 06:06:31,624 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.4492e+00
[rank2]:2026-01-01 06:06:31,624 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.2813e+36
[rank3]:2026-01-01 06:06:31,624 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7787e+00
[rank1]:2026-01-01 06:06:31,625 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.4043e+36
[rank2]:2026-01-01 06:07:12,929 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6863e+01
[rank0]:2026-01-01 06:07:12,929 - Freezing Ratio: [Stage0] 0.75, Threshold: 7.9902e+01
[rank1]:2026-01-01 06:07:12,933 - Freezing Ratio: [Stage1] 0.40, Threshold: 4.5328e+01
[rank3]:2026-01-01 06:07:12,929 - Freezing Ratio: [Stage3] 0.67, Threshold: 7.6201e+01
[rank2]:2026-01-01 06:07:53,896 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1012e+00
[rank1]:2026-01-01 06:07:53,897 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4365e+00
[rank0]:2026-01-01 06:07:53,894 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 06:07:53,899 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0268e+00
[rank3]:2026-01-01 06:07:53,896 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5728e+00
[rank3]:2026-01-01 06:07:57,990 - Avg. fwd time: 33.5408 / Avg. bwd time: 52.6842 / Avg. batch time: 834.9596 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:07:58,029 - Avg. fwd time: 25.8445 / Avg. bwd time: 30.0306 / Avg. batch time: 897.3933 (ms) / GPU bubble ratio: 50.19%
[rank1]:2026-01-01 06:07:58,075 - Avg. fwd time: 32.7897 / Avg. bwd time: 37.9406 / Avg. batch time: 973.9329 (ms) / GPU bubble ratio: 41.90%
[rank1]:2026-01-01 06:07:58,113 -  step: 300  loss: -4.0000  grad_norm:  7.3826  memory: 12.09GiB(25.46%)  tps: 7,919  tflops: 61.91  mfu: 19.84%
[rank0]:2026-01-01 06:07:58,110 - Avg. fwd time: 26.0542 / Avg. bwd time: 17.3389 / Avg. batch time: 1024.1927 (ms) / GPU bubble ratio: 66.11%
[rank0]:2026-01-01 06:07:58,114 -  step: 300  loss: -4.0000  grad_norm:  7.3826  memory: 13.12GiB(27.62%)  tps: 7,919  tflops: 61.91  mfu: 19.84%
[rank3]:2026-01-01 06:07:58,115 -  step: 300  loss: 12.9460  grad_norm:  7.3826  memory: 20.97GiB(44.14%)  tps: 7,919  tflops: 61.91  mfu: 19.84%
[rank2]:2026-01-01 06:07:58,113 -  step: 300  loss: -4.0000  grad_norm:  7.3826  memory:  7.27GiB(15.31%)  tps: 7,919  tflops: 61.91  mfu: 19.84%
[rank2]:2026-01-01 06:07:58,169 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0607_stage2_step300.svg
[rank1]:2026-01-01 06:07:58,167 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0607_stage1_step300.svg
[rank0]:2026-01-01 06:07:58,168 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0607_stage0_step300.svg
[rank1]:2026-01-01 06:07:58,344 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0607_rank1_stage1.svg
[rank1]:	> Counts Sum: 336, Total Sum: 1750 (19.20%), Ratio(%) per element: [56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 06:07:58,336 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0607_rank0_stage0.svg
[rank0]:	> Counts Sum: 630, Total Sum: 1400 (45.00%), Ratio(%) per element: [64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:07:58,261 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0607_step300_rank3.svg
[rank3]:			> Batch Time: 1004.74 ms, GPU Bubble Ratio: 74.43%, 44.16%, 56.31%, 31.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-26-52ms     | [S0,MB2,F]  52-27-79ms     | [S0,MB3,F]  80-26-106ms    | [S0,MB0,B]  275-6-281ms    | [S0,MB4,F]  281-24-306ms   | [S0,MB1,B]  380-6-386ms    | [S0,MB5,F]  386-25-412ms   | [S0,MB2,B]  485-6-491ms    | [S0,MB6,F]  492-25-517ms   | [S0,MB3,B]  590-6-596ms    | [S0,MB7,F]  597-25-622ms   | [S0,MB4,B]  696-6-702ms    | [S0,MB5,B]  797-6-803ms    | [S0,MB6,B]  897-6-903ms    | [S0,MB7,B]  998-6-1004ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-136ms   | [S1,MB0,B]  227-37-264ms   | [S1,MB3,F]  272-32-304ms   | [S1,MB1,B]  332-37-369ms   | [S1,MB4,F]  377-32-409ms   | [S1,MB2,B]  437-37-474ms   | [S1,MB5,F]  482-32-514ms   | [S1,MB3,B]  541-37-579ms   | [S1,MB6,F]  586-32-619ms   | [S1,MB4,B]  647-37-685ms   | [S1,MB7,F]  692-32-725ms   | [S1,MB5,B]  753-37-790ms   | [S1,MB6,B]  853-37-890ms   | [S1,MB7,B]  955-37-992ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-122ms    | [S2,MB0,B]  188-29-217ms   | [S2,MB2,F]  224-25-250ms   | [S2,MB1,B]  292-29-321ms   | [S2,MB3,F]  328-25-354ms   | [S2,MB2,B]  397-29-426ms   | [S2,MB4,F]  434-25-459ms   | [S2,MB3,B]  501-29-530ms   | [S2,MB5,F]  538-25-564ms   | [S2,MB4,B]  607-29-636ms   | [S2,MB6,F]  644-25-669ms   | [S2,MB5,B]  713-29-742ms   | [S2,MB7,F]  749-25-775ms   | [S2,MB6,B]  818-29-847ms   | [S2,MB7,B]  919-29-948ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  126-51-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  230-52-282ms   | [S3,MB2,F]  289-33-323ms   | [S3,MB2,B]  335-52-387ms   | [S3,MB3,F]  394-33-428ms   | [S3,MB3,B]  440-52-492ms   | [S3,MB4,F]  498-33-532ms   | [S3,MB4,B]  544-52-596ms   | [S3,MB5,F]  604-33-637ms   | [S3,MB5,B]  650-52-702ms   | [S3,MB6,F]  710-33-743ms   | [S3,MB6,B]  755-52-808ms   | [S3,MB7,F]  815-33-848ms   | [S3,MB7,B]  860-52-912ms  
[rank3]:2026-01-01 06:07:58,306 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0607_stage3_step300.svg
[rank2]:2026-01-01 06:07:58,345 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0607_rank2_stage2.svg
[rank2]:	> Counts Sum: 238, Total Sum: 1400 (17.00%), Ratio(%) per element: [32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:07:58,445 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0607_rank3_stage3.svg
[rank3]:	> Counts Sum: 448, Total Sum: 1050 (42.67%), Ratio(%) per element: [64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 06:08:36,488 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.8027e+35
[rank0]:2026-01-01 06:08:36,488 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.2735e+00
[rank3]:2026-01-01 06:08:36,487 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.3362e+00
[rank2]:2026-01-01 06:08:36,488 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.0314e+36
[rank1]:2026-01-01 06:09:17,656 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.5167e+01
[rank0]:2026-01-01 06:09:17,656 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.0723e+01
[rank3]:2026-01-01 06:09:17,656 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.9060e+01
[rank2]:2026-01-01 06:09:17,656 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.5968e+01
[rank2]:2026-01-01 06:09:58,868 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4867e+00
[rank1]:2026-01-01 06:09:58,869 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.7192e+00
[rank0]:2026-01-01 06:09:58,869 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.2749e+00
[rank3]:2026-01-01 06:09:58,868 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6731e+00
[rank2]:2026-01-01 06:10:41,190 - Freezing Ratio: [Stage2] 0.25, Threshold: 6.2595e+35
[rank1]:2026-01-01 06:10:41,191 - Freezing Ratio: [Stage1] 0.20, Threshold: 6.1365e+00
[rank0]:2026-01-01 06:10:41,190 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.5285e+00
[rank3]:2026-01-01 06:10:41,190 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7309e+00
[rank2]:2026-01-01 06:11:22,264 - Freezing Ratio: [Stage2] 0.25, Threshold: 6.9368e+01
[rank1]:2026-01-01 06:11:22,270 - Freezing Ratio: [Stage1] 0.40, Threshold: 8.4516e+01
[rank0]:2026-01-01 06:11:22,272 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 06:11:22,277 - Freezing Ratio: [Stage0] 0.75, Threshold: 6.1500e+01
[rank3]:2026-01-01 06:11:22,266 - Freezing Ratio: [Stage3] 0.67, Threshold: 6.6947e+01
[rank3]:2026-01-01 06:11:26,320 - Avg. fwd time: 33.5477 / Avg. bwd time: 52.6801 / Avg. batch time: 834.9779 (ms) / GPU bubble ratio: 17.38%
[rank2]:2026-01-01 06:11:26,358 - Avg. fwd time: 25.8483 / Avg. bwd time: 30.0154 / Avg. batch time: 897.3724 (ms) / GPU bubble ratio: 50.20%
[rank1]:2026-01-01 06:11:26,403 - Avg. fwd time: 32.7909 / Avg. bwd time: 37.9486 / Avg. batch time: 973.8967 (ms) / GPU bubble ratio: 41.89%
[rank1]:2026-01-01 06:11:26,420 -  step: 350  loss: -4.0000  grad_norm:  1.0472  memory: 12.09GiB(25.46%)  tps: 7,865  tflops: 61.49  mfu: 19.71%
[rank0]:2026-01-01 06:11:26,417 - Avg. fwd time: 26.0503 / Avg. bwd time: 16.9597 / Avg. batch time: 1023.7536 (ms) / GPU bubble ratio: 66.39%
[rank0]:2026-01-01 06:11:26,420 -  step: 350  loss: -4.0000  grad_norm:  1.0472  memory: 13.12GiB(27.62%)  tps: 7,865  tflops: 61.49  mfu: 19.71%
[rank3]:2026-01-01 06:11:26,422 -  step: 350  loss: 11.1892  grad_norm:  1.0472  memory: 20.97GiB(44.14%)  tps: 7,865  tflops: 61.49  mfu: 19.71%
[rank2]:2026-01-01 06:11:26,420 -  step: 350  loss: -4.0000  grad_norm:  1.0472  memory:  7.27GiB(15.31%)  tps: 7,865  tflops: 61.49  mfu: 19.71%
[rank2]:2026-01-01 06:12:03,451 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2757e+00
[rank1]:2026-01-01 06:12:03,452 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7633e+00
[rank0]:2026-01-01 06:12:03,451 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1945e+00
[rank3]:2026-01-01 06:12:03,451 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6703e+00
[rank2]:2026-01-01 06:12:45,994 - Freezing Ratio: [Stage2] 0.25, Threshold: 6.2058e+00
[rank1]:2026-01-01 06:12:45,995 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.3620e+35
[rank0]:2026-01-01 06:12:45,995 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.3750e+00
[rank3]:2026-01-01 06:12:45,995 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.6278e+00
[rank1]:2026-01-01 06:13:27,079 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.5353e+01
[rank0]:2026-01-01 06:13:27,078 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.4771e+01
[rank3]:2026-01-01 06:13:27,078 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7359e+01
[rank2]:2026-01-01 06:13:27,077 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.9458e+01
[rank2]:2026-01-01 06:14:08,069 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0594e+00
[rank0]:2026-01-01 06:14:08,070 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.9331e+00
[rank1]:2026-01-01 06:14:08,070 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8896e+00
[rank3]:2026-01-01 06:14:08,070 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3707e+00
[rank2]:2026-01-01 06:14:50,544 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2210e+00
[rank0]:2026-01-01 06:14:50,542 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 06:14:50,546 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.4377e+00
[rank1]:2026-01-01 06:14:50,544 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.5564e+36
[rank3]:2026-01-01 06:14:50,545 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7374e+00
[rank3]:2026-01-01 06:14:54,665 - Avg. fwd time: 33.5569 / Avg. bwd time: 52.6846 / Avg. batch time: 835.0873 (ms) / GPU bubble ratio: 17.38%
[rank2]:2026-01-01 06:14:54,703 - Avg. fwd time: 25.8535 / Avg. bwd time: 30.0123 / Avg. batch time: 897.4545 (ms) / GPU bubble ratio: 50.20%
[rank2]:2026-01-01 06:14:54,767 -  step: 400  loss: -4.0000  grad_norm:  1.4232  memory:  7.27GiB(15.31%)  tps: 7,864  tflops: 61.48  mfu: 19.70%
[rank0]:2026-01-01 06:14:54,764 - Avg. fwd time: 26.0494 / Avg. bwd time: 16.7328 / Avg. batch time: 1023.5469 (ms) / GPU bubble ratio: 66.56%
[rank0]:2026-01-01 06:14:54,767 -  step: 400  loss: -4.0000  grad_norm:  1.4232  memory: 13.12GiB(27.62%)  tps: 7,864  tflops: 61.48  mfu: 19.70%
[rank1]:2026-01-01 06:14:54,749 - Avg. fwd time: 32.7914 / Avg. bwd time: 37.9200 / Avg. batch time: 973.9298 (ms) / GPU bubble ratio: 41.92%
[rank1]:2026-01-01 06:14:54,766 -  step: 400  loss: -4.0000  grad_norm:  1.4232  memory: 12.09GiB(25.46%)  tps: 7,864  tflops: 61.48  mfu: 19.70%
[rank3]:2026-01-01 06:14:54,768 -  step: 400  loss: 10.2841  grad_norm:  1.4232  memory: 20.97GiB(44.14%)  tps: 7,864  tflops: 61.48  mfu: 19.70%
[rank2]:2026-01-01 06:14:54,840 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0614_stage2_step400.svg
[rank0]:2026-01-01 06:14:54,846 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0614_stage0_step400.svg
[rank1]:2026-01-01 06:14:54,840 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0614_stage1_step400.svg
[rank3]:2026-01-01 06:14:54,915 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0614_step400_rank3.svg
[rank3]:			> Batch Time: 1040.34 ms, GPU Bubble Ratio: 57.96%, 45.29%, 56.84%, 33.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  279-28-307ms   | [S0,MB4,F]  307-25-333ms   | [S0,MB1,B]  385-28-413ms   | [S0,MB5,F]  413-25-438ms   | [S0,MB2,B]  491-28-519ms   | [S0,MB6,F]  519-25-544ms   | [S0,MB3,B]  598-28-626ms   | [S0,MB7,F]  625-25-650ms   | [S0,MB4,B]  704-28-732ms   | [S0,MB5,B]  806-28-834ms   | [S0,MB6,B]  909-28-937ms   | [S0,MB7,B]  1012-28-1040ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  230-37-268ms   | [S1,MB3,F]  276-32-308ms   | [S1,MB1,B]  335-38-374ms   | [S1,MB4,F]  381-32-414ms   | [S1,MB2,B]  442-38-480ms   | [S1,MB5,F]  487-33-520ms   | [S1,MB3,B]  549-38-587ms   | [S1,MB6,F]  595-33-628ms   | [S1,MB4,B]  655-38-693ms   | [S1,MB7,F]  700-33-733ms   | [S1,MB5,B]  761-38-799ms   | [S1,MB6,B]  864-37-902ms   | [S1,MB7,B]  967-38-1005ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  190-30-220ms   | [S2,MB2,F]  227-25-253ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  332-25-358ms   | [S2,MB2,B]  401-30-431ms   | [S2,MB4,F]  439-25-464ms   | [S2,MB3,B]  508-30-538ms   | [S2,MB5,F]  546-25-572ms   | [S2,MB4,B]  614-30-644ms   | [S2,MB6,F]  652-25-677ms   | [S2,MB5,B]  720-30-750ms   | [S2,MB7,F]  758-25-783ms   | [S2,MB6,B]  828-30-858ms   | [S2,MB7,B]  930-30-960ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-52-180ms   | [S3,MB1,F]  187-33-220ms   | [S3,MB1,B]  232-52-285ms   | [S3,MB2,F]  292-33-326ms   | [S3,MB2,B]  337-53-390ms   | [S3,MB3,F]  398-34-432ms   | [S3,MB3,B]  444-53-498ms   | [S3,MB4,F]  505-34-539ms   | [S3,MB4,B]  551-53-604ms   | [S3,MB5,F]  611-34-645ms   | [S3,MB5,B]  656-53-710ms   | [S3,MB6,F]  717-34-751ms   | [S3,MB6,B]  763-53-817ms   | [S3,MB7,F]  824-34-858ms   | [S3,MB7,B]  870-53-923ms  
[rank3]:2026-01-01 06:14:54,965 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0614_stage3_step400.svg
[rank2]:2026-01-01 06:14:55,007 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0614_rank2_stage2.svg
[rank2]:	> Counts Sum: 378, Total Sum: 1960 (19.29%), Ratio(%) per element: [42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 06:14:55,016 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0614_rank0_stage0.svg
[rank0]:	> Counts Sum: 924, Total Sum: 1960 (47.14%), Ratio(%) per element: [65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 06:14:55,032 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0614_rank1_stage1.svg
[rank1]:	> Counts Sum: 490, Total Sum: 2450 (20.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:14:55,103 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0614_rank3_stage3.svg
[rank3]:	> Counts Sum: 644, Total Sum: 1470 (43.81%), Ratio(%) per element: [65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:15:18,248 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 06:15:18,441 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 06:15:18,488 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 06:15:18,482 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 06:15:31,964 - Freezing Ratio: [Stage0] 0.75, Threshold: 8.8895e+01
[rank3]:2026-01-01 06:15:31,963 - Freezing Ratio: [Stage3] 0.67, Threshold: 7.2715e+01
[rank2]:2026-01-01 06:15:31,963 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2486e+01
[rank1]:2026-01-01 06:15:31,964 - Freezing Ratio: [Stage1] 0.40, Threshold: 4.7597e+01
[rank1]:2026-01-01 06:16:12,886 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5777e+00
[rank0]:2026-01-01 06:16:12,885 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.2573e+00
[rank3]:2026-01-01 06:16:12,884 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6125e+00
[rank2]:2026-01-01 06:16:12,885 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8441e+00
[rank1]:2026-01-01 06:16:55,101 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.5701e+35
[rank0]:2026-01-01 06:16:55,099 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.1816e+00
[rank2]:2026-01-01 06:16:55,099 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2396e+00
[rank3]:2026-01-01 06:16:55,099 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.0672e+00
[rank1]:2026-01-01 06:17:36,180 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.8916e+01
[rank2]:2026-01-01 06:17:36,180 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5856e+01
[rank0]:2026-01-01 06:17:36,179 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.5163e+01
[rank3]:2026-01-01 06:17:36,179 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.0889e+01
[rank2]:2026-01-01 06:18:17,348 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4352e+00
[rank1]:2026-01-01 06:18:17,356 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1774e+00
[rank0]:2026-01-01 06:18:17,357 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 06:18:17,362 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1245e+00
[rank3]:2026-01-01 06:18:17,350 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6293e+00
[rank2]:2026-01-01 06:18:21,479 - Avg. fwd time: 25.8488 / Avg. bwd time: 29.9392 / Avg. batch time: 897.1090 (ms) / GPU bubble ratio: 50.25%
[rank3]:2026-01-01 06:18:21,439 - Avg. fwd time: 33.5549 / Avg. bwd time: 52.6574 / Avg. batch time: 834.8488 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:18:21,566 -  step: 450  loss: -4.0000  grad_norm:  6.7544  memory:  7.27GiB(15.31%)  tps: 7,923  tflops: 61.94  mfu: 19.85%
[rank1]:2026-01-01 06:18:21,526 - Avg. fwd time: 32.7882 / Avg. bwd time: 37.9103 / Avg. batch time: 973.5551 (ms) / GPU bubble ratio: 41.90%
[rank1]:2026-01-01 06:18:21,566 -  step: 450  loss: -4.0000  grad_norm:  6.7544  memory: 12.09GiB(25.46%)  tps: 7,923  tflops: 61.94  mfu: 19.85%
[rank0]:2026-01-01 06:18:21,563 - Avg. fwd time: 26.0394 / Avg. bwd time: 16.1096 / Avg. batch time: 1022.5283 (ms) / GPU bubble ratio: 67.02%
[rank0]:2026-01-01 06:18:21,566 -  step: 450  loss: -4.0000  grad_norm:  6.7544  memory: 13.12GiB(27.62%)  tps: 7,923  tflops: 61.94  mfu: 19.85%
[rank3]:2026-01-01 06:18:21,568 -  step: 450  loss: 12.7481  grad_norm:  6.7544  memory: 20.97GiB(44.14%)  tps: 7,923  tflops: 61.94  mfu: 19.85%
[rank3]:2026-01-01 06:18:59,667 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7602e+00
[rank1]:2026-01-01 06:18:59,667 - Freezing Ratio: [Stage1] 0.20, Threshold: 6.1030e+00
[rank2]:2026-01-01 06:18:59,667 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5027e+00
[rank0]:2026-01-01 06:18:59,667 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.5174e+00
[rank2]:2026-01-01 06:19:40,646 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3253e+01
[rank1]:2026-01-01 06:19:40,646 - Freezing Ratio: [Stage1] 0.40, Threshold: 9.4359e+01
[rank0]:2026-01-01 06:19:40,646 - Freezing Ratio: [Stage0] 0.75, Threshold: 7.3467e+01
[rank3]:2026-01-01 06:19:40,646 - Freezing Ratio: [Stage3] 0.67, Threshold: 8.0071e+01
[rank1]:2026-01-01 06:20:21,747 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6962e+00
[rank2]:2026-01-01 06:20:21,746 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9158e+00
[rank0]:2026-01-01 06:20:21,747 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.4819e+00
[rank3]:2026-01-01 06:20:21,747 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4947e+00
[rank2]:2026-01-01 06:21:04,261 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9472e+00
[rank1]:2026-01-01 06:21:04,262 - Freezing Ratio: [Stage1] 0.20, Threshold: 6.3225e+35
[rank0]:2026-01-01 06:21:04,261 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.8060e+00
[rank3]:2026-01-01 06:21:04,261 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.1582e+00
[rank2]:2026-01-01 06:21:45,237 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5919e+01
[rank1]:2026-01-01 06:21:45,238 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7003e+01
[rank0]:2026-01-01 06:21:45,235 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 06:21:45,240 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.1239e+01
[rank3]:2026-01-01 06:21:45,238 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.6004e+01
[rank2]:2026-01-01 06:21:49,255 - Avg. fwd time: 25.8451 / Avg. bwd time: 29.8988 / Avg. batch time: 896.9531 (ms) / GPU bubble ratio: 50.28%
[rank3]:2026-01-01 06:21:49,217 - Avg. fwd time: 33.5521 / Avg. bwd time: 52.6495 / Avg. batch time: 834.7584 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:21:49,318 -  step: 500  loss: -4.0000  grad_norm:  0.8407  memory:  7.27GiB(15.31%)  tps: 7,886  tflops: 61.65  mfu: 19.76%
[rank1]:2026-01-01 06:21:49,300 - Avg. fwd time: 32.7861 / Avg. bwd time: 37.9085 / Avg. batch time: 973.3824 (ms) / GPU bubble ratio: 41.90%
[rank1]:2026-01-01 06:21:49,318 -  step: 500  loss: -4.0000  grad_norm:  0.8407  memory: 12.09GiB(25.46%)  tps: 7,886  tflops: 61.65  mfu: 19.76%
[rank0]:2026-01-01 06:21:49,315 - Avg. fwd time: 26.0369 / Avg. bwd time: 15.9678 / Avg. batch time: 1022.2009 (ms) / GPU bubble ratio: 67.13%
[rank0]:2026-01-01 06:21:49,318 -  step: 500  loss: -4.0000  grad_norm:  0.8407  memory: 13.12GiB(27.62%)  tps: 7,886  tflops: 61.65  mfu: 19.76%
[rank0]:2026-01-01 06:21:49,371 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0621_stage0_step500.svg
[rank3]:2026-01-01 06:21:49,320 -  step: 500  loss: 12.9581  grad_norm:  0.8407  memory: 20.97GiB(44.14%)  tps: 7,886  tflops: 61.65  mfu: 19.76%
[rank2]:2026-01-01 06:21:49,371 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0621_stage2_step500.svg
[rank1]:2026-01-01 06:21:49,372 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0621_stage1_step500.svg
[rank3]:2026-01-01 06:21:49,468 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0621_step500_rank3.svg
[rank3]:			> Batch Time: 1002.74 ms, GPU Bubble Ratio: 74.40%, 43.86%, 56.28%, 31.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-25-25ms      | [S0,MB1,F]  25-26-52ms     | [S0,MB2,F]  52-27-79ms     | [S0,MB3,F]  79-26-106ms    | [S0,MB0,B]  275-6-281ms    | [S0,MB4,F]  281-24-306ms   | [S0,MB1,B]  379-6-385ms    | [S0,MB5,F]  385-25-410ms   | [S0,MB2,B]  483-6-489ms    | [S0,MB6,F]  490-25-515ms   | [S0,MB3,B]  589-6-595ms    | [S0,MB7,F]  595-25-620ms   | [S0,MB4,B]  694-6-700ms    | [S0,MB5,B]  793-6-799ms    | [S0,MB6,B]  894-6-900ms    | [S0,MB7,B]  996-6-1002ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  25-32-57ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  103-32-136ms   | [S1,MB0,B]  227-37-264ms   | [S1,MB3,F]  272-32-304ms   | [S1,MB1,B]  331-38-369ms   | [S1,MB4,F]  375-32-408ms   | [S1,MB2,B]  435-37-473ms   | [S1,MB5,F]  480-32-512ms   | [S1,MB3,B]  540-37-578ms   | [S1,MB6,F]  585-32-618ms   | [S1,MB4,B]  645-37-683ms   | [S1,MB7,F]  690-32-723ms   | [S1,MB5,B]  748-37-786ms   | [S1,MB6,B]  849-37-887ms   | [S1,MB7,B]  952-37-989ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-83ms     | [S2,MB1,F]  97-25-122ms    | [S2,MB0,B]  187-29-216ms   | [S2,MB2,F]  224-25-249ms   | [S2,MB1,B]  291-29-320ms   | [S2,MB3,F]  327-25-353ms   | [S2,MB2,B]  396-29-425ms   | [S2,MB4,F]  432-25-458ms   | [S2,MB3,B]  501-29-530ms   | [S2,MB5,F]  537-25-563ms   | [S2,MB4,B]  606-29-635ms   | [S2,MB6,F]  642-25-668ms   | [S2,MB5,B]  709-29-738ms   | [S2,MB7,F]  745-25-771ms   | [S2,MB6,B]  814-29-843ms   | [S2,MB7,B]  916-29-946ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-114ms    | [S3,MB0,B]  126-51-177ms   | [S3,MB1,F]  184-32-217ms   | [S3,MB1,B]  229-51-281ms   | [S3,MB2,F]  288-33-322ms   | [S3,MB2,B]  334-52-386ms   | [S3,MB3,F]  393-33-427ms   | [S3,MB3,B]  439-52-491ms   | [S3,MB4,F]  498-33-531ms   | [S3,MB4,B]  543-52-596ms   | [S3,MB5,F]  603-33-637ms   | [S3,MB5,B]  648-52-700ms   | [S3,MB6,F]  706-33-739ms   | [S3,MB6,B]  751-52-804ms   | [S3,MB7,F]  811-33-845ms   | [S3,MB7,B]  857-52-909ms  
[rank2]:2026-01-01 06:21:49,539 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0621_rank2_stage2.svg
[rank2]:	> Counts Sum: 672, Total Sum: 2520 (26.67%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 06:21:49,554 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0621_rank1_stage1.svg
[rank1]:	> Counts Sum: 644, Total Sum: 3150 (20.44%), Ratio(%) per element: [62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 62.22, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 06:21:49,540 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0621_rank0_stage0.svg
[rank0]:	> Counts Sum: 1218, Total Sum: 2520 (48.33%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:21:49,513 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0621_stage3_step500.svg
[rank3]:2026-01-01 06:21:49,654 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0621_rank3_stage3.svg
[rank3]:	> Counts Sum: 840, Total Sum: 1890 (44.44%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 06:22:26,477 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.0123e-01
[rank1]:2026-01-01 06:22:26,478 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2145e+00
[rank0]:2026-01-01 06:22:26,478 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.1460e+00
[rank3]:2026-01-01 06:22:26,478 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3438e+00
[rank3]:2026-01-01 06:23:08,896 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7844e+00
[rank2]:2026-01-01 06:23:08,896 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5076e+00
[rank1]:2026-01-01 06:23:08,897 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.2623e+36
[rank0]:2026-01-01 06:23:08,897 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.4751e+00
[rank2]:2026-01-01 06:23:50,063 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6476e+01
[rank1]:2026-01-01 06:23:50,064 - Freezing Ratio: [Stage1] 0.40, Threshold: 4.9415e+01
[rank0]:2026-01-01 06:23:50,064 - Freezing Ratio: [Stage0] 0.75, Threshold: 8.9544e+01
[rank3]:2026-01-01 06:23:50,063 - Freezing Ratio: [Stage3] 0.67, Threshold: 8.4587e+01
[rank1]:2026-01-01 06:24:30,961 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3037e+00
[rank0]:2026-01-01 06:24:30,960 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.9641e+00
[rank3]:2026-01-01 06:24:30,960 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0652e+00
[rank2]:2026-01-01 06:24:30,960 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2091e+00
[rank2]:2026-01-01 06:25:13,291 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2136e+00
[rank1]:2026-01-01 06:25:13,291 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.7044e+35
[rank0]:2026-01-01 06:25:13,298 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 06:25:13,303 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.1569e+00
[rank3]:2026-01-01 06:25:13,292 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.1041e+00
[rank3]:2026-01-01 06:25:17,348 - Avg. fwd time: 33.5518 / Avg. bwd time: 52.6476 / Avg. batch time: 834.7394 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:25:17,387 - Avg. fwd time: 25.8426 / Avg. bwd time: 29.8683 / Avg. batch time: 896.8966 (ms) / GPU bubble ratio: 50.31%
[rank1]:2026-01-01 06:25:17,435 - Avg. fwd time: 32.7830 / Avg. bwd time: 37.8962 / Avg. batch time: 973.3032 (ms) / GPU bubble ratio: 41.91%
[rank0]:2026-01-01 06:25:17,450 - Avg. fwd time: 26.0356 / Avg. bwd time: 15.8921 / Avg. batch time: 1022.0367 (ms) / GPU bubble ratio: 67.18%
[rank0]:2026-01-01 06:25:17,453 -  step: 550  loss: -4.0000  grad_norm:  0.9738  memory: 13.12GiB(27.62%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank3]:2026-01-01 06:25:17,455 -  step: 550  loss: 11.0990  grad_norm:  0.9738  memory: 20.97GiB(44.14%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank2]:2026-01-01 06:25:17,453 -  step: 550  loss: -4.0000  grad_norm:  0.9738  memory:  7.27GiB(15.31%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank1]:2026-01-01 06:25:17,453 -  step: 550  loss: -4.0000  grad_norm:  0.9738  memory: 12.09GiB(25.46%)  tps: 7,872  tflops: 61.54  mfu: 19.72%
[rank1]:2026-01-01 06:25:54,482 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.4134e+01
[rank0]:2026-01-01 06:25:54,482 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.0356e+01
[rank3]:2026-01-01 06:25:54,482 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.0420e+01
[rank2]:2026-01-01 06:25:54,481 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9634e+01
[rank2]:2026-01-01 06:26:35,691 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2154e+00
[rank0]:2026-01-01 06:26:35,692 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.9307e+00
[rank1]:2026-01-01 06:26:35,692 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6478e+00
[rank3]:2026-01-01 06:26:35,692 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3379e+00
[rank0]:2026-01-01 06:27:17,984 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.5496e+00
[rank3]:2026-01-01 06:27:17,984 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7805e+00
[rank1]:2026-01-01 06:27:17,984 - Freezing Ratio: [Stage1] 0.20, Threshold: 6.2270e+00
[rank2]:2026-01-01 06:27:17,983 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5106e+00
[rank2]:2026-01-01 06:27:58,987 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2128e+01
[rank3]:2026-01-01 06:27:58,987 - Freezing Ratio: [Stage3] 0.67, Threshold: 7.8166e+01
[rank0]:2026-01-01 06:27:58,988 - Freezing Ratio: [Stage0] 0.75, Threshold: 7.0073e+01
[rank1]:2026-01-01 06:27:58,988 - Freezing Ratio: [Stage1] 0.40, Threshold: 9.4004e+01
[rank2]:2026-01-01 06:28:40,050 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7246e+00
[rank3]:2026-01-01 06:28:40,051 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3910e+00
[rank0]:2026-01-01 06:28:40,049 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 06:28:40,053 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.9466e+00
[rank1]:2026-01-01 06:28:40,051 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3465e+00
[rank3]:2026-01-01 06:28:44,280 - Avg. fwd time: 33.5538 / Avg. bwd time: 52.6346 / Avg. batch time: 834.6518 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:28:44,320 - Avg. fwd time: 25.8405 / Avg. bwd time: 29.8262 / Avg. batch time: 896.7479 (ms) / GPU bubble ratio: 50.34%
[rank3]:2026-01-01 06:28:44,412 -  step: 600  loss: 10.0152  grad_norm: 34.2411  memory: 20.97GiB(44.14%)  tps: 7,917  tflops: 61.89  mfu: 19.84%
[rank0]:2026-01-01 06:28:44,406 - Avg. fwd time: 26.0302 / Avg. bwd time: 15.4952 / Avg. batch time: 1021.4682 (ms) / GPU bubble ratio: 67.48%
[rank0]:2026-01-01 06:28:44,410 -  step: 600  loss: -4.0000  grad_norm: 34.2411  memory: 13.12GiB(27.62%)  tps: 7,917  tflops: 61.89  mfu: 19.84%
[rank1]:2026-01-01 06:28:44,368 - Avg. fwd time: 32.7827 / Avg. bwd time: 37.8924 / Avg. batch time: 973.1409 (ms) / GPU bubble ratio: 41.90%
[rank1]:2026-01-01 06:28:44,410 -  step: 600  loss: -4.0000  grad_norm: 34.2411  memory: 12.09GiB(25.46%)  tps: 7,917  tflops: 61.89  mfu: 19.84%
[rank2]:2026-01-01 06:28:44,410 -  step: 600  loss: -4.0000  grad_norm: 34.2411  memory:  7.27GiB(15.31%)  tps: 7,917  tflops: 61.89  mfu: 19.84%
[rank2]:2026-01-01 06:28:44,464 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0628_stage2_step600.svg
[rank0]:2026-01-01 06:28:44,465 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0628_stage0_step600.svg
[rank1]:2026-01-01 06:28:44,465 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0628_stage1_step600.svg
[rank3]:2026-01-01 06:28:44,560 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0628_step600_rank3.svg
[rank3]:			> Batch Time: 1004.73 ms, GPU Bubble Ratio: 74.41%, 44.01%, 56.26%, 31.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-25-25ms      | [S0,MB1,F]  25-26-52ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-106ms    | [S0,MB0,B]  275-6-281ms    | [S0,MB4,F]  281-24-306ms   | [S0,MB1,B]  380-6-386ms    | [S0,MB5,F]  386-25-412ms   | [S0,MB2,B]  485-6-491ms    | [S0,MB6,F]  491-25-516ms   | [S0,MB3,B]  590-6-596ms    | [S0,MB7,F]  596-25-621ms   | [S0,MB4,B]  695-6-701ms    | [S0,MB5,B]  797-6-803ms    | [S0,MB6,B]  897-6-903ms    | [S0,MB7,B]  998-6-1004ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  25-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  227-37-264ms   | [S1,MB3,F]  271-32-304ms   | [S1,MB1,B]  332-37-369ms   | [S1,MB4,F]  377-32-410ms   | [S1,MB2,B]  436-37-474ms   | [S1,MB5,F]  481-33-514ms   | [S1,MB3,B]  541-37-579ms   | [S1,MB6,F]  586-32-619ms   | [S1,MB4,B]  646-37-684ms   | [S1,MB7,F]  691-32-724ms   | [S1,MB5,B]  752-37-790ms   | [S1,MB6,B]  853-37-890ms   | [S1,MB7,B]  954-37-992ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-29-217ms   | [S2,MB2,F]  224-25-250ms   | [S2,MB1,B]  292-29-321ms   | [S2,MB3,F]  328-25-354ms   | [S2,MB2,B]  397-29-426ms   | [S2,MB4,F]  433-25-459ms   | [S2,MB3,B]  502-29-531ms   | [S2,MB5,F]  538-25-564ms   | [S2,MB4,B]  607-29-636ms   | [S2,MB6,F]  644-25-669ms   | [S2,MB5,B]  713-29-742ms   | [S2,MB7,F]  749-25-775ms   | [S2,MB6,B]  818-29-847ms   | [S2,MB7,B]  919-29-948ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  126-51-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  230-52-282ms   | [S3,MB2,F]  289-33-323ms   | [S3,MB2,B]  335-52-387ms   | [S3,MB3,F]  394-33-428ms   | [S3,MB3,B]  440-52-492ms   | [S3,MB4,F]  499-33-533ms   | [S3,MB4,B]  544-52-597ms   | [S3,MB5,F]  605-34-639ms   | [S3,MB5,B]  651-52-703ms   | [S3,MB6,F]  710-33-744ms   | [S3,MB6,B]  756-52-808ms   | [S3,MB7,F]  815-34-849ms   | [S3,MB7,B]  860-52-913ms  
[rank3]:2026-01-01 06:28:44,607 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0628_stage3_step600.svg
[rank2]:2026-01-01 06:28:44,629 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0628_rank2_stage2.svg
[rank2]:	> Counts Sum: 924, Total Sum: 3080 (30.00%), Ratio(%) per element: [50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 50.9, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 06:28:44,636 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0628_rank0_stage0.svg
[rank0]:	> Counts Sum: 1470, Total Sum: 3080 (47.73%), Ratio(%) per element: [65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 06:28:44,644 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0628_rank1_stage1.svg
[rank1]:	> Counts Sum: 756, Total Sum: 3850 (19.64%), Ratio(%) per element: [61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 61.81, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 23.63, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 5.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:28:44,750 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0628_rank3_stage3.svg
[rank3]:	> Counts Sum: 1008, Total Sum: 2310 (43.64%), Ratio(%) per element: [65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 06:29:22,819 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3095e+00
[rank3]:2026-01-01 06:29:22,820 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.5459e+00
[rank0]:2026-01-01 06:29:22,820 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.2141e+00
[rank1]:2026-01-01 06:29:22,820 - Freezing Ratio: [Stage1] 0.20, Threshold: 3.7273e+35
[rank1]:2026-01-01 06:30:03,740 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9826e+01
[rank2]:2026-01-01 06:30:03,740 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7820e+01
[rank3]:2026-01-01 06:30:03,740 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.7679e+01
[rank0]:2026-01-01 06:30:03,740 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.1376e+01
[rank2]:2026-01-01 06:30:44,718 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.7182e-01
[rank3]:2026-01-01 06:30:44,718 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1565e+00
[rank0]:2026-01-01 06:30:44,718 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.4994e+00
[rank1]:2026-01-01 06:30:44,718 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4927e+00
[rank3]:2026-01-01 06:31:27,195 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7080e+00
[rank0]:2026-01-01 06:31:27,196 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.4179e+00
[rank1]:2026-01-01 06:31:27,196 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.6543e+36
[rank2]:2026-01-01 06:31:27,195 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4754e+00
[rank3]:2026-01-01 06:32:08,367 - Freezing Ratio: [Stage3] 0.67, Threshold: 6.7543e+01
[rank0]:2026-01-01 06:32:08,374 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 06:32:08,379 - Freezing Ratio: [Stage0] 0.75, Threshold: 8.4242e+01
[rank1]:2026-01-01 06:32:08,373 - Freezing Ratio: [Stage1] 0.40, Threshold: 4.3505e+01
[rank2]:2026-01-01 06:32:08,366 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9664e+01
[rank3]:2026-01-01 06:32:12,362 - Avg. fwd time: 33.5542 / Avg. bwd time: 52.6342 / Avg. batch time: 834.6508 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:32:12,401 - Avg. fwd time: 25.8382 / Avg. bwd time: 29.8039 / Avg. batch time: 896.7201 (ms) / GPU bubble ratio: 50.36%
[rank3]:2026-01-01 06:32:12,468 -  step: 650  loss: 12.3055  grad_norm:  0.9086  memory: 20.97GiB(44.14%)  tps: 7,875  tflops: 61.56  mfu: 19.73%
[rank0]:2026-01-01 06:32:12,463 - Avg. fwd time: 26.0291 / Avg. bwd time: 15.4336 / Avg. batch time: 1021.3464 (ms) / GPU bubble ratio: 67.52%
[rank0]:2026-01-01 06:32:12,466 -  step: 650  loss: -4.0000  grad_norm:  0.9086  memory: 13.12GiB(27.62%)  tps: 7,875  tflops: 61.56  mfu: 19.73%
[rank1]:2026-01-01 06:32:12,447 - Avg. fwd time: 32.7803 / Avg. bwd time: 37.8810 / Avg. batch time: 973.0885 (ms) / GPU bubble ratio: 41.91%
[rank1]:2026-01-01 06:32:12,466 -  step: 650  loss: -4.0000  grad_norm:  0.9086  memory: 12.09GiB(25.46%)  tps: 7,875  tflops: 61.56  mfu: 19.73%
[rank2]:2026-01-01 06:32:12,466 -  step: 650  loss: -4.0000  grad_norm:  0.9086  memory:  7.27GiB(15.31%)  tps: 7,875  tflops: 61.56  mfu: 19.73%
[rank2]:2026-01-01 06:32:49,390 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6450e+00
[rank3]:2026-01-01 06:32:49,391 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2664e+00
[rank0]:2026-01-01 06:32:49,391 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.1196e+00
[rank1]:2026-01-01 06:32:49,391 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7265e+00
[rank3]:2026-01-01 06:33:31,683 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.2528e+00
[rank0]:2026-01-01 06:33:31,684 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.1955e+00
[rank1]:2026-01-01 06:33:31,684 - Freezing Ratio: [Stage1] 0.20, Threshold: 5.1286e+35
[rank2]:2026-01-01 06:33:31,683 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2730e+00
[rank3]:2026-01-01 06:34:12,848 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.8971e+01
[rank0]:2026-01-01 06:34:12,847 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.3791e+01
[rank1]:2026-01-01 06:34:12,847 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.5595e+01
[rank2]:2026-01-01 06:34:12,846 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2960e+01
[rank0]:2026-01-01 06:34:54,030 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.6386e+00
[rank1]:2026-01-01 06:34:54,030 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9193e+00
[rank2]:2026-01-01 06:34:54,030 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3166e+00
[rank3]:2026-01-01 06:34:54,030 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8420e+00
[rank2]:2026-01-01 06:35:36,309 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4518e+00
[rank3]:2026-01-01 06:35:36,310 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.6598e+00
[rank0]:2026-01-01 06:35:36,307 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 06:35:36,311 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.4017e+00
[rank1]:2026-01-01 06:35:36,310 - Freezing Ratio: [Stage1] 0.20, Threshold: 5.9888e+00
[rank2]:2026-01-01 06:35:40,323 - Avg. fwd time: 25.8359 / Avg. bwd time: 29.7860 / Avg. batch time: 896.6543 (ms) / GPU bubble ratio: 50.37%
[rank3]:2026-01-01 06:35:40,283 - Avg. fwd time: 33.5523 / Avg. bwd time: 52.6317 / Avg. batch time: 834.6147 (ms) / GPU bubble ratio: 17.39%
[rank0]:2026-01-01 06:35:40,386 - Avg. fwd time: 26.0280 / Avg. bwd time: 15.4114 / Avg. batch time: 1021.2507 (ms) / GPU bubble ratio: 67.54%
[rank0]:2026-01-01 06:35:40,389 -  step: 700  loss: -4.0000  grad_norm:  0.9645  memory: 13.12GiB(27.62%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank1]:2026-01-01 06:35:40,370 - Avg. fwd time: 32.7796 / Avg. bwd time: 37.8841 / Avg. batch time: 973.0197 (ms) / GPU bubble ratio: 41.90%
[rank1]:2026-01-01 06:35:40,389 -  step: 700  loss: -4.0000  grad_norm:  0.9645  memory: 12.09GiB(25.46%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank2]:2026-01-01 06:35:40,389 -  step: 700  loss: -4.0000  grad_norm:  0.9645  memory:  7.27GiB(15.31%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank3]:2026-01-01 06:35:40,391 -  step: 700  loss: 13.1112  grad_norm:  0.9645  memory: 20.97GiB(44.14%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank0]:2026-01-01 06:35:40,445 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0635_stage0_step700.svg
[rank1]:2026-01-01 06:35:40,446 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0635_stage1_step700.svg
[rank2]:2026-01-01 06:35:40,445 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0635_stage2_step700.svg
[rank3]:2026-01-01 06:35:40,536 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0635_step700_rank3.svg
[rank3]:			> Batch Time: 1033.70 ms, GPU Bubble Ratio: 57.85%, 45.20%, 56.75%, 33.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-331ms   | [S0,MB1,B]  384-28-412ms   | [S0,MB5,F]  411-25-436ms   | [S0,MB2,B]  490-28-519ms   | [S0,MB6,F]  516-25-541ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  621-25-646ms   | [S0,MB4,B]  701-28-729ms   | [S0,MB5,B]  804-28-832ms   | [S0,MB6,B]  904-28-932ms   | [S0,MB7,B]  1005-28-1033ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-37-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  335-38-373ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  441-38-479ms   | [S1,MB5,F]  487-32-519ms   | [S1,MB3,B]  547-38-585ms   | [S1,MB6,F]  592-32-625ms   | [S1,MB4,B]  652-38-690ms   | [S1,MB7,F]  697-32-730ms   | [S1,MB5,B]  759-38-797ms   | [S1,MB6,B]  859-37-897ms   | [S1,MB7,B]  960-37-998ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  332-25-357ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  438-25-464ms   | [S2,MB3,B]  506-30-536ms   | [S2,MB5,F]  543-25-569ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  649-25-675ms   | [S2,MB5,B]  718-30-748ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  924-30-954ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-51-179ms   | [S3,MB1,F]  186-32-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  291-33-325ms   | [S3,MB2,B]  337-53-390ms   | [S3,MB3,F]  397-33-431ms   | [S3,MB3,B]  443-53-496ms   | [S3,MB4,F]  503-33-537ms   | [S3,MB4,B]  548-53-601ms   | [S3,MB5,F]  608-33-642ms   | [S3,MB5,B]  654-53-707ms   | [S3,MB6,F]  715-33-749ms   | [S3,MB6,B]  760-52-813ms   | [S3,MB7,F]  819-33-853ms   | [S3,MB7,B]  865-53-918ms  
[rank2]:2026-01-01 06:35:40,610 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0635_rank2_stage2.svg
[rank2]:	> Counts Sum: 1218, Total Sum: 3640 (33.46%), Ratio(%) per element: [53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 53.84, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:35:40,584 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0635_stage3_step700.svg
[rank0]:2026-01-01 06:35:40,611 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0635_rank0_stage0.svg
[rank0]:	> Counts Sum: 1764, Total Sum: 3640 (48.46%), Ratio(%) per element: [66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 06:35:40,625 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0635_rank1_stage1.svg
[rank1]:	> Counts Sum: 910, Total Sum: 4550 (20.00%), Ratio(%) per element: [63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 23.07, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 6.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:35:40,722 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0635_rank3_stage3.svg
[rank3]:	> Counts Sum: 1204, Total Sum: 2730 (44.10%), Ratio(%) per element: [66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 66.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 06:36:17,545 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.8639e+01
[rank1]:2026-01-01 06:36:17,545 - Freezing Ratio: [Stage1] 0.60, Threshold: 6.9905e+01
[rank2]:2026-01-01 06:36:17,544 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2342e+01
[rank3]:2026-01-01 06:36:17,545 - Freezing Ratio: [Stage3] 0.67, Threshold: 5.5660e+01
[rank1]:2026-01-01 06:36:58,616 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4826e+00
[rank2]:2026-01-01 06:36:58,615 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1786e+00
[rank3]:2026-01-01 06:36:58,615 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2503e+00
[rank0]:2026-01-01 06:36:58,616 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1865e+00
[rank2]:2026-01-01 06:37:41,101 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2284e+00
[rank3]:2026-01-01 06:37:41,102 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4830e+00
[rank0]:2026-01-01 06:37:41,102 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.1988e+00
[rank1]:2026-01-01 06:37:41,102 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.4814e+36
[rank2]:2026-01-01 06:38:22,040 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4015e+01
[rank3]:2026-01-01 06:38:22,040 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.3891e+01
[rank0]:2026-01-01 06:38:22,041 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.9005e+01
[rank1]:2026-01-01 06:38:22,041 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7867e+01
[rank2]:2026-01-01 06:39:02,977 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1628e+00
[rank3]:2026-01-01 06:39:02,978 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5569e+00
[rank0]:2026-01-01 06:39:02,984 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 06:39:02,989 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1208e+00
[rank1]:2026-01-01 06:39:02,984 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1439e+00
[rank3]:2026-01-01 06:39:07,140 - Avg. fwd time: 33.5513 / Avg. bwd time: 52.6193 / Avg. batch time: 834.5055 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:39:07,182 - Avg. fwd time: 25.8336 / Avg. bwd time: 29.7570 / Avg. batch time: 896.5096 (ms) / GPU bubble ratio: 50.39%
[rank0]:2026-01-01 06:39:07,270 - Avg. fwd time: 26.0235 / Avg. bwd time: 15.1261 / Avg. batch time: 1020.7744 (ms) / GPU bubble ratio: 67.75%
[rank0]:2026-01-01 06:39:07,274 -  step: 750  loss: -4.0000  grad_norm:  5.6822  memory: 13.12GiB(27.62%)  tps: 7,919  tflops: 61.91  mfu: 19.84%
[rank1]:2026-01-01 06:39:07,231 - Avg. fwd time: 32.7752 / Avg. bwd time: 37.8592 / Avg. batch time: 972.8367 (ms) / GPU bubble ratio: 41.91%
[rank1]:2026-01-01 06:39:07,274 -  step: 750  loss: -4.0000  grad_norm:  5.6822  memory: 12.09GiB(25.46%)  tps: 7,919  tflops: 61.91  mfu: 19.84%
[rank2]:2026-01-01 06:39:07,274 -  step: 750  loss: -4.0000  grad_norm:  5.6822  memory:  7.27GiB(15.31%)  tps: 7,919  tflops: 61.91  mfu: 19.84%
[rank3]:2026-01-01 06:39:07,276 -  step: 750  loss: 11.0736  grad_norm:  5.6822  memory: 20.97GiB(44.14%)  tps: 7,920  tflops: 61.91  mfu: 19.84%
[rank0]:2026-01-01 06:39:45,417 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.5042e+00
[rank1]:2026-01-01 06:39:45,418 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.3448e+36
[rank2]:2026-01-01 06:39:45,417 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5662e+00
[rank3]:2026-01-01 06:39:45,417 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.8438e+00
[rank2]:2026-01-01 06:40:26,592 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.8730e+01
[rank1]:2026-01-01 06:40:26,593 - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0774e+01
[rank3]:2026-01-01 06:40:26,593 - Freezing Ratio: [Stage3] 0.67, Threshold: 8.2398e+01
[rank0]:2026-01-01 06:40:26,593 - Freezing Ratio: [Stage0] 0.75, Threshold: 9.3875e+01
[rank2]:2026-01-01 06:41:07,569 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9512e+00
[rank1]:2026-01-01 06:41:07,570 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1384e+00
[rank3]:2026-01-01 06:41:07,570 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6889e+00
[rank0]:2026-01-01 06:41:07,570 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.9001e+00
[rank2]:2026-01-01 06:41:49,906 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3054e+00
[rank1]:2026-01-01 06:41:49,907 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.5563e+35
[rank3]:2026-01-01 06:41:49,906 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.2772e+00
[rank0]:2026-01-01 06:41:49,906 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.2271e+00
[rank2]:2026-01-01 06:42:31,074 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3962e+01
[rank1]:2026-01-01 06:42:31,075 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.8311e+01
[rank3]:2026-01-01 06:42:31,075 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.3924e+01
[rank0]:2026-01-01 06:42:31,073 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 06:42:31,077 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.2525e+01
[rank3]:2026-01-01 06:42:35,209 - Avg. fwd time: 33.5541 / Avg. bwd time: 52.6220 / Avg. batch time: 834.5481 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 06:42:35,250 - Avg. fwd time: 25.8327 / Avg. bwd time: 29.7435 / Avg. batch time: 896.5296 (ms) / GPU bubble ratio: 50.41%
[rank1]:2026-01-01 06:42:35,298 - Avg. fwd time: 32.7769 / Avg. bwd time: 37.8640 / Avg. batch time: 972.8594 (ms) / GPU bubble ratio: 41.91%
[rank3]:2026-01-01 06:42:35,320 -  step: 800  loss:  9.8078  grad_norm:  1.2925  memory: 20.97GiB(44.14%)  tps: 7,875  tflops: 61.57  mfu: 19.73%
[rank3]:2026-01-01 06:42:35,321 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm:  1.2925  tps: 8,358  tflops: 65.34  mfu: 19.17%
[rank3]:2026-01-01 06:42:35,321 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 06:42:35,322 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 06:42:35,315 - Avg. fwd time: 26.0231 / Avg. bwd time: 15.0985 / Avg. batch time: 1020.7659 (ms) / GPU bubble ratio: 67.77%
[rank0]:2026-01-01 06:42:35,319 -  step: 800  loss: -4.0000  grad_norm:  1.2925  memory: 13.12GiB(27.62%)  tps: 7,875  tflops: 61.57  mfu: 19.73%
[rank0]:2026-01-01 06:42:35,319 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.2925  tps: 8,358  tflops: 65.34  mfu: 19.17%
[rank0]:2026-01-01 06:42:35,319 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 06:42:35,320 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 06:42:35,318 -  step: 800  loss: -4.0000  grad_norm:  1.2925  memory:  7.27GiB(15.31%)  tps: 7,875  tflops: 61.57  mfu: 19.73%
[rank2]:2026-01-01 06:42:35,318 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.2925  tps: 8,352  tflops: 65.29  mfu: 19.03%
[rank2]:2026-01-01 06:42:35,318 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 06:42:35,319 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 06:42:35,318 -  step: 800  loss: -4.0000  grad_norm:  1.2925  memory: 12.09GiB(25.46%)  tps: 7,875  tflops: 61.57  mfu: 19.73%
[rank1]:2026-01-01 06:42:35,318 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.2925  tps: 8,353  tflops: 65.30  mfu: 19.05%
[rank1]:2026-01-01 06:42:35,318 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 06:42:35,319 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 06:42:37,273 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-01 06:42:37,339 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank0/260101_0642_stage0_final800.svg
[rank2]:2026-01-01 06:42:37,339 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank2/260101_0642_stage2_final800.svg
[rank1]:2026-01-01 06:42:37,341 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank1/260101_0642_stage1_final800.svg
[rank3]:2026-01-01 06:42:37,429 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0642_final800_rank3.svg
[rank3]:			> Batch Time: 1009.80 ms, GPU Bubble Ratio: 74.41%, 44.01%, 55.84%, 31.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-6-283ms    | [S0,MB4,F]  285-24-309ms   | [S0,MB1,B]  382-6-388ms    | [S0,MB5,F]  391-25-417ms   | [S0,MB2,B]  487-6-493ms    | [S0,MB6,F]  498-25-523ms   | [S0,MB3,B]  593-6-599ms    | [S0,MB7,F]  605-25-630ms   | [S0,MB4,B]  698-6-704ms    | [S0,MB5,B]  800-6-806ms    | [S0,MB6,B]  901-6-907ms    | [S0,MB7,B]  1003-6-1009ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-37-266ms   | [S1,MB3,F]  273-32-306ms   | [S1,MB1,B]  333-38-372ms   | [S1,MB4,F]  379-32-411ms   | [S1,MB2,B]  438-38-476ms   | [S1,MB5,F]  484-32-516ms   | [S1,MB3,B]  544-38-582ms   | [S1,MB6,F]  589-32-622ms   | [S1,MB4,B]  650-38-688ms   | [S1,MB7,F]  695-32-727ms   | [S1,MB5,B]  755-38-793ms   | [S1,MB6,B]  856-37-894ms   | [S1,MB7,B]  959-37-996ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-29-219ms   | [S2,MB2,F]  225-25-251ms   | [S2,MB1,B]  293-29-323ms   | [S2,MB3,F]  330-25-356ms   | [S2,MB2,B]  398-29-428ms   | [S2,MB4,F]  435-25-461ms   | [S2,MB3,B]  504-29-534ms   | [S2,MB5,F]  541-25-567ms   | [S2,MB4,B]  609-29-639ms   | [S2,MB6,F]  646-25-672ms   | [S2,MB5,B]  715-29-745ms   | [S2,MB7,F]  752-25-778ms   | [S2,MB6,B]  820-30-850ms   | [S2,MB7,B]  922-29-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-51-178ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  230-52-283ms   | [S3,MB2,F]  290-33-324ms   | [S3,MB2,B]  336-52-388ms   | [S3,MB3,F]  395-33-429ms   | [S3,MB3,B]  441-52-494ms   | [S3,MB4,F]  501-33-535ms   | [S3,MB4,B]  546-52-599ms   | [S3,MB5,F]  606-34-640ms   | [S3,MB5,B]  652-52-705ms   | [S3,MB6,F]  712-33-746ms   | [S3,MB6,B]  757-52-810ms   | [S3,MB7,F]  817-33-851ms   | [S3,MB7,B]  863-52-916ms  
[rank0]:2026-01-01 06:42:37,513 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0642_rank0_stage0.svg
[rank0]:	> Counts Sum: 2058, Total Sum: 4200 (49.00%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 06:42:37,513 - Sleeping 2 seconds for other ranks to complete
[rank2]:2026-01-01 06:42:37,512 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0642_rank2_stage2.svg
[rank2]:	> Counts Sum: 1512, Total Sum: 4200 (36.00%), Ratio(%) per element: [56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 06:42:37,512 - Destroying the purge thread.
[rank1]:2026-01-01 06:42:37,528 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0642_rank1_stage1.svg
[rank1]:	> Counts Sum: 1092, Total Sum: 5250 (20.80%), Ratio(%) per element: [64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 06:42:37,529 - Destroying the purge thread.
[rank3]:2026-01-01 06:42:37,566 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/pipeline_schedule/260101_0642_thry_final800_rank3.svg
[rank3]:			> Batch Time: 973.87 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-29-29ms      | [S0,MB1,F]  29-29-59ms     | [S0,MB2,F]  59-29-88ms     | [S0,MB3,F]  88-29-118ms    | [S0,MB0,B]  295-59-354ms   | [S0,MB4,F]  354-29-383ms   | [S0,MB1,B]  383-59-442ms   | [S0,MB5,F]  442-29-472ms   | [S0,MB2,B]  472-59-531ms   | [S0,MB6,F]  531-29-560ms   | [S0,MB3,B]  560-59-619ms   | [S0,MB7,F]  619-29-649ms   | [S0,MB4,B]  649-59-708ms   | [S0,MB5,B]  737-59-796ms   | [S0,MB6,B]  826-59-885ms   | [S0,MB7,B]  914-59-973ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  29-29-59ms     | [S1,MB1,F]  59-29-88ms     | [S1,MB2,F]  88-29-118ms    | [S1,MB0,B]  236-59-295ms   | [S1,MB3,F]  295-29-324ms   | [S1,MB1,B]  324-59-383ms   | [S1,MB4,F]  383-29-413ms   | [S1,MB2,B]  413-59-472ms   | [S1,MB5,F]  472-29-501ms   | [S1,MB3,B]  501-59-560ms   | [S1,MB6,F]  560-29-590ms   | [S1,MB4,B]  590-59-649ms   | [S1,MB7,F]  649-29-678ms   | [S1,MB5,B]  678-59-737ms   | [S1,MB6,B]  767-59-826ms   | [S1,MB7,B]  855-59-914ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  59-29-88ms     | [S2,MB1,F]  88-29-118ms    | [S2,MB0,B]  177-59-236ms   | [S2,MB2,F]  236-29-265ms   | [S2,MB1,B]  265-59-324ms   | [S2,MB3,F]  324-29-354ms   | [S2,MB2,B]  354-59-413ms   | [S2,MB4,F]  413-29-442ms   | [S2,MB3,B]  442-59-501ms   | [S2,MB5,F]  501-29-531ms   | [S2,MB4,B]  531-59-590ms   | [S2,MB6,F]  590-29-619ms   | [S2,MB5,B]  619-59-678ms   | [S2,MB7,F]  678-29-708ms   | [S2,MB6,B]  708-59-767ms   | [S2,MB7,B]  796-59-855ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  88-29-118ms    | [S3,MB0,B]  118-59-177ms   | [S3,MB1,F]  177-29-206ms   | [S3,MB1,B]  206-59-265ms   | [S3,MB2,F]  265-29-295ms   | [S3,MB2,B]  295-59-354ms   | [S3,MB3,F]  354-29-383ms   | [S3,MB3,B]  383-59-442ms   | [S3,MB4,F]  442-29-472ms   | [S3,MB4,B]  472-59-531ms   | [S3,MB5,F]  531-29-560ms   | [S3,MB5,B]  560-59-619ms   | [S3,MB6,F]  619-29-649ms   | [S3,MB6,B]  649-59-708ms   | [S3,MB7,F]  708-29-737ms   | [S3,MB7,B]  737-59-796ms  
[rank3]:2026-01-01 06:42:37,615 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_ratio_history/rank3/260101_0642_stage3_final800.svg
[rank2]:2026-01-01 06:42:37,610 - Process group destroyed
[rank1]:2026-01-01 06:42:37,631 - Process group destroyed
[rank3]:2026-01-01 06:42:37,752 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1/frozen_params_histogram/260101_0642_rank3_stage3.svg
[rank3]:	> Counts Sum: 1400, Total Sum: 3150 (44.44%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 06:42:37,753 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 364-384
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–ƒâ–â–ƒâ–â–â–‚â–â–â–‚â–â–â–ˆâ–â–â–‚â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.92049
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 19.16911
[rank3]:wandb:             final/avg_tflops 65.34002
[rank3]:wandb:    final/avg_throughput(tps) 8358.13054
[rank3]:wandb:              final/grad_norm 1.2925
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 1.2925
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_1F1B_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/mhs3y6za
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_1F1B_auto_42_dm1/20260101-0547/wandb/run-20260101_054701-mhs3y6za/logs
[rank3]:2026-01-01 06:42:39,207 - Process group destroyed
[rank0]:2026-01-01 06:42:39,513 - Training completed
[rank0]:2026-01-01 06:42:39,514 - Destroying the purge thread.
[rank0]:2026-01-01 06:42:39,608 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.11', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.8', 'layers.5', 'layers.6'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'output', 'layers.13', 'layers.15'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.3', 'layers.1', 'layers.2'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_1F1B_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_1F1B_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_1F1B_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_1F1B_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_1F1B_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_1F1B_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_1F1B_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_1F1B_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
