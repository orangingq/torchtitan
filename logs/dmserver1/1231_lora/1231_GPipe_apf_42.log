
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 23:24:15 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_GPipe_apf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-31 23:24:23,546 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank1]:2025-12-31 23:24:23,546 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank2]:2025-12-31 23:24:23,787 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank0]:2025-12-31 23:24:23,820 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 23:24:23,787 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:2025-12-31 23:24:23,822 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 23:24:23,827 - [GC] Initial GC collection 0.00 seconds
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:2025-12-31 23:24:23,837 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:2025-12-31 23:24:23,829 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-31 23:24:23,839 - Building 1-D device mesh with ['pp'], [4]
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2025-12-31 23:24:24,012 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 23:24:24,014 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-31 23:24:24,008 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 23:24:24,011 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 23:24:24,219 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-31 23:24:27,479 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-31 23:24:27,626 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 23:24:27,666 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 23:24:27,667 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 23:24:27,694 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-31 23:24:27,694 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-31 23:24:27,918 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 23:24:27,918 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 23:24:27,918 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-31 23:24:27,941 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 23:24:27,979 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 23:24:28,007 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-31 23:24:28,007 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-31 23:24:28,193 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 23:24:28,193 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 23:24:28,194 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run bq2ra7ts
[rank2]:2025-12-31 23:24:29,899 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 23:24:29,938 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 23:24:29,965 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-31 23:24:29,966 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-31 23:24:30,173 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 23:24:30,173 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 23:24:30,174 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_GPipe_apf_42_dm1/20251231-2324/wandb/run-20251231_232428-bq2ra7ts
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_GPipe_apf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/bq2ra7ts
[rank3]:2025-12-31 23:24:30,292 - WandB logging enabled
[rank3]:2025-12-31 23:24:30,293 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 23:24:30,334 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 23:24:30,363 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-31 23:24:30,363 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-31 23:24:30,582 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 23:24:30,583 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 23:24:30,584 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank2]:2025-12-31 23:24:30,598 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 23:24:30,598 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_GPipe_apf_42_dm1
[rank1]:2025-12-31 23:24:30,598 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 23:24:30,599 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 23:24:30,599 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 23:24:30,599 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-31 23:24:30,598 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 23:24:33,251 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 23:24:33,251 - Finished loading the checkpoint in 2.65 seconds.
[rank3]:2025-12-31 23:24:33,317 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2025-12-31 23:24:33,318 - Freezable Parameters: [Stage 3] 42 params
[rank0]:2025-12-31 23:24:33,301 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank1]:2025-12-31 23:24:33,318 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank2]:2025-12-31 23:24:33,306 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2025-12-31 23:24:33,307 - Freezable Parameters: [Stage 2] 56 params
[rank1]:2025-12-31 23:24:33,318 - Freezable Parameters: [Stage 1] 70 params
[rank0]:2025-12-31 23:24:33,301 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2025-12-31 23:24:33,301 - Training starts at step 1
[rank1]:2025-12-31 23:24:38,460 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 17.18GiB(36.17%)  tps: 3,127  tflops: 24.44  mfu: 7.83%
[rank1]:2025-12-31 23:24:38,460 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 23:24:38,461 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 14.51GiB(30.55%)  tps: 3,036  tflops: 23.73  mfu: 7.61%
[rank0]:2025-12-31 23:24:38,461 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 23:24:38,439 -  step:  1  loss: 10.6088  grad_norm:  5.6782  memory: 29.95GiB(63.04%)  tps: 4,045  tflops: 31.62  mfu: 10.13%
[rank3]:2025-12-31 23:24:38,439 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 23:24:38,434 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 13.85GiB(29.15%)  tps: 3,857  tflops: 30.15  mfu: 9.66%
[rank2]:2025-12-31 23:24:38,434 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 23:26:15,153 - Avg. fwd time: 16.5350 / Avg. bwd time: 25.0880 / Avg. batch time: 392.9635 (ms) / GPU bubble ratio: 15.26%
[rank1]:2025-12-31 23:26:15,224 - Avg. fwd time: 15.4559 / Avg. bwd time: 17.5708 / Avg. batch time: 466.8208 (ms) / GPU bubble ratio: 43.40%
[rank2]:2025-12-31 23:26:15,172 - Avg. fwd time: 12.2444 / Avg. bwd time: 12.8867 / Avg. batch time: 422.5985 (ms) / GPU bubble ratio: 52.43%
[rank0]:2025-12-31 23:26:15,241 - Avg. fwd time: 13.4764 / Avg. bwd time: 12.2762 / Avg. batch time: 498.3161 (ms) / GPU bubble ratio: 58.66%
[rank0]:2025-12-31 23:27:51,351 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 23:27:55,258 - Avg. fwd time: 16.5758 / Avg. bwd time: 25.1673 / Avg. batch time: 393.6452 (ms) / GPU bubble ratio: 15.17%
[rank1]:2025-12-31 23:27:55,301 - Avg. fwd time: 15.4701 / Avg. bwd time: 17.1602 / Avg. batch time: 463.7042 (ms) / GPU bubble ratio: 43.71%
[rank1]:2025-12-31 23:27:55,321 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 17.18GiB(36.17%)  tps: 8,156  tflops: 63.76  mfu: 20.44%
[rank3]:2025-12-31 23:27:55,323 -  step: 50  loss: 12.4620  grad_norm:  4.3533  memory: 29.95GiB(63.04%)  tps: 8,155  tflops: 63.75  mfu: 20.43%
[rank0]:2025-12-31 23:27:55,318 - Avg. fwd time: 13.4493 / Avg. bwd time: 12.2950 / Avg. batch time: 494.5004 (ms) / GPU bubble ratio: 58.35%
[rank0]:2025-12-31 23:27:55,321 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 14.51GiB(30.55%)  tps: 8,156  tflops: 63.76  mfu: 20.44%
[rank2]:2025-12-31 23:27:55,276 - Avg. fwd time: 12.2471 / Avg. bwd time: 12.8966 / Avg. batch time: 422.7777 (ms) / GPU bubble ratio: 52.42%
[rank2]:2025-12-31 23:27:55,321 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 13.85GiB(29.15%)  tps: 8,155  tflops: 63.75  mfu: 20.43%
[rank3]:2025-12-31 23:28:31,174 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:28:31,255 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:28:31,257 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:28:31,228 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:29:11,300 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:29:11,310 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:29:11,287 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:29:11,292 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:29:34,045 - Avg. fwd time: 16.5840 / Avg. bwd time: 25.1311 / Avg. batch time: 393.3300 (ms) / GPU bubble ratio: 15.15%
[rank2]:2025-12-31 23:29:34,063 - Avg. fwd time: 12.2264 / Avg. bwd time: 12.8169 / Avg. batch time: 422.1612 (ms) / GPU bubble ratio: 52.54%
[rank1]:2025-12-31 23:29:34,083 - Avg. fwd time: 15.4546 / Avg. bwd time: 16.8388 / Avg. batch time: 461.4245 (ms) / GPU bubble ratio: 44.01%
[rank0]:2025-12-31 23:29:34,088 - Avg. fwd time: 13.4006 / Avg. bwd time: 11.3157 / Avg. batch time: 490.8548 (ms) / GPU bubble ratio: 59.72%
[rank0]:2025-12-31 23:29:49,235 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:29:49,238 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:29:49,234 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:29:49,232 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:30:30,402 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:30:30,398 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:30:30,401 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:30:30,408 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:31:08,228 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 23:31:08,240 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:31:08,233 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:31:08,246 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:31:08,235 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:31:11,995 - Avg. fwd time: 13.3168 / Avg. bwd time: 9.7196 / Avg. batch time: 487.8278 (ms) / GPU bubble ratio: 62.22%
[rank0]:2025-12-31 23:31:11,998 -  step: 100  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank3]:2025-12-31 23:31:11,950 - Avg. fwd time: 16.5740 / Avg. bwd time: 25.0258 / Avg. batch time: 392.3659 (ms) / GPU bubble ratio: 15.18%
[rank3]:2025-12-31 23:31:11,999 -  step: 100  loss: 13.1172  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,331  tflops: 65.12  mfu: 20.87%
[rank1]:2025-12-31 23:31:11,989 - Avg. fwd time: 15.4188 / Avg. bwd time: 16.7422 / Avg. batch time: 460.3270 (ms) / GPU bubble ratio: 44.11%
[rank1]:2025-12-31 23:31:11,997 -  step: 100  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank2]:2025-12-31 23:31:11,968 - Avg. fwd time: 12.1901 / Avg. bwd time: 12.6823 / Avg. batch time: 420.9835 (ms) / GPU bubble ratio: 52.73%
[rank2]:2025-12-31 23:31:11,997 -  step: 100  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,330  tflops: 65.12  mfu: 20.87%
[rank0]:2025-12-31 23:31:12,071 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/251231_2331_stage0_step100.svg
[rank1]:2025-12-31 23:31:12,075 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/251231_2331_stage1_step100.svg
[rank2]:2025-12-31 23:31:12,071 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/251231_2331_stage2_step100.svg
[rank3]:2025-12-31 23:31:12,159 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/251231_2331_step100_rank3.svg
[rank3]:			> Batch Time: 462.75 ms, GPU Bubble Ratio: 77.72%, 47.76%, 58.81%, 29.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-12-12ms      | [S0,MB1,F]  12-12-25ms     | [S0,MB2,F]  25-12-37ms     | [S0,MB3,F]  37-12-50ms     | [S0,MB4,F]  50-12-63ms     | [S0,MB5,F]  63-13-76ms     | [S0,MB6,F]  76-12-89ms     | [S0,MB7,F]  89-13-102ms    | [S0,MB0,B]  293-0-293ms    | [S0,MB1,B]  317-0-317ms    | [S0,MB2,B]  341-0-341ms    | [S0,MB3,B]  366-0-366ms    | [S0,MB4,B]  390-0-390ms    | [S0,MB5,B]  414-0-414ms    | [S0,MB6,B]  439-0-439ms    | [S0,MB7,B]  462-0-462ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  12-15-27ms     | [S1,MB1,F]  31-15-46ms     | [S1,MB2,F]  49-15-64ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  93-15-109ms    | [S1,MB5,F]  117-15-132ms   | [S1,MB6,F]  141-15-156ms   | [S1,MB7,F]  165-15-180ms   | [S1,MB0,B]  275-14-290ms   | [S1,MB1,B]  299-15-314ms   | [S1,MB2,B]  323-15-338ms   | [S1,MB3,B]  347-15-362ms   | [S1,MB4,B]  372-15-387ms   | [S1,MB5,B]  396-15-411ms   | [S1,MB6,B]  421-15-436ms   | [S1,MB7,B]  443-15-458ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  27-11-39ms     | [S2,MB1,F]  46-11-58ms     | [S2,MB2,F]  66-12-78ms     | [S2,MB3,F]  90-11-102ms    | [S2,MB4,F]  114-12-126ms   | [S2,MB5,F]  138-11-150ms   | [S2,MB6,F]  162-12-174ms   | [S2,MB7,F]  186-11-198ms   | [S2,MB0,B]  260-11-272ms   | [S2,MB1,B]  284-11-296ms   | [S2,MB2,B]  308-11-320ms   | [S2,MB3,B]  332-11-344ms   | [S2,MB4,B]  357-11-369ms   | [S2,MB5,B]  381-11-392ms   | [S2,MB6,B]  406-11-418ms   | [S2,MB7,B]  428-11-440ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  39-16-55ms     | [S3,MB1,F]  63-16-79ms     | [S3,MB2,F]  87-16-103ms    | [S3,MB3,F]  111-16-127ms   | [S3,MB4,F]  135-16-152ms   | [S3,MB5,F]  159-16-176ms   | [S3,MB6,F]  183-16-200ms   | [S3,MB7,F]  207-16-224ms   | [S3,MB0,B]  230-23-254ms   | [S3,MB1,B]  253-24-278ms   | [S3,MB2,B]  277-24-302ms   | [S3,MB3,B]  302-24-326ms   | [S3,MB4,B]  326-24-350ms   | [S3,MB5,B]  350-24-374ms   | [S3,MB6,B]  374-24-399ms   | [S3,MB7,B]  399-24-424ms  
[rank3]:2025-12-31 23:31:12,201 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/251231_2331_stage3_step100.svg
[rank0]:2025-12-31 23:31:12,250 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2331_rank0_stage0.svg
[rank0]:	> Counts Sum: 168, Total Sum: 280 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank1]:2025-12-31 23:31:12,284 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2331_rank1_stage1.svg
[rank1]:	> Counts Sum: 210, Total Sum: 350 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank2]:2025-12-31 23:31:12,244 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2331_rank2_stage2.svg
[rank2]:	> Counts Sum: 168, Total Sum: 280 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank3]:2025-12-31 23:31:12,342 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2331_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 210 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank0]:2025-12-31 23:31:46,477 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:31:46,473 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:31:46,485 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:31:46,475 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:32:26,822 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:32:26,819 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:32:26,823 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:32:26,835 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:32:49,592 - Avg. fwd time: 16.5716 / Avg. bwd time: 24.9672 / Avg. batch time: 391.8735 (ms) / GPU bubble ratio: 15.20%
[rank0]:2025-12-31 23:32:49,637 - Avg. fwd time: 13.2832 / Avg. bwd time: 8.7610 / Avg. batch time: 485.3895 (ms) / GPU bubble ratio: 63.67%
[rank1]:2025-12-31 23:32:49,631 - Avg. fwd time: 15.4070 / Avg. bwd time: 16.5482 / Avg. batch time: 458.9718 (ms) / GPU bubble ratio: 44.30%
[rank2]:2025-12-31 23:32:49,610 - Avg. fwd time: 12.1690 / Avg. bwd time: 12.6020 / Avg. batch time: 420.3406 (ms) / GPU bubble ratio: 52.86%
[rank3]:2025-12-31 23:33:05,007 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:33:05,012 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:33:05,010 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:33:05,010 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:33:42,933 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:33:42,936 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:33:42,938 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:33:42,935 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:34:20,838 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:34:20,836 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:34:20,853 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:34:20,839 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 23:34:20,851 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:34:24,842 - Avg. fwd time: 16.5635 / Avg. bwd time: 24.8749 / Avg. batch time: 391.0510 (ms) / GPU bubble ratio: 15.23%
[rank2]:2025-12-31 23:34:24,862 - Avg. fwd time: 12.1383 / Avg. bwd time: 12.4852 / Avg. batch time: 419.3175 (ms) / GPU bubble ratio: 53.02%
[rank3]:2025-12-31 23:34:24,910 -  step: 150  loss: 11.1241  grad_norm:  4.5952  memory: 29.96GiB(63.07%)  tps: 8,493  tflops: 66.40  mfu: 21.28%
[rank2]:2025-12-31 23:34:24,908 -  step: 150  loss: -8.0000  grad_norm:  4.5952  memory: 13.87GiB(29.20%)  tps: 8,493  tflops: 66.39  mfu: 21.28%
[rank1]:2025-12-31 23:34:24,886 - Avg. fwd time: 15.3758 / Avg. bwd time: 16.3038 / Avg. batch time: 457.1231 (ms) / GPU bubble ratio: 44.56%
[rank1]:2025-12-31 23:34:24,908 -  step: 150  loss: -8.0000  grad_norm:  4.5952  memory: 17.21GiB(36.23%)  tps: 8,493  tflops: 66.39  mfu: 21.28%
[rank0]:2025-12-31 23:34:24,905 - Avg. fwd time: 13.2262 / Avg. bwd time: 7.3831 / Avg. batch time: 481.9632 (ms) / GPU bubble ratio: 65.79%
[rank0]:2025-12-31 23:34:24,908 -  step: 150  loss: -8.0000  grad_norm:  4.5952  memory: 14.52GiB(30.57%)  tps: 8,493  tflops: 66.39  mfu: 21.28%
[rank1]:2025-12-31 23:35:01,253 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:35:01,245 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:35:01,242 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:35:01,251 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:35:39,520 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:35:39,528 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:35:39,522 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:35:39,526 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:36:02,282 - Avg. fwd time: 16.5670 / Avg. bwd time: 24.8576 / Avg. batch time: 390.9250 (ms) / GPU bubble ratio: 15.23%
[rank2]:2025-12-31 23:36:02,301 - Avg. fwd time: 12.1297 / Avg. bwd time: 12.4506 / Avg. batch time: 419.1115 (ms) / GPU bubble ratio: 53.08%
[rank0]:2025-12-31 23:36:02,328 - Avg. fwd time: 13.3886 / Avg. bwd time: 6.9625 / Avg. batch time: 481.0524 (ms) / GPU bubble ratio: 66.16%
[rank1]:2025-12-31 23:36:02,322 - Avg. fwd time: 15.3673 / Avg. bwd time: 16.1943 / Avg. batch time: 456.4138 (ms) / GPU bubble ratio: 44.68%
[rank0]:2025-12-31 23:36:17,658 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:36:17,650 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:36:17,656 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:36:17,652 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:36:55,752 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:36:55,745 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:36:55,750 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:36:55,746 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:37:33,987 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 23:37:33,992 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:37:33,999 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:37:33,994 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:37:34,003 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:37:38,069 - Avg. fwd time: 16.5646 / Avg. bwd time: 24.8062 / Avg. batch time: 390.4832 (ms) / GPU bubble ratio: 15.24%
[rank1]:2025-12-31 23:37:38,113 - Avg. fwd time: 15.3491 / Avg. bwd time: 16.0558 / Avg. batch time: 455.3957 (ms) / GPU bubble ratio: 44.83%
[rank1]:2025-12-31 23:37:38,136 -  step: 200  loss: -8.0000  grad_norm: 19.0357  memory: 17.21GiB(36.23%)  tps: 8,479  tflops: 66.29  mfu: 21.25%
[rank2]:2025-12-31 23:37:38,089 - Avg. fwd time: 12.1126 / Avg. bwd time: 12.3826 / Avg. batch time: 418.5549 (ms) / GPU bubble ratio: 53.18%
[rank2]:2025-12-31 23:37:38,136 -  step: 200  loss: -8.0000  grad_norm: 19.0357  memory: 13.87GiB(29.20%)  tps: 8,479  tflops: 66.29  mfu: 21.25%
[rank0]:2025-12-31 23:37:38,132 - Avg. fwd time: 13.4677 / Avg. bwd time: 6.1545 / Avg. batch time: 479.3282 (ms) / GPU bubble ratio: 67.25%
[rank0]:2025-12-31 23:37:38,136 -  step: 200  loss: -8.0000  grad_norm: 19.0357  memory: 14.52GiB(30.57%)  tps: 8,479  tflops: 66.29  mfu: 21.25%
[rank0]:2025-12-31 23:37:38,191 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/251231_2337_stage0_step200.svg
[rank3]:2025-12-31 23:37:38,138 -  step: 200  loss: 10.2906  grad_norm: 19.0357  memory: 29.96GiB(63.07%)  tps: 8,479  tflops: 66.29  mfu: 21.25%
[rank1]:2025-12-31 23:37:38,188 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/251231_2337_stage1_step200.svg
[rank2]:2025-12-31 23:37:38,189 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/251231_2337_stage2_step200.svg
[rank3]:2025-12-31 23:37:38,270 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/251231_2337_step200_rank3.svg
[rank3]:			> Batch Time: 466.00 ms, GPU Bubble Ratio: 75.95%, 48.17%, 59.09%, 29.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-14-29ms     | [S0,MB2,F]  29-13-42ms     | [S0,MB3,F]  42-14-56ms     | [S0,MB4,F]  56-13-70ms     | [S0,MB5,F]  70-13-84ms     | [S0,MB6,F]  84-14-99ms     | [S0,MB7,F]  99-13-112ms    | [S0,MB0,B]  297-0-297ms    | [S0,MB1,B]  321-0-321ms    | [S0,MB2,B]  345-0-345ms    | [S0,MB3,B]  370-0-370ms    | [S0,MB4,B]  395-0-395ms    | [S0,MB5,B]  419-0-419ms    | [S0,MB6,B]  444-0-444ms    | [S0,MB7,B]  466-0-466ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-66ms     | [S1,MB3,F]  72-15-87ms     | [S1,MB4,F]  95-15-111ms    | [S1,MB5,F]  119-15-135ms   | [S1,MB6,F]  144-15-159ms   | [S1,MB7,F]  168-15-183ms   | [S1,MB0,B]  278-14-293ms   | [S1,MB1,B]  302-14-317ms   | [S1,MB2,B]  326-14-341ms   | [S1,MB3,B]  350-15-365ms   | [S1,MB4,B]  375-15-390ms   | [S1,MB5,B]  399-15-414ms   | [S1,MB6,B]  424-15-439ms   | [S1,MB7,B]  445-15-460ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-11-42ms     | [S2,MB1,F]  48-11-60ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-11-104ms    | [S2,MB4,F]  116-11-128ms   | [S2,MB5,F]  141-11-152ms   | [S2,MB6,F]  165-11-177ms   | [S2,MB7,F]  189-11-201ms   | [S2,MB0,B]  263-11-275ms   | [S2,MB1,B]  287-11-299ms   | [S2,MB2,B]  311-11-323ms   | [S2,MB3,B]  335-11-347ms   | [S2,MB4,B]  360-11-371ms   | [S2,MB5,B]  384-11-396ms   | [S2,MB6,B]  409-11-420ms   | [S2,MB7,B]  430-11-442ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  65-16-82ms     | [S3,MB2,F]  89-16-106ms    | [S3,MB3,F]  113-16-130ms   | [S3,MB4,F]  137-16-154ms   | [S3,MB5,F]  162-16-178ms   | [S3,MB6,F]  186-16-203ms   | [S3,MB7,F]  210-16-227ms   | [S3,MB0,B]  233-23-256ms   | [S3,MB1,B]  256-24-280ms   | [S3,MB2,B]  280-24-304ms   | [S3,MB3,B]  304-24-329ms   | [S3,MB4,B]  329-24-353ms   | [S3,MB5,B]  353-24-378ms   | [S3,MB6,B]  378-24-402ms   | [S3,MB7,B]  402-24-427ms  
[rank3]:2025-12-31 23:37:38,314 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/251231_2337_stage3_step200.svg
[rank0]:2025-12-31 23:37:38,372 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2337_rank0_stage0.svg
[rank0]:	> Counts Sum: 560, Total Sum: 840 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank1]:2025-12-31 23:37:38,373 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2337_rank1_stage1.svg
[rank1]:	> Counts Sum: 700, Total Sum: 1050 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank2]:2025-12-31 23:37:38,357 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2337_rank2_stage2.svg
[rank2]:	> Counts Sum: 560, Total Sum: 840 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank3]:2025-12-31 23:37:38,456 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2337_rank3_stage3.svg
[rank3]:	> Counts Sum: 420, Total Sum: 630 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank0]:2025-12-31 23:38:14,640 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:38:14,637 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:38:14,645 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:38:14,639 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:38:52,526 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:38:52,533 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:38:52,528 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:38:52,530 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:39:15,389 - Avg. fwd time: 16.5662 / Avg. bwd time: 24.7980 / Avg. batch time: 390.4213 (ms) / GPU bubble ratio: 15.24%
[rank1]:2025-12-31 23:39:15,430 - Avg. fwd time: 15.3462 / Avg. bwd time: 16.0000 / Avg. batch time: 455.0466 (ms) / GPU bubble ratio: 44.89%
[rank2]:2025-12-31 23:39:15,408 - Avg. fwd time: 12.1088 / Avg. bwd time: 12.3671 / Avg. batch time: 418.4734 (ms) / GPU bubble ratio: 53.21%
[rank0]:2025-12-31 23:39:15,436 - Avg. fwd time: 13.4482 / Avg. bwd time: 5.9634 / Avg. batch time: 478.7204 (ms) / GPU bubble ratio: 67.56%
[rank1]:2025-12-31 23:39:30,485 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:39:30,479 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:39:30,481 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:39:30,482 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:40:08,586 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:40:08,588 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:40:08,583 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:40:08,585 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:40:46,657 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:40:46,674 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:40:46,660 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:40:46,662 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 23:40:46,674 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:40:50,439 - Avg. fwd time: 13.3895 / Avg. bwd time: 5.3672 / Avg. batch time: 477.1932 (ms) / GPU bubble ratio: 68.55%
[rank0]:2025-12-31 23:40:50,442 -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,520  tflops: 66.60  mfu: 21.35%
[rank3]:2025-12-31 23:40:50,391 - Avg. fwd time: 16.5601 / Avg. bwd time: 24.7534 / Avg. batch time: 390.0087 (ms) / GPU bubble ratio: 15.26%
[rank3]:2025-12-31 23:40:50,444 -  step: 250  loss: 12.5257  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,520  tflops: 66.60  mfu: 21.35%
[rank1]:2025-12-31 23:40:50,432 - Avg. fwd time: 15.3307 / Avg. bwd time: 15.9014 / Avg. batch time: 454.2493 (ms) / GPU bubble ratio: 45.00%
[rank1]:2025-12-31 23:40:50,441 -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,520  tflops: 66.60  mfu: 21.35%
[rank2]:2025-12-31 23:40:50,410 - Avg. fwd time: 12.0949 / Avg. bwd time: 12.3156 / Avg. batch time: 417.9753 (ms) / GPU bubble ratio: 53.28%
[rank2]:2025-12-31 23:40:50,442 -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,520  tflops: 66.60  mfu: 21.35%
[rank3]:2025-12-31 23:41:24,601 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:41:24,607 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:41:24,603 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:41:24,604 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:42:04,640 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:42:04,644 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:42:04,637 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:42:04,639 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:42:27,489 - Avg. fwd time: 15.3302 / Avg. bwd time: 15.8750 / Avg. batch time: 454.0686 (ms) / GPU bubble ratio: 45.02%
[rank3]:2025-12-31 23:42:27,447 - Avg. fwd time: 16.5606 / Avg. bwd time: 24.7528 / Avg. batch time: 390.0069 (ms) / GPU bubble ratio: 15.26%
[rank2]:2025-12-31 23:42:27,467 - Avg. fwd time: 12.0937 / Avg. bwd time: 12.3121 / Avg. batch time: 417.9533 (ms) / GPU bubble ratio: 53.29%
[rank0]:2025-12-31 23:42:27,496 - Avg. fwd time: 13.3612 / Avg. bwd time: 5.3263 / Avg. batch time: 476.9116 (ms) / GPU bubble ratio: 68.65%
[rank0]:2025-12-31 23:42:42,683 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:42:42,686 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:42:42,680 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:42:42,682 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:43:20,818 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:43:20,820 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:43:20,815 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:43:20,817 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:43:58,664 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 23:43:58,675 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:43:58,676 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:43:58,668 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:43:58,670 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:44:02,411 - Avg. fwd time: 16.5556 / Avg. bwd time: 24.7192 / Avg. batch time: 389.6933 (ms) / GPU bubble ratio: 15.27%
[rank2]:2025-12-31 23:44:02,431 - Avg. fwd time: 12.0833 / Avg. bwd time: 12.2737 / Avg. batch time: 417.5780 (ms) / GPU bubble ratio: 53.34%
[rank2]:2025-12-31 23:44:02,464 -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,532  tflops: 66.70  mfu: 21.38%
[rank0]:2025-12-31 23:44:02,461 - Avg. fwd time: 13.3200 / Avg. bwd time: 4.8826 / Avg. batch time: 475.7826 (ms) / GPU bubble ratio: 69.39%
[rank0]:2025-12-31 23:44:02,465 -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,532  tflops: 66.70  mfu: 21.38%
[rank0]:2025-12-31 23:44:02,516 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/251231_2344_stage0_step300.svg
[rank1]:2025-12-31 23:44:02,454 - Avg. fwd time: 15.3187 / Avg. bwd time: 15.8029 / Avg. batch time: 453.4818 (ms) / GPU bubble ratio: 45.10%
[rank1]:2025-12-31 23:44:02,464 -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,532  tflops: 66.70  mfu: 21.38%
[rank1]:2025-12-31 23:44:02,516 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/251231_2344_stage1_step300.svg
[rank3]:2025-12-31 23:44:02,467 -  step: 300  loss: 12.9454  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,532  tflops: 66.70  mfu: 21.38%
[rank2]:2025-12-31 23:44:02,517 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/251231_2344_stage2_step300.svg
[rank3]:2025-12-31 23:44:02,601 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/251231_2344_step300_rank3.svg
[rank3]:			> Batch Time: 463.50 ms, GPU Bubble Ratio: 77.75%, 47.89%, 58.88%, 29.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-12-12ms      | [S0,MB1,F]  12-12-25ms     | [S0,MB2,F]  25-12-37ms     | [S0,MB3,F]  38-12-50ms     | [S0,MB4,F]  50-12-63ms     | [S0,MB5,F]  63-13-77ms     | [S0,MB6,F]  76-12-89ms     | [S0,MB7,F]  89-13-102ms    | [S0,MB0,B]  294-0-294ms    | [S0,MB1,B]  318-0-318ms    | [S0,MB2,B]  342-0-342ms    | [S0,MB3,B]  366-0-366ms    | [S0,MB4,B]  391-0-391ms    | [S0,MB5,B]  415-0-415ms    | [S0,MB6,B]  439-0-439ms    | [S0,MB7,B]  463-0-463ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  12-15-27ms     | [S1,MB1,F]  31-15-46ms     | [S1,MB2,F]  49-15-64ms     | [S1,MB3,F]  70-15-85ms     | [S1,MB4,F]  94-15-109ms    | [S1,MB5,F]  118-15-133ms   | [S1,MB6,F]  142-15-157ms   | [S1,MB7,F]  166-15-181ms   | [S1,MB0,B]  275-14-290ms   | [S1,MB1,B]  299-14-314ms   | [S1,MB2,B]  323-14-338ms   | [S1,MB3,B]  348-15-363ms   | [S1,MB4,B]  372-15-387ms   | [S1,MB5,B]  396-15-411ms   | [S1,MB6,B]  421-15-436ms   | [S1,MB7,B]  443-15-459ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  27-12-39ms     | [S2,MB1,F]  46-11-58ms     | [S2,MB2,F]  67-11-79ms     | [S2,MB3,F]  90-11-102ms    | [S2,MB4,F]  114-11-126ms   | [S2,MB5,F]  138-11-150ms   | [S2,MB6,F]  163-11-175ms   | [S2,MB7,F]  187-11-199ms   | [S2,MB0,B]  260-11-272ms   | [S2,MB1,B]  284-11-296ms   | [S2,MB2,B]  308-11-320ms   | [S2,MB3,B]  333-11-345ms   | [S2,MB4,B]  357-11-369ms   | [S2,MB5,B]  381-11-393ms   | [S2,MB6,B]  406-11-418ms   | [S2,MB7,B]  428-11-440ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  39-16-56ms     | [S3,MB1,F]  63-16-80ms     | [S3,MB2,F]  87-16-104ms    | [S3,MB3,F]  111-16-128ms   | [S3,MB4,F]  135-16-152ms   | [S3,MB5,F]  159-16-176ms   | [S3,MB6,F]  183-16-200ms   | [S3,MB7,F]  207-16-224ms   | [S3,MB0,B]  230-23-254ms   | [S3,MB1,B]  254-24-278ms   | [S3,MB2,B]  278-24-302ms   | [S3,MB3,B]  302-24-326ms   | [S3,MB4,B]  326-24-351ms   | [S3,MB5,B]  350-24-375ms   | [S3,MB6,B]  375-24-399ms   | [S3,MB7,B]  399-24-424ms  
[rank3]:2025-12-31 23:44:02,642 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/251231_2344_stage3_step300.svg
[rank0]:2025-12-31 23:44:02,685 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2344_rank0_stage0.svg
[rank0]:	> Counts Sum: 1064, Total Sum: 1400 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank1]:2025-12-31 23:44:02,700 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2344_rank1_stage1.svg
[rank1]:	> Counts Sum: 1330, Total Sum: 1750 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank2]:2025-12-31 23:44:02,684 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2344_rank2_stage2.svg
[rank2]:	> Counts Sum: 1064, Total Sum: 1400 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank3]:2025-12-31 23:44:02,780 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2344_rank3_stage3.svg
[rank3]:	> Counts Sum: 798, Total Sum: 1050 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank2]:2025-12-31 23:44:36,903 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:44:36,904 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:44:36,907 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:44:36,901 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:45:14,909 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:45:14,912 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:45:14,906 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:45:14,908 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:45:37,576 - Avg. fwd time: 16.5515 / Avg. bwd time: 24.6908 / Avg. batch time: 389.4269 (ms) / GPU bubble ratio: 15.28%
[rank2]:2025-12-31 23:45:37,596 - Avg. fwd time: 12.0746 / Avg. bwd time: 12.2412 / Avg. batch time: 417.2787 (ms) / GPU bubble ratio: 53.38%
[rank0]:2025-12-31 23:45:37,627 - Avg. fwd time: 13.2839 / Avg. bwd time: 4.5072 / Avg. batch time: 474.8406 (ms) / GPU bubble ratio: 70.03%
[rank1]:2025-12-31 23:45:37,619 - Avg. fwd time: 15.3090 / Avg. bwd time: 15.7419 / Avg. batch time: 453.0015 (ms) / GPU bubble ratio: 45.16%
[rank3]:2025-12-31 23:45:52,980 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:45:52,982 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:45:52,983 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:45:52,986 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:46:33,024 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:46:33,014 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:46:33,017 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:46:33,018 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:47:10,895 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:47:10,897 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:47:10,900 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 23:47:10,912 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:47:10,914 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:47:14,681 - Avg. fwd time: 16.5537 / Avg. bwd time: 24.6960 / Avg. batch time: 389.4830 (ms) / GPU bubble ratio: 15.27%
[rank2]:2025-12-31 23:47:14,701 - Avg. fwd time: 12.0757 / Avg. bwd time: 12.2443 / Avg. batch time: 417.3285 (ms) / GPU bubble ratio: 53.38%
[rank0]:2025-12-31 23:47:14,732 - Avg. fwd time: 13.2704 / Avg. bwd time: 4.5364 / Avg. batch time: 474.7983 (ms) / GPU bubble ratio: 70.00%
[rank0]:2025-12-31 23:47:14,735 -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,521  tflops: 66.62  mfu: 21.35%
[rank1]:2025-12-31 23:47:14,724 - Avg. fwd time: 15.3101 / Avg. bwd time: 15.7327 / Avg. batch time: 452.9624 (ms) / GPU bubble ratio: 45.17%
[rank1]:2025-12-31 23:47:14,735 -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,521  tflops: 66.62  mfu: 21.35%
[rank3]:2025-12-31 23:47:14,737 -  step: 350  loss: 11.1852  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,521  tflops: 66.62  mfu: 21.35%
[rank2]:2025-12-31 23:47:14,735 -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,521  tflops: 66.62  mfu: 21.35%
[rank0]:2025-12-31 23:47:48,910 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:47:48,912 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:47:48,906 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:47:48,909 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:48:26,995 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:48:26,997 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:48:26,998 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:48:27,000 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:48:49,694 - Avg. fwd time: 15.3035 / Avg. bwd time: 15.6848 / Avg. batch time: 452.5698 (ms) / GPU bubble ratio: 45.22%
[rank3]:2025-12-31 23:48:49,649 - Avg. fwd time: 16.5509 / Avg. bwd time: 24.6729 / Avg. batch time: 389.2716 (ms) / GPU bubble ratio: 15.28%
[rank2]:2025-12-31 23:48:49,671 - Avg. fwd time: 12.0687 / Avg. bwd time: 12.2182 / Avg. batch time: 417.0744 (ms) / GPU bubble ratio: 53.41%
[rank0]:2025-12-31 23:48:49,702 - Avg. fwd time: 13.2429 / Avg. bwd time: 4.2341 / Avg. batch time: 474.0381 (ms) / GPU bubble ratio: 70.51%
[rank1]:2025-12-31 23:49:04,934 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:49:04,929 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:49:04,931 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:49:04,932 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:49:42,805 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:49:42,808 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:49:42,809 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:49:42,812 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:50:20,803 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 23:50:20,816 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:50:20,808 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:50:20,810 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:50:20,815 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:50:24,663 - Avg. fwd time: 16.5494 / Avg. bwd time: 24.6543 / Avg. batch time: 389.1070 (ms) / GPU bubble ratio: 15.29%
[rank2]:2025-12-31 23:50:24,685 - Avg. fwd time: 12.0630 / Avg. bwd time: 12.1957 / Avg. batch time: 416.8740 (ms) / GPU bubble ratio: 53.45%
[rank1]:2025-12-31 23:50:24,709 - Avg. fwd time: 15.2972 / Avg. bwd time: 15.6434 / Avg. batch time: 452.2495 (ms) / GPU bubble ratio: 45.27%
[rank1]:2025-12-31 23:50:24,721 -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,624  tflops: 67.42  mfu: 21.61%
[rank3]:2025-12-31 23:50:24,723 -  step: 400  loss: 10.2708  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,624  tflops: 67.42  mfu: 21.61%
[rank2]:2025-12-31 23:50:24,721 -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,624  tflops: 67.42  mfu: 21.61%
[rank2]:2025-12-31 23:50:24,775 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/251231_2350_stage2_step400.svg
[rank0]:2025-12-31 23:50:24,717 - Avg. fwd time: 13.2194 / Avg. bwd time: 3.9696 / Avg. batch time: 473.3964 (ms) / GPU bubble ratio: 70.95%
[rank0]:2025-12-31 23:50:24,721 -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,624  tflops: 67.42  mfu: 21.61%
[rank0]:2025-12-31 23:50:24,777 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/251231_2350_stage0_step400.svg
[rank1]:2025-12-31 23:50:24,776 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/251231_2350_stage1_step400.svg
[rank3]:2025-12-31 23:50:24,854 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/251231_2350_step400_rank3.svg
[rank3]:			> Batch Time: 461.50 ms, GPU Bubble Ratio: 77.68%, 47.64%, 58.72%, 29.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-12-12ms      | [S0,MB1,F]  12-12-25ms     | [S0,MB2,F]  25-12-37ms     | [S0,MB3,F]  37-12-50ms     | [S0,MB4,F]  50-12-63ms     | [S0,MB5,F]  63-13-76ms     | [S0,MB6,F]  76-12-89ms     | [S0,MB7,F]  89-13-102ms    | [S0,MB0,B]  294-0-294ms    | [S0,MB1,B]  318-0-318ms    | [S0,MB2,B]  342-0-342ms    | [S0,MB3,B]  366-0-366ms    | [S0,MB4,B]  391-0-391ms    | [S0,MB5,B]  415-0-415ms    | [S0,MB6,B]  440-0-440ms    | [S0,MB7,B]  461-0-461ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  12-15-27ms     | [S1,MB1,F]  31-15-46ms     | [S1,MB2,F]  49-15-64ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  93-15-109ms    | [S1,MB5,F]  117-15-132ms   | [S1,MB6,F]  141-15-157ms   | [S1,MB7,F]  166-15-181ms   | [S1,MB0,B]  276-14-291ms   | [S1,MB1,B]  300-14-315ms   | [S1,MB2,B]  324-14-339ms   | [S1,MB3,B]  348-15-363ms   | [S1,MB4,B]  372-15-387ms   | [S1,MB5,B]  397-15-412ms   | [S1,MB6,B]  421-15-436ms   | [S1,MB7,B]  442-15-457ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  27-11-39ms     | [S2,MB1,F]  46-11-58ms     | [S2,MB2,F]  66-12-78ms     | [S2,MB3,F]  90-11-102ms    | [S2,MB4,F]  114-11-126ms   | [S2,MB5,F]  138-11-150ms   | [S2,MB6,F]  163-11-175ms   | [S2,MB7,F]  187-11-199ms   | [S2,MB0,B]  261-11-272ms   | [S2,MB1,B]  284-11-296ms   | [S2,MB2,B]  309-11-321ms   | [S2,MB3,B]  333-11-345ms   | [S2,MB4,B]  357-11-369ms   | [S2,MB5,B]  381-11-393ms   | [S2,MB6,B]  406-11-418ms   | [S2,MB7,B]  427-11-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  39-16-56ms     | [S3,MB1,F]  63-16-79ms     | [S3,MB2,F]  87-16-103ms    | [S3,MB3,F]  111-16-128ms   | [S3,MB4,F]  135-16-152ms   | [S3,MB5,F]  159-16-176ms   | [S3,MB6,F]  184-16-200ms   | [S3,MB7,F]  208-16-224ms   | [S3,MB0,B]  230-23-254ms   | [S3,MB1,B]  254-23-278ms   | [S3,MB2,B]  278-24-302ms   | [S3,MB3,B]  302-24-326ms   | [S3,MB4,B]  326-24-351ms   | [S3,MB5,B]  351-24-375ms   | [S3,MB6,B]  375-24-399ms   | [S3,MB7,B]  400-24-424ms  
[rank3]:2025-12-31 23:50:24,900 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/251231_2350_stage3_step400.svg
[rank2]:2025-12-31 23:50:24,944 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2350_rank2_stage2.svg
[rank2]:	> Counts Sum: 1568, Total Sum: 1960 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank0]:2025-12-31 23:50:24,948 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2350_rank0_stage0.svg
[rank0]:	> Counts Sum: 1568, Total Sum: 1960 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank1]:2025-12-31 23:50:24,962 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2350_rank1_stage1.svg
[rank1]:	> Counts Sum: 1960, Total Sum: 2450 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank3]:2025-12-31 23:50:25,040 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2350_rank3_stage3.svg
[rank3]:	> Counts Sum: 1176, Total Sum: 1470 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank3]:2025-12-31 23:50:46,555 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 23:50:46,648 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 23:50:46,632 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 23:50:46,649 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 23:50:59,102 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:50:59,096 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:50:59,098 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:50:59,100 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:51:39,065 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:51:39,068 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:51:39,069 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:51:39,073 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:52:01,880 - Avg. fwd time: 16.5501 / Avg. bwd time: 24.6586 / Avg. batch time: 389.1447 (ms) / GPU bubble ratio: 15.28%
[rank2]:2025-12-31 23:52:01,901 - Avg. fwd time: 12.0642 / Avg. bwd time: 12.2004 / Avg. batch time: 416.9307 (ms) / GPU bubble ratio: 53.44%
[rank0]:2025-12-31 23:52:01,935 - Avg. fwd time: 13.2119 / Avg. bwd time: 4.0251 / Avg. batch time: 473.4529 (ms) / GPU bubble ratio: 70.87%
[rank1]:2025-12-31 23:52:01,925 - Avg. fwd time: 15.2981 / Avg. bwd time: 15.6438 / Avg. batch time: 452.2646 (ms) / GPU bubble ratio: 45.27%
[rank2]:2025-12-31 23:52:16,942 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:52:16,944 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:52:16,946 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:52:16,940 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:52:54,886 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:52:54,887 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:52:54,895 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:52:54,884 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:53:32,912 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:53:32,893 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:53:32,895 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:53:32,900 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 23:53:32,914 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:53:36,630 - Avg. fwd time: 16.5455 / Avg. bwd time: 24.6377 / Avg. batch time: 388.9390 (ms) / GPU bubble ratio: 15.29%
[rank2]:2025-12-31 23:53:36,653 - Avg. fwd time: 12.0584 / Avg. bwd time: 12.1805 / Avg. batch time: 416.6922 (ms) / GPU bubble ratio: 53.46%
[rank1]:2025-12-31 23:53:36,678 - Avg. fwd time: 15.2929 / Avg. bwd time: 15.6079 / Avg. batch time: 451.9278 (ms) / GPU bubble ratio: 45.30%
[rank1]:2025-12-31 23:53:36,691 -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,535  tflops: 66.72  mfu: 21.38%
[rank3]:2025-12-31 23:53:36,694 -  step: 450  loss: 12.7476  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,535  tflops: 66.72  mfu: 21.38%
[rank2]:2025-12-31 23:53:36,691 -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,535  tflops: 66.72  mfu: 21.38%
[rank0]:2025-12-31 23:53:36,688 - Avg. fwd time: 13.1913 / Avg. bwd time: 3.8016 / Avg. batch time: 472.8450 (ms) / GPU bubble ratio: 71.25%
[rank0]:2025-12-31 23:53:36,692 -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,535  tflops: 66.72  mfu: 21.38%
[rank1]:2025-12-31 23:54:10,840 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:54:10,834 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:54:10,836 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:54:10,837 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:54:48,680 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:54:48,673 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:54:48,676 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:54:48,677 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:55:11,545 - Avg. fwd time: 15.2868 / Avg. bwd time: 15.5760 / Avg. batch time: 451.6386 (ms) / GPU bubble ratio: 45.33%
[rank3]:2025-12-31 23:55:11,498 - Avg. fwd time: 16.5419 / Avg. bwd time: 24.6204 / Avg. batch time: 388.7704 (ms) / GPU bubble ratio: 15.30%
[rank2]:2025-12-31 23:55:11,521 - Avg. fwd time: 12.0533 / Avg. bwd time: 12.1628 / Avg. batch time: 416.4940 (ms) / GPU bubble ratio: 53.49%
[rank0]:2025-12-31 23:55:11,555 - Avg. fwd time: 13.1733 / Avg. bwd time: 3.6016 / Avg. batch time: 472.3150 (ms) / GPU bubble ratio: 71.59%
[rank1]:2025-12-31 23:55:26,738 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:55:26,733 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:55:26,735 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:55:26,736 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:56:04,842 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:56:04,843 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:56:04,846 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:56:04,839 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:56:42,704 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 23:56:42,716 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:56:42,717 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:56:42,708 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:56:42,710 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:56:46,879 - Avg. fwd time: 16.5398 / Avg. bwd time: 24.6079 / Avg. batch time: 388.6517 (ms) / GPU bubble ratio: 15.30%
[rank2]:2025-12-31 23:56:46,903 - Avg. fwd time: 12.0496 / Avg. bwd time: 12.1492 / Avg. batch time: 416.3609 (ms) / GPU bubble ratio: 53.50%
[rank1]:2025-12-31 23:56:46,943 - Avg. fwd time: 15.2823 / Avg. bwd time: 15.5606 / Avg. batch time: 451.4823 (ms) / GPU bubble ratio: 45.35%
[rank1]:2025-12-31 23:56:46,969 -  step: 500  loss: -8.0000  grad_norm:  3.7220  memory: 17.21GiB(36.23%)  tps: 8,611  tflops: 67.31  mfu: 21.57%
[rank3]:2025-12-31 23:56:46,971 -  step: 500  loss: 12.9574  grad_norm:  3.7220  memory: 29.96GiB(63.07%)  tps: 8,611  tflops: 67.31  mfu: 21.58%
[rank2]:2025-12-31 23:56:46,969 -  step: 500  loss: -8.0000  grad_norm:  3.7220  memory: 13.87GiB(29.20%)  tps: 8,611  tflops: 67.31  mfu: 21.57%
[rank0]:2025-12-31 23:56:46,965 - Avg. fwd time: 13.1596 / Avg. bwd time: 3.4461 / Avg. batch time: 471.9715 (ms) / GPU bubble ratio: 71.85%
[rank0]:2025-12-31 23:56:46,969 -  step: 500  loss: -8.0000  grad_norm:  3.7220  memory: 14.52GiB(30.57%)  tps: 8,611  tflops: 67.31  mfu: 21.57%
[rank0]:2025-12-31 23:56:47,019 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/251231_2356_stage0_step500.svg
[rank1]:2025-12-31 23:56:47,019 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/251231_2356_stage1_step500.svg
[rank2]:2025-12-31 23:56:47,019 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/251231_2356_stage2_step500.svg
[rank3]:2025-12-31 23:56:47,104 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/251231_2356_step500_rank3.svg
[rank3]:			> Batch Time: 467.75 ms, GPU Bubble Ratio: 77.88%, 48.03%, 59.00%, 29.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-12-12ms      | [S0,MB1,F]  12-12-25ms     | [S0,MB2,F]  25-12-38ms     | [S0,MB3,F]  38-12-50ms     | [S0,MB4,F]  50-12-63ms     | [S0,MB5,F]  63-13-77ms     | [S0,MB6,F]  77-12-89ms     | [S0,MB7,F]  89-13-103ms    | [S0,MB0,B]  297-0-297ms    | [S0,MB1,B]  322-0-322ms    | [S0,MB2,B]  346-0-346ms    | [S0,MB3,B]  371-0-371ms    | [S0,MB4,B]  396-0-396ms    | [S0,MB5,B]  421-0-421ms    | [S0,MB6,B]  446-0-446ms    | [S0,MB7,B]  467-0-467ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  12-15-28ms     | [S1,MB1,F]  31-15-46ms     | [S1,MB2,F]  49-15-64ms     | [S1,MB3,F]  70-15-85ms     | [S1,MB4,F]  94-15-109ms    | [S1,MB5,F]  118-15-133ms   | [S1,MB6,F]  142-15-157ms   | [S1,MB7,F]  166-15-181ms   | [S1,MB0,B]  278-14-293ms   | [S1,MB1,B]  302-15-317ms   | [S1,MB2,B]  327-15-342ms   | [S1,MB3,B]  352-15-367ms   | [S1,MB4,B]  377-15-392ms   | [S1,MB5,B]  402-15-417ms   | [S1,MB6,B]  427-15-442ms   | [S1,MB7,B]  449-15-464ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-12-40ms     | [S2,MB1,F]  46-12-58ms     | [S2,MB2,F]  67-12-79ms     | [S2,MB3,F]  91-12-103ms    | [S2,MB4,F]  115-12-127ms   | [S2,MB5,F]  139-12-151ms   | [S2,MB6,F]  163-12-175ms   | [S2,MB7,F]  187-12-199ms   | [S2,MB0,B]  262-11-274ms   | [S2,MB1,B]  286-11-298ms   | [S2,MB2,B]  311-11-323ms   | [S2,MB3,B]  336-11-348ms   | [S2,MB4,B]  361-11-373ms   | [S2,MB5,B]  386-11-398ms   | [S2,MB6,B]  411-11-423ms   | [S2,MB7,B]  433-11-445ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  40-16-56ms     | [S3,MB1,F]  63-16-80ms     | [S3,MB2,F]  87-16-104ms    | [S3,MB3,F]  111-16-128ms   | [S3,MB4,F]  135-16-152ms   | [S3,MB5,F]  160-16-176ms   | [S3,MB6,F]  184-16-201ms   | [S3,MB7,F]  208-16-225ms   | [S3,MB0,B]  231-23-255ms   | [S3,MB1,B]  255-24-279ms   | [S3,MB2,B]  280-24-304ms   | [S3,MB3,B]  304-24-329ms   | [S3,MB4,B]  329-24-354ms   | [S3,MB5,B]  354-24-379ms   | [S3,MB6,B]  379-24-404ms   | [S3,MB7,B]  404-25-429ms  
[rank3]:2025-12-31 23:56:47,147 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/251231_2356_stage3_step500.svg
[rank2]:2025-12-31 23:56:47,187 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2356_rank2_stage2.svg
[rank2]:	> Counts Sum: 2016, Total Sum: 2520 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank0]:2025-12-31 23:56:47,188 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2356_rank0_stage0.svg
[rank0]:	> Counts Sum: 2016, Total Sum: 2520 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank1]:2025-12-31 23:56:47,199 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2356_rank1_stage1.svg
[rank1]:	> Counts Sum: 2520, Total Sum: 3150 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank3]:2025-12-31 23:56:47,287 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/251231_2356_rank3_stage3.svg
[rank3]:	> Counts Sum: 1512, Total Sum: 1890 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank0]:2025-12-31 23:57:25,265 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:57:25,270 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:57:25,261 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:57:25,264 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:58:03,258 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:58:03,253 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:58:03,254 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:58:03,256 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:58:25,982 - Avg. fwd time: 15.2830 / Avg. bwd time: 15.6326 / Avg. batch time: 451.9478 (ms) / GPU bubble ratio: 45.28%
[rank3]:2025-12-31 23:58:25,933 - Avg. fwd time: 16.5400 / Avg. bwd time: 24.6110 / Avg. batch time: 388.6773 (ms) / GPU bubble ratio: 15.30%
[rank2]:2025-12-31 23:58:25,957 - Avg. fwd time: 12.0506 / Avg. bwd time: 12.1531 / Avg. batch time: 416.4113 (ms) / GPU bubble ratio: 53.50%
[rank0]:2025-12-31 23:58:25,992 - Avg. fwd time: 13.1566 / Avg. bwd time: 3.4929 / Avg. batch time: 472.4849 (ms) / GPU bubble ratio: 71.81%
[rank3]:2025-12-31 23:58:41,329 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:58:41,331 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:58:41,332 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:58:41,335 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:59:19,175 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:59:19,169 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:59:19,171 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:59:19,172 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 23:59:57,080 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 23:59:57,093 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 23:59:57,095 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 23:59:57,075 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 23:59:57,077 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:00:00,921 - Avg. fwd time: 15.2795 / Avg. bwd time: 15.6041 / Avg. batch time: 451.7251 (ms) / GPU bubble ratio: 45.31%
[rank3]:2026-01-01 00:00:00,872 - Avg. fwd time: 16.5383 / Avg. bwd time: 24.5993 / Avg. batch time: 388.5687 (ms) / GPU bubble ratio: 15.30%
[rank3]:2026-01-01 00:00:00,937 -  step: 550  loss: 11.0947  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,447  tflops: 66.03  mfu: 21.16%
[rank2]:2026-01-01 00:00:00,896 - Avg. fwd time: 12.0469 / Avg. bwd time: 12.1395 / Avg. batch time: 416.2792 (ms) / GPU bubble ratio: 53.52%
[rank2]:2026-01-01 00:00:00,935 -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,447  tflops: 66.03  mfu: 21.16%
[rank0]:2026-01-01 00:00:00,932 - Avg. fwd time: 13.1429 / Avg. bwd time: 3.3342 / Avg. batch time: 472.0707 (ms) / GPU bubble ratio: 72.08%
[rank0]:2026-01-01 00:00:00,936 -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,447  tflops: 66.03  mfu: 21.16%
[rank1]:2026-01-01 00:00:00,935 -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,447  tflops: 66.03  mfu: 21.16%
[rank2]:2026-01-01 00:00:35,189 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:00:35,187 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:00:35,191 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:00:35,193 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:01:13,252 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:01:13,255 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:01:13,258 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:01:13,254 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:01:35,878 - Avg. fwd time: 16.5371 / Avg. bwd time: 24.5893 / Avg. batch time: 388.4781 (ms) / GPU bubble ratio: 15.31%
[rank1]:2026-01-01 00:01:35,928 - Avg. fwd time: 15.2763 / Avg. bwd time: 15.5784 / Avg. batch time: 451.5319 (ms) / GPU bubble ratio: 45.33%
[rank2]:2026-01-01 00:01:35,902 - Avg. fwd time: 12.0436 / Avg. bwd time: 12.1269 / Avg. batch time: 416.1672 (ms) / GPU bubble ratio: 53.54%
[rank0]:2026-01-01 00:01:35,938 - Avg. fwd time: 13.1313 / Avg. bwd time: 3.1893 / Avg. batch time: 471.7037 (ms) / GPU bubble ratio: 72.32%
[rank1]:2026-01-01 00:01:51,144 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:01:51,141 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:01:51,139 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:01:51,142 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:02:29,034 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:02:29,032 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:02:29,035 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:02:29,038 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:03:07,067 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:03:07,061 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:03:07,059 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:03:07,054 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:03:07,066 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:03:11,178 - Avg. fwd time: 15.2737 / Avg. bwd time: 15.5570 / Avg. batch time: 451.3801 (ms) / GPU bubble ratio: 45.36%
[rank2]:2026-01-01 00:03:11,151 - Avg. fwd time: 12.0412 / Avg. bwd time: 12.1173 / Avg. batch time: 416.0873 (ms) / GPU bubble ratio: 53.55%
[rank2]:2026-01-01 00:03:11,204 -  step: 600  loss: -8.0000  grad_norm: 16.8751  memory: 13.87GiB(29.20%)  tps: 8,611  tflops: 67.32  mfu: 21.58%
[rank3]:2026-01-01 00:03:11,124 - Avg. fwd time: 16.5365 / Avg. bwd time: 24.5820 / Avg. batch time: 388.4154 (ms) / GPU bubble ratio: 15.31%
[rank3]:2026-01-01 00:03:11,206 -  step: 600  loss: 10.0019  grad_norm: 16.8751  memory: 29.96GiB(63.07%)  tps: 8,611  tflops: 67.32  mfu: 21.58%
[rank0]:2026-01-01 00:03:11,201 - Avg. fwd time: 13.1213 / Avg. bwd time: 3.0772 / Avg. batch time: 471.4177 (ms) / GPU bubble ratio: 72.51%
[rank0]:2026-01-01 00:03:11,205 -  step: 600  loss: -8.0000  grad_norm: 16.8751  memory: 14.52GiB(30.57%)  tps: 8,611  tflops: 67.32  mfu: 21.58%
[rank1]:2026-01-01 00:03:11,204 -  step: 600  loss: -8.0000  grad_norm: 16.8751  memory: 17.21GiB(36.23%)  tps: 8,611  tflops: 67.32  mfu: 21.58%
[rank1]:2026-01-01 00:03:11,255 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/260101_0003_stage1_step600.svg
[rank2]:2026-01-01 00:03:11,256 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/260101_0003_stage2_step600.svg
[rank0]:2026-01-01 00:03:11,255 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/260101_0003_stage0_step600.svg
[rank3]:2026-01-01 00:03:11,339 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/260101_0003_step600_rank3.svg
[rank3]:			> Batch Time: 462.00 ms, GPU Bubble Ratio: 77.64%, 47.75%, 58.76%, 29.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-12-12ms      | [S0,MB1,F]  12-12-25ms     | [S0,MB2,F]  25-12-37ms     | [S0,MB3,F]  37-12-50ms     | [S0,MB4,F]  50-12-63ms     | [S0,MB5,F]  63-13-76ms     | [S0,MB6,F]  76-12-89ms     | [S0,MB7,F]  89-13-103ms    | [S0,MB0,B]  294-0-294ms    | [S0,MB1,B]  318-0-318ms    | [S0,MB2,B]  342-0-342ms    | [S0,MB3,B]  367-0-367ms    | [S0,MB4,B]  391-0-391ms    | [S0,MB5,B]  415-0-415ms    | [S0,MB6,B]  440-0-440ms    | [S0,MB7,B]  462-0-462ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  12-15-27ms     | [S1,MB1,F]  31-15-46ms     | [S1,MB2,F]  49-15-64ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  93-15-109ms    | [S1,MB5,F]  117-15-133ms   | [S1,MB6,F]  141-15-157ms   | [S1,MB7,F]  166-15-181ms   | [S1,MB0,B]  276-14-291ms   | [S1,MB1,B]  300-14-315ms   | [S1,MB2,B]  324-14-339ms   | [S1,MB3,B]  348-15-363ms   | [S1,MB4,B]  373-15-388ms   | [S1,MB5,B]  397-15-412ms   | [S1,MB6,B]  422-15-437ms   | [S1,MB7,B]  443-15-458ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  27-11-39ms     | [S2,MB1,F]  46-11-58ms     | [S2,MB2,F]  66-11-78ms     | [S2,MB3,F]  90-11-102ms    | [S2,MB4,F]  114-11-126ms   | [S2,MB5,F]  138-11-150ms   | [S2,MB6,F]  162-11-174ms   | [S2,MB7,F]  187-11-199ms   | [S2,MB0,B]  261-11-272ms   | [S2,MB1,B]  284-11-296ms   | [S2,MB2,B]  309-11-321ms   | [S2,MB3,B]  333-11-345ms   | [S2,MB4,B]  357-11-369ms   | [S2,MB5,B]  382-11-394ms   | [S2,MB6,B]  407-11-419ms   | [S2,MB7,B]  427-11-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  39-16-56ms     | [S3,MB1,F]  63-16-79ms     | [S3,MB2,F]  87-16-103ms    | [S3,MB3,F]  111-16-128ms   | [S3,MB4,F]  135-16-152ms   | [S3,MB5,F]  159-16-176ms   | [S3,MB6,F]  184-16-200ms   | [S3,MB7,F]  208-16-225ms   | [S3,MB0,B]  230-23-254ms   | [S3,MB1,B]  254-23-278ms   | [S3,MB2,B]  278-24-302ms   | [S3,MB3,B]  302-24-326ms   | [S3,MB4,B]  327-24-351ms   | [S3,MB5,B]  351-24-375ms   | [S3,MB6,B]  375-24-400ms   | [S3,MB7,B]  400-24-424ms  
[rank3]:2026-01-01 00:03:11,383 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/260101_0003_stage3_step600.svg
[rank0]:2026-01-01 00:03:11,423 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0003_rank0_stage0.svg
[rank0]:	> Counts Sum: 2520, Total Sum: 3080 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank1]:2026-01-01 00:03:11,439 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0003_rank1_stage1.svg
[rank1]:	> Counts Sum: 3150, Total Sum: 3850 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank2]:2026-01-01 00:03:11,424 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0003_rank2_stage2.svg
[rank2]:	> Counts Sum: 2520, Total Sum: 3080 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank3]:2026-01-01 00:03:11,524 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0003_rank3_stage3.svg
[rank3]:	> Counts Sum: 1890, Total Sum: 2310 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank0]:2026-01-01 00:03:47,589 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:03:47,593 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:03:47,585 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:03:47,588 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:04:25,389 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:04:25,391 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:04:25,392 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:04:25,395 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:04:48,228 - Avg. fwd time: 12.0424 / Avg. bwd time: 12.1220 / Avg. batch time: 416.1361 (ms) / GPU bubble ratio: 53.55%
[rank3]:2026-01-01 00:04:48,204 - Avg. fwd time: 16.5370 / Avg. bwd time: 24.5860 / Avg. batch time: 388.4515 (ms) / GPU bubble ratio: 15.31%
[rank0]:2026-01-01 00:04:48,266 - Avg. fwd time: 13.1210 / Avg. bwd time: 3.1313 / Avg. batch time: 471.4881 (ms) / GPU bubble ratio: 72.42%
[rank1]:2026-01-01 00:04:48,255 - Avg. fwd time: 15.2754 / Avg. bwd time: 15.5573 / Avg. batch time: 451.4008 (ms) / GPU bubble ratio: 45.36%
[rank1]:2026-01-01 00:05:03,315 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:05:03,311 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:05:03,309 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:05:03,312 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:05:41,405 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:05:41,403 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:05:41,410 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:05:41,408 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:06:19,700 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2026-01-01 00:06:19,713 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:06:19,696 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:06:19,697 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:06:19,717 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:06:23,464 - Avg. fwd time: 16.5355 / Avg. bwd time: 24.5765 / Avg. batch time: 388.3622 (ms) / GPU bubble ratio: 15.31%
[rank1]:2026-01-01 00:06:23,515 - Avg. fwd time: 15.2719 / Avg. bwd time: 15.5361 / Avg. batch time: 451.2274 (ms) / GPU bubble ratio: 45.38%
[rank1]:2026-01-01 00:06:23,529 -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,519  tflops: 66.60  mfu: 21.35%
[rank3]:2026-01-01 00:06:23,535 -  step: 650  loss: 12.3049  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,519  tflops: 66.60  mfu: 21.35%
[rank2]:2026-01-01 00:06:23,489 - Avg. fwd time: 12.0396 / Avg. bwd time: 12.1117 / Avg. batch time: 416.0292 (ms) / GPU bubble ratio: 53.56%
[rank2]:2026-01-01 00:06:23,529 -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,519  tflops: 66.60  mfu: 21.35%
[rank0]:2026-01-01 00:06:23,526 - Avg. fwd time: 13.1340 / Avg. bwd time: 3.0110 / Avg. batch time: 471.2145 (ms) / GPU bubble ratio: 72.59%
[rank0]:2026-01-01 00:06:23,530 -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,519  tflops: 66.60  mfu: 21.35%
[rank1]:2026-01-01 00:06:57,773 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:06:57,767 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:06:57,769 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:06:57,771 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:07:35,694 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:07:35,696 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:07:35,690 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:07:35,692 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:07:58,539 - Avg. fwd time: 16.5343 / Avg. bwd time: 24.5685 / Avg. batch time: 388.2899 (ms) / GPU bubble ratio: 15.32%
[rank2]:2026-01-01 00:07:58,564 - Avg. fwd time: 12.0371 / Avg. bwd time: 12.1020 / Avg. batch time: 415.9401 (ms) / GPU bubble ratio: 53.57%
[rank0]:2026-01-01 00:07:58,602 - Avg. fwd time: 13.1288 / Avg. bwd time: 2.8995 / Avg. batch time: 470.9394 (ms) / GPU bubble ratio: 72.77%
[rank1]:2026-01-01 00:07:58,590 - Avg. fwd time: 15.2689 / Avg. bwd time: 15.5163 / Avg. batch time: 451.0775 (ms) / GPU bubble ratio: 45.40%
[rank3]:2026-01-01 00:08:13,773 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:08:13,775 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:08:13,776 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:08:13,779 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:08:51,855 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:08:51,858 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:08:51,859 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:08:51,862 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:09:29,707 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:09:29,709 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:09:29,703 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:09:29,715 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:09:29,714 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:09:33,429 - Avg. fwd time: 16.5329 / Avg. bwd time: 24.5603 / Avg. batch time: 388.2120 (ms) / GPU bubble ratio: 15.32%
[rank1]:2026-01-01 00:09:33,481 - Avg. fwd time: 15.2664 / Avg. bwd time: 15.4977 / Avg. batch time: 450.9268 (ms) / GPU bubble ratio: 45.42%
[rank3]:2026-01-01 00:09:33,498 -  step: 700  loss: 13.1107  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,625  tflops: 67.43  mfu: 21.61%
[rank2]:2026-01-01 00:09:33,454 - Avg. fwd time: 12.0346 / Avg. bwd time: 12.0929 / Avg. batch time: 415.8470 (ms) / GPU bubble ratio: 53.58%
[rank2]:2026-01-01 00:09:33,496 -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,625  tflops: 67.42  mfu: 21.61%
[rank0]:2026-01-01 00:09:33,493 - Avg. fwd time: 13.1187 / Avg. bwd time: 2.7961 / Avg. batch time: 470.6622 (ms) / GPU bubble ratio: 72.95%
[rank0]:2026-01-01 00:09:33,496 -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,625  tflops: 67.42  mfu: 21.61%
[rank0]:2026-01-01 00:09:33,550 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/260101_0009_stage0_step700.svg
[rank1]:2026-01-01 00:09:33,496 -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,625  tflops: 67.42  mfu: 21.61%
[rank1]:2026-01-01 00:09:33,550 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/260101_0009_stage1_step700.svg
[rank3]:2026-01-01 00:09:33,632 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/260101_0009_step700_rank3.svg
[rank3]:			> Batch Time: 462.50 ms, GPU Bubble Ratio: 77.74%, 47.82%, 58.78%, 29.41%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-12-12ms      | [S0,MB1,F]  12-12-25ms     | [S0,MB2,F]  25-12-37ms     | [S0,MB3,F]  37-12-50ms     | [S0,MB4,F]  50-12-63ms     | [S0,MB5,F]  63-13-76ms     | [S0,MB6,F]  76-12-89ms     | [S0,MB7,F]  89-13-102ms    | [S0,MB0,B]  293-0-293ms    | [S0,MB1,B]  318-0-318ms    | [S0,MB2,B]  341-0-341ms    | [S0,MB3,B]  365-0-365ms    | [S0,MB4,B]  390-0-390ms    | [S0,MB5,B]  415-0-415ms    | [S0,MB6,B]  440-0-440ms    | [S0,MB7,B]  462-0-462ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  12-15-27ms     | [S1,MB1,F]  31-15-46ms     | [S1,MB2,F]  49-15-64ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  93-15-109ms    | [S1,MB5,F]  117-15-132ms   | [S1,MB6,F]  141-15-156ms   | [S1,MB7,F]  165-15-181ms   | [S1,MB0,B]  275-14-290ms   | [S1,MB1,B]  299-14-314ms   | [S1,MB2,B]  323-14-338ms   | [S1,MB3,B]  347-15-362ms   | [S1,MB4,B]  372-15-387ms   | [S1,MB5,B]  396-15-411ms   | [S1,MB6,B]  421-15-436ms   | [S1,MB7,B]  444-15-459ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  27-11-39ms     | [S2,MB1,F]  46-11-58ms     | [S2,MB2,F]  66-11-78ms     | [S2,MB3,F]  90-11-102ms    | [S2,MB4,F]  114-11-126ms   | [S2,MB5,F]  138-12-150ms   | [S2,MB6,F]  162-11-174ms   | [S2,MB7,F]  186-11-198ms   | [S2,MB0,B]  260-11-272ms   | [S2,MB1,B]  284-11-296ms   | [S2,MB2,B]  308-11-320ms   | [S2,MB3,B]  332-11-344ms   | [S2,MB4,B]  356-11-368ms   | [S2,MB5,B]  381-11-393ms   | [S2,MB6,B]  406-11-418ms   | [S2,MB7,B]  429-11-441ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  39-16-55ms     | [S3,MB1,F]  63-16-79ms     | [S3,MB2,F]  87-16-103ms    | [S3,MB3,F]  111-16-127ms   | [S3,MB4,F]  135-16-152ms   | [S3,MB5,F]  159-16-176ms   | [S3,MB6,F]  183-16-200ms   | [S3,MB7,F]  208-16-224ms   | [S3,MB0,B]  230-23-254ms   | [S3,MB1,B]  254-24-278ms   | [S3,MB2,B]  278-24-302ms   | [S3,MB3,B]  301-24-326ms   | [S3,MB4,B]  325-24-350ms   | [S3,MB5,B]  350-24-374ms   | [S3,MB6,B]  375-24-399ms   | [S3,MB7,B]  400-24-424ms  
[rank2]:2026-01-01 00:09:33,551 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/260101_0009_stage2_step700.svg
[rank3]:2026-01-01 00:09:33,678 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/260101_0009_stage3_step700.svg
[rank2]:2026-01-01 00:09:33,720 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0009_rank2_stage2.svg
[rank2]:	> Counts Sum: 3080, Total Sum: 3640 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank0]:2026-01-01 00:09:33,719 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0009_rank0_stage0.svg
[rank0]:	> Counts Sum: 3080, Total Sum: 3640 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank1]:2026-01-01 00:09:33,734 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0009_rank1_stage1.svg
[rank1]:	> Counts Sum: 3850, Total Sum: 4550 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank3]:2026-01-01 00:09:33,818 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0009_rank3_stage3.svg
[rank3]:	> Counts Sum: 2310, Total Sum: 2730 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank3]:2026-01-01 00:10:07,862 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:10:07,865 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:10:07,866 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:10:07,868 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:10:48,188 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:10:48,191 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:10:48,199 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:10:48,192 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:11:10,871 - Avg. fwd time: 16.5337 / Avg. bwd time: 24.5661 / Avg. batch time: 388.2652 (ms) / GPU bubble ratio: 15.32%
[rank2]:2026-01-01 00:11:10,896 - Avg. fwd time: 12.0362 / Avg. bwd time: 12.0992 / Avg. batch time: 415.9146 (ms) / GPU bubble ratio: 53.58%
[rank0]:2026-01-01 00:11:10,935 - Avg. fwd time: 13.1170 / Avg. bwd time: 2.8694 / Avg. batch time: 470.8261 (ms) / GPU bubble ratio: 72.84%
[rank1]:2026-01-01 00:11:10,923 - Avg. fwd time: 15.2682 / Avg. bwd time: 15.5080 / Avg. batch time: 451.0190 (ms) / GPU bubble ratio: 45.41%
[rank3]:2026-01-01 00:11:26,274 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:11:26,277 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:11:26,277 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:11:26,280 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:12:04,112 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:12:04,114 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:12:04,117 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:12:04,115 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:12:42,034 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 00:12:42,028 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:12:42,030 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:12:42,049 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:12:42,047 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:12:45,826 - Avg. fwd time: 16.5327 / Avg. bwd time: 24.5587 / Avg. batch time: 388.1961 (ms) / GPU bubble ratio: 15.32%
[rank3]:2026-01-01 00:12:45,898 -  step: 750  loss: 11.0703  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,516  tflops: 66.57  mfu: 21.34%
[rank2]:2026-01-01 00:12:45,852 - Avg. fwd time: 12.0339 / Avg. bwd time: 12.0909 / Avg. batch time: 415.8312 (ms) / GPU bubble ratio: 53.59%
[rank2]:2026-01-01 00:12:45,895 -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,516  tflops: 66.57  mfu: 21.34%
[rank1]:2026-01-01 00:12:45,880 - Avg. fwd time: 15.2657 / Avg. bwd time: 15.4911 / Avg. batch time: 450.8842 (ms) / GPU bubble ratio: 45.43%
[rank1]:2026-01-01 00:12:45,895 -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,516  tflops: 66.57  mfu: 21.34%
[rank0]:2026-01-01 00:12:45,892 - Avg. fwd time: 13.1088 / Avg. bwd time: 2.7738 / Avg. batch time: 470.5758 (ms) / GPU bubble ratio: 73.00%
[rank0]:2026-01-01 00:12:45,896 -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,516  tflops: 66.57  mfu: 21.34%
[rank0]:2026-01-01 00:13:20,069 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:13:20,072 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:13:20,067 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:13:20,072 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:13:58,091 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:13:58,089 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:13:58,092 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:13:58,094 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:14:20,700 - Avg. fwd time: 16.5314 / Avg. bwd time: 24.5512 / Avg. batch time: 388.1285 (ms) / GPU bubble ratio: 15.32%
[rank2]:2026-01-01 00:14:20,726 - Avg. fwd time: 12.0318 / Avg. bwd time: 12.0831 / Avg. batch time: 415.7506 (ms) / GPU bubble ratio: 53.60%
[rank0]:2026-01-01 00:14:20,766 - Avg. fwd time: 13.1000 / Avg. bwd time: 2.6844 / Avg. batch time: 470.3376 (ms) / GPU bubble ratio: 73.15%
[rank1]:2026-01-01 00:14:20,753 - Avg. fwd time: 15.2642 / Avg. bwd time: 15.4755 / Avg. batch time: 450.7563 (ms) / GPU bubble ratio: 45.44%
[rank2]:2026-01-01 00:14:35,958 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:14:35,956 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:14:35,958 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:14:35,961 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:15:13,809 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:15:13,807 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:15:13,810 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 00:15:13,813 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:15:51,782 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:15:51,778 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2026-01-01 00:15:51,790 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 00:15:51,784 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 00:15:51,789 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 00:15:55,648 - Avg. fwd time: 16.5309 / Avg. bwd time: 24.5455 / Avg. batch time: 388.0779 (ms) / GPU bubble ratio: 15.32%
[rank2]:2026-01-01 00:15:55,675 - Avg. fwd time: 12.0299 / Avg. bwd time: 12.0759 / Avg. batch time: 415.6884 (ms) / GPU bubble ratio: 53.61%
[rank2]:2026-01-01 00:15:55,719 -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 13.87GiB(29.20%)  tps: 8,631  tflops: 67.47  mfu: 21.63%
[rank2]:2026-01-01 00:15:55,719 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,026  tflops: 70.56  mfu: 20.64%
[rank2]:2026-01-01 00:15:55,719 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 00:15:55,719 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 00:15:55,721 -  step: 800  loss:  9.7916  grad_norm:  0.0000  memory: 29.96GiB(63.07%)  tps: 8,631  tflops: 67.48  mfu: 21.63%
[rank3]:2026-01-01 00:15:55,722 - â„¹ï¸ final step: 800  loss:  9.7916  grad_norm:  0.0000  tps: 9,027  tflops: 70.57  mfu: 20.66%
[rank3]:2026-01-01 00:15:55,722 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 00:15:55,723 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 00:15:55,716 - Avg. fwd time: 13.0920 / Avg. bwd time: 2.6006 / Avg. batch time: 470.1256 (ms) / GPU bubble ratio: 73.30%
[rank0]:2026-01-01 00:15:55,719 -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 14.52GiB(30.57%)  tps: 8,631  tflops: 67.47  mfu: 21.63%
[rank0]:2026-01-01 00:15:55,719 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,020  tflops: 70.51  mfu: 20.51%
[rank0]:2026-01-01 00:15:55,719 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 00:15:55,720 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 00:15:55,703 - Avg. fwd time: 15.2626 / Avg. bwd time: 15.4610 / Avg. batch time: 450.6501 (ms) / GPU bubble ratio: 45.46%
[rank1]:2026-01-01 00:15:55,718 -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 17.21GiB(36.23%)  tps: 8,631  tflops: 67.47  mfu: 21.63%
[rank1]:2026-01-01 00:15:55,719 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,020  tflops: 70.52  mfu: 20.53%
[rank1]:2026-01-01 00:15:55,719 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 00:15:55,719 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 00:15:57,735 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-01 00:15:57,810 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank2/260101_0015_stage2_final800.svg
[rank3]:2026-01-01 00:15:57,890 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/260101_0015_final800_rank3.svg
[rank3]:			> Batch Time: 465.50 ms, GPU Bubble Ratio: 77.73%, 47.90%, 58.92%, 29.58%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-12-12ms      | [S0,MB1,F]  12-12-25ms     | [S0,MB2,F]  25-12-38ms     | [S0,MB3,F]  38-12-50ms     | [S0,MB4,F]  50-12-63ms     | [S0,MB5,F]  63-13-77ms     | [S0,MB6,F]  77-12-89ms     | [S0,MB7,F]  89-13-103ms    | [S0,MB0,B]  296-0-296ms    | [S0,MB1,B]  320-0-320ms    | [S0,MB2,B]  344-0-344ms    | [S0,MB3,B]  369-0-369ms    | [S0,MB4,B]  394-0-394ms    | [S0,MB5,B]  418-0-418ms    | [S0,MB6,B]  443-0-443ms    | [S0,MB7,B]  465-0-465ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  12-15-28ms     | [S1,MB1,F]  31-15-46ms     | [S1,MB2,F]  49-15-64ms     | [S1,MB3,F]  70-15-85ms     | [S1,MB4,F]  94-15-109ms    | [S1,MB5,F]  118-15-133ms   | [S1,MB6,F]  142-15-157ms   | [S1,MB7,F]  166-15-181ms   | [S1,MB0,B]  277-14-292ms   | [S1,MB1,B]  301-15-316ms   | [S1,MB2,B]  325-15-341ms   | [S1,MB3,B]  350-15-365ms   | [S1,MB4,B]  375-15-390ms   | [S1,MB5,B]  399-15-415ms   | [S1,MB6,B]  424-15-439ms   | [S1,MB7,B]  446-15-461ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-12-40ms     | [S2,MB1,F]  46-12-58ms     | [S2,MB2,F]  67-12-79ms     | [S2,MB3,F]  90-12-102ms    | [S2,MB4,F]  115-12-127ms   | [S2,MB5,F]  139-12-151ms   | [S2,MB6,F]  163-12-175ms   | [S2,MB7,F]  187-11-199ms   | [S2,MB0,B]  261-11-273ms   | [S2,MB1,B]  286-11-298ms   | [S2,MB2,B]  310-11-322ms   | [S2,MB3,B]  335-11-347ms   | [S2,MB4,B]  359-11-371ms   | [S2,MB5,B]  384-11-396ms   | [S2,MB6,B]  409-11-421ms   | [S2,MB7,B]  431-11-442ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  40-16-56ms     | [S3,MB1,F]  63-16-80ms     | [S3,MB2,F]  87-16-104ms    | [S3,MB3,F]  111-16-128ms   | [S3,MB4,F]  136-16-152ms   | [S3,MB5,F]  160-16-176ms   | [S3,MB6,F]  184-16-201ms   | [S3,MB7,F]  208-16-225ms   | [S3,MB0,B]  231-23-255ms   | [S3,MB1,B]  255-24-279ms   | [S3,MB2,B]  279-24-303ms   | [S3,MB3,B]  304-24-328ms   | [S3,MB4,B]  328-24-353ms   | [S3,MB5,B]  353-24-377ms   | [S3,MB6,B]  377-24-402ms   | [S3,MB7,B]  402-24-427ms  
[rank0]:2026-01-01 00:15:57,810 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank0/260101_0015_stage0_final800.svg
[rank1]:2026-01-01 00:15:57,810 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank1/260101_0015_stage1_final800.svg
[rank0]:2026-01-01 00:15:57,979 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0015_rank0_stage0.svg
[rank0]:	> Counts Sum: 3584, Total Sum: 4200 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank0]:2026-01-01 00:15:57,979 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-01 00:15:57,997 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0015_rank1_stage1.svg
[rank1]:	> Counts Sum: 4480, Total Sum: 5250 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank1]:2026-01-01 00:15:57,997 - Destroying the purge thread.
[rank2]:2026-01-01 00:15:57,978 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0015_rank2_stage2.svg
[rank2]:	> Counts Sum: 3584, Total Sum: 4200 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank2]:2026-01-01 00:15:57,979 - Destroying the purge thread.
[rank3]:2026-01-01 00:15:58,025 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/pipeline_schedule/260101_0015_thry_final800_rank3.svg
[rank3]:			> Batch Time: 467.87 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-14-28ms     | [S0,MB2,F]  28-14-42ms     | [S0,MB3,F]  42-14-56ms     | [S0,MB4,F]  56-14-70ms     | [S0,MB5,F]  70-14-85ms     | [S0,MB6,F]  85-14-99ms     | [S0,MB7,F]  99-14-113ms    | [S0,MB0,B]  241-28-269ms   | [S0,MB1,B]  269-28-297ms   | [S0,MB2,B]  297-28-326ms   | [S0,MB3,B]  326-28-354ms   | [S0,MB4,B]  354-28-382ms   | [S0,MB5,B]  382-28-411ms   | [S0,MB6,B]  411-28-439ms   | [S0,MB7,B]  439-28-467ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-14-28ms     | [S1,MB1,F]  28-14-42ms     | [S1,MB2,F]  42-14-56ms     | [S1,MB3,F]  56-14-70ms     | [S1,MB4,F]  70-14-85ms     | [S1,MB5,F]  85-14-99ms     | [S1,MB6,F]  99-14-113ms    | [S1,MB7,F]  113-14-127ms   | [S1,MB0,B]  212-28-241ms   | [S1,MB1,B]  241-28-269ms   | [S1,MB2,B]  269-28-297ms   | [S1,MB3,B]  297-28-326ms   | [S1,MB4,B]  326-28-354ms   | [S1,MB5,B]  354-28-382ms   | [S1,MB6,B]  382-28-411ms   | [S1,MB7,B]  411-28-439ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-14-42ms     | [S2,MB1,F]  42-14-56ms     | [S2,MB2,F]  56-14-70ms     | [S2,MB3,F]  70-14-85ms     | [S2,MB4,F]  85-14-99ms     | [S2,MB5,F]  99-14-113ms    | [S2,MB6,F]  113-14-127ms   | [S2,MB7,F]  127-14-141ms   | [S2,MB0,B]  184-28-212ms   | [S2,MB1,B]  212-28-241ms   | [S2,MB2,B]  241-28-269ms   | [S2,MB3,B]  269-28-297ms   | [S2,MB4,B]  297-28-326ms   | [S2,MB5,B]  326-28-354ms   | [S2,MB6,B]  354-28-382ms   | [S2,MB7,B]  382-28-411ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-14-56ms     | [S3,MB1,F]  56-14-70ms     | [S3,MB2,F]  70-14-85ms     | [S3,MB3,F]  85-14-99ms     | [S3,MB4,F]  99-14-113ms    | [S3,MB5,F]  113-14-127ms   | [S3,MB6,F]  127-14-141ms   | [S3,MB7,F]  141-14-155ms   | [S3,MB0,B]  155-28-184ms   | [S3,MB1,B]  184-28-212ms   | [S3,MB2,B]  212-28-241ms   | [S3,MB3,B]  241-28-269ms   | [S3,MB4,B]  269-28-297ms   | [S3,MB5,B]  297-28-326ms   | [S3,MB6,B]  326-28-354ms   | [S3,MB7,B]  354-28-382ms  
[rank3]:2026-01-01 00:15:58,077 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_ratio_history/rank3/260101_0015_stage3_final800.svg
[rank3]:2026-01-01 00:15:58,215 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1/frozen_params_histogram/260101_0015_rank3_stage3.svg
[rank3]:	> Counts Sum: 2688, Total Sum: 3150 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank3]:2026-01-01 00:15:58,216 - Destroying the purge thread.
[rank2]:2026-01-01 00:15:58,329 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank1]:2026-01-01 00:15:58,322 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 379-400
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–ƒâ–â–ƒâ–ˆâ–â–â–â–â–â–‚â–â–‡â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.6298
[rank3]:wandb:               final/avg_loss 9.79156
[rank3]:wandb:             final/avg_mfu(%) 20.66332
[rank3]:wandb:             final/avg_tflops 70.57273
[rank3]:wandb:    final/avg_throughput(tps) 9027.48618
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 9.79156
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 9.79156
[rank3]:wandb: loss_metrics/global_max_loss 9.79156
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_GPipe_apf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/bq2ra7ts
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_GPipe_apf_42_dm1/20251231-2324/wandb/run-20251231_232428-bq2ra7ts/logs
[rank3]:2026-01-01 00:15:59,317 - Process group destroyed
[rank0]:2026-01-01 00:15:59,980 - Training completed
[rank0]:2026-01-01 00:15:59,980 - Destroying the purge thread.
[rank0]:2026-01-01 00:16:00,369 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0', 'layers.3', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.5', 'layers.8', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.11', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.14', 'layers.15', 'layers.13', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_GPipe_apf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_GPipe_apf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_GPipe_apf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_GPipe_apf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_GPipe_apf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_GPipe_apf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_GPipe_apf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_GPipe_apf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
