
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 07:45:16 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_Interleaved1F1B_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2026-01-01 07:45:24,161 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank1]:2026-01-01 07:45:24,157 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank0]:2026-01-01 07:45:24,339 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank3]:2026-01-01 07:45:24,431 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2026-01-01 07:45:24,569 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 07:45:24,572 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-01 07:45:24,543 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 07:45:24,545 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 07:45:24,676 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 07:45:24,679 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 07:45:24,682 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 07:45:24,683 - Loading tokenizer from tokenizer.json
[rank3]:2026-01-01 07:45:24,776 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 07:45:24,779 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 07:45:25,071 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2026-01-01 07:45:28,520 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2026-01-01 07:45:28,645 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 07:45:28,684 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 07:45:28,710 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2026-01-01 07:45:28,723 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2026-01-01 07:45:28,724 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2026-01-01 07:45:28,673 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 07:45:28,710 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 07:45:28,711 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 07:45:28,736 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2026-01-01 07:45:28,749 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2026-01-01 07:45:28,750 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2026-01-01 07:45:28,904 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 07:45:28,904 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 07:45:28,904 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2026-01-01 07:45:28,942 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 07:45:28,942 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 07:45:28,942 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run c57mo0bh
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_Interleaved1F1B_timelyapf_42_dm1/20260101-0745/wandb/run-20260101_074529-c57mo0bh
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/c57mo0bh
[rank3]:2026-01-01 07:45:30,898 - WandB logging enabled
[rank3]:2026-01-01 07:45:30,899 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 07:45:30,940 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 07:45:30,969 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2026-01-01 07:45:30,982 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2026-01-01 07:45:30,984 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2026-01-01 07:45:31,175 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 07:45:31,175 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 07:45:31,176 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2026-01-01 07:45:31,168 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 07:45:31,207 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 07:45:31,233 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2026-01-01 07:45:31,245 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2026-01-01 07:45:31,246 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2026-01-01 07:45:31,434 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 07:45:31,434 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 07:45:31,435 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2026-01-01 07:45:31,453 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-01 07:45:31,453 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-01 07:45:31,453 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 07:45:31,452 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_Interleaved1F1B_timelyapf_42_dm1
[rank0]:2026-01-01 07:45:31,452 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 07:45:31,453 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 07:45:31,453 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2026-01-01 07:45:34,008 - [LoRA] [Stage 2] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank2]:2026-01-01 07:45:34,031 - [LoRA] [Stage 6] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank2]:2026-01-01 07:45:34,031 - Freezable Parameters: [Stage 2] 28 params, [Stage 6] 28 params
[rank3]:2026-01-01 07:45:34,042 - [LoRA] [Stage 3] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank0]:2026-01-01 07:45:33,983 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 07:45:33,984 - Finished loading the checkpoint in 2.53 seconds.
[rank0]:2026-01-01 07:45:34,007 - [LoRA] [Stage 0] trainable num params: 28 / 47 = 59.57% (size: 1,409,024 / 385,720,320 = 0.37%)
[rank0]:2026-01-01 07:45:34,029 - [LoRA] [Stage 4] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank0]:2026-01-01 07:45:34,030 - Freezable Parameters: [Stage 0] 28 params, [Stage 4] 28 params
[rank0]:2026-01-01 07:45:34,030 - Training starts at step 1
[rank1]:2026-01-01 07:45:34,042 - [LoRA] [Stage 1] trainable num params: 42 / 69 = 60.87% (size: 2,113,536 / 184,578,048 = 1.15%)
[rank3]:2026-01-01 07:45:34,055 - [LoRA] [Stage 7] trainable num params: 14 / 25 = 56.00% (size: 704,512 / 324,196,352 = 0.22%)
[rank3]:2026-01-01 07:45:34,056 - Freezable Parameters: [Stage 3] 28 params, [Stage 7] 14 params
[rank1]:2026-01-01 07:45:34,071 - [LoRA] [Stage 5] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank1]:2026-01-01 07:45:34,072 - Freezable Parameters: [Stage 1] 42 params, [Stage 5] 28 params
[rank3]:2026-01-01 07:45:39,600 -  step:  1  loss: 10.6092  grad_norm: 10.0095  memory: 25.94GiB(54.60%)  tps: 3,785  tflops: 29.59  mfu: 9.48%
[rank3]:2026-01-01 07:45:39,600 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-01 07:45:39,598 -  step:  1  loss: -4.0000  grad_norm: 10.0095  memory: 11.81GiB(24.86%)  tps: 3,003  tflops: 23.47  mfu: 7.52%
[rank2]:2026-01-01 07:45:39,598 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 07:45:39,608 -  step:  1  loss: -4.0000  grad_norm: 10.0095  memory: 20.04GiB(42.18%)  tps: 3,901  tflops: 30.49  mfu: 9.77%
[rank1]:2026-01-01 07:45:39,609 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 07:45:39,623 -  step:  1  loss: -4.0000  grad_norm: 10.0095  memory: 17.58GiB(37.01%)  tps: 3,003  tflops: 23.47  mfu: 7.52%
[rank0]:2026-01-01 07:45:39,623 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 07:49:25,605 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 07:49:30,179 - Avg. fwd time: 18.3206 / Avg. bwd time: 27.0500 / Avg. batch time: 999.5168 (ms) / GPU bubble ratio: 27.37%
[rank2]:2026-01-01 07:49:30,231 - Avg. fwd time: 13.6490 / Avg. bwd time: 16.4819 / Avg. batch time: 1067.6730 (ms) / GPU bubble ratio: 54.85%
[rank1]:2026-01-01 07:49:30,265 - Avg. fwd time: 17.0801 / Avg. bwd time: 19.8992 / Avg. batch time: 1124.2876 (ms) / GPU bubble ratio: 47.37%
[rank1]:2026-01-01 07:49:30,290 -  step: 50  loss: -4.0000  grad_norm:  8.4938  memory: 20.04GiB(42.18%)  tps: 6,960  tflops: 54.41  mfu: 17.44%
[rank3]:2026-01-01 07:49:30,291 -  step: 50  loss: 12.4624  grad_norm:  8.4938  memory: 25.94GiB(54.60%)  tps: 6,960  tflops: 54.41  mfu: 17.44%
[rank2]:2026-01-01 07:49:30,290 -  step: 50  loss: -4.0000  grad_norm:  8.4938  memory: 11.87GiB(24.98%)  tps: 6,960  tflops: 54.41  mfu: 17.44%
[rank0]:2026-01-01 07:49:30,287 - Avg. fwd time: 14.0156 / Avg. bwd time: 15.1533 / Avg. batch time: 1158.1821 (ms) / GPU bubble ratio: 59.70%
[rank0]:2026-01-01 07:49:30,291 -  step: 50  loss: -4.0000  grad_norm:  8.4938  memory: 17.58GiB(37.01%)  tps: 6,961  tflops: 54.42  mfu: 17.44%
[rank3]:2026-01-01 07:50:12,567 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2026-01-01 07:50:59,696 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2026-01-01 07:50:59,844 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2026-01-01 07:50:59,817 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2026-01-01 07:50:59,857 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2026-01-01 07:51:47,002 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2026-01-01 07:51:47,184 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2026-01-01 07:53:19,373 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank2]:2026-01-01 07:53:19,626 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2026-01-01 07:53:19,589 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 07:53:19,638 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 07:53:19,639 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 07:53:19,850 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0753_max_batch_time.svg
[rank3]:			> Batch Time: 859.37 ms, GPU Bubble Ratio: 45.57%, 31.06%, 43.85%, 15.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  58-14-73ms     | [S4,MB1,F]  77-14-92ms     | [S4,MB2,F]  96-14-111ms    | [S4,MB3,F]  116-14-130ms   | [S0,MB4,F]  130-14-145ms   | [S0,MB5,F]  145-14-159ms   | [S0,MB6,F]  159-13-172ms   | [S4,MB0,B]  205-16-221ms   | [S0,MB7,F]  221-12-234ms   | [S4,MB1,B]  263-16-279ms   | [S4,MB4,F]  362-14-377ms   | [S4,MB2,B]  377-17-395ms   | [S4,MB5,F]  399-14-413ms   | [S4,MB3,B]  413-17-431ms   | [S4,MB6,F]  433-14-448ms   | [S0,MB0,B]  448-16-465ms   | [S4,MB7,F]  468-13-481ms   | [S0,MB1,B]  481-16-498ms   | [S0,MB2,B]  504-13-518ms   | [S0,MB3,B]  544-13-558ms   | [S4,MB4,B]  577-14-591ms   | [S4,MB5,B]  632-14-647ms   | [S4,MB6,B]  691-14-705ms   | [S4,MB7,B]  750-14-765ms   | [S0,MB4,B]  776-13-790ms   | [S0,MB5,B]  799-13-813ms   | [S0,MB6,B]  822-13-836ms   | [S0,MB7,B]  845-13-859ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  32-19-52ms     | [S1,MB2,F]  52-19-71ms     | [S1,MB3,F]  71-19-90ms     | [S5,MB0,F]  90-12-103ms    | [S5,MB1,F]  103-12-116ms   | [S5,MB2,F]  116-12-129ms   | [S5,MB3,F]  130-12-143ms   | [S1,MB4,F]  145-19-164ms   | [S5,MB0,B]  187-17-205ms   | [S1,MB5,F]  205-23-228ms   | [S5,MB1,B]  247-15-263ms   | [S1,MB6,F]  263-20-283ms   | [S5,MB2,B]  303-16-319ms   | [S1,MB7,F]  319-21-340ms   | [S5,MB3,B]  362-17-380ms   | [S5,MB4,F]  380-13-393ms   | [S1,MB0,B]  398-25-423ms   | [S5,MB5,F]  423-15-439ms   | [S1,MB1,B]  439-24-463ms   | [S5,MB6,F]  463-16-480ms   | [S1,MB2,B]  480-24-504ms   | [S5,MB7,F]  504-15-519ms   | [S1,MB3,B]  519-24-544ms   | [S5,MB4,B]  561-15-577ms   | [S5,MB5,B]  617-15-632ms   | [S5,MB6,B]  676-15-691ms   | [S5,MB7,B]  735-15-750ms   | [S1,MB4,B]  754-22-776ms   | [S1,MB5,B]  776-22-799ms   | [S1,MB6,B]  799-22-822ms   | [S1,MB7,B]  822-23-845ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  52-12-64ms     | [S2,MB2,F]  71-12-84ms     | [S2,MB3,F]  90-12-103ms    | [S6,MB0,F]  103-12-116ms   | [S6,MB1,F]  116-12-129ms   | [S6,MB2,F]  129-12-141ms   | [S6,MB0,B]  170-17-187ms   | [S6,MB3,F]  187-14-202ms   | [S6,MB1,B]  227-19-247ms   | [S2,MB4,F]  247-14-262ms   | [S6,MB2,B]  286-16-303ms   | [S2,MB5,F]  303-13-316ms   | [S6,MB3,B]  345-17-362ms   | [S2,MB6,F]  362-14-377ms   | [S2,MB0,B]  381-17-398ms   | [S2,MB7,F]  398-14-413ms   | [S2,MB1,B]  416-16-433ms   | [S6,MB4,F]  433-14-448ms   | [S2,MB2,B]  451-17-468ms   | [S6,MB5,F]  468-13-482ms   | [S2,MB3,B]  485-16-501ms   | [S6,MB6,F]  501-13-515ms   | [S6,MB4,B]  542-18-561ms   | [S6,MB7,F]  561-14-576ms   | [S6,MB5,B]  601-15-617ms   | [S6,MB6,B]  661-15-676ms   | [S6,MB7,B]  720-15-735ms   | [S2,MB4,B]  738-15-754ms   | [S2,MB5,B]  757-15-772ms   | [S2,MB6,B]  774-15-789ms   | [S2,MB7,B]  792-15-807ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  64-12-77ms     | [S3,MB2,F]  84-12-96ms     | [S3,MB3,F]  103-12-116ms   | [S7,MB0,F]  116-18-134ms   | [S7,MB0,B]  134-35-170ms   AFR(10):0.9286 | [S7,MB1,F]  170-21-191ms   | [S7,MB1,B]  191-36-227ms   AFR(10):0.9286 | [S7,MB2,F]  227-22-250ms   | [S7,MB2,B]  250-36-286ms   AFR(10):0.9286 | [S7,MB3,F]  286-22-309ms   | [S7,MB3,B]  309-36-345ms   AFR(10):0.9286 | [S3,MB4,F]  345-16-362ms   | [S3,MB0,B]  362-18-381ms   AFR(10):1.0000 | [S3,MB5,F]  381-18-399ms   | [S3,MB1,B]  399-17-416ms   AFR(10):1.0000 | [S3,MB6,F]  416-16-433ms   | [S3,MB2,B]  433-17-451ms   AFR(10):1.0000 | [S3,MB7,F]  451-16-468ms   | [S3,MB3,B]  468-17-485ms   AFR(10):1.0000 | [S7,MB4,F]  485-21-506ms   | [S7,MB4,B]  506-36-542ms   AFR(10):0.9286 | [S7,MB5,F]  542-22-565ms   | [S7,MB5,B]  565-36-601ms   AFR(10):0.9286 | [S7,MB6,F]  601-22-624ms   | [S7,MB6,B]  624-36-661ms   AFR(10):0.9286 | [S7,MB7,F]  661-22-683ms   | [S7,MB7,B]  683-36-720ms   AFR(10):0.9286 | [S3,MB4,B]  720-18-738ms   AFR(10):1.0000 | [S3,MB5,B]  738-18-757ms   AFR(10):1.0000 | [S3,MB6,B]  757-17-774ms   AFR(10):1.0000 | [S3,MB7,B]  774-17-792ms   AFR(10):1.0000
[rank3]:2026-01-01 07:53:20,077 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0753_min_batch_time.svg
[rank3]:			> Batch Time: 832.75 ms, GPU Bubble Ratio: 58.75%, 31.20%, 43.86%, 13.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  58-14-73ms     | [S4,MB1,F]  77-14-92ms     | [S4,MB2,F]  96-14-111ms    | [S4,MB3,F]  116-14-130ms   | [S0,MB4,F]  130-14-145ms   | [S0,MB5,F]  145-14-159ms   | [S0,MB6,F]  159-13-172ms   | [S4,MB0,B]  201-15-216ms   | [S0,MB7,F]  216-12-229ms   | [S4,MB1,B]  260-15-275ms   | [S4,MB4,F]  360-14-375ms   | [S4,MB2,B]  375-16-391ms   | [S4,MB5,F]  396-14-410ms   | [S4,MB3,B]  410-16-427ms   | [S4,MB6,F]  430-14-444ms   | [S0,MB0,B]  444-0-444ms    | [S4,MB7,F]  463-13-477ms   | [S0,MB1,B]  477-0-477ms    | [S0,MB2,B]  496-0-496ms    | [S0,MB3,B]  534-0-534ms    | [S4,MB4,B]  569-13-583ms   | [S4,MB5,B]  625-14-639ms   | [S4,MB6,B]  683-14-697ms   | [S4,MB7,B]  742-14-756ms   | [S0,MB4,B]  767-0-767ms    | [S0,MB5,B]  789-0-789ms    | [S0,MB6,B]  810-0-810ms    | [S0,MB7,B]  832-0-832ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  32-19-52ms     | [S1,MB2,F]  52-19-71ms     | [S1,MB3,F]  71-19-90ms     | [S5,MB0,F]  90-12-103ms    | [S5,MB1,F]  103-12-116ms   | [S5,MB2,F]  116-12-129ms   | [S5,MB3,F]  130-12-143ms   | [S1,MB4,F]  145-19-164ms   | [S5,MB0,B]  185-15-201ms   | [S1,MB5,F]  201-23-225ms   | [S5,MB1,B]  245-14-260ms   | [S1,MB6,F]  260-20-280ms   | [S5,MB2,B]  300-15-315ms   | [S1,MB7,F]  315-21-337ms   | [S5,MB3,B]  359-16-376ms   | [S5,MB4,F]  376-13-390ms   | [S1,MB0,B]  394-23-417ms   | [S5,MB5,F]  417-15-433ms   | [S1,MB1,B]  433-23-457ms   | [S5,MB6,F]  457-16-473ms   | [S1,MB2,B]  473-22-496ms   | [S5,MB7,F]  496-15-511ms   | [S1,MB3,B]  511-22-534ms   | [S5,MB4,B]  555-14-569ms   | [S5,MB5,B]  611-14-625ms   | [S5,MB6,B]  669-14-683ms   | [S5,MB7,B]  728-14-742ms   | [S1,MB4,B]  745-21-767ms   | [S1,MB5,B]  767-21-789ms   | [S1,MB6,B]  789-21-810ms   | [S1,MB7,B]  810-22-832ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  52-12-64ms     | [S2,MB2,F]  71-12-84ms     | [S2,MB3,F]  90-12-103ms    | [S6,MB0,F]  103-12-116ms   | [S6,MB1,F]  116-12-129ms   | [S6,MB2,F]  129-12-141ms   | [S6,MB0,B]  169-15-185ms   | [S6,MB3,F]  185-14-200ms   | [S6,MB1,B]  226-18-245ms   | [S2,MB4,F]  245-14-260ms   | [S6,MB2,B]  285-15-300ms   | [S2,MB5,F]  300-13-314ms   | [S6,MB3,B]  343-16-359ms   | [S2,MB6,F]  359-14-374ms   | [S2,MB0,B]  378-15-394ms   | [S2,MB7,F]  394-14-408ms   | [S2,MB1,B]  413-15-429ms   | [S6,MB4,F]  429-14-444ms   | [S2,MB2,B]  447-16-463ms   | [S6,MB5,F]  463-13-477ms   | [S2,MB3,B]  480-15-496ms   | [S6,MB6,F]  496-13-509ms   | [S6,MB4,B]  537-17-555ms   | [S6,MB7,F]  555-14-570ms   | [S6,MB5,B]  595-15-611ms   | [S6,MB6,B]  654-14-669ms   | [S6,MB7,B]  713-14-728ms   | [S2,MB4,B]  731-14-745ms   | [S2,MB5,B]  748-14-763ms   | [S2,MB6,B]  765-14-779ms   | [S2,MB7,B]  781-14-796ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  64-12-77ms     | [S3,MB2,F]  84-12-96ms     | [S3,MB3,F]  103-12-116ms   | [S7,MB0,F]  116-18-134ms   | [S7,MB0,B]  134-35-169ms   AFR(10):0.9286 | [S7,MB1,F]  169-21-191ms   | [S7,MB1,B]  191-35-226ms   AFR(10):0.9286 | [S7,MB2,F]  226-22-249ms   | [S7,MB2,B]  249-35-285ms   AFR(10):0.9286 | [S7,MB3,F]  285-22-307ms   | [S7,MB3,B]  307-36-343ms   AFR(10):0.9286 | [S3,MB4,F]  343-16-360ms   | [S3,MB0,B]  360-17-378ms   AFR(10):1.0000 | [S3,MB5,F]  378-18-396ms   | [S3,MB1,B]  396-17-413ms   AFR(10):1.0000 | [S3,MB6,F]  413-16-430ms   | [S3,MB2,B]  430-17-447ms   AFR(10):1.0000 | [S3,MB7,F]  447-16-463ms   | [S3,MB3,B]  463-16-480ms   AFR(10):1.0000 | [S7,MB4,F]  480-21-502ms   | [S7,MB4,B]  502-35-537ms   AFR(10):0.9286 | [S7,MB5,F]  537-22-560ms   | [S7,MB5,B]  560-35-595ms   AFR(10):0.9286 | [S7,MB6,F]  595-22-618ms   | [S7,MB6,B]  618-35-654ms   AFR(10):0.9286 | [S7,MB7,F]  654-22-677ms   | [S7,MB7,B]  677-36-713ms   AFR(10):0.9286 | [S3,MB4,B]  713-17-731ms   AFR(10):1.0000 | [S3,MB5,B]  731-17-748ms   AFR(10):1.0000 | [S3,MB6,B]  748-16-765ms   AFR(10):1.0000 | [S3,MB7,B]  765-16-781ms   AFR(10):1.0000
[rank3]:2026-01-01 07:53:20,319 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0753_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 833.18 ms, GPU Bubble Ratio: 45.50%, 29.47%, 42.18%, 13.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  58-14-73ms     | [S4,MB1,F]  77-14-92ms     | [S4,MB2,F]  96-14-111ms    | [S4,MB3,F]  116-14-130ms   | [S0,MB4,F]  130-14-145ms   | [S0,MB5,F]  145-14-159ms   | [S0,MB6,F]  159-13-172ms   | [S4,MB0,B]  204-16-220ms   | [S0,MB7,F]  220-12-233ms   | [S4,MB1,B]  262-16-278ms   | [S4,MB4,F]  360-14-375ms   | [S4,MB2,B]  375-17-393ms   | [S4,MB5,F]  396-14-411ms   | [S4,MB3,B]  411-17-429ms   | [S4,MB6,F]  430-14-445ms   | [S0,MB0,B]  445-16-461ms   | [S4,MB7,F]  464-13-477ms   | [S0,MB1,B]  477-16-494ms   | [S0,MB2,B]  501-13-515ms   | [S0,MB3,B]  541-13-555ms   | [S4,MB4,B]  572-14-586ms   | [S4,MB5,B]  627-14-642ms   | [S4,MB6,B]  685-14-700ms   | [S4,MB7,B]  744-14-759ms   | [S0,MB4,B]  767-13-781ms   | [S0,MB5,B]  789-13-803ms   | [S0,MB6,B]  811-13-824ms   | [S0,MB7,B]  833-0-833ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  32-19-52ms     | [S1,MB2,F]  52-19-71ms     | [S1,MB3,F]  71-19-90ms     | [S5,MB0,F]  90-12-103ms    | [S5,MB1,F]  103-12-116ms   | [S5,MB2,F]  116-12-129ms   | [S5,MB3,F]  130-12-143ms   | [S1,MB4,F]  145-19-164ms   | [S5,MB0,B]  186-17-204ms   | [S1,MB5,F]  204-23-228ms   | [S5,MB1,B]  246-15-262ms   | [S1,MB6,F]  262-20-282ms   | [S5,MB2,B]  301-16-318ms   | [S1,MB7,F]  318-21-339ms   | [S5,MB3,B]  361-17-378ms   | [S5,MB4,F]  378-13-392ms   | [S1,MB0,B]  395-25-420ms   | [S5,MB5,F]  420-15-436ms   | [S1,MB1,B]  436-24-461ms   | [S5,MB6,F]  461-16-477ms   | [S1,MB2,B]  477-24-501ms   | [S5,MB7,F]  501-15-516ms   | [S1,MB3,B]  516-24-541ms   | [S5,MB4,B]  556-15-572ms   | [S5,MB5,B]  612-15-627ms   | [S5,MB6,B]  670-15-685ms   | [S5,MB7,B]  729-15-744ms   | [S1,MB4,B]  746-21-767ms   | [S1,MB5,B]  767-21-789ms   | [S1,MB6,B]  789-21-811ms   | [S1,MB7,B]  811-22-833ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  52-12-64ms     | [S2,MB2,F]  71-12-84ms     | [S2,MB3,F]  90-12-103ms    | [S6,MB0,F]  103-12-116ms   | [S6,MB1,F]  116-12-129ms   | [S6,MB2,F]  129-12-141ms   | [S6,MB0,B]  169-17-186ms   | [S6,MB3,F]  186-14-201ms   | [S6,MB1,B]  226-19-246ms   | [S2,MB4,F]  246-14-261ms   | [S6,MB2,B]  285-16-301ms   | [S2,MB5,F]  301-13-315ms   | [S6,MB3,B]  344-17-361ms   | [S2,MB6,F]  361-14-375ms   | [S2,MB0,B]  378-17-395ms   | [S2,MB7,F]  395-14-410ms   | [S2,MB1,B]  413-16-430ms   | [S6,MB4,F]  430-14-445ms   | [S2,MB2,B]  447-17-464ms   | [S6,MB5,F]  464-13-478ms   | [S2,MB3,B]  480-16-497ms   | [S6,MB6,F]  497-13-510ms   | [S6,MB4,B]  537-18-556ms   | [S6,MB7,F]  556-14-571ms   | [S6,MB5,B]  596-15-612ms   | [S6,MB6,B]  655-15-670ms   | [S6,MB7,B]  714-15-729ms   | [S2,MB4,B]  731-14-746ms   | [S2,MB5,B]  750-15-765ms   | [S2,MB6,B]  767-15-782ms   | [S2,MB7,B]  785-15-800ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  64-12-77ms     | [S3,MB2,F]  84-12-96ms     | [S3,MB3,F]  103-12-116ms   | [S7,MB0,F]  116-18-134ms   | [S7,MB0,B]  134-35-169ms   AFR(10):0.9286 | [S7,MB1,F]  169-21-191ms   | [S7,MB1,B]  191-35-226ms   AFR(10):0.9286 | [S7,MB2,F]  226-22-249ms   | [S7,MB2,B]  249-35-285ms   AFR(10):0.9286 | [S7,MB3,F]  285-22-307ms   | [S7,MB3,B]  307-36-344ms   AFR(10):0.9286 | [S3,MB4,F]  344-16-360ms   | [S3,MB0,B]  360-17-378ms   AFR(10):1.0000 | [S3,MB5,F]  378-18-396ms   | [S3,MB1,B]  396-17-413ms   AFR(10):1.0000 | [S3,MB6,F]  413-16-430ms   | [S3,MB2,B]  430-17-447ms   AFR(10):1.0000 | [S3,MB7,F]  447-16-464ms   | [S3,MB3,B]  464-16-480ms   AFR(10):1.0000 | [S7,MB4,F]  480-21-502ms   | [S7,MB4,B]  502-35-537ms   AFR(10):0.9286 | [S7,MB5,F]  537-22-560ms   | [S7,MB5,B]  560-35-596ms   AFR(10):0.9286 | [S7,MB6,F]  596-22-619ms   | [S7,MB6,B]  619-35-655ms   AFR(10):0.9286 | [S7,MB7,F]  655-22-677ms   | [S7,MB7,B]  677-36-714ms   AFR(10):0.9286 | [S3,MB4,B]  714-17-731ms   AFR(10):1.0000 | [S3,MB5,B]  731-18-750ms   AFR(10):1.0000 | [S3,MB6,B]  750-17-767ms   AFR(10):1.0000 | [S3,MB7,B]  767-17-785ms   AFR(10):1.0000
[rank3]:2026-01-01 07:53:20,319 - 	> Batch Time: 833.18 ms (Average Freeze Ratio: 0.27, Time Reduction Rate: 0.03)
[rank3]:2026-01-01 07:53:20,330 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2026-01-01 07:53:24,764 - Avg. fwd time: 18.3581 / Avg. bwd time: 26.9428 / Avg. batch time: 998.5729 (ms) / GPU bubble ratio: 27.41%
[rank2]:2026-01-01 07:53:24,814 - Avg. fwd time: 13.6473 / Avg. bwd time: 16.2910 / Avg. batch time: 1067.9878 (ms) / GPU bubble ratio: 55.15%
[rank0]:2026-01-01 07:53:24,855 - Avg. fwd time: 14.0192 / Avg. bwd time: 13.6152 / Avg. batch time: 1155.3690 (ms) / GPU bubble ratio: 61.73%
[rank0]:2026-01-01 07:53:24,859 -  step: 100  loss: -4.0000  grad_norm:  6.8122  memory: 17.59GiB(37.03%)  tps: 6,985  tflops: 54.60  mfu: 17.50%
[rank3]:2026-01-01 07:53:24,859 -  step: 100  loss: 13.1176  grad_norm:  6.8122  memory: 25.95GiB(54.61%)  tps: 6,985  tflops: 54.60  mfu: 17.50%
[rank1]:2026-01-01 07:53:24,846 - Avg. fwd time: 17.0904 / Avg. bwd time: 19.6665 / Avg. batch time: 1124.2737 (ms) / GPU bubble ratio: 47.69%
[rank1]:2026-01-01 07:53:24,858 -  step: 100  loss: -4.0000  grad_norm:  6.8122  memory: 20.05GiB(42.20%)  tps: 6,985  tflops: 54.60  mfu: 17.50%
[rank1]:2026-01-01 07:53:24,920 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0753_stage1_step100.svg
[rank2]:2026-01-01 07:53:24,858 -  step: 100  loss: -4.0000  grad_norm:  6.8122  memory: 11.88GiB(25.00%)  tps: 6,985  tflops: 54.60  mfu: 17.50%
[rank2]:2026-01-01 07:53:24,920 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0753_stage2_step100.svg
[rank0]:2026-01-01 07:53:24,919 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0753_stage0_step100.svg
[rank0]:2026-01-01 07:53:24,957 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0753_stage4_step100.svg
[rank1]:2026-01-01 07:53:24,959 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0753_stage5_step100.svg
[rank2]:2026-01-01 07:53:24,959 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0753_stage6_step100.svg
[rank1]:2026-01-01 07:53:25,100 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank1_stage1.svg
[rank1]:	> Counts Sum: 26880, Total Sum: 26880 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-01 07:53:25,090 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank2_stage2.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 17920 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-01 07:53:25,086 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank0_stage0.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 17920 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2026-01-01 07:53:25,092 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0753_step100_rank3.svg
[rank3]:			> Batch Time: 1128.00 ms, GPU Bubble Ratio: 69.59%, 49.24%, 58.66%, 36.58%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  244-14-259ms   | [S0,MB4,F]  259-14-273ms   | [S0,MB5,F]  273-14-287ms   | [S0,MB6,F]  287-13-300ms   | [S4,MB0,B]  431-15-446ms   | [S0,MB7,F]  446-12-459ms   | [S4,MB1,B]  531-15-546ms   | [S4,MB4,F]  575-14-590ms   | [S4,MB2,B]  590-16-606ms   | [S4,MB5,F]  610-14-625ms   | [S4,MB3,B]  625-16-641ms   | [S4,MB6,F]  645-14-660ms   | [S0,MB0,B]  660-0-660ms    | [S4,MB7,F]  681-13-694ms   | [S0,MB1,B]  694-0-694ms    | [S0,MB2,B]  729-0-729ms    | [S0,MB3,B]  771-0-771ms    | [S4,MB4,B]  800-13-814ms   | [S4,MB5,B]  874-14-888ms   | [S4,MB6,B]  944-14-958ms   | [S4,MB7,B]  1007-14-1021ms | [S0,MB4,B]  1035-0-1035ms  | [S0,MB5,B]  1071-0-1071ms  | [S0,MB6,B]  1100-0-1100ms  | [S0,MB7,B]  1128-0-1128ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  186-19-206ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  264-12-276ms   | [S5,MB2,F]  284-12-296ms   | [S5,MB3,F]  351-12-364ms   | [S1,MB4,F]  384-19-403ms   | [S5,MB0,B]  403-15-419ms   | [S1,MB5,F]  423-23-447ms   | [S5,MB1,B]  447-14-461ms   | [S1,MB6,F]  462-20-482ms   | [S5,MB2,B]  530-15-545ms   | [S1,MB7,F]  545-21-566ms   | [S5,MB3,B]  585-16-601ms   | [S5,MB4,F]  601-13-615ms   | [S1,MB0,B]  620-23-643ms   | [S5,MB5,F]  643-15-658ms   | [S1,MB1,B]  659-23-682ms   | [S5,MB6,F]  683-16-699ms   | [S1,MB2,B]  699-23-722ms   | [S5,MB7,F]  722-15-737ms   | [S1,MB3,B]  737-22-760ms   | [S5,MB4,B]  779-14-793ms   | [S5,MB5,B]  846-14-860ms   | [S5,MB6,B]  914-14-928ms   | [S5,MB7,B]  986-14-1000ms  | [S1,MB4,B]  1006-21-1028ms | [S1,MB5,B]  1043-21-1065ms | [S1,MB6,B]  1071-21-1093ms | [S1,MB7,B]  1099-21-1121ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-218ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  277-12-289ms   | [S6,MB2,F]  345-12-358ms   | [S6,MB0,B]  358-15-374ms   | [S6,MB3,F]  374-14-389ms   | [S6,MB1,B]  410-18-429ms   | [S2,MB4,F]  429-14-444ms   | [S6,MB2,B]  481-15-496ms   | [S2,MB5,F]  496-13-509ms   | [S6,MB3,B]  551-16-567ms   | [S2,MB6,F]  567-14-581ms   | [S2,MB0,B]  586-15-602ms   | [S2,MB7,F]  602-14-617ms   | [S2,MB1,B]  621-15-637ms   | [S6,MB4,F]  637-14-652ms   | [S2,MB2,B]  658-16-674ms   | [S6,MB5,F]  674-13-688ms   | [S2,MB3,B]  694-15-710ms   | [S6,MB6,F]  710-13-724ms   | [S6,MB4,B]  754-17-772ms   | [S6,MB7,F]  772-14-787ms   | [S6,MB5,B]  824-15-839ms   | [S6,MB6,B]  894-14-908ms   | [S6,MB7,B]  965-14-979ms   | [S2,MB4,B]  986-14-1000ms  | [S2,MB5,B]  1022-14-1036ms | [S2,MB6,B]  1042-14-1057ms | [S2,MB7,B]  1070-14-1085ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-173ms   | [S3,MB3,F]  218-12-231ms   | [S7,MB0,F]  270-18-288ms   | [S7,MB0,B]  300-34-335ms   | [S7,MB1,F]  335-21-357ms   | [S7,MB1,B]  368-35-404ms   | [S7,MB2,F]  404-22-426ms   | [S7,MB2,B]  438-35-474ms   | [S7,MB3,F]  474-23-497ms   | [S7,MB3,B]  508-36-544ms   | [S3,MB4,F]  544-16-561ms   | [S3,MB0,B]  560-17-578ms   | [S3,MB5,F]  578-17-595ms   | [S3,MB1,B]  596-17-613ms   | [S3,MB6,F]  613-16-629ms   | [S3,MB2,B]  629-17-647ms   | [S3,MB7,F]  646-16-662ms   | [S3,MB3,B]  663-16-679ms   | [S7,MB4,F]  679-21-700ms   | [S7,MB4,B]  712-35-748ms   | [S7,MB5,F]  747-22-769ms   | [S7,MB5,B]  782-35-817ms   | [S7,MB6,F]  818-22-840ms   | [S7,MB6,B]  851-35-887ms   | [S7,MB7,F]  887-22-910ms   | [S7,MB7,B]  921-36-957ms   | [S3,MB4,B]  957-17-975ms   | [S3,MB5,B]  975-17-992ms   | [S3,MB6,B]  992-16-1008ms  | [S3,MB7,B]  1014-16-1030ms
[rank3]:2026-01-01 07:53:25,135 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0753_stage3_step100.svg
[rank3]:2026-01-01 07:53:25,171 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0753_stage7_step100.svg
[rank1]:2026-01-01 07:53:25,228 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 17920 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-01 07:53:25,221 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 17920 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-01 07:53:25,213 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank0_stage4.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 17920 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-01 07:53:25,251 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage0.svg
[rank1]:2026-01-01 07:53:25,267 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage1.svg
[rank1]:2026-01-01 07:53:25,302 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage5.svg
[rank2]:2026-01-01 07:53:25,261 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage2.svg
[rank2]:2026-01-01 07:53:25,296 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage6.svg
[rank0]:2026-01-01 07:53:25,286 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage4.svg
[rank3]:2026-01-01 07:53:25,299 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank3_stage3.svg
[rank3]:	> Counts Sum: 17920, Total Sum: 17920 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2026-01-01 07:53:25,387 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0753_rank3_stage7.svg
[rank3]:	> Counts Sum: 8320, Total Sum: 8960 (92.86%), Ratio(%) per element: [93.75, 93.75, 93.75, 81.25, 100.0, 87.5, 81.25, 100.0, 68.75, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2026-01-01 07:53:25,427 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage3.svg
[rank3]:2026-01-01 07:53:25,462 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0753_stage7.svg
[rank1]:2026-01-01 07:57:15,137 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2026-01-01 07:57:15,129 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2026-01-01 07:57:15,127 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.27/0.40, [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2026-01-01 07:57:15,133 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 07:57:15,147 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2026-01-01 07:57:19,758 - Avg. fwd time: 18.3690 / Avg. bwd time: 26.9201 / Avg. batch time: 998.5234 (ms) / GPU bubble ratio: 27.43%
[rank1]:2026-01-01 07:57:19,842 - Avg. fwd time: 17.1013 / Avg. bwd time: 19.6862 / Avg. batch time: 1123.4396 (ms) / GPU bubble ratio: 47.61%
[rank2]:2026-01-01 07:57:19,809 - Avg. fwd time: 13.6476 / Avg. bwd time: 16.3440 / Avg. batch time: 1067.4880 (ms) / GPU bubble ratio: 55.05%
[rank3]:2026-01-01 07:57:19,869 -  step: 150  loss: 11.1266  grad_norm:  7.3344  memory: 25.95GiB(54.61%)  tps: 6,972  tflops: 54.50  mfu: 17.47%
[rank0]:2026-01-01 07:57:19,865 - Avg. fwd time: 14.0184 / Avg. bwd time: 14.0844 / Avg. batch time: 1154.5701 (ms) / GPU bubble ratio: 61.06%
[rank0]:2026-01-01 07:57:19,868 -  step: 150  loss: -4.0000  grad_norm:  7.3344  memory: 17.59GiB(37.03%)  tps: 6,972  tflops: 54.50  mfu: 17.47%
[rank1]:2026-01-01 07:57:19,868 -  step: 150  loss: -4.0000  grad_norm:  7.3344  memory: 20.05GiB(42.20%)  tps: 6,972  tflops: 54.50  mfu: 17.47%
[rank2]:2026-01-01 07:57:19,868 -  step: 150  loss: -4.0000  grad_norm:  7.3344  memory: 11.88GiB(25.00%)  tps: 6,972  tflops: 54.50  mfu: 17.47%
[rank3]:2026-01-01 08:01:09,695 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2026-01-01 08:01:09,697 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2026-01-01 08:01:09,700 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 08:01:09,687 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 08:01:09,699 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 08:01:14,334 - Avg. fwd time: 18.3822 / Avg. bwd time: 26.8919 / Avg. batch time: 998.4152 (ms) / GPU bubble ratio: 27.45%
[rank2]:2026-01-01 08:01:14,385 - Avg. fwd time: 13.6496 / Avg. bwd time: 16.3659 / Avg. batch time: 1066.9354 (ms) / GPU bubble ratio: 54.99%
[rank2]:2026-01-01 08:01:14,430 -  step: 200  loss: -4.0000  grad_norm: 33.1392  memory: 11.88GiB(25.00%)  tps: 6,985  tflops: 54.61  mfu: 17.50%
[rank1]:2026-01-01 08:01:14,417 - Avg. fwd time: 17.1111 / Avg. bwd time: 19.6799 / Avg. batch time: 1122.6021 (ms) / GPU bubble ratio: 47.56%
[rank1]:2026-01-01 08:01:14,430 -  step: 200  loss: -4.0000  grad_norm: 33.1392  memory: 20.05GiB(42.20%)  tps: 6,985  tflops: 54.61  mfu: 17.50%
[rank0]:2026-01-01 08:01:14,426 - Avg. fwd time: 14.0218 / Avg. bwd time: 14.3419 / Avg. batch time: 1154.0705 (ms) / GPU bubble ratio: 60.68%
[rank0]:2026-01-01 08:01:14,430 -  step: 200  loss: -4.0000  grad_norm: 33.1392  memory: 17.59GiB(37.03%)  tps: 6,985  tflops: 54.61  mfu: 17.50%
[rank0]:2026-01-01 08:01:14,482 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0801_stage0_step200.svg
[rank3]:2026-01-01 08:01:14,431 -  step: 200  loss: 10.3045  grad_norm: 33.1392  memory: 25.95GiB(54.61%)  tps: 6,985  tflops: 54.61  mfu: 17.50%
[rank2]:2026-01-01 08:01:14,483 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0801_stage2_step200.svg
[rank2]:2026-01-01 08:01:14,526 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0801_stage6_step200.svg
[rank1]:2026-01-01 08:01:14,483 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0801_stage1_step200.svg
[rank1]:2026-01-01 08:01:14,526 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0801_stage5_step200.svg
[rank0]:2026-01-01 08:01:14,523 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0801_stage4_step200.svg
[rank2]:2026-01-01 08:01:14,653 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank2_stage2.svg
[rank2]:	> Counts Sum: 25760, Total Sum: 107520 (23.96%), Ratio(%) per element: [23.95, 26.04, 25.0, 23.95, 21.87, 26.04, 25.0, 25.0, 22.91, 22.91, 22.91, 23.95, 23.95, 21.87, 26.04, 26.04, 23.95, 26.04, 23.95, 23.95, 21.87, 22.91, 22.91, 26.04, 22.91, 23.95, 20.83, 23.95]
[rank1]:2026-01-01 08:01:14,662 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank1_stage1.svg
[rank1]:	> Counts Sum: 73920, Total Sum: 161280 (45.83%), Ratio(%) per element: [45.83, 43.75, 47.91, 45.83, 46.87, 46.87, 48.95, 50.0, 45.83, 47.91, 45.83, 41.66, 39.58, 44.79, 41.66, 45.83, 48.95, 46.87, 44.79, 44.79, 45.83, 46.87, 46.87, 45.83, 44.79, 50.0, 42.7, 45.83, 44.79, 46.87, 50.0, 43.75, 43.75, 43.75, 48.95, 43.75, 45.83, 46.87, 43.75, 47.91, 47.91, 43.75]
[rank0]:2026-01-01 08:01:14,649 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank0_stage0.svg
[rank0]:	> Counts Sum: 25760, Total Sum: 107520 (23.96%), Ratio(%) per element: [23.95, 22.91, 25.0, 26.04, 21.87, 22.91, 23.95, 23.95, 25.0, 22.91, 22.91, 21.87, 26.04, 25.0, 22.91, 21.87, 25.0, 22.91, 26.04, 23.95, 26.04, 22.91, 21.87, 25.0, 22.91, 23.95, 25.0, 26.04]
[rank3]:2026-01-01 08:01:14,674 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0801_step200_rank3.svg
[rank3]:			> Batch Time: 1146.62 ms, GPU Bubble Ratio: 59.55%, 48.67%, 58.01%, 37.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-12-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-202ms   | [S4,MB3,F]  245-14-260ms   | [S0,MB4,F]  260-14-274ms   | [S0,MB5,F]  274-14-288ms   | [S0,MB6,F]  288-13-301ms   | [S4,MB0,B]  433-16-449ms   | [S0,MB7,F]  449-12-462ms   | [S4,MB1,B]  533-16-550ms   | [S4,MB4,F]  578-14-593ms   | [S4,MB2,B]  593-17-611ms   | [S4,MB5,F]  613-14-628ms   | [S4,MB3,B]  628-17-645ms   | [S4,MB6,F]  648-14-663ms   | [S0,MB0,B]  663-16-680ms   | [S4,MB7,F]  684-13-697ms   | [S0,MB1,B]  697-16-714ms   | [S0,MB2,B]  737-13-750ms   | [S0,MB3,B]  778-13-791ms   | [S4,MB4,B]  805-14-820ms   | [S4,MB5,B]  878-14-893ms   | [S4,MB6,B]  949-14-963ms   | [S4,MB7,B]  1014-14-1029ms | [S0,MB4,B]  1042-13-1055ms | [S0,MB5,B]  1080-13-1093ms | [S0,MB6,B]  1108-13-1121ms | [S0,MB7,B]  1137-9-1146ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  284-12-297ms   | [S5,MB3,F]  352-12-365ms   | [S1,MB4,F]  385-19-405ms   | [S5,MB0,B]  405-17-422ms   | [S1,MB5,F]  425-23-449ms   | [S5,MB1,B]  449-15-465ms   | [S1,MB6,F]  465-20-485ms   | [S5,MB2,B]  533-16-549ms   | [S1,MB7,F]  549-21-570ms   | [S5,MB3,B]  588-17-605ms   | [S5,MB4,F]  605-14-619ms   | [S1,MB0,B]  623-25-648ms   | [S5,MB5,F]  648-15-664ms   | [S1,MB1,B]  664-24-689ms   | [S5,MB6,F]  689-16-705ms   | [S1,MB2,B]  705-24-729ms   | [S5,MB7,F]  730-15-745ms   | [S1,MB3,B]  745-24-770ms   | [S5,MB4,B]  783-15-799ms   | [S5,MB5,B]  850-15-865ms   | [S5,MB6,B]  921-15-936ms   | [S5,MB7,B]  992-15-1007ms  | [S1,MB4,B]  1014-21-1035ms | [S1,MB5,B]  1051-21-1073ms | [S1,MB6,B]  1079-21-1101ms | [S1,MB7,B]  1108-21-1130ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB2,F]  346-12-359ms   | [S6,MB0,B]  359-17-376ms   | [S6,MB3,F]  376-14-391ms   | [S6,MB1,B]  412-19-432ms   | [S2,MB4,F]  432-14-446ms   | [S6,MB2,B]  482-16-499ms   | [S2,MB5,F]  499-13-513ms   | [S6,MB3,B]  554-17-571ms   | [S2,MB6,F]  571-14-585ms   | [S2,MB0,B]  590-17-607ms   | [S2,MB7,F]  607-14-622ms   | [S2,MB1,B]  626-16-643ms   | [S6,MB4,F]  643-14-658ms   | [S2,MB2,B]  661-17-678ms   | [S6,MB5,F]  678-13-692ms   | [S2,MB3,B]  700-16-717ms   | [S6,MB6,F]  717-13-731ms   | [S6,MB4,B]  758-18-776ms   | [S6,MB7,F]  776-14-791ms   | [S6,MB5,B]  827-15-843ms   | [S6,MB6,B]  899-15-914ms   | [S6,MB7,B]  970-15-985ms   | [S2,MB4,B]  992-14-1006ms  | [S2,MB5,B]  1030-15-1045ms | [S2,MB6,B]  1051-15-1067ms | [S2,MB7,B]  1079-15-1095ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-289ms   | [S7,MB0,B]  301-35-336ms   | [S7,MB1,F]  336-21-358ms   | [S7,MB1,B]  370-35-405ms   | [S7,MB2,F]  406-22-428ms   | [S7,MB2,B]  440-35-476ms   | [S7,MB3,F]  476-23-499ms   | [S7,MB3,B]  511-36-548ms   | [S3,MB4,F]  547-16-564ms   | [S3,MB0,B]  564-17-582ms   | [S3,MB5,F]  581-17-598ms   | [S3,MB1,B]  598-17-615ms   | [S3,MB6,F]  616-16-632ms   | [S3,MB2,B]  632-17-649ms   | [S3,MB7,F]  649-16-665ms   | [S3,MB3,B]  666-16-682ms   | [S7,MB4,F]  683-21-704ms   | [S7,MB4,B]  716-35-751ms   | [S7,MB5,F]  751-21-773ms   | [S7,MB5,B]  785-35-821ms   | [S7,MB6,F]  821-22-844ms   | [S7,MB6,B]  856-36-892ms   | [S7,MB7,F]  892-22-915ms   | [S7,MB7,B]  926-36-963ms   | [S3,MB4,B]  963-17-981ms   | [S3,MB5,B]  981-18-999ms   | [S3,MB6,B]  999-17-1017ms  | [S3,MB7,B]  1022-17-1040ms
[rank3]:2026-01-01 08:01:14,728 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0801_stage3_step200.svg
[rank3]:2026-01-01 08:01:14,774 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0801_stage7_step200.svg
[rank2]:2026-01-01 08:01:14,780 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 107520 (16.67%), Ratio(%) per element: [16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66]
[rank1]:2026-01-01 08:01:14,788 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 107520 (16.67%), Ratio(%) per element: [16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66]
[rank0]:2026-01-01 08:01:14,790 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank0_stage4.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 107520 (16.67%), Ratio(%) per element: [16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66]
[rank3]:2026-01-01 08:01:14,901 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank3_stage3.svg
[rank3]:	> Counts Sum: 57120, Total Sum: 107520 (53.12%), Ratio(%) per element: [56.25, 52.08, 50.0, 55.2, 54.16, 53.12, 54.16, 58.33, 53.12, 50.0, 48.95, 52.08, 57.29, 56.25, 46.87, 55.2, 52.08, 47.91, 57.29, 54.16, 58.33, 51.04, 54.16, 54.16, 50.0, 50.0, 55.2, 50.0]
[rank2]:2026-01-01 08:01:14,945 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage2.svg
[rank1]:2026-01-01 08:01:14,948 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage1.svg
[rank0]:2026-01-01 08:01:14,954 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage0.svg
[rank3]:2026-01-01 08:01:14,989 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0801_rank3_stage7.svg
[rank3]:	> Counts Sum: 33160, Total Sum: 53760 (61.68%), Ratio(%) per element: [60.41, 60.41, 55.2, 63.54, 67.7, 64.58, 59.37, 64.58, 57.29, 64.58, 63.54, 65.62, 60.41, 56.25]
[rank2]:2026-01-01 08:01:15,112 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage6.svg
[rank1]:2026-01-01 08:01:15,111 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage5.svg
[rank0]:2026-01-01 08:01:15,111 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage4.svg
[rank3]:2026-01-01 08:01:15,149 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage3.svg
[rank3]:2026-01-01 08:01:15,305 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0801_stage7.svg
[rank3]:2026-01-01 08:05:02,994 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2026-01-01 08:05:02,996 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2026-01-01 08:05:03,018 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 08:05:03,003 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-01 08:05:03,016 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 08:05:07,549 - Avg. fwd time: 18.4090 / Avg. bwd time: 26.8750 / Avg. batch time: 998.6723 (ms) / GPU bubble ratio: 27.45%
[rank2]:2026-01-01 08:05:07,599 - Avg. fwd time: 13.6515 / Avg. bwd time: 16.3770 / Avg. batch time: 1067.0258 (ms) / GPU bubble ratio: 54.97%
[rank2]:2026-01-01 08:05:07,645 -  step: 250  loss: -4.0000  grad_norm:  6.5596  memory: 11.88GiB(25.00%)  tps: 7,025  tflops: 54.92  mfu: 17.60%
[rank1]:2026-01-01 08:05:07,631 - Avg. fwd time: 17.1209 / Avg. bwd time: 19.6675 / Avg. batch time: 1122.4405 (ms) / GPU bubble ratio: 47.56%
[rank1]:2026-01-01 08:05:07,645 -  step: 250  loss: -4.0000  grad_norm:  6.5596  memory: 20.05GiB(42.20%)  tps: 7,025  tflops: 54.92  mfu: 17.60%
[rank0]:2026-01-01 08:05:07,641 - Avg. fwd time: 14.0250 / Avg. bwd time: 14.3474 / Avg. batch time: 1151.7058 (ms) / GPU bubble ratio: 60.58%
[rank0]:2026-01-01 08:05:07,645 -  step: 250  loss: -4.0000  grad_norm:  6.5596  memory: 17.59GiB(37.03%)  tps: 7,025  tflops: 54.92  mfu: 17.60%
[rank3]:2026-01-01 08:05:07,646 -  step: 250  loss: 12.5261  grad_norm:  6.5596  memory: 25.95GiB(54.61%)  tps: 7,025  tflops: 54.92  mfu: 17.60%
[rank3]:2026-01-01 08:08:55,419 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2026-01-01 08:08:55,410 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 08:08:55,423 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2026-01-01 08:08:55,421 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2026-01-01 08:08:55,426 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 08:08:59,936 - Avg. fwd time: 18.4260 / Avg. bwd time: 26.8646 / Avg. batch time: 998.8068 (ms) / GPU bubble ratio: 27.45%
[rank0]:2026-01-01 08:09:00,029 - Avg. fwd time: 14.0268 / Avg. bwd time: 14.3497 / Avg. batch time: 1149.9629 (ms) / GPU bubble ratio: 60.52%
[rank0]:2026-01-01 08:09:00,034 -  step: 300  loss: -4.0000  grad_norm:  6.5840  memory: 17.59GiB(37.03%)  tps: 7,050  tflops: 55.12  mfu: 17.67%
[rank2]:2026-01-01 08:08:59,985 - Avg. fwd time: 13.6532 / Avg. bwd time: 16.3845 / Avg. batch time: 1066.9199 (ms) / GPU bubble ratio: 54.95%
[rank2]:2026-01-01 08:09:00,033 -  step: 300  loss: -4.0000  grad_norm:  6.5840  memory: 11.88GiB(25.00%)  tps: 7,050  tflops: 55.12  mfu: 17.67%
[rank1]:2026-01-01 08:09:00,018 - Avg. fwd time: 17.1281 / Avg. bwd time: 19.6608 / Avg. batch time: 1122.1634 (ms) / GPU bubble ratio: 47.55%
[rank1]:2026-01-01 08:09:00,033 -  step: 300  loss: -4.0000  grad_norm:  6.5840  memory: 20.05GiB(42.20%)  tps: 7,050  tflops: 55.12  mfu: 17.67%
[rank1]:2026-01-01 08:09:00,084 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0809_stage1_step300.svg
[rank3]:2026-01-01 08:09:00,035 -  step: 300  loss: 12.9460  grad_norm:  6.5840  memory: 25.95GiB(54.61%)  tps: 7,050  tflops: 55.12  mfu: 17.67%
[rank0]:2026-01-01 08:09:00,085 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0809_stage0_step300.svg
[rank0]:2026-01-01 08:09:00,127 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0809_stage4_step300.svg
[rank2]:2026-01-01 08:09:00,084 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0809_stage2_step300.svg
[rank2]:2026-01-01 08:09:00,127 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0809_stage6_step300.svg
[rank1]:2026-01-01 08:09:00,126 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0809_stage5_step300.svg
[rank0]:2026-01-01 08:09:00,255 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank0_stage0.svg
[rank0]:	> Counts Sum: 36960, Total Sum: 197120 (18.75%), Ratio(%) per element: [18.75, 18.18, 19.31, 19.88, 17.61, 18.18, 18.75, 18.75, 19.31, 18.18, 18.18, 17.61, 19.88, 19.31, 18.18, 17.61, 19.31, 18.18, 19.88, 18.75, 19.88, 18.18, 17.61, 19.31, 18.18, 18.75, 19.31, 19.88]
[rank2]:2026-01-01 08:09:00,254 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank2_stage2.svg
[rank2]:	> Counts Sum: 36960, Total Sum: 197120 (18.75%), Ratio(%) per element: [18.75, 19.88, 19.31, 18.75, 17.61, 19.88, 19.31, 19.31, 18.18, 18.18, 18.18, 18.75, 18.75, 17.61, 19.88, 19.88, 18.75, 19.88, 18.75, 18.75, 17.61, 18.18, 18.18, 19.88, 18.18, 18.75, 17.04, 18.75]
[rank1]:2026-01-01 08:09:00,263 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank1_stage1.svg
[rank1]:	> Counts Sum: 141120, Total Sum: 295680 (47.73%), Ratio(%) per element: [47.72, 46.59, 48.86, 47.72, 48.29, 48.29, 49.43, 50.0, 47.72, 48.86, 47.72, 45.45, 44.31, 47.15, 45.45, 47.72, 49.43, 48.29, 47.15, 47.15, 47.72, 48.29, 48.29, 47.72, 47.15, 50.0, 46.02, 47.72, 47.15, 48.29, 50.0, 46.59, 46.59, 46.59, 49.43, 46.59, 47.72, 48.29, 46.59, 48.86, 48.86, 46.59]
[rank3]:2026-01-01 08:09:00,279 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0809_step300_rank3.svg
[rank3]:			> Batch Time: 1135.00 ms, GPU Bubble Ratio: 60.02%, 48.27%, 57.63%, 36.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S0,MB4,F]  259-14-273ms   | [S0,MB5,F]  274-14-288ms   | [S0,MB6,F]  288-13-301ms   | [S4,MB0,B]  433-16-449ms   | [S0,MB7,F]  449-12-462ms   | [S4,MB1,B]  532-16-548ms   | [S4,MB4,F]  577-14-592ms   | [S4,MB2,B]  592-17-609ms   | [S4,MB5,F]  612-14-627ms   | [S4,MB3,B]  627-17-644ms   | [S4,MB6,F]  647-14-661ms   | [S0,MB0,B]  662-16-678ms   | [S4,MB7,F]  683-13-696ms   | [S0,MB1,B]  696-16-713ms   | [S0,MB2,B]  735-13-749ms   | [S0,MB3,B]  777-13-790ms   | [S4,MB4,B]  804-14-819ms   | [S4,MB5,B]  878-14-892ms   | [S4,MB6,B]  947-14-962ms   | [S4,MB7,B]  1013-14-1027ms | [S0,MB4,B]  1041-13-1054ms | [S0,MB5,B]  1079-13-1092ms | [S0,MB6,B]  1106-13-1119ms | [S0,MB7,B]  1135-0-1135ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  284-12-297ms   | [S5,MB3,F]  352-12-365ms   | [S1,MB4,F]  385-19-404ms   | [S5,MB0,B]  404-17-422ms   | [S1,MB5,F]  425-23-448ms   | [S5,MB1,B]  448-15-464ms   | [S1,MB6,F]  464-20-484ms   | [S5,MB2,B]  532-16-548ms   | [S1,MB7,F]  548-21-569ms   | [S5,MB3,B]  587-17-604ms   | [S5,MB4,F]  604-14-618ms   | [S1,MB0,B]  622-25-647ms   | [S5,MB5,F]  648-15-663ms   | [S1,MB1,B]  663-24-688ms   | [S5,MB6,F]  688-16-704ms   | [S1,MB2,B]  704-24-728ms   | [S5,MB7,F]  728-15-743ms   | [S1,MB3,B]  744-24-768ms   | [S5,MB4,B]  782-15-798ms   | [S5,MB5,B]  850-15-865ms   | [S5,MB6,B]  919-15-934ms   | [S5,MB7,B]  991-15-1006ms  | [S1,MB4,B]  1012-21-1034ms | [S1,MB5,B]  1050-21-1072ms | [S1,MB6,B]  1078-21-1100ms | [S1,MB7,B]  1105-21-1127ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB2,F]  346-12-358ms   | [S6,MB0,B]  358-17-375ms   | [S6,MB3,F]  375-14-390ms   | [S6,MB1,B]  412-19-431ms   | [S2,MB4,F]  432-14-446ms   | [S6,MB2,B]  482-16-499ms   | [S2,MB5,F]  499-13-512ms   | [S6,MB3,B]  553-17-570ms   | [S2,MB6,F]  570-14-584ms   | [S2,MB0,B]  588-17-606ms   | [S2,MB7,F]  606-14-621ms   | [S2,MB1,B]  624-16-641ms   | [S6,MB4,F]  642-14-657ms   | [S2,MB2,B]  660-17-677ms   | [S6,MB5,F]  677-13-690ms   | [S2,MB3,B]  699-16-716ms   | [S6,MB6,F]  716-13-729ms   | [S6,MB4,B]  757-18-775ms   | [S6,MB7,F]  775-14-790ms   | [S6,MB5,B]  827-15-843ms   | [S6,MB6,B]  898-15-913ms   | [S6,MB7,B]  969-15-984ms   | [S2,MB4,B]  990-14-1005ms  | [S2,MB5,B]  1028-15-1044ms | [S2,MB6,B]  1050-15-1065ms | [S2,MB7,B]  1077-15-1093ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  270-18-289ms   | [S7,MB0,B]  301-35-336ms   | [S7,MB1,F]  336-21-357ms   | [S7,MB1,B]  370-35-405ms   | [S7,MB2,F]  405-22-428ms   | [S7,MB2,B]  439-35-475ms   | [S7,MB3,F]  475-22-498ms   | [S7,MB3,B]  510-36-546ms   | [S3,MB4,F]  546-16-563ms   | [S3,MB0,B]  563-17-580ms   | [S3,MB5,F]  580-17-598ms   | [S3,MB1,B]  598-17-615ms   | [S3,MB6,F]  615-16-631ms   | [S3,MB2,B]  631-17-649ms   | [S3,MB7,F]  648-16-665ms   | [S3,MB3,B]  665-16-681ms   | [S7,MB4,F]  681-21-703ms   | [S7,MB4,B]  715-35-750ms   | [S7,MB5,F]  750-21-772ms   | [S7,MB5,B]  785-35-820ms   | [S7,MB6,F]  820-23-843ms   | [S7,MB6,B]  855-35-891ms   | [S7,MB7,F]  891-22-914ms   | [S7,MB7,B]  925-36-962ms   | [S3,MB4,B]  962-17-980ms   | [S3,MB5,B]  979-18-998ms   | [S3,MB6,B]  998-17-1015ms  | [S3,MB7,B]  1021-17-1039ms
[rank3]:2026-01-01 08:09:00,323 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0809_stage3_step300.svg
[rank3]:2026-01-01 08:09:00,363 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0809_stage7_step300.svg
[rank0]:2026-01-01 08:09:00,384 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank0_stage4.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 197120 (9.09%), Ratio(%) per element: [9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09]
[rank2]:2026-01-01 08:09:00,382 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 197120 (9.09%), Ratio(%) per element: [9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09]
[rank1]:2026-01-01 08:09:00,389 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 197120 (9.09%), Ratio(%) per element: [9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09]
[rank3]:2026-01-01 08:09:00,510 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank3_stage3.svg
[rank3]:	> Counts Sum: 113120, Total Sum: 197120 (57.39%), Ratio(%) per element: [59.09, 56.81, 55.68, 58.52, 57.95, 57.38, 57.95, 60.22, 57.38, 55.68, 55.11, 56.81, 59.65, 59.09, 53.97, 58.52, 56.81, 54.54, 59.65, 57.95, 60.22, 56.25, 57.95, 57.95, 55.68, 55.68, 58.52, 55.68]
[rank3]:2026-01-01 08:09:00,598 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0809_rank3_stage7.svg
[rank3]:	> Counts Sum: 69160, Total Sum: 98560 (70.17%), Ratio(%) per element: [68.75, 68.75, 68.18, 71.02, 73.29, 73.29, 69.31, 73.29, 67.61, 72.72, 69.31, 71.59, 68.75, 66.47]
[rank1]:2026-01-01 08:09:00,682 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage1.svg
[rank0]:2026-01-01 08:09:00,704 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage0.svg
[rank2]:2026-01-01 08:09:00,683 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage2.svg
[rank3]:2026-01-01 08:09:00,885 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage3.svg
[rank2]:2026-01-01 08:09:00,978 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage6.svg
[rank1]:2026-01-01 08:09:00,972 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage5.svg
[rank0]:2026-01-01 08:09:00,991 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage4.svg
[rank3]:2026-01-01 08:09:01,171 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0809_stage7.svg
[rank0]:2026-01-01 08:12:48,493 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2026-01-01 08:12:53,077 - Avg. fwd time: 18.4318 / Avg. bwd time: 26.8534 / Avg. batch time: 998.7591 (ms) / GPU bubble ratio: 27.45%
[rank1]:2026-01-01 08:12:53,160 - Avg. fwd time: 17.1327 / Avg. bwd time: 19.6541 / Avg. batch time: 1121.9051 (ms) / GPU bubble ratio: 47.54%
[rank1]:2026-01-01 08:12:53,175 -  step: 350  loss: -4.0000  grad_norm:  6.4602  memory: 20.05GiB(42.20%)  tps: 7,027  tflops: 54.94  mfu: 17.61%
[rank2]:2026-01-01 08:12:53,126 - Avg. fwd time: 13.6540 / Avg. bwd time: 16.3888 / Avg. batch time: 1066.7921 (ms) / GPU bubble ratio: 54.94%
[rank2]:2026-01-01 08:12:53,175 -  step: 350  loss: -4.0000  grad_norm:  6.4602  memory: 11.88GiB(25.00%)  tps: 7,027  tflops: 54.94  mfu: 17.61%
[rank3]:2026-01-01 08:12:53,177 -  step: 350  loss: 11.1892  grad_norm:  6.4602  memory: 25.95GiB(54.61%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank0]:2026-01-01 08:12:53,171 - Avg. fwd time: 14.0273 / Avg. bwd time: 14.3509 / Avg. batch time: 1148.6522 (ms) / GPU bubble ratio: 60.47%
[rank0]:2026-01-01 08:12:53,176 -  step: 350  loss: -4.0000  grad_norm:  6.4602  memory: 17.59GiB(37.03%)  tps: 7,027  tflops: 54.94  mfu: 17.61%
[rank0]:2026-01-01 08:16:40,616 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 08:16:45,266 - Avg. fwd time: 18.4361 / Avg. bwd time: 26.8438 / Avg. batch time: 998.7204 (ms) / GPU bubble ratio: 27.46%
[rank2]:2026-01-01 08:16:45,316 - Avg. fwd time: 13.6551 / Avg. bwd time: 16.3920 / Avg. batch time: 1066.6130 (ms) / GPU bubble ratio: 54.93%
[rank2]:2026-01-01 08:16:45,367 -  step: 400  loss: -4.0000  grad_norm: 33.4777  memory: 11.88GiB(25.00%)  tps: 7,056  tflops: 55.16  mfu: 17.68%
[rank0]:2026-01-01 08:16:45,363 - Avg. fwd time: 14.0282 / Avg. bwd time: 14.3526 / Avg. batch time: 1147.5927 (ms) / GPU bubble ratio: 60.43%
[rank0]:2026-01-01 08:16:45,368 -  step: 400  loss: -4.0000  grad_norm: 33.4777  memory: 17.59GiB(37.03%)  tps: 7,056  tflops: 55.16  mfu: 17.68%
[rank1]:2026-01-01 08:16:45,351 - Avg. fwd time: 17.1364 / Avg. bwd time: 19.6501 / Avg. batch time: 1121.6291 (ms) / GPU bubble ratio: 47.52%
[rank1]:2026-01-01 08:16:45,367 -  step: 400  loss: -4.0000  grad_norm: 33.4777  memory: 20.05GiB(42.20%)  tps: 7,056  tflops: 55.16  mfu: 17.68%
[rank3]:2026-01-01 08:16:45,368 -  step: 400  loss: 10.2841  grad_norm: 33.4777  memory: 25.95GiB(54.61%)  tps: 7,056  tflops: 55.16  mfu: 17.68%
[rank2]:2026-01-01 08:16:45,422 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0816_stage2_step400.svg
[rank2]:2026-01-01 08:16:45,468 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0816_stage6_step400.svg
[rank0]:2026-01-01 08:16:45,422 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0816_stage0_step400.svg
[rank0]:2026-01-01 08:16:45,467 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0816_stage4_step400.svg
[rank1]:2026-01-01 08:16:45,422 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0816_stage1_step400.svg
[rank1]:2026-01-01 08:16:45,467 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0816_stage5_step400.svg
[rank3]:2026-01-01 08:16:45,609 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0816_step400_rank3.svg
[rank3]:			> Batch Time: 1140.00 ms, GPU Bubble Ratio: 60.13%, 48.33%, 57.74%, 36.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-12-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-202ms   | [S4,MB3,F]  245-14-260ms   | [S0,MB4,F]  260-14-274ms   | [S0,MB5,F]  274-14-289ms   | [S0,MB6,F]  289-13-302ms   | [S4,MB0,B]  434-16-450ms   | [S0,MB7,F]  450-12-462ms   | [S4,MB1,B]  534-16-550ms   | [S4,MB4,F]  579-14-594ms   | [S4,MB2,B]  594-17-611ms   | [S4,MB5,F]  614-14-629ms   | [S4,MB3,B]  629-17-646ms   | [S4,MB6,F]  650-14-664ms   | [S0,MB0,B]  664-16-681ms   | [S4,MB7,F]  685-13-698ms   | [S0,MB1,B]  699-16-716ms   | [S0,MB2,B]  738-13-752ms   | [S0,MB3,B]  779-13-793ms   | [S4,MB4,B]  808-14-822ms   | [S4,MB5,B]  881-14-895ms   | [S4,MB6,B]  951-14-966ms   | [S4,MB7,B]  1017-14-1032ms | [S0,MB4,B]  1046-13-1059ms | [S0,MB5,B]  1083-13-1096ms | [S0,MB6,B]  1112-13-1125ms | [S0,MB7,B]  1140-0-1140ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-91ms     | [S1,MB2,F]  129-19-149ms   | [S1,MB3,F]  187-19-207ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  265-12-278ms   | [S5,MB2,F]  285-12-298ms   | [S5,MB3,F]  353-12-366ms   | [S1,MB4,F]  386-19-406ms   | [S5,MB0,B]  406-18-424ms   | [S1,MB5,F]  425-23-449ms   | [S5,MB1,B]  449-15-465ms   | [S1,MB6,F]  465-20-485ms   | [S5,MB2,B]  533-16-549ms   | [S1,MB7,F]  549-21-570ms   | [S5,MB3,B]  589-17-606ms   | [S5,MB4,F]  606-14-620ms   | [S1,MB0,B]  624-25-649ms   | [S5,MB5,F]  649-15-665ms   | [S1,MB1,B]  665-24-690ms   | [S5,MB6,F]  690-16-707ms   | [S1,MB2,B]  707-24-731ms   | [S5,MB7,F]  731-15-746ms   | [S1,MB3,B]  746-24-771ms   | [S5,MB4,B]  785-15-801ms   | [S5,MB5,B]  852-15-867ms   | [S5,MB6,B]  923-15-938ms   | [S5,MB7,B]  995-15-1010ms  | [S1,MB4,B]  1017-21-1038ms | [S1,MB5,B]  1055-21-1077ms | [S1,MB6,B]  1083-21-1105ms | [S1,MB7,B]  1111-21-1133ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  91-12-103ms    | [S2,MB2,F]  149-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  278-12-291ms   | [S6,MB2,F]  346-12-359ms   | [S6,MB0,B]  359-16-376ms   | [S6,MB3,F]  376-14-391ms   | [S6,MB1,B]  412-19-432ms   | [S2,MB4,F]  432-14-447ms   | [S6,MB2,B]  483-16-500ms   | [S2,MB5,F]  500-13-513ms   | [S6,MB3,B]  554-17-572ms   | [S2,MB6,F]  571-14-586ms   | [S2,MB0,B]  591-17-608ms   | [S2,MB7,F]  608-14-623ms   | [S2,MB1,B]  627-16-644ms   | [S6,MB4,F]  644-14-659ms   | [S2,MB2,B]  663-17-680ms   | [S6,MB5,F]  680-13-694ms   | [S2,MB3,B]  702-16-719ms   | [S6,MB6,F]  718-13-732ms   | [S6,MB4,B]  760-18-779ms   | [S6,MB7,F]  778-14-793ms   | [S6,MB5,B]  830-15-846ms   | [S6,MB6,B]  901-15-916ms   | [S6,MB7,B]  973-15-989ms   | [S2,MB4,B]  995-14-1009ms  | [S2,MB5,B]  1033-15-1048ms | [S2,MB6,B]  1054-15-1070ms | [S2,MB7,B]  1082-15-1098ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-290ms   | [S7,MB0,B]  302-35-337ms   | [S7,MB1,F]  337-21-358ms   | [S7,MB1,B]  370-35-406ms   | [S7,MB2,F]  406-22-429ms   | [S7,MB2,B]  441-35-477ms   | [S7,MB3,F]  476-22-499ms   | [S7,MB3,B]  512-36-548ms   | [S3,MB4,F]  548-16-565ms   | [S3,MB0,B]  565-17-582ms   | [S3,MB5,F]  582-17-600ms   | [S3,MB1,B]  600-17-617ms   | [S3,MB6,F]  617-16-634ms   | [S3,MB2,B]  634-17-651ms   | [S3,MB7,F]  651-16-668ms   | [S3,MB3,B]  668-16-685ms   | [S7,MB4,F]  684-21-706ms   | [S7,MB4,B]  718-35-753ms   | [S7,MB5,F]  753-22-776ms   | [S7,MB5,B]  787-35-823ms   | [S7,MB6,F]  823-22-846ms   | [S7,MB6,B]  858-36-894ms   | [S7,MB7,F]  894-22-917ms   | [S7,MB7,B]  929-36-966ms   | [S3,MB4,B]  966-17-984ms   | [S3,MB5,B]  984-18-1003ms  | [S3,MB6,B]  1003-17-1021ms | [S3,MB7,B]  1025-18-1043ms
[rank3]:2026-01-01 08:16:45,656 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0816_stage3_step400.svg
[rank2]:2026-01-01 08:16:45,599 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank2_stage2.svg
[rank2]:	> Counts Sum: 48160, Total Sum: 286720 (16.80%), Ratio(%) per element: [16.79, 17.57, 17.18, 16.79, 16.01, 17.57, 17.18, 17.18, 16.4, 16.4, 16.4, 16.79, 16.79, 16.01, 17.57, 17.57, 16.79, 17.57, 16.79, 16.79, 16.01, 16.4, 16.4, 17.57, 16.4, 16.79, 15.62, 16.79]
[rank0]:2026-01-01 08:16:45,595 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank0_stage0.svg
[rank0]:	> Counts Sum: 48160, Total Sum: 286720 (16.80%), Ratio(%) per element: [16.79, 16.4, 17.18, 17.57, 16.01, 16.4, 16.79, 16.79, 17.18, 16.4, 16.4, 16.01, 17.57, 17.18, 16.4, 16.01, 17.18, 16.4, 17.57, 16.79, 17.57, 16.4, 16.01, 17.18, 16.4, 16.79, 17.18, 17.57]
[rank1]:2026-01-01 08:16:45,608 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank1_stage1.svg
[rank1]:	> Counts Sum: 208320, Total Sum: 430080 (48.44%), Ratio(%) per element: [48.43, 47.65, 49.21, 48.43, 48.82, 48.82, 49.6, 50.0, 48.43, 49.21, 48.43, 46.87, 46.09, 48.04, 46.87, 48.43, 49.6, 48.82, 48.04, 48.04, 48.43, 48.82, 48.82, 48.43, 48.04, 50.0, 47.26, 48.43, 48.04, 48.82, 50.0, 47.65, 47.65, 47.65, 49.6, 47.65, 48.43, 48.82, 47.65, 49.21, 49.21, 47.65]
[rank3]:2026-01-01 08:16:45,702 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0816_stage7_step400.svg
[rank2]:2026-01-01 08:16:45,733 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 286720 (6.25%), Ratio(%) per element: [6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25]
[rank0]:2026-01-01 08:16:45,727 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank0_stage4.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 286720 (6.25%), Ratio(%) per element: [6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25]
[rank1]:2026-01-01 08:16:45,740 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 286720 (6.25%), Ratio(%) per element: [6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25]
[rank3]:2026-01-01 08:16:45,829 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank3_stage3.svg
[rank3]:	> Counts Sum: 169120, Total Sum: 286720 (58.98%), Ratio(%) per element: [60.15, 58.59, 57.81, 59.76, 59.37, 58.98, 59.37, 60.93, 58.98, 57.81, 57.42, 58.59, 60.54, 60.15, 56.64, 59.76, 58.59, 57.03, 60.54, 59.37, 60.93, 58.2, 59.37, 59.37, 57.81, 57.81, 59.76, 57.81]
[rank3]:2026-01-01 08:16:45,917 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0816_rank3_stage7.svg
[rank3]:	> Counts Sum: 105160, Total Sum: 143360 (73.35%), Ratio(%) per element: [72.26, 73.04, 71.48, 73.82, 75.0, 75.39, 72.26, 75.0, 71.48, 75.78, 73.43, 76.17, 72.26, 69.53]
[rank2]:2026-01-01 08:16:46,156 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage2.svg
[rank0]:2026-01-01 08:16:46,147 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage0.svg
[rank1]:2026-01-01 08:16:46,156 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage1.svg
[rank3]:2026-01-01 08:16:46,325 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage3.svg
[rank2]:2026-01-01 08:16:46,566 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage6.svg
[rank0]:2026-01-01 08:16:46,555 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage4.svg
[rank1]:2026-01-01 08:16:46,556 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage5.svg
[rank3]:2026-01-01 08:16:46,717 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0816_stage7.svg
[rank3]:2026-01-01 08:17:13,038 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 08:17:13,184 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 08:17:13,158 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 08:17:13,184 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 08:20:33,687 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2026-01-01 08:20:38,260 - Avg. fwd time: 13.6547 / Avg. bwd time: 16.3935 / Avg. batch time: 1066.3860 (ms) / GPU bubble ratio: 54.92%
[rank3]:2026-01-01 08:20:38,211 - Avg. fwd time: 18.4348 / Avg. bwd time: 26.8317 / Avg. batch time: 998.5427 (ms) / GPU bubble ratio: 27.47%
[rank1]:2026-01-01 08:20:38,294 - Avg. fwd time: 17.1377 / Avg. bwd time: 19.6451 / Avg. batch time: 1121.3266 (ms) / GPU bubble ratio: 47.52%
[rank1]:2026-01-01 08:20:38,311 -  step: 450  loss: -4.0000  grad_norm:  6.1652  memory: 20.05GiB(42.20%)  tps: 7,033  tflops: 54.98  mfu: 17.62%
[rank2]:2026-01-01 08:20:38,311 -  step: 450  loss: -4.0000  grad_norm:  6.1652  memory: 11.88GiB(25.00%)  tps: 7,033  tflops: 54.98  mfu: 17.62%
[rank0]:2026-01-01 08:20:38,307 - Avg. fwd time: 14.0276 / Avg. bwd time: 14.3533 / Avg. batch time: 1146.6766 (ms) / GPU bubble ratio: 60.40%
[rank0]:2026-01-01 08:20:38,311 -  step: 450  loss: -4.0000  grad_norm:  6.1652  memory: 17.59GiB(37.03%)  tps: 7,033  tflops: 54.98  mfu: 17.62%
[rank3]:2026-01-01 08:20:38,312 -  step: 450  loss: 12.7481  grad_norm:  6.1652  memory: 25.95GiB(54.61%)  tps: 7,034  tflops: 54.98  mfu: 17.62%
[rank0]:2026-01-01 08:24:25,476 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 08:24:30,048 - Avg. fwd time: 13.6541 / Avg. bwd time: 16.3939 / Avg. batch time: 1066.1387 (ms) / GPU bubble ratio: 54.91%
[rank3]:2026-01-01 08:24:29,997 - Avg. fwd time: 18.4337 / Avg. bwd time: 26.8218 / Avg. batch time: 998.3886 (ms) / GPU bubble ratio: 27.47%
[rank1]:2026-01-01 08:24:30,083 - Avg. fwd time: 17.1384 / Avg. bwd time: 19.6415 / Avg. batch time: 1121.0161 (ms) / GPU bubble ratio: 47.50%
[rank1]:2026-01-01 08:24:30,101 -  step: 500  loss: -4.0000  grad_norm:  6.7840  memory: 20.05GiB(42.20%)  tps: 7,068  tflops: 55.26  mfu: 17.71%
[rank2]:2026-01-01 08:24:30,101 -  step: 500  loss: -4.0000  grad_norm:  6.7840  memory: 11.88GiB(25.00%)  tps: 7,068  tflops: 55.26  mfu: 17.71%
[rank2]:2026-01-01 08:24:30,153 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0824_stage2_step500.svg
[rank0]:2026-01-01 08:24:30,097 - Avg. fwd time: 14.0272 / Avg. bwd time: 14.3535 / Avg. batch time: 1145.8735 (ms) / GPU bubble ratio: 60.37%
[rank0]:2026-01-01 08:24:30,101 -  step: 500  loss: -4.0000  grad_norm:  6.7840  memory: 17.59GiB(37.03%)  tps: 7,068  tflops: 55.26  mfu: 17.71%
[rank0]:2026-01-01 08:24:30,153 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0824_stage0_step500.svg
[rank3]:2026-01-01 08:24:30,102 -  step: 500  loss: 12.9581  grad_norm:  6.7840  memory: 25.95GiB(54.61%)  tps: 7,069  tflops: 55.26  mfu: 17.71%
[rank1]:2026-01-01 08:24:30,153 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0824_stage1_step500.svg
[rank1]:2026-01-01 08:24:30,194 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0824_stage5_step500.svg
[rank2]:2026-01-01 08:24:30,195 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0824_stage6_step500.svg
[rank0]:2026-01-01 08:24:30,195 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0824_stage4_step500.svg
[rank2]:2026-01-01 08:24:30,322 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank2_stage2.svg
[rank2]:	> Counts Sum: 59360, Total Sum: 376320 (15.77%), Ratio(%) per element: [15.77, 16.36, 16.07, 15.77, 15.17, 16.36, 16.07, 16.07, 15.47, 15.47, 15.47, 15.77, 15.77, 15.17, 16.36, 16.36, 15.77, 16.36, 15.77, 15.77, 15.17, 15.47, 15.47, 16.36, 15.47, 15.77, 14.88, 15.77]
[rank0]:2026-01-01 08:24:30,325 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank0_stage0.svg
[rank0]:	> Counts Sum: 59360, Total Sum: 376320 (15.77%), Ratio(%) per element: [15.77, 15.47, 16.07, 16.36, 15.17, 15.47, 15.77, 15.77, 16.07, 15.47, 15.47, 15.17, 16.36, 16.07, 15.47, 15.17, 16.07, 15.47, 16.36, 15.77, 16.36, 15.47, 15.17, 16.07, 15.47, 15.77, 16.07, 16.36]
[rank3]:2026-01-01 08:24:30,356 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0824_step500_rank3.svg
[rank3]:			> Batch Time: 1134.00 ms, GPU Bubble Ratio: 60.02%, 48.24%, 57.64%, 36.59%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  186-14-201ms   | [S4,MB3,F]  244-14-259ms   | [S0,MB4,F]  259-14-273ms   | [S0,MB5,F]  273-14-287ms   | [S0,MB6,F]  288-13-301ms   | [S4,MB0,B]  431-16-447ms   | [S0,MB7,F]  448-12-460ms   | [S4,MB1,B]  530-16-546ms   | [S4,MB4,F]  576-14-590ms   | [S4,MB2,B]  591-17-608ms   | [S4,MB5,F]  611-14-625ms   | [S4,MB3,B]  625-17-643ms   | [S4,MB6,F]  646-14-660ms   | [S0,MB0,B]  661-16-677ms   | [S4,MB7,F]  681-13-694ms   | [S0,MB1,B]  695-16-711ms   | [S0,MB2,B]  734-13-747ms   | [S0,MB3,B]  775-13-789ms   | [S4,MB4,B]  804-14-819ms   | [S4,MB5,B]  876-14-891ms   | [S4,MB6,B]  946-14-961ms   | [S4,MB7,B]  1011-14-1026ms | [S0,MB4,B]  1039-13-1052ms | [S0,MB5,B]  1077-13-1090ms | [S0,MB6,B]  1105-13-1118ms | [S0,MB7,B]  1134-0-1134ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  186-19-206ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  284-12-296ms   | [S5,MB3,F]  351-12-364ms   | [S1,MB4,F]  385-19-404ms   | [S5,MB0,B]  404-17-422ms   | [S1,MB5,F]  424-23-447ms   | [S5,MB1,B]  447-15-463ms   | [S1,MB6,F]  463-20-483ms   | [S5,MB2,B]  530-16-546ms   | [S1,MB7,F]  546-21-567ms   | [S5,MB3,B]  585-17-602ms   | [S5,MB4,F]  602-14-616ms   | [S1,MB0,B]  621-25-646ms   | [S5,MB5,F]  646-15-662ms   | [S1,MB1,B]  662-24-686ms   | [S5,MB6,F]  686-16-702ms   | [S1,MB2,B]  703-24-727ms   | [S5,MB7,F]  727-15-742ms   | [S1,MB3,B]  742-24-767ms   | [S5,MB4,B]  782-15-798ms   | [S5,MB5,B]  849-15-864ms   | [S5,MB6,B]  917-15-932ms   | [S5,MB7,B]  989-15-1004ms  | [S1,MB4,B]  1011-21-1032ms | [S1,MB5,B]  1048-21-1070ms | [S1,MB6,B]  1076-21-1098ms | [S1,MB7,B]  1105-21-1127ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  277-12-289ms   | [S6,MB2,F]  345-12-358ms   | [S6,MB0,B]  358-17-375ms   | [S6,MB3,F]  375-14-390ms   | [S6,MB1,B]  410-19-430ms   | [S2,MB4,F]  430-14-445ms   | [S6,MB2,B]  480-16-497ms   | [S2,MB5,F]  497-13-510ms   | [S6,MB3,B]  551-17-568ms   | [S2,MB6,F]  568-14-583ms   | [S2,MB0,B]  587-17-604ms   | [S2,MB7,F]  604-14-619ms   | [S2,MB1,B]  623-16-640ms   | [S6,MB4,F]  640-14-655ms   | [S2,MB2,B]  659-17-676ms   | [S6,MB5,F]  676-13-690ms   | [S2,MB3,B]  698-16-714ms   | [S6,MB6,F]  714-13-728ms   | [S6,MB4,B]  756-18-775ms   | [S6,MB7,F]  775-14-790ms   | [S6,MB5,B]  826-15-842ms   | [S6,MB6,B]  896-15-911ms   | [S6,MB7,B]  968-15-983ms   | [S2,MB4,B]  989-14-1004ms  | [S2,MB5,B]  1027-15-1042ms | [S2,MB6,B]  1048-15-1063ms | [S2,MB7,B]  1076-15-1091ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-231ms   | [S7,MB0,F]  270-18-288ms   | [S7,MB0,B]  300-34-335ms   | [S7,MB1,F]  335-21-356ms   | [S7,MB1,B]  368-35-404ms   | [S7,MB2,F]  404-22-426ms   | [S7,MB2,B]  438-35-474ms   | [S7,MB3,F]  474-22-496ms   | [S7,MB3,B]  508-36-544ms   | [S3,MB4,F]  545-17-562ms   | [S3,MB0,B]  562-17-579ms   | [S3,MB5,F]  579-17-596ms   | [S3,MB1,B]  596-17-613ms   | [S3,MB6,F]  614-16-630ms   | [S3,MB2,B]  630-17-647ms   | [S3,MB7,F]  647-16-663ms   | [S3,MB3,B]  663-16-680ms   | [S7,MB4,F]  680-21-702ms   | [S7,MB4,B]  714-35-749ms   | [S7,MB5,F]  750-21-771ms   | [S7,MB5,B]  784-35-819ms   | [S7,MB6,F]  820-23-843ms   | [S7,MB6,B]  854-35-890ms   | [S7,MB7,F]  889-22-912ms   | [S7,MB7,B]  924-36-961ms   | [S3,MB4,B]  961-17-978ms   | [S3,MB5,B]  978-18-996ms   | [S3,MB6,B]  996-17-1014ms  | [S3,MB7,B]  1020-17-1038ms
[rank1]:2026-01-01 08:24:30,332 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank1_stage1.svg
[rank1]:	> Counts Sum: 275520, Total Sum: 564480 (48.81%), Ratio(%) per element: [48.8, 48.21, 49.4, 48.8, 49.1, 49.1, 49.7, 50.0, 48.8, 49.4, 48.8, 47.61, 47.02, 48.51, 47.61, 48.8, 49.7, 49.1, 48.51, 48.51, 48.8, 49.1, 49.1, 48.8, 48.51, 50.0, 47.91, 48.8, 48.51, 49.1, 50.0, 48.21, 48.21, 48.21, 49.7, 48.21, 48.8, 49.1, 48.21, 49.4, 49.4, 48.21]
[rank2]:2026-01-01 08:24:30,452 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 376320 (4.76%), Ratio(%) per element: [4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76]
[rank0]:2026-01-01 08:24:30,457 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank0_stage4.svg
[rank3]:2026-01-01 08:24:30,402 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0824_stage3_step500.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 376320 (4.76%), Ratio(%) per element: [4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76]
[rank3]:2026-01-01 08:24:30,442 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0824_stage7_step500.svg
[rank1]:2026-01-01 08:24:30,460 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 376320 (4.76%), Ratio(%) per element: [4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76]
[rank3]:2026-01-01 08:24:30,572 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank3_stage3.svg
[rank3]:	> Counts Sum: 225120, Total Sum: 376320 (59.82%), Ratio(%) per element: [60.71, 59.52, 58.92, 60.41, 60.11, 59.82, 60.11, 61.3, 59.82, 58.92, 58.63, 59.52, 61.01, 60.71, 58.03, 60.41, 59.52, 58.33, 61.01, 60.11, 61.3, 59.22, 60.11, 60.11, 58.92, 58.92, 60.41, 58.92]
[rank3]:2026-01-01 08:24:30,661 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0824_rank3_stage7.svg
[rank3]:	> Counts Sum: 141160, Total Sum: 188160 (75.02%), Ratio(%) per element: [74.7, 75.89, 73.51, 75.29, 76.48, 76.48, 74.1, 76.19, 72.91, 75.89, 75.59, 77.38, 74.1, 71.72]
[rank1]:2026-01-01 08:24:31,005 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage1.svg
[rank2]:2026-01-01 08:24:31,012 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage2.svg
[rank0]:2026-01-01 08:24:31,011 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage0.svg
[rank3]:2026-01-01 08:24:31,200 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage3.svg
[rank2]:2026-01-01 08:24:31,551 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage6.svg
[rank0]:2026-01-01 08:24:31,561 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage4.svg
[rank1]:2026-01-01 08:24:31,538 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage5.svg
[rank3]:2026-01-01 08:24:31,733 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0824_stage7.svg
[rank0]:2026-01-01 08:28:18,676 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2026-01-01 08:28:23,255 - Avg. fwd time: 18.4316 / Avg. bwd time: 26.8132 / Avg. batch time: 998.2319 (ms) / GPU bubble ratio: 27.48%
[rank1]:2026-01-01 08:28:23,341 - Avg. fwd time: 17.1392 / Avg. bwd time: 19.6382 / Avg. batch time: 1120.7894 (ms) / GPU bubble ratio: 47.50%
[rank2]:2026-01-01 08:28:23,305 - Avg. fwd time: 13.6538 / Avg. bwd time: 16.3946 / Avg. batch time: 1065.9622 (ms) / GPU bubble ratio: 54.90%
[rank2]:2026-01-01 08:28:23,359 -  step: 550  loss: -4.0000  grad_norm:  5.9357  memory: 11.88GiB(25.00%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank0]:2026-01-01 08:28:23,355 - Avg. fwd time: 14.0271 / Avg. bwd time: 14.3541 / Avg. batch time: 1145.2444 (ms) / GPU bubble ratio: 60.35%
[rank0]:2026-01-01 08:28:23,359 -  step: 550  loss: -4.0000  grad_norm:  5.9357  memory: 17.59GiB(37.03%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank3]:2026-01-01 08:28:23,360 -  step: 550  loss: 11.0990  grad_norm:  5.9357  memory: 25.95GiB(54.61%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank1]:2026-01-01 08:28:23,359 -  step: 550  loss: -4.0000  grad_norm:  5.9357  memory: 20.05GiB(42.20%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank0]:2026-01-01 08:32:10,714 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 08:32:15,381 - Avg. fwd time: 18.4328 / Avg. bwd time: 26.8082 / Avg. batch time: 998.1957 (ms) / GPU bubble ratio: 27.48%
[rank1]:2026-01-01 08:32:15,470 - Avg. fwd time: 17.1401 / Avg. bwd time: 19.6359 / Avg. batch time: 1120.6494 (ms) / GPU bubble ratio: 47.49%
[rank2]:2026-01-01 08:32:15,432 - Avg. fwd time: 13.6539 / Avg. bwd time: 16.3955 / Avg. batch time: 1065.8610 (ms) / GPU bubble ratio: 54.89%
[rank2]:2026-01-01 08:32:15,488 -  step: 600  loss: -4.0000  grad_norm: 30.8796  memory: 11.88GiB(25.00%)  tps: 7,058  tflops: 55.18  mfu: 17.69%
[rank0]:2026-01-01 08:32:15,484 - Avg. fwd time: 14.0277 / Avg. bwd time: 14.3547 / Avg. batch time: 1144.7739 (ms) / GPU bubble ratio: 60.33%
[rank0]:2026-01-01 08:32:15,489 -  step: 600  loss: -4.0000  grad_norm: 30.8796  memory: 17.59GiB(37.03%)  tps: 7,058  tflops: 55.18  mfu: 17.69%
[rank3]:2026-01-01 08:32:15,489 -  step: 600  loss: 10.0152  grad_norm: 30.8796  memory: 25.95GiB(54.61%)  tps: 7,058  tflops: 55.18  mfu: 17.69%
[rank1]:2026-01-01 08:32:15,488 -  step: 600  loss: -4.0000  grad_norm: 30.8796  memory: 20.05GiB(42.20%)  tps: 7,058  tflops: 55.18  mfu: 17.69%
[rank1]:2026-01-01 08:32:15,561 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0832_stage1_step600.svg
[rank2]:2026-01-01 08:32:15,541 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0832_stage2_step600.svg
[rank2]:2026-01-01 08:32:15,585 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0832_stage6_step600.svg
[rank0]:2026-01-01 08:32:15,541 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0832_stage0_step600.svg
[rank0]:2026-01-01 08:32:15,583 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0832_stage4_step600.svg
[rank1]:2026-01-01 08:32:15,610 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0832_stage5_step600.svg
[rank3]:2026-01-01 08:32:15,731 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0832_step600_rank3.svg
[rank3]:			> Batch Time: 1139.00 ms, GPU Bubble Ratio: 60.10%, 48.37%, 57.70%, 36.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-260ms   | [S0,MB4,F]  260-14-274ms   | [S0,MB5,F]  274-14-288ms   | [S0,MB6,F]  288-13-301ms   | [S4,MB0,B]  434-16-450ms   | [S0,MB7,F]  450-12-463ms   | [S4,MB1,B]  534-16-550ms   | [S4,MB4,F]  579-14-594ms   | [S4,MB2,B]  594-17-611ms   | [S4,MB5,F]  614-14-629ms   | [S4,MB3,B]  629-17-646ms   | [S4,MB6,F]  649-14-664ms   | [S0,MB0,B]  664-16-681ms   | [S4,MB7,F]  685-13-698ms   | [S0,MB1,B]  699-16-716ms   | [S0,MB2,B]  738-13-752ms   | [S0,MB3,B]  779-13-793ms   | [S4,MB4,B]  807-14-821ms   | [S4,MB5,B]  881-14-895ms   | [S4,MB6,B]  952-14-966ms   | [S4,MB7,B]  1017-14-1032ms | [S0,MB4,B]  1045-13-1058ms | [S0,MB5,B]  1083-13-1096ms | [S0,MB6,B]  1111-13-1124ms | [S0,MB7,B]  1139-0-1139ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-91ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  265-12-277ms   | [S5,MB2,F]  285-12-297ms   | [S5,MB3,F]  352-12-365ms   | [S1,MB4,F]  386-19-405ms   | [S5,MB0,B]  405-17-423ms   | [S1,MB5,F]  426-23-450ms   | [S5,MB1,B]  450-15-465ms   | [S1,MB6,F]  465-20-486ms   | [S5,MB2,B]  534-16-550ms   | [S1,MB7,F]  550-21-571ms   | [S5,MB3,B]  589-17-606ms   | [S5,MB4,F]  606-14-620ms   | [S1,MB0,B]  624-25-649ms   | [S5,MB5,F]  650-15-665ms   | [S1,MB1,B]  665-24-690ms   | [S5,MB6,F]  690-16-706ms   | [S1,MB2,B]  707-24-731ms   | [S5,MB7,F]  731-15-746ms   | [S1,MB3,B]  746-24-771ms   | [S5,MB4,B]  785-15-800ms   | [S5,MB5,B]  853-15-868ms   | [S5,MB6,B]  923-15-938ms   | [S5,MB7,B]  995-15-1010ms  | [S1,MB4,B]  1017-21-1038ms | [S1,MB5,B]  1054-21-1076ms | [S1,MB6,B]  1082-21-1104ms | [S1,MB7,B]  1110-21-1132ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  278-12-291ms   | [S6,MB2,F]  346-12-359ms   | [S6,MB0,B]  359-17-376ms   | [S6,MB3,F]  376-14-391ms   | [S6,MB1,B]  413-19-432ms   | [S2,MB4,F]  433-14-447ms   | [S6,MB2,B]  483-16-500ms   | [S2,MB5,F]  499-13-513ms   | [S6,MB3,B]  555-17-572ms   | [S2,MB6,F]  572-14-586ms   | [S2,MB0,B]  591-17-608ms   | [S2,MB7,F]  608-14-623ms   | [S2,MB1,B]  627-16-644ms   | [S6,MB4,F]  644-14-659ms   | [S2,MB2,B]  663-17-680ms   | [S6,MB5,F]  680-13-694ms   | [S2,MB3,B]  702-16-719ms   | [S6,MB6,F]  718-13-732ms   | [S6,MB4,B]  759-18-778ms   | [S6,MB7,F]  778-14-793ms   | [S6,MB5,B]  831-15-847ms   | [S6,MB6,B]  901-15-917ms   | [S6,MB7,B]  974-15-989ms   | [S2,MB4,B]  995-14-1010ms  | [S2,MB5,B]  1033-15-1048ms | [S2,MB6,B]  1054-15-1070ms | [S2,MB7,B]  1082-15-1098ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-290ms   | [S7,MB0,B]  301-35-336ms   | [S7,MB1,F]  336-21-358ms   | [S7,MB1,B]  370-35-406ms   | [S7,MB2,F]  406-22-428ms   | [S7,MB2,B]  440-35-476ms   | [S7,MB3,F]  476-23-499ms   | [S7,MB3,B]  512-36-548ms   | [S3,MB4,F]  548-16-565ms   | [S3,MB0,B]  565-17-582ms   | [S3,MB5,F]  582-17-600ms   | [S3,MB1,B]  599-17-616ms   | [S3,MB6,F]  616-16-633ms   | [S3,MB2,B]  633-17-650ms   | [S3,MB7,F]  650-16-667ms   | [S3,MB3,B]  666-16-683ms   | [S7,MB4,F]  683-21-705ms   | [S7,MB4,B]  717-35-753ms   | [S7,MB5,F]  753-22-775ms   | [S7,MB5,B]  788-36-824ms   | [S7,MB6,F]  824-22-847ms   | [S7,MB6,B]  859-36-895ms   | [S7,MB7,F]  895-22-918ms   | [S7,MB7,B]  930-36-967ms   | [S3,MB4,B]  966-17-984ms   | [S3,MB5,B]  984-18-1003ms  | [S3,MB6,B]  1003-17-1020ms | [S3,MB7,B]  1025-18-1043ms
[rank2]:2026-01-01 08:32:15,718 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank2_stage2.svg
[rank2]:	> Counts Sum: 70560, Total Sum: 465920 (15.14%), Ratio(%) per element: [15.14, 15.62, 15.38, 15.14, 14.66, 15.62, 15.38, 15.38, 14.9, 14.9, 14.9, 15.14, 15.14, 14.66, 15.62, 15.62, 15.14, 15.62, 15.14, 15.14, 14.66, 14.9, 14.9, 15.62, 14.9, 15.14, 14.42, 15.14]
[rank0]:2026-01-01 08:32:15,708 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank0_stage0.svg
[rank0]:	> Counts Sum: 70560, Total Sum: 465920 (15.14%), Ratio(%) per element: [15.14, 14.9, 15.38, 15.62, 14.66, 14.9, 15.14, 15.14, 15.38, 14.9, 14.9, 14.66, 15.62, 15.38, 14.9, 14.66, 15.38, 14.9, 15.62, 15.14, 15.62, 14.9, 14.66, 15.38, 14.9, 15.14, 15.38, 15.62]
[rank3]:2026-01-01 08:32:15,776 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0832_stage3_step600.svg
[rank3]:2026-01-01 08:32:15,817 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0832_stage7_step600.svg
[rank1]:2026-01-01 08:32:15,794 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank1_stage1.svg
[rank1]:	> Counts Sum: 342720, Total Sum: 698880 (49.04%), Ratio(%) per element: [49.03, 48.55, 49.51, 49.03, 49.27, 49.27, 49.75, 50.0, 49.03, 49.51, 49.03, 48.07, 47.59, 48.79, 48.07, 49.03, 49.75, 49.27, 48.79, 48.79, 49.03, 49.27, 49.27, 49.03, 48.79, 50.0, 48.31, 49.03, 48.79, 49.27, 50.0, 48.55, 48.55, 48.55, 49.75, 48.55, 49.03, 49.27, 48.55, 49.51, 49.51, 48.55]
[rank2]:2026-01-01 08:32:15,850 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 465920 (3.85%), Ratio(%) per element: [3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84]
[rank0]:2026-01-01 08:32:15,836 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank0_stage4.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 465920 (3.85%), Ratio(%) per element: [3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84]
[rank1]:2026-01-01 08:32:15,933 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 465920 (3.85%), Ratio(%) per element: [3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84]
[rank3]:2026-01-01 08:32:15,946 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank3_stage3.svg
[rank3]:	> Counts Sum: 281120, Total Sum: 465920 (60.34%), Ratio(%) per element: [61.05, 60.09, 59.61, 60.81, 60.57, 60.33, 60.57, 61.53, 60.33, 59.61, 59.37, 60.09, 61.29, 61.05, 58.89, 60.81, 60.09, 59.13, 61.29, 60.57, 61.53, 59.85, 60.57, 60.57, 59.61, 59.61, 60.81, 59.61]
[rank3]:2026-01-01 08:32:16,032 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0832_rank3_stage7.svg
[rank3]:	> Counts Sum: 177160, Total Sum: 232960 (76.05%), Ratio(%) per element: [75.72, 76.68, 75.72, 75.96, 77.16, 77.88, 74.75, 77.4, 74.03, 76.2, 76.44, 77.88, 75.72, 73.07]
[rank2]:2026-01-01 08:32:16,535 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage2.svg
[rank0]:2026-01-01 08:32:16,507 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage0.svg
[rank1]:2026-01-01 08:32:16,595 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage1.svg
[rank3]:2026-01-01 08:32:16,689 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage3.svg
[rank2]:2026-01-01 08:32:17,198 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage6.svg
[rank0]:2026-01-01 08:32:17,151 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage4.svg
[rank1]:2026-01-01 08:32:17,258 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage5.svg
[rank3]:2026-01-01 08:32:17,325 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0832_stage7.svg
[rank0]:2026-01-01 08:36:04,441 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2026-01-01 08:36:08,972 - Avg. fwd time: 18.4315 / Avg. bwd time: 26.8022 / Avg. batch time: 998.0912 (ms) / GPU bubble ratio: 27.49%
[rank1]:2026-01-01 08:36:09,060 - Avg. fwd time: 17.1406 / Avg. bwd time: 19.6339 / Avg. batch time: 1120.4692 (ms) / GPU bubble ratio: 47.49%
[rank1]:2026-01-01 08:36:09,078 -  step: 650  loss: -4.0000  grad_norm:  7.3138  memory: 20.05GiB(42.20%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank2]:2026-01-01 08:36:09,022 - Avg. fwd time: 13.6535 / Avg. bwd time: 16.3959 / Avg. batch time: 1065.7126 (ms) / GPU bubble ratio: 54.89%
[rank2]:2026-01-01 08:36:09,078 -  step: 650  loss: -4.0000  grad_norm:  7.3138  memory: 11.88GiB(25.00%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank0]:2026-01-01 08:36:09,075 - Avg. fwd time: 14.0277 / Avg. bwd time: 14.3546 / Avg. batch time: 1144.3452 (ms) / GPU bubble ratio: 60.32%
[rank0]:2026-01-01 08:36:09,079 -  step: 650  loss: -4.0000  grad_norm:  7.3138  memory: 17.59GiB(37.03%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank3]:2026-01-01 08:36:09,080 -  step: 650  loss: 12.3055  grad_norm:  7.3138  memory: 25.95GiB(54.61%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank0]:2026-01-01 08:39:56,191 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 08:40:00,696 - Avg. fwd time: 18.4294 / Avg. bwd time: 26.7961 / Avg. batch time: 997.9772 (ms) / GPU bubble ratio: 27.49%
[rank2]:2026-01-01 08:40:00,746 - Avg. fwd time: 13.6532 / Avg. bwd time: 16.3962 / Avg. batch time: 1065.5529 (ms) / GPU bubble ratio: 54.88%
[rank1]:2026-01-01 08:40:00,784 - Avg. fwd time: 17.1409 / Avg. bwd time: 19.6322 / Avg. batch time: 1120.2832 (ms) / GPU bubble ratio: 47.48%
[rank0]:2026-01-01 08:40:00,800 - Avg. fwd time: 14.0274 / Avg. bwd time: 14.3543 / Avg. batch time: 1143.9128 (ms) / GPU bubble ratio: 60.30%
[rank0]:2026-01-01 08:40:00,804 -  step: 700  loss: -4.0000  grad_norm:  6.7955  memory: 17.59GiB(37.03%)  tps: 7,070  tflops: 55.27  mfu: 17.72%
[rank3]:2026-01-01 08:40:00,805 -  step: 700  loss: 13.1112  grad_norm:  6.7955  memory: 25.95GiB(54.61%)  tps: 7,071  tflops: 55.27  mfu: 17.72%
[rank2]:2026-01-01 08:40:00,804 -  step: 700  loss: -4.0000  grad_norm:  6.7955  memory: 11.88GiB(25.00%)  tps: 7,070  tflops: 55.27  mfu: 17.72%
[rank2]:2026-01-01 08:40:00,859 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0840_stage2_step700.svg
[rank1]:2026-01-01 08:40:00,804 -  step: 700  loss: -4.0000  grad_norm:  6.7955  memory: 20.05GiB(42.20%)  tps: 7,070  tflops: 55.27  mfu: 17.72%
[rank1]:2026-01-01 08:40:00,860 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0840_stage1_step700.svg
[rank0]:2026-01-01 08:40:00,857 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0840_stage0_step700.svg
[rank0]:2026-01-01 08:40:00,901 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0840_stage4_step700.svg
[rank2]:2026-01-01 08:40:00,905 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0840_stage6_step700.svg
[rank1]:2026-01-01 08:40:00,905 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0840_stage5_step700.svg
[rank3]:2026-01-01 08:40:01,053 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0840_step700_rank3.svg
[rank3]:			> Batch Time: 1133.00 ms, GPU Bubble Ratio: 59.99%, 48.19%, 57.61%, 36.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-12-40ms     | [S0,MB3,F]  40-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S0,MB4,F]  259-14-273ms   | [S0,MB5,F]  274-14-288ms   | [S0,MB6,F]  288-13-301ms   | [S4,MB0,B]  432-16-448ms   | [S0,MB7,F]  448-12-461ms   | [S4,MB1,B]  532-16-548ms   | [S4,MB4,F]  577-14-591ms   | [S4,MB2,B]  591-17-608ms   | [S4,MB5,F]  612-14-626ms   | [S4,MB3,B]  626-17-644ms   | [S4,MB6,F]  647-14-661ms   | [S0,MB0,B]  661-16-678ms   | [S4,MB7,F]  682-13-695ms   | [S0,MB1,B]  696-16-712ms   | [S0,MB2,B]  735-13-748ms   | [S0,MB3,B]  776-13-789ms   | [S4,MB4,B]  804-14-818ms   | [S4,MB5,B]  876-14-890ms   | [S4,MB6,B]  945-14-960ms   | [S4,MB7,B]  1011-14-1025ms | [S0,MB4,B]  1039-13-1052ms | [S0,MB5,B]  1077-13-1090ms | [S0,MB6,B]  1105-13-1118ms | [S0,MB7,B]  1133-0-1133ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-257ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  284-12-297ms   | [S5,MB3,F]  352-12-364ms   | [S1,MB4,F]  385-19-404ms   | [S5,MB0,B]  404-17-422ms   | [S1,MB5,F]  424-23-447ms   | [S5,MB1,B]  448-15-463ms   | [S1,MB6,F]  463-20-483ms   | [S5,MB2,B]  531-16-547ms   | [S1,MB7,F]  547-21-568ms   | [S5,MB3,B]  586-17-603ms   | [S5,MB4,F]  603-14-617ms   | [S1,MB0,B]  622-25-647ms   | [S5,MB5,F]  646-15-662ms   | [S1,MB1,B]  662-24-686ms   | [S5,MB6,F]  687-16-703ms   | [S1,MB2,B]  703-24-727ms   | [S5,MB7,F]  728-15-743ms   | [S1,MB3,B]  743-24-767ms   | [S5,MB4,B]  782-15-797ms   | [S5,MB5,B]  847-15-862ms   | [S5,MB6,B]  917-15-932ms   | [S5,MB7,B]  989-15-1004ms  | [S1,MB4,B]  1011-21-1032ms | [S1,MB5,B]  1048-21-1070ms | [S1,MB6,B]  1076-21-1098ms | [S1,MB7,B]  1104-21-1126ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB2,F]  345-12-358ms   | [S6,MB0,B]  358-17-375ms   | [S6,MB3,F]  375-14-390ms   | [S6,MB1,B]  411-19-431ms   | [S2,MB4,F]  431-14-445ms   | [S6,MB2,B]  481-16-498ms   | [S2,MB5,F]  498-13-511ms   | [S6,MB3,B]  552-17-569ms   | [S2,MB6,F]  569-14-583ms   | [S2,MB0,B]  588-17-605ms   | [S2,MB7,F]  605-14-620ms   | [S2,MB1,B]  624-16-641ms   | [S6,MB4,F]  641-14-656ms   | [S2,MB2,B]  660-17-677ms   | [S6,MB5,F]  677-13-690ms   | [S2,MB3,B]  698-16-715ms   | [S6,MB6,F]  715-13-728ms   | [S6,MB4,B]  756-18-774ms   | [S6,MB7,F]  775-14-790ms   | [S6,MB5,B]  825-15-841ms   | [S6,MB6,B]  896-15-911ms   | [S6,MB7,B]  967-15-982ms   | [S2,MB4,B]  989-14-1003ms  | [S2,MB5,B]  1026-15-1041ms | [S2,MB6,B]  1048-15-1063ms | [S2,MB7,B]  1075-15-1090ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  270-18-289ms   | [S7,MB0,B]  301-34-335ms   | [S7,MB1,F]  335-21-357ms   | [S7,MB1,B]  369-35-404ms   | [S7,MB2,F]  404-22-427ms   | [S7,MB2,B]  438-35-474ms   | [S7,MB3,F]  474-22-497ms   | [S7,MB3,B]  509-36-545ms   | [S3,MB4,F]  545-16-562ms   | [S3,MB0,B]  562-17-579ms   | [S3,MB5,F]  580-17-597ms   | [S3,MB1,B]  597-17-614ms   | [S3,MB6,F]  614-16-630ms   | [S3,MB2,B]  630-17-647ms   | [S3,MB7,F]  648-16-664ms   | [S3,MB3,B]  664-16-680ms   | [S7,MB4,F]  680-21-702ms   | [S7,MB4,B]  714-35-750ms   | [S7,MB5,F]  749-22-771ms   | [S7,MB5,B]  782-35-818ms   | [S7,MB6,F]  818-22-841ms   | [S7,MB6,B]  853-35-889ms   | [S7,MB7,F]  889-23-912ms   | [S7,MB7,B]  923-36-960ms   | [S3,MB4,B]  960-17-978ms   | [S3,MB5,B]  977-18-996ms   | [S3,MB6,B]  996-17-1013ms  | [S3,MB7,B]  1019-17-1037ms
[rank2]:2026-01-01 08:40:01,033 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank2_stage2.svg
[rank2]:	> Counts Sum: 81760, Total Sum: 555520 (14.72%), Ratio(%) per element: [14.71, 15.12, 14.91, 14.71, 14.31, 15.12, 14.91, 14.91, 14.51, 14.51, 14.51, 14.71, 14.71, 14.31, 15.12, 15.12, 14.71, 15.12, 14.71, 14.71, 14.31, 14.51, 14.51, 15.12, 14.51, 14.71, 14.11, 14.71]
[rank1]:2026-01-01 08:40:01,045 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank1_stage1.svg
[rank1]:	> Counts Sum: 409920, Total Sum: 833280 (49.19%), Ratio(%) per element: [49.19, 48.79, 49.59, 49.19, 49.39, 49.39, 49.79, 50.0, 49.19, 49.59, 49.19, 48.38, 47.98, 48.99, 48.38, 49.19, 49.79, 49.39, 48.99, 48.99, 49.19, 49.39, 49.39, 49.19, 48.99, 50.0, 48.58, 49.19, 48.99, 49.39, 50.0, 48.79, 48.79, 48.79, 49.79, 48.79, 49.19, 49.39, 48.79, 49.59, 49.59, 48.79]
[rank0]:2026-01-01 08:40:01,031 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank0_stage0.svg
[rank0]:	> Counts Sum: 81760, Total Sum: 555520 (14.72%), Ratio(%) per element: [14.71, 14.51, 14.91, 15.12, 14.31, 14.51, 14.71, 14.71, 14.91, 14.51, 14.51, 14.31, 15.12, 14.91, 14.51, 14.31, 14.91, 14.51, 15.12, 14.71, 15.12, 14.51, 14.31, 14.91, 14.51, 14.71, 14.91, 15.12]
[rank3]:2026-01-01 08:40:01,098 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0840_stage3_step700.svg
[rank3]:2026-01-01 08:40:01,140 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0840_stage7_step700.svg
[rank2]:2026-01-01 08:40:01,158 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 555520 (3.23%), Ratio(%) per element: [3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22]
[rank1]:2026-01-01 08:40:01,171 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 555520 (3.23%), Ratio(%) per element: [3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22]
[rank0]:2026-01-01 08:40:01,156 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank0_stage4.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 555520 (3.23%), Ratio(%) per element: [3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22]
[rank3]:2026-01-01 08:40:01,268 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank3_stage3.svg
[rank3]:	> Counts Sum: 337120, Total Sum: 555520 (60.69%), Ratio(%) per element: [61.29, 60.48, 60.08, 61.08, 60.88, 60.68, 60.88, 61.69, 60.68, 60.08, 59.87, 60.48, 61.49, 61.29, 59.47, 61.08, 60.48, 59.67, 61.49, 60.88, 61.69, 60.28, 60.88, 60.88, 60.08, 60.08, 61.08, 60.08]
[rank3]:2026-01-01 08:40:01,355 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0840_rank3_stage7.svg
[rank3]:	> Counts Sum: 213160, Total Sum: 277760 (76.74%), Ratio(%) per element: [76.2, 76.81, 76.41, 77.01, 77.62, 78.42, 75.8, 78.02, 75.2, 76.61, 77.01, 78.22, 77.21, 73.79]
[rank2]:2026-01-01 08:40:01,960 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage2.svg
[rank1]:2026-01-01 08:40:01,957 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage1.svg
[rank0]:2026-01-01 08:40:01,955 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage0.svg
[rank3]:2026-01-01 08:40:02,128 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage3.svg
[rank2]:2026-01-01 08:40:02,750 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage6.svg
[rank1]:2026-01-01 08:40:02,740 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage5.svg
[rank0]:2026-01-01 08:40:02,729 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage4.svg
[rank3]:2026-01-01 08:40:02,882 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0840_stage7.svg
[rank0]:2026-01-01 08:43:49,772 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2026-01-01 08:43:54,353 - Avg. fwd time: 18.4261 / Avg. bwd time: 26.7896 / Avg. batch time: 997.8331 (ms) / GPU bubble ratio: 27.50%
[rank1]:2026-01-01 08:43:54,442 - Avg. fwd time: 17.1414 / Avg. bwd time: 19.6309 / Avg. batch time: 1120.1135 (ms) / GPU bubble ratio: 47.47%
[rank1]:2026-01-01 08:43:54,462 -  step: 750  loss: -4.0000  grad_norm:  5.0126  memory: 20.05GiB(42.20%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank3]:2026-01-01 08:43:54,464 -  step: 750  loss: 11.0736  grad_norm:  5.0126  memory: 25.95GiB(54.61%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank2]:2026-01-01 08:43:54,404 - Avg. fwd time: 13.6528 / Avg. bwd time: 16.3957 / Avg. batch time: 1065.4030 (ms) / GPU bubble ratio: 54.87%
[rank2]:2026-01-01 08:43:54,462 -  step: 750  loss: -4.0000  grad_norm:  5.0126  memory: 11.88GiB(25.00%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank0]:2026-01-01 08:43:54,459 - Avg. fwd time: 14.0271 / Avg. bwd time: 14.3545 / Avg. batch time: 1143.5314 (ms) / GPU bubble ratio: 60.29%
[rank0]:2026-01-01 08:43:54,463 -  step: 750  loss: -4.0000  grad_norm:  5.0126  memory: 17.59GiB(37.03%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank0]:2026-01-01 08:47:41,760 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 08:47:46,435 - Avg. fwd time: 18.4278 / Avg. bwd time: 26.7862 / Avg. batch time: 997.8232 (ms) / GPU bubble ratio: 27.50%
[rank2]:2026-01-01 08:47:46,484 - Avg. fwd time: 13.6527 / Avg. bwd time: 16.3965 / Avg. batch time: 1065.3555 (ms) / GPU bubble ratio: 54.87%
[rank0]:2026-01-01 08:47:46,540 - Avg. fwd time: 14.0273 / Avg. bwd time: 14.3541 / Avg. batch time: 1143.2814 (ms) / GPU bubble ratio: 60.28%
[rank0]:2026-01-01 08:47:46,544 -  step: 800  loss: -4.0000  grad_norm: 27.2399  memory: 17.59GiB(37.03%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank0]:2026-01-01 08:47:46,544 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2399  tps: 7,452  tflops: 58.25  mfu: 17.01%
[rank0]:2026-01-01 08:47:46,544 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 08:47:46,545 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 08:47:46,523 - Avg. fwd time: 17.1420 / Avg. bwd time: 19.6297 / Avg. batch time: 1120.0471 (ms) / GPU bubble ratio: 47.47%
[rank1]:2026-01-01 08:47:46,543 -  step: 800  loss: -4.0000  grad_norm: 27.2399  memory: 20.05GiB(42.20%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank1]:2026-01-01 08:47:46,543 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2399  tps: 7,457  tflops: 58.29  mfu: 17.14%
[rank1]:2026-01-01 08:47:46,543 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 08:47:46,544 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 08:47:46,545 -  step: 800  loss:  9.8078  grad_norm: 27.2399  memory: 25.95GiB(54.61%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank3]:2026-01-01 08:47:46,545 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm: 27.2399  tps: 7,456  tflops: 58.29  mfu: 17.12%
[rank3]:2026-01-01 08:47:46,545 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 08:47:46,546 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 08:47:46,543 -  step: 800  loss: -4.0000  grad_norm: 27.2399  memory: 11.88GiB(25.00%)  tps: 7,060  tflops: 55.19  mfu: 17.69%
[rank2]:2026-01-01 08:47:46,543 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2399  tps: 7,452  tflops: 58.25  mfu: 17.01%
[rank2]:2026-01-01 08:47:46,543 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 08:47:46,544 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 08:47:48,520 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2026-01-01 08:47:48,590 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0847_stage1_final800.svg
[rank2]:2026-01-01 08:47:48,590 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0847_stage2_final800.svg
[rank0]:2026-01-01 08:47:48,589 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0847_stage0_final800.svg
[rank0]:2026-01-01 08:47:48,635 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0847_stage4_final800.svg
[rank1]:2026-01-01 08:47:48,636 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0847_stage5_final800.svg
[rank2]:2026-01-01 08:47:48,636 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0847_stage6_final800.svg
[rank1]:2026-01-01 08:47:48,777 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank1_stage1.svg
[rank1]:	> Counts Sum: 477120, Total Sum: 967680 (49.31%), Ratio(%) per element: [49.3, 48.95, 49.65, 49.3, 49.47, 49.47, 49.82, 50.0, 49.3, 49.65, 49.3, 48.61, 48.26, 49.13, 48.61, 49.3, 49.82, 49.47, 49.13, 49.13, 49.3, 49.47, 49.47, 49.3, 49.13, 50.0, 48.78, 49.3, 49.13, 49.47, 50.0, 48.95, 48.95, 48.95, 49.82, 48.95, 49.3, 49.47, 48.95, 49.65, 49.65, 48.95]
[rank3]:2026-01-01 08:47:48,779 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0847_final800_rank3.svg
[rank3]:			> Batch Time: 1138.00 ms, GPU Bubble Ratio: 60.12%, 48.33%, 57.72%, 36.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S0,MB4,F]  259-14-274ms   | [S0,MB5,F]  274-14-288ms   | [S0,MB6,F]  288-13-301ms   | [S4,MB0,B]  433-16-449ms   | [S0,MB7,F]  449-12-462ms   | [S4,MB1,B]  533-16-549ms   | [S4,MB4,F]  578-14-592ms   | [S4,MB2,B]  592-17-610ms   | [S4,MB5,F]  613-14-628ms   | [S4,MB3,B]  628-17-645ms   | [S4,MB6,F]  648-14-662ms   | [S0,MB0,B]  663-16-679ms   | [S4,MB7,F]  683-13-696ms   | [S0,MB1,B]  697-16-713ms   | [S0,MB2,B]  736-13-749ms   | [S0,MB3,B]  777-13-791ms   | [S4,MB4,B]  806-14-820ms   | [S4,MB5,B]  879-14-893ms   | [S4,MB6,B]  949-14-964ms   | [S4,MB7,B]  1015-14-1029ms | [S0,MB4,B]  1043-13-1056ms | [S0,MB5,B]  1081-13-1094ms | [S0,MB6,B]  1109-13-1122ms | [S0,MB7,B]  1138-0-1138ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  284-12-297ms   | [S5,MB3,F]  352-12-365ms   | [S1,MB4,F]  386-19-405ms   | [S5,MB0,B]  405-17-423ms   | [S1,MB5,F]  425-23-449ms   | [S5,MB1,B]  449-15-464ms   | [S1,MB6,F]  464-20-485ms   | [S5,MB2,B]  532-16-548ms   | [S1,MB7,F]  548-21-569ms   | [S5,MB3,B]  587-17-604ms   | [S5,MB4,F]  604-14-618ms   | [S1,MB0,B]  623-25-648ms   | [S5,MB5,F]  648-15-663ms   | [S1,MB1,B]  664-24-688ms   | [S5,MB6,F]  688-16-704ms   | [S1,MB2,B]  705-24-729ms   | [S5,MB7,F]  729-15-744ms   | [S1,MB3,B]  744-24-769ms   | [S5,MB4,B]  784-15-799ms   | [S5,MB5,B]  851-15-866ms   | [S5,MB6,B]  921-15-936ms   | [S5,MB7,B]  993-15-1008ms  | [S1,MB4,B]  1014-21-1036ms | [S1,MB5,B]  1052-21-1074ms | [S1,MB6,B]  1080-21-1102ms | [S1,MB7,B]  1108-21-1130ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB2,F]  346-12-359ms   | [S6,MB0,B]  359-16-376ms   | [S6,MB3,F]  376-14-391ms   | [S6,MB1,B]  412-19-432ms   | [S2,MB4,F]  432-14-446ms   | [S6,MB2,B]  482-16-499ms   | [S2,MB5,F]  499-13-512ms   | [S6,MB3,B]  553-17-570ms   | [S2,MB6,F]  570-14-585ms   | [S2,MB0,B]  589-17-606ms   | [S2,MB7,F]  606-14-621ms   | [S2,MB1,B]  625-16-642ms   | [S6,MB4,F]  642-14-657ms   | [S2,MB2,B]  661-17-678ms   | [S6,MB5,F]  678-13-692ms   | [S2,MB3,B]  700-16-717ms   | [S6,MB6,F]  716-13-730ms   | [S6,MB4,B]  758-18-777ms   | [S6,MB7,F]  777-14-792ms   | [S6,MB5,B]  828-15-844ms   | [S6,MB6,B]  899-15-914ms   | [S6,MB7,B]  971-15-986ms   | [S2,MB4,B]  992-14-1007ms  | [S2,MB5,B]  1030-15-1046ms | [S2,MB6,B]  1052-15-1067ms | [S2,MB7,B]  1080-15-1096ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-289ms   | [S7,MB0,B]  301-35-336ms   | [S7,MB1,F]  336-21-358ms   | [S7,MB1,B]  370-35-406ms   | [S7,MB2,F]  405-22-428ms   | [S7,MB2,B]  440-35-475ms   | [S7,MB3,F]  476-23-499ms   | [S7,MB3,B]  510-36-547ms   | [S3,MB4,F]  547-16-564ms   | [S3,MB0,B]  563-17-581ms   | [S3,MB5,F]  581-17-599ms   | [S3,MB1,B]  598-17-615ms   | [S3,MB6,F]  615-16-632ms   | [S3,MB2,B]  632-17-650ms   | [S3,MB7,F]  649-16-666ms   | [S3,MB3,B]  666-16-682ms   | [S7,MB4,F]  682-21-704ms   | [S7,MB4,B]  716-35-752ms   | [S7,MB5,F]  752-22-774ms   | [S7,MB5,B]  786-35-822ms   | [S7,MB6,F]  822-23-845ms   | [S7,MB6,B]  856-36-892ms   | [S7,MB7,F]  892-22-915ms   | [S7,MB7,B]  927-36-964ms   | [S3,MB4,B]  964-17-982ms   | [S3,MB5,B]  981-18-1000ms  | [S3,MB6,B]  1000-17-1017ms | [S3,MB7,B]  1023-17-1041ms
[rank2]:2026-01-01 08:47:48,766 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank2_stage2.svg
[rank2]:	> Counts Sum: 92960, Total Sum: 645120 (14.41%), Ratio(%) per element: [14.4, 14.75, 14.58, 14.4, 14.06, 14.75, 14.58, 14.58, 14.23, 14.23, 14.23, 14.4, 14.4, 14.06, 14.75, 14.75, 14.4, 14.75, 14.4, 14.4, 14.06, 14.23, 14.23, 14.75, 14.23, 14.4, 13.88, 14.4]
[rank0]:2026-01-01 08:47:48,762 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank0_stage0.svg
[rank0]:	> Counts Sum: 92960, Total Sum: 645120 (14.41%), Ratio(%) per element: [14.4, 14.23, 14.58, 14.75, 14.06, 14.23, 14.4, 14.4, 14.58, 14.23, 14.23, 14.06, 14.75, 14.58, 14.23, 14.06, 14.58, 14.23, 14.75, 14.4, 14.75, 14.23, 14.06, 14.58, 14.23, 14.4, 14.58, 14.75]
[rank2]:2026-01-01 08:47:48,897 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank2_stage6.svg
[rank2]:	> Counts Sum: 17920, Total Sum: 645120 (2.78%), Ratio(%) per element: [2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77]
[rank0]:2026-01-01 08:47:48,888 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank0_stage4.svg
[rank0]:	> Counts Sum: 17920, Total Sum: 645120 (2.78%), Ratio(%) per element: [2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77]
[rank1]:2026-01-01 08:47:48,909 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank1_stage5.svg
[rank1]:	> Counts Sum: 17920, Total Sum: 645120 (2.78%), Ratio(%) per element: [2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77]
[rank3]:2026-01-01 08:47:49,016 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0847_thry_final800_rank3.svg
[rank3]:			> Batch Time: 900.43 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-47ms     | [S0,MB3,F]  47-15-63ms     | [S4,MB0,F]  63-15-78ms     | [S4,MB1,F]  78-15-94ms     | [S4,MB2,F]  94-15-110ms    | [S4,MB3,F]  110-15-126ms   | [S0,MB4,F]  126-15-142ms   | [S0,MB5,F]  142-15-157ms   | [S0,MB6,F]  157-15-173ms   | [S4,MB0,B]  221-31-252ms   | [S0,MB7,F]  252-15-268ms   | [S4,MB1,B]  268-31-300ms   | [S4,MB4,F]  315-15-331ms   | [S4,MB2,B]  331-31-363ms   | [S4,MB5,F]  363-15-379ms   | [S4,MB3,B]  379-31-410ms   | [S4,MB6,F]  410-15-426ms   | [S0,MB0,B]  426-31-458ms   | [S4,MB7,F]  458-15-473ms   | [S0,MB1,B]  473-31-505ms   | [S0,MB2,B]  505-31-537ms   | [S0,MB3,B]  552-31-584ms   | [S4,MB4,B]  600-31-631ms   | [S4,MB5,B]  647-31-679ms   | [S4,MB6,B]  695-31-726ms   | [S4,MB7,B]  742-31-774ms   | [S0,MB4,B]  774-31-805ms   | [S0,MB5,B]  805-31-837ms   | [S0,MB6,B]  837-31-868ms   | [S0,MB7,B]  868-31-900ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-31ms     | [S1,MB1,F]  31-15-47ms     | [S1,MB2,F]  47-15-63ms     | [S1,MB3,F]  63-15-78ms     | [S5,MB0,F]  78-15-94ms     | [S5,MB1,F]  94-15-110ms    | [S5,MB2,F]  110-15-126ms   | [S5,MB3,F]  126-15-142ms   | [S1,MB4,F]  142-15-157ms   | [S5,MB0,B]  189-31-221ms   | [S1,MB5,F]  221-15-236ms   | [S5,MB1,B]  236-31-268ms   | [S1,MB6,F]  268-15-284ms   | [S5,MB2,B]  284-31-315ms   | [S1,MB7,F]  315-15-331ms   | [S5,MB3,B]  331-31-363ms   | [S5,MB4,F]  363-15-379ms   | [S1,MB0,B]  379-31-410ms   | [S5,MB5,F]  410-15-426ms   | [S1,MB1,B]  426-31-458ms   | [S5,MB6,F]  458-15-473ms   | [S1,MB2,B]  473-31-505ms   | [S5,MB7,F]  505-15-521ms   | [S1,MB3,B]  521-31-552ms   | [S5,MB4,B]  568-31-600ms   | [S5,MB5,B]  616-31-647ms   | [S5,MB6,B]  663-31-695ms   | [S5,MB7,B]  710-31-742ms   | [S1,MB4,B]  742-31-774ms   | [S1,MB5,B]  774-31-805ms   | [S1,MB6,B]  805-31-837ms   | [S1,MB7,B]  837-31-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  31-15-47ms     | [S2,MB1,F]  47-15-63ms     | [S2,MB2,F]  63-15-78ms     | [S2,MB3,F]  78-15-94ms     | [S6,MB0,F]  94-15-110ms    | [S6,MB1,F]  110-15-126ms   | [S6,MB2,F]  126-15-142ms   | [S6,MB0,B]  157-31-189ms   | [S6,MB3,F]  189-15-205ms   | [S6,MB1,B]  205-31-236ms   | [S2,MB4,F]  236-15-252ms   | [S6,MB2,B]  252-31-284ms   | [S2,MB5,F]  284-15-300ms   | [S6,MB3,B]  300-31-331ms   | [S2,MB6,F]  331-15-347ms   | [S2,MB0,B]  347-31-379ms   | [S2,MB7,F]  379-15-394ms   | [S2,MB1,B]  394-31-426ms   | [S6,MB4,F]  426-15-442ms   | [S2,MB2,B]  442-31-473ms   | [S6,MB5,F]  473-15-489ms   | [S2,MB3,B]  489-31-521ms   | [S6,MB6,F]  521-15-537ms   | [S6,MB4,B]  537-31-568ms   | [S6,MB7,F]  568-15-584ms   | [S6,MB5,B]  584-31-616ms   | [S6,MB6,B]  631-31-663ms   | [S6,MB7,B]  679-31-710ms   | [S2,MB4,B]  710-31-742ms   | [S2,MB5,B]  742-31-774ms   | [S2,MB6,B]  774-31-805ms   | [S2,MB7,B]  805-31-837ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-15-63ms     | [S3,MB1,F]  63-15-78ms     | [S3,MB2,F]  78-15-94ms     | [S3,MB3,F]  94-15-110ms    | [S7,MB0,F]  110-15-126ms   | [S7,MB0,B]  126-31-157ms   | [S7,MB1,F]  157-15-173ms   | [S7,MB1,B]  173-31-205ms   | [S7,MB2,F]  205-15-221ms   | [S7,MB2,B]  221-31-252ms   | [S7,MB3,F]  252-15-268ms   | [S7,MB3,B]  268-31-300ms   | [S3,MB4,F]  300-15-315ms   | [S3,MB0,B]  315-31-347ms   | [S3,MB5,F]  347-15-363ms   | [S3,MB1,B]  363-31-394ms   | [S3,MB6,F]  394-15-410ms   | [S3,MB2,B]  410-31-442ms   | [S3,MB7,F]  442-15-458ms   | [S3,MB3,B]  458-31-489ms   | [S7,MB4,F]  489-15-505ms   | [S7,MB4,B]  505-31-537ms   | [S7,MB5,F]  537-15-552ms   | [S7,MB5,B]  552-31-584ms   | [S7,MB6,F]  584-15-600ms   | [S7,MB6,B]  600-31-631ms   | [S7,MB7,F]  631-15-647ms   | [S7,MB7,B]  647-31-679ms   | [S3,MB4,B]  679-31-710ms   | [S3,MB5,B]  710-31-742ms   | [S3,MB6,B]  742-31-774ms   | [S3,MB7,B]  774-31-805ms  
[rank3]:2026-01-01 08:47:49,064 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0847_stage3_final800.svg
[rank3]:2026-01-01 08:47:49,108 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0847_stage7_final800.svg
[rank3]:2026-01-01 08:47:49,234 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank3_stage3.svg
[rank3]:	> Counts Sum: 393120, Total Sum: 645120 (60.94%), Ratio(%) per element: [61.45, 60.76, 60.41, 61.28, 61.11, 60.93, 61.11, 61.8, 60.93, 60.41, 60.24, 60.76, 61.63, 61.45, 59.89, 61.28, 60.76, 60.06, 61.63, 61.11, 61.8, 60.59, 61.11, 61.11, 60.41, 60.41, 61.28, 60.41]
[rank3]:2026-01-01 08:47:49,321 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0847_rank3_stage7.svg
[rank3]:	> Counts Sum: 249160, Total Sum: 322560 (77.24%), Ratio(%) per element: [77.08, 77.08, 76.73, 77.25, 77.77, 78.99, 77.08, 78.47, 75.86, 77.25, 77.77, 78.12, 77.43, 74.47]
[rank0]:2026-01-01 08:47:49,810 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage0.svg
[rank1]:2026-01-01 08:47:49,837 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage1.svg
[rank2]:2026-01-01 08:47:49,839 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage2.svg
[rank3]:2026-01-01 08:47:50,208 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage3.svg
[rank0]:2026-01-01 08:47:50,710 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage4.svg
[rank0]:2026-01-01 08:47:50,714 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-01 08:47:50,743 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage5.svg
[rank1]:2026-01-01 08:47:50,747 - Destroying the purge thread.
[rank2]:2026-01-01 08:47:50,755 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage6.svg
[rank2]:2026-01-01 08:47:50,758 - Destroying the purge thread.
[rank1]:2026-01-01 08:47:50,835 - Process group destroyed
[rank3]:2026-01-01 08:47:51,083 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/260101_0847_stage7.svg
[rank3]:2026-01-01 08:47:51,087 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2026-01-01 08:47:51,272 - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–‚â–‚â–â–‚â–ˆâ–â–â–â–ˆâ–â–â–â–‡â–‚â–â–â–†
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.39479
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 17.12467
[rank3]:wandb:             final/avg_tflops 58.28837
[rank3]:wandb:    final/avg_throughput(tps) 7456.10117
[rank3]:wandb:              final/grad_norm 27.23991
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 27.23991
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_Interleaved1F1B_timelyapf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/c57mo0bh
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_Interleaved1F1B_timelyapf_42_dm1/20260101-0745/wandb/run-20260101_074529-c57mo0bh/logs
[rank3]:2026-01-01 08:47:52,418 - Process group destroyed
[rank0]:2026-01-01 08:47:52,714 - Training completed
[rank0]:2026-01-01 08:47:52,714 - Destroying the purge thread.
[rank0]:2026-01-01 08:47:52,851 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
