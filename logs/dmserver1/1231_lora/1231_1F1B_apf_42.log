
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 04:51:41 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_1F1B_apf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with apf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2026-01-01 04:51:49,070 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank3]:2026-01-01 04:51:49,070 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank0]:2026-01-01 04:51:49,274 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 04:51:49,275 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 04:51:49,278 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 04:51:49,279 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-01 04:51:49,335 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank2]:2026-01-01 04:51:49,363 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:2026-01-01 04:51:49,269 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:2026-01-01 04:51:49,271 - Building 1-D device mesh with ['pp'], [4]
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank1]:2026-01-01 04:51:49,518 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 04:51:49,520 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-01 04:51:49,563 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 04:51:49,565 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 04:51:49,670 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2026-01-01 04:51:52,799 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2026-01-01 04:51:52,864 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 04:51:52,946 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 04:51:52,936 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 04:51:52,903 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 04:51:52,930 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-01 04:51:52,930 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 04:51:52,985 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 04:51:52,987 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 04:51:53,011 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-01 04:51:53,012 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-01 04:51:52,978 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 04:51:53,003 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-01 04:51:53,004 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2026-01-01 04:51:53,114 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 04:51:53,115 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 04:51:53,115 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2026-01-01 04:51:53,206 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 04:51:53,206 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 04:51:53,207 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2026-01-01 04:51:53,205 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 04:51:53,205 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 04:51:53,205 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run e1eoq5pf
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_1F1B_apf_42_dm1/20260101-0451/wandb/run-20260101_045154-e1eoq5pf
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_1F1B_apf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/e1eoq5pf
[rank3]:2026-01-01 04:51:55,486 - WandB logging enabled
[rank3]:2026-01-01 04:51:55,487 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 04:51:55,527 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 04:51:55,556 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2026-01-01 04:51:55,556 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 04:51:55,760 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_1F1B_apf_42_dm1
[rank0]:2026-01-01 04:51:55,760 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 04:51:55,760 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 04:51:55,761 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2026-01-01 04:51:55,744 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 04:51:55,744 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 04:51:55,745 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2026-01-01 04:51:55,760 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 04:51:55,761 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-01 04:51:55,761 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-01 04:51:58,568 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2026-01-01 04:51:58,568 - Freezable Parameters: [Stage 1] 70 params
[rank0]:2026-01-01 04:51:58,507 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 04:51:58,507 - Finished loading the checkpoint in 2.75 seconds.
[rank0]:2026-01-01 04:51:58,552 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank2]:2026-01-01 04:51:58,556 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank0]:2026-01-01 04:51:58,553 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2026-01-01 04:51:58,553 - Training starts at step 1
[rank2]:2026-01-01 04:51:58,557 - Freezable Parameters: [Stage 2] 56 params
[rank3]:2026-01-01 04:51:58,567 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2026-01-01 04:51:58,568 - Freezable Parameters: [Stage 3] 42 params
[rank1]:2026-01-01 04:52:03,553 -  step:  1  loss: -4.0000  grad_norm:  9.9057  memory: 12.09GiB(25.46%)  tps: 3,099  tflops: 24.23  mfu: 7.76%
[rank1]:2026-01-01 04:52:03,553 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 04:52:03,553 -  step:  1  loss: 10.6092  grad_norm:  9.9057  memory: 20.97GiB(44.14%)  tps: 4,084  tflops: 31.93  mfu: 10.23%
[rank3]:2026-01-01 04:52:03,553 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 04:52:03,579 -  step:  1  loss: -4.0000  grad_norm:  9.9057  memory: 13.12GiB(27.62%)  tps: 3,093  tflops: 24.18  mfu: 7.75%
[rank0]:2026-01-01 04:52:03,579 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-01 04:52:03,551 -  step:  1  loss: -4.0000  grad_norm:  9.9057  memory:  7.27GiB(15.31%)  tps: 3,078  tflops: 24.06  mfu: 7.71%
[rank2]:2026-01-01 04:52:03,551 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 04:55:25,957 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 04:55:30,025 - Avg. fwd time: 33.3524 / Avg. bwd time: 52.9402 / Avg. batch time: 835.5454 (ms) / GPU bubble ratio: 17.38%
[rank1]:2026-01-01 04:55:30,106 - Avg. fwd time: 32.7660 / Avg. bwd time: 38.2412 / Avg. batch time: 976.4361 (ms) / GPU bubble ratio: 41.82%
[rank1]:2026-01-01 04:55:30,144 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 12.09GiB(25.46%)  tps: 7,772  tflops: 60.76  mfu: 19.47%
[rank2]:2026-01-01 04:55:30,062 - Avg. fwd time: 25.7934 / Avg. bwd time: 30.2228 / Avg. batch time: 898.7945 (ms) / GPU bubble ratio: 50.14%
[rank2]:2026-01-01 04:55:30,144 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory:  7.27GiB(15.31%)  tps: 7,772  tflops: 60.76  mfu: 19.47%
[rank3]:2026-01-01 04:55:30,146 -  step: 50  loss: 12.4624  grad_norm:  8.4069  memory: 20.97GiB(44.14%)  tps: 7,772  tflops: 60.76  mfu: 19.47%
[rank0]:2026-01-01 04:55:30,141 - Avg. fwd time: 26.2875 / Avg. bwd time: 28.3660 / Avg. batch time: 1038.6109 (ms) / GPU bubble ratio: 57.90%
[rank0]:2026-01-01 04:55:30,145 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 13.12GiB(27.62%)  tps: 7,773  tflops: 60.77  mfu: 19.48%
[rank3]:2026-01-01 04:56:07,970 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 04:56:08,112 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 04:56:08,153 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 04:56:08,181 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 04:56:50,470 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 04:56:50,461 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 04:56:50,467 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 04:56:50,475 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 04:57:31,077 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 04:57:31,081 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 04:57:31,075 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 04:57:31,079 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 04:58:13,514 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 04:58:13,511 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 04:58:13,516 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 04:58:13,514 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 04:58:53,987 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 04:58:53,984 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 04:58:53,978 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 04:58:53,989 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 04:58:53,991 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 04:58:57,920 - Avg. fwd time: 33.4469 / Avg. bwd time: 52.7498 / Avg. batch time: 834.7746 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 04:58:57,956 - Avg. fwd time: 25.7695 / Avg. bwd time: 29.8864 / Avg. batch time: 897.2176 (ms) / GPU bubble ratio: 50.37%
[rank2]:2026-01-01 04:58:58,008 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,882  tflops: 61.62  mfu: 19.75%
[rank3]:2026-01-01 04:58:58,010 -  step: 100  loss: 13.1176  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,882  tflops: 61.62  mfu: 19.75%
[rank0]:2026-01-01 04:58:58,005 - Avg. fwd time: 26.1993 / Avg. bwd time: 22.4510 / Avg. batch time: 1029.7062 (ms) / GPU bubble ratio: 62.20%
[rank0]:2026-01-01 04:58:58,009 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,882  tflops: 61.62  mfu: 19.75%
[rank1]:2026-01-01 04:58:57,999 - Avg. fwd time: 32.7422 / Avg. bwd time: 37.8508 / Avg. batch time: 973.9757 (ms) / GPU bubble ratio: 42.02%
[rank1]:2026-01-01 04:58:58,008 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,882  tflops: 61.62  mfu: 19.75%
[rank2]:2026-01-01 04:58:58,080 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0458_stage2_step100.svg
[rank0]:2026-01-01 04:58:58,078 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0458_stage0_step100.svg
[rank1]:2026-01-01 04:58:58,080 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0458_stage1_step100.svg
[rank3]:2026-01-01 04:58:58,170 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0458_step100_rank3.svg
[rank3]:			> Batch Time: 990.00 ms, GPU Bubble Ratio: 79.07%, 44.50%, 56.26%, 31.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-25-25ms      | [S0,MB1,F]  25-27-52ms     | [S0,MB2,F]  52-27-79ms     | [S0,MB3,F]  79-27-106ms    | [S0,MB0,B]  272-0-272ms    | [S0,MB4,F]  272-25-297ms   | [S0,MB1,B]  376-0-376ms    | [S0,MB5,F]  376-24-401ms   | [S0,MB2,B]  480-0-480ms    | [S0,MB6,F]  480-25-505ms   | [S0,MB3,B]  583-0-583ms    | [S0,MB7,F]  583-25-608ms   | [S0,MB4,B]  688-0-688ms    | [S0,MB5,B]  788-0-788ms    | [S0,MB6,B]  887-0-887ms    | [S0,MB7,B]  990-0-990ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  25-31-57ms     | [S1,MB1,F]  64-32-96ms     | [S1,MB2,F]  103-32-136ms   | [S1,MB0,B]  225-35-261ms   | [S1,MB3,F]  269-32-301ms   | [S1,MB1,B]  330-36-366ms   | [S1,MB4,F]  373-32-406ms   | [S1,MB2,B]  433-36-470ms   | [S1,MB5,F]  477-32-509ms   | [S1,MB3,B]  536-36-573ms   | [S1,MB6,F]  580-32-613ms   | [S1,MB4,B]  641-36-677ms   | [S1,MB7,F]  684-32-717ms   | [S1,MB5,B]  745-36-781ms   | [S1,MB6,B]  844-36-880ms   | [S1,MB7,B]  947-36-983ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-82ms     | [S2,MB1,F]  96-25-122ms    | [S2,MB0,B]  186-28-215ms   | [S2,MB2,F]  222-25-248ms   | [S2,MB1,B]  290-28-319ms   | [S2,MB3,F]  326-25-352ms   | [S2,MB2,B]  395-28-423ms   | [S2,MB4,F]  430-25-456ms   | [S2,MB3,B]  498-28-526ms   | [S2,MB5,F]  533-25-559ms   | [S2,MB4,B]  602-28-630ms   | [S2,MB6,F]  638-25-663ms   | [S2,MB5,B]  706-28-735ms   | [S2,MB7,F]  742-25-767ms   | [S2,MB6,B]  810-28-838ms   | [S2,MB7,B]  912-28-940ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  82-31-113ms    | [S3,MB0,B]  125-50-176ms   | [S3,MB1,F]  183-33-216ms   | [S3,MB1,B]  228-51-280ms   | [S3,MB2,F]  287-33-321ms   | [S3,MB2,B]  333-51-384ms   | [S3,MB3,F]  392-33-425ms   | [S3,MB3,B]  437-51-488ms   | [S3,MB4,F]  495-33-528ms   | [S3,MB4,B]  540-51-591ms   | [S3,MB5,F]  599-33-633ms   | [S3,MB5,B]  644-51-696ms   | [S3,MB6,F]  703-33-737ms   | [S3,MB6,B]  749-52-801ms   | [S3,MB7,F]  807-33-841ms   | [S3,MB7,B]  853-51-905ms  
[rank3]:2026-01-01 04:58:58,213 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0458_stage3_step100.svg
[rank0]:2026-01-01 04:58:58,250 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0458_rank0_stage0.svg
[rank0]:	> Counts Sum: 168, Total Sum: 280 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank2]:2026-01-01 04:58:58,256 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0458_rank2_stage2.svg
[rank2]:	> Counts Sum: 168, Total Sum: 280 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank1]:2026-01-01 04:58:58,268 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0458_rank1_stage1.svg
[rank1]:	> Counts Sum: 210, Total Sum: 350 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank3]:2026-01-01 04:58:58,357 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0458_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 210 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank2]:2026-01-01 04:59:34,719 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 04:59:34,716 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 04:59:34,722 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 04:59:34,719 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:00:17,150 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:00:17,146 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:00:17,149 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:00:17,151 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:00:57,791 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:00:57,794 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:00:57,793 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:00:57,790 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:01:38,382 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:01:38,387 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:01:38,384 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:01:38,386 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:02:18,923 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:02:18,939 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:02:18,926 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:02:18,925 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 05:02:18,937 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:02:23,084 - Avg. fwd time: 33.4949 / Avg. bwd time: 52.5234 / Avg. batch time: 833.3826 (ms) / GPU bubble ratio: 17.43%
[rank1]:2026-01-01 05:02:23,168 - Avg. fwd time: 32.7099 / Avg. bwd time: 37.4860 / Avg. batch time: 971.5229 (ms) / GPU bubble ratio: 42.20%
[rank1]:2026-01-01 05:02:23,207 -  step: 150  loss: -4.0000  grad_norm:  8.3959  memory: 12.11GiB(25.49%)  tps: 7,984  tflops: 62.42  mfu: 20.01%
[rank2]:2026-01-01 05:02:23,122 - Avg. fwd time: 25.7457 / Avg. bwd time: 29.5794 / Avg. batch time: 895.3601 (ms) / GPU bubble ratio: 50.57%
[rank2]:2026-01-01 05:02:23,207 -  step: 150  loss: -4.0000  grad_norm:  8.3959  memory:  7.28GiB(15.33%)  tps: 7,984  tflops: 62.42  mfu: 20.01%
[rank0]:2026-01-01 05:02:23,203 - Avg. fwd time: 26.1307 / Avg. bwd time: 17.0578 / Avg. batch time: 1021.6649 (ms) / GPU bubble ratio: 66.18%
[rank0]:2026-01-01 05:02:23,207 -  step: 150  loss: -4.0000  grad_norm:  8.3959  memory: 13.13GiB(27.64%)  tps: 7,984  tflops: 62.42  mfu: 20.01%
[rank3]:2026-01-01 05:02:23,209 -  step: 150  loss: 11.1266  grad_norm:  8.3959  memory: 20.98GiB(44.15%)  tps: 7,985  tflops: 62.42  mfu: 20.01%
[rank3]:2026-01-01 05:03:01,420 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:03:01,425 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:03:01,422 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:03:01,424 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:03:42,135 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:03:42,140 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:03:42,138 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:03:42,137 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:04:22,681 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:04:22,685 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:04:22,679 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:04:22,683 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:05:03,229 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:05:03,229 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:05:03,232 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:05:03,227 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:05:43,921 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:05:43,915 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:05:43,907 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 05:05:43,919 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:05:43,916 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:05:48,153 - Avg. fwd time: 33.5364 / Avg. bwd time: 52.4215 / Avg. batch time: 832.9204 (ms) / GPU bubble ratio: 17.44%
[rank2]:2026-01-01 05:05:48,191 - Avg. fwd time: 25.7363 / Avg. bwd time: 29.4197 / Avg. batch time: 894.6436 (ms) / GPU bubble ratio: 50.68%
[rank1]:2026-01-01 05:05:48,237 - Avg. fwd time: 32.6989 / Avg. bwd time: 37.2970 / Avg. batch time: 970.5181 (ms) / GPU bubble ratio: 42.30%
[rank0]:2026-01-01 05:05:48,273 - Avg. fwd time: 26.0961 / Avg. bwd time: 14.2196 / Avg. batch time: 1017.7152 (ms) / GPU bubble ratio: 68.31%
[rank0]:2026-01-01 05:05:48,277 -  step: 200  loss: -4.0000  grad_norm: 36.8473  memory: 13.13GiB(27.64%)  tps: 7,989  tflops: 62.46  mfu: 20.02%
[rank2]:2026-01-01 05:05:48,276 -  step: 200  loss: -4.0000  grad_norm: 36.8473  memory:  7.28GiB(15.33%)  tps: 7,989  tflops: 62.46  mfu: 20.02%
[rank1]:2026-01-01 05:05:48,276 -  step: 200  loss: -4.0000  grad_norm: 36.8473  memory: 12.11GiB(25.49%)  tps: 7,989  tflops: 62.46  mfu: 20.02%
[rank1]:2026-01-01 05:05:48,329 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0505_stage1_step200.svg
[rank3]:2026-01-01 05:05:48,278 -  step: 200  loss: 10.3045  grad_norm: 36.8473  memory: 20.98GiB(44.15%)  tps: 7,990  tflops: 62.46  mfu: 20.02%
[rank0]:2026-01-01 05:05:48,329 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0505_stage0_step200.svg
[rank2]:2026-01-01 05:05:48,328 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0505_stage2_step200.svg
[rank3]:2026-01-01 05:05:48,419 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0505_step200_rank3.svg
[rank3]:			> Batch Time: 996.00 ms, GPU Bubble Ratio: 79.17%, 44.60%, 56.41%, 31.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-25-25ms      | [S0,MB1,F]  25-27-52ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  272-0-272ms    | [S0,MB4,F]  272-25-297ms   | [S0,MB1,B]  377-0-377ms    | [S0,MB5,F]  377-25-402ms   | [S0,MB2,B]  481-0-481ms    | [S0,MB6,F]  481-25-506ms   | [S0,MB3,B]  587-0-587ms    | [S0,MB7,F]  587-25-612ms   | [S0,MB4,B]  691-0-691ms    | [S0,MB5,B]  792-0-792ms    | [S0,MB6,B]  893-0-893ms    | [S0,MB7,B]  996-0-996ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  25-31-57ms     | [S1,MB1,F]  64-32-96ms     | [S1,MB2,F]  103-32-136ms   | [S1,MB0,B]  226-36-262ms   | [S1,MB3,F]  269-32-302ms   | [S1,MB1,B]  330-36-367ms   | [S1,MB4,F]  374-32-407ms   | [S1,MB2,B]  434-36-471ms   | [S1,MB5,F]  478-32-511ms   | [S1,MB3,B]  540-36-576ms   | [S1,MB6,F]  583-32-616ms   | [S1,MB4,B]  644-36-681ms   | [S1,MB7,F]  688-32-721ms   | [S1,MB5,B]  749-36-785ms   | [S1,MB6,B]  850-36-886ms   | [S1,MB7,B]  953-36-989ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-83ms     | [S2,MB1,F]  96-25-122ms    | [S2,MB0,B]  187-28-216ms   | [S2,MB2,F]  223-25-248ms   | [S2,MB1,B]  291-28-320ms   | [S2,MB3,F]  327-25-353ms   | [S2,MB2,B]  395-28-424ms   | [S2,MB4,F]  431-25-457ms   | [S2,MB3,B]  501-28-529ms   | [S2,MB5,F]  537-25-562ms   | [S2,MB4,B]  605-28-634ms   | [S2,MB6,F]  641-25-667ms   | [S2,MB5,B]  710-28-738ms   | [S2,MB7,F]  746-25-771ms   | [S2,MB6,B]  815-28-844ms   | [S2,MB7,B]  918-28-946ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-114ms    | [S3,MB0,B]  126-50-177ms   | [S3,MB1,F]  184-33-217ms   | [S3,MB1,B]  229-51-281ms   | [S3,MB2,F]  288-34-322ms   | [S3,MB2,B]  334-51-386ms   | [S3,MB3,F]  393-34-427ms   | [S3,MB3,B]  439-51-491ms   | [S3,MB4,F]  498-34-532ms   | [S3,MB4,B]  543-52-596ms   | [S3,MB5,F]  602-34-637ms   | [S3,MB5,B]  648-51-700ms   | [S3,MB6,F]  707-34-741ms   | [S3,MB6,B]  753-52-805ms   | [S3,MB7,F]  813-34-847ms   | [S3,MB7,B]  859-52-911ms  
[rank3]:2026-01-01 05:05:48,464 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0505_stage3_step200.svg
[rank2]:2026-01-01 05:05:48,493 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0505_rank2_stage2.svg
[rank2]:	> Counts Sum: 560, Total Sum: 840 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank1]:2026-01-01 05:05:48,509 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0505_rank1_stage1.svg
[rank1]:	> Counts Sum: 700, Total Sum: 1050 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank0]:2026-01-01 05:05:48,500 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0505_rank0_stage0.svg
[rank0]:	> Counts Sum: 560, Total Sum: 840 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank3]:2026-01-01 05:05:48,608 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0505_rank3_stage3.svg
[rank3]:	> Counts Sum: 420, Total Sum: 630 (66.67%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66]
[rank0]:2026-01-01 05:06:26,840 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:06:26,838 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:06:26,841 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:06:26,836 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:07:07,417 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:07:07,411 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:07:07,415 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:07:07,413 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:07:48,026 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:07:48,020 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:07:48,023 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:07:48,022 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:08:28,740 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:08:28,735 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:08:28,738 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:08:28,737 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:09:09,491 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:09:09,475 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:09:09,476 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 05:09:09,489 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:09:09,477 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:09:13,430 - Avg. fwd time: 33.5580 / Avg. bwd time: 52.3474 / Avg. batch time: 832.5135 (ms) / GPU bubble ratio: 17.45%
[rank2]:2026-01-01 05:09:13,466 - Avg. fwd time: 25.7277 / Avg. bwd time: 29.3152 / Avg. batch time: 894.0907 (ms) / GPU bubble ratio: 50.75%
[rank3]:2026-01-01 05:09:13,521 -  step: 250  loss: 12.5261  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank1]:2026-01-01 05:09:13,509 - Avg. fwd time: 32.6863 / Avg. bwd time: 37.1731 / Avg. batch time: 969.7787 (ms) / GPU bubble ratio: 42.37%
[rank1]:2026-01-01 05:09:13,519 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank0]:2026-01-01 05:09:13,516 - Avg. fwd time: 26.0733 / Avg. bwd time: 12.4021 / Avg. batch time: 1015.1030 (ms) / GPU bubble ratio: 69.68%
[rank0]:2026-01-01 05:09:13,519 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank2]:2026-01-01 05:09:13,519 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,983  tflops: 62.41  mfu: 20.00%
[rank1]:2026-01-01 05:09:50,070 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:09:50,065 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:09:50,068 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:09:50,067 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:10:32,424 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:10:32,418 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:10:32,421 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:10:32,422 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:11:13,115 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:11:13,118 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:11:13,117 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:11:13,121 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:11:53,968 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:11:53,967 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:11:53,964 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:11:53,970 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:12:34,475 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 05:12:34,487 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:12:34,489 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:12:34,484 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:12:34,482 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:12:38,432 - Avg. fwd time: 33.5627 / Avg. bwd time: 52.2940 / Avg. batch time: 832.1252 (ms) / GPU bubble ratio: 17.46%
[rank1]:2026-01-01 05:12:38,512 - Avg. fwd time: 32.6770 / Avg. bwd time: 37.0951 / Avg. batch time: 969.1638 (ms) / GPU bubble ratio: 42.41%
[rank1]:2026-01-01 05:12:38,523 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,992  tflops: 62.48  mfu: 20.03%
[rank2]:2026-01-01 05:12:38,469 - Avg. fwd time: 25.7206 / Avg. bwd time: 29.2501 / Avg. batch time: 893.5951 (ms) / GPU bubble ratio: 50.79%
[rank2]:2026-01-01 05:12:38,523 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,992  tflops: 62.48  mfu: 20.03%
[rank3]:2026-01-01 05:12:38,525 -  step: 300  loss: 12.9460  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,992  tflops: 62.48  mfu: 20.03%
[rank0]:2026-01-01 05:12:38,520 - Avg. fwd time: 26.0562 / Avg. bwd time: 11.2839 / Avg. batch time: 1013.3248 (ms) / GPU bubble ratio: 70.52%
[rank0]:2026-01-01 05:12:38,523 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,992  tflops: 62.48  mfu: 20.03%
[rank0]:2026-01-01 05:12:38,573 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0512_stage0_step300.svg
[rank1]:2026-01-01 05:12:38,573 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0512_stage1_step300.svg
[rank2]:2026-01-01 05:12:38,573 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0512_stage2_step300.svg
[rank3]:2026-01-01 05:12:38,663 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0512_step300_rank3.svg
[rank3]:			> Batch Time: 991.00 ms, GPU Bubble Ratio: 79.11%, 44.53%, 56.29%, 31.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-25-25ms      | [S0,MB1,F]  25-27-52ms     | [S0,MB2,F]  52-26-79ms     | [S0,MB3,F]  79-27-107ms    | [S0,MB0,B]  272-0-272ms    | [S0,MB4,F]  272-25-297ms   | [S0,MB1,B]  376-0-376ms    | [S0,MB5,F]  376-24-400ms   | [S0,MB2,B]  480-0-480ms    | [S0,MB6,F]  480-25-505ms   | [S0,MB3,B]  584-0-584ms    | [S0,MB7,F]  584-25-609ms   | [S0,MB4,B]  689-0-689ms    | [S0,MB5,B]  789-0-789ms    | [S0,MB6,B]  889-0-889ms    | [S0,MB7,B]  991-0-991ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  25-31-57ms     | [S1,MB1,F]  64-32-96ms     | [S1,MB2,F]  103-32-136ms   | [S1,MB0,B]  226-36-262ms   | [S1,MB3,F]  269-32-301ms   | [S1,MB1,B]  329-36-365ms   | [S1,MB4,F]  372-32-405ms   | [S1,MB2,B]  433-36-469ms   | [S1,MB5,F]  477-32-509ms   | [S1,MB3,B]  537-36-573ms   | [S1,MB6,F]  580-32-613ms   | [S1,MB4,B]  641-36-678ms   | [S1,MB7,F]  685-32-718ms   | [S1,MB5,B]  746-36-783ms   | [S1,MB6,B]  846-36-882ms   | [S1,MB7,B]  948-36-984ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-82ms     | [S2,MB1,F]  96-25-122ms    | [S2,MB0,B]  187-28-215ms   | [S2,MB2,F]  222-25-248ms   | [S2,MB1,B]  290-28-318ms   | [S2,MB3,F]  326-25-351ms   | [S2,MB2,B]  394-28-423ms   | [S2,MB4,F]  430-25-455ms   | [S2,MB3,B]  498-28-527ms   | [S2,MB5,F]  534-25-559ms   | [S2,MB4,B]  602-28-631ms   | [S2,MB6,F]  638-25-664ms   | [S2,MB5,B]  707-28-736ms   | [S2,MB7,F]  743-25-769ms   | [S2,MB6,B]  812-28-840ms   | [S2,MB7,B]  913-28-941ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  82-31-114ms    | [S3,MB0,B]  126-50-176ms   | [S3,MB1,F]  183-32-216ms   | [S3,MB1,B]  228-51-280ms   | [S3,MB2,F]  287-33-320ms   | [S3,MB2,B]  332-51-384ms   | [S3,MB3,F]  391-33-425ms   | [S3,MB3,B]  437-51-489ms   | [S3,MB4,F]  495-33-529ms   | [S3,MB4,B]  541-51-592ms   | [S3,MB5,F]  599-33-633ms   | [S3,MB5,B]  645-51-696ms   | [S3,MB6,F]  704-33-738ms   | [S3,MB6,B]  750-51-801ms   | [S3,MB7,F]  809-33-843ms   | [S3,MB7,B]  854-51-906ms  
[rank3]:2026-01-01 05:12:38,706 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0512_stage3_step300.svg
[rank0]:2026-01-01 05:12:38,739 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0512_rank0_stage0.svg
[rank0]:	> Counts Sum: 1064, Total Sum: 1400 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank1]:2026-01-01 05:12:38,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0512_rank1_stage1.svg
[rank1]:	> Counts Sum: 1330, Total Sum: 1750 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank2]:2026-01-01 05:12:38,738 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0512_rank2_stage2.svg
[rank2]:	> Counts Sum: 1064, Total Sum: 1400 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank3]:2026-01-01 05:12:38,845 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0512_rank3_stage3.svg
[rank3]:	> Counts Sum: 798, Total Sum: 1050 (76.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0]
[rank0]:2026-01-01 05:13:15,305 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:13:15,308 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:13:15,304 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:13:15,302 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:13:56,004 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:13:56,001 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:13:55,999 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:13:56,002 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:14:36,772 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:14:36,777 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:14:36,774 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:14:36,775 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:15:19,141 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:15:19,142 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:15:19,143 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:15:19,138 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:15:59,709 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:15:59,712 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:15:59,712 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 05:15:59,724 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:15:59,726 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:16:03,719 - Avg. fwd time: 33.5697 / Avg. bwd time: 52.2582 / Avg. batch time: 831.9045 (ms) / GPU bubble ratio: 17.46%
[rank2]:2026-01-01 05:16:03,756 - Avg. fwd time: 25.7180 / Avg. bwd time: 29.2052 / Avg. batch time: 893.3106 (ms) / GPU bubble ratio: 50.81%
[rank1]:2026-01-01 05:16:03,801 - Avg. fwd time: 32.6733 / Avg. bwd time: 37.0413 / Avg. batch time: 968.7957 (ms) / GPU bubble ratio: 42.43%
[rank1]:2026-01-01 05:16:03,812 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank3]:2026-01-01 05:16:03,814 -  step: 350  loss: 11.1892  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank2]:2026-01-01 05:16:03,812 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank0]:2026-01-01 05:16:03,809 - Avg. fwd time: 26.0461 / Avg. bwd time: 10.4851 / Avg. batch time: 1012.1308 (ms) / GPU bubble ratio: 71.13%
[rank0]:2026-01-01 05:16:03,812 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank2]:2026-01-01 05:16:40,405 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:16:40,403 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:16:40,407 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:16:40,408 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:17:21,162 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:17:21,159 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:17:21,161 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:17:21,165 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:18:01,693 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:18:01,692 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:18:01,690 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:18:01,696 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:18:42,263 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:18:42,263 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:18:42,266 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:18:42,264 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:19:22,977 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 05:19:22,988 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:19:22,984 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:19:22,985 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:19:22,990 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:19:27,072 - Avg. fwd time: 33.5761 / Avg. bwd time: 52.1958 / Avg. batch time: 831.4699 (ms) / GPU bubble ratio: 17.47%
[rank2]:2026-01-01 05:19:27,110 - Avg. fwd time: 25.7128 / Avg. bwd time: 29.1305 / Avg. batch time: 892.7721 (ms) / GPU bubble ratio: 50.86%
[rank2]:2026-01-01 05:19:27,166 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank1]:2026-01-01 05:19:27,155 - Avg. fwd time: 32.6655 / Avg. bwd time: 36.9520 / Avg. batch time: 968.1358 (ms) / GPU bubble ratio: 42.47%
[rank1]:2026-01-01 05:19:27,166 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank0]:2026-01-01 05:19:27,163 - Avg. fwd time: 26.0314 / Avg. bwd time: 9.1749 / Avg. batch time: 1010.1353 (ms) / GPU bubble ratio: 72.12%
[rank0]:2026-01-01 05:19:27,166 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank3]:2026-01-01 05:19:27,168 -  step: 400  loss: 10.2841  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank2]:2026-01-01 05:19:27,219 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0519_stage2_step400.svg
[rank1]:2026-01-01 05:19:27,220 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0519_stage1_step400.svg
[rank0]:2026-01-01 05:19:27,221 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0519_stage0_step400.svg
[rank3]:2026-01-01 05:19:27,312 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0519_step400_rank3.svg
[rank3]:			> Batch Time: 997.50 ms, GPU Bubble Ratio: 79.20%, 44.69%, 56.43%, 31.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-25-25ms      | [S0,MB1,F]  25-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  273-0-273ms    | [S0,MB4,F]  273-25-298ms   | [S0,MB1,B]  378-0-378ms    | [S0,MB5,F]  378-25-403ms   | [S0,MB2,B]  483-0-483ms    | [S0,MB6,F]  483-25-508ms   | [S0,MB3,B]  588-0-588ms    | [S0,MB7,F]  588-25-613ms   | [S0,MB4,B]  693-0-693ms    | [S0,MB5,B]  794-0-794ms    | [S0,MB6,B]  895-0-895ms    | [S0,MB7,B]  997-0-997ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  25-31-57ms     | [S1,MB1,F]  64-32-96ms     | [S1,MB2,F]  103-32-136ms   | [S1,MB0,B]  226-36-262ms   | [S1,MB3,F]  270-32-302ms   | [S1,MB1,B]  331-36-368ms   | [S1,MB4,F]  375-32-407ms   | [S1,MB2,B]  436-36-472ms   | [S1,MB5,F]  479-32-512ms   | [S1,MB3,B]  540-36-577ms   | [S1,MB6,F]  584-32-617ms   | [S1,MB4,B]  646-36-682ms   | [S1,MB7,F]  689-32-722ms   | [S1,MB5,B]  751-36-787ms   | [S1,MB6,B]  852-36-889ms   | [S1,MB7,B]  954-36-991ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-83ms     | [S2,MB1,F]  96-25-122ms    | [S2,MB0,B]  187-28-216ms   | [S2,MB2,F]  223-25-249ms   | [S2,MB1,B]  292-28-321ms   | [S2,MB3,F]  328-25-354ms   | [S2,MB2,B]  397-28-425ms   | [S2,MB4,F]  432-25-458ms   | [S2,MB3,B]  502-28-530ms   | [S2,MB5,F]  537-25-563ms   | [S2,MB4,B]  607-28-635ms   | [S2,MB6,F]  643-25-669ms   | [S2,MB5,B]  712-28-741ms   | [S2,MB7,F]  748-25-774ms   | [S2,MB6,B]  818-28-846ms   | [S2,MB7,B]  919-28-948ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-114ms    | [S3,MB0,B]  126-51-177ms   | [S3,MB1,F]  184-33-218ms   | [S3,MB1,B]  229-52-282ms   | [S3,MB2,F]  289-34-323ms   | [S3,MB2,B]  335-51-386ms   | [S3,MB3,F]  394-33-427ms   | [S3,MB3,B]  440-51-491ms   | [S3,MB4,F]  499-34-533ms   | [S3,MB4,B]  545-51-597ms   | [S3,MB5,F]  604-34-638ms   | [S3,MB5,B]  650-52-702ms   | [S3,MB6,F]  709-34-743ms   | [S3,MB6,B]  756-52-808ms   | [S3,MB7,F]  815-34-849ms   | [S3,MB7,B]  861-51-913ms  
[rank3]:2026-01-01 05:19:27,362 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0519_stage3_step400.svg
[rank0]:2026-01-01 05:19:27,398 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0519_rank0_stage0.svg
[rank0]:	> Counts Sum: 1568, Total Sum: 1960 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank2]:2026-01-01 05:19:27,383 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0519_rank2_stage2.svg
[rank2]:	> Counts Sum: 1568, Total Sum: 1960 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank1]:2026-01-01 05:19:27,400 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0519_rank1_stage1.svg
[rank1]:	> Counts Sum: 1960, Total Sum: 2450 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank3]:2026-01-01 05:19:27,510 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0519_rank3_stage3.svg
[rank3]:	> Counts Sum: 1176, Total Sum: 1470 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank3]:2026-01-01 05:19:50,364 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 05:19:50,578 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 05:19:50,618 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 05:19:50,618 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2026-01-01 05:20:03,968 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:20:03,970 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:20:03,973 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:20:03,972 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:20:46,238 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:20:46,229 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:20:46,232 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:20:46,230 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:21:26,691 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:21:26,693 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:21:26,696 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:21:26,694 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:22:07,346 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:22:07,348 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:22:07,351 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:22:07,349 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:22:48,080 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 05:22:48,077 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:22:48,080 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:22:48,095 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:22:48,093 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:22:52,024 - Avg. fwd time: 33.5759 / Avg. bwd time: 52.1749 / Avg. batch time: 831.3013 (ms) / GPU bubble ratio: 17.48%
[rank3]:2026-01-01 05:22:52,121 -  step: 450  loss: 12.7481  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,994  tflops: 62.49  mfu: 20.03%
[rank2]:2026-01-01 05:22:52,063 - Avg. fwd time: 25.7097 / Avg. bwd time: 29.1071 / Avg. batch time: 892.5722 (ms) / GPU bubble ratio: 50.87%
[rank2]:2026-01-01 05:22:52,119 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,994  tflops: 62.49  mfu: 20.03%
[rank1]:2026-01-01 05:22:52,108 - Avg. fwd time: 32.6596 / Avg. bwd time: 36.9218 / Avg. batch time: 967.8874 (ms) / GPU bubble ratio: 42.49%
[rank1]:2026-01-01 05:22:52,119 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,994  tflops: 62.49  mfu: 20.03%
[rank0]:2026-01-01 05:22:52,116 - Avg. fwd time: 26.0239 / Avg. bwd time: 8.7879 / Avg. batch time: 1009.4806 (ms) / GPU bubble ratio: 72.41%
[rank0]:2026-01-01 05:22:52,120 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,994  tflops: 62.49  mfu: 20.03%
[rank3]:2026-01-01 05:23:28,646 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:23:28,648 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:23:28,651 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:23:28,649 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:24:09,297 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:24:09,301 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:24:09,302 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:24:09,304 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:24:50,063 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:24:50,065 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:24:50,069 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:24:50,067 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:25:30,944 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:25:30,947 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:25:30,949 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:25:30,942 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:26:11,529 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 05:26:11,538 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:26:11,536 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:26:11,542 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:26:11,545 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:26:15,673 - Avg. fwd time: 25.7044 / Avg. bwd time: 29.0588 / Avg. batch time: 892.2183 (ms) / GPU bubble ratio: 50.90%
[rank3]:2026-01-01 05:26:15,633 - Avg. fwd time: 33.5794 / Avg. bwd time: 52.1350 / Avg. batch time: 831.0186 (ms) / GPU bubble ratio: 17.49%
[rank1]:2026-01-01 05:26:15,720 - Avg. fwd time: 32.6499 / Avg. bwd time: 36.8615 / Avg. batch time: 967.4462 (ms) / GPU bubble ratio: 42.52%
[rank2]:2026-01-01 05:26:15,761 -  step: 500  loss: -4.0000  grad_norm:  7.5510  memory:  7.28GiB(15.33%)  tps: 8,046  tflops: 62.90  mfu: 20.16%
[rank3]:2026-01-01 05:26:15,763 -  step: 500  loss: 12.9581  grad_norm:  7.5510  memory: 20.98GiB(44.15%)  tps: 8,046  tflops: 62.90  mfu: 20.16%
[rank1]:2026-01-01 05:26:15,761 -  step: 500  loss: -4.0000  grad_norm:  7.5510  memory: 12.11GiB(25.49%)  tps: 8,046  tflops: 62.90  mfu: 20.16%
[rank1]:2026-01-01 05:26:15,813 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0526_stage1_step500.svg
[rank0]:2026-01-01 05:26:15,757 - Avg. fwd time: 26.0154 / Avg. bwd time: 7.9661 / Avg. batch time: 1008.2264 (ms) / GPU bubble ratio: 73.04%
[rank0]:2026-01-01 05:26:15,762 -  step: 500  loss: -4.0000  grad_norm:  7.5510  memory: 13.13GiB(27.64%)  tps: 8,046  tflops: 62.90  mfu: 20.16%
[rank0]:2026-01-01 05:26:15,815 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0526_stage0_step500.svg
[rank2]:2026-01-01 05:26:15,813 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0526_stage2_step500.svg
[rank2]:2026-01-01 05:26:15,984 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0526_rank2_stage2.svg
[rank2]:	> Counts Sum: 2016, Total Sum: 2520 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank3]:2026-01-01 05:26:15,904 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0526_step500_rank3.svg
[rank3]:			> Batch Time: 996.00 ms, GPU Bubble Ratio: 79.16%, 44.76%, 56.45%, 31.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-26-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  273-0-273ms    | [S0,MB4,F]  273-25-298ms   | [S0,MB1,B]  377-0-377ms    | [S0,MB5,F]  377-25-402ms   | [S0,MB2,B]  481-0-481ms    | [S0,MB6,F]  481-25-506ms   | [S0,MB3,B]  587-0-587ms    | [S0,MB7,F]  587-25-612ms   | [S0,MB4,B]  693-0-693ms    | [S0,MB5,B]  794-0-794ms    | [S0,MB6,B]  895-0-895ms    | [S0,MB7,B]  996-0-996ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-31-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-136ms   | [S1,MB0,B]  226-36-262ms   | [S1,MB3,F]  269-32-302ms   | [S1,MB1,B]  330-36-366ms   | [S1,MB4,F]  373-32-406ms   | [S1,MB2,B]  434-36-471ms   | [S1,MB5,F]  478-32-511ms   | [S1,MB3,B]  539-36-576ms   | [S1,MB6,F]  583-32-616ms   | [S1,MB4,B]  645-36-681ms   | [S1,MB7,F]  689-32-722ms   | [S1,MB5,B]  750-36-787ms   | [S1,MB6,B]  851-36-887ms   | [S1,MB7,B]  952-36-988ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-122ms    | [S2,MB0,B]  187-28-216ms   | [S2,MB2,F]  223-25-249ms   | [S2,MB1,B]  290-28-319ms   | [S2,MB3,F]  327-25-353ms   | [S2,MB2,B]  395-28-424ms   | [S2,MB4,F]  431-25-457ms   | [S2,MB3,B]  500-28-529ms   | [S2,MB5,F]  536-25-562ms   | [S2,MB4,B]  606-28-634ms   | [S2,MB6,F]  642-25-667ms   | [S2,MB5,B]  710-28-739ms   | [S2,MB7,F]  747-25-773ms   | [S2,MB6,B]  815-28-843ms   | [S2,MB7,B]  917-28-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-114ms    | [S3,MB0,B]  126-50-177ms   | [S3,MB1,F]  184-32-217ms   | [S3,MB1,B]  229-51-280ms   | [S3,MB2,F]  287-33-321ms   | [S3,MB2,B]  333-51-384ms   | [S3,MB3,F]  392-33-426ms   | [S3,MB3,B]  438-51-489ms   | [S3,MB4,F]  497-33-531ms   | [S3,MB4,B]  543-52-595ms   | [S3,MB5,F]  602-34-636ms   | [S3,MB5,B]  648-52-700ms   | [S3,MB6,F]  707-34-741ms   | [S3,MB6,B]  752-52-804ms   | [S3,MB7,F]  812-33-846ms   | [S3,MB7,B]  857-51-909ms  
[rank3]:2026-01-01 05:26:15,947 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0526_stage3_step500.svg
[rank1]:2026-01-01 05:26:15,999 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0526_rank1_stage1.svg
[rank1]:	> Counts Sum: 2520, Total Sum: 3150 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank0]:2026-01-01 05:26:15,994 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0526_rank0_stage0.svg
[rank0]:	> Counts Sum: 2016, Total Sum: 2520 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank3]:2026-01-01 05:26:16,086 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0526_rank3_stage3.svg
[rank3]:	> Counts Sum: 1512, Total Sum: 1890 (80.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank2]:2026-01-01 05:26:54,211 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:26:54,208 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:26:54,213 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:26:54,211 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:27:34,925 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:27:34,923 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:27:34,922 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:27:34,920 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:28:15,683 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:28:15,681 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:28:15,680 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:28:15,678 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:28:56,194 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:28:56,192 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:28:56,197 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:28:56,195 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:29:36,803 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:29:36,788 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 05:29:36,801 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:29:36,788 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:29:36,786 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:29:40,851 - Avg. fwd time: 25.7031 / Avg. bwd time: 29.0437 / Avg. batch time: 892.1603 (ms) / GPU bubble ratio: 50.91%
[rank3]:2026-01-01 05:29:40,812 - Avg. fwd time: 33.5837 / Avg. bwd time: 52.1266 / Avg. batch time: 830.9888 (ms) / GPU bubble ratio: 17.49%
[rank1]:2026-01-01 05:29:40,896 - Avg. fwd time: 32.6482 / Avg. bwd time: 36.8431 / Avg. batch time: 967.3565 (ms) / GPU bubble ratio: 42.53%
[rank1]:2026-01-01 05:29:40,908 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank0]:2026-01-01 05:29:40,905 - Avg. fwd time: 26.0125 / Avg. bwd time: 7.7081 / Avg. batch time: 1007.8700 (ms) / GPU bubble ratio: 73.23%
[rank0]:2026-01-01 05:29:40,908 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank2]:2026-01-01 05:29:40,908 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,987  tflops: 62.43  mfu: 20.01%
[rank3]:2026-01-01 05:29:40,910 -  step: 550  loss: 11.0990  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,987  tflops: 62.44  mfu: 20.01%
[rank1]:2026-01-01 05:30:17,572 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:30:17,570 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:30:17,569 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:30:17,567 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:30:58,383 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:30:58,381 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:30:58,379 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:30:58,378 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:31:38,969 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:31:38,966 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:31:38,968 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:31:38,964 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:32:19,562 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:32:19,567 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:32:19,564 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:32:19,565 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:33:00,265 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:33:00,269 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:33:00,256 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 05:33:00,268 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:33:00,263 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:33:04,512 - Avg. fwd time: 33.5917 / Avg. bwd time: 52.1049 / Avg. batch time: 830.8861 (ms) / GPU bubble ratio: 17.49%
[rank2]:2026-01-01 05:33:04,552 - Avg. fwd time: 25.7012 / Avg. bwd time: 29.0101 / Avg. batch time: 892.0098 (ms) / GPU bubble ratio: 50.93%
[rank1]:2026-01-01 05:33:04,600 - Avg. fwd time: 32.6445 / Avg. bwd time: 36.8023 / Avg. batch time: 967.1514 (ms) / GPU bubble ratio: 42.56%
[rank2]:2026-01-01 05:33:04,642 -  step: 600  loss: -4.0000  grad_norm: 34.2349  memory:  7.28GiB(15.33%)  tps: 8,042  tflops: 62.87  mfu: 20.15%
[rank2]:2026-01-01 05:33:04,694 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0533_stage2_step600.svg
[rank1]:2026-01-01 05:33:04,642 -  step: 600  loss: -4.0000  grad_norm: 34.2349  memory: 12.11GiB(25.49%)  tps: 8,042  tflops: 62.87  mfu: 20.15%
[rank1]:2026-01-01 05:33:04,693 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0533_stage1_step600.svg
[rank0]:2026-01-01 05:33:04,639 - Avg. fwd time: 26.0056 / Avg. bwd time: 7.1139 / Avg. batch time: 1007.0577 (ms) / GPU bubble ratio: 73.69%
[rank0]:2026-01-01 05:33:04,643 -  step: 600  loss: -4.0000  grad_norm: 34.2349  memory: 13.13GiB(27.64%)  tps: 8,042  tflops: 62.87  mfu: 20.15%
[rank0]:2026-01-01 05:33:04,693 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0533_stage0_step600.svg
[rank3]:2026-01-01 05:33:04,644 -  step: 600  loss: 10.0152  grad_norm: 34.2349  memory: 20.98GiB(44.15%)  tps: 8,042  tflops: 62.87  mfu: 20.15%
[rank3]:2026-01-01 05:33:04,783 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0533_step600_rank3.svg
[rank3]:			> Batch Time: 995.50 ms, GPU Bubble Ratio: 79.16%, 44.61%, 56.36%, 31.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-25-25ms      | [S0,MB1,F]  25-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  272-0-272ms    | [S0,MB4,F]  272-25-297ms   | [S0,MB1,B]  377-0-377ms    | [S0,MB5,F]  377-25-402ms   | [S0,MB2,B]  482-0-482ms    | [S0,MB6,F]  482-25-507ms   | [S0,MB3,B]  587-0-587ms    | [S0,MB7,F]  587-25-612ms   | [S0,MB4,B]  692-0-692ms    | [S0,MB5,B]  793-0-793ms    | [S0,MB6,B]  893-0-893ms    | [S0,MB7,B]  995-0-995ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  25-31-57ms     | [S1,MB1,F]  64-32-96ms     | [S1,MB2,F]  103-32-136ms   | [S1,MB0,B]  226-36-262ms   | [S1,MB3,F]  269-32-301ms   | [S1,MB1,B]  330-36-366ms   | [S1,MB4,F]  373-32-406ms   | [S1,MB2,B]  435-36-471ms   | [S1,MB5,F]  478-32-511ms   | [S1,MB3,B]  539-36-576ms   | [S1,MB6,F]  583-32-616ms   | [S1,MB4,B]  645-36-682ms   | [S1,MB7,F]  689-32-722ms   | [S1,MB5,B]  750-36-786ms   | [S1,MB6,B]  850-36-886ms   | [S1,MB7,B]  952-36-989ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-83ms     | [S2,MB1,F]  96-25-122ms    | [S2,MB0,B]  186-28-215ms   | [S2,MB2,F]  222-25-248ms   | [S2,MB1,B]  291-28-320ms   | [S2,MB3,F]  327-25-353ms   | [S2,MB2,B]  396-28-425ms   | [S2,MB4,F]  432-25-457ms   | [S2,MB3,B]  501-28-529ms   | [S2,MB5,F]  536-25-562ms   | [S2,MB4,B]  606-28-635ms   | [S2,MB6,F]  642-25-668ms   | [S2,MB5,B]  711-28-740ms   | [S2,MB7,F]  747-25-773ms   | [S2,MB6,B]  816-28-844ms   | [S2,MB7,B]  917-28-946ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-114ms    | [S3,MB0,B]  126-50-177ms   | [S3,MB1,F]  184-33-217ms   | [S3,MB1,B]  229-51-281ms   | [S3,MB2,F]  288-33-322ms   | [S3,MB2,B]  334-51-386ms   | [S3,MB3,F]  393-34-427ms   | [S3,MB3,B]  439-51-491ms   | [S3,MB4,F]  498-34-532ms   | [S3,MB4,B]  544-52-596ms   | [S3,MB5,F]  604-34-638ms   | [S3,MB5,B]  650-51-701ms   | [S3,MB6,F]  708-34-742ms   | [S3,MB6,B]  754-52-806ms   | [S3,MB7,F]  813-34-847ms   | [S3,MB7,B]  859-52-911ms  
[rank3]:2026-01-01 05:33:04,827 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0533_stage3_step600.svg
[rank2]:2026-01-01 05:33:04,873 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0533_rank2_stage2.svg
[rank2]:	> Counts Sum: 2520, Total Sum: 3080 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank1]:2026-01-01 05:33:04,879 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0533_rank1_stage1.svg
[rank1]:	> Counts Sum: 3150, Total Sum: 3850 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank0]:2026-01-01 05:33:04,861 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0533_rank0_stage0.svg
[rank0]:	> Counts Sum: 2520, Total Sum: 3080 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank3]:2026-01-01 05:33:04,965 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0533_rank3_stage3.svg
[rank3]:	> Counts Sum: 1890, Total Sum: 2310 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank1]:2026-01-01 05:33:43,121 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:33:43,118 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:33:43,120 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:33:43,116 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:34:23,616 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:34:23,619 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:34:23,621 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:34:23,618 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:35:04,262 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:35:04,266 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:35:04,267 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:35:04,264 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:35:45,045 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:35:45,048 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:35:45,050 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:35:45,047 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:36:25,868 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:36:25,866 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:36:25,868 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 05:36:25,881 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:36:25,883 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:36:29,874 - Avg. fwd time: 25.7008 / Avg. bwd time: 29.0012 / Avg. batch time: 892.0073 (ms) / GPU bubble ratio: 50.94%
[rank3]:2026-01-01 05:36:29,835 - Avg. fwd time: 33.5956 / Avg. bwd time: 52.1023 / Avg. batch time: 830.8972 (ms) / GPU bubble ratio: 17.49%
[rank0]:2026-01-01 05:36:29,929 - Avg. fwd time: 26.0031 / Avg. bwd time: 6.9613 / Avg. batch time: 1006.8727 (ms) / GPU bubble ratio: 73.81%
[rank0]:2026-01-01 05:36:29,933 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank1]:2026-01-01 05:36:29,920 - Avg. fwd time: 32.6431 / Avg. bwd time: 36.7918 / Avg. batch time: 967.1286 (ms) / GPU bubble ratio: 42.56%
[rank1]:2026-01-01 05:36:29,932 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank2]:2026-01-01 05:36:29,932 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank3]:2026-01-01 05:36:29,935 -  step: 650  loss: 12.3055  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,981  tflops: 62.39  mfu: 20.00%
[rank2]:2026-01-01 05:37:06,520 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:37:06,518 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:37:06,521 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:37:06,524 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:37:47,116 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:37:47,118 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:37:47,114 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:37:47,112 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:38:27,820 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:38:27,817 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:38:27,814 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:38:27,818 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:39:08,626 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:39:08,624 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:39:08,619 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:39:08,621 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:39:49,247 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:39:49,245 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:39:49,238 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 05:39:49,254 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:39:49,252 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:39:53,236 - Avg. fwd time: 25.6979 / Avg. bwd time: 28.9719 / Avg. batch time: 891.7890 (ms) / GPU bubble ratio: 50.96%
[rank3]:2026-01-01 05:39:53,196 - Avg. fwd time: 33.5973 / Avg. bwd time: 52.0777 / Avg. batch time: 830.7196 (ms) / GPU bubble ratio: 17.49%
[rank0]:2026-01-01 05:39:53,292 - Avg. fwd time: 25.9971 / Avg. bwd time: 6.4643 / Avg. batch time: 1006.1019 (ms) / GPU bubble ratio: 74.19%
[rank0]:2026-01-01 05:39:53,296 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 8,057  tflops: 62.98  mfu: 20.19%
[rank1]:2026-01-01 05:39:53,282 - Avg. fwd time: 32.6371 / Avg. bwd time: 36.7557 / Avg. batch time: 966.8598 (ms) / GPU bubble ratio: 42.58%
[rank1]:2026-01-01 05:39:53,296 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 8,057  tflops: 62.98  mfu: 20.19%
[rank2]:2026-01-01 05:39:53,296 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 8,057  tflops: 62.98  mfu: 20.19%
[rank2]:2026-01-01 05:39:53,349 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0539_stage2_step700.svg
[rank3]:2026-01-01 05:39:53,298 -  step: 700  loss: 13.1112  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 8,057  tflops: 62.98  mfu: 20.19%
[rank0]:2026-01-01 05:39:53,352 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0539_stage0_step700.svg
[rank1]:2026-01-01 05:39:53,349 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0539_stage1_step700.svg
[rank3]:2026-01-01 05:39:53,434 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0539_step700_rank3.svg
[rank3]:			> Batch Time: 991.00 ms, GPU Bubble Ratio: 79.08%, 44.61%, 56.30%, 31.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-26-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  272-0-272ms    | [S0,MB4,F]  272-25-297ms   | [S0,MB1,B]  377-0-377ms    | [S0,MB5,F]  377-24-401ms   | [S0,MB2,B]  480-0-480ms    | [S0,MB6,F]  480-25-505ms   | [S0,MB3,B]  585-0-585ms    | [S0,MB7,F]  585-25-610ms   | [S0,MB4,B]  690-0-690ms    | [S0,MB5,B]  789-0-789ms    | [S0,MB6,B]  890-0-890ms    | [S0,MB7,B]  991-0-991ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-31-57ms     | [S1,MB1,F]  64-32-96ms     | [S1,MB2,F]  103-32-136ms   | [S1,MB0,B]  226-35-262ms   | [S1,MB3,F]  269-32-301ms   | [S1,MB1,B]  330-36-366ms   | [S1,MB4,F]  373-32-406ms   | [S1,MB2,B]  433-36-470ms   | [S1,MB5,F]  476-32-509ms   | [S1,MB3,B]  538-36-575ms   | [S1,MB6,F]  582-32-614ms   | [S1,MB4,B]  643-36-679ms   | [S1,MB7,F]  686-32-719ms   | [S1,MB5,B]  746-36-782ms   | [S1,MB6,B]  847-36-883ms   | [S1,MB7,B]  948-36-984ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-83ms     | [S2,MB1,F]  97-25-122ms    | [S2,MB0,B]  187-28-215ms   | [S2,MB2,F]  223-25-248ms   | [S2,MB1,B]  291-28-319ms   | [S2,MB3,F]  326-25-352ms   | [S2,MB2,B]  395-28-423ms   | [S2,MB4,F]  430-25-456ms   | [S2,MB3,B]  499-28-528ms   | [S2,MB5,F]  535-25-561ms   | [S2,MB4,B]  604-28-633ms   | [S2,MB6,F]  639-25-665ms   | [S2,MB5,B]  707-28-736ms   | [S2,MB7,F]  743-25-769ms   | [S2,MB6,B]  812-28-841ms   | [S2,MB7,B]  912-28-941ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-114ms    | [S3,MB0,B]  126-50-177ms   | [S3,MB1,F]  184-32-217ms   | [S3,MB1,B]  229-51-280ms   | [S3,MB2,F]  288-33-321ms   | [S3,MB2,B]  333-51-385ms   | [S3,MB3,F]  392-33-426ms   | [S3,MB3,B]  437-51-488ms   | [S3,MB4,F]  496-33-530ms   | [S3,MB4,B]  542-51-594ms   | [S3,MB5,F]  601-33-635ms   | [S3,MB5,B]  646-51-698ms   | [S3,MB6,F]  704-33-738ms   | [S3,MB6,B]  750-52-802ms   | [S3,MB7,F]  809-33-843ms   | [S3,MB7,B]  854-51-906ms  
[rank1]:2026-01-01 05:39:53,531 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0539_rank1_stage1.svg
[rank1]:	> Counts Sum: 3850, Total Sum: 4550 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank2]:2026-01-01 05:39:53,517 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0539_rank2_stage2.svg
[rank2]:	> Counts Sum: 3080, Total Sum: 3640 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank3]:2026-01-01 05:39:53,479 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0539_stage3_step700.svg
[rank0]:2026-01-01 05:39:53,529 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0539_rank0_stage0.svg
[rank0]:	> Counts Sum: 3080, Total Sum: 3640 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank3]:2026-01-01 05:39:53,617 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0539_rank3_stage3.svg
[rank3]:	> Counts Sum: 2310, Total Sum: 2730 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank0]:2026-01-01 05:40:30,149 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:40:30,152 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:40:30,148 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:40:30,146 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:41:12,649 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:41:12,646 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:41:12,655 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:41:12,652 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:41:53,482 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:41:53,478 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:41:53,476 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:41:53,484 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:42:34,050 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:42:34,047 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:42:34,045 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:42:34,052 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:43:14,679 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2026-01-01 05:43:14,693 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:43:14,678 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:43:14,676 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:43:14,695 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:43:18,711 - Avg. fwd time: 33.5975 / Avg. bwd time: 52.0744 / Avg. batch time: 830.6956 (ms) / GPU bubble ratio: 17.49%
[rank1]:2026-01-01 05:43:18,798 - Avg. fwd time: 32.6360 / Avg. bwd time: 36.7519 / Avg. batch time: 966.8178 (ms) / GPU bubble ratio: 42.58%
[rank1]:2026-01-01 05:43:18,811 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 7,972  tflops: 62.32  mfu: 19.98%
[rank2]:2026-01-01 05:43:18,751 - Avg. fwd time: 25.6980 / Avg. bwd time: 28.9690 / Avg. batch time: 891.7559 (ms) / GPU bubble ratio: 50.96%
[rank2]:2026-01-01 05:43:18,811 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 7,972  tflops: 62.32  mfu: 19.98%
[rank3]:2026-01-01 05:43:18,813 -  step: 750  loss: 11.0736  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 7,972  tflops: 62.32  mfu: 19.98%
[rank0]:2026-01-01 05:43:18,808 - Avg. fwd time: 25.9986 / Avg. bwd time: 6.4133 / Avg. batch time: 1006.0250 (ms) / GPU bubble ratio: 74.23%
[rank0]:2026-01-01 05:43:18,812 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 7,972  tflops: 62.32  mfu: 19.98%
[rank2]:2026-01-01 05:43:55,478 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:43:55,476 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:43:55,484 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:43:55,480 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:44:36,312 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:44:36,308 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:44:36,307 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:44:36,310 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:45:16,952 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:45:16,956 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:45:16,954 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:45:16,955 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:45:57,581 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:45:57,586 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:45:57,582 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:45:57,584 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:46:38,373 - Freezing Ratio: [Stage3] 1.00, Threshold: 1.0000e-02
[rank1]:2026-01-01 05:46:38,379 - Freezing Ratio: [Stage1] 1.00, Threshold: 1.0000e-02
[rank2]:2026-01-01 05:46:38,375 - Freezing Ratio: [Stage2] 1.00, Threshold: 1.0000e-02
[rank0]:2026-01-01 05:46:38,366 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 05:46:38,378 - Freezing Ratio: [Stage0] 1.00, Threshold: 1.0000e-02
[rank3]:2026-01-01 05:46:42,479 - Avg. fwd time: 33.6029 / Avg. bwd time: 52.0599 / Avg. batch time: 830.6278 (ms) / GPU bubble ratio: 17.50%
[rank3]:2026-01-01 05:46:42,589 -  step: 800  loss:  9.8078  grad_norm:  0.0000  memory: 20.98GiB(44.15%)  tps: 8,040  tflops: 62.86  mfu: 20.15%
[rank3]:2026-01-01 05:46:42,589 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm:  0.0000  tps: 8,474  tflops: 66.24  mfu: 19.43%
[rank3]:2026-01-01 05:46:42,590 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 05:46:42,591 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 05:46:42,567 - Avg. fwd time: 32.6334 / Avg. bwd time: 36.7245 / Avg. batch time: 966.6827 (ms) / GPU bubble ratio: 42.60%
[rank1]:2026-01-01 05:46:42,586 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 12.11GiB(25.49%)  tps: 8,040  tflops: 62.85  mfu: 20.15%
[rank1]:2026-01-01 05:46:42,586 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 8,467  tflops: 66.19  mfu: 19.29%
[rank1]:2026-01-01 05:46:42,586 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 05:46:42,587 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 05:46:42,519 - Avg. fwd time: 25.6972 / Avg. bwd time: 28.9463 / Avg. batch time: 891.6572 (ms) / GPU bubble ratio: 50.97%
[rank2]:2026-01-01 05:46:42,586 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory:  7.28GiB(15.33%)  tps: 8,040  tflops: 62.85  mfu: 20.15%
[rank2]:2026-01-01 05:46:42,586 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 8,467  tflops: 66.19  mfu: 19.28%
[rank2]:2026-01-01 05:46:42,587 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 05:46:42,587 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 05:46:42,582 - Avg. fwd time: 25.9948 / Avg. bwd time: 6.0127 / Avg. batch time: 1005.4870 (ms) / GPU bubble ratio: 74.53%
[rank0]:2026-01-01 05:46:42,587 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 13.13GiB(27.64%)  tps: 8,040  tflops: 62.85  mfu: 20.15%
[rank0]:2026-01-01 05:46:42,587 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 8,467  tflops: 66.19  mfu: 19.29%
[rank0]:2026-01-01 05:46:42,587 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 05:46:42,588 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 05:46:44,815 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2026-01-01 05:46:44,881 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank1/260101_0546_stage1_final800.svg
[rank2]:2026-01-01 05:46:44,880 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank2/260101_0546_stage2_final800.svg
[rank0]:2026-01-01 05:46:44,884 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank0/260101_0546_stage0_final800.svg
[rank3]:2026-01-01 05:46:44,965 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0546_final800_rank3.svg
[rank3]:			> Batch Time: 998.00 ms, GPU Bubble Ratio: 79.18%, 44.67%, 56.44%, 31.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  274-0-274ms    | [S0,MB4,F]  274-25-299ms   | [S0,MB1,B]  378-0-378ms    | [S0,MB5,F]  379-25-404ms   | [S0,MB2,B]  483-0-483ms    | [S0,MB6,F]  484-25-509ms   | [S0,MB3,B]  588-0-588ms    | [S0,MB7,F]  589-25-614ms   | [S0,MB4,B]  694-0-694ms    | [S0,MB5,B]  795-0-795ms    | [S0,MB6,B]  896-0-896ms    | [S0,MB7,B]  998-0-998ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-31-57ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-136ms   | [S1,MB0,B]  227-36-263ms   | [S1,MB3,F]  270-32-303ms   | [S1,MB1,B]  331-36-368ms   | [S1,MB4,F]  375-32-408ms   | [S1,MB2,B]  436-36-472ms   | [S1,MB5,F]  480-32-513ms   | [S1,MB3,B]  541-36-577ms   | [S1,MB6,F]  585-32-617ms   | [S1,MB4,B]  646-36-683ms   | [S1,MB7,F]  690-32-723ms   | [S1,MB5,B]  751-36-788ms   | [S1,MB6,B]  852-36-888ms   | [S1,MB7,B]  954-36-990ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  57-25-83ms     | [S2,MB1,F]  97-25-122ms    | [S2,MB0,B]  188-28-216ms   | [S2,MB2,F]  224-25-249ms   | [S2,MB1,B]  292-28-320ms   | [S2,MB3,F]  328-25-354ms   | [S2,MB2,B]  396-28-425ms   | [S2,MB4,F]  433-25-458ms   | [S2,MB3,B]  501-28-530ms   | [S2,MB5,F]  537-25-563ms   | [S2,MB4,B]  606-28-635ms   | [S2,MB6,F]  643-25-669ms   | [S2,MB5,B]  712-28-741ms   | [S2,MB7,F]  748-25-774ms   | [S2,MB6,B]  817-28-845ms   | [S2,MB7,B]  918-28-947ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-114ms    | [S3,MB0,B]  126-51-177ms   | [S3,MB1,F]  184-33-218ms   | [S3,MB1,B]  229-51-281ms   | [S3,MB2,F]  289-33-322ms   | [S3,MB2,B]  334-51-386ms   | [S3,MB3,F]  393-33-427ms   | [S3,MB3,B]  439-51-491ms   | [S3,MB4,F]  498-33-532ms   | [S3,MB4,B]  544-52-596ms   | [S3,MB5,F]  603-34-637ms   | [S3,MB5,B]  649-52-702ms   | [S3,MB6,F]  709-34-743ms   | [S3,MB6,B]  754-52-806ms   | [S3,MB7,F]  814-34-848ms   | [S3,MB7,B]  860-52-912ms  
[rank1]:2026-01-01 05:46:45,064 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0546_rank1_stage1.svg
[rank1]:	> Counts Sum: 4480, Total Sum: 5250 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank1]:2026-01-01 05:46:45,065 - Destroying the purge thread.
[rank2]:2026-01-01 05:46:45,047 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0546_rank2_stage2.svg
[rank2]:	> Counts Sum: 3584, Total Sum: 4200 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank2]:2026-01-01 05:46:45,047 - Destroying the purge thread.
[rank2]:2026-01-01 05:46:45,110 - Process group destroyed
[rank0]:2026-01-01 05:46:45,067 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0546_rank0_stage0.svg
[rank0]:	> Counts Sum: 3584, Total Sum: 4200 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank0]:2026-01-01 05:46:45,068 - Sleeping 2 seconds for other ranks to complete
[rank3]:2026-01-01 05:46:45,114 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/pipeline_schedule/260101_0546_thry_final800_rank3.svg
[rank3]:			> Batch Time: 971.87 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-29-29ms      | [S0,MB1,F]  29-29-58ms     | [S0,MB2,F]  58-29-88ms     | [S0,MB3,F]  88-29-117ms    | [S0,MB0,B]  294-58-353ms   | [S0,MB4,F]  353-29-382ms   | [S0,MB1,B]  382-58-441ms   | [S0,MB5,F]  441-29-471ms   | [S0,MB2,B]  471-58-530ms   | [S0,MB6,F]  530-29-559ms   | [S0,MB3,B]  559-58-618ms   | [S0,MB7,F]  618-29-647ms   | [S0,MB4,B]  647-58-706ms   | [S0,MB5,B]  736-58-795ms   | [S0,MB6,B]  824-58-883ms   | [S0,MB7,B]  912-58-971ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  29-29-58ms     | [S1,MB1,F]  58-29-88ms     | [S1,MB2,F]  88-29-117ms    | [S1,MB0,B]  235-58-294ms   | [S1,MB3,F]  294-29-323ms   | [S1,MB1,B]  323-58-382ms   | [S1,MB4,F]  382-29-412ms   | [S1,MB2,B]  412-58-471ms   | [S1,MB5,F]  471-29-500ms   | [S1,MB3,B]  500-58-559ms   | [S1,MB6,F]  559-29-589ms   | [S1,MB4,B]  589-58-647ms   | [S1,MB7,F]  647-29-677ms   | [S1,MB5,B]  677-58-736ms   | [S1,MB6,B]  765-58-824ms   | [S1,MB7,B]  854-58-912ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-29-88ms     | [S2,MB1,F]  88-29-117ms    | [S2,MB0,B]  176-58-235ms   | [S2,MB2,F]  235-29-265ms   | [S2,MB1,B]  265-58-323ms   | [S2,MB3,F]  323-29-353ms   | [S2,MB2,B]  353-58-412ms   | [S2,MB4,F]  412-29-441ms   | [S2,MB3,B]  441-58-500ms   | [S2,MB5,F]  500-29-530ms   | [S2,MB4,B]  530-58-589ms   | [S2,MB6,F]  589-29-618ms   | [S2,MB5,B]  618-58-677ms   | [S2,MB7,F]  677-29-706ms   | [S2,MB6,B]  706-58-765ms   | [S2,MB7,B]  795-58-854ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  88-29-117ms    | [S3,MB0,B]  117-58-176ms   | [S3,MB1,F]  176-29-206ms   | [S3,MB1,B]  206-58-265ms   | [S3,MB2,F]  265-29-294ms   | [S3,MB2,B]  294-58-353ms   | [S3,MB3,F]  353-29-382ms   | [S3,MB3,B]  382-58-441ms   | [S3,MB4,F]  441-29-471ms   | [S3,MB4,B]  471-58-530ms   | [S3,MB5,F]  530-29-559ms   | [S3,MB5,B]  559-58-618ms   | [S3,MB6,F]  618-29-647ms   | [S3,MB6,B]  647-58-706ms   | [S3,MB7,F]  706-29-736ms   | [S3,MB7,B]  736-58-795ms  
[rank3]:2026-01-01 05:46:45,162 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_ratio_history/rank3/260101_0546_stage3_final800.svg
[rank1]:2026-01-01 05:46:45,105 - Process group destroyed
[rank3]:2026-01-01 05:46:45,303 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1/frozen_params_histogram/260101_0546_rank3_stage3.svg
[rank3]:	> Counts Sum: 2688, Total Sum: 3150 (85.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33]
[rank3]:2026-01-01 05:46:45,304 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 364-384
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–ƒâ–â–ƒâ–ˆâ–â–â–â–â–â–‚â–â–ˆâ–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.86708
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 19.43239
[rank3]:wandb:             final/avg_tflops 66.24253
[rank3]:wandb:    final/avg_throughput(tps) 8473.57831
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_1F1B_apf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/e1eoq5pf
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_1F1B_apf_42_dm1/20260101-0451/wandb/run-20260101_045154-e1eoq5pf/logs
[rank3]:2026-01-01 05:46:46,621 - Process group destroyed
[rank0]:2026-01-01 05:46:47,068 - Training completed
[rank0]:2026-01-01 05:46:47,068 - Destroying the purge thread.
[rank0]:2026-01-01 05:46:47,136 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.1', 'layers.2', 'layers.0', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.4', 'layers.5', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'norm', 'layers.15', 'output', 'layers.14'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_1F1B_apf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_1F1B_apf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_1F1B_apf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_1F1B_apf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_1F1B_apf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_1F1B_apf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_1F1B_apf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_1F1B_apf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
