
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 02:59:25 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_1F1B_timelyauto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with timelyauto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2026-01-01 02:59:32,416 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2026-01-01 02:59:32,491 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank3]:2026-01-01 02:59:32,609 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 02:59:32,611 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-01 02:59:32,640 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank0]:2026-01-01 02:59:32,716 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank2]:2026-01-01 02:59:32,678 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 02:59:32,680 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-01 02:59:32,793 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 02:59:32,796 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 02:59:32,880 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 02:59:32,882 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 02:59:32,885 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 02:59:32,886 - Loading tokenizer from tokenizer.json
[rank0]:2026-01-01 02:59:33,269 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2026-01-01 02:59:36,081 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2026-01-01 02:59:36,224 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 02:59:36,209 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 02:59:36,261 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 02:59:36,262 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 02:59:36,289 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-01 02:59:36,289 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-01 02:59:36,251 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 02:59:36,279 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-01 02:59:36,279 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2026-01-01 02:59:36,343 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 02:59:36,383 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 02:59:36,409 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-01 02:59:36,410 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-01 02:59:36,515 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 02:59:36,516 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 02:59:36,516 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2026-01-01 02:59:36,543 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 02:59:36,543 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 02:59:36,544 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2026-01-01 02:59:36,638 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 02:59:36,638 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 02:59:36,638 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 5q7ixuwz
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_1F1B_timelyauto_42_dm1/20260101-0259/wandb/run-20260101_025937-5q7ixuwz
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_1F1B_timelyauto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/5q7ixuwz
[rank3]:2026-01-01 02:59:38,496 - WandB logging enabled
[rank3]:2026-01-01 02:59:38,496 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 02:59:38,535 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 02:59:38,564 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2026-01-01 02:59:38,565 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2026-01-01 02:59:38,749 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 02:59:38,750 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 02:59:38,751 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2026-01-01 02:59:38,765 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-01 02:59:38,766 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 02:59:38,766 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_1F1B_timelyauto_42_dm1
[rank0]:2026-01-01 02:59:38,766 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 02:59:38,766 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 02:59:38,766 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2026-01-01 02:59:38,765 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 02:59:41,296 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 02:59:41,296 - Finished loading the checkpoint in 2.53 seconds.
[rank0]:2026-01-01 02:59:41,342 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2026-01-01 02:59:41,343 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2026-01-01 02:59:41,343 - Training starts at step 1
[rank2]:2026-01-01 02:59:41,340 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2026-01-01 02:59:41,341 - Freezable Parameters: [Stage 2] 56 params
[rank3]:2026-01-01 02:59:41,354 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2026-01-01 02:59:41,355 - Freezable Parameters: [Stage 3] 42 params
[rank1]:2026-01-01 02:59:41,350 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2026-01-01 02:59:41,351 - Freezable Parameters: [Stage 1] 70 params
[rank0]:2026-01-01 02:59:46,401 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory: 13.12GiB(27.62%)  tps: 3,232  tflops: 25.27  mfu: 8.10%
[rank0]:2026-01-01 02:59:46,401 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 02:59:46,380 -  step:  1  loss: 10.6092  grad_norm:  9.9055  memory: 20.97GiB(44.14%)  tps: 4,178  tflops: 32.66  mfu: 10.47%
[rank3]:2026-01-01 02:59:46,380 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-01 02:59:46,376 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory:  7.27GiB(15.31%)  tps: 3,279  tflops: 25.63  mfu: 8.22%
[rank2]:2026-01-01 02:59:46,377 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 02:59:46,376 -  step:  1  loss: -4.0000  grad_norm:  9.9055  memory: 12.09GiB(25.46%)  tps: 3,236  tflops: 25.30  mfu: 8.11%
[rank1]:2026-01-01 02:59:46,377 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 03:03:09,163 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 03:03:13,245 - Avg. fwd time: 33.4271 / Avg. bwd time: 53.0602 / Avg. batch time: 837.3889 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 03:03:13,282 - Avg. fwd time: 25.8124 / Avg. bwd time: 30.2278 / Avg. batch time: 900.6765 (ms) / GPU bubble ratio: 50.22%
[rank1]:2026-01-01 03:03:13,326 - Avg. fwd time: 32.7745 / Avg. bwd time: 38.2226 / Avg. batch time: 978.3351 (ms) / GPU bubble ratio: 41.94%
[rank3]:2026-01-01 03:03:13,365 -  step: 50  loss: 12.4624  grad_norm:  8.4069  memory: 20.97GiB(44.14%)  tps: 7,757  tflops: 60.64  mfu: 19.44%
[rank2]:2026-01-01 03:03:13,364 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory:  7.27GiB(15.31%)  tps: 7,757  tflops: 60.64  mfu: 19.44%
[rank1]:2026-01-01 03:03:13,364 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 12.09GiB(25.46%)  tps: 7,757  tflops: 60.64  mfu: 19.44%
[rank0]:2026-01-01 03:03:13,360 - Avg. fwd time: 26.2145 / Avg. bwd time: 28.3595 / Avg. batch time: 1040.4310 (ms) / GPU bubble ratio: 58.04%
[rank0]:2026-01-01 03:03:13,364 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 13.12GiB(27.62%)  tps: 7,758  tflops: 60.65  mfu: 19.44%
[rank3]:2026-01-01 03:03:51,254 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2026-01-01 03:04:33,602 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2026-01-01 03:04:33,748 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2026-01-01 03:04:33,789 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2026-01-01 03:04:33,817 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2026-01-01 03:05:16,121 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2026-01-01 03:05:16,358 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2026-01-01 03:06:37,639 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2026-01-01 03:06:37,891 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2026-01-01 03:06:37,910 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 03:06:37,919 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2026-01-01 03:06:37,909 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 03:06:38,048 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0306_max_batch_time.svg
[rank3]:			> Batch Time: 877.30 ms, GPU Bubble Ratio: 50.04%, 35.14%, 48.87%, 20.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  236-28-265ms   | [S0,MB4,F]  265-25-290ms   | [S0,MB1,B]  323-28-352ms   | [S0,MB5,F]  352-25-377ms   | [S0,MB2,B]  410-28-439ms   | [S0,MB6,F]  439-25-465ms   | [S0,MB3,B]  497-28-526ms   | [S0,MB7,F]  526-25-551ms   | [S0,MB4,B]  586-28-614ms   | [S0,MB5,B]  674-28-702ms   | [S0,MB6,B]  761-28-789ms   | [S0,MB7,B]  848-28-877ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-124ms    | [S1,MB0,B]  198-38-236ms   | [S1,MB3,F]  236-32-269ms   | [S1,MB1,B]  285-38-323ms   | [S1,MB4,F]  323-33-356ms   | [S1,MB2,B]  372-38-410ms   | [S1,MB5,F]  410-33-443ms   | [S1,MB3,B]  459-38-497ms   | [S1,MB6,F]  497-33-530ms   | [S1,MB4,B]  547-38-586ms   | [S1,MB7,F]  586-33-619ms   | [S1,MB5,B]  635-38-674ms   | [S1,MB6,B]  723-37-761ms   | [S1,MB7,B]  810-38-848ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  168-30-198ms   | [S2,MB2,F]  198-25-224ms   | [S2,MB1,B]  255-30-285ms   | [S2,MB3,F]  285-25-311ms   | [S2,MB2,B]  342-30-372ms   | [S2,MB4,F]  372-25-398ms   | [S2,MB3,B]  429-30-459ms   | [S2,MB5,F]  459-25-485ms   | [S2,MB4,B]  517-30-547ms   | [S2,MB6,F]  547-25-573ms   | [S2,MB5,B]  605-30-635ms   | [S2,MB7,F]  635-25-661ms   | [S2,MB6,B]  693-30-723ms   | [S2,MB7,B]  780-30-810ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  116-52-168ms   AFR(10):0.9762 | [S3,MB1,F]  168-33-201ms   | [S3,MB1,B]  201-53-255ms   AFR(10):0.9762 | [S3,MB2,F]  255-33-288ms   | [S3,MB2,B]  288-53-342ms   AFR(10):0.9762 | [S3,MB3,F]  342-34-376ms   | [S3,MB3,B]  376-53-429ms   AFR(10):0.9762 | [S3,MB4,F]  429-34-463ms   | [S3,MB4,B]  463-53-517ms   AFR(10):0.9762 | [S3,MB5,F]  517-34-551ms   | [S3,MB5,B]  551-53-605ms   AFR(10):0.9762 | [S3,MB6,F]  605-34-639ms   | [S3,MB6,B]  639-53-693ms   AFR(10):0.9762 | [S3,MB7,F]  693-33-726ms   | [S3,MB7,B]  726-53-780ms   AFR(10):0.9762
[rank3]:2026-01-01 03:06:38,180 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0306_min_batch_time.svg
[rank3]:			> Batch Time: 833.64 ms, GPU Bubble Ratio: 74.78%, 33.68%, 47.68%, 17.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  231-0-231ms    | [S0,MB4,F]  231-25-257ms   | [S0,MB1,B]  317-0-317ms    | [S0,MB5,F]  317-25-342ms   | [S0,MB2,B]  402-0-402ms    | [S0,MB6,F]  402-25-428ms   | [S0,MB3,B]  489-0-489ms    | [S0,MB7,F]  489-25-514ms   | [S0,MB4,B]  575-0-575ms    | [S0,MB5,B]  661-0-661ms    | [S0,MB6,B]  747-0-747ms    | [S0,MB7,B]  833-0-833ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-124ms    | [S1,MB0,B]  195-36-231ms   | [S1,MB3,F]  231-32-264ms   | [S1,MB1,B]  280-36-317ms   | [S1,MB4,F]  317-33-350ms   | [S1,MB2,B]  366-36-402ms   | [S1,MB5,F]  402-33-435ms   | [S1,MB3,B]  452-36-489ms   | [S1,MB6,F]  489-33-522ms   | [S1,MB4,B]  539-36-575ms   | [S1,MB7,F]  575-33-608ms   | [S1,MB5,B]  625-36-661ms   | [S1,MB6,B]  711-36-747ms   | [S1,MB7,B]  797-36-833ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  167-28-195ms   | [S2,MB2,F]  195-25-221ms   | [S2,MB1,B]  252-28-280ms   | [S2,MB3,F]  280-25-306ms   | [S2,MB2,B]  337-28-366ms   | [S2,MB4,F]  366-25-392ms   | [S2,MB3,B]  424-28-452ms   | [S2,MB5,F]  452-25-478ms   | [S2,MB4,B]  510-28-539ms   | [S2,MB6,F]  539-25-564ms   | [S2,MB5,B]  597-28-625ms   | [S2,MB7,F]  625-25-651ms   | [S2,MB6,B]  683-28-711ms   | [S2,MB7,B]  768-28-797ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  116-50-167ms   AFR(10):0.9762 | [S3,MB1,F]  167-33-200ms   | [S3,MB1,B]  200-52-252ms   AFR(10):0.9762 | [S3,MB2,F]  252-33-286ms   | [S3,MB2,B]  286-51-337ms   AFR(10):0.9762 | [S3,MB3,F]  337-34-371ms   | [S3,MB3,B]  371-52-424ms   AFR(10):0.9762 | [S3,MB4,F]  424-34-458ms   | [S3,MB4,B]  458-52-510ms   AFR(10):0.9762 | [S3,MB5,F]  510-34-544ms   | [S3,MB5,B]  544-52-597ms   AFR(10):0.9762 | [S3,MB6,F]  597-34-631ms   | [S3,MB6,B]  631-51-683ms   AFR(10):0.9762 | [S3,MB7,F]  683-33-716ms   | [S3,MB7,B]  716-51-768ms   AFR(10):0.9762
[rank3]:2026-01-01 03:06:38,323 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0306_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 835.30 ms, GPU Bubble Ratio: 50.93%, 32.12%, 46.48%, 17.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  235-28-263ms   | [S0,MB4,F]  263-25-289ms   | [S0,MB1,B]  321-28-350ms   | [S0,MB5,F]  350-25-375ms   | [S0,MB2,B]  407-28-435ms   | [S0,MB6,F]  435-25-461ms   | [S0,MB3,B]  494-28-522ms   | [S0,MB7,F]  522-25-548ms   | [S0,MB4,B]  580-28-609ms   | [S0,MB5,B]  667-28-695ms   | [S0,MB6,B]  752-28-781ms   | [S0,MB7,B]  835-0-835ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-124ms    | [S1,MB0,B]  197-38-235ms   | [S1,MB3,F]  235-32-268ms   | [S1,MB1,B]  283-38-321ms   | [S1,MB4,F]  321-33-354ms   | [S1,MB2,B]  368-38-407ms   | [S1,MB5,F]  407-33-440ms   | [S1,MB3,B]  455-38-494ms   | [S1,MB6,F]  494-33-527ms   | [S1,MB4,B]  542-38-580ms   | [S1,MB7,F]  580-33-613ms   | [S1,MB5,B]  628-38-667ms   | [S1,MB6,B]  715-37-752ms   | [S1,MB7,B]  799-36-835ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  167-30-197ms   | [S2,MB2,F]  197-25-223ms   | [S2,MB1,B]  253-30-283ms   | [S2,MB3,F]  283-25-309ms   | [S2,MB2,B]  338-30-368ms   | [S2,MB4,F]  368-25-394ms   | [S2,MB3,B]  425-30-455ms   | [S2,MB5,F]  455-25-481ms   | [S2,MB4,B]  512-30-542ms   | [S2,MB6,F]  542-25-568ms   | [S2,MB5,B]  598-30-628ms   | [S2,MB7,F]  628-25-654ms   | [S2,MB6,B]  684-30-715ms   | [S2,MB7,B]  770-28-799ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  116-50-167ms   AFR(10):0.9762 | [S3,MB1,F]  167-33-200ms   | [S3,MB1,B]  200-52-253ms   AFR(10):0.9762 | [S3,MB2,F]  253-33-286ms   | [S3,MB2,B]  286-51-338ms   AFR(10):0.9762 | [S3,MB3,F]  338-34-372ms   | [S3,MB3,B]  372-53-425ms   AFR(10):0.9762 | [S3,MB4,F]  425-34-459ms   | [S3,MB4,B]  459-52-512ms   AFR(10):0.9762 | [S3,MB5,F]  512-34-546ms   | [S3,MB5,B]  546-52-598ms   AFR(10):0.9762 | [S3,MB6,F]  598-34-632ms   | [S3,MB6,B]  632-51-684ms   AFR(10):0.9762 | [S3,MB7,F]  684-33-718ms   | [S3,MB7,B]  718-51-770ms   AFR(10):0.9762
[rank3]:2026-01-01 03:06:38,324 - 	> Batch Time: 835.30 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.05)
[rank3]:2026-01-01 03:06:38,328 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 03:06:42,278 - Avg. fwd time: 32.8089 / Avg. bwd time: 37.8544 / Avg. batch time: 977.4895 (ms) / GPU bubble ratio: 42.17%
[rank3]:2026-01-01 03:06:42,200 - Avg. fwd time: 33.5683 / Avg. bwd time: 52.9044 / Avg. batch time: 837.2700 (ms) / GPU bubble ratio: 17.38%
[rank3]:2026-01-01 03:06:42,289 -  step: 100  loss: 13.1176  grad_norm:  6.3474  memory: 20.97GiB(44.14%)  tps: 7,842  tflops: 61.31  mfu: 19.65%
[rank0]:2026-01-01 03:06:42,284 - Avg. fwd time: 26.1772 / Avg. bwd time: 22.6956 / Avg. batch time: 1033.2400 (ms) / GPU bubble ratio: 62.16%
[rank0]:2026-01-01 03:06:42,288 -  step: 100  loss: -4.0000  grad_norm:  6.3474  memory: 13.14GiB(27.66%)  tps: 7,842  tflops: 61.31  mfu: 19.65%
[rank2]:2026-01-01 03:06:42,236 - Avg. fwd time: 25.8278 / Avg. bwd time: 29.9251 / Avg. batch time: 900.6043 (ms) / GPU bubble ratio: 50.48%
[rank2]:2026-01-01 03:06:42,288 -  step: 100  loss: -4.0000  grad_norm:  6.3474  memory:  7.27GiB(15.31%)  tps: 7,842  tflops: 61.31  mfu: 19.65%
[rank1]:2026-01-01 03:06:42,288 -  step: 100  loss: -4.0000  grad_norm:  6.3474  memory: 12.15GiB(25.58%)  tps: 7,842  tflops: 61.31  mfu: 19.65%
[rank1]:2026-01-01 03:06:42,346 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0306_stage1_step100.svg
[rank0]:2026-01-01 03:06:42,346 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0306_stage0_step100.svg
[rank2]:2026-01-01 03:06:42,348 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0306_stage2_step100.svg
[rank3]:2026-01-01 03:06:42,426 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0306_step100_rank3.svg
[rank3]:			> Batch Time: 994.00 ms, GPU Bubble Ratio: 79.11%, 44.50%, 56.18%, 31.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-26-52ms     | [S0,MB2,F]  52-27-80ms     | [S0,MB3,F]  80-26-106ms    | [S0,MB0,B]  274-0-274ms    | [S0,MB4,F]  274-25-299ms   | [S0,MB1,B]  378-0-378ms    | [S0,MB5,F]  378-25-403ms   | [S0,MB2,B]  483-0-483ms    | [S0,MB6,F]  484-25-509ms   | [S0,MB3,B]  588-0-588ms    | [S0,MB7,F]  589-25-614ms   | [S0,MB4,B]  693-0-693ms    | [S0,MB5,B]  793-0-793ms    | [S0,MB6,B]  893-0-893ms    | [S0,MB7,B]  994-0-994ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-136ms   | [S1,MB0,B]  227-36-263ms   | [S1,MB3,F]  271-32-304ms   | [S1,MB1,B]  331-36-368ms   | [S1,MB4,F]  375-32-408ms   | [S1,MB2,B]  436-36-473ms   | [S1,MB5,F]  480-32-512ms   | [S1,MB3,B]  541-36-577ms   | [S1,MB6,F]  584-32-617ms   | [S1,MB4,B]  645-36-681ms   | [S1,MB7,F]  689-32-722ms   | [S1,MB5,B]  749-36-785ms   | [S1,MB6,B]  850-36-886ms   | [S1,MB7,B]  951-36-987ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-28-216ms   | [S2,MB2,F]  224-25-250ms   | [S2,MB1,B]  292-28-321ms   | [S2,MB3,F]  328-25-354ms   | [S2,MB2,B]  397-28-425ms   | [S2,MB4,F]  433-25-459ms   | [S2,MB3,B]  502-28-530ms   | [S2,MB5,F]  537-25-563ms   | [S2,MB4,B]  606-28-634ms   | [S2,MB6,F]  642-25-667ms   | [S2,MB5,B]  710-28-738ms   | [S2,MB7,F]  745-25-771ms   | [S2,MB6,B]  815-28-843ms   | [S2,MB7,B]  916-28-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-50-177ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  229-52-281ms   | [S3,MB2,F]  289-33-322ms   | [S3,MB2,B]  335-51-386ms   | [S3,MB3,F]  393-34-427ms   | [S3,MB3,B]  439-52-492ms   | [S3,MB4,F]  498-34-532ms   | [S3,MB4,B]  544-52-596ms   | [S3,MB5,F]  603-34-637ms   | [S3,MB5,B]  648-52-700ms   | [S3,MB6,F]  706-33-740ms   | [S3,MB6,B]  752-51-804ms   | [S3,MB7,F]  811-33-845ms   | [S3,MB7,B]  857-51-909ms  
[rank3]:2026-01-01 03:06:42,468 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0306_stage3_step100.svg
[rank1]:2026-01-01 03:06:42,531 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0306_rank1_stage1.svg
[rank1]:	> Counts Sum: 44800, Total Sum: 44800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2026-01-01 03:06:42,569 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0306_stage1.svg
[rank0]:2026-01-01 03:06:42,519 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0306_rank0_stage0.svg
[rank0]:	> Counts Sum: 35840, Total Sum: 35840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-01 03:06:42,556 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0306_stage0.svg
[rank2]:2026-01-01 03:06:42,523 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0306_rank2_stage2.svg
[rank2]:	> Counts Sum: 35840, Total Sum: 35840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-01 03:06:42,563 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0306_stage2.svg
[rank3]:2026-01-01 03:06:42,615 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0306_rank3_stage3.svg
[rank3]:	> Counts Sum: 26240, Total Sum: 26880 (97.62%), Ratio(%) per element: [100.0, 100.0, 93.75, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 93.75, 93.75, 93.75, 93.75, 100.0, 87.5, 93.75, 100.0, 87.5, 100.0, 100.0, 100.0, 100.0, 93.75]
[rank3]:2026-01-01 03:06:42,660 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0306_stage3.svg
[rank2]:2026-01-01 03:10:06,664 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank0]:2026-01-01 03:10:06,672 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 03:10:06,677 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2026-01-01 03:10:06,665 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2026-01-01 03:10:06,667 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2026-01-01 03:10:10,783 - Avg. fwd time: 33.6359 / Avg. bwd time: 52.8486 / Avg. batch time: 837.3005 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 03:10:10,819 - Avg. fwd time: 25.8379 / Avg. bwd time: 30.0007 / Avg. batch time: 900.0711 (ms) / GPU bubble ratio: 50.37%
[rank1]:2026-01-01 03:10:10,863 - Avg. fwd time: 32.8284 / Avg. bwd time: 37.9609 / Avg. batch time: 976.5952 (ms) / GPU bubble ratio: 42.01%
[rank1]:2026-01-01 03:10:10,894 -  step: 150  loss: -4.0000  grad_norm:  7.2343  memory: 12.15GiB(25.58%)  tps: 7,854  tflops: 61.40  mfu: 19.68%
[rank3]:2026-01-01 03:10:10,895 -  step: 150  loss: 11.1266  grad_norm:  7.2343  memory: 20.97GiB(44.14%)  tps: 7,854  tflops: 61.40  mfu: 19.68%
[rank2]:2026-01-01 03:10:10,894 -  step: 150  loss: -4.0000  grad_norm:  7.2343  memory:  7.27GiB(15.31%)  tps: 7,854  tflops: 61.40  mfu: 19.68%
[rank0]:2026-01-01 03:10:10,890 - Avg. fwd time: 26.1882 / Avg. bwd time: 24.0902 / Avg. batch time: 1029.8842 (ms) / GPU bubble ratio: 60.94%
[rank0]:2026-01-01 03:10:10,894 -  step: 150  loss: -4.0000  grad_norm:  7.2343  memory: 13.14GiB(27.66%)  tps: 7,854  tflops: 61.40  mfu: 19.68%
[rank3]:2026-01-01 03:13:35,106 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 03:13:35,106 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2026-01-01 03:13:35,105 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 03:13:35,104 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 03:13:35,108 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 03:13:39,205 - Avg. fwd time: 33.6849 / Avg. bwd time: 52.7743 / Avg. batch time: 837.0705 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 03:13:39,241 - Avg. fwd time: 25.8475 / Avg. bwd time: 30.0309 / Avg. batch time: 899.4625 (ms) / GPU bubble ratio: 50.30%
[rank3]:2026-01-01 03:13:39,297 -  step: 200  loss: 10.3045  grad_norm: 33.1358  memory: 20.97GiB(44.14%)  tps: 7,862  tflops: 61.46  mfu: 19.70%
[rank1]:2026-01-01 03:13:39,285 - Avg. fwd time: 32.8439 / Avg. bwd time: 38.0056 / Avg. batch time: 975.7173 (ms) / GPU bubble ratio: 41.91%
[rank1]:2026-01-01 03:13:39,295 -  step: 200  loss: -4.0000  grad_norm: 33.1358  memory: 12.15GiB(25.58%)  tps: 7,862  tflops: 61.46  mfu: 19.70%
[rank2]:2026-01-01 03:13:39,295 -  step: 200  loss: -4.0000  grad_norm: 33.1358  memory:  7.27GiB(15.31%)  tps: 7,862  tflops: 61.46  mfu: 19.70%
[rank2]:2026-01-01 03:13:39,347 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0313_stage2_step200.svg
[rank0]:2026-01-01 03:13:39,292 - Avg. fwd time: 26.2023 / Avg. bwd time: 24.8340 / Avg. batch time: 1028.1169 (ms) / GPU bubble ratio: 60.29%
[rank0]:2026-01-01 03:13:39,296 -  step: 200  loss: -4.0000  grad_norm: 33.1358  memory: 13.14GiB(27.66%)  tps: 7,862  tflops: 61.46  mfu: 19.70%
[rank0]:2026-01-01 03:13:39,348 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0313_stage0_step200.svg
[rank1]:2026-01-01 03:13:39,346 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0313_stage1_step200.svg
[rank3]:2026-01-01 03:13:39,444 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0313_step200_rank3.svg
[rank3]:			> Batch Time: 1015.41 ms, GPU Bubble Ratio: 58.37%, 44.06%, 55.89%, 32.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  385-28-413ms   | [S0,MB5,F]  413-25-439ms   | [S0,MB2,B]  490-28-518ms   | [S0,MB6,F]  518-25-544ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  625-25-650ms   | [S0,MB4,B]  701-28-729ms   | [S0,MB5,B]  803-28-832ms   | [S0,MB6,B]  903-28-932ms   | [S0,MB7,B]  1002-12-1015ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  335-38-374ms   | [S1,MB4,F]  381-33-414ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-32-519ms   | [S1,MB3,B]  547-38-586ms   | [S1,MB6,F]  593-33-626ms   | [S1,MB4,B]  652-38-690ms   | [S1,MB7,F]  698-33-731ms   | [S1,MB5,B]  758-38-797ms   | [S1,MB6,B]  858-37-896ms   | [S1,MB7,B]  959-36-995ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  332-25-358ms   | [S2,MB2,B]  399-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  506-30-536ms   | [S2,MB5,F]  544-25-570ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  649-25-674ms   | [S2,MB5,B]  718-30-748ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  822-30-852ms   | [S2,MB7,B]  924-28-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  292-33-325ms   | [S3,MB2,B]  337-51-389ms   | [S3,MB3,F]  396-34-430ms   | [S3,MB3,B]  443-53-496ms   | [S3,MB4,F]  503-34-538ms   | [S3,MB4,B]  549-52-601ms   | [S3,MB5,F]  608-34-642ms   | [S3,MB5,B]  655-52-707ms   | [S3,MB6,F]  715-34-749ms   | [S3,MB6,B]  760-52-813ms   | [S3,MB7,F]  819-34-853ms   | [S3,MB7,B]  865-52-918ms  
[rank3]:2026-01-01 03:13:39,487 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0313_stage3_step200.svg
[rank1]:2026-01-01 03:13:39,527 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0313_rank1_stage1.svg
[rank1]:	> Counts Sum: 64400, Total Sum: 268800 (23.96%), Ratio(%) per element: [26.04, 26.04, 26.04, 26.04, 25.0, 26.04, 27.08, 25.0, 27.08, 26.04, 27.08, 25.0, 26.04, 26.04, 26.04, 25.0, 25.0, 26.04, 25.0, 25.0, 27.08, 25.0, 25.0, 26.04, 26.04, 25.0, 25.0, 25.0, 23.95, 23.95, 21.87, 20.83, 19.79, 22.91, 22.91, 23.95, 22.91, 21.87, 22.91, 23.95, 26.04, 23.95, 25.0, 21.87, 25.0, 22.91, 23.95, 23.95, 21.87, 21.87, 23.95, 20.83, 20.83, 22.91, 23.95, 22.91, 20.83, 19.79, 23.95, 23.95, 20.83, 22.91, 23.95, 21.87, 22.91, 21.87, 21.87, 23.95, 22.91, 20.83]
[rank2]:2026-01-01 03:13:39,518 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0313_rank2_stage2.svg
[rank2]:	> Counts Sum: 51520, Total Sum: 215040 (23.96%), Ratio(%) per element: [25.0, 26.04, 26.04, 25.0, 25.0, 25.0, 26.04, 26.04, 25.0, 26.04, 25.0, 25.0, 25.0, 23.95, 25.0, 23.95, 23.95, 22.91, 21.87, 25.0, 23.95, 22.91, 21.87, 25.0, 25.0, 25.0, 21.87, 26.04, 25.0, 26.04, 22.91, 22.91, 23.95, 25.0, 22.91, 26.04, 22.91, 23.95, 25.0, 23.95, 22.91, 23.95, 20.83, 20.83, 22.91, 23.95, 25.0, 21.87, 20.83, 21.87, 22.91, 23.95, 21.87, 23.95, 20.83, 23.95]
[rank0]:2026-01-01 03:13:39,514 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0313_rank0_stage0.svg
[rank0]:	> Counts Sum: 51520, Total Sum: 215040 (23.96%), Ratio(%) per element: [27.08, 26.04, 27.08, 27.08, 26.04, 26.04, 26.04, 27.08, 27.08, 26.04, 27.08, 25.0, 26.04, 26.04, 23.95, 25.0, 23.95, 25.0, 26.04, 27.08, 26.04, 25.0, 25.0, 23.95, 25.0, 23.95, 23.95, 26.04, 21.87, 21.87, 19.79, 26.04, 22.91, 22.91, 23.95, 20.83, 22.91, 22.91, 23.95, 23.95, 21.87, 20.83, 21.87, 21.87, 22.91, 18.75, 20.83, 22.91, 23.95, 20.83, 19.79, 25.0, 21.87, 19.79, 22.91, 21.87]
[rank3]:2026-01-01 03:13:39,628 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0313_rank3_stage3.svg
[rank3]:	> Counts Sum: 101520, Total Sum: 161280 (62.95%), Ratio(%) per element: [76.04, 75.0, 71.87, 72.91, 72.91, 72.91, 75.0, 70.83, 72.91, 69.79, 70.83, 76.04, 66.66, 73.95, 64.58, 70.83, 69.79, 72.91, 75.0, 72.91, 70.83, 78.12, 73.95, 69.79, 73.95, 72.91, 76.04, 70.83, 41.66, 42.7, 43.75, 48.95, 50.0, 41.66, 43.75, 44.79, 41.66, 44.79, 40.62, 41.66, 47.91, 39.58]
[rank1]:2026-01-01 03:13:39,687 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0313_stage1.svg
[rank2]:2026-01-01 03:13:39,685 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0313_stage2.svg
[rank0]:2026-01-01 03:13:39,678 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0313_stage0.svg
[rank3]:2026-01-01 03:13:39,793 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0313_stage3.svg
[rank3]:2026-01-01 03:17:00,145 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 03:17:00,158 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2026-01-01 03:17:00,145 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 03:17:00,153 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 03:17:00,157 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 03:17:04,117 - Avg. fwd time: 33.7141 / Avg. bwd time: 52.6727 / Avg. batch time: 836.4789 (ms) / GPU bubble ratio: 17.38%
[rank3]:2026-01-01 03:17:04,208 -  step: 250  loss: 12.5261  grad_norm:  6.0315  memory: 20.97GiB(44.14%)  tps: 7,996  tflops: 62.51  mfu: 20.03%
[rank1]:2026-01-01 03:17:04,196 - Avg. fwd time: 32.8530 / Avg. bwd time: 38.0227 / Avg. batch time: 974.6386 (ms) / GPU bubble ratio: 41.82%
[rank1]:2026-01-01 03:17:04,206 -  step: 250  loss: -4.0000  grad_norm:  6.0315  memory: 12.15GiB(25.58%)  tps: 7,996  tflops: 62.51  mfu: 20.03%
[rank2]:2026-01-01 03:17:04,153 - Avg. fwd time: 25.8517 / Avg. bwd time: 30.0406 / Avg. batch time: 898.6135 (ms) / GPU bubble ratio: 50.24%
[rank2]:2026-01-01 03:17:04,207 -  step: 250  loss: -4.0000  grad_norm:  6.0315  memory:  7.27GiB(15.31%)  tps: 7,996  tflops: 62.51  mfu: 20.03%
[rank0]:2026-01-01 03:17:04,203 - Avg. fwd time: 26.2089 / Avg. bwd time: 24.8606 / Avg. batch time: 1023.1547 (ms) / GPU bubble ratio: 60.07%
[rank0]:2026-01-01 03:17:04,207 -  step: 250  loss: -4.0000  grad_norm:  6.0315  memory: 13.14GiB(27.66%)  tps: 7,996  tflops: 62.51  mfu: 20.03%
[rank2]:2026-01-01 03:20:24,696 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 03:20:24,694 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 03:20:24,698 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 03:20:24,697 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 03:20:24,698 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 03:20:28,671 - Avg. fwd time: 33.7358 / Avg. bwd time: 52.6097 / Avg. batch time: 836.1466 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 03:20:28,707 - Avg. fwd time: 25.8534 / Avg. bwd time: 30.0467 / Avg. batch time: 898.0833 (ms) / GPU bubble ratio: 50.20%
[rank0]:2026-01-01 03:20:28,759 - Avg. fwd time: 26.2109 / Avg. bwd time: 24.8773 / Avg. batch time: 1019.8715 (ms) / GPU bubble ratio: 59.93%
[rank0]:2026-01-01 03:20:28,763 -  step: 300  loss: -4.0000  grad_norm:  6.1104  memory: 13.14GiB(27.66%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank3]:2026-01-01 03:20:28,764 -  step: 300  loss: 12.9460  grad_norm:  6.1104  memory: 20.97GiB(44.14%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank1]:2026-01-01 03:20:28,751 - Avg. fwd time: 32.8564 / Avg. bwd time: 38.0320 / Avg. batch time: 973.9494 (ms) / GPU bubble ratio: 41.77%
[rank1]:2026-01-01 03:20:28,762 -  step: 300  loss: -4.0000  grad_norm:  6.1104  memory: 12.15GiB(25.58%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank2]:2026-01-01 03:20:28,762 -  step: 300  loss: -4.0000  grad_norm:  6.1104  memory:  7.27GiB(15.31%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank0]:2026-01-01 03:20:28,813 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0320_stage0_step300.svg
[rank1]:2026-01-01 03:20:28,817 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0320_stage1_step300.svg
[rank2]:2026-01-01 03:20:28,814 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0320_stage2_step300.svg
[rank0]:2026-01-01 03:20:28,981 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0320_rank0_stage0.svg
[rank0]:	> Counts Sum: 73920, Total Sum: 394240 (18.75%), Ratio(%) per element: [20.45, 19.88, 20.45, 20.45, 19.88, 19.88, 19.88, 20.45, 20.45, 19.88, 20.45, 19.31, 19.88, 19.88, 18.75, 19.31, 18.75, 19.31, 19.88, 20.45, 19.88, 19.31, 19.31, 18.75, 19.31, 18.75, 18.75, 19.88, 17.61, 17.61, 16.47, 19.88, 18.18, 18.18, 18.75, 17.04, 18.18, 18.18, 18.75, 18.75, 17.61, 17.04, 17.61, 17.61, 18.18, 15.9, 17.04, 18.18, 18.75, 17.04, 16.47, 19.31, 17.61, 16.47, 18.18, 17.61]
[rank3]:2026-01-01 03:20:28,914 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0320_step300_rank3.svg
[rank3]:			> Batch Time: 1000.00 ms, GPU Bubble Ratio: 59.12%, 43.40%, 55.35%, 31.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-28-305ms   | [S0,MB4,F]  306-25-331ms   | [S0,MB1,B]  383-28-411ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  488-28-517ms   | [S0,MB6,F]  517-25-542ms   | [S0,MB3,B]  594-28-622ms   | [S0,MB7,F]  623-25-648ms   | [S0,MB4,B]  699-28-728ms   | [S0,MB5,B]  801-28-829ms   | [S0,MB6,B]  903-28-931ms   | [S0,MB7,B]  1000-0-1000ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-306ms   | [S1,MB1,B]  334-38-372ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  439-38-477ms   | [S1,MB5,F]  485-32-518ms   | [S1,MB3,B]  545-38-584ms   | [S1,MB6,F]  591-32-624ms   | [S1,MB4,B]  650-38-689ms   | [S1,MB7,F]  696-33-729ms   | [S1,MB5,B]  756-38-794ms   | [S1,MB6,B]  858-37-896ms   | [S1,MB7,B]  957-36-993ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-219ms   | [S2,MB2,F]  226-25-251ms   | [S2,MB1,B]  293-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  398-30-428ms   | [S2,MB4,F]  435-25-461ms   | [S2,MB3,B]  504-30-535ms   | [S2,MB5,F]  542-25-567ms   | [S2,MB4,B]  609-30-640ms   | [S2,MB6,F]  647-25-673ms   | [S2,MB5,B]  714-30-745ms   | [S2,MB7,F]  752-25-778ms   | [S2,MB6,B]  821-30-852ms   | [S2,MB7,B]  921-28-950ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-219ms   | [S3,MB1,B]  231-52-283ms   | [S3,MB2,F]  290-33-324ms   | [S3,MB2,B]  336-51-388ms   | [S3,MB3,F]  395-34-429ms   | [S3,MB3,B]  441-53-495ms   | [S3,MB4,F]  501-34-535ms   | [S3,MB4,B]  547-52-599ms   | [S3,MB5,F]  607-34-641ms   | [S3,MB5,B]  652-52-704ms   | [S3,MB6,F]  712-34-746ms   | [S3,MB6,B]  758-52-810ms   | [S3,MB7,F]  819-33-853ms   | [S3,MB7,B]  864-51-916ms  
[rank3]:2026-01-01 03:20:28,957 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0320_stage3_step300.svg
[rank1]:2026-01-01 03:20:29,001 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0320_rank1_stage1.svg
[rank1]:	> Counts Sum: 92400, Total Sum: 492800 (18.75%), Ratio(%) per element: [19.88, 19.88, 19.88, 19.88, 19.31, 19.88, 20.45, 19.31, 20.45, 19.88, 20.45, 19.31, 19.88, 19.88, 19.88, 19.31, 19.31, 19.88, 19.31, 19.31, 20.45, 19.31, 19.31, 19.88, 19.88, 19.31, 19.31, 19.31, 18.75, 18.75, 17.61, 17.04, 16.47, 18.18, 18.18, 18.75, 18.18, 17.61, 18.18, 18.75, 19.88, 18.75, 19.31, 17.61, 19.31, 18.18, 18.75, 18.75, 17.61, 17.61, 18.75, 17.04, 17.04, 18.18, 18.75, 18.18, 17.04, 16.47, 18.75, 18.75, 17.04, 18.18, 18.75, 17.61, 18.18, 17.61, 17.61, 18.75, 18.18, 17.04]
[rank2]:2026-01-01 03:20:28,986 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0320_rank2_stage2.svg
[rank2]:	> Counts Sum: 73920, Total Sum: 394240 (18.75%), Ratio(%) per element: [19.31, 19.88, 19.88, 19.31, 19.31, 19.31, 19.88, 19.88, 19.31, 19.88, 19.31, 19.31, 19.31, 18.75, 19.31, 18.75, 18.75, 18.18, 17.61, 19.31, 18.75, 18.18, 17.61, 19.31, 19.31, 19.31, 17.61, 19.88, 19.31, 19.88, 18.18, 18.18, 18.75, 19.31, 18.18, 19.88, 18.18, 18.75, 19.31, 18.75, 18.18, 18.75, 17.04, 17.04, 18.18, 18.75, 19.31, 17.61, 17.04, 17.61, 18.18, 18.75, 17.61, 18.75, 17.04, 18.75]
[rank3]:2026-01-01 03:20:29,096 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0320_rank3_stage3.svg
[rank3]:	> Counts Sum: 209120, Total Sum: 295680 (70.73%), Ratio(%) per element: [78.4, 77.84, 75.56, 76.13, 76.13, 77.27, 77.84, 76.13, 77.27, 75.0, 75.56, 78.97, 73.86, 77.27, 72.72, 74.43, 75.0, 76.7, 77.84, 75.56, 77.84, 79.54, 76.7, 73.86, 77.84, 76.13, 78.4, 75.56, 56.81, 60.79, 59.09, 60.79, 63.06, 57.95, 58.52, 59.65, 58.52, 59.09, 57.38, 59.09, 61.36, 56.81]
[rank0]:2026-01-01 03:20:29,268 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0320_stage0.svg
[rank1]:2026-01-01 03:20:29,285 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0320_stage1.svg
[rank2]:2026-01-01 03:20:29,277 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0320_stage2.svg
[rank3]:2026-01-01 03:20:29,384 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0320_stage3.svg
[rank0]:2026-01-01 03:23:49,803 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 03:23:53,831 - Avg. fwd time: 33.7560 / Avg. bwd time: 52.5722 / Avg. batch time: 836.0037 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 03:23:53,869 - Avg. fwd time: 25.8556 / Avg. bwd time: 30.0522 / Avg. batch time: 897.8202 (ms) / GPU bubble ratio: 50.18%
[rank0]:2026-01-01 03:23:53,921 - Avg. fwd time: 26.2135 / Avg. bwd time: 24.8908 / Avg. batch time: 1017.6416 (ms) / GPU bubble ratio: 59.83%
[rank0]:2026-01-01 03:23:53,925 -  step: 350  loss: -4.0000  grad_norm:  6.3501  memory: 13.14GiB(27.66%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank3]:2026-01-01 03:23:53,927 -  step: 350  loss: 11.1892  grad_norm:  6.3501  memory: 20.97GiB(44.14%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank2]:2026-01-01 03:23:53,925 -  step: 350  loss: -4.0000  grad_norm:  6.3501  memory:  7.27GiB(15.31%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank1]:2026-01-01 03:23:53,913 - Avg. fwd time: 32.8610 / Avg. bwd time: 38.0399 / Avg. batch time: 973.5752 (ms) / GPU bubble ratio: 41.74%
[rank1]:2026-01-01 03:23:53,925 -  step: 350  loss: -4.0000  grad_norm:  6.3501  memory: 12.15GiB(25.58%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank0]:2026-01-01 03:27:14,476 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 03:27:18,590 - Avg. fwd time: 33.7731 / Avg. bwd time: 52.5442 / Avg. batch time: 835.9126 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 03:27:18,628 - Avg. fwd time: 25.8588 / Avg. bwd time: 30.0573 / Avg. batch time: 897.6303 (ms) / GPU bubble ratio: 50.17%
[rank0]:2026-01-01 03:27:18,681 - Avg. fwd time: 26.2162 / Avg. bwd time: 24.9012 / Avg. batch time: 1015.9923 (ms) / GPU bubble ratio: 59.75%
[rank0]:2026-01-01 03:27:18,686 -  step: 400  loss: -4.0000  grad_norm: 33.4646  memory: 13.14GiB(27.66%)  tps: 8,002  tflops: 62.55  mfu: 20.05%
[rank3]:2026-01-01 03:27:18,687 -  step: 400  loss: 10.2841  grad_norm: 33.4646  memory: 20.97GiB(44.14%)  tps: 8,002  tflops: 62.55  mfu: 20.05%
[rank2]:2026-01-01 03:27:18,685 -  step: 400  loss: -4.0000  grad_norm: 33.4646  memory:  7.27GiB(15.31%)  tps: 8,002  tflops: 62.55  mfu: 20.05%
[rank2]:2026-01-01 03:27:18,740 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0327_stage2_step400.svg
[rank1]:2026-01-01 03:27:18,673 - Avg. fwd time: 32.8655 / Avg. bwd time: 38.0469 / Avg. batch time: 973.3092 (ms) / GPU bubble ratio: 41.71%
[rank1]:2026-01-01 03:27:18,685 -  step: 400  loss: -4.0000  grad_norm: 33.4646  memory: 12.15GiB(25.58%)  tps: 8,002  tflops: 62.55  mfu: 20.05%
[rank1]:2026-01-01 03:27:18,740 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0327_stage1_step400.svg
[rank0]:2026-01-01 03:27:18,740 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0327_stage0_step400.svg
[rank3]:2026-01-01 03:27:18,832 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0327_step400_rank3.svg
[rank3]:			> Batch Time: 1003.50 ms, GPU Bubble Ratio: 59.14%, 43.35%, 55.37%, 31.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  279-28-307ms   | [S0,MB4,F]  307-25-333ms   | [S0,MB1,B]  385-28-414ms   | [S0,MB5,F]  414-25-439ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  597-28-625ms   | [S0,MB7,F]  625-25-651ms   | [S0,MB4,B]  702-28-731ms   | [S0,MB5,B]  803-28-832ms   | [S0,MB6,B]  904-28-932ms   | [S0,MB7,B]  1003-0-1003ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-98ms     | [S1,MB2,F]  104-33-138ms   | [S1,MB0,B]  230-38-268ms   | [S1,MB3,F]  275-32-308ms   | [S1,MB1,B]  336-38-374ms   | [S1,MB4,F]  382-33-415ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-33-519ms   | [S1,MB3,B]  548-38-586ms   | [S1,MB6,F]  593-33-627ms   | [S1,MB4,B]  653-38-691ms   | [S1,MB7,F]  699-33-732ms   | [S1,MB5,B]  758-38-797ms   | [S1,MB6,B]  859-37-897ms   | [S1,MB7,B]  960-36-997ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  98-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  227-25-252ms   | [S2,MB1,B]  295-30-326ms   | [S2,MB3,F]  333-25-359ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  507-30-537ms   | [S2,MB5,F]  544-25-570ms   | [S2,MB4,B]  612-30-642ms   | [S2,MB6,F]  650-25-676ms   | [S2,MB5,B]  718-30-748ms   | [S2,MB7,F]  755-25-781ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  925-28-954ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-51-179ms   | [S3,MB1,F]  186-33-220ms   | [S3,MB1,B]  232-53-285ms   | [S3,MB2,F]  292-34-327ms   | [S3,MB2,B]  338-51-390ms   | [S3,MB3,F]  396-34-431ms   | [S3,MB3,B]  443-53-497ms   | [S3,MB4,F]  504-34-538ms   | [S3,MB4,B]  550-52-602ms   | [S3,MB5,F]  609-34-643ms   | [S3,MB5,B]  655-52-707ms   | [S3,MB6,F]  714-34-749ms   | [S3,MB6,B]  760-52-813ms   | [S3,MB7,F]  819-34-854ms   | [S3,MB7,B]  866-52-918ms  
[rank3]:2026-01-01 03:27:18,879 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0327_stage3_step400.svg
[rank2]:2026-01-01 03:27:18,910 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0327_rank2_stage2.svg
[rank2]:	> Counts Sum: 96320, Total Sum: 573440 (16.80%), Ratio(%) per element: [17.18, 17.57, 17.57, 17.18, 17.18, 17.18, 17.57, 17.57, 17.18, 17.57, 17.18, 17.18, 17.18, 16.79, 17.18, 16.79, 16.79, 16.4, 16.01, 17.18, 16.79, 16.4, 16.01, 17.18, 17.18, 17.18, 16.01, 17.57, 17.18, 17.57, 16.4, 16.4, 16.79, 17.18, 16.4, 17.57, 16.4, 16.79, 17.18, 16.79, 16.4, 16.79, 15.62, 15.62, 16.4, 16.79, 17.18, 16.01, 15.62, 16.01, 16.4, 16.79, 16.01, 16.79, 15.62, 16.79]
[rank1]:2026-01-01 03:27:18,925 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0327_rank1_stage1.svg
[rank1]:	> Counts Sum: 120400, Total Sum: 716800 (16.80%), Ratio(%) per element: [17.57, 17.57, 17.57, 17.57, 17.18, 17.57, 17.96, 17.18, 17.96, 17.57, 17.96, 17.18, 17.57, 17.57, 17.57, 17.18, 17.18, 17.57, 17.18, 17.18, 17.96, 17.18, 17.18, 17.57, 17.57, 17.18, 17.18, 17.18, 16.79, 16.79, 16.01, 15.62, 15.23, 16.4, 16.4, 16.79, 16.4, 16.01, 16.4, 16.79, 17.57, 16.79, 17.18, 16.01, 17.18, 16.4, 16.79, 16.79, 16.01, 16.01, 16.79, 15.62, 15.62, 16.4, 16.79, 16.4, 15.62, 15.23, 16.79, 16.79, 15.62, 16.4, 16.79, 16.01, 16.4, 16.01, 16.01, 16.79, 16.4, 15.62]
[rank0]:2026-01-01 03:27:18,908 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0327_rank0_stage0.svg
[rank0]:	> Counts Sum: 96320, Total Sum: 573440 (16.80%), Ratio(%) per element: [17.96, 17.57, 17.96, 17.96, 17.57, 17.57, 17.57, 17.96, 17.96, 17.57, 17.96, 17.18, 17.57, 17.57, 16.79, 17.18, 16.79, 17.18, 17.57, 17.96, 17.57, 17.18, 17.18, 16.79, 17.18, 16.79, 16.79, 17.57, 16.01, 16.01, 15.23, 17.57, 16.4, 16.4, 16.79, 15.62, 16.4, 16.4, 16.79, 16.79, 16.01, 15.62, 16.01, 16.01, 16.4, 14.84, 15.62, 16.4, 16.79, 15.62, 15.23, 17.18, 16.01, 15.23, 16.4, 16.01]
[rank3]:2026-01-01 03:27:19,017 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0327_rank3_stage3.svg
[rank3]:	> Counts Sum: 316720, Total Sum: 430080 (73.64%), Ratio(%) per element: [80.07, 79.68, 78.51, 78.9, 79.29, 80.07, 80.07, 79.68, 79.29, 78.12, 78.51, 80.85, 77.34, 79.68, 74.21, 75.78, 76.17, 76.56, 77.73, 76.95, 78.51, 80.46, 77.34, 74.6, 78.51, 76.95, 78.51, 76.56, 62.89, 65.62, 64.45, 66.4, 66.79, 63.67, 63.67, 64.45, 64.06, 64.45, 63.28, 64.45, 66.79, 62.89]
[rank2]:2026-01-01 03:27:19,324 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0327_stage2.svg
[rank1]:2026-01-01 03:27:19,337 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0327_stage1.svg
[rank0]:2026-01-01 03:27:19,325 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0327_stage0.svg
[rank3]:2026-01-01 03:27:19,435 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0327_stage3.svg
[rank3]:2026-01-01 03:27:42,439 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 03:27:42,662 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 03:27:42,702 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 03:27:42,702 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 03:30:39,511 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 03:30:43,482 - Avg. fwd time: 33.7782 / Avg. bwd time: 52.5126 / Avg. batch time: 835.6958 (ms) / GPU bubble ratio: 17.40%
[rank2]:2026-01-01 03:30:43,520 - Avg. fwd time: 25.8579 / Avg. bwd time: 30.0586 / Avg. batch time: 897.3405 (ms) / GPU bubble ratio: 50.15%
[rank2]:2026-01-01 03:30:43,576 -  step: 450  loss: -4.0000  grad_norm:  5.7436  memory:  7.27GiB(15.31%)  tps: 7,996  tflops: 62.51  mfu: 20.04%
[rank1]:2026-01-01 03:30:43,565 - Avg. fwd time: 32.8652 / Avg. bwd time: 38.0494 / Avg. batch time: 972.9523 (ms) / GPU bubble ratio: 41.69%
[rank1]:2026-01-01 03:30:43,576 -  step: 450  loss: -4.0000  grad_norm:  5.7436  memory: 12.15GiB(25.58%)  tps: 7,996  tflops: 62.51  mfu: 20.04%
[rank3]:2026-01-01 03:30:43,579 -  step: 450  loss: 12.7481  grad_norm:  5.7436  memory: 20.97GiB(44.14%)  tps: 7,997  tflops: 62.51  mfu: 20.04%
[rank0]:2026-01-01 03:30:43,573 - Avg. fwd time: 26.2155 / Avg. bwd time: 24.9081 / Avg. batch time: 1014.5525 (ms) / GPU bubble ratio: 59.69%
[rank0]:2026-01-01 03:30:43,577 -  step: 450  loss: -4.0000  grad_norm:  5.7436  memory: 13.14GiB(27.66%)  tps: 7,996  tflops: 62.51  mfu: 20.04%
[rank0]:2026-01-01 03:34:04,045 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 03:34:08,061 - Avg. fwd time: 25.8571 / Avg. bwd time: 30.0599 / Avg. batch time: 897.1142 (ms) / GPU bubble ratio: 50.14%
[rank3]:2026-01-01 03:34:08,022 - Avg. fwd time: 33.7834 / Avg. bwd time: 52.4884 / Avg. batch time: 835.5410 (ms) / GPU bubble ratio: 17.40%
[rank2]:2026-01-01 03:34:08,118 -  step: 500  loss: -4.0000  grad_norm:  6.3081  memory:  7.27GiB(15.31%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank1]:2026-01-01 03:34:08,106 - Avg. fwd time: 32.8640 / Avg. bwd time: 38.0501 / Avg. batch time: 972.6684 (ms) / GPU bubble ratio: 41.67%
[rank1]:2026-01-01 03:34:08,118 -  step: 500  loss: -4.0000  grad_norm:  6.3081  memory: 12.15GiB(25.58%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank1]:2026-01-01 03:34:08,167 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0334_stage1_step500.svg
[rank3]:2026-01-01 03:34:08,120 -  step: 500  loss: 12.9581  grad_norm:  6.3081  memory: 20.97GiB(44.14%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank0]:2026-01-01 03:34:08,114 - Avg. fwd time: 26.2147 / Avg. bwd time: 24.9135 / Avg. batch time: 1013.4032 (ms) / GPU bubble ratio: 59.64%
[rank0]:2026-01-01 03:34:08,119 -  step: 500  loss: -4.0000  grad_norm:  6.3081  memory: 13.14GiB(27.66%)  tps: 8,010  tflops: 62.62  mfu: 20.07%
[rank0]:2026-01-01 03:34:08,167 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0334_stage0_step500.svg
[rank2]:2026-01-01 03:34:08,170 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0334_stage2_step500.svg
[rank3]:2026-01-01 03:34:08,260 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0334_step500_rank3.svg
[rank3]:			> Batch Time: 998.00 ms, GPU Bubble Ratio: 59.05%, 43.32%, 55.27%, 31.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-331ms   | [S0,MB1,B]  383-28-411ms   | [S0,MB5,F]  411-25-437ms   | [S0,MB2,B]  487-28-516ms   | [S0,MB6,F]  516-25-541ms   | [S0,MB3,B]  594-28-622ms   | [S0,MB7,F]  622-25-647ms   | [S0,MB4,B]  698-28-727ms   | [S0,MB5,B]  799-28-827ms   | [S0,MB6,B]  899-28-927ms   | [S0,MB7,B]  998-0-998ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-37-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-372ms   | [S1,MB4,F]  379-32-412ms   | [S1,MB2,B]  438-38-477ms   | [S1,MB5,F]  484-32-516ms   | [S1,MB3,B]  545-38-584ms   | [S1,MB6,F]  591-32-624ms   | [S1,MB4,B]  650-38-688ms   | [S1,MB7,F]  695-32-728ms   | [S1,MB5,B]  755-38-793ms   | [S1,MB6,B]  855-37-893ms   | [S1,MB7,B]  955-36-991ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  293-30-323ms   | [S2,MB3,F]  331-25-356ms   | [S2,MB2,B]  398-30-428ms   | [S2,MB4,F]  435-25-461ms   | [S2,MB3,B]  505-30-535ms   | [S2,MB5,F]  542-25-568ms   | [S2,MB4,B]  609-30-640ms   | [S2,MB6,F]  647-25-673ms   | [S2,MB5,B]  714-30-744ms   | [S2,MB7,F]  751-25-777ms   | [S2,MB6,B]  818-30-849ms   | [S2,MB7,B]  920-28-949ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  230-52-283ms   | [S3,MB2,F]  290-34-324ms   | [S3,MB2,B]  337-51-388ms   | [S3,MB3,F]  395-34-429ms   | [S3,MB3,B]  440-53-494ms   | [S3,MB4,F]  502-34-536ms   | [S3,MB4,B]  547-51-599ms   | [S3,MB5,F]  606-34-640ms   | [S3,MB5,B]  652-52-704ms   | [S3,MB6,F]  711-34-745ms   | [S3,MB6,B]  757-52-809ms   | [S3,MB7,F]  815-33-849ms   | [S3,MB7,B]  861-51-912ms  
[rank2]:2026-01-01 03:34:08,351 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0334_rank2_stage2.svg
[rank2]:	> Counts Sum: 118720, Total Sum: 752640 (15.77%), Ratio(%) per element: [16.07, 16.36, 16.36, 16.07, 16.07, 16.07, 16.36, 16.36, 16.07, 16.36, 16.07, 16.07, 16.07, 15.77, 16.07, 15.77, 15.77, 15.47, 15.17, 16.07, 15.77, 15.47, 15.17, 16.07, 16.07, 16.07, 15.17, 16.36, 16.07, 16.36, 15.47, 15.47, 15.77, 16.07, 15.47, 16.36, 15.47, 15.77, 16.07, 15.77, 15.47, 15.77, 14.88, 14.88, 15.47, 15.77, 16.07, 15.17, 14.88, 15.17, 15.47, 15.77, 15.17, 15.77, 14.88, 15.77]
[rank1]:2026-01-01 03:34:08,348 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0334_rank1_stage1.svg
[rank1]:	> Counts Sum: 148400, Total Sum: 940800 (15.77%), Ratio(%) per element: [16.36, 16.36, 16.36, 16.36, 16.07, 16.36, 16.66, 16.07, 16.66, 16.36, 16.66, 16.07, 16.36, 16.36, 16.36, 16.07, 16.07, 16.36, 16.07, 16.07, 16.66, 16.07, 16.07, 16.36, 16.36, 16.07, 16.07, 16.07, 15.77, 15.77, 15.17, 14.88, 14.58, 15.47, 15.47, 15.77, 15.47, 15.17, 15.47, 15.77, 16.36, 15.77, 16.07, 15.17, 16.07, 15.47, 15.77, 15.77, 15.17, 15.17, 15.77, 14.88, 14.88, 15.47, 15.77, 15.47, 14.88, 14.58, 15.77, 15.77, 14.88, 15.47, 15.77, 15.17, 15.47, 15.17, 15.17, 15.77, 15.47, 14.88]
[rank3]:2026-01-01 03:34:08,304 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0334_stage3_step500.svg
[rank0]:2026-01-01 03:34:08,332 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0334_rank0_stage0.svg
[rank0]:	> Counts Sum: 118720, Total Sum: 752640 (15.77%), Ratio(%) per element: [16.66, 16.36, 16.66, 16.66, 16.36, 16.36, 16.36, 16.66, 16.66, 16.36, 16.66, 16.07, 16.36, 16.36, 15.77, 16.07, 15.77, 16.07, 16.36, 16.66, 16.36, 16.07, 16.07, 15.77, 16.07, 15.77, 15.77, 16.36, 15.17, 15.17, 14.58, 16.36, 15.47, 15.47, 15.77, 14.88, 15.47, 15.47, 15.77, 15.77, 15.17, 14.88, 15.17, 15.17, 15.47, 14.28, 14.88, 15.47, 15.77, 14.88, 14.58, 16.07, 15.17, 14.58, 15.47, 15.17]
[rank3]:2026-01-01 03:34:08,445 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0334_rank3_stage3.svg
[rank3]:	> Counts Sum: 424320, Total Sum: 564480 (75.17%), Ratio(%) per element: [80.95, 80.35, 79.76, 79.16, 80.35, 80.65, 81.54, 80.65, 80.05, 79.76, 79.16, 81.54, 78.57, 80.95, 75.89, 76.48, 76.78, 77.67, 77.38, 77.67, 79.16, 80.35, 77.67, 75.59, 79.46, 77.38, 79.16, 77.38, 66.07, 68.75, 67.55, 69.04, 69.04, 66.96, 66.66, 67.85, 67.55, 66.96, 66.36, 67.26, 68.75, 66.66]
[rank0]:2026-01-01 03:34:08,878 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0334_stage0.svg
[rank2]:2026-01-01 03:34:08,968 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0334_stage2.svg
[rank1]:2026-01-01 03:34:08,883 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0334_stage1.svg
[rank3]:2026-01-01 03:34:08,995 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0334_stage3.svg
[rank0]:2026-01-01 03:37:29,380 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 03:37:33,418 - Avg. fwd time: 33.7920 / Avg. bwd time: 52.4747 / Avg. batch time: 835.5007 (ms) / GPU bubble ratio: 17.40%
[rank3]:2026-01-01 03:37:33,517 -  step: 550  loss: 11.0990  grad_norm:  5.8070  memory: 20.97GiB(44.14%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank2]:2026-01-01 03:37:33,457 - Avg. fwd time: 25.8572 / Avg. bwd time: 30.0615 / Avg. batch time: 897.0176 (ms) / GPU bubble ratio: 50.13%
[rank2]:2026-01-01 03:37:33,515 -  step: 550  loss: -4.0000  grad_norm:  5.8070  memory:  7.27GiB(15.31%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank1]:2026-01-01 03:37:33,502 - Avg. fwd time: 32.8632 / Avg. bwd time: 38.0506 / Avg. batch time: 972.5374 (ms) / GPU bubble ratio: 41.67%
[rank1]:2026-01-01 03:37:33,515 -  step: 550  loss: -4.0000  grad_norm:  5.8070  memory: 12.15GiB(25.58%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank0]:2026-01-01 03:37:33,511 - Avg. fwd time: 26.2147 / Avg. bwd time: 24.9182 / Avg. batch time: 1012.5640 (ms) / GPU bubble ratio: 59.60%
[rank0]:2026-01-01 03:37:33,515 -  step: 550  loss: -4.0000  grad_norm:  5.8070  memory: 13.14GiB(27.66%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank0]:2026-01-01 03:40:53,991 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 03:40:58,111 - Avg. fwd time: 33.7994 / Avg. bwd time: 52.4632 / Avg. batch time: 835.4653 (ms) / GPU bubble ratio: 17.40%
[rank1]:2026-01-01 03:40:58,197 - Avg. fwd time: 32.8636 / Avg. bwd time: 38.0520 / Avg. batch time: 972.4162 (ms) / GPU bubble ratio: 41.66%
[rank1]:2026-01-01 03:40:58,209 -  step: 600  loss: -4.0000  grad_norm: 30.8433  memory: 12.15GiB(25.58%)  tps: 8,004  tflops: 62.57  mfu: 20.06%
[rank2]:2026-01-01 03:40:58,150 - Avg. fwd time: 25.8576 / Avg. bwd time: 30.0631 / Avg. batch time: 896.9359 (ms) / GPU bubble ratio: 50.12%
[rank2]:2026-01-01 03:40:58,209 -  step: 600  loss: -4.0000  grad_norm: 30.8433  memory:  7.27GiB(15.31%)  tps: 8,004  tflops: 62.57  mfu: 20.06%
[rank0]:2026-01-01 03:40:58,205 - Avg. fwd time: 26.2149 / Avg. bwd time: 24.9224 / Avg. batch time: 1011.8533 (ms) / GPU bubble ratio: 59.57%
[rank0]:2026-01-01 03:40:58,210 -  step: 600  loss: -4.0000  grad_norm: 30.8433  memory: 13.14GiB(27.66%)  tps: 8,004  tflops: 62.57  mfu: 20.06%
[rank3]:2026-01-01 03:40:58,211 -  step: 600  loss: 10.0152  grad_norm: 30.8433  memory: 20.97GiB(44.14%)  tps: 8,004  tflops: 62.57  mfu: 20.06%
[rank1]:2026-01-01 03:40:58,260 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0340_stage1_step600.svg
[rank2]:2026-01-01 03:40:58,261 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0340_stage2_step600.svg
[rank0]:2026-01-01 03:40:58,261 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0340_stage0_step600.svg
[rank3]:2026-01-01 03:40:58,356 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0340_step600_rank3.svg
[rank3]:			> Batch Time: 1003.00 ms, GPU Bubble Ratio: 59.17%, 43.40%, 55.38%, 31.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  383-28-412ms   | [S0,MB5,F]  412-25-438ms   | [S0,MB2,B]  488-28-517ms   | [S0,MB6,F]  517-25-543ms   | [S0,MB3,B]  596-28-624ms   | [S0,MB7,F]  624-25-649ms   | [S0,MB4,B]  701-28-729ms   | [S0,MB5,B]  802-28-831ms   | [S0,MB6,B]  905-28-933ms   | [S0,MB7,B]  1003-0-1003ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-33-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-33-413ms   | [S1,MB2,B]  440-38-478ms   | [S1,MB5,F]  485-32-518ms   | [S1,MB3,B]  547-38-585ms   | [S1,MB6,F]  592-33-625ms   | [S1,MB4,B]  651-38-690ms   | [S1,MB7,F]  697-33-730ms   | [S1,MB5,B]  757-38-796ms   | [S1,MB6,B]  860-37-898ms   | [S1,MB7,B]  960-36-996ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  399-30-429ms   | [S2,MB4,F]  436-25-462ms   | [S2,MB3,B]  506-30-536ms   | [S2,MB5,F]  544-25-569ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  648-25-674ms   | [S2,MB5,B]  717-30-747ms   | [S2,MB7,F]  754-25-780ms   | [S2,MB6,B]  823-30-853ms   | [S2,MB7,B]  925-28-953ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-50-178ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  291-34-325ms   | [S3,MB2,B]  337-52-389ms   | [S3,MB3,F]  396-34-430ms   | [S3,MB3,B]  442-54-496ms   | [S3,MB4,F]  503-34-537ms   | [S3,MB4,B]  549-52-601ms   | [S3,MB5,F]  608-34-642ms   | [S3,MB5,B]  654-52-706ms   | [S3,MB6,F]  714-34-748ms   | [S3,MB6,B]  760-52-812ms   | [S3,MB7,F]  820-34-855ms   | [S3,MB7,B]  867-52-919ms  
[rank0]:2026-01-01 03:40:58,427 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0340_rank0_stage0.svg
[rank0]:	> Counts Sum: 141120, Total Sum: 931840 (15.14%), Ratio(%) per element: [15.86, 15.62, 15.86, 15.86, 15.62, 15.62, 15.62, 15.86, 15.86, 15.62, 15.86, 15.38, 15.62, 15.62, 15.14, 15.38, 15.14, 15.38, 15.62, 15.86, 15.62, 15.38, 15.38, 15.14, 15.38, 15.14, 15.14, 15.62, 14.66, 14.66, 14.18, 15.62, 14.9, 14.9, 15.14, 14.42, 14.9, 14.9, 15.14, 15.14, 14.66, 14.42, 14.66, 14.66, 14.9, 13.94, 14.42, 14.9, 15.14, 14.42, 14.18, 15.38, 14.66, 14.18, 14.9, 14.66]
[rank3]:2026-01-01 03:40:58,400 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0340_stage3_step600.svg
[rank1]:2026-01-01 03:40:58,442 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0340_rank1_stage1.svg
[rank1]:	> Counts Sum: 176400, Total Sum: 1164800 (15.14%), Ratio(%) per element: [15.62, 15.62, 15.62, 15.62, 15.38, 15.62, 15.86, 15.38, 15.86, 15.62, 15.86, 15.38, 15.62, 15.62, 15.62, 15.38, 15.38, 15.62, 15.38, 15.38, 15.86, 15.38, 15.38, 15.62, 15.62, 15.38, 15.38, 15.38, 15.14, 15.14, 14.66, 14.42, 14.18, 14.9, 14.9, 15.14, 14.9, 14.66, 14.9, 15.14, 15.62, 15.14, 15.38, 14.66, 15.38, 14.9, 15.14, 15.14, 14.66, 14.66, 15.14, 14.42, 14.42, 14.9, 15.14, 14.9, 14.42, 14.18, 15.14, 15.14, 14.42, 14.9, 15.14, 14.66, 14.9, 14.66, 14.66, 15.14, 14.9, 14.42]
[rank2]:2026-01-01 03:40:58,430 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0340_rank2_stage2.svg
[rank2]:	> Counts Sum: 141120, Total Sum: 931840 (15.14%), Ratio(%) per element: [15.38, 15.62, 15.62, 15.38, 15.38, 15.38, 15.62, 15.62, 15.38, 15.62, 15.38, 15.38, 15.38, 15.14, 15.38, 15.14, 15.14, 14.9, 14.66, 15.38, 15.14, 14.9, 14.66, 15.38, 15.38, 15.38, 14.66, 15.62, 15.38, 15.62, 14.9, 14.9, 15.14, 15.38, 14.9, 15.62, 14.9, 15.14, 15.38, 15.14, 14.9, 15.14, 14.42, 14.42, 14.9, 15.14, 15.38, 14.66, 14.42, 14.66, 14.9, 15.14, 14.66, 15.14, 14.42, 15.14]
[rank3]:2026-01-01 03:40:58,541 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0340_rank3_stage3.svg
[rank3]:	> Counts Sum: 531920, Total Sum: 698880 (76.11%), Ratio(%) per element: [81.49, 81.49, 80.52, 79.56, 81.25, 81.97, 81.97, 81.25, 81.0, 80.04, 79.56, 81.49, 79.32, 81.73, 76.68, 77.64, 77.64, 77.64, 78.12, 77.64, 79.56, 80.04, 77.88, 76.92, 79.32, 78.12, 78.84, 77.88, 68.02, 70.19, 69.47, 70.91, 70.91, 68.5, 68.5, 69.23, 69.47, 68.75, 68.5, 69.23, 69.95, 68.26]
[rank1]:2026-01-01 03:40:59,100 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0340_stage1.svg
[rank2]:2026-01-01 03:40:59,105 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0340_stage2.svg
[rank0]:2026-01-01 03:40:59,092 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0340_stage0.svg
[rank3]:2026-01-01 03:40:59,207 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0340_stage3.svg
[rank0]:2026-01-01 03:44:19,479 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 03:44:23,454 - Avg. fwd time: 33.8007 / Avg. bwd time: 52.4482 / Avg. batch time: 835.3528 (ms) / GPU bubble ratio: 17.40%
[rank2]:2026-01-01 03:44:23,493 - Avg. fwd time: 25.8573 / Avg. bwd time: 30.0640 / Avg. batch time: 896.7930 (ms) / GPU bubble ratio: 50.11%
[rank3]:2026-01-01 03:44:23,555 -  step: 650  loss: 12.3055  grad_norm:  6.7488  memory: 20.97GiB(44.14%)  tps: 7,979  tflops: 62.38  mfu: 19.99%
[rank1]:2026-01-01 03:44:23,539 - Avg. fwd time: 32.8634 / Avg. bwd time: 38.0531 / Avg. batch time: 972.2393 (ms) / GPU bubble ratio: 41.65%
[rank1]:2026-01-01 03:44:23,552 -  step: 650  loss: -4.0000  grad_norm:  6.7488  memory: 12.15GiB(25.58%)  tps: 7,979  tflops: 62.38  mfu: 19.99%
[rank2]:2026-01-01 03:44:23,552 -  step: 650  loss: -4.0000  grad_norm:  6.7488  memory:  7.27GiB(15.31%)  tps: 7,979  tflops: 62.38  mfu: 19.99%
[rank0]:2026-01-01 03:44:23,548 - Avg. fwd time: 26.2146 / Avg. bwd time: 24.9254 / Avg. batch time: 1011.1771 (ms) / GPU bubble ratio: 59.54%
[rank0]:2026-01-01 03:44:23,552 -  step: 650  loss: -4.0000  grad_norm:  6.7488  memory: 13.14GiB(27.66%)  tps: 7,979  tflops: 62.38  mfu: 19.99%
[rank0]:2026-01-01 03:47:43,844 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 03:47:47,800 - Avg. fwd time: 33.7994 / Avg. bwd time: 52.4314 / Avg. batch time: 835.2069 (ms) / GPU bubble ratio: 17.40%
[rank2]:2026-01-01 03:47:47,840 - Avg. fwd time: 25.8565 / Avg. bwd time: 30.0645 / Avg. batch time: 896.6117 (ms) / GPU bubble ratio: 50.10%
[rank0]:2026-01-01 03:47:47,896 - Avg. fwd time: 26.2142 / Avg. bwd time: 24.9275 / Avg. batch time: 1010.5389 (ms) / GPU bubble ratio: 59.51%
[rank3]:2026-01-01 03:47:47,902 -  step: 700  loss: 13.1112  grad_norm:  6.3471  memory: 20.97GiB(44.14%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank1]:2026-01-01 03:47:47,886 - Avg. fwd time: 32.8630 / Avg. bwd time: 38.0537 / Avg. batch time: 972.0282 (ms) / GPU bubble ratio: 41.63%
[rank1]:2026-01-01 03:47:47,900 -  step: 700  loss: -4.0000  grad_norm:  6.3471  memory: 12.15GiB(25.58%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank1]:2026-01-01 03:47:47,952 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0347_stage1_step700.svg
[rank2]:2026-01-01 03:47:47,900 -  step: 700  loss: -4.0000  grad_norm:  6.3471  memory:  7.27GiB(15.31%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank2]:2026-01-01 03:47:47,953 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0347_stage2_step700.svg
[rank0]:2026-01-01 03:47:47,900 -  step: 700  loss: -4.0000  grad_norm:  6.3471  memory: 13.14GiB(27.66%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank0]:2026-01-01 03:47:47,952 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0347_stage0_step700.svg
[rank3]:2026-01-01 03:47:48,044 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0347_step700_rank3.svg
[rank3]:			> Batch Time: 997.50 ms, GPU Bubble Ratio: 59.03%, 43.31%, 55.25%, 31.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-28-305ms   | [S0,MB4,F]  305-25-331ms   | [S0,MB1,B]  382-28-410ms   | [S0,MB5,F]  411-25-436ms   | [S0,MB2,B]  487-28-515ms   | [S0,MB6,F]  515-25-541ms   | [S0,MB3,B]  593-28-621ms   | [S0,MB7,F]  622-25-647ms   | [S0,MB4,B]  697-28-726ms   | [S0,MB5,B]  798-28-826ms   | [S0,MB6,B]  899-28-927ms   | [S0,MB7,B]  997-0-997ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  228-37-266ms   | [S1,MB3,F]  274-32-306ms   | [S1,MB1,B]  333-38-371ms   | [S1,MB4,F]  379-32-412ms   | [S1,MB2,B]  437-38-476ms   | [S1,MB5,F]  483-32-516ms   | [S1,MB3,B]  544-38-582ms   | [S1,MB6,F]  590-33-623ms   | [S1,MB4,B]  648-38-687ms   | [S1,MB7,F]  694-32-727ms   | [S1,MB5,B]  753-38-791ms   | [S1,MB6,B]  854-37-892ms   | [S1,MB7,B]  954-36-990ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-218ms   | [S2,MB2,F]  225-25-251ms   | [S2,MB1,B]  292-30-323ms   | [S2,MB3,F]  330-25-356ms   | [S2,MB2,B]  397-30-427ms   | [S2,MB4,F]  434-25-460ms   | [S2,MB3,B]  503-30-533ms   | [S2,MB5,F]  541-25-566ms   | [S2,MB4,B]  608-30-638ms   | [S2,MB6,F]  645-25-671ms   | [S2,MB5,B]  712-30-743ms   | [S2,MB7,F]  749-25-775ms   | [S2,MB6,B]  818-30-848ms   | [S2,MB7,B]  919-28-948ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  230-52-282ms   | [S3,MB2,F]  289-33-323ms   | [S3,MB2,B]  335-51-386ms   | [S3,MB3,F]  394-34-428ms   | [S3,MB3,B]  440-53-493ms   | [S3,MB4,F]  500-33-534ms   | [S3,MB4,B]  546-52-598ms   | [S3,MB5,F]  605-34-639ms   | [S3,MB5,B]  651-51-702ms   | [S3,MB6,F]  709-34-743ms   | [S3,MB6,B]  756-51-807ms   | [S3,MB7,F]  815-33-849ms   | [S3,MB7,B]  862-51-913ms  
[rank3]:2026-01-01 03:47:48,092 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0347_stage3_step700.svg
[rank1]:2026-01-01 03:47:48,134 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0347_rank1_stage1.svg
[rank1]:	> Counts Sum: 204400, Total Sum: 1388800 (14.72%), Ratio(%) per element: [15.12, 15.12, 15.12, 15.12, 14.91, 15.12, 15.32, 14.91, 15.32, 15.12, 15.32, 14.91, 15.12, 15.12, 15.12, 14.91, 14.91, 15.12, 14.91, 14.91, 15.32, 14.91, 14.91, 15.12, 15.12, 14.91, 14.91, 14.91, 14.71, 14.71, 14.31, 14.11, 13.91, 14.51, 14.51, 14.71, 14.51, 14.31, 14.51, 14.71, 15.12, 14.71, 14.91, 14.31, 14.91, 14.51, 14.71, 14.71, 14.31, 14.31, 14.71, 14.11, 14.11, 14.51, 14.71, 14.51, 14.11, 13.91, 14.71, 14.71, 14.11, 14.51, 14.71, 14.31, 14.51, 14.31, 14.31, 14.71, 14.51, 14.11]
[rank2]:2026-01-01 03:47:48,127 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0347_rank2_stage2.svg
[rank2]:	> Counts Sum: 163520, Total Sum: 1111040 (14.72%), Ratio(%) per element: [14.91, 15.12, 15.12, 14.91, 14.91, 14.91, 15.12, 15.12, 14.91, 15.12, 14.91, 14.91, 14.91, 14.71, 14.91, 14.71, 14.71, 14.51, 14.31, 14.91, 14.71, 14.51, 14.31, 14.91, 14.91, 14.91, 14.31, 15.12, 14.91, 15.12, 14.51, 14.51, 14.71, 14.91, 14.51, 15.12, 14.51, 14.71, 14.91, 14.71, 14.51, 14.71, 14.11, 14.11, 14.51, 14.71, 14.91, 14.31, 14.11, 14.31, 14.51, 14.71, 14.31, 14.71, 14.11, 14.71]
[rank0]:2026-01-01 03:47:48,118 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0347_rank0_stage0.svg
[rank0]:	> Counts Sum: 163520, Total Sum: 1111040 (14.72%), Ratio(%) per element: [15.32, 15.12, 15.32, 15.32, 15.12, 15.12, 15.12, 15.32, 15.32, 15.12, 15.32, 14.91, 15.12, 15.12, 14.71, 14.91, 14.71, 14.91, 15.12, 15.32, 15.12, 14.91, 14.91, 14.71, 14.91, 14.71, 14.71, 15.12, 14.31, 14.31, 13.91, 15.12, 14.51, 14.51, 14.71, 14.11, 14.51, 14.51, 14.71, 14.71, 14.31, 14.11, 14.31, 14.31, 14.51, 13.7, 14.11, 14.51, 14.71, 14.11, 13.91, 14.91, 14.31, 13.91, 14.51, 14.31]
[rank3]:2026-01-01 03:47:48,233 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0347_rank3_stage3.svg
[rank3]:	> Counts Sum: 639520, Total Sum: 833280 (76.75%), Ratio(%) per element: [81.85, 81.85, 80.44, 80.24, 81.45, 82.45, 82.45, 81.25, 81.45, 80.24, 80.04, 81.45, 79.43, 82.05, 77.21, 78.22, 78.22, 78.22, 78.22, 77.82, 79.83, 80.44, 77.62, 77.41, 79.43, 78.02, 79.03, 78.22, 69.35, 71.37, 70.96, 72.17, 72.37, 69.55, 70.16, 70.56, 70.56, 70.36, 69.95, 70.36, 70.96, 69.95]
[rank1]:2026-01-01 03:47:48,914 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0347_stage1.svg
[rank2]:2026-01-01 03:47:48,943 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0347_stage2.svg
[rank0]:2026-01-01 03:47:48,910 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0347_stage0.svg
[rank3]:2026-01-01 03:47:49,050 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0347_stage3.svg
[rank0]:2026-01-01 03:51:09,144 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-01 03:51:13,225 - Avg. fwd time: 25.8564 / Avg. bwd time: 30.0653 / Avg. batch time: 896.5122 (ms) / GPU bubble ratio: 50.10%
[rank3]:2026-01-01 03:51:13,185 - Avg. fwd time: 33.8007 / Avg. bwd time: 52.4197 / Avg. batch time: 835.1188 (ms) / GPU bubble ratio: 17.41%
[rank2]:2026-01-01 03:51:13,286 -  step: 750  loss: -4.0000  grad_norm:  4.8571  memory:  7.27GiB(15.31%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank1]:2026-01-01 03:51:13,272 - Avg. fwd time: 32.8637 / Avg. bwd time: 38.0552 / Avg. batch time: 971.9042 (ms) / GPU bubble ratio: 41.62%
[rank1]:2026-01-01 03:51:13,286 -  step: 750  loss: -4.0000  grad_norm:  4.8571  memory: 12.15GiB(25.58%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank3]:2026-01-01 03:51:13,288 -  step: 750  loss: 11.0736  grad_norm:  4.8571  memory: 20.97GiB(44.14%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank0]:2026-01-01 03:51:13,282 - Avg. fwd time: 26.2137 / Avg. bwd time: 24.9295 / Avg. batch time: 1010.0413 (ms) / GPU bubble ratio: 59.49%
[rank0]:2026-01-01 03:51:13,286 -  step: 750  loss: -4.0000  grad_norm:  4.8571  memory: 13.14GiB(27.66%)  tps: 7,977  tflops: 62.36  mfu: 19.99%
[rank0]:2026-01-01 03:54:33,717 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 03:54:37,880 - Avg. fwd time: 25.8568 / Avg. bwd time: 30.0666 / Avg. batch time: 896.4594 (ms) / GPU bubble ratio: 50.09%
[rank3]:2026-01-01 03:54:37,839 - Avg. fwd time: 33.8049 / Avg. bwd time: 52.4121 / Avg. batch time: 835.0923 (ms) / GPU bubble ratio: 17.41%
[rank1]:2026-01-01 03:54:37,928 - Avg. fwd time: 32.8659 / Avg. bwd time: 38.0575 / Avg. batch time: 971.8319 (ms) / GPU bubble ratio: 41.62%
[rank2]:2026-01-01 03:54:37,942 -  step: 800  loss: -4.0000  grad_norm: 27.2689  memory:  7.27GiB(15.31%)  tps: 8,006  tflops: 62.58  mfu: 20.06%
[rank2]:2026-01-01 03:54:37,942 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2689  tps: 8,436  tflops: 65.95  mfu: 19.24%
[rank2]:2026-01-01 03:54:37,942 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 03:54:37,943 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 03:54:37,944 -  step: 800  loss:  9.8078  grad_norm: 27.2689  memory: 20.97GiB(44.14%)  tps: 8,006  tflops: 62.59  mfu: 20.06%
[rank3]:2026-01-01 03:54:37,945 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm: 27.2689  tps: 8,442  tflops: 65.99  mfu: 19.38%
[rank3]:2026-01-01 03:54:37,945 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 03:54:37,946 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 03:54:37,942 -  step: 800  loss: -4.0000  grad_norm: 27.2689  memory: 12.15GiB(25.58%)  tps: 8,006  tflops: 62.58  mfu: 20.06%
[rank1]:2026-01-01 03:54:37,942 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2689  tps: 8,436  tflops: 65.95  mfu: 19.24%
[rank1]:2026-01-01 03:54:37,942 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 03:54:37,943 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 03:54:37,938 - Avg. fwd time: 26.2144 / Avg. bwd time: 24.9315 / Avg. batch time: 1009.6448 (ms) / GPU bubble ratio: 59.47%
[rank0]:2026-01-01 03:54:37,943 -  step: 800  loss: -4.0000  grad_norm: 27.2689  memory: 13.14GiB(27.66%)  tps: 8,006  tflops: 62.58  mfu: 20.06%
[rank0]:2026-01-01 03:54:37,943 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2689  tps: 8,436  tflops: 65.95  mfu: 19.24%
[rank0]:2026-01-01 03:54:37,943 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 03:54:37,943 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 03:54:40,512 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/260101_0354_stage1_final800.svg
[rank0]:2026-01-01 03:54:40,448 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-01 03:54:40,513 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/260101_0354_stage0_final800.svg
[rank2]:2026-01-01 03:54:40,514 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/260101_0354_stage2_final800.svg
[rank3]:2026-01-01 03:54:40,610 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0354_final800_rank3.svg
[rank3]:			> Batch Time: 1002.00 ms, GPU Bubble Ratio: 59.16%, 43.41%, 55.37%, 31.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  384-28-412ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  489-28-517ms   | [S0,MB6,F]  517-25-543ms   | [S0,MB3,B]  595-28-623ms   | [S0,MB7,F]  623-25-649ms   | [S0,MB4,B]  700-28-729ms   | [S0,MB5,B]  802-28-830ms   | [S0,MB6,B]  903-28-931ms   | [S0,MB7,B]  1002-0-1002ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  334-38-373ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  439-38-478ms   | [S1,MB5,F]  485-32-518ms   | [S1,MB3,B]  546-38-584ms   | [S1,MB6,F]  591-33-624ms   | [S1,MB4,B]  651-38-690ms   | [S1,MB7,F]  697-33-730ms   | [S1,MB5,B]  757-38-795ms   | [S1,MB6,B]  858-37-896ms   | [S1,MB7,B]  959-36-995ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  399-30-429ms   | [S2,MB4,F]  436-25-462ms   | [S2,MB3,B]  505-30-535ms   | [S2,MB5,F]  543-25-569ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  648-25-674ms   | [S2,MB5,B]  716-30-746ms   | [S2,MB7,F]  754-25-779ms   | [S2,MB6,B]  822-30-852ms   | [S2,MB7,B]  923-28-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  127-51-178ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-52-284ms   | [S3,MB2,F]  291-34-325ms   | [S3,MB2,B]  337-51-389ms   | [S3,MB3,F]  396-34-430ms   | [S3,MB3,B]  442-53-496ms   | [S3,MB4,F]  502-34-536ms   | [S3,MB4,B]  548-52-601ms   | [S3,MB5,F]  608-34-642ms   | [S3,MB5,B]  654-52-706ms   | [S3,MB6,F]  713-34-747ms   | [S3,MB6,B]  759-52-812ms   | [S3,MB7,F]  818-34-852ms   | [S3,MB7,B]  864-52-916ms  
[rank2]:2026-01-01 03:54:40,688 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0354_rank2_stage2.svg
[rank2]:	> Counts Sum: 185920, Total Sum: 1290240 (14.41%), Ratio(%) per element: [14.58, 14.75, 14.75, 14.58, 14.58, 14.58, 14.75, 14.75, 14.58, 14.75, 14.58, 14.58, 14.58, 14.4, 14.58, 14.4, 14.4, 14.23, 14.06, 14.58, 14.4, 14.23, 14.06, 14.58, 14.58, 14.58, 14.06, 14.75, 14.58, 14.75, 14.23, 14.23, 14.4, 14.58, 14.23, 14.75, 14.23, 14.4, 14.58, 14.4, 14.23, 14.4, 13.88, 13.88, 14.23, 14.4, 14.58, 14.06, 13.88, 14.06, 14.23, 14.4, 14.06, 14.4, 13.88, 14.4]
[rank1]:2026-01-01 03:54:40,691 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0354_rank1_stage1.svg
[rank1]:	> Counts Sum: 232400, Total Sum: 1612800 (14.41%), Ratio(%) per element: [14.75, 14.75, 14.75, 14.75, 14.58, 14.75, 14.93, 14.58, 14.93, 14.75, 14.93, 14.58, 14.75, 14.75, 14.75, 14.58, 14.58, 14.75, 14.58, 14.58, 14.93, 14.58, 14.58, 14.75, 14.75, 14.58, 14.58, 14.58, 14.4, 14.4, 14.06, 13.88, 13.71, 14.23, 14.23, 14.4, 14.23, 14.06, 14.23, 14.4, 14.75, 14.4, 14.58, 14.06, 14.58, 14.23, 14.4, 14.4, 14.06, 14.06, 14.4, 13.88, 13.88, 14.23, 14.4, 14.23, 13.88, 13.71, 14.4, 14.4, 13.88, 14.23, 14.4, 14.06, 14.23, 14.06, 14.06, 14.4, 14.23, 13.88]
[rank0]:2026-01-01 03:54:40,677 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0354_rank0_stage0.svg
[rank0]:	> Counts Sum: 185920, Total Sum: 1290240 (14.41%), Ratio(%) per element: [14.93, 14.75, 14.93, 14.93, 14.75, 14.75, 14.75, 14.93, 14.93, 14.75, 14.93, 14.58, 14.75, 14.75, 14.4, 14.58, 14.4, 14.58, 14.75, 14.93, 14.75, 14.58, 14.58, 14.4, 14.58, 14.4, 14.4, 14.75, 14.06, 14.06, 13.71, 14.75, 14.23, 14.23, 14.4, 13.88, 14.23, 14.23, 14.4, 14.4, 14.06, 13.88, 14.06, 14.06, 14.23, 13.54, 13.88, 14.23, 14.4, 13.88, 13.71, 14.58, 14.06, 13.71, 14.23, 14.06]
[rank3]:2026-01-01 03:54:40,753 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/pipeline_schedule/260101_0354_thry_final800_rank3.svg
[rank3]:			> Batch Time: 978.59 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-29-29ms      | [S0,MB1,F]  29-29-59ms     | [S0,MB2,F]  59-29-88ms     | [S0,MB3,F]  88-29-118ms    | [S0,MB0,B]  296-59-355ms   | [S0,MB4,F]  355-29-385ms   | [S0,MB1,B]  385-59-444ms   | [S0,MB5,F]  444-29-474ms   | [S0,MB2,B]  474-59-533ms   | [S0,MB6,F]  533-29-563ms   | [S0,MB3,B]  563-59-622ms   | [S0,MB7,F]  622-29-652ms   | [S0,MB4,B]  652-59-711ms   | [S0,MB5,B]  741-59-800ms   | [S0,MB6,B]  830-59-889ms   | [S0,MB7,B]  919-59-978ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  29-29-59ms     | [S1,MB1,F]  59-29-88ms     | [S1,MB2,F]  88-29-118ms    | [S1,MB0,B]  237-59-296ms   | [S1,MB3,F]  296-29-326ms   | [S1,MB1,B]  326-59-385ms   | [S1,MB4,F]  385-29-415ms   | [S1,MB2,B]  415-59-474ms   | [S1,MB5,F]  474-29-504ms   | [S1,MB3,B]  504-59-563ms   | [S1,MB6,F]  563-29-593ms   | [S1,MB4,B]  593-59-652ms   | [S1,MB7,F]  652-29-682ms   | [S1,MB5,B]  682-59-741ms   | [S1,MB6,B]  771-59-830ms   | [S1,MB7,B]  859-59-919ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  59-29-88ms     | [S2,MB1,F]  88-29-118ms    | [S2,MB0,B]  177-59-237ms   | [S2,MB2,F]  237-29-266ms   | [S2,MB1,B]  266-59-326ms   | [S2,MB3,F]  326-29-355ms   | [S2,MB2,B]  355-59-415ms   | [S2,MB4,F]  415-29-444ms   | [S2,MB3,B]  444-59-504ms   | [S2,MB5,F]  504-29-533ms   | [S2,MB4,B]  533-59-593ms   | [S2,MB6,F]  593-29-622ms   | [S2,MB5,B]  622-59-682ms   | [S2,MB7,F]  682-29-711ms   | [S2,MB6,B]  711-59-771ms   | [S2,MB7,B]  800-59-859ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  88-29-118ms    | [S3,MB0,B]  118-59-177ms   | [S3,MB1,F]  177-29-207ms   | [S3,MB1,B]  207-59-266ms   | [S3,MB2,F]  266-29-296ms   | [S3,MB2,B]  296-59-355ms   | [S3,MB3,F]  355-29-385ms   | [S3,MB3,B]  385-59-444ms   | [S3,MB4,F]  444-29-474ms   | [S3,MB4,B]  474-59-533ms   | [S3,MB5,F]  533-29-563ms   | [S3,MB5,B]  563-59-622ms   | [S3,MB6,F]  622-29-652ms   | [S3,MB6,B]  652-59-711ms   | [S3,MB7,F]  711-29-741ms   | [S3,MB7,B]  741-59-800ms  
[rank3]:2026-01-01 03:54:40,802 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/260101_0354_stage3_final800.svg
[rank3]:2026-01-01 03:54:40,945 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/frozen_params_histogram/260101_0354_rank3_stage3.svg
[rank3]:	> Counts Sum: 747120, Total Sum: 967680 (77.21%), Ratio(%) per element: [81.94, 82.11, 81.25, 80.9, 82.11, 82.98, 82.63, 81.94, 82.11, 80.72, 80.9, 81.59, 80.2, 82.46, 77.43, 77.95, 78.47, 78.47, 78.64, 77.77, 79.86, 80.55, 77.95, 77.6, 78.99, 77.95, 79.16, 78.81, 70.13, 72.22, 71.52, 72.91, 72.91, 70.48, 71.0, 71.35, 71.35, 71.18, 70.65, 71.0, 71.7, 70.65]
[rank1]:2026-01-01 03:54:41,596 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0354_stage1.svg
[rank1]:2026-01-01 03:54:41,598 - Destroying the purge thread.
[rank1]:2026-01-01 03:54:41,624 - Process group destroyed
[rank0]:2026-01-01 03:54:41,595 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0354_stage0.svg
[rank0]:2026-01-01 03:54:41,596 - Sleeping 2 seconds for other ranks to complete
[rank2]:2026-01-01 03:54:41,627 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0354_stage2.svg
[rank2]:2026-01-01 03:54:41,630 - Destroying the purge thread.
[rank2]:2026-01-01 03:54:41,696 - Process group destroyed
[rank3]:2026-01-01 03:54:41,869 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1/afr_time_plot/260101_0354_stage3.svg
[rank3]:2026-01-01 03:54:41,872 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 330-346
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–‚â–‚â–â–‚â–ˆâ–â–â–â–ˆâ–â–â–â–‡â–â–â–â–†
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.88161
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 19.375
[rank3]:wandb:             final/avg_tflops 65.99461
[rank3]:wandb:    final/avg_throughput(tps) 8441.86467
[rank3]:wandb:              final/grad_norm 27.26892
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 27.26892
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_1F1B_timelyauto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/5q7ixuwz
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_1F1B_timelyauto_42_dm1/20260101-0259/wandb/run-20260101_025937-5q7ixuwz/logs
[rank3]:2026-01-01 03:54:43,242 - Process group destroyed
[rank0]:2026-01-01 03:54:43,597 - Training completed
[rank0]:2026-01-01 03:54:43,597 - Destroying the purge thread.
[rank0]:2026-01-01 03:54:43,645 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.5', 'layers.8', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.1', 'layers.0', 'layers.3', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.9', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.15', 'norm', 'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_1F1B_timelyauto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_1F1B_timelyauto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_1F1B_timelyauto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_1F1B_timelyauto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_1F1B_timelyauto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_1F1B_timelyauto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_1F1B_timelyauto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_1F1B_timelyauto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
