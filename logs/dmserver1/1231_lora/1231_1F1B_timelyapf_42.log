
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 02:03:59 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_1F1B_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2026-01-01 02:04:07,064 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:2026-01-01 02:04:07,101 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank0]:2026-01-01 02:04:07,182 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank3]:2026-01-01 02:04:07,255 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 02:04:07,258 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-01 02:04:07,388 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank0]:2026-01-01 02:04:07,397 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 02:04:07,399 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 02:04:07,404 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 02:04:07,405 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-01 02:04:07,330 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 02:04:07,332 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-01 02:04:07,536 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 02:04:07,539 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 02:04:07,799 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2026-01-01 02:04:10,765 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 02:04:10,802 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 02:04:10,829 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-01 02:04:10,830 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 02:04:10,909 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2026-01-01 02:04:10,899 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 02:04:10,937 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 02:04:10,964 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-01 02:04:10,965 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-01 02:04:11,015 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 02:04:11,015 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 02:04:11,015 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2026-01-01 02:04:11,078 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 02:04:11,118 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 02:04:11,119 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 02:04:11,145 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-01 02:04:11,146 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2026-01-01 02:04:11,148 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 02:04:11,148 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 02:04:11,148 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2026-01-01 02:04:11,334 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 02:04:11,334 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 02:04:11,335 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run osdll4dr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_1F1B_timelyapf_42_dm1/20260101-0204/wandb/run-20260101_020411-osdll4dr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_1F1B_timelyapf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/osdll4dr
[rank3]:2026-01-01 02:04:12,858 - WandB logging enabled
[rank3]:2026-01-01 02:04:12,858 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 02:04:12,896 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 02:04:12,925 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2026-01-01 02:04:12,925 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-01 02:04:13,134 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_1F1B_timelyapf_42_dm1
[rank0]:2026-01-01 02:04:13,134 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 02:04:13,134 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 02:04:13,135 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2026-01-01 02:04:13,134 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 02:04:13,134 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-01 02:04:13,116 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 02:04:13,117 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 02:04:13,118 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2026-01-01 02:04:13,134 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 02:04:15,725 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 02:04:15,725 - Finished loading the checkpoint in 2.59 seconds.
[rank0]:2026-01-01 02:04:15,771 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2026-01-01 02:04:15,771 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2026-01-01 02:04:15,771 - Training starts at step 1
[rank2]:2026-01-01 02:04:15,769 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2026-01-01 02:04:15,770 - Freezable Parameters: [Stage 2] 56 params
[rank3]:2026-01-01 02:04:15,788 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2026-01-01 02:04:15,789 - Freezable Parameters: [Stage 3] 42 params
[rank1]:2026-01-01 02:04:15,781 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2026-01-01 02:04:15,781 - Freezable Parameters: [Stage 1] 70 params
[rank0]:2026-01-01 02:04:20,893 -  step:  1  loss: -4.0000  grad_norm:  9.9054  memory: 13.12GiB(27.62%)  tps: 3,352  tflops: 26.20  mfu: 8.40%
[rank0]:2026-01-01 02:04:20,894 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-01 02:04:20,869 -  step:  1  loss: -4.0000  grad_norm:  9.9054  memory:  7.27GiB(15.31%)  tps: 3,300  tflops: 25.80  mfu: 8.27%
[rank2]:2026-01-01 02:04:20,869 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 02:04:20,871 -  step:  1  loss: 10.6092  grad_norm:  9.9054  memory: 20.97GiB(44.14%)  tps: 4,110  tflops: 32.13  mfu: 10.30%
[rank3]:2026-01-01 02:04:20,872 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 02:04:20,871 -  step:  1  loss: -4.0000  grad_norm:  9.9054  memory: 12.09GiB(25.46%)  tps: 3,254  tflops: 25.44  mfu: 8.15%
[rank1]:2026-01-01 02:04:20,872 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 02:07:43,650 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 02:07:47,735 - Avg. fwd time: 33.4584 / Avg. bwd time: 53.1003 / Avg. batch time: 837.8854 (ms) / GPU bubble ratio: 17.36%
[rank1]:2026-01-01 02:07:47,817 - Avg. fwd time: 32.7846 / Avg. bwd time: 38.2355 / Avg. batch time: 978.7706 (ms) / GPU bubble ratio: 41.95%
[rank2]:2026-01-01 02:07:47,772 - Avg. fwd time: 25.8024 / Avg. bwd time: 30.2260 / Avg. batch time: 901.1359 (ms) / GPU bubble ratio: 50.26%
[rank0]:2026-01-01 02:07:47,851 - Avg. fwd time: 26.2102 / Avg. bwd time: 28.3711 / Avg. batch time: 1040.8148 (ms) / GPU bubble ratio: 58.05%
[rank0]:2026-01-01 02:07:47,855 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 13.12GiB(27.62%)  tps: 7,758  tflops: 60.65  mfu: 19.44%
[rank1]:2026-01-01 02:07:47,855 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory: 12.09GiB(25.46%)  tps: 7,757  tflops: 60.64  mfu: 19.44%
[rank2]:2026-01-01 02:07:47,855 -  step: 50  loss: -4.0000  grad_norm:  8.4069  memory:  7.27GiB(15.31%)  tps: 7,757  tflops: 60.64  mfu: 19.44%
[rank3]:2026-01-01 02:07:47,856 -  step: 50  loss: 12.4624  grad_norm:  8.4069  memory: 20.97GiB(44.14%)  tps: 7,757  tflops: 60.64  mfu: 19.44%
[rank3]:2026-01-01 02:08:25,739 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2026-01-01 02:09:08,118 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2026-01-01 02:09:08,309 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2026-01-01 02:09:08,267 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2026-01-01 02:09:08,337 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2026-01-01 02:09:50,671 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2026-01-01 02:09:50,910 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2026-01-01 02:11:12,382 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank1]:2026-01-01 02:11:12,670 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 02:11:12,639 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 02:11:12,667 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2026-01-01 02:11:12,667 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 02:11:12,812 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0211_max_batch_time.svg
[rank3]:			> Batch Time: 877.22 ms, GPU Bubble Ratio: 49.99%, 35.04%, 48.84%, 20.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  236-28-265ms   | [S0,MB4,F]  265-25-290ms   | [S0,MB1,B]  323-28-351ms   | [S0,MB5,F]  351-25-377ms   | [S0,MB2,B]  410-28-439ms   | [S0,MB6,F]  439-25-464ms   | [S0,MB3,B]  498-28-526ms   | [S0,MB7,F]  526-25-552ms   | [S0,MB4,B]  585-28-614ms   | [S0,MB5,B]  674-28-702ms   | [S0,MB6,B]  761-28-789ms   | [S0,MB7,B]  848-28-877ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-124ms    | [S1,MB0,B]  198-38-236ms   | [S1,MB3,F]  236-32-269ms   | [S1,MB1,B]  284-38-323ms   | [S1,MB4,F]  323-33-356ms   | [S1,MB2,B]  372-38-410ms   | [S1,MB5,F]  410-33-443ms   | [S1,MB3,B]  459-38-498ms   | [S1,MB6,F]  498-33-531ms   | [S1,MB4,B]  547-38-585ms   | [S1,MB7,F]  585-33-618ms   | [S1,MB5,B]  635-38-674ms   | [S1,MB6,B]  723-37-761ms   | [S1,MB7,B]  810-38-848ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  168-30-198ms   | [S2,MB2,F]  198-25-224ms   | [S2,MB1,B]  254-30-284ms   | [S2,MB3,F]  284-25-310ms   | [S2,MB2,B]  341-30-372ms   | [S2,MB4,F]  372-25-398ms   | [S2,MB3,B]  429-30-459ms   | [S2,MB5,F]  459-25-485ms   | [S2,MB4,B]  516-30-547ms   | [S2,MB6,F]  547-25-573ms   | [S2,MB5,B]  605-30-635ms   | [S2,MB7,F]  635-25-661ms   | [S2,MB6,B]  692-30-723ms   | [S2,MB7,B]  780-30-810ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  116-52-168ms   AFR(10):0.9762 | [S3,MB1,F]  168-33-201ms   | [S3,MB1,B]  201-53-254ms   AFR(10):0.9762 | [S3,MB2,F]  254-33-288ms   | [S3,MB2,B]  288-53-341ms   AFR(10):0.9762 | [S3,MB3,F]  341-33-375ms   | [S3,MB3,B]  375-53-429ms   AFR(10):0.9762 | [S3,MB4,F]  429-34-463ms   | [S3,MB4,B]  463-53-516ms   AFR(10):0.9762 | [S3,MB5,F]  516-34-551ms   | [S3,MB5,B]  551-53-605ms   AFR(10):0.9762 | [S3,MB6,F]  605-34-639ms   | [S3,MB6,B]  639-53-692ms   AFR(10):0.9762 | [S3,MB7,F]  692-33-726ms   | [S3,MB7,B]  726-53-780ms   AFR(10):0.9762
[rank3]:2026-01-01 02:11:12,961 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0211_min_batch_time.svg
[rank3]:			> Batch Time: 834.36 ms, GPU Bubble Ratio: 74.79%, 33.66%, 47.69%, 17.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  232-0-232ms    | [S0,MB4,F]  232-25-257ms   | [S0,MB1,B]  317-0-317ms    | [S0,MB5,F]  317-25-342ms   | [S0,MB2,B]  403-0-403ms    | [S0,MB6,F]  403-25-429ms   | [S0,MB3,B]  489-0-489ms    | [S0,MB7,F]  489-25-514ms   | [S0,MB4,B]  575-0-575ms    | [S0,MB5,B]  662-0-662ms    | [S0,MB6,B]  748-0-748ms    | [S0,MB7,B]  834-0-834ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-124ms    | [S1,MB0,B]  195-36-232ms   | [S1,MB3,F]  232-32-264ms   | [S1,MB1,B]  280-36-317ms   | [S1,MB4,F]  317-33-350ms   | [S1,MB2,B]  366-36-403ms   | [S1,MB5,F]  403-33-436ms   | [S1,MB3,B]  452-36-489ms   | [S1,MB6,F]  489-33-522ms   | [S1,MB4,B]  539-36-575ms   | [S1,MB7,F]  575-33-609ms   | [S1,MB5,B]  625-36-662ms   | [S1,MB6,B]  712-36-748ms   | [S1,MB7,B]  798-36-834ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  167-28-195ms   | [S2,MB2,F]  195-25-221ms   | [S2,MB1,B]  252-28-280ms   | [S2,MB3,F]  280-25-306ms   | [S2,MB2,B]  338-28-366ms   | [S2,MB4,F]  366-25-392ms   | [S2,MB3,B]  424-28-452ms   | [S2,MB5,F]  452-25-478ms   | [S2,MB4,B]  510-28-539ms   | [S2,MB6,F]  539-25-565ms   | [S2,MB5,B]  597-28-625ms   | [S2,MB7,F]  625-25-651ms   | [S2,MB6,B]  683-28-712ms   | [S2,MB7,B]  769-28-798ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  116-51-167ms   AFR(10):0.9762 | [S3,MB1,F]  167-33-200ms   | [S3,MB1,B]  200-52-252ms   AFR(10):0.9762 | [S3,MB2,F]  252-33-286ms   | [S3,MB2,B]  286-52-338ms   AFR(10):0.9762 | [S3,MB3,F]  338-33-372ms   | [S3,MB3,B]  372-51-424ms   AFR(10):0.9762 | [S3,MB4,F]  424-34-458ms   | [S3,MB4,B]  458-52-510ms   AFR(10):0.9762 | [S3,MB5,F]  510-34-544ms   | [S3,MB5,B]  544-52-597ms   AFR(10):0.9762 | [S3,MB6,F]  597-34-631ms   | [S3,MB6,B]  631-52-683ms   AFR(10):0.9762 | [S3,MB7,F]  683-33-717ms   | [S3,MB7,B]  717-51-769ms   AFR(10):0.9762
[rank3]:2026-01-01 02:11:13,120 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0211_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 836.13 ms, GPU Bubble Ratio: 50.93%, 32.10%, 46.51%, 17.84%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  235-28-263ms   | [S0,MB4,F]  263-25-289ms   | [S0,MB1,B]  322-28-350ms   | [S0,MB5,F]  350-25-376ms   | [S0,MB2,B]  408-28-436ms   | [S0,MB6,F]  436-25-462ms   | [S0,MB3,B]  493-28-522ms   | [S0,MB7,F]  522-25-548ms   | [S0,MB4,B]  581-28-609ms   | [S0,MB5,B]  667-28-696ms   | [S0,MB6,B]  753-28-782ms   | [S0,MB7,B]  836-0-836ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  58-32-91ms     | [S1,MB2,F]  91-32-124ms    | [S1,MB0,B]  197-38-235ms   | [S1,MB3,F]  235-32-268ms   | [S1,MB1,B]  283-38-322ms   | [S1,MB4,F]  322-33-355ms   | [S1,MB2,B]  369-38-408ms   | [S1,MB5,F]  408-33-441ms   | [S1,MB3,B]  455-38-493ms   | [S1,MB6,F]  493-33-526ms   | [S1,MB4,B]  542-38-581ms   | [S1,MB7,F]  581-33-614ms   | [S1,MB5,B]  629-38-667ms   | [S1,MB6,B]  715-37-753ms   | [S1,MB7,B]  800-36-836ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  91-25-116ms    | [S2,MB0,B]  167-30-197ms   | [S2,MB2,F]  197-25-223ms   | [S2,MB1,B]  253-30-283ms   | [S2,MB3,F]  283-25-309ms   | [S2,MB2,B]  339-30-369ms   | [S2,MB4,F]  369-25-395ms   | [S2,MB3,B]  425-30-455ms   | [S2,MB5,F]  455-25-481ms   | [S2,MB4,B]  512-30-542ms   | [S2,MB6,F]  542-25-568ms   | [S2,MB5,B]  599-30-629ms   | [S2,MB7,F]  629-25-655ms   | [S2,MB6,B]  685-30-715ms   | [S2,MB7,B]  771-28-800ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  116-51-167ms   AFR(10):0.9762 | [S3,MB1,F]  167-33-200ms   | [S3,MB1,B]  200-53-253ms   AFR(10):0.9762 | [S3,MB2,F]  253-33-287ms   | [S3,MB2,B]  287-52-339ms   AFR(10):0.9762 | [S3,MB3,F]  339-33-373ms   | [S3,MB3,B]  373-51-425ms   AFR(10):0.9762 | [S3,MB4,F]  425-34-459ms   | [S3,MB4,B]  459-53-512ms   AFR(10):0.9762 | [S3,MB5,F]  512-34-546ms   | [S3,MB5,B]  546-52-599ms   AFR(10):0.9762 | [S3,MB6,F]  599-34-633ms   | [S3,MB6,B]  633-52-685ms   AFR(10):0.9762 | [S3,MB7,F]  685-33-719ms   | [S3,MB7,B]  719-51-771ms   AFR(10):0.9762
[rank3]:2026-01-01 02:11:13,120 - 	> Batch Time: 836.13 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.05)
[rank3]:2026-01-01 02:11:13,134 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 02:11:17,099 - Avg. fwd time: 26.1831 / Avg. bwd time: 22.7096 / Avg. batch time: 1034.1702 (ms) / GPU bubble ratio: 62.18%
[rank2]:2026-01-01 02:11:17,050 - Avg. fwd time: 25.8284 / Avg. bwd time: 29.9331 / Avg. batch time: 901.5954 (ms) / GPU bubble ratio: 50.52%
[rank2]:2026-01-01 02:11:17,102 -  step: 100  loss: -4.0000  grad_norm:  6.3669  memory:  7.28GiB(15.33%)  tps: 7,830  tflops: 61.21  mfu: 19.62%
[rank3]:2026-01-01 02:11:17,015 - Avg. fwd time: 33.6177 / Avg. bwd time: 52.9666 / Avg. batch time: 838.1020 (ms) / GPU bubble ratio: 17.35%
[rank3]:2026-01-01 02:11:17,103 -  step: 100  loss: 13.1176  grad_norm:  6.3669  memory: 20.98GiB(44.15%)  tps: 7,830  tflops: 61.21  mfu: 19.62%
[rank1]:2026-01-01 02:11:17,093 - Avg. fwd time: 32.8263 / Avg. bwd time: 37.8851 / Avg. batch time: 978.4423 (ms) / GPU bubble ratio: 42.18%
[rank1]:2026-01-01 02:11:17,102 -  step: 100  loss: -4.0000  grad_norm:  6.3669  memory: 12.17GiB(25.61%)  tps: 7,830  tflops: 61.21  mfu: 19.62%
[rank1]:2026-01-01 02:11:17,160 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0211_stage1_step100.svg
[rank0]:2026-01-01 02:11:17,103 -  step: 100  loss: -4.0000  grad_norm:  6.3669  memory: 13.15GiB(27.69%)  tps: 7,830  tflops: 61.21  mfu: 19.62%
[rank0]:2026-01-01 02:11:17,162 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0211_stage0_step100.svg
[rank2]:2026-01-01 02:11:17,163 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0211_stage2_step100.svg
[rank3]:2026-01-01 02:11:17,249 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0211_step100_rank3.svg
[rank3]:			> Batch Time: 996.50 ms, GPU Bubble Ratio: 79.13%, 44.55%, 56.24%, 31.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-106ms    | [S0,MB0,B]  275-0-275ms    | [S0,MB4,F]  275-25-300ms   | [S0,MB1,B]  378-0-378ms    | [S0,MB5,F]  378-25-403ms   | [S0,MB2,B]  484-0-484ms    | [S0,MB6,F]  485-25-510ms   | [S0,MB3,B]  589-0-589ms    | [S0,MB7,F]  590-25-615ms   | [S0,MB4,B]  694-0-694ms    | [S0,MB5,B]  795-0-795ms    | [S0,MB6,B]  896-0-896ms    | [S0,MB7,B]  996-0-996ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  227-36-264ms   | [S1,MB3,F]  271-32-304ms   | [S1,MB1,B]  332-36-368ms   | [S1,MB4,F]  375-32-408ms   | [S1,MB2,B]  437-36-473ms   | [S1,MB5,F]  480-32-513ms   | [S1,MB3,B]  542-36-579ms   | [S1,MB6,F]  586-32-619ms   | [S1,MB4,B]  646-36-683ms   | [S1,MB7,F]  690-32-723ms   | [S1,MB5,B]  751-36-787ms   | [S1,MB6,B]  853-36-889ms   | [S1,MB7,B]  954-36-990ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-83ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-28-217ms   | [S2,MB2,F]  224-25-250ms   | [S2,MB1,B]  292-28-321ms   | [S2,MB3,F]  328-25-354ms   | [S2,MB2,B]  398-28-426ms   | [S2,MB4,F]  434-25-459ms   | [S2,MB3,B]  503-28-531ms   | [S2,MB5,F]  539-25-565ms   | [S2,MB4,B]  607-28-636ms   | [S2,MB6,F]  643-25-669ms   | [S2,MB5,B]  711-28-740ms   | [S2,MB7,F]  748-25-774ms   | [S2,MB6,B]  817-28-846ms   | [S2,MB7,B]  918-28-947ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  83-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  230-52-282ms   | [S3,MB2,F]  289-34-323ms   | [S3,MB2,B]  335-52-387ms   | [S3,MB3,F]  394-34-429ms   | [S3,MB3,B]  440-52-492ms   | [S3,MB4,F]  500-34-534ms   | [S3,MB4,B]  545-52-598ms   | [S3,MB5,F]  604-34-638ms   | [S3,MB5,B]  649-52-702ms   | [S3,MB6,F]  708-34-742ms   | [S3,MB6,B]  754-52-807ms   | [S3,MB7,F]  814-34-848ms   | [S3,MB7,B]  860-51-912ms  
[rank3]:2026-01-01 02:11:17,294 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0211_stage3_step100.svg
[rank1]:2026-01-01 02:11:17,345 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0211_rank1_stage1.svg
[rank1]:	> Counts Sum: 44800, Total Sum: 44800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2026-01-01 02:11:17,381 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0211_stage1.svg
[rank0]:2026-01-01 02:11:17,331 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0211_rank0_stage0.svg
[rank0]:	> Counts Sum: 35840, Total Sum: 35840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-01 02:11:17,368 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0211_stage0.svg
[rank2]:2026-01-01 02:11:17,332 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0211_rank2_stage2.svg
[rank2]:	> Counts Sum: 35840, Total Sum: 35840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-01 02:11:17,370 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0211_stage2.svg
[rank3]:2026-01-01 02:11:17,447 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0211_rank3_stage3.svg
[rank3]:	> Counts Sum: 26240, Total Sum: 26880 (97.62%), Ratio(%) per element: [100.0, 100.0, 93.75, 87.5, 93.75, 93.75, 100.0, 93.75, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 93.75, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2026-01-01 02:11:17,488 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0211_stage3.svg
[rank1]:2026-01-01 02:14:43,828 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2026-01-01 02:14:43,825 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank0]:2026-01-01 02:14:43,824 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 02:14:43,838 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2026-01-01 02:14:43,823 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.00/0.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.27/0.40, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2026-01-01 02:14:47,986 - Avg. fwd time: 33.7470 / Avg. bwd time: 52.9944 / Avg. batch time: 839.3157 (ms) / GPU bubble ratio: 17.32%
[rank2]:2026-01-01 02:14:48,022 - Avg. fwd time: 25.8527 / Avg. bwd time: 30.0215 / Avg. batch time: 902.2569 (ms) / GPU bubble ratio: 50.46%
[rank1]:2026-01-01 02:14:48,067 - Avg. fwd time: 32.8715 / Avg. bwd time: 38.0191 / Avg. batch time: 978.7636 (ms) / GPU bubble ratio: 42.06%
[rank2]:2026-01-01 02:14:48,105 -  step: 150  loss: -4.0000  grad_norm:  7.4726  memory:  7.28GiB(15.33%)  tps: 7,765  tflops: 60.70  mfu: 19.46%
[rank1]:2026-01-01 02:14:48,105 -  step: 150  loss: -4.0000  grad_norm:  7.4726  memory: 12.17GiB(25.61%)  tps: 7,765  tflops: 60.70  mfu: 19.46%
[rank0]:2026-01-01 02:14:48,102 - Avg. fwd time: 26.2115 / Avg. bwd time: 24.4173 / Avg. batch time: 1034.4553 (ms) / GPU bubble ratio: 60.85%
[rank0]:2026-01-01 02:14:48,106 -  step: 150  loss: -4.0000  grad_norm:  7.4726  memory: 13.15GiB(27.69%)  tps: 7,765  tflops: 60.70  mfu: 19.46%
[rank3]:2026-01-01 02:14:48,107 -  step: 150  loss: 11.1266  grad_norm:  7.4726  memory: 20.98GiB(44.15%)  tps: 7,765  tflops: 60.70  mfu: 19.46%
[rank0]:2026-01-01 02:18:14,652 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 02:18:14,664 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 02:18:14,660 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-01 02:18:14,662 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 02:18:14,665 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 02:18:18,778 - Avg. fwd time: 33.8370 / Avg. bwd time: 52.9655 / Avg. batch time: 839.7856 (ms) / GPU bubble ratio: 17.31%
[rank2]:2026-01-01 02:18:18,814 - Avg. fwd time: 25.8720 / Avg. bwd time: 30.0600 / Avg. batch time: 902.3368 (ms) / GPU bubble ratio: 50.41%
[rank1]:2026-01-01 02:18:18,859 - Avg. fwd time: 32.9050 / Avg. bwd time: 38.0827 / Avg. batch time: 978.5914 (ms) / GPU bubble ratio: 41.97%
[rank0]:2026-01-01 02:18:18,865 - Avg. fwd time: 26.2362 / Avg. bwd time: 25.3146 / Avg. batch time: 1034.5565 (ms) / GPU bubble ratio: 60.14%
[rank0]:2026-01-01 02:18:18,869 -  step: 200  loss: -4.0000  grad_norm: 33.1418  memory: 13.15GiB(27.69%)  tps: 7,774  tflops: 60.77  mfu: 19.48%
[rank3]:2026-01-01 02:18:18,871 -  step: 200  loss: 10.3045  grad_norm: 33.1418  memory: 20.98GiB(44.15%)  tps: 7,774  tflops: 60.77  mfu: 19.48%
[rank2]:2026-01-01 02:18:18,869 -  step: 200  loss: -4.0000  grad_norm: 33.1418  memory:  7.28GiB(15.33%)  tps: 7,774  tflops: 60.77  mfu: 19.48%
[rank2]:2026-01-01 02:18:18,920 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0218_stage2_step200.svg
[rank1]:2026-01-01 02:18:18,869 -  step: 200  loss: -4.0000  grad_norm: 33.1418  memory: 12.17GiB(25.61%)  tps: 7,774  tflops: 60.77  mfu: 19.48%
[rank1]:2026-01-01 02:18:18,921 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0218_stage1_step200.svg
[rank0]:2026-01-01 02:18:18,919 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0218_stage0_step200.svg
[rank3]:2026-01-01 02:18:19,017 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0218_step200_rank3.svg
[rank3]:			> Batch Time: 1019.48 ms, GPU Bubble Ratio: 58.45%, 44.11%, 56.01%, 32.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-27-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  385-28-414ms   | [S0,MB5,F]  414-25-439ms   | [S0,MB2,B]  491-28-519ms   | [S0,MB6,F]  520-25-545ms   | [S0,MB3,B]  597-28-625ms   | [S0,MB7,F]  626-25-651ms   | [S0,MB4,B]  704-28-732ms   | [S0,MB5,B]  806-28-835ms   | [S0,MB6,B]  907-28-936ms   | [S0,MB7,B]  1006-12-1019ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-33-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  336-38-374ms   | [S1,MB4,F]  382-33-415ms   | [S1,MB2,B]  441-38-480ms   | [S1,MB5,F]  487-33-520ms   | [S1,MB3,B]  548-38-586ms   | [S1,MB6,F]  594-33-627ms   | [S1,MB4,B]  655-38-693ms   | [S1,MB7,F]  700-33-734ms   | [S1,MB5,B]  761-38-800ms   | [S1,MB6,B]  862-38-900ms   | [S1,MB7,B]  963-36-1000ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  98-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  333-25-358ms   | [S2,MB2,B]  401-30-431ms   | [S2,MB4,F]  438-25-464ms   | [S2,MB3,B]  507-30-538ms   | [S2,MB5,F]  545-25-571ms   | [S2,MB4,B]  614-30-644ms   | [S2,MB6,F]  652-25-678ms   | [S2,MB5,B]  721-30-751ms   | [S2,MB7,F]  759-25-784ms   | [S2,MB6,B]  826-30-856ms   | [S2,MB7,B]  928-28-957ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-53-285ms   | [S3,MB2,F]  292-34-326ms   | [S3,MB2,B]  338-52-390ms   | [S3,MB3,F]  398-34-432ms   | [S3,MB3,B]  445-52-497ms   | [S3,MB4,F]  504-34-539ms   | [S3,MB4,B]  550-53-604ms   | [S3,MB5,F]  611-34-645ms   | [S3,MB5,B]  658-52-711ms   | [S3,MB6,F]  718-34-752ms   | [S3,MB6,B]  764-52-817ms   | [S3,MB7,F]  823-34-857ms   | [S3,MB7,B]  869-52-921ms  
[rank3]:2026-01-01 02:18:19,061 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0218_stage3_step200.svg
[rank2]:2026-01-01 02:18:19,085 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0218_rank2_stage2.svg
[rank2]:	> Counts Sum: 51520, Total Sum: 215040 (23.96%), Ratio(%) per element: [21.87, 23.95, 23.95, 22.91, 23.95, 21.87, 25.0, 26.04, 22.91, 25.0, 23.95, 23.95, 25.0, 22.91, 23.95, 23.95, 23.95, 23.95, 22.91, 25.0, 22.91, 22.91, 22.91, 25.0, 25.0, 25.0, 21.87, 27.08, 25.0, 26.04, 21.87, 23.95, 21.87, 26.04, 22.91, 26.04, 21.87, 25.0, 25.0, 25.0, 21.87, 25.0, 25.0, 21.87, 23.95, 25.0, 27.08, 22.91, 21.87, 23.95, 25.0, 23.95, 22.91, 26.04, 20.83, 23.95]
[rank1]:2026-01-01 02:18:19,105 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0218_rank1_stage1.svg
[rank1]:	> Counts Sum: 64400, Total Sum: 268800 (23.96%), Ratio(%) per element: [25.0, 22.91, 25.0, 23.95, 25.0, 22.91, 26.04, 21.87, 23.95, 26.04, 23.95, 21.87, 23.95, 23.95, 23.95, 23.95, 23.95, 25.0, 25.0, 23.95, 25.0, 23.95, 23.95, 25.0, 23.95, 25.0, 21.87, 23.95, 25.0, 23.95, 22.91, 23.95, 21.87, 23.95, 23.95, 26.04, 22.91, 23.95, 25.0, 26.04, 26.04, 26.04, 26.04, 23.95, 26.04, 25.0, 25.0, 25.0, 21.87, 22.91, 26.04, 21.87, 21.87, 23.95, 25.0, 22.91, 20.83, 19.79, 25.0, 23.95, 22.91, 22.91, 25.0, 22.91, 25.0, 21.87, 22.91, 25.0, 23.95, 20.83]
[rank0]:2026-01-01 02:18:19,083 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0218_rank0_stage0.svg
[rank0]:	> Counts Sum: 51520, Total Sum: 215040 (23.96%), Ratio(%) per element: [23.95, 22.91, 25.0, 26.04, 22.91, 21.87, 25.0, 22.91, 26.04, 23.95, 25.0, 20.83, 26.04, 22.91, 21.87, 23.95, 23.95, 22.91, 25.0, 26.04, 22.91, 23.95, 23.95, 23.95, 25.0, 22.91, 22.91, 27.08, 23.95, 22.91, 21.87, 26.04, 26.04, 25.0, 23.95, 22.91, 26.04, 23.95, 25.0, 25.0, 26.04, 25.0, 22.91, 22.91, 23.95, 22.91, 22.91, 23.95, 23.95, 21.87, 21.87, 26.04, 23.95, 20.83, 25.0, 22.91]
[rank2]:2026-01-01 02:18:19,244 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0218_stage2.svg
[rank0]:2026-01-01 02:18:19,242 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0218_stage0.svg
[rank3]:2026-01-01 02:18:19,200 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0218_rank3_stage3.svg
[rank3]:	> Counts Sum: 101520, Total Sum: 161280 (62.95%), Ratio(%) per element: [65.62, 64.58, 60.41, 63.54, 61.45, 59.37, 62.5, 60.41, 61.45, 62.5, 66.66, 63.54, 59.37, 63.54, 53.12, 59.37, 58.33, 66.66, 60.41, 66.66, 62.5, 68.75, 64.58, 64.58, 64.58, 64.58, 63.54, 59.37, 61.45, 62.5, 60.41, 66.66, 65.62, 64.58, 66.66, 67.7, 66.66, 64.58, 59.37, 62.5, 67.7, 55.2]
[rank1]:2026-01-01 02:18:19,266 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0218_stage1.svg
[rank3]:2026-01-01 02:18:19,363 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0218_stage3.svg
[rank2]:2026-01-01 02:21:39,959 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 02:21:39,975 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 02:21:39,959 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 02:21:39,971 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 02:21:39,957 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 02:21:43,941 - Avg. fwd time: 33.8524 / Avg. bwd time: 52.8463 / Avg. batch time: 838.9440 (ms) / GPU bubble ratio: 17.33%
[rank2]:2026-01-01 02:21:43,977 - Avg. fwd time: 25.8754 / Avg. bwd time: 30.0688 / Avg. batch time: 901.2246 (ms) / GPU bubble ratio: 50.34%
[rank1]:2026-01-01 02:21:44,020 - Avg. fwd time: 32.9108 / Avg. bwd time: 38.0982 / Avg. batch time: 977.2379 (ms) / GPU bubble ratio: 41.87%
[rank0]:2026-01-01 02:21:44,027 - Avg. fwd time: 26.2378 / Avg. bwd time: 25.2522 / Avg. batch time: 1028.5947 (ms) / GPU bubble ratio: 59.95%
[rank0]:2026-01-01 02:21:44,031 -  step: 250  loss: -4.0000  grad_norm:  6.0110  memory: 13.15GiB(27.69%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank3]:2026-01-01 02:21:44,033 -  step: 250  loss: 12.5261  grad_norm:  6.0110  memory: 20.98GiB(44.15%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank2]:2026-01-01 02:21:44,031 -  step: 250  loss: -4.0000  grad_norm:  6.0110  memory:  7.28GiB(15.33%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank1]:2026-01-01 02:21:44,031 -  step: 250  loss: -4.0000  grad_norm:  6.0110  memory: 12.17GiB(25.61%)  tps: 7,986  tflops: 62.43  mfu: 20.01%
[rank0]:2026-01-01 02:25:04,415 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 02:25:04,424 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-01 02:25:04,436 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2026-01-01 02:25:04,426 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2026-01-01 02:25:04,428 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2026-01-01 02:25:08,392 - Avg. fwd time: 33.8427 / Avg. bwd time: 52.7454 / Avg. batch time: 838.0539 (ms) / GPU bubble ratio: 17.34%
[rank1]:2026-01-01 02:25:08,473 - Avg. fwd time: 32.9072 / Avg. bwd time: 38.1018 / Avg. batch time: 975.9544 (ms) / GPU bubble ratio: 41.79%
[rank1]:2026-01-01 02:25:08,484 -  step: 300  loss: -4.0000  grad_norm:  6.1306  memory: 12.17GiB(25.61%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank2]:2026-01-01 02:25:08,429 - Avg. fwd time: 25.8722 / Avg. bwd time: 30.0706 / Avg. batch time: 900.1153 (ms) / GPU bubble ratio: 50.28%
[rank2]:2026-01-01 02:25:08,484 -  step: 300  loss: -4.0000  grad_norm:  6.1306  memory:  7.28GiB(15.33%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank0]:2026-01-01 02:25:08,480 - Avg. fwd time: 26.2355 / Avg. bwd time: 25.2079 / Avg. batch time: 1024.2417 (ms) / GPU bubble ratio: 59.82%
[rank0]:2026-01-01 02:25:08,484 -  step: 300  loss: -4.0000  grad_norm:  6.1306  memory: 13.15GiB(27.69%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank3]:2026-01-01 02:25:08,486 -  step: 300  loss: 12.9460  grad_norm:  6.1306  memory: 20.98GiB(44.15%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank1]:2026-01-01 02:25:08,537 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0225_stage1_step300.svg
[rank2]:2026-01-01 02:25:08,534 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0225_stage2_step300.svg
[rank0]:2026-01-01 02:25:08,533 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0225_stage0_step300.svg
[rank3]:2026-01-01 02:25:08,631 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0225_step300_rank3.svg
[rank3]:			> Batch Time: 999.50 ms, GPU Bubble Ratio: 59.09%, 43.35%, 55.33%, 31.42%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-28-306ms   | [S0,MB4,F]  306-25-331ms   | [S0,MB1,B]  384-28-412ms   | [S0,MB5,F]  412-25-438ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  593-28-621ms   | [S0,MB7,F]  622-25-647ms   | [S0,MB4,B]  699-28-727ms   | [S0,MB5,B]  799-28-827ms   | [S0,MB6,B]  902-28-930ms   | [S0,MB7,B]  999-0-999ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  335-38-373ms   | [S1,MB4,F]  380-32-413ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-32-519ms   | [S1,MB3,B]  544-38-583ms   | [S1,MB6,F]  590-32-623ms   | [S1,MB4,B]  650-38-689ms   | [S1,MB7,F]  695-33-728ms   | [S1,MB5,B]  754-38-793ms   | [S1,MB6,B]  857-37-895ms   | [S1,MB7,B]  956-36-992ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-219ms   | [S2,MB2,F]  226-25-251ms   | [S2,MB1,B]  294-30-324ms   | [S2,MB3,F]  331-25-357ms   | [S2,MB2,B]  399-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  504-30-534ms   | [S2,MB5,F]  541-25-567ms   | [S2,MB4,B]  609-30-640ms   | [S2,MB6,F]  647-25-673ms   | [S2,MB5,B]  713-30-744ms   | [S2,MB7,F]  751-25-777ms   | [S2,MB6,B]  820-30-851ms   | [S2,MB7,B]  920-28-949ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  231-53-284ms   | [S3,MB2,F]  291-33-325ms   | [S3,MB2,B]  337-51-388ms   | [S3,MB3,F]  396-33-430ms   | [S3,MB3,B]  442-51-494ms   | [S3,MB4,F]  501-33-535ms   | [S3,MB4,B]  546-52-599ms   | [S3,MB5,F]  606-34-640ms   | [S3,MB5,B]  652-52-704ms   | [S3,MB6,F]  711-34-745ms   | [S3,MB6,B]  757-52-809ms   | [S3,MB7,F]  817-34-851ms   | [S3,MB7,B]  863-51-915ms  
[rank0]:2026-01-01 02:25:08,698 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0225_rank0_stage0.svg
[rank0]:	> Counts Sum: 73920, Total Sum: 394240 (18.75%), Ratio(%) per element: [18.75, 18.18, 19.31, 19.88, 18.18, 17.61, 19.31, 18.18, 19.88, 18.75, 19.31, 17.04, 19.88, 18.18, 17.61, 18.75, 18.75, 18.18, 19.31, 19.88, 18.18, 18.75, 18.75, 18.75, 19.31, 18.18, 18.18, 20.45, 18.75, 18.18, 17.61, 19.88, 19.88, 19.31, 18.75, 18.18, 19.88, 18.75, 19.31, 19.31, 19.88, 19.31, 18.18, 18.18, 18.75, 18.18, 18.18, 18.75, 18.75, 17.61, 17.61, 19.88, 18.75, 17.04, 19.31, 18.18]
[rank3]:2026-01-01 02:25:08,674 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0225_stage3_step300.svg
[rank1]:2026-01-01 02:25:08,735 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0225_rank1_stage1.svg
[rank1]:	> Counts Sum: 92400, Total Sum: 492800 (18.75%), Ratio(%) per element: [19.31, 18.18, 19.31, 18.75, 19.31, 18.18, 19.88, 17.61, 18.75, 19.88, 18.75, 17.61, 18.75, 18.75, 18.75, 18.75, 18.75, 19.31, 19.31, 18.75, 19.31, 18.75, 18.75, 19.31, 18.75, 19.31, 17.61, 18.75, 19.31, 18.75, 18.18, 18.75, 17.61, 18.75, 18.75, 19.88, 18.18, 18.75, 19.31, 19.88, 19.88, 19.88, 19.88, 18.75, 19.88, 19.31, 19.31, 19.31, 17.61, 18.18, 19.88, 17.61, 17.61, 18.75, 19.31, 18.18, 17.04, 16.47, 19.31, 18.75, 18.18, 18.18, 19.31, 18.18, 19.31, 17.61, 18.18, 19.31, 18.75, 17.04]
[rank2]:2026-01-01 02:25:08,700 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0225_rank2_stage2.svg
[rank2]:	> Counts Sum: 73920, Total Sum: 394240 (18.75%), Ratio(%) per element: [17.61, 18.75, 18.75, 18.18, 18.75, 17.61, 19.31, 19.88, 18.18, 19.31, 18.75, 18.75, 19.31, 18.18, 18.75, 18.75, 18.75, 18.75, 18.18, 19.31, 18.18, 18.18, 18.18, 19.31, 19.31, 19.31, 17.61, 20.45, 19.31, 19.88, 17.61, 18.75, 17.61, 19.88, 18.18, 19.88, 17.61, 19.31, 19.31, 19.31, 17.61, 19.31, 19.31, 17.61, 18.75, 19.31, 20.45, 18.18, 17.61, 18.75, 19.31, 18.75, 18.18, 19.88, 17.04, 18.75]
[rank3]:2026-01-01 02:25:08,813 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0225_rank3_stage3.svg
[rank3]:	> Counts Sum: 209120, Total Sum: 295680 (70.73%), Ratio(%) per element: [70.45, 71.02, 69.88, 72.72, 69.31, 67.04, 70.45, 69.88, 68.75, 71.59, 73.29, 71.02, 69.88, 71.02, 65.34, 68.18, 69.88, 72.72, 70.45, 73.29, 71.59, 73.29, 71.59, 71.59, 71.02, 72.72, 69.88, 68.75, 69.31, 69.31, 68.75, 72.15, 73.29, 71.59, 73.29, 72.72, 72.72, 72.72, 68.75, 68.18, 74.43, 66.47]
[rank2]:2026-01-01 02:25:08,985 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0225_stage2.svg
[rank0]:2026-01-01 02:25:08,984 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0225_stage0.svg
[rank1]:2026-01-01 02:25:09,063 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0225_stage1.svg
[rank3]:2026-01-01 02:25:09,105 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0225_stage3.svg
[rank0]:2026-01-01 02:28:29,331 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 02:28:33,371 - Avg. fwd time: 33.8373 / Avg. bwd time: 52.6737 / Avg. batch time: 837.4308 (ms) / GPU bubble ratio: 17.36%
[rank3]:2026-01-01 02:28:33,466 -  step: 350  loss: 11.1892  grad_norm:  6.3509  memory: 20.98GiB(44.15%)  tps: 7,993  tflops: 62.49  mfu: 20.03%
[rank1]:2026-01-01 02:28:33,453 - Avg. fwd time: 32.9053 / Avg. bwd time: 38.1040 / Avg. batch time: 975.0525 (ms) / GPU bubble ratio: 41.74%
[rank1]:2026-01-01 02:28:33,464 -  step: 350  loss: -4.0000  grad_norm:  6.3509  memory: 12.17GiB(25.61%)  tps: 7,993  tflops: 62.49  mfu: 20.03%
[rank2]:2026-01-01 02:28:33,408 - Avg. fwd time: 25.8703 / Avg. bwd time: 30.0717 / Avg. batch time: 899.3363 (ms) / GPU bubble ratio: 50.24%
[rank2]:2026-01-01 02:28:33,464 -  step: 350  loss: -4.0000  grad_norm:  6.3509  memory:  7.28GiB(15.33%)  tps: 7,993  tflops: 62.49  mfu: 20.03%
[rank0]:2026-01-01 02:28:33,461 - Avg. fwd time: 26.2346 / Avg. bwd time: 25.1770 / Avg. batch time: 1021.1841 (ms) / GPU bubble ratio: 59.72%
[rank0]:2026-01-01 02:28:33,465 -  step: 350  loss: -4.0000  grad_norm:  6.3509  memory: 13.15GiB(27.69%)  tps: 7,993  tflops: 62.49  mfu: 20.03%
[rank0]:2026-01-01 02:31:53,824 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 02:31:57,942 - Avg. fwd time: 33.8346 / Avg. bwd time: 52.6224 / Avg. batch time: 836.9990 (ms) / GPU bubble ratio: 17.36%
[rank0]:2026-01-01 02:31:58,034 - Avg. fwd time: 26.2342 / Avg. bwd time: 25.1538 / Avg. batch time: 1018.9117 (ms) / GPU bubble ratio: 59.65%
[rank3]:2026-01-01 02:31:58,040 -  step: 400  loss: 10.2841  grad_norm: 33.4651  memory: 20.98GiB(44.15%)  tps: 8,009  tflops: 62.61  mfu: 20.07%
[rank2]:2026-01-01 02:31:57,980 - Avg. fwd time: 25.8699 / Avg. bwd time: 30.0730 / Avg. batch time: 898.7939 (ms) / GPU bubble ratio: 50.21%
[rank2]:2026-01-01 02:31:58,038 -  step: 400  loss: -4.0000  grad_norm: 33.4651  memory:  7.28GiB(15.33%)  tps: 8,009  tflops: 62.61  mfu: 20.07%
[rank1]:2026-01-01 02:31:58,026 - Avg. fwd time: 32.9060 / Avg. bwd time: 38.1070 / Avg. batch time: 974.4266 (ms) / GPU bubble ratio: 41.70%
[rank1]:2026-01-01 02:31:58,038 -  step: 400  loss: -4.0000  grad_norm: 33.4651  memory: 12.17GiB(25.61%)  tps: 8,009  tflops: 62.61  mfu: 20.07%
[rank0]:2026-01-01 02:31:58,039 -  step: 400  loss: -4.0000  grad_norm: 33.4651  memory: 13.15GiB(27.69%)  tps: 8,009  tflops: 62.61  mfu: 20.07%
[rank0]:2026-01-01 02:31:58,093 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0231_stage0_step400.svg
[rank2]:2026-01-01 02:31:58,093 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0231_stage2_step400.svg
[rank1]:2026-01-01 02:31:58,092 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0231_stage1_step400.svg
[rank3]:2026-01-01 02:31:58,188 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0231_step400_rank3.svg
[rank3]:			> Batch Time: 1001.00 ms, GPU Bubble Ratio: 59.03%, 43.19%, 55.29%, 31.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  384-28-413ms   | [S0,MB5,F]  413-25-438ms   | [S0,MB2,B]  489-28-518ms   | [S0,MB6,F]  518-25-544ms   | [S0,MB3,B]  594-28-622ms   | [S0,MB7,F]  623-25-648ms   | [S0,MB4,B]  700-28-729ms   | [S0,MB5,B]  801-28-830ms   | [S0,MB6,B]  903-28-931ms   | [S0,MB7,B]  1001-0-1001ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  335-38-374ms   | [S1,MB4,F]  381-33-414ms   | [S1,MB2,B]  440-38-479ms   | [S1,MB5,F]  486-33-519ms   | [S1,MB3,B]  545-38-583ms   | [S1,MB6,F]  591-33-624ms   | [S1,MB4,B]  651-38-690ms   | [S1,MB7,F]  697-33-730ms   | [S1,MB5,B]  756-38-795ms   | [S1,MB6,B]  858-38-896ms   | [S1,MB7,B]  958-36-994ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  98-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  332-25-358ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  505-30-535ms   | [S2,MB5,F]  542-25-568ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  648-25-674ms   | [S2,MB5,B]  716-30-746ms   | [S2,MB7,F]  753-25-779ms   | [S2,MB6,B]  821-30-851ms   | [S2,MB7,B]  923-28-951ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-50-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-53-284ms   | [S3,MB2,F]  292-34-326ms   | [S3,MB2,B]  337-51-389ms   | [S3,MB3,F]  397-34-431ms   | [S3,MB3,B]  442-52-495ms   | [S3,MB4,F]  501-34-536ms   | [S3,MB4,B]  548-53-601ms   | [S3,MB5,F]  607-34-642ms   | [S3,MB5,B]  653-52-706ms   | [S3,MB6,F]  713-34-747ms   | [S3,MB6,B]  759-52-812ms   | [S3,MB7,F]  818-34-853ms   | [S3,MB7,B]  864-52-917ms  
[rank3]:2026-01-01 02:31:58,234 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0231_stage3_step400.svg
[rank2]:2026-01-01 02:31:58,259 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0231_rank2_stage2.svg
[rank2]:	> Counts Sum: 96320, Total Sum: 573440 (16.80%), Ratio(%) per element: [16.01, 16.79, 16.79, 16.4, 16.79, 16.01, 17.18, 17.57, 16.4, 17.18, 16.79, 16.79, 17.18, 16.4, 16.79, 16.79, 16.79, 16.79, 16.4, 17.18, 16.4, 16.4, 16.4, 17.18, 17.18, 17.18, 16.01, 17.96, 17.18, 17.57, 16.01, 16.79, 16.01, 17.57, 16.4, 17.57, 16.01, 17.18, 17.18, 17.18, 16.01, 17.18, 17.18, 16.01, 16.79, 17.18, 17.96, 16.4, 16.01, 16.79, 17.18, 16.79, 16.4, 17.57, 15.62, 16.79]
[rank0]:2026-01-01 02:31:58,258 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0231_rank0_stage0.svg
[rank0]:	> Counts Sum: 96320, Total Sum: 573440 (16.80%), Ratio(%) per element: [16.79, 16.4, 17.18, 17.57, 16.4, 16.01, 17.18, 16.4, 17.57, 16.79, 17.18, 15.62, 17.57, 16.4, 16.01, 16.79, 16.79, 16.4, 17.18, 17.57, 16.4, 16.79, 16.79, 16.79, 17.18, 16.4, 16.4, 17.96, 16.79, 16.4, 16.01, 17.57, 17.57, 17.18, 16.79, 16.4, 17.57, 16.79, 17.18, 17.18, 17.57, 17.18, 16.4, 16.4, 16.79, 16.4, 16.4, 16.79, 16.79, 16.01, 16.01, 17.57, 16.79, 15.62, 17.18, 16.4]
[rank1]:2026-01-01 02:31:58,277 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0231_rank1_stage1.svg
[rank1]:	> Counts Sum: 120400, Total Sum: 716800 (16.80%), Ratio(%) per element: [17.18, 16.4, 17.18, 16.79, 17.18, 16.4, 17.57, 16.01, 16.79, 17.57, 16.79, 16.01, 16.79, 16.79, 16.79, 16.79, 16.79, 17.18, 17.18, 16.79, 17.18, 16.79, 16.79, 17.18, 16.79, 17.18, 16.01, 16.79, 17.18, 16.79, 16.4, 16.79, 16.01, 16.79, 16.79, 17.57, 16.4, 16.79, 17.18, 17.57, 17.57, 17.57, 17.57, 16.79, 17.57, 17.18, 17.18, 17.18, 16.01, 16.4, 17.57, 16.01, 16.01, 16.79, 17.18, 16.4, 15.62, 15.23, 17.18, 16.79, 16.4, 16.4, 17.18, 16.4, 17.18, 16.01, 16.4, 17.18, 16.79, 15.62]
[rank3]:2026-01-01 02:31:58,374 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0231_rank3_stage3.svg
[rank3]:	> Counts Sum: 316720, Total Sum: 430080 (73.64%), Ratio(%) per element: [74.21, 74.6, 72.26, 74.21, 73.04, 70.7, 73.04, 73.04, 71.48, 73.43, 75.39, 73.82, 73.04, 73.82, 68.35, 71.87, 73.04, 74.21, 74.6, 75.0, 72.65, 75.78, 74.6, 73.82, 73.04, 76.95, 73.04, 71.87, 72.65, 73.82, 72.26, 75.0, 76.17, 74.6, 75.78, 74.21, 74.6, 75.78, 73.04, 72.26, 76.56, 71.09]
[rank0]:2026-01-01 02:31:58,669 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0231_stage0.svg
[rank2]:2026-01-01 02:31:58,667 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0231_stage2.svg
[rank1]:2026-01-01 02:31:58,687 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0231_stage1.svg
[rank3]:2026-01-01 02:31:58,794 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0231_stage3.svg
[rank3]:2026-01-01 02:32:21,786 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 02:32:22,051 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 02:32:22,050 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 02:32:22,011 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 02:35:18,706 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 02:35:22,681 - Avg. fwd time: 33.8247 / Avg. bwd time: 52.5734 / Avg. batch time: 836.5270 (ms) / GPU bubble ratio: 17.37%
[rank2]:2026-01-01 02:35:22,719 - Avg. fwd time: 25.8669 / Avg. bwd time: 30.0720 / Avg. batch time: 898.2455 (ms) / GPU bubble ratio: 50.18%
[rank0]:2026-01-01 02:35:22,772 - Avg. fwd time: 26.2316 / Avg. bwd time: 25.1343 / Avg. batch time: 1017.0064 (ms) / GPU bubble ratio: 59.59%
[rank0]:2026-01-01 02:35:22,776 -  step: 450  loss: -4.0000  grad_norm:  5.7298  memory: 13.15GiB(27.69%)  tps: 8,002  tflops: 62.56  mfu: 20.05%
[rank1]:2026-01-01 02:35:22,764 - Avg. fwd time: 32.9020 / Avg. bwd time: 38.1059 / Avg. batch time: 973.8041 (ms) / GPU bubble ratio: 41.67%
[rank1]:2026-01-01 02:35:22,776 -  step: 450  loss: -4.0000  grad_norm:  5.7298  memory: 12.17GiB(25.61%)  tps: 8,002  tflops: 62.56  mfu: 20.05%
[rank3]:2026-01-01 02:35:22,778 -  step: 450  loss: 12.7481  grad_norm:  5.7298  memory: 20.98GiB(44.15%)  tps: 8,003  tflops: 62.56  mfu: 20.05%
[rank2]:2026-01-01 02:35:22,776 -  step: 450  loss: -4.0000  grad_norm:  5.7298  memory:  7.28GiB(15.33%)  tps: 8,002  tflops: 62.56  mfu: 20.05%
[rank0]:2026-01-01 02:38:42,963 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 02:38:46,940 - Avg. fwd time: 33.8175 / Avg. bwd time: 52.5335 / Avg. batch time: 836.1459 (ms) / GPU bubble ratio: 17.38%
[rank2]:2026-01-01 02:38:46,979 - Avg. fwd time: 25.8645 / Avg. bwd time: 30.0709 / Avg. batch time: 897.7860 (ms) / GPU bubble ratio: 50.16%
[rank0]:2026-01-01 02:38:47,033 - Avg. fwd time: 26.2287 / Avg. bwd time: 25.1184 / Avg. batch time: 1015.4593 (ms) / GPU bubble ratio: 59.55%
[rank0]:2026-01-01 02:38:47,037 -  step: 500  loss: -4.0000  grad_norm:  6.3084  memory: 13.15GiB(27.69%)  tps: 8,021  tflops: 62.71  mfu: 20.10%
[rank3]:2026-01-01 02:38:47,038 -  step: 500  loss: 12.9581  grad_norm:  6.3084  memory: 20.98GiB(44.15%)  tps: 8,021  tflops: 62.71  mfu: 20.10%
[rank1]:2026-01-01 02:38:47,024 - Avg. fwd time: 32.8985 / Avg. bwd time: 38.1049 / Avg. batch time: 973.2841 (ms) / GPU bubble ratio: 41.64%
[rank1]:2026-01-01 02:38:47,036 -  step: 500  loss: -4.0000  grad_norm:  6.3084  memory: 12.17GiB(25.61%)  tps: 8,021  tflops: 62.71  mfu: 20.10%
[rank1]:2026-01-01 02:38:47,086 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0238_stage1_step500.svg
[rank2]:2026-01-01 02:38:47,036 -  step: 500  loss: -4.0000  grad_norm:  6.3084  memory:  7.28GiB(15.33%)  tps: 8,021  tflops: 62.71  mfu: 20.10%
[rank2]:2026-01-01 02:38:47,086 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0238_stage2_step500.svg
[rank0]:2026-01-01 02:38:47,086 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0238_stage0_step500.svg
[rank3]:2026-01-01 02:38:47,180 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0238_step500_rank3.svg
[rank3]:			> Batch Time: 996.00 ms, GPU Bubble Ratio: 58.96%, 43.16%, 55.20%, 31.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-26-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-28-305ms   | [S0,MB4,F]  305-25-330ms   | [S0,MB1,B]  383-28-411ms   | [S0,MB5,F]  411-25-437ms   | [S0,MB2,B]  487-28-516ms   | [S0,MB6,F]  516-25-542ms   | [S0,MB3,B]  592-28-620ms   | [S0,MB7,F]  620-25-645ms   | [S0,MB4,B]  697-28-726ms   | [S0,MB5,B]  798-28-826ms   | [S0,MB6,B]  898-28-926ms   | [S0,MB7,B]  996-0-996ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  228-37-266ms   | [S1,MB3,F]  273-32-306ms   | [S1,MB1,B]  334-38-372ms   | [S1,MB4,F]  379-32-412ms   | [S1,MB2,B]  438-38-477ms   | [S1,MB5,F]  484-32-517ms   | [S1,MB3,B]  543-38-582ms   | [S1,MB6,F]  589-32-622ms   | [S1,MB4,B]  648-38-687ms   | [S1,MB7,F]  694-33-727ms   | [S1,MB5,B]  753-38-791ms   | [S1,MB6,B]  853-37-891ms   | [S1,MB7,B]  953-36-989ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-218ms   | [S2,MB2,F]  225-25-251ms   | [S2,MB1,B]  293-30-323ms   | [S2,MB3,F]  331-25-356ms   | [S2,MB2,B]  398-30-428ms   | [S2,MB4,F]  435-25-461ms   | [S2,MB3,B]  503-30-533ms   | [S2,MB5,F]  540-25-566ms   | [S2,MB4,B]  607-30-638ms   | [S2,MB6,F]  645-25-671ms   | [S2,MB5,B]  712-30-743ms   | [S2,MB7,F]  749-25-775ms   | [S2,MB6,B]  816-30-847ms   | [S2,MB7,B]  918-28-947ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  230-52-283ms   | [S3,MB2,F]  290-33-324ms   | [S3,MB2,B]  336-51-388ms   | [S3,MB3,F]  395-34-429ms   | [S3,MB3,B]  441-51-493ms   | [S3,MB4,F]  500-34-534ms   | [S3,MB4,B]  545-52-598ms   | [S3,MB5,F]  605-33-638ms   | [S3,MB5,B]  650-51-702ms   | [S3,MB6,F]  709-33-743ms   | [S3,MB6,B]  755-52-807ms   | [S3,MB7,F]  814-34-848ms   | [S3,MB7,B]  859-51-910ms  
[rank0]:2026-01-01 02:38:47,251 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0238_rank0_stage0.svg
[rank0]:	> Counts Sum: 118720, Total Sum: 752640 (15.77%), Ratio(%) per element: [15.77, 15.47, 16.07, 16.36, 15.47, 15.17, 16.07, 15.47, 16.36, 15.77, 16.07, 14.88, 16.36, 15.47, 15.17, 15.77, 15.77, 15.47, 16.07, 16.36, 15.47, 15.77, 15.77, 15.77, 16.07, 15.47, 15.47, 16.66, 15.77, 15.47, 15.17, 16.36, 16.36, 16.07, 15.77, 15.47, 16.36, 15.77, 16.07, 16.07, 16.36, 16.07, 15.47, 15.47, 15.77, 15.47, 15.47, 15.77, 15.77, 15.17, 15.17, 16.36, 15.77, 14.88, 16.07, 15.47]
[rank3]:2026-01-01 02:38:47,222 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0238_stage3_step500.svg
[rank1]:2026-01-01 02:38:47,268 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0238_rank1_stage1.svg
[rank1]:	> Counts Sum: 148400, Total Sum: 940800 (15.77%), Ratio(%) per element: [16.07, 15.47, 16.07, 15.77, 16.07, 15.47, 16.36, 15.17, 15.77, 16.36, 15.77, 15.17, 15.77, 15.77, 15.77, 15.77, 15.77, 16.07, 16.07, 15.77, 16.07, 15.77, 15.77, 16.07, 15.77, 16.07, 15.17, 15.77, 16.07, 15.77, 15.47, 15.77, 15.17, 15.77, 15.77, 16.36, 15.47, 15.77, 16.07, 16.36, 16.36, 16.36, 16.36, 15.77, 16.36, 16.07, 16.07, 16.07, 15.17, 15.47, 16.36, 15.17, 15.17, 15.77, 16.07, 15.47, 14.88, 14.58, 16.07, 15.77, 15.47, 15.47, 16.07, 15.47, 16.07, 15.17, 15.47, 16.07, 15.77, 14.88]
[rank2]:2026-01-01 02:38:47,253 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0238_rank2_stage2.svg
[rank2]:	> Counts Sum: 118720, Total Sum: 752640 (15.77%), Ratio(%) per element: [15.17, 15.77, 15.77, 15.47, 15.77, 15.17, 16.07, 16.36, 15.47, 16.07, 15.77, 15.77, 16.07, 15.47, 15.77, 15.77, 15.77, 15.77, 15.47, 16.07, 15.47, 15.47, 15.47, 16.07, 16.07, 16.07, 15.17, 16.66, 16.07, 16.36, 15.17, 15.77, 15.17, 16.36, 15.47, 16.36, 15.17, 16.07, 16.07, 16.07, 15.17, 16.07, 16.07, 15.17, 15.77, 16.07, 16.66, 15.47, 15.17, 15.77, 16.07, 15.77, 15.47, 16.36, 14.88, 15.77]
[rank3]:2026-01-01 02:38:47,361 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0238_rank3_stage3.svg
[rank3]:	> Counts Sum: 424320, Total Sum: 564480 (75.17%), Ratio(%) per element: [75.29, 75.59, 74.1, 75.29, 75.0, 74.1, 75.59, 74.1, 72.61, 74.7, 77.38, 75.59, 75.59, 75.59, 70.83, 72.91, 74.4, 75.29, 75.59, 76.78, 73.8, 76.78, 75.59, 75.0, 74.4, 77.67, 75.29, 74.1, 75.59, 75.0, 74.1, 76.19, 77.08, 75.59, 77.38, 76.78, 75.59, 76.78, 74.4, 73.21, 76.78, 73.51]
[rank1]:2026-01-01 02:38:47,807 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0238_stage1.svg
[rank2]:2026-01-01 02:38:47,788 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0238_stage2.svg
[rank0]:2026-01-01 02:38:47,792 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0238_stage0.svg
[rank3]:2026-01-01 02:38:47,911 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0238_stage3.svg
[rank0]:2026-01-01 02:42:07,630 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 02:42:11,661 - Avg. fwd time: 33.8056 / Avg. bwd time: 52.4924 / Avg. batch time: 835.7248 (ms) / GPU bubble ratio: 17.39%
[rank3]:2026-01-01 02:42:11,761 -  step: 550  loss: 11.0990  grad_norm:  5.8120  memory: 20.98GiB(44.15%)  tps: 8,003  tflops: 62.56  mfu: 20.05%
[rank1]:2026-01-01 02:42:11,746 - Avg. fwd time: 32.8944 / Avg. bwd time: 38.1021 / Avg. batch time: 972.7573 (ms) / GPU bubble ratio: 41.61%
[rank1]:2026-01-01 02:42:11,759 -  step: 550  loss: -4.0000  grad_norm:  5.8120  memory: 12.17GiB(25.61%)  tps: 8,003  tflops: 62.56  mfu: 20.05%
[rank2]:2026-01-01 02:42:11,700 - Avg. fwd time: 25.8620 / Avg. bwd time: 30.0696 / Avg. batch time: 897.3126 (ms) / GPU bubble ratio: 50.13%
[rank2]:2026-01-01 02:42:11,759 -  step: 550  loss: -4.0000  grad_norm:  5.8120  memory:  7.28GiB(15.33%)  tps: 8,003  tflops: 62.56  mfu: 20.05%
[rank0]:2026-01-01 02:42:11,755 - Avg. fwd time: 26.2264 / Avg. bwd time: 25.1048 / Avg. batch time: 1014.0901 (ms) / GPU bubble ratio: 59.51%
[rank0]:2026-01-01 02:42:11,759 -  step: 550  loss: -4.0000  grad_norm:  5.8120  memory: 13.15GiB(27.69%)  tps: 8,003  tflops: 62.56  mfu: 20.05%
[rank0]:2026-01-01 02:45:32,336 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 02:45:36,477 - Avg. fwd time: 33.8110 / Avg. bwd time: 52.4786 / Avg. batch time: 835.6578 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 02:45:36,517 - Avg. fwd time: 25.8625 / Avg. bwd time: 30.0707 / Avg. batch time: 897.1952 (ms) / GPU bubble ratio: 50.13%
[rank0]:2026-01-01 02:45:36,573 - Avg. fwd time: 26.2275 / Avg. bwd time: 25.0954 / Avg. batch time: 1013.2410 (ms) / GPU bubble ratio: 59.48%
[rank0]:2026-01-01 02:45:36,578 -  step: 600  loss: -4.0000  grad_norm: 30.8447  memory: 13.15GiB(27.69%)  tps: 7,999  tflops: 62.53  mfu: 20.04%
[rank3]:2026-01-01 02:45:36,580 -  step: 600  loss: 10.0152  grad_norm: 30.8447  memory: 20.98GiB(44.15%)  tps: 7,999  tflops: 62.54  mfu: 20.04%
[rank1]:2026-01-01 02:45:36,564 - Avg. fwd time: 32.8972 / Avg. bwd time: 38.1056 / Avg. batch time: 972.6053 (ms) / GPU bubble ratio: 41.60%
[rank1]:2026-01-01 02:45:36,577 -  step: 600  loss: -4.0000  grad_norm: 30.8447  memory: 12.17GiB(25.61%)  tps: 7,999  tflops: 62.53  mfu: 20.04%
[rank1]:2026-01-01 02:45:36,631 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0245_stage1_step600.svg
[rank2]:2026-01-01 02:45:36,577 -  step: 600  loss: -4.0000  grad_norm: 30.8447  memory:  7.28GiB(15.33%)  tps: 7,999  tflops: 62.53  mfu: 20.04%
[rank2]:2026-01-01 02:45:36,630 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0245_stage2_step600.svg
[rank0]:2026-01-01 02:45:36,629 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0245_stage0_step600.svg
[rank3]:2026-01-01 02:45:36,745 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0245_step600_rank3.svg
[rank3]:			> Batch Time: 1007.00 ms, GPU Bubble Ratio: 59.26%, 43.44%, 55.51%, 31.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-307ms   | [S0,MB4,F]  307-25-332ms   | [S0,MB1,B]  385-28-414ms   | [S0,MB5,F]  414-25-439ms   | [S0,MB2,B]  491-28-520ms   | [S0,MB6,F]  520-25-546ms   | [S0,MB3,B]  597-28-625ms   | [S0,MB7,F]  625-25-651ms   | [S0,MB4,B]  703-28-732ms   | [S0,MB5,B]  807-28-835ms   | [S0,MB6,B]  908-28-937ms   | [S0,MB7,B]  1007-0-1007ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-98ms     | [S1,MB2,F]  104-33-137ms   | [S1,MB0,B]  229-38-268ms   | [S1,MB3,F]  275-32-307ms   | [S1,MB1,B]  336-38-375ms   | [S1,MB4,F]  382-33-415ms   | [S1,MB2,B]  442-38-481ms   | [S1,MB5,F]  488-33-521ms   | [S1,MB3,B]  547-38-586ms   | [S1,MB6,F]  593-33-627ms   | [S1,MB4,B]  654-38-692ms   | [S1,MB7,F]  700-33-733ms   | [S1,MB5,B]  761-38-800ms   | [S1,MB6,B]  863-38-901ms   | [S1,MB7,B]  964-36-1000ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  98-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  295-30-326ms   | [S2,MB3,F]  333-25-359ms   | [S2,MB2,B]  402-30-432ms   | [S2,MB4,F]  439-25-465ms   | [S2,MB3,B]  507-30-537ms   | [S2,MB5,F]  544-25-570ms   | [S2,MB4,B]  613-30-643ms   | [S2,MB6,F]  651-26-677ms   | [S2,MB5,B]  721-30-751ms   | [S2,MB7,F]  758-25-784ms   | [S2,MB6,B]  827-30-857ms   | [S2,MB7,B]  929-28-957ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  128-51-179ms   | [S3,MB1,F]  186-33-220ms   | [S3,MB1,B]  232-53-285ms   | [S3,MB2,F]  293-34-327ms   | [S3,MB2,B]  339-52-391ms   | [S3,MB3,F]  398-34-433ms   | [S3,MB3,B]  444-52-496ms   | [S3,MB4,F]  504-34-538ms   | [S3,MB4,B]  550-53-603ms   | [S3,MB5,F]  610-34-645ms   | [S3,MB5,B]  657-52-710ms   | [S3,MB6,F]  717-34-752ms   | [S3,MB6,B]  764-52-817ms   | [S3,MB7,F]  824-34-858ms   | [S3,MB7,B]  870-52-922ms  
[rank3]:2026-01-01 02:45:36,793 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0245_stage3_step600.svg
[rank1]:2026-01-01 02:45:36,823 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0245_rank1_stage1.svg
[rank1]:	> Counts Sum: 176400, Total Sum: 1164800 (15.14%), Ratio(%) per element: [15.38, 14.9, 15.38, 15.14, 15.38, 14.9, 15.62, 14.66, 15.14, 15.62, 15.14, 14.66, 15.14, 15.14, 15.14, 15.14, 15.14, 15.38, 15.38, 15.14, 15.38, 15.14, 15.14, 15.38, 15.14, 15.38, 14.66, 15.14, 15.38, 15.14, 14.9, 15.14, 14.66, 15.14, 15.14, 15.62, 14.9, 15.14, 15.38, 15.62, 15.62, 15.62, 15.62, 15.14, 15.62, 15.38, 15.38, 15.38, 14.66, 14.9, 15.62, 14.66, 14.66, 15.14, 15.38, 14.9, 14.42, 14.18, 15.38, 15.14, 14.9, 14.9, 15.38, 14.9, 15.38, 14.66, 14.9, 15.38, 15.14, 14.42]
[rank2]:2026-01-01 02:45:36,798 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0245_rank2_stage2.svg
[rank2]:	> Counts Sum: 141120, Total Sum: 931840 (15.14%), Ratio(%) per element: [14.66, 15.14, 15.14, 14.9, 15.14, 14.66, 15.38, 15.62, 14.9, 15.38, 15.14, 15.14, 15.38, 14.9, 15.14, 15.14, 15.14, 15.14, 14.9, 15.38, 14.9, 14.9, 14.9, 15.38, 15.38, 15.38, 14.66, 15.86, 15.38, 15.62, 14.66, 15.14, 14.66, 15.62, 14.9, 15.62, 14.66, 15.38, 15.38, 15.38, 14.66, 15.38, 15.38, 14.66, 15.14, 15.38, 15.86, 14.9, 14.66, 15.14, 15.38, 15.14, 14.9, 15.62, 14.42, 15.14]
[rank0]:2026-01-01 02:45:36,794 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0245_rank0_stage0.svg
[rank0]:	> Counts Sum: 141120, Total Sum: 931840 (15.14%), Ratio(%) per element: [15.14, 14.9, 15.38, 15.62, 14.9, 14.66, 15.38, 14.9, 15.62, 15.14, 15.38, 14.42, 15.62, 14.9, 14.66, 15.14, 15.14, 14.9, 15.38, 15.62, 14.9, 15.14, 15.14, 15.14, 15.38, 14.9, 14.9, 15.86, 15.14, 14.9, 14.66, 15.62, 15.62, 15.38, 15.14, 14.9, 15.62, 15.14, 15.38, 15.38, 15.62, 15.38, 14.9, 14.9, 15.14, 14.9, 14.9, 15.14, 15.14, 14.66, 14.66, 15.62, 15.14, 14.42, 15.38, 14.9]
[rank3]:2026-01-01 02:45:36,951 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0245_rank3_stage3.svg
[rank3]:	> Counts Sum: 531920, Total Sum: 698880 (76.11%), Ratio(%) per element: [75.72, 76.44, 75.24, 76.92, 76.44, 74.51, 76.44, 75.96, 73.79, 75.96, 78.36, 76.68, 76.2, 75.96, 72.59, 74.03, 75.48, 76.2, 76.92, 77.4, 75.0, 77.16, 75.96, 76.2, 75.72, 77.88, 76.44, 75.0, 76.2, 75.72, 75.0, 77.16, 77.88, 76.44, 77.88, 76.92, 76.92, 76.68, 75.72, 74.27, 77.4, 75.72]
[rank0]:2026-01-01 02:45:37,459 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0245_stage0.svg
[rank1]:2026-01-01 02:45:37,488 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0245_stage1.svg
[rank2]:2026-01-01 02:45:37,463 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0245_stage2.svg
[rank3]:2026-01-01 02:45:37,708 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0245_stage3.svg
[rank0]:2026-01-01 02:48:58,492 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 02:49:02,477 - Avg. fwd time: 33.8215 / Avg. bwd time: 52.4747 / Avg. batch time: 835.7094 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 02:49:02,516 - Avg. fwd time: 25.8645 / Avg. bwd time: 30.0728 / Avg. batch time: 897.2660 (ms) / GPU bubble ratio: 50.13%
[rank1]:2026-01-01 02:49:02,562 - Avg. fwd time: 32.9009 / Avg. bwd time: 38.1104 / Avg. batch time: 972.6477 (ms) / GPU bubble ratio: 41.59%
[rank1]:2026-01-01 02:49:02,575 -  step: 650  loss: -4.0000  grad_norm:  6.7507  memory: 12.17GiB(25.61%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank3]:2026-01-01 02:49:02,578 -  step: 650  loss: 12.3055  grad_norm:  6.7507  memory: 20.98GiB(44.15%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank2]:2026-01-01 02:49:02,575 -  step: 650  loss: -4.0000  grad_norm:  6.7507  memory:  7.28GiB(15.33%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank0]:2026-01-01 02:49:02,571 - Avg. fwd time: 26.2288 / Avg. bwd time: 25.0880 / Avg. batch time: 1012.6912 (ms) / GPU bubble ratio: 59.46%
[rank0]:2026-01-01 02:49:02,575 -  step: 650  loss: -4.0000  grad_norm:  6.7507  memory: 13.15GiB(27.69%)  tps: 7,954  tflops: 62.18  mfu: 19.93%
[rank0]:2026-01-01 02:52:23,135 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 02:52:27,149 - Avg. fwd time: 25.8644 / Avg. bwd time: 30.0731 / Avg. batch time: 897.1247 (ms) / GPU bubble ratio: 50.12%
[rank3]:2026-01-01 02:52:27,109 - Avg. fwd time: 33.8233 / Avg. bwd time: 52.4608 / Avg. batch time: 835.6101 (ms) / GPU bubble ratio: 17.39%
[rank2]:2026-01-01 02:52:27,210 -  step: 700  loss: -4.0000  grad_norm:  6.3277  memory:  7.28GiB(15.33%)  tps: 8,006  tflops: 62.59  mfu: 20.06%
[rank2]:2026-01-01 02:52:27,263 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0252_stage2_step700.svg
[rank1]:2026-01-01 02:52:27,196 - Avg. fwd time: 32.9016 / Avg. bwd time: 38.1120 / Avg. batch time: 972.4778 (ms) / GPU bubble ratio: 41.58%
[rank1]:2026-01-01 02:52:27,210 -  step: 700  loss: -4.0000  grad_norm:  6.3277  memory: 12.17GiB(25.61%)  tps: 8,006  tflops: 62.59  mfu: 20.06%
[rank1]:2026-01-01 02:52:27,264 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0252_stage1_step700.svg
[rank3]:2026-01-01 02:52:27,213 -  step: 700  loss: 13.1112  grad_norm:  6.3277  memory: 20.98GiB(44.15%)  tps: 8,007  tflops: 62.59  mfu: 20.06%
[rank0]:2026-01-01 02:52:27,206 - Avg. fwd time: 26.2285 / Avg. bwd time: 25.0804 / Avg. batch time: 1012.0143 (ms) / GPU bubble ratio: 59.44%
[rank0]:2026-01-01 02:52:27,211 -  step: 700  loss: -4.0000  grad_norm:  6.3277  memory: 13.15GiB(27.69%)  tps: 8,006  tflops: 62.59  mfu: 20.06%
[rank0]:2026-01-01 02:52:27,263 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0252_stage0_step700.svg
[rank3]:2026-01-01 02:52:27,357 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0252_step700_rank3.svg
[rank3]:			> Batch Time: 997.00 ms, GPU Bubble Ratio: 58.99%, 43.18%, 55.22%, 31.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-26-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  277-28-305ms   | [S0,MB4,F]  305-25-331ms   | [S0,MB1,B]  383-28-411ms   | [S0,MB5,F]  412-25-437ms   | [S0,MB2,B]  487-28-515ms   | [S0,MB6,F]  516-25-541ms   | [S0,MB3,B]  593-28-621ms   | [S0,MB7,F]  621-25-647ms   | [S0,MB4,B]  698-28-726ms   | [S0,MB5,B]  799-28-827ms   | [S0,MB6,B]  900-28-928ms   | [S0,MB7,B]  997-0-997ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  64-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  228-37-266ms   | [S1,MB3,F]  274-32-306ms   | [S1,MB1,B]  334-38-372ms   | [S1,MB4,F]  379-32-412ms   | [S1,MB2,B]  438-38-477ms   | [S1,MB5,F]  483-32-516ms   | [S1,MB3,B]  544-38-582ms   | [S1,MB6,F]  589-33-622ms   | [S1,MB4,B]  649-38-687ms   | [S1,MB7,F]  694-33-727ms   | [S1,MB5,B]  754-38-792ms   | [S1,MB6,B]  855-37-893ms   | [S1,MB7,B]  954-36-990ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  188-30-218ms   | [S2,MB2,F]  225-25-251ms   | [S2,MB1,B]  293-30-323ms   | [S2,MB3,F]  331-25-356ms   | [S2,MB2,B]  398-30-428ms   | [S2,MB4,F]  435-25-461ms   | [S2,MB3,B]  503-30-533ms   | [S2,MB5,F]  540-25-566ms   | [S2,MB4,B]  608-30-639ms   | [S2,MB6,F]  645-25-671ms   | [S2,MB5,B]  713-30-744ms   | [S2,MB7,F]  751-25-777ms   | [S2,MB6,B]  818-30-849ms   | [S2,MB7,B]  919-28-948ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-115ms    | [S3,MB0,B]  127-50-178ms   | [S3,MB1,F]  185-33-218ms   | [S3,MB1,B]  230-52-283ms   | [S3,MB2,F]  290-33-324ms   | [S3,MB2,B]  336-51-388ms   | [S3,MB3,F]  395-34-429ms   | [S3,MB3,B]  441-52-493ms   | [S3,MB4,F]  500-34-534ms   | [S3,MB4,B]  546-52-598ms   | [S3,MB5,F]  605-34-639ms   | [S3,MB5,B]  651-51-702ms   | [S3,MB6,F]  711-33-745ms   | [S3,MB6,B]  756-51-808ms   | [S3,MB7,F]  815-34-849ms   | [S3,MB7,B]  861-51-912ms  
[rank2]:2026-01-01 02:52:27,426 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0252_rank2_stage2.svg
[rank2]:	> Counts Sum: 163520, Total Sum: 1111040 (14.72%), Ratio(%) per element: [14.31, 14.71, 14.71, 14.51, 14.71, 14.31, 14.91, 15.12, 14.51, 14.91, 14.71, 14.71, 14.91, 14.51, 14.71, 14.71, 14.71, 14.71, 14.51, 14.91, 14.51, 14.51, 14.51, 14.91, 14.91, 14.91, 14.31, 15.32, 14.91, 15.12, 14.31, 14.71, 14.31, 15.12, 14.51, 15.12, 14.31, 14.91, 14.91, 14.91, 14.31, 14.91, 14.91, 14.31, 14.71, 14.91, 15.32, 14.51, 14.31, 14.71, 14.91, 14.71, 14.51, 15.12, 14.11, 14.71]
[rank1]:2026-01-01 02:52:27,452 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0252_rank1_stage1.svg
[rank1]:	> Counts Sum: 204400, Total Sum: 1388800 (14.72%), Ratio(%) per element: [14.91, 14.51, 14.91, 14.71, 14.91, 14.51, 15.12, 14.31, 14.71, 15.12, 14.71, 14.31, 14.71, 14.71, 14.71, 14.71, 14.71, 14.91, 14.91, 14.71, 14.91, 14.71, 14.71, 14.91, 14.71, 14.91, 14.31, 14.71, 14.91, 14.71, 14.51, 14.71, 14.31, 14.71, 14.71, 15.12, 14.51, 14.71, 14.91, 15.12, 15.12, 15.12, 15.12, 14.71, 15.12, 14.91, 14.91, 14.91, 14.31, 14.51, 15.12, 14.31, 14.31, 14.71, 14.91, 14.51, 14.11, 13.91, 14.91, 14.71, 14.51, 14.51, 14.91, 14.51, 14.91, 14.31, 14.51, 14.91, 14.71, 14.11]
[rank3]:2026-01-01 02:52:27,404 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0252_stage3_step700.svg
[rank0]:2026-01-01 02:52:27,432 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0252_rank0_stage0.svg
[rank0]:	> Counts Sum: 163520, Total Sum: 1111040 (14.72%), Ratio(%) per element: [14.71, 14.51, 14.91, 15.12, 14.51, 14.31, 14.91, 14.51, 15.12, 14.71, 14.91, 14.11, 15.12, 14.51, 14.31, 14.71, 14.71, 14.51, 14.91, 15.12, 14.51, 14.71, 14.71, 14.71, 14.91, 14.51, 14.51, 15.32, 14.71, 14.51, 14.31, 15.12, 15.12, 14.91, 14.71, 14.51, 15.12, 14.71, 14.91, 14.91, 15.12, 14.91, 14.51, 14.51, 14.71, 14.51, 14.51, 14.71, 14.71, 14.31, 14.31, 15.12, 14.71, 14.11, 14.91, 14.51]
[rank3]:2026-01-01 02:52:27,546 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0252_rank3_stage3.svg
[rank3]:	> Counts Sum: 639520, Total Sum: 833280 (76.75%), Ratio(%) per element: [76.2, 78.02, 76.41, 77.01, 76.81, 75.0, 77.21, 77.01, 74.79, 76.2, 79.03, 77.41, 77.41, 76.41, 73.58, 74.79, 76.61, 77.21, 77.21, 77.62, 75.4, 77.82, 76.2, 77.01, 76.81, 78.22, 76.81, 75.6, 77.01, 76.61, 75.4, 77.82, 77.62, 77.01, 78.02, 77.82, 77.21, 77.21, 76.2, 75.6, 78.22, 75.6]
[rank2]:2026-01-01 02:52:28,213 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0252_stage2.svg
[rank1]:2026-01-01 02:52:28,250 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0252_stage1.svg
[rank0]:2026-01-01 02:52:28,231 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0252_stage0.svg
[rank3]:2026-01-01 02:52:28,361 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0252_stage3.svg
[rank0]:2026-01-01 02:55:48,599 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-01 02:55:52,638 - Avg. fwd time: 33.8225 / Avg. bwd time: 52.4470 / Avg. batch time: 835.4922 (ms) / GPU bubble ratio: 17.40%
[rank2]:2026-01-01 02:55:52,678 - Avg. fwd time: 25.8639 / Avg. bwd time: 30.0731 / Avg. batch time: 896.9832 (ms) / GPU bubble ratio: 50.11%
[rank2]:2026-01-01 02:55:52,740 -  step: 750  loss: -4.0000  grad_norm:  4.8558  memory:  7.28GiB(15.33%)  tps: 7,972  tflops: 62.32  mfu: 19.97%
[rank1]:2026-01-01 02:55:52,725 - Avg. fwd time: 32.9011 / Avg. bwd time: 38.1124 / Avg. batch time: 972.3104 (ms) / GPU bubble ratio: 41.57%
[rank1]:2026-01-01 02:55:52,740 -  step: 750  loss: -4.0000  grad_norm:  4.8558  memory: 12.17GiB(25.61%)  tps: 7,972  tflops: 62.32  mfu: 19.97%
[rank0]:2026-01-01 02:55:52,736 - Avg. fwd time: 26.2284 / Avg. bwd time: 25.0737 / Avg. batch time: 1011.4068 (ms) / GPU bubble ratio: 59.42%
[rank0]:2026-01-01 02:55:52,740 -  step: 750  loss: -4.0000  grad_norm:  4.8558  memory: 13.15GiB(27.69%)  tps: 7,972  tflops: 62.32  mfu: 19.97%
[rank3]:2026-01-01 02:55:52,742 -  step: 750  loss: 11.0736  grad_norm:  4.8558  memory: 20.98GiB(44.15%)  tps: 7,972  tflops: 62.32  mfu: 19.97%
[rank0]:2026-01-01 02:59:13,183 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 02:59:17,317 - Avg. fwd time: 33.8233 / Avg. bwd time: 52.4368 / Avg. batch time: 835.4163 (ms) / GPU bubble ratio: 17.40%
[rank3]:2026-01-01 02:59:17,421 -  step: 800  loss:  9.8078  grad_norm: 27.2689  memory: 20.98GiB(44.15%)  tps: 8,005  tflops: 62.58  mfu: 20.06%
[rank3]:2026-01-01 02:59:17,422 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm: 27.2689  tps: 8,429  tflops: 65.89  mfu: 19.34%
[rank3]:2026-01-01 02:59:17,422 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 02:59:17,423 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 02:59:17,405 - Avg. fwd time: 32.9016 / Avg. bwd time: 38.1137 / Avg. batch time: 972.1822 (ms) / GPU bubble ratio: 41.56%
[rank1]:2026-01-01 02:59:17,419 -  step: 800  loss: -4.0000  grad_norm: 27.2689  memory: 12.17GiB(25.61%)  tps: 8,005  tflops: 62.58  mfu: 20.06%
[rank1]:2026-01-01 02:59:17,419 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2689  tps: 8,423  tflops: 65.85  mfu: 19.21%
[rank1]:2026-01-01 02:59:17,419 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 02:59:17,420 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 02:59:17,357 - Avg. fwd time: 25.8641 / Avg. bwd time: 30.0736 / Avg. batch time: 896.8755 (ms) / GPU bubble ratio: 50.10%
[rank2]:2026-01-01 02:59:17,419 -  step: 800  loss: -4.0000  grad_norm: 27.2689  memory:  7.28GiB(15.33%)  tps: 8,005  tflops: 62.58  mfu: 20.06%
[rank2]:2026-01-01 02:59:17,419 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2689  tps: 8,424  tflops: 65.85  mfu: 19.22%
[rank2]:2026-01-01 02:59:17,419 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 02:59:17,420 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 02:59:17,415 - Avg. fwd time: 26.2290 / Avg. bwd time: 25.0681 / Avg. batch time: 1010.8951 (ms) / GPU bubble ratio: 59.40%
[rank0]:2026-01-01 02:59:17,419 -  step: 800  loss: -4.0000  grad_norm: 27.2689  memory: 13.15GiB(27.69%)  tps: 8,005  tflops: 62.58  mfu: 20.06%
[rank0]:2026-01-01 02:59:17,420 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 27.2689  tps: 8,424  tflops: 65.86  mfu: 19.23%
[rank0]:2026-01-01 02:59:17,420 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 02:59:17,420 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 02:59:19,683 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-01 02:59:19,754 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/260101_0259_stage0_final800.svg
[rank1]:2026-01-01 02:59:19,752 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/260101_0259_stage1_final800.svg
[rank2]:2026-01-01 02:59:19,751 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/260101_0259_stage2_final800.svg
[rank3]:2026-01-01 02:59:19,846 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0259_final800_rank3.svg
[rank3]:			> Batch Time: 1003.00 ms, GPU Bubble Ratio: 59.16%, 43.39%, 55.40%, 31.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-26-26ms      | [S0,MB1,F]  26-27-53ms     | [S0,MB2,F]  53-27-80ms     | [S0,MB3,F]  80-26-107ms    | [S0,MB0,B]  278-28-306ms   | [S0,MB4,F]  306-25-332ms   | [S0,MB1,B]  384-28-413ms   | [S0,MB5,F]  413-25-438ms   | [S0,MB2,B]  489-28-517ms   | [S0,MB6,F]  518-25-543ms   | [S0,MB3,B]  594-28-622ms   | [S0,MB7,F]  623-25-648ms   | [S0,MB4,B]  701-28-729ms   | [S0,MB5,B]  802-28-831ms   | [S0,MB6,B]  903-28-932ms   | [S0,MB7,B]  1003-0-1003ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  26-32-58ms     | [S1,MB1,F]  65-32-97ms     | [S1,MB2,F]  104-32-137ms   | [S1,MB0,B]  229-38-267ms   | [S1,MB3,F]  274-32-307ms   | [S1,MB1,B]  335-38-374ms   | [S1,MB4,F]  381-33-414ms   | [S1,MB2,B]  440-38-478ms   | [S1,MB5,F]  485-33-518ms   | [S1,MB3,B]  545-38-584ms   | [S1,MB6,F]  591-33-624ms   | [S1,MB4,B]  652-38-690ms   | [S1,MB7,F]  697-33-730ms   | [S1,MB5,B]  757-38-795ms   | [S1,MB6,B]  859-37-897ms   | [S1,MB7,B]  959-36-996ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  58-25-84ms     | [S2,MB1,F]  97-25-123ms    | [S2,MB0,B]  189-30-219ms   | [S2,MB2,F]  226-25-252ms   | [S2,MB1,B]  295-30-325ms   | [S2,MB3,F]  332-25-358ms   | [S2,MB2,B]  400-30-430ms   | [S2,MB4,F]  437-25-463ms   | [S2,MB3,B]  505-30-535ms   | [S2,MB5,F]  542-25-568ms   | [S2,MB4,B]  611-30-641ms   | [S2,MB6,F]  649-25-674ms   | [S2,MB5,B]  717-30-747ms   | [S2,MB7,F]  754-25-780ms   | [S2,MB6,B]  822-30-852ms   | [S2,MB7,B]  924-28-952ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  84-31-116ms    | [S3,MB0,B]  127-51-179ms   | [S3,MB1,F]  186-33-219ms   | [S3,MB1,B]  231-53-284ms   | [S3,MB2,F]  292-33-325ms   | [S3,MB2,B]  337-51-389ms   | [S3,MB3,F]  397-34-431ms   | [S3,MB3,B]  442-52-495ms   | [S3,MB4,F]  502-34-536ms   | [S3,MB4,B]  548-53-601ms   | [S3,MB5,F]  608-34-642ms   | [S3,MB5,B]  654-52-706ms   | [S3,MB6,F]  713-34-747ms   | [S3,MB6,B]  759-52-812ms   | [S3,MB7,F]  819-34-854ms   | [S3,MB7,B]  865-52-917ms  
[rank1]:2026-01-01 02:59:19,936 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0259_rank1_stage1.svg
[rank1]:	> Counts Sum: 232400, Total Sum: 1612800 (14.41%), Ratio(%) per element: [14.58, 14.23, 14.58, 14.4, 14.58, 14.23, 14.75, 14.06, 14.4, 14.75, 14.4, 14.06, 14.4, 14.4, 14.4, 14.4, 14.4, 14.58, 14.58, 14.4, 14.58, 14.4, 14.4, 14.58, 14.4, 14.58, 14.06, 14.4, 14.58, 14.4, 14.23, 14.4, 14.06, 14.4, 14.4, 14.75, 14.23, 14.4, 14.58, 14.75, 14.75, 14.75, 14.75, 14.4, 14.75, 14.58, 14.58, 14.58, 14.06, 14.23, 14.75, 14.06, 14.06, 14.4, 14.58, 14.23, 13.88, 13.71, 14.58, 14.4, 14.23, 14.23, 14.58, 14.23, 14.58, 14.06, 14.23, 14.58, 14.4, 13.88]
[rank2]:2026-01-01 02:59:19,916 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0259_rank2_stage2.svg
[rank2]:	> Counts Sum: 185920, Total Sum: 1290240 (14.41%), Ratio(%) per element: [14.06, 14.4, 14.4, 14.23, 14.4, 14.06, 14.58, 14.75, 14.23, 14.58, 14.4, 14.4, 14.58, 14.23, 14.4, 14.4, 14.4, 14.4, 14.23, 14.58, 14.23, 14.23, 14.23, 14.58, 14.58, 14.58, 14.06, 14.93, 14.58, 14.75, 14.06, 14.4, 14.06, 14.75, 14.23, 14.75, 14.06, 14.58, 14.58, 14.58, 14.06, 14.58, 14.58, 14.06, 14.4, 14.58, 14.93, 14.23, 14.06, 14.4, 14.58, 14.4, 14.23, 14.75, 13.88, 14.4]
[rank0]:2026-01-01 02:59:19,919 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0259_rank0_stage0.svg
[rank0]:	> Counts Sum: 185920, Total Sum: 1290240 (14.41%), Ratio(%) per element: [14.4, 14.23, 14.58, 14.75, 14.23, 14.06, 14.58, 14.23, 14.75, 14.4, 14.58, 13.88, 14.75, 14.23, 14.06, 14.4, 14.4, 14.23, 14.58, 14.75, 14.23, 14.4, 14.4, 14.4, 14.58, 14.23, 14.23, 14.93, 14.4, 14.23, 14.06, 14.75, 14.75, 14.58, 14.4, 14.23, 14.75, 14.4, 14.58, 14.58, 14.75, 14.58, 14.23, 14.23, 14.4, 14.23, 14.23, 14.4, 14.4, 14.06, 14.06, 14.75, 14.4, 13.88, 14.58, 14.23]
[rank3]:2026-01-01 02:59:19,986 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/pipeline_schedule/260101_0259_thry_final800_rank3.svg
[rank3]:			> Batch Time: 979.30 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-29-29ms      | [S0,MB1,F]  29-29-59ms     | [S0,MB2,F]  59-29-89ms     | [S0,MB3,F]  89-29-118ms    | [S0,MB0,B]  296-59-356ms   | [S0,MB4,F]  356-29-385ms   | [S0,MB1,B]  385-59-445ms   | [S0,MB5,F]  445-29-474ms   | [S0,MB2,B]  474-59-534ms   | [S0,MB6,F]  534-29-563ms   | [S0,MB3,B]  563-59-623ms   | [S0,MB7,F]  623-29-652ms   | [S0,MB4,B]  652-59-712ms   | [S0,MB5,B]  741-59-801ms   | [S0,MB6,B]  830-59-890ms   | [S0,MB7,B]  919-59-979ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  29-29-59ms     | [S1,MB1,F]  59-29-89ms     | [S1,MB2,F]  89-29-118ms    | [S1,MB0,B]  237-59-296ms   | [S1,MB3,F]  296-29-326ms   | [S1,MB1,B]  326-59-385ms   | [S1,MB4,F]  385-29-415ms   | [S1,MB2,B]  415-59-474ms   | [S1,MB5,F]  474-29-504ms   | [S1,MB3,B]  504-59-563ms   | [S1,MB6,F]  563-29-593ms   | [S1,MB4,B]  593-59-652ms   | [S1,MB7,F]  652-29-682ms   | [S1,MB5,B]  682-59-741ms   | [S1,MB6,B]  771-59-830ms   | [S1,MB7,B]  860-59-919ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  59-29-89ms     | [S2,MB1,F]  89-29-118ms    | [S2,MB0,B]  178-59-237ms   | [S2,MB2,F]  237-29-267ms   | [S2,MB1,B]  267-59-326ms   | [S2,MB3,F]  326-29-356ms   | [S2,MB2,B]  356-59-415ms   | [S2,MB4,F]  415-29-445ms   | [S2,MB3,B]  445-59-504ms   | [S2,MB5,F]  504-29-534ms   | [S2,MB4,B]  534-59-593ms   | [S2,MB6,F]  593-29-623ms   | [S2,MB5,B]  623-59-682ms   | [S2,MB7,F]  682-29-712ms   | [S2,MB6,B]  712-59-771ms   | [S2,MB7,B]  801-59-860ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  89-29-118ms    | [S3,MB0,B]  118-59-178ms   | [S3,MB1,F]  178-29-207ms   | [S3,MB1,B]  207-59-267ms   | [S3,MB2,F]  267-29-296ms   | [S3,MB2,B]  296-59-356ms   | [S3,MB3,F]  356-29-385ms   | [S3,MB3,B]  385-59-445ms   | [S3,MB4,F]  445-29-474ms   | [S3,MB4,B]  474-59-534ms   | [S3,MB5,F]  534-29-563ms   | [S3,MB5,B]  563-59-623ms   | [S3,MB6,F]  623-29-652ms   | [S3,MB6,B]  652-59-712ms   | [S3,MB7,F]  712-29-741ms   | [S3,MB7,B]  741-59-801ms  
[rank3]:2026-01-01 02:59:20,034 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/260101_0259_stage3_final800.svg
[rank3]:2026-01-01 02:59:20,174 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/frozen_params_histogram/260101_0259_rank3_stage3.svg
[rank3]:	> Counts Sum: 747120, Total Sum: 967680 (77.21%), Ratio(%) per element: [76.73, 77.95, 77.08, 77.43, 77.08, 75.52, 77.77, 77.43, 75.52, 76.9, 79.34, 77.43, 77.6, 77.25, 74.47, 75.34, 76.9, 78.12, 77.43, 78.29, 76.04, 78.47, 76.56, 77.08, 76.73, 78.47, 77.6, 76.38, 77.6, 76.56, 75.69, 78.12, 77.95, 77.43, 78.29, 78.47, 77.6, 78.12, 76.9, 76.38, 78.29, 76.21]
[rank2]:2026-01-01 02:59:20,822 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0259_stage2.svg
[rank2]:2026-01-01 02:59:20,825 - Destroying the purge thread.
[rank0]:2026-01-01 02:59:20,839 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0259_stage0.svg
[rank0]:2026-01-01 02:59:20,841 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-01 02:59:20,853 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0259_stage1.svg
[rank1]:2026-01-01 02:59:20,854 - Destroying the purge thread.
[rank1]:2026-01-01 02:59:21,030 - Process group destroyed
[rank2]:2026-01-01 02:59:21,011 - Process group destroyed
[rank3]:2026-01-01 02:59:21,106 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1/afr_time_plot/260101_0259_stage3.svg
[rank3]:2026-01-01 02:59:21,108 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–‚â–‚â–â–‚â–ˆâ–â–â–â–ˆâ–â–â–â–‡â–â–â–â–†
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.88762
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 19.33762
[rank3]:wandb:             final/avg_tflops 65.89248
[rank3]:wandb:    final/avg_throughput(tps) 8428.80093
[rank3]:wandb:              final/grad_norm 27.26894
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 27.26894
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_1F1B_timelyapf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/osdll4dr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_1F1B_timelyapf_42_dm1/20260101-0204/wandb/run-20260101_020411-osdll4dr/logs
[rank3]:2026-01-01 02:59:22,536 - Process group destroyed
[rank0]:2026-01-01 02:59:22,841 - Training completed
[rank0]:2026-01-01 02:59:22,842 - Destroying the purge thread.
[rank0]:2026-01-01 02:59:23,040 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.5', 'layers.7', 'layers.6', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.12', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.13', 'norm', 'output', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_1F1B_timelyapf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_1F1B_timelyapf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_1F1B_timelyapf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_1F1B_timelyapf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_1F1B_timelyapf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_1F1B_timelyapf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_1F1B_timelyapf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_1F1B_timelyapf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
