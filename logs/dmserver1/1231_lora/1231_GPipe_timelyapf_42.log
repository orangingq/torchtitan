
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 20:43:47 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_GPipe_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-31 20:43:54,751 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:2025-12-31 20:43:54,751 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank0]:2025-12-31 20:43:54,936 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank2]:2025-12-31 20:43:55,027 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 20:43:55,030 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-31 20:43:55,039 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank1]:2025-12-31 20:43:55,043 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 20:43:55,045 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 20:43:55,218 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 20:43:55,221 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 20:43:55,224 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 20:43:55,226 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-31 20:43:55,267 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 20:43:55,269 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 20:43:55,617 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-31 20:43:58,503 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 20:43:58,540 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 20:43:58,542 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 20:43:58,570 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-31 20:43:58,570 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-31 20:43:58,580 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 20:43:58,608 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-31 20:43:58,608 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-31 20:43:58,755 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 20:43:58,755 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 20:43:58,755 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-31 20:43:58,786 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 20:43:58,786 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 20:43:58,786 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 6biu9n2z
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_GPipe_timelyapf_42_dm1/20251231-2043/wandb/run-20251231_204359-6biu9n2z
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_GPipe_timelyapf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/6biu9n2z
[rank3]:2025-12-31 20:44:00,631 - WandB logging enabled
[rank3]:2025-12-31 20:44:00,632 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 20:44:00,670 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 20:44:00,699 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-31 20:44:00,699 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-31 20:44:00,904 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 20:44:00,905 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 20:44:00,905 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-12-31 20:44:06,395 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-31 20:44:06,544 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 20:44:06,583 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 20:44:06,584 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 20:44:06,608 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-31 20:44:06,608 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-31 20:44:06,809 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 20:44:06,809 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 20:44:06,810 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank0]:2025-12-31 20:44:06,826 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_GPipe_timelyapf_42_dm1
[rank0]:2025-12-31 20:44:06,826 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 20:44:06,827 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 20:44:06,827 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-31 20:44:06,827 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-31 20:44:06,826 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-31 20:44:06,827 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 20:44:09,397 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 20:44:09,397 - Finished loading the checkpoint in 2.57 seconds.
[rank0]:2025-12-31 20:44:09,503 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2025-12-31 20:44:09,504 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2025-12-31 20:44:09,504 - Training starts at step 1
[rank1]:2025-12-31 20:44:09,514 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2025-12-31 20:44:09,515 - Freezable Parameters: [Stage 1] 70 params
[rank2]:2025-12-31 20:44:09,500 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2025-12-31 20:44:09,501 - Freezable Parameters: [Stage 2] 56 params
[rank3]:2025-12-31 20:44:09,499 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2025-12-31 20:44:09,500 - Freezable Parameters: [Stage 3] 42 params
[rank3]:2025-12-31 20:44:14,651 -  step:  1  loss: 10.6088  grad_norm:  5.6781  memory: 29.95GiB(63.04%)  tps: 2,344  tflops: 18.33  mfu: 5.87%
[rank3]:2025-12-31 20:44:14,651 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 20:44:14,646 -  step:  1  loss: -8.0000  grad_norm:  5.6781  memory: 13.85GiB(29.15%)  tps: 2,040  tflops: 15.94  mfu: 5.11%
[rank2]:2025-12-31 20:44:14,647 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 20:44:14,664 -  step:  1  loss: -8.0000  grad_norm:  5.6781  memory: 14.51GiB(30.55%)  tps: 4,055  tflops: 31.70  mfu: 10.16%
[rank0]:2025-12-31 20:44:14,664 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-31 20:44:14,671 -  step:  1  loss: -8.0000  grad_norm:  5.6781  memory: 17.18GiB(36.17%)  tps: 2,032  tflops: 15.88  mfu: 5.09%
[rank1]:2025-12-31 20:44:14,671 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 20:45:50,085 - Avg. fwd time: 16.5197 / Avg. bwd time: 25.0596 / Avg. batch time: 392.7868 (ms) / GPU bubble ratio: 15.31%
[rank1]:2025-12-31 20:45:50,127 - Avg. fwd time: 15.4642 / Avg. bwd time: 16.5785 / Avg. batch time: 460.1945 (ms) / GPU bubble ratio: 44.30%
[rank0]:2025-12-31 20:45:50,145 - Avg. fwd time: 13.5043 / Avg. bwd time: 12.2677 / Avg. batch time: 491.4605 (ms) / GPU bubble ratio: 58.05%
[rank2]:2025-12-31 20:45:50,103 - Avg. fwd time: 12.2432 / Avg. bwd time: 12.8950 / Avg. batch time: 422.4098 (ms) / GPU bubble ratio: 52.39%
[rank0]:2025-12-31 20:47:26,042 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 20:47:29,995 - Avg. fwd time: 15.4856 / Avg. bwd time: 16.5308 / Avg. batch time: 459.8557 (ms) / GPU bubble ratio: 44.30%
[rank3]:2025-12-31 20:47:29,952 - Avg. fwd time: 16.5790 / Avg. bwd time: 25.1888 / Avg. batch time: 393.9368 (ms) / GPU bubble ratio: 15.18%
[rank3]:2025-12-31 20:47:30,018 -  step: 50  loss: 12.4620  grad_norm:  4.3532  memory: 29.95GiB(63.04%)  tps: 8,219  tflops: 64.25  mfu: 20.59%
[rank2]:2025-12-31 20:47:29,971 - Avg. fwd time: 12.2516 / Avg. bwd time: 12.9103 / Avg. batch time: 423.0463 (ms) / GPU bubble ratio: 52.42%
[rank2]:2025-12-31 20:47:30,016 -  step: 50  loss: -8.0000  grad_norm:  4.3532  memory: 13.85GiB(29.15%)  tps: 8,218  tflops: 64.25  mfu: 20.59%
[rank0]:2025-12-31 20:47:30,013 - Avg. fwd time: 13.4649 / Avg. bwd time: 12.2893 / Avg. batch time: 490.4578 (ms) / GPU bubble ratio: 57.99%
[rank0]:2025-12-31 20:47:30,016 -  step: 50  loss: -8.0000  grad_norm:  4.3532  memory: 14.51GiB(30.55%)  tps: 8,219  tflops: 64.25  mfu: 20.59%
[rank1]:2025-12-31 20:47:30,016 -  step: 50  loss: -8.0000  grad_norm:  4.3532  memory: 17.18GiB(36.17%)  tps: 8,219  tflops: 64.26  mfu: 20.59%
[rank3]:2025-12-31 20:48:05,920 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-31 20:48:45,948 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-31 20:48:46,054 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-31 20:49:09,131 - Avg. fwd time: 16.6185 / Avg. bwd time: 25.1933 / Avg. batch time: 394.1696 (ms) / GPU bubble ratio: 15.14%
[rank2]:2025-12-31 20:49:09,149 - Avg. fwd time: 12.2590 / Avg. bwd time: 12.8338 / Avg. batch time: 423.0376 (ms) / GPU bubble ratio: 52.55%
[rank1]:2025-12-31 20:49:09,170 - Avg. fwd time: 15.5009 / Avg. bwd time: 16.3932 / Avg. batch time: 459.3356 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-12-31 20:49:09,175 - Avg. fwd time: 13.4647 / Avg. bwd time: 11.3133 / Avg. batch time: 488.7293 (ms) / GPU bubble ratio: 59.44%
[rank3]:2025-12-31 20:49:24,418 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-31 20:49:24,691 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2049_max_batch_time.svg
[rank3]:			> Batch Time: 422.63 ms, GPU Bubble Ratio: 51.11%, 39.30%, 52.12%, 19.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  230-12-243ms   | [S0,MB1,B]  256-12-268ms   | [S0,MB2,B]  281-12-293ms   | [S0,MB3,B]  306-12-319ms   | [S0,MB4,B]  333-12-345ms   | [S0,MB5,B]  358-12-371ms   | [S0,MB6,B]  384-12-396ms   | [S0,MB7,B]  410-12-422ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-138ms   | [S1,MB0,B]  214-16-230ms   | [S1,MB1,B]  239-16-256ms   | [S1,MB2,B]  265-16-281ms   | [S1,MB3,B]  290-16-306ms   | [S1,MB4,B]  316-16-333ms   | [S1,MB5,B]  342-16-358ms   | [S1,MB6,B]  367-16-384ms   | [S1,MB7,B]  393-16-410ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  45-12-57ms     | [S2,MB2,F]  60-12-73ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-119ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  138-12-151ms   | [S2,MB0,B]  201-13-214ms   | [S2,MB1,B]  226-13-239ms   | [S2,MB2,B]  252-12-265ms   | [S2,MB3,B]  277-12-290ms   | [S2,MB4,B]  303-13-316ms   | [S2,MB5,B]  329-12-342ms   | [S2,MB6,B]  354-12-367ms   | [S2,MB7,B]  380-13-393ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-17-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-24-201ms   AFR(10):0.9762 | [S3,MB1,B]  201-25-226ms   AFR(10):0.9762 | [S3,MB2,B]  226-25-252ms   AFR(10):0.9762 | [S3,MB3,B]  252-25-277ms   AFR(10):0.9762 | [S3,MB4,B]  277-25-303ms   AFR(10):0.9762 | [S3,MB5,B]  303-25-329ms   AFR(10):0.9762 | [S3,MB6,B]  329-25-354ms   AFR(10):0.9762 | [S3,MB7,B]  354-25-380ms   AFR(10):0.9762
[rank3]:2025-12-31 20:49:24,820 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2049_min_batch_time.svg
[rank3]:			> Batch Time: 399.03 ms, GPU Bubble Ratio: 72.98%, 38.75%, 51.67%, 17.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  226-0-226ms    | [S0,MB1,B]  251-0-251ms    | [S0,MB2,B]  275-0-275ms    | [S0,MB3,B]  300-0-300ms    | [S0,MB4,B]  324-0-324ms    | [S0,MB5,B]  349-0-349ms    | [S0,MB6,B]  374-0-374ms    | [S0,MB7,B]  399-0-399ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-138ms   | [S1,MB0,B]  212-14-226ms   | [S1,MB1,B]  236-14-251ms   | [S1,MB2,B]  260-14-275ms   | [S1,MB3,B]  285-14-300ms   | [S1,MB4,B]  309-14-324ms   | [S1,MB5,B]  334-15-349ms   | [S1,MB6,B]  359-15-374ms   | [S1,MB7,B]  383-15-399ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  45-12-57ms     | [S2,MB2,F]  60-12-73ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-119ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  138-12-151ms   | [S2,MB0,B]  200-11-212ms   | [S2,MB1,B]  224-11-236ms   | [S2,MB2,B]  248-11-260ms   | [S2,MB3,B]  273-11-285ms   | [S2,MB4,B]  297-11-309ms   | [S2,MB5,B]  322-11-334ms   | [S2,MB6,B]  347-11-359ms   | [S2,MB7,B]  372-11-383ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-17-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-23-200ms   AFR(10):0.9762 | [S3,MB1,B]  200-24-224ms   AFR(10):0.9762 | [S3,MB2,B]  224-24-248ms   AFR(10):0.9762 | [S3,MB3,B]  248-24-273ms   AFR(10):0.9762 | [S3,MB4,B]  273-24-297ms   AFR(10):0.9762 | [S3,MB5,B]  297-24-322ms   AFR(10):0.9762 | [S3,MB6,B]  322-24-347ms   AFR(10):0.9762 | [S3,MB7,B]  347-24-372ms   AFR(10):0.9762
[rank3]:2025-12-31 20:49:24,961 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2049_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 400.40 ms, GPU Bubble Ratio: 51.45%, 36.33%, 49.77%, 17.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  229-12-241ms   | [S0,MB1,B]  254-12-266ms   | [S0,MB2,B]  278-12-290ms   | [S0,MB3,B]  303-12-315ms   | [S0,MB4,B]  328-12-340ms   | [S0,MB5,B]  352-12-364ms   | [S0,MB6,B]  378-12-390ms   | [S0,MB7,B]  400-0-400ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  29-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-92ms     | [S1,MB5,F]  92-15-107ms    | [S1,MB6,F]  107-15-123ms   | [S1,MB7,F]  123-15-138ms   | [S1,MB0,B]  213-16-229ms   | [S1,MB1,B]  237-16-254ms   | [S1,MB2,B]  261-16-278ms   | [S1,MB3,B]  286-16-303ms   | [S1,MB4,B]  311-16-328ms   | [S1,MB5,B]  336-16-352ms   | [S1,MB6,B]  361-16-378ms   | [S1,MB7,B]  385-15-400ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  45-12-57ms     | [S2,MB2,F]  60-12-73ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  92-12-104ms    | [S2,MB5,F]  107-12-119ms   | [S2,MB6,F]  123-12-135ms   | [S2,MB7,F]  138-12-151ms   | [S2,MB0,B]  200-13-213ms   | [S2,MB1,B]  224-13-237ms   | [S2,MB2,B]  248-12-261ms   | [S2,MB3,B]  273-12-286ms   | [S2,MB4,B]  298-13-311ms   | [S2,MB5,B]  323-12-336ms   | [S2,MB6,B]  348-12-361ms   | [S2,MB7,B]  373-11-385ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  58-16-75ms     | [S3,MB2,F]  75-16-91ms     | [S3,MB3,F]  91-16-108ms    | [S3,MB4,F]  108-16-125ms   | [S3,MB5,F]  125-17-142ms   | [S3,MB6,F]  142-16-159ms   | [S3,MB7,F]  159-16-176ms   | [S3,MB0,B]  176-23-200ms   AFR(10):0.9762 | [S3,MB1,B]  200-24-224ms   AFR(10):0.9762 | [S3,MB2,B]  224-24-248ms   AFR(10):0.9762 | [S3,MB3,B]  248-25-273ms   AFR(10):0.9762 | [S3,MB4,B]  273-24-298ms   AFR(10):0.9762 | [S3,MB5,B]  298-24-323ms   AFR(10):0.9762 | [S3,MB6,B]  323-25-348ms   AFR(10):0.9762 | [S3,MB7,B]  348-24-373ms   AFR(10):0.9762
[rank3]:2025-12-31 20:49:24,962 - 	> Batch Time: 400.40 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.05)
[rank1]:2025-12-31 20:50:44,349 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-12-31 20:50:44,339 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank3]:2025-12-31 20:50:44,337 - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.13/0.40, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank0]:2025-12-31 20:50:44,332 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 20:50:44,345 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-12-31 20:50:48,351 - Avg. fwd time: 15.5215 / Avg. bwd time: 16.4829 / Avg. batch time: 459.9871 (ms) / GPU bubble ratio: 44.34%
[rank1]:2025-12-31 20:50:48,372 -  step: 100  loss: -8.0000  grad_norm:  3.3859  memory: 17.20GiB(36.20%)  tps: 8,260  tflops: 64.57  mfu: 20.70%
[rank2]:2025-12-31 20:50:48,324 - Avg. fwd time: 12.2636 / Avg. bwd time: 12.8024 / Avg. batch time: 422.9249 (ms) / GPU bubble ratio: 52.59%
[rank2]:2025-12-31 20:50:48,372 -  step: 100  loss: -8.0000  grad_norm:  3.3859  memory: 13.86GiB(29.17%)  tps: 8,260  tflops: 64.57  mfu: 20.70%
[rank3]:2025-12-31 20:50:48,306 - Avg. fwd time: 16.6452 / Avg. bwd time: 25.1323 / Avg. batch time: 393.8345 (ms) / GPU bubble ratio: 15.14%
[rank3]:2025-12-31 20:50:48,374 -  step: 100  loss: 13.1172  grad_norm:  3.3859  memory: 29.96GiB(63.05%)  tps: 8,260  tflops: 64.57  mfu: 20.70%
[rank0]:2025-12-31 20:50:48,368 - Avg. fwd time: 13.4622 / Avg. bwd time: 10.9153 / Avg. batch time: 487.8362 (ms) / GPU bubble ratio: 60.02%
[rank0]:2025-12-31 20:50:48,372 -  step: 100  loss: -8.0000  grad_norm:  3.3859  memory: 14.52GiB(30.57%)  tps: 8,260  tflops: 64.57  mfu: 20.70%
[rank1]:2025-12-31 20:50:48,434 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2050_stage1_step100.svg
[rank2]:2025-12-31 20:50:48,434 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2050_stage2_step100.svg
[rank0]:2025-12-31 20:50:48,434 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2050_stage0_step100.svg
[rank3]:2025-12-31 20:50:48,511 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2050_step100_rank3.svg
[rank3]:			> Batch Time: 495.18 ms, GPU Bubble Ratio: 58.44%, 47.34%, 59.28%, 32.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  326-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  376-12-388ms   | [S0,MB4,B]  401-12-413ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  456-12-468ms   | [S0,MB7,B]  483-11-495ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-66ms     | [S1,MB3,F]  72-15-87ms     | [S1,MB4,F]  96-15-111ms    | [S1,MB5,F]  120-15-135ms   | [S1,MB6,F]  144-15-159ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-347ms   | [S1,MB3,B]  356-16-372ms   | [S1,MB4,B]  381-16-397ms   | [S1,MB5,B]  406-16-422ms   | [S1,MB6,B]  432-16-448ms   | [S1,MB7,B]  457-21-478ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  165-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  290-12-303ms   | [S2,MB2,B]  314-12-327ms   | [S2,MB3,B]  340-12-352ms   | [S2,MB4,B]  365-13-378ms   | [S2,MB5,B]  390-12-403ms   | [S2,MB6,B]  416-13-429ms   | [S2,MB7,B]  439-12-452ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-58ms     | [S3,MB1,F]  65-16-82ms     | [S3,MB2,F]  89-16-106ms    | [S3,MB3,F]  113-16-130ms   | [S3,MB4,F]  138-17-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  186-17-203ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  233-24-258ms   | [S3,MB1,B]  258-24-283ms   | [S3,MB2,B]  283-24-308ms   | [S3,MB3,B]  308-25-333ms   | [S3,MB4,B]  333-25-358ms   | [S3,MB5,B]  358-25-383ms   | [S3,MB6,B]  383-25-409ms   | [S3,MB7,B]  409-25-435ms  
[rank3]:2025-12-31 20:50:48,554 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2050_stage3_step100.svg
[rank1]:2025-12-31 20:50:48,624 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2050_rank1_stage1.svg
[rank1]:	> Counts Sum: 51920, Total Sum: 134400 (38.63%), Ratio(%) per element: [37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5]
[rank2]:2025-12-31 20:50:48,611 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2050_rank2_stage2.svg
[rank2]:	> Counts Sum: 41520, Total Sum: 107520 (38.62%), Ratio(%) per element: [41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5]
[rank0]:2025-12-31 20:50:48,606 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2050_rank0_stage0.svg
[rank0]:	> Counts Sum: 41520, Total Sum: 107520 (38.62%), Ratio(%) per element: [37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5]
[rank0]:2025-12-31 20:50:48,696 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2050_stage0.svg
[rank1]:2025-12-31 20:50:48,714 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2050_stage1.svg
[rank2]:2025-12-31 20:50:48,702 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2050_stage2.svg
[rank3]:2025-12-31 20:50:48,696 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2050_rank3_stage3.svg
[rank3]:	> Counts Sum: 53360, Total Sum: 80640 (66.17%), Ratio(%) per element: [75.0, 66.66, 58.33, 54.16, 66.66, 70.83, 66.66, 66.66, 62.5, 70.83, 70.83, 62.5, 66.66, 66.66, 58.33, 79.16, 62.5, 58.33, 62.5, 70.83, 70.83, 70.83, 66.66, 66.66, 66.66, 54.16, 66.66, 70.83, 70.83, 66.66, 66.66, 62.5, 66.66, 66.66, 58.33, 70.83, 62.5, 58.33, 66.66, 70.83, 70.83, 70.83]
[rank3]:2025-12-31 20:50:48,786 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2050_stage3.svg
[rank2]:2025-12-31 20:52:29,292 - Avg. fwd time: 12.2660 / Avg. bwd time: 12.8255 / Avg. batch time: 422.9302 (ms) / GPU bubble ratio: 52.54%
[rank3]:2025-12-31 20:52:29,274 - Avg. fwd time: 16.6590 / Avg. bwd time: 25.1401 / Avg. batch time: 393.9725 (ms) / GPU bubble ratio: 15.12%
[rank1]:2025-12-31 20:52:29,318 - Avg. fwd time: 15.5228 / Avg. bwd time: 16.5970 / Avg. batch time: 460.5321 (ms) / GPU bubble ratio: 44.20%
[rank0]:2025-12-31 20:52:29,336 - Avg. fwd time: 13.4574 / Avg. bwd time: 11.1874 / Avg. batch time: 488.7856 (ms) / GPU bubble ratio: 59.66%
[rank3]:2025-12-31 20:54:05,838 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.27/0.40, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-12-31 20:54:05,839 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank0]:2025-12-31 20:54:05,841 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 20:54:05,854 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-12-31 20:54:05,855 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-12-31 20:54:09,843 - Avg. fwd time: 16.6664 / Avg. bwd time: 25.1191 / Avg. batch time: 393.8378 (ms) / GPU bubble ratio: 15.12%
[rank1]:2025-12-31 20:54:09,889 - Avg. fwd time: 15.5238 / Avg. bwd time: 16.6937 / Avg. batch time: 460.7438 (ms) / GPU bubble ratio: 44.06%
[rank1]:2025-12-31 20:54:09,911 -  step: 150  loss: -8.0000  grad_norm:  4.1340  memory: 17.20GiB(36.20%)  tps: 8,129  tflops: 63.55  mfu: 20.37%
[rank3]:2025-12-31 20:54:09,913 -  step: 150  loss: 11.1241  grad_norm:  4.1340  memory: 29.96GiB(63.05%)  tps: 8,130  tflops: 63.55  mfu: 20.37%
[rank2]:2025-12-31 20:54:09,862 - Avg. fwd time: 12.2678 / Avg. bwd time: 12.8337 / Avg. batch time: 422.6319 (ms) / GPU bubble ratio: 52.49%
[rank2]:2025-12-31 20:54:09,911 -  step: 150  loss: -8.0000  grad_norm:  4.1340  memory: 13.86GiB(29.17%)  tps: 8,129  tflops: 63.55  mfu: 20.37%
[rank0]:2025-12-31 20:54:09,907 - Avg. fwd time: 13.4641 / Avg. bwd time: 11.3643 / Avg. batch time: 489.2680 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-31 20:54:09,911 -  step: 150  loss: -8.0000  grad_norm:  4.1340  memory: 14.52GiB(30.57%)  tps: 8,129  tflops: 63.55  mfu: 20.37%
[rank3]:2025-12-31 20:55:50,542 - Avg. fwd time: 16.6714 / Avg. bwd time: 25.0830 / Avg. batch time: 393.5706 (ms) / GPU bubble ratio: 15.13%
[rank2]:2025-12-31 20:55:50,561 - Avg. fwd time: 12.2690 / Avg. bwd time: 12.8385 / Avg. batch time: 422.2474 (ms) / GPU bubble ratio: 52.43%
[rank1]:2025-12-31 20:55:50,587 - Avg. fwd time: 15.5245 / Avg. bwd time: 16.8114 / Avg. batch time: 461.0297 (ms) / GPU bubble ratio: 43.89%
[rank0]:2025-12-31 20:55:50,605 - Avg. fwd time: 13.4623 / Avg. bwd time: 11.4874 / Avg. batch time: 489.6990 (ms) / GPU bubble ratio: 59.24%
[rank3]:2025-12-31 20:57:27,162 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-31 20:57:27,164 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-31 20:57:27,175 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-31 20:57:27,157 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 20:57:27,169 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-31 20:57:31,112 - Avg. fwd time: 12.2698 / Avg. bwd time: 12.8387 / Avg. batch time: 421.8342 (ms) / GPU bubble ratio: 52.38%
[rank3]:2025-12-31 20:57:31,093 - Avg. fwd time: 16.6748 / Avg. bwd time: 25.0401 / Avg. batch time: 393.2437 (ms) / GPU bubble ratio: 15.14%
[rank2]:2025-12-31 20:57:31,146 -  step: 200  loss: -8.0000  grad_norm: 17.1674  memory: 13.86GiB(29.17%)  tps: 8,142  tflops: 63.65  mfu: 20.40%
[rank2]:2025-12-31 20:57:31,200 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2057_stage2_step200.svg
[rank1]:2025-12-31 20:57:31,137 - Avg. fwd time: 15.5270 / Avg. bwd time: 16.9369 / Avg. batch time: 461.3296 (ms) / GPU bubble ratio: 43.70%
[rank1]:2025-12-31 20:57:31,146 -  step: 200  loss: -8.0000  grad_norm: 17.1674  memory: 17.20GiB(36.20%)  tps: 8,142  tflops: 63.65  mfu: 20.40%
[rank1]:2025-12-31 20:57:31,201 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2057_stage1_step200.svg
[rank3]:2025-12-31 20:57:31,149 -  step: 200  loss: 10.2906  grad_norm: 17.1674  memory: 29.96GiB(63.05%)  tps: 8,142  tflops: 63.65  mfu: 20.40%
[rank0]:2025-12-31 20:57:31,143 - Avg. fwd time: 13.4672 / Avg. bwd time: 11.5535 / Avg. batch time: 489.9144 (ms) / GPU bubble ratio: 59.14%
[rank0]:2025-12-31 20:57:31,147 -  step: 200  loss: -8.0000  grad_norm: 17.1674  memory: 14.52GiB(30.57%)  tps: 8,142  tflops: 63.65  mfu: 20.40%
[rank0]:2025-12-31 20:57:31,198 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2057_stage0_step200.svg
[rank3]:2025-12-31 20:57:31,288 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2057_step200_rank3.svg
[rank3]:			> Batch Time: 491.68 ms, GPU Bubble Ratio: 58.80%, 46.05%, 59.19%, 32.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-313ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  349-12-361ms   | [S0,MB3,B]  374-12-386ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  428-12-440ms   | [S0,MB6,B]  460-12-472ms   | [S0,MB7,B]  483-8-491ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  144-15-160ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  305-16-321ms   | [S1,MB2,B]  329-16-345ms   | [S1,MB3,B]  354-16-370ms   | [S1,MB4,B]  378-16-395ms   | [S1,MB5,B]  403-16-420ms   | [S1,MB6,B]  431-22-453ms   | [S1,MB7,B]  459-20-479ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  289-12-301ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  362-12-375ms   | [S2,MB5,B]  387-12-400ms   | [S2,MB6,B]  412-12-425ms   | [S2,MB7,B]  434-11-446ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-25-331ms   | [S3,MB4,B]  331-24-355ms   | [S3,MB5,B]  355-24-380ms   | [S3,MB6,B]  380-25-406ms   | [S3,MB7,B]  406-24-430ms  
[rank2]:2025-12-31 20:57:31,372 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2057_rank2_stage2.svg
[rank2]:	> Counts Sum: 69920, Total Sum: 465920 (15.01%), Ratio(%) per element: [14.42, 17.3, 14.42, 15.38, 17.3, 14.42, 15.38, 13.46, 13.46, 15.38, 15.38, 15.38, 15.38, 14.42, 14.42, 15.38, 17.3, 16.34, 13.46, 16.34, 14.42, 15.38, 15.38, 13.46, 16.34, 15.38, 11.53, 15.38, 17.3, 14.42, 16.34, 18.26, 12.5, 14.42, 14.42, 14.42, 13.46, 13.46, 11.53, 14.42, 14.42, 15.38, 14.42, 12.5, 18.26, 15.38, 16.34, 14.42, 14.42, 14.42, 15.38, 15.38, 15.38, 17.3, 16.34, 13.46]
[rank1]:2025-12-31 20:57:31,386 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2057_rank1_stage1.svg
[rank1]:	> Counts Sum: 87360, Total Sum: 582400 (15.00%), Ratio(%) per element: [13.46, 14.42, 18.26, 15.38, 16.34, 16.34, 16.34, 14.42, 16.34, 14.42, 14.42, 16.34, 12.5, 14.42, 15.38, 13.46, 15.38, 17.3, 15.38, 14.42, 15.38, 15.38, 13.46, 15.38, 16.34, 15.38, 12.5, 14.42, 15.38, 16.34, 14.42, 15.38, 13.46, 14.42, 13.46, 16.34, 13.46, 12.5, 17.3, 14.42, 15.38, 17.3, 13.46, 13.46, 14.42, 13.46, 16.34, 14.42, 16.34, 15.38, 14.42, 17.3, 15.38, 12.5, 15.38, 11.53, 15.38, 14.42, 14.42, 15.38, 18.26, 15.38, 14.42, 12.5, 14.42, 16.34, 12.5, 17.3, 15.38, 17.3]
[rank3]:2025-12-31 20:57:31,333 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2057_stage3_step200.svg
[rank0]:2025-12-31 20:57:31,370 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2057_rank0_stage0.svg
[rank0]:	> Counts Sum: 69920, Total Sum: 465920 (15.01%), Ratio(%) per element: [14.42, 15.38, 11.53, 15.38, 13.46, 15.38, 17.3, 16.34, 16.34, 14.42, 12.5, 13.46, 16.34, 15.38, 15.38, 16.34, 14.42, 15.38, 15.38, 14.42, 13.46, 12.5, 14.42, 16.34, 14.42, 14.42, 15.38, 16.34, 14.42, 14.42, 14.42, 16.34, 13.46, 14.42, 12.5, 15.38, 14.42, 12.5, 14.42, 16.34, 14.42, 14.42, 16.34, 18.26, 15.38, 16.34, 16.34, 16.34, 15.38, 13.46, 16.34, 17.3, 14.42, 18.26, 13.46, 14.42]
[rank3]:2025-12-31 20:57:31,473 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2057_rank3_stage3.svg
[rank3]:	> Counts Sum: 189600, Total Sum: 349440 (54.26%), Ratio(%) per element: [56.73, 53.84, 49.03, 52.88, 53.84, 50.96, 56.73, 52.88, 49.03, 57.69, 54.8, 53.84, 49.03, 52.88, 47.11, 53.84, 50.96, 56.73, 50.0, 58.65, 50.0, 56.73, 59.61, 57.69, 56.73, 55.76, 58.65, 51.92, 53.84, 51.92, 53.84, 57.69, 52.88, 60.57, 51.92, 60.57, 54.8, 52.88, 50.96, 58.65, 58.65, 50.96]
[rank2]:2025-12-31 20:57:31,711 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2057_stage2.svg
[rank0]:2025-12-31 20:57:31,715 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2057_stage0.svg
[rank1]:2025-12-31 20:57:31,724 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2057_stage1.svg
[rank3]:2025-12-31 20:57:31,814 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2057_stage3.svg
[rank2]:2025-12-31 20:59:09,592 - Avg. fwd time: 12.2698 / Avg. bwd time: 12.8338 / Avg. batch time: 421.3825 (ms) / GPU bubble ratio: 52.34%
[rank1]:2025-12-31 20:59:09,620 - Avg. fwd time: 15.5373 / Avg. bwd time: 16.9883 / Avg. batch time: 461.2015 (ms) / GPU bubble ratio: 43.58%
[rank3]:2025-12-31 20:59:09,573 - Avg. fwd time: 16.6752 / Avg. bwd time: 24.9923 / Avg. batch time: 392.8538 (ms) / GPU bubble ratio: 15.15%
[rank0]:2025-12-31 20:59:09,627 - Avg. fwd time: 13.4736 / Avg. bwd time: 11.4692 / Avg. batch time: 488.6472 (ms) / GPU bubble ratio: 59.16%
[rank2]:2025-12-31 21:00:43,761 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-31 21:00:43,758 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 21:00:43,771 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:00:43,759 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-31 21:00:43,784 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:00:47,610 - Avg. fwd time: 16.6729 / Avg. bwd time: 24.9495 / Avg. batch time: 392.4825 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-31 21:00:47,629 - Avg. fwd time: 12.2691 / Avg. bwd time: 12.8303 / Avg. batch time: 420.9185 (ms) / GPU bubble ratio: 52.30%
[rank2]:2025-12-31 21:00:47,666 -  step: 250  loss: -8.0000  grad_norm:  2.9424  memory: 13.86GiB(29.17%)  tps: 8,337  tflops: 65.18  mfu: 20.89%
[rank1]:2025-12-31 21:00:47,656 - Avg. fwd time: 15.5467 / Avg. bwd time: 17.0445 / Avg. batch time: 461.1530 (ms) / GPU bubble ratio: 43.46%
[rank1]:2025-12-31 21:00:47,666 -  step: 250  loss: -8.0000  grad_norm:  2.9424  memory: 17.20GiB(36.20%)  tps: 8,337  tflops: 65.18  mfu: 20.89%
[rank0]:2025-12-31 21:00:47,662 - Avg. fwd time: 13.4792 / Avg. bwd time: 11.4011 / Avg. batch time: 487.6883 (ms) / GPU bubble ratio: 59.19%
[rank0]:2025-12-31 21:00:47,666 -  step: 250  loss: -8.0000  grad_norm:  2.9424  memory: 14.52GiB(30.57%)  tps: 8,337  tflops: 65.18  mfu: 20.89%
[rank3]:2025-12-31 21:00:47,671 -  step: 250  loss: 12.5257  grad_norm:  2.9424  memory: 29.96GiB(63.05%)  tps: 8,337  tflops: 65.18  mfu: 20.89%
[rank3]:2025-12-31 21:02:25,458 - Avg. fwd time: 16.6713 / Avg. bwd time: 24.9152 / Avg. batch time: 392.1908 (ms) / GPU bubble ratio: 15.17%
[rank2]:2025-12-31 21:02:25,478 - Avg. fwd time: 12.2686 / Avg. bwd time: 12.8267 / Avg. batch time: 420.5465 (ms) / GPU bubble ratio: 52.26%
[rank1]:2025-12-31 21:02:25,506 - Avg. fwd time: 15.5504 / Avg. bwd time: 17.0791 / Avg. batch time: 461.0133 (ms) / GPU bubble ratio: 43.38%
[rank0]:2025-12-31 21:02:25,513 - Avg. fwd time: 13.4845 / Avg. bwd time: 11.3460 / Avg. batch time: 486.8028 (ms) / GPU bubble ratio: 59.19%
[rank2]:2025-12-31 21:04:01,459 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:04:01,457 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-31 21:04:01,474 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-31 21:04:01,446 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 21:04:01,459 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 21:04:05,306 - Avg. fwd time: 16.6731 / Avg. bwd time: 24.8939 / Avg. batch time: 392.0305 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-31 21:04:05,330 - Avg. fwd time: 12.2689 / Avg. bwd time: 12.8258 / Avg. batch time: 420.6088 (ms) / GPU bubble ratio: 52.27%
[rank2]:2025-12-31 21:04:05,369 -  step: 300  loss: -8.0000  grad_norm:  3.0928  memory: 13.86GiB(29.17%)  tps: 8,287  tflops: 64.79  mfu: 20.76%
[rank2]:2025-12-31 21:04:05,420 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2104_stage2_step300.svg
[rank3]:2025-12-31 21:04:05,371 -  step: 300  loss: 12.9454  grad_norm:  3.0928  memory: 29.96GiB(63.05%)  tps: 8,287  tflops: 64.79  mfu: 20.77%
[rank1]:2025-12-31 21:04:05,358 - Avg. fwd time: 15.5557 / Avg. bwd time: 17.2346 / Avg. batch time: 461.7759 (ms) / GPU bubble ratio: 43.19%
[rank1]:2025-12-31 21:04:05,369 -  step: 300  loss: -8.0000  grad_norm:  3.0928  memory: 17.20GiB(36.20%)  tps: 8,287  tflops: 64.79  mfu: 20.76%
[rank1]:2025-12-31 21:04:05,419 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2104_stage1_step300.svg
[rank0]:2025-12-31 21:04:05,365 - Avg. fwd time: 13.4834 / Avg. bwd time: 11.3002 / Avg. batch time: 486.9236 (ms) / GPU bubble ratio: 59.28%
[rank0]:2025-12-31 21:04:05,369 -  step: 300  loss: -8.0000  grad_norm:  3.0928  memory: 14.52GiB(30.57%)  tps: 8,287  tflops: 64.79  mfu: 20.76%
[rank0]:2025-12-31 21:04:05,419 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2104_stage0_step300.svg
[rank3]:2025-12-31 21:04:05,508 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2104_step300_rank3.svg
[rank3]:			> Batch Time: 477.75 ms, GPU Bubble Ratio: 59.41%, 45.16%, 57.96%, 30.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-12-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-313ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  349-12-361ms   | [S0,MB3,B]  374-12-386ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  455-12-468ms   | [S0,MB7,B]  477-0-477ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  145-15-160ms   | [S1,MB7,F]  170-15-185ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  305-16-322ms   | [S1,MB2,B]  329-16-345ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  378-16-395ms   | [S1,MB5,B]  403-16-420ms   | [S1,MB6,B]  429-19-449ms   | [S1,MB7,B]  456-18-475ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  142-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  289-12-301ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  362-12-375ms   | [S2,MB5,B]  387-12-400ms   | [S2,MB6,B]  413-12-426ms   | [S2,MB7,B]  435-11-447ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-25-331ms   | [S3,MB4,B]  331-24-356ms   | [S3,MB5,B]  356-24-380ms   | [S3,MB6,B]  380-25-406ms   | [S3,MB7,B]  406-24-431ms  
[rank2]:2025-12-31 21:04:05,590 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2104_rank2_stage2.svg
[rank2]:	> Counts Sum: 114720, Total Sum: 824320 (13.92%), Ratio(%) per element: [13.58, 15.21, 13.58, 14.13, 15.21, 13.58, 14.13, 13.04, 13.04, 14.13, 14.13, 14.13, 14.13, 13.58, 13.58, 14.13, 15.21, 14.67, 13.04, 14.67, 13.58, 14.13, 14.13, 13.04, 14.67, 14.13, 11.95, 14.13, 15.21, 13.58, 14.67, 15.76, 12.5, 13.58, 13.58, 13.58, 13.04, 13.04, 11.95, 13.58, 13.58, 14.13, 13.58, 12.5, 15.76, 14.13, 14.67, 13.58, 13.58, 13.58, 14.13, 14.13, 14.13, 15.21, 14.67, 13.04]
[rank3]:2025-12-31 21:04:05,551 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2104_stage3_step300.svg
[rank1]:2025-12-31 21:04:05,601 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2104_rank1_stage1.svg
[rank1]:	> Counts Sum: 143360, Total Sum: 1030400 (13.91%), Ratio(%) per element: [13.04, 13.58, 15.76, 14.13, 14.67, 14.67, 14.67, 13.58, 14.67, 13.58, 13.58, 14.67, 12.5, 13.58, 14.13, 13.04, 14.13, 15.21, 14.13, 13.58, 14.13, 14.13, 13.04, 14.13, 14.67, 14.13, 12.5, 13.58, 14.13, 14.67, 13.58, 14.13, 13.04, 13.58, 13.04, 14.67, 13.04, 12.5, 15.21, 13.58, 14.13, 15.21, 13.04, 13.04, 13.58, 13.04, 14.67, 13.58, 14.67, 14.13, 13.58, 15.21, 14.13, 12.5, 14.13, 11.95, 14.13, 13.58, 13.58, 14.13, 15.76, 14.13, 13.58, 12.5, 13.58, 14.67, 12.5, 15.21, 14.13, 15.21]
[rank0]:2025-12-31 21:04:05,587 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2104_rank0_stage0.svg
[rank0]:	> Counts Sum: 114720, Total Sum: 824320 (13.92%), Ratio(%) per element: [13.58, 14.13, 11.95, 14.13, 13.04, 14.13, 15.21, 14.67, 14.67, 13.58, 12.5, 13.04, 14.67, 14.13, 14.13, 14.67, 13.58, 14.13, 14.13, 13.58, 13.04, 12.5, 13.58, 14.67, 13.58, 13.58, 14.13, 14.67, 13.58, 13.58, 13.58, 14.67, 13.04, 13.58, 12.5, 14.13, 13.58, 12.5, 13.58, 14.67, 13.58, 13.58, 14.67, 15.76, 14.13, 14.67, 14.67, 14.67, 14.13, 13.04, 14.67, 15.21, 13.58, 15.76, 13.04, 13.58]
[rank3]:2025-12-31 21:04:05,689 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2104_rank3_stage3.svg
[rank3]:	> Counts Sum: 404800, Total Sum: 618240 (65.48%), Ratio(%) per element: [68.47, 65.21, 63.58, 65.21, 64.13, 65.21, 67.93, 65.21, 61.95, 68.47, 64.67, 65.21, 61.41, 63.58, 61.95, 65.21, 63.58, 67.93, 62.5, 69.56, 61.95, 67.39, 67.39, 66.3, 67.93, 67.39, 68.47, 63.58, 63.58, 63.58, 66.3, 66.84, 64.13, 69.56, 64.13, 67.39, 66.3, 64.67, 63.04, 68.47, 67.39, 63.04]
[rank2]:2025-12-31 21:04:06,184 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2104_stage2.svg
[rank1]:2025-12-31 21:04:06,184 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2104_stage1.svg
[rank0]:2025-12-31 21:04:06,186 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2104_stage0.svg
[rank3]:2025-12-31 21:04:06,283 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2104_stage3.svg
[rank3]:2025-12-31 21:05:45,556 - Avg. fwd time: 16.6786 / Avg. bwd time: 24.8848 / Avg. batch time: 391.9976 (ms) / GPU bubble ratio: 15.18%
[rank0]:2025-12-31 21:05:45,614 - Avg. fwd time: 13.4843 / Avg. bwd time: 11.2622 / Avg. batch time: 486.8997 (ms) / GPU bubble ratio: 59.34%
[rank1]:2025-12-31 21:05:45,606 - Avg. fwd time: 15.5635 / Avg. bwd time: 17.3259 / Avg. batch time: 462.2953 (ms) / GPU bubble ratio: 43.09%
[rank2]:2025-12-31 21:05:45,576 - Avg. fwd time: 12.2700 / Avg. bwd time: 12.8256 / Avg. batch time: 420.6817 (ms) / GPU bubble ratio: 52.28%
[rank0]:2025-12-31 21:07:20,005 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 21:07:23,918 - Avg. fwd time: 16.6864 / Avg. bwd time: 24.8819 / Avg. batch time: 392.0362 (ms) / GPU bubble ratio: 15.17%
[rank3]:2025-12-31 21:07:23,983 -  step: 350  loss: 11.1852  grad_norm:  3.2556  memory: 29.96GiB(63.05%)  tps: 8,249  tflops: 64.49  mfu: 20.67%
[rank2]:2025-12-31 21:07:23,939 - Avg. fwd time: 12.2716 / Avg. bwd time: 12.8260 / Avg. batch time: 420.6672 (ms) / GPU bubble ratio: 52.27%
[rank2]:2025-12-31 21:07:23,981 -  step: 350  loss: -8.0000  grad_norm:  3.2556  memory: 13.86GiB(29.17%)  tps: 8,249  tflops: 64.49  mfu: 20.67%
[rank1]:2025-12-31 21:07:23,969 - Avg. fwd time: 15.5721 / Avg. bwd time: 17.3315 / Avg. batch time: 462.3143 (ms) / GPU bubble ratio: 43.06%
[rank1]:2025-12-31 21:07:23,981 -  step: 350  loss: -8.0000  grad_norm:  3.2556  memory: 17.20GiB(36.20%)  tps: 8,249  tflops: 64.49  mfu: 20.67%
[rank0]:2025-12-31 21:07:23,977 - Avg. fwd time: 13.4869 / Avg. bwd time: 11.2302 / Avg. batch time: 486.4547 (ms) / GPU bubble ratio: 59.35%
[rank0]:2025-12-31 21:07:23,981 -  step: 350  loss: -8.0000  grad_norm:  3.2556  memory: 14.52GiB(30.57%)  tps: 8,249  tflops: 64.49  mfu: 20.67%
[rank3]:2025-12-31 21:09:01,818 - Avg. fwd time: 16.6908 / Avg. bwd time: 24.8752 / Avg. batch time: 392.0176 (ms) / GPU bubble ratio: 15.18%
[rank1]:2025-12-31 21:09:01,868 - Avg. fwd time: 15.5762 / Avg. bwd time: 17.3183 / Avg. batch time: 462.1506 (ms) / GPU bubble ratio: 43.06%
[rank2]:2025-12-31 21:09:01,839 - Avg. fwd time: 12.2725 / Avg. bwd time: 12.8258 / Avg. batch time: 420.5822 (ms) / GPU bubble ratio: 52.26%
[rank0]:2025-12-31 21:09:01,876 - Avg. fwd time: 13.4936 / Avg. bwd time: 11.2017 / Avg. batch time: 485.9015 (ms) / GPU bubble ratio: 59.34%
[rank0]:2025-12-31 21:10:36,065 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 21:10:40,040 - Avg. fwd time: 15.5796 / Avg. bwd time: 17.3254 / Avg. batch time: 462.1243 (ms) / GPU bubble ratio: 43.04%
[rank1]:2025-12-31 21:10:40,052 -  step: 400  loss: -8.0000  grad_norm: 16.0597  memory: 17.20GiB(36.20%)  tps: 8,356  tflops: 65.32  mfu: 20.94%
[rank3]:2025-12-31 21:10:39,990 - Avg. fwd time: 16.6939 / Avg. bwd time: 24.8669 / Avg. batch time: 391.9772 (ms) / GPU bubble ratio: 15.18%
[rank3]:2025-12-31 21:10:40,055 -  step: 400  loss: 10.2708  grad_norm: 16.0597  memory: 29.96GiB(63.05%)  tps: 8,356  tflops: 65.33  mfu: 20.94%
[rank2]:2025-12-31 21:10:40,011 - Avg. fwd time: 12.2734 / Avg. bwd time: 12.8258 / Avg. batch time: 420.4858 (ms) / GPU bubble ratio: 52.25%
[rank2]:2025-12-31 21:10:40,052 -  step: 400  loss: -8.0000  grad_norm: 16.0597  memory: 13.86GiB(29.17%)  tps: 8,356  tflops: 65.32  mfu: 20.94%
[rank0]:2025-12-31 21:10:40,049 - Avg. fwd time: 13.4924 / Avg. bwd time: 11.1767 / Avg. batch time: 485.5191 (ms) / GPU bubble ratio: 59.35%
[rank0]:2025-12-31 21:10:40,053 -  step: 400  loss: -8.0000  grad_norm: 16.0597  memory: 14.52GiB(30.57%)  tps: 8,356  tflops: 65.32  mfu: 20.94%
[rank1]:2025-12-31 21:10:40,107 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2110_stage1_step400.svg
[rank2]:2025-12-31 21:10:40,107 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2110_stage2_step400.svg
[rank0]:2025-12-31 21:10:40,107 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2110_stage0_step400.svg
[rank3]:2025-12-31 21:10:40,190 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2110_step400_rank3.svg
[rank3]:			> Batch Time: 476.25 ms, GPU Bubble Ratio: 59.27%, 45.35%, 57.86%, 30.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  349-12-361ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  399-12-411ms   | [S0,MB5,B]  425-12-437ms   | [S0,MB6,B]  454-12-467ms   | [S0,MB7,B]  476-0-476ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  121-15-136ms   | [S1,MB6,F]  145-15-161ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  305-16-322ms   | [S1,MB2,B]  329-16-346ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  379-16-396ms   | [S1,MB5,B]  404-16-421ms   | [S1,MB6,B]  430-18-449ms   | [S1,MB7,B]  454-18-473ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  191-12-203ms   | [S2,MB0,B]  265-12-278ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  387-12-400ms   | [S2,MB6,B]  413-12-426ms   | [S2,MB7,B]  434-11-446ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-180ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  212-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-25-331ms   | [S3,MB4,B]  331-24-356ms   | [S3,MB5,B]  356-24-381ms   | [S3,MB6,B]  380-25-406ms   | [S3,MB7,B]  406-24-431ms  
[rank3]:2025-12-31 21:10:40,238 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2110_stage3_step400.svg
[rank1]:2025-12-31 21:10:40,291 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2110_rank1_stage1.svg
[rank1]:	> Counts Sum: 199360, Total Sum: 1478400 (13.48%), Ratio(%) per element: [12.87, 13.25, 14.77, 13.63, 14.01, 14.01, 14.01, 13.25, 14.01, 13.25, 13.25, 14.01, 12.5, 13.25, 13.63, 12.87, 13.63, 14.39, 13.63, 13.25, 13.63, 13.63, 12.87, 13.63, 14.01, 13.63, 12.5, 13.25, 13.63, 14.01, 13.25, 13.63, 12.87, 13.25, 12.87, 14.01, 12.87, 12.5, 14.39, 13.25, 13.63, 14.39, 12.87, 12.87, 13.25, 12.87, 14.01, 13.25, 14.01, 13.63, 13.25, 14.39, 13.63, 12.5, 13.63, 12.12, 13.63, 13.25, 13.25, 13.63, 14.77, 13.63, 13.25, 12.5, 13.25, 14.01, 12.5, 14.39, 13.63, 14.39]
[rank2]:2025-12-31 21:10:40,276 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2110_rank2_stage2.svg
[rank2]:	> Counts Sum: 159520, Total Sum: 1182720 (13.49%), Ratio(%) per element: [13.25, 14.39, 13.25, 13.63, 14.39, 13.25, 13.63, 12.87, 12.87, 13.63, 13.63, 13.63, 13.63, 13.25, 13.25, 13.63, 14.39, 14.01, 12.87, 14.01, 13.25, 13.63, 13.63, 12.87, 14.01, 13.63, 12.12, 13.63, 14.39, 13.25, 14.01, 14.77, 12.5, 13.25, 13.25, 13.25, 12.87, 12.87, 12.12, 13.25, 13.25, 13.63, 13.25, 12.5, 14.77, 13.63, 14.01, 13.25, 13.25, 13.25, 13.63, 13.63, 13.63, 14.39, 14.01, 12.87]
[rank0]:2025-12-31 21:10:40,276 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2110_rank0_stage0.svg
[rank0]:	> Counts Sum: 159520, Total Sum: 1182720 (13.49%), Ratio(%) per element: [13.25, 13.63, 12.12, 13.63, 12.87, 13.63, 14.39, 14.01, 14.01, 13.25, 12.5, 12.87, 14.01, 13.63, 13.63, 14.01, 13.25, 13.63, 13.63, 13.25, 12.87, 12.5, 13.25, 14.01, 13.25, 13.25, 13.63, 14.01, 13.25, 13.25, 13.25, 14.01, 12.87, 13.25, 12.5, 13.63, 13.25, 12.5, 13.25, 14.01, 13.25, 13.25, 14.01, 14.77, 13.63, 14.01, 14.01, 14.01, 13.63, 12.87, 14.01, 14.39, 13.25, 14.77, 12.87, 13.25]
[rank3]:2025-12-31 21:10:40,379 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2110_rank3_stage3.svg
[rank3]:	> Counts Sum: 620000, Total Sum: 887040 (69.90%), Ratio(%) per element: [72.34, 69.69, 68.56, 70.45, 68.93, 70.07, 71.59, 68.93, 67.8, 71.59, 68.56, 68.93, 66.66, 67.8, 67.8, 69.69, 68.18, 71.96, 67.8, 71.96, 67.04, 70.83, 71.59, 71.59, 71.96, 71.59, 72.72, 69.31, 69.31, 68.93, 69.69, 70.83, 69.31, 71.96, 67.8, 72.34, 70.45, 68.18, 67.04, 73.1, 71.59, 68.93]
[rank1]:2025-12-31 21:10:41,119 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2110_stage1.svg
[rank2]:2025-12-31 21:10:41,113 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2110_stage2.svg
[rank0]:2025-12-31 21:10:41,134 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2110_stage0.svg
[rank3]:2025-12-31 21:10:41,225 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2110_stage3.svg
[rank3]:2025-12-31 21:11:03,348 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 21:11:03,448 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 21:11:03,417 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 21:11:03,434 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-31 21:12:19,076 - Avg. fwd time: 16.6940 / Avg. bwd time: 24.8544 / Avg. batch time: 391.8748 (ms) / GPU bubble ratio: 15.18%
[rank1]:2025-12-31 21:12:19,133 - Avg. fwd time: 15.5879 / Avg. bwd time: 17.3307 / Avg. batch time: 462.0891 (ms) / GPU bubble ratio: 43.01%
[rank2]:2025-12-31 21:12:19,098 - Avg. fwd time: 12.2731 / Avg. bwd time: 12.8240 / Avg. batch time: 420.3375 (ms) / GPU bubble ratio: 52.23%
[rank0]:2025-12-31 21:12:19,142 - Avg. fwd time: 13.4929 / Avg. bwd time: 11.1543 / Avg. batch time: 485.1792 (ms) / GPU bubble ratio: 59.36%
[rank0]:2025-12-31 21:13:53,298 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-31 21:13:57,159 - Avg. fwd time: 12.2723 / Avg. bwd time: 12.8225 / Avg. batch time: 420.1375 (ms) / GPU bubble ratio: 52.22%
[rank1]:2025-12-31 21:13:57,202 - Avg. fwd time: 15.5971 / Avg. bwd time: 17.3448 / Avg. batch time: 462.0609 (ms) / GPU bubble ratio: 42.97%
[rank1]:2025-12-31 21:13:57,215 -  step: 450  loss: -8.0000  grad_norm:  3.1071  memory: 17.20GiB(36.20%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank0]:2025-12-31 21:13:57,211 - Avg. fwd time: 13.4938 / Avg. bwd time: 11.1339 / Avg. batch time: 484.8807 (ms) / GPU bubble ratio: 59.37%
[rank0]:2025-12-31 21:13:57,215 -  step: 450  loss: -8.0000  grad_norm:  3.1071  memory: 14.52GiB(30.57%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank3]:2025-12-31 21:13:57,137 - Avg. fwd time: 16.6915 / Avg. bwd time: 24.8389 / Avg. batch time: 391.7275 (ms) / GPU bubble ratio: 15.19%
[rank3]:2025-12-31 21:13:57,217 -  step: 450  loss: 12.7476  grad_norm:  3.1071  memory: 29.96GiB(63.05%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank2]:2025-12-31 21:13:57,215 -  step: 450  loss: -8.0000  grad_norm:  3.1071  memory: 13.86GiB(29.17%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank3]:2025-12-31 21:15:34,746 - Avg. fwd time: 16.6895 / Avg. bwd time: 24.8252 / Avg. batch time: 391.6002 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 21:15:34,768 - Avg. fwd time: 12.2717 / Avg. bwd time: 12.8207 / Avg. batch time: 419.9654 (ms) / GPU bubble ratio: 52.20%
[rank1]:2025-12-31 21:15:34,798 - Avg. fwd time: 15.5964 / Avg. bwd time: 17.3428 / Avg. batch time: 461.8957 (ms) / GPU bubble ratio: 42.95%
[rank0]:2025-12-31 21:15:34,808 - Avg. fwd time: 13.4932 / Avg. bwd time: 11.1158 / Avg. batch time: 484.4683 (ms) / GPU bubble ratio: 59.36%
[rank0]:2025-12-31 21:17:08,887 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 21:17:12,848 - Avg. fwd time: 16.6888 / Avg. bwd time: 24.8153 / Avg. batch time: 391.5136 (ms) / GPU bubble ratio: 15.19%
[rank2]:2025-12-31 21:17:12,871 - Avg. fwd time: 12.2713 / Avg. bwd time: 12.8192 / Avg. batch time: 419.8330 (ms) / GPU bubble ratio: 52.19%
[rank2]:2025-12-31 21:17:12,943 -  step: 500  loss: -8.0000  grad_norm:  3.1008  memory: 13.86GiB(29.17%)  tps: 8,371  tflops: 65.44  mfu: 20.97%
[rank0]:2025-12-31 21:17:12,939 - Avg. fwd time: 13.4926 / Avg. bwd time: 11.0996 / Avg. batch time: 484.2162 (ms) / GPU bubble ratio: 59.37%
[rank0]:2025-12-31 21:17:12,943 -  step: 500  loss: -8.0000  grad_norm:  3.1008  memory: 14.52GiB(30.57%)  tps: 8,371  tflops: 65.44  mfu: 20.97%
[rank1]:2025-12-31 21:17:12,929 - Avg. fwd time: 15.6002 / Avg. bwd time: 17.3498 / Avg. batch time: 461.8623 (ms) / GPU bubble ratio: 42.93%
[rank1]:2025-12-31 21:17:12,943 -  step: 500  loss: -8.0000  grad_norm:  3.1008  memory: 17.20GiB(36.20%)  tps: 8,371  tflops: 65.44  mfu: 20.97%
[rank3]:2025-12-31 21:17:12,945 -  step: 500  loss: 12.9574  grad_norm:  3.1008  memory: 29.96GiB(63.05%)  tps: 8,371  tflops: 65.44  mfu: 20.97%
[rank2]:2025-12-31 21:17:12,996 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2117_stage2_step500.svg
[rank0]:2025-12-31 21:17:12,994 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2117_stage0_step500.svg
[rank1]:2025-12-31 21:17:12,999 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2117_stage1_step500.svg
[rank3]:2025-12-31 21:17:13,082 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2117_step500_rank3.svg
[rank3]:			> Batch Time: 486.75 ms, GPU Bubble Ratio: 60.02%, 43.18%, 58.78%, 32.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-12-53ms     | [S0,MB4,F]  53-13-66ms     | [S0,MB5,F]  66-14-81ms     | [S0,MB6,F]  81-13-94ms     | [S0,MB7,F]  94-14-108ms    | [S0,MB0,B]  304-12-316ms   | [S0,MB1,B]  328-12-340ms   | [S0,MB2,B]  352-12-365ms   | [S0,MB3,B]  377-12-389ms   | [S0,MB4,B]  402-12-414ms   | [S0,MB5,B]  431-12-444ms   | [S0,MB6,B]  463-12-475ms   | [S0,MB7,B]  486-0-486ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-18-33ms     | [S1,MB1,F]  36-15-51ms     | [S1,MB2,F]  55-15-70ms     | [S1,MB3,F]  75-15-91ms     | [S1,MB4,F]  99-15-115ms    | [S1,MB5,F]  123-15-139ms   | [S1,MB6,F]  147-15-163ms   | [S1,MB7,F]  172-15-187ms   | [S1,MB0,B]  284-16-300ms   | [S1,MB1,B]  308-16-324ms   | [S1,MB2,B]  332-16-349ms   | [S1,MB3,B]  357-16-374ms   | [S1,MB4,B]  381-16-398ms   | [S1,MB5,B]  406-20-426ms   | [S1,MB6,B]  433-26-460ms   | [S1,MB7,B]  463-19-482ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-12-45ms     | [S2,MB1,F]  52-12-64ms     | [S2,MB2,F]  72-12-85ms     | [S2,MB3,F]  96-12-109ms    | [S2,MB4,F]  121-12-133ms   | [S2,MB5,F]  145-12-157ms   | [S2,MB6,F]  169-12-181ms   | [S2,MB7,F]  193-12-206ms   | [S2,MB0,B]  268-12-280ms   | [S2,MB1,B]  292-12-305ms   | [S2,MB2,B]  316-12-329ms   | [S2,MB3,B]  341-12-354ms   | [S2,MB4,B]  365-12-378ms   | [S2,MB5,B]  390-12-403ms   | [S2,MB6,B]  415-12-428ms   | [S2,MB7,B]  438-11-449ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-16-62ms     | [S3,MB1,F]  69-16-86ms     | [S3,MB2,F]  93-16-110ms    | [S3,MB3,F]  117-16-134ms   | [S3,MB4,F]  142-16-158ms   | [S3,MB5,F]  166-17-183ms   | [S3,MB6,F]  190-16-207ms   | [S3,MB7,F]  214-16-231ms   | [S3,MB0,B]  237-23-261ms   | [S3,MB1,B]  261-24-285ms   | [S3,MB2,B]  285-24-309ms   | [S3,MB3,B]  309-24-334ms   | [S3,MB4,B]  334-24-359ms   | [S3,MB5,B]  358-24-383ms   | [S3,MB6,B]  383-25-409ms   | [S3,MB7,B]  408-24-433ms  
[rank0]:2025-12-31 21:17:13,163 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2117_rank0_stage0.svg
[rank0]:	> Counts Sum: 204320, Total Sum: 1541120 (13.26%), Ratio(%) per element: [13.08, 13.37, 12.2, 13.37, 12.79, 13.37, 13.95, 13.66, 13.66, 13.08, 12.5, 12.79, 13.66, 13.37, 13.37, 13.66, 13.08, 13.37, 13.37, 13.08, 12.79, 12.5, 13.08, 13.66, 13.08, 13.08, 13.37, 13.66, 13.08, 13.08, 13.08, 13.66, 12.79, 13.08, 12.5, 13.37, 13.08, 12.5, 13.08, 13.66, 13.08, 13.08, 13.66, 14.24, 13.37, 13.66, 13.66, 13.66, 13.37, 12.79, 13.66, 13.95, 13.08, 14.24, 12.79, 13.08]
[rank3]:2025-12-31 21:17:13,125 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2117_stage3_step500.svg
[rank2]:2025-12-31 21:17:13,166 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2117_rank2_stage2.svg
[rank2]:	> Counts Sum: 204320, Total Sum: 1541120 (13.26%), Ratio(%) per element: [13.08, 13.95, 13.08, 13.37, 13.95, 13.08, 13.37, 12.79, 12.79, 13.37, 13.37, 13.37, 13.37, 13.08, 13.08, 13.37, 13.95, 13.66, 12.79, 13.66, 13.08, 13.37, 13.37, 12.79, 13.66, 13.37, 12.2, 13.37, 13.95, 13.08, 13.66, 14.24, 12.5, 13.08, 13.08, 13.08, 12.79, 12.79, 12.2, 13.08, 13.08, 13.37, 13.08, 12.5, 14.24, 13.37, 13.66, 13.08, 13.08, 13.08, 13.37, 13.37, 13.37, 13.95, 13.66, 12.79]
[rank1]:2025-12-31 21:17:13,198 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2117_rank1_stage1.svg
[rank1]:	> Counts Sum: 255360, Total Sum: 1926400 (13.26%), Ratio(%) per element: [12.79, 13.08, 14.24, 13.37, 13.66, 13.66, 13.66, 13.08, 13.66, 13.08, 13.08, 13.66, 12.5, 13.08, 13.37, 12.79, 13.37, 13.95, 13.37, 13.08, 13.37, 13.37, 12.79, 13.37, 13.66, 13.37, 12.5, 13.08, 13.37, 13.66, 13.08, 13.37, 12.79, 13.08, 12.79, 13.66, 12.79, 12.5, 13.95, 13.08, 13.37, 13.95, 12.79, 12.79, 13.08, 12.79, 13.66, 13.08, 13.66, 13.37, 13.08, 13.95, 13.37, 12.5, 13.37, 12.2, 13.37, 13.08, 13.08, 13.37, 14.24, 13.37, 13.08, 12.5, 13.08, 13.66, 12.5, 13.95, 13.37, 13.95]
[rank3]:2025-12-31 21:17:13,263 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2117_rank3_stage3.svg
[rank3]:	> Counts Sum: 835200, Total Sum: 1155840 (72.26%), Ratio(%) per element: [74.12, 72.38, 70.93, 72.96, 71.51, 72.38, 74.41, 71.51, 70.93, 73.25, 70.93, 71.51, 69.18, 70.63, 70.05, 72.38, 71.22, 73.25, 70.63, 74.41, 70.05, 72.96, 72.67, 73.25, 73.54, 73.54, 73.54, 72.09, 71.22, 72.09, 72.38, 72.67, 71.8, 75.0, 70.63, 73.83, 72.96, 71.22, 69.76, 74.7, 74.12, 72.09]
[rank2]:2025-12-31 21:17:14,245 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2117_stage2.svg
[rank0]:2025-12-31 21:17:14,281 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2117_stage0.svg
[rank3]:2025-12-31 21:17:14,345 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2117_stage3.svg
[rank1]:2025-12-31 21:17:14,411 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2117_stage1.svg
[rank2]:2025-12-31 21:18:54,082 - Avg. fwd time: 12.2709 / Avg. bwd time: 12.8189 / Avg. batch time: 419.8618 (ms) / GPU bubble ratio: 52.19%
[rank1]:2025-12-31 21:18:54,112 - Avg. fwd time: 15.5988 / Avg. bwd time: 17.4269 / Avg. batch time: 462.2216 (ms) / GPU bubble ratio: 42.84%
[rank3]:2025-12-31 21:18:54,059 - Avg. fwd time: 16.6876 / Avg. bwd time: 24.8047 / Avg. batch time: 391.4161 (ms) / GPU bubble ratio: 15.20%
[rank0]:2025-12-31 21:18:54,122 - Avg. fwd time: 13.4933 / Avg. bwd time: 11.0848 / Avg. batch time: 484.4105 (ms) / GPU bubble ratio: 59.41%
[rank0]:2025-12-31 21:20:27,877 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 21:20:31,747 - Avg. fwd time: 16.6872 / Avg. bwd time: 24.7965 / Avg. batch time: 391.3460 (ms) / GPU bubble ratio: 15.20%
[rank2]:2025-12-31 21:20:31,770 - Avg. fwd time: 12.2707 / Avg. bwd time: 12.8219 / Avg. batch time: 419.7708 (ms) / GPU bubble ratio: 52.18%
[rank2]:2025-12-31 21:20:31,815 -  step: 550  loss: -8.0000  grad_norm:  2.9615  memory: 13.86GiB(29.17%)  tps: 8,238  tflops: 64.40  mfu: 20.64%
[rank1]:2025-12-31 21:20:31,801 - Avg. fwd time: 15.5994 / Avg. bwd time: 17.4129 / Avg. batch time: 462.0736 (ms) / GPU bubble ratio: 42.85%
[rank1]:2025-12-31 21:20:31,815 -  step: 550  loss: -8.0000  grad_norm:  2.9615  memory: 17.20GiB(36.20%)  tps: 8,238  tflops: 64.40  mfu: 20.64%
[rank0]:2025-12-31 21:20:31,812 - Avg. fwd time: 13.4934 / Avg. bwd time: 11.0713 / Avg. batch time: 484.0840 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-31 21:20:31,816 -  step: 550  loss: -8.0000  grad_norm:  2.9615  memory: 14.52GiB(30.57%)  tps: 8,238  tflops: 64.40  mfu: 20.64%
[rank3]:2025-12-31 21:20:31,818 -  step: 550  loss: 11.0947  grad_norm:  2.9615  memory: 29.96GiB(63.05%)  tps: 8,239  tflops: 64.41  mfu: 20.64%
[rank3]:2025-12-31 21:22:09,540 - Avg. fwd time: 16.6870 / Avg. bwd time: 24.7895 / Avg. batch time: 391.2855 (ms) / GPU bubble ratio: 15.20%
[rank2]:2025-12-31 21:22:09,563 - Avg. fwd time: 12.2705 / Avg. bwd time: 12.8218 / Avg. batch time: 419.6735 (ms) / GPU bubble ratio: 52.17%
[rank1]:2025-12-31 21:22:09,592 - Avg. fwd time: 15.5982 / Avg. bwd time: 17.4077 / Avg. batch time: 461.9652 (ms) / GPU bubble ratio: 42.84%
[rank0]:2025-12-31 21:22:09,603 - Avg. fwd time: 13.4934 / Avg. bwd time: 11.0589 / Avg. batch time: 483.8102 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-31 21:23:44,041 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 21:23:47,987 - Avg. fwd time: 16.6868 / Avg. bwd time: 24.7823 / Avg. batch time: 391.2248 (ms) / GPU bubble ratio: 15.20%
[rank1]:2025-12-31 21:23:48,041 - Avg. fwd time: 15.5979 / Avg. bwd time: 17.4268 / Avg. batch time: 462.0050 (ms) / GPU bubble ratio: 42.81%
[rank1]:2025-12-31 21:23:48,056 -  step: 600  loss: -8.0000  grad_norm: 14.9740  memory: 17.20GiB(36.20%)  tps: 8,349  tflops: 65.27  mfu: 20.92%
[rank2]:2025-12-31 21:23:48,013 - Avg. fwd time: 12.2703 / Avg. bwd time: 12.8206 / Avg. batch time: 419.6225 (ms) / GPU bubble ratio: 52.16%
[rank2]:2025-12-31 21:23:48,056 -  step: 600  loss: -8.0000  grad_norm: 14.9740  memory: 13.86GiB(29.17%)  tps: 8,349  tflops: 65.27  mfu: 20.92%
[rank3]:2025-12-31 21:23:48,059 -  step: 600  loss: 10.0019  grad_norm: 14.9740  memory: 29.96GiB(63.05%)  tps: 8,349  tflops: 65.27  mfu: 20.92%
[rank0]:2025-12-31 21:23:48,053 - Avg. fwd time: 13.4927 / Avg. bwd time: 11.0475 / Avg. batch time: 483.6979 (ms) / GPU bubble ratio: 59.41%
[rank0]:2025-12-31 21:23:48,057 -  step: 600  loss: -8.0000  grad_norm: 14.9740  memory: 14.52GiB(30.57%)  tps: 8,349  tflops: 65.27  mfu: 20.92%
[rank0]:2025-12-31 21:23:48,109 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2123_stage0_step600.svg
[rank1]:2025-12-31 21:23:48,111 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2123_stage1_step600.svg
[rank2]:2025-12-31 21:23:48,110 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2123_stage2_step600.svg
[rank3]:2025-12-31 21:23:48,195 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2123_step600_rank3.svg
[rank3]:			> Batch Time: 475.25 ms, GPU Bubble Ratio: 59.21%, 45.17%, 57.83%, 30.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-337ms   | [S0,MB2,B]  348-12-361ms   | [S0,MB3,B]  374-12-386ms   | [S0,MB4,B]  398-12-411ms   | [S0,MB5,B]  424-12-436ms   | [S0,MB6,B]  453-12-465ms   | [S0,MB7,B]  475-0-475ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  33-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  145-15-160ms   | [S1,MB7,F]  169-15-184ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  305-16-321ms   | [S1,MB2,B]  329-16-345ms   | [S1,MB3,B]  354-16-371ms   | [S1,MB4,B]  379-16-395ms   | [S1,MB5,B]  403-16-419ms   | [S1,MB6,B]  428-18-447ms   | [S1,MB7,B]  452-19-472ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  288-12-301ms   | [S2,MB2,B]  312-12-325ms   | [S2,MB3,B]  337-12-350ms   | [S2,MB4,B]  362-12-375ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  412-12-425ms   | [S2,MB7,B]  433-11-445ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-257ms   | [S3,MB1,B]  257-23-281ms   | [S3,MB2,B]  281-24-306ms   | [S3,MB3,B]  306-25-331ms   | [S3,MB4,B]  331-24-355ms   | [S3,MB5,B]  355-24-380ms   | [S3,MB6,B]  380-25-405ms   | [S3,MB7,B]  405-24-430ms  
[rank2]:2025-12-31 21:23:48,285 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2123_rank2_stage2.svg
[rank2]:	> Counts Sum: 249120, Total Sum: 1899520 (13.11%), Ratio(%) per element: [12.97, 13.67, 12.97, 13.2, 13.67, 12.97, 13.2, 12.73, 12.73, 13.2, 13.2, 13.2, 13.2, 12.97, 12.97, 13.2, 13.67, 13.44, 12.73, 13.44, 12.97, 13.2, 13.2, 12.73, 13.44, 13.2, 12.26, 13.2, 13.67, 12.97, 13.44, 13.91, 12.5, 12.97, 12.97, 12.97, 12.73, 12.73, 12.26, 12.97, 12.97, 13.2, 12.97, 12.5, 13.91, 13.2, 13.44, 12.97, 12.97, 12.97, 13.2, 13.2, 13.2, 13.67, 13.44, 12.73]
[rank3]:2025-12-31 21:23:48,240 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2123_stage3_step600.svg
[rank0]:2025-12-31 21:23:48,279 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2123_rank0_stage0.svg
[rank0]:	> Counts Sum: 249120, Total Sum: 1899520 (13.11%), Ratio(%) per element: [12.97, 13.2, 12.26, 13.2, 12.73, 13.2, 13.67, 13.44, 13.44, 12.97, 12.5, 12.73, 13.44, 13.2, 13.2, 13.44, 12.97, 13.2, 13.2, 12.97, 12.73, 12.5, 12.97, 13.44, 12.97, 12.97, 13.2, 13.44, 12.97, 12.97, 12.97, 13.44, 12.73, 12.97, 12.5, 13.2, 12.97, 12.5, 12.97, 13.44, 12.97, 12.97, 13.44, 13.91, 13.2, 13.44, 13.44, 13.44, 13.2, 12.73, 13.44, 13.67, 12.97, 13.91, 12.73, 12.97]
[rank1]:2025-12-31 21:23:48,301 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2123_rank1_stage1.svg
[rank1]:	> Counts Sum: 311360, Total Sum: 2374400 (13.11%), Ratio(%) per element: [12.73, 12.97, 13.91, 13.2, 13.44, 13.44, 13.44, 12.97, 13.44, 12.97, 12.97, 13.44, 12.5, 12.97, 13.2, 12.73, 13.2, 13.67, 13.2, 12.97, 13.2, 13.2, 12.73, 13.2, 13.44, 13.2, 12.5, 12.97, 13.2, 13.44, 12.97, 13.2, 12.73, 12.97, 12.73, 13.44, 12.73, 12.5, 13.67, 12.97, 13.2, 13.67, 12.73, 12.73, 12.97, 12.73, 13.44, 12.97, 13.44, 13.2, 12.97, 13.67, 13.2, 12.5, 13.2, 12.26, 13.2, 12.97, 12.97, 13.2, 13.91, 13.2, 12.97, 12.5, 12.97, 13.44, 12.5, 13.67, 13.2, 13.67]
[rank3]:2025-12-31 21:23:48,379 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2123_rank3_stage3.svg
[rank3]:	> Counts Sum: 1050400, Total Sum: 1424640 (73.73%), Ratio(%) per element: [75.0, 73.82, 73.34, 73.82, 73.11, 73.82, 75.47, 73.11, 72.4, 74.52, 72.87, 73.11, 71.69, 72.16, 72.64, 73.58, 72.87, 74.05, 72.64, 75.7, 71.46, 74.29, 74.52, 75.23, 75.0, 75.23, 74.52, 73.34, 72.87, 73.34, 74.29, 74.05, 72.87, 75.23, 72.4, 75.47, 74.76, 72.64, 71.22, 75.47, 74.76, 73.82]
[rank2]:2025-12-31 21:23:49,626 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2123_stage2.svg
[rank1]:2025-12-31 21:23:49,634 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2123_stage1.svg
[rank0]:2025-12-31 21:23:49,632 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2123_stage0.svg
[rank3]:2025-12-31 21:23:49,723 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2123_stage3.svg
[rank3]:2025-12-31 21:25:27,325 - Avg. fwd time: 16.6854 / Avg. bwd time: 24.7735 / Avg. batch time: 391.1451 (ms) / GPU bubble ratio: 15.20%
[rank1]:2025-12-31 21:25:27,383 - Avg. fwd time: 15.5979 / Avg. bwd time: 17.4250 / Avg. batch time: 461.9179 (ms) / GPU bubble ratio: 42.81%
[rank2]:2025-12-31 21:25:27,350 - Avg. fwd time: 12.2700 / Avg. bwd time: 12.8192 / Avg. batch time: 419.5180 (ms) / GPU bubble ratio: 52.16%
[rank0]:2025-12-31 21:25:27,394 - Avg. fwd time: 13.4929 / Avg. bwd time: 11.0369 / Avg. batch time: 483.4722 (ms) / GPU bubble ratio: 59.41%
[rank0]:2025-12-31 21:27:01,423 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 21:27:05,278 - Avg. fwd time: 16.6848 / Avg. bwd time: 24.7668 / Avg. batch time: 391.0849 (ms) / GPU bubble ratio: 15.21%
[rank2]:2025-12-31 21:27:05,303 - Avg. fwd time: 12.2697 / Avg. bwd time: 12.8181 / Avg. batch time: 419.4314 (ms) / GPU bubble ratio: 52.15%
[rank2]:2025-12-31 21:27:05,351 -  step: 650  loss: -8.0000  grad_norm:  3.5301  memory: 13.86GiB(29.17%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank3]:2025-12-31 21:27:05,354 -  step: 650  loss: 12.3049  grad_norm:  3.5301  memory: 29.96GiB(63.05%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank0]:2025-12-31 21:27:05,348 - Avg. fwd time: 13.4907 / Avg. bwd time: 11.0272 / Avg. batch time: 483.2872 (ms) / GPU bubble ratio: 59.41%
[rank0]:2025-12-31 21:27:05,352 -  step: 650  loss: -8.0000  grad_norm:  3.5301  memory: 14.52GiB(30.57%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank1]:2025-12-31 21:27:05,336 - Avg. fwd time: 15.5980 / Avg. bwd time: 17.4281 / Avg. batch time: 461.8672 (ms) / GPU bubble ratio: 42.80%
[rank1]:2025-12-31 21:27:05,351 -  step: 650  loss: -8.0000  grad_norm:  3.5301  memory: 17.20GiB(36.20%)  tps: 8,304  tflops: 64.92  mfu: 20.81%
[rank2]:2025-12-31 21:28:43,079 - Avg. fwd time: 12.2695 / Avg. bwd time: 12.8172 / Avg. batch time: 419.3487 (ms) / GPU bubble ratio: 52.14%
[rank3]:2025-12-31 21:28:43,054 - Avg. fwd time: 16.6843 / Avg. bwd time: 24.7612 / Avg. batch time: 391.0343 (ms) / GPU bubble ratio: 15.21%
[rank0]:2025-12-31 21:28:43,123 - Avg. fwd time: 13.4899 / Avg. bwd time: 11.0184 / Avg. batch time: 483.0853 (ms) / GPU bubble ratio: 59.41%
[rank1]:2025-12-31 21:28:43,111 - Avg. fwd time: 15.5977 / Avg. bwd time: 17.4253 / Avg. batch time: 461.7868 (ms) / GPU bubble ratio: 42.79%
[rank0]:2025-12-31 21:30:17,314 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 21:30:21,190 - Avg. fwd time: 12.2692 / Avg. bwd time: 12.8162 / Avg. batch time: 419.2624 (ms) / GPU bubble ratio: 52.13%
[rank1]:2025-12-31 21:30:21,224 - Avg. fwd time: 15.5994 / Avg. bwd time: 17.4266 / Avg. batch time: 461.7463 (ms) / GPU bubble ratio: 42.78%
[rank1]:2025-12-31 21:30:21,241 -  step: 700  loss: -8.0000  grad_norm:  3.0920  memory: 17.20GiB(36.20%)  tps: 8,364  tflops: 65.39  mfu: 20.96%
[rank3]:2025-12-31 21:30:21,165 - Avg. fwd time: 16.6834 / Avg. bwd time: 24.7549 / Avg. batch time: 390.9753 (ms) / GPU bubble ratio: 15.21%
[rank3]:2025-12-31 21:30:21,244 -  step: 700  loss: 13.1107  grad_norm:  3.0920  memory: 29.96GiB(63.05%)  tps: 8,364  tflops: 65.39  mfu: 20.96%
[rank0]:2025-12-31 21:30:21,237 - Avg. fwd time: 13.4898 / Avg. bwd time: 11.0110 / Avg. batch time: 482.9365 (ms) / GPU bubble ratio: 59.41%
[rank0]:2025-12-31 21:30:21,242 -  step: 700  loss: -8.0000  grad_norm:  3.0920  memory: 14.52GiB(30.57%)  tps: 8,364  tflops: 65.39  mfu: 20.96%
[rank0]:2025-12-31 21:30:21,295 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2130_stage0_step700.svg
[rank2]:2025-12-31 21:30:21,241 -  step: 700  loss: -8.0000  grad_norm:  3.0920  memory: 13.86GiB(29.17%)  tps: 8,364  tflops: 65.39  mfu: 20.96%
[rank2]:2025-12-31 21:30:21,296 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2130_stage2_step700.svg
[rank1]:2025-12-31 21:30:21,296 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2130_stage1_step700.svg
[rank3]:2025-12-31 21:30:21,382 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2130_step700_rank3.svg
[rank3]:			> Batch Time: 477.75 ms, GPU Bubble Ratio: 59.44%, 45.32%, 58.02%, 30.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-12-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-12-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  300-12-312ms   | [S0,MB1,B]  324-12-337ms   | [S0,MB2,B]  348-12-360ms   | [S0,MB3,B]  373-12-385ms   | [S0,MB4,B]  398-12-410ms   | [S0,MB5,B]  424-12-436ms   | [S0,MB6,B]  455-12-467ms   | [S0,MB7,B]  477-0-477ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  144-15-160ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  280-16-297ms   | [S1,MB1,B]  305-16-321ms   | [S1,MB2,B]  328-16-345ms   | [S1,MB3,B]  353-16-370ms   | [S1,MB4,B]  378-16-394ms   | [S1,MB5,B]  402-16-419ms   | [S1,MB6,B]  428-19-448ms   | [S1,MB7,B]  455-18-473ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-153ms   | [S2,MB6,F]  165-12-178ms   | [S2,MB7,F]  189-12-202ms   | [S2,MB0,B]  264-12-277ms   | [S2,MB1,B]  288-12-301ms   | [S2,MB2,B]  312-12-325ms   | [S2,MB3,B]  337-12-350ms   | [S2,MB4,B]  361-12-374ms   | [S2,MB5,B]  386-12-398ms   | [S2,MB6,B]  412-12-425ms   | [S2,MB7,B]  434-11-446ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-130ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  162-16-179ms   | [S3,MB6,F]  186-16-203ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-257ms   | [S3,MB1,B]  257-24-281ms   | [S3,MB2,B]  281-24-305ms   | [S3,MB3,B]  305-24-330ms   | [S3,MB4,B]  330-24-355ms   | [S3,MB5,B]  354-24-379ms   | [S3,MB6,B]  379-25-405ms   | [S3,MB7,B]  405-24-430ms  
[rank3]:2025-12-31 21:30:21,428 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2130_stage3_step700.svg
[rank0]:2025-12-31 21:30:21,465 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2130_rank0_stage0.svg
[rank0]:	> Counts Sum: 293920, Total Sum: 2257920 (13.02%), Ratio(%) per element: [12.89, 13.09, 12.3, 13.09, 12.69, 13.09, 13.49, 13.29, 13.29, 12.89, 12.5, 12.69, 13.29, 13.09, 13.09, 13.29, 12.89, 13.09, 13.09, 12.89, 12.69, 12.5, 12.89, 13.29, 12.89, 12.89, 13.09, 13.29, 12.89, 12.89, 12.89, 13.29, 12.69, 12.89, 12.5, 13.09, 12.89, 12.5, 12.89, 13.29, 12.89, 12.89, 13.29, 13.69, 13.09, 13.29, 13.29, 13.29, 13.09, 12.69, 13.29, 13.49, 12.89, 13.69, 12.69, 12.89]
[rank2]:2025-12-31 21:30:21,468 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2130_rank2_stage2.svg
[rank2]:	> Counts Sum: 293920, Total Sum: 2257920 (13.02%), Ratio(%) per element: [12.89, 13.49, 12.89, 13.09, 13.49, 12.89, 13.09, 12.69, 12.69, 13.09, 13.09, 13.09, 13.09, 12.89, 12.89, 13.09, 13.49, 13.29, 12.69, 13.29, 12.89, 13.09, 13.09, 12.69, 13.29, 13.09, 12.3, 13.09, 13.49, 12.89, 13.29, 13.69, 12.5, 12.89, 12.89, 12.89, 12.69, 12.69, 12.3, 12.89, 12.89, 13.09, 12.89, 12.5, 13.69, 13.09, 13.29, 12.89, 12.89, 12.89, 13.09, 13.09, 13.09, 13.49, 13.29, 12.69]
[rank1]:2025-12-31 21:30:21,481 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2130_rank1_stage1.svg
[rank1]:	> Counts Sum: 367360, Total Sum: 2822400 (13.02%), Ratio(%) per element: [12.69, 12.89, 13.69, 13.09, 13.29, 13.29, 13.29, 12.89, 13.29, 12.89, 12.89, 13.29, 12.5, 12.89, 13.09, 12.69, 13.09, 13.49, 13.09, 12.89, 13.09, 13.09, 12.69, 13.09, 13.29, 13.09, 12.5, 12.89, 13.09, 13.29, 12.89, 13.09, 12.69, 12.89, 12.69, 13.29, 12.69, 12.5, 13.49, 12.89, 13.09, 13.49, 12.69, 12.69, 12.89, 12.69, 13.29, 12.89, 13.29, 13.09, 12.89, 13.49, 13.09, 12.5, 13.09, 12.3, 13.09, 12.89, 12.89, 13.09, 13.69, 13.09, 12.89, 12.5, 12.89, 13.29, 12.5, 13.49, 13.09, 13.49]
[rank3]:2025-12-31 21:30:21,568 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2130_rank3_stage3.svg
[rank3]:	> Counts Sum: 1265600, Total Sum: 1693440 (74.74%), Ratio(%) per element: [76.38, 74.6, 74.4, 74.4, 74.6, 74.8, 76.58, 74.4, 73.61, 75.19, 73.8, 74.2, 73.61, 72.81, 74.2, 74.0, 74.0, 74.8, 74.0, 76.19, 73.21, 74.6, 75.79, 75.99, 75.39, 75.59, 75.99, 74.6, 73.8, 74.2, 75.19, 75.19, 74.4, 75.99, 74.0, 75.79, 75.59, 73.8, 72.61, 75.99, 75.99, 74.4]
[rank0]:2025-12-31 21:30:23,093 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2130_stage0.svg
[rank2]:2025-12-31 21:30:23,078 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2130_stage2.svg
[rank1]:2025-12-31 21:30:23,048 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2130_stage1.svg
[rank3]:2025-12-31 21:30:23,166 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2130_stage3.svg
[rank3]:2025-12-31 21:32:00,540 - Avg. fwd time: 16.6823 / Avg. bwd time: 24.7483 / Avg. batch time: 390.9107 (ms) / GPU bubble ratio: 15.21%
[rank2]:2025-12-31 21:32:00,565 - Avg. fwd time: 12.2688 / Avg. bwd time: 12.8151 / Avg. batch time: 419.1749 (ms) / GPU bubble ratio: 52.13%
[rank0]:2025-12-31 21:32:00,609 - Avg. fwd time: 13.4901 / Avg. bwd time: 11.0030 / Avg. batch time: 482.7152 (ms) / GPU bubble ratio: 59.41%
[rank1]:2025-12-31 21:32:00,596 - Avg. fwd time: 15.5979 / Avg. bwd time: 17.4189 / Avg. batch time: 461.6267 (ms) / GPU bubble ratio: 42.78%
[rank0]:2025-12-31 21:33:34,469 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-31 21:33:38,390 - Avg. fwd time: 12.2687 / Avg. bwd time: 12.8141 / Avg. batch time: 419.0952 (ms) / GPU bubble ratio: 52.12%
[rank3]:2025-12-31 21:33:38,364 - Avg. fwd time: 16.6815 / Avg. bwd time: 24.7424 / Avg. batch time: 390.8558 (ms) / GPU bubble ratio: 15.21%
[rank0]:2025-12-31 21:33:38,434 - Avg. fwd time: 13.4913 / Avg. bwd time: 10.9957 / Avg. batch time: 482.5439 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-31 21:33:38,438 -  step: 750  loss: -8.0000  grad_norm:  2.2434  memory: 14.52GiB(30.57%)  tps: 8,308  tflops: 64.95  mfu: 20.82%
[rank2]:2025-12-31 21:33:38,438 -  step: 750  loss: -8.0000  grad_norm:  2.2434  memory: 13.86GiB(29.17%)  tps: 8,308  tflops: 64.95  mfu: 20.82%
[rank3]:2025-12-31 21:33:38,440 -  step: 750  loss: 11.0703  grad_norm:  2.2434  memory: 29.96GiB(63.05%)  tps: 8,309  tflops: 64.95  mfu: 20.82%
[rank1]:2025-12-31 21:33:38,421 - Avg. fwd time: 15.5978 / Avg. bwd time: 17.4153 / Avg. batch time: 461.5452 (ms) / GPU bubble ratio: 42.78%
[rank1]:2025-12-31 21:33:38,437 -  step: 750  loss: -8.0000  grad_norm:  2.2434  memory: 17.20GiB(36.20%)  tps: 8,308  tflops: 64.95  mfu: 20.82%
[rank3]:2025-12-31 21:35:16,166 - Avg. fwd time: 16.6813 / Avg. bwd time: 24.7383 / Avg. batch time: 390.8209 (ms) / GPU bubble ratio: 15.22%
[rank2]:2025-12-31 21:35:16,192 - Avg. fwd time: 12.2685 / Avg. bwd time: 12.8134 / Avg. batch time: 419.0362 (ms) / GPU bubble ratio: 52.11%
[rank1]:2025-12-31 21:35:16,222 - Avg. fwd time: 15.5967 / Avg. bwd time: 17.4126 / Avg. batch time: 461.4782 (ms) / GPU bubble ratio: 42.78%
[rank0]:2025-12-31 21:35:16,236 - Avg. fwd time: 13.4908 / Avg. bwd time: 10.9890 / Avg. batch time: 482.3871 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-31 21:36:49,950 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 21:36:53,901 - Avg. fwd time: 16.6830 / Avg. bwd time: 24.7380 / Avg. batch time: 390.8325 (ms) / GPU bubble ratio: 15.21%
[rank2]:2025-12-31 21:36:53,928 - Avg. fwd time: 12.2689 / Avg. bwd time: 12.8133 / Avg. batch time: 419.0253 (ms) / GPU bubble ratio: 52.11%
[rank3]:2025-12-31 21:36:53,978 -  step: 800  loss:  9.7916  grad_norm: 13.8693  memory: 29.96GiB(63.05%)  tps: 8,379  tflops: 65.50  mfu: 20.99%
[rank3]:2025-12-31 21:36:53,978 - â„¹ï¸ final step: 800  loss:  9.7916  grad_norm: 13.8693  tps: 8,777  tflops: 68.62  mfu: 19.89%
[rank3]:2025-12-31 21:36:53,979 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 21:36:53,980 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 21:36:53,971 - Avg. fwd time: 13.4916 / Avg. bwd time: 10.9832 / Avg. batch time: 482.2298 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-31 21:36:53,975 -  step: 800  loss: -8.0000  grad_norm: 13.8693  memory: 14.52GiB(30.57%)  tps: 8,379  tflops: 65.50  mfu: 20.99%
[rank0]:2025-12-31 21:36:53,975 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8693  tps: 8,794  tflops: 68.74  mfu: 20.14%
[rank0]:2025-12-31 21:36:53,976 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 21:36:53,976 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 21:36:53,958 - Avg. fwd time: 15.5972 / Avg. bwd time: 17.4014 / Avg. batch time: 461.4067 (ms) / GPU bubble ratio: 42.79%
[rank1]:2025-12-31 21:36:53,975 -  step: 800  loss: -8.0000  grad_norm: 13.8693  memory: 17.20GiB(36.20%)  tps: 8,379  tflops: 65.50  mfu: 20.99%
[rank1]:2025-12-31 21:36:53,975 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8693  tps: 8,771  tflops: 68.57  mfu: 19.84%
[rank1]:2025-12-31 21:36:53,975 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 21:36:53,976 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-31 21:36:53,975 -  step: 800  loss: -8.0000  grad_norm: 13.8693  memory: 13.86GiB(29.17%)  tps: 8,379  tflops: 65.50  mfu: 20.99%
[rank2]:2025-12-31 21:36:53,975 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm: 13.8693  tps: 8,771  tflops: 68.57  mfu: 19.84%
[rank2]:2025-12-31 21:36:53,975 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 21:36:53,976 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 21:36:55,930 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-31 21:36:56,001 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank0/251231_2136_stage0_final800.svg
[rank1]:2025-12-31 21:36:56,001 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank1/251231_2136_stage1_final800.svg
[rank2]:2025-12-31 21:36:56,001 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank2/251231_2136_stage2_final800.svg
[rank3]:2025-12-31 21:36:56,088 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2136_final800_rank3.svg
[rank3]:			> Batch Time: 477.50 ms, GPU Bubble Ratio: 59.39%, 45.44%, 58.01%, 30.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-13-27ms     | [S0,MB2,F]  27-13-40ms     | [S0,MB3,F]  40-13-53ms     | [S0,MB4,F]  53-12-66ms     | [S0,MB5,F]  66-13-80ms     | [S0,MB6,F]  80-13-93ms     | [S0,MB7,F]  93-14-107ms    | [S0,MB0,B]  301-12-313ms   | [S0,MB1,B]  325-12-338ms   | [S0,MB2,B]  350-12-362ms   | [S0,MB3,B]  375-12-387ms   | [S0,MB4,B]  400-12-412ms   | [S0,MB5,B]  426-12-438ms   | [S0,MB6,B]  454-12-467ms   | [S0,MB7,B]  477-0-477ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-15-29ms     | [S1,MB1,F]  32-15-48ms     | [S1,MB2,F]  51-15-67ms     | [S1,MB3,F]  72-15-88ms     | [S1,MB4,F]  96-15-112ms    | [S1,MB5,F]  120-15-136ms   | [S1,MB6,F]  145-15-160ms   | [S1,MB7,F]  169-15-185ms   | [S1,MB0,B]  281-16-297ms   | [S1,MB1,B]  306-16-322ms   | [S1,MB2,B]  330-16-346ms   | [S1,MB3,B]  355-16-371ms   | [S1,MB4,B]  380-16-396ms   | [S1,MB5,B]  405-16-421ms   | [S1,MB6,B]  431-18-449ms   | [S1,MB7,B]  455-19-474ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-42ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  69-12-81ms     | [S2,MB3,F]  93-12-105ms    | [S2,MB4,F]  117-12-129ms   | [S2,MB5,F]  141-12-154ms   | [S2,MB6,F]  166-12-178ms   | [S2,MB7,F]  190-12-202ms   | [S2,MB0,B]  265-12-277ms   | [S2,MB1,B]  289-12-302ms   | [S2,MB2,B]  313-12-326ms   | [S2,MB3,B]  338-12-351ms   | [S2,MB4,B]  363-12-376ms   | [S2,MB5,B]  388-12-400ms   | [S2,MB6,B]  413-12-426ms   | [S2,MB7,B]  435-11-447ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  42-16-58ms     | [S3,MB1,F]  66-16-82ms     | [S3,MB2,F]  90-16-106ms    | [S3,MB3,F]  114-16-131ms   | [S3,MB4,F]  138-16-155ms   | [S3,MB5,F]  163-16-179ms   | [S3,MB6,F]  187-16-204ms   | [S3,MB7,F]  211-16-228ms   | [S3,MB0,B]  234-23-258ms   | [S3,MB1,B]  258-24-282ms   | [S3,MB2,B]  282-24-306ms   | [S3,MB3,B]  306-25-331ms   | [S3,MB4,B]  332-24-356ms   | [S3,MB5,B]  356-24-381ms   | [S3,MB6,B]  381-25-407ms   | [S3,MB7,B]  407-24-431ms  
[rank3]:2025-12-31 21:36:56,226 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/pipeline_schedule/251231_2136_thry_final800_rank3.svg
[rank3]:			> Batch Time: 477.66 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-14-28ms     | [S0,MB2,F]  28-14-43ms     | [S0,MB3,F]  43-14-57ms     | [S0,MB4,F]  57-14-72ms     | [S0,MB5,F]  72-14-86ms     | [S0,MB6,F]  86-14-101ms    | [S0,MB7,F]  101-14-115ms   | [S0,MB0,B]  246-28-275ms   | [S0,MB1,B]  275-28-303ms   | [S0,MB2,B]  303-28-332ms   | [S0,MB3,B]  332-28-361ms   | [S0,MB4,B]  361-28-390ms   | [S0,MB5,B]  390-28-419ms   | [S0,MB6,B]  419-28-448ms   | [S0,MB7,B]  448-28-477ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-14-28ms     | [S1,MB1,F]  28-14-43ms     | [S1,MB2,F]  43-14-57ms     | [S1,MB3,F]  57-14-72ms     | [S1,MB4,F]  72-14-86ms     | [S1,MB5,F]  86-14-101ms    | [S1,MB6,F]  101-14-115ms   | [S1,MB7,F]  115-14-130ms   | [S1,MB0,B]  217-28-246ms   | [S1,MB1,B]  246-28-275ms   | [S1,MB2,B]  275-28-303ms   | [S1,MB3,B]  303-28-332ms   | [S1,MB4,B]  332-28-361ms   | [S1,MB5,B]  361-28-390ms   | [S1,MB6,B]  390-28-419ms   | [S1,MB7,B]  419-28-448ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-14-43ms     | [S2,MB1,F]  43-14-57ms     | [S2,MB2,F]  57-14-72ms     | [S2,MB3,F]  72-14-86ms     | [S2,MB4,F]  86-14-101ms    | [S2,MB5,F]  101-14-115ms   | [S2,MB6,F]  115-14-130ms   | [S2,MB7,F]  130-14-144ms   | [S2,MB0,B]  188-28-217ms   | [S2,MB1,B]  217-28-246ms   | [S2,MB2,B]  246-28-275ms   | [S2,MB3,B]  275-28-303ms   | [S2,MB4,B]  303-28-332ms   | [S2,MB5,B]  332-28-361ms   | [S2,MB6,B]  361-28-390ms   | [S2,MB7,B]  390-28-419ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  43-14-57ms     | [S3,MB1,F]  57-14-72ms     | [S3,MB2,F]  72-14-86ms     | [S3,MB3,F]  86-14-101ms    | [S3,MB4,F]  101-14-115ms   | [S3,MB5,F]  115-14-130ms   | [S3,MB6,F]  130-14-144ms   | [S3,MB7,F]  144-14-159ms   | [S3,MB0,B]  159-28-188ms   | [S3,MB1,B]  188-28-217ms   | [S3,MB2,B]  217-28-246ms   | [S3,MB3,B]  246-28-275ms   | [S3,MB4,B]  275-28-303ms   | [S3,MB5,B]  303-28-332ms   | [S3,MB6,B]  332-28-361ms   | [S3,MB7,B]  361-28-390ms  
[rank0]:2025-12-31 21:36:56,176 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2136_rank0_stage0.svg
[rank0]:	> Counts Sum: 338720, Total Sum: 2616320 (12.95%), Ratio(%) per element: [12.84, 13.01, 12.32, 13.01, 12.67, 13.01, 13.35, 13.18, 13.18, 12.84, 12.5, 12.67, 13.18, 13.01, 13.01, 13.18, 12.84, 13.01, 13.01, 12.84, 12.67, 12.5, 12.84, 13.18, 12.84, 12.84, 13.01, 13.18, 12.84, 12.84, 12.84, 13.18, 12.67, 12.84, 12.5, 13.01, 12.84, 12.5, 12.84, 13.18, 12.84, 12.84, 13.18, 13.52, 13.01, 13.18, 13.18, 13.18, 13.01, 12.67, 13.18, 13.35, 12.84, 13.52, 12.67, 12.84]
[rank1]:2025-12-31 21:36:56,187 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2136_rank1_stage1.svg
[rank1]:	> Counts Sum: 423360, Total Sum: 3270400 (12.95%), Ratio(%) per element: [12.67, 12.84, 13.52, 13.01, 13.18, 13.18, 13.18, 12.84, 13.18, 12.84, 12.84, 13.18, 12.5, 12.84, 13.01, 12.67, 13.01, 13.35, 13.01, 12.84, 13.01, 13.01, 12.67, 13.01, 13.18, 13.01, 12.5, 12.84, 13.01, 13.18, 12.84, 13.01, 12.67, 12.84, 12.67, 13.18, 12.67, 12.5, 13.35, 12.84, 13.01, 13.35, 12.67, 12.67, 12.84, 12.67, 13.18, 12.84, 13.18, 13.01, 12.84, 13.35, 13.01, 12.5, 13.01, 12.32, 13.01, 12.84, 12.84, 13.01, 13.52, 13.01, 12.84, 12.5, 12.84, 13.18, 12.5, 13.35, 13.01, 13.35]
[rank2]:2025-12-31 21:36:56,174 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2136_rank2_stage2.svg
[rank2]:	> Counts Sum: 338720, Total Sum: 2616320 (12.95%), Ratio(%) per element: [12.84, 13.35, 12.84, 13.01, 13.35, 12.84, 13.01, 12.67, 12.67, 13.01, 13.01, 13.01, 13.01, 12.84, 12.84, 13.01, 13.35, 13.18, 12.67, 13.18, 12.84, 13.01, 13.01, 12.67, 13.18, 13.01, 12.32, 13.01, 13.35, 12.84, 13.18, 13.52, 12.5, 12.84, 12.84, 12.84, 12.67, 12.67, 12.32, 12.84, 12.84, 13.01, 12.84, 12.5, 13.52, 13.01, 13.18, 12.84, 12.84, 12.84, 13.01, 13.01, 13.01, 13.35, 13.18, 12.67]
[rank3]:2025-12-31 21:36:56,274 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_ratio_history/rank3/251231_2136_stage3_final800.svg
[rank3]:2025-12-31 21:36:56,415 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/frozen_params_histogram/251231_2136_rank3_stage3.svg
[rank3]:	> Counts Sum: 1480800, Total Sum: 1962240 (75.46%), Ratio(%) per element: [77.05, 75.51, 74.82, 75.0, 75.51, 75.17, 77.73, 75.17, 74.65, 76.36, 74.82, 75.0, 74.14, 73.8, 74.65, 74.82, 74.82, 75.68, 74.82, 76.36, 74.31, 75.68, 76.36, 76.54, 76.36, 76.02, 76.36, 75.51, 74.82, 74.65, 76.19, 75.51, 75.34, 76.71, 74.65, 76.19, 76.54, 74.31, 73.28, 76.71, 76.54, 74.82]
[rank0]:2025-12-31 21:36:58,046 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2136_stage0.svg
[rank0]:2025-12-31 21:36:58,050 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-31 21:36:58,013 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2136_stage1.svg
[rank1]:2025-12-31 21:36:58,016 - Destroying the purge thread.
[rank2]:2025-12-31 21:36:58,026 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2136_stage2.svg
[rank2]:2025-12-31 21:36:58,030 - Destroying the purge thread.
[rank1]:2025-12-31 21:36:58,092 - Process group destroyed
[rank2]:2025-12-31 21:36:58,103 - Process group destroyed
[rank3]:2025-12-31 21:36:58,253 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1/afr_time_plot/251231_2136_stage3.svg
[rank3]:2025-12-31 21:36:58,257 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–‚â–‚â–‚â–ˆâ–â–â–â–‡â–â–â–â–‡â–‚â–â–â–†
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.73323
[rank3]:wandb:               final/avg_loss 9.79156
[rank3]:wandb:             final/avg_mfu(%) 19.89015
[rank3]:wandb:             final/avg_tflops 68.61748
[rank3]:wandb:    final/avg_throughput(tps) 8777.37566
[rank3]:wandb:              final/grad_norm 13.86931
[rank3]:wandb:               final/max_loss 9.79156
[rank3]:wandb:                    grad_norm 13.86931
[rank3]:wandb: loss_metrics/global_avg_loss 9.79156
[rank3]:wandb: loss_metrics/global_max_loss 9.79156
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_GPipe_timelyapf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/6biu9n2z
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_GPipe_timelyapf_42_dm1/20251231-2043/wandb/run-20251231_204359-6biu9n2z/logs
[rank3]:2025-12-31 21:36:59,625 - Process group destroyed
[rank0]:2025-12-31 21:37:00,050 - Training completed
[rank0]:2025-12-31 21:37:00,050 - Destroying the purge thread.
[rank0]:2025-12-31 21:37:00,102 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.5', 'layers.6', 'layers.8'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.10', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.13', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_GPipe_timelyapf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_GPipe_timelyapf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_GPipe_timelyapf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_GPipe_timelyapf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_GPipe_timelyapf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_GPipe_timelyapf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_GPipe_timelyapf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_GPipe_timelyapf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'tok_embeddings', 'layers.1', 'layers.3'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
