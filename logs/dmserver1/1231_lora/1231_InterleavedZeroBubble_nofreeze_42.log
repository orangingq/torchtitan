
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 16:17:17 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_InterleavedZeroBubble_nofreeze_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with nofreeze x InterleavedZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2026-01-01 16:17:24,920 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank1]:2026-01-01 16:17:24,921 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank3]:2026-01-01 16:17:25,071 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank2]:2026-01-01 16:17:25,216 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 16:17:25,219 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-01 16:17:25,239 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 16:17:25,242 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-01 16:17:25,300 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 16:17:25,302 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 16:17:25,305 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank0]:2026-01-01 16:17:25,459 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 16:17:25,462 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 16:17:25,465 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 16:17:25,467 - Loading tokenizer from tokenizer.json
[rank0]:2026-01-01 16:17:25,840 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2026-01-01 16:17:28,945 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2026-01-01 16:17:29,047 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 16:17:29,093 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 16:17:29,132 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 16:17:29,134 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2026-01-01 16:17:29,161 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2026-01-01 16:17:29,174 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2026-01-01 16:17:29,176 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank1]:2026-01-01 16:17:29,087 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 16:17:29,115 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2026-01-01 16:17:29,129 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2026-01-01 16:17:29,131 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank0]:2026-01-01 16:17:29,366 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 16:17:29,367 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 16:17:29,367 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2026-01-01 16:17:29,328 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 16:17:29,329 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 16:17:29,329 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run htm9octl
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_InterleavedZeroBubble_nofreeze_42_dm1/20260101-1617/wandb/run-20260101_161730-htm9octl
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/htm9octl
[rank3]:2026-01-01 16:17:31,440 - WandB logging enabled
[rank3]:2026-01-01 16:17:31,441 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 16:17:31,478 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 16:17:31,506 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2026-01-01 16:17:31,519 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2026-01-01 16:17:31,521 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank3]:2026-01-01 16:17:31,717 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 16:17:31,718 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 16:17:31,719 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank2]:2026-01-01 16:17:34,411 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 16:17:34,450 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 16:17:34,476 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2026-01-01 16:17:34,489 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2026-01-01 16:17:34,491 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank0]:2026-01-01 16:17:34,688 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank0]:2026-01-01 16:17:34,689 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 16:17:34,689 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 16:17:34,689 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2026-01-01 16:17:34,689 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 16:17:34,672 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 16:17:34,673 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 16:17:34,673 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank2]:2026-01-01 16:17:34,688 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-01 16:17:34,688 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 16:17:37,238 - [LoRA] [Stage 2] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank2]:2026-01-01 16:17:37,260 - [LoRA] [Stage 6] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank2]:2026-01-01 16:17:37,261 - Freezable Parameters: [Stage 2] 28 params, [Stage 6] 28 params
[rank0]:2026-01-01 16:17:37,218 - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2026-01-01 16:17:37,218 - Finished loading the checkpoint in 2.53 seconds.
[rank3]:2026-01-01 16:17:37,271 - [LoRA] [Stage 3] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank3]:2026-01-01 16:17:37,284 - [LoRA] [Stage 7] trainable num params: 14 / 25 = 56.00% (size: 704,512 / 324,196,352 = 0.22%)
[rank0]:2026-01-01 16:17:37,242 - [LoRA] [Stage 0] trainable num params: 28 / 47 = 59.57% (size: 1,409,024 / 385,720,320 = 0.37%)
[rank3]:2026-01-01 16:17:37,285 - Freezable Parameters: [Stage 3] 28 params, [Stage 7] 14 params
[rank0]:2026-01-01 16:17:37,265 - [LoRA] [Stage 4] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank0]:2026-01-01 16:17:37,265 - Freezable Parameters: [Stage 0] 28 params, [Stage 4] 28 params
[rank0]:2026-01-01 16:17:37,265 - Training starts at step 1
[rank1]:2026-01-01 16:17:37,249 - [LoRA] [Stage 1] trainable num params: 42 / 69 = 60.87% (size: 2,113,536 / 184,578,048 = 1.15%)
[rank1]:2026-01-01 16:17:37,274 - [LoRA] [Stage 5] trainable num params: 28 / 46 = 60.87% (size: 1,409,024 / 123,052,032 = 1.15%)
[rank1]:2026-01-01 16:17:37,274 - Freezable Parameters: [Stage 1] 42 params, [Stage 5] 28 params
[rank2]:2026-01-01 16:17:43,073 -  step:  1  loss: -4.0000  grad_norm:  9.9909  memory: 14.23GiB(29.96%)  tps: 3,800  tflops: 29.71  mfu: 9.52%
[rank2]:2026-01-01 16:17:43,073 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 16:17:43,074 -  step:  1  loss: 10.6092  grad_norm:  9.9909  memory: 30.44GiB(64.07%)  tps: 2,826  tflops: 22.10  mfu: 7.08%
[rank3]:2026-01-01 16:17:43,074 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 16:17:43,087 -  step:  1  loss: -4.0000  grad_norm:  9.9909  memory: 19.62GiB(41.30%)  tps: 2,341  tflops: 18.30  mfu: 5.86%
[rank1]:2026-01-01 16:17:43,087 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 16:17:43,103 -  step:  1  loss: -4.0000  grad_norm:  9.9909  memory: 13.98GiB(29.42%)  tps: 2,346  tflops: 18.34  mfu: 5.88%
[rank0]:2026-01-01 16:17:43,103 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-01 16:21:40,769 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:21:45,617 - Avg. fwd time: 17.0574 / Avg. bwd-weight time: 1.5118 / Avg. bwd-input time: 26.3478 / Avg. batch time: 1066.9968 (ms) / GPU bubble ratio: 32.65%
[rank0]:2026-01-01 16:21:45,712 - Avg. fwd time: 13.6711 / Avg. full-bwd time: 14.4934 (Avg. bwd-weight time: 1.3547 / Avg. bwd-input time: 15.0069) / Avg. batch time: 1219.5611 (ms) / GPU bubble ratio: 61.82%
[rank2]:2026-01-01 16:21:45,666 - Avg. fwd time: 13.3081 / Avg. bwd-weight time: 2.0652 / Avg. bwd-input time: 15.0605 / Avg. batch time: 1132.7200 (ms) / GPU bubble ratio: 57.01%
[rank2]:2026-01-01 16:21:45,715 -  step: 50  loss: -4.0000  grad_norm:  8.4748  memory: 14.23GiB(29.96%)  tps: 6,617  tflops: 51.73  mfu: 16.58%
[rank3]:2026-01-01 16:21:45,716 -  step: 50  loss: 12.4624  grad_norm:  8.4748  memory: 30.44GiB(64.07%)  tps: 6,617  tflops: 51.73  mfu: 16.58%
[rank1]:2026-01-01 16:21:45,701 - Avg. fwd time: 16.6991 / Avg. bwd-weight time: 2.9133 / Avg. bwd-input time: 18.9510 / Avg. batch time: 1190.3970 (ms) / GPU bubble ratio: 48.17%
[rank1]:2026-01-01 16:21:45,715 -  step: 50  loss: -4.0000  grad_norm:  8.4748  memory: 19.62GiB(41.30%)  tps: 6,618  tflops: 51.73  mfu: 16.58%
[rank0]:2026-01-01 16:21:45,716 -  step: 50  loss: -4.0000  grad_norm:  8.4748  memory: 13.98GiB(29.42%)  tps: 6,618  tflops: 51.74  mfu: 16.58%
[rank0]:2026-01-01 16:25:49,220 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:25:54,050 - Avg. fwd time: 17.1139 / Avg. bwd-weight time: 1.5227 / Avg. bwd-input time: 26.4174 / Avg. batch time: 1068.8242 (ms) / GPU bubble ratio: 32.56%
[rank0]:2026-01-01 16:25:54,146 - Avg. fwd time: 13.6811 / Avg. full-bwd time: 14.5438 (Avg. bwd-weight time: 1.3454 / Avg. bwd-input time: 15.0147) / Avg. batch time: 1221.3718 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 16:25:54,149 -  step: 100  loss: -4.0000  grad_norm:  7.6477  memory: 13.98GiB(29.42%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank1]:2026-01-01 16:25:54,135 - Avg. fwd time: 16.7200 / Avg. bwd-weight time: 2.9172 / Avg. bwd-input time: 18.9705 / Avg. batch time: 1192.1796 (ms) / GPU bubble ratio: 48.19%
[rank1]:2026-01-01 16:25:54,149 -  step: 100  loss: -4.0000  grad_norm:  7.6477  memory: 19.62GiB(41.30%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank2]:2026-01-01 16:25:54,100 - Avg. fwd time: 13.3189 / Avg. bwd-weight time: 2.0691 / Avg. bwd-input time: 15.0668 / Avg. batch time: 1134.4513 (ms) / GPU bubble ratio: 57.05%
[rank2]:2026-01-01 16:25:54,149 -  step: 100  loss: -4.0000  grad_norm:  7.6477  memory: 14.23GiB(29.96%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank3]:2026-01-01 16:25:54,150 -  step: 100  loss: 13.1176  grad_norm:  7.6477  memory: 30.44GiB(64.07%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank3]:2026-01-01 16:25:54,504 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1625_step100_rank3.svg
[rank3]:			> Batch Time: 1216.71 ms, GPU Bubble Ratio: 61.69%, 49.29%, 60.01%, 40.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S4,MB0,BI] 387-14-401ms   | [S4,MB0,BW] 401-1-402ms    | [S0,MB4,F]  402-12-415ms   | [S4,MB1,BI] 455-15-471ms   | [S4,MB1,BW] 471-1-472ms    | [S0,MB5,F]  472-12-485ms   | [S4,MB2,BI] 532-15-547ms   | [S4,MB2,BW] 547-1-548ms    | [S0,MB6,F]  549-13-562ms   | [S4,MB3,BI] 601-17-618ms   | [S4,MB3,BW] 618-1-619ms    | [S0,MB7,F]  619-16-635ms   | [S0,MB0,B]  655-16-671ms   | [S4,MB4,F]  671-12-684ms   | [S0,MB1,B]  707-15-722ms   | [S4,MB5,F]  723-12-735ms   | [S0,MB2,B]  752-14-766ms   | [S4,MB6,F]  767-12-779ms   | [S0,MB3,B]  796-14-811ms   | [S4,MB7,F]  811-12-824ms   | [S4,MB4,BI] 855-15-870ms   | [S4,MB4,BW] 870-1-871ms    | [S4,MB5,BI] 941-14-955ms   | [S4,MB5,BW] 955-1-956ms    | [S4,MB6,BI] 1004-14-1018ms | [S4,MB6,BW] 1018-1-1019ms  | [S4,MB7,BI] 1080-14-1094ms | [S4,MB7,BW] 1094-2-1096ms  | [S0,MB4,B]  1109-13-1122ms | [S0,MB5,B]  1145-13-1158ms | [S0,MB6,B]  1174-13-1187ms | [S0,MB7,B]  1203-13-1216ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  264-12-276ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 364-14-378ms   | [S5,MB3,F]  379-15-394ms   | [S5,MB1,BI] 433-14-447ms   | [S5,MB0,BW] 447-3-451ms    | [S1,MB4,F]  457-19-477ms   | [S5,MB2,BI] 504-15-519ms   | [S5,MB1,BW] 519-1-520ms    | [S1,MB5,F]  533-19-552ms   | [S5,MB3,BI] 575-16-592ms   | [S5,MB2,BW] 592-3-595ms    | [S1,MB6,F]  604-20-624ms   | [S1,MB0,BI] 624-24-648ms   | [S5,MB3,BW] 648-2-651ms    | [S1,MB7,F]  656-20-677ms   | [S1,MB1,BI] 677-23-700ms   | [S1,MB0,BW] 700-3-703ms    | [S5,MB4,F]  708-14-722ms   | [S1,MB2,BI] 722-23-745ms   | [S1,MB1,BW] 745-3-748ms    | [S5,MB5,F]  753-13-766ms   | [S1,MB3,BI] 766-23-789ms   | [S1,MB2,BW] 789-3-793ms    | [S5,MB6,F]  797-13-811ms   | [S5,MB4,BI] 832-15-848ms   | [S1,MB3,BW] 848-3-851ms    | [S5,MB7,F]  855-13-868ms   | [S5,MB5,BI] 906-15-921ms   | [S5,MB4,BW] 921-1-922ms    | [S5,MB6,BI] 982-14-997ms   | [S5,MB5,BW] 997-2-999ms    | [S5,MB7,BI] 1058-14-1073ms | [S5,MB6,BW] 1073-2-1076ms  | [S1,MB4,BI] 1080-21-1102ms | [S5,MB7,BW] 1102-2-1105ms  | [S1,MB5,BI] 1116-21-1138ms | [S1,MB4,BW] 1138-3-1142ms  | [S1,MB6,BI] 1145-22-1167ms | [S1,MB5,BW] 1167-3-1171ms  | [S1,MB7,BI] 1174-22-1196ms | [S1,MB6,BW] 1196-3-1200ms  | [S1,MB7,BW] 1199-1-1200ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  276-12-289ms   | [S6,MB0,BI] 342-14-357ms   | [S6,MB2,F]  357-14-372ms   | [S6,MB1,BI] 411-15-426ms   | [S6,MB3,F]  426-14-440ms   | [S6,MB2,BI] 482-14-497ms   | [S6,MB0,BW] 497-2-499ms    | [S2,MB4,F]  505-13-518ms   | [S6,MB3,BI] 552-15-568ms   | [S6,MB1,BW] 568-2-570ms    | [S2,MB5,F]  578-13-591ms   | [S2,MB0,BI] 595-16-612ms   | [S6,MB2,BW] 612-2-614ms    | [S2,MB6,F]  627-13-641ms   | [S2,MB1,BI] 641-15-656ms   | [S6,MB3,BW] 656-1-658ms    | [S2,MB7,F]  678-13-691ms   | [S2,MB2,BI] 691-15-707ms   | [S2,MB0,BW] 707-1-709ms    | [S6,MB4,F]  723-13-736ms   | [S2,MB3,BI] 736-15-752ms   | [S2,MB1,BW] 752-1-754ms    | [S6,MB5,F]  767-13-780ms   | [S6,MB4,BI] 810-15-825ms   | [S2,MB2,BW] 825-2-828ms    | [S6,MB6,F]  833-13-846ms   | [S6,MB5,BI] 884-15-900ms   | [S2,MB3,BW] 899-2-902ms    | [S6,MB7,F]  907-13-920ms   | [S6,MB6,BI] 960-15-976ms   | [S6,MB4,BW] 975-2-978ms    | [S6,MB7,BI] 1037-14-1052ms | [S6,MB5,BW] 1052-2-1055ms  | [S2,MB4,BI] 1059-14-1074ms | [S6,MB6,BW] 1073-2-1076ms  | [S2,MB5,BI] 1095-14-1110ms | [S6,MB7,BW] 1109-2-1112ms  | [S2,MB6,BI] 1116-14-1131ms | [S2,MB4,BW] 1130-1-1132ms  | [S2,MB7,BI] 1145-14-1160ms | [S2,MB5,BW] 1159-1-1161ms  | [S2,MB6,BW] 1160-1-1161ms  | [S2,MB7,BW] 1161-1-1162ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-231ms   | [S7,MB0,F]  270-18-289ms   | [S7,MB0,BI] 301-35-336ms   | [S7,MB1,F]  336-21-357ms   | [S7,MB1,BI] 369-35-405ms   | [S7,MB2,F]  404-23-428ms   | [S7,MB2,BI] 440-36-476ms   | [S7,MB3,F]  476-22-498ms   | [S7,MB3,BI] 510-36-546ms   | [S7,MB0,BW] 546-1-548ms    | [S3,MB4,F]  554-14-569ms   | [S3,MB0,BI] 568-18-586ms   | [S7,MB1,BW] 586-2-588ms    | [S3,MB5,F]  599-13-612ms   | [S3,MB1,BI] 612-17-629ms   | [S7,MB2,BW] 629-1-630ms    | [S3,MB6,F]  642-13-655ms   | [S3,MB2,BI] 655-16-671ms   | [S7,MB3,BW] 672-0-673ms    | [S3,MB7,F]  693-13-706ms   | [S3,MB3,BI] 706-16-722ms   | [S3,MB0,BW] 722-1-724ms    | [S7,MB4,F]  738-18-756ms   | [S7,MB4,BI] 768-35-803ms   | [S3,MB1,BW] 803-2-806ms    | [S7,MB5,F]  811-19-831ms   | [S7,MB5,BI] 842-35-878ms   | [S3,MB2,BW] 878-2-880ms    | [S7,MB6,F]  885-20-905ms   | [S7,MB6,BI] 918-35-954ms   | [S3,MB3,BW] 954-2-956ms    | [S7,MB7,F]  962-21-984ms   | [S7,MB7,BI] 994-35-1030ms  | [S7,MB4,BW] 1030-1-1032ms  | [S3,MB4,BI] 1032-17-1049ms | [S7,MB5,BW] 1049-0-1050ms  | [S3,MB5,BI] 1050-17-1067ms | [S7,MB6,BW] 1067-0-1068ms  | [S3,MB6,BI] 1068-16-1084ms | [S7,MB7,BW] 1084-0-1085ms  | [S3,MB7,BI] 1088-16-1105ms | [S3,MB4,BW] 1105-1-1106ms  | [S3,MB5,BW] 1106-1-1107ms  | [S3,MB6,BW] 1107-1-1108ms  | [S3,MB7,BW] 1108-1-1109ms 
[rank0]:2026-01-01 16:29:57,700 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:30:02,569 - Avg. fwd time: 17.1174 / Avg. bwd-weight time: 1.5251 / Avg. bwd-input time: 26.4207 / Avg. batch time: 1068.9440 (ms) / GPU bubble ratio: 32.55%
[rank2]:2026-01-01 16:30:02,617 - Avg. fwd time: 13.3213 / Avg. bwd-weight time: 2.0705 / Avg. bwd-input time: 15.0676 / Avg. batch time: 1135.0649 (ms) / GPU bubble ratio: 57.06%
[rank2]:2026-01-01 16:30:02,668 -  step: 150  loss: -4.0000  grad_norm:  8.3536  memory: 14.23GiB(29.96%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank1]:2026-01-01 16:30:02,653 - Avg. fwd time: 16.7249 / Avg. bwd-weight time: 2.9186 / Avg. bwd-input time: 18.9735 / Avg. batch time: 1192.7914 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 16:30:02,668 -  step: 150  loss: -4.0000  grad_norm:  8.3536  memory: 19.62GiB(41.30%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank0]:2026-01-01 16:30:02,664 - Avg. fwd time: 13.6846 / Avg. full-bwd time: 14.5579 (Avg. bwd-weight time: 1.3438 / Avg. bwd-input time: 15.0170) / Avg. batch time: 1222.0045 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 16:30:02,668 -  step: 150  loss: -4.0000  grad_norm:  8.3536  memory: 13.98GiB(29.42%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank3]:2026-01-01 16:30:02,668 -  step: 150  loss: 11.1266  grad_norm:  8.3536  memory: 30.44GiB(64.07%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank0]:2026-01-01 16:34:05,859 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:34:10,818 - Avg. fwd time: 17.1172 / Avg. bwd-weight time: 1.5256 / Avg. bwd-input time: 26.4235 / Avg. batch time: 1068.9868 (ms) / GPU bubble ratio: 32.55%
[rank1]:2026-01-01 16:34:10,903 - Avg. fwd time: 16.7273 / Avg. bwd-weight time: 2.9193 / Avg. bwd-input time: 18.9750 / Avg. batch time: 1192.7301 (ms) / GPU bubble ratio: 48.19%
[rank0]:2026-01-01 16:34:10,915 - Avg. fwd time: 13.6869 / Avg. full-bwd time: 14.5647 (Avg. bwd-weight time: 1.3428 / Avg. bwd-input time: 15.0177) / Avg. batch time: 1221.9586 (ms) / GPU bubble ratio: 61.83%
[rank2]:2026-01-01 16:34:10,867 - Avg. fwd time: 13.3232 / Avg. bwd-weight time: 2.0714 / Avg. bwd-input time: 15.0680 / Avg. batch time: 1134.9983 (ms) / GPU bubble ratio: 57.06%
[rank3]:2026-01-01 16:34:10,919 -  step: 200  loss: 10.3045  grad_norm: 36.8148  memory: 30.44GiB(64.07%)  tps: 6,600  tflops: 51.59  mfu: 16.54%
[rank1]:2026-01-01 16:34:10,918 -  step: 200  loss: -4.0000  grad_norm: 36.8148  memory: 19.62GiB(41.30%)  tps: 6,600  tflops: 51.59  mfu: 16.54%
[rank0]:2026-01-01 16:34:10,918 -  step: 200  loss: -4.0000  grad_norm: 36.8148  memory: 13.98GiB(29.42%)  tps: 6,600  tflops: 51.59  mfu: 16.54%
[rank2]:2026-01-01 16:34:10,918 -  step: 200  loss: -4.0000  grad_norm: 36.8148  memory: 14.23GiB(29.96%)  tps: 6,600  tflops: 51.59  mfu: 16.54%
[rank3]:2026-01-01 16:34:11,254 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1634_step200_rank3.svg
[rank3]:			> Batch Time: 1220.73 ms, GPU Bubble Ratio: 61.77%, 49.32%, 60.07%, 40.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-202ms   | [S4,MB3,F]  245-14-260ms   | [S4,MB0,BI] 388-14-402ms   | [S4,MB0,BW] 402-1-403ms    | [S0,MB4,F]  403-12-416ms   | [S4,MB1,BI] 458-15-474ms   | [S4,MB1,BW] 474-1-475ms    | [S0,MB5,F]  475-12-488ms   | [S4,MB2,BI] 535-15-551ms   | [S4,MB2,BW] 551-1-552ms    | [S0,MB6,F]  552-13-565ms   | [S4,MB3,BI] 603-17-620ms   | [S4,MB3,BW] 620-1-621ms    | [S0,MB7,F]  621-15-637ms   | [S0,MB0,B]  658-16-674ms   | [S4,MB4,F]  674-12-687ms   | [S0,MB1,B]  710-15-725ms   | [S4,MB5,F]  726-12-738ms   | [S0,MB2,B]  755-14-769ms   | [S4,MB6,F]  770-12-782ms   | [S0,MB3,B]  799-14-814ms   | [S4,MB7,F]  814-13-827ms   | [S4,MB4,BI] 858-15-873ms   | [S4,MB4,BW] 873-1-874ms    | [S4,MB5,BI] 942-14-956ms   | [S4,MB5,BW] 956-1-957ms    | [S4,MB6,BI] 1006-14-1020ms | [S4,MB6,BW] 1020-1-1021ms  | [S4,MB7,BI] 1084-14-1098ms | [S4,MB7,BW] 1098-2-1100ms  | [S0,MB4,B]  1113-13-1126ms | [S0,MB5,B]  1150-13-1163ms | [S0,MB6,B]  1178-13-1191ms | [S0,MB7,B]  1207-13-1220ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-91ms     | [S1,MB2,F]  129-19-149ms   | [S1,MB3,F]  187-19-207ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  284-12-297ms   | [S5,MB0,BI] 365-14-380ms   | [S5,MB3,F]  379-15-395ms   | [S5,MB1,BI] 435-14-450ms   | [S5,MB0,BW] 450-3-453ms    | [S1,MB4,F]  459-19-479ms   | [S5,MB2,BI] 505-15-520ms   | [S5,MB1,BW] 520-1-522ms    | [S1,MB5,F]  536-19-555ms   | [S5,MB3,BI] 578-16-595ms   | [S5,MB2,BW] 595-3-598ms    | [S1,MB6,F]  606-20-627ms   | [S1,MB0,BI] 627-24-651ms   | [S5,MB3,BW] 651-2-654ms    | [S1,MB7,F]  659-21-680ms   | [S1,MB1,BI] 680-23-703ms   | [S1,MB0,BW] 703-3-706ms    | [S5,MB4,F]  710-14-724ms   | [S1,MB2,BI] 725-23-748ms   | [S1,MB1,BW] 748-3-751ms    | [S5,MB5,F]  756-13-769ms   | [S1,MB3,BI] 769-23-792ms   | [S1,MB2,BW] 792-3-796ms    | [S5,MB6,F]  800-13-814ms   | [S5,MB4,BI] 835-15-851ms   | [S1,MB3,BW] 851-3-854ms    | [S5,MB7,F]  859-13-872ms   | [S5,MB5,BI] 909-15-924ms   | [S5,MB4,BW] 924-1-925ms    | [S5,MB6,BI] 985-14-999ms   | [S5,MB5,BW] 999-2-1002ms   | [S5,MB7,BI] 1062-14-1077ms | [S5,MB6,BW] 1076-2-1079ms  | [S1,MB4,BI] 1083-21-1105ms | [S5,MB7,BW] 1105-2-1108ms  | [S1,MB5,BI] 1120-22-1142ms | [S1,MB4,BW] 1142-3-1146ms  | [S1,MB6,BI] 1149-22-1171ms | [S1,MB5,BW] 1171-3-1175ms  | [S1,MB7,BI] 1178-22-1200ms | [S1,MB6,BW] 1200-3-1204ms  | [S1,MB7,BW] 1203-1-1205ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  91-12-103ms    | [S2,MB2,F]  149-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB0,BI] 343-14-358ms   | [S6,MB2,F]  358-14-373ms   | [S6,MB1,BI] 413-15-429ms   | [S6,MB3,F]  428-14-443ms   | [S6,MB2,BI] 484-14-498ms   | [S6,MB0,BW] 498-2-501ms    | [S2,MB4,F]  506-13-519ms   | [S6,MB3,BI] 556-15-571ms   | [S6,MB1,BW] 571-2-574ms    | [S2,MB5,F]  581-13-594ms   | [S2,MB0,BI] 598-16-615ms   | [S6,MB2,BW] 615-1-617ms    | [S2,MB6,F]  629-13-643ms   | [S2,MB1,BI] 643-15-659ms   | [S6,MB3,BW] 659-1-661ms    | [S2,MB7,F]  681-13-694ms   | [S2,MB2,BI] 694-15-710ms   | [S2,MB0,BW] 709-1-711ms    | [S6,MB4,F]  726-13-740ms   | [S2,MB3,BI] 739-15-755ms   | [S2,MB1,BW] 754-1-756ms    | [S6,MB5,F]  770-13-783ms   | [S6,MB4,BI] 813-15-828ms   | [S2,MB2,BW] 828-2-831ms    | [S6,MB6,F]  836-13-849ms   | [S6,MB5,BI] 887-15-902ms   | [S2,MB3,BW] 902-2-905ms    | [S6,MB7,F]  910-13-923ms   | [S6,MB6,BI] 962-15-978ms   | [S6,MB4,BW] 978-2-981ms    | [S6,MB7,BI] 1041-14-1055ms | [S6,MB5,BW] 1055-2-1058ms  | [S2,MB4,BI] 1062-14-1077ms | [S6,MB6,BW] 1076-2-1079ms  | [S2,MB5,BI] 1098-14-1113ms | [S6,MB7,BW] 1113-2-1116ms  | [S2,MB6,BI] 1120-14-1135ms | [S2,MB4,BW] 1134-1-1136ms  | [S2,MB7,BI] 1148-14-1163ms | [S2,MB5,BW] 1163-1-1165ms  | [S2,MB6,BW] 1164-1-1166ms  | [S2,MB7,BW] 1165-1-1167ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-289ms   | [S7,MB0,BI] 301-35-337ms   | [S7,MB1,F]  337-21-358ms   | [S7,MB1,BI] 371-36-407ms   | [S7,MB2,F]  407-23-430ms   | [S7,MB2,BI] 441-36-477ms   | [S7,MB3,F]  477-22-500ms   | [S7,MB3,BI] 513-36-549ms   | [S7,MB0,BW] 549-1-551ms    | [S3,MB4,F]  557-14-572ms   | [S3,MB0,BI] 571-18-589ms   | [S7,MB1,BW] 589-2-592ms    | [S3,MB5,F]  602-13-615ms   | [S3,MB1,BI] 615-17-633ms   | [S7,MB2,BW] 633-1-635ms    | [S3,MB6,F]  645-13-658ms   | [S3,MB2,BI] 658-16-674ms   | [S7,MB3,BW] 674-0-675ms    | [S3,MB7,F]  695-13-709ms   | [S3,MB3,BI] 709-16-725ms   | [S3,MB0,BW] 725-1-727ms    | [S7,MB4,F]  740-18-759ms   | [S7,MB4,BI] 771-35-806ms   | [S3,MB1,BW] 806-2-809ms    | [S7,MB5,F]  814-19-833ms   | [S7,MB5,BI] 845-35-880ms   | [S3,MB2,BW] 880-2-883ms    | [S7,MB6,F]  888-20-908ms   | [S7,MB6,BI] 920-35-956ms   | [S3,MB3,BW] 956-2-958ms    | [S7,MB7,F]  964-22-986ms   | [S7,MB7,BI] 997-35-1033ms  | [S7,MB4,BW] 1033-1-1035ms  | [S3,MB4,BI] 1035-17-1053ms | [S7,MB5,BW] 1052-0-1053ms  | [S3,MB5,BI] 1053-17-1071ms | [S7,MB6,BW] 1071-0-1072ms  | [S3,MB6,BI] 1071-16-1088ms | [S7,MB7,BW] 1088-0-1089ms  | [S3,MB7,BI] 1091-16-1108ms | [S3,MB4,BW] 1108-1-1110ms  | [S3,MB5,BW] 1110-1-1112ms  | [S3,MB6,BW] 1111-1-1113ms  | [S3,MB7,BW] 1112-1-1114ms 
[rank0]:2026-01-01 16:38:14,903 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:38:19,745 - Avg. fwd time: 17.1279 / Avg. bwd-weight time: 1.5268 / Avg. bwd-input time: 26.4377 / Avg. batch time: 1069.3526 (ms) / GPU bubble ratio: 32.53%
[rank2]:2026-01-01 16:38:19,795 - Avg. fwd time: 13.3260 / Avg. bwd-weight time: 2.0722 / Avg. bwd-input time: 15.0694 / Avg. batch time: 1135.5790 (ms) / GPU bubble ratio: 57.07%
[rank0]:2026-01-01 16:38:19,840 - Avg. fwd time: 13.6896 / Avg. full-bwd time: 14.5711 (Avg. bwd-weight time: 1.3417 / Avg. bwd-input time: 15.0209) / Avg. batch time: 1222.5726 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 16:38:19,844 -  step: 250  loss: -4.0000  grad_norm:  7.7402  memory: 13.98GiB(29.42%)  tps: 6,582  tflops: 51.45  mfu: 16.49%
[rank3]:2026-01-01 16:38:19,844 -  step: 250  loss: 12.5261  grad_norm:  7.7402  memory: 30.44GiB(64.07%)  tps: 6,582  tflops: 51.45  mfu: 16.49%
[rank1]:2026-01-01 16:38:19,829 - Avg. fwd time: 16.7310 / Avg. bwd-weight time: 2.9195 / Avg. bwd-input time: 18.9816 / Avg. batch time: 1193.3364 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 16:38:19,843 -  step: 250  loss: -4.0000  grad_norm:  7.7402  memory: 19.62GiB(41.30%)  tps: 6,582  tflops: 51.45  mfu: 16.49%
[rank2]:2026-01-01 16:38:19,843 -  step: 250  loss: -4.0000  grad_norm:  7.7402  memory: 14.23GiB(29.96%)  tps: 6,582  tflops: 51.45  mfu: 16.49%
[rank0]:2026-01-01 16:42:23,263 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 16:42:28,145 - Avg. fwd time: 13.3269 / Avg. bwd-weight time: 2.0724 / Avg. bwd-input time: 15.0701 / Avg. batch time: 1135.5266 (ms) / GPU bubble ratio: 57.07%
[rank3]:2026-01-01 16:42:28,095 - Avg. fwd time: 17.1276 / Avg. bwd-weight time: 1.5272 / Avg. bwd-input time: 26.4386 / Avg. batch time: 1069.3771 (ms) / GPU bubble ratio: 32.53%
[rank1]:2026-01-01 16:42:28,180 - Avg. fwd time: 16.7315 / Avg. bwd-weight time: 2.9206 / Avg. bwd-input time: 18.9842 / Avg. batch time: 1193.2971 (ms) / GPU bubble ratio: 48.20%
[rank0]:2026-01-01 16:42:28,191 - Avg. fwd time: 13.6903 / Avg. full-bwd time: 14.5740 (Avg. bwd-weight time: 1.3414 / Avg. bwd-input time: 15.0203) / Avg. batch time: 1222.5400 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 16:42:28,194 -  step: 300  loss: -4.0000  grad_norm:  7.4225  memory: 13.98GiB(29.42%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank2]:2026-01-01 16:42:28,194 -  step: 300  loss: -4.0000  grad_norm:  7.4225  memory: 14.23GiB(29.96%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank3]:2026-01-01 16:42:28,195 -  step: 300  loss: 12.9460  grad_norm:  7.4225  memory: 30.44GiB(64.07%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank1]:2026-01-01 16:42:28,194 -  step: 300  loss: -4.0000  grad_norm:  7.4225  memory: 19.62GiB(41.30%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank3]:2026-01-01 16:42:28,531 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1642_step300_rank3.svg
[rank3]:			> Batch Time: 1218.71 ms, GPU Bubble Ratio: 61.73%, 49.34%, 60.08%, 41.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S4,MB0,BI] 387-14-401ms   | [S4,MB0,BW] 401-1-402ms    | [S0,MB4,F]  403-12-415ms   | [S4,MB1,BI] 457-15-472ms   | [S4,MB1,BW] 472-1-473ms    | [S0,MB5,F]  473-12-486ms   | [S4,MB2,BI] 534-15-549ms   | [S4,MB2,BW] 549-1-550ms    | [S0,MB6,F]  550-13-563ms   | [S4,MB3,BI] 601-17-618ms   | [S4,MB3,BW] 618-1-619ms    | [S0,MB7,F]  619-16-635ms   | [S0,MB0,B]  656-16-672ms   | [S4,MB4,F]  672-12-685ms   | [S0,MB1,B]  708-15-723ms   | [S4,MB5,F]  723-12-736ms   | [S0,MB2,B]  753-14-767ms   | [S4,MB6,F]  768-12-780ms   | [S0,MB3,B]  798-14-812ms   | [S4,MB7,F]  813-13-826ms   | [S4,MB4,BI] 856-15-871ms   | [S4,MB4,BW] 871-1-872ms    | [S4,MB5,BI] 941-14-955ms   | [S4,MB5,BW] 955-1-956ms    | [S4,MB6,BI] 1005-14-1019ms | [S4,MB6,BW] 1019-1-1020ms  | [S4,MB7,BI] 1082-14-1096ms | [S4,MB7,BW] 1096-2-1098ms  | [S0,MB4,B]  1111-13-1124ms | [S0,MB5,B]  1147-13-1160ms | [S0,MB6,B]  1176-13-1189ms | [S0,MB7,B]  1205-13-1218ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  264-12-276ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 364-14-379ms   | [S5,MB3,F]  379-15-394ms   | [S5,MB1,BI] 434-14-448ms   | [S5,MB0,BW] 448-3-452ms    | [S1,MB4,F]  458-19-478ms   | [S5,MB2,BI] 504-15-519ms   | [S5,MB1,BW] 519-1-520ms    | [S1,MB5,F]  534-19-554ms   | [S5,MB3,BI] 577-16-594ms   | [S5,MB2,BW] 594-3-597ms    | [S1,MB6,F]  604-20-625ms   | [S1,MB0,BI] 625-24-649ms   | [S5,MB3,BW] 649-2-652ms    | [S1,MB7,F]  657-20-677ms   | [S1,MB1,BI] 678-23-701ms   | [S1,MB0,BW] 701-3-704ms    | [S5,MB4,F]  708-14-722ms   | [S1,MB2,BI] 723-23-746ms   | [S1,MB1,BW] 746-3-749ms    | [S5,MB5,F]  754-13-767ms   | [S1,MB3,BI] 767-23-790ms   | [S1,MB2,BW] 791-3-794ms    | [S5,MB6,F]  798-13-812ms   | [S5,MB4,BI] 833-15-849ms   | [S1,MB3,BW] 849-3-852ms    | [S5,MB7,F]  857-13-870ms   | [S5,MB5,BI] 908-15-923ms   | [S5,MB4,BW] 923-1-924ms    | [S5,MB6,BI] 984-14-998ms   | [S5,MB5,BW] 998-2-1001ms   | [S5,MB7,BI] 1060-14-1075ms | [S5,MB6,BW] 1074-2-1077ms  | [S1,MB4,BI] 1081-21-1103ms | [S5,MB7,BW] 1103-2-1106ms  | [S1,MB5,BI] 1118-21-1140ms | [S1,MB4,BW] 1140-3-1144ms  | [S1,MB6,BI] 1147-22-1169ms | [S1,MB5,BW] 1169-3-1173ms  | [S1,MB7,BI] 1175-22-1197ms | [S1,MB6,BW] 1197-3-1201ms  | [S1,MB7,BW] 1201-1-1203ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  277-12-289ms   | [S6,MB0,BI] 343-14-357ms   | [S6,MB2,F]  357-14-372ms   | [S6,MB1,BI] 412-15-427ms   | [S6,MB3,F]  427-14-442ms   | [S6,MB2,BI] 483-14-497ms   | [S6,MB0,BW] 497-2-500ms    | [S2,MB4,F]  505-13-518ms   | [S6,MB3,BI] 554-15-570ms   | [S6,MB1,BW] 570-2-572ms    | [S2,MB5,F]  579-13-593ms   | [S2,MB0,BI] 597-16-614ms   | [S6,MB2,BW] 614-1-616ms    | [S2,MB6,F]  627-13-641ms   | [S2,MB1,BI] 641-15-657ms   | [S6,MB3,BW] 657-1-659ms    | [S2,MB7,F]  679-13-692ms   | [S2,MB2,BI] 692-15-707ms   | [S2,MB0,BW] 707-1-709ms    | [S6,MB4,F]  724-13-737ms   | [S2,MB3,BI] 737-15-753ms   | [S2,MB1,BW] 753-1-755ms    | [S6,MB5,F]  768-13-782ms   | [S6,MB4,BI] 811-15-826ms   | [S2,MB2,BW] 826-2-829ms    | [S6,MB6,F]  834-13-847ms   | [S6,MB5,BI] 886-15-901ms   | [S2,MB3,BW] 901-2-904ms    | [S6,MB7,F]  909-13-922ms   | [S6,MB6,BI] 962-15-977ms   | [S6,MB4,BW] 977-2-980ms    | [S6,MB7,BI] 1039-14-1053ms | [S6,MB5,BW] 1053-2-1056ms  | [S2,MB4,BI] 1060-14-1075ms | [S6,MB6,BW] 1075-2-1078ms  | [S2,MB5,BI] 1096-14-1111ms | [S6,MB7,BW] 1111-2-1114ms  | [S2,MB6,BI] 1118-14-1133ms | [S2,MB4,BW] 1132-1-1134ms  | [S2,MB7,BI] 1146-14-1161ms | [S2,MB5,BW] 1161-1-1163ms  | [S2,MB6,BW] 1162-1-1163ms  | [S2,MB7,BW] 1163-1-1164ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  218-12-231ms   | [S7,MB0,F]  270-18-289ms   | [S7,MB0,BI] 301-35-336ms   | [S7,MB1,F]  336-21-357ms   | [S7,MB1,BI] 369-35-405ms   | [S7,MB2,F]  405-22-428ms   | [S7,MB2,BI] 440-35-476ms   | [S7,MB3,F]  476-22-499ms   | [S7,MB3,BI] 511-36-548ms   | [S7,MB0,BW] 548-1-549ms    | [S3,MB4,F]  555-14-570ms   | [S3,MB0,BI] 569-18-588ms   | [S7,MB1,BW] 588-2-590ms    | [S3,MB5,F]  600-13-614ms   | [S3,MB1,BI] 614-17-631ms   | [S7,MB2,BW] 631-1-632ms    | [S3,MB6,F]  643-13-656ms   | [S3,MB2,BI] 656-16-672ms   | [S7,MB3,BW] 672-0-673ms    | [S3,MB7,F]  693-13-706ms   | [S3,MB3,BI] 706-16-722ms   | [S3,MB0,BW] 723-1-725ms    | [S7,MB4,F]  738-18-757ms   | [S7,MB4,BI] 769-35-804ms   | [S3,MB1,BW] 804-2-807ms    | [S7,MB5,F]  812-19-832ms   | [S7,MB5,BI] 844-35-879ms   | [S3,MB2,BW] 879-2-882ms    | [S7,MB6,F]  887-19-907ms   | [S7,MB6,BI] 919-35-955ms   | [S3,MB3,BW] 955-2-958ms    | [S7,MB7,F]  963-21-985ms   | [S7,MB7,BI] 996-35-1032ms  | [S7,MB4,BW] 1032-1-1033ms  | [S3,MB4,BI] 1033-17-1050ms | [S7,MB5,BW] 1050-0-1051ms  | [S3,MB5,BI] 1051-17-1068ms | [S7,MB6,BW] 1068-0-1069ms  | [S3,MB6,BI] 1069-16-1085ms | [S7,MB7,BW] 1085-0-1086ms  | [S3,MB7,BI] 1089-16-1106ms | [S3,MB4,BW] 1106-1-1107ms  | [S3,MB5,BW] 1107-1-1108ms  | [S3,MB6,BW] 1109-1-1111ms  | [S3,MB7,BW] 1110-1-1112ms 
[rank0]:2026-01-01 16:46:31,827 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:46:36,711 - Avg. fwd time: 17.1262 / Avg. bwd-weight time: 1.5278 / Avg. bwd-input time: 26.4384 / Avg. batch time: 1069.3450 (ms) / GPU bubble ratio: 32.53%
[rank2]:2026-01-01 16:46:36,761 - Avg. fwd time: 13.3270 / Avg. bwd-weight time: 2.0726 / Avg. bwd-input time: 15.0701 / Avg. batch time: 1135.6350 (ms) / GPU bubble ratio: 57.07%
[rank1]:2026-01-01 16:46:36,796 - Avg. fwd time: 16.7314 / Avg. bwd-weight time: 2.9210 / Avg. bwd-input time: 18.9862 / Avg. batch time: 1193.4191 (ms) / GPU bubble ratio: 48.20%
[rank3]:2026-01-01 16:46:36,811 -  step: 350  loss: 11.1892  grad_norm:  7.0904  memory: 30.44GiB(64.07%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank2]:2026-01-01 16:46:36,811 -  step: 350  loss: -4.0000  grad_norm:  7.0904  memory: 14.23GiB(29.96%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank0]:2026-01-01 16:46:36,807 - Avg. fwd time: 13.6911 / Avg. full-bwd time: 14.5759 (Avg. bwd-weight time: 1.3411 / Avg. bwd-input time: 15.0198) / Avg. batch time: 1222.6596 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 16:46:36,811 -  step: 350  loss: -4.0000  grad_norm:  7.0904  memory: 13.98GiB(29.42%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank1]:2026-01-01 16:46:36,810 -  step: 350  loss: -4.0000  grad_norm:  7.0904  memory: 19.62GiB(41.30%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank0]:2026-01-01 16:50:40,669 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:50:45,627 - Avg. fwd time: 17.1364 / Avg. bwd-weight time: 1.5292 / Avg. bwd-input time: 26.4497 / Avg. batch time: 1069.6692 (ms) / GPU bubble ratio: 32.52%
[rank2]:2026-01-01 16:50:45,675 - Avg. fwd time: 13.3295 / Avg. bwd-weight time: 2.0729 / Avg. bwd-input time: 15.0717 / Avg. batch time: 1135.8801 (ms) / GPU bubble ratio: 57.07%
[rank2]:2026-01-01 16:50:45,725 -  step: 400  loss: -4.0000  grad_norm: 37.4344  memory: 14.23GiB(29.96%)  tps: 6,582  tflops: 51.46  mfu: 16.49%
[rank0]:2026-01-01 16:50:45,721 - Avg. fwd time: 13.6932 / Avg. full-bwd time: 14.5788 (Avg. bwd-weight time: 1.3405 / Avg. bwd-input time: 15.0216) / Avg. batch time: 1222.9416 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 16:50:45,725 -  step: 400  loss: -4.0000  grad_norm: 37.4344  memory: 13.98GiB(29.42%)  tps: 6,582  tflops: 51.46  mfu: 16.49%
[rank1]:2026-01-01 16:50:45,711 - Avg. fwd time: 16.7342 / Avg. bwd-weight time: 2.9207 / Avg. bwd-input time: 18.9916 / Avg. batch time: 1193.6933 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 16:50:45,725 -  step: 400  loss: -4.0000  grad_norm: 37.4344  memory: 19.62GiB(41.30%)  tps: 6,582  tflops: 51.46  mfu: 16.49%
[rank3]:2026-01-01 16:50:45,726 -  step: 400  loss: 10.2841  grad_norm: 37.4344  memory: 30.44GiB(64.07%)  tps: 6,582  tflops: 51.46  mfu: 16.49%
[rank3]:2026-01-01 16:50:46,062 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1650_step400_rank3.svg
[rank3]:			> Batch Time: 1221.76 ms, GPU Bubble Ratio: 61.78%, 49.32%, 60.05%, 40.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  130-14-144ms   | [S4,MB2,F]  187-14-202ms   | [S4,MB3,F]  246-14-260ms   | [S4,MB0,BI] 389-14-403ms   | [S4,MB0,BW] 403-1-404ms    | [S0,MB4,F]  405-12-417ms   | [S4,MB1,BI] 458-15-474ms   | [S4,MB1,BW] 474-1-475ms    | [S0,MB5,F]  475-12-488ms   | [S4,MB2,BI] 535-15-551ms   | [S4,MB2,BW] 551-1-552ms    | [S0,MB6,F]  552-13-565ms   | [S4,MB3,BI] 603-17-620ms   | [S4,MB3,BW] 621-1-622ms    | [S0,MB7,F]  622-16-638ms   | [S0,MB0,B]  658-16-674ms   | [S4,MB4,F]  674-12-687ms   | [S0,MB1,B]  710-15-725ms   | [S4,MB5,F]  726-12-738ms   | [S0,MB2,B]  755-14-770ms   | [S4,MB6,F]  770-13-783ms   | [S0,MB3,B]  800-14-814ms   | [S4,MB7,F]  815-13-828ms   | [S4,MB4,BI] 858-15-873ms   | [S4,MB4,BW] 873-1-874ms    | [S4,MB5,BI] 943-14-957ms   | [S4,MB5,BW] 957-1-958ms    | [S4,MB6,BI] 1007-14-1021ms | [S4,MB6,BW] 1021-1-1022ms  | [S4,MB7,BI] 1084-14-1098ms | [S4,MB7,BW] 1098-2-1100ms  | [S0,MB4,B]  1113-13-1126ms | [S0,MB5,B]  1150-13-1163ms | [S0,MB6,B]  1179-13-1192ms | [S0,MB7,B]  1208-13-1221ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-91ms     | [S1,MB2,F]  129-19-149ms   | [S1,MB3,F]  187-19-207ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  265-12-278ms   | [S5,MB2,F]  284-12-297ms   | [S5,MB0,BI] 366-14-381ms   | [S5,MB3,F]  381-15-396ms   | [S5,MB1,BI] 435-14-450ms   | [S5,MB0,BW] 450-3-453ms    | [S1,MB4,F]  460-19-480ms   | [S5,MB2,BI] 506-15-522ms   | [S5,MB1,BW] 522-1-523ms    | [S1,MB5,F]  536-19-556ms   | [S5,MB3,BI] 579-16-595ms   | [S5,MB2,BW] 596-3-599ms    | [S1,MB6,F]  606-20-627ms   | [S1,MB0,BI] 627-24-651ms   | [S5,MB3,BW] 651-2-654ms    | [S1,MB7,F]  659-20-680ms   | [S1,MB1,BI] 680-23-703ms   | [S1,MB0,BW] 703-3-706ms    | [S5,MB4,F]  711-14-725ms   | [S1,MB2,BI] 725-23-748ms   | [S1,MB1,BW] 748-3-752ms    | [S5,MB5,F]  756-13-770ms   | [S1,MB3,BI] 770-23-793ms   | [S1,MB2,BW] 793-3-796ms    | [S5,MB6,F]  801-13-814ms   | [S5,MB4,BI] 835-15-851ms   | [S1,MB3,BW] 851-3-855ms    | [S5,MB7,F]  859-13-872ms   | [S5,MB5,BI] 910-15-926ms   | [S5,MB4,BW] 925-1-926ms    | [S5,MB6,BI] 986-14-1000ms  | [S5,MB5,BW] 1000-2-1003ms  | [S5,MB7,BI] 1062-14-1077ms | [S5,MB6,BW] 1077-2-1080ms  | [S1,MB4,BI] 1084-21-1106ms | [S5,MB7,BW] 1106-2-1109ms  | [S1,MB5,BI] 1120-22-1142ms | [S1,MB4,BW] 1143-3-1147ms  | [S1,MB6,BI] 1149-22-1171ms | [S1,MB5,BW] 1172-3-1176ms  | [S1,MB7,BI] 1179-22-1201ms | [S1,MB6,BW] 1201-3-1205ms  | [S1,MB7,BW] 1204-1-1206ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  91-12-104ms    | [S2,MB2,F]  149-12-162ms   | [S2,MB3,F]  207-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  278-12-291ms   | [S6,MB0,BI] 344-14-359ms   | [S6,MB2,F]  359-14-374ms   | [S6,MB1,BI] 413-15-428ms   | [S6,MB3,F]  428-14-443ms   | [S6,MB2,BI] 485-14-500ms   | [S6,MB0,BW] 500-2-502ms    | [S2,MB4,F]  507-13-521ms   | [S6,MB3,BI] 556-15-571ms   | [S6,MB1,BW] 571-2-574ms    | [S2,MB5,F]  581-13-595ms   | [S2,MB0,BI] 600-16-616ms   | [S6,MB2,BW] 616-2-618ms    | [S2,MB6,F]  630-13-644ms   | [S2,MB1,BI] 643-15-659ms   | [S6,MB3,BW] 659-1-661ms    | [S2,MB7,F]  681-13-695ms   | [S2,MB2,BI] 694-15-710ms   | [S2,MB0,BW] 710-1-712ms    | [S6,MB4,F]  726-13-740ms   | [S2,MB3,BI] 739-15-755ms   | [S2,MB1,BW] 755-1-757ms    | [S6,MB5,F]  770-13-784ms   | [S6,MB4,BI] 813-15-828ms   | [S2,MB2,BW] 828-2-831ms    | [S6,MB6,F]  836-13-849ms   | [S6,MB5,BI] 888-15-903ms   | [S2,MB3,BW] 903-2-906ms    | [S6,MB7,F]  911-13-924ms   | [S6,MB6,BI] 963-15-979ms   | [S6,MB4,BW] 979-2-982ms    | [S6,MB7,BI] 1041-14-1055ms | [S6,MB5,BW] 1055-2-1058ms  | [S2,MB4,BI] 1062-14-1077ms | [S6,MB6,BW] 1077-2-1080ms  | [S2,MB5,BI] 1099-14-1114ms | [S6,MB7,BW] 1113-2-1116ms  | [S2,MB6,BI] 1120-14-1135ms | [S2,MB4,BW] 1134-1-1136ms  | [S2,MB7,BI] 1149-14-1164ms | [S2,MB5,BW] 1163-1-1165ms  | [S2,MB6,BW] 1165-1-1167ms  | [S2,MB7,BW] 1166-1-1168ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  104-12-116ms   | [S3,MB2,F]  162-12-174ms   | [S3,MB3,F]  220-12-233ms   | [S7,MB0,F]  271-18-290ms   | [S7,MB0,BI] 302-35-337ms   | [S7,MB1,F]  338-21-359ms   | [S7,MB1,BI] 370-36-406ms   | [S7,MB2,F]  406-23-430ms   | [S7,MB2,BI] 443-36-479ms   | [S7,MB3,F]  478-23-502ms   | [S7,MB3,BI] 513-36-550ms   | [S7,MB0,BW] 550-1-551ms    | [S3,MB4,F]  557-14-572ms   | [S3,MB0,BI] 573-18-591ms   | [S7,MB1,BW] 591-2-593ms    | [S3,MB5,F]  602-13-616ms   | [S3,MB1,BI] 616-17-634ms   | [S7,MB2,BW] 633-1-635ms    | [S3,MB6,F]  644-13-658ms   | [S3,MB2,BI] 658-16-674ms   | [S7,MB3,BW] 674-0-675ms    | [S3,MB7,F]  695-13-709ms   | [S3,MB3,BI] 709-16-725ms   | [S3,MB0,BW] 725-1-727ms    | [S7,MB4,F]  741-18-760ms   | [S7,MB4,BI] 771-35-807ms   | [S3,MB1,BW] 806-2-809ms    | [S7,MB5,F]  814-19-834ms   | [S7,MB5,BI] 846-35-881ms   | [S3,MB2,BW] 881-2-884ms    | [S7,MB6,F]  889-20-909ms   | [S7,MB6,BI] 921-35-957ms   | [S3,MB3,BW] 957-2-959ms    | [S7,MB7,F]  965-22-987ms   | [S7,MB7,BI] 997-36-1033ms  | [S7,MB4,BW] 1034-1-1035ms  | [S3,MB4,BI] 1035-17-1053ms | [S7,MB5,BW] 1053-0-1054ms  | [S3,MB5,BI] 1054-17-1071ms | [S7,MB6,BW] 1071-0-1072ms  | [S3,MB6,BI] 1072-16-1089ms | [S7,MB7,BW] 1088-1-1089ms  | [S3,MB7,BI] 1091-17-1108ms | [S3,MB4,BW] 1108-1-1110ms  | [S3,MB5,BW] 1110-1-1112ms  | [S3,MB6,BW] 1111-1-1113ms  | [S3,MB7,BW] 1112-1-1114ms 
[rank3]:2026-01-01 16:51:14,394 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 16:51:14,489 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 16:51:14,529 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 16:51:14,517 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 16:54:49,190 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:54:54,017 - Avg. fwd time: 17.1334 / Avg. bwd-weight time: 1.5291 / Avg. bwd-input time: 26.4457 / Avg. batch time: 1069.5921 (ms) / GPU bubble ratio: 32.52%
[rank0]:2026-01-01 16:54:54,113 - Avg. fwd time: 13.6933 / Avg. full-bwd time: 14.5789 (Avg. bwd-weight time: 1.3406 / Avg. bwd-input time: 15.0207) / Avg. batch time: 1222.9725 (ms) / GPU bubble ratio: 61.85%
[rank0]:2026-01-01 16:54:54,116 -  step: 450  loss: -4.0000  grad_norm:  6.7925  memory: 13.98GiB(29.42%)  tps: 6,596  tflops: 51.57  mfu: 16.53%
[rank2]:2026-01-01 16:54:54,067 - Avg. fwd time: 13.3290 / Avg. bwd-weight time: 2.0727 / Avg. bwd-input time: 15.0714 / Avg. batch time: 1135.9069 (ms) / GPU bubble ratio: 57.08%
[rank2]:2026-01-01 16:54:54,116 -  step: 450  loss: -4.0000  grad_norm:  6.7925  memory: 14.23GiB(29.96%)  tps: 6,596  tflops: 51.56  mfu: 16.53%
[rank3]:2026-01-01 16:54:54,116 -  step: 450  loss: 12.7481  grad_norm:  6.7925  memory: 30.44GiB(64.07%)  tps: 6,596  tflops: 51.57  mfu: 16.53%
[rank1]:2026-01-01 16:54:54,103 - Avg. fwd time: 16.7327 / Avg. bwd-weight time: 2.9211 / Avg. bwd-input time: 18.9913 / Avg. batch time: 1193.7244 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 16:54:54,116 -  step: 450  loss: -4.0000  grad_norm:  6.7925  memory: 19.62GiB(41.30%)  tps: 6,596  tflops: 51.56  mfu: 16.53%
[rank0]:2026-01-01 16:58:57,489 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 16:59:02,342 - Avg. fwd time: 17.1318 / Avg. bwd-weight time: 1.5293 / Avg. bwd-input time: 26.4448 / Avg. batch time: 1069.5500 (ms) / GPU bubble ratio: 32.52%
[rank2]:2026-01-01 16:59:02,393 - Avg. fwd time: 13.3291 / Avg. bwd-weight time: 2.0730 / Avg. bwd-input time: 15.0715 / Avg. batch time: 1135.8064 (ms) / GPU bubble ratio: 57.07%
[rank3]:2026-01-01 16:59:02,442 -  step: 500  loss: 12.9581  grad_norm:  7.6146  memory: 30.44GiB(64.07%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank1]:2026-01-01 16:59:02,427 - Avg. fwd time: 16.7317 / Avg. bwd-weight time: 2.9213 / Avg. bwd-input time: 18.9917 / Avg. batch time: 1193.6245 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 16:59:02,441 -  step: 500  loss: -4.0000  grad_norm:  7.6146  memory: 19.62GiB(41.30%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank0]:2026-01-01 16:59:02,437 - Avg. fwd time: 13.6936 / Avg. full-bwd time: 14.5797 (Avg. bwd-weight time: 1.3405 / Avg. bwd-input time: 15.0206) / Avg. batch time: 1222.8758 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 16:59:02,441 -  step: 500  loss: -4.0000  grad_norm:  7.6146  memory: 13.98GiB(29.42%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank2]:2026-01-01 16:59:02,441 -  step: 500  loss: -4.0000  grad_norm:  7.6146  memory: 14.23GiB(29.96%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank3]:2026-01-01 16:59:02,777 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1659_step500_rank3.svg
[rank3]:			> Batch Time: 1219.72 ms, GPU Bubble Ratio: 61.78%, 49.37%, 60.08%, 40.93%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S4,MB0,BI] 388-14-402ms   | [S4,MB0,BW] 402-1-403ms    | [S0,MB4,F]  403-12-416ms   | [S4,MB1,BI] 457-15-472ms   | [S4,MB1,BW] 473-1-474ms    | [S0,MB5,F]  474-12-487ms   | [S4,MB2,BI] 534-15-549ms   | [S4,MB2,BW] 549-1-550ms    | [S0,MB6,F]  550-13-563ms   | [S4,MB3,BI] 603-17-620ms   | [S4,MB3,BW] 620-1-621ms    | [S0,MB7,F]  621-15-636ms   | [S0,MB0,B]  657-16-673ms   | [S4,MB4,F]  674-12-686ms   | [S0,MB1,B]  709-15-725ms   | [S4,MB5,F]  725-12-738ms   | [S0,MB2,B]  755-14-769ms   | [S4,MB6,F]  769-12-782ms   | [S0,MB3,B]  799-14-814ms   | [S4,MB7,F]  814-13-827ms   | [S4,MB4,BI] 857-15-872ms   | [S4,MB4,BW] 872-1-873ms    | [S4,MB5,BI] 942-14-956ms   | [S4,MB5,BW] 956-1-957ms    | [S4,MB6,BI] 1005-14-1019ms | [S4,MB6,BW] 1019-1-1020ms  | [S4,MB7,BI] 1083-14-1097ms | [S4,MB7,BW] 1097-2-1099ms  | [S0,MB4,B]  1112-13-1125ms | [S0,MB5,B]  1148-13-1161ms | [S0,MB6,B]  1178-13-1191ms | [S0,MB7,B]  1206-13-1219ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 364-14-379ms   | [S5,MB3,F]  379-15-395ms   | [S5,MB1,BI] 434-14-449ms   | [S5,MB0,BW] 448-3-452ms    | [S1,MB4,F]  458-19-478ms   | [S5,MB2,BI] 504-15-519ms   | [S5,MB1,BW] 519-1-521ms    | [S1,MB5,F]  534-19-554ms   | [S5,MB3,BI] 577-16-594ms   | [S5,MB2,BW] 594-3-597ms    | [S1,MB6,F]  606-20-626ms   | [S1,MB0,BI] 626-24-651ms   | [S5,MB3,BW] 650-2-653ms    | [S1,MB7,F]  658-20-679ms   | [S1,MB1,BI] 679-23-702ms   | [S1,MB0,BW] 702-3-706ms    | [S5,MB4,F]  710-14-724ms   | [S1,MB2,BI] 724-23-747ms   | [S1,MB1,BW] 748-3-751ms    | [S5,MB5,F]  755-13-769ms   | [S1,MB3,BI] 769-23-792ms   | [S1,MB2,BW] 792-3-795ms    | [S5,MB6,F]  800-13-813ms   | [S5,MB4,BI] 834-15-850ms   | [S1,MB3,BW] 850-3-854ms    | [S5,MB7,F]  858-13-871ms   | [S5,MB5,BI] 909-15-924ms   | [S5,MB4,BW] 924-1-925ms    | [S5,MB6,BI] 984-14-998ms   | [S5,MB5,BW] 998-2-1001ms   | [S5,MB7,BI] 1061-14-1076ms | [S5,MB6,BW] 1075-2-1078ms  | [S1,MB4,BI] 1082-21-1104ms | [S5,MB7,BW] 1104-2-1107ms  | [S1,MB5,BI] 1119-22-1141ms | [S1,MB4,BW] 1141-3-1145ms  | [S1,MB6,BI] 1148-22-1170ms | [S1,MB5,BW] 1170-3-1174ms  | [S1,MB7,BI] 1177-22-1199ms | [S1,MB6,BW] 1199-3-1203ms  | [S1,MB7,BW] 1202-1-1204ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB0,BI] 343-14-358ms   | [S6,MB2,F]  357-14-372ms   | [S6,MB1,BI] 412-15-427ms   | [S6,MB3,F]  427-14-442ms   | [S6,MB2,BI] 483-14-497ms   | [S6,MB0,BW] 497-2-500ms    | [S2,MB4,F]  505-13-518ms   | [S6,MB3,BI] 554-15-570ms   | [S6,MB1,BW] 570-2-573ms    | [S2,MB5,F]  580-13-593ms   | [S2,MB0,BI] 598-16-614ms   | [S6,MB2,BW] 614-2-616ms    | [S2,MB6,F]  629-13-643ms   | [S2,MB1,BI] 643-15-658ms   | [S6,MB3,BW] 658-1-660ms    | [S2,MB7,F]  680-13-693ms   | [S2,MB2,BI] 693-15-709ms   | [S2,MB0,BW] 709-1-711ms    | [S6,MB4,F]  725-13-738ms   | [S2,MB3,BI] 739-15-754ms   | [S2,MB1,BW] 754-1-756ms    | [S6,MB5,F]  770-13-783ms   | [S6,MB4,BI] 812-15-827ms   | [S2,MB2,BW] 827-2-830ms    | [S6,MB6,F]  835-13-848ms   | [S6,MB5,BI] 886-15-902ms   | [S2,MB3,BW] 902-2-905ms    | [S6,MB7,F]  909-13-923ms   | [S6,MB6,BI] 962-15-977ms   | [S6,MB4,BW] 977-2-980ms    | [S6,MB7,BI] 1040-14-1054ms | [S6,MB5,BW] 1054-2-1057ms  | [S2,MB4,BI] 1061-14-1076ms | [S6,MB6,BW] 1075-2-1078ms  | [S2,MB5,BI] 1097-14-1112ms | [S6,MB7,BW] 1112-2-1115ms  | [S2,MB6,BI] 1118-14-1133ms | [S2,MB4,BW] 1133-1-1135ms  | [S2,MB7,BI] 1147-14-1162ms | [S2,MB5,BW] 1162-1-1164ms  | [S2,MB6,BW] 1163-1-1164ms  | [S2,MB7,BW] 1164-1-1165ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-289ms   | [S7,MB0,BI] 301-35-336ms   | [S7,MB1,F]  336-21-358ms   | [S7,MB1,BI] 370-35-406ms   | [S7,MB2,F]  406-22-428ms   | [S7,MB2,BI] 440-36-476ms   | [S7,MB3,F]  476-23-500ms   | [S7,MB3,BI] 512-36-548ms   | [S7,MB0,BW] 548-1-549ms    | [S3,MB4,F]  556-14-570ms   | [S3,MB0,BI] 570-18-588ms   | [S7,MB1,BW] 588-2-591ms    | [S3,MB5,F]  600-13-614ms   | [S3,MB1,BI] 614-17-632ms   | [S7,MB2,BW] 632-1-633ms    | [S3,MB6,F]  644-13-657ms   | [S3,MB2,BI] 657-16-674ms   | [S7,MB3,BW] 674-0-675ms    | [S3,MB7,F]  695-13-708ms   | [S3,MB3,BI] 708-16-724ms   | [S3,MB0,BW] 724-1-726ms    | [S7,MB4,F]  740-18-759ms   | [S7,MB4,BI] 770-35-806ms   | [S3,MB1,BW] 805-2-808ms    | [S7,MB5,F]  813-19-833ms   | [S7,MB5,BI] 844-35-880ms   | [S3,MB2,BW] 880-2-882ms    | [S7,MB6,F]  888-20-908ms   | [S7,MB6,BI] 919-35-955ms   | [S3,MB3,BW] 955-2-958ms    | [S7,MB7,F]  963-21-985ms   | [S7,MB7,BI] 997-35-1033ms  | [S7,MB4,BW] 1033-1-1034ms  | [S3,MB4,BI] 1034-17-1051ms | [S7,MB5,BW] 1051-0-1052ms  | [S3,MB5,BI] 1052-17-1070ms | [S7,MB6,BW] 1070-0-1071ms  | [S3,MB6,BI] 1070-16-1086ms | [S7,MB7,BW] 1087-0-1088ms  | [S3,MB7,BI] 1090-16-1107ms | [S3,MB4,BW] 1107-1-1109ms  | [S3,MB5,BW] 1108-1-1110ms  | [S3,MB6,BW] 1109-1-1111ms  | [S3,MB7,BW] 1111-1-1113ms 
[rank0]:2026-01-01 17:03:06,555 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 17:03:11,480 - Avg. fwd time: 13.3300 / Avg. bwd-weight time: 2.0732 / Avg. bwd-input time: 15.0725 / Avg. batch time: 1136.0549 (ms) / GPU bubble ratio: 57.08%
[rank3]:2026-01-01 17:03:11,432 - Avg. fwd time: 17.1369 / Avg. bwd-weight time: 1.5298 / Avg. bwd-input time: 26.4506 / Avg. batch time: 1069.7244 (ms) / GPU bubble ratio: 32.52%
[rank3]:2026-01-01 17:03:11,530 -  step: 550  loss: 11.0990  grad_norm:  6.5297  memory: 30.44GiB(64.07%)  tps: 6,578  tflops: 51.42  mfu: 16.48%
[rank1]:2026-01-01 17:03:11,516 - Avg. fwd time: 16.7332 / Avg. bwd-weight time: 2.9215 / Avg. bwd-input time: 18.9942 / Avg. batch time: 1193.8862 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 17:03:11,529 -  step: 550  loss: -4.0000  grad_norm:  6.5297  memory: 19.62GiB(41.30%)  tps: 6,578  tflops: 51.42  mfu: 16.48%
[rank2]:2026-01-01 17:03:11,529 -  step: 550  loss: -4.0000  grad_norm:  6.5297  memory: 14.23GiB(29.96%)  tps: 6,578  tflops: 51.42  mfu: 16.48%
[rank0]:2026-01-01 17:03:11,526 - Avg. fwd time: 13.6942 / Avg. full-bwd time: 14.5810 (Avg. bwd-weight time: 1.3403 / Avg. bwd-input time: 15.0211) / Avg. batch time: 1223.1382 (ms) / GPU bubble ratio: 61.85%
[rank0]:2026-01-01 17:03:11,530 -  step: 550  loss: -4.0000  grad_norm:  6.5297  memory: 13.98GiB(29.42%)  tps: 6,578  tflops: 51.42  mfu: 16.48%
[rank0]:2026-01-01 17:07:14,949 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 17:07:19,909 - Avg. fwd time: 17.1388 / Avg. bwd-weight time: 1.5295 / Avg. bwd-input time: 26.4497 / Avg. batch time: 1069.7374 (ms) / GPU bubble ratio: 32.52%
[rank2]:2026-01-01 17:07:19,958 - Avg. fwd time: 13.3304 / Avg. bwd-weight time: 2.0734 / Avg. bwd-input time: 15.0730 / Avg. batch time: 1136.0228 (ms) / GPU bubble ratio: 57.08%
[rank2]:2026-01-01 17:07:20,008 -  step: 600  loss: -4.0000  grad_norm: 34.2522  memory: 14.23GiB(29.96%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank1]:2026-01-01 17:07:19,994 - Avg. fwd time: 16.7335 / Avg. bwd-weight time: 2.9213 / Avg. bwd-input time: 18.9942 / Avg. batch time: 1193.8563 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 17:07:20,008 -  step: 600  loss: -4.0000  grad_norm: 34.2522  memory: 19.62GiB(41.30%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank0]:2026-01-01 17:07:20,004 - Avg. fwd time: 13.6941 / Avg. full-bwd time: 14.5812 (Avg. bwd-weight time: 1.3404 / Avg. bwd-input time: 15.0210) / Avg. batch time: 1223.1093 (ms) / GPU bubble ratio: 61.85%
[rank0]:2026-01-01 17:07:20,008 -  step: 600  loss: -4.0000  grad_norm: 34.2522  memory: 13.98GiB(29.42%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank3]:2026-01-01 17:07:20,008 -  step: 600  loss: 10.0152  grad_norm: 34.2522  memory: 30.44GiB(64.07%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank3]:2026-01-01 17:07:20,348 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1707_step600_rank3.svg
[rank3]:			> Batch Time: 1221.73 ms, GPU Bubble Ratio: 61.82%, 49.37%, 60.08%, 40.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-12-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-202ms   | [S4,MB3,F]  245-14-260ms   | [S4,MB0,BI] 388-14-402ms   | [S4,MB0,BW] 403-1-404ms    | [S0,MB4,F]  404-12-416ms   | [S4,MB1,BI] 458-15-474ms   | [S4,MB1,BW] 474-1-475ms    | [S0,MB5,F]  475-12-488ms   | [S4,MB2,BI] 535-15-551ms   | [S4,MB2,BW] 551-1-552ms    | [S0,MB6,F]  552-13-565ms   | [S4,MB3,BI] 604-17-621ms   | [S4,MB3,BW] 621-1-622ms    | [S0,MB7,F]  622-15-637ms   | [S0,MB0,B]  659-16-675ms   | [S4,MB4,F]  675-12-687ms   | [S0,MB1,B]  710-15-726ms   | [S4,MB5,F]  726-12-739ms   | [S0,MB2,B]  756-14-770ms   | [S4,MB6,F]  771-13-784ms   | [S0,MB3,B]  801-14-815ms   | [S4,MB7,F]  815-13-828ms   | [S4,MB4,BI] 859-15-874ms   | [S4,MB4,BW] 874-1-875ms    | [S4,MB5,BI] 943-14-957ms   | [S4,MB5,BW] 958-1-959ms    | [S4,MB6,BI] 1007-14-1021ms | [S4,MB6,BW] 1022-1-1023ms  | [S4,MB7,BI] 1085-14-1099ms | [S4,MB7,BW] 1099-2-1101ms  | [S0,MB4,B]  1114-13-1127ms | [S0,MB5,B]  1150-13-1163ms | [S0,MB6,B]  1179-13-1192ms | [S0,MB7,B]  1208-13-1221ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-91ms     | [S1,MB2,F]  129-19-149ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  284-12-297ms   | [S5,MB0,BI] 365-14-380ms   | [S5,MB3,F]  380-15-395ms   | [S5,MB1,BI] 435-14-450ms   | [S5,MB0,BW] 450-3-453ms    | [S1,MB4,F]  459-19-479ms   | [S5,MB2,BI] 505-15-521ms   | [S5,MB1,BW] 521-1-522ms    | [S1,MB5,F]  536-19-555ms   | [S5,MB3,BI] 578-16-595ms   | [S5,MB2,BW] 595-3-598ms    | [S1,MB6,F]  606-20-627ms   | [S1,MB0,BI] 627-24-651ms   | [S5,MB3,BW] 651-2-654ms    | [S1,MB7,F]  659-20-680ms   | [S1,MB1,BI] 680-23-703ms   | [S1,MB0,BW] 703-3-707ms    | [S5,MB4,F]  711-14-725ms   | [S1,MB2,BI] 725-23-748ms   | [S1,MB1,BW] 749-3-752ms    | [S5,MB5,F]  756-13-770ms   | [S1,MB3,BI] 770-23-793ms   | [S1,MB2,BW] 793-3-797ms    | [S5,MB6,F]  801-13-815ms   | [S5,MB4,BI] 836-15-852ms   | [S1,MB3,BW] 852-3-856ms    | [S5,MB7,F]  860-13-873ms   | [S5,MB5,BI] 911-15-926ms   | [S5,MB4,BW] 926-1-927ms    | [S5,MB6,BI] 986-14-1000ms  | [S5,MB5,BW] 1000-2-1003ms  | [S5,MB7,BI] 1063-14-1078ms | [S5,MB6,BW] 1077-2-1080ms  | [S1,MB4,BI] 1084-21-1106ms | [S5,MB7,BW] 1106-2-1109ms  | [S1,MB5,BI] 1121-21-1143ms | [S1,MB4,BW] 1143-3-1147ms  | [S1,MB6,BI] 1150-22-1172ms | [S1,MB5,BW] 1172-3-1176ms  | [S1,MB7,BI] 1179-22-1201ms | [S1,MB6,BW] 1201-3-1205ms  | [S1,MB7,BW] 1204-1-1206ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  91-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB0,BI] 343-14-358ms   | [S6,MB2,F]  358-14-373ms   | [S6,MB1,BI] 413-15-429ms   | [S6,MB3,F]  428-14-443ms   | [S6,MB2,BI] 484-14-499ms   | [S6,MB0,BW] 499-2-501ms    | [S2,MB4,F]  506-13-519ms   | [S6,MB3,BI] 556-15-571ms   | [S6,MB1,BW] 571-2-574ms    | [S2,MB5,F]  581-13-595ms   | [S2,MB0,BI] 599-16-616ms   | [S6,MB2,BW] 616-2-618ms    | [S2,MB6,F]  630-13-644ms   | [S2,MB1,BI] 644-15-660ms   | [S6,MB3,BW] 659-1-661ms    | [S2,MB7,F]  681-13-694ms   | [S2,MB2,BI] 695-15-711ms   | [S2,MB0,BW] 710-1-712ms    | [S6,MB4,F]  726-13-740ms   | [S2,MB3,BI] 740-15-755ms   | [S2,MB1,BW] 755-1-757ms    | [S6,MB5,F]  771-13-784ms   | [S6,MB4,BI] 814-15-829ms   | [S2,MB2,BW] 829-2-832ms    | [S6,MB6,F]  837-13-850ms   | [S6,MB5,BI] 888-15-904ms   | [S2,MB3,BW] 904-2-907ms    | [S6,MB7,F]  911-13-925ms   | [S6,MB6,BI] 964-15-979ms   | [S6,MB4,BW] 979-2-982ms    | [S6,MB7,BI] 1042-14-1056ms | [S6,MB5,BW] 1056-2-1059ms  | [S2,MB4,BI] 1063-14-1078ms | [S6,MB6,BW] 1077-2-1080ms  | [S2,MB5,BI] 1099-14-1114ms | [S6,MB7,BW] 1114-2-1117ms  | [S2,MB6,BI] 1120-14-1135ms | [S2,MB4,BW] 1135-1-1137ms  | [S2,MB7,BI] 1149-14-1164ms | [S2,MB5,BW] 1164-1-1166ms  | [S2,MB6,BW] 1165-1-1167ms  | [S2,MB7,BW] 1166-1-1168ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-290ms   | [S7,MB0,BI] 302-35-337ms   | [S7,MB1,F]  337-21-359ms   | [S7,MB1,BI] 371-36-407ms   | [S7,MB2,F]  407-22-430ms   | [S7,MB2,BI] 441-36-477ms   | [S7,MB3,F]  477-23-501ms   | [S7,MB3,BI] 513-36-550ms   | [S7,MB0,BW] 550-1-551ms    | [S3,MB4,F]  557-14-572ms   | [S3,MB0,BI] 572-18-590ms   | [S7,MB1,BW] 590-2-592ms    | [S3,MB5,F]  602-13-615ms   | [S3,MB1,BI] 615-17-633ms   | [S7,MB2,BW] 633-1-635ms    | [S3,MB6,F]  645-13-658ms   | [S3,MB2,BI] 658-16-675ms   | [S7,MB3,BW] 675-0-676ms    | [S3,MB7,F]  696-13-709ms   | [S3,MB3,BI] 709-16-726ms   | [S3,MB0,BW] 725-1-727ms    | [S7,MB4,F]  741-18-760ms   | [S7,MB4,BI] 772-35-807ms   | [S3,MB1,BW] 807-2-810ms    | [S7,MB5,F]  815-19-835ms   | [S7,MB5,BI] 846-35-882ms   | [S3,MB2,BW] 882-2-884ms    | [S7,MB6,F]  889-20-910ms   | [S7,MB6,BI] 921-35-957ms   | [S3,MB3,BW] 957-2-960ms    | [S7,MB7,F]  965-21-987ms   | [S7,MB7,BI] 999-35-1035ms  | [S7,MB4,BW] 1035-1-1036ms  | [S3,MB4,BI] 1036-17-1053ms | [S7,MB5,BW] 1053-0-1054ms  | [S3,MB5,BI] 1054-17-1072ms | [S7,MB6,BW] 1071-0-1072ms  | [S3,MB6,BI] 1072-16-1089ms | [S7,MB7,BW] 1088-0-1089ms  | [S3,MB7,BI] 1092-16-1109ms | [S3,MB4,BW] 1109-1-1111ms  | [S3,MB5,BW] 1110-1-1112ms  | [S3,MB6,BW] 1112-1-1114ms  | [S3,MB7,BW] 1113-1-1115ms 
[rank0]:2026-01-01 17:11:23,568 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-01 17:11:28,460 - Avg. fwd time: 13.3300 / Avg. bwd-weight time: 2.0734 / Avg. bwd-input time: 15.0730 / Avg. batch time: 1135.9889 (ms) / GPU bubble ratio: 57.08%
[rank3]:2026-01-01 17:11:28,411 - Avg. fwd time: 17.1352 / Avg. bwd-weight time: 1.5290 / Avg. bwd-input time: 26.4453 / Avg. batch time: 1069.6307 (ms) / GPU bubble ratio: 32.52%
[rank2]:2026-01-01 17:11:28,508 -  step: 650  loss: -4.0000  grad_norm:  8.5067  memory: 14.23GiB(29.96%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank1]:2026-01-01 17:11:28,495 - Avg. fwd time: 16.7329 / Avg. bwd-weight time: 2.9218 / Avg. bwd-input time: 18.9931 / Avg. batch time: 1193.8174 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 17:11:28,508 -  step: 650  loss: -4.0000  grad_norm:  8.5067  memory: 19.62GiB(41.30%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank0]:2026-01-01 17:11:28,505 - Avg. fwd time: 13.6937 / Avg. full-bwd time: 14.5812 (Avg. bwd-weight time: 1.3404 / Avg. bwd-input time: 15.0205) / Avg. batch time: 1223.0702 (ms) / GPU bubble ratio: 61.85%
[rank0]:2026-01-01 17:11:28,509 -  step: 650  loss: -4.0000  grad_norm:  8.5067  memory: 13.98GiB(29.42%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank3]:2026-01-01 17:11:28,509 -  step: 650  loss: 12.3055  grad_norm:  8.5067  memory: 30.44GiB(64.07%)  tps: 6,593  tflops: 51.54  mfu: 16.52%
[rank0]:2026-01-01 17:15:31,613 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 17:15:36,446 - Avg. fwd time: 17.1307 / Avg. bwd-weight time: 1.5287 / Avg. bwd-input time: 26.4408 / Avg. batch time: 1069.5038 (ms) / GPU bubble ratio: 32.53%
[rank2]:2026-01-01 17:15:36,499 - Avg. fwd time: 13.3293 / Avg. bwd-weight time: 2.0736 / Avg. bwd-input time: 15.0726 / Avg. batch time: 1135.8165 (ms) / GPU bubble ratio: 57.07%
[rank2]:2026-01-01 17:15:36,545 -  step: 700  loss: -4.0000  grad_norm:  7.6017  memory: 14.23GiB(29.96%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank0]:2026-01-01 17:15:36,542 - Avg. fwd time: 13.6932 / Avg. full-bwd time: 14.5805 (Avg. bwd-weight time: 1.3405 / Avg. bwd-input time: 15.0197) / Avg. batch time: 1222.8884 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 17:15:36,546 -  step: 700  loss: -4.0000  grad_norm:  7.6017  memory: 13.98GiB(29.42%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank1]:2026-01-01 17:15:36,532 - Avg. fwd time: 16.7318 / Avg. bwd-weight time: 2.9222 / Avg. bwd-input time: 18.9910 / Avg. batch time: 1193.6359 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 17:15:36,545 -  step: 700  loss: -4.0000  grad_norm:  7.6017  memory: 19.62GiB(41.30%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank3]:2026-01-01 17:15:36,546 -  step: 700  loss: 13.1112  grad_norm:  7.6017  memory: 30.44GiB(64.07%)  tps: 6,606  tflops: 51.64  mfu: 16.55%
[rank3]:2026-01-01 17:15:36,882 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1715_step700_rank3.svg
[rank3]:			> Batch Time: 1215.70 ms, GPU Bubble Ratio: 61.69%, 49.30%, 59.98%, 41.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-12-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-143ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-259ms   | [S4,MB0,BI] 387-14-401ms   | [S4,MB0,BW] 401-1-402ms    | [S0,MB4,F]  402-12-415ms   | [S4,MB1,BI] 456-15-471ms   | [S4,MB1,BW] 471-1-472ms    | [S0,MB5,F]  473-12-485ms   | [S4,MB2,BI] 532-15-547ms   | [S4,MB2,BW] 547-1-548ms    | [S0,MB6,F]  548-13-561ms   | [S4,MB3,BI] 601-17-618ms   | [S4,MB3,BW] 618-1-619ms    | [S0,MB7,F]  619-16-635ms   | [S0,MB0,B]  655-16-671ms   | [S4,MB4,F]  671-12-683ms   | [S0,MB1,B]  707-15-722ms   | [S4,MB5,F]  722-12-735ms   | [S0,MB2,B]  751-14-766ms   | [S4,MB6,F]  766-12-779ms   | [S0,MB3,B]  796-14-810ms   | [S4,MB7,F]  811-12-823ms   | [S4,MB4,BI] 855-15-870ms   | [S4,MB4,BW] 870-1-871ms    | [S4,MB5,BI] 939-14-953ms   | [S4,MB5,BW] 953-1-954ms    | [S4,MB6,BI] 1003-14-1017ms | [S4,MB6,BW] 1017-1-1018ms  | [S4,MB7,BI] 1079-14-1093ms | [S4,MB7,BW] 1093-2-1095ms  | [S0,MB4,B]  1108-13-1121ms | [S0,MB5,B]  1144-13-1157ms | [S0,MB6,B]  1173-13-1186ms | [S0,MB7,B]  1202-13-1215ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-90ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  244-12-257ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 364-14-379ms   | [S5,MB3,F]  379-15-394ms   | [S5,MB1,BI] 433-14-447ms   | [S5,MB0,BW] 447-3-451ms    | [S1,MB4,F]  457-19-477ms   | [S5,MB2,BI] 503-15-518ms   | [S5,MB1,BW] 518-1-520ms    | [S1,MB5,F]  533-19-552ms   | [S5,MB3,BI] 575-16-592ms   | [S5,MB2,BW] 592-3-595ms    | [S1,MB6,F]  604-20-624ms   | [S1,MB0,BI] 624-24-648ms   | [S5,MB3,BW] 648-2-651ms    | [S1,MB7,F]  656-20-676ms   | [S1,MB1,BI] 677-23-700ms   | [S1,MB0,BW] 700-3-703ms    | [S5,MB4,F]  707-14-721ms   | [S1,MB2,BI] 721-23-744ms   | [S1,MB1,BW] 744-3-748ms    | [S5,MB5,F]  752-13-766ms   | [S1,MB3,BI] 766-23-789ms   | [S1,MB2,BW] 789-3-792ms    | [S5,MB6,F]  797-13-810ms   | [S5,MB4,BI] 832-15-848ms   | [S1,MB3,BW] 848-3-851ms    | [S5,MB7,F]  856-13-869ms   | [S5,MB5,BI] 906-15-921ms   | [S5,MB4,BW] 922-1-923ms    | [S5,MB6,BI] 981-14-996ms   | [S5,MB5,BW] 996-2-998ms    | [S5,MB7,BI] 1057-14-1072ms | [S5,MB6,BW] 1072-2-1075ms  | [S1,MB4,BI] 1079-21-1101ms | [S5,MB7,BW] 1100-2-1103ms  | [S1,MB5,BI] 1115-21-1137ms | [S1,MB4,BW] 1137-3-1141ms  | [S1,MB6,BI] 1144-22-1166ms | [S1,MB5,BW] 1166-3-1170ms  | [S1,MB7,BI] 1172-22-1194ms | [S1,MB6,BW] 1194-3-1198ms  | [S1,MB7,BW] 1198-1-1199ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  90-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  257-12-270ms   | [S6,MB1,F]  277-12-289ms   | [S6,MB0,BI] 342-14-357ms   | [S6,MB2,F]  357-14-372ms   | [S6,MB1,BI] 411-15-426ms   | [S6,MB3,F]  426-14-441ms   | [S6,MB2,BI] 482-14-496ms   | [S6,MB0,BW] 496-2-499ms    | [S2,MB4,F]  504-13-517ms   | [S6,MB3,BI] 552-15-568ms   | [S6,MB1,BW] 568-2-570ms    | [S2,MB5,F]  578-13-591ms   | [S2,MB0,BI] 595-16-612ms   | [S6,MB2,BW] 612-2-614ms    | [S2,MB6,F]  627-13-641ms   | [S2,MB1,BI] 640-15-656ms   | [S6,MB3,BW] 656-1-658ms    | [S2,MB7,F]  677-13-691ms   | [S2,MB2,BI] 691-15-706ms   | [S2,MB0,BW] 706-1-708ms    | [S6,MB4,F]  722-13-736ms   | [S2,MB3,BI] 736-15-751ms   | [S2,MB1,BW] 751-1-753ms    | [S6,MB5,F]  767-13-780ms   | [S6,MB4,BI] 810-15-825ms   | [S2,MB2,BW] 825-2-828ms    | [S6,MB6,F]  833-13-846ms   | [S6,MB5,BI] 884-15-899ms   | [S2,MB3,BW] 899-2-902ms    | [S6,MB7,F]  907-13-920ms   | [S6,MB6,BI] 959-15-975ms   | [S6,MB4,BW] 974-2-977ms    | [S6,MB7,BI] 1036-14-1051ms | [S6,MB5,BW] 1051-2-1054ms  | [S2,MB4,BI] 1057-14-1072ms | [S6,MB6,BW] 1072-2-1075ms  | [S2,MB5,BI] 1094-14-1109ms | [S6,MB7,BW] 1108-2-1111ms  | [S2,MB6,BI] 1115-14-1130ms | [S2,MB4,BW] 1129-1-1131ms  | [S2,MB7,BI] 1143-14-1158ms | [S2,MB5,BW] 1158-1-1160ms  | [S2,MB6,BW] 1159-1-1160ms  | [S2,MB7,BW] 1160-1-1161ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-12-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-231ms   | [S7,MB0,F]  270-18-289ms   | [S7,MB0,BI] 301-35-336ms   | [S7,MB1,F]  336-21-357ms   | [S7,MB1,BI] 368-35-404ms   | [S7,MB2,F]  404-23-428ms   | [S7,MB2,BI] 439-35-475ms   | [S7,MB3,F]  475-23-498ms   | [S7,MB3,BI] 510-36-546ms   | [S7,MB0,BW] 546-1-547ms    | [S3,MB4,F]  554-14-568ms   | [S3,MB0,BI] 568-18-587ms   | [S7,MB1,BW] 587-2-589ms    | [S3,MB5,F]  598-13-612ms   | [S3,MB1,BI] 612-17-629ms   | [S7,MB2,BW] 629-1-630ms    | [S3,MB6,F]  642-13-655ms   | [S3,MB2,BI] 655-16-671ms   | [S7,MB3,BW] 671-0-672ms    | [S3,MB7,F]  692-13-705ms   | [S3,MB3,BI] 705-16-721ms   | [S3,MB0,BW] 722-1-724ms    | [S7,MB4,F]  737-18-756ms   | [S7,MB4,BI] 768-35-803ms   | [S3,MB1,BW] 804-2-806ms    | [S7,MB5,F]  811-19-830ms   | [S7,MB5,BI] 842-35-878ms   | [S3,MB2,BW] 878-2-880ms    | [S7,MB6,F]  885-19-905ms   | [S7,MB6,BI] 917-35-953ms   | [S3,MB3,BW] 953-2-955ms    | [S7,MB7,F]  960-21-982ms   | [S7,MB7,BI] 993-35-1029ms  | [S7,MB4,BW] 1029-1-1031ms  | [S3,MB4,BI] 1031-17-1048ms | [S7,MB5,BW] 1047-0-1048ms  | [S3,MB5,BI] 1048-17-1066ms | [S7,MB6,BW] 1065-0-1066ms  | [S3,MB6,BI] 1066-16-1082ms | [S7,MB7,BW] 1082-0-1083ms  | [S3,MB7,BI] 1087-16-1104ms | [S3,MB4,BW] 1103-1-1104ms  | [S3,MB5,BW] 1104-1-1105ms  | [S3,MB6,BW] 1106-1-1108ms  | [S3,MB7,BW] 1107-1-1109ms 
[rank0]:2026-01-01 17:19:40,001 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 17:19:44,895 - Avg. fwd time: 17.1272 / Avg. bwd-weight time: 1.5286 / Avg. bwd-input time: 26.4386 / Avg. batch time: 1069.4308 (ms) / GPU bubble ratio: 32.53%
[rank2]:2026-01-01 17:19:44,944 - Avg. fwd time: 13.3288 / Avg. bwd-weight time: 2.0736 / Avg. bwd-input time: 15.0726 / Avg. batch time: 1135.7911 (ms) / GPU bubble ratio: 57.07%
[rank2]:2026-01-01 17:19:44,993 -  step: 750  loss: -4.0000  grad_norm:  5.6662  memory: 14.23GiB(29.96%)  tps: 6,595  tflops: 51.55  mfu: 16.52%
[rank3]:2026-01-01 17:19:44,993 -  step: 750  loss: 11.0736  grad_norm:  5.6662  memory: 30.44GiB(64.07%)  tps: 6,595  tflops: 51.55  mfu: 16.52%
[rank0]:2026-01-01 17:19:44,989 - Avg. fwd time: 13.6928 / Avg. full-bwd time: 14.5800 (Avg. bwd-weight time: 1.3407 / Avg. bwd-input time: 15.0188) / Avg. batch time: 1222.8520 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 17:19:44,993 -  step: 750  loss: -4.0000  grad_norm:  5.6662  memory: 13.98GiB(29.42%)  tps: 6,595  tflops: 51.55  mfu: 16.52%
[rank1]:2026-01-01 17:19:44,979 - Avg. fwd time: 16.7311 / Avg. bwd-weight time: 2.9227 / Avg. bwd-input time: 18.9894 / Avg. batch time: 1193.6014 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 17:19:44,992 -  step: 750  loss: -4.0000  grad_norm:  5.6662  memory: 19.62GiB(41.30%)  tps: 6,595  tflops: 51.55  mfu: 16.52%
[rank0]:2026-01-01 17:23:48,772 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 17:23:53,770 - Avg. fwd time: 17.1324 / Avg. bwd-weight time: 1.5290 / Avg. bwd-input time: 26.4431 / Avg. batch time: 1069.5743 (ms) / GPU bubble ratio: 32.53%
[rank0]:2026-01-01 17:23:53,866 - Avg. fwd time: 13.6932 / Avg. full-bwd time: 14.5808 (Avg. bwd-weight time: 1.3405 / Avg. bwd-input time: 15.0198) / Avg. batch time: 1222.9504 (ms) / GPU bubble ratio: 61.84%
[rank0]:2026-01-01 17:23:53,871 -  step: 800  loss: -4.0000  grad_norm: 31.3080  memory: 13.98GiB(29.42%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank0]:2026-01-01 17:23:53,871 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 31.3080  tps: 6,990  tflops: 54.64  mfu: 15.90%
[rank0]:2026-01-01 17:23:53,871 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 17:23:53,872 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 17:23:53,854 - Avg. fwd time: 16.7327 / Avg. bwd-weight time: 2.9225 / Avg. bwd-input time: 18.9902 / Avg. batch time: 1193.6975 (ms) / GPU bubble ratio: 48.20%
[rank1]:2026-01-01 17:23:53,870 -  step: 800  loss: -4.0000  grad_norm: 31.3080  memory: 19.62GiB(41.30%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank1]:2026-01-01 17:23:53,870 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 31.3080  tps: 6,990  tflops: 54.64  mfu: 15.89%
[rank1]:2026-01-01 17:23:53,870 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 17:23:53,871 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 17:23:53,871 -  step: 800  loss:  9.8078  grad_norm: 31.3080  memory: 30.44GiB(64.07%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank3]:2026-01-01 17:23:53,872 - â„¹ï¸ final step: 800  loss:  9.8078  grad_norm: 31.3080  tps: 6,994  tflops: 54.68  mfu: 15.97%
[rank3]:2026-01-01 17:23:53,872 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 17:23:53,873 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 17:23:53,818 - Avg. fwd time: 13.3296 / Avg. bwd-weight time: 2.0736 / Avg. bwd-input time: 15.0733 / Avg. batch time: 1135.8867 (ms) / GPU bubble ratio: 57.07%
[rank2]:2026-01-01 17:23:53,870 -  step: 800  loss: -4.0000  grad_norm: 31.3080  memory: 14.23GiB(29.96%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank2]:2026-01-01 17:23:53,870 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm: 31.3080  tps: 6,999  tflops: 54.72  mfu: 16.11%
[rank2]:2026-01-01 17:23:53,870 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 17:23:53,871 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 17:23:56,204 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-01 17:23:56,230 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-01 17:23:56,231 - Destroying the purge thread.
[rank2]:2026-01-01 17:23:56,231 - Destroying the purge thread.
[rank1]:2026-01-01 17:23:56,310 - Process group destroyed
[rank2]:2026-01-01 17:23:56,293 - Process group destroyed
[rank3]:2026-01-01 17:23:56,558 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1723_final800_rank3.svg
[rank3]:			> Batch Time: 1220.72 ms, GPU Bubble Ratio: 61.79%, 49.38%, 60.08%, 40.97%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-14-28ms     | [S0,MB2,F]  28-13-41ms     | [S0,MB3,F]  41-13-54ms     | [S4,MB0,F]  71-14-86ms     | [S4,MB1,F]  129-14-144ms   | [S4,MB2,F]  187-14-201ms   | [S4,MB3,F]  245-14-260ms   | [S4,MB0,BI] 388-14-402ms   | [S4,MB0,BW] 402-1-403ms    | [S0,MB4,F]  404-12-416ms   | [S4,MB1,BI] 458-15-473ms   | [S4,MB1,BW] 473-1-474ms    | [S0,MB5,F]  475-12-487ms   | [S4,MB2,BI] 534-15-550ms   | [S4,MB2,BW] 550-1-551ms    | [S0,MB6,F]  551-13-564ms   | [S4,MB3,BI] 603-17-620ms   | [S4,MB3,BW] 620-1-621ms    | [S0,MB7,F]  621-15-637ms   | [S0,MB0,B]  658-16-674ms   | [S4,MB4,F]  674-12-686ms   | [S0,MB1,B]  709-15-725ms   | [S4,MB5,F]  725-12-738ms   | [S0,MB2,B]  755-14-769ms   | [S4,MB6,F]  770-12-782ms   | [S0,MB3,B]  799-14-814ms   | [S4,MB7,F]  814-13-827ms   | [S4,MB4,BI] 858-15-873ms   | [S4,MB4,BW] 873-1-874ms    | [S4,MB5,BI] 942-14-956ms   | [S4,MB5,BW] 956-1-957ms    | [S4,MB6,BI] 1006-14-1020ms | [S4,MB6,BW] 1020-1-1021ms  | [S4,MB7,BI] 1083-14-1097ms | [S4,MB7,BW] 1098-2-1100ms  | [S0,MB4,B]  1112-13-1125ms | [S0,MB5,B]  1149-13-1162ms | [S0,MB6,B]  1178-13-1191ms | [S0,MB7,B]  1207-13-1220ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-19-32ms     | [S1,MB1,F]  71-19-91ms     | [S1,MB2,F]  129-19-148ms   | [S1,MB3,F]  187-19-206ms   | [S5,MB0,F]  245-12-258ms   | [S5,MB1,F]  264-12-277ms   | [S5,MB2,F]  283-12-296ms   | [S5,MB0,BI] 365-14-380ms   | [S5,MB3,F]  380-15-395ms   | [S5,MB1,BI] 435-14-449ms   | [S5,MB0,BW] 449-3-453ms    | [S1,MB4,F]  459-19-479ms   | [S5,MB2,BI] 505-15-520ms   | [S5,MB1,BW] 520-1-521ms    | [S1,MB5,F]  535-19-555ms   | [S5,MB3,BI] 578-16-595ms   | [S5,MB2,BW] 594-3-597ms    | [S1,MB6,F]  606-20-626ms   | [S1,MB0,BI] 626-24-650ms   | [S5,MB3,BW] 651-2-653ms    | [S1,MB7,F]  658-20-679ms   | [S1,MB1,BI] 679-23-702ms   | [S1,MB0,BW] 702-3-706ms    | [S5,MB4,F]  710-14-724ms   | [S1,MB2,BI] 724-23-747ms   | [S1,MB1,BW] 748-3-751ms    | [S5,MB5,F]  755-13-769ms   | [S1,MB3,BI] 769-23-792ms   | [S1,MB2,BW] 792-3-796ms    | [S5,MB6,F]  800-13-813ms   | [S5,MB4,BI] 835-15-851ms   | [S1,MB3,BW] 851-3-854ms    | [S5,MB7,F]  858-13-871ms   | [S5,MB5,BI] 909-15-924ms   | [S5,MB4,BW] 924-1-925ms    | [S5,MB6,BI] 984-14-999ms   | [S5,MB5,BW] 999-2-1001ms   | [S5,MB7,BI] 1061-14-1076ms | [S5,MB6,BW] 1076-2-1079ms  | [S1,MB4,BI] 1083-21-1105ms | [S5,MB7,BW] 1105-2-1108ms  | [S1,MB5,BI] 1119-22-1141ms | [S1,MB4,BW] 1141-3-1145ms  | [S1,MB6,BI] 1148-22-1170ms | [S1,MB5,BW] 1170-3-1174ms  | [S1,MB7,BI] 1177-22-1199ms | [S1,MB6,BW] 1199-3-1203ms  | [S1,MB7,BW] 1203-1-1205ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-12-45ms     | [S2,MB1,F]  91-12-103ms    | [S2,MB2,F]  148-12-161ms   | [S2,MB3,F]  206-12-219ms   | [S6,MB0,F]  258-12-271ms   | [S6,MB1,F]  277-12-290ms   | [S6,MB0,BI] 343-14-358ms   | [S6,MB2,F]  358-14-373ms   | [S6,MB1,BI] 413-15-428ms   | [S6,MB3,F]  428-14-443ms   | [S6,MB2,BI] 483-14-498ms   | [S6,MB0,BW] 498-2-501ms    | [S2,MB4,F]  506-13-519ms   | [S6,MB3,BI] 555-15-570ms   | [S6,MB1,BW] 570-2-573ms    | [S2,MB5,F]  580-13-594ms   | [S2,MB0,BI] 598-16-615ms   | [S6,MB2,BW] 615-2-617ms    | [S2,MB6,F]  629-13-643ms   | [S2,MB1,BI] 643-15-658ms   | [S6,MB3,BW] 658-1-660ms    | [S2,MB7,F]  680-13-694ms   | [S2,MB2,BI] 694-15-709ms   | [S2,MB0,BW] 709-1-711ms    | [S6,MB4,F]  725-13-739ms   | [S2,MB3,BI] 739-15-754ms   | [S2,MB1,BW] 754-1-756ms    | [S6,MB5,F]  770-13-783ms   | [S6,MB4,BI] 812-15-828ms   | [S2,MB2,BW] 828-2-831ms    | [S6,MB6,F]  835-13-849ms   | [S6,MB5,BI] 887-15-902ms   | [S2,MB3,BW] 902-2-905ms    | [S6,MB7,F]  910-13-923ms   | [S6,MB6,BI] 962-15-978ms   | [S6,MB4,BW] 977-2-980ms    | [S6,MB7,BI] 1040-14-1055ms | [S6,MB5,BW] 1055-2-1058ms  | [S2,MB4,BI] 1062-14-1077ms | [S6,MB6,BW] 1076-2-1079ms  | [S2,MB5,BI] 1098-14-1113ms | [S6,MB7,BW] 1112-2-1115ms  | [S2,MB6,BI] 1119-14-1134ms | [S2,MB4,BW] 1133-1-1135ms  | [S2,MB7,BI] 1148-14-1163ms | [S2,MB5,BW] 1162-1-1164ms  | [S2,MB6,BW] 1163-1-1165ms  | [S2,MB7,BW] 1164-1-1165ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-13-58ms     | [S3,MB1,F]  103-12-116ms   | [S3,MB2,F]  161-12-174ms   | [S3,MB3,F]  219-12-232ms   | [S7,MB0,F]  271-18-289ms   | [S7,MB0,BI] 301-35-337ms   | [S7,MB1,F]  337-21-358ms   | [S7,MB1,BI] 370-35-406ms   | [S7,MB2,F]  406-23-429ms   | [S7,MB2,BI] 441-36-477ms   | [S7,MB3,F]  477-23-500ms   | [S7,MB3,BI] 512-36-549ms   | [S7,MB0,BW] 549-1-550ms    | [S3,MB4,F]  556-14-571ms   | [S3,MB0,BI] 571-18-589ms   | [S7,MB1,BW] 589-2-592ms    | [S3,MB5,F]  601-13-614ms   | [S3,MB1,BI] 614-17-632ms   | [S7,MB2,BW] 632-1-634ms    | [S3,MB6,F]  644-13-658ms   | [S3,MB2,BI] 658-16-674ms   | [S7,MB3,BW] 674-0-675ms    | [S3,MB7,F]  695-13-708ms   | [S3,MB3,BI] 708-16-724ms   | [S3,MB0,BW] 724-1-726ms    | [S7,MB4,F]  740-18-759ms   | [S7,MB4,BI] 771-35-806ms   | [S3,MB1,BW] 806-2-808ms    | [S7,MB5,F]  814-19-833ms   | [S7,MB5,BI] 845-35-880ms   | [S3,MB2,BW] 880-2-883ms    | [S7,MB6,F]  888-20-908ms   | [S7,MB6,BI] 920-35-956ms   | [S3,MB3,BW] 956-2-958ms    | [S7,MB7,F]  963-21-985ms   | [S7,MB7,BI] 997-35-1033ms  | [S7,MB4,BW] 1033-1-1035ms  | [S3,MB4,BI] 1034-17-1052ms | [S7,MB5,BW] 1052-0-1053ms  | [S3,MB5,BI] 1053-17-1070ms | [S7,MB6,BW] 1070-0-1071ms  | [S3,MB6,BI] 1071-16-1088ms | [S7,MB7,BW] 1087-0-1088ms  | [S3,MB7,BI] 1091-16-1108ms | [S3,MB4,BW] 1108-1-1110ms  | [S3,MB5,BW] 1109-1-1111ms  | [S3,MB6,BW] 1110-1-1112ms  | [S3,MB7,BW] 1111-1-1113ms 
[rank3]:2026-01-01 17:23:56,880 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1/pipeline_schedule/260101_1723_thry_final800_rank3.svg
[rank3]:			> Batch Time: 775.33 ms, GPU Bubble Ratio: 5.88%, 5.88%, 5.88%, 5.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S4,MB0,F]  60-15-76ms     | [S4,MB1,F]  76-15-91ms     | [S4,MB2,F]  91-15-106ms    | [S4,MB3,F]  106-15-121ms   | [S4,MB0,BI] 167-15-182ms   | [S4,MB0,BW] 182-15-197ms   | [S0,MB4,F]  197-15-212ms   | [S4,MB1,BI] 212-15-228ms   | [S4,MB1,BW] 228-15-243ms   | [S0,MB5,F]  243-15-258ms   | [S4,MB2,BI] 258-15-273ms   | [S4,MB2,BW] 273-15-288ms   | [S0,MB6,F]  288-15-304ms   | [S4,MB3,BI] 304-15-319ms   | [S4,MB3,BW] 319-15-334ms   | [S0,MB7,F]  334-15-349ms   | [S0,MB0,B]  349-30-380ms   | [S4,MB4,F]  380-15-395ms   | [S0,MB1,B]  395-30-425ms   | [S4,MB5,F]  425-15-440ms   | [S0,MB2,B]  440-30-471ms   | [S4,MB6,F]  471-15-486ms   | [S0,MB3,B]  486-30-516ms   | [S4,MB7,F]  516-15-532ms   | [S4,MB4,BI] 532-15-547ms   | [S4,MB4,BW] 547-15-562ms   | [S4,MB5,BI] 562-15-577ms   | [S4,MB5,BW] 577-15-592ms   | [S4,MB6,BI] 592-15-608ms   | [S4,MB6,BW] 608-15-623ms   | [S4,MB7,BI] 623-15-638ms   | [S4,MB7,BW] 638-15-653ms   | [S0,MB4,B]  653-30-684ms   | [S0,MB5,B]  684-30-714ms   | [S0,MB6,B]  714-30-744ms   | [S0,MB7,B]  744-30-775ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  30-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S5,MB0,F]  76-15-91ms     | [S5,MB1,F]  91-15-106ms    | [S5,MB2,F]  106-15-121ms   | [S5,MB0,BI] 152-15-167ms   | [S5,MB3,F]  167-15-182ms   | [S5,MB1,BI] 182-15-197ms   | [S5,MB0,BW] 197-15-212ms   | [S1,MB4,F]  212-15-228ms   | [S5,MB2,BI] 228-15-243ms   | [S5,MB1,BW] 243-15-258ms   | [S1,MB5,F]  258-15-273ms   | [S5,MB3,BI] 273-15-288ms   | [S5,MB2,BW] 288-15-304ms   | [S1,MB6,F]  304-15-319ms   | [S1,MB0,BI] 319-15-334ms   | [S5,MB3,BW] 334-15-349ms   | [S1,MB7,F]  349-15-364ms   | [S1,MB1,BI] 364-15-380ms   | [S1,MB0,BW] 380-15-395ms   | [S5,MB4,F]  395-15-410ms   | [S1,MB2,BI] 410-15-425ms   | [S1,MB1,BW] 425-15-440ms   | [S5,MB5,F]  440-15-456ms   | [S1,MB3,BI] 456-15-471ms   | [S1,MB2,BW] 471-15-486ms   | [S5,MB6,F]  486-15-501ms   | [S5,MB4,BI] 501-15-516ms   | [S1,MB3,BW] 516-15-532ms   | [S5,MB7,F]  532-15-547ms   | [S5,MB5,BI] 547-15-562ms   | [S5,MB4,BW] 562-15-577ms   | [S5,MB6,BI] 577-15-592ms   | [S5,MB5,BW] 592-15-608ms   | [S5,MB7,BI] 608-15-623ms   | [S5,MB6,BW] 623-15-638ms   | [S1,MB4,BI] 638-15-653ms   | [S5,MB7,BW] 653-15-668ms   | [S1,MB5,BI] 668-15-684ms   | [S1,MB4,BW] 684-15-699ms   | [S1,MB6,BI] 699-15-714ms   | [S1,MB5,BW] 714-15-729ms   | [S1,MB7,BI] 729-15-744ms   | [S1,MB6,BW] 744-15-760ms   | [S1,MB7,BW] 760-15-775ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-15-45ms     | [S2,MB1,F]  45-15-60ms     | [S2,MB2,F]  60-15-76ms     | [S2,MB3,F]  76-15-91ms     | [S6,MB0,F]  91-15-106ms    | [S6,MB1,F]  106-15-121ms   | [S6,MB0,BI] 136-15-152ms   | [S6,MB2,F]  152-15-167ms   | [S6,MB1,BI] 167-15-182ms   | [S6,MB3,F]  182-15-197ms   | [S6,MB2,BI] 197-15-212ms   | [S6,MB0,BW] 212-15-228ms   | [S2,MB4,F]  228-15-243ms   | [S6,MB3,BI] 243-15-258ms   | [S6,MB1,BW] 258-15-273ms   | [S2,MB5,F]  273-15-288ms   | [S2,MB0,BI] 288-15-304ms   | [S6,MB2,BW] 304-15-319ms   | [S2,MB6,F]  319-15-334ms   | [S2,MB1,BI] 334-15-349ms   | [S6,MB3,BW] 349-15-364ms   | [S2,MB7,F]  364-15-380ms   | [S2,MB2,BI] 380-15-395ms   | [S2,MB0,BW] 395-15-410ms   | [S6,MB4,F]  410-15-425ms   | [S2,MB3,BI] 425-15-440ms   | [S2,MB1,BW] 440-15-456ms   | [S6,MB5,F]  456-15-471ms   | [S6,MB4,BI] 471-15-486ms   | [S2,MB2,BW] 486-15-501ms   | [S6,MB6,F]  501-15-516ms   | [S6,MB5,BI] 516-15-532ms   | [S2,MB3,BW] 532-15-547ms   | [S6,MB7,F]  547-15-562ms   | [S6,MB6,BI] 562-15-577ms   | [S6,MB4,BW] 577-15-592ms   | [S6,MB7,BI] 592-15-608ms   | [S6,MB5,BW] 608-15-623ms   | [S2,MB4,BI] 623-15-638ms   | [S6,MB6,BW] 638-15-653ms   | [S2,MB5,BI] 653-15-668ms   | [S6,MB7,BW] 668-15-684ms   | [S2,MB6,BI] 684-15-699ms   | [S2,MB4,BW] 699-15-714ms   | [S2,MB7,BI] 714-15-729ms   | [S2,MB5,BW] 729-15-744ms   | [S2,MB6,BW] 744-15-760ms   | [S2,MB7,BW] 760-15-775ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-15-60ms     | [S3,MB1,F]  60-15-76ms     | [S3,MB2,F]  76-15-91ms     | [S3,MB3,F]  91-15-106ms    | [S7,MB0,F]  106-15-121ms   | [S7,MB0,BI] 121-15-136ms   | [S7,MB1,F]  136-15-152ms   | [S7,MB1,BI] 152-15-167ms   | [S7,MB2,F]  167-15-182ms   | [S7,MB2,BI] 182-15-197ms   | [S7,MB3,F]  197-15-212ms   | [S7,MB3,BI] 212-15-228ms   | [S7,MB0,BW] 228-15-243ms   | [S3,MB4,F]  243-15-258ms   | [S3,MB0,BI] 258-15-273ms   | [S7,MB1,BW] 273-15-288ms   | [S3,MB5,F]  288-15-304ms   | [S3,MB1,BI] 304-15-319ms   | [S7,MB2,BW] 319-15-334ms   | [S3,MB6,F]  334-15-349ms   | [S3,MB2,BI] 349-15-364ms   | [S7,MB3,BW] 364-15-380ms   | [S3,MB7,F]  380-15-395ms   | [S3,MB3,BI] 395-15-410ms   | [S3,MB0,BW] 410-15-425ms   | [S7,MB4,F]  425-15-440ms   | [S7,MB4,BI] 440-15-456ms   | [S3,MB1,BW] 456-15-471ms   | [S7,MB5,F]  471-15-486ms   | [S7,MB5,BI] 486-15-501ms   | [S3,MB2,BW] 501-15-516ms   | [S7,MB6,F]  516-15-532ms   | [S7,MB6,BI] 532-15-547ms   | [S3,MB3,BW] 547-15-562ms   | [S7,MB7,F]  562-15-577ms   | [S7,MB7,BI] 577-15-592ms   | [S7,MB4,BW] 592-15-608ms   | [S3,MB4,BI] 608-15-623ms   | [S7,MB5,BW] 623-15-638ms   | [S3,MB5,BI] 638-15-653ms   | [S7,MB6,BW] 653-15-668ms   | [S3,MB6,BI] 668-15-684ms   | [S7,MB7,BW] 684-15-699ms   | [S3,MB7,BI] 699-15-714ms   | [S3,MB4,BW] 714-15-729ms   | [S3,MB5,BW] 729-15-744ms   | [S3,MB6,BW] 744-15-760ms   | [S3,MB7,BW] 760-15-775ms  
[rank3]:2026-01-01 17:23:56,881 - Destroying the purge thread.
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–‚â–‚â–â–‚â–ˆâ–â–â–â–ˆâ–â–â–â–‡â–‚â–â–â–‡
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.68514
[rank3]:wandb:               final/avg_loss 9.80785
[rank3]:wandb:             final/avg_mfu(%) 15.96589
[rank3]:wandb:             final/avg_tflops 54.67611
[rank3]:wandb:    final/avg_throughput(tps) 6994.03045
[rank3]:wandb:              final/grad_norm 31.30804
[rank3]:wandb:               final/max_loss 9.80785
[rank3]:wandb:                    grad_norm 31.30804
[rank3]:wandb: loss_metrics/global_avg_loss 9.80785
[rank3]:wandb: loss_metrics/global_max_loss 9.80785
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_InterleavedZeroBubble_nofreeze_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/htm9octl
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_InterleavedZeroBubble_nofreeze_42_dm1/20260101-1617/wandb/run-20260101_161730-htm9octl/logs
[rank0]:2026-01-01 17:23:58,231 - Training completed
[rank0]:2026-01-01 17:23:58,231 - Destroying the purge thread.
[rank0]:2026-01-01 17:23:58,321 - Process group destroyed
[rank3]:2026-01-01 17:23:58,290 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'norm', 'output', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: InterleavedZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_InterleavedZeroBubble_nofreeze_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
