
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2026. 01. 01. (ëª©) 00:16:02 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1231_lora/1231_GPipe_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled

âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
1231: everything same as 1230 but LoRA enabled
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2026-01-01 00:16:10,129 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank1]:2026-01-01 00:16:10,172 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:1231: everything same as 1230 but LoRA enabled
[rank1]:"
[rank0]:2026-01-01 00:16:10,245 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:1231: everything same as 1230 but LoRA enabled
[rank0]:"
[rank2]:2026-01-01 00:16:10,314 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:1231: everything same as 1230 but LoRA enabled
[rank2]:"
[rank3]:2026-01-01 00:16:10,291 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-01 00:16:10,304 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 00:16:10,528 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-01 00:16:10,530 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 00:16:10,533 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-01 00:16:10,534 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-01 00:16:10,446 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-01 00:16:10,450 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-01 00:16:10,565 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-01 00:16:10,567 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-01 00:16:10,923 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2026-01-01 00:16:13,719 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2026-01-01 00:16:13,883 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2026-01-01 00:16:13,931 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 00:16:13,932 - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2026-01-01 00:16:13,865 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2026-01-01 00:16:13,913 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 00:16:13,940 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-01 00:16:13,940 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2026-01-01 00:16:13,886 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2026-01-01 00:16:13,936 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 00:16:13,958 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-01 00:16:13,959 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2026-01-01 00:16:13,962 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-01 00:16:13,962 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2026-01-01 00:16:14,130 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2026-01-01 00:16:14,130 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2026-01-01 00:16:14,131 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2026-01-01 00:16:14,165 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2026-01-01 00:16:14,165 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2026-01-01 00:16:14,165 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2026-01-01 00:16:14,162 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2026-01-01 00:16:14,162 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2026-01-01 00:16:14,163 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run lbqjn9na
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1231_GPipe_auto_42_dm1/20260101-0016/wandb/run-20260101_001615-lbqjn9na
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1231_GPipe_auto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/lbqjn9na
[rank3]:2026-01-01 00:16:16,189 - WandB logging enabled
[rank3]:2026-01-01 00:16:16,189 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2026-01-01 00:16:16,229 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 00:16:16,255 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2026-01-01 00:16:16,256 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2026-01-01 00:16:16,475 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1231_GPipe_auto_42_dm1
[rank0]:2026-01-01 00:16:16,475 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 00:16:16,476 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2026-01-01 00:16:16,476 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2026-01-01 00:16:16,481 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-01 00:16:16,475 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-01 00:16:16,457 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2026-01-01 00:16:16,458 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2026-01-01 00:16:16,459 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2026-01-01 00:16:16,475 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-01 00:16:18,968 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-01 00:16:18,968 - Finished loading the checkpoint in 2.49 seconds.
[rank0]:2026-01-01 00:16:19,014 - [LoRA] [Stage 0] trainable num params: 56 / 93 = 60.22% (size: 2,818,048 / 508,772,352 = 0.55%)
[rank0]:2026-01-01 00:16:19,015 - Freezable Parameters: [Stage 0] 56 params
[rank0]:2026-01-01 00:16:19,015 - Training starts at step 1
[rank1]:2026-01-01 00:16:19,026 - [LoRA] [Stage 1] trainable num params: 70 / 115 = 60.87% (size: 3,522,560 / 307,630,080 = 1.15%)
[rank1]:2026-01-01 00:16:19,027 - Freezable Parameters: [Stage 1] 70 params
[rank3]:2026-01-01 00:16:19,040 - [LoRA] [Stage 3] trainable num params: 42 / 71 = 59.15% (size: 2,113,536 / 447,248,384 = 0.47%)
[rank3]:2026-01-01 00:16:19,041 - Freezable Parameters: [Stage 3] 42 params
[rank2]:2026-01-01 00:16:19,015 - [LoRA] [Stage 2] trainable num params: 56 / 92 = 60.87% (size: 2,818,048 / 246,104,064 = 1.15%)
[rank2]:2026-01-01 00:16:19,015 - Freezable Parameters: [Stage 2] 56 params
[rank0]:2026-01-01 00:16:24,136 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 14.51GiB(30.55%)  tps: 3,211  tflops: 25.10  mfu: 8.05%
[rank0]:2026-01-01 00:16:24,136 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-01 00:16:24,138 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 17.18GiB(36.17%)  tps: 3,205  tflops: 25.06  mfu: 8.03%
[rank1]:2026-01-01 00:16:24,138 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-01 00:16:24,112 -  step:  1  loss: -8.0000  grad_norm:  5.6782  memory: 13.85GiB(29.15%)  tps: 3,220  tflops: 25.17  mfu: 8.07%
[rank2]:2026-01-01 00:16:24,112 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 00:16:24,117 -  step:  1  loss: 10.6088  grad_norm:  5.6782  memory: 29.95GiB(63.04%)  tps: 4,156  tflops: 32.49  mfu: 10.41%
[rank3]:2026-01-01 00:16:24,117 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-01 00:17:59,875 - Avg. fwd time: 16.5373 / Avg. bwd time: 25.0777 / Avg. batch time: 393.0213 (ms) / GPU bubble ratio: 15.29%
[rank2]:2026-01-01 00:17:59,893 - Avg. fwd time: 12.2389 / Avg. bwd time: 12.8855 / Avg. batch time: 422.5831 (ms) / GPU bubble ratio: 52.44%
[rank0]:2026-01-01 00:17:59,934 - Avg. fwd time: 13.5157 / Avg. bwd time: 12.2943 / Avg. batch time: 490.5742 (ms) / GPU bubble ratio: 57.91%
[rank1]:2026-01-01 00:17:59,916 - Avg. fwd time: 15.4501 / Avg. bwd time: 16.4210 / Avg. batch time: 459.1973 (ms) / GPU bubble ratio: 44.47%
[rank0]:2026-01-01 00:19:36,018 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-01 00:19:39,913 - Avg. fwd time: 16.5705 / Avg. bwd time: 25.1579 / Avg. batch time: 393.5843 (ms) / GPU bubble ratio: 15.18%
[rank2]:2026-01-01 00:19:39,932 - Avg. fwd time: 12.2451 / Avg. bwd time: 12.8968 / Avg. batch time: 422.6689 (ms) / GPU bubble ratio: 52.41%
[rank2]:2026-01-01 00:19:39,976 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 13.85GiB(29.15%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank1]:2026-01-01 00:19:39,956 - Avg. fwd time: 15.4674 / Avg. bwd time: 16.4419 / Avg. batch time: 458.8363 (ms) / GPU bubble ratio: 44.36%
[rank1]:2026-01-01 00:19:39,976 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 17.18GiB(36.17%)  tps: 8,199  tflops: 64.09  mfu: 20.54%
[rank3]:2026-01-01 00:19:39,978 -  step: 50  loss: 12.4620  grad_norm:  4.3533  memory: 29.95GiB(63.04%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank0]:2026-01-01 00:19:39,973 - Avg. fwd time: 13.5003 / Avg. bwd time: 12.3029 / Avg. batch time: 489.6405 (ms) / GPU bubble ratio: 57.84%
[rank0]:2026-01-01 00:19:39,976 -  step: 50  loss: -8.0000  grad_norm:  4.3533  memory: 14.51GiB(30.55%)  tps: 8,199  tflops: 64.09  mfu: 20.54%
[rank2]:2026-01-01 00:20:16,024 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2026-01-01 00:20:16,027 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2026-01-01 00:20:16,023 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2026-01-01 00:20:16,025 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2026-01-01 00:20:55,946 - Freezing Ratio: [Stage2] 0.25, Threshold: 8.1521e+00
[rank3]:2026-01-01 00:20:55,947 - Freezing Ratio: [Stage3] 0.67, Threshold: 7.3880e+00
[rank1]:2026-01-01 00:20:55,949 - Freezing Ratio: [Stage1] 0.00, Threshold: 8.9988e+00
[rank0]:2026-01-01 00:20:55,947 - Freezing Ratio: [Stage0] 0.50, Threshold: 1.1763e+01
[rank3]:2026-01-01 00:21:19,405 - Avg. fwd time: 16.5840 / Avg. bwd time: 25.1450 / Avg. batch time: 393.4816 (ms) / GPU bubble ratio: 15.16%
[rank1]:2026-01-01 00:21:19,448 - Avg. fwd time: 15.4760 / Avg. bwd time: 16.4984 / Avg. batch time: 458.7441 (ms) / GPU bubble ratio: 44.24%
[rank0]:2026-01-01 00:21:19,459 - Avg. fwd time: 13.4704 / Avg. bwd time: 11.8025 / Avg. batch time: 488.7762 (ms) / GPU bubble ratio: 58.63%
[rank2]:2026-01-01 00:21:19,423 - Avg. fwd time: 12.2414 / Avg. bwd time: 12.8816 / Avg. batch time: 422.3577 (ms) / GPU bubble ratio: 52.41%
[rank3]:2026-01-01 00:21:35,049 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.7879e+01
[rank1]:2026-01-01 00:21:35,052 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.2131e+01
[rank0]:2026-01-01 00:21:35,049 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.7532e+01
[rank2]:2026-01-01 00:21:35,049 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0598e+01
[rank2]:2026-01-01 00:22:14,061 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.1626e+00
[rank3]:2026-01-01 00:22:14,061 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.1298e+00
[rank1]:2026-01-01 00:22:14,068 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3908e+00
[rank0]:2026-01-01 00:22:14,060 - Freezing Ratio: [Stage0] 0.50, Threshold: 4.6068e+00
[rank2]:2026-01-01 00:22:54,641 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4853e+00
[rank3]:2026-01-01 00:22:54,641 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.8360e+00
[rank1]:2026-01-01 00:22:54,648 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.1683e+00
[rank0]:2026-01-01 00:22:54,641 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:22:54,645 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.7542e+00
[rank2]:2026-01-01 00:22:58,433 - Avg. fwd time: 12.2184 / Avg. bwd time: 12.7888 / Avg. batch time: 421.0891 (ms) / GPU bubble ratio: 52.49%
[rank3]:2026-01-01 00:22:58,415 - Avg. fwd time: 16.5765 / Avg. bwd time: 25.0044 / Avg. batch time: 392.2465 (ms) / GPU bubble ratio: 15.19%
[rank3]:2026-01-01 00:22:58,469 -  step: 100  loss: 13.1172  grad_norm:  0.4949  memory: 29.95GiB(63.05%)  tps: 8,254  tflops: 64.53  mfu: 20.68%
[rank1]:2026-01-01 00:22:58,456 - Avg. fwd time: 15.4743 / Avg. bwd time: 16.8693 / Avg. batch time: 459.7897 (ms) / GPU bubble ratio: 43.72%
[rank1]:2026-01-01 00:22:58,467 -  step: 100  loss: -8.0000  grad_norm:  0.4949  memory: 17.19GiB(36.17%)  tps: 8,254  tflops: 64.53  mfu: 20.68%
[rank0]:2026-01-01 00:22:58,464 - Avg. fwd time: 13.3980 / Avg. bwd time: 9.9996 / Avg. batch time: 487.7302 (ms) / GPU bubble ratio: 61.62%
[rank0]:2026-01-01 00:22:58,467 -  step: 100  loss: -8.0000  grad_norm:  0.4949  memory: 14.51GiB(30.55%)  tps: 8,254  tflops: 64.53  mfu: 20.68%
[rank2]:2026-01-01 00:22:58,467 -  step: 100  loss: -8.0000  grad_norm:  0.4949  memory: 13.86GiB(29.17%)  tps: 8,254  tflops: 64.53  mfu: 20.68%
[rank2]:2026-01-01 00:22:58,537 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0022_stage2_step100.svg
[rank1]:2026-01-01 00:22:58,544 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0022_stage1_step100.svg
[rank0]:2026-01-01 00:22:58,542 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0022_stage0_step100.svg
[rank3]:2026-01-01 00:22:58,627 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0022_step100_rank3.svg
[rank3]:			> Batch Time: 478.97 ms, GPU Bubble Ratio: 67.94%, 45.58%, 58.53%, 31.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-13-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-64ms     | [S0,MB5,F]  64-13-78ms     | [S0,MB6,F]  78-12-91ms     | [S0,MB7,F]  91-14-105ms    | [S0,MB0,B]  297-5-303ms    | [S0,MB1,B]  322-5-328ms    | [S0,MB2,B]  346-5-352ms    | [S0,MB3,B]  370-6-376ms    | [S0,MB4,B]  395-6-401ms    | [S0,MB5,B]  420-6-426ms    | [S0,MB6,B]  445-6-451ms    | [S0,MB7,B]  473-5-478ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-28ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-86ms     | [S1,MB4,F]  94-15-110ms    | [S1,MB5,F]  118-15-134ms   | [S1,MB6,F]  143-15-158ms   | [S1,MB7,F]  167-15-182ms   | [S1,MB0,B]  278-16-294ms   | [S1,MB1,B]  302-16-318ms   | [S1,MB2,B]  326-16-342ms   | [S1,MB3,B]  350-16-367ms   | [S1,MB4,B]  375-16-392ms   | [S1,MB5,B]  400-16-416ms   | [S1,MB6,B]  425-16-442ms   | [S1,MB7,B]  447-21-469ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  91-12-104ms    | [S2,MB4,F]  115-12-127ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  164-12-176ms   | [S2,MB7,F]  188-12-200ms   | [S2,MB0,B]  262-12-274ms   | [S2,MB1,B]  286-12-299ms   | [S2,MB2,B]  310-12-323ms   | [S2,MB3,B]  334-12-347ms   | [S2,MB4,B]  359-12-372ms   | [S2,MB5,B]  384-12-397ms   | [S2,MB6,B]  409-12-422ms   | [S2,MB7,B]  431-12-444ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  64-16-81ms     | [S3,MB2,F]  88-16-105ms    | [S3,MB3,F]  112-16-129ms   | [S3,MB4,F]  136-16-153ms   | [S3,MB5,F]  160-16-177ms   | [S3,MB6,F]  185-16-202ms   | [S3,MB7,F]  209-16-226ms   | [S3,MB0,B]  232-23-256ms   | [S3,MB1,B]  255-24-280ms   | [S3,MB2,B]  279-24-304ms   | [S3,MB3,B]  304-24-328ms   | [S3,MB4,B]  328-24-353ms   | [S3,MB5,B]  353-24-378ms   | [S3,MB6,B]  377-24-402ms   | [S3,MB7,B]  402-24-427ms  
[rank3]:2026-01-01 00:22:58,671 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0022_stage3_step100.svg
[rank2]:2026-01-01 00:22:58,708 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0022_rank2_stage2.svg
[rank2]:	> Counts Sum: 84, Total Sum: 280 (30.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 00:22:58,736 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0022_rank1_stage1.svg
[rank1]:	> Counts Sum: 28, Total Sum: 350 (8.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 00:22:58,721 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0022_rank0_stage0.svg
[rank0]:	> Counts Sum: 140, Total Sum: 280 (50.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:22:58,812 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0022_rank3_stage3.svg
[rank3]:	> Counts Sum: 112, Total Sum: 210 (53.33%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 00:23:33,453 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.2410e+00
[rank2]:2026-01-01 00:23:33,453 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.6964e+00
[rank3]:2026-01-01 00:23:33,454 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7712e+00
[rank1]:2026-01-01 00:23:33,457 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.4491e+00
[rank3]:2026-01-01 00:24:12,574 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8843e+00
[rank1]:2026-01-01 00:24:12,577 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.6662e+00
[rank0]:2026-01-01 00:24:12,574 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.0626e+00
[rank2]:2026-01-01 00:24:12,573 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2516e+00
[rank3]:2026-01-01 00:24:35,599 - Avg. fwd time: 16.5760 / Avg. bwd time: 24.9253 / Avg. batch time: 391.5821 (ms) / GPU bubble ratio: 15.21%
[rank0]:2026-01-01 00:24:35,649 - Avg. fwd time: 13.3660 / Avg. bwd time: 8.8172 / Avg. batch time: 485.0544 (ms) / GPU bubble ratio: 63.41%
[rank2]:2026-01-01 00:24:35,618 - Avg. fwd time: 12.2039 / Avg. bwd time: 12.7238 / Avg. batch time: 420.2917 (ms) / GPU bubble ratio: 52.55%
[rank1]:2026-01-01 00:24:35,640 - Avg. fwd time: 15.4781 / Avg. bwd time: 16.7694 / Avg. batch time: 458.4757 (ms) / GPU bubble ratio: 43.73%
[rank0]:2026-01-01 00:24:51,252 - Freezing Ratio: [Stage0] 0.50, Threshold: 5.0179e+00
[rank2]:2026-01-01 00:24:51,251 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3329e+00
[rank3]:2026-01-01 00:24:51,252 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.7449e+00
[rank1]:2026-01-01 00:24:51,253 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3652e+00
[rank0]:2026-01-01 00:25:30,320 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.7434e+00
[rank2]:2026-01-01 00:25:30,319 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2214e+00
[rank3]:2026-01-01 00:25:30,320 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.3643e+00
[rank1]:2026-01-01 00:25:30,324 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.8368e+00
[rank0]:2026-01-01 00:26:08,855 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 00:26:08,860 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.8445e+00
[rank2]:2026-01-01 00:26:08,846 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5173e+00
[rank3]:2026-01-01 00:26:08,846 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4918e+00
[rank1]:2026-01-01 00:26:08,859 - Freezing Ratio: [Stage1] 0.00, Threshold: 5.3236e+00
[rank3]:2026-01-01 00:26:12,732 - Avg. fwd time: 16.5790 / Avg. bwd time: 24.8798 / Avg. batch time: 391.2239 (ms) / GPU bubble ratio: 15.22%
[rank2]:2026-01-01 00:26:12,751 - Avg. fwd time: 12.1953 / Avg. bwd time: 12.6834 / Avg. batch time: 419.8172 (ms) / GPU bubble ratio: 52.59%
[rank2]:2026-01-01 00:26:12,792 -  step: 150  loss: -8.0000  grad_norm:  0.7048  memory: 13.86GiB(29.17%)  tps: 8,431  tflops: 65.91  mfu: 21.13%
[rank3]:2026-01-01 00:26:12,795 -  step: 150  loss: 11.1241  grad_norm:  0.7048  memory: 29.95GiB(63.05%)  tps: 8,431  tflops: 65.91  mfu: 21.13%
[rank1]:2026-01-01 00:26:12,777 - Avg. fwd time: 15.4797 / Avg. bwd time: 16.7138 / Avg. batch time: 457.6841 (ms) / GPU bubble ratio: 43.73%
[rank1]:2026-01-01 00:26:12,792 -  step: 150  loss: -8.0000  grad_norm:  0.7048  memory: 17.19GiB(36.17%)  tps: 8,431  tflops: 65.91  mfu: 21.13%
[rank0]:2026-01-01 00:26:12,789 - Avg. fwd time: 13.3390 / Avg. bwd time: 8.0498 / Avg. batch time: 483.3769 (ms) / GPU bubble ratio: 64.60%
[rank0]:2026-01-01 00:26:12,793 -  step: 150  loss: -8.0000  grad_norm:  0.7048  memory: 14.51GiB(30.55%)  tps: 8,431  tflops: 65.91  mfu: 21.13%
[rank3]:2026-01-01 00:26:48,161 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.1771e+00
[rank1]:2026-01-01 00:26:48,165 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.8821e+00
[rank0]:2026-01-01 00:26:48,161 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.8208e+00
[rank2]:2026-01-01 00:26:48,160 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5616e+00
[rank3]:2026-01-01 00:27:26,924 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.7003e+00
[rank1]:2026-01-01 00:27:26,924 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2869e+00
[rank0]:2026-01-01 00:27:26,924 - Freezing Ratio: [Stage0] 0.50, Threshold: 5.0043e+00
[rank2]:2026-01-01 00:27:26,923 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.2189e+00
[rank3]:2026-01-01 00:27:50,266 - Avg. fwd time: 16.5830 / Avg. bwd time: 24.8489 / Avg. batch time: 390.9937 (ms) / GPU bubble ratio: 15.23%
[rank0]:2026-01-01 00:27:50,323 - Avg. fwd time: 13.3216 / Avg. bwd time: 7.5738 / Avg. batch time: 482.3995 (ms) / GPU bubble ratio: 65.35%
[rank2]:2026-01-01 00:27:50,286 - Avg. fwd time: 12.1906 / Avg. bwd time: 12.6626 / Avg. batch time: 419.5221 (ms) / GPU bubble ratio: 52.61%
[rank1]:2026-01-01 00:27:50,311 - Avg. fwd time: 15.4831 / Avg. bwd time: 16.6912 / Avg. batch time: 457.2414 (ms) / GPU bubble ratio: 43.71%
[rank0]:2026-01-01 00:28:06,020 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.5623e+00
[rank2]:2026-01-01 00:28:06,019 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2402e+00
[rank3]:2026-01-01 00:28:06,020 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.3121e+00
[rank1]:2026-01-01 00:28:06,024 - Freezing Ratio: [Stage1] 0.20, Threshold: 1.9317e+00
[rank0]:2026-01-01 00:28:44,660 - Freezing Ratio: [Stage0] 0.50, Threshold: 2.7009e+00
[rank2]:2026-01-01 00:28:44,659 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.1316e+00
[rank3]:2026-01-01 00:28:44,660 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8176e+00
[rank1]:2026-01-01 00:28:44,663 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1256e+00
[rank3]:2026-01-01 00:29:25,379 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.2534e+00
[rank1]:2026-01-01 00:29:25,387 - Freezing Ratio: [Stage1] 0.20, Threshold: 4.3934e+00
[rank0]:2026-01-01 00:29:25,378 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:29:25,382 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.3478e+00
[rank2]:2026-01-01 00:29:25,377 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.9314e+00
[rank3]:2026-01-01 00:29:29,369 - Avg. fwd time: 16.5869 / Avg. bwd time: 24.8273 / Avg. batch time: 390.8519 (ms) / GPU bubble ratio: 15.23%
[rank1]:2026-01-01 00:29:29,415 - Avg. fwd time: 15.4936 / Avg. bwd time: 16.8233 / Avg. batch time: 457.9196 (ms) / GPU bubble ratio: 43.54%
[rank0]:2026-01-01 00:29:29,424 - Avg. fwd time: 13.3098 / Avg. bwd time: 7.2013 / Avg. batch time: 482.6617 (ms) / GPU bubble ratio: 66.00%
[rank0]:2026-01-01 00:29:29,427 -  step: 200  loss: -8.0000  grad_norm:  0.7194  memory: 14.51GiB(30.55%)  tps: 8,332  tflops: 65.14  mfu: 20.88%
[rank2]:2026-01-01 00:29:29,389 - Avg. fwd time: 12.1873 / Avg. bwd time: 12.6458 / Avg. batch time: 419.4187 (ms) / GPU bubble ratio: 52.63%
[rank2]:2026-01-01 00:29:29,427 -  step: 200  loss: -8.0000  grad_norm:  0.7194  memory: 13.86GiB(29.17%)  tps: 8,332  tflops: 65.14  mfu: 20.88%
[rank3]:2026-01-01 00:29:29,429 -  step: 200  loss: 10.2906  grad_norm:  0.7194  memory: 29.95GiB(63.05%)  tps: 8,332  tflops: 65.14  mfu: 20.88%
[rank1]:2026-01-01 00:29:29,427 -  step: 200  loss: -8.0000  grad_norm:  0.7194  memory: 17.19GiB(36.17%)  tps: 8,332  tflops: 65.14  mfu: 20.88%
[rank1]:2026-01-01 00:29:29,486 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0029_stage1_step200.svg
[rank0]:2026-01-01 00:29:29,485 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0029_stage0_step200.svg
[rank2]:2026-01-01 00:29:29,481 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0029_stage2_step200.svg
[rank3]:2026-01-01 00:29:29,579 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0029_step200_rank3.svg
[rank3]:			> Batch Time: 506.18 ms, GPU Bubble Ratio: 69.69%, 42.28%, 60.80%, 34.96%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-13-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-65ms     | [S0,MB5,F]  65-13-78ms     | [S0,MB6,F]  79-12-91ms     | [S0,MB7,F]  91-14-105ms    | [S0,MB0,B]  299-5-305ms    | [S0,MB1,B]  324-5-329ms    | [S0,MB2,B]  348-5-353ms    | [S0,MB3,B]  373-6-379ms    | [S0,MB4,B]  401-5-407ms    | [S0,MB5,B]  434-5-439ms    | [S0,MB6,B]  467-5-473ms    | [S0,MB7,B]  500-5-506ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-29ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-87ms     | [S1,MB4,F]  95-15-111ms    | [S1,MB5,F]  119-15-134ms   | [S1,MB6,F]  143-15-159ms   | [S1,MB7,F]  167-15-183ms   | [S1,MB0,B]  279-16-295ms   | [S1,MB1,B]  303-16-320ms   | [S1,MB2,B]  328-16-344ms   | [S1,MB3,B]  352-16-369ms   | [S1,MB4,B]  377-17-395ms   | [S1,MB5,B]  402-26-429ms   | [S1,MB6,B]  435-29-464ms   | [S1,MB7,B]  467-29-497ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-12-104ms    | [S2,MB4,F]  116-12-128ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  164-12-176ms   | [S2,MB7,F]  189-12-201ms   | [S2,MB0,B]  263-12-276ms   | [S2,MB1,B]  288-12-300ms   | [S2,MB2,B]  312-12-324ms   | [S2,MB3,B]  337-12-349ms   | [S2,MB4,B]  361-12-374ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  411-12-423ms   | [S2,MB7,B]  435-12-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  65-16-81ms     | [S3,MB2,F]  89-16-105ms    | [S3,MB3,F]  113-16-129ms   | [S3,MB4,F]  137-16-154ms   | [S3,MB5,F]  161-16-178ms   | [S3,MB6,F]  186-16-203ms   | [S3,MB7,F]  210-16-227ms   | [S3,MB0,B]  233-23-257ms   | [S3,MB1,B]  256-24-281ms   | [S3,MB2,B]  281-24-305ms   | [S3,MB3,B]  305-24-330ms   | [S3,MB4,B]  330-24-355ms   | [S3,MB5,B]  355-24-379ms   | [S3,MB6,B]  379-24-404ms   | [S3,MB7,B]  404-24-429ms  
[rank0]:2026-01-01 00:29:29,655 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0029_rank0_stage0.svg
[rank0]:	> Counts Sum: 490, Total Sum: 840 (58.33%), Ratio(%) per element: [93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 00:29:29,647 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0029_rank2_stage2.svg
[rank2]:	> Counts Sum: 294, Total Sum: 840 (35.00%), Ratio(%) per element: [93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:29:29,625 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0029_stage3_step200.svg
[rank1]:2026-01-01 00:29:29,668 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0029_rank1_stage1.svg
[rank1]:	> Counts Sum: 98, Total Sum: 1050 (9.33%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:29:29,765 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0029_rank3_stage3.svg
[rank3]:	> Counts Sum: 392, Total Sum: 630 (62.22%), Ratio(%) per element: [93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 00:30:04,817 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.2104e+00
[rank1]:2026-01-01 00:30:04,819 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5259e+00
[rank3]:2026-01-01 00:30:04,818 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.9551e+00
[rank0]:2026-01-01 00:30:04,817 - Freezing Ratio: [Stage0] 0.50, Threshold: 4.6663e+00
[rank3]:2026-01-01 00:30:43,821 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.1281e+00
[rank0]:2026-01-01 00:30:43,820 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.7101e+00
[rank2]:2026-01-01 00:30:43,819 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6355e+00
[rank1]:2026-01-01 00:30:43,825 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.0909e+00
[rank2]:2026-01-01 00:31:07,080 - Avg. fwd time: 12.1834 / Avg. bwd time: 12.6260 / Avg. batch time: 419.2438 (ms) / GPU bubble ratio: 52.66%
[rank1]:2026-01-01 00:31:07,105 - Avg. fwd time: 15.4948 / Avg. bwd time: 16.8026 / Avg. batch time: 457.6689 (ms) / GPU bubble ratio: 43.54%
[rank3]:2026-01-01 00:31:07,061 - Avg. fwd time: 16.5882 / Avg. bwd time: 24.8071 / Avg. batch time: 390.6952 (ms) / GPU bubble ratio: 15.24%
[rank0]:2026-01-01 00:31:07,114 - Avg. fwd time: 13.2950 / Avg. bwd time: 6.8552 / Avg. batch time: 482.0082 (ms) / GPU bubble ratio: 66.56%
[rank0]:2026-01-01 00:31:22,393 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.0884e+00
[rank2]:2026-01-01 00:31:22,393 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.2736e+00
[rank1]:2026-01-01 00:31:22,397 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8145e+00
[rank3]:2026-01-01 00:31:22,393 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4270e+00
[rank1]:2026-01-01 00:32:01,509 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.3087e+00
[rank3]:2026-01-01 00:32:01,507 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8236e+00
[rank0]:2026-01-01 00:32:01,506 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.0958e+00
[rank2]:2026-01-01 00:32:01,505 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5497e+00
[rank0]:2026-01-01 00:32:40,201 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 00:32:40,206 - Freezing Ratio: [Stage0] 0.50, Threshold: 5.0410e+00
[rank2]:2026-01-01 00:32:40,191 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.7877e+00
[rank1]:2026-01-01 00:32:40,206 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9569e+00
[rank3]:2026-01-01 00:32:40,193 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4266e+00
[rank3]:2026-01-01 00:32:44,031 - Avg. fwd time: 16.5872 / Avg. bwd time: 24.7890 / Avg. batch time: 390.5331 (ms) / GPU bubble ratio: 15.24%
[rank0]:2026-01-01 00:32:44,092 - Avg. fwd time: 13.2821 / Avg. bwd time: 6.5908 / Avg. batch time: 481.2310 (ms) / GPU bubble ratio: 66.96%
[rank0]:2026-01-01 00:32:44,096 -  step: 250  loss: -8.0000  grad_norm:  0.4719  memory: 14.51GiB(30.55%)  tps: 8,416  tflops: 65.80  mfu: 21.09%
[rank2]:2026-01-01 00:32:44,051 - Avg. fwd time: 12.1801 / Avg. bwd time: 12.6111 / Avg. batch time: 419.0233 (ms) / GPU bubble ratio: 52.67%
[rank2]:2026-01-01 00:32:44,095 -  step: 250  loss: -8.0000  grad_norm:  0.4719  memory: 13.86GiB(29.17%)  tps: 8,416  tflops: 65.80  mfu: 21.09%
[rank1]:2026-01-01 00:32:44,079 - Avg. fwd time: 15.4958 / Avg. bwd time: 16.7593 / Avg. batch time: 457.2109 (ms) / GPU bubble ratio: 43.56%
[rank1]:2026-01-01 00:32:44,095 -  step: 250  loss: -8.0000  grad_norm:  0.4719  memory: 17.19GiB(36.17%)  tps: 8,416  tflops: 65.80  mfu: 21.09%
[rank3]:2026-01-01 00:32:44,098 -  step: 250  loss: 12.5257  grad_norm:  0.4719  memory: 29.95GiB(63.05%)  tps: 8,416  tflops: 65.80  mfu: 21.09%
[rank0]:2026-01-01 00:33:19,256 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.3301e+00
[rank2]:2026-01-01 00:33:19,256 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4071e+00
[rank1]:2026-01-01 00:33:19,261 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3403e+00
[rank3]:2026-01-01 00:33:19,257 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.0775e+00
[rank0]:2026-01-01 00:33:57,894 - Freezing Ratio: [Stage0] 0.50, Threshold: 1.5931e+00
[rank2]:2026-01-01 00:33:57,893 - Freezing Ratio: [Stage2] 0.25, Threshold: 9.1645e-01
[rank1]:2026-01-01 00:33:57,896 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5100e+00
[rank3]:2026-01-01 00:33:57,894 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.5391e+00
[rank3]:2026-01-01 00:34:22,165 - Avg. fwd time: 16.5859 / Avg. bwd time: 24.7732 / Avg. batch time: 390.3964 (ms) / GPU bubble ratio: 15.25%
[rank0]:2026-01-01 00:34:22,235 - Avg. fwd time: 13.2740 / Avg. bwd time: 6.4204 / Avg. batch time: 481.0968 (ms) / GPU bubble ratio: 67.25%
[rank2]:2026-01-01 00:34:22,186 - Avg. fwd time: 12.1778 / Avg. bwd time: 12.6036 / Avg. batch time: 418.8658 (ms) / GPU bubble ratio: 52.67%
[rank1]:2026-01-01 00:34:22,222 - Avg. fwd time: 15.4976 / Avg. bwd time: 16.7913 / Avg. batch time: 457.2746 (ms) / GPU bubble ratio: 43.51%
[rank3]:2026-01-01 00:34:38,131 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.3518e+00
[rank0]:2026-01-01 00:34:38,130 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.4971e+00
[rank2]:2026-01-01 00:34:38,130 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.3545e+00
[rank1]:2026-01-01 00:34:38,135 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1644e+00
[rank1]:2026-01-01 00:35:16,772 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4459e+00
[rank3]:2026-01-01 00:35:16,772 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.1967e+00
[rank0]:2026-01-01 00:35:16,772 - Freezing Ratio: [Stage0] 0.50, Threshold: 4.2235e+00
[rank2]:2026-01-01 00:35:16,771 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3172e+00
[rank1]:2026-01-01 00:35:56,633 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1020e-01
[rank3]:2026-01-01 00:35:56,624 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.8405e+00
[rank0]:2026-01-01 00:35:56,623 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:35:56,627 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.8037e+00
[rank2]:2026-01-01 00:35:56,623 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3931e+00
[rank3]:2026-01-01 00:36:00,402 - Avg. fwd time: 16.5851 / Avg. bwd time: 24.7605 / Avg. batch time: 390.2835 (ms) / GPU bubble ratio: 15.25%
[rank0]:2026-01-01 00:36:00,458 - Avg. fwd time: 13.2650 / Avg. bwd time: 6.2679 / Avg. batch time: 481.0297 (ms) / GPU bubble ratio: 67.51%
[rank0]:2026-01-01 00:36:00,462 -  step: 300  loss: -8.0000  grad_norm:  0.4188  memory: 14.51GiB(30.55%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank2]:2026-01-01 00:36:00,426 - Avg. fwd time: 12.1760 / Avg. bwd time: 12.5964 / Avg. batch time: 418.7454 (ms) / GPU bubble ratio: 52.67%
[rank2]:2026-01-01 00:36:00,462 -  step: 300  loss: -8.0000  grad_norm:  0.4188  memory: 13.86GiB(29.17%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank2]:2026-01-01 00:36:00,512 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0036_stage2_step300.svg
[rank1]:2026-01-01 00:36:00,448 - Avg. fwd time: 15.4910 / Avg. bwd time: 16.8059 / Avg. batch time: 457.3877 (ms) / GPU bubble ratio: 43.51%
[rank1]:2026-01-01 00:36:00,462 -  step: 300  loss: -8.0000  grad_norm:  0.4188  memory: 17.20GiB(36.20%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank1]:2026-01-01 00:36:00,520 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0036_stage1_step300.svg
[rank3]:2026-01-01 00:36:00,464 -  step: 300  loss: 12.9454  grad_norm:  0.4188  memory: 29.95GiB(63.05%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank0]:2026-01-01 00:36:00,516 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0036_stage0_step300.svg
[rank3]:2026-01-01 00:36:00,602 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0036_step300_rank3.svg
[rank3]:			> Batch Time: 488.48 ms, GPU Bubble Ratio: 68.57%, 45.41%, 59.32%, 32.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-12-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-64ms     | [S0,MB5,F]  65-13-78ms     | [S0,MB6,F]  78-12-91ms     | [S0,MB7,F]  91-14-105ms    | [S0,MB0,B]  298-5-304ms    | [S0,MB1,B]  323-5-329ms    | [S0,MB2,B]  346-5-352ms    | [S0,MB3,B]  373-6-379ms    | [S0,MB4,B]  398-6-404ms    | [S0,MB5,B]  426-6-432ms    | [S0,MB6,B]  451-5-457ms    | [S0,MB7,B]  482-5-488ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-29ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-87ms     | [S1,MB4,F]  95-15-111ms    | [S1,MB5,F]  119-15-135ms   | [S1,MB6,F]  143-15-159ms   | [S1,MB7,F]  167-15-183ms   | [S1,MB0,B]  278-16-295ms   | [S1,MB1,B]  303-16-319ms   | [S1,MB2,B]  327-16-343ms   | [S1,MB3,B]  352-16-368ms   | [S1,MB4,B]  378-16-394ms   | [S1,MB5,B]  403-16-420ms   | [S1,MB6,B]  429-19-449ms   | [S1,MB7,B]  457-24-482ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-12-104ms    | [S2,MB4,F]  116-12-128ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  164-12-176ms   | [S2,MB7,F]  188-12-201ms   | [S2,MB0,B]  262-12-275ms   | [S2,MB1,B]  287-12-299ms   | [S2,MB2,B]  311-12-324ms   | [S2,MB3,B]  336-12-348ms   | [S2,MB4,B]  360-12-373ms   | [S2,MB5,B]  385-12-398ms   | [S2,MB6,B]  410-12-423ms   | [S2,MB7,B]  436-12-448ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  65-16-81ms     | [S3,MB2,F]  89-16-105ms    | [S3,MB3,F]  113-16-129ms   | [S3,MB4,F]  137-16-154ms   | [S3,MB5,F]  161-16-178ms   | [S3,MB6,F]  185-16-202ms   | [S3,MB7,F]  209-16-226ms   | [S3,MB0,B]  232-24-256ms   | [S3,MB1,B]  256-24-280ms   | [S3,MB2,B]  280-24-305ms   | [S3,MB3,B]  305-24-329ms   | [S3,MB4,B]  329-24-354ms   | [S3,MB5,B]  353-24-378ms   | [S3,MB6,B]  378-24-403ms   | [S3,MB7,B]  403-24-428ms  
[rank3]:2026-01-01 00:36:00,647 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0036_stage3_step300.svg
[rank0]:2026-01-01 00:36:00,693 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0036_rank0_stage0.svg
[rank0]:	> Counts Sum: 840, Total Sum: 1400 (60.00%), Ratio(%) per element: [96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 00:36:00,681 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0036_rank2_stage2.svg
[rank2]:	> Counts Sum: 504, Total Sum: 1400 (36.00%), Ratio(%) per element: [96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 00:36:00,721 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0036_rank1_stage1.svg
[rank1]:	> Counts Sum: 266, Total Sum: 1750 (15.20%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:36:00,785 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0036_rank3_stage3.svg
[rank3]:	> Counts Sum: 672, Total Sum: 1050 (64.00%), Ratio(%) per element: [96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 00:36:35,334 - Freezing Ratio: [Stage0] 0.50, Threshold: 2.3652e+00
[rank2]:2026-01-01 00:36:35,333 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.8874e+00
[rank1]:2026-01-01 00:36:35,334 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3753e+00
[rank3]:2026-01-01 00:36:35,335 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8743e+00
[rank0]:2026-01-01 00:37:14,460 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.6822e+00
[rank2]:2026-01-01 00:37:14,459 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7280e+00
[rank1]:2026-01-01 00:37:14,463 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.6035e-01
[rank3]:2026-01-01 00:37:14,460 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.9912e+00
[rank3]:2026-01-01 00:37:37,462 - Avg. fwd time: 16.5854 / Avg. bwd time: 24.7504 / Avg. batch time: 390.2000 (ms) / GPU bubble ratio: 15.25%
[rank0]:2026-01-01 00:37:37,517 - Avg. fwd time: 13.2582 / Avg. bwd time: 6.1001 / Avg. batch time: 480.4637 (ms) / GPU bubble ratio: 67.77%
[rank2]:2026-01-01 00:37:37,483 - Avg. fwd time: 12.1742 / Avg. bwd time: 12.5865 / Avg. batch time: 418.6395 (ms) / GPU bubble ratio: 52.68%
[rank1]:2026-01-01 00:37:37,507 - Avg. fwd time: 15.4817 / Avg. bwd time: 16.7320 / Avg. batch time: 457.0122 (ms) / GPU bubble ratio: 43.61%
[rank3]:2026-01-01 00:37:53,101 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.8531e+00
[rank0]:2026-01-01 00:37:53,102 - Freezing Ratio: [Stage0] 0.50, Threshold: 4.7713e+00
[rank1]:2026-01-01 00:37:53,102 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6836e+00
[rank2]:2026-01-01 00:37:53,101 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.0143e+00
[rank2]:2026-01-01 00:38:32,130 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0391e+00
[rank3]:2026-01-01 00:38:32,131 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.0804e+00
[rank0]:2026-01-01 00:38:32,131 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.8622e+00
[rank1]:2026-01-01 00:38:32,134 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7837e-01
[rank3]:2026-01-01 00:39:10,607 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.1148e+00
[rank1]:2026-01-01 00:39:10,617 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6997e+00
[rank0]:2026-01-01 00:39:10,616 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 00:39:10,620 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.2361e+00
[rank2]:2026-01-01 00:39:10,605 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.4695e+00
[rank3]:2026-01-01 00:39:14,481 - Avg. fwd time: 16.5876 / Avg. bwd time: 24.7459 / Avg. batch time: 390.1792 (ms) / GPU bubble ratio: 15.25%
[rank1]:2026-01-01 00:39:14,527 - Avg. fwd time: 15.4758 / Avg. bwd time: 16.6697 / Avg. batch time: 456.7220 (ms) / GPU bubble ratio: 43.69%
[rank1]:2026-01-01 00:39:14,545 -  step: 350  loss: -8.0000  grad_norm:  0.6207  memory: 17.20GiB(36.20%)  tps: 8,442  tflops: 65.99  mfu: 21.15%
[rank0]:2026-01-01 00:39:14,541 - Avg. fwd time: 13.2518 / Avg. bwd time: 5.9654 / Avg. batch time: 480.0130 (ms) / GPU bubble ratio: 67.97%
[rank0]:2026-01-01 00:39:14,545 -  step: 350  loss: -8.0000  grad_norm:  0.6207  memory: 14.51GiB(30.55%)  tps: 8,442  tflops: 65.99  mfu: 21.15%
[rank2]:2026-01-01 00:39:14,503 - Avg. fwd time: 12.1732 / Avg. bwd time: 12.5796 / Avg. batch time: 418.5871 (ms) / GPU bubble ratio: 52.69%
[rank2]:2026-01-01 00:39:14,545 -  step: 350  loss: -8.0000  grad_norm:  0.6207  memory: 13.86GiB(29.17%)  tps: 8,442  tflops: 65.99  mfu: 21.15%
[rank3]:2026-01-01 00:39:14,547 -  step: 350  loss: 11.1852  grad_norm:  0.6207  memory: 29.95GiB(63.05%)  tps: 8,442  tflops: 65.99  mfu: 21.15%
[rank3]:2026-01-01 00:39:49,643 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4767e+00
[rank1]:2026-01-01 00:39:49,642 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9616e-01
[rank0]:2026-01-01 00:39:49,642 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.3488e+00
[rank2]:2026-01-01 00:39:49,642 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1910e+00
[rank3]:2026-01-01 00:40:28,322 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.3174e+00
[rank1]:2026-01-01 00:40:28,323 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3741e+00
[rank0]:2026-01-01 00:40:28,322 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.7965e+00
[rank2]:2026-01-01 00:40:28,322 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5289e+00
[rank2]:2026-01-01 00:40:51,621 - Avg. fwd time: 12.1726 / Avg. bwd time: 12.5769 / Avg. batch time: 418.5307 (ms) / GPU bubble ratio: 52.69%
[rank3]:2026-01-01 00:40:51,599 - Avg. fwd time: 16.5891 / Avg. bwd time: 24.7407 / Avg. batch time: 390.1459 (ms) / GPU bubble ratio: 15.25%
[rank1]:2026-01-01 00:40:51,646 - Avg. fwd time: 15.4724 / Avg. bwd time: 16.6239 / Avg. batch time: 456.4426 (ms) / GPU bubble ratio: 43.75%
[rank0]:2026-01-01 00:40:51,661 - Avg. fwd time: 13.2473 / Avg. bwd time: 5.8822 / Avg. batch time: 479.6272 (ms) / GPU bubble ratio: 68.09%
[rank3]:2026-01-01 00:41:07,278 - Freezing Ratio: [Stage3] 0.67, Threshold: 8.7581e-01
[rank1]:2026-01-01 00:41:07,278 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.9833e-02
[rank0]:2026-01-01 00:41:07,278 - Freezing Ratio: [Stage0] 0.75, Threshold: 9.8166e-01
[rank2]:2026-01-01 00:41:07,277 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2633e+00
[rank3]:2026-01-01 00:41:45,723 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.0423e+00
[rank1]:2026-01-01 00:41:45,723 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5468e+00
[rank0]:2026-01-01 00:41:45,723 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.3405e+00
[rank2]:2026-01-01 00:41:45,722 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.1594e+00
[rank2]:2026-01-01 00:42:24,746 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3756e+00
[rank3]:2026-01-01 00:42:24,746 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4052e+00
[rank1]:2026-01-01 00:42:24,746 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6756e-01
[rank0]:2026-01-01 00:42:24,746 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:42:24,751 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.4718e+00
[rank3]:2026-01-01 00:42:28,657 - Avg. fwd time: 16.5914 / Avg. bwd time: 24.7376 / Avg. batch time: 390.1372 (ms) / GPU bubble ratio: 15.25%
[rank1]:2026-01-01 00:42:28,703 - Avg. fwd time: 15.4693 / Avg. bwd time: 16.5814 / Avg. batch time: 456.2172 (ms) / GPU bubble ratio: 43.80%
[rank1]:2026-01-01 00:42:28,717 -  step: 400  loss: -8.0000  grad_norm:  0.4782  memory: 17.20GiB(36.20%)  tps: 8,438  tflops: 65.96  mfu: 21.14%
[rank0]:2026-01-01 00:42:28,714 - Avg. fwd time: 13.2425 / Avg. bwd time: 5.8018 / Avg. batch time: 479.2977 (ms) / GPU bubble ratio: 68.21%
[rank0]:2026-01-01 00:42:28,718 -  step: 400  loss: -8.0000  grad_norm:  0.4782  memory: 14.51GiB(30.55%)  tps: 8,438  tflops: 65.96  mfu: 21.14%
[rank2]:2026-01-01 00:42:28,679 - Avg. fwd time: 12.1722 / Avg. bwd time: 12.5739 / Avg. batch time: 418.5024 (ms) / GPU bubble ratio: 52.70%
[rank2]:2026-01-01 00:42:28,717 -  step: 400  loss: -8.0000  grad_norm:  0.4782  memory: 13.86GiB(29.17%)  tps: 8,438  tflops: 65.96  mfu: 21.14%
[rank3]:2026-01-01 00:42:28,719 -  step: 400  loss: 10.2708  grad_norm:  0.4782  memory: 29.95GiB(63.05%)  tps: 8,438  tflops: 65.96  mfu: 21.14%
[rank1]:2026-01-01 00:42:28,774 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0042_stage1_step400.svg
[rank0]:2026-01-01 00:42:28,774 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0042_stage0_step400.svg
[rank2]:2026-01-01 00:42:28,772 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0042_stage2_step400.svg
[rank3]:2026-01-01 00:42:28,856 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0042_step400_rank3.svg
[rank3]:			> Batch Time: 475.19 ms, GPU Bubble Ratio: 67.76%, 46.38%, 58.24%, 30.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-13-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-64ms     | [S0,MB5,F]  65-13-78ms     | [S0,MB6,F]  78-12-91ms     | [S0,MB7,F]  91-14-105ms    | [S0,MB0,B]  299-5-305ms    | [S0,MB1,B]  323-5-329ms    | [S0,MB2,B]  348-5-354ms    | [S0,MB3,B]  373-5-378ms    | [S0,MB4,B]  397-5-403ms    | [S0,MB5,B]  422-5-428ms    | [S0,MB6,B]  447-5-453ms    | [S0,MB7,B]  469-5-475ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-29ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-87ms     | [S1,MB4,F]  95-15-111ms    | [S1,MB5,F]  119-15-134ms   | [S1,MB6,F]  143-15-159ms   | [S1,MB7,F]  168-15-183ms   | [S1,MB0,B]  279-16-295ms   | [S1,MB1,B]  303-16-319ms   | [S1,MB2,B]  328-16-344ms   | [S1,MB3,B]  353-16-369ms   | [S1,MB4,B]  377-16-394ms   | [S1,MB5,B]  402-16-418ms   | [S1,MB6,B]  427-16-443ms   | [S1,MB7,B]  448-16-465ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-12-104ms    | [S2,MB4,F]  116-12-128ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  165-12-177ms   | [S2,MB7,F]  189-12-201ms   | [S2,MB0,B]  263-12-276ms   | [S2,MB1,B]  287-12-300ms   | [S2,MB2,B]  312-12-324ms   | [S2,MB3,B]  337-12-349ms   | [S2,MB4,B]  361-12-374ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  411-12-423ms   | [S2,MB7,B]  432-12-445ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  65-16-81ms     | [S3,MB2,F]  89-16-105ms    | [S3,MB3,F]  113-16-129ms   | [S3,MB4,F]  137-16-154ms   | [S3,MB5,F]  161-16-178ms   | [S3,MB6,F]  186-16-203ms   | [S3,MB7,F]  210-16-227ms   | [S3,MB0,B]  233-23-257ms   | [S3,MB1,B]  257-24-281ms   | [S3,MB2,B]  281-24-305ms   | [S3,MB3,B]  305-24-330ms   | [S3,MB4,B]  330-24-355ms   | [S3,MB5,B]  355-24-380ms   | [S3,MB6,B]  380-24-404ms   | [S3,MB7,B]  404-24-429ms  
[rank2]:2026-01-01 00:42:28,941 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0042_rank2_stage2.svg
[rank2]:	> Counts Sum: 714, Total Sum: 1960 (36.43%), Ratio(%) per element: [97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:42:28,906 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0042_stage3_step400.svg
[rank1]:2026-01-01 00:42:28,954 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0042_rank1_stage1.svg
[rank1]:	> Counts Sum: 546, Total Sum: 2450 (22.29%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 22.85, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 00:42:28,942 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0042_rank0_stage0.svg
[rank0]:	> Counts Sum: 1190, Total Sum: 1960 (60.71%), Ratio(%) per element: [97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:42:29,044 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0042_rank3_stage3.svg
[rank3]:	> Counts Sum: 952, Total Sum: 1470 (64.76%), Ratio(%) per element: [97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:42:50,898 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2026-01-01 00:42:50,964 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2026-01-01 00:42:50,980 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2026-01-01 00:42:50,983 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2026-01-01 00:43:03,618 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.0690e+00
[rank1]:2026-01-01 00:43:03,618 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2728e+00
[rank0]:2026-01-01 00:43:03,618 - Freezing Ratio: [Stage0] 0.50, Threshold: 4.0744e+00
[rank2]:2026-01-01 00:43:03,617 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5676e+00
[rank1]:2026-01-01 00:43:42,414 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3875e-01
[rank0]:2026-01-01 00:43:42,414 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.7846e+00
[rank2]:2026-01-01 00:43:42,413 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3914e+00
[rank3]:2026-01-01 00:43:42,414 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.4614e+00
[rank2]:2026-01-01 00:44:05,579 - Avg. fwd time: 12.1713 / Avg. bwd time: 12.5680 / Avg. batch time: 418.4647 (ms) / GPU bubble ratio: 52.70%
[rank3]:2026-01-01 00:44:05,557 - Avg. fwd time: 16.5920 / Avg. bwd time: 24.7331 / Avg. batch time: 390.1049 (ms) / GPU bubble ratio: 15.25%
[rank1]:2026-01-01 00:44:05,602 - Avg. fwd time: 15.4634 / Avg. bwd time: 16.5321 / Avg. batch time: 455.9876 (ms) / GPU bubble ratio: 43.87%
[rank0]:2026-01-01 00:44:05,614 - Avg. fwd time: 13.2370 / Avg. bwd time: 5.7009 / Avg. batch time: 478.9419 (ms) / GPU bubble ratio: 68.37%
[rank2]:2026-01-01 00:44:20,810 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.0343e+00
[rank3]:2026-01-01 00:44:20,810 - Freezing Ratio: [Stage3] 0.67, Threshold: 6.7053e+00
[rank1]:2026-01-01 00:44:20,811 - Freezing Ratio: [Stage1] 0.00, Threshold: 5.6296e+00
[rank0]:2026-01-01 00:44:20,811 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.5300e+00
[rank0]:2026-01-01 00:44:59,746 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.7537e+00
[rank2]:2026-01-01 00:44:59,745 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.0055e+00
[rank3]:2026-01-01 00:44:59,746 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.1098e+00
[rank1]:2026-01-01 00:44:59,746 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.6479e-01
[rank3]:2026-01-01 00:45:38,331 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.6003e+00
[rank1]:2026-01-01 00:45:38,343 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9365e+00
[rank0]:2026-01-01 00:45:38,341 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 00:45:38,346 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.7378e+00
[rank2]:2026-01-01 00:45:38,330 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3861e+00
[rank3]:2026-01-01 00:45:42,155 - Avg. fwd time: 16.5911 / Avg. bwd time: 24.7272 / Avg. batch time: 390.0473 (ms) / GPU bubble ratio: 15.25%
[rank2]:2026-01-01 00:45:42,178 - Avg. fwd time: 12.1701 / Avg. bwd time: 12.5629 / Avg. batch time: 418.3859 (ms) / GPU bubble ratio: 52.71%
[rank2]:2026-01-01 00:45:42,223 -  step: 450  loss: -8.0000  grad_norm:  0.5015  memory: 13.86GiB(29.17%)  tps: 8,467  tflops: 66.19  mfu: 21.21%
[rank3]:2026-01-01 00:45:42,225 -  step: 450  loss: 12.7476  grad_norm:  0.5015  memory: 29.95GiB(63.05%)  tps: 8,467  tflops: 66.19  mfu: 21.22%
[rank1]:2026-01-01 00:45:42,204 - Avg. fwd time: 15.4580 / Avg. bwd time: 16.4903 / Avg. batch time: 455.7407 (ms) / GPU bubble ratio: 43.92%
[rank1]:2026-01-01 00:45:42,223 -  step: 450  loss: -8.0000  grad_norm:  0.5015  memory: 17.20GiB(36.20%)  tps: 8,467  tflops: 66.19  mfu: 21.21%
[rank0]:2026-01-01 00:45:42,219 - Avg. fwd time: 13.2324 / Avg. bwd time: 5.6181 / Avg. batch time: 478.5913 (ms) / GPU bubble ratio: 68.49%
[rank0]:2026-01-01 00:45:42,223 -  step: 450  loss: -8.0000  grad_norm:  0.5015  memory: 14.51GiB(30.55%)  tps: 8,467  tflops: 66.19  mfu: 21.21%
[rank1]:2026-01-01 00:46:17,220 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3670e-01
[rank0]:2026-01-01 00:46:17,219 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.3286e+00
[rank2]:2026-01-01 00:46:17,219 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0612e+00
[rank3]:2026-01-01 00:46:17,219 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.5427e+00
[rank3]:2026-01-01 00:46:55,644 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4410e+00
[rank1]:2026-01-01 00:46:55,644 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4471e+00
[rank0]:2026-01-01 00:46:55,644 - Freezing Ratio: [Stage0] 0.50, Threshold: 2.9642e+00
[rank2]:2026-01-01 00:46:55,643 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5524e+00
[rank2]:2026-01-01 00:47:19,039 - Avg. fwd time: 12.1693 / Avg. bwd time: 12.5612 / Avg. batch time: 418.3235 (ms) / GPU bubble ratio: 52.71%
[rank3]:2026-01-01 00:47:19,016 - Avg. fwd time: 16.5906 / Avg. bwd time: 24.7220 / Avg. batch time: 390.0006 (ms) / GPU bubble ratio: 15.26%
[rank1]:2026-01-01 00:47:19,065 - Avg. fwd time: 15.4555 / Avg. bwd time: 16.4630 / Avg. batch time: 455.5418 (ms) / GPU bubble ratio: 43.95%
[rank0]:2026-01-01 00:47:19,080 - Avg. fwd time: 13.2289 / Avg. bwd time: 5.5707 / Avg. batch time: 478.3236 (ms) / GPU bubble ratio: 68.56%
[rank1]:2026-01-01 00:47:34,636 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3289e-01
[rank2]:2026-01-01 00:47:34,635 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5253e+00
[rank0]:2026-01-01 00:47:34,636 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.2901e+00
[rank3]:2026-01-01 00:47:34,636 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.5000e+00
[rank2]:2026-01-01 00:48:13,294 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.2016e+00
[rank1]:2026-01-01 00:48:13,295 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9025e+00
[rank0]:2026-01-01 00:48:13,295 - Freezing Ratio: [Stage0] 0.50, Threshold: 5.6874e+00
[rank3]:2026-01-01 00:48:13,295 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.1573e+00
[rank2]:2026-01-01 00:48:52,136 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2680e+00
[rank1]:2026-01-01 00:48:52,137 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1607e-01
[rank0]:2026-01-01 00:48:52,137 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:48:52,141 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.0923e+00
[rank3]:2026-01-01 00:48:52,137 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.5170e+00
[rank2]:2026-01-01 00:48:55,942 - Avg. fwd time: 12.1688 / Avg. bwd time: 12.5593 / Avg. batch time: 418.2752 (ms) / GPU bubble ratio: 52.70%
[rank1]:2026-01-01 00:48:55,968 - Avg. fwd time: 15.4532 / Avg. bwd time: 16.4364 / Avg. batch time: 455.3688 (ms) / GPU bubble ratio: 43.98%
[rank0]:2026-01-01 00:48:55,980 - Avg. fwd time: 13.2258 / Avg. bwd time: 5.5217 / Avg. batch time: 478.0853 (ms) / GPU bubble ratio: 68.63%
[rank0]:2026-01-01 00:48:55,984 -  step: 500  loss: -8.0000  grad_norm:  0.4140  memory: 14.51GiB(30.55%)  tps: 8,456  tflops: 66.10  mfu: 21.19%
[rank3]:2026-01-01 00:48:55,919 - Avg. fwd time: 16.5906 / Avg. bwd time: 24.7180 / Avg. batch time: 389.9660 (ms) / GPU bubble ratio: 15.26%
[rank3]:2026-01-01 00:48:55,986 -  step: 500  loss: 12.9574  grad_norm:  0.4140  memory: 29.95GiB(63.05%)  tps: 8,456  tflops: 66.10  mfu: 21.19%
[rank2]:2026-01-01 00:48:55,983 -  step: 500  loss: -8.0000  grad_norm:  0.4140  memory: 13.86GiB(29.17%)  tps: 8,456  tflops: 66.10  mfu: 21.19%
[rank2]:2026-01-01 00:48:56,034 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0048_stage2_step500.svg
[rank1]:2026-01-01 00:48:55,983 -  step: 500  loss: -8.0000  grad_norm:  0.4140  memory: 17.20GiB(36.20%)  tps: 8,456  tflops: 66.10  mfu: 21.19%
[rank1]:2026-01-01 00:48:56,038 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0048_stage1_step500.svg
[rank0]:2026-01-01 00:48:56,037 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0048_stage0_step500.svg
[rank3]:2026-01-01 00:48:56,122 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0048_step500_rank3.svg
[rank3]:			> Batch Time: 475.96 ms, GPU Bubble Ratio: 67.74%, 46.26%, 58.22%, 30.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-13-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-65ms     | [S0,MB5,F]  65-13-78ms     | [S0,MB6,F]  79-12-91ms     | [S0,MB7,F]  91-14-105ms    | [S0,MB0,B]  299-5-305ms    | [S0,MB1,B]  323-5-329ms    | [S0,MB2,B]  348-5-353ms    | [S0,MB3,B]  371-6-377ms    | [S0,MB4,B]  396-6-402ms    | [S0,MB5,B]  421-6-427ms    | [S0,MB6,B]  446-6-452ms    | [S0,MB7,B]  470-5-475ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-29ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-87ms     | [S1,MB4,F]  95-15-111ms    | [S1,MB5,F]  119-15-135ms   | [S1,MB6,F]  143-15-159ms   | [S1,MB7,F]  168-15-183ms   | [S1,MB0,B]  279-16-296ms   | [S1,MB1,B]  303-16-320ms   | [S1,MB2,B]  327-16-344ms   | [S1,MB3,B]  351-16-368ms   | [S1,MB4,B]  376-16-393ms   | [S1,MB5,B]  401-16-418ms   | [S1,MB6,B]  426-16-442ms   | [S1,MB7,B]  448-16-465ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-12-104ms    | [S2,MB4,F]  116-12-128ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  164-12-177ms   | [S2,MB7,F]  189-12-201ms   | [S2,MB0,B]  263-12-276ms   | [S2,MB1,B]  287-12-300ms   | [S2,MB2,B]  312-12-324ms   | [S2,MB3,B]  336-12-348ms   | [S2,MB4,B]  360-12-373ms   | [S2,MB5,B]  385-12-398ms   | [S2,MB6,B]  410-12-423ms   | [S2,MB7,B]  432-12-444ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  65-16-81ms     | [S3,MB2,F]  89-16-105ms    | [S3,MB3,F]  113-16-129ms   | [S3,MB4,F]  137-16-154ms   | [S3,MB5,F]  161-16-178ms   | [S3,MB6,F]  186-16-202ms   | [S3,MB7,F]  210-16-226ms   | [S3,MB0,B]  232-23-256ms   | [S3,MB1,B]  256-24-281ms   | [S3,MB2,B]  281-24-305ms   | [S3,MB3,B]  305-24-329ms   | [S3,MB4,B]  329-24-354ms   | [S3,MB5,B]  354-24-379ms   | [S3,MB6,B]  378-25-403ms   | [S3,MB7,B]  403-24-428ms  
[rank3]:2026-01-01 00:48:56,167 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0048_stage3_step500.svg
[rank2]:2026-01-01 00:48:56,199 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0048_rank2_stage2.svg
[rank2]:	> Counts Sum: 924, Total Sum: 2520 (36.67%), Ratio(%) per element: [97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 00:48:56,219 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0048_rank1_stage1.svg
[rank1]:	> Counts Sum: 826, Total Sum: 3150 (26.22%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 28.88, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 00:48:56,206 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0048_rank0_stage0.svg
[rank0]:	> Counts Sum: 1540, Total Sum: 2520 (61.11%), Ratio(%) per element: [97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:48:56,311 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0048_rank3_stage3.svg
[rank3]:	> Counts Sum: 1232, Total Sum: 1890 (65.19%), Ratio(%) per element: [97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 97.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:49:31,061 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.3063e+00
[rank2]:2026-01-01 00:49:31,060 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.2988e+00
[rank1]:2026-01-01 00:49:31,061 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5940e+00
[rank0]:2026-01-01 00:49:31,062 - Freezing Ratio: [Stage0] 0.50, Threshold: 1.8150e+00
[rank1]:2026-01-01 00:50:10,224 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1464e+00
[rank2]:2026-01-01 00:50:10,223 - Freezing Ratio: [Stage2] 0.50, Threshold: 6.3598e+00
[rank0]:2026-01-01 00:50:10,224 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.7570e+00
[rank3]:2026-01-01 00:50:10,223 - Freezing Ratio: [Stage3] 0.67, Threshold: 5.7141e+00
[rank2]:2026-01-01 00:50:33,375 - Avg. fwd time: 12.1681 / Avg. bwd time: 12.5550 / Avg. batch time: 418.2433 (ms) / GPU bubble ratio: 52.71%
[rank0]:2026-01-01 00:50:33,414 - Avg. fwd time: 13.2806 / Avg. bwd time: 5.4534 / Avg. batch time: 477.9408 (ms) / GPU bubble ratio: 68.64%
[rank3]:2026-01-01 00:50:33,351 - Avg. fwd time: 16.5908 / Avg. bwd time: 24.7142 / Avg. batch time: 389.9349 (ms) / GPU bubble ratio: 15.26%
[rank1]:2026-01-01 00:50:33,401 - Avg. fwd time: 15.4490 / Avg. bwd time: 16.4032 / Avg. batch time: 455.2106 (ms) / GPU bubble ratio: 44.02%
[rank3]:2026-01-01 00:50:49,059 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.6599e+00
[rank2]:2026-01-01 00:50:49,058 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.9902e+00
[rank1]:2026-01-01 00:50:49,059 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7090e+00
[rank0]:2026-01-01 00:50:49,059 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.9584e+00
[rank0]:2026-01-01 00:51:28,086 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.6129e+00
[rank3]:2026-01-01 00:51:28,086 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.0636e+00
[rank2]:2026-01-01 00:51:28,085 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4087e+00
[rank1]:2026-01-01 00:51:28,086 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5100e-01
[rank2]:2026-01-01 00:52:06,585 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.3325e+00
[rank0]:2026-01-01 00:52:06,595 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 00:52:06,600 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.3296e+00
[rank3]:2026-01-01 00:52:06,587 - Freezing Ratio: [Stage3] 0.67, Threshold: 5.2399e+00
[rank1]:2026-01-01 00:52:06,597 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1926e+00
[rank3]:2026-01-01 00:52:10,478 - Avg. fwd time: 16.5915 / Avg. bwd time: 24.7126 / Avg. batch time: 389.9257 (ms) / GPU bubble ratio: 15.26%
[rank0]:2026-01-01 00:52:10,545 - Avg. fwd time: 13.3083 / Avg. bwd time: 5.3970 / Avg. batch time: 477.7858 (ms) / GPU bubble ratio: 68.68%
[rank0]:2026-01-01 00:52:10,549 -  step: 550  loss: -8.0000  grad_norm:  0.5913  memory: 14.51GiB(30.55%)  tps: 8,421  tflops: 65.83  mfu: 21.10%
[rank3]:2026-01-01 00:52:10,551 -  step: 550  loss: 11.0947  grad_norm:  0.5913  memory: 29.95GiB(63.05%)  tps: 8,421  tflops: 65.83  mfu: 21.10%
[rank1]:2026-01-01 00:52:10,529 - Avg. fwd time: 15.4458 / Avg. bwd time: 16.3755 / Avg. batch time: 455.0762 (ms) / GPU bubble ratio: 44.06%
[rank1]:2026-01-01 00:52:10,548 -  step: 550  loss: -8.0000  grad_norm:  0.5913  memory: 17.20GiB(36.20%)  tps: 8,421  tflops: 65.83  mfu: 21.10%
[rank2]:2026-01-01 00:52:10,502 - Avg. fwd time: 12.1675 / Avg. bwd time: 12.5517 / Avg. batch time: 418.2203 (ms) / GPU bubble ratio: 52.72%
[rank2]:2026-01-01 00:52:10,548 -  step: 550  loss: -8.0000  grad_norm:  0.5913  memory: 13.86GiB(29.17%)  tps: 8,421  tflops: 65.83  mfu: 21.10%
[rank0]:2026-01-01 00:52:45,670 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.2963e+00
[rank1]:2026-01-01 00:52:45,670 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6742e-01
[rank3]:2026-01-01 00:52:45,671 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.7279e+00
[rank2]:2026-01-01 00:52:45,669 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0840e+00
[rank0]:2026-01-01 00:53:24,312 - Freezing Ratio: [Stage0] 0.50, Threshold: 5.4613e+00
[rank1]:2026-01-01 00:53:24,312 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8982e+00
[rank3]:2026-01-01 00:53:24,312 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.7710e+00
[rank2]:2026-01-01 00:53:24,312 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.0238e+00
[rank3]:2026-01-01 00:53:47,508 - Avg. fwd time: 16.5921 / Avg. bwd time: 24.7106 / Avg. batch time: 389.9134 (ms) / GPU bubble ratio: 15.26%
[rank0]:2026-01-01 00:53:47,578 - Avg. fwd time: 13.3028 / Avg. bwd time: 5.3674 / Avg. batch time: 477.6282 (ms) / GPU bubble ratio: 68.73%
[rank1]:2026-01-01 00:53:47,561 - Avg. fwd time: 15.4449 / Avg. bwd time: 16.3586 / Avg. batch time: 454.9664 (ms) / GPU bubble ratio: 44.08%
[rank2]:2026-01-01 00:53:47,533 - Avg. fwd time: 12.1673 / Avg. bwd time: 12.5511 / Avg. batch time: 418.1989 (ms) / GPU bubble ratio: 52.71%
[rank0]:2026-01-01 00:54:03,185 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.8278e+00
[rank1]:2026-01-01 00:54:03,185 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7560e-01
[rank3]:2026-01-01 00:54:03,185 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.8304e+00
[rank2]:2026-01-01 00:54:03,184 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5746e+00
[rank0]:2026-01-01 00:54:41,631 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.2343e+00
[rank1]:2026-01-01 00:54:41,631 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1650e+00
[rank3]:2026-01-01 00:54:41,631 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.4438e+00
[rank2]:2026-01-01 00:54:41,630 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3830e+00
[rank0]:2026-01-01 00:55:20,611 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 00:55:20,615 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.7058e+00
[rank1]:2026-01-01 00:55:20,611 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0474e-01
[rank3]:2026-01-01 00:55:20,611 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8024e+00
[rank2]:2026-01-01 00:55:20,610 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7006e+00
[rank3]:2026-01-01 00:55:24,533 - Avg. fwd time: 16.5930 / Avg. bwd time: 24.7089 / Avg. batch time: 389.9052 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 00:55:24,557 - Avg. fwd time: 12.1671 / Avg. bwd time: 12.5500 / Avg. batch time: 418.1810 (ms) / GPU bubble ratio: 52.71%
[rank0]:2026-01-01 00:55:24,597 - Avg. fwd time: 13.2974 / Avg. bwd time: 5.3352 / Avg. batch time: 477.4806 (ms) / GPU bubble ratio: 68.78%
[rank0]:2026-01-01 00:55:24,601 -  step: 600  loss: -8.0000  grad_norm:  0.4307  memory: 14.51GiB(30.55%)  tps: 8,443  tflops: 66.00  mfu: 21.16%
[rank1]:2026-01-01 00:55:24,584 - Avg. fwd time: 15.4440 / Avg. bwd time: 16.3411 / Avg. batch time: 454.8638 (ms) / GPU bubble ratio: 44.10%
[rank1]:2026-01-01 00:55:24,600 -  step: 600  loss: -8.0000  grad_norm:  0.4307  memory: 17.20GiB(36.20%)  tps: 8,443  tflops: 66.00  mfu: 21.16%
[rank3]:2026-01-01 00:55:24,603 -  step: 600  loss: 10.0019  grad_norm:  0.4307  memory: 29.95GiB(63.05%)  tps: 8,443  tflops: 66.01  mfu: 21.16%
[rank2]:2026-01-01 00:55:24,600 -  step: 600  loss: -8.0000  grad_norm:  0.4307  memory: 13.86GiB(29.17%)  tps: 8,443  tflops: 66.00  mfu: 21.16%
[rank2]:2026-01-01 00:55:24,652 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0055_stage2_step600.svg
[rank0]:2026-01-01 00:55:24,657 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0055_stage0_step600.svg
[rank1]:2026-01-01 00:55:24,657 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0055_stage1_step600.svg
[rank3]:2026-01-01 00:55:24,740 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0055_step600_rank3.svg
[rank3]:			> Batch Time: 474.19 ms, GPU Bubble Ratio: 67.67%, 46.25%, 58.18%, 30.63%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-12-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-65ms     | [S0,MB5,F]  65-13-78ms     | [S0,MB6,F]  78-12-91ms     | [S0,MB7,F]  91-13-105ms    | [S0,MB0,B]  298-5-304ms    | [S0,MB1,B]  323-5-328ms    | [S0,MB2,B]  347-5-353ms    | [S0,MB3,B]  372-5-378ms    | [S0,MB4,B]  396-6-402ms    | [S0,MB5,B]  421-5-427ms    | [S0,MB6,B]  446-5-452ms    | [S0,MB7,B]  468-5-474ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-29ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-87ms     | [S1,MB4,F]  95-15-111ms    | [S1,MB5,F]  119-15-134ms   | [S1,MB6,F]  143-15-159ms   | [S1,MB7,F]  167-15-183ms   | [S1,MB0,B]  279-16-295ms   | [S1,MB1,B]  303-16-319ms   | [S1,MB2,B]  327-16-344ms   | [S1,MB3,B]  352-16-369ms   | [S1,MB4,B]  376-16-393ms   | [S1,MB5,B]  401-16-418ms   | [S1,MB6,B]  426-16-443ms   | [S1,MB7,B]  447-16-464ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  29-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-12-104ms    | [S2,MB4,F]  116-12-128ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  164-12-176ms   | [S2,MB7,F]  189-12-201ms   | [S2,MB0,B]  263-12-275ms   | [S2,MB1,B]  287-12-300ms   | [S2,MB2,B]  311-12-324ms   | [S2,MB3,B]  336-12-349ms   | [S2,MB4,B]  361-12-373ms   | [S2,MB5,B]  385-12-398ms   | [S2,MB6,B]  410-12-423ms   | [S2,MB7,B]  432-12-444ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  65-16-81ms     | [S3,MB2,F]  89-16-105ms    | [S3,MB3,F]  113-16-129ms   | [S3,MB4,F]  137-16-154ms   | [S3,MB5,F]  161-16-178ms   | [S3,MB6,F]  186-16-202ms   | [S3,MB7,F]  210-16-227ms   | [S3,MB0,B]  232-23-256ms   | [S3,MB1,B]  256-24-280ms   | [S3,MB2,B]  281-24-305ms   | [S3,MB3,B]  305-24-329ms   | [S3,MB4,B]  329-24-354ms   | [S3,MB5,B]  354-24-379ms   | [S3,MB6,B]  379-24-404ms   | [S3,MB7,B]  404-24-429ms  
[rank3]:2026-01-01 00:55:24,787 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0055_stage3_step600.svg
[rank2]:2026-01-01 00:55:24,818 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0055_rank2_stage2.svg
[rank2]:	> Counts Sum: 1134, Total Sum: 3080 (36.82%), Ratio(%) per element: [98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 00:55:24,833 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0055_rank0_stage0.svg
[rank0]:	> Counts Sum: 1890, Total Sum: 3080 (61.36%), Ratio(%) per element: [98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 00:55:24,843 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0055_rank1_stage1.svg
[rank1]:	> Counts Sum: 1106, Total Sum: 3850 (28.73%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:55:24,925 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0055_rank3_stage3.svg
[rank3]:	> Counts Sum: 1512, Total Sum: 2310 (65.45%), Ratio(%) per element: [98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 98.18, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 00:55:59,584 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.9359e+00
[rank2]:2026-01-01 00:55:59,584 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.1646e+00
[rank0]:2026-01-01 00:55:59,584 - Freezing Ratio: [Stage0] 0.50, Threshold: 5.4388e+00
[rank1]:2026-01-01 00:55:59,584 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8112e+00
[rank0]:2026-01-01 00:56:38,410 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.1277e+00
[rank1]:2026-01-01 00:56:38,410 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4026e-01
[rank3]:2026-01-01 00:56:38,410 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.6678e+00
[rank2]:2026-01-01 00:56:38,409 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6005e+00
[rank1]:2026-01-01 00:57:01,642 - Avg. fwd time: 15.4410 / Avg. bwd time: 16.3173 / Avg. batch time: 454.7577 (ms) / GPU bubble ratio: 44.13%
[rank3]:2026-01-01 00:57:01,591 - Avg. fwd time: 16.5932 / Avg. bwd time: 24.7068 / Avg. batch time: 389.8874 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 00:57:01,615 - Avg. fwd time: 12.1666 / Avg. bwd time: 12.5467 / Avg. batch time: 418.1630 (ms) / GPU bubble ratio: 52.72%
[rank0]:2026-01-01 00:57:01,655 - Avg. fwd time: 13.2923 / Avg. bwd time: 5.2853 / Avg. batch time: 477.3144 (ms) / GPU bubble ratio: 68.86%
[rank0]:2026-01-01 00:57:16,936 - Freezing Ratio: [Stage0] 0.50, Threshold: 1.9678e+00
[rank1]:2026-01-01 00:57:16,936 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9468e+00
[rank2]:2026-01-01 00:57:16,935 - Freezing Ratio: [Stage2] 0.25, Threshold: 6.1801e-01
[rank3]:2026-01-01 00:57:16,936 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.6253e+00
[rank0]:2026-01-01 00:57:56,186 - Freezing Ratio: [Stage0] 0.75, Threshold: 4.2366e+00
[rank2]:2026-01-01 00:57:56,185 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.9726e+00
[rank1]:2026-01-01 00:57:56,188 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.4042e-01
[rank3]:2026-01-01 00:57:56,186 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.1070e+00
[rank2]:2026-01-01 00:58:34,924 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.8042e+00
[rank0]:2026-01-01 00:58:34,934 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 00:58:34,940 - Freezing Ratio: [Stage0] 0.50, Threshold: 4.7749e+00
[rank1]:2026-01-01 00:58:34,936 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2405e+00
[rank3]:2026-01-01 00:58:34,925 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.8840e+00
[rank3]:2026-01-01 00:58:38,795 - Avg. fwd time: 16.5936 / Avg. bwd time: 24.7052 / Avg. batch time: 389.8783 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 00:58:38,821 - Avg. fwd time: 12.1661 / Avg. bwd time: 12.5443 / Avg. batch time: 418.1442 (ms) / GPU bubble ratio: 52.72%
[rank2]:2026-01-01 00:58:38,871 -  step: 650  loss: -8.0000  grad_norm:  0.5109  memory: 13.86GiB(29.17%)  tps: 8,434  tflops: 65.93  mfu: 21.13%
[rank0]:2026-01-01 00:58:38,867 - Avg. fwd time: 13.2961 / Avg. bwd time: 5.2441 / Avg. batch time: 477.2207 (ms) / GPU bubble ratio: 68.92%
[rank0]:2026-01-01 00:58:38,872 -  step: 650  loss: -8.0000  grad_norm:  0.5109  memory: 14.51GiB(30.55%)  tps: 8,434  tflops: 65.93  mfu: 21.13%
[rank1]:2026-01-01 00:58:38,850 - Avg. fwd time: 15.4395 / Avg. bwd time: 16.3024 / Avg. batch time: 454.6976 (ms) / GPU bubble ratio: 44.15%
[rank1]:2026-01-01 00:58:38,871 -  step: 650  loss: -8.0000  grad_norm:  0.5109  memory: 17.20GiB(36.20%)  tps: 8,434  tflops: 65.93  mfu: 21.13%
[rank3]:2026-01-01 00:58:38,874 -  step: 650  loss: 12.3049  grad_norm:  0.5109  memory: 29.95GiB(63.05%)  tps: 8,434  tflops: 65.93  mfu: 21.13%
[rank0]:2026-01-01 00:59:14,129 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.9782e+00
[rank3]:2026-01-01 00:59:14,129 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8583e+00
[rank1]:2026-01-01 00:59:14,133 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7631e-01
[rank2]:2026-01-01 00:59:14,128 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3418e+00
[rank2]:2026-01-01 00:59:52,542 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.2887e+00
[rank0]:2026-01-01 00:59:52,543 - Freezing Ratio: [Stage0] 0.50, Threshold: 2.8407e+00
[rank3]:2026-01-01 00:59:52,543 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8229e+00
[rank1]:2026-01-01 00:59:52,543 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2273e+00
[rank3]:2026-01-01 01:00:16,403 - Avg. fwd time: 16.5938 / Avg. bwd time: 24.7032 / Avg. batch time: 389.8652 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 01:00:16,428 - Avg. fwd time: 12.1650 / Avg. bwd time: 12.5404 / Avg. batch time: 418.1237 (ms) / GPU bubble ratio: 52.73%
[rank0]:2026-01-01 01:00:16,492 - Avg. fwd time: 13.3006 / Avg. bwd time: 5.2247 / Avg. batch time: 477.2175 (ms) / GPU bubble ratio: 68.94%
[rank1]:2026-01-01 01:00:16,474 - Avg. fwd time: 15.4399 / Avg. bwd time: 16.3051 / Avg. batch time: 454.7056 (ms) / GPU bubble ratio: 44.15%
[rank3]:2026-01-01 01:00:32,309 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.8876e+00
[rank0]:2026-01-01 01:00:32,309 - Freezing Ratio: [Stage0] 0.75, Threshold: 5.2714e+00
[rank1]:2026-01-01 01:00:32,314 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.7458e-01
[rank2]:2026-01-01 01:00:32,308 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7454e+00
[rank2]:2026-01-01 01:01:10,921 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.1570e+00
[rank3]:2026-01-01 01:01:10,922 - Freezing Ratio: [Stage3] 0.67, Threshold: 5.5621e+00
[rank0]:2026-01-01 01:01:10,922 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.6904e+00
[rank1]:2026-01-01 01:01:10,922 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1361e+00
[rank2]:2026-01-01 01:01:50,073 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5264e-01
[rank3]:2026-01-01 01:01:50,074 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.3393e+00
[rank1]:2026-01-01 01:01:50,078 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3389e-01
[rank0]:2026-01-01 01:01:50,074 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 01:01:50,078 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.3545e+00
[rank3]:2026-01-01 01:01:53,841 - Avg. fwd time: 16.5936 / Avg. bwd time: 24.7011 / Avg. batch time: 389.8465 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 01:01:53,866 - Avg. fwd time: 12.1637 / Avg. bwd time: 12.5359 / Avg. batch time: 418.1010 (ms) / GPU bubble ratio: 52.74%
[rank2]:2026-01-01 01:01:53,911 -  step: 700  loss: -8.0000  grad_norm:  0.4125  memory: 13.86GiB(29.17%)  tps: 8,400  tflops: 65.67  mfu: 21.05%
[rank3]:2026-01-01 01:01:53,914 -  step: 700  loss: 13.1107  grad_norm:  0.4125  memory: 29.95GiB(63.05%)  tps: 8,400  tflops: 65.67  mfu: 21.05%
[rank1]:2026-01-01 01:01:53,893 - Avg. fwd time: 15.4393 / Avg. bwd time: 16.3038 / Avg. batch time: 454.6984 (ms) / GPU bubble ratio: 44.15%
[rank1]:2026-01-01 01:01:53,911 -  step: 700  loss: -8.0000  grad_norm:  0.4125  memory: 17.20GiB(36.20%)  tps: 8,400  tflops: 65.67  mfu: 21.05%
[rank0]:2026-01-01 01:01:53,908 - Avg. fwd time: 13.2953 / Avg. bwd time: 5.2020 / Avg. batch time: 477.1797 (ms) / GPU bubble ratio: 68.99%
[rank0]:2026-01-01 01:01:53,911 -  step: 700  loss: -8.0000  grad_norm:  0.4125  memory: 14.51GiB(30.55%)  tps: 8,400  tflops: 65.67  mfu: 21.05%
[rank2]:2026-01-01 01:01:53,968 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0101_stage2_step700.svg
[rank1]:2026-01-01 01:01:53,970 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0101_stage1_step700.svg
[rank0]:2026-01-01 01:01:53,969 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0101_stage0_step700.svg
[rank3]:2026-01-01 01:01:54,050 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0101_step700_rank3.svg
[rank3]:			> Batch Time: 481.22 ms, GPU Bubble Ratio: 68.13%, 46.76%, 58.67%, 31.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-12-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-64ms     | [S0,MB5,F]  64-13-78ms     | [S0,MB6,F]  78-12-91ms     | [S0,MB7,F]  91-14-105ms    | [S0,MB0,B]  298-5-304ms    | [S0,MB1,B]  323-5-329ms    | [S0,MB2,B]  347-5-353ms    | [S0,MB3,B]  372-6-378ms    | [S0,MB4,B]  397-6-403ms    | [S0,MB5,B]  422-6-428ms    | [S0,MB6,B]  448-6-454ms    | [S0,MB7,B]  475-5-481ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-28ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-86ms     | [S1,MB4,F]  95-15-110ms    | [S1,MB5,F]  119-15-134ms   | [S1,MB6,F]  143-15-158ms   | [S1,MB7,F]  167-15-182ms   | [S1,MB0,B]  279-16-295ms   | [S1,MB1,B]  303-16-319ms   | [S1,MB2,B]  327-16-343ms   | [S1,MB3,B]  352-16-368ms   | [S1,MB4,B]  376-16-393ms   | [S1,MB5,B]  401-16-418ms   | [S1,MB6,B]  427-16-443ms   | [S1,MB7,B]  450-17-467ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-12-104ms    | [S2,MB4,F]  116-12-128ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  164-12-176ms   | [S2,MB7,F]  188-12-200ms   | [S2,MB0,B]  263-12-275ms   | [S2,MB1,B]  287-12-300ms   | [S2,MB2,B]  311-12-324ms   | [S2,MB3,B]  336-12-348ms   | [S2,MB4,B]  360-12-373ms   | [S2,MB5,B]  385-12-398ms   | [S2,MB6,B]  411-12-423ms   | [S2,MB7,B]  433-12-446ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  65-16-81ms     | [S3,MB2,F]  89-16-105ms    | [S3,MB3,F]  112-16-129ms   | [S3,MB4,F]  137-16-153ms   | [S3,MB5,F]  161-16-178ms   | [S3,MB6,F]  185-16-202ms   | [S3,MB7,F]  210-16-227ms   | [S3,MB0,B]  233-23-256ms   | [S3,MB1,B]  256-24-281ms   | [S3,MB2,B]  280-24-305ms   | [S3,MB3,B]  304-24-329ms   | [S3,MB4,B]  329-24-354ms   | [S3,MB5,B]  354-24-379ms   | [S3,MB6,B]  378-24-403ms   | [S3,MB7,B]  404-24-429ms  
[rank3]:2026-01-01 01:01:54,098 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0101_stage3_step700.svg
[rank0]:2026-01-01 01:01:54,144 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0101_rank0_stage0.svg
[rank0]:	> Counts Sum: 2240, Total Sum: 3640 (61.54%), Ratio(%) per element: [98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 01:01:54,138 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0101_rank2_stage2.svg
[rank2]:	> Counts Sum: 1386, Total Sum: 3640 (38.08%), Ratio(%) per element: [98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 01:01:54,239 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0101_rank3_stage3.svg
[rank3]:	> Counts Sum: 1792, Total Sum: 2730 (65.64%), Ratio(%) per element: [98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 98.46, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-01 01:01:54,159 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0101_rank1_stage1.svg
[rank1]:	> Counts Sum: 1386, Total Sum: 4550 (30.46%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 01:02:28,931 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.4737e+00
[rank1]:2026-01-01 01:02:28,932 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7246e+00
[rank3]:2026-01-01 01:02:28,931 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.3914e+00
[rank0]:2026-01-01 01:02:28,933 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.7856e+00
[rank1]:2026-01-01 01:03:08,128 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.9078e-01
[rank3]:2026-01-01 01:03:08,124 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.0452e+00
[rank0]:2026-01-01 01:03:08,124 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.2189e+00
[rank2]:2026-01-01 01:03:08,123 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1888e+00
[rank3]:2026-01-01 01:03:31,134 - Avg. fwd time: 16.5936 / Avg. bwd time: 24.6994 / Avg. batch time: 389.8321 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 01:03:31,159 - Avg. fwd time: 12.1620 / Avg. bwd time: 12.5286 / Avg. batch time: 418.0785 (ms) / GPU bubble ratio: 52.75%
[rank1]:2026-01-01 01:03:31,187 - Avg. fwd time: 15.4377 / Avg. bwd time: 16.2866 / Avg. batch time: 454.6212 (ms) / GPU bubble ratio: 44.17%
[rank0]:2026-01-01 01:03:31,202 - Avg. fwd time: 13.3035 / Avg. bwd time: 5.1636 / Avg. batch time: 477.0783 (ms) / GPU bubble ratio: 69.03%
[rank2]:2026-01-01 01:03:46,758 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.6526e+00
[rank1]:2026-01-01 01:03:46,759 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3520e+00
[rank0]:2026-01-01 01:03:46,759 - Freezing Ratio: [Stage0] 0.50, Threshold: 3.9888e+00
[rank3]:2026-01-01 01:03:46,759 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.7885e+00
[rank2]:2026-01-01 01:04:26,271 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2440e+00
[rank1]:2026-01-01 01:04:26,278 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6196e-01
[rank0]:2026-01-01 01:04:26,271 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.0977e+00
[rank3]:2026-01-01 01:04:26,272 - Freezing Ratio: [Stage3] 0.67, Threshold: 9.3480e-01
[rank2]:2026-01-01 01:05:04,721 - Freezing Ratio: [Stage2] 0.25, Threshold: 9.3512e-01
[rank1]:2026-01-01 01:05:04,733 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1875e+00
[rank0]:2026-01-01 01:05:04,731 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-01 01:05:04,736 - Freezing Ratio: [Stage0] 0.50, Threshold: 2.2250e+00
[rank3]:2026-01-01 01:05:04,723 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.8150e+00
[rank3]:2026-01-01 01:05:08,859 - Avg. fwd time: 16.5937 / Avg. bwd time: 24.6980 / Avg. batch time: 389.8239 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 01:05:08,885 - Avg. fwd time: 12.1605 / Avg. bwd time: 12.5226 / Avg. batch time: 418.0589 (ms) / GPU bubble ratio: 52.77%
[rank2]:2026-01-01 01:05:08,947 -  step: 750  loss: -8.0000  grad_norm:  0.5412  memory: 13.86GiB(29.17%)  tps: 8,401  tflops: 65.67  mfu: 21.05%
[rank1]:2026-01-01 01:05:08,926 - Avg. fwd time: 15.4373 / Avg. bwd time: 16.2912 / Avg. batch time: 454.6841 (ms) / GPU bubble ratio: 44.17%
[rank1]:2026-01-01 01:05:08,947 -  step: 750  loss: -8.0000  grad_norm:  0.5412  memory: 17.20GiB(36.20%)  tps: 8,401  tflops: 65.67  mfu: 21.05%
[rank0]:2026-01-01 01:05:08,944 - Avg. fwd time: 13.2984 / Avg. bwd time: 5.1319 / Avg. batch time: 477.1005 (ms) / GPU bubble ratio: 69.10%
[rank0]:2026-01-01 01:05:08,948 -  step: 750  loss: -8.0000  grad_norm:  0.5412  memory: 14.51GiB(30.55%)  tps: 8,401  tflops: 65.67  mfu: 21.05%
[rank3]:2026-01-01 01:05:08,950 -  step: 750  loss: 11.0703  grad_norm:  0.5412  memory: 29.95GiB(63.05%)  tps: 8,401  tflops: 65.67  mfu: 21.05%
[rank2]:2026-01-01 01:05:44,790 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1848e-01
[rank1]:2026-01-01 01:05:44,794 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5161e-01
[rank0]:2026-01-01 01:05:44,791 - Freezing Ratio: [Stage0] 0.75, Threshold: 2.7080e+00
[rank3]:2026-01-01 01:05:44,791 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.2743e+00
[rank2]:2026-01-01 01:06:23,369 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5286e+00
[rank1]:2026-01-01 01:06:23,369 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3236e+00
[rank0]:2026-01-01 01:06:23,369 - Freezing Ratio: [Stage0] 0.50, Threshold: 4.1722e+00
[rank3]:2026-01-01 01:06:23,369 - Freezing Ratio: [Stage3] 0.67, Threshold: 3.8827e+00
[rank3]:2026-01-01 01:06:46,806 - Avg. fwd time: 16.5936 / Avg. bwd time: 24.6961 / Avg. batch time: 389.8099 (ms) / GPU bubble ratio: 15.26%
[rank2]:2026-01-01 01:06:46,832 - Avg. fwd time: 12.1597 / Avg. bwd time: 12.5199 / Avg. batch time: 418.0424 (ms) / GPU bubble ratio: 52.77%
[rank1]:2026-01-01 01:06:46,862 - Avg. fwd time: 15.4379 / Avg. bwd time: 16.3034 / Avg. batch time: 454.7515 (ms) / GPU bubble ratio: 44.16%
[rank0]:2026-01-01 01:06:46,880 - Avg. fwd time: 13.2948 / Avg. bwd time: 5.1185 / Avg. batch time: 477.1527 (ms) / GPU bubble ratio: 69.13%
[rank3]:2026-01-01 01:07:02,575 - Freezing Ratio: [Stage3] 0.67, Threshold: 1.3412e+00
[rank0]:2026-01-01 01:07:02,575 - Freezing Ratio: [Stage0] 0.75, Threshold: 1.6530e+00
[rank2]:2026-01-01 01:07:02,574 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0964e+00
[rank1]:2026-01-01 01:07:02,580 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9033e-01
[rank2]:2026-01-01 01:07:41,170 - Freezing Ratio: [Stage2] 0.25, Threshold: 8.7348e-01
[rank1]:2026-01-01 01:07:41,171 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8304e+00
[rank3]:2026-01-01 01:07:41,171 - Freezing Ratio: [Stage3] 0.67, Threshold: 2.3454e+00
[rank0]:2026-01-01 01:07:41,172 - Freezing Ratio: [Stage0] 0.50, Threshold: 1.7185e+00
[rank3]:2026-01-01 01:08:20,584 - Freezing Ratio: [Stage3] 0.67, Threshold: 4.5179e+00
[rank0]:2026-01-01 01:08:20,584 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-01 01:08:20,589 - Freezing Ratio: [Stage0] 0.75, Threshold: 3.9630e+00
[rank2]:2026-01-01 01:08:20,583 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3823e+00
[rank1]:2026-01-01 01:08:20,591 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.0268e-01
[rank2]:2026-01-01 01:08:24,550 - Avg. fwd time: 12.1589 / Avg. bwd time: 12.5168 / Avg. batch time: 418.0341 (ms) / GPU bubble ratio: 52.78%
[rank1]:2026-01-01 01:08:24,579 - Avg. fwd time: 15.4379 / Avg. bwd time: 16.2972 / Avg. batch time: 454.7224 (ms) / GPU bubble ratio: 44.17%
[rank0]:2026-01-01 01:08:24,595 - Avg. fwd time: 13.3195 / Avg. bwd time: 5.1021 / Avg. batch time: 477.1480 (ms) / GPU bubble ratio: 69.11%
[rank0]:2026-01-01 01:08:24,599 -  step: 800  loss: -8.0000  grad_norm:  0.3949  memory: 14.51GiB(30.55%)  tps: 8,374  tflops: 65.46  mfu: 20.98%
[rank0]:2026-01-01 01:08:24,599 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3949  tps: 8,897  tflops: 69.55  mfu: 20.26%
[rank0]:2026-01-01 01:08:24,599 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-01 01:08:24,600 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2026-01-01 01:08:24,524 - Avg. fwd time: 16.5942 / Avg. bwd time: 24.6956 / Avg. batch time: 389.8110 (ms) / GPU bubble ratio: 15.26%
[rank3]:2026-01-01 01:08:24,601 -  step: 800  loss:  9.7916  grad_norm:  0.3949  memory: 29.95GiB(63.05%)  tps: 8,374  tflops: 65.47  mfu: 20.98%
[rank3]:2026-01-01 01:08:24,602 - â„¹ï¸ final step: 800  loss:  9.7916  grad_norm:  0.3949  tps: 8,903  tflops: 69.60  mfu: 20.40%
[rank3]:2026-01-01 01:08:24,602 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-01 01:08:24,603 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2026-01-01 01:08:24,598 -  step: 800  loss: -8.0000  grad_norm:  0.3949  memory: 13.86GiB(29.17%)  tps: 8,374  tflops: 65.46  mfu: 20.98%
[rank2]:2026-01-01 01:08:24,598 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3949  tps: 8,897  tflops: 69.55  mfu: 20.26%
[rank2]:2026-01-01 01:08:24,599 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-01 01:08:24,599 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2026-01-01 01:08:24,598 -  step: 800  loss: -8.0000  grad_norm:  0.3949  memory: 17.20GiB(36.20%)  tps: 8,374  tflops: 65.46  mfu: 20.98%
[rank1]:2026-01-01 01:08:24,598 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3949  tps: 8,897  tflops: 69.55  mfu: 20.26%
[rank1]:2026-01-01 01:08:24,599 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-01 01:08:24,599 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2026-01-01 01:08:26,737 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-01 01:08:26,811 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank2/260101_0108_stage2_final800.svg
[rank1]:2026-01-01 01:08:26,812 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank1/260101_0108_stage1_final800.svg
[rank3]:2026-01-01 01:08:26,891 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0108_final800_rank3.svg
[rank0]:2026-01-01 01:08:26,815 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank0/260101_0108_stage0_final800.svg
[rank3]:			> Batch Time: 476.39 ms, GPU Bubble Ratio: 67.91%, 46.82%, 58.52%, 30.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-13-13ms      | [S0,MB1,F]  13-12-26ms     | [S0,MB2,F]  26-12-39ms     | [S0,MB3,F]  39-12-52ms     | [S0,MB4,F]  52-12-64ms     | [S0,MB5,F]  65-13-78ms     | [S0,MB6,F]  78-12-91ms     | [S0,MB7,F]  91-14-105ms    | [S0,MB0,B]  298-5-304ms    | [S0,MB1,B]  323-5-329ms    | [S0,MB2,B]  347-5-353ms    | [S0,MB3,B]  372-5-378ms    | [S0,MB4,B]  397-5-403ms    | [S0,MB5,B]  422-5-428ms    | [S0,MB6,B]  447-5-453ms    | [S0,MB7,B]  470-5-476ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  13-15-28ms     | [S1,MB1,F]  32-15-47ms     | [S1,MB2,F]  50-15-66ms     | [S1,MB3,F]  71-15-86ms     | [S1,MB4,F]  95-15-110ms    | [S1,MB5,F]  119-15-134ms   | [S1,MB6,F]  143-15-158ms   | [S1,MB7,F]  167-15-183ms   | [S1,MB0,B]  279-15-295ms   | [S1,MB1,B]  303-16-319ms   | [S1,MB2,B]  328-16-344ms   | [S1,MB3,B]  352-16-369ms   | [S1,MB4,B]  377-16-393ms   | [S1,MB5,B]  402-16-418ms   | [S1,MB6,B]  427-16-444ms   | [S1,MB7,B]  449-16-465ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-12-41ms     | [S2,MB1,F]  47-12-59ms     | [S2,MB2,F]  68-12-80ms     | [S2,MB3,F]  92-12-104ms    | [S2,MB4,F]  116-12-128ms   | [S2,MB5,F]  140-12-152ms   | [S2,MB6,F]  164-12-176ms   | [S2,MB7,F]  189-12-201ms   | [S2,MB0,B]  263-12-275ms   | [S2,MB1,B]  287-12-300ms   | [S2,MB2,B]  312-12-324ms   | [S2,MB3,B]  336-12-349ms   | [S2,MB4,B]  361-12-374ms   | [S2,MB5,B]  386-12-399ms   | [S2,MB6,B]  411-12-424ms   | [S2,MB7,B]  433-12-445ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  41-16-57ms     | [S3,MB1,F]  65-16-81ms     | [S3,MB2,F]  88-16-105ms    | [S3,MB3,F]  113-16-129ms   | [S3,MB4,F]  137-16-153ms   | [S3,MB5,F]  161-16-178ms   | [S3,MB6,F]  186-16-202ms   | [S3,MB7,F]  210-16-226ms   | [S3,MB0,B]  232-24-256ms   | [S3,MB1,B]  256-24-281ms   | [S3,MB2,B]  281-24-305ms   | [S3,MB3,B]  305-24-330ms   | [S3,MB4,B]  330-24-355ms   | [S3,MB5,B]  355-24-380ms   | [S3,MB6,B]  380-24-405ms   | [S3,MB7,B]  404-24-429ms  
[rank1]:2026-01-01 01:08:26,993 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0108_rank1_stage1.svg
[rank1]:	> Counts Sum: 1666, Total Sum: 5250 (31.73%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 01:08:26,993 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0108_rank0_stage0.svg
[rank0]:	> Counts Sum: 2590, Total Sum: 4200 (61.67%), Ratio(%) per element: [98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-01 01:08:26,994 - Sleeping 2 seconds for other ranks to complete
[rank2]:2026-01-01 01:08:26,978 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0108_rank2_stage2.svg
[rank2]:	> Counts Sum: 1666, Total Sum: 4200 (39.67%), Ratio(%) per element: [98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-01 01:08:26,979 - Destroying the purge thread.
[rank1]:2026-01-01 01:08:26,993 - Destroying the purge thread.
[rank3]:2026-01-01 01:08:27,025 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/pipeline_schedule/260101_0108_thry_final800_rank3.svg
[rank3]:			> Batch Time: 473.13 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-14-14ms      | [S0,MB1,F]  14-14-28ms     | [S0,MB2,F]  28-14-43ms     | [S0,MB3,F]  43-14-57ms     | [S0,MB4,F]  57-14-71ms     | [S0,MB5,F]  71-14-86ms     | [S0,MB6,F]  86-14-100ms    | [S0,MB7,F]  100-14-114ms   | [S0,MB0,B]  243-28-272ms   | [S0,MB1,B]  272-28-301ms   | [S0,MB2,B]  301-28-329ms   | [S0,MB3,B]  329-28-358ms   | [S0,MB4,B]  358-28-387ms   | [S0,MB5,B]  387-28-415ms   | [S0,MB6,B]  415-28-444ms   | [S0,MB7,B]  444-28-473ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  14-14-28ms     | [S1,MB1,F]  28-14-43ms     | [S1,MB2,F]  43-14-57ms     | [S1,MB3,F]  57-14-71ms     | [S1,MB4,F]  71-14-86ms     | [S1,MB5,F]  86-14-100ms    | [S1,MB6,F]  100-14-114ms   | [S1,MB7,F]  114-14-129ms   | [S1,MB0,B]  215-28-243ms   | [S1,MB1,B]  243-28-272ms   | [S1,MB2,B]  272-28-301ms   | [S1,MB3,B]  301-28-329ms   | [S1,MB4,B]  329-28-358ms   | [S1,MB5,B]  358-28-387ms   | [S1,MB6,B]  387-28-415ms   | [S1,MB7,B]  415-28-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  28-14-43ms     | [S2,MB1,F]  43-14-57ms     | [S2,MB2,F]  57-14-71ms     | [S2,MB3,F]  71-14-86ms     | [S2,MB4,F]  86-14-100ms    | [S2,MB5,F]  100-14-114ms   | [S2,MB6,F]  114-14-129ms   | [S2,MB7,F]  129-14-143ms   | [S2,MB0,B]  186-28-215ms   | [S2,MB1,B]  215-28-243ms   | [S2,MB2,B]  243-28-272ms   | [S2,MB3,B]  272-28-301ms   | [S2,MB4,B]  301-28-329ms   | [S2,MB5,B]  329-28-358ms   | [S2,MB6,B]  358-28-387ms   | [S2,MB7,B]  387-28-415ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  43-14-57ms     | [S3,MB1,F]  57-14-71ms     | [S3,MB2,F]  71-14-86ms     | [S3,MB3,F]  86-14-100ms    | [S3,MB4,F]  100-14-114ms   | [S3,MB5,F]  114-14-129ms   | [S3,MB6,F]  129-14-143ms   | [S3,MB7,F]  143-14-157ms   | [S3,MB0,B]  157-28-186ms   | [S3,MB1,B]  186-28-215ms   | [S3,MB2,B]  215-28-243ms   | [S3,MB3,B]  243-28-272ms   | [S3,MB4,B]  272-28-301ms   | [S3,MB5,B]  301-28-329ms   | [S3,MB6,B]  329-28-358ms   | [S3,MB7,B]  358-28-387ms  
[rank3]:2026-01-01 01:08:27,075 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_ratio_history/rank3/260101_0108_stage3_final800.svg
[rank2]:2026-01-01 01:08:27,159 - Process group destroyed
[rank1]:2026-01-01 01:08:27,114 - Process group destroyed
[rank3]:2026-01-01 01:08:27,210 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1/frozen_params_histogram/260101_0108_rank3_stage3.svg
[rank3]:	> Counts Sum: 2072, Total Sum: 3150 (65.78%), Ratio(%) per element: [98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 98.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-01 01:08:27,211 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 379-400
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–‚â–‡â–ˆâ–„â–â–†â–ˆâ–„â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.68038
[rank3]:wandb:               final/avg_loss 9.79156
[rank3]:wandb:             final/avg_mfu(%) 20.39993
[rank3]:wandb:             final/avg_tflops 69.60299
[rank3]:wandb:    final/avg_throughput(tps) 8903.44003
[rank3]:wandb:              final/grad_norm 0.39486
[rank3]:wandb:               final/max_loss 9.79156
[rank3]:wandb:                    grad_norm 0.39486
[rank3]:wandb: loss_metrics/global_avg_loss 9.79156
[rank3]:wandb: loss_metrics/global_max_loss 9.79156
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1231_GPipe_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/lbqjn9na
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1231_GPipe_auto_42_dm1/20260101-0016/wandb/run-20260101_001615-lbqjn9na/logs
[rank3]:2026-01-01 01:08:28,869 - Process group destroyed
[rank0]:2026-01-01 01:08:28,994 - Training completed
[rank0]:2026-01-01 01:08:28,994 - Destroying the purge thread.
[rank0]:2026-01-01 01:08:29,199 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.8', 'layers.5', 'layers.6', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.0', 'layers.2', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'output', 'norm', 'layers.15', 'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1231_lora/config_1231.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:1231: everything same as 1230 but LoRA enabled
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1231_GPipe_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1231_GPipe_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1231_GPipe_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1231_GPipe_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1231_GPipe_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1231_GPipe_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1231_GPipe_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1231_GPipe_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- lora:
[rank3]:		- enable_lora: True
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
