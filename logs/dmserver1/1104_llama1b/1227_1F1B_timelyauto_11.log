
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 22:43:29 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_1F1B_timelyauto_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with timelyauto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-28 22:43:35,579 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank2]:2025-12-28 22:43:35,566 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank3]:2025-12-28 22:43:35,667 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank1]:2025-12-28 22:43:35,697 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank0]:2025-12-28 22:43:35,828 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 22:43:35,830 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 22:43:35,840 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 22:43:35,841 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-28 22:43:35,791 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 22:43:35,794 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-28 22:43:35,969 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 22:43:35,971 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 22:43:35,933 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 22:43:35,936 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 22:43:36,252 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 22:43:38,977 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-28 22:43:39,130 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 22:43:39,171 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 22:43:39,172 - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-28 22:43:39,155 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 22:43:39,194 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 22:43:39,199 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 22:43:39,199 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-28 22:43:39,223 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 22:43:39,223 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-28 22:43:39,445 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 22:43:39,445 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 22:43:39,446 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-28 22:43:39,451 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 22:43:39,451 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 22:43:39,452 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-28 22:43:39,724 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 22:43:39,762 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 22:43:39,790 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 22:43:39,790 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-28 22:43:40,023 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 22:43:40,024 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 22:43:40,024 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 5aeibs58
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_1F1B_timelyauto_11_dm1/20251228-2243/wandb/run-20251228_224340-5aeibs58
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_1F1B_timelyauto_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/5aeibs58
[rank3]:2025-12-28 22:43:41,499 - WandB logging enabled
[rank3]:2025-12-28 22:43:41,500 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 22:43:41,539 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 22:43:41,570 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 22:43:41,570 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-28 22:43:41,776 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_1F1B_timelyauto_11_dm1
[rank0]:2025-12-28 22:43:41,777 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 22:43:41,777 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 22:43:41,777 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-28 22:43:41,777 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-28 22:43:41,761 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 22:43:41,761 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 22:43:41,762 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-28 22:43:41,776 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-28 22:43:41,776 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 22:43:44,314 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 22:43:44,315 - Finished loading the checkpoint in 2.54 seconds.
[rank0]:2025-12-28 22:43:44,315 - Training starts at step 1
[rank0]:2025-12-28 22:43:49,667 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 13.10GiB(27.57%)  tps: 3,122  tflops: 24.41  mfu: 7.82%
[rank0]:2025-12-28 22:43:49,667 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 22:43:49,632 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 10.58GiB(22.26%)  tps: 3,320  tflops: 25.96  mfu: 8.32%
[rank1]:2025-12-28 22:43:49,633 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 22:43:49,639 -  step:  1  loss: 10.6092  grad_norm: 203.0656  memory: 21.88GiB(46.05%)  tps: 4,047  tflops: 31.63  mfu: 10.14%
[rank3]:2025-12-28 22:43:49,640 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 22:43:49,629 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory:  6.84GiB(14.41%)  tps: 3,140  tflops: 24.55  mfu: 7.87%
[rank2]:2025-12-28 22:43:49,629 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 22:47:41,741 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 22:47:46,382 - Avg. fwd time: 24.5592 / Avg. bwd time: 80.5282 / Avg. batch time: 986.2555 (ms) / GPU bubble ratio: 14.76%
[rank2]:2025-12-28 22:47:46,424 - Avg. fwd time: 14.8377 / Avg. bwd time: 35.2748 / Avg. batch time: 1044.5600 (ms) / GPU bubble ratio: 61.62%
[rank1]:2025-12-28 22:47:46,475 - Avg. fwd time: 19.7421 / Avg. bwd time: 45.5934 / Avg. batch time: 1117.2755 (ms) / GPU bubble ratio: 53.22%
[rank0]:2025-12-28 22:47:46,523 - Avg. fwd time: 16.0586 / Avg. bwd time: 41.8753 / Avg. batch time: 1183.2249 (ms) / GPU bubble ratio: 60.83%
[rank2]:2025-12-28 22:47:46,545 -  step: 50  loss: -4.0000  grad_norm: 24.0703  memory:  8.66GiB(18.23%)  tps: 6,777  tflops: 52.98  mfu: 16.98%
[rank1]:2025-12-28 22:47:46,549 -  step: 50  loss: -4.0000  grad_norm: 24.0703  memory: 12.86GiB(27.07%)  tps: 6,777  tflops: 52.98  mfu: 16.98%
[rank3]:2025-12-28 22:47:46,557 -  step: 50  loss:  9.8847  grad_norm: 24.0703  memory: 25.79GiB(54.28%)  tps: 6,777  tflops: 52.98  mfu: 16.98%
[rank0]:2025-12-28 22:47:46,561 -  step: 50  loss: -4.0000  grad_norm: 24.0703  memory: 16.87GiB(35.50%)  tps: 6,778  tflops: 52.99  mfu: 16.98%
[rank3]:2025-12-28 22:48:29,643 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-28 22:49:18,064 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-28 22:49:18,472 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-28 22:49:18,521 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-28 22:49:18,565 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-28 22:50:06,670 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-28 22:50:07,225 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-28 22:51:13,674 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-28 22:51:14,087 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 22:51:14,124 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank2]:2025-12-28 22:51:14,116 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 22:51:14,116 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:51:14,264 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2251_max_batch_time.svg
[rank3]:			> Batch Time: 1026.16 ms, GPU Bubble Ratio: 54.48%, 48.68%, 60.63%, 17.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  234-42-277ms   | [S0,MB4,F]  277-15-292ms   | [S0,MB1,B]  338-42-381ms   | [S0,MB5,F]  381-15-396ms   | [S0,MB2,B]  445-42-487ms   | [S0,MB6,F]  487-15-503ms   | [S0,MB3,B]  552-42-595ms   | [S0,MB7,F]  595-15-610ms   | [S0,MB4,B]  661-42-703ms   | [S0,MB5,B]  769-42-811ms   | [S0,MB6,B]  876-42-919ms   | [S0,MB7,B]  984-42-1026ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  36-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  188-46-234ms   | [S1,MB3,F]  234-19-254ms   | [S1,MB1,B]  292-45-338ms   | [S1,MB4,F]  338-20-359ms   | [S1,MB2,B]  399-46-445ms   | [S1,MB5,F]  445-20-465ms   | [S1,MB3,B]  506-46-552ms   | [S1,MB6,F]  552-20-573ms   | [S1,MB4,B]  615-46-661ms   | [S1,MB7,F]  661-20-682ms   | [S1,MB5,B]  723-45-769ms   | [S1,MB6,B]  830-45-876ms   | [S1,MB7,B]  938-45-984ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  152-35-188ms   | [S2,MB2,F]  188-14-203ms   | [S2,MB1,B]  257-35-292ms   | [S2,MB3,F]  292-14-307ms   | [S2,MB2,B]  363-35-399ms   | [S2,MB4,F]  399-14-414ms   | [S2,MB3,B]  471-35-506ms   | [S2,MB5,F]  506-15-521ms   | [S2,MB4,B]  579-35-615ms   | [S2,MB6,F]  615-14-630ms   | [S2,MB5,B]  687-35-723ms   | [S2,MB7,F]  723-14-738ms   | [S2,MB6,B]  795-35-830ms   | [S2,MB7,B]  903-35-938ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-75-152ms    AFR(10):0.9655 | [S3,MB1,F]  152-24-176ms   | [S3,MB1,B]  176-80-257ms   AFR(10):0.9655 | [S3,MB2,F]  257-24-282ms   | [S3,MB2,B]  282-81-363ms   AFR(10):0.9655 | [S3,MB3,F]  363-24-388ms   | [S3,MB3,B]  388-82-471ms   AFR(10):0.9655 | [S3,MB4,F]  471-25-496ms   | [S3,MB4,B]  496-83-579ms   AFR(10):0.9655 | [S3,MB5,F]  579-25-604ms   | [S3,MB5,B]  604-83-687ms   AFR(10):0.9655 | [S3,MB6,F]  687-25-713ms   | [S3,MB6,B]  713-82-795ms   AFR(10):0.9655 | [S3,MB7,F]  795-24-820ms   | [S3,MB7,B]  820-83-903ms   AFR(10):0.9655
[rank3]:2025-12-28 22:51:14,396 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2251_min_batch_time.svg
[rank3]:			> Batch Time: 641.60 ms, GPU Bubble Ratio: 79.86%, 46.68%, 59.18%, 14.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  158-0-158ms    | [S0,MB4,F]  158-15-174ms   | [S0,MB1,B]  226-0-226ms    | [S0,MB5,F]  226-15-241ms   | [S0,MB2,B]  294-0-294ms    | [S0,MB6,F]  294-15-310ms   | [S0,MB3,B]  364-0-364ms    | [S0,MB7,F]  364-15-380ms   | [S0,MB4,B]  434-0-434ms    | [S0,MB5,B]  503-0-503ms    | [S0,MB6,B]  572-0-572ms    | [S0,MB7,B]  641-0-641ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  36-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  135-22-158ms   | [S1,MB3,F]  158-19-178ms   | [S1,MB1,B]  203-22-226ms   | [S1,MB4,F]  226-20-246ms   | [S1,MB2,B]  271-22-294ms   | [S1,MB5,F]  294-20-315ms   | [S1,MB3,B]  341-23-364ms   | [S1,MB6,F]  364-20-385ms   | [S1,MB4,B]  411-23-434ms   | [S1,MB7,F]  434-20-454ms   | [S1,MB5,B]  480-23-503ms   | [S1,MB6,B]  549-22-572ms   | [S1,MB7,B]  618-22-641ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  117-17-135ms   | [S2,MB2,F]  135-14-150ms   | [S2,MB1,B]  185-17-203ms   | [S2,MB3,F]  203-14-218ms   | [S2,MB2,B]  253-17-271ms   | [S2,MB4,F]  271-14-286ms   | [S2,MB3,B]  323-17-341ms   | [S2,MB5,F]  341-15-356ms   | [S2,MB4,B]  393-17-411ms   | [S2,MB6,F]  411-14-426ms   | [S2,MB5,B]  462-17-480ms   | [S2,MB7,F]  480-14-495ms   | [S2,MB6,B]  531-17-549ms   | [S2,MB7,B]  601-17-618ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-41-117ms    AFR(10):0.9655 | [S3,MB1,F]  117-24-142ms   | [S3,MB1,B]  142-43-185ms   AFR(10):0.9655 | [S3,MB2,F]  185-24-209ms   | [S3,MB2,B]  209-43-253ms   AFR(10):0.9655 | [S3,MB3,F]  253-24-278ms   | [S3,MB3,B]  278-45-323ms   AFR(10):0.9655 | [S3,MB4,F]  323-25-349ms   | [S3,MB4,B]  349-43-393ms   AFR(10):0.9655 | [S3,MB5,F]  393-25-418ms   | [S3,MB5,B]  418-44-462ms   AFR(10):0.9655 | [S3,MB6,F]  462-25-487ms   | [S3,MB6,B]  487-44-531ms   AFR(10):0.9655 | [S3,MB7,F]  531-24-556ms   | [S3,MB7,B]  556-44-601ms   AFR(10):0.9655
[rank3]:2025-12-28 22:51:14,539 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2251_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 698.55 ms, GPU Bubble Ratio: 41.11%, 27.87%, 44.71%, 13.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  234-42-277ms   | [S0,MB4,F]  277-15-292ms   | [S0,MB1,B]  301-42-343ms   | [S0,MB5,F]  343-15-359ms   | [S0,MB2,B]  392-42-434ms   | [S0,MB6,F]  434-15-450ms   | [S0,MB3,B]  462-42-504ms   | [S0,MB7,F]  504-15-520ms   | [S0,MB4,B]  532-42-574ms   | [S0,MB5,B]  600-42-642ms   | [S0,MB6,B]  670-28-698ms   | [S0,MB7,B]  698-0-698ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  36-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  188-46-234ms   | [S1,MB3,F]  234-19-254ms   | [S1,MB1,B]  255-45-301ms   | [S1,MB4,F]  301-20-321ms   | [S1,MB2,B]  346-46-392ms   | [S1,MB5,F]  392-20-413ms   | [S1,MB3,B]  416-46-462ms   | [S1,MB6,F]  462-20-482ms   | [S1,MB4,B]  485-46-532ms   | [S1,MB7,F]  532-20-552ms   | [S1,MB5,B]  554-45-600ms   | [S1,MB6,B]  624-45-670ms   | [S1,MB7,B]  675-22-698ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  152-35-188ms   | [S2,MB2,F]  188-14-203ms   | [S2,MB1,B]  219-35-255ms   | [S2,MB3,F]  255-14-270ms   | [S2,MB2,B]  310-35-346ms   | [S2,MB4,F]  346-14-361ms   | [S2,MB3,B]  380-35-416ms   | [S2,MB5,F]  416-15-431ms   | [S2,MB4,B]  450-35-485ms   | [S2,MB6,F]  485-14-500ms   | [S2,MB5,B]  519-35-554ms   | [S2,MB7,F]  554-14-569ms   | [S2,MB6,B]  588-35-624ms   | [S2,MB7,B]  658-17-675ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-75-152ms    AFR(10):0.9655 | [S3,MB1,F]  152-24-176ms   | [S3,MB1,B]  176-43-219ms   AFR(10):0.9655 | [S3,MB2,F]  219-24-244ms   | [S3,MB2,B]  244-66-310ms   AFR(10):0.9655 | [S3,MB3,F]  310-24-335ms   | [S3,MB3,B]  335-45-380ms   AFR(10):0.9655 | [S3,MB4,F]  380-25-406ms   | [S3,MB4,B]  406-43-450ms   AFR(10):0.9655 | [S3,MB5,F]  450-25-475ms   | [S3,MB5,B]  475-44-519ms   AFR(10):0.9655 | [S3,MB6,F]  519-25-544ms   | [S3,MB6,B]  544-44-588ms   AFR(10):0.9655 | [S3,MB7,F]  588-24-613ms   | [S3,MB7,B]  613-44-658ms   AFR(10):0.9655
[rank3]:2025-12-28 22:51:14,540 - 	> Batch Time: 698.55 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank3]:2025-12-28 22:51:14,543 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.40/0.40, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:51:17,971 - Avg. fwd time: 24.7037 / Avg. bwd time: 73.2534 / Avg. batch time: 929.0333 (ms) / GPU bubble ratio: 15.65%
[rank0]:2025-12-28 22:51:18,033 - Avg. fwd time: 15.9313 / Avg. bwd time: 33.4814 / Avg. batch time: 1108.5837 (ms) / GPU bubble ratio: 64.34%
[rank2]:2025-12-28 22:51:17,998 - Avg. fwd time: 14.7444 / Avg. bwd time: 31.8270 / Avg. batch time: 984.1489 (ms) / GPU bubble ratio: 62.14%
[rank2]:2025-12-28 22:51:18,055 -  step: 100  loss: -4.0000  grad_norm:  7.6363  memory:  8.66GiB(18.23%)  tps: 7,746  tflops: 60.56  mfu: 19.41%
[rank1]:2025-12-28 22:51:18,027 - Avg. fwd time: 19.5985 / Avg. bwd time: 41.1472 / Avg. batch time: 1051.8223 (ms) / GPU bubble ratio: 53.80%
[rank1]:2025-12-28 22:51:18,061 -  step: 100  loss: -4.0000  grad_norm:  7.6363  memory: 12.86GiB(27.07%)  tps: 7,746  tflops: 60.56  mfu: 19.41%
[rank3]:2025-12-28 22:51:18,067 -  step: 100  loss:  8.8573  grad_norm:  7.6363  memory: 25.79GiB(54.28%)  tps: 7,746  tflops: 60.56  mfu: 19.41%
[rank0]:2025-12-28 22:51:18,070 -  step: 100  loss: -4.0000  grad_norm:  7.6363  memory: 16.87GiB(35.50%)  tps: 7,746  tflops: 60.56  mfu: 19.41%
[rank0]:2025-12-28 22:51:18,127 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2251_stage0_step100.svg
[rank2]:2025-12-28 22:51:18,130 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2251_stage2_step100.svg
[rank1]:2025-12-28 22:51:18,130 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2251_stage1_step100.svg
[rank3]:2025-12-28 22:51:18,209 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2251_step100_rank3.svg
[rank3]:			> Batch Time: 824.00 ms, GPU Bubble Ratio: 85.11%, 59.57%, 68.79%, 30.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-64ms     | [S0,MB0,B]  198-0-198ms    | [S0,MB4,F]  198-14-213ms   | [S0,MB1,B]  284-0-284ms    | [S0,MB5,F]  284-14-298ms   | [S0,MB2,B]  372-0-372ms    | [S0,MB6,F]  372-14-386ms   | [S0,MB3,B]  462-0-462ms    | [S0,MB7,F]  462-14-476ms   | [S0,MB4,B]  551-0-551ms    | [S0,MB5,B]  639-0-639ms    | [S0,MB6,B]  723-0-723ms    | [S0,MB7,B]  824-0-824ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  168-22-190ms   | [S1,MB3,F]  195-18-213ms   | [S1,MB1,B]  253-22-276ms   | [S1,MB4,F]  280-18-299ms   | [S1,MB2,B]  341-22-364ms   | [S1,MB5,F]  368-18-387ms   | [S1,MB3,B]  431-23-454ms   | [S1,MB6,F]  458-18-477ms   | [S1,MB4,B]  520-23-543ms   | [S1,MB7,F]  548-18-566ms   | [S1,MB5,B]  610-23-633ms   | [S1,MB6,B]  694-22-717ms   | [S1,MB7,B]  795-22-817ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  140-17-157ms   | [S2,MB2,F]  164-14-179ms   | [S2,MB1,B]  225-17-243ms   | [S2,MB3,F]  250-14-264ms   | [S2,MB2,B]  313-17-331ms   | [S2,MB4,F]  338-14-352ms   | [S2,MB3,B]  403-17-421ms   | [S2,MB5,F]  428-14-442ms   | [S2,MB4,B]  492-17-510ms   | [S2,MB6,F]  517-14-531ms   | [S2,MB5,B]  582-17-600ms   | [S2,MB7,F]  607-14-621ms   | [S2,MB6,B]  670-17-688ms   | [S2,MB7,B]  771-17-789ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-41-129ms    | [S3,MB1,F]  136-23-160ms   | [S3,MB1,B]  171-43-215ms   | [S3,MB2,F]  222-25-247ms   | [S3,MB2,B]  258-44-303ms   | [S3,MB3,F]  310-25-336ms   | [S3,MB3,B]  348-45-393ms   | [S3,MB4,F]  400-25-426ms   | [S3,MB4,B]  437-43-481ms   | [S3,MB5,F]  489-26-515ms   | [S3,MB5,B]  527-44-572ms   | [S3,MB6,F]  579-25-605ms   | [S3,MB6,B]  616-43-660ms   | [S3,MB7,F]  667-25-693ms   | [S3,MB7,B]  704-61-766ms  
[rank1]:2025-12-28 22:51:18,280 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2251_rank1_stage1.svg
[rank1]:	> Counts Sum: 28800, Total Sum: 28800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-28 22:51:18,252 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2251_stage3_step100.svg
[rank0]:2025-12-28 22:51:18,282 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2251_rank0_stage0.svg
[rank0]:	> Counts Sum: 23680, Total Sum: 23680 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-28 22:51:18,319 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2251_stage0.svg
[rank2]:2025-12-28 22:51:18,286 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2251_rank2_stage2.svg
[rank2]:	> Counts Sum: 23040, Total Sum: 23040 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-28 22:51:18,324 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2251_stage2.svg
[rank1]:2025-12-28 22:51:18,317 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2251_stage1.svg
[rank3]:2025-12-28 22:51:18,386 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2251_rank3_stage3.svg
[rank3]:	> Counts Sum: 17920, Total Sum: 18560 (96.55%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 87.5, 87.5, 81.25, 93.75, 87.5, 93.75, 100.0, 81.25, 93.75, 100.0, 93.75]
[rank3]:2025-12-28 22:51:18,426 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2251_stage3.svg
[rank2]:2025-12-28 22:54:49,330 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-12-28 22:54:49,335 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-12-28 22:54:49,342 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.27/0.40, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-28 22:54:49,324 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 22:54:49,348 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.22/0.32, [MB7] 0.67/1.00
[rank3]:2025-12-28 22:54:53,252 - Avg. fwd time: 24.9086 / Avg. bwd time: 71.5689 / Avg. batch time: 917.6005 (ms) / GPU bubble ratio: 15.89%
[rank2]:2025-12-28 22:54:53,283 - Avg. fwd time: 14.8228 / Avg. bwd time: 32.6392 / Avg. batch time: 970.0335 (ms) / GPU bubble ratio: 60.86%
[rank1]:2025-12-28 22:54:53,322 - Avg. fwd time: 19.7043 / Avg. bwd time: 42.3130 / Avg. batch time: 1034.6093 (ms) / GPU bubble ratio: 52.05%
[rank1]:2025-12-28 22:54:53,382 -  step: 150  loss: -4.0000  grad_norm:  9.9719  memory: 12.86GiB(27.07%)  tps: 7,609  tflops: 59.48  mfu: 19.07%
[rank3]:2025-12-28 22:54:53,391 -  step: 150  loss:  4.0779  grad_norm:  9.9719  memory: 25.79GiB(54.28%)  tps: 7,609  tflops: 59.48  mfu: 19.07%
[rank0]:2025-12-28 22:54:53,357 - Avg. fwd time: 16.0144 / Avg. bwd time: 35.4730 / Avg. batch time: 1088.5349 (ms) / GPU bubble ratio: 62.16%
[rank0]:2025-12-28 22:54:53,393 -  step: 150  loss: -4.0000  grad_norm:  9.9719  memory: 16.87GiB(35.50%)  tps: 7,609  tflops: 59.48  mfu: 19.07%
[rank2]:2025-12-28 22:54:53,378 -  step: 150  loss: -4.0000  grad_norm:  9.9719  memory:  8.66GiB(18.23%)  tps: 7,609  tflops: 59.48  mfu: 19.07%
[rank2]:2025-12-28 22:58:04,613 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 22:58:04,617 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:58:04,625 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.40/0.40, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 22:58:04,596 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 22:58:04,632 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank2]:2025-12-28 22:58:08,236 - Avg. fwd time: 14.8957 / Avg. bwd time: 33.0185 / Avg. batch time: 938.7124 (ms) / GPU bubble ratio: 59.17%
[rank3]:2025-12-28 22:58:08,210 - Avg. fwd time: 25.0001 / Avg. bwd time: 67.7424 / Avg. batch time: 888.2476 (ms) / GPU bubble ratio: 16.47%
[rank2]:2025-12-28 22:58:08,295 -  step: 200  loss: -4.0000  grad_norm:  5.5452  memory:  8.66GiB(18.23%)  tps: 8,406  tflops: 65.71  mfu: 21.06%
[rank1]:2025-12-28 22:58:08,266 - Avg. fwd time: 19.8524 / Avg. bwd time: 43.0319 / Avg. batch time: 1000.9073 (ms) / GPU bubble ratio: 49.74%
[rank1]:2025-12-28 22:58:08,299 -  step: 200  loss: -4.0000  grad_norm:  5.5452  memory: 12.86GiB(27.07%)  tps: 8,406  tflops: 65.71  mfu: 21.06%
[rank3]:2025-12-28 22:58:08,307 -  step: 200  loss:  1.5217  grad_norm:  5.5452  memory: 25.79GiB(54.28%)  tps: 8,406  tflops: 65.71  mfu: 21.06%
[rank0]:2025-12-28 22:58:08,273 - Avg. fwd time: 16.0896 / Avg. bwd time: 36.4489 / Avg. batch time: 1053.1587 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-12-28 22:58:08,309 -  step: 200  loss: -4.0000  grad_norm:  5.5452  memory: 16.87GiB(35.50%)  tps: 8,406  tflops: 65.71  mfu: 21.06%
[rank0]:2025-12-28 22:58:08,357 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2258_stage0_step200.svg
[rank2]:2025-12-28 22:58:08,358 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2258_stage2_step200.svg
[rank1]:2025-12-28 22:58:08,358 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2258_stage1_step200.svg
[rank3]:2025-12-28 22:58:08,454 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2258_step200_rank3.svg
[rank3]:			> Batch Time: 908.33 ms, GPU Bubble Ratio: 50.12%, 41.62%, 56.60%, 31.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-16-33ms     | [S0,MB2,F]  33-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  365-42-407ms   | [S0,MB5,F]  407-16-424ms   | [S0,MB2,B]  479-42-522ms   | [S0,MB6,F]  522-16-538ms   | [S0,MB3,B]  572-42-614ms   | [S0,MB7,F]  614-16-630ms   | [S0,MB4,B]  663-42-706ms   | [S0,MB5,B]  752-42-794ms   | [S0,MB6,B]  834-39-874ms   | [S0,MB7,B]  882-26-908ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  271-19-290ms   | [S1,MB1,B]  308-48-357ms   | [S1,MB4,F]  361-21-383ms   | [S1,MB2,B]  424-47-471ms   | [S1,MB5,F]  476-21-497ms   | [S1,MB3,B]  515-48-563ms   | [S1,MB6,F]  568-21-590ms   | [S1,MB4,B]  604-51-655ms   | [S1,MB7,F]  659-22-682ms   | [S1,MB5,B]  693-51-745ms   | [S1,MB6,B]  781-46-828ms   | [S1,MB7,B]  849-25-875ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  262-36-298ms   | [S2,MB3,F]  305-15-321ms   | [S2,MB2,B]  378-35-414ms   | [S2,MB4,F]  421-15-436ms   | [S2,MB3,B]  468-36-504ms   | [S2,MB5,F]  512-15-527ms   | [S2,MB4,B]  558-36-594ms   | [S2,MB6,F]  601-15-617ms   | [S2,MB5,B]  647-36-683ms   | [S2,MB7,F]  690-15-706ms   | [S2,MB6,B]  739-36-775ms   | [S2,MB7,B]  825-18-843ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-74-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-44-250ms   | [S3,MB2,F]  259-25-284ms   | [S3,MB2,B]  295-75-370ms   | [S3,MB3,F]  375-25-400ms   | [S3,MB3,B]  412-45-457ms   | [S3,MB4,F]  465-26-491ms   | [S3,MB4,B]  503-44-548ms   | [S3,MB5,F]  554-26-581ms   | [S3,MB5,B]  593-44-637ms   | [S3,MB6,F]  644-26-670ms   | [S3,MB6,B]  682-46-728ms   | [S3,MB7,F]  735-25-761ms   | [S3,MB7,B]  773-44-818ms  
[rank2]:2025-12-28 22:58:08,508 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2258_rank2_stage2.svg
[rank2]:	> Counts Sum: 33120, Total Sum: 138240 (23.96%), Ratio(%) per element: [26.04, 25.0, 23.95, 22.91, 25.0, 23.95, 26.04, 25.0, 23.95, 23.95, 25.0, 25.0, 26.04, 27.08, 23.95, 25.0, 23.95, 25.0, 23.95, 26.04, 25.0, 25.0, 22.91, 25.0, 25.0, 26.04, 26.04, 19.79, 21.87, 19.79, 20.83, 22.91, 20.83, 21.87, 21.87, 20.83]
[rank1]:2025-12-28 22:58:08,506 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2258_rank1_stage1.svg
[rank1]:	> Counts Sum: 41400, Total Sum: 172800 (23.96%), Ratio(%) per element: [27.08, 26.04, 26.04, 26.04, 23.95, 27.08, 26.04, 25.0, 26.04, 23.95, 26.04, 27.08, 26.04, 25.0, 26.04, 23.95, 23.95, 23.95, 22.91, 23.95, 25.0, 23.95, 25.0, 26.04, 25.0, 25.0, 25.0, 22.91, 20.83, 22.91, 20.83, 20.83, 22.91, 22.91, 23.95, 23.95, 20.83, 19.79, 21.87, 22.91, 22.91, 20.83, 21.87, 22.91, 20.83]
[rank3]:2025-12-28 22:58:08,498 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2258_stage3_step200.svg
[rank0]:2025-12-28 22:58:08,508 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2258_rank0_stage0.svg
[rank0]:	> Counts Sum: 37440, Total Sum: 142080 (26.35%), Ratio(%) per element: [21.87, 30.2, 28.12, 29.16, 27.08, 29.16, 27.08, 30.2, 27.08, 29.16, 28.12, 29.16, 27.08, 31.25, 25.0, 25.0, 27.08, 27.08, 28.12, 23.95, 28.12, 27.08, 25.0, 27.08, 28.12, 26.04, 27.08, 23.95, 22.91, 26.04, 25.0, 21.87, 23.95, 21.87, 21.87, 22.91, 25.0]
[rank3]:2025-12-28 22:58:08,629 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2258_rank3_stage3.svg
[rank3]:	> Counts Sum: 69680, Total Sum: 111360 (62.57%), Ratio(%) per element: [68.75, 71.87, 67.7, 65.62, 73.95, 75.0, 71.87, 73.95, 66.66, 71.87, 73.95, 68.75, 64.58, 71.87, 68.75, 73.95, 61.45, 71.87, 46.87, 43.75, 46.87, 56.25, 46.87, 50.0, 54.16, 55.2, 47.91, 54.16, 50.0]
[rank2]:2025-12-28 22:58:08,672 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2258_stage2.svg
[rank1]:2025-12-28 22:58:08,668 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2258_stage1.svg
[rank0]:2025-12-28 22:58:08,672 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2258_stage0.svg
[rank3]:2025-12-28 22:58:08,790 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2258_stage3.svg
[rank2]:2025-12-28 23:01:04,168 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 23:01:04,160 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 23:01:04,183 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank1]:2025-12-28 23:01:04,176 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 23:01:04,180 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.40/0.40, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 23:01:07,645 - Avg. fwd time: 25.0451 / Avg. bwd time: 64.2998 / Avg. batch time: 861.1268 (ms) / GPU bubble ratio: 17.00%
[rank2]:2025-12-28 23:01:07,672 - Avg. fwd time: 14.9532 / Avg. bwd time: 33.2315 / Avg. batch time: 909.7149 (ms) / GPU bubble ratio: 57.63%
[rank1]:2025-12-28 23:01:07,702 - Avg. fwd time: 20.0069 / Avg. bwd time: 43.6273 / Avg. batch time: 969.6933 (ms) / GPU bubble ratio: 47.50%
[rank3]:2025-12-28 23:01:07,744 -  step: 250  loss:  0.5423  grad_norm:  2.7131  memory: 25.79GiB(54.28%)  tps: 9,131  tflops: 71.38  mfu: 22.88%
[rank2]:2025-12-28 23:01:07,731 -  step: 250  loss: -4.0000  grad_norm:  2.7131  memory:  8.66GiB(18.23%)  tps: 9,131  tflops: 71.38  mfu: 22.88%
[rank0]:2025-12-28 23:01:07,709 - Avg. fwd time: 16.1519 / Avg. bwd time: 36.4161 / Avg. batch time: 1016.2025 (ms) / GPU bubble ratio: 58.62%
[rank0]:2025-12-28 23:01:07,745 -  step: 250  loss: -4.0000  grad_norm:  2.7131  memory: 16.87GiB(35.50%)  tps: 9,131  tflops: 71.38  mfu: 22.88%
[rank1]:2025-12-28 23:01:07,737 -  step: 250  loss: -4.0000  grad_norm:  2.7131  memory: 12.86GiB(27.07%)  tps: 9,131  tflops: 71.38  mfu: 22.88%
[rank0]:2025-12-28 23:04:02,851 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 23:04:02,885 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank3]:2025-12-28 23:04:02,881 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.40/0.40, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 23:04:02,868 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 23:04:02,875 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 23:04:06,407 - Avg. fwd time: 25.0763 / Avg. bwd time: 61.9639 / Avg. batch time: 842.7979 (ms) / GPU bubble ratio: 17.38%
[rank2]:2025-12-28 23:04:06,434 - Avg. fwd time: 15.0068 / Avg. bwd time: 33.3896 / Avg. batch time: 890.0919 (ms) / GPU bubble ratio: 56.50%
[rank0]:2025-12-28 23:04:06,473 - Avg. fwd time: 16.1897 / Avg. bwd time: 36.3805 / Avg. batch time: 991.2560 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-12-28 23:04:06,509 -  step: 300  loss: -4.0000  grad_norm:  1.2005  memory: 16.87GiB(35.50%)  tps: 9,165  tflops: 71.65  mfu: 22.96%
[rank3]:2025-12-28 23:04:06,508 -  step: 300  loss:  0.3138  grad_norm:  1.2005  memory: 25.79GiB(54.28%)  tps: 9,165  tflops: 71.65  mfu: 22.96%
[rank2]:2025-12-28 23:04:06,494 -  step: 300  loss: -4.0000  grad_norm:  1.2005  memory:  8.66GiB(18.23%)  tps: 9,165  tflops: 71.65  mfu: 22.96%
[rank1]:2025-12-28 23:04:06,465 - Avg. fwd time: 20.0875 / Avg. bwd time: 44.0220 / Avg. batch time: 948.5909 (ms) / GPU bubble ratio: 45.93%
[rank1]:2025-12-28 23:04:06,498 -  step: 300  loss: -4.0000  grad_norm:  1.2005  memory: 12.86GiB(27.07%)  tps: 9,165  tflops: 71.65  mfu: 22.96%
[rank0]:2025-12-28 23:04:06,557 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2304_stage0_step300.svg
[rank2]:2025-12-28 23:04:06,558 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2304_stage2_step300.svg
[rank1]:2025-12-28 23:04:06,556 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2304_stage1_step300.svg
[rank0]:2025-12-28 23:04:06,708 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2304_rank0_stage0.svg
[rank0]:	> Counts Sum: 57040, Total Sum: 260480 (21.90%), Ratio(%) per element: [18.75, 26.7, 25.0, 25.0, 22.72, 24.43, 23.86, 25.56, 23.29, 24.43, 23.29, 23.29, 21.59, 25.0, 21.02, 21.59, 21.59, 22.15, 23.86, 20.45, 23.29, 20.45, 21.59, 22.15, 22.72, 21.02, 22.72, 19.31, 18.75, 20.45, 19.88, 19.88, 19.31, 18.75, 18.18, 18.18, 19.88]
[rank3]:2025-12-28 23:04:06,657 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2304_step300_rank3.svg
[rank3]:			> Batch Time: 858.50 ms, GPU Bubble Ratio: 50.65%, 37.86%, 53.84%, 30.62%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  275-42-318ms   | [S0,MB4,F]  318-15-334ms   | [S0,MB1,B]  366-42-409ms   | [S0,MB5,F]  409-16-425ms   | [S0,MB2,B]  466-42-508ms   | [S0,MB6,F]  509-16-525ms   | [S0,MB3,B]  558-42-600ms   | [S0,MB7,F]  600-16-617ms   | [S0,MB4,B]  647-42-689ms   | [S0,MB5,B]  735-42-777ms   | [S0,MB6,B]  815-36-851ms   | [S0,MB7,B]  858-0-858ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-46-267ms   | [S1,MB3,F]  272-19-291ms   | [S1,MB1,B]  307-48-355ms   | [S1,MB4,F]  364-20-384ms   | [S1,MB2,B]  410-47-458ms   | [S1,MB5,F]  462-21-484ms   | [S1,MB3,B]  499-50-549ms   | [S1,MB6,F]  554-22-576ms   | [S1,MB4,B]  587-51-639ms   | [S1,MB7,F]  643-22-665ms   | [S1,MB5,B]  675-52-728ms   | [S1,MB6,B]  760-47-808ms   | [S1,MB7,B]  827-24-851ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  174-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  260-36-297ms   | [S2,MB3,F]  304-15-320ms   | [S2,MB2,B]  363-36-399ms   | [S2,MB4,F]  407-15-422ms   | [S2,MB3,B]  451-36-488ms   | [S2,MB5,F]  495-15-511ms   | [S2,MB4,B]  540-36-576ms   | [S2,MB6,F]  584-15-599ms   | [S2,MB5,B]  629-36-665ms   | [S2,MB7,F]  673-15-688ms   | [S2,MB6,B]  717-36-754ms   | [S2,MB7,B]  803-18-821ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-195ms   | [S3,MB1,B]  206-43-250ms   | [S3,MB2,F]  257-25-282ms   | [S3,MB2,B]  294-55-350ms   | [S3,MB3,F]  360-24-385ms   | [S3,MB3,B]  397-43-440ms   | [S3,MB4,F]  448-25-474ms   | [S3,MB4,B]  485-43-529ms   | [S3,MB5,F]  537-26-563ms   | [S3,MB5,B]  575-44-619ms   | [S3,MB6,F]  626-25-652ms   | [S3,MB6,B]  663-44-707ms   | [S3,MB7,F]  714-26-740ms   | [S3,MB7,B]  752-44-796ms  
[rank3]:2025-12-28 23:04:06,700 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2304_stage3_step300.svg
[rank2]:2025-12-28 23:04:06,711 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2304_rank2_stage2.svg
[rank2]:	> Counts Sum: 47520, Total Sum: 253440 (18.75%), Ratio(%) per element: [19.88, 19.31, 18.75, 18.18, 19.31, 18.75, 19.88, 19.31, 18.75, 18.75, 19.31, 19.31, 19.88, 20.45, 18.75, 19.31, 18.75, 19.31, 18.75, 19.88, 19.31, 19.31, 18.18, 19.31, 19.31, 19.88, 19.88, 16.47, 17.61, 16.47, 17.04, 18.18, 17.04, 17.61, 17.61, 17.04]
[rank1]:2025-12-28 23:04:06,700 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2304_rank1_stage1.svg
[rank1]:	> Counts Sum: 59400, Total Sum: 316800 (18.75%), Ratio(%) per element: [20.45, 19.88, 19.88, 19.88, 18.75, 20.45, 19.88, 19.31, 19.88, 18.75, 19.88, 20.45, 19.88, 19.31, 19.88, 18.75, 18.75, 18.75, 18.18, 18.75, 19.31, 18.75, 19.31, 19.88, 19.31, 19.31, 19.31, 18.18, 17.04, 18.18, 17.04, 17.04, 18.18, 18.18, 18.75, 18.75, 17.04, 16.47, 17.61, 18.18, 18.18, 17.04, 17.61, 18.18, 17.04]
[rank3]:2025-12-28 23:04:06,837 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2304_rank3_stage3.svg
[rank3]:	> Counts Sum: 144080, Total Sum: 204160 (70.57%), Ratio(%) per element: [75.56, 76.7, 74.43, 74.43, 76.7, 78.4, 75.56, 78.4, 73.86, 76.7, 77.27, 72.72, 71.02, 75.56, 73.29, 77.27, 69.31, 76.7, 60.79, 57.95, 61.36, 65.9, 61.93, 62.5, 64.2, 65.34, 61.93, 66.47, 64.2]
[rank0]:2025-12-28 23:04:06,993 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2304_stage0.svg
[rank2]:2025-12-28 23:04:07,005 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2304_stage2.svg
[rank1]:2025-12-28 23:04:06,983 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2304_stage1.svg
[rank3]:2025-12-28 23:04:07,123 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2304_stage3.svg
[rank0]:2025-12-28 23:07:04,015 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 23:07:07,625 - Avg. fwd time: 15.0281 / Avg. bwd time: 33.4918 / Avg. batch time: 877.5262 (ms) / GPU bubble ratio: 55.77%
[rank0]:2025-12-28 23:07:07,664 - Avg. fwd time: 16.2141 / Avg. bwd time: 36.3322 / Avg. batch time: 974.8817 (ms) / GPU bubble ratio: 56.88%
[rank3]:2025-12-28 23:07:07,598 - Avg. fwd time: 25.1028 / Avg. bwd time: 60.4843 / Avg. batch time: 831.1088 (ms) / GPU bubble ratio: 17.62%
[rank1]:2025-12-28 23:07:07,656 - Avg. fwd time: 20.1482 / Avg. bwd time: 44.2401 / Avg. batch time: 934.9629 (ms) / GPU bubble ratio: 44.91%
[rank1]:2025-12-28 23:07:07,690 -  step: 350  loss: -4.0000  grad_norm:  0.3249  memory: 12.86GiB(27.07%)  tps: 9,042  tflops: 70.69  mfu: 22.66%
[rank2]:2025-12-28 23:07:07,686 -  step: 350  loss: -4.0000  grad_norm:  0.3249  memory:  8.66GiB(18.23%)  tps: 9,042  tflops: 70.69  mfu: 22.66%
[rank0]:2025-12-28 23:07:07,700 -  step: 350  loss: -4.0000  grad_norm:  0.3249  memory: 16.87GiB(35.50%)  tps: 9,042  tflops: 70.69  mfu: 22.66%
[rank3]:2025-12-28 23:07:07,699 -  step: 350  loss:  0.2379  grad_norm:  0.3249  memory: 25.79GiB(54.28%)  tps: 9,043  tflops: 70.69  mfu: 22.66%
[rank0]:2025-12-28 23:10:02,516 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 23:10:06,125 - Avg. fwd time: 25.1182 / Avg. bwd time: 59.1918 / Avg. batch time: 820.9740 (ms) / GPU bubble ratio: 17.84%
[rank0]:2025-12-28 23:10:06,192 - Avg. fwd time: 16.2342 / Avg. bwd time: 36.3046 / Avg. batch time: 961.1936 (ms) / GPU bubble ratio: 56.27%
[rank2]:2025-12-28 23:10:06,152 - Avg. fwd time: 15.0504 / Avg. bwd time: 33.5710 / Avg. batch time: 866.6906 (ms) / GPU bubble ratio: 55.12%
[rank1]:2025-12-28 23:10:06,184 - Avg. fwd time: 20.1894 / Avg. bwd time: 44.4433 / Avg. batch time: 923.3305 (ms) / GPU bubble ratio: 44.00%
[rank1]:2025-12-28 23:10:06,217 -  step: 400  loss: -4.0000  grad_norm:  0.9788  memory: 12.86GiB(27.07%)  tps: 9,177  tflops: 71.74  mfu: 22.99%
[rank0]:2025-12-28 23:10:06,228 -  step: 400  loss: -4.0000  grad_norm:  0.9788  memory: 16.87GiB(35.50%)  tps: 9,177  tflops: 71.74  mfu: 22.99%
[rank0]:2025-12-28 23:10:06,279 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2310_stage0_step400.svg
[rank2]:2025-12-28 23:10:06,213 -  step: 400  loss: -4.0000  grad_norm:  0.9788  memory:  8.66GiB(18.23%)  tps: 9,177  tflops: 71.74  mfu: 22.99%
[rank2]:2025-12-28 23:10:06,280 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2310_stage2_step400.svg
[rank3]:2025-12-28 23:10:06,226 -  step: 400  loss:  0.2225  grad_norm:  0.9788  memory: 25.79GiB(54.28%)  tps: 9,177  tflops: 71.74  mfu: 23.00%
[rank1]:2025-12-28 23:10:06,279 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2310_stage1_step400.svg
[rank3]:2025-12-28 23:10:06,372 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2310_step400_rank3.svg
[rank3]:			> Batch Time: 858.50 ms, GPU Bubble Ratio: 50.57%, 37.74%, 53.86%, 30.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  277-42-320ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  368-42-411ms   | [S0,MB5,F]  411-16-427ms   | [S0,MB2,B]  465-42-507ms   | [S0,MB6,F]  507-16-524ms   | [S0,MB3,B]  555-42-597ms   | [S0,MB7,F]  597-16-613ms   | [S0,MB4,B]  645-42-688ms   | [S0,MB5,B]  733-42-775ms   | [S0,MB6,B]  813-37-850ms   | [S0,MB7,B]  858-0-858ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  222-46-269ms   | [S1,MB3,F]  273-19-293ms   | [S1,MB1,B]  309-48-358ms   | [S1,MB4,F]  365-20-386ms   | [S1,MB2,B]  408-49-457ms   | [S1,MB5,F]  461-21-483ms   | [S1,MB3,B]  496-50-547ms   | [S1,MB6,F]  551-22-574ms   | [S1,MB4,B]  585-51-637ms   | [S1,MB7,F]  641-22-664ms   | [S1,MB5,B]  674-52-726ms   | [S1,MB6,B]  759-47-807ms   | [S1,MB7,B]  827-24-851ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-212ms   | [S2,MB2,F]  219-14-234ms   | [S2,MB1,B]  263-36-299ms   | [S2,MB3,F]  306-15-322ms   | [S2,MB2,B]  361-36-398ms   | [S2,MB4,F]  405-15-420ms   | [S2,MB3,B]  449-36-486ms   | [S2,MB5,F]  493-15-509ms   | [S2,MB4,B]  538-36-575ms   | [S2,MB6,F]  582-15-597ms   | [S2,MB5,B]  627-36-664ms   | [S2,MB7,F]  671-15-687ms   | [S2,MB6,B]  717-36-753ms   | [S2,MB7,B]  802-18-821ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-165ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  208-43-252ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  296-52-349ms   | [S3,MB3,F]  358-24-383ms   | [S3,MB3,B]  395-43-439ms   | [S3,MB4,F]  446-26-473ms   | [S3,MB4,B]  484-44-528ms   | [S3,MB5,F]  535-26-561ms   | [S3,MB5,B]  573-44-618ms   | [S3,MB6,F]  624-26-651ms   | [S3,MB6,B]  662-43-706ms   | [S3,MB7,F]  713-26-739ms   | [S3,MB7,B]  751-44-795ms  
[rank3]:2025-12-28 23:10:06,420 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2310_stage3_step400.svg
[rank1]:2025-12-28 23:10:06,424 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2310_rank1_stage1.svg
[rank1]:	> Counts Sum: 77400, Total Sum: 460800 (16.80%), Ratio(%) per element: [17.96, 17.57, 17.57, 17.57, 16.79, 17.96, 17.57, 17.18, 17.57, 16.79, 17.57, 17.96, 17.57, 17.18, 17.57, 16.79, 16.79, 16.79, 16.4, 16.79, 17.18, 16.79, 17.18, 17.57, 17.18, 17.18, 17.18, 16.4, 15.62, 16.4, 15.62, 15.62, 16.4, 16.4, 16.79, 16.79, 15.62, 15.23, 16.01, 16.4, 16.4, 15.62, 16.01, 16.4, 15.62]
[rank0]:2025-12-28 23:10:06,430 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2310_rank0_stage0.svg
[rank0]:	> Counts Sum: 76640, Total Sum: 378880 (20.23%), Ratio(%) per element: [17.96, 23.43, 21.87, 22.26, 21.09, 21.87, 22.26, 23.04, 21.48, 23.04, 20.7, 22.26, 19.53, 21.48, 20.31, 20.31, 20.31, 21.09, 20.7, 19.53, 20.7, 18.75, 19.92, 20.7, 20.7, 19.53, 20.7, 18.35, 17.57, 18.35, 18.75, 19.92, 19.14, 17.57, 16.79, 17.18, 19.14]
[rank2]:2025-12-28 23:10:06,432 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2310_rank2_stage2.svg
[rank2]:	> Counts Sum: 61920, Total Sum: 368640 (16.80%), Ratio(%) per element: [17.57, 17.18, 16.79, 16.4, 17.18, 16.79, 17.57, 17.18, 16.79, 16.79, 17.18, 17.18, 17.57, 17.96, 16.79, 17.18, 16.79, 17.18, 16.79, 17.57, 17.18, 17.18, 16.4, 17.18, 17.18, 17.57, 17.57, 15.23, 16.01, 15.23, 15.62, 16.4, 15.62, 16.01, 16.01, 15.62]
[rank3]:2025-12-28 23:10:06,556 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2310_rank3_stage3.svg
[rank3]:	> Counts Sum: 218480, Total Sum: 296960 (73.57%), Ratio(%) per element: [78.12, 79.68, 77.73, 77.73, 79.29, 80.46, 78.9, 80.85, 76.17, 76.56, 77.73, 74.21, 74.6, 76.56, 75.0, 78.12, 72.65, 77.34, 65.62, 63.28, 66.01, 69.14, 66.79, 67.57, 67.57, 69.14, 66.79, 71.09, 68.75]
[rank0]:2025-12-28 23:10:06,839 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2310_stage0.svg
[rank2]:2025-12-28 23:10:06,854 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2310_stage2.svg
[rank1]:2025-12-28 23:10:06,835 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2310_stage1.svg
[rank3]:2025-12-28 23:10:06,966 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2310_stage3.svg
[rank3]:2025-12-28 23:10:27,198 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 23:10:27,609 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 23:10:27,577 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 23:10:27,607 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 23:13:02,099 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 23:13:05,636 - Avg. fwd time: 25.1289 / Avg. bwd time: 58.2293 / Avg. batch time: 813.3857 (ms) / GPU bubble ratio: 18.01%
[rank2]:2025-12-28 23:13:05,665 - Avg. fwd time: 15.0697 / Avg. bwd time: 33.6311 / Avg. batch time: 858.5954 (ms) / GPU bubble ratio: 54.62%
[rank2]:2025-12-28 23:13:05,727 -  step: 450  loss: -4.0000  grad_norm:  0.1925  memory:  8.66GiB(18.23%)  tps: 9,127  tflops: 71.35  mfu: 22.87%
[rank0]:2025-12-28 23:13:05,706 - Avg. fwd time: 16.2511 / Avg. bwd time: 36.2875 / Avg. batch time: 950.8891 (ms) / GPU bubble ratio: 55.80%
[rank0]:2025-12-28 23:13:05,742 -  step: 450  loss: -4.0000  grad_norm:  0.1925  memory: 16.87GiB(35.50%)  tps: 9,127  tflops: 71.35  mfu: 22.87%
[rank1]:2025-12-28 23:13:05,697 - Avg. fwd time: 20.2138 / Avg. bwd time: 44.5829 / Avg. batch time: 914.6282 (ms) / GPU bubble ratio: 43.32%
[rank1]:2025-12-28 23:13:05,732 -  step: 450  loss: -4.0000  grad_norm:  0.1925  memory: 12.86GiB(27.07%)  tps: 9,127  tflops: 71.35  mfu: 22.87%
[rank3]:2025-12-28 23:13:05,740 -  step: 450  loss:  0.2294  grad_norm:  0.1925  memory: 25.79GiB(54.28%)  tps: 9,127  tflops: 71.35  mfu: 22.87%
[rank0]:2025-12-28 23:16:02,842 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 23:16:06,309 - Avg. fwd time: 25.1409 / Avg. bwd time: 57.5630 / Avg. batch time: 808.0996 (ms) / GPU bubble ratio: 18.13%
[rank0]:2025-12-28 23:16:06,380 - Avg. fwd time: 16.2644 / Avg. bwd time: 36.2939 / Avg. batch time: 943.4021 (ms) / GPU bubble ratio: 55.43%
[rank2]:2025-12-28 23:16:06,338 - Avg. fwd time: 15.0809 / Avg. bwd time: 33.6744 / Avg. batch time: 852.8680 (ms) / GPU bubble ratio: 54.27%
[rank1]:2025-12-28 23:16:06,372 - Avg. fwd time: 20.2348 / Avg. bwd time: 44.6729 / Avg. batch time: 908.4118 (ms) / GPU bubble ratio: 42.84%
[rank1]:2025-12-28 23:16:06,406 -  step: 500  loss: -4.0000  grad_norm:  0.1943  memory: 12.86GiB(27.07%)  tps: 9,068  tflops: 70.89  mfu: 22.72%
[rank3]:2025-12-28 23:16:06,414 -  step: 500  loss:  0.2239  grad_norm:  0.1943  memory: 25.79GiB(54.28%)  tps: 9,068  tflops: 70.89  mfu: 22.72%
[rank0]:2025-12-28 23:16:06,416 -  step: 500  loss: -4.0000  grad_norm:  0.1943  memory: 16.87GiB(35.50%)  tps: 9,068  tflops: 70.89  mfu: 22.72%
[rank0]:2025-12-28 23:16:06,463 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2316_stage0_step500.svg
[rank2]:2025-12-28 23:16:06,402 -  step: 500  loss: -4.0000  grad_norm:  0.1943  memory:  8.66GiB(18.23%)  tps: 9,068  tflops: 70.89  mfu: 22.72%
[rank2]:2025-12-28 23:16:06,464 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2316_stage2_step500.svg
[rank1]:2025-12-28 23:16:06,464 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2316_stage1_step500.svg
[rank1]:2025-12-28 23:16:06,612 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2316_rank1_stage1.svg
[rank1]:	> Counts Sum: 95400, Total Sum: 604800 (15.77%), Ratio(%) per element: [16.66, 16.36, 16.36, 16.36, 15.77, 16.66, 16.36, 16.07, 16.36, 15.77, 16.36, 16.66, 16.36, 16.07, 16.36, 15.77, 15.77, 15.77, 15.47, 15.77, 16.07, 15.77, 16.07, 16.36, 16.07, 16.07, 16.07, 15.47, 14.88, 15.47, 14.88, 14.88, 15.47, 15.47, 15.77, 15.77, 14.88, 14.58, 15.17, 15.47, 15.47, 14.88, 15.17, 15.47, 14.88]
[rank3]:2025-12-28 23:16:06,575 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2316_step500_rank3.svg
[rank3]:			> Batch Time: 873.50 ms, GPU Bubble Ratio: 51.32%, 39.39%, 54.75%, 29.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  275-42-318ms   | [S0,MB4,F]  318-15-334ms   | [S0,MB1,B]  364-42-407ms   | [S0,MB5,F]  407-16-423ms   | [S0,MB2,B]  479-42-521ms   | [S0,MB6,F]  521-16-537ms   | [S0,MB3,B]  569-42-612ms   | [S0,MB7,F]  612-16-628ms   | [S0,MB4,B]  659-42-702ms   | [S0,MB5,B]  748-42-790ms   | [S0,MB6,B]  830-38-868ms   | [S0,MB7,B]  873-0-873ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  221-46-268ms   | [S1,MB3,F]  272-19-292ms   | [S1,MB1,B]  308-48-356ms   | [S1,MB4,F]  361-21-382ms   | [S1,MB2,B]  423-47-470ms   | [S1,MB5,F]  475-21-496ms   | [S1,MB3,B]  513-49-562ms   | [S1,MB6,F]  566-22-588ms   | [S1,MB4,B]  601-51-652ms   | [S1,MB7,F]  656-22-678ms   | [S1,MB5,B]  690-51-741ms   | [S1,MB6,B]  775-47-823ms   | [S1,MB7,B]  842-24-866ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  174-36-211ms   | [S2,MB2,F]  218-14-233ms   | [S2,MB1,B]  261-36-298ms   | [S2,MB3,F]  305-15-320ms   | [S2,MB2,B]  377-36-413ms   | [S2,MB4,F]  420-15-435ms   | [S2,MB3,B]  467-36-503ms   | [S2,MB5,F]  510-15-526ms   | [S2,MB4,B]  555-36-591ms   | [S2,MB6,F]  598-15-613ms   | [S2,MB5,B]  643-36-680ms   | [S2,MB7,F]  687-15-702ms   | [S2,MB6,B]  732-36-768ms   | [S2,MB7,B]  817-18-835ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-76-164ms    | [S3,MB1,F]  171-24-195ms   | [S3,MB1,B]  207-43-250ms   | [S3,MB2,F]  258-24-283ms   | [S3,MB2,B]  295-73-368ms   | [S3,MB3,F]  374-25-399ms   | [S3,MB3,B]  412-43-456ms   | [S3,MB4,F]  464-25-490ms   | [S3,MB4,B]  500-43-544ms   | [S3,MB5,F]  551-26-577ms   | [S3,MB5,B]  589-43-633ms   | [S3,MB6,F]  640-25-666ms   | [S3,MB6,B]  678-43-722ms   | [S3,MB7,F]  729-26-755ms   | [S3,MB7,B]  766-43-810ms  
[rank3]:2025-12-28 23:16:06,618 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2316_stage3_step500.svg
[rank0]:2025-12-28 23:16:06,617 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2316_rank0_stage0.svg
[rank0]:	> Counts Sum: 96240, Total Sum: 497280 (19.35%), Ratio(%) per element: [16.96, 21.72, 21.13, 22.02, 20.83, 20.83, 21.72, 22.61, 20.83, 21.72, 19.64, 20.23, 19.34, 20.23, 19.04, 18.45, 19.64, 20.23, 19.64, 19.04, 19.34, 18.45, 19.04, 19.34, 19.34, 18.75, 19.34, 18.15, 16.66, 17.26, 17.85, 19.04, 18.45, 17.26, 16.66, 17.55, 17.55]
[rank2]:2025-12-28 23:16:06,616 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2316_rank2_stage2.svg
[rank2]:	> Counts Sum: 76320, Total Sum: 483840 (15.77%), Ratio(%) per element: [16.36, 16.07, 15.77, 15.47, 16.07, 15.77, 16.36, 16.07, 15.77, 15.77, 16.07, 16.07, 16.36, 16.66, 15.77, 16.07, 15.77, 16.07, 15.77, 16.36, 16.07, 16.07, 15.47, 16.07, 16.07, 16.36, 16.36, 14.58, 15.17, 14.58, 14.88, 15.47, 14.88, 15.17, 15.17, 14.88]
[rank3]:2025-12-28 23:16:06,763 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2316_rank3_stage3.svg
[rank3]:	> Counts Sum: 292880, Total Sum: 389760 (75.14%), Ratio(%) per element: [80.05, 80.65, 79.46, 79.16, 80.35, 80.95, 80.05, 81.25, 77.97, 76.48, 77.97, 75.89, 75.89, 77.38, 75.59, 78.86, 75.0, 77.97, 68.15, 66.96, 69.04, 70.83, 69.64, 69.94, 69.94, 70.83, 69.34, 72.61, 70.83]
[rank0]:2025-12-28 23:16:07,160 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2316_stage0.svg
[rank2]:2025-12-28 23:16:07,166 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2316_stage2.svg
[rank1]:2025-12-28 23:16:07,151 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2316_stage1.svg
[rank3]:2025-12-28 23:16:07,331 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2316_stage3.svg
[rank0]:2025-12-28 23:19:02,644 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 23:19:06,216 - Avg. fwd time: 25.1351 / Avg. bwd time: 56.9424 / Avg. batch time: 803.1016 (ms) / GPU bubble ratio: 18.24%
[rank0]:2025-12-28 23:19:06,286 - Avg. fwd time: 16.2750 / Avg. bwd time: 36.2748 / Avg. batch time: 936.6424 (ms) / GPU bubble ratio: 55.12%
[rank2]:2025-12-28 23:19:06,245 - Avg. fwd time: 15.0983 / Avg. bwd time: 33.7113 / Avg. batch time: 847.5559 (ms) / GPU bubble ratio: 53.93%
[rank2]:2025-12-28 23:19:06,307 -  step: 550  loss: -4.0000  grad_norm:  0.5507  memory:  8.66GiB(18.23%)  tps: 9,107  tflops: 71.19  mfu: 22.82%
[rank1]:2025-12-28 23:19:06,277 - Avg. fwd time: 20.2577 / Avg. bwd time: 44.7754 / Avg. batch time: 902.7006 (ms) / GPU bubble ratio: 42.37%
[rank1]:2025-12-28 23:19:06,311 -  step: 550  loss: -4.0000  grad_norm:  0.5507  memory: 12.86GiB(27.07%)  tps: 9,107  tflops: 71.19  mfu: 22.82%
[rank3]:2025-12-28 23:19:06,320 -  step: 550  loss:  0.2286  grad_norm:  0.5507  memory: 25.79GiB(54.28%)  tps: 9,107  tflops: 71.20  mfu: 22.82%
[rank0]:2025-12-28 23:19:06,322 -  step: 550  loss: -4.0000  grad_norm:  0.5507  memory: 16.87GiB(35.50%)  tps: 9,107  tflops: 71.19  mfu: 22.82%
[rank0]:2025-12-28 23:22:02,265 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 23:22:05,876 - Avg. fwd time: 25.1467 / Avg. bwd time: 56.4291 / Avg. batch time: 799.1148 (ms) / GPU bubble ratio: 18.33%
[rank2]:2025-12-28 23:22:05,904 - Avg. fwd time: 15.1055 / Avg. bwd time: 33.7412 / Avg. batch time: 843.2658 (ms) / GPU bubble ratio: 53.66%
[rank0]:2025-12-28 23:22:05,946 - Avg. fwd time: 16.2848 / Avg. bwd time: 36.2420 / Avg. batch time: 931.1431 (ms) / GPU bubble ratio: 54.87%
[rank0]:2025-12-28 23:22:05,982 -  step: 600  loss: -4.0000  grad_norm:  1.0454  memory: 16.87GiB(35.50%)  tps: 9,119  tflops: 71.29  mfu: 22.85%
[rank1]:2025-12-28 23:22:05,937 - Avg. fwd time: 20.2743 / Avg. bwd time: 44.8541 / Avg. batch time: 898.0743 (ms) / GPU bubble ratio: 41.98%
[rank1]:2025-12-28 23:22:05,973 -  step: 600  loss: -4.0000  grad_norm:  1.0454  memory: 12.86GiB(27.07%)  tps: 9,119  tflops: 71.29  mfu: 22.85%
[rank3]:2025-12-28 23:22:05,981 -  step: 600  loss:  0.2239  grad_norm:  1.0454  memory: 25.79GiB(54.28%)  tps: 9,120  tflops: 71.29  mfu: 22.85%
[rank2]:2025-12-28 23:22:05,968 -  step: 600  loss: -4.0000  grad_norm:  1.0454  memory:  8.66GiB(18.23%)  tps: 9,119  tflops: 71.29  mfu: 22.85%
[rank2]:2025-12-28 23:22:06,032 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2322_stage2_step600.svg
[rank0]:2025-12-28 23:22:06,031 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2322_stage0_step600.svg
[rank1]:2025-12-28 23:22:06,031 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2322_stage1_step600.svg
[rank0]:2025-12-28 23:22:06,184 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2322_rank0_stage0.svg
[rank0]:	> Counts Sum: 115840, Total Sum: 615680 (18.81%), Ratio(%) per element: [17.06, 21.39, 20.67, 22.11, 20.43, 20.67, 21.39, 22.35, 20.43, 21.15, 18.5, 18.99, 18.5, 19.23, 18.26, 17.54, 19.47, 19.23, 18.99, 18.99, 18.75, 17.78, 18.02, 18.99, 18.5, 17.78, 19.23, 17.3, 16.58, 16.34, 17.54, 18.02, 18.02, 17.06, 16.1, 17.06, 17.54]
[rank1]:2025-12-28 23:22:06,178 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2322_rank1_stage1.svg
[rank1]:	> Counts Sum: 113400, Total Sum: 748800 (15.14%), Ratio(%) per element: [15.86, 15.62, 15.62, 15.62, 15.14, 15.86, 15.62, 15.38, 15.62, 15.14, 15.62, 15.86, 15.62, 15.38, 15.62, 15.14, 15.14, 15.14, 14.9, 15.14, 15.38, 15.14, 15.38, 15.62, 15.38, 15.38, 15.38, 14.9, 14.42, 14.9, 14.42, 14.42, 14.9, 14.9, 15.14, 15.14, 14.42, 14.18, 14.66, 14.9, 14.9, 14.42, 14.66, 14.9, 14.42]
[rank3]:2025-12-28 23:22:06,131 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2322_step600_rank3.svg
[rank3]:			> Batch Time: 877.50 ms, GPU Bubble Ratio: 52.53%, 39.71%, 55.10%, 29.59%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  275-42-318ms   | [S0,MB4,F]  318-15-333ms   | [S0,MB1,B]  365-42-407ms   | [S0,MB5,F]  407-16-423ms   | [S0,MB2,B]  482-42-525ms   | [S0,MB6,F]  525-16-541ms   | [S0,MB3,B]  574-42-616ms   | [S0,MB7,F]  616-16-632ms   | [S0,MB4,B]  664-42-707ms   | [S0,MB5,B]  752-42-794ms   | [S0,MB6,B]  834-30-864ms   | [S0,MB7,B]  877-0-877ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  220-46-266ms   | [S1,MB3,F]  271-19-291ms   | [S1,MB1,B]  308-48-356ms   | [S1,MB4,F]  361-21-383ms   | [S1,MB2,B]  428-46-475ms   | [S1,MB5,F]  479-21-500ms   | [S1,MB3,B]  516-49-565ms   | [S1,MB6,F]  570-22-592ms   | [S1,MB4,B]  605-50-656ms   | [S1,MB7,F]  661-22-683ms   | [S1,MB5,B]  694-51-746ms   | [S1,MB6,B]  780-47-828ms   | [S1,MB7,B]  846-24-870ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  262-36-298ms   | [S2,MB3,F]  305-15-321ms   | [S2,MB2,B]  382-35-418ms   | [S2,MB4,F]  425-15-440ms   | [S2,MB3,B]  469-36-506ms   | [S2,MB5,F]  513-15-528ms   | [S2,MB4,B]  559-36-595ms   | [S2,MB6,F]  602-15-618ms   | [S2,MB5,B]  648-36-684ms   | [S2,MB7,F]  691-15-706ms   | [S2,MB6,B]  736-36-773ms   | [S2,MB7,B]  822-18-840ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-195ms   | [S3,MB1,B]  208-43-251ms   | [S3,MB2,F]  259-25-284ms   | [S3,MB2,B]  296-76-372ms   | [S3,MB3,F]  379-25-404ms   | [S3,MB3,B]  416-43-460ms   | [S3,MB4,F]  466-25-492ms   | [S3,MB4,B]  504-44-548ms   | [S3,MB5,F]  555-26-581ms   | [S3,MB5,B]  593-43-637ms   | [S3,MB6,F]  644-25-670ms   | [S3,MB6,B]  682-44-726ms   | [S3,MB7,F]  733-26-759ms   | [S3,MB7,B]  771-43-815ms  
[rank3]:2025-12-28 23:22:06,176 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2322_stage3_step600.svg
[rank2]:2025-12-28 23:22:06,186 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2322_rank2_stage2.svg
[rank2]:	> Counts Sum: 90720, Total Sum: 599040 (15.14%), Ratio(%) per element: [15.62, 15.38, 15.14, 14.9, 15.38, 15.14, 15.62, 15.38, 15.14, 15.14, 15.38, 15.38, 15.62, 15.86, 15.14, 15.38, 15.14, 15.38, 15.14, 15.62, 15.38, 15.38, 14.9, 15.38, 15.38, 15.62, 15.62, 14.18, 14.66, 14.18, 14.42, 14.9, 14.42, 14.66, 14.66, 14.42]
[rank3]:2025-12-28 23:22:06,311 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2322_rank3_stage3.svg
[rank3]:	> Counts Sum: 367280, Total Sum: 482560 (76.11%), Ratio(%) per element: [80.04, 81.0, 80.52, 79.56, 80.04, 81.0, 80.52, 80.76, 78.36, 76.92, 78.6, 77.16, 76.92, 76.92, 75.96, 78.6, 76.2, 78.6, 71.15, 69.95, 71.39, 72.35, 71.39, 71.63, 71.87, 72.83, 70.43, 73.79, 72.59]
[rank0]:2025-12-28 23:22:06,853 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2322_stage0.svg
[rank1]:2025-12-28 23:22:06,836 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2322_stage1.svg
[rank2]:2025-12-28 23:22:06,869 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2322_stage2.svg
[rank3]:2025-12-28 23:22:06,983 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2322_stage3.svg
[rank0]:2025-12-28 23:25:01,283 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 23:25:04,838 - Avg. fwd time: 25.1485 / Avg. bwd time: 55.9276 / Avg. batch time: 795.1481 (ms) / GPU bubble ratio: 18.43%
[rank2]:2025-12-28 23:25:04,868 - Avg. fwd time: 15.1162 / Avg. bwd time: 33.7702 / Avg. batch time: 839.0695 (ms) / GPU bubble ratio: 53.39%
[rank2]:2025-12-28 23:25:04,933 -  step: 650  loss: -4.0000  grad_norm:  0.1646  memory:  8.66GiB(18.23%)  tps: 9,155  tflops: 71.57  mfu: 22.94%
[rank1]:2025-12-28 23:25:04,901 - Avg. fwd time: 20.2964 / Avg. bwd time: 44.9451 / Avg. batch time: 893.5934 (ms) / GPU bubble ratio: 41.59%
[rank1]:2025-12-28 23:25:04,937 -  step: 650  loss: -4.0000  grad_norm:  0.1646  memory: 12.86GiB(27.07%)  tps: 9,155  tflops: 71.57  mfu: 22.94%
[rank0]:2025-12-28 23:25:04,911 - Avg. fwd time: 16.2943 / Avg. bwd time: 36.2518 / Avg. batch time: 925.9287 (ms) / GPU bubble ratio: 54.60%
[rank0]:2025-12-28 23:25:04,947 -  step: 650  loss: -4.0000  grad_norm:  0.1646  memory: 16.87GiB(35.50%)  tps: 9,155  tflops: 71.57  mfu: 22.94%
[rank3]:2025-12-28 23:25:04,945 -  step: 650  loss:  0.2319  grad_norm:  0.1646  memory: 25.79GiB(54.28%)  tps: 9,155  tflops: 71.57  mfu: 22.94%
[rank0]:2025-12-28 23:28:00,943 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 23:28:04,469 - Avg. fwd time: 25.1544 / Avg. bwd time: 55.5713 / Avg. batch time: 792.3223 (ms) / GPU bubble ratio: 18.49%
[rank0]:2025-12-28 23:28:04,542 - Avg. fwd time: 16.2995 / Avg. bwd time: 36.2557 / Avg. batch time: 921.9985 (ms) / GPU bubble ratio: 54.40%
[rank2]:2025-12-28 23:28:04,499 - Avg. fwd time: 15.1237 / Avg. bwd time: 33.7925 / Avg. batch time: 836.0238 (ms) / GPU bubble ratio: 53.19%
[rank1]:2025-12-28 23:28:04,532 - Avg. fwd time: 20.3189 / Avg. bwd time: 44.9983 / Avg. batch time: 890.2980 (ms) / GPU bubble ratio: 41.31%
[rank1]:2025-12-28 23:28:04,568 -  step: 700  loss: -4.0000  grad_norm:  0.4923  memory: 12.86GiB(27.07%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank3]:2025-12-28 23:28:04,576 -  step: 700  loss:  0.1903  grad_norm:  0.4923  memory: 25.79GiB(54.28%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank0]:2025-12-28 23:28:04,578 -  step: 700  loss: -4.0000  grad_norm:  0.4923  memory: 16.87GiB(35.50%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank0]:2025-12-28 23:28:04,628 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2328_stage0_step700.svg
[rank2]:2025-12-28 23:28:04,564 -  step: 700  loss: -4.0000  grad_norm:  0.4923  memory:  8.66GiB(18.23%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank2]:2025-12-28 23:28:04,628 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2328_stage2_step700.svg
[rank1]:2025-12-28 23:28:04,628 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2328_stage1_step700.svg
[rank3]:2025-12-28 23:28:04,722 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2328_step700_rank3.svg
[rank3]:			> Batch Time: 873.50 ms, GPU Bubble Ratio: 51.89%, 39.38%, 54.80%, 29.62%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  274-42-316ms   | [S0,MB4,F]  317-15-332ms   | [S0,MB1,B]  363-42-405ms   | [S0,MB5,F]  405-16-422ms   | [S0,MB2,B]  479-42-521ms   | [S0,MB6,F]  522-16-538ms   | [S0,MB3,B]  570-42-612ms   | [S0,MB7,F]  613-16-629ms   | [S0,MB4,B]  659-42-701ms   | [S0,MB5,B]  748-42-790ms   | [S0,MB6,B]  831-33-864ms   | [S0,MB7,B]  873-0-873ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  218-46-265ms   | [S1,MB3,F]  270-19-290ms   | [S1,MB1,B]  305-48-353ms   | [S1,MB4,F]  359-21-381ms   | [S1,MB2,B]  424-47-471ms   | [S1,MB5,F]  476-21-497ms   | [S1,MB3,B]  512-48-561ms   | [S1,MB6,F]  566-22-588ms   | [S1,MB4,B]  601-50-651ms   | [S1,MB7,F]  655-22-678ms   | [S1,MB5,B]  689-51-741ms   | [S1,MB6,B]  776-47-823ms   | [S1,MB7,B]  842-24-866ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  172-36-208ms   | [S2,MB2,F]  215-14-230ms   | [S2,MB1,B]  258-36-295ms   | [S2,MB3,F]  302-15-318ms   | [S2,MB2,B]  377-36-413ms   | [S2,MB4,F]  420-14-435ms   | [S2,MB3,B]  465-36-502ms   | [S2,MB5,F]  509-15-525ms   | [S2,MB4,B]  554-36-591ms   | [S2,MB6,F]  598-15-613ms   | [S2,MB5,B]  643-36-679ms   | [S2,MB7,F]  686-15-701ms   | [S2,MB6,B]  733-36-769ms   | [S2,MB7,B]  817-18-835ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-73-161ms    | [S3,MB1,F]  168-24-193ms   | [S3,MB1,B]  205-43-249ms   | [S3,MB2,F]  256-25-281ms   | [S3,MB2,B]  292-75-367ms   | [S3,MB3,F]  374-25-399ms   | [S3,MB3,B]  411-43-455ms   | [S3,MB4,F]  463-26-489ms   | [S3,MB4,B]  500-43-544ms   | [S3,MB5,F]  551-26-577ms   | [S3,MB5,B]  589-43-633ms   | [S3,MB6,F]  640-26-666ms   | [S3,MB6,B]  678-44-722ms   | [S3,MB7,F]  730-26-756ms   | [S3,MB7,B]  768-43-811ms  
[rank1]:2025-12-28 23:28:04,773 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2328_rank1_stage1.svg
[rank1]:	> Counts Sum: 131400, Total Sum: 892800 (14.72%), Ratio(%) per element: [15.32, 15.12, 15.12, 15.12, 14.71, 15.32, 15.12, 14.91, 15.12, 14.71, 15.12, 15.32, 15.12, 14.91, 15.12, 14.71, 14.71, 14.71, 14.51, 14.71, 14.91, 14.71, 14.91, 15.12, 14.91, 14.91, 14.91, 14.51, 14.11, 14.51, 14.11, 14.11, 14.51, 14.51, 14.71, 14.71, 14.11, 13.91, 14.31, 14.51, 14.51, 14.11, 14.31, 14.51, 14.11]
[rank3]:2025-12-28 23:28:04,770 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2328_stage3_step700.svg
[rank0]:2025-12-28 23:28:04,779 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2328_rank0_stage0.svg
[rank0]:	> Counts Sum: 135440, Total Sum: 734080 (18.45%), Ratio(%) per element: [16.33, 21.37, 20.96, 22.17, 20.36, 20.96, 21.37, 22.37, 20.76, 21.16, 18.14, 18.34, 18.14, 18.95, 18.14, 17.13, 19.15, 18.75, 18.14, 18.54, 18.34, 16.93, 17.13, 18.14, 17.74, 16.93, 18.34, 16.93, 16.53, 15.92, 16.73, 17.94, 17.54, 16.53, 15.72, 16.93, 16.93]
[rank2]:2025-12-28 23:28:04,781 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2328_rank2_stage2.svg
[rank2]:	> Counts Sum: 105120, Total Sum: 714240 (14.72%), Ratio(%) per element: [15.12, 14.91, 14.71, 14.51, 14.91, 14.71, 15.12, 14.91, 14.71, 14.71, 14.91, 14.91, 15.12, 15.32, 14.71, 14.91, 14.71, 14.91, 14.71, 15.12, 14.91, 14.91, 14.51, 14.91, 14.91, 15.12, 15.12, 13.91, 14.31, 13.91, 14.11, 14.51, 14.11, 14.31, 14.31, 14.11]
[rank3]:2025-12-28 23:28:04,908 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2328_rank3_stage3.svg
[rank3]:	> Counts Sum: 441680, Total Sum: 575360 (76.77%), Ratio(%) per element: [80.44, 81.65, 80.64, 80.24, 80.44, 81.65, 81.45, 81.04, 79.43, 76.81, 78.62, 77.21, 77.01, 77.21, 76.61, 78.62, 76.61, 78.83, 72.58, 71.16, 72.58, 73.99, 72.98, 72.58, 72.78, 73.38, 71.57, 74.19, 73.79]
[rank1]:2025-12-28 23:28:05,554 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2328_stage1.svg
[rank0]:2025-12-28 23:28:05,569 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2328_stage0.svg
[rank2]:2025-12-28 23:28:05,590 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2328_stage2.svg
[rank3]:2025-12-28 23:28:05,699 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2328_stage3.svg
[rank0]:2025-12-28 23:31:02,403 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 23:31:06,016 - Avg. fwd time: 25.1561 / Avg. bwd time: 55.3073 / Avg. batch time: 790.1758 (ms) / GPU bubble ratio: 18.54%
[rank2]:2025-12-28 23:31:06,046 - Avg. fwd time: 15.1281 / Avg. bwd time: 33.8108 / Avg. batch time: 833.7095 (ms) / GPU bubble ratio: 53.04%
[rank1]:2025-12-28 23:31:06,080 - Avg. fwd time: 20.3405 / Avg. bwd time: 45.0395 / Avg. batch time: 887.7709 (ms) / GPU bubble ratio: 41.08%
[rank1]:2025-12-28 23:31:06,115 -  step: 750  loss: -4.0000  grad_norm:  0.4340  memory: 12.86GiB(27.07%)  tps: 9,025  tflops: 70.55  mfu: 22.61%
[rank3]:2025-12-28 23:31:06,124 -  step: 750  loss:  0.2349  grad_norm:  0.4340  memory: 25.79GiB(54.28%)  tps: 9,025  tflops: 70.55  mfu: 22.61%
[rank0]:2025-12-28 23:31:06,090 - Avg. fwd time: 16.3033 / Avg. bwd time: 36.2556 / Avg. batch time: 918.9203 (ms) / GPU bubble ratio: 54.24%
[rank0]:2025-12-28 23:31:06,126 -  step: 750  loss: -4.0000  grad_norm:  0.4340  memory: 16.87GiB(35.50%)  tps: 9,025  tflops: 70.55  mfu: 22.61%
[rank2]:2025-12-28 23:31:06,111 -  step: 750  loss: -4.0000  grad_norm:  0.4340  memory:  8.66GiB(18.23%)  tps: 9,025  tflops: 70.55  mfu: 22.61%
[rank0]:2025-12-28 23:34:03,058 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 23:34:06,705 - Avg. fwd time: 25.1600 / Avg. bwd time: 55.0768 / Avg. batch time: 788.3292 (ms) / GPU bubble ratio: 18.58%
[rank2]:2025-12-28 23:34:06,735 - Avg. fwd time: 15.1330 / Avg. bwd time: 33.8264 / Avg. batch time: 831.6982 (ms) / GPU bubble ratio: 52.91%
[rank0]:2025-12-28 23:34:06,780 - Avg. fwd time: 16.3073 / Avg. bwd time: 36.2426 / Avg. batch time: 916.2403 (ms) / GPU bubble ratio: 54.12%
[rank1]:2025-12-28 23:34:06,769 - Avg. fwd time: 20.3589 / Avg. bwd time: 45.0764 / Avg. batch time: 885.5735 (ms) / GPU bubble ratio: 40.89%
[rank1]:2025-12-28 23:34:06,805 -  step: 800  loss: -4.0000  grad_norm:  1.1159  memory: 12.86GiB(27.07%)  tps: 9,067  tflops: 70.89  mfu: 22.72%
[rank1]:2025-12-28 23:34:06,805 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.1159  tps: 9,201  tflops: 71.93  mfu: 21.10%
[rank1]:2025-12-28 23:34:06,806 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 23:34:06,806 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 23:34:06,814 -  step: 800  loss:  0.2380  grad_norm:  1.1159  memory: 25.79GiB(54.28%)  tps: 9,068  tflops: 70.89  mfu: 22.72%
[rank3]:2025-12-28 23:34:06,815 - â„¹ï¸ final step: 800  loss:  0.2380  grad_norm:  1.1159  tps: 9,207  tflops: 71.97  mfu: 21.21%
[rank3]:2025-12-28 23:34:06,815 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 23:34:06,816 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-28 23:34:06,802 -  step: 800  loss: -4.0000  grad_norm:  1.1159  memory:  8.66GiB(18.23%)  tps: 9,067  tflops: 70.89  mfu: 22.72%
[rank2]:2025-12-28 23:34:06,802 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.1159  tps: 9,200  tflops: 71.92  mfu: 21.07%
[rank2]:2025-12-28 23:34:06,802 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 23:34:06,803 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 23:34:06,816 -  step: 800  loss: -4.0000  grad_norm:  1.1159  memory: 16.87GiB(35.50%)  tps: 9,067  tflops: 70.89  mfu: 22.72%
[rank0]:2025-12-28 23:34:06,816 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.1159  tps: 9,200  tflops: 71.92  mfu: 21.07%
[rank0]:2025-12-28 23:34:06,816 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 23:34:06,817 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 23:34:09,231 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-28 23:34:09,294 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_2334_stage1_final800.svg
[rank2]:2025-12-28 23:34:09,299 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_2334_stage2_final800.svg
[rank0]:2025-12-28 23:34:09,294 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_2334_stage0_final800.svg
[rank3]:2025-12-28 23:34:09,389 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2334_final800_rank3.svg
[rank3]:			> Batch Time: 875.00 ms, GPU Bubble Ratio: 51.72%, 39.74%, 54.95%, 29.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  367-42-409ms   | [S0,MB5,F]  409-16-425ms   | [S0,MB2,B]  480-42-522ms   | [S0,MB6,F]  522-16-538ms   | [S0,MB3,B]  571-42-614ms   | [S0,MB7,F]  614-16-630ms   | [S0,MB4,B]  661-42-704ms   | [S0,MB5,B]  749-42-791ms   | [S0,MB6,B]  830-36-866ms   | [S0,MB7,B]  875-0-875ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  271-19-291ms   | [S1,MB1,B]  309-47-357ms   | [S1,MB4,F]  363-21-385ms   | [S1,MB2,B]  424-46-471ms   | [S1,MB5,F]  476-21-497ms   | [S1,MB3,B]  514-49-563ms   | [S1,MB6,F]  568-22-590ms   | [S1,MB4,B]  602-50-653ms   | [S1,MB7,F]  658-22-680ms   | [S1,MB5,B]  691-51-743ms   | [S1,MB6,B]  776-46-823ms   | [S1,MB7,B]  844-24-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  263-36-299ms   | [S2,MB3,F]  306-15-322ms   | [S2,MB2,B]  378-35-414ms   | [S2,MB4,F]  421-15-436ms   | [S2,MB3,B]  467-36-503ms   | [S2,MB5,F]  511-15-526ms   | [S2,MB4,B]  556-36-592ms   | [S2,MB6,F]  599-15-615ms   | [S2,MB5,B]  645-36-681ms   | [S2,MB7,F]  688-15-703ms   | [S2,MB6,B]  734-36-770ms   | [S2,MB7,B]  819-18-837ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-43-250ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  296-73-370ms   | [S3,MB3,F]  375-25-400ms   | [S3,MB3,B]  413-44-457ms   | [S3,MB4,F]  464-25-489ms   | [S3,MB4,B]  501-44-545ms   | [S3,MB5,F]  552-26-578ms   | [S3,MB5,B]  590-44-635ms   | [S3,MB6,F]  642-25-668ms   | [S3,MB6,B]  679-44-723ms   | [S3,MB7,F]  730-25-756ms   | [S3,MB7,B]  768-44-812ms  
[rank0]:2025-12-28 23:34:09,445 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2334_rank0_stage0.svg
[rank0]:	> Counts Sum: 155040, Total Sum: 852480 (18.19%), Ratio(%) per element: [15.97, 21.35, 21.18, 21.87, 20.48, 21.18, 21.18, 22.22, 20.65, 21.35, 17.88, 17.88, 18.05, 18.4, 18.22, 16.84, 18.57, 18.22, 17.53, 18.4, 17.7, 17.01, 16.84, 18.05, 17.36, 16.84, 17.88, 16.66, 15.97, 15.62, 16.31, 17.36, 17.01, 16.14, 15.62, 16.31, 16.66]
[rank1]:2025-12-28 23:34:09,440 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2334_rank1_stage1.svg
[rank1]:	> Counts Sum: 149400, Total Sum: 1036800 (14.41%), Ratio(%) per element: [14.93, 14.75, 14.75, 14.75, 14.4, 14.93, 14.75, 14.58, 14.75, 14.4, 14.75, 14.93, 14.75, 14.58, 14.75, 14.4, 14.4, 14.4, 14.23, 14.4, 14.58, 14.4, 14.58, 14.75, 14.58, 14.58, 14.58, 14.23, 13.88, 14.23, 13.88, 13.88, 14.23, 14.23, 14.4, 14.4, 13.88, 13.71, 14.06, 14.23, 14.23, 13.88, 14.06, 14.23, 13.88]
[rank3]:2025-12-28 23:34:09,530 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/pipeline_schedule/251228_2334_thry_final800_rank3.svg
[rank3]:			> Batch Time: 637.14 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-57ms     | [S0,MB3,F]  57-19-77ms     | [S0,MB0,B]  193-38-231ms   | [S0,MB4,F]  231-19-250ms   | [S0,MB1,B]  250-38-289ms   | [S0,MB5,F]  289-19-308ms   | [S0,MB2,B]  308-38-347ms   | [S0,MB6,F]  347-19-366ms   | [S0,MB3,B]  366-38-405ms   | [S0,MB7,F]  405-19-424ms   | [S0,MB4,B]  424-38-463ms   | [S0,MB5,B]  482-38-521ms   | [S0,MB6,B]  540-38-579ms   | [S0,MB7,B]  598-38-637ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB0,B]  154-38-193ms   | [S1,MB3,F]  193-19-212ms   | [S1,MB1,B]  212-38-250ms   | [S1,MB4,F]  250-19-270ms   | [S1,MB2,B]  270-38-308ms   | [S1,MB5,F]  308-19-328ms   | [S1,MB3,B]  328-38-366ms   | [S1,MB6,F]  366-19-386ms   | [S1,MB4,B]  386-38-424ms   | [S1,MB7,F]  424-19-444ms   | [S1,MB5,B]  444-38-482ms   | [S1,MB6,B]  501-38-540ms   | [S1,MB7,B]  559-38-598ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-57ms     | [S2,MB1,F]  57-19-77ms     | [S2,MB0,B]  115-38-154ms   | [S2,MB2,F]  154-19-173ms   | [S2,MB1,B]  173-38-212ms   | [S2,MB3,F]  212-19-231ms   | [S2,MB2,B]  231-38-270ms   | [S2,MB4,F]  270-19-289ms   | [S2,MB3,B]  289-38-328ms   | [S2,MB5,F]  328-19-347ms   | [S2,MB4,B]  347-38-386ms   | [S2,MB6,F]  386-19-405ms   | [S2,MB5,B]  405-38-444ms   | [S2,MB7,F]  444-19-463ms   | [S2,MB6,B]  463-38-501ms   | [S2,MB7,B]  521-38-559ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  57-19-77ms     | [S3,MB0,B]  77-38-115ms    | [S3,MB1,F]  115-19-135ms   | [S3,MB1,B]  135-38-173ms   | [S3,MB2,F]  173-19-193ms   | [S3,MB2,B]  193-38-231ms   | [S3,MB3,F]  231-19-250ms   | [S3,MB3,B]  250-38-289ms   | [S3,MB4,F]  289-19-308ms   | [S3,MB4,B]  308-38-347ms   | [S3,MB5,F]  347-19-366ms   | [S3,MB5,B]  366-38-405ms   | [S3,MB6,F]  405-19-424ms   | [S3,MB6,B]  424-38-463ms   | [S3,MB7,F]  463-19-482ms   | [S3,MB7,B]  482-38-521ms  
[rank2]:2025-12-28 23:34:09,465 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2334_rank2_stage2.svg
[rank2]:	> Counts Sum: 119520, Total Sum: 829440 (14.41%), Ratio(%) per element: [14.75, 14.58, 14.4, 14.23, 14.58, 14.4, 14.75, 14.58, 14.4, 14.4, 14.58, 14.58, 14.75, 14.93, 14.4, 14.58, 14.4, 14.58, 14.4, 14.75, 14.58, 14.58, 14.23, 14.58, 14.58, 14.75, 14.75, 13.71, 14.06, 13.71, 13.88, 14.23, 13.88, 14.06, 14.06, 13.88]
[rank3]:2025-12-28 23:34:09,579 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_2334_stage3_final800.svg
[rank3]:2025-12-28 23:34:09,714 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/frozen_params_histogram/251228_2334_rank3_stage3.svg
[rank3]:	> Counts Sum: 516080, Total Sum: 668160 (77.24%), Ratio(%) per element: [80.72, 81.42, 80.9, 80.55, 80.55, 81.42, 81.25, 81.42, 79.86, 77.77, 78.81, 77.77, 77.6, 78.12, 76.9, 78.99, 77.6, 79.16, 73.26, 72.22, 73.43, 74.65, 73.61, 73.43, 73.43, 73.95, 72.56, 74.47, 73.95]
[rank0]:2025-12-28 23:34:10,369 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2334_stage0.svg
[rank0]:2025-12-28 23:34:10,370 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-28 23:34:10,358 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2334_stage1.svg
[rank1]:2025-12-28 23:34:10,360 - Destroying the purge thread.
[rank2]:2025-12-28 23:34:10,520 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2334_stage2.svg
[rank2]:2025-12-28 23:34:10,523 - Destroying the purge thread.
[rank3]:2025-12-28 23:34:10,631 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1/afr_time_plot/251228_2334_stage3.svg
[rank3]:2025-12-28 23:34:10,633 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-12-28 23:34:10,776 - Process group destroyed
[rank2]:2025-12-28 23:34:10,788 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 315-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.5591
[rank3]:wandb:               final/avg_loss 0.23798
[rank3]:wandb:             final/avg_mfu(%) 21.20808
[rank3]:wandb:             final/avg_tflops 71.97465
[rank3]:wandb:    final/avg_throughput(tps) 9206.81671
[rank3]:wandb:              final/grad_norm 1.11594
[rank3]:wandb:               final/max_loss 0.23798
[rank3]:wandb:                    grad_norm 1.11594
[rank3]:wandb: loss_metrics/global_avg_loss 0.23798
[rank3]:wandb: loss_metrics/global_max_loss 0.23798
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_1F1B_timelyauto_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/5aeibs58
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_1F1B_timelyauto_11_dm1/20251228-2243/wandb/run-20251228_224340-5aeibs58/logs
[rank3]:2025-12-28 23:34:11,777 - Process group destroyed
[rank0]:2025-12-28 23:34:12,371 - Training completed
[rank0]:2025-12-28 23:34:12,371 - Destroying the purge thread.
[rank0]:2025-12-28 23:34:12,835 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.1', 'layers.0', 'layers.2', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.8', 'layers.4', 'layers.5', 'layers.6'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'output', 'layers.15', 'layers.14', 'norm'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_1F1B_timelyauto_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_1F1B_timelyauto_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_1F1B_timelyauto_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_1F1B_timelyauto_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_1F1B_timelyauto_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_1F1B_timelyauto_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_1F1B_timelyauto_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_1F1B_timelyauto_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
