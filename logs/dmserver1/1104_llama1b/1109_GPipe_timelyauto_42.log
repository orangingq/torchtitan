
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 11. (í™”) 19:41:07 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_GPipe_timelyauto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-11 19:41:14,697 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank2]:2025-11-11 19:41:14,702 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank3]:2025-11-11 19:41:14,695 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank1]:2025-11-11 19:41:14,697 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank2]:2025-11-11 19:41:14,956 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-11 19:41:14,958 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 19:41:15,051 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-11 19:41:15,053 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 19:41:15,056 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-11 19:41:15,057 - INFO - Loading tokenizer from tokenizer.json
[rank3]:2025-11-11 19:41:15,066 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-11 19:41:15,068 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-11 19:41:15,075 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-11 19:41:15,077 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 19:41:15,458 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-11 19:41:18,397 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-11 19:41:18,537 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-11 19:41:18,579 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 19:41:18,604 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-11 19:41:18,604 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-11 19:41:18,547 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-11 19:41:18,585 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 19:41:18,586 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-11 19:41:18,611 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-11 19:41:18,612 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-11 19:41:18,800 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 19:41:18,800 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-11 19:41:18,800 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-11 19:41:18,807 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 19:41:18,807 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-11 19:41:18,808 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-11 19:41:18,748 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-11 19:41:18,791 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 19:41:18,818 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-11 19:41:18,818 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-11 19:41:19,005 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 19:41:19,006 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-11 19:41:19,006 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run krjflp3o
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_GPipe_timelyauto_42_dm1/20251111-1941/wandb/run-20251111_194120-krjflp3o
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_GPipe_timelyauto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/krjflp3o
[rank3]:2025-11-11 19:41:21,277 - INFO - WandB logging enabled
[rank3]:2025-11-11 19:41:21,279 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-11 19:41:21,317 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-11 19:41:21,344 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-11 19:41:21,344 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-11 19:41:21,553 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_GPipe_timelyauto_42_dm1
[rank0]:2025-11-11 19:41:21,553 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 19:41:21,553 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-11 19:41:21,553 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-11 19:41:21,553 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-11 19:41:21,536 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-11 19:41:21,537 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-11 19:41:21,537 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank2]:2025-11-11 19:41:21,553 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-11 19:41:21,553 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 19:41:23,990 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-11 19:41:23,990 - INFO - Finished loading the checkpoint in 2.44 seconds.
[rank0]:2025-11-11 19:41:23,990 - INFO - Training starts at step 1
[rank3]:2025-11-11 19:41:29,471 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5367  memory: 24.19GiB(50.91%)  tps: 4,020  tflops: 31.43  mfu: 10.07%
[rank3]:2025-11-11 19:41:29,472 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-11 19:41:29,498 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory: 12.80GiB(26.95%)  tps: 3,003  tflops: 23.48  mfu: 7.52%
[rank0]:2025-11-11 19:41:29,498 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-11 19:41:29,463 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory: 12.38GiB(26.05%)  tps: 3,070  tflops: 24.00  mfu: 7.69%
[rank1]:2025-11-11 19:41:29,464 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-11 19:41:29,461 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory:  9.99GiB(21.03%)  tps: 3,011  tflops: 23.54  mfu: 7.55%
[rank2]:2025-11-11 19:41:29,461 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-11 19:43:26,575 - INFO - Avg. fwd time: 10.7222 / Avg. bwd time: 42.4179 / Avg. batch time: 484.8556 (ms) / GPU bubble ratio: 12.32%
[rank1]:2025-11-11 19:43:26,683 - INFO - Avg. fwd time: 9.2198 / Avg. bwd time: 24.2166 / Avg. batch time: 556.3885 (ms) / GPU bubble ratio: 51.92%
[rank2]:2025-11-11 19:43:26,644 - INFO - Avg. fwd time: 7.1653 / Avg. bwd time: 18.8626 / Avg. batch time: 516.8441 (ms) / GPU bubble ratio: 59.71%
[rank0]:2025-11-11 19:43:26,691 - INFO - Avg. fwd time: 8.1420 / Avg. bwd time: 24.0758 / Avg. batch time: 594.3879 (ms) / GPU bubble ratio: 56.64%
[rank0]:2025-11-11 19:45:24,978 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 19:45:29,608 - INFO - Avg. fwd time: 10.7795 / Avg. bwd time: 42.7713 / Avg. batch time: 488.0036 (ms) / GPU bubble ratio: 12.21%
[rank0]:2025-11-11 19:45:29,727 - INFO - Avg. fwd time: 8.1592 / Avg. bwd time: 24.1285 / Avg. batch time: 596.3050 (ms) / GPU bubble ratio: 56.68%
[rank1]:2025-11-11 19:45:29,719 - INFO - Avg. fwd time: 9.2388 / Avg. bwd time: 24.2739 / Avg. batch time: 558.6777 (ms) / GPU bubble ratio: 52.01%
[rank2]:2025-11-11 19:45:29,680 - INFO - Avg. fwd time: 7.1744 / Avg. bwd time: 18.9092 / Avg. batch time: 519.5187 (ms) / GPU bubble ratio: 59.83%
[rank0]:2025-11-11 19:45:29,908 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.6111  memory: 16.57GiB(34.88%)  tps: 6,679  tflops: 52.21  mfu: 16.73%
[rank1]:2025-11-11 19:45:29,896 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.6111  memory: 14.64GiB(30.82%)  tps: 6,678  tflops: 52.21  mfu: 16.73%
[rank2]:2025-11-11 19:45:29,892 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.6111  memory: 11.81GiB(24.85%)  tps: 6,678  tflops: 52.21  mfu: 16.73%
[rank3]:2025-11-11 19:45:29,905 - INFO -  step: 50  loss:  9.9084  grad_norm: 12.6111  memory: 26.98GiB(56.79%)  tps: 6,678  tflops: 52.21  mfu: 16.73%
[rank3]:2025-11-11 19:46:19,256 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-11 19:47:08,773 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank0]:2025-11-11 19:47:09,163 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,164 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,103 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-11 19:47:09,154 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:09,172 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:09,181 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:09,191 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:09,200 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,185 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,200 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,233 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,171 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,182 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,212 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,249 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,177 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,202 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,218 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,241 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,270 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,354 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,286 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,332 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:47:09,369 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:09,395 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:09,433 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,394 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:47:09,434 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,372 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,412 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,454 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:09,475 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:47:09,495 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:47:25,683 - INFO - Avg. fwd time: 8.2327 / Avg. bwd time: 22.5688 / Avg. batch time: 584.8897 (ms) / GPU bubble ratio: 57.87%
[rank2]:2025-11-11 19:47:25,660 - INFO - Avg. fwd time: 7.2724 / Avg. bwd time: 18.2477 / Avg. batch time: 510.7999 (ms) / GPU bubble ratio: 60.03%
[rank3]:2025-11-11 19:47:25,641 - INFO - Avg. fwd time: 10.9762 / Avg. bwd time: 41.5909 / Avg. batch time: 480.1002 (ms) / GPU bubble ratio: 12.41%
[rank1]:2025-11-11 19:47:25,677 - INFO - Avg. fwd time: 9.3650 / Avg. bwd time: 23.4227 / Avg. batch time: 548.9863 (ms) / GPU bubble ratio: 52.22%
[rank3]:2025-11-11 19:47:41,901 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-11 19:47:42,258 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_1947_max_batch_time.svg
[rank3]:> Batch Time: 529.63 ms, GPU Bubble Ratio: 51.13%, 49.40%, 60.59%, 18.32%
[rank3]:2025-11-11 19:47:42,403 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_1947_min_batch_time.svg
[rank3]:> Batch Time: 306.88 ms, GPU Bubble Ratio: 78.93%, 47.65%, 59.39%, 15.93%
[rank3]:2025-11-11 19:47:42,569 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_1947_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 338.80 ms, GPU Bubble Ratio: 41.51%, 32.69%, 41.50%, 14.43%
[rank3]:2025-11-11 19:47:42,570 - INFO - 	> Batch Time: 338.80 ms (Average Freeze Ratio: 0.40, Time Reduction Rate: 0.36)
[rank0]:2025-11-11 19:48:56,903 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 19:49:01,228 - INFO - Avg. fwd time: 11.4058 / Avg. bwd time: 38.3283 / Avg. batch time: 457.4085 (ms) / GPU bubble ratio: 13.02%
[rank2]:2025-11-11 19:49:01,294 - INFO - Avg. fwd time: 7.5401 / Avg. bwd time: 16.4904 / Avg. batch time: 486.8330 (ms) / GPU bubble ratio: 60.51%
[rank1]:2025-11-11 19:49:01,347 - INFO - Avg. fwd time: 9.7028 / Avg. bwd time: 21.1394 / Avg. batch time: 522.6686 (ms) / GPU bubble ratio: 52.79%
[rank0]:2025-11-11 19:49:01,333 - INFO - Avg. fwd time: 8.4075 / Avg. bwd time: 19.0296 / Avg. batch time: 554.9543 (ms) / GPU bubble ratio: 60.45%
[rank1]:2025-11-11 19:49:01,518 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.07/0.22, [MB2] 0.00/0.00, [MB3] 0.14/0.41, [MB4] 0.06/0.19, [MB5] 0.05/0.15, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-11 19:49:01,518 - INFO -  step: 100  loss: -8.0000  grad_norm:  7.3784  memory: 14.64GiB(30.82%)  tps: 7,742  tflops: 60.52  mfu: 19.40%
[rank1]:2025-11-11 19:49:01,591 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_1949_stage1_step100.svg
[rank0]:2025-11-11 19:49:01,533 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.32/0.95, [MB6] 0.18/0.55, [MB7] 0.33/1.00
[rank0]:2025-11-11 19:49:01,534 - INFO -  step: 100  loss: -8.0000  grad_norm:  7.3784  memory: 16.57GiB(34.88%)  tps: 7,742  tflops: 60.52  mfu: 19.40%
[rank0]:2025-11-11 19:49:01,591 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_1949_stage0_step100.svg
[rank3]:2025-11-11 19:49:01,528 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-11 19:49:01,532 - INFO -  step: 100  loss:  9.0902  grad_norm:  7.3784  memory: 31.43GiB(66.17%)  tps: 7,742  tflops: 60.52  mfu: 19.40%
[rank2]:2025-11-11 19:49:01,516 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-11 19:49:01,516 - INFO -  step: 100  loss: -8.0000  grad_norm:  7.3784  memory: 11.81GiB(24.85%)  tps: 7,742  tflops: 60.52  mfu: 19.40%
[rank2]:2025-11-11 19:49:01,591 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_1949_stage2_step100.svg
[rank3]:2025-11-11 19:49:01,678 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_1949_real_step100_rank3.svg
[rank3]:> Batch Time: 566.31 ms, GPU Bubble Ratio: 56.81%, 59.07%, 67.62%, 27.25%
[rank3]:2025-11-11 19:49:01,720 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_1949_stage3_step100.svg
[rank3]:2025-11-11 19:50:55,921 - INFO - Avg. fwd time: 11.3830 / Avg. bwd time: 38.4931 / Avg. batch time: 458.5311 (ms) / GPU bubble ratio: 12.98%
[rank0]:2025-11-11 19:50:56,039 - INFO - Avg. fwd time: 8.4435 / Avg. bwd time: 19.3060 / Avg. batch time: 555.4366 (ms) / GPU bubble ratio: 60.03%
[rank2]:2025-11-11 19:50:56,000 - INFO - Avg. fwd time: 7.5943 / Avg. bwd time: 16.1101 / Avg. batch time: 487.4951 (ms) / GPU bubble ratio: 61.10%
[rank1]:2025-11-11 19:50:56,054 - INFO - Avg. fwd time: 9.7674 / Avg. bwd time: 20.6518 / Avg. batch time: 522.8350 (ms) / GPU bubble ratio: 53.46%
[rank0]:2025-11-11 19:52:42,716 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 19:52:46,981 - INFO - Avg. fwd time: 11.3849 / Avg. bwd time: 38.3526 / Avg. batch time: 457.4074 (ms) / GPU bubble ratio: 13.01%
[rank2]:2025-11-11 19:52:47,000 - INFO - Avg. fwd time: 7.6529 / Avg. bwd time: 15.6859 / Avg. batch time: 485.8158 (ms) / GPU bubble ratio: 61.57%
[rank0]:2025-11-11 19:52:47,041 - INFO - Avg. fwd time: 8.5147 / Avg. bwd time: 18.8096 / Avg. batch time: 552.6283 (ms) / GPU bubble ratio: 60.44%
[rank0]:2025-11-11 19:52:47,051 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.64/0.95, [MB6] 0.37/0.55, [MB7] 0.67/1.00
[rank0]:2025-11-11 19:52:47,051 - INFO -  step: 150  loss: -8.0000  grad_norm:  9.1640  memory: 17.04GiB(35.87%)  tps: 7,265  tflops: 56.80  mfu: 18.20%
[rank1]:2025-11-11 19:52:47,023 - INFO - Avg. fwd time: 9.8512 / Avg. bwd time: 20.0481 / Avg. batch time: 520.5315 (ms) / GPU bubble ratio: 54.05%
[rank1]:2025-11-11 19:52:47,052 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.15/0.22, [MB2] 0.00/0.00, [MB3] 0.27/0.41, [MB4] 0.13/0.19, [MB5] 0.10/0.15, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-11 19:52:47,053 - INFO -  step: 150  loss: -8.0000  grad_norm:  9.1640  memory: 15.23GiB(32.05%)  tps: 7,265  tflops: 56.79  mfu: 18.20%
[rank3]:2025-11-11 19:52:47,065 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-11 19:52:47,068 - INFO -  step: 150  loss:  5.2682  grad_norm:  9.1640  memory: 31.43GiB(66.17%)  tps: 7,265  tflops: 56.79  mfu: 18.20%
[rank2]:2025-11-11 19:52:47,051 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-11 19:52:47,051 - INFO -  step: 150  loss: -8.0000  grad_norm:  9.1640  memory: 12.08GiB(25.43%)  tps: 7,265  tflops: 56.79  mfu: 18.20%
[rank3]:2025-11-11 19:54:34,128 - INFO - Avg. fwd time: 11.4110 / Avg. bwd time: 38.0396 / Avg. batch time: 455.0984 (ms) / GPU bubble ratio: 13.07%
[rank2]:2025-11-11 19:54:34,184 - INFO - Avg. fwd time: 7.7184 / Avg. bwd time: 15.2351 / Avg. batch time: 482.9757 (ms) / GPU bubble ratio: 61.98%
[rank0]:2025-11-11 19:54:34,211 - INFO - Avg. fwd time: 8.6026 / Avg. bwd time: 18.3990 / Avg. batch time: 548.7977 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-11-11 19:54:34,236 - INFO - Avg. fwd time: 9.9329 / Avg. bwd time: 19.4536 / Avg. batch time: 517.0729 (ms) / GPU bubble ratio: 54.53%
[rank0]:2025-11-11 19:55:59,662 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 19:56:02,904 - INFO - Avg. fwd time: 11.6165 / Avg. bwd time: 36.3285 / Avg. batch time: 443.0411 (ms) / GPU bubble ratio: 13.43%
[rank0]:2025-11-11 19:56:02,979 - INFO - Avg. fwd time: 8.7118 / Avg. bwd time: 17.5867 / Avg. batch time: 534.2429 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-11-11 19:56:02,991 - INFO - Avg. fwd time: 10.0634 / Avg. bwd time: 18.5455 / Avg. batch time: 503.3223 (ms) / GPU bubble ratio: 54.53%
[rank2]:2025-11-11 19:56:02,956 - INFO - Avg. fwd time: 7.8188 / Avg. bwd time: 14.5635 / Avg. batch time: 470.1698 (ms) / GPU bubble ratio: 61.92%
[rank3]:2025-11-11 19:56:03,101 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-11 19:56:03,104 - INFO -  step: 200  loss:  2.2648  grad_norm:  0.0652  memory: 31.73GiB(66.78%)  tps: 8,358  tflops: 65.34  mfu: 20.94%
[rank0]:2025-11-11 19:56:03,116 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.95/0.95, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-11 19:56:03,116 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0652  memory: 17.04GiB(35.87%)  tps: 8,356  tflops: 65.33  mfu: 20.94%
[rank1]:2025-11-11 19:56:03,102 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.41/0.41, [MB4] 0.19/0.19, [MB5] 0.15/0.15, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-11 19:56:03,102 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0652  memory: 15.23GiB(32.05%)  tps: 8,357  tflops: 65.33  mfu: 20.94%
[rank2]:2025-11-11 19:56:03,101 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-11 19:56:03,102 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0652  memory: 12.08GiB(25.43%)  tps: 8,357  tflops: 65.33  mfu: 20.94%
[rank0]:2025-11-11 19:56:03,166 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_1956_stage0_step200.svg
[rank1]:2025-11-11 19:56:03,166 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_1956_stage1_step200.svg
[rank2]:2025-11-11 19:56:03,166 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_1956_stage2_step200.svg
[rank3]:2025-11-11 19:56:03,258 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_1956_real_step200_rank3.svg
[rank3]:> Batch Time: 410.21 ms, GPU Bubble Ratio: 55.58%, 55.63%, 64.99%, 32.49%
[rank3]:2025-11-11 19:56:03,302 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_1956_stage3_step200.svg
[rank0]:2025-11-11 19:57:24,710 - INFO - Avg. fwd time: 8.7799 / Avg. bwd time: 15.6158 / Avg. batch time: 518.3328 (ms) / GPU bubble ratio: 62.35%
[rank1]:2025-11-11 19:57:24,703 - INFO - Avg. fwd time: 10.1929 / Avg. bwd time: 17.6639 / Avg. batch time: 489.4525 (ms) / GPU bubble ratio: 54.47%
[rank3]:2025-11-11 19:57:24,669 - INFO - Avg. fwd time: 11.8408 / Avg. bwd time: 34.5733 / Avg. batch time: 430.7847 (ms) / GPU bubble ratio: 13.81%
[rank2]:2025-11-11 19:57:24,685 - INFO - Avg. fwd time: 7.9248 / Avg. bwd time: 13.8602 / Avg. batch time: 457.2122 (ms) / GPU bubble ratio: 61.88%
[rank0]:2025-11-11 19:58:42,952 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 19:58:45,832 - INFO - Avg. fwd time: 8.8227 / Avg. bwd time: 14.1964 / Avg. batch time: 507.2678 (ms) / GPU bubble ratio: 63.70%
[rank3]:2025-11-11 19:58:46,011 - INFO - Avg. fwd time: 11.9945 / Avg. bwd time: 33.3672 / Avg. batch time: 422.3585 (ms) / GPU bubble ratio: 14.08%
[rank2]:2025-11-11 19:58:46,051 - INFO - Avg. fwd time: 7.9979 / Avg. bwd time: 13.3715 / Avg. batch time: 448.2516 (ms) / GPU bubble ratio: 61.86%
[rank1]:2025-11-11 19:58:46,094 - INFO - Avg. fwd time: 10.2827 / Avg. bwd time: 17.0531 / Avg. batch time: 479.8607 (ms) / GPU bubble ratio: 54.43%
[rank2]:2025-11-11 19:58:46,171 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-11 19:58:46,181 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,047  tflops: 78.54  mfu: 25.17%
[rank0]:2025-11-11 19:58:46,183 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.95/0.95, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-11 19:58:46,183 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,047  tflops: 78.55  mfu: 25.18%
[rank1]:2025-11-11 19:58:46,183 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.41/0.41, [MB4] 0.19/0.19, [MB5] 0.15/0.15, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-11 19:58:46,184 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,047  tflops: 78.54  mfu: 25.17%
[rank3]:2025-11-11 19:58:46,171 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-11 19:58:46,183 - INFO -  step: 250  loss:  5.5821  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,047  tflops: 78.54  mfu: 25.17%
[rank0]:2025-11-11 20:00:07,403 - INFO - Avg. fwd time: 8.8644 / Avg. bwd time: 12.8353 / Avg. batch time: 496.7116 (ms) / GPU bubble ratio: 65.05%
[rank2]:2025-11-11 20:00:07,618 - INFO - Avg. fwd time: 8.0685 / Avg. bwd time: 12.9035 / Avg. batch time: 439.7153 (ms) / GPU bubble ratio: 61.84%
[rank3]:2025-11-11 20:00:07,580 - INFO - Avg. fwd time: 12.1443 / Avg. bwd time: 32.2149 / Avg. batch time: 414.3341 (ms) / GPU bubble ratio: 14.35%
[rank1]:2025-11-11 20:00:07,664 - INFO - Avg. fwd time: 10.3700 / Avg. bwd time: 16.4684 / Avg. batch time: 470.7167 (ms) / GPU bubble ratio: 54.39%
[rank0]:2025-11-11 20:01:26,139 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-11 20:01:29,395 - INFO - Avg. fwd time: 8.1265 / Avg. bwd time: 12.5173 / Avg. batch time: 432.6824 (ms) / GPU bubble ratio: 61.83%
[rank2]:2025-11-11 20:01:29,398 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-11 20:01:29,423 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,037  tflops: 78.46  mfu: 25.15%
[rank1]:2025-11-11 20:01:29,413 - INFO - Avg. fwd time: 10.4419 / Avg. bwd time: 15.9865 / Avg. batch time: 463.1859 (ms) / GPU bubble ratio: 54.35%
[rank1]:2025-11-11 20:01:29,418 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.41/0.41, [MB4] 0.19/0.19, [MB5] 0.15/0.15, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-11 20:01:29,423 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,037  tflops: 78.46  mfu: 25.15%
[rank0]:2025-11-11 20:01:29,421 - INFO - Avg. fwd time: 8.8984 / Avg. bwd time: 11.7124 / Avg. batch time: 488.0173 (ms) / GPU bubble ratio: 66.21%
[rank0]:2025-11-11 20:01:29,424 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.95/0.95, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-11 20:01:29,425 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,037  tflops: 78.46  mfu: 25.15%
[rank3]:2025-11-11 20:01:29,377 - INFO - Avg. fwd time: 12.2677 / Avg. bwd time: 31.2654 / Avg. batch time: 407.7219 (ms) / GPU bubble ratio: 14.58%
[rank3]:2025-11-11 20:01:29,392 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-11 20:01:29,424 - INFO -  step: 300  loss:  5.7337  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,037  tflops: 78.46  mfu: 25.15%
[rank2]:2025-11-11 20:01:29,478 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_2001_stage2_step300.svg
[rank1]:2025-11-11 20:01:29,474 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_2001_stage1_step300.svg
[rank0]:2025-11-11 20:01:29,477 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_2001_stage0_step300.svg
[rank3]:2025-11-11 20:01:29,570 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_2001_real_step300_rank3.svg
[rank3]:> Batch Time: 398.25 ms, GPU Bubble Ratio: 81.41%, 55.48%, 65.37%, 29.86%
[rank3]:2025-11-11 20:01:29,613 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_2001_stage3_step300.svg
[rank0]:2025-11-11 20:02:50,946 - INFO - Avg. fwd time: 8.9246 / Avg. bwd time: 10.8954 / Avg. batch time: 481.7735 (ms) / GPU bubble ratio: 67.09%
[rank3]:2025-11-11 20:02:51,128 - INFO - Avg. fwd time: 12.3593 / Avg. bwd time: 30.5779 / Avg. batch time: 402.9516 (ms) / GPU bubble ratio: 14.75%
[rank2]:2025-11-11 20:02:51,166 - INFO - Avg. fwd time: 8.1695 / Avg. bwd time: 12.2372 / Avg. batch time: 427.6462 (ms) / GPU bubble ratio: 61.83%
[rank1]:2025-11-11 20:02:51,212 - INFO - Avg. fwd time: 10.4956 / Avg. bwd time: 15.6369 / Avg. batch time: 457.7875 (ms) / GPU bubble ratio: 54.33%
[rank0]:2025-11-11 20:04:09,903 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 20:04:12,818 - INFO - Avg. fwd time: 8.9500 / Avg. bwd time: 10.0755 / Avg. batch time: 475.4231 (ms) / GPU bubble ratio: 67.99%
[rank2]:2025-11-11 20:04:13,037 - INFO - Avg. fwd time: 8.2121 / Avg. bwd time: 11.9554 / Avg. batch time: 422.5082 (ms) / GPU bubble ratio: 61.81%
[rank3]:2025-11-11 20:04:12,999 - INFO - Avg. fwd time: 12.4498 / Avg. bwd time: 29.8844 / Avg. batch time: 398.1250 (ms) / GPU bubble ratio: 14.93%
[rank1]:2025-11-11 20:04:13,078 - INFO - Avg. fwd time: 10.5484 / Avg. bwd time: 15.2853 / Avg. batch time: 452.2850 (ms) / GPU bubble ratio: 54.31%
[rank0]:2025-11-11 20:04:13,173 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,006  tflops: 78.22  mfu: 25.07%
[rank3]:2025-11-11 20:04:13,172 - INFO -  step: 350  loss:  4.0269  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,006  tflops: 78.22  mfu: 25.07%
[rank2]:2025-11-11 20:04:13,171 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,006  tflops: 78.22  mfu: 25.07%
[rank1]:2025-11-11 20:04:13,173 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,006  tflops: 78.22  mfu: 25.07%
[rank1]:2025-11-11 20:05:34,734 - INFO - Avg. fwd time: 10.5931 / Avg. bwd time: 14.9821 / Avg. batch time: 447.5195 (ms) / GPU bubble ratio: 54.28%
[rank2]:2025-11-11 20:05:34,714 - INFO - Avg. fwd time: 8.2485 / Avg. bwd time: 11.7128 / Avg. batch time: 418.0566 (ms) / GPU bubble ratio: 61.80%
[rank0]:2025-11-11 20:05:34,742 - INFO - Avg. fwd time: 8.9713 / Avg. bwd time: 9.3703 / Avg. batch time: 469.9275 (ms) / GPU bubble ratio: 68.78%
[rank3]:2025-11-11 20:05:34,696 - INFO - Avg. fwd time: 12.5262 / Avg. bwd time: 29.2850 / Avg. batch time: 393.9389 (ms) / GPU bubble ratio: 15.09%
[rank0]:2025-11-11 20:06:52,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 20:06:55,842 - INFO - Avg. fwd time: 8.9867 / Avg. bwd time: 8.8401 / Avg. batch time: 465.7483 (ms) / GPU bubble ratio: 69.38%
[rank2]:2025-11-11 20:06:56,065 - INFO - Avg. fwd time: 8.2756 / Avg. bwd time: 11.5298 / Avg. batch time: 414.6650 (ms) / GPU bubble ratio: 61.79%
[rank3]:2025-11-11 20:06:56,027 - INFO - Avg. fwd time: 12.5823 / Avg. bwd time: 28.8306 / Avg. batch time: 390.7490 (ms) / GPU bubble ratio: 15.21%
[rank1]:2025-11-11 20:06:56,112 - INFO - Avg. fwd time: 10.6261 / Avg. bwd time: 14.7531 / Avg. batch time: 443.8909 (ms) / GPU bubble ratio: 54.26%
[rank2]:2025-11-11 20:06:56,198 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,050  tflops: 78.57  mfu: 25.18%
[rank2]:2025-11-11 20:06:56,252 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_2006_stage2_step400.svg
[rank1]:2025-11-11 20:06:56,200 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,050  tflops: 78.57  mfu: 25.18%
[rank1]:2025-11-11 20:06:56,252 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_2006_stage1_step400.svg
[rank0]:2025-11-11 20:06:56,200 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,050  tflops: 78.57  mfu: 25.18%
[rank0]:2025-11-11 20:06:56,252 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_2006_stage0_step400.svg
[rank3]:2025-11-11 20:06:56,199 - INFO -  step: 400  loss:  2.2654  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,050  tflops: 78.57  mfu: 25.18%
[rank3]:2025-11-11 20:06:56,347 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_2006_real_step400_rank3.svg
[rank3]:> Batch Time: 394.50 ms, GPU Bubble Ratio: 81.29%, 55.29%, 65.19%, 29.79%
[rank3]:2025-11-11 20:06:56,394 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_2006_stage3_step400.svg
[rank3]:2025-11-11 20:07:14,850 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 20:07:15,012 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-11 20:07:14,999 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-11 20:07:15,016 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 20:08:17,301 - INFO - Avg. fwd time: 9.0030 / Avg. bwd time: 8.2926 / Avg. batch time: 461.4747 (ms) / GPU bubble ratio: 70.02%
[rank3]:2025-11-11 20:08:17,478 - INFO - Avg. fwd time: 12.6405 / Avg. bwd time: 28.3624 / Avg. batch time: 387.4667 (ms) / GPU bubble ratio: 15.34%
[rank2]:2025-11-11 20:08:17,521 - INFO - Avg. fwd time: 8.3037 / Avg. bwd time: 11.3411 / Avg. batch time: 411.2063 (ms) / GPU bubble ratio: 61.78%
[rank1]:2025-11-11 20:08:17,567 - INFO - Avg. fwd time: 10.6602 / Avg. bwd time: 14.5166 / Avg. batch time: 440.1849 (ms) / GPU bubble ratio: 54.24%
[rank0]:2025-11-11 20:09:35,773 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 20:09:38,981 - INFO - Avg. fwd time: 12.6917 / Avg. bwd time: 27.9495 / Avg. batch time: 384.5710 (ms) / GPU bubble ratio: 15.46%
[rank1]:2025-11-11 20:09:39,022 - INFO - Avg. fwd time: 10.6900 / Avg. bwd time: 14.3076 / Avg. batch time: 436.8865 (ms) / GPU bubble ratio: 54.23%
[rank1]:2025-11-11 20:09:39,032 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,062  tflops: 78.66  mfu: 25.21%
[rank2]:2025-11-11 20:09:39,001 - INFO - Avg. fwd time: 8.3283 / Avg. bwd time: 11.1742 / Avg. batch time: 408.1251 (ms) / GPU bubble ratio: 61.77%
[rank2]:2025-11-11 20:09:39,033 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,062  tflops: 78.66  mfu: 25.21%
[rank3]:2025-11-11 20:09:39,034 - INFO -  step: 450  loss:  5.7855  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,062  tflops: 78.66  mfu: 25.21%
[rank0]:2025-11-11 20:09:39,031 - INFO - Avg. fwd time: 9.0174 / Avg. bwd time: 7.8090 / Avg. batch time: 457.6777 (ms) / GPU bubble ratio: 70.59%
[rank0]:2025-11-11 20:09:39,034 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,062  tflops: 78.66  mfu: 25.21%
[rank0]:2025-11-11 20:11:00,213 - INFO - Avg. fwd time: 9.0286 / Avg. bwd time: 7.4372 / Avg. batch time: 454.8015 (ms) / GPU bubble ratio: 71.04%
[rank3]:2025-11-11 20:11:00,387 - INFO - Avg. fwd time: 12.7328 / Avg. bwd time: 27.6358 / Avg. batch time: 382.3892 (ms) / GPU bubble ratio: 15.54%
[rank1]:2025-11-11 20:11:00,475 - INFO - Avg. fwd time: 10.7140 / Avg. bwd time: 14.1481 / Avg. batch time: 434.3954 (ms) / GPU bubble ratio: 54.21%
[rank2]:2025-11-11 20:11:00,436 - INFO - Avg. fwd time: 8.3477 / Avg. bwd time: 11.0465 / Avg. batch time: 405.8002 (ms) / GPU bubble ratio: 61.77%
[rank0]:2025-11-11 20:12:18,936 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 20:12:21,823 - INFO - Avg. fwd time: 9.0404 / Avg. bwd time: 7.0459 / Avg. batch time: 451.7723 (ms) / GPU bubble ratio: 71.51%
[rank3]:2025-11-11 20:12:21,997 - INFO - Avg. fwd time: 12.7760 / Avg. bwd time: 27.3053 / Avg. batch time: 380.0896 (ms) / GPU bubble ratio: 15.64%
[rank2]:2025-11-11 20:12:22,041 - INFO - Avg. fwd time: 8.3678 / Avg. bwd time: 10.9119 / Avg. batch time: 403.3509 (ms) / GPU bubble ratio: 61.76%
[rank1]:2025-11-11 20:12:22,087 - INFO - Avg. fwd time: 10.7390 / Avg. bwd time: 13.9801 / Avg. batch time: 431.7716 (ms) / GPU bubble ratio: 54.20%
[rank2]:2025-11-11 20:12:22,170 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,043  tflops: 78.51  mfu: 25.16%
[rank3]:2025-11-11 20:12:22,171 - INFO -  step: 500  loss:  5.6957  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,043  tflops: 78.51  mfu: 25.16%
[rank0]:2025-11-11 20:12:22,172 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,043  tflops: 78.51  mfu: 25.16%
[rank1]:2025-11-11 20:12:22,172 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,043  tflops: 78.51  mfu: 25.16%
[rank2]:2025-11-11 20:12:22,222 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_2012_stage2_step500.svg
[rank0]:2025-11-11 20:12:22,220 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_2012_stage0_step500.svg
[rank1]:2025-11-11 20:12:22,220 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_2012_stage1_step500.svg
[rank3]:2025-11-11 20:12:22,320 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_2012_real_step500_rank3.svg
[rank3]:> Batch Time: 398.25 ms, GPU Bubble Ratio: 81.32%, 55.30%, 65.25%, 29.53%
[rank3]:2025-11-11 20:12:22,363 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_2012_stage3_step500.svg
[rank3]:2025-11-11 20:13:43,980 - INFO - Avg. fwd time: 12.8155 / Avg. bwd time: 27.0096 / Avg. batch time: 378.0400 (ms) / GPU bubble ratio: 15.72%
[rank2]:2025-11-11 20:13:44,000 - INFO - Avg. fwd time: 8.3862 / Avg. bwd time: 10.7911 / Avg. batch time: 401.1938 (ms) / GPU bubble ratio: 61.76%
[rank1]:2025-11-11 20:13:44,020 - INFO - Avg. fwd time: 10.7620 / Avg. bwd time: 13.8295 / Avg. batch time: 429.4598 (ms) / GPU bubble ratio: 54.19%
[rank0]:2025-11-11 20:13:44,031 - INFO - Avg. fwd time: 9.0514 / Avg. bwd time: 6.6937 / Avg. batch time: 449.0975 (ms) / GPU bubble ratio: 71.95%
[rank0]:2025-11-11 20:15:02,460 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 20:15:05,381 - INFO - Avg. fwd time: 9.0604 / Avg. bwd time: 6.4187 / Avg. batch time: 446.9991 (ms) / GPU bubble ratio: 72.30%
[rank3]:2025-11-11 20:15:05,559 - INFO - Avg. fwd time: 12.8471 / Avg. bwd time: 26.7798 / Avg. batch time: 376.4535 (ms) / GPU bubble ratio: 15.79%
[rank2]:2025-11-11 20:15:05,604 - INFO - Avg. fwd time: 8.4008 / Avg. bwd time: 10.6970 / Avg. batch time: 399.5012 (ms) / GPU bubble ratio: 61.76%
[rank1]:2025-11-11 20:15:05,650 - INFO - Avg. fwd time: 10.7805 / Avg. bwd time: 13.7123 / Avg. batch time: 427.6461 (ms) / GPU bubble ratio: 54.18%
[rank3]:2025-11-11 20:15:05,736 - INFO -  step: 550  loss:  4.0239  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank0]:2025-11-11 20:15:05,736 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank1]:2025-11-11 20:15:05,737 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank2]:2025-11-11 20:15:05,734 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank0]:2025-11-11 20:16:27,044 - INFO - Avg. fwd time: 9.0692 / Avg. bwd time: 6.1251 / Avg. batch time: 444.7306 (ms) / GPU bubble ratio: 72.67%
[rank3]:2025-11-11 20:16:27,223 - INFO - Avg. fwd time: 12.8795 / Avg. bwd time: 26.5322 / Avg. batch time: 374.7317 (ms) / GPU bubble ratio: 15.86%
[rank2]:2025-11-11 20:16:27,268 - INFO - Avg. fwd time: 8.4161 / Avg. bwd time: 10.5963 / Avg. batch time: 397.6663 (ms) / GPU bubble ratio: 61.75%
[rank1]:2025-11-11 20:16:27,315 - INFO - Avg. fwd time: 10.7997 / Avg. bwd time: 13.5867 / Avg. batch time: 425.6815 (ms) / GPU bubble ratio: 54.17%
[rank0]:2025-11-11 20:17:45,583 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 20:17:48,871 - INFO - Avg. fwd time: 12.9087 / Avg. bwd time: 26.3051 / Avg. batch time: 373.1471 (ms) / GPU bubble ratio: 15.93%
[rank3]:2025-11-11 20:17:48,927 - INFO -  step: 600  loss:  2.2484  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,040  tflops: 78.49  mfu: 25.16%
[rank0]:2025-11-11 20:17:48,925 - INFO - Avg. fwd time: 9.0777 / Avg. bwd time: 5.8573 / Avg. batch time: 442.6495 (ms) / GPU bubble ratio: 73.01%
[rank0]:2025-11-11 20:17:48,928 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,040  tflops: 78.49  mfu: 25.16%
[rank2]:2025-11-11 20:17:48,892 - INFO - Avg. fwd time: 8.4302 / Avg. bwd time: 10.5043 / Avg. batch time: 395.9793 (ms) / GPU bubble ratio: 61.75%
[rank2]:2025-11-11 20:17:48,926 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,040  tflops: 78.49  mfu: 25.16%
[rank1]:2025-11-11 20:17:48,914 - INFO - Avg. fwd time: 10.8171 / Avg. bwd time: 13.4718 / Avg. batch time: 423.8764 (ms) / GPU bubble ratio: 54.16%
[rank1]:2025-11-11 20:17:48,926 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,040  tflops: 78.49  mfu: 25.16%
[rank0]:2025-11-11 20:17:48,979 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_2017_stage0_step600.svg
[rank2]:2025-11-11 20:17:48,987 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_2017_stage2_step600.svg
[rank1]:2025-11-11 20:17:48,979 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_2017_stage1_step600.svg
[rank3]:2025-11-11 20:17:49,074 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_2017_real_step600_rank3.svg
[rank3]:> Batch Time: 395.50 ms, GPU Bubble Ratio: 81.28%, 55.22%, 65.17%, 29.75%
[rank3]:2025-11-11 20:17:49,118 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_2017_stage3_step600.svg
[rank0]:2025-11-11 20:19:10,119 - INFO - Avg. fwd time: 9.0836 / Avg. bwd time: 5.6456 / Avg. batch time: 440.9835 (ms) / GPU bubble ratio: 73.28%
[rank3]:2025-11-11 20:19:10,294 - INFO - Avg. fwd time: 12.9303 / Avg. bwd time: 26.1226 / Avg. batch time: 371.8581 (ms) / GPU bubble ratio: 15.98%
[rank2]:2025-11-11 20:19:10,339 - INFO - Avg. fwd time: 8.4408 / Avg. bwd time: 10.4310 / Avg. batch time: 394.6289 (ms) / GPU bubble ratio: 61.74%
[rank1]:2025-11-11 20:19:10,382 - INFO - Avg. fwd time: 10.8297 / Avg. bwd time: 13.3799 / Avg. batch time: 422.4298 (ms) / GPU bubble ratio: 54.15%
[rank0]:2025-11-11 20:20:28,653 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 20:20:31,534 - INFO - Avg. fwd time: 9.0909 / Avg. bwd time: 5.4173 / Avg. batch time: 439.1982 (ms) / GPU bubble ratio: 73.57%
[rank2]:2025-11-11 20:20:31,752 - INFO - Avg. fwd time: 8.4528 / Avg. bwd time: 10.3525 / Avg. batch time: 393.1816 (ms) / GPU bubble ratio: 61.74%
[rank3]:2025-11-11 20:20:31,715 - INFO - Avg. fwd time: 12.9551 / Avg. bwd time: 25.9282 / Avg. batch time: 370.5001 (ms) / GPU bubble ratio: 16.04%
[rank1]:2025-11-11 20:20:31,796 - INFO - Avg. fwd time: 10.8443 / Avg. bwd time: 13.2816 / Avg. batch time: 420.8802 (ms) / GPU bubble ratio: 54.14%
[rank2]:2025-11-11 20:20:31,876 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,055  tflops: 78.60  mfu: 25.19%
[rank0]:2025-11-11 20:20:31,878 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,055  tflops: 78.60  mfu: 25.19%
[rank1]:2025-11-11 20:20:31,878 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,055  tflops: 78.60  mfu: 25.19%
[rank3]:2025-11-11 20:20:31,877 - INFO -  step: 650  loss:  5.4747  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,055  tflops: 78.60  mfu: 25.19%
[rank3]:2025-11-11 20:21:53,344 - INFO - Avg. fwd time: 12.9773 / Avg. bwd time: 25.7486 / Avg. batch time: 369.2406 (ms) / GPU bubble ratio: 16.10%
[rank2]:2025-11-11 20:21:53,365 - INFO - Avg. fwd time: 8.4635 / Avg. bwd time: 10.2799 / Avg. batch time: 391.8409 (ms) / GPU bubble ratio: 61.73%
[rank1]:2025-11-11 20:21:53,388 - INFO - Avg. fwd time: 10.8573 / Avg. bwd time: 13.1906 / Avg. batch time: 419.4457 (ms) / GPU bubble ratio: 54.13%
[rank0]:2025-11-11 20:21:53,400 - INFO - Avg. fwd time: 9.0970 / Avg. bwd time: 5.2067 / Avg. batch time: 437.5468 (ms) / GPU bubble ratio: 73.85%
[rank0]:2025-11-11 20:23:11,737 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 20:23:14,614 - INFO - Avg. fwd time: 9.1024 / Avg. bwd time: 5.0388 / Avg. batch time: 436.2541 (ms) / GPU bubble ratio: 74.07%
[rank1]:2025-11-11 20:23:14,877 - INFO - Avg. fwd time: 10.8684 / Avg. bwd time: 13.1187 / Avg. batch time: 418.3271 (ms) / GPU bubble ratio: 54.13%
[rank3]:2025-11-11 20:23:14,797 - INFO - Avg. fwd time: 12.9963 / Avg. bwd time: 25.6076 / Avg. batch time: 368.2623 (ms) / GPU bubble ratio: 16.14%
[rank2]:2025-11-11 20:23:14,835 - INFO - Avg. fwd time: 8.4724 / Avg. bwd time: 10.2223 / Avg. batch time: 390.7969 (ms) / GPU bubble ratio: 61.73%
[rank0]:2025-11-11 20:23:14,960 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,046  tflops: 78.54  mfu: 25.17%
[rank1]:2025-11-11 20:23:14,960 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,046  tflops: 78.54  mfu: 25.17%
[rank3]:2025-11-11 20:23:14,960 - INFO -  step: 700  loss:  5.7365  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,047  tflops: 78.54  mfu: 25.17%
[rank2]:2025-11-11 20:23:14,958 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,046  tflops: 78.54  mfu: 25.17%
[rank0]:2025-11-11 20:23:15,012 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_2023_stage0_step700.svg
[rank1]:2025-11-11 20:23:15,011 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_2023_stage1_step700.svg
[rank2]:2025-11-11 20:23:15,012 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_2023_stage2_step700.svg
[rank3]:2025-11-11 20:23:15,108 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_2023_real_step700_rank3.svg
[rank3]:> Batch Time: 398.25 ms, GPU Bubble Ratio: 81.36%, 55.36%, 65.30%, 29.67%
[rank3]:2025-11-11 20:23:15,155 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_2023_stage3_step700.svg
[rank0]:2025-11-11 20:24:36,422 - INFO - Avg. fwd time: 9.1080 / Avg. bwd time: 4.8561 / Avg. batch time: 434.8588 (ms) / GPU bubble ratio: 74.31%
[rank1]:2025-11-11 20:24:36,690 - INFO - Avg. fwd time: 10.8801 / Avg. bwd time: 13.0404 / Avg. batch time: 417.1206 (ms) / GPU bubble ratio: 54.12%
[rank2]:2025-11-11 20:24:36,644 - INFO - Avg. fwd time: 8.4818 / Avg. bwd time: 10.1596 / Avg. batch time: 389.6718 (ms) / GPU bubble ratio: 61.73%
[rank3]:2025-11-11 20:24:36,606 - INFO - Avg. fwd time: 13.0164 / Avg. bwd time: 25.4533 / Avg. batch time: 367.1894 (ms) / GPU bubble ratio: 16.19%
[rank0]:2025-11-11 20:25:55,254 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-11 20:25:58,563 - INFO - Avg. fwd time: 10.8914 / Avg. bwd time: 12.9679 / Avg. batch time: 416.0063 (ms) / GPU bubble ratio: 54.12%
[rank1]:2025-11-11 20:25:58,577 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,014  tflops: 78.28  mfu: 25.09%
[rank2]:2025-11-11 20:25:58,540 - INFO - Avg. fwd time: 8.4909 / Avg. bwd time: 10.1016 / Avg. batch time: 388.6306 (ms) / GPU bubble ratio: 61.73%
[rank2]:2025-11-11 20:25:58,577 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,014  tflops: 78.28  mfu: 25.09%
[rank0]:2025-11-11 20:25:58,576 - INFO - Avg. fwd time: 9.1136 / Avg. bwd time: 4.6862 / Avg. batch time: 433.5703 (ms) / GPU bubble ratio: 74.54%
[rank0]:2025-11-11 20:25:58,579 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,014  tflops: 78.28  mfu: 25.09%
[rank3]:2025-11-11 20:25:58,513 - INFO - Avg. fwd time: 13.0359 / Avg. bwd time: 25.3119 / Avg. batch time: 366.2133 (ms) / GPU bubble ratio: 16.23%
[rank3]:2025-11-11 20:25:58,579 - INFO -  step: 750  loss:  4.0349  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,014  tflops: 78.28  mfu: 25.09%
[rank0]:2025-11-11 20:27:19,819 - INFO - Avg. fwd time: 9.1178 / Avg. bwd time: 4.5498 / Avg. batch time: 432.5068 (ms) / GPU bubble ratio: 74.72%
[rank3]:2025-11-11 20:27:20,007 - INFO - Avg. fwd time: 13.0508 / Avg. bwd time: 25.1962 / Avg. batch time: 365.4063 (ms) / GPU bubble ratio: 16.26%
[rank1]:2025-11-11 20:27:20,088 - INFO - Avg. fwd time: 10.9002 / Avg. bwd time: 12.9093 / Avg. batch time: 415.0842 (ms) / GPU bubble ratio: 54.11%
[rank2]:2025-11-11 20:27:20,045 - INFO - Avg. fwd time: 8.4981 / Avg. bwd time: 10.0548 / Avg. batch time: 387.7697 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-11-11 20:28:38,436 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 20:28:41,391 - INFO - Avg. fwd time: 9.1224 / Avg. bwd time: 4.4004 / Avg. batch time: 431.3367 (ms) / GPU bubble ratio: 74.92%
[rank3]:2025-11-11 20:28:41,581 - INFO - Avg. fwd time: 13.0668 / Avg. bwd time: 25.0690 / Avg. batch time: 364.5153 (ms) / GPU bubble ratio: 16.30%
[rank2]:2025-11-11 20:28:41,615 - INFO - Avg. fwd time: 8.5058 / Avg. bwd time: 10.0034 / Avg. batch time: 386.8197 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-11-11 20:28:41,664 - INFO - Avg. fwd time: 10.9098 / Avg. bwd time: 12.8450 / Avg. batch time: 414.0679 (ms) / GPU bubble ratio: 54.10%
[rank2]:2025-11-11 20:28:41,745 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 12.08GiB(25.43%)  tps: 10,041  tflops: 78.50  mfu: 25.16%
[rank2]:2025-11-11 20:28:41,745 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,796  tflops: 76.58  mfu: 22.63%
[rank2]:2025-11-11 20:28:41,745 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-11 20:28:41,746 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 20:28:41,747 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 10,041  tflops: 78.50  mfu: 25.16%
[rank0]:2025-11-11 20:28:41,747 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,796  tflops: 76.58  mfu: 22.62%
[rank0]:2025-11-11 20:28:41,747 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-11 20:28:41,748 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-11 20:28:41,747 - INFO -  step: 800  loss:  2.2478  grad_norm:  0.0000  memory: 31.73GiB(66.78%)  tps: 10,041  tflops: 78.50  mfu: 25.16%
[rank3]:2025-11-11 20:28:41,747 - INFO -  final step: 800  loss:  2.2478  grad_norm:  0.0000  tps: 9,806  tflops: 76.66  mfu: 22.77%
[rank3]:2025-11-11 20:28:41,748 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-11 20:28:41,748 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-11 20:28:41,747 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 10,041  tflops: 78.50  mfu: 25.16%
[rank1]:2025-11-11 20:28:41,747 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,797  tflops: 76.59  mfu: 22.63%
[rank1]:2025-11-11 20:28:41,748 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-11 20:28:41,748 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 20:28:43,804 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-11 20:28:43,877 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank2/251111_2028_stage2_final800.svg
[rank0]:2025-11-11 20:28:43,879 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank0/251111_2028_stage0_final800.svg
[rank1]:2025-11-11 20:28:43,879 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank1/251111_2028_stage1_final800.svg
[rank3]:2025-11-11 20:28:43,976 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_2028_real_final800_rank3.svg
[rank3]:> Batch Time: 398.50 ms, GPU Bubble Ratio: 81.46%, 55.52%, 65.38%, 29.89%
[rank2]:2025-11-11 20:28:44,036 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/frozen_params_histogram/251111_2028_rank2_stage2.svg
[rank2]:	> Counts Sum: 1464160, Total Sum: 1681920 (87.05%), Ratio(%) per element: [86.64, 86.81, 86.81, 86.81, 86.81, 86.64, 86.98, 86.64, 86.81, 87.15, 86.81, 86.98, 86.98, 87.67, 86.47, 86.98, 86.64, 87.15, 86.81, 87.15, 86.64, 87.15, 86.81, 86.81, 86.64, 86.98, 86.98, 87.5, 87.67, 87.5, 87.84, 87.67, 87.32, 88.01, 87.5, 86.98]
[rank2]:2025-11-11 20:28:44,036 - INFO - Destroying the purge thread.
[rank0]:2025-11-11 20:28:44,043 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/frozen_params_histogram/251111_2028_rank0_stage0.svg
[rank0]:	> Counts Sum: 1207040, Total Sum: 1728640 (69.83%), Ratio(%) per element: [72.43, 69.52, 69.17, 68.83, 69.69, 69.0, 69.17, 68.66, 70.54, 69.34, 69.34, 69.0, 68.83, 67.97, 67.8, 69.69, 70.2, 68.66, 69.0, 69.69, 69.0, 70.54, 70.2, 67.8, 69.17, 68.83, 70.2, 69.52, 71.57, 70.37, 72.26, 71.23, 71.23, 71.57, 70.71, 70.37, 72.26]
[rank0]:2025-11-11 20:28:44,043 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-11 20:28:44,036 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/frozen_params_histogram/251111_2028_rank1_stage1.svg
[rank1]:	> Counts Sum: 1349040, Total Sum: 2102400 (64.17%), Ratio(%) per element: [61.3, 63.18, 63.69, 63.86, 63.35, 64.04, 64.21, 63.69, 64.04, 63.69, 62.84, 64.72, 65.58, 63.35, 60.95, 64.72, 62.5, 63.86, 64.04, 64.55, 64.55, 63.52, 61.81, 64.72, 62.32, 64.04, 63.18, 63.35, 65.75, 62.5, 64.38, 63.18, 66.43, 63.86, 64.89, 65.06, 65.41, 65.06, 64.04, 64.38, 68.49, 66.6, 66.09, 66.09, 65.41]
[rank1]:2025-11-11 20:28:44,037 - INFO - Destroying the purge thread.
[rank3]:2025-11-11 20:28:44,125 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/pipeline_schedule/251111_2028_thry_final800_rank3.svg
[rank3]:> Batch Time: 351.13 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-11 20:28:44,175 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/freeze_ratio_history/rank3/251111_2028_stage3_final800.svg
[rank2]:2025-11-11 20:28:44,293 - INFO - Process group destroyed
[rank3]:2025-11-11 20:28:44,323 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1/frozen_params_histogram/251111_2028_rank3_stage3.svg
[rank3]:	> Counts Sum: 331440, Total Sum: 1354880 (24.46%), Ratio(%) per element: [20.71, 20.2, 22.43, 20.71, 22.94, 23.8, 22.77, 21.74, 22.08, 21.57, 22.43, 22.6, 20.54, 20.54, 22.43, 20.71, 22.08, 21.06, 29.96, 28.42, 28.93, 28.42, 27.22, 29.28, 27.39, 28.93, 30.47, 28.93, 29.96]
[rank3]:2025-11-11 20:28:44,323 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-11-11 20:28:44,462 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 275-287
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–„â–â–„â–„â–‚â–â–„â–„â–‚â–â–„â–„â–‚â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–‡â–„â–â–„â–„â–‚â–â–„â–„â–‚â–â–„â–„â–‚â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.34164
[rank3]:wandb:               final/avg_loss 2.24779
[rank3]:wandb:             final/avg_mfu(%) 22.77463
[rank3]:wandb:             final/avg_tflops 76.65854
[rank3]:wandb:    final/avg_throughput(tps) 9805.96748
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 2.24779
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.24779
[rank3]:wandb: loss_metrics/global_max_loss 2.24779
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_GPipe_timelyauto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/krjflp3o
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_GPipe_timelyauto_42_dm1/20251111-1941/wandb/run-20251111_194120-krjflp3o/logs
[rank3]:2025-11-11 20:28:45,868 - INFO - Process group destroyed
[rank0]:2025-11-11 20:28:46,043 - INFO - Training completed
[rank0]:2025-11-11 20:28:46,044 - INFO - Destroying the purge thread.
[rank0]:2025-11-11 20:28:46,441 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.0', 'tok_embeddings', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.5', 'layers.4', 'layers.8', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.13', 'layers.14', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_GPipe_timelyauto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_GPipe_timelyauto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_GPipe_timelyauto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_GPipe_timelyauto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_GPipe_timelyauto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_GPipe_timelyauto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_GPipe_timelyauto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_GPipe_timelyauto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
