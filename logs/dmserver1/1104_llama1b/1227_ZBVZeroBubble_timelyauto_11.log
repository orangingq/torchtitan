
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 00:11:39 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_ZBVZeroBubble_timelyauto_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with timelyauto x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-28 00:11:46,050 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank3]:2025-12-28 00:11:46,046 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank2]:2025-12-28 00:11:46,263 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 00:11:46,265 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 00:11:46,248 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 00:11:46,251 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 00:11:46,361 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank1]:2025-12-28 00:11:46,308 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank0]:2025-12-28 00:11:46,550 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 00:11:46,553 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 00:11:46,557 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 00:11:46,558 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-28 00:11:46,495 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 00:11:46,498 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 00:11:46,946 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 00:11:49,737 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-28 00:11:49,825 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 00:11:49,877 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 00:11:49,905 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-28 00:11:49,918 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-28 00:11:49,920 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-28 00:11:50,126 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 00:11:50,127 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 00:11:50,127 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:2025-12-28 00:11:50,281 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 00:11:50,320 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 00:11:50,345 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-28 00:11:50,357 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-28 00:11:50,359 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-28 00:11:50,541 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 00:11:50,541 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 00:11:50,542 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank2]:2025-12-28 00:11:50,541 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 00:11:50,581 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 00:11:50,609 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-28 00:11:50,622 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-28 00:11:50,624 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-28 00:11:50,804 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 00:11:50,804 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 00:11:50,805 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run 44om7aip
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_timelyauto_11_dm1/20251228-0011/wandb/run-20251228_001150-44om7aip
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1227_ZBVZeroBubble_timelyauto_11_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/44om7aip
[rank0]:2025-12-28 00:11:52,324 - WandB logging enabled
[rank0]:2025-12-28 00:11:52,325 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 00:11:52,362 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 00:11:52,364 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 00:11:52,390 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-28 00:11:52,403 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-28 00:11:52,405 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-28 00:11:52,611 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 00:11:52,612 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 00:11:52,613 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-28 00:11:52,631 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_ZBVZeroBubble_timelyauto_11_dm1
[rank0]:2025-12-28 00:11:52,632 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 00:11:52,633 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 00:11:52,633 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-28 00:11:52,632 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-28 00:11:52,632 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-28 00:11:52,632 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 00:11:56,153 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-28 00:11:56,154 - Finished loading the checkpoint in 3.52 seconds.
[rank0]:2025-12-28 00:11:56,154 - Training starts at step 1
[rank0]:2025-12-28 00:12:01,182 -  step:  1  loss: 10.6092  grad_norm: 203.0655  memory: 30.01GiB(63.17%)  tps: 3,716  tflops: 29.05  mfu: 9.31%
[rank0]:2025-12-28 00:12:01,182 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 00:12:01,129 -  step:  1  loss: -4.0000  grad_norm: 203.0655  memory: 11.98GiB(25.23%)  tps: 3,107  tflops: 24.29  mfu: 7.78%
[rank2]:2025-12-28 00:12:01,129 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 00:12:01,151 -  step:  1  loss: -4.0000  grad_norm: 203.0655  memory: 15.58GiB(32.80%)  tps: 2,907  tflops: 22.72  mfu: 7.28%
[rank1]:2025-12-28 00:12:01,152 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 00:12:01,131 -  step:  1  loss: -4.0000  grad_norm: 203.0655  memory: 13.43GiB(28.27%)  tps: 3,031  tflops: 23.69  mfu: 7.59%
[rank3]:2025-12-28 00:12:01,132 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 00:15:35,174 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 00:15:39,799 - Avg. fwd time: 7.6987 / Avg. bwd-weight time: 9.6451 / Avg. bwd-input time: 9.5033 / Avg. batch time: 1015.0199 (ms) / GPU bubble ratio: 57.68%
[rank1]:2025-12-28 00:15:39,814 - Avg. fwd time: 9.8934 / Avg. bwd-weight time: 13.0323 / Avg. bwd-input time: 12.3162 / Avg. batch time: 1058.7771 (ms) / GPU bubble ratio: 46.74%
[rank1]:2025-12-28 00:15:39,867 -  step: 50  loss: -4.0000  grad_norm: 24.4315  memory: 17.83GiB(37.53%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank2]:2025-12-28 00:15:39,790 - Avg. fwd time: 7.8891 / Avg. bwd-weight time: 9.9201 / Avg. bwd-input time: 9.8066 / Avg. batch time: 1019.8800 (ms) / GPU bubble ratio: 56.68%
[rank0]:2025-12-28 00:15:39,818 - Avg. fwd time: 12.9277 / Avg. full-bwd time: 27.7747 (Avg. bwd-weight time: 28.7499 / Avg. bwd-input time: 33.6124) / Avg. batch time: 1074.4926 (ms) / GPU bubble ratio: 13.64%
[rank2]:2025-12-28 00:15:39,864 -  step: 50  loss: -4.0000  grad_norm: 24.4315  memory: 13.80GiB(29.05%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank3]:2025-12-28 00:15:39,864 -  step: 50  loss: -4.0000  grad_norm: 24.4315  memory: 15.27GiB(32.13%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank0]:2025-12-28 00:15:39,891 -  step: 50  loss:  9.8847  grad_norm: 24.4315  memory: 35.32GiB(74.36%)  tps: 7,341  tflops: 57.39  mfu: 18.39%
[rank3]:2025-12-28 00:16:20,183 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-12-28 00:17:04,738 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-28 00:17:04,926 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-28 00:17:04,950 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-28 00:17:04,932 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-28 00:17:49,840 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-28 00:17:49,945 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-12-28 00:18:52,751 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 00:18:53,363 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-28 00:18:53,476 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.98/0.98, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.42/0.42, [MB4] 0.72/0.72, [MB5] 0.33/0.33, [MB6] 0.36/0.36, [MB7] 1.00/1.00
[rank1]:2025-12-28 00:18:53,468 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.31/0.31, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 00:18:53,478 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 00:18:53,791 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0018_max_batch_time.svg
[rank3]:			> Batch Time: 951.54 ms, GPU Bubble Ratio: 1.58%, 40.39%, 53.39%, 54.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-8-60ms      | [S7,MB0,F]  75-16-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-25-150ms   | [S7,MB1,F]  150-15-165ms   | [S7,MB1,BI] 165-34-199ms   | [S7,MB1,BW] 199-28-227ms   | [S7,MB2,F]  227-17-245ms   | [S7,MB2,BI] 245-34-279ms   | [S7,MB2,BW] 279-30-309ms   | [S7,MB3,F]  309-18-328ms   | [S7,MB3,BI] 328-34-362ms   | [S7,MB3,BW] 362-29-392ms   | [S0,MB7,F]  392-9-401ms    | [S0,MB0,B]  401-29-431ms   | [S7,MB4,F]  431-17-449ms   | [S7,MB4,BI] 449-34-483ms   | [S7,MB4,BW] 483-30-513ms   | [S0,MB1,B]  513-28-542ms   | [S7,MB5,F]  542-17-560ms   | [S7,MB5,BI] 560-33-593ms   | [S7,MB5,BW] 593-30-623ms   | [S0,MB2,B]  623-28-652ms   | [S7,MB6,F]  652-17-669ms   | [S7,MB6,BI] 669-33-702ms   | [S7,MB6,BW] 702-29-732ms   | [S0,MB3,B]  732-28-760ms   | [S7,MB7,F]  760-17-778ms   | [S7,MB7,BI] 778-33-811ms   | [S7,MB7,BW] 811-29-841ms   | [S0,MB4,B]  841-28-869ms   | [S0,MB5,B]  869-28-897ms   | [S0,MB6,B]  897-27-925ms   | [S0,MB7,B]  925-26-951ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-11-32ms     | [S1,MB2,F]  32-11-43ms     | [S1,MB3,F]  43-11-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-9-75ms      | [S1,MB5,F]  75-12-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 199-9-208ms    | [S6,MB1,BW] 208-10-219ms   | [S6,MB3,F]  219-7-226ms    | [S6,MB2,BI] 279-9-288ms    | [S6,MB2,BW] 288-10-299ms   | [S1,MB6,F]  299-11-310ms   | [S1,MB0,BI] 310-15-326ms   | [S1,MB0,BW] 326-15-341ms   | [S6,MB4,F]  341-8-349ms    | [S6,MB3,BI] 362-10-373ms   | [S6,MB3,BW] 373-9-382ms    | [S1,MB7,F]  401-13-415ms   | [S1,MB1,BI] 415-15-430ms   | [S1,MB1,BW] 430-14-445ms   | [S6,MB5,F]  445-7-453ms    | [S6,MB4,BI] 483-10-493ms   | [S6,MB4,BW] 493-9-503ms    | [S1,MB2,BI] 503-14-517ms   | [S1,MB2,BW] 517-14-532ms   | [S6,MB6,F]  532-7-539ms    | [S6,MB5,BI] 593-9-603ms    | [S6,MB5,BW] 603-10-614ms   | [S1,MB3,BI] 614-14-628ms   | [S1,MB3,BW] 628-14-643ms   | [S6,MB7,F]  643-7-650ms    | [S6,MB6,BI] 702-9-712ms    | [S6,MB6,BW] 712-11-723ms   | [S1,MB4,BI] 723-14-738ms   | [S6,MB7,BI] 811-10-821ms   | [S1,MB5,BI] 821-14-836ms   | [S1,MB4,BW] 836-15-852ms   | [S1,MB6,BI] 852-14-867ms   | [S1,MB5,BW] 867-16-883ms   | [S1,MB7,BI] 883-15-898ms   | [S1,MB6,BW] 898-17-915ms   | [S6,MB7,BW] 915-11-927ms   | [S1,MB7,BW] 927-17-944ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-8-68ms      | [S5,MB1,F]  68-7-75ms      | [S2,MB4,F]  75-8-84ms      | [S5,MB2,F]  84-8-92ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-153ms   | [S5,MB3,F]  153-7-160ms    | [S5,MB1,BI] 208-9-217ms    | [S5,MB1,BW] 217-10-228ms   | [S2,MB5,F]  228-7-235ms    | [S2,MB0,BI] 235-10-246ms   | [S2,MB0,BW] 246-9-255ms    | [S5,MB4,F]  255-7-263ms    | [S5,MB2,BI] 288-10-298ms   | [S5,MB2,BW] 298-9-308ms    | [S2,MB6,F]  310-9-320ms    | [S2,MB1,BI] 320-10-330ms   | [S2,MB1,BW] 330-9-340ms    | [S5,MB5,F]  340-7-348ms    | [S5,MB3,BI] 373-10-383ms   | [S5,MB3,BW] 383-11-395ms   | [S2,MB7,F]  415-7-422ms    | [S2,MB2,BI] 422-10-433ms   | [S2,MB2,BW] 433-9-443ms    | [S5,MB6,F]  443-7-450ms    | [S5,MB4,BI] 493-10-504ms   | [S5,MB4,BW] 504-9-513ms    | [S2,MB3,BI] 513-9-523ms    | [S2,MB3,BW] 523-9-532ms    | [S5,MB7,F]  532-7-540ms    | [S5,MB5,BI] 603-9-612ms    | [S5,MB5,BW] 612-9-622ms    | [S2,MB4,BI] 622-9-631ms    | [S5,MB6,BI] 712-10-722ms   | [S2,MB5,BI] 722-10-732ms   | [S5,MB7,BI] 821-9-830ms    | [S2,MB6,BI] 830-10-841ms   | [S2,MB4,BW] 841-10-851ms   | [S2,MB7,BI] 851-9-860ms    | [S2,MB5,BW] 860-10-870ms   | [S5,MB6,BW] 870-9-880ms    | [S5,MB7,BW] 880-9-889ms    | [S2,MB6,BW] 889-9-899ms    | [S2,MB7,BW] 899-10-909ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-53ms      | [S4,MB1,F]  53-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-8-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-8-152ms    | [S4,MB0,BW] 152-9-161ms    AFR(10):1.0000 | [S3,MB4,F]  161-7-168ms    | [S3,MB0,BI] 168-9-177ms    | [S3,MB0,BW] 177-9-187ms    AFR(10):1.0000 | [S4,MB4,F]  187-7-194ms    | [S4,MB1,BI] 217-10-228ms   | [S4,MB1,BW] 228-10-238ms   AFR(10):1.0000 | [S3,MB5,F]  238-8-246ms    | [S3,MB1,BI] 246-9-255ms    | [S3,MB1,BW] 255-9-265ms    AFR(10):1.0000 | [S4,MB5,F]  265-7-273ms    | [S4,MB2,BI] 298-11-309ms   | [S4,MB2,BW] 309-9-319ms    AFR(10):1.0000 | [S3,MB6,F]  320-7-327ms    | [S3,MB2,BI] 327-9-336ms    | [S3,MB2,BW] 336-9-346ms    AFR(10):1.0000 | [S4,MB6,F]  346-7-353ms    | [S4,MB3,BI] 383-9-393ms    | [S4,MB3,BW] 393-10-404ms   AFR(10):1.0000 | [S3,MB7,F]  422-7-430ms    | [S3,MB3,BI] 430-9-439ms    | [S3,MB3,BW] 439-9-448ms    AFR(10):1.0000 | [S4,MB7,F]  448-7-456ms    | [S4,MB4,BI] 504-10-514ms   | [S4,MB4,BW] 514-9-523ms    AFR(10):1.0000 | [S3,MB4,BI] 523-10-534ms   | [S4,MB5,BI] 612-9-622ms    | [S3,MB5,BI] 622-8-631ms    | [S4,MB6,BI] 722-9-731ms    | [S3,MB6,BI] 731-8-740ms    | [S4,MB7,BI] 830-8-839ms    | [S3,MB7,BI] 839-8-848ms    | [S3,MB4,BW] 848-10-858ms   AFR(10):1.0000 | [S4,MB5,BW] 858-9-868ms    AFR(10):1.0000 | [S4,MB6,BW] 868-9-877ms    AFR(10):1.0000 | [S4,MB7,BW] 877-9-887ms    AFR(10):1.0000 | [S3,MB5,BW] 887-9-897ms    AFR(10):1.0000 | [S3,MB6,BW] 897-10-907ms   AFR(10):1.0000 | [S3,MB7,BW] 907-10-917ms   AFR(10):1.0000
[rank3]:2025-12-28 00:18:54,075 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0018_min_batch_time.svg
[rank3]:			> Batch Time: 559.22 ms, GPU Bubble Ratio: 13.76%, 36.29%, 49.34%, 50.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-8-60ms      | [S7,MB0,F]  75-16-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-0-125ms    | [S7,MB1,F]  125-15-140ms   | [S7,MB1,BI] 140-34-174ms   | [S7,MB1,BW] 174-1-175ms    | [S7,MB2,F]  175-17-193ms   | [S7,MB2,BI] 193-34-227ms   | [S7,MB2,BW] 227-0-227ms    | [S7,MB3,F]  227-18-245ms   | [S7,MB3,BI] 245-34-280ms   | [S7,MB3,BW] 280-0-280ms    | [S0,MB7,F]  280-9-290ms    | [S0,MB0,B]  290-0-290ms    | [S7,MB4,F]  290-17-308ms   | [S7,MB4,BI] 308-34-342ms   | [S7,MB4,BW] 342-0-342ms    | [S0,MB1,B]  342-0-342ms    | [S7,MB5,F]  342-17-360ms   | [S7,MB5,BI] 360-33-393ms   | [S7,MB5,BW] 393-0-393ms    | [S0,MB2,B]  393-0-393ms    | [S7,MB6,F]  393-17-411ms   | [S7,MB6,BI] 411-33-444ms   | [S7,MB6,BW] 444-1-446ms    | [S0,MB3,B]  446-0-446ms    | [S7,MB7,F]  446-17-463ms   | [S7,MB7,BI] 463-33-497ms   | [S7,MB7,BW] 497-0-497ms    | [S0,MB4,B]  497-0-497ms    | [S0,MB5,B]  522-0-522ms    | [S0,MB6,B]  541-0-541ms    | [S0,MB7,B]  559-0-559ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-11-32ms     | [S1,MB2,F]  32-11-43ms     | [S1,MB3,F]  43-11-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-9-75ms      | [S1,MB5,F]  75-12-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-0-134ms    | [S6,MB2,F]  134-7-141ms    | [S6,MB1,BI] 174-9-183ms    | [S6,MB1,BW] 183-0-183ms    | [S6,MB3,F]  183-7-191ms    | [S6,MB2,BI] 227-9-236ms    | [S6,MB2,BW] 236-0-236ms    | [S1,MB6,F]  236-11-247ms   | [S1,MB0,BI] 247-15-263ms   | [S1,MB0,BW] 263-0-263ms    | [S6,MB4,F]  263-8-271ms    | [S6,MB3,BI] 280-10-290ms   | [S6,MB3,BW] 290-0-290ms    | [S1,MB7,F]  290-13-304ms   | [S1,MB1,BI] 304-15-319ms   | [S1,MB1,BW] 319-0-319ms    | [S6,MB5,F]  319-7-327ms    | [S6,MB4,BI] 342-10-352ms   | [S6,MB4,BW] 352-0-352ms    | [S1,MB2,BI] 352-14-367ms   | [S1,MB2,BW] 367-0-367ms    | [S6,MB6,F]  367-7-374ms    | [S6,MB5,BI] 393-9-403ms    | [S6,MB5,BW] 403-0-403ms    | [S1,MB3,BI] 403-14-417ms   | [S1,MB3,BW] 417-0-417ms    | [S6,MB7,F]  417-7-425ms    | [S6,MB6,BI] 444-9-454ms    | [S6,MB6,BW] 454-0-454ms    | [S1,MB4,BI] 454-14-468ms   | [S6,MB7,BI] 497-10-507ms   | [S1,MB5,BI] 507-14-522ms   | [S1,MB4,BW] 522-0-522ms    | [S1,MB6,BI] 526-14-541ms   | [S1,MB5,BW] 541-0-541ms    | [S1,MB7,BI] 543-15-559ms   | [S1,MB6,BW] 559-0-559ms    | [S6,MB7,BW] 559-0-559ms    | [S1,MB7,BW] 559-0-559ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-8-68ms      | [S5,MB1,F]  68-7-75ms      | [S2,MB4,F]  75-8-84ms      | [S5,MB2,F]  84-8-92ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-0-143ms    | [S5,MB3,F]  143-7-150ms    | [S5,MB1,BI] 183-9-192ms    | [S5,MB1,BW] 192-0-192ms    | [S2,MB5,F]  192-7-199ms    | [S2,MB0,BI] 199-10-210ms   | [S2,MB0,BW] 210-0-210ms    | [S5,MB4,F]  210-7-217ms    | [S5,MB2,BI] 236-10-246ms   | [S5,MB2,BW] 246-0-246ms    | [S2,MB6,F]  247-9-257ms    | [S2,MB1,BI] 257-10-268ms   | [S2,MB1,BW] 268-0-268ms    | [S5,MB5,F]  268-7-275ms    | [S5,MB3,BI] 290-10-301ms   | [S5,MB3,BW] 301-0-301ms    | [S2,MB7,F]  304-7-311ms    | [S2,MB2,BI] 311-10-322ms   | [S2,MB2,BW] 322-0-322ms    | [S5,MB6,F]  322-7-329ms    | [S5,MB4,BI] 352-10-363ms   | [S5,MB4,BW] 363-0-363ms    | [S2,MB3,BI] 363-9-372ms    | [S2,MB3,BW] 372-0-372ms    | [S5,MB7,F]  372-7-379ms    | [S5,MB5,BI] 403-9-412ms    | [S5,MB5,BW] 412-0-412ms    | [S2,MB4,BI] 412-9-421ms    | [S5,MB6,BI] 454-10-464ms   | [S2,MB5,BI] 464-10-474ms   | [S5,MB7,BI] 507-9-516ms    | [S2,MB6,BI] 516-10-526ms   | [S2,MB4,BW] 526-0-526ms    | [S2,MB7,BI] 534-9-543ms    | [S2,MB5,BW] 543-0-543ms    | [S5,MB6,BW] 543-0-543ms    | [S5,MB7,BW] 543-0-543ms    | [S2,MB6,BW] 543-0-543ms    | [S2,MB7,BW] 543-0-543ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-53ms      | [S4,MB1,F]  53-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-8-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-8-152ms    | [S4,MB0,BW] 152-0-152ms    AFR(10):1.0000 | [S3,MB4,F]  152-7-159ms    | [S3,MB0,BI] 159-9-168ms    | [S3,MB0,BW] 168-0-168ms    AFR(10):1.0000 | [S4,MB4,F]  168-7-176ms    | [S4,MB1,BI] 192-10-202ms   | [S4,MB1,BW] 202-0-202ms    AFR(10):1.0000 | [S3,MB5,F]  202-8-211ms    | [S3,MB1,BI] 211-9-220ms    | [S3,MB1,BW] 220-0-220ms    AFR(10):1.0000 | [S4,MB5,F]  220-7-228ms    | [S4,MB2,BI] 246-11-258ms   | [S4,MB2,BW] 258-0-258ms    AFR(10):1.0000 | [S3,MB6,F]  258-7-265ms    | [S3,MB2,BI] 265-9-274ms    | [S3,MB2,BW] 274-0-274ms    AFR(10):1.0000 | [S4,MB6,F]  274-7-281ms    | [S4,MB3,BI] 301-9-311ms    | [S4,MB3,BW] 311-0-311ms    AFR(10):1.0000 | [S3,MB7,F]  311-7-319ms    | [S3,MB3,BI] 319-9-328ms    | [S3,MB3,BW] 328-0-328ms    AFR(10):1.0000 | [S4,MB7,F]  328-7-335ms    | [S4,MB4,BI] 363-10-373ms   | [S4,MB4,BW] 373-0-373ms    AFR(10):1.0000 | [S3,MB4,BI] 373-10-383ms   | [S4,MB5,BI] 412-9-422ms    | [S3,MB5,BI] 422-8-431ms    | [S4,MB6,BI] 464-9-473ms    | [S3,MB6,BI] 473-8-482ms    | [S4,MB7,BI] 516-8-525ms    | [S3,MB7,BI] 525-8-534ms    | [S3,MB4,BW] 534-0-534ms    AFR(10):1.0000 | [S4,MB5,BW] 534-0-534ms    AFR(10):1.0000 | [S4,MB6,BW] 534-0-534ms    AFR(10):1.0000 | [S4,MB7,BW] 534-0-534ms    AFR(10):1.0000 | [S3,MB5,BW] 534-0-534ms    AFR(10):1.0000 | [S3,MB6,BW] 534-0-534ms    AFR(10):1.0000 | [S3,MB7,BW] 534-0-534ms    AFR(10):1.0000
[rank3]:2025-12-28 00:18:54,410 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0018_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 584.91 ms, GPU Bubble Ratio: 2.57%, 21.58%, 30.35%, 33.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-8-60ms      | [S7,MB0,F]  75-16-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-25-150ms   | [S7,MB1,F]  150-15-165ms   | [S7,MB1,BI] 165-34-199ms   | [S7,MB1,BW] 199-2-201ms    | [S7,MB2,F]  201-17-219ms   | [S7,MB2,BI] 219-34-253ms   | [S7,MB2,BW] 253-0-253ms    | [S7,MB3,F]  253-18-271ms   | [S7,MB3,BI] 271-34-306ms   | [S7,MB3,BW] 306-0-306ms    | [S0,MB7,F]  306-9-316ms    | [S0,MB0,B]  316-0-316ms    | [S7,MB4,F]  316-17-333ms   | [S7,MB4,BI] 333-34-367ms   | [S7,MB4,BW] 367-0-368ms    | [S0,MB1,B]  368-0-368ms    | [S7,MB5,F]  368-17-385ms   | [S7,MB5,BI] 385-33-419ms   | [S7,MB5,BW] 419-0-419ms    | [S0,MB2,B]  419-0-419ms    | [S7,MB6,F]  419-17-437ms   | [S7,MB6,BI] 437-33-470ms   | [S7,MB6,BW] 470-1-472ms    | [S0,MB3,B]  472-0-472ms    | [S7,MB7,F]  472-17-489ms   | [S7,MB7,BI] 489-33-522ms   | [S7,MB7,BW] 522-17-540ms   | [S0,MB4,B]  540-7-548ms    | [S0,MB5,B]  548-18-566ms   | [S0,MB6,B]  566-17-584ms   | [S0,MB7,B]  584-0-584ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-11-32ms     | [S1,MB2,F]  32-11-43ms     | [S1,MB3,F]  43-11-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-9-75ms      | [S1,MB5,F]  75-12-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 199-9-208ms    | [S6,MB1,BW] 208-10-219ms   | [S6,MB3,F]  219-7-226ms    | [S6,MB2,BI] 253-9-262ms    | [S6,MB2,BW] 262-10-273ms   | [S1,MB6,F]  273-11-284ms   | [S1,MB0,BI] 284-15-300ms   | [S1,MB0,BW] 300-0-300ms    | [S6,MB4,F]  300-8-308ms    | [S6,MB3,BI] 308-10-319ms   | [S6,MB3,BW] 319-9-328ms    | [S1,MB7,F]  328-13-342ms   | [S1,MB1,BI] 342-15-357ms   | [S1,MB1,BW] 357-2-360ms    | [S6,MB5,F]  360-7-367ms    | [S6,MB4,BI] 367-10-378ms   | [S6,MB4,BW] 378-9-388ms    | [S1,MB2,BI] 388-14-402ms   | [S1,MB2,BW] 402-9-412ms    | [S6,MB6,F]  412-7-419ms    | [S6,MB5,BI] 419-9-429ms    | [S6,MB5,BW] 429-10-440ms   | [S1,MB3,BI] 440-14-454ms   | [S1,MB3,BW] 454-10-464ms   | [S6,MB7,F]  464-7-472ms    | [S6,MB6,BI] 472-9-481ms    | [S6,MB6,BW] 481-11-492ms   | [S1,MB4,BI] 492-14-507ms   | [S6,MB7,BI] 522-10-533ms   | [S1,MB5,BI] 533-14-548ms   | [S1,MB4,BW] 548-4-552ms    | [S1,MB6,BI] 552-14-566ms   | [S1,MB5,BW] 566-2-569ms    | [S1,MB7,BI] 569-15-584ms   | [S1,MB6,BW] 584-0-584ms    | [S6,MB7,BW] 584-0-584ms    | [S1,MB7,BW] 584-0-584ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-8-68ms      | [S5,MB1,F]  68-7-75ms      | [S2,MB4,F]  75-8-84ms      | [S5,MB2,F]  84-8-92ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-153ms   | [S5,MB3,F]  153-7-160ms    | [S5,MB1,BI] 208-9-217ms    | [S5,MB1,BW] 217-10-228ms   | [S2,MB5,F]  228-7-235ms    | [S2,MB0,BI] 235-10-246ms   | [S2,MB0,BW] 246-9-255ms    | [S5,MB4,F]  255-7-263ms    | [S5,MB2,BI] 263-10-273ms   | [S5,MB2,BW] 273-9-283ms    | [S2,MB6,F]  284-9-294ms    | [S2,MB1,BI] 294-10-304ms   | [S2,MB1,BW] 304-9-314ms    | [S5,MB5,F]  314-7-322ms    | [S5,MB3,BI] 322-10-332ms   | [S5,MB3,BW] 332-11-344ms   | [S2,MB7,F]  344-7-351ms    | [S2,MB2,BI] 351-10-362ms   | [S2,MB2,BW] 362-9-371ms    | [S5,MB6,F]  371-7-379ms    | [S5,MB4,BI] 379-10-389ms   | [S5,MB4,BW] 389-9-399ms    | [S2,MB3,BI] 399-9-408ms    | [S2,MB3,BW] 408-9-418ms    | [S5,MB7,F]  418-7-425ms    | [S5,MB5,BI] 429-9-438ms    | [S5,MB5,BW] 438-9-448ms    | [S2,MB4,BI] 448-9-457ms    | [S5,MB6,BI] 481-10-491ms   | [S2,MB5,BI] 491-10-502ms   | [S5,MB7,BI] 533-9-542ms    | [S2,MB6,BI] 542-10-552ms   | [S2,MB4,BW] 552-7-559ms    | [S2,MB7,BI] 559-9-569ms    | [S2,MB5,BW] 569-0-569ms    | [S5,MB6,BW] 569-9-578ms    | [S5,MB7,BW] 578-6-584ms    | [S2,MB6,BW] 584-0-584ms    | [S2,MB7,BW] 584-0-584ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-53ms      | [S4,MB1,F]  53-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-8-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-8-152ms    | [S4,MB0,BW] 152-9-161ms    AFR(10):1.0000 | [S3,MB4,F]  161-7-168ms    | [S3,MB0,BI] 168-9-177ms    | [S3,MB0,BW] 177-9-187ms    AFR(10):1.0000 | [S4,MB4,F]  187-7-194ms    | [S4,MB1,BI] 217-10-228ms   | [S4,MB1,BW] 228-10-238ms   AFR(10):1.0000 | [S3,MB5,F]  238-8-246ms    | [S3,MB1,BI] 246-9-255ms    | [S3,MB1,BW] 255-9-265ms    AFR(10):1.0000 | [S4,MB5,F]  265-7-273ms    | [S4,MB2,BI] 273-11-284ms   | [S4,MB2,BW] 284-9-294ms    AFR(10):1.0000 | [S3,MB6,F]  294-7-301ms    | [S3,MB2,BI] 301-9-310ms    | [S3,MB2,BW] 310-9-320ms    AFR(10):1.0000 | [S4,MB6,F]  320-7-327ms    | [S4,MB3,BI] 332-9-342ms    | [S4,MB3,BW] 342-10-353ms   AFR(10):1.0000 | [S3,MB7,F]  353-7-360ms    | [S3,MB3,BI] 360-9-369ms    | [S3,MB3,BW] 369-9-378ms    AFR(10):1.0000 | [S4,MB7,F]  378-7-386ms    | [S4,MB4,BI] 389-10-399ms   | [S4,MB4,BW] 399-9-409ms    AFR(10):1.0000 | [S3,MB4,BI] 409-10-419ms   | [S4,MB5,BI] 438-9-448ms    | [S3,MB5,BI] 448-8-457ms    | [S4,MB6,BI] 491-9-500ms    | [S3,MB6,BI] 500-8-509ms    | [S4,MB7,BI] 542-8-551ms    | [S3,MB7,BI] 551-8-559ms    | [S3,MB4,BW] 559-0-559ms    AFR(10):1.0000 | [S4,MB5,BW] 559-9-569ms    AFR(10):1.0000 | [S4,MB6,BW] 569-9-578ms    AFR(10):1.0000 | [S4,MB7,BW] 578-6-584ms    AFR(10):1.0000 | [S3,MB5,BW] 584-0-584ms    AFR(10):1.0000 | [S3,MB6,BW] 584-0-584ms    AFR(10):1.0000 | [S3,MB7,BW] 584-0-584ms    AFR(10):1.0000
[rank3]:2025-12-28 00:18:54,410 - 	> Batch Time: 584.91 ms (Average Freeze Ratio: 0.44, Time Reduction Rate: 0.39)
[rank3]:2025-12-28 00:18:54,412 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 00:18:57,572 - Avg. fwd time: 7.6845 / Avg. bwd-weight time: 7.7092 / Avg. bwd-input time: 9.5258 / Avg. batch time: 950.1031 (ms) / GPU bubble ratio: 58.03%
[rank0]:2025-12-28 00:18:57,579 - Avg. fwd time: 12.8703 / Avg. full-bwd time: 22.0768 (Avg. bwd-weight time: 23.2322 / Avg. bwd-input time: 33.5713) / Avg. batch time: 1014.0313 (ms) / GPU bubble ratio: 17.46%
[rank1]:2025-12-28 00:18:57,577 - Avg. fwd time: 9.9309 / Avg. bwd-weight time: 10.3945 / Avg. bwd-input time: 12.3680 / Avg. batch time: 998.5941 (ms) / GPU bubble ratio: 47.62%
[rank1]:2025-12-28 00:18:57,627 -  step: 100  loss: -4.0000  grad_norm:  2.1534  memory: 17.83GiB(37.53%)  tps: 8,285  tflops: 64.77  mfu: 20.76%
[rank2]:2025-12-28 00:18:57,575 - Avg. fwd time: 7.9402 / Avg. bwd-weight time: 7.9338 / Avg. bwd-input time: 9.8224 / Avg. batch time: 961.0413 (ms) / GPU bubble ratio: 57.22%
[rank2]:2025-12-28 00:18:57,625 -  step: 100  loss: -4.0000  grad_norm:  2.1534  memory: 13.80GiB(29.05%)  tps: 8,285  tflops: 64.77  mfu: 20.76%
[rank3]:2025-12-28 00:18:57,625 -  step: 100  loss: -4.0000  grad_norm:  2.1534  memory: 15.27GiB(32.13%)  tps: 8,285  tflops: 64.77  mfu: 20.76%
[rank0]:2025-12-28 00:18:57,650 -  step: 100  loss:  8.9036  grad_norm:  2.1534  memory: 35.32GiB(74.36%)  tps: 8,285  tflops: 64.77  mfu: 20.76%
[rank0]:2025-12-28 00:18:57,714 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0018_stage0_step100.svg
[rank1]:2025-12-28 00:18:57,714 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0018_stage1_step100.svg
[rank2]:2025-12-28 00:18:57,729 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0018_stage2_step100.svg
[rank0]:2025-12-28 00:18:57,751 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0018_stage7_step100.svg
[rank1]:2025-12-28 00:18:57,752 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0018_stage6_step100.svg
[rank2]:2025-12-28 00:18:57,786 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0018_stage5_step100.svg
[rank0]:2025-12-28 00:18:57,856 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank0_stage0.svg
[rank0]:	> Counts Sum: 12160, Total Sum: 12160 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-28 00:18:57,889 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank1_stage1.svg
[rank1]:	> Counts Sum: 17280, Total Sum: 17280 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-28 00:18:57,888 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank2_stage2.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-28 00:18:57,947 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0018_step100_rank3.svg
[rank3]:			> Batch Time: 774.00 ms, GPU Bubble Ratio: 36.60%, 53.44%, 62.84%, 64.46%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-40ms      | [S0,MB5,F]  40-9-50ms      | [S0,MB6,F]  50-7-58ms      | [S7,MB0,F]  110-16-126ms   | [S7,MB0,BI] 138-32-171ms   | [S7,MB0,BW] 171-0-171ms    | [S7,MB1,F]  171-15-187ms   | [S7,MB1,BI] 199-33-233ms   | [S7,MB1,BW] 233-21-254ms   | [S7,MB2,F]  253-17-270ms   | [S7,MB2,BI] 283-34-317ms   | [S7,MB2,BW] 317-0-317ms    | [S7,MB3,F]  317-17-335ms   | [S7,MB3,BI] 347-34-381ms   | [S7,MB3,BW] 381-0-381ms    | [S0,MB7,F]  382-9-391ms    | [S0,MB0,B]  392-0-392ms    | [S7,MB4,F]  400-17-417ms   | [S7,MB4,BI] 429-33-462ms   | [S7,MB4,BW] 461-1-463ms    | [S0,MB1,B]  468-0-468ms    | [S7,MB5,F]  472-16-488ms   | [S7,MB5,BI] 499-32-532ms   | [S7,MB5,BW] 532-1-533ms    | [S0,MB2,B]  539-0-539ms    | [S7,MB6,F]  553-14-567ms   | [S7,MB6,BI] 579-32-612ms   | [S7,MB6,BW] 612-1-614ms    | [S0,MB3,B]  619-0-619ms    | [S7,MB7,F]  633-14-648ms   | [S7,MB7,BI] 660-32-693ms   | [S7,MB7,BW] 693-0-693ms    | [S0,MB4,B]  700-0-700ms    | [S0,MB5,B]  725-0-725ms    | [S0,MB6,B]  750-0-750ms    | [S0,MB7,B]  774-0-774ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  26-10-37ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-124ms    | [S6,MB0,BI] 170-9-180ms    | [S6,MB0,BW] 180-0-180ms    | [S6,MB2,F]  180-8-189ms    | [S6,MB1,BI] 235-9-244ms    | [S6,MB1,BW] 244-0-244ms    | [S6,MB3,F]  244-8-252ms    | [S6,MB2,BI] 317-9-326ms    | [S6,MB2,BW] 326-0-326ms    | [S1,MB6,F]  326-12-338ms   | [S1,MB0,BI] 338-15-354ms   | [S1,MB0,BW] 354-0-354ms    | [S6,MB4,F]  354-7-362ms    | [S6,MB3,BI] 381-11-392ms   | [S6,MB3,BW] 392-0-392ms    | [S1,MB7,F]  393-13-407ms   | [S1,MB1,BI] 406-15-422ms   | [S1,MB1,BW] 422-0-422ms    | [S6,MB5,F]  422-7-430ms    | [S6,MB4,BI] 461-12-473ms   | [S6,MB4,BW] 474-0-474ms    | [S1,MB2,BI] 480-14-494ms   | [S1,MB2,BW] 494-0-494ms    | [S6,MB6,F]  538-7-545ms    | [S6,MB5,BI] 545-10-555ms   | [S6,MB5,BW] 556-0-556ms    | [S1,MB3,BI] 562-14-576ms   | [S1,MB3,BW] 576-0-576ms    | [S6,MB7,F]  619-7-626ms    | [S6,MB6,BI] 626-10-636ms   | [S6,MB6,BW] 636-0-636ms    | [S1,MB4,BI] 643-14-657ms   | [S6,MB7,BI] 693-10-703ms   | [S1,MB5,BI] 703-14-718ms   | [S1,MB4,BW] 718-0-718ms    | [S1,MB6,BI] 729-14-743ms   | [S1,MB5,BW] 744-0-744ms    | [S1,MB7,BI] 753-14-767ms   | [S1,MB6,BW] 767-0-767ms    | [S6,MB7,BW] 767-0-767ms    | [S1,MB7,BW] 767-0-767ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  37-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  93-8-102ms     | [S5,MB2,F]  110-8-118ms    | [S5,MB0,BI] 180-9-189ms    | [S5,MB0,BW] 189-0-189ms    | [S5,MB3,F]  189-8-197ms    | [S5,MB1,BI] 244-9-253ms    | [S5,MB1,BW] 253-0-253ms    | [S2,MB5,F]  253-8-262ms    | [S2,MB0,BI] 262-10-272ms   | [S2,MB0,BW] 272-0-272ms    | [S5,MB4,F]  272-7-280ms    | [S5,MB2,BI] 326-10-336ms   | [S5,MB2,BW] 336-0-336ms    | [S2,MB6,F]  339-9-348ms    | [S2,MB1,BI] 350-10-360ms   | [S2,MB1,BW] 361-0-361ms    | [S5,MB5,F]  361-7-368ms    | [S5,MB3,BI] 397-10-407ms   | [S5,MB3,BW] 407-0-407ms    | [S2,MB7,F]  407-9-417ms    | [S2,MB2,BI] 419-10-430ms   | [S2,MB2,BW] 429-0-429ms    | [S5,MB6,F]  429-7-437ms    | [S5,MB4,BI] 474-10-484ms   | [S5,MB4,BW] 484-0-484ms    | [S2,MB3,BI] 542-9-551ms    | [S2,MB3,BW] 551-0-551ms    | [S5,MB7,F]  562-7-569ms    | [S5,MB5,BI] 569-9-578ms    | [S5,MB5,BW] 578-0-578ms    | [S2,MB4,BI] 622-9-631ms    | [S5,MB6,BI] 636-10-647ms   | [S2,MB5,BI] 646-10-656ms   | [S5,MB7,BI] 703-9-712ms    | [S2,MB6,BI] 712-10-722ms   | [S2,MB4,BW] 723-0-723ms    | [S2,MB7,BI] 737-9-747ms    | [S2,MB5,BW] 746-0-746ms    | [S5,MB6,BW] 746-0-746ms    | [S5,MB7,BW] 747-0-747ms    | [S2,MB6,BW] 747-0-747ms    | [S2,MB7,BW] 747-0-747ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-78ms      | [S3,MB3,F]  93-7-101ms     | [S4,MB3,F]  101-8-109ms    | [S4,MB0,BI] 189-8-198ms    | [S4,MB0,BW] 198-0-198ms    | [S3,MB4,F]  198-6-205ms    | [S3,MB0,BI] 205-9-214ms    | [S3,MB0,BW] 214-0-214ms    | [S4,MB4,F]  214-7-221ms    | [S4,MB1,BI] 253-11-265ms   | [S4,MB1,BW] 265-0-265ms    | [S3,MB5,F]  265-7-273ms    | [S3,MB1,BI] 273-9-282ms    | [S3,MB1,BW] 282-0-282ms    | [S4,MB5,F]  282-7-289ms    | [S4,MB2,BI] 343-11-354ms   | [S4,MB2,BW] 354-0-354ms    | [S3,MB6,F]  354-7-362ms    | [S3,MB2,BI] 362-9-371ms    | [S3,MB2,BW] 371-0-371ms    | [S4,MB6,F]  371-7-378ms    | [S4,MB3,BI] 412-11-424ms   | [S4,MB3,BW] 424-0-424ms    | [S3,MB7,F]  424-7-431ms    | [S3,MB3,BI] 431-9-440ms    | [S3,MB3,BW] 440-0-440ms    | [S4,MB7,F]  440-7-448ms    | [S4,MB4,BI] 535-10-545ms   | [S4,MB4,BW] 545-0-545ms    | [S3,MB4,BI] 545-9-555ms    | [S4,MB5,BI] 615-9-625ms    | [S3,MB5,BI] 625-8-634ms    | [S4,MB6,BI] 647-9-656ms    | [S3,MB6,BI] 655-9-664ms    | [S4,MB7,BI] 712-8-721ms    | [S3,MB7,BI] 721-8-730ms    | [S3,MB4,BW] 730-0-730ms    | [S4,MB5,BW] 730-0-730ms    | [S4,MB6,BW] 731-0-731ms    | [S4,MB7,BW] 731-0-731ms    | [S3,MB5,BW] 731-0-731ms    | [S3,MB6,BW] 731-0-731ms    | [S3,MB7,BW] 731-0-731ms   
[rank3]:2025-12-28 00:18:57,988 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0018_stage3_step100.svg
[rank0]:2025-12-28 00:18:57,936 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank0_stage7.svg
[rank0]:	> Counts Sum: 6400, Total Sum: 7040 (90.91%), Ratio(%) per element: [100.0, 68.75, 87.5, 93.75, 81.25, 100.0, 87.5, 93.75, 100.0, 93.75, 93.75]
[rank0]:2025-12-28 00:18:57,977 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage0.svg
[rank0]:2025-12-28 00:18:58,014 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage7.svg
[rank1]:2025-12-28 00:18:57,988 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-28 00:18:58,027 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage1.svg
[rank2]:2025-12-28 00:18:57,987 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-28 00:18:58,025 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage2.svg
[rank3]:2025-12-28 00:18:58,025 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0018_stage4_step100.svg
[rank1]:2025-12-28 00:18:58,062 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage6.svg
[rank2]:2025-12-28 00:18:58,060 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage5.svg
[rank3]:2025-12-28 00:18:58,125 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank3_stage3.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-28 00:18:58,226 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0018_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-28 00:18:58,265 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage3.svg
[rank3]:2025-12-28 00:18:58,300 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0018_stage4.svg
[rank0]:2025-12-28 00:22:04,712 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-28 00:22:04,942 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.37, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-12-28 00:22:04,942 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.17/0.25, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.25/0.37, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-12-28 00:22:04,947 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.67/1.00, [MB3] 0.00/0.00, [MB1] 0.57/0.86, [MB4] 0.00/0.00, [MB2] 0.22/0.33, [MB5] 0.00/0.00, [MB3] 0.21/0.31, [MB6] 0.00/0.00, [MB4] 0.49/0.73, [MB5] 0.57/0.85, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-28 00:22:04,971 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.65/0.98, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB4] 0.67/1.00, [MB1] 0.67/1.00, [MB5] 0.67/1.00, [MB2] 0.67/1.00, [MB6] 0.67/1.00, [MB3] 0.67/1.00, [MB7] 0.28/0.42, [MB4] 0.48/0.72, [MB5] 0.22/0.33, [MB6] 0.24/0.36, [MB7] 0.67/1.00
[rank3]:2025-12-28 00:22:08,523 - Avg. fwd time: 7.7000 / Avg. bwd-weight time: 7.8540 / Avg. bwd-input time: 9.5663 / Avg. batch time: 917.0014 (ms) / GPU bubble ratio: 56.17%
[rank2]:2025-12-28 00:22:08,520 - Avg. fwd time: 7.9625 / Avg. bwd-weight time: 8.1945 / Avg. bwd-input time: 9.8463 / Avg. batch time: 928.1780 (ms) / GPU bubble ratio: 55.18%
[rank1]:2025-12-28 00:22:08,533 - Avg. fwd time: 9.9050 / Avg. bwd-weight time: 10.0365 / Avg. bwd-input time: 12.4385 / Avg. batch time: 960.3773 (ms) / GPU bubble ratio: 46.05%
[rank0]:2025-12-28 00:22:08,553 - Avg. fwd time: 12.8538 / Avg. full-bwd time: 21.3417 (Avg. bwd-weight time: 20.1292 / Avg. bwd-input time: 33.6136) / Avg. batch time: 980.2075 (ms) / GPU bubble ratio: 17.74%
[rank3]:2025-12-28 00:22:08,599 -  step: 150  loss: -4.0000  grad_norm:  8.9272  memory: 15.27GiB(32.13%)  tps: 8,579  tflops: 67.07  mfu: 21.50%
[rank2]:2025-12-28 00:22:08,599 -  step: 150  loss: -4.0000  grad_norm:  8.9272  memory: 13.80GiB(29.05%)  tps: 8,579  tflops: 67.07  mfu: 21.50%
[rank1]:2025-12-28 00:22:08,603 -  step: 150  loss: -4.0000  grad_norm:  8.9272  memory: 17.87GiB(37.61%)  tps: 8,579  tflops: 67.07  mfu: 21.50%
[rank0]:2025-12-28 00:22:08,625 -  step: 150  loss:  3.9915  grad_norm:  8.9272  memory: 36.24GiB(76.29%)  tps: 8,579  tflops: 67.07  mfu: 21.50%
[rank0]:2025-12-28 00:25:05,677 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 00:25:06,048 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 00:25:06,049 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.31/0.31, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 00:25:06,048 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 00:25:06,079 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.98/0.98, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.42/0.42, [MB4] 0.72/0.72, [MB5] 0.33/0.33, [MB6] 0.36/0.36, [MB7] 1.00/1.00
[rank2]:2025-12-28 00:25:09,365 - Avg. fwd time: 7.9863 / Avg. bwd-weight time: 8.1720 / Avg. bwd-input time: 9.8773 / Avg. batch time: 899.0777 (ms) / GPU bubble ratio: 53.67%
[rank1]:2025-12-28 00:25:09,367 - Avg. fwd time: 9.8746 / Avg. bwd-weight time: 9.4911 / Avg. bwd-input time: 12.4920 / Avg. batch time: 928.5432 (ms) / GPU bubble ratio: 45.11%
[rank1]:2025-12-28 00:25:09,416 -  step: 200  loss: -4.0000  grad_norm:  4.7390  memory: 17.87GiB(37.61%)  tps: 9,061  tflops: 70.84  mfu: 22.70%
[rank3]:2025-12-28 00:25:09,362 - Avg. fwd time: 7.7110 / Avg. bwd-weight time: 7.7780 / Avg. bwd-input time: 9.6095 / Avg. batch time: 887.7454 (ms) / GPU bubble ratio: 54.76%
[rank3]:2025-12-28 00:25:09,412 -  step: 200  loss: -4.0000  grad_norm:  4.7390  memory: 15.27GiB(32.13%)  tps: 9,061  tflops: 70.84  mfu: 22.70%
[rank0]:2025-12-28 00:25:09,370 - Avg. fwd time: 12.8483 / Avg. full-bwd time: 20.1920 (Avg. bwd-weight time: 17.7794 / Avg. bwd-input time: 33.6493) / Avg. batch time: 951.0606 (ms) / GPU bubble ratio: 18.14%
[rank0]:2025-12-28 00:25:09,425 -  step: 200  loss:  1.4469  grad_norm:  4.7390  memory: 36.24GiB(76.29%)  tps: 9,062  tflops: 70.84  mfu: 22.71%
[rank2]:2025-12-28 00:25:09,412 -  step: 200  loss: -4.0000  grad_norm:  4.7390  memory: 13.80GiB(29.05%)  tps: 9,061  tflops: 70.84  mfu: 22.70%
[rank2]:2025-12-28 00:25:09,477 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0025_stage2_step200.svg
[rank1]:2025-12-28 00:25:09,478 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0025_stage1_step200.svg
[rank1]:2025-12-28 00:25:09,520 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0025_stage6_step200.svg
[rank0]:2025-12-28 00:25:09,478 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0025_stage0_step200.svg
[rank0]:2025-12-28 00:25:09,520 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0025_stage7_step200.svg
[rank2]:2025-12-28 00:25:09,520 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0025_stage5_step200.svg
[rank0]:2025-12-28 00:25:09,624 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank0_stage0.svg
[rank0]:	> Counts Sum: 46200, Total Sum: 72960 (63.32%), Ratio(%) per element: [45.83, 66.66, 63.54, 68.75, 72.91, 66.66, 63.54, 69.79, 71.87, 69.79, 57.29, 59.37, 61.45, 62.5, 64.58, 55.2, 60.41, 62.5, 60.41]
[rank2]:2025-12-28 00:25:09,621 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank2_stage2.svg
[rank2]:	> Counts Sum: 27880, Total Sum: 69120 (40.34%), Ratio(%) per element: [43.75, 38.54, 35.41, 41.66, 41.66, 41.66, 42.7, 43.75, 41.66, 36.45, 33.33, 40.62, 44.79, 39.58, 37.5, 41.66, 41.66, 39.58]
[rank1]:2025-12-28 00:25:09,644 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank1_stage1.svg
[rank1]:	> Counts Sum: 63200, Total Sum: 103680 (60.96%), Ratio(%) per element: [62.5, 62.5, 63.54, 68.75, 67.7, 58.33, 62.5, 65.62, 70.83, 60.41, 58.33, 57.29, 54.16, 58.33, 60.41, 57.29, 57.29, 56.25, 57.29, 59.37, 66.66, 58.33, 65.62, 54.16, 60.41, 65.62, 56.25]
[rank0]:2025-12-28 00:25:09,704 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank0_stage7.svg
[rank0]:	> Counts Sum: 26080, Total Sum: 42240 (61.74%), Ratio(%) per element: [62.5, 63.54, 60.41, 57.29, 58.33, 63.54, 62.5, 64.58, 60.41, 63.54, 62.5]
[rank2]:2025-12-28 00:25:09,724 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank2_stage5.svg
[rank2]:	> Counts Sum: 13400, Total Sum: 69120 (19.39%), Ratio(%) per element: [18.75, 19.79, 19.79, 18.75, 21.87, 18.75, 19.79, 17.7, 18.75, 20.83, 18.75, 20.83, 19.79, 18.75, 17.7, 19.79, 18.75, 19.79]
[rank1]:2025-12-28 00:25:09,742 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank1_stage6.svg
[rank1]:	> Counts Sum: 16560, Total Sum: 69120 (23.96%), Ratio(%) per element: [25.0, 21.87, 26.04, 26.04, 23.95, 26.04, 25.0, 23.95, 22.91, 23.95, 22.91, 22.91, 23.95, 23.95, 23.95, 20.83, 22.91, 25.0]
[rank3]:2025-12-28 00:25:09,764 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0025_step200_rank3.svg
[rank3]:			> Batch Time: 830.73 ms, GPU Bubble Ratio: 20.96%, 42.71%, 49.61%, 52.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  43-9-53ms      | [S0,MB6,F]  53-8-61ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 172-26-198ms   | [S7,MB1,F]  198-15-213ms   | [S7,MB1,BI] 225-34-259ms   | [S7,MB1,BW] 259-0-259ms    | [S7,MB2,F]  260-16-276ms   | [S7,MB2,BI] 288-35-323ms   | [S7,MB2,BW] 323-22-345ms   | [S7,MB3,F]  345-18-363ms   | [S7,MB3,BI] 374-34-408ms   | [S7,MB3,BW] 409-0-409ms    | [S0,MB7,F]  409-10-419ms   | [S0,MB0,B]  419-12-432ms   | [S7,MB4,F]  432-18-450ms   | [S7,MB4,BI] 462-34-497ms   | [S7,MB4,BW] 497-1-498ms    | [S0,MB1,B]  504-4-509ms    | [S7,MB5,F]  509-16-526ms   | [S7,MB5,BI] 537-33-571ms   | [S7,MB5,BW] 570-0-570ms    | [S0,MB2,B]  577-11-588ms   | [S7,MB6,F]  591-15-607ms   | [S7,MB6,BI] 619-33-652ms   | [S7,MB6,BW] 652-0-653ms    | [S0,MB3,B]  659-3-663ms    | [S7,MB7,F]  673-14-688ms   | [S7,MB7,BI] 700-32-732ms   | [S7,MB7,BW] 732-25-758ms   | [S0,MB4,B]  758-19-777ms   | [S0,MB5,B]  778-23-801ms   | [S0,MB6,B]  801-19-821ms   | [S0,MB7,B]  821-9-830ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  62-11-73ms     | [S1,MB4,F]  83-11-94ms     | [S6,MB0,F]  94-9-104ms     | [S1,MB5,F]  104-12-117ms   | [S6,MB1,F]  117-8-125ms    | [S6,MB0,BI] 172-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-199ms    | [S6,MB1,BI] 259-9-268ms    | [S6,MB1,BW] 268-10-279ms   | [S6,MB3,F]  279-7-286ms    | [S6,MB2,BI] 324-9-334ms    | [S6,MB2,BW] 334-10-345ms   | [S1,MB6,F]  345-11-356ms   | [S1,MB0,BI] 356-15-372ms   | [S1,MB0,BW] 372-1-373ms    | [S6,MB4,F]  373-7-381ms    | [S6,MB3,BI] 408-11-420ms   | [S6,MB3,BW] 419-11-431ms   | [S1,MB7,F]  431-11-443ms   | [S1,MB1,BI] 442-15-458ms   | [S1,MB1,BW] 458-4-462ms    | [S6,MB5,F]  462-8-471ms    | [S6,MB4,BI] 497-11-509ms   | [S6,MB4,BW] 509-10-520ms   | [S1,MB2,BI] 520-14-535ms   | [S1,MB2,BW] 535-11-546ms   | [S6,MB6,F]  576-7-584ms    | [S6,MB5,BI] 584-10-594ms   | [S6,MB5,BW] 594-10-605ms   | [S1,MB3,BI] 605-14-620ms   | [S1,MB3,BW] 619-10-630ms   | [S6,MB7,F]  658-7-666ms    | [S6,MB6,BI] 666-10-676ms   | [S6,MB6,BW] 676-10-687ms   | [S1,MB4,BI] 687-14-702ms   | [S6,MB7,BI] 732-10-743ms   | [S1,MB5,BI] 742-15-758ms   | [S1,MB4,BW] 757-6-764ms    | [S1,MB6,BI] 770-14-785ms   | [S1,MB5,BW] 785-2-788ms    | [S1,MB7,BI] 794-14-809ms   | [S1,MB6,BW] 809-1-811ms    | [S6,MB7,BW] 811-0-811ms    | [S1,MB7,BW] 811-1-813ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-103ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-201ms   | [S5,MB3,F]  200-7-208ms    | [S5,MB1,BI] 269-9-278ms    | [S5,MB1,BW] 278-10-288ms   | [S2,MB5,F]  288-7-295ms    | [S2,MB0,BI] 296-10-306ms   | [S2,MB0,BW] 306-9-316ms    | [S5,MB4,F]  316-7-323ms    | [S5,MB2,BI] 334-10-345ms   | [S5,MB2,BW] 345-9-355ms    | [S2,MB6,F]  357-10-367ms   | [S2,MB1,BI] 369-11-380ms   | [S2,MB1,BW] 380-9-389ms    | [S5,MB5,F]  390-7-397ms    | [S5,MB3,BI] 425-10-435ms   | [S5,MB3,BW] 435-10-446ms   | [S2,MB7,F]  446-9-455ms    | [S2,MB2,BI] 456-10-467ms   | [S2,MB2,BW] 467-9-477ms    | [S5,MB6,F]  477-7-484ms    | [S5,MB4,BI] 509-10-520ms   | [S5,MB4,BW] 520-9-530ms    | [S2,MB3,BI] 580-9-590ms    | [S2,MB3,BW] 590-10-600ms   | [S5,MB7,F]  604-7-611ms    | [S5,MB5,BI] 611-9-621ms    | [S5,MB5,BW] 621-9-630ms    | [S2,MB4,BI] 662-9-672ms    | [S5,MB6,BI] 677-10-687ms   | [S2,MB5,BI] 687-10-697ms   | [S5,MB7,BI] 745-9-754ms    | [S2,MB6,BI] 754-10-764ms   | [S2,MB4,BW] 764-7-771ms    | [S2,MB7,BI] 779-9-788ms    | [S2,MB5,BW] 788-1-790ms    | [S5,MB6,BW] 790-10-800ms   | [S5,MB7,BW] 800-7-807ms    | [S2,MB6,BW] 807-1-809ms    | [S2,MB7,BW] 809-1-810ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-7-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-8-79ms      | [S3,MB3,F]  94-7-102ms     | [S4,MB3,F]  102-8-110ms    | [S4,MB0,BI] 191-8-200ms    | [S4,MB0,BW] 200-9-209ms    | [S3,MB4,F]  209-6-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 278-10-288ms   | [S4,MB1,BW] 288-10-299ms   | [S3,MB5,F]  299-8-307ms    | [S3,MB1,BI] 307-9-316ms    | [S3,MB1,BW] 316-9-326ms    | [S4,MB5,F]  326-7-333ms    | [S4,MB2,BI] 362-11-373ms   | [S4,MB2,BW] 373-9-383ms    | [S3,MB6,F]  383-7-390ms    | [S3,MB2,BI] 390-9-400ms    | [S3,MB2,BW] 400-9-409ms    | [S4,MB6,F]  410-7-417ms    | [S4,MB3,BI] 449-11-461ms   | [S4,MB3,BW] 461-9-471ms    | [S3,MB7,F]  471-7-478ms    | [S3,MB3,BI] 478-9-487ms    | [S3,MB3,BW] 487-9-497ms    | [S4,MB7,F]  497-7-505ms    | [S4,MB4,BI] 573-10-584ms   | [S4,MB4,BW] 584-9-593ms    | [S3,MB4,BI] 593-10-604ms   | [S4,MB5,BI] 655-9-665ms    | [S3,MB5,BI] 665-8-674ms    | [S4,MB6,BI] 688-9-697ms    | [S3,MB6,BI] 697-9-706ms    | [S4,MB7,BI] 754-9-763ms    | [S3,MB7,BI] 763-8-772ms    | [S3,MB4,BW] 772-0-773ms    | [S4,MB5,BW] 773-10-783ms   | [S4,MB6,BW] 783-9-792ms    | [S4,MB7,BW] 792-5-798ms    | [S3,MB5,BW] 798-1-799ms    | [S3,MB6,BW] 799-1-801ms    | [S3,MB7,BW] 800-0-800ms   
[rank3]:2025-12-28 00:25:09,808 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0025_stage3_step200.svg
[rank2]:2025-12-28 00:25:09,898 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage2.svg
[rank1]:2025-12-28 00:25:09,905 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage1.svg
[rank3]:2025-12-28 00:25:09,851 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0025_stage4_step200.svg
[rank0]:2025-12-28 00:25:09,879 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage0.svg
[rank3]:2025-12-28 00:25:09,953 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank3_stage3.svg
[rank3]:	> Counts Sum: 31680, Total Sum: 69120 (45.83%), Ratio(%) per element: [45.83, 51.04, 47.91, 45.83, 39.58, 42.7, 45.83, 47.91, 40.62, 45.83, 41.66, 45.83, 47.91, 51.04, 45.83, 43.75, 47.91, 47.91]
[rank2]:2025-12-28 00:25:10,065 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage5.svg
[rank1]:2025-12-28 00:25:10,063 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage6.svg
[rank3]:2025-12-28 00:25:10,054 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0025_rank3_stage4.svg
[rank3]:	> Counts Sum: 13400, Total Sum: 69120 (19.39%), Ratio(%) per element: [19.79, 20.83, 20.83, 17.7, 21.87, 18.75, 20.83, 21.87, 22.91, 16.66, 17.7, 18.75, 17.7, 17.7, 19.79, 18.75, 18.75, 17.7]
[rank0]:2025-12-28 00:25:10,049 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage7.svg
[rank3]:2025-12-28 00:25:10,224 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage3.svg
[rank3]:2025-12-28 00:25:10,384 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0025_stage4.svg
[rank0]:2025-12-28 00:27:51,835 - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-12-28 00:27:52,254 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 00:27:52,254 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 00:27:52,283 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.98/0.98, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.42/0.42, [MB4] 0.72/0.72, [MB5] 0.33/0.33, [MB6] 0.36/0.36, [MB7] 1.00/1.00
[rank1]:2025-12-28 00:27:52,255 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.31/0.31, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 00:27:55,566 - Avg. fwd time: 7.7289 / Avg. bwd-weight time: 7.6375 / Avg. bwd-input time: 9.6622 / Avg. batch time: 858.0669 (ms) / GPU bubble ratio: 53.33%
[rank2]:2025-12-28 00:27:55,569 - Avg. fwd time: 8.0154 / Avg. bwd-weight time: 8.1239 / Avg. bwd-input time: 9.9320 / Avg. batch time: 870.3522 (ms) / GPU bubble ratio: 52.07%
[rank2]:2025-12-28 00:27:55,617 -  step: 250  loss: -4.0000  grad_norm:  1.7423  memory: 13.82GiB(29.09%)  tps: 9,858  tflops: 77.06  mfu: 24.70%
[rank0]:2025-12-28 00:27:55,572 - Avg. fwd time: 12.7747 / Avg. full-bwd time: 17.5743 (Avg. bwd-weight time: 15.2406 / Avg. bwd-input time: 33.5779) / Avg. batch time: 918.5971 (ms) / GPU bubble ratio: 19.93%
[rank0]:2025-12-28 00:27:55,643 -  step: 250  loss:  0.4769  grad_norm:  1.7423  memory: 36.24GiB(76.29%)  tps: 9,857  tflops: 77.06  mfu: 24.70%
[rank1]:2025-12-28 00:27:55,570 - Avg. fwd time: 9.8635 / Avg. bwd-weight time: 8.9407 / Avg. bwd-input time: 12.5725 / Avg. batch time: 897.2980 (ms) / GPU bubble ratio: 44.05%
[rank1]:2025-12-28 00:27:55,620 -  step: 250  loss: -4.0000  grad_norm:  1.7423  memory: 17.87GiB(37.61%)  tps: 9,858  tflops: 77.06  mfu: 24.70%
[rank3]:2025-12-28 00:27:55,617 -  step: 250  loss: -4.0000  grad_norm:  1.7423  memory: 15.27GiB(32.13%)  tps: 9,858  tflops: 77.06  mfu: 24.70%
[rank0]:2025-12-28 00:30:37,509 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-28 00:30:37,952 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.31/0.31, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 00:30:37,949 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 00:30:37,947 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 00:30:37,975 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.98/0.98, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.42/0.42, [MB4] 0.72/0.72, [MB5] 0.33/0.33, [MB6] 0.36/0.36, [MB7] 1.00/1.00
[rank3]:2025-12-28 00:30:41,215 - Avg. fwd time: 7.7408 / Avg. bwd-weight time: 7.5376 / Avg. bwd-input time: 9.7015 / Avg. batch time: 838.3170 (ms) / GPU bubble ratio: 52.32%
[rank2]:2025-12-28 00:30:41,218 - Avg. fwd time: 8.0348 / Avg. bwd-weight time: 8.0918 / Avg. bwd-input time: 9.9731 / Avg. batch time: 851.1391 (ms) / GPU bubble ratio: 50.94%
[rank0]:2025-12-28 00:30:41,228 - Avg. fwd time: 12.7289 / Avg. full-bwd time: 15.7776 (Avg. bwd-weight time: 13.7387 / Avg. bwd-input time: 33.5300) / Avg. batch time: 896.8334 (ms) / GPU bubble ratio: 21.05%
[rank1]:2025-12-28 00:30:41,221 - Avg. fwd time: 9.8542 / Avg. bwd-weight time: 8.5470 / Avg. bwd-input time: 12.6258 / Avg. batch time: 876.3522 (ms) / GPU bubble ratio: 43.35%
[rank3]:2025-12-28 00:30:41,274 -  step: 300  loss: -4.0000  grad_norm:  0.7596  memory: 15.27GiB(32.13%)  tps: 9,890  tflops: 77.32  mfu: 24.78%
[rank2]:2025-12-28 00:30:41,274 -  step: 300  loss: -4.0000  grad_norm:  0.7596  memory: 13.82GiB(29.09%)  tps: 9,890  tflops: 77.32  mfu: 24.78%
[rank0]:2025-12-28 00:30:41,300 -  step: 300  loss:  0.2993  grad_norm:  0.7596  memory: 36.24GiB(76.29%)  tps: 9,890  tflops: 77.32  mfu: 24.78%
[rank0]:2025-12-28 00:30:41,351 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0030_stage0_step300.svg
[rank1]:2025-12-28 00:30:41,277 -  step: 300  loss: -4.0000  grad_norm:  0.7596  memory: 17.87GiB(37.61%)  tps: 9,890  tflops: 77.32  mfu: 24.78%
[rank1]:2025-12-28 00:30:41,350 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0030_stage1_step300.svg
[rank2]:2025-12-28 00:30:41,350 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0030_stage2_step300.svg
[rank2]:2025-12-28 00:30:41,391 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0030_stage5_step300.svg
[rank0]:2025-12-28 00:30:41,391 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0030_stage7_step300.svg
[rank1]:2025-12-28 00:30:41,390 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0030_stage6_step300.svg
[rank2]:2025-12-28 00:30:41,489 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank2_stage2.svg
[rank2]:	> Counts Sum: 51080, Total Sum: 126720 (40.31%), Ratio(%) per element: [43.18, 38.63, 38.06, 42.04, 40.34, 41.47, 40.9, 43.75, 41.47, 37.5, 35.79, 40.9, 42.04, 39.2, 38.63, 40.34, 41.47, 39.77]
[rank0]:2025-12-28 00:30:41,494 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank0_stage0.svg
[rank0]:	> Counts Sum: 95000, Total Sum: 133760 (71.02%), Ratio(%) per element: [61.93, 72.72, 70.45, 73.86, 77.27, 69.88, 72.72, 75.56, 76.13, 73.29, 66.47, 68.75, 71.02, 70.45, 72.15, 67.61, 69.31, 72.15, 67.61]
[rank1]:2025-12-28 00:30:41,514 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank1_stage1.svg
[rank1]:	> Counts Sum: 128800, Total Sum: 190080 (67.76%), Ratio(%) per element: [73.86, 71.02, 72.72, 73.86, 72.72, 68.75, 72.72, 72.15, 78.4, 67.61, 64.2, 63.63, 62.5, 67.61, 66.47, 62.5, 65.9, 65.34, 63.06, 64.2, 67.04, 65.9, 69.31, 60.22, 64.77, 68.18, 64.77]
[rank3]:2025-12-28 00:30:41,610 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0030_step300_rank3.svg
[rank3]:			> Batch Time: 783.50 ms, GPU Bubble Ratio: 27.83%, 39.86%, 46.51%, 49.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 258-0-258ms    | [S7,MB2,F]  258-16-275ms   | [S7,MB2,BI] 287-34-321ms   | [S7,MB2,BW] 322-0-322ms    | [S7,MB3,F]  322-17-339ms   | [S7,MB3,BI] 351-34-385ms   | [S7,MB3,BW] 385-0-385ms    | [S0,MB7,F]  385-9-395ms    | [S0,MB0,B]  395-0-395ms    | [S7,MB4,F]  403-17-420ms   | [S7,MB4,BI] 432-33-465ms   | [S7,MB4,BW] 465-0-465ms    | [S0,MB1,B]  472-0-472ms    | [S7,MB5,F]  476-16-492ms   | [S7,MB5,BI] 504-32-536ms   | [S7,MB5,BW] 537-0-537ms    | [S0,MB2,B]  543-0-543ms    | [S7,MB6,F]  558-14-572ms   | [S7,MB6,BI] 584-32-617ms   | [S7,MB6,BW] 617-0-617ms    | [S0,MB3,B]  624-0-624ms    | [S7,MB7,F]  638-14-652ms   | [S7,MB7,BI] 665-32-698ms   | [S7,MB7,BW] 698-24-722ms   | [S0,MB4,B]  721-12-733ms   | [S0,MB5,B]  735-18-753ms   | [S0,MB6,B]  758-21-779ms   | [S0,MB7,B]  783-0-783ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  277-7-285ms    | [S6,MB2,BI] 322-9-331ms    | [S6,MB2,BW] 331-10-342ms   | [S1,MB6,F]  342-11-353ms   | [S1,MB0,BI] 353-15-369ms   | [S1,MB0,BW] 369-0-369ms    | [S6,MB4,F]  369-7-377ms    | [S6,MB3,BI] 385-12-397ms   | [S6,MB3,BW] 397-11-409ms   | [S1,MB7,F]  409-11-420ms   | [S1,MB1,BI] 420-16-437ms   | [S1,MB1,BW] 437-2-439ms    | [S6,MB5,F]  439-8-448ms    | [S6,MB4,BI] 465-12-477ms   | [S6,MB4,BW] 477-10-488ms   | [S1,MB2,BI] 488-14-503ms   | [S1,MB2,BW] 503-11-515ms   | [S6,MB6,F]  543-7-550ms    | [S6,MB5,BI] 550-10-561ms   | [S6,MB5,BW] 561-10-571ms   | [S1,MB3,BI] 572-14-587ms   | [S1,MB3,BW] 587-10-598ms   | [S6,MB7,F]  623-7-631ms    | [S6,MB6,BI] 631-10-642ms   | [S6,MB6,BW] 642-10-653ms   | [S1,MB4,BI] 653-14-668ms   | [S6,MB7,BI] 698-10-709ms   | [S1,MB5,BI] 709-15-724ms   | [S1,MB4,BW] 724-4-728ms    | [S1,MB6,BI] 736-14-751ms   | [S1,MB5,BW] 751-3-755ms    | [S1,MB7,BI] 761-14-775ms   | [S1,MB6,BW] 776-0-776ms    | [S6,MB7,BW] 776-0-776ms    | [S1,MB7,BW] 776-0-776ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-315ms    | [S5,MB4,F]  315-7-322ms    | [S5,MB2,BI] 331-10-342ms   | [S5,MB2,BW] 342-9-352ms    | [S2,MB6,F]  354-10-364ms   | [S2,MB1,BI] 365-11-376ms   | [S2,MB1,BW] 376-10-386ms   | [S5,MB5,F]  386-7-394ms    | [S5,MB3,BI] 400-11-411ms   | [S5,MB3,BW] 411-10-422ms   | [S2,MB7,F]  423-10-433ms   | [S2,MB2,BI] 434-11-445ms   | [S2,MB2,BW] 445-10-456ms   | [S5,MB6,F]  456-8-464ms    | [S5,MB4,BI] 478-11-489ms   | [S5,MB4,BW] 489-9-498ms    | [S2,MB3,BI] 547-9-556ms    | [S2,MB3,BW] 556-10-567ms   | [S5,MB7,F]  571-7-578ms    | [S5,MB5,BI] 578-9-587ms    | [S5,MB5,BW] 587-9-597ms    | [S2,MB4,BI] 627-9-637ms    | [S5,MB6,BI] 642-10-652ms   | [S2,MB5,BI] 652-10-662ms   | [S5,MB7,BI] 711-9-720ms    | [S2,MB6,BI] 720-10-730ms   | [S2,MB4,BW] 730-7-737ms    | [S2,MB7,BI] 745-9-755ms    | [S2,MB5,BW] 755-0-755ms    | [S5,MB6,BW] 755-10-765ms   | [S5,MB7,BW] 765-6-771ms    | [S2,MB6,BW] 771-0-771ms    | [S2,MB7,BW] 771-0-771ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-9-199ms    | [S4,MB0,BW] 199-9-209ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 276-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  325-7-332ms    | [S4,MB2,BI] 359-11-370ms   | [S4,MB2,BW] 370-9-380ms    | [S3,MB6,F]  380-7-387ms    | [S3,MB2,BI] 387-9-397ms    | [S3,MB2,BW] 397-9-407ms    | [S4,MB6,F]  407-7-415ms    | [S4,MB3,BI] 427-12-439ms   | [S4,MB3,BW] 439-9-449ms    | [S3,MB7,F]  449-7-456ms    | [S3,MB3,BI] 456-9-466ms    | [S3,MB3,BW] 466-10-476ms   | [S4,MB7,F]  476-8-485ms    | [S4,MB4,BI] 540-10-550ms   | [S4,MB4,BW] 550-9-560ms    | [S3,MB4,BI] 560-10-570ms   | [S4,MB5,BI] 620-10-630ms   | [S3,MB5,BI] 630-9-639ms    | [S4,MB6,BI] 653-9-662ms    | [S3,MB6,BI] 662-9-671ms    | [S4,MB7,BI] 721-9-730ms    | [S3,MB7,BI] 730-9-739ms    | [S3,MB4,BW] 739-0-739ms    | [S4,MB5,BW] 739-10-749ms   | [S4,MB6,BW] 749-9-758ms    | [S4,MB7,BW] 758-4-763ms    | [S3,MB5,BW] 763-0-763ms    | [S3,MB6,BW] 763-0-763ms    | [S3,MB7,BW] 763-0-763ms   
[rank2]:2025-12-28 00:30:41,587 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank2_stage5.svg
[rank2]:	> Counts Sum: 16200, Total Sum: 126720 (12.78%), Ratio(%) per element: [13.06, 12.5, 13.06, 14.2, 14.2, 12.5, 13.06, 13.06, 13.06, 11.36, 11.93, 13.06, 12.5, 12.5, 11.93, 11.36, 12.5, 14.2]
[rank0]:2025-12-28 00:30:41,573 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank0_stage7.svg
[rank0]:	> Counts Sum: 54480, Total Sum: 77440 (70.35%), Ratio(%) per element: [70.45, 70.45, 69.88, 67.61, 68.75, 72.72, 71.59, 72.72, 68.75, 71.59, 69.31]
[rank1]:2025-12-28 00:30:41,610 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank1_stage6.svg
[rank1]:	> Counts Sum: 23760, Total Sum: 126720 (18.75%), Ratio(%) per element: [19.31, 17.61, 19.88, 19.88, 18.75, 19.88, 19.31, 18.75, 18.18, 18.75, 18.18, 18.18, 18.75, 18.75, 18.75, 17.04, 18.18, 19.31]
[rank3]:2025-12-28 00:30:41,651 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0030_stage3_step300.svg
[rank3]:2025-12-28 00:30:41,693 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0030_stage4_step300.svg
[rank3]:2025-12-28 00:30:41,792 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank3_stage3.svg
[rank3]:	> Counts Sum: 60480, Total Sum: 126720 (47.73%), Ratio(%) per element: [47.72, 50.56, 48.86, 47.72, 44.31, 46.02, 47.72, 48.86, 44.88, 47.72, 45.45, 47.72, 48.86, 50.56, 47.72, 46.59, 48.86, 48.86]
[rank3]:2025-12-28 00:30:41,892 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0030_rank3_stage4.svg
[rank3]:	> Counts Sum: 16200, Total Sum: 126720 (12.78%), Ratio(%) per element: [13.06, 13.06, 13.63, 12.5, 14.2, 13.63, 13.06, 14.77, 14.77, 10.22, 12.5, 11.93, 13.06, 11.93, 11.93, 11.93, 13.06, 10.79]
[rank2]:2025-12-28 00:30:41,934 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage2.svg
[rank0]:2025-12-28 00:30:41,881 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage0.svg
[rank1]:2025-12-28 00:30:41,900 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage1.svg
[rank1]:2025-12-28 00:30:42,177 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage6.svg
[rank3]:2025-12-28 00:30:42,196 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage3.svg
[rank2]:2025-12-28 00:30:42,229 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage5.svg
[rank0]:2025-12-28 00:30:42,186 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage7.svg
[rank3]:2025-12-28 00:30:42,485 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0030_stage4.svg
[rank0]:2025-12-28 00:33:23,697 - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-12-28 00:33:27,404 - Avg. fwd time: 7.7491 / Avg. bwd-weight time: 7.4632 / Avg. bwd-input time: 9.7301 / Avg. batch time: 823.7719 (ms) / GPU bubble ratio: 51.55%
[rank2]:2025-12-28 00:33:27,406 - Avg. fwd time: 8.0497 / Avg. bwd-weight time: 8.0667 / Avg. bwd-input time: 10.0028 / Avg. batch time: 837.1882 (ms) / GPU bubble ratio: 50.08%
[rank0]:2025-12-28 00:33:27,413 - Avg. fwd time: 12.6903 / Avg. full-bwd time: 14.5627 (Avg. bwd-weight time: 12.4466 / Avg. bwd-input time: 33.4980) / Avg. batch time: 881.0893 (ms) / GPU bubble ratio: 22.02%
[rank1]:2025-12-28 00:33:27,409 - Avg. fwd time: 9.8489 / Avg. bwd-weight time: 8.2773 / Avg. bwd-input time: 12.6667 / Avg. batch time: 861.1874 (ms) / GPU bubble ratio: 42.79%
[rank1]:2025-12-28 00:33:27,463 -  step: 350  loss: -4.0000  grad_norm:  0.1871  memory: 17.87GiB(37.61%)  tps: 9,859  tflops: 77.07  mfu: 24.70%
[rank3]:2025-12-28 00:33:27,459 -  step: 350  loss: -4.0000  grad_norm:  0.1871  memory: 15.27GiB(32.13%)  tps: 9,859  tflops: 77.07  mfu: 24.70%
[rank2]:2025-12-28 00:33:27,459 -  step: 350  loss: -4.0000  grad_norm:  0.1871  memory: 13.82GiB(29.09%)  tps: 9,859  tflops: 77.07  mfu: 24.70%
[rank0]:2025-12-28 00:33:27,485 -  step: 350  loss:  0.2383  grad_norm:  0.1871  memory: 36.24GiB(76.29%)  tps: 9,859  tflops: 77.07  mfu: 24.70%
[rank0]:2025-12-28 00:36:08,410 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 00:36:12,230 - Avg. fwd time: 8.0612 / Avg. bwd-weight time: 8.0447 / Avg. bwd-input time: 10.0241 / Avg. batch time: 826.3780 (ms) / GPU bubble ratio: 49.41%
[rank2]:2025-12-28 00:36:12,280 -  step: 400  loss: -4.0000  grad_norm:  0.2560  memory: 13.82GiB(29.09%)  tps: 9,941  tflops: 77.71  mfu: 24.91%
[rank3]:2025-12-28 00:36:12,226 - Avg. fwd time: 7.7556 / Avg. bwd-weight time: 7.4111 / Avg. bwd-input time: 9.7501 / Avg. batch time: 812.7556 (ms) / GPU bubble ratio: 50.95%
[rank3]:2025-12-28 00:36:12,280 -  step: 400  loss: -4.0000  grad_norm:  0.2560  memory: 15.27GiB(32.13%)  tps: 9,941  tflops: 77.71  mfu: 24.91%
[rank0]:2025-12-28 00:36:12,234 - Avg. fwd time: 12.6671 / Avg. full-bwd time: 13.6369 (Avg. bwd-weight time: 11.4717 / Avg. bwd-input time: 33.4760) / Avg. batch time: 868.9561 (ms) / GPU bubble ratio: 22.74%
[rank1]:2025-12-28 00:36:12,232 - Avg. fwd time: 9.8457 / Avg. bwd-weight time: 8.0664 / Avg. bwd-input time: 12.6991 / Avg. batch time: 849.5011 (ms) / GPU bubble ratio: 42.35%
[rank1]:2025-12-28 00:36:12,281 -  step: 400  loss: -4.0000  grad_norm:  0.2560  memory: 17.87GiB(37.61%)  tps: 9,941  tflops: 77.71  mfu: 24.91%
[rank2]:2025-12-28 00:36:12,360 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0036_stage2_step400.svg
[rank0]:2025-12-28 00:36:12,305 -  step: 400  loss:  0.2203  grad_norm:  0.2560  memory: 36.24GiB(76.29%)  tps: 9,941  tflops: 77.71  mfu: 24.91%
[rank0]:2025-12-28 00:36:12,362 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0036_stage0_step400.svg
[rank1]:2025-12-28 00:36:12,360 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0036_stage1_step400.svg
[rank1]:2025-12-28 00:36:12,404 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0036_stage6_step400.svg
[rank2]:2025-12-28 00:36:12,406 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0036_stage5_step400.svg
[rank0]:2025-12-28 00:36:12,405 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0036_stage7_step400.svg
[rank2]:2025-12-28 00:36:12,506 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank2_stage2.svg
[rank2]:	> Counts Sum: 74280, Total Sum: 184320 (40.30%), Ratio(%) per element: [42.57, 38.67, 39.84, 41.4, 41.01, 41.4, 41.01, 42.57, 41.01, 38.28, 37.5, 39.84, 41.4, 39.06, 38.67, 40.23, 41.01, 39.84]
[rank0]:2025-12-28 00:36:12,512 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank0_stage0.svg
[rank0]:	> Counts Sum: 143800, Total Sum: 194560 (73.91%), Ratio(%) per element: [65.23, 77.34, 74.21, 78.12, 79.29, 75.78, 75.39, 79.29, 79.68, 76.17, 69.92, 71.48, 72.65, 72.65, 72.26, 70.7, 70.31, 72.65, 71.09]
[rank0]:2025-12-28 00:36:12,591 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank0_stage7.svg
[rank0]:	> Counts Sum: 82880, Total Sum: 112640 (73.58%), Ratio(%) per element: [73.43, 73.43, 72.65, 71.87, 71.48, 76.17, 73.82, 75.0, 73.43, 74.6, 73.43]
[rank1]:2025-12-28 00:36:12,529 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank1_stage1.svg
[rank1]:	> Counts Sum: 194400, Total Sum: 276480 (70.31%), Ratio(%) per element: [77.34, 73.82, 76.56, 78.12, 76.95, 73.43, 77.34, 77.34, 80.85, 70.7, 67.96, 67.96, 67.57, 71.09, 69.14, 66.01, 68.75, 69.53, 64.84, 64.84, 66.01, 65.62, 66.4, 64.45, 64.06, 66.01, 65.62]
[rank2]:2025-12-28 00:36:12,606 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank2_stage5.svg
[rank2]:	> Counts Sum: 19000, Total Sum: 184320 (10.31%), Ratio(%) per element: [10.54, 11.32, 9.76, 10.93, 11.71, 9.76, 9.76, 9.76, 10.93, 9.37, 10.15, 10.54, 10.15, 9.37, 9.37, 10.15, 10.54, 11.32]
[rank3]:2025-12-28 00:36:12,620 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0036_step400_rank3.svg
[rank3]:			> Batch Time: 783.00 ms, GPU Bubble Ratio: 29.87%, 40.22%, 46.24%, 49.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-197ms   | [S7,MB1,F]  197-14-212ms   | [S7,MB1,BI] 224-33-257ms   | [S7,MB1,BW] 257-0-257ms    | [S7,MB2,F]  257-16-274ms   | [S7,MB2,BI] 286-34-321ms   | [S7,MB2,BW] 321-0-321ms    | [S7,MB3,F]  321-17-338ms   | [S7,MB3,BI] 350-34-385ms   | [S7,MB3,BW] 385-0-385ms    | [S0,MB7,F]  385-9-395ms    | [S0,MB0,B]  395-0-395ms    | [S7,MB4,F]  403-17-420ms   | [S7,MB4,BI] 433-33-466ms   | [S7,MB4,BW] 466-0-466ms    | [S0,MB1,B]  473-0-473ms    | [S7,MB5,F]  477-17-494ms   | [S7,MB5,BI] 506-32-538ms   | [S7,MB5,BW] 539-0-539ms    | [S0,MB2,B]  546-0-546ms    | [S7,MB6,F]  560-15-575ms   | [S7,MB6,BI] 586-32-619ms   | [S7,MB6,BW] 619-0-619ms    | [S0,MB3,B]  626-0-626ms    | [S7,MB7,F]  641-14-655ms   | [S7,MB7,BI] 667-32-699ms   | [S7,MB7,BW] 699-3-703ms    | [S0,MB4,B]  707-14-721ms   | [S0,MB5,B]  733-22-755ms   | [S0,MB6,B]  758-15-774ms   | [S0,MB7,B]  783-0-783ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  83-11-94ms     | [S6,MB0,F]  94-9-104ms     | [S1,MB5,F]  104-13-117ms   | [S6,MB1,F]  117-8-125ms    | [S6,MB0,BI] 172-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 257-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  277-7-285ms    | [S6,MB2,BI] 321-9-330ms    | [S6,MB2,BW] 330-10-341ms   | [S1,MB6,F]  341-11-352ms   | [S1,MB0,BI] 352-15-368ms   | [S1,MB0,BW] 368-0-368ms    | [S6,MB4,F]  368-7-376ms    | [S6,MB3,BI] 385-12-397ms   | [S6,MB3,BW] 397-11-409ms   | [S1,MB7,F]  409-11-420ms   | [S1,MB1,BI] 420-16-437ms   | [S1,MB1,BW] 437-0-437ms    | [S6,MB5,F]  438-8-446ms    | [S6,MB4,BI] 466-12-478ms   | [S6,MB4,BW] 478-10-489ms   | [S1,MB2,BI] 489-14-504ms   | [S1,MB2,BW] 504-7-512ms    | [S6,MB6,F]  545-7-553ms    | [S6,MB5,BI] 553-10-563ms   | [S6,MB5,BW] 563-10-574ms   | [S1,MB3,BI] 574-15-589ms   | [S1,MB3,BW] 589-12-601ms   | [S6,MB7,F]  626-7-633ms    | [S6,MB6,BI] 633-10-644ms   | [S6,MB6,BW] 644-10-655ms   | [S1,MB4,BI] 655-15-670ms   | [S6,MB7,BI] 699-10-710ms   | [S1,MB5,BI] 710-15-725ms   | [S1,MB4,BW] 725-6-731ms    | [S1,MB6,BI] 736-14-751ms   | [S1,MB5,BW] 751-1-753ms    | [S1,MB7,BI] 761-14-775ms   | [S1,MB6,BW] 776-0-776ms    | [S6,MB7,BW] 776-0-776ms    | [S1,MB7,BW] 776-0-776ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-103ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-201ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-304ms   | [S2,MB0,BW] 305-9-314ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 330-10-341ms   | [S5,MB2,BW] 341-10-351ms   | [S2,MB6,F]  353-10-364ms   | [S2,MB1,BI] 365-11-376ms   | [S2,MB1,BW] 376-10-386ms   | [S5,MB5,F]  386-7-394ms    | [S5,MB3,BI] 401-11-412ms   | [S5,MB3,BW] 412-11-423ms   | [S2,MB7,F]  423-10-433ms   | [S2,MB2,BI] 435-11-446ms   | [S2,MB2,BW] 446-10-456ms   | [S5,MB6,F]  456-8-464ms    | [S5,MB4,BI] 479-11-490ms   | [S5,MB4,BW] 490-10-500ms   | [S2,MB3,BI] 549-9-558ms    | [S2,MB3,BW] 558-10-569ms   | [S5,MB7,F]  573-7-580ms    | [S5,MB5,BI] 580-9-590ms    | [S5,MB5,BW] 590-9-600ms    | [S2,MB4,BI] 629-9-638ms    | [S5,MB6,BI] 644-10-654ms   | [S2,MB5,BI] 654-10-664ms   | [S5,MB7,BI] 711-9-720ms    | [S2,MB6,BI] 720-10-730ms   | [S2,MB4,BW] 730-8-738ms    | [S2,MB7,BI] 745-9-754ms    | [S2,MB5,BW] 755-0-755ms    | [S5,MB6,BW] 755-10-765ms   | [S5,MB7,BW] 765-6-771ms    | [S2,MB6,BW] 771-0-771ms    | [S2,MB7,BW] 771-0-771ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-102ms     | [S4,MB3,F]  102-8-110ms    | [S4,MB0,BI] 191-9-200ms    | [S4,MB0,BW] 200-9-209ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-225ms    | [S3,MB0,BW] 225-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 276-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 358-11-369ms   | [S4,MB2,BW] 369-9-379ms    | [S3,MB6,F]  379-7-386ms    | [S3,MB2,BI] 386-9-396ms    | [S3,MB2,BW] 396-9-406ms    | [S4,MB6,F]  406-7-414ms    | [S4,MB3,BI] 427-12-440ms   | [S4,MB3,BW] 440-9-449ms    | [S3,MB7,F]  449-7-457ms    | [S3,MB3,BI] 457-9-467ms    | [S3,MB3,BW] 467-10-477ms   | [S4,MB7,F]  477-8-485ms    | [S4,MB4,BI] 542-10-552ms   | [S4,MB4,BW] 552-9-562ms    | [S3,MB4,BI] 562-10-572ms   | [S4,MB5,BI] 622-10-632ms   | [S3,MB5,BI] 632-9-641ms    | [S4,MB6,BI] 655-9-664ms    | [S3,MB6,BI] 664-9-673ms    | [S4,MB7,BI] 720-9-729ms    | [S3,MB7,BI] 729-9-738ms    | [S3,MB4,BW] 738-0-738ms    | [S4,MB5,BW] 738-10-748ms   | [S4,MB6,BW] 749-9-758ms    | [S4,MB7,BW] 758-5-763ms    | [S3,MB5,BW] 764-0-764ms    | [S3,MB6,BW] 764-0-764ms    | [S3,MB7,BW] 764-0-764ms   
[rank3]:2025-12-28 00:36:12,665 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0036_stage3_step400.svg
[rank1]:2025-12-28 00:36:12,627 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank1_stage6.svg
[rank1]:	> Counts Sum: 30960, Total Sum: 184320 (16.80%), Ratio(%) per element: [17.18, 16.01, 17.57, 17.57, 16.79, 17.57, 17.18, 16.79, 16.4, 16.79, 16.4, 16.4, 16.79, 16.79, 16.79, 15.62, 16.4, 17.18]
[rank3]:2025-12-28 00:36:12,709 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0036_stage4_step400.svg
[rank3]:2025-12-28 00:36:12,807 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank3_stage3.svg
[rank3]:	> Counts Sum: 89280, Total Sum: 184320 (48.44%), Ratio(%) per element: [48.43, 50.39, 49.21, 48.43, 46.09, 47.26, 48.43, 49.21, 46.48, 48.43, 46.87, 48.43, 49.21, 50.39, 48.43, 47.65, 49.21, 49.21]
[rank3]:2025-12-28 00:36:12,908 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0036_rank3_stage4.svg
[rank3]:	> Counts Sum: 19000, Total Sum: 184320 (10.31%), Ratio(%) per element: [10.93, 10.54, 10.93, 10.15, 11.71, 11.71, 10.15, 12.5, 11.71, 8.2, 8.98, 9.37, 10.54, 9.76, 9.76, 9.37, 9.76, 9.37]
[rank2]:2025-12-28 00:36:13,040 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage2.svg
[rank0]:2025-12-28 00:36:13,040 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage0.svg
[rank1]:2025-12-28 00:36:13,041 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage1.svg
[rank3]:2025-12-28 00:36:13,342 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage3.svg
[rank2]:2025-12-28 00:36:13,482 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage5.svg
[rank0]:2025-12-28 00:36:13,498 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage7.svg
[rank1]:2025-12-28 00:36:13,456 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage6.svg
[rank3]:2025-12-28 00:36:13,769 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0036_stage4.svg
[rank0]:2025-12-28 00:36:32,336 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-28 00:36:32,796 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 00:36:32,800 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 00:36:32,808 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 00:38:55,231 - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-12-28 00:38:58,922 - Avg. fwd time: 7.7591 / Avg. bwd-weight time: 7.3752 / Avg. bwd-input time: 9.7646 / Avg. batch time: 804.3684 (ms) / GPU bubble ratio: 50.47%
[rank0]:2025-12-28 00:38:58,934 - Avg. fwd time: 12.6426 / Avg. full-bwd time: 12.9778 (Avg. bwd-weight time: 10.7720 / Avg. bwd-input time: 33.4515) / Avg. batch time: 859.8750 (ms) / GPU bubble ratio: 23.26%
[rank0]:2025-12-28 00:38:59,006 -  step: 450  loss:  0.2305  grad_norm:  0.1827  memory: 36.24GiB(76.29%)  tps: 9,828  tflops: 76.83  mfu: 24.63%
[rank1]:2025-12-28 00:38:58,930 - Avg. fwd time: 9.8405 / Avg. bwd-weight time: 7.8983 / Avg. bwd-input time: 12.7191 / Avg. batch time: 840.6362 (ms) / GPU bubble ratio: 42.03%
[rank1]:2025-12-28 00:38:58,981 -  step: 450  loss: -4.0000  grad_norm:  0.1827  memory: 17.89GiB(37.65%)  tps: 9,828  tflops: 76.83  mfu: 24.63%
[rank2]:2025-12-28 00:38:58,929 - Avg. fwd time: 8.0693 / Avg. bwd-weight time: 8.0199 / Avg. bwd-input time: 10.0394 / Avg. batch time: 818.1285 (ms) / GPU bubble ratio: 48.90%
[rank2]:2025-12-28 00:38:58,980 -  step: 450  loss: -4.0000  grad_norm:  0.1827  memory: 13.82GiB(29.09%)  tps: 9,828  tflops: 76.83  mfu: 24.63%
[rank3]:2025-12-28 00:38:58,980 -  step: 450  loss: -4.0000  grad_norm:  0.1827  memory: 15.27GiB(32.13%)  tps: 9,828  tflops: 76.83  mfu: 24.63%
[rank0]:2025-12-28 00:41:41,203 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 00:41:44,926 - Avg. fwd time: 8.0755 / Avg. bwd-weight time: 8.0079 / Avg. bwd-input time: 10.0507 / Avg. batch time: 811.6922 (ms) / GPU bubble ratio: 48.48%
[rank1]:2025-12-28 00:41:44,927 - Avg. fwd time: 9.8366 / Avg. bwd-weight time: 7.7793 / Avg. bwd-input time: 12.7349 / Avg. batch time: 833.5618 (ms) / GPU bubble ratio: 41.74%
[rank3]:2025-12-28 00:41:44,922 - Avg. fwd time: 7.7623 / Avg. bwd-weight time: 7.3393 / Avg. bwd-input time: 9.7752 / Avg. batch time: 797.6813 (ms) / GPU bubble ratio: 50.10%
[rank0]:2025-12-28 00:41:44,928 - Avg. fwd time: 12.6267 / Avg. full-bwd time: 12.4757 (Avg. bwd-weight time: 10.2703 / Avg. bwd-input time: 33.4330) / Avg. batch time: 852.8503 (ms) / GPU bubble ratio: 23.61%
[rank0]:2025-12-28 00:41:44,998 -  step: 500  loss:  0.2299  grad_norm:  1.7939  memory: 36.24GiB(76.29%)  tps: 9,870  tflops: 77.16  mfu: 24.73%
[rank2]:2025-12-28 00:41:44,973 -  step: 500  loss: -4.0000  grad_norm:  1.7939  memory: 13.82GiB(29.09%)  tps: 9,870  tflops: 77.16  mfu: 24.73%
[rank1]:2025-12-28 00:41:44,975 -  step: 500  loss: -4.0000  grad_norm:  1.7939  memory: 17.89GiB(37.65%)  tps: 9,870  tflops: 77.16  mfu: 24.73%
[rank3]:2025-12-28 00:41:44,973 -  step: 500  loss: -4.0000  grad_norm:  1.7939  memory: 15.27GiB(32.13%)  tps: 9,870  tflops: 77.16  mfu: 24.73%
[rank0]:2025-12-28 00:41:45,063 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0041_stage0_step500.svg
[rank0]:2025-12-28 00:41:45,104 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0041_stage7_step500.svg
[rank2]:2025-12-28 00:41:45,063 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0041_stage2_step500.svg
[rank2]:2025-12-28 00:41:45,106 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0041_stage5_step500.svg
[rank1]:2025-12-28 00:41:45,063 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0041_stage1_step500.svg
[rank1]:2025-12-28 00:41:45,104 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0041_stage6_step500.svg
[rank0]:2025-12-28 00:41:45,205 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank0_stage0.svg
[rank0]:	> Counts Sum: 192600, Total Sum: 255360 (75.42%), Ratio(%) per element: [65.17, 79.76, 76.78, 79.76, 80.05, 76.78, 76.48, 80.35, 80.95, 77.08, 72.32, 73.51, 74.7, 73.8, 74.1, 72.61, 72.02, 74.4, 72.32]
[rank2]:2025-12-28 00:41:45,208 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank2_stage2.svg
[rank2]:	> Counts Sum: 97480, Total Sum: 241920 (40.29%), Ratio(%) per element: [41.96, 38.98, 39.88, 40.77, 41.36, 40.77, 40.77, 42.85, 40.77, 38.39, 38.09, 39.28, 40.77, 40.17, 38.98, 40.77, 41.07, 39.58]
[rank1]:2025-12-28 00:41:45,226 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank1_stage1.svg
[rank1]:	> Counts Sum: 260000, Total Sum: 362880 (71.65%), Ratio(%) per element: [79.76, 77.08, 79.16, 80.65, 79.76, 76.19, 79.76, 80.05, 81.84, 72.02, 70.23, 68.45, 69.34, 71.13, 70.53, 68.75, 70.23, 69.34, 64.88, 65.77, 65.77, 66.07, 65.17, 65.47, 63.98, 67.26, 65.77]
[rank0]:2025-12-28 00:41:45,284 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank0_stage7.svg
[rank0]:	> Counts Sum: 111280, Total Sum: 147840 (75.27%), Ratio(%) per element: [75.0, 75.0, 75.0, 73.21, 73.21, 77.97, 75.89, 76.19, 75.59, 76.19, 74.7]
[rank2]:2025-12-28 00:41:45,309 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank2_stage5.svg
[rank2]:	> Counts Sum: 21800, Total Sum: 241920 (9.01%), Ratio(%) per element: [9.52, 9.52, 8.63, 9.82, 9.82, 8.63, 8.92, 8.92, 10.11, 8.33, 7.73, 9.52, 9.22, 8.03, 8.33, 8.33, 8.92, 9.82]
[rank1]:2025-12-28 00:41:45,323 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank1_stage6.svg
[rank1]:	> Counts Sum: 38160, Total Sum: 241920 (15.77%), Ratio(%) per element: [16.07, 15.17, 16.36, 16.36, 15.77, 16.36, 16.07, 15.77, 15.47, 15.77, 15.47, 15.47, 15.77, 15.77, 15.77, 14.88, 15.47, 16.07]
[rank3]:2025-12-28 00:41:45,319 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0041_step500_rank3.svg
[rank3]:			> Batch Time: 781.00 ms, GPU Bubble Ratio: 29.27%, 39.63%, 46.28%, 49.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  196-14-211ms   | [S7,MB1,BI] 223-33-257ms   | [S7,MB1,BW] 257-0-257ms    | [S7,MB2,F]  257-16-273ms   | [S7,MB2,BI] 286-34-321ms   | [S7,MB2,BW] 321-0-321ms    | [S7,MB3,F]  321-17-338ms   | [S7,MB3,BI] 349-34-384ms   | [S7,MB3,BW] 384-0-384ms    | [S0,MB7,F]  384-9-394ms    | [S0,MB0,B]  394-0-394ms    | [S7,MB4,F]  402-17-419ms   | [S7,MB4,BI] 431-33-464ms   | [S7,MB4,BW] 464-0-464ms    | [S0,MB1,B]  471-0-471ms    | [S7,MB5,F]  475-16-491ms   | [S7,MB5,BI] 503-32-536ms   | [S7,MB5,BW] 536-0-536ms    | [S0,MB2,B]  543-0-543ms    | [S7,MB6,F]  557-14-571ms   | [S7,MB6,BI] 583-32-615ms   | [S7,MB6,BW] 615-0-615ms    | [S0,MB3,B]  622-0-622ms    | [S7,MB7,F]  636-14-650ms   | [S7,MB7,BI] 663-32-696ms   | [S7,MB7,BW] 696-3-699ms    | [S0,MB4,B]  705-19-724ms   | [S0,MB5,B]  731-21-752ms   | [S0,MB6,B]  756-19-776ms   | [S0,MB7,B]  781-0-781ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-180ms    | [S6,MB0,BW] 180-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 257-9-266ms    | [S6,MB1,BW] 266-10-277ms   | [S6,MB3,F]  277-7-284ms    | [S6,MB2,BI] 320-9-330ms    | [S6,MB2,BW] 330-10-341ms   | [S1,MB6,F]  341-11-352ms   | [S1,MB0,BI] 352-15-368ms   | [S1,MB0,BW] 368-0-368ms    | [S6,MB4,F]  368-7-376ms    | [S6,MB3,BI] 384-12-396ms   | [S6,MB3,BW] 396-11-408ms   | [S1,MB7,F]  408-11-419ms   | [S1,MB1,BI] 419-16-436ms   | [S1,MB1,BW] 436-2-439ms    | [S6,MB5,F]  438-8-447ms    | [S6,MB4,BI] 464-12-477ms   | [S6,MB4,BW] 476-10-487ms   | [S1,MB2,BI] 487-14-502ms   | [S1,MB2,BW] 502-10-512ms   | [S6,MB6,F]  543-7-550ms    | [S6,MB5,BI] 550-10-561ms   | [S6,MB5,BW] 560-10-571ms   | [S1,MB3,BI] 571-14-586ms   | [S1,MB3,BW] 586-10-596ms   | [S6,MB7,F]  622-7-629ms    | [S6,MB6,BI] 629-10-640ms   | [S6,MB6,BW] 640-10-651ms   | [S1,MB4,BI] 651-14-666ms   | [S6,MB7,BI] 696-10-707ms   | [S1,MB5,BI] 709-15-724ms   | [S1,MB4,BW] 724-5-729ms    | [S1,MB6,BI] 734-14-749ms   | [S1,MB5,BW] 749-3-753ms    | [S1,MB7,BI] 759-14-774ms   | [S1,MB6,BW] 774-0-774ms    | [S6,MB7,BW] 774-0-774ms    | [S1,MB7,BW] 774-0-774ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 180-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 266-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  286-7-294ms    | [S2,MB0,BI] 294-10-304ms   | [S2,MB0,BW] 304-9-314ms    | [S5,MB4,F]  313-7-321ms    | [S5,MB2,BI] 330-10-341ms   | [S5,MB2,BW] 341-10-351ms   | [S2,MB6,F]  353-10-363ms   | [S2,MB1,BI] 364-11-376ms   | [S2,MB1,BW] 376-10-386ms   | [S5,MB5,F]  386-7-394ms    | [S5,MB3,BI] 399-11-411ms   | [S5,MB3,BW] 410-11-422ms   | [S2,MB7,F]  422-10-432ms   | [S2,MB2,BI] 433-11-445ms   | [S2,MB2,BW] 445-10-456ms   | [S5,MB6,F]  455-8-463ms    | [S5,MB4,BI] 477-10-488ms   | [S5,MB4,BW] 487-9-497ms    | [S2,MB3,BI] 546-9-555ms    | [S2,MB3,BW] 555-10-566ms   | [S5,MB7,F]  570-7-577ms    | [S5,MB5,BI] 577-9-587ms    | [S5,MB5,BW] 587-9-597ms    | [S2,MB4,BI] 625-9-634ms    | [S5,MB6,BI] 639-10-650ms   | [S2,MB5,BI] 650-10-660ms   | [S5,MB7,BI] 708-9-718ms    | [S2,MB6,BI] 718-10-728ms   | [S2,MB4,BW] 728-7-736ms    | [S2,MB7,BI] 743-9-752ms    | [S2,MB5,BW] 752-0-752ms    | [S5,MB6,BW] 752-10-763ms   | [S5,MB7,BW] 763-5-769ms    | [S2,MB6,BW] 769-0-769ms    | [S2,MB7,BW] 769-0-769ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-9-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 276-10-287ms   | [S4,MB1,BW] 286-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-314ms    | [S3,MB1,BW] 314-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 357-11-369ms   | [S4,MB2,BW] 369-9-379ms    | [S3,MB6,F]  379-7-386ms    | [S3,MB2,BI] 386-9-396ms    | [S3,MB2,BW] 396-9-406ms    | [S4,MB6,F]  406-7-414ms    | [S4,MB3,BI] 426-12-439ms   | [S4,MB3,BW] 439-9-448ms    | [S3,MB7,F]  448-7-456ms    | [S3,MB3,BI] 455-9-465ms    | [S3,MB3,BW] 465-10-476ms   | [S4,MB7,F]  475-8-484ms    | [S4,MB4,BI] 539-10-550ms   | [S4,MB4,BW] 549-9-559ms    | [S3,MB4,BI] 559-10-569ms   | [S4,MB5,BI] 618-9-628ms    | [S3,MB5,BI] 628-9-638ms    | [S4,MB6,BI] 650-9-660ms    | [S3,MB6,BI] 660-9-669ms    | [S4,MB7,BI] 718-9-728ms    | [S3,MB7,BI] 727-9-737ms    | [S3,MB4,BW] 736-0-736ms    | [S4,MB5,BW] 736-10-747ms   | [S4,MB6,BW] 746-9-756ms    | [S4,MB7,BW] 756-5-761ms    | [S3,MB5,BW] 761-0-761ms    | [S3,MB6,BW] 761-0-761ms    | [S3,MB7,BW] 761-0-761ms   
[rank3]:2025-12-28 00:41:45,361 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0041_stage3_step500.svg
[rank3]:2025-12-28 00:41:45,401 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0041_stage4_step500.svg
[rank3]:2025-12-28 00:41:45,499 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank3_stage3.svg
[rank3]:	> Counts Sum: 118080, Total Sum: 241920 (48.81%), Ratio(%) per element: [48.8, 50.29, 49.4, 48.8, 47.02, 47.91, 48.8, 49.4, 47.32, 48.8, 47.61, 48.8, 49.4, 50.29, 48.8, 48.21, 49.4, 49.4]
[rank3]:2025-12-28 00:41:45,599 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0041_rank3_stage4.svg
[rank3]:	> Counts Sum: 21800, Total Sum: 241920 (9.01%), Ratio(%) per element: [9.82, 8.92, 9.82, 8.92, 10.41, 10.41, 9.22, 11.3, 9.22, 6.54, 8.63, 8.33, 9.22, 8.33, 8.63, 7.44, 8.92, 8.03]
[rank0]:2025-12-28 00:41:45,867 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage0.svg
[rank2]:2025-12-28 00:41:45,879 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage2.svg
[rank1]:2025-12-28 00:41:45,866 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage1.svg
[rank3]:2025-12-28 00:41:46,161 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage3.svg
[rank2]:2025-12-28 00:41:46,418 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage5.svg
[rank1]:2025-12-28 00:41:46,391 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage6.svg
[rank0]:2025-12-28 00:41:46,446 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage7.svg
[rank3]:2025-12-28 00:41:46,687 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0041_stage4.svg
[rank0]:2025-12-28 00:44:27,495 - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-12-28 00:44:31,241 - Avg. fwd time: 7.7655 / Avg. bwd-weight time: 7.3137 / Avg. bwd-input time: 9.7843 / Avg. batch time: 792.0638 (ms) / GPU bubble ratio: 49.77%
[rank3]:2025-12-28 00:44:31,293 -  step: 550  loss: -4.0000  grad_norm:  0.2358  memory: 15.27GiB(32.13%)  tps: 9,851  tflops: 77.01  mfu: 24.68%
[rank2]:2025-12-28 00:44:31,244 - Avg. fwd time: 8.0813 / Avg. bwd-weight time: 7.9968 / Avg. bwd-input time: 10.0602 / Avg. batch time: 806.2258 (ms) / GPU bubble ratio: 48.13%
[rank2]:2025-12-28 00:44:31,293 -  step: 550  loss: -4.0000  grad_norm:  0.2358  memory: 13.82GiB(29.09%)  tps: 9,851  tflops: 77.01  mfu: 24.68%
[rank0]:2025-12-28 00:44:31,248 - Avg. fwd time: 12.6080 / Avg. full-bwd time: 11.9364 (Avg. bwd-weight time: 9.7573 / Avg. bwd-input time: 33.4157) / Avg. batch time: 846.6256 (ms) / GPU bubble ratio: 24.10%
[rank0]:2025-12-28 00:44:31,317 -  step: 550  loss:  0.2306  grad_norm:  0.2358  memory: 36.24GiB(76.29%)  tps: 9,851  tflops: 77.01  mfu: 24.68%
[rank1]:2025-12-28 00:44:31,247 - Avg. fwd time: 9.8343 / Avg. bwd-weight time: 7.6780 / Avg. bwd-input time: 12.7488 / Avg. batch time: 827.6585 (ms) / GPU bubble ratio: 41.50%
[rank1]:2025-12-28 00:44:31,295 -  step: 550  loss: -4.0000  grad_norm:  0.2358  memory: 17.89GiB(37.65%)  tps: 9,851  tflops: 77.01  mfu: 24.68%
[rank0]:2025-12-28 00:47:13,395 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 00:47:17,221 - Avg. fwd time: 7.7680 / Avg. bwd-weight time: 7.2856 / Avg. bwd-input time: 9.7908 / Avg. batch time: 787.7217 (ms) / GPU bubble ratio: 49.54%
[rank0]:2025-12-28 00:47:17,227 - Avg. fwd time: 12.5964 / Avg. full-bwd time: 11.5237 (Avg. bwd-weight time: 9.4176 / Avg. bwd-input time: 33.4019) / Avg. batch time: 841.9011 (ms) / GPU bubble ratio: 24.42%
[rank1]:2025-12-28 00:47:17,226 - Avg. fwd time: 9.8329 / Avg. bwd-weight time: 7.5921 / Avg. bwd-input time: 12.7576 / Avg. batch time: 823.0921 (ms) / GPU bubble ratio: 41.33%
[rank2]:2025-12-28 00:47:17,225 - Avg. fwd time: 8.0861 / Avg. bwd-weight time: 7.9897 / Avg. bwd-input time: 10.0669 / Avg. batch time: 802.0754 (ms) / GPU bubble ratio: 47.85%
[rank3]:2025-12-28 00:47:17,272 -  step: 600  loss: -4.0000  grad_norm:  0.4488  memory: 15.27GiB(32.13%)  tps: 9,871  tflops: 77.17  mfu: 24.73%
[rank1]:2025-12-28 00:47:17,275 -  step: 600  loss: -4.0000  grad_norm:  0.4488  memory: 17.89GiB(37.65%)  tps: 9,871  tflops: 77.17  mfu: 24.73%
[rank0]:2025-12-28 00:47:17,297 -  step: 600  loss:  0.2248  grad_norm:  0.4488  memory: 36.24GiB(76.29%)  tps: 9,871  tflops: 77.17  mfu: 24.73%
[rank1]:2025-12-28 00:47:17,350 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0047_stage1_step600.svg
[rank0]:2025-12-28 00:47:17,350 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0047_stage0_step600.svg
[rank2]:2025-12-28 00:47:17,272 -  step: 600  loss: -4.0000  grad_norm:  0.4488  memory: 13.82GiB(29.09%)  tps: 9,871  tflops: 77.17  mfu: 24.73%
[rank2]:2025-12-28 00:47:17,349 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0047_stage2_step600.svg
[rank0]:2025-12-28 00:47:17,391 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0047_stage7_step600.svg
[rank1]:2025-12-28 00:47:17,391 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0047_stage6_step600.svg
[rank2]:2025-12-28 00:47:17,391 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0047_stage5_step600.svg
[rank0]:2025-12-28 00:47:17,493 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank0_stage0.svg
[rank1]:2025-12-28 00:47:17,515 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank1_stage1.svg
[rank0]:	> Counts Sum: 241400, Total Sum: 316160 (76.35%), Ratio(%) per element: [67.06, 80.76, 77.88, 81.49, 80.28, 79.8, 78.12, 81.97, 81.0, 78.6, 73.31, 72.83, 75.0, 73.79, 75.0, 73.07, 72.35, 75.48, 72.83]
[rank1]:	> Counts Sum: 325600, Total Sum: 449280 (72.47%), Ratio(%) per element: [79.8, 79.08, 80.28, 81.97, 79.56, 76.92, 79.8, 80.76, 82.93, 72.35, 70.91, 69.23, 70.19, 72.11, 70.91, 70.19, 70.19, 71.15, 65.86, 65.62, 66.82, 67.06, 65.62, 66.82, 65.62, 67.78, 67.06]
[rank2]:2025-12-28 00:47:17,489 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank2_stage2.svg
[rank2]:	> Counts Sum: 120680, Total Sum: 299520 (40.29%), Ratio(%) per element: [41.58, 39.9, 40.14, 40.14, 41.34, 40.62, 40.62, 42.3, 40.38, 38.7, 38.7, 39.66, 40.38, 40.38, 39.18, 40.62, 40.62, 39.9]
[rank3]:2025-12-28 00:47:17,609 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0047_step600_rank3.svg
[rank3]:			> Batch Time: 787.00 ms, GPU Bubble Ratio: 26.77%, 40.42%, 46.70%, 49.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-197ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 258-0-258ms    | [S7,MB2,F]  258-17-275ms   | [S7,MB2,BI] 288-34-322ms   | [S7,MB2,BW] 321-0-321ms    | [S7,MB3,F]  321-17-339ms   | [S7,MB3,BI] 352-34-387ms   | [S7,MB3,BW] 386-0-386ms    | [S0,MB7,F]  386-9-396ms    | [S0,MB0,B]  397-0-397ms    | [S7,MB4,F]  404-17-422ms   | [S7,MB4,BI] 433-33-466ms   | [S7,MB4,BW] 466-0-466ms    | [S0,MB1,B]  473-0-473ms    | [S7,MB5,F]  477-16-493ms   | [S7,MB5,BI] 505-32-538ms   | [S7,MB5,BW] 538-0-538ms    | [S0,MB2,B]  545-0-545ms    | [S7,MB6,F]  559-14-573ms   | [S7,MB6,BI] 586-32-619ms   | [S7,MB6,BW] 619-0-619ms    | [S0,MB3,B]  626-0-626ms    | [S7,MB7,F]  640-14-655ms   | [S7,MB7,BI] 666-32-699ms   | [S7,MB7,BW] 699-25-724ms   | [S0,MB4,B]  723-13-737ms   | [S0,MB5,B]  739-22-761ms   | [S0,MB6,B]  761-23-785ms   | [S0,MB7,B]  787-0-787ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  83-11-94ms     | [S6,MB0,F]  94-9-103ms     | [S1,MB5,F]  103-13-116ms   | [S6,MB1,F]  117-8-125ms    | [S6,MB0,BI] 172-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  278-7-285ms    | [S6,MB2,BI] 322-9-331ms    | [S6,MB2,BW] 331-10-342ms   | [S1,MB6,F]  342-11-353ms   | [S1,MB0,BI] 353-15-369ms   | [S1,MB0,BW] 369-0-369ms    | [S6,MB4,F]  369-7-377ms    | [S6,MB3,BI] 386-12-398ms   | [S6,MB3,BW] 398-11-410ms   | [S1,MB7,F]  410-11-421ms   | [S1,MB1,BI] 421-16-438ms   | [S1,MB1,BW] 438-0-439ms    | [S6,MB5,F]  439-8-448ms    | [S6,MB4,BI] 466-12-478ms   | [S6,MB4,BW] 478-10-489ms   | [S1,MB2,BI] 489-14-504ms   | [S1,MB2,BW] 504-10-514ms   | [S6,MB6,F]  544-7-552ms    | [S6,MB5,BI] 552-10-562ms   | [S6,MB5,BW] 562-10-572ms   | [S1,MB3,BI] 572-14-587ms   | [S1,MB3,BW] 588-10-598ms   | [S6,MB7,F]  625-7-633ms    | [S6,MB6,BI] 633-10-643ms   | [S6,MB6,BW] 643-10-654ms   | [S1,MB4,BI] 654-14-669ms   | [S6,MB7,BI] 699-10-710ms   | [S1,MB5,BI] 710-15-725ms   | [S1,MB4,BW] 726-4-730ms    | [S1,MB6,BI] 737-14-752ms   | [S1,MB5,BW] 752-4-756ms    | [S1,MB7,BI] 762-14-776ms   | [S1,MB6,BW] 777-0-777ms    | [S6,MB7,BW] 777-0-777ms    | [S1,MB7,BW] 777-0-777ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-103ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-277ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-295ms    | [S2,MB0,BI] 295-10-305ms   | [S2,MB0,BW] 305-9-315ms    | [S5,MB4,F]  315-7-322ms    | [S5,MB2,BI] 331-10-342ms   | [S5,MB2,BW] 342-10-352ms   | [S2,MB6,F]  354-10-364ms   | [S2,MB1,BI] 366-11-377ms   | [S2,MB1,BW] 377-9-387ms    | [S5,MB5,F]  387-7-394ms    | [S5,MB3,BI] 402-11-413ms   | [S5,MB3,BW] 412-10-423ms   | [S2,MB7,F]  423-10-433ms   | [S2,MB2,BI] 435-11-446ms   | [S2,MB2,BW] 446-10-456ms   | [S5,MB6,F]  456-8-464ms    | [S5,MB4,BI] 479-10-490ms   | [S5,MB4,BW] 490-9-500ms    | [S2,MB3,BI] 548-9-557ms    | [S2,MB3,BW] 557-10-568ms   | [S5,MB7,F]  572-7-579ms    | [S5,MB5,BI] 579-9-589ms    | [S5,MB5,BW] 589-9-598ms    | [S2,MB4,BI] 629-9-638ms    | [S5,MB6,BI] 643-10-653ms   | [S2,MB5,BI] 654-10-664ms   | [S5,MB7,BI] 712-9-721ms    | [S2,MB6,BI] 721-10-731ms   | [S2,MB4,BW] 731-8-739ms    | [S2,MB7,BI] 746-9-756ms    | [S2,MB5,BW] 756-0-756ms    | [S5,MB6,BW] 756-10-766ms   | [S5,MB7,BW] 766-6-772ms    | [S2,MB6,BW] 772-0-772ms    | [S2,MB7,BW] 772-0-772ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-7-215ms    | [S3,MB0,BI] 215-9-225ms    | [S3,MB0,BW] 225-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-298ms   | [S3,MB5,F]  298-8-306ms    | [S3,MB1,BI] 306-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  325-7-332ms    | [S4,MB2,BI] 359-11-370ms   | [S4,MB2,BW] 370-9-380ms    | [S3,MB6,F]  380-7-387ms    | [S3,MB2,BI] 387-9-397ms    | [S3,MB2,BW] 397-9-407ms    | [S4,MB6,F]  406-7-414ms    | [S4,MB3,BI] 428-12-440ms   | [S4,MB3,BW] 440-9-450ms    | [S3,MB7,F]  450-7-457ms    | [S3,MB3,BI] 457-9-467ms    | [S3,MB3,BW] 467-10-477ms   | [S4,MB7,F]  477-8-485ms    | [S4,MB4,BI] 541-10-551ms   | [S4,MB4,BW] 551-9-561ms    | [S3,MB4,BI] 561-10-571ms   | [S4,MB5,BI] 622-9-632ms    | [S3,MB5,BI] 632-9-641ms    | [S4,MB6,BI] 654-9-663ms    | [S3,MB6,BI] 663-9-672ms    | [S4,MB7,BI] 721-9-730ms    | [S3,MB7,BI] 730-9-739ms    | [S3,MB4,BW] 739-0-739ms    | [S4,MB5,BW] 739-10-749ms   | [S4,MB6,BW] 750-9-759ms    | [S4,MB7,BW] 759-5-764ms    | [S3,MB5,BW] 764-0-764ms    | [S3,MB6,BW] 764-0-764ms    | [S3,MB7,BW] 764-0-764ms   
[rank0]:2025-12-28 00:47:17,573 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank0_stage7.svg
[rank1]:2025-12-28 00:47:17,613 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank1_stage6.svg
[rank0]:	> Counts Sum: 139680, Total Sum: 183040 (76.31%), Ratio(%) per element: [75.72, 76.44, 75.96, 75.48, 75.24, 78.6, 76.68, 76.44, 76.44, 76.68, 75.72]
[rank1]:	> Counts Sum: 45360, Total Sum: 299520 (15.14%), Ratio(%) per element: [15.38, 14.66, 15.62, 15.62, 15.14, 15.62, 15.38, 15.14, 14.9, 15.14, 14.9, 14.9, 15.14, 15.14, 15.14, 14.42, 14.9, 15.38]
[rank2]:2025-12-28 00:47:17,588 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank2_stage5.svg
[rank2]:	> Counts Sum: 24600, Total Sum: 299520 (8.21%), Ratio(%) per element: [8.17, 8.41, 8.41, 9.37, 9.61, 7.93, 7.93, 8.65, 10.09, 7.21, 6.49, 8.41, 8.65, 7.21, 7.21, 7.21, 7.93, 8.89]
[rank3]:2025-12-28 00:47:17,651 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0047_stage3_step600.svg
[rank3]:2025-12-28 00:47:17,695 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0047_stage4_step600.svg
[rank3]:2025-12-28 00:47:17,796 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank3_stage3.svg
[rank3]:	> Counts Sum: 146880, Total Sum: 299520 (49.04%), Ratio(%) per element: [49.03, 50.24, 49.51, 49.03, 47.59, 48.31, 49.03, 49.51, 47.83, 49.03, 48.07, 49.03, 49.51, 50.24, 49.03, 48.55, 49.51, 49.51]
[rank3]:2025-12-28 00:47:17,893 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0047_rank3_stage4.svg
[rank3]:	> Counts Sum: 24600, Total Sum: 299520 (8.21%), Ratio(%) per element: [9.37, 8.17, 8.65, 8.41, 9.61, 8.89, 8.89, 9.37, 7.93, 6.0, 7.93, 8.41, 8.65, 7.45, 7.69, 7.69, 7.21, 7.45]
[rank0]:2025-12-28 00:47:18,289 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage0.svg
[rank1]:2025-12-28 00:47:18,279 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage1.svg
[rank2]:2025-12-28 00:47:18,285 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage2.svg
[rank3]:2025-12-28 00:47:18,607 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage3.svg
[rank1]:2025-12-28 00:47:18,954 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage6.svg
[rank0]:2025-12-28 00:47:19,031 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage7.svg
[rank2]:2025-12-28 00:47:18,976 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage5.svg
[rank3]:2025-12-28 00:47:19,280 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0047_stage4.svg
[rank0]:2025-12-28 00:50:00,869 - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-12-28 00:50:04,538 - Avg. fwd time: 7.7700 / Avg. bwd-weight time: 7.2662 / Avg. bwd-input time: 9.7966 / Avg. batch time: 784.0217 (ms) / GPU bubble ratio: 49.32%
[rank0]:2025-12-28 00:50:04,546 - Avg. fwd time: 12.5832 / Avg. full-bwd time: 11.1172 (Avg. bwd-weight time: 9.0902 / Avg. bwd-input time: 33.3917) / Avg. batch time: 837.7613 (ms) / GPU bubble ratio: 24.78%
[rank1]:2025-12-28 00:50:04,545 - Avg. fwd time: 9.8307 / Avg. bwd-weight time: 7.5153 / Avg. bwd-input time: 12.7638 / Avg. batch time: 819.2091 (ms) / GPU bubble ratio: 41.19%
[rank2]:2025-12-28 00:50:04,543 - Avg. fwd time: 8.0903 / Avg. bwd-weight time: 7.9827 / Avg. bwd-input time: 10.0732 / Avg. batch time: 798.5164 (ms) / GPU bubble ratio: 47.61%
[rank3]:2025-12-28 00:50:04,592 -  step: 650  loss: -4.0000  grad_norm:  0.1252  memory: 15.27GiB(32.13%)  tps: 9,792  tflops: 76.55  mfu: 24.54%
[rank0]:2025-12-28 00:50:04,618 -  step: 650  loss:  0.2326  grad_norm:  0.1252  memory: 36.24GiB(76.29%)  tps: 9,792  tflops: 76.55  mfu: 24.54%
[rank1]:2025-12-28 00:50:04,592 -  step: 650  loss: -4.0000  grad_norm:  0.1252  memory: 17.89GiB(37.65%)  tps: 9,792  tflops: 76.55  mfu: 24.54%
[rank2]:2025-12-28 00:50:04,592 -  step: 650  loss: -4.0000  grad_norm:  0.1252  memory: 13.82GiB(29.09%)  tps: 9,792  tflops: 76.55  mfu: 24.54%
[rank0]:2025-12-28 00:52:46,002 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 00:52:49,675 - Avg. fwd time: 8.0941 / Avg. bwd-weight time: 7.9760 / Avg. bwd-input time: 10.0787 / Avg. batch time: 795.2209 (ms) / GPU bubble ratio: 47.39%
[rank1]:2025-12-28 00:52:49,677 - Avg. fwd time: 9.8293 / Avg. bwd-weight time: 7.4577 / Avg. bwd-input time: 12.7716 / Avg. batch time: 815.6099 (ms) / GPU bubble ratio: 41.03%
[rank3]:2025-12-28 00:52:49,671 - Avg. fwd time: 7.7717 / Avg. bwd-weight time: 7.2495 / Avg. bwd-input time: 9.8016 / Avg. batch time: 780.6437 (ms) / GPU bubble ratio: 49.12%
[rank0]:2025-12-28 00:52:49,678 - Avg. fwd time: 12.5720 / Avg. full-bwd time: 10.8423 (Avg. bwd-weight time: 8.7761 / Avg. bwd-input time: 33.3810) / Avg. batch time: 834.0410 (ms) / GPU bubble ratio: 25.05%
[rank2]:2025-12-28 00:52:49,724 -  step: 700  loss: -4.0000  grad_norm:  0.1354  memory: 13.82GiB(29.09%)  tps: 9,922  tflops: 77.56  mfu: 24.86%
[rank1]:2025-12-28 00:52:49,725 -  step: 700  loss: -4.0000  grad_norm:  0.1354  memory: 17.89GiB(37.65%)  tps: 9,922  tflops: 77.56  mfu: 24.86%
[rank1]:2025-12-28 00:52:49,804 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0052_stage1_step700.svg
[rank3]:2025-12-28 00:52:49,724 -  step: 700  loss: -4.0000  grad_norm:  0.1354  memory: 15.27GiB(32.13%)  tps: 9,922  tflops: 77.56  mfu: 24.86%
[rank0]:2025-12-28 00:52:49,750 -  step: 700  loss:  0.1926  grad_norm:  0.1354  memory: 36.24GiB(76.29%)  tps: 9,922  tflops: 77.56  mfu: 24.86%
[rank0]:2025-12-28 00:52:49,805 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0052_stage0_step700.svg
[rank2]:2025-12-28 00:52:49,807 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0052_stage2_step700.svg
[rank2]:2025-12-28 00:52:49,852 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0052_stage5_step700.svg
[rank1]:2025-12-28 00:52:49,849 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0052_stage6_step700.svg
[rank0]:2025-12-28 00:52:49,848 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0052_stage7_step700.svg
[rank2]:2025-12-28 00:52:49,952 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank2_stage2.svg
[rank2]:	> Counts Sum: 143880, Total Sum: 357120 (40.29%), Ratio(%) per element: [41.33, 40.12, 40.32, 40.32, 41.12, 40.92, 40.72, 41.93, 40.12, 39.51, 38.91, 39.31, 40.32, 40.52, 39.31, 40.32, 40.32, 39.71]
[rank1]:2025-12-28 00:52:49,973 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank1_stage1.svg
[rank1]:	> Counts Sum: 391200, Total Sum: 535680 (73.03%), Ratio(%) per element: [79.83, 80.04, 81.25, 82.45, 80.24, 78.02, 80.24, 81.25, 83.06, 73.79, 71.57, 69.15, 70.56, 73.18, 72.98, 70.36, 71.77, 72.17, 66.12, 66.73, 66.53, 67.33, 65.52, 66.73, 65.32, 68.14, 67.33]
[rank0]:2025-12-28 00:52:49,949 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank0_stage0.svg
[rank0]:	> Counts Sum: 290200, Total Sum: 376960 (76.98%), Ratio(%) per element: [67.94, 81.25, 80.44, 82.86, 82.25, 81.45, 80.24, 83.46, 82.25, 80.04, 72.58, 72.37, 74.39, 73.38, 75.2, 72.17, 72.37, 75.2, 72.78]
[rank2]:2025-12-28 00:52:50,051 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank2_stage5.svg
[rank2]:	> Counts Sum: 27400, Total Sum: 357120 (7.67%), Ratio(%) per element: [7.86, 8.06, 8.26, 8.66, 8.66, 7.25, 7.66, 8.46, 9.47, 7.05, 6.04, 7.66, 7.86, 6.45, 6.65, 6.85, 7.05, 8.06]
[rank1]:2025-12-28 00:52:50,071 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank1_stage6.svg
[rank1]:	> Counts Sum: 52560, Total Sum: 357120 (14.72%), Ratio(%) per element: [14.91, 14.31, 15.12, 15.12, 14.71, 15.12, 14.91, 14.71, 14.51, 14.71, 14.51, 14.51, 14.71, 14.71, 14.71, 14.11, 14.51, 14.91]
[rank3]:2025-12-28 00:52:50,068 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0052_step700_rank3.svg
[rank3]:			> Batch Time: 787.00 ms, GPU Bubble Ratio: 26.49%, 40.10%, 46.87%, 49.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  196-15-211ms   | [S7,MB1,BI] 223-33-257ms   | [S7,MB1,BW] 257-0-257ms    | [S7,MB2,F]  257-17-274ms   | [S7,MB2,BI] 287-34-321ms   | [S7,MB2,BW] 321-0-321ms    | [S7,MB3,F]  321-17-338ms   | [S7,MB3,BI] 351-34-385ms   | [S7,MB3,BW] 385-0-385ms    | [S0,MB7,F]  385-9-395ms    | [S0,MB0,B]  395-0-395ms    | [S7,MB4,F]  403-17-420ms   | [S7,MB4,BI] 432-33-465ms   | [S7,MB4,BW] 465-0-465ms    | [S0,MB1,B]  472-0-472ms    | [S7,MB5,F]  476-15-491ms   | [S7,MB5,BI] 503-32-536ms   | [S7,MB5,BW] 536-0-536ms    | [S0,MB2,B]  543-0-543ms    | [S7,MB6,F]  557-14-572ms   | [S7,MB6,BI] 583-32-616ms   | [S7,MB6,BW] 616-0-616ms    | [S0,MB3,B]  623-0-623ms    | [S7,MB7,F]  637-14-652ms   | [S7,MB7,BI] 664-32-696ms   | [S7,MB7,BW] 696-26-722ms   | [S0,MB4,B]  722-18-740ms   | [S0,MB5,B]  740-24-764ms   | [S0,MB6,B]  765-22-787ms   | [S0,MB7,B]  787-0-787ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-124ms    | [S6,MB0,BI] 171-9-180ms    | [S6,MB0,BW] 180-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 257-9-266ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  277-7-284ms    | [S6,MB2,BI] 321-9-330ms    | [S6,MB2,BW] 330-10-341ms   | [S1,MB6,F]  341-11-352ms   | [S1,MB0,BI] 352-15-368ms   | [S1,MB0,BW] 368-0-368ms    | [S6,MB4,F]  368-7-376ms    | [S6,MB3,BI] 385-12-397ms   | [S6,MB3,BW] 397-11-409ms   | [S1,MB7,F]  409-11-420ms   | [S1,MB1,BI] 420-16-437ms   | [S1,MB1,BW] 437-2-439ms    | [S6,MB5,F]  439-8-448ms    | [S6,MB4,BI] 465-12-477ms   | [S6,MB4,BW] 477-10-488ms   | [S1,MB2,BI] 488-14-503ms   | [S1,MB2,BW] 503-11-515ms   | [S6,MB6,F]  542-7-550ms    | [S6,MB5,BI] 550-10-560ms   | [S6,MB5,BW] 560-10-571ms   | [S1,MB3,BI] 571-14-586ms   | [S1,MB3,BW] 586-11-597ms   | [S6,MB7,F]  622-7-630ms    | [S6,MB6,BI] 630-10-640ms   | [S6,MB6,BW] 640-10-651ms   | [S1,MB4,BI] 651-14-666ms   | [S6,MB7,BI] 696-10-707ms   | [S1,MB5,BI] 707-15-722ms   | [S1,MB4,BW] 722-4-727ms    | [S1,MB6,BI] 736-14-751ms   | [S1,MB5,BW] 750-3-754ms    | [S1,MB7,BI] 760-14-775ms   | [S1,MB6,BW] 775-0-775ms    | [S6,MB7,BW] 775-0-775ms    | [S1,MB7,BW] 775-0-775ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-304ms   | [S2,MB0,BW] 304-9-314ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 331-10-341ms   | [S5,MB2,BW] 341-10-351ms   | [S2,MB6,F]  353-10-363ms   | [S2,MB1,BI] 365-11-376ms   | [S2,MB1,BW] 376-9-386ms    | [S5,MB5,F]  386-7-394ms    | [S5,MB3,BI] 400-11-411ms   | [S5,MB3,BW] 411-10-422ms   | [S2,MB7,F]  422-10-432ms   | [S2,MB2,BI] 434-11-445ms   | [S2,MB2,BW] 445-10-456ms   | [S5,MB6,F]  455-8-463ms    | [S5,MB4,BI] 478-10-489ms   | [S5,MB4,BW] 489-9-499ms    | [S2,MB3,BI] 546-9-556ms    | [S2,MB3,BW] 556-10-566ms   | [S5,MB7,F]  570-7-577ms    | [S5,MB5,BI] 577-9-587ms    | [S5,MB5,BW] 587-9-596ms    | [S2,MB4,BI] 626-9-635ms    | [S5,MB6,BI] 641-10-651ms   | [S2,MB5,BI] 651-10-661ms   | [S5,MB7,BI] 710-9-719ms    | [S2,MB6,BI] 719-10-729ms   | [S2,MB4,BW] 729-8-737ms    | [S2,MB7,BI] 744-9-754ms    | [S2,MB5,BW] 754-0-754ms    | [S5,MB6,BW] 754-10-764ms   | [S5,MB7,BW] 764-5-769ms    | [S2,MB6,BW] 770-0-770ms    | [S2,MB7,BW] 770-0-770ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-7-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 276-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 358-11-369ms   | [S4,MB2,BW] 369-9-379ms    | [S3,MB6,F]  379-7-387ms    | [S3,MB2,BI] 387-9-396ms    | [S3,MB2,BW] 396-9-406ms    | [S4,MB6,F]  406-7-414ms    | [S4,MB3,BI] 427-12-439ms   | [S4,MB3,BW] 439-9-449ms    | [S3,MB7,F]  449-7-456ms    | [S3,MB3,BI] 456-9-466ms    | [S3,MB3,BW] 466-10-476ms   | [S4,MB7,F]  476-8-485ms    | [S4,MB4,BI] 539-10-550ms   | [S4,MB4,BW] 550-9-559ms    | [S3,MB4,BI] 559-10-570ms   | [S4,MB5,BI] 619-9-629ms    | [S3,MB5,BI] 629-9-638ms    | [S4,MB6,BI] 652-9-661ms    | [S3,MB6,BI] 661-9-670ms    | [S4,MB7,BI] 720-9-729ms    | [S3,MB7,BI] 729-9-738ms    | [S3,MB4,BW] 738-0-738ms    | [S4,MB5,BW] 738-10-748ms   | [S4,MB6,BW] 748-9-757ms    | [S4,MB7,BW] 757-7-764ms    | [S3,MB5,BW] 765-0-765ms    | [S3,MB6,BW] 765-0-765ms    | [S3,MB7,BW] 765-0-765ms   
[rank3]:2025-12-28 00:52:50,112 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0052_stage3_step700.svg
[rank0]:2025-12-28 00:52:50,028 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank0_stage7.svg
[rank0]:	> Counts Sum: 168080, Total Sum: 218240 (77.02%), Ratio(%) per element: [76.81, 76.81, 76.61, 76.41, 75.8, 78.42, 77.82, 77.21, 77.21, 77.41, 76.61]
[rank3]:2025-12-28 00:52:50,156 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0052_stage4_step700.svg
[rank3]:2025-12-28 00:52:50,253 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank3_stage3.svg
[rank3]:	> Counts Sum: 175680, Total Sum: 357120 (49.19%), Ratio(%) per element: [49.19, 50.2, 49.59, 49.19, 47.98, 48.58, 49.19, 49.59, 48.18, 49.19, 48.38, 49.19, 49.59, 50.2, 49.19, 48.79, 49.59, 49.59]
[rank3]:2025-12-28 00:52:50,352 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0052_rank3_stage4.svg
[rank3]:	> Counts Sum: 27400, Total Sum: 357120 (7.67%), Ratio(%) per element: [8.66, 7.86, 8.46, 7.86, 9.27, 8.87, 7.86, 8.66, 8.26, 5.24, 6.85, 7.66, 7.86, 6.65, 7.45, 7.05, 6.85, 6.65]
[rank2]:2025-12-28 00:52:50,877 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage2.svg
[rank1]:2025-12-28 00:52:50,862 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage1.svg
[rank0]:2025-12-28 00:52:50,886 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage0.svg
[rank3]:2025-12-28 00:52:51,166 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage3.svg
[rank2]:2025-12-28 00:52:51,679 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage5.svg
[rank1]:2025-12-28 00:52:51,640 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage6.svg
[rank0]:2025-12-28 00:52:51,738 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage7.svg
[rank3]:2025-12-28 00:52:51,965 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0052_stage4.svg
[rank0]:2025-12-28 00:55:33,542 - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-12-28 00:55:37,232 - Avg. fwd time: 12.5639 / Avg. full-bwd time: 10.6114 (Avg. bwd-weight time: 8.5764 / Avg. bwd-input time: 33.3712) / Avg. batch time: 830.9606 (ms) / GPU bubble ratio: 25.21%
[rank3]:2025-12-28 00:55:37,228 - Avg. fwd time: 7.7732 / Avg. bwd-weight time: 7.2381 / Avg. bwd-input time: 9.8058 / Avg. batch time: 777.7946 (ms) / GPU bubble ratio: 48.95%
[rank1]:2025-12-28 00:55:37,232 - Avg. fwd time: 9.8275 / Avg. bwd-weight time: 7.4006 / Avg. bwd-input time: 12.7768 / Avg. batch time: 812.5811 (ms) / GPU bubble ratio: 40.92%
[rank1]:2025-12-28 00:55:37,281 -  step: 750  loss: -4.0000  grad_norm:  0.2134  memory: 17.89GiB(37.65%)  tps: 9,778  tflops: 76.44  mfu: 24.50%
[rank2]:2025-12-28 00:55:37,229 - Avg. fwd time: 8.0970 / Avg. bwd-weight time: 7.9636 / Avg. bwd-input time: 10.0828 / Avg. batch time: 792.3842 (ms) / GPU bubble ratio: 47.21%
[rank2]:2025-12-28 00:55:37,278 -  step: 750  loss: -4.0000  grad_norm:  0.2134  memory: 13.82GiB(29.09%)  tps: 9,778  tflops: 76.44  mfu: 24.50%
[rank0]:2025-12-28 00:55:37,302 -  step: 750  loss:  0.2345  grad_norm:  0.2134  memory: 36.24GiB(76.29%)  tps: 9,779  tflops: 76.44  mfu: 24.50%
[rank3]:2025-12-28 00:55:37,278 -  step: 750  loss: -4.0000  grad_norm:  0.2134  memory: 15.27GiB(32.13%)  tps: 9,778  tflops: 76.44  mfu: 24.50%
[rank0]:2025-12-28 00:58:19,076 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 00:58:22,862 - Avg. fwd time: 7.7749 / Avg. bwd-weight time: 7.2289 / Avg. bwd-input time: 9.8092 / Avg. batch time: 775.3394 (ms) / GPU bubble ratio: 48.80%
[rank2]:2025-12-28 00:58:22,866 - Avg. fwd time: 8.0994 / Avg. bwd-weight time: 7.9544 / Avg. bwd-input time: 10.0863 / Avg. batch time: 789.8740 (ms) / GPU bubble ratio: 47.05%
[rank2]:2025-12-28 00:58:22,917 -  step: 800  loss: -4.0000  grad_norm:  0.3760  memory: 13.82GiB(29.09%)  tps: 9,891  tflops: 77.33  mfu: 24.78%
[rank2]:2025-12-28 00:58:22,917 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.3760  tps: 9,975  tflops: 77.98  mfu: 22.80%
[rank2]:2025-12-28 00:58:22,917 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 00:58:22,917 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 00:58:22,871 - Avg. fwd time: 12.5591 / Avg. full-bwd time: 10.4228 (Avg. bwd-weight time: 8.3681 / Avg. bwd-input time: 33.3652) / Avg. batch time: 828.2868 (ms) / GPU bubble ratio: 25.36%
[rank0]:2025-12-28 00:58:22,942 -  step: 800  loss:  0.2388  grad_norm:  0.3760  memory: 36.24GiB(76.29%)  tps: 9,891  tflops: 77.33  mfu: 24.78%
[rank0]:2025-12-28 00:58:22,942 - â„¹ï¸ final step: 800  loss:  0.2388  grad_norm:  0.3760  tps: 9,981  tflops: 78.03  mfu: 22.89%
[rank0]:2025-12-28 00:58:22,943 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 00:58:22,944 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 00:58:22,867 - Avg. fwd time: 9.8272 / Avg. bwd-weight time: 7.3599 / Avg. bwd-input time: 12.7831 / Avg. batch time: 809.8983 (ms) / GPU bubble ratio: 40.79%
[rank1]:2025-12-28 00:58:22,917 -  step: 800  loss: -4.0000  grad_norm:  0.3760  memory: 17.89GiB(37.65%)  tps: 9,892  tflops: 77.33  mfu: 24.78%
[rank1]:2025-12-28 00:58:22,917 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.3760  tps: 9,972  tflops: 77.96  mfu: 22.78%
[rank1]:2025-12-28 00:58:22,917 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 00:58:22,918 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 00:58:22,916 -  step: 800  loss: -4.0000  grad_norm:  0.3760  memory: 15.27GiB(32.13%)  tps: 9,891  tflops: 77.33  mfu: 24.78%
[rank3]:2025-12-28 00:58:22,916 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.3760  tps: 9,974  tflops: 77.97  mfu: 22.79%
[rank3]:2025-12-28 00:58:22,917 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 00:58:22,917 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 00:58:25,337 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-28 00:58:25,414 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0058_stage2_final800.svg
[rank0]:2025-12-28 00:58:25,415 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0058_stage0_final800.svg
[rank1]:2025-12-28 00:58:25,415 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0058_stage1_final800.svg
[rank2]:2025-12-28 00:58:25,459 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_0058_stage5_final800.svg
[rank0]:2025-12-28 00:58:25,461 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_0058_stage7_final800.svg
[rank1]:2025-12-28 00:58:25,461 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_0058_stage6_final800.svg
[rank2]:2025-12-28 00:58:25,557 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank2_stage2.svg
[rank2]:	> Counts Sum: 167080, Total Sum: 414720 (40.29%), Ratio(%) per element: [41.14, 40.62, 40.27, 40.1, 41.14, 41.14, 40.79, 41.49, 39.93, 39.58, 38.71, 39.23, 40.45, 40.62, 39.58, 40.62, 40.1, 39.58]
[rank0]:2025-12-28 00:58:25,567 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank0_stage0.svg
[rank0]:	> Counts Sum: 339000, Total Sum: 437760 (77.44%), Ratio(%) per element: [67.88, 82.46, 81.42, 82.81, 82.81, 82.46, 80.72, 83.68, 82.98, 80.72, 73.43, 73.09, 74.47, 73.43, 75.17, 72.91, 73.26, 75.52, 72.04]
[rank0]:2025-12-28 00:58:25,647 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank0_stage7.svg
[rank0]:	> Counts Sum: 196480, Total Sum: 253440 (77.53%), Ratio(%) per element: [76.9, 77.08, 77.08, 77.08, 76.56, 78.47, 78.47, 77.95, 77.95, 78.29, 76.9]
[rank1]:2025-12-28 00:58:25,589 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank1_stage1.svg
[rank1]:	> Counts Sum: 456800, Total Sum: 622080 (73.43%), Ratio(%) per element: [80.55, 80.38, 81.07, 82.81, 79.86, 78.81, 80.55, 81.94, 82.98, 74.13, 72.56, 70.48, 71.7, 73.61, 73.09, 71.52, 72.91, 73.09, 66.66, 66.66, 66.31, 68.05, 65.97, 66.66, 65.1, 67.88, 67.18]
[rank3]:2025-12-28 00:58:25,668 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0058_final800_rank3.svg
[rank3]:			> Batch Time: 790.00 ms, GPU Bubble Ratio: 27.08%, 40.43%, 47.03%, 49.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-197ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 258-0-258ms    | [S7,MB2,F]  259-17-276ms   | [S7,MB2,BI] 288-34-322ms   | [S7,MB2,BW] 322-0-322ms    | [S7,MB3,F]  322-17-340ms   | [S7,MB3,BI] 352-34-386ms   | [S7,MB3,BW] 386-0-386ms    | [S0,MB7,F]  386-9-396ms    | [S0,MB0,B]  396-0-396ms    | [S7,MB4,F]  404-17-422ms   | [S7,MB4,BI] 434-33-467ms   | [S7,MB4,BW] 467-0-467ms    | [S0,MB1,B]  474-0-474ms    | [S7,MB5,F]  478-16-495ms   | [S7,MB5,BI] 507-32-539ms   | [S7,MB5,BW] 540-0-540ms    | [S0,MB2,B]  546-0-546ms    | [S7,MB6,F]  561-14-575ms   | [S7,MB6,BI] 587-32-620ms   | [S7,MB6,BW] 620-0-620ms    | [S0,MB3,B]  627-0-627ms    | [S7,MB7,F]  641-14-656ms   | [S7,MB7,BI] 668-32-700ms   | [S7,MB7,BW] 700-23-724ms   | [S0,MB4,B]  720-16-736ms   | [S0,MB5,B]  740-22-762ms   | [S0,MB6,B]  765-21-786ms   | [S0,MB7,B]  790-0-790ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-94ms     | [S6,MB0,F]  94-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  277-7-285ms    | [S6,MB2,BI] 322-9-331ms    | [S6,MB2,BW] 331-10-342ms   | [S1,MB6,F]  342-11-353ms   | [S1,MB0,BI] 353-15-369ms   | [S1,MB0,BW] 369-0-369ms    | [S6,MB4,F]  369-7-377ms    | [S6,MB3,BI] 386-12-398ms   | [S6,MB3,BW] 398-11-410ms   | [S1,MB7,F]  410-11-422ms   | [S1,MB1,BI] 422-16-438ms   | [S1,MB1,BW] 438-2-440ms    | [S6,MB5,F]  440-8-449ms    | [S6,MB4,BI] 467-12-479ms   | [S6,MB4,BW] 479-10-490ms   | [S1,MB2,BI] 490-14-505ms   | [S1,MB2,BW] 505-10-516ms   | [S6,MB6,F]  546-7-553ms    | [S6,MB5,BI] 553-10-564ms   | [S6,MB5,BW] 564-10-574ms   | [S1,MB3,BI] 574-14-589ms   | [S1,MB3,BW] 589-11-601ms   | [S6,MB7,F]  626-7-634ms    | [S6,MB6,BI] 634-10-644ms   | [S6,MB6,BW] 644-10-655ms   | [S1,MB4,BI] 655-14-670ms   | [S6,MB7,BI] 701-10-711ms   | [S1,MB5,BI] 714-15-729ms   | [S1,MB4,BW] 729-4-734ms    | [S1,MB6,BI] 741-14-756ms   | [S1,MB5,BW] 756-3-759ms    | [S1,MB7,BI] 766-14-780ms   | [S1,MB6,BW] 780-0-780ms    | [S6,MB7,BW] 780-0-780ms    | [S1,MB7,BW] 780-0-780ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-315ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 332-10-342ms   | [S5,MB2,BW] 343-9-353ms    | [S2,MB6,F]  354-10-364ms   | [S2,MB1,BI] 366-11-377ms   | [S2,MB1,BW] 377-9-387ms    | [S5,MB5,F]  387-7-395ms    | [S5,MB3,BI] 401-11-412ms   | [S5,MB3,BW] 413-10-424ms   | [S2,MB7,F]  424-10-434ms   | [S2,MB2,BI] 435-11-446ms   | [S2,MB2,BW] 446-10-457ms   | [S5,MB6,F]  457-8-465ms    | [S5,MB4,BI] 480-10-490ms   | [S5,MB4,BW] 491-9-501ms    | [S2,MB3,BI] 549-9-559ms    | [S2,MB3,BW] 559-10-569ms   | [S5,MB7,F]  573-7-580ms    | [S5,MB5,BI] 581-9-590ms    | [S5,MB5,BW] 590-9-600ms    | [S2,MB4,BI] 630-9-639ms    | [S5,MB6,BI] 645-10-655ms   | [S2,MB5,BI] 655-10-665ms   | [S5,MB7,BI] 716-9-725ms    | [S2,MB6,BI] 725-10-735ms   | [S2,MB4,BW] 735-8-743ms    | [S2,MB7,BI] 750-9-759ms    | [S2,MB5,BW] 759-0-759ms    | [S5,MB6,BW] 759-10-769ms   | [S5,MB7,BW] 770-6-776ms    | [S2,MB6,BW] 776-0-776ms    | [S2,MB7,BW] 776-0-776ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 359-11-370ms   | [S4,MB2,BW] 370-9-380ms    | [S3,MB6,F]  380-7-387ms    | [S3,MB2,BI] 388-9-397ms    | [S3,MB2,BW] 397-9-407ms    | [S4,MB6,F]  407-7-415ms    | [S4,MB3,BI] 428-12-440ms   | [S4,MB3,BW] 440-9-450ms    | [S3,MB7,F]  450-7-457ms    | [S3,MB3,BI] 457-9-467ms    | [S3,MB3,BW] 467-10-477ms   | [S4,MB7,F]  477-8-486ms    | [S4,MB4,BI] 542-10-552ms   | [S4,MB4,BW] 553-9-562ms    | [S3,MB4,BI] 562-10-573ms   | [S4,MB5,BI] 623-9-633ms    | [S3,MB5,BI] 633-9-642ms    | [S4,MB6,BI] 655-9-664ms    | [S3,MB6,BI] 665-9-674ms    | [S4,MB7,BI] 725-9-734ms    | [S3,MB7,BI] 734-9-743ms    | [S3,MB4,BW] 743-0-743ms    | [S4,MB5,BW] 743-10-753ms   | [S4,MB6,BW] 753-9-763ms    | [S4,MB7,BW] 763-6-769ms    | [S3,MB5,BW] 769-0-769ms    | [S3,MB6,BW] 769-0-769ms    | [S3,MB7,BW] 769-0-769ms   
[rank2]:2025-12-28 00:58:25,654 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank2_stage5.svg
[rank2]:	> Counts Sum: 30200, Total Sum: 414720 (7.28%), Ratio(%) per element: [8.15, 7.46, 8.15, 7.98, 7.98, 6.77, 7.29, 7.81, 8.68, 6.94, 5.72, 6.77, 7.46, 6.42, 6.77, 6.94, 6.59, 7.11]
[rank1]:2025-12-28 00:58:25,688 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank1_stage6.svg
[rank1]:	> Counts Sum: 59760, Total Sum: 414720 (14.41%), Ratio(%) per element: [14.58, 14.06, 14.75, 14.75, 14.4, 14.75, 14.58, 14.4, 14.23, 14.4, 14.23, 14.23, 14.4, 14.4, 14.4, 13.88, 14.23, 14.58]
[rank3]:2025-12-28 00:58:25,990 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/pipeline_schedule/251228_0058_thry_final800_rank3.svg
[rank3]:			> Batch Time: 458.46 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-38ms      | [S0,MB4,F]  38-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-66ms      | [S7,MB0,F]  66-9-76ms      | [S7,MB0,BI] 76-9-85ms      | [S7,MB0,BW] 85-9-95ms      | [S7,MB1,F]  95-9-105ms     | [S7,MB1,BI] 105-9-114ms    | [S7,MB1,BW] 114-9-124ms    | [S7,MB2,F]  124-9-133ms    | [S7,MB2,BI] 133-9-143ms    | [S7,MB2,BW] 143-9-152ms    | [S7,MB3,F]  152-9-162ms    | [S7,MB3,BI] 162-9-171ms    | [S7,MB3,BW] 171-9-181ms    | [S0,MB7,F]  181-9-191ms    | [S0,MB0,B]  191-19-210ms   | [S7,MB4,F]  210-9-219ms    | [S7,MB4,BI] 219-9-229ms    | [S7,MB4,BW] 229-9-238ms    | [S0,MB1,B]  238-19-257ms   | [S7,MB5,F]  257-9-267ms    | [S7,MB5,BI] 267-9-276ms    | [S7,MB5,BW] 276-9-286ms    | [S0,MB2,B]  286-19-305ms   | [S7,MB6,F]  305-9-315ms    | [S7,MB6,BI] 315-9-324ms    | [S7,MB6,BW] 324-9-334ms    | [S0,MB3,B]  334-19-353ms   | [S7,MB7,F]  353-9-362ms    | [S7,MB7,BI] 362-9-372ms    | [S7,MB7,BW] 372-9-382ms    | [S0,MB4,B]  382-19-401ms   | [S0,MB5,B]  401-19-420ms   | [S0,MB6,B]  420-19-439ms   | [S0,MB7,B]  439-19-458ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-28ms      | [S1,MB2,F]  28-9-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-9-57ms      | [S6,MB0,F]  57-9-66ms      | [S1,MB5,F]  66-9-76ms      | [S6,MB1,F]  76-9-85ms      | [S6,MB0,BI] 85-9-95ms      | [S6,MB0,BW] 95-9-105ms     | [S6,MB2,F]  105-9-114ms    | [S6,MB1,BI] 114-9-124ms    | [S6,MB1,BW] 124-9-133ms    | [S6,MB3,F]  133-9-143ms    | [S6,MB2,BI] 143-9-152ms    | [S6,MB2,BW] 152-9-162ms    | [S1,MB6,F]  162-9-171ms    | [S1,MB0,BI] 171-9-181ms    | [S1,MB0,BW] 181-9-191ms    | [S6,MB4,F]  191-9-200ms    | [S6,MB3,BI] 200-9-210ms    | [S6,MB3,BW] 210-9-219ms    | [S1,MB7,F]  219-9-229ms    | [S1,MB1,BI] 229-9-238ms    | [S1,MB1,BW] 238-9-248ms    | [S6,MB5,F]  248-9-257ms    | [S6,MB4,BI] 257-9-267ms    | [S6,MB4,BW] 267-9-276ms    | [S1,MB2,BI] 276-9-286ms    | [S1,MB2,BW] 286-9-296ms    | [S6,MB6,F]  296-9-305ms    | [S6,MB5,BI] 305-9-315ms    | [S6,MB5,BW] 315-9-324ms    | [S1,MB3,BI] 324-9-334ms    | [S1,MB3,BW] 334-9-343ms    | [S6,MB7,F]  343-9-353ms    | [S6,MB6,BI] 353-9-362ms    | [S6,MB6,BW] 362-9-372ms    | [S1,MB4,BI] 372-9-382ms    | [S6,MB7,BI] 382-9-391ms    | [S1,MB5,BI] 391-9-401ms    | [S1,MB4,BW] 401-9-410ms    | [S1,MB6,BI] 410-9-420ms    | [S1,MB5,BW] 420-9-429ms    | [S1,MB7,BI] 429-9-439ms    | [S1,MB6,BW] 439-9-448ms    | [S6,MB7,BW] 448-9-458ms    | [S1,MB7,BW] 458-9-468ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-28ms      | [S2,MB1,F]  28-9-38ms      | [S2,MB2,F]  38-9-47ms      | [S5,MB0,F]  47-9-57ms      | [S2,MB3,F]  57-9-66ms      | [S5,MB1,F]  66-9-76ms      | [S2,MB4,F]  76-9-85ms      | [S5,MB2,F]  85-9-95ms      | [S5,MB0,BI] 95-9-105ms     | [S5,MB0,BW] 105-9-114ms    | [S5,MB3,F]  114-9-124ms    | [S5,MB1,BI] 124-9-133ms    | [S5,MB1,BW] 133-9-143ms    | [S2,MB5,F]  143-9-152ms    | [S2,MB0,BI] 152-9-162ms    | [S2,MB0,BW] 162-9-171ms    | [S5,MB4,F]  171-9-181ms    | [S5,MB2,BI] 181-9-191ms    | [S5,MB2,BW] 191-9-200ms    | [S2,MB6,F]  200-9-210ms    | [S2,MB1,BI] 210-9-219ms    | [S2,MB1,BW] 219-9-229ms    | [S5,MB5,F]  229-9-238ms    | [S5,MB3,BI] 238-9-248ms    | [S5,MB3,BW] 248-9-257ms    | [S2,MB7,F]  257-9-267ms    | [S2,MB2,BI] 267-9-276ms    | [S2,MB2,BW] 276-9-286ms    | [S5,MB6,F]  286-9-296ms    | [S5,MB4,BI] 296-9-305ms    | [S5,MB4,BW] 305-9-315ms    | [S2,MB3,BI] 315-9-324ms    | [S2,MB3,BW] 324-9-334ms    | [S5,MB7,F]  334-9-343ms    | [S5,MB5,BI] 343-9-353ms    | [S5,MB5,BW] 353-9-362ms    | [S2,MB4,BI] 362-9-372ms    | [S5,MB6,BI] 372-9-382ms    | [S2,MB5,BI] 382-9-391ms    | [S5,MB7,BI] 391-9-401ms    | [S2,MB6,BI] 401-9-410ms    | [S2,MB4,BW] 410-9-420ms    | [S2,MB7,BI] 420-9-429ms    | [S2,MB5,BW] 429-9-439ms    | [S5,MB6,BW] 439-9-448ms    | [S5,MB7,BW] 448-9-458ms    | [S2,MB6,BW] 458-9-468ms    | [S2,MB7,BW] 468-9-477ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-9-38ms      | [S4,MB0,F]  38-9-47ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  57-9-66ms      | [S3,MB2,F]  66-9-76ms      | [S4,MB2,F]  76-9-85ms      | [S3,MB3,F]  85-9-95ms      | [S4,MB3,F]  95-9-105ms     | [S4,MB0,BI] 105-9-114ms    | [S4,MB0,BW] 114-9-124ms    | [S3,MB4,F]  124-9-133ms    | [S3,MB0,BI] 133-9-143ms    | [S3,MB0,BW] 143-9-152ms    | [S4,MB4,F]  152-9-162ms    | [S4,MB1,BI] 162-9-171ms    | [S4,MB1,BW] 171-9-181ms    | [S3,MB5,F]  181-9-191ms    | [S3,MB1,BI] 191-9-200ms    | [S3,MB1,BW] 200-9-210ms    | [S4,MB5,F]  210-9-219ms    | [S4,MB2,BI] 219-9-229ms    | [S4,MB2,BW] 229-9-238ms    | [S3,MB6,F]  238-9-248ms    | [S3,MB2,BI] 248-9-257ms    | [S3,MB2,BW] 257-9-267ms    | [S4,MB6,F]  267-9-276ms    | [S4,MB3,BI] 276-9-286ms    | [S4,MB3,BW] 286-9-296ms    | [S3,MB7,F]  296-9-305ms    | [S3,MB3,BI] 305-9-315ms    | [S3,MB3,BW] 315-9-324ms    | [S4,MB7,F]  324-9-334ms    | [S4,MB4,BI] 334-9-343ms    | [S4,MB4,BW] 343-9-353ms    | [S3,MB4,BI] 353-9-362ms    | [S4,MB5,BI] 362-9-372ms    | [S3,MB5,BI] 372-9-382ms    | [S4,MB6,BI] 382-9-391ms    | [S3,MB6,BI] 391-9-401ms    | [S4,MB7,BI] 401-9-410ms    | [S3,MB7,BI] 410-9-420ms    | [S3,MB4,BW] 420-9-429ms    | [S4,MB5,BW] 429-9-439ms    | [S4,MB6,BW] 439-9-448ms    | [S4,MB7,BW] 448-9-458ms    | [S3,MB5,BW] 458-9-468ms    | [S3,MB6,BW] 468-9-477ms    | [S3,MB7,BW] 477-9-487ms   
[rank3]:2025-12-28 00:58:26,036 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0058_stage3_final800.svg
[rank3]:2025-12-28 00:58:26,080 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_0058_stage4_final800.svg
[rank3]:2025-12-28 00:58:26,177 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank3_stage3.svg
[rank3]:	> Counts Sum: 204480, Total Sum: 414720 (49.31%), Ratio(%) per element: [49.3, 50.17, 49.65, 49.3, 48.26, 48.78, 49.3, 49.65, 48.43, 49.3, 48.61, 49.3, 49.65, 50.17, 49.3, 48.95, 49.65, 49.65]
[rank3]:2025-12-28 00:58:26,273 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/frozen_params_histogram/251228_0058_rank3_stage4.svg
[rank3]:	> Counts Sum: 30200, Total Sum: 414720 (7.28%), Ratio(%) per element: [7.98, 7.46, 8.33, 7.63, 8.68, 7.63, 7.29, 8.5, 8.33, 5.03, 6.42, 7.11, 7.63, 6.42, 6.77, 6.77, 6.77, 6.25]
[rank2]:2025-12-28 00:58:26,599 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage2.svg
[rank0]:2025-12-28 00:58:26,623 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage0.svg
[rank1]:2025-12-28 00:58:26,601 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage1.svg
[rank3]:2025-12-28 00:58:27,218 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage3.svg
[rank2]:2025-12-28 00:58:27,515 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage5.svg
[rank2]:2025-12-28 00:58:27,519 - Destroying the purge thread.
[rank1]:2025-12-28 00:58:27,494 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage6.svg
[rank1]:2025-12-28 00:58:27,498 - Destroying the purge thread.
[rank0]:2025-12-28 00:58:27,601 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage7.svg
[rank0]:2025-12-28 00:58:27,605 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-28 00:58:27,895 - Process group destroyed
[rank1]:2025-12-28 00:58:27,917 - Process group destroyed
[rank3]:2025-12-28 00:58:28,133 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1/afr_time_plot/251228_0058_stage4.svg
[rank3]:2025-12-28 00:58:28,136 - Destroying the purge thread.
[rank3]:2025-12-28 00:58:28,358 - Process group destroyed
[rank0]:2025-12-28 00:58:29,606 - Training completed
[rank0]:2025-12-28 00:58:29,607 - Destroying the purge thread.
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.28301
[rank0]:wandb:               final/avg_loss 0.23876
[rank0]:wandb:             final/avg_mfu(%) 22.8949
[rank0]:wandb:             final/avg_tflops 78.02764
[rank0]:wandb:    final/avg_throughput(tps) 9981.09928
[rank0]:wandb:              final/grad_norm 0.37603
[rank0]:wandb:               final/max_loss 0.23876
[rank0]:wandb:                    grad_norm 0.37603
[rank0]:wandb: loss_metrics/global_avg_loss 0.23876
[rank0]:wandb: loss_metrics/global_max_loss 0.23876
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1227_ZBVZeroBubble_timelyauto_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/44om7aip
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_timelyauto_11_dm1/20251228-0011/wandb/run-20251228_001150-44om7aip/logs
[rank0]:2025-12-28 00:58:30,916 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_ZBVZeroBubble_timelyauto_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
