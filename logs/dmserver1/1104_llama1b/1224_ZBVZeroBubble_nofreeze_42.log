
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 26. (ê¸ˆ) 17:01:13 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_nofreeze_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with nofreeze x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-26 17:01:19,953 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank3]:2025-12-26 17:01:19,936 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:2025-12-26 17:01:19,937 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank3]:"
[rank0]:2025-12-26 17:01:20,003 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank3]:2025-12-26 17:01:20,225 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-26 17:01:20,227 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-26 17:01:20,291 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-26 17:01:20,294 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 17:01:20,355 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-26 17:01:20,358 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 17:01:20,361 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-26 17:01:20,363 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-26 17:01:20,322 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-26 17:01:20,325 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 17:01:20,753 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-26 17:01:23,636 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:2025-12-26 17:01:23,798 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-26 17:01:23,838 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 17:01:23,864 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-26 17:01:23,877 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-26 17:01:23,879 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-26 17:01:23,883 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-26 17:01:23,923 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 17:01:23,951 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-26 17:01:23,964 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-26 17:01:23,966 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-26 17:01:24,067 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 17:01:24,067 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-26 17:01:24,068 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank2]:2025-12-26 17:01:24,180 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-26 17:01:24,158 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 17:01:24,158 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-26 17:01:24,159 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-26 17:01:24,221 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 17:01:24,250 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-26 17:01:24,263 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-26 17:01:24,265 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-26 17:01:24,482 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 17:01:24,482 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-26 17:01:24,483 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run w8oau86s
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_nofreeze_42_dm1/20251226-1701/wandb/run-20251226_170124-w8oau86s
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_nofreeze_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/w8oau86s
[rank0]:2025-12-26 17:01:26,160 - WandB logging enabled
[rank0]:2025-12-26 17:01:26,161 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-26 17:01:26,202 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 17:01:26,204 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-26 17:01:26,231 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-26 17:01:26,245 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-26 17:01:26,248 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-26 17:01:26,465 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 17:01:26,444 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 17:01:26,444 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-26 17:01:26,445 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-26 17:01:26,465 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_nofreeze_42_dm1
[rank0]:2025-12-26 17:01:26,465 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 17:01:26,466 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-26 17:01:26,466 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-26 17:01:26,465 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-26 17:01:26,465 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 17:01:29,819 - [GC] GC collection for checkpoint loading. 0.04 seconds
[rank0]:2025-12-26 17:01:29,820 - Finished loading the checkpoint in 3.35 seconds.
[rank0]:2025-12-26 17:01:29,820 - Training starts at step 1
[rank2]:2025-12-26 17:01:34,995 -  step:  1  loss: -4.0000  grad_norm: 203.0675  memory: 11.98GiB(25.23%)  tps: 3,042  tflops: 23.78  mfu: 7.62%
[rank2]:2025-12-26 17:01:34,996 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-26 17:01:35,001 -  step:  1  loss: -4.0000  grad_norm: 203.0675  memory: 15.58GiB(32.80%)  tps: 2,958  tflops: 23.12  mfu: 7.41%
[rank1]:2025-12-26 17:01:35,002 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-26 17:01:34,995 -  step:  1  loss: -4.0000  grad_norm: 203.0675  memory: 13.43GiB(28.27%)  tps: 2,937  tflops: 22.96  mfu: 7.36%
[rank3]:2025-12-26 17:01:34,995 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 17:01:35,049 -  step:  1  loss: 10.6092  grad_norm: 203.0675  memory: 30.01GiB(63.17%)  tps: 3,705  tflops: 28.96  mfu: 9.28%
[rank0]:2025-12-26 17:01:35,050 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 17:05:16,849 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 17:05:21,675 - Avg. fwd time: 13.6699 / Avg. full-bwd time: 29.0339 (Avg. bwd-weight time: 30.0687 / Avg. bwd-input time: 34.5285) / Avg. batch time: 1114.7882 (ms) / GPU bubble ratio: 13.19%
[rank2]:2025-12-26 17:05:21,648 - Avg. fwd time: 8.1387 / Avg. bwd-weight time: 10.0146 / Avg. bwd-input time: 9.9787 / Avg. batch time: 1056.6112 (ms) / GPU bubble ratio: 57.40%
[rank1]:2025-12-26 17:05:21,667 - Avg. fwd time: 9.8604 / Avg. bwd-weight time: 12.9269 / Avg. bwd-input time: 12.1982 / Avg. batch time: 1092.1252 (ms) / GPU bubble ratio: 48.75%
[rank3]:2025-12-26 17:05:21,658 - Avg. fwd time: 7.7816 / Avg. bwd-weight time: 9.8419 / Avg. bwd-input time: 9.6130 / Avg. batch time: 1053.2056 (ms) / GPU bubble ratio: 58.62%
[rank0]:2025-12-26 17:05:21,748 -  step: 50  loss:  9.8814  grad_norm: 23.9989  memory: 35.32GiB(74.36%)  tps: 7,083  tflops: 55.37  mfu: 17.75%
[rank2]:2025-12-26 17:05:21,721 -  step: 50  loss: -4.0000  grad_norm: 23.9989  memory: 13.80GiB(29.05%)  tps: 7,082  tflops: 55.36  mfu: 17.74%
[rank1]:2025-12-26 17:05:21,725 -  step: 50  loss: -4.0000  grad_norm: 23.9989  memory: 17.83GiB(37.53%)  tps: 7,082  tflops: 55.36  mfu: 17.74%
[rank3]:2025-12-26 17:05:21,721 -  step: 50  loss: -4.0000  grad_norm: 23.9989  memory: 15.27GiB(32.13%)  tps: 7,082  tflops: 55.36  mfu: 17.74%
[rank0]:2025-12-26 17:09:09,987 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 17:09:14,791 - Avg. fwd time: 13.7518 / Avg. full-bwd time: 29.2293 (Avg. bwd-weight time: 30.3381 / Avg. bwd-input time: 34.6136) / Avg. batch time: 1120.1187 (ms) / GPU bubble ratio: 13.09%
[rank3]:2025-12-26 17:09:14,768 - Avg. fwd time: 7.7717 / Avg. bwd-weight time: 9.8766 / Avg. bwd-input time: 9.6226 / Avg. batch time: 1057.9102 (ms) / GPU bubble ratio: 58.76%
[rank1]:2025-12-26 17:09:14,780 - Avg. fwd time: 9.8490 / Avg. bwd-weight time: 12.9652 / Avg. bwd-input time: 12.2145 / Avg. batch time: 1096.8048 (ms) / GPU bubble ratio: 48.90%
[rank2]:2025-12-26 17:09:14,760 - Avg. fwd time: 8.1324 / Avg. bwd-weight time: 10.0481 / Avg. bwd-input time: 9.9938 / Avg. batch time: 1061.2558 (ms) / GPU bubble ratio: 57.52%
[rank0]:2025-12-26 17:09:14,863 -  step: 100  loss:  8.2031  grad_norm: 15.6498  memory: 35.32GiB(74.36%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank3]:2025-12-26 17:09:14,837 -  step: 100  loss: -4.0000  grad_norm: 15.6498  memory: 15.27GiB(32.13%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank1]:2025-12-26 17:09:14,840 -  step: 100  loss: -4.0000  grad_norm: 15.6498  memory: 17.83GiB(37.53%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank2]:2025-12-26 17:09:14,837 -  step: 100  loss: -4.0000  grad_norm: 15.6498  memory: 13.80GiB(29.05%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank3]:2025-12-26 17:09:15,251 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1709_step100_rank3.svg
[rank3]:			> Batch Time: 1116.94 ms, GPU Bubble Ratio: 12.56%, 49.80%, 59.56%, 60.93%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-10-52ms     | [S0,MB6,F]  52-9-62ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-26-200ms   | [S7,MB1,F]  201-16-217ms   | [S7,MB1,BI] 229-34-264ms   | [S7,MB1,BW] 264-30-294ms   | [S7,MB2,F]  294-19-313ms   | [S7,MB2,BI] 325-35-360ms   | [S7,MB2,BW] 360-31-391ms   | [S7,MB3,F]  391-19-411ms   | [S7,MB3,BI] 423-35-458ms   | [S7,MB3,BW] 458-32-490ms   | [S0,MB7,F]  489-10-499ms   | [S0,MB0,B]  500-30-530ms   | [S7,MB4,F]  530-18-549ms   | [S7,MB4,BI] 561-34-595ms   | [S7,MB4,BW] 596-31-627ms   | [S0,MB1,B]  626-29-656ms   | [S7,MB5,F]  657-18-675ms   | [S7,MB5,BI] 687-34-721ms   | [S7,MB5,BW] 721-30-752ms   | [S0,MB2,B]  752-29-782ms   | [S7,MB6,F]  782-18-800ms   | [S7,MB6,BI] 812-34-847ms   | [S7,MB6,BW] 847-30-877ms   | [S0,MB3,B]  876-29-906ms   | [S7,MB7,F]  906-18-924ms   | [S7,MB7,BI] 937-34-971ms   | [S7,MB7,BW] 971-30-1001ms  | [S0,MB4,B]  1002-29-1031ms | [S0,MB5,B]  1032-29-1061ms | [S0,MB6,B]  1061-28-1089ms | [S0,MB7,B]  1089-27-1116ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  193-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-283ms   | [S6,MB3,F]  283-7-290ms    | [S6,MB2,BI] 360-9-369ms    | [S6,MB2,BW] 369-10-380ms   | [S1,MB6,F]  380-10-391ms   | [S1,MB0,BI] 391-15-407ms   | [S1,MB0,BW] 406-15-422ms   | [S6,MB4,F]  422-7-430ms    | [S6,MB3,BI] 458-10-468ms   | [S6,MB3,BW] 468-9-478ms    | [S1,MB7,F]  500-13-514ms   | [S1,MB1,BI] 514-15-529ms   | [S1,MB1,BW] 529-14-544ms   | [S6,MB5,F]  543-7-551ms    | [S6,MB4,BI] 595-10-606ms   | [S6,MB4,BW] 605-9-615ms    | [S1,MB2,BI] 634-14-648ms   | [S1,MB2,BW] 648-14-663ms   | [S6,MB6,F]  730-7-738ms    | [S6,MB5,BI] 737-9-747ms    | [S6,MB5,BW] 747-10-758ms   | [S1,MB3,BI] 761-14-776ms   | [S1,MB3,BW] 775-14-790ms   | [S6,MB7,F]  856-7-864ms    | [S6,MB6,BI] 864-9-873ms    | [S6,MB6,BW] 873-11-884ms   | [S1,MB4,BI] 886-14-900ms   | [S6,MB7,BI] 971-10-981ms   | [S1,MB5,BI] 982-14-997ms   | [S1,MB4,BW] 997-16-1013ms  | [S1,MB6,BI] 1013-14-1027ms | [S1,MB5,BW] 1027-15-1043ms | [S1,MB7,BI] 1042-15-1057ms | [S1,MB6,BW] 1057-16-1074ms | [S6,MB7,BW] 1074-11-1086ms | [S1,MB7,BW] 1085-16-1102ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-210ms    | [S5,MB1,BI] 273-9-282ms    | [S5,MB1,BW] 282-10-293ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-320ms    | [S5,MB4,F]  321-7-328ms    | [S5,MB2,BI] 370-10-380ms   | [S5,MB2,BW] 380-9-390ms    | [S2,MB6,F]  392-9-401ms    | [S2,MB1,BI] 403-10-414ms   | [S2,MB1,BW] 414-9-423ms    | [S5,MB5,F]  424-7-431ms    | [S5,MB3,BI] 506-11-517ms   | [S5,MB3,BW] 517-11-528ms   | [S2,MB7,F]  528-7-535ms    | [S2,MB2,BI] 535-10-545ms   | [S2,MB2,BW] 546-9-555ms    | [S5,MB6,F]  556-7-563ms    | [S5,MB4,BI] 628-10-638ms   | [S5,MB4,BW] 638-9-647ms    | [S2,MB3,BI] 734-9-743ms    | [S2,MB3,BW] 743-10-753ms   | [S5,MB7,F]  761-7-768ms    | [S5,MB5,BI] 769-9-778ms    | [S5,MB5,BW] 778-9-788ms    | [S2,MB4,BI] 860-9-869ms    | [S5,MB6,BI] 878-10-889ms   | [S2,MB5,BI] 889-10-899ms   | [S5,MB7,BI] 985-9-994ms    | [S2,MB6,BI] 994-11-1005ms  | [S2,MB4,BW] 1005-10-1015ms | [S2,MB7,BI] 1020-9-1029ms  | [S2,MB5,BW] 1029-10-1039ms | [S5,MB6,BW] 1040-9-1049ms  | [S5,MB7,BW] 1050-9-1059ms  | [S2,MB6,BW] 1059-9-1068ms  | [S2,MB7,BW] 1069-10-1079ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-211ms    | [S3,MB4,F]  211-7-218ms    | [S3,MB0,BI] 218-9-227ms    | [S3,MB0,BW] 227-9-237ms    | [S4,MB4,F]  237-7-245ms    | [S4,MB1,BI] 282-10-293ms   | [S4,MB1,BW] 292-10-303ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 396-11-407ms   | [S4,MB2,BW] 407-9-417ms    | [S3,MB6,F]  417-7-425ms    | [S3,MB2,BI] 424-9-434ms    | [S3,MB2,BW] 434-9-444ms    | [S4,MB6,F]  444-7-451ms    | [S4,MB3,BI] 520-10-530ms   | [S4,MB3,BW] 530-10-540ms   | [S3,MB7,F]  540-7-548ms    | [S3,MB3,BI] 548-9-557ms    | [S3,MB3,BW] 557-9-566ms    | [S4,MB7,F]  567-7-574ms    | [S4,MB4,BI] 727-10-737ms   | [S4,MB4,BW] 737-9-747ms    | [S3,MB4,BI] 747-10-757ms   | [S4,MB5,BI] 853-9-863ms    | [S3,MB5,BI] 863-9-872ms    | [S4,MB6,BI] 889-9-898ms    | [S3,MB6,BI] 898-9-907ms    | [S4,MB7,BI] 995-9-1004ms   | [S3,MB7,BI] 1004-9-1013ms  | [S3,MB4,BW] 1013-10-1023ms | [S4,MB5,BW] 1024-9-1033ms  | [S4,MB6,BW] 1033-9-1043ms  | [S4,MB7,BW] 1043-9-1052ms  | [S3,MB5,BW] 1053-10-1063ms | [S3,MB6,BW] 1063-10-1073ms | [S3,MB7,BW] 1073-10-1083ms
[rank0]:2025-12-26 17:13:03,401 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 17:13:08,281 - Avg. fwd time: 8.1269 / Avg. bwd-weight time: 10.0581 / Avg. bwd-input time: 10.0023 / Avg. batch time: 1063.3777 (ms) / GPU bubble ratio: 57.59%
[rank3]:2025-12-26 17:13:08,290 - Avg. fwd time: 7.7648 / Avg. bwd-weight time: 9.8896 / Avg. bwd-input time: 9.6309 / Avg. batch time: 1059.5445 (ms) / GPU bubble ratio: 58.80%
[rank3]:2025-12-26 17:13:08,356 -  step: 150  loss: -4.0000  grad_norm: 25.9114  memory: 15.27GiB(32.13%)  tps: 7,016  tflops: 54.85  mfu: 17.58%
[rank0]:2025-12-26 17:13:08,310 - Avg. fwd time: 13.7866 / Avg. full-bwd time: 29.3113 (Avg. bwd-weight time: 30.4098 / Avg. bwd-input time: 34.6514) / Avg. batch time: 1122.5524 (ms) / GPU bubble ratio: 13.09%
[rank0]:2025-12-26 17:13:08,383 -  step: 150  loss:  2.9157  grad_norm: 25.9114  memory: 35.32GiB(74.36%)  tps: 7,016  tflops: 54.85  mfu: 17.58%
[rank1]:2025-12-26 17:13:08,301 - Avg. fwd time: 9.8416 / Avg. bwd-weight time: 12.9803 / Avg. bwd-input time: 12.2288 / Avg. batch time: 1099.0024 (ms) / GPU bubble ratio: 48.97%
[rank1]:2025-12-26 17:13:08,359 -  step: 150  loss: -4.0000  grad_norm: 25.9114  memory: 17.83GiB(37.53%)  tps: 7,016  tflops: 54.85  mfu: 17.58%
[rank2]:2025-12-26 17:13:08,356 -  step: 150  loss: -4.0000  grad_norm: 25.9114  memory: 13.80GiB(29.05%)  tps: 7,016  tflops: 54.85  mfu: 17.58%
[rank0]:2025-12-26 17:16:56,433 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 17:17:01,355 - Avg. fwd time: 7.7624 / Avg. bwd-weight time: 9.8997 / Avg. bwd-input time: 9.6532 / Avg. batch time: 1060.1788 (ms) / GPU bubble ratio: 58.78%
[rank0]:2025-12-26 17:17:01,382 - Avg. fwd time: 13.8027 / Avg. full-bwd time: 29.3479 (Avg. bwd-weight time: 30.4466 / Avg. bwd-input time: 34.6599) / Avg. batch time: 1123.2259 (ms) / GPU bubble ratio: 13.06%
[rank1]:2025-12-26 17:17:01,370 - Avg. fwd time: 9.8391 / Avg. bwd-weight time: 12.9971 / Avg. bwd-input time: 12.2620 / Avg. batch time: 1099.6565 (ms) / GPU bubble ratio: 48.93%
[rank2]:2025-12-26 17:17:01,347 - Avg. fwd time: 8.1228 / Avg. bwd-weight time: 10.0654 / Avg. bwd-input time: 10.0216 / Avg. batch time: 1063.8624 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-12-26 17:17:01,428 -  step: 200  loss: -4.0000  grad_norm: 15.2826  memory: 15.27GiB(32.13%)  tps: 7,030  tflops: 54.95  mfu: 17.61%
[rank0]:2025-12-26 17:17:01,455 -  step: 200  loss:  1.0064  grad_norm: 15.2826  memory: 35.32GiB(74.36%)  tps: 7,030  tflops: 54.95  mfu: 17.61%
[rank1]:2025-12-26 17:17:01,432 -  step: 200  loss: -4.0000  grad_norm: 15.2826  memory: 17.83GiB(37.53%)  tps: 7,030  tflops: 54.95  mfu: 17.61%
[rank2]:2025-12-26 17:17:01,428 -  step: 200  loss: -4.0000  grad_norm: 15.2826  memory: 13.80GiB(29.05%)  tps: 7,030  tflops: 54.95  mfu: 17.61%
[rank3]:2025-12-26 17:17:01,803 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1717_step200_rank3.svg
[rank3]:			> Batch Time: 1123.11 ms, GPU Bubble Ratio: 12.86%, 49.68%, 59.64%, 60.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 175-26-201ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 229-35-264ms   | [S7,MB1,BW] 264-30-294ms   | [S7,MB2,F]  296-19-315ms   | [S7,MB2,BI] 327-35-362ms   | [S7,MB2,BW] 362-30-393ms   | [S7,MB3,F]  394-19-413ms   | [S7,MB3,BI] 425-35-460ms   | [S7,MB3,BW] 460-32-492ms   | [S0,MB7,F]  492-10-502ms   | [S0,MB0,B]  503-30-533ms   | [S7,MB4,F]  532-18-550ms   | [S7,MB4,BI] 563-34-597ms   | [S7,MB4,BW] 597-32-629ms   | [S0,MB1,B]  629-30-659ms   | [S7,MB5,F]  660-18-678ms   | [S7,MB5,BI] 690-34-725ms   | [S7,MB5,BW] 724-30-754ms   | [S0,MB2,B]  755-29-785ms   | [S7,MB6,F]  785-19-804ms   | [S7,MB6,BI] 816-34-850ms   | [S7,MB6,BW] 851-29-880ms   | [S0,MB3,B]  880-30-910ms   | [S7,MB7,F]  910-18-929ms   | [S7,MB7,BI] 941-34-976ms   | [S7,MB7,BW] 976-31-1007ms  | [S0,MB4,B]  1006-30-1036ms | [S0,MB5,B]  1037-29-1066ms | [S0,MB6,B]  1066-28-1094ms | [S0,MB7,B]  1095-28-1123ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 362-9-371ms    | [S6,MB2,BW] 371-10-382ms   | [S1,MB6,F]  382-10-393ms   | [S1,MB0,BI] 393-15-409ms   | [S1,MB0,BW] 409-15-424ms   | [S6,MB4,F]  424-8-433ms    | [S6,MB3,BI] 460-10-470ms   | [S6,MB3,BW] 470-9-480ms    | [S1,MB7,F]  503-13-517ms   | [S1,MB1,BI] 516-15-532ms   | [S1,MB1,BW] 532-14-547ms   | [S6,MB5,F]  547-7-555ms    | [S6,MB4,BI] 597-10-607ms   | [S6,MB4,BW] 607-9-617ms    | [S1,MB2,BI] 637-14-652ms   | [S1,MB2,BW] 651-14-666ms   | [S6,MB6,F]  734-7-741ms    | [S6,MB5,BI] 741-9-751ms    | [S6,MB5,BW] 751-10-762ms   | [S1,MB3,BI] 765-14-779ms   | [S1,MB3,BW] 779-14-794ms   | [S6,MB7,F]  860-7-868ms    | [S6,MB6,BI] 867-9-877ms    | [S6,MB6,BW] 877-11-888ms   | [S1,MB4,BI] 889-14-904ms   | [S6,MB7,BI] 975-10-986ms   | [S1,MB5,BI] 987-15-1002ms  | [S1,MB4,BW] 1002-15-1018ms | [S1,MB6,BI] 1018-14-1032ms | [S1,MB5,BW] 1032-15-1048ms | [S1,MB7,BI] 1047-15-1063ms | [S1,MB6,BW] 1063-16-1080ms | [S6,MB7,BW] 1079-11-1091ms | [S1,MB7,BW] 1091-17-1108ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-10-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 372-10-382ms   | [S5,MB2,BW] 382-9-392ms    | [S2,MB6,F]  394-9-404ms    | [S2,MB1,BI] 406-10-416ms   | [S2,MB1,BW] 416-9-426ms    | [S5,MB5,F]  426-7-433ms    | [S5,MB3,BI] 508-11-519ms   | [S5,MB3,BW] 519-11-530ms   | [S2,MB7,F]  530-7-538ms    | [S2,MB2,BI] 538-10-548ms   | [S2,MB2,BW] 548-9-558ms    | [S5,MB6,F]  558-7-565ms    | [S5,MB4,BI] 630-10-641ms   | [S5,MB4,BW] 641-9-651ms    | [S2,MB3,BI] 737-9-747ms    | [S2,MB3,BW] 747-10-757ms   | [S5,MB7,F]  765-7-772ms    | [S5,MB5,BI] 772-9-782ms    | [S5,MB5,BW] 782-9-791ms    | [S2,MB4,BI] 864-9-873ms    | [S5,MB6,BI] 882-10-893ms   | [S2,MB5,BI] 893-10-903ms   | [S5,MB7,BI] 990-9-999ms    | [S2,MB6,BI] 999-10-1010ms  | [S2,MB4,BW] 1010-10-1021ms | [S2,MB7,BI] 1025-9-1035ms  | [S2,MB5,BW] 1035-10-1045ms | [S5,MB6,BW] 1045-9-1054ms  | [S5,MB7,BW] 1055-9-1064ms  | [S2,MB6,BW] 1065-9-1075ms  | [S2,MB7,BW] 1075-10-1085ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  239-8-247ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  332-7-339ms    | [S4,MB2,BI] 399-11-410ms   | [S4,MB2,BW] 410-9-420ms    | [S3,MB6,F]  420-7-427ms    | [S3,MB2,BI] 427-9-437ms    | [S3,MB2,BW] 437-9-446ms    | [S4,MB6,F]  446-7-454ms    | [S4,MB3,BI] 522-10-532ms   | [S4,MB3,BW] 532-10-543ms   | [S3,MB7,F]  543-7-550ms    | [S3,MB3,BI] 550-9-560ms    | [S3,MB3,BW] 560-9-569ms    | [S4,MB7,F]  570-7-577ms    | [S4,MB4,BI] 731-10-741ms   | [S4,MB4,BW] 741-9-750ms    | [S3,MB4,BI] 751-10-761ms   | [S4,MB5,BI] 857-10-867ms   | [S3,MB5,BI] 867-9-877ms    | [S4,MB6,BI] 893-9-903ms    | [S3,MB6,BI] 902-9-912ms    | [S4,MB7,BI] 1001-9-1010ms  | [S3,MB7,BI] 1010-9-1019ms  | [S3,MB4,BW] 1019-10-1030ms | [S4,MB5,BW] 1029-9-1039ms  | [S4,MB6,BW] 1039-9-1049ms  | [S4,MB7,BW] 1049-9-1059ms  | [S3,MB5,BW] 1059-10-1069ms | [S3,MB6,BW] 1069-10-1079ms | [S3,MB7,BW] 1079-10-1090ms
[rank0]:2025-12-26 17:20:49,803 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 17:20:54,637 - Avg. fwd time: 7.7575 / Avg. bwd-weight time: 9.9062 / Avg. bwd-input time: 9.6720 / Avg. batch time: 1060.5871 (ms) / GPU bubble ratio: 58.76%
[rank0]:2025-12-26 17:20:54,655 - Avg. fwd time: 13.8103 / Avg. full-bwd time: 29.3630 (Avg. bwd-weight time: 30.4638 / Avg. bwd-input time: 34.6641) / Avg. batch time: 1123.8147 (ms) / GPU bubble ratio: 13.07%
[rank1]:2025-12-26 17:20:54,648 - Avg. fwd time: 9.8345 / Avg. bwd-weight time: 13.0048 / Avg. bwd-input time: 12.2820 / Avg. batch time: 1100.2798 (ms) / GPU bubble ratio: 48.93%
[rank2]:2025-12-26 17:20:54,627 - Avg. fwd time: 8.1189 / Avg. bwd-weight time: 10.0681 / Avg. bwd-input time: 10.0394 / Avg. batch time: 1064.4701 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-12-26 17:20:54,702 -  step: 250  loss: -4.0000  grad_norm:  3.2900  memory: 15.27GiB(32.13%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank0]:2025-12-26 17:20:54,728 -  step: 250  loss:  0.3507  grad_norm:  3.2900  memory: 35.32GiB(74.36%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank1]:2025-12-26 17:20:54,705 -  step: 250  loss: -4.0000  grad_norm:  3.2900  memory: 17.83GiB(37.53%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank2]:2025-12-26 17:20:54,702 -  step: 250  loss: -4.0000  grad_norm:  3.2900  memory: 13.80GiB(29.05%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank0]:2025-12-26 17:24:42,521 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 17:24:47,325 - Avg. fwd time: 7.7526 / Avg. bwd-weight time: 9.9088 / Avg. bwd-input time: 9.6842 / Avg. batch time: 1060.6128 (ms) / GPU bubble ratio: 58.75%
[rank1]:2025-12-26 17:24:47,338 - Avg. fwd time: 9.8291 / Avg. bwd-weight time: 13.0072 / Avg. bwd-input time: 12.2922 / Avg. batch time: 1100.1802 (ms) / GPU bubble ratio: 48.91%
[rank2]:2025-12-26 17:24:47,317 - Avg. fwd time: 8.1143 / Avg. bwd-weight time: 10.0698 / Avg. bwd-input time: 10.0501 / Avg. batch time: 1064.3904 (ms) / GPU bubble ratio: 57.56%
[rank0]:2025-12-26 17:24:47,347 - Avg. fwd time: 13.8103 / Avg. full-bwd time: 29.3701 (Avg. bwd-weight time: 30.4663 / Avg. bwd-input time: 34.6622) / Avg. batch time: 1123.7280 (ms) / GPU bubble ratio: 13.06%
[rank3]:2025-12-26 17:24:47,392 -  step: 300  loss: -4.0000  grad_norm:  0.5518  memory: 15.27GiB(32.13%)  tps: 7,041  tflops: 55.04  mfu: 17.64%
[rank2]:2025-12-26 17:24:47,392 -  step: 300  loss: -4.0000  grad_norm:  0.5518  memory: 13.80GiB(29.05%)  tps: 7,041  tflops: 55.04  mfu: 17.64%
[rank1]:2025-12-26 17:24:47,396 -  step: 300  loss: -4.0000  grad_norm:  0.5518  memory: 17.83GiB(37.53%)  tps: 7,041  tflops: 55.04  mfu: 17.64%
[rank0]:2025-12-26 17:24:47,419 -  step: 300  loss:  0.2538  grad_norm:  0.5518  memory: 35.32GiB(74.36%)  tps: 7,041  tflops: 55.04  mfu: 17.64%
[rank3]:2025-12-26 17:24:47,771 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1724_step300_rank3.svg
[rank3]:			> Batch Time: 1120.12 ms, GPU Bubble Ratio: 12.86%, 49.78%, 59.57%, 60.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-10-52ms     | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  112-17-130ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-26-201ms   | [S7,MB1,F]  201-17-218ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-30-295ms   | [S7,MB2,F]  295-19-314ms   | [S7,MB2,BI] 326-35-361ms   | [S7,MB2,BW] 361-31-392ms   | [S7,MB3,F]  392-19-411ms   | [S7,MB3,BI] 423-35-458ms   | [S7,MB3,BW] 458-32-490ms   | [S0,MB7,F]  490-10-500ms   | [S0,MB0,B]  500-30-531ms   | [S7,MB4,F]  530-18-548ms   | [S7,MB4,BI] 560-34-595ms   | [S7,MB4,BW] 594-31-626ms   | [S0,MB1,B]  627-30-657ms   | [S7,MB5,F]  656-18-675ms   | [S7,MB5,BI] 687-34-722ms   | [S7,MB5,BW] 722-30-752ms   | [S0,MB2,B]  752-29-782ms   | [S7,MB6,F]  782-18-800ms   | [S7,MB6,BI] 813-34-847ms   | [S7,MB6,BW] 847-30-877ms   | [S0,MB3,B]  877-29-907ms   | [S7,MB7,F]  907-18-926ms   | [S7,MB7,BI] 938-34-973ms   | [S7,MB7,BW] 973-30-1003ms  | [S0,MB4,B]  1005-29-1034ms | [S0,MB5,B]  1035-29-1064ms | [S0,MB6,B]  1064-28-1092ms | [S0,MB7,B]  1092-28-1120ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-72ms     | [S1,MB4,F]  85-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 361-9-370ms    | [S6,MB2,BW] 370-10-381ms   | [S1,MB6,F]  381-10-392ms   | [S1,MB0,BI] 392-15-408ms   | [S1,MB0,BW] 408-15-423ms   | [S6,MB4,F]  424-8-432ms    | [S6,MB3,BI] 459-10-469ms   | [S6,MB3,BW] 469-9-479ms    | [S1,MB7,F]  501-13-515ms   | [S1,MB1,BI] 514-15-530ms   | [S1,MB1,BW] 530-14-545ms   | [S6,MB5,F]  545-7-553ms    | [S6,MB4,BI] 594-10-605ms   | [S6,MB4,BW] 604-9-614ms    | [S1,MB2,BI] 634-14-649ms   | [S1,MB2,BW] 648-14-663ms   | [S6,MB6,F]  731-7-739ms    | [S6,MB5,BI] 739-9-748ms    | [S6,MB5,BW] 748-10-759ms   | [S1,MB3,BI] 761-14-776ms   | [S1,MB3,BW] 776-14-791ms   | [S6,MB7,F]  857-7-865ms    | [S6,MB6,BI] 864-9-874ms    | [S6,MB6,BW] 874-11-885ms   | [S1,MB4,BI] 887-14-902ms   | [S6,MB7,BI] 973-10-983ms   | [S1,MB5,BI] 983-15-999ms   | [S1,MB4,BW] 998-16-1015ms  | [S1,MB6,BI] 1014-14-1029ms | [S1,MB5,BW] 1029-15-1045ms | [S1,MB7,BI] 1044-15-1060ms | [S1,MB6,BW] 1059-16-1076ms | [S6,MB7,BW] 1076-11-1088ms | [S1,MB7,BW] 1088-16-1105ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 274-9-284ms    | [S5,MB1,BW] 284-10-294ms   | [S2,MB5,F]  294-7-302ms    | [S2,MB0,BI] 302-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 371-10-381ms   | [S5,MB2,BW] 381-9-391ms    | [S2,MB6,F]  393-9-403ms    | [S2,MB1,BI] 404-10-415ms   | [S2,MB1,BW] 415-9-425ms    | [S5,MB5,F]  425-7-432ms    | [S5,MB3,BI] 506-11-517ms   | [S5,MB3,BW] 517-11-528ms   | [S2,MB7,F]  528-7-536ms    | [S2,MB2,BI] 536-10-546ms   | [S2,MB2,BW] 546-9-556ms    | [S5,MB6,F]  556-7-564ms    | [S5,MB4,BI] 628-10-638ms   | [S5,MB4,BW] 638-9-648ms    | [S2,MB3,BI] 735-9-744ms    | [S2,MB3,BW] 744-10-754ms   | [S5,MB7,F]  762-7-769ms    | [S5,MB5,BI] 769-9-778ms    | [S5,MB5,BW] 778-9-788ms    | [S2,MB4,BI] 860-9-870ms    | [S5,MB6,BI] 879-10-890ms   | [S2,MB5,BI] 890-10-900ms   | [S5,MB7,BI] 987-9-996ms    | [S2,MB6,BI] 996-11-1007ms  | [S2,MB4,BW] 1007-10-1017ms | [S2,MB7,BI] 1022-9-1031ms  | [S2,MB5,BW] 1031-10-1041ms | [S5,MB6,BW] 1042-9-1051ms  | [S5,MB7,BW] 1052-9-1061ms  | [S2,MB6,BW] 1062-9-1072ms  | [S2,MB7,BW] 1072-10-1082ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  419-7-426ms    | [S3,MB2,BI] 426-9-435ms    | [S3,MB2,BW] 435-9-445ms    | [S4,MB6,F]  445-7-453ms    | [S4,MB3,BI] 520-10-530ms   | [S4,MB3,BW] 530-10-541ms   | [S3,MB7,F]  540-7-548ms    | [S3,MB3,BI] 548-9-557ms    | [S3,MB3,BW] 557-9-567ms    | [S4,MB7,F]  567-7-574ms    | [S4,MB4,BI] 728-10-739ms   | [S4,MB4,BW] 739-9-748ms    | [S3,MB4,BI] 748-10-759ms   | [S4,MB5,BI] 854-10-864ms   | [S3,MB5,BI] 864-9-873ms    | [S4,MB6,BI] 890-9-900ms    | [S3,MB6,BI] 900-9-909ms    | [S4,MB7,BI] 997-9-1006ms   | [S3,MB7,BI] 1006-9-1015ms  | [S3,MB4,BW] 1015-10-1025ms | [S4,MB5,BW] 1025-9-1035ms  | [S4,MB6,BW] 1035-9-1045ms  | [S4,MB7,BW] 1045-9-1055ms  | [S3,MB5,BW] 1055-10-1065ms | [S3,MB6,BW] 1065-10-1075ms | [S3,MB7,BW] 1076-10-1087ms
[rank0]:2025-12-26 17:28:35,291 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 17:28:40,139 - Avg. fwd time: 8.1115 / Avg. bwd-weight time: 10.0689 / Avg. bwd-input time: 10.0568 / Avg. batch time: 1064.4317 (ms) / GPU bubble ratio: 57.56%
[rank3]:2025-12-26 17:28:40,148 - Avg. fwd time: 7.7485 / Avg. bwd-weight time: 9.9090 / Avg. bwd-input time: 9.6904 / Avg. batch time: 1060.5004 (ms) / GPU bubble ratio: 58.74%
[rank1]:2025-12-26 17:28:40,159 - Avg. fwd time: 9.8260 / Avg. bwd-weight time: 13.0082 / Avg. bwd-input time: 12.2974 / Avg. batch time: 1100.2216 (ms) / GPU bubble ratio: 48.91%
[rank0]:2025-12-26 17:28:40,171 - Avg. fwd time: 13.8086 / Avg. full-bwd time: 29.3723 (Avg. bwd-weight time: 30.4626 / Avg. bwd-input time: 34.6559) / Avg. batch time: 1123.7646 (ms) / GPU bubble ratio: 13.07%
[rank3]:2025-12-26 17:28:40,217 -  step: 350  loss: -4.0000  grad_norm:  0.1993  memory: 15.27GiB(32.13%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank2]:2025-12-26 17:28:40,217 -  step: 350  loss: -4.0000  grad_norm:  0.1993  memory: 13.80GiB(29.05%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank1]:2025-12-26 17:28:40,221 -  step: 350  loss: -4.0000  grad_norm:  0.1993  memory: 17.83GiB(37.53%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank0]:2025-12-26 17:28:40,244 -  step: 350  loss:  0.2111  grad_norm:  0.1993  memory: 35.32GiB(74.36%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank0]:2025-12-26 17:32:27,366 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 17:32:32,252 - Avg. fwd time: 7.7464 / Avg. bwd-weight time: 9.9090 / Avg. bwd-input time: 9.6935 / Avg. batch time: 1060.2085 (ms) / GPU bubble ratio: 58.73%
[rank2]:2025-12-26 17:32:32,243 - Avg. fwd time: 8.1099 / Avg. bwd-weight time: 10.0681 / Avg. bwd-input time: 10.0604 / Avg. batch time: 1064.0626 (ms) / GPU bubble ratio: 57.54%
[rank1]:2025-12-26 17:32:32,263 - Avg. fwd time: 9.8247 / Avg. bwd-weight time: 13.0097 / Avg. bwd-input time: 12.2987 / Avg. batch time: 1099.8471 (ms) / GPU bubble ratio: 48.89%
[rank1]:2025-12-26 17:32:32,322 -  step: 400  loss: -4.0000  grad_norm:  0.1762  memory: 17.83GiB(37.53%)  tps: 7,059  tflops: 55.18  mfu: 17.69%
[rank0]:2025-12-26 17:32:32,273 - Avg. fwd time: 13.8043 / Avg. full-bwd time: 29.3648 (Avg. bwd-weight time: 30.4513 / Avg. bwd-input time: 34.6428) / Avg. batch time: 1123.3414 (ms) / GPU bubble ratio: 13.07%
[rank0]:2025-12-26 17:32:32,345 -  step: 400  loss:  0.2041  grad_norm:  0.1762  memory: 35.32GiB(74.36%)  tps: 7,059  tflops: 55.18  mfu: 17.69%
[rank3]:2025-12-26 17:32:32,319 -  step: 400  loss: -4.0000  grad_norm:  0.1762  memory: 15.27GiB(32.13%)  tps: 7,059  tflops: 55.18  mfu: 17.69%
[rank2]:2025-12-26 17:32:32,319 -  step: 400  loss: -4.0000  grad_norm:  0.1762  memory: 13.80GiB(29.05%)  tps: 7,059  tflops: 55.18  mfu: 17.69%
[rank3]:2025-12-26 17:32:32,696 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1732_step400_rank3.svg
[rank3]:			> Batch Time: 1121.97 ms, GPU Bubble Ratio: 13.05%, 49.83%, 59.67%, 60.91%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-10-52ms     | [S0,MB6,F]  52-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 175-27-202ms   | [S7,MB1,F]  202-17-219ms   | [S7,MB1,BI] 231-34-266ms   | [S7,MB1,BW] 266-29-296ms   | [S7,MB2,F]  296-19-315ms   | [S7,MB2,BI] 327-35-362ms   | [S7,MB2,BW] 361-30-392ms   | [S7,MB3,F]  393-19-412ms   | [S7,MB3,BI] 424-34-459ms   | [S7,MB3,BW] 459-31-491ms   | [S0,MB7,F]  490-10-500ms   | [S0,MB0,B]  500-30-530ms   | [S7,MB4,F]  530-18-549ms   | [S7,MB4,BI] 561-34-595ms   | [S7,MB4,BW] 596-32-628ms   | [S0,MB1,B]  628-29-657ms   | [S7,MB5,F]  658-18-676ms   | [S7,MB5,BI] 689-34-723ms   | [S7,MB5,BW] 723-30-753ms   | [S0,MB2,B]  754-29-783ms   | [S7,MB6,F]  783-19-802ms   | [S7,MB6,BI] 814-34-849ms   | [S7,MB6,BW] 849-29-879ms   | [S0,MB3,B]  879-30-909ms   | [S7,MB7,F]  909-18-927ms   | [S7,MB7,BI] 939-34-974ms   | [S7,MB7,BW] 974-30-1004ms  | [S0,MB4,B]  1006-30-1036ms | [S0,MB5,B]  1036-29-1065ms | [S0,MB6,B]  1065-28-1093ms | [S0,MB7,B]  1094-27-1121ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 266-9-275ms    | [S6,MB1,BW] 275-10-286ms   | [S6,MB3,F]  286-7-293ms    | [S6,MB2,BI] 361-9-371ms    | [S6,MB2,BW] 371-10-382ms   | [S1,MB6,F]  382-10-393ms   | [S1,MB0,BI] 392-15-408ms   | [S1,MB0,BW] 408-15-424ms   | [S6,MB4,F]  423-8-432ms    | [S6,MB3,BI] 459-10-470ms   | [S6,MB3,BW] 470-9-479ms    | [S1,MB7,F]  501-13-514ms   | [S1,MB1,BI] 514-15-530ms   | [S1,MB1,BW] 530-14-545ms   | [S6,MB5,F]  545-7-553ms    | [S6,MB4,BI] 596-10-606ms   | [S6,MB4,BW] 606-9-616ms    | [S1,MB2,BI] 636-14-650ms   | [S1,MB2,BW] 650-14-665ms   | [S6,MB6,F]  733-7-740ms    | [S6,MB5,BI] 740-9-749ms    | [S6,MB5,BW] 749-10-760ms   | [S1,MB3,BI] 763-14-778ms   | [S1,MB3,BW] 778-14-793ms   | [S6,MB7,F]  858-7-866ms    | [S6,MB6,BI] 865-9-875ms    | [S6,MB6,BW] 875-11-886ms   | [S1,MB4,BI] 888-14-903ms   | [S6,MB7,BI] 974-10-984ms   | [S1,MB5,BI] 984-15-1000ms  | [S1,MB4,BW] 999-16-1016ms  | [S1,MB6,BI] 1015-14-1030ms | [S1,MB5,BW] 1029-15-1045ms | [S1,MB7,BI] 1045-15-1061ms | [S1,MB6,BW] 1060-16-1077ms | [S6,MB7,BW] 1077-11-1089ms | [S1,MB7,BW] 1089-16-1106ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 276-9-285ms    | [S5,MB1,BW] 285-10-296ms   | [S2,MB5,F]  296-7-303ms    | [S2,MB0,BI] 303-10-314ms   | [S2,MB0,BW] 314-9-324ms    | [S5,MB4,F]  323-7-331ms    | [S5,MB2,BI] 371-10-381ms   | [S5,MB2,BW] 381-9-391ms    | [S2,MB6,F]  393-9-403ms    | [S2,MB1,BI] 405-10-415ms   | [S2,MB1,BW] 415-9-425ms    | [S5,MB5,F]  425-7-432ms    | [S5,MB3,BI] 506-11-517ms   | [S5,MB3,BW] 517-11-528ms   | [S2,MB7,F]  528-7-536ms    | [S2,MB2,BI] 536-10-546ms   | [S2,MB2,BW] 546-9-556ms    | [S5,MB6,F]  556-7-564ms    | [S5,MB4,BI] 629-10-640ms   | [S5,MB4,BW] 640-9-649ms    | [S2,MB3,BI] 736-9-746ms    | [S2,MB3,BW] 746-10-756ms   | [S5,MB7,F]  763-7-770ms    | [S5,MB5,BI] 771-9-780ms    | [S5,MB5,BW] 780-9-790ms    | [S2,MB4,BI] 862-9-871ms    | [S5,MB6,BI] 880-10-891ms   | [S2,MB5,BI] 891-10-901ms   | [S5,MB7,BI] 988-9-997ms    | [S2,MB6,BI] 997-10-1008ms  | [S2,MB4,BW] 1007-10-1018ms | [S2,MB7,BI] 1022-9-1032ms  | [S2,MB5,BW] 1032-10-1042ms | [S5,MB6,BW] 1043-9-1052ms  | [S5,MB7,BW] 1053-9-1062ms  | [S2,MB6,BW] 1063-9-1073ms  | [S2,MB7,BW] 1073-10-1083ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  239-7-246ms    | [S4,MB1,BI] 285-10-295ms   | [S4,MB1,BW] 295-10-306ms   | [S3,MB5,F]  306-8-314ms    | [S3,MB1,BI] 314-9-323ms    | [S3,MB1,BW] 323-9-333ms    | [S4,MB5,F]  333-7-340ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  419-7-426ms    | [S3,MB2,BI] 426-9-435ms    | [S3,MB2,BW] 435-9-445ms    | [S4,MB6,F]  445-7-453ms    | [S4,MB3,BI] 521-10-531ms   | [S4,MB3,BW] 531-10-541ms   | [S3,MB7,F]  541-7-549ms    | [S3,MB3,BI] 548-9-558ms    | [S3,MB3,BW] 558-9-567ms    | [S4,MB7,F]  568-7-576ms    | [S4,MB4,BI] 729-10-740ms   | [S4,MB4,BW] 740-9-749ms    | [S3,MB4,BI] 750-10-760ms   | [S4,MB5,BI] 855-10-865ms   | [S3,MB5,BI] 865-9-874ms    | [S4,MB6,BI] 891-9-901ms    | [S3,MB6,BI] 901-9-910ms    | [S4,MB7,BI] 997-9-1006ms   | [S3,MB7,BI] 1007-9-1016ms  | [S3,MB4,BW] 1016-10-1026ms | [S4,MB5,BW] 1026-9-1036ms  | [S4,MB6,BW] 1036-9-1046ms  | [S4,MB7,BW] 1046-9-1056ms  | [S3,MB5,BW] 1056-10-1066ms | [S3,MB6,BW] 1066-10-1076ms | [S3,MB7,BW] 1077-10-1088ms
[rank0]:2025-12-26 17:32:58,946 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-26 17:32:59,175 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-26 17:32:59,162 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-26 17:32:59,154 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-26 17:36:19,404 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 17:36:24,194 - Avg. fwd time: 8.1078 / Avg. bwd-weight time: 10.0669 / Avg. bwd-input time: 10.0632 / Avg. batch time: 1063.7484 (ms) / GPU bubble ratio: 57.53%
[rank1]:2025-12-26 17:36:24,216 - Avg. fwd time: 9.8225 / Avg. bwd-weight time: 13.0112 / Avg. bwd-input time: 12.2991 / Avg. batch time: 1099.5288 (ms) / GPU bubble ratio: 48.88%
[rank0]:2025-12-26 17:36:24,226 - Avg. fwd time: 13.7977 / Avg. full-bwd time: 29.3531 (Avg. bwd-weight time: 30.4241 / Avg. bwd-input time: 34.6301) / Avg. batch time: 1122.9252 (ms) / GPU bubble ratio: 13.08%
[rank3]:2025-12-26 17:36:24,202 - Avg. fwd time: 7.7442 / Avg. bwd-weight time: 9.9088 / Avg. bwd-input time: 9.6952 / Avg. batch time: 1059.7883 (ms) / GPU bubble ratio: 58.71%
[rank2]:2025-12-26 17:36:24,272 -  step: 450  loss: -4.0000  grad_norm:  0.2060  memory: 13.80GiB(29.05%)  tps: 7,064  tflops: 55.22  mfu: 17.70%
[rank1]:2025-12-26 17:36:24,275 -  step: 450  loss: -4.0000  grad_norm:  0.2060  memory: 17.83GiB(37.53%)  tps: 7,064  tflops: 55.22  mfu: 17.70%
[rank0]:2025-12-26 17:36:24,298 -  step: 450  loss:  0.2175  grad_norm:  0.2060  memory: 35.32GiB(74.36%)  tps: 7,064  tflops: 55.22  mfu: 17.70%
[rank3]:2025-12-26 17:36:24,272 -  step: 450  loss: -4.0000  grad_norm:  0.2060  memory: 15.27GiB(32.13%)  tps: 7,064  tflops: 55.22  mfu: 17.70%
[rank0]:2025-12-26 17:40:11,024 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 17:40:15,832 - Avg. fwd time: 7.7416 / Avg. bwd-weight time: 9.9076 / Avg. bwd-input time: 9.6962 / Avg. batch time: 1059.4693 (ms) / GPU bubble ratio: 58.70%
[rank1]:2025-12-26 17:40:15,845 - Avg. fwd time: 9.8206 / Avg. bwd-weight time: 13.0116 / Avg. bwd-input time: 12.2993 / Avg. batch time: 1099.1388 (ms) / GPU bubble ratio: 48.86%
[rank2]:2025-12-26 17:40:15,824 - Avg. fwd time: 8.1054 / Avg. bwd-weight time: 10.0647 / Avg. bwd-input time: 10.0659 / Avg. batch time: 1063.3609 (ms) / GPU bubble ratio: 57.51%
[rank2]:2025-12-26 17:40:15,900 -  step: 500  loss: -4.0000  grad_norm:  0.1910  memory: 13.80GiB(29.05%)  tps: 7,073  tflops: 55.30  mfu: 17.72%
[rank3]:2025-12-26 17:40:15,900 -  step: 500  loss: -4.0000  grad_norm:  0.1910  memory: 15.27GiB(32.13%)  tps: 7,073  tflops: 55.30  mfu: 17.72%
[rank0]:2025-12-26 17:40:15,854 - Avg. fwd time: 13.7915 / Avg. full-bwd time: 29.3430 (Avg. bwd-weight time: 30.4059 / Avg. bwd-input time: 34.6182) / Avg. batch time: 1122.4343 (ms) / GPU bubble ratio: 13.08%
[rank0]:2025-12-26 17:40:15,927 -  step: 500  loss:  0.2107  grad_norm:  0.1910  memory: 35.32GiB(74.36%)  tps: 7,073  tflops: 55.30  mfu: 17.72%
[rank1]:2025-12-26 17:40:15,904 -  step: 500  loss: -4.0000  grad_norm:  0.1910  memory: 17.83GiB(37.53%)  tps: 7,073  tflops: 55.30  mfu: 17.72%
[rank3]:2025-12-26 17:40:16,316 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1740_step500_rank3.svg
[rank3]:			> Batch Time: 1116.09 ms, GPU Bubble Ratio: 12.73%, 49.64%, 59.49%, 60.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-10-52ms     | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-27-201ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-29-294ms   | [S7,MB2,F]  294-19-313ms   | [S7,MB2,BI] 325-34-360ms   | [S7,MB2,BW] 360-31-392ms   | [S7,MB3,F]  391-19-410ms   | [S7,MB3,BI] 422-34-457ms   | [S7,MB3,BW] 457-32-489ms   | [S0,MB7,F]  489-10-499ms   | [S0,MB0,B]  499-30-529ms   | [S7,MB4,F]  528-18-546ms   | [S7,MB4,BI] 559-34-593ms   | [S7,MB4,BW] 594-31-625ms   | [S0,MB1,B]  625-30-655ms   | [S7,MB5,F]  655-18-673ms   | [S7,MB5,BI] 685-34-720ms   | [S7,MB5,BW] 719-30-750ms   | [S0,MB2,B]  751-29-781ms   | [S7,MB6,F]  780-18-799ms   | [S7,MB6,BI] 811-34-845ms   | [S7,MB6,BW] 845-30-875ms   | [S0,MB3,B]  875-29-904ms   | [S7,MB7,F]  905-18-923ms   | [S7,MB7,BI] 935-34-970ms   | [S7,MB7,BW] 970-30-1000ms  | [S0,MB4,B]  1000-29-1030ms | [S0,MB5,B]  1030-29-1059ms | [S0,MB6,B]  1059-28-1087ms | [S0,MB7,B]  1088-28-1116ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 360-9-369ms    | [S6,MB2,BW] 369-10-380ms   | [S1,MB6,F]  380-10-391ms   | [S1,MB0,BI] 391-15-407ms   | [S1,MB0,BW] 407-15-422ms   | [S6,MB4,F]  422-7-430ms    | [S6,MB3,BI] 457-10-468ms   | [S6,MB3,BW] 468-9-477ms    | [S1,MB7,F]  499-13-513ms   | [S1,MB1,BI] 513-15-528ms   | [S1,MB1,BW] 528-14-543ms   | [S6,MB5,F]  543-7-551ms    | [S6,MB4,BI] 594-10-604ms   | [S6,MB4,BW] 604-9-614ms    | [S1,MB2,BI] 633-14-647ms   | [S1,MB2,BW] 647-14-661ms   | [S6,MB6,F]  729-7-736ms    | [S6,MB5,BI] 736-9-745ms    | [S6,MB5,BW] 746-10-757ms   | [S1,MB3,BI] 760-14-774ms   | [S1,MB3,BW] 775-14-789ms   | [S6,MB7,F]  854-7-862ms    | [S6,MB6,BI] 861-9-871ms    | [S6,MB6,BW] 871-11-883ms   | [S1,MB4,BI] 884-14-899ms   | [S6,MB7,BI] 970-10-980ms   | [S1,MB5,BI] 981-15-996ms   | [S1,MB4,BW] 996-16-1012ms  | [S1,MB6,BI] 1012-14-1026ms | [S1,MB5,BW] 1026-15-1042ms | [S1,MB7,BI] 1042-15-1058ms | [S1,MB6,BW] 1057-16-1074ms | [S6,MB7,BW] 1074-11-1086ms | [S1,MB7,BW] 1085-16-1102ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 274-9-284ms    | [S5,MB1,BW] 284-10-294ms   | [S2,MB5,F]  294-7-302ms    | [S2,MB0,BI] 302-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 370-10-380ms   | [S5,MB2,BW] 380-9-390ms    | [S2,MB6,F]  392-9-402ms    | [S2,MB1,BI] 403-10-414ms   | [S2,MB1,BW] 414-9-424ms    | [S5,MB5,F]  424-7-431ms    | [S5,MB3,BI] 505-11-516ms   | [S5,MB3,BW] 516-11-527ms   | [S2,MB7,F]  527-7-534ms    | [S2,MB2,BI] 534-10-545ms   | [S2,MB2,BW] 545-9-554ms    | [S5,MB6,F]  555-7-562ms    | [S5,MB4,BI] 626-10-637ms   | [S5,MB4,BW] 637-9-646ms    | [S2,MB3,BI] 732-9-741ms    | [S2,MB3,BW] 742-10-752ms   | [S5,MB7,F]  760-7-767ms    | [S5,MB5,BI] 767-9-777ms    | [S5,MB5,BW] 777-9-786ms    | [S2,MB4,BI] 858-9-867ms    | [S5,MB6,BI] 877-10-887ms   | [S2,MB5,BI] 887-10-897ms   | [S5,MB7,BI] 984-9-993ms    | [S2,MB6,BI] 993-11-1004ms  | [S2,MB4,BW] 1004-10-1014ms | [S2,MB7,BI] 1019-9-1029ms  | [S2,MB5,BW] 1029-10-1039ms | [S5,MB6,BW] 1039-9-1048ms  | [S5,MB7,BW] 1049-9-1058ms  | [S2,MB6,BW] 1059-9-1068ms  | [S2,MB7,BW] 1069-9-1079ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  97-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 396-11-408ms   | [S4,MB2,BW] 407-9-417ms    | [S3,MB6,F]  417-7-424ms    | [S3,MB2,BI] 424-9-434ms    | [S3,MB2,BW] 434-9-444ms    | [S4,MB6,F]  444-7-452ms    | [S4,MB3,BI] 519-10-529ms   | [S4,MB3,BW] 529-10-539ms   | [S3,MB7,F]  539-7-547ms    | [S3,MB3,BI] 547-9-556ms    | [S3,MB3,BW] 556-9-566ms    | [S4,MB7,F]  566-7-573ms    | [S4,MB4,BI] 725-10-736ms   | [S4,MB4,BW] 736-9-745ms    | [S3,MB4,BI] 746-10-756ms   | [S4,MB5,BI] 851-10-861ms   | [S3,MB5,BI] 861-9-870ms    | [S4,MB6,BI] 887-9-897ms    | [S3,MB6,BI] 897-9-906ms    | [S4,MB7,BI] 994-9-1003ms   | [S3,MB7,BI] 1004-9-1013ms  | [S3,MB4,BW] 1013-10-1023ms | [S4,MB5,BW] 1023-9-1032ms  | [S4,MB6,BW] 1032-9-1042ms  | [S4,MB7,BW] 1042-9-1051ms  | [S3,MB5,BW] 1052-10-1062ms | [S3,MB6,BW] 1062-10-1072ms | [S3,MB7,BW] 1072-10-1083ms
[rank0]:2025-12-26 17:44:03,337 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 17:44:08,179 - Avg. fwd time: 8.1038 / Avg. bwd-weight time: 10.0634 / Avg. bwd-input time: 10.0667 / Avg. batch time: 1063.2922 (ms) / GPU bubble ratio: 57.51%
[rank3]:2025-12-26 17:44:08,186 - Avg. fwd time: 7.7396 / Avg. bwd-weight time: 9.9059 / Avg. bwd-input time: 9.6963 / Avg. batch time: 1059.2882 (ms) / GPU bubble ratio: 58.70%
[rank0]:2025-12-26 17:44:08,211 - Avg. fwd time: 13.7891 / Avg. full-bwd time: 29.3394 (Avg. bwd-weight time: 30.3984 / Avg. bwd-input time: 34.6121) / Avg. batch time: 1122.3556 (ms) / GPU bubble ratio: 13.09%
[rank1]:2025-12-26 17:44:08,201 - Avg. fwd time: 9.8194 / Avg. bwd-weight time: 13.0117 / Avg. bwd-input time: 12.2990 / Avg. batch time: 1099.0732 (ms) / GPU bubble ratio: 48.86%
[rank2]:2025-12-26 17:44:08,257 -  step: 550  loss: -4.0000  grad_norm:  0.1794  memory: 13.80GiB(29.05%)  tps: 7,051  tflops: 55.12  mfu: 17.67%
[rank3]:2025-12-26 17:44:08,257 -  step: 550  loss: -4.0000  grad_norm:  0.1794  memory: 15.27GiB(32.13%)  tps: 7,051  tflops: 55.12  mfu: 17.67%
[rank0]:2025-12-26 17:44:08,283 -  step: 550  loss:  0.2211  grad_norm:  0.1794  memory: 35.32GiB(74.36%)  tps: 7,051  tflops: 55.12  mfu: 17.67%
[rank1]:2025-12-26 17:44:08,260 -  step: 550  loss: -4.0000  grad_norm:  0.1794  memory: 17.83GiB(37.53%)  tps: 7,051  tflops: 55.12  mfu: 17.67%
[rank0]:2025-12-26 17:47:55,832 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 17:48:00,761 - Avg. fwd time: 13.7910 / Avg. full-bwd time: 29.3422 (Avg. bwd-weight time: 30.4006 / Avg. bwd-input time: 34.6129) / Avg. batch time: 1122.3696 (ms) / GPU bubble ratio: 13.09%
[rank2]:2025-12-26 17:48:00,732 - Avg. fwd time: 8.1032 / Avg. bwd-weight time: 10.0627 / Avg. bwd-input time: 10.0677 / Avg. batch time: 1063.2814 (ms) / GPU bubble ratio: 57.51%
[rank2]:2025-12-26 17:48:00,806 -  step: 600  loss: -4.0000  grad_norm:  0.1801  memory: 13.80GiB(29.05%)  tps: 7,045  tflops: 55.08  mfu: 17.65%
[rank3]:2025-12-26 17:48:00,740 - Avg. fwd time: 7.7394 / Avg. bwd-weight time: 9.9058 / Avg. bwd-input time: 9.6967 / Avg. batch time: 1059.3356 (ms) / GPU bubble ratio: 58.70%
[rank3]:2025-12-26 17:48:00,807 -  step: 600  loss: -4.0000  grad_norm:  0.1801  memory: 15.27GiB(32.13%)  tps: 7,045  tflops: 55.08  mfu: 17.65%
[rank1]:2025-12-26 17:48:00,753 - Avg. fwd time: 9.8190 / Avg. bwd-weight time: 13.0126 / Avg. bwd-input time: 12.2993 / Avg. batch time: 1099.0816 (ms) / GPU bubble ratio: 48.86%
[rank1]:2025-12-26 17:48:00,810 -  step: 600  loss: -4.0000  grad_norm:  0.1801  memory: 17.83GiB(37.53%)  tps: 7,045  tflops: 55.08  mfu: 17.65%
[rank0]:2025-12-26 17:48:00,833 -  step: 600  loss:  0.2121  grad_norm:  0.1801  memory: 35.32GiB(74.36%)  tps: 7,045  tflops: 55.08  mfu: 17.65%
[rank3]:2025-12-26 17:48:01,186 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1748_step600_rank3.svg
[rank3]:			> Batch Time: 1122.95 ms, GPU Bubble Ratio: 12.99%, 49.89%, 59.75%, 60.97%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-25-200ms   | [S7,MB1,F]  200-16-217ms   | [S7,MB1,BI] 228-35-263ms   | [S7,MB1,BW] 264-30-294ms   | [S7,MB2,F]  295-19-315ms   | [S7,MB2,BI] 327-35-362ms   | [S7,MB2,BW] 362-31-393ms   | [S7,MB3,F]  393-19-413ms   | [S7,MB3,BI] 424-35-459ms   | [S7,MB3,BW] 459-32-491ms   | [S0,MB7,F]  491-10-501ms   | [S0,MB0,B]  501-30-531ms   | [S7,MB4,F]  531-19-550ms   | [S7,MB4,BI] 562-34-596ms   | [S7,MB4,BW] 596-32-628ms   | [S0,MB1,B]  627-30-657ms   | [S7,MB5,F]  657-18-675ms   | [S7,MB5,BI] 688-34-722ms   | [S7,MB5,BW] 722-30-752ms   | [S0,MB2,B]  752-29-782ms   | [S7,MB6,F]  782-19-801ms   | [S7,MB6,BI] 813-34-848ms   | [S7,MB6,BW] 848-30-878ms   | [S0,MB3,B]  880-30-910ms   | [S7,MB7,F]  910-18-928ms   | [S7,MB7,BI] 940-34-975ms   | [S7,MB7,BW] 975-31-1006ms  | [S0,MB4,B]  1006-30-1036ms | [S0,MB5,B]  1037-29-1066ms | [S0,MB6,B]  1066-28-1094ms | [S0,MB7,B]  1095-27-1122ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-283ms   | [S6,MB3,F]  283-7-291ms    | [S6,MB2,BI] 362-9-371ms    | [S6,MB2,BW] 371-10-382ms   | [S1,MB6,F]  382-10-393ms   | [S1,MB0,BI] 393-15-409ms   | [S1,MB0,BW] 409-15-424ms   | [S6,MB4,F]  423-8-432ms    | [S6,MB3,BI] 460-10-470ms   | [S6,MB3,BW] 470-9-480ms    | [S1,MB7,F]  501-13-514ms   | [S1,MB1,BI] 514-15-530ms   | [S1,MB1,BW] 530-14-545ms   | [S6,MB5,F]  545-7-553ms    | [S6,MB4,BI] 596-10-606ms   | [S6,MB4,BW] 606-9-616ms    | [S1,MB2,BI] 634-14-649ms   | [S1,MB2,BW] 649-14-663ms   | [S6,MB6,F]  732-7-739ms    | [S6,MB5,BI] 739-9-748ms    | [S6,MB5,BW] 748-10-759ms   | [S1,MB3,BI] 762-14-776ms   | [S1,MB3,BW] 776-14-791ms   | [S6,MB7,F]  858-7-865ms    | [S6,MB6,BI] 865-9-874ms    | [S6,MB6,BW] 875-11-886ms   | [S1,MB4,BI] 889-14-903ms   | [S6,MB7,BI] 975-10-985ms   | [S1,MB5,BI] 986-15-1001ms  | [S1,MB4,BW] 1001-15-1017ms | [S1,MB6,BI] 1016-14-1031ms | [S1,MB5,BW] 1031-15-1047ms | [S1,MB7,BI] 1046-15-1062ms | [S1,MB6,BW] 1062-16-1079ms | [S6,MB7,BW] 1078-11-1090ms | [S1,MB7,BW] 1090-16-1107ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 273-9-283ms    | [S5,MB1,BW] 283-10-293ms   | [S2,MB5,F]  293-7-301ms    | [S2,MB0,BI] 301-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  321-7-329ms    | [S5,MB2,BI] 371-10-382ms   | [S5,MB2,BW] 382-9-392ms    | [S2,MB6,F]  394-9-403ms    | [S2,MB1,BI] 405-10-416ms   | [S2,MB1,BW] 415-9-425ms    | [S5,MB5,F]  425-7-433ms    | [S5,MB3,BI] 506-11-518ms   | [S5,MB3,BW] 518-11-529ms   | [S2,MB7,F]  529-7-536ms    | [S2,MB2,BI] 536-10-547ms   | [S2,MB2,BW] 547-9-556ms    | [S5,MB6,F]  557-7-564ms    | [S5,MB4,BI] 628-10-638ms   | [S5,MB4,BW] 638-9-648ms    | [S2,MB3,BI] 735-9-745ms    | [S2,MB3,BW] 745-10-755ms   | [S5,MB7,F]  762-7-769ms    | [S5,MB5,BI] 769-9-779ms    | [S5,MB5,BW] 779-9-788ms    | [S2,MB4,BI] 861-9-871ms    | [S5,MB6,BI] 882-10-892ms   | [S2,MB5,BI] 892-10-902ms   | [S5,MB7,BI] 989-9-998ms    | [S2,MB6,BI] 998-10-1009ms  | [S2,MB4,BW] 1009-10-1019ms | [S2,MB7,BI] 1024-9-1033ms  | [S2,MB5,BW] 1034-10-1044ms | [S5,MB6,BW] 1044-9-1053ms  | [S5,MB7,BW] 1054-9-1063ms  | [S2,MB6,BW] 1064-9-1074ms  | [S2,MB7,BW] 1073-10-1083ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-338ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 410-9-419ms    | [S3,MB6,F]  419-7-427ms    | [S3,MB2,BI] 427-9-436ms    | [S3,MB2,BW] 436-9-446ms    | [S4,MB6,F]  446-7-453ms    | [S4,MB3,BI] 521-10-531ms   | [S4,MB3,BW] 531-10-541ms   | [S3,MB7,F]  541-7-549ms    | [S3,MB3,BI] 548-9-558ms    | [S3,MB3,BW] 558-9-567ms    | [S4,MB7,F]  568-7-576ms    | [S4,MB4,BI] 728-10-739ms   | [S4,MB4,BW] 739-9-748ms    | [S3,MB4,BI] 748-10-759ms   | [S4,MB5,BI] 854-10-864ms   | [S3,MB5,BI] 865-9-874ms    | [S4,MB6,BI] 892-9-902ms    | [S3,MB6,BI] 902-9-911ms    | [S4,MB7,BI] 999-9-1008ms   | [S3,MB7,BI] 1008-9-1017ms  | [S3,MB4,BW] 1018-10-1028ms | [S4,MB5,BW] 1028-9-1037ms  | [S4,MB6,BW] 1037-9-1047ms  | [S4,MB7,BW] 1047-9-1057ms  | [S3,MB5,BW] 1057-10-1067ms | [S3,MB6,BW] 1067-10-1077ms | [S3,MB7,BW] 1078-10-1089ms
[rank0]:2025-12-26 17:51:49,104 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 17:51:53,919 - Avg. fwd time: 8.1028 / Avg. bwd-weight time: 10.0622 / Avg. bwd-input time: 10.0687 / Avg. batch time: 1063.4863 (ms) / GPU bubble ratio: 57.52%
[rank2]:2025-12-26 17:51:53,991 -  step: 650  loss: -4.0000  grad_norm:  0.1753  memory: 13.80GiB(29.05%)  tps: 7,026  tflops: 54.93  mfu: 17.60%
[rank3]:2025-12-26 17:51:53,928 - Avg. fwd time: 7.7394 / Avg. bwd-weight time: 9.9055 / Avg. bwd-input time: 9.6976 / Avg. batch time: 1059.4671 (ms) / GPU bubble ratio: 58.71%
[rank3]:2025-12-26 17:51:53,991 -  step: 650  loss: -4.0000  grad_norm:  0.1753  memory: 15.27GiB(32.13%)  tps: 7,026  tflops: 54.93  mfu: 17.61%
[rank0]:2025-12-26 17:51:53,945 - Avg. fwd time: 13.7943 / Avg. full-bwd time: 29.3493 (Avg. bwd-weight time: 30.4099 / Avg. bwd-input time: 34.6149) / Avg. batch time: 1122.6265 (ms) / GPU bubble ratio: 13.09%
[rank0]:2025-12-26 17:51:54,018 -  step: 650  loss:  0.2224  grad_norm:  0.1753  memory: 35.32GiB(74.36%)  tps: 7,026  tflops: 54.93  mfu: 17.61%
[rank1]:2025-12-26 17:51:53,940 - Avg. fwd time: 9.8186 / Avg. bwd-weight time: 13.0136 / Avg. bwd-input time: 12.3002 / Avg. batch time: 1099.3121 (ms) / GPU bubble ratio: 48.87%
[rank1]:2025-12-26 17:51:53,995 -  step: 650  loss: -4.0000  grad_norm:  0.1753  memory: 17.83GiB(37.53%)  tps: 7,026  tflops: 54.93  mfu: 17.61%
[rank0]:2025-12-26 17:55:41,699 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 17:55:46,514 - Avg. fwd time: 7.7393 / Avg. bwd-weight time: 9.9049 / Avg. bwd-input time: 9.6983 / Avg. batch time: 1059.5022 (ms) / GPU bubble ratio: 58.71%
[rank2]:2025-12-26 17:55:46,506 - Avg. fwd time: 8.1024 / Avg. bwd-weight time: 10.0614 / Avg. bwd-input time: 10.0699 / Avg. batch time: 1063.4656 (ms) / GPU bubble ratio: 57.52%
[rank3]:2025-12-26 17:55:46,582 -  step: 700  loss: -4.0000  grad_norm:  0.1592  memory: 15.27GiB(32.13%)  tps: 7,044  tflops: 55.07  mfu: 17.65%
[rank2]:2025-12-26 17:55:46,582 -  step: 700  loss: -4.0000  grad_norm:  0.1592  memory: 13.80GiB(29.05%)  tps: 7,044  tflops: 55.07  mfu: 17.65%
[rank1]:2025-12-26 17:55:46,528 - Avg. fwd time: 9.8181 / Avg. bwd-weight time: 13.0140 / Avg. bwd-input time: 12.3015 / Avg. batch time: 1099.3203 (ms) / GPU bubble ratio: 48.87%
[rank1]:2025-12-26 17:55:46,585 -  step: 700  loss: -4.0000  grad_norm:  0.1592  memory: 17.83GiB(37.53%)  tps: 7,044  tflops: 55.07  mfu: 17.65%
[rank0]:2025-12-26 17:55:46,536 - Avg. fwd time: 13.7956 / Avg. full-bwd time: 29.3534 (Avg. bwd-weight time: 30.4115 / Avg. bwd-input time: 34.6159) / Avg. batch time: 1122.6394 (ms) / GPU bubble ratio: 13.08%
[rank0]:2025-12-26 17:55:46,608 -  step: 700  loss:  0.1794  grad_norm:  0.1592  memory: 35.32GiB(74.36%)  tps: 7,044  tflops: 55.07  mfu: 17.65%
[rank3]:2025-12-26 17:55:46,953 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1755_step700_rank3.svg
[rank3]:			> Batch Time: 1119.03 ms, GPU Bubble Ratio: 12.82%, 49.71%, 59.61%, 60.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  112-17-130ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-26-200ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 229-34-264ms   | [S7,MB1,BW] 264-30-294ms   | [S7,MB2,F]  294-19-314ms   | [S7,MB2,BI] 325-35-361ms   | [S7,MB2,BW] 361-30-391ms   | [S7,MB3,F]  391-19-411ms   | [S7,MB3,BI] 423-35-458ms   | [S7,MB3,BW] 458-32-490ms   | [S0,MB7,F]  489-10-499ms   | [S0,MB0,B]  499-30-529ms   | [S7,MB4,F]  529-18-548ms   | [S7,MB4,BI] 560-34-594ms   | [S7,MB4,BW] 594-32-626ms   | [S0,MB1,B]  626-30-656ms   | [S7,MB5,F]  656-18-674ms   | [S7,MB5,BI] 687-34-721ms   | [S7,MB5,BW] 721-30-752ms   | [S0,MB2,B]  752-29-782ms   | [S7,MB6,F]  781-18-800ms   | [S7,MB6,BI] 813-34-847ms   | [S7,MB6,BW] 847-30-877ms   | [S0,MB3,B]  877-29-906ms   | [S7,MB7,F]  907-18-925ms   | [S7,MB7,BI] 937-34-972ms   | [S7,MB7,BW] 972-30-1002ms  | [S0,MB4,B]  1003-30-1033ms | [S0,MB5,B]  1033-29-1062ms | [S0,MB6,B]  1062-28-1090ms | [S0,MB7,B]  1091-28-1119ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-72ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 361-9-370ms    | [S6,MB2,BW] 370-10-381ms   | [S1,MB6,F]  381-10-392ms   | [S1,MB0,BI] 392-15-408ms   | [S1,MB0,BW] 407-15-423ms   | [S6,MB4,F]  422-8-431ms    | [S6,MB3,BI] 458-10-469ms   | [S6,MB3,BW] 469-9-478ms    | [S1,MB7,F]  499-13-513ms   | [S1,MB1,BI] 513-15-528ms   | [S1,MB1,BW] 528-14-543ms   | [S6,MB5,F]  543-7-551ms    | [S6,MB4,BI] 594-10-605ms   | [S6,MB4,BW] 604-9-614ms    | [S1,MB2,BI] 633-14-648ms   | [S1,MB2,BW] 648-14-662ms   | [S6,MB6,F]  731-7-738ms    | [S6,MB5,BI] 738-9-748ms    | [S6,MB5,BW] 748-10-759ms   | [S1,MB3,BI] 761-14-776ms   | [S1,MB3,BW] 776-14-790ms   | [S6,MB7,F]  856-7-864ms    | [S6,MB6,BI] 864-9-873ms    | [S6,MB6,BW] 873-11-885ms   | [S1,MB4,BI] 886-14-901ms   | [S6,MB7,BI] 972-10-982ms   | [S1,MB5,BI] 983-15-998ms   | [S1,MB4,BW] 998-16-1014ms  | [S1,MB6,BI] 1013-14-1028ms | [S1,MB5,BW] 1028-15-1044ms | [S1,MB7,BI] 1044-15-1060ms | [S1,MB6,BW] 1059-16-1076ms | [S6,MB7,BW] 1076-11-1088ms | [S1,MB7,BW] 1087-16-1104ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-10-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 302-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 370-10-381ms   | [S5,MB2,BW] 381-9-390ms    | [S2,MB6,F]  393-9-402ms    | [S2,MB1,BI] 404-10-414ms   | [S2,MB1,BW] 415-9-424ms    | [S5,MB5,F]  424-7-432ms    | [S5,MB3,BI] 505-11-516ms   | [S5,MB3,BW] 516-11-527ms   | [S2,MB7,F]  527-7-534ms    | [S2,MB2,BI] 534-10-545ms   | [S2,MB2,BW] 545-9-555ms    | [S5,MB6,F]  555-7-562ms    | [S5,MB4,BI] 627-10-638ms   | [S5,MB4,BW] 638-9-647ms    | [S2,MB3,BI] 734-9-744ms    | [S2,MB3,BW] 744-10-754ms   | [S5,MB7,F]  761-7-768ms    | [S5,MB5,BI] 768-9-778ms    | [S5,MB5,BW] 778-9-788ms    | [S2,MB4,BI] 860-9-869ms    | [S5,MB6,BI] 879-10-889ms   | [S2,MB5,BI] 890-10-900ms   | [S5,MB7,BI] 986-9-995ms    | [S2,MB6,BI] 995-10-1006ms  | [S2,MB4,BW] 1006-10-1016ms | [S2,MB7,BI] 1021-9-1031ms  | [S2,MB5,BW] 1031-10-1041ms | [S5,MB6,BW] 1041-9-1051ms  | [S5,MB7,BW] 1051-9-1060ms  | [S2,MB6,BW] 1061-9-1070ms  | [S2,MB7,BW] 1071-10-1081ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  211-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 283-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-321ms    | [S3,MB1,BW] 322-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 397-11-408ms   | [S4,MB2,BW] 408-9-418ms    | [S3,MB6,F]  418-7-425ms    | [S3,MB2,BI] 425-9-435ms    | [S3,MB2,BW] 435-9-444ms    | [S4,MB6,F]  444-7-452ms    | [S4,MB3,BI] 518-10-529ms   | [S4,MB3,BW] 528-10-539ms   | [S3,MB7,F]  539-7-546ms    | [S3,MB3,BI] 546-9-556ms    | [S3,MB3,BW] 556-9-565ms    | [S4,MB7,F]  566-7-573ms    | [S4,MB4,BI] 728-10-738ms   | [S4,MB4,BW] 738-9-748ms    | [S3,MB4,BI] 748-10-758ms   | [S4,MB5,BI] 853-10-863ms   | [S3,MB5,BI] 863-9-872ms    | [S4,MB6,BI] 890-9-899ms    | [S3,MB6,BI] 899-9-908ms    | [S4,MB7,BI] 996-9-1005ms   | [S3,MB7,BI] 1006-9-1015ms  | [S3,MB4,BW] 1015-10-1025ms | [S4,MB5,BW] 1025-9-1035ms  | [S4,MB6,BW] 1035-9-1044ms  | [S4,MB7,BW] 1045-9-1054ms  | [S3,MB5,BW] 1055-10-1065ms | [S3,MB6,BW] 1065-10-1075ms | [S3,MB7,BW] 1075-10-1085ms
[rank0]:2025-12-26 17:59:34,602 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 17:59:39,487 - Avg. fwd time: 9.8180 / Avg. bwd-weight time: 13.0147 / Avg. bwd-input time: 12.3028 / Avg. batch time: 1099.4512 (ms) / GPU bubble ratio: 48.87%
[rank2]:2025-12-26 17:59:39,467 - Avg. fwd time: 8.1022 / Avg. bwd-weight time: 10.0606 / Avg. bwd-input time: 10.0705 / Avg. batch time: 1063.5708 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-12-26 17:59:39,474 - Avg. fwd time: 7.7389 / Avg. bwd-weight time: 9.9039 / Avg. bwd-input time: 9.6987 / Avg. batch time: 1059.5467 (ms) / GPU bubble ratio: 58.71%
[rank0]:2025-12-26 17:59:39,493 - Avg. fwd time: 13.7977 / Avg. full-bwd time: 29.3582 (Avg. bwd-weight time: 30.4100 / Avg. bwd-input time: 34.6184) / Avg. batch time: 1122.7724 (ms) / GPU bubble ratio: 13.09%
[rank1]:2025-12-26 17:59:39,542 -  step: 750  loss: -4.0000  grad_norm:  0.1933  memory: 17.83GiB(37.53%)  tps: 7,033  tflops: 54.98  mfu: 17.62%
[rank0]:2025-12-26 17:59:39,565 -  step: 750  loss:  0.2179  grad_norm:  0.1933  memory: 35.32GiB(74.36%)  tps: 7,033  tflops: 54.98  mfu: 17.62%
[rank3]:2025-12-26 17:59:39,539 -  step: 750  loss: -4.0000  grad_norm:  0.1933  memory: 15.27GiB(32.13%)  tps: 7,033  tflops: 54.98  mfu: 17.62%
[rank2]:2025-12-26 17:59:39,539 -  step: 750  loss: -4.0000  grad_norm:  0.1933  memory: 13.80GiB(29.05%)  tps: 7,033  tflops: 54.98  mfu: 17.62%
[rank0]:2025-12-26 18:03:27,076 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 18:03:31,996 - Avg. fwd time: 7.7386 / Avg. bwd-weight time: 9.9024 / Avg. bwd-input time: 9.6990 / Avg. batch time: 1059.5595 (ms) / GPU bubble ratio: 58.71%
[rank2]:2025-12-26 18:03:31,986 - Avg. fwd time: 8.1023 / Avg. bwd-weight time: 10.0602 / Avg. bwd-input time: 10.0713 / Avg. batch time: 1063.5546 (ms) / GPU bubble ratio: 57.53%
[rank1]:2025-12-26 18:03:32,008 - Avg. fwd time: 9.8180 / Avg. bwd-weight time: 13.0150 / Avg. bwd-input time: 12.3041 / Avg. batch time: 1099.4481 (ms) / GPU bubble ratio: 48.87%
[rank1]:2025-12-26 18:03:32,069 -  step: 800  loss: -4.0000  grad_norm:  0.1864  memory: 17.83GiB(37.53%)  tps: 7,046  tflops: 55.08  mfu: 17.65%
[rank1]:2025-12-26 18:03:32,069 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1864  tps: 7,471  tflops: 58.40  mfu: 17.05%
[rank1]:2025-12-26 18:03:32,069 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-26 18:03:32,070 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-26 18:03:32,066 -  step: 800  loss: -4.0000  grad_norm:  0.1864  memory: 15.27GiB(32.13%)  tps: 7,046  tflops: 55.08  mfu: 17.65%
[rank3]:2025-12-26 18:03:32,066 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1864  tps: 7,471  tflops: 58.40  mfu: 17.04%
[rank3]:2025-12-26 18:03:32,066 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-26 18:03:32,067 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-26 18:03:32,066 -  step: 800  loss: -4.0000  grad_norm:  0.1864  memory: 13.80GiB(29.05%)  tps: 7,046  tflops: 55.08  mfu: 17.65%
[rank2]:2025-12-26 18:03:32,066 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1864  tps: 7,472  tflops: 58.41  mfu: 17.06%
[rank2]:2025-12-26 18:03:32,066 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-26 18:03:32,067 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 18:03:32,020 - Avg. fwd time: 13.7982 / Avg. full-bwd time: 29.3595 (Avg. bwd-weight time: 30.4113 / Avg. bwd-input time: 34.6180) / Avg. batch time: 1122.7517 (ms) / GPU bubble ratio: 13.08%
[rank0]:2025-12-26 18:03:32,092 -  step: 800  loss:  0.2242  grad_norm:  0.1864  memory: 35.32GiB(74.36%)  tps: 7,046  tflops: 55.08  mfu: 17.65%
[rank0]:2025-12-26 18:03:32,093 - â„¹ï¸ final step: 800  loss:  0.2242  grad_norm:  0.1864  tps: 7,476  tflops: 58.44  mfu: 17.16%
[rank0]:2025-12-26 18:03:32,093 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-26 18:03:32,094 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-26 18:03:34,681 - Destroying the purge thread.
[rank1]:2025-12-26 18:03:34,681 - Destroying the purge thread.
[rank0]:2025-12-26 18:03:34,654 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-26 18:03:34,681 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-26 18:03:34,790 - Process group destroyed
[rank1]:2025-12-26 18:03:34,753 - Process group destroyed
[rank3]:2025-12-26 18:03:35,037 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1803_final800_rank3.svg
[rank3]:			> Batch Time: 1120.98 ms, GPU Bubble Ratio: 12.83%, 49.79%, 59.65%, 60.93%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-26-201ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-30-295ms   | [S7,MB2,F]  295-19-314ms   | [S7,MB2,BI] 326-35-361ms   | [S7,MB2,BW] 361-31-393ms   | [S7,MB3,F]  392-19-412ms   | [S7,MB3,BI] 424-35-459ms   | [S7,MB3,BW] 459-32-491ms   | [S0,MB7,F]  490-10-500ms   | [S0,MB0,B]  501-30-531ms   | [S7,MB4,F]  530-18-549ms   | [S7,MB4,BI] 561-34-595ms   | [S7,MB4,BW] 596-31-627ms   | [S0,MB1,B]  627-30-657ms   | [S7,MB5,F]  657-18-676ms   | [S7,MB5,BI] 688-34-722ms   | [S7,MB5,BW] 722-30-753ms   | [S0,MB2,B]  753-29-783ms   | [S7,MB6,F]  783-18-801ms   | [S7,MB6,BI] 814-34-848ms   | [S7,MB6,BW] 848-30-878ms   | [S0,MB3,B]  879-29-908ms   | [S7,MB7,F]  909-18-927ms   | [S7,MB7,BI] 939-34-974ms   | [S7,MB7,BW] 974-30-1004ms  | [S0,MB4,B]  1005-30-1035ms | [S0,MB5,B]  1035-29-1064ms | [S0,MB6,B]  1064-28-1092ms | [S0,MB7,B]  1093-27-1120ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 361-9-371ms    | [S6,MB2,BW] 371-10-382ms   | [S1,MB6,F]  382-10-393ms   | [S1,MB0,BI] 393-15-409ms   | [S1,MB0,BW] 408-15-424ms   | [S6,MB4,F]  423-8-432ms    | [S6,MB3,BI] 459-10-469ms   | [S6,MB3,BW] 469-9-479ms    | [S1,MB7,F]  501-13-515ms   | [S1,MB1,BI] 515-15-530ms   | [S1,MB1,BW] 530-14-545ms   | [S6,MB5,F]  545-7-553ms    | [S6,MB4,BI] 595-10-606ms   | [S6,MB4,BW] 606-9-616ms    | [S1,MB2,BI] 635-14-649ms   | [S1,MB2,BW] 649-14-664ms   | [S6,MB6,F]  732-7-740ms    | [S6,MB5,BI] 739-9-749ms    | [S6,MB5,BW] 749-10-760ms   | [S1,MB3,BI] 763-14-777ms   | [S1,MB3,BW] 777-14-792ms   | [S6,MB7,F]  858-7-865ms    | [S6,MB6,BI] 865-9-875ms    | [S6,MB6,BW] 875-11-886ms   | [S1,MB4,BI] 888-14-903ms   | [S6,MB7,BI] 974-10-984ms   | [S1,MB5,BI] 984-15-1000ms  | [S1,MB4,BW] 1000-16-1016ms | [S1,MB6,BI] 1016-14-1030ms | [S1,MB5,BW] 1030-15-1046ms | [S1,MB7,BI] 1046-15-1062ms | [S1,MB6,BW] 1061-16-1078ms | [S6,MB7,BW] 1078-11-1090ms | [S1,MB7,BW] 1089-16-1106ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 274-9-284ms    | [S5,MB1,BW] 283-10-294ms   | [S2,MB5,F]  294-7-302ms    | [S2,MB0,BI] 302-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-329ms    | [S5,MB2,BI] 371-10-381ms   | [S5,MB2,BW] 381-9-391ms    | [S2,MB6,F]  393-9-403ms    | [S2,MB1,BI] 405-10-415ms   | [S2,MB1,BW] 415-9-425ms    | [S5,MB5,F]  425-7-433ms    | [S5,MB3,BI] 506-11-518ms   | [S5,MB3,BW] 518-11-529ms   | [S2,MB7,F]  529-7-536ms    | [S2,MB2,BI] 536-10-547ms   | [S2,MB2,BW] 547-9-556ms    | [S5,MB6,F]  556-7-564ms    | [S5,MB4,BI] 628-10-639ms   | [S5,MB4,BW] 639-9-649ms    | [S2,MB3,BI] 735-9-745ms    | [S2,MB3,BW] 745-10-755ms   | [S5,MB7,F]  763-7-770ms    | [S5,MB5,BI] 770-9-779ms    | [S5,MB5,BW] 779-9-789ms    | [S2,MB4,BI] 861-9-871ms    | [S5,MB6,BI] 881-10-891ms   | [S2,MB5,BI] 891-10-901ms   | [S5,MB7,BI] 988-9-997ms    | [S2,MB6,BI] 997-10-1008ms  | [S2,MB4,BW] 1008-10-1018ms | [S2,MB7,BI] 1023-9-1033ms  | [S2,MB5,BW] 1033-10-1043ms | [S5,MB6,BW] 1043-9-1053ms  | [S5,MB7,BW] 1053-9-1062ms  | [S2,MB6,BW] 1063-9-1073ms  | [S2,MB7,BW] 1073-10-1083ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-331ms    | [S4,MB5,F]  332-7-339ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  419-7-426ms    | [S3,MB2,BI] 426-9-435ms    | [S3,MB2,BW] 436-9-445ms    | [S4,MB6,F]  445-7-453ms    | [S4,MB3,BI] 521-10-531ms   | [S4,MB3,BW] 531-10-541ms   | [S3,MB7,F]  541-7-549ms    | [S3,MB3,BI] 548-9-558ms    | [S3,MB3,BW] 558-9-567ms    | [S4,MB7,F]  568-7-575ms    | [S4,MB4,BI] 729-10-739ms   | [S4,MB4,BW] 739-9-749ms    | [S3,MB4,BI] 749-10-759ms   | [S4,MB5,BI] 855-10-865ms   | [S3,MB5,BI] 865-9-874ms    | [S4,MB6,BI] 891-9-901ms    | [S3,MB6,BI] 901-9-910ms    | [S4,MB7,BI] 998-9-1007ms   | [S3,MB7,BI] 1008-9-1017ms  | [S3,MB4,BW] 1017-10-1027ms | [S4,MB5,BW] 1027-9-1036ms  | [S4,MB6,BW] 1037-9-1046ms  | [S4,MB7,BW] 1046-9-1056ms  | [S3,MB5,BW] 1056-10-1066ms | [S3,MB6,BW] 1066-10-1076ms | [S3,MB7,BW] 1077-10-1088ms
[rank3]:2025-12-26 18:03:35,377 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1/pipeline_schedule/251226_1803_thry_final800_rank3.svg
[rank3]:			> Batch Time: 473.38 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB4,F]  39-9-49ms      | [S0,MB5,F]  49-9-59ms      | [S0,MB6,F]  59-9-69ms      | [S7,MB0,F]  69-9-78ms      | [S7,MB0,BI] 78-9-88ms      | [S7,MB0,BW] 88-9-98ms      | [S7,MB1,F]  98-9-108ms     | [S7,MB1,BI] 108-9-118ms    | [S7,MB1,BW] 118-9-128ms    | [S7,MB2,F]  128-9-138ms    | [S7,MB2,BI] 138-9-147ms    | [S7,MB2,BW] 147-9-157ms    | [S7,MB3,F]  157-9-167ms    | [S7,MB3,BI] 167-9-177ms    | [S7,MB3,BW] 177-9-187ms    | [S0,MB7,F]  187-9-197ms    | [S0,MB0,B]  197-19-216ms   | [S7,MB4,F]  216-9-226ms    | [S7,MB4,BI] 226-9-236ms    | [S7,MB4,BW] 236-9-246ms    | [S0,MB1,B]  246-19-266ms   | [S7,MB5,F]  266-9-276ms    | [S7,MB5,BI] 276-9-286ms    | [S7,MB5,BW] 286-9-295ms    | [S0,MB2,B]  295-19-315ms   | [S7,MB6,F]  315-9-325ms    | [S7,MB6,BI] 325-9-335ms    | [S7,MB6,BW] 335-9-345ms    | [S0,MB3,B]  345-19-364ms   | [S7,MB7,F]  364-9-374ms    | [S7,MB7,BI] 374-9-384ms    | [S7,MB7,BW] 384-9-394ms    | [S0,MB4,B]  394-19-414ms   | [S0,MB5,B]  414-19-433ms   | [S0,MB6,B]  433-19-453ms   | [S0,MB7,B]  453-19-473ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB3,F]  39-9-49ms      | [S1,MB4,F]  49-9-59ms      | [S6,MB0,F]  59-9-69ms      | [S1,MB5,F]  69-9-78ms      | [S6,MB1,F]  78-9-88ms      | [S6,MB0,BI] 88-9-98ms      | [S6,MB0,BW] 98-9-108ms     | [S6,MB2,F]  108-9-118ms    | [S6,MB1,BI] 118-9-128ms    | [S6,MB1,BW] 128-9-138ms    | [S6,MB3,F]  138-9-147ms    | [S6,MB2,BI] 147-9-157ms    | [S6,MB2,BW] 157-9-167ms    | [S1,MB6,F]  167-9-177ms    | [S1,MB0,BI] 177-9-187ms    | [S1,MB0,BW] 187-9-197ms    | [S6,MB4,F]  197-9-207ms    | [S6,MB3,BI] 207-9-216ms    | [S6,MB3,BW] 216-9-226ms    | [S1,MB7,F]  226-9-236ms    | [S1,MB1,BI] 236-9-246ms    | [S1,MB1,BW] 246-9-256ms    | [S6,MB5,F]  256-9-266ms    | [S6,MB4,BI] 266-9-276ms    | [S6,MB4,BW] 276-9-286ms    | [S1,MB2,BI] 286-9-295ms    | [S1,MB2,BW] 295-9-305ms    | [S6,MB6,F]  305-9-315ms    | [S6,MB5,BI] 315-9-325ms    | [S6,MB5,BW] 325-9-335ms    | [S1,MB3,BI] 335-9-345ms    | [S1,MB3,BW] 345-9-355ms    | [S6,MB7,F]  355-9-364ms    | [S6,MB6,BI] 364-9-374ms    | [S6,MB6,BW] 374-9-384ms    | [S1,MB4,BI] 384-9-394ms    | [S6,MB7,BI] 394-9-404ms    | [S1,MB5,BI] 404-9-414ms    | [S1,MB4,BW] 414-9-424ms    | [S1,MB6,BI] 424-9-433ms    | [S1,MB5,BW] 433-9-443ms    | [S1,MB7,BI] 443-9-453ms    | [S1,MB6,BW] 453-9-463ms    | [S6,MB7,BW] 463-9-473ms    | [S1,MB7,BW] 473-9-483ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB2,F]  39-9-49ms      | [S5,MB0,F]  49-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-9-78ms      | [S2,MB4,F]  78-9-88ms      | [S5,MB2,F]  88-9-98ms      | [S5,MB0,BI] 98-9-108ms     | [S5,MB0,BW] 108-9-118ms    | [S5,MB3,F]  118-9-128ms    | [S5,MB1,BI] 128-9-138ms    | [S5,MB1,BW] 138-9-147ms    | [S2,MB5,F]  147-9-157ms    | [S2,MB0,BI] 157-9-167ms    | [S2,MB0,BW] 167-9-177ms    | [S5,MB4,F]  177-9-187ms    | [S5,MB2,BI] 187-9-197ms    | [S5,MB2,BW] 197-9-207ms    | [S2,MB6,F]  207-9-216ms    | [S2,MB1,BI] 216-9-226ms    | [S2,MB1,BW] 226-9-236ms    | [S5,MB5,F]  236-9-246ms    | [S5,MB3,BI] 246-9-256ms    | [S5,MB3,BW] 256-9-266ms    | [S2,MB7,F]  266-9-276ms    | [S2,MB2,BI] 276-9-286ms    | [S2,MB2,BW] 286-9-295ms    | [S5,MB6,F]  295-9-305ms    | [S5,MB4,BI] 305-9-315ms    | [S5,MB4,BW] 315-9-325ms    | [S2,MB3,BI] 325-9-335ms    | [S2,MB3,BW] 335-9-345ms    | [S5,MB7,F]  345-9-355ms    | [S5,MB5,BI] 355-9-364ms    | [S5,MB5,BW] 364-9-374ms    | [S2,MB4,BI] 374-9-384ms    | [S5,MB6,BI] 384-9-394ms    | [S2,MB5,BI] 394-9-404ms    | [S5,MB7,BI] 404-9-414ms    | [S2,MB6,BI] 414-9-424ms    | [S2,MB4,BW] 424-9-433ms    | [S2,MB7,BI] 433-9-443ms    | [S2,MB5,BW] 443-9-453ms    | [S5,MB6,BW] 453-9-463ms    | [S5,MB7,BW] 463-9-473ms    | [S2,MB6,BW] 473-9-483ms    | [S2,MB7,BW] 483-9-493ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S4,MB0,F]  39-9-49ms      | [S3,MB1,F]  49-9-59ms      | [S4,MB1,F]  59-9-69ms      | [S3,MB2,F]  69-9-78ms      | [S4,MB2,F]  78-9-88ms      | [S3,MB3,F]  88-9-98ms      | [S4,MB3,F]  98-9-108ms     | [S4,MB0,BI] 108-9-118ms    | [S4,MB0,BW] 118-9-128ms    | [S3,MB4,F]  128-9-138ms    | [S3,MB0,BI] 138-9-147ms    | [S3,MB0,BW] 147-9-157ms    | [S4,MB4,F]  157-9-167ms    | [S4,MB1,BI] 167-9-177ms    | [S4,MB1,BW] 177-9-187ms    | [S3,MB5,F]  187-9-197ms    | [S3,MB1,BI] 197-9-207ms    | [S3,MB1,BW] 207-9-216ms    | [S4,MB5,F]  216-9-226ms    | [S4,MB2,BI] 226-9-236ms    | [S4,MB2,BW] 236-9-246ms    | [S3,MB6,F]  246-9-256ms    | [S3,MB2,BI] 256-9-266ms    | [S3,MB2,BW] 266-9-276ms    | [S4,MB6,F]  276-9-286ms    | [S4,MB3,BI] 286-9-295ms    | [S4,MB3,BW] 295-9-305ms    | [S3,MB7,F]  305-9-315ms    | [S3,MB3,BI] 315-9-325ms    | [S3,MB3,BW] 325-9-335ms    | [S4,MB7,F]  335-9-345ms    | [S4,MB4,BI] 345-9-355ms    | [S4,MB4,BW] 355-9-364ms    | [S3,MB4,BI] 364-9-374ms    | [S4,MB5,BI] 374-9-384ms    | [S3,MB5,BI] 384-9-394ms    | [S4,MB6,BI] 394-9-404ms    | [S3,MB6,BI] 404-9-414ms    | [S4,MB7,BI] 414-9-424ms    | [S3,MB7,BI] 424-9-433ms    | [S3,MB4,BW] 433-9-443ms    | [S4,MB5,BW] 443-9-453ms    | [S4,MB6,BW] 453-9-463ms    | [S4,MB7,BW] 463-9-473ms    | [S3,MB5,BW] 473-9-483ms    | [S3,MB6,BW] 483-9-493ms    | [S3,MB7,BW] 493-9-502ms   
[rank3]:2025-12-26 18:03:35,378 - Destroying the purge thread.
[rank3]:2025-12-26 18:03:35,605 - Process group destroyed
[rank0]:2025-12-26 18:03:36,682 - Training completed
[rank0]:2025-12-26 18:03:36,683 - Destroying the purge thread.
[rank0]:wandb: updating run metadata
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 4.38337
[rank0]:wandb:               final/avg_loss 0.2242
[rank0]:wandb:             final/avg_mfu(%) 17.15698
[rank0]:wandb:             final/avg_tflops 58.44021
[rank0]:wandb:    final/avg_throughput(tps) 7475.52493
[rank0]:wandb:              final/grad_norm 0.18643
[rank0]:wandb:               final/max_loss 0.2242
[rank0]:wandb:                    grad_norm 0.18643
[rank0]:wandb: loss_metrics/global_avg_loss 0.2242
[rank0]:wandb: loss_metrics/global_max_loss 0.2242
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_nofreeze_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/w8oau86s
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_nofreeze_42_dm1/20251226-1701/wandb/run-20251226_170124-w8oau86s/logs
[rank0]:2025-12-26 18:03:37,765 - Process group destroyed
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.3', 'layers.2'}
[rank1]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_nofreeze_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1'}
[rank0]:Stage 7: Modules to keep: {'norm', 'output', 'layers.15'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
