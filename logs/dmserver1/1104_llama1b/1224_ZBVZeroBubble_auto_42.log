
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 26. (ê¸ˆ) 18:52:11 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with auto x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-26 18:52:17,785 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-26 18:52:17,840 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-26 18:52:17,785 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank2]:2025-12-26 18:52:17,926 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank0]:2025-12-26 18:52:18,021 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-26 18:52:18,023 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 18:52:18,026 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-26 18:52:18,027 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-26 18:52:18,014 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-26 18:52:18,016 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-26 18:52:18,173 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-26 18:52:18,176 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-26 18:52:18,206 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-26 18:52:18,209 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 18:52:18,428 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-26 18:52:21,524 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-26 18:52:21,655 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-26 18:52:21,694 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 18:52:21,720 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-26 18:52:21,733 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-26 18:52:21,735 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-26 18:52:21,689 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-26 18:52:21,728 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 18:52:21,803 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-26 18:52:21,842 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 18:52:21,756 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-26 18:52:21,770 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-26 18:52:21,771 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-26 18:52:21,870 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-26 18:52:21,883 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-26 18:52:21,885 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-26 18:52:22,004 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 18:52:22,005 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-26 18:52:22,006 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:2025-12-26 18:52:22,016 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 18:52:22,016 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-26 18:52:22,017 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-26 18:52:22,137 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 18:52:22,137 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-26 18:52:22,138 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run 3a5ougai
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_auto_42_dm1/20251226-1852/wandb/run-20251226_185222-3a5ougai
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_auto_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/3a5ougai
[rank0]:2025-12-26 18:52:24,052 - WandB logging enabled
[rank0]:2025-12-26 18:52:24,053 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-26 18:52:24,094 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 18:52:24,096 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-26 18:52:24,124 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-26 18:52:24,137 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-26 18:52:24,139 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-26 18:52:24,403 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 18:52:24,384 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 18:52:24,385 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-26 18:52:24,385 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-26 18:52:24,401 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_auto_42_dm1
[rank0]:2025-12-26 18:52:24,402 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 18:52:24,403 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-26 18:52:24,403 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-26 18:52:24,403 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-26 18:52:24,402 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 18:52:27,818 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-26 18:52:27,819 - Finished loading the checkpoint in 3.42 seconds.
[rank0]:2025-12-26 18:52:27,819 - Training starts at step 1
[rank1]:2025-12-26 18:52:32,931 -  step:  1  loss: -4.0000  grad_norm: 203.0668  memory: 15.58GiB(32.80%)  tps: 2,955  tflops: 23.10  mfu: 7.40%
[rank1]:2025-12-26 18:52:32,931 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-26 18:52:32,923 -  step:  1  loss: -4.0000  grad_norm: 203.0668  memory: 11.98GiB(25.23%)  tps: 2,918  tflops: 22.81  mfu: 7.31%
[rank2]:2025-12-26 18:52:32,923 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-26 18:52:32,921 -  step:  1  loss: -4.0000  grad_norm: 203.0668  memory: 13.43GiB(28.27%)  tps: 2,928  tflops: 22.89  mfu: 7.34%
[rank3]:2025-12-26 18:52:32,921 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 18:52:32,973 -  step:  1  loss: 10.6092  grad_norm: 203.0668  memory: 30.01GiB(63.17%)  tps: 3,691  tflops: 28.86  mfu: 9.25%
[rank0]:2025-12-26 18:52:32,974 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 18:56:14,759 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 18:56:19,582 - Avg. fwd time: 9.8434 / Avg. bwd-weight time: 12.9121 / Avg. bwd-input time: 12.1810 / Avg. batch time: 1092.0969 (ms) / GPU bubble ratio: 48.82%
[rank1]:2025-12-26 18:56:19,639 -  step: 50  loss: -4.0000  grad_norm: 24.4750  memory: 17.83GiB(37.53%)  tps: 7,082  tflops: 55.37  mfu: 17.75%
[rank3]:2025-12-26 18:56:19,573 - Avg. fwd time: 7.7963 / Avg. bwd-weight time: 9.8312 / Avg. bwd-input time: 9.6211 / Avg. batch time: 1053.4208 (ms) / GPU bubble ratio: 58.61%
[rank3]:2025-12-26 18:56:19,636 -  step: 50  loss: -4.0000  grad_norm: 24.4750  memory: 15.27GiB(32.13%)  tps: 7,082  tflops: 55.37  mfu: 17.75%
[rank2]:2025-12-26 18:56:19,563 - Avg. fwd time: 8.1661 / Avg. bwd-weight time: 10.0132 / Avg. bwd-input time: 10.0254 / Avg. batch time: 1056.8173 (ms) / GPU bubble ratio: 57.30%
[rank2]:2025-12-26 18:56:19,636 -  step: 50  loss: -4.0000  grad_norm: 24.4750  memory: 13.80GiB(29.05%)  tps: 7,082  tflops: 55.37  mfu: 17.75%
[rank0]:2025-12-26 18:56:19,590 - Avg. fwd time: 13.6593 / Avg. full-bwd time: 29.0503 (Avg. bwd-weight time: 30.0450 / Avg. bwd-input time: 34.5331) / Avg. batch time: 1114.7553 (ms) / GPU bubble ratio: 13.20%
[rank0]:2025-12-26 18:56:19,662 -  step: 50  loss:  9.8846  grad_norm: 24.4750  memory: 35.32GiB(74.36%)  tps: 7,083  tflops: 55.37  mfu: 17.75%
[rank2]:2025-12-26 18:57:01,638 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 18:57:01,666 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 18:57:01,642 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 18:57:01,637 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 18:57:48,262 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.5603e+00
[rank3]:2025-12-26 18:57:48,263 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 7.9973e-01
[rank1]:2025-12-26 18:57:48,266 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.6690e+00
[rank0]:2025-12-26 18:57:48,292 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 5.7003e+00
[rank3]:2025-12-26 18:58:34,958 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 18:58:35,096 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.5884e+00
[rank1]:2025-12-26 18:58:35,100 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.2553e+00
[rank0]:2025-12-26 18:58:35,126 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 3.3063e+00
[rank2]:2025-12-26 18:59:19,908 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 2.1946e+00
[rank3]:2025-12-26 18:59:19,908 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 18:59:19,914 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.7453e+00
[rank0]:2025-12-26 18:59:19,933 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 6.2087e+00
[rank0]:2025-12-26 19:00:06,181 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 19:00:06,319 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:00:06,437 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 9.3164e-01
[rank1]:2025-12-26 19:00:06,441 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.4587e+00
[rank0]:2025-12-26 19:00:06,466 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 1.2413e+01
[rank2]:2025-12-26 19:00:10,832 - Avg. fwd time: 8.2447 / Avg. bwd-weight time: 9.0439 / Avg. bwd-input time: 10.0417 / Avg. batch time: 1053.8719 (ms) / GPU bubble ratio: 58.51%
[rank3]:2025-12-26 19:00:10,800 - Avg. fwd time: 7.8360 / Avg. bwd-weight time: 8.8241 / Avg. bwd-input time: 9.6339 / Avg. batch time: 1048.0432 (ms) / GPU bubble ratio: 59.86%
[rank0]:2025-12-26 19:00:10,842 - Avg. fwd time: 13.7705 / Avg. full-bwd time: 28.5872 (Avg. bwd-weight time: 30.3107 / Avg. bwd-input time: 34.6328) / Avg. batch time: 1115.3055 (ms) / GPU bubble ratio: 13.16%
[rank1]:2025-12-26 19:00:10,854 - Avg. fwd time: 9.8460 / Avg. bwd-weight time: 12.9665 / Avg. bwd-input time: 12.2090 / Avg. batch time: 1094.4435 (ms) / GPU bubble ratio: 48.80%
[rank1]:2025-12-26 19:00:10,892 -  step: 100  loss: -4.0000  grad_norm: 16.0115  memory: 17.83GiB(37.53%)  tps: 7,085  tflops: 55.39  mfu: 17.75%
[rank2]:2025-12-26 19:00:10,887 -  step: 100  loss: -4.0000  grad_norm: 16.0115  memory: 13.80GiB(29.05%)  tps: 7,085  tflops: 55.39  mfu: 17.75%
[rank3]:2025-12-26 19:00:10,881 -  step: 100  loss: -4.0000  grad_norm: 16.0115  memory: 15.27GiB(32.13%)  tps: 7,085  tflops: 55.39  mfu: 17.75%
[rank0]:2025-12-26 19:00:10,911 -  step: 100  loss:  8.2989  grad_norm: 16.0115  memory: 35.62GiB(74.97%)  tps: 7,085  tflops: 55.39  mfu: 17.75%
[rank1]:2025-12-26 19:00:10,999 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1900_stage1_step100.svg
[rank1]:2025-12-26 19:00:11,036 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1900_stage6_step100.svg
[rank2]:2025-12-26 19:00:11,011 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1900_stage2_step100.svg
[rank0]:2025-12-26 19:00:10,997 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1900_stage0_step100.svg
[rank0]:2025-12-26 19:00:11,035 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1900_stage7_step100.svg
[rank2]:2025-12-26 19:00:11,049 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1900_stage5_step100.svg
[rank0]:2025-12-26 19:00:11,142 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank0_stage0.svg
[rank0]:	> Counts Sum: 18, Total Sum: 95 (18.95%), Ratio(%) per element: [0.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:00:11,169 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank1_stage1.svg
[rank1]:	> Counts Sum: 0, Total Sum: 135 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 19:00:11,152 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank2_stage2.svg
[rank2]:	> Counts Sum: 18, Total Sum: 90 (20.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]
[rank0]:2025-12-26 19:00:11,223 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank0_stage7.svg
[rank0]:	> Counts Sum: 0, Total Sum: 55 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:00:11,273 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank1_stage6.svg
[rank2]:2025-12-26 19:00:11,254 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank2_stage5.svg
[rank1]:	> Counts Sum: 0, Total Sum: 90 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:	> Counts Sum: 9, Total Sum: 90 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:00:11,271 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1900_step100_rank3.svg
[rank3]:			> Batch Time: 1115.75 ms, GPU Bubble Ratio: 12.56%, 49.70%, 72.79%, 60.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-25-201ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 264-30-295ms   | [S7,MB2,F]  295-19-314ms   | [S7,MB2,BI] 326-35-361ms   | [S7,MB2,BW] 361-31-393ms   | [S7,MB3,F]  392-19-412ms   | [S7,MB3,BI] 424-35-459ms   | [S7,MB3,BW] 459-32-491ms   | [S0,MB7,F]  491-10-501ms   | [S0,MB0,B]  501-30-531ms   | [S7,MB4,F]  531-19-550ms   | [S7,MB4,BI] 562-34-596ms   | [S7,MB4,BW] 596-31-627ms   | [S0,MB1,B]  627-29-657ms   | [S7,MB5,F]  657-18-676ms   | [S7,MB5,BI] 688-34-722ms   | [S7,MB5,BW] 722-31-753ms   | [S0,MB2,B]  753-29-782ms   | [S7,MB6,F]  782-18-800ms   | [S7,MB6,BI] 813-34-847ms   | [S7,MB6,BW] 847-30-877ms   | [S0,MB3,B]  877-29-906ms   | [S7,MB7,F]  906-18-925ms   | [S7,MB7,BI] 937-34-972ms   | [S7,MB7,BW] 972-30-1002ms  | [S0,MB4,B]  1003-30-1033ms | [S0,MB5,B]  1032-29-1061ms | [S0,MB6,B]  1061-28-1089ms | [S0,MB7,B]  1088-27-1115ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-107ms    | [S1,MB5,F]  107-13-120ms   | [S6,MB1,F]  120-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-195ms   | [S6,MB2,F]  194-7-202ms    | [S6,MB1,BI] 264-9-274ms    | [S6,MB1,BW] 273-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 361-9-370ms    | [S6,MB2,BW] 370-10-381ms   | [S1,MB6,F]  381-10-392ms   | [S1,MB0,BI] 392-15-408ms   | [S1,MB0,BW] 408-15-423ms   | [S6,MB4,F]  423-7-431ms    | [S6,MB3,BI] 459-10-469ms   | [S6,MB3,BW] 469-9-479ms    | [S1,MB7,F]  501-13-515ms   | [S1,MB1,BI] 515-15-530ms   | [S1,MB1,BW] 530-14-545ms   | [S6,MB5,F]  545-7-553ms    | [S6,MB4,BI] 596-10-607ms   | [S6,MB4,BW] 606-9-616ms    | [S1,MB2,BI] 635-14-650ms   | [S1,MB2,BW] 649-14-664ms   | [S6,MB6,F]  732-7-739ms    | [S6,MB5,BI] 739-9-748ms    | [S6,MB5,BW] 748-10-759ms   | [S1,MB3,BI] 762-14-777ms   | [S1,MB3,BW] 776-14-791ms   | [S6,MB7,F]  857-7-864ms    | [S6,MB6,BI] 864-9-874ms    | [S6,MB6,BW] 873-11-885ms   | [S1,MB4,BI] 886-14-901ms   | [S6,MB7,BI] 971-10-982ms   | [S1,MB5,BI] 982-14-997ms   | [S1,MB4,BW] 997-16-1014ms  | [S1,MB6,BI] 1013-14-1027ms | [S1,MB5,BW] 1027-15-1043ms | [S1,MB7,BI] 1043-15-1059ms | [S1,MB6,BW] 1058-16-1075ms | [S6,MB7,BW] 1074-11-1086ms | [S1,MB7,BW] 1085-16-1102ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-8-46ms      | [S2,MB2,F]  56-8-64ms      | [S5,MB0,F]  64-9-73ms      | [S2,MB3,F]  74-10-84ms     | [S5,MB1,F]  84-7-92ms      | [S2,MB4,F]  97-11-108ms    | [S5,MB2,F]  115-9-125ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-0-194ms    | [S5,MB3,F]  194-8-203ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-0-283ms    | [S2,MB5,F]  285-9-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-0-305ms    | [S5,MB4,F]  305-7-313ms    | [S5,MB2,BI] 371-10-381ms   | [S5,MB2,BW] 381-0-381ms    | [S2,MB6,F]  393-10-403ms   | [S2,MB1,BI] 404-10-415ms   | [S2,MB1,BW] 415-0-415ms    | [S5,MB5,F]  417-7-425ms    | [S5,MB3,BI] 507-11-518ms   | [S5,MB3,BW] 518-0-518ms    | [S2,MB7,F]  519-10-529ms   | [S2,MB2,BI] 529-10-540ms   | [S2,MB2,BW] 540-0-540ms    | [S5,MB6,F]  540-7-548ms    | [S5,MB4,BI] 629-10-639ms   | [S5,MB4,BW] 639-0-639ms    | [S2,MB3,BI] 735-9-744ms    | [S2,MB3,BW] 744-0-744ms    | [S5,MB7,F]  762-7-770ms    | [S5,MB5,BI] 770-9-779ms    | [S5,MB5,BW] 779-0-779ms    | [S2,MB4,BI] 860-9-870ms    | [S5,MB6,BI] 878-10-889ms   | [S2,MB5,BI] 889-10-899ms   | [S5,MB7,BI] 985-9-994ms    | [S2,MB6,BI] 994-11-1005ms  | [S2,MB4,BW] 1005-0-1005ms  | [S2,MB7,BI] 1020-9-1030ms  | [S2,MB5,BW] 1029-0-1029ms  | [S5,MB6,BW] 1030-0-1030ms  | [S5,MB7,BW] 1030-0-1030ms  | [S2,MB6,BW] 1032-0-1032ms  | [S2,MB7,BW] 1034-0-1034ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-55ms      | [S4,MB1,F]  55-7-62ms      | [S3,MB2,F]  65-7-72ms      | [S4,MB2,F]  72-7-80ms      | [S3,MB3,F]  99-7-106ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 283-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-7-311ms    | [S3,MB1,BI] 312-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  419-7-426ms    | [S3,MB2,BI] 426-9-435ms    | [S3,MB2,BW] 435-9-445ms    | [S4,MB6,F]  445-7-452ms    | [S4,MB3,BI] 521-11-532ms   | [S4,MB3,BW] 532-9-541ms    | [S3,MB7,F]  541-7-549ms    | [S3,MB3,BI] 549-9-558ms    | [S3,MB3,BW] 558-9-568ms    | [S4,MB7,F]  568-7-576ms    | [S4,MB4,BI] 728-10-739ms   | [S4,MB4,BW] 739-9-748ms    | [S3,MB4,BI] 748-10-759ms   | [S4,MB5,BI] 854-10-864ms   | [S3,MB5,BI] 864-9-873ms    | [S4,MB6,BI] 889-9-898ms    | [S3,MB6,BI] 898-9-907ms    | [S4,MB7,BI] 996-9-1005ms   | [S3,MB7,BI] 1005-9-1014ms  | [S3,MB4,BW] 1014-10-1024ms | [S4,MB5,BW] 1024-9-1033ms  | [S4,MB6,BW] 1033-9-1043ms  | [S4,MB7,BW] 1043-9-1053ms  | [S3,MB5,BW] 1053-10-1063ms | [S3,MB6,BW] 1063-10-1073ms | [S3,MB7,BW] 1074-10-1085ms
[rank3]:2025-12-26 19:00:11,314 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1900_stage3_step100.svg
[rank3]:2025-12-26 19:00:11,354 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1900_stage4_step100.svg
[rank3]:2025-12-26 19:00:11,455 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank3_stage3.svg
[rank3]:	> Counts Sum: 27, Total Sum: 90 (30.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]
[rank3]:2025-12-26 19:00:11,554 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1900_rank3_stage4.svg
[rank3]:	> Counts Sum: 9, Total Sum: 90 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 19:00:51,734 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 3.5250e+00
[rank1]:2025-12-26 19:00:51,716 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 7.7760e+00
[rank2]:2025-12-26 19:00:51,708 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:00:51,701 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 8.3325e+00
[rank2]:2025-12-26 19:01:38,627 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 5.1192e+00
[rank1]:2025-12-26 19:01:38,619 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.9597e+00
[rank3]:2025-12-26 19:01:38,626 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 5.2466e+00
[rank0]:2025-12-26 19:01:38,656 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 5.0895e+00
[rank3]:2025-12-26 19:02:23,380 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 5.5768e+00
[rank1]:2025-12-26 19:02:23,393 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.2200e+01
[rank2]:2025-12-26 19:02:23,380 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 9.7687e+00
[rank0]:2025-12-26 19:02:23,413 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.7967e+01
[rank1]:2025-12-26 19:03:06,326 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:03:06,305 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-26 19:03:06,409 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 2.7242e+00
[rank3]:2025-12-26 19:03:06,391 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 1.2077e+00
[rank0]:2025-12-26 19:03:50,767 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-26 19:03:50,948 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-26 19:03:51,065 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.5699e+00
[rank1]:2025-12-26 19:03:51,045 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:03:51,031 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:03:55,387 - Avg. fwd time: 7.8664 / Avg. bwd-weight time: 7.8857 / Avg. bwd-input time: 9.6382 / Avg. batch time: 1035.3058 (ms) / GPU bubble ratio: 60.76%
[rank3]:2025-12-26 19:03:55,421 -  step: 150  loss: -4.0000  grad_norm: 21.3311  memory: 15.27GiB(32.13%)  tps: 7,297  tflops: 57.04  mfu: 18.28%
[rank0]:2025-12-26 19:03:55,375 - Avg. fwd time: 13.8438 / Avg. full-bwd time: 26.8498 (Avg. bwd-weight time: 30.4081 / Avg. bwd-input time: 34.6478) / Avg. batch time: 1104.1456 (ms) / GPU bubble ratio: 13.35%
[rank1]:2025-12-26 19:03:55,401 - Avg. fwd time: 9.9423 / Avg. bwd-weight time: 11.5870 / Avg. bwd-input time: 12.1996 / Avg. batch time: 1083.2419 (ms) / GPU bubble ratio: 50.18%
[rank2]:2025-12-26 19:03:55,378 - Avg. fwd time: 8.3105 / Avg. bwd-weight time: 8.0570 / Avg. bwd-input time: 10.0427 / Avg. batch time: 1043.2928 (ms) / GPU bubble ratio: 59.50%
[rank2]:2025-12-26 19:03:55,420 -  step: 150  loss: -4.0000  grad_norm: 21.3311  memory: 13.80GiB(29.05%)  tps: 7,297  tflops: 57.04  mfu: 18.28%
[rank0]:2025-12-26 19:03:55,440 -  step: 150  loss:  3.7671  grad_norm: 21.3311  memory: 35.62GiB(74.97%)  tps: 7,297  tflops: 57.05  mfu: 18.28%
[rank1]:2025-12-26 19:03:55,428 -  step: 150  loss: -4.0000  grad_norm: 21.3311  memory: 17.83GiB(37.53%)  tps: 7,297  tflops: 57.04  mfu: 18.28%
[rank1]:2025-12-26 19:04:34,615 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 4.5209e+00
[rank2]:2025-12-26 19:04:34,604 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 4.0846e+00
[rank0]:2025-12-26 19:04:34,623 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 4.5567e+00
[rank3]:2025-12-26 19:04:34,607 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 19:05:19,485 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:05:19,467 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:05:19,568 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 2.8306e+00
[rank0]:2025-12-26 19:05:19,593 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.5604e+00
[rank3]:2025-12-26 19:06:02,809 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-26 19:06:02,918 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:06:02,908 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:06:02,928 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 7.3156e+00
[rank2]:2025-12-26 19:06:47,480 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.5867e+01
[rank1]:2025-12-26 19:06:47,487 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.0974e+01
[rank0]:2025-12-26 19:06:47,506 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.4128e+00
[rank3]:2025-12-26 19:06:47,481 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:07:30,183 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 19:07:30,438 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-26 19:07:30,506 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 7.4961e+00
[rank3]:2025-12-26 19:07:30,519 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 7.3475e+00
[rank0]:2025-12-26 19:07:30,535 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 4.0710e+00
[rank2]:2025-12-26 19:07:35,004 - Avg. fwd time: 8.3491 / Avg. bwd-weight time: 7.5568 / Avg. bwd-input time: 10.0470 / Avg. batch time: 1034.7656 (ms) / GPU bubble ratio: 59.87%
[rank0]:2025-12-26 19:07:35,009 - Avg. fwd time: 13.8918 / Avg. full-bwd time: 25.1422 (Avg. bwd-weight time: 30.4531 / Avg. bwd-input time: 34.6550) / Avg. batch time: 1093.1040 (ms) / GPU bubble ratio: 13.62%
[rank3]:2025-12-26 19:07:34,940 - Avg. fwd time: 7.8600 / Avg. bwd-weight time: 7.8413 / Avg. bwd-input time: 9.6519 / Avg. batch time: 1029.0685 (ms) / GPU bubble ratio: 60.58%
[rank0]:2025-12-26 19:07:35,078 -  step: 200  loss:  1.1150  grad_norm: 18.1635  memory: 35.62GiB(74.97%)  tps: 7,460  tflops: 58.32  mfu: 18.69%
[rank2]:2025-12-26 19:07:35,054 -  step: 200  loss: -4.0000  grad_norm: 18.1635  memory: 13.80GiB(29.05%)  tps: 7,460  tflops: 58.32  mfu: 18.69%
[rank1]:2025-12-26 19:07:35,023 - Avg. fwd time: 9.9948 / Avg. bwd-weight time: 10.9034 / Avg. bwd-input time: 12.2014 / Avg. batch time: 1073.9393 (ms) / GPU bubble ratio: 50.69%
[rank1]:2025-12-26 19:07:35,059 -  step: 200  loss: -4.0000  grad_norm: 18.1635  memory: 17.83GiB(37.53%)  tps: 7,460  tflops: 58.32  mfu: 18.69%
[rank3]:2025-12-26 19:07:35,041 -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 15.27GiB(32.13%)  tps: 7,460  tflops: 58.32  mfu: 18.69%
[rank0]:2025-12-26 19:07:35,145 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1907_stage0_step200.svg
[rank2]:2025-12-26 19:07:35,136 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1907_stage2_step200.svg
[rank0]:2025-12-26 19:07:35,198 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1907_stage7_step200.svg
[rank2]:2025-12-26 19:07:35,178 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1907_stage5_step200.svg
[rank1]:2025-12-26 19:07:35,136 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1907_stage1_step200.svg
[rank1]:2025-12-26 19:07:35,178 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1907_stage6_step200.svg
[rank0]:2025-12-26 19:07:35,303 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank0_stage0.svg
[rank0]:	> Counts Sum: 135, Total Sum: 285 (47.37%), Ratio(%) per element: [0.0, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66]
[rank2]:2025-12-26 19:07:35,276 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank2_stage2.svg
[rank2]:	> Counts Sum: 108, Total Sum: 270 (40.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank1]:2025-12-26 19:07:35,302 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank1_stage1.svg
[rank1]:	> Counts Sum: 108, Total Sum: 405 (26.67%), Ratio(%) per element: [26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66]
[rank0]:2025-12-26 19:07:35,382 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank0_stage7.svg
[rank2]:2025-12-26 19:07:35,374 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank2_stage5.svg
[rank0]:	> Counts Sum: 0, Total Sum: 165 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:	> Counts Sum: 36, Total Sum: 270 (13.33%), Ratio(%) per element: [26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:07:35,401 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank1_stage6.svg
[rank1]:	> Counts Sum: 18, Total Sum: 270 (6.67%), Ratio(%) per element: [13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:07:35,410 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1907_step200_rank3.svg
[rank3]:			> Batch Time: 1041.48 ms, GPU Bubble Ratio: 14.44%, 57.34%, 70.85%, 57.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-10-56ms     | [S0,MB6,F]  56-10-66ms     | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-179ms   | [S7,MB0,BW] 179-26-206ms   | [S7,MB1,F]  206-16-222ms   | [S7,MB1,BI] 234-35-269ms   | [S7,MB1,BW] 269-30-299ms   | [S7,MB2,F]  300-19-319ms   | [S7,MB2,BI] 331-35-366ms   | [S7,MB2,BW] 366-30-397ms   | [S7,MB3,F]  397-19-417ms   | [S7,MB3,BI] 429-35-464ms   | [S7,MB3,BW] 464-32-496ms   | [S0,MB7,F]  495-11-506ms   | [S0,MB0,B]  506-18-525ms   | [S7,MB4,F]  526-18-545ms   | [S7,MB4,BI] 557-34-591ms   | [S7,MB4,BW] 591-30-621ms   | [S0,MB1,B]  621-17-639ms   | [S7,MB5,F]  639-18-658ms   | [S7,MB5,BI] 670-34-704ms   | [S7,MB5,BW] 705-31-736ms   | [S0,MB2,B]  736-17-754ms   | [S7,MB6,F]  754-18-773ms   | [S7,MB6,BI] 785-34-820ms   | [S7,MB6,BW] 821-31-852ms   | [S0,MB3,B]  852-18-870ms   | [S7,MB7,F]  871-18-889ms   | [S7,MB7,BI] 902-34-936ms   | [S7,MB7,BW] 936-31-967ms   | [S0,MB4,B]  967-18-985ms   | [S0,MB5,B]  986-18-1004ms  | [S0,MB6,B]  1004-17-1021ms | [S0,MB7,B]  1025-16-1041ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  46-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-111ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-8-134ms    | [S6,MB0,BI] 179-9-189ms    | [S6,MB0,BW] 189-10-199ms   | [S6,MB2,F]  199-7-206ms    | [S6,MB1,BI] 269-9-278ms    | [S6,MB1,BW] 278-10-289ms   | [S6,MB3,F]  289-7-296ms    | [S6,MB2,BI] 366-9-376ms    | [S6,MB2,BW] 376-10-387ms   | [S1,MB6,F]  386-12-399ms   | [S1,MB0,BI] 399-15-415ms   | [S1,MB0,BW] 414-0-414ms    | [S6,MB4,F]  416-7-424ms    | [S6,MB3,BI] 464-10-474ms   | [S6,MB3,BW] 474-9-484ms    | [S1,MB7,F]  506-14-521ms   | [S1,MB1,BI] 521-15-537ms   | [S1,MB1,BW] 537-0-537ms    | [S6,MB5,F]  538-7-546ms    | [S6,MB4,BI] 591-10-602ms   | [S6,MB4,BW] 601-9-611ms    | [S1,MB2,BI] 628-14-643ms   | [S1,MB2,BW] 642-0-642ms    | [S6,MB6,F]  714-7-721ms    | [S6,MB5,BI] 721-9-730ms    | [S6,MB5,BW] 730-11-742ms   | [S1,MB3,BI] 744-14-759ms   | [S1,MB3,BW] 758-0-758ms    | [S6,MB7,F]  830-7-837ms    | [S6,MB6,BI] 837-9-846ms    | [S6,MB6,BW] 846-11-858ms   | [S1,MB4,BI] 860-14-875ms   | [S6,MB7,BI] 936-10-947ms   | [S1,MB5,BI] 947-15-962ms   | [S1,MB4,BW] 962-0-962ms    | [S1,MB6,BI] 977-14-992ms   | [S1,MB5,BW] 991-0-991ms    | [S1,MB7,BI] 1001-13-1015ms | [S1,MB6,BW] 1015-0-1015ms  | [S6,MB7,BW] 1015-10-1026ms | [S1,MB7,BW] 1026-0-1026ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  77-10-87ms     | [S5,MB1,F]  87-7-95ms      | [S2,MB4,F]  101-10-112ms   | [S5,MB2,F]  120-8-129ms    | [S5,MB0,BI] 189-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  199-8-208ms    | [S5,MB1,BI] 279-9-288ms    | [S5,MB1,BW] 288-0-288ms    | [S2,MB5,F]  290-9-299ms    | [S2,MB0,BI] 298-10-309ms   | [S2,MB0,BW] 309-0-309ms    | [S5,MB4,F]  310-7-318ms    | [S5,MB2,BI] 376-10-386ms   | [S5,MB2,BW] 386-0-386ms    | [S2,MB6,F]  399-10-410ms   | [S2,MB1,BI] 411-10-422ms   | [S2,MB1,BW] 422-0-422ms    | [S5,MB5,F]  423-7-431ms    | [S5,MB3,BI] 511-10-522ms   | [S5,MB3,BW] 522-0-522ms    | [S2,MB7,F]  524-10-534ms   | [S2,MB2,BI] 535-10-546ms   | [S2,MB2,BW] 546-0-546ms    | [S5,MB6,F]  547-7-554ms    | [S5,MB4,BI] 622-10-632ms   | [S5,MB4,BW] 632-0-632ms    | [S2,MB3,BI] 717-9-726ms    | [S2,MB3,BW] 726-0-726ms    | [S5,MB7,F]  744-7-752ms    | [S5,MB5,BI] 752-9-762ms    | [S5,MB5,BW] 762-0-762ms    | [S2,MB4,BI] 833-9-842ms    | [S5,MB6,BI] 854-10-864ms   | [S2,MB5,BI] 864-10-874ms   | [S5,MB7,BI] 950-9-959ms    | [S2,MB6,BI] 960-10-970ms   | [S2,MB4,BW] 970-0-970ms    | [S2,MB7,BI] 985-9-994ms    | [S2,MB5,BW] 995-0-995ms    | [S5,MB6,BW] 995-0-995ms    | [S5,MB7,BW] 995-0-995ms    | [S2,MB6,BW] 995-0-995ms    | [S2,MB7,BW] 995-0-995ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-56ms      | [S4,MB1,F]  56-7-63ms      | [S3,MB2,F]  66-7-74ms      | [S4,MB2,F]  74-7-81ms      | [S3,MB3,F]  102-7-110ms    | [S4,MB3,F]  110-8-118ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-9-217ms    | [S3,MB4,F]  216-7-223ms    | [S3,MB0,BI] 224-9-233ms    | [S3,MB0,BW] 233-9-243ms    | [S4,MB4,F]  243-7-250ms    | [S4,MB1,BI] 288-10-299ms   | [S4,MB1,BW] 299-10-309ms   | [S3,MB5,F]  309-7-316ms    | [S3,MB1,BI] 317-9-326ms    | [S3,MB1,BW] 326-9-336ms    | [S4,MB5,F]  336-7-344ms    | [S4,MB2,BI] 404-11-415ms   | [S4,MB2,BW] 416-9-426ms    | [S3,MB6,F]  424-7-432ms    | [S3,MB2,BI] 432-9-441ms    | [S3,MB2,BW] 441-9-451ms    | [S4,MB6,F]  451-7-459ms    | [S4,MB3,BI] 526-11-538ms   | [S4,MB3,BW] 538-9-548ms    | [S3,MB7,F]  547-7-554ms    | [S3,MB3,BI] 554-9-564ms    | [S3,MB3,BW] 564-9-573ms    | [S4,MB7,F]  573-7-581ms    | [S4,MB4,BI] 710-10-721ms   | [S4,MB4,BW] 721-9-730ms    | [S3,MB4,BI] 730-10-740ms   | [S4,MB5,BI] 826-10-836ms   | [S3,MB5,BI] 837-9-846ms    | [S4,MB6,BI] 865-9-874ms    | [S3,MB6,BI] 874-9-883ms    | [S4,MB7,BI] 961-9-970ms    | [S3,MB7,BI] 970-9-979ms    | [S3,MB4,BW] 979-10-989ms   | [S4,MB5,BW] 989-9-999ms    | [S4,MB6,BW] 999-9-1008ms   | [S4,MB7,BW] 1008-9-1017ms  | [S3,MB5,BW] 1018-10-1028ms | [S3,MB6,BW] 1028-10-1038ms | [S3,MB7,BW] 1038-10-1049ms
[rank3]:2025-12-26 19:07:35,455 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1907_stage3_step200.svg
[rank3]:2025-12-26 19:07:35,497 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1907_stage4_step200.svg
[rank3]:2025-12-26 19:07:35,595 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank3_stage3.svg
[rank3]:	> Counts Sum: 99, Total Sum: 270 (36.67%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33]
[rank3]:2025-12-26 19:07:35,694 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1907_rank3_stage4.svg
[rank3]:	> Counts Sum: 36, Total Sum: 270 (13.33%), Ratio(%) per element: [26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:08:15,789 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:08:15,902 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:08:15,928 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.4849e+00
[rank1]:2025-12-26 19:08:15,910 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 7.1884e+00
[rank1]:2025-12-26 19:08:58,795 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:08:58,857 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 4.7114e+00
[rank0]:2025-12-26 19:08:58,877 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 5.6783e+00
[rank3]:2025-12-26 19:08:58,861 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:09:43,473 - Freezing Ratio: [Stage2] 0.50, [Stage5] 0.00, Threshold: 3.4496e+00
[rank3]:2025-12-26 19:09:43,474 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 2.9837e+00
[rank0]:2025-12-26 19:09:43,498 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.0430e+00
[rank1]:2025-12-26 19:09:43,480 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:10:26,989 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 3.3177e+00
[rank2]:2025-12-26 19:10:26,978 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 6.2362e+00
[rank1]:2025-12-26 19:10:26,997 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 3.5577e+00
[rank0]:2025-12-26 19:10:27,006 - Freezing Ratio: [Stage0] 0.47, [Stage7] 0.00, Threshold: 2.5587e+00
[rank0]:2025-12-26 19:11:11,605 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-26 19:11:11,808 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:11:11,876 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 3.6568e+00
[rank3]:2025-12-26 19:11:11,868 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 7.3385e+00
[rank0]:2025-12-26 19:11:11,901 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.8497e+00
[rank1]:2025-12-26 19:11:16,188 - Avg. fwd time: 10.0420 / Avg. bwd-weight time: 10.2842 / Avg. bwd-input time: 12.2075 / Avg. batch time: 1068.9232 (ms) / GPU bubble ratio: 51.30%
[rank2]:2025-12-26 19:11:16,144 - Avg. fwd time: 8.3053 / Avg. bwd-weight time: 7.8560 / Avg. bwd-input time: 10.0607 / Avg. batch time: 1033.2580 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-26 19:11:16,165 - Avg. fwd time: 13.9164 / Avg. full-bwd time: 24.3063 (Avg. bwd-weight time: 30.4814 / Avg. bwd-input time: 34.6540) / Avg. batch time: 1087.6235 (ms) / GPU bubble ratio: 13.74%
[rank3]:2025-12-26 19:11:16,182 - Avg. fwd time: 7.8604 / Avg. bwd-weight time: 7.6996 / Avg. bwd-input time: 9.6588 / Avg. batch time: 1024.9030 (ms) / GPU bubble ratio: 60.63%
[rank3]:2025-12-26 19:11:16,211 -  step: 250  loss: -4.0000  grad_norm:  8.0436  memory: 15.27GiB(32.13%)  tps: 7,408  tflops: 57.91  mfu: 18.56%
[rank1]:2025-12-26 19:11:16,214 -  step: 250  loss: -4.0000  grad_norm:  8.0436  memory: 17.83GiB(37.53%)  tps: 7,408  tflops: 57.92  mfu: 18.56%
[rank2]:2025-12-26 19:11:16,203 -  step: 250  loss: -4.0000  grad_norm:  8.0436  memory: 13.80GiB(29.05%)  tps: 7,409  tflops: 57.92  mfu: 18.56%
[rank0]:2025-12-26 19:11:16,229 -  step: 250  loss:  0.4173  grad_norm:  8.0436  memory: 35.62GiB(74.97%)  tps: 7,409  tflops: 57.92  mfu: 18.56%
[rank3]:2025-12-26 19:11:55,315 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 2.0797e+01
[rank1]:2025-12-26 19:11:55,323 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:11:55,305 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 1.7996e+01
[rank0]:2025-12-26 19:11:55,332 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.7763e+01
[rank2]:2025-12-26 19:12:38,692 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 4.7784e+00
[rank3]:2025-12-26 19:12:38,692 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 5.7934e+00
[rank1]:2025-12-26 19:12:38,710 - Freezing Ratio: [Stage1] 0.67, [Stage6] 0.00, Threshold: 4.5856e+00
[rank0]:2025-12-26 19:12:38,720 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.6140e+00
[rank3]:2025-12-26 19:13:21,727 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 2.3535e+00
[rank2]:2025-12-26 19:13:21,716 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 2.6393e+00
[rank1]:2025-12-26 19:13:21,716 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 6.2922e+00
[rank0]:2025-12-26 19:13:21,745 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.5895e+00
[rank3]:2025-12-26 19:14:05,213 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:14:05,304 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 3.9628e+00
[rank0]:2025-12-26 19:14:05,331 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.1311e+00
[rank1]:2025-12-26 19:14:05,322 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 4.0698e+00
[rank0]:2025-12-26 19:14:47,915 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 19:14:48,160 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-26 19:14:48,260 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.3674e-01
[rank1]:2025-12-26 19:14:48,179 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:14:48,243 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:14:52,526 - Avg. fwd time: 13.9376 / Avg. full-bwd time: 23.1771 (Avg. bwd-weight time: 30.4810 / Avg. bwd-input time: 34.6555) / Avg. batch time: 1080.3707 (ms) / GPU bubble ratio: 13.96%
[rank2]:2025-12-26 19:14:52,500 - Avg. fwd time: 8.3525 / Avg. bwd-weight time: 7.2313 / Avg. bwd-input time: 10.0710 / Avg. batch time: 1025.1300 (ms) / GPU bubble ratio: 59.96%
[rank2]:2025-12-26 19:14:52,564 -  step: 300  loss: -4.0000  grad_norm:  0.6503  memory: 13.80GiB(29.05%)  tps: 7,573  tflops: 59.20  mfu: 18.97%
[rank1]:2025-12-26 19:14:52,552 - Avg. fwd time: 10.0547 / Avg. bwd-weight time: 10.0491 / Avg. bwd-input time: 12.2188 / Avg. batch time: 1063.3553 (ms) / GPU bubble ratio: 51.37%
[rank3]:2025-12-26 19:14:52,540 - Avg. fwd time: 7.8689 / Avg. bwd-weight time: 7.5686 / Avg. bwd-input time: 9.6735 / Avg. batch time: 1019.5822 (ms) / GPU bubble ratio: 60.59%
[rank3]:2025-12-26 19:14:52,571 -  step: 300  loss: -4.0000  grad_norm:  0.6503  memory: 15.27GiB(32.13%)  tps: 7,573  tflops: 59.20  mfu: 18.97%
[rank0]:2025-12-26 19:14:52,591 -  step: 300  loss:  0.2773  grad_norm:  0.6503  memory: 35.62GiB(74.97%)  tps: 7,573  tflops: 59.20  mfu: 18.97%
[rank0]:2025-12-26 19:14:52,640 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1914_stage0_step300.svg
[rank2]:2025-12-26 19:14:52,642 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1914_stage2_step300.svg
[rank1]:2025-12-26 19:14:52,577 -  step: 300  loss: -4.0000  grad_norm:  0.6503  memory: 17.83GiB(37.53%)  tps: 7,572  tflops: 59.20  mfu: 18.97%
[rank1]:2025-12-26 19:14:52,641 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1914_stage1_step300.svg
[rank0]:2025-12-26 19:14:52,681 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1914_stage7_step300.svg
[rank2]:2025-12-26 19:14:52,683 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1914_stage5_step300.svg
[rank1]:2025-12-26 19:14:52,682 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1914_stage6_step300.svg
[rank0]:2025-12-26 19:14:52,784 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank0_stage0.svg
[rank0]:	> Counts Sum: 297, Total Sum: 475 (62.53%), Ratio(%) per element: [0.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0]
[rank0]:2025-12-26 19:14:52,864 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank0_stage7.svg
[rank0]:	> Counts Sum: 0, Total Sum: 275 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 19:14:52,780 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank2_stage2.svg
[rank2]:	> Counts Sum: 225, Total Sum: 450 (50.00%), Ratio(%) per element: [52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0]
[rank1]:2025-12-26 19:14:52,805 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank1_stage1.svg
[rank1]:	> Counts Sum: 207, Total Sum: 675 (30.67%), Ratio(%) per element: [32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0]
[rank2]:2025-12-26 19:14:52,878 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank2_stage5.svg
[rank2]:	> Counts Sum: 45, Total Sum: 450 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:14:52,903 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank1_stage6.svg
[rank1]:	> Counts Sum: 45, Total Sum: 450 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:14:52,913 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1914_step300_rank3.svg
[rank3]:			> Batch Time: 1036.80 ms, GPU Bubble Ratio: 14.35%, 64.62%, 70.64%, 57.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  46-10-56ms     | [S0,MB6,F]  56-10-66ms     | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-179ms   | [S7,MB0,BW] 179-25-205ms   | [S7,MB1,F]  206-16-223ms   | [S7,MB1,BI] 235-34-270ms   | [S7,MB1,BW] 270-30-300ms   | [S7,MB2,F]  300-19-320ms   | [S7,MB2,BI] 331-35-366ms   | [S7,MB2,BW] 366-31-397ms   | [S7,MB3,F]  398-19-418ms   | [S7,MB3,BI] 429-35-464ms   | [S7,MB3,BW] 464-31-495ms   | [S0,MB7,F]  496-11-507ms   | [S0,MB0,B]  507-18-525ms   | [S7,MB4,F]  524-18-542ms   | [S7,MB4,BI] 555-34-589ms   | [S7,MB4,BW] 590-31-621ms   | [S0,MB1,B]  620-17-638ms   | [S7,MB5,F]  638-18-657ms   | [S7,MB5,BI] 669-34-704ms   | [S7,MB5,BW] 704-31-735ms   | [S0,MB2,B]  735-17-752ms   | [S7,MB6,F]  752-18-771ms   | [S7,MB6,BI] 783-34-817ms   | [S7,MB6,BW] 818-30-849ms   | [S0,MB3,B]  849-17-866ms   | [S7,MB7,F]  867-18-885ms   | [S7,MB7,BI] 898-34-932ms   | [S7,MB7,BW] 932-30-963ms   | [S0,MB4,B]  963-17-980ms   | [S0,MB5,B]  981-17-999ms   | [S0,MB6,B]  999-17-1016ms  | [S0,MB7,B]  1020-16-1036ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  45-12-57ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-11-100ms    | [S6,MB0,F]  100-10-110ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-8-134ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-0-188ms    | [S6,MB2,F]  189-8-198ms    | [S6,MB1,BI] 269-9-278ms    | [S6,MB1,BW] 278-0-278ms    | [S6,MB3,F]  279-8-288ms    | [S6,MB2,BI] 366-9-375ms    | [S6,MB2,BW] 375-0-375ms    | [S1,MB6,F]  376-13-390ms   | [S1,MB0,BI] 389-15-405ms   | [S1,MB0,BW] 405-0-405ms    | [S6,MB4,F]  406-8-414ms    | [S6,MB3,BI] 462-10-473ms   | [S6,MB3,BW] 473-0-473ms    | [S1,MB7,F]  505-14-520ms   | [S1,MB1,BI] 520-15-535ms   | [S1,MB1,BW] 535-0-535ms    | [S6,MB5,F]  537-7-545ms    | [S6,MB4,BI] 589-10-599ms   | [S6,MB4,BW] 599-0-599ms    | [S1,MB2,BI] 627-14-641ms   | [S1,MB2,BW] 641-0-641ms    | [S6,MB6,F]  711-7-719ms    | [S6,MB5,BI] 719-9-728ms    | [S6,MB5,BW] 728-0-728ms    | [S1,MB3,BI] 740-14-754ms   | [S1,MB3,BW] 754-0-754ms    | [S6,MB7,F]  825-7-833ms    | [S6,MB6,BI] 833-9-842ms    | [S6,MB6,BW] 842-0-842ms    | [S1,MB4,BI] 855-14-870ms   | [S6,MB7,BI] 930-10-940ms   | [S1,MB5,BI] 941-15-956ms   | [S1,MB4,BW] 956-0-956ms    | [S1,MB6,BI] 971-14-985ms   | [S1,MB5,BW] 985-0-985ms    | [S1,MB7,BI] 996-14-1010ms  | [S1,MB6,BW] 1011-0-1011ms  | [S6,MB7,BW] 1013-0-1013ms  | [S1,MB7,BW] 1013-0-1013ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  76-10-87ms     | [S5,MB1,F]  87-7-95ms      | [S2,MB4,F]  100-11-111ms   | [S5,MB2,F]  119-8-128ms    | [S5,MB0,BI] 188-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  198-8-207ms    | [S5,MB1,BI] 278-9-287ms    | [S5,MB1,BW] 287-0-287ms    | [S2,MB5,F]  289-9-298ms    | [S2,MB0,BI] 298-10-309ms   | [S2,MB0,BW] 309-0-309ms    | [S5,MB4,F]  309-7-317ms    | [S5,MB2,BI] 375-10-385ms   | [S5,MB2,BW] 385-0-385ms    | [S2,MB6,F]  390-10-400ms   | [S2,MB1,BI] 402-10-412ms   | [S2,MB1,BW] 412-0-412ms    | [S5,MB5,F]  412-7-420ms    | [S5,MB3,BI] 509-10-520ms   | [S5,MB3,BW] 520-0-520ms    | [S2,MB7,F]  522-10-533ms   | [S2,MB2,BI] 533-10-544ms   | [S2,MB2,BW] 543-0-543ms    | [S5,MB6,F]  543-7-551ms    | [S5,MB4,BI] 620-10-631ms   | [S5,MB4,BW] 630-0-630ms    | [S2,MB3,BI] 714-9-724ms    | [S2,MB3,BW] 724-0-724ms    | [S5,MB7,F]  739-7-747ms    | [S5,MB5,BI] 747-9-757ms    | [S5,MB5,BW] 757-0-757ms    | [S2,MB4,BI] 828-9-838ms    | [S5,MB6,BI] 848-10-859ms   | [S2,MB5,BI] 859-10-869ms   | [S5,MB7,BI] 944-9-953ms    | [S2,MB6,BI] 953-11-965ms   | [S2,MB4,BW] 965-0-965ms    | [S2,MB7,BI] 980-9-989ms    | [S2,MB5,BW] 989-0-989ms    | [S5,MB6,BW] 989-0-989ms    | [S5,MB7,BW] 991-0-991ms    | [S2,MB6,BW] 992-0-992ms    | [S2,MB7,BW] 992-0-992ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-56ms      | [S4,MB1,F]  56-7-63ms      | [S3,MB2,F]  66-7-73ms      | [S4,MB2,F]  73-7-81ms      | [S3,MB3,F]  102-7-110ms    | [S4,MB3,F]  110-8-118ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-9-216ms    | [S3,MB4,F]  216-7-224ms    | [S3,MB0,BI] 223-9-233ms    | [S3,MB0,BW] 233-9-243ms    | [S4,MB4,F]  242-7-250ms    | [S4,MB1,BI] 288-11-299ms   | [S4,MB1,BW] 299-10-309ms   | [S3,MB5,F]  309-7-316ms    | [S3,MB1,BI] 316-9-326ms    | [S3,MB1,BW] 326-9-335ms    | [S4,MB5,F]  335-7-342ms    | [S4,MB2,BI] 395-11-406ms   | [S4,MB2,BW] 406-9-416ms    | [S3,MB6,F]  415-7-423ms    | [S3,MB2,BI] 423-9-432ms    | [S3,MB2,BW] 432-9-442ms    | [S4,MB6,F]  441-7-449ms    | [S4,MB3,BI] 525-11-536ms   | [S4,MB3,BW] 536-9-546ms    | [S3,MB7,F]  546-7-553ms    | [S3,MB3,BI] 553-9-562ms    | [S3,MB3,BW] 563-9-572ms    | [S4,MB7,F]  572-7-579ms    | [S4,MB4,BI] 708-10-718ms   | [S4,MB4,BW] 719-9-728ms    | [S3,MB4,BI] 727-10-738ms   | [S4,MB5,BI] 822-10-832ms   | [S3,MB5,BI] 833-9-842ms    | [S4,MB6,BI] 860-9-869ms    | [S3,MB6,BI] 869-9-878ms    | [S4,MB7,BI] 955-9-964ms    | [S3,MB7,BI] 965-9-974ms    | [S3,MB4,BW] 974-10-984ms   | [S4,MB5,BW] 982-9-992ms    | [S4,MB6,BW] 991-9-1001ms   | [S4,MB7,BW] 1001-9-1010ms  | [S3,MB5,BW] 1010-10-1020ms | [S3,MB6,BW] 1020-10-1031ms | [S3,MB7,BW] 1031-10-1041ms
[rank3]:2025-12-26 19:14:52,955 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1914_stage3_step300.svg
[rank3]:2025-12-26 19:14:52,996 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1914_stage4_step300.svg
[rank3]:2025-12-26 19:14:53,095 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank3_stage3.svg
[rank3]:	> Counts Sum: 144, Total Sum: 450 (32.00%), Ratio(%) per element: [36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0]
[rank3]:2025-12-26 19:14:53,194 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1914_rank3_stage4.svg
[rank3]:	> Counts Sum: 45, Total Sum: 450 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 19:15:32,174 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:15:32,201 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.2228e+00
[rank1]:2025-12-26 19:15:32,192 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:15:32,184 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 1.2438e+00
[rank3]:2025-12-26 19:16:15,589 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.9860e+00
[rank0]:2025-12-26 19:16:15,616 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.0182e+00
[rank2]:2025-12-26 19:16:15,596 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 1.6847e+00
[rank1]:2025-12-26 19:16:15,607 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.6302e+00
[rank1]:2025-12-26 19:16:58,639 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:16:58,692 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.6324e+00
[rank0]:2025-12-26 19:16:58,722 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.6406e+00
[rank3]:2025-12-26 19:16:58,704 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 1.8474e+00
[rank3]:2025-12-26 19:17:42,111 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 8.2674e-01
[rank1]:2025-12-26 19:17:42,130 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:17:42,120 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 8.7719e-01
[rank0]:2025-12-26 19:17:42,138 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.7879e-01
[rank0]:2025-12-26 19:18:25,183 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-26 19:18:25,519 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 7.6434e-01
[rank2]:2025-12-26 19:18:25,501 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 6.0040e-01
[rank0]:2025-12-26 19:18:25,529 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 6.6528e-01
[rank3]:2025-12-26 19:18:25,512 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 4.7915e-01
[rank3]:2025-12-26 19:18:29,777 - Avg. fwd time: 7.8727 / Avg. bwd-weight time: 7.5901 / Avg. bwd-input time: 9.6828 / Avg. batch time: 1016.3303 (ms) / GPU bubble ratio: 60.41%
[rank2]:2025-12-26 19:18:29,839 - Avg. fwd time: 8.3494 / Avg. bwd-weight time: 7.2329 / Avg. bwd-input time: 10.0787 / Avg. batch time: 1021.7905 (ms) / GPU bubble ratio: 59.82%
[rank0]:2025-12-26 19:18:29,833 - Avg. fwd time: 13.9480 / Avg. full-bwd time: 22.3652 (Avg. bwd-weight time: 30.4841 / Avg. bwd-input time: 34.6518) / Avg. batch time: 1075.6855 (ms) / GPU bubble ratio: 14.18%
[rank3]:2025-12-26 19:18:29,866 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 15.27GiB(32.13%)  tps: 7,540  tflops: 58.94  mfu: 18.89%
[rank1]:2025-12-26 19:18:29,860 - Avg. fwd time: 10.0574 / Avg. bwd-weight time: 10.1041 / Avg. bwd-input time: 12.2282 / Avg. batch time: 1060.6953 (ms) / GPU bubble ratio: 51.14%
[rank1]:2025-12-26 19:18:29,884 -  step: 350  loss: -4.0000  grad_norm:  0.2090  memory: 17.83GiB(37.53%)  tps: 7,540  tflops: 58.94  mfu: 18.89%
[rank2]:2025-12-26 19:18:29,879 -  step: 350  loss: -4.0000  grad_norm:  0.2090  memory: 13.80GiB(29.05%)  tps: 7,539  tflops: 58.94  mfu: 18.89%
[rank0]:2025-12-26 19:18:29,899 -  step: 350  loss:  0.2289  grad_norm:  0.2090  memory: 35.62GiB(74.97%)  tps: 7,540  tflops: 58.94  mfu: 18.89%
[rank3]:2025-12-26 19:19:08,878 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:19:08,980 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 2.6390e-01
[rank1]:2025-12-26 19:19:08,989 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 8.5370e-01
[rank0]:2025-12-26 19:19:08,999 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.0066e-01
[rank2]:2025-12-26 19:19:52,422 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:19:52,512 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 19:19:52,520 - Freezing Ratio: [Stage1] 0.67, [Stage6] 0.00, Threshold: 1.5331e+00
[rank0]:2025-12-26 19:19:52,529 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.4107e+00
[rank2]:2025-12-26 19:20:35,407 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 19:20:35,397 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 6.1491e+00
[rank3]:2025-12-26 19:20:35,409 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 3.1126e+00
[rank0]:2025-12-26 19:20:35,426 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.7943e+00
[rank1]:2025-12-26 19:21:18,765 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 5.0179e-01
[rank2]:2025-12-26 19:21:18,756 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 3.4494e-01
[rank0]:2025-12-26 19:21:18,774 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.2738e-01
[rank3]:2025-12-26 19:21:18,756 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 2.8050e-01
[rank0]:2025-12-26 19:22:01,423 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 19:22:01,759 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 5.8946e-01
[rank0]:2025-12-26 19:22:01,776 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.1905e-01
[rank1]:2025-12-26 19:22:01,747 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 6.7907e-01
[rank2]:2025-12-26 19:22:01,758 - Freezing Ratio: [Stage2] 0.50, [Stage5] 0.00, Threshold: 4.5386e-01
[rank0]:2025-12-26 19:22:06,130 - Avg. fwd time: 13.9599 / Avg. full-bwd time: 21.7603 (Avg. bwd-weight time: 30.4801 / Avg. bwd-input time: 34.6536) / Avg. batch time: 1071.6970 (ms) / GPU bubble ratio: 14.29%
[rank2]:2025-12-26 19:22:06,105 - Avg. fwd time: 8.3452 / Avg. bwd-weight time: 7.3284 / Avg. bwd-input time: 10.0843 / Avg. batch time: 1019.9922 (ms) / GPU bubble ratio: 59.60%
[rank3]:2025-12-26 19:22:06,143 - Avg. fwd time: 7.8686 / Avg. bwd-weight time: 7.6579 / Avg. bwd-input time: 9.6910 / Avg. batch time: 1014.5379 (ms) / GPU bubble ratio: 60.23%
[rank3]:2025-12-26 19:22:06,176 -  step: 400  loss: -4.0000  grad_norm:  0.3076  memory: 15.27GiB(32.13%)  tps: 7,574  tflops: 59.21  mfu: 18.98%
[rank1]:2025-12-26 19:22:06,157 - Avg. fwd time: 10.0566 / Avg. bwd-weight time: 10.0807 / Avg. bwd-input time: 12.2361 / Avg. batch time: 1057.7828 (ms) / GPU bubble ratio: 51.03%
[rank1]:2025-12-26 19:22:06,182 -  step: 400  loss: -4.0000  grad_norm:  0.3076  memory: 17.83GiB(37.53%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank0]:2025-12-26 19:22:06,196 -  step: 400  loss:  0.2161  grad_norm:  0.3076  memory: 35.62GiB(74.97%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank2]:2025-12-26 19:22:06,170 -  step: 400  loss: -4.0000  grad_norm:  0.3076  memory: 13.80GiB(29.05%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank1]:2025-12-26 19:22:06,252 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1922_stage1_step400.svg
[rank1]:2025-12-26 19:22:06,298 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1922_stage6_step400.svg
[rank0]:2025-12-26 19:22:06,252 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1922_stage0_step400.svg
[rank0]:2025-12-26 19:22:06,298 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1922_stage7_step400.svg
[rank2]:2025-12-26 19:22:06,252 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1922_stage2_step400.svg
[rank2]:2025-12-26 19:22:06,297 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1922_stage5_step400.svg
[rank0]:2025-12-26 19:22:06,404 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank0_stage0.svg
[rank0]:	> Counts Sum: 477, Total Sum: 665 (71.73%), Ratio(%) per element: [0.0, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85]
[rank2]:2025-12-26 19:22:06,398 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank2_stage2.svg
[rank2]:	> Counts Sum: 288, Total Sum: 630 (45.71%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85]
[rank1]:2025-12-26 19:22:06,436 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank1_stage1.svg
[rank1]:	> Counts Sum: 279, Total Sum: 945 (29.52%), Ratio(%) per element: [31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 25.71, 25.71, 25.71, 25.71, 25.71, 25.71, 25.71, 25.71, 25.71]
[rank0]:2025-12-26 19:22:06,487 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank0_stage7.svg
[rank0]:	> Counts Sum: 0, Total Sum: 385 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 19:22:06,497 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank2_stage5.svg
[rank2]:	> Counts Sum: 54, Total Sum: 630 (8.57%), Ratio(%) per element: [17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:22:06,547 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1922_step400_rank3.svg
[rank3]:			> Batch Time: 1037.36 ms, GPU Bubble Ratio: 14.27%, 57.07%, 56.18%, 57.60%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-10-56ms     | [S0,MB6,F]  56-10-66ms     | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-180ms   | [S7,MB0,BW] 180-25-206ms   | [S7,MB1,F]  206-16-222ms   | [S7,MB1,BI] 234-34-269ms   | [S7,MB1,BW] 269-30-299ms   | [S7,MB2,F]  300-19-319ms   | [S7,MB2,BI] 331-35-366ms   | [S7,MB2,BW] 367-30-397ms   | [S7,MB3,F]  398-19-417ms   | [S7,MB3,BI] 429-35-464ms   | [S7,MB3,BW] 465-31-497ms   | [S0,MB7,F]  496-11-507ms   | [S0,MB0,B]  507-18-525ms   | [S7,MB4,F]  525-18-544ms   | [S7,MB4,BI] 556-34-590ms   | [S7,MB4,BW] 590-31-621ms   | [S0,MB1,B]  621-17-639ms   | [S7,MB5,F]  639-18-657ms   | [S7,MB5,BI] 670-34-704ms   | [S7,MB5,BW] 705-31-736ms   | [S0,MB2,B]  735-17-753ms   | [S7,MB6,F]  753-19-772ms   | [S7,MB6,BI] 783-34-818ms   | [S7,MB6,BW] 818-31-849ms   | [S0,MB3,B]  849-17-867ms   | [S7,MB7,F]  867-19-886ms   | [S7,MB7,BI] 898-34-933ms   | [S7,MB7,BW] 933-31-964ms   | [S0,MB4,B]  963-18-981ms   | [S0,MB5,B]  981-17-999ms   | [S0,MB6,B]  1000-17-1017ms | [S0,MB7,B]  1021-16-1037ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  46-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-111ms   | [S1,MB5,F]  111-14-126ms   | [S6,MB1,F]  126-8-134ms    | [S6,MB0,BI] 179-9-189ms    | [S6,MB0,BW] 189-10-199ms   | [S6,MB2,F]  199-7-206ms    | [S6,MB1,BI] 268-9-277ms    | [S6,MB1,BW] 277-10-288ms   | [S6,MB3,F]  288-7-295ms    | [S6,MB2,BI] 365-9-374ms    | [S6,MB2,BW] 374-10-385ms   | [S1,MB6,F]  385-12-397ms   | [S1,MB0,BI] 397-15-413ms   | [S1,MB0,BW] 413-0-413ms    | [S6,MB4,F]  415-7-423ms    | [S6,MB3,BI] 463-10-473ms   | [S6,MB3,BW] 473-9-483ms    | [S1,MB7,F]  506-15-521ms   | [S1,MB1,BI] 521-15-536ms   | [S1,MB1,BW] 536-0-536ms    | [S6,MB5,F]  538-7-546ms    | [S6,MB4,BI] 588-10-599ms   | [S6,MB4,BW] 598-9-608ms    | [S1,MB2,BI] 626-14-641ms   | [S1,MB2,BW] 641-0-641ms    | [S6,MB6,F]  711-7-719ms    | [S6,MB5,BI] 718-9-728ms    | [S6,MB5,BW] 728-11-739ms   | [S1,MB3,BI] 742-14-757ms   | [S1,MB3,BW] 756-0-756ms    | [S6,MB7,F]  826-7-834ms    | [S6,MB6,BI] 834-9-843ms    | [S6,MB6,BW] 843-11-855ms   | [S1,MB4,BI] 857-14-872ms   | [S6,MB7,BI] 932-10-942ms   | [S1,MB5,BI] 943-15-958ms   | [S1,MB4,BW] 958-0-958ms    | [S1,MB6,BI] 973-14-987ms   | [S1,MB5,BW] 987-0-987ms    | [S1,MB7,BI] 998-14-1012ms  | [S1,MB6,BW] 1012-0-1012ms  | [S6,MB7,BW] 1014-10-1024ms | [S1,MB7,BW] 1024-0-1024ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  39-7-47ms      | [S2,MB2,F]  58-7-65ms      | [S5,MB0,F]  65-9-75ms      | [S2,MB3,F]  77-9-86ms      | [S5,MB1,F]  86-7-93ms      | [S2,MB4,F]  101-10-111ms   | [S5,MB2,F]  120-8-128ms    | [S5,MB0,BI] 189-9-198ms    | [S5,MB0,BW] 198-10-209ms   | [S5,MB3,F]  208-7-216ms    | [S5,MB1,BI] 277-9-287ms    | [S5,MB1,BW] 287-10-298ms   | [S2,MB5,F]  298-7-305ms    | [S2,MB0,BI] 305-10-315ms   | [S2,MB0,BW] 316-9-325ms    | [S5,MB4,F]  325-7-332ms    | [S5,MB2,BI] 375-10-385ms   | [S5,MB2,BW] 385-9-395ms    | [S2,MB6,F]  398-9-408ms    | [S2,MB1,BI] 409-10-420ms   | [S2,MB1,BW] 420-9-430ms    | [S5,MB5,F]  430-7-437ms    | [S5,MB3,BI] 510-10-521ms   | [S5,MB3,BW] 521-11-533ms   | [S2,MB7,F]  533-7-540ms    | [S2,MB2,BI] 540-10-551ms   | [S2,MB2,BW] 551-9-561ms    | [S5,MB6,F]  560-7-568ms    | [S5,MB4,BI] 620-10-630ms   | [S5,MB4,BW] 630-9-640ms    | [S2,MB3,BI] 714-9-724ms    | [S2,MB3,BW] 724-10-734ms   | [S5,MB7,F]  742-7-749ms    | [S5,MB5,BI] 750-9-759ms    | [S5,MB5,BW] 759-9-769ms    | [S2,MB4,BI] 829-9-839ms    | [S5,MB6,BI] 849-10-860ms   | [S2,MB5,BI] 860-10-870ms   | [S5,MB7,BI] 946-9-955ms    | [S2,MB6,BI] 955-10-966ms   | [S2,MB4,BW] 966-10-976ms   | [S2,MB7,BI] 981-9-991ms    | [S2,MB5,BW] 991-10-1001ms  | [S5,MB6,BW] 1001-9-1010ms  | [S5,MB7,BW] 1010-9-1020ms  | [S2,MB6,BW] 1020-9-1030ms  | [S2,MB7,BW] 1029-10-1039ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-55ms      | [S4,MB1,F]  56-7-63ms      | [S3,MB2,F]  65-7-73ms      | [S4,MB2,F]  73-7-81ms      | [S3,MB3,F]  102-7-110ms    | [S4,MB3,F]  110-8-118ms    | [S4,MB0,BI] 198-9-208ms    | [S4,MB0,BW] 208-9-217ms    | [S3,MB4,F]  217-7-224ms    | [S3,MB0,BI] 224-9-233ms    | [S3,MB0,BW] 233-9-243ms    | [S4,MB4,F]  243-7-251ms    | [S4,MB1,BI] 287-10-297ms   | [S4,MB1,BW] 297-10-307ms   | [S3,MB5,F]  307-8-316ms    | [S3,MB1,BI] 316-9-325ms    | [S3,MB1,BW] 325-9-335ms    | [S4,MB5,F]  335-7-343ms    | [S4,MB2,BI] 403-11-414ms   | [S4,MB2,BW] 414-9-424ms    | [S3,MB6,F]  424-7-431ms    | [S3,MB2,BI] 431-9-440ms    | [S3,MB2,BW] 440-9-450ms    | [S4,MB6,F]  450-7-458ms    | [S4,MB3,BI] 527-10-537ms   | [S4,MB3,BW] 537-10-548ms   | [S3,MB7,F]  547-7-555ms    | [S3,MB3,BI] 555-9-564ms    | [S3,MB3,BW] 564-9-574ms    | [S4,MB7,F]  574-7-582ms    | [S4,MB4,BI] 708-10-718ms   | [S4,MB4,BW] 718-9-728ms    | [S3,MB4,BI] 728-10-738ms   | [S4,MB5,BI] 823-10-833ms   | [S3,MB5,BI] 833-9-842ms    | [S4,MB6,BI] 860-9-870ms    | [S3,MB6,BI] 870-9-879ms    | [S4,MB7,BI] 956-9-966ms    | [S3,MB7,BI] 965-9-975ms    | [S3,MB4,BW] 974-10-985ms   | [S4,MB5,BW] 985-9-995ms    | [S4,MB6,BW] 994-9-1004ms   | [S4,MB7,BW] 1004-9-1014ms  | [S3,MB5,BW] 1014-10-1024ms | [S3,MB6,BW] 1024-10-1035ms | [S3,MB7,BW] 1035-10-1046ms
[rank3]:2025-12-26 19:22:06,595 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1922_stage3_step400.svg
[rank1]:2025-12-26 19:22:06,547 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank1_stage6.svg
[rank1]:	> Counts Sum: 54, Total Sum: 630 (8.57%), Ratio(%) per element: [17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:22:06,642 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1922_stage4_step400.svg
[rank3]:2025-12-26 19:22:06,746 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank3_stage3.svg
[rank3]:	> Counts Sum: 198, Total Sum: 630 (31.43%), Ratio(%) per element: [34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 28.57, 28.57, 28.57, 28.57, 28.57, 28.57, 28.57, 28.57, 28.57]
[rank3]:2025-12-26 19:22:06,849 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1922_rank3_stage4.svg
[rank3]:	> Counts Sum: 54, Total Sum: 630 (8.57%), Ratio(%) per element: [17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 19:22:31,243 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-26 19:22:31,547 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-26 19:22:31,584 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-26 19:22:31,596 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-26 19:22:45,754 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 6.2569e+00
[rank1]:2025-12-26 19:22:45,773 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.8333e+00
[rank0]:2025-12-26 19:22:45,782 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.7551e+00
[rank3]:2025-12-26 19:22:45,765 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 2.1618e+00
[rank1]:2025-12-26 19:23:28,633 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 5.9511e+00
[rank3]:2025-12-26 19:23:28,646 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 6.3156e+00
[rank2]:2025-12-26 19:23:28,642 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 5.4491e+00
[rank0]:2025-12-26 19:23:28,661 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.8548e+00
[rank2]:2025-12-26 19:24:11,834 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:24:11,920 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 1.4679e+00
[rank1]:2025-12-26 19:24:11,929 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.4469e+00
[rank0]:2025-12-26 19:24:11,938 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.4034e+00
[rank3]:2025-12-26 19:24:54,841 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 6.4571e+00
[rank1]:2025-12-26 19:24:54,789 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:24:54,850 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:24:54,871 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.2361e+00
[rank0]:2025-12-26 19:25:37,922 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-26 19:25:38,252 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 2.6046e+00
[rank0]:2025-12-26 19:25:38,270 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.5438e+00
[rank1]:2025-12-26 19:25:38,261 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:25:38,252 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 2.2231e+00
[rank3]:2025-12-26 19:25:42,471 - Avg. fwd time: 7.8579 / Avg. bwd-weight time: 7.7758 / Avg. bwd-input time: 9.6992 / Avg. batch time: 1013.3056 (ms) / GPU bubble ratio: 60.00%
[rank2]:2025-12-26 19:25:42,533 - Avg. fwd time: 8.3415 / Avg. bwd-weight time: 7.3166 / Avg. bwd-input time: 10.0880 / Avg. batch time: 1018.0301 (ms) / GPU bubble ratio: 59.54%
[rank2]:2025-12-26 19:25:42,571 -  step: 450  loss: -4.0000  grad_norm:  0.1542  memory: 13.80GiB(29.05%)  tps: 7,571  tflops: 59.19  mfu: 18.97%
[rank0]:2025-12-26 19:25:42,525 - Avg. fwd time: 13.9638 / Avg. full-bwd time: 21.2846 (Avg. bwd-weight time: 30.4687 / Avg. bwd-input time: 34.6440) / Avg. batch time: 1068.4985 (ms) / GPU bubble ratio: 14.40%
[rank0]:2025-12-26 19:25:42,591 -  step: 450  loss:  0.2314  grad_norm:  0.1542  memory: 35.62GiB(74.97%)  tps: 7,571  tflops: 59.19  mfu: 18.97%
[rank1]:2025-12-26 19:25:42,553 - Avg. fwd time: 10.0689 / Avg. bwd-weight time: 9.9463 / Avg. bwd-input time: 12.2394 / Avg. batch time: 1055.2303 (ms) / GPU bubble ratio: 51.09%
[rank1]:2025-12-26 19:25:42,578 -  step: 450  loss: -4.0000  grad_norm:  0.1542  memory: 17.83GiB(37.53%)  tps: 7,571  tflops: 59.19  mfu: 18.97%
[rank3]:2025-12-26 19:25:42,558 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 15.27GiB(32.13%)  tps: 7,572  tflops: 59.19  mfu: 18.97%
[rank3]:2025-12-26 19:26:21,511 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-26 19:26:21,630 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.9914e-01
[rank2]:2025-12-26 19:26:21,611 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 6.5241e-01
[rank1]:2025-12-26 19:26:21,622 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.2320e+00
[rank1]:2025-12-26 19:27:04,418 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-26 19:27:04,499 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.3372e+00
[rank2]:2025-12-26 19:27:04,482 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 7.9181e-01
[rank3]:2025-12-26 19:27:04,483 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:27:47,891 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 3.5029e-01
[rank0]:2025-12-26 19:27:47,908 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.2695e-01
[rank2]:2025-12-26 19:27:47,888 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 3.8095e-01
[rank1]:2025-12-26 19:27:47,899 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:28:31,410 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.1114e+00
[rank1]:2025-12-26 19:28:31,420 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.5400e+00
[rank3]:2025-12-26 19:28:31,402 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 5.7908e+00
[rank0]:2025-12-26 19:28:31,430 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.2381e+00
[rank0]:2025-12-26 19:29:14,453 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 19:29:14,705 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:29:14,790 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 8.2240e-01
[rank0]:2025-12-26 19:29:14,807 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.2405e-01
[rank1]:2025-12-26 19:29:14,799 - Freezing Ratio: [Stage1] 0.67, [Stage6] 0.00, Threshold: 1.4420e+00
[rank3]:2025-12-26 19:29:19,023 - Avg. fwd time: 7.8584 / Avg. bwd-weight time: 7.7011 / Avg. bwd-input time: 9.7027 / Avg. batch time: 1011.1563 (ms) / GPU bubble ratio: 60.03%
[rank0]:2025-12-26 19:29:19,042 - Avg. fwd time: 13.9688 / Avg. full-bwd time: 20.9056 (Avg. bwd-weight time: 30.4673 / Avg. bwd-input time: 34.6386) / Avg. batch time: 1066.1405 (ms) / GPU bubble ratio: 14.50%
[rank1]:2025-12-26 19:29:19,034 - Avg. fwd time: 10.0703 / Avg. bwd-weight time: 9.9799 / Avg. bwd-input time: 12.2446 / Avg. batch time: 1053.8860 (ms) / GPU bubble ratio: 50.97%
[rank1]:2025-12-26 19:29:19,080 -  step: 500  loss: -4.0000  grad_norm:  0.3205  memory: 17.83GiB(37.53%)  tps: 7,568  tflops: 59.16  mfu: 18.96%
[rank2]:2025-12-26 19:29:19,056 - Avg. fwd time: 8.3367 / Avg. bwd-weight time: 7.3970 / Avg. bwd-input time: 10.0925 / Avg. batch time: 1016.9242 (ms) / GPU bubble ratio: 59.37%
[rank2]:2025-12-26 19:29:19,086 -  step: 500  loss: -4.0000  grad_norm:  0.3205  memory: 13.80GiB(29.05%)  tps: 7,567  tflops: 59.16  mfu: 18.96%
[rank3]:2025-12-26 19:29:19,080 -  step: 500  loss: -4.0000  grad_norm:  0.3205  memory: 15.27GiB(32.13%)  tps: 7,567  tflops: 59.15  mfu: 18.96%
[rank0]:2025-12-26 19:29:19,106 -  step: 500  loss:  0.2254  grad_norm:  0.3205  memory: 35.62GiB(74.97%)  tps: 7,567  tflops: 59.16  mfu: 18.96%
[rank0]:2025-12-26 19:29:19,158 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1929_stage0_step500.svg
[rank1]:2025-12-26 19:29:19,157 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1929_stage1_step500.svg
[rank2]:2025-12-26 19:29:19,157 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1929_stage2_step500.svg
[rank2]:2025-12-26 19:29:19,197 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1929_stage5_step500.svg
[rank0]:2025-12-26 19:29:19,200 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1929_stage7_step500.svg
[rank1]:2025-12-26 19:29:19,198 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1929_stage6_step500.svg
[rank2]:2025-12-26 19:29:19,297 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank2_stage2.svg
[rank2]:	> Counts Sum: 324, Total Sum: 810 (40.00%), Ratio(%) per element: [42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77]
[rank0]:2025-12-26 19:29:19,308 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank0_stage0.svg
[rank0]:	> Counts Sum: 657, Total Sum: 855 (76.84%), Ratio(%) per element: [0.0, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11]
[rank0]:2025-12-26 19:29:19,392 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank0_stage7.svg
[rank0]:	> Counts Sum: 0, Total Sum: 495 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:29:19,325 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank1_stage1.svg
[rank1]:	> Counts Sum: 378, Total Sum: 1215 (31.11%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66]
[rank2]:2025-12-26 19:29:19,395 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank2_stage5.svg
[rank2]:	> Counts Sum: 72, Total Sum: 810 (8.89%), Ratio(%) per element: [17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:29:19,424 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank1_stage6.svg
[rank1]:	> Counts Sum: 72, Total Sum: 810 (8.89%), Ratio(%) per element: [17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 17.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:29:19,437 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1929_step500_rank3.svg
[rank3]:			> Batch Time: 1050.81 ms, GPU Bubble Ratio: 15.56%, 46.21%, 70.98%, 58.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-9-45ms      | [S0,MB5,F]  45-9-54ms      | [S0,MB6,F]  55-10-65ms     | [S7,MB0,F]  124-17-141ms   | [S7,MB0,BI] 153-32-186ms   | [S7,MB0,BW] 186-26-212ms   | [S7,MB1,F]  213-16-230ms   | [S7,MB1,BI] 241-34-276ms   | [S7,MB1,BW] 275-30-306ms   | [S7,MB2,F]  305-19-324ms   | [S7,MB2,BI] 336-35-371ms   | [S7,MB2,BW] 370-31-402ms   | [S7,MB3,F]  401-19-420ms   | [S7,MB3,BI] 432-35-467ms   | [S7,MB3,BW] 467-31-498ms   | [S0,MB7,F]  499-11-510ms   | [S0,MB0,B]  510-18-528ms   | [S7,MB4,F]  529-18-547ms   | [S7,MB4,BI] 560-34-594ms   | [S7,MB4,BW] 594-31-625ms   | [S0,MB1,B]  624-17-642ms   | [S7,MB5,F]  642-18-660ms   | [S7,MB5,BI] 672-34-707ms   | [S7,MB5,BW] 707-31-738ms   | [S0,MB2,B]  739-17-756ms   | [S7,MB6,F]  757-19-776ms   | [S7,MB6,BI] 788-34-822ms   | [S7,MB6,BW] 823-30-853ms   | [S0,MB3,B]  853-17-871ms   | [S7,MB7,F]  871-18-889ms   | [S7,MB7,BI] 902-34-936ms   | [S7,MB7,BW] 936-31-967ms   | [S0,MB4,B]  967-17-985ms   | [S0,MB5,B]  985-18-1003ms  | [S0,MB6,B]  1004-17-1021ms | [S0,MB7,B]  1031-16-1047ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-121ms   | [S6,MB1,F]  120-8-129ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 185-10-195ms   | [S6,MB2,F]  195-7-203ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 361-9-370ms    | [S6,MB2,BW] 370-10-381ms   | [S1,MB6,F]  381-10-392ms   | [S1,MB0,BI] 392-16-408ms   | [S1,MB0,BW] 408-15-423ms   | [S6,MB4,F]  422-8-430ms    | [S6,MB3,BI] 459-10-469ms   | [S6,MB3,BW] 469-9-479ms    | [S1,MB7,F]  502-13-516ms   | [S1,MB1,BI] 516-15-531ms   | [S1,MB1,BW] 531-14-546ms   | [S6,MB5,F]  545-7-553ms    | [S6,MB4,BI] 585-10-596ms   | [S6,MB4,BW] 596-9-606ms    | [S1,MB2,BI] 623-14-638ms   | [S1,MB2,BW] 638-14-652ms   | [S6,MB6,F]  709-7-716ms    | [S6,MB5,BI] 716-9-726ms    | [S6,MB5,BW] 726-11-737ms   | [S1,MB3,BI] 740-14-754ms   | [S1,MB3,BW] 754-14-768ms   | [S6,MB7,F]  825-7-832ms    | [S6,MB6,BI] 832-9-842ms    | [S6,MB6,BW] 842-11-853ms   | [S1,MB4,BI] 855-14-870ms   | [S6,MB7,BI] 928-10-939ms   | [S1,MB5,BI] 940-15-955ms   | [S1,MB4,BW] 955-16-971ms   | [S1,MB6,BI] 971-14-986ms   | [S1,MB5,BW] 985-15-1001ms  | [S1,MB7,BI] 1000-15-1015ms | [S1,MB6,BW] 1015-17-1032ms | [S6,MB7,BW] 1031-11-1043ms | [S1,MB7,BW] 1042-16-1059ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-8-47ms      | [S2,MB2,F]  56-8-64ms      | [S5,MB0,F]  64-9-74ms      | [S2,MB3,F]  74-10-85ms     | [S5,MB1,F]  85-7-92ms      | [S2,MB4,F]  97-11-108ms    | [S5,MB2,F]  116-9-125ms    | [S5,MB0,BI] 185-9-195ms    | [S5,MB0,BW] 195-0-195ms    | [S5,MB3,F]  195-8-204ms    | [S5,MB1,BI] 274-9-284ms    | [S5,MB1,BW] 284-0-284ms    | [S2,MB5,F]  284-9-293ms    | [S2,MB0,BI] 294-10-304ms   | [S2,MB0,BW] 304-0-304ms    | [S5,MB4,F]  304-7-312ms    | [S5,MB2,BI] 370-10-381ms   | [S5,MB2,BW] 381-0-381ms    | [S2,MB6,F]  393-10-403ms   | [S2,MB1,BI] 404-10-415ms   | [S2,MB1,BW] 415-0-415ms    | [S5,MB5,F]  416-7-424ms    | [S5,MB3,BI] 507-10-518ms   | [S5,MB3,BW] 518-0-518ms    | [S2,MB7,F]  519-10-530ms   | [S2,MB2,BI] 530-10-541ms   | [S2,MB2,BW] 541-0-541ms    | [S5,MB6,F]  541-7-549ms    | [S5,MB4,BI] 617-10-627ms   | [S5,MB4,BW] 627-0-627ms    | [S2,MB3,BI] 712-9-721ms    | [S2,MB3,BW] 721-0-721ms    | [S5,MB7,F]  739-7-747ms    | [S5,MB5,BI] 747-9-756ms    | [S5,MB5,BW] 756-0-756ms    | [S2,MB4,BI] 828-9-837ms    | [S5,MB6,BI] 847-10-857ms   | [S2,MB5,BI] 857-10-868ms   | [S5,MB7,BI] 943-9-952ms    | [S2,MB6,BI] 952-11-963ms   | [S2,MB4,BW] 963-0-963ms    | [S2,MB7,BI] 978-9-988ms    | [S2,MB5,BW] 988-0-988ms    | [S5,MB6,BW] 990-0-990ms    | [S5,MB7,BW] 990-0-990ms    | [S2,MB6,BW] 990-0-990ms    | [S2,MB7,BW] 990-0-990ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-55ms      | [S4,MB1,F]  56-7-63ms      | [S3,MB2,F]  65-7-72ms      | [S4,MB2,F]  72-7-80ms      | [S3,MB3,F]  99-7-107ms     | [S4,MB3,F]  107-8-115ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-9-213ms    | [S3,MB4,F]  213-7-220ms    | [S3,MB0,BI] 220-9-230ms    | [S3,MB0,BW] 230-9-240ms    | [S4,MB4,F]  239-7-247ms    | [S4,MB1,BI] 284-11-295ms   | [S4,MB1,BW] 295-10-305ms   | [S3,MB5,F]  305-7-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  331-7-338ms    | [S4,MB2,BI] 397-11-409ms   | [S4,MB2,BW] 408-9-418ms    | [S3,MB6,F]  418-7-426ms    | [S3,MB2,BI] 426-9-435ms    | [S3,MB2,BW] 435-9-445ms    | [S4,MB6,F]  443-7-451ms    | [S4,MB3,BI] 521-11-533ms   | [S4,MB3,BW] 533-9-543ms    | [S3,MB7,F]  542-7-550ms    | [S3,MB3,BI] 549-9-559ms    | [S3,MB3,BW] 559-9-569ms    | [S4,MB7,F]  566-7-574ms    | [S4,MB4,BI] 705-10-716ms   | [S4,MB4,BW] 716-9-726ms    | [S3,MB4,BI] 725-10-736ms   | [S4,MB5,BI] 821-10-832ms   | [S3,MB5,BI] 831-9-841ms    | [S4,MB6,BI] 858-9-867ms    | [S3,MB6,BI] 867-9-877ms    | [S4,MB7,BI] 953-9-963ms    | [S3,MB7,BI] 963-9-972ms    | [S3,MB4,BW] 972-10-982ms   | [S4,MB5,BW] 977-9-987ms    | [S4,MB6,BW] 987-9-997ms    | [S4,MB7,BW] 997-9-1007ms   | [S3,MB5,BW] 1006-10-1016ms | [S3,MB6,BW] 1016-10-1026ms | [S3,MB7,BW] 1025-10-1036ms
[rank3]:2025-12-26 19:29:19,480 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1929_stage3_step500.svg
[rank3]:2025-12-26 19:29:19,521 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1929_stage4_step500.svg
[rank3]:2025-12-26 19:29:19,619 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank3_stage3.svg
[rank3]:	> Counts Sum: 252, Total Sum: 810 (31.11%), Ratio(%) per element: [35.55, 35.55, 35.55, 35.55, 35.55, 35.55, 35.55, 35.55, 35.55, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66]
[rank3]:2025-12-26 19:29:19,717 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1929_rank3_stage4.svg
[rank3]:	> Counts Sum: 63, Total Sum: 810 (7.78%), Ratio(%) per element: [15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:29:58,250 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.9170e+00
[rank1]:2025-12-26 19:29:58,250 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 5.9443e+00
[rank0]:2025-12-26 19:29:58,279 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0443e+00
[rank2]:2025-12-26 19:29:58,261 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:30:41,715 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 2.5467e+00
[rank0]:2025-12-26 19:30:41,733 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.9890e+00
[rank1]:2025-12-26 19:30:41,724 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.9461e+00
[rank2]:2025-12-26 19:30:41,714 - Freezing Ratio: [Stage2] 0.50, [Stage5] 0.00, Threshold: 2.7603e+00
[rank3]:2025-12-26 19:31:24,700 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 7.3449e-01
[rank1]:2025-12-26 19:31:24,700 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.2205e+00
[rank0]:2025-12-26 19:31:24,728 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.2728e+00
[rank2]:2025-12-26 19:31:24,700 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 5.7909e+00
[rank3]:2025-12-26 19:32:07,960 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 1.1327e+00
[rank0]:2025-12-26 19:32:07,976 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.5430e-01
[rank1]:2025-12-26 19:32:07,967 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.2186e+00
[rank2]:2025-12-26 19:32:07,956 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 8.0117e-01
[rank0]:2025-12-26 19:32:50,547 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-26 19:32:50,857 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.5512e+00
[rank2]:2025-12-26 19:32:50,800 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:32:50,857 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0761e+00
[rank0]:2025-12-26 19:32:50,886 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.4818e+00
[rank3]:2025-12-26 19:32:55,219 - Avg. fwd time: 7.8622 / Avg. bwd-weight time: 7.6378 / Avg. bwd-input time: 9.7068 / Avg. batch time: 1009.2999 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-12-26 19:32:55,204 - Avg. fwd time: 13.9752 / Avg. full-bwd time: 20.5966 (Avg. bwd-weight time: 30.4639 / Avg. bwd-input time: 34.6343) / Avg. batch time: 1063.9218 (ms) / GPU bubble ratio: 14.55%
[rank0]:2025-12-26 19:32:55,270 -  step: 550  loss:  0.2321  grad_norm:  0.1694  memory: 35.62GiB(74.97%)  tps: 7,579  tflops: 59.25  mfu: 18.99%
[rank1]:2025-12-26 19:32:55,232 - Avg. fwd time: 10.0763 / Avg. bwd-weight time: 9.8454 / Avg. bwd-input time: 12.2469 / Avg. batch time: 1051.7539 (ms) / GPU bubble ratio: 51.06%
[rank1]:2025-12-26 19:32:55,256 -  step: 550  loss: -4.0000  grad_norm:  0.1694  memory: 17.83GiB(37.53%)  tps: 7,579  tflops: 59.25  mfu: 18.99%
[rank2]:2025-12-26 19:32:55,211 - Avg. fwd time: 8.3363 / Avg. bwd-weight time: 7.3698 / Avg. bwd-input time: 10.0936 / Avg. batch time: 1015.6812 (ms) / GPU bubble ratio: 59.36%
[rank2]:2025-12-26 19:32:55,251 -  step: 550  loss: -4.0000  grad_norm:  0.1694  memory: 13.80GiB(29.05%)  tps: 7,579  tflops: 59.25  mfu: 18.99%
[rank3]:2025-12-26 19:32:55,251 -  step: 550  loss: -4.0000  grad_norm:  0.1694  memory: 15.27GiB(32.13%)  tps: 7,579  tflops: 59.25  mfu: 18.99%
[rank3]:2025-12-26 19:33:34,346 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 1.7775e+00
[rank1]:2025-12-26 19:33:34,355 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.9347e+00
[rank0]:2025-12-26 19:33:34,365 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.8082e+00
[rank2]:2025-12-26 19:33:34,346 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:34:17,251 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:34:17,346 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.9014e+00
[rank1]:2025-12-26 19:34:17,336 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.5216e+00
[rank0]:2025-12-26 19:34:17,365 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 9.9007e-01
[rank3]:2025-12-26 19:35:00,692 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:35:00,689 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.3040e+00
[rank0]:2025-12-26 19:35:00,709 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.0781e-01
[rank1]:2025-12-26 19:35:00,700 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.6158e+00
[rank1]:2025-12-26 19:35:43,473 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:35:43,539 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 7.2789e-01
[rank2]:2025-12-26 19:35:43,534 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 8.4385e-01
[rank0]:2025-12-26 19:35:43,554 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 6.4928e-01
[rank0]:2025-12-26 19:36:26,570 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 19:36:26,899 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 3.7743e-01
[rank2]:2025-12-26 19:36:26,907 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 6.2309e-01
[rank1]:2025-12-26 19:36:26,918 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:36:26,927 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.0607e-01
[rank3]:2025-12-26 19:36:31,320 - Avg. fwd time: 7.8666 / Avg. bwd-weight time: 7.5795 / Avg. bwd-input time: 9.7065 / Avg. batch time: 1007.8320 (ms) / GPU bubble ratio: 60.07%
[rank2]:2025-12-26 19:36:31,312 - Avg. fwd time: 8.3180 / Avg. bwd-weight time: 7.6006 / Avg. bwd-input time: 10.0962 / Avg. batch time: 1015.8270 (ms) / GPU bubble ratio: 59.02%
[rank2]:2025-12-26 19:36:31,352 -  step: 600  loss: -4.0000  grad_norm:  0.4250  memory: 13.80GiB(29.05%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank0]:2025-12-26 19:36:31,305 - Avg. fwd time: 13.9797 / Avg. full-bwd time: 20.3395 (Avg. bwd-weight time: 30.4609 / Avg. bwd-input time: 34.6331) / Avg. batch time: 1062.1600 (ms) / GPU bubble ratio: 14.59%
[rank1]:2025-12-26 19:36:31,333 - Avg. fwd time: 10.0846 / Avg. bwd-weight time: 9.7631 / Avg. bwd-input time: 12.2487 / Avg. batch time: 1050.3087 (ms) / GPU bubble ratio: 51.11%
[rank1]:2025-12-26 19:36:31,357 -  step: 600  loss: -4.0000  grad_norm:  0.4250  memory: 17.83GiB(37.53%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank3]:2025-12-26 19:36:31,352 -  step: 600  loss: -4.0000  grad_norm:  0.4250  memory: 15.27GiB(32.13%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank2]:2025-12-26 19:36:31,424 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1936_stage2_step600.svg
[rank0]:2025-12-26 19:36:31,372 -  step: 600  loss:  0.2264  grad_norm:  0.4250  memory: 35.62GiB(74.97%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank0]:2025-12-26 19:36:31,422 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1936_stage0_step600.svg
[rank0]:2025-12-26 19:36:31,464 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1936_stage7_step600.svg
[rank1]:2025-12-26 19:36:31,424 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1936_stage1_step600.svg
[rank2]:2025-12-26 19:36:31,466 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1936_stage5_step600.svg
[rank0]:2025-12-26 19:36:31,566 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank0_stage0.svg
[rank1]:2025-12-26 19:36:31,467 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1936_stage6_step600.svg
[rank0]:	> Counts Sum: 837, Total Sum: 1045 (80.10%), Ratio(%) per element: [0.0, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36]
[rank2]:2025-12-26 19:36:31,564 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank2_stage2.svg
[rank2]:	> Counts Sum: 351, Total Sum: 990 (35.45%), Ratio(%) per element: [38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72, 32.72]
[rank1]:2025-12-26 19:36:31,607 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank1_stage1.svg
[rank0]:2025-12-26 19:36:31,645 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank0_stage7.svg
[rank0]:	> Counts Sum: 0, Total Sum: 605 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:	> Counts Sum: 486, Total Sum: 1485 (32.73%), Ratio(%) per element: [34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 34.54, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09]
[rank3]:2025-12-26 19:36:31,705 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1936_step600_rank3.svg
[rank3]:			> Batch Time: 1051.73 ms, GPU Bubble Ratio: 15.55%, 46.38%, 56.75%, 65.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-27ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-10-46ms     | [S0,MB5,F]  45-9-55ms      | [S0,MB6,F]  55-10-65ms     | [S7,MB0,F]  123-17-140ms   | [S7,MB0,BI] 152-32-184ms   | [S7,MB0,BW] 184-27-212ms   | [S7,MB1,F]  212-17-229ms   | [S7,MB1,BI] 240-34-275ms   | [S7,MB1,BW] 275-30-305ms   | [S7,MB2,F]  305-19-324ms   | [S7,MB2,BI] 336-35-371ms   | [S7,MB2,BW] 370-31-402ms   | [S7,MB3,F]  402-19-422ms   | [S7,MB3,BI] 433-35-468ms   | [S7,MB3,BW] 468-32-500ms   | [S0,MB7,F]  501-11-512ms   | [S0,MB0,B]  512-18-530ms   | [S7,MB4,F]  530-18-549ms   | [S7,MB4,BI] 561-34-595ms   | [S7,MB4,BW] 595-30-625ms   | [S0,MB1,B]  625-17-642ms   | [S7,MB5,F]  642-18-661ms   | [S7,MB5,BI] 673-34-707ms   | [S7,MB5,BW] 707-32-739ms   | [S0,MB2,B]  739-17-756ms   | [S7,MB6,F]  757-18-775ms   | [S7,MB6,BI] 788-35-823ms   | [S7,MB6,BW] 823-30-853ms   | [S0,MB3,B]  852-18-870ms   | [S7,MB7,F]  870-19-889ms   | [S7,MB7,BI] 900-34-935ms   | [S7,MB7,BW] 935-30-965ms   | [S0,MB4,B]  965-17-982ms   | [S0,MB5,B]  982-18-1000ms  | [S0,MB6,B]  1001-17-1018ms | [S0,MB7,B]  1030-16-1046ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-39ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-121ms   | [S6,MB1,F]  121-8-129ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 185-10-196ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 267-9-276ms    | [S6,MB1,BW] 276-10-286ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 363-9-372ms    | [S6,MB2,BW] 372-10-383ms   | [S1,MB6,F]  382-10-393ms   | [S1,MB0,BI] 393-15-409ms   | [S1,MB0,BW] 409-15-424ms   | [S6,MB4,F]  424-8-432ms    | [S6,MB3,BI] 460-10-470ms   | [S6,MB3,BW] 471-9-480ms    | [S1,MB7,F]  504-13-517ms   | [S1,MB1,BI] 518-15-533ms   | [S1,MB1,BW] 533-14-548ms   | [S6,MB5,F]  545-7-553ms    | [S6,MB4,BI] 587-10-597ms   | [S6,MB4,BW] 597-9-607ms    | [S1,MB2,BI] 624-14-639ms   | [S1,MB2,BW] 639-14-653ms   | [S6,MB6,F]  708-7-716ms    | [S6,MB5,BI] 716-9-725ms    | [S6,MB5,BW] 725-11-736ms   | [S1,MB3,BI] 739-14-754ms   | [S1,MB3,BW] 754-14-768ms   | [S6,MB7,F]  824-7-832ms    | [S6,MB6,BI] 832-9-841ms    | [S6,MB6,BW] 841-11-853ms   | [S1,MB4,BI] 854-14-869ms   | [S6,MB7,BI] 929-10-939ms   | [S1,MB5,BI] 940-15-955ms   | [S1,MB4,BW] 955-16-971ms   | [S1,MB6,BI] 971-14-986ms   | [S1,MB5,BW] 986-15-1002ms  | [S1,MB7,BI] 1000-15-1015ms | [S1,MB6,BW] 1015-16-1031ms | [S6,MB7,BW] 1032-11-1043ms | [S1,MB7,BW] 1043-16-1060ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  39-7-46ms      | [S2,MB2,F]  56-7-63ms      | [S5,MB0,F]  63-9-73ms      | [S2,MB3,F]  74-9-84ms      | [S5,MB1,F]  84-7-91ms      | [S2,MB4,F]  97-10-107ms    | [S5,MB2,F]  116-8-125ms    | [S5,MB0,BI] 185-9-195ms    | [S5,MB0,BW] 195-10-205ms   | [S5,MB3,F]  205-7-212ms    | [S5,MB1,BI] 276-9-286ms    | [S5,MB1,BW] 285-10-296ms   | [S2,MB5,F]  296-7-304ms    | [S2,MB0,BI] 304-10-314ms   | [S2,MB0,BW] 314-9-324ms    | [S5,MB4,F]  324-7-332ms    | [S5,MB2,BI] 372-10-383ms   | [S5,MB2,BW] 383-9-393ms    | [S2,MB6,F]  395-9-405ms    | [S2,MB1,BI] 405-10-416ms   | [S2,MB1,BW] 416-9-426ms    | [S5,MB5,F]  425-7-433ms    | [S5,MB3,BI] 508-10-519ms   | [S5,MB3,BW] 519-11-531ms   | [S2,MB7,F]  531-7-538ms    | [S2,MB2,BI] 538-10-548ms   | [S2,MB2,BW] 549-9-559ms    | [S5,MB6,F]  558-7-566ms    | [S5,MB4,BI] 617-10-628ms   | [S5,MB4,BW] 628-9-638ms    | [S2,MB3,BI] 711-9-721ms    | [S2,MB3,BW] 721-10-731ms   | [S5,MB7,F]  739-7-747ms    | [S5,MB5,BI] 746-9-756ms    | [S5,MB5,BW] 756-9-766ms    | [S2,MB4,BI] 827-9-837ms    | [S5,MB6,BI] 846-10-857ms   | [S2,MB5,BI] 857-10-867ms   | [S5,MB7,BI] 943-9-952ms    | [S2,MB6,BI] 952-11-964ms   | [S2,MB4,BW] 963-10-974ms   | [S2,MB7,BI] 978-9-988ms    | [S2,MB5,BW] 988-10-998ms   | [S5,MB6,BW] 998-9-1008ms   | [S5,MB7,BW] 1008-9-1018ms  | [S2,MB6,BW] 1018-9-1028ms  | [S2,MB7,BW] 1027-10-1037ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-9-56ms      | [S4,MB1,F]  56-7-63ms      | [S3,MB2,F]  64-8-73ms      | [S4,MB2,F]  73-7-80ms      | [S3,MB3,F]  99-8-107ms     | [S4,MB3,F]  107-8-115ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-9-213ms    | [S3,MB4,F]  213-7-221ms    | [S3,MB0,BI] 221-9-231ms    | [S3,MB0,BW] 230-0-230ms    | [S4,MB4,F]  231-7-238ms    | [S4,MB1,BI] 286-10-296ms   | [S4,MB1,BW] 296-10-306ms   | [S3,MB5,F]  306-8-315ms    | [S3,MB1,BI] 315-9-324ms    | [S3,MB1,BW] 324-0-324ms    | [S4,MB5,F]  325-7-332ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  419-8-427ms    | [S3,MB2,BI] 427-9-436ms    | [S3,MB2,BW] 436-0-436ms    | [S4,MB6,F]  437-7-445ms    | [S4,MB3,BI] 523-10-534ms   | [S4,MB3,BW] 533-10-544ms   | [S3,MB7,F]  544-8-552ms    | [S3,MB3,BI] 552-9-561ms    | [S3,MB3,BW] 561-0-561ms    | [S4,MB7,F]  562-7-570ms    | [S4,MB4,BI] 705-10-715ms   | [S4,MB4,BW] 715-9-725ms    | [S3,MB4,BI] 725-10-735ms   | [S4,MB5,BI] 821-10-831ms   | [S3,MB5,BI] 831-9-840ms    | [S4,MB6,BI] 857-9-866ms    | [S3,MB6,BI] 867-9-876ms    | [S4,MB7,BI] 954-9-963ms    | [S3,MB7,BI] 963-9-972ms    | [S3,MB4,BW] 972-0-972ms    | [S4,MB5,BW] 975-10-985ms   | [S4,MB6,BW] 985-9-995ms    | [S4,MB7,BW] 995-9-1005ms   | [S3,MB5,BW] 1005-0-1005ms  | [S3,MB6,BW] 1005-0-1005ms  | [S3,MB7,BW] 1005-0-1005ms 
[rank2]:2025-12-26 19:36:31,662 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank2_stage5.svg
[rank2]:	> Counts Sum: 81, Total Sum: 990 (8.18%), Ratio(%) per element: [16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:36:31,707 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank1_stage6.svg
[rank1]:	> Counts Sum: 81, Total Sum: 990 (8.18%), Ratio(%) per element: [16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:36:31,749 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1936_stage3_step600.svg
[rank3]:2025-12-26 19:36:31,791 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1936_stage4_step600.svg
[rank3]:2025-12-26 19:36:31,888 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank3_stage3.svg
[rank3]:	> Counts Sum: 324, Total Sum: 990 (32.73%), Ratio(%) per element: [36.36, 36.36, 36.36, 36.36, 36.36, 36.36, 36.36, 36.36, 36.36, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09]
[rank3]:2025-12-26 19:36:31,987 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1936_rank3_stage4.svg
[rank3]:	> Counts Sum: 72, Total Sum: 990 (7.27%), Ratio(%) per element: [14.54, 14.54, 14.54, 14.54, 14.54, 14.54, 14.54, 14.54, 14.54, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:37:10,966 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 5.0685e-01
[rank2]:2025-12-26 19:37:10,965 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 7.5330e-01
[rank0]:2025-12-26 19:37:10,984 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 8.3383e-01
[rank1]:2025-12-26 19:37:10,974 - Freezing Ratio: [Stage1] 0.33, [Stage6] 0.00, Threshold: 1.0790e+00
[rank3]:2025-12-26 19:37:53,643 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:37:53,726 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.4211e+00
[rank0]:2025-12-26 19:37:53,754 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.2505e+00
[rank1]:2025-12-26 19:37:53,730 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.5369e+00
[rank2]:2025-12-26 19:38:37,117 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 3.2588e-01
[rank0]:2025-12-26 19:38:37,136 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.4550e-01
[rank1]:2025-12-26 19:38:37,128 - Freezing Ratio: [Stage1] 0.67, [Stage6] 0.00, Threshold: 4.6489e-01
[rank3]:2025-12-26 19:38:37,118 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:39:20,058 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:39:20,141 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0016e+00
[rank0]:2025-12-26 19:39:20,158 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.0772e-01
[rank1]:2025-12-26 19:39:20,129 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 5.5329e+00
[rank0]:2025-12-26 19:40:03,365 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-26 19:40:03,694 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 5.8079e-01
[rank0]:2025-12-26 19:40:03,712 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 7.9393e-01
[rank2]:2025-12-26 19:40:03,693 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 19:40:03,703 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.0152e+00
[rank3]:2025-12-26 19:40:07,902 - Avg. fwd time: 7.8660 / Avg. bwd-weight time: 7.5907 / Avg. bwd-input time: 9.7084 / Avg. batch time: 1007.1422 (ms) / GPU bubble ratio: 60.02%
[rank1]:2025-12-26 19:40:07,943 - Avg. fwd time: 10.0773 / Avg. bwd-weight time: 9.8016 / Avg. bwd-input time: 12.2532 / Avg. batch time: 1049.4566 (ms) / GPU bubble ratio: 51.01%
[rank3]:2025-12-26 19:40:07,983 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 15.27GiB(32.13%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank0]:2025-12-26 19:40:07,952 - Avg. fwd time: 13.9853 / Avg. full-bwd time: 20.1227 (Avg. bwd-weight time: 30.4631 / Avg. bwd-input time: 34.6325) / Avg. batch time: 1060.7801 (ms) / GPU bubble ratio: 14.64%
[rank0]:2025-12-26 19:40:08,016 -  step: 650  loss:  0.2355  grad_norm:  0.1481  memory: 35.62GiB(74.97%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank2]:2025-12-26 19:40:07,965 - Avg. fwd time: 8.3232 / Avg. bwd-weight time: 7.5620 / Avg. bwd-input time: 10.0980 / Avg. batch time: 1014.8431 (ms) / GPU bubble ratio: 59.03%
[rank2]:2025-12-26 19:40:07,996 -  step: 650  loss: -4.0000  grad_norm:  0.1481  memory: 13.80GiB(29.05%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank1]:2025-12-26 19:40:07,989 -  step: 650  loss: -4.0000  grad_norm:  0.1481  memory: 17.83GiB(37.53%)  tps: 7,563  tflops: 59.12  mfu: 18.95%
[rank3]:2025-12-26 19:40:46,560 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:40:46,655 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 1.1796e+00
[rank0]:2025-12-26 19:40:46,673 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.3700e+00
[rank1]:2025-12-26 19:40:46,644 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.3307e+00
[rank2]:2025-12-26 19:41:29,994 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 6.8836e-01
[rank0]:2025-12-26 19:41:30,022 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.5675e-01
[rank3]:2025-12-26 19:41:30,005 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 19:41:30,014 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 5.3824e-01
[rank1]:2025-12-26 19:42:13,015 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.4912e+00
[rank2]:2025-12-26 19:42:13,024 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 1.6238e+00
[rank0]:2025-12-26 19:42:13,044 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.1198e+00
[rank3]:2025-12-26 19:42:13,028 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.6661e+00
[rank2]:2025-12-26 19:42:56,487 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 4.2262e-01
[rank0]:2025-12-26 19:42:56,515 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.6097e-01
[rank3]:2025-12-26 19:42:56,498 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 4.8266e-01
[rank1]:2025-12-26 19:42:56,506 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 4.4842e-01
[rank0]:2025-12-26 19:43:39,102 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 19:43:39,421 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 6.9094e+00
[rank1]:2025-12-26 19:43:39,421 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.9155e+00
[rank2]:2025-12-26 19:43:39,432 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 2.9366e+00
[rank0]:2025-12-26 19:43:39,451 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.7562e+00
[rank2]:2025-12-26 19:43:43,695 - Avg. fwd time: 8.3202 / Avg. bwd-weight time: 7.5959 / Avg. bwd-input time: 10.0987 / Avg. batch time: 1014.2023 (ms) / GPU bubble ratio: 58.96%
[rank0]:2025-12-26 19:43:43,718 - Avg. fwd time: 13.9901 / Avg. full-bwd time: 19.9376 (Avg. bwd-weight time: 30.4600 / Avg. bwd-input time: 34.6326) / Avg. batch time: 1059.3762 (ms) / GPU bubble ratio: 14.66%
[rank3]:2025-12-26 19:43:43,735 - Avg. fwd time: 7.8664 / Avg. bwd-weight time: 7.5573 / Avg. bwd-input time: 9.7090 / Avg. batch time: 1006.2146 (ms) / GPU bubble ratio: 60.04%
[rank1]:2025-12-26 19:43:43,747 - Avg. fwd time: 10.0842 / Avg. bwd-weight time: 9.7088 / Avg. bwd-input time: 12.2555 / Avg. batch time: 1048.0596 (ms) / GPU bubble ratio: 51.07%
[rank2]:2025-12-26 19:43:43,759 -  step: 700  loss: -4.0000  grad_norm:  0.3274  memory: 13.80GiB(29.05%)  tps: 7,594  tflops: 59.36  mfu: 19.03%
[rank0]:2025-12-26 19:43:43,785 -  step: 700  loss:  0.1965  grad_norm:  0.3274  memory: 35.62GiB(74.97%)  tps: 7,593  tflops: 59.36  mfu: 19.03%
[rank3]:2025-12-26 19:43:43,766 -  step: 700  loss: -4.0000  grad_norm:  0.3274  memory: 15.27GiB(32.13%)  tps: 7,593  tflops: 59.36  mfu: 19.02%
[rank1]:2025-12-26 19:43:43,771 -  step: 700  loss: -4.0000  grad_norm:  0.3274  memory: 17.83GiB(37.53%)  tps: 7,593  tflops: 59.36  mfu: 19.02%
[rank1]:2025-12-26 19:43:43,840 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1943_stage1_step700.svg
[rank2]:2025-12-26 19:43:43,840 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1943_stage2_step700.svg
[rank2]:2025-12-26 19:43:43,883 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1943_stage5_step700.svg
[rank0]:2025-12-26 19:43:43,838 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1943_stage0_step700.svg
[rank0]:2025-12-26 19:43:43,881 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1943_stage7_step700.svg
[rank1]:2025-12-26 19:43:43,884 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1943_stage6_step700.svg
[rank2]:2025-12-26 19:43:43,983 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank2_stage2.svg
[rank2]:	> Counts Sum: 441, Total Sum: 1170 (37.69%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38]
[rank0]:2025-12-26 19:43:43,983 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank0_stage0.svg
[rank0]:	> Counts Sum: 1017, Total Sum: 1235 (82.35%), Ratio(%) per element: [0.0, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0]
[rank1]:2025-12-26 19:43:44,008 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank1_stage1.svg
[rank1]:	> Counts Sum: 594, Total Sum: 1755 (33.85%), Ratio(%) per element: [36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 36.92, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 29.23, 29.23, 29.23, 29.23, 29.23, 29.23, 29.23, 29.23, 29.23]
[rank2]:2025-12-26 19:43:44,081 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank2_stage5.svg
[rank2]:	> Counts Sum: 90, Total Sum: 1170 (7.69%), Ratio(%) per element: [15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 19:43:44,063 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank0_stage7.svg
[rank0]:	> Counts Sum: 0, Total Sum: 715 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:43:44,114 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1943_step700_rank3.svg
[rank3]:			> Batch Time: 1036.92 ms, GPU Bubble Ratio: 14.33%, 57.09%, 56.24%, 65.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-10-56ms     | [S0,MB6,F]  56-10-66ms     | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-179ms   | [S7,MB0,BW] 180-25-205ms   | [S7,MB1,F]  206-16-222ms   | [S7,MB1,BI] 235-34-269ms   | [S7,MB1,BW] 269-30-300ms   | [S7,MB2,F]  300-19-319ms   | [S7,MB2,BI] 332-35-367ms   | [S7,MB2,BW] 367-31-398ms   | [S7,MB3,F]  398-19-417ms   | [S7,MB3,BI] 429-35-464ms   | [S7,MB3,BW] 464-31-496ms   | [S0,MB7,F]  496-11-507ms   | [S0,MB0,B]  506-18-525ms   | [S7,MB4,F]  525-18-544ms   | [S7,MB4,BI] 556-34-590ms   | [S7,MB4,BW] 590-30-620ms   | [S0,MB1,B]  621-17-638ms   | [S7,MB5,F]  638-18-657ms   | [S7,MB5,BI] 669-34-704ms   | [S7,MB5,BW] 704-31-735ms   | [S0,MB2,B]  735-17-753ms   | [S7,MB6,F]  753-18-771ms   | [S7,MB6,BI] 784-34-818ms   | [S7,MB6,BW] 819-31-850ms   | [S0,MB3,B]  849-17-866ms   | [S7,MB7,F]  867-18-885ms   | [S7,MB7,BI] 897-34-932ms   | [S7,MB7,BW] 932-31-963ms   | [S0,MB4,B]  963-17-981ms   | [S0,MB5,B]  981-18-999ms   | [S0,MB6,B]  999-17-1016ms  | [S0,MB7,B]  1020-16-1036ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  46-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-110ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-8-133ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-10-198ms   | [S6,MB2,F]  198-7-205ms    | [S6,MB1,BI] 268-9-277ms    | [S6,MB1,BW] 277-10-288ms   | [S6,MB3,F]  288-7-295ms    | [S6,MB2,BI] 365-9-374ms    | [S6,MB2,BW] 374-10-385ms   | [S1,MB6,F]  385-12-397ms   | [S1,MB0,BI] 397-15-413ms   | [S1,MB0,BW] 413-0-413ms    | [S6,MB4,F]  416-7-424ms    | [S6,MB3,BI] 463-10-473ms   | [S6,MB3,BW] 473-9-483ms    | [S1,MB7,F]  505-15-520ms   | [S1,MB1,BI] 520-15-536ms   | [S1,MB1,BW] 536-0-536ms    | [S6,MB5,F]  538-7-545ms    | [S6,MB4,BI] 588-10-599ms   | [S6,MB4,BW] 598-9-608ms    | [S1,MB2,BI] 627-14-642ms   | [S1,MB2,BW] 641-0-641ms    | [S6,MB6,F]  712-7-719ms    | [S6,MB5,BI] 719-9-728ms    | [S6,MB5,BW] 728-11-739ms   | [S1,MB3,BI] 742-14-757ms   | [S1,MB3,BW] 757-0-757ms    | [S6,MB7,F]  827-7-834ms    | [S6,MB6,BI] 834-9-843ms    | [S6,MB6,BW] 843-11-855ms   | [S1,MB4,BI] 857-14-872ms   | [S6,MB7,BI] 931-10-941ms   | [S1,MB5,BI] 942-15-957ms   | [S1,MB4,BW] 957-0-957ms    | [S1,MB6,BI] 972-14-986ms   | [S1,MB5,BW] 986-0-986ms    | [S1,MB7,BI] 997-14-1011ms  | [S1,MB6,BW] 1011-0-1011ms  | [S6,MB7,BW] 1012-10-1023ms | [S1,MB7,BW] 1023-0-1023ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  39-7-46ms      | [S2,MB2,F]  58-7-65ms      | [S5,MB0,F]  65-9-74ms      | [S2,MB3,F]  76-9-86ms      | [S5,MB1,F]  86-7-93ms      | [S2,MB4,F]  100-10-110ms   | [S5,MB2,F]  119-8-128ms    | [S5,MB0,BI] 188-9-198ms    | [S5,MB0,BW] 198-10-208ms   | [S5,MB3,F]  208-7-215ms    | [S5,MB1,BI] 278-9-287ms    | [S5,MB1,BW] 287-10-298ms   | [S2,MB5,F]  298-7-305ms    | [S2,MB0,BI] 305-10-316ms   | [S2,MB0,BW] 316-9-326ms    | [S5,MB4,F]  325-7-332ms    | [S5,MB2,BI] 375-10-385ms   | [S5,MB2,BW] 385-9-395ms    | [S2,MB6,F]  398-9-408ms    | [S2,MB1,BI] 409-10-420ms   | [S2,MB1,BW] 420-9-430ms    | [S5,MB5,F]  429-7-436ms    | [S5,MB3,BI] 510-10-521ms   | [S5,MB3,BW] 521-11-533ms   | [S2,MB7,F]  532-7-540ms    | [S2,MB2,BI] 540-10-551ms   | [S2,MB2,BW] 551-9-561ms    | [S5,MB6,F]  560-7-568ms    | [S5,MB4,BI] 620-10-631ms   | [S5,MB4,BW] 630-9-640ms    | [S2,MB3,BI] 715-9-725ms    | [S2,MB3,BW] 724-10-735ms   | [S5,MB7,F]  742-7-749ms    | [S5,MB5,BI] 749-9-759ms    | [S5,MB5,BW] 759-9-769ms    | [S2,MB4,BI] 829-9-839ms    | [S5,MB6,BI] 848-10-859ms   | [S2,MB5,BI] 859-10-869ms   | [S5,MB7,BI] 945-9-954ms    | [S2,MB6,BI] 954-10-965ms   | [S2,MB4,BW] 965-10-976ms   | [S2,MB7,BI] 980-9-990ms    | [S2,MB5,BW] 989-10-1000ms  | [S5,MB6,BW] 1000-9-1010ms  | [S5,MB7,BW] 1009-9-1019ms  | [S2,MB6,BW] 1019-9-1029ms  | [S2,MB7,BW] 1028-9-1038ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-56ms      | [S4,MB1,F]  56-7-63ms      | [S3,MB2,F]  65-7-73ms      | [S4,MB2,F]  73-7-81ms      | [S3,MB3,F]  102-7-110ms    | [S4,MB3,F]  110-8-118ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-9-216ms    | [S3,MB4,F]  216-7-224ms    | [S3,MB0,BI] 224-9-233ms    | [S3,MB0,BW] 233-0-233ms    | [S4,MB4,F]  234-7-241ms    | [S4,MB1,BI] 287-10-297ms   | [S4,MB1,BW] 297-10-308ms   | [S3,MB5,F]  307-8-316ms    | [S3,MB1,BI] 316-9-326ms    | [S3,MB1,BW] 326-0-326ms    | [S4,MB5,F]  327-7-334ms    | [S4,MB2,BI] 403-11-414ms   | [S4,MB2,BW] 414-9-424ms    | [S3,MB6,F]  423-7-431ms    | [S3,MB2,BI] 431-9-440ms    | [S3,MB2,BW] 440-0-440ms    | [S4,MB6,F]  442-7-450ms    | [S4,MB3,BI] 526-10-536ms   | [S4,MB3,BW] 536-10-546ms   | [S3,MB7,F]  547-7-554ms    | [S3,MB3,BI] 554-9-564ms    | [S3,MB3,BW] 564-0-564ms    | [S4,MB7,F]  565-7-573ms    | [S4,MB4,BI] 709-10-719ms   | [S4,MB4,BW] 719-9-729ms    | [S3,MB4,BI] 729-10-739ms   | [S4,MB5,BI] 823-10-833ms   | [S3,MB5,BI] 833-9-842ms    | [S4,MB6,BI] 860-9-869ms    | [S3,MB6,BI] 869-9-878ms    | [S4,MB7,BI] 955-9-964ms    | [S3,MB7,BI] 965-9-974ms    | [S3,MB4,BW] 974-0-974ms    | [S4,MB5,BW] 975-10-985ms   | [S4,MB6,BW] 985-9-995ms    | [S4,MB7,BW] 995-9-1004ms   | [S3,MB5,BW] 1004-0-1004ms  | [S3,MB6,BW] 1005-0-1005ms  | [S3,MB7,BW] 1005-0-1005ms 
[rank1]:2025-12-26 19:43:44,107 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank1_stage6.svg
[rank1]:	> Counts Sum: 81, Total Sum: 1170 (6.92%), Ratio(%) per element: [13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:43:44,160 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1943_stage3_step700.svg
[rank3]:2025-12-26 19:43:44,203 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1943_stage4_step700.svg
[rank3]:2025-12-26 19:43:44,301 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank3_stage3.svg
[rank3]:	> Counts Sum: 369, Total Sum: 1170 (31.54%), Ratio(%) per element: [35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 35.38, 27.69, 27.69, 27.69, 27.69, 27.69, 27.69, 27.69, 27.69, 27.69]
[rank3]:2025-12-26 19:43:44,414 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1943_rank3_stage4.svg
[rank3]:	> Counts Sum: 90, Total Sum: 1170 (7.69%), Ratio(%) per element: [15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 19:44:23,444 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 6.6763e-01
[rank0]:2025-12-26 19:44:23,472 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0693e+00
[rank1]:2025-12-26 19:44:23,464 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 6.0804e-01
[rank3]:2025-12-26 19:44:23,454 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 3.5993e-01
[rank1]:2025-12-26 19:45:06,433 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:45:06,400 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-26 19:45:06,494 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 1.2521e+00
[rank0]:2025-12-26 19:45:06,514 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.3055e-01
[rank2]:2025-12-26 19:45:49,985 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.7533e-01
[rank1]:2025-12-26 19:45:50,004 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 19:45:49,997 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 19:45:50,013 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.4750e-01
[rank0]:2025-12-26 19:46:33,414 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 8.5652e-01
[rank2]:2025-12-26 19:46:33,395 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 8.9398e-01
[rank1]:2025-12-26 19:46:33,406 - Freezing Ratio: [Stage1] 0.33, [Stage6] 0.00, Threshold: 1.4123e+00
[rank3]:2025-12-26 19:46:33,396 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 6.4846e-01
[rank0]:2025-12-26 19:47:15,950 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-26 19:47:16,203 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-26 19:47:16,286 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 6.3585e-01
[rank1]:2025-12-26 19:47:16,262 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.1682e+00
[rank3]:2025-12-26 19:47:16,258 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 5.6876e-01
[rank0]:2025-12-26 19:47:20,610 - Avg. fwd time: 13.9946 / Avg. full-bwd time: 19.7768 (Avg. bwd-weight time: 30.4645 / Avg. bwd-input time: 34.6327) / Avg. batch time: 1058.4490 (ms) / GPU bubble ratio: 14.70%
[rank2]:2025-12-26 19:47:20,616 - Avg. fwd time: 8.3274 / Avg. bwd-weight time: 7.5045 / Avg. bwd-input time: 10.0998 / Avg. batch time: 1013.1600 (ms) / GPU bubble ratio: 59.05%
[rank3]:2025-12-26 19:47:20,624 - Avg. fwd time: 7.8696 / Avg. bwd-weight time: 7.5140 / Avg. bwd-input time: 9.7097 / Avg. batch time: 1005.3246 (ms) / GPU bubble ratio: 60.06%
[rank3]:2025-12-26 19:47:20,657 -  step: 750  loss: -4.0000  grad_norm:  0.4014  memory: 15.27GiB(32.13%)  tps: 7,554  tflops: 59.05  mfu: 18.93%
[rank0]:2025-12-26 19:47:20,676 -  step: 750  loss:  0.2360  grad_norm:  0.4014  memory: 35.62GiB(74.97%)  tps: 7,554  tflops: 59.05  mfu: 18.93%
[rank1]:2025-12-26 19:47:20,637 - Avg. fwd time: 10.0856 / Avg. bwd-weight time: 9.6870 / Avg. bwd-input time: 12.2579 / Avg. batch time: 1047.4585 (ms) / GPU bubble ratio: 51.07%
[rank1]:2025-12-26 19:47:20,661 -  step: 750  loss: -4.0000  grad_norm:  0.4014  memory: 17.83GiB(37.53%)  tps: 7,554  tflops: 59.05  mfu: 18.93%
[rank2]:2025-12-26 19:47:20,656 -  step: 750  loss: -4.0000  grad_norm:  0.4014  memory: 13.80GiB(29.05%)  tps: 7,554  tflops: 59.05  mfu: 18.93%
[rank2]:2025-12-26 19:47:59,739 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 19:47:59,749 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.2376e+00
[rank0]:2025-12-26 19:47:59,758 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0713e+00
[rank3]:2025-12-26 19:47:59,742 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 1.3631e+00
[rank3]:2025-12-26 19:48:42,756 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.4797e+00
[rank2]:2025-12-26 19:48:42,765 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.2491e+00
[rank1]:2025-12-26 19:48:42,756 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.2984e+00
[rank0]:2025-12-26 19:48:42,785 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 8.9434e-01
[rank1]:2025-12-26 19:49:26,165 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 2.3521e+00
[rank2]:2025-12-26 19:49:26,155 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 2.5773e+00
[rank0]:2025-12-26 19:49:26,174 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.5031e+00
[rank3]:2025-12-26 19:49:26,158 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 2.3995e+00
[rank1]:2025-12-26 19:50:09,020 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-26 19:50:09,073 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.6317e-01
[rank2]:2025-12-26 19:50:09,073 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 3.6773e-01
[rank0]:2025-12-26 19:50:09,102 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.4206e-01
[rank0]:2025-12-26 19:50:52,232 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 19:50:52,581 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 19:50:52,570 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.1384e-01
[rank0]:2025-12-26 19:50:52,590 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.2089e-01
[rank3]:2025-12-26 19:50:52,573 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 1.9896e-01
[rank3]:2025-12-26 19:50:56,959 - Avg. fwd time: 7.8700 / Avg. bwd-weight time: 7.5329 / Avg. bwd-input time: 9.7101 / Avg. batch time: 1004.8664 (ms) / GPU bubble ratio: 60.01%
[rank1]:2025-12-26 19:50:57,015 - Avg. fwd time: 10.0918 / Avg. bwd-weight time: 9.6354 / Avg. bwd-input time: 12.2592 / Avg. batch time: 1046.7295 (ms) / GPU bubble ratio: 51.11%
[rank2]:2025-12-26 19:50:56,943 - Avg. fwd time: 8.3198 / Avg. bwd-weight time: 7.5942 / Avg. bwd-input time: 10.1003 / Avg. batch time: 1013.0644 (ms) / GPU bubble ratio: 58.91%
[rank0]:2025-12-26 19:50:56,986 - Avg. fwd time: 13.9980 / Avg. full-bwd time: 19.6373 (Avg. bwd-weight time: 30.4665 / Avg. bwd-input time: 34.6344) / Avg. batch time: 1057.5599 (ms) / GPU bubble ratio: 14.72%
[rank3]:2025-12-26 19:50:57,027 -  step: 800  loss: -4.0000  grad_norm:  0.4634  memory: 15.27GiB(32.13%)  tps: 7,572  tflops: 59.20  mfu: 18.97%
[rank3]:2025-12-26 19:50:57,027 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4634  tps: 7,923  tflops: 61.94  mfu: 18.06%
[rank3]:2025-12-26 19:50:57,027 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-26 19:50:57,028 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-26 19:50:57,038 -  step: 800  loss: -4.0000  grad_norm:  0.4634  memory: 17.83GiB(37.53%)  tps: 7,572  tflops: 59.19  mfu: 18.97%
[rank1]:2025-12-26 19:50:57,038 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4634  tps: 7,924  tflops: 61.94  mfu: 18.06%
[rank1]:2025-12-26 19:50:57,038 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-26 19:50:57,039 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-26 19:50:57,021 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 13.80GiB(29.05%)  tps: 7,572  tflops: 59.20  mfu: 18.97%
[rank2]:2025-12-26 19:50:57,021 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 7,923  tflops: 61.94  mfu: 18.06%
[rank2]:2025-12-26 19:50:57,021 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-26 19:50:57,022 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 19:50:57,053 -  step: 800  loss:  0.2404  grad_norm:  0.4634  memory: 35.62GiB(74.97%)  tps: 7,572  tflops: 59.19  mfu: 18.97%
[rank0]:2025-12-26 19:50:57,054 - â„¹ï¸ final step: 800  loss:  0.2404  grad_norm:  0.4634  tps: 7,929  tflops: 61.98  mfu: 18.17%
[rank0]:2025-12-26 19:50:57,054 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-26 19:50:57,055 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 19:51:00,973 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-26 19:51:01,054 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1951_stage1_final800.svg
[rank1]:2025-12-26 19:51:01,102 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251226_1951_stage6_final800.svg
[rank2]:2025-12-26 19:51:01,054 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1951_stage2_final800.svg
[rank2]:2025-12-26 19:51:01,102 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251226_1951_stage5_final800.svg
[rank0]:2025-12-26 19:51:01,051 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1951_stage0_final800.svg
[rank0]:2025-12-26 19:51:01,097 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251226_1951_stage7_final800.svg
[rank2]:2025-12-26 19:51:01,206 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank2_stage2.svg
[rank2]:	> Counts Sum: 513, Total Sum: 1350 (38.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0]
[rank0]:2025-12-26 19:51:01,206 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank0_stage0.svg
[rank0]:	> Counts Sum: 1197, Total Sum: 1425 (84.00%), Ratio(%) per element: [0.0, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66]
[rank1]:2025-12-26 19:51:01,233 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank1_stage1.svg
[rank1]:	> Counts Sum: 684, Total Sum: 2025 (33.78%), Ratio(%) per element: [37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33]
[rank2]:2025-12-26 19:51:01,308 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank2_stage5.svg
[rank2]:	> Counts Sum: 108, Total Sum: 1350 (8.00%), Ratio(%) per element: [16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 19:51:01,308 - Destroying the purge thread.
[rank0]:2025-12-26 19:51:01,288 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank0_stage7.svg
[rank0]:	> Counts Sum: 0, Total Sum: 825 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 19:51:01,288 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-26 19:51:01,348 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1951_final800_rank3.svg
[rank3]:			> Batch Time: 1049.44 ms, GPU Bubble Ratio: 15.32%, 46.50%, 56.86%, 58.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-9-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-10-55ms     | [S0,MB6,F]  55-10-65ms     | [S7,MB0,F]  117-17-135ms   | [S7,MB0,BI] 146-32-179ms   | [S7,MB0,BW] 179-25-205ms   | [S7,MB1,F]  206-16-223ms   | [S7,MB1,BI] 235-34-270ms   | [S7,MB1,BW] 270-30-300ms   | [S7,MB2,F]  300-19-319ms   | [S7,MB2,BI] 331-35-366ms   | [S7,MB2,BW] 367-31-398ms   | [S7,MB3,F]  398-19-417ms   | [S7,MB3,BI] 429-35-464ms   | [S7,MB3,BW] 464-31-496ms   | [S0,MB7,F]  496-11-507ms   | [S0,MB0,B]  507-18-526ms   | [S7,MB4,F]  527-18-546ms   | [S7,MB4,BI] 558-34-592ms   | [S7,MB4,BW] 593-31-624ms   | [S0,MB1,B]  623-17-641ms   | [S7,MB5,F]  643-18-661ms   | [S7,MB5,BI] 674-34-708ms   | [S7,MB5,BW] 708-31-740ms   | [S0,MB2,B]  740-17-757ms   | [S7,MB6,F]  759-18-777ms   | [S7,MB6,BI] 790-34-824ms   | [S7,MB6,BW] 824-31-855ms   | [S0,MB3,B]  856-18-874ms   | [S7,MB7,F]  874-18-893ms   | [S7,MB7,BI] 905-34-939ms   | [S7,MB7,BW] 940-31-971ms   | [S0,MB4,B]  970-18-988ms   | [S0,MB5,B]  989-18-1007ms  | [S0,MB6,B]  1008-17-1025ms | [S0,MB7,B]  1033-16-1049ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-108ms    | [S1,MB5,F]  108-13-121ms   | [S6,MB1,F]  121-8-130ms    | [S6,MB0,BI] 177-9-186ms    | [S6,MB0,BW] 186-10-196ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 267-9-276ms    | [S6,MB1,BW] 276-10-286ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 363-9-373ms    | [S6,MB2,BW] 373-10-384ms   | [S1,MB6,F]  382-11-393ms   | [S1,MB0,BI] 394-15-410ms   | [S1,MB0,BW] 409-13-423ms   | [S6,MB4,F]  420-8-428ms    | [S6,MB3,BI] 461-10-471ms   | [S6,MB3,BW] 471-9-481ms    | [S1,MB7,F]  504-13-518ms   | [S1,MB1,BI] 518-15-533ms   | [S1,MB1,BW] 533-14-548ms   | [S6,MB5,F]  543-7-551ms    | [S6,MB4,BI] 588-10-599ms   | [S6,MB4,BW] 598-9-608ms    | [S1,MB2,BI] 626-14-641ms   | [S1,MB2,BW] 640-14-655ms   | [S6,MB6,F]  712-7-719ms    | [S6,MB5,BI] 719-9-729ms    | [S6,MB5,BW] 729-11-740ms   | [S1,MB3,BI] 742-14-757ms   | [S1,MB3,BW] 757-14-771ms   | [S6,MB7,F]  827-7-835ms    | [S6,MB6,BI] 834-9-844ms    | [S6,MB6,BW] 844-11-855ms   | [S1,MB4,BI] 857-14-872ms   | [S6,MB7,BI] 933-10-943ms   | [S1,MB5,BI] 944-15-959ms   | [S1,MB4,BW] 959-15-975ms   | [S1,MB6,BI] 975-14-989ms   | [S1,MB5,BW] 989-15-1004ms  | [S1,MB7,BI] 1003-14-1018ms | [S1,MB6,BW] 1018-16-1035ms | [S6,MB7,BW] 1030-11-1041ms | [S1,MB7,BW] 1040-16-1057ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-46ms      | [S2,MB2,F]  56-7-64ms      | [S5,MB0,F]  64-9-73ms      | [S2,MB3,F]  74-9-84ms      | [S5,MB1,F]  84-7-92ms      | [S2,MB4,F]  97-10-107ms    | [S5,MB2,F]  116-8-125ms    | [S5,MB0,BI] 186-9-195ms    | [S5,MB0,BW] 195-10-206ms   | [S5,MB3,F]  205-7-212ms    | [S5,MB1,BI] 276-9-285ms    | [S5,MB1,BW] 285-10-296ms   | [S2,MB5,F]  295-7-303ms    | [S2,MB0,BI] 303-10-314ms   | [S2,MB0,BW] 313-8-322ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 373-10-383ms   | [S5,MB2,BW] 383-9-393ms    | [S2,MB6,F]  395-9-405ms    | [S2,MB1,BI] 406-10-417ms   | [S2,MB1,BW] 417-9-427ms    | [S5,MB5,F]  423-7-431ms    | [S5,MB3,BI] 508-10-519ms   | [S5,MB3,BW] 519-11-531ms   | [S2,MB7,F]  529-7-537ms    | [S2,MB2,BI] 537-10-548ms   | [S2,MB2,BW] 548-9-558ms    | [S5,MB6,F]  555-7-562ms    | [S5,MB4,BI] 619-10-630ms   | [S5,MB4,BW] 630-9-639ms    | [S2,MB3,BI] 715-9-725ms    | [S2,MB3,BW] 725-10-735ms   | [S5,MB7,F]  742-7-749ms    | [S5,MB5,BI] 749-9-759ms    | [S5,MB5,BW] 759-9-769ms    | [S2,MB4,BI] 830-9-840ms    | [S5,MB6,BI] 850-10-861ms   | [S2,MB5,BI] 861-10-871ms   | [S5,MB7,BI] 947-9-956ms    | [S2,MB6,BI] 956-11-967ms   | [S2,MB4,BW] 967-10-978ms   | [S2,MB7,BI] 982-9-992ms    | [S2,MB5,BW] 992-10-1002ms  | [S5,MB6,BW] 999-9-1009ms   | [S5,MB7,BW] 1008-9-1017ms  | [S2,MB6,BW] 1017-9-1027ms  | [S2,MB7,BW] 1025-9-1035ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-55ms      | [S4,MB1,F]  55-7-63ms      | [S3,MB2,F]  65-7-72ms      | [S4,MB2,F]  72-7-80ms      | [S3,MB3,F]  99-7-107ms     | [S4,MB3,F]  107-8-115ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-9-214ms    | [S3,MB4,F]  213-7-220ms    | [S3,MB0,BI] 220-9-230ms    | [S3,MB0,BW] 230-8-239ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 286-10-296ms   | [S4,MB1,BW] 296-10-306ms   | [S3,MB5,F]  306-8-314ms    | [S3,MB1,BI] 314-9-324ms    | [S3,MB1,BW] 324-9-333ms    | [S4,MB5,F]  331-7-338ms    | [S4,MB2,BI] 399-11-410ms   | [S4,MB2,BW] 410-9-420ms    | [S3,MB6,F]  419-7-426ms    | [S3,MB2,BI] 426-9-435ms    | [S3,MB2,BW] 436-9-445ms    | [S4,MB6,F]  443-7-451ms    | [S4,MB3,BI] 523-10-533ms   | [S4,MB3,BW] 534-10-544ms   | [S3,MB7,F]  543-7-551ms    | [S3,MB3,BI] 551-9-561ms    | [S3,MB3,BW] 560-9-570ms    | [S4,MB7,F]  567-7-575ms    | [S4,MB4,BI] 708-10-719ms   | [S4,MB4,BW] 719-9-728ms    | [S3,MB4,BI] 727-10-738ms   | [S4,MB5,BI] 824-10-834ms   | [S3,MB5,BI] 834-9-843ms    | [S4,MB6,BI] 861-9-871ms    | [S3,MB6,BI] 870-9-880ms    | [S4,MB7,BI] 957-9-967ms    | [S3,MB7,BI] 967-9-976ms    | [S3,MB4,BW] 976-10-986ms   | [S4,MB5,BW] 983-9-993ms    | [S4,MB6,BW] 992-9-1002ms   | [S4,MB7,BW] 1001-9-1011ms  | [S3,MB5,BW] 1011-9-1021ms  | [S3,MB6,BW] 1019-10-1029ms | [S3,MB7,BW] 1028-10-1039ms
[rank1]:2025-12-26 19:51:01,333 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank1_stage6.svg
[rank1]:	> Counts Sum: 99, Total Sum: 1350 (7.33%), Ratio(%) per element: [14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 19:51:01,334 - Destroying the purge thread.
[rank1]:2025-12-26 19:51:01,553 - Process group destroyed
[rank2]:2025-12-26 19:51:01,564 - Process group destroyed
[rank3]:2025-12-26 19:51:01,678 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251226_1951_thry_final800_rank3.svg
[rank3]:			> Batch Time: 479.25 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB4,F]  39-9-49ms      | [S0,MB5,F]  49-9-59ms      | [S0,MB6,F]  59-9-69ms      | [S7,MB0,F]  69-9-79ms      | [S7,MB0,BI] 79-9-89ms      | [S7,MB0,BW] 89-9-99ms      | [S7,MB1,F]  99-9-109ms     | [S7,MB1,BI] 109-9-119ms    | [S7,MB1,BW] 119-9-129ms    | [S7,MB2,F]  129-9-139ms    | [S7,MB2,BI] 139-9-149ms    | [S7,MB2,BW] 149-9-159ms    | [S7,MB3,F]  159-9-169ms    | [S7,MB3,BI] 169-9-179ms    | [S7,MB3,BW] 179-9-189ms    | [S0,MB7,F]  189-9-199ms    | [S0,MB0,B]  199-19-219ms   | [S7,MB4,F]  219-9-229ms    | [S7,MB4,BI] 229-9-239ms    | [S7,MB4,BW] 239-9-249ms    | [S0,MB1,B]  249-19-269ms   | [S7,MB5,F]  269-9-279ms    | [S7,MB5,BI] 279-9-289ms    | [S7,MB5,BW] 289-9-299ms    | [S0,MB2,B]  299-19-319ms   | [S7,MB6,F]  319-9-329ms    | [S7,MB6,BI] 329-9-339ms    | [S7,MB6,BW] 339-9-349ms    | [S0,MB3,B]  349-19-369ms   | [S7,MB7,F]  369-9-379ms    | [S7,MB7,BI] 379-9-389ms    | [S7,MB7,BW] 389-9-399ms    | [S0,MB4,B]  399-19-419ms   | [S0,MB5,B]  419-19-439ms   | [S0,MB6,B]  439-19-459ms   | [S0,MB7,B]  459-19-479ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB3,F]  39-9-49ms      | [S1,MB4,F]  49-9-59ms      | [S6,MB0,F]  59-9-69ms      | [S1,MB5,F]  69-9-79ms      | [S6,MB1,F]  79-9-89ms      | [S6,MB0,BI] 89-9-99ms      | [S6,MB0,BW] 99-9-109ms     | [S6,MB2,F]  109-9-119ms    | [S6,MB1,BI] 119-9-129ms    | [S6,MB1,BW] 129-9-139ms    | [S6,MB3,F]  139-9-149ms    | [S6,MB2,BI] 149-9-159ms    | [S6,MB2,BW] 159-9-169ms    | [S1,MB6,F]  169-9-179ms    | [S1,MB0,BI] 179-9-189ms    | [S1,MB0,BW] 189-9-199ms    | [S6,MB4,F]  199-9-209ms    | [S6,MB3,BI] 209-9-219ms    | [S6,MB3,BW] 219-9-229ms    | [S1,MB7,F]  229-9-239ms    | [S1,MB1,BI] 239-9-249ms    | [S1,MB1,BW] 249-9-259ms    | [S6,MB5,F]  259-9-269ms    | [S6,MB4,BI] 269-9-279ms    | [S6,MB4,BW] 279-9-289ms    | [S1,MB2,BI] 289-9-299ms    | [S1,MB2,BW] 299-9-309ms    | [S6,MB6,F]  309-9-319ms    | [S6,MB5,BI] 319-9-329ms    | [S6,MB5,BW] 329-9-339ms    | [S1,MB3,BI] 339-9-349ms    | [S1,MB3,BW] 349-9-359ms    | [S6,MB7,F]  359-9-369ms    | [S6,MB6,BI] 369-9-379ms    | [S6,MB6,BW] 379-9-389ms    | [S1,MB4,BI] 389-9-399ms    | [S6,MB7,BI] 399-9-409ms    | [S1,MB5,BI] 409-9-419ms    | [S1,MB4,BW] 419-9-429ms    | [S1,MB6,BI] 429-9-439ms    | [S1,MB5,BW] 439-9-449ms    | [S1,MB7,BI] 449-9-459ms    | [S1,MB6,BW] 459-9-469ms    | [S6,MB7,BW] 469-9-479ms    | [S1,MB7,BW] 479-9-489ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB2,F]  39-9-49ms      | [S5,MB0,F]  49-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-9-79ms      | [S2,MB4,F]  79-9-89ms      | [S5,MB2,F]  89-9-99ms      | [S5,MB0,BI] 99-9-109ms     | [S5,MB0,BW] 109-9-119ms    | [S5,MB3,F]  119-9-129ms    | [S5,MB1,BI] 129-9-139ms    | [S5,MB1,BW] 139-9-149ms    | [S2,MB5,F]  149-9-159ms    | [S2,MB0,BI] 159-9-169ms    | [S2,MB0,BW] 169-9-179ms    | [S5,MB4,F]  179-9-189ms    | [S5,MB2,BI] 189-9-199ms    | [S5,MB2,BW] 199-9-209ms    | [S2,MB6,F]  209-9-219ms    | [S2,MB1,BI] 219-9-229ms    | [S2,MB1,BW] 229-9-239ms    | [S5,MB5,F]  239-9-249ms    | [S5,MB3,BI] 249-9-259ms    | [S5,MB3,BW] 259-9-269ms    | [S2,MB7,F]  269-9-279ms    | [S2,MB2,BI] 279-9-289ms    | [S2,MB2,BW] 289-9-299ms    | [S5,MB6,F]  299-9-309ms    | [S5,MB4,BI] 309-9-319ms    | [S5,MB4,BW] 319-9-329ms    | [S2,MB3,BI] 329-9-339ms    | [S2,MB3,BW] 339-9-349ms    | [S5,MB7,F]  349-9-359ms    | [S5,MB5,BI] 359-9-369ms    | [S5,MB5,BW] 369-9-379ms    | [S2,MB4,BI] 379-9-389ms    | [S5,MB6,BI] 389-9-399ms    | [S2,MB5,BI] 399-9-409ms    | [S5,MB7,BI] 409-9-419ms    | [S2,MB6,BI] 419-9-429ms    | [S2,MB4,BW] 429-9-439ms    | [S2,MB7,BI] 439-9-449ms    | [S2,MB5,BW] 449-9-459ms    | [S5,MB6,BW] 459-9-469ms    | [S5,MB7,BW] 469-9-479ms    | [S2,MB6,BW] 479-9-489ms    | [S2,MB7,BW] 489-9-499ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S4,MB0,F]  39-9-49ms      | [S3,MB1,F]  49-9-59ms      | [S4,MB1,F]  59-9-69ms      | [S3,MB2,F]  69-9-79ms      | [S4,MB2,F]  79-9-89ms      | [S3,MB3,F]  89-9-99ms      | [S4,MB3,F]  99-9-109ms     | [S4,MB0,BI] 109-9-119ms    | [S4,MB0,BW] 119-9-129ms    | [S3,MB4,F]  129-9-139ms    | [S3,MB0,BI] 139-9-149ms    | [S3,MB0,BW] 149-9-159ms    | [S4,MB4,F]  159-9-169ms    | [S4,MB1,BI] 169-9-179ms    | [S4,MB1,BW] 179-9-189ms    | [S3,MB5,F]  189-9-199ms    | [S3,MB1,BI] 199-9-209ms    | [S3,MB1,BW] 209-9-219ms    | [S4,MB5,F]  219-9-229ms    | [S4,MB2,BI] 229-9-239ms    | [S4,MB2,BW] 239-9-249ms    | [S3,MB6,F]  249-9-259ms    | [S3,MB2,BI] 259-9-269ms    | [S3,MB2,BW] 269-9-279ms    | [S4,MB6,F]  279-9-289ms    | [S4,MB3,BI] 289-9-299ms    | [S4,MB3,BW] 299-9-309ms    | [S3,MB7,F]  309-9-319ms    | [S3,MB3,BI] 319-9-329ms    | [S3,MB3,BW] 329-9-339ms    | [S4,MB7,F]  339-9-349ms    | [S4,MB4,BI] 349-9-359ms    | [S4,MB4,BW] 359-9-369ms    | [S3,MB4,BI] 369-9-379ms    | [S4,MB5,BI] 379-9-389ms    | [S3,MB5,BI] 389-9-399ms    | [S4,MB6,BI] 399-9-409ms    | [S3,MB6,BI] 409-9-419ms    | [S4,MB7,BI] 419-9-429ms    | [S3,MB7,BI] 429-9-439ms    | [S3,MB4,BW] 439-9-449ms    | [S4,MB5,BW] 449-9-459ms    | [S4,MB6,BW] 459-9-469ms    | [S4,MB7,BW] 469-9-479ms    | [S3,MB5,BW] 479-9-489ms    | [S3,MB6,BW] 489-9-499ms    | [S3,MB7,BW] 499-9-509ms   
[rank3]:2025-12-26 19:51:01,725 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1951_stage3_final800.svg
[rank3]:2025-12-26 19:51:01,772 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251226_1951_stage4_final800.svg
[rank3]:2025-12-26 19:51:01,870 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank3_stage3.svg
[rank3]:	> Counts Sum: 459, Total Sum: 1350 (34.00%), Ratio(%) per element: [37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 30.66, 30.66, 30.66, 30.66, 30.66, 30.66, 30.66, 30.66, 30.66]
[rank3]:2025-12-26 19:51:01,967 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251226_1951_rank3_stage4.svg
[rank3]:	> Counts Sum: 99, Total Sum: 1350 (7.33%), Ratio(%) per element: [14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 14.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 19:51:01,968 - Destroying the purge thread.
[rank3]:2025-12-26 19:51:02,471 - Process group destroyed
[rank0]:2025-12-26 19:51:03,289 - Training completed
[rank0]:2025-12-26 19:51:03,290 - Destroying the purge thread.
[rank0]:wandb: updating run metadata
[rank0]:wandb: uploading history steps 15-16, summary, console lines 185-199
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 4.13286
[rank0]:wandb:               final/avg_loss 0.24041
[rank0]:wandb:             final/avg_mfu(%) 18.17214
[rank0]:wandb:             final/avg_tflops 61.98246
[rank0]:wandb:    final/avg_throughput(tps) 7928.64099
[rank0]:wandb:              final/grad_norm 0.4634
[rank0]:wandb:               final/max_loss 0.24041
[rank0]:wandb:                    grad_norm 0.4634
[rank0]:wandb: loss_metrics/global_avg_loss 0.24041
[rank0]:wandb: loss_metrics/global_max_loss 0.24041
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/3a5ougai
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_auto_42_dm1/20251226-1852/wandb/run-20251226_185222-3a5ougai/logs
[rank0]:2025-12-26 19:51:04,590 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.2', 'layers.4'}
[rank1]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings'}
[rank0]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
