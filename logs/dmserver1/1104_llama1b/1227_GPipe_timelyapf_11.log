
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 16:09:46 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_GPipe_timelyapf_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-28 16:09:53,107 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank2]:2025-12-28 16:09:53,263 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 16:09:53,265 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 16:09:53,262 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:2025-12-28 16:09:53,419 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 16:09:53,422 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 16:09:53,533 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank1]:2025-12-28 16:09:53,533 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank0]:2025-12-28 16:09:53,846 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 16:09:53,849 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 16:09:53,852 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 16:09:53,853 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-28 16:09:53,839 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 16:09:53,843 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 16:09:54,239 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-28 16:09:57,392 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 16:09:57,425 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 16:09:57,432 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 16:09:57,458 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 16:09:57,459 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-28 16:09:57,527 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-28 16:09:57,463 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 16:09:57,491 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 16:09:57,491 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-28 16:09:57,663 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 16:09:57,663 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 16:09:57,664 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-28 16:09:57,688 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 16:09:57,727 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 16:09:57,698 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 16:09:57,698 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 16:09:57,698 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-28 16:09:57,729 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 16:09:57,745 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 16:09:57,745 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-28 16:09:58,030 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 16:09:58,030 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 16:09:58,031 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run rich26of
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_GPipe_timelyapf_11_dm1/20251228-1609/wandb/run-20251228_160958-rich26of
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_GPipe_timelyapf_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/rich26of
[rank3]:2025-12-28 16:09:59,737 - WandB logging enabled
[rank3]:2025-12-28 16:09:59,738 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 16:09:59,776 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 16:09:59,806 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 16:09:59,807 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-28 16:10:00,057 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-28 16:10:00,057 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 16:10:00,057 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_GPipe_timelyapf_11_dm1
[rank0]:2025-12-28 16:10:00,057 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 16:10:00,057 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank3]:2025-12-28 16:10:00,038 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 16:10:00,058 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-28 16:10:00,039 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 16:10:00,040 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-28 16:10:00,057 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 16:10:02,444 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 16:10:02,444 - Finished loading the checkpoint in 2.39 seconds.
[rank0]:2025-12-28 16:10:02,444 - Training starts at step 1
[rank3]:2025-12-28 16:10:08,028 -  step:  1  loss: 10.6088  grad_norm: 116.5371  memory: 24.19GiB(50.91%)  tps: 3,973  tflops: 31.06  mfu: 9.95%
[rank3]:2025-12-28 16:10:08,028 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 16:10:08,016 -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory: 10.24GiB(21.56%)  tps: 3,096  tflops: 24.20  mfu: 7.76%
[rank2]:2025-12-28 16:10:08,016 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 16:10:08,019 -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory: 12.75GiB(26.83%)  tps: 3,104  tflops: 24.27  mfu: 7.78%
[rank1]:2025-12-28 16:10:08,019 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 16:10:08,057 -  step:  1  loss: -8.0000  grad_norm: 116.5371  memory: 13.25GiB(27.89%)  tps: 3,172  tflops: 24.80  mfu: 7.95%
[rank0]:2025-12-28 16:10:08,057 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 16:12:07,945 - Avg. fwd time: 7.0073 / Avg. bwd time: 19.3706 / Avg. batch time: 529.0441 (ms) / GPU bubble ratio: 60.11%
[rank3]:2025-12-28 16:12:07,920 - Avg. fwd time: 10.8735 / Avg. bwd time: 43.7360 / Avg. batch time: 496.7770 (ms) / GPU bubble ratio: 12.06%
[rank1]:2025-12-28 16:12:07,975 - Avg. fwd time: 9.1283 / Avg. bwd time: 24.9701 / Avg. batch time: 569.4916 (ms) / GPU bubble ratio: 52.10%
[rank0]:2025-12-28 16:12:08,005 - Avg. fwd time: 8.3058 / Avg. bwd time: 25.2313 / Avg. batch time: 608.6296 (ms) / GPU bubble ratio: 55.92%
[rank0]:2025-12-28 16:14:08,138 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:14:13,008 - Avg. fwd time: 10.8625 / Avg. bwd time: 43.8638 / Avg. batch time: 497.5554 (ms) / GPU bubble ratio: 12.01%
[rank2]:2025-12-28 16:14:13,034 - Avg. fwd time: 7.0032 / Avg. bwd time: 19.4040 / Avg. batch time: 529.4464 (ms) / GPU bubble ratio: 60.10%
[rank1]:2025-12-28 16:14:13,064 - Avg. fwd time: 9.1259 / Avg. bwd time: 25.0283 / Avg. batch time: 569.5779 (ms) / GPU bubble ratio: 52.03%
[rank1]:2025-12-28 16:14:13,119 -  step: 50  loss: -8.0000  grad_norm: 12.6590  memory: 15.15GiB(31.89%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank3]:2025-12-28 16:14:13,128 -  step: 50  loss:  9.9116  grad_norm: 12.6590  memory: 26.98GiB(56.79%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank0]:2025-12-28 16:14:13,094 - Avg. fwd time: 8.2932 / Avg. bwd time: 25.2699 / Avg. batch time: 608.3560 (ms) / GPU bubble ratio: 55.86%
[rank0]:2025-12-28 16:14:13,130 -  step: 50  loss: -8.0000  grad_norm: 12.6590  memory: 17.08GiB(35.95%)  tps: 6,552  tflops: 51.22  mfu: 16.42%
[rank2]:2025-12-28 16:14:13,115 -  step: 50  loss: -8.0000  grad_norm: 12.6590  memory: 12.26GiB(25.80%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank3]:2025-12-28 16:14:57,796 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-28 16:15:47,719 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-28 16:15:48,031 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-28 16:16:06,697 - Avg. fwd time: 10.8516 / Avg. bwd time: 42.0849 / Avg. batch time: 483.1912 (ms) / GPU bubble ratio: 12.36%
[rank2]:2025-12-28 16:16:06,712 - Avg. fwd time: 6.9969 / Avg. bwd time: 18.5394 / Avg. batch time: 514.0769 (ms) / GPU bubble ratio: 60.26%
[rank1]:2025-12-28 16:16:06,728 - Avg. fwd time: 9.1190 / Avg. bwd time: 23.9107 / Avg. batch time: 552.9371 (ms) / GPU bubble ratio: 52.21%
[rank0]:2025-12-28 16:16:06,733 - Avg. fwd time: 8.2744 / Avg. bwd time: 23.2629 / Avg. batch time: 589.5680 (ms) / GPU bubble ratio: 57.21%
[rank3]:2025-12-28 16:16:18,938 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-28 16:16:19,268 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1616_max_batch_time.svg
[rank3]:			> Batch Time: 538.72 ms, GPU Bubble Ratio: 49.87%, 49.00%, 60.52%, 18.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  201-25-227ms   | [S0,MB1,B]  244-25-270ms   | [S0,MB2,B]  288-25-314ms   | [S0,MB3,B]  333-25-359ms   | [S0,MB4,B]  378-25-403ms   | [S0,MB5,B]  422-25-448ms   | [S0,MB6,B]  468-25-493ms   | [S0,MB7,B]  513-25-538ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-74ms      | [S1,MB7,F]  74-8-82ms      | [S1,MB0,B]  176-25-201ms   | [S1,MB1,B]  219-25-244ms   | [S1,MB2,B]  263-25-288ms   | [S1,MB3,B]  308-25-333ms   | [S1,MB4,B]  353-25-378ms   | [S1,MB5,B]  397-25-422ms   | [S1,MB6,B]  442-25-468ms   | [S1,MB7,B]  487-25-513ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  74-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  157-19-176ms   | [S2,MB1,B]  200-19-219ms   | [S2,MB2,B]  244-19-263ms   | [S2,MB3,B]  288-19-308ms   | [S2,MB4,B]  333-19-353ms   | [S2,MB5,B]  377-19-397ms   | [S2,MB6,B]  423-19-442ms   | [S2,MB7,B]  468-19-487ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-157ms   AFR(10):0.9655 | [S3,MB1,B]  157-43-200ms   AFR(10):0.9655 | [S3,MB2,B]  200-43-244ms   AFR(10):0.9655 | [S3,MB3,B]  244-44-288ms   AFR(10):0.9655 | [S3,MB4,B]  288-44-333ms   AFR(10):0.9655 | [S3,MB5,B]  333-44-377ms   AFR(10):0.9655 | [S3,MB6,B]  377-45-423ms   AFR(10):0.9655 | [S3,MB7,B]  423-44-468ms   AFR(10):0.9655
[rank3]:2025-12-28 16:16:19,395 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1616_min_batch_time.svg
[rank3]:			> Batch Time: 307.88 ms, GPU Bubble Ratio: 78.49%, 48.39%, 60.17%, 15.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  156-0-156ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB2,B]  199-0-199ms    | [S0,MB3,B]  221-0-221ms    | [S0,MB4,B]  242-0-242ms    | [S0,MB5,B]  264-0-264ms    | [S0,MB6,B]  286-0-286ms    | [S0,MB7,B]  307-0-307ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-74ms      | [S1,MB7,F]  74-8-82ms      | [S1,MB0,B]  146-10-156ms   | [S1,MB1,B]  167-10-177ms   | [S1,MB2,B]  188-10-199ms   | [S1,MB3,B]  210-10-221ms   | [S1,MB4,B]  231-10-242ms   | [S1,MB5,B]  253-10-264ms   | [S1,MB6,B]  275-10-286ms   | [S1,MB7,B]  297-10-307ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  74-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  137-8-146ms    | [S2,MB1,B]  158-8-167ms    | [S2,MB2,B]  180-8-188ms    | [S2,MB3,B]  201-8-210ms    | [S2,MB4,B]  223-8-231ms    | [S2,MB5,B]  245-8-253ms    | [S2,MB6,B]  267-8-275ms    | [S2,MB7,B]  288-8-297ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-21-137ms   AFR(10):0.9655 | [S3,MB1,B]  137-21-158ms   AFR(10):0.9655 | [S3,MB2,B]  158-21-180ms   AFR(10):0.9655 | [S3,MB3,B]  180-21-201ms   AFR(10):0.9655 | [S3,MB4,B]  201-21-223ms   AFR(10):0.9655 | [S3,MB5,B]  223-21-245ms   AFR(10):0.9655 | [S3,MB6,B]  245-21-267ms   AFR(10):0.9655 | [S3,MB7,B]  267-21-288ms   AFR(10):0.9655
[rank3]:2025-12-28 16:16:19,535 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1616_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 340.59 ms, GPU Bubble Ratio: 41.37%, 33.17%, 40.97%, 14.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  201-25-227ms   | [S0,MB1,B]  232-25-258ms   | [S0,MB2,B]  258-25-283ms   | [S0,MB3,B]  283-25-309ms   | [S0,MB4,B]  309-20-329ms   | [S0,MB5,B]  329-0-329ms    | [S0,MB6,B]  329-10-340ms   | [S0,MB7,B]  340-0-340ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-74ms      | [S1,MB7,F]  74-8-82ms      | [S1,MB0,B]  176-25-201ms   | [S1,MB1,B]  211-21-232ms   | [S1,MB2,B]  232-21-254ms   | [S1,MB3,B]  254-25-279ms   | [S1,MB4,B]  279-18-297ms   | [S1,MB5,B]  297-21-319ms   | [S1,MB6,B]  319-10-329ms   | [S1,MB7,B]  329-10-340ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  74-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  157-19-176ms   | [S2,MB1,B]  191-19-211ms   | [S2,MB2,B]  213-19-232ms   | [S2,MB3,B]  234-19-254ms   | [S2,MB4,B]  256-19-275ms   | [S2,MB5,B]  278-19-297ms   | [S2,MB6,B]  299-19-319ms   | [S2,MB7,B]  321-8-329ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-157ms   AFR(10):0.9655 | [S3,MB1,B]  157-34-191ms   AFR(10):0.9655 | [S3,MB2,B]  191-21-213ms   AFR(10):0.9655 | [S3,MB3,B]  213-21-234ms   AFR(10):0.9655 | [S3,MB4,B]  234-21-256ms   AFR(10):0.9655 | [S3,MB5,B]  256-21-278ms   AFR(10):0.9655 | [S3,MB6,B]  278-21-299ms   AFR(10):0.9655 | [S3,MB7,B]  299-21-321ms   AFR(10):0.9655
[rank3]:2025-12-28 16:16:19,535 - 	> Batch Time: 340.59 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.37)
[rank0]:2025-12-28 16:17:44,181 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 16:17:44,239 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.06/0.18, [MB5] 0.33/1.00, [MB6] 0.19/0.58, [MB7] 0.33/1.00
[rank3]:2025-12-28 16:17:44,231 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-12-28 16:17:44,214 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.08/0.24, [MB2] 0.08/0.25, [MB3] 0.00/0.00, [MB4] 0.16/0.48, [MB5] 0.09/0.26, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-12-28 16:17:44,206 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.03, [MB7] 0.33/1.00
[rank1]:2025-12-28 16:17:48,827 - Avg. fwd time: 9.1188 / Avg. bwd time: 22.8562 / Avg. batch time: 532.1534 (ms) / GPU bubble ratio: 51.93%
[rank3]:2025-12-28 16:17:48,779 - Avg. fwd time: 10.8414 / Avg. bwd time: 39.6232 / Avg. batch time: 463.4061 (ms) / GPU bubble ratio: 12.88%
[rank2]:2025-12-28 16:17:48,802 - Avg. fwd time: 6.9911 / Avg. bwd time: 18.1666 / Avg. batch time: 495.2563 (ms) / GPU bubble ratio: 59.36%
[rank0]:2025-12-28 16:17:48,853 - Avg. fwd time: 8.2658 / Avg. bwd time: 21.7718 / Avg. batch time: 565.4733 (ms) / GPU bubble ratio: 57.50%
[rank0]:2025-12-28 16:17:48,890 -  step: 100  loss: -8.0000  grad_norm:  7.9578  memory: 19.07GiB(40.15%)  tps: 7,594  tflops: 59.36  mfu: 19.03%
[rank1]:2025-12-28 16:17:48,878 -  step: 100  loss: -8.0000  grad_norm:  7.9578  memory: 16.21GiB(34.11%)  tps: 7,594  tflops: 59.36  mfu: 19.03%
[rank1]:2025-12-28 16:17:48,950 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1617_stage1_step100.svg
[rank3]:2025-12-28 16:17:48,888 -  step: 100  loss:  8.6968  grad_norm:  7.9578  memory: 29.36GiB(61.81%)  tps: 7,594  tflops: 59.36  mfu: 19.03%
[rank2]:2025-12-28 16:17:48,875 -  step: 100  loss: -8.0000  grad_norm:  7.9578  memory: 13.15GiB(27.69%)  tps: 7,594  tflops: 59.36  mfu: 19.03%
[rank2]:2025-12-28 16:17:48,951 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1617_stage2_step100.svg
[rank0]:2025-12-28 16:17:48,960 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1617_stage0_step100.svg
[rank3]:2025-12-28 16:17:49,029 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1617_step100_rank3.svg
[rank3]:			> Batch Time: 566.39 ms, GPU Bubble Ratio: 55.55%, 54.21%, 63.25%, 26.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  271-25-296ms   | [S0,MB1,B]  311-25-336ms   | [S0,MB2,B]  352-25-377ms   | [S0,MB3,B]  394-25-419ms   | [S0,MB4,B]  436-24-460ms   | [S0,MB5,B]  477-18-495ms   | [S0,MB6,B]  514-22-536ms   | [S0,MB7,B]  548-17-566ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  128-8-137ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  283-24-308ms   | [S1,MB2,B]  324-23-348ms   | [S1,MB3,B]  366-25-391ms   | [S1,MB4,B]  409-23-432ms   | [S1,MB5,B]  450-24-474ms   | [S1,MB6,B]  491-19-511ms   | [S1,MB7,B]  523-20-544ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  107-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  261-19-280ms   | [S2,MB2,B]  301-19-321ms   | [S2,MB3,B]  343-19-363ms   | [S2,MB4,B]  386-19-406ms   | [S2,MB5,B]  427-19-447ms   | [S2,MB6,B]  468-19-488ms   | [S2,MB7,B]  505-15-520ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  122-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-39-253ms   | [S3,MB2,B]  254-41-295ms   | [S3,MB3,B]  295-41-336ms   | [S3,MB4,B]  336-43-379ms   | [S3,MB5,B]  379-40-420ms   | [S3,MB6,B]  420-41-461ms   | [S3,MB7,B]  461-41-503ms  
[rank0]:2025-12-28 16:17:49,124 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1617_rank0_stage0.svg
[rank0]:	> Counts Sum: 34080, Total Sum: 71040 (47.97%), Ratio(%) per element: [50.0, 50.0, 45.83, 45.83, 54.16, 45.83, 50.0, 45.83, 50.0, 41.66, 45.83, 50.0, 54.16, 45.83, 45.83, 41.66, 50.0, 45.83, 45.83, 45.83, 58.33, 50.0, 58.33, 50.0, 41.66, 50.0, 45.83, 45.83, 45.83, 45.83, 50.0, 45.83, 50.0, 50.0, 50.0, 41.66, 45.83]
[rank1]:2025-12-28 16:17:49,100 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1617_rank1_stage1.svg
[rank1]:	> Counts Sum: 43600, Total Sum: 86400 (50.46%), Ratio(%) per element: [50.0, 41.66, 50.0, 58.33, 62.5, 45.83, 58.33, 50.0, 50.0, 50.0, 45.83, 45.83, 54.16, 50.0, 54.16, 50.0, 45.83, 50.0, 50.0, 58.33, 58.33, 50.0, 62.5, 58.33, 54.16, 54.16, 41.66, 45.83, 50.0, 45.83, 41.66, 45.83, 50.0, 50.0, 45.83, 50.0, 45.83, 41.66, 58.33, 54.16, 50.0, 54.16, 50.0, 45.83, 45.83]
[rank3]:2025-12-28 16:17:49,078 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1617_stage3_step100.svg
[rank2]:2025-12-28 16:17:49,112 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1617_rank2_stage2.svg
[rank2]:	> Counts Sum: 26800, Total Sum: 69120 (38.77%), Ratio(%) per element: [41.66, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 45.83, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5]
[rank0]:2025-12-28 16:17:49,214 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1617_stage0.svg
[rank1]:2025-12-28 16:17:49,193 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1617_stage1.svg
[rank3]:2025-12-28 16:17:49,215 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1617_rank3_stage3.svg
[rank3]:	> Counts Sum: 36880, Total Sum: 55680 (66.24%), Ratio(%) per element: [75.0, 62.5, 75.0, 70.83, 62.5, 70.83, 66.66, 54.16, 54.16, 66.66, 75.0, 79.16, 62.5, 66.66, 79.16, 70.83, 54.16, 58.33, 75.0, 66.66, 75.0, 70.83, 75.0, 62.5, 70.83, 50.0, 58.33, 54.16, 58.33]
[rank2]:2025-12-28 16:17:49,203 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1617_stage2.svg
[rank3]:2025-12-28 16:17:49,313 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1617_stage3.svg
[rank0]:2025-12-28 16:19:43,990 - Avg. fwd time: 8.2555 / Avg. bwd time: 21.9761 / Avg. batch time: 563.5315 (ms) / GPU bubble ratio: 57.08%
[rank2]:2025-12-28 16:19:43,942 - Avg. fwd time: 6.9849 / Avg. bwd time: 18.3190 / Avg. batch time: 494.1387 (ms) / GPU bubble ratio: 59.03%
[rank1]:2025-12-28 16:19:43,966 - Avg. fwd time: 9.1105 / Avg. bwd time: 22.7548 / Avg. batch time: 530.3750 (ms) / GPU bubble ratio: 51.94%
[rank3]:2025-12-28 16:19:43,924 - Avg. fwd time: 10.8194 / Avg. bwd time: 39.6291 / Avg. batch time: 463.2503 (ms) / GPU bubble ratio: 12.88%
[rank0]:2025-12-28 16:21:29,527 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 16:21:29,542 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.03, [MB7] 0.67/1.00
[rank0]:2025-12-28 16:21:29,573 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.12/0.18, [MB5] 0.67/1.00, [MB6] 0.39/0.58, [MB7] 0.67/1.00
[rank1]:2025-12-28 16:21:29,550 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.16/0.24, [MB2] 0.17/0.25, [MB3] 0.00/0.00, [MB4] 0.32/0.48, [MB5] 0.18/0.26, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-28 16:21:29,567 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-28 16:21:33,749 - Avg. fwd time: 10.8080 / Avg. bwd time: 39.3735 / Avg. batch time: 461.0973 (ms) / GPU bubble ratio: 12.94%
[rank0]:2025-12-28 16:21:33,800 - Avg. fwd time: 8.2488 / Avg. bwd time: 21.9638 / Avg. batch time: 557.9991 (ms) / GPU bubble ratio: 56.68%
[rank0]:2025-12-28 16:21:33,837 -  step: 150  loss: -8.0000  grad_norm: 11.2896  memory: 19.07GiB(40.15%)  tps: 7,284  tflops: 56.94  mfu: 18.25%
[rank2]:2025-12-28 16:21:33,766 - Avg. fwd time: 6.9803 / Avg. bwd time: 18.3292 / Avg. batch time: 490.6138 (ms) / GPU bubble ratio: 58.73%
[rank2]:2025-12-28 16:21:33,822 -  step: 150  loss: -8.0000  grad_norm: 11.2896  memory: 13.15GiB(27.69%)  tps: 7,284  tflops: 56.94  mfu: 18.25%
[rank1]:2025-12-28 16:21:33,785 - Avg. fwd time: 9.1032 / Avg. bwd time: 22.4547 / Avg. batch time: 525.7175 (ms) / GPU bubble ratio: 51.98%
[rank1]:2025-12-28 16:21:33,825 -  step: 150  loss: -8.0000  grad_norm: 11.2896  memory: 16.34GiB(34.40%)  tps: 7,283  tflops: 56.94  mfu: 18.25%
[rank3]:2025-12-28 16:21:33,836 -  step: 150  loss:  3.9284  grad_norm: 11.2896  memory: 29.36GiB(61.81%)  tps: 7,284  tflops: 56.94  mfu: 18.25%
[rank2]:2025-12-28 16:23:18,621 - Avg. fwd time: 6.9781 / Avg. bwd time: 18.3359 / Avg. batch time: 485.5782 (ms) / GPU bubble ratio: 58.29%
[rank0]:2025-12-28 16:23:18,655 - Avg. fwd time: 8.2399 / Avg. bwd time: 21.6772 / Avg. batch time: 550.5137 (ms) / GPU bubble ratio: 56.52%
[rank3]:2025-12-28 16:23:18,604 - Avg. fwd time: 10.8123 / Avg. bwd time: 38.8475 / Avg. batch time: 456.9214 (ms) / GPU bubble ratio: 13.05%
[rank1]:2025-12-28 16:23:18,639 - Avg. fwd time: 9.0989 / Avg. bwd time: 22.0978 / Avg. batch time: 519.5745 (ms) / GPU bubble ratio: 51.97%
[rank2]:2025-12-28 16:24:53,884 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank0]:2025-12-28 16:24:53,857 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:24:53,908 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 16:24:53,893 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.24/0.24, [MB2] 0.25/0.25, [MB3] 0.00/0.00, [MB4] 0.48/0.48, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 16:24:53,915 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.18/0.18, [MB5] 1.00/1.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank2]:2025-12-28 16:24:57,606 - Avg. fwd time: 6.9755 / Avg. bwd time: 18.3513 / Avg. batch time: 478.2160 (ms) / GPU bubble ratio: 57.63%
[rank3]:2025-12-28 16:24:57,568 - Avg. fwd time: 10.8048 / Avg. bwd time: 37.9376 / Avg. batch time: 449.5715 (ms) / GPU bubble ratio: 13.26%
[rank1]:2025-12-28 16:24:57,624 - Avg. fwd time: 9.0970 / Avg. bwd time: 21.7764 / Avg. batch time: 511.3677 (ms) / GPU bubble ratio: 51.70%
[rank2]:2025-12-28 16:24:57,652 -  step: 200  loss: -8.0000  grad_norm:  2.3186  memory: 13.15GiB(27.69%)  tps: 8,038  tflops: 62.84  mfu: 20.14%
[rank0]:2025-12-28 16:24:57,630 - Avg. fwd time: 8.2421 / Avg. bwd time: 21.3906 / Avg. batch time: 541.2264 (ms) / GPU bubble ratio: 56.20%
[rank0]:2025-12-28 16:24:57,666 -  step: 200  loss: -8.0000  grad_norm:  2.3186  memory: 19.07GiB(40.15%)  tps: 8,038  tflops: 62.84  mfu: 20.14%
[rank3]:2025-12-28 16:24:57,664 -  step: 200  loss:  1.1989  grad_norm:  2.3186  memory: 29.36GiB(61.81%)  tps: 8,038  tflops: 62.84  mfu: 20.14%
[rank1]:2025-12-28 16:24:57,655 -  step: 200  loss: -8.0000  grad_norm:  2.3186  memory: 16.40GiB(34.52%)  tps: 8,038  tflops: 62.84  mfu: 20.14%
[rank1]:2025-12-28 16:24:57,717 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1624_stage1_step200.svg
[rank2]:2025-12-28 16:24:57,717 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1624_stage2_step200.svg
[rank0]:2025-12-28 16:24:57,719 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1624_stage0_step200.svg
[rank3]:2025-12-28 16:24:57,805 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1624_step200_rank3.svg
[rank3]:			> Batch Time: 457.80 ms, GPU Bubble Ratio: 50.64%, 49.64%, 55.34%, 32.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-8-49ms      | [S0,MB6,F]  49-8-58ms      | [S0,MB7,F]  58-8-66ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  307-25-333ms   | [S0,MB2,B]  334-25-360ms   | [S0,MB3,B]  364-25-390ms   | [S0,MB4,B]  391-24-416ms   | [S0,MB5,B]  418-8-426ms    | [S0,MB6,B]  432-15-447ms   | [S0,MB7,B]  449-8-457ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-101ms     | [S1,MB6,F]  110-8-119ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  282-22-304ms   | [S1,MB2,B]  307-21-329ms   | [S1,MB3,B]  334-25-360ms   | [S1,MB4,B]  364-18-382ms   | [S1,MB5,B]  391-21-413ms   | [S1,MB6,B]  417-11-429ms   | [S1,MB7,B]  432-11-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  107-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  259-19-279ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  334-20-354ms   | [S2,MB5,B]  364-20-384ms   | [S2,MB6,B]  391-20-411ms   | [S2,MB7,B]  417-8-426ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  86-10-96ms     | [S3,MB4,F]  104-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  252-23-275ms   | [S3,MB3,B]  275-22-298ms   | [S3,MB4,B]  297-22-320ms   | [S3,MB5,B]  320-33-353ms   | [S3,MB6,B]  352-23-375ms   | [S3,MB7,B]  375-22-398ms  
[rank2]:2025-12-28 16:24:57,869 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1624_rank2_stage2.svg
[rank2]:	> Counts Sum: 45600, Total Sum: 299520 (15.22%), Ratio(%) per element: [17.3, 16.34, 15.38, 18.26, 17.3, 17.3, 15.38, 11.53, 11.53, 15.38, 14.42, 14.42, 17.3, 16.34, 18.26, 15.38, 9.61, 13.46, 16.34, 15.38, 14.42, 17.3, 15.38, 18.26, 16.34, 10.57, 10.57, 16.34, 17.3, 16.34, 17.3, 16.34, 17.3, 16.34, 11.53, 9.61]
[rank0]:2025-12-28 16:24:57,872 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1624_rank0_stage0.svg
[rank0]:	> Counts Sum: 86000, Total Sum: 307840 (27.94%), Ratio(%) per element: [31.73, 32.69, 31.73, 33.65, 29.8, 30.76, 28.84, 31.73, 15.38, 10.57, 29.8, 34.61, 33.65, 33.65, 29.8, 29.8, 30.76, 12.5, 16.34, 33.65, 34.61, 27.88, 32.69, 32.69, 32.69, 32.69, 12.5, 12.5, 29.8, 33.65, 36.53, 30.76, 29.8, 30.76, 29.8, 13.46, 19.23]
[rank3]:2025-12-28 16:24:57,849 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1624_stage3_step200.svg
[rank1]:2025-12-28 16:24:57,865 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1624_rank1_stage1.svg
[rank1]:	> Counts Sum: 117600, Total Sum: 374400 (31.41%), Ratio(%) per element: [37.5, 30.76, 33.65, 36.53, 42.3, 41.34, 34.61, 13.46, 15.38, 35.57, 34.61, 30.76, 41.34, 37.5, 34.61, 32.69, 14.42, 15.38, 35.57, 39.42, 30.76, 39.42, 40.38, 38.46, 36.53, 15.38, 10.57, 30.76, 35.57, 34.61, 32.69, 35.57, 34.61, 35.57, 16.34, 19.23, 36.53, 31.73, 39.42, 39.42, 38.46, 38.46, 37.5, 15.38, 12.5]
[rank3]:2025-12-28 16:24:57,982 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1624_rank3_stage3.svg
[rank3]:	> Counts Sum: 130640, Total Sum: 241280 (54.14%), Ratio(%) per element: [71.15, 63.46, 67.3, 63.46, 66.34, 61.53, 66.34, 23.07, 22.11, 71.15, 72.11, 68.26, 62.5, 71.15, 66.34, 70.19, 18.26, 25.0, 74.03, 63.46, 61.53, 62.5, 63.46, 57.69, 68.26, 26.92, 20.19, 21.15, 21.15]
[rank0]:2025-12-28 16:24:58,215 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1624_stage0.svg
[rank1]:2025-12-28 16:24:58,206 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1624_stage1.svg
[rank2]:2025-12-28 16:24:58,221 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1624_stage2.svg
[rank3]:2025-12-28 16:24:58,319 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1624_stage3.svg
[rank3]:2025-12-28 16:26:30,829 - Avg. fwd time: 10.7971 / Avg. bwd time: 36.6816 / Avg. batch time: 439.4508 (ms) / GPU bubble ratio: 13.57%
[rank2]:2025-12-28 16:26:30,865 - Avg. fwd time: 6.9740 / Avg. bwd time: 18.3798 / Avg. batch time: 469.9041 (ms) / GPU bubble ratio: 56.84%
[rank0]:2025-12-28 16:26:30,890 - Avg. fwd time: 8.2408 / Avg. bwd time: 20.8642 / Avg. batch time: 530.5562 (ms) / GPU bubble ratio: 56.11%
[rank1]:2025-12-28 16:26:30,884 - Avg. fwd time: 9.1033 / Avg. bwd time: 21.4869 / Avg. batch time: 502.5709 (ms) / GPU bubble ratio: 51.31%
[rank2]:2025-12-28 16:27:59,920 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank0]:2025-12-28 16:27:59,903 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 16:27:59,950 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.18/0.18, [MB5] 1.00/1.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank1]:2025-12-28 16:27:59,929 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.24/0.24, [MB2] 0.25/0.25, [MB3] 0.00/0.00, [MB4] 0.48/0.48, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 16:27:59,944 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 16:28:03,566 - Avg. fwd time: 10.7897 / Avg. bwd time: 35.6619 / Avg. batch time: 431.2240 (ms) / GPU bubble ratio: 13.82%
[rank2]:2025-12-28 16:28:03,602 - Avg. fwd time: 6.9717 / Avg. bwd time: 18.3973 / Avg. batch time: 463.1136 (ms) / GPU bubble ratio: 56.18%
[rank0]:2025-12-28 16:28:03,627 - Avg. fwd time: 8.2384 / Avg. bwd time: 20.5006 / Avg. batch time: 522.0254 (ms) / GPU bubble ratio: 55.96%
[rank1]:2025-12-28 16:28:03,620 - Avg. fwd time: 9.1053 / Avg. bwd time: 21.2663 / Avg. batch time: 495.3781 (ms) / GPU bubble ratio: 50.95%
[rank1]:2025-12-28 16:28:03,653 -  step: 250  loss: -8.0000  grad_norm:  0.5220  memory: 16.40GiB(34.52%)  tps: 8,809  tflops: 68.86  mfu: 22.07%
[rank3]:2025-12-28 16:28:03,662 -  step: 250  loss:  0.3981  grad_norm:  0.5220  memory: 29.36GiB(61.81%)  tps: 8,809  tflops: 68.86  mfu: 22.07%
[rank2]:2025-12-28 16:28:03,649 -  step: 250  loss: -8.0000  grad_norm:  0.5220  memory: 13.15GiB(27.69%)  tps: 8,809  tflops: 68.86  mfu: 22.07%
[rank0]:2025-12-28 16:28:03,663 -  step: 250  loss: -8.0000  grad_norm:  0.5220  memory: 19.07GiB(40.15%)  tps: 8,809  tflops: 68.86  mfu: 22.07%
[rank2]:2025-12-28 16:29:36,227 - Avg. fwd time: 6.9699 / Avg. bwd time: 18.4103 / Avg. batch time: 457.6289 (ms) / GPU bubble ratio: 55.63%
[rank0]:2025-12-28 16:29:36,255 - Avg. fwd time: 8.2381 / Avg. bwd time: 20.1941 / Avg. batch time: 514.9894 (ms) / GPU bubble ratio: 55.83%
[rank3]:2025-12-28 16:29:36,189 - Avg. fwd time: 10.7805 / Avg. bwd time: 34.8330 / Avg. batch time: 424.5101 (ms) / GPU bubble ratio: 14.04%
[rank1]:2025-12-28 16:29:36,246 - Avg. fwd time: 9.1087 / Avg. bwd time: 21.0950 / Avg. batch time: 489.5816 (ms) / GPU bubble ratio: 50.65%
[rank2]:2025-12-28 16:31:05,455 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank0]:2025-12-28 16:31:05,429 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 16:31:05,486 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.18/0.18, [MB5] 1.00/1.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank1]:2025-12-28 16:31:05,465 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.24/0.24, [MB2] 0.25/0.25, [MB3] 0.00/0.00, [MB4] 0.48/0.48, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 16:31:05,478 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 16:31:09,085 - Avg. fwd time: 10.7734 / Avg. bwd time: 34.1402 / Avg. batch time: 418.9057 (ms) / GPU bubble ratio: 14.23%
[rank2]:2025-12-28 16:31:09,122 - Avg. fwd time: 6.9678 / Avg. bwd time: 18.4186 / Avg. batch time: 453.0308 (ms) / GPU bubble ratio: 55.17%
[rank2]:2025-12-28 16:31:09,170 -  step: 300  loss: -8.0000  grad_norm:  0.1854  memory: 13.15GiB(27.69%)  tps: 8,831  tflops: 69.04  mfu: 22.13%
[rank0]:2025-12-28 16:31:09,148 - Avg. fwd time: 8.2363 / Avg. bwd time: 19.9610 / Avg. batch time: 509.2166 (ms) / GPU bubble ratio: 55.70%
[rank0]:2025-12-28 16:31:09,185 -  step: 300  loss: -8.0000  grad_norm:  0.1854  memory: 19.09GiB(40.19%)  tps: 8,831  tflops: 69.04  mfu: 22.13%
[rank1]:2025-12-28 16:31:09,141 - Avg. fwd time: 9.1102 / Avg. bwd time: 20.9392 / Avg. batch time: 484.7108 (ms) / GPU bubble ratio: 50.40%
[rank1]:2025-12-28 16:31:09,174 -  step: 300  loss: -8.0000  grad_norm:  0.1854  memory: 16.40GiB(34.52%)  tps: 8,831  tflops: 69.04  mfu: 22.13%
[rank3]:2025-12-28 16:31:09,184 -  step: 300  loss:  0.2829  grad_norm:  0.1854  memory: 29.36GiB(61.81%)  tps: 8,831  tflops: 69.04  mfu: 22.13%
[rank2]:2025-12-28 16:31:09,236 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1631_stage2_step300.svg
[rank0]:2025-12-28 16:31:09,236 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1631_stage0_step300.svg
[rank1]:2025-12-28 16:31:09,235 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1631_stage1_step300.svg
[rank0]:2025-12-28 16:31:09,395 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1631_rank0_stage0.svg
[rank0]:	> Counts Sum: 167600, Total Sum: 544640 (30.77%), Ratio(%) per element: [34.23, 33.69, 32.6, 34.78, 32.06, 33.15, 34.23, 34.78, 19.56, 16.84, 30.97, 35.86, 36.41, 34.78, 33.69, 31.52, 35.32, 17.93, 22.82, 34.78, 34.78, 32.6, 35.32, 33.69, 33.69, 35.32, 17.93, 17.93, 31.52, 33.69, 36.41, 34.78, 32.6, 33.69, 34.23, 18.47, 21.73]
[rank1]:2025-12-28 16:31:09,382 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1631_rank1_stage1.svg
[rank1]:	> Counts Sum: 234400, Total Sum: 662400 (35.39%), Ratio(%) per element: [39.67, 35.86, 40.21, 38.58, 44.56, 44.02, 37.5, 18.47, 19.56, 42.39, 38.04, 37.5, 41.84, 40.76, 36.95, 37.5, 19.02, 19.56, 38.04, 41.3, 36.95, 41.3, 44.02, 39.67, 42.39, 19.56, 17.39, 39.13, 40.76, 35.32, 35.86, 39.67, 39.13, 42.39, 20.1, 21.73, 40.76, 37.5, 42.93, 41.84, 42.93, 42.93, 39.13, 19.56, 17.93]
[rank3]:2025-12-28 16:31:09,322 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1631_step300_rank3.svg
[rank3]:			> Batch Time: 449.00 ms, GPU Bubble Ratio: 53.49%, 50.00%, 54.62%, 33.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  273-25-299ms   | [S0,MB1,B]  306-25-331ms   | [S0,MB2,B]  333-25-359ms   | [S0,MB3,B]  362-25-388ms   | [S0,MB4,B]  389-23-413ms   | [S0,MB5,B]  415-0-415ms    | [S0,MB6,B]  429-17-446ms   | [S0,MB7,B]  449-0-449ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  128-8-137ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  283-19-302ms   | [S1,MB2,B]  309-21-330ms   | [S1,MB3,B]  333-25-359ms   | [S1,MB4,B]  362-16-378ms   | [S1,MB5,B]  389-21-410ms   | [S1,MB6,B]  415-11-426ms   | [S1,MB7,B]  430-11-441ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  222-19-241ms   | [S2,MB1,B]  260-19-279ms   | [S2,MB2,B]  286-19-306ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  333-20-353ms   | [S2,MB5,B]  362-20-382ms   | [S2,MB6,B]  389-19-408ms   | [S2,MB7,B]  414-8-423ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-37-253ms   | [S3,MB2,B]  253-22-275ms   | [S3,MB3,B]  276-21-298ms   | [S3,MB4,B]  298-22-320ms   | [S3,MB5,B]  320-22-342ms   | [S3,MB6,B]  342-22-365ms   | [S3,MB7,B]  365-22-387ms  
[rank3]:2025-12-28 16:31:09,364 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1631_stage3_step300.svg
[rank2]:2025-12-28 16:31:09,396 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1631_rank2_stage2.svg
[rank2]:	> Counts Sum: 75200, Total Sum: 529920 (14.19%), Ratio(%) per element: [15.21, 15.21, 14.67, 15.76, 15.76, 15.21, 14.13, 11.95, 11.95, 14.13, 14.13, 13.58, 15.76, 14.67, 16.3, 14.13, 10.86, 13.04, 14.67, 14.13, 13.58, 15.21, 14.67, 16.3, 15.21, 11.41, 11.41, 14.67, 15.21, 14.67, 15.21, 15.21, 15.21, 14.67, 11.95, 10.86]
[rank3]:2025-12-28 16:31:09,495 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1631_rank3_stage3.svg
[rank3]:	> Counts Sum: 279440, Total Sum: 426880 (65.46%), Ratio(%) per element: [77.71, 72.82, 73.36, 71.19, 73.91, 71.19, 73.36, 45.65, 45.1, 74.45, 77.71, 73.36, 71.19, 76.08, 72.82, 75.54, 42.93, 46.73, 76.63, 72.28, 70.65, 71.19, 69.56, 66.84, 75.0, 47.82, 44.02, 44.56, 44.56]
[rank1]:2025-12-28 16:31:09,975 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1631_stage1.svg
[rank2]:2025-12-28 16:31:09,998 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1631_stage2.svg
[rank0]:2025-12-28 16:31:10,002 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1631_stage0.svg
[rank3]:2025-12-28 16:31:10,091 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1631_stage3.svg
[rank3]:2025-12-28 16:32:42,016 - Avg. fwd time: 10.7676 / Avg. bwd time: 33.5289 / Avg. batch time: 413.9656 (ms) / GPU bubble ratio: 14.40%
[rank0]:2025-12-28 16:32:42,080 - Avg. fwd time: 8.2355 / Avg. bwd time: 19.7221 / Avg. batch time: 504.0657 (ms) / GPU bubble ratio: 55.63%
[rank2]:2025-12-28 16:32:42,053 - Avg. fwd time: 6.9665 / Avg. bwd time: 18.4266 / Avg. batch time: 448.9923 (ms) / GPU bubble ratio: 54.76%
[rank1]:2025-12-28 16:32:42,072 - Avg. fwd time: 9.1115 / Avg. bwd time: 20.7950 / Avg. batch time: 480.4382 (ms) / GPU bubble ratio: 50.20%
[rank0]:2025-12-28 16:34:10,914 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 16:34:14,627 - Avg. fwd time: 10.7632 / Avg. bwd time: 33.0128 / Avg. batch time: 409.7994 (ms) / GPU bubble ratio: 14.54%
[rank0]:2025-12-28 16:34:14,690 - Avg. fwd time: 8.2350 / Avg. bwd time: 19.5081 / Avg. batch time: 499.8024 (ms) / GPU bubble ratio: 55.59%
[rank0]:2025-12-28 16:34:14,726 -  step: 350  loss: -8.0000  grad_norm:  0.0948  memory: 19.09GiB(40.19%)  tps: 8,830  tflops: 69.03  mfu: 22.13%
[rank2]:2025-12-28 16:34:14,662 - Avg. fwd time: 6.9658 / Avg. bwd time: 18.4336 / Avg. batch time: 445.6702 (ms) / GPU bubble ratio: 54.41%
[rank2]:2025-12-28 16:34:14,711 -  step: 350  loss: -8.0000  grad_norm:  0.0948  memory: 13.15GiB(27.69%)  tps: 8,830  tflops: 69.03  mfu: 22.13%
[rank1]:2025-12-28 16:34:14,682 - Avg. fwd time: 9.1132 / Avg. bwd time: 20.6907 / Avg. batch time: 476.9188 (ms) / GPU bubble ratio: 50.01%
[rank1]:2025-12-28 16:34:14,715 -  step: 350  loss: -8.0000  grad_norm:  0.0948  memory: 16.40GiB(34.52%)  tps: 8,830  tflops: 69.03  mfu: 22.13%
[rank3]:2025-12-28 16:34:14,725 -  step: 350  loss:  0.2254  grad_norm:  0.0948  memory: 29.36GiB(61.81%)  tps: 8,831  tflops: 69.03  mfu: 22.13%
[rank3]:2025-12-28 16:35:47,384 - Avg. fwd time: 10.7596 / Avg. bwd time: 32.5507 / Avg. batch time: 406.0735 (ms) / GPU bubble ratio: 14.68%
[rank2]:2025-12-28 16:35:47,427 - Avg. fwd time: 6.9644 / Avg. bwd time: 18.4389 / Avg. batch time: 442.6835 (ms) / GPU bubble ratio: 54.09%
[rank0]:2025-12-28 16:35:47,455 - Avg. fwd time: 8.2329 / Avg. bwd time: 19.3763 / Avg. batch time: 496.1538 (ms) / GPU bubble ratio: 55.48%
[rank1]:2025-12-28 16:35:47,447 - Avg. fwd time: 9.1126 / Avg. bwd time: 20.5770 / Avg. batch time: 473.7461 (ms) / GPU bubble ratio: 49.86%
[rank0]:2025-12-28 16:37:15,973 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:37:19,690 - Avg. fwd time: 10.7550 / Avg. bwd time: 32.1495 / Avg. batch time: 402.8200 (ms) / GPU bubble ratio: 14.79%
[rank2]:2025-12-28 16:37:19,728 - Avg. fwd time: 6.9636 / Avg. bwd time: 18.4444 / Avg. batch time: 439.9783 (ms) / GPU bubble ratio: 53.80%
[rank2]:2025-12-28 16:37:19,779 -  step: 400  loss: -8.0000  grad_norm:  0.1104  memory: 13.15GiB(27.69%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank0]:2025-12-28 16:37:19,757 - Avg. fwd time: 8.2315 / Avg. bwd time: 19.2275 / Avg. batch time: 492.8260 (ms) / GPU bubble ratio: 55.43%
[rank3]:2025-12-28 16:37:19,791 -  step: 400  loss:  0.2122  grad_norm:  0.1104  memory: 29.36GiB(61.81%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank1]:2025-12-28 16:37:19,748 - Avg. fwd time: 9.1126 / Avg. bwd time: 20.4828 / Avg. batch time: 470.8882 (ms) / GPU bubble ratio: 49.72%
[rank1]:2025-12-28 16:37:19,782 -  step: 400  loss: -8.0000  grad_norm:  0.1104  memory: 16.40GiB(34.52%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank2]:2025-12-28 16:37:19,845 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1637_stage2_step400.svg
[rank0]:2025-12-28 16:37:19,793 -  step: 400  loss: -8.0000  grad_norm:  0.1104  memory: 19.09GiB(40.19%)  tps: 8,853  tflops: 69.21  mfu: 22.18%
[rank0]:2025-12-28 16:37:19,845 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1637_stage0_step400.svg
[rank1]:2025-12-28 16:37:19,844 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1637_stage1_step400.svg
[rank3]:2025-12-28 16:37:19,930 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1637_step400_rank3.svg
[rank3]:			> Batch Time: 445.25 ms, GPU Bubble Ratio: 54.71%, 48.92%, 54.15%, 33.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  305-25-330ms   | [S0,MB2,B]  332-25-357ms   | [S0,MB3,B]  361-25-387ms   | [S0,MB4,B]  389-17-406ms   | [S0,MB5,B]  413-0-413ms    | [S0,MB6,B]  427-16-443ms   | [S0,MB7,B]  445-0-445ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  280-21-301ms   | [S1,MB2,B]  305-20-326ms   | [S1,MB3,B]  331-26-357ms   | [S1,MB4,B]  361-17-378ms   | [S1,MB5,B]  388-20-409ms   | [S1,MB6,B]  412-11-424ms   | [S1,MB7,B]  427-11-438ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  257-19-276ms   | [S2,MB2,B]  282-19-302ms   | [S2,MB3,B]  305-20-325ms   | [S2,MB4,B]  331-20-351ms   | [S2,MB5,B]  361-20-381ms   | [S2,MB6,B]  388-20-408ms   | [S2,MB7,B]  412-8-421ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-36-250ms   | [S3,MB2,B]  250-22-272ms   | [S3,MB3,B]  272-21-294ms   | [S3,MB4,B]  294-22-316ms   | [S3,MB5,B]  316-22-338ms   | [S3,MB6,B]  339-22-361ms   | [S3,MB7,B]  361-21-383ms  
[rank3]:2025-12-28 16:37:19,977 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1637_stage3_step400.svg
[rank1]:2025-12-28 16:37:19,990 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1637_rank1_stage1.svg
[rank1]:	> Counts Sum: 351200, Total Sum: 950400 (36.95%), Ratio(%) per element: [40.53, 39.01, 40.53, 40.9, 44.69, 44.31, 38.63, 20.45, 21.21, 42.04, 37.87, 39.01, 42.04, 43.56, 39.39, 41.28, 21.21, 21.21, 39.39, 40.9, 39.77, 42.04, 43.18, 42.8, 43.93, 21.21, 22.34, 40.15, 42.8, 39.39, 37.87, 41.28, 40.9, 45.45, 21.59, 24.24, 42.42, 37.87, 41.28, 41.66, 43.56, 43.93, 43.56, 21.21, 20.07]
[rank2]:2025-12-28 16:37:19,998 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1637_rank2_stage2.svg
[rank2]:	> Counts Sum: 104800, Total Sum: 760320 (13.78%), Ratio(%) per element: [14.39, 14.39, 14.01, 14.77, 14.77, 14.39, 14.01, 12.12, 12.12, 14.01, 13.63, 13.63, 15.15, 14.01, 15.15, 14.39, 11.36, 12.87, 14.01, 14.01, 13.63, 14.39, 14.01, 15.15, 14.39, 11.74, 11.74, 14.39, 14.39, 14.01, 14.39, 14.39, 14.39, 14.39, 12.12, 11.36]
[rank0]:2025-12-28 16:37:19,998 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1637_rank0_stage0.svg
[rank0]:	> Counts Sum: 249200, Total Sum: 781440 (31.89%), Ratio(%) per element: [35.98, 33.71, 33.33, 36.36, 33.71, 33.71, 34.46, 35.98, 21.21, 19.31, 31.43, 34.46, 37.12, 37.12, 33.71, 32.95, 37.5, 20.07, 25.0, 35.98, 35.6, 33.71, 34.84, 34.84, 34.46, 36.74, 20.07, 20.83, 33.33, 34.09, 36.74, 34.84, 33.33, 34.84, 34.46, 20.45, 23.48]
[rank3]:2025-12-28 16:37:20,107 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1637_rank3_stage3.svg
[rank3]:	> Counts Sum: 428240, Total Sum: 612480 (69.92%), Ratio(%) per element: [79.54, 75.37, 76.89, 74.24, 76.51, 74.24, 75.75, 54.54, 54.16, 78.03, 78.4, 75.75, 73.86, 78.03, 74.62, 77.65, 52.65, 55.3, 78.03, 75.0, 75.0, 73.86, 74.24, 71.21, 76.51, 56.43, 53.4, 53.78, 54.54]
[rank2]:2025-12-28 16:37:20,836 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1637_stage2.svg
[rank0]:2025-12-28 16:37:20,832 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1637_stage0.svg
[rank1]:2025-12-28 16:37:20,829 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1637_stage1.svg
[rank3]:2025-12-28 16:37:20,941 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1637_stage3.svg
[rank3]:2025-12-28 16:37:42,135 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 16:37:42,342 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 16:37:42,361 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 16:37:42,358 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-28 16:38:53,721 - Avg. fwd time: 10.7520 / Avg. bwd time: 31.8135 / Avg. batch time: 400.1075 (ms) / GPU bubble ratio: 14.89%
[rank2]:2025-12-28 16:38:53,757 - Avg. fwd time: 6.9624 / Avg. bwd time: 18.4441 / Avg. batch time: 437.8467 (ms) / GPU bubble ratio: 53.58%
[rank0]:2025-12-28 16:38:53,786 - Avg. fwd time: 8.2300 / Avg. bwd time: 19.1261 / Avg. batch time: 490.1466 (ms) / GPU bubble ratio: 55.35%
[rank1]:2025-12-28 16:38:53,778 - Avg. fwd time: 9.1124 / Avg. bwd time: 20.4182 / Avg. batch time: 468.6245 (ms) / GPU bubble ratio: 49.59%
[rank0]:2025-12-28 16:40:22,938 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 16:40:26,616 - Avg. fwd time: 10.7500 / Avg. bwd time: 31.5195 / Avg. batch time: 397.7419 (ms) / GPU bubble ratio: 14.98%
[rank2]:2025-12-28 16:40:26,652 - Avg. fwd time: 6.9612 / Avg. bwd time: 18.4451 / Avg. batch time: 435.8470 (ms) / GPU bubble ratio: 53.37%
[rank2]:2025-12-28 16:40:26,704 -  step: 450  loss: -8.0000  grad_norm:  0.0979  memory: 13.15GiB(27.69%)  tps: 8,765  tflops: 68.52  mfu: 21.96%
[rank0]:2025-12-28 16:40:26,683 - Avg. fwd time: 8.2283 / Avg. bwd time: 19.0266 / Avg. batch time: 487.7147 (ms) / GPU bubble ratio: 55.29%
[rank0]:2025-12-28 16:40:26,719 -  step: 450  loss: -8.0000  grad_norm:  0.0979  memory: 19.09GiB(40.19%)  tps: 8,765  tflops: 68.52  mfu: 21.96%
[rank1]:2025-12-28 16:40:26,674 - Avg. fwd time: 9.1113 / Avg. bwd time: 20.3538 / Avg. batch time: 466.5080 (ms) / GPU bubble ratio: 49.47%
[rank1]:2025-12-28 16:40:26,709 -  step: 450  loss: -8.0000  grad_norm:  0.0979  memory: 16.40GiB(34.52%)  tps: 8,765  tflops: 68.52  mfu: 21.96%
[rank3]:2025-12-28 16:40:26,717 -  step: 450  loss:  0.2238  grad_norm:  0.0979  memory: 29.36GiB(61.81%)  tps: 8,765  tflops: 68.52  mfu: 21.96%
[rank3]:2025-12-28 16:41:59,968 - Avg. fwd time: 10.7491 / Avg. bwd time: 31.2619 / Avg. batch time: 395.6746 (ms) / GPU bubble ratio: 15.06%
[rank2]:2025-12-28 16:42:00,005 - Avg. fwd time: 6.9603 / Avg. bwd time: 18.4459 / Avg. batch time: 434.1967 (ms) / GPU bubble ratio: 53.19%
[rank0]:2025-12-28 16:42:00,036 - Avg. fwd time: 8.2273 / Avg. bwd time: 18.9427 / Avg. batch time: 485.6352 (ms) / GPU bubble ratio: 55.24%
[rank1]:2025-12-28 16:42:00,026 - Avg. fwd time: 9.1111 / Avg. bwd time: 20.3156 / Avg. batch time: 464.7558 (ms) / GPU bubble ratio: 49.35%
[rank0]:2025-12-28 16:43:29,104 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:43:32,787 - Avg. fwd time: 10.7468 / Avg. bwd time: 31.0276 / Avg. batch time: 393.7822 (ms) / GPU bubble ratio: 15.13%
[rank2]:2025-12-28 16:43:32,824 - Avg. fwd time: 6.9597 / Avg. bwd time: 18.4448 / Avg. batch time: 432.6419 (ms) / GPU bubble ratio: 53.02%
[rank0]:2025-12-28 16:43:32,855 - Avg. fwd time: 8.2277 / Avg. bwd time: 18.8616 / Avg. batch time: 483.6222 (ms) / GPU bubble ratio: 55.19%
[rank1]:2025-12-28 16:43:32,845 - Avg. fwd time: 9.1116 / Avg. bwd time: 20.2688 / Avg. batch time: 463.1063 (ms) / GPU bubble ratio: 49.25%
[rank1]:2025-12-28 16:43:32,881 -  step: 500  loss: -8.0000  grad_norm:  0.1002  memory: 16.40GiB(34.52%)  tps: 8,800  tflops: 68.80  mfu: 22.05%
[rank3]:2025-12-28 16:43:32,890 -  step: 500  loss:  0.2162  grad_norm:  0.1002  memory: 29.36GiB(61.81%)  tps: 8,801  tflops: 68.80  mfu: 22.05%
[rank2]:2025-12-28 16:43:32,877 -  step: 500  loss: -8.0000  grad_norm:  0.1002  memory: 13.15GiB(27.69%)  tps: 8,800  tflops: 68.80  mfu: 22.05%
[rank2]:2025-12-28 16:43:32,939 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1643_stage2_step500.svg
[rank0]:2025-12-28 16:43:32,891 -  step: 500  loss: -8.0000  grad_norm:  0.1002  memory: 19.09GiB(40.19%)  tps: 8,800  tflops: 68.80  mfu: 22.05%
[rank0]:2025-12-28 16:43:32,938 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1643_stage0_step500.svg
[rank1]:2025-12-28 16:43:32,940 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1643_stage1_step500.svg
[rank1]:2025-12-28 16:43:33,093 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1643_rank1_stage1.svg
[rank1]:	> Counts Sum: 468000, Total Sum: 1238400 (37.79%), Ratio(%) per element: [42.44, 38.66, 41.27, 42.44, 44.47, 44.76, 39.53, 21.51, 23.83, 41.27, 39.82, 39.53, 41.27, 42.44, 40.11, 41.27, 22.09, 25.29, 39.24, 41.86, 40.98, 43.31, 44.18, 43.02, 44.76, 22.09, 22.96, 41.56, 44.76, 41.56, 39.24, 40.98, 41.86, 44.18, 22.67, 24.7, 43.02, 39.82, 42.73, 41.56, 43.02, 45.93, 45.05, 22.09, 21.22]
[rank3]:2025-12-28 16:43:33,031 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1643_step500_rank3.svg
[rank3]:			> Batch Time: 446.25 ms, GPU Bubble Ratio: 53.94%, 48.66%, 54.45%, 32.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  271-25-297ms   | [S0,MB1,B]  306-25-331ms   | [S0,MB2,B]  333-25-359ms   | [S0,MB3,B]  362-25-388ms   | [S0,MB4,B]  390-23-413ms   | [S0,MB5,B]  416-0-416ms    | [S0,MB6,B]  430-14-444ms   | [S0,MB7,B]  446-0-446ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-8-32ms      | [S1,MB2,F]  36-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  282-20-303ms   | [S1,MB2,B]  307-20-328ms   | [S1,MB3,B]  333-25-359ms   | [S1,MB4,B]  362-17-380ms   | [S1,MB5,B]  389-22-412ms   | [S1,MB6,B]  415-11-427ms   | [S1,MB7,B]  430-11-442ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  259-19-278ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  333-20-353ms   | [S2,MB5,B]  362-20-382ms   | [S2,MB6,B]  389-19-408ms   | [S2,MB7,B]  415-8-424ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-37-251ms   | [S3,MB2,B]  252-23-276ms   | [S3,MB3,B]  275-22-297ms   | [S3,MB4,B]  297-22-320ms   | [S3,MB5,B]  320-22-343ms   | [S3,MB6,B]  342-22-365ms   | [S3,MB7,B]  365-22-388ms  
[rank3]:2025-12-28 16:43:33,076 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1643_stage3_step500.svg
[rank2]:2025-12-28 16:43:33,092 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1643_rank2_stage2.svg
[rank2]:	> Counts Sum: 134400, Total Sum: 990720 (13.57%), Ratio(%) per element: [13.95, 13.95, 13.95, 14.24, 14.82, 14.24, 13.66, 12.2, 12.2, 13.95, 13.37, 13.37, 14.53, 13.66, 14.53, 14.24, 11.62, 12.79, 13.66, 13.66, 13.37, 13.95, 13.66, 14.82, 14.24, 11.91, 11.91, 14.24, 14.24, 13.66, 13.95, 13.95, 13.95, 13.95, 12.2, 11.62]
[rank0]:2025-12-28 16:43:33,093 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1643_rank0_stage0.svg
[rank0]:	> Counts Sum: 330800, Total Sum: 1018240 (32.49%), Ratio(%) per element: [35.17, 34.3, 35.17, 36.04, 34.88, 35.46, 35.75, 36.33, 22.09, 20.63, 32.26, 34.88, 36.91, 37.5, 34.88, 33.72, 37.5, 21.22, 25.29, 37.79, 35.75, 35.17, 35.17, 35.46, 34.59, 36.04, 21.22, 21.8, 34.01, 34.3, 36.91, 36.04, 33.43, 34.59, 33.72, 21.51, 24.41]
[rank3]:2025-12-28 16:43:33,211 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1643_rank3_stage3.svg
[rank3]:	> Counts Sum: 577040, Total Sum: 798080 (72.30%), Ratio(%) per element: [80.52, 76.16, 77.03, 76.45, 77.9, 76.16, 77.9, 59.3, 59.01, 79.06, 79.94, 77.61, 76.45, 78.48, 76.74, 78.19, 57.84, 59.88, 78.77, 76.45, 77.03, 75.87, 76.45, 73.54, 76.74, 60.75, 58.43, 58.72, 59.3]
[rank1]:2025-12-28 16:43:34,197 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1643_stage1.svg
[rank2]:2025-12-28 16:43:34,205 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1643_stage2.svg
[rank0]:2025-12-28 16:43:34,195 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1643_stage0.svg
[rank3]:2025-12-28 16:43:34,304 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1643_stage3.svg
[rank3]:2025-12-28 16:45:06,932 - Avg. fwd time: 10.7437 / Avg. bwd time: 30.8008 / Avg. batch time: 391.9407 (ms) / GPU bubble ratio: 15.20%
[rank2]:2025-12-28 16:45:06,974 - Avg. fwd time: 6.9592 / Avg. bwd time: 18.4459 / Avg. batch time: 431.2245 (ms) / GPU bubble ratio: 52.87%
[rank0]:2025-12-28 16:45:07,005 - Avg. fwd time: 8.2270 / Avg. bwd time: 18.7830 / Avg. batch time: 481.8388 (ms) / GPU bubble ratio: 55.16%
[rank1]:2025-12-28 16:45:06,995 - Avg. fwd time: 9.1117 / Avg. bwd time: 20.2390 / Avg. batch time: 461.6050 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-12-28 16:46:35,727 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 16:46:39,412 - Avg. fwd time: 10.7404 / Avg. bwd time: 30.6063 / Avg. batch time: 390.3546 (ms) / GPU bubble ratio: 15.26%
[rank2]:2025-12-28 16:46:39,449 - Avg. fwd time: 6.9589 / Avg. bwd time: 18.4461 / Avg. batch time: 429.9056 (ms) / GPU bubble ratio: 52.72%
[rank1]:2025-12-28 16:46:39,471 - Avg. fwd time: 9.1123 / Avg. bwd time: 20.1876 / Avg. batch time: 460.2050 (ms) / GPU bubble ratio: 49.07%
[rank1]:2025-12-28 16:46:39,507 -  step: 550  loss: -8.0000  grad_norm:  0.0901  memory: 16.40GiB(34.52%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank0]:2025-12-28 16:46:39,481 - Avg. fwd time: 8.2265 / Avg. bwd time: 18.7104 / Avg. batch time: 480.1119 (ms) / GPU bubble ratio: 55.12%
[rank0]:2025-12-28 16:46:39,517 -  step: 550  loss: -8.0000  grad_norm:  0.0901  memory: 19.09GiB(40.19%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank3]:2025-12-28 16:46:39,516 -  step: 550  loss:  0.2241  grad_norm:  0.0901  memory: 29.36GiB(61.81%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank2]:2025-12-28 16:46:39,503 -  step: 550  loss: -8.0000  grad_norm:  0.0901  memory: 13.15GiB(27.69%)  tps: 8,779  tflops: 68.63  mfu: 22.00%
[rank3]:2025-12-28 16:48:12,357 - Avg. fwd time: 10.7391 / Avg. bwd time: 30.4219 / Avg. batch time: 388.8680 (ms) / GPU bubble ratio: 15.32%
[rank2]:2025-12-28 16:48:12,393 - Avg. fwd time: 6.9585 / Avg. bwd time: 18.4451 / Avg. batch time: 428.7517 (ms) / GPU bubble ratio: 52.60%
[rank0]:2025-12-28 16:48:12,426 - Avg. fwd time: 8.2262 / Avg. bwd time: 18.6402 / Avg. batch time: 478.6287 (ms) / GPU bubble ratio: 55.09%
[rank1]:2025-12-28 16:48:12,415 - Avg. fwd time: 9.1125 / Avg. bwd time: 20.1582 / Avg. batch time: 458.9795 (ms) / GPU bubble ratio: 48.98%
[rank0]:2025-12-28 16:49:41,287 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:49:44,972 - Avg. fwd time: 10.7362 / Avg. bwd time: 30.2565 / Avg. batch time: 387.5193 (ms) / GPU bubble ratio: 15.37%
[rank2]:2025-12-28 16:49:45,006 - Avg. fwd time: 6.9582 / Avg. bwd time: 18.4457 / Avg. batch time: 427.6414 (ms) / GPU bubble ratio: 52.48%
[rank1]:2025-12-28 16:49:45,029 - Avg. fwd time: 9.1133 / Avg. bwd time: 20.1268 / Avg. batch time: 457.8042 (ms) / GPU bubble ratio: 48.90%
[rank1]:2025-12-28 16:49:45,065 -  step: 600  loss: -8.0000  grad_norm:  0.1044  memory: 16.40GiB(34.52%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank0]:2025-12-28 16:49:45,040 - Avg. fwd time: 8.2260 / Avg. bwd time: 18.5778 / Avg. batch time: 477.2007 (ms) / GPU bubble ratio: 55.06%
[rank0]:2025-12-28 16:49:45,076 -  step: 600  loss: -8.0000  grad_norm:  0.1044  memory: 19.09GiB(40.19%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank3]:2025-12-28 16:49:45,074 -  step: 600  loss:  0.2188  grad_norm:  0.1044  memory: 29.36GiB(61.81%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank2]:2025-12-28 16:49:45,062 -  step: 600  loss: -8.0000  grad_norm:  0.1044  memory: 13.15GiB(27.69%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank2]:2025-12-28 16:49:45,127 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1649_stage2_step600.svg
[rank1]:2025-12-28 16:49:45,125 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1649_stage1_step600.svg
[rank0]:2025-12-28 16:49:45,127 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1649_stage0_step600.svg
[rank3]:2025-12-28 16:49:45,212 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1649_step600_rank3.svg
[rank3]:			> Batch Time: 444.00 ms, GPU Bubble Ratio: 54.30%, 48.71%, 54.14%, 32.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  306-25-331ms   | [S0,MB2,B]  333-25-358ms   | [S0,MB3,B]  362-25-388ms   | [S0,MB4,B]  389-22-411ms   | [S0,MB5,B]  414-0-414ms    | [S0,MB6,B]  429-12-441ms   | [S0,MB7,B]  444-0-444ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  282-20-302ms   | [S1,MB2,B]  307-20-327ms   | [S1,MB3,B]  332-26-358ms   | [S1,MB4,B]  361-17-379ms   | [S1,MB5,B]  389-21-410ms   | [S1,MB6,B]  414-11-425ms   | [S1,MB7,B]  428-11-440ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  284-19-303ms   | [S2,MB3,B]  307-20-327ms   | [S2,MB4,B]  332-20-352ms   | [S2,MB5,B]  362-20-382ms   | [S2,MB6,B]  389-20-409ms   | [S2,MB7,B]  414-8-423ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  251-23-275ms   | [S3,MB3,B]  275-21-296ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-341ms   | [S3,MB6,B]  341-22-364ms   | [S3,MB7,B]  364-22-386ms  
[rank1]:2025-12-28 16:49:45,274 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1649_rank1_stage1.svg
[rank1]:	> Counts Sum: 584800, Total Sum: 1526400 (38.31%), Ratio(%) per element: [41.98, 40.33, 41.27, 42.45, 44.57, 45.99, 40.56, 22.16, 24.76, 41.98, 40.56, 41.03, 42.45, 42.45, 39.85, 41.27, 22.64, 25.47, 41.03, 42.68, 42.45, 43.39, 43.39, 42.68, 45.99, 22.64, 23.34, 41.98, 45.51, 41.5, 40.33, 41.74, 42.21, 44.33, 23.11, 24.76, 43.86, 39.85, 42.68, 43.86, 43.86, 44.81, 44.1, 22.87, 23.11]
[rank0]:2025-12-28 16:49:45,281 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1649_rank0_stage0.svg
[rank0]:	> Counts Sum: 412400, Total Sum: 1255040 (32.86%), Ratio(%) per element: [35.61, 35.84, 35.84, 36.55, 35.84, 35.61, 36.08, 36.08, 22.64, 21.69, 32.31, 34.66, 36.55, 37.02, 34.19, 34.19, 37.02, 21.93, 25.23, 38.2, 36.08, 34.9, 36.08, 36.32, 35.14, 36.08, 21.93, 22.4, 34.66, 35.84, 37.02, 36.08, 33.96, 35.14, 34.19, 22.16, 24.52]
[rank3]:2025-12-28 16:49:45,257 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1649_stage3_step600.svg
[rank2]:2025-12-28 16:49:45,279 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1649_rank2_stage2.svg
[rank2]:	> Counts Sum: 164000, Total Sum: 1221120 (13.43%), Ratio(%) per element: [13.67, 13.67, 13.67, 14.15, 14.38, 13.91, 13.44, 12.26, 12.26, 13.67, 13.44, 13.2, 14.38, 13.44, 14.15, 13.91, 11.79, 12.73, 13.44, 13.44, 13.2, 13.67, 13.67, 14.38, 13.91, 12.02, 12.02, 14.38, 13.91, 13.67, 13.67, 13.91, 13.67, 14.15, 12.26, 11.79]
[rank3]:2025-12-28 16:49:45,390 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1649_rank3_stage3.svg
[rank3]:	> Counts Sum: 725840, Total Sum: 983680 (73.79%), Ratio(%) per element: [80.89, 76.65, 78.3, 78.06, 78.53, 77.12, 79.0, 62.26, 62.02, 79.48, 80.42, 78.06, 77.83, 78.77, 77.35, 79.0, 61.08, 62.73, 79.0, 77.83, 77.83, 77.35, 78.06, 75.0, 78.06, 63.44, 61.55, 61.79, 62.26]
[rank1]:2025-12-28 16:49:46,614 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1649_stage1.svg
[rank0]:2025-12-28 16:49:46,644 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1649_stage0.svg
[rank2]:2025-12-28 16:49:46,659 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1649_stage2.svg
[rank3]:2025-12-28 16:49:46,724 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1649_stage3.svg
[rank3]:2025-12-28 16:51:18,880 - Avg. fwd time: 10.7331 / Avg. bwd time: 30.1009 / Avg. batch time: 386.2456 (ms) / GPU bubble ratio: 15.42%
[rank2]:2025-12-28 16:51:18,918 - Avg. fwd time: 6.9581 / Avg. bwd time: 18.4451 / Avg. batch time: 426.5865 (ms) / GPU bubble ratio: 52.36%
[rank0]:2025-12-28 16:51:18,952 - Avg. fwd time: 8.2260 / Avg. bwd time: 18.5026 / Avg. batch time: 475.8514 (ms) / GPU bubble ratio: 55.06%
[rank1]:2025-12-28 16:51:18,941 - Avg. fwd time: 9.1137 / Avg. bwd time: 20.0780 / Avg. batch time: 456.6799 (ms) / GPU bubble ratio: 48.86%
[rank0]:2025-12-28 16:52:47,862 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 16:52:51,552 - Avg. fwd time: 10.7318 / Avg. bwd time: 29.9616 / Avg. batch time: 385.1196 (ms) / GPU bubble ratio: 15.47%
[rank2]:2025-12-28 16:52:51,589 - Avg. fwd time: 6.9578 / Avg. bwd time: 18.4455 / Avg. batch time: 425.6742 (ms) / GPU bubble ratio: 52.26%
[rank0]:2025-12-28 16:52:51,624 - Avg. fwd time: 8.2260 / Avg. bwd time: 18.4421 / Avg. batch time: 474.6539 (ms) / GPU bubble ratio: 55.05%
[rank1]:2025-12-28 16:52:51,612 - Avg. fwd time: 9.1142 / Avg. bwd time: 20.0580 / Avg. batch time: 455.7114 (ms) / GPU bubble ratio: 48.79%
[rank3]:2025-12-28 16:52:51,659 -  step: 650  loss:  0.2289  grad_norm:  0.0936  memory: 29.36GiB(61.81%)  tps: 8,781  tflops: 68.65  mfu: 22.00%
[rank2]:2025-12-28 16:52:51,645 -  step: 650  loss: -8.0000  grad_norm:  0.0936  memory: 13.15GiB(27.69%)  tps: 8,781  tflops: 68.65  mfu: 22.00%
[rank0]:2025-12-28 16:52:51,660 -  step: 650  loss: -8.0000  grad_norm:  0.0936  memory: 19.09GiB(40.19%)  tps: 8,781  tflops: 68.65  mfu: 22.00%
[rank1]:2025-12-28 16:52:51,649 -  step: 650  loss: -8.0000  grad_norm:  0.0936  memory: 16.40GiB(34.52%)  tps: 8,781  tflops: 68.65  mfu: 22.00%
[rank3]:2025-12-28 16:54:24,224 - Avg. fwd time: 10.7298 / Avg. bwd time: 29.8234 / Avg. batch time: 383.9958 (ms) / GPU bubble ratio: 15.51%
[rank2]:2025-12-28 16:54:24,260 - Avg. fwd time: 6.9575 / Avg. bwd time: 18.4461 / Avg. batch time: 424.7852 (ms) / GPU bubble ratio: 52.16%
[rank0]:2025-12-28 16:54:24,296 - Avg. fwd time: 8.2254 / Avg. bwd time: 18.3839 / Avg. batch time: 473.5469 (ms) / GPU bubble ratio: 55.05%
[rank1]:2025-12-28 16:54:24,284 - Avg. fwd time: 9.1144 / Avg. bwd time: 20.0441 / Avg. batch time: 454.7723 (ms) / GPU bubble ratio: 48.71%
[rank0]:2025-12-28 16:55:53,268 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:55:56,933 - Avg. fwd time: 10.7284 / Avg. bwd time: 29.7046 / Avg. batch time: 383.0319 (ms) / GPU bubble ratio: 15.55%
[rank2]:2025-12-28 16:55:56,969 - Avg. fwd time: 6.9572 / Avg. bwd time: 18.4455 / Avg. batch time: 423.9632 (ms) / GPU bubble ratio: 52.07%
[rank2]:2025-12-28 16:55:57,028 -  step: 700  loss: -8.0000  grad_norm:  0.0789  memory: 13.15GiB(27.69%)  tps: 8,838  tflops: 69.09  mfu: 22.14%
[rank1]:2025-12-28 16:55:56,994 - Avg. fwd time: 9.1143 / Avg. bwd time: 20.0176 / Avg. batch time: 453.9024 (ms) / GPU bubble ratio: 48.66%
[rank1]:2025-12-28 16:55:57,032 -  step: 700  loss: -8.0000  grad_norm:  0.0789  memory: 16.40GiB(34.52%)  tps: 8,838  tflops: 69.09  mfu: 22.14%
[rank0]:2025-12-28 16:55:57,006 - Avg. fwd time: 8.2246 / Avg. bwd time: 18.3300 / Avg. batch time: 472.5276 (ms) / GPU bubble ratio: 55.04%
[rank0]:2025-12-28 16:55:57,043 -  step: 700  loss: -8.0000  grad_norm:  0.0789  memory: 19.09GiB(40.19%)  tps: 8,838  tflops: 69.09  mfu: 22.14%
[rank3]:2025-12-28 16:55:57,041 -  step: 700  loss:  0.1895  grad_norm:  0.0789  memory: 29.36GiB(61.81%)  tps: 8,838  tflops: 69.09  mfu: 22.14%
[rank2]:2025-12-28 16:55:57,095 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1655_stage2_step700.svg
[rank1]:2025-12-28 16:55:57,093 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1655_stage1_step700.svg
[rank0]:2025-12-28 16:55:57,094 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1655_stage0_step700.svg
[rank3]:2025-12-28 16:55:57,179 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1655_step700_rank3.svg
[rank3]:			> Batch Time: 444.25 ms, GPU Bubble Ratio: 54.52%, 49.01%, 54.18%, 32.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  306-25-332ms   | [S0,MB2,B]  333-25-359ms   | [S0,MB3,B]  363-25-388ms   | [S0,MB4,B]  390-21-411ms   | [S0,MB5,B]  414-0-414ms    | [S0,MB6,B]  429-12-442ms   | [S0,MB7,B]  444-0-444ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  36-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-24-269ms   | [S1,MB1,B]  283-20-303ms   | [S1,MB2,B]  308-20-329ms   | [S1,MB3,B]  333-25-359ms   | [S1,MB4,B]  362-17-380ms   | [S1,MB5,B]  390-21-411ms   | [S1,MB6,B]  414-11-425ms   | [S1,MB7,B]  429-11-440ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  260-19-279ms   | [S2,MB2,B]  285-19-305ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  333-20-353ms   | [S2,MB5,B]  362-20-382ms   | [S2,MB6,B]  390-19-409ms   | [S2,MB7,B]  414-8-423ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-38-253ms   | [S3,MB2,B]  253-23-276ms   | [S3,MB3,B]  275-21-297ms   | [S3,MB4,B]  298-22-320ms   | [S3,MB5,B]  320-22-343ms   | [S3,MB6,B]  343-22-365ms   | [S3,MB7,B]  365-22-387ms  
[rank1]:2025-12-28 16:55:57,240 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1655_rank1_stage1.svg
[rank0]:2025-12-28 16:55:57,250 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1655_rank0_stage0.svg
[rank1]:	> Counts Sum: 701600, Total Sum: 1814400 (38.67%), Ratio(%) per element: [41.46, 40.87, 42.06, 42.65, 44.84, 45.63, 41.46, 22.81, 24.8, 42.46, 40.67, 40.87, 43.65, 43.25, 41.07, 41.26, 23.21, 25.39, 41.66, 43.65, 43.25, 44.04, 44.24, 43.65, 45.23, 23.01, 24.0, 41.07, 45.43, 41.86, 41.26, 41.66, 43.25, 44.44, 23.41, 25.0, 44.24, 39.88, 42.65, 44.24, 43.45, 44.04, 44.04, 23.61, 25.19]
[rank0]:	> Counts Sum: 494000, Total Sum: 1491840 (33.11%), Ratio(%) per element: [36.7, 35.91, 35.51, 36.5, 36.11, 35.71, 36.11, 36.5, 23.01, 22.22, 32.93, 35.51, 35.71, 37.1, 35.31, 35.11, 37.3, 22.42, 25.19, 37.89, 36.5, 35.11, 36.5, 35.91, 35.11, 35.91, 22.42, 22.81, 34.72, 36.11, 37.3, 36.3, 34.32, 35.31, 34.72, 22.61, 24.6]
[rank3]:2025-12-28 16:55:57,225 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1655_stage3_step700.svg
[rank2]:2025-12-28 16:55:57,250 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1655_rank2_stage2.svg
[rank2]:	> Counts Sum: 193600, Total Sum: 1451520 (13.34%), Ratio(%) per element: [13.49, 13.88, 13.49, 13.88, 14.08, 13.69, 13.29, 12.3, 12.3, 13.49, 13.29, 13.29, 14.28, 13.29, 14.08, 13.88, 11.9, 12.69, 13.29, 13.29, 13.09, 13.49, 13.69, 14.08, 13.69, 12.1, 12.1, 14.28, 13.69, 13.49, 13.49, 13.69, 13.69, 14.08, 12.3, 11.9]
[rank3]:2025-12-28 16:55:57,361 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1655_rank3_stage3.svg
[rank3]:	> Counts Sum: 874640, Total Sum: 1169280 (74.80%), Ratio(%) per element: [80.75, 77.18, 78.37, 78.96, 79.36, 77.97, 79.56, 64.28, 64.08, 79.76, 80.15, 79.36, 78.76, 78.96, 78.57, 79.96, 63.29, 64.68, 79.56, 78.17, 78.37, 78.37, 78.96, 75.79, 78.57, 65.27, 63.88, 63.88, 64.28]
[rank1]:2025-12-28 16:55:58,834 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1655_stage1.svg
[rank2]:2025-12-28 16:55:58,910 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1655_stage2.svg
[rank0]:2025-12-28 16:55:58,898 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1655_stage0.svg
[rank3]:2025-12-28 16:55:58,950 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1655_stage3.svg
[rank3]:2025-12-28 16:57:31,289 - Avg. fwd time: 10.7268 / Avg. bwd time: 29.5914 / Avg. batch time: 382.1128 (ms) / GPU bubble ratio: 15.59%
[rank2]:2025-12-28 16:57:31,322 - Avg. fwd time: 6.9569 / Avg. bwd time: 18.4462 / Avg. batch time: 423.1955 (ms) / GPU bubble ratio: 51.98%
[rank1]:2025-12-28 16:57:31,346 - Avg. fwd time: 9.1147 / Avg. bwd time: 19.9902 / Avg. batch time: 453.0932 (ms) / GPU bubble ratio: 48.61%
[rank0]:2025-12-28 16:57:31,358 - Avg. fwd time: 8.2237 / Avg. bwd time: 18.2925 / Avg. batch time: 471.5550 (ms) / GPU bubble ratio: 55.01%
[rank0]:2025-12-28 16:59:00,487 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-28 16:59:04,221 - Avg. fwd time: 9.1150 / Avg. bwd time: 19.9658 / Avg. batch time: 452.3842 (ms) / GPU bubble ratio: 48.57%
[rank3]:2025-12-28 16:59:04,166 - Avg. fwd time: 10.7260 / Avg. bwd time: 29.4921 / Avg. batch time: 381.3100 (ms) / GPU bubble ratio: 15.62%
[rank2]:2025-12-28 16:59:04,196 - Avg. fwd time: 6.9567 / Avg. bwd time: 18.4472 / Avg. batch time: 422.5311 (ms) / GPU bubble ratio: 51.90%
[rank2]:2025-12-28 16:59:04,255 -  step: 750  loss: -8.0000  grad_norm:  0.1175  memory: 13.15GiB(27.69%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank0]:2025-12-28 16:59:04,233 - Avg. fwd time: 8.2238 / Avg. bwd time: 18.2483 / Avg. batch time: 470.6886 (ms) / GPU bubble ratio: 55.01%
[rank0]:2025-12-28 16:59:04,270 -  step: 750  loss: -8.0000  grad_norm:  0.1175  memory: 19.09GiB(40.19%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank1]:2025-12-28 16:59:04,259 -  step: 750  loss: -8.0000  grad_norm:  0.1175  memory: 16.40GiB(34.52%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank3]:2025-12-28 16:59:04,268 -  step: 750  loss:  0.2286  grad_norm:  0.1175  memory: 29.36GiB(61.81%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank3]:2025-12-28 17:00:36,733 - Avg. fwd time: 10.7240 / Avg. bwd time: 29.3967 / Avg. batch time: 380.5273 (ms) / GPU bubble ratio: 15.65%
[rank2]:2025-12-28 17:00:36,768 - Avg. fwd time: 6.9567 / Avg. bwd time: 18.4463 / Avg. batch time: 421.8766 (ms) / GPU bubble ratio: 51.83%
[rank0]:2025-12-28 17:00:36,806 - Avg. fwd time: 8.2237 / Avg. bwd time: 18.2038 / Avg. batch time: 469.8250 (ms) / GPU bubble ratio: 55.00%
[rank1]:2025-12-28 17:00:36,793 - Avg. fwd time: 9.1154 / Avg. bwd time: 19.9412 / Avg. batch time: 451.6897 (ms) / GPU bubble ratio: 48.54%
[rank0]:2025-12-28 17:02:05,984 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-28 17:02:09,770 - Avg. fwd time: 9.1154 / Avg. bwd time: 19.9111 / Avg. batch time: 451.0319 (ms) / GPU bubble ratio: 48.52%
[rank3]:2025-12-28 17:02:09,713 - Avg. fwd time: 10.7233 / Avg. bwd time: 29.3048 / Avg. batch time: 379.7847 (ms) / GPU bubble ratio: 15.68%
[rank2]:2025-12-28 17:02:09,745 - Avg. fwd time: 6.9567 / Avg. bwd time: 18.4444 / Avg. batch time: 421.2611 (ms) / GPU bubble ratio: 51.76%
[rank2]:2025-12-28 17:02:09,806 -  step: 800  loss: -8.0000  grad_norm:  0.1030  memory: 13.15GiB(27.69%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank2]:2025-12-28 17:02:09,806 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1030  tps: 8,892  tflops: 69.51  mfu: 20.38%
[rank2]:2025-12-28 17:02:09,806 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 17:02:09,807 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 17:02:09,784 - Avg. fwd time: 8.2236 / Avg. bwd time: 18.1768 / Avg. batch time: 469.0815 (ms) / GPU bubble ratio: 54.98%
[rank0]:2025-12-28 17:02:09,820 -  step: 800  loss: -8.0000  grad_norm:  0.1030  memory: 19.09GiB(40.19%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank0]:2025-12-28 17:02:09,820 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1030  tps: 8,893  tflops: 69.52  mfu: 20.39%
[rank0]:2025-12-28 17:02:09,820 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 17:02:09,821 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 17:02:09,809 -  step: 800  loss: -8.0000  grad_norm:  0.1030  memory: 16.40GiB(34.52%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank1]:2025-12-28 17:02:09,809 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1030  tps: 8,892  tflops: 69.51  mfu: 20.38%
[rank1]:2025-12-28 17:02:09,809 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 17:02:09,810 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 17:02:09,819 -  step: 800  loss:  0.2337  grad_norm:  0.1030  memory: 29.36GiB(61.81%)  tps: 8,830  tflops: 69.03  mfu: 22.12%
[rank3]:2025-12-28 17:02:09,820 - â„¹ï¸ final step: 800  loss:  0.2337  grad_norm:  0.1030  tps: 8,899  tflops: 69.57  mfu: 20.51%
[rank3]:2025-12-28 17:02:09,821 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 17:02:09,822 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 17:02:11,837 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-28 17:02:11,910 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_1702_stage2_final800.svg
[rank0]:2025-12-28 17:02:11,910 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_1702_stage0_final800.svg
[rank1]:2025-12-28 17:02:11,911 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_1702_stage1_final800.svg
[rank3]:2025-12-28 17:02:11,994 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1702_final800_rank3.svg
[rank3]:			> Batch Time: 446.25 ms, GPU Bubble Ratio: 54.19%, 48.78%, 54.42%, 32.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  306-25-332ms   | [S0,MB2,B]  334-25-359ms   | [S0,MB3,B]  363-25-389ms   | [S0,MB4,B]  391-23-414ms   | [S0,MB5,B]  415-0-415ms    | [S0,MB6,B]  430-13-443ms   | [S0,MB7,B]  446-0-446ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  282-21-303ms   | [S1,MB2,B]  308-21-329ms   | [S1,MB3,B]  334-25-359ms   | [S1,MB4,B]  363-17-380ms   | [S1,MB5,B]  390-21-412ms   | [S1,MB6,B]  415-11-427ms   | [S1,MB7,B]  430-11-441ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  259-19-278ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  334-20-354ms   | [S2,MB5,B]  363-20-383ms   | [S2,MB6,B]  390-19-410ms   | [S2,MB7,B]  415-8-424ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  252-23-275ms   | [S3,MB3,B]  275-22-297ms   | [S3,MB4,B]  297-22-320ms   | [S3,MB5,B]  320-22-342ms   | [S3,MB6,B]  342-22-365ms   | [S3,MB7,B]  365-22-388ms  
[rank0]:2025-12-28 17:02:12,066 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1702_rank0_stage0.svg
[rank0]:	> Counts Sum: 575600, Total Sum: 1728640 (33.30%), Ratio(%) per element: [36.81, 35.95, 35.27, 36.47, 36.64, 35.27, 35.95, 36.98, 23.28, 22.6, 33.9, 35.78, 36.13, 37.67, 35.78, 35.44, 37.15, 22.94, 25.17, 38.01, 36.13, 35.44, 36.64, 35.95, 35.78, 35.95, 22.77, 23.11, 34.58, 36.3, 36.98, 36.13, 35.1, 35.95, 34.24, 22.94, 24.65]
[rank1]:2025-12-28 17:02:12,057 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1702_rank1_stage1.svg
[rank1]:	> Counts Sum: 818400, Total Sum: 2102400 (38.93%), Ratio(%) per element: [41.26, 41.09, 42.29, 43.49, 45.37, 46.23, 42.46, 23.11, 25.0, 42.29, 41.43, 41.09, 42.8, 44.52, 41.78, 41.6, 23.45, 25.34, 41.6, 44.0, 44.17, 44.34, 44.34, 43.15, 44.86, 23.28, 24.14, 40.58, 44.34, 41.6, 41.43, 42.46, 43.66, 43.66, 23.63, 25.0, 43.83, 39.89, 43.15, 45.37, 43.83, 44.0, 44.86, 23.8, 27.91]
[rank2]:2025-12-28 17:02:12,063 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1702_rank2_stage2.svg
[rank2]:	> Counts Sum: 223200, Total Sum: 1681920 (13.27%), Ratio(%) per element: [13.35, 13.69, 13.69, 13.86, 13.86, 13.52, 13.18, 12.32, 12.32, 13.35, 13.18, 13.18, 14.04, 13.69, 14.04, 13.69, 11.98, 12.67, 13.35, 13.18, 13.01, 13.35, 13.52, 13.86, 13.52, 12.15, 12.15, 14.04, 13.52, 13.35, 13.52, 13.52, 13.52, 14.04, 12.32, 11.98]
[rank3]:2025-12-28 17:02:12,127 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/pipeline_schedule/251228_1702_thry_final800_rank3.svg
[rank3]:			> Batch Time: 288.58 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-69ms      | [S0,MB0,B]  148-17-166ms   | [S0,MB1,B]  166-17-183ms   | [S0,MB2,B]  183-17-201ms   | [S0,MB3,B]  201-17-218ms   | [S0,MB4,B]  218-17-236ms   | [S0,MB5,B]  236-17-253ms   | [S0,MB6,B]  253-17-271ms   | [S0,MB7,B]  271-17-288ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-34ms      | [S1,MB3,F]  34-8-43ms      | [S1,MB4,F]  43-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-69ms      | [S1,MB7,F]  69-8-78ms      | [S1,MB0,B]  131-17-148ms   | [S1,MB1,B]  148-17-166ms   | [S1,MB2,B]  166-17-183ms   | [S1,MB3,B]  183-17-201ms   | [S1,MB4,B]  201-17-218ms   | [S1,MB5,B]  218-17-236ms   | [S1,MB6,B]  236-17-253ms   | [S1,MB7,B]  253-17-271ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-34ms      | [S2,MB2,F]  34-8-43ms      | [S2,MB3,F]  43-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-69ms      | [S2,MB6,F]  69-8-78ms      | [S2,MB7,F]  78-8-87ms      | [S2,MB0,B]  113-17-131ms   | [S2,MB1,B]  131-17-148ms   | [S2,MB2,B]  148-17-166ms   | [S2,MB3,B]  166-17-183ms   | [S2,MB4,B]  183-17-201ms   | [S2,MB5,B]  201-17-218ms   | [S2,MB6,B]  218-17-236ms   | [S2,MB7,B]  236-17-253ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-34ms      | [S3,MB1,F]  34-8-43ms      | [S3,MB2,F]  43-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-69ms      | [S3,MB5,F]  69-8-78ms      | [S3,MB6,F]  78-8-87ms      | [S3,MB7,F]  87-8-96ms      | [S3,MB0,B]  96-17-113ms    | [S3,MB1,B]  113-17-131ms   | [S3,MB2,B]  131-17-148ms   | [S3,MB3,B]  148-17-166ms   | [S3,MB4,B]  166-17-183ms   | [S3,MB5,B]  183-17-201ms   | [S3,MB6,B]  201-17-218ms   | [S3,MB7,B]  218-17-236ms  
[rank3]:2025-12-28 17:02:12,176 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_1702_stage3_final800.svg
[rank3]:2025-12-28 17:02:12,311 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/frozen_params_histogram/251228_1702_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [80.99, 77.56, 78.93, 79.45, 79.79, 78.59, 79.45, 65.75, 65.58, 80.47, 80.82, 80.3, 78.93, 79.79, 79.1, 80.3, 64.89, 66.09, 79.96, 78.25, 79.1, 78.42, 78.93, 76.71, 79.1, 66.6, 65.41, 65.41, 65.75]
[rank0]:2025-12-28 17:02:13,935 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1702_stage0.svg
[rank0]:2025-12-28 17:02:13,938 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-28 17:02:13,890 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1702_stage1.svg
[rank1]:2025-12-28 17:02:13,894 - Destroying the purge thread.
[rank2]:2025-12-28 17:02:13,940 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1702_stage2.svg
[rank2]:2025-12-28 17:02:13,945 - Destroying the purge thread.
[rank3]:2025-12-28 17:02:14,136 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1/afr_time_plot/251228_1702_stage3.svg
[rank3]:2025-12-28 17:02:14,141 - Destroying the purge thread.
[rank2]:2025-12-28 17:02:14,172 - Process group destroyed
[rank1]:2025-12-28 17:02:14,209 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 330-351
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.68235
[rank3]:wandb:               final/avg_loss 0.23367
[rank3]:wandb:             final/avg_mfu(%) 20.50748
[rank3]:wandb:             final/avg_tflops 69.5657
[rank3]:wandb:    final/avg_throughput(tps) 8898.66906
[rank3]:wandb:              final/grad_norm 0.10298
[rank3]:wandb:               final/max_loss 0.23367
[rank3]:wandb:                    grad_norm 0.10298
[rank3]:wandb: loss_metrics/global_avg_loss 0.23367
[rank3]:wandb: loss_metrics/global_max_loss 0.23367
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_GPipe_timelyapf_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/rich26of
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_GPipe_timelyapf_11_dm1/20251228-1609/wandb/run-20251228_160958-rich26of/logs
[rank3]:2025-12-28 17:02:15,862 - Process group destroyed
[rank0]:2025-12-28 17:02:15,938 - Training completed
[rank0]:2025-12-28 17:02:15,939 - Destroying the purge thread.
[rank0]:2025-12-28 17:02:16,251 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.7', 'layers.8', 'layers.6', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.9', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.3', 'tok_embeddings', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'output', 'norm', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_GPipe_timelyapf_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_GPipe_timelyapf_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_GPipe_timelyapf_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_GPipe_timelyapf_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_GPipe_timelyapf_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_GPipe_timelyapf_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_GPipe_timelyapf_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_GPipe_timelyapf_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
