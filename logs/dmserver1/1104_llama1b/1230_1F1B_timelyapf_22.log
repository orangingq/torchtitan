
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 20:38:40 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_1F1B_timelyapf_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-30 20:38:46,369 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank3]:2025-12-30 20:38:46,373 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank2]:2025-12-30 20:38:46,565 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank0]:2025-12-30 20:38:46,580 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:"
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank1]:2025-12-30 20:38:46,591 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:"
[rank1]:2025-12-30 20:38:46,593 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-30 20:38:46,623 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 20:38:46,625 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-30 20:38:46,795 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 20:38:46,798 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 20:38:46,805 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 20:38:46,808 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 20:38:46,813 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 20:38:46,814 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-30 20:38:47,200 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 20:38:50,032 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-30 20:38:50,171 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 20:38:50,180 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 20:38:50,215 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 20:38:50,242 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 20:38:50,242 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-30 20:38:50,225 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 20:38:50,227 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-30 20:38:50,252 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 20:38:50,252 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-30 20:38:50,450 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 20:38:50,451 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 20:38:50,452 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-30 20:38:50,449 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 20:38:50,449 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 20:38:50,450 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-12-30 20:38:51,358 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 20:38:51,399 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 20:38:51,419 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 20:38:51,419 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-30 20:38:51,613 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 20:38:51,613 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 20:38:51,614 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: setting up run 0glpi68b
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_1F1B_timelyapf_22_dm1/20251230-2038/wandb/run-20251230_203851-0glpi68b
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_1F1B_timelyapf_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/0glpi68b
[rank3]:2025-12-30 20:38:52,246 - WandB logging enabled
[rank3]:2025-12-30 20:38:52,247 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 20:38:52,287 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 20:38:52,316 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 20:38:52,317 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-30 20:38:52,501 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 20:38:52,502 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 20:38:52,503 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank2]:2025-12-30 20:38:52,520 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-30 20:38:52,520 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 20:38:52,520 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_1F1B_timelyapf_22_dm1
[rank0]:2025-12-30 20:38:52,520 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 20:38:52,521 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 20:38:52,521 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-30 20:38:52,520 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 20:38:54,867 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-30 20:38:54,867 - Finished loading the checkpoint in 2.35 seconds.
[rank0]:2025-12-30 20:38:54,867 - Training starts at step 1
[rank2]:2025-12-30 20:39:00,128 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory:  6.84GiB(14.41%)  tps: 3,306  tflops: 25.84  mfu: 8.28%
[rank2]:2025-12-30 20:39:00,129 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 20:39:00,166 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 13.10GiB(27.57%)  tps: 3,297  tflops: 25.77  mfu: 8.26%
[rank0]:2025-12-30 20:39:00,166 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 20:39:00,131 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 10.58GiB(22.26%)  tps: 3,753  tflops: 29.34  mfu: 9.40%
[rank1]:2025-12-30 20:39:00,137 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 20:39:00,139 -  step:  1  loss: 10.6092  grad_norm: 203.0657  memory: 21.88GiB(46.05%)  tps: 4,175  tflops: 32.64  mfu: 10.46%
[rank3]:2025-12-30 20:39:00,139 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 20:42:53,127 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 20:42:57,781 - Avg. fwd time: 24.6096 / Avg. bwd time: 80.9924 / Avg. batch time: 990.1726 (ms) / GPU bubble ratio: 14.68%
[rank2]:2025-12-30 20:42:57,823 - Avg. fwd time: 14.9348 / Avg. bwd time: 35.2658 / Avg. batch time: 1048.3895 (ms) / GPU bubble ratio: 61.69%
[rank1]:2025-12-30 20:42:57,875 - Avg. fwd time: 19.7601 / Avg. bwd time: 45.6742 / Avg. batch time: 1121.2259 (ms) / GPU bubble ratio: 53.31%
[rank0]:2025-12-30 20:42:57,924 - Avg. fwd time: 16.1696 / Avg. bwd time: 41.9487 / Avg. batch time: 1187.2473 (ms) / GPU bubble ratio: 60.84%
[rank3]:2025-12-30 20:42:57,958 -  step: 50  loss:  9.8800  grad_norm: 23.8054  memory: 25.79GiB(54.28%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank2]:2025-12-30 20:42:57,945 -  step: 50  loss: -4.0000  grad_norm: 23.8054  memory:  8.66GiB(18.23%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank1]:2025-12-30 20:42:57,949 -  step: 50  loss: -4.0000  grad_norm: 23.8054  memory: 12.86GiB(27.07%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank0]:2025-12-30 20:42:57,963 -  step: 50  loss: -4.0000  grad_norm: 23.8054  memory: 16.87GiB(35.50%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank3]:2025-12-30 20:43:41,167 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-30 20:44:29,707 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-30 20:44:30,116 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-30 20:44:30,210 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-30 20:44:30,166 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-30 20:45:18,389 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-30 20:45:18,944 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-30 20:46:26,739 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-30 20:46:27,189 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 20:46:27,218 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.29/0.29, [MB7] 1.00/1.00
[rank2]:2025-12-30 20:46:27,218 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-30 20:46:27,219 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 20:46:27,364 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2046_max_batch_time.svg
[rank3]:			> Batch Time: 1027.98 ms, GPU Bubble Ratio: 54.48%, 48.69%, 60.65%, 17.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  235-42-277ms   | [S0,MB4,F]  277-15-293ms   | [S0,MB1,B]  338-42-380ms   | [S0,MB5,F]  380-15-396ms   | [S0,MB2,B]  445-42-487ms   | [S0,MB6,F]  487-15-503ms   | [S0,MB3,B]  553-42-595ms   | [S0,MB7,F]  595-15-611ms   | [S0,MB4,B]  661-42-703ms   | [S0,MB5,B]  770-42-812ms   | [S0,MB6,B]  877-42-919ms   | [S0,MB7,B]  985-42-1027ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  188-46-235ms   | [S1,MB3,F]  235-19-254ms   | [S1,MB1,B]  292-46-338ms   | [S1,MB4,F]  338-20-359ms   | [S1,MB2,B]  399-46-445ms   | [S1,MB5,F]  445-20-465ms   | [S1,MB3,B]  506-46-553ms   | [S1,MB6,F]  553-20-573ms   | [S1,MB4,B]  615-45-661ms   | [S1,MB7,F]  661-20-681ms   | [S1,MB5,B]  724-46-770ms   | [S1,MB6,B]  832-45-877ms   | [S1,MB7,B]  940-45-985ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  152-35-188ms   | [S2,MB2,F]  188-14-203ms   | [S2,MB1,B]  256-35-292ms   | [S2,MB3,F]  292-15-307ms   | [S2,MB2,B]  363-35-399ms   | [S2,MB4,F]  399-14-414ms   | [S2,MB3,B]  471-35-506ms   | [S2,MB5,F]  506-15-522ms   | [S2,MB4,B]  579-35-615ms   | [S2,MB6,F]  615-15-630ms   | [S2,MB5,B]  688-35-724ms   | [S2,MB7,F]  724-14-739ms   | [S2,MB6,B]  796-35-832ms   | [S2,MB7,B]  904-35-940ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-76-152ms    AFR(10):0.9655 | [S3,MB1,F]  152-23-176ms   | [S3,MB1,B]  176-80-256ms   AFR(10):0.9655 | [S3,MB2,F]  256-24-281ms   | [S3,MB2,B]  281-82-363ms   AFR(10):0.9655 | [S3,MB3,F]  363-25-388ms   | [S3,MB3,B]  388-82-471ms   AFR(10):0.9655 | [S3,MB4,F]  471-24-496ms   | [S3,MB4,B]  496-83-579ms   AFR(10):0.9655 | [S3,MB5,F]  579-25-605ms   | [S3,MB5,B]  605-83-688ms   AFR(10):0.9655 | [S3,MB6,F]  688-24-713ms   | [S3,MB6,B]  713-83-796ms   AFR(10):0.9655 | [S3,MB7,F]  796-25-821ms   | [S3,MB7,B]  821-83-904ms   AFR(10):0.9655
[rank3]:2025-12-30 20:46:27,501 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2046_min_batch_time.svg
[rank3]:			> Batch Time: 643.20 ms, GPU Bubble Ratio: 79.84%, 46.70%, 59.16%, 14.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  158-0-158ms    | [S0,MB4,F]  158-15-174ms   | [S0,MB1,B]  225-0-225ms    | [S0,MB5,F]  225-15-241ms   | [S0,MB2,B]  294-0-294ms    | [S0,MB6,F]  294-15-310ms   | [S0,MB3,B]  363-0-363ms    | [S0,MB7,F]  363-15-379ms   | [S0,MB4,B]  433-0-433ms    | [S0,MB5,B]  503-0-503ms    | [S0,MB6,B]  572-0-572ms    | [S0,MB7,B]  643-0-643ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  136-22-158ms   | [S1,MB3,F]  158-19-178ms   | [S1,MB1,B]  202-23-225ms   | [S1,MB4,F]  225-20-246ms   | [S1,MB2,B]  271-23-294ms   | [S1,MB5,F]  294-20-314ms   | [S1,MB3,B]  340-22-363ms   | [S1,MB6,F]  363-20-384ms   | [S1,MB4,B]  410-22-433ms   | [S1,MB7,F]  433-20-454ms   | [S1,MB5,B]  480-23-503ms   | [S1,MB6,B]  549-22-572ms   | [S1,MB7,B]  620-22-643ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  118-17-136ms   | [S2,MB2,F]  136-14-150ms   | [S2,MB1,B]  184-17-202ms   | [S2,MB3,F]  202-15-217ms   | [S2,MB2,B]  253-17-271ms   | [S2,MB4,F]  271-14-286ms   | [S2,MB3,B]  322-17-340ms   | [S2,MB5,F]  340-15-355ms   | [S2,MB4,B]  393-17-410ms   | [S2,MB6,F]  410-15-425ms   | [S2,MB5,B]  462-17-480ms   | [S2,MB7,F]  480-14-495ms   | [S2,MB6,B]  532-17-549ms   | [S2,MB7,B]  602-17-620ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-41-118ms    AFR(10):0.9655 | [S3,MB1,F]  118-23-142ms   | [S3,MB1,B]  142-42-184ms   AFR(10):0.9655 | [S3,MB2,F]  184-24-209ms   | [S3,MB2,B]  209-43-253ms   AFR(10):0.9655 | [S3,MB3,F]  253-25-278ms   | [S3,MB3,B]  278-43-322ms   AFR(10):0.9655 | [S3,MB4,F]  322-24-347ms   | [S3,MB4,B]  347-45-393ms   AFR(10):0.9655 | [S3,MB5,F]  393-25-418ms   | [S3,MB5,B]  418-44-462ms   AFR(10):0.9655 | [S3,MB6,F]  462-24-487ms   | [S3,MB6,B]  487-44-532ms   AFR(10):0.9655 | [S3,MB7,F]  532-25-557ms   | [S3,MB7,B]  557-45-602ms   AFR(10):0.9655
[rank3]:2025-12-30 20:46:27,681 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2046_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 700.03 ms, GPU Bubble Ratio: 40.94%, 27.94%, 44.73%, 13.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  235-42-277ms   | [S0,MB4,F]  277-15-293ms   | [S0,MB1,B]  323-42-365ms   | [S0,MB5,F]  365-15-381ms   | [S0,MB2,B]  391-42-434ms   | [S0,MB6,F]  434-15-449ms   | [S0,MB3,B]  460-42-503ms   | [S0,MB7,F]  503-15-518ms   | [S0,MB4,B]  531-42-573ms   | [S0,MB5,B]  601-42-643ms   | [S0,MB6,B]  670-29-700ms   | [S0,MB7,B]  700-0-700ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  188-46-235ms   | [S1,MB3,F]  235-19-254ms   | [S1,MB1,B]  277-46-323ms   | [S1,MB4,F]  323-20-344ms   | [S1,MB2,B]  345-46-391ms   | [S1,MB5,F]  391-20-412ms   | [S1,MB3,B]  414-46-460ms   | [S1,MB6,F]  460-20-481ms   | [S1,MB4,B]  485-45-531ms   | [S1,MB7,F]  531-20-551ms   | [S1,MB5,B]  555-46-601ms   | [S1,MB6,B]  624-45-670ms   | [S1,MB7,B]  677-22-700ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  152-35-188ms   | [S2,MB2,F]  188-14-203ms   | [S2,MB1,B]  241-35-277ms   | [S2,MB3,F]  277-15-292ms   | [S2,MB2,B]  310-35-345ms   | [S2,MB4,F]  345-14-360ms   | [S2,MB3,B]  379-35-414ms   | [S2,MB5,F]  414-15-429ms   | [S2,MB4,B]  449-35-485ms   | [S2,MB6,F]  485-15-500ms   | [S2,MB5,B]  519-35-555ms   | [S2,MB7,F]  555-14-570ms   | [S2,MB6,B]  588-35-624ms   | [S2,MB7,B]  659-17-677ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-76-152ms    AFR(10):0.9655 | [S3,MB1,F]  152-23-176ms   | [S3,MB1,B]  176-65-241ms   AFR(10):0.9655 | [S3,MB2,F]  241-24-266ms   | [S3,MB2,B]  266-43-310ms   AFR(10):0.9655 | [S3,MB3,F]  310-25-335ms   | [S3,MB3,B]  335-43-379ms   AFR(10):0.9655 | [S3,MB4,F]  379-24-404ms   | [S3,MB4,B]  404-45-449ms   AFR(10):0.9655 | [S3,MB5,F]  449-25-475ms   | [S3,MB5,B]  475-44-519ms   AFR(10):0.9655 | [S3,MB6,F]  519-24-544ms   | [S3,MB6,B]  544-44-588ms   AFR(10):0.9655 | [S3,MB7,F]  588-25-613ms   | [S3,MB7,B]  613-45-659ms   AFR(10):0.9655
[rank3]:2025-12-30 20:46:27,682 - 	> Batch Time: 700.03 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank3]:2025-12-30 20:46:27,701 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-30 20:46:31,084 - Avg. fwd time: 14.8173 / Avg. bwd time: 31.8238 / Avg. batch time: 990.2179 (ms) / GPU bubble ratio: 62.32%
[rank1]:2025-12-30 20:46:31,113 - Avg. fwd time: 19.6010 / Avg. bwd time: 41.2062 / Avg. batch time: 1057.9971 (ms) / GPU bubble ratio: 54.02%
[rank3]:2025-12-30 20:46:31,057 - Avg. fwd time: 24.7251 / Avg. bwd time: 73.9840 / Avg. batch time: 934.9671 (ms) / GPU bubble ratio: 15.54%
[rank0]:2025-12-30 20:46:31,119 - Avg. fwd time: 16.0170 / Avg. bwd time: 33.5361 / Avg. batch time: 1114.7914 (ms) / GPU bubble ratio: 64.44%
[rank0]:2025-12-30 20:46:31,156 -  step: 100  loss: -4.0000  grad_norm:  7.4200  memory: 18.74GiB(39.45%)  tps: 7,685  tflops: 60.08  mfu: 19.26%
[rank2]:2025-12-30 20:46:31,141 -  step: 100  loss: -4.0000  grad_norm:  7.4200  memory:  9.58GiB(20.16%)  tps: 7,685  tflops: 60.08  mfu: 19.26%
[rank1]:2025-12-30 20:46:31,145 -  step: 100  loss: -4.0000  grad_norm:  7.4200  memory: 14.00GiB(29.46%)  tps: 7,685  tflops: 60.08  mfu: 19.26%
[rank1]:2025-12-30 20:46:31,214 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2046_stage1_step100.svg
[rank3]:2025-12-30 20:46:31,153 -  step: 100  loss:  8.9397  grad_norm:  7.4200  memory: 28.48GiB(59.95%)  tps: 7,685  tflops: 60.08  mfu: 19.26%
[rank0]:2025-12-30 20:46:31,218 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2046_stage0_step100.svg
[rank2]:2025-12-30 20:46:31,215 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2046_stage2_step100.svg
[rank3]:2025-12-30 20:46:31,300 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2046_step100_rank3.svg
[rank3]:			> Batch Time: 858.00 ms, GPU Bubble Ratio: 85.69%, 61.13%, 69.96%, 29.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-64ms     | [S0,MB0,B]  198-0-198ms    | [S0,MB4,F]  198-14-213ms   | [S0,MB1,B]  284-0-284ms    | [S0,MB5,F]  284-14-299ms   | [S0,MB2,B]  371-0-371ms    | [S0,MB6,F]  371-14-386ms   | [S0,MB3,B]  459-0-459ms    | [S0,MB7,F]  459-14-473ms   | [S0,MB4,B]  565-0-565ms    | [S0,MB5,B]  651-0-651ms    | [S0,MB6,B]  755-0-755ms    | [S0,MB7,B]  858-0-858ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  42-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  168-22-190ms   | [S1,MB3,F]  195-18-213ms   | [S1,MB1,B]  253-23-276ms   | [S1,MB4,F]  281-18-299ms   | [S1,MB2,B]  340-23-363ms   | [S1,MB5,F]  368-18-386ms   | [S1,MB3,B]  428-23-451ms   | [S1,MB6,F]  455-18-474ms   | [S1,MB4,B]  534-22-557ms   | [S1,MB7,F]  561-18-579ms   | [S1,MB5,B]  622-23-645ms   | [S1,MB6,B]  726-22-749ms   | [S1,MB7,B]  828-22-851ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  139-17-157ms   | [S2,MB2,F]  164-14-178ms   | [S2,MB1,B]  225-17-243ms   | [S2,MB3,F]  250-14-265ms   | [S2,MB2,B]  312-17-330ms   | [S2,MB4,F]  337-14-351ms   | [S2,MB3,B]  400-17-418ms   | [S2,MB5,F]  425-14-439ms   | [S2,MB4,B]  506-17-524ms   | [S2,MB6,F]  531-14-545ms   | [S2,MB5,B]  594-17-611ms   | [S2,MB7,F]  619-14-633ms   | [S2,MB6,B]  701-17-718ms   | [S2,MB7,B]  804-17-822ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-41-129ms    | [S3,MB1,F]  136-23-160ms   | [S3,MB1,B]  171-42-214ms   | [S3,MB2,F]  222-24-247ms   | [S3,MB2,B]  257-43-301ms   | [S3,MB3,F]  309-25-334ms   | [S3,MB3,B]  345-43-389ms   | [S3,MB4,F]  396-25-422ms   | [S3,MB4,B]  434-62-497ms   | [S3,MB5,F]  503-26-530ms   | [S3,MB5,B]  540-43-584ms   | [S3,MB6,F]  591-25-617ms   | [S3,MB6,B]  629-63-692ms   | [S3,MB7,F]  698-26-724ms   | [S3,MB7,B]  736-62-799ms  
[rank0]:2025-12-30 20:46:31,373 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2046_rank0_stage0.svg
[rank0]:	> Counts Sum: 23680, Total Sum: 23680 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-30 20:46:31,367 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2046_rank2_stage2.svg
[rank2]:	> Counts Sum: 23040, Total Sum: 23040 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-30 20:46:31,405 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2046_stage2.svg
[rank1]:2025-12-30 20:46:31,364 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2046_rank1_stage1.svg
[rank1]:	> Counts Sum: 28800, Total Sum: 28800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-30 20:46:31,401 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2046_stage1.svg
[rank3]:2025-12-30 20:46:31,345 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2046_stage3_step100.svg
[rank0]:2025-12-30 20:46:31,411 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2046_stage0.svg
[rank3]:2025-12-30 20:46:31,485 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2046_rank3_stage3.svg
[rank3]:	> Counts Sum: 17920, Total Sum: 18560 (96.55%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 75.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 87.5, 87.5, 87.5, 81.25]
[rank3]:2025-12-30 20:46:31,527 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2046_stage3.svg
[rank2]:2025-12-30 20:49:58,361 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank0]:2025-12-30 20:49:58,341 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-30 20:49:58,371 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-12-30 20:49:58,385 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-30 20:49:58,393 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.19/0.29, [MB7] 0.67/1.00
[rank3]:2025-12-30 20:50:02,569 - Avg. fwd time: 24.9012 / Avg. bwd time: 71.5315 / Avg. batch time: 916.9748 (ms) / GPU bubble ratio: 15.87%
[rank1]:2025-12-30 20:50:02,628 - Avg. fwd time: 19.7566 / Avg. bwd time: 42.3207 / Avg. batch time: 1033.3487 (ms) / GPU bubble ratio: 51.94%
[rank2]:2025-12-30 20:50:02,598 - Avg. fwd time: 14.8531 / Avg. bwd time: 32.6160 / Avg. batch time: 969.3697 (ms) / GPU bubble ratio: 60.82%
[rank0]:2025-12-30 20:50:02,656 - Avg. fwd time: 16.0525 / Avg. bwd time: 35.2966 / Avg. batch time: 1086.2136 (ms) / GPU bubble ratio: 62.18%
[rank0]:2025-12-30 20:50:02,692 -  step: 150  loss: -4.0000  grad_norm: 21.5742  memory: 18.76GiB(39.49%)  tps: 7,745  tflops: 60.55  mfu: 19.41%
[rank1]:2025-12-30 20:50:02,681 -  step: 150  loss: -4.0000  grad_norm: 21.5742  memory: 14.00GiB(29.46%)  tps: 7,745  tflops: 60.55  mfu: 19.41%
[rank2]:2025-12-30 20:50:02,678 -  step: 150  loss: -4.0000  grad_norm: 21.5742  memory:  9.58GiB(20.16%)  tps: 7,745  tflops: 60.55  mfu: 19.41%
[rank3]:2025-12-30 20:50:02,690 -  step: 150  loss:  4.4789  grad_norm: 21.5742  memory: 28.48GiB(59.95%)  tps: 7,745  tflops: 60.55  mfu: 19.41%
[rank0]:2025-12-30 20:53:22,101 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 20:53:22,129 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-30 20:53:22,140 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 20:53:22,160 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.29/0.29, [MB7] 1.00/1.00
[rank3]:2025-12-30 20:53:22,159 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-30 20:53:25,740 - Avg. fwd time: 14.8801 / Avg. bwd time: 32.8934 / Avg. batch time: 951.3659 (ms) / GPU bubble ratio: 59.83%
[rank3]:2025-12-30 20:53:25,712 - Avg. fwd time: 25.0397 / Avg. bwd time: 69.4883 / Avg. batch time: 901.7156 (ms) / GPU bubble ratio: 16.13%
[rank1]:2025-12-30 20:53:25,770 - Avg. fwd time: 19.8486 / Avg. bwd time: 42.7443 / Avg. batch time: 1012.1139 (ms) / GPU bubble ratio: 50.52%
[rank1]:2025-12-30 20:53:25,803 -  step: 200  loss: -4.0000  grad_norm:  4.7180  memory: 14.00GiB(29.46%)  tps: 8,066  tflops: 63.06  mfu: 20.21%
[rank0]:2025-12-30 20:53:25,777 - Avg. fwd time: 16.1021 / Avg. bwd time: 36.0018 / Avg. batch time: 1061.6093 (ms) / GPU bubble ratio: 60.74%
[rank0]:2025-12-30 20:53:25,813 -  step: 200  loss: -4.0000  grad_norm:  4.7180  memory: 18.76GiB(39.49%)  tps: 8,066  tflops: 63.06  mfu: 20.21%
[rank2]:2025-12-30 20:53:25,799 -  step: 200  loss: -4.0000  grad_norm:  4.7180  memory:  9.58GiB(20.16%)  tps: 8,066  tflops: 63.06  mfu: 20.21%
[rank3]:2025-12-30 20:53:25,811 -  step: 200  loss:  1.5126  grad_norm:  4.7180  memory: 28.91GiB(60.85%)  tps: 8,066  tflops: 63.06  mfu: 20.21%
[rank1]:2025-12-30 20:53:25,863 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2053_stage1_step200.svg
[rank0]:2025-12-30 20:53:25,863 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2053_stage0_step200.svg
[rank2]:2025-12-30 20:53:25,862 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2053_stage2_step200.svg
[rank1]:2025-12-30 20:53:26,008 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2053_rank1_stage1.svg
[rank1]:	> Counts Sum: 41400, Total Sum: 172800 (23.96%), Ratio(%) per element: [23.95, 21.87, 23.95, 26.04, 26.04, 27.08, 25.0, 18.75, 18.75, 26.04, 26.04, 25.0, 26.04, 25.0, 25.0, 25.0, 18.75, 17.7, 23.95, 23.95, 26.04, 25.0, 26.04, 27.08, 23.95, 20.83, 18.75, 25.0, 27.08, 26.04, 27.08, 26.04, 25.0, 22.91, 18.75, 21.87, 25.0, 26.04, 25.0, 23.95, 25.0, 27.08, 25.0, 19.79, 19.79]
[rank0]:2025-12-30 20:53:26,013 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2053_rank0_stage0.svg
[rank0]:	> Counts Sum: 37080, Total Sum: 142080 (26.10%), Ratio(%) per element: [30.2, 32.29, 26.04, 27.08, 25.0, 31.25, 28.12, 27.08, 19.79, 20.83, 30.2, 27.08, 26.04, 29.16, 29.16, 27.08, 27.08, 19.79, 21.87, 27.08, 27.08, 26.04, 27.08, 28.12, 26.04, 28.12, 18.75, 20.83, 26.04, 31.25, 29.16, 26.04, 26.04, 28.12, 25.0, 19.79, 19.79]
[rank2]:2025-12-30 20:53:26,010 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2053_rank2_stage2.svg
[rank2]:	> Counts Sum: 33120, Total Sum: 138240 (23.96%), Ratio(%) per element: [27.08, 26.04, 20.83, 22.91, 23.95, 25.0, 25.0, 18.75, 23.95, 26.04, 25.0, 26.04, 26.04, 26.04, 25.0, 25.0, 18.75, 20.83, 26.04, 27.08, 26.04, 25.0, 25.0, 23.95, 25.0, 18.75, 19.79, 23.95, 23.95, 26.04, 27.08, 26.04, 23.95, 23.95, 19.79, 18.75]
[rank3]:2025-12-30 20:53:25,954 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2053_step200_rank3.svg
[rank3]:			> Batch Time: 939.20 ms, GPU Bubble Ratio: 54.61%, 44.30%, 58.29%, 28.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  273-43-316ms   | [S0,MB4,F]  316-15-332ms   | [S0,MB1,B]  386-42-428ms   | [S0,MB5,F]  428-16-444ms   | [S0,MB2,B]  478-42-521ms   | [S0,MB6,F]  521-16-537ms   | [S0,MB3,B]  572-42-614ms   | [S0,MB7,F]  615-16-631ms   | [S0,MB4,B]  676-42-718ms   | [S0,MB5,B]  767-42-809ms   | [S0,MB6,B]  869-35-904ms   | [S0,MB7,B]  934-4-939ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  218-46-265ms   | [S1,MB3,F]  269-20-290ms   | [S1,MB1,B]  331-46-378ms   | [S1,MB4,F]  383-20-404ms   | [S1,MB2,B]  423-47-471ms   | [S1,MB5,F]  475-21-497ms   | [S1,MB3,B]  513-50-563ms   | [S1,MB6,F]  568-22-591ms   | [S1,MB4,B]  620-47-667ms   | [S1,MB7,F]  672-21-694ms   | [S1,MB5,B]  710-49-760ms   | [S1,MB6,B]  816-46-863ms   | [S1,MB7,B]  904-23-928ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  171-36-208ms   | [S2,MB2,F]  215-15-230ms   | [S2,MB1,B]  285-35-321ms   | [S2,MB3,F]  328-14-343ms   | [S2,MB2,B]  376-36-413ms   | [S2,MB4,F]  420-15-435ms   | [S2,MB3,B]  465-36-502ms   | [S2,MB5,F]  509-15-525ms   | [S2,MB4,B]  574-35-610ms   | [S2,MB6,F]  617-15-632ms   | [S2,MB5,B]  663-36-700ms   | [S2,MB7,F]  707-15-722ms   | [S2,MB6,B]  773-36-810ms   | [S2,MB7,B]  879-18-898ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-72-161ms    | [S3,MB1,F]  168-24-192ms   | [S3,MB1,B]  204-70-275ms   | [S3,MB2,F]  282-26-308ms   | [S3,MB2,B]  319-44-364ms   | [S3,MB3,F]  373-25-399ms   | [S3,MB3,B]  411-44-456ms   | [S3,MB4,F]  462-26-489ms   | [S3,MB4,B]  501-64-565ms   | [S3,MB5,F]  571-26-597ms   | [S3,MB5,B]  609-44-653ms   | [S3,MB6,F]  661-25-686ms   | [S3,MB6,B]  699-64-763ms   | [S3,MB7,F]  771-26-797ms   | [S3,MB7,B]  808-64-872ms  
[rank3]:2025-12-30 20:53:25,997 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2053_stage3_step200.svg
[rank3]:2025-12-30 20:53:26,126 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2053_rank3_stage3.svg
[rank3]:	> Counts Sum: 69680, Total Sum: 111360 (62.57%), Ratio(%) per element: [76.04, 73.95, 73.95, 75.0, 72.91, 75.0, 80.2, 34.37, 30.2, 76.04, 69.79, 75.0, 75.0, 71.87, 70.83, 73.95, 34.37, 33.33, 67.7, 77.08, 75.0, 72.91, 73.95, 79.16, 75.0, 33.33, 28.12, 30.2, 30.2]
[rank1]:2025-12-30 20:53:26,168 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2053_stage1.svg
[rank0]:2025-12-30 20:53:26,178 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2053_stage0.svg
[rank2]:2025-12-30 20:53:26,167 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2053_stage2.svg
[rank3]:2025-12-30 20:53:26,287 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2053_stage3.svg
[rank2]:2025-12-30 20:56:22,910 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-30 20:56:22,920 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 20:56:22,891 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 20:56:22,940 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.29/0.29, [MB7] 1.00/1.00
[rank3]:2025-12-30 20:56:22,934 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 20:56:26,447 - Avg. fwd time: 25.1241 / Avg. bwd time: 65.8342 / Avg. batch time: 873.1433 (ms) / GPU bubble ratio: 16.66%
[rank2]:2025-12-30 20:56:26,474 - Avg. fwd time: 14.9310 / Avg. bwd time: 33.1325 / Avg. batch time: 921.0468 (ms) / GPU bubble ratio: 58.25%
[rank2]:2025-12-30 20:56:26,534 -  step: 250  loss: -4.0000  grad_norm:  2.4913  memory:  9.58GiB(20.16%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank1]:2025-12-30 20:56:26,505 - Avg. fwd time: 20.0112 / Avg. bwd time: 43.3901 / Avg. batch time: 979.8524 (ms) / GPU bubble ratio: 48.24%
[rank1]:2025-12-30 20:56:26,539 -  step: 250  loss: -4.0000  grad_norm:  2.4913  memory: 14.00GiB(29.46%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank0]:2025-12-30 20:56:26,512 - Avg. fwd time: 16.1575 / Avg. bwd time: 36.0351 / Avg. batch time: 1024.1420 (ms) / GPU bubble ratio: 59.23%
[rank0]:2025-12-30 20:56:26,548 -  step: 250  loss: -4.0000  grad_norm:  2.4913  memory: 18.76GiB(39.49%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank3]:2025-12-30 20:56:26,547 -  step: 250  loss:  0.4666  grad_norm:  2.4913  memory: 28.91GiB(60.85%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank2]:2025-12-30 20:59:23,190 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 20:59:23,161 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-30 20:59:23,202 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 20:59:23,221 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.29/0.29, [MB7] 1.00/1.00
[rank3]:2025-12-30 20:59:23,213 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-30 20:59:26,796 - Avg. fwd time: 14.9617 / Avg. bwd time: 33.2987 / Avg. batch time: 900.7114 (ms) / GPU bubble ratio: 57.14%
[rank3]:2025-12-30 20:59:26,767 - Avg. fwd time: 25.1673 / Avg. bwd time: 63.4002 / Avg. batch time: 854.0104 (ms) / GPU bubble ratio: 17.03%
[rank2]:2025-12-30 20:59:26,856 -  step: 300  loss: -4.0000  grad_norm:  0.3826  memory:  9.58GiB(20.16%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank0]:2025-12-30 20:59:26,834 - Avg. fwd time: 16.1932 / Avg. bwd time: 36.0671 / Avg. batch time: 999.0507 (ms) / GPU bubble ratio: 58.15%
[rank0]:2025-12-30 20:59:26,871 -  step: 300  loss: -4.0000  grad_norm:  0.3826  memory: 18.76GiB(39.49%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank1]:2025-12-30 20:59:26,827 - Avg. fwd time: 20.1083 / Avg. bwd time: 43.8286 / Avg. batch time: 958.2320 (ms) / GPU bubble ratio: 46.62%
[rank1]:2025-12-30 20:59:26,862 -  step: 300  loss: -4.0000  grad_norm:  0.3826  memory: 14.02GiB(29.50%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank3]:2025-12-30 20:59:26,869 -  step: 300  loss:  0.2914  grad_norm:  0.3826  memory: 28.91GiB(60.85%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank2]:2025-12-30 20:59:26,919 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2059_stage2_step300.svg
[rank0]:2025-12-30 20:59:26,919 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2059_stage0_step300.svg
[rank1]:2025-12-30 20:59:26,920 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2059_stage1_step300.svg
[rank3]:2025-12-30 20:59:27,017 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2059_step300_rank3.svg
[rank3]:			> Batch Time: 875.50 ms, GPU Bubble Ratio: 52.10%, 39.00%, 54.84%, 30.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  274-42-316ms   | [S0,MB4,F]  317-15-332ms   | [S0,MB1,B]  388-42-430ms   | [S0,MB5,F]  430-16-446ms   | [S0,MB2,B]  479-42-522ms   | [S0,MB6,F]  522-16-538ms   | [S0,MB3,B]  571-42-613ms   | [S0,MB7,F]  614-16-630ms   | [S0,MB4,B]  661-42-703ms   | [S0,MB5,B]  750-42-792ms   | [S0,MB6,B]  830-32-862ms   | [S0,MB7,B]  875-0-875ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  270-19-290ms   | [S1,MB1,B]  333-46-379ms   | [S1,MB4,F]  384-20-405ms   | [S1,MB2,B]  423-48-471ms   | [S1,MB5,F]  476-22-498ms   | [S1,MB3,B]  511-51-562ms   | [S1,MB6,F]  567-22-590ms   | [S1,MB4,B]  601-52-653ms   | [S1,MB7,F]  657-22-680ms   | [S1,MB5,B]  690-52-743ms   | [S1,MB6,B]  777-47-824ms   | [S1,MB7,B]  844-24-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  286-36-322ms   | [S2,MB3,F]  329-15-344ms   | [S2,MB2,B]  376-36-412ms   | [S2,MB4,F]  420-15-435ms   | [S2,MB3,B]  464-36-500ms   | [S2,MB5,F]  508-15-523ms   | [S2,MB4,B]  554-36-590ms   | [S2,MB6,F]  598-15-613ms   | [S2,MB5,B]  643-36-679ms   | [S2,MB7,F]  687-15-702ms   | [S2,MB6,B]  734-36-770ms   | [S2,MB7,B]  819-18-837ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-74-162ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-69-275ms   | [S3,MB2,F]  283-26-309ms   | [S3,MB2,B]  321-44-365ms   | [S3,MB3,F]  373-25-398ms   | [S3,MB3,B]  410-43-454ms   | [S3,MB4,F]  461-26-487ms   | [S3,MB4,B]  499-44-543ms   | [S3,MB5,F]  551-26-577ms   | [S3,MB5,B]  589-43-633ms   | [S3,MB6,F]  640-26-666ms   | [S3,MB6,B]  679-44-723ms   | [S3,MB7,F]  730-25-756ms   | [S3,MB7,B]  768-43-812ms  
[rank2]:2025-12-30 20:59:27,066 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2059_rank2_stage2.svg
[rank2]:	> Counts Sum: 47520, Total Sum: 253440 (18.75%), Ratio(%) per element: [20.45, 19.88, 17.04, 18.18, 18.75, 19.31, 19.31, 15.9, 18.75, 19.88, 19.31, 19.88, 19.88, 19.88, 19.31, 19.31, 15.9, 17.04, 19.88, 20.45, 19.88, 19.31, 19.31, 18.75, 19.31, 15.9, 16.47, 18.75, 18.75, 19.88, 20.45, 19.88, 18.75, 18.75, 16.47, 15.9]
[rank0]:2025-12-30 20:59:27,070 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2059_rank0_stage0.svg
[rank0]:	> Counts Sum: 56280, Total Sum: 260480 (21.61%), Ratio(%) per element: [23.29, 25.0, 21.02, 22.72, 19.88, 25.56, 22.15, 23.29, 16.47, 17.04, 25.56, 24.43, 22.15, 24.43, 24.43, 22.15, 22.72, 16.47, 17.61, 23.86, 21.59, 22.72, 22.72, 23.29, 22.15, 22.15, 16.47, 17.04, 21.59, 25.0, 24.43, 21.02, 21.02, 23.29, 21.02, 17.04, 16.47]
[rank1]:2025-12-30 20:59:27,070 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2059_rank1_stage1.svg
[rank1]:	> Counts Sum: 59400, Total Sum: 316800 (18.75%), Ratio(%) per element: [18.75, 17.61, 18.75, 19.88, 19.88, 20.45, 19.31, 15.9, 15.9, 19.88, 19.88, 19.31, 19.88, 19.31, 19.31, 19.31, 15.9, 15.34, 18.75, 18.75, 19.88, 19.31, 19.88, 20.45, 18.75, 17.04, 15.9, 19.31, 20.45, 19.88, 20.45, 19.88, 19.31, 18.18, 15.9, 17.61, 19.31, 19.88, 19.31, 18.75, 19.31, 20.45, 19.31, 16.47, 16.47]
[rank3]:2025-12-30 20:59:27,061 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2059_stage3_step300.svg
[rank3]:2025-12-30 20:59:27,196 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2059_rank3_stage3.svg
[rank3]:	> Counts Sum: 144080, Total Sum: 204160 (70.57%), Ratio(%) per element: [78.4, 78.4, 78.97, 76.7, 76.7, 77.84, 80.68, 52.84, 50.56, 78.97, 77.27, 77.84, 78.97, 76.13, 77.27, 78.97, 52.84, 52.27, 73.86, 78.97, 77.84, 77.27, 77.27, 78.97, 77.84, 52.27, 49.43, 50.56, 50.56]
[rank2]:2025-12-30 20:59:27,347 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2059_stage2.svg
[rank0]:2025-12-30 20:59:27,363 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2059_stage0.svg
[rank1]:2025-12-30 20:59:27,358 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2059_stage1.svg
[rank3]:2025-12-30 20:59:27,484 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2059_stage3.svg
[rank0]:2025-12-30 21:02:24,326 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-30 21:02:27,916 - Avg. fwd time: 14.9920 / Avg. bwd time: 33.4228 / Avg. batch time: 886.4344 (ms) / GPU bubble ratio: 56.31%
[rank3]:2025-12-30 21:02:27,888 - Avg. fwd time: 25.2082 / Avg. bwd time: 61.6755 / Avg. batch time: 840.5341 (ms) / GPU bubble ratio: 17.31%
[rank1]:2025-12-30 21:02:27,947 - Avg. fwd time: 20.1629 / Avg. bwd time: 44.1206 / Avg. batch time: 943.0455 (ms) / GPU bubble ratio: 45.47%
[rank0]:2025-12-30 21:02:27,955 - Avg. fwd time: 16.2209 / Avg. bwd time: 36.0796 / Avg. batch time: 981.3838 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-12-30 21:02:27,992 -  step: 350  loss: -4.0000  grad_norm:  0.1904  memory: 18.76GiB(39.49%)  tps: 9,046  tflops: 70.72  mfu: 22.67%
[rank2]:2025-12-30 21:02:27,977 -  step: 350  loss: -4.0000  grad_norm:  0.1904  memory:  9.60GiB(20.20%)  tps: 9,046  tflops: 70.72  mfu: 22.67%
[rank3]:2025-12-30 21:02:27,990 -  step: 350  loss:  0.2296  grad_norm:  0.1904  memory: 28.91GiB(60.85%)  tps: 9,046  tflops: 70.72  mfu: 22.67%
[rank1]:2025-12-30 21:02:27,982 -  step: 350  loss: -4.0000  grad_norm:  0.1904  memory: 14.02GiB(29.50%)  tps: 9,046  tflops: 70.72  mfu: 22.67%
[rank0]:2025-12-30 21:05:24,499 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 21:05:28,150 - Avg. fwd time: 15.0098 / Avg. bwd time: 33.5116 / Avg. batch time: 875.4431 (ms) / GPU bubble ratio: 55.66%
[rank1]:2025-12-30 21:05:28,182 - Avg. fwd time: 20.2163 / Avg. bwd time: 44.3566 / Avg. batch time: 931.3675 (ms) / GPU bubble ratio: 44.54%
[rank3]:2025-12-30 21:05:28,123 - Avg. fwd time: 25.2330 / Avg. bwd time: 60.3588 / Avg. batch time: 830.1935 (ms) / GPU bubble ratio: 17.52%
[rank2]:2025-12-30 21:05:28,212 -  step: 400  loss: -4.0000  grad_norm:  1.2342  memory:  9.60GiB(20.20%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank0]:2025-12-30 21:05:28,190 - Avg. fwd time: 16.2399 / Avg. bwd time: 36.0752 / Avg. batch time: 967.8468 (ms) / GPU bubble ratio: 56.76%
[rank0]:2025-12-30 21:05:28,226 -  step: 400  loss: -4.0000  grad_norm:  1.2342  memory: 18.76GiB(39.49%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank1]:2025-12-30 21:05:28,216 -  step: 400  loss: -4.0000  grad_norm:  1.2342  memory: 14.02GiB(29.50%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank1]:2025-12-30 21:05:28,278 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2105_stage1_step400.svg
[rank3]:2025-12-30 21:05:28,226 -  step: 400  loss:  0.2163  grad_norm:  1.2342  memory: 28.91GiB(60.85%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank2]:2025-12-30 21:05:28,295 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2105_stage2_step400.svg
[rank0]:2025-12-30 21:05:28,295 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2105_stage0_step400.svg
[rank3]:2025-12-30 21:05:28,368 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2105_step400_rank3.svg
[rank3]:			> Batch Time: 875.50 ms, GPU Bubble Ratio: 51.70%, 39.03%, 54.84%, 29.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-16-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  275-43-318ms   | [S0,MB4,F]  318-15-333ms   | [S0,MB1,B]  388-42-430ms   | [S0,MB5,F]  430-16-446ms   | [S0,MB2,B]  478-42-521ms   | [S0,MB6,F]  521-16-537ms   | [S0,MB3,B]  571-42-613ms   | [S0,MB7,F]  614-16-630ms   | [S0,MB4,B]  660-42-703ms   | [S0,MB5,B]  750-42-792ms   | [S0,MB6,B]  830-35-866ms   | [S0,MB7,B]  875-0-875ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  220-46-266ms   | [S1,MB3,F]  271-20-291ms   | [S1,MB1,B]  333-46-380ms   | [S1,MB4,F]  384-20-405ms   | [S1,MB2,B]  422-48-470ms   | [S1,MB5,F]  475-21-497ms   | [S1,MB3,B]  512-51-563ms   | [S1,MB6,F]  567-22-590ms   | [S1,MB4,B]  601-51-653ms   | [S1,MB7,F]  657-22-680ms   | [S1,MB5,B]  691-52-744ms   | [S1,MB6,B]  776-47-824ms   | [S1,MB7,B]  844-24-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-15-231ms   | [S2,MB1,B]  287-36-323ms   | [S2,MB3,F]  330-14-345ms   | [S2,MB2,B]  375-36-411ms   | [S2,MB4,F]  419-15-434ms   | [S2,MB3,B]  465-36-501ms   | [S2,MB5,F]  509-15-524ms   | [S2,MB4,B]  554-36-591ms   | [S2,MB6,F]  598-15-614ms   | [S2,MB5,B]  644-36-681ms   | [S2,MB7,F]  688-15-703ms   | [S2,MB6,B]  733-36-770ms   | [S2,MB7,B]  819-18-838ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-74-162ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  207-70-277ms   | [S3,MB2,F]  284-26-310ms   | [S3,MB2,B]  321-44-365ms   | [S3,MB3,F]  372-25-398ms   | [S3,MB3,B]  410-44-454ms   | [S3,MB4,F]  462-26-488ms   | [S3,MB4,B]  500-44-544ms   | [S3,MB5,F]  551-25-577ms   | [S3,MB5,B]  589-44-633ms   | [S3,MB6,F]  641-26-667ms   | [S3,MB6,B]  679-44-724ms   | [S3,MB7,F]  730-26-757ms   | [S3,MB7,B]  768-44-812ms  
[rank2]:2025-12-30 21:05:28,443 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2105_rank2_stage2.svg
[rank2]:	> Counts Sum: 61920, Total Sum: 368640 (16.80%), Ratio(%) per element: [17.96, 17.57, 15.62, 16.4, 16.79, 17.18, 17.18, 14.84, 16.79, 17.57, 17.18, 17.57, 17.57, 17.57, 17.18, 17.18, 14.84, 15.62, 17.57, 17.96, 17.57, 17.18, 17.18, 16.79, 17.18, 14.84, 15.23, 16.79, 16.79, 17.57, 17.96, 17.57, 16.79, 16.79, 15.23, 14.84]
[rank0]:2025-12-30 21:05:28,447 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2105_rank0_stage0.svg
[rank0]:	> Counts Sum: 75480, Total Sum: 378880 (19.92%), Ratio(%) per element: [20.7, 22.26, 19.92, 21.09, 19.92, 22.26, 20.7, 21.09, 15.23, 15.62, 22.26, 22.26, 19.53, 22.65, 23.04, 21.48, 21.48, 15.23, 16.01, 22.26, 19.53, 20.31, 21.09, 21.09, 21.48, 20.31, 15.62, 15.62, 19.92, 23.82, 21.48, 19.92, 19.53, 22.26, 19.14, 15.62, 15.23]
[rank1]:2025-12-30 21:05:28,424 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2105_rank1_stage1.svg
[rank1]:	> Counts Sum: 77400, Total Sum: 460800 (16.80%), Ratio(%) per element: [16.79, 16.01, 16.79, 17.57, 17.57, 17.96, 17.18, 14.84, 14.84, 17.57, 17.57, 17.18, 17.57, 17.18, 17.18, 17.18, 14.84, 14.45, 16.79, 16.79, 17.57, 17.18, 17.57, 17.96, 16.79, 15.62, 14.84, 17.18, 17.96, 17.57, 17.96, 17.57, 17.18, 16.4, 14.84, 16.01, 17.18, 17.57, 17.18, 16.79, 17.18, 17.96, 17.18, 15.23, 15.23]
[rank3]:2025-12-30 21:05:28,414 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2105_stage3_step400.svg
[rank3]:2025-12-30 21:05:28,542 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2105_rank3_stage3.svg
[rank3]:	> Counts Sum: 218480, Total Sum: 296960 (73.57%), Ratio(%) per element: [78.9, 80.07, 80.07, 78.51, 78.51, 78.9, 80.46, 59.76, 58.59, 80.07, 78.51, 79.68, 79.29, 78.12, 78.51, 80.46, 59.76, 59.37, 76.17, 80.85, 79.68, 77.73, 78.9, 79.29, 80.07, 59.37, 57.42, 58.2, 58.2]
[rank2]:2025-12-30 21:05:28,845 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2105_stage2.svg
[rank0]:2025-12-30 21:05:28,870 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2105_stage0.svg
[rank1]:2025-12-30 21:05:28,829 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2105_stage1.svg
[rank3]:2025-12-30 21:05:28,949 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2105_stage3.svg
[rank3]:2025-12-30 21:05:49,111 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 21:05:49,497 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 21:05:49,527 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 21:05:49,524 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 21:08:24,571 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 21:08:28,124 - Avg. fwd time: 25.2316 / Avg. bwd time: 59.3073 / Avg. batch time: 821.7623 (ms) / GPU bubble ratio: 17.70%
[rank2]:2025-12-30 21:08:28,154 - Avg. fwd time: 15.0255 / Avg. bwd time: 33.5773 / Avg. batch time: 866.5156 (ms) / GPU bubble ratio: 55.13%
[rank2]:2025-12-30 21:08:28,217 -  step: 450  loss: -4.0000  grad_norm:  0.1944  memory:  9.60GiB(20.20%)  tps: 9,102  tflops: 71.16  mfu: 22.81%
[rank1]:2025-12-30 21:08:28,187 - Avg. fwd time: 20.2669 / Avg. bwd time: 44.5410 / Avg. batch time: 921.8953 (ms) / GPU bubble ratio: 43.76%
[rank1]:2025-12-30 21:08:28,221 -  step: 450  loss: -4.0000  grad_norm:  0.1944  memory: 14.02GiB(29.50%)  tps: 9,102  tflops: 71.16  mfu: 22.81%
[rank0]:2025-12-30 21:08:28,195 - Avg. fwd time: 16.2538 / Avg. bwd time: 36.0618 / Avg. batch time: 956.9281 (ms) / GPU bubble ratio: 56.26%
[rank3]:2025-12-30 21:08:28,230 -  step: 450  loss:  0.2278  grad_norm:  0.1944  memory: 28.91GiB(60.85%)  tps: 9,102  tflops: 71.16  mfu: 22.81%
[rank0]:2025-12-30 21:08:28,232 -  step: 450  loss: -4.0000  grad_norm:  0.1944  memory: 18.76GiB(39.49%)  tps: 9,102  tflops: 71.16  mfu: 22.81%
[rank0]:2025-12-30 21:11:24,450 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 21:11:28,044 - Avg. fwd time: 25.2401 / Avg. bwd time: 58.4804 / Avg. batch time: 815.2070 (ms) / GPU bubble ratio: 17.84%
[rank1]:2025-12-30 21:11:28,107 - Avg. fwd time: 20.3022 / Avg. bwd time: 44.6970 / Avg. batch time: 914.5035 (ms) / GPU bubble ratio: 43.14%
[rank1]:2025-12-30 21:11:28,142 -  step: 500  loss: -4.0000  grad_norm:  0.1816  memory: 14.02GiB(29.50%)  tps: 9,106  tflops: 71.19  mfu: 22.82%
[rank3]:2025-12-30 21:11:28,150 -  step: 500  loss:  0.2220  grad_norm:  0.1816  memory: 28.91GiB(60.85%)  tps: 9,106  tflops: 71.19  mfu: 22.82%
[rank2]:2025-12-30 21:11:28,075 - Avg. fwd time: 15.0376 / Avg. bwd time: 33.6293 / Avg. batch time: 859.5531 (ms) / GPU bubble ratio: 54.70%
[rank2]:2025-12-30 21:11:28,137 -  step: 500  loss: -4.0000  grad_norm:  0.1816  memory:  9.60GiB(20.20%)  tps: 9,106  tflops: 71.19  mfu: 22.82%
[rank0]:2025-12-30 21:11:28,116 - Avg. fwd time: 16.2618 / Avg. bwd time: 36.0653 / Avg. batch time: 948.3788 (ms) / GPU bubble ratio: 55.86%
[rank0]:2025-12-30 21:11:28,153 -  step: 500  loss: -4.0000  grad_norm:  0.1816  memory: 18.76GiB(39.49%)  tps: 9,106  tflops: 71.19  mfu: 22.82%
[rank1]:2025-12-30 21:11:28,200 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2111_stage1_step500.svg
[rank2]:2025-12-30 21:11:28,200 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2111_stage2_step500.svg
[rank0]:2025-12-30 21:11:28,201 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2111_stage0_step500.svg
[rank1]:2025-12-30 21:11:28,346 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2111_rank1_stage1.svg
[rank1]:	> Counts Sum: 95400, Total Sum: 604800 (15.77%), Ratio(%) per element: [15.77, 15.17, 15.77, 16.36, 16.36, 16.66, 16.07, 14.28, 14.28, 16.36, 16.36, 16.07, 16.36, 16.07, 16.07, 16.07, 14.28, 13.98, 15.77, 15.77, 16.36, 16.07, 16.36, 16.66, 15.77, 14.88, 14.28, 16.07, 16.66, 16.36, 16.66, 16.36, 16.07, 15.47, 14.28, 15.17, 16.07, 16.36, 16.07, 15.77, 16.07, 16.66, 16.07, 14.58, 14.58]
[rank3]:2025-12-30 21:11:28,294 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2111_step500_rank3.svg
[rank3]:			> Batch Time: 871.00 ms, GPU Bubble Ratio: 51.75%, 38.39%, 54.55%, 29.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  386-42-429ms   | [S0,MB5,F]  429-16-445ms   | [S0,MB2,B]  478-43-521ms   | [S0,MB6,F]  521-16-537ms   | [S0,MB3,B]  569-42-611ms   | [S0,MB7,F]  612-16-628ms   | [S0,MB4,B]  658-43-701ms   | [S0,MB5,B]  746-42-788ms   | [S0,MB6,B]  826-33-859ms   | [S0,MB7,B]  871-0-871ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  271-20-291ms   | [S1,MB1,B]  330-46-377ms   | [S1,MB4,F]  383-21-404ms   | [S1,MB2,B]  420-48-469ms   | [S1,MB5,F]  475-22-497ms   | [S1,MB3,B]  509-51-561ms   | [S1,MB6,F]  565-22-588ms   | [S1,MB4,B]  598-52-650ms   | [S1,MB7,F]  654-22-677ms   | [S1,MB5,B]  687-53-740ms   | [S1,MB6,B]  772-47-820ms   | [S1,MB7,B]  840-24-864ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  172-36-209ms   | [S2,MB2,F]  216-15-231ms   | [S2,MB1,B]  284-36-320ms   | [S2,MB3,F]  327-15-342ms   | [S2,MB2,B]  374-36-410ms   | [S2,MB4,F]  417-15-433ms   | [S2,MB3,B]  462-36-499ms   | [S2,MB5,F]  506-15-521ms   | [S2,MB4,B]  550-36-587ms   | [S2,MB6,F]  595-15-610ms   | [S2,MB5,B]  639-36-676ms   | [S2,MB7,F]  684-15-699ms   | [S2,MB6,B]  729-36-765ms   | [S2,MB7,B]  815-18-833ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-74-162ms    | [S3,MB1,F]  169-24-194ms   | [S3,MB1,B]  206-69-275ms   | [S3,MB2,F]  281-26-307ms   | [S3,MB2,B]  320-43-363ms   | [S3,MB3,F]  371-25-396ms   | [S3,MB3,B]  407-44-452ms   | [S3,MB4,F]  459-26-485ms   | [S3,MB4,B]  497-43-540ms   | [S3,MB5,F]  547-25-573ms   | [S3,MB5,B]  586-44-630ms   | [S3,MB6,F]  636-25-662ms   | [S3,MB6,B]  674-43-718ms   | [S3,MB7,F]  726-26-752ms   | [S3,MB7,B]  764-43-808ms  
[rank3]:2025-12-30 21:11:28,336 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2111_stage3_step500.svg
[rank2]:2025-12-30 21:11:28,351 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2111_rank2_stage2.svg
[rank2]:	> Counts Sum: 76320, Total Sum: 483840 (15.77%), Ratio(%) per element: [16.66, 16.36, 14.88, 15.47, 15.77, 16.07, 16.07, 14.28, 15.77, 16.36, 16.07, 16.36, 16.36, 16.36, 16.07, 16.07, 14.28, 14.88, 16.36, 16.66, 16.36, 16.07, 16.07, 15.77, 16.07, 14.28, 14.58, 15.77, 15.77, 16.36, 16.66, 16.36, 15.77, 15.77, 14.58, 14.28]
[rank0]:2025-12-30 21:11:28,356 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2111_rank0_stage0.svg
[rank0]:	> Counts Sum: 94680, Total Sum: 497280 (19.04%), Ratio(%) per element: [19.64, 21.13, 19.64, 20.23, 19.64, 21.42, 19.64, 20.53, 14.58, 14.88, 20.53, 20.83, 18.75, 21.13, 22.02, 20.53, 20.23, 14.58, 15.17, 20.23, 19.04, 19.94, 19.94, 19.64, 20.23, 20.53, 14.88, 15.17, 19.34, 22.61, 19.94, 18.75, 19.94, 21.13, 18.45, 14.88, 14.58]
[rank3]:2025-12-30 21:11:28,467 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2111_rank3_stage3.svg
[rank3]:	> Counts Sum: 292880, Total Sum: 389760 (75.14%), Ratio(%) per element: [79.46, 80.65, 80.65, 78.86, 79.46, 79.76, 81.25, 63.39, 62.5, 79.46, 79.16, 80.95, 79.76, 79.16, 80.05, 80.65, 63.39, 63.09, 77.67, 81.25, 80.35, 78.27, 80.05, 80.35, 80.35, 63.09, 61.6, 62.2, 62.2]
[rank1]:2025-12-30 21:11:28,875 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2111_stage1.svg
[rank2]:2025-12-30 21:11:28,879 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2111_stage2.svg
[rank0]:2025-12-30 21:11:28,913 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2111_stage0.svg
[rank3]:2025-12-30 21:11:28,994 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2111_stage3.svg
[rank0]:2025-12-30 21:14:24,112 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 21:14:27,683 - Avg. fwd time: 25.2361 / Avg. bwd time: 57.7567 / Avg. batch time: 809.4069 (ms) / GPU bubble ratio: 17.97%
[rank2]:2025-12-30 21:14:27,712 - Avg. fwd time: 15.0456 / Avg. bwd time: 33.6698 / Avg. batch time: 853.4281 (ms) / GPU bubble ratio: 54.33%
[rank2]:2025-12-30 21:14:27,776 -  step: 550  loss: -4.0000  grad_norm:  0.1736  memory:  9.60GiB(20.20%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank1]:2025-12-30 21:14:27,745 - Avg. fwd time: 20.3354 / Avg. bwd time: 44.8279 / Avg. batch time: 908.0201 (ms) / GPU bubble ratio: 42.59%
[rank1]:2025-12-30 21:14:27,780 -  step: 550  loss: -4.0000  grad_norm:  0.1736  memory: 14.02GiB(29.50%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank0]:2025-12-30 21:14:27,754 - Avg. fwd time: 16.2688 / Avg. bwd time: 36.0306 / Avg. batch time: 940.9468 (ms) / GPU bubble ratio: 55.53%
[rank0]:2025-12-30 21:14:27,790 -  step: 550  loss: -4.0000  grad_norm:  0.1736  memory: 18.76GiB(39.49%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank3]:2025-12-30 21:14:27,788 -  step: 550  loss:  0.2266  grad_norm:  0.1736  memory: 28.91GiB(60.85%)  tps: 9,121  tflops: 71.30  mfu: 22.85%
[rank0]:2025-12-30 21:17:23,582 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 21:17:27,209 - Avg. fwd time: 15.0501 / Avg. bwd time: 33.7019 / Avg. batch time: 848.5280 (ms) / GPU bubble ratio: 54.04%
[rank3]:2025-12-30 21:17:27,181 - Avg. fwd time: 25.2319 / Avg. bwd time: 57.1841 / Avg. batch time: 804.7856 (ms) / GPU bubble ratio: 18.07%
[rank2]:2025-12-30 21:17:27,273 -  step: 600  loss: -4.0000  grad_norm:  0.2532  memory:  9.60GiB(20.20%)  tps: 9,128  tflops: 71.36  mfu: 22.87%
[rank3]:2025-12-30 21:17:27,286 -  step: 600  loss:  0.2235  grad_norm:  0.2532  memory: 29.20GiB(61.47%)  tps: 9,128  tflops: 71.36  mfu: 22.87%
[rank1]:2025-12-30 21:17:27,242 - Avg. fwd time: 20.3539 / Avg. bwd time: 44.9162 / Avg. batch time: 902.8205 (ms) / GPU bubble ratio: 42.16%
[rank1]:2025-12-30 21:17:27,277 -  step: 600  loss: -4.0000  grad_norm:  0.2532  memory: 14.02GiB(29.50%)  tps: 9,128  tflops: 71.36  mfu: 22.87%
[rank0]:2025-12-30 21:17:27,251 - Avg. fwd time: 16.2745 / Avg. bwd time: 36.0392 / Avg. batch time: 934.9596 (ms) / GPU bubble ratio: 55.24%
[rank0]:2025-12-30 21:17:27,288 -  step: 600  loss: -4.0000  grad_norm:  0.2532  memory: 18.76GiB(39.49%)  tps: 9,128  tflops: 71.36  mfu: 22.87%
[rank2]:2025-12-30 21:17:27,337 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2117_stage2_step600.svg
[rank1]:2025-12-30 21:17:27,340 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2117_stage1_step600.svg
[rank0]:2025-12-30 21:17:27,337 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2117_stage0_step600.svg
[rank2]:2025-12-30 21:17:27,486 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2117_rank2_stage2.svg
[rank2]:	> Counts Sum: 90720, Total Sum: 599040 (15.14%), Ratio(%) per element: [15.86, 15.62, 14.42, 14.9, 15.14, 15.38, 15.38, 13.94, 15.14, 15.62, 15.38, 15.62, 15.62, 15.62, 15.38, 15.38, 13.94, 14.42, 15.62, 15.86, 15.62, 15.38, 15.38, 15.14, 15.38, 13.94, 14.18, 15.14, 15.14, 15.62, 15.86, 15.62, 15.14, 15.14, 14.18, 13.94]
[rank3]:2025-12-30 21:17:27,445 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2117_step600_rank3.svg
[rank3]:			> Batch Time: 871.50 ms, GPU Bubble Ratio: 52.11%, 38.92%, 54.81%, 30.04%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  272-42-315ms   | [S0,MB4,F]  315-15-331ms   | [S0,MB1,B]  387-42-429ms   | [S0,MB5,F]  429-16-445ms   | [S0,MB2,B]  477-42-520ms   | [S0,MB6,F]  520-16-536ms   | [S0,MB3,B]  569-42-612ms   | [S0,MB7,F]  612-16-628ms   | [S0,MB4,B]  659-42-702ms   | [S0,MB5,B]  747-42-789ms   | [S0,MB6,B]  828-31-859ms   | [S0,MB7,B]  871-0-871ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  218-46-264ms   | [S1,MB3,F]  269-19-288ms   | [S1,MB1,B]  332-47-379ms   | [S1,MB4,F]  384-21-405ms   | [S1,MB2,B]  421-48-469ms   | [S1,MB5,F]  474-21-495ms   | [S1,MB3,B]  510-51-561ms   | [S1,MB6,F]  565-22-588ms   | [S1,MB4,B]  599-51-650ms   | [S1,MB7,F]  656-22-678ms   | [S1,MB5,B]  688-52-740ms   | [S1,MB6,B]  774-47-821ms   | [S1,MB7,B]  840-24-864ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  171-36-208ms   | [S2,MB2,F]  215-14-230ms   | [S2,MB1,B]  285-35-321ms   | [S2,MB3,F]  328-14-343ms   | [S2,MB2,B]  374-36-411ms   | [S2,MB4,F]  418-15-434ms   | [S2,MB3,B]  463-36-500ms   | [S2,MB5,F]  507-15-522ms   | [S2,MB4,B]  552-36-588ms   | [S2,MB6,F]  596-15-611ms   | [S2,MB5,B]  641-36-677ms   | [S2,MB7,F]  685-15-700ms   | [S2,MB6,B]  731-36-767ms   | [S2,MB7,B]  816-18-834ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-73-161ms    | [S3,MB1,F]  168-24-192ms   | [S3,MB1,B]  205-70-275ms   | [S3,MB2,F]  282-26-308ms   | [S3,MB2,B]  320-43-363ms   | [S3,MB3,F]  371-25-397ms   | [S3,MB3,B]  408-43-452ms   | [S3,MB4,F]  460-26-486ms   | [S3,MB4,B]  498-44-542ms   | [S3,MB5,F]  549-25-574ms   | [S3,MB5,B]  586-44-630ms   | [S3,MB6,F]  638-25-664ms   | [S3,MB6,B]  676-43-719ms   | [S3,MB7,F]  727-25-753ms   | [S3,MB7,B]  765-44-809ms  
[rank3]:2025-12-30 21:17:27,493 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2117_stage3_step600.svg
[rank1]:2025-12-30 21:17:27,495 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2117_rank1_stage1.svg
[rank1]:	> Counts Sum: 113400, Total Sum: 748800 (15.14%), Ratio(%) per element: [15.14, 14.66, 15.14, 15.62, 15.62, 15.86, 15.38, 13.94, 13.94, 15.62, 15.62, 15.38, 15.62, 15.38, 15.38, 15.38, 13.94, 13.7, 15.14, 15.14, 15.62, 15.38, 15.62, 15.86, 15.14, 14.42, 13.94, 15.38, 15.86, 15.62, 15.86, 15.62, 15.38, 14.9, 13.94, 14.66, 15.38, 15.62, 15.38, 15.14, 15.38, 15.86, 15.38, 14.18, 14.18]
[rank0]:2025-12-30 21:17:27,489 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2117_rank0_stage0.svg
[rank0]:	> Counts Sum: 113880, Total Sum: 615680 (18.50%), Ratio(%) per element: [19.71, 20.19, 18.5, 19.47, 19.23, 21.39, 18.75, 19.23, 14.18, 14.42, 20.43, 20.19, 18.75, 20.43, 20.67, 19.71, 19.47, 14.18, 14.66, 19.95, 18.26, 19.47, 19.47, 18.99, 19.95, 20.19, 14.42, 14.66, 18.75, 21.39, 19.71, 18.02, 19.23, 20.43, 18.02, 14.66, 15.14]
[rank3]:2025-12-30 21:17:27,637 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2117_rank3_stage3.svg
[rank3]:	> Counts Sum: 367280, Total Sum: 482560 (76.11%), Ratio(%) per element: [80.04, 80.52, 81.49, 79.08, 80.28, 79.56, 81.97, 65.62, 64.9, 80.28, 79.56, 80.52, 80.28, 79.56, 80.04, 80.76, 65.62, 65.62, 78.12, 81.73, 80.52, 79.32, 81.25, 80.28, 81.0, 65.38, 64.18, 64.66, 64.9]
[rank2]:2025-12-30 21:17:28,142 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2117_stage2.svg
[rank1]:2025-12-30 21:17:28,165 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2117_stage1.svg
[rank0]:2025-12-30 21:17:28,173 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2117_stage0.svg
[rank3]:2025-12-30 21:17:28,381 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2117_stage3.svg
[rank0]:2025-12-30 21:20:25,000 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 21:20:28,571 - Avg. fwd time: 25.2464 / Avg. bwd time: 56.7277 / Avg. batch time: 801.2445 (ms) / GPU bubble ratio: 18.15%
[rank2]:2025-12-30 21:20:28,600 - Avg. fwd time: 15.0606 / Avg. bwd time: 33.7341 / Avg. batch time: 844.8084 (ms) / GPU bubble ratio: 53.79%
[rank2]:2025-12-30 21:20:28,664 -  step: 650  loss: -4.0000  grad_norm:  0.1550  memory:  9.60GiB(20.20%)  tps: 9,032  tflops: 70.61  mfu: 22.63%
[rank0]:2025-12-30 21:20:28,642 - Avg. fwd time: 16.2839 / Avg. bwd time: 36.0360 / Avg. batch time: 930.3271 (ms) / GPU bubble ratio: 55.01%
[rank1]:2025-12-30 21:20:28,633 - Avg. fwd time: 20.3707 / Avg. bwd time: 45.0029 / Avg. batch time: 898.8534 (ms) / GPU bubble ratio: 41.82%
[rank1]:2025-12-30 21:20:28,668 -  step: 650  loss: -4.0000  grad_norm:  0.1550  memory: 14.02GiB(29.50%)  tps: 9,032  tflops: 70.61  mfu: 22.63%
[rank3]:2025-12-30 21:20:28,676 -  step: 650  loss:  0.2315  grad_norm:  0.1550  memory: 29.20GiB(61.47%)  tps: 9,033  tflops: 70.61  mfu: 22.63%
[rank0]:2025-12-30 21:20:28,678 -  step: 650  loss: -4.0000  grad_norm:  0.1550  memory: 18.76GiB(39.49%)  tps: 9,032  tflops: 70.61  mfu: 22.63%
[rank0]:2025-12-30 21:23:25,152 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 21:23:28,697 - Avg. fwd time: 25.2518 / Avg. bwd time: 56.3324 / Avg. batch time: 798.1229 (ms) / GPU bubble ratio: 18.22%
[rank1]:2025-12-30 21:23:28,760 - Avg. fwd time: 20.3805 / Avg. bwd time: 45.0632 / Avg. batch time: 895.3148 (ms) / GPU bubble ratio: 41.52%
[rank1]:2025-12-30 21:23:28,795 -  step: 700  loss: -4.0000  grad_norm:  0.1777  memory: 14.02GiB(29.50%)  tps: 9,096  tflops: 71.11  mfu: 22.79%
[rank3]:2025-12-30 21:23:28,804 -  step: 700  loss:  0.1904  grad_norm:  0.1777  memory: 29.20GiB(61.47%)  tps: 9,096  tflops: 71.11  mfu: 22.79%
[rank0]:2025-12-30 21:23:28,769 - Avg. fwd time: 16.2891 / Avg. bwd time: 36.0308 / Avg. batch time: 926.2146 (ms) / GPU bubble ratio: 54.81%
[rank0]:2025-12-30 21:23:28,805 -  step: 700  loss: -4.0000  grad_norm:  0.1777  memory: 18.76GiB(39.49%)  tps: 9,096  tflops: 71.11  mfu: 22.79%
[rank2]:2025-12-30 21:23:28,726 - Avg. fwd time: 15.0657 / Avg. bwd time: 33.7581 / Avg. batch time: 841.4810 (ms) / GPU bubble ratio: 53.58%
[rank2]:2025-12-30 21:23:28,791 -  step: 700  loss: -4.0000  grad_norm:  0.1777  memory:  9.60GiB(20.20%)  tps: 9,096  tflops: 71.11  mfu: 22.79%
[rank1]:2025-12-30 21:23:28,856 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2123_stage1_step700.svg
[rank2]:2025-12-30 21:23:28,858 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2123_stage2_step700.svg
[rank0]:2025-12-30 21:23:28,856 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2123_stage0_step700.svg
[rank1]:2025-12-30 21:23:29,002 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2123_rank1_stage1.svg
[rank1]:	> Counts Sum: 131400, Total Sum: 892800 (14.72%), Ratio(%) per element: [14.71, 14.31, 14.71, 15.12, 15.12, 15.32, 14.91, 13.7, 13.7, 15.12, 15.12, 14.91, 15.12, 14.91, 14.91, 14.91, 13.7, 13.5, 14.71, 14.71, 15.12, 14.91, 15.12, 15.32, 14.71, 14.11, 13.7, 14.91, 15.32, 15.12, 15.32, 15.12, 14.91, 14.51, 13.7, 14.31, 14.91, 15.12, 14.91, 14.71, 14.91, 15.32, 14.91, 13.91, 13.91]
[rank3]:2025-12-30 21:23:28,949 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2123_step700_rank3.svg
[rank3]:			> Batch Time: 874.00 ms, GPU Bubble Ratio: 52.42%, 39.24%, 54.85%, 29.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  275-42-317ms   | [S0,MB4,F]  318-15-333ms   | [S0,MB1,B]  390-42-432ms   | [S0,MB5,F]  432-16-448ms   | [S0,MB2,B]  481-42-524ms   | [S0,MB6,F]  524-16-540ms   | [S0,MB3,B]  572-42-615ms   | [S0,MB7,F]  615-16-632ms   | [S0,MB4,B]  662-42-705ms   | [S0,MB5,B]  750-42-792ms   | [S0,MB6,B]  830-29-859ms   | [S0,MB7,B]  874-0-874ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-46-267ms   | [S1,MB3,F]  271-19-291ms   | [S1,MB1,B]  335-46-381ms   | [S1,MB4,F]  387-20-408ms   | [S1,MB2,B]  425-48-473ms   | [S1,MB5,F]  478-21-500ms   | [S1,MB3,B]  513-50-564ms   | [S1,MB6,F]  569-22-591ms   | [S1,MB4,B]  603-51-654ms   | [S1,MB7,F]  659-22-681ms   | [S1,MB5,B]  691-52-743ms   | [S1,MB6,B]  776-47-823ms   | [S1,MB7,B]  843-24-867ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  174-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  289-35-325ms   | [S2,MB3,F]  331-15-346ms   | [S2,MB2,B]  378-36-415ms   | [S2,MB4,F]  421-15-437ms   | [S2,MB3,B]  466-36-503ms   | [S2,MB5,F]  510-15-526ms   | [S2,MB4,B]  556-36-593ms   | [S2,MB6,F]  600-15-615ms   | [S2,MB5,B]  644-36-680ms   | [S2,MB7,F]  688-15-703ms   | [S2,MB6,B]  732-36-769ms   | [S2,MB7,B]  817-18-836ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-76-164ms    | [S3,MB1,F]  171-24-195ms   | [S3,MB1,B]  208-70-279ms   | [S3,MB2,F]  286-26-312ms   | [S3,MB2,B]  324-43-367ms   | [S3,MB3,F]  375-25-401ms   | [S3,MB3,B]  412-44-456ms   | [S3,MB4,F]  463-25-489ms   | [S3,MB4,B]  501-43-545ms   | [S3,MB5,F]  553-25-578ms   | [S3,MB5,B]  590-43-634ms   | [S3,MB6,F]  641-25-667ms   | [S3,MB6,B]  679-43-722ms   | [S3,MB7,F]  730-25-755ms   | [S3,MB7,B]  767-43-811ms  
[rank3]:2025-12-30 21:23:28,994 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2123_stage3_step700.svg
[rank2]:2025-12-30 21:23:29,007 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2123_rank2_stage2.svg
[rank2]:	> Counts Sum: 105120, Total Sum: 714240 (14.72%), Ratio(%) per element: [15.32, 15.12, 14.11, 14.51, 14.71, 14.91, 14.91, 13.7, 14.71, 15.12, 14.91, 15.12, 15.12, 15.12, 14.91, 14.91, 13.7, 14.11, 15.12, 15.32, 15.12, 14.91, 14.91, 14.71, 14.91, 13.7, 13.91, 14.71, 14.71, 15.12, 15.32, 15.12, 14.71, 14.71, 13.91, 13.7]
[rank0]:2025-12-30 21:23:29,006 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2123_rank0_stage0.svg
[rank0]:	> Counts Sum: 133080, Total Sum: 734080 (18.13%), Ratio(%) per element: [19.75, 20.16, 18.75, 18.75, 18.54, 20.36, 18.14, 19.15, 13.91, 14.11, 19.75, 19.35, 18.54, 20.36, 19.95, 18.95, 19.35, 13.91, 14.31, 19.55, 18.34, 18.95, 18.95, 18.54, 19.75, 19.55, 14.11, 15.12, 18.54, 20.36, 19.75, 17.74, 19.15, 19.55, 17.33, 14.31, 14.91]
[rank3]:2025-12-30 21:23:29,130 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2123_rank3_stage3.svg
[rank3]:	> Counts Sum: 441680, Total Sum: 575360 (76.77%), Ratio(%) per element: [80.44, 80.84, 81.25, 79.23, 80.64, 80.04, 82.05, 67.13, 66.53, 80.24, 80.24, 81.04, 79.83, 80.04, 80.44, 80.64, 67.33, 67.13, 79.03, 81.85, 81.04, 79.83, 81.65, 80.44, 81.45, 66.93, 65.92, 66.33, 66.53]
[rank1]:2025-12-30 21:23:29,793 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2123_stage1.svg
[rank2]:2025-12-30 21:23:29,778 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2123_stage2.svg
[rank0]:2025-12-30 21:23:29,812 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2123_stage0.svg
[rank3]:2025-12-30 21:23:29,930 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2123_stage3.svg
[rank0]:2025-12-30 21:26:25,754 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 21:26:29,335 - Avg. fwd time: 25.2603 / Avg. bwd time: 55.9613 / Avg. batch time: 795.2396 (ms) / GPU bubble ratio: 18.29%
[rank2]:2025-12-30 21:26:29,364 - Avg. fwd time: 15.0805 / Avg. bwd time: 33.7799 / Avg. batch time: 838.4361 (ms) / GPU bubble ratio: 53.38%
[rank2]:2025-12-30 21:26:29,430 -  step: 750  loss: -4.0000  grad_norm:  0.2492  memory:  9.60GiB(20.20%)  tps: 9,070  tflops: 70.91  mfu: 22.73%
[rank3]:2025-12-30 21:26:29,443 -  step: 750  loss:  0.2285  grad_norm:  0.2492  memory: 29.20GiB(61.47%)  tps: 9,070  tflops: 70.91  mfu: 22.73%
[rank1]:2025-12-30 21:26:29,398 - Avg. fwd time: 20.3942 / Avg. bwd time: 45.1266 / Avg. batch time: 892.0865 (ms) / GPU bubble ratio: 41.24%
[rank1]:2025-12-30 21:26:29,433 -  step: 750  loss: -4.0000  grad_norm:  0.2492  memory: 14.02GiB(29.50%)  tps: 9,070  tflops: 70.91  mfu: 22.73%
[rank0]:2025-12-30 21:26:29,408 - Avg. fwd time: 16.2931 / Avg. bwd time: 36.0391 / Avg. batch time: 922.4908 (ms) / GPU bubble ratio: 54.62%
[rank0]:2025-12-30 21:26:29,444 -  step: 750  loss: -4.0000  grad_norm:  0.2492  memory: 18.76GiB(39.49%)  tps: 9,070  tflops: 70.91  mfu: 22.73%
[rank0]:2025-12-30 21:29:25,924 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 21:29:29,570 - Avg. fwd time: 25.2621 / Avg. bwd time: 55.6685 / Avg. batch time: 792.9047 (ms) / GPU bubble ratio: 18.35%
[rank2]:2025-12-30 21:29:29,600 - Avg. fwd time: 15.0831 / Avg. bwd time: 33.7951 / Avg. batch time: 835.9455 (ms) / GPU bubble ratio: 53.22%
[rank2]:2025-12-30 21:29:29,666 -  step: 800  loss: -4.0000  grad_norm:  0.1746  memory:  9.60GiB(20.20%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank2]:2025-12-30 21:29:29,666 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1746  tps: 9,164  tflops: 71.64  mfu: 21.02%
[rank2]:2025-12-30 21:29:29,666 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-30 21:29:29,667 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-30 21:29:29,634 - Avg. fwd time: 20.4113 / Avg. bwd time: 45.1763 / Avg. batch time: 889.4262 (ms) / GPU bubble ratio: 41.01%
[rank1]:2025-12-30 21:29:29,670 -  step: 800  loss: -4.0000  grad_norm:  0.1746  memory: 14.02GiB(29.50%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank1]:2025-12-30 21:29:29,670 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1746  tps: 9,167  tflops: 71.67  mfu: 21.08%
[rank1]:2025-12-30 21:29:29,670 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 21:29:29,671 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 21:29:29,644 - Avg. fwd time: 16.2960 / Avg. bwd time: 36.0348 / Avg. batch time: 919.3974 (ms) / GPU bubble ratio: 54.47%
[rank0]:2025-12-30 21:29:29,680 -  step: 800  loss: -4.0000  grad_norm:  0.1746  memory: 18.76GiB(39.49%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank0]:2025-12-30 21:29:29,680 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1746  tps: 9,164  tflops: 71.64  mfu: 21.01%
[rank0]:2025-12-30 21:29:29,680 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 21:29:29,681 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 21:29:29,678 -  step: 800  loss:  0.2355  grad_norm:  0.1746  memory: 29.20GiB(61.47%)  tps: 9,090  tflops: 71.06  mfu: 22.78%
[rank3]:2025-12-30 21:29:29,679 - â„¹ï¸ final step: 800  loss:  0.2355  grad_norm:  0.1746  tps: 9,170  tflops: 71.69  mfu: 21.14%
[rank3]:2025-12-30 21:29:29,679 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 21:29:29,680 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 21:29:31,644 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-30 21:29:31,710 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_2129_stage2_final800.svg
[rank1]:2025-12-30 21:29:31,708 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_2129_stage1_final800.svg
[rank0]:2025-12-30 21:29:31,710 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_2129_stage0_final800.svg
[rank2]:2025-12-30 21:29:31,862 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2129_rank2_stage2.svg
[rank2]:	> Counts Sum: 119520, Total Sum: 829440 (14.41%), Ratio(%) per element: [14.93, 14.75, 13.88, 14.23, 14.4, 14.58, 14.58, 13.54, 14.4, 14.75, 14.58, 14.75, 14.75, 14.75, 14.58, 14.58, 13.54, 13.88, 14.75, 14.93, 14.75, 14.58, 14.58, 14.4, 14.58, 13.54, 13.71, 14.4, 14.4, 14.75, 14.93, 14.75, 14.4, 14.4, 13.71, 13.54]
[rank1]:2025-12-30 21:29:31,856 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2129_rank1_stage1.svg
[rank1]:	> Counts Sum: 149400, Total Sum: 1036800 (14.41%), Ratio(%) per element: [14.4, 14.06, 14.4, 14.75, 14.75, 14.93, 14.58, 13.54, 13.54, 14.75, 14.75, 14.58, 14.75, 14.58, 14.58, 14.58, 13.54, 13.36, 14.4, 14.4, 14.75, 14.58, 14.75, 14.93, 14.4, 13.88, 13.54, 14.58, 14.93, 14.75, 14.93, 14.75, 14.58, 14.23, 13.54, 14.06, 14.58, 14.75, 14.58, 14.4, 14.58, 14.93, 14.58, 13.71, 13.71]
[rank0]:2025-12-30 21:29:31,863 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2129_rank0_stage0.svg
[rank0]:	> Counts Sum: 152280, Total Sum: 852480 (17.86%), Ratio(%) per element: [19.44, 19.96, 18.4, 18.75, 18.22, 19.96, 17.7, 18.75, 13.71, 13.88, 19.61, 18.75, 18.22, 19.96, 19.44, 18.75, 18.92, 13.71, 14.06, 19.61, 18.57, 19.09, 18.57, 18.22, 19.09, 19.27, 13.88, 15.27, 18.22, 19.44, 19.61, 17.53, 18.75, 19.09, 17.7, 14.06, 14.58]
[rank3]:2025-12-30 21:29:31,799 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2129_final800_rank3.svg
[rank3]:			> Batch Time: 875.50 ms, GPU Bubble Ratio: 51.97%, 39.44%, 55.03%, 29.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-332ms   | [S0,MB1,B]  389-42-431ms   | [S0,MB5,F]  431-16-447ms   | [S0,MB2,B]  481-42-523ms   | [S0,MB6,F]  524-16-540ms   | [S0,MB3,B]  572-42-615ms   | [S0,MB7,F]  615-16-631ms   | [S0,MB4,B]  662-42-705ms   | [S0,MB5,B]  751-42-793ms   | [S0,MB6,B]  830-34-864ms   | [S0,MB7,B]  875-0-875ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  270-19-290ms   | [S1,MB1,B]  334-46-380ms   | [S1,MB4,F]  385-20-406ms   | [S1,MB2,B]  424-47-472ms   | [S1,MB5,F]  477-21-499ms   | [S1,MB3,B]  513-50-564ms   | [S1,MB6,F]  569-22-591ms   | [S1,MB4,B]  602-51-653ms   | [S1,MB7,F]  658-22-681ms   | [S1,MB5,B]  691-52-743ms   | [S1,MB6,B]  776-46-823ms   | [S1,MB7,B]  844-24-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  287-35-323ms   | [S2,MB3,F]  331-14-346ms   | [S2,MB2,B]  378-36-414ms   | [S2,MB4,F]  421-15-437ms   | [S2,MB3,B]  466-36-503ms   | [S2,MB5,F]  510-15-525ms   | [S2,MB4,B]  555-36-591ms   | [S2,MB6,F]  599-15-614ms   | [S2,MB5,B]  644-36-680ms   | [S2,MB7,F]  688-15-703ms   | [S2,MB6,B]  733-36-769ms   | [S2,MB7,B]  819-18-837ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-71-278ms   | [S3,MB2,F]  284-25-310ms   | [S3,MB2,B]  322-44-366ms   | [S3,MB3,F]  374-25-400ms   | [S3,MB3,B]  411-44-456ms   | [S3,MB4,F]  463-26-489ms   | [S3,MB4,B]  501-44-545ms   | [S3,MB5,F]  552-25-578ms   | [S3,MB5,B]  590-44-634ms   | [S3,MB6,F]  641-25-667ms   | [S3,MB6,B]  679-44-723ms   | [S3,MB7,F]  730-25-756ms   | [S3,MB7,B]  768-44-812ms  
[rank3]:2025-12-30 21:29:31,941 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/pipeline_schedule/251230_2129_thry_final800_rank3.svg
[rank3]:			> Batch Time: 638.04 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-58ms     | [S0,MB3,F]  58-19-77ms     | [S0,MB0,B]  193-38-232ms   | [S0,MB4,F]  232-19-251ms   | [S0,MB1,B]  251-38-290ms   | [S0,MB5,F]  290-19-309ms   | [S0,MB2,B]  309-38-348ms   | [S0,MB6,F]  348-19-367ms   | [S0,MB3,B]  367-38-406ms   | [S0,MB7,F]  406-19-425ms   | [S0,MB4,B]  425-38-464ms   | [S0,MB5,B]  483-38-522ms   | [S0,MB6,B]  541-38-580ms   | [S0,MB7,B]  599-38-638ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-77ms     | [S1,MB0,B]  154-38-193ms   | [S1,MB3,F]  193-19-212ms   | [S1,MB1,B]  212-38-251ms   | [S1,MB4,F]  251-19-270ms   | [S1,MB2,B]  270-38-309ms   | [S1,MB5,F]  309-19-328ms   | [S1,MB3,B]  328-38-367ms   | [S1,MB6,F]  367-19-386ms   | [S1,MB4,B]  386-38-425ms   | [S1,MB7,F]  425-19-444ms   | [S1,MB5,B]  444-38-483ms   | [S1,MB6,B]  502-38-541ms   | [S1,MB7,B]  560-38-599ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-58ms     | [S2,MB1,F]  58-19-77ms     | [S2,MB0,B]  116-38-154ms   | [S2,MB2,F]  154-19-174ms   | [S2,MB1,B]  174-38-212ms   | [S2,MB3,F]  212-19-232ms   | [S2,MB2,B]  232-38-270ms   | [S2,MB4,F]  270-19-290ms   | [S2,MB3,B]  290-38-328ms   | [S2,MB5,F]  328-19-348ms   | [S2,MB4,B]  348-38-386ms   | [S2,MB6,F]  386-19-406ms   | [S2,MB5,B]  406-38-444ms   | [S2,MB7,F]  444-19-464ms   | [S2,MB6,B]  464-38-502ms   | [S2,MB7,B]  522-38-560ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  58-19-77ms     | [S3,MB0,B]  77-38-116ms    | [S3,MB1,F]  116-19-135ms   | [S3,MB1,B]  135-38-174ms   | [S3,MB2,F]  174-19-193ms   | [S3,MB2,B]  193-38-232ms   | [S3,MB3,F]  232-19-251ms   | [S3,MB3,B]  251-38-290ms   | [S3,MB4,F]  290-19-309ms   | [S3,MB4,B]  309-38-348ms   | [S3,MB5,F]  348-19-367ms   | [S3,MB5,B]  367-38-406ms   | [S3,MB6,F]  406-19-425ms   | [S3,MB6,B]  425-38-464ms   | [S3,MB7,F]  464-19-483ms   | [S3,MB7,B]  483-38-522ms  
[rank3]:2025-12-30 21:29:31,989 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_2129_stage3_final800.svg
[rank3]:2025-12-30 21:29:32,119 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/frozen_params_histogram/251230_2129_rank3_stage3.svg
[rank3]:	> Counts Sum: 516080, Total Sum: 668160 (77.24%), Ratio(%) per element: [80.72, 80.55, 81.42, 79.34, 80.55, 80.38, 81.94, 68.22, 67.88, 80.55, 80.55, 81.25, 80.38, 80.03, 80.55, 81.07, 68.57, 68.22, 79.68, 82.11, 81.77, 79.86, 81.59, 80.55, 81.42, 68.05, 67.18, 67.53, 67.88]
[rank2]:2025-12-30 21:29:32,763 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2129_stage2.svg
[rank2]:2025-12-30 21:29:32,765 - Destroying the purge thread.
[rank1]:2025-12-30 21:29:32,785 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2129_stage1.svg
[rank1]:2025-12-30 21:29:32,787 - Destroying the purge thread.
[rank0]:2025-12-30 21:29:32,817 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2129_stage0.svg
[rank0]:2025-12-30 21:29:32,819 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-30 21:29:33,060 - Process group destroyed
[rank1]:2025-12-30 21:29:33,048 - Process group destroyed
[rank3]:2025-12-30 21:29:33,043 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1/afr_time_plot/251230_2129_stage3.svg
[rank3]:2025-12-30 21:29:33,046 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 316-337
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.57336
[rank3]:wandb:               final/avg_loss 0.23553
[rank3]:wandb:             final/avg_mfu(%) 21.14403
[rank3]:wandb:             final/avg_tflops 71.68753
[rank3]:wandb:    final/avg_throughput(tps) 9170.08887
[rank3]:wandb:              final/grad_norm 0.17463
[rank3]:wandb:               final/max_loss 0.23553
[rank3]:wandb:                    grad_norm 0.17463
[rank3]:wandb: loss_metrics/global_avg_loss 0.23553
[rank3]:wandb: loss_metrics/global_max_loss 0.23553
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_1F1B_timelyapf_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/0glpi68b
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_1F1B_timelyapf_22_dm1/20251230-2038/wandb/run-20251230_203851-0glpi68b/logs
[rank3]:2025-12-30 21:29:34,552 - Process group destroyed
[rank0]:2025-12-30 21:29:34,819 - Training completed
[rank0]:2025-12-30 21:29:34,820 - Destroying the purge thread.
[rank0]:2025-12-30 21:29:35,121 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'tok_embeddings', 'layers.3', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.6', 'layers.7', 'layers.8', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'layers.14', 'output', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_1F1B_timelyapf_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_1F1B_timelyapf_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_1F1B_timelyapf_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_1F1B_timelyapf_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_1F1B_timelyapf_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_1F1B_timelyapf_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_1F1B_timelyapf_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_1F1B_timelyapf_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
