
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 26. (ê¸ˆ) 15:23:45 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with timelyapf x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-26 15:23:51,561 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank3]:2025-12-26 15:23:51,561 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank1]:2025-12-26 15:23:51,646 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank2]:2025-12-26 15:23:51,658 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank0]:2025-12-26 15:23:51,865 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-26 15:23:51,867 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 15:23:51,871 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-26 15:23:51,872 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-26 15:23:51,907 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-26 15:23:51,909 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-26 15:23:52,055 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-26 15:23:52,058 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-26 15:23:52,067 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-26 15:23:52,072 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 15:23:52,272 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-26 15:23:55,576 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-26 15:23:55,550 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-26 15:23:55,600 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 15:23:55,615 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 15:23:55,640 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-26 15:23:55,653 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-26 15:23:55,655 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-26 15:23:55,626 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-26 15:23:55,660 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 15:23:55,686 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-26 15:23:55,700 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-26 15:23:55,702 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-26 15:23:55,626 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-26 15:23:55,639 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-26 15:23:55,640 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-26 15:23:55,741 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:2025-12-26 15:23:55,888 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 15:23:55,896 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 15:23:55,897 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-26 15:23:55,888 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-26 15:23:55,889 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-26 15:23:55,898 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-26 15:23:55,848 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 15:23:55,848 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-26 15:23:55,849 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run kvhz28ed
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyapf_42_dm1/20251226-1523/wandb/run-20251226_152357-kvhz28ed
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_timelyapf_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/kvhz28ed
[rank0]:2025-12-26 15:23:58,258 - WandB logging enabled
[rank0]:2025-12-26 15:23:58,258 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-26 15:23:58,296 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 15:23:58,298 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-26 15:23:58,325 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-26 15:23:58,338 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-26 15:23:58,340 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-26 15:23:58,546 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 15:23:58,547 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-26 15:23:58,548 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-26 15:23:58,563 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank0]:2025-12-26 15:23:58,564 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 15:23:58,565 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-26 15:23:58,565 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-26 15:23:58,564 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-26 15:23:58,564 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-26 15:23:58,564 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 15:24:02,025 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-26 15:24:02,026 - Finished loading the checkpoint in 3.46 seconds.
[rank0]:2025-12-26 15:24:02,026 - Training starts at step 1
[rank1]:2025-12-26 15:24:07,160 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 15.58GiB(32.80%)  tps: 2,838  tflops: 22.19  mfu: 7.11%
[rank1]:2025-12-26 15:24:07,160 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-26 15:24:07,147 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 13.45GiB(28.31%)  tps: 2,853  tflops: 22.30  mfu: 7.15%
[rank3]:2025-12-26 15:24:07,147 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-26 15:24:07,147 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 11.98GiB(25.23%)  tps: 2,838  tflops: 22.19  mfu: 7.11%
[rank2]:2025-12-26 15:24:07,155 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 15:24:07,199 -  step:  1  loss: 10.6092  grad_norm: 203.0663  memory: 30.01GiB(63.17%)  tps: 3,682  tflops: 28.78  mfu: 9.22%
[rank0]:2025-12-26 15:24:07,199 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 15:27:49,568 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 15:27:54,362 - Avg. fwd time: 8.1892 / Avg. bwd-weight time: 10.0398 / Avg. bwd-input time: 10.0430 / Avg. batch time: 1059.3275 (ms) / GPU bubble ratio: 57.30%
[rank3]:2025-12-26 15:27:54,369 - Avg. fwd time: 7.7945 / Avg. bwd-weight time: 9.8476 / Avg. bwd-input time: 9.6171 / Avg. batch time: 1055.9353 (ms) / GPU bubble ratio: 58.70%
[rank0]:2025-12-26 15:27:54,393 - Avg. fwd time: 13.7111 / Avg. full-bwd time: 29.0936 (Avg. bwd-weight time: 30.2094 / Avg. bwd-input time: 34.5805) / Avg. batch time: 1117.6715 (ms) / GPU bubble ratio: 13.17%
[rank1]:2025-12-26 15:27:54,382 - Avg. fwd time: 9.8787 / Avg. bwd-weight time: 12.9530 / Avg. bwd-input time: 12.2095 / Avg. batch time: 1095.0303 (ms) / GPU bubble ratio: 48.80%
[rank2]:2025-12-26 15:27:54,439 -  step: 50  loss: -4.0000  grad_norm: 23.9310  memory: 13.80GiB(29.05%)  tps: 7,064  tflops: 55.23  mfu: 17.70%
[rank3]:2025-12-26 15:27:54,439 -  step: 50  loss: -4.0000  grad_norm: 23.9310  memory: 15.27GiB(32.13%)  tps: 7,064  tflops: 55.22  mfu: 17.70%
[rank0]:2025-12-26 15:27:54,466 -  step: 50  loss:  9.8846  grad_norm: 23.9310  memory: 35.32GiB(74.36%)  tps: 7,065  tflops: 55.23  mfu: 17.70%
[rank1]:2025-12-26 15:27:54,443 -  step: 50  loss: -4.0000  grad_norm: 23.9310  memory: 17.83GiB(37.53%)  tps: 7,064  tflops: 55.23  mfu: 17.70%
[rank3]:2025-12-26 15:28:36,427 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-12-26 15:29:22,799 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-26 15:29:22,990 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-26 15:29:22,998 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-26 15:29:23,012 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-26 15:30:09,845 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-26 15:30:09,973 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-12-26 15:31:17,072 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 15:31:17,704 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank1]:2025-12-26 15:31:17,805 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.11/0.11, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 15:31:17,822 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.90/0.90, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.50/0.50, [MB4] 0.68/0.68, [MB5] 0.33/0.33, [MB6] 0.39/0.39, [MB7] 1.00/1.00
[rank2]:2025-12-26 15:31:17,805 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.30/0.30, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.45/0.45, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-26 15:31:18,143 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1531_max_batch_time.svg
[rank3]:			> Batch Time: 996.61 ms, GPU Bubble Ratio: 1.30%, 43.56%, 54.41%, 56.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-26-151ms   | [S7,MB1,F]  151-17-168ms   | [S7,MB1,BI] 168-34-203ms   | [S7,MB1,BW] 203-30-234ms   | [S7,MB2,F]  234-19-254ms   | [S7,MB2,BI] 254-35-289ms   | [S7,MB2,BW] 289-31-320ms   | [S7,MB3,F]  320-19-340ms   | [S7,MB3,BI] 340-35-375ms   | [S7,MB3,BW] 375-32-408ms   | [S0,MB7,F]  408-10-418ms   | [S0,MB0,B]  418-30-449ms   | [S7,MB4,F]  449-19-468ms   | [S7,MB4,BI] 468-35-503ms   | [S7,MB4,BW] 503-31-535ms   | [S0,MB1,B]  535-30-565ms   | [S7,MB5,F]  565-18-584ms   | [S7,MB5,BI] 584-34-619ms   | [S7,MB5,BW] 619-31-651ms   | [S0,MB2,B]  651-30-681ms   | [S7,MB6,F]  681-18-700ms   | [S7,MB6,BI] 700-34-734ms   | [S7,MB6,BW] 734-30-765ms   | [S0,MB3,B]  765-29-795ms   | [S7,MB7,F]  795-18-814ms   | [S7,MB7,BI] 814-34-849ms   | [S7,MB7,BW] 849-31-880ms   | [S0,MB4,B]  880-30-910ms   | [S0,MB5,B]  910-29-939ms   | [S0,MB6,B]  939-28-968ms   | [S0,MB7,B]  968-27-996ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-145ms   | [S6,MB2,F]  145-7-152ms    | [S6,MB1,BI] 203-9-212ms    | [S6,MB1,BW] 212-10-223ms   | [S6,MB3,F]  223-7-230ms    | [S6,MB2,BI] 289-9-298ms    | [S6,MB2,BW] 298-10-309ms   | [S1,MB6,F]  309-10-320ms   | [S1,MB0,BI] 320-15-336ms   | [S1,MB0,BW] 336-15-351ms   | [S6,MB4,F]  351-8-359ms    | [S6,MB3,BI] 375-10-386ms   | [S6,MB3,BW] 386-9-395ms    | [S1,MB7,F]  418-13-431ms   | [S1,MB1,BI] 431-15-447ms   | [S1,MB1,BW] 447-14-462ms   | [S6,MB5,F]  462-7-469ms    | [S6,MB4,BI] 503-10-513ms   | [S6,MB4,BW] 513-9-523ms    | [S1,MB2,BI] 523-14-537ms   | [S1,MB2,BW] 537-14-552ms   | [S6,MB6,F]  552-7-559ms    | [S6,MB5,BI] 619-9-628ms    | [S6,MB5,BW] 628-10-639ms   | [S1,MB3,BI] 639-14-654ms   | [S1,MB3,BW] 654-14-668ms   | [S6,MB7,F]  668-7-676ms    | [S6,MB6,BI] 734-9-744ms    | [S6,MB6,BW] 744-11-755ms   | [S1,MB4,BI] 755-14-770ms   | [S6,MB7,BI] 849-10-859ms   | [S1,MB5,BI] 859-15-874ms   | [S1,MB4,BW] 874-15-890ms   | [S1,MB6,BI] 890-14-905ms   | [S1,MB5,BW] 905-15-920ms   | [S1,MB7,BI] 920-15-936ms   | [S1,MB6,BW] 936-16-952ms   | [S6,MB7,BW] 952-11-963ms   | [S1,MB7,BW] 963-16-980ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-144ms    | [S5,MB0,BW] 144-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 212-9-222ms    | [S5,MB1,BW] 222-10-233ms   | [S2,MB5,F]  233-7-240ms    | [S2,MB0,BI] 240-10-251ms   | [S2,MB0,BW] 251-9-261ms    | [S5,MB4,F]  261-7-268ms    | [S5,MB2,BI] 298-10-308ms   | [S5,MB2,BW] 308-9-318ms    | [S2,MB6,F]  320-9-330ms    | [S2,MB1,BI] 330-10-340ms   | [S2,MB1,BW] 340-9-350ms    | [S5,MB5,F]  350-7-358ms    | [S5,MB3,BI] 386-11-397ms   | [S5,MB3,BW] 397-11-408ms   | [S2,MB7,F]  431-7-439ms    | [S2,MB2,BI] 439-10-449ms   | [S2,MB2,BW] 449-9-459ms    | [S5,MB6,F]  459-7-467ms    | [S5,MB4,BI] 513-10-524ms   | [S5,MB4,BW] 524-9-534ms    | [S2,MB3,BI] 534-9-543ms    | [S2,MB3,BW] 543-10-553ms   | [S5,MB7,F]  553-7-561ms    | [S5,MB5,BI] 628-9-638ms    | [S5,MB5,BW] 638-9-648ms    | [S2,MB4,BI] 648-9-657ms    | [S5,MB6,BI] 744-10-754ms   | [S2,MB5,BI] 754-10-765ms   | [S5,MB7,BI] 859-9-869ms    | [S2,MB6,BI] 869-11-880ms   | [S2,MB4,BW] 880-10-890ms   | [S2,MB7,BI] 890-9-899ms    | [S2,MB5,BW] 899-10-910ms   | [S5,MB6,BW] 910-9-919ms    | [S5,MB7,BW] 919-9-929ms    | [S2,MB6,BW] 929-9-939ms    | [S2,MB7,BW] 939-10-950ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 144-9-153ms    | [S4,MB0,BW] 153-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-179ms    | [S3,MB0,BW] 179-9-189ms    AFR(10):1.0000 | [S4,MB4,F]  189-7-196ms    | [S4,MB1,BI] 222-10-232ms   | [S4,MB1,BW] 232-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-250ms    | [S3,MB1,BI] 250-9-260ms    | [S3,MB1,BW] 260-9-270ms    AFR(10):1.0000 | [S4,MB5,F]  270-7-277ms    | [S4,MB2,BI] 308-11-319ms   | [S4,MB2,BW] 319-9-329ms    AFR(10):1.0000 | [S3,MB6,F]  330-7-337ms    | [S3,MB2,BI] 337-9-346ms    | [S3,MB2,BW] 346-9-356ms    AFR(10):1.0000 | [S4,MB6,F]  356-7-364ms    | [S4,MB3,BI] 397-10-407ms   | [S4,MB3,BW] 407-10-417ms   AFR(10):1.0000 | [S3,MB7,F]  439-7-446ms    | [S3,MB3,BI] 446-9-456ms    | [S3,MB3,BW] 456-9-465ms    AFR(10):1.0000 | [S4,MB7,F]  465-7-473ms    | [S4,MB4,BI] 524-10-534ms   | [S4,MB4,BW] 534-9-544ms    AFR(10):1.0000 | [S3,MB4,BI] 544-10-554ms   | [S4,MB5,BI] 638-10-648ms   | [S3,MB5,BI] 648-9-657ms    | [S4,MB6,BI] 754-9-764ms    | [S3,MB6,BI] 764-9-773ms    | [S4,MB7,BI] 869-9-878ms    | [S3,MB7,BI] 878-9-887ms    | [S3,MB4,BW] 887-10-897ms   AFR(10):1.0000 | [S4,MB5,BW] 897-9-907ms    AFR(10):1.0000 | [S4,MB6,BW] 907-9-916ms    AFR(10):1.0000 | [S4,MB7,BW] 916-9-926ms    AFR(10):1.0000 | [S3,MB5,BW] 926-10-936ms   AFR(10):1.0000 | [S3,MB6,BW] 936-10-947ms   AFR(10):1.0000 | [S3,MB7,BW] 947-10-958ms   AFR(10):1.0000
[rank3]:2025-12-26 15:31:18,442 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1531_min_batch_time.svg
[rank3]:			> Batch Time: 641.93 ms, GPU Bubble Ratio: 11.72%, 44.90%, 54.48%, 56.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-19-144ms   | [S7,MB1,F]  144-17-161ms   | [S7,MB1,BI] 161-34-196ms   | [S7,MB1,BW] 196-0-196ms    | [S7,MB2,F]  196-19-216ms   | [S7,MB2,BI] 216-35-251ms   | [S7,MB2,BW] 251-22-274ms   | [S7,MB3,F]  274-19-293ms   | [S7,MB3,BI] 293-35-329ms   | [S7,MB3,BW] 329-23-352ms   | [S0,MB7,F]  352-10-363ms   | [S0,MB0,B]  363-0-363ms    | [S7,MB4,F]  363-19-382ms   | [S7,MB4,BI] 382-35-417ms   | [S7,MB4,BW] 417-0-417ms    | [S0,MB1,B]  417-0-417ms    | [S7,MB5,F]  417-18-436ms   | [S7,MB5,BI] 436-34-471ms   | [S7,MB5,BW] 471-0-471ms    | [S0,MB2,B]  471-0-471ms    | [S7,MB6,F]  471-18-490ms   | [S7,MB6,BI] 490-34-525ms   | [S7,MB6,BW] 525-0-525ms    | [S0,MB3,B]  525-0-525ms    | [S7,MB7,F]  525-18-544ms   | [S7,MB7,BI] 544-34-579ms   | [S7,MB7,BW] 579-0-579ms    | [S0,MB4,B]  579-0-579ms    | [S0,MB5,B]  604-0-604ms    | [S0,MB6,B]  624-0-624ms    | [S0,MB7,B]  641-0-641ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-0-134ms    | [S6,MB2,F]  134-7-142ms    | [S6,MB1,BI] 196-9-205ms    | [S6,MB1,BW] 205-0-205ms    | [S6,MB3,F]  205-7-213ms    | [S6,MB2,BI] 251-9-260ms    | [S6,MB2,BW] 260-0-260ms    | [S1,MB6,F]  260-10-271ms   | [S1,MB0,BI] 271-15-287ms   | [S1,MB0,BW] 287-0-287ms    | [S6,MB4,F]  287-8-295ms    | [S6,MB3,BI] 329-10-339ms   | [S6,MB3,BW] 339-0-339ms    | [S1,MB7,F]  363-13-376ms   | [S1,MB1,BI] 376-15-392ms   | [S1,MB1,BW] 392-0-392ms    | [S6,MB5,F]  392-7-399ms    | [S6,MB4,BI] 417-10-427ms   | [S6,MB4,BW] 427-0-427ms    | [S1,MB2,BI] 427-14-441ms   | [S1,MB2,BW] 441-0-441ms    | [S6,MB6,F]  441-7-449ms    | [S6,MB5,BI] 471-9-481ms    | [S6,MB5,BW] 481-0-481ms    | [S1,MB3,BI] 481-14-495ms   | [S1,MB3,BW] 495-0-495ms    | [S6,MB7,F]  495-7-502ms    | [S6,MB6,BI] 525-9-534ms    | [S6,MB6,BW] 534-0-534ms    | [S1,MB4,BI] 534-14-549ms   | [S6,MB7,BI] 579-10-589ms   | [S1,MB5,BI] 589-15-604ms   | [S1,MB4,BW] 604-0-604ms    | [S1,MB6,BI] 610-14-624ms   | [S1,MB5,BW] 624-0-624ms    | [S1,MB7,BI] 626-15-641ms   | [S1,MB6,BW] 641-0-641ms    | [S6,MB7,BW] 641-0-641ms    | [S1,MB7,BW] 641-0-641ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-144ms    | [S5,MB0,BW] 144-0-144ms    | [S5,MB3,F]  144-7-151ms    | [S5,MB1,BI] 205-9-215ms    | [S5,MB1,BW] 215-0-215ms    | [S2,MB5,F]  215-7-222ms    | [S2,MB0,BI] 222-10-233ms   | [S2,MB0,BW] 233-0-233ms    | [S5,MB4,F]  233-7-241ms    | [S5,MB2,BI] 260-10-270ms   | [S5,MB2,BW] 270-0-270ms    | [S2,MB6,F]  271-9-281ms    | [S2,MB1,BI] 281-10-292ms   | [S2,MB1,BW] 292-0-292ms    | [S5,MB5,F]  292-7-299ms    | [S5,MB3,BI] 339-11-350ms   | [S5,MB3,BW] 350-0-350ms    | [S2,MB7,F]  376-7-384ms    | [S2,MB2,BI] 384-10-394ms   | [S2,MB2,BW] 394-0-394ms    | [S5,MB6,F]  394-7-402ms    | [S5,MB4,BI] 427-10-438ms   | [S5,MB4,BW] 438-0-438ms    | [S2,MB3,BI] 438-9-447ms    | [S2,MB3,BW] 447-0-447ms    | [S5,MB7,F]  447-7-455ms    | [S5,MB5,BI] 481-9-490ms    | [S5,MB5,BW] 490-0-490ms    | [S2,MB4,BI] 490-9-499ms    | [S5,MB6,BI] 534-10-545ms   | [S2,MB5,BI] 545-10-555ms   | [S5,MB7,BI] 589-9-599ms    | [S2,MB6,BI] 599-11-610ms   | [S2,MB4,BW] 610-0-610ms    | [S2,MB7,BI] 617-9-626ms    | [S2,MB5,BW] 626-0-626ms    | [S5,MB6,BW] 626-0-626ms    | [S5,MB7,BW] 626-0-626ms    | [S2,MB6,BW] 626-0-626ms    | [S2,MB7,BW] 626-0-626ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 144-9-153ms    | [S4,MB0,BW] 153-0-153ms    AFR(10):1.0000 | [S3,MB4,F]  153-7-160ms    | [S3,MB0,BI] 160-9-169ms    | [S3,MB0,BW] 169-0-169ms    AFR(10):1.0000 | [S4,MB4,F]  169-7-177ms    | [S4,MB1,BI] 215-10-225ms   | [S4,MB1,BW] 225-0-225ms    AFR(10):1.0000 | [S3,MB5,F]  225-8-233ms    | [S3,MB1,BI] 233-9-242ms    | [S3,MB1,BW] 242-0-242ms    AFR(10):1.0000 | [S4,MB5,F]  242-7-250ms    | [S4,MB2,BI] 270-11-281ms   | [S4,MB2,BW] 281-0-281ms    AFR(10):1.0000 | [S3,MB6,F]  281-7-289ms    | [S3,MB2,BI] 289-9-298ms    | [S3,MB2,BW] 298-0-298ms    AFR(10):1.0000 | [S4,MB6,F]  298-7-306ms    | [S4,MB3,BI] 350-10-360ms   | [S4,MB3,BW] 360-0-360ms    AFR(10):1.0000 | [S3,MB7,F]  384-7-391ms    | [S3,MB3,BI] 391-9-400ms    | [S3,MB3,BW] 400-0-400ms    AFR(10):1.0000 | [S4,MB7,F]  400-7-408ms    | [S4,MB4,BI] 438-10-448ms   | [S4,MB4,BW] 448-0-448ms    AFR(10):1.0000 | [S3,MB4,BI] 448-10-458ms   | [S4,MB5,BI] 490-10-500ms   | [S3,MB5,BI] 500-9-509ms    | [S4,MB6,BI] 545-9-554ms    | [S3,MB6,BI] 554-9-563ms    | [S4,MB7,BI] 599-9-608ms    | [S3,MB7,BI] 608-9-617ms    | [S3,MB4,BW] 617-0-617ms    AFR(10):1.0000 | [S4,MB5,BW] 617-0-617ms    AFR(10):1.0000 | [S4,MB6,BW] 617-0-617ms    AFR(10):1.0000 | [S4,MB7,BW] 617-0-617ms    AFR(10):1.0000 | [S3,MB5,BW] 617-0-617ms    AFR(10):1.0000 | [S3,MB6,BW] 617-0-617ms    AFR(10):1.0000 | [S3,MB7,BW] 617-0-617ms    AFR(10):1.0000
[rank3]:2025-12-26 15:31:18,812 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1531_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 649.86 ms, GPU Bubble Ratio: 1.99%, 24.71%, 35.94%, 39.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-26-151ms   | [S7,MB1,F]  151-17-168ms   | [S7,MB1,BI] 168-34-203ms   | [S7,MB1,BW] 203-0-203ms    | [S7,MB2,F]  203-19-223ms   | [S7,MB2,BI] 223-35-258ms   | [S7,MB2,BW] 258-23-282ms   | [S7,MB3,F]  282-19-301ms   | [S7,MB3,BI] 301-35-337ms   | [S7,MB3,BW] 337-23-360ms   | [S0,MB7,F]  360-10-371ms   | [S0,MB0,B]  371-0-371ms    | [S7,MB4,F]  371-19-390ms   | [S7,MB4,BI] 390-35-425ms   | [S7,MB4,BW] 425-0-425ms    | [S0,MB1,B]  425-0-425ms    | [S7,MB5,F]  425-18-444ms   | [S7,MB5,BI] 444-34-479ms   | [S7,MB5,BW] 479-0-479ms    | [S0,MB2,B]  479-0-479ms    | [S7,MB6,F]  479-18-498ms   | [S7,MB6,BI] 498-34-533ms   | [S7,MB6,BW] 533-0-533ms    | [S0,MB3,B]  533-0-533ms    | [S7,MB7,F]  533-18-552ms   | [S7,MB7,BI] 552-34-587ms   | [S7,MB7,BW] 587-15-603ms   | [S0,MB4,B]  603-9-612ms    | [S0,MB5,B]  612-19-632ms   | [S0,MB6,B]  632-17-649ms   | [S0,MB7,B]  649-0-649ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-145ms   | [S6,MB2,F]  145-7-152ms    | [S6,MB1,BI] 203-9-212ms    | [S6,MB1,BW] 212-10-223ms   | [S6,MB3,F]  223-7-230ms    | [S6,MB2,BI] 258-9-267ms    | [S6,MB2,BW] 267-10-278ms   | [S1,MB6,F]  278-10-289ms   | [S1,MB0,BI] 289-15-305ms   | [S1,MB0,BW] 305-15-320ms   | [S6,MB4,F]  320-8-328ms    | [S6,MB3,BI] 337-10-347ms   | [S6,MB3,BW] 347-9-357ms    | [S1,MB7,F]  371-13-384ms   | [S1,MB1,BI] 384-15-399ms   | [S1,MB1,BW] 399-14-414ms   | [S6,MB5,F]  414-7-422ms    | [S6,MB4,BI] 425-10-435ms   | [S6,MB4,BW] 435-9-445ms    | [S1,MB2,BI] 445-14-459ms   | [S1,MB2,BW] 459-12-472ms   | [S6,MB6,F]  472-7-479ms    | [S6,MB5,BI] 479-9-489ms    | [S6,MB5,BW] 489-10-500ms   | [S1,MB3,BI] 500-14-514ms   | [S1,MB3,BW] 514-11-526ms   | [S6,MB7,F]  526-7-533ms    | [S6,MB6,BI] 533-9-543ms    | [S6,MB6,BW] 543-11-554ms   | [S1,MB4,BI] 554-14-568ms   | [S6,MB7,BI] 587-10-597ms   | [S1,MB5,BI] 597-15-612ms   | [S1,MB4,BW] 612-5-618ms    | [S1,MB6,BI] 618-14-632ms   | [S1,MB5,BW] 632-2-634ms    | [S1,MB7,BI] 634-15-649ms   | [S1,MB6,BW] 649-0-649ms    | [S6,MB7,BW] 649-0-649ms    | [S1,MB7,BW] 649-0-649ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-144ms    | [S5,MB0,BW] 144-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 212-9-222ms    | [S5,MB1,BW] 222-10-233ms   | [S2,MB5,F]  233-7-240ms    | [S2,MB0,BI] 240-10-251ms   | [S2,MB0,BW] 251-9-261ms    | [S5,MB4,F]  261-7-268ms    | [S5,MB2,BI] 268-10-279ms   | [S5,MB2,BW] 279-9-289ms    | [S2,MB6,F]  289-9-299ms    | [S2,MB1,BI] 299-10-310ms   | [S2,MB1,BW] 310-9-320ms    | [S5,MB5,F]  320-7-327ms    | [S5,MB3,BI] 347-11-358ms   | [S5,MB3,BW] 358-11-369ms   | [S2,MB7,F]  384-7-391ms    | [S2,MB2,BI] 391-10-402ms   | [S2,MB2,BW] 402-9-412ms    | [S5,MB6,F]  412-7-420ms    | [S5,MB4,BI] 435-10-446ms   | [S5,MB4,BW] 446-9-456ms    | [S2,MB3,BI] 456-9-465ms    | [S2,MB3,BW] 465-10-475ms   | [S5,MB7,F]  475-7-483ms    | [S5,MB5,BI] 489-9-498ms    | [S5,MB5,BW] 498-9-508ms    | [S2,MB4,BI] 508-9-517ms    | [S5,MB6,BI] 543-10-553ms   | [S2,MB5,BI] 553-10-563ms   | [S5,MB7,BI] 597-9-607ms    | [S2,MB6,BI] 607-11-618ms   | [S2,MB4,BW] 618-7-625ms    | [S2,MB7,BI] 625-9-634ms    | [S2,MB5,BW] 634-0-634ms    | [S5,MB6,BW] 634-9-644ms    | [S5,MB7,BW] 644-5-649ms    | [S2,MB6,BW] 649-0-649ms    | [S2,MB7,BW] 649-0-649ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 144-9-153ms    | [S4,MB0,BW] 153-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-179ms    | [S3,MB0,BW] 179-9-189ms    AFR(10):1.0000 | [S4,MB4,F]  189-7-196ms    | [S4,MB1,BI] 222-10-232ms   | [S4,MB1,BW] 232-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-250ms    | [S3,MB1,BI] 250-9-260ms    | [S3,MB1,BW] 260-9-270ms    AFR(10):1.0000 | [S4,MB5,F]  270-7-277ms    | [S4,MB2,BI] 279-11-290ms   | [S4,MB2,BW] 290-9-299ms    AFR(10):1.0000 | [S3,MB6,F]  299-7-307ms    | [S3,MB2,BI] 307-9-316ms    | [S3,MB2,BW] 316-9-326ms    AFR(10):1.0000 | [S4,MB6,F]  326-7-334ms    | [S4,MB3,BI] 358-10-368ms   | [S4,MB3,BW] 368-10-379ms   AFR(10):1.0000 | [S3,MB7,F]  391-7-399ms    | [S3,MB3,BI] 399-9-408ms    | [S3,MB3,BW] 408-9-418ms    AFR(10):1.0000 | [S4,MB7,F]  418-7-426ms    | [S4,MB4,BI] 446-10-456ms   | [S4,MB4,BW] 456-9-466ms    AFR(10):1.0000 | [S3,MB4,BI] 466-10-476ms   | [S4,MB5,BI] 498-10-508ms   | [S3,MB5,BI] 508-9-517ms    | [S4,MB6,BI] 553-9-562ms    | [S3,MB6,BI] 562-9-571ms    | [S4,MB7,BI] 607-9-616ms    | [S3,MB7,BI] 616-9-625ms    | [S3,MB4,BW] 625-0-625ms    AFR(10):1.0000 | [S4,MB5,BW] 625-9-634ms    AFR(10):1.0000 | [S4,MB6,BW] 634-9-644ms    AFR(10):1.0000 | [S4,MB7,BW] 644-5-649ms    AFR(10):1.0000 | [S3,MB5,BW] 649-0-649ms    AFR(10):1.0000 | [S3,MB6,BW] 649-0-649ms    AFR(10):1.0000 | [S3,MB7,BW] 649-0-649ms    AFR(10):1.0000
[rank3]:2025-12-26 15:31:18,812 - 	> Batch Time: 649.86 ms (Average Freeze Ratio: 0.40, Time Reduction Rate: 0.35)
[rank3]:2025-12-26 15:31:18,814 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.46/0.46, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 15:31:22,075 - Avg. fwd time: 13.6086 / Avg. full-bwd time: 23.1704 (Avg. bwd-weight time: 25.2158 / Avg. bwd-input time: 34.5129) / Avg. batch time: 1059.5561 (ms) / GPU bubble ratio: 16.86%
[rank2]:2025-12-26 15:31:22,070 - Avg. fwd time: 8.2344 / Avg. bwd-weight time: 8.0283 / Avg. bwd-input time: 10.0526 / Avg. batch time: 1003.1537 (ms) / GPU bubble ratio: 58.03%
[rank3]:2025-12-26 15:31:22,071 - Avg. fwd time: 7.7683 / Avg. bwd-weight time: 7.8742 / Avg. bwd-input time: 9.6303 / Avg. batch time: 993.2733 (ms) / GPU bubble ratio: 59.29%
[rank1]:2025-12-26 15:31:22,072 - Avg. fwd time: 9.9107 / Avg. bwd-weight time: 10.3461 / Avg. bwd-input time: 12.2408 / Avg. batch time: 1038.0859 (ms) / GPU bubble ratio: 49.91%
[rank1]:2025-12-26 15:31:22,124 -  step: 100  loss: -4.0000  grad_norm:  3.7930  memory: 18.98GiB(39.95%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank0]:2025-12-26 15:31:22,148 -  step: 100  loss:  8.8197  grad_norm:  3.7930  memory: 40.23GiB(84.68%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank2]:2025-12-26 15:31:22,121 -  step: 100  loss: -4.0000  grad_norm:  3.7930  memory: 14.70GiB(30.94%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank3]:2025-12-26 15:31:22,121 -  step: 100  loss: -4.0000  grad_norm:  3.7930  memory: 16.18GiB(34.07%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank1]:2025-12-26 15:31:22,211 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1531_stage1_step100.svg
[rank1]:2025-12-26 15:31:22,250 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1531_stage6_step100.svg
[rank0]:2025-12-26 15:31:22,212 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1531_stage0_step100.svg
[rank0]:2025-12-26 15:31:22,250 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1531_stage7_step100.svg
[rank2]:2025-12-26 15:31:22,221 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1531_stage2_step100.svg
[rank2]:2025-12-26 15:31:22,260 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1531_stage5_step100.svg
[rank0]:2025-12-26 15:31:22,360 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank0_stage0.svg
[rank0]:	> Counts Sum: 12160, Total Sum: 12160 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-26 15:31:22,365 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank2_stage2.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-26 15:31:22,382 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank1_stage1.svg
[rank1]:	> Counts Sum: 17280, Total Sum: 17280 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-26 15:31:22,442 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank0_stage7.svg
[rank0]:	> Counts Sum: 6400, Total Sum: 7040 (90.91%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 81.25, 68.75, 75.0, 75.0]
[rank2]:2025-12-26 15:31:22,464 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-26 15:31:22,438 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1531_step100_rank3.svg
[rank3]:			> Batch Time: 795.00 ms, GPU Bubble Ratio: 36.99%, 54.99%, 62.89%, 65.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-0-174ms    | [S7,MB1,F]  174-16-190ms   | [S7,MB1,BI] 203-33-237ms   | [S7,MB1,BW] 237-21-258ms   | [S7,MB2,F]  259-18-278ms   | [S7,MB2,BI] 290-35-325ms   | [S7,MB2,BW] 325-0-325ms    | [S7,MB3,F]  325-18-343ms   | [S7,MB3,BI] 355-35-391ms   | [S7,MB3,BW] 391-0-391ms    | [S0,MB7,F]  391-10-402ms   | [S0,MB0,B]  402-0-402ms    | [S7,MB4,F]  410-18-428ms   | [S7,MB4,BI] 440-33-474ms   | [S7,MB4,BW] 474-0-474ms    | [S0,MB1,B]  481-0-481ms    | [S7,MB5,F]  485-18-504ms   | [S7,MB5,BI] 514-33-547ms   | [S7,MB5,BW] 548-0-548ms    | [S0,MB2,B]  555-0-555ms    | [S7,MB6,F]  569-15-584ms   | [S7,MB6,BI] 596-33-629ms   | [S7,MB6,BW] 629-0-629ms    | [S0,MB3,B]  636-0-636ms    | [S7,MB7,F]  650-15-665ms   | [S7,MB7,BI] 677-33-710ms   | [S7,MB7,BW] 711-0-711ms    | [S0,MB4,B]  719-0-719ms    | [S0,MB5,B]  744-0-744ms    | [S0,MB6,B]  770-0-770ms    | [S0,MB7,B]  795-0-795ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-37ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-105ms    | [S1,MB5,F]  105-13-118ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-0-183ms    | [S6,MB2,F]  183-8-192ms    | [S6,MB1,BI] 239-9-248ms    | [S6,MB1,BW] 248-0-248ms    | [S6,MB3,F]  248-8-257ms    | [S6,MB2,BI] 325-9-334ms    | [S6,MB2,BW] 334-0-334ms    | [S1,MB6,F]  334-12-347ms   | [S1,MB0,BI] 347-15-362ms   | [S1,MB0,BW] 362-0-362ms    | [S6,MB4,F]  362-7-370ms    | [S6,MB3,BI] 391-10-402ms   | [S6,MB3,BW] 402-0-402ms    | [S1,MB7,F]  403-13-417ms   | [S1,MB1,BI] 417-15-432ms   | [S1,MB1,BW] 432-0-432ms    | [S6,MB5,F]  432-7-440ms    | [S6,MB4,BI] 474-11-486ms   | [S6,MB4,BW] 486-0-486ms    | [S1,MB2,BI] 493-14-507ms   | [S1,MB2,BW] 507-0-507ms    | [S6,MB6,F]  554-7-561ms    | [S6,MB5,BI] 561-10-571ms   | [S6,MB5,BW] 572-0-572ms    | [S1,MB3,BI] 579-14-593ms   | [S1,MB3,BW] 593-0-593ms    | [S6,MB7,F]  635-7-642ms    | [S6,MB6,BI] 643-10-653ms   | [S6,MB6,BW] 653-0-653ms    | [S1,MB4,BI] 661-14-675ms   | [S6,MB7,BI] 710-10-721ms   | [S1,MB5,BI] 721-14-735ms   | [S1,MB4,BW] 736-0-736ms    | [S1,MB6,BI] 749-14-763ms   | [S1,MB5,BW] 763-0-763ms    | [S1,MB7,BI] 773-13-787ms   | [S1,MB6,BW] 787-0-787ms    | [S6,MB7,BW] 787-0-787ms    | [S1,MB7,BW] 787-0-787ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  37-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 183-9-192ms    | [S5,MB0,BW] 193-0-193ms    | [S5,MB3,F]  193-8-201ms    | [S5,MB1,BI] 248-9-258ms    | [S5,MB1,BW] 258-0-258ms    | [S2,MB5,F]  258-8-266ms    | [S2,MB0,BI] 267-10-277ms   | [S2,MB0,BW] 277-0-277ms    | [S5,MB4,F]  277-7-284ms    | [S5,MB2,BI] 334-10-345ms   | [S5,MB2,BW] 345-0-345ms    | [S2,MB6,F]  347-9-357ms    | [S2,MB1,BI] 359-10-369ms   | [S2,MB1,BW] 369-0-369ms    | [S5,MB5,F]  369-7-376ms    | [S5,MB3,BI] 407-10-417ms   | [S5,MB3,BW] 417-0-417ms    | [S2,MB7,F]  418-9-427ms    | [S2,MB2,BI] 429-10-440ms   | [S2,MB2,BW] 440-0-440ms    | [S5,MB6,F]  440-7-447ms    | [S5,MB4,BI] 486-10-497ms   | [S5,MB4,BW] 497-0-497ms    | [S2,MB3,BI] 557-9-567ms    | [S2,MB3,BW] 567-0-567ms    | [S5,MB7,F]  578-7-586ms    | [S5,MB5,BI] 585-9-595ms    | [S5,MB5,BW] 595-0-595ms    | [S2,MB4,BI] 638-9-648ms    | [S5,MB6,BI] 653-10-663ms   | [S2,MB5,BI] 663-10-674ms   | [S5,MB7,BI] 722-9-731ms    | [S2,MB6,BI] 731-11-743ms   | [S2,MB4,BW] 742-0-742ms    | [S2,MB7,BI] 757-9-767ms    | [S2,MB5,BW] 767-0-767ms    | [S5,MB6,BW] 767-0-767ms    | [S5,MB7,BW] 767-0-767ms    | [S2,MB6,BW] 767-0-767ms    | [S2,MB7,BW] 767-0-767ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  97-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-0-202ms    | [S3,MB4,F]  202-7-209ms    | [S3,MB0,BI] 209-9-218ms    | [S3,MB0,BW] 218-0-218ms    | [S4,MB4,F]  218-7-226ms    | [S4,MB1,BI] 258-10-269ms   | [S4,MB1,BW] 269-0-269ms    | [S3,MB5,F]  269-7-277ms    | [S3,MB1,BI] 277-9-286ms    | [S3,MB1,BW] 286-0-286ms    | [S4,MB5,F]  286-7-294ms    | [S4,MB2,BI] 352-11-363ms   | [S4,MB2,BW] 363-0-363ms    | [S3,MB6,F]  363-7-370ms    | [S3,MB2,BI] 370-9-379ms    | [S3,MB2,BW] 380-0-380ms    | [S4,MB6,F]  380-7-387ms    | [S4,MB3,BI] 422-11-433ms   | [S4,MB3,BW] 433-0-433ms    | [S3,MB7,F]  433-7-441ms    | [S3,MB3,BI] 441-9-450ms    | [S3,MB3,BW] 450-0-450ms    | [S4,MB7,F]  450-7-458ms    | [S4,MB4,BI] 550-10-561ms   | [S4,MB4,BW] 560-0-560ms    | [S3,MB4,BI] 562-9-571ms    | [S4,MB5,BI] 631-9-641ms    | [S3,MB5,BI] 641-9-650ms    | [S4,MB6,BI] 663-9-672ms    | [S3,MB6,BI] 672-9-681ms    | [S4,MB7,BI] 732-9-741ms    | [S3,MB7,BI] 741-9-750ms    | [S3,MB4,BW] 750-0-750ms    | [S4,MB5,BW] 750-0-750ms    | [S4,MB6,BW] 751-0-751ms    | [S4,MB7,BW] 751-0-751ms    | [S3,MB5,BW] 751-0-751ms    | [S3,MB6,BW] 751-0-751ms    | [S3,MB7,BW] 751-0-751ms   
[rank3]:2025-12-26 15:31:22,481 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1531_stage3_step100.svg
[rank1]:2025-12-26 15:31:22,483 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-26 15:31:22,523 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage1.svg
[rank1]:2025-12-26 15:31:22,560 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage6.svg
[rank0]:2025-12-26 15:31:22,484 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage0.svg
[rank0]:2025-12-26 15:31:22,523 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage7.svg
[rank2]:2025-12-26 15:31:22,505 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage2.svg
[rank2]:2025-12-26 15:31:22,540 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage5.svg
[rank3]:2025-12-26 15:31:22,520 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1531_stage4_step100.svg
[rank3]:2025-12-26 15:31:22,624 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank3_stage3.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-26 15:31:22,723 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1531_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-26 15:31:22,762 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage3.svg
[rank3]:2025-12-26 15:31:22,798 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1531_stage4.svg
[rank0]:2025-12-26 15:34:43,405 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-26 15:34:43,738 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.20/0.30, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.30/0.45, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-26 15:34:43,738 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.31/0.46, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-12-26 15:34:43,745 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.08/0.11, [MB5] 0.00/0.00, [MB3] 0.12/0.19, [MB6] 0.00/0.00, [MB4] 0.45/0.67, [MB5] 0.56/0.85, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-26 15:34:43,796 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.60/0.90, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB4] 0.67/1.00, [MB1] 0.67/1.00, [MB5] 0.67/1.00, [MB2] 0.67/1.00, [MB6] 0.67/1.00, [MB3] 0.67/1.00, [MB7] 0.33/0.50, [MB4] 0.45/0.68, [MB5] 0.22/0.33, [MB6] 0.26/0.39, [MB7] 0.67/1.00
[rank1]:2025-12-26 15:34:47,877 - Avg. fwd time: 9.8962 / Avg. bwd-weight time: 10.2114 / Avg. bwd-input time: 12.2668 / Avg. batch time: 1010.0407 (ms) / GPU bubble ratio: 48.72%
[rank0]:2025-12-26 15:34:47,887 - Avg. fwd time: 13.6721 / Avg. full-bwd time: 21.5863 (Avg. bwd-weight time: 24.2342 / Avg. bwd-input time: 34.6147) / Avg. batch time: 1034.7841 (ms) / GPU bubble ratio: 16.67%
[rank2]:2025-12-26 15:34:47,879 - Avg. fwd time: 8.2233 / Avg. bwd-weight time: 8.1835 / Avg. bwd-input time: 10.0733 / Avg. batch time: 979.8149 (ms) / GPU bubble ratio: 56.76%
[rank2]:2025-12-26 15:34:47,932 -  step: 150  loss: -4.0000  grad_norm: 17.9882  memory: 14.72GiB(30.98%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank3]:2025-12-26 15:34:47,873 - Avg. fwd time: 7.7769 / Avg. bwd-weight time: 7.9093 / Avg. bwd-input time: 9.6495 / Avg. batch time: 969.6584 (ms) / GPU bubble ratio: 58.19%
[rank3]:2025-12-26 15:34:47,932 -  step: 150  loss: -4.0000  grad_norm: 17.9882  memory: 16.18GiB(34.07%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank1]:2025-12-26 15:34:47,936 -  step: 150  loss: -4.0000  grad_norm: 17.9882  memory: 18.98GiB(39.95%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank0]:2025-12-26 15:34:47,959 -  step: 150  loss:  4.1570  grad_norm: 17.9882  memory: 40.40GiB(85.05%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank0]:2025-12-26 15:37:58,207 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 15:37:58,528 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.46/0.46, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-26 15:37:58,536 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.11/0.11, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 15:37:58,584 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.90/0.90, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.50/0.50, [MB4] 0.68/0.68, [MB5] 0.33/0.33, [MB6] 0.39/0.39, [MB7] 1.00/1.00
[rank2]:2025-12-26 15:37:58,529 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.30/0.30, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.45/0.45, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-26 15:38:02,026 - Avg. fwd time: 8.2340 / Avg. bwd-weight time: 8.1542 / Avg. bwd-input time: 10.0923 / Avg. batch time: 956.2473 (ms) / GPU bubble ratio: 55.69%
[rank3]:2025-12-26 15:38:02,021 - Avg. fwd time: 7.7847 / Avg. bwd-weight time: 7.7458 / Avg. bwd-input time: 9.6812 / Avg. batch time: 944.8911 (ms) / GPU bubble ratio: 57.31%
[rank1]:2025-12-26 15:38:02,028 - Avg. fwd time: 9.8850 / Avg. bwd-weight time: 9.9238 / Avg. bwd-input time: 12.3037 / Avg. batch time: 983.0658 (ms) / GPU bubble ratio: 47.73%
[rank1]:2025-12-26 15:38:02,078 -  step: 200  loss: -4.0000  grad_norm:  3.8240  memory: 18.98GiB(39.95%)  tps: 8,439  tflops: 65.97  mfu: 21.15%
[rank0]:2025-12-26 15:38:02,030 - Avg. fwd time: 13.6991 / Avg. full-bwd time: 20.2969 (Avg. bwd-weight time: 22.2479 / Avg. bwd-input time: 34.7133) / Avg. batch time: 1008.3177 (ms) / GPU bubble ratio: 16.97%
[rank2]:2025-12-26 15:38:02,075 -  step: 200  loss: -4.0000  grad_norm:  3.8240  memory: 14.74GiB(31.02%)  tps: 8,439  tflops: 65.97  mfu: 21.15%
[rank3]:2025-12-26 15:38:02,075 -  step: 200  loss: -4.0000  grad_norm:  3.8240  memory: 16.18GiB(34.07%)  tps: 8,439  tflops: 65.97  mfu: 21.15%
[rank1]:2025-12-26 15:38:02,154 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1538_stage1_step200.svg
[rank0]:2025-12-26 15:38:02,100 -  step: 200  loss:  1.1386  grad_norm:  3.8240  memory: 40.40GiB(85.05%)  tps: 8,439  tflops: 65.97  mfu: 21.15%
[rank0]:2025-12-26 15:38:02,156 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1538_stage0_step200.svg
[rank2]:2025-12-26 15:38:02,155 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1538_stage2_step200.svg
[rank2]:2025-12-26 15:38:02,197 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1538_stage5_step200.svg
[rank1]:2025-12-26 15:38:02,197 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1538_stage6_step200.svg
[rank0]:2025-12-26 15:38:02,198 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1538_stage7_step200.svg
[rank2]:2025-12-26 15:38:02,296 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank2_stage2.svg
[rank2]:	> Counts Sum: 28160, Total Sum: 69120 (40.74%), Ratio(%) per element: [41.66, 47.91, 43.75, 46.87, 44.79, 44.79, 45.83, 23.95, 22.91, 41.66, 45.83, 50.0, 47.91, 43.75, 44.79, 47.91, 22.91, 26.04]
[rank1]:2025-12-26 15:38:02,324 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank1_stage1.svg
[rank1]:	> Counts Sum: 46080, Total Sum: 103680 (44.44%), Ratio(%) per element: [44.79, 51.04, 47.91, 50.0, 45.83, 50.0, 47.91, 22.91, 26.04, 48.95, 55.2, 47.91, 50.0, 53.12, 56.25, 50.0, 25.0, 27.08, 56.25, 46.87, 50.0, 48.95, 52.08, 48.95, 54.16, 20.83, 21.87]
[rank0]:2025-12-26 15:38:02,303 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank0_stage0.svg
[rank0]:	> Counts Sum: 46120, Total Sum: 72960 (63.21%), Ratio(%) per element: [69.79, 66.66, 73.95, 73.95, 65.62, 68.75, 78.12, 71.87, 30.2, 27.08, 68.75, 71.87, 76.04, 71.87, 67.7, 70.83, 71.87, 30.2, 45.83]
[rank0]:2025-12-26 15:38:02,385 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank0_stage7.svg
[rank0]:	> Counts Sum: 26120, Total Sum: 42240 (61.84%), Ratio(%) per element: [78.12, 82.29, 73.95, 79.16, 77.08, 77.08, 81.25, 34.37, 30.2, 32.29, 34.37]
[rank2]:2025-12-26 15:38:02,395 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank2_stage5.svg
[rank2]:	> Counts Sum: 13760, Total Sum: 69120 (19.91%), Ratio(%) per element: [21.87, 21.87, 17.7, 18.75, 19.79, 17.7, 19.79, 17.7, 16.66, 20.83, 19.79, 21.87, 21.87, 22.91, 19.79, 23.95, 17.7, 17.7]
[rank1]:2025-12-26 15:38:02,425 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank1_stage6.svg
[rank1]:	> Counts Sum: 16560, Total Sum: 69120 (23.96%), Ratio(%) per element: [27.08, 25.0, 23.95, 26.04, 26.04, 25.0, 25.0, 19.79, 19.79, 26.04, 23.95, 26.04, 25.0, 25.0, 26.04, 25.0, 17.7, 18.75]
[rank3]:2025-12-26 15:38:02,441 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1538_step200_rank3.svg
[rank3]:			> Batch Time: 891.54 ms, GPU Bubble Ratio: 20.80%, 44.76%, 52.53%, 55.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-8-61ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-25-201ms   | [S7,MB1,F]  202-16-218ms   | [S7,MB1,BI] 230-35-265ms   | [S7,MB1,BW] 265-0-265ms    | [S7,MB2,F]  266-18-284ms   | [S7,MB2,BI] 296-35-331ms   | [S7,MB2,BW] 331-23-355ms   | [S7,MB3,F]  354-20-374ms   | [S7,MB3,BI] 386-35-422ms   | [S7,MB3,BW] 421-24-445ms   | [S0,MB7,F]  446-10-457ms   | [S0,MB0,B]  457-11-468ms   | [S7,MB4,F]  468-19-487ms   | [S7,MB4,BI] 499-35-535ms   | [S7,MB4,BW] 535-0-535ms    | [S0,MB1,B]  542-10-552ms   | [S7,MB5,F]  552-18-570ms   | [S7,MB5,BI] 582-34-616ms   | [S7,MB5,BW] 617-0-617ms    | [S0,MB2,B]  624-10-634ms   | [S7,MB6,F]  638-16-654ms   | [S7,MB6,BI] 666-33-700ms   | [S7,MB6,BW] 700-0-700ms    | [S0,MB3,B]  708-11-719ms   | [S7,MB7,F]  722-15-737ms   | [S7,MB7,BI] 750-34-784ms   | [S7,MB7,BW] 784-24-808ms   | [S0,MB4,B]  810-18-828ms   | [S0,MB5,B]  833-22-855ms   | [S0,MB6,B]  860-24-884ms   | [S0,MB7,B]  886-5-891ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-202ms    | [S6,MB1,BI] 265-9-275ms    | [S6,MB1,BW] 274-10-285ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 332-9-342ms    | [S6,MB2,BW] 342-10-353ms   | [S1,MB6,F]  353-10-364ms   | [S1,MB0,BI] 364-15-380ms   | [S1,MB0,BW] 379-15-395ms   | [S6,MB4,F]  395-8-403ms    | [S6,MB3,BI] 424-10-434ms   | [S6,MB3,BW] 434-10-444ms   | [S1,MB7,F]  457-13-471ms   | [S1,MB1,BI] 471-15-486ms   | [S1,MB1,BW] 486-14-501ms   | [S6,MB5,F]  501-7-509ms    | [S6,MB4,BI] 534-11-546ms   | [S6,MB4,BW] 546-10-557ms   | [S1,MB2,BI] 557-14-571ms   | [S1,MB2,BW] 571-12-584ms   | [S6,MB6,F]  623-7-630ms    | [S6,MB5,BI] 630-10-641ms   | [S6,MB5,BW] 640-10-651ms   | [S1,MB3,BI] 651-14-666ms   | [S1,MB3,BW] 666-10-677ms   | [S6,MB7,F]  707-7-715ms    | [S6,MB6,BI] 715-10-725ms   | [S6,MB6,BW] 725-10-736ms   | [S1,MB4,BI] 736-14-751ms   | [S6,MB7,BI] 785-9-795ms    | [S1,MB5,BI] 806-15-821ms   | [S1,MB4,BW] 821-6-827ms    | [S1,MB6,BI] 834-14-849ms   | [S1,MB5,BW] 849-1-850ms    | [S1,MB7,BI] 859-14-873ms   | [S1,MB6,BW] 873-0-874ms    | [S6,MB7,BW] 874-0-874ms    | [S1,MB7,BW] 874-0-874ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-11-295ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB0,BI] 303-10-313ms   | [S2,MB0,BW] 313-9-323ms    | [S5,MB4,F]  323-7-330ms    | [S5,MB2,BI] 342-10-353ms   | [S5,MB2,BW] 353-10-363ms   | [S2,MB6,F]  365-10-375ms   | [S2,MB1,BI] 376-11-387ms   | [S2,MB1,BW] 387-10-397ms   | [S5,MB5,F]  398-7-405ms    | [S5,MB3,BI] 461-10-472ms   | [S5,MB3,BW] 472-11-484ms   | [S2,MB7,F]  484-7-491ms    | [S2,MB2,BI] 491-10-502ms   | [S2,MB2,BW] 502-9-512ms    | [S5,MB6,F]  512-7-520ms    | [S5,MB4,BI] 547-10-557ms   | [S5,MB4,BW] 557-9-566ms    | [S2,MB3,BI] 626-9-636ms    | [S2,MB3,BW] 636-10-646ms   | [S5,MB7,F]  650-7-657ms    | [S5,MB5,BI] 657-9-667ms    | [S5,MB5,BW] 667-9-677ms    | [S2,MB4,BI] 710-9-720ms    | [S5,MB6,BI] 725-10-736ms   | [S2,MB5,BI] 736-10-746ms   | [S5,MB7,BI] 807-9-816ms    | [S2,MB6,BI] 817-11-828ms   | [S2,MB4,BW] 828-7-835ms    | [S2,MB7,BI] 843-9-853ms    | [S2,MB5,BW] 853-0-853ms    | [S5,MB6,BW] 853-10-863ms   | [S5,MB7,BW] 863-6-869ms    | [S2,MB6,BW] 870-0-870ms    | [S2,MB7,BW] 870-0-870ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 220-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  239-8-247ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 295-10-305ms   | [S3,MB5,F]  305-8-313ms    | [S3,MB1,BI] 313-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  332-7-340ms    | [S4,MB2,BI] 369-11-381ms   | [S4,MB2,BW] 381-9-391ms    | [S3,MB6,F]  391-7-398ms    | [S3,MB2,BI] 398-9-407ms    | [S3,MB2,BW] 408-9-417ms    | [S4,MB6,F]  417-8-425ms    | [S4,MB3,BI] 476-10-486ms   | [S4,MB3,BW] 487-10-497ms   | [S3,MB7,F]  497-7-504ms    | [S3,MB3,BI] 504-9-514ms    | [S3,MB3,BW] 514-9-524ms    | [S4,MB7,F]  524-7-531ms    | [S4,MB4,BI] 620-10-630ms   | [S4,MB4,BW] 630-9-640ms    | [S3,MB4,BI] 640-10-650ms   | [S4,MB5,BI] 704-10-714ms   | [S3,MB5,BI] 714-9-723ms    | [S4,MB6,BI] 736-9-745ms    | [S3,MB6,BI] 745-9-755ms    | [S4,MB7,BI] 818-9-827ms    | [S3,MB7,BI] 828-9-837ms    | [S3,MB4,BW] 837-0-837ms    | [S4,MB5,BW] 837-10-847ms   | [S4,MB6,BW] 847-9-857ms    | [S4,MB7,BW] 857-6-863ms    | [S3,MB5,BW] 863-0-863ms    | [S3,MB6,BW] 863-0-863ms    | [S3,MB7,BW] 863-0-863ms   
[rank3]:2025-12-26 15:38:02,485 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1538_stage3_step200.svg
[rank3]:2025-12-26 15:38:02,528 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1538_stage4_step200.svg
[rank0]:2025-12-26 15:38:02,556 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage0.svg
[rank2]:2025-12-26 15:38:02,561 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage2.svg
[rank1]:2025-12-26 15:38:02,596 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage1.svg
[rank2]:2025-12-26 15:38:02,720 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage5.svg
[rank3]:2025-12-26 15:38:02,654 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank3_stage3.svg
[rank3]:	> Counts Sum: 31680, Total Sum: 69120 (45.83%), Ratio(%) per element: [48.95, 52.08, 53.12, 48.95, 52.08, 53.12, 47.91, 29.16, 27.08, 48.95, 50.0, 54.16, 47.91, 51.04, 50.0, 51.04, 34.37, 25.0]
[rank1]:2025-12-26 15:38:02,761 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage6.svg
[rank0]:2025-12-26 15:38:02,724 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage7.svg
[rank3]:2025-12-26 15:38:02,758 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1538_rank3_stage4.svg
[rank3]:	> Counts Sum: 13840, Total Sum: 69120 (20.02%), Ratio(%) per element: [18.75, 20.83, 21.87, 19.79, 22.91, 17.7, 23.95, 17.7, 17.7, 21.87, 20.83, 18.75, 20.83, 18.75, 19.79, 22.91, 17.7, 17.7]
[rank3]:2025-12-26 15:38:02,929 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage3.svg
[rank3]:2025-12-26 15:38:03,094 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1538_stage4.svg
[rank0]:2025-12-26 15:40:51,898 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-26 15:40:52,354 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.30/0.30, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.45/0.45, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-26 15:40:52,354 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.46/0.46, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-26 15:40:52,361 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.11/0.11, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 15:40:52,404 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.90/0.90, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.50/0.50, [MB4] 0.68/0.68, [MB5] 0.33/0.33, [MB6] 0.39/0.39, [MB7] 1.00/1.00
[rank0]:2025-12-26 15:40:55,794 - Avg. fwd time: 13.5755 / Avg. full-bwd time: 17.5601 (Avg. bwd-weight time: 19.1843 / Avg. bwd-input time: 34.5750) / Avg. batch time: 971.6174 (ms) / GPU bubble ratio: 18.92%
[rank2]:2025-12-26 15:40:55,791 - Avg. fwd time: 8.2622 / Avg. bwd-weight time: 8.0799 / Avg. bwd-input time: 10.1404 / Avg. batch time: 923.1755 (ms) / GPU bubble ratio: 54.10%
[rank2]:2025-12-26 15:40:55,839 -  step: 250  loss: -4.0000  grad_norm:  1.1039  memory: 14.74GiB(31.02%)  tps: 9,429  tflops: 73.71  mfu: 23.63%
[rank3]:2025-12-26 15:40:55,786 - Avg. fwd time: 7.7979 / Avg. bwd-weight time: 7.6074 / Avg. bwd-input time: 9.7334 / Avg. batch time: 910.8851 (ms) / GPU bubble ratio: 55.84%
[rank3]:2025-12-26 15:40:55,839 -  step: 250  loss: -4.0000  grad_norm:  1.1039  memory: 16.18GiB(34.07%)  tps: 9,429  tflops: 73.71  mfu: 23.63%
[rank1]:2025-12-26 15:40:55,792 - Avg. fwd time: 9.9091 / Avg. bwd-weight time: 9.7073 / Avg. bwd-input time: 12.4179 / Avg. batch time: 948.2554 (ms) / GPU bubble ratio: 45.95%
[rank1]:2025-12-26 15:40:55,843 -  step: 250  loss: -4.0000  grad_norm:  1.1039  memory: 18.98GiB(39.95%)  tps: 9,429  tflops: 73.71  mfu: 23.63%
[rank0]:2025-12-26 15:40:55,866 -  step: 250  loss:  0.3851  grad_norm:  1.1039  memory: 40.73GiB(85.74%)  tps: 9,429  tflops: 73.71  mfu: 23.63%
[rank0]:2025-12-26 15:43:44,552 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 15:43:45,089 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.46/0.46, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-26 15:43:45,089 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.30/0.30, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.45/0.45, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-26 15:43:45,096 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.11/0.11, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 15:43:45,110 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 0.90/0.90, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.50/0.50, [MB4] 0.68/0.68, [MB5] 0.33/0.33, [MB6] 0.39/0.39, [MB7] 1.00/1.00
[rank3]:2025-12-26 15:43:48,438 - Avg. fwd time: 7.8051 / Avg. bwd-weight time: 7.5177 / Avg. bwd-input time: 9.7698 / Avg. batch time: 888.3399 (ms) / GPU bubble ratio: 54.81%
[rank3]:2025-12-26 15:43:48,495 -  step: 300  loss: -4.0000  grad_norm:  0.2692  memory: 16.18GiB(34.07%)  tps: 9,489  tflops: 74.18  mfu: 23.78%
[rank2]:2025-12-26 15:43:48,442 - Avg. fwd time: 8.2794 / Avg. bwd-weight time: 8.0192 / Avg. bwd-input time: 10.1738 / Avg. batch time: 900.9049 (ms) / GPU bubble ratio: 52.99%
[rank2]:2025-12-26 15:43:48,495 -  step: 300  loss: -4.0000  grad_norm:  0.2692  memory: 14.74GiB(31.02%)  tps: 9,489  tflops: 74.18  mfu: 23.78%
[rank1]:2025-12-26 15:43:48,445 - Avg. fwd time: 9.9274 / Avg. bwd-weight time: 9.5751 / Avg. bwd-input time: 12.4960 / Avg. batch time: 924.8854 (ms) / GPU bubble ratio: 44.64%
[rank1]:2025-12-26 15:43:48,498 -  step: 300  loss: -4.0000  grad_norm:  0.2692  memory: 18.98GiB(39.95%)  tps: 9,489  tflops: 74.18  mfu: 23.78%
[rank0]:2025-12-26 15:43:48,449 - Avg. fwd time: 13.4875 / Avg. full-bwd time: 15.7078 (Avg. bwd-weight time: 17.1434 / Avg. bwd-input time: 34.4815) / Avg. batch time: 946.9557 (ms) / GPU bubble ratio: 20.33%
[rank2]:2025-12-26 15:43:48,572 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1543_stage2_step300.svg
[rank1]:2025-12-26 15:43:48,573 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1543_stage1_step300.svg
[rank0]:2025-12-26 15:43:48,520 -  step: 300  loss:  0.2828  grad_norm:  0.2692  memory: 40.73GiB(85.74%)  tps: 9,490  tflops: 74.18  mfu: 23.78%
[rank0]:2025-12-26 15:43:48,578 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1543_stage0_step300.svg
[rank2]:2025-12-26 15:43:48,614 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1543_stage5_step300.svg
[rank1]:2025-12-26 15:43:48,614 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1543_stage6_step300.svg
[rank0]:2025-12-26 15:43:48,624 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1543_stage7_step300.svg
[rank2]:2025-12-26 15:43:48,714 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank2_stage2.svg
[rank2]:	> Counts Sum: 51760, Total Sum: 126720 (40.85%), Ratio(%) per element: [41.47, 44.88, 44.31, 44.88, 44.88, 42.04, 44.31, 30.11, 29.54, 41.47, 44.31, 46.02, 46.02, 42.61, 42.61, 44.88, 29.54, 31.25]
[rank1]:2025-12-26 15:43:48,741 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank1_stage1.svg
[rank1]:	> Counts Sum: 87280, Total Sum: 190080 (45.92%), Ratio(%) per element: [47.15, 52.27, 51.7, 52.27, 49.43, 51.7, 48.86, 25.56, 27.27, 50.56, 53.97, 50.0, 50.0, 52.84, 54.54, 51.13, 27.84, 27.84, 54.54, 50.0, 51.13, 50.56, 51.7, 50.56, 55.68, 25.0, 25.56]
[rank0]:2025-12-26 15:43:48,740 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank0_stage0.svg
[rank0]:	> Counts Sum: 94520, Total Sum: 133760 (70.66%), Ratio(%) per element: [76.13, 73.86, 77.27, 78.4, 77.27, 78.4, 79.54, 79.54, 44.88, 43.18, 73.86, 77.27, 79.54, 76.13, 75.56, 75.56, 76.7, 44.88, 54.54]
[rank3]:2025-12-26 15:43:48,854 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1543_step300_rank3.svg
[rank3]:			> Batch Time: 814.50 ms, GPU Bubble Ratio: 29.57%, 37.28%, 47.88%, 51.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-25-200ms   | [S7,MB1,F]  199-15-215ms   | [S7,MB1,BI] 228-34-262ms   | [S7,MB1,BW] 262-0-262ms    | [S7,MB2,F]  262-18-280ms   | [S7,MB2,BI] 293-35-328ms   | [S7,MB2,BW] 328-0-328ms    | [S7,MB3,F]  328-19-348ms   | [S7,MB3,BI] 360-35-395ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  414-18-432ms   | [S7,MB4,BI] 444-34-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  486-0-486ms    | [S7,MB5,F]  491-16-508ms   | [S7,MB5,BI] 520-33-554ms   | [S7,MB5,BW] 553-0-553ms    | [S0,MB2,B]  560-0-560ms    | [S7,MB6,F]  575-15-590ms   | [S7,MB6,BI] 601-33-634ms   | [S7,MB6,BW] 634-0-634ms    | [S0,MB3,B]  641-0-641ms    | [S7,MB7,F]  656-14-670ms   | [S7,MB7,BI] 682-33-715ms   | [S7,MB7,BW] 715-25-740ms   | [S0,MB4,B]  739-13-753ms   | [S0,MB5,B]  761-15-777ms   | [S0,MB6,B]  789-13-803ms   | [S0,MB7,B]  814-0-814ms   
[rank2]:2025-12-26 15:43:48,815 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank2_stage5.svg
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 262-9-271ms    | [S6,MB1,BW] 271-10-282ms   | [S6,MB3,F]  282-7-289ms    | [S6,MB2,BI] 328-9-337ms    | [S6,MB2,BW] 337-10-348ms   | [S1,MB6,F]  348-10-359ms   | [S1,MB0,BI] 359-16-375ms   | [S1,MB0,BW] 375-15-391ms   | [S6,MB4,F]  390-9-400ms    | [S6,MB3,BI] 400-12-412ms   | [S6,MB3,BW] 412-11-424ms   | [S1,MB7,F]  424-12-436ms   | [S1,MB1,BI] 436-17-453ms   | [S1,MB1,BW] 453-17-471ms   | [S6,MB5,F]  471-10-481ms   | [S6,MB4,BI] 481-12-493ms   | [S6,MB4,BW] 494-12-507ms   | [S1,MB2,BI] 507-16-523ms   | [S1,MB2,BW] 523-13-537ms   | [S6,MB6,F]  560-7-568ms    | [S6,MB5,BI] 567-10-578ms   | [S6,MB5,BW] 578-10-589ms   | [S1,MB3,BI] 589-14-604ms   | [S1,MB3,BW] 604-13-617ms   | [S6,MB7,F]  640-7-648ms    | [S6,MB6,BI] 648-10-659ms   | [S6,MB6,BW] 659-10-670ms   | [S1,MB4,BI] 670-14-685ms   | [S6,MB7,BI] 715-9-725ms    | [S1,MB5,BI] 737-15-753ms   | [S1,MB4,BW] 752-4-757ms    | [S1,MB6,BI] 768-14-782ms   | [S1,MB5,BW] 782-0-783ms    | [S1,MB7,BI] 793-14-807ms   | [S1,MB6,BW] 807-0-807ms    | [S6,MB7,BW] 807-0-807ms    | [S1,MB7,BW] 807-0-807ms   
[rank2]:	> Counts Sum: 16960, Total Sum: 126720 (13.38%), Ratio(%) per element: [14.77, 14.2, 11.93, 13.63, 13.06, 14.2, 14.77, 9.65, 9.09, 13.06, 14.77, 16.47, 15.9, 15.34, 13.63, 17.04, 9.65, 9.65]
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 272-9-281ms    | [S5,MB1,BW] 281-11-292ms   | [S2,MB5,F]  292-7-299ms    | [S2,MB0,BI] 299-10-310ms   | [S2,MB0,BW] 310-9-320ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 338-10-348ms   | [S5,MB2,BW] 348-10-358ms   | [S2,MB6,F]  360-10-370ms   | [S2,MB1,BI] 372-11-383ms   | [S2,MB1,BW] 383-10-393ms   | [S5,MB5,F]  393-7-401ms    | [S5,MB3,BI] 413-10-424ms   | [S5,MB3,BW] 425-9-435ms    | [S2,MB7,F]  437-9-446ms    | [S2,MB2,BI] 448-11-459ms   | [S2,MB2,BW] 460-9-470ms    | [S5,MB6,F]  470-7-478ms    | [S5,MB4,BI] 495-10-505ms   | [S5,MB4,BW] 506-9-516ms    | [S2,MB3,BI] 563-9-573ms    | [S2,MB3,BW] 573-10-583ms   | [S5,MB7,F]  588-7-595ms    | [S5,MB5,BI] 595-9-605ms    | [S5,MB5,BW] 605-9-614ms    | [S2,MB4,BI] 643-9-653ms    | [S5,MB6,BI] 659-10-670ms   | [S2,MB5,BI] 670-10-680ms   | [S5,MB7,BI] 740-9-749ms    | [S2,MB6,BI] 750-11-761ms   | [S2,MB4,BW] 762-7-769ms    | [S2,MB7,BI] 777-9-787ms    | [S2,MB5,BW] 787-0-787ms    | [S5,MB6,BW] 787-10-797ms   | [S5,MB7,BW] 797-5-802ms    | [S2,MB6,BW] 802-0-802ms    | [S2,MB7,BW] 802-0-802ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  238-8-247ms    | [S4,MB1,BI] 281-10-292ms   | [S4,MB1,BW] 292-10-302ms   | [S3,MB5,F]  302-8-310ms    | [S3,MB1,BI] 310-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 364-11-376ms   | [S4,MB2,BW] 376-9-386ms    | [S3,MB6,F]  386-7-393ms    | [S3,MB2,BI] 393-9-403ms    | [S3,MB2,BW] 403-10-413ms   | [S4,MB6,F]  413-8-421ms    | [S4,MB3,BI] 441-11-453ms   | [S4,MB3,BW] 454-9-464ms    | [S3,MB7,F]  464-7-471ms    | [S3,MB3,BI] 471-9-481ms    | [S3,MB3,BW] 481-10-492ms   | [S4,MB7,F]  491-8-500ms    | [S4,MB4,BI] 557-10-567ms   | [S4,MB4,BW] 567-9-577ms    | [S3,MB4,BI] 577-10-587ms   | [S4,MB5,BI] 637-10-647ms   | [S3,MB5,BI] 647-9-656ms    | [S4,MB6,BI] 670-9-679ms    | [S3,MB6,BI] 679-9-689ms    | [S4,MB7,BI] 752-9-761ms    | [S3,MB7,BI] 761-9-770ms    | [S3,MB4,BW] 771-0-771ms    | [S4,MB5,BW] 771-10-781ms   | [S4,MB6,BW] 781-9-790ms    | [S4,MB7,BW] 791-4-796ms    | [S3,MB5,BW] 795-0-795ms    | [S3,MB6,BW] 795-0-795ms    | [S3,MB7,BW] 795-0-795ms   
[rank3]:2025-12-26 15:43:48,897 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1543_stage3_step300.svg
[rank1]:2025-12-26 15:43:48,843 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank1_stage6.svg
[rank1]:	> Counts Sum: 23760, Total Sum: 126720 (18.75%), Ratio(%) per element: [20.45, 19.31, 18.75, 19.88, 19.88, 19.31, 19.31, 16.47, 16.47, 19.88, 18.75, 19.88, 19.31, 19.31, 19.88, 19.31, 15.34, 15.9]
[rank0]:2025-12-26 15:43:48,832 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank0_stage7.svg
[rank0]:	> Counts Sum: 54120, Total Sum: 77440 (69.89%), Ratio(%) per element: [80.68, 82.95, 78.97, 80.68, 79.54, 79.54, 83.52, 52.27, 48.86, 50.0, 51.7]
[rank3]:2025-12-26 15:43:48,939 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1543_stage4_step300.svg
[rank3]:2025-12-26 15:43:49,038 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank3_stage3.svg
[rank3]:	> Counts Sum: 60480, Total Sum: 126720 (47.73%), Ratio(%) per element: [49.43, 51.13, 51.7, 49.43, 51.13, 51.7, 48.86, 38.63, 37.5, 49.43, 50.0, 52.27, 48.86, 50.56, 50.0, 50.56, 41.47, 36.36]
[rank2]:2025-12-26 15:43:49,108 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage2.svg
[rank3]:2025-12-26 15:43:49,137 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1543_rank3_stage4.svg
[rank3]:	> Counts Sum: 17040, Total Sum: 126720 (13.45%), Ratio(%) per element: [13.63, 14.2, 13.63, 14.77, 15.34, 13.06, 14.77, 9.65, 9.65, 15.9, 14.77, 14.77, 16.47, 14.2, 13.06, 14.77, 9.65, 9.65]
[rank1]:2025-12-26 15:43:49,142 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage1.svg
[rank0]:2025-12-26 15:43:49,192 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage0.svg
[rank2]:2025-12-26 15:43:49,391 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage5.svg
[rank3]:2025-12-26 15:43:49,436 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage3.svg
[rank1]:2025-12-26 15:43:49,432 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage6.svg
[rank0]:2025-12-26 15:43:49,543 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage7.svg
[rank3]:2025-12-26 15:43:49,734 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1543_stage4.svg
[rank0]:2025-12-26 15:46:37,335 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-26 15:46:41,192 - Avg. fwd time: 9.9407 / Avg. bwd-weight time: 9.4685 / Avg. bwd-input time: 12.5566 / Avg. batch time: 907.4767 (ms) / GPU bubble ratio: 43.64%
[rank0]:2025-12-26 15:46:41,196 - Avg. fwd time: 13.4205 / Avg. full-bwd time: 14.4227 (Avg. bwd-weight time: 15.6145 / Avg. bwd-input time: 34.4148) / Avg. batch time: 928.6929 (ms) / GPU bubble ratio: 21.36%
[rank2]:2025-12-26 15:46:41,192 - Avg. fwd time: 8.2914 / Avg. bwd-weight time: 7.9801 / Avg. bwd-input time: 10.1946 / Avg. batch time: 884.3611 (ms) / GPU bubble ratio: 52.12%
[rank3]:2025-12-26 15:46:41,185 - Avg. fwd time: 7.8097 / Avg. bwd-weight time: 7.4459 / Avg. bwd-input time: 9.7951 / Avg. batch time: 871.3012 (ms) / GPU bubble ratio: 54.00%
[rank3]:2025-12-26 15:46:41,242 -  step: 350  loss: -4.0000  grad_norm:  0.1449  memory: 16.18GiB(34.07%)  tps: 9,484  tflops: 74.14  mfu: 23.76%
[rank1]:2025-12-26 15:46:41,245 -  step: 350  loss: -4.0000  grad_norm:  0.1449  memory: 18.98GiB(39.95%)  tps: 9,484  tflops: 74.14  mfu: 23.76%
[rank0]:2025-12-26 15:46:41,267 -  step: 350  loss:  0.2336  grad_norm:  0.1449  memory: 40.73GiB(85.74%)  tps: 9,484  tflops: 74.15  mfu: 23.76%
[rank2]:2025-12-26 15:46:41,242 -  step: 350  loss: -4.0000  grad_norm:  0.1449  memory: 14.74GiB(31.02%)  tps: 9,484  tflops: 74.14  mfu: 23.76%
[rank0]:2025-12-26 15:49:28,225 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 15:49:32,169 - Avg. fwd time: 7.8145 / Avg. bwd-weight time: 7.3978 / Avg. bwd-input time: 9.8154 / Avg. batch time: 858.0640 (ms) / GPU bubble ratio: 53.33%
[rank1]:2025-12-26 15:49:32,176 - Avg. fwd time: 9.9576 / Avg. bwd-weight time: 9.4172 / Avg. bwd-input time: 12.6048 / Avg. batch time: 893.7829 (ms) / GPU bubble ratio: 42.75%
[rank1]:2025-12-26 15:49:32,221 -  step: 400  loss: -4.0000  grad_norm:  0.1186  memory: 18.98GiB(39.95%)  tps: 9,583  tflops: 74.91  mfu: 24.01%
[rank2]:2025-12-26 15:49:32,172 - Avg. fwd time: 8.3005 / Avg. bwd-weight time: 7.9520 / Avg. bwd-input time: 10.2101 / Avg. batch time: 871.3069 (ms) / GPU bubble ratio: 51.41%
[rank2]:2025-12-26 15:49:32,218 -  step: 400  loss: -4.0000  grad_norm:  0.1186  memory: 14.74GiB(31.02%)  tps: 9,583  tflops: 74.91  mfu: 24.01%
[rank0]:2025-12-26 15:49:32,176 - Avg. fwd time: 13.3728 / Avg. full-bwd time: 13.4559 (Avg. bwd-weight time: 14.3890 / Avg. bwd-input time: 34.3652) / Avg. batch time: 914.3347 (ms) / GPU bubble ratio: 22.17%
[rank0]:2025-12-26 15:49:32,229 -  step: 400  loss:  0.2212  grad_norm:  0.1186  memory: 40.73GiB(85.74%)  tps: 9,584  tflops: 74.92  mfu: 24.01%
[rank3]:2025-12-26 15:49:32,218 -  step: 400  loss: -4.0000  grad_norm:  0.1186  memory: 16.18GiB(34.07%)  tps: 9,583  tflops: 74.91  mfu: 24.01%
[rank1]:2025-12-26 15:49:32,285 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1549_stage1_step400.svg
[rank1]:2025-12-26 15:49:32,330 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1549_stage6_step400.svg
[rank2]:2025-12-26 15:49:32,284 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1549_stage2_step400.svg
[rank2]:2025-12-26 15:49:32,329 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1549_stage5_step400.svg
[rank0]:2025-12-26 15:49:32,286 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1549_stage0_step400.svg
[rank0]:2025-12-26 15:49:32,331 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1549_stage7_step400.svg
[rank2]:2025-12-26 15:49:32,428 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank2_stage2.svg
[rank2]:	> Counts Sum: 75360, Total Sum: 184320 (40.89%), Ratio(%) per element: [42.18, 43.35, 43.75, 43.35, 44.14, 41.79, 43.35, 32.42, 32.03, 41.79, 43.75, 44.92, 44.53, 43.35, 42.18, 43.75, 32.03, 33.2]
[rank0]:2025-12-26 15:49:32,436 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank0_stage0.svg
[rank0]:	> Counts Sum: 142920, Total Sum: 194560 (73.46%), Ratio(%) per element: [78.12, 78.12, 80.46, 80.85, 78.9, 78.51, 81.25, 80.85, 50.39, 49.21, 78.51, 79.68, 79.68, 77.73, 77.34, 78.9, 79.29, 50.78, 57.03]
[rank1]:2025-12-26 15:49:32,456 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank1_stage1.svg
[rank1]:	> Counts Sum: 128480, Total Sum: 276480 (46.47%), Ratio(%) per element: [49.21, 52.34, 51.95, 52.73, 50.0, 50.78, 48.82, 26.95, 27.34, 51.56, 53.9, 51.17, 51.95, 55.85, 53.51, 51.56, 27.73, 28.12, 53.9, 50.78, 52.34, 51.17, 50.78, 50.78, 54.68, 26.95, 27.73]
[rank2]:2025-12-26 15:49:32,526 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank2_stage5.svg
[rank2]:	> Counts Sum: 20160, Total Sum: 184320 (10.94%), Ratio(%) per element: [12.89, 11.71, 11.32, 11.71, 10.93, 11.32, 11.71, 6.64, 6.25, 11.71, 11.71, 13.28, 13.28, 13.67, 12.1, 13.28, 6.64, 6.64]
[rank0]:2025-12-26 15:49:32,517 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank0_stage7.svg
[rank0]:	> Counts Sum: 82120, Total Sum: 112640 (72.90%), Ratio(%) per element: [81.64, 83.2, 80.46, 81.64, 80.07, 81.25, 83.59, 57.81, 55.85, 57.03, 59.37]
[rank3]:2025-12-26 15:49:32,558 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1549_step400_rank3.svg
[rank3]:			> Batch Time: 808.00 ms, GPU Bubble Ratio: 30.52%, 36.36%, 47.67%, 50.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-25-200ms   | [S7,MB1,F]  200-16-216ms   | [S7,MB1,BI] 228-34-263ms   | [S7,MB1,BW] 263-0-263ms    | [S7,MB2,F]  263-19-282ms   | [S7,MB2,BI] 294-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-19-349ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 397-0-397ms    | [S0,MB7,F]  397-10-407ms   | [S0,MB0,B]  407-0-407ms    | [S7,MB4,F]  415-18-433ms   | [S7,MB4,BI] 445-34-479ms   | [S7,MB4,BW] 480-0-480ms    | [S0,MB1,B]  487-0-487ms    | [S7,MB5,F]  491-17-508ms   | [S7,MB5,BI] 522-33-556ms   | [S7,MB5,BW] 555-0-555ms    | [S0,MB2,B]  562-0-562ms    | [S7,MB6,F]  577-15-592ms   | [S7,MB6,BI] 604-33-637ms   | [S7,MB6,BW] 637-0-637ms    | [S0,MB3,B]  644-0-644ms    | [S7,MB7,F]  658-14-673ms   | [S7,MB7,BI] 686-33-719ms   | [S7,MB7,BW] 719-4-723ms    | [S0,MB4,B]  731-13-744ms   | [S0,MB5,B]  756-15-772ms   | [S0,MB6,B]  783-21-804ms   | [S0,MB7,B]  808-0-808ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  62-11-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-282ms   | [S6,MB3,F]  283-7-290ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-11-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-15-392ms   | [S6,MB4,F]  391-9-401ms    | [S6,MB3,BI] 401-12-413ms   | [S6,MB3,BW] 413-11-425ms   | [S1,MB7,F]  425-12-438ms   | [S1,MB1,BI] 438-17-456ms   | [S1,MB1,BW] 456-17-473ms   | [S6,MB5,F]  473-10-484ms   | [S6,MB4,BI] 484-12-496ms   | [S6,MB4,BW] 496-12-508ms   | [S1,MB2,BI] 508-16-524ms   | [S1,MB2,BW] 524-15-540ms   | [S6,MB6,F]  562-7-570ms    | [S6,MB5,BI] 570-10-581ms   | [S6,MB5,BW] 580-10-591ms   | [S1,MB3,BI] 591-14-606ms   | [S1,MB3,BW] 606-13-619ms   | [S6,MB7,F]  644-7-651ms    | [S6,MB6,BI] 651-10-662ms   | [S6,MB6,BW] 662-10-673ms   | [S1,MB4,BI] 673-14-688ms   | [S6,MB7,BI] 719-10-730ms   | [S1,MB5,BI] 732-15-747ms   | [S1,MB4,BW] 748-4-753ms    | [S1,MB6,BI] 762-14-776ms   | [S1,MB5,BW] 776-0-777ms    | [S1,MB7,BI] 787-14-801ms   | [S1,MB6,BW] 801-0-801ms    | [S6,MB7,BW] 801-0-801ms    | [S1,MB7,BW] 801-0-801ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 272-9-282ms    | [S5,MB1,BW] 282-11-293ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 340-10-350ms   | [S5,MB2,BW] 350-10-360ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-402ms    | [S5,MB3,BI] 414-10-424ms   | [S5,MB3,BW] 424-10-434ms   | [S2,MB7,F]  438-9-448ms    | [S2,MB2,BI] 450-11-461ms   | [S2,MB2,BW] 462-9-471ms    | [S5,MB6,F]  472-7-479ms    | [S5,MB4,BI] 496-10-507ms   | [S5,MB4,BW] 507-9-517ms    | [S2,MB3,BI] 565-9-575ms    | [S2,MB3,BW] 575-10-585ms   | [S5,MB7,F]  590-7-597ms    | [S5,MB5,BI] 597-9-607ms    | [S5,MB5,BW] 607-9-616ms    | [S2,MB4,BI] 647-9-657ms    | [S5,MB6,BI] 662-10-673ms   | [S2,MB5,BI] 673-10-683ms   | [S5,MB7,BI] 735-9-744ms    | [S2,MB6,BI] 744-11-755ms   | [S2,MB4,BW] 755-9-764ms    | [S2,MB7,BI] 771-9-780ms    | [S2,MB5,BW] 780-0-780ms    | [S5,MB6,BW] 780-10-790ms   | [S5,MB7,BW] 791-2-793ms    | [S2,MB6,BW] 794-0-794ms    | [S2,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 282-10-292ms   | [S4,MB1,BW] 292-10-302ms   | [S3,MB5,F]  302-8-311ms    | [S3,MB1,BI] 310-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 367-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-395ms    | [S3,MB2,BI] 395-9-405ms    | [S3,MB2,BW] 405-10-415ms   | [S4,MB6,F]  415-8-423ms    | [S4,MB3,BI] 443-12-455ms   | [S4,MB3,BW] 455-9-465ms    | [S3,MB7,F]  465-7-473ms    | [S3,MB3,BI] 472-9-482ms    | [S3,MB3,BW] 482-10-493ms   | [S4,MB7,F]  492-8-501ms    | [S4,MB4,BI] 559-10-569ms   | [S4,MB4,BW] 569-9-579ms    | [S3,MB4,BI] 579-10-589ms   | [S4,MB5,BI] 641-10-651ms   | [S3,MB5,BI] 651-9-660ms    | [S4,MB6,BI] 673-9-682ms    | [S3,MB6,BI] 683-9-692ms    | [S4,MB7,BI] 745-9-754ms    | [S3,MB7,BI] 755-9-764ms    | [S3,MB4,BW] 764-0-764ms    | [S4,MB5,BW] 764-10-774ms   | [S4,MB6,BW] 774-9-784ms    | [S4,MB7,BW] 784-5-789ms    | [S3,MB5,BW] 789-0-789ms    | [S3,MB6,BW] 789-0-789ms    | [S3,MB7,BW] 789-0-789ms   
[rank3]:2025-12-26 15:49:32,606 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1549_stage3_step400.svg
[rank1]:2025-12-26 15:49:32,556 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank1_stage6.svg
[rank1]:	> Counts Sum: 30960, Total Sum: 184320 (16.80%), Ratio(%) per element: [17.96, 17.18, 16.79, 17.57, 17.57, 17.18, 17.18, 15.23, 15.23, 17.57, 16.79, 17.57, 17.18, 17.18, 17.57, 17.18, 14.45, 14.84]
[rank3]:2025-12-26 15:49:32,653 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1549_stage4_step400.svg
[rank3]:2025-12-26 15:49:32,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank3_stage3.svg
[rank3]:	> Counts Sum: 89280, Total Sum: 184320 (48.44%), Ratio(%) per element: [49.6, 50.78, 51.17, 49.6, 50.78, 51.17, 49.21, 42.18, 41.4, 49.6, 50.0, 51.56, 49.21, 50.39, 50.0, 50.39, 44.14, 40.62]
[rank3]:2025-12-26 15:49:32,855 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1549_rank3_stage4.svg
[rank3]:	> Counts Sum: 20240, Total Sum: 184320 (10.98%), Ratio(%) per element: [10.93, 12.5, 11.71, 12.89, 13.28, 11.32, 11.32, 6.64, 6.64, 12.1, 12.5, 13.28, 12.89, 10.93, 11.71, 13.67, 6.64, 6.64]
[rank2]:2025-12-26 15:49:32,949 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage2.svg
[rank1]:2025-12-26 15:49:32,988 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage1.svg
[rank0]:2025-12-26 15:49:32,956 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage0.svg
[rank3]:2025-12-26 15:49:33,314 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage3.svg
[rank2]:2025-12-26 15:49:33,371 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage5.svg
[rank1]:2025-12-26 15:49:33,424 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage6.svg
[rank0]:2025-12-26 15:49:33,408 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage7.svg
[rank3]:2025-12-26 15:49:33,731 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1549_stage4.svg
[rank0]:2025-12-26 15:49:52,573 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-26 15:49:53,104 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-26 15:49:53,108 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-26 15:49:53,114 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-26 15:52:21,858 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-26 15:52:25,725 - Avg. fwd time: 8.3058 / Avg. bwd-weight time: 7.9257 / Avg. bwd-input time: 10.2211 / Avg. batch time: 862.2685 (ms) / GPU bubble ratio: 50.92%
[rank1]:2025-12-26 15:52:25,728 - Avg. fwd time: 9.9613 / Avg. bwd-weight time: 9.3455 / Avg. bwd-input time: 12.6286 / Avg. batch time: 884.2575 (ms) / GPU bubble ratio: 42.22%
[rank0]:2025-12-26 15:52:25,728 - Avg. fwd time: 13.3307 / Avg. full-bwd time: 12.6589 (Avg. bwd-weight time: 13.5623 / Avg. bwd-input time: 34.3180) / Avg. batch time: 904.2507 (ms) / GPU bubble ratio: 22.85%
[rank3]:2025-12-26 15:52:25,719 - Avg. fwd time: 7.8167 / Avg. bwd-weight time: 7.3580 / Avg. bwd-input time: 9.8288 / Avg. batch time: 848.7367 (ms) / GPU bubble ratio: 52.86%
[rank2]:2025-12-26 15:52:25,774 -  step: 450  loss: -4.0000  grad_norm:  0.1421  memory: 14.74GiB(31.02%)  tps: 9,440  tflops: 73.80  mfu: 23.65%
[rank0]:2025-12-26 15:52:25,800 -  step: 450  loss:  0.2292  grad_norm:  0.1421  memory: 40.73GiB(85.74%)  tps: 9,439  tflops: 73.79  mfu: 23.65%
[rank1]:2025-12-26 15:52:25,777 -  step: 450  loss: -4.0000  grad_norm:  0.1421  memory: 18.98GiB(39.95%)  tps: 9,440  tflops: 73.80  mfu: 23.65%
[rank3]:2025-12-26 15:52:25,774 -  step: 450  loss: -4.0000  grad_norm:  0.1421  memory: 16.18GiB(34.07%)  tps: 9,440  tflops: 73.80  mfu: 23.65%
[rank0]:2025-12-26 15:55:13,248 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 15:55:17,147 - Avg. fwd time: 9.9711 / Avg. bwd-weight time: 9.3000 / Avg. bwd-input time: 12.6545 / Avg. batch time: 875.8178 (ms) / GPU bubble ratio: 41.68%
[rank0]:2025-12-26 15:55:17,148 - Avg. fwd time: 13.3003 / Avg. full-bwd time: 12.0876 (Avg. bwd-weight time: 12.8444 / Avg. bwd-input time: 34.2860) / Avg. batch time: 895.4443 (ms) / GPU bubble ratio: 23.33%
[rank2]:2025-12-26 15:55:17,144 - Avg. fwd time: 8.3121 / Avg. bwd-weight time: 7.9104 / Avg. bwd-input time: 10.2317 / Avg. batch time: 854.2021 (ms) / GPU bubble ratio: 50.45%
[rank3]:2025-12-26 15:55:17,142 - Avg. fwd time: 7.8195 / Avg. bwd-weight time: 7.3244 / Avg. bwd-input time: 9.8408 / Avg. batch time: 840.5476 (ms) / GPU bubble ratio: 52.44%
[rank3]:2025-12-26 15:55:17,194 -  step: 500  loss: -4.0000  grad_norm:  0.1676  memory: 16.18GiB(34.07%)  tps: 9,558  tflops: 74.72  mfu: 23.95%
[rank1]:2025-12-26 15:55:17,197 -  step: 500  loss: -4.0000  grad_norm:  0.1676  memory: 18.98GiB(39.95%)  tps: 9,558  tflops: 74.72  mfu: 23.95%
[rank0]:2025-12-26 15:55:17,219 -  step: 500  loss:  0.2257  grad_norm:  0.1676  memory: 40.73GiB(85.74%)  tps: 9,558  tflops: 74.72  mfu: 23.95%
[rank2]:2025-12-26 15:55:17,193 -  step: 500  loss: -4.0000  grad_norm:  0.1676  memory: 14.74GiB(31.02%)  tps: 9,558  tflops: 74.72  mfu: 23.95%
[rank2]:2025-12-26 15:55:17,270 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1555_stage2_step500.svg
[rank1]:2025-12-26 15:55:17,270 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1555_stage1_step500.svg
[rank1]:2025-12-26 15:55:17,311 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1555_stage6_step500.svg
[rank0]:2025-12-26 15:55:17,271 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1555_stage0_step500.svg
[rank0]:2025-12-26 15:55:17,312 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1555_stage7_step500.svg
[rank2]:2025-12-26 15:55:17,311 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1555_stage5_step500.svg
[rank1]:2025-12-26 15:55:17,441 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank1_stage1.svg
[rank1]:	> Counts Sum: 169680, Total Sum: 362880 (46.76%), Ratio(%) per element: [51.19, 52.38, 51.78, 53.27, 50.59, 51.19, 50.59, 27.08, 27.67, 51.78, 53.57, 51.48, 52.08, 55.05, 53.27, 52.38, 28.57, 27.67, 54.16, 50.59, 52.08, 50.59, 50.59, 52.67, 53.86, 28.27, 27.97]
[rank0]:2025-12-26 15:55:17,417 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank0_stage0.svg
[rank0]:	> Counts Sum: 191320, Total Sum: 255360 (74.92%), Ratio(%) per element: [79.16, 79.76, 80.95, 81.25, 79.16, 80.35, 83.03, 82.14, 53.27, 52.38, 79.76, 82.14, 80.05, 78.86, 78.86, 80.65, 79.76, 53.57, 58.33]
[rank2]:2025-12-26 15:55:17,411 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank2_stage2.svg
[rank2]:	> Counts Sum: 98960, Total Sum: 241920 (40.91%), Ratio(%) per element: [42.55, 42.85, 43.15, 42.26, 43.75, 41.07, 43.15, 33.63, 33.33, 41.66, 43.75, 44.94, 43.75, 42.85, 42.55, 43.15, 33.33, 34.52]
[rank1]:2025-12-26 15:55:17,541 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank1_stage6.svg
[rank1]:	> Counts Sum: 38160, Total Sum: 241920 (15.77%), Ratio(%) per element: [16.66, 16.07, 15.77, 16.36, 16.36, 16.07, 16.07, 14.58, 14.58, 16.36, 15.77, 16.36, 16.07, 16.07, 16.36, 16.07, 13.98, 14.28]
[rank0]:2025-12-26 15:55:17,500 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank0_stage7.svg
[rank0]:	> Counts Sum: 110120, Total Sum: 147840 (74.49%), Ratio(%) per element: [81.84, 83.03, 81.84, 82.44, 81.25, 80.65, 84.22, 61.6, 60.11, 59.52, 62.79]
[rank2]:2025-12-26 15:55:17,510 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank2_stage5.svg
[rank2]:	> Counts Sum: 23360, Total Sum: 241920 (9.66%), Ratio(%) per element: [11.3, 10.11, 11.3, 10.41, 10.41, 10.11, 10.11, 5.05, 4.76, 10.11, 10.11, 12.79, 11.3, 12.2, 11.3, 12.2, 5.05, 5.05]
[rank3]:2025-12-26 15:55:17,546 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1555_step500_rank3.svg
[rank3]:			> Batch Time: 813.50 ms, GPU Bubble Ratio: 27.33%, 37.34%, 48.06%, 51.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-25-200ms   | [S7,MB1,F]  200-16-216ms   | [S7,MB1,BI] 228-34-262ms   | [S7,MB1,BW] 262-0-262ms    | [S7,MB2,F]  262-18-280ms   | [S7,MB2,BI] 294-35-329ms   | [S7,MB2,BW] 329-0-329ms    | [S7,MB3,F]  329-19-349ms   | [S7,MB3,BI] 360-35-395ms   | [S7,MB3,BW] 395-0-395ms    | [S0,MB7,F]  395-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  414-18-432ms   | [S7,MB4,BI] 444-34-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  486-0-486ms    | [S7,MB5,F]  490-16-507ms   | [S7,MB5,BI] 519-33-552ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  559-0-559ms    | [S7,MB6,F]  574-15-589ms   | [S7,MB6,BI] 601-33-634ms   | [S7,MB6,BW] 635-0-635ms    | [S0,MB3,B]  642-0-642ms    | [S7,MB7,F]  656-14-670ms   | [S7,MB7,BI] 683-32-716ms   | [S7,MB7,BW] 717-25-742ms   | [S0,MB4,B]  743-18-762ms   | [S0,MB5,B]  761-23-785ms   | [S0,MB6,B]  788-18-807ms   | [S0,MB7,B]  813-0-813ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 262-9-271ms    | [S6,MB1,BW] 271-10-282ms   | [S6,MB3,F]  282-7-289ms    | [S6,MB2,BI] 329-9-338ms    | [S6,MB2,BW] 338-10-349ms   | [S1,MB6,F]  349-10-360ms   | [S1,MB0,BI] 360-15-376ms   | [S1,MB0,BW] 376-15-391ms   | [S6,MB4,F]  391-9-400ms    | [S6,MB3,BI] 400-12-412ms   | [S6,MB3,BW] 412-11-424ms   | [S1,MB7,F]  424-12-436ms   | [S1,MB1,BI] 436-17-453ms   | [S1,MB1,BW] 454-17-471ms   | [S6,MB5,F]  471-10-482ms   | [S6,MB4,BI] 482-12-494ms   | [S6,MB4,BW] 494-12-507ms   | [S1,MB2,BI] 507-16-523ms   | [S1,MB2,BW] 523-16-540ms   | [S6,MB6,F]  559-7-567ms    | [S6,MB5,BI] 567-10-577ms   | [S6,MB5,BW] 577-10-588ms   | [S1,MB3,BI] 588-14-603ms   | [S1,MB3,BW] 603-12-616ms   | [S6,MB7,F]  641-7-649ms    | [S6,MB6,BI] 649-10-659ms   | [S6,MB6,BW] 659-10-670ms   | [S1,MB4,BI] 670-14-684ms   | [S6,MB7,BI] 718-9-728ms    | [S1,MB5,BI] 736-15-751ms   | [S1,MB4,BW] 751-2-754ms    | [S1,MB6,BI] 766-14-780ms   | [S1,MB5,BW] 780-0-781ms    | [S1,MB7,BI] 791-14-805ms   | [S1,MB6,BW] 805-0-805ms    | [S6,MB7,BW] 805-0-805ms    | [S1,MB7,BW] 805-0-805ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 272-9-281ms    | [S5,MB1,BW] 281-11-292ms   | [S2,MB5,F]  292-7-300ms    | [S2,MB0,BI] 300-10-310ms   | [S2,MB0,BW] 310-9-320ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 338-10-349ms   | [S5,MB2,BW] 349-10-359ms   | [S2,MB6,F]  361-10-371ms   | [S2,MB1,BI] 372-11-383ms   | [S2,MB1,BW] 383-10-394ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 413-10-424ms   | [S5,MB3,BW] 424-9-434ms    | [S2,MB7,F]  437-9-447ms    | [S2,MB2,BI] 448-11-459ms   | [S2,MB2,BW] 459-9-469ms    | [S5,MB6,F]  469-7-477ms    | [S5,MB4,BI] 495-10-506ms   | [S5,MB4,BW] 506-9-516ms    | [S2,MB3,BI] 562-9-572ms    | [S2,MB3,BW] 572-10-583ms   | [S5,MB7,F]  587-7-594ms    | [S5,MB5,BI] 594-9-604ms    | [S5,MB5,BW] 604-9-614ms    | [S2,MB4,BI] 644-9-654ms    | [S5,MB6,BI] 659-10-670ms   | [S2,MB5,BI] 670-10-680ms   | [S5,MB7,BI] 738-9-748ms    | [S2,MB6,BI] 748-11-760ms   | [S2,MB4,BW] 759-7-767ms    | [S2,MB7,BI] 775-9-785ms    | [S2,MB5,BW] 784-0-784ms    | [S5,MB6,BW] 784-10-795ms   | [S5,MB7,BW] 795-3-799ms    | [S2,MB6,BW] 799-0-799ms    | [S2,MB7,BW] 799-0-799ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 281-10-292ms   | [S4,MB1,BW] 292-10-302ms   | [S3,MB5,F]  302-8-310ms    | [S3,MB1,BI] 310-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 366-11-377ms   | [S4,MB2,BW] 377-9-387ms    | [S3,MB6,F]  387-7-394ms    | [S3,MB2,BI] 394-9-404ms    | [S3,MB2,BW] 404-10-414ms   | [S4,MB6,F]  414-8-422ms    | [S4,MB3,BI] 442-11-454ms   | [S4,MB3,BW] 454-9-464ms    | [S3,MB7,F]  464-7-471ms    | [S3,MB3,BI] 471-9-481ms    | [S3,MB3,BW] 481-10-491ms   | [S4,MB7,F]  491-8-500ms    | [S4,MB4,BI] 556-10-566ms   | [S4,MB4,BW] 566-9-576ms    | [S3,MB4,BI] 576-10-587ms   | [S4,MB5,BI] 638-10-648ms   | [S3,MB5,BI] 648-9-657ms    | [S4,MB6,BI] 671-9-680ms    | [S3,MB6,BI] 680-9-690ms    | [S4,MB7,BI] 750-9-759ms    | [S3,MB7,BI] 759-9-768ms    | [S3,MB4,BW] 769-0-769ms    | [S4,MB5,BW] 769-10-779ms   | [S4,MB6,BW] 779-9-788ms    | [S4,MB7,BW] 789-2-791ms    | [S3,MB5,BW] 791-0-791ms    | [S3,MB6,BW] 791-0-791ms    | [S3,MB7,BW] 791-0-791ms   
[rank3]:2025-12-26 15:55:17,590 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1555_stage3_step500.svg
[rank3]:2025-12-26 15:55:17,632 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1555_stage4_step500.svg
[rank3]:2025-12-26 15:55:17,735 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank3_stage3.svg
[rank3]:	> Counts Sum: 118080, Total Sum: 241920 (48.81%), Ratio(%) per element: [49.7, 50.59, 50.89, 49.7, 50.59, 50.89, 49.4, 44.04, 43.45, 49.7, 50.0, 51.19, 49.4, 50.29, 50.0, 50.29, 45.53, 42.85]
[rank3]:2025-12-26 15:55:17,836 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1555_rank3_stage4.svg
[rank3]:	> Counts Sum: 23440, Total Sum: 241920 (9.69%), Ratio(%) per element: [10.41, 11.3, 10.41, 11.6, 11.6, 9.22, 10.41, 5.05, 5.05, 10.71, 11.3, 11.6, 11.01, 10.11, 11.3, 12.79, 5.35, 5.05]
[rank2]:2025-12-26 15:55:18,062 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage2.svg
[rank1]:2025-12-26 15:55:18,105 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage1.svg
[rank0]:2025-12-26 15:55:18,072 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage0.svg
[rank3]:2025-12-26 15:55:18,421 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage3.svg
[rank1]:2025-12-26 15:55:18,651 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage6.svg
[rank0]:2025-12-26 15:55:18,647 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage7.svg
[rank2]:2025-12-26 15:55:18,623 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage5.svg
[rank3]:2025-12-26 15:55:18,976 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1555_stage4.svg
[rank0]:2025-12-26 15:58:06,751 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-26 15:58:10,676 - Avg. fwd time: 13.2767 / Avg. full-bwd time: 11.5945 (Avg. bwd-weight time: 12.2532 / Avg. bwd-input time: 34.2584) / Avg. batch time: 888.5596 (ms) / GPU bubble ratio: 23.78%
[rank1]:2025-12-26 15:58:10,676 - Avg. fwd time: 9.9772 / Avg. bwd-weight time: 9.2637 / Avg. bwd-input time: 12.6713 / Avg. batch time: 869.2842 (ms) / GPU bubble ratio: 41.26%
[rank2]:2025-12-26 15:58:10,672 - Avg. fwd time: 8.3165 / Avg. bwd-weight time: 7.8923 / Avg. bwd-input time: 10.2391 / Avg. batch time: 847.9641 (ms) / GPU bubble ratio: 50.10%
[rank3]:2025-12-26 15:58:10,671 - Avg. fwd time: 7.8228 / Avg. bwd-weight time: 7.2990 / Avg. bwd-input time: 9.8507 / Avg. batch time: 834.1366 (ms) / GPU bubble ratio: 52.10%
[rank3]:2025-12-26 15:58:10,722 -  step: 550  loss: -4.0000  grad_norm:  0.1470  memory: 16.18GiB(34.07%)  tps: 9,442  tflops: 73.81  mfu: 23.66%
[rank0]:2025-12-26 15:58:10,748 -  step: 550  loss:  0.2292  grad_norm:  0.1470  memory: 40.73GiB(85.74%)  tps: 9,442  tflops: 73.81  mfu: 23.66%
[rank1]:2025-12-26 15:58:10,725 -  step: 550  loss: -4.0000  grad_norm:  0.1470  memory: 18.98GiB(39.95%)  tps: 9,442  tflops: 73.81  mfu: 23.66%
[rank2]:2025-12-26 15:58:10,722 -  step: 550  loss: -4.0000  grad_norm:  0.1470  memory: 14.74GiB(31.02%)  tps: 9,442  tflops: 73.81  mfu: 23.66%
[rank0]:2025-12-26 16:00:59,097 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 16:01:03,142 - Avg. fwd time: 9.9793 / Avg. bwd-weight time: 9.2318 / Avg. bwd-input time: 12.6841 / Avg. batch time: 863.9911 (ms) / GPU bubble ratio: 40.93%
[rank1]:2025-12-26 16:01:03,191 -  step: 600  loss: -4.0000  grad_norm:  0.1194  memory: 18.98GiB(39.95%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank2]:2025-12-26 16:01:03,138 - Avg. fwd time: 8.3210 / Avg. bwd-weight time: 7.8759 / Avg. bwd-input time: 10.2445 / Avg. batch time: 842.9029 (ms) / GPU bubble ratio: 49.81%
[rank2]:2025-12-26 16:01:03,188 -  step: 600  loss: -4.0000  grad_norm:  0.1194  memory: 14.74GiB(31.02%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank0]:2025-12-26 16:01:03,142 - Avg. fwd time: 13.2608 / Avg. full-bwd time: 11.2188 (Avg. bwd-weight time: 11.8259 / Avg. bwd-input time: 34.2382) / Avg. batch time: 883.0438 (ms) / GPU bubble ratio: 24.08%
[rank3]:2025-12-26 16:01:03,138 - Avg. fwd time: 7.8247 / Avg. bwd-weight time: 7.2800 / Avg. bwd-input time: 9.8571 / Avg. batch time: 829.0892 (ms) / GPU bubble ratio: 51.83%
[rank3]:2025-12-26 16:01:03,188 -  step: 600  loss: -4.0000  grad_norm:  0.1194  memory: 16.18GiB(34.07%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank1]:2025-12-26 16:01:03,265 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1601_stage1_step600.svg
[rank2]:2025-12-26 16:01:03,265 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1601_stage2_step600.svg
[rank0]:2025-12-26 16:01:03,212 -  step: 600  loss:  0.2241  grad_norm:  0.1194  memory: 40.73GiB(85.74%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank0]:2025-12-26 16:01:03,267 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1601_stage0_step600.svg
[rank1]:2025-12-26 16:01:03,308 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1601_stage6_step600.svg
[rank2]:2025-12-26 16:01:03,308 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1601_stage5_step600.svg
[rank0]:2025-12-26 16:01:03,310 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1601_stage7_step600.svg
[rank1]:2025-12-26 16:01:03,435 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank1_stage1.svg
[rank1]:	> Counts Sum: 210880, Total Sum: 449280 (46.94%), Ratio(%) per element: [51.68, 51.92, 52.64, 53.6, 51.44, 50.24, 51.2, 27.88, 27.64, 52.4, 52.88, 51.68, 51.92, 54.56, 52.4, 53.36, 28.84, 27.64, 53.84, 50.48, 52.64, 51.92, 51.2, 52.4, 53.6, 29.32, 27.88]
[rank2]:2025-12-26 16:01:03,408 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank2_stage2.svg
[rank2]:	> Counts Sum: 122560, Total Sum: 299520 (40.92%), Ratio(%) per element: [42.06, 43.26, 43.26, 42.3, 43.02, 41.1, 43.02, 34.37, 34.13, 41.58, 43.02, 43.99, 43.26, 42.78, 42.78, 43.26, 34.13, 35.09]
[rank0]:2025-12-26 16:01:03,422 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank0_stage0.svg
[rank0]:	> Counts Sum: 239720, Total Sum: 316160 (75.82%), Ratio(%) per element: [79.56, 80.76, 81.49, 82.45, 80.28, 79.8, 82.69, 82.93, 55.04, 54.32, 81.0, 81.97, 82.21, 80.52, 79.08, 81.25, 80.76, 55.28, 59.13]
[rank1]:2025-12-26 16:01:03,535 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank1_stage6.svg
[rank1]:	> Counts Sum: 45360, Total Sum: 299520 (15.14%), Ratio(%) per element: [15.86, 15.38, 15.14, 15.62, 15.62, 15.38, 15.38, 14.18, 14.18, 15.62, 15.14, 15.62, 15.38, 15.38, 15.62, 15.38, 13.7, 13.94]
[rank2]:2025-12-26 16:01:03,508 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank2_stage5.svg
[rank2]:	> Counts Sum: 26560, Total Sum: 299520 (8.87%), Ratio(%) per element: [10.57, 9.37, 10.81, 9.61, 10.09, 9.37, 10.57, 4.08, 3.84, 9.85, 8.89, 11.53, 10.33, 11.29, 10.57, 10.57, 4.08, 4.08]
[rank0]:2025-12-26 16:01:03,505 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank0_stage7.svg
[rank0]:	> Counts Sum: 138120, Total Sum: 183040 (75.46%), Ratio(%) per element: [82.21, 83.17, 82.69, 82.93, 82.21, 80.52, 83.89, 63.22, 62.5, 61.77, 64.9]
[rank3]:2025-12-26 16:01:03,583 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1601_step600_rank3.svg
[rank3]:			> Batch Time: 811.50 ms, GPU Bubble Ratio: 25.96%, 37.13%, 48.04%, 50.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  18-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-27-203ms   | [S7,MB1,F]  202-17-220ms   | [S7,MB1,BI] 232-34-266ms   | [S7,MB1,BW] 266-0-266ms    | [S7,MB2,F]  266-18-284ms   | [S7,MB2,BI] 296-35-332ms   | [S7,MB2,BW] 333-0-333ms    | [S7,MB3,F]  333-19-353ms   | [S7,MB3,BI] 364-35-399ms   | [S7,MB3,BW] 399-0-399ms    | [S0,MB7,F]  399-10-410ms   | [S0,MB0,B]  410-0-410ms    | [S7,MB4,F]  418-18-436ms   | [S7,MB4,BI] 448-34-482ms   | [S7,MB4,BW] 482-0-482ms    | [S0,MB1,B]  490-0-490ms    | [S7,MB5,F]  495-16-511ms   | [S7,MB5,BI] 523-33-556ms   | [S7,MB5,BW] 557-0-557ms    | [S0,MB2,B]  564-0-564ms    | [S7,MB6,F]  579-15-594ms   | [S7,MB6,BI] 606-33-639ms   | [S7,MB6,BW] 639-0-639ms    | [S0,MB3,B]  646-0-646ms    | [S7,MB7,F]  660-14-674ms   | [S7,MB7,BI] 687-33-720ms   | [S7,MB7,BW] 720-26-746ms   | [S0,MB4,B]  747-19-766ms   | [S0,MB5,B]  766-25-791ms   | [S0,MB6,B]  792-18-810ms   | [S0,MB7,B]  811-0-811ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  45-10-56ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-107ms    | [S1,MB5,F]  106-13-120ms   | [S6,MB1,F]  120-8-128ms    | [S6,MB0,BI] 175-9-185ms    | [S6,MB0,BW] 185-10-195ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 266-9-275ms    | [S6,MB1,BW] 275-10-285ms   | [S6,MB3,F]  285-7-293ms    | [S6,MB2,BI] 332-9-342ms    | [S6,MB2,BW] 342-10-353ms   | [S1,MB6,F]  353-11-364ms   | [S1,MB0,BI] 364-15-380ms   | [S1,MB0,BW] 380-15-395ms   | [S6,MB4,F]  395-9-405ms    | [S6,MB3,BI] 405-12-417ms   | [S6,MB3,BW] 417-11-429ms   | [S1,MB7,F]  429-12-441ms   | [S1,MB1,BI] 441-17-459ms   | [S1,MB1,BW] 459-17-476ms   | [S6,MB5,F]  476-10-487ms   | [S6,MB4,BI] 487-11-499ms   | [S6,MB4,BW] 499-12-511ms   | [S1,MB2,BI] 511-16-528ms   | [S1,MB2,BW] 528-15-543ms   | [S6,MB6,F]  564-7-571ms    | [S6,MB5,BI] 571-10-582ms   | [S6,MB5,BW] 582-10-592ms   | [S1,MB3,BI] 592-14-607ms   | [S1,MB3,BW] 607-11-619ms   | [S6,MB7,F]  645-7-653ms    | [S6,MB6,BI] 653-10-663ms   | [S6,MB6,BW] 663-10-674ms   | [S1,MB4,BI] 674-14-688ms   | [S6,MB7,BI] 720-10-731ms   | [S1,MB5,BI] 732-15-747ms   | [S1,MB4,BW] 747-4-751ms    | [S1,MB6,BI] 762-14-776ms   | [S1,MB5,BW] 776-0-776ms    | [S1,MB7,BI] 787-14-801ms   | [S1,MB6,BW] 801-0-801ms    | [S6,MB7,BW] 801-0-801ms    | [S1,MB7,BW] 801-0-801ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  56-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  74-9-83ms      | [S5,MB1,F]  83-7-91ms      | [S2,MB4,F]  96-10-107ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 185-9-194ms    | [S5,MB0,BW] 194-10-205ms   | [S5,MB3,F]  204-7-212ms    | [S5,MB1,BI] 275-9-285ms    | [S5,MB1,BW] 285-11-296ms   | [S2,MB5,F]  296-7-303ms    | [S2,MB0,BI] 303-10-314ms   | [S2,MB0,BW] 314-9-323ms    | [S5,MB4,F]  323-7-331ms    | [S5,MB2,BI] 342-10-353ms   | [S5,MB2,BW] 353-10-363ms   | [S2,MB6,F]  365-10-375ms   | [S2,MB1,BI] 376-11-387ms   | [S2,MB1,BW] 387-10-397ms   | [S5,MB5,F]  397-7-405ms    | [S5,MB3,BI] 418-10-428ms   | [S5,MB3,BW] 429-9-439ms    | [S2,MB7,F]  442-9-452ms    | [S2,MB2,BI] 454-11-465ms   | [S2,MB2,BW] 465-9-475ms    | [S5,MB6,F]  475-7-483ms    | [S5,MB4,BI] 499-10-510ms   | [S5,MB4,BW] 510-9-520ms    | [S2,MB3,BI] 567-9-576ms    | [S2,MB3,BW] 576-10-587ms   | [S5,MB7,F]  591-7-599ms    | [S5,MB5,BI] 599-9-608ms    | [S5,MB5,BW] 608-9-618ms    | [S2,MB4,BI] 648-9-658ms    | [S5,MB6,BI] 663-10-674ms   | [S2,MB5,BI] 674-10-684ms   | [S5,MB7,BI] 734-9-743ms    | [S2,MB6,BI] 743-11-755ms   | [S2,MB4,BW] 755-6-761ms    | [S2,MB7,BI] 770-9-780ms    | [S2,MB5,BW] 780-0-780ms    | [S5,MB6,BW] 780-10-791ms   | [S5,MB7,BW] 791-3-795ms    | [S2,MB6,BW] 794-0-794ms    | [S2,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-55ms      | [S4,MB1,F]  55-7-62ms      | [S3,MB2,F]  64-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-106ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 204-9-213ms    | [S3,MB4,F]  213-7-220ms    | [S3,MB0,BI] 220-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  239-7-247ms    | [S4,MB1,BI] 285-10-295ms   | [S4,MB1,BW] 295-10-305ms   | [S3,MB5,F]  305-8-313ms    | [S3,MB1,BI] 313-9-323ms    | [S3,MB1,BW] 323-9-333ms    | [S4,MB5,F]  333-7-340ms    | [S4,MB2,BI] 369-11-381ms   | [S4,MB2,BW] 381-9-391ms    | [S3,MB6,F]  391-7-398ms    | [S3,MB2,BI] 398-9-407ms    | [S3,MB2,BW] 407-10-417ms   | [S4,MB6,F]  418-8-426ms    | [S4,MB3,BI] 447-11-459ms   | [S4,MB3,BW] 459-9-469ms    | [S3,MB7,F]  469-7-476ms    | [S3,MB3,BI] 476-9-486ms    | [S3,MB3,BW] 486-10-496ms   | [S4,MB7,F]  496-8-504ms    | [S4,MB4,BI] 561-10-571ms   | [S4,MB4,BW] 571-9-580ms    | [S3,MB4,BI] 581-10-591ms   | [S4,MB5,BI] 642-10-652ms   | [S3,MB5,BI] 652-9-661ms    | [S4,MB6,BI] 675-9-684ms    | [S3,MB6,BI] 684-9-693ms    | [S4,MB7,BI] 746-9-755ms    | [S3,MB7,BI] 755-9-764ms    | [S3,MB4,BW] 764-0-764ms    | [S4,MB5,BW] 765-10-775ms   | [S4,MB6,BW] 775-9-784ms    | [S4,MB7,BW] 784-6-790ms    | [S3,MB5,BW] 791-0-791ms    | [S3,MB6,BW] 791-0-791ms    | [S3,MB7,BW] 791-0-791ms   
[rank3]:2025-12-26 16:01:03,635 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1601_stage3_step600.svg
[rank3]:2025-12-26 16:01:03,684 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1601_stage4_step600.svg
[rank3]:2025-12-26 16:01:03,798 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank3_stage3.svg
[rank3]:	> Counts Sum: 146880, Total Sum: 299520 (49.04%), Ratio(%) per element: [49.75, 50.48, 50.72, 49.75, 50.48, 50.72, 49.51, 45.19, 44.71, 49.75, 50.0, 50.96, 49.51, 50.24, 50.0, 50.24, 46.39, 44.23]
[rank3]:2025-12-26 16:01:03,911 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1601_rank3_stage4.svg
[rank3]:	> Counts Sum: 26640, Total Sum: 299520 (8.89%), Ratio(%) per element: [9.85, 10.81, 9.85, 10.33, 10.81, 8.65, 9.61, 4.08, 4.08, 10.09, 10.33, 11.29, 10.09, 10.33, 9.61, 11.53, 4.32, 4.32]
[rank2]:2025-12-26 16:01:04,207 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage2.svg
[rank1]:2025-12-26 16:01:04,248 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage1.svg
[rank0]:2025-12-26 16:01:04,224 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage0.svg
[rank3]:2025-12-26 16:01:04,677 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage3.svg
[rank2]:2025-12-26 16:01:04,880 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage5.svg
[rank1]:2025-12-26 16:01:04,932 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage6.svg
[rank0]:2025-12-26 16:01:04,918 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage7.svg
[rank3]:2025-12-26 16:01:05,376 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1601_stage4.svg
[rank0]:2025-12-26 16:03:54,613 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-26 16:03:58,602 - Avg. fwd time: 9.9777 / Avg. bwd-weight time: 9.2034 / Avg. bwd-input time: 12.6905 / Avg. batch time: 860.1183 (ms) / GPU bubble ratio: 40.71%
[rank2]:2025-12-26 16:03:58,599 - Avg. fwd time: 8.3239 / Avg. bwd-weight time: 7.8629 / Avg. bwd-input time: 10.2480 / Avg. batch time: 839.2744 (ms) / GPU bubble ratio: 49.60%
[rank0]:2025-12-26 16:03:58,602 - Avg. fwd time: 13.2392 / Avg. full-bwd time: 10.8468 (Avg. bwd-weight time: 11.4905 / Avg. bwd-input time: 34.2157) / Avg. batch time: 878.9107 (ms) / GPU bubble ratio: 24.42%
[rank3]:2025-12-26 16:03:58,597 - Avg. fwd time: 7.8256 / Avg. bwd-weight time: 7.2603 / Avg. bwd-input time: 9.8615 / Avg. batch time: 825.2384 (ms) / GPU bubble ratio: 51.63%
[rank3]:2025-12-26 16:03:58,648 -  step: 650  loss: -4.0000  grad_norm:  0.1214  memory: 16.18GiB(34.07%)  tps: 9,338  tflops: 73.00  mfu: 23.40%
[rank1]:2025-12-26 16:03:58,651 -  step: 650  loss: -4.0000  grad_norm:  0.1214  memory: 18.98GiB(39.95%)  tps: 9,338  tflops: 73.00  mfu: 23.40%
[rank2]:2025-12-26 16:03:58,648 -  step: 650  loss: -4.0000  grad_norm:  0.1214  memory: 14.74GiB(31.02%)  tps: 9,338  tflops: 73.00  mfu: 23.40%
[rank0]:2025-12-26 16:03:58,672 -  step: 650  loss:  0.2315  grad_norm:  0.1214  memory: 40.73GiB(85.74%)  tps: 9,338  tflops: 73.00  mfu: 23.40%
[rank0]:2025-12-26 16:06:47,001 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 16:06:50,886 - Avg. fwd time: 9.9800 / Avg. bwd-weight time: 9.1759 / Avg. bwd-input time: 12.7004 / Avg. batch time: 856.1337 (ms) / GPU bubble ratio: 40.46%
[rank0]:2025-12-26 16:06:50,886 - Avg. fwd time: 13.2260 / Avg. full-bwd time: 10.5883 (Avg. bwd-weight time: 11.1662 / Avg. bwd-input time: 34.1979) / Avg. batch time: 874.7197 (ms) / GPU bubble ratio: 24.63%
[rank2]:2025-12-26 16:06:50,884 - Avg. fwd time: 8.3269 / Avg. bwd-weight time: 7.8534 / Avg. bwd-input time: 10.2520 / Avg. batch time: 835.5121 (ms) / GPU bubble ratio: 49.38%
[rank3]:2025-12-26 16:06:50,880 - Avg. fwd time: 7.8268 / Avg. bwd-weight time: 7.2437 / Avg. bwd-input time: 9.8660 / Avg. batch time: 821.4197 (ms) / GPU bubble ratio: 51.43%
[rank1]:2025-12-26 16:06:50,934 -  step: 700  loss: -4.0000  grad_norm:  0.1271  memory: 18.98GiB(39.95%)  tps: 9,510  tflops: 74.34  mfu: 23.83%
[rank1]:2025-12-26 16:06:51,011 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1606_stage1_step700.svg
[rank0]:2025-12-26 16:06:50,955 -  step: 700  loss:  0.1919  grad_norm:  0.1271  memory: 40.73GiB(85.74%)  tps: 9,510  tflops: 74.34  mfu: 23.83%
[rank0]:2025-12-26 16:06:51,012 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1606_stage0_step700.svg
[rank2]:2025-12-26 16:06:50,931 -  step: 700  loss: -4.0000  grad_norm:  0.1271  memory: 14.74GiB(31.02%)  tps: 9,510  tflops: 74.34  mfu: 23.83%
[rank2]:2025-12-26 16:06:51,010 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1606_stage2_step700.svg
[rank3]:2025-12-26 16:06:50,931 -  step: 700  loss: -4.0000  grad_norm:  0.1271  memory: 16.18GiB(34.07%)  tps: 9,510  tflops: 74.34  mfu: 23.83%
[rank1]:2025-12-26 16:06:51,056 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1606_stage6_step700.svg
[rank0]:2025-12-26 16:06:51,059 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1606_stage7_step700.svg
[rank2]:2025-12-26 16:06:51,055 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1606_stage5_step700.svg
[rank1]:2025-12-26 16:06:51,181 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank1_stage1.svg
[rank1]:	> Counts Sum: 252080, Total Sum: 535680 (47.06%), Ratio(%) per element: [52.21, 51.41, 52.21, 54.03, 52.21, 51.0, 51.2, 28.02, 27.82, 52.21, 52.82, 52.41, 51.81, 54.23, 52.21, 53.22, 29.03, 28.22, 53.02, 50.8, 52.82, 52.62, 51.0, 52.41, 53.62, 29.83, 28.02]
[rank0]:2025-12-26 16:06:51,169 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank0_stage0.svg
[rank0]:	> Counts Sum: 288120, Total Sum: 376960 (76.43%), Ratio(%) per element: [79.43, 81.65, 81.45, 83.06, 80.84, 80.84, 83.46, 83.06, 56.25, 55.84, 80.64, 81.85, 82.86, 81.65, 80.24, 81.65, 81.04, 56.45, 59.87]
[rank2]:2025-12-26 16:06:51,157 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank2_stage2.svg
[rank2]:	> Counts Sum: 146160, Total Sum: 357120 (40.93%), Ratio(%) per element: [41.73, 42.94, 42.94, 41.93, 43.14, 41.12, 42.74, 34.87, 34.67, 41.73, 42.74, 43.54, 43.14, 43.14, 42.74, 43.34, 34.67, 35.48]
[rank1]:2025-12-26 16:06:51,281 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank1_stage6.svg
[rank1]:	> Counts Sum: 52560, Total Sum: 357120 (14.72%), Ratio(%) per element: [15.32, 14.91, 14.71, 15.12, 15.12, 14.91, 14.91, 13.91, 13.91, 15.12, 14.71, 15.12, 14.91, 14.91, 15.12, 14.91, 13.5, 13.7]
[rank0]:2025-12-26 16:06:51,254 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank0_stage7.svg
[rank0]:	> Counts Sum: 166120, Total Sum: 218240 (76.12%), Ratio(%) per element: [82.66, 83.26, 82.45, 83.26, 82.25, 81.25, 84.07, 64.51, 64.31, 63.3, 65.92]
[rank2]:2025-12-26 16:06:51,257 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank2_stage5.svg
[rank2]:	> Counts Sum: 29760, Total Sum: 357120 (8.33%), Ratio(%) per element: [10.48, 9.27, 10.08, 9.07, 9.47, 8.87, 9.27, 3.42, 3.22, 9.27, 8.06, 11.49, 9.87, 10.48, 10.08, 10.68, 3.42, 3.42]
[rank3]:2025-12-26 16:06:51,296 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1606_step700_rank3.svg
[rank3]:			> Batch Time: 813.50 ms, GPU Bubble Ratio: 28.28%, 37.47%, 48.05%, 51.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-25-199ms   | [S7,MB1,F]  199-15-215ms   | [S7,MB1,BI] 227-34-262ms   | [S7,MB1,BW] 262-0-262ms    | [S7,MB2,F]  262-18-280ms   | [S7,MB2,BI] 292-35-327ms   | [S7,MB2,BW] 327-0-327ms    | [S7,MB3,F]  327-20-347ms   | [S7,MB3,BI] 360-35-395ms   | [S7,MB3,BW] 395-0-395ms    | [S0,MB7,F]  395-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  414-18-432ms   | [S7,MB4,BI] 444-33-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  486-0-486ms    | [S7,MB5,F]  489-15-505ms   | [S7,MB5,BI] 518-33-551ms   | [S7,MB5,BW] 551-0-551ms    | [S0,MB2,B]  558-0-558ms    | [S7,MB6,F]  572-15-587ms   | [S7,MB6,BI] 599-33-632ms   | [S7,MB6,BW] 632-0-632ms    | [S0,MB3,B]  638-0-638ms    | [S7,MB7,F]  653-14-667ms   | [S7,MB7,BI] 679-32-711ms   | [S7,MB7,BW] 711-25-736ms   | [S0,MB4,B]  737-12-749ms   | [S0,MB5,B]  761-23-784ms   | [S0,MB6,B]  788-19-807ms   | [S0,MB7,B]  813-0-813ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  85-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 261-9-271ms    | [S6,MB1,BW] 271-10-281ms   | [S6,MB3,F]  281-7-289ms    | [S6,MB2,BI] 327-9-336ms    | [S6,MB2,BW] 336-10-347ms   | [S1,MB6,F]  347-10-358ms   | [S1,MB0,BI] 358-16-374ms   | [S1,MB0,BW] 374-15-390ms   | [S6,MB4,F]  390-9-399ms    | [S6,MB3,BI] 399-12-411ms   | [S6,MB3,BW] 411-11-423ms   | [S1,MB7,F]  423-12-436ms   | [S1,MB1,BI] 436-17-454ms   | [S1,MB1,BW] 454-17-471ms   | [S6,MB5,F]  471-10-481ms   | [S6,MB4,BI] 481-12-494ms   | [S6,MB4,BW] 494-12-506ms   | [S1,MB2,BI] 506-16-522ms   | [S1,MB2,BW] 522-13-536ms   | [S6,MB6,F]  558-7-565ms    | [S6,MB5,BI] 565-10-576ms   | [S6,MB5,BW] 576-10-586ms   | [S1,MB3,BI] 586-14-601ms   | [S1,MB3,BW] 601-11-613ms   | [S6,MB7,F]  638-7-645ms    | [S6,MB6,BI] 645-10-656ms   | [S6,MB6,BW] 656-10-667ms   | [S1,MB4,BI] 667-14-681ms   | [S6,MB7,BI] 713-9-722ms    | [S1,MB5,BI] 737-15-752ms   | [S1,MB4,BW] 752-5-757ms    | [S1,MB6,BI] 767-14-781ms   | [S1,MB5,BW] 781-0-782ms    | [S1,MB7,BI] 793-14-807ms   | [S1,MB6,BW] 807-0-807ms    | [S6,MB7,BW] 807-0-807ms    | [S1,MB7,BW] 807-0-807ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 271-9-280ms    | [S5,MB1,BW] 281-11-292ms   | [S2,MB5,F]  292-7-299ms    | [S2,MB0,BI] 299-10-310ms   | [S2,MB0,BW] 310-9-320ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 337-10-348ms   | [S5,MB2,BW] 348-10-358ms   | [S2,MB6,F]  359-10-369ms   | [S2,MB1,BI] 371-11-382ms   | [S2,MB1,BW] 382-10-392ms   | [S5,MB5,F]  392-7-399ms    | [S5,MB3,BI] 412-10-423ms   | [S5,MB3,BW] 423-9-433ms    | [S2,MB7,F]  437-9-446ms    | [S2,MB2,BI] 449-11-460ms   | [S2,MB2,BW] 460-9-470ms    | [S5,MB6,F]  470-7-477ms    | [S5,MB4,BI] 494-10-505ms   | [S5,MB4,BW] 505-9-515ms    | [S2,MB3,BI] 560-9-570ms    | [S2,MB3,BW] 570-10-581ms   | [S5,MB7,F]  585-7-593ms    | [S5,MB5,BI] 592-9-602ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 641-9-651ms    | [S5,MB6,BI] 656-10-666ms   | [S2,MB5,BI] 666-10-677ms   | [S5,MB7,BI] 739-9-749ms    | [S2,MB6,BI] 749-11-760ms   | [S2,MB4,BW] 760-6-767ms    | [S2,MB7,BI] 776-9-786ms    | [S2,MB5,BW] 786-0-786ms    | [S5,MB6,BW] 786-10-796ms   | [S5,MB7,BW] 796-5-801ms    | [S2,MB6,BW] 801-0-801ms    | [S2,MB7,BW] 801-0-801ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 281-10-291ms   | [S4,MB1,BW] 291-10-301ms   | [S3,MB5,F]  301-8-309ms    | [S3,MB1,BI] 309-9-319ms    | [S3,MB1,BW] 319-9-329ms    | [S4,MB5,F]  329-7-337ms    | [S4,MB2,BI] 364-11-375ms   | [S4,MB2,BW] 375-9-385ms    | [S3,MB6,F]  385-7-392ms    | [S3,MB2,BI] 392-9-402ms    | [S3,MB2,BW] 402-10-412ms   | [S4,MB6,F]  412-8-420ms    | [S4,MB3,BI] 442-11-453ms   | [S4,MB3,BW] 453-9-463ms    | [S3,MB7,F]  463-7-471ms    | [S3,MB3,BI] 471-9-480ms    | [S3,MB3,BW] 480-10-490ms   | [S4,MB7,F]  491-8-499ms    | [S4,MB4,BI] 554-10-564ms   | [S4,MB4,BW] 565-9-574ms    | [S3,MB4,BI] 574-10-584ms   | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 645-9-654ms    | [S4,MB6,BI] 667-9-677ms    | [S3,MB6,BI] 677-9-686ms    | [S4,MB7,BI] 752-9-761ms    | [S3,MB7,BI] 761-9-770ms    | [S3,MB4,BW] 770-0-770ms    | [S4,MB5,BW] 770-10-780ms   | [S4,MB6,BW] 780-9-790ms    | [S4,MB7,BW] 790-4-795ms    | [S3,MB5,BW] 795-0-795ms    | [S3,MB6,BW] 795-0-795ms    | [S3,MB7,BW] 795-0-795ms   
[rank3]:2025-12-26 16:06:51,344 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1606_stage3_step700.svg
[rank3]:2025-12-26 16:06:51,391 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1606_stage4_step700.svg
[rank3]:2025-12-26 16:06:51,497 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank3_stage3.svg
[rank3]:	> Counts Sum: 175680, Total Sum: 357120 (49.19%), Ratio(%) per element: [49.79, 50.4, 50.6, 49.79, 50.4, 50.6, 49.59, 45.96, 45.56, 49.79, 50.0, 50.8, 49.59, 50.2, 50.0, 50.2, 46.97, 45.16]
[rank3]:2025-12-26 16:06:51,602 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1606_rank3_stage4.svg
[rank3]:	> Counts Sum: 29840, Total Sum: 357120 (8.36%), Ratio(%) per element: [9.67, 10.48, 9.67, 9.87, 10.08, 8.26, 9.27, 3.42, 3.42, 9.27, 9.47, 10.28, 9.47, 9.67, 9.67, 10.88, 3.83, 3.62]
[rank0]:2025-12-26 16:06:52,103 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage0.svg
[rank2]:2025-12-26 16:06:52,112 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage2.svg
[rank1]:2025-12-26 16:06:52,119 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage1.svg
[rank3]:2025-12-26 16:06:52,429 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage3.svg
[rank1]:2025-12-26 16:06:52,914 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage6.svg
[rank2]:2025-12-26 16:06:52,902 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage5.svg
[rank0]:2025-12-26 16:06:52,926 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage7.svg
[rank3]:2025-12-26 16:06:53,217 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1606_stage4.svg
[rank0]:2025-12-26 16:09:40,236 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-26 16:09:44,113 - Avg. fwd time: 8.3306 / Avg. bwd-weight time: 7.8489 / Avg. bwd-input time: 10.2576 / Avg. batch time: 831.8993 (ms) / GPU bubble ratio: 49.15%
[rank0]:2025-12-26 16:09:44,119 - Avg. fwd time: 13.2144 / Avg. full-bwd time: 10.3406 (Avg. bwd-weight time: 10.8537 / Avg. bwd-input time: 34.1851) / Avg. batch time: 870.7522 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-12-26 16:09:44,116 - Avg. fwd time: 9.9857 / Avg. bwd-weight time: 9.1546 / Avg. bwd-input time: 12.7122 / Avg. batch time: 852.3076 (ms) / GPU bubble ratio: 40.20%
[rank3]:2025-12-26 16:09:44,110 - Avg. fwd time: 7.8289 / Avg. bwd-weight time: 7.2335 / Avg. bwd-input time: 9.8715 / Avg. batch time: 817.7071 (ms) / GPU bubble ratio: 51.21%
[rank3]:2025-12-26 16:09:44,165 -  step: 750  loss: -4.0000  grad_norm:  0.1633  memory: 16.18GiB(34.07%)  tps: 9,458  tflops: 73.94  mfu: 23.70%
[rank2]:2025-12-26 16:09:44,165 -  step: 750  loss: -4.0000  grad_norm:  0.1633  memory: 14.74GiB(31.02%)  tps: 9,458  tflops: 73.94  mfu: 23.70%
[rank0]:2025-12-26 16:09:44,191 -  step: 750  loss:  0.2341  grad_norm:  0.1633  memory: 40.73GiB(85.74%)  tps: 9,458  tflops: 73.94  mfu: 23.70%
[rank1]:2025-12-26 16:09:44,168 -  step: 750  loss: -4.0000  grad_norm:  0.1633  memory: 18.98GiB(39.95%)  tps: 9,458  tflops: 73.94  mfu: 23.70%
[rank0]:2025-12-26 16:12:33,022 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 16:12:37,115 - Avg. fwd time: 9.9845 / Avg. bwd-weight time: 9.1327 / Avg. bwd-input time: 12.7169 / Avg. batch time: 849.6869 (ms) / GPU bubble ratio: 40.05%
[rank0]:2025-12-26 16:12:37,117 - Avg. fwd time: 13.2054 / Avg. full-bwd time: 10.1075 (Avg. bwd-weight time: 10.6523 / Avg. bwd-input time: 34.1758) / Avg. batch time: 867.9905 (ms) / GPU bubble ratio: 25.03%
[rank2]:2025-12-26 16:12:37,113 - Avg. fwd time: 8.3333 / Avg. bwd-weight time: 7.8409 / Avg. bwd-input time: 10.2604 / Avg. batch time: 829.4296 (ms) / GPU bubble ratio: 49.01%
[rank3]:2025-12-26 16:12:37,109 - Avg. fwd time: 7.8300 / Avg. bwd-weight time: 7.2220 / Avg. bwd-input time: 9.8743 / Avg. batch time: 815.2353 (ms) / GPU bubble ratio: 51.08%
[rank1]:2025-12-26 16:12:37,166 -  step: 800  loss: -4.0000  grad_norm:  0.1270  memory: 18.98GiB(39.95%)  tps: 9,471  tflops: 74.04  mfu: 23.73%
[rank1]:2025-12-26 16:12:37,166 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1270  tps: 9,534  tflops: 74.53  mfu: 21.80%
[rank1]:2025-12-26 16:12:37,166 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-26 16:12:37,167 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 16:12:37,188 -  step: 800  loss:  0.2385  grad_norm:  0.1270  memory: 40.73GiB(85.74%)  tps: 9,471  tflops: 74.04  mfu: 23.73%
[rank0]:2025-12-26 16:12:37,188 - â„¹ï¸ final step: 800  loss:  0.2385  grad_norm:  0.1270  tps: 9,542  tflops: 74.60  mfu: 21.92%
[rank0]:2025-12-26 16:12:37,189 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-26 16:12:37,190 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-26 16:12:37,163 -  step: 800  loss: -4.0000  grad_norm:  0.1270  memory: 14.74GiB(31.02%)  tps: 9,471  tflops: 74.04  mfu: 23.73%
[rank2]:2025-12-26 16:12:37,163 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1270  tps: 9,534  tflops: 74.53  mfu: 21.80%
[rank2]:2025-12-26 16:12:37,163 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-26 16:12:37,164 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-26 16:12:37,163 -  step: 800  loss: -4.0000  grad_norm:  0.1270  memory: 16.18GiB(34.07%)  tps: 9,471  tflops: 74.04  mfu: 23.73%
[rank3]:2025-12-26 16:12:37,163 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1270  tps: 9,534  tflops: 74.53  mfu: 21.80%
[rank3]:2025-12-26 16:12:37,163 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-26 16:12:37,164 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 16:12:39,809 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-26 16:12:39,891 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1612_stage1_final800.svg
[rank0]:2025-12-26 16:12:39,895 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1612_stage0_final800.svg
[rank2]:2025-12-26 16:12:39,891 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1612_stage2_final800.svg
[rank1]:2025-12-26 16:12:39,938 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251226_1612_stage6_final800.svg
[rank0]:2025-12-26 16:12:39,945 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251226_1612_stage7_final800.svg
[rank2]:2025-12-26 16:12:39,938 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251226_1612_stage5_final800.svg
[rank1]:2025-12-26 16:12:40,066 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank1_stage1.svg
[rank1]:	> Counts Sum: 293280, Total Sum: 622080 (47.15%), Ratio(%) per element: [52.25, 51.04, 52.6, 53.12, 52.08, 51.56, 51.9, 27.95, 28.12, 52.6, 53.12, 51.9, 51.73, 53.81, 53.29, 52.95, 29.51, 28.29, 53.12, 51.38, 52.77, 52.95, 50.86, 52.25, 53.64, 29.86, 28.12]
[rank0]:2025-12-26 16:12:40,060 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank0_stage0.svg
[rank0]:	> Counts Sum: 336520, Total Sum: 437760 (76.87%), Ratio(%) per element: [80.38, 82.29, 81.42, 83.33, 81.25, 81.07, 83.15, 83.5, 57.46, 56.77, 80.9, 82.63, 83.5, 81.94, 80.38, 81.77, 81.25, 57.29, 60.24]
[rank2]:2025-12-26 16:12:40,039 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank2_stage2.svg
[rank2]:	> Counts Sum: 169760, Total Sum: 414720 (40.93%), Ratio(%) per element: [41.84, 42.88, 42.88, 41.66, 42.7, 41.49, 42.36, 35.24, 35.06, 41.49, 42.36, 43.57, 43.05, 43.22, 42.53, 43.57, 35.06, 35.76]
[rank1]:2025-12-26 16:12:40,169 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank1_stage6.svg
[rank1]:	> Counts Sum: 59760, Total Sum: 414720 (14.41%), Ratio(%) per element: [14.93, 14.58, 14.4, 14.75, 14.75, 14.58, 14.58, 13.71, 13.71, 14.75, 14.4, 14.75, 14.58, 14.58, 14.75, 14.58, 13.36, 13.54]
[rank0]:2025-12-26 16:12:40,152 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank0_stage7.svg
[rank0]:	> Counts Sum: 194120, Total Sum: 253440 (76.59%), Ratio(%) per element: [82.81, 83.5, 82.81, 83.15, 82.46, 81.42, 84.2, 65.79, 65.27, 64.23, 66.84]
[rank2]:2025-12-26 16:12:40,141 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank2_stage5.svg
[rank2]:	> Counts Sum: 32960, Total Sum: 414720 (7.95%), Ratio(%) per element: [10.06, 8.85, 9.89, 8.33, 9.2, 8.68, 8.85, 2.95, 2.77, 9.2, 8.33, 11.11, 9.54, 9.72, 9.54, 10.06, 2.95, 2.95]
[rank3]:2025-12-26 16:12:40,174 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1612_final800_rank3.svg
[rank3]:			> Batch Time: 825.50 ms, GPU Bubble Ratio: 28.52%, 38.57%, 48.79%, 51.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-25-200ms   | [S7,MB1,F]  200-16-216ms   | [S7,MB1,BI] 228-34-263ms   | [S7,MB1,BW] 263-0-263ms    | [S7,MB2,F]  264-18-282ms   | [S7,MB2,BI] 295-35-330ms   | [S7,MB2,BW] 331-0-331ms    | [S7,MB3,F]  333-19-353ms   | [S7,MB3,BI] 365-35-400ms   | [S7,MB3,BW] 400-0-400ms    | [S0,MB7,F]  400-10-411ms   | [S0,MB0,B]  411-0-411ms    | [S7,MB4,F]  419-18-438ms   | [S7,MB4,BI] 450-34-484ms   | [S7,MB4,BW] 484-0-484ms    | [S0,MB1,B]  492-0-492ms    | [S7,MB5,F]  496-17-514ms   | [S7,MB5,BI] 526-33-560ms   | [S7,MB5,BW] 560-0-560ms    | [S0,MB2,B]  567-0-567ms    | [S7,MB6,F]  581-15-597ms   | [S7,MB6,BI] 609-33-642ms   | [S7,MB6,BW] 643-0-643ms    | [S0,MB3,B]  650-0-650ms    | [S7,MB7,F]  664-15-679ms   | [S7,MB7,BI] 691-33-724ms   | [S7,MB7,BW] 724-25-750ms   | [S0,MB4,B]  751-14-765ms   | [S0,MB5,B]  773-22-795ms   | [S0,MB6,B]  800-19-820ms   | [S0,MB7,B]  825-0-825ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-283ms   | [S6,MB3,F]  283-7-290ms    | [S6,MB2,BI] 331-9-340ms    | [S6,MB2,BW] 340-10-351ms   | [S1,MB6,F]  351-10-362ms   | [S1,MB0,BI] 362-15-378ms   | [S1,MB0,BW] 378-15-393ms   | [S6,MB4,F]  393-8-402ms    | [S6,MB3,BI] 405-11-417ms   | [S6,MB3,BW] 417-11-429ms   | [S1,MB7,F]  429-12-442ms   | [S1,MB1,BI] 442-17-459ms   | [S1,MB1,BW] 459-17-477ms   | [S6,MB5,F]  477-9-486ms    | [S6,MB4,BI] 488-11-500ms   | [S6,MB4,BW] 500-12-512ms   | [S1,MB2,BI] 512-16-529ms   | [S1,MB2,BW] 529-14-543ms   | [S6,MB6,F]  566-7-574ms    | [S6,MB5,BI] 574-10-584ms   | [S6,MB5,BW] 585-10-596ms   | [S1,MB3,BI] 595-14-610ms   | [S1,MB3,BW] 610-12-622ms   | [S6,MB7,F]  649-7-656ms    | [S6,MB6,BI] 656-10-667ms   | [S6,MB6,BW] 667-10-678ms   | [S1,MB4,BI] 678-14-692ms   | [S6,MB7,BI] 726-9-735ms    | [S1,MB5,BI] 748-15-764ms   | [S1,MB4,BW] 763-5-769ms    | [S1,MB6,BI] 779-14-793ms   | [S1,MB5,BW] 793-0-794ms    | [S1,MB7,BI] 804-14-818ms   | [S1,MB6,BW] 818-0-818ms    | [S6,MB7,BW] 818-0-818ms    | [S1,MB7,BW] 818-0-818ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 273-9-282ms    | [S5,MB1,BW] 282-11-293ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  321-7-328ms    | [S5,MB2,BI] 341-10-351ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  363-9-373ms    | [S2,MB1,BI] 375-11-386ms   | [S2,MB1,BW] 386-10-396ms   | [S5,MB5,F]  396-7-404ms    | [S5,MB3,BI] 418-10-429ms   | [S5,MB3,BW] 429-10-439ms   | [S2,MB7,F]  442-9-452ms    | [S2,MB2,BI] 454-10-465ms   | [S2,MB2,BW] 465-9-475ms    | [S5,MB6,F]  475-7-483ms    | [S5,MB4,BI] 500-10-511ms   | [S5,MB4,BW] 511-9-521ms    | [S2,MB3,BI] 569-9-579ms    | [S2,MB3,BW] 579-10-590ms   | [S5,MB7,F]  594-7-601ms    | [S5,MB5,BI] 602-9-611ms    | [S5,MB5,BW] 611-9-621ms    | [S2,MB4,BI] 652-9-662ms    | [S5,MB6,BI] 667-10-678ms   | [S2,MB5,BI] 678-10-688ms   | [S5,MB7,BI] 751-9-760ms    | [S2,MB6,BI] 761-11-772ms   | [S2,MB4,BW] 772-7-779ms    | [S2,MB7,BI] 788-9-797ms    | [S2,MB5,BW] 797-0-797ms    | [S5,MB6,BW] 797-10-807ms   | [S5,MB7,BW] 808-4-812ms    | [S2,MB6,BW] 812-0-812ms    | [S2,MB7,BW] 812-0-812ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 282-10-292ms   | [S4,MB1,BW] 292-10-303ms   | [S3,MB5,F]  302-8-311ms    | [S3,MB1,BI] 311-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 368-11-379ms   | [S4,MB2,BW] 379-9-389ms    | [S3,MB6,F]  389-7-396ms    | [S3,MB2,BI] 396-9-406ms    | [S3,MB2,BW] 406-10-416ms   | [S4,MB6,F]  416-8-424ms    | [S4,MB3,BI] 447-11-459ms   | [S4,MB3,BW] 459-9-469ms    | [S3,MB7,F]  469-7-476ms    | [S3,MB3,BI] 476-9-486ms    | [S3,MB3,BW] 486-10-496ms   | [S4,MB7,F]  496-8-505ms    | [S4,MB4,BI] 563-10-573ms   | [S4,MB4,BW] 573-9-583ms    | [S3,MB4,BI] 583-10-593ms   | [S4,MB5,BI] 645-10-655ms   | [S3,MB5,BI] 655-9-664ms    | [S4,MB6,BI] 678-9-687ms    | [S3,MB6,BI] 687-9-697ms    | [S4,MB7,BI] 763-9-772ms    | [S3,MB7,BI] 772-9-781ms    | [S3,MB4,BW] 781-0-781ms    | [S4,MB5,BW] 781-10-791ms   | [S4,MB6,BW] 791-9-801ms    | [S4,MB7,BW] 800-4-805ms    | [S3,MB5,BW] 805-0-805ms    | [S3,MB6,BW] 805-0-805ms    | [S3,MB7,BW] 805-0-805ms   
[rank3]:2025-12-26 16:12:40,522 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251226_1612_thry_final800_rank3.svg
[rank3]:			> Batch Time: 471.21 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB4,F]  39-9-49ms      | [S0,MB5,F]  49-9-58ms      | [S0,MB6,F]  58-9-68ms      | [S7,MB0,F]  68-9-78ms      | [S7,MB0,BI] 78-9-88ms      | [S7,MB0,BW] 88-9-98ms      | [S7,MB1,F]  98-9-107ms     | [S7,MB1,BI] 107-9-117ms    | [S7,MB1,BW] 117-9-127ms    | [S7,MB2,F]  127-9-137ms    | [S7,MB2,BI] 137-9-147ms    | [S7,MB2,BW] 147-9-157ms    | [S7,MB3,F]  157-9-166ms    | [S7,MB3,BI] 166-9-176ms    | [S7,MB3,BW] 176-9-186ms    | [S0,MB7,F]  186-9-196ms    | [S0,MB0,B]  196-19-215ms   | [S7,MB4,F]  215-9-225ms    | [S7,MB4,BI] 225-9-235ms    | [S7,MB4,BW] 235-9-245ms    | [S0,MB1,B]  245-19-265ms   | [S7,MB5,F]  265-9-274ms    | [S7,MB5,BI] 274-9-284ms    | [S7,MB5,BW] 284-9-294ms    | [S0,MB2,B]  294-19-314ms   | [S7,MB6,F]  314-9-323ms    | [S7,MB6,BI] 323-9-333ms    | [S7,MB6,BW] 333-9-343ms    | [S0,MB3,B]  343-19-363ms   | [S7,MB7,F]  363-9-373ms    | [S7,MB7,BI] 373-9-382ms    | [S7,MB7,BW] 382-9-392ms    | [S0,MB4,B]  392-19-412ms   | [S0,MB5,B]  412-19-431ms   | [S0,MB6,B]  431-19-451ms   | [S0,MB7,B]  451-19-471ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB3,F]  39-9-49ms      | [S1,MB4,F]  49-9-58ms      | [S6,MB0,F]  58-9-68ms      | [S1,MB5,F]  68-9-78ms      | [S6,MB1,F]  78-9-88ms      | [S6,MB0,BI] 88-9-98ms      | [S6,MB0,BW] 98-9-107ms     | [S6,MB2,F]  107-9-117ms    | [S6,MB1,BI] 117-9-127ms    | [S6,MB1,BW] 127-9-137ms    | [S6,MB3,F]  137-9-147ms    | [S6,MB2,BI] 147-9-157ms    | [S6,MB2,BW] 157-9-166ms    | [S1,MB6,F]  166-9-176ms    | [S1,MB0,BI] 176-9-186ms    | [S1,MB0,BW] 186-9-196ms    | [S6,MB4,F]  196-9-206ms    | [S6,MB3,BI] 206-9-215ms    | [S6,MB3,BW] 215-9-225ms    | [S1,MB7,F]  225-9-235ms    | [S1,MB1,BI] 235-9-245ms    | [S1,MB1,BW] 245-9-255ms    | [S6,MB5,F]  255-9-265ms    | [S6,MB4,BI] 265-9-274ms    | [S6,MB4,BW] 274-9-284ms    | [S1,MB2,BI] 284-9-294ms    | [S1,MB2,BW] 294-9-304ms    | [S6,MB6,F]  304-9-314ms    | [S6,MB5,BI] 314-9-323ms    | [S6,MB5,BW] 323-9-333ms    | [S1,MB3,BI] 333-9-343ms    | [S1,MB3,BW] 343-9-353ms    | [S6,MB7,F]  353-9-363ms    | [S6,MB6,BI] 363-9-373ms    | [S6,MB6,BW] 373-9-382ms    | [S1,MB4,BI] 382-9-392ms    | [S6,MB7,BI] 392-9-402ms    | [S1,MB5,BI] 402-9-412ms    | [S1,MB4,BW] 412-9-422ms    | [S1,MB6,BI] 422-9-431ms    | [S1,MB5,BW] 431-9-441ms    | [S1,MB7,BI] 441-9-451ms    | [S1,MB6,BW] 451-9-461ms    | [S6,MB7,BW] 461-9-471ms    | [S1,MB7,BW] 471-9-481ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB2,F]  39-9-49ms      | [S5,MB0,F]  49-9-58ms      | [S2,MB3,F]  58-9-68ms      | [S5,MB1,F]  68-9-78ms      | [S2,MB4,F]  78-9-88ms      | [S5,MB2,F]  88-9-98ms      | [S5,MB0,BI] 98-9-107ms     | [S5,MB0,BW] 107-9-117ms    | [S5,MB3,F]  117-9-127ms    | [S5,MB1,BI] 127-9-137ms    | [S5,MB1,BW] 137-9-147ms    | [S2,MB5,F]  147-9-157ms    | [S2,MB0,BI] 157-9-166ms    | [S2,MB0,BW] 166-9-176ms    | [S5,MB4,F]  176-9-186ms    | [S5,MB2,BI] 186-9-196ms    | [S5,MB2,BW] 196-9-206ms    | [S2,MB6,F]  206-9-215ms    | [S2,MB1,BI] 215-9-225ms    | [S2,MB1,BW] 225-9-235ms    | [S5,MB5,F]  235-9-245ms    | [S5,MB3,BI] 245-9-255ms    | [S5,MB3,BW] 255-9-265ms    | [S2,MB7,F]  265-9-274ms    | [S2,MB2,BI] 274-9-284ms    | [S2,MB2,BW] 284-9-294ms    | [S5,MB6,F]  294-9-304ms    | [S5,MB4,BI] 304-9-314ms    | [S5,MB4,BW] 314-9-323ms    | [S2,MB3,BI] 323-9-333ms    | [S2,MB3,BW] 333-9-343ms    | [S5,MB7,F]  343-9-353ms    | [S5,MB5,BI] 353-9-363ms    | [S5,MB5,BW] 363-9-373ms    | [S2,MB4,BI] 373-9-382ms    | [S5,MB6,BI] 382-9-392ms    | [S2,MB5,BI] 392-9-402ms    | [S5,MB7,BI] 402-9-412ms    | [S2,MB6,BI] 412-9-422ms    | [S2,MB4,BW] 422-9-431ms    | [S2,MB7,BI] 431-9-441ms    | [S2,MB5,BW] 441-9-451ms    | [S5,MB6,BW] 451-9-461ms    | [S5,MB7,BW] 461-9-471ms    | [S2,MB6,BW] 471-9-481ms    | [S2,MB7,BW] 481-9-490ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S4,MB0,F]  39-9-49ms      | [S3,MB1,F]  49-9-58ms      | [S4,MB1,F]  58-9-68ms      | [S3,MB2,F]  68-9-78ms      | [S4,MB2,F]  78-9-88ms      | [S3,MB3,F]  88-9-98ms      | [S4,MB3,F]  98-9-107ms     | [S4,MB0,BI] 107-9-117ms    | [S4,MB0,BW] 117-9-127ms    | [S3,MB4,F]  127-9-137ms    | [S3,MB0,BI] 137-9-147ms    | [S3,MB0,BW] 147-9-157ms    | [S4,MB4,F]  157-9-166ms    | [S4,MB1,BI] 166-9-176ms    | [S4,MB1,BW] 176-9-186ms    | [S3,MB5,F]  186-9-196ms    | [S3,MB1,BI] 196-9-206ms    | [S3,MB1,BW] 206-9-215ms    | [S4,MB5,F]  215-9-225ms    | [S4,MB2,BI] 225-9-235ms    | [S4,MB2,BW] 235-9-245ms    | [S3,MB6,F]  245-9-255ms    | [S3,MB2,BI] 255-9-265ms    | [S3,MB2,BW] 265-9-274ms    | [S4,MB6,F]  274-9-284ms    | [S4,MB3,BI] 284-9-294ms    | [S4,MB3,BW] 294-9-304ms    | [S3,MB7,F]  304-9-314ms    | [S3,MB3,BI] 314-9-323ms    | [S3,MB3,BW] 323-9-333ms    | [S4,MB7,F]  333-9-343ms    | [S4,MB4,BI] 343-9-353ms    | [S4,MB4,BW] 353-9-363ms    | [S3,MB4,BI] 363-9-373ms    | [S4,MB5,BI] 373-9-382ms    | [S3,MB5,BI] 382-9-392ms    | [S4,MB6,BI] 392-9-402ms    | [S3,MB6,BI] 402-9-412ms    | [S4,MB7,BI] 412-9-422ms    | [S3,MB7,BI] 422-9-431ms    | [S3,MB4,BW] 431-9-441ms    | [S4,MB5,BW] 441-9-451ms    | [S4,MB6,BW] 451-9-461ms    | [S4,MB7,BW] 461-9-471ms    | [S3,MB5,BW] 471-9-481ms    | [S3,MB6,BW] 481-9-490ms    | [S3,MB7,BW] 490-9-500ms   
[rank3]:2025-12-26 16:12:40,570 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1612_stage3_final800.svg
[rank3]:2025-12-26 16:12:40,618 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251226_1612_stage4_final800.svg
[rank3]:2025-12-26 16:12:40,719 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank3_stage3.svg
[rank3]:	> Counts Sum: 204480, Total Sum: 414720 (49.31%), Ratio(%) per element: [49.82, 50.34, 50.52, 49.82, 50.34, 50.52, 49.65, 46.52, 46.18, 49.82, 50.0, 50.69, 49.65, 50.17, 50.0, 50.17, 47.39, 45.83]
[rank3]:2025-12-26 16:12:40,819 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251226_1612_rank3_stage4.svg
[rank3]:	> Counts Sum: 33040, Total Sum: 414720 (7.97%), Ratio(%) per element: [9.37, 10.06, 9.37, 9.72, 9.37, 8.33, 9.2, 2.95, 2.95, 9.2, 8.85, 10.06, 9.72, 8.85, 8.68, 10.24, 3.29, 3.12]
[rank2]:2025-12-26 16:12:41,091 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage2.svg
[rank1]:2025-12-26 16:12:41,128 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage1.svg
[rank0]:2025-12-26 16:12:41,185 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage0.svg
[rank3]:2025-12-26 16:12:41,777 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage3.svg
[rank2]:2025-12-26 16:12:41,999 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage5.svg
[rank2]:2025-12-26 16:12:42,003 - Destroying the purge thread.
[rank1]:2025-12-26 16:12:42,056 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage6.svg
[rank1]:2025-12-26 16:12:42,060 - Destroying the purge thread.
[rank0]:2025-12-26 16:12:42,197 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage7.svg
[rank0]:2025-12-26 16:12:42,201 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-26 16:12:42,489 - Process group destroyed
[rank2]:2025-12-26 16:12:42,485 - Process group destroyed
[rank3]:2025-12-26 16:12:42,710 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251226_1612_stage4.svg
[rank3]:2025-12-26 16:12:42,713 - Destroying the purge thread.
[rank3]:2025-12-26 16:12:42,860 - Process group destroyed
[rank0]:2025-12-26 16:12:44,201 - Training completed
[rank0]:2025-12-26 16:12:44,202 - Destroying the purge thread.
[rank0]:wandb: updating run metadata
[rank0]:wandb: uploading config.yaml
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.43396
[rank0]:wandb:               final/avg_loss 0.23852
[rank0]:wandb:             final/avg_mfu(%) 21.92234
[rank0]:wandb:             final/avg_tflops 74.59757
[rank0]:wandb:    final/avg_throughput(tps) 9542.3329
[rank0]:wandb:              final/grad_norm 0.12695
[rank0]:wandb:               final/max_loss 0.23852
[rank0]:wandb:                    grad_norm 0.12695
[rank0]:wandb: loss_metrics/global_avg_loss 0.23852
[rank0]:wandb: loss_metrics/global_max_loss 0.23852
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_timelyapf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/kvhz28ed
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyapf_42_dm1/20251226-1523/wandb/run-20251226_152357-kvhz28ed/logs
[rank0]:2025-12-26 16:12:46,004 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.1'}
[rank0]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
