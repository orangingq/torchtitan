
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 10. (ì›”) 23:27:39 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_Interleaved1F1B_fullrand7_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with fullrand7 x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-10 23:27:45,884 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank1]:2025-11-10 23:27:45,885 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank3]:2025-11-10 23:27:45,880 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank2]:2025-11-10 23:27:45,873 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank2]:2025-11-10 23:27:46,203 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-10 23:27:46,205 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 23:27:46,244 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-10 23:27:46,247 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 23:27:46,250 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-10 23:27:46,252 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-10 23:27:46,240 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-10 23:27:46,242 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-10 23:27:46,227 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-10 23:27:46,229 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 23:27:46,653 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-10 23:27:49,567 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-10 23:27:49,708 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-10 23:27:49,728 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-10 23:27:49,765 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-10 23:27:49,766 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-10 23:27:49,793 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-10 23:27:49,806 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-10 23:27:49,807 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-10 23:27:49,747 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-10 23:27:49,775 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-10 23:27:49,789 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-10 23:27:49,790 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-10 23:27:49,995 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-10 23:27:49,995 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-10 23:27:49,996 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-10 23:27:50,001 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-10 23:27:49,978 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-10 23:27:49,978 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-10 23:27:49,979 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-10 23:27:50,027 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-10 23:27:50,051 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-10 23:27:50,063 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-10 23:27:50,064 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-10 23:27:50,240 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-10 23:27:50,240 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-10 23:27:50,241 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:2025-11-10 23:27:50,353 - ERROR - Failed to create WandB logger: [Errno 28] No space left on device: '/data2/shcho/torchtitan/tb/1109_Interleaved1F1B_fullrand7_42_dm1/20251110-2327'
[rank3]:2025-11-10 23:27:50,353 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-10 23:27:50,394 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-10 23:27:50,421 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-10 23:27:50,434 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-10 23:27:50,436 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-10 23:27:50,645 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_Interleaved1F1B_fullrand7_42_dm1
[rank0]:2025-11-10 23:27:50,645 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 23:27:50,646 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-10 23:27:50,646 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-10 23:27:50,645 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-10 23:27:50,629 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-10 23:27:50,645 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-10 23:27:50,629 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-10 23:27:50,630 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-10 23:27:50,645 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 23:27:53,226 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-10 23:27:53,226 - INFO - Finished loading the checkpoint in 2.58 seconds.
[rank0]:2025-11-10 23:27:53,226 - INFO - Training starts at step 1
[rank0]:2025-11-10 23:27:58,902 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 16.58GiB(34.89%)  tps: 3,587  tflops: 28.04  mfu: 8.99%
[rank0]:2025-11-10 23:27:58,902 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-10 23:27:58,862 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 10.24GiB(21.56%)  tps: 3,709  tflops: 29.00  mfu: 9.29%
[rank2]:2025-11-10 23:27:58,862 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-10 23:27:58,872 - INFO -  step:  1  loss: 10.6092  grad_norm: 203.0660  memory: 25.52GiB(53.71%)  tps: 3,865  tflops: 30.22  mfu: 9.69%
[rank3]:2025-11-10 23:27:58,872 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-10 23:27:58,880 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 16.17GiB(34.04%)  tps: 3,588  tflops: 28.05  mfu: 8.99%
[rank1]:2025-11-10 23:27:58,880 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-10 23:32:03,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 23:32:07,737 - INFO - Avg. fwd time: 14.1899 / Avg. bwd time: 40.0090 / Avg. batch time: 1084.1121 (ms) / GPU bubble ratio: 20.01%
[rank2]:2025-11-10 23:32:07,845 - INFO - Avg. fwd time: 7.7587 / Avg. bwd time: 18.4197 / Avg. batch time: 1145.5698 (ms) / GPU bubble ratio: 63.44%
[rank1]:2025-11-10 23:32:08,036 - INFO - Avg. fwd time: 9.8830 / Avg. bwd time: 23.7920 / Avg. batch time: 1204.0696 (ms) / GPU bubble ratio: 55.25%
[rank0]:2025-11-10 23:32:07,968 - INFO - Avg. fwd time: 8.2309 / Avg. bwd time: 20.6869 / Avg. batch time: 1242.5126 (ms) / GPU bubble ratio: 62.76%
[rank2]:2025-11-10 23:32:08,318 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.6580  memory: 12.06GiB(25.39%)  tps: 6,437  tflops: 50.32  mfu: 16.13%
[rank1]:2025-11-10 23:32:08,322 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.6580  memory: 18.44GiB(38.81%)  tps: 6,437  tflops: 50.32  mfu: 16.13%
[rank0]:2025-11-10 23:32:08,333 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.6580  memory: 20.42GiB(42.99%)  tps: 6,437  tflops: 50.32  mfu: 16.13%
[rank3]:2025-11-10 23:32:08,329 - INFO -  step: 50  loss:  9.8777  grad_norm: 23.6580  memory: 29.23GiB(61.52%)  tps: 6,437  tflops: 50.32  mfu: 16.13%
[rank3]:2025-11-10 23:32:59,281 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-10 23:33:50,202 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-10 23:33:50,746 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-10 23:33:50,778 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:50,787 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:50,795 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:50,804 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:50,816 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:50,837 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:50,785 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:50,802 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:50,817 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:50,839 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:50,797 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:50,814 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:50,834 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:50,798 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:50,814 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:50,832 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:50,853 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:50,856 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:50,871 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:50,902 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:50,963 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:50,929 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:50,958 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:50,995 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:50,958 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,102 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,061 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,121 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,092 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,146 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,135 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,169 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,236 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,191 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,241 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,230 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,270 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,254 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,264 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,282 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,295 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:33:51,303 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,249 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,271 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,286 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,293 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,317 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,340 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,283 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,297 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,312 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,321 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,334 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,362 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,283 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,299 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,309 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,322 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,345 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 23:33:51,353 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,394 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 23:33:51,427 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,380 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 23:33:51,422 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 23:35:07,014 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-10 23:35:07,392 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251110_2335_max_batch_time.svg
[rank3]:> Batch Time: 1005.44 ms, GPU Bubble Ratio: 53.62%, 45.89%, 58.01%, 12.16%
[rank3]:2025-11-10 23:35:07,652 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251110_2335_min_batch_time.svg
[rank3]:> Batch Time: 679.10 ms, GPU Bubble Ratio: 69.21%, 47.97%, 58.41%, 10.27%
[rank3]:2025-11-10 23:35:07,935 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251110_2335_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 714.87 ms, GPU Bubble Ratio: 42.37%, 33.03%, 45.99%, 9.01%
[rank3]:2025-11-10 23:35:07,935 - INFO - 	> Batch Time: 714.87 ms (Average Freeze Ratio: 0.38, Time Reduction Rate: 0.29)
[rank0]:2025-11-10 23:35:43,761 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 23:35:47,211 - INFO - Avg. fwd time: 8.4189 / Avg. bwd time: 16.5743 / Avg. batch time: 1163.5287 (ms) / GPU bubble ratio: 65.63%
[rank3]:2025-11-10 23:35:47,251 - INFO - Avg. fwd time: 14.2538 / Avg. bwd time: 35.5440 / Avg. batch time: 1019.0157 (ms) / GPU bubble ratio: 21.81%
[rank3]:2025-11-10 23:35:47,259 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB0] 0.33/1.00, [MB1] 0.29/0.87, [MB2] 0.33/1.00, [MB3] 0.00/0.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.18/0.53
[rank2]:2025-11-10 23:35:47,307 - INFO - Avg. fwd time: 7.9420 / Avg. bwd time: 16.3020 / Avg. batch time: 1079.0600 (ms) / GPU bubble ratio: 64.05%
[rank1]:2025-11-10 23:35:47,380 - INFO - Avg. fwd time: 10.1128 / Avg. bwd time: 20.7554 / Avg. batch time: 1131.5007 (ms) / GPU bubble ratio: 56.35%
[rank2]:2025-11-10 23:35:47,665 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.25/0.75, [MB4] 0.33/1.00, [MB5] 0.28/0.83, [MB6] 0.19/0.58, [MB7] 0.33/1.00
[rank0]:2025-11-10 23:35:47,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.10/0.30, [MB4] 0.08/0.23, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-10 23:35:47,682 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-11-10 23:35:47,694 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.3765  memory: 20.42GiB(42.99%)  tps: 7,469  tflops: 58.39  mfu: 18.71%
[rank1]:2025-11-10 23:35:47,687 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.3765  memory: 18.44GiB(38.81%)  tps: 7,469  tflops: 58.39  mfu: 18.71%
[rank3]:2025-11-10 23:35:47,686 - INFO -  step: 100  loss:  9.1717  grad_norm:  0.3765  memory: 29.23GiB(61.52%)  tps: 7,469  tflops: 58.39  mfu: 18.71%
[rank2]:2025-11-10 23:35:47,687 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.3765  memory: 12.06GiB(25.39%)  tps: 7,469  tflops: 58.39  mfu: 18.71%
[rank2]:2025-11-10 23:35:47,756 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2335_stage2_step100.svg
[rank0]:2025-11-10 23:35:47,772 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2335_stage0_step100.svg
[rank0]:2025-11-10 23:35:47,813 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2335_stage4_step100.svg
[rank1]:2025-11-10 23:35:47,756 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2335_stage1_step100.svg
[rank1]:2025-11-10 23:35:47,798 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2335_stage5_step100.svg
[rank2]:2025-11-10 23:35:47,798 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2335_stage6_step100.svg
[rank3]:2025-11-10 23:35:47,969 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251110_2335_real_step100_rank3.svg
[rank3]:> Batch Time: 965.00 ms, GPU Bubble Ratio: 71.23%, 59.11%, 64.71%, 35.52%
[rank3]:2025-11-10 23:35:48,013 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2335_stage3_step100.svg
[rank3]:2025-11-10 23:35:48,052 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2335_stage7_step100.svg
[rank0]:2025-11-10 23:39:35,500 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-10 23:39:39,835 - INFO - Avg. fwd time: 14.3135 / Avg. bwd time: 34.7665 / Avg. batch time: 1009.7776 (ms) / GPU bubble ratio: 22.23%
[rank3]:2025-11-10 23:39:39,840 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.58/0.87, [MB2] 0.67/1.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.35/0.53
[rank2]:2025-11-10 23:39:39,888 - INFO - Avg. fwd time: 7.9617 / Avg. bwd time: 16.2245 / Avg. batch time: 1071.0228 (ms) / GPU bubble ratio: 63.87%
[rank2]:2025-11-10 23:39:39,895 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.50/0.75, [MB4] 0.67/1.00, [MB5] 0.55/0.83, [MB6] 0.39/0.58, [MB7] 0.67/1.00
[rank0]:2025-11-10 23:39:39,944 - INFO - Avg. fwd time: 8.4220 / Avg. bwd time: 16.2802 / Avg. batch time: 1151.5503 (ms) / GPU bubble ratio: 65.68%
[rank0]:2025-11-10 23:39:39,949 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.20/0.30, [MB4] 0.16/0.23, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-11-10 23:39:39,957 - INFO -  step: 150  loss: -4.0000  grad_norm:  4.0844  memory: 20.42GiB(42.99%)  tps: 7,054  tflops: 55.15  mfu: 17.67%
[rank1]:2025-11-10 23:39:39,921 - INFO - Avg. fwd time: 10.1177 / Avg. bwd time: 20.2379 / Avg. batch time: 1120.6353 (ms) / GPU bubble ratio: 56.66%
[rank1]:2025-11-10 23:39:39,929 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-10 23:39:39,960 - INFO -  step: 150  loss: -4.0000  grad_norm:  4.0844  memory: 18.44GiB(38.81%)  tps: 7,054  tflops: 55.14  mfu: 17.67%
[rank3]:2025-11-10 23:39:39,970 - INFO -  step: 150  loss:  5.0967  grad_norm:  4.0844  memory: 30.07GiB(63.29%)  tps: 7,053  tflops: 55.14  mfu: 17.67%
[rank2]:2025-11-10 23:39:39,958 - INFO -  step: 150  loss: -4.0000  grad_norm:  4.0844  memory: 12.14GiB(25.55%)  tps: 7,054  tflops: 55.14  mfu: 17.67%
[rank0]:2025-11-10 23:43:08,741 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 23:43:12,338 - INFO - Avg. fwd time: 8.4577 / Avg. bwd time: 15.5189 / Avg. batch time: 1127.6875 (ms) / GPU bubble ratio: 65.98%
[rank3]:2025-11-10 23:43:12,376 - INFO - Avg. fwd time: 14.3454 / Avg. bwd time: 33.3962 / Avg. batch time: 991.3052 (ms) / GPU bubble ratio: 22.94%
[rank3]:2025-11-10 23:43:12,384 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.87/0.87, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.53/0.53
[rank2]:2025-11-10 23:43:12,430 - INFO - Avg. fwd time: 8.0043 / Avg. bwd time: 15.8330 / Avg. batch time: 1051.8630 (ms) / GPU bubble ratio: 63.74%
[rank1]:2025-11-10 23:43:12,514 - INFO - Avg. fwd time: 10.1718 / Avg. bwd time: 19.3334 / Avg. batch time: 1098.4128 (ms) / GPU bubble ratio: 57.02%
[rank0]:2025-11-10 23:43:12,823 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.30/0.30, [MB4] 0.23/0.23, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-10 23:43:12,829 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3744  memory: 20.42GiB(42.99%)  tps: 7,697  tflops: 60.17  mfu: 19.28%
[rank1]:2025-11-10 23:43:12,820 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 23:43:12,830 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3744  memory: 18.44GiB(38.81%)  tps: 7,697  tflops: 60.17  mfu: 19.29%
[rank3]:2025-11-10 23:43:12,827 - INFO -  step: 200  loss:  2.7116  grad_norm:  0.3744  memory: 30.07GiB(63.29%)  tps: 7,697  tflops: 60.17  mfu: 19.29%
[rank2]:2025-11-10 23:43:12,801 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.75/0.75, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank2]:2025-11-10 23:43:12,829 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3744  memory: 12.14GiB(25.55%)  tps: 7,697  tflops: 60.17  mfu: 19.28%
[rank0]:2025-11-10 23:43:12,887 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2343_stage0_step200.svg
[rank0]:2025-11-10 23:43:12,933 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2343_stage4_step200.svg
[rank1]:2025-11-10 23:43:12,885 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2343_stage1_step200.svg
[rank1]:2025-11-10 23:43:12,932 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2343_stage5_step200.svg
[rank2]:2025-11-10 23:43:12,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2343_stage2_step200.svg
[rank2]:2025-11-10 23:43:12,930 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2343_stage6_step200.svg
[rank3]:2025-11-10 23:43:13,096 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251110_2343_real_step200_rank3.svg
[rank3]:> Batch Time: 1032.10 ms, GPU Bubble Ratio: 69.02%, 60.22%, 65.50%, 34.38%
[rank3]:2025-11-10 23:43:13,142 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2343_stage3_step200.svg
[rank3]:2025-11-10 23:43:13,186 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2343_stage7_step200.svg
[rank0]:2025-11-10 23:46:31,127 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-10 23:46:34,617 - INFO - Avg. fwd time: 8.4971 / Avg. bwd time: 14.0517 / Avg. batch time: 1098.5891 (ms) / GPU bubble ratio: 67.16%
[rank3]:2025-11-10 23:46:34,661 - INFO - Avg. fwd time: 14.3118 / Avg. bwd time: 31.7541 / Avg. batch time: 968.5898 (ms) / GPU bubble ratio: 23.90%
[rank3]:2025-11-10 23:46:34,669 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.87/0.87, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.53/0.53
[rank2]:2025-11-10 23:46:34,722 - INFO - Avg. fwd time: 8.0500 / Avg. bwd time: 15.3477 / Avg. batch time: 1028.5048 (ms) / GPU bubble ratio: 63.60%
[rank1]:2025-11-10 23:46:34,794 - INFO - Avg. fwd time: 10.2335 / Avg. bwd time: 18.2864 / Avg. batch time: 1072.1883 (ms) / GPU bubble ratio: 57.44%
[rank3]:2025-11-10 23:46:35,103 - INFO -  step: 250  loss:  2.0306  grad_norm:  0.2807  memory: 30.07GiB(63.29%)  tps: 8,100  tflops: 63.32  mfu: 20.30%
[rank2]:2025-11-10 23:46:35,080 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.75/0.75, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank2]:2025-11-10 23:46:35,103 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2807  memory: 12.14GiB(25.55%)  tps: 8,100  tflops: 63.32  mfu: 20.30%
[rank0]:2025-11-10 23:46:35,098 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.30/0.30, [MB4] 0.23/0.23, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-10 23:46:35,103 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2807  memory: 20.42GiB(42.99%)  tps: 8,100  tflops: 63.32  mfu: 20.30%
[rank1]:2025-11-10 23:46:35,097 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 23:46:35,103 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2807  memory: 18.44GiB(38.81%)  tps: 8,100  tflops: 63.32  mfu: 20.30%
[rank0]:2025-11-10 23:49:55,320 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 23:49:59,337 - INFO - Avg. fwd time: 14.3135 / Avg. bwd time: 30.7940 / Avg. batch time: 955.7161 (ms) / GPU bubble ratio: 24.48%
[rank3]:2025-11-10 23:49:59,343 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.87/0.87, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.53/0.53
[rank1]:2025-11-10 23:49:59,411 - INFO - Avg. fwd time: 10.2693 / Avg. bwd time: 17.5872 / Avg. batch time: 1056.7709 (ms) / GPU bubble ratio: 57.82%
[rank1]:2025-11-10 23:49:59,418 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-10 23:49:59,384 - INFO - Avg. fwd time: 8.0783 / Avg. bwd time: 15.0284 / Avg. batch time: 1014.9793 (ms) / GPU bubble ratio: 63.57%
[rank2]:2025-11-10 23:49:59,390 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.75/0.75, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank2]:2025-11-10 23:49:59,434 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.8242  memory: 12.14GiB(25.55%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank0]:2025-11-10 23:49:59,424 - INFO - Avg. fwd time: 8.5174 / Avg. bwd time: 13.1060 / Avg. batch time: 1081.2443 (ms) / GPU bubble ratio: 68.00%
[rank0]:2025-11-10 23:49:59,428 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.30/0.30, [MB4] 0.23/0.23, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-10 23:49:59,434 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.8242  memory: 20.42GiB(42.99%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank0]:2025-11-10 23:49:59,515 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2349_stage0_step300.svg
[rank1]:2025-11-10 23:49:59,434 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.8242  memory: 18.44GiB(38.81%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank1]:2025-11-10 23:49:59,527 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2349_stage1_step300.svg
[rank2]:2025-11-10 23:49:59,521 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2349_stage2_step300.svg
[rank3]:2025-11-10 23:49:59,447 - INFO -  step: 300  loss:  0.9440  grad_norm:  1.8242  memory: 30.07GiB(63.29%)  tps: 8,018  tflops: 62.68  mfu: 20.09%
[rank0]:2025-11-10 23:49:59,559 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2349_stage4_step300.svg
[rank1]:2025-11-10 23:49:59,570 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2349_stage5_step300.svg
[rank2]:2025-11-10 23:49:59,564 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2349_stage6_step300.svg
[rank3]:2025-11-10 23:49:59,701 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251110_2349_real_step300_rank3.svg
[rank3]:> Batch Time: 1004.50 ms, GPU Bubble Ratio: 73.17%, 60.56%, 65.57%, 34.80%
[rank3]:2025-11-10 23:49:59,745 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2349_stage3_step300.svg
[rank3]:2025-11-10 23:49:59,787 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2349_stage7_step300.svg
[rank0]:2025-11-10 23:53:17,959 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-10 23:53:21,492 - INFO - Avg. fwd time: 8.5307 / Avg. bwd time: 12.5333 / Avg. batch time: 1069.6781 (ms) / GPU bubble ratio: 68.49%
[rank3]:2025-11-10 23:53:21,536 - INFO - Avg. fwd time: 14.3273 / Avg. bwd time: 30.1153 / Avg. batch time: 946.7188 (ms) / GPU bubble ratio: 24.89%
[rank2]:2025-11-10 23:53:21,590 - INFO - Avg. fwd time: 8.0991 / Avg. bwd time: 14.8464 / Avg. batch time: 1005.7496 (ms) / GPU bubble ratio: 63.50%
[rank1]:2025-11-10 23:53:21,671 - INFO - Avg. fwd time: 10.2964 / Avg. bwd time: 17.1653 / Avg. batch time: 1046.3865 (ms) / GPU bubble ratio: 58.01%
[rank2]:2025-11-10 23:53:21,979 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0776  memory: 12.14GiB(25.55%)  tps: 8,089  tflops: 63.24  mfu: 20.27%
[rank0]:2025-11-10 23:53:21,979 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0776  memory: 20.42GiB(42.99%)  tps: 8,089  tflops: 63.24  mfu: 20.27%
[rank1]:2025-11-10 23:53:21,979 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0776  memory: 18.44GiB(38.81%)  tps: 8,089  tflops: 63.24  mfu: 20.27%
[rank3]:2025-11-10 23:53:21,976 - INFO -  step: 350  loss:  0.7349  grad_norm:  0.0776  memory: 30.07GiB(63.29%)  tps: 8,090  tflops: 63.24  mfu: 20.27%
[rank0]:2025-11-10 23:56:42,895 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 23:56:46,582 - INFO - Avg. fwd time: 14.3314 / Avg. bwd time: 29.6071 / Avg. batch time: 940.0411 (ms) / GPU bubble ratio: 25.21%
[rank0]:2025-11-10 23:56:46,532 - INFO - Avg. fwd time: 8.5434 / Avg. bwd time: 11.9985 / Avg. batch time: 1060.5725 (ms) / GPU bubble ratio: 69.01%
[rank1]:2025-11-10 23:56:46,718 - INFO - Avg. fwd time: 10.3158 / Avg. bwd time: 16.7883 / Avg. batch time: 1038.3224 (ms) / GPU bubble ratio: 58.23%
[rank2]:2025-11-10 23:56:46,636 - INFO - Avg. fwd time: 8.1163 / Avg. bwd time: 14.6579 / Avg. batch time: 998.7111 (ms) / GPU bubble ratio: 63.51%
[rank0]:2025-11-10 23:56:47,026 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4999  memory: 20.42GiB(42.99%)  tps: 7,990  tflops: 62.47  mfu: 20.02%
[rank1]:2025-11-10 23:56:47,026 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4999  memory: 18.44GiB(38.81%)  tps: 7,990  tflops: 62.47  mfu: 20.02%
[rank2]:2025-11-10 23:56:47,026 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4999  memory: 12.14GiB(25.55%)  tps: 7,990  tflops: 62.47  mfu: 20.02%
[rank3]:2025-11-10 23:56:47,038 - INFO -  step: 400  loss:  0.3579  grad_norm:  0.4999  memory: 30.07GiB(63.29%)  tps: 7,990  tflops: 62.46  mfu: 20.02%
[rank0]:2025-11-10 23:56:47,094 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2356_stage0_step400.svg
[rank1]:2025-11-10 23:56:47,095 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2356_stage1_step400.svg
[rank2]:2025-11-10 23:56:47,095 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2356_stage2_step400.svg
[rank0]:2025-11-10 23:56:47,145 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251110_2356_stage4_step400.svg
[rank1]:2025-11-10 23:56:47,147 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251110_2356_stage5_step400.svg
[rank2]:2025-11-10 23:56:47,144 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251110_2356_stage6_step400.svg
[rank3]:2025-11-10 23:56:47,294 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251110_2356_real_step400_rank3.svg
[rank3]:> Batch Time: 1000.50 ms, GPU Bubble Ratio: 72.75%, 60.48%, 65.50%, 35.13%
[rank3]:2025-11-10 23:56:47,343 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2356_stage3_step400.svg
[rank3]:2025-11-10 23:56:47,390 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251110_2356_stage7_step400.svg
[rank3]:2025-11-10 23:57:10,408 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-10 23:57:10,832 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-10 23:57:10,832 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-10 23:57:10,816 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 00:00:06,858 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 00:00:10,807 - INFO - Avg. fwd time: 14.3194 / Avg. bwd time: 29.2052 / Avg. batch time: 934.5272 (ms) / GPU bubble ratio: 25.48%
[rank2]:2025-11-11 00:00:10,854 - INFO - Avg. fwd time: 8.1293 / Avg. bwd time: 14.5239 / Avg. batch time: 993.0481 (ms) / GPU bubble ratio: 63.50%
[rank3]:2025-11-11 00:00:10,907 - INFO -  step: 450  loss:  0.3050  grad_norm:  0.0899  memory: 30.07GiB(63.29%)  tps: 8,037  tflops: 62.83  mfu: 20.14%
[rank0]:2025-11-11 00:00:10,897 - INFO - Avg. fwd time: 8.5521 / Avg. bwd time: 11.5961 / Avg. batch time: 1053.3304 (ms) / GPU bubble ratio: 69.40%
[rank0]:2025-11-11 00:00:10,907 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0899  memory: 20.42GiB(42.99%)  tps: 8,036  tflops: 62.82  mfu: 20.14%
[rank2]:2025-11-11 00:00:10,907 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0899  memory: 12.14GiB(25.55%)  tps: 8,036  tflops: 62.82  mfu: 20.14%
[rank1]:2025-11-11 00:00:10,883 - INFO - Avg. fwd time: 10.3313 / Avg. bwd time: 16.5008 / Avg. batch time: 1031.8756 (ms) / GPU bubble ratio: 58.39%
[rank1]:2025-11-11 00:00:10,907 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0899  memory: 18.44GiB(38.81%)  tps: 8,036  tflops: 62.82  mfu: 20.14%
[rank0]:2025-11-11 00:03:30,790 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 00:03:34,417 - INFO - Avg. fwd time: 8.5600 / Avg. bwd time: 11.3061 / Avg. batch time: 1048.2701 (ms) / GPU bubble ratio: 69.68%
[rank3]:2025-11-11 00:03:34,467 - INFO - Avg. fwd time: 14.3221 / Avg. bwd time: 28.9224 / Avg. batch time: 930.7476 (ms) / GPU bubble ratio: 25.66%
[rank2]:2025-11-11 00:03:34,519 - INFO - Avg. fwd time: 8.1385 / Avg. bwd time: 14.4435 / Avg. batch time: 989.0737 (ms) / GPU bubble ratio: 63.47%
[rank1]:2025-11-11 00:03:34,600 - INFO - Avg. fwd time: 10.3440 / Avg. bwd time: 16.3084 / Avg. batch time: 1027.3692 (ms) / GPU bubble ratio: 58.49%
[rank1]:2025-11-11 00:03:34,903 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1652  memory: 18.44GiB(38.81%)  tps: 8,032  tflops: 62.79  mfu: 20.12%
[rank0]:2025-11-11 00:03:34,903 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1652  memory: 20.42GiB(42.99%)  tps: 8,032  tflops: 62.79  mfu: 20.12%
[rank2]:2025-11-11 00:03:34,903 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1652  memory: 12.14GiB(25.55%)  tps: 8,032  tflops: 62.79  mfu: 20.12%
[rank3]:2025-11-11 00:03:34,919 - INFO -  step: 500  loss:  0.2895  grad_norm:  0.1652  memory: 30.07GiB(63.29%)  tps: 8,031  tflops: 62.78  mfu: 20.12%
[rank1]:2025-11-11 00:03:34,974 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0003_stage1_step500.svg
[rank1]:2025-11-11 00:03:35,018 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0003_stage5_step500.svg
[rank0]:2025-11-11 00:03:34,974 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0003_stage0_step500.svg
[rank0]:2025-11-11 00:03:35,019 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0003_stage4_step500.svg
[rank2]:2025-11-11 00:03:34,974 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0003_stage2_step500.svg
[rank2]:2025-11-11 00:03:35,018 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0003_stage6_step500.svg
[rank3]:2025-11-11 00:03:35,183 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251111_0003_real_step500_rank3.svg
[rank3]:> Batch Time: 1007.00 ms, GPU Bubble Ratio: 72.73%, 60.48%, 65.24%, 34.65%
[rank3]:2025-11-11 00:03:35,227 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0003_stage3_step500.svg
[rank3]:2025-11-11 00:03:35,268 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0003_stage7_step500.svg
[rank0]:2025-11-11 00:06:54,063 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 00:06:57,634 - INFO - Avg. fwd time: 8.5670 / Avg. bwd time: 11.0472 / Avg. batch time: 1043.2099 (ms) / GPU bubble ratio: 69.92%
[rank2]:2025-11-11 00:06:57,735 - INFO - Avg. fwd time: 8.1479 / Avg. bwd time: 14.3587 / Avg. batch time: 985.0570 (ms) / GPU bubble ratio: 63.44%
[rank3]:2025-11-11 00:06:57,684 - INFO - Avg. fwd time: 14.3283 / Avg. bwd time: 28.6237 / Avg. batch time: 926.8101 (ms) / GPU bubble ratio: 25.85%
[rank1]:2025-11-11 00:06:57,815 - INFO - Avg. fwd time: 10.3556 / Avg. bwd time: 16.1218 / Avg. batch time: 1022.8390 (ms) / GPU bubble ratio: 58.58%
[rank0]:2025-11-11 00:06:58,116 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0829  memory: 20.42GiB(42.99%)  tps: 8,062  tflops: 63.03  mfu: 20.20%
[rank1]:2025-11-11 00:06:58,116 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0829  memory: 18.44GiB(38.81%)  tps: 8,062  tflops: 63.03  mfu: 20.20%
[rank2]:2025-11-11 00:06:58,116 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0829  memory: 12.14GiB(25.55%)  tps: 8,063  tflops: 63.03  mfu: 20.20%
[rank3]:2025-11-11 00:06:58,116 - INFO -  step: 550  loss:  0.2848  grad_norm:  0.0829  memory: 30.07GiB(63.29%)  tps: 8,063  tflops: 63.03  mfu: 20.20%
[rank0]:2025-11-11 00:10:16,919 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 00:10:21,009 - INFO - Avg. fwd time: 14.3275 / Avg. bwd time: 28.3828 / Avg. batch time: 923.4745 (ms) / GPU bubble ratio: 26.00%
[rank0]:2025-11-11 00:10:21,102 - INFO - Avg. fwd time: 8.5730 / Avg. bwd time: 10.8205 / Avg. batch time: 1038.8455 (ms) / GPU bubble ratio: 70.13%
[rank0]:2025-11-11 00:10:21,112 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1397  memory: 20.42GiB(42.99%)  tps: 8,071  tflops: 63.10  mfu: 20.22%
[rank1]:2025-11-11 00:10:21,086 - INFO - Avg. fwd time: 10.3640 / Avg. bwd time: 15.9650 / Avg. batch time: 1018.9079 (ms) / GPU bubble ratio: 58.66%
[rank1]:2025-11-11 00:10:21,112 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1397  memory: 18.44GiB(38.81%)  tps: 8,071  tflops: 63.10  mfu: 20.22%
[rank2]:2025-11-11 00:10:21,056 - INFO - Avg. fwd time: 8.1551 / Avg. bwd time: 14.2884 / Avg. batch time: 981.5514 (ms) / GPU bubble ratio: 63.42%
[rank2]:2025-11-11 00:10:21,112 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1397  memory: 12.14GiB(25.55%)  tps: 8,071  tflops: 63.10  mfu: 20.22%
[rank0]:2025-11-11 00:10:21,179 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0010_stage0_step600.svg
[rank1]:2025-11-11 00:10:21,178 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0010_stage1_step600.svg
[rank2]:2025-11-11 00:10:21,178 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0010_stage2_step600.svg
[rank3]:2025-11-11 00:10:21,125 - INFO -  step: 600  loss:  0.2717  grad_norm:  0.1397  memory: 30.07GiB(63.29%)  tps: 8,071  tflops: 63.09  mfu: 20.22%
[rank0]:2025-11-11 00:10:21,225 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0010_stage4_step600.svg
[rank1]:2025-11-11 00:10:21,223 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0010_stage5_step600.svg
[rank2]:2025-11-11 00:10:21,223 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0010_stage6_step600.svg
[rank3]:2025-11-11 00:10:21,383 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251111_0010_real_step600_rank3.svg
[rank3]:> Batch Time: 1000.00 ms, GPU Bubble Ratio: 72.25%, 60.38%, 65.02%, 34.82%
[rank3]:2025-11-11 00:10:21,429 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0010_stage3_step600.svg
[rank3]:2025-11-11 00:10:21,472 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0010_stage7_step600.svg
[rank0]:2025-11-11 00:13:41,601 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 00:13:45,130 - INFO - Avg. fwd time: 14.3306 / Avg. bwd time: 28.2398 / Avg. batch time: 921.6049 (ms) / GPU bubble ratio: 26.09%
[rank0]:2025-11-11 00:13:45,091 - INFO - Avg. fwd time: 8.5768 / Avg. bwd time: 10.6590 / Avg. batch time: 1036.2949 (ms) / GPU bubble ratio: 70.30%
[rank2]:2025-11-11 00:13:45,190 - INFO - Avg. fwd time: 8.1612 / Avg. bwd time: 14.2294 / Avg. batch time: 979.6333 (ms) / GPU bubble ratio: 63.43%
[rank1]:2025-11-11 00:13:45,262 - INFO - Avg. fwd time: 10.3693 / Avg. bwd time: 15.8501 / Avg. batch time: 1016.6757 (ms) / GPU bubble ratio: 58.74%
[rank2]:2025-11-11 00:13:45,560 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0763  memory: 12.14GiB(25.55%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank3]:2025-11-11 00:13:45,558 - INFO -  step: 650  loss:  0.2726  grad_norm:  0.0763  memory: 30.07GiB(63.29%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank1]:2025-11-11 00:13:45,560 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0763  memory: 18.44GiB(38.81%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank0]:2025-11-11 00:13:45,560 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0763  memory: 20.42GiB(42.99%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank0]:2025-11-11 00:17:05,606 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 00:17:09,184 - INFO - Avg. fwd time: 8.5826 / Avg. bwd time: 10.4901 / Avg. batch time: 1033.3937 (ms) / GPU bubble ratio: 70.47%
[rank3]:2025-11-11 00:17:09,229 - INFO - Avg. fwd time: 14.3348 / Avg. bwd time: 28.0787 / Avg. batch time: 919.4599 (ms) / GPU bubble ratio: 26.19%
[rank2]:2025-11-11 00:17:09,285 - INFO - Avg. fwd time: 8.1688 / Avg. bwd time: 14.1733 / Avg. batch time: 977.3587 (ms) / GPU bubble ratio: 63.42%
[rank1]:2025-11-11 00:17:09,364 - INFO - Avg. fwd time: 10.3775 / Avg. bwd time: 15.7374 / Avg. batch time: 1014.0928 (ms) / GPU bubble ratio: 58.80%
[rank1]:2025-11-11 00:17:09,656 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1012  memory: 18.44GiB(38.81%)  tps: 8,028  tflops: 62.76  mfu: 20.11%
[rank3]:2025-11-11 00:17:09,670 - INFO -  step: 700  loss:  0.2401  grad_norm:  0.1012  memory: 30.07GiB(63.29%)  tps: 8,027  tflops: 62.75  mfu: 20.11%
[rank0]:2025-11-11 00:17:09,656 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1012  memory: 20.42GiB(42.99%)  tps: 8,028  tflops: 62.76  mfu: 20.11%
[rank2]:2025-11-11 00:17:09,656 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1012  memory: 12.14GiB(25.55%)  tps: 8,028  tflops: 62.76  mfu: 20.11%
[rank1]:2025-11-11 00:17:09,727 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0017_stage1_step700.svg
[rank1]:2025-11-11 00:17:09,774 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0017_stage5_step700.svg
[rank0]:2025-11-11 00:17:09,727 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0017_stage0_step700.svg
[rank0]:2025-11-11 00:17:09,774 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0017_stage4_step700.svg
[rank2]:2025-11-11 00:17:09,726 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0017_stage2_step700.svg
[rank2]:2025-11-11 00:17:09,774 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0017_stage6_step700.svg
[rank3]:2025-11-11 00:17:09,945 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251111_0017_real_step700_rank3.svg
[rank3]:> Batch Time: 999.50 ms, GPU Bubble Ratio: 72.97%, 60.20%, 64.72%, 34.56%
[rank3]:2025-11-11 00:17:09,993 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0017_stage3_step700.svg
[rank3]:2025-11-11 00:17:10,037 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0017_stage7_step700.svg
[rank0]:2025-11-11 00:20:28,810 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 00:20:32,855 - INFO - Avg. fwd time: 14.3242 / Avg. bwd time: 27.9312 / Avg. batch time: 917.3102 (ms) / GPU bubble ratio: 26.30%
[rank0]:2025-11-11 00:20:32,948 - INFO - Avg. fwd time: 8.5846 / Avg. bwd time: 10.3588 / Avg. batch time: 1030.6534 (ms) / GPU bubble ratio: 70.59%
[rank2]:2025-11-11 00:20:32,899 - INFO - Avg. fwd time: 8.1724 / Avg. bwd time: 14.1289 / Avg. batch time: 975.1672 (ms) / GPU bubble ratio: 63.41%
[rank1]:2025-11-11 00:20:32,930 - INFO - Avg. fwd time: 10.3816 / Avg. bwd time: 15.6376 / Avg. batch time: 1011.6281 (ms) / GPU bubble ratio: 58.85%
[rank0]:2025-11-11 00:20:32,957 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1183  memory: 20.42GiB(42.99%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank2]:2025-11-11 00:20:32,957 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1183  memory: 12.14GiB(25.55%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank3]:2025-11-11 00:20:32,969 - INFO -  step: 750  loss:  0.2875  grad_norm:  0.1183  memory: 30.07GiB(63.29%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank1]:2025-11-11 00:20:32,957 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1183  memory: 18.44GiB(38.81%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank0]:2025-11-11 00:23:51,214 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 00:23:54,883 - INFO - Avg. fwd time: 8.5866 / Avg. bwd time: 10.2538 / Avg. batch time: 1028.3056 (ms) / GPU bubble ratio: 70.69%
[rank2]:2025-11-11 00:23:54,986 - INFO - Avg. fwd time: 8.1757 / Avg. bwd time: 14.0930 / Avg. batch time: 973.2355 (ms) / GPU bubble ratio: 63.39%
[rank3]:2025-11-11 00:23:54,936 - INFO - Avg. fwd time: 14.3167 / Avg. bwd time: 27.8055 / Avg. batch time: 915.4684 (ms) / GPU bubble ratio: 26.38%
[rank1]:2025-11-11 00:23:55,067 - INFO - Avg. fwd time: 10.3851 / Avg. bwd time: 15.5623 / Avg. batch time: 1009.4884 (ms) / GPU bubble ratio: 58.87%
[rank1]:2025-11-11 00:23:55,371 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1161  memory: 18.44GiB(38.81%)  tps: 8,094  tflops: 63.28  mfu: 20.28%
[rank1]:2025-11-11 00:23:55,372 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1161  tps: 8,276  tflops: 64.70  mfu: 18.99%
[rank1]:2025-11-11 00:23:55,372 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-11 00:23:55,372 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-11 00:23:55,371 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1161  memory: 12.14GiB(25.55%)  tps: 8,094  tflops: 63.28  mfu: 20.28%
[rank2]:2025-11-11 00:23:55,372 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1161  tps: 8,276  tflops: 64.70  mfu: 19.01%
[rank2]:2025-11-11 00:23:55,372 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-11 00:23:55,372 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-11 00:23:55,384 - INFO -  step: 800  loss:  0.2856  grad_norm:  0.1161  memory: 30.07GiB(63.29%)  tps: 8,094  tflops: 63.28  mfu: 20.28%
[rank3]:2025-11-11 00:23:55,384 - INFO -  final step: 800  loss:  0.2856  grad_norm:  0.1161  tps: 8,277  tflops: 64.71  mfu: 19.03%
[rank3]:2025-11-11 00:23:55,384 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-11 00:23:55,385 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 00:23:55,371 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1161  memory: 20.42GiB(42.99%)  tps: 8,094  tflops: 63.28  mfu: 20.28%
[rank0]:2025-11-11 00:23:55,371 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1161  tps: 8,276  tflops: 64.70  mfu: 18.99%
[rank0]:2025-11-11 00:23:55,372 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-11 00:23:55,372 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 00:23:57,403 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-11 00:23:57,482 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0023_stage1_final800.svg
[rank2]:2025-11-11 00:23:57,485 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0023_stage2_final800.svg
[rank0]:2025-11-11 00:23:57,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0023_stage0_final800.svg
[rank2]:2025-11-11 00:23:57,600 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank2_stage2.svg
[rank2]:	> Counts Sum: 244560, Total Sum: 420480 (58.16%), Ratio(%) per element: [58.73, 56.84, 58.56, 57.36, 57.7, 56.67, 59.24, 58.39, 58.39, 59.41, 57.36, 58.56, 58.56, 58.04, 58.56, 58.39, 58.39, 57.7]
[rank0]:2025-11-11 00:23:57,600 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank0_stage0.svg
[rank0]:	> Counts Sum: 318480, Total Sum: 443840 (71.76%), Ratio(%) per element: [69.0, 70.71, 69.34, 69.69, 71.23, 70.37, 70.54, 69.34, 70.37, 71.91, 72.08, 72.43, 72.26, 73.45, 73.45, 72.94, 74.31, 74.65, 75.17]
[rank1]:2025-11-11 00:23:57,624 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank1_stage1.svg
[rank1]:	> Counts Sum: 322560, Total Sum: 630720 (51.14%), Ratio(%) per element: [51.36, 50.85, 51.02, 51.54, 50.51, 52.05, 51.19, 51.19, 51.36, 51.02, 50.85, 50.85, 51.88, 51.88, 50.68, 51.88, 51.88, 51.19, 50.51, 50.0, 51.19, 51.19, 50.51, 51.19, 50.85, 50.85, 51.19]
[rank1]:2025-11-11 00:23:57,673 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251111_0023_stage5_final800.svg
[rank3]:2025-11-11 00:23:57,693 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251111_0023_real_final800_rank3.svg
[rank3]:> Batch Time: 999.50 ms, GPU Bubble Ratio: 72.46%, 60.29%, 65.08%, 34.70%
[rank2]:2025-11-11 00:23:57,648 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251111_0023_stage6_final800.svg
[rank0]:2025-11-11 00:23:57,649 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251111_0023_stage4_final800.svg
[rank1]:2025-11-11 00:23:57,780 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank1_stage5.svg
[rank1]:	> Counts Sum: 360480, Total Sum: 420480 (85.73%), Ratio(%) per element: [85.78, 85.78, 85.78, 85.61, 85.78, 86.13, 85.61, 85.78, 85.61, 85.27, 85.78, 85.27, 85.61, 86.13, 85.78, 85.78, 85.61, 85.95]
[rank1]:2025-11-11 00:23:57,780 - INFO - Destroying the purge thread.
[rank2]:2025-11-11 00:23:57,756 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank2_stage6.svg
[rank2]:	> Counts Sum: 373840, Total Sum: 420480 (88.91%), Ratio(%) per element: [90.06, 88.18, 89.38, 88.35, 89.04, 89.72, 89.72, 88.69, 87.84, 89.55, 88.86, 88.52, 88.69, 88.86, 88.86, 88.52, 88.86, 88.52]
[rank2]:2025-11-11 00:23:57,756 - INFO - Destroying the purge thread.
[rank2]:2025-11-11 00:23:57,785 - INFO - Process group destroyed
[rank0]:2025-11-11 00:23:57,757 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank0_stage4.svg
[rank0]:	> Counts Sum: 395360, Total Sum: 420480 (94.03%), Ratio(%) per element: [94.69, 93.32, 93.49, 95.54, 93.83, 94.0, 93.49, 93.83, 93.32, 93.15, 94.86, 94.86, 95.2, 94.17, 94.0, 93.49, 93.83, 93.32]
[rank0]:2025-11-11 00:23:57,757 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-11 00:23:57,949 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251111_0023_thry_final800_rank3.svg
[rank3]:> Batch Time: 591.63 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-11 00:23:57,998 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0023_stage3_final800.svg
[rank1]:2025-11-11 00:23:58,063 - INFO - Process group destroyed
[rank3]:2025-11-11 00:23:58,110 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank3_stage3.svg
[rank3]:	> Counts Sum: 96800, Total Sum: 420480 (23.02%), Ratio(%) per element: [24.48, 23.45, 23.11, 21.4, 22.94, 21.23, 21.74, 23.45, 23.8, 20.89, 23.8, 24.65, 24.14, 23.28, 23.28, 23.45, 22.26, 22.94]
[rank3]:2025-11-11 00:23:58,157 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251111_0023_stage7_final800.svg
[rank3]:2025-11-11 00:23:58,243 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251111_0023_rank3_stage7.svg
[rank3]:	> Counts Sum: 61840, Total Sum: 256960 (24.07%), Ratio(%) per element: [23.45, 23.97, 24.65, 23.97, 23.11, 23.97, 25.68, 23.97, 23.28, 24.82, 23.8]
[rank3]:2025-11-11 00:23:58,243 - INFO - Destroying the purge thread.
[rank3]:2025-11-11 00:23:58,317 - INFO - Process group destroyed
[rank0]:2025-11-11 00:23:59,757 - INFO - Training completed
[rank0]:2025-11-11 00:23:59,758 - INFO - Destroying the purge thread.
[rank0]:2025-11-11 00:24:00,103 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'norm', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
