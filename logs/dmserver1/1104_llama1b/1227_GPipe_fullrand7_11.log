
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 15:16:56 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_GPipe_fullrand7_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-28 15:17:02,778 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank1]:2025-12-28 15:17:02,801 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank2]:2025-12-28 15:17:02,775 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank0]:2025-12-28 15:17:02,880 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank3]:2025-12-28 15:17:03,049 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 15:17:03,051 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-28 15:17:03,123 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 15:17:03,125 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-28 15:17:03,113 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 15:17:03,115 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 15:17:03,195 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 15:17:03,198 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 15:17:03,201 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 15:17:03,202 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-28 15:17:03,585 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 15:17:06,747 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-28 15:17:06,939 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 15:17:06,922 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 15:17:06,905 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 15:17:06,936 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 15:17:06,966 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 15:17:06,967 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 15:17:06,992 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 15:17:06,992 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-28 15:17:06,961 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 15:17:06,988 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 15:17:06,988 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-28 15:17:06,961 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 15:17:06,961 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-28 15:17:07,142 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 15:17:07,142 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 15:17:07,142 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-28 15:17:07,196 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 15:17:07,196 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 15:17:07,197 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-28 15:17:07,227 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 15:17:07,227 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 15:17:07,228 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ap1b4rs2
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_GPipe_fullrand7_11_dm1/20251228-1517/wandb/run-20251228_151707-ap1b4rs2
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_GPipe_fullrand7_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ap1b4rs2
[rank3]:2025-12-28 15:17:09,175 - WandB logging enabled
[rank3]:2025-12-28 15:17:09,176 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 15:17:09,213 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 15:17:09,241 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 15:17:09,241 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-28 15:17:09,434 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 15:17:09,435 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 15:17:09,435 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-28 15:17:09,450 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 15:17:09,451 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_GPipe_fullrand7_11_dm1
[rank0]:2025-12-28 15:17:09,451 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 15:17:09,452 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 15:17:09,452 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-28 15:17:09,451 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-28 15:17:09,451 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 15:17:12,204 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 15:17:12,204 - Finished loading the checkpoint in 2.75 seconds.
[rank0]:2025-12-28 15:17:12,204 - Training starts at step 1
[rank3]:2025-12-28 15:17:17,756 -  step:  1  loss: 10.6088  grad_norm: 116.5372  memory: 24.19GiB(50.91%)  tps: 3,837  tflops: 29.99  mfu: 9.61%
[rank3]:2025-12-28 15:17:17,756 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 15:17:17,746 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 10.24GiB(21.56%)  tps: 3,032  tflops: 23.70  mfu: 7.60%
[rank2]:2025-12-28 15:17:17,746 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 15:17:17,749 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 12.75GiB(26.83%)  tps: 3,038  tflops: 23.75  mfu: 7.61%
[rank1]:2025-12-28 15:17:17,754 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 15:17:17,784 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 13.25GiB(27.89%)  tps: 3,029  tflops: 23.68  mfu: 7.59%
[rank0]:2025-12-28 15:17:17,784 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 15:19:16,123 - Avg. fwd time: 10.7372 / Avg. bwd time: 43.0192 / Avg. batch time: 489.8489 (ms) / GPU bubble ratio: 12.21%
[rank0]:2025-12-28 15:19:16,208 - Avg. fwd time: 8.2015 / Avg. bwd time: 25.0679 / Avg. batch time: 601.0930 (ms) / GPU bubble ratio: 55.72%
[rank1]:2025-12-28 15:19:16,178 - Avg. fwd time: 9.0367 / Avg. bwd time: 24.8416 / Avg. batch time: 562.0707 (ms) / GPU bubble ratio: 51.78%
[rank2]:2025-12-28 15:19:16,148 - Avg. fwd time: 6.9657 / Avg. bwd time: 19.2413 / Avg. batch time: 521.9353 (ms) / GPU bubble ratio: 59.83%
[rank0]:2025-12-28 15:21:15,871 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 15:21:20,723 - Avg. fwd time: 10.7916 / Avg. bwd time: 43.3795 / Avg. batch time: 493.0671 (ms) / GPU bubble ratio: 12.11%
[rank2]:2025-12-28 15:21:20,748 - Avg. fwd time: 6.9772 / Avg. bwd time: 19.3303 / Avg. batch time: 524.8646 (ms) / GPU bubble ratio: 59.90%
[rank1]:2025-12-28 15:21:20,777 - Avg. fwd time: 9.0686 / Avg. bwd time: 24.9528 / Avg. batch time: 564.7278 (ms) / GPU bubble ratio: 51.80%
[rank1]:2025-12-28 15:21:20,832 -  step: 50  loss: -8.0000  grad_norm: 12.9486  memory: 15.15GiB(31.89%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank3]:2025-12-28 15:21:20,841 -  step: 50  loss:  9.9205  grad_norm: 12.9486  memory: 26.98GiB(56.79%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank2]:2025-12-28 15:21:20,829 -  step: 50  loss: -8.0000  grad_norm: 12.9486  memory: 12.26GiB(25.80%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank0]:2025-12-28 15:21:20,807 - Avg. fwd time: 8.2542 / Avg. bwd time: 25.1665 / Avg. batch time: 603.4493 (ms) / GPU bubble ratio: 55.69%
[rank0]:2025-12-28 15:21:20,843 -  step: 50  loss: -8.0000  grad_norm: 12.9486  memory: 17.08GiB(35.95%)  tps: 6,606  tflops: 51.64  mfu: 16.55%
[rank3]:2025-12-28 15:22:05,548 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-28 15:22:55,569 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-28 15:22:55,881 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-28 15:23:14,606 - Avg. fwd time: 6.9825 / Avg. bwd time: 18.4971 / Avg. batch time: 511.4273 (ms) / GPU bubble ratio: 60.14%
[rank3]:2025-12-28 15:23:14,591 - Avg. fwd time: 10.8090 / Avg. bwd time: 41.8123 / Avg. batch time: 480.6133 (ms) / GPU bubble ratio: 12.41%
[rank1]:2025-12-28 15:23:14,622 - Avg. fwd time: 9.0856 / Avg. bwd time: 23.8643 / Avg. batch time: 550.0848 (ms) / GPU bubble ratio: 52.08%
[rank0]:2025-12-28 15:23:14,626 - Avg. fwd time: 8.2687 / Avg. bwd time: 23.1976 / Avg. batch time: 586.6846 (ms) / GPU bubble ratio: 57.09%
[rank3]:2025-12-28 15:23:26,912 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-28 15:23:27,250 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1523_max_batch_time.svg
[rank3]:			> Batch Time: 540.76 ms, GPU Bubble Ratio: 49.94%, 49.15%, 60.63%, 18.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-58ms      | [S0,MB7,F]  58-8-66ms      | [S0,MB0,B]  202-25-227ms   | [S0,MB1,B]  245-25-270ms   | [S0,MB2,B]  289-25-315ms   | [S0,MB3,B]  335-25-360ms   | [S0,MB4,B]  379-25-405ms   | [S0,MB5,B]  424-25-449ms   | [S0,MB6,B]  469-25-495ms   | [S0,MB7,B]  515-25-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-74ms      | [S1,MB7,F]  74-8-82ms      | [S1,MB0,B]  177-25-202ms   | [S1,MB1,B]  220-25-245ms   | [S1,MB2,B]  264-25-289ms   | [S1,MB3,B]  309-25-335ms   | [S1,MB4,B]  354-25-379ms   | [S1,MB5,B]  399-25-424ms   | [S1,MB6,B]  444-25-469ms   | [S1,MB7,B]  489-25-515ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-72ms      | [S2,MB6,F]  74-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  157-19-177ms   | [S2,MB1,B]  200-19-220ms   | [S2,MB2,B]  244-19-264ms   | [S2,MB3,B]  290-19-309ms   | [S2,MB4,B]  334-19-354ms   | [S2,MB5,B]  379-19-399ms   | [S2,MB6,B]  424-19-444ms   | [S2,MB7,B]  470-19-489ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB1,F]  43-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-74ms     | [S3,MB4,F]  74-10-84ms     | [S3,MB5,F]  84-10-95ms     | [S3,MB6,F]  95-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-157ms   AFR(10):0.9655 | [S3,MB1,B]  157-43-200ms   AFR(10):0.9655 | [S3,MB2,B]  200-44-244ms   AFR(10):0.9655 | [S3,MB3,B]  244-45-290ms   AFR(10):0.9655 | [S3,MB4,B]  290-44-334ms   AFR(10):0.9655 | [S3,MB5,B]  334-44-379ms   AFR(10):0.9655 | [S3,MB6,B]  379-45-424ms   AFR(10):0.9655 | [S3,MB7,B]  424-45-470ms   AFR(10):0.9655
[rank3]:2025-12-28 15:23:27,380 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1523_min_batch_time.svg
[rank3]:			> Batch Time: 309.56 ms, GPU Bubble Ratio: 78.41%, 48.59%, 60.38%, 15.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-58ms      | [S0,MB7,F]  58-8-66ms      | [S0,MB0,B]  156-0-156ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB2,B]  199-0-199ms    | [S0,MB3,B]  222-0-222ms    | [S0,MB4,B]  243-0-243ms    | [S0,MB5,B]  265-0-265ms    | [S0,MB6,B]  286-0-286ms    | [S0,MB7,B]  309-0-309ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-74ms      | [S1,MB7,F]  74-8-82ms      | [S1,MB0,B]  146-10-156ms   | [S1,MB1,B]  167-10-178ms   | [S1,MB2,B]  189-10-199ms   | [S1,MB3,B]  211-10-222ms   | [S1,MB4,B]  232-10-243ms   | [S1,MB5,B]  254-10-265ms   | [S1,MB6,B]  276-10-286ms   | [S1,MB7,B]  298-10-309ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-72ms      | [S2,MB6,F]  74-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  137-8-146ms    | [S2,MB1,B]  159-8-167ms    | [S2,MB2,B]  180-8-189ms    | [S2,MB3,B]  203-8-211ms    | [S2,MB4,B]  224-8-232ms    | [S2,MB5,B]  246-8-254ms    | [S2,MB6,B]  268-8-276ms    | [S2,MB7,B]  290-8-298ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB1,F]  43-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-74ms     | [S3,MB4,F]  74-10-84ms     | [S3,MB5,F]  84-10-95ms     | [S3,MB6,F]  95-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-21-137ms   AFR(10):0.9655 | [S3,MB1,B]  137-21-159ms   AFR(10):0.9655 | [S3,MB2,B]  159-21-180ms   AFR(10):0.9655 | [S3,MB3,B]  180-22-203ms   AFR(10):0.9655 | [S3,MB4,B]  203-21-224ms   AFR(10):0.9655 | [S3,MB5,B]  224-21-246ms   AFR(10):0.9655 | [S3,MB6,B]  246-21-268ms   AFR(10):0.9655 | [S3,MB7,B]  268-22-290ms   AFR(10):0.9655
[rank3]:2025-12-28 15:23:27,522 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1523_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 342.41 ms, GPU Bubble Ratio: 41.12%, 33.09%, 41.17%, 14.15%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-58ms      | [S0,MB7,F]  58-8-66ms      | [S0,MB0,B]  202-25-227ms   | [S0,MB1,B]  233-25-258ms   | [S0,MB2,B]  258-25-284ms   | [S0,MB3,B]  284-25-309ms   | [S0,MB4,B]  309-10-320ms   | [S0,MB5,B]  320-21-342ms   | [S0,MB6,B]  342-0-342ms    | [S0,MB7,B]  342-0-342ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-74ms      | [S1,MB7,F]  74-8-82ms      | [S1,MB0,B]  177-25-202ms   | [S1,MB1,B]  211-21-233ms   | [S1,MB2,B]  233-25-258ms   | [S1,MB3,B]  258-18-277ms   | [S1,MB4,B]  277-25-302ms   | [S1,MB5,B]  302-18-320ms   | [S1,MB6,B]  320-11-331ms   | [S1,MB7,B]  331-10-342ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-72ms      | [S2,MB6,F]  74-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  157-19-177ms   | [S2,MB1,B]  192-19-211ms   | [S2,MB2,B]  213-19-233ms   | [S2,MB3,B]  235-19-255ms   | [S2,MB4,B]  257-19-277ms   | [S2,MB5,B]  279-19-298ms   | [S2,MB6,B]  300-19-320ms   | [S2,MB7,B]  323-8-331ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB1,F]  43-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-74ms     | [S3,MB4,F]  74-10-84ms     | [S3,MB5,F]  84-10-95ms     | [S3,MB6,F]  95-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-157ms   AFR(10):0.9655 | [S3,MB1,B]  157-34-192ms   AFR(10):0.9655 | [S3,MB2,B]  192-21-213ms   AFR(10):0.9655 | [S3,MB3,B]  213-22-235ms   AFR(10):0.9655 | [S3,MB4,B]  235-21-257ms   AFR(10):0.9655 | [S3,MB5,B]  257-21-279ms   AFR(10):0.9655 | [S3,MB6,B]  279-21-300ms   AFR(10):0.9655 | [S3,MB7,B]  300-22-323ms   AFR(10):0.9655
[rank3]:2025-12-28 15:23:27,522 - 	> Batch Time: 342.41 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.37)
[rank3]:2025-12-28 15:24:50,452 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.10(0.13)/0.40, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-28 15:24:50,626 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.28(0.33)/1.00
[rank0]:2025-12-28 15:24:50,670 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 15:24:50,671 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.16(0.19)/0.57, [MB5] 0.03(0.05)/0.14, [MB6] 0.27(0.33)/1.00, [MB7] 0.27(0.33)/1.00
[rank1]:2025-12-28 15:24:50,649 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.07(0.08)/0.24, [MB2] 0.00(0.00)/0.00, [MB3] 0.11(0.15)/0.45, [MB4] 0.00(0.00)/0.00, [MB5] 0.13(0.16)/0.49, [MB6] 0.27(0.32)/0.97, [MB7] 0.27(0.33)/1.00
[rank3]:2025-12-28 15:24:55,201 - Avg. fwd time: 10.8115 / Avg. bwd time: 39.0980 / Avg. batch time: 458.8936 (ms) / GPU bubble ratio: 12.99%
[rank2]:2025-12-28 15:24:55,225 - Avg. fwd time: 6.9839 / Avg. bwd time: 18.1606 / Avg. batch time: 491.5192 (ms) / GPU bubble ratio: 59.07%
[rank1]:2025-12-28 15:24:55,252 - Avg. fwd time: 9.1028 / Avg. bwd time: 22.9456 / Avg. batch time: 529.0286 (ms) / GPU bubble ratio: 51.54%
[rank3]:2025-12-28 15:24:55,314 -  step: 100  loss:  8.7000  grad_norm:  7.2152  memory: 26.98GiB(56.79%)  tps: 7,639  tflops: 59.72  mfu: 19.14%
[rank2]:2025-12-28 15:24:55,301 -  step: 100  loss: -8.0000  grad_norm:  7.2152  memory: 12.26GiB(25.80%)  tps: 7,639  tflops: 59.72  mfu: 19.14%
[rank0]:2025-12-28 15:24:55,280 - Avg. fwd time: 8.2588 / Avg. bwd time: 21.7326 / Avg. batch time: 561.7449 (ms) / GPU bubble ratio: 57.29%
[rank0]:2025-12-28 15:24:55,316 -  step: 100  loss: -8.0000  grad_norm:  7.2152  memory: 17.08GiB(35.95%)  tps: 7,639  tflops: 59.72  mfu: 19.14%
[rank1]:2025-12-28 15:24:55,305 -  step: 100  loss: -8.0000  grad_norm:  7.2152  memory: 15.15GiB(31.89%)  tps: 7,639  tflops: 59.72  mfu: 19.14%
[rank2]:2025-12-28 15:24:55,379 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1524_stage2_step100.svg
[rank0]:2025-12-28 15:24:55,380 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1524_stage0_step100.svg
[rank1]:2025-12-28 15:24:55,376 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1524_stage1_step100.svg
[rank3]:2025-12-28 15:24:55,463 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1524_step100_rank3.svg
[rank3]:			> Batch Time: 559.47 ms, GPU Bubble Ratio: 54.08%, 53.25%, 62.52%, 27.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-48ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  311-25-336ms   | [S0,MB2,B]  353-25-378ms   | [S0,MB3,B]  384-25-410ms   | [S0,MB4,B]  428-24-452ms   | [S0,MB5,B]  468-25-494ms   | [S0,MB6,B]  508-21-529ms   | [S0,MB7,B]  541-17-559ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-119ms    | [S1,MB7,F]  128-8-137ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  285-23-308ms   | [S1,MB2,B]  324-25-349ms   | [S1,MB3,B]  357-23-381ms   | [S1,MB4,B]  399-25-425ms   | [S1,MB5,B]  441-23-465ms   | [S1,MB6,B]  483-21-505ms   | [S1,MB7,B]  517-19-537ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  107-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-150ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  262-19-281ms   | [S2,MB2,B]  301-19-320ms   | [S2,MB3,B]  334-19-354ms   | [S2,MB4,B]  376-19-396ms   | [S2,MB5,B]  418-19-438ms   | [S2,MB6,B]  460-19-479ms   | [S2,MB7,B]  497-16-513ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  104-10-114ms   | [S3,MB5,F]  122-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  175-40-215ms   | [S3,MB1,B]  214-40-254ms   | [S3,MB2,B]  255-39-294ms   | [S3,MB3,B]  294-31-325ms   | [S3,MB4,B]  327-41-368ms   | [S3,MB5,B]  369-43-412ms   | [S3,MB6,B]  412-41-453ms   | [S3,MB7,B]  453-42-495ms  
[rank3]:2025-12-28 15:24:55,508 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1524_stage3_step100.svg
[rank0]:2025-12-28 15:24:55,540 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1524_rank0_stage0.svg
[rank0]:	> Counts Sum: 33840, Total Sum: 71040 (47.64%), Ratio(%) per element: [50.0, 58.33, 54.16, 50.0, 50.0, 54.16, 50.0, 50.0, 54.16, 41.66, 54.16, 45.83, 50.0, 45.83, 50.0, 41.66, 50.0, 45.83, 54.16, 54.16, 41.66, 45.83, 45.83, 45.83, 50.0, 41.66, 41.66, 45.83, 41.66, 45.83, 41.66, 45.83, 50.0, 45.83, 41.66, 45.83, 41.66]
[rank1]:2025-12-28 15:24:55,534 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1524_rank1_stage1.svg
[rank1]:	> Counts Sum: 43200, Total Sum: 86400 (50.00%), Ratio(%) per element: [41.66, 45.83, 50.0, 58.33, 45.83, 45.83, 54.16, 54.16, 50.0, 45.83, 50.0, 54.16, 41.66, 58.33, 50.0, 45.83, 50.0, 54.16, 50.0, 54.16, 50.0, 50.0, 45.83, 54.16, 58.33, 45.83, 54.16, 50.0, 45.83, 50.0, 41.66, 50.0, 54.16, 58.33, 50.0, 45.83, 50.0, 58.33, 54.16, 45.83, 54.16, 50.0, 45.83, 41.66, 45.83]
[rank2]:2025-12-28 15:24:55,550 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1524_rank2_stage2.svg
[rank2]:	> Counts Sum: 26720, Total Sum: 69120 (38.66%), Ratio(%) per element: [41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 41.66, 37.5]
[rank0]:2025-12-28 15:24:55,635 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1524_stage0.svg
[rank1]:2025-12-28 15:24:55,631 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1524_stage1.svg
[rank3]:2025-12-28 15:24:55,647 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1524_rank3_stage3.svg
[rank3]:	> Counts Sum: 36880, Total Sum: 55680 (66.24%), Ratio(%) per element: [58.33, 66.66, 62.5, 70.83, 66.66, 75.0, 75.0, 58.33, 58.33, 66.66, 70.83, 66.66, 62.5, 58.33, 66.66, 66.66, 75.0, 66.66, 75.0, 66.66, 62.5, 62.5, 70.83, 66.66, 66.66, 58.33, 66.66, 66.66, 66.66]
[rank2]:2025-12-28 15:24:55,655 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1524_stage2.svg
[rank3]:2025-12-28 15:24:55,742 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1524_stage3.svg
[rank3]:2025-12-28 15:26:46,252 - Avg. fwd time: 10.8049 / Avg. bwd time: 38.6650 / Avg. batch time: 455.3615 (ms) / GPU bubble ratio: 13.09%
[rank2]:2025-12-28 15:26:46,274 - Avg. fwd time: 6.9820 / Avg. bwd time: 18.3583 / Avg. batch time: 487.0955 (ms) / GPU bubble ratio: 58.38%
[rank0]:2025-12-28 15:26:46,320 - Avg. fwd time: 8.2715 / Avg. bwd time: 21.9994 / Avg. batch time: 556.5591 (ms) / GPU bubble ratio: 56.49%
[rank1]:2025-12-28 15:26:46,300 - Avg. fwd time: 9.1067 / Avg. bwd time: 23.0241 / Avg. batch time: 524.0836 (ms) / GPU bubble ratio: 50.95%
[rank3]:2025-12-28 15:28:26,426 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.27)/0.40, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-28 15:28:26,605 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank0]:2025-12-28 15:28:26,643 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 15:28:26,644 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.35(0.38)/0.57, [MB5] 0.08(0.09)/0.14, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank1]:2025-12-28 15:28:26,626 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.13(0.16)/0.24, [MB2] 0.00(0.00)/0.00, [MB3] 0.27(0.30)/0.45, [MB4] 0.00(0.00)/0.00, [MB5] 0.29(0.33)/0.49, [MB6] 0.58(0.65)/0.97, [MB7] 0.60(0.67)/1.00
[rank3]:2025-12-28 15:28:30,596 - Avg. fwd time: 10.8023 / Avg. bwd time: 37.8652 / Avg. batch time: 448.9331 (ms) / GPU bubble ratio: 13.27%
[rank2]:2025-12-28 15:28:30,615 - Avg. fwd time: 6.9806 / Avg. bwd time: 18.4446 / Avg. batch time: 479.5916 (ms) / GPU bubble ratio: 57.59%
[rank3]:2025-12-28 15:28:30,695 -  step: 150  loss:  3.7892  grad_norm:  6.0926  memory: 26.98GiB(56.79%)  tps: 7,607  tflops: 59.47  mfu: 19.06%
[rank0]:2025-12-28 15:28:30,660 - Avg. fwd time: 8.2805 / Avg. bwd time: 21.9804 / Avg. batch time: 547.7846 (ms) / GPU bubble ratio: 55.81%
[rank0]:2025-12-28 15:28:30,697 -  step: 150  loss: -8.0000  grad_norm:  6.0926  memory: 17.08GiB(35.95%)  tps: 7,607  tflops: 59.47  mfu: 19.06%
[rank1]:2025-12-28 15:28:30,644 - Avg. fwd time: 9.1118 / Avg. bwd time: 22.9786 / Avg. batch time: 516.2803 (ms) / GPU bubble ratio: 50.27%
[rank1]:2025-12-28 15:28:30,686 -  step: 150  loss: -8.0000  grad_norm:  6.0926  memory: 15.15GiB(31.89%)  tps: 7,607  tflops: 59.47  mfu: 19.06%
[rank2]:2025-12-28 15:28:30,682 -  step: 150  loss: -8.0000  grad_norm:  6.0926  memory: 12.26GiB(25.80%)  tps: 7,607  tflops: 59.47  mfu: 19.06%
[rank3]:2025-12-28 15:30:10,800 - Avg. fwd time: 10.7982 / Avg. bwd time: 36.8490 / Avg. batch time: 440.8007 (ms) / GPU bubble ratio: 13.53%
[rank1]:2025-12-28 15:30:10,844 - Avg. fwd time: 9.1148 / Avg. bwd time: 22.8213 / Avg. batch time: 508.0761 (ms) / GPU bubble ratio: 49.71%
[rank2]:2025-12-28 15:30:10,821 - Avg. fwd time: 6.9788 / Avg. bwd time: 18.4937 / Avg. batch time: 470.9530 (ms) / GPU bubble ratio: 56.73%
[rank0]:2025-12-28 15:30:10,859 - Avg. fwd time: 8.3007 / Avg. bwd time: 21.8764 / Avg. batch time: 538.3506 (ms) / GPU bubble ratio: 55.16%
[rank3]:2025-12-28 15:31:44,573 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.38(0.40)/0.40, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-28 15:31:44,768 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-28 15:31:44,784 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.22(0.24)/0.24, [MB2] 0.00(0.00)/0.00, [MB3] 0.42(0.45)/0.45, [MB4] 0.00(0.00)/0.00, [MB5] 0.47(0.49)/0.49, [MB6] 0.91(0.97)/0.97, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-28 15:31:44,789 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 15:31:44,789 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.54(0.57)/0.57, [MB5] 0.14(0.14)/0.14, [MB6] 0.95(1.00)/1.00, [MB7] 0.95(1.00)/1.00
[rank3]:2025-12-28 15:31:48,425 - Avg. fwd time: 10.7947 / Avg. bwd time: 35.9215 / Avg. batch time: 433.3600 (ms) / GPU bubble ratio: 13.76%
[rank2]:2025-12-28 15:31:48,457 - Avg. fwd time: 6.9772 / Avg. bwd time: 18.5094 / Avg. batch time: 463.7892 (ms) / GPU bubble ratio: 56.04%
[rank1]:2025-12-28 15:31:48,477 - Avg. fwd time: 9.1154 / Avg. bwd time: 22.5895 / Avg. batch time: 501.1607 (ms) / GPU bubble ratio: 49.39%
[rank1]:2025-12-28 15:31:48,509 -  step: 200  loss: -8.0000  grad_norm:  1.7010  memory: 15.15GiB(31.89%)  tps: 8,282  tflops: 64.75  mfu: 20.75%
[rank1]:2025-12-28 15:31:48,570 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1531_stage1_step200.svg
[rank0]:2025-12-28 15:31:48,483 - Avg. fwd time: 8.2977 / Avg. bwd time: 21.5140 / Avg. batch time: 529.8319 (ms) / GPU bubble ratio: 54.99%
[rank0]:2025-12-28 15:31:48,520 -  step: 200  loss: -8.0000  grad_norm:  1.7010  memory: 17.08GiB(35.95%)  tps: 8,282  tflops: 64.75  mfu: 20.75%
[rank0]:2025-12-28 15:31:48,569 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1531_stage0_step200.svg
[rank3]:2025-12-28 15:31:48,518 -  step: 200  loss:  1.4114  grad_norm:  1.7010  memory: 26.98GiB(56.79%)  tps: 8,282  tflops: 64.75  mfu: 20.75%
[rank2]:2025-12-28 15:31:48,505 -  step: 200  loss: -8.0000  grad_norm:  1.7010  memory: 12.26GiB(25.80%)  tps: 8,282  tflops: 64.75  mfu: 20.75%
[rank2]:2025-12-28 15:31:48,569 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1531_stage2_step200.svg
[rank3]:2025-12-28 15:31:48,661 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1531_step200_rank3.svg
[rank3]:			> Batch Time: 466.62 ms, GPU Bubble Ratio: 54.66%, 48.93%, 56.02%, 30.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  273-25-299ms   | [S0,MB1,B]  309-25-334ms   | [S0,MB2,B]  345-25-370ms   | [S0,MB3,B]  372-25-398ms   | [S0,MB4,B]  401-14-416ms   | [S0,MB5,B]  423-23-447ms   | [S0,MB6,B]  449-2-451ms    | [S0,MB7,B]  464-2-466ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-101ms     | [S1,MB6,F]  110-8-119ms    | [S1,MB7,F]  128-8-137ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  282-23-305ms   | [S1,MB2,B]  315-25-340ms   | [S1,MB3,B]  345-19-364ms   | [S1,MB4,B]  372-25-397ms   | [S1,MB5,B]  401-19-420ms   | [S1,MB6,B]  424-14-438ms   | [S1,MB7,B]  448-12-461ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  107-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-150ms    | [S2,MB0,B]  222-19-242ms   | [S2,MB1,B]  259-19-279ms   | [S2,MB2,B]  292-19-312ms   | [S2,MB3,B]  317-20-337ms   | [S2,MB4,B]  344-20-365ms   | [S2,MB5,B]  371-20-392ms   | [S2,MB6,B]  401-20-421ms   | [S2,MB7,B]  424-9-434ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  86-10-96ms     | [S3,MB4,F]  104-10-114ms   | [S3,MB5,F]  122-10-132ms   | [S3,MB6,F]  140-10-151ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  175-40-216ms   | [S3,MB1,B]  215-37-252ms   | [S3,MB2,B]  252-33-285ms   | [S3,MB3,B]  285-23-309ms   | [S3,MB4,B]  309-22-331ms   | [S3,MB5,B]  331-23-355ms   | [S3,MB6,B]  355-34-389ms   | [S3,MB7,B]  389-23-413ms  
[rank1]:2025-12-28 15:31:48,719 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1531_rank1_stage1.svg
[rank1]:	> Counts Sum: 115120, Total Sum: 374400 (30.75%), Ratio(%) per element: [26.92, 27.88, 29.8, 31.73, 28.84, 26.92, 30.76, 31.73, 28.84, 33.65, 27.88, 32.69, 29.8, 32.69, 33.65, 31.73, 30.76, 33.65, 33.65, 28.84, 35.57, 24.03, 27.88, 33.65, 26.92, 32.69, 29.8, 32.69, 32.69, 29.8, 26.92, 30.76, 29.8, 31.73, 34.61, 30.76, 31.73, 37.5, 33.65, 27.88, 27.88, 31.73, 31.73, 26.92, 31.73]
[rank0]:2025-12-28 15:31:48,723 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1531_rank0_stage0.svg
[rank0]:	> Counts Sum: 84720, Total Sum: 307840 (27.52%), Ratio(%) per element: [30.76, 40.38, 36.53, 33.65, 35.57, 35.57, 28.84, 35.57, 32.69, 30.76, 32.69, 32.69, 31.73, 31.73, 29.8, 27.88, 29.8, 31.73, 29.8, 25.96, 25.0, 24.03, 27.88, 26.92, 27.88, 25.0, 23.07, 20.19, 23.07, 25.0, 21.15, 19.23, 23.07, 18.26, 13.46, 15.38, 15.38]
[rank3]:2025-12-28 15:31:48,706 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1531_stage3_step200.svg
[rank2]:2025-12-28 15:31:48,724 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1531_rank2_stage2.svg
[rank2]:	> Counts Sum: 44960, Total Sum: 299520 (15.01%), Ratio(%) per element: [16.34, 14.42, 14.42, 14.42, 11.53, 17.3, 14.42, 16.34, 17.3, 14.42, 13.46, 16.34, 17.3, 15.38, 17.3, 13.46, 15.38, 15.38, 15.38, 14.42, 16.34, 13.46, 15.38, 14.42, 16.34, 17.3, 13.46, 15.38, 12.5, 13.46, 12.5, 16.34, 15.38, 13.46, 14.42, 15.38]
[rank3]:2025-12-28 15:31:48,840 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1531_rank3_stage3.svg
[rank3]:	> Counts Sum: 130640, Total Sum: 241280 (54.14%), Ratio(%) per element: [50.96, 49.03, 46.15, 55.76, 55.76, 58.65, 59.61, 57.69, 53.84, 59.61, 59.61, 63.46, 54.8, 52.88, 55.76, 45.19, 54.8, 55.76, 51.92, 50.0, 55.76, 50.96, 49.03, 57.69, 54.8, 54.8, 47.11, 55.76, 52.88]
[rank1]:2025-12-28 15:31:49,057 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1531_stage1.svg
[rank0]:2025-12-28 15:31:49,072 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1531_stage0.svg
[rank2]:2025-12-28 15:31:49,075 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1531_stage2.svg
[rank3]:2025-12-28 15:31:49,196 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1531_stage3.svg
[rank3]:2025-12-28 15:33:22,683 - Avg. fwd time: 10.7878 / Avg. bwd time: 34.8422 / Avg. batch time: 424.6624 (ms) / GPU bubble ratio: 14.04%
[rank0]:2025-12-28 15:33:22,755 - Avg. fwd time: 8.2914 / Avg. bwd time: 21.0601 / Avg. batch time: 521.0660 (ms) / GPU bubble ratio: 54.94%
[rank2]:2025-12-28 15:33:22,720 - Avg. fwd time: 6.9752 / Avg. bwd time: 18.5177 / Avg. batch time: 457.0145 (ms) / GPU bubble ratio: 55.37%
[rank1]:2025-12-28 15:33:22,749 - Avg. fwd time: 9.1162 / Avg. bwd time: 22.2862 / Avg. batch time: 494.1388 (ms) / GPU bubble ratio: 49.16%
[rank3]:2025-12-28 15:34:53,316 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-28 15:34:53,490 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-28 15:34:53,507 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 15:34:53,508 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.57(0.57)/0.57, [MB5] 0.14(0.14)/0.14, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-28 15:34:53,504 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.24)/0.24, [MB2] 0.00(0.00)/0.00, [MB3] 0.44(0.45)/0.45, [MB4] 0.00(0.00)/0.00, [MB5] 0.49(0.49)/0.49, [MB6] 0.98(0.97)/0.97, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-28 15:34:57,224 - Avg. fwd time: 10.7824 / Avg. bwd time: 34.0258 / Avg. batch time: 418.0836 (ms) / GPU bubble ratio: 14.26%
[rank2]:2025-12-28 15:34:57,261 - Avg. fwd time: 6.9726 / Avg. bwd time: 18.5251 / Avg. batch time: 451.8364 (ms) / GPU bubble ratio: 54.85%
[rank2]:2025-12-28 15:34:57,313 -  step: 250  loss: -8.0000  grad_norm:  0.7868  memory: 12.26GiB(25.80%)  tps: 8,678  tflops: 67.84  mfu: 21.74%
[rank3]:2025-12-28 15:34:57,327 -  step: 250  loss:  0.4898  grad_norm:  0.7868  memory: 26.98GiB(56.79%)  tps: 8,678  tflops: 67.84  mfu: 21.74%
[rank0]:2025-12-28 15:34:57,291 - Avg. fwd time: 8.2850 / Avg. bwd time: 20.6986 / Avg. batch time: 514.4423 (ms) / GPU bubble ratio: 54.93%
[rank0]:2025-12-28 15:34:57,328 -  step: 250  loss: -8.0000  grad_norm:  0.7868  memory: 17.08GiB(35.95%)  tps: 8,678  tflops: 67.84  mfu: 21.74%
[rank1]:2025-12-28 15:34:57,285 - Avg. fwd time: 9.1151 / Avg. bwd time: 22.0596 / Avg. batch time: 488.9077 (ms) / GPU bubble ratio: 48.99%
[rank1]:2025-12-28 15:34:57,317 -  step: 250  loss: -8.0000  grad_norm:  0.7868  memory: 15.15GiB(31.89%)  tps: 8,678  tflops: 67.84  mfu: 21.74%
[rank0]:2025-12-28 15:36:32,450 - Avg. fwd time: 8.2790 / Avg. bwd time: 20.3902 / Avg. batch time: 509.2817 (ms) / GPU bubble ratio: 54.97%
[rank3]:2025-12-28 15:36:32,385 - Avg. fwd time: 10.7809 / Avg. bwd time: 33.3701 / Avg. batch time: 412.8236 (ms) / GPU bubble ratio: 14.44%
[rank1]:2025-12-28 15:36:32,443 - Avg. fwd time: 9.1160 / Avg. bwd time: 21.9002 / Avg. batch time: 484.8896 (ms) / GPU bubble ratio: 48.83%
[rank2]:2025-12-28 15:36:32,418 - Avg. fwd time: 6.9707 / Avg. bwd time: 18.5340 / Avg. batch time: 447.7615 (ms) / GPU bubble ratio: 54.43%
[rank3]:2025-12-28 15:38:03,066 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-28 15:38:03,257 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-28 15:38:03,271 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.24)/0.24, [MB2] 0.00(0.00)/0.00, [MB3] 0.44(0.45)/0.45, [MB4] 0.00(0.00)/0.00, [MB5] 0.49(0.49)/0.49, [MB6] 0.98(0.97)/0.97, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-28 15:38:03,274 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 15:38:03,275 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.57(0.57)/0.57, [MB5] 0.14(0.14)/0.14, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-28 15:38:06,968 - Avg. fwd time: 6.9703 / Avg. bwd time: 18.5438 / Avg. batch time: 444.0683 (ms) / GPU bubble ratio: 54.04%
[rank3]:2025-12-28 15:38:06,925 - Avg. fwd time: 10.7793 / Avg. bwd time: 32.7608 / Avg. batch time: 407.9315 (ms) / GPU bubble ratio: 14.61%
[rank2]:2025-12-28 15:38:07,022 -  step: 300  loss: -8.0000  grad_norm:  0.1429  memory: 12.26GiB(25.80%)  tps: 8,636  tflops: 67.52  mfu: 21.64%
[rank3]:2025-12-28 15:38:07,035 -  step: 300  loss:  0.2969  grad_norm:  0.1429  memory: 26.98GiB(56.79%)  tps: 8,637  tflops: 67.52  mfu: 21.64%
[rank1]:2025-12-28 15:38:06,993 - Avg. fwd time: 9.1194 / Avg. bwd time: 21.7920 / Avg. batch time: 481.3029 (ms) / GPU bubble ratio: 48.62%
[rank1]:2025-12-28 15:38:07,026 -  step: 300  loss: -8.0000  grad_norm:  0.1429  memory: 15.15GiB(31.89%)  tps: 8,636  tflops: 67.52  mfu: 21.64%
[rank1]:2025-12-28 15:38:07,085 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1538_stage1_step300.svg
[rank0]:2025-12-28 15:38:07,000 - Avg. fwd time: 8.2759 / Avg. bwd time: 20.1537 / Avg. batch time: 504.7442 (ms) / GPU bubble ratio: 54.94%
[rank0]:2025-12-28 15:38:07,037 -  step: 300  loss: -8.0000  grad_norm:  0.1429  memory: 17.08GiB(35.95%)  tps: 8,636  tflops: 67.52  mfu: 21.64%
[rank0]:2025-12-28 15:38:07,086 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1538_stage0_step300.svg
[rank2]:2025-12-28 15:38:07,085 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1538_stage2_step300.svg
[rank2]:2025-12-28 15:38:07,238 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1538_rank2_stage2.svg
[rank2]:	> Counts Sum: 73760, Total Sum: 529920 (13.92%), Ratio(%) per element: [14.67, 13.58, 13.58, 13.58, 11.95, 15.21, 13.58, 14.67, 15.21, 13.58, 13.04, 14.67, 15.21, 14.13, 15.21, 13.04, 14.13, 14.13, 14.13, 13.58, 14.67, 13.04, 14.13, 13.58, 14.67, 15.21, 13.04, 14.13, 12.5, 13.04, 12.5, 14.67, 14.13, 13.04, 13.58, 14.13]
[rank3]:2025-12-28 15:38:07,186 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1538_step300_rank3.svg
[rank3]:			> Batch Time: 460.75 ms, GPU Bubble Ratio: 54.77%, 48.60%, 55.50%, 35.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  273-25-299ms   | [S0,MB1,B]  308-25-334ms   | [S0,MB2,B]  338-25-364ms   | [S0,MB3,B]  366-25-391ms   | [S0,MB4,B]  395-15-410ms   | [S0,MB5,B]  419-24-444ms   | [S0,MB6,B]  446-0-446ms    | [S0,MB7,B]  460-0-460ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-101ms     | [S1,MB6,F]  110-8-119ms    | [S1,MB7,F]  128-8-137ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  282-22-305ms   | [S1,MB2,B]  308-25-334ms   | [S1,MB3,B]  338-20-359ms   | [S1,MB4,B]  365-26-392ms   | [S1,MB5,B]  395-19-414ms   | [S1,MB6,B]  419-12-432ms   | [S1,MB7,B]  445-11-457ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  107-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-150ms    | [S2,MB0,B]  222-19-242ms   | [S2,MB1,B]  259-19-279ms   | [S2,MB2,B]  284-20-304ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  338-20-358ms   | [S2,MB5,B]  366-20-386ms   | [S2,MB6,B]  395-20-415ms   | [S2,MB7,B]  419-9-428ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  122-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  175-41-216ms   | [S3,MB1,B]  215-37-253ms   | [S3,MB2,B]  253-22-275ms   | [S3,MB3,B]  275-21-297ms   | [S3,MB4,B]  298-22-320ms   | [S3,MB5,B]  320-22-342ms   | [S3,MB6,B]  343-22-365ms   | [S3,MB7,B]  365-22-387ms  
[rank3]:2025-12-28 15:38:07,233 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1538_stage3_step300.svg
[rank1]:2025-12-28 15:38:07,231 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1538_rank1_stage1.svg
[rank1]:	> Counts Sum: 228720, Total Sum: 662400 (34.53%), Ratio(%) per element: [30.97, 33.15, 33.69, 34.23, 34.78, 31.52, 34.23, 34.23, 34.23, 35.32, 32.06, 34.23, 34.23, 35.32, 36.95, 34.78, 35.32, 36.41, 34.78, 30.97, 38.58, 32.06, 34.23, 36.41, 35.32, 33.69, 34.78, 36.41, 33.69, 35.86, 33.15, 34.23, 35.32, 35.86, 37.5, 32.6, 33.69, 38.58, 34.78, 32.6, 34.78, 36.41, 33.15, 32.6, 35.86]
[rank0]:2025-12-28 15:38:07,245 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1538_rank0_stage0.svg
[rank0]:	> Counts Sum: 164720, Total Sum: 544640 (30.24%), Ratio(%) per element: [33.69, 39.67, 36.95, 33.15, 35.86, 37.5, 33.69, 37.5, 33.69, 33.69, 34.78, 34.23, 33.15, 32.6, 32.6, 30.97, 30.43, 32.06, 33.15, 30.97, 27.71, 27.71, 28.26, 29.89, 29.34, 27.17, 26.08, 25.0, 26.63, 28.26, 25.0, 25.0, 27.17, 22.28, 20.1, 21.73, 21.19]
[rank3]:2025-12-28 15:38:07,368 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1538_rank3_stage3.svg
[rank3]:	> Counts Sum: 279440, Total Sum: 426880 (65.46%), Ratio(%) per element: [63.58, 61.95, 61.41, 67.93, 66.3, 69.56, 69.56, 67.39, 65.21, 66.84, 69.02, 70.1, 65.21, 65.21, 66.3, 60.32, 65.76, 64.67, 64.13, 63.58, 67.39, 63.58, 63.58, 66.3, 66.84, 65.21, 60.32, 67.39, 63.58]
[rank2]:2025-12-28 15:38:07,843 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1538_stage2.svg
[rank1]:2025-12-28 15:38:07,816 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1538_stage1.svg
[rank0]:2025-12-28 15:38:07,858 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1538_stage0.svg
[rank3]:2025-12-28 15:38:07,992 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1538_stage3.svg
[rank3]:2025-12-28 15:39:40,769 - Avg. fwd time: 10.7773 / Avg. bwd time: 32.1972 / Avg. batch time: 403.4030 (ms) / GPU bubble ratio: 14.78%
[rank2]:2025-12-28 15:39:40,807 - Avg. fwd time: 6.9702 / Avg. bwd time: 18.5529 / Avg. batch time: 440.5499 (ms) / GPU bubble ratio: 53.65%
[rank1]:2025-12-28 15:39:40,833 - Avg. fwd time: 9.1231 / Avg. bwd time: 21.6756 / Avg. batch time: 477.7142 (ms) / GPU bubble ratio: 48.42%
[rank0]:2025-12-28 15:39:40,841 - Avg. fwd time: 8.2711 / Avg. bwd time: 19.9432 / Avg. batch time: 500.3495 (ms) / GPU bubble ratio: 54.89%
[rank0]:2025-12-28 15:41:12,649 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 15:41:16,327 - Avg. fwd time: 8.2697 / Avg. bwd time: 19.7713 / Avg. batch time: 497.3927 (ms) / GPU bubble ratio: 54.90%
[rank1]:2025-12-28 15:41:16,319 - Avg. fwd time: 9.1254 / Avg. bwd time: 21.5858 / Avg. batch time: 475.4420 (ms) / GPU bubble ratio: 48.32%
[rank2]:2025-12-28 15:41:16,297 - Avg. fwd time: 6.9703 / Avg. bwd time: 18.5574 / Avg. batch time: 438.1782 (ms) / GPU bubble ratio: 53.39%
[rank3]:2025-12-28 15:41:16,259 - Avg. fwd time: 10.7783 / Avg. bwd time: 31.7995 / Avg. batch time: 400.2275 (ms) / GPU bubble ratio: 14.89%
[rank0]:2025-12-28 15:41:16,363 -  step: 350  loss: -8.0000  grad_norm:  0.0856  memory: 17.08GiB(35.95%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank1]:2025-12-28 15:41:16,353 -  step: 350  loss: -8.0000  grad_norm:  0.0856  memory: 15.15GiB(31.89%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank2]:2025-12-28 15:41:16,349 -  step: 350  loss: -8.0000  grad_norm:  0.0856  memory: 12.26GiB(25.80%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank3]:2025-12-28 15:41:16,362 -  step: 350  loss:  0.2323  grad_norm:  0.0856  memory: 26.98GiB(56.79%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank3]:2025-12-28 15:42:51,016 - Avg. fwd time: 10.7783 / Avg. bwd time: 31.4288 / Avg. batch time: 397.2620 (ms) / GPU bubble ratio: 15.00%
[rank2]:2025-12-28 15:42:51,052 - Avg. fwd time: 6.9697 / Avg. bwd time: 18.5601 / Avg. batch time: 435.9346 (ms) / GPU bubble ratio: 53.15%
[rank1]:2025-12-28 15:42:51,080 - Avg. fwd time: 9.1272 / Avg. bwd time: 21.4962 / Avg. batch time: 473.2309 (ms) / GPU bubble ratio: 48.23%
[rank0]:2025-12-28 15:42:51,088 - Avg. fwd time: 8.2671 / Avg. bwd time: 19.6048 / Avg. batch time: 494.5874 (ms) / GPU bubble ratio: 54.92%
[rank0]:2025-12-28 15:44:21,747 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-28 15:44:25,450 - Avg. fwd time: 9.1284 / Avg. bwd time: 21.4295 / Avg. batch time: 471.1846 (ms) / GPU bubble ratio: 48.12%
[rank3]:2025-12-28 15:44:25,385 - Avg. fwd time: 10.7757 / Avg. bwd time: 31.0894 / Avg. batch time: 394.5258 (ms) / GPU bubble ratio: 15.11%
[rank0]:2025-12-28 15:44:25,459 - Avg. fwd time: 8.2640 / Avg. bwd time: 19.4498 / Avg. batch time: 492.0245 (ms) / GPU bubble ratio: 54.94%
[rank2]:2025-12-28 15:44:25,428 - Avg. fwd time: 6.9693 / Avg. bwd time: 18.5615 / Avg. batch time: 433.9062 (ms) / GPU bubble ratio: 52.93%
[rank1]:2025-12-28 15:44:25,485 -  step: 400  loss: -8.0000  grad_norm:  0.1109  memory: 15.15GiB(31.89%)  tps: 8,663  tflops: 67.72  mfu: 21.71%
[rank1]:2025-12-28 15:44:25,549 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1544_stage1_step400.svg
[rank3]:2025-12-28 15:44:25,493 -  step: 400  loss:  0.2142  grad_norm:  0.1109  memory: 26.98GiB(56.79%)  tps: 8,663  tflops: 67.72  mfu: 21.71%
[rank0]:2025-12-28 15:44:25,495 -  step: 400  loss: -8.0000  grad_norm:  0.1109  memory: 17.08GiB(35.95%)  tps: 8,663  tflops: 67.72  mfu: 21.71%
[rank0]:2025-12-28 15:44:25,549 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1544_stage0_step400.svg
[rank2]:2025-12-28 15:44:25,481 -  step: 400  loss: -8.0000  grad_norm:  0.1109  memory: 12.26GiB(25.80%)  tps: 8,663  tflops: 67.72  mfu: 21.71%
[rank2]:2025-12-28 15:44:25,548 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1544_stage2_step400.svg
[rank3]:2025-12-28 15:44:25,633 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1544_step400_rank3.svg
[rank3]:			> Batch Time: 444.00 ms, GPU Bubble Ratio: 54.94%, 47.24%, 53.91%, 35.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  299-25-325ms   | [S0,MB2,B]  328-25-354ms   | [S0,MB3,B]  356-25-381ms   | [S0,MB4,B]  385-13-398ms   | [S0,MB5,B]  408-18-426ms   | [S0,MB6,B]  428-0-428ms    | [S0,MB7,B]  444-0-444ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  272-21-294ms   | [S1,MB2,B]  299-25-325ms   | [S1,MB3,B]  328-19-347ms   | [S1,MB4,B]  355-25-381ms   | [S1,MB5,B]  385-19-404ms   | [S1,MB6,B]  408-11-420ms   | [S1,MB7,B]  428-11-440ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  249-19-268ms   | [S2,MB2,B]  274-20-294ms   | [S2,MB3,B]  299-20-319ms   | [S2,MB4,B]  328-20-348ms   | [S2,MB5,B]  356-20-376ms   | [S2,MB6,B]  385-20-405ms   | [S2,MB7,B]  408-8-417ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-28-242ms   | [S3,MB2,B]  242-22-264ms   | [S3,MB3,B]  264-22-286ms   | [S3,MB4,B]  286-22-309ms   | [S3,MB5,B]  309-22-331ms   | [S3,MB6,B]  331-22-354ms   | [S3,MB7,B]  353-21-375ms  
[rank1]:2025-12-28 15:44:25,699 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1544_rank1_stage1.svg
[rank1]:	> Counts Sum: 342320, Total Sum: 950400 (36.02%), Ratio(%) per element: [34.84, 35.6, 36.74, 35.6, 35.6, 34.09, 35.6, 35.22, 37.12, 36.74, 31.43, 35.6, 37.12, 37.12, 36.36, 35.98, 37.12, 37.12, 35.6, 33.71, 38.25, 34.09, 35.98, 36.36, 36.36, 34.46, 35.98, 36.36, 34.09, 37.87, 34.46, 35.98, 38.25, 37.5, 36.74, 35.22, 34.09, 40.53, 37.5, 36.36, 36.36, 38.63, 35.22, 34.84, 34.84]
[rank0]:2025-12-28 15:44:25,706 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1544_rank0_stage0.svg
[rank3]:2025-12-28 15:44:25,681 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1544_stage3_step400.svg
[rank2]:2025-12-28 15:44:25,703 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1544_rank2_stage2.svg
[rank0]:	> Counts Sum: 244720, Total Sum: 781440 (31.32%), Ratio(%) per element: [35.6, 39.01, 37.5, 35.6, 35.6, 38.25, 35.22, 37.87, 34.46, 33.71, 34.84, 35.22, 34.09, 33.33, 32.95, 31.43, 32.57, 32.19, 33.33, 32.19, 29.54, 30.3, 29.54, 31.43, 30.68, 28.78, 28.03, 26.89, 27.65, 28.03, 26.51, 26.13, 28.4, 23.86, 21.96, 23.1, 22.72]
[rank2]:	> Counts Sum: 102560, Total Sum: 760320 (13.49%), Ratio(%) per element: [14.01, 13.25, 13.25, 13.25, 12.12, 14.39, 13.25, 14.01, 14.39, 13.25, 12.87, 14.01, 14.39, 13.63, 14.39, 12.87, 13.63, 13.63, 13.63, 13.25, 14.01, 12.87, 13.63, 13.25, 14.01, 14.39, 12.87, 13.63, 12.5, 12.87, 12.5, 14.01, 13.63, 12.87, 13.25, 13.63]
[rank3]:2025-12-28 15:44:25,814 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1544_rank3_stage3.svg
[rank3]:	> Counts Sum: 428240, Total Sum: 612480 (69.92%), Ratio(%) per element: [69.31, 67.42, 67.04, 72.34, 70.83, 72.34, 72.72, 72.34, 69.69, 71.21, 71.96, 73.86, 69.69, 69.31, 70.07, 65.9, 71.59, 69.69, 69.69, 68.18, 70.45, 67.8, 68.56, 70.07, 71.21, 69.69, 65.53, 70.07, 68.93]
[rank1]:2025-12-28 15:44:26,545 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1544_stage1.svg
[rank0]:2025-12-28 15:44:26,576 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1544_stage0.svg
[rank2]:2025-12-28 15:44:26,573 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1544_stage2.svg
[rank3]:2025-12-28 15:44:26,683 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1544_stage3.svg
[rank3]:2025-12-28 15:44:47,722 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 15:44:47,942 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 15:44:47,928 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 15:44:47,944 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-28 15:45:59,974 - Avg. fwd time: 10.7705 / Avg. bwd time: 30.7725 / Avg. batch time: 391.9527 (ms) / GPU bubble ratio: 15.21%
[rank1]:2025-12-28 15:46:00,040 - Avg. fwd time: 9.1281 / Avg. bwd time: 21.3661 / Avg. batch time: 469.1487 (ms) / GPU bubble ratio: 48.00%
[rank2]:2025-12-28 15:46:00,015 - Avg. fwd time: 6.9685 / Avg. bwd time: 18.5615 / Avg. batch time: 431.9615 (ms) / GPU bubble ratio: 52.72%
[rank0]:2025-12-28 15:46:00,050 - Avg. fwd time: 8.2609 / Avg. bwd time: 19.3206 / Avg. batch time: 489.5337 (ms) / GPU bubble ratio: 54.93%
[rank0]:2025-12-28 15:47:30,834 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 15:47:34,510 - Avg. fwd time: 6.9670 / Avg. bwd time: 18.5596 / Avg. batch time: 430.3460 (ms) / GPU bubble ratio: 52.55%
[rank3]:2025-12-28 15:47:34,466 - Avg. fwd time: 10.7657 / Avg. bwd time: 30.5022 / Avg. batch time: 389.7560 (ms) / GPU bubble ratio: 15.29%
[rank1]:2025-12-28 15:47:34,536 - Avg. fwd time: 9.1265 / Avg. bwd time: 21.3117 / Avg. batch time: 467.6389 (ms) / GPU bubble ratio: 47.93%
[rank1]:2025-12-28 15:47:34,571 -  step: 450  loss: -8.0000  grad_norm:  0.0997  memory: 15.15GiB(31.89%)  tps: 8,665  tflops: 67.74  mfu: 21.71%
[rank0]:2025-12-28 15:47:34,545 - Avg. fwd time: 8.2578 / Avg. bwd time: 19.2476 / Avg. batch time: 487.6135 (ms) / GPU bubble ratio: 54.87%
[rank0]:2025-12-28 15:47:34,581 -  step: 450  loss: -8.0000  grad_norm:  0.0997  memory: 17.08GiB(35.95%)  tps: 8,665  tflops: 67.74  mfu: 21.71%
[rank2]:2025-12-28 15:47:34,567 -  step: 450  loss: -8.0000  grad_norm:  0.0997  memory: 12.26GiB(25.80%)  tps: 8,665  tflops: 67.74  mfu: 21.71%
[rank3]:2025-12-28 15:47:34,580 -  step: 450  loss:  0.2256  grad_norm:  0.0997  memory: 26.98GiB(56.79%)  tps: 8,665  tflops: 67.74  mfu: 21.71%
[rank1]:2025-12-28 15:49:07,925 - Avg. fwd time: 9.1239 / Avg. bwd time: 21.2309 / Avg. batch time: 465.9582 (ms) / GPU bubble ratio: 47.88%
[rank3]:2025-12-28 15:49:07,857 - Avg. fwd time: 10.7606 / Avg. bwd time: 30.2541 / Avg. batch time: 387.7262 (ms) / GPU bubble ratio: 15.37%
[rank0]:2025-12-28 15:49:07,934 - Avg. fwd time: 8.2550 / Avg. bwd time: 19.1556 / Avg. batch time: 485.5643 (ms) / GPU bubble ratio: 54.84%
[rank2]:2025-12-28 15:49:07,902 - Avg. fwd time: 6.9657 / Avg. bwd time: 18.5582 / Avg. batch time: 428.7241 (ms) / GPU bubble ratio: 52.37%
[rank0]:2025-12-28 15:50:39,014 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 15:50:42,649 - Avg. fwd time: 10.7568 / Avg. bwd time: 30.0590 / Avg. batch time: 386.1319 (ms) / GPU bubble ratio: 15.44%
[rank1]:2025-12-28 15:50:42,710 - Avg. fwd time: 9.1218 / Avg. bwd time: 21.1722 / Avg. batch time: 464.8035 (ms) / GPU bubble ratio: 47.86%
[rank0]:2025-12-28 15:50:42,719 - Avg. fwd time: 8.2523 / Avg. bwd time: 19.0734 / Avg. batch time: 484.0774 (ms) / GPU bubble ratio: 54.84%
[rank0]:2025-12-28 15:50:42,755 -  step: 500  loss: -8.0000  grad_norm:  0.1077  memory: 17.08GiB(35.95%)  tps: 8,707  tflops: 68.07  mfu: 21.82%
[rank1]:2025-12-28 15:50:42,745 -  step: 500  loss: -8.0000  grad_norm:  0.1077  memory: 15.15GiB(31.89%)  tps: 8,707  tflops: 68.07  mfu: 21.82%
[rank2]:2025-12-28 15:50:42,685 - Avg. fwd time: 6.9648 / Avg. bwd time: 18.5566 / Avg. batch time: 427.5014 (ms) / GPU bubble ratio: 52.24%
[rank2]:2025-12-28 15:50:42,741 -  step: 500  loss: -8.0000  grad_norm:  0.1077  memory: 12.26GiB(25.80%)  tps: 8,707  tflops: 68.07  mfu: 21.82%
[rank3]:2025-12-28 15:50:42,754 -  step: 500  loss:  0.2175  grad_norm:  0.1077  memory: 26.98GiB(56.79%)  tps: 8,707  tflops: 68.07  mfu: 21.82%
[rank0]:2025-12-28 15:50:42,804 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1550_stage0_step500.svg
[rank1]:2025-12-28 15:50:42,806 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1550_stage1_step500.svg
[rank2]:2025-12-28 15:50:42,806 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1550_stage2_step500.svg
[rank0]:2025-12-28 15:50:42,960 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1550_rank0_stage0.svg
[rank0]:	> Counts Sum: 324720, Total Sum: 1018240 (31.89%), Ratio(%) per element: [36.04, 37.79, 38.37, 36.33, 35.75, 37.79, 36.33, 37.2, 34.88, 34.01, 35.75, 34.59, 34.01, 33.43, 33.13, 32.55, 32.84, 33.43, 34.3, 32.55, 30.81, 31.39, 29.94, 31.1, 30.52, 28.77, 29.36, 29.06, 28.77, 28.77, 27.03, 26.74, 28.48, 25.29, 22.96, 25.29, 24.41]
[rank1]:2025-12-28 15:50:42,954 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1550_rank1_stage1.svg
[rank2]:2025-12-28 15:50:42,961 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1550_rank2_stage2.svg
[rank1]:	> Counts Sum: 455920, Total Sum: 1238400 (36.82%), Ratio(%) per element: [35.46, 36.33, 38.08, 37.5, 36.33, 35.46, 36.62, 36.33, 37.5, 36.91, 33.72, 37.5, 36.91, 38.08, 37.5, 37.5, 37.2, 37.5, 38.08, 34.01, 38.95, 34.3, 36.62, 37.2, 37.2, 34.88, 36.04, 37.79, 34.88, 37.79, 35.46, 36.33, 37.79, 37.79, 37.2, 36.62, 34.3, 41.27, 38.37, 37.2, 39.24, 38.95, 35.46, 34.88, 35.46]
[rank2]:	> Counts Sum: 131360, Total Sum: 990720 (13.26%), Ratio(%) per element: [13.66, 13.08, 13.08, 13.08, 12.2, 13.95, 13.08, 13.66, 13.95, 13.08, 12.79, 13.66, 13.95, 13.37, 13.95, 12.79, 13.37, 13.37, 13.37, 13.08, 13.66, 12.79, 13.37, 13.08, 13.66, 13.95, 12.79, 13.37, 12.5, 12.79, 12.5, 13.66, 13.37, 12.79, 13.08, 13.37]
[rank3]:2025-12-28 15:50:42,899 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1550_step500_rank3.svg
[rank3]:			> Batch Time: 458.00 ms, GPU Bubble Ratio: 54.53%, 48.98%, 55.41%, 35.03%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  309-25-334ms   | [S0,MB2,B]  337-25-363ms   | [S0,MB3,B]  365-25-390ms   | [S0,MB4,B]  394-15-409ms   | [S0,MB5,B]  416-24-441ms   | [S0,MB6,B]  443-0-443ms    | [S0,MB7,B]  458-0-458ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-25-268ms   | [S1,MB1,B]  282-23-306ms   | [S1,MB2,B]  309-25-334ms   | [S1,MB3,B]  337-18-356ms   | [S1,MB4,B]  365-26-391ms   | [S1,MB5,B]  394-18-412ms   | [S1,MB6,B]  417-11-429ms   | [S1,MB7,B]  443-11-454ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  283-19-303ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  337-20-358ms   | [S2,MB5,B]  366-20-386ms   | [S2,MB6,B]  394-20-414ms   | [S2,MB7,B]  417-8-426ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-37-251ms   | [S3,MB2,B]  251-22-274ms   | [S3,MB3,B]  274-21-296ms   | [S3,MB4,B]  296-22-318ms   | [S3,MB5,B]  318-22-341ms   | [S3,MB6,B]  341-22-363ms   | [S3,MB7,B]  363-21-385ms  
[rank3]:2025-12-28 15:50:42,942 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1550_stage3_step500.svg
[rank3]:2025-12-28 15:50:43,079 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1550_rank3_stage3.svg
[rank3]:	> Counts Sum: 577040, Total Sum: 798080 (72.30%), Ratio(%) per element: [72.09, 70.63, 70.34, 74.41, 72.67, 74.7, 73.54, 74.41, 72.09, 73.54, 74.7, 74.41, 72.38, 72.09, 72.09, 69.47, 73.25, 71.8, 71.51, 70.63, 72.38, 70.93, 71.22, 71.51, 72.96, 72.38, 70.05, 72.67, 71.8]
[rank1]:2025-12-28 15:50:44,058 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1550_stage1.svg
[rank0]:2025-12-28 15:50:44,085 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1550_stage0.svg
[rank2]:2025-12-28 15:50:44,108 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1550_stage2.svg
[rank3]:2025-12-28 15:50:44,211 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1550_stage3.svg
[rank2]:2025-12-28 15:52:18,274 - Avg. fwd time: 6.9643 / Avg. bwd time: 18.5556 / Avg. batch time: 426.3187 (ms) / GPU bubble ratio: 52.11%
[rank3]:2025-12-28 15:52:18,239 - Avg. fwd time: 10.7538 / Avg. bwd time: 29.8697 / Avg. batch time: 384.5911 (ms) / GPU bubble ratio: 15.50%
[rank1]:2025-12-28 15:52:18,302 - Avg. fwd time: 9.1211 / Avg. bwd time: 21.1202 / Avg. batch time: 463.6577 (ms) / GPU bubble ratio: 47.82%
[rank0]:2025-12-28 15:52:18,313 - Avg. fwd time: 8.2507 / Avg. bwd time: 19.0052 / Avg. batch time: 482.6311 (ms) / GPU bubble ratio: 54.82%
[rank0]:2025-12-28 15:53:48,379 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 15:53:52,077 - Avg. fwd time: 6.9643 / Avg. bwd time: 18.5555 / Avg. batch time: 425.0812 (ms) / GPU bubble ratio: 51.97%
[rank1]:2025-12-28 15:53:52,101 - Avg. fwd time: 9.1219 / Avg. bwd time: 21.0912 / Avg. batch time: 462.4950 (ms) / GPU bubble ratio: 47.74%
[rank0]:2025-12-28 15:53:52,112 - Avg. fwd time: 8.2499 / Avg. bwd time: 18.9313 / Avg. batch time: 481.1976 (ms) / GPU bubble ratio: 54.81%
[rank3]:2025-12-28 15:53:52,042 - Avg. fwd time: 10.7525 / Avg. bwd time: 29.6675 / Avg. batch time: 382.9598 (ms) / GPU bubble ratio: 15.56%
[rank2]:2025-12-28 15:53:52,133 -  step: 550  loss: -8.0000  grad_norm:  0.0916  memory: 12.26GiB(25.80%)  tps: 8,651  tflops: 67.63  mfu: 21.68%
[rank1]:2025-12-28 15:53:52,137 -  step: 550  loss: -8.0000  grad_norm:  0.0916  memory: 15.15GiB(31.89%)  tps: 8,651  tflops: 67.63  mfu: 21.68%
[rank0]:2025-12-28 15:53:52,148 -  step: 550  loss: -8.0000  grad_norm:  0.0916  memory: 17.08GiB(35.95%)  tps: 8,651  tflops: 67.63  mfu: 21.68%
[rank3]:2025-12-28 15:53:52,146 -  step: 550  loss:  0.2247  grad_norm:  0.0916  memory: 26.98GiB(56.79%)  tps: 8,651  tflops: 67.63  mfu: 21.68%
[rank0]:2025-12-28 15:55:26,047 - Avg. fwd time: 8.2489 / Avg. bwd time: 18.8814 / Avg. batch time: 479.8963 (ms) / GPU bubble ratio: 54.77%
[rank2]:2025-12-28 15:55:26,010 - Avg. fwd time: 6.9645 / Avg. bwd time: 18.5551 / Avg. batch time: 423.9781 (ms) / GPU bubble ratio: 51.85%
[rank1]:2025-12-28 15:55:26,036 - Avg. fwd time: 9.1226 / Avg. bwd time: 21.0535 / Avg. batch time: 461.4402 (ms) / GPU bubble ratio: 47.68%
[rank3]:2025-12-28 15:55:25,967 - Avg. fwd time: 10.7518 / Avg. bwd time: 29.4884 / Avg. batch time: 381.5199 (ms) / GPU bubble ratio: 15.62%
[rank0]:2025-12-28 15:56:56,800 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 15:57:00,451 - Avg. fwd time: 10.7509 / Avg. bwd time: 29.3480 / Avg. batch time: 380.3874 (ms) / GPU bubble ratio: 15.67%
[rank0]:2025-12-28 15:57:00,519 - Avg. fwd time: 8.2480 / Avg. bwd time: 18.8263 / Avg. batch time: 478.8223 (ms) / GPU bubble ratio: 54.77%
[rank0]:2025-12-28 15:57:00,555 -  step: 600  loss: -8.0000  grad_norm:  0.1097  memory: 17.08GiB(35.95%)  tps: 8,696  tflops: 67.98  mfu: 21.79%
[rank3]:2025-12-28 15:57:00,553 -  step: 600  loss:  0.2202  grad_norm:  0.1097  memory: 26.98GiB(56.79%)  tps: 8,696  tflops: 67.98  mfu: 21.79%
[rank1]:2025-12-28 15:57:00,508 - Avg. fwd time: 9.1234 / Avg. bwd time: 21.0225 / Avg. batch time: 460.5919 (ms) / GPU bubble ratio: 47.64%
[rank1]:2025-12-28 15:57:00,544 -  step: 600  loss: -8.0000  grad_norm:  0.1097  memory: 15.15GiB(31.89%)  tps: 8,696  tflops: 67.98  mfu: 21.79%
[rank2]:2025-12-28 15:57:00,485 - Avg. fwd time: 6.9645 / Avg. bwd time: 18.5542 / Avg. batch time: 423.1038 (ms) / GPU bubble ratio: 51.75%
[rank2]:2025-12-28 15:57:00,541 -  step: 600  loss: -8.0000  grad_norm:  0.1097  memory: 12.26GiB(25.80%)  tps: 8,696  tflops: 67.98  mfu: 21.79%
[rank0]:2025-12-28 15:57:00,605 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1557_stage0_step600.svg
[rank1]:2025-12-28 15:57:00,607 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1557_stage1_step600.svg
[rank2]:2025-12-28 15:57:00,607 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1557_stage2_step600.svg
[rank0]:2025-12-28 15:57:00,759 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1557_rank0_stage0.svg
[rank0]:	> Counts Sum: 404720, Total Sum: 1255040 (32.25%), Ratio(%) per element: [35.84, 36.55, 37.97, 37.02, 36.08, 37.5, 36.79, 37.73, 35.37, 35.14, 34.66, 34.66, 35.14, 34.19, 33.72, 32.78, 33.72, 33.25, 34.9, 33.25, 31.6, 31.83, 29.71, 31.36, 31.13, 29.95, 29.71, 29.48, 29.24, 28.53, 27.83, 27.12, 28.77, 25.47, 23.82, 25.94, 25.23]
[rank3]:2025-12-28 15:57:00,692 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1557_step600_rank3.svg
[rank3]:			> Batch Time: 448.25 ms, GPU Bubble Ratio: 53.79%, 47.20%, 54.46%, 35.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  299-25-324ms   | [S0,MB2,B]  328-25-353ms   | [S0,MB3,B]  355-25-381ms   | [S0,MB4,B]  386-14-400ms   | [S0,MB5,B]  408-23-432ms   | [S0,MB6,B]  433-0-433ms    | [S0,MB7,B]  448-0-448ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  272-22-294ms   | [S1,MB2,B]  299-25-324ms   | [S1,MB3,B]  328-21-349ms   | [S1,MB4,B]  355-26-381ms   | [S1,MB5,B]  385-19-404ms   | [S1,MB6,B]  409-12-421ms   | [S1,MB7,B]  433-11-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  248-19-268ms   | [S2,MB2,B]  273-19-293ms   | [S2,MB3,B]  299-20-319ms   | [S2,MB4,B]  328-20-348ms   | [S2,MB5,B]  356-20-377ms   | [S2,MB6,B]  385-20-405ms   | [S2,MB7,B]  409-8-418ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-27-242ms   | [S3,MB2,B]  241-22-264ms   | [S3,MB3,B]  263-22-286ms   | [S3,MB4,B]  285-22-308ms   | [S3,MB5,B]  308-22-330ms   | [S3,MB6,B]  330-22-353ms   | [S3,MB7,B]  352-21-374ms  
[rank3]:2025-12-28 15:57:00,737 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1557_stage3_step600.svg
[rank1]:2025-12-28 15:57:00,758 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1557_rank1_stage1.svg
[rank1]:	> Counts Sum: 569520, Total Sum: 1526400 (37.31%), Ratio(%) per element: [35.84, 37.26, 37.26, 37.02, 36.79, 36.32, 36.79, 36.32, 38.2, 37.5, 35.84, 37.73, 37.97, 39.38, 38.2, 38.2, 38.67, 37.73, 38.67, 35.61, 38.44, 35.61, 37.02, 37.5, 37.73, 36.08, 36.79, 37.97, 35.14, 38.2, 36.79, 37.73, 37.02, 37.26, 36.79, 36.55, 35.37, 41.03, 39.38, 37.26, 39.15, 39.38, 36.32, 34.66, 36.32]
[rank2]:2025-12-28 15:57:00,765 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1557_rank2_stage2.svg
[rank2]:	> Counts Sum: 160160, Total Sum: 1221120 (13.12%), Ratio(%) per element: [13.44, 12.97, 12.97, 12.97, 12.26, 13.67, 12.97, 13.44, 13.67, 12.97, 12.73, 13.44, 13.67, 13.2, 13.67, 12.73, 13.2, 13.2, 13.2, 12.97, 13.44, 12.73, 13.2, 12.97, 13.44, 13.67, 12.73, 13.2, 12.5, 12.73, 12.5, 13.44, 13.2, 12.73, 12.97, 13.2]
[rank3]:2025-12-28 15:57:00,869 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1557_rank3_stage3.svg
[rank3]:	> Counts Sum: 725840, Total Sum: 983680 (73.79%), Ratio(%) per element: [73.58, 73.34, 71.93, 74.76, 73.58, 75.23, 74.76, 75.23, 73.82, 75.0, 76.41, 75.47, 74.52, 73.34, 73.58, 71.46, 74.76, 73.11, 73.34, 72.16, 74.05, 72.4, 73.11, 73.11, 73.82, 73.82, 71.69, 74.52, 73.82]
[rank0]:2025-12-28 15:57:02,161 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1557_stage0.svg
[rank1]:2025-12-28 15:57:02,104 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1557_stage1.svg
[rank2]:2025-12-28 15:57:02,162 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1557_stage2.svg
[rank3]:2025-12-28 15:57:02,256 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1557_stage3.svg
[rank3]:2025-12-28 15:58:36,313 - Avg. fwd time: 10.7499 / Avg. bwd time: 29.2189 / Avg. batch time: 379.3449 (ms) / GPU bubble ratio: 15.71%
[rank0]:2025-12-28 15:58:36,393 - Avg. fwd time: 8.2475 / Avg. bwd time: 18.7705 / Avg. batch time: 477.8148 (ms) / GPU bubble ratio: 54.76%
[rank1]:2025-12-28 15:58:36,382 - Avg. fwd time: 9.1238 / Avg. bwd time: 21.0006 / Avg. batch time: 459.7932 (ms) / GPU bubble ratio: 47.59%
[rank2]:2025-12-28 15:58:36,356 - Avg. fwd time: 6.9644 / Avg. bwd time: 18.5536 / Avg. batch time: 422.3201 (ms) / GPU bubble ratio: 51.66%
[rank0]:2025-12-28 16:00:06,981 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 16:00:10,717 - Avg. fwd time: 8.2466 / Avg. bwd time: 18.7152 / Avg. batch time: 476.8587 (ms) / GPU bubble ratio: 54.77%
[rank1]:2025-12-28 16:00:10,706 - Avg. fwd time: 9.1238 / Avg. bwd time: 20.9746 / Avg. batch time: 459.0270 (ms) / GPU bubble ratio: 47.54%
[rank3]:2025-12-28 16:00:10,633 - Avg. fwd time: 10.7488 / Avg. bwd time: 29.0925 / Avg. batch time: 378.3256 (ms) / GPU bubble ratio: 15.75%
[rank2]:2025-12-28 16:00:10,682 - Avg. fwd time: 6.9644 / Avg. bwd time: 18.5530 / Avg. batch time: 421.5387 (ms) / GPU bubble ratio: 51.57%
[rank0]:2025-12-28 16:00:10,753 -  step: 650  loss: -8.0000  grad_norm:  0.0910  memory: 17.08GiB(35.95%)  tps: 8,614  tflops: 67.34  mfu: 21.58%
[rank1]:2025-12-28 16:00:10,743 -  step: 650  loss: -8.0000  grad_norm:  0.0910  memory: 15.15GiB(31.89%)  tps: 8,614  tflops: 67.34  mfu: 21.58%
[rank3]:2025-12-28 16:00:10,752 -  step: 650  loss:  0.2303  grad_norm:  0.0910  memory: 26.98GiB(56.79%)  tps: 8,614  tflops: 67.34  mfu: 21.58%
[rank2]:2025-12-28 16:00:10,739 -  step: 650  loss: -8.0000  grad_norm:  0.0910  memory: 12.26GiB(25.80%)  tps: 8,614  tflops: 67.34  mfu: 21.58%
[rank3]:2025-12-28 16:01:45,320 - Avg. fwd time: 10.7475 / Avg. bwd time: 28.9804 / Avg. batch time: 377.4221 (ms) / GPU bubble ratio: 15.79%
[rank2]:2025-12-28 16:01:45,356 - Avg. fwd time: 6.9639 / Avg. bwd time: 18.5513 / Avg. batch time: 420.8938 (ms) / GPU bubble ratio: 51.50%
[rank0]:2025-12-28 16:01:45,393 - Avg. fwd time: 8.2466 / Avg. bwd time: 18.6575 / Avg. batch time: 476.0321 (ms) / GPU bubble ratio: 54.79%
[rank1]:2025-12-28 16:01:45,381 - Avg. fwd time: 9.1234 / Avg. bwd time: 20.9551 / Avg. batch time: 458.3741 (ms) / GPU bubble ratio: 47.50%
[rank0]:2025-12-28 16:03:15,949 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:03:19,670 - Avg. fwd time: 10.7458 / Avg. bwd time: 28.8710 / Avg. batch time: 376.5366 (ms) / GPU bubble ratio: 15.83%
[rank0]:2025-12-28 16:03:19,746 - Avg. fwd time: 8.2441 / Avg. bwd time: 18.6135 / Avg. batch time: 475.2380 (ms) / GPU bubble ratio: 54.79%
[rank2]:2025-12-28 16:03:19,707 - Avg. fwd time: 6.9634 / Avg. bwd time: 18.5492 / Avg. batch time: 420.2105 (ms) / GPU bubble ratio: 51.43%
[rank2]:2025-12-28 16:03:19,768 -  step: 700  loss: -8.0000  grad_norm:  0.0797  memory: 12.26GiB(25.80%)  tps: 8,667  tflops: 67.76  mfu: 21.72%
[rank1]:2025-12-28 16:03:19,734 - Avg. fwd time: 9.1226 / Avg. bwd time: 20.9344 / Avg. batch time: 457.7449 (ms) / GPU bubble ratio: 47.47%
[rank1]:2025-12-28 16:03:19,771 -  step: 700  loss: -8.0000  grad_norm:  0.0797  memory: 15.15GiB(31.89%)  tps: 8,667  tflops: 67.76  mfu: 21.72%
[rank0]:2025-12-28 16:03:19,782 -  step: 700  loss: -8.0000  grad_norm:  0.0797  memory: 17.08GiB(35.95%)  tps: 8,667  tflops: 67.76  mfu: 21.72%
[rank0]:2025-12-28 16:03:19,833 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1603_stage0_step700.svg
[rank3]:2025-12-28 16:03:19,780 -  step: 700  loss:  0.1896  grad_norm:  0.0797  memory: 26.98GiB(56.79%)  tps: 8,668  tflops: 67.76  mfu: 21.72%
[rank2]:2025-12-28 16:03:19,834 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1603_stage2_step700.svg
[rank1]:2025-12-28 16:03:19,834 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1603_stage1_step700.svg
[rank3]:2025-12-28 16:03:19,921 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1603_step700_rank3.svg
[rank3]:			> Batch Time: 450.50 ms, GPU Bubble Ratio: 54.12%, 47.54%, 54.72%, 36.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  271-25-297ms   | [S0,MB1,B]  300-25-325ms   | [S0,MB2,B]  329-25-354ms   | [S0,MB3,B]  356-25-382ms   | [S0,MB4,B]  386-14-400ms   | [S0,MB5,B]  409-24-434ms   | [S0,MB6,B]  435-0-435ms    | [S0,MB7,B]  450-0-450ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-25-268ms   | [S1,MB1,B]  272-22-295ms   | [S1,MB2,B]  299-25-325ms   | [S1,MB3,B]  329-20-349ms   | [S1,MB4,B]  356-26-382ms   | [S1,MB5,B]  386-19-405ms   | [S1,MB6,B]  409-11-421ms   | [S1,MB7,B]  435-11-446ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  249-19-269ms   | [S2,MB2,B]  274-19-294ms   | [S2,MB3,B]  299-20-319ms   | [S2,MB4,B]  328-20-349ms   | [S2,MB5,B]  357-20-377ms   | [S2,MB6,B]  385-20-405ms   | [S2,MB7,B]  409-8-418ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-167ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  213-28-242ms   | [S3,MB2,B]  242-22-264ms   | [S3,MB3,B]  265-21-287ms   | [S3,MB4,B]  287-22-309ms   | [S3,MB5,B]  309-22-332ms   | [S3,MB6,B]  332-22-354ms   | [S3,MB7,B]  355-21-377ms  
[rank3]:2025-12-28 16:03:19,967 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1603_stage3_step700.svg
[rank0]:2025-12-28 16:03:19,990 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1603_rank0_stage0.svg
[rank0]:	> Counts Sum: 484720, Total Sum: 1491840 (32.49%), Ratio(%) per element: [36.3, 37.3, 37.5, 36.9, 36.3, 37.69, 36.9, 38.09, 35.71, 35.11, 34.92, 35.11, 35.11, 34.72, 34.12, 33.73, 33.92, 32.93, 34.72, 33.13, 32.14, 32.34, 30.15, 31.74, 31.34, 30.55, 29.76, 29.76, 29.16, 27.97, 27.77, 27.77, 28.76, 25.99, 24.6, 26.38, 25.59]
[rank2]:2025-12-28 16:03:19,988 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1603_rank2_stage2.svg
[rank2]:	> Counts Sum: 188960, Total Sum: 1451520 (13.02%), Ratio(%) per element: [13.29, 12.89, 12.89, 12.89, 12.3, 13.49, 12.89, 13.29, 13.49, 12.89, 12.69, 13.29, 13.49, 13.09, 13.49, 12.69, 13.09, 13.09, 13.09, 12.89, 13.29, 12.69, 13.09, 12.89, 13.29, 13.49, 12.69, 13.09, 12.5, 12.69, 12.5, 13.29, 13.09, 12.69, 12.89, 13.09]
[rank1]:2025-12-28 16:03:19,981 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1603_rank1_stage1.svg
[rank1]:	> Counts Sum: 683120, Total Sum: 1814400 (37.65%), Ratio(%) per element: [36.9, 37.69, 37.3, 38.49, 37.69, 36.7, 35.91, 36.9, 37.89, 37.1, 36.11, 37.89, 38.29, 38.88, 38.88, 37.69, 38.09, 38.29, 38.88, 36.5, 38.69, 36.3, 37.69, 38.09, 37.89, 36.11, 37.3, 38.29, 36.5, 38.49, 37.69, 37.89, 37.89, 37.1, 37.5, 38.09, 35.91, 41.07, 39.28, 37.89, 39.48, 37.89, 36.7, 35.31, 36.9]
[rank3]:2025-12-28 16:03:20,102 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1603_rank3_stage3.svg
[rank3]:	> Counts Sum: 874640, Total Sum: 1169280 (74.80%), Ratio(%) per element: [75.59, 74.4, 73.41, 75.79, 74.6, 76.19, 75.39, 75.79, 75.19, 75.99, 76.78, 75.79, 75.59, 74.6, 74.8, 73.21, 75.39, 73.61, 74.6, 73.41, 74.4, 73.21, 74.2, 74.4, 75.0, 74.6, 73.01, 75.39, 74.8]
[rank1]:2025-12-28 16:03:21,574 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1603_stage1.svg
[rank0]:2025-12-28 16:03:21,649 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1603_stage0.svg
[rank2]:2025-12-28 16:03:21,635 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1603_stage2.svg
[rank3]:2025-12-28 16:03:21,762 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1603_stage3.svg
[rank0]:2025-12-28 16:04:55,783 - Avg. fwd time: 8.2415 / Avg. bwd time: 18.5729 / Avg. batch time: 474.4752 (ms) / GPU bubble ratio: 54.79%
[rank3]:2025-12-28 16:04:55,711 - Avg. fwd time: 10.7436 / Avg. bwd time: 28.7722 / Avg. batch time: 375.7268 (ms) / GPU bubble ratio: 15.86%
[rank2]:2025-12-28 16:04:55,747 - Avg. fwd time: 6.9628 / Avg. bwd time: 18.5471 / Avg. batch time: 419.5980 (ms) / GPU bubble ratio: 51.36%
[rank1]:2025-12-28 16:04:55,771 - Avg. fwd time: 9.1219 / Avg. bwd time: 20.9157 / Avg. batch time: 457.1376 (ms) / GPU bubble ratio: 47.43%
[rank0]:2025-12-28 16:06:26,804 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 16:06:30,557 - Avg. fwd time: 10.7427 / Avg. bwd time: 28.7032 / Avg. batch time: 375.1660 (ms) / GPU bubble ratio: 15.89%
[rank2]:2025-12-28 16:06:30,593 - Avg. fwd time: 6.9626 / Avg. bwd time: 18.5456 / Avg. batch time: 419.1383 (ms) / GPU bubble ratio: 51.31%
[rank1]:2025-12-28 16:06:30,620 - Avg. fwd time: 9.1215 / Avg. bwd time: 20.8838 / Avg. batch time: 456.6714 (ms) / GPU bubble ratio: 47.44%
[rank3]:2025-12-28 16:06:30,668 -  step: 750  loss:  0.2293  grad_norm:  0.1184  memory: 26.98GiB(56.79%)  tps: 8,583  tflops: 67.10  mfu: 21.51%
[rank2]:2025-12-28 16:06:30,654 -  step: 750  loss: -8.0000  grad_norm:  0.1184  memory: 12.26GiB(25.80%)  tps: 8,583  tflops: 67.10  mfu: 21.51%
[rank0]:2025-12-28 16:06:30,633 - Avg. fwd time: 8.2397 / Avg. bwd time: 18.5389 / Avg. batch time: 473.8643 (ms) / GPU bubble ratio: 54.79%
[rank0]:2025-12-28 16:06:30,669 -  step: 750  loss: -8.0000  grad_norm:  0.1184  memory: 17.08GiB(35.95%)  tps: 8,583  tflops: 67.10  mfu: 21.51%
[rank1]:2025-12-28 16:06:30,658 -  step: 750  loss: -8.0000  grad_norm:  0.1184  memory: 15.15GiB(31.89%)  tps: 8,583  tflops: 67.10  mfu: 21.51%
[rank2]:2025-12-28 16:08:04,347 - Avg. fwd time: 6.9626 / Avg. bwd time: 18.5450 / Avg. batch time: 418.5212 (ms) / GPU bubble ratio: 51.24%
[rank3]:2025-12-28 16:08:04,315 - Avg. fwd time: 10.7421 / Avg. bwd time: 28.6087 / Avg. batch time: 374.4026 (ms) / GPU bubble ratio: 15.92%
[rank0]:2025-12-28 16:08:04,385 - Avg. fwd time: 8.2382 / Avg. bwd time: 18.5148 / Avg. batch time: 473.1106 (ms) / GPU bubble ratio: 54.76%
[rank1]:2025-12-28 16:08:04,372 - Avg. fwd time: 9.1217 / Avg. bwd time: 20.8564 / Avg. batch time: 456.0529 (ms) / GPU bubble ratio: 47.41%
[rank0]:2025-12-28 16:09:34,105 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 16:09:37,833 - Avg. fwd time: 10.7419 / Avg. bwd time: 28.5222 / Avg. batch time: 373.7059 (ms) / GPU bubble ratio: 15.95%
[rank0]:2025-12-28 16:09:37,904 - Avg. fwd time: 8.2381 / Avg. bwd time: 18.4713 / Avg. batch time: 472.3726 (ms) / GPU bubble ratio: 54.77%
[rank2]:2025-12-28 16:09:37,865 - Avg. fwd time: 6.9630 / Avg. bwd time: 18.5452 / Avg. batch time: 417.9747 (ms) / GPU bubble ratio: 51.18%
[rank2]:2025-12-28 16:09:37,925 -  step: 800  loss: -8.0000  grad_norm:  0.1062  memory: 12.26GiB(25.80%)  tps: 8,749  tflops: 68.39  mfu: 21.92%
[rank2]:2025-12-28 16:09:37,926 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1062  tps: 8,839  tflops: 69.10  mfu: 20.21%
[rank2]:2025-12-28 16:09:37,926 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 16:09:37,926 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 16:09:37,938 -  step: 800  loss:  0.2342  grad_norm:  0.1062  memory: 26.98GiB(56.79%)  tps: 8,749  tflops: 68.40  mfu: 21.92%
[rank3]:2025-12-28 16:09:37,939 - â„¹ï¸ final step: 800  loss:  0.2342  grad_norm:  0.1062  tps: 8,846  tflops: 69.15  mfu: 20.33%
[rank3]:2025-12-28 16:09:37,939 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 16:09:37,940 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 16:09:37,890 - Avg. fwd time: 9.1231 / Avg. bwd time: 20.8372 / Avg. batch time: 455.4411 (ms) / GPU bubble ratio: 47.37%
[rank1]:2025-12-28 16:09:37,929 -  step: 800  loss: -8.0000  grad_norm:  0.1062  memory: 15.15GiB(31.89%)  tps: 8,749  tflops: 68.39  mfu: 21.92%
[rank1]:2025-12-28 16:09:37,929 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1062  tps: 8,839  tflops: 69.10  mfu: 20.21%
[rank1]:2025-12-28 16:09:37,929 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 16:09:37,930 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 16:09:37,940 -  step: 800  loss: -8.0000  grad_norm:  0.1062  memory: 17.08GiB(35.95%)  tps: 8,749  tflops: 68.39  mfu: 21.92%
[rank0]:2025-12-28 16:09:37,940 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1062  tps: 8,839  tflops: 69.10  mfu: 20.21%
[rank0]:2025-12-28 16:09:37,940 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 16:09:37,941 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 16:09:40,000 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-28 16:09:40,072 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_1609_stage1_final800.svg
[rank0]:2025-12-28 16:09:40,071 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_1609_stage0_final800.svg
[rank2]:2025-12-28 16:09:40,072 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_1609_stage2_final800.svg
[rank3]:2025-12-28 16:09:40,156 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1609_final800_rank3.svg
[rank3]:			> Batch Time: 456.25 ms, GPU Bubble Ratio: 54.65%, 48.21%, 55.25%, 34.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  306-25-332ms   | [S0,MB2,B]  336-25-362ms   | [S0,MB3,B]  364-25-389ms   | [S0,MB4,B]  393-14-408ms   | [S0,MB5,B]  416-23-440ms   | [S0,MB6,B]  441-0-441ms    | [S0,MB7,B]  456-0-456ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  281-22-303ms   | [S1,MB2,B]  307-25-333ms   | [S1,MB3,B]  336-20-357ms   | [S1,MB4,B]  364-26-390ms   | [S1,MB5,B]  393-19-413ms   | [S1,MB6,B]  417-12-429ms   | [S1,MB7,B]  441-11-453ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  258-19-277ms   | [S2,MB2,B]  284-19-303ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  336-20-356ms   | [S2,MB5,B]  364-20-384ms   | [S2,MB6,B]  393-20-413ms   | [S2,MB7,B]  417-8-426ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  251-23-274ms   | [S3,MB3,B]  274-22-297ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-342ms   | [S3,MB6,B]  342-22-364ms   | [S3,MB7,B]  364-22-386ms  
[rank0]:2025-12-28 16:09:40,226 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1609_rank0_stage0.svg
[rank0]:	> Counts Sum: 564720, Total Sum: 1728640 (32.67%), Ratio(%) per element: [36.3, 37.5, 38.01, 36.64, 36.64, 38.35, 37.84, 37.5, 35.95, 35.1, 34.58, 34.93, 35.27, 34.58, 34.07, 33.39, 34.41, 32.87, 34.41, 33.39, 33.04, 32.53, 30.47, 32.19, 31.84, 31.5, 30.13, 29.79, 29.1, 27.91, 28.25, 28.08, 28.76, 26.36, 24.82, 26.19, 25.85]
[rank2]:2025-12-28 16:09:40,226 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1609_rank2_stage2.svg
[rank2]:	> Counts Sum: 217760, Total Sum: 1681920 (12.95%), Ratio(%) per element: [13.18, 12.84, 12.84, 12.84, 12.32, 13.35, 12.84, 13.18, 13.35, 12.84, 12.67, 13.18, 13.35, 13.01, 13.35, 12.67, 13.01, 13.01, 13.01, 12.84, 13.18, 12.67, 13.01, 12.84, 13.18, 13.35, 12.67, 13.01, 12.5, 12.67, 12.5, 13.18, 13.01, 12.67, 12.84, 13.01]
[rank1]:2025-12-28 16:09:40,222 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1609_rank1_stage1.svg
[rank1]:	> Counts Sum: 796720, Total Sum: 2102400 (37.90%), Ratio(%) per element: [37.32, 38.35, 36.98, 37.67, 38.69, 37.15, 37.32, 36.81, 38.35, 36.98, 36.81, 38.35, 38.69, 38.01, 39.38, 37.67, 38.18, 39.04, 38.52, 36.47, 40.06, 35.95, 37.67, 38.18, 37.84, 36.47, 37.67, 38.69, 37.67, 38.52, 37.67, 38.18, 37.67, 38.18, 37.32, 37.32, 36.81, 40.92, 39.04, 37.84, 39.55, 38.69, 37.15, 36.13, 37.15]
[rank3]:2025-12-28 16:09:40,290 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/pipeline_schedule/251228_1609_thry_final800_rank3.svg
[rank3]:			> Batch Time: 289.01 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-8-43ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-70ms      | [S0,MB0,B]  148-17-166ms   | [S0,MB1,B]  166-17-183ms   | [S0,MB2,B]  183-17-201ms   | [S0,MB3,B]  201-17-218ms   | [S0,MB4,B]  218-17-236ms   | [S0,MB5,B]  236-17-253ms   | [S0,MB6,B]  253-17-271ms   | [S0,MB7,B]  271-17-289ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-35ms      | [S1,MB3,F]  35-8-43ms      | [S1,MB4,F]  43-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-70ms      | [S1,MB7,F]  70-8-78ms      | [S1,MB0,B]  131-17-148ms   | [S1,MB1,B]  148-17-166ms   | [S1,MB2,B]  166-17-183ms   | [S1,MB3,B]  183-17-201ms   | [S1,MB4,B]  201-17-218ms   | [S1,MB5,B]  218-17-236ms   | [S1,MB6,B]  236-17-253ms   | [S1,MB7,B]  253-17-271ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-35ms      | [S2,MB2,F]  35-8-43ms      | [S2,MB3,F]  43-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-70ms      | [S2,MB6,F]  70-8-78ms      | [S2,MB7,F]  78-8-87ms      | [S2,MB0,B]  113-17-131ms   | [S2,MB1,B]  131-17-148ms   | [S2,MB2,B]  148-17-166ms   | [S2,MB3,B]  166-17-183ms   | [S2,MB4,B]  183-17-201ms   | [S2,MB5,B]  201-17-218ms   | [S2,MB6,B]  218-17-236ms   | [S2,MB7,B]  236-17-253ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-35ms      | [S3,MB1,F]  35-8-43ms      | [S3,MB2,F]  43-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-70ms      | [S3,MB5,F]  70-8-78ms      | [S3,MB6,F]  78-8-87ms      | [S3,MB7,F]  87-8-96ms      | [S3,MB0,B]  96-17-113ms    | [S3,MB1,B]  113-17-131ms   | [S3,MB2,B]  131-17-148ms   | [S3,MB3,B]  148-17-166ms   | [S3,MB4,B]  166-17-183ms   | [S3,MB5,B]  183-17-201ms   | [S3,MB6,B]  201-17-218ms   | [S3,MB7,B]  218-17-236ms  
[rank3]:2025-12-28 16:09:40,338 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_1609_stage3_final800.svg
[rank3]:2025-12-28 16:09:40,472 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/frozen_params_histogram/251228_1609_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [76.02, 75.17, 74.48, 76.36, 75.34, 76.71, 75.68, 76.19, 76.02, 76.71, 77.05, 76.54, 76.19, 75.85, 75.17, 74.14, 75.68, 74.14, 75.68, 75.0, 75.17, 74.31, 75.17, 75.51, 75.17, 75.51, 74.31, 75.68, 75.51]
[rank1]:2025-12-28 16:09:42,079 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1609_stage1.svg
[rank1]:2025-12-28 16:09:42,084 - Destroying the purge thread.
[rank1]:2025-12-28 16:09:42,109 - Process group destroyed
[rank0]:2025-12-28 16:09:42,157 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1609_stage0.svg
[rank0]:2025-12-28 16:09:42,160 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-28 16:09:42,190 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1609_stage2.svg
[rank2]:2025-12-28 16:09:42,193 - Destroying the purge thread.
[rank3]:2025-12-28 16:09:42,382 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1/afr_time_plot/251228_1609_stage3.svg
[rank3]:2025-12-28 16:09:42,386 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-28 16:09:42,636 - Process group destroyed
[rank3]:wandb: uploading history steps 16-16, summary, console lines 335-351
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.70433
[rank3]:wandb:               final/avg_loss 0.23415
[rank3]:wandb:             final/avg_mfu(%) 20.33013
[rank3]:wandb:             final/avg_tflops 69.15292
[rank3]:wandb:    final/avg_throughput(tps) 8845.86718
[rank3]:wandb:              final/grad_norm 0.10617
[rank3]:wandb:               final/max_loss 0.23415
[rank3]:wandb:                    grad_norm 0.10617
[rank3]:wandb: loss_metrics/global_avg_loss 0.23415
[rank3]:wandb: loss_metrics/global_max_loss 0.23415
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_GPipe_fullrand7_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ap1b4rs2
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_GPipe_fullrand7_11_dm1/20251228-1517/wandb/run-20251228_151707-ap1b4rs2/logs
[rank3]:2025-12-28 16:09:43,652 - Process group destroyed
[rank0]:2025-12-28 16:09:44,160 - Training completed
[rank0]:2025-12-28 16:09:44,161 - Destroying the purge thread.
[rank0]:2025-12-28 16:09:44,209 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.2', 'tok_embeddings', 'layers.3', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.7', 'layers.6', 'layers.4', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.9', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'layers.13', 'output', 'layers.14'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_GPipe_fullrand7_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_GPipe_fullrand7_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_GPipe_fullrand7_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_GPipe_fullrand7_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_GPipe_fullrand7_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_GPipe_fullrand7_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_GPipe_fullrand7_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_GPipe_fullrand7_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
