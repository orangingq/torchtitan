
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 26. (ê¸ˆ) 16:12:48 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_timelyauto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with timelyauto x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-26 16:12:54,797 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank2]:2025-12-26 16:12:54,802 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank1]:2025-12-26 16:12:54,802 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-26 16:12:54,802 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-26 16:12:55,238 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-26 16:12:55,241 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 16:12:55,244 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-26 16:12:55,246 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-26 16:12:55,263 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-26 16:12:55,266 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-26 16:12:55,272 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-26 16:12:55,275 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-26 16:12:55,286 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-26 16:12:55,288 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 16:12:55,636 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-26 16:12:58,455 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-26 16:12:58,559 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-26 16:12:58,556 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-26 16:12:58,603 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 16:12:58,631 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-26 16:12:58,644 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-26 16:12:58,646 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-26 16:12:58,601 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 16:12:58,630 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-26 16:12:58,643 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-26 16:12:58,645 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-26 16:12:58,837 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 16:12:58,837 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-26 16:12:58,838 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-26 16:12:58,845 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 16:12:58,845 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-26 16:12:58,846 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:2025-12-26 16:12:59,523 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-26 16:12:59,562 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 16:12:59,576 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-26 16:12:59,588 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-26 16:12:59,590 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-26 16:12:59,776 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 16:12:59,776 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-26 16:12:59,776 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run gx8xdmet
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyauto_42_dm1/20251226-1612/wandb/run-20251226_161259-gx8xdmet
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_timelyauto_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/gx8xdmet
[rank0]:2025-12-26 16:13:00,780 - WandB logging enabled
[rank0]:2025-12-26 16:13:00,781 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-26 16:13:00,819 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 16:13:00,820 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-26 16:13:00,845 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-26 16:13:00,857 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-26 16:13:00,859 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-26 16:13:01,076 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 16:13:01,077 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-26 16:13:01,078 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank3]:2025-12-26 16:13:01,095 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-26 16:13:01,095 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 16:13:01,095 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank0]:2025-12-26 16:13:01,095 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 16:13:01,096 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-26 16:13:01,096 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-26 16:13:01,095 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 16:13:04,580 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-26 16:13:04,581 - Finished loading the checkpoint in 3.48 seconds.
[rank0]:2025-12-26 16:13:04,581 - Training starts at step 1
[rank1]:2025-12-26 16:13:09,684 -  step:  1  loss: -4.0000  grad_norm: 203.0655  memory: 15.56GiB(32.76%)  tps: 2,957  tflops: 23.11  mfu: 7.41%
[rank1]:2025-12-26 16:13:09,685 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-26 16:13:09,676 -  step:  1  loss: -4.0000  grad_norm: 203.0655  memory: 13.43GiB(28.27%)  tps: 3,240  tflops: 25.33  mfu: 8.12%
[rank3]:2025-12-26 16:13:09,676 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-26 16:13:09,663 -  step:  1  loss: -4.0000  grad_norm: 203.0655  memory: 11.98GiB(25.23%)  tps: 2,963  tflops: 23.16  mfu: 7.42%
[rank2]:2025-12-26 16:13:09,663 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 16:13:09,710 -  step:  1  loss: 10.6092  grad_norm: 203.0655  memory: 30.01GiB(63.17%)  tps: 3,686  tflops: 28.82  mfu: 9.24%
[rank0]:2025-12-26 16:13:09,711 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 16:16:51,637 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 16:16:56,460 - Avg. fwd time: 13.6700 / Avg. full-bwd time: 29.0292 (Avg. bwd-weight time: 30.0993 / Avg. bwd-input time: 34.5281) / Avg. batch time: 1115.4523 (ms) / GPU bubble ratio: 13.22%
[rank2]:2025-12-26 16:16:56,434 - Avg. fwd time: 8.1365 / Avg. bwd-weight time: 10.0177 / Avg. bwd-input time: 9.9964 / Avg. batch time: 1057.7194 (ms) / GPU bubble ratio: 57.42%
[rank3]:2025-12-26 16:16:56,439 - Avg. fwd time: 7.7954 / Avg. bwd-weight time: 9.8406 / Avg. bwd-input time: 9.6132 / Avg. batch time: 1054.0786 (ms) / GPU bubble ratio: 58.64%
[rank1]:2025-12-26 16:16:56,453 - Avg. fwd time: 9.8612 / Avg. bwd-weight time: 12.9298 / Avg. bwd-input time: 12.2092 / Avg. batch time: 1092.9282 (ms) / GPU bubble ratio: 48.76%
[rank0]:2025-12-26 16:16:56,534 -  step: 50  loss:  9.8861  grad_norm: 24.4004  memory: 35.32GiB(74.36%)  tps: 7,079  tflops: 55.34  mfu: 17.74%
[rank2]:2025-12-26 16:16:56,506 -  step: 50  loss: -4.0000  grad_norm: 24.4004  memory: 13.80GiB(29.05%)  tps: 7,078  tflops: 55.33  mfu: 17.74%
[rank3]:2025-12-26 16:16:56,506 -  step: 50  loss: -4.0000  grad_norm: 24.4004  memory: 15.27GiB(32.13%)  tps: 7,079  tflops: 55.34  mfu: 17.74%
[rank1]:2025-12-26 16:16:56,510 -  step: 50  loss: -4.0000  grad_norm: 24.4004  memory: 17.85GiB(37.57%)  tps: 7,079  tflops: 55.34  mfu: 17.74%
[rank3]:2025-12-26 16:17:38,411 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-12-26 16:18:24,773 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-26 16:18:24,973 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-26 16:18:24,964 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-26 16:18:24,986 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-26 16:19:11,747 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-26 16:19:11,863 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-12-26 16:20:17,128 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 16:20:17,761 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-26 16:20:17,867 - Current/Expected Freeze Ratio per Block: [MB0] 0.89/0.89, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.51/0.51, [MB4] 0.68/0.68, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 1.00/1.00
[rank1]:2025-12-26 16:20:17,868 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.00/0.00, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.69/0.69, [MB5] 0.83/0.83, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-26 16:20:17,866 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.29/0.29, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.44/0.44, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-26 16:20:18,267 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1620_max_batch_time.svg
[rank3]:			> Batch Time: 996.15 ms, GPU Bubble Ratio: 1.34%, 43.51%, 54.56%, 56.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-62ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-25-151ms   | [S7,MB1,F]  151-16-168ms   | [S7,MB1,BI] 168-34-203ms   | [S7,MB1,BW] 203-30-233ms   | [S7,MB2,F]  233-19-252ms   | [S7,MB2,BI] 252-35-288ms   | [S7,MB2,BW] 288-31-319ms   | [S7,MB3,F]  319-19-339ms   | [S7,MB3,BI] 339-35-374ms   | [S7,MB3,BW] 374-32-406ms   | [S0,MB7,F]  406-10-417ms   | [S0,MB0,B]  417-30-447ms   | [S7,MB4,F]  447-19-466ms   | [S7,MB4,BI] 466-35-502ms   | [S7,MB4,BW] 502-32-534ms   | [S0,MB1,B]  534-30-564ms   | [S7,MB5,F]  564-19-583ms   | [S7,MB5,BI] 583-34-618ms   | [S7,MB5,BW] 618-31-650ms   | [S0,MB2,B]  650-30-680ms   | [S7,MB6,F]  680-18-699ms   | [S7,MB6,BI] 699-34-734ms   | [S7,MB6,BW] 734-30-764ms   | [S0,MB3,B]  764-30-794ms   | [S7,MB7,F]  794-18-813ms   | [S7,MB7,BI] 813-34-848ms   | [S7,MB7,BW] 848-31-879ms   | [S0,MB4,B]  879-30-910ms   | [S0,MB5,B]  910-29-939ms   | [S0,MB6,B]  939-28-968ms   | [S0,MB7,B]  968-27-996ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-145ms   | [S6,MB2,F]  145-7-152ms    | [S6,MB1,BI] 203-9-212ms    | [S6,MB1,BW] 212-10-222ms   | [S6,MB3,F]  222-7-229ms    | [S6,MB2,BI] 288-9-297ms    | [S6,MB2,BW] 297-10-308ms   | [S1,MB6,F]  308-10-319ms   | [S1,MB0,BI] 319-15-335ms   | [S1,MB0,BW] 335-15-350ms   | [S6,MB4,F]  350-8-358ms    | [S6,MB3,BI] 374-10-384ms   | [S6,MB3,BW] 384-9-394ms    | [S1,MB7,F]  417-13-430ms   | [S1,MB1,BI] 430-15-446ms   | [S1,MB1,BW] 446-14-460ms   | [S6,MB5,F]  460-7-468ms    | [S6,MB4,BI] 502-10-512ms   | [S6,MB4,BW] 512-9-522ms    | [S1,MB2,BI] 522-14-536ms   | [S1,MB2,BW] 536-14-550ms   | [S6,MB6,F]  550-7-557ms    | [S6,MB5,BI] 618-9-628ms    | [S6,MB5,BW] 628-10-639ms   | [S1,MB3,BI] 639-14-653ms   | [S1,MB3,BW] 653-14-667ms   | [S6,MB7,F]  667-7-675ms    | [S6,MB6,BI] 734-9-743ms    | [S6,MB6,BW] 743-11-754ms   | [S1,MB4,BI] 754-14-769ms   | [S6,MB7,BI] 848-10-858ms   | [S1,MB5,BI] 858-15-873ms   | [S1,MB4,BW] 873-15-889ms   | [S1,MB6,BI] 889-14-904ms   | [S1,MB5,BW] 904-15-919ms   | [S1,MB7,BI] 919-15-935ms   | [S1,MB6,BW] 935-16-951ms   | [S6,MB7,BW] 951-11-963ms   | [S1,MB7,BW] 963-16-980ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-144ms    | [S5,MB0,BW] 144-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 212-9-221ms    | [S5,MB1,BW] 221-10-232ms   | [S2,MB5,F]  232-7-239ms    | [S2,MB0,BI] 239-10-250ms   | [S2,MB0,BW] 250-9-259ms    | [S5,MB4,F]  259-7-267ms    | [S5,MB2,BI] 297-10-307ms   | [S5,MB2,BW] 307-9-317ms    | [S2,MB6,F]  319-9-328ms    | [S2,MB1,BI] 328-10-339ms   | [S2,MB1,BW] 339-9-349ms    | [S5,MB5,F]  349-7-356ms    | [S5,MB3,BI] 384-11-396ms   | [S5,MB3,BW] 396-11-407ms   | [S2,MB7,F]  430-7-438ms    | [S2,MB2,BI] 438-10-448ms   | [S2,MB2,BW] 448-9-458ms    | [S5,MB6,F]  458-7-466ms    | [S5,MB4,BI] 512-10-522ms   | [S5,MB4,BW] 522-9-532ms    | [S2,MB3,BI] 532-9-542ms    | [S2,MB3,BW] 542-10-552ms   | [S5,MB7,F]  552-7-559ms    | [S5,MB5,BI] 628-9-637ms    | [S5,MB5,BW] 637-9-647ms    | [S2,MB4,BI] 647-9-656ms    | [S5,MB6,BI] 743-10-754ms   | [S2,MB5,BI] 754-10-764ms   | [S5,MB7,BI] 858-9-868ms    | [S2,MB6,BI] 868-10-878ms   | [S2,MB4,BW] 878-10-889ms   | [S2,MB7,BI] 889-9-898ms    | [S2,MB5,BW] 898-10-909ms   | [S5,MB6,BW] 909-9-919ms    | [S5,MB7,BW] 919-9-928ms    | [S2,MB6,BW] 928-9-938ms    | [S2,MB7,BW] 938-10-949ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-69ms      | [S4,MB2,F]  69-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 144-9-153ms    | [S4,MB0,BW] 153-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-179ms    | [S3,MB0,BW] 179-9-188ms    AFR(10):1.0000 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 221-10-231ms   | [S4,MB1,BW] 231-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-250ms    | [S3,MB1,BI] 250-9-259ms    | [S3,MB1,BW] 259-9-269ms    AFR(10):1.0000 | [S4,MB5,F]  269-7-277ms    | [S4,MB2,BI] 307-11-318ms   | [S4,MB2,BW] 318-9-328ms    AFR(10):1.0000 | [S3,MB6,F]  328-7-336ms    | [S3,MB2,BI] 336-9-345ms    | [S3,MB2,BW] 345-9-355ms    AFR(10):1.0000 | [S4,MB6,F]  355-7-362ms    | [S4,MB3,BI] 396-10-406ms   | [S4,MB3,BW] 406-10-416ms   AFR(10):1.0000 | [S3,MB7,F]  438-7-445ms    | [S3,MB3,BI] 445-9-454ms    | [S3,MB3,BW] 454-9-464ms    AFR(10):1.0000 | [S4,MB7,F]  464-7-472ms    | [S4,MB4,BI] 522-10-533ms   | [S4,MB4,BW] 533-9-542ms    AFR(10):1.0000 | [S3,MB4,BI] 542-10-553ms   | [S4,MB5,BI] 637-10-647ms   | [S3,MB5,BI] 647-9-656ms    | [S4,MB6,BI] 754-9-763ms    | [S3,MB6,BI] 763-9-772ms    | [S4,MB7,BI] 868-9-877ms    | [S3,MB7,BI] 877-9-886ms    | [S3,MB4,BW] 886-10-896ms   AFR(10):1.0000 | [S4,MB5,BW] 896-9-906ms    AFR(10):1.0000 | [S4,MB6,BW] 906-9-915ms    AFR(10):1.0000 | [S4,MB7,BW] 915-9-925ms    AFR(10):1.0000 | [S3,MB5,BW] 925-10-935ms   AFR(10):1.0000 | [S3,MB6,BW] 935-10-945ms   AFR(10):1.0000 | [S3,MB7,BW] 945-10-956ms   AFR(10):1.0000
[rank3]:2025-12-26 16:20:18,607 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1620_min_batch_time.svg
[rank3]:			> Batch Time: 600.45 ms, GPU Bubble Ratio: 12.58%, 41.09%, 51.60%, 53.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-62ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-1-126ms    | [S7,MB1,F]  126-16-143ms   | [S7,MB1,BI] 143-34-178ms   | [S7,MB1,BW] 178-0-178ms    | [S7,MB2,F]  178-19-197ms   | [S7,MB2,BI] 197-35-233ms   | [S7,MB2,BW] 233-0-233ms    | [S7,MB3,F]  233-19-253ms   | [S7,MB3,BI] 253-35-288ms   | [S7,MB3,BW] 288-21-310ms   | [S0,MB7,F]  310-10-320ms   | [S0,MB0,B]  320-0-320ms    | [S7,MB4,F]  320-19-339ms   | [S7,MB4,BI] 339-35-374ms   | [S7,MB4,BW] 374-0-374ms    | [S0,MB1,B]  374-0-374ms    | [S7,MB5,F]  374-19-394ms   | [S7,MB5,BI] 394-34-429ms   | [S7,MB5,BW] 429-1-430ms    | [S0,MB2,B]  430-0-430ms    | [S7,MB6,F]  430-18-449ms   | [S7,MB6,BI] 449-34-484ms   | [S7,MB6,BW] 484-0-484ms    | [S0,MB3,B]  484-0-484ms    | [S7,MB7,F]  484-18-503ms   | [S7,MB7,BI] 503-34-538ms   | [S7,MB7,BW] 538-0-538ms    | [S0,MB4,B]  538-0-538ms    | [S0,MB5,B]  563-0-563ms    | [S0,MB6,B]  582-0-582ms    | [S0,MB7,B]  600-0-600ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-0-134ms    | [S6,MB2,F]  134-7-142ms    | [S6,MB1,BI] 178-9-187ms    | [S6,MB1,BW] 187-0-187ms    | [S6,MB3,F]  187-7-195ms    | [S6,MB2,BI] 233-9-242ms    | [S6,MB2,BW] 242-0-242ms    | [S1,MB6,F]  242-10-253ms   | [S1,MB0,BI] 253-15-269ms   | [S1,MB0,BW] 269-0-269ms    | [S6,MB4,F]  269-8-277ms    | [S6,MB3,BI] 288-10-299ms   | [S6,MB3,BW] 299-0-299ms    | [S1,MB7,F]  320-13-334ms   | [S1,MB1,BI] 334-15-349ms   | [S1,MB1,BW] 349-0-349ms    | [S6,MB5,F]  349-7-357ms    | [S6,MB4,BI] 374-10-384ms   | [S6,MB4,BW] 384-0-384ms    | [S1,MB2,BI] 384-14-399ms   | [S1,MB2,BW] 399-0-399ms    | [S6,MB6,F]  399-7-406ms    | [S6,MB5,BI] 429-9-438ms    | [S6,MB5,BW] 438-0-438ms    | [S1,MB3,BI] 438-14-452ms   | [S1,MB3,BW] 452-0-452ms    | [S6,MB7,F]  452-7-460ms    | [S6,MB6,BI] 484-9-493ms    | [S6,MB6,BW] 493-0-493ms    | [S1,MB4,BI] 493-14-508ms   | [S6,MB7,BI] 538-10-548ms   | [S1,MB5,BI] 548-15-563ms   | [S1,MB4,BW] 563-0-563ms    | [S1,MB6,BI] 568-14-582ms   | [S1,MB5,BW] 582-0-582ms    | [S1,MB7,BI] 585-15-600ms   | [S1,MB6,BW] 600-0-600ms    | [S6,MB7,BW] 600-0-600ms    | [S1,MB7,BW] 600-0-600ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-144ms    | [S5,MB0,BW] 144-0-144ms    | [S5,MB3,F]  144-7-151ms    | [S5,MB1,BI] 187-9-196ms    | [S5,MB1,BW] 196-0-197ms    | [S2,MB5,F]  197-7-204ms    | [S2,MB0,BI] 204-10-214ms   | [S2,MB0,BW] 214-0-214ms    | [S5,MB4,F]  214-7-222ms    | [S5,MB2,BI] 242-10-252ms   | [S5,MB2,BW] 252-0-252ms    | [S2,MB6,F]  253-9-263ms    | [S2,MB1,BI] 263-10-273ms   | [S2,MB1,BW] 273-0-273ms    | [S5,MB5,F]  273-7-281ms    | [S5,MB3,BI] 299-11-310ms   | [S5,MB3,BW] 310-0-310ms    | [S2,MB7,F]  334-7-341ms    | [S2,MB2,BI] 341-10-351ms   | [S2,MB2,BW] 351-0-351ms    | [S5,MB6,F]  351-7-359ms    | [S5,MB4,BI] 384-10-395ms   | [S5,MB4,BW] 395-0-395ms    | [S2,MB3,BI] 395-9-405ms    | [S2,MB3,BW] 405-0-405ms    | [S5,MB7,F]  405-7-412ms    | [S5,MB5,BI] 438-9-448ms    | [S5,MB5,BW] 448-0-448ms    | [S2,MB4,BI] 448-9-457ms    | [S5,MB6,BI] 493-10-504ms   | [S2,MB5,BI] 504-10-514ms   | [S5,MB7,BI] 548-9-557ms    | [S2,MB6,BI] 557-10-568ms   | [S2,MB4,BW] 568-0-568ms    | [S2,MB7,BI] 575-9-585ms    | [S2,MB5,BW] 585-0-585ms    | [S5,MB6,BW] 585-0-585ms    | [S5,MB7,BW] 585-0-585ms    | [S2,MB6,BW] 585-0-585ms    | [S2,MB7,BW] 585-0-585ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-69ms      | [S4,MB2,F]  69-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 144-9-153ms    | [S4,MB0,BW] 153-0-153ms    AFR(10):1.0000 | [S3,MB4,F]  153-7-160ms    | [S3,MB0,BI] 160-9-169ms    | [S3,MB0,BW] 169-0-169ms    AFR(10):1.0000 | [S4,MB4,F]  169-7-177ms    | [S4,MB1,BI] 196-10-207ms   | [S4,MB1,BW] 207-0-207ms    AFR(10):1.0000 | [S3,MB5,F]  207-8-215ms    | [S3,MB1,BI] 215-9-224ms    | [S3,MB1,BW] 224-0-224ms    AFR(10):1.0000 | [S4,MB5,F]  224-7-232ms    | [S4,MB2,BI] 252-11-263ms   | [S4,MB2,BW] 263-0-263ms    AFR(10):1.0000 | [S3,MB6,F]  263-7-270ms    | [S3,MB2,BI] 270-9-280ms    | [S3,MB2,BW] 280-0-280ms    AFR(10):1.0000 | [S4,MB6,F]  280-7-288ms    | [S4,MB3,BI] 310-10-320ms   | [S4,MB3,BW] 320-0-320ms    AFR(10):1.0000 | [S3,MB7,F]  341-7-348ms    | [S3,MB3,BI] 348-9-358ms    | [S3,MB3,BW] 358-0-358ms    AFR(10):1.0000 | [S4,MB7,F]  358-7-365ms    | [S4,MB4,BI] 395-10-405ms   | [S4,MB4,BW] 405-0-405ms    AFR(10):1.0000 | [S3,MB4,BI] 405-10-416ms   | [S4,MB5,BI] 448-10-458ms   | [S3,MB5,BI] 458-9-467ms    | [S4,MB6,BI] 504-9-513ms    | [S3,MB6,BI] 513-9-522ms    | [S4,MB7,BI] 557-9-566ms    | [S3,MB7,BI] 566-9-575ms    | [S3,MB4,BW] 575-0-575ms    AFR(10):1.0000 | [S4,MB5,BW] 575-0-575ms    AFR(10):1.0000 | [S4,MB6,BW] 575-0-575ms    AFR(10):1.0000 | [S4,MB7,BW] 575-0-575ms    AFR(10):1.0000 | [S3,MB5,BW] 575-0-575ms    AFR(10):1.0000 | [S3,MB6,BW] 575-0-575ms    AFR(10):1.0000 | [S3,MB7,BW] 575-0-575ms    AFR(10):1.0000
[rank3]:2025-12-26 16:20:18,971 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1620_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 613.94 ms, GPU Bubble Ratio: 2.17%, 20.03%, 32.46%, 36.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-62ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-3-129ms    | [S7,MB1,F]  129-16-146ms   | [S7,MB1,BI] 146-34-181ms   | [S7,MB1,BW] 181-0-181ms    | [S7,MB2,F]  181-19-200ms   | [S7,MB2,BI] 200-35-235ms   | [S7,MB2,BW] 235-0-236ms    | [S7,MB3,F]  236-19-255ms   | [S7,MB3,BI] 255-35-291ms   | [S7,MB3,BW] 291-32-323ms   | [S0,MB7,F]  323-10-333ms   | [S0,MB0,B]  333-0-334ms    | [S7,MB4,F]  334-19-353ms   | [S7,MB4,BI] 353-35-388ms   | [S7,MB4,BW] 388-0-388ms    | [S0,MB1,B]  388-0-388ms    | [S7,MB5,F]  388-19-407ms   | [S7,MB5,BI] 407-34-442ms   | [S7,MB5,BW] 442-1-443ms    | [S0,MB2,B]  443-0-443ms    | [S7,MB6,F]  443-18-462ms   | [S7,MB6,BI] 462-34-497ms   | [S7,MB6,BW] 497-0-497ms    | [S0,MB3,B]  497-0-497ms    | [S7,MB7,F]  497-18-516ms   | [S7,MB7,BI] 516-34-551ms   | [S7,MB7,BW] 551-15-567ms   | [S0,MB4,B]  567-9-576ms    | [S0,MB5,B]  576-19-596ms   | [S0,MB6,B]  596-17-613ms   | [S0,MB7,B]  613-0-613ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-145ms   | [S6,MB2,F]  145-7-152ms    | [S6,MB1,BI] 181-9-190ms    | [S6,MB1,BW] 190-10-200ms   | [S6,MB3,F]  200-7-208ms    | [S6,MB2,BI] 235-9-245ms    | [S6,MB2,BW] 245-10-255ms   | [S1,MB6,F]  255-10-266ms   | [S1,MB0,BI] 266-15-282ms   | [S1,MB0,BW] 282-15-297ms   | [S6,MB4,F]  297-8-305ms    | [S6,MB3,BI] 305-10-316ms   | [S6,MB3,BW] 316-9-326ms    | [S1,MB7,F]  333-13-347ms   | [S1,MB1,BI] 347-15-362ms   | [S1,MB1,BW] 362-14-377ms   | [S6,MB5,F]  377-7-385ms    | [S6,MB4,BI] 388-10-398ms   | [S6,MB4,BW] 398-9-408ms    | [S1,MB2,BI] 408-14-422ms   | [S1,MB2,BW] 422-14-436ms   | [S6,MB6,F]  436-7-443ms    | [S6,MB5,BI] 443-9-453ms    | [S6,MB5,BW] 453-10-464ms   | [S1,MB3,BI] 464-14-478ms   | [S1,MB3,BW] 478-11-490ms   | [S6,MB7,F]  490-7-497ms    | [S6,MB6,BI] 497-9-507ms    | [S6,MB6,BW] 507-11-518ms   | [S1,MB4,BI] 518-14-533ms   | [S6,MB7,BI] 551-10-561ms   | [S1,MB5,BI] 561-15-576ms   | [S1,MB4,BW] 576-4-581ms    | [S1,MB6,BI] 581-14-596ms   | [S1,MB5,BW] 596-2-598ms    | [S1,MB7,BI] 598-15-613ms   | [S1,MB6,BW] 613-0-613ms    | [S6,MB7,BW] 613-0-613ms    | [S1,MB7,BW] 613-0-613ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-144ms    | [S5,MB0,BW] 144-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 190-9-199ms    | [S5,MB1,BW] 199-10-210ms   | [S2,MB5,F]  210-7-217ms    | [S2,MB0,BI] 217-10-228ms   | [S2,MB0,BW] 228-9-238ms    | [S5,MB4,F]  238-7-246ms    | [S5,MB2,BI] 246-10-256ms   | [S5,MB2,BW] 256-9-266ms    | [S2,MB6,F]  266-9-276ms    | [S2,MB1,BI] 276-10-286ms   | [S2,MB1,BW] 286-9-296ms    | [S5,MB5,F]  296-7-304ms    | [S5,MB3,BI] 316-11-327ms   | [S5,MB3,BW] 327-11-338ms   | [S2,MB7,F]  347-7-354ms    | [S2,MB2,BI] 354-10-365ms   | [S2,MB2,BW] 365-9-375ms    | [S5,MB6,F]  375-7-382ms    | [S5,MB4,BI] 398-10-408ms   | [S5,MB4,BW] 408-9-418ms    | [S2,MB3,BI] 418-9-428ms    | [S2,MB3,BW] 428-10-438ms   | [S5,MB7,F]  438-7-445ms    | [S5,MB5,BI] 453-9-462ms    | [S5,MB5,BW] 462-9-472ms    | [S2,MB4,BI] 472-9-482ms    | [S5,MB6,BI] 507-10-517ms   | [S2,MB5,BI] 517-10-527ms   | [S5,MB7,BI] 561-9-571ms    | [S2,MB6,BI] 571-10-581ms   | [S2,MB4,BW] 581-7-589ms    | [S2,MB7,BI] 589-9-598ms    | [S2,MB5,BW] 598-0-598ms    | [S5,MB6,BW] 598-9-608ms    | [S5,MB7,BW] 608-5-613ms    | [S2,MB6,BW] 613-0-613ms    | [S2,MB7,BW] 613-0-613ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-69ms      | [S4,MB2,F]  69-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 144-9-153ms    | [S4,MB0,BW] 153-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-179ms    | [S3,MB0,BW] 179-9-188ms    AFR(10):1.0000 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 199-10-209ms   | [S4,MB1,BW] 209-10-220ms   AFR(10):1.0000 | [S3,MB5,F]  220-8-228ms    | [S3,MB1,BI] 228-9-237ms    | [S3,MB1,BW] 237-9-247ms    AFR(10):1.0000 | [S4,MB5,F]  247-7-255ms    | [S4,MB2,BI] 256-11-267ms   | [S4,MB2,BW] 267-9-277ms    AFR(10):1.0000 | [S3,MB6,F]  277-7-284ms    | [S3,MB2,BI] 284-9-293ms    | [S3,MB2,BW] 293-9-303ms    AFR(10):1.0000 | [S4,MB6,F]  303-7-311ms    | [S4,MB3,BI] 327-10-337ms   | [S4,MB3,BW] 337-10-348ms   AFR(10):1.0000 | [S3,MB7,F]  354-7-362ms    | [S3,MB3,BI] 362-9-371ms    | [S3,MB3,BW] 371-9-381ms    AFR(10):1.0000 | [S4,MB7,F]  381-7-388ms    | [S4,MB4,BI] 408-10-419ms   | [S4,MB4,BW] 419-9-429ms    AFR(10):1.0000 | [S3,MB4,BI] 429-10-439ms   | [S4,MB5,BI] 462-10-472ms   | [S3,MB5,BI] 472-9-482ms    | [S4,MB6,BI] 517-9-526ms    | [S3,MB6,BI] 526-9-536ms    | [S4,MB7,BI] 571-9-580ms    | [S3,MB7,BI] 580-9-589ms    | [S3,MB4,BW] 589-0-589ms    AFR(10):1.0000 | [S4,MB5,BW] 589-9-598ms    AFR(10):1.0000 | [S4,MB6,BW] 598-9-608ms    AFR(10):1.0000 | [S4,MB7,BW] 608-5-613ms    AFR(10):1.0000 | [S3,MB5,BW] 613-0-613ms    AFR(10):1.0000 | [S3,MB6,BW] 613-0-613ms    AFR(10):1.0000 | [S3,MB7,BW] 613-0-613ms    AFR(10):1.0000
[rank3]:2025-12-26 16:20:18,971 - 	> Batch Time: 613.94 ms (Average Freeze Ratio: 0.40, Time Reduction Rate: 0.38)
[rank3]:2025-12-26 16:20:18,973 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.43/0.43, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-26 16:20:22,253 - Avg. fwd time: 8.1754 / Avg. bwd-weight time: 8.0128 / Avg. bwd-input time: 10.0097 / Avg. batch time: 997.6629 (ms) / GPU bubble ratio: 57.99%
[rank3]:2025-12-26 16:20:22,253 - Avg. fwd time: 7.7695 / Avg. bwd-weight time: 7.8675 / Avg. bwd-input time: 9.6323 / Avg. batch time: 987.2432 (ms) / GPU bubble ratio: 59.05%
[rank0]:2025-12-26 16:20:22,271 - Avg. fwd time: 13.5558 / Avg. full-bwd time: 23.1427 (Avg. bwd-weight time: 24.6405 / Avg. bwd-input time: 34.4705) / Avg. batch time: 1053.8409 (ms) / GPU bubble ratio: 16.98%
[rank1]:2025-12-26 16:20:22,256 - Avg. fwd time: 9.9008 / Avg. bwd-weight time: 10.3272 / Avg. bwd-input time: 12.2398 / Avg. batch time: 1032.2498 (ms) / GPU bubble ratio: 49.67%
[rank2]:2025-12-26 16:20:22,316 -  step: 100  loss: -4.0000  grad_norm:  3.9235  memory: 13.80GiB(29.05%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank2]:2025-12-26 16:20:22,408 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1620_stage2_step100.svg
[rank3]:2025-12-26 16:20:22,317 -  step: 100  loss: -4.0000  grad_norm:  3.9235  memory: 15.27GiB(32.13%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank0]:2025-12-26 16:20:22,343 -  step: 100  loss:  8.7445  grad_norm:  3.9235  memory: 36.24GiB(76.29%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank0]:2025-12-26 16:20:22,408 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1620_stage0_step100.svg
[rank1]:2025-12-26 16:20:22,320 -  step: 100  loss: -4.0000  grad_norm:  3.9235  memory: 17.85GiB(37.57%)  tps: 7,961  tflops: 62.23  mfu: 19.95%
[rank1]:2025-12-26 16:20:22,410 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1620_stage1_step100.svg
[rank2]:2025-12-26 16:20:22,449 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1620_stage5_step100.svg
[rank0]:2025-12-26 16:20:22,447 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1620_stage7_step100.svg
[rank1]:2025-12-26 16:20:22,454 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1620_stage6_step100.svg
[rank2]:2025-12-26 16:20:22,558 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank2_stage2.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-26 16:20:22,556 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank0_stage0.svg
[rank0]:	> Counts Sum: 12160, Total Sum: 12160 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-26 16:20:22,593 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank1_stage1.svg
[rank1]:	> Counts Sum: 17280, Total Sum: 17280 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-26 16:20:22,666 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-26 16:20:22,708 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage2.svg
[rank3]:2025-12-26 16:20:22,649 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1620_step100_rank3.svg
[rank3]:			> Batch Time: 794.00 ms, GPU Bubble Ratio: 36.65%, 54.86%, 63.08%, 65.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  112-16-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-0-174ms    | [S7,MB1,F]  174-15-190ms   | [S7,MB1,BI] 203-34-237ms   | [S7,MB1,BW] 236-21-258ms   | [S7,MB2,F]  258-18-276ms   | [S7,MB2,BI] 289-35-324ms   | [S7,MB2,BW] 324-0-324ms    | [S7,MB3,F]  324-18-343ms   | [S7,MB3,BI] 354-35-390ms   | [S7,MB3,BW] 389-0-389ms    | [S0,MB7,F]  391-10-401ms   | [S0,MB0,B]  402-0-402ms    | [S7,MB4,F]  409-18-427ms   | [S7,MB4,BI] 439-34-473ms   | [S7,MB4,BW] 474-0-474ms    | [S0,MB1,B]  481-0-481ms    | [S7,MB5,F]  485-18-503ms   | [S7,MB5,BI] 515-33-548ms   | [S7,MB5,BW] 548-0-548ms    | [S0,MB2,B]  555-0-555ms    | [S7,MB6,F]  569-15-584ms   | [S7,MB6,BI] 595-33-628ms   | [S7,MB6,BW] 629-1-630ms    | [S0,MB3,B]  636-0-636ms    | [S7,MB7,F]  650-15-665ms   | [S7,MB7,BI] 677-33-710ms   | [S7,MB7,BW] 710-0-710ms    | [S0,MB4,B]  718-0-718ms    | [S0,MB5,B]  744-0-744ms    | [S0,MB6,B]  770-0-770ms    | [S0,MB7,B]  794-0-794ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-0-183ms    | [S6,MB2,F]  184-8-192ms    | [S6,MB1,BI] 239-9-248ms    | [S6,MB1,BW] 248-0-248ms    | [S6,MB3,F]  248-8-256ms    | [S6,MB2,BI] 323-9-332ms    | [S6,MB2,BW] 333-0-333ms    | [S1,MB6,F]  333-12-345ms   | [S1,MB0,BI] 345-15-361ms   | [S1,MB0,BW] 361-0-361ms    | [S6,MB4,F]  361-7-369ms    | [S6,MB3,BI] 389-10-400ms   | [S6,MB3,BW] 400-0-400ms    | [S1,MB7,F]  402-13-416ms   | [S1,MB1,BI] 416-15-432ms   | [S1,MB1,BW] 432-0-432ms    | [S6,MB5,F]  432-7-439ms    | [S6,MB4,BI] 473-11-485ms   | [S6,MB4,BW] 485-0-485ms    | [S1,MB2,BI] 492-13-506ms   | [S1,MB2,BW] 506-0-506ms    | [S6,MB6,F]  554-7-561ms    | [S6,MB5,BI] 561-10-571ms   | [S6,MB5,BW] 571-0-571ms    | [S1,MB3,BI] 578-14-592ms   | [S1,MB3,BW] 592-0-592ms    | [S6,MB7,F]  635-7-642ms    | [S6,MB6,BI] 642-10-652ms   | [S6,MB6,BW] 652-0-652ms    | [S1,MB4,BI] 659-14-674ms   | [S6,MB7,BI] 710-10-721ms   | [S1,MB5,BI] 721-14-736ms   | [S1,MB4,BW] 735-0-735ms    | [S1,MB6,BI] 748-14-762ms   | [S1,MB5,BW] 762-0-762ms    | [S1,MB7,BI] 772-13-786ms   | [S1,MB6,BW] 786-0-786ms    | [S6,MB7,BW] 786-0-786ms    | [S1,MB7,BW] 786-0-786ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 183-9-192ms    | [S5,MB0,BW] 192-0-192ms    | [S5,MB3,F]  193-8-201ms    | [S5,MB1,BI] 248-9-257ms    | [S5,MB1,BW] 257-0-257ms    | [S2,MB5,F]  257-8-266ms    | [S2,MB0,BI] 266-10-276ms   | [S2,MB0,BW] 276-0-276ms    | [S5,MB4,F]  276-7-284ms    | [S5,MB2,BI] 333-10-343ms   | [S5,MB2,BW] 343-0-343ms    | [S2,MB6,F]  345-9-355ms    | [S2,MB1,BI] 357-10-367ms   | [S2,MB1,BW] 367-0-367ms    | [S5,MB5,F]  367-7-375ms    | [S5,MB3,BI] 406-10-417ms   | [S5,MB3,BW] 417-0-417ms    | [S2,MB7,F]  417-9-426ms    | [S2,MB2,BI] 429-10-439ms   | [S2,MB2,BW] 439-0-439ms    | [S5,MB6,F]  439-7-446ms    | [S5,MB4,BI] 485-10-495ms   | [S5,MB4,BW] 495-0-495ms    | [S2,MB3,BI] 557-9-566ms    | [S2,MB3,BW] 566-0-566ms    | [S5,MB7,F]  578-7-585ms    | [S5,MB5,BI] 585-9-594ms    | [S5,MB5,BW] 594-0-594ms    | [S2,MB4,BI] 638-9-648ms    | [S5,MB6,BI] 652-10-663ms   | [S2,MB5,BI] 663-10-673ms   | [S5,MB7,BI] 721-9-731ms    | [S2,MB6,BI] 730-11-741ms   | [S2,MB4,BW] 741-0-741ms    | [S2,MB7,BI] 756-9-766ms    | [S2,MB5,BW] 766-0-766ms    | [S5,MB6,BW] 766-0-766ms    | [S5,MB7,BW] 766-0-766ms    | [S2,MB6,BW] 766-0-766ms    | [S2,MB7,BW] 766-0-766ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  97-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 192-9-202ms    | [S4,MB0,BW] 201-0-201ms    | [S3,MB4,F]  202-7-209ms    | [S3,MB0,BI] 209-9-218ms    | [S3,MB0,BW] 218-0-218ms    | [S4,MB4,F]  218-7-226ms    | [S4,MB1,BI] 257-11-268ms   | [S4,MB1,BW] 268-0-268ms    | [S3,MB5,F]  269-7-277ms    | [S3,MB1,BI] 277-9-286ms    | [S3,MB1,BW] 286-0-286ms    | [S4,MB5,F]  286-7-293ms    | [S4,MB2,BI] 350-11-361ms   | [S4,MB2,BW] 361-0-361ms    | [S3,MB6,F]  361-7-369ms    | [S3,MB2,BI] 368-9-378ms    | [S3,MB2,BW] 378-0-378ms    | [S4,MB6,F]  379-7-386ms    | [S4,MB3,BI] 421-11-433ms   | [S4,MB3,BW] 433-0-433ms    | [S3,MB7,F]  433-7-441ms    | [S3,MB3,BI] 440-9-450ms    | [S3,MB3,BW] 450-0-450ms    | [S4,MB7,F]  450-7-457ms    | [S4,MB4,BI] 550-10-561ms   | [S4,MB4,BW] 560-0-560ms    | [S3,MB4,BI] 561-9-570ms    | [S4,MB5,BI] 631-10-642ms   | [S3,MB5,BI] 641-9-651ms    | [S4,MB6,BI] 663-9-673ms    | [S3,MB6,BI] 672-9-682ms    | [S4,MB7,BI] 732-9-741ms    | [S3,MB7,BI] 741-9-750ms    | [S3,MB4,BW] 750-0-750ms    | [S4,MB5,BW] 750-0-750ms    | [S4,MB6,BW] 751-0-751ms    | [S4,MB7,BW] 751-0-751ms    | [S3,MB5,BW] 751-0-751ms    | [S3,MB6,BW] 751-0-751ms    | [S3,MB7,BW] 751-0-751ms   
[rank3]:2025-12-26 16:20:22,692 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1620_stage3_step100.svg
[rank0]:2025-12-26 16:20:22,638 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank0_stage7.svg
[rank0]:	> Counts Sum: 6400, Total Sum: 7040 (90.91%), Ratio(%) per element: [93.75, 87.5, 87.5, 93.75, 93.75, 87.5, 100.0, 81.25, 87.5, 100.0, 87.5]
[rank0]:2025-12-26 16:20:22,679 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage0.svg
[rank1]:2025-12-26 16:20:22,700 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-26 16:20:22,747 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage5.svg
[rank3]:2025-12-26 16:20:22,733 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1620_stage4_step100.svg
[rank0]:2025-12-26 16:20:22,716 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage7.svg
[rank1]:2025-12-26 16:20:22,741 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage1.svg
[rank1]:2025-12-26 16:20:22,780 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage6.svg
[rank3]:2025-12-26 16:20:22,840 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank3_stage3.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-26 16:20:22,945 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1620_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-26 16:20:22,986 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage3.svg
[rank3]:2025-12-26 16:20:23,024 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1620_stage4.svg
[rank0]:2025-12-26 16:23:37,693 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-26 16:23:37,939 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.00/0.00, [MB5] 0.00/0.00, [MB3] 0.12/0.19, [MB6] 0.00/0.00, [MB4] 0.46/0.69, [MB5] 0.56/0.83, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-12-26 16:23:37,935 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.20/0.29, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.29/0.44, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-26 16:23:37,935 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.29/0.43, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-26 16:23:37,964 - Current/Expected Freeze Ratio per Block: [MB0] 0.60/0.89, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.00/0.00, [MB0] 0.67/1.00, [MB4] 0.67/1.00, [MB1] 0.67/1.00, [MB5] 0.67/1.00, [MB2] 0.67/1.00, [MB6] 0.67/1.00, [MB3] 0.67/1.00, [MB7] 0.34/0.51, [MB4] 0.45/0.68, [MB5] 0.23/0.34, [MB6] 0.25/0.38, [MB7] 0.67/1.00
[rank1]:2025-12-26 16:23:41,915 - Avg. fwd time: 9.9022 / Avg. bwd-weight time: 10.2840 / Avg. bwd-input time: 12.2872 / Avg. batch time: 995.5302 (ms) / GPU bubble ratio: 47.81%
[rank0]:2025-12-26 16:23:41,926 - Avg. fwd time: 13.5325 / Avg. full-bwd time: 22.4369 (Avg. bwd-weight time: 21.7662 / Avg. bwd-input time: 34.4932) / Avg. batch time: 1021.1120 (ms) / GPU bubble ratio: 17.14%
[rank3]:2025-12-26 16:23:41,907 - Avg. fwd time: 7.7888 / Avg. bwd-weight time: 7.9905 / Avg. bwd-input time: 9.6642 / Avg. batch time: 955.0259 (ms) / GPU bubble ratio: 57.37%
[rank2]:2025-12-26 16:23:41,912 - Avg. fwd time: 8.1639 / Avg. bwd-weight time: 8.2553 / Avg. bwd-input time: 10.0286 / Avg. batch time: 965.5399 (ms) / GPU bubble ratio: 56.17%
[rank1]:2025-12-26 16:23:41,975 -  step: 150  loss: -4.0000  grad_norm: 11.3089  memory: 17.85GiB(37.57%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank0]:2025-12-26 16:23:41,998 -  step: 150  loss:  3.9249  grad_norm: 11.3089  memory: 36.24GiB(76.29%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank3]:2025-12-26 16:23:41,972 -  step: 150  loss: -4.0000  grad_norm: 11.3089  memory: 15.27GiB(32.13%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank2]:2025-12-26 16:23:41,972 -  step: 150  loss: -4.0000  grad_norm: 11.3089  memory: 13.80GiB(29.05%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank0]:2025-12-26 16:26:45,368 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-26 16:26:45,732 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.00/0.00, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.69/0.69, [MB5] 0.83/0.83, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-26 16:26:45,727 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.43/0.43, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 16:26:45,756 - Current/Expected Freeze Ratio per Block: [MB0] 0.89/0.89, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.51/0.51, [MB4] 0.68/0.68, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 1.00/1.00
[rank2]:2025-12-26 16:26:45,728 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.29/0.29, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.44/0.44, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-26 16:26:49,169 - Avg. fwd time: 7.8069 / Avg. bwd-weight time: 7.9025 / Avg. bwd-input time: 9.7031 / Avg. batch time: 925.7606 (ms) / GPU bubble ratio: 56.08%
[rank1]:2025-12-26 16:26:49,176 - Avg. fwd time: 9.9218 / Avg. bwd-weight time: 10.1122 / Avg. bwd-input time: 12.3316 / Avg. batch time: 964.1562 (ms) / GPU bubble ratio: 46.29%
[rank2]:2025-12-26 16:26:49,173 - Avg. fwd time: 8.1620 / Avg. bwd-weight time: 8.2769 / Avg. bwd-input time: 10.0483 / Avg. batch time: 937.1255 (ms) / GPU bubble ratio: 54.78%
[rank3]:2025-12-26 16:26:49,236 -  step: 200  loss: -4.0000  grad_norm:  3.9658  memory: 15.27GiB(32.13%)  tps: 8,749  tflops: 68.40  mfu: 21.92%
[rank1]:2025-12-26 16:26:49,239 -  step: 200  loss: -4.0000  grad_norm:  3.9658  memory: 17.85GiB(37.57%)  tps: 8,749  tflops: 68.40  mfu: 21.92%
[rank0]:2025-12-26 16:26:49,190 - Avg. fwd time: 13.5123 / Avg. full-bwd time: 21.2536 (Avg. bwd-weight time: 18.9142 / Avg. bwd-input time: 34.5373) / Avg. batch time: 989.7902 (ms) / GPU bubble ratio: 17.78%
[rank0]:2025-12-26 16:26:49,262 -  step: 200  loss:  1.1217  grad_norm:  3.9658  memory: 36.24GiB(76.29%)  tps: 8,749  tflops: 68.40  mfu: 21.92%
[rank2]:2025-12-26 16:26:49,236 -  step: 200  loss: -4.0000  grad_norm:  3.9658  memory: 13.82GiB(29.09%)  tps: 8,749  tflops: 68.40  mfu: 21.92%
[rank1]:2025-12-26 16:26:49,315 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1626_stage1_step200.svg
[rank1]:2025-12-26 16:26:49,358 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1626_stage6_step200.svg
[rank0]:2025-12-26 16:26:49,315 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1626_stage0_step200.svg
[rank0]:2025-12-26 16:26:49,357 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1626_stage7_step200.svg
[rank2]:2025-12-26 16:26:49,315 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1626_stage2_step200.svg
[rank2]:2025-12-26 16:26:49,358 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1626_stage5_step200.svg
[rank1]:2025-12-26 16:26:49,485 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank1_stage1.svg
[rank1]:	> Counts Sum: 45400, Total Sum: 103680 (43.79%), Ratio(%) per element: [43.75, 43.75, 47.91, 39.58, 51.04, 48.95, 52.08, 47.91, 46.87, 38.54, 46.87, 37.5, 46.87, 40.62, 40.62, 42.7, 41.66, 40.62, 40.62, 42.7, 43.75, 43.75, 44.79, 47.91, 41.66, 38.54, 40.62]
[rank0]:2025-12-26 16:26:49,459 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank0_stage0.svg
[rank0]:	> Counts Sum: 46200, Total Sum: 72960 (63.32%), Ratio(%) per element: [40.62, 63.54, 71.87, 66.66, 64.58, 62.5, 68.75, 71.87, 66.66, 68.75, 58.33, 63.54, 66.66, 61.45, 56.25, 62.5, 62.5, 67.7, 58.33]
[rank2]:2025-12-26 16:26:49,458 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank2_stage2.svg
[rank2]:	> Counts Sum: 28120, Total Sum: 69120 (40.68%), Ratio(%) per element: [43.75, 46.87, 40.62, 45.83, 45.83, 42.7, 43.75, 44.79, 45.83, 34.37, 35.41, 40.62, 37.5, 37.5, 35.41, 37.5, 37.5, 36.45]
[rank1]:2025-12-26 16:26:49,587 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank1_stage6.svg
[rank1]:	> Counts Sum: 16560, Total Sum: 69120 (23.96%), Ratio(%) per element: [25.0, 25.0, 25.0, 23.95, 25.0, 23.95, 23.95, 25.0, 23.95, 20.83, 22.91, 22.91, 23.95, 23.95, 22.91, 26.04, 22.91, 23.95]
[rank0]:2025-12-26 16:26:49,540 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank0_stage7.svg
[rank0]:	> Counts Sum: 26160, Total Sum: 42240 (61.93%), Ratio(%) per element: [65.62, 64.58, 57.29, 60.41, 60.41, 59.37, 67.7, 58.33, 62.5, 63.54, 61.45]
[rank2]:2025-12-26 16:26:49,558 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank2_stage5.svg
[rank2]:	> Counts Sum: 13720, Total Sum: 69120 (19.85%), Ratio(%) per element: [21.87, 20.83, 17.7, 18.75, 20.83, 17.7, 20.83, 19.79, 21.87, 18.75, 17.7, 20.83, 19.79, 21.87, 19.79, 22.91, 17.7, 17.7]
[rank3]:2025-12-26 16:26:49,606 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1626_step200_rank3.svg
[rank3]:			> Batch Time: 827.76 ms, GPU Bubble Ratio: 24.39%, 38.50%, 48.89%, 50.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-7-41ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 174-1-176ms    | [S7,MB1,F]  176-16-193ms   | [S7,MB1,BI] 205-34-239ms   | [S7,MB1,BW] 239-0-239ms    | [S7,MB2,F]  239-17-257ms   | [S7,MB2,BI] 270-35-305ms   | [S7,MB2,BW] 305-0-305ms    | [S7,MB3,F]  306-18-324ms   | [S7,MB3,BI] 337-35-372ms   | [S7,MB3,BW] 372-32-404ms   | [S0,MB7,F]  403-10-413ms   | [S0,MB0,B]  414-6-420ms    | [S7,MB4,F]  423-19-442ms   | [S7,MB4,BI] 454-35-489ms   | [S7,MB4,BW] 489-0-489ms    | [S0,MB1,B]  496-8-505ms    | [S7,MB5,F]  504-18-523ms   | [S7,MB5,BI] 535-34-569ms   | [S7,MB5,BW] 569-0-569ms    | [S0,MB2,B]  576-5-582ms    | [S7,MB6,F]  590-15-606ms   | [S7,MB6,BI] 618-33-651ms   | [S7,MB6,BW] 651-0-651ms    | [S0,MB3,B]  658-12-670ms   | [S7,MB7,F]  672-15-688ms   | [S7,MB7,BI] 701-33-734ms   | [S7,MB7,BW] 735-2-737ms    | [S0,MB4,B]  744-19-764ms   | [S0,MB5,B]  771-21-792ms   | [S0,MB6,B]  797-23-820ms   | [S0,MB7,B]  823-4-827ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 239-9-248ms    | [S6,MB1,BW] 248-10-259ms   | [S6,MB3,F]  259-7-266ms    | [S6,MB2,BI] 305-9-314ms    | [S6,MB2,BW] 315-10-326ms   | [S1,MB6,F]  325-10-336ms   | [S1,MB0,BI] 336-15-352ms   | [S1,MB0,BW] 352-15-368ms   | [S6,MB4,F]  367-8-376ms    | [S6,MB3,BI] 377-10-387ms   | [S6,MB3,BW] 387-11-398ms   | [S1,MB7,F]  414-14-429ms   | [S1,MB1,BI] 428-15-444ms   | [S1,MB1,BW] 445-15-460ms   | [S6,MB5,F]  460-8-468ms    | [S6,MB4,BI] 489-11-501ms   | [S6,MB4,BW] 501-10-512ms   | [S1,MB2,BI] 512-14-527ms   | [S1,MB2,BW] 527-15-542ms   | [S6,MB6,F]  575-7-583ms    | [S6,MB5,BI] 583-10-593ms   | [S6,MB5,BW] 593-10-603ms   | [S1,MB3,BI] 604-14-619ms   | [S1,MB3,BW] 618-13-632ms   | [S6,MB7,F]  657-7-665ms    | [S6,MB6,BI] 665-10-675ms   | [S6,MB6,BW] 675-11-686ms   | [S1,MB4,BI] 686-14-701ms   | [S6,MB7,BI] 735-10-746ms   | [S1,MB5,BI] 746-14-761ms   | [S1,MB4,BW] 761-5-767ms    | [S1,MB6,BI] 774-14-788ms   | [S1,MB5,BW] 788-4-793ms    | [S1,MB7,BI] 798-14-813ms   | [S1,MB6,BW] 813-0-813ms    | [S6,MB7,BW] 813-0-813ms    | [S1,MB7,BW] 813-0-814ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 249-9-258ms    | [S5,MB1,BW] 258-10-269ms   | [S2,MB5,F]  269-7-276ms    | [S2,MB0,BI] 276-10-287ms   | [S2,MB0,BW] 287-9-296ms    | [S5,MB4,F]  296-7-304ms    | [S5,MB2,BI] 315-11-326ms   | [S5,MB2,BW] 326-10-336ms   | [S2,MB6,F]  338-9-347ms    | [S2,MB1,BI] 350-10-360ms   | [S2,MB1,BW] 361-10-371ms   | [S5,MB5,F]  371-7-379ms    | [S5,MB3,BI] 418-10-429ms   | [S5,MB3,BW] 429-11-441ms   | [S2,MB7,F]  441-7-449ms    | [S2,MB2,BI] 449-10-459ms   | [S2,MB2,BW] 459-9-469ms    | [S5,MB6,F]  469-7-477ms    | [S5,MB4,BI] 501-10-512ms   | [S5,MB4,BW] 512-9-522ms    | [S2,MB3,BI] 579-9-588ms    | [S2,MB3,BW] 588-10-599ms   | [S5,MB7,F]  603-7-610ms    | [S5,MB5,BI] 610-9-620ms    | [S5,MB5,BW] 620-9-630ms    | [S2,MB4,BI] 660-9-670ms    | [S5,MB6,BI] 675-10-686ms   | [S2,MB5,BI] 686-10-696ms   | [S5,MB7,BI] 747-9-756ms    | [S2,MB6,BI] 756-10-767ms   | [S2,MB4,BW] 767-7-774ms    | [S2,MB7,BI] 782-9-791ms    | [S2,MB5,BW] 792-0-792ms    | [S5,MB6,BW] 792-10-802ms   | [S5,MB7,BW] 802-6-808ms    | [S2,MB6,BW] 808-0-808ms    | [S2,MB7,BW] 808-1-809ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 258-11-269ms   | [S4,MB1,BW] 269-10-280ms   | [S3,MB5,F]  280-8-288ms    | [S3,MB1,BI] 288-10-298ms   | [S3,MB1,BW] 298-10-308ms   | [S4,MB5,F]  308-8-317ms    | [S4,MB2,BI] 342-11-354ms   | [S4,MB2,BW] 354-9-364ms    | [S3,MB6,F]  364-7-372ms    | [S3,MB2,BI] 371-9-381ms    | [S3,MB2,BW] 381-10-391ms   | [S4,MB6,F]  391-8-400ms    | [S4,MB3,BI] 434-10-445ms   | [S4,MB3,BW] 444-10-455ms   | [S3,MB7,F]  455-7-462ms    | [S3,MB3,BI] 462-9-472ms    | [S3,MB3,BW] 472-9-482ms    | [S4,MB7,F]  482-7-490ms    | [S4,MB4,BI] 572-10-582ms   | [S4,MB4,BW] 582-9-592ms    | [S3,MB4,BI] 592-10-603ms   | [S4,MB5,BI] 654-10-664ms   | [S3,MB5,BI] 664-9-673ms    | [S4,MB6,BI] 686-9-696ms    | [S3,MB6,BI] 696-9-705ms    | [S4,MB7,BI] 757-9-766ms    | [S3,MB7,BI] 767-9-776ms    | [S3,MB4,BW] 776-1-777ms    | [S4,MB5,BW] 777-10-787ms   | [S4,MB6,BW] 787-9-796ms    | [S4,MB7,BW] 797-7-804ms    | [S3,MB5,BW] 804-1-806ms    | [S3,MB6,BW] 805-1-806ms    | [S3,MB7,BW] 807-0-807ms   
[rank3]:2025-12-26 16:26:49,651 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1626_stage3_step200.svg
[rank3]:2025-12-26 16:26:49,694 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1626_stage4_step200.svg
[rank1]:2025-12-26 16:26:49,758 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage1.svg
[rank0]:2025-12-26 16:26:49,712 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage0.svg
[rank2]:2025-12-26 16:26:49,729 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage2.svg
[rank3]:2025-12-26 16:26:49,798 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank3_stage3.svg
[rank3]:	> Counts Sum: 31680, Total Sum: 69120 (45.83%), Ratio(%) per element: [42.7, 44.79, 51.04, 46.87, 47.91, 50.0, 46.87, 50.0, 44.79, 42.7, 42.7, 52.08, 42.7, 44.79, 40.62, 47.91, 43.75, 42.7]
[rank0]:2025-12-26 16:26:49,880 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage7.svg
[rank2]:2025-12-26 16:26:49,891 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage5.svg
[rank3]:2025-12-26 16:26:49,901 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1626_rank3_stage4.svg
[rank3]:	> Counts Sum: 13720, Total Sum: 69120 (19.85%), Ratio(%) per element: [19.79, 20.83, 20.83, 21.87, 22.91, 17.7, 25.0, 21.87, 22.91, 19.79, 17.7, 16.66, 16.66, 18.75, 16.66, 19.79, 17.7, 19.79]
[rank1]:2025-12-26 16:26:49,923 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage6.svg
[rank3]:2025-12-26 16:26:50,073 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage3.svg
[rank3]:2025-12-26 16:26:50,240 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1626_stage4.svg
[rank0]:2025-12-26 16:29:38,156 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-26 16:29:38,632 - Current/Expected Freeze Ratio per Block: [MB0] 0.89/0.89, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.51/0.51, [MB4] 0.68/0.68, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 1.00/1.00
[rank2]:2025-12-26 16:29:38,606 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.29/0.29, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.44/0.44, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-26 16:29:38,610 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.00/0.00, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.69/0.69, [MB5] 0.83/0.83, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-26 16:29:38,606 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.43/0.43, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 16:29:41,941 - Avg. fwd time: 13.4132 / Avg. full-bwd time: 18.5038 (Avg. bwd-weight time: 16.5246 / Avg. bwd-input time: 34.4314) / Avg. batch time: 955.9280 (ms) / GPU bubble ratio: 19.42%
[rank2]:2025-12-26 16:29:41,940 - Avg. fwd time: 8.1649 / Avg. bwd-weight time: 8.2225 / Avg. bwd-input time: 10.0825 / Avg. batch time: 906.9172 (ms) / GPU bubble ratio: 53.30%
[rank2]:2025-12-26 16:29:41,987 -  step: 250  loss: -4.0000  grad_norm:  1.0901  memory: 13.82GiB(29.09%)  tps: 9,484  tflops: 74.14  mfu: 23.76%
[rank1]:2025-12-26 16:29:41,940 - Avg. fwd time: 9.9482 / Avg. bwd-weight time: 9.8540 / Avg. bwd-input time: 12.4011 / Avg. batch time: 931.8842 (ms) / GPU bubble ratio: 44.71%
[rank3]:2025-12-26 16:29:41,935 - Avg. fwd time: 7.8251 / Avg. bwd-weight time: 7.7594 / Avg. bwd-input time: 9.7465 / Avg. batch time: 894.4470 (ms) / GPU bubble ratio: 54.69%
[rank1]:2025-12-26 16:29:41,990 -  step: 250  loss: -4.0000  grad_norm:  1.0901  memory: 17.85GiB(37.57%)  tps: 9,484  tflops: 74.14  mfu: 23.76%
[rank3]:2025-12-26 16:29:41,987 -  step: 250  loss: -4.0000  grad_norm:  1.0901  memory: 15.27GiB(32.13%)  tps: 9,484  tflops: 74.14  mfu: 23.76%
[rank0]:2025-12-26 16:29:42,012 -  step: 250  loss:  0.3827  grad_norm:  1.0901  memory: 36.24GiB(76.29%)  tps: 9,484  tflops: 74.14  mfu: 23.76%
[rank0]:2025-12-26 16:32:27,759 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 16:32:28,271 - Current/Expected Freeze Ratio per Block: [MB0] 0.89/0.89, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.51/0.51, [MB4] 0.68/0.68, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 1.00/1.00
[rank1]:2025-12-26 16:32:28,249 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.00/0.00, [MB3] 0.00/0.00, [MB1] 0.00/0.00, [MB4] 0.00/0.00, [MB2] 0.00/0.00, [MB5] 0.00/0.00, [MB3] 0.19/0.19, [MB6] 0.00/0.00, [MB4] 0.69/0.69, [MB5] 0.83/0.83, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-26 16:32:28,245 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.29/0.29, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.44/0.44, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-26 16:32:28,245 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.43/0.43, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-26 16:32:31,668 - Avg. fwd time: 13.3338 / Avg. full-bwd time: 16.6014 (Avg. bwd-weight time: 14.7701 / Avg. bwd-input time: 34.3532) / Avg. batch time: 931.4097 (ms) / GPU bubble ratio: 20.64%
[rank1]:2025-12-26 16:32:31,666 - Avg. fwd time: 9.9690 / Avg. bwd-weight time: 9.6938 / Avg. bwd-input time: 12.4526 / Avg. batch time: 908.5679 (ms) / GPU bubble ratio: 43.44%
[rank2]:2025-12-26 16:32:31,665 - Avg. fwd time: 8.1663 / Avg. bwd-weight time: 8.1667 / Avg. bwd-input time: 10.1065 / Avg. batch time: 884.8279 (ms) / GPU bubble ratio: 52.19%
[rank3]:2025-12-26 16:32:31,663 - Avg. fwd time: 7.8388 / Avg. bwd-weight time: 7.6747 / Avg. bwd-input time: 9.7829 / Avg. batch time: 872.0996 (ms) / GPU bubble ratio: 53.59%
[rank0]:2025-12-26 16:32:31,737 -  step: 300  loss:  0.2865  grad_norm:  0.2944  memory: 36.24GiB(76.29%)  tps: 9,653  tflops: 75.47  mfu: 24.19%
[rank0]:2025-12-26 16:32:31,790 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1632_stage0_step300.svg
[rank1]:2025-12-26 16:32:31,716 -  step: 300  loss: -4.0000  grad_norm:  0.2944  memory: 17.85GiB(37.57%)  tps: 9,653  tflops: 75.46  mfu: 24.19%
[rank1]:2025-12-26 16:32:31,790 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1632_stage1_step300.svg
[rank2]:2025-12-26 16:32:31,713 -  step: 300  loss: -4.0000  grad_norm:  0.2944  memory: 13.82GiB(29.09%)  tps: 9,653  tflops: 75.46  mfu: 24.19%
[rank2]:2025-12-26 16:32:31,790 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1632_stage2_step300.svg
[rank3]:2025-12-26 16:32:31,713 -  step: 300  loss: -4.0000  grad_norm:  0.2944  memory: 15.27GiB(32.13%)  tps: 9,653  tflops: 75.46  mfu: 24.19%
[rank0]:2025-12-26 16:32:31,848 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1632_stage7_step300.svg
[rank1]:2025-12-26 16:32:31,859 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1632_stage6_step300.svg
[rank2]:2025-12-26 16:32:31,859 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1632_stage5_step300.svg
[rank0]:2025-12-26 16:32:31,953 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank0_stage0.svg
[rank0]:	> Counts Sum: 95000, Total Sum: 133760 (71.02%), Ratio(%) per element: [55.11, 73.86, 75.56, 73.86, 75.0, 74.43, 73.29, 79.54, 75.56, 77.84, 65.9, 69.31, 70.45, 67.04, 67.61, 69.88, 68.18, 71.02, 65.9]
[rank1]:2025-12-26 16:32:31,987 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank1_stage1.svg
[rank1]:	> Counts Sum: 85800, Total Sum: 190080 (45.14%), Ratio(%) per element: [44.88, 44.88, 47.72, 42.04, 51.13, 47.15, 50.56, 50.0, 46.02, 43.18, 47.15, 41.47, 46.02, 44.88, 44.31, 44.88, 45.45, 43.18, 42.61, 42.61, 44.88, 45.45, 44.88, 46.02, 43.75, 42.04, 41.47]
[rank2]:2025-12-26 16:32:31,959 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank2_stage2.svg
[rank2]:	> Counts Sum: 51720, Total Sum: 126720 (40.81%), Ratio(%) per element: [42.61, 44.31, 41.47, 44.31, 44.31, 40.9, 44.31, 42.61, 44.88, 36.93, 38.06, 40.34, 38.63, 39.2, 37.5, 38.06, 38.63, 37.5]
[rank0]:2025-12-26 16:32:32,033 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank0_stage7.svg
[rank0]:	> Counts Sum: 54560, Total Sum: 77440 (70.45%), Ratio(%) per element: [72.72, 73.29, 67.61, 68.75, 69.31, 67.04, 75.0, 69.88, 70.45, 72.15, 68.75]
[rank1]:2025-12-26 16:32:32,087 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank1_stage6.svg
[rank1]:	> Counts Sum: 23760, Total Sum: 126720 (18.75%), Ratio(%) per element: [19.31, 19.31, 19.31, 18.75, 19.31, 18.75, 18.75, 19.31, 18.75, 17.04, 18.18, 18.18, 18.75, 18.75, 18.18, 19.88, 18.18, 18.75]
[rank2]:2025-12-26 16:32:32,059 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank2_stage5.svg
[rank2]:	> Counts Sum: 16920, Total Sum: 126720 (13.35%), Ratio(%) per element: [15.34, 13.63, 12.5, 13.06, 13.06, 13.06, 15.34, 14.2, 15.9, 11.36, 12.5, 14.2, 13.06, 13.63, 12.5, 14.2, 10.79, 11.93]
[rank3]:2025-12-26 16:32:32,063 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1632_step300_rank3.svg
[rank3]:			> Batch Time: 815.00 ms, GPU Bubble Ratio: 28.19%, 38.00%, 48.49%, 50.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-16-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-1-176ms    | [S7,MB1,F]  176-15-191ms   | [S7,MB1,BI] 203-34-237ms   | [S7,MB1,BW] 238-0-238ms    | [S7,MB2,F]  238-17-255ms   | [S7,MB2,BI] 267-35-303ms   | [S7,MB2,BW] 303-0-303ms    | [S7,MB3,F]  303-18-322ms   | [S7,MB3,BI] 335-35-370ms   | [S7,MB3,BW] 370-31-401ms   | [S0,MB7,F]  400-10-410ms   | [S0,MB0,B]  410-0-410ms    | [S7,MB4,F]  417-18-436ms   | [S7,MB4,BI] 448-34-482ms   | [S7,MB4,BW] 482-0-482ms    | [S0,MB1,B]  489-0-489ms    | [S7,MB5,F]  493-16-509ms   | [S7,MB5,BI] 522-33-555ms   | [S7,MB5,BW] 556-0-556ms    | [S0,MB2,B]  562-0-562ms    | [S7,MB6,F]  577-14-591ms   | [S7,MB6,BI] 603-33-636ms   | [S7,MB6,BW] 637-0-637ms    | [S0,MB3,B]  644-0-644ms    | [S7,MB7,F]  658-14-672ms   | [S7,MB7,BI] 684-33-717ms   | [S7,MB7,BW] 716-25-741ms   | [S0,MB4,B]  740-22-762ms   | [S0,MB5,B]  762-15-778ms   | [S0,MB6,B]  790-14-804ms   | [S0,MB7,B]  815-0-815ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 238-9-247ms    | [S6,MB1,BW] 247-10-258ms   | [S6,MB3,F]  258-7-265ms    | [S6,MB2,BI] 303-9-312ms    | [S6,MB2,BW] 312-10-323ms   | [S1,MB6,F]  323-10-334ms   | [S1,MB0,BI] 334-15-350ms   | [S1,MB0,BW] 350-15-365ms   | [S6,MB4,F]  365-9-374ms    | [S6,MB3,BI] 374-10-385ms   | [S6,MB3,BW] 385-11-396ms   | [S1,MB7,F]  410-15-425ms   | [S1,MB1,BI] 425-16-441ms   | [S1,MB1,BW] 441-15-457ms   | [S6,MB5,F]  457-8-465ms    | [S6,MB4,BI] 482-12-494ms   | [S6,MB4,BW] 494-10-504ms   | [S1,MB2,BI] 505-14-519ms   | [S1,MB2,BW] 519-15-535ms   | [S6,MB6,F]  562-7-569ms    | [S6,MB5,BI] 569-10-580ms   | [S6,MB5,BW] 580-10-590ms   | [S1,MB3,BI] 590-14-605ms   | [S1,MB3,BW] 605-12-617ms   | [S6,MB7,F]  643-7-650ms    | [S6,MB6,BI] 651-10-661ms   | [S6,MB6,BW] 661-11-672ms   | [S1,MB4,BI] 672-15-687ms   | [S6,MB7,BI] 718-9-727ms    | [S1,MB5,BI] 738-15-753ms   | [S1,MB4,BW] 753-4-758ms    | [S1,MB6,BI] 768-14-782ms   | [S1,MB5,BW] 782-3-786ms    | [S1,MB7,BI] 793-14-807ms   | [S1,MB6,BW] 807-0-807ms    | [S6,MB7,BW] 807-0-807ms    | [S1,MB7,BW] 807-0-807ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 247-9-257ms    | [S5,MB1,BW] 257-10-268ms   | [S2,MB5,F]  268-7-275ms    | [S2,MB0,BI] 275-10-285ms   | [S2,MB0,BW] 285-9-295ms    | [S5,MB4,F]  295-7-303ms    | [S5,MB2,BI] 312-11-324ms   | [S5,MB2,BW] 323-10-334ms   | [S2,MB6,F]  335-9-345ms    | [S2,MB1,BI] 347-10-358ms   | [S2,MB1,BW] 358-10-368ms   | [S5,MB5,F]  368-7-376ms    | [S5,MB3,BI] 414-10-425ms   | [S5,MB3,BW] 425-11-437ms   | [S2,MB7,F]  437-7-444ms    | [S2,MB2,BI] 444-10-455ms   | [S2,MB2,BW] 455-9-465ms    | [S5,MB6,F]  465-7-473ms    | [S5,MB4,BI] 494-10-504ms   | [S5,MB4,BW] 505-9-515ms    | [S2,MB3,BI] 564-9-574ms    | [S2,MB3,BW] 574-10-585ms   | [S5,MB7,F]  589-7-596ms    | [S5,MB5,BI] 596-9-606ms    | [S5,MB5,BW] 606-9-616ms    | [S2,MB4,BI] 646-9-656ms    | [S5,MB6,BI] 661-10-672ms   | [S2,MB5,BI] 672-10-682ms   | [S5,MB7,BI] 740-9-750ms    | [S2,MB6,BI] 750-11-761ms   | [S2,MB4,BW] 761-6-768ms    | [S2,MB7,BI] 776-9-786ms    | [S2,MB5,BW] 786-0-786ms    | [S5,MB6,BW] 786-10-796ms   | [S5,MB7,BW] 796-5-802ms    | [S2,MB6,BW] 802-0-802ms    | [S2,MB7,BW] 802-0-802ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  239-8-247ms    | [S4,MB1,BI] 257-11-268ms   | [S4,MB1,BW] 268-10-279ms   | [S3,MB5,F]  279-8-287ms    | [S3,MB1,BI] 287-10-297ms   | [S3,MB1,BW] 297-10-308ms   | [S4,MB5,F]  308-8-317ms    | [S4,MB2,BI] 340-12-352ms   | [S4,MB2,BW] 351-9-361ms    | [S3,MB6,F]  361-7-368ms    | [S3,MB2,BI] 368-9-378ms    | [S3,MB2,BW] 378-10-388ms   | [S4,MB6,F]  388-8-397ms    | [S4,MB3,BI] 431-10-441ms   | [S4,MB3,BW] 441-10-452ms   | [S3,MB7,F]  452-7-459ms    | [S3,MB3,BI] 459-9-469ms    | [S3,MB3,BW] 469-9-479ms    | [S4,MB7,F]  479-7-487ms    | [S4,MB4,BI] 558-10-569ms   | [S4,MB4,BW] 569-9-578ms    | [S3,MB4,BI] 578-10-589ms   | [S4,MB5,BI] 640-10-650ms   | [S3,MB5,BI] 650-9-659ms    | [S4,MB6,BI] 672-9-681ms    | [S3,MB6,BI] 682-9-691ms    | [S4,MB7,BI] 752-9-761ms    | [S3,MB7,BI] 761-9-770ms    | [S3,MB4,BW] 770-0-770ms    | [S4,MB5,BW] 770-10-780ms   | [S4,MB6,BW] 780-9-790ms    | [S4,MB7,BW] 790-4-795ms    | [S3,MB5,BW] 796-0-796ms    | [S3,MB6,BW] 796-0-796ms    | [S3,MB7,BW] 796-0-796ms   
[rank3]:2025-12-26 16:32:32,106 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1632_stage3_step300.svg
[rank3]:2025-12-26 16:32:32,148 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1632_stage4_step300.svg
[rank3]:2025-12-26 16:32:32,249 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank3_stage3.svg
[rank3]:	> Counts Sum: 60480, Total Sum: 126720 (47.73%), Ratio(%) per element: [46.02, 47.15, 50.56, 48.29, 48.86, 50.0, 48.29, 50.0, 47.15, 46.02, 46.02, 51.13, 46.02, 47.15, 44.88, 48.86, 46.59, 46.02]
[rank0]:2025-12-26 16:32:32,337 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage0.svg
[rank1]:2025-12-26 16:32:32,389 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage1.svg
[rank2]:2025-12-26 16:32:32,357 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage2.svg
[rank3]:2025-12-26 16:32:32,350 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1632_rank3_stage4.svg
[rank3]:	> Counts Sum: 16920, Total Sum: 126720 (13.35%), Ratio(%) per element: [15.34, 14.2, 13.63, 14.77, 16.47, 13.06, 15.9, 15.34, 17.04, 13.06, 11.36, 11.93, 11.36, 11.93, 10.79, 11.93, 10.22, 11.93]
[rank0]:2025-12-26 16:32:32,634 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage7.svg
[rank1]:2025-12-26 16:32:32,683 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage6.svg
[rank2]:2025-12-26 16:32:32,642 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage5.svg
[rank3]:2025-12-26 16:32:32,651 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage3.svg
[rank3]:2025-12-26 16:32:32,938 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1632_stage4.svg
[rank0]:2025-12-26 16:35:18,987 - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-12-26 16:35:22,754 - Avg. fwd time: 13.2741 / Avg. full-bwd time: 15.2944 (Avg. bwd-weight time: 13.4089 / Avg. bwd-input time: 34.2946) / Avg. batch time: 914.2040 (ms) / GPU bubble ratio: 21.64%
[rank2]:2025-12-26 16:35:22,753 - Avg. fwd time: 8.1676 / Avg. bwd-weight time: 8.1379 / Avg. bwd-input time: 10.1224 / Avg. batch time: 869.5887 (ms) / GPU bubble ratio: 51.37%
[rank2]:2025-12-26 16:35:22,799 -  step: 350  loss: -4.0000  grad_norm:  0.1402  memory: 13.82GiB(29.09%)  tps: 9,576  tflops: 74.86  mfu: 24.00%
[rank3]:2025-12-26 16:35:22,747 - Avg. fwd time: 7.8491 / Avg. bwd-weight time: 7.6120 / Avg. bwd-input time: 9.8075 / Avg. batch time: 856.3644 (ms) / GPU bubble ratio: 52.79%
[rank3]:2025-12-26 16:35:22,799 -  step: 350  loss: -4.0000  grad_norm:  0.1402  memory: 15.27GiB(32.13%)  tps: 9,576  tflops: 74.86  mfu: 24.00%
[rank1]:2025-12-26 16:35:22,753 - Avg. fwd time: 9.9835 / Avg. bwd-weight time: 9.5806 / Avg. bwd-input time: 12.4895 / Avg. batch time: 892.3379 (ms) / GPU bubble ratio: 42.53%
[rank1]:2025-12-26 16:35:22,803 -  step: 350  loss: -4.0000  grad_norm:  0.1402  memory: 17.85GiB(37.57%)  tps: 9,576  tflops: 74.86  mfu: 24.00%
[rank0]:2025-12-26 16:35:22,824 -  step: 350  loss:  0.2348  grad_norm:  0.1402  memory: 36.24GiB(76.29%)  tps: 9,576  tflops: 74.86  mfu: 24.00%
[rank0]:2025-12-26 16:38:08,870 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 16:38:12,807 - Avg. fwd time: 13.2284 / Avg. full-bwd time: 14.3118 (Avg. bwd-weight time: 12.4807 / Avg. bwd-input time: 34.2530) / Avg. batch time: 901.2276 (ms) / GPU bubble ratio: 22.33%
[rank2]:2025-12-26 16:38:12,804 - Avg. fwd time: 8.1688 / Avg. bwd-weight time: 8.1148 / Avg. bwd-input time: 10.1352 / Avg. batch time: 858.0203 (ms) / GPU bubble ratio: 50.74%
[rank3]:2025-12-26 16:38:12,801 - Avg. fwd time: 7.8590 / Avg. bwd-weight time: 7.5638 / Avg. bwd-input time: 9.8278 / Avg. batch time: 844.5511 (ms) / GPU bubble ratio: 52.16%
[rank1]:2025-12-26 16:38:12,807 - Avg. fwd time: 9.9956 / Avg. bwd-weight time: 9.4880 / Avg. bwd-input time: 12.5156 / Avg. batch time: 880.0599 (ms) / GPU bubble ratio: 41.82%
[rank0]:2025-12-26 16:38:12,860 -  step: 400  loss:  0.2209  grad_norm:  0.3637  memory: 36.24GiB(76.29%)  tps: 9,636  tflops: 75.33  mfu: 24.14%
[rank2]:2025-12-26 16:38:12,849 -  step: 400  loss: -4.0000  grad_norm:  0.3637  memory: 13.82GiB(29.09%)  tps: 9,635  tflops: 75.32  mfu: 24.14%
[rank2]:2025-12-26 16:38:12,917 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1638_stage2_step400.svg
[rank3]:2025-12-26 16:38:12,849 -  step: 400  loss: -4.0000  grad_norm:  0.3637  memory: 15.27GiB(32.13%)  tps: 9,635  tflops: 75.32  mfu: 24.14%
[rank1]:2025-12-26 16:38:12,852 -  step: 400  loss: -4.0000  grad_norm:  0.3637  memory: 17.85GiB(37.57%)  tps: 9,635  tflops: 75.32  mfu: 24.14%
[rank1]:2025-12-26 16:38:12,917 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1638_stage1_step400.svg
[rank0]:2025-12-26 16:38:12,916 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1638_stage0_step400.svg
[rank0]:2025-12-26 16:38:12,960 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1638_stage7_step400.svg
[rank2]:2025-12-26 16:38:12,964 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1638_stage5_step400.svg
[rank1]:2025-12-26 16:38:12,963 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1638_stage6_step400.svg
[rank0]:2025-12-26 16:38:13,065 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank0_stage0.svg
[rank0]:	> Counts Sum: 143800, Total Sum: 194560 (73.91%), Ratio(%) per element: [58.98, 78.12, 78.9, 78.51, 77.73, 78.12, 76.17, 82.81, 78.9, 80.46, 71.09, 70.7, 70.7, 69.14, 70.31, 71.87, 71.09, 72.65, 67.96]
[rank2]:2025-12-26 16:38:13,065 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank2_stage2.svg
[rank2]:	> Counts Sum: 75320, Total Sum: 184320 (40.86%), Ratio(%) per element: [42.96, 42.96, 41.4, 43.75, 43.35, 41.01, 43.75, 42.96, 43.35, 38.28, 39.45, 40.23, 38.67, 39.84, 37.5, 39.06, 39.45, 37.5]
[rank1]:2025-12-26 16:38:13,092 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank1_stage1.svg
[rank1]:	> Counts Sum: 126200, Total Sum: 276480 (45.65%), Ratio(%) per element: [45.7, 45.7, 49.21, 43.75, 50.0, 48.82, 49.6, 48.82, 47.26, 44.14, 47.26, 43.35, 48.04, 47.26, 44.53, 46.87, 46.48, 44.14, 44.14, 42.57, 43.75, 45.7, 44.53, 45.7, 42.18, 41.79, 41.01]
[rank0]:2025-12-26 16:38:13,146 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank0_stage7.svg
[rank0]:	> Counts Sum: 82960, Total Sum: 112640 (73.65%), Ratio(%) per element: [75.78, 75.39, 71.48, 73.04, 73.04, 71.09, 76.17, 73.43, 74.21, 73.82, 72.65]
[rank2]:2025-12-26 16:38:13,164 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank2_stage5.svg
[rank2]:	> Counts Sum: 20120, Total Sum: 184320 (10.92%), Ratio(%) per element: [12.5, 11.32, 11.71, 11.32, 10.54, 10.54, 12.1, 11.71, 12.1, 8.98, 10.15, 11.71, 10.54, 11.32, 10.15, 10.54, 9.76, 9.37]
[rank3]:2025-12-26 16:38:13,195 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1638_step400_rank3.svg
[rank3]:			> Batch Time: 803.00 ms, GPU Bubble Ratio: 29.61%, 36.92%, 47.47%, 49.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-130ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-0-174ms    | [S7,MB1,F]  175-15-190ms   | [S7,MB1,BI] 203-34-237ms   | [S7,MB1,BW] 237-0-237ms    | [S7,MB2,F]  237-17-255ms   | [S7,MB2,BI] 267-35-303ms   | [S7,MB2,BW] 303-0-303ms    | [S7,MB3,F]  303-19-322ms   | [S7,MB3,BI] 334-35-370ms   | [S7,MB3,BW] 370-30-400ms   | [S0,MB7,F]  400-10-410ms   | [S0,MB0,B]  410-0-410ms    | [S7,MB4,F]  417-18-435ms   | [S7,MB4,BI] 447-34-481ms   | [S7,MB4,BW] 481-0-481ms    | [S0,MB1,B]  488-0-488ms    | [S7,MB5,F]  492-17-509ms   | [S7,MB5,BI] 521-33-554ms   | [S7,MB5,BW] 555-0-555ms    | [S0,MB2,B]  561-0-561ms    | [S7,MB6,F]  576-15-591ms   | [S7,MB6,BI] 603-33-636ms   | [S7,MB6,BW] 636-0-636ms    | [S0,MB3,B]  642-0-642ms    | [S7,MB7,F]  657-14-672ms   | [S7,MB7,BI] 683-33-716ms   | [S7,MB7,BW] 716-3-720ms    | [S0,MB4,B]  729-10-739ms   | [S0,MB5,B]  751-21-772ms   | [S0,MB6,B]  778-20-798ms   | [S0,MB7,B]  803-0-803ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 237-9-247ms    | [S6,MB1,BW] 247-10-257ms   | [S6,MB3,F]  257-7-264ms    | [S6,MB2,BI] 303-9-312ms    | [S6,MB2,BW] 312-10-323ms   | [S1,MB6,F]  323-11-334ms   | [S1,MB0,BI] 334-16-350ms   | [S1,MB0,BW] 350-15-365ms   | [S6,MB4,F]  365-8-374ms    | [S6,MB3,BI] 374-10-384ms   | [S6,MB3,BW] 384-11-395ms   | [S1,MB7,F]  410-14-425ms   | [S1,MB1,BI] 425-16-441ms   | [S1,MB1,BW] 441-15-456ms   | [S6,MB5,F]  457-8-465ms    | [S6,MB4,BI] 481-12-493ms   | [S6,MB4,BW] 493-10-504ms   | [S1,MB2,BI] 504-14-518ms   | [S1,MB2,BW] 518-15-534ms   | [S6,MB6,F]  561-7-568ms    | [S6,MB5,BI] 569-10-579ms   | [S6,MB5,BW] 579-10-589ms   | [S1,MB3,BI] 590-14-605ms   | [S1,MB3,BW] 604-13-618ms   | [S6,MB7,F]  642-7-649ms    | [S6,MB6,BI] 650-10-660ms   | [S6,MB6,BW] 660-10-671ms   | [S1,MB4,BI] 671-15-686ms   | [S6,MB7,BI] 717-10-728ms   | [S1,MB5,BI] 727-15-742ms   | [S1,MB4,BW] 743-4-748ms    | [S1,MB6,BI] 756-14-771ms   | [S1,MB5,BW] 770-2-772ms    | [S1,MB7,BI] 780-14-795ms   | [S1,MB6,BW] 795-0-795ms    | [S6,MB7,BW] 795-0-795ms    | [S1,MB7,BW] 795-0-795ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 247-9-256ms    | [S5,MB1,BW] 256-10-267ms   | [S2,MB5,F]  267-7-275ms    | [S2,MB0,BI] 275-10-285ms   | [S2,MB0,BW] 285-9-295ms    | [S5,MB4,F]  295-7-303ms    | [S5,MB2,BI] 312-11-323ms   | [S5,MB2,BW] 323-10-334ms   | [S2,MB6,F]  335-9-345ms    | [S2,MB1,BI] 347-10-357ms   | [S2,MB1,BW] 357-10-367ms   | [S5,MB5,F]  368-7-375ms    | [S5,MB3,BI] 414-10-425ms   | [S5,MB3,BW] 425-11-436ms   | [S2,MB7,F]  437-7-444ms    | [S2,MB2,BI] 444-10-455ms   | [S2,MB2,BW] 455-9-465ms    | [S5,MB6,F]  465-7-472ms    | [S5,MB4,BI] 493-10-504ms   | [S5,MB4,BW] 504-9-514ms    | [S2,MB3,BI] 564-9-574ms    | [S2,MB3,BW] 574-10-584ms   | [S5,MB7,F]  589-7-596ms    | [S5,MB5,BI] 596-9-606ms    | [S5,MB5,BW] 606-9-615ms    | [S2,MB4,BI] 645-9-655ms    | [S5,MB6,BI] 661-10-671ms   | [S2,MB5,BI] 671-10-681ms   | [S5,MB7,BI] 729-9-738ms    | [S2,MB6,BI] 738-10-749ms   | [S2,MB4,BW] 749-9-758ms    | [S2,MB7,BI] 765-9-774ms    | [S2,MB5,BW] 774-0-774ms    | [S5,MB6,BW] 774-10-785ms   | [S5,MB7,BW] 785-3-788ms    | [S2,MB6,BW] 789-0-789ms    | [S2,MB7,BW] 789-0-789ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-106ms     | [S4,MB3,F]  105-8-114ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  238-8-247ms    | [S4,MB1,BI] 257-11-268ms   | [S4,MB1,BW] 268-10-279ms   | [S3,MB5,F]  278-8-287ms    | [S3,MB1,BI] 287-10-297ms   | [S3,MB1,BW] 297-10-308ms   | [S4,MB5,F]  308-8-317ms    | [S4,MB2,BI] 339-11-351ms   | [S4,MB2,BW] 352-9-361ms    | [S3,MB6,F]  361-7-369ms    | [S3,MB2,BI] 369-9-379ms    | [S3,MB2,BW] 379-10-389ms   | [S4,MB6,F]  389-8-398ms    | [S4,MB3,BI] 430-10-441ms   | [S4,MB3,BW] 441-10-452ms   | [S3,MB7,F]  452-7-459ms    | [S3,MB3,BI] 459-9-469ms    | [S3,MB3,BW] 469-9-479ms    | [S4,MB7,F]  479-8-487ms    | [S4,MB4,BI] 558-10-568ms   | [S4,MB4,BW] 568-9-577ms    | [S3,MB4,BI] 578-10-588ms   | [S4,MB5,BI] 638-10-648ms   | [S3,MB5,BI] 649-9-658ms    | [S4,MB6,BI] 671-9-681ms    | [S3,MB6,BI] 681-9-690ms    | [S4,MB7,BI] 740-9-749ms    | [S3,MB7,BI] 749-9-758ms    | [S3,MB4,BW] 758-0-758ms    | [S4,MB5,BW] 758-10-768ms   | [S4,MB6,BW] 768-9-778ms    | [S4,MB7,BW] 778-5-783ms    | [S3,MB5,BW] 783-0-783ms    | [S3,MB6,BW] 783-0-783ms    | [S3,MB7,BW] 783-0-783ms   
[rank1]:2025-12-26 16:38:13,193 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank1_stage6.svg
[rank1]:	> Counts Sum: 30960, Total Sum: 184320 (16.80%), Ratio(%) per element: [17.18, 17.18, 17.18, 16.79, 17.18, 16.79, 16.79, 17.18, 16.79, 15.62, 16.4, 16.4, 16.79, 16.79, 16.4, 17.57, 16.4, 16.79]
[rank3]:2025-12-26 16:38:13,243 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1638_stage3_step400.svg
[rank3]:2025-12-26 16:38:13,289 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1638_stage4_step400.svg
[rank3]:2025-12-26 16:38:13,394 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank3_stage3.svg
[rank3]:	> Counts Sum: 89280, Total Sum: 184320 (48.44%), Ratio(%) per element: [47.26, 48.04, 50.39, 48.82, 49.21, 50.0, 48.82, 50.0, 48.04, 47.26, 47.26, 50.78, 47.26, 48.04, 46.48, 49.21, 47.65, 47.26]
[rank3]:2025-12-26 16:38:13,497 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1638_rank3_stage4.svg
[rank3]:	> Counts Sum: 20120, Total Sum: 184320 (10.92%), Ratio(%) per element: [12.89, 12.89, 12.89, 11.71, 14.06, 11.71, 13.28, 13.28, 14.45, 8.98, 8.59, 9.37, 7.81, 8.59, 8.59, 9.37, 8.2, 9.76]
[rank0]:2025-12-26 16:38:13,594 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage0.svg
[rank2]:2025-12-26 16:38:13,589 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage2.svg
[rank1]:2025-12-26 16:38:13,623 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage1.svg
[rank2]:2025-12-26 16:38:14,014 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage5.svg
[rank3]:2025-12-26 16:38:13,966 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage3.svg
[rank0]:2025-12-26 16:38:14,052 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage7.svg
[rank1]:2025-12-26 16:38:14,067 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage6.svg
[rank3]:2025-12-26 16:38:14,386 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1638_stage4.svg
[rank0]:2025-12-26 16:38:33,220 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-26 16:38:33,779 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-26 16:38:33,777 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-26 16:38:33,785 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-26 16:41:01,110 - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-12-26 16:41:04,919 - Avg. fwd time: 8.1685 / Avg. bwd-weight time: 8.0894 / Avg. bwd-input time: 10.1456 / Avg. batch time: 849.4294 (ms) / GPU bubble ratio: 50.27%
[rank3]:2025-12-26 16:41:04,915 - Avg. fwd time: 7.8641 / Avg. bwd-weight time: 7.5285 / Avg. bwd-input time: 9.8420 / Avg. batch time: 835.7484 (ms) / GPU bubble ratio: 51.69%
[rank1]:2025-12-26 16:41:04,923 - Avg. fwd time: 10.0032 / Avg. bwd-weight time: 9.4255 / Avg. bwd-input time: 12.5303 / Avg. batch time: 870.9905 (ms) / GPU bubble ratio: 41.29%
[rank0]:2025-12-26 16:41:04,921 - Avg. fwd time: 13.1900 / Avg. full-bwd time: 13.5107 (Avg. bwd-weight time: 11.8803 / Avg. bwd-input time: 34.2142) / Avg. batch time: 891.7332 (ms) / GPU bubble ratio: 22.86%
[rank2]:2025-12-26 16:41:04,967 -  step: 450  loss: -4.0000  grad_norm:  0.3162  memory: 13.82GiB(29.09%)  tps: 9,519  tflops: 74.42  mfu: 23.85%
[rank3]:2025-12-26 16:41:04,967 -  step: 450  loss: -4.0000  grad_norm:  0.3162  memory: 15.27GiB(32.13%)  tps: 9,519  tflops: 74.42  mfu: 23.85%
[rank1]:2025-12-26 16:41:04,971 -  step: 450  loss: -4.0000  grad_norm:  0.3162  memory: 17.85GiB(37.57%)  tps: 9,519  tflops: 74.42  mfu: 23.85%
[rank0]:2025-12-26 16:41:04,993 -  step: 450  loss:  0.2303  grad_norm:  0.3162  memory: 36.24GiB(76.29%)  tps: 9,518  tflops: 74.41  mfu: 23.85%
[rank0]:2025-12-26 16:43:51,563 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 16:43:55,393 - Avg. fwd time: 13.1605 / Avg. full-bwd time: 12.8857 (Avg. bwd-weight time: 11.3313 / Avg. bwd-input time: 34.1835) / Avg. batch time: 883.7960 (ms) / GPU bubble ratio: 23.31%
[rank3]:2025-12-26 16:43:55,387 - Avg. fwd time: 7.8679 / Avg. bwd-weight time: 7.4971 / Avg. bwd-input time: 9.8512 / Avg. batch time: 828.5610 (ms) / GPU bubble ratio: 51.31%
[rank3]:2025-12-26 16:43:55,439 -  step: 500  loss: -4.0000  grad_norm:  0.1956  memory: 15.27GiB(32.13%)  tps: 9,611  tflops: 75.13  mfu: 24.08%
[rank2]:2025-12-26 16:43:55,391 - Avg. fwd time: 8.1682 / Avg. bwd-weight time: 8.0793 / Avg. bwd-input time: 10.1514 / Avg. batch time: 842.3889 (ms) / GPU bubble ratio: 49.86%
[rank2]:2025-12-26 16:43:55,439 -  step: 500  loss: -4.0000  grad_norm:  0.1956  memory: 13.82GiB(29.09%)  tps: 9,611  tflops: 75.13  mfu: 24.08%
[rank1]:2025-12-26 16:43:55,393 - Avg. fwd time: 10.0093 / Avg. bwd-weight time: 9.3654 / Avg. bwd-input time: 12.5435 / Avg. batch time: 863.4827 (ms) / GPU bubble ratio: 40.86%
[rank1]:2025-12-26 16:43:55,442 -  step: 500  loss: -4.0000  grad_norm:  0.1956  memory: 17.85GiB(37.57%)  tps: 9,611  tflops: 75.13  mfu: 24.08%
[rank0]:2025-12-26 16:43:55,464 -  step: 500  loss:  0.2251  grad_norm:  0.1956  memory: 36.24GiB(76.29%)  tps: 9,611  tflops: 75.14  mfu: 24.08%
[rank0]:2025-12-26 16:43:55,516 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1643_stage0_step500.svg
[rank2]:2025-12-26 16:43:55,517 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1643_stage2_step500.svg
[rank2]:2025-12-26 16:43:55,559 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1643_stage5_step500.svg
[rank1]:2025-12-26 16:43:55,525 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1643_stage1_step500.svg
[rank1]:2025-12-26 16:43:55,566 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1643_stage6_step500.svg
[rank0]:2025-12-26 16:43:55,556 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1643_stage7_step500.svg
[rank2]:2025-12-26 16:43:55,662 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank2_stage2.svg
[rank2]:	> Counts Sum: 98920, Total Sum: 241920 (40.89%), Ratio(%) per element: [42.85, 42.55, 41.07, 42.26, 42.55, 40.47, 43.15, 42.85, 43.45, 38.69, 40.47, 40.47, 38.98, 39.88, 38.98, 39.58, 38.98, 38.69]
[rank0]:2025-12-26 16:43:55,659 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank0_stage0.svg
[rank0]:	> Counts Sum: 192600, Total Sum: 255360 (75.42%), Ratio(%) per element: [62.5, 80.35, 79.46, 80.05, 80.05, 80.05, 79.16, 84.22, 80.95, 80.65, 72.32, 72.91, 71.72, 69.34, 71.13, 73.21, 72.32, 72.32, 70.23]
[rank2]:2025-12-26 16:43:55,764 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank2_stage5.svg
[rank2]:	> Counts Sum: 23320, Total Sum: 241920 (9.64%), Ratio(%) per element: [10.71, 9.82, 11.3, 9.82, 10.11, 9.82, 11.01, 11.01, 10.41, 6.84, 8.63, 10.71, 8.92, 9.22, 8.92, 8.92, 8.92, 8.33]
[rank1]:2025-12-26 16:43:55,694 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank1_stage1.svg
[rank1]:	> Counts Sum: 166600, Total Sum: 362880 (45.91%), Ratio(%) per element: [47.61, 46.72, 49.7, 46.42, 50.89, 48.8, 50.0, 48.8, 47.61, 43.45, 48.51, 43.75, 46.72, 46.42, 44.34, 47.02, 45.23, 44.34, 45.53, 41.96, 43.15, 45.23, 44.64, 45.23, 43.15, 42.55, 41.66]
[rank0]:2025-12-26 16:43:55,739 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank0_stage7.svg
[rank0]:	> Counts Sum: 111360, Total Sum: 147840 (75.32%), Ratio(%) per element: [77.38, 76.48, 75.0, 74.7, 75.0, 72.32, 77.97, 74.4, 76.48, 75.29, 73.51]
[rank3]:2025-12-26 16:43:55,790 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1643_step500_rank3.svg
[rank3]:			> Batch Time: 817.00 ms, GPU Bubble Ratio: 27.28%, 38.13%, 48.48%, 51.63%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-20-194ms   | [S7,MB1,F]  193-16-210ms   | [S7,MB1,BI] 221-34-255ms   | [S7,MB1,BW] 256-0-256ms    | [S7,MB2,F]  256-17-274ms   | [S7,MB2,BI] 285-35-320ms   | [S7,MB2,BW] 320-0-320ms    | [S7,MB3,F]  320-18-338ms   | [S7,MB3,BI] 351-35-386ms   | [S7,MB3,BW] 386-31-417ms   | [S0,MB7,F]  417-10-427ms   | [S0,MB0,B]  427-0-427ms    | [S7,MB4,F]  434-18-452ms   | [S7,MB4,BI] 464-34-498ms   | [S7,MB4,BW] 498-0-498ms    | [S0,MB1,B]  504-0-504ms    | [S7,MB5,F]  509-16-525ms   | [S7,MB5,BI] 538-33-571ms   | [S7,MB5,BW] 571-0-571ms    | [S0,MB2,B]  578-0-578ms    | [S7,MB6,F]  592-14-607ms   | [S7,MB6,BI] 619-33-652ms   | [S7,MB6,BW] 651-0-651ms    | [S0,MB3,B]  658-0-658ms    | [S7,MB7,F]  673-14-687ms   | [S7,MB7,BI] 699-32-731ms   | [S7,MB7,BW] 731-3-735ms    | [S0,MB4,B]  741-19-761ms   | [S0,MB5,B]  766-22-788ms   | [S0,MB6,B]  792-21-813ms   | [S0,MB7,B]  817-0-817ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 185-10-196ms   | [S6,MB2,F]  195-7-203ms    | [S6,MB1,BI] 256-9-265ms    | [S6,MB1,BW] 265-10-275ms   | [S6,MB3,F]  275-7-283ms    | [S6,MB2,BI] 320-9-329ms    | [S6,MB2,BW] 329-10-340ms   | [S1,MB6,F]  340-10-351ms   | [S1,MB0,BI] 351-15-367ms   | [S1,MB0,BW] 367-15-383ms   | [S6,MB4,F]  382-9-391ms    | [S6,MB3,BI] 391-10-402ms   | [S6,MB3,BW] 402-11-413ms   | [S1,MB7,F]  427-14-442ms   | [S1,MB1,BI] 442-16-458ms   | [S1,MB1,BW] 458-15-473ms   | [S6,MB5,F]  473-8-481ms    | [S6,MB4,BI] 497-12-510ms   | [S6,MB4,BW] 510-10-521ms   | [S1,MB2,BI] 521-14-535ms   | [S1,MB2,BW] 535-15-551ms   | [S6,MB6,F]  577-7-585ms    | [S6,MB5,BI] 584-10-595ms   | [S6,MB5,BW] 595-10-605ms   | [S1,MB3,BI] 606-14-621ms   | [S1,MB3,BW] 620-12-633ms   | [S6,MB7,F]  658-7-665ms    | [S6,MB6,BI] 666-10-676ms   | [S6,MB6,BW] 676-10-687ms   | [S1,MB4,BI] 687-14-702ms   | [S6,MB7,BI] 731-10-742ms   | [S1,MB5,BI] 743-14-758ms   | [S1,MB4,BW] 758-5-763ms    | [S1,MB6,BI] 771-14-785ms   | [S1,MB5,BW] 785-1-787ms    | [S1,MB7,BI] 795-14-810ms   | [S1,MB6,BW] 810-0-810ms    | [S6,MB7,BW] 810-0-810ms    | [S1,MB7,BW] 810-0-810ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 185-9-195ms    | [S5,MB0,BW] 195-10-205ms   | [S5,MB3,F]  205-7-212ms    | [S5,MB1,BI] 265-9-275ms    | [S5,MB1,BW] 275-10-285ms   | [S2,MB5,F]  285-7-293ms    | [S2,MB0,BI] 293-10-303ms   | [S2,MB0,BW] 303-9-313ms    | [S5,MB4,F]  313-7-321ms    | [S5,MB2,BI] 329-11-340ms   | [S5,MB2,BW] 340-10-351ms   | [S2,MB6,F]  352-9-362ms    | [S2,MB1,BI] 364-10-375ms   | [S2,MB1,BW] 375-10-385ms   | [S5,MB5,F]  385-7-393ms    | [S5,MB3,BI] 431-10-442ms   | [S5,MB3,BW] 442-11-454ms   | [S2,MB7,F]  454-7-461ms    | [S2,MB2,BI] 461-10-472ms   | [S2,MB2,BW] 472-9-482ms    | [S5,MB6,F]  481-7-489ms    | [S5,MB4,BI] 510-10-521ms   | [S5,MB4,BW] 521-9-531ms    | [S2,MB3,BI] 580-9-590ms    | [S2,MB3,BW] 590-10-601ms   | [S5,MB7,F]  605-7-612ms    | [S5,MB5,BI] 612-9-622ms    | [S5,MB5,BW] 621-9-631ms    | [S2,MB4,BI] 661-9-671ms    | [S5,MB6,BI] 676-10-687ms   | [S2,MB5,BI] 687-10-697ms   | [S5,MB7,BI] 743-9-753ms    | [S2,MB6,BI] 753-10-764ms   | [S2,MB4,BW] 764-8-772ms    | [S2,MB7,BI] 779-9-789ms    | [S2,MB5,BW] 789-0-789ms    | [S5,MB6,BW] 789-10-799ms   | [S5,MB7,BW] 799-5-804ms    | [S2,MB6,BW] 804-0-804ms    | [S2,MB7,BW] 804-0-804ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-9-214ms    | [S3,MB4,F]  213-7-221ms    | [S3,MB0,BI] 220-9-230ms    | [S3,MB0,BW] 230-9-240ms    | [S4,MB4,F]  240-8-248ms    | [S4,MB1,BI] 275-10-285ms   | [S4,MB1,BW] 285-10-295ms   | [S3,MB5,F]  296-8-304ms    | [S3,MB1,BI] 304-9-313ms    | [S3,MB1,BW] 314-9-323ms    | [S4,MB5,F]  324-8-332ms    | [S4,MB2,BI] 357-11-369ms   | [S4,MB2,BW] 369-9-379ms    | [S3,MB6,F]  379-7-386ms    | [S3,MB2,BI] 386-9-396ms    | [S3,MB2,BW] 396-10-406ms   | [S4,MB6,F]  406-8-414ms    | [S4,MB3,BI] 447-10-458ms   | [S4,MB3,BW] 458-10-468ms   | [S3,MB7,F]  468-7-476ms    | [S3,MB3,BI] 476-9-485ms    | [S3,MB3,BW] 485-9-495ms    | [S4,MB7,F]  495-7-503ms    | [S4,MB4,BI] 574-10-585ms   | [S4,MB4,BW] 584-9-594ms    | [S3,MB4,BI] 594-10-605ms   | [S4,MB5,BI] 654-10-664ms   | [S3,MB5,BI] 665-9-674ms    | [S4,MB6,BI] 687-9-696ms    | [S3,MB6,BI] 697-9-706ms    | [S4,MB7,BI] 755-9-764ms    | [S3,MB7,BI] 764-9-773ms    | [S3,MB4,BW] 773-0-773ms    | [S4,MB5,BW] 773-10-783ms   | [S4,MB6,BW] 784-9-793ms    | [S4,MB7,BW] 793-2-796ms    | [S3,MB5,BW] 796-0-796ms    | [S3,MB6,BW] 796-0-796ms    | [S3,MB7,BW] 796-0-796ms   
[rank3]:2025-12-26 16:43:55,834 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1643_stage3_step500.svg
[rank1]:2025-12-26 16:43:55,794 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank1_stage6.svg
[rank1]:	> Counts Sum: 38160, Total Sum: 241920 (15.77%), Ratio(%) per element: [16.07, 16.07, 16.07, 15.77, 16.07, 15.77, 15.77, 16.07, 15.77, 14.88, 15.47, 15.47, 15.77, 15.77, 15.47, 16.36, 15.47, 15.77]
[rank3]:2025-12-26 16:43:55,876 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1643_stage4_step500.svg
[rank3]:2025-12-26 16:43:55,976 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank3_stage3.svg
[rank3]:	> Counts Sum: 118080, Total Sum: 241920 (48.81%), Ratio(%) per element: [47.91, 48.51, 50.29, 49.1, 49.4, 50.0, 49.1, 50.0, 48.51, 47.91, 47.91, 50.59, 47.91, 48.51, 47.32, 49.4, 48.21, 47.91]
[rank3]:2025-12-26 16:43:56,078 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1643_rank3_stage4.svg
[rank3]:	> Counts Sum: 23320, Total Sum: 241920 (9.64%), Ratio(%) per element: [12.5, 11.9, 11.01, 11.01, 11.9, 9.82, 11.9, 12.5, 11.9, 7.44, 8.03, 8.03, 6.54, 7.44, 7.44, 8.33, 7.73, 8.03]
[rank0]:2025-12-26 16:43:56,309 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage0.svg
[rank2]:2025-12-26 16:43:56,332 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage2.svg
[rank1]:2025-12-26 16:43:56,352 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage1.svg
[rank3]:2025-12-26 16:43:56,651 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage3.svg
[rank0]:2025-12-26 16:43:56,895 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage7.svg
[rank2]:2025-12-26 16:43:56,903 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage5.svg
[rank1]:2025-12-26 16:43:56,923 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage6.svg
[rank3]:2025-12-26 16:43:57,188 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1643_stage4.svg
[rank0]:2025-12-26 16:46:44,303 - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-12-26 16:46:48,139 - Avg. fwd time: 13.1349 / Avg. full-bwd time: 12.4297 (Avg. bwd-weight time: 10.8785 / Avg. bwd-input time: 34.1580) / Avg. batch time: 877.6967 (ms) / GPU bubble ratio: 23.68%
[rank2]:2025-12-26 16:46:48,131 - Avg. fwd time: 8.1685 / Avg. bwd-weight time: 8.0611 / Avg. bwd-input time: 10.1562 / Avg. batch time: 836.9559 (ms) / GPU bubble ratio: 49.56%
[rank2]:2025-12-26 16:46:48,185 -  step: 550  loss: -4.0000  grad_norm:  0.1447  memory: 13.82GiB(29.09%)  tps: 9,484  tflops: 74.15  mfu: 23.76%
[rank3]:2025-12-26 16:46:48,128 - Avg. fwd time: 7.8712 / Avg. bwd-weight time: 7.4717 / Avg. bwd-input time: 9.8585 / Avg. batch time: 823.0048 (ms) / GPU bubble ratio: 51.01%
[rank3]:2025-12-26 16:46:48,185 -  step: 550  loss: -4.0000  grad_norm:  0.1447  memory: 15.27GiB(32.13%)  tps: 9,484  tflops: 74.15  mfu: 23.76%
[rank1]:2025-12-26 16:46:48,133 - Avg. fwd time: 10.0135 / Avg. bwd-weight time: 9.3283 / Avg. bwd-input time: 12.5510 / Avg. batch time: 857.7599 (ms) / GPU bubble ratio: 40.51%
[rank1]:2025-12-26 16:46:48,188 -  step: 550  loss: -4.0000  grad_norm:  0.1447  memory: 17.85GiB(37.57%)  tps: 9,484  tflops: 74.15  mfu: 23.76%
[rank0]:2025-12-26 16:46:48,211 -  step: 550  loss:  0.2279  grad_norm:  0.1447  memory: 36.24GiB(76.29%)  tps: 9,484  tflops: 74.15  mfu: 23.76%
[rank0]:2025-12-26 16:49:35,585 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 16:49:39,444 - Avg. fwd time: 7.8726 / Avg. bwd-weight time: 7.4492 / Avg. bwd-input time: 9.8627 / Avg. batch time: 818.2757 (ms) / GPU bubble ratio: 50.76%
[rank3]:2025-12-26 16:49:39,494 -  step: 600  loss: -4.0000  grad_norm:  0.3480  memory: 15.27GiB(32.13%)  tps: 9,564  tflops: 74.77  mfu: 23.96%
[rank2]:2025-12-26 16:49:39,445 - Avg. fwd time: 8.1692 / Avg. bwd-weight time: 8.0418 / Avg. bwd-input time: 10.1603 / Avg. batch time: 832.2374 (ms) / GPU bubble ratio: 49.30%
[rank2]:2025-12-26 16:49:39,494 -  step: 600  loss: -4.0000  grad_norm:  0.3480  memory: 13.82GiB(29.09%)  tps: 9,564  tflops: 74.77  mfu: 23.96%
[rank0]:2025-12-26 16:49:39,449 - Avg. fwd time: 13.1200 / Avg. full-bwd time: 12.0615 (Avg. bwd-weight time: 10.5510 / Avg. bwd-input time: 34.1411) / Avg. batch time: 872.6728 (ms) / GPU bubble ratio: 23.92%
[rank0]:2025-12-26 16:49:39,518 -  step: 600  loss:  0.2261  grad_norm:  0.3480  memory: 36.24GiB(76.29%)  tps: 9,564  tflops: 74.77  mfu: 23.96%
[rank1]:2025-12-26 16:49:39,448 - Avg. fwd time: 10.0178 / Avg. bwd-weight time: 9.2836 / Avg. bwd-input time: 12.5579 / Avg. batch time: 852.8057 (ms) / GPU bubble ratio: 40.23%
[rank1]:2025-12-26 16:49:39,498 -  step: 600  loss: -4.0000  grad_norm:  0.3480  memory: 17.85GiB(37.57%)  tps: 9,564  tflops: 74.77  mfu: 23.96%
[rank2]:2025-12-26 16:49:39,572 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1649_stage2_step600.svg
[rank2]:2025-12-26 16:49:39,615 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1649_stage5_step600.svg
[rank0]:2025-12-26 16:49:39,571 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1649_stage0_step600.svg
[rank0]:2025-12-26 16:49:39,614 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1649_stage7_step600.svg
[rank1]:2025-12-26 16:49:39,571 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1649_stage1_step600.svg
[rank1]:2025-12-26 16:49:39,615 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1649_stage6_step600.svg
[rank2]:2025-12-26 16:49:39,716 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank2_stage2.svg
[rank2]:	> Counts Sum: 122520, Total Sum: 299520 (40.91%), Ratio(%) per element: [42.3, 43.02, 41.1, 41.82, 42.06, 40.62, 43.02, 42.54, 43.26, 39.18, 40.14, 39.9, 39.42, 40.38, 39.9, 39.9, 38.7, 38.94]
[rank0]:2025-12-26 16:49:39,718 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank0_stage0.svg
[rank0]:	> Counts Sum: 241400, Total Sum: 316160 (76.35%), Ratio(%) per element: [63.7, 81.25, 80.28, 81.25, 81.0, 79.56, 79.56, 84.13, 81.73, 81.25, 73.79, 74.51, 74.51, 71.63, 71.63, 74.27, 72.59, 72.35, 71.63]
[rank2]:2025-12-26 16:49:39,821 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank2_stage5.svg
[rank2]:	> Counts Sum: 26520, Total Sum: 299520 (8.85%), Ratio(%) per element: [9.85, 9.13, 10.57, 9.37, 9.85, 9.13, 11.29, 10.09, 9.37, 6.73, 7.69, 9.13, 7.93, 8.41, 8.41, 7.45, 7.69, 7.21]
[rank0]:2025-12-26 16:49:39,798 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank0_stage7.svg
[rank0]:	> Counts Sum: 139760, Total Sum: 183040 (76.35%), Ratio(%) per element: [78.12, 77.64, 76.44, 75.72, 76.68, 73.79, 78.36, 75.48, 76.92, 76.68, 74.03]
[rank1]:2025-12-26 16:49:39,741 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank1_stage1.svg
[rank1]:	> Counts Sum: 207000, Total Sum: 449280 (46.07%), Ratio(%) per element: [46.87, 47.59, 49.75, 46.87, 49.75, 48.31, 49.75, 49.75, 47.11, 44.23, 47.59, 44.23, 47.35, 47.11, 44.95, 46.39, 46.15, 45.67, 44.95, 42.06, 42.78, 45.91, 45.19, 44.95, 44.23, 42.78, 41.58]
[rank3]:2025-12-26 16:49:39,846 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1649_step600_rank3.svg
[rank3]:			> Batch Time: 810.50 ms, GPU Bubble Ratio: 25.57%, 37.44%, 48.38%, 50.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-0-175ms    | [S7,MB1,F]  175-17-192ms   | [S7,MB1,BI] 204-33-237ms   | [S7,MB1,BW] 238-0-238ms    | [S7,MB2,F]  238-18-256ms   | [S7,MB2,BI] 268-35-303ms   | [S7,MB2,BW] 303-0-303ms    | [S7,MB3,F]  303-18-322ms   | [S7,MB3,BI] 334-35-369ms   | [S7,MB3,BW] 369-31-400ms   | [S0,MB7,F]  400-10-410ms   | [S0,MB0,B]  410-0-410ms    | [S7,MB4,F]  417-18-436ms   | [S7,MB4,BI] 448-34-482ms   | [S7,MB4,BW] 482-0-482ms    | [S0,MB1,B]  489-0-489ms    | [S7,MB5,F]  493-15-509ms   | [S7,MB5,BI] 521-33-554ms   | [S7,MB5,BW] 554-0-554ms    | [S0,MB2,B]  561-0-561ms    | [S7,MB6,F]  575-15-590ms   | [S7,MB6,BI] 603-33-636ms   | [S7,MB6,BW] 636-0-636ms    | [S0,MB3,B]  643-0-643ms    | [S7,MB7,F]  657-14-672ms   | [S7,MB7,BI] 684-33-717ms   | [S7,MB7,BW] 717-25-742ms   | [S0,MB4,B]  741-18-759ms   | [S0,MB5,B]  761-25-787ms   | [S0,MB6,B]  787-23-810ms   | [S0,MB7,B]  810-0-810ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-11-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 238-9-247ms    | [S6,MB1,BW] 247-10-257ms   | [S6,MB3,F]  257-7-264ms    | [S6,MB2,BI] 303-9-313ms    | [S6,MB2,BW] 313-10-324ms   | [S1,MB6,F]  323-11-334ms   | [S1,MB0,BI] 334-16-350ms   | [S1,MB0,BW] 350-15-366ms   | [S6,MB4,F]  366-9-375ms    | [S6,MB3,BI] 375-10-386ms   | [S6,MB3,BW] 386-11-397ms   | [S1,MB7,F]  410-14-425ms   | [S1,MB1,BI] 425-16-441ms   | [S1,MB1,BW] 441-15-456ms   | [S6,MB5,F]  456-8-465ms    | [S6,MB4,BI] 482-12-494ms   | [S6,MB4,BW] 494-10-505ms   | [S1,MB2,BI] 505-14-520ms   | [S1,MB2,BW] 520-15-535ms   | [S6,MB6,F]  561-7-568ms    | [S6,MB5,BI] 568-10-578ms   | [S6,MB5,BW] 578-10-589ms   | [S1,MB3,BI] 589-14-604ms   | [S1,MB3,BW] 604-11-616ms   | [S6,MB7,F]  642-7-650ms    | [S6,MB6,BI] 650-10-660ms   | [S6,MB6,BW] 660-10-671ms   | [S1,MB4,BI] 671-14-686ms   | [S6,MB7,BI] 717-10-728ms   | [S1,MB5,BI] 728-15-743ms   | [S1,MB4,BW] 743-6-749ms    | [S1,MB6,BI] 756-14-771ms   | [S1,MB5,BW] 771-3-774ms    | [S1,MB7,BI] 781-14-796ms   | [S1,MB6,BW] 796-0-796ms    | [S6,MB7,BW] 796-0-796ms    | [S1,MB7,BW] 796-0-796ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 247-9-257ms    | [S5,MB1,BW] 257-10-267ms   | [S2,MB5,F]  267-7-275ms    | [S2,MB0,BI] 275-10-285ms   | [S2,MB0,BW] 285-9-295ms    | [S5,MB4,F]  295-8-303ms    | [S5,MB2,BI] 313-11-324ms   | [S5,MB2,BW] 324-10-334ms   | [S2,MB6,F]  336-9-346ms    | [S2,MB1,BI] 347-10-358ms   | [S2,MB1,BW] 358-10-368ms   | [S5,MB5,F]  368-7-376ms    | [S5,MB3,BI] 415-10-425ms   | [S5,MB3,BW] 425-11-437ms   | [S2,MB7,F]  437-7-445ms    | [S2,MB2,BI] 445-10-455ms   | [S2,MB2,BW] 455-9-465ms    | [S5,MB6,F]  465-7-473ms    | [S5,MB4,BI] 495-10-505ms   | [S5,MB4,BW] 506-9-515ms    | [S2,MB3,BI] 564-9-574ms    | [S2,MB3,BW] 574-10-584ms   | [S5,MB7,F]  588-7-595ms    | [S5,MB5,BI] 596-9-605ms    | [S5,MB5,BW] 605-9-615ms    | [S2,MB4,BI] 645-9-655ms    | [S5,MB6,BI] 661-10-671ms   | [S2,MB5,BI] 671-10-681ms   | [S5,MB7,BI] 729-9-738ms    | [S2,MB6,BI] 739-11-750ms   | [S2,MB4,BW] 750-6-756ms    | [S2,MB7,BI] 765-9-775ms    | [S2,MB5,BW] 775-0-775ms    | [S5,MB6,BW] 775-10-785ms   | [S5,MB7,BW] 785-3-789ms    | [S2,MB6,BW] 789-0-789ms    | [S2,MB7,BW] 789-0-789ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  239-8-247ms    | [S4,MB1,BI] 257-11-268ms   | [S4,MB1,BW] 268-10-279ms   | [S3,MB5,F]  278-8-286ms    | [S3,MB1,BI] 287-9-297ms    | [S3,MB1,BW] 297-10-307ms   | [S4,MB5,F]  308-8-316ms    | [S4,MB2,BI] 340-11-352ms   | [S4,MB2,BW] 352-9-362ms    | [S3,MB6,F]  362-7-369ms    | [S3,MB2,BI] 369-9-379ms    | [S3,MB2,BW] 379-10-389ms   | [S4,MB6,F]  389-8-397ms    | [S4,MB3,BI] 430-10-441ms   | [S4,MB3,BW] 441-10-451ms   | [S3,MB7,F]  451-7-458ms    | [S3,MB3,BI] 459-9-468ms    | [S3,MB3,BW] 468-9-478ms    | [S4,MB7,F]  478-8-486ms    | [S4,MB4,BI] 557-10-568ms   | [S4,MB4,BW] 568-9-577ms    | [S3,MB4,BI] 577-10-588ms   | [S4,MB5,BI] 639-10-649ms   | [S3,MB5,BI] 649-9-658ms    | [S4,MB6,BI] 671-9-681ms    | [S3,MB6,BI] 681-9-690ms    | [S4,MB7,BI] 740-9-750ms    | [S3,MB7,BI] 750-9-759ms    | [S3,MB4,BW] 759-0-759ms    | [S4,MB5,BW] 759-10-769ms   | [S4,MB6,BW] 769-9-778ms    | [S4,MB7,BW] 779-7-786ms    | [S3,MB5,BW] 786-0-786ms    | [S3,MB6,BW] 786-0-786ms    | [S3,MB7,BW] 786-0-786ms   
[rank3]:2025-12-26 16:49:39,891 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1649_stage3_step600.svg
[rank1]:2025-12-26 16:49:39,841 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank1_stage6.svg
[rank1]:	> Counts Sum: 45360, Total Sum: 299520 (15.14%), Ratio(%) per element: [15.38, 15.38, 15.38, 15.14, 15.38, 15.14, 15.14, 15.38, 15.14, 14.42, 14.9, 14.9, 15.14, 15.14, 14.9, 15.62, 14.9, 15.14]
[rank3]:2025-12-26 16:49:39,935 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1649_stage4_step600.svg
[rank3]:2025-12-26 16:49:40,034 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank3_stage3.svg
[rank3]:	> Counts Sum: 146880, Total Sum: 299520 (49.04%), Ratio(%) per element: [48.31, 48.79, 50.24, 49.27, 49.51, 50.0, 49.27, 50.0, 48.79, 48.31, 48.31, 50.48, 48.31, 48.79, 47.83, 49.51, 48.55, 48.31]
[rank3]:2025-12-26 16:49:40,136 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1649_rank3_stage4.svg
[rank3]:	> Counts Sum: 26520, Total Sum: 299520 (8.85%), Ratio(%) per element: [11.29, 10.81, 9.85, 9.37, 10.81, 8.65, 10.81, 10.81, 10.81, 7.21, 7.69, 7.93, 6.0, 7.45, 6.49, 7.69, 7.93, 7.69]
[rank2]:2025-12-26 16:49:40,507 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage2.svg
[rank0]:2025-12-26 16:49:40,508 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage0.svg
[rank1]:2025-12-26 16:49:40,530 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage1.svg
[rank3]:2025-12-26 16:49:40,816 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage3.svg
[rank2]:2025-12-26 16:49:41,159 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage5.svg
[rank0]:2025-12-26 16:49:41,216 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage7.svg
[rank1]:2025-12-26 16:49:41,204 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage6.svg
[rank3]:2025-12-26 16:49:41,476 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1649_stage4.svg
[rank0]:2025-12-26 16:52:27,998 - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-12-26 16:52:31,764 - Avg. fwd time: 13.1018 / Avg. full-bwd time: 11.6778 (Avg. bwd-weight time: 10.1786 / Avg. bwd-input time: 34.1233) / Avg. batch time: 868.1044 (ms) / GPU bubble ratio: 24.26%
[rank3]:2025-12-26 16:52:31,762 - Avg. fwd time: 7.8740 / Avg. bwd-weight time: 7.4309 / Avg. bwd-input time: 9.8664 / Avg. batch time: 814.1554 (ms) / GPU bubble ratio: 50.53%
[rank3]:2025-12-26 16:52:31,809 -  step: 650  loss: -4.0000  grad_norm:  0.1235  memory: 15.27GiB(32.13%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank2]:2025-12-26 16:52:31,762 - Avg. fwd time: 8.1698 / Avg. bwd-weight time: 8.0310 / Avg. bwd-input time: 10.1626 / Avg. batch time: 828.2309 (ms) / GPU bubble ratio: 49.07%
[rank2]:2025-12-26 16:52:31,809 -  step: 650  loss: -4.0000  grad_norm:  0.1235  memory: 13.82GiB(29.09%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank1]:2025-12-26 16:52:31,764 - Avg. fwd time: 10.0206 / Avg. bwd-weight time: 9.2501 / Avg. bwd-input time: 12.5656 / Avg. batch time: 848.5636 (ms) / GPU bubble ratio: 39.97%
[rank1]:2025-12-26 16:52:31,813 -  step: 650  loss: -4.0000  grad_norm:  0.1235  memory: 17.85GiB(37.57%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank0]:2025-12-26 16:52:31,833 -  step: 650  loss:  0.2315  grad_norm:  0.1235  memory: 36.24GiB(76.29%)  tps: 9,508  tflops: 74.33  mfu: 23.82%
[rank0]:2025-12-26 16:55:18,177 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-26 16:55:21,951 - Avg. fwd time: 7.8763 / Avg. bwd-weight time: 7.4186 / Avg. bwd-input time: 9.8713 / Avg. batch time: 810.4178 (ms) / GPU bubble ratio: 50.31%
[rank2]:2025-12-26 16:55:21,955 - Avg. fwd time: 8.1707 / Avg. bwd-weight time: 8.0239 / Avg. bwd-input time: 10.1665 / Avg. batch time: 824.5193 (ms) / GPU bubble ratio: 48.85%
[rank1]:2025-12-26 16:55:21,957 - Avg. fwd time: 10.0234 / Avg. bwd-weight time: 9.2258 / Avg. bwd-input time: 12.5714 / Avg. batch time: 844.6223 (ms) / GPU bubble ratio: 39.72%
[rank0]:2025-12-26 16:55:21,957 - Avg. fwd time: 13.0868 / Avg. full-bwd time: 11.4045 (Avg. bwd-weight time: 9.8803 / Avg. bwd-input time: 34.1106) / Avg. batch time: 864.0218 (ms) / GPU bubble ratio: 24.48%
[rank3]:2025-12-26 16:55:22,003 -  step: 700  loss: -4.0000  grad_norm:  0.1657  memory: 15.27GiB(32.13%)  tps: 9,627  tflops: 75.26  mfu: 24.12%
[rank2]:2025-12-26 16:55:22,003 -  step: 700  loss: -4.0000  grad_norm:  0.1657  memory: 13.82GiB(29.09%)  tps: 9,627  tflops: 75.26  mfu: 24.12%
[rank1]:2025-12-26 16:55:22,006 -  step: 700  loss: -4.0000  grad_norm:  0.1657  memory: 17.85GiB(37.57%)  tps: 9,627  tflops: 75.26  mfu: 24.12%
[rank0]:2025-12-26 16:55:22,028 -  step: 700  loss:  0.1916  grad_norm:  0.1657  memory: 36.24GiB(76.29%)  tps: 9,627  tflops: 75.26  mfu: 24.12%
[rank0]:2025-12-26 16:55:22,083 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1655_stage0_step700.svg
[rank2]:2025-12-26 16:55:22,083 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1655_stage2_step700.svg
[rank2]:2025-12-26 16:55:22,128 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1655_stage5_step700.svg
[rank1]:2025-12-26 16:55:22,083 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1655_stage1_step700.svg
[rank1]:2025-12-26 16:55:22,127 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1655_stage6_step700.svg
[rank0]:2025-12-26 16:55:22,126 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1655_stage7_step700.svg
[rank2]:2025-12-26 16:55:22,232 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank2_stage2.svg
[rank2]:	> Counts Sum: 146120, Total Sum: 357120 (40.92%), Ratio(%) per element: [41.93, 42.74, 40.92, 41.53, 42.33, 40.72, 42.74, 42.33, 43.14, 39.31, 40.12, 39.71, 39.71, 40.52, 40.12, 40.12, 39.31, 39.11]
[rank1]:2025-12-26 16:55:22,253 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank1_stage1.svg
[rank1]:	> Counts Sum: 247400, Total Sum: 535680 (46.18%), Ratio(%) per element: [47.58, 47.58, 50.0, 46.97, 48.58, 48.18, 49.79, 49.19, 47.37, 44.75, 47.37, 44.95, 47.98, 47.78, 45.76, 46.57, 46.16, 46.16, 43.75, 42.74, 43.34, 45.36, 44.95, 44.75, 44.35, 42.94, 41.93]
[rank0]:2025-12-26 16:55:22,229 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank0_stage0.svg
[rank0]:	> Counts Sum: 290200, Total Sum: 376960 (76.98%), Ratio(%) per element: [64.31, 82.25, 81.25, 82.66, 82.45, 81.25, 80.84, 84.47, 83.26, 81.25, 73.38, 74.39, 73.99, 72.58, 72.58, 74.79, 72.17, 72.78, 71.97]
[rank0]:2025-12-26 16:55:22,310 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank0_stage7.svg
[rank0]:	> Counts Sum: 168160, Total Sum: 218240 (77.05%), Ratio(%) per element: [78.42, 78.22, 76.81, 76.81, 76.81, 75.4, 78.83, 77.01, 77.21, 77.01, 75.0]
[rank3]:2025-12-26 16:55:22,361 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1655_step700_rank3.svg
[rank3]:			> Batch Time: 802.50 ms, GPU Bubble Ratio: 29.05%, 36.49%, 47.41%, 49.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-0-174ms    | [S7,MB1,F]  174-15-190ms   | [S7,MB1,BI] 202-34-236ms   | [S7,MB1,BW] 236-0-236ms    | [S7,MB2,F]  236-17-254ms   | [S7,MB2,BI] 267-35-302ms   | [S7,MB2,BW] 302-0-302ms    | [S7,MB3,F]  302-19-321ms   | [S7,MB3,BI] 334-35-370ms   | [S7,MB3,BW] 370-31-401ms   | [S0,MB7,F]  398-10-408ms   | [S0,MB0,B]  408-0-408ms    | [S7,MB4,F]  415-18-434ms   | [S7,MB4,BI] 445-34-479ms   | [S7,MB4,BW] 479-0-479ms    | [S0,MB1,B]  486-0-486ms    | [S7,MB5,F]  490-16-507ms   | [S7,MB5,BI] 520-33-553ms   | [S7,MB5,BW] 553-0-553ms    | [S0,MB2,B]  560-0-560ms    | [S7,MB6,F]  574-15-589ms   | [S7,MB6,BI] 601-33-634ms   | [S7,MB6,BW] 634-0-634ms    | [S0,MB3,B]  641-0-641ms    | [S7,MB7,F]  655-14-670ms   | [S7,MB7,BI] 683-33-716ms   | [S7,MB7,BW] 716-4-721ms    | [S0,MB4,B]  725-13-738ms   | [S0,MB5,B]  751-22-773ms   | [S0,MB6,B]  777-20-798ms   | [S0,MB7,B]  802-0-802ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 237-9-246ms    | [S6,MB1,BW] 246-10-256ms   | [S6,MB3,F]  256-7-264ms    | [S6,MB2,BI] 302-9-311ms    | [S6,MB2,BW] 311-10-322ms   | [S1,MB6,F]  322-10-333ms   | [S1,MB0,BI] 333-16-349ms   | [S1,MB0,BW] 349-15-364ms   | [S6,MB4,F]  364-9-373ms    | [S6,MB3,BI] 373-10-384ms   | [S6,MB3,BW] 384-11-395ms   | [S1,MB7,F]  408-14-423ms   | [S1,MB1,BI] 423-16-439ms   | [S1,MB1,BW] 439-15-455ms   | [S6,MB5,F]  455-8-463ms    | [S6,MB4,BI] 479-12-491ms   | [S6,MB4,BW] 491-10-502ms   | [S1,MB2,BI] 502-14-517ms   | [S1,MB2,BW] 517-15-532ms   | [S6,MB6,F]  560-7-567ms    | [S6,MB5,BI] 567-10-578ms   | [S6,MB5,BW] 578-10-588ms   | [S1,MB3,BI] 588-14-603ms   | [S1,MB3,BW] 603-12-616ms   | [S6,MB7,F]  640-7-648ms    | [S6,MB6,BI] 648-10-658ms   | [S6,MB6,BW] 658-10-669ms   | [S1,MB4,BI] 669-14-684ms   | [S6,MB7,BI] 716-10-727ms   | [S1,MB5,BI] 728-15-743ms   | [S1,MB4,BW] 742-7-750ms    | [S1,MB6,BI] 756-14-770ms   | [S1,MB5,BW] 770-3-774ms    | [S1,MB7,BI] 781-14-795ms   | [S1,MB6,BW] 795-0-795ms    | [S6,MB7,BW] 796-0-796ms    | [S1,MB7,BW] 796-0-796ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 246-9-256ms    | [S5,MB1,BW] 256-10-267ms   | [S2,MB5,F]  267-7-274ms    | [S2,MB0,BI] 274-10-284ms   | [S2,MB0,BW] 284-9-294ms    | [S5,MB4,F]  294-7-302ms    | [S5,MB2,BI] 311-11-322ms   | [S5,MB2,BW] 322-10-333ms   | [S2,MB6,F]  334-9-344ms    | [S2,MB1,BI] 346-10-357ms   | [S2,MB1,BW] 357-10-367ms   | [S5,MB5,F]  367-7-375ms    | [S5,MB3,BI] 412-10-423ms   | [S5,MB3,BW] 423-11-435ms   | [S2,MB7,F]  435-7-443ms    | [S2,MB2,BI] 443-10-453ms   | [S2,MB2,BW] 453-9-463ms    | [S5,MB6,F]  463-7-471ms    | [S5,MB4,BI] 491-10-502ms   | [S5,MB4,BW] 502-9-512ms    | [S2,MB3,BI] 563-9-573ms    | [S2,MB3,BW] 572-10-583ms   | [S5,MB7,F]  587-7-594ms    | [S5,MB5,BI] 594-9-604ms    | [S5,MB5,BW] 604-9-614ms    | [S2,MB4,BI] 643-9-653ms    | [S5,MB6,BI] 658-10-669ms   | [S2,MB5,BI] 669-10-679ms   | [S5,MB7,BI] 728-9-738ms    | [S2,MB6,BI] 738-10-749ms   | [S2,MB4,BW] 749-8-758ms    | [S2,MB7,BI] 764-9-774ms    | [S2,MB5,BW] 774-0-774ms    | [S5,MB6,BW] 774-10-784ms   | [S5,MB7,BW] 785-5-790ms    | [S2,MB6,BW] 790-0-790ms    | [S2,MB7,BW] 790-0-790ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-7-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 256-11-267ms   | [S4,MB1,BW] 267-10-278ms   | [S3,MB5,F]  278-8-286ms    | [S3,MB1,BI] 286-10-296ms   | [S3,MB1,BW] 296-10-307ms   | [S4,MB5,F]  307-8-316ms    | [S4,MB2,BI] 339-11-351ms   | [S4,MB2,BW] 351-9-361ms    | [S3,MB6,F]  361-7-368ms    | [S3,MB2,BI] 368-9-378ms    | [S3,MB2,BW] 378-10-388ms   | [S4,MB6,F]  388-8-397ms    | [S4,MB3,BI] 429-10-439ms   | [S4,MB3,BW] 439-10-450ms   | [S3,MB7,F]  450-7-457ms    | [S3,MB3,BI] 457-9-467ms    | [S3,MB3,BW] 467-9-477ms    | [S4,MB7,F]  477-8-485ms    | [S4,MB4,BI] 557-10-567ms   | [S4,MB4,BW] 567-9-577ms    | [S3,MB4,BI] 577-10-587ms   | [S4,MB5,BI] 637-10-647ms   | [S3,MB5,BI] 647-9-656ms    | [S4,MB6,BI] 670-9-679ms    | [S3,MB6,BI] 679-9-688ms    | [S4,MB7,BI] 740-9-749ms    | [S3,MB7,BI] 749-9-758ms    | [S3,MB4,BW] 758-0-758ms    | [S4,MB5,BW] 758-10-768ms   | [S4,MB6,BW] 769-9-778ms    | [S4,MB7,BW] 778-6-784ms    | [S3,MB5,BW] 784-0-784ms    | [S3,MB6,BW] 784-0-784ms    | [S3,MB7,BW] 784-0-784ms   
[rank2]:2025-12-26 16:55:22,334 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank2_stage5.svg
[rank2]:	> Counts Sum: 29720, Total Sum: 357120 (8.32%), Ratio(%) per element: [9.27, 9.27, 9.47, 8.87, 9.27, 8.66, 9.87, 9.87, 8.87, 6.25, 7.05, 9.07, 7.25, 7.86, 7.86, 7.66, 6.85, 6.45]
[rank1]:2025-12-26 16:55:22,353 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank1_stage6.svg
[rank1]:	> Counts Sum: 52560, Total Sum: 357120 (14.72%), Ratio(%) per element: [14.91, 14.91, 14.91, 14.71, 14.91, 14.71, 14.71, 14.91, 14.71, 14.11, 14.51, 14.51, 14.71, 14.71, 14.51, 15.12, 14.51, 14.71]
[rank3]:2025-12-26 16:55:22,407 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1655_stage3_step700.svg
[rank3]:2025-12-26 16:55:22,451 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1655_stage4_step700.svg
[rank3]:2025-12-26 16:55:22,550 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank3_stage3.svg
[rank3]:	> Counts Sum: 175680, Total Sum: 357120 (49.19%), Ratio(%) per element: [48.58, 48.99, 50.2, 49.39, 49.59, 50.0, 49.39, 50.0, 48.99, 48.58, 48.58, 50.4, 48.58, 48.99, 48.18, 49.59, 48.79, 48.58]
[rank3]:2025-12-26 16:55:22,651 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1655_rank3_stage4.svg
[rank3]:	> Counts Sum: 29720, Total Sum: 357120 (8.32%), Ratio(%) per element: [10.88, 10.48, 9.67, 9.07, 10.08, 8.26, 9.87, 9.87, 10.28, 6.65, 7.05, 7.25, 5.24, 7.05, 6.04, 6.65, 8.26, 7.05]
[rank2]:2025-12-26 16:55:23,156 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage2.svg
[rank1]:2025-12-26 16:55:23,173 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage1.svg
[rank0]:2025-12-26 16:55:23,148 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage0.svg
[rank3]:2025-12-26 16:55:23,471 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage3.svg
[rank2]:2025-12-26 16:55:23,943 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage5.svg
[rank0]:2025-12-26 16:55:23,974 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage7.svg
[rank1]:2025-12-26 16:55:23,980 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage6.svg
[rank3]:2025-12-26 16:55:24,262 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1655_stage4.svg
[rank0]:2025-12-26 16:58:08,675 - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-12-26 16:58:12,468 - Avg. fwd time: 7.8787 / Avg. bwd-weight time: 7.4114 / Avg. bwd-input time: 9.8761 / Avg. batch time: 806.7173 (ms) / GPU bubble ratio: 50.09%
[rank1]:2025-12-26 16:58:12,474 - Avg. fwd time: 10.0262 / Avg. bwd-weight time: 9.2087 / Avg. bwd-input time: 12.5796 / Avg. batch time: 840.7873 (ms) / GPU bubble ratio: 39.46%
[rank2]:2025-12-26 16:58:12,471 - Avg. fwd time: 8.1717 / Avg. bwd-weight time: 8.0194 / Avg. bwd-input time: 10.1684 / Avg. batch time: 820.9068 (ms) / GPU bubble ratio: 48.62%
[rank0]:2025-12-26 16:58:12,480 - Avg. fwd time: 13.0737 / Avg. full-bwd time: 11.1549 (Avg. bwd-weight time: 9.5046 / Avg. bwd-input time: 34.0999) / Avg. batch time: 859.9439 (ms) / GPU bubble ratio: 24.73%
[rank3]:2025-12-26 16:58:12,526 -  step: 750  loss: -4.0000  grad_norm:  0.1749  memory: 15.27GiB(32.13%)  tps: 9,608  tflops: 75.11  mfu: 24.07%
[rank1]:2025-12-26 16:58:12,529 -  step: 750  loss: -4.0000  grad_norm:  0.1749  memory: 17.85GiB(37.57%)  tps: 9,608  tflops: 75.11  mfu: 24.07%
[rank2]:2025-12-26 16:58:12,526 -  step: 750  loss: -4.0000  grad_norm:  0.1749  memory: 13.82GiB(29.09%)  tps: 9,608  tflops: 75.11  mfu: 24.07%
[rank0]:2025-12-26 16:58:12,551 -  step: 750  loss:  0.2332  grad_norm:  0.1749  memory: 36.24GiB(76.29%)  tps: 9,608  tflops: 75.11  mfu: 24.07%
[rank0]:2025-12-26 17:00:59,022 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-26 17:01:02,975 - Avg. fwd time: 8.1733 / Avg. bwd-weight time: 8.0159 / Avg. bwd-input time: 10.1722 / Avg. batch time: 818.1668 (ms) / GPU bubble ratio: 48.45%
[rank1]:2025-12-26 17:01:02,974 - Avg. fwd time: 10.0286 / Avg. bwd-weight time: 9.1902 / Avg. bwd-input time: 12.5834 / Avg. batch time: 837.8945 (ms) / GPU bubble ratio: 39.27%
[rank3]:2025-12-26 17:01:02,967 - Avg. fwd time: 7.8807 / Avg. bwd-weight time: 7.4012 / Avg. bwd-input time: 9.8796 / Avg. batch time: 803.9619 (ms) / GPU bubble ratio: 49.92%
[rank0]:2025-12-26 17:01:02,975 - Avg. fwd time: 13.0645 / Avg. full-bwd time: 10.9263 (Avg. bwd-weight time: 9.3136 / Avg. bwd-input time: 34.0918) / Avg. batch time: 856.9698 (ms) / GPU bubble ratio: 24.89%
[rank0]:2025-12-26 17:01:03,046 -  step: 800  loss:  0.2383  grad_norm:  0.2069  memory: 36.24GiB(76.29%)  tps: 9,610  tflops: 75.12  mfu: 24.08%
[rank0]:2025-12-26 17:01:03,046 - â„¹ï¸ final step: 800  loss:  0.2383  grad_norm:  0.2069  tps: 9,664  tflops: 75.55  mfu: 22.19%
[rank0]:2025-12-26 17:01:03,047 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-26 17:01:03,047 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-26 17:01:03,021 -  step: 800  loss: -4.0000  grad_norm:  0.2069  memory: 13.82GiB(29.09%)  tps: 9,610  tflops: 75.12  mfu: 24.08%
[rank2]:2025-12-26 17:01:03,021 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.2069  tps: 9,656  tflops: 75.49  mfu: 22.08%
[rank2]:2025-12-26 17:01:03,021 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-26 17:01:03,022 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-26 17:01:03,024 -  step: 800  loss: -4.0000  grad_norm:  0.2069  memory: 17.85GiB(37.57%)  tps: 9,610  tflops: 75.12  mfu: 24.08%
[rank1]:2025-12-26 17:01:03,024 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.2069  tps: 9,656  tflops: 75.49  mfu: 22.08%
[rank1]:2025-12-26 17:01:03,024 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-26 17:01:03,025 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-26 17:01:03,021 -  step: 800  loss: -4.0000  grad_norm:  0.2069  memory: 15.27GiB(32.13%)  tps: 9,610  tflops: 75.12  mfu: 24.08%
[rank3]:2025-12-26 17:01:03,021 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.2069  tps: 9,660  tflops: 75.51  mfu: 22.13%
[rank3]:2025-12-26 17:01:03,021 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-26 17:01:03,022 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 17:01:05,581 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-26 17:01:05,658 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1701_stage0_final800.svg
[rank2]:2025-12-26 17:01:05,663 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1701_stage2_final800.svg
[rank1]:2025-12-26 17:01:05,658 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1701_stage1_final800.svg
[rank1]:2025-12-26 17:01:05,703 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251226_1701_stage6_final800.svg
[rank0]:2025-12-26 17:01:05,708 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251226_1701_stage7_final800.svg
[rank2]:2025-12-26 17:01:05,712 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251226_1701_stage5_final800.svg
[rank0]:2025-12-26 17:01:05,814 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank0_stage0.svg
[rank0]:	> Counts Sum: 339000, Total Sum: 437760 (77.44%), Ratio(%) per element: [65.1, 82.46, 81.77, 83.33, 82.98, 81.07, 81.59, 84.72, 82.98, 81.59, 73.95, 74.82, 75.17, 73.61, 72.91, 75.17, 72.74, 72.56, 72.74]
[rank2]:2025-12-26 17:01:05,821 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank2_stage2.svg
[rank2]:	> Counts Sum: 169720, Total Sum: 414720 (40.92%), Ratio(%) per element: [42.01, 42.7, 41.14, 40.97, 42.01, 40.79, 42.36, 42.01, 43.4, 39.23, 39.93, 40.1, 39.58, 40.79, 39.93, 40.62, 39.93, 39.06]
[rank1]:2025-12-26 17:01:05,829 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank1_stage1.svg
[rank1]:	> Counts Sum: 287800, Total Sum: 622080 (46.26%), Ratio(%) per element: [47.56, 47.91, 50.0, 47.04, 47.74, 47.56, 49.3, 49.47, 47.39, 44.61, 47.04, 45.65, 48.09, 47.74, 46.0, 46.52, 46.35, 46.0, 44.27, 42.88, 43.75, 45.13, 45.48, 44.61, 44.09, 43.92, 42.88]
[rank0]:2025-12-26 17:01:05,894 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank0_stage7.svg
[rank0]:	> Counts Sum: 196560, Total Sum: 253440 (77.56%), Ratio(%) per element: [78.47, 78.64, 77.08, 77.43, 77.77, 75.86, 79.34, 77.43, 77.6, 77.43, 76.04]
[rank2]:2025-12-26 17:01:05,931 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank2_stage5.svg
[rank2]:	> Counts Sum: 32920, Total Sum: 414720 (7.94%), Ratio(%) per element: [8.85, 8.85, 9.02, 8.15, 8.68, 8.33, 9.54, 9.72, 8.5, 6.25, 6.59, 9.02, 6.77, 7.29, 7.29, 7.11, 6.59, 6.25]
[rank1]:2025-12-26 17:01:05,928 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank1_stage6.svg
[rank1]:	> Counts Sum: 59760, Total Sum: 414720 (14.41%), Ratio(%) per element: [14.58, 14.58, 14.58, 14.4, 14.58, 14.4, 14.4, 14.58, 14.4, 13.88, 14.23, 14.23, 14.4, 14.4, 14.23, 14.75, 14.23, 14.4]
[rank3]:2025-12-26 17:01:05,932 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1701_final800_rank3.svg
[rank3]:			> Batch Time: 813.00 ms, GPU Bubble Ratio: 26.25%, 37.76%, 48.19%, 50.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-1-176ms    | [S7,MB1,F]  176-16-192ms   | [S7,MB1,BI] 204-34-238ms   | [S7,MB1,BW] 239-0-239ms    | [S7,MB2,F]  239-18-257ms   | [S7,MB2,BI] 270-35-305ms   | [S7,MB2,BW] 305-0-305ms    | [S7,MB3,F]  305-18-324ms   | [S7,MB3,BI] 337-35-372ms   | [S7,MB3,BW] 373-31-404ms   | [S0,MB7,F]  402-10-413ms   | [S0,MB0,B]  413-0-413ms    | [S7,MB4,F]  420-18-438ms   | [S7,MB4,BI] 450-34-484ms   | [S7,MB4,BW] 484-0-484ms    | [S0,MB1,B]  491-0-491ms    | [S7,MB5,F]  496-17-513ms   | [S7,MB5,BI] 525-33-559ms   | [S7,MB5,BW] 559-0-559ms    | [S0,MB2,B]  566-0-566ms    | [S7,MB6,F]  580-15-596ms   | [S7,MB6,BI] 608-33-641ms   | [S7,MB6,BW] 641-0-641ms    | [S0,MB3,B]  648-0-648ms    | [S7,MB7,F]  662-15-677ms   | [S7,MB7,BI] 689-33-722ms   | [S7,MB7,BW] 723-23-746ms   | [S0,MB4,B]  741-19-760ms   | [S0,MB5,B]  762-23-785ms   | [S0,MB6,B]  788-21-809ms   | [S0,MB7,B]  813-0-813ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 239-9-248ms    | [S6,MB1,BW] 248-10-258ms   | [S6,MB3,F]  258-7-266ms    | [S6,MB2,BI] 305-9-314ms    | [S6,MB2,BW] 314-10-325ms   | [S1,MB6,F]  325-10-336ms   | [S1,MB0,BI] 336-15-352ms   | [S1,MB0,BW] 352-15-367ms   | [S6,MB4,F]  367-8-376ms    | [S6,MB3,BI] 376-10-387ms   | [S6,MB3,BW] 387-11-398ms   | [S1,MB7,F]  413-14-427ms   | [S1,MB1,BI] 427-15-443ms   | [S1,MB1,BW] 443-15-459ms   | [S6,MB5,F]  459-8-467ms    | [S6,MB4,BI] 484-12-496ms   | [S6,MB4,BW] 497-10-508ms   | [S1,MB2,BI] 507-14-522ms   | [S1,MB2,BW] 522-15-537ms   | [S6,MB6,F]  565-7-573ms    | [S6,MB5,BI] 573-10-583ms   | [S6,MB5,BW] 583-10-594ms   | [S1,MB3,BI] 594-14-609ms   | [S1,MB3,BW] 609-12-622ms   | [S6,MB7,F]  647-7-655ms    | [S6,MB6,BI] 655-10-665ms   | [S6,MB6,BW] 665-10-676ms   | [S1,MB4,BI] 676-14-691ms   | [S6,MB7,BI] 723-10-734ms   | [S1,MB5,BI] 736-15-751ms   | [S1,MB4,BW] 751-5-757ms    | [S1,MB6,BI] 765-14-780ms   | [S1,MB5,BW] 780-3-783ms    | [S1,MB7,BI] 790-14-805ms   | [S1,MB6,BW] 805-0-805ms    | [S6,MB7,BW] 805-0-805ms    | [S1,MB7,BW] 805-0-805ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-9-106ms     | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 248-9-257ms    | [S5,MB1,BW] 258-10-268ms   | [S2,MB5,F]  268-7-276ms    | [S2,MB0,BI] 276-10-286ms   | [S2,MB0,BW] 286-9-296ms    | [S5,MB4,F]  296-7-304ms    | [S5,MB2,BI] 314-11-325ms   | [S5,MB2,BW] 325-10-336ms   | [S2,MB6,F]  337-9-347ms    | [S2,MB1,BI] 349-10-360ms   | [S2,MB1,BW] 360-10-370ms   | [S5,MB5,F]  370-7-378ms    | [S5,MB3,BI] 417-10-428ms   | [S5,MB3,BW] 428-11-439ms   | [S2,MB7,F]  439-7-447ms    | [S2,MB2,BI] 447-10-457ms   | [S2,MB2,BW] 457-9-467ms    | [S5,MB6,F]  467-7-475ms    | [S5,MB4,BI] 497-10-507ms   | [S5,MB4,BW] 508-9-517ms    | [S2,MB3,BI] 568-9-578ms    | [S2,MB3,BW] 578-10-589ms   | [S5,MB7,F]  593-7-600ms    | [S5,MB5,BI] 600-9-610ms    | [S5,MB5,BW] 610-9-619ms    | [S2,MB4,BI] 651-9-660ms    | [S5,MB6,BI] 666-10-676ms   | [S2,MB5,BI] 676-10-686ms   | [S5,MB7,BI] 738-9-747ms    | [S2,MB6,BI] 747-11-758ms   | [S2,MB4,BW] 759-8-767ms    | [S2,MB7,BI] 774-9-784ms    | [S2,MB5,BW] 784-0-784ms    | [S5,MB6,BW] 784-10-794ms   | [S5,MB7,BW] 794-5-799ms    | [S2,MB6,BW] 800-0-800ms    | [S2,MB7,BW] 800-0-800ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 258-11-269ms   | [S4,MB1,BW] 269-10-279ms   | [S3,MB5,F]  279-8-288ms    | [S3,MB1,BI] 288-9-298ms    | [S3,MB1,BW] 298-10-308ms   | [S4,MB5,F]  308-8-317ms    | [S4,MB2,BI] 341-11-353ms   | [S4,MB2,BW] 353-9-363ms    | [S3,MB6,F]  363-7-370ms    | [S3,MB2,BI] 370-9-380ms    | [S3,MB2,BW] 380-10-390ms   | [S4,MB6,F]  390-8-399ms    | [S4,MB3,BI] 433-10-443ms   | [S4,MB3,BW] 443-10-454ms   | [S3,MB7,F]  454-7-461ms    | [S3,MB3,BI] 461-9-471ms    | [S3,MB3,BW] 471-9-481ms    | [S4,MB7,F]  481-7-489ms    | [S4,MB4,BI] 562-10-572ms   | [S4,MB4,BW] 572-9-582ms    | [S3,MB4,BI] 582-10-592ms   | [S4,MB5,BI] 644-10-654ms   | [S3,MB5,BI] 654-9-663ms    | [S4,MB6,BI] 676-9-686ms    | [S3,MB6,BI] 686-9-695ms    | [S4,MB7,BI] 749-9-758ms    | [S3,MB7,BI] 758-9-767ms    | [S3,MB4,BW] 768-0-768ms    | [S4,MB5,BW] 768-10-778ms   | [S4,MB6,BW] 778-9-787ms    | [S4,MB7,BW] 787-6-793ms    | [S3,MB5,BW] 793-0-793ms    | [S3,MB6,BW] 793-0-793ms    | [S3,MB7,BW] 793-0-793ms   
[rank3]:2025-12-26 17:01:06,270 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251226_1701_thry_final800_rank3.svg
[rank3]:			> Batch Time: 468.88 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S0,MB4,F]  39-9-48ms      | [S0,MB5,F]  48-9-58ms      | [S0,MB6,F]  58-9-68ms      | [S7,MB0,F]  68-9-78ms      | [S7,MB0,BI] 78-9-87ms      | [S7,MB0,BW] 87-9-97ms      | [S7,MB1,F]  97-9-107ms     | [S7,MB1,BI] 107-9-117ms    | [S7,MB1,BW] 117-9-126ms    | [S7,MB2,F]  126-9-136ms    | [S7,MB2,BI] 136-9-146ms    | [S7,MB2,BW] 146-9-156ms    | [S7,MB3,F]  156-9-166ms    | [S7,MB3,BI] 166-9-175ms    | [S7,MB3,BW] 175-9-185ms    | [S0,MB7,F]  185-9-195ms    | [S0,MB0,B]  195-19-214ms   | [S7,MB4,F]  214-9-224ms    | [S7,MB4,BI] 224-9-234ms    | [S7,MB4,BW] 234-9-244ms    | [S0,MB1,B]  244-19-263ms   | [S7,MB5,F]  263-9-273ms    | [S7,MB5,BI] 273-9-283ms    | [S7,MB5,BW] 283-9-293ms    | [S0,MB2,B]  293-19-312ms   | [S7,MB6,F]  312-9-322ms    | [S7,MB6,BI] 322-9-332ms    | [S7,MB6,BW] 332-9-341ms    | [S0,MB3,B]  341-19-361ms   | [S7,MB7,F]  361-9-371ms    | [S7,MB7,BI] 371-9-380ms    | [S7,MB7,BW] 380-9-390ms    | [S0,MB4,B]  390-19-410ms   | [S0,MB5,B]  410-19-429ms   | [S0,MB6,B]  429-19-449ms   | [S0,MB7,B]  449-19-468ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB3,F]  39-9-48ms      | [S1,MB4,F]  48-9-58ms      | [S6,MB0,F]  58-9-68ms      | [S1,MB5,F]  68-9-78ms      | [S6,MB1,F]  78-9-87ms      | [S6,MB0,BI] 87-9-97ms      | [S6,MB0,BW] 97-9-107ms     | [S6,MB2,F]  107-9-117ms    | [S6,MB1,BI] 117-9-126ms    | [S6,MB1,BW] 126-9-136ms    | [S6,MB3,F]  136-9-146ms    | [S6,MB2,BI] 146-9-156ms    | [S6,MB2,BW] 156-9-166ms    | [S1,MB6,F]  166-9-175ms    | [S1,MB0,BI] 175-9-185ms    | [S1,MB0,BW] 185-9-195ms    | [S6,MB4,F]  195-9-205ms    | [S6,MB3,BI] 205-9-214ms    | [S6,MB3,BW] 214-9-224ms    | [S1,MB7,F]  224-9-234ms    | [S1,MB1,BI] 234-9-244ms    | [S1,MB1,BW] 244-9-253ms    | [S6,MB5,F]  253-9-263ms    | [S6,MB4,BI] 263-9-273ms    | [S6,MB4,BW] 273-9-283ms    | [S1,MB2,BI] 283-9-293ms    | [S1,MB2,BW] 293-9-302ms    | [S6,MB6,F]  302-9-312ms    | [S6,MB5,BI] 312-9-322ms    | [S6,MB5,BW] 322-9-332ms    | [S1,MB3,BI] 332-9-341ms    | [S1,MB3,BW] 341-9-351ms    | [S6,MB7,F]  351-9-361ms    | [S6,MB6,BI] 361-9-371ms    | [S6,MB6,BW] 371-9-380ms    | [S1,MB4,BI] 380-9-390ms    | [S6,MB7,BI] 390-9-400ms    | [S1,MB5,BI] 400-9-410ms    | [S1,MB4,BW] 410-9-420ms    | [S1,MB6,BI] 420-9-429ms    | [S1,MB5,BW] 429-9-439ms    | [S1,MB7,BI] 439-9-449ms    | [S1,MB6,BW] 449-9-459ms    | [S6,MB7,BW] 459-9-468ms    | [S1,MB7,BW] 468-9-478ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB2,F]  39-9-48ms      | [S5,MB0,F]  48-9-58ms      | [S2,MB3,F]  58-9-68ms      | [S5,MB1,F]  68-9-78ms      | [S2,MB4,F]  78-9-87ms      | [S5,MB2,F]  87-9-97ms      | [S5,MB0,BI] 97-9-107ms     | [S5,MB0,BW] 107-9-117ms    | [S5,MB3,F]  117-9-126ms    | [S5,MB1,BI] 126-9-136ms    | [S5,MB1,BW] 136-9-146ms    | [S2,MB5,F]  146-9-156ms    | [S2,MB0,BI] 156-9-166ms    | [S2,MB0,BW] 166-9-175ms    | [S5,MB4,F]  175-9-185ms    | [S5,MB2,BI] 185-9-195ms    | [S5,MB2,BW] 195-9-205ms    | [S2,MB6,F]  205-9-214ms    | [S2,MB1,BI] 214-9-224ms    | [S2,MB1,BW] 224-9-234ms    | [S5,MB5,F]  234-9-244ms    | [S5,MB3,BI] 244-9-253ms    | [S5,MB3,BW] 253-9-263ms    | [S2,MB7,F]  263-9-273ms    | [S2,MB2,BI] 273-9-283ms    | [S2,MB2,BW] 283-9-293ms    | [S5,MB6,F]  293-9-302ms    | [S5,MB4,BI] 302-9-312ms    | [S5,MB4,BW] 312-9-322ms    | [S2,MB3,BI] 322-9-332ms    | [S2,MB3,BW] 332-9-341ms    | [S5,MB7,F]  341-9-351ms    | [S5,MB5,BI] 351-9-361ms    | [S5,MB5,BW] 361-9-371ms    | [S2,MB4,BI] 371-9-380ms    | [S5,MB6,BI] 380-9-390ms    | [S2,MB5,BI] 390-9-400ms    | [S5,MB7,BI] 400-9-410ms    | [S2,MB6,BI] 410-9-420ms    | [S2,MB4,BW] 420-9-429ms    | [S2,MB7,BI] 429-9-439ms    | [S2,MB5,BW] 439-9-449ms    | [S5,MB6,BW] 449-9-459ms    | [S5,MB7,BW] 459-9-468ms    | [S2,MB6,BW] 468-9-478ms    | [S2,MB7,BW] 478-9-488ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S4,MB0,F]  39-9-48ms      | [S3,MB1,F]  48-9-58ms      | [S4,MB1,F]  58-9-68ms      | [S3,MB2,F]  68-9-78ms      | [S4,MB2,F]  78-9-87ms      | [S3,MB3,F]  87-9-97ms      | [S4,MB3,F]  97-9-107ms     | [S4,MB0,BI] 107-9-117ms    | [S4,MB0,BW] 117-9-126ms    | [S3,MB4,F]  126-9-136ms    | [S3,MB0,BI] 136-9-146ms    | [S3,MB0,BW] 146-9-156ms    | [S4,MB4,F]  156-9-166ms    | [S4,MB1,BI] 166-9-175ms    | [S4,MB1,BW] 175-9-185ms    | [S3,MB5,F]  185-9-195ms    | [S3,MB1,BI] 195-9-205ms    | [S3,MB1,BW] 205-9-214ms    | [S4,MB5,F]  214-9-224ms    | [S4,MB2,BI] 224-9-234ms    | [S4,MB2,BW] 234-9-244ms    | [S3,MB6,F]  244-9-253ms    | [S3,MB2,BI] 253-9-263ms    | [S3,MB2,BW] 263-9-273ms    | [S4,MB6,F]  273-9-283ms    | [S4,MB3,BI] 283-9-293ms    | [S4,MB3,BW] 293-9-302ms    | [S3,MB7,F]  302-9-312ms    | [S3,MB3,BI] 312-9-322ms    | [S3,MB3,BW] 322-9-332ms    | [S4,MB7,F]  332-9-341ms    | [S4,MB4,BI] 341-9-351ms    | [S4,MB4,BW] 351-9-361ms    | [S3,MB4,BI] 361-9-371ms    | [S4,MB5,BI] 371-9-380ms    | [S3,MB5,BI] 380-9-390ms    | [S4,MB6,BI] 390-9-400ms    | [S3,MB6,BI] 400-9-410ms    | [S4,MB7,BI] 410-9-420ms    | [S3,MB7,BI] 420-9-429ms    | [S3,MB4,BW] 429-9-439ms    | [S4,MB5,BW] 439-9-449ms    | [S4,MB6,BW] 449-9-459ms    | [S4,MB7,BW] 459-9-468ms    | [S3,MB5,BW] 468-9-478ms    | [S3,MB6,BW] 478-9-488ms    | [S3,MB7,BW] 488-9-498ms   
[rank3]:2025-12-26 17:01:06,317 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1701_stage3_final800.svg
[rank3]:2025-12-26 17:01:06,364 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251226_1701_stage4_final800.svg
[rank3]:2025-12-26 17:01:06,465 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank3_stage3.svg
[rank3]:	> Counts Sum: 204480, Total Sum: 414720 (49.31%), Ratio(%) per element: [48.78, 49.13, 50.17, 49.47, 49.65, 50.0, 49.47, 50.0, 49.13, 48.78, 48.78, 50.34, 48.78, 49.13, 48.43, 49.65, 48.95, 48.78]
[rank3]:2025-12-26 17:01:06,568 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251226_1701_rank3_stage4.svg
[rank3]:	> Counts Sum: 32920, Total Sum: 414720 (7.94%), Ratio(%) per element: [10.41, 9.89, 9.54, 8.85, 8.85, 7.98, 9.54, 9.37, 9.89, 6.59, 6.59, 7.46, 5.55, 6.42, 5.55, 6.07, 7.63, 6.59]
[rank0]:2025-12-26 17:01:06,878 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage0.svg
[rank1]:2025-12-26 17:01:06,886 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage1.svg
[rank2]:2025-12-26 17:01:07,019 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage2.svg
[rank3]:2025-12-26 17:01:07,514 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage3.svg
[rank0]:2025-12-26 17:01:07,848 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage7.svg
[rank0]:2025-12-26 17:01:07,852 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-26 17:01:07,810 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage6.svg
[rank1]:2025-12-26 17:01:07,814 - Destroying the purge thread.
[rank1]:2025-12-26 17:01:07,951 - Process group destroyed
[rank2]:2025-12-26 17:01:08,058 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage5.svg
[rank2]:2025-12-26 17:01:08,062 - Destroying the purge thread.
[rank2]:2025-12-26 17:01:08,480 - Process group destroyed
[rank3]:2025-12-26 17:01:08,435 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251226_1701_stage4.svg
[rank3]:2025-12-26 17:01:08,439 - Destroying the purge thread.
[rank3]:2025-12-26 17:01:08,876 - Process group destroyed
[rank0]:2025-12-26 17:01:09,853 - Training completed
[rank0]:2025-12-26 17:01:09,854 - Destroying the purge thread.
[rank0]:wandb: updating run metadata
[rank0]:wandb: uploading history steps 15-16, summary, console lines 130-146
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.39083
[rank0]:wandb:               final/avg_loss 0.23831
[rank0]:wandb:             final/avg_mfu(%) 22.19128
[rank0]:wandb:             final/avg_tflops 75.54654
[rank0]:wandb:    final/avg_throughput(tps) 9663.72399
[rank0]:wandb:              final/grad_norm 0.20688
[rank0]:wandb:               final/max_loss 0.23831
[rank0]:wandb:                    grad_norm 0.20688
[rank0]:wandb: loss_metrics/global_avg_loss 0.23831
[rank0]:wandb: loss_metrics/global_max_loss 0.23831
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_timelyauto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/gx8xdmet
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyauto_42_dm1/20251226-1612/wandb/run-20251226_161259-gx8xdmet/logs
[rank0]:2025-12-26 17:01:10,973 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings'}
[rank0]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
