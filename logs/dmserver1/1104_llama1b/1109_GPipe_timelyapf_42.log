
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 11. (í™”) 18:54:00 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_GPipe_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-11 18:54:06,645 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank0]:2025-11-11 18:54:06,648 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank3]:2025-11-11 18:54:06,695 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank2]:2025-11-11 18:54:06,645 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank0]:2025-11-11 18:54:06,854 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-11 18:54:06,856 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 18:54:06,859 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-11 18:54:06,860 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-11 18:54:06,926 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-11 18:54:06,928 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-11 18:54:06,977 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-11 18:54:06,980 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-11 18:54:06,932 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-11 18:54:06,934 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 18:54:07,262 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-11-11 18:54:10,248 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-11 18:54:10,286 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 18:54:10,307 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-11 18:54:10,307 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-11 18:54:10,362 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-11 18:54:10,490 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 18:54:10,491 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-11 18:54:10,491 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-11 18:54:10,511 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-11 18:54:10,504 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-11 18:54:10,550 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 18:54:10,551 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-11 18:54:10,578 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-11 18:54:10,578 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-11 18:54:10,543 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 18:54:10,569 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-11 18:54:10,569 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-11 18:54:10,762 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 18:54:10,762 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-11 18:54:10,763 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-11 18:54:10,754 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 18:54:10,754 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-11 18:54:10,754 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ssu68twz
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_GPipe_timelyapf_42_dm1/20251111-1854/wandb/run-20251111_185411-ssu68twz
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_GPipe_timelyapf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ssu68twz
[rank3]:2025-11-11 18:54:12,409 - INFO - WandB logging enabled
[rank3]:2025-11-11 18:54:12,410 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-11 18:54:12,449 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-11 18:54:12,475 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-11 18:54:12,476 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-11 18:54:12,685 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 18:54:12,685 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_GPipe_timelyapf_42_dm1
[rank3]:2025-11-11 18:54:12,667 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 18:54:12,685 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-11 18:54:12,668 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-11 18:54:12,669 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-11 18:54:12,685 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 18:54:12,685 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 18:54:12,685 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-11 18:54:12,685 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-11 18:54:15,749 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-11 18:54:15,749 - INFO - Finished loading the checkpoint in 3.06 seconds.
[rank0]:2025-11-11 18:54:15,749 - INFO - Training starts at step 1
[rank1]:2025-11-11 18:54:21,365 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5373  memory: 12.38GiB(26.05%)  tps: 2,958  tflops: 23.12  mfu: 7.41%
[rank1]:2025-11-11 18:54:21,365 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-11 18:54:21,398 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5373  memory: 12.80GiB(26.95%)  tps: 3,021  tflops: 23.61  mfu: 7.57%
[rank0]:2025-11-11 18:54:21,399 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-11 18:54:21,364 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5373  memory: 24.19GiB(50.91%)  tps: 3,677  tflops: 28.74  mfu: 9.21%
[rank3]:2025-11-11 18:54:21,364 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-11 18:54:21,355 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5373  memory:  9.99GiB(21.03%)  tps: 3,031  tflops: 23.69  mfu: 7.59%
[rank2]:2025-11-11 18:54:21,355 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-11 18:56:18,909 - INFO - Avg. fwd time: 10.7507 / Avg. bwd time: 42.6253 / Avg. batch time: 486.9615 (ms) / GPU bubble ratio: 12.31%
[rank2]:2025-11-11 18:56:18,983 - INFO - Avg. fwd time: 7.1599 / Avg. bwd time: 18.8712 / Avg. batch time: 519.0572 (ms) / GPU bubble ratio: 59.88%
[rank1]:2025-11-11 18:56:19,022 - INFO - Avg. fwd time: 9.2222 / Avg. bwd time: 24.2501 / Avg. batch time: 558.7798 (ms) / GPU bubble ratio: 52.08%
[rank0]:2025-11-11 18:56:19,029 - INFO - Avg. fwd time: 8.1026 / Avg. bwd time: 24.0654 / Avg. batch time: 596.9897 (ms) / GPU bubble ratio: 56.89%
[rank0]:2025-11-11 18:58:17,611 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 18:58:22,238 - INFO - Avg. fwd time: 10.8079 / Avg. bwd time: 42.9574 / Avg. batch time: 489.9545 (ms) / GPU bubble ratio: 12.21%
[rank1]:2025-11-11 18:58:22,349 - INFO - Avg. fwd time: 9.2408 / Avg. bwd time: 24.3199 / Avg. batch time: 560.8567 (ms) / GPU bubble ratio: 52.13%
[rank0]:2025-11-11 18:58:22,356 - INFO - Avg. fwd time: 8.1299 / Avg. bwd time: 24.1220 / Avg. batch time: 598.5352 (ms) / GPU bubble ratio: 56.89%
[rank2]:2025-11-11 18:58:22,309 - INFO - Avg. fwd time: 7.1700 / Avg. bwd time: 18.9250 / Avg. batch time: 521.6018 (ms) / GPU bubble ratio: 59.98%
[rank3]:2025-11-11 18:58:22,535 - INFO -  step: 50  loss:  9.9171  grad_norm: 12.7592  memory: 26.98GiB(56.79%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank1]:2025-11-11 18:58:22,526 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7592  memory: 14.64GiB(30.82%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank0]:2025-11-11 18:58:22,537 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7592  memory: 16.57GiB(34.88%)  tps: 6,659  tflops: 52.05  mfu: 16.68%
[rank2]:2025-11-11 18:58:22,522 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7592  memory: 11.81GiB(24.85%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank3]:2025-11-11 18:59:11,945 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-11 19:00:01,268 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-11 19:00:01,582 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-11 19:00:01,661 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:00:01,679 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:00:01,692 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,670 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,690 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:01,678 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,666 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,683 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:00:01,720 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:00:01,757 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,704 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,714 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,724 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:01,703 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:01,719 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:01,749 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,704 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,741 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,778 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:00:01,793 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:00:01,840 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-11 19:00:01,877 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:01,879 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,862 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,901 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,903 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,942 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:01,984 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:01,920 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:01,962 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-11 19:00:01,943 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-11 19:00:02,003 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-11 19:00:18,175 - INFO - Avg. fwd time: 8.2125 / Avg. bwd time: 22.5645 / Avg. batch time: 586.2128 (ms) / GPU bubble ratio: 58.00%
[rank3]:2025-11-11 19:00:18,136 - INFO - Avg. fwd time: 10.9952 / Avg. bwd time: 41.6840 / Avg. batch time: 481.2190 (ms) / GPU bubble ratio: 12.42%
[rank1]:2025-11-11 19:00:18,169 - INFO - Avg. fwd time: 9.3654 / Avg. bwd time: 23.4604 / Avg. batch time: 550.2883 (ms) / GPU bubble ratio: 52.28%
[rank2]:2025-11-11 19:00:18,152 - INFO - Avg. fwd time: 7.2676 / Avg. bwd time: 18.2693 / Avg. batch time: 512.0524 (ms) / GPU bubble ratio: 60.10%
[rank3]:2025-11-11 19:00:34,358 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-11 19:00:34,712 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1900_max_batch_time.svg
[rank3]:> Batch Time: 525.57 ms, GPU Bubble Ratio: 50.67%, 48.92%, 60.22%, 18.49%
[rank3]:2025-11-11 19:00:34,863 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1900_min_batch_time.svg
[rank3]:> Batch Time: 304.88 ms, GPU Bubble Ratio: 78.68%, 47.39%, 58.96%, 16.07%
[rank3]:2025-11-11 19:00:35,026 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1900_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 336.43 ms, GPU Bubble Ratio: 41.17%, 32.47%, 40.99%, 14.56%
[rank3]:2025-11-11 19:00:35,027 - INFO - 	> Batch Time: 336.43 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.36)
[rank0]:2025-11-11 19:01:49,352 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 19:01:53,704 - INFO - Avg. fwd time: 11.4204 / Avg. bwd time: 38.3740 / Avg. batch time: 458.0999 (ms) / GPU bubble ratio: 13.04%
[rank0]:2025-11-11 19:01:53,810 - INFO - Avg. fwd time: 8.3903 / Avg. bwd time: 19.0214 / Avg. batch time: 555.8656 (ms) / GPU bubble ratio: 60.55%
[rank1]:2025-11-11 19:01:53,827 - INFO - Avg. fwd time: 9.7010 / Avg. bwd time: 21.1735 / Avg. batch time: 523.5103 (ms) / GPU bubble ratio: 52.82%
[rank2]:2025-11-11 19:01:53,770 - INFO - Avg. fwd time: 7.5342 / Avg. bwd time: 16.5146 / Avg. batch time: 487.6337 (ms) / GPU bubble ratio: 60.55%
[rank1]:2025-11-11 19:01:54,012 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.08/0.24, [MB2] 0.00/0.00, [MB3] 0.15/0.44, [MB4] 0.07/0.22, [MB5] 0.07/0.20, [MB6] 0.32/0.97, [MB7] 0.33/1.00
[rank1]:2025-11-11 19:01:54,013 - INFO -  step: 100  loss: -8.0000  grad_norm:  7.4889  memory: 15.78GiB(33.21%)  tps: 7,747  tflops: 60.56  mfu: 19.41%
[rank3]:2025-11-11 19:01:54,032 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-11-11 19:01:54,007 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-11 19:01:54,008 - INFO -  step: 100  loss: -8.0000  grad_norm:  7.4889  memory: 12.72GiB(26.78%)  tps: 7,747  tflops: 60.56  mfu: 19.41%
[rank0]:2025-11-11 19:01:54,044 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.08/0.24, [MB3] 0.04/0.11, [MB4] 0.04/0.11, [MB5] 0.18/0.53, [MB6] 0.18/0.55, [MB7] 0.33/1.00
[rank0]:2025-11-11 19:01:54,044 - INFO -  step: 100  loss: -8.0000  grad_norm:  7.4889  memory: 18.45GiB(38.83%)  tps: 7,746  tflops: 60.56  mfu: 19.41%
[rank0]:2025-11-11 19:01:54,106 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1901_stage0_step100.svg
[rank1]:2025-11-11 19:01:54,121 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1901_stage1_step100.svg
[rank3]:2025-11-11 19:01:54,036 - INFO -  step: 100  loss:  9.1335  grad_norm:  7.4889  memory: 32.41GiB(68.22%)  tps: 7,747  tflops: 60.56  mfu: 19.41%
[rank2]:2025-11-11 19:01:54,122 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1901_stage2_step100.svg
[rank3]:2025-11-11 19:01:54,256 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1901_real_step100_rank3.svg
[rank3]:> Batch Time: 564.12 ms, GPU Bubble Ratio: 56.79%, 58.79%, 67.48%, 27.36%
[rank3]:2025-11-11 19:01:54,303 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1901_stage3_step100.svg
[rank3]:2025-11-11 19:03:39,416 - INFO - Avg. fwd time: 11.5257 / Avg. bwd time: 37.3887 / Avg. batch time: 451.0453 (ms) / GPU bubble ratio: 13.24%
[rank1]:2025-11-11 19:03:39,543 - INFO - Avg. fwd time: 9.7694 / Avg. bwd time: 20.6584 / Avg. batch time: 515.4750 (ms) / GPU bubble ratio: 52.78%
[rank2]:2025-11-11 19:03:39,492 - INFO - Avg. fwd time: 7.5929 / Avg. bwd time: 16.0956 / Avg. batch time: 480.1350 (ms) / GPU bubble ratio: 60.53%
[rank0]:2025-11-11 19:03:39,526 - INFO - Avg. fwd time: 8.4565 / Avg. bwd time: 18.6444 / Avg. batch time: 547.4556 (ms) / GPU bubble ratio: 60.40%
[rank0]:2025-11-11 19:05:12,341 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-11 19:05:16,017 - INFO - Avg. fwd time: 7.6832 / Avg. bwd time: 15.4976 / Avg. batch time: 467.9061 (ms) / GPU bubble ratio: 60.37%
[rank1]:2025-11-11 19:05:16,042 - INFO - Avg. fwd time: 9.8735 / Avg. bwd time: 19.9624 / Avg. batch time: 502.5266 (ms) / GPU bubble ratio: 52.50%
[rank3]:2025-11-11 19:05:15,995 - INFO - Avg. fwd time: 11.7275 / Avg. bwd time: 35.7525 / Avg. batch time: 439.5546 (ms) / GPU bubble ratio: 13.59%
[rank2]:2025-11-11 19:05:16,077 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-11 19:05:16,077 - INFO -  step: 150  loss: -8.0000  grad_norm:  0.3911  memory: 13.37GiB(28.14%)  tps: 8,108  tflops: 63.39  mfu: 20.32%
[rank3]:2025-11-11 19:05:16,076 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-11 19:05:16,080 - INFO -  step: 150  loss:  5.9673  grad_norm:  0.3911  memory: 33.45GiB(70.40%)  tps: 8,109  tflops: 63.39  mfu: 20.32%
[rank0]:2025-11-11 19:05:16,063 - INFO - Avg. fwd time: 8.5731 / Avg. bwd time: 17.7702 / Avg. batch time: 533.6329 (ms) / GPU bubble ratio: 60.51%
[rank0]:2025-11-11 19:05:16,077 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.16/0.24, [MB3] 0.07/0.11, [MB4] 0.07/0.11, [MB5] 0.36/0.53, [MB6] 0.37/0.55, [MB7] 0.67/1.00
[rank1]:2025-11-11 19:05:16,083 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.16/0.24, [MB2] 0.00/0.00, [MB3] 0.29/0.44, [MB4] 0.14/0.22, [MB5] 0.13/0.20, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank0]:2025-11-11 19:05:16,078 - INFO -  step: 150  loss: -8.0000  grad_norm:  0.3911  memory: 19.13GiB(40.27%)  tps: 8,110  tflops: 63.40  mfu: 20.32%
[rank1]:2025-11-11 19:05:16,084 - INFO -  step: 150  loss: -8.0000  grad_norm:  0.3911  memory: 16.71GiB(35.18%)  tps: 8,108  tflops: 63.39  mfu: 20.32%
[rank3]:2025-11-11 19:06:49,279 - INFO - Avg. fwd time: 11.8951 / Avg. bwd time: 34.3665 / Avg. batch time: 429.7964 (ms) / GPU bubble ratio: 13.89%
[rank2]:2025-11-11 19:06:49,356 - INFO - Avg. fwd time: 7.7502 / Avg. bwd time: 15.0439 / Avg. batch time: 457.6097 (ms) / GPU bubble ratio: 60.15%
[rank1]:2025-11-11 19:06:49,405 - INFO - Avg. fwd time: 9.9776 / Avg. bwd time: 19.2487 / Avg. batch time: 491.5029 (ms) / GPU bubble ratio: 52.43%
[rank0]:2025-11-11 19:06:49,381 - INFO - Avg. fwd time: 8.6586 / Avg. bwd time: 17.2508 / Avg. batch time: 522.0928 (ms) / GPU bubble ratio: 60.30%
[rank0]:2025-11-11 19:08:15,358 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 19:08:18,579 - INFO - Avg. fwd time: 12.0337 / Avg. bwd time: 33.1736 / Avg. batch time: 421.3487 (ms) / GPU bubble ratio: 14.17%
[rank1]:2025-11-11 19:08:18,667 - INFO - Avg. fwd time: 10.1015 / Avg. bwd time: 18.3805 / Avg. batch time: 481.4128 (ms) / GPU bubble ratio: 52.67%
[rank0]:2025-11-11 19:08:18,635 - INFO - Avg. fwd time: 8.7553 / Avg. bwd time: 16.3957 / Avg. batch time: 511.1474 (ms) / GPU bubble ratio: 60.64%
[rank2]:2025-11-11 19:08:18,631 - INFO - Avg. fwd time: 7.8484 / Avg. bwd time: 14.3790 / Avg. batch time: 448.4181 (ms) / GPU bubble ratio: 60.35%
[rank1]:2025-11-11 19:08:18,773 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.24/0.24, [MB2] 0.00/0.00, [MB3] 0.44/0.44, [MB4] 0.22/0.22, [MB5] 0.20/0.20, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-11 19:08:18,773 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.2272  memory: 16.71GiB(35.18%)  tps: 8,968  tflops: 70.11  mfu: 22.47%
[rank3]:2025-11-11 19:08:18,769 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-11 19:08:18,773 - INFO -  step: 200  loss:  3.8650  grad_norm:  0.2272  memory: 33.45GiB(70.40%)  tps: 8,968  tflops: 70.11  mfu: 22.47%
[rank0]:2025-11-11 19:08:18,770 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.24/0.24, [MB3] 0.11/0.11, [MB4] 0.11/0.11, [MB5] 0.53/0.53, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-11 19:08:18,771 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.2272  memory: 19.13GiB(40.27%)  tps: 8,968  tflops: 70.11  mfu: 22.47%
[rank2]:2025-11-11 19:08:18,770 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-11 19:08:18,771 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.2272  memory: 13.37GiB(28.14%)  tps: 8,968  tflops: 70.11  mfu: 22.47%
[rank1]:2025-11-11 19:08:18,842 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1908_stage1_step200.svg
[rank0]:2025-11-11 19:08:18,832 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1908_stage0_step200.svg
[rank2]:2025-11-11 19:08:18,842 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1908_stage2_step200.svg
[rank3]:2025-11-11 19:08:18,981 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1908_real_step200_rank3.svg
[rank3]:> Batch Time: 406.59 ms, GPU Bubble Ratio: 64.87%, 54.13%, 64.67%, 31.74%
[rank3]:2025-11-11 19:08:19,041 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1908_stage3_step200.svg
[rank1]:2025-11-11 19:09:40,775 - INFO - Avg. fwd time: 10.2268 / Avg. bwd time: 17.5202 / Avg. batch time: 470.1917 (ms) / GPU bubble ratio: 52.79%
[rank2]:2025-11-11 19:09:40,756 - INFO - Avg. fwd time: 7.9500 / Avg. bwd time: 13.6964 / Avg. batch time: 438.0730 (ms) / GPU bubble ratio: 60.47%
[rank3]:2025-11-11 19:09:40,738 - INFO - Avg. fwd time: 12.2104 / Avg. bwd time: 31.7860 / Avg. batch time: 411.6500 (ms) / GPU bubble ratio: 14.50%
[rank0]:2025-11-11 19:09:40,783 - INFO - Avg. fwd time: 8.8166 / Avg. bwd time: 14.5343 / Avg. batch time: 498.0143 (ms) / GPU bubble ratio: 62.49%
[rank0]:2025-11-11 19:10:59,419 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 19:11:02,321 - INFO - Avg. fwd time: 8.8560 / Avg. bwd time: 13.2132 / Avg. batch time: 488.8300 (ms) / GPU bubble ratio: 63.88%
[rank3]:2025-11-11 19:11:02,498 - INFO - Avg. fwd time: 12.3306 / Avg. bwd time: 30.8309 / Avg. batch time: 404.9619 (ms) / GPU bubble ratio: 14.73%
[rank2]:2025-11-11 19:11:02,539 - INFO - Avg. fwd time: 8.0198 / Avg. bwd time: 13.2215 / Avg. batch time: 430.8560 (ms) / GPU bubble ratio: 60.56%
[rank3]:2025-11-11 19:11:02,660 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-11 19:11:02,673 - INFO -  step: 250  loss:  6.7026  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 9,996  tflops: 78.15  mfu: 25.05%
[rank2]:2025-11-11 19:11:02,660 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-11 19:11:02,671 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 9,996  tflops: 78.15  mfu: 25.05%
[rank0]:2025-11-11 19:11:02,673 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.24/0.24, [MB3] 0.11/0.11, [MB4] 0.11/0.11, [MB5] 0.53/0.53, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-11 19:11:02,673 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 9,996  tflops: 78.15  mfu: 25.05%
[rank1]:2025-11-11 19:11:02,582 - INFO - Avg. fwd time: 10.3136 / Avg. bwd time: 16.9209 / Avg. batch time: 462.3642 (ms) / GPU bubble ratio: 52.88%
[rank1]:2025-11-11 19:11:02,673 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.24/0.24, [MB2] 0.00/0.00, [MB3] 0.44/0.44, [MB4] 0.22/0.22, [MB5] 0.20/0.20, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-11 19:11:02,674 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 9,996  tflops: 78.15  mfu: 25.05%
[rank0]:2025-11-11 19:12:24,471 - INFO - Avg. fwd time: 8.8984 / Avg. bwd time: 11.9464 / Avg. batch time: 480.1164 (ms) / GPU bubble ratio: 65.27%
[rank3]:2025-11-11 19:12:24,629 - INFO - Avg. fwd time: 12.4488 / Avg. bwd time: 29.9205 / Avg. batch time: 398.6203 (ms) / GPU bubble ratio: 14.97%
[rank1]:2025-11-11 19:12:24,713 - INFO - Avg. fwd time: 10.3983 / Avg. bwd time: 16.3476 / Avg. batch time: 454.9339 (ms) / GPU bubble ratio: 52.97%
[rank2]:2025-11-11 19:12:24,666 - INFO - Avg. fwd time: 8.0871 / Avg. bwd time: 12.7666 / Avg. batch time: 424.0081 (ms) / GPU bubble ratio: 60.65%
[rank0]:2025-11-11 19:13:43,582 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 19:13:46,811 - INFO - Avg. fwd time: 12.5470 / Avg. bwd time: 29.1700 / Avg. batch time: 393.3968 (ms) / GPU bubble ratio: 15.17%
[rank2]:2025-11-11 19:13:46,828 - INFO - Avg. fwd time: 8.1426 / Avg. bwd time: 12.3916 / Avg. batch time: 418.3726 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-11-11 19:13:46,848 - INFO - Avg. fwd time: 10.4682 / Avg. bwd time: 15.8751 / Avg. batch time: 448.8190 (ms) / GPU bubble ratio: 53.04%
[rank1]:2025-11-11 19:13:46,853 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.24/0.24, [MB2] 0.00/0.00, [MB3] 0.44/0.44, [MB4] 0.22/0.22, [MB5] 0.20/0.20, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-11 19:13:46,859 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 9,979  tflops: 78.01  mfu: 25.00%
[rank1]:2025-11-11 19:13:46,917 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1913_stage1_step300.svg
[rank3]:2025-11-11 19:13:46,839 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-11 19:13:46,861 - INFO -  step: 300  loss:  6.7939  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 9,979  tflops: 78.01  mfu: 25.00%
[rank0]:2025-11-11 19:13:46,857 - INFO - Avg. fwd time: 8.9319 / Avg. bwd time: 10.9013 / Avg. batch time: 472.9360 (ms) / GPU bubble ratio: 66.45%
[rank0]:2025-11-11 19:13:46,860 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.24/0.24, [MB3] 0.11/0.11, [MB4] 0.11/0.11, [MB5] 0.53/0.53, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-11 19:13:46,860 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 9,979  tflops: 78.01  mfu: 25.00%
[rank0]:2025-11-11 19:13:46,917 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1913_stage0_step300.svg
[rank2]:2025-11-11 19:13:46,838 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-11 19:13:46,859 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 9,979  tflops: 78.01  mfu: 25.00%
[rank2]:2025-11-11 19:13:46,917 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1913_stage2_step300.svg
[rank3]:2025-11-11 19:13:47,076 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1913_real_step300_rank3.svg
[rank3]:> Batch Time: 398.50 ms, GPU Bubble Ratio: 81.42%, 55.50%, 65.43%, 29.82%
[rank3]:2025-11-11 19:13:47,136 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1913_stage3_step300.svg
[rank0]:2025-11-11 19:15:08,913 - INFO - Avg. fwd time: 8.9565 / Avg. bwd time: 10.1409 / Avg. batch time: 467.8579 (ms) / GPU bubble ratio: 67.35%
[rank3]:2025-11-11 19:15:09,094 - INFO - Avg. fwd time: 12.6212 / Avg. bwd time: 28.6304 / Avg. batch time: 389.6716 (ms) / GPU bubble ratio: 15.31%
[rank1]:2025-11-11 19:15:09,178 - INFO - Avg. fwd time: 10.5207 / Avg. bwd time: 15.5327 / Avg. batch time: 444.5138 (ms) / GPU bubble ratio: 53.11%
[rank2]:2025-11-11 19:15:09,131 - INFO - Avg. fwd time: 8.1838 / Avg. bwd time: 12.1198 / Avg. batch time: 414.4194 (ms) / GPU bubble ratio: 60.81%
[rank0]:2025-11-11 19:16:28,262 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 19:16:31,177 - INFO - Avg. fwd time: 8.9793 / Avg. bwd time: 9.3777 / Avg. batch time: 462.6284 (ms) / GPU bubble ratio: 68.26%
[rank3]:2025-11-11 19:16:31,356 - INFO - Avg. fwd time: 12.6945 / Avg. bwd time: 28.0854 / Avg. batch time: 385.8916 (ms) / GPU bubble ratio: 15.46%
[rank2]:2025-11-11 19:16:31,394 - INFO - Avg. fwd time: 8.2248 / Avg. bwd time: 11.8466 / Avg. batch time: 410.3296 (ms) / GPU bubble ratio: 60.87%
[rank1]:2025-11-11 19:16:31,440 - INFO - Avg. fwd time: 10.5728 / Avg. bwd time: 15.1884 / Avg. batch time: 440.0703 (ms) / GPU bubble ratio: 53.17%
[rank0]:2025-11-11 19:16:31,533 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 9,949  tflops: 77.78  mfu: 24.93%
[rank3]:2025-11-11 19:16:31,533 - INFO -  step: 350  loss:  5.3502  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 9,950  tflops: 77.78  mfu: 24.93%
[rank2]:2025-11-11 19:16:31,531 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 9,949  tflops: 77.78  mfu: 24.93%
[rank1]:2025-11-11 19:16:31,534 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 9,949  tflops: 77.78  mfu: 24.93%
[rank1]:2025-11-11 19:17:53,423 - INFO - Avg. fwd time: 10.6170 / Avg. bwd time: 14.8917 / Avg. batch time: 436.2151 (ms) / GPU bubble ratio: 53.22%
[rank3]:2025-11-11 19:17:53,378 - INFO - Avg. fwd time: 12.7558 / Avg. bwd time: 27.6134 / Avg. batch time: 382.6026 (ms) / GPU bubble ratio: 15.59%
[rank0]:2025-11-11 19:17:53,432 - INFO - Avg. fwd time: 8.9988 / Avg. bwd time: 8.7214 / Avg. batch time: 458.0946 (ms) / GPU bubble ratio: 69.05%
[rank2]:2025-11-11 19:17:53,400 - INFO - Avg. fwd time: 8.2600 / Avg. bwd time: 11.6114 / Avg. batch time: 406.7761 (ms) / GPU bubble ratio: 60.92%
[rank0]:2025-11-11 19:19:11,932 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 19:19:14,871 - INFO - Avg. fwd time: 9.0124 / Avg. bwd time: 8.2279 / Avg. batch time: 454.6331 (ms) / GPU bubble ratio: 69.66%
[rank1]:2025-11-11 19:19:15,138 - INFO - Avg. fwd time: 10.6494 / Avg. bwd time: 14.6676 / Avg. batch time: 433.2674 (ms) / GPU bubble ratio: 53.25%
[rank3]:2025-11-11 19:19:15,053 - INFO - Avg. fwd time: 12.8003 / Avg. bwd time: 27.2549 / Avg. batch time: 380.0863 (ms) / GPU bubble ratio: 15.69%
[rank2]:2025-11-11 19:19:15,098 - INFO - Avg. fwd time: 8.2860 / Avg. bwd time: 11.4339 / Avg. batch time: 404.0583 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-11-11 19:19:15,230 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,009  tflops: 78.24  mfu: 25.08%
[rank3]:2025-11-11 19:19:15,232 - INFO -  step: 400  loss:  3.8593  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,009  tflops: 78.24  mfu: 25.08%
[rank0]:2025-11-11 19:19:15,230 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,009  tflops: 78.24  mfu: 25.08%
[rank2]:2025-11-11 19:19:15,228 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,009  tflops: 78.24  mfu: 25.08%
[rank1]:2025-11-11 19:19:15,305 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1919_stage1_step400.svg
[rank0]:2025-11-11 19:19:15,297 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1919_stage0_step400.svg
[rank2]:2025-11-11 19:19:15,297 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1919_stage2_step400.svg
[rank3]:2025-11-11 19:19:15,445 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1919_real_step400_rank3.svg
[rank3]:> Batch Time: 395.25 ms, GPU Bubble Ratio: 81.36%, 55.38%, 65.26%, 29.80%
[rank3]:2025-11-11 19:19:15,509 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1919_stage3_step400.svg
[rank3]:2025-11-11 19:19:34,025 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 19:19:34,199 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-11 19:19:34,185 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-11 19:19:34,201 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 19:20:36,531 - INFO - Avg. fwd time: 9.0260 / Avg. bwd time: 7.7183 / Avg. batch time: 451.0919 (ms) / GPU bubble ratio: 70.30%
[rank3]:2025-11-11 19:20:36,715 - INFO - Avg. fwd time: 12.8456 / Avg. bwd time: 26.8840 / Avg. batch time: 377.4780 (ms) / GPU bubble ratio: 15.80%
[rank2]:2025-11-11 19:20:36,753 - INFO - Avg. fwd time: 8.3128 / Avg. bwd time: 11.2505 / Avg. batch time: 401.2926 (ms) / GPU bubble ratio: 61.00%
[rank1]:2025-11-11 19:20:36,798 - INFO - Avg. fwd time: 10.6825 / Avg. bwd time: 14.4356 / Avg. batch time: 430.2611 (ms) / GPU bubble ratio: 53.30%
[rank0]:2025-11-11 19:21:54,828 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 19:21:58,032 - INFO - Avg. fwd time: 12.8838 / Avg. bwd time: 26.5534 / Avg. batch time: 375.1339 (ms) / GPU bubble ratio: 15.90%
[rank3]:2025-11-11 19:21:58,083 - INFO -  step: 450  loss:  6.8644  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,061  tflops: 78.65  mfu: 25.21%
[rank2]:2025-11-11 19:21:58,051 - INFO - Avg. fwd time: 8.3357 / Avg. bwd time: 11.0874 / Avg. batch time: 398.7576 (ms) / GPU bubble ratio: 61.03%
[rank2]:2025-11-11 19:21:58,082 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,061  tflops: 78.65  mfu: 25.21%
[rank0]:2025-11-11 19:21:58,081 - INFO - Avg. fwd time: 9.0363 / Avg. bwd time: 7.2682 / Avg. batch time: 447.8657 (ms) / GPU bubble ratio: 70.88%
[rank0]:2025-11-11 19:21:58,083 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,061  tflops: 78.65  mfu: 25.21%
[rank1]:2025-11-11 19:21:58,071 - INFO - Avg. fwd time: 10.7105 / Avg. bwd time: 14.2294 / Avg. batch time: 427.5105 (ms) / GPU bubble ratio: 53.33%
[rank1]:2025-11-11 19:21:58,082 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,061  tflops: 78.65  mfu: 25.21%
[rank0]:2025-11-11 19:23:19,213 - INFO - Avg. fwd time: 9.0454 / Avg. bwd time: 6.9222 / Avg. batch time: 445.4396 (ms) / GPU bubble ratio: 71.32%
[rank2]:2025-11-11 19:23:19,431 - INFO - Avg. fwd time: 8.3539 / Avg. bwd time: 10.9630 / Avg. batch time: 396.8605 (ms) / GPU bubble ratio: 61.06%
[rank3]:2025-11-11 19:23:19,393 - INFO - Avg. fwd time: 12.9154 / Avg. bwd time: 26.3035 / Avg. batch time: 373.3835 (ms) / GPU bubble ratio: 15.97%
[rank1]:2025-11-11 19:23:19,475 - INFO - Avg. fwd time: 10.7331 / Avg. bwd time: 14.0720 / Avg. batch time: 425.4487 (ms) / GPU bubble ratio: 53.36%
[rank0]:2025-11-11 19:24:37,963 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 19:24:40,851 - INFO - Avg. fwd time: 9.0547 / Avg. bwd time: 6.5580 / Avg. batch time: 442.8999 (ms) / GPU bubble ratio: 71.80%
[rank3]:2025-11-11 19:24:41,034 - INFO - Avg. fwd time: 12.9491 / Avg. bwd time: 26.0418 / Avg. batch time: 371.5555 (ms) / GPU bubble ratio: 16.05%
[rank2]:2025-11-11 19:24:41,075 - INFO - Avg. fwd time: 8.3729 / Avg. bwd time: 10.8319 / Avg. batch time: 394.8779 (ms) / GPU bubble ratio: 61.09%
[rank1]:2025-11-11 19:24:41,117 - INFO - Avg. fwd time: 10.7566 / Avg. bwd time: 13.9063 / Avg. batch time: 423.2926 (ms) / GPU bubble ratio: 53.39%
[rank3]:2025-11-11 19:24:41,201 - INFO -  step: 500  loss:  6.7776  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,044  tflops: 78.52  mfu: 25.17%
[rank2]:2025-11-11 19:24:41,200 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,044  tflops: 78.52  mfu: 25.17%
[rank2]:2025-11-11 19:24:41,251 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1924_stage2_step500.svg
[rank1]:2025-11-11 19:24:41,202 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,044  tflops: 78.52  mfu: 25.17%
[rank1]:2025-11-11 19:24:41,251 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1924_stage1_step500.svg
[rank0]:2025-11-11 19:24:41,202 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,044  tflops: 78.52  mfu: 25.17%
[rank0]:2025-11-11 19:24:41,252 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1924_stage0_step500.svg
[rank3]:2025-11-11 19:24:41,349 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1924_real_step500_rank3.svg
[rank3]:> Batch Time: 398.75 ms, GPU Bubble Ratio: 81.45%, 55.45%, 65.36%, 29.65%
[rank3]:2025-11-11 19:24:41,391 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1924_stage3_step500.svg
[rank1]:2025-11-11 19:26:03,062 - INFO - Avg. fwd time: 10.7782 / Avg. bwd time: 13.7578 / Avg. batch time: 421.4044 (ms) / GPU bubble ratio: 53.42%
[rank2]:2025-11-11 19:26:03,040 - INFO - Avg. fwd time: 8.3904 / Avg. bwd time: 10.7142 / Avg. batch time: 393.1426 (ms) / GPU bubble ratio: 61.12%
[rank3]:2025-11-11 19:26:03,020 - INFO - Avg. fwd time: 12.9805 / Avg. bwd time: 25.8079 / Avg. batch time: 369.9306 (ms) / GPU bubble ratio: 16.12%
[rank0]:2025-11-11 19:26:03,072 - INFO - Avg. fwd time: 9.0632 / Avg. bwd time: 6.2302 / Avg. batch time: 440.6680 (ms) / GPU bubble ratio: 72.24%
[rank0]:2025-11-11 19:27:21,518 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 19:27:24,444 - INFO - Avg. fwd time: 9.0703 / Avg. bwd time: 5.9743 / Avg. batch time: 438.9154 (ms) / GPU bubble ratio: 72.58%
[rank2]:2025-11-11 19:27:24,666 - INFO - Avg. fwd time: 8.4043 / Avg. bwd time: 10.6228 / Avg. batch time: 391.7798 (ms) / GPU bubble ratio: 61.15%
[rank3]:2025-11-11 19:27:24,629 - INFO - Avg. fwd time: 13.0055 / Avg. bwd time: 25.6264 / Avg. batch time: 368.6764 (ms) / GPU bubble ratio: 16.17%
[rank1]:2025-11-11 19:27:24,713 - INFO - Avg. fwd time: 10.7957 / Avg. bwd time: 13.6422 / Avg. batch time: 419.9210 (ms) / GPU bubble ratio: 53.44%
[rank1]:2025-11-11 19:27:24,800 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,015  tflops: 78.29  mfu: 25.09%
[rank2]:2025-11-11 19:27:24,798 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,015  tflops: 78.29  mfu: 25.09%
[rank3]:2025-11-11 19:27:24,799 - INFO -  step: 550  loss:  5.3207  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,015  tflops: 78.29  mfu: 25.09%
[rank0]:2025-11-11 19:27:24,800 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,015  tflops: 78.29  mfu: 25.09%
[rank0]:2025-11-11 19:28:46,169 - INFO - Avg. fwd time: 9.0777 / Avg. bwd time: 5.7010 / Avg. batch time: 437.0284 (ms) / GPU bubble ratio: 72.95%
[rank3]:2025-11-11 19:28:46,354 - INFO - Avg. fwd time: 13.0315 / Avg. bwd time: 25.4314 / Avg. batch time: 367.3210 (ms) / GPU bubble ratio: 16.23%
[rank2]:2025-11-11 19:28:46,393 - INFO - Avg. fwd time: 8.4190 / Avg. bwd time: 10.5250 / Avg. batch time: 390.3085 (ms) / GPU bubble ratio: 61.17%
[rank1]:2025-11-11 19:28:46,439 - INFO - Avg. fwd time: 10.8138 / Avg. bwd time: 13.5185 / Avg. batch time: 418.3212 (ms) / GPU bubble ratio: 53.47%
[rank0]:2025-11-11 19:30:04,817 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 19:30:08,107 - INFO - Avg. fwd time: 13.0549 / Avg. bwd time: 25.2528 / Avg. batch time: 366.0762 (ms) / GPU bubble ratio: 16.28%
[rank3]:2025-11-11 19:30:08,164 - INFO -  step: 600  loss:  3.8027  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,029  tflops: 78.40  mfu: 25.13%
[rank2]:2025-11-11 19:30:08,128 - INFO - Avg. fwd time: 8.4325 / Avg. bwd time: 10.4358 / Avg. batch time: 388.9596 (ms) / GPU bubble ratio: 61.19%
[rank2]:2025-11-11 19:30:08,162 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,029  tflops: 78.40  mfu: 25.13%
[rank0]:2025-11-11 19:30:08,161 - INFO - Avg. fwd time: 9.0845 / Avg. bwd time: 5.4517 / Avg. batch time: 435.3028 (ms) / GPU bubble ratio: 73.29%
[rank0]:2025-11-11 19:30:08,164 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,029  tflops: 78.40  mfu: 25.13%
[rank1]:2025-11-11 19:30:08,150 - INFO - Avg. fwd time: 10.8305 / Avg. bwd time: 13.4055 / Avg. batch time: 416.8560 (ms) / GPU bubble ratio: 53.49%
[rank1]:2025-11-11 19:30:08,162 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,029  tflops: 78.40  mfu: 25.13%
[rank2]:2025-11-11 19:30:08,224 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1930_stage2_step600.svg
[rank0]:2025-11-11 19:30:08,216 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1930_stage0_step600.svg
[rank1]:2025-11-11 19:30:08,214 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1930_stage1_step600.svg
[rank3]:2025-11-11 19:30:08,315 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1930_real_step600_rank3.svg
[rank3]:> Batch Time: 396.00 ms, GPU Bubble Ratio: 81.37%, 55.34%, 65.25%, 29.71%
[rank3]:2025-11-11 19:30:08,360 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1930_stage3_step600.svg
[rank0]:2025-11-11 19:31:29,456 - INFO - Avg. fwd time: 9.0893 / Avg. bwd time: 5.2547 / Avg. batch time: 433.9153 (ms) / GPU bubble ratio: 73.55%
[rank2]:2025-11-11 19:31:29,677 - INFO - Avg. fwd time: 8.4426 / Avg. bwd time: 10.3645 / Avg. batch time: 387.8749 (ms) / GPU bubble ratio: 61.21%
[rank3]:2025-11-11 19:31:29,640 - INFO - Avg. fwd time: 13.0718 / Avg. bwd time: 25.1084 / Avg. batch time: 365.0534 (ms) / GPU bubble ratio: 16.33%
[rank1]:2025-11-11 19:31:29,723 - INFO - Avg. fwd time: 10.8426 / Avg. bwd time: 13.3151 / Avg. batch time: 415.6764 (ms) / GPU bubble ratio: 53.51%
[rank0]:2025-11-11 19:32:48,024 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 19:32:50,910 - INFO - Avg. fwd time: 9.0949 / Avg. bwd time: 5.0422 / Avg. batch time: 432.4161 (ms) / GPU bubble ratio: 73.85%
[rank3]:2025-11-11 19:32:51,092 - INFO - Avg. fwd time: 13.0912 / Avg. bwd time: 24.9542 / Avg. batch time: 363.9718 (ms) / GPU bubble ratio: 16.38%
[rank2]:2025-11-11 19:32:51,129 - INFO - Avg. fwd time: 8.4539 / Avg. bwd time: 10.2879 / Avg. batch time: 386.7015 (ms) / GPU bubble ratio: 61.23%
[rank1]:2025-11-11 19:32:51,174 - INFO - Avg. fwd time: 10.8563 / Avg. bwd time: 13.2181 / Avg. batch time: 414.4013 (ms) / GPU bubble ratio: 53.52%
[rank2]:2025-11-11 19:32:51,253 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,046  tflops: 78.53  mfu: 25.17%
[rank1]:2025-11-11 19:32:51,255 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,046  tflops: 78.53  mfu: 25.17%
[rank0]:2025-11-11 19:32:51,255 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,046  tflops: 78.53  mfu: 25.17%
[rank3]:2025-11-11 19:32:51,255 - INFO -  step: 650  loss:  6.5839  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,046  tflops: 78.54  mfu: 25.17%
[rank3]:2025-11-11 19:34:12,615 - INFO - Avg. fwd time: 13.1081 / Avg. bwd time: 24.8100 / Avg. batch time: 362.9507 (ms) / GPU bubble ratio: 16.42%
[rank1]:2025-11-11 19:34:12,659 - INFO - Avg. fwd time: 10.8681 / Avg. bwd time: 13.1280 / Avg. batch time: 413.2027 (ms) / GPU bubble ratio: 53.54%
[rank0]:2025-11-11 19:34:12,671 - INFO - Avg. fwd time: 9.0995 / Avg. bwd time: 4.8462 / Avg. batch time: 431.0116 (ms) / GPU bubble ratio: 74.12%
[rank2]:2025-11-11 19:34:12,637 - INFO - Avg. fwd time: 8.4639 / Avg. bwd time: 10.2170 / Avg. batch time: 385.5964 (ms) / GPU bubble ratio: 61.24%
[rank0]:2025-11-11 19:35:30,888 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 19:35:33,769 - INFO - Avg. fwd time: 9.1037 / Avg. bwd time: 4.6899 / Avg. batch time: 429.9158 (ms) / GPU bubble ratio: 74.33%
[rank3]:2025-11-11 19:35:33,952 - INFO - Avg. fwd time: 13.1226 / Avg. bwd time: 24.6972 / Avg. batch time: 362.1622 (ms) / GPU bubble ratio: 16.46%
[rank2]:2025-11-11 19:35:33,990 - INFO - Avg. fwd time: 8.4723 / Avg. bwd time: 10.1608 / Avg. batch time: 384.7403 (ms) / GPU bubble ratio: 61.26%
[rank3]:2025-11-11 19:35:34,115 - INFO -  step: 700  loss:  6.8446  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,060  tflops: 78.65  mfu: 25.21%
[rank0]:2025-11-11 19:35:34,115 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,060  tflops: 78.65  mfu: 25.21%
[rank2]:2025-11-11 19:35:34,114 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,060  tflops: 78.65  mfu: 25.21%
[rank1]:2025-11-11 19:35:34,036 - INFO - Avg. fwd time: 10.8782 / Avg. bwd time: 13.0568 / Avg. batch time: 412.2718 (ms) / GPU bubble ratio: 53.55%
[rank1]:2025-11-11 19:35:34,115 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,060  tflops: 78.65  mfu: 25.21%
[rank0]:2025-11-11 19:35:34,170 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1935_stage0_step700.svg
[rank2]:2025-11-11 19:35:34,168 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1935_stage2_step700.svg
[rank1]:2025-11-11 19:35:34,169 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1935_stage1_step700.svg
[rank3]:2025-11-11 19:35:34,266 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1935_real_step700_rank3.svg
[rank3]:> Batch Time: 397.75 ms, GPU Bubble Ratio: 81.41%, 55.43%, 65.33%, 29.68%
[rank3]:2025-11-11 19:35:34,312 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1935_stage3_step700.svg
[rank0]:2025-11-11 19:36:55,546 - INFO - Avg. fwd time: 9.1080 / Avg. bwd time: 4.5199 / Avg. batch time: 428.7419 (ms) / GPU bubble ratio: 74.57%
[rank1]:2025-11-11 19:36:55,816 - INFO - Avg. fwd time: 10.8889 / Avg. bwd time: 12.9793 / Avg. batch time: 411.2769 (ms) / GPU bubble ratio: 53.57%
[rank3]:2025-11-11 19:36:55,733 - INFO - Avg. fwd time: 13.1381 / Avg. bwd time: 24.5747 / Avg. batch time: 361.3033 (ms) / GPU bubble ratio: 16.50%
[rank2]:2025-11-11 19:36:55,770 - INFO - Avg. fwd time: 8.4812 / Avg. bwd time: 10.0996 / Avg. batch time: 383.8267 (ms) / GPU bubble ratio: 61.27%
[rank0]:2025-11-11 19:38:14,376 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-11 19:38:17,690 - INFO - Avg. fwd time: 9.1125 / Avg. bwd time: 4.3618 / Avg. batch time: 427.6683 (ms) / GPU bubble ratio: 74.79%
[rank0]:2025-11-11 19:38:17,693 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,016  tflops: 78.30  mfu: 25.10%
[rank3]:2025-11-11 19:38:17,633 - INFO - Avg. fwd time: 13.1537 / Avg. bwd time: 24.4632 / Avg. batch time: 360.5349 (ms) / GPU bubble ratio: 16.53%
[rank3]:2025-11-11 19:38:17,693 - INFO -  step: 750  loss:  5.3250  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,016  tflops: 78.30  mfu: 25.10%
[rank1]:2025-11-11 19:38:17,678 - INFO - Avg. fwd time: 10.8996 / Avg. bwd time: 12.9079 / Avg. batch time: 410.3682 (ms) / GPU bubble ratio: 53.59%
[rank1]:2025-11-11 19:38:17,691 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,016  tflops: 78.30  mfu: 25.10%
[rank2]:2025-11-11 19:38:17,654 - INFO - Avg. fwd time: 8.4898 / Avg. bwd time: 10.0432 / Avg. batch time: 382.9910 (ms) / GPU bubble ratio: 61.29%
[rank2]:2025-11-11 19:38:17,691 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,016  tflops: 78.30  mfu: 25.10%
[rank0]:2025-11-11 19:39:39,120 - INFO - Avg. fwd time: 9.1161 / Avg. bwd time: 4.2348 / Avg. batch time: 426.8075 (ms) / GPU bubble ratio: 74.98%
[rank3]:2025-11-11 19:39:39,309 - INFO - Avg. fwd time: 13.1666 / Avg. bwd time: 24.3740 / Avg. batch time: 359.9222 (ms) / GPU bubble ratio: 16.56%
[rank1]:2025-11-11 19:39:39,393 - INFO - Avg. fwd time: 10.9082 / Avg. bwd time: 12.8507 / Avg. batch time: 409.6412 (ms) / GPU bubble ratio: 53.60%
[rank2]:2025-11-11 19:39:39,346 - INFO - Avg. fwd time: 8.4967 / Avg. bwd time: 9.9978 / Avg. batch time: 382.3234 (ms) / GPU bubble ratio: 61.30%
[rank0]:2025-11-11 19:40:57,933 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-11 19:41:00,895 - INFO - Avg. fwd time: 9.1200 / Avg. bwd time: 4.0957 / Avg. batch time: 425.8598 (ms) / GPU bubble ratio: 75.17%
[rank3]:2025-11-11 19:41:01,086 - INFO - Avg. fwd time: 13.1803 / Avg. bwd time: 24.2759 / Avg. batch time: 359.2459 (ms) / GPU bubble ratio: 16.59%
[rank2]:2025-11-11 19:41:01,123 - INFO - Avg. fwd time: 8.5043 / Avg. bwd time: 9.9482 / Avg. batch time: 381.5871 (ms) / GPU bubble ratio: 61.31%
[rank2]:2025-11-11 19:41:01,251 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 13.37GiB(28.14%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank2]:2025-11-11 19:41:01,251 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,910  tflops: 77.47  mfu: 22.81%
[rank1]:2025-11-11 19:41:01,171 - INFO - Avg. fwd time: 10.9178 / Avg. bwd time: 12.7881 / Avg. batch time: 408.8403 (ms) / GPU bubble ratio: 53.61%
[rank3]:2025-11-11 19:41:01,252 - INFO -  step: 800  loss:  3.7768  grad_norm:  0.0000  memory: 33.45GiB(70.40%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank3]:2025-11-11 19:41:01,253 - INFO -  final step: 800  loss:  3.7768  grad_norm:  0.0000  tps: 9,916  tflops: 77.52  mfu: 22.90%
[rank3]:2025-11-11 19:41:01,253 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-11 19:41:01,263 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-11 19:41:01,253 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 16.71GiB(35.18%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank1]:2025-11-11 19:41:01,253 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,909  tflops: 77.46  mfu: 22.80%
[rank1]:2025-11-11 19:41:01,253 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-11 19:41:01,264 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-11 19:41:01,251 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-11 19:41:01,263 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 19:41:01,253 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 19.13GiB(40.27%)  tps: 10,017  tflops: 78.31  mfu: 25.10%
[rank0]:2025-11-11 19:41:01,253 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0000  tps: 9,910  tflops: 77.47  mfu: 22.80%
[rank0]:2025-11-11 19:41:01,253 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-11 19:41:01,264 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 19:41:03,300 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-11 19:41:03,368 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank2/251111_1941_stage2_final800.svg
[rank1]:2025-11-11 19:41:03,368 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank1/251111_1941_stage1_final800.svg
[rank0]:2025-11-11 19:41:03,369 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank0/251111_1941_stage0_final800.svg
[rank3]:2025-11-11 19:41:03,461 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1941_real_final800_rank3.svg
[rank3]:> Batch Time: 399.00 ms, GPU Bubble Ratio: 81.52%, 55.64%, 65.47%, 29.94%
[rank2]:2025-11-11 19:41:03,527 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/frozen_params_histogram/251111_1941_rank2_stage2.svg
[rank2]:	> Counts Sum: 1464160, Total Sum: 1681920 (87.05%), Ratio(%) per element: [86.98, 86.81, 87.15, 86.98, 86.98, 86.98, 86.98, 87.5, 86.81, 86.98, 86.81, 86.98, 86.98, 87.15, 86.98, 87.15, 87.5, 86.81, 86.81, 86.98, 86.81, 86.98, 86.98, 86.81, 86.81, 87.5, 87.5, 87.15, 86.98, 87.15, 86.98, 87.15, 86.98, 87.15, 87.32, 87.15]
[rank2]:2025-11-11 19:41:03,527 - INFO - Destroying the purge thread.
[rank0]:2025-11-11 19:41:03,532 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/frozen_params_histogram/251111_1941_rank0_stage0.svg
[rank1]:2025-11-11 19:41:03,520 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/frozen_params_histogram/251111_1941_rank1_stage1.svg
[rank0]:	> Counts Sum: 1196640, Total Sum: 1728640 (69.22%), Ratio(%) per element: [68.32, 67.97, 70.71, 71.91, 70.71, 70.71, 67.63, 68.66, 69.0, 69.34, 66.78, 67.97, 68.66, 69.0, 66.95, 68.15, 69.52, 70.03, 68.32, 70.71, 67.97, 69.52, 70.71, 70.03, 69.52, 68.15, 68.83, 70.03, 70.54, 69.17, 69.69, 70.54, 68.15, 69.52, 66.09, 70.2, 71.4]
[rank0]:2025-11-11 19:41:03,533 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:	> Counts Sum: 1322320, Total Sum: 2102400 (62.90%), Ratio(%) per element: [61.47, 63.69, 63.01, 62.67, 62.67, 62.67, 62.32, 64.89, 64.89, 63.35, 63.52, 64.04, 64.55, 60.61, 61.64, 64.04, 62.84, 65.58, 62.15, 64.04, 63.35, 62.67, 60.1, 65.23, 62.32, 65.75, 61.98, 60.1, 63.69, 60.95, 62.32, 60.44, 63.18, 62.15, 63.01, 61.98, 63.35, 62.15, 61.13, 61.98, 65.23, 63.35, 63.18, 63.86, 61.98]
[rank1]:2025-11-11 19:41:03,521 - INFO - Destroying the purge thread.
[rank3]:2025-11-11 19:41:03,612 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/pipeline_schedule/251111_1941_thry_final800_rank3.svg
[rank3]:> Batch Time: 350.96 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-11 19:41:03,658 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/freeze_ratio_history/rank3/251111_1941_stage3_final800.svg
[rank3]:2025-11-11 19:41:03,794 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1/frozen_params_histogram/251111_1941_rank3_stage3.svg
[rank3]:	> Counts Sum: 331440, Total Sum: 1354880 (24.46%), Ratio(%) per element: [22.6, 22.43, 25.34, 22.77, 25.17, 24.31, 23.97, 26.36, 27.22, 24.65, 24.14, 24.31, 22.26, 22.08, 24.65, 23.8, 27.73, 26.54, 24.48, 22.6, 23.63, 22.43, 22.6, 25.0, 24.14, 25.34, 28.08, 27.05, 23.63]
[rank3]:2025-11-11 19:41:03,795 - INFO - Destroying the purge thread.
[rank2]:2025-11-11 19:41:03,852 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank1]:2025-11-11 19:41:03,933 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 275-287
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–†â–ƒâ–â–„â–„â–ƒâ–â–„â–„â–ƒâ–â–„â–„â–ƒâ–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–†â–ƒâ–â–„â–„â–ƒâ–â–„â–„â–ƒâ–â–„â–„â–ƒâ–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.30443
[rank3]:wandb:               final/avg_loss 3.77679
[rank3]:wandb:             final/avg_mfu(%) 22.90162
[rank3]:wandb:             final/avg_tflops 77.52177
[rank3]:wandb:    final/avg_throughput(tps) 9916.39041
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 3.77679
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 3.77679
[rank3]:wandb: loss_metrics/global_max_loss 3.77679
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_GPipe_timelyapf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ssu68twz
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_GPipe_timelyapf_42_dm1/20251111-1854/wandb/run-20251111_185411-ssu68twz/logs
[rank3]:2025-11-11 19:41:05,399 - INFO - Process group destroyed
[rank0]:2025-11-11 19:41:05,533 - INFO - Training completed
[rank0]:2025-11-11 19:41:05,533 - INFO - Destroying the purge thread.
[rank0]:2025-11-11 19:41:05,912 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.4', 'layers.7', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.2', 'tok_embeddings', 'layers.3', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'norm', 'output', 'layers.13', 'layers.15', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_GPipe_timelyapf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_GPipe_timelyapf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_GPipe_timelyapf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_GPipe_timelyapf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_GPipe_timelyapf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_GPipe_timelyapf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_GPipe_timelyapf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_GPipe_timelyapf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
