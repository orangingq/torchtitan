
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 11:54:22 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_GPipe_nofreeze_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-24 11:54:29,141 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-24 11:54:29,164 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank3]:2025-12-24 11:54:29,331 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 11:54:29,334 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-24 11:54:29,347 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:2025-12-24 11:54:29,361 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank0]:2025-12-24 11:54:29,363 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 11:54:29,366 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 11:54:29,368 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-24 11:54:29,424 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank1]:2025-12-24 11:54:29,520 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 11:54:29,522 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-24 11:54:29,616 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 11:54:29,619 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 11:54:29,758 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-24 11:54:32,505 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-24 11:54:32,654 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 11:54:32,696 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 11:54:32,697 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-24 11:54:32,722 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-24 11:54:32,722 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-24 11:54:32,868 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 11:54:32,885 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 11:54:32,926 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 11:54:32,954 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-24 11:54:32,954 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-24 11:54:32,932 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 11:54:32,957 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-24 11:54:32,957 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-24 11:54:32,929 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 11:54:32,929 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 11:54:32,930 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-24 11:54:33,166 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 11:54:33,166 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 11:54:33,167 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-24 11:54:33,169 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 11:54:33,170 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 11:54:33,170 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 1mj2ihfb
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_GPipe_nofreeze_42_dm1/20251224-1154/wandb/run-20251224_115433-1mj2ihfb
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_GPipe_nofreeze_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/1mj2ihfb
[rank3]:2025-12-24 11:54:35,230 - WandB logging enabled
[rank3]:2025-12-24 11:54:35,231 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 11:54:35,269 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 11:54:35,298 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-24 11:54:35,298 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-24 11:54:35,482 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 11:54:35,482 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 11:54:35,483 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 11:54:35,498 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 11:54:35,498 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_GPipe_nofreeze_42_dm1
[rank0]:2025-12-24 11:54:35,498 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 11:54:35,499 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 11:54:35,499 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-24 11:54:35,501 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-24 11:54:35,499 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 11:54:37,941 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 11:54:37,941 - Finished loading the checkpoint in 2.44 seconds.
[rank0]:2025-12-24 11:54:37,941 - Training starts at step 1
[rank1]:2025-12-24 11:54:43,450 -  step:  1  loss: -8.0000  grad_norm: 116.5362  memory: 12.75GiB(26.83%)  tps: 3,114  tflops: 24.34  mfu: 7.80%
[rank1]:2025-12-24 11:54:43,450 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-24 11:54:43,445 -  step:  1  loss: -8.0000  grad_norm: 116.5362  memory: 10.24GiB(21.56%)  tps: 3,117  tflops: 24.37  mfu: 7.81%
[rank2]:2025-12-24 11:54:43,446 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-24 11:54:43,454 -  step:  1  loss: 10.6088  grad_norm: 116.5362  memory: 24.19GiB(50.91%)  tps: 4,004  tflops: 31.30  mfu: 10.03%
[rank3]:2025-12-24 11:54:43,454 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 11:54:43,484 -  step:  1  loss: -8.0000  grad_norm: 116.5362  memory: 13.25GiB(27.89%)  tps: 3,037  tflops: 23.75  mfu: 7.61%
[rank0]:2025-12-24 11:54:43,485 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-24 11:56:42,815 - Avg. fwd time: 7.1827 / Avg. bwd time: 19.6993 / Avg. batch time: 526.6676 (ms) / GPU bubble ratio: 59.17%
[rank3]:2025-12-24 11:56:42,790 - Avg. fwd time: 10.8137 / Avg. bwd time: 43.4869 / Avg. batch time: 494.0304 (ms) / GPU bubble ratio: 12.07%
[rank1]:2025-12-24 11:56:42,845 - Avg. fwd time: 9.2390 / Avg. bwd time: 25.3169 / Avg. batch time: 567.3966 (ms) / GPU bubble ratio: 51.28%
[rank0]:2025-12-24 11:56:42,875 - Avg. fwd time: 8.1773 / Avg. bwd time: 24.9374 / Avg. batch time: 606.1671 (ms) / GPU bubble ratio: 56.30%
[rank0]:2025-12-24 11:58:43,284 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 11:58:48,214 - Avg. fwd time: 7.1801 / Avg. bwd time: 19.7263 / Avg. batch time: 529.1647 (ms) / GPU bubble ratio: 59.32%
[rank3]:2025-12-24 11:58:48,188 - Avg. fwd time: 10.8370 / Avg. bwd time: 43.8257 / Avg. batch time: 496.8646 (ms) / GPU bubble ratio: 11.99%
[rank2]:2025-12-24 11:58:48,296 -  step: 50  loss: -8.0000  grad_norm: 12.7329  memory: 12.26GiB(25.80%)  tps: 6,558  tflops: 51.26  mfu: 16.43%
[rank1]:2025-12-24 11:58:48,244 - Avg. fwd time: 9.2429 / Avg. bwd time: 25.3611 / Avg. batch time: 569.4983 (ms) / GPU bubble ratio: 51.39%
[rank1]:2025-12-24 11:58:48,299 -  step: 50  loss: -8.0000  grad_norm: 12.7329  memory: 15.15GiB(31.89%)  tps: 6,558  tflops: 51.26  mfu: 16.43%
[rank3]:2025-12-24 11:58:48,308 -  step: 50  loss:  9.9072  grad_norm: 12.7329  memory: 26.98GiB(56.79%)  tps: 6,558  tflops: 51.26  mfu: 16.43%
[rank0]:2025-12-24 11:58:48,274 - Avg. fwd time: 8.1905 / Avg. bwd time: 24.9789 / Avg. batch time: 607.9219 (ms) / GPU bubble ratio: 56.35%
[rank0]:2025-12-24 11:58:48,310 -  step: 50  loss: -8.0000  grad_norm: 12.7329  memory: 17.08GiB(35.95%)  tps: 6,558  tflops: 51.27  mfu: 16.43%
[rank1]:2025-12-24 12:00:53,848 - Avg. fwd time: 9.2412 / Avg. bwd time: 25.3883 / Avg. batch time: 570.4726 (ms) / GPU bubble ratio: 51.44%
[rank3]:2025-12-24 12:00:53,792 - Avg. fwd time: 10.8455 / Avg. bwd time: 43.9667 / Avg. batch time: 498.0431 (ms) / GPU bubble ratio: 11.96%
[rank2]:2025-12-24 12:00:53,817 - Avg. fwd time: 7.1752 / Avg. bwd time: 19.7501 / Avg. batch time: 530.2465 (ms) / GPU bubble ratio: 59.38%
[rank0]:2025-12-24 12:00:53,878 - Avg. fwd time: 8.1888 / Avg. bwd time: 25.0008 / Avg. batch time: 608.7931 (ms) / GPU bubble ratio: 56.39%
[rank0]:2025-12-24 12:02:54,188 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-24 12:02:59,130 - Avg. fwd time: 9.2380 / Avg. bwd time: 25.3994 / Avg. batch time: 570.5284 (ms) / GPU bubble ratio: 51.43%
[rank2]:2025-12-24 12:02:59,100 - Avg. fwd time: 7.1694 / Avg. bwd time: 19.7590 / Avg. batch time: 530.3796 (ms) / GPU bubble ratio: 59.38%
[rank3]:2025-12-24 12:02:59,074 - Avg. fwd time: 10.8329 / Avg. bwd time: 44.0042 / Avg. batch time: 498.2308 (ms) / GPU bubble ratio: 11.95%
[rank1]:2025-12-24 12:02:59,186 -  step: 100  loss: -8.0000  grad_norm:  8.3777  memory: 15.15GiB(31.89%)  tps: 6,531  tflops: 51.05  mfu: 16.36%
[rank0]:2025-12-24 12:02:59,161 - Avg. fwd time: 8.1827 / Avg. bwd time: 25.0082 / Avg. batch time: 608.7863 (ms) / GPU bubble ratio: 56.38%
[rank0]:2025-12-24 12:02:59,197 -  step: 100  loss: -8.0000  grad_norm:  8.3777  memory: 17.08GiB(35.95%)  tps: 6,530  tflops: 51.05  mfu: 16.36%
[rank2]:2025-12-24 12:02:59,182 -  step: 100  loss: -8.0000  grad_norm:  8.3777  memory: 12.26GiB(25.80%)  tps: 6,530  tflops: 51.05  mfu: 16.36%
[rank3]:2025-12-24 12:02:59,195 -  step: 100  loss:  8.3012  grad_norm:  8.3777  memory: 26.98GiB(56.79%)  tps: 6,530  tflops: 51.05  mfu: 16.36%
[rank3]:2025-12-24 12:02:59,360 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1202_step100_rank3.svg
[rank3]:			> Batch Time: 608.11 ms, GPU Bubble Ratio: 56.22%, 54.41%, 64.47%, 27.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  315-25-340ms   | [S0,MB2,B]  360-25-385ms   | [S0,MB3,B]  405-25-430ms   | [S0,MB4,B]  450-25-475ms   | [S0,MB5,B]  494-25-519ms   | [S0,MB6,B]  539-25-564ms   | [S0,MB7,B]  583-25-608ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  286-25-312ms   | [S1,MB2,B]  331-25-356ms   | [S1,MB3,B]  377-25-402ms   | [S1,MB4,B]  421-25-447ms   | [S1,MB5,B]  465-25-491ms   | [S1,MB6,B]  511-25-536ms   | [S1,MB7,B]  554-25-580ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  263-19-283ms   | [S2,MB2,B]  308-19-328ms   | [S2,MB3,B]  354-19-374ms   | [S2,MB4,B]  398-19-418ms   | [S2,MB5,B]  442-19-462ms   | [S2,MB6,B]  488-19-508ms   | [S2,MB7,B]  531-19-551ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-43-257ms   | [S3,MB2,B]  256-44-301ms   | [S3,MB3,B]  302-45-347ms   | [S3,MB4,B]  347-44-391ms   | [S3,MB5,B]  391-44-435ms   | [S3,MB6,B]  435-45-481ms   | [S3,MB7,B]  481-45-527ms  
[rank2]:2025-12-24 12:05:04,584 - Avg. fwd time: 7.1647 / Avg. bwd time: 19.7651 / Avg. batch time: 530.5746 (ms) / GPU bubble ratio: 59.40%
[rank3]:2025-12-24 12:05:04,558 - Avg. fwd time: 10.8248 / Avg. bwd time: 44.0270 / Avg. batch time: 498.3383 (ms) / GPU bubble ratio: 11.94%
[rank1]:2025-12-24 12:05:04,616 - Avg. fwd time: 9.2354 / Avg. bwd time: 25.4086 / Avg. batch time: 570.6872 (ms) / GPU bubble ratio: 51.44%
[rank0]:2025-12-24 12:05:04,646 - Avg. fwd time: 8.1774 / Avg. bwd time: 25.0129 / Avg. batch time: 608.9110 (ms) / GPU bubble ratio: 56.39%
[rank0]:2025-12-24 12:07:05,103 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 12:07:10,066 - Avg. fwd time: 7.1611 / Avg. bwd time: 19.7711 / Avg. batch time: 530.7194 (ms) / GPU bubble ratio: 59.40%
[rank3]:2025-12-24 12:07:10,040 - Avg. fwd time: 10.8221 / Avg. bwd time: 44.0535 / Avg. batch time: 498.5239 (ms) / GPU bubble ratio: 11.94%
[rank0]:2025-12-24 12:07:10,129 - Avg. fwd time: 8.1757 / Avg. bwd time: 25.0179 / Avg. batch time: 609.0165 (ms) / GPU bubble ratio: 56.40%
[rank0]:2025-12-24 12:07:10,166 -  step: 150  loss: -8.0000  grad_norm: 44.2354  memory: 17.08GiB(35.95%)  tps: 6,528  tflops: 51.04  mfu: 16.36%
[rank2]:2025-12-24 12:07:10,151 -  step: 150  loss: -8.0000  grad_norm: 44.2354  memory: 12.26GiB(25.80%)  tps: 6,528  tflops: 51.04  mfu: 16.36%
[rank1]:2025-12-24 12:07:10,098 - Avg. fwd time: 9.2341 / Avg. bwd time: 25.4186 / Avg. batch time: 570.8159 (ms) / GPU bubble ratio: 51.43%
[rank1]:2025-12-24 12:07:10,154 -  step: 150  loss: -8.0000  grad_norm: 44.2354  memory: 15.15GiB(31.89%)  tps: 6,528  tflops: 51.04  mfu: 16.36%
[rank3]:2025-12-24 12:07:10,163 -  step: 150  loss:  4.3526  grad_norm: 44.2354  memory: 26.98GiB(56.79%)  tps: 6,528  tflops: 51.04  mfu: 16.36%
[rank1]:2025-12-24 12:09:15,801 - Avg. fwd time: 9.2321 / Avg. bwd time: 25.4357 / Avg. batch time: 571.0449 (ms) / GPU bubble ratio: 51.43%
[rank3]:2025-12-24 12:09:15,743 - Avg. fwd time: 10.8236 / Avg. bwd time: 44.0831 / Avg. batch time: 498.7703 (ms) / GPU bubble ratio: 11.93%
[rank2]:2025-12-24 12:09:15,770 - Avg. fwd time: 7.1589 / Avg. bwd time: 19.7821 / Avg. batch time: 530.9438 (ms) / GPU bubble ratio: 59.41%
[rank0]:2025-12-24 12:09:15,833 - Avg. fwd time: 8.1736 / Avg. bwd time: 25.0305 / Avg. batch time: 609.2374 (ms) / GPU bubble ratio: 56.40%
[rank0]:2025-12-24 12:11:16,251 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 12:11:21,270 - Avg. fwd time: 7.1564 / Avg. bwd time: 19.7994 / Avg. batch time: 531.0052 (ms) / GPU bubble ratio: 59.39%
[rank3]:2025-12-24 12:11:21,243 - Avg. fwd time: 10.8209 / Avg. bwd time: 44.0948 / Avg. batch time: 498.8395 (ms) / GPU bubble ratio: 11.93%
[rank1]:2025-12-24 12:11:21,302 - Avg. fwd time: 9.2301 / Avg. bwd time: 25.4559 / Avg. batch time: 571.1159 (ms) / GPU bubble ratio: 51.41%
[rank1]:2025-12-24 12:11:21,358 -  step: 200  loss: -8.0000  grad_norm:  7.6552  memory: 15.15GiB(31.89%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank0]:2025-12-24 12:11:21,333 - Avg. fwd time: 8.1729 / Avg. bwd time: 25.0414 / Avg. batch time: 609.3021 (ms) / GPU bubble ratio: 56.39%
[rank2]:2025-12-24 12:11:21,355 -  step: 200  loss: -8.0000  grad_norm:  7.6552  memory: 12.26GiB(25.80%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank0]:2025-12-24 12:11:21,370 -  step: 200  loss: -8.0000  grad_norm:  7.6552  memory: 17.08GiB(35.95%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank3]:2025-12-24 12:11:21,368 -  step: 200  loss:  1.0197  grad_norm:  7.6552  memory: 26.98GiB(56.79%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank3]:2025-12-24 12:11:21,517 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1211_step200_rank3.svg
[rank3]:			> Batch Time: 607.67 ms, GPU Bubble Ratio: 56.07%, 54.17%, 64.27%, 27.84%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  274-25-299ms   | [S0,MB1,B]  317-25-342ms   | [S0,MB2,B]  361-25-386ms   | [S0,MB3,B]  405-25-430ms   | [S0,MB4,B]  449-25-474ms   | [S0,MB5,B]  494-25-519ms   | [S0,MB6,B]  540-25-565ms   | [S0,MB7,B]  582-25-607ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  288-25-313ms   | [S1,MB2,B]  332-25-357ms   | [S1,MB3,B]  376-25-402ms   | [S1,MB4,B]  420-25-446ms   | [S1,MB5,B]  465-25-490ms   | [S1,MB6,B]  511-25-536ms   | [S1,MB7,B]  553-25-579ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-150ms    | [S2,MB0,B]  222-20-242ms   | [S2,MB1,B]  264-19-284ms   | [S2,MB2,B]  308-20-328ms   | [S2,MB3,B]  353-20-373ms   | [S2,MB4,B]  397-19-417ms   | [S2,MB5,B]  441-19-461ms   | [S2,MB6,B]  488-20-508ms   | [S2,MB7,B]  530-20-550ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  122-10-132ms   | [S3,MB6,F]  140-10-151ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  175-40-216ms   | [S3,MB1,B]  215-42-258ms   | [S3,MB2,B]  258-44-302ms   | [S3,MB3,B]  302-44-346ms   | [S3,MB4,B]  346-44-390ms   | [S3,MB5,B]  390-44-435ms   | [S3,MB6,B]  435-46-481ms   | [S3,MB7,B]  481-45-527ms  
[rank3]:2025-12-24 12:13:26,953 - Avg. fwd time: 10.8188 / Avg. bwd time: 44.1049 / Avg. batch time: 498.9036 (ms) / GPU bubble ratio: 11.93%
[rank2]:2025-12-24 12:13:26,981 - Avg. fwd time: 7.1543 / Avg. bwd time: 19.8154 / Avg. batch time: 531.1313 (ms) / GPU bubble ratio: 59.38%
[rank1]:2025-12-24 12:13:27,013 - Avg. fwd time: 9.2278 / Avg. bwd time: 25.4722 / Avg. batch time: 571.2476 (ms) / GPU bubble ratio: 51.40%
[rank0]:2025-12-24 12:13:27,045 - Avg. fwd time: 8.1698 / Avg. bwd time: 25.0497 / Avg. batch time: 609.4307 (ms) / GPU bubble ratio: 56.39%
[rank0]:2025-12-24 12:15:27,405 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 12:15:32,305 - Avg. fwd time: 10.8148 / Avg. bwd time: 44.1048 / Avg. batch time: 498.8688 (ms) / GPU bubble ratio: 11.93%
[rank2]:2025-12-24 12:15:32,332 - Avg. fwd time: 7.1522 / Avg. bwd time: 19.8281 / Avg. batch time: 531.0882 (ms) / GPU bubble ratio: 59.36%
[rank1]:2025-12-24 12:15:32,365 - Avg. fwd time: 9.2244 / Avg. bwd time: 25.4840 / Avg. batch time: 571.2066 (ms) / GPU bubble ratio: 51.39%
[rank0]:2025-12-24 12:15:32,397 - Avg. fwd time: 8.1642 / Avg. bwd time: 25.0552 / Avg. batch time: 609.3839 (ms) / GPU bubble ratio: 56.39%
[rank2]:2025-12-24 12:15:32,418 -  step: 250  loss: -8.0000  grad_norm:  1.7253  memory: 12.26GiB(25.80%)  tps: 6,526  tflops: 51.02  mfu: 16.35%
[rank1]:2025-12-24 12:15:32,422 -  step: 250  loss: -8.0000  grad_norm:  1.7253  memory: 15.15GiB(31.89%)  tps: 6,526  tflops: 51.02  mfu: 16.35%
[rank3]:2025-12-24 12:15:32,431 -  step: 250  loss:  0.3642  grad_norm:  1.7253  memory: 26.98GiB(56.79%)  tps: 6,526  tflops: 51.02  mfu: 16.35%
[rank0]:2025-12-24 12:15:32,433 -  step: 250  loss: -8.0000  grad_norm:  1.7253  memory: 17.08GiB(35.95%)  tps: 6,526  tflops: 51.02  mfu: 16.35%
[rank3]:2025-12-24 12:17:37,766 - Avg. fwd time: 10.8100 / Avg. bwd time: 44.1108 / Avg. batch time: 498.8776 (ms) / GPU bubble ratio: 11.93%
[rank2]:2025-12-24 12:17:37,794 - Avg. fwd time: 7.1495 / Avg. bwd time: 19.8373 / Avg. batch time: 531.0876 (ms) / GPU bubble ratio: 59.35%
[rank1]:2025-12-24 12:17:37,826 - Avg. fwd time: 9.2215 / Avg. bwd time: 25.4924 / Avg. batch time: 571.2075 (ms) / GPU bubble ratio: 51.38%
[rank0]:2025-12-24 12:17:37,859 - Avg. fwd time: 8.1613 / Avg. bwd time: 25.0593 / Avg. batch time: 609.3794 (ms) / GPU bubble ratio: 56.39%
[rank0]:2025-12-24 12:19:38,271 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 12:19:43,199 - Avg. fwd time: 7.1472 / Avg. bwd time: 19.8451 / Avg. batch time: 531.0621 (ms) / GPU bubble ratio: 59.34%
[rank3]:2025-12-24 12:19:43,170 - Avg. fwd time: 10.8060 / Avg. bwd time: 44.1126 / Avg. batch time: 498.8577 (ms) / GPU bubble ratio: 11.93%
[rank1]:2025-12-24 12:19:43,232 - Avg. fwd time: 9.2190 / Avg. bwd time: 25.4998 / Avg. batch time: 571.1863 (ms) / GPU bubble ratio: 51.37%
[rank2]:2025-12-24 12:19:43,286 -  step: 300  loss: -8.0000  grad_norm:  0.3287  memory: 12.26GiB(25.80%)  tps: 6,531  tflops: 51.06  mfu: 16.36%
[rank3]:2025-12-24 12:19:43,298 -  step: 300  loss:  0.2582  grad_norm:  0.3287  memory: 26.98GiB(56.79%)  tps: 6,531  tflops: 51.06  mfu: 16.36%
[rank1]:2025-12-24 12:19:43,289 -  step: 300  loss: -8.0000  grad_norm:  0.3287  memory: 15.15GiB(31.89%)  tps: 6,531  tflops: 51.06  mfu: 16.36%
[rank0]:2025-12-24 12:19:43,264 - Avg. fwd time: 8.1585 / Avg. bwd time: 25.0627 / Avg. batch time: 609.3546 (ms) / GPU bubble ratio: 56.39%
[rank0]:2025-12-24 12:19:43,300 -  step: 300  loss: -8.0000  grad_norm:  0.3287  memory: 17.08GiB(35.95%)  tps: 6,531  tflops: 51.06  mfu: 16.36%
[rank3]:2025-12-24 12:19:43,444 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1219_step300_rank3.svg
[rank3]:			> Batch Time: 609.64 ms, GPU Bubble Ratio: 56.29%, 54.39%, 64.41%, 27.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-64ms      | [S0,MB0,B]  273-25-298ms   | [S0,MB1,B]  317-25-342ms   | [S0,MB2,B]  361-25-386ms   | [S0,MB3,B]  406-25-431ms   | [S0,MB4,B]  451-25-476ms   | [S0,MB5,B]  496-25-521ms   | [S0,MB6,B]  541-25-566ms   | [S0,MB7,B]  584-25-609ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-270ms   | [S1,MB1,B]  288-25-313ms   | [S1,MB2,B]  332-25-358ms   | [S1,MB3,B]  377-25-403ms   | [S1,MB4,B]  422-25-448ms   | [S1,MB5,B]  467-25-493ms   | [S1,MB6,B]  512-25-538ms   | [S1,MB7,B]  555-25-580ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-20-241ms   | [S2,MB1,B]  265-19-285ms   | [S2,MB2,B]  309-20-329ms   | [S2,MB3,B]  354-20-374ms   | [S2,MB4,B]  399-19-419ms   | [S2,MB5,B]  444-19-464ms   | [S2,MB6,B]  489-20-509ms   | [S2,MB7,B]  531-20-551ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-43-257ms   | [S3,MB2,B]  257-44-302ms   | [S3,MB3,B]  302-44-347ms   | [S3,MB4,B]  347-44-392ms   | [S3,MB5,B]  392-44-436ms   | [S3,MB6,B]  437-45-483ms   | [S3,MB7,B]  482-45-528ms  
[rank2]:2025-12-24 12:21:48,657 - Avg. fwd time: 7.1454 / Avg. bwd time: 19.8506 / Avg. batch time: 531.0609 (ms) / GPU bubble ratio: 59.33%
[rank3]:2025-12-24 12:21:48,629 - Avg. fwd time: 10.8025 / Avg. bwd time: 44.1118 / Avg. batch time: 498.8223 (ms) / GPU bubble ratio: 11.93%
[rank1]:2025-12-24 12:21:48,691 - Avg. fwd time: 9.2170 / Avg. bwd time: 25.5045 / Avg. batch time: 571.1835 (ms) / GPU bubble ratio: 51.37%
[rank0]:2025-12-24 12:21:48,724 - Avg. fwd time: 8.1568 / Avg. bwd time: 25.0655 / Avg. batch time: 609.3482 (ms) / GPU bubble ratio: 56.38%
[rank0]:2025-12-24 12:23:49,059 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 12:23:53,978 - Avg. fwd time: 10.8010 / Avg. bwd time: 44.1088 / Avg. batch time: 498.7867 (ms) / GPU bubble ratio: 11.93%
[rank2]:2025-12-24 12:23:54,007 - Avg. fwd time: 7.1442 / Avg. bwd time: 19.8557 / Avg. batch time: 531.0161 (ms) / GPU bubble ratio: 59.32%
[rank1]:2025-12-24 12:23:54,040 - Avg. fwd time: 9.2159 / Avg. bwd time: 25.5098 / Avg. batch time: 571.1422 (ms) / GPU bubble ratio: 51.36%
[rank2]:2025-12-24 12:23:54,098 -  step: 350  loss: -8.0000  grad_norm:  0.1468  memory: 12.26GiB(25.80%)  tps: 6,532  tflops: 51.07  mfu: 16.37%
[rank0]:2025-12-24 12:23:54,076 - Avg. fwd time: 8.1547 / Avg. bwd time: 25.0675 / Avg. batch time: 609.3034 (ms) / GPU bubble ratio: 56.38%
[rank0]:2025-12-24 12:23:54,112 -  step: 350  loss: -8.0000  grad_norm:  0.1468  memory: 17.08GiB(35.95%)  tps: 6,532  tflops: 51.07  mfu: 16.37%
[rank3]:2025-12-24 12:23:54,111 -  step: 350  loss:  0.2152  grad_norm:  0.1468  memory: 26.98GiB(56.79%)  tps: 6,532  tflops: 51.07  mfu: 16.37%
[rank1]:2025-12-24 12:23:54,101 -  step: 350  loss: -8.0000  grad_norm:  0.1468  memory: 15.15GiB(31.89%)  tps: 6,533  tflops: 51.07  mfu: 16.37%
[rank2]:2025-12-24 12:25:59,290 - Avg. fwd time: 7.1431 / Avg. bwd time: 19.8595 / Avg. batch time: 530.9547 (ms) / GPU bubble ratio: 59.31%
[rank3]:2025-12-24 12:25:59,262 - Avg. fwd time: 10.7980 / Avg. bwd time: 44.1054 / Avg. batch time: 498.7338 (ms) / GPU bubble ratio: 11.93%
[rank1]:2025-12-24 12:25:59,324 - Avg. fwd time: 9.2146 / Avg. bwd time: 25.5122 / Avg. batch time: 571.0810 (ms) / GPU bubble ratio: 51.35%
[rank0]:2025-12-24 12:25:59,358 - Avg. fwd time: 8.1535 / Avg. bwd time: 25.0690 / Avg. batch time: 609.2389 (ms) / GPU bubble ratio: 56.38%
[rank0]:2025-12-24 12:27:59,612 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 12:28:04,569 - Avg. fwd time: 10.7960 / Avg. bwd time: 44.1047 / Avg. batch time: 498.7115 (ms) / GPU bubble ratio: 11.93%
[rank2]:2025-12-24 12:28:04,598 - Avg. fwd time: 7.1421 / Avg. bwd time: 19.8623 / Avg. batch time: 530.9237 (ms) / GPU bubble ratio: 59.31%
[rank0]:2025-12-24 12:28:04,666 - Avg. fwd time: 8.1516 / Avg. bwd time: 25.0703 / Avg. batch time: 609.2052 (ms) / GPU bubble ratio: 56.37%
[rank1]:2025-12-24 12:28:04,632 - Avg. fwd time: 9.2142 / Avg. bwd time: 25.5138 / Avg. batch time: 571.0501 (ms) / GPU bubble ratio: 51.35%
[rank1]:2025-12-24 12:28:04,691 -  step: 400  loss: -8.0000  grad_norm:  0.1266  memory: 15.15GiB(31.89%)  tps: 6,538  tflops: 51.11  mfu: 16.38%
[rank3]:2025-12-24 12:28:04,700 -  step: 400  loss:  0.2068  grad_norm:  0.1266  memory: 26.98GiB(56.79%)  tps: 6,538  tflops: 51.11  mfu: 16.38%
[rank2]:2025-12-24 12:28:04,688 -  step: 400  loss: -8.0000  grad_norm:  0.1266  memory: 12.26GiB(25.80%)  tps: 6,538  tflops: 51.11  mfu: 16.38%
[rank0]:2025-12-24 12:28:04,703 -  step: 400  loss: -8.0000  grad_norm:  0.1266  memory: 17.08GiB(35.95%)  tps: 6,538  tflops: 51.11  mfu: 16.38%
[rank3]:2025-12-24 12:28:04,845 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1228_step400_rank3.svg
[rank3]:			> Batch Time: 607.11 ms, GPU Bubble Ratio: 56.15%, 54.19%, 64.35%, 27.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-64ms      | [S0,MB0,B]  274-25-299ms   | [S0,MB1,B]  316-25-341ms   | [S0,MB2,B]  360-25-385ms   | [S0,MB3,B]  405-25-430ms   | [S0,MB4,B]  449-25-474ms   | [S0,MB5,B]  493-25-518ms   | [S0,MB6,B]  539-25-564ms   | [S0,MB7,B]  582-25-607ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-270ms   | [S1,MB1,B]  288-25-313ms   | [S1,MB2,B]  331-25-357ms   | [S1,MB3,B]  376-25-401ms   | [S1,MB4,B]  420-25-445ms   | [S1,MB5,B]  464-25-490ms   | [S1,MB6,B]  510-25-535ms   | [S1,MB7,B]  552-25-578ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  143-6-150ms    | [S2,MB0,B]  222-19-242ms   | [S2,MB1,B]  264-19-284ms   | [S2,MB2,B]  308-19-328ms   | [S2,MB3,B]  352-19-372ms   | [S2,MB4,B]  396-19-416ms   | [S2,MB5,B]  441-19-461ms   | [S2,MB6,B]  487-20-507ms   | [S2,MB7,B]  529-19-549ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-9-60ms      | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-42-258ms   | [S3,MB2,B]  258-43-301ms   | [S3,MB3,B]  301-44-346ms   | [S3,MB4,B]  346-44-390ms   | [S3,MB5,B]  390-44-434ms   | [S3,MB6,B]  434-45-480ms   | [S3,MB7,B]  480-45-526ms  
[rank3]:2025-12-24 12:28:33,253 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 12:28:33,462 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 12:28:33,517 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 12:28:33,490 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-24 12:30:09,651 - Avg. fwd time: 10.7930 / Avg. bwd time: 44.0952 / Avg. batch time: 498.6102 (ms) / GPU bubble ratio: 11.93%
[rank2]:2025-12-24 12:30:09,680 - Avg. fwd time: 7.1410 / Avg. bwd time: 19.8643 / Avg. batch time: 530.8451 (ms) / GPU bubble ratio: 59.30%
[rank1]:2025-12-24 12:30:09,715 - Avg. fwd time: 9.2130 / Avg. bwd time: 25.5156 / Avg. batch time: 570.9728 (ms) / GPU bubble ratio: 51.34%
[rank0]:2025-12-24 12:30:09,749 - Avg. fwd time: 8.1508 / Avg. bwd time: 25.0712 / Avg. batch time: 609.1254 (ms) / GPU bubble ratio: 56.37%
[rank0]:2025-12-24 12:32:09,788 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 12:32:14,711 - Avg. fwd time: 7.1397 / Avg. bwd time: 19.8661 / Avg. batch time: 530.7583 (ms) / GPU bubble ratio: 59.29%
[rank3]:2025-12-24 12:32:14,681 - Avg. fwd time: 10.7889 / Avg. bwd time: 44.0897 / Avg. batch time: 498.5320 (ms) / GPU bubble ratio: 11.94%
[rank0]:2025-12-24 12:32:14,780 - Avg. fwd time: 8.1497 / Avg. bwd time: 25.0719 / Avg. batch time: 609.0329 (ms) / GPU bubble ratio: 56.36%
[rank2]:2025-12-24 12:32:14,802 -  step: 450  loss: -8.0000  grad_norm:  0.1387  memory: 12.26GiB(25.80%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank1]:2025-12-24 12:32:14,746 - Avg. fwd time: 9.2112 / Avg. bwd time: 25.5151 / Avg. batch time: 570.8822 (ms) / GPU bubble ratio: 51.34%
[rank1]:2025-12-24 12:32:14,805 -  step: 450  loss: -8.0000  grad_norm:  0.1387  memory: 15.15GiB(31.89%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank3]:2025-12-24 12:32:14,814 -  step: 450  loss:  0.2211  grad_norm:  0.1387  memory: 26.98GiB(56.79%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank0]:2025-12-24 12:32:14,816 -  step: 450  loss: -8.0000  grad_norm:  0.1387  memory: 17.08GiB(35.95%)  tps: 6,551  tflops: 51.21  mfu: 16.41%
[rank3]:2025-12-24 12:34:19,801 - Avg. fwd time: 10.7872 / Avg. bwd time: 44.0847 / Avg. batch time: 498.4778 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:34:19,831 - Avg. fwd time: 7.1385 / Avg. bwd time: 19.8673 / Avg. batch time: 530.6955 (ms) / GPU bubble ratio: 59.29%
[rank1]:2025-12-24 12:34:19,866 - Avg. fwd time: 9.2101 / Avg. bwd time: 25.5148 / Avg. batch time: 570.8155 (ms) / GPU bubble ratio: 51.33%
[rank0]:2025-12-24 12:34:19,901 - Avg. fwd time: 8.1482 / Avg. bwd time: 25.0728 / Avg. batch time: 608.9638 (ms) / GPU bubble ratio: 56.36%
[rank0]:2025-12-24 12:36:20,006 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 12:36:24,941 - Avg. fwd time: 7.1377 / Avg. bwd time: 19.8684 / Avg. batch time: 530.6294 (ms) / GPU bubble ratio: 59.28%
[rank3]:2025-12-24 12:36:24,911 - Avg. fwd time: 10.7854 / Avg. bwd time: 44.0795 / Avg. batch time: 498.4196 (ms) / GPU bubble ratio: 11.94%
[rank0]:2025-12-24 12:36:25,011 - Avg. fwd time: 8.1477 / Avg. bwd time: 25.0733 / Avg. batch time: 608.8937 (ms) / GPU bubble ratio: 56.35%
[rank2]:2025-12-24 12:36:25,033 -  step: 500  loss: -8.0000  grad_norm:  0.1319  memory: 12.26GiB(25.80%)  tps: 6,548  tflops: 51.19  mfu: 16.41%
[rank1]:2025-12-24 12:36:24,976 - Avg. fwd time: 9.2092 / Avg. bwd time: 25.5149 / Avg. batch time: 570.7478 (ms) / GPU bubble ratio: 51.33%
[rank1]:2025-12-24 12:36:25,036 -  step: 500  loss: -8.0000  grad_norm:  0.1319  memory: 15.15GiB(31.89%)  tps: 6,548  tflops: 51.19  mfu: 16.41%
[rank3]:2025-12-24 12:36:25,046 -  step: 500  loss:  0.2131  grad_norm:  0.1319  memory: 26.98GiB(56.79%)  tps: 6,548  tflops: 51.19  mfu: 16.41%
[rank0]:2025-12-24 12:36:25,047 -  step: 500  loss: -8.0000  grad_norm:  0.1319  memory: 17.08GiB(35.95%)  tps: 6,548  tflops: 51.19  mfu: 16.41%
[rank3]:2025-12-24 12:36:25,194 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1236_step500_rank3.svg
[rank3]:			> Batch Time: 608.12 ms, GPU Bubble Ratio: 56.17%, 54.32%, 64.39%, 27.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-64ms      | [S0,MB0,B]  273-25-298ms   | [S0,MB1,B]  316-25-341ms   | [S0,MB2,B]  361-25-386ms   | [S0,MB3,B]  406-25-431ms   | [S0,MB4,B]  450-25-475ms   | [S0,MB5,B]  494-25-519ms   | [S0,MB6,B]  540-25-565ms   | [S0,MB7,B]  583-25-608ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  287-25-312ms   | [S1,MB2,B]  332-25-357ms   | [S1,MB3,B]  377-25-402ms   | [S1,MB4,B]  421-25-446ms   | [S1,MB5,B]  466-25-491ms   | [S1,MB6,B]  512-25-537ms   | [S1,MB7,B]  554-25-579ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  264-19-284ms   | [S2,MB2,B]  309-19-329ms   | [S2,MB3,B]  354-19-374ms   | [S2,MB4,B]  397-19-417ms   | [S2,MB5,B]  442-20-462ms   | [S2,MB6,B]  488-20-508ms   | [S2,MB7,B]  530-19-550ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-43-257ms   | [S3,MB2,B]  257-44-301ms   | [S3,MB3,B]  302-44-347ms   | [S3,MB4,B]  347-44-391ms   | [S3,MB5,B]  391-44-435ms   | [S3,MB6,B]  435-45-481ms   | [S3,MB7,B]  482-45-527ms  
[rank3]:2025-12-24 12:38:30,211 - Avg. fwd time: 10.7838 / Avg. bwd time: 44.0771 / Avg. batch time: 498.3868 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:38:30,242 - Avg. fwd time: 7.1369 / Avg. bwd time: 19.8691 / Avg. batch time: 530.6155 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-12-24 12:38:30,277 - Avg. fwd time: 9.2085 / Avg. bwd time: 25.5146 / Avg. batch time: 570.7330 (ms) / GPU bubble ratio: 51.33%
[rank0]:2025-12-24 12:38:30,312 - Avg. fwd time: 8.1466 / Avg. bwd time: 25.0739 / Avg. batch time: 608.8772 (ms) / GPU bubble ratio: 56.35%
[rank0]:2025-12-24 12:40:30,393 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 12:40:35,353 - Avg. fwd time: 7.1363 / Avg. bwd time: 19.8698 / Avg. batch time: 530.5552 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-12-24 12:40:35,388 - Avg. fwd time: 9.2080 / Avg. bwd time: 25.5151 / Avg. batch time: 570.6731 (ms) / GPU bubble ratio: 51.32%
[rank3]:2025-12-24 12:40:35,321 - Avg. fwd time: 10.7829 / Avg. bwd time: 44.0714 / Avg. batch time: 498.3342 (ms) / GPU bubble ratio: 11.94%
[rank0]:2025-12-24 12:40:35,424 - Avg. fwd time: 8.1455 / Avg. bwd time: 25.0744 / Avg. batch time: 608.8162 (ms) / GPU bubble ratio: 56.35%
[rank2]:2025-12-24 12:40:35,446 -  step: 550  loss: -8.0000  grad_norm:  0.1217  memory: 12.26GiB(25.80%)  tps: 6,543  tflops: 51.15  mfu: 16.39%
[rank1]:2025-12-24 12:40:35,449 -  step: 550  loss: -8.0000  grad_norm:  0.1217  memory: 15.15GiB(31.89%)  tps: 6,543  tflops: 51.15  mfu: 16.39%
[rank3]:2025-12-24 12:40:35,458 -  step: 550  loss:  0.2220  grad_norm:  0.1217  memory: 26.98GiB(56.79%)  tps: 6,543  tflops: 51.15  mfu: 16.39%
[rank0]:2025-12-24 12:40:35,460 -  step: 550  loss: -8.0000  grad_norm:  0.1217  memory: 17.08GiB(35.95%)  tps: 6,543  tflops: 51.15  mfu: 16.39%
[rank2]:2025-12-24 12:42:40,512 - Avg. fwd time: 7.1358 / Avg. bwd time: 19.8706 / Avg. batch time: 530.5087 (ms) / GPU bubble ratio: 59.27%
[rank3]:2025-12-24 12:42:40,480 - Avg. fwd time: 10.7818 / Avg. bwd time: 44.0675 / Avg. batch time: 498.2941 (ms) / GPU bubble ratio: 11.94%
[rank1]:2025-12-24 12:42:40,548 - Avg. fwd time: 9.2077 / Avg. bwd time: 25.5152 / Avg. batch time: 570.6267 (ms) / GPU bubble ratio: 51.32%
[rank0]:2025-12-24 12:42:40,583 - Avg. fwd time: 8.1449 / Avg. bwd time: 25.0749 / Avg. batch time: 608.7701 (ms) / GPU bubble ratio: 56.35%
[rank0]:2025-12-24 12:44:40,848 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 12:44:45,819 - Avg. fwd time: 10.7806 / Avg. bwd time: 44.0648 / Avg. batch time: 498.2696 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:44:45,851 - Avg. fwd time: 7.1354 / Avg. bwd time: 19.8713 / Avg. batch time: 530.4803 (ms) / GPU bubble ratio: 59.27%
[rank1]:2025-12-24 12:44:45,888 - Avg. fwd time: 9.2072 / Avg. bwd time: 25.5145 / Avg. batch time: 570.5975 (ms) / GPU bubble ratio: 51.32%
[rank2]:2025-12-24 12:44:45,946 -  step: 600  loss: -8.0000  grad_norm:  0.1378  memory: 12.26GiB(25.80%)  tps: 6,541  tflops: 51.13  mfu: 16.39%
[rank0]:2025-12-24 12:44:45,924 - Avg. fwd time: 8.1471 / Avg. bwd time: 25.0753 / Avg. batch time: 608.7486 (ms) / GPU bubble ratio: 56.34%
[rank0]:2025-12-24 12:44:45,960 -  step: 600  loss: -8.0000  grad_norm:  0.1378  memory: 17.08GiB(35.95%)  tps: 6,541  tflops: 51.13  mfu: 16.39%
[rank3]:2025-12-24 12:44:45,958 -  step: 600  loss:  0.2166  grad_norm:  0.1378  memory: 26.98GiB(56.79%)  tps: 6,541  tflops: 51.13  mfu: 16.39%
[rank1]:2025-12-24 12:44:45,949 -  step: 600  loss: -8.0000  grad_norm:  0.1378  memory: 15.15GiB(31.89%)  tps: 6,541  tflops: 51.13  mfu: 16.39%
[rank3]:2025-12-24 12:44:46,104 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1244_step600_rank3.svg
[rank3]:			> Batch Time: 606.62 ms, GPU Bubble Ratio: 56.08%, 54.26%, 64.35%, 27.97%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  273-25-298ms   | [S0,MB1,B]  316-25-341ms   | [S0,MB2,B]  361-25-386ms   | [S0,MB3,B]  405-25-430ms   | [S0,MB4,B]  450-25-475ms   | [S0,MB5,B]  494-25-519ms   | [S0,MB6,B]  540-25-565ms   | [S0,MB7,B]  581-25-606ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-270ms   | [S1,MB1,B]  287-25-312ms   | [S1,MB2,B]  332-25-357ms   | [S1,MB3,B]  376-25-402ms   | [S1,MB4,B]  421-25-447ms   | [S1,MB5,B]  465-25-491ms   | [S1,MB6,B]  511-25-536ms   | [S1,MB7,B]  552-25-578ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  264-19-284ms   | [S2,MB2,B]  308-19-328ms   | [S2,MB3,B]  353-19-373ms   | [S2,MB4,B]  398-19-418ms   | [S2,MB5,B]  442-19-462ms   | [S2,MB6,B]  488-19-508ms   | [S2,MB7,B]  529-19-549ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-9-60ms      | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-43-258ms   | [S3,MB2,B]  257-43-301ms   | [S3,MB3,B]  302-44-346ms   | [S3,MB4,B]  346-44-390ms   | [S3,MB5,B]  391-44-435ms   | [S3,MB6,B]  435-45-481ms   | [S3,MB7,B]  481-45-526ms  
[rank3]:2025-12-24 12:46:51,355 - Avg. fwd time: 10.7799 / Avg. bwd time: 44.0645 / Avg. batch time: 498.2635 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:46:51,389 - Avg. fwd time: 7.1351 / Avg. bwd time: 19.8722 / Avg. batch time: 530.4931 (ms) / GPU bubble ratio: 59.27%
[rank1]:2025-12-24 12:46:51,425 - Avg. fwd time: 9.2070 / Avg. bwd time: 25.5138 / Avg. batch time: 570.6108 (ms) / GPU bubble ratio: 51.32%
[rank0]:2025-12-24 12:46:51,462 - Avg. fwd time: 8.1474 / Avg. bwd time: 25.0757 / Avg. batch time: 608.7639 (ms) / GPU bubble ratio: 56.34%
[rank0]:2025-12-24 12:48:51,904 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 12:48:56,819 - Avg. fwd time: 10.7794 / Avg. bwd time: 44.0641 / Avg. batch time: 498.2553 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:48:56,851 - Avg. fwd time: 7.1347 / Avg. bwd time: 19.8730 / Avg. batch time: 530.4795 (ms) / GPU bubble ratio: 59.27%
[rank3]:2025-12-24 12:48:56,959 -  step: 650  loss:  0.2263  grad_norm:  0.1143  memory: 26.98GiB(56.79%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank1]:2025-12-24 12:48:56,887 - Avg. fwd time: 9.2067 / Avg. bwd time: 25.5133 / Avg. batch time: 570.5970 (ms) / GPU bubble ratio: 51.32%
[rank1]:2025-12-24 12:48:56,949 -  step: 650  loss: -8.0000  grad_norm:  0.1143  memory: 15.15GiB(31.89%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank0]:2025-12-24 12:48:56,924 - Avg. fwd time: 8.1474 / Avg. bwd time: 25.0763 / Avg. batch time: 608.7552 (ms) / GPU bubble ratio: 56.34%
[rank0]:2025-12-24 12:48:56,960 -  step: 650  loss: -8.0000  grad_norm:  0.1143  memory: 17.08GiB(35.95%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank2]:2025-12-24 12:48:56,946 -  step: 650  loss: -8.0000  grad_norm:  0.1143  memory: 12.26GiB(25.80%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank3]:2025-12-24 12:51:02,220 - Avg. fwd time: 10.7785 / Avg. bwd time: 44.0615 / Avg. batch time: 498.2281 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:51:02,253 - Avg. fwd time: 7.1344 / Avg. bwd time: 19.8737 / Avg. batch time: 530.4468 (ms) / GPU bubble ratio: 59.27%
[rank1]:2025-12-24 12:51:02,291 - Avg. fwd time: 9.2064 / Avg. bwd time: 25.5132 / Avg. batch time: 570.5644 (ms) / GPU bubble ratio: 51.32%
[rank0]:2025-12-24 12:51:02,328 - Avg. fwd time: 8.1476 / Avg. bwd time: 25.0769 / Avg. batch time: 608.7277 (ms) / GPU bubble ratio: 56.34%
[rank0]:2025-12-24 12:53:02,843 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 12:53:07,742 - Avg. fwd time: 10.7783 / Avg. bwd time: 44.0600 / Avg. batch time: 498.2136 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:53:07,774 - Avg. fwd time: 7.1345 / Avg. bwd time: 19.8756 / Avg. batch time: 530.4284 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-12-24 12:53:07,812 - Avg. fwd time: 9.2065 / Avg. bwd time: 25.5139 / Avg. batch time: 570.5481 (ms) / GPU bubble ratio: 51.32%
[rank1]:2025-12-24 12:53:07,879 -  step: 700  loss: -8.0000  grad_norm:  0.1208  memory: 15.15GiB(31.89%)  tps: 6,529  tflops: 51.04  mfu: 16.36%
[rank3]:2025-12-24 12:53:07,888 -  step: 700  loss:  0.1858  grad_norm:  0.1208  memory: 26.98GiB(56.79%)  tps: 6,529  tflops: 51.04  mfu: 16.36%
[rank0]:2025-12-24 12:53:07,850 - Avg. fwd time: 8.1482 / Avg. bwd time: 25.0790 / Avg. batch time: 608.7170 (ms) / GPU bubble ratio: 56.33%
[rank0]:2025-12-24 12:53:07,889 -  step: 700  loss: -8.0000  grad_norm:  0.1208  memory: 17.08GiB(35.95%)  tps: 6,529  tflops: 51.04  mfu: 16.36%
[rank2]:2025-12-24 12:53:07,875 -  step: 700  loss: -8.0000  grad_norm:  0.1208  memory: 12.26GiB(25.80%)  tps: 6,529  tflops: 51.04  mfu: 16.36%
[rank3]:2025-12-24 12:53:08,042 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1253_step700_rank3.svg
[rank3]:			> Batch Time: 609.67 ms, GPU Bubble Ratio: 56.14%, 54.33%, 64.42%, 27.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  274-25-299ms   | [S0,MB1,B]  316-25-341ms   | [S0,MB2,B]  361-25-386ms   | [S0,MB3,B]  406-25-431ms   | [S0,MB4,B]  451-25-476ms   | [S0,MB5,B]  496-25-521ms   | [S0,MB6,B]  540-25-565ms   | [S0,MB7,B]  584-25-609ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-9-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  288-25-313ms   | [S1,MB2,B]  332-25-358ms   | [S1,MB3,B]  377-25-403ms   | [S1,MB4,B]  422-25-448ms   | [S1,MB5,B]  467-25-493ms   | [S1,MB6,B]  511-25-537ms   | [S1,MB7,B]  555-25-580ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-132ms    | [S2,MB7,F]  143-6-150ms    | [S2,MB0,B]  222-19-242ms   | [S2,MB1,B]  265-19-284ms   | [S2,MB2,B]  309-19-329ms   | [S2,MB3,B]  354-19-374ms   | [S2,MB4,B]  399-20-419ms   | [S2,MB5,B]  444-20-464ms   | [S2,MB6,B]  488-19-508ms   | [S2,MB7,B]  531-19-550ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  122-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-43-258ms   | [S3,MB2,B]  258-44-302ms   | [S3,MB3,B]  302-45-347ms   | [S3,MB4,B]  348-44-392ms   | [S3,MB5,B]  392-44-436ms   | [S3,MB6,B]  437-45-482ms   | [S3,MB7,B]  482-45-527ms  
[rank2]:2025-12-24 12:55:13,497 - Avg. fwd time: 7.1345 / Avg. bwd time: 19.8770 / Avg. batch time: 530.4423 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-12-24 12:55:13,535 - Avg. fwd time: 9.2067 / Avg. bwd time: 25.5145 / Avg. batch time: 570.5645 (ms) / GPU bubble ratio: 51.32%
[rank3]:2025-12-24 12:55:13,464 - Avg. fwd time: 10.7785 / Avg. bwd time: 44.0595 / Avg. batch time: 498.2110 (ms) / GPU bubble ratio: 11.94%
[rank0]:2025-12-24 12:55:13,573 - Avg. fwd time: 8.1493 / Avg. bwd time: 25.0811 / Avg. batch time: 608.7392 (ms) / GPU bubble ratio: 56.33%
[rank0]:2025-12-24 12:57:14,120 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 12:57:19,082 - Avg. fwd time: 10.7792 / Avg. bwd time: 44.0594 / Avg. batch time: 498.2172 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:57:19,119 - Avg. fwd time: 7.1346 / Avg. bwd time: 19.8782 / Avg. batch time: 530.4450 (ms) / GPU bubble ratio: 59.26%
[rank3]:2025-12-24 12:57:19,230 -  step: 750  loss:  0.2246  grad_norm:  0.1423  memory: 26.98GiB(56.79%)  tps: 6,519  tflops: 50.96  mfu: 16.33%
[rank1]:2025-12-24 12:57:19,157 - Avg. fwd time: 9.2071 / Avg. bwd time: 25.5147 / Avg. batch time: 570.5707 (ms) / GPU bubble ratio: 51.32%
[rank1]:2025-12-24 12:57:19,220 -  step: 750  loss: -8.0000  grad_norm:  0.1423  memory: 15.15GiB(31.89%)  tps: 6,519  tflops: 50.96  mfu: 16.33%
[rank0]:2025-12-24 12:57:19,195 - Avg. fwd time: 8.1505 / Avg. bwd time: 25.0831 / Avg. batch time: 608.7507 (ms) / GPU bubble ratio: 56.33%
[rank0]:2025-12-24 12:57:19,231 -  step: 750  loss: -8.0000  grad_norm:  0.1423  memory: 17.08GiB(35.95%)  tps: 6,519  tflops: 50.96  mfu: 16.33%
[rank2]:2025-12-24 12:57:19,217 -  step: 750  loss: -8.0000  grad_norm:  0.1423  memory: 12.26GiB(25.80%)  tps: 6,519  tflops: 50.96  mfu: 16.33%
[rank3]:2025-12-24 12:59:24,549 - Avg. fwd time: 10.7795 / Avg. bwd time: 44.0586 / Avg. batch time: 498.2136 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 12:59:24,582 - Avg. fwd time: 7.1345 / Avg. bwd time: 19.8788 / Avg. batch time: 530.4371 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-12-24 12:59:24,621 - Avg. fwd time: 9.2072 / Avg. bwd time: 25.5151 / Avg. batch time: 570.5657 (ms) / GPU bubble ratio: 51.32%
[rank0]:2025-12-24 12:59:24,660 - Avg. fwd time: 8.1514 / Avg. bwd time: 25.0845 / Avg. batch time: 608.7501 (ms) / GPU bubble ratio: 56.32%
[rank0]:2025-12-24 13:01:25,086 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 13:01:30,106 - Avg. fwd time: 7.1343 / Avg. bwd time: 19.8786 / Avg. batch time: 530.4477 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-12-24 13:01:30,145 - Avg. fwd time: 9.2071 / Avg. bwd time: 25.5137 / Avg. batch time: 570.5766 (ms) / GPU bubble ratio: 51.32%
[rank3]:2025-12-24 13:01:30,072 - Avg. fwd time: 10.7795 / Avg. bwd time: 44.0600 / Avg. batch time: 498.2278 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-12-24 13:01:30,205 -  step: 800  loss: -8.0000  grad_norm:  0.1325  memory: 12.26GiB(25.80%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank2]:2025-12-24 13:01:30,205 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1325  tps: 6,933  tflops: 54.20  mfu: 15.87%
[rank2]:2025-12-24 13:01:30,205 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 13:01:30,206 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 13:01:30,183 - Avg. fwd time: 8.1537 / Avg. bwd time: 25.0851 / Avg. batch time: 608.7648 (ms) / GPU bubble ratio: 56.32%
[rank0]:2025-12-24 13:01:30,219 -  step: 800  loss: -8.0000  grad_norm:  0.1325  memory: 17.08GiB(35.95%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank0]:2025-12-24 13:01:30,219 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1325  tps: 6,933  tflops: 54.20  mfu: 15.86%
[rank0]:2025-12-24 13:01:30,219 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 13:01:30,220 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 13:01:30,208 -  step: 800  loss: -8.0000  grad_norm:  0.1325  memory: 15.15GiB(31.89%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank1]:2025-12-24 13:01:30,208 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1325  tps: 6,933  tflops: 54.20  mfu: 15.87%
[rank1]:2025-12-24 13:01:30,208 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 13:01:30,209 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 13:01:30,217 -  step: 800  loss:  0.2294  grad_norm:  0.1325  memory: 26.98GiB(56.79%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank3]:2025-12-24 13:01:30,218 - â„¹ï¸ final step: 800  loss:  0.2294  grad_norm:  0.1325  tps: 6,937  tflops: 54.23  mfu: 16.00%
[rank3]:2025-12-24 13:01:30,218 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 13:01:30,220 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 13:01:32,053 - Destroying the purge thread.
[rank2]:2025-12-24 13:01:32,053 - Destroying the purge thread.
[rank0]:2025-12-24 13:01:32,027 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-24 13:01:32,053 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-24 13:01:32,134 - Process group destroyed
[rank3]:2025-12-24 13:01:32,190 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1301_final800_rank3.svg
[rank3]:			> Batch Time: 607.64 ms, GPU Bubble Ratio: 56.11%, 54.27%, 64.37%, 27.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  274-25-299ms   | [S0,MB1,B]  317-25-342ms   | [S0,MB2,B]  361-25-386ms   | [S0,MB3,B]  406-25-431ms   | [S0,MB4,B]  450-25-475ms   | [S0,MB5,B]  495-25-520ms   | [S0,MB6,B]  540-25-565ms   | [S0,MB7,B]  582-25-607ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  288-25-313ms   | [S1,MB2,B]  332-25-357ms   | [S1,MB3,B]  377-25-402ms   | [S1,MB4,B]  421-25-447ms   | [S1,MB5,B]  466-25-491ms   | [S1,MB6,B]  511-25-537ms   | [S1,MB7,B]  553-25-579ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-150ms    | [S2,MB0,B]  222-19-242ms   | [S2,MB1,B]  265-19-285ms   | [S2,MB2,B]  309-19-329ms   | [S2,MB3,B]  353-19-373ms   | [S2,MB4,B]  398-19-418ms   | [S2,MB5,B]  443-19-463ms   | [S2,MB6,B]  488-19-508ms   | [S2,MB7,B]  530-19-550ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  122-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  175-40-215ms   | [S3,MB1,B]  215-43-258ms   | [S3,MB2,B]  258-44-302ms   | [S3,MB3,B]  302-44-347ms   | [S3,MB4,B]  347-44-391ms   | [S3,MB5,B]  391-44-435ms   | [S3,MB6,B]  436-45-481ms   | [S3,MB7,B]  481-45-527ms  
[rank3]:2025-12-24 13:01:32,321 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1/pipeline_schedule/251224_1301_thry_final800_rank3.svg
[rank3]:			> Batch Time: 290.75 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-8-44ms      | [S0,MB5,F]  44-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-70ms      | [S0,MB0,B]  149-17-167ms   | [S0,MB1,B]  167-17-185ms   | [S0,MB2,B]  185-17-202ms   | [S0,MB3,B]  202-17-220ms   | [S0,MB4,B]  220-17-237ms   | [S0,MB5,B]  237-17-255ms   | [S0,MB6,B]  255-17-273ms   | [S0,MB7,B]  273-17-290ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-35ms      | [S1,MB3,F]  35-8-44ms      | [S1,MB4,F]  44-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-70ms      | [S1,MB7,F]  70-8-79ms      | [S1,MB0,B]  132-17-149ms   | [S1,MB1,B]  149-17-167ms   | [S1,MB2,B]  167-17-185ms   | [S1,MB3,B]  185-17-202ms   | [S1,MB4,B]  202-17-220ms   | [S1,MB5,B]  220-17-237ms   | [S1,MB6,B]  237-17-255ms   | [S1,MB7,B]  255-17-273ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-35ms      | [S2,MB2,F]  35-8-44ms      | [S2,MB3,F]  44-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-70ms      | [S2,MB6,F]  70-8-79ms      | [S2,MB7,F]  79-8-88ms      | [S2,MB0,B]  114-17-132ms   | [S2,MB1,B]  132-17-149ms   | [S2,MB2,B]  149-17-167ms   | [S2,MB3,B]  167-17-185ms   | [S2,MB4,B]  185-17-202ms   | [S2,MB5,B]  202-17-220ms   | [S2,MB6,B]  220-17-237ms   | [S2,MB7,B]  237-17-255ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-35ms      | [S3,MB1,F]  35-8-44ms      | [S3,MB2,F]  44-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-70ms      | [S3,MB5,F]  70-8-79ms      | [S3,MB6,F]  79-8-88ms      | [S3,MB7,F]  88-8-96ms      | [S3,MB0,B]  96-17-114ms    | [S3,MB1,B]  114-17-132ms   | [S3,MB2,B]  132-17-149ms   | [S3,MB3,B]  149-17-167ms   | [S3,MB4,B]  167-17-185ms   | [S3,MB5,B]  185-17-202ms   | [S3,MB6,B]  202-17-220ms   | [S3,MB7,B]  220-17-237ms  
[rank3]:2025-12-24 13:01:32,322 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-24 13:01:32,512 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 273-290
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–„â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.72342
[rank3]:wandb:               final/avg_loss 0.22943
[rank3]:wandb:             final/avg_mfu(%) 16.0
[rank3]:wandb:             final/avg_tflops 54.23299
[rank3]:wandb:    final/avg_throughput(tps) 6937.34786
[rank3]:wandb:              final/grad_norm 0.13249
[rank3]:wandb:               final/max_loss 0.22943
[rank3]:wandb:                    grad_norm 0.13249
[rank3]:wandb: loss_metrics/global_avg_loss 0.22943
[rank3]:wandb: loss_metrics/global_max_loss 0.22943
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_GPipe_nofreeze_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/1mj2ihfb
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_GPipe_nofreeze_42_dm1/20251224-1154/wandb/run-20251224_115433-1mj2ihfb/logs
[rank3]:2025-12-24 13:01:33,570 - Process group destroyed
[rank0]:2025-12-24 13:01:34,053 - Training completed
[rank0]:2025-12-24 13:01:34,054 - Destroying the purge thread.
[rank0]:2025-12-24 13:01:34,218 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.3', 'layers.2', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.11', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.8', 'layers.5', 'layers.6', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.13', 'norm', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_GPipe_nofreeze_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_GPipe_nofreeze_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_GPipe_nofreeze_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_GPipe_nofreeze_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_GPipe_nofreeze_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_GPipe_nofreeze_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_GPipe_nofreeze_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_GPipe_nofreeze_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
