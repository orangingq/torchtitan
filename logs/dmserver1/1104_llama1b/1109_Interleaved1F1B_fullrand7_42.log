
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 12. (ìˆ˜) 03:25:04 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_Interleaved1F1B_fullrand7_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with fullrand7 x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-12 03:25:10,476 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank1]:2025-11-12 03:25:10,476 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank2]:2025-11-12 03:25:10,475 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank3]:2025-11-12 03:25:10,524 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank2]:2025-11-12 03:25:10,824 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-12 03:25:10,826 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-12 03:25:10,834 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-12 03:25:10,836 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-12 03:25:10,838 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-12 03:25:10,839 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-12 03:25:10,842 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-12 03:25:10,844 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-12 03:25:10,881 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-12 03:25:10,884 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-12 03:25:11,239 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-12 03:25:14,066 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-12 03:25:14,082 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-12 03:25:14,120 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-12 03:25:14,215 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-12 03:25:14,180 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-12 03:25:14,220 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-12 03:25:14,149 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-12 03:25:14,162 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-12 03:25:14,163 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-12 03:25:14,252 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-12 03:25:14,253 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-12 03:25:14,279 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-12 03:25:14,292 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-12 03:25:14,293 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-12 03:25:14,247 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-12 03:25:14,260 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-12 03:25:14,261 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-12 03:25:14,344 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-12 03:25:14,344 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-12 03:25:14,344 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-12 03:25:14,475 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-12 03:25:14,475 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-12 03:25:14,476 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-12 03:25:14,443 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-12 03:25:14,443 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-12 03:25:14,444 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ik72hncn
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_Interleaved1F1B_fullrand7_42_dm1/20251112-0325/wandb/run-20251112_032515-ik72hncn
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ik72hncn
[rank3]:2025-11-12 03:25:16,770 - INFO - WandB logging enabled
[rank3]:2025-11-12 03:25:16,770 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-12 03:25:16,811 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-12 03:25:16,841 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-12 03:25:16,854 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-12 03:25:16,855 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-12 03:25:17,061 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_Interleaved1F1B_fullrand7_42_dm1
[rank0]:2025-11-12 03:25:17,061 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-12 03:25:17,062 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-12 03:25:17,064 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-12 03:25:17,061 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-12 03:25:17,061 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-12 03:25:17,044 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-12 03:25:17,045 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-12 03:25:17,045 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-12 03:25:17,061 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-12 03:25:19,443 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-12 03:25:19,443 - INFO - Finished loading the checkpoint in 2.38 seconds.
[rank0]:2025-11-12 03:25:19,443 - INFO - Training starts at step 1
[rank3]:2025-11-12 03:25:25,283 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5370  memory: 15.04GiB(31.67%)  tps: 3,869  tflops: 30.25  mfu: 9.69%
[rank3]:2025-11-12 03:25:25,284 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-12 03:25:25,283 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  9.58GiB(20.17%)  tps: 2,962  tflops: 23.16  mfu: 7.42%
[rank1]:2025-11-12 03:25:25,283 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-12 03:25:25,307 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory: 10.95GiB(23.04%)  tps: 2,964  tflops: 23.17  mfu: 7.43%
[rank0]:2025-11-12 03:25:25,307 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-12 03:25:25,271 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  6.31GiB(13.29%)  tps: 2,939  tflops: 22.97  mfu: 7.36%
[rank2]:2025-11-12 03:25:25,271 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-12 03:27:31,506 - INFO - Avg. fwd time: 4.1804 / Avg. bwd time: 12.1077 / Avg. batch time: 638.4872 (ms) / GPU bubble ratio: 59.18%
[rank3]:2025-11-12 03:27:31,430 - INFO - Avg. fwd time: 6.3438 / Avg. bwd time: 21.2245 / Avg. batch time: 550.7672 (ms) / GPU bubble ratio: 19.91%
[rank2]:2025-11-12 03:27:31,484 - INFO - Avg. fwd time: 3.8796 / Avg. bwd time: 9.8911 / Avg. batch time: 585.2704 (ms) / GPU bubble ratio: 62.35%
[rank1]:2025-11-12 03:27:31,579 - INFO - Avg. fwd time: 4.9311 / Avg. bwd time: 12.3579 / Avg. batch time: 615.1801 (ms) / GPU bubble ratio: 55.03%
[rank0]:2025-11-12 03:29:38,487 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-12 03:29:43,365 - INFO - Avg. fwd time: 6.3614 / Avg. bwd time: 21.2970 / Avg. batch time: 552.7762 (ms) / GPU bubble ratio: 19.94%
[rank0]:2025-11-12 03:29:43,439 - INFO - Avg. fwd time: 4.2068 / Avg. bwd time: 12.1635 / Avg. batch time: 641.1542 (ms) / GPU bubble ratio: 59.15%
[rank2]:2025-11-12 03:29:43,418 - INFO - Avg. fwd time: 3.8721 / Avg. bwd time: 9.9116 / Avg. batch time: 587.5552 (ms) / GPU bubble ratio: 62.46%
[rank1]:2025-11-12 03:29:43,516 - INFO - Avg. fwd time: 4.9576 / Avg. bwd time: 12.4129 / Avg. batch time: 617.6991 (ms) / GPU bubble ratio: 55.01%
[rank1]:2025-11-12 03:29:43,680 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7613  memory: 11.85GiB(24.93%)  tps: 6,214  tflops: 48.58  mfu: 15.57%
[rank2]:2025-11-12 03:29:43,677 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7613  memory:  8.13GiB(17.12%)  tps: 6,214  tflops: 48.58  mfu: 15.57%
[rank0]:2025-11-12 03:29:43,691 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7613  memory: 14.75GiB(31.06%)  tps: 6,214  tflops: 48.58  mfu: 15.57%
[rank3]:2025-11-12 03:29:43,688 - INFO -  step: 50  loss:  9.9138  grad_norm: 12.7613  memory: 18.46GiB(38.86%)  tps: 6,214  tflops: 48.58  mfu: 15.57%
[rank3]:2025-11-12 03:30:36,613 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-12 03:31:29,337 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank2]:2025-11-12 03:31:29,679 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,693 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,709 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,692 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,708 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,694 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,712 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,648 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-12 03:31:29,673 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,681 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,688 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,696 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,707 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,729 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,746 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,767 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,728 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,749 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,768 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,728 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,750 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,773 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,796 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,727 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,748 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,769 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,815 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,840 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,873 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,904 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,912 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,832 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,855 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,908 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,845 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,852 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,899 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,913 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,832 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,864 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,897 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,905 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,911 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,922 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,929 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,940 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,948 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-12 03:31:29,961 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,924 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,929 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,937 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,944 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,949 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,964 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,979 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-12 03:31:29,992 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,922 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,928 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,936 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,949 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,960 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-12 03:31:29,970 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,924 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,932 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:29,939 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-12 03:31:49,715 - INFO - Avg. fwd time: 6.4304 / Avg. bwd time: 20.6409 / Avg. batch time: 545.2122 (ms) / GPU bubble ratio: 20.56%
[rank2]:2025-11-12 03:31:49,734 - INFO - Avg. fwd time: 3.9142 / Avg. bwd time: 9.5812 / Avg. batch time: 579.6730 (ms) / GPU bubble ratio: 62.75%
[rank1]:2025-11-12 03:31:49,751 - INFO - Avg. fwd time: 5.0368 / Avg. bwd time: 11.9987 / Avg. batch time: 609.2911 (ms) / GPU bubble ratio: 55.26%
[rank0]:2025-11-12 03:31:49,761 - INFO - Avg. fwd time: 4.2856 / Avg. bwd time: 11.5456 / Avg. batch time: 631.9483 (ms) / GPU bubble ratio: 59.92%
[rank3]:2025-11-12 03:32:09,501 - INFO - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-12 03:32:09,777 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0332_max_batch_time.svg
[rank3]:> Batch Time: 503.34 ms, GPU Bubble Ratio: 47.85%, 44.70%, 56.11%, 13.24%
[rank3]:2025-11-12 03:32:10,016 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0332_min_batch_time.svg
[rank3]:> Batch Time: 317.89 ms, GPU Bubble Ratio: 67.10%, 46.26%, 56.54%, 11.34%
[rank3]:2025-11-12 03:32:10,271 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0332_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 338.20 ms, GPU Bubble Ratio: 33.66%, 28.68%, 40.66%, 9.62%
[rank3]:2025-11-12 03:32:10,272 - INFO - 	> Batch Time: 338.20 ms (Average Freeze Ratio: 0.38, Time Reduction Rate: 0.33)
[rank0]:2025-11-12 03:33:35,511 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-12 03:33:40,171 - INFO - Avg. fwd time: 4.0050 / Avg. bwd time: 9.0554 / Avg. batch time: 561.7111 (ms) / GPU bubble ratio: 62.80%
[rank0]:2025-11-12 03:33:40,180 - INFO - Avg. fwd time: 4.3633 / Avg. bwd time: 10.1977 / Avg. batch time: 609.5681 (ms) / GPU bubble ratio: 61.78%
[rank3]:2025-11-12 03:33:40,120 - INFO - Avg. fwd time: 6.6065 / Avg. bwd time: 19.1650 / Avg. batch time: 527.5247 (ms) / GPU bubble ratio: 21.83%
[rank3]:2025-11-12 03:33:40,129 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB0] 0.33/1.00, [MB1] 0.32/0.96, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00, [MB4] 0.00/0.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.15/0.44
[rank1]:2025-11-12 03:33:40,218 - INFO - Avg. fwd time: 5.1586 / Avg. bwd time: 11.1083 / Avg. batch time: 589.4056 (ms) / GPU bubble ratio: 55.84%
[rank2]:2025-11-12 03:33:40,366 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.08/0.23, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.10/0.30, [MB4] 0.33/1.00, [MB5] 0.29/0.88, [MB6] 0.16/0.47, [MB7] 0.33/1.00
[rank1]:2025-11-12 03:33:40,383 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-12 03:33:40,406 - INFO -  step: 100  loss: -8.0000  grad_norm:  4.4969  memory: 11.85GiB(24.93%)  tps: 6,921  tflops: 54.11  mfu: 17.34%
[rank1]:2025-11-12 03:33:40,474 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0333_stage1_step100.svg
[rank2]:2025-11-12 03:33:40,401 - INFO -  step: 100  loss: -8.0000  grad_norm:  4.4969  memory:  8.35GiB(17.57%)  tps: 6,921  tflops: 54.11  mfu: 17.34%
[rank2]:2025-11-12 03:33:40,474 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0333_stage2_step100.svg
[rank0]:2025-11-12 03:33:40,391 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.18/0.55, [MB5] 0.18/0.55, [MB6] 0.18/0.55, [MB7] 0.33/1.00
[rank0]:2025-11-12 03:33:40,402 - INFO -  step: 100  loss: -8.0000  grad_norm:  4.4969  memory: 14.75GiB(31.06%)  tps: 6,922  tflops: 54.11  mfu: 17.34%
[rank0]:2025-11-12 03:33:40,474 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0333_stage0_step100.svg
[rank3]:2025-11-12 03:33:40,416 - INFO -  step: 100  loss:  8.9005  grad_norm:  4.4969  memory: 18.95GiB(39.89%)  tps: 6,921  tflops: 54.11  mfu: 17.34%
[rank1]:2025-11-12 03:33:40,514 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0333_stage5_step100.svg
[rank2]:2025-11-12 03:33:40,513 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0333_stage6_step100.svg
[rank0]:2025-11-12 03:33:40,512 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0333_stage4_step100.svg
[rank3]:2025-11-12 03:33:40,656 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0333_real_step100_rank3.svg
[rank3]:> Batch Time: 600.74 ms, GPU Bubble Ratio: 64.36%, 55.97%, 65.39%, 33.04%
[rank3]:2025-11-12 03:33:40,699 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0333_stage3_step100.svg
[rank3]:2025-11-12 03:33:40,736 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0333_stage7_step100.svg
[rank3]:2025-11-12 03:35:42,384 - INFO - Avg. fwd time: 6.6287 / Avg. bwd time: 18.9310 / Avg. batch time: 524.6222 (ms) / GPU bubble ratio: 22.05%
[rank2]:2025-11-12 03:35:42,433 - INFO - Avg. fwd time: 4.0071 / Avg. bwd time: 9.0488 / Avg. batch time: 558.8310 (ms) / GPU bubble ratio: 62.62%
[rank0]:2025-11-12 03:35:42,442 - INFO - Avg. fwd time: 4.3776 / Avg. bwd time: 10.3487 / Avg. batch time: 606.4130 (ms) / GPU bubble ratio: 61.15%
[rank1]:2025-11-12 03:35:42,490 - INFO - Avg. fwd time: 5.1680 / Avg. bwd time: 11.0092 / Avg. batch time: 586.0211 (ms) / GPU bubble ratio: 55.83%
[rank0]:2025-11-12 03:37:36,974 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-12 03:37:41,638 - INFO - Avg. fwd time: 6.6779 / Avg. bwd time: 18.5626 / Avg. batch time: 520.7885 (ms) / GPU bubble ratio: 22.45%
[rank3]:2025-11-12 03:37:41,643 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.64/0.96, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.29/0.44
[rank2]:2025-11-12 03:37:41,663 - INFO - Avg. fwd time: 4.0220 / Avg. bwd time: 8.9730 / Avg. batch time: 554.6230 (ms) / GPU bubble ratio: 62.51%
[rank2]:2025-11-12 03:37:41,668 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.15/0.23, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.20/0.30, [MB4] 0.67/1.00, [MB5] 0.59/0.88, [MB6] 0.31/0.47, [MB7] 0.67/1.00
[rank1]:2025-11-12 03:37:41,685 - INFO - Avg. fwd time: 5.2018 / Avg. bwd time: 10.7793 / Avg. batch time: 581.0748 (ms) / GPU bubble ratio: 56.00%
[rank1]:2025-11-12 03:37:41,691 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-12 03:37:41,740 - INFO -  step: 150  loss:  4.6320  grad_norm:  4.0878  memory: 18.95GiB(39.89%)  tps: 6,789  tflops: 53.08  mfu: 17.01%
[rank2]:2025-11-12 03:37:41,725 - INFO -  step: 150  loss: -8.0000  grad_norm:  4.0878  memory:  8.37GiB(17.61%)  tps: 6,789  tflops: 53.07  mfu: 17.01%
[rank0]:2025-11-12 03:37:41,708 - INFO - Avg. fwd time: 4.4042 / Avg. bwd time: 10.4277 / Avg. batch time: 601.5814 (ms) / GPU bubble ratio: 60.55%
[rank0]:2025-11-12 03:37:41,715 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.37/0.55, [MB5] 0.37/0.55, [MB6] 0.37/0.55, [MB7] 0.67/1.00
[rank0]:2025-11-12 03:37:41,740 - INFO -  step: 150  loss: -8.0000  grad_norm:  4.0878  memory: 14.89GiB(31.34%)  tps: 6,789  tflops: 53.07  mfu: 17.01%
[rank1]:2025-11-12 03:37:41,728 - INFO -  step: 150  loss: -8.0000  grad_norm:  4.0878  memory: 12.24GiB(25.76%)  tps: 6,789  tflops: 53.08  mfu: 17.01%
[rank3]:2025-11-12 03:39:31,042 - INFO - Avg. fwd time: 6.7312 / Avg. bwd time: 18.0417 / Avg. batch time: 514.1056 (ms) / GPU bubble ratio: 22.90%
[rank2]:2025-11-12 03:39:31,073 - INFO - Avg. fwd time: 4.0460 / Avg. bwd time: 8.8496 / Avg. batch time: 547.2689 (ms) / GPU bubble ratio: 62.30%
[rank0]:2025-11-12 03:39:31,050 - INFO - Avg. fwd time: 4.4175 / Avg. bwd time: 10.2133 / Avg. batch time: 592.8077 (ms) / GPU bubble ratio: 60.51%
[rank1]:2025-11-12 03:39:31,111 - INFO - Avg. fwd time: 5.2340 / Avg. bwd time: 10.4853 / Avg. batch time: 572.7573 (ms) / GPU bubble ratio: 56.09%
[rank0]:2025-11-12 03:41:12,307 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-12 03:41:16,296 - INFO - Avg. fwd time: 4.4395 / Avg. bwd time: 9.7179 / Avg. batch time: 582.5910 (ms) / GPU bubble ratio: 61.12%
[rank3]:2025-11-12 03:41:16,309 - INFO - Avg. fwd time: 6.7972 / Avg. bwd time: 17.4167 / Avg. batch time: 506.6230 (ms) / GPU bubble ratio: 23.53%
[rank3]:2025-11-12 03:41:16,318 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.44/0.44
[rank2]:2025-11-12 03:41:16,340 - INFO - Avg. fwd time: 4.0795 / Avg. bwd time: 8.6730 / Avg. batch time: 539.1651 (ms) / GPU bubble ratio: 62.16%
[rank1]:2025-11-12 03:41:16,379 - INFO - Avg. fwd time: 5.2860 / Avg. bwd time: 10.0977 / Avg. batch time: 563.5921 (ms) / GPU bubble ratio: 56.33%
[rank0]:2025-11-12 03:41:16,533 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.55/0.55, [MB5] 0.55/0.55, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-12 03:41:16,539 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.2555  memory: 14.93GiB(31.43%)  tps: 7,628  tflops: 59.63  mfu: 19.11%
[rank3]:2025-11-12 03:41:16,540 - INFO -  step: 200  loss:  2.4046  grad_norm:  0.2555  memory: 19.46GiB(40.96%)  tps: 7,628  tflops: 59.63  mfu: 19.11%
[rank2]:2025-11-12 03:41:16,522 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.23/0.23, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.30/0.30, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank2]:2025-11-12 03:41:16,540 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.2555  memory:  8.37GiB(17.61%)  tps: 7,627  tflops: 59.62  mfu: 19.11%
[rank1]:2025-11-12 03:41:16,532 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-12 03:41:16,540 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.2555  memory: 12.29GiB(25.88%)  tps: 7,627  tflops: 59.63  mfu: 19.11%
[rank0]:2025-11-12 03:41:16,593 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0341_stage0_step200.svg
[rank0]:2025-11-12 03:41:16,636 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0341_stage4_step200.svg
[rank2]:2025-11-12 03:41:16,593 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0341_stage2_step200.svg
[rank2]:2025-11-12 03:41:16,636 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0341_stage6_step200.svg
[rank1]:2025-11-12 03:41:16,596 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0341_stage1_step200.svg
[rank1]:2025-11-12 03:41:16,642 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0341_stage5_step200.svg
[rank3]:2025-11-12 03:41:16,783 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0341_real_step200_rank3.svg
[rank3]:> Batch Time: 509.75 ms, GPU Bubble Ratio: 67.24%, 58.60%, 62.94%, 37.30%
[rank3]:2025-11-12 03:41:16,830 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0341_stage3_step200.svg
[rank3]:2025-11-12 03:41:16,871 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0341_stage7_step200.svg
[rank3]:2025-11-12 03:43:02,384 - INFO - Avg. fwd time: 6.8575 / Avg. bwd time: 16.9307 / Avg. batch time: 501.3633 (ms) / GPU bubble ratio: 24.08%
[rank2]:2025-11-12 03:43:02,406 - INFO - Avg. fwd time: 4.1101 / Avg. bwd time: 8.5109 / Avg. batch time: 533.5577 (ms) / GPU bubble ratio: 62.15%
[rank0]:2025-11-12 03:43:02,439 - INFO - Avg. fwd time: 4.4650 / Avg. bwd time: 9.1651 / Avg. batch time: 574.9797 (ms) / GPU bubble ratio: 62.07%
[rank1]:2025-11-12 03:43:02,426 - INFO - Avg. fwd time: 5.3341 / Avg. bwd time: 9.7383 / Avg. batch time: 557.1148 (ms) / GPU bubble ratio: 56.71%
[rank0]:2025-11-12 03:44:42,278 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-12 03:44:46,153 - INFO - Avg. fwd time: 4.4789 / Avg. bwd time: 8.7801 / Avg. batch time: 568.9733 (ms) / GPU bubble ratio: 62.71%
[rank2]:2025-11-12 03:44:46,206 - INFO - Avg. fwd time: 4.1313 / Avg. bwd time: 8.4020 / Avg. batch time: 528.9693 (ms) / GPU bubble ratio: 62.09%
[rank3]:2025-11-12 03:44:46,173 - INFO - Avg. fwd time: 6.9029 / Avg. bwd time: 16.5481 / Avg. batch time: 497.1190 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-11-12 03:44:46,180 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.44/0.44
[rank1]:2025-11-12 03:44:46,219 - INFO - Avg. fwd time: 5.3665 / Avg. bwd time: 9.4891 / Avg. batch time: 551.9134 (ms) / GPU bubble ratio: 56.93%
[rank0]:2025-11-12 03:44:46,391 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.55/0.55, [MB5] 0.55/0.55, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-12 03:44:46,397 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4067  memory: 14.93GiB(31.43%)  tps: 7,807  tflops: 61.03  mfu: 19.56%
[rank2]:2025-11-12 03:44:46,382 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.23/0.23, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.30/0.30, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank2]:2025-11-12 03:44:46,397 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4067  memory:  8.37GiB(17.61%)  tps: 7,807  tflops: 61.03  mfu: 19.56%
[rank3]:2025-11-12 03:44:46,397 - INFO -  step: 250  loss:  1.2230  grad_norm:  0.4067  memory: 19.46GiB(40.96%)  tps: 7,807  tflops: 61.03  mfu: 19.56%
[rank1]:2025-11-12 03:44:46,391 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-12 03:44:46,397 - INFO -  step: 250  loss: -8.0000  grad_norm:  0.4067  memory: 12.29GiB(25.88%)  tps: 7,807  tflops: 61.03  mfu: 19.56%
[rank0]:2025-11-12 03:46:31,023 - INFO - Avg. fwd time: 4.4895 / Avg. bwd time: 8.4099 / Avg. batch time: 563.5018 (ms) / GPU bubble ratio: 63.37%
[rank2]:2025-11-12 03:46:31,069 - INFO - Avg. fwd time: 4.1531 / Avg. bwd time: 8.2964 / Avg. batch time: 524.8756 (ms) / GPU bubble ratio: 62.05%
[rank3]:2025-11-12 03:46:31,041 - INFO - Avg. fwd time: 6.9451 / Avg. bwd time: 16.2110 / Avg. batch time: 493.3811 (ms) / GPU bubble ratio: 24.91%
[rank1]:2025-11-12 03:46:31,082 - INFO - Avg. fwd time: 5.3960 / Avg. bwd time: 9.2502 / Avg. batch time: 547.2302 (ms) / GPU bubble ratio: 57.18%
[rank0]:2025-11-12 03:48:12,842 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-12 03:48:16,997 - INFO - Avg. fwd time: 6.9768 / Avg. bwd time: 15.9620 / Avg. batch time: 490.6271 (ms) / GPU bubble ratio: 25.19%
[rank3]:2025-11-12 03:48:17,002 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.44/0.44
[rank2]:2025-11-12 03:48:17,020 - INFO - Avg. fwd time: 4.1707 / Avg. bwd time: 8.2117 / Avg. batch time: 521.8337 (ms) / GPU bubble ratio: 62.03%
[rank2]:2025-11-12 03:48:17,026 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.23/0.23, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.30/0.30, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank2]:2025-11-12 03:48:17,066 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3725  memory:  8.37GiB(17.61%)  tps: 7,777  tflops: 60.80  mfu: 19.49%
[rank0]:2025-11-12 03:48:17,057 - INFO - Avg. fwd time: 4.4997 / Avg. bwd time: 8.1052 / Avg. batch time: 559.3474 (ms) / GPU bubble ratio: 63.94%
[rank0]:2025-11-12 03:48:17,061 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.55/0.55, [MB5] 0.55/0.55, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-12 03:48:17,066 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3725  memory: 14.93GiB(31.43%)  tps: 7,777  tflops: 60.80  mfu: 19.49%
[rank1]:2025-11-12 03:48:17,042 - INFO - Avg. fwd time: 5.4207 / Avg. bwd time: 9.0542 / Avg. batch time: 543.7097 (ms) / GPU bubble ratio: 57.40%
[rank1]:2025-11-12 03:48:17,048 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-12 03:48:17,067 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3725  memory: 12.29GiB(25.88%)  tps: 7,777  tflops: 60.80  mfu: 19.49%
[rank3]:2025-11-12 03:48:17,083 - INFO -  step: 300  loss:  0.4869  grad_norm:  0.3725  memory: 19.46GiB(40.96%)  tps: 7,777  tflops: 60.79  mfu: 19.49%
[rank2]:2025-11-12 03:48:17,133 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0348_stage2_step300.svg
[rank2]:2025-11-12 03:48:17,173 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0348_stage6_step300.svg
[rank0]:2025-11-12 03:48:17,132 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0348_stage0_step300.svg
[rank0]:2025-11-12 03:48:17,173 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0348_stage4_step300.svg
[rank1]:2025-11-12 03:48:17,134 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0348_stage1_step300.svg
[rank1]:2025-11-12 03:48:17,175 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0348_stage5_step300.svg
[rank3]:2025-11-12 03:48:17,316 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0348_real_step300_rank3.svg
[rank3]:> Batch Time: 514.00 ms, GPU Bubble Ratio: 70.99%, 60.90%, 63.50%, 34.91%
[rank3]:2025-11-12 03:48:17,358 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0348_stage3_step300.svg
[rank3]:2025-11-12 03:48:17,398 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0348_stage7_step300.svg
[rank3]:2025-11-12 03:50:00,855 - INFO - Avg. fwd time: 7.0036 / Avg. bwd time: 15.7576 / Avg. batch time: 488.0882 (ms) / GPU bubble ratio: 25.39%
[rank0]:2025-11-12 03:50:00,830 - INFO - Avg. fwd time: 4.4979 / Avg. bwd time: 7.8780 / Avg. batch time: 555.7357 (ms) / GPU bubble ratio: 64.37%
[rank2]:2025-11-12 03:50:00,882 - INFO - Avg. fwd time: 4.1865 / Avg. bwd time: 8.1546 / Avg. batch time: 519.1029 (ms) / GPU bubble ratio: 61.96%
[rank1]:2025-11-12 03:50:00,898 - INFO - Avg. fwd time: 5.4334 / Avg. bwd time: 8.9089 / Avg. batch time: 540.6065 (ms) / GPU bubble ratio: 57.55%
[rank0]:2025-11-12 03:51:40,846 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-12 03:51:44,750 - INFO - Avg. fwd time: 4.4956 / Avg. bwd time: 7.6499 / Avg. batch time: 552.1419 (ms) / GPU bubble ratio: 64.80%
[rank3]:2025-11-12 03:51:44,771 - INFO - Avg. fwd time: 7.0257 / Avg. bwd time: 15.5609 / Avg. batch time: 485.6598 (ms) / GPU bubble ratio: 25.59%
[rank1]:2025-11-12 03:51:44,810 - INFO - Avg. fwd time: 5.4454 / Avg. bwd time: 8.7626 / Avg. batch time: 537.5267 (ms) / GPU bubble ratio: 57.71%
[rank2]:2025-11-12 03:51:44,798 - INFO - Avg. fwd time: 4.2015 / Avg. bwd time: 8.0974 / Avg. batch time: 516.3991 (ms) / GPU bubble ratio: 61.89%
[rank0]:2025-11-12 03:51:44,989 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1569  memory: 14.93GiB(31.43%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank1]:2025-11-12 03:51:44,989 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1569  memory: 12.29GiB(25.88%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank2]:2025-11-12 03:51:44,989 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1569  memory:  8.37GiB(17.61%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank3]:2025-11-12 03:51:45,002 - INFO -  step: 350  loss:  0.3271  grad_norm:  0.1569  memory: 19.46GiB(40.96%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank3]:2025-11-12 03:53:28,377 - INFO - Avg. fwd time: 7.0438 / Avg. bwd time: 15.3863 / Avg. batch time: 483.4038 (ms) / GPU bubble ratio: 25.76%
[rank2]:2025-11-12 03:53:28,400 - INFO - Avg. fwd time: 4.2152 / Avg. bwd time: 8.0394 / Avg. batch time: 513.9093 (ms) / GPU bubble ratio: 61.85%
[rank1]:2025-11-12 03:53:28,422 - INFO - Avg. fwd time: 5.4565 / Avg. bwd time: 8.6362 / Avg. batch time: 534.7157 (ms) / GPU bubble ratio: 57.83%
[rank0]:2025-11-12 03:53:28,437 - INFO - Avg. fwd time: 4.4937 / Avg. bwd time: 7.4537 / Avg. batch time: 548.8906 (ms) / GPU bubble ratio: 65.17%
[rank0]:2025-11-12 03:55:06,998 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-12 03:55:10,845 - INFO - Avg. fwd time: 4.4924 / Avg. bwd time: 7.3061 / Avg. batch time: 546.2462 (ms) / GPU bubble ratio: 65.44%
[rank1]:2025-11-12 03:55:10,907 - INFO - Avg. fwd time: 5.4645 / Avg. bwd time: 8.5415 / Avg. batch time: 532.4022 (ms) / GPU bubble ratio: 57.91%
[rank3]:2025-11-12 03:55:10,866 - INFO - Avg. fwd time: 7.0597 / Avg. bwd time: 15.2370 / Avg. batch time: 481.5097 (ms) / GPU bubble ratio: 25.91%
[rank2]:2025-11-12 03:55:10,892 - INFO - Avg. fwd time: 4.2253 / Avg. bwd time: 8.0016 / Avg. batch time: 511.8388 (ms) / GPU bubble ratio: 61.78%
[rank1]:2025-11-12 03:55:11,081 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0573  memory: 12.29GiB(25.88%)  tps: 7,950  tflops: 62.15  mfu: 19.92%
[rank0]:2025-11-12 03:55:11,081 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0573  memory: 14.93GiB(31.43%)  tps: 7,950  tflops: 62.15  mfu: 19.92%
[rank0]:2025-11-12 03:55:11,133 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0355_stage0_step400.svg
[rank3]:2025-11-12 03:55:11,080 - INFO -  step: 400  loss:  0.2742  grad_norm:  0.0573  memory: 19.46GiB(40.96%)  tps: 7,950  tflops: 62.15  mfu: 19.92%
[rank2]:2025-11-12 03:55:11,081 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0573  memory:  8.37GiB(17.61%)  tps: 7,950  tflops: 62.15  mfu: 19.92%
[rank2]:2025-11-12 03:55:11,134 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0355_stage2_step400.svg
[rank1]:2025-11-12 03:55:11,144 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0355_stage1_step400.svg
[rank1]:2025-11-12 03:55:11,190 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0355_stage5_step400.svg
[rank0]:2025-11-12 03:55:11,178 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0355_stage4_step400.svg
[rank2]:2025-11-12 03:55:11,178 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0355_stage6_step400.svg
[rank3]:2025-11-12 03:55:11,315 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0355_real_step400_rank3.svg
[rank3]:> Batch Time: 492.75 ms, GPU Bubble Ratio: 69.72%, 59.20%, 61.53%, 37.13%
[rank3]:2025-11-12 03:55:11,362 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0355_stage3_step400.svg
[rank3]:2025-11-12 03:55:11,405 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0355_stage7_step400.svg
[rank3]:2025-11-12 03:55:34,514 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-12 03:55:34,722 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-12 03:55:34,723 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-12 03:55:34,714 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-12 03:56:54,324 - INFO - Avg. fwd time: 4.4911 / Avg. bwd time: 7.1540 / Avg. batch time: 543.6838 (ms) / GPU bubble ratio: 65.73%
[rank3]:2025-11-12 03:56:54,347 - INFO - Avg. fwd time: 7.0779 / Avg. bwd time: 15.0886 / Avg. batch time: 479.6647 (ms) / GPU bubble ratio: 26.06%
[rank2]:2025-11-12 03:56:54,374 - INFO - Avg. fwd time: 4.2343 / Avg. bwd time: 7.9721 / Avg. batch time: 509.8687 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-11-12 03:56:54,386 - INFO - Avg. fwd time: 5.4730 / Avg. bwd time: 8.4442 / Avg. batch time: 530.1811 (ms) / GPU bubble ratio: 58.00%
[rank0]:2025-11-12 03:58:34,880 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-12 03:58:39,037 - INFO - Avg. fwd time: 7.0919 / Avg. bwd time: 14.9900 / Avg. batch time: 478.4819 (ms) / GPU bubble ratio: 26.16%
[rank0]:2025-11-12 03:58:39,102 - INFO - Avg. fwd time: 4.4901 / Avg. bwd time: 7.0195 / Avg. batch time: 541.8128 (ms) / GPU bubble ratio: 66.01%
[rank0]:2025-11-12 03:58:39,111 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0792  memory: 14.93GiB(31.43%)  tps: 7,876  tflops: 61.57  mfu: 19.73%
[rank1]:2025-11-12 03:58:39,085 - INFO - Avg. fwd time: 5.4797 / Avg. bwd time: 8.3580 / Avg. batch time: 528.6103 (ms) / GPU bubble ratio: 58.12%
[rank1]:2025-11-12 03:58:39,111 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0792  memory: 12.29GiB(25.88%)  tps: 7,876  tflops: 61.57  mfu: 19.73%
[rank3]:2025-11-12 03:58:39,128 - INFO -  step: 450  loss:  0.2723  grad_norm:  0.0792  memory: 19.46GiB(40.96%)  tps: 7,875  tflops: 61.56  mfu: 19.73%
[rank2]:2025-11-12 03:58:39,062 - INFO - Avg. fwd time: 4.2433 / Avg. bwd time: 7.9409 / Avg. batch time: 508.5176 (ms) / GPU bubble ratio: 61.66%
[rank2]:2025-11-12 03:58:39,111 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0792  memory:  8.37GiB(17.61%)  tps: 7,876  tflops: 61.57  mfu: 19.73%
[rank0]:2025-11-12 04:00:22,818 - INFO - Avg. fwd time: 4.4896 / Avg. bwd time: 6.9163 / Avg. batch time: 540.2126 (ms) / GPU bubble ratio: 66.22%
[rank3]:2025-11-12 04:00:22,842 - INFO - Avg. fwd time: 7.1050 / Avg. bwd time: 14.9029 / Avg. batch time: 477.4142 (ms) / GPU bubble ratio: 26.24%
[rank2]:2025-11-12 04:00:22,871 - INFO - Avg. fwd time: 4.2507 / Avg. bwd time: 7.9145 / Avg. batch time: 507.3193 (ms) / GPU bubble ratio: 61.63%
[rank1]:2025-11-12 04:00:22,879 - INFO - Avg. fwd time: 5.4854 / Avg. bwd time: 8.2920 / Avg. batch time: 527.2414 (ms) / GPU bubble ratio: 58.19%
[rank0]:2025-11-12 04:02:02,705 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-12 04:02:06,563 - INFO - Avg. fwd time: 4.4885 / Avg. bwd time: 6.8079 / Avg. batch time: 538.4994 (ms) / GPU bubble ratio: 66.44%
[rank3]:2025-11-12 04:02:06,587 - INFO - Avg. fwd time: 7.1193 / Avg. bwd time: 14.8070 / Avg. batch time: 476.2577 (ms) / GPU bubble ratio: 26.34%
[rank2]:2025-11-12 04:02:06,613 - INFO - Avg. fwd time: 4.2581 / Avg. bwd time: 7.8878 / Avg. batch time: 506.0302 (ms) / GPU bubble ratio: 61.60%
[rank1]:2025-11-12 04:02:06,626 - INFO - Avg. fwd time: 5.4913 / Avg. bwd time: 8.2228 / Avg. batch time: 525.7742 (ms) / GPU bubble ratio: 58.27%
[rank1]:2025-11-12 04:02:06,798 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0713  memory: 12.29GiB(25.88%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank0]:2025-11-12 04:02:06,798 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0713  memory: 14.93GiB(31.43%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank3]:2025-11-12 04:02:06,800 - INFO -  step: 500  loss:  0.2663  grad_norm:  0.0713  memory: 19.46GiB(40.96%)  tps: 7,889  tflops: 61.68  mfu: 19.77%
[rank2]:2025-11-12 04:02:06,798 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0713  memory:  8.37GiB(17.61%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank1]:2025-11-12 04:02:06,850 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0402_stage1_step500.svg
[rank1]:2025-11-12 04:02:06,891 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0402_stage5_step500.svg
[rank0]:2025-11-12 04:02:06,848 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0402_stage0_step500.svg
[rank0]:2025-11-12 04:02:06,888 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0402_stage4_step500.svg
[rank2]:2025-11-12 04:02:06,848 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0402_stage2_step500.svg
[rank2]:2025-11-12 04:02:06,888 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0402_stage6_step500.svg
[rank3]:2025-11-12 04:02:07,039 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0402_real_step500_rank3.svg
[rank3]:> Batch Time: 504.50 ms, GPU Bubble Ratio: 70.35%, 60.03%, 62.34%, 35.99%
[rank3]:2025-11-12 04:02:07,082 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0402_stage3_step500.svg
[rank3]:2025-11-12 04:02:07,122 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0402_stage7_step500.svg
[rank1]:2025-11-12 04:03:50,439 - INFO - Avg. fwd time: 5.4970 / Avg. bwd time: 8.1609 / Avg. batch time: 524.3667 (ms) / GPU bubble ratio: 58.33%
[rank3]:2025-11-12 04:03:50,388 - INFO - Avg. fwd time: 7.1323 / Avg. bwd time: 14.7086 / Avg. batch time: 475.0775 (ms) / GPU bubble ratio: 26.44%
[rank2]:2025-11-12 04:03:50,415 - INFO - Avg. fwd time: 4.2643 / Avg. bwd time: 7.8658 / Avg. batch time: 504.7817 (ms) / GPU bubble ratio: 61.55%
[rank0]:2025-11-12 04:03:50,457 - INFO - Avg. fwd time: 4.4878 / Avg. bwd time: 6.7104 / Avg. batch time: 536.8733 (ms) / GPU bubble ratio: 66.63%
[rank0]:2025-11-12 04:05:30,242 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-12 04:05:34,167 - INFO - Avg. fwd time: 4.4873 / Avg. bwd time: 6.6342 / Avg. batch time: 535.6983 (ms) / GPU bubble ratio: 66.78%
[rank3]:2025-11-12 04:05:34,190 - INFO - Avg. fwd time: 7.1403 / Avg. bwd time: 14.6429 / Avg. batch time: 474.2996 (ms) / GPU bubble ratio: 26.52%
[rank1]:2025-11-12 04:05:34,227 - INFO - Avg. fwd time: 5.5012 / Avg. bwd time: 8.1123 / Avg. batch time: 523.3645 (ms) / GPU bubble ratio: 58.38%
[rank2]:2025-11-12 04:05:34,216 - INFO - Avg. fwd time: 4.2689 / Avg. bwd time: 7.8506 / Avg. batch time: 503.9061 (ms) / GPU bubble ratio: 61.52%
[rank2]:2025-11-12 04:05:34,400 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0677  memory:  8.37GiB(17.61%)  tps: 7,892  tflops: 61.70  mfu: 19.77%
[rank1]:2025-11-12 04:05:34,400 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0677  memory: 12.29GiB(25.88%)  tps: 7,892  tflops: 61.70  mfu: 19.77%
[rank0]:2025-11-12 04:05:34,400 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0677  memory: 14.93GiB(31.43%)  tps: 7,892  tflops: 61.70  mfu: 19.77%
[rank3]:2025-11-12 04:05:34,415 - INFO -  step: 550  loss:  0.2677  grad_norm:  0.0677  memory: 19.46GiB(40.96%)  tps: 7,892  tflops: 61.69  mfu: 19.77%
[rank0]:2025-11-12 04:07:16,981 - INFO - Avg. fwd time: 4.4867 / Avg. bwd time: 6.5524 / Avg. batch time: 534.1849 (ms) / GPU bubble ratio: 66.94%
[rank2]:2025-11-12 04:07:17,029 - INFO - Avg. fwd time: 4.2746 / Avg. bwd time: 7.8275 / Avg. batch time: 502.7106 (ms) / GPU bubble ratio: 61.48%
[rank3]:2025-11-12 04:07:17,004 - INFO - Avg. fwd time: 7.1494 / Avg. bwd time: 14.5595 / Avg. batch time: 473.2054 (ms) / GPU bubble ratio: 26.60%
[rank1]:2025-11-12 04:07:17,044 - INFO - Avg. fwd time: 5.5056 / Avg. bwd time: 8.0594 / Avg. batch time: 522.0336 (ms) / GPU bubble ratio: 58.42%
[rank0]:2025-11-12 04:08:57,140 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-12 04:09:01,370 - INFO - Avg. fwd time: 4.2789 / Avg. bwd time: 7.8117 / Avg. batch time: 501.9188 (ms) / GPU bubble ratio: 61.46%
[rank3]:2025-11-12 04:09:01,342 - INFO - Avg. fwd time: 7.1546 / Avg. bwd time: 14.5052 / Avg. batch time: 472.5101 (ms) / GPU bubble ratio: 26.66%
[rank0]:2025-11-12 04:09:01,415 - INFO - Avg. fwd time: 4.4861 / Avg. bwd time: 6.4776 / Avg. batch time: 533.1044 (ms) / GPU bubble ratio: 67.09%
[rank0]:2025-11-12 04:09:01,424 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0801  memory: 14.93GiB(31.43%)  tps: 7,914  tflops: 61.87  mfu: 19.83%
[rank1]:2025-11-12 04:09:01,396 - INFO - Avg. fwd time: 5.5091 / Avg. bwd time: 8.0107 / Avg. batch time: 521.1193 (ms) / GPU bubble ratio: 58.49%
[rank1]:2025-11-12 04:09:01,424 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0801  memory: 12.29GiB(25.88%)  tps: 7,914  tflops: 61.87  mfu: 19.83%
[rank2]:2025-11-12 04:09:01,424 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0801  memory:  8.37GiB(17.61%)  tps: 7,914  tflops: 61.87  mfu: 19.83%
[rank3]:2025-11-12 04:09:01,440 - INFO -  step: 600  loss:  0.2551  grad_norm:  0.0801  memory: 19.46GiB(40.96%)  tps: 7,914  tflops: 61.87  mfu: 19.83%
[rank0]:2025-11-12 04:09:01,492 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0409_stage0_step600.svg
[rank0]:2025-11-12 04:09:01,535 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0409_stage4_step600.svg
[rank1]:2025-11-12 04:09:01,491 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0409_stage1_step600.svg
[rank1]:2025-11-12 04:09:01,533 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0409_stage5_step600.svg
[rank2]:2025-11-12 04:09:01,492 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0409_stage2_step600.svg
[rank2]:2025-11-12 04:09:01,535 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0409_stage6_step600.svg
[rank3]:2025-11-12 04:09:01,678 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0409_real_step600_rank3.svg
[rank3]:> Batch Time: 509.00 ms, GPU Bubble Ratio: 70.74%, 60.64%, 62.76%, 35.16%
[rank3]:2025-11-12 04:09:01,722 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0409_stage3_step600.svg
[rank3]:2025-11-12 04:09:01,763 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0409_stage7_step600.svg
[rank3]:2025-11-12 04:10:45,427 - INFO - Avg. fwd time: 7.1591 / Avg. bwd time: 14.4624 / Avg. batch time: 471.9376 (ms) / GPU bubble ratio: 26.70%
[rank0]:2025-11-12 04:10:45,404 - INFO - Avg. fwd time: 4.4853 / Avg. bwd time: 6.4185 / Avg. batch time: 532.2634 (ms) / GPU bubble ratio: 67.22%
[rank1]:2025-11-12 04:10:45,466 - INFO - Avg. fwd time: 5.5119 / Avg. bwd time: 7.9722 / Avg. batch time: 520.4111 (ms) / GPU bubble ratio: 58.54%
[rank2]:2025-11-12 04:10:45,452 - INFO - Avg. fwd time: 4.2834 / Avg. bwd time: 7.7912 / Avg. batch time: 501.3101 (ms) / GPU bubble ratio: 61.46%
[rank0]:2025-11-12 04:12:24,244 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-12 04:12:28,178 - INFO - Avg. fwd time: 4.4849 / Avg. bwd time: 6.3550 / Avg. batch time: 531.0281 (ms) / GPU bubble ratio: 67.34%
[rank2]:2025-11-12 04:12:28,229 - INFO - Avg. fwd time: 4.2892 / Avg. bwd time: 7.7664 / Avg. batch time: 500.3226 (ms) / GPU bubble ratio: 61.45%
[rank3]:2025-11-12 04:12:28,202 - INFO - Avg. fwd time: 7.1674 / Avg. bwd time: 14.3913 / Avg. batch time: 471.0306 (ms) / GPU bubble ratio: 26.77%
[rank1]:2025-11-12 04:12:28,239 - INFO - Avg. fwd time: 5.5163 / Avg. bwd time: 7.9314 / Avg. batch time: 519.3188 (ms) / GPU bubble ratio: 58.57%
[rank0]:2025-11-12 04:12:28,410 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0581  memory: 14.93GiB(31.43%)  tps: 7,916  tflops: 61.88  mfu: 19.83%
[rank1]:2025-11-12 04:12:28,410 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0581  memory: 12.29GiB(25.88%)  tps: 7,916  tflops: 61.88  mfu: 19.83%
[rank2]:2025-11-12 04:12:28,410 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0581  memory:  8.37GiB(17.61%)  tps: 7,916  tflops: 61.88  mfu: 19.83%
[rank3]:2025-11-12 04:12:28,426 - INFO -  step: 650  loss:  0.2619  grad_norm:  0.0581  memory: 19.46GiB(40.96%)  tps: 7,916  tflops: 61.88  mfu: 19.83%
[rank3]:2025-11-12 04:14:12,364 - INFO - Avg. fwd time: 7.1731 / Avg. bwd time: 14.3449 / Avg. batch time: 470.4614 (ms) / GPU bubble ratio: 26.82%
[rank2]:2025-11-12 04:14:12,393 - INFO - Avg. fwd time: 4.2937 / Avg. bwd time: 7.7478 / Avg. batch time: 499.6781 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-11-12 04:14:12,421 - INFO - Avg. fwd time: 5.5198 / Avg. bwd time: 7.8938 / Avg. batch time: 518.5791 (ms) / GPU bubble ratio: 58.61%
[rank0]:2025-11-12 04:14:12,441 - INFO - Avg. fwd time: 4.4845 / Avg. bwd time: 6.2966 / Avg. batch time: 530.1590 (ms) / GPU bubble ratio: 67.46%
[rank0]:2025-11-12 04:15:51,979 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-12 04:15:55,931 - INFO - Avg. fwd time: 7.1792 / Avg. bwd time: 14.3032 / Avg. batch time: 469.9426 (ms) / GPU bubble ratio: 26.86%
[rank0]:2025-11-12 04:15:55,904 - INFO - Avg. fwd time: 4.4842 / Avg. bwd time: 6.2499 / Avg. batch time: 529.4000 (ms) / GPU bubble ratio: 67.56%
[rank1]:2025-11-12 04:15:55,969 - INFO - Avg. fwd time: 5.5225 / Avg. bwd time: 7.8641 / Avg. batch time: 517.9243 (ms) / GPU bubble ratio: 58.65%
[rank2]:2025-11-12 04:15:55,959 - INFO - Avg. fwd time: 4.2973 / Avg. bwd time: 7.7344 / Avg. batch time: 499.0990 (ms) / GPU bubble ratio: 61.43%
[rank2]:2025-11-12 04:15:56,138 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0688  memory:  8.37GiB(17.61%)  tps: 7,887  tflops: 61.66  mfu: 19.76%
[rank0]:2025-11-12 04:15:56,138 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0688  memory: 14.93GiB(31.43%)  tps: 7,887  tflops: 61.66  mfu: 19.76%
[rank1]:2025-11-12 04:15:56,139 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0688  memory: 12.29GiB(25.88%)  tps: 7,887  tflops: 61.66  mfu: 19.76%
[rank3]:2025-11-12 04:15:56,155 - INFO -  step: 700  loss:  0.2276  grad_norm:  0.0688  memory: 19.46GiB(40.96%)  tps: 7,887  tflops: 61.66  mfu: 19.76%
[rank2]:2025-11-12 04:15:56,208 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0415_stage2_step700.svg
[rank2]:2025-11-12 04:15:56,251 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0415_stage6_step700.svg
[rank0]:2025-11-12 04:15:56,208 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0415_stage0_step700.svg
[rank0]:2025-11-12 04:15:56,251 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0415_stage4_step700.svg
[rank1]:2025-11-12 04:15:56,209 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0415_stage1_step700.svg
[rank1]:2025-11-12 04:15:56,252 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0415_stage5_step700.svg
[rank3]:2025-11-12 04:15:56,390 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0415_real_step700_rank3.svg
[rank3]:> Batch Time: 514.50 ms, GPU Bubble Ratio: 70.98%, 60.88%, 63.75%, 34.87%
[rank3]:2025-11-12 04:15:56,435 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0415_stage3_step700.svg
[rank3]:2025-11-12 04:15:56,477 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0415_stage7_step700.svg
[rank3]:2025-11-12 04:17:39,936 - INFO - Avg. fwd time: 7.1856 / Avg. bwd time: 14.2579 / Avg. batch time: 469.3852 (ms) / GPU bubble ratio: 26.91%
[rank2]:2025-11-12 04:17:39,963 - INFO - Avg. fwd time: 4.3011 / Avg. bwd time: 7.7200 / Avg. batch time: 498.5095 (ms) / GPU bubble ratio: 61.42%
[rank0]:2025-11-12 04:17:39,914 - INFO - Avg. fwd time: 4.4839 / Avg. bwd time: 6.1992 / Avg. batch time: 528.6148 (ms) / GPU bubble ratio: 67.66%
[rank1]:2025-11-12 04:17:39,976 - INFO - Avg. fwd time: 5.5254 / Avg. bwd time: 7.8316 / Avg. batch time: 517.2507 (ms) / GPU bubble ratio: 58.68%
[rank0]:2025-11-12 04:19:19,731 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-12 04:19:23,831 - INFO - Avg. fwd time: 7.1908 / Avg. bwd time: 14.2164 / Avg. batch time: 468.8555 (ms) / GPU bubble ratio: 26.95%
[rank2]:2025-11-12 04:19:23,863 - INFO - Avg. fwd time: 4.3049 / Avg. bwd time: 7.7023 / Avg. batch time: 497.9181 (ms) / GPU bubble ratio: 61.42%
[rank0]:2025-11-12 04:19:23,915 - INFO - Avg. fwd time: 4.4838 / Avg. bwd time: 6.1520 / Avg. batch time: 527.8460 (ms) / GPU bubble ratio: 67.76%
[rank0]:2025-11-12 04:19:23,925 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0803  memory: 14.93GiB(31.43%)  tps: 7,885  tflops: 61.64  mfu: 19.76%
[rank1]:2025-11-12 04:19:23,892 - INFO - Avg. fwd time: 5.5285 / Avg. bwd time: 7.8011 / Avg. batch time: 516.5835 (ms) / GPU bubble ratio: 58.71%
[rank1]:2025-11-12 04:19:23,925 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0803  memory: 12.29GiB(25.88%)  tps: 7,885  tflops: 61.64  mfu: 19.76%
[rank3]:2025-11-12 04:19:23,928 - INFO -  step: 750  loss:  0.2771  grad_norm:  0.0803  memory: 19.46GiB(40.96%)  tps: 7,886  tflops: 61.65  mfu: 19.76%
[rank2]:2025-11-12 04:19:23,925 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0803  memory:  8.37GiB(17.61%)  tps: 7,885  tflops: 61.64  mfu: 19.76%
[rank0]:2025-11-12 04:21:07,527 - INFO - Avg. fwd time: 4.4836 / Avg. bwd time: 6.1139 / Avg. batch time: 527.2116 (ms) / GPU bubble ratio: 67.84%
[rank3]:2025-11-12 04:21:07,551 - INFO - Avg. fwd time: 7.1945 / Avg. bwd time: 14.1823 / Avg. batch time: 468.4179 (ms) / GPU bubble ratio: 26.98%
[rank2]:2025-11-12 04:21:07,576 - INFO - Avg. fwd time: 4.3071 / Avg. bwd time: 7.6945 / Avg. batch time: 497.4295 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-11-12 04:21:07,589 - INFO - Avg. fwd time: 5.5302 / Avg. bwd time: 7.7762 / Avg. batch time: 516.0318 (ms) / GPU bubble ratio: 58.74%
[rank0]:2025-11-12 04:22:47,616 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-12 04:22:51,620 - INFO - Avg. fwd time: 4.4836 / Avg. bwd time: 6.0725 / Avg. batch time: 526.5909 (ms) / GPU bubble ratio: 67.93%
[rank1]:2025-11-12 04:22:51,684 - INFO - Avg. fwd time: 5.5326 / Avg. bwd time: 7.7490 / Avg. batch time: 515.5001 (ms) / GPU bubble ratio: 58.78%
[rank3]:2025-11-12 04:22:51,646 - INFO - Avg. fwd time: 7.1979 / Avg. bwd time: 14.1487 / Avg. batch time: 468.0069 (ms) / GPU bubble ratio: 27.02%
[rank2]:2025-11-12 04:22:51,676 - INFO - Avg. fwd time: 4.3100 / Avg. bwd time: 7.6816 / Avg. batch time: 496.9656 (ms) / GPU bubble ratio: 61.39%
[rank0]:2025-11-12 04:22:51,855 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0744  memory: 14.93GiB(31.43%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank0]:2025-11-12 04:22:51,855 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0744  tps: 8,056  tflops: 62.97  mfu: 18.43%
[rank0]:2025-11-12 04:22:51,855 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-12 04:22:51,856 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-12 04:22:51,855 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0744  memory: 12.29GiB(25.88%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank1]:2025-11-12 04:22:51,855 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0744  tps: 8,055  tflops: 62.97  mfu: 18.43%
[rank1]:2025-11-12 04:22:51,855 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-12 04:22:51,856 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-12 04:22:51,870 - INFO -  step: 800  loss:  0.2746  grad_norm:  0.0744  memory: 19.46GiB(40.96%)  tps: 7,879  tflops: 61.60  mfu: 19.74%
[rank3]:2025-11-12 04:22:51,870 - INFO -  final step: 800  loss:  0.2746  grad_norm:  0.0744  tps: 8,062  tflops: 63.02  mfu: 18.57%
[rank3]:2025-11-12 04:22:51,871 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-12 04:22:51,872 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-12 04:22:51,855 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0744  memory:  8.37GiB(17.61%)  tps: 7,880  tflops: 61.60  mfu: 19.74%
[rank2]:2025-11-12 04:22:51,855 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0744  tps: 8,055  tflops: 62.97  mfu: 18.43%
[rank2]:2025-11-12 04:22:51,855 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-12 04:22:51,856 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-12 04:22:53,787 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-12 04:22:53,881 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0422_stage0_final800.svg
[rank1]:2025-11-12 04:22:53,873 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0422_stage1_final800.svg
[rank2]:2025-11-12 04:22:53,874 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0422_stage2_final800.svg
[rank2]:2025-11-12 04:22:53,990 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank2_stage2.svg
[rank2]:	> Counts Sum: 483120, Total Sum: 840960 (57.45%), Ratio(%) per element: [58.21, 56.33, 58.56, 56.84, 56.84, 57.87, 55.99, 58.21, 55.99, 58.73, 57.36, 57.7, 57.87, 56.16, 59.24, 57.87, 56.33, 57.87]
[rank2]:2025-11-12 04:22:54,040 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank2/251112_0422_stage6_final800.svg
[rank0]:2025-11-12 04:22:54,009 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank0_stage0.svg
[rank0]:	> Counts Sum: 609840, Total Sum: 887680 (68.70%), Ratio(%) per element: [60.44, 60.95, 60.27, 59.41, 61.98, 63.35, 62.67, 65.75, 66.09, 69.17, 69.17, 70.03, 71.4, 69.52, 75.17, 76.54, 77.22, 81.33, 84.76]
[rank0]:2025-11-12 04:22:54,060 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank0/251112_0422_stage4_final800.svg
[rank1]:2025-11-12 04:22:54,017 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank1_stage1.svg
[rank1]:	> Counts Sum: 660160, Total Sum: 1261440 (52.33%), Ratio(%) per element: [52.05, 52.56, 52.05, 51.88, 51.88, 52.91, 52.05, 52.56, 51.71, 52.73, 52.73, 52.56, 53.08, 52.39, 52.56, 52.91, 51.36, 51.88, 51.36, 53.25, 51.88, 51.88, 52.91, 51.88, 52.56, 52.22, 53.08]
[rank1]:2025-11-12 04:22:54,068 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank1/251112_0422_stage5_final800.svg
[rank3]:2025-11-12 04:22:54,066 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0422_real_final800_rank3.svg
[rank3]:> Batch Time: 509.25 ms, GPU Bubble Ratio: 70.67%, 60.45%, 62.95%, 35.31%
[rank0]:2025-11-12 04:22:54,172 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank0_stage4.svg
[rank0]:	> Counts Sum: 829440, Total Sum: 840960 (98.63%), Ratio(%) per element: [98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63, 98.63]
[rank0]:2025-11-12 04:22:54,172 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-12 04:22:54,178 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank1_stage5.svg
[rank1]:	> Counts Sum: 732080, Total Sum: 840960 (87.05%), Ratio(%) per element: [86.98, 86.81, 86.81, 87.15, 87.15, 86.98, 86.98, 87.15, 86.81, 86.98, 86.81, 86.98, 86.98, 87.32, 87.5, 86.98, 87.15, 87.32]
[rank1]:2025-11-12 04:22:54,179 - INFO - Destroying the purge thread.
[rank2]:2025-11-12 04:22:54,149 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank2_stage6.svg
[rank2]:	> Counts Sum: 802240, Total Sum: 840960 (95.40%), Ratio(%) per element: [96.57, 93.66, 95.2, 96.57, 95.37, 95.37, 96.57, 94.69, 95.37, 95.2, 95.37, 94.52, 95.71, 94.69, 95.71, 95.03, 96.06, 95.37]
[rank2]:2025-11-12 04:22:54,150 - INFO - Destroying the purge thread.
[rank3]:2025-11-12 04:22:54,318 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/pipeline_schedule/251112_0422_thry_final800_rank3.svg
[rank3]:> Batch Time: 309.07 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-12 04:22:54,367 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0422_stage3_final800.svg
[rank3]:2025-11-12 04:22:54,476 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank3_stage3.svg
[rank3]:	> Counts Sum: 207280, Total Sum: 840960 (24.65%), Ratio(%) per element: [23.97, 25.68, 25.51, 23.11, 23.45, 25.34, 24.82, 24.48, 23.97, 25.34, 23.8, 24.48, 25.68, 24.14, 26.71, 25.51, 22.77, 24.82]
[rank2]:2025-11-12 04:22:54,533 - INFO - Process group destroyed
[rank3]:2025-11-12 04:22:54,523 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/freeze_ratio_history/rank3/251112_0422_stage7_final800.svg
[rank3]:2025-11-12 04:22:54,608 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1/frozen_params_histogram/251112_0422_rank3_stage7.svg
[rank3]:	> Counts Sum: 128560, Total Sum: 513920 (25.02%), Ratio(%) per element: [25.0, 24.65, 24.82, 24.82, 25.51, 25.51, 25.0, 25.51, 24.31, 24.48, 25.51]
[rank3]:2025-11-12 04:22:54,609 - INFO - Destroying the purge thread.
[rank1]:2025-11-12 04:22:54,652 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.06474
[rank3]:wandb:               final/avg_loss 0.27464
[rank3]:wandb:             final/avg_mfu(%) 18.56708
[rank3]:wandb:             final/avg_tflops 63.0213
[rank3]:wandb:    final/avg_throughput(tps) 8061.52666
[rank3]:wandb:              final/grad_norm 0.0744
[rank3]:wandb:               final/max_loss 0.27464
[rank3]:wandb:                    grad_norm 0.0744
[rank3]:wandb: loss_metrics/global_avg_loss 0.27464
[rank3]:wandb: loss_metrics/global_max_loss 0.27464
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_Interleaved1F1B_fullrand7_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ik72hncn
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_Interleaved1F1B_fullrand7_42_dm1/20251112-0325/wandb/run-20251112_032515-ik72hncn/logs
[rank3]:2025-11-12 04:22:56,043 - INFO - Process group destroyed
[rank0]:2025-11-12 04:22:56,172 - INFO - Training completed
[rank0]:2025-11-12 04:22:56,173 - INFO - Destroying the purge thread.
[rank0]:2025-11-12 04:22:56,219 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'norm', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_Interleaved1F1B_fullrand7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
