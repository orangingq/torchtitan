
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 17:02:18 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_GPipe_timelyauto_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-28 17:02:25,033 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank3]:2025-12-28 17:02:25,047 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank2]:2025-12-28 17:02:25,167 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank0]:2025-12-28 17:02:25,256 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 17:02:25,258 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 17:02:25,262 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 17:02:25,263 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-28 17:02:25,322 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank3]:2025-12-28 17:02:25,274 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 17:02:25,276 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-28 17:02:25,380 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 17:02:25,383 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-28 17:02:25,487 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 17:02:25,490 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 17:02:25,660 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 17:02:28,406 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-28 17:02:28,558 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 17:02:28,599 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 17:02:28,600 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 17:02:28,628 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 17:02:28,628 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-28 17:02:28,602 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 17:02:28,628 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 17:02:28,720 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 17:02:28,646 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 17:02:28,646 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-28 17:02:28,820 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 17:02:28,821 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 17:02:28,821 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-28 17:02:28,753 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 17:02:28,781 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 17:02:28,781 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-28 17:02:28,842 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 17:02:28,843 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 17:02:28,843 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-28 17:02:28,967 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 17:02:28,967 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 17:02:28,968 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run tr0rsu74
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_GPipe_timelyauto_11_dm1/20251228-1702/wandb/run-20251228_170229-tr0rsu74
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_GPipe_timelyauto_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/tr0rsu74
[rank3]:2025-12-28 17:02:31,019 - WandB logging enabled
[rank3]:2025-12-28 17:02:31,020 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 17:02:31,058 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 17:02:31,084 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 17:02:31,085 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-28 17:02:31,314 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 17:02:31,313 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_GPipe_timelyauto_11_dm1
[rank0]:2025-12-28 17:02:31,313 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 17:02:31,314 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 17:02:31,314 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-28 17:02:31,296 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 17:02:31,296 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 17:02:31,297 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-28 17:02:31,314 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-28 17:02:31,316 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 17:02:33,729 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 17:02:33,729 - Finished loading the checkpoint in 2.42 seconds.
[rank0]:2025-12-28 17:02:33,729 - Training starts at step 1
[rank3]:2025-12-28 17:02:39,242 -  step:  1  loss: 10.6088  grad_norm: 116.5375  memory: 24.19GiB(50.91%)  tps: 4,005  tflops: 31.31  mfu: 10.03%
[rank3]:2025-12-28 17:02:39,243 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 17:02:39,237 -  step:  1  loss: -8.0000  grad_norm: 116.5375  memory: 12.75GiB(26.83%)  tps: 3,126  tflops: 24.44  mfu: 7.83%
[rank1]:2025-12-28 17:02:39,237 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 17:02:39,235 -  step:  1  loss: -8.0000  grad_norm: 116.5375  memory: 10.24GiB(21.56%)  tps: 3,090  tflops: 24.15  mfu: 7.74%
[rank2]:2025-12-28 17:02:39,235 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 17:02:39,273 -  step:  1  loss: -8.0000  grad_norm: 116.5375  memory: 13.25GiB(27.89%)  tps: 3,070  tflops: 24.00  mfu: 7.69%
[rank0]:2025-12-28 17:02:39,273 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 17:04:38,420 - Avg. fwd time: 10.7961 / Avg. bwd time: 43.3995 / Avg. batch time: 493.2842 (ms) / GPU bubble ratio: 12.11%
[rank0]:2025-12-28 17:04:38,505 - Avg. fwd time: 8.2256 / Avg. bwd time: 25.1391 / Avg. batch time: 604.9782 (ms) / GPU bubble ratio: 55.88%
[rank2]:2025-12-28 17:04:38,445 - Avg. fwd time: 6.9881 / Avg. bwd time: 19.3059 / Avg. batch time: 525.4405 (ms) / GPU bubble ratio: 59.97%
[rank1]:2025-12-28 17:04:38,475 - Avg. fwd time: 9.0727 / Avg. bwd time: 24.9636 / Avg. batch time: 565.9050 (ms) / GPU bubble ratio: 51.88%
[rank0]:2025-12-28 17:06:38,134 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 17:06:42,993 - Avg. fwd time: 10.8034 / Avg. bwd time: 43.5730 / Avg. batch time: 494.6493 (ms) / GPU bubble ratio: 12.06%
[rank2]:2025-12-28 17:06:43,018 - Avg. fwd time: 6.9847 / Avg. bwd time: 19.3455 / Avg. batch time: 526.4501 (ms) / GPU bubble ratio: 59.99%
[rank0]:2025-12-28 17:06:43,078 - Avg. fwd time: 8.2140 / Avg. bwd time: 25.1809 / Avg. batch time: 605.2202 (ms) / GPU bubble ratio: 55.86%
[rank1]:2025-12-28 17:06:43,048 - Avg. fwd time: 9.0767 / Avg. bwd time: 25.0254 / Avg. batch time: 566.5505 (ms) / GPU bubble ratio: 51.85%
[rank3]:2025-12-28 17:06:43,112 -  step: 50  loss:  9.9061  grad_norm: 12.5043  memory: 26.98GiB(56.79%)  tps: 6,584  tflops: 51.47  mfu: 16.50%
[rank2]:2025-12-28 17:06:43,100 -  step: 50  loss: -8.0000  grad_norm: 12.5043  memory: 12.26GiB(25.80%)  tps: 6,584  tflops: 51.47  mfu: 16.50%
[rank0]:2025-12-28 17:06:43,114 -  step: 50  loss: -8.0000  grad_norm: 12.5043  memory: 17.08GiB(35.95%)  tps: 6,585  tflops: 51.48  mfu: 16.50%
[rank1]:2025-12-28 17:06:43,103 -  step: 50  loss: -8.0000  grad_norm: 12.5043  memory: 15.15GiB(31.89%)  tps: 6,584  tflops: 51.47  mfu: 16.50%
[rank3]:2025-12-28 17:07:27,680 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-28 17:08:17,487 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-28 17:08:17,799 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-28 17:08:36,437 - Avg. fwd time: 6.9789 / Avg. bwd time: 18.4814 / Avg. batch time: 511.7321 (ms) / GPU bubble ratio: 60.20%
[rank3]:2025-12-28 17:08:36,423 - Avg. fwd time: 10.8032 / Avg. bwd time: 41.8623 / Avg. batch time: 480.9394 (ms) / GPU bubble ratio: 12.40%
[rank0]:2025-12-28 17:08:36,458 - Avg. fwd time: 8.2169 / Avg. bwd time: 23.1848 / Avg. batch time: 587.0643 (ms) / GPU bubble ratio: 57.21%
[rank1]:2025-12-28 17:08:36,453 - Avg. fwd time: 9.0755 / Avg. bwd time: 23.9048 / Avg. batch time: 550.5529 (ms) / GPU bubble ratio: 52.08%
[rank3]:2025-12-28 17:08:48,674 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-28 17:08:49,012 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1708_max_batch_time.svg
[rank3]:			> Batch Time: 536.88 ms, GPU Bubble Ratio: 49.81%, 48.90%, 60.51%, 18.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  201-25-226ms   | [S0,MB1,B]  244-25-269ms   | [S0,MB2,B]  287-25-313ms   | [S0,MB3,B]  331-25-357ms   | [S0,MB4,B]  376-25-402ms   | [S0,MB5,B]  421-25-446ms   | [S0,MB6,B]  466-25-491ms   | [S0,MB7,B]  511-25-536ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-64ms      | [S1,MB6,F]  64-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  176-24-201ms   | [S1,MB1,B]  218-25-244ms   | [S1,MB2,B]  262-25-287ms   | [S1,MB3,B]  306-25-331ms   | [S1,MB4,B]  351-25-376ms   | [S1,MB5,B]  396-25-421ms   | [S1,MB6,B]  441-25-466ms   | [S1,MB7,B]  486-25-511ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-53ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  64-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  156-19-176ms   | [S2,MB1,B]  199-19-218ms   | [S2,MB2,B]  242-19-262ms   | [S2,MB3,B]  287-19-306ms   | [S2,MB4,B]  331-19-351ms   | [S2,MB5,B]  376-19-396ms   | [S2,MB6,B]  421-19-441ms   | [S2,MB7,B]  466-19-486ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-156ms   AFR(10):0.9655 | [S3,MB1,B]  156-42-199ms   AFR(10):0.9655 | [S3,MB2,B]  199-43-242ms   AFR(10):0.9655 | [S3,MB3,B]  242-44-287ms   AFR(10):0.9655 | [S3,MB4,B]  287-44-331ms   AFR(10):0.9655 | [S3,MB5,B]  331-44-376ms   AFR(10):0.9655 | [S3,MB6,B]  376-45-421ms   AFR(10):0.9655 | [S3,MB7,B]  421-45-466ms   AFR(10):0.9655
[rank3]:2025-12-28 17:08:49,140 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1708_min_batch_time.svg
[rank3]:			> Batch Time: 307.54 ms, GPU Bubble Ratio: 78.47%, 48.52%, 60.27%, 15.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  156-0-156ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB2,B]  198-0-198ms    | [S0,MB3,B]  221-0-221ms    | [S0,MB4,B]  242-0-242ms    | [S0,MB5,B]  264-0-264ms    | [S0,MB6,B]  285-0-285ms    | [S0,MB7,B]  307-0-307ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-64ms      | [S1,MB6,F]  64-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  145-10-156ms   | [S1,MB1,B]  166-10-177ms   | [S1,MB2,B]  188-10-198ms   | [S1,MB3,B]  210-10-221ms   | [S1,MB4,B]  231-10-242ms   | [S1,MB5,B]  253-10-264ms   | [S1,MB6,B]  275-10-285ms   | [S1,MB7,B]  296-10-307ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-53ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  64-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  137-8-145ms    | [S2,MB1,B]  158-8-166ms    | [S2,MB2,B]  179-8-188ms    | [S2,MB3,B]  201-8-210ms    | [S2,MB4,B]  223-8-231ms    | [S2,MB5,B]  245-8-253ms    | [S2,MB6,B]  266-8-275ms    | [S2,MB7,B]  288-8-296ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-21-137ms   AFR(10):0.9655 | [S3,MB1,B]  137-21-158ms   AFR(10):0.9655 | [S3,MB2,B]  158-21-179ms   AFR(10):0.9655 | [S3,MB3,B]  179-22-201ms   AFR(10):0.9655 | [S3,MB4,B]  201-21-223ms   AFR(10):0.9655 | [S3,MB5,B]  223-21-245ms   AFR(10):0.9655 | [S3,MB6,B]  245-21-266ms   AFR(10):0.9655 | [S3,MB7,B]  266-21-288ms   AFR(10):0.9655
[rank3]:2025-12-28 17:08:49,275 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1708_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 340.18 ms, GPU Bubble Ratio: 41.22%, 33.14%, 41.14%, 14.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  201-25-226ms   | [S0,MB1,B]  231-25-257ms   | [S0,MB2,B]  257-25-282ms   | [S0,MB3,B]  282-25-308ms   | [S0,MB4,B]  308-10-318ms   | [S0,MB5,B]  318-21-340ms   | [S0,MB6,B]  340-0-340ms    | [S0,MB7,B]  340-0-340ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-64ms      | [S1,MB6,F]  64-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  176-24-201ms   | [S1,MB1,B]  210-21-231ms   | [S1,MB2,B]  231-25-257ms   | [S1,MB3,B]  257-25-282ms   | [S1,MB4,B]  282-15-297ms   | [S1,MB5,B]  297-21-318ms   | [S1,MB6,B]  318-10-329ms   | [S1,MB7,B]  329-10-340ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-53ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  64-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  156-19-176ms   | [S2,MB1,B]  191-19-210ms   | [S2,MB2,B]  212-19-231ms   | [S2,MB3,B]  234-19-254ms   | [S2,MB4,B]  256-19-275ms   | [S2,MB5,B]  277-19-297ms   | [S2,MB6,B]  299-19-318ms   | [S2,MB7,B]  321-8-329ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-156ms   AFR(10):0.9655 | [S3,MB1,B]  156-34-191ms   AFR(10):0.9655 | [S3,MB2,B]  191-21-212ms   AFR(10):0.9655 | [S3,MB3,B]  212-22-234ms   AFR(10):0.9655 | [S3,MB4,B]  234-21-256ms   AFR(10):0.9655 | [S3,MB5,B]  256-21-277ms   AFR(10):0.9655 | [S3,MB6,B]  277-21-299ms   AFR(10):0.9655 | [S3,MB7,B]  299-21-321ms   AFR(10):0.9655
[rank3]:2025-12-28 17:08:49,275 - 	> Batch Time: 340.18 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.37)
[rank3]:2025-12-28 17:10:14,331 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-12-28 17:10:14,303 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 17:10:14,334 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.19/0.58, [MB5] 0.05/0.16, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-12-28 17:10:14,321 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.08/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.24/0.71, [MB5] 0.09/0.26, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-12-28 17:10:14,317 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.03, [MB7] 0.33/1.00
[rank3]:2025-12-28 17:10:18,914 - Avg. fwd time: 10.7910 / Avg. bwd time: 39.4455 / Avg. batch time: 461.4873 (ms) / GPU bubble ratio: 12.91%
[rank1]:2025-12-28 17:10:18,963 - Avg. fwd time: 9.0770 / Avg. bwd time: 22.9320 / Avg. batch time: 531.6883 (ms) / GPU bubble ratio: 51.84%
[rank2]:2025-12-28 17:10:18,937 - Avg. fwd time: 6.9754 / Avg. bwd time: 18.1342 / Avg. batch time: 493.8295 (ms) / GPU bubble ratio: 59.32%
[rank3]:2025-12-28 17:10:19,025 -  step: 100  loss:  8.6131  grad_norm:  7.8951  memory: 26.98GiB(56.79%)  tps: 7,588  tflops: 59.32  mfu: 19.01%
[rank0]:2025-12-28 17:10:18,989 - Avg. fwd time: 8.2128 / Avg. bwd time: 21.6504 / Avg. batch time: 564.3058 (ms) / GPU bubble ratio: 57.66%
[rank0]:2025-12-28 17:10:19,025 -  step: 100  loss: -8.0000  grad_norm:  7.8951  memory: 17.08GiB(35.95%)  tps: 7,588  tflops: 59.32  mfu: 19.01%
[rank1]:2025-12-28 17:10:19,015 -  step: 100  loss: -8.0000  grad_norm:  7.8951  memory: 15.15GiB(31.89%)  tps: 7,588  tflops: 59.32  mfu: 19.01%
[rank2]:2025-12-28 17:10:19,011 -  step: 100  loss: -8.0000  grad_norm:  7.8951  memory: 12.26GiB(25.80%)  tps: 7,588  tflops: 59.32  mfu: 19.01%
[rank0]:2025-12-28 17:10:19,085 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1710_stage0_step100.svg
[rank1]:2025-12-28 17:10:19,086 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1710_stage1_step100.svg
[rank2]:2025-12-28 17:10:19,085 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1710_stage2_step100.svg
[rank3]:2025-12-28 17:10:19,163 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1710_step100_rank3.svg
[rank3]:			> Batch Time: 568.97 ms, GPU Bubble Ratio: 55.92%, 54.05%, 63.22%, 26.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  312-25-337ms   | [S0,MB2,B]  352-25-378ms   | [S0,MB3,B]  393-25-418ms   | [S0,MB4,B]  433-22-456ms   | [S0,MB5,B]  476-20-496ms   | [S0,MB6,B]  516-22-539ms   | [S0,MB7,B]  551-17-568ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-24-268ms   | [S1,MB1,B]  284-24-308ms   | [S1,MB2,B]  324-25-349ms   | [S1,MB3,B]  364-25-389ms   | [S1,MB4,B]  407-22-430ms   | [S1,MB5,B]  449-24-473ms   | [S1,MB6,B]  492-21-513ms   | [S1,MB7,B]  527-20-548ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  261-19-280ms   | [S2,MB2,B]  301-19-321ms   | [S2,MB3,B]  341-19-361ms   | [S2,MB4,B]  384-19-404ms   | [S2,MB5,B]  426-19-445ms   | [S2,MB6,B]  469-19-488ms   | [S2,MB7,B]  507-16-524ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-40-254ms   | [S3,MB2,B]  254-41-295ms   | [S3,MB3,B]  294-40-335ms   | [S3,MB4,B]  334-43-377ms   | [S3,MB5,B]  377-41-419ms   | [S3,MB6,B]  419-42-462ms   | [S3,MB7,B]  462-41-503ms  
[rank3]:2025-12-28 17:10:19,205 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1710_stage3_step100.svg
[rank0]:2025-12-28 17:10:19,253 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1710_rank0_stage0.svg
[rank0]:	> Counts Sum: 34000, Total Sum: 71040 (47.86%), Ratio(%) per element: [54.16, 45.83, 45.83, 41.66, 45.83, 41.66, 45.83, 45.83, 50.0, 45.83, 50.0, 45.83, 50.0, 41.66, 50.0, 45.83, 50.0, 50.0, 50.0, 45.83, 50.0, 50.0, 50.0, 54.16, 45.83, 50.0, 50.0, 50.0, 45.83, 45.83, 45.83, 41.66, 54.16, 41.66, 50.0, 50.0, 54.16]
[rank1]:2025-12-28 17:10:19,231 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1710_rank1_stage1.svg
[rank1]:	> Counts Sum: 43440, Total Sum: 86400 (50.28%), Ratio(%) per element: [45.83, 41.66, 50.0, 54.16, 45.83, 50.0, 54.16, 45.83, 45.83, 54.16, 45.83, 45.83, 58.33, 45.83, 58.33, 45.83, 54.16, 50.0, 50.0, 54.16, 50.0, 54.16, 50.0, 54.16, 54.16, 50.0, 50.0, 45.83, 50.0, 54.16, 50.0, 50.0, 41.66, 54.16, 58.33, 50.0, 50.0, 45.83, 50.0, 50.0, 54.16, 50.0, 45.83, 54.16, 50.0]
[rank2]:2025-12-28 17:10:19,236 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1710_rank2_stage2.svg
[rank2]:	> Counts Sum: 26800, Total Sum: 69120 (38.77%), Ratio(%) per element: [41.66, 37.5, 37.5, 41.66, 37.5, 41.66, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 45.83, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5]
[rank3]:2025-12-28 17:10:19,342 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1710_rank3_stage3.svg
[rank3]:	> Counts Sum: 36880, Total Sum: 55680 (66.24%), Ratio(%) per element: [75.0, 62.5, 75.0, 70.83, 75.0, 75.0, 70.83, 62.5, 79.16, 70.83, 75.0, 79.16, 62.5, 70.83, 79.16, 70.83, 70.83, 79.16, 54.16, 54.16, 54.16, 54.16, 62.5, 54.16, 58.33, 50.0, 58.33, 58.33, 58.33]
[rank0]:2025-12-28 17:10:19,347 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1710_stage0.svg
[rank1]:2025-12-28 17:10:19,319 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1710_stage1.svg
[rank2]:2025-12-28 17:10:19,323 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1710_stage2.svg
[rank3]:2025-12-28 17:10:19,434 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1710_stage3.svg
[rank2]:2025-12-28 17:12:10,729 - Avg. fwd time: 6.9715 / Avg. bwd time: 18.3273 / Avg. batch time: 489.2233 (ms) / GPU bubble ratio: 58.63%
[rank3]:2025-12-28 17:12:10,708 - Avg. fwd time: 10.7832 / Avg. bwd time: 38.9786 / Avg. batch time: 457.6815 (ms) / GPU bubble ratio: 13.02%
[rank0]:2025-12-28 17:12:10,779 - Avg. fwd time: 8.2053 / Avg. bwd time: 22.0808 / Avg. batch time: 559.3575 (ms) / GPU bubble ratio: 56.68%
[rank1]:2025-12-28 17:12:10,754 - Avg. fwd time: 9.0771 / Avg. bwd time: 23.0110 / Avg. batch time: 526.6001 (ms) / GPU bubble ratio: 51.25%
[rank0]:2025-12-28 17:13:55,228 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 17:13:55,247 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-12-28 17:13:55,233 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.03, [MB7] 0.67/1.00
[rank1]:2025-12-28 17:13:55,238 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.17/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.47/0.71, [MB5] 0.18/0.26, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-28 17:13:55,249 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.39/0.58, [MB5] 0.11/0.16, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-28 17:13:59,243 - Avg. fwd time: 10.7824 / Avg. bwd time: 38.4102 / Avg. batch time: 453.1289 (ms) / GPU bubble ratio: 13.15%
[rank0]:2025-12-28 17:13:59,306 - Avg. fwd time: 8.2081 / Avg. bwd time: 22.2094 / Avg. batch time: 553.5865 (ms) / GPU bubble ratio: 56.04%
[rank0]:2025-12-28 17:13:59,343 -  step: 150  loss: -8.0000  grad_norm:  6.4164  memory: 17.08GiB(35.95%)  tps: 7,437  tflops: 58.14  mfu: 18.63%
[rank3]:2025-12-28 17:13:59,341 -  step: 150  loss:  3.7969  grad_norm:  6.4164  memory: 26.98GiB(56.79%)  tps: 7,437  tflops: 58.14  mfu: 18.63%
[rank2]:2025-12-28 17:13:59,262 - Avg. fwd time: 6.9694 / Avg. bwd time: 18.3944 / Avg. batch time: 483.7707 (ms) / GPU bubble ratio: 58.06%
[rank2]:2025-12-28 17:13:59,328 -  step: 150  loss: -8.0000  grad_norm:  6.4164  memory: 12.26GiB(25.80%)  tps: 7,437  tflops: 58.14  mfu: 18.63%
[rank1]:2025-12-28 17:13:59,290 - Avg. fwd time: 9.0757 / Avg. bwd time: 22.8391 / Avg. batch time: 520.9647 (ms) / GPU bubble ratio: 50.99%
[rank1]:2025-12-28 17:13:59,332 -  step: 150  loss: -8.0000  grad_norm:  6.4164  memory: 15.15GiB(31.89%)  tps: 7,437  tflops: 58.14  mfu: 18.63%
[rank3]:2025-12-28 17:15:41,272 - Avg. fwd time: 10.7838 / Avg. bwd time: 37.4530 / Avg. batch time: 445.4815 (ms) / GPU bubble ratio: 13.38%
[rank0]:2025-12-28 17:15:41,344 - Avg. fwd time: 8.2096 / Avg. bwd time: 22.0548 / Avg. batch time: 544.7124 (ms) / GPU bubble ratio: 55.55%
[rank1]:2025-12-28 17:15:41,328 - Avg. fwd time: 9.0768 / Avg. bwd time: 22.6337 / Avg. batch time: 513.1205 (ms) / GPU bubble ratio: 50.56%
[rank2]:2025-12-28 17:15:41,299 - Avg. fwd time: 6.9682 / Avg. bwd time: 18.4320 / Avg. batch time: 475.8920 (ms) / GPU bubble ratio: 57.30%
[rank2]:2025-12-28 17:17:15,104 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank0]:2025-12-28 17:17:15,090 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-28 17:17:15,109 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.25/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.71/0.71, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 17:17:15,117 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 17:17:15,120 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.58/0.58, [MB5] 0.16/0.16, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 17:17:18,875 - Avg. fwd time: 10.7785 / Avg. bwd time: 36.2282 / Avg. batch time: 435.6333 (ms) / GPU bubble ratio: 13.68%
[rank2]:2025-12-28 17:17:18,912 - Avg. fwd time: 6.9669 / Avg. bwd time: 18.4487 / Avg. batch time: 467.2610 (ms) / GPU bubble ratio: 56.49%
[rank2]:2025-12-28 17:17:18,965 -  step: 200  loss: -8.0000  grad_norm:  2.4040  memory: 12.26GiB(25.80%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank0]:2025-12-28 17:17:18,944 - Avg. fwd time: 8.2084 / Avg. bwd time: 21.7702 / Avg. batch time: 535.3196 (ms) / GPU bubble ratio: 55.20%
[rank0]:2025-12-28 17:17:18,980 -  step: 200  loss: -8.0000  grad_norm:  2.4040  memory: 17.08GiB(35.95%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank1]:2025-12-28 17:17:18,937 - Avg. fwd time: 9.0782 / Avg. bwd time: 22.4027 / Avg. batch time: 504.7865 (ms) / GPU bubble ratio: 50.11%
[rank1]:2025-12-28 17:17:18,969 -  step: 200  loss: -8.0000  grad_norm:  2.4040  memory: 15.15GiB(31.89%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank3]:2025-12-28 17:17:18,978 -  step: 200  loss:  1.2436  grad_norm:  2.4040  memory: 26.98GiB(56.79%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank2]:2025-12-28 17:17:19,029 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1717_stage2_step200.svg
[rank0]:2025-12-28 17:17:19,029 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1717_stage0_step200.svg
[rank1]:2025-12-28 17:17:19,028 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1717_stage1_step200.svg
[rank3]:2025-12-28 17:17:19,116 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1717_step200_rank3.svg
[rank3]:			> Batch Time: 460.91 ms, GPU Bubble Ratio: 53.24%, 48.84%, 55.78%, 35.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  301-25-326ms   | [S0,MB2,B]  330-25-355ms   | [S0,MB3,B]  360-25-385ms   | [S0,MB4,B]  387-13-400ms   | [S0,MB5,B]  414-23-437ms   | [S0,MB6,B]  439-3-443ms    | [S0,MB7,B]  455-5-460ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  274-22-297ms   | [S1,MB2,B]  301-25-326ms   | [S1,MB3,B]  330-26-356ms   | [S1,MB4,B]  359-15-375ms   | [S1,MB5,B]  387-23-410ms   | [S1,MB6,B]  413-11-425ms   | [S1,MB7,B]  439-12-451ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  251-19-271ms   | [S2,MB2,B]  276-19-296ms   | [S2,MB3,B]  301-20-321ms   | [S2,MB4,B]  329-20-350ms   | [S2,MB5,B]  359-20-379ms   | [S2,MB6,B]  387-19-406ms   | [S2,MB7,B]  413-9-422ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-30-245ms   | [S3,MB2,B]  244-23-268ms   | [S3,MB3,B]  267-23-290ms   | [S3,MB4,B]  290-23-314ms   | [S3,MB5,B]  314-23-337ms   | [S3,MB6,B]  337-24-361ms   | [S3,MB7,B]  361-22-384ms  
[rank2]:2025-12-28 17:17:19,176 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1717_rank2_stage2.svg
[rank2]:	> Counts Sum: 45680, Total Sum: 299520 (15.25%), Ratio(%) per element: [17.3, 17.3, 15.38, 16.34, 13.46, 18.26, 15.38, 19.23, 14.42, 14.42, 15.38, 16.34, 16.34, 14.42, 17.3, 17.3, 16.34, 16.34, 14.42, 17.3, 14.42, 18.26, 14.42, 13.46, 18.26, 14.42, 15.38, 10.57, 14.42, 13.46, 13.46, 12.5, 14.42, 14.42, 11.53, 12.5]
[rank0]:2025-12-28 17:17:19,183 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1717_rank0_stage0.svg
[rank0]:	> Counts Sum: 85360, Total Sum: 307840 (27.73%), Ratio(%) per element: [22.11, 31.73, 31.73, 33.65, 29.8, 27.88, 33.65, 34.61, 31.73, 32.69, 30.76, 32.69, 30.76, 31.73, 30.76, 27.88, 30.76, 25.96, 28.84, 23.07, 24.03, 21.15, 25.96, 26.92, 26.92, 25.0, 25.96, 24.03, 27.88, 24.03, 25.96, 22.11, 27.88, 23.07, 25.0, 21.15, 25.96]
[rank1]:2025-12-28 17:17:19,171 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1717_rank1_stage1.svg
[rank1]:	> Counts Sum: 117040, Total Sum: 374400 (31.26%), Ratio(%) per element: [43.26, 37.5, 36.53, 37.5, 41.34, 41.34, 40.38, 38.46, 40.38, 34.61, 36.53, 30.76, 32.69, 29.8, 32.69, 29.8, 35.57, 31.73, 31.73, 31.73, 28.84, 32.69, 30.76, 30.76, 35.57, 28.84, 29.8, 25.0, 25.96, 27.88, 27.88, 28.84, 20.19, 27.88, 29.8, 25.96, 24.03, 22.11, 27.88, 28.84, 29.8, 29.8, 24.03, 25.0, 24.03]
[rank3]:2025-12-28 17:17:19,161 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1717_stage3_step200.svg
[rank3]:2025-12-28 17:17:19,296 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1717_rank3_stage3.svg
[rank3]:	> Counts Sum: 130640, Total Sum: 241280 (54.14%), Ratio(%) per element: [62.5, 57.69, 58.65, 57.69, 58.65, 57.69, 59.61, 65.38, 61.53, 62.5, 64.42, 60.57, 51.92, 55.76, 61.53, 66.34, 54.8, 64.42, 42.3, 37.5, 42.3, 43.26, 46.15, 47.11, 47.11, 46.15, 47.11, 41.34, 48.07]
[rank2]:2025-12-28 17:17:19,510 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1717_stage2.svg
[rank1]:2025-12-28 17:17:19,505 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1717_stage1.svg
[rank0]:2025-12-28 17:17:19,531 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1717_stage0.svg
[rank3]:2025-12-28 17:17:19,649 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1717_stage3.svg
[rank2]:2025-12-28 17:18:54,807 - Avg. fwd time: 6.9652 / Avg. bwd time: 18.4578 / Avg. batch time: 460.5086 (ms) / GPU bubble ratio: 55.83%
[rank0]:2025-12-28 17:18:54,837 - Avg. fwd time: 8.2076 / Avg. bwd time: 21.3287 / Avg. batch time: 526.7813 (ms) / GPU bubble ratio: 55.14%
[rank1]:2025-12-28 17:18:54,831 - Avg. fwd time: 9.0803 / Avg. bwd time: 22.1563 / Avg. batch time: 498.1984 (ms) / GPU bubble ratio: 49.84%
[rank3]:2025-12-28 17:18:54,769 - Avg. fwd time: 10.7735 / Avg. bwd time: 35.1038 / Avg. batch time: 426.5925 (ms) / GPU bubble ratio: 13.97%
[rank1]:2025-12-28 17:20:27,030 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.25/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.71/0.71, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 17:20:27,025 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank0]:2025-12-28 17:20:27,021 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 17:20:27,041 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.58/0.58, [MB5] 0.16/0.16, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 17:20:27,038 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 17:20:30,841 - Avg. fwd time: 9.0807 / Avg. bwd time: 21.9733 / Avg. batch time: 493.2903 (ms) / GPU bubble ratio: 49.64%
[rank2]:2025-12-28 17:20:30,814 - Avg. fwd time: 6.9635 / Avg. bwd time: 18.4600 / Avg. batch time: 455.4521 (ms) / GPU bubble ratio: 55.34%
[rank0]:2025-12-28 17:20:30,847 - Avg. fwd time: 8.2042 / Avg. bwd time: 20.9760 / Avg. batch time: 520.3050 (ms) / GPU bubble ratio: 55.13%
[rank3]:2025-12-28 17:20:30,774 - Avg. fwd time: 10.7665 / Avg. bwd time: 34.2735 / Avg. batch time: 419.8896 (ms) / GPU bubble ratio: 14.19%
[rank1]:2025-12-28 17:20:30,873 -  step: 250  loss: -8.0000  grad_norm:  0.5597  memory: 15.15GiB(31.89%)  tps: 8,538  tflops: 66.74  mfu: 21.39%
[rank2]:2025-12-28 17:20:30,869 -  step: 250  loss: -8.0000  grad_norm:  0.5597  memory: 12.26GiB(25.80%)  tps: 8,538  tflops: 66.74  mfu: 21.39%
[rank0]:2025-12-28 17:20:30,884 -  step: 250  loss: -8.0000  grad_norm:  0.5597  memory: 17.08GiB(35.95%)  tps: 8,538  tflops: 66.74  mfu: 21.39%
[rank3]:2025-12-28 17:20:30,883 -  step: 250  loss:  0.4107  grad_norm:  0.5597  memory: 26.98GiB(56.79%)  tps: 8,538  tflops: 66.74  mfu: 21.39%
[rank2]:2025-12-28 17:22:06,482 - Avg. fwd time: 6.9618 / Avg. bwd time: 18.4670 / Avg. batch time: 451.2075 (ms) / GPU bubble ratio: 54.91%
[rank3]:2025-12-28 17:22:06,437 - Avg. fwd time: 10.7608 / Avg. bwd time: 33.5848 / Avg. batch time: 414.3312 (ms) / GPU bubble ratio: 14.38%
[rank1]:2025-12-28 17:22:06,502 - Avg. fwd time: 9.0824 / Avg. bwd time: 21.7985 / Avg. batch time: 489.0799 (ms) / GPU bubble ratio: 49.49%
[rank0]:2025-12-28 17:22:06,509 - Avg. fwd time: 8.2018 / Avg. bwd time: 20.6644 / Avg. batch time: 514.8138 (ms) / GPU bubble ratio: 55.14%
[rank1]:2025-12-28 17:23:37,753 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.25/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.71/0.71, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 17:23:37,748 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank3]:2025-12-28 17:23:37,760 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-28 17:23:37,734 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 17:23:37,764 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.58/0.58, [MB5] 0.16/0.16, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 17:23:41,503 - Avg. fwd time: 10.7544 / Avg. bwd time: 32.9556 / Avg. batch time: 409.2420 (ms) / GPU bubble ratio: 14.55%
[rank1]:2025-12-28 17:23:41,575 - Avg. fwd time: 9.0824 / Avg. bwd time: 21.6907 / Avg. batch time: 485.3363 (ms) / GPU bubble ratio: 49.28%
[rank2]:2025-12-28 17:23:41,549 - Avg. fwd time: 6.9603 / Avg. bwd time: 18.4695 / Avg. batch time: 447.4584 (ms) / GPU bubble ratio: 54.53%
[rank2]:2025-12-28 17:23:41,603 -  step: 300  loss: -8.0000  grad_norm:  0.1922  memory: 12.26GiB(25.80%)  tps: 8,590  tflops: 67.15  mfu: 21.52%
[rank0]:2025-12-28 17:23:41,582 - Avg. fwd time: 8.1996 / Avg. bwd time: 20.4234 / Avg. batch time: 510.0021 (ms) / GPU bubble ratio: 55.10%
[rank1]:2025-12-28 17:23:41,607 -  step: 300  loss: -8.0000  grad_norm:  0.1922  memory: 15.15GiB(31.89%)  tps: 8,590  tflops: 67.15  mfu: 21.52%
[rank1]:2025-12-28 17:23:41,665 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1723_stage1_step300.svg
[rank2]:2025-12-28 17:23:41,665 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1723_stage2_step300.svg
[rank3]:2025-12-28 17:23:41,616 -  step: 300  loss:  0.2856  grad_norm:  0.1922  memory: 26.98GiB(56.79%)  tps: 8,590  tflops: 67.15  mfu: 21.52%
[rank0]:2025-12-28 17:23:41,618 -  step: 300  loss: -8.0000  grad_norm:  0.1922  memory: 17.08GiB(35.95%)  tps: 8,590  tflops: 67.15  mfu: 21.52%
[rank0]:2025-12-28 17:23:41,665 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1723_stage0_step300.svg
[rank3]:2025-12-28 17:23:41,753 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1723_step300_rank3.svg
[rank3]:			> Batch Time: 453.00 ms, GPU Bubble Ratio: 53.67%, 48.09%, 55.04%, 36.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  301-25-326ms   | [S0,MB2,B]  330-25-355ms   | [S0,MB3,B]  360-25-386ms   | [S0,MB4,B]  387-18-406ms   | [S0,MB5,B]  413-23-436ms   | [S0,MB6,B]  438-0-438ms    | [S0,MB7,B]  453-0-453ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-25-268ms   | [S1,MB1,B]  273-23-297ms   | [S1,MB2,B]  301-25-326ms   | [S1,MB3,B]  330-26-356ms   | [S1,MB4,B]  360-15-376ms   | [S1,MB5,B]  387-22-410ms   | [S1,MB6,B]  413-11-424ms   | [S1,MB7,B]  437-11-449ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  250-19-269ms   | [S2,MB2,B]  275-20-295ms   | [S2,MB3,B]  300-20-320ms   | [S2,MB4,B]  329-20-349ms   | [S2,MB5,B]  361-20-382ms   | [S2,MB6,B]  387-19-407ms   | [S2,MB7,B]  413-9-422ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-28-242ms   | [S3,MB2,B]  243-21-265ms   | [S3,MB3,B]  265-21-287ms   | [S3,MB4,B]  287-22-310ms   | [S3,MB5,B]  310-22-332ms   | [S3,MB6,B]  332-21-354ms   | [S3,MB7,B]  355-22-377ms  
[rank3]:2025-12-28 17:23:41,798 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1723_stage3_step300.svg
[rank1]:2025-12-28 17:23:41,808 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1723_rank1_stage1.svg
[rank1]:	> Counts Sum: 233040, Total Sum: 662400 (35.18%), Ratio(%) per element: [45.65, 40.21, 39.67, 40.76, 43.47, 42.39, 40.76, 41.84, 45.1, 38.04, 37.5, 34.78, 36.41, 36.41, 35.32, 34.78, 38.04, 36.41, 36.41, 36.95, 32.6, 34.78, 35.32, 34.78, 36.95, 33.15, 33.69, 29.89, 33.69, 32.6, 31.52, 32.6, 26.08, 30.97, 30.97, 32.6, 29.34, 29.34, 30.97, 33.69, 34.23, 32.6, 29.34, 31.52, 28.8]
[rank2]:2025-12-28 17:23:41,812 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1723_rank2_stage2.svg
[rank2]:	> Counts Sum: 75280, Total Sum: 529920 (14.21%), Ratio(%) per element: [15.76, 15.21, 14.13, 15.21, 13.58, 15.76, 15.21, 16.3, 13.58, 13.58, 14.13, 14.67, 14.67, 14.13, 15.76, 15.21, 14.67, 14.67, 13.58, 15.76, 13.58, 16.3, 13.58, 13.04, 15.76, 13.58, 14.13, 11.41, 13.58, 13.04, 13.04, 12.5, 13.58, 13.58, 11.95, 13.04]
[rank0]:2025-12-28 17:23:41,819 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1723_rank0_stage0.svg
[rank0]:	> Counts Sum: 166160, Total Sum: 544640 (30.51%), Ratio(%) per element: [26.08, 33.15, 34.78, 35.32, 33.69, 31.52, 37.5, 35.32, 33.69, 34.78, 32.06, 33.69, 30.97, 32.6, 31.52, 30.43, 33.69, 28.26, 28.8, 28.26, 27.71, 26.63, 28.8, 28.8, 29.34, 28.8, 28.8, 28.26, 30.43, 28.8, 28.8, 28.26, 30.43, 27.17, 27.71, 26.63, 27.17]
[rank3]:2025-12-28 17:23:41,933 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1723_rank3_stage3.svg
[rank3]:	> Counts Sum: 279440, Total Sum: 426880 (65.46%), Ratio(%) per element: [71.73, 70.1, 69.56, 67.39, 69.56, 67.93, 69.02, 72.82, 71.73, 69.56, 72.82, 67.93, 65.21, 65.21, 69.02, 72.28, 64.67, 71.73, 57.06, 55.43, 58.15, 59.23, 59.23, 60.32, 61.95, 59.78, 59.78, 58.15, 60.86]
[rank1]:2025-12-28 17:23:42,394 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1723_stage1.svg
[rank2]:2025-12-28 17:23:42,405 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1723_stage2.svg
[rank0]:2025-12-28 17:23:42,429 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1723_stage0.svg
[rank3]:2025-12-28 17:23:42,544 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1723_stage3.svg
[rank3]:2025-12-28 17:25:17,633 - Avg. fwd time: 10.7486 / Avg. bwd time: 32.4408 / Avg. batch time: 405.0745 (ms) / GPU bubble ratio: 14.70%
[rank1]:2025-12-28 17:25:17,706 - Avg. fwd time: 9.0815 / Avg. bwd time: 21.5805 / Avg. batch time: 482.2984 (ms) / GPU bubble ratio: 49.14%
[rank2]:2025-12-28 17:25:17,680 - Avg. fwd time: 6.9586 / Avg. bwd time: 18.4721 / Avg. batch time: 444.3391 (ms) / GPU bubble ratio: 54.21%
[rank0]:2025-12-28 17:25:17,714 - Avg. fwd time: 8.1967 / Avg. bwd time: 20.2099 / Avg. batch time: 506.0609 (ms) / GPU bubble ratio: 55.09%
[rank0]:2025-12-28 17:26:49,201 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 17:26:52,946 - Avg. fwd time: 10.7457 / Avg. bwd time: 32.0050 / Avg. batch time: 401.5639 (ms) / GPU bubble ratio: 14.83%
[rank1]:2025-12-28 17:26:53,008 - Avg. fwd time: 9.0813 / Avg. bwd time: 21.4711 / Avg. batch time: 479.6629 (ms) / GPU bubble ratio: 49.04%
[rank1]:2025-12-28 17:26:53,041 -  step: 350  loss: -8.0000  grad_norm:  0.0980  memory: 15.15GiB(31.89%)  tps: 8,559  tflops: 66.91  mfu: 21.44%
[rank0]:2025-12-28 17:26:53,016 - Avg. fwd time: 8.1953 / Avg. bwd time: 20.0480 / Avg. batch time: 502.6505 (ms) / GPU bubble ratio: 55.05%
[rank0]:2025-12-28 17:26:53,052 -  step: 350  loss: -8.0000  grad_norm:  0.0980  memory: 17.08GiB(35.95%)  tps: 8,559  tflops: 66.91  mfu: 21.44%
[rank2]:2025-12-28 17:26:52,981 - Avg. fwd time: 6.9579 / Avg. bwd time: 18.4752 / Avg. batch time: 441.6065 (ms) / GPU bubble ratio: 53.93%
[rank2]:2025-12-28 17:26:53,037 -  step: 350  loss: -8.0000  grad_norm:  0.0980  memory: 12.26GiB(25.80%)  tps: 8,559  tflops: 66.91  mfu: 21.44%
[rank3]:2025-12-28 17:26:53,050 -  step: 350  loss:  0.2261  grad_norm:  0.0980  memory: 26.98GiB(56.79%)  tps: 8,559  tflops: 66.91  mfu: 21.44%
[rank3]:2025-12-28 17:28:28,085 - Avg. fwd time: 10.7423 / Avg. bwd time: 31.6189 / Avg. batch time: 398.4470 (ms) / GPU bubble ratio: 14.95%
[rank0]:2025-12-28 17:28:28,163 - Avg. fwd time: 8.1932 / Avg. bwd time: 19.9073 / Avg. batch time: 499.6273 (ms) / GPU bubble ratio: 55.01%
[rank2]:2025-12-28 17:28:28,129 - Avg. fwd time: 6.9567 / Avg. bwd time: 18.4751 / Avg. batch time: 439.1850 (ms) / GPU bubble ratio: 53.67%
[rank1]:2025-12-28 17:28:28,155 - Avg. fwd time: 9.0804 / Avg. bwd time: 21.3739 / Avg. batch time: 477.3110 (ms) / GPU bubble ratio: 48.96%
[rank0]:2025-12-28 17:29:59,332 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 17:30:03,091 - Avg. fwd time: 10.7411 / Avg. bwd time: 31.2868 / Avg. batch time: 395.7814 (ms) / GPU bubble ratio: 15.05%
[rank1]:2025-12-28 17:30:03,160 - Avg. fwd time: 9.0800 / Avg. bwd time: 21.2870 / Avg. batch time: 475.2300 (ms) / GPU bubble ratio: 48.88%
[rank1]:2025-12-28 17:30:03,194 -  step: 400  loss: -8.0000  grad_norm:  0.1101  memory: 15.15GiB(31.89%)  tps: 8,616  tflops: 67.36  mfu: 21.59%
[rank0]:2025-12-28 17:30:03,169 - Avg. fwd time: 8.1917 / Avg. bwd time: 19.7405 / Avg. batch time: 496.9584 (ms) / GPU bubble ratio: 55.03%
[rank0]:2025-12-28 17:30:03,205 -  step: 400  loss: -8.0000  grad_norm:  0.1101  memory: 17.08GiB(35.95%)  tps: 8,616  tflops: 67.36  mfu: 21.59%
[rank3]:2025-12-28 17:30:03,203 -  step: 400  loss:  0.2126  grad_norm:  0.1101  memory: 26.98GiB(56.79%)  tps: 8,616  tflops: 67.36  mfu: 21.59%
[rank2]:2025-12-28 17:30:03,134 - Avg. fwd time: 6.9559 / Avg. bwd time: 18.4768 / Avg. batch time: 437.0798 (ms) / GPU bubble ratio: 53.45%
[rank2]:2025-12-28 17:30:03,190 -  step: 400  loss: -8.0000  grad_norm:  0.1101  memory: 12.26GiB(25.80%)  tps: 8,616  tflops: 67.36  mfu: 21.59%
[rank1]:2025-12-28 17:30:03,256 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1730_stage1_step400.svg
[rank0]:2025-12-28 17:30:03,257 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1730_stage0_step400.svg
[rank2]:2025-12-28 17:30:03,256 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1730_stage2_step400.svg
[rank1]:2025-12-28 17:30:03,401 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1730_rank1_stage1.svg
[rank1]:	> Counts Sum: 349040, Total Sum: 950400 (36.73%), Ratio(%) per element: [43.56, 41.66, 40.53, 42.42, 43.93, 42.42, 41.28, 43.18, 44.69, 38.25, 39.77, 36.36, 37.87, 37.5, 38.25, 36.36, 39.39, 39.77, 38.63, 38.25, 35.6, 38.25, 37.87, 37.5, 39.39, 36.36, 35.22, 32.57, 35.22, 33.33, 32.19, 33.33, 29.16, 32.95, 32.57, 34.09, 32.57, 31.43, 31.43, 34.09, 35.22, 33.71, 31.06, 32.57, 30.68]
[rank3]:2025-12-28 17:30:03,343 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1730_step400_rank3.svg
[rank3]:			> Batch Time: 460.25 ms, GPU Bubble Ratio: 55.88%, 49.29%, 55.74%, 35.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  308-25-333ms   | [S0,MB2,B]  337-25-362ms   | [S0,MB3,B]  367-25-393ms   | [S0,MB4,B]  395-12-407ms   | [S0,MB5,B]  420-23-443ms   | [S0,MB6,B]  445-0-445ms    | [S0,MB7,B]  460-0-460ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  283-21-304ms   | [S1,MB2,B]  308-25-334ms   | [S1,MB3,B]  337-26-364ms   | [S1,MB4,B]  367-17-384ms   | [S1,MB5,B]  395-22-417ms   | [S1,MB6,B]  420-11-431ms   | [S1,MB7,B]  445-11-456ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  260-19-280ms   | [S2,MB2,B]  285-19-305ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  337-20-357ms   | [S2,MB5,B]  369-20-389ms   | [S2,MB6,B]  394-20-415ms   | [S2,MB7,B]  420-8-429ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-38-253ms   | [S3,MB2,B]  253-22-276ms   | [S3,MB3,B]  276-21-298ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-342ms   | [S3,MB6,B]  342-22-364ms   | [S3,MB7,B]  364-21-386ms  
[rank3]:2025-12-28 17:30:03,390 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1730_stage3_step400.svg
[rank2]:2025-12-28 17:30:03,405 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1730_rank2_stage2.svg
[rank2]:	> Counts Sum: 104880, Total Sum: 760320 (13.79%), Ratio(%) per element: [15.53, 14.77, 14.01, 14.39, 13.25, 15.15, 14.39, 15.15, 13.25, 13.63, 13.63, 14.39, 14.01, 13.63, 14.77, 14.77, 14.01, 14.01, 13.25, 14.77, 13.25, 15.15, 13.25, 12.87, 14.77, 13.25, 13.63, 11.74, 13.25, 12.87, 12.87, 12.87, 13.25, 13.63, 12.12, 12.87]
[rank0]:2025-12-28 17:30:03,411 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1730_rank0_stage0.svg
[rank0]:	> Counts Sum: 246960, Total Sum: 781440 (31.60%), Ratio(%) per element: [27.65, 32.95, 36.36, 36.36, 35.6, 33.33, 37.87, 35.22, 34.46, 35.98, 32.57, 32.95, 33.71, 34.46, 32.95, 32.19, 34.46, 29.92, 31.06, 29.54, 28.4, 28.03, 28.4, 29.54, 30.68, 29.54, 31.06, 29.54, 31.43, 28.03, 29.92, 30.3, 30.3, 28.4, 28.4, 28.4, 29.16]
[rank3]:2025-12-28 17:30:03,523 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1730_rank3_stage3.svg
[rank3]:	> Counts Sum: 428240, Total Sum: 612480 (69.92%), Ratio(%) per element: [76.13, 75.0, 74.62, 72.72, 74.62, 73.48, 73.48, 76.51, 76.13, 72.34, 74.24, 70.83, 69.31, 69.69, 70.83, 74.24, 68.56, 74.62, 63.25, 61.74, 64.77, 64.01, 65.15, 64.77, 66.28, 65.53, 64.77, 64.01, 65.9]
[rank0]:2025-12-28 17:30:04,276 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1730_stage0.svg
[rank1]:2025-12-28 17:30:04,235 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1730_stage1.svg
[rank2]:2025-12-28 17:30:04,241 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1730_stage2.svg
[rank3]:2025-12-28 17:30:04,382 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1730_stage3.svg
[rank3]:2025-12-28 17:30:26,032 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 17:30:26,264 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 17:30:26,267 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 17:30:26,251 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 17:31:39,620 - Avg. fwd time: 8.1900 / Avg. bwd time: 19.6375 / Avg. batch time: 494.7548 (ms) / GPU bubble ratio: 55.00%
[rank3]:2025-12-28 17:31:39,542 - Avg. fwd time: 10.7394 / Avg. bwd time: 31.0072 / Avg. batch time: 393.5314 (ms) / GPU bubble ratio: 15.13%
[rank1]:2025-12-28 17:31:39,611 - Avg. fwd time: 9.0793 / Avg. bwd time: 21.2098 / Avg. batch time: 473.5449 (ms) / GPU bubble ratio: 48.83%
[rank2]:2025-12-28 17:31:39,585 - Avg. fwd time: 6.9548 / Avg. bwd time: 18.4750 / Avg. batch time: 435.3615 (ms) / GPU bubble ratio: 53.27%
[rank0]:2025-12-28 17:33:10,805 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 17:33:14,534 - Avg. fwd time: 10.7364 / Avg. bwd time: 30.7536 / Avg. batch time: 391.4791 (ms) / GPU bubble ratio: 15.21%
[rank0]:2025-12-28 17:33:14,612 - Avg. fwd time: 8.1882 / Avg. bwd time: 19.5322 / Avg. batch time: 492.6747 (ms) / GPU bubble ratio: 54.99%
[rank1]:2025-12-28 17:33:14,603 - Avg. fwd time: 9.0776 / Avg. bwd time: 21.1259 / Avg. batch time: 471.9247 (ms) / GPU bubble ratio: 48.80%
[rank1]:2025-12-28 17:33:14,638 -  step: 450  loss: -8.0000  grad_norm:  0.1050  memory: 15.15GiB(31.89%)  tps: 8,558  tflops: 66.90  mfu: 21.44%
[rank2]:2025-12-28 17:33:14,578 - Avg. fwd time: 6.9537 / Avg. bwd time: 18.4743 / Avg. batch time: 433.7404 (ms) / GPU bubble ratio: 53.10%
[rank2]:2025-12-28 17:33:14,634 -  step: 450  loss: -8.0000  grad_norm:  0.1050  memory: 12.26GiB(25.80%)  tps: 8,558  tflops: 66.90  mfu: 21.44%
[rank3]:2025-12-28 17:33:14,647 -  step: 450  loss:  0.2240  grad_norm:  0.1050  memory: 26.98GiB(56.79%)  tps: 8,558  tflops: 66.90  mfu: 21.44%
[rank0]:2025-12-28 17:33:14,649 -  step: 450  loss: -8.0000  grad_norm:  0.1050  memory: 17.08GiB(35.95%)  tps: 8,558  tflops: 66.90  mfu: 21.44%
[rank3]:2025-12-28 17:34:48,812 - Avg. fwd time: 10.7333 / Avg. bwd time: 30.4790 / Avg. batch time: 389.2557 (ms) / GPU bubble ratio: 15.30%
[rank2]:2025-12-28 17:34:48,858 - Avg. fwd time: 6.9529 / Avg. bwd time: 18.4738 / Avg. batch time: 432.0581 (ms) / GPU bubble ratio: 52.92%
[rank0]:2025-12-28 17:34:48,896 - Avg. fwd time: 8.1868 / Avg. bwd time: 19.4342 / Avg. batch time: 490.5951 (ms) / GPU bubble ratio: 54.96%
[rank1]:2025-12-28 17:34:48,887 - Avg. fwd time: 9.0763 / Avg. bwd time: 21.0679 / Avg. batch time: 470.2567 (ms) / GPU bubble ratio: 48.72%
[rank0]:2025-12-28 17:36:20,227 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 17:36:23,953 - Avg. fwd time: 10.7310 / Avg. bwd time: 30.2661 / Avg. batch time: 387.5335 (ms) / GPU bubble ratio: 15.37%
[rank2]:2025-12-28 17:36:23,999 - Avg. fwd time: 6.9523 / Avg. bwd time: 18.4744 / Avg. batch time: 430.8038 (ms) / GPU bubble ratio: 52.78%
[rank3]:2025-12-28 17:36:24,069 -  step: 500  loss:  0.2164  grad_norm:  0.1043  memory: 26.98GiB(56.79%)  tps: 8,650  tflops: 67.62  mfu: 21.67%
[rank0]:2025-12-28 17:36:24,035 - Avg. fwd time: 8.1859 / Avg. bwd time: 19.3503 / Avg. batch time: 488.9358 (ms) / GPU bubble ratio: 54.95%
[rank0]:2025-12-28 17:36:24,071 -  step: 500  loss: -8.0000  grad_norm:  0.1043  memory: 17.08GiB(35.95%)  tps: 8,649  tflops: 67.62  mfu: 21.67%
[rank1]:2025-12-28 17:36:24,025 - Avg. fwd time: 9.0759 / Avg. bwd time: 21.0231 / Avg. batch time: 468.9676 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-12-28 17:36:24,060 -  step: 500  loss: -8.0000  grad_norm:  0.1043  memory: 15.15GiB(31.89%)  tps: 8,649  tflops: 67.62  mfu: 21.67%
[rank2]:2025-12-28 17:36:24,057 -  step: 500  loss: -8.0000  grad_norm:  0.1043  memory: 12.26GiB(25.80%)  tps: 8,649  tflops: 67.62  mfu: 21.67%
[rank2]:2025-12-28 17:36:24,119 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1736_stage2_step500.svg
[rank0]:2025-12-28 17:36:24,119 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1736_stage0_step500.svg
[rank1]:2025-12-28 17:36:24,120 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1736_stage1_step500.svg
[rank3]:2025-12-28 17:36:24,212 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1736_step500_rank3.svg
[rank3]:			> Batch Time: 457.50 ms, GPU Bubble Ratio: 54.90%, 48.41%, 55.45%, 35.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  308-25-333ms   | [S0,MB2,B]  337-25-362ms   | [S0,MB3,B]  367-25-392ms   | [S0,MB4,B]  394-18-413ms   | [S0,MB5,B]  421-20-441ms   | [S0,MB6,B]  443-0-443ms    | [S0,MB7,B]  457-0-457ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-24-269ms   | [S1,MB1,B]  282-22-304ms   | [S1,MB2,B]  308-25-333ms   | [S1,MB3,B]  336-26-362ms   | [S1,MB4,B]  366-17-384ms   | [S1,MB5,B]  394-23-417ms   | [S1,MB6,B]  421-11-432ms   | [S1,MB7,B]  442-11-454ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  259-19-279ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  336-20-356ms   | [S2,MB5,B]  367-20-387ms   | [S2,MB6,B]  393-20-414ms   | [S2,MB7,B]  421-8-430ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-38-253ms   | [S3,MB2,B]  253-22-275ms   | [S3,MB3,B]  275-21-297ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-342ms   | [S3,MB6,B]  342-22-364ms   | [S3,MB7,B]  364-21-386ms  
[rank3]:2025-12-28 17:36:24,257 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1736_stage3_step500.svg
[rank0]:2025-12-28 17:36:24,275 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1736_rank0_stage0.svg
[rank0]:	> Counts Sum: 327760, Total Sum: 1018240 (32.19%), Ratio(%) per element: [28.19, 34.3, 36.04, 36.33, 35.75, 34.59, 37.79, 34.88, 35.17, 36.62, 32.26, 33.13, 34.88, 35.75, 32.55, 33.13, 35.46, 30.52, 32.84, 29.94, 29.94, 29.65, 29.36, 30.23, 31.68, 31.1, 31.1, 30.52, 30.81, 29.36, 30.23, 30.52, 30.23, 28.48, 28.77, 29.36, 29.36]
[rank1]:2025-12-28 17:36:24,267 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1736_rank1_stage1.svg
[rank1]:	> Counts Sum: 465040, Total Sum: 1238400 (37.55%), Ratio(%) per element: [44.76, 44.18, 42.44, 43.89, 45.05, 44.47, 43.31, 44.18, 45.05, 38.66, 39.24, 38.66, 39.24, 38.66, 38.95, 38.66, 40.69, 40.11, 38.95, 39.82, 35.75, 38.66, 38.95, 36.91, 39.82, 36.04, 36.04, 33.43, 37.5, 34.01, 31.97, 32.55, 30.81, 33.43, 32.84, 34.3, 33.13, 31.97, 31.97, 34.3, 36.04, 33.43, 32.55, 33.43, 30.81]
[rank2]:2025-12-28 17:36:24,269 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1736_rank2_stage2.svg
[rank2]:	> Counts Sum: 134480, Total Sum: 990720 (13.57%), Ratio(%) per element: [14.82, 14.82, 14.24, 13.95, 13.08, 14.53, 14.24, 14.53, 13.08, 13.37, 13.66, 13.95, 13.66, 13.37, 14.24, 14.82, 13.66, 13.66, 13.08, 14.24, 13.08, 14.53, 13.08, 12.79, 14.24, 13.08, 13.37, 11.91, 13.08, 12.79, 13.08, 12.79, 13.08, 13.37, 12.2, 13.08]
[rank3]:2025-12-28 17:36:24,392 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1736_rank3_stage3.svg
[rank3]:	> Counts Sum: 577040, Total Sum: 798080 (72.30%), Ratio(%) per element: [77.61, 76.16, 75.58, 75.0, 76.45, 75.58, 75.58, 77.61, 77.61, 74.7, 76.45, 73.54, 72.67, 71.51, 73.25, 75.29, 71.8, 76.16, 66.56, 65.69, 67.73, 67.15, 68.02, 68.02, 68.31, 68.31, 68.02, 67.73, 68.6]
[rank0]:2025-12-28 17:36:25,400 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1736_stage0.svg
[rank1]:2025-12-28 17:36:25,363 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1736_stage1.svg
[rank2]:2025-12-28 17:36:25,360 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1736_stage2.svg
[rank3]:2025-12-28 17:36:25,515 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1736_stage3.svg
[rank3]:2025-12-28 17:37:59,896 - Avg. fwd time: 10.7285 / Avg. bwd time: 30.0586 / Avg. batch time: 385.8522 (ms) / GPU bubble ratio: 15.43%
[rank2]:2025-12-28 17:37:59,937 - Avg. fwd time: 6.9517 / Avg. bwd time: 18.4729 / Avg. batch time: 429.5036 (ms) / GPU bubble ratio: 52.64%
[rank1]:2025-12-28 17:37:59,962 - Avg. fwd time: 9.0749 / Avg. bwd time: 20.9702 / Avg. batch time: 467.6841 (ms) / GPU bubble ratio: 48.61%
[rank0]:2025-12-28 17:37:59,973 - Avg. fwd time: 8.1849 / Avg. bwd time: 19.2752 / Avg. batch time: 487.3185 (ms) / GPU bubble ratio: 54.92%
[rank0]:2025-12-28 17:39:30,552 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 17:39:34,282 - Avg. fwd time: 10.7267 / Avg. bwd time: 29.8697 / Avg. batch time: 384.3256 (ms) / GPU bubble ratio: 15.50%
[rank1]:2025-12-28 17:39:34,347 - Avg. fwd time: 9.0744 / Avg. bwd time: 20.9246 / Avg. batch time: 466.4554 (ms) / GPU bubble ratio: 48.55%
[rank2]:2025-12-28 17:39:34,322 - Avg. fwd time: 6.9513 / Avg. bwd time: 18.4714 / Avg. batch time: 428.3239 (ms) / GPU bubble ratio: 52.52%
[rank0]:2025-12-28 17:39:34,357 - Avg. fwd time: 8.1847 / Avg. bwd time: 19.2125 / Avg. batch time: 485.7856 (ms) / GPU bubble ratio: 54.88%
[rank3]:2025-12-28 17:39:34,392 -  step: 550  loss:  0.2233  grad_norm:  0.0892  memory: 26.98GiB(56.79%)  tps: 8,609  tflops: 67.30  mfu: 21.57%
[rank1]:2025-12-28 17:39:34,383 -  step: 550  loss: -8.0000  grad_norm:  0.0892  memory: 15.15GiB(31.89%)  tps: 8,609  tflops: 67.30  mfu: 21.57%
[rank2]:2025-12-28 17:39:34,379 -  step: 550  loss: -8.0000  grad_norm:  0.0892  memory: 12.26GiB(25.80%)  tps: 8,609  tflops: 67.30  mfu: 21.57%
[rank0]:2025-12-28 17:39:34,393 -  step: 550  loss: -8.0000  grad_norm:  0.0892  memory: 17.08GiB(35.95%)  tps: 8,609  tflops: 67.30  mfu: 21.57%
[rank3]:2025-12-28 17:41:09,180 - Avg. fwd time: 10.7258 / Avg. bwd time: 29.7032 / Avg. batch time: 382.9855 (ms) / GPU bubble ratio: 15.55%
[rank2]:2025-12-28 17:41:09,222 - Avg. fwd time: 6.9508 / Avg. bwd time: 18.4682 / Avg. batch time: 427.2659 (ms) / GPU bubble ratio: 52.41%
[rank0]:2025-12-28 17:41:09,259 - Avg. fwd time: 8.1839 / Avg. bwd time: 19.1594 / Avg. batch time: 484.4874 (ms) / GPU bubble ratio: 54.85%
[rank1]:2025-12-28 17:41:09,249 - Avg. fwd time: 9.0741 / Avg. bwd time: 20.8824 / Avg. batch time: 465.4336 (ms) / GPU bubble ratio: 48.51%
[rank0]:2025-12-28 17:42:40,127 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 17:42:43,835 - Avg. fwd time: 10.7243 / Avg. bwd time: 29.5320 / Avg. batch time: 381.6035 (ms) / GPU bubble ratio: 15.61%
[rank1]:2025-12-28 17:42:43,903 - Avg. fwd time: 9.0738 / Avg. bwd time: 20.8524 / Avg. batch time: 464.4585 (ms) / GPU bubble ratio: 48.45%
[rank2]:2025-12-28 17:42:43,876 - Avg. fwd time: 6.9505 / Avg. bwd time: 18.4666 / Avg. batch time: 426.2271 (ms) / GPU bubble ratio: 52.29%
[rank3]:2025-12-28 17:42:43,948 -  step: 600  loss:  0.2182  grad_norm:  0.1123  memory: 26.98GiB(56.79%)  tps: 8,643  tflops: 67.57  mfu: 21.66%
[rank0]:2025-12-28 17:42:43,914 - Avg. fwd time: 8.1832 / Avg. bwd time: 19.1023 / Avg. batch time: 483.2575 (ms) / GPU bubble ratio: 54.83%
[rank0]:2025-12-28 17:42:43,950 -  step: 600  loss: -8.0000  grad_norm:  0.1123  memory: 17.08GiB(35.95%)  tps: 8,643  tflops: 67.57  mfu: 21.66%
[rank0]:2025-12-28 17:42:43,999 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1742_stage0_step600.svg
[rank1]:2025-12-28 17:42:43,939 -  step: 600  loss: -8.0000  grad_norm:  0.1123  memory: 15.15GiB(31.89%)  tps: 8,643  tflops: 67.57  mfu: 21.66%
[rank1]:2025-12-28 17:42:43,998 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1742_stage1_step600.svg
[rank2]:2025-12-28 17:42:43,936 -  step: 600  loss: -8.0000  grad_norm:  0.1123  memory: 12.26GiB(25.80%)  tps: 8,643  tflops: 67.57  mfu: 21.66%
[rank2]:2025-12-28 17:42:43,999 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1742_stage2_step600.svg
[rank3]:2025-12-28 17:42:44,085 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1742_step600_rank3.svg
[rank3]:			> Batch Time: 451.00 ms, GPU Bubble Ratio: 53.07%, 48.40%, 54.87%, 36.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  299-25-324ms   | [S0,MB2,B]  327-25-353ms   | [S0,MB3,B]  357-25-383ms   | [S0,MB4,B]  384-19-404ms   | [S0,MB5,B]  410-24-434ms   | [S0,MB6,B]  436-0-436ms    | [S0,MB7,B]  451-0-451ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  272-21-294ms   | [S1,MB2,B]  298-25-324ms   | [S1,MB3,B]  327-26-353ms   | [S1,MB4,B]  357-16-374ms   | [S1,MB5,B]  384-22-407ms   | [S1,MB6,B]  410-11-422ms   | [S1,MB7,B]  436-11-447ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-59ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  248-19-268ms   | [S2,MB2,B]  274-19-294ms   | [S2,MB3,B]  299-20-319ms   | [S2,MB4,B]  327-20-347ms   | [S2,MB5,B]  359-20-379ms   | [S2,MB6,B]  384-19-404ms   | [S2,MB7,B]  410-8-419ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  49-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-167ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  213-28-242ms   | [S3,MB2,B]  242-21-264ms   | [S3,MB3,B]  264-21-286ms   | [S3,MB4,B]  285-22-307ms   | [S3,MB5,B]  307-22-330ms   | [S3,MB6,B]  330-21-351ms   | [S3,MB7,B]  351-21-373ms  
[rank3]:2025-12-28 17:42:44,129 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1742_stage3_step600.svg
[rank0]:2025-12-28 17:42:44,154 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1742_rank0_stage0.svg
[rank0]:	> Counts Sum: 408560, Total Sum: 1255040 (32.55%), Ratio(%) per element: [28.53, 34.43, 36.32, 36.79, 36.08, 34.66, 37.26, 34.66, 34.9, 35.84, 33.25, 33.49, 36.32, 35.61, 32.07, 33.96, 35.14, 31.6, 34.19, 31.36, 30.89, 30.42, 30.66, 31.6, 32.54, 31.36, 32.54, 30.89, 30.66, 29.95, 30.18, 30.18, 29.95, 28.53, 28.3, 29.71, 29.48]
[rank1]:2025-12-28 17:42:44,143 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1742_rank1_stage1.svg
[rank1]:	> Counts Sum: 581040, Total Sum: 1526400 (38.07%), Ratio(%) per element: [45.28, 44.57, 43.63, 45.75, 45.75, 44.81, 43.63, 44.1, 44.33, 38.67, 39.38, 38.91, 38.44, 38.91, 39.62, 37.73, 40.33, 40.56, 39.15, 39.15, 36.08, 39.15, 38.91, 36.79, 39.85, 36.08, 35.61, 34.9, 38.44, 35.84, 33.72, 34.43, 32.78, 33.72, 33.96, 34.66, 34.43, 32.78, 31.83, 34.9, 36.32, 34.66, 33.72, 34.43, 32.07]
[rank2]:2025-12-28 17:42:44,148 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1742_rank2_stage2.svg
[rank2]:	> Counts Sum: 164080, Total Sum: 1221120 (13.44%), Ratio(%) per element: [14.38, 14.85, 13.91, 13.67, 12.97, 14.15, 13.91, 14.15, 12.97, 13.2, 13.44, 13.67, 13.44, 13.44, 14.15, 14.38, 13.67, 13.67, 12.97, 13.91, 12.97, 14.15, 12.97, 12.73, 14.38, 12.97, 13.2, 12.02, 12.97, 12.73, 12.97, 12.73, 13.2, 13.2, 12.26, 13.2]
[rank3]:2025-12-28 17:42:44,262 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1742_rank3_stage3.svg
[rank3]:	> Counts Sum: 725840, Total Sum: 983680 (73.79%), Ratio(%) per element: [78.3, 77.12, 77.12, 76.88, 77.35, 76.88, 76.65, 79.0, 78.77, 75.7, 77.12, 74.52, 74.29, 72.4, 74.52, 75.7, 73.58, 76.41, 68.63, 68.39, 69.57, 69.57, 70.04, 70.04, 70.28, 70.75, 69.57, 69.81, 70.75]
[rank1]:2025-12-28 17:42:45,469 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1742_stage1.svg
[rank2]:2025-12-28 17:42:45,490 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1742_stage2.svg
[rank0]:2025-12-28 17:42:45,542 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1742_stage0.svg
[rank3]:2025-12-28 17:42:45,645 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1742_stage3.svg
[rank3]:2025-12-28 17:44:20,286 - Avg. fwd time: 10.7226 / Avg. bwd time: 29.3809 / Avg. batch time: 380.3819 (ms) / GPU bubble ratio: 15.66%
[rank2]:2025-12-28 17:44:20,322 - Avg. fwd time: 6.9503 / Avg. bwd time: 18.4642 / Avg. batch time: 425.3529 (ms) / GPU bubble ratio: 52.20%
[rank1]:2025-12-28 17:44:20,348 - Avg. fwd time: 9.0737 / Avg. bwd time: 20.8295 / Avg. batch time: 463.6180 (ms) / GPU bubble ratio: 48.40%
[rank0]:2025-12-28 17:44:20,359 - Avg. fwd time: 8.1823 / Avg. bwd time: 19.0308 / Avg. batch time: 482.1822 (ms) / GPU bubble ratio: 54.85%
[rank0]:2025-12-28 17:45:51,609 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 17:45:55,343 - Avg. fwd time: 10.7222 / Avg. bwd time: 29.2705 / Avg. batch time: 379.4957 (ms) / GPU bubble ratio: 15.69%
[rank1]:2025-12-28 17:45:55,413 - Avg. fwd time: 9.0738 / Avg. bwd time: 20.7944 / Avg. batch time: 462.8688 (ms) / GPU bubble ratio: 48.38%
[rank1]:2025-12-28 17:45:55,449 -  step: 650  loss: -8.0000  grad_norm:  0.0957  memory: 15.15GiB(31.89%)  tps: 8,555  tflops: 66.88  mfu: 21.44%
[rank2]:2025-12-28 17:45:55,385 - Avg. fwd time: 6.9501 / Avg. bwd time: 18.4623 / Avg. batch time: 424.6676 (ms) / GPU bubble ratio: 52.13%
[rank2]:2025-12-28 17:45:55,446 -  step: 650  loss: -8.0000  grad_norm:  0.0957  memory: 12.26GiB(25.80%)  tps: 8,555  tflops: 66.88  mfu: 21.44%
[rank0]:2025-12-28 17:45:55,424 - Avg. fwd time: 8.1818 / Avg. bwd time: 18.9680 / Avg. batch time: 481.2162 (ms) / GPU bubble ratio: 54.86%
[rank0]:2025-12-28 17:45:55,460 -  step: 650  loss: -8.0000  grad_norm:  0.0957  memory: 17.08GiB(35.95%)  tps: 8,555  tflops: 66.88  mfu: 21.44%
[rank3]:2025-12-28 17:45:55,459 -  step: 650  loss:  0.2292  grad_norm:  0.0957  memory: 26.98GiB(56.79%)  tps: 8,555  tflops: 66.88  mfu: 21.44%
[rank3]:2025-12-28 17:47:30,008 - Avg. fwd time: 10.7218 / Avg. bwd time: 29.1457 / Avg. batch time: 378.4946 (ms) / GPU bubble ratio: 15.73%
[rank2]:2025-12-28 17:47:30,054 - Avg. fwd time: 6.9498 / Avg. bwd time: 18.4605 / Avg. batch time: 423.8850 (ms) / GPU bubble ratio: 52.04%
[rank1]:2025-12-28 17:47:30,077 - Avg. fwd time: 9.0734 / Avg. bwd time: 20.7583 / Avg. batch time: 462.1033 (ms) / GPU bubble ratio: 48.35%
[rank0]:2025-12-28 17:47:30,089 - Avg. fwd time: 8.1813 / Avg. bwd time: 18.9157 / Avg. batch time: 480.2499 (ms) / GPU bubble ratio: 54.86%
[rank0]:2025-12-28 17:49:00,421 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 17:49:04,138 - Avg. fwd time: 10.7212 / Avg. bwd time: 29.0094 / Avg. batch time: 377.3991 (ms) / GPU bubble ratio: 15.78%
[rank2]:2025-12-28 17:49:04,174 - Avg. fwd time: 6.9496 / Avg. bwd time: 18.4610 / Avg. batch time: 423.0563 (ms) / GPU bubble ratio: 51.95%
[rank1]:2025-12-28 17:49:04,201 - Avg. fwd time: 9.0730 / Avg. bwd time: 20.7398 / Avg. batch time: 461.2978 (ms) / GPU bubble ratio: 48.30%
[rank3]:2025-12-28 17:49:04,247 -  step: 700  loss:  0.1896  grad_norm:  0.0802  memory: 26.98GiB(56.79%)  tps: 8,679  tflops: 67.85  mfu: 21.75%
[rank0]:2025-12-28 17:49:04,213 - Avg. fwd time: 8.1810 / Avg. bwd time: 18.8667 / Avg. batch time: 479.2589 (ms) / GPU bubble ratio: 54.85%
[rank0]:2025-12-28 17:49:04,248 -  step: 700  loss: -8.0000  grad_norm:  0.0802  memory: 17.08GiB(35.95%)  tps: 8,679  tflops: 67.84  mfu: 21.75%
[rank2]:2025-12-28 17:49:04,234 -  step: 700  loss: -8.0000  grad_norm:  0.0802  memory: 12.26GiB(25.80%)  tps: 8,679  tflops: 67.84  mfu: 21.75%
[rank2]:2025-12-28 17:49:04,298 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1749_stage2_step700.svg
[rank1]:2025-12-28 17:49:04,238 -  step: 700  loss: -8.0000  grad_norm:  0.0802  memory: 15.15GiB(31.89%)  tps: 8,678  tflops: 67.84  mfu: 21.75%
[rank1]:2025-12-28 17:49:04,299 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1749_stage1_step700.svg
[rank0]:2025-12-28 17:49:04,301 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1749_stage0_step700.svg
[rank3]:2025-12-28 17:49:04,390 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1749_step700_rank3.svg
[rank3]:			> Batch Time: 451.25 ms, GPU Bubble Ratio: 53.37%, 48.24%, 54.82%, 36.42%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  300-25-325ms   | [S0,MB2,B]  329-25-354ms   | [S0,MB3,B]  358-25-384ms   | [S0,MB4,B]  385-19-404ms   | [S0,MB5,B]  411-23-434ms   | [S0,MB6,B]  436-0-436ms    | [S0,MB7,B]  451-0-451ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  274-22-296ms   | [S1,MB2,B]  300-25-325ms   | [S1,MB3,B]  329-26-355ms   | [S1,MB4,B]  358-17-375ms   | [S1,MB5,B]  385-22-407ms   | [S1,MB6,B]  411-11-422ms   | [S1,MB7,B]  436-11-447ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-59ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  251-19-270ms   | [S2,MB2,B]  275-19-295ms   | [S2,MB3,B]  300-20-320ms   | [S2,MB4,B]  328-20-348ms   | [S2,MB5,B]  360-20-380ms   | [S2,MB6,B]  385-20-405ms   | [S2,MB7,B]  410-8-419ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-29-243ms   | [S3,MB2,B]  244-21-266ms   | [S3,MB3,B]  266-21-287ms   | [S3,MB4,B]  287-22-309ms   | [S3,MB5,B]  309-22-331ms   | [S3,MB6,B]  331-21-353ms   | [S3,MB7,B]  353-21-375ms  
[rank3]:2025-12-28 17:49:04,436 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1749_stage3_step700.svg
[rank0]:2025-12-28 17:49:04,458 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1749_rank0_stage0.svg
[rank0]:	> Counts Sum: 489360, Total Sum: 1491840 (32.80%), Ratio(%) per element: [29.56, 34.52, 36.5, 37.1, 36.7, 35.11, 37.1, 35.91, 35.31, 36.5, 33.13, 34.32, 35.51, 34.92, 32.73, 34.12, 35.31, 33.13, 34.92, 31.54, 31.34, 31.15, 30.75, 31.34, 32.93, 31.15, 32.14, 31.54, 30.35, 30.35, 29.96, 30.55, 29.96, 28.96, 28.37, 29.56, 29.16]
[rank2]:2025-12-28 17:49:04,445 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1749_rank2_stage2.svg
[rank2]:	> Counts Sum: 193680, Total Sum: 1451520 (13.34%), Ratio(%) per element: [14.08, 14.48, 13.69, 13.49, 13.29, 14.28, 13.69, 13.88, 13.09, 13.09, 13.29, 13.69, 13.29, 13.29, 14.08, 14.08, 13.49, 13.69, 12.89, 13.69, 13.09, 13.88, 12.89, 12.69, 14.08, 12.89, 13.29, 12.1, 12.89, 12.69, 12.89, 12.69, 13.09, 13.09, 12.3, 13.09]
[rank1]:2025-12-28 17:49:04,441 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1749_rank1_stage1.svg
[rank1]:	> Counts Sum: 697040, Total Sum: 1814400 (38.42%), Ratio(%) per element: [47.22, 45.83, 44.84, 47.22, 47.02, 46.62, 44.84, 45.63, 45.83, 39.28, 40.27, 38.69, 39.48, 39.48, 39.48, 38.09, 41.26, 40.07, 39.28, 38.88, 36.11, 38.49, 38.69, 36.3, 39.48, 36.3, 35.51, 34.92, 38.09, 35.51, 34.12, 34.72, 32.34, 33.53, 33.92, 34.72, 34.52, 32.73, 32.14, 34.92, 36.5, 34.52, 33.73, 35.11, 32.34]
[rank3]:2025-12-28 17:49:04,568 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1749_rank3_stage3.svg
[rank3]:	> Counts Sum: 874640, Total Sum: 1169280 (74.80%), Ratio(%) per element: [78.76, 78.17, 77.97, 78.17, 78.37, 77.97, 77.38, 79.76, 78.96, 76.38, 77.18, 75.59, 75.39, 73.01, 75.39, 76.38, 74.4, 76.78, 70.03, 69.84, 71.42, 71.03, 71.42, 71.42, 71.42, 71.62, 71.82, 70.83, 72.22]
[rank0]:2025-12-28 17:49:06,099 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1749_stage0.svg
[rank2]:2025-12-28 17:49:06,041 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1749_stage2.svg
[rank1]:2025-12-28 17:49:06,048 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1749_stage1.svg
[rank3]:2025-12-28 17:49:06,203 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1749_stage3.svg
[rank3]:2025-12-28 17:50:41,112 - Avg. fwd time: 10.7205 / Avg. bwd time: 28.9201 / Avg. batch time: 376.6788 (ms) / GPU bubble ratio: 15.81%
[rank0]:2025-12-28 17:50:41,180 - Avg. fwd time: 8.1802 / Avg. bwd time: 18.8241 / Avg. batch time: 478.5200 (ms) / GPU bubble ratio: 54.85%
[rank2]:2025-12-28 17:50:41,143 - Avg. fwd time: 6.9493 / Avg. bwd time: 18.4601 / Avg. batch time: 422.4792 (ms) / GPU bubble ratio: 51.89%
[rank1]:2025-12-28 17:50:41,168 - Avg. fwd time: 9.0726 / Avg. bwd time: 20.6980 / Avg. batch time: 460.7331 (ms) / GPU bubble ratio: 48.31%
[rank0]:2025-12-28 17:52:12,766 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 17:52:16,411 - Avg. fwd time: 10.7204 / Avg. bwd time: 28.8377 / Avg. batch time: 376.0189 (ms) / GPU bubble ratio: 15.84%
[rank2]:2025-12-28 17:52:16,451 - Avg. fwd time: 6.9491 / Avg. bwd time: 18.4593 / Avg. batch time: 421.9746 (ms) / GPU bubble ratio: 51.83%
[rank3]:2025-12-28 17:52:16,524 -  step: 750  loss:  0.2287  grad_norm:  0.1142  memory: 26.98GiB(56.79%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank2]:2025-12-28 17:52:16,510 -  step: 750  loss: -8.0000  grad_norm:  0.1142  memory: 12.26GiB(25.80%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank0]:2025-12-28 17:52:16,488 - Avg. fwd time: 8.1800 / Avg. bwd time: 18.7843 / Avg. batch time: 477.8487 (ms) / GPU bubble ratio: 54.86%
[rank0]:2025-12-28 17:52:16,525 -  step: 750  loss: -8.0000  grad_norm:  0.1142  memory: 17.08GiB(35.95%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank1]:2025-12-28 17:52:16,476 - Avg. fwd time: 9.0726 / Avg. bwd time: 20.6775 / Avg. batch time: 460.2238 (ms) / GPU bubble ratio: 48.29%
[rank1]:2025-12-28 17:52:16,514 -  step: 750  loss: -8.0000  grad_norm:  0.1142  memory: 15.15GiB(31.89%)  tps: 8,521  tflops: 66.61  mfu: 21.35%
[rank3]:2025-12-28 17:53:50,783 - Avg. fwd time: 10.7197 / Avg. bwd time: 28.7421 / Avg. batch time: 375.2466 (ms) / GPU bubble ratio: 15.87%
[rank0]:2025-12-28 17:53:50,860 - Avg. fwd time: 8.1796 / Avg. bwd time: 18.7348 / Avg. batch time: 477.0657 (ms) / GPU bubble ratio: 54.87%
[rank1]:2025-12-28 17:53:50,847 - Avg. fwd time: 9.0725 / Avg. bwd time: 20.6542 / Avg. batch time: 459.5921 (ms) / GPU bubble ratio: 48.26%
[rank2]:2025-12-28 17:53:50,822 - Avg. fwd time: 6.9489 / Avg. bwd time: 18.4595 / Avg. batch time: 421.3787 (ms) / GPU bubble ratio: 51.76%
[rank0]:2025-12-28 17:55:21,922 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 17:55:25,697 - Avg. fwd time: 10.7197 / Avg. bwd time: 28.6532 / Avg. batch time: 374.5365 (ms) / GPU bubble ratio: 15.90%
[rank0]:2025-12-28 17:55:25,773 - Avg. fwd time: 8.1790 / Avg. bwd time: 18.7010 / Avg. batch time: 476.4160 (ms) / GPU bubble ratio: 54.86%
[rank1]:2025-12-28 17:55:25,760 - Avg. fwd time: 9.0729 / Avg. bwd time: 20.6388 / Avg. batch time: 459.0842 (ms) / GPU bubble ratio: 48.22%
[rank1]:2025-12-28 17:55:25,798 -  step: 800  loss: -8.0000  grad_norm:  0.1035  memory: 15.15GiB(31.89%)  tps: 8,656  tflops: 67.67  mfu: 21.69%
[rank1]:2025-12-28 17:55:25,798 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1035  tps: 8,767  tflops: 68.54  mfu: 20.06%
[rank1]:2025-12-28 17:55:25,798 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 17:55:25,799 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-28 17:55:25,734 - Avg. fwd time: 6.9488 / Avg. bwd time: 18.4582 / Avg. batch time: 420.8541 (ms) / GPU bubble ratio: 51.70%
[rank2]:2025-12-28 17:55:25,795 -  step: 800  loss: -8.0000  grad_norm:  0.1035  memory: 12.26GiB(25.80%)  tps: 8,656  tflops: 67.67  mfu: 21.69%
[rank2]:2025-12-28 17:55:25,795 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1035  tps: 8,767  tflops: 68.53  mfu: 20.06%
[rank2]:2025-12-28 17:55:25,795 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 17:55:25,796 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 17:55:25,807 -  step: 800  loss:  0.2335  grad_norm:  0.1035  memory: 26.98GiB(56.79%)  tps: 8,656  tflops: 67.67  mfu: 21.69%
[rank3]:2025-12-28 17:55:25,808 - â„¹ï¸ final step: 800  loss:  0.2335  grad_norm:  0.1035  tps: 8,773  tflops: 68.59  mfu: 20.19%
[rank3]:2025-12-28 17:55:25,808 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 17:55:25,809 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 17:55:25,809 -  step: 800  loss: -8.0000  grad_norm:  0.1035  memory: 17.08GiB(35.95%)  tps: 8,656  tflops: 67.67  mfu: 21.69%
[rank0]:2025-12-28 17:55:25,809 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1035  tps: 8,766  tflops: 68.53  mfu: 20.05%
[rank0]:2025-12-28 17:55:25,809 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 17:55:25,810 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 17:55:27,706 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-28 17:55:27,778 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank0/251228_1755_stage0_final800.svg
[rank1]:2025-12-28 17:55:27,778 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank1/251228_1755_stage1_final800.svg
[rank2]:2025-12-28 17:55:27,776 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank2/251228_1755_stage2_final800.svg
[rank3]:2025-12-28 17:55:27,864 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1755_final800_rank3.svg
[rank3]:			> Batch Time: 459.00 ms, GPU Bubble Ratio: 54.29%, 49.13%, 55.71%, 34.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  307-25-332ms   | [S0,MB2,B]  337-25-362ms   | [S0,MB3,B]  366-25-392ms   | [S0,MB4,B]  394-18-412ms   | [S0,MB5,B]  419-23-443ms   | [S0,MB6,B]  444-0-444ms    | [S0,MB7,B]  459-0-459ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-24-269ms   | [S1,MB1,B]  282-22-304ms   | [S1,MB2,B]  308-25-333ms   | [S1,MB3,B]  337-25-363ms   | [S1,MB4,B]  366-16-383ms   | [S1,MB5,B]  394-22-416ms   | [S1,MB6,B]  419-11-431ms   | [S1,MB7,B]  444-11-455ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  259-19-278ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-19-328ms   | [S2,MB4,B]  336-20-356ms   | [S2,MB5,B]  367-20-387ms   | [S2,MB6,B]  393-19-413ms   | [S2,MB7,B]  419-8-428ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-38-252ms   | [S3,MB2,B]  252-23-275ms   | [S3,MB3,B]  275-21-297ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-342ms   | [S3,MB6,B]  341-22-364ms   | [S3,MB7,B]  364-22-386ms  
[rank3]:2025-12-28 17:55:27,998 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/pipeline_schedule/251228_1755_thry_final800_rank3.svg
[rank3]:			> Batch Time: 287.82 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-69ms      | [S0,MB0,B]  148-17-165ms   | [S0,MB1,B]  165-17-183ms   | [S0,MB2,B]  183-17-200ms   | [S0,MB3,B]  200-17-218ms   | [S0,MB4,B]  218-17-235ms   | [S0,MB5,B]  235-17-252ms   | [S0,MB6,B]  252-17-270ms   | [S0,MB7,B]  270-17-287ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-34ms      | [S1,MB3,F]  34-8-43ms      | [S1,MB4,F]  43-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-69ms      | [S1,MB7,F]  69-8-78ms      | [S1,MB0,B]  130-17-148ms   | [S1,MB1,B]  148-17-165ms   | [S1,MB2,B]  165-17-183ms   | [S1,MB3,B]  183-17-200ms   | [S1,MB4,B]  200-17-218ms   | [S1,MB5,B]  218-17-235ms   | [S1,MB6,B]  235-17-252ms   | [S1,MB7,B]  252-17-270ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-34ms      | [S2,MB2,F]  34-8-43ms      | [S2,MB3,F]  43-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-69ms      | [S2,MB6,F]  69-8-78ms      | [S2,MB7,F]  78-8-87ms      | [S2,MB0,B]  113-17-130ms   | [S2,MB1,B]  130-17-148ms   | [S2,MB2,B]  148-17-165ms   | [S2,MB3,B]  165-17-183ms   | [S2,MB4,B]  183-17-200ms   | [S2,MB5,B]  200-17-218ms   | [S2,MB6,B]  218-17-235ms   | [S2,MB7,B]  235-17-252ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-34ms      | [S3,MB1,F]  34-8-43ms      | [S3,MB2,F]  43-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-69ms      | [S3,MB5,F]  69-8-78ms      | [S3,MB6,F]  78-8-87ms      | [S3,MB7,F]  87-8-95ms      | [S3,MB0,B]  95-17-113ms    | [S3,MB1,B]  113-17-130ms   | [S3,MB2,B]  130-17-148ms   | [S3,MB3,B]  148-17-165ms   | [S3,MB4,B]  165-17-183ms   | [S3,MB5,B]  183-17-200ms   | [S3,MB6,B]  200-17-218ms   | [S3,MB7,B]  218-17-235ms  
[rank0]:2025-12-28 17:55:27,934 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1755_rank0_stage0.svg
[rank0]:	> Counts Sum: 570160, Total Sum: 1728640 (32.98%), Ratio(%) per element: [29.96, 34.76, 36.64, 36.98, 36.47, 35.1, 36.98, 36.13, 35.1, 36.3, 33.04, 34.41, 35.61, 34.76, 33.04, 34.07, 35.44, 33.56, 35.1, 32.36, 31.33, 31.84, 31.5, 31.33, 33.56, 32.19, 32.7, 31.67, 30.13, 30.3, 30.3, 30.65, 30.3, 29.45, 28.76, 29.45, 28.93]
[rank1]:2025-12-28 17:55:27,925 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1755_rank1_stage1.svg
[rank1]:	> Counts Sum: 813040, Total Sum: 2102400 (38.67%), Ratio(%) per element: [47.6, 46.4, 45.37, 47.26, 47.77, 47.43, 45.71, 45.89, 46.4, 39.72, 39.55, 39.04, 40.23, 39.72, 39.72, 38.69, 41.6, 40.06, 39.38, 38.52, 36.47, 38.18, 38.86, 36.3, 39.55, 36.3, 36.3, 34.76, 37.84, 35.44, 33.9, 34.76, 32.87, 33.56, 34.93, 34.76, 34.93, 33.56, 32.36, 35.27, 36.81, 34.41, 33.9, 34.93, 33.04]
[rank2]:2025-12-28 17:55:27,925 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1755_rank2_stage2.svg
[rank2]:	> Counts Sum: 223280, Total Sum: 1681920 (13.28%), Ratio(%) per element: [14.04, 14.21, 13.52, 13.35, 13.18, 14.04, 13.52, 13.69, 13.01, 13.52, 13.35, 13.52, 13.35, 13.18, 14.04, 13.86, 13.35, 13.69, 12.84, 13.52, 13.01, 13.69, 12.84, 12.67, 13.86, 13.01, 13.18, 12.15, 12.84, 12.67, 12.84, 12.67, 13.18, 13.01, 12.32, 13.01]
[rank3]:2025-12-28 17:55:28,047 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_ratio_history/rank3/251228_1755_stage3_final800.svg
[rank3]:2025-12-28 17:55:28,181 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/frozen_params_histogram/251228_1755_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [79.79, 78.76, 78.59, 78.93, 78.93, 78.93, 77.73, 79.79, 79.79, 77.39, 77.73, 76.54, 76.02, 74.48, 76.19, 76.88, 75.51, 77.22, 70.71, 70.54, 72.26, 71.74, 72.08, 72.26, 72.26, 72.43, 72.43, 71.57, 72.94]
[rank1]:2025-12-28 17:55:29,744 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1755_stage1.svg
[rank1]:2025-12-28 17:55:29,747 - Destroying the purge thread.
[rank2]:2025-12-28 17:55:29,747 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1755_stage2.svg
[rank2]:2025-12-28 17:55:29,751 - Destroying the purge thread.
[rank0]:2025-12-28 17:55:29,840 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1755_stage0.svg
[rank0]:2025-12-28 17:55:29,843 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-28 17:55:29,974 - Process group destroyed
[rank2]:2025-12-28 17:55:29,966 - Process group destroyed
[rank3]:2025-12-28 17:55:30,089 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1/afr_time_plot/251228_1755_stage3.svg
[rank3]:2025-12-28 17:55:30,093 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 330-351
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.73495
[rank3]:wandb:               final/avg_loss 0.23354
[rank3]:wandb:             final/avg_mfu(%) 20.19159
[rank3]:wandb:             final/avg_tflops 68.58603
[rank3]:wandb:    final/avg_throughput(tps) 8773.35185
[rank3]:wandb:              final/grad_norm 0.1035
[rank3]:wandb:               final/max_loss 0.23354
[rank3]:wandb:                    grad_norm 0.1035
[rank3]:wandb: loss_metrics/global_avg_loss 0.23354
[rank3]:wandb: loss_metrics/global_max_loss 0.23354
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_GPipe_timelyauto_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/tr0rsu74
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_GPipe_timelyauto_11_dm1/20251228-1702/wandb/run-20251228_170229-tr0rsu74/logs
[rank3]:2025-12-28 17:55:31,454 - Process group destroyed
[rank0]:2025-12-28 17:55:31,843 - Training completed
[rank0]:2025-12-28 17:55:31,844 - Destroying the purge thread.
[rank0]:2025-12-28 17:55:32,054 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.2', 'tok_embeddings', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.8', 'layers.6', 'layers.7', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'norm', 'output', 'layers.13', 'layers.15'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_GPipe_timelyauto_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_GPipe_timelyauto_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_GPipe_timelyauto_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_GPipe_timelyauto_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_GPipe_timelyauto_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_GPipe_timelyauto_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_GPipe_timelyauto_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_GPipe_timelyauto_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
