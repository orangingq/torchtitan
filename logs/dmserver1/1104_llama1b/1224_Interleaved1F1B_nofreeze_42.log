
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 19:17:19 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_Interleaved1F1B_nofreeze_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-24 19:17:25,416 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-24 19:17:25,433 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-24 19:17:25,540 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-24 19:17:25,635 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 19:17:25,637 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 19:17:25,640 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 19:17:25,641 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-24 19:17:25,635 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank1]:2025-12-24 19:17:25,650 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 19:17:25,652 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-24 19:17:25,850 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 19:17:25,853 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-24 19:17:25,786 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 19:17:25,789 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 19:17:26,038 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-24 19:17:29,052 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 19:17:29,092 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 19:17:29,119 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-24 19:17:29,132 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-24 19:17:29,133 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 19:17:29,223 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-24 19:17:29,190 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 19:17:29,228 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 19:17:29,255 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-24 19:17:29,269 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-24 19:17:29,270 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-24 19:17:29,325 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 19:17:29,325 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 19:17:29,326 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-24 19:17:29,373 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 19:17:29,410 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 19:17:29,411 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-24 19:17:29,437 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-24 19:17:29,450 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-24 19:17:29,452 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-24 19:17:29,459 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 19:17:29,459 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 19:17:29,460 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-24 19:17:29,640 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 19:17:29,640 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 19:17:29,641 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ac1cb8ft
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_nofreeze_42_dm1/20251224-1917/wandb/run-20251224_191730-ac1cb8ft
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ac1cb8ft
[rank3]:2025-12-24 19:17:31,113 - WandB logging enabled
[rank3]:2025-12-24 19:17:31,113 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 19:17:31,152 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 19:17:31,182 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-24 19:17:31,196 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-24 19:17:31,197 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-24 19:17:31,411 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 19:17:31,413 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_nofreeze_42_dm1
[rank0]:2025-12-24 19:17:31,413 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 19:17:31,414 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 19:17:31,414 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-24 19:17:31,413 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-24 19:17:31,391 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 19:17:31,392 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 19:17:31,393 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 19:17:31,411 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 19:17:33,827 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 19:17:33,828 - Finished loading the checkpoint in 2.41 seconds.
[rank0]:2025-12-24 19:17:33,828 - Training starts at step 1
[rank2]:2025-12-24 19:17:39,454 -  step:  1  loss: -4.0000  grad_norm: 203.0661  memory: 10.24GiB(21.56%)  tps: 3,204  tflops: 25.05  mfu: 8.03%
[rank2]:2025-12-24 19:17:39,454 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 19:17:39,460 -  step:  1  loss: -4.0000  grad_norm: 203.0661  memory: 16.23GiB(34.16%)  tps: 3,161  tflops: 24.71  mfu: 7.92%
[rank1]:2025-12-24 19:17:39,461 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-24 19:17:39,465 -  step:  1  loss: 10.6092  grad_norm: 203.0661  memory: 25.52GiB(53.71%)  tps: 3,943  tflops: 30.82  mfu: 9.88%
[rank3]:2025-12-24 19:17:39,466 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 19:17:39,493 -  step:  1  loss: -4.0000  grad_norm: 203.0661  memory: 16.58GiB(34.89%)  tps: 3,250  tflops: 25.41  mfu: 8.14%
[rank0]:2025-12-24 19:17:39,493 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 19:21:45,580 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:21:50,557 - Avg. fwd time: 14.2974 / Avg. bwd time: 40.4414 / Avg. batch time: 1092.8209 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-24 19:21:50,606 - Avg. fwd time: 7.8457 / Avg. bwd time: 18.8807 / Avg. batch time: 1154.8700 (ms) / GPU bubble ratio: 62.97%
[rank0]:2025-12-24 19:21:50,679 - Avg. fwd time: 8.2982 / Avg. bwd time: 21.1206 / Avg. batch time: 1253.5412 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-12-24 19:21:50,713 -  step: 50  loss:  9.8856  grad_norm: 24.2218  memory: 29.23GiB(61.52%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank1]:2025-12-24 19:21:50,647 - Avg. fwd time: 9.9741 / Avg. bwd time: 24.2830 / Avg. batch time: 1214.6085 (ms) / GPU bubble ratio: 54.87%
[rank1]:2025-12-24 19:21:50,704 -  step: 50  loss: -4.0000  grad_norm: 24.2218  memory: 18.49GiB(38.93%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank2]:2025-12-24 19:21:50,701 -  step: 50  loss: -4.0000  grad_norm: 24.2218  memory: 12.06GiB(25.39%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank0]:2025-12-24 19:21:50,716 -  step: 50  loss: -4.0000  grad_norm: 24.2218  memory: 20.42GiB(42.99%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank0]:2025-12-24 19:26:02,001 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:26:06,922 - Avg. fwd time: 14.3081 / Avg. bwd time: 40.5032 / Avg. batch time: 1093.8438 (ms) / GPU bubble ratio: 19.83%
[rank1]:2025-12-24 19:26:07,012 - Avg. fwd time: 9.9653 / Avg. bwd time: 24.3028 / Avg. batch time: 1215.2734 (ms) / GPU bubble ratio: 54.88%
[rank0]:2025-12-24 19:26:07,045 - Avg. fwd time: 8.2918 / Avg. bwd time: 21.1530 / Avg. batch time: 1254.2256 (ms) / GPU bubble ratio: 62.44%
[rank2]:2025-12-24 19:26:06,971 - Avg. fwd time: 7.8334 / Avg. bwd time: 18.9131 / Avg. batch time: 1155.6434 (ms) / GPU bubble ratio: 62.97%
[rank2]:2025-12-24 19:26:07,067 -  step: 100  loss: -4.0000  grad_norm: 16.2972  memory: 12.06GiB(25.39%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank1]:2025-12-24 19:26:07,071 -  step: 100  loss: -4.0000  grad_norm: 16.2972  memory: 18.49GiB(38.93%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank3]:2025-12-24 19:26:07,079 -  step: 100  loss:  8.2147  grad_norm: 16.2972  memory: 29.23GiB(61.52%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank0]:2025-12-24 19:26:07,082 -  step: 100  loss: -4.0000  grad_norm: 16.2972  memory: 20.42GiB(42.99%)  tps: 6,391  tflops: 49.96  mfu: 16.01%
[rank3]:2025-12-24 19:26:07,351 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_1926_step100_rank3.svg
[rank3]:			> Batch Time: 1242.55 ms, GPU Bubble Ratio: 61.99%, 55.93%, 65.55%, 29.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  386-7-394ms    | [S4,MB1,B]  489-19-508ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  583-8-592ms    | [S4,MB3,B]  592-19-611ms   | [S4,MB6,F]  617-8-625ms    | [S0,MB0,B]  628-25-653ms   | [S4,MB7,F]  654-7-661ms    | [S0,MB1,B]  666-24-691ms   | [S0,MB2,B]  708-23-732ms   | [S0,MB3,B]  764-23-787ms   | [S4,MB4,B]  801-18-819ms   | [S4,MB5,B]  889-18-907ms   | [S4,MB6,B]  979-18-997ms   | [S4,MB7,B]  1071-18-1089ms | [S0,MB4,B]  1106-23-1129ms | [S0,MB5,B]  1149-23-1172ms | [S0,MB6,B]  1183-23-1206ms | [S0,MB7,B]  1219-23-1242ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  274-7-281ms    | [S1,MB4,F]  303-10-314ms   | [S5,MB0,B]  314-18-333ms   | [S1,MB5,F]  361-12-373ms   | [S5,MB1,B]  376-18-395ms   | [S1,MB6,F]  395-11-407ms   | [S5,MB2,B]  488-18-507ms   | [S1,MB7,F]  507-11-519ms   | [S5,MB3,B]  558-19-577ms   | [S5,MB4,F]  578-7-585ms    | [S1,MB0,B]  591-29-620ms   | [S5,MB5,F]  621-9-630ms    | [S1,MB1,B]  630-30-660ms   | [S5,MB6,F]  659-10-669ms   | [S1,MB2,B]  669-32-701ms   | [S5,MB7,F]  701-10-712ms   | [S1,MB3,B]  712-33-745ms   | [S5,MB4,B]  776-18-795ms   | [S5,MB5,B]  865-18-883ms   | [S5,MB6,B]  954-18-972ms   | [S5,MB7,B]  1045-18-1063ms | [S1,MB4,B]  1071-27-1099ms | [S1,MB5,B]  1114-27-1142ms | [S1,MB6,B]  1148-28-1176ms | [S1,MB7,B]  1182-30-1212ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-294ms   | [S6,MB3,F]  294-8-302ms    | [S6,MB1,B]  351-19-370ms   | [S2,MB4,F]  370-8-378ms    | [S6,MB2,B]  440-19-460ms   | [S2,MB5,F]  460-7-467ms    | [S6,MB3,B]  531-19-550ms   | [S2,MB6,F]  550-8-559ms    | [S2,MB0,B]  563-19-583ms   | [S2,MB7,F]  583-8-592ms    | [S2,MB1,B]  598-19-618ms   | [S6,MB4,F]  617-8-626ms    | [S2,MB2,B]  631-19-651ms   | [S6,MB5,F]  651-7-658ms    | [S2,MB3,B]  666-20-686ms   | [S6,MB6,F]  687-7-694ms    | [S6,MB4,B]  750-19-770ms   | [S6,MB7,F]  770-8-778ms    | [S6,MB5,B]  840-18-858ms   | [S6,MB6,B]  930-17-948ms   | [S6,MB7,B]  1021-17-1039ms | [S2,MB4,B]  1047-18-1065ms | [S2,MB5,B]  1089-18-1107ms | [S2,MB6,B]  1114-18-1132ms | [S2,MB7,B]  1148-18-1167ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  258-18-277ms   | [S7,MB1,B]  289-55-344ms   | [S7,MB2,F]  344-21-366ms   | [S7,MB2,B]  376-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  467-57-525ms   | [S3,MB4,F]  524-11-536ms   | [S3,MB0,B]  534-24-558ms   | [S3,MB5,F]  557-10-567ms   | [S3,MB1,B]  568-23-591ms   | [S3,MB6,F]  591-10-602ms   | [S3,MB2,B]  601-23-625ms   | [S3,MB7,F]  624-10-635ms   | [S3,MB3,B]  635-22-657ms   | [S7,MB4,F]  657-18-675ms   | [S7,MB4,B]  688-56-744ms   | [S7,MB5,F]  744-21-765ms   | [S7,MB5,B]  776-57-833ms   | [S7,MB6,F]  833-21-855ms   | [S7,MB6,B]  866-57-923ms   | [S7,MB7,F]  924-21-945ms   | [S7,MB7,B]  957-57-1015ms  | [S3,MB4,B]  1014-26-1040ms | [S3,MB5,B]  1040-24-1065ms | [S3,MB6,B]  1065-24-1090ms | [S3,MB7,B]  1089-23-1113ms
[rank0]:2025-12-24 19:30:18,929 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:30:23,967 - Avg. fwd time: 14.3335 / Avg. bwd time: 40.5440 / Avg. batch time: 1094.8605 (ms) / GPU bubble ratio: 19.80%
[rank1]:2025-12-24 19:30:24,066 - Avg. fwd time: 9.9584 / Avg. bwd time: 24.3178 / Avg. batch time: 1216.6339 (ms) / GPU bubble ratio: 54.92%
[rank0]:2025-12-24 19:30:24,099 - Avg. fwd time: 8.2887 / Avg. bwd time: 21.1647 / Avg. batch time: 1255.5888 (ms) / GPU bubble ratio: 62.47%
[rank2]:2025-12-24 19:30:24,019 - Avg. fwd time: 7.8264 / Avg. bwd time: 18.9301 / Avg. batch time: 1156.9935 (ms) / GPU bubble ratio: 63.00%
[rank1]:2025-12-24 19:30:24,124 -  step: 150  loss: -4.0000  grad_norm: 27.8288  memory: 18.49GiB(38.93%)  tps: 6,374  tflops: 49.83  mfu: 15.97%
[rank3]:2025-12-24 19:30:24,133 -  step: 150  loss:  3.3638  grad_norm: 27.8288  memory: 29.23GiB(61.52%)  tps: 6,374  tflops: 49.83  mfu: 15.97%
[rank0]:2025-12-24 19:30:24,136 -  step: 150  loss: -4.0000  grad_norm: 27.8288  memory: 20.42GiB(42.99%)  tps: 6,374  tflops: 49.83  mfu: 15.97%
[rank2]:2025-12-24 19:30:24,121 -  step: 150  loss: -4.0000  grad_norm: 27.8288  memory: 12.06GiB(25.39%)  tps: 6,374  tflops: 49.83  mfu: 15.97%
[rank0]:2025-12-24 19:34:36,244 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:34:41,308 - Avg. fwd time: 14.3526 / Avg. bwd time: 40.5759 / Avg. batch time: 1095.6502 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-12-24 19:34:41,360 - Avg. fwd time: 7.8239 / Avg. bwd time: 18.9586 / Avg. batch time: 1157.7619 (ms) / GPU bubble ratio: 62.99%
[rank1]:2025-12-24 19:34:41,407 - Avg. fwd time: 9.9580 / Avg. bwd time: 24.3665 / Avg. batch time: 1217.5536 (ms) / GPU bubble ratio: 54.89%
[rank0]:2025-12-24 19:34:41,440 - Avg. fwd time: 8.2924 / Avg. bwd time: 21.1921 / Avg. batch time: 1256.5518 (ms) / GPU bubble ratio: 62.46%
[rank2]:2025-12-24 19:34:41,462 -  step: 200  loss: -4.0000  grad_norm: 15.8658  memory: 12.06GiB(25.39%)  tps: 6,367  tflops: 49.77  mfu: 15.95%
[rank1]:2025-12-24 19:34:41,465 -  step: 200  loss: -4.0000  grad_norm: 15.8658  memory: 18.49GiB(38.93%)  tps: 6,367  tflops: 49.77  mfu: 15.95%
[rank0]:2025-12-24 19:34:41,477 -  step: 200  loss: -4.0000  grad_norm: 15.8658  memory: 20.42GiB(42.99%)  tps: 6,367  tflops: 49.77  mfu: 15.95%
[rank3]:2025-12-24 19:34:41,474 -  step: 200  loss:  1.0630  grad_norm: 15.8658  memory: 29.23GiB(61.52%)  tps: 6,367  tflops: 49.77  mfu: 15.95%
[rank3]:2025-12-24 19:34:41,720 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_1934_step200_rank3.svg
[rank3]:			> Batch Time: 1258.69 ms, GPU Bubble Ratio: 62.26%, 55.86%, 65.76%, 29.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-96ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  163-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-196ms    | [S4,MB0,B]  370-19-390ms   | [S0,MB7,F]  389-7-397ms    | [S4,MB1,B]  493-19-512ms   | [S4,MB4,F]  554-8-562ms    | [S4,MB2,B]  563-19-582ms   | [S4,MB5,F]  590-8-599ms    | [S4,MB3,B]  599-19-618ms   | [S4,MB6,F]  625-8-634ms    | [S0,MB0,B]  635-25-660ms   | [S4,MB7,F]  662-7-669ms    | [S0,MB1,B]  675-24-699ms   | [S0,MB2,B]  718-23-741ms   | [S0,MB3,B]  775-23-798ms   | [S4,MB4,B]  813-18-831ms   | [S4,MB5,B]  902-18-920ms   | [S4,MB6,B]  992-18-1010ms  | [S4,MB7,B]  1084-18-1102ms | [S0,MB4,B]  1119-23-1142ms | [S0,MB5,B]  1163-23-1186ms | [S0,MB6,B]  1198-23-1221ms | [S0,MB7,B]  1235-23-1258ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-11-136ms   | [S5,MB0,F]  162-8-171ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  275-7-283ms    | [S1,MB4,F]  305-10-316ms   | [S5,MB0,B]  316-19-335ms   | [S1,MB5,F]  364-12-376ms   | [S5,MB1,B]  379-19-398ms   | [S1,MB6,F]  399-11-410ms   | [S5,MB2,B]  492-19-511ms   | [S1,MB7,F]  511-11-523ms   | [S5,MB3,B]  563-19-582ms   | [S5,MB4,F]  582-7-590ms    | [S1,MB0,B]  598-29-627ms   | [S5,MB5,F]  627-9-636ms    | [S1,MB1,B]  637-30-667ms   | [S5,MB6,F]  668-10-678ms   | [S1,MB2,B]  678-33-711ms   | [S5,MB7,F]  711-10-721ms   | [S1,MB3,B]  722-34-756ms   | [S5,MB4,B]  787-18-806ms   | [S5,MB5,B]  877-18-895ms   | [S5,MB6,B]  967-18-986ms   | [S5,MB7,B]  1058-18-1077ms | [S1,MB4,B]  1084-27-1112ms | [S1,MB5,B]  1127-28-1155ms | [S1,MB6,B]  1162-29-1192ms | [S1,MB7,B]  1198-31-1230ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  136-7-143ms    | [S6,MB0,F]  171-7-179ms    | [S6,MB1,F]  185-7-192ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-296ms   | [S6,MB3,F]  295-8-304ms    | [S6,MB1,B]  353-19-373ms   | [S2,MB4,F]  373-8-382ms    | [S6,MB2,B]  444-19-464ms   | [S2,MB5,F]  464-7-471ms    | [S6,MB3,B]  535-19-554ms   | [S2,MB6,F]  554-8-563ms    | [S2,MB0,B]  570-19-590ms   | [S2,MB7,F]  590-8-599ms    | [S2,MB1,B]  605-19-625ms   | [S6,MB4,F]  625-8-634ms    | [S2,MB2,B]  639-20-659ms   | [S6,MB5,F]  660-7-668ms    | [S2,MB3,B]  675-20-695ms   | [S6,MB6,F]  695-7-703ms    | [S6,MB4,B]  761-19-781ms   | [S6,MB7,F]  780-8-789ms    | [S6,MB5,B]  851-18-870ms   | [S6,MB6,B]  943-18-961ms   | [S6,MB7,B]  1034-18-1052ms | [S2,MB4,B]  1059-18-1078ms | [S2,MB5,B]  1103-18-1122ms | [S2,MB6,B]  1128-18-1147ms | [S2,MB7,B]  1162-18-1181ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  105-7-112ms    | [S3,MB3,F]  143-7-150ms    | [S7,MB0,F]  179-15-194ms   | [S7,MB0,B]  206-53-260ms   | [S7,MB1,F]  260-19-279ms   | [S7,MB1,B]  290-55-346ms   | [S7,MB2,F]  347-21-368ms   | [S7,MB2,B]  380-58-438ms   | [S7,MB3,F]  438-21-459ms   | [S7,MB3,B]  471-58-529ms   | [S3,MB4,F]  528-12-540ms   | [S3,MB0,B]  540-24-564ms   | [S3,MB5,F]  564-10-575ms   | [S3,MB1,B]  575-24-599ms   | [S3,MB6,F]  598-10-609ms   | [S3,MB2,B]  609-23-633ms   | [S3,MB7,F]  633-10-643ms   | [S3,MB3,B]  643-23-666ms   | [S7,MB4,F]  667-18-685ms   | [S7,MB4,B]  697-56-754ms   | [S7,MB5,F]  754-21-775ms   | [S7,MB5,B]  787-58-845ms   | [S7,MB6,F]  845-21-867ms   | [S7,MB6,B]  878-57-936ms   | [S7,MB7,F]  936-21-958ms   | [S7,MB7,B]  969-58-1027ms  | [S3,MB4,B]  1027-26-1053ms | [S3,MB5,B]  1052-24-1077ms | [S3,MB6,B]  1077-25-1102ms | [S3,MB7,B]  1102-23-1126ms
[rank0]:2025-12-24 19:38:53,749 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:38:58,706 - Avg. fwd time: 14.3625 / Avg. bwd time: 40.5887 / Avg. batch time: 1095.9860 (ms) / GPU bubble ratio: 19.78%
[rank1]:2025-12-24 19:38:58,799 - Avg. fwd time: 9.9578 / Avg. bwd time: 24.4047 / Avg. batch time: 1218.2019 (ms) / GPU bubble ratio: 54.87%
[rank0]:2025-12-24 19:38:58,832 - Avg. fwd time: 8.2918 / Avg. bwd time: 21.2122 / Avg. batch time: 1257.2135 (ms) / GPU bubble ratio: 62.45%
[rank2]:2025-12-24 19:38:58,757 - Avg. fwd time: 7.8208 / Avg. bwd time: 18.9807 / Avg. batch time: 1158.3212 (ms) / GPU bubble ratio: 62.98%
[rank2]:2025-12-24 19:38:58,854 -  step: 250  loss: -4.0000  grad_norm:  3.4988  memory: 12.06GiB(25.39%)  tps: 6,365  tflops: 49.76  mfu: 15.95%
[rank3]:2025-12-24 19:38:58,866 -  step: 250  loss:  0.3619  grad_norm:  3.4988  memory: 29.23GiB(61.52%)  tps: 6,365  tflops: 49.76  mfu: 15.95%
[rank1]:2025-12-24 19:38:58,857 -  step: 250  loss: -4.0000  grad_norm:  3.4988  memory: 18.49GiB(38.93%)  tps: 6,365  tflops: 49.76  mfu: 15.95%
[rank0]:2025-12-24 19:38:58,868 -  step: 250  loss: -4.0000  grad_norm:  3.4988  memory: 20.42GiB(42.99%)  tps: 6,365  tflops: 49.76  mfu: 15.95%
[rank0]:2025-12-24 19:43:09,846 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:43:14,788 - Avg. fwd time: 14.3487 / Avg. bwd time: 40.5620 / Avg. batch time: 1095.3022 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-12-24 19:43:14,843 - Avg. fwd time: 7.8169 / Avg. bwd time: 18.9924 / Avg. batch time: 1157.6674 (ms) / GPU bubble ratio: 62.95%
[rank2]:2025-12-24 19:43:14,946 -  step: 300  loss: -4.0000  grad_norm:  0.5898  memory: 12.06GiB(25.39%)  tps: 6,398  tflops: 50.01  mfu: 16.03%
[rank0]:2025-12-24 19:43:14,925 - Avg. fwd time: 8.2907 / Avg. bwd time: 21.2230 / Avg. batch time: 1256.5769 (ms) / GPU bubble ratio: 62.42%
[rank0]:2025-12-24 19:43:14,961 -  step: 300  loss: -4.0000  grad_norm:  0.5898  memory: 20.42GiB(42.99%)  tps: 6,398  tflops: 50.01  mfu: 16.03%
[rank1]:2025-12-24 19:43:14,890 - Avg. fwd time: 9.9548 / Avg. bwd time: 24.4253 / Avg. batch time: 1217.5607 (ms) / GPU bubble ratio: 54.82%
[rank1]:2025-12-24 19:43:14,950 -  step: 300  loss: -4.0000  grad_norm:  0.5898  memory: 18.49GiB(38.93%)  tps: 6,398  tflops: 50.01  mfu: 16.03%
[rank3]:2025-12-24 19:43:14,958 -  step: 300  loss:  0.2665  grad_norm:  0.5898  memory: 29.23GiB(61.52%)  tps: 6,398  tflops: 50.01  mfu: 16.03%
[rank3]:2025-12-24 19:43:15,210 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_1943_step300_rank3.svg
[rank3]:			> Batch Time: 1253.58 ms, GPU Bubble Ratio: 62.18%, 55.97%, 65.71%, 29.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-186ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  387-7-394ms    | [S4,MB1,B]  490-19-509ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  587-8-596ms    | [S4,MB3,B]  596-19-615ms   | [S4,MB6,F]  623-8-631ms    | [S0,MB0,B]  632-25-657ms   | [S4,MB7,F]  658-7-666ms    | [S0,MB1,B]  671-24-695ms   | [S0,MB2,B]  714-23-737ms   | [S0,MB3,B]  770-23-793ms   | [S4,MB4,B]  808-18-826ms   | [S4,MB5,B]  896-18-914ms   | [S4,MB6,B]  986-18-1004ms  | [S4,MB7,B]  1077-18-1095ms | [S0,MB4,B]  1112-23-1135ms | [S0,MB5,B]  1156-23-1179ms | [S0,MB6,B]  1193-23-1216ms | [S0,MB7,B]  1230-23-1253ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  361-12-374ms   | [S5,MB1,B]  377-19-396ms   | [S1,MB6,F]  396-11-407ms   | [S5,MB2,B]  489-19-508ms   | [S1,MB7,F]  508-11-519ms   | [S5,MB3,B]  559-19-578ms   | [S5,MB4,F]  578-7-586ms    | [S1,MB0,B]  596-29-625ms   | [S5,MB5,F]  624-9-633ms    | [S1,MB1,B]  633-30-664ms   | [S5,MB6,F]  664-10-674ms   | [S1,MB2,B]  674-32-707ms   | [S5,MB7,F]  707-10-717ms   | [S1,MB3,B]  718-34-752ms   | [S5,MB4,B]  782-18-801ms   | [S5,MB5,B]  871-18-890ms   | [S5,MB6,B]  961-18-979ms   | [S5,MB7,B]  1052-18-1071ms | [S1,MB4,B]  1077-27-1105ms | [S1,MB5,B]  1121-28-1149ms | [S1,MB6,B]  1155-29-1185ms | [S1,MB7,B]  1192-29-1222ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-276ms    | [S6,MB0,B]  275-19-295ms   | [S6,MB3,F]  294-8-303ms    | [S6,MB1,B]  351-19-370ms   | [S2,MB4,F]  370-8-379ms    | [S6,MB2,B]  441-19-460ms   | [S2,MB5,F]  460-7-468ms    | [S6,MB3,B]  531-19-551ms   | [S2,MB6,F]  551-8-560ms    | [S2,MB0,B]  568-19-587ms   | [S2,MB7,F]  587-8-595ms    | [S2,MB1,B]  603-19-623ms   | [S6,MB4,F]  623-8-631ms    | [S2,MB2,B]  637-19-657ms   | [S6,MB5,F]  657-7-664ms    | [S2,MB3,B]  671-20-691ms   | [S6,MB6,F]  692-7-699ms    | [S6,MB4,B]  756-19-776ms   | [S6,MB7,F]  775-8-784ms    | [S6,MB5,B]  846-18-864ms   | [S6,MB6,B]  936-18-954ms   | [S6,MB7,B]  1027-18-1045ms | [S2,MB4,B]  1053-18-1071ms | [S2,MB5,B]  1096-18-1114ms | [S2,MB6,B]  1121-18-1140ms | [S2,MB7,B]  1155-18-1174ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  259-18-278ms   | [S7,MB1,B]  289-55-345ms   | [S7,MB2,F]  344-21-366ms   | [S7,MB2,B]  377-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  467-58-525ms   | [S3,MB4,F]  525-12-537ms   | [S3,MB0,B]  536-24-561ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  572-23-596ms   | [S3,MB6,F]  596-10-607ms   | [S3,MB2,B]  607-23-630ms   | [S3,MB7,F]  630-10-641ms   | [S3,MB3,B]  641-22-663ms   | [S7,MB4,F]  663-18-682ms   | [S7,MB4,B]  694-56-750ms   | [S7,MB5,F]  750-21-771ms   | [S7,MB5,B]  782-57-839ms   | [S7,MB6,F]  840-21-861ms   | [S7,MB6,B]  873-57-930ms   | [S7,MB7,F]  930-21-951ms   | [S7,MB7,B]  963-57-1021ms  | [S3,MB4,B]  1020-26-1046ms | [S3,MB5,B]  1046-24-1070ms | [S3,MB6,B]  1071-24-1096ms | [S3,MB7,B]  1096-23-1120ms
[rank0]:2025-12-24 19:47:26,642 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:47:31,653 - Avg. fwd time: 14.3445 / Avg. bwd time: 40.5561 / Avg. batch time: 1095.1246 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-12-24 19:47:31,705 - Avg. fwd time: 7.8153 / Avg. bwd time: 18.9986 / Avg. batch time: 1157.6583 (ms) / GPU bubble ratio: 62.94%
[rank2]:2025-12-24 19:47:31,809 -  step: 350  loss: -4.0000  grad_norm:  0.2094  memory: 12.06GiB(25.39%)  tps: 6,379  tflops: 49.86  mfu: 15.98%
[rank0]:2025-12-24 19:47:31,787 - Avg. fwd time: 8.2904 / Avg. bwd time: 21.2302 / Avg. batch time: 1256.6413 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-12-24 19:47:31,752 - Avg. fwd time: 9.9554 / Avg. bwd time: 24.4464 / Avg. batch time: 1217.6249 (ms) / GPU bubble ratio: 54.79%
[rank1]:2025-12-24 19:47:31,812 -  step: 350  loss: -4.0000  grad_norm:  0.2094  memory: 18.49GiB(38.93%)  tps: 6,379  tflops: 49.86  mfu: 15.98%
[rank3]:2025-12-24 19:47:31,821 -  step: 350  loss:  0.2144  grad_norm:  0.2094  memory: 29.23GiB(61.52%)  tps: 6,379  tflops: 49.86  mfu: 15.98%
[rank0]:2025-12-24 19:47:31,823 -  step: 350  loss: -4.0000  grad_norm:  0.2094  memory: 20.42GiB(42.99%)  tps: 6,379  tflops: 49.86  mfu: 15.98%
[rank0]:2025-12-24 19:51:43,319 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:51:48,332 - Avg. fwd time: 14.3415 / Avg. bwd time: 40.5563 / Avg. batch time: 1095.0774 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-12-24 19:51:48,384 - Avg. fwd time: 7.8141 / Avg. bwd time: 19.0019 / Avg. batch time: 1157.5701 (ms) / GPU bubble ratio: 62.93%
[rank1]:2025-12-24 19:51:48,432 - Avg. fwd time: 9.9549 / Avg. bwd time: 24.4570 / Avg. batch time: 1217.5676 (ms) / GPU bubble ratio: 54.78%
[rank2]:2025-12-24 19:51:48,489 -  step: 400  loss: -4.0000  grad_norm:  0.1685  memory: 12.06GiB(25.39%)  tps: 6,383  tflops: 49.90  mfu: 15.99%
[rank0]:2025-12-24 19:51:48,467 - Avg. fwd time: 8.2903 / Avg. bwd time: 21.2343 / Avg. batch time: 1256.5833 (ms) / GPU bubble ratio: 62.41%
[rank0]:2025-12-24 19:51:48,503 -  step: 400  loss: -4.0000  grad_norm:  0.1685  memory: 20.42GiB(42.99%)  tps: 6,383  tflops: 49.90  mfu: 15.99%
[rank1]:2025-12-24 19:51:48,492 -  step: 400  loss: -4.0000  grad_norm:  0.1685  memory: 18.49GiB(38.93%)  tps: 6,383  tflops: 49.90  mfu: 15.99%
[rank3]:2025-12-24 19:51:48,501 -  step: 400  loss:  0.2052  grad_norm:  0.1685  memory: 29.23GiB(61.52%)  tps: 6,383  tflops: 49.90  mfu: 15.99%
[rank3]:2025-12-24 19:51:48,755 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_1951_step400_rank3.svg
[rank3]:			> Batch Time: 1256.56 ms, GPU Bubble Ratio: 62.24%, 56.00%, 65.79%, 29.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-196ms    | [S4,MB0,B]  370-19-389ms   | [S0,MB7,F]  389-7-396ms    | [S4,MB1,B]  490-19-509ms   | [S4,MB4,F]  552-8-560ms    | [S4,MB2,B]  560-19-579ms   | [S4,MB5,F]  588-8-596ms    | [S4,MB3,B]  596-19-615ms   | [S4,MB6,F]  622-8-631ms    | [S0,MB0,B]  632-25-657ms   | [S4,MB7,F]  659-7-667ms    | [S0,MB1,B]  672-24-696ms   | [S0,MB2,B]  715-23-739ms   | [S0,MB3,B]  769-23-792ms   | [S4,MB4,B]  807-18-825ms   | [S4,MB5,B]  897-18-915ms   | [S4,MB6,B]  988-18-1006ms  | [S4,MB7,B]  1080-18-1098ms | [S0,MB4,B]  1116-23-1139ms | [S0,MB5,B]  1160-23-1183ms | [S0,MB6,B]  1196-23-1219ms | [S0,MB7,B]  1233-23-1256ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  275-7-283ms    | [S1,MB4,F]  305-10-316ms   | [S5,MB0,B]  316-19-335ms   | [S1,MB5,F]  363-12-376ms   | [S5,MB1,B]  379-19-398ms   | [S1,MB6,F]  398-11-409ms   | [S5,MB2,B]  489-18-508ms   | [S1,MB7,F]  508-11-520ms   | [S5,MB3,B]  560-19-579ms   | [S5,MB4,F]  579-7-587ms    | [S1,MB0,B]  596-29-625ms   | [S5,MB5,F]  625-9-634ms    | [S1,MB1,B]  634-30-665ms   | [S5,MB6,F]  665-10-675ms   | [S1,MB2,B]  675-33-708ms   | [S5,MB7,F]  708-10-719ms   | [S1,MB3,B]  719-34-753ms   | [S5,MB4,B]  782-18-800ms   | [S5,MB5,B]  872-18-890ms   | [S5,MB6,B]  963-18-981ms   | [S5,MB7,B]  1055-18-1073ms | [S1,MB4,B]  1081-27-1109ms | [S1,MB5,B]  1124-28-1152ms | [S1,MB6,B]  1159-28-1188ms | [S1,MB7,B]  1195-31-1226ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  185-7-192ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-296ms   | [S6,MB3,F]  296-8-304ms    | [S6,MB1,B]  353-19-373ms   | [S2,MB4,F]  372-8-381ms    | [S6,MB2,B]  443-19-462ms   | [S2,MB5,F]  462-7-469ms    | [S6,MB3,B]  532-19-551ms   | [S2,MB6,F]  551-8-560ms    | [S2,MB0,B]  568-19-587ms   | [S2,MB7,F]  588-8-596ms    | [S2,MB1,B]  602-19-622ms   | [S6,MB4,F]  622-8-631ms    | [S2,MB2,B]  636-19-656ms   | [S6,MB5,F]  656-7-664ms    | [S2,MB3,B]  672-20-693ms   | [S6,MB6,F]  692-7-700ms    | [S6,MB4,B]  756-19-775ms   | [S6,MB7,F]  775-8-783ms    | [S6,MB5,B]  847-18-866ms   | [S6,MB6,B]  938-18-956ms   | [S6,MB7,B]  1030-18-1048ms | [S2,MB4,B]  1056-18-1075ms | [S2,MB5,B]  1099-18-1117ms | [S2,MB6,B]  1124-18-1143ms | [S2,MB7,B]  1158-18-1177ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-6-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-260ms   | [S7,MB1,F]  260-19-279ms   | [S7,MB1,B]  290-55-346ms   | [S7,MB2,F]  346-21-368ms   | [S7,MB2,B]  379-57-436ms   | [S7,MB3,F]  436-21-457ms   | [S7,MB3,B]  468-58-526ms   | [S3,MB4,F]  526-12-538ms   | [S3,MB0,B]  537-24-562ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  572-23-596ms   | [S3,MB6,F]  596-10-606ms   | [S3,MB2,B]  606-23-630ms   | [S3,MB7,F]  630-10-640ms   | [S3,MB3,B]  640-22-663ms   | [S7,MB4,F]  663-18-681ms   | [S7,MB4,B]  693-56-750ms   | [S7,MB5,F]  749-21-771ms   | [S7,MB5,B]  783-57-841ms   | [S7,MB6,F]  841-21-862ms   | [S7,MB6,B]  874-57-932ms   | [S7,MB7,F]  932-21-953ms   | [S7,MB7,B]  965-58-1023ms  | [S3,MB4,B]  1023-26-1049ms | [S3,MB5,B]  1049-24-1074ms | [S3,MB6,B]  1073-24-1098ms | [S3,MB7,B]  1098-23-1122ms
[rank3]:2025-12-24 19:52:17,620 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 19:52:18,072 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 19:52:18,133 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 19:52:18,106 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 19:55:59,782 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:56:04,726 - Avg. fwd time: 14.3348 / Avg. bwd time: 40.5484 / Avg. batch time: 1094.8259 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-12-24 19:56:04,775 - Avg. fwd time: 7.8124 / Avg. bwd time: 19.0030 / Avg. batch time: 1157.4119 (ms) / GPU bubble ratio: 62.93%
[rank0]:2025-12-24 19:56:04,852 - Avg. fwd time: 8.2892 / Avg. bwd time: 21.2370 / Avg. batch time: 1256.4382 (ms) / GPU bubble ratio: 62.40%
[rank1]:2025-12-24 19:56:04,816 - Avg. fwd time: 9.9536 / Avg. bwd time: 24.4642 / Avg. batch time: 1217.4224 (ms) / GPU bubble ratio: 54.77%
[rank1]:2025-12-24 19:56:04,877 -  step: 450  loss: -4.0000  grad_norm:  0.2138  memory: 18.49GiB(38.93%)  tps: 6,390  tflops: 49.96  mfu: 16.01%
[rank2]:2025-12-24 19:56:04,873 -  step: 450  loss: -4.0000  grad_norm:  0.2138  memory: 12.06GiB(25.39%)  tps: 6,390  tflops: 49.96  mfu: 16.01%
[rank3]:2025-12-24 19:56:04,885 -  step: 450  loss:  0.2189  grad_norm:  0.2138  memory: 29.23GiB(61.52%)  tps: 6,390  tflops: 49.96  mfu: 16.01%
[rank0]:2025-12-24 19:56:04,887 -  step: 450  loss: -4.0000  grad_norm:  0.2138  memory: 20.42GiB(42.99%)  tps: 6,390  tflops: 49.96  mfu: 16.01%
[rank0]:2025-12-24 20:00:15,902 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 20:00:20,857 - Avg. fwd time: 14.3375 / Avg. bwd time: 40.5309 / Avg. batch time: 1094.5629 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-12-24 20:00:20,909 - Avg. fwd time: 7.8107 / Avg. bwd time: 19.0010 / Avg. batch time: 1157.1345 (ms) / GPU bubble ratio: 62.93%
[rank0]:2025-12-24 20:00:20,991 - Avg. fwd time: 8.2887 / Avg. bwd time: 21.2380 / Avg. batch time: 1256.1561 (ms) / GPU bubble ratio: 62.39%
[rank1]:2025-12-24 20:00:20,955 - Avg. fwd time: 9.9507 / Avg. bwd time: 24.4643 / Avg. batch time: 1217.1434 (ms) / GPU bubble ratio: 54.76%
[rank1]:2025-12-24 20:00:21,016 -  step: 500  loss: -4.0000  grad_norm:  0.1873  memory: 18.49GiB(38.93%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank2]:2025-12-24 20:00:21,013 -  step: 500  loss: -4.0000  grad_norm:  0.1873  memory: 12.06GiB(25.39%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank3]:2025-12-24 20:00:21,025 -  step: 500  loss:  0.2108  grad_norm:  0.1873  memory: 29.23GiB(61.52%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank0]:2025-12-24 20:00:21,027 -  step: 500  loss: -4.0000  grad_norm:  0.1873  memory: 20.42GiB(42.99%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank3]:2025-12-24 20:00:21,275 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_2000_step500_rank3.svg
[rank3]:			> Batch Time: 1253.55 ms, GPU Bubble Ratio: 62.19%, 55.98%, 65.78%, 29.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  369-19-388ms   | [S0,MB7,F]  388-7-395ms    | [S4,MB1,B]  490-19-509ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  560-19-579ms   | [S4,MB5,F]  587-8-595ms    | [S4,MB3,B]  596-19-615ms   | [S4,MB6,F]  622-8-631ms    | [S0,MB0,B]  631-25-656ms   | [S4,MB7,F]  658-7-666ms    | [S0,MB1,B]  671-24-696ms   | [S0,MB2,B]  715-23-738ms   | [S0,MB3,B]  769-23-792ms   | [S4,MB4,B]  807-18-825ms   | [S4,MB5,B]  895-18-913ms   | [S4,MB6,B]  984-18-1002ms  | [S4,MB7,B]  1075-18-1093ms | [S0,MB4,B]  1111-23-1134ms | [S0,MB5,B]  1154-23-1177ms | [S0,MB6,B]  1190-23-1213ms | [S0,MB7,B]  1230-23-1253ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  362-12-375ms   | [S5,MB1,B]  378-19-397ms   | [S1,MB6,F]  397-11-408ms   | [S5,MB2,B]  490-18-509ms   | [S1,MB7,F]  509-11-520ms   | [S5,MB3,B]  559-19-579ms   | [S5,MB4,F]  579-7-586ms    | [S1,MB0,B]  595-29-624ms   | [S5,MB5,F]  624-9-633ms    | [S1,MB1,B]  633-30-664ms   | [S5,MB6,F]  665-10-675ms   | [S1,MB2,B]  675-33-708ms   | [S5,MB7,F]  708-10-718ms   | [S1,MB3,B]  719-34-753ms   | [S5,MB4,B]  781-18-800ms   | [S5,MB5,B]  870-18-888ms   | [S5,MB6,B]  959-18-977ms   | [S5,MB7,B]  1050-18-1068ms | [S1,MB4,B]  1076-27-1104ms | [S1,MB5,B]  1119-28-1147ms | [S1,MB6,B]  1153-29-1182ms | [S1,MB7,B]  1189-30-1219ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-295ms   | [S6,MB3,F]  295-8-303ms    | [S6,MB1,B]  352-19-371ms   | [S2,MB4,F]  372-8-380ms    | [S6,MB2,B]  442-19-461ms   | [S2,MB5,F]  461-7-468ms    | [S6,MB3,B]  532-19-551ms   | [S2,MB6,F]  551-8-559ms    | [S2,MB0,B]  568-19-587ms   | [S2,MB7,F]  587-8-596ms    | [S2,MB1,B]  603-19-623ms   | [S6,MB4,F]  622-8-631ms    | [S2,MB2,B]  636-19-656ms   | [S6,MB5,F]  656-7-664ms    | [S2,MB3,B]  672-20-692ms   | [S6,MB6,F]  692-7-699ms    | [S6,MB4,B]  755-19-774ms   | [S6,MB7,F]  774-8-783ms    | [S6,MB5,B]  845-18-864ms   | [S6,MB6,B]  935-18-953ms   | [S6,MB7,B]  1026-18-1044ms | [S2,MB4,B]  1051-18-1069ms | [S2,MB5,B]  1094-18-1112ms | [S2,MB6,B]  1119-18-1138ms | [S2,MB7,B]  1153-18-1172ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-111ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  290-55-345ms   | [S7,MB2,F]  345-21-367ms   | [S7,MB2,B]  378-57-435ms   | [S7,MB3,F]  435-21-456ms   | [S7,MB3,B]  468-57-525ms   | [S3,MB4,F]  525-12-537ms   | [S3,MB0,B]  537-24-561ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  572-23-596ms   | [S3,MB6,F]  596-10-606ms   | [S3,MB2,B]  606-23-630ms   | [S3,MB7,F]  630-10-640ms   | [S3,MB3,B]  640-22-663ms   | [S7,MB4,F]  662-18-680ms   | [S7,MB4,B]  693-56-749ms   | [S7,MB5,F]  748-21-769ms   | [S7,MB5,B]  781-57-839ms   | [S7,MB6,F]  839-21-860ms   | [S7,MB6,B]  871-57-929ms   | [S7,MB7,F]  929-21-950ms   | [S7,MB7,B]  960-57-1018ms  | [S3,MB4,B]  1018-26-1044ms | [S3,MB5,B]  1044-24-1069ms | [S3,MB6,B]  1069-24-1094ms | [S3,MB7,B]  1094-23-1118ms
[rank0]:2025-12-24 20:04:32,473 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 20:04:37,489 - Avg. fwd time: 14.3342 / Avg. bwd time: 40.5259 / Avg. batch time: 1094.4202 (ms) / GPU bubble ratio: 19.80%
[rank2]:2025-12-24 20:04:37,538 - Avg. fwd time: 7.8100 / Avg. bwd time: 19.0007 / Avg. batch time: 1157.0767 (ms) / GPU bubble ratio: 62.93%
[rank0]:2025-12-24 20:04:37,616 - Avg. fwd time: 8.2884 / Avg. bwd time: 21.2389 / Avg. batch time: 1256.1359 (ms) / GPU bubble ratio: 62.39%
[rank1]:2025-12-24 20:04:37,580 - Avg. fwd time: 9.9505 / Avg. bwd time: 24.4702 / Avg. batch time: 1217.1218 (ms) / GPU bubble ratio: 54.75%
[rank1]:2025-12-24 20:04:37,641 -  step: 550  loss: -4.0000  grad_norm:  0.1781  memory: 18.49GiB(38.93%)  tps: 6,384  tflops: 49.91  mfu: 16.00%
[rank2]:2025-12-24 20:04:37,638 -  step: 550  loss: -4.0000  grad_norm:  0.1781  memory: 12.06GiB(25.39%)  tps: 6,384  tflops: 49.91  mfu: 16.00%
[rank3]:2025-12-24 20:04:37,650 -  step: 550  loss:  0.2199  grad_norm:  0.1781  memory: 29.23GiB(61.52%)  tps: 6,384  tflops: 49.91  mfu: 16.00%
[rank0]:2025-12-24 20:04:37,652 -  step: 550  loss: -4.0000  grad_norm:  0.1781  memory: 20.42GiB(42.99%)  tps: 6,384  tflops: 49.91  mfu: 16.00%
[rank0]:2025-12-24 20:08:48,598 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 20:08:53,669 - Avg. fwd time: 14.3310 / Avg. bwd time: 40.5197 / Avg. batch time: 1094.2657 (ms) / GPU bubble ratio: 19.80%
[rank2]:2025-12-24 20:08:53,719 - Avg. fwd time: 7.8090 / Avg. bwd time: 18.9985 / Avg. batch time: 1156.8877 (ms) / GPU bubble ratio: 62.92%
[rank1]:2025-12-24 20:08:53,761 - Avg. fwd time: 9.9490 / Avg. bwd time: 24.4688 / Avg. batch time: 1216.9295 (ms) / GPU bubble ratio: 54.75%
[rank0]:2025-12-24 20:08:53,798 - Avg. fwd time: 8.2878 / Avg. bwd time: 21.2387 / Avg. batch time: 1255.9435 (ms) / GPU bubble ratio: 62.38%
[rank2]:2025-12-24 20:08:53,820 -  step: 600  loss: -4.0000  grad_norm:  0.1779  memory: 12.06GiB(25.39%)  tps: 6,395  tflops: 50.00  mfu: 16.02%
[rank1]:2025-12-24 20:08:53,823 -  step: 600  loss: -4.0000  grad_norm:  0.1779  memory: 18.49GiB(38.93%)  tps: 6,395  tflops: 50.00  mfu: 16.02%
[rank3]:2025-12-24 20:08:53,832 -  step: 600  loss:  0.2128  grad_norm:  0.1779  memory: 29.23GiB(61.52%)  tps: 6,396  tflops: 50.00  mfu: 16.02%
[rank0]:2025-12-24 20:08:53,834 -  step: 600  loss: -4.0000  grad_norm:  0.1779  memory: 20.42GiB(42.99%)  tps: 6,395  tflops: 50.00  mfu: 16.02%
[rank3]:2025-12-24 20:08:54,080 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_2008_step600_rank3.svg
[rank3]:			> Batch Time: 1253.67 ms, GPU Bubble Ratio: 62.24%, 56.05%, 65.80%, 29.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-186ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  370-19-389ms   | [S0,MB7,F]  388-7-395ms    | [S4,MB1,B]  489-19-508ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  560-19-579ms   | [S4,MB5,F]  587-8-596ms    | [S4,MB3,B]  596-19-615ms   | [S4,MB6,F]  623-8-632ms    | [S0,MB0,B]  632-25-657ms   | [S4,MB7,F]  659-7-666ms    | [S0,MB1,B]  672-24-696ms   | [S0,MB2,B]  714-23-738ms   | [S0,MB3,B]  771-23-794ms   | [S4,MB4,B]  808-18-826ms   | [S4,MB5,B]  897-18-915ms   | [S4,MB6,B]  987-18-1005ms  | [S4,MB7,B]  1078-18-1096ms | [S0,MB4,B]  1113-23-1136ms | [S0,MB5,B]  1157-23-1180ms | [S0,MB6,B]  1193-23-1216ms | [S0,MB7,B]  1230-23-1253ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  305-10-316ms   | [S5,MB0,B]  316-18-335ms   | [S1,MB5,F]  363-12-375ms   | [S5,MB1,B]  378-18-397ms   | [S1,MB6,F]  397-11-409ms   | [S5,MB2,B]  489-18-508ms   | [S1,MB7,F]  508-11-519ms   | [S5,MB3,B]  559-19-579ms   | [S5,MB4,F]  579-7-587ms    | [S1,MB0,B]  596-29-625ms   | [S5,MB5,F]  625-9-634ms    | [S1,MB1,B]  634-30-664ms   | [S5,MB6,F]  665-10-675ms   | [S1,MB2,B]  675-32-707ms   | [S5,MB7,F]  707-10-718ms   | [S1,MB3,B]  718-33-752ms   | [S5,MB4,B]  783-18-802ms   | [S5,MB5,B]  872-18-891ms   | [S5,MB6,B]  962-18-980ms   | [S5,MB7,B]  1052-18-1070ms | [S1,MB4,B]  1078-27-1106ms | [S1,MB5,B]  1122-28-1150ms | [S1,MB6,B]  1156-30-1186ms | [S1,MB7,B]  1192-30-1222ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-192ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-295ms   | [S6,MB3,F]  295-8-304ms    | [S6,MB1,B]  353-19-372ms   | [S2,MB4,F]  372-8-381ms    | [S6,MB2,B]  442-19-462ms   | [S2,MB5,F]  462-7-469ms    | [S6,MB3,B]  531-19-551ms   | [S2,MB6,F]  551-8-559ms    | [S2,MB0,B]  568-19-587ms   | [S2,MB7,F]  587-8-596ms    | [S2,MB1,B]  603-19-623ms   | [S6,MB4,F]  623-8-631ms    | [S2,MB2,B]  638-19-658ms   | [S6,MB5,F]  657-7-665ms    | [S2,MB3,B]  672-20-692ms   | [S6,MB6,F]  692-7-699ms    | [S6,MB4,B]  757-19-776ms   | [S6,MB7,F]  776-8-785ms    | [S6,MB5,B]  847-18-866ms   | [S6,MB6,B]  938-18-956ms   | [S6,MB7,B]  1028-18-1046ms | [S2,MB4,B]  1054-18-1073ms | [S2,MB5,B]  1097-18-1115ms | [S2,MB6,B]  1122-18-1141ms | [S2,MB7,B]  1156-18-1175ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  260-18-279ms   | [S7,MB1,B]  290-56-346ms   | [S7,MB2,F]  346-21-367ms   | [S7,MB2,B]  379-57-437ms   | [S7,MB3,F]  436-21-457ms   | [S7,MB3,B]  467-57-525ms   | [S3,MB4,F]  525-11-537ms   | [S3,MB0,B]  537-24-562ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  572-23-596ms   | [S3,MB6,F]  596-10-607ms   | [S3,MB2,B]  607-23-631ms   | [S3,MB7,F]  631-10-641ms   | [S3,MB3,B]  641-22-664ms   | [S7,MB4,F]  664-18-683ms   | [S7,MB4,B]  694-55-750ms   | [S7,MB5,F]  750-21-772ms   | [S7,MB5,B]  783-57-840ms   | [S7,MB6,F]  841-21-863ms   | [S7,MB6,B]  874-57-932ms   | [S7,MB7,F]  931-21-953ms   | [S7,MB7,B]  964-57-1022ms  | [S3,MB4,B]  1021-25-1047ms | [S3,MB5,B]  1046-24-1071ms | [S3,MB6,B]  1071-24-1096ms | [S3,MB7,B]  1095-23-1119ms
[rank0]:2025-12-24 20:13:05,599 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 20:13:10,571 - Avg. fwd time: 14.3311 / Avg. bwd time: 40.5211 / Avg. batch time: 1094.2848 (ms) / GPU bubble ratio: 19.80%
[rank2]:2025-12-24 20:13:10,622 - Avg. fwd time: 7.8083 / Avg. bwd time: 18.9978 / Avg. batch time: 1156.9621 (ms) / GPU bubble ratio: 62.93%
[rank1]:2025-12-24 20:13:10,665 - Avg. fwd time: 9.9479 / Avg. bwd time: 24.4713 / Avg. batch time: 1217.0318 (ms) / GPU bubble ratio: 54.75%
[rank0]:2025-12-24 20:13:10,703 - Avg. fwd time: 8.2878 / Avg. bwd time: 21.2390 / Avg. batch time: 1256.0443 (ms) / GPU bubble ratio: 62.39%
[rank2]:2025-12-24 20:13:10,725 -  step: 650  loss: -4.0000  grad_norm:  0.1708  memory: 12.06GiB(25.39%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank1]:2025-12-24 20:13:10,728 -  step: 650  loss: -4.0000  grad_norm:  0.1708  memory: 18.49GiB(38.93%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank3]:2025-12-24 20:13:10,737 -  step: 650  loss:  0.2232  grad_norm:  0.1708  memory: 29.23GiB(61.52%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank0]:2025-12-24 20:13:10,740 -  step: 650  loss: -4.0000  grad_norm:  0.1708  memory: 20.42GiB(42.99%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank0]:2025-12-24 20:17:22,383 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 20:17:27,407 - Avg. fwd time: 7.8079 / Avg. bwd time: 18.9976 / Avg. batch time: 1156.9984 (ms) / GPU bubble ratio: 62.93%
[rank3]:2025-12-24 20:17:27,356 - Avg. fwd time: 14.3315 / Avg. bwd time: 40.5253 / Avg. batch time: 1094.3520 (ms) / GPU bubble ratio: 19.80%
[rank2]:2025-12-24 20:17:27,514 -  step: 700  loss: -4.0000  grad_norm:  0.1584  memory: 12.06GiB(25.39%)  tps: 6,380  tflops: 49.88  mfu: 15.99%
[rank1]:2025-12-24 20:17:27,454 - Avg. fwd time: 9.9473 / Avg. bwd time: 24.4751 / Avg. batch time: 1217.0967 (ms) / GPU bubble ratio: 54.75%
[rank1]:2025-12-24 20:17:27,517 -  step: 700  loss: -4.0000  grad_norm:  0.1584  memory: 18.49GiB(38.93%)  tps: 6,380  tflops: 49.88  mfu: 15.99%
[rank3]:2025-12-24 20:17:27,526 -  step: 700  loss:  0.1825  grad_norm:  0.1584  memory: 29.23GiB(61.52%)  tps: 6,380  tflops: 49.88  mfu: 15.99%
[rank0]:2025-12-24 20:17:27,492 - Avg. fwd time: 8.2871 / Avg. bwd time: 21.2390 / Avg. batch time: 1256.1079 (ms) / GPU bubble ratio: 62.39%
[rank0]:2025-12-24 20:17:27,528 -  step: 700  loss: -4.0000  grad_norm:  0.1584  memory: 20.42GiB(42.99%)  tps: 6,380  tflops: 49.88  mfu: 15.99%
[rank3]:2025-12-24 20:17:27,778 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_2017_step700_rank3.svg
[rank3]:			> Batch Time: 1252.55 ms, GPU Bubble Ratio: 62.18%, 55.95%, 65.72%, 29.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-179ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  370-19-389ms   | [S0,MB7,F]  389-7-396ms    | [S4,MB1,B]  491-19-510ms   | [S4,MB4,F]  552-8-560ms    | [S4,MB2,B]  561-19-580ms   | [S4,MB5,F]  589-8-597ms    | [S4,MB3,B]  597-19-616ms   | [S4,MB6,F]  623-8-631ms    | [S0,MB0,B]  633-25-658ms   | [S4,MB7,F]  658-7-666ms    | [S0,MB1,B]  672-24-696ms   | [S0,MB2,B]  714-23-738ms   | [S0,MB3,B]  770-23-794ms   | [S4,MB4,B]  808-18-826ms   | [S4,MB5,B]  897-18-915ms   | [S4,MB6,B]  986-18-1004ms  | [S4,MB7,B]  1078-18-1096ms | [S0,MB4,B]  1113-23-1136ms | [S0,MB5,B]  1157-23-1180ms | [S0,MB6,B]  1192-23-1215ms | [S0,MB7,B]  1229-23-1252ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  275-7-283ms    | [S1,MB4,F]  305-10-316ms   | [S5,MB0,B]  316-19-335ms   | [S1,MB5,F]  363-12-375ms   | [S5,MB1,B]  378-19-397ms   | [S1,MB6,F]  397-11-409ms   | [S5,MB2,B]  491-18-510ms   | [S1,MB7,F]  510-11-521ms   | [S5,MB3,B]  560-19-580ms   | [S5,MB4,F]  580-7-588ms    | [S1,MB0,B]  597-29-626ms   | [S5,MB5,F]  624-9-634ms    | [S1,MB1,B]  633-30-664ms   | [S5,MB6,F]  664-10-675ms   | [S1,MB2,B]  675-32-708ms   | [S5,MB7,F]  707-10-718ms   | [S1,MB3,B]  718-34-752ms   | [S5,MB4,B]  782-18-801ms   | [S5,MB5,B]  871-18-890ms   | [S5,MB6,B]  961-18-979ms   | [S5,MB7,B]  1052-18-1070ms | [S1,MB4,B]  1078-27-1106ms | [S1,MB5,B]  1121-28-1149ms | [S1,MB6,B]  1156-29-1185ms | [S1,MB7,B]  1191-30-1221ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  269-7-277ms    | [S6,MB0,B]  276-19-296ms   | [S6,MB3,F]  296-8-304ms    | [S6,MB1,B]  353-19-372ms   | [S2,MB4,F]  372-8-381ms    | [S6,MB2,B]  443-19-462ms   | [S2,MB5,F]  462-7-469ms    | [S6,MB3,B]  533-19-552ms   | [S2,MB6,F]  552-8-561ms    | [S2,MB0,B]  569-19-589ms   | [S2,MB7,F]  589-8-597ms    | [S2,MB1,B]  603-19-623ms   | [S6,MB4,F]  623-8-631ms    | [S2,MB2,B]  637-20-657ms   | [S6,MB5,F]  657-7-664ms    | [S2,MB3,B]  672-20-693ms   | [S6,MB6,F]  693-7-701ms    | [S6,MB4,B]  757-19-776ms   | [S6,MB7,F]  776-8-785ms    | [S6,MB5,B]  847-18-865ms   | [S6,MB6,B]  937-18-955ms   | [S6,MB7,B]  1028-18-1046ms | [S2,MB4,B]  1054-18-1072ms | [S2,MB5,B]  1097-18-1115ms | [S2,MB6,B]  1121-18-1139ms | [S2,MB7,B]  1156-18-1175ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  260-19-279ms   | [S7,MB1,B]  290-55-346ms   | [S7,MB2,F]  346-21-367ms   | [S7,MB2,B]  379-57-436ms   | [S7,MB3,F]  436-21-457ms   | [S7,MB3,B]  469-58-527ms   | [S3,MB4,F]  526-11-538ms   | [S3,MB0,B]  538-24-562ms   | [S3,MB5,F]  563-10-574ms   | [S3,MB1,B]  573-23-597ms   | [S3,MB6,F]  596-10-607ms   | [S3,MB2,B]  607-23-630ms   | [S3,MB7,F]  630-10-641ms   | [S3,MB3,B]  641-22-663ms   | [S7,MB4,F]  663-18-682ms   | [S7,MB4,B]  694-56-750ms   | [S7,MB5,F]  750-21-772ms   | [S7,MB5,B]  783-57-840ms   | [S7,MB6,F]  840-21-861ms   | [S7,MB6,B]  873-57-931ms   | [S7,MB7,F]  931-21-952ms   | [S7,MB7,B]  964-57-1022ms  | [S3,MB4,B]  1021-26-1047ms | [S3,MB5,B]  1047-24-1071ms | [S3,MB6,B]  1072-24-1097ms | [S3,MB7,B]  1096-23-1120ms
[rank0]:2025-12-24 20:21:39,252 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 20:21:44,267 - Avg. fwd time: 14.3284 / Avg. bwd time: 40.5277 / Avg. batch time: 1094.3377 (ms) / GPU bubble ratio: 19.80%
[rank1]:2025-12-24 20:21:44,363 - Avg. fwd time: 9.9471 / Avg. bwd time: 24.4792 / Avg. batch time: 1217.1600 (ms) / GPU bubble ratio: 54.75%
[rank2]:2025-12-24 20:21:44,318 - Avg. fwd time: 7.8077 / Avg. bwd time: 18.9981 / Avg. batch time: 1157.0386 (ms) / GPU bubble ratio: 62.93%
[rank3]:2025-12-24 20:21:44,435 -  step: 750  loss:  0.2188  grad_norm:  0.1905  memory: 29.23GiB(61.52%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank1]:2025-12-24 20:21:44,426 -  step: 750  loss: -4.0000  grad_norm:  0.1905  memory: 18.49GiB(38.93%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank0]:2025-12-24 20:21:44,401 - Avg. fwd time: 8.2867 / Avg. bwd time: 21.2392 / Avg. batch time: 1256.1698 (ms) / GPU bubble ratio: 62.39%
[rank0]:2025-12-24 20:21:44,438 -  step: 750  loss: -4.0000  grad_norm:  0.1905  memory: 20.42GiB(42.99%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank2]:2025-12-24 20:21:44,423 -  step: 750  loss: -4.0000  grad_norm:  0.1905  memory: 12.06GiB(25.39%)  tps: 6,377  tflops: 49.86  mfu: 15.98%
[rank0]:2025-12-24 20:25:56,023 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 20:26:01,097 - Avg. fwd time: 14.3279 / Avg. bwd time: 40.5315 / Avg. batch time: 1094.3862 (ms) / GPU bubble ratio: 19.80%
[rank1]:2025-12-24 20:26:01,192 - Avg. fwd time: 9.9472 / Avg. bwd time: 24.4834 / Avg. batch time: 1217.2016 (ms) / GPU bubble ratio: 54.74%
[rank0]:2025-12-24 20:26:01,232 - Avg. fwd time: 8.2862 / Avg. bwd time: 21.2388 / Avg. batch time: 1256.2089 (ms) / GPU bubble ratio: 62.39%
[rank2]:2025-12-24 20:26:01,147 - Avg. fwd time: 7.8076 / Avg. bwd time: 18.9981 / Avg. batch time: 1157.0537 (ms) / GPU bubble ratio: 62.93%
[rank1]:2025-12-24 20:26:01,256 -  step: 800  loss: -4.0000  grad_norm:  0.1833  memory: 18.49GiB(38.93%)  tps: 6,379  tflops: 49.87  mfu: 15.98%
[rank1]:2025-12-24 20:26:01,257 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1833  tps: 6,773  tflops: 52.95  mfu: 15.52%
[rank1]:2025-12-24 20:26:01,257 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 20:26:01,257 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 20:26:01,265 -  step: 800  loss:  0.2248  grad_norm:  0.1833  memory: 29.23GiB(61.52%)  tps: 6,379  tflops: 49.87  mfu: 15.98%
[rank3]:2025-12-24 20:26:01,266 - â„¹ï¸ final step: 800  loss:  0.2248  grad_norm:  0.1833  tps: 6,777  tflops: 52.98  mfu: 15.63%
[rank3]:2025-12-24 20:26:01,266 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 20:26:01,267 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 20:26:01,267 -  step: 800  loss: -4.0000  grad_norm:  0.1833  memory: 20.42GiB(42.99%)  tps: 6,379  tflops: 49.87  mfu: 15.98%
[rank0]:2025-12-24 20:26:01,267 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1833  tps: 6,774  tflops: 52.95  mfu: 15.53%
[rank0]:2025-12-24 20:26:01,267 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 20:26:01,268 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-24 20:26:01,253 -  step: 800  loss: -4.0000  grad_norm:  0.1833  memory: 12.06GiB(25.39%)  tps: 6,379  tflops: 49.87  mfu: 15.98%
[rank2]:2025-12-24 20:26:01,253 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1833  tps: 6,774  tflops: 52.95  mfu: 15.52%
[rank2]:2025-12-24 20:26:01,253 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 20:26:01,254 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 20:26:03,315 - Destroying the purge thread.
[rank0]:2025-12-24 20:26:03,290 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-24 20:26:03,315 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-24 20:26:03,315 - Destroying the purge thread.
[rank3]:2025-12-24 20:26:03,551 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_2026_final800_rank3.svg
[rank3]:			> Batch Time: 1255.56 ms, GPU Bubble Ratio: 62.28%, 56.00%, 65.80%, 29.77%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  369-19-388ms   | [S0,MB7,F]  388-7-395ms    | [S4,MB1,B]  490-19-509ms   | [S4,MB4,F]  552-8-560ms    | [S4,MB2,B]  561-19-580ms   | [S4,MB5,F]  588-8-596ms    | [S4,MB3,B]  596-19-615ms   | [S4,MB6,F]  623-8-631ms    | [S0,MB0,B]  632-25-657ms   | [S4,MB7,F]  659-7-666ms    | [S0,MB1,B]  672-24-696ms   | [S0,MB2,B]  715-23-738ms   | [S0,MB3,B]  771-23-794ms   | [S4,MB4,B]  808-18-826ms   | [S4,MB5,B]  897-18-915ms   | [S4,MB6,B]  988-18-1006ms  | [S4,MB7,B]  1079-18-1097ms | [S0,MB4,B]  1115-23-1138ms | [S0,MB5,B]  1159-23-1182ms | [S0,MB6,B]  1195-23-1218ms | [S0,MB7,B]  1232-23-1255ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  305-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  363-12-375ms   | [S5,MB1,B]  378-19-397ms   | [S1,MB6,F]  397-11-408ms   | [S5,MB2,B]  490-18-509ms   | [S1,MB7,F]  509-11-520ms   | [S5,MB3,B]  561-19-580ms   | [S5,MB4,F]  580-7-588ms    | [S1,MB0,B]  596-29-625ms   | [S5,MB5,F]  625-9-634ms    | [S1,MB1,B]  634-30-665ms   | [S5,MB6,F]  665-10-675ms   | [S1,MB2,B]  675-32-708ms   | [S5,MB7,F]  708-10-719ms   | [S1,MB3,B]  719-34-753ms   | [S5,MB4,B]  783-18-802ms   | [S5,MB5,B]  872-18-890ms   | [S5,MB6,B]  963-18-981ms   | [S5,MB7,B]  1054-18-1072ms | [S1,MB4,B]  1080-27-1108ms | [S1,MB5,B]  1123-28-1151ms | [S1,MB6,B]  1158-29-1187ms | [S1,MB7,B]  1194-30-1225ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-192ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-295ms   | [S6,MB3,F]  295-8-304ms    | [S6,MB1,B]  352-19-372ms   | [S2,MB4,F]  372-8-380ms    | [S6,MB2,B]  442-19-462ms   | [S2,MB5,F]  462-7-469ms    | [S6,MB3,B]  533-19-552ms   | [S2,MB6,F]  552-8-561ms    | [S2,MB0,B]  568-19-588ms   | [S2,MB7,F]  588-8-596ms    | [S2,MB1,B]  603-19-623ms   | [S6,MB4,F]  623-8-631ms    | [S2,MB2,B]  637-19-657ms   | [S6,MB5,F]  657-7-665ms    | [S2,MB3,B]  672-20-693ms   | [S6,MB6,F]  692-7-700ms    | [S6,MB4,B]  757-19-776ms   | [S6,MB7,F]  776-8-785ms    | [S6,MB5,B]  847-18-866ms   | [S6,MB6,B]  938-18-956ms   | [S6,MB7,B]  1030-18-1048ms | [S2,MB4,B]  1056-18-1075ms | [S2,MB5,B]  1098-18-1116ms | [S2,MB6,B]  1123-18-1142ms | [S2,MB7,B]  1158-18-1177ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  290-55-346ms   | [S7,MB2,F]  346-21-367ms   | [S7,MB2,B]  378-57-436ms   | [S7,MB3,F]  436-21-457ms   | [S7,MB3,B]  468-58-526ms   | [S3,MB4,F]  526-12-538ms   | [S3,MB0,B]  538-24-562ms   | [S3,MB5,F]  562-10-573ms   | [S3,MB1,B]  572-23-596ms   | [S3,MB6,F]  596-10-607ms   | [S3,MB2,B]  607-23-630ms   | [S3,MB7,F]  630-10-641ms   | [S3,MB3,B]  641-22-664ms   | [S7,MB4,F]  664-18-682ms   | [S7,MB4,B]  694-56-750ms   | [S7,MB5,F]  750-21-772ms   | [S7,MB5,B]  783-57-840ms   | [S7,MB6,F]  841-21-862ms   | [S7,MB6,B]  874-57-932ms   | [S7,MB7,F]  932-21-953ms   | [S7,MB7,B]  965-57-1023ms  | [S3,MB4,B]  1023-26-1049ms | [S3,MB5,B]  1049-24-1073ms | [S3,MB6,B]  1073-24-1098ms | [S3,MB7,B]  1098-23-1122ms
[rank2]:2025-12-24 20:26:03,600 - Process group destroyed
[rank1]:2025-12-24 20:26:03,702 - Process group destroyed
[rank3]:2025-12-24 20:26:03,788 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1/pipeline_schedule/251224_2026_thry_final800_rank3.svg
[rank3]:			> Batch Time: 577.68 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S4,MB0,F]  40-10-50ms     | [S4,MB1,F]  50-10-60ms     | [S4,MB2,F]  60-10-70ms     | [S4,MB3,F]  70-10-81ms     | [S0,MB4,F]  81-10-91ms     | [S0,MB5,F]  91-10-101ms    | [S0,MB6,F]  101-10-111ms   | [S4,MB0,B]  141-20-162ms   | [S0,MB7,F]  162-10-172ms   | [S4,MB1,B]  172-20-192ms   | [S4,MB4,F]  202-10-212ms   | [S4,MB2,B]  212-20-233ms   | [S4,MB5,F]  233-10-243ms   | [S4,MB3,B]  243-20-263ms   | [S4,MB6,F]  263-10-273ms   | [S0,MB0,B]  273-20-293ms   | [S4,MB7,F]  293-10-304ms   | [S0,MB1,B]  304-20-324ms   | [S0,MB2,B]  324-20-344ms   | [S0,MB3,B]  354-20-374ms   | [S4,MB4,B]  385-20-405ms   | [S4,MB5,B]  415-20-435ms   | [S4,MB6,B]  445-20-466ms   | [S4,MB7,B]  476-20-496ms   | [S0,MB4,B]  496-20-516ms   | [S0,MB5,B]  516-20-537ms   | [S0,MB6,B]  537-20-557ms   | [S0,MB7,B]  557-20-577ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB3,F]  40-10-50ms     | [S5,MB0,F]  50-10-60ms     | [S5,MB1,F]  60-10-70ms     | [S5,MB2,F]  70-10-81ms     | [S5,MB3,F]  81-10-91ms     | [S1,MB4,F]  91-10-101ms    | [S5,MB0,B]  121-20-141ms   | [S1,MB5,F]  141-10-152ms   | [S5,MB1,B]  152-20-172ms   | [S1,MB6,F]  172-10-182ms   | [S5,MB2,B]  182-20-202ms   | [S1,MB7,F]  202-10-212ms   | [S5,MB3,B]  212-20-233ms   | [S5,MB4,F]  233-10-243ms   | [S1,MB0,B]  243-20-263ms   | [S5,MB5,F]  263-10-273ms   | [S1,MB1,B]  273-20-293ms   | [S5,MB6,F]  293-10-304ms   | [S1,MB2,B]  304-20-324ms   | [S5,MB7,F]  324-10-334ms   | [S1,MB3,B]  334-20-354ms   | [S5,MB4,B]  364-20-385ms   | [S5,MB5,B]  395-20-415ms   | [S5,MB6,B]  425-20-445ms   | [S5,MB7,B]  456-20-476ms   | [S1,MB4,B]  476-20-496ms   | [S1,MB5,B]  496-20-516ms   | [S1,MB6,B]  516-20-537ms   | [S1,MB7,B]  537-20-557ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB2,F]  40-10-50ms     | [S2,MB3,F]  50-10-60ms     | [S6,MB0,F]  60-10-70ms     | [S6,MB1,F]  70-10-81ms     | [S6,MB2,F]  81-10-91ms     | [S6,MB0,B]  101-20-121ms   | [S6,MB3,F]  121-10-131ms   | [S6,MB1,B]  131-20-152ms   | [S2,MB4,F]  152-10-162ms   | [S6,MB2,B]  162-20-182ms   | [S2,MB5,F]  182-10-192ms   | [S6,MB3,B]  192-20-212ms   | [S2,MB6,F]  212-10-222ms   | [S2,MB0,B]  222-20-243ms   | [S2,MB7,F]  243-10-253ms   | [S2,MB1,B]  253-20-273ms   | [S6,MB4,F]  273-10-283ms   | [S2,MB2,B]  283-20-304ms   | [S6,MB5,F]  304-10-314ms   | [S2,MB3,B]  314-20-334ms   | [S6,MB6,F]  334-10-344ms   | [S6,MB4,B]  344-20-364ms   | [S6,MB7,F]  364-10-374ms   | [S6,MB5,B]  374-20-395ms   | [S6,MB6,B]  405-20-425ms   | [S6,MB7,B]  435-20-456ms   | [S2,MB4,B]  456-20-476ms   | [S2,MB5,B]  476-20-496ms   | [S2,MB6,B]  496-20-516ms   | [S2,MB7,B]  516-20-537ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB1,F]  40-10-50ms     | [S3,MB2,F]  50-10-60ms     | [S3,MB3,F]  60-10-70ms     | [S7,MB0,F]  70-10-81ms     | [S7,MB0,B]  81-20-101ms    | [S7,MB1,F]  101-10-111ms   | [S7,MB1,B]  111-20-131ms   | [S7,MB2,F]  131-10-141ms   | [S7,MB2,B]  141-20-162ms   | [S7,MB3,F]  162-10-172ms   | [S7,MB3,B]  172-20-192ms   | [S3,MB4,F]  192-10-202ms   | [S3,MB0,B]  202-20-222ms   | [S3,MB5,F]  222-10-233ms   | [S3,MB1,B]  233-20-253ms   | [S3,MB6,F]  253-10-263ms   | [S3,MB2,B]  263-20-283ms   | [S3,MB7,F]  283-10-293ms   | [S3,MB3,B]  293-20-314ms   | [S7,MB4,F]  314-10-324ms   | [S7,MB4,B]  324-20-344ms   | [S7,MB5,F]  344-10-354ms   | [S7,MB5,B]  354-20-374ms   | [S7,MB6,F]  374-10-385ms   | [S7,MB6,B]  385-20-405ms   | [S7,MB7,F]  405-10-415ms   | [S7,MB7,B]  415-20-435ms   | [S3,MB4,B]  435-20-456ms   | [S3,MB5,B]  456-20-476ms   | [S3,MB6,B]  476-20-496ms   | [S3,MB7,B]  496-20-516ms  
[rank3]:2025-12-24 20:26:03,789 - Destroying the purge thread.
[rank3]:wandb: uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.83539
[rank3]:wandb:               final/avg_loss 0.22479
[rank3]:wandb:             final/avg_mfu(%) 15.63379
[rank3]:wandb:             final/avg_tflops 52.97715
[rank3]:wandb:    final/avg_throughput(tps) 6776.70357
[rank3]:wandb:              final/grad_norm 0.18332
[rank3]:wandb:               final/max_loss 0.22479
[rank3]:wandb:                    grad_norm 0.18332
[rank3]:wandb: loss_metrics/global_avg_loss 0.22479
[rank3]:wandb: loss_metrics/global_max_loss 0.22479
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_Interleaved1F1B_nofreeze_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ac1cb8ft
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_nofreeze_42_dm1/20251224-1917/wandb/run-20251224_191730-ac1cb8ft/logs
[rank0]:2025-12-24 20:26:05,315 - Training completed
[rank0]:2025-12-24 20:26:05,315 - Destroying the purge thread.
[rank3]:2025-12-24 20:26:05,604 - Process group destroyed
[rank0]:2025-12-24 20:26:05,725 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_Interleaved1F1B_nofreeze_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
