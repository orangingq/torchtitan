
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 03:15:09 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_Interleaved1F1B_timelyauto_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with timelyauto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-31 03:15:15,655 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank1]:2025-12-31 03:15:15,806 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank0]:2025-12-31 03:15:15,874 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 03:15:15,876 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 03:15:15,879 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 03:15:15,881 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-31 03:15:15,889 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank3]:2025-12-31 03:15:15,948 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank1]:2025-12-31 03:15:16,141 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 03:15:16,143 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 03:15:16,306 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-31 03:15:16,301 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 03:15:16,304 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-31 03:15:16,363 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 03:15:16,365 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 03:15:19,748 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-31 03:15:19,784 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 03:15:19,823 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 03:15:19,899 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 03:15:19,851 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-31 03:15:19,864 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-31 03:15:19,866 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-31 03:15:19,937 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 03:15:19,938 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 03:15:19,964 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-31 03:15:19,976 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-31 03:15:19,978 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-31 03:15:20,105 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 03:15:20,070 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 03:15:20,071 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 03:15:20,071 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-31 03:15:20,167 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 03:15:20,167 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 03:15:20,168 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-31 03:15:20,146 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 03:15:20,175 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-31 03:15:20,188 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-31 03:15:20,189 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-31 03:15:20,376 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 03:15:20,376 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 03:15:20,377 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run k4z2ts7c
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_timelyauto_22_dm1/20251231-0315/wandb/run-20251231_031520-k4z2ts7c
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/k4z2ts7c
[rank3]:2025-12-31 03:15:22,144 - WandB logging enabled
[rank3]:2025-12-31 03:15:22,145 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 03:15:22,183 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 03:15:22,210 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-31 03:15:22,223 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-31 03:15:22,225 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-12-31 03:15:22,414 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 03:15:22,432 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:2025-12-31 03:15:22,415 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 03:15:22,416 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-31 03:15:22,432 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 03:15:22,433 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 03:15:22,433 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank1]:2025-12-31 03:15:22,433 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-31 03:15:22,433 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 03:15:22,433 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-31 03:15:24,916 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 03:15:24,916 - Finished loading the checkpoint in 2.48 seconds.
[rank0]:2025-12-31 03:15:24,917 - Training starts at step 1
[rank1]:2025-12-31 03:15:30,523 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 16.23GiB(34.16%)  tps: 3,158  tflops: 24.69  mfu: 7.91%
[rank1]:2025-12-31 03:15:30,523 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 03:15:30,532 -  step:  1  loss: 10.6092  grad_norm: 203.0657  memory: 25.52GiB(53.71%)  tps: 3,926  tflops: 30.69  mfu: 9.84%
[rank3]:2025-12-31 03:15:30,533 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 03:15:30,521 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 10.24GiB(21.56%)  tps: 3,063  tflops: 23.95  mfu: 7.68%
[rank2]:2025-12-31 03:15:30,521 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 03:15:30,561 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 16.58GiB(34.89%)  tps: 3,085  tflops: 24.11  mfu: 7.73%
[rank0]:2025-12-31 03:15:30,561 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 03:19:35,627 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 03:19:40,568 - Avg. fwd time: 14.3296 / Avg. bwd time: 40.3267 / Avg. batch time: 1089.7211 (ms) / GPU bubble ratio: 19.75%
[rank1]:2025-12-31 03:19:40,658 - Avg. fwd time: 9.8176 / Avg. bwd time: 24.0322 / Avg. batch time: 1209.6008 (ms) / GPU bubble ratio: 55.23%
[rank2]:2025-12-31 03:19:40,617 - Avg. fwd time: 7.7439 / Avg. bwd time: 18.7268 / Avg. batch time: 1150.3153 (ms) / GPU bubble ratio: 63.18%
[rank3]:2025-12-31 03:19:40,723 -  step: 50  loss:  9.8859  grad_norm: 23.9599  memory: 29.23GiB(61.52%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank0]:2025-12-31 03:19:40,690 - Avg. fwd time: 8.3422 / Avg. bwd time: 21.2743 / Avg. batch time: 1248.5352 (ms) / GPU bubble ratio: 62.05%
[rank0]:2025-12-31 03:19:40,727 -  step: 50  loss: -4.0000  grad_norm: 23.9599  memory: 20.42GiB(42.99%)  tps: 6,418  tflops: 50.18  mfu: 16.08%
[rank1]:2025-12-31 03:19:40,715 -  step: 50  loss: -4.0000  grad_norm: 23.9599  memory: 18.49GiB(38.93%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank2]:2025-12-31 03:19:40,711 -  step: 50  loss: -4.0000  grad_norm: 23.9599  memory: 12.06GiB(25.39%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank3]:2025-12-31 03:20:26,301 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-31 03:21:17,289 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-31 03:21:17,780 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-31 03:21:17,754 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-31 03:21:17,722 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-31 03:22:08,537 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-31 03:22:09,087 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-31 03:23:22,768 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-31 03:23:23,165 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 03:23:23,193 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.20/0.20, [MB4] 0.37/0.37, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-31 03:23:23,192 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-31 03:23:23,192 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.52/0.52, [MB4] 1.00/1.00, [MB5] 0.97/0.97, [MB6] 0.76/0.76, [MB7] 1.00/1.00
[rank3]:2025-12-31 03:23:23,422 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0323_max_batch_time.svg
[rank3]:			> Batch Time: 1005.18 ms, GPU Bubble Ratio: 52.53%, 45.76%, 57.63%, 12.15%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-64ms      | [S4,MB3,F]  67-8-75ms      | [S0,MB4,F]  75-8-83ms      | [S0,MB5,F]  83-7-91ms      | [S0,MB6,F]  91-8-100ms     | [S4,MB0,B]  176-19-195ms   | [S0,MB7,F]  195-7-202ms    | [S4,MB1,B]  252-19-271ms   | [S4,MB4,F]  383-8-391ms    | [S4,MB2,B]  391-19-411ms   | [S4,MB5,F]  419-8-427ms    | [S4,MB3,B]  427-19-447ms   | [S4,MB6,F]  453-9-462ms    | [S0,MB0,B]  462-25-487ms   | [S4,MB7,F]  487-8-495ms    | [S0,MB1,B]  495-24-520ms   | [S0,MB2,B]  538-24-563ms   | [S0,MB3,B]  583-23-607ms   | [S4,MB4,B]  624-18-643ms   | [S4,MB5,B]  701-18-719ms   | [S4,MB6,B]  779-18-797ms   | [S4,MB7,B]  858-18-877ms   | [S0,MB4,B]  894-23-918ms   | [S0,MB5,B]  922-23-945ms   | [S0,MB6,B]  950-23-974ms   | [S0,MB7,B]  981-23-1005ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-68ms      | [S5,MB2,F]  68-7-75ms      | [S5,MB3,F]  75-7-82ms      | [S1,MB4,F]  83-10-94ms     | [S5,MB0,B]  157-18-176ms   | [S1,MB5,F]  176-12-188ms   | [S5,MB1,B]  233-18-252ms   | [S1,MB6,F]  252-11-263ms   | [S5,MB2,B]  311-18-330ms   | [S1,MB7,F]  330-11-341ms   | [S5,MB3,B]  390-19-410ms   | [S5,MB4,F]  410-7-417ms    | [S1,MB0,B]  427-28-456ms   | [S5,MB5,F]  456-9-465ms    | [S1,MB1,B]  465-30-495ms   | [S5,MB6,F]  495-10-505ms   | [S1,MB2,B]  505-32-538ms   | [S5,MB7,F]  538-10-549ms   | [S1,MB3,B]  549-34-583ms   | [S5,MB4,B]  606-18-624ms   | [S5,MB5,B]  683-18-701ms   | [S5,MB6,B]  761-17-779ms   | [S5,MB7,B]  840-18-858ms   | [S1,MB4,B]  867-27-894ms   | [S1,MB5,B]  894-27-922ms   | [S1,MB6,B]  922-28-950ms   | [S1,MB7,B]  950-30-981ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  31-6-38ms      | [S2,MB2,F]  42-6-49ms      | [S2,MB3,F]  53-6-59ms      | [S6,MB0,F]  61-7-68ms      | [S6,MB1,F]  68-6-75ms      | [S6,MB2,F]  75-6-82ms      | [S6,MB0,B]  138-19-157ms   | [S6,MB3,F]  157-8-166ms    | [S6,MB1,B]  213-20-233ms   | [S2,MB4,F]  233-8-242ms    | [S6,MB2,B]  292-19-311ms   | [S2,MB5,F]  311-7-319ms    | [S6,MB3,B]  371-19-390ms   | [S2,MB6,F]  390-8-399ms    | [S2,MB0,B]  408-19-427ms   | [S2,MB7,F]  427-8-436ms    | [S2,MB1,B]  442-19-462ms   | [S6,MB4,F]  462-8-471ms    | [S2,MB2,B]  476-19-496ms   | [S6,MB5,F]  496-7-504ms    | [S2,MB3,B]  510-19-529ms   | [S6,MB6,F]  529-7-537ms    | [S6,MB4,B]  585-20-606ms   | [S6,MB7,F]  606-8-614ms    | [S6,MB5,B]  664-18-683ms   | [S6,MB6,B]  743-17-761ms   | [S6,MB7,B]  822-17-840ms   | [S2,MB4,B]  849-17-867ms   | [S2,MB5,B]  873-17-891ms   | [S2,MB6,B]  898-17-916ms   | [S2,MB7,B]  922-17-940ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  38-7-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  59-7-67ms      | [S7,MB0,F]  68-15-84ms     | [S7,MB0,B]  84-53-138ms    AFR(10):0.9091 | [S7,MB1,F]  138-19-157ms   | [S7,MB1,B]  157-55-213ms   AFR(10):0.9091 | [S7,MB2,F]  213-21-234ms   | [S7,MB2,B]  234-58-292ms   AFR(10):0.9091 | [S7,MB3,F]  292-21-313ms   | [S7,MB3,B]  313-57-371ms   AFR(10):0.9091 | [S3,MB4,F]  371-11-383ms   | [S3,MB0,B]  383-24-408ms   AFR(10):1.0000 | [S3,MB5,F]  408-10-419ms   | [S3,MB1,B]  419-23-442ms   AFR(10):1.0000 | [S3,MB6,F]  442-10-453ms   | [S3,MB2,B]  453-23-476ms   AFR(10):1.0000 | [S3,MB7,F]  476-10-487ms   | [S3,MB3,B]  487-22-510ms   AFR(10):1.0000 | [S7,MB4,F]  510-18-528ms   | [S7,MB4,B]  528-56-585ms   AFR(10):0.9091 | [S7,MB5,F]  585-21-607ms   | [S7,MB5,B]  607-57-664ms   AFR(10):0.9091 | [S7,MB6,F]  664-21-686ms   | [S7,MB6,B]  686-57-743ms   AFR(10):0.9091 | [S7,MB7,F]  743-21-765ms   | [S7,MB7,B]  765-57-822ms   AFR(10):0.9091 | [S3,MB4,B]  822-26-849ms   AFR(10):1.0000 | [S3,MB5,B]  849-24-873ms   AFR(10):1.0000 | [S3,MB6,B]  873-24-898ms   AFR(10):1.0000 | [S3,MB7,B]  898-23-922ms   AFR(10):1.0000
[rank3]:2025-12-31 03:23:23,645 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0323_min_batch_time.svg
[rank3]:			> Batch Time: 684.69 ms, GPU Bubble Ratio: 69.17%, 48.87%, 58.76%, 9.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-64ms      | [S4,MB3,F]  67-8-75ms      | [S0,MB4,F]  75-8-83ms      | [S0,MB5,F]  83-7-91ms      | [S0,MB6,F]  91-8-100ms     | [S4,MB0,B]  136-10-146ms   | [S0,MB7,F]  146-7-153ms    | [S4,MB1,B]  189-10-199ms   | [S4,MB4,F]  291-8-300ms    | [S4,MB2,B]  300-9-310ms    | [S4,MB5,F]  314-8-323ms    | [S4,MB3,B]  323-9-333ms    | [S4,MB6,F]  338-9-347ms    | [S0,MB0,B]  347-0-347ms    | [S4,MB7,F]  361-8-369ms    | [S0,MB1,B]  369-0-369ms    | [S0,MB2,B]  381-0-381ms    | [S0,MB3,B]  406-0-406ms    | [S4,MB4,B]  447-9-456ms    | [S4,MB5,B]  500-9-510ms    | [S4,MB6,B]  555-9-564ms    | [S4,MB7,B]  625-9-634ms    | [S0,MB4,B]  643-0-643ms    | [S0,MB5,B]  657-0-657ms    | [S0,MB6,B]  670-0-670ms    | [S0,MB7,B]  684-0-684ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-68ms      | [S5,MB2,F]  68-7-75ms      | [S5,MB3,F]  75-7-82ms      | [S1,MB4,F]  83-10-94ms     | [S5,MB0,B]  126-9-136ms    | [S1,MB5,F]  136-12-148ms   | [S5,MB1,B]  180-9-189ms    | [S1,MB6,F]  189-11-200ms   | [S5,MB2,B]  234-9-243ms    | [S1,MB7,F]  243-11-254ms   | [S5,MB3,B]  289-10-300ms   | [S5,MB4,F]  300-7-308ms    | [S1,MB0,B]  314-15-330ms   | [S5,MB5,F]  330-9-339ms    | [S1,MB1,B]  339-15-354ms   | [S5,MB6,F]  354-10-365ms   | [S1,MB2,B]  365-15-381ms   | [S5,MB7,F]  381-10-391ms   | [S1,MB3,B]  391-14-406ms   | [S5,MB4,B]  438-9-447ms    | [S5,MB5,B]  491-9-500ms    | [S5,MB6,B]  546-9-555ms    | [S5,MB7,B]  616-9-625ms    | [S1,MB4,B]  629-13-643ms   | [S1,MB5,B]  643-13-657ms   | [S1,MB6,B]  657-13-670ms   | [S1,MB7,B]  670-13-684ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  31-6-38ms      | [S2,MB2,F]  42-6-49ms      | [S2,MB3,F]  53-6-59ms      | [S6,MB0,F]  61-7-68ms      | [S6,MB1,F]  68-6-75ms      | [S6,MB2,F]  75-6-82ms      | [S6,MB0,B]  116-10-126ms   | [S6,MB3,F]  126-8-135ms    | [S6,MB1,B]  168-11-180ms   | [S2,MB4,F]  180-8-188ms    | [S6,MB2,B]  223-10-234ms   | [S2,MB5,F]  234-7-241ms    | [S6,MB3,B]  279-10-289ms   | [S2,MB6,F]  289-8-298ms    | [S2,MB0,B]  303-10-314ms   | [S2,MB7,F]  314-8-323ms    | [S2,MB1,B]  327-10-338ms   | [S6,MB4,F]  338-8-346ms    | [S2,MB2,B]  350-10-361ms   | [S6,MB5,F]  361-7-369ms    | [S2,MB3,B]  374-9-384ms    | [S6,MB6,F]  384-7-391ms    | [S6,MB4,B]  426-11-438ms   | [S6,MB7,F]  438-8-446ms    | [S6,MB5,B]  481-9-491ms    | [S6,MB6,B]  537-8-546ms    | [S6,MB7,B]  607-8-616ms    | [S2,MB4,B]  620-8-629ms    | [S2,MB5,B]  633-8-642ms    | [S2,MB6,B]  645-8-654ms    | [S2,MB7,B]  658-8-667ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  38-7-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  59-7-67ms      | [S7,MB0,F]  68-15-84ms     | [S7,MB0,B]  84-32-116ms    AFR(10):0.9091 | [S7,MB1,F]  116-19-135ms   | [S7,MB1,B]  135-33-168ms   AFR(10):0.9091 | [S7,MB2,F]  168-21-190ms   | [S7,MB2,B]  190-33-223ms   AFR(10):0.9091 | [S7,MB3,F]  223-21-245ms   | [S7,MB3,B]  245-34-279ms   AFR(10):0.9091 | [S3,MB4,F]  279-11-291ms   | [S3,MB0,B]  291-12-303ms   AFR(10):1.0000 | [S3,MB5,F]  303-10-314ms   | [S3,MB1,B]  314-12-327ms   AFR(10):1.0000 | [S3,MB6,F]  327-10-338ms   | [S3,MB2,B]  338-12-350ms   AFR(10):1.0000 | [S3,MB7,F]  350-10-361ms   | [S3,MB3,B]  361-12-374ms   AFR(10):1.0000 | [S7,MB4,F]  374-18-392ms   | [S7,MB4,B]  392-33-426ms   AFR(10):0.9091 | [S7,MB5,F]  426-21-447ms   | [S7,MB5,B]  447-34-481ms   AFR(10):0.9091 | [S7,MB6,F]  481-21-503ms   | [S7,MB6,B]  503-33-537ms   AFR(10):0.9091 | [S7,MB7,F]  537-21-558ms   | [S7,MB7,B]  558-48-607ms   AFR(10):0.9091 | [S3,MB4,B]  607-13-620ms   AFR(10):1.0000 | [S3,MB5,B]  620-13-633ms   AFR(10):1.0000 | [S3,MB6,B]  633-12-645ms   AFR(10):1.0000 | [S3,MB7,B]  645-12-658ms   AFR(10):1.0000
[rank3]:2025-12-31 03:23:23,884 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0323_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 719.96 ms, GPU Bubble Ratio: 41.79%, 33.71%, 46.15%, 8.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-64ms      | [S4,MB3,F]  67-8-75ms      | [S0,MB4,F]  75-8-83ms      | [S0,MB5,F]  83-7-91ms      | [S0,MB6,F]  91-8-100ms     | [S4,MB0,B]  167-19-186ms   | [S0,MB7,F]  186-7-194ms    | [S4,MB1,B]  220-19-240ms   | [S4,MB4,F]  304-8-313ms    | [S4,MB2,B]  313-19-332ms   | [S4,MB5,F]  332-8-341ms    | [S4,MB3,B]  341-19-360ms   | [S4,MB6,F]  360-9-369ms    | [S0,MB0,B]  369-25-394ms   | [S4,MB7,F]  394-8-403ms    | [S0,MB1,B]  407-24-432ms   | [S0,MB2,B]  451-24-475ms   | [S0,MB3,B]  495-23-519ms   | [S4,MB4,B]  519-18-538ms   | [S4,MB5,B]  544-18-562ms   | [S4,MB6,B]  598-18-617ms   | [S4,MB7,B]  664-16-681ms   | [S0,MB4,B]  681-15-696ms   | [S0,MB5,B]  696-23-719ms   | [S0,MB6,B]  719-0-719ms    | [S0,MB7,B]  719-0-719ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-68ms      | [S5,MB2,F]  68-7-75ms      | [S5,MB3,F]  75-7-82ms      | [S1,MB4,F]  83-10-94ms     | [S5,MB0,B]  148-18-167ms   | [S1,MB5,F]  167-12-180ms   | [S5,MB1,B]  202-18-220ms   | [S1,MB6,F]  220-11-232ms   | [S5,MB2,B]  255-18-274ms   | [S1,MB7,F]  274-11-285ms   | [S5,MB3,B]  311-19-331ms   | [S5,MB4,F]  331-7-338ms    | [S1,MB0,B]  339-28-368ms   | [S5,MB5,F]  368-9-377ms    | [S1,MB1,B]  377-30-407ms   | [S5,MB6,F]  407-10-418ms   | [S1,MB2,B]  418-32-451ms   | [S5,MB7,F]  451-10-461ms   | [S1,MB3,B]  461-34-495ms   | [S5,MB4,B]  495-18-514ms   | [S5,MB5,B]  526-18-544ms   | [S5,MB6,B]  581-17-598ms   | [S5,MB7,B]  655-9-664ms    | [S1,MB4,B]  664-13-678ms   | [S1,MB5,B]  678-13-692ms   | [S1,MB6,B]  692-13-706ms   | [S1,MB7,B]  706-13-719ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  31-6-38ms      | [S2,MB2,F]  42-6-49ms      | [S2,MB3,F]  53-6-59ms      | [S6,MB0,F]  61-7-68ms      | [S6,MB1,F]  68-6-75ms      | [S6,MB2,F]  75-6-82ms      | [S6,MB0,B]  129-19-148ms   | [S6,MB3,F]  148-8-157ms    | [S6,MB1,B]  181-20-202ms   | [S2,MB4,F]  202-8-210ms    | [S6,MB2,B]  236-19-255ms   | [S2,MB5,F]  255-7-263ms    | [S6,MB3,B]  292-19-311ms   | [S2,MB6,F]  311-8-320ms    | [S2,MB0,B]  320-19-339ms   | [S2,MB7,F]  339-8-348ms    | [S2,MB1,B]  348-19-368ms   | [S6,MB4,F]  368-8-376ms    | [S2,MB2,B]  376-19-396ms   | [S6,MB5,F]  396-7-403ms    | [S2,MB3,B]  403-19-423ms   | [S6,MB6,F]  423-7-430ms    | [S6,MB4,B]  452-20-473ms   | [S6,MB7,F]  473-8-481ms    | [S6,MB5,B]  508-18-526ms   | [S6,MB6,B]  563-17-581ms   | [S6,MB7,B]  642-13-655ms   | [S2,MB4,B]  655-8-664ms    | [S2,MB5,B]  669-9-678ms    | [S2,MB6,B]  681-11-692ms   | [S2,MB7,B]  697-8-706ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  38-7-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  59-7-67ms      | [S7,MB0,F]  68-15-84ms     | [S7,MB0,B]  84-45-129ms    AFR(10):0.9091 | [S7,MB1,F]  129-19-148ms   | [S7,MB1,B]  148-33-181ms   AFR(10):0.9091 | [S7,MB2,F]  181-21-203ms   | [S7,MB2,B]  203-33-236ms   AFR(10):0.9091 | [S7,MB3,F]  236-21-257ms   | [S7,MB3,B]  257-34-292ms   AFR(10):0.9091 | [S3,MB4,F]  292-11-304ms   | [S3,MB0,B]  304-12-316ms   AFR(10):1.0000 | [S3,MB5,F]  316-10-327ms   | [S3,MB1,B]  327-12-340ms   AFR(10):1.0000 | [S3,MB6,F]  340-10-351ms   | [S3,MB2,B]  351-16-367ms   AFR(10):1.0000 | [S3,MB7,F]  367-10-377ms   | [S3,MB3,B]  377-22-400ms   AFR(10):1.0000 | [S7,MB4,F]  400-18-419ms   | [S7,MB4,B]  419-33-452ms   AFR(10):0.9091 | [S7,MB5,F]  452-21-473ms   | [S7,MB5,B]  473-34-508ms   AFR(10):0.9091 | [S7,MB6,F]  508-21-529ms   | [S7,MB6,B]  529-33-563ms   AFR(10):0.9091 | [S7,MB7,F]  563-21-584ms   | [S7,MB7,B]  584-57-642ms   AFR(10):0.9091 | [S3,MB4,B]  642-13-655ms   AFR(10):1.0000 | [S3,MB5,B]  655-13-669ms   AFR(10):1.0000 | [S3,MB6,B]  669-12-681ms   AFR(10):1.0000 | [S3,MB7,B]  681-15-697ms   AFR(10):1.0000
[rank3]:2025-12-31 03:23:23,884 - 	> Batch Time: 719.96 ms (Average Freeze Ratio: 0.38, Time Reduction Rate: 0.28)
[rank3]:2025-12-31 03:23:23,888 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.69/0.69, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.71/0.71
[rank3]:2025-12-31 03:23:27,745 - Avg. fwd time: 13.9919 / Avg. bwd time: 36.9227 / Avg. batch time: 1031.8228 (ms) / GPU bubble ratio: 21.05%
[rank2]:2025-12-31 03:23:27,780 - Avg. fwd time: 7.7111 / Avg. bwd time: 16.9705 / Avg. batch time: 1090.9252 (ms) / GPU bubble ratio: 63.80%
[rank3]:2025-12-31 03:23:27,851 -  step: 100  loss:  8.9360  grad_norm:  7.1066  memory: 29.23GiB(61.52%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank0]:2025-12-31 03:23:27,817 - Avg. fwd time: 8.3267 / Avg. bwd time: 17.9802 / Avg. batch time: 1179.6528 (ms) / GPU bubble ratio: 64.32%
[rank0]:2025-12-31 03:23:27,853 -  step: 100  loss: -4.0000  grad_norm:  7.1066  memory: 20.42GiB(42.99%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank1]:2025-12-31 03:23:27,808 - Avg. fwd time: 9.7801 / Avg. bwd time: 21.6365 / Avg. batch time: 1145.6593 (ms) / GPU bubble ratio: 56.12%
[rank1]:2025-12-31 03:23:27,842 -  step: 100  loss: -4.0000  grad_norm:  7.1066  memory: 18.49GiB(38.93%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank2]:2025-12-31 03:23:27,838 -  step: 100  loss: -4.0000  grad_norm:  7.1066  memory: 12.06GiB(25.39%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank0]:2025-12-31 03:23:27,911 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0323_stage0_step100.svg
[rank0]:2025-12-31 03:23:27,949 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0323_stage4_step100.svg
[rank1]:2025-12-31 03:23:27,911 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0323_stage1_step100.svg
[rank1]:2025-12-31 03:23:27,949 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0323_stage5_step100.svg
[rank2]:2025-12-31 03:23:27,913 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0323_stage2_step100.svg
[rank2]:2025-12-31 03:23:27,951 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0323_stage6_step100.svg
[rank0]:2025-12-31 03:23:28,052 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank0_stage0.svg
[rank0]:	> Counts Sum: 12160, Total Sum: 12160 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-31 03:23:28,075 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank1_stage1.svg
[rank1]:	> Counts Sum: 17280, Total Sum: 17280 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-31 03:23:28,053 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank2_stage2.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-31 03:23:28,081 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0323_step100_rank3.svg
[rank3]:			> Batch Time: 896.00 ms, GPU Bubble Ratio: 76.60%, 61.34%, 68.74%, 36.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-193ms    | [S4,MB0,B]  323-10-333ms   | [S0,MB7,F]  333-7-340ms    | [S4,MB1,B]  411-10-421ms   | [S4,MB4,F]  449-8-457ms    | [S4,MB2,B]  457-9-467ms    | [S4,MB5,F]  478-8-487ms    | [S4,MB3,B]  487-9-497ms    | [S4,MB6,F]  507-8-515ms    | [S0,MB0,B]  515-0-515ms    | [S4,MB7,F]  535-7-542ms    | [S0,MB1,B]  542-0-542ms    | [S0,MB2,B]  562-0-562ms    | [S0,MB3,B]  607-0-607ms    | [S4,MB4,B]  626-9-635ms    | [S4,MB5,B]  696-9-705ms    | [S4,MB6,B]  758-9-767ms    | [S4,MB7,B]  811-9-820ms    | [S0,MB4,B]  831-0-831ms    | [S0,MB5,B]  856-0-856ms    | [S0,MB6,B]  876-0-876ms    | [S0,MB7,B]  896-0-896ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  253-7-260ms    | [S1,MB4,F]  273-10-284ms   | [S5,MB0,B]  284-9-293ms    | [S1,MB5,F]  316-12-329ms   | [S5,MB1,B]  329-9-338ms    | [S1,MB6,F]  338-11-349ms   | [S5,MB2,B]  410-9-420ms    | [S1,MB7,F]  420-10-431ms   | [S5,MB3,B]  457-10-467ms   | [S5,MB4,F]  468-7-475ms    | [S1,MB0,B]  486-15-501ms   | [S5,MB5,F]  501-8-509ms    | [S1,MB1,B]  514-15-530ms   | [S5,MB6,F]  530-8-539ms    | [S1,MB2,B]  539-15-555ms   | [S5,MB7,F]  555-9-565ms    | [S1,MB3,B]  565-14-580ms   | [S5,MB4,B]  610-9-619ms    | [S5,MB5,B]  669-9-678ms    | [S5,MB6,B]  729-9-738ms    | [S5,MB7,B]  795-9-804ms    | [S1,MB4,B]  810-13-824ms   | [S1,MB5,B]  836-13-850ms   | [S1,MB6,B]  856-13-870ms   | [S1,MB7,B]  875-13-889ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  246-6-253ms    | [S6,MB0,B]  253-10-263ms   | [S6,MB3,F]  263-8-272ms    | [S6,MB1,B]  304-11-315ms   | [S2,MB4,F]  315-8-324ms    | [S6,MB2,B]  366-10-376ms   | [S2,MB5,F]  376-7-383ms    | [S6,MB3,B]  430-10-441ms   | [S2,MB6,F]  440-7-448ms    | [S2,MB0,B]  458-10-469ms   | [S2,MB7,F]  469-7-476ms    | [S2,MB1,B]  487-10-498ms   | [S6,MB4,F]  498-7-505ms    | [S2,MB2,B]  516-10-526ms   | [S6,MB5,F]  527-7-535ms    | [S2,MB3,B]  541-9-551ms    | [S6,MB6,F]  550-8-559ms    | [S6,MB4,B]  591-11-603ms   | [S6,MB7,F]  603-8-612ms    | [S6,MB5,B]  653-9-663ms    | [S6,MB6,B]  714-8-723ms    | [S6,MB7,B]  780-8-789ms    | [S2,MB4,B]  795-8-804ms    | [S2,MB5,B]  820-8-829ms    | [S2,MB6,B]  835-8-844ms    | [S2,MB7,B]  855-8-864ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,B]  204-32-236ms   | [S7,MB1,F]  237-15-252ms   | [S7,MB1,B]  264-32-297ms   | [S7,MB2,F]  297-16-314ms   | [S7,MB2,B]  326-33-359ms   | [S7,MB3,F]  359-16-376ms   | [S7,MB3,B]  389-34-424ms   | [S3,MB4,F]  424-9-434ms    | [S3,MB0,B]  434-12-447ms   | [S3,MB5,F]  447-11-458ms   | [S3,MB1,B]  458-12-471ms   | [S3,MB6,F]  471-9-481ms    | [S3,MB2,B]  481-12-493ms   | [S3,MB7,F]  494-10-504ms   | [S3,MB3,B]  504-12-517ms   | [S7,MB4,F]  522-17-540ms   | [S7,MB4,B]  552-33-586ms   | [S7,MB5,F]  585-15-601ms   | [S7,MB5,B]  612-33-646ms   | [S7,MB6,F]  647-16-663ms   | [S7,MB6,B]  674-33-708ms   | [S7,MB7,F]  707-16-724ms   | [S7,MB7,B]  736-35-772ms   | [S3,MB4,B]  773-11-785ms   | [S3,MB5,B]  785-12-797ms   | [S3,MB6,B]  797-11-809ms   | [S3,MB7,B]  814-12-826ms  
[rank3]:2025-12-31 03:23:28,123 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0323_stage3_step100.svg
[rank0]:2025-12-31 03:23:28,150 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank0_stage4.svg
[rank0]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-31 03:23:28,172 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank1_stage5.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-31 03:23:28,153 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank2_stage6.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-31 03:23:28,160 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0323_stage7_step100.svg
[rank0]:2025-12-31 03:23:28,189 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage0.svg
[rank0]:2025-12-31 03:23:28,224 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage4.svg
[rank1]:2025-12-31 03:23:28,211 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage1.svg
[rank1]:2025-12-31 03:23:28,246 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage5.svg
[rank2]:2025-12-31 03:23:28,192 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage2.svg
[rank2]:2025-12-31 03:23:28,226 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage6.svg
[rank3]:2025-12-31 03:23:28,260 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank3_stage3.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-31 03:23:28,339 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0323_rank3_stage7.svg
[rank3]:	> Counts Sum: 6400, Total Sum: 7040 (90.91%), Ratio(%) per element: [87.5, 87.5, 100.0, 87.5, 100.0, 100.0, 75.0, 87.5, 87.5, 93.75, 93.75]
[rank3]:2025-12-31 03:23:28,378 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage3.svg
[rank3]:2025-12-31 03:23:28,414 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0323_stage7.svg
[rank3]:2025-12-31 03:27:06,132 - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.40, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.46/0.69, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.47/0.71
[rank0]:2025-12-31 03:27:06,117 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 03:27:06,135 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.14/0.20, [MB4] 0.24/0.37, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-12-31 03:27:06,124 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-12-31 03:27:06,120 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.34/0.52, [MB4] 0.67/1.00, [MB5] 0.64/0.97, [MB6] 0.51/0.76, [MB7] 0.67/1.00
[rank3]:2025-12-31 03:27:10,331 - Avg. fwd time: 13.8494 / Avg. bwd time: 35.2864 / Avg. batch time: 1004.7781 (ms) / GPU bubble ratio: 21.76%
[rank2]:2025-12-31 03:27:10,371 - Avg. fwd time: 7.6987 / Avg. bwd time: 17.1360 / Avg. batch time: 1062.6927 (ms) / GPU bubble ratio: 62.61%
[rank3]:2025-12-31 03:27:10,455 -  step: 150  loss:  4.1085  grad_norm:  9.3292  memory: 29.23GiB(61.52%)  tps: 7,360  tflops: 57.54  mfu: 18.44%
[rank0]:2025-12-31 03:27:10,421 - Avg. fwd time: 8.3231 / Avg. bwd time: 18.6612 / Avg. batch time: 1147.6661 (ms) / GPU bubble ratio: 62.38%
[rank0]:2025-12-31 03:27:10,457 -  step: 150  loss: -4.0000  grad_norm:  9.3292  memory: 20.42GiB(42.99%)  tps: 7,360  tflops: 57.54  mfu: 18.44%
[rank1]:2025-12-31 03:27:10,401 - Avg. fwd time: 9.8596 / Avg. bwd time: 21.7647 / Avg. batch time: 1115.1138 (ms) / GPU bubble ratio: 54.62%
[rank1]:2025-12-31 03:27:10,447 -  step: 150  loss: -4.0000  grad_norm:  9.3292  memory: 18.49GiB(38.93%)  tps: 7,360  tflops: 57.54  mfu: 18.44%
[rank2]:2025-12-31 03:27:10,443 -  step: 150  loss: -4.0000  grad_norm:  9.3292  memory: 12.06GiB(25.39%)  tps: 7,360  tflops: 57.54  mfu: 18.44%
[rank3]:2025-12-31 03:30:36,717 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.69/0.69, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.71/0.71
[rank0]:2025-12-31 03:30:36,688 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 03:30:36,720 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.20/0.20, [MB4] 0.37/0.37, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-31 03:30:36,705 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.52/0.52, [MB4] 1.00/1.00, [MB5] 0.97/0.97, [MB6] 0.76/0.76, [MB7] 1.00/1.00
[rank1]:2025-12-31 03:30:36,709 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 03:30:40,584 - Avg. fwd time: 13.6679 / Avg. bwd time: 33.7101 / Avg. batch time: 978.2884 (ms) / GPU bubble ratio: 22.51%
[rank2]:2025-12-31 03:30:40,615 - Avg. fwd time: 7.6887 / Avg. bwd time: 17.0910 / Avg. batch time: 1034.0593 (ms) / GPU bubble ratio: 61.66%
[rank1]:2025-12-31 03:30:40,643 - Avg. fwd time: 9.9129 / Avg. bwd time: 21.6871 / Avg. batch time: 1084.8222 (ms) / GPU bubble ratio: 53.39%
[rank3]:2025-12-31 03:30:40,687 -  step: 200  loss:  1.4684  grad_norm:  3.5226  memory: 29.52GiB(62.14%)  tps: 7,793  tflops: 60.92  mfu: 19.53%
[rank0]:2025-12-31 03:30:40,653 - Avg. fwd time: 8.3239 / Avg. bwd time: 18.9334 / Avg. batch time: 1116.5733 (ms) / GPU bubble ratio: 60.94%
[rank0]:2025-12-31 03:30:40,689 -  step: 200  loss: -4.0000  grad_norm:  3.5226  memory: 20.42GiB(42.99%)  tps: 7,793  tflops: 60.92  mfu: 19.53%
[rank0]:2025-12-31 03:30:40,740 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0330_stage0_step200.svg
[rank2]:2025-12-31 03:30:40,675 -  step: 200  loss: -4.0000  grad_norm:  3.5226  memory: 12.06GiB(25.39%)  tps: 7,793  tflops: 60.92  mfu: 19.53%
[rank2]:2025-12-31 03:30:40,740 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0330_stage2_step200.svg
[rank1]:2025-12-31 03:30:40,678 -  step: 200  loss: -4.0000  grad_norm:  3.5226  memory: 18.49GiB(38.93%)  tps: 7,793  tflops: 60.92  mfu: 19.53%
[rank1]:2025-12-31 03:30:40,740 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0330_stage1_step200.svg
[rank0]:2025-12-31 03:30:40,782 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0330_stage4_step200.svg
[rank2]:2025-12-31 03:30:40,781 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0330_stage6_step200.svg
[rank1]:2025-12-31 03:30:40,782 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0330_stage5_step200.svg
[rank3]:2025-12-31 03:30:40,929 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0330_step200_rank3.svg
[rank3]:			> Batch Time: 992.66 ms, GPU Bubble Ratio: 54.37%, 49.93%, 60.42%, 35.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-170ms    | [S0,MB4,F]  169-8-178ms    | [S0,MB5,F]  178-7-185ms    | [S0,MB6,F]  186-8-194ms    | [S4,MB0,B]  343-19-363ms   | [S0,MB7,F]  363-7-370ms    | [S4,MB1,B]  431-19-451ms   | [S4,MB4,F]  470-8-479ms    | [S4,MB2,B]  479-19-498ms   | [S4,MB5,F]  500-8-509ms    | [S4,MB3,B]  509-19-529ms   | [S4,MB6,F]  531-8-540ms    | [S0,MB0,B]  544-25-570ms   | [S4,MB7,F]  570-7-577ms    | [S0,MB1,B]  585-24-609ms   | [S0,MB2,B]  630-23-653ms   | [S0,MB3,B]  675-23-698ms   | [S4,MB4,B]  704-18-723ms   | [S4,MB5,B]  736-18-755ms   | [S4,MB6,B]  798-18-816ms   | [S4,MB7,B]  873-16-889ms   | [S0,MB4,B]  898-18-917ms   | [S0,MB5,B]  930-23-954ms   | [S0,MB6,B]  957-14-972ms   | [S0,MB7,B]  978-14-992ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-134ms   | [S5,MB0,F]  161-8-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  270-7-277ms    | [S1,MB4,F]  299-10-310ms   | [S5,MB0,B]  310-18-329ms   | [S1,MB5,F]  337-13-350ms   | [S5,MB1,B]  352-19-371ms   | [S1,MB6,F]  371-12-383ms   | [S5,MB2,B]  431-18-450ms   | [S1,MB7,F]  450-12-462ms   | [S5,MB3,B]  478-19-498ms   | [S5,MB4,F]  498-8-507ms    | [S1,MB0,B]  508-30-539ms   | [S5,MB5,F]  538-9-547ms    | [S1,MB1,B]  547-32-579ms   | [S5,MB6,F]  578-10-589ms   | [S1,MB2,B]  589-34-623ms   | [S5,MB7,F]  623-10-634ms   | [S1,MB3,B]  634-34-668ms   | [S5,MB4,B]  675-22-697ms   | [S5,MB5,B]  710-19-730ms   | [S5,MB6,B]  773-18-791ms   | [S5,MB7,B]  856-9-866ms    | [S1,MB4,B]  872-15-888ms   | [S1,MB5,B]  909-14-923ms   | [S1,MB6,B]  930-14-944ms   | [S1,MB7,B]  957-14-971ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  264-6-271ms    | [S6,MB0,B]  270-19-290ms   | [S6,MB3,F]  290-8-298ms    | [S6,MB1,B]  324-20-345ms   | [S2,MB4,F]  345-8-353ms    | [S6,MB2,B]  386-19-406ms   | [S2,MB5,F]  406-7-413ms    | [S6,MB3,B]  451-19-470ms   | [S2,MB6,F]  470-9-479ms    | [S2,MB0,B]  480-19-500ms   | [S2,MB7,F]  500-8-509ms    | [S2,MB1,B]  511-19-531ms   | [S6,MB4,F]  531-7-538ms    | [S2,MB2,B]  546-20-566ms   | [S6,MB5,F]  566-7-573ms    | [S2,MB3,B]  591-19-611ms   | [S6,MB6,F]  611-7-618ms    | [S6,MB4,B]  630-19-650ms   | [S6,MB7,F]  650-7-657ms    | [S6,MB5,B]  685-18-704ms   | [S6,MB6,B]  749-17-767ms   | [S6,MB7,B]  837-13-850ms   | [S2,MB4,B]  856-9-866ms    | [S2,MB5,B]  892-10-903ms   | [S2,MB6,B]  909-13-922ms   | [S2,MB7,B]  930-10-940ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-193ms   | [S7,MB0,B]  204-50-255ms   | [S7,MB1,F]  254-18-273ms   | [S7,MB1,B]  285-33-318ms   | [S7,MB2,F]  318-17-335ms   | [S7,MB2,B]  346-33-380ms   | [S7,MB3,F]  380-17-397ms   | [S7,MB3,B]  410-34-444ms   | [S3,MB4,F]  445-9-454ms    | [S3,MB0,B]  454-12-466ms   | [S3,MB5,F]  467-10-478ms   | [S3,MB1,B]  478-12-490ms   | [S3,MB6,F]  490-9-500ms    | [S3,MB2,B]  500-15-515ms   | [S3,MB7,F]  517-10-527ms   | [S3,MB3,B]  527-22-550ms   | [S7,MB4,F]  553-16-569ms   | [S7,MB4,B]  582-33-615ms   | [S7,MB5,F]  616-16-632ms   | [S7,MB5,B]  644-34-678ms   | [S7,MB6,F]  679-18-697ms   | [S7,MB6,B]  708-34-742ms   | [S7,MB7,F]  743-16-759ms   | [S7,MB7,B]  772-57-829ms   | [S3,MB4,B]  829-15-845ms   | [S3,MB5,B]  845-14-860ms   | [S3,MB6,B]  860-13-874ms   | [S3,MB7,B]  883-16-899ms  
[rank0]:2025-12-31 03:30:40,880 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank0_stage0.svg
[rank0]:	> Counts Sum: 24800, Total Sum: 72960 (33.99%), Ratio(%) per element: [26.04, 35.41, 34.37, 37.5, 36.45, 37.5, 37.5, 37.5, 34.37, 34.37, 31.25, 34.37, 36.45, 31.25, 32.29, 33.33, 29.16, 33.33, 33.33]
[rank2]:2025-12-31 03:30:40,878 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank2_stage2.svg
[rank2]:	> Counts Sum: 30280, Total Sum: 69120 (43.81%), Ratio(%) per element: [46.87, 47.91, 43.75, 45.83, 41.66, 44.79, 41.66, 46.87, 42.7, 43.75, 42.7, 39.58, 45.83, 44.79, 39.58, 43.75, 41.66, 44.79]
[rank1]:2025-12-31 03:30:40,904 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank1_stage1.svg
[rank1]:	> Counts Sum: 47520, Total Sum: 103680 (45.83%), Ratio(%) per element: [46.87, 52.08, 51.04, 52.08, 55.2, 46.87, 52.08, 54.16, 50.0, 41.66, 45.83, 47.91, 46.87, 41.66, 44.79, 43.75, 42.7, 38.54, 41.66, 46.87, 43.75, 40.62, 39.58, 40.62, 42.7, 46.87, 40.62]
[rank3]:2025-12-31 03:30:40,977 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0330_stage3_step200.svg
[rank3]:2025-12-31 03:30:41,021 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0330_stage7_step200.svg
[rank0]:2025-12-31 03:30:40,977 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank0_stage4.svg
[rank0]:	> Counts Sum: 12520, Total Sum: 69120 (18.11%), Ratio(%) per element: [19.79, 17.7, 21.87, 17.7, 18.75, 17.7, 16.66, 17.7, 16.66, 17.7, 17.7, 17.7, 19.79, 17.7, 17.7, 16.66, 18.75, 17.7]
[rank2]:2025-12-31 03:30:40,977 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank2_stage6.svg
[rank2]:	> Counts Sum: 14120, Total Sum: 69120 (20.43%), Ratio(%) per element: [20.83, 22.91, 21.87, 22.91, 20.83, 21.87, 22.91, 21.87, 21.87, 17.7, 17.7, 20.83, 18.75, 19.79, 18.75, 18.75, 18.75, 18.75]
[rank1]:2025-12-31 03:30:41,002 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank1_stage5.svg
[rank1]:	> Counts Sum: 16560, Total Sum: 69120 (23.96%), Ratio(%) per element: [23.95, 23.95, 23.95, 21.87, 27.08, 23.95, 25.0, 26.04, 23.95, 22.91, 21.87, 22.91, 25.0, 23.95, 23.95, 21.87, 26.04, 22.91]
[rank3]:2025-12-31 03:30:41,121 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank3_stage3.svg
[rank3]:	> Counts Sum: 43800, Total Sum: 69120 (63.37%), Ratio(%) per element: [70.83, 70.83, 69.79, 68.75, 56.25, 60.41, 68.75, 64.58, 57.29, 64.58, 60.41, 61.45, 52.08, 64.58, 60.41, 67.7, 62.5, 59.37]
[rank0]:2025-12-31 03:30:41,139 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage0.svg
[rank2]:2025-12-31 03:30:41,141 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage2.svg
[rank1]:2025-12-31 03:30:41,163 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage1.svg
[rank3]:2025-12-31 03:30:41,202 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0330_rank3_stage7.svg
[rank3]:	> Counts Sum: 26120, Total Sum: 42240 (61.84%), Ratio(%) per element: [62.5, 64.58, 60.41, 65.62, 60.41, 63.54, 60.41, 58.33, 60.41, 61.45, 62.5]
[rank0]:2025-12-31 03:30:41,293 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage4.svg
[rank2]:2025-12-31 03:30:41,300 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage6.svg
[rank1]:2025-12-31 03:30:41,319 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage5.svg
[rank3]:2025-12-31 03:30:41,367 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage3.svg
[rank3]:2025-12-31 03:30:41,529 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0330_stage7.svg
[rank0]:2025-12-31 03:33:55,681 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 03:33:55,698 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.20/0.20, [MB4] 0.37/0.37, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 03:33:55,697 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.69/0.69, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.71/0.71
[rank2]:2025-12-31 03:33:55,683 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.52/0.52, [MB4] 1.00/1.00, [MB5] 0.97/0.97, [MB6] 0.76/0.76, [MB7] 1.00/1.00
[rank1]:2025-12-31 03:33:55,687 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 03:33:59,517 - Avg. fwd time: 13.4803 / Avg. bwd time: 32.2424 / Avg. batch time: 954.5134 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-12-31 03:33:59,590 - Avg. fwd time: 8.3241 / Avg. bwd time: 18.7748 / Avg. batch time: 1086.1730 (ms) / GPU bubble ratio: 60.08%
[rank2]:2025-12-31 03:33:59,551 - Avg. fwd time: 7.6833 / Avg. bwd time: 16.9886 / Avg. batch time: 1008.3178 (ms) / GPU bubble ratio: 60.85%
[rank2]:2025-12-31 03:33:59,611 -  step: 250  loss: -4.0000  grad_norm:  2.0482  memory: 12.06GiB(25.39%)  tps: 8,236  tflops: 64.38  mfu: 20.64%
[rank1]:2025-12-31 03:33:59,580 - Avg. fwd time: 9.9459 / Avg. bwd time: 21.5142 / Avg. batch time: 1057.7273 (ms) / GPU bubble ratio: 52.41%
[rank1]:2025-12-31 03:33:59,614 -  step: 250  loss: -4.0000  grad_norm:  2.0482  memory: 18.49GiB(38.93%)  tps: 8,236  tflops: 64.38  mfu: 20.64%
[rank0]:2025-12-31 03:33:59,625 -  step: 250  loss: -4.0000  grad_norm:  2.0482  memory: 20.42GiB(42.99%)  tps: 8,236  tflops: 64.38  mfu: 20.64%
[rank3]:2025-12-31 03:33:59,623 -  step: 250  loss:  0.4916  grad_norm:  2.0482  memory: 29.52GiB(62.14%)  tps: 8,236  tflops: 64.38  mfu: 20.64%
[rank0]:2025-12-31 03:37:12,301 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 03:37:12,333 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.20/0.20, [MB4] 0.37/0.37, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-31 03:37:12,330 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.69/0.69, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.71/0.71
[rank1]:2025-12-31 03:37:12,322 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-31 03:37:12,318 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.52/0.52, [MB4] 1.00/1.00, [MB5] 0.97/0.97, [MB6] 0.76/0.76, [MB7] 1.00/1.00
[rank3]:2025-12-31 03:37:16,228 - Avg. fwd time: 13.3482 / Avg. bwd time: 31.1964 / Avg. batch time: 937.4770 (ms) / GPU bubble ratio: 23.98%
[rank1]:2025-12-31 03:37:16,290 - Avg. fwd time: 9.9687 / Avg. bwd time: 21.4011 / Avg. batch time: 1038.2822 (ms) / GPU bubble ratio: 51.66%
[rank2]:2025-12-31 03:37:16,261 - Avg. fwd time: 7.6796 / Avg. bwd time: 16.9343 / Avg. batch time: 989.7876 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-12-31 03:37:16,300 - Avg. fwd time: 8.3234 / Avg. bwd time: 18.6588 / Avg. batch time: 1064.5103 (ms) / GPU bubble ratio: 59.44%
[rank0]:2025-12-31 03:37:16,336 -  step: 300  loss: -4.0000  grad_norm:  1.1668  memory: 20.42GiB(42.99%)  tps: 8,329  tflops: 65.11  mfu: 20.87%
[rank3]:2025-12-31 03:37:16,334 -  step: 300  loss:  0.3116  grad_norm:  1.1668  memory: 29.89GiB(62.92%)  tps: 8,329  tflops: 65.11  mfu: 20.87%
[rank1]:2025-12-31 03:37:16,325 -  step: 300  loss: -4.0000  grad_norm:  1.1668  memory: 18.49GiB(38.93%)  tps: 8,329  tflops: 65.11  mfu: 20.87%
[rank1]:2025-12-31 03:37:16,385 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0337_stage1_step300.svg
[rank2]:2025-12-31 03:37:16,322 -  step: 300  loss: -4.0000  grad_norm:  1.1668  memory: 12.06GiB(25.39%)  tps: 8,329  tflops: 65.11  mfu: 20.87%
[rank2]:2025-12-31 03:37:16,386 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0337_stage2_step300.svg
[rank0]:2025-12-31 03:37:16,385 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0337_stage0_step300.svg
[rank0]:2025-12-31 03:37:16,425 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0337_stage4_step300.svg
[rank1]:2025-12-31 03:37:16,426 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0337_stage5_step300.svg
[rank2]:2025-12-31 03:37:16,427 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0337_stage6_step300.svg
[rank0]:2025-12-31 03:37:16,524 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank0_stage0.svg
[rank0]:	> Counts Sum: 42800, Total Sum: 133760 (32.00%), Ratio(%) per element: [26.7, 32.95, 32.38, 33.52, 31.81, 34.65, 35.22, 36.36, 33.52, 34.09, 30.11, 32.38, 34.09, 29.54, 31.25, 30.68, 27.84, 31.25, 29.54]
[rank3]:2025-12-31 03:37:16,575 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0337_step300_rank3.svg
[rank3]:			> Batch Time: 954.00 ms, GPU Bubble Ratio: 55.97%, 48.07%, 59.06%, 36.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-94ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  160-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-193ms    | [S4,MB0,B]  326-19-346ms   | [S0,MB7,F]  346-7-353ms    | [S4,MB1,B]  413-19-432ms   | [S4,MB4,F]  450-8-459ms    | [S4,MB2,B]  459-19-478ms   | [S4,MB5,F]  481-8-489ms    | [S4,MB3,B]  490-19-509ms   | [S4,MB6,F]  511-8-520ms    | [S0,MB0,B]  526-25-551ms   | [S4,MB7,F]  551-7-559ms    | [S0,MB1,B]  567-24-591ms   | [S0,MB2,B]  611-23-635ms   | [S0,MB3,B]  656-23-679ms   | [S4,MB4,B]  685-18-703ms   | [S4,MB5,B]  717-18-736ms   | [S4,MB6,B]  778-18-796ms   | [S4,MB7,B]  850-17-867ms   | [S0,MB4,B]  876-14-890ms   | [S0,MB5,B]  907-23-930ms   | [S0,MB6,B]  934-0-934ms    | [S0,MB7,B]  954-0-954ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  255-7-263ms    | [S1,MB4,F]  285-10-296ms   | [S5,MB0,B]  295-19-315ms   | [S1,MB5,F]  320-13-333ms   | [S5,MB1,B]  335-19-354ms   | [S1,MB6,F]  354-11-366ms   | [S5,MB2,B]  413-18-431ms   | [S1,MB7,F]  431-12-444ms   | [S5,MB3,B]  459-20-479ms   | [S5,MB4,F]  479-8-487ms    | [S1,MB0,B]  489-30-519ms   | [S5,MB5,F]  519-9-528ms    | [S1,MB1,B]  529-32-561ms   | [S5,MB6,F]  560-10-571ms   | [S1,MB2,B]  571-34-605ms   | [S5,MB7,F]  605-10-615ms   | [S1,MB3,B]  615-34-649ms   | [S5,MB4,B]  656-22-678ms   | [S5,MB5,B]  690-20-710ms   | [S5,MB6,B]  753-18-771ms   | [S5,MB7,B]  834-9-843ms    | [S1,MB4,B]  850-13-863ms   | [S1,MB5,B]  887-13-900ms   | [S1,MB6,B]  907-13-921ms   | [S1,MB7,B]  934-14-948ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  249-6-256ms    | [S6,MB0,B]  256-19-275ms   | [S6,MB3,F]  275-8-284ms    | [S6,MB1,B]  307-20-328ms   | [S2,MB4,F]  328-8-336ms    | [S6,MB2,B]  369-19-389ms   | [S2,MB5,F]  388-7-396ms    | [S6,MB3,B]  432-19-451ms   | [S2,MB6,F]  451-9-460ms    | [S2,MB0,B]  461-19-481ms   | [S2,MB7,F]  480-9-489ms    | [S2,MB1,B]  491-20-511ms   | [S6,MB4,F]  511-7-519ms    | [S2,MB2,B]  528-20-548ms   | [S6,MB5,F]  548-7-555ms    | [S2,MB3,B]  573-19-592ms   | [S6,MB6,F]  592-7-600ms    | [S6,MB4,B]  612-19-632ms   | [S6,MB7,F]  631-7-639ms    | [S6,MB5,B]  665-18-684ms   | [S6,MB6,B]  729-17-747ms   | [S6,MB7,B]  814-13-828ms   | [S2,MB4,B]  834-9-843ms    | [S2,MB5,B]  870-10-880ms   | [S2,MB6,B]  886-11-898ms   | [S2,MB7,B]  907-9-916ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,B]  204-35-239ms   | [S7,MB1,F]  239-15-255ms   | [S7,MB1,B]  268-32-300ms   | [S7,MB2,F]  300-16-317ms   | [S7,MB2,B]  329-33-362ms   | [S7,MB3,F]  362-16-379ms   | [S7,MB3,B]  391-33-425ms   | [S3,MB4,F]  425-9-434ms    | [S3,MB0,B]  434-12-447ms   | [S3,MB5,F]  447-10-458ms   | [S3,MB1,B]  458-11-470ms   | [S3,MB6,F]  470-9-480ms    | [S3,MB2,B]  480-15-495ms   | [S3,MB7,F]  497-9-507ms    | [S3,MB3,B]  507-22-530ms   | [S7,MB4,F]  534-16-551ms   | [S7,MB4,B]  562-33-595ms   | [S7,MB5,F]  596-15-612ms   | [S7,MB5,B]  624-33-658ms   | [S7,MB6,F]  658-17-676ms   | [S7,MB6,B]  688-33-722ms   | [S7,MB7,F]  722-16-739ms   | [S7,MB7,B]  752-56-808ms   | [S3,MB4,B]  807-14-822ms   | [S3,MB5,B]  822-13-835ms   | [S3,MB6,B]  835-12-848ms   | [S3,MB7,B]  861-16-878ms  
[rank1]:2025-12-31 03:37:16,549 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank1_stage1.svg
[rank1]:	> Counts Sum: 90720, Total Sum: 190080 (47.73%), Ratio(%) per element: [48.29, 51.13, 50.56, 51.13, 52.84, 48.29, 51.13, 52.27, 50.0, 45.45, 47.72, 48.86, 48.29, 45.45, 47.15, 46.59, 46.02, 43.75, 45.45, 48.29, 46.59, 44.88, 44.31, 44.88, 46.02, 48.29, 44.88]
[rank2]:2025-12-31 03:37:16,525 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank2_stage2.svg
[rank2]:	> Counts Sum: 57080, Total Sum: 126720 (45.04%), Ratio(%) per element: [44.88, 46.59, 44.88, 47.15, 45.45, 45.45, 43.18, 47.15, 43.75, 46.02, 45.45, 42.61, 45.45, 45.45, 43.18, 44.31, 44.88, 44.88]
[rank0]:2025-12-31 03:37:16,622 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank0_stage4.svg
[rank0]:	> Counts Sum: 14120, Total Sum: 126720 (11.14%), Ratio(%) per element: [11.36, 10.22, 15.34, 11.36, 10.79, 10.79, 9.65, 10.79, 10.79, 11.36, 9.65, 11.36, 13.06, 10.79, 9.65, 10.22, 12.5, 10.79]
[rank3]:2025-12-31 03:37:16,619 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0337_stage3_step300.svg
[rank3]:2025-12-31 03:37:16,660 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0337_stage7_step300.svg
[rank1]:2025-12-31 03:37:16,648 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank1_stage5.svg
[rank1]:	> Counts Sum: 23760, Total Sum: 126720 (18.75%), Ratio(%) per element: [18.75, 18.75, 18.75, 17.61, 20.45, 18.75, 19.31, 19.88, 18.75, 18.18, 17.61, 18.18, 19.31, 18.75, 18.75, 17.61, 19.88, 18.18]
[rank2]:2025-12-31 03:37:16,626 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank2_stage6.svg
[rank2]:	> Counts Sum: 17720, Total Sum: 126720 (13.98%), Ratio(%) per element: [16.47, 18.18, 14.2, 17.04, 14.77, 16.47, 16.47, 15.34, 15.34, 13.06, 11.36, 11.93, 12.5, 11.36, 10.79, 12.5, 10.79, 13.06]
[rank3]:2025-12-31 03:37:16,762 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank3_stage3.svg
[rank3]:	> Counts Sum: 89800, Total Sum: 126720 (70.86%), Ratio(%) per element: [75.56, 75.0, 76.13, 74.43, 67.04, 71.02, 71.59, 71.59, 68.18, 72.15, 68.75, 69.31, 65.34, 69.31, 69.31, 71.59, 71.02, 68.18]
[rank3]:2025-12-31 03:37:16,841 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0337_rank3_stage7.svg
[rank3]:	> Counts Sum: 54120, Total Sum: 77440 (69.89%), Ratio(%) per element: [70.45, 70.45, 69.31, 70.45, 69.31, 69.88, 68.18, 69.88, 69.88, 69.31, 71.59]
[rank0]:2025-12-31 03:37:16,913 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage0.svg
[rank1]:2025-12-31 03:37:16,938 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage1.svg
[rank2]:2025-12-31 03:37:16,917 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage2.svg
[rank3]:2025-12-31 03:37:17,131 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage3.svg
[rank0]:2025-12-31 03:37:17,192 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage4.svg
[rank1]:2025-12-31 03:37:17,222 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage5.svg
[rank2]:2025-12-31 03:37:17,199 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage6.svg
[rank3]:2025-12-31 03:37:17,415 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0337_stage7.svg
[rank0]:2025-12-31 03:40:31,526 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 03:40:35,539 - Avg. fwd time: 8.3233 / Avg. bwd time: 18.5655 / Avg. batch time: 1050.2321 (ms) / GPU bubble ratio: 59.04%
[rank3]:2025-12-31 03:40:35,464 - Avg. fwd time: 13.2621 / Avg. bwd time: 30.5102 / Avg. batch time: 926.2144 (ms) / GPU bubble ratio: 24.38%
[rank2]:2025-12-31 03:40:35,499 - Avg. fwd time: 7.6781 / Avg. bwd time: 16.8916 / Avg. batch time: 977.7246 (ms) / GPU bubble ratio: 59.79%
[rank2]:2025-12-31 03:40:35,561 -  step: 350  loss: -4.0000  grad_norm:  0.2716  memory: 12.06GiB(25.39%)  tps: 8,223  tflops: 64.29  mfu: 20.60%
[rank1]:2025-12-31 03:40:35,527 - Avg. fwd time: 9.9854 / Avg. bwd time: 21.3232 / Avg. batch time: 1025.5744 (ms) / GPU bubble ratio: 51.16%
[rank1]:2025-12-31 03:40:35,564 -  step: 350  loss: -4.0000  grad_norm:  0.2716  memory: 18.49GiB(38.93%)  tps: 8,223  tflops: 64.29  mfu: 20.60%
[rank0]:2025-12-31 03:40:35,575 -  step: 350  loss: -4.0000  grad_norm:  0.2716  memory: 20.42GiB(42.99%)  tps: 8,223  tflops: 64.29  mfu: 20.60%
[rank3]:2025-12-31 03:40:35,573 -  step: 350  loss:  0.2397  grad_norm:  0.2716  memory: 29.95GiB(63.05%)  tps: 8,223  tflops: 64.29  mfu: 20.60%
[rank0]:2025-12-31 03:43:48,637 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 03:43:52,705 - Avg. fwd time: 8.3243 / Avg. bwd time: 18.5149 / Avg. batch time: 1038.7095 (ms) / GPU bubble ratio: 58.66%
[rank3]:2025-12-31 03:43:52,632 - Avg. fwd time: 13.1900 / Avg. bwd time: 29.9559 / Avg. batch time: 917.1012 (ms) / GPU bubble ratio: 24.73%
[rank1]:2025-12-31 03:43:52,693 - Avg. fwd time: 9.9975 / Avg. bwd time: 21.2636 / Avg. batch time: 1015.2359 (ms) / GPU bubble ratio: 50.73%
[rank2]:2025-12-31 03:43:52,665 - Avg. fwd time: 7.6776 / Avg. bwd time: 16.8518 / Avg. batch time: 967.8713 (ms) / GPU bubble ratio: 59.45%
[rank0]:2025-12-31 03:43:52,741 -  step: 400  loss: -4.0000  grad_norm:  0.8474  memory: 20.42GiB(42.99%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank0]:2025-12-31 03:43:52,795 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0343_stage0_step400.svg
[rank3]:2025-12-31 03:43:52,739 -  step: 400  loss:  0.2223  grad_norm:  0.8474  memory: 29.95GiB(63.05%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank1]:2025-12-31 03:43:52,730 -  step: 400  loss: -4.0000  grad_norm:  0.8474  memory: 18.49GiB(38.93%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank1]:2025-12-31 03:43:52,795 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0343_stage1_step400.svg
[rank2]:2025-12-31 03:43:52,727 -  step: 400  loss: -4.0000  grad_norm:  0.8474  memory: 12.06GiB(25.39%)  tps: 8,310  tflops: 64.96  mfu: 20.82%
[rank2]:2025-12-31 03:43:52,794 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0343_stage2_step400.svg
[rank0]:2025-12-31 03:43:52,840 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0343_stage4_step400.svg
[rank1]:2025-12-31 03:43:52,841 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0343_stage5_step400.svg
[rank2]:2025-12-31 03:43:52,839 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0343_stage6_step400.svg
[rank0]:2025-12-31 03:43:52,941 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank0_stage0.svg
[rank0]:	> Counts Sum: 60800, Total Sum: 194560 (31.25%), Ratio(%) per element: [27.34, 31.64, 32.03, 32.42, 31.64, 33.59, 33.59, 33.98, 32.42, 34.37, 28.9, 31.25, 32.81, 30.07, 30.46, 29.29, 27.73, 30.85, 29.29]
[rank3]:2025-12-31 03:43:52,978 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0343_step400_rank3.svg
[rank3]:			> Batch Time: 951.50 ms, GPU Bubble Ratio: 55.37%, 47.85%, 59.15%, 35.60%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-194ms    | [S4,MB0,B]  327-19-346ms   | [S0,MB7,F]  345-7-353ms    | [S4,MB1,B]  413-19-432ms   | [S4,MB4,F]  451-8-460ms    | [S4,MB2,B]  460-19-479ms   | [S4,MB5,F]  482-8-490ms    | [S4,MB3,B]  490-19-510ms   | [S4,MB6,F]  512-8-521ms    | [S0,MB0,B]  527-25-553ms   | [S4,MB7,F]  552-7-560ms    | [S0,MB1,B]  568-24-593ms   | [S0,MB2,B]  612-23-636ms   | [S0,MB3,B]  657-23-681ms   | [S4,MB4,B]  686-18-705ms   | [S4,MB5,B]  718-18-736ms   | [S4,MB6,B]  778-18-796ms   | [S4,MB7,B]  850-15-865ms   | [S0,MB4,B]  874-20-894ms   | [S0,MB5,B]  904-23-928ms   | [S0,MB6,B]  931-0-931ms    | [S0,MB7,B]  951-0-951ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-134ms   | [S5,MB0,F]  161-8-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-197ms    | [S5,MB3,F]  256-7-263ms    | [S1,MB4,F]  285-10-296ms   | [S5,MB0,B]  296-19-315ms   | [S1,MB5,F]  320-13-333ms   | [S5,MB1,B]  335-19-354ms   | [S1,MB6,F]  354-11-366ms   | [S5,MB2,B]  413-18-432ms   | [S1,MB7,F]  432-12-444ms   | [S5,MB3,B]  459-19-479ms   | [S5,MB4,F]  479-8-488ms    | [S1,MB0,B]  490-30-520ms   | [S5,MB5,F]  520-9-530ms    | [S1,MB1,B]  530-32-562ms   | [S5,MB6,F]  561-10-572ms   | [S1,MB2,B]  572-34-606ms   | [S5,MB7,F]  606-10-616ms   | [S1,MB3,B]  616-34-651ms   | [S5,MB4,B]  657-22-679ms   | [S5,MB5,B]  691-20-712ms   | [S5,MB6,B]  754-18-772ms   | [S5,MB7,B]  834-9-843ms    | [S1,MB4,B]  850-13-863ms   | [S1,MB5,B]  884-13-898ms   | [S1,MB6,B]  904-13-918ms   | [S1,MB7,B]  931-13-945ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  250-6-257ms    | [S6,MB0,B]  257-19-276ms   | [S6,MB3,F]  276-8-284ms    | [S6,MB1,B]  307-20-328ms   | [S2,MB4,F]  328-8-336ms    | [S6,MB2,B]  368-19-388ms   | [S2,MB5,F]  388-7-395ms    | [S6,MB3,B]  432-19-452ms   | [S2,MB6,F]  451-9-461ms    | [S2,MB0,B]  461-19-481ms   | [S2,MB7,F]  481-9-491ms    | [S2,MB1,B]  492-20-512ms   | [S6,MB4,F]  511-7-519ms    | [S2,MB2,B]  529-20-549ms   | [S6,MB5,F]  549-7-557ms    | [S2,MB3,B]  574-19-594ms   | [S6,MB6,F]  593-7-601ms    | [S6,MB4,B]  613-19-632ms   | [S6,MB7,F]  632-7-640ms    | [S6,MB5,B]  666-18-685ms   | [S6,MB6,B]  729-17-747ms   | [S6,MB7,B]  815-13-829ms   | [S2,MB4,B]  834-9-843ms    | [S2,MB5,B]  868-9-877ms    | [S2,MB6,B]  884-10-894ms   | [S2,MB7,B]  904-9-913ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-193ms   | [S7,MB0,B]  205-35-240ms   | [S7,MB1,F]  240-15-256ms   | [S7,MB1,B]  267-32-300ms   | [S7,MB2,F]  301-16-317ms   | [S7,MB2,B]  329-33-363ms   | [S7,MB3,F]  362-16-379ms   | [S7,MB3,B]  392-33-426ms   | [S3,MB4,F]  426-9-435ms    | [S3,MB0,B]  435-12-448ms   | [S3,MB5,F]  447-10-458ms   | [S3,MB1,B]  458-12-470ms   | [S3,MB6,F]  469-9-479ms    | [S3,MB2,B]  480-16-496ms   | [S3,MB7,F]  498-10-508ms   | [S3,MB3,B]  508-22-531ms   | [S7,MB4,F]  536-16-552ms   | [S7,MB4,B]  563-33-596ms   | [S7,MB5,F]  597-16-614ms   | [S7,MB5,B]  626-33-659ms   | [S7,MB6,F]  659-18-677ms   | [S7,MB6,B]  690-33-723ms   | [S7,MB7,F]  723-16-740ms   | [S7,MB7,B]  752-56-808ms   | [S3,MB4,B]  808-14-823ms   | [S3,MB5,B]  822-13-835ms   | [S3,MB6,B]  835-12-847ms   | [S3,MB7,B]  860-15-875ms  
[rank1]:2025-12-31 03:43:52,964 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank1_stage1.svg
[rank1]:	> Counts Sum: 133920, Total Sum: 276480 (48.44%), Ratio(%) per element: [48.82, 50.78, 50.39, 50.78, 51.95, 48.82, 50.78, 51.56, 50.0, 46.87, 48.43, 49.21, 48.82, 46.87, 48.04, 47.65, 47.26, 45.7, 46.87, 48.82, 47.65, 46.48, 46.09, 46.48, 47.26, 48.82, 46.48]
[rank2]:2025-12-31 03:43:52,937 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank2_stage2.svg
[rank2]:	> Counts Sum: 83880, Total Sum: 184320 (45.51%), Ratio(%) per element: [45.7, 47.26, 44.92, 47.65, 46.48, 45.31, 44.92, 48.04, 43.75, 46.87, 44.92, 44.14, 45.31, 46.09, 44.14, 44.92, 44.92, 43.75]
[rank0]:2025-12-31 03:43:53,037 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank0_stage4.svg
[rank0]:	> Counts Sum: 15720, Total Sum: 184320 (8.53%), Ratio(%) per element: [7.81, 7.42, 12.1, 7.81, 8.2, 8.59, 8.2, 8.98, 8.59, 8.2, 7.81, 8.2, 9.37, 8.59, 7.03, 8.2, 10.15, 8.2]
[rank3]:2025-12-31 03:43:53,034 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0343_stage3_step400.svg
[rank3]:2025-12-31 03:43:53,079 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0343_stage7_step400.svg
[rank1]:2025-12-31 03:43:53,062 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank1_stage5.svg
[rank1]:	> Counts Sum: 30960, Total Sum: 184320 (16.80%), Ratio(%) per element: [16.79, 16.79, 16.79, 16.01, 17.96, 16.79, 17.18, 17.57, 16.79, 16.4, 16.01, 16.4, 17.18, 16.79, 16.79, 16.01, 17.57, 16.4]
[rank2]:2025-12-31 03:43:53,036 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank2_stage6.svg
[rank2]:	> Counts Sum: 21320, Total Sum: 184320 (11.57%), Ratio(%) per element: [14.06, 14.45, 12.5, 14.06, 12.89, 13.28, 14.06, 12.89, 12.5, 10.54, 10.54, 10.15, 10.15, 9.37, 8.59, 10.15, 8.2, 9.76]
[rank3]:2025-12-31 03:43:53,179 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank3_stage3.svg
[rank3]:	> Counts Sum: 135800, Total Sum: 184320 (73.68%), Ratio(%) per element: [76.56, 76.95, 78.12, 76.17, 72.26, 73.04, 74.21, 75.78, 71.48, 74.21, 72.26, 70.7, 69.14, 73.04, 73.82, 73.43, 73.43, 71.48]
[rank3]:2025-12-31 03:43:53,261 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0343_rank3_stage7.svg
[rank3]:	> Counts Sum: 82120, Total Sum: 112640 (72.90%), Ratio(%) per element: [73.04, 74.6, 72.26, 73.04, 72.65, 72.26, 71.09, 72.26, 73.43, 72.65, 74.6]
[rank0]:2025-12-31 03:43:53,455 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage0.svg
[rank1]:2025-12-31 03:43:53,471 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage1.svg
[rank2]:2025-12-31 03:43:53,455 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage2.svg
[rank3]:2025-12-31 03:43:53,674 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage3.svg
[rank0]:2025-12-31 03:43:53,853 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage4.svg
[rank1]:2025-12-31 03:43:53,872 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage5.svg
[rank2]:2025-12-31 03:43:53,858 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage6.svg
[rank3]:2025-12-31 03:43:54,086 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0343_stage7.svg
[rank3]:2025-12-31 03:44:16,521 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 03:44:16,942 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 03:44:16,962 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 03:44:16,960 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 03:47:08,639 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 03:47:12,478 - Avg. fwd time: 13.1468 / Avg. bwd time: 29.5677 / Avg. batch time: 910.8621 (ms) / GPU bubble ratio: 24.97%
[rank0]:2025-12-31 03:47:12,555 - Avg. fwd time: 8.3243 / Avg. bwd time: 18.4649 / Avg. batch time: 1030.7182 (ms) / GPU bubble ratio: 58.41%
[rank1]:2025-12-31 03:47:12,542 - Avg. fwd time: 10.0065 / Avg. bwd time: 21.2119 / Avg. batch time: 1008.1608 (ms) / GPU bubble ratio: 50.45%
[rank2]:2025-12-31 03:47:12,513 - Avg. fwd time: 7.6758 / Avg. bwd time: 16.8208 / Avg. batch time: 961.1765 (ms) / GPU bubble ratio: 59.22%
[rank2]:2025-12-31 03:47:12,576 -  step: 450  loss: -4.0000  grad_norm:  4.0806  memory: 12.06GiB(25.39%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank3]:2025-12-31 03:47:12,589 -  step: 450  loss:  0.2334  grad_norm:  4.0806  memory: 29.95GiB(63.05%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank0]:2025-12-31 03:47:12,590 -  step: 450  loss: -4.0000  grad_norm:  4.0806  memory: 20.42GiB(42.99%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank1]:2025-12-31 03:47:12,580 -  step: 450  loss: -4.0000  grad_norm:  4.0806  memory: 18.49GiB(38.93%)  tps: 8,198  tflops: 64.09  mfu: 20.54%
[rank0]:2025-12-31 03:50:26,769 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 03:50:30,650 - Avg. fwd time: 7.6743 / Avg. bwd time: 16.7956 / Avg. batch time: 955.4409 (ms) / GPU bubble ratio: 59.02%
[rank3]:2025-12-31 03:50:30,615 - Avg. fwd time: 13.1080 / Avg. bwd time: 29.2359 / Avg. batch time: 905.5725 (ms) / GPU bubble ratio: 25.19%
[rank0]:2025-12-31 03:50:30,692 - Avg. fwd time: 8.3240 / Avg. bwd time: 18.4349 / Avg. batch time: 1023.9458 (ms) / GPU bubble ratio: 58.19%
[rank0]:2025-12-31 03:50:30,727 -  step: 500  loss: -4.0000  grad_norm:  0.5719  memory: 20.42GiB(42.99%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank1]:2025-12-31 03:50:30,678 - Avg. fwd time: 10.0140 / Avg. bwd time: 21.1729 / Avg. batch time: 1002.1254 (ms) / GPU bubble ratio: 50.21%
[rank1]:2025-12-31 03:50:30,716 -  step: 500  loss: -4.0000  grad_norm:  0.5719  memory: 18.49GiB(38.93%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank2]:2025-12-31 03:50:30,713 -  step: 500  loss: -4.0000  grad_norm:  0.5719  memory: 12.06GiB(25.39%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank3]:2025-12-31 03:50:30,725 -  step: 500  loss:  0.2256  grad_norm:  0.5719  memory: 29.95GiB(63.05%)  tps: 8,269  tflops: 64.64  mfu: 20.72%
[rank0]:2025-12-31 03:50:30,778 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0350_stage0_step500.svg
[rank0]:2025-12-31 03:50:30,820 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0350_stage4_step500.svg
[rank1]:2025-12-31 03:50:30,778 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0350_stage1_step500.svg
[rank1]:2025-12-31 03:50:30,820 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0350_stage5_step500.svg
[rank2]:2025-12-31 03:50:30,777 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0350_stage2_step500.svg
[rank2]:2025-12-31 03:50:30,817 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0350_stage6_step500.svg
[rank0]:2025-12-31 03:50:30,921 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank0_stage0.svg
[rank0]:	> Counts Sum: 78800, Total Sum: 255360 (30.86%), Ratio(%) per element: [27.38, 31.25, 31.84, 32.14, 30.35, 33.03, 32.73, 33.03, 32.44, 33.63, 29.46, 31.54, 31.84, 29.16, 29.76, 29.46, 27.38, 30.65, 29.16]
[rank2]:2025-12-31 03:50:30,914 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank2_stage2.svg
[rank2]:	> Counts Sum: 110680, Total Sum: 241920 (45.75%), Ratio(%) per element: [46.72, 47.32, 45.53, 47.61, 47.32, 46.13, 45.83, 47.02, 44.94, 46.42, 45.23, 44.34, 44.34, 45.23, 44.64, 44.94, 45.23, 44.64]
[rank3]:2025-12-31 03:50:30,962 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0350_step500_rank3.svg
[rank3]:			> Batch Time: 967.00 ms, GPU Bubble Ratio: 55.78%, 48.91%, 59.83%, 34.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-94ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  343-19-362ms   | [S0,MB7,F]  362-7-369ms    | [S4,MB1,B]  429-19-448ms   | [S4,MB4,F]  467-8-475ms    | [S4,MB2,B]  475-19-495ms   | [S4,MB5,F]  497-8-506ms    | [S4,MB3,B]  506-19-525ms   | [S4,MB6,F]  528-8-536ms    | [S0,MB0,B]  542-25-567ms   | [S4,MB7,F]  568-7-576ms    | [S0,MB1,B]  583-24-608ms   | [S0,MB2,B]  627-23-651ms   | [S0,MB3,B]  672-23-696ms   | [S4,MB4,B]  702-18-720ms   | [S4,MB5,B]  733-18-752ms   | [S4,MB6,B]  792-18-810ms   | [S4,MB7,B]  865-16-881ms   | [S0,MB4,B]  890-23-913ms   | [S0,MB5,B]  920-23-943ms   | [S0,MB6,B]  947-0-947ms    | [S0,MB7,B]  967-0-967ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  269-7-276ms    | [S1,MB4,F]  299-10-309ms   | [S5,MB0,B]  309-18-328ms   | [S1,MB5,F]  336-12-349ms   | [S5,MB1,B]  351-19-370ms   | [S1,MB6,F]  370-11-382ms   | [S5,MB2,B]  429-18-448ms   | [S1,MB7,F]  448-12-460ms   | [S5,MB3,B]  475-19-495ms   | [S5,MB4,F]  495-8-504ms    | [S1,MB0,B]  505-30-535ms   | [S5,MB5,F]  536-9-545ms    | [S1,MB1,B]  545-32-577ms   | [S5,MB6,F]  577-10-587ms   | [S1,MB2,B]  587-33-621ms   | [S5,MB7,F]  621-10-631ms   | [S1,MB3,B]  632-34-666ms   | [S5,MB4,B]  673-22-695ms   | [S5,MB5,B]  707-20-727ms   | [S5,MB6,B]  768-18-786ms   | [S5,MB7,B]  849-9-858ms    | [S1,MB4,B]  865-13-878ms   | [S1,MB5,B]  900-13-913ms   | [S1,MB6,B]  920-13-934ms   | [S1,MB7,B]  947-13-961ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  263-6-270ms    | [S6,MB0,B]  270-19-289ms   | [S6,MB3,F]  289-8-298ms    | [S6,MB1,B]  323-20-344ms   | [S2,MB4,F]  344-8-353ms    | [S6,MB2,B]  385-19-405ms   | [S2,MB5,F]  404-7-412ms    | [S6,MB3,B]  448-19-467ms   | [S2,MB6,F]  467-9-476ms    | [S2,MB0,B]  477-19-497ms   | [S2,MB7,F]  497-8-506ms    | [S2,MB1,B]  507-19-527ms   | [S6,MB4,F]  527-7-535ms    | [S2,MB2,B]  545-20-565ms   | [S6,MB5,F]  565-7-572ms    | [S2,MB3,B]  589-19-609ms   | [S6,MB6,F]  609-7-616ms    | [S6,MB4,B]  628-19-647ms   | [S6,MB7,F]  647-7-655ms    | [S6,MB5,B]  681-18-700ms   | [S6,MB6,B]  743-17-761ms   | [S6,MB7,B]  829-14-843ms   | [S2,MB4,B]  850-9-859ms    | [S2,MB5,B]  884-9-893ms    | [S2,MB6,B]  899-10-910ms   | [S2,MB7,B]  919-9-928ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,B]  204-50-254ms   | [S7,MB1,F]  253-18-272ms   | [S7,MB1,B]  284-32-317ms   | [S7,MB2,F]  317-17-334ms   | [S7,MB2,B]  345-33-378ms   | [S7,MB3,F]  379-17-396ms   | [S7,MB3,B]  407-33-441ms   | [S3,MB4,F]  441-9-451ms    | [S3,MB0,B]  451-12-463ms   | [S3,MB5,F]  463-10-474ms   | [S3,MB1,B]  474-11-486ms   | [S3,MB6,F]  486-9-496ms    | [S3,MB2,B]  496-16-512ms   | [S3,MB7,F]  514-10-524ms   | [S3,MB3,B]  524-22-547ms   | [S7,MB4,F]  551-16-567ms   | [S7,MB4,B]  579-33-613ms   | [S7,MB5,F]  613-16-630ms   | [S7,MB5,B]  641-33-674ms   | [S7,MB6,F]  674-17-692ms   | [S7,MB6,B]  703-33-737ms   | [S7,MB7,F]  736-16-753ms   | [S7,MB7,B]  765-56-822ms   | [S3,MB4,B]  822-14-836ms   | [S3,MB5,B]  836-13-849ms   | [S3,MB6,B]  849-12-862ms   | [S3,MB7,B]  875-15-891ms  
[rank0]:2025-12-31 03:50:31,020 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank0_stage4.svg
[rank0]:	> Counts Sum: 17320, Total Sum: 241920 (7.16%), Ratio(%) per element: [6.54, 5.65, 10.41, 6.25, 6.54, 6.54, 7.14, 7.73, 7.14, 6.84, 7.14, 6.84, 8.03, 6.84, 5.65, 8.03, 8.03, 7.44]
[rank1]:2025-12-31 03:50:30,944 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank1_stage1.svg
[rank1]:	> Counts Sum: 177120, Total Sum: 362880 (48.81%), Ratio(%) per element: [49.1, 50.59, 50.29, 50.59, 51.48, 49.1, 50.59, 51.19, 50.0, 47.61, 48.8, 49.4, 49.1, 47.61, 48.51, 48.21, 47.91, 46.72, 47.61, 49.1, 48.21, 47.32, 47.02, 47.32, 47.91, 49.1, 47.32]
[rank2]:2025-12-31 03:50:31,013 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank2_stage6.svg
[rank2]:	> Counts Sum: 24920, Total Sum: 241920 (10.30%), Ratio(%) per element: [13.09, 11.9, 10.71, 12.79, 11.6, 11.9, 12.79, 11.01, 11.3, 10.11, 9.52, 8.92, 8.63, 8.03, 8.03, 8.33, 7.44, 9.22]
[rank3]:2025-12-31 03:50:31,005 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0350_stage3_step500.svg
[rank3]:2025-12-31 03:50:31,045 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0350_stage7_step500.svg
[rank1]:2025-12-31 03:50:31,043 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank1_stage5.svg
[rank1]:	> Counts Sum: 38160, Total Sum: 241920 (15.77%), Ratio(%) per element: [15.77, 15.77, 15.77, 15.17, 16.66, 15.77, 16.07, 16.36, 15.77, 15.47, 15.17, 15.47, 16.07, 15.77, 15.77, 15.17, 16.36, 15.47]
[rank3]:2025-12-31 03:50:31,143 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank3_stage3.svg
[rank3]:	> Counts Sum: 181800, Total Sum: 241920 (75.15%), Ratio(%) per element: [78.57, 77.97, 79.46, 77.67, 74.1, 75.29, 76.19, 77.67, 74.7, 74.7, 73.21, 73.21, 71.13, 73.8, 75.0, 74.1, 73.21, 72.61]
[rank3]:2025-12-31 03:50:31,222 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0350_rank3_stage7.svg
[rank3]:	> Counts Sum: 110120, Total Sum: 147840 (74.49%), Ratio(%) per element: [74.1, 75.59, 73.51, 74.7, 74.4, 74.4, 72.91, 74.4, 76.19, 73.51, 75.59]
[rank2]:2025-12-31 03:50:31,553 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage2.svg
[rank0]:2025-12-31 03:50:31,559 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage0.svg
[rank1]:2025-12-31 03:50:31,583 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage1.svg
[rank3]:2025-12-31 03:50:31,763 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage3.svg
[rank0]:2025-12-31 03:50:32,081 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage4.svg
[rank1]:2025-12-31 03:50:32,109 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage5.svg
[rank2]:2025-12-31 03:50:32,081 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage6.svg
[rank3]:2025-12-31 03:50:32,298 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0350_stage7.svg
[rank0]:2025-12-31 03:53:45,388 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 03:53:49,330 - Avg. fwd time: 13.0750 / Avg. bwd time: 28.9396 / Avg. batch time: 900.8968 (ms) / GPU bubble ratio: 25.38%
[rank2]:2025-12-31 03:53:49,364 - Avg. fwd time: 7.6733 / Avg. bwd time: 16.7752 / Avg. batch time: 950.4282 (ms) / GPU bubble ratio: 58.84%
[rank2]:2025-12-31 03:53:49,428 -  step: 550  loss: -4.0000  grad_norm:  0.1540  memory: 12.06GiB(25.39%)  tps: 8,245  tflops: 64.46  mfu: 20.66%
[rank3]:2025-12-31 03:53:49,440 -  step: 550  loss:  0.2273  grad_norm:  0.1540  memory: 29.95GiB(63.05%)  tps: 8,245  tflops: 64.46  mfu: 20.66%
[rank1]:2025-12-31 03:53:49,393 - Avg. fwd time: 10.0203 / Avg. bwd time: 21.1403 / Avg. batch time: 996.8591 (ms) / GPU bubble ratio: 49.99%
[rank1]:2025-12-31 03:53:49,431 -  step: 550  loss: -4.0000  grad_norm:  0.1540  memory: 18.49GiB(38.93%)  tps: 8,245  tflops: 64.46  mfu: 20.66%
[rank0]:2025-12-31 03:53:49,406 - Avg. fwd time: 8.3238 / Avg. bwd time: 18.3914 / Avg. batch time: 1018.0830 (ms) / GPU bubble ratio: 58.01%
[rank0]:2025-12-31 03:53:49,442 -  step: 550  loss: -4.0000  grad_norm:  0.1540  memory: 20.42GiB(42.99%)  tps: 8,245  tflops: 64.46  mfu: 20.66%
[rank0]:2025-12-31 03:57:04,083 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 03:57:07,988 - Avg. fwd time: 13.0509 / Avg. bwd time: 28.7309 / Avg. batch time: 897.5667 (ms) / GPU bubble ratio: 25.52%
[rank2]:2025-12-31 03:57:08,023 - Avg. fwd time: 7.6727 / Avg. bwd time: 16.7537 / Avg. batch time: 946.7445 (ms) / GPU bubble ratio: 58.72%
[rank1]:2025-12-31 03:57:08,054 - Avg. fwd time: 10.0257 / Avg. bwd time: 21.1114 / Avg. batch time: 992.9670 (ms) / GPU bubble ratio: 49.83%
[rank3]:2025-12-31 03:57:08,102 -  step: 600  loss:  0.2252  grad_norm:  0.9590  memory: 29.95GiB(63.05%)  tps: 8,247  tflops: 64.47  mfu: 20.66%
[rank2]:2025-12-31 03:57:08,090 -  step: 600  loss: -4.0000  grad_norm:  0.9590  memory: 12.06GiB(25.39%)  tps: 8,247  tflops: 64.47  mfu: 20.66%
[rank0]:2025-12-31 03:57:08,068 - Avg. fwd time: 8.3239 / Avg. bwd time: 18.3705 / Avg. batch time: 1013.6879 (ms) / GPU bubble ratio: 57.87%
[rank0]:2025-12-31 03:57:08,104 -  step: 600  loss: -4.0000  grad_norm:  0.9590  memory: 20.42GiB(42.99%)  tps: 8,247  tflops: 64.47  mfu: 20.66%
[rank1]:2025-12-31 03:57:08,093 -  step: 600  loss: -4.0000  grad_norm:  0.9590  memory: 18.49GiB(38.93%)  tps: 8,247  tflops: 64.47  mfu: 20.66%
[rank1]:2025-12-31 03:57:08,155 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0357_stage1_step600.svg
[rank2]:2025-12-31 03:57:08,155 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0357_stage2_step600.svg
[rank2]:2025-12-31 03:57:08,197 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0357_stage6_step600.svg
[rank0]:2025-12-31 03:57:08,155 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0357_stage0_step600.svg
[rank0]:2025-12-31 03:57:08,197 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0357_stage4_step600.svg
[rank1]:2025-12-31 03:57:08,198 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0357_stage5_step600.svg
[rank2]:2025-12-31 03:57:08,295 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank2_stage2.svg
[rank2]:	> Counts Sum: 137480, Total Sum: 299520 (45.90%), Ratio(%) per element: [47.11, 47.35, 46.15, 47.35, 47.35, 46.87, 46.15, 46.63, 45.91, 46.39, 44.95, 44.71, 44.95, 45.19, 44.47, 44.95, 44.95, 44.71]
[rank0]:2025-12-31 03:57:08,297 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank0_stage0.svg
[rank0]:	> Counts Sum: 96800, Total Sum: 316160 (30.62%), Ratio(%) per element: [27.64, 31.49, 31.73, 31.49, 30.04, 32.45, 32.69, 32.69, 32.21, 33.41, 28.84, 30.76, 31.25, 29.08, 30.04, 29.32, 27.4, 30.04, 29.08]
[rank1]:2025-12-31 03:57:08,322 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank1_stage1.svg
[rank1]:	> Counts Sum: 220320, Total Sum: 449280 (49.04%), Ratio(%) per element: [49.27, 50.48, 50.24, 50.48, 51.2, 49.27, 50.48, 50.96, 50.0, 48.07, 49.03, 49.51, 49.27, 48.07, 48.79, 48.55, 48.31, 47.35, 48.07, 49.27, 48.55, 47.83, 47.59, 47.83, 48.31, 49.27, 47.83]
[rank3]:2025-12-31 03:57:08,341 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0357_step600_rank3.svg
[rank3]:			> Batch Time: 953.50 ms, GPU Bubble Ratio: 55.60%, 48.00%, 59.28%, 35.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-178ms    | [S0,MB5,F]  178-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  327-19-346ms   | [S0,MB7,F]  346-7-354ms    | [S4,MB1,B]  413-19-432ms   | [S4,MB4,F]  451-8-460ms    | [S4,MB2,B]  460-19-479ms   | [S4,MB5,F]  481-8-490ms    | [S4,MB3,B]  490-19-509ms   | [S4,MB6,F]  512-8-521ms    | [S0,MB0,B]  525-25-550ms   | [S4,MB7,F]  551-7-558ms    | [S0,MB1,B]  568-24-592ms   | [S0,MB2,B]  613-23-636ms   | [S0,MB3,B]  658-23-681ms   | [S4,MB4,B]  686-18-705ms   | [S4,MB5,B]  719-18-737ms   | [S4,MB6,B]  778-18-796ms   | [S4,MB7,B]  851-16-867ms   | [S0,MB4,B]  876-19-895ms   | [S0,MB5,B]  906-23-930ms   | [S0,MB6,B]  933-0-933ms    | [S0,MB7,B]  953-0-953ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-134ms   | [S5,MB0,F]  161-8-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-197ms    | [S5,MB3,F]  256-7-263ms    | [S1,MB4,F]  286-10-296ms   | [S5,MB0,B]  296-19-316ms   | [S1,MB5,F]  321-12-334ms   | [S5,MB1,B]  335-19-354ms   | [S1,MB6,F]  354-11-366ms   | [S5,MB2,B]  413-18-432ms   | [S1,MB7,F]  432-12-444ms   | [S5,MB3,B]  459-19-479ms   | [S5,MB4,F]  479-8-488ms    | [S1,MB0,B]  490-30-520ms   | [S5,MB5,F]  519-9-528ms    | [S1,MB1,B]  528-32-560ms   | [S5,MB6,F]  561-10-571ms   | [S1,MB2,B]  572-34-606ms   | [S5,MB7,F]  606-10-617ms   | [S1,MB3,B]  617-34-651ms   | [S5,MB4,B]  658-22-680ms   | [S5,MB5,B]  691-20-712ms   | [S5,MB6,B]  753-18-771ms   | [S5,MB7,B]  835-9-844ms    | [S1,MB4,B]  851-13-864ms   | [S1,MB5,B]  886-13-900ms   | [S1,MB6,B]  906-13-920ms   | [S1,MB7,B]  933-13-947ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  250-6-257ms    | [S6,MB0,B]  257-19-276ms   | [S6,MB3,F]  276-8-285ms    | [S6,MB1,B]  308-20-328ms   | [S2,MB4,F]  328-8-337ms    | [S6,MB2,B]  369-19-389ms   | [S2,MB5,F]  388-7-396ms    | [S6,MB3,B]  432-19-451ms   | [S2,MB6,F]  451-9-460ms    | [S2,MB0,B]  461-19-481ms   | [S2,MB7,F]  480-9-490ms    | [S2,MB1,B]  492-19-512ms   | [S6,MB4,F]  512-7-520ms    | [S2,MB2,B]  528-20-548ms   | [S6,MB5,F]  548-7-555ms    | [S2,MB3,B]  574-19-594ms   | [S6,MB6,F]  594-7-601ms    | [S6,MB4,B]  613-19-633ms   | [S6,MB7,F]  633-7-640ms    | [S6,MB5,B]  665-18-684ms   | [S6,MB6,B]  729-17-747ms   | [S6,MB7,B]  816-13-829ms   | [S2,MB4,B]  835-9-844ms    | [S2,MB5,B]  870-9-879ms    | [S2,MB6,B]  886-11-897ms   | [S2,MB7,B]  906-9-915ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-193ms   | [S7,MB0,B]  205-35-240ms   | [S7,MB1,F]  240-15-256ms   | [S7,MB1,B]  268-32-301ms   | [S7,MB2,F]  301-16-317ms   | [S7,MB2,B]  330-33-363ms   | [S7,MB3,F]  363-16-379ms   | [S7,MB3,B]  392-33-425ms   | [S3,MB4,F]  425-9-435ms    | [S3,MB0,B]  435-12-447ms   | [S3,MB5,F]  447-10-458ms   | [S3,MB1,B]  458-11-470ms   | [S3,MB6,F]  470-9-480ms    | [S3,MB2,B]  480-17-497ms   | [S3,MB7,F]  499-10-509ms   | [S3,MB3,B]  509-22-531ms   | [S7,MB4,F]  534-16-551ms   | [S7,MB4,B]  563-33-596ms   | [S7,MB5,F]  596-16-613ms   | [S7,MB5,B]  626-33-659ms   | [S7,MB6,F]  659-17-676ms   | [S7,MB6,B]  689-33-722ms   | [S7,MB7,F]  723-16-739ms   | [S7,MB7,B]  752-56-808ms   | [S3,MB4,B]  809-14-823ms   | [S3,MB5,B]  822-13-835ms   | [S3,MB6,B]  834-12-846ms   | [S3,MB7,B]  862-16-878ms  
[rank3]:2025-12-31 03:57:08,386 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0357_stage3_step600.svg
[rank2]:2025-12-31 03:57:08,394 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank2_stage6.svg
[rank2]:	> Counts Sum: 28520, Total Sum: 299520 (9.52%), Ratio(%) per element: [11.53, 11.77, 10.09, 12.01, 11.05, 11.77, 11.77, 10.81, 10.57, 9.37, 7.93, 7.69, 7.93, 7.45, 7.21, 7.93, 6.49, 7.93]
[rank0]:2025-12-31 03:57:08,395 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank0_stage4.svg
[rank0]:	> Counts Sum: 18920, Total Sum: 299520 (6.32%), Ratio(%) per element: [5.76, 5.04, 8.89, 5.28, 5.76, 5.76, 6.0, 7.69, 6.73, 6.0, 6.49, 6.25, 6.73, 5.76, 5.04, 6.97, 6.73, 6.73]
[rank1]:2025-12-31 03:57:08,425 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank1_stage5.svg
[rank1]:	> Counts Sum: 45360, Total Sum: 299520 (15.14%), Ratio(%) per element: [15.14, 15.14, 15.14, 14.66, 15.86, 15.14, 15.38, 15.62, 15.14, 14.9, 14.66, 14.9, 15.38, 15.14, 15.14, 14.66, 15.62, 14.9]
[rank3]:2025-12-31 03:57:08,427 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0357_stage7_step600.svg
[rank3]:2025-12-31 03:57:08,526 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank3_stage3.svg
[rank3]:	> Counts Sum: 227800, Total Sum: 299520 (76.06%), Ratio(%) per element: [79.08, 79.32, 79.32, 78.12, 75.72, 76.92, 77.4, 78.84, 75.72, 75.0, 74.03, 74.51, 73.07, 74.51, 74.75, 74.75, 74.27, 73.55]
[rank3]:2025-12-31 03:57:08,605 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0357_rank3_stage7.svg
[rank3]:	> Counts Sum: 138120, Total Sum: 183040 (75.46%), Ratio(%) per element: [74.75, 76.44, 74.51, 75.24, 75.96, 75.0, 75.0, 75.48, 76.2, 75.0, 76.44]
[rank2]:2025-12-31 03:57:09,060 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage2.svg
[rank0]:2025-12-31 03:57:09,069 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage0.svg
[rank1]:2025-12-31 03:57:09,117 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage1.svg
[rank3]:2025-12-31 03:57:09,280 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage3.svg
[rank2]:2025-12-31 03:57:09,711 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage6.svg
[rank0]:2025-12-31 03:57:09,723 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage4.svg
[rank1]:2025-12-31 03:57:09,778 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage5.svg
[rank3]:2025-12-31 03:57:09,933 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0357_stage7.svg
[rank0]:2025-12-31 04:00:24,822 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 04:00:28,725 - Avg. fwd time: 13.0292 / Avg. bwd time: 28.5498 / Avg. batch time: 894.7946 (ms) / GPU bubble ratio: 25.65%
[rank2]:2025-12-31 04:00:28,761 - Avg. fwd time: 7.6727 / Avg. bwd time: 16.7457 / Avg. batch time: 943.8051 (ms) / GPU bubble ratio: 58.60%
[rank1]:2025-12-31 04:00:28,790 - Avg. fwd time: 10.0307 / Avg. bwd time: 21.0906 / Avg. batch time: 989.8552 (ms) / GPU bubble ratio: 49.70%
[rank1]:2025-12-31 04:00:28,830 -  step: 650  loss: -4.0000  grad_norm:  0.1942  memory: 18.49GiB(38.93%)  tps: 8,162  tflops: 63.81  mfu: 20.45%
[rank3]:2025-12-31 04:00:28,839 -  step: 650  loss:  0.2315  grad_norm:  0.1942  memory: 29.95GiB(63.05%)  tps: 8,162  tflops: 63.81  mfu: 20.45%
[rank0]:2025-12-31 04:00:28,805 - Avg. fwd time: 8.3245 / Avg. bwd time: 18.3550 / Avg. batch time: 1010.1692 (ms) / GPU bubble ratio: 57.74%
[rank0]:2025-12-31 04:00:28,841 -  step: 650  loss: -4.0000  grad_norm:  0.1942  memory: 20.42GiB(42.99%)  tps: 8,162  tflops: 63.81  mfu: 20.45%
[rank2]:2025-12-31 04:00:28,827 -  step: 650  loss: -4.0000  grad_norm:  0.1942  memory: 12.06GiB(25.39%)  tps: 8,162  tflops: 63.81  mfu: 20.45%
[rank0]:2025-12-31 04:03:42,896 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:03:46,855 - Avg. fwd time: 13.0095 / Avg. bwd time: 28.3860 / Avg. batch time: 892.1500 (ms) / GPU bubble ratio: 25.76%
[rank0]:2025-12-31 04:03:46,934 - Avg. fwd time: 8.3248 / Avg. bwd time: 18.3338 / Avg. batch time: 1006.7564 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-12-31 04:03:46,889 - Avg. fwd time: 7.6723 / Avg. bwd time: 16.7351 / Avg. batch time: 940.9018 (ms) / GPU bubble ratio: 58.50%
[rank2]:2025-12-31 04:03:46,955 -  step: 700  loss: -4.0000  grad_norm:  0.3741  memory: 12.06GiB(25.39%)  tps: 8,269  tflops: 64.65  mfu: 20.72%
[rank1]:2025-12-31 04:03:46,918 - Avg. fwd time: 10.0355 / Avg. bwd time: 21.0745 / Avg. batch time: 986.8045 (ms) / GPU bubble ratio: 49.56%
[rank1]:2025-12-31 04:03:46,959 -  step: 700  loss: -4.0000  grad_norm:  0.3741  memory: 18.49GiB(38.93%)  tps: 8,269  tflops: 64.65  mfu: 20.72%
[rank3]:2025-12-31 04:03:46,968 -  step: 700  loss:  0.1919  grad_norm:  0.3741  memory: 29.95GiB(63.05%)  tps: 8,269  tflops: 64.65  mfu: 20.72%
[rank0]:2025-12-31 04:03:46,970 -  step: 700  loss: -4.0000  grad_norm:  0.3741  memory: 20.42GiB(42.99%)  tps: 8,269  tflops: 64.65  mfu: 20.72%
[rank0]:2025-12-31 04:03:47,021 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0403_stage0_step700.svg
[rank2]:2025-12-31 04:03:47,023 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0403_stage2_step700.svg
[rank2]:2025-12-31 04:03:47,066 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0403_stage6_step700.svg
[rank1]:2025-12-31 04:03:47,021 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0403_stage1_step700.svg
[rank1]:2025-12-31 04:03:47,065 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0403_stage5_step700.svg
[rank0]:2025-12-31 04:03:47,064 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0403_stage4_step700.svg
[rank2]:2025-12-31 04:03:47,164 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank2_stage2.svg
[rank2]:	> Counts Sum: 164280, Total Sum: 357120 (46.00%), Ratio(%) per element: [47.17, 46.77, 45.96, 47.58, 47.58, 47.17, 45.96, 46.97, 46.37, 46.37, 45.56, 44.75, 45.16, 45.36, 44.35, 44.75, 45.36, 44.75]
[rank1]:2025-12-31 04:03:47,189 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank1_stage1.svg
[rank1]:	> Counts Sum: 263520, Total Sum: 535680 (49.19%), Ratio(%) per element: [49.39, 50.4, 50.2, 50.4, 51.0, 49.39, 50.4, 50.8, 50.0, 48.38, 49.19, 49.59, 49.39, 48.38, 48.99, 48.79, 48.58, 47.78, 48.38, 49.39, 48.79, 48.18, 47.98, 48.18, 48.58, 49.39, 48.18]
[rank3]:2025-12-31 04:03:47,211 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0403_step700_rank3.svg
[rank3]:			> Batch Time: 972.50 ms, GPU Bubble Ratio: 56.01%, 49.03%, 60.07%, 34.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  344-19-364ms   | [S0,MB7,F]  364-7-371ms    | [S4,MB1,B]  431-19-451ms   | [S4,MB4,F]  469-8-478ms    | [S4,MB2,B]  478-19-497ms   | [S4,MB5,F]  500-8-508ms    | [S4,MB3,B]  509-19-528ms   | [S4,MB6,F]  531-8-539ms    | [S0,MB0,B]  543-25-568ms   | [S4,MB7,F]  569-7-577ms    | [S0,MB1,B]  585-24-609ms   | [S0,MB2,B]  630-23-654ms   | [S0,MB3,B]  675-23-699ms   | [S4,MB4,B]  704-18-722ms   | [S4,MB5,B]  736-18-755ms   | [S4,MB6,B]  796-18-814ms   | [S4,MB7,B]  870-16-886ms   | [S0,MB4,B]  895-23-918ms   | [S0,MB5,B]  925-23-948ms   | [S0,MB6,B]  952-0-952ms    | [S0,MB7,B]  972-0-972ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  271-7-278ms    | [S1,MB4,F]  301-10-311ms   | [S5,MB0,B]  311-18-330ms   | [S1,MB5,F]  337-13-350ms   | [S5,MB1,B]  352-19-371ms   | [S1,MB6,F]  371-11-383ms   | [S5,MB2,B]  431-18-450ms   | [S1,MB7,F]  450-12-462ms   | [S5,MB3,B]  478-19-498ms   | [S5,MB4,F]  497-8-506ms    | [S1,MB0,B]  508-30-538ms   | [S5,MB5,F]  537-9-546ms    | [S1,MB1,B]  546-32-579ms   | [S5,MB6,F]  578-10-589ms   | [S1,MB2,B]  589-34-623ms   | [S5,MB7,F]  624-10-634ms   | [S1,MB3,B]  634-34-668ms   | [S5,MB4,B]  675-22-697ms   | [S5,MB5,B]  710-20-730ms   | [S5,MB6,B]  771-18-789ms   | [S5,MB7,B]  854-9-863ms    | [S1,MB4,B]  870-13-883ms   | [S1,MB5,B]  905-13-918ms   | [S1,MB6,B]  925-13-939ms   | [S1,MB7,B]  952-13-966ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  265-6-272ms    | [S6,MB0,B]  272-19-291ms   | [S6,MB3,F]  291-8-299ms    | [S6,MB1,B]  325-20-346ms   | [S2,MB4,F]  346-8-354ms    | [S6,MB2,B]  387-19-406ms   | [S2,MB5,F]  406-7-413ms    | [S6,MB3,B]  450-19-469ms   | [S2,MB6,F]  469-9-478ms    | [S2,MB0,B]  479-19-499ms   | [S2,MB7,F]  499-8-508ms    | [S2,MB1,B]  510-19-530ms   | [S6,MB4,F]  530-7-537ms    | [S2,MB2,B]  545-20-565ms   | [S6,MB5,F]  565-7-573ms    | [S2,MB3,B]  591-19-611ms   | [S6,MB6,F]  611-7-618ms    | [S6,MB4,B]  631-19-650ms   | [S6,MB7,F]  650-7-658ms    | [S6,MB5,B]  684-18-703ms   | [S6,MB6,B]  747-17-764ms   | [S6,MB7,B]  833-14-847ms   | [S2,MB4,B]  854-9-863ms    | [S2,MB5,B]  889-9-898ms    | [S2,MB6,B]  904-10-915ms   | [S2,MB7,B]  924-9-933ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,B]  204-51-255ms   | [S7,MB1,F]  255-18-273ms   | [S7,MB1,B]  285-33-318ms   | [S7,MB2,F]  318-16-335ms   | [S7,MB2,B]  346-33-379ms   | [S7,MB3,F]  380-17-398ms   | [S7,MB3,B]  409-33-443ms   | [S3,MB4,F]  443-9-453ms    | [S3,MB0,B]  453-12-465ms   | [S3,MB5,F]  465-10-476ms   | [S3,MB1,B]  476-12-488ms   | [S3,MB6,F]  489-9-499ms    | [S3,MB2,B]  499-17-517ms   | [S3,MB7,F]  517-9-527ms    | [S3,MB3,B]  527-22-550ms   | [S7,MB4,F]  552-16-569ms   | [S7,MB4,B]  582-33-615ms   | [S7,MB5,F]  615-16-632ms   | [S7,MB5,B]  644-33-677ms   | [S7,MB6,F]  677-17-695ms   | [S7,MB6,B]  707-33-740ms   | [S7,MB7,F]  740-16-757ms   | [S7,MB7,B]  770-56-827ms   | [S3,MB4,B]  826-14-841ms   | [S3,MB5,B]  841-13-854ms   | [S3,MB6,B]  853-11-865ms   | [S3,MB7,B]  880-14-895ms  
[rank0]:2025-12-31 04:03:47,164 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank0_stage0.svg
[rank0]:	> Counts Sum: 114800, Total Sum: 376960 (30.45%), Ratio(%) per element: [27.41, 31.85, 31.85, 31.65, 30.44, 32.05, 32.66, 32.66, 32.25, 32.45, 28.62, 30.64, 30.64, 28.83, 29.63, 29.03, 27.21, 29.83, 28.83]
[rank0]:2025-12-31 04:03:47,262 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank0_stage4.svg
[rank0]:	> Counts Sum: 20520, Total Sum: 357120 (5.75%), Ratio(%) per element: [5.24, 4.63, 7.45, 5.24, 5.44, 5.04, 5.64, 6.65, 5.84, 5.04, 6.45, 5.64, 6.25, 5.04, 4.43, 6.65, 6.65, 6.04]
[rank2]:2025-12-31 04:03:47,263 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank2_stage6.svg
[rank2]:	> Counts Sum: 32120, Total Sum: 357120 (8.99%), Ratio(%) per element: [10.48, 10.88, 9.67, 11.49, 10.88, 10.88, 10.88, 10.48, 10.08, 8.66, 7.05, 7.66, 8.06, 6.45, 6.65, 7.45, 6.45, 7.66]
[rank1]:2025-12-31 04:03:47,288 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank1_stage5.svg
[rank1]:	> Counts Sum: 52560, Total Sum: 357120 (14.72%), Ratio(%) per element: [14.71, 14.71, 14.71, 14.31, 15.32, 14.71, 14.91, 15.12, 14.71, 14.51, 14.31, 14.51, 14.91, 14.71, 14.71, 14.31, 15.12, 14.51]
[rank3]:2025-12-31 04:03:47,258 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0403_stage3_step700.svg
[rank3]:2025-12-31 04:03:47,301 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0403_stage7_step700.svg
[rank3]:2025-12-31 04:03:47,400 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank3_stage3.svg
[rank3]:	> Counts Sum: 273800, Total Sum: 357120 (76.67%), Ratio(%) per element: [79.03, 79.43, 79.23, 78.22, 75.4, 77.62, 78.22, 79.83, 76.81, 75.8, 74.59, 75.4, 74.39, 75.4, 75.0, 76.0, 75.2, 74.39]
[rank3]:2025-12-31 04:03:47,480 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0403_rank3_stage7.svg
[rank3]:	> Counts Sum: 166120, Total Sum: 218240 (76.12%), Ratio(%) per element: [75.4, 77.21, 75.0, 75.6, 77.01, 76.0, 75.6, 76.61, 76.41, 75.6, 76.81]
[rank0]:2025-12-31 04:03:48,055 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage0.svg
[rank2]:2025-12-31 04:03:48,057 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage2.svg
[rank1]:2025-12-31 04:03:48,092 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage1.svg
[rank3]:2025-12-31 04:03:48,276 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage3.svg
[rank0]:2025-12-31 04:03:48,838 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage4.svg
[rank2]:2025-12-31 04:03:48,842 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage6.svg
[rank1]:2025-12-31 04:03:48,885 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage5.svg
[rank3]:2025-12-31 04:03:49,055 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0403_stage7.svg
[rank0]:2025-12-31 04:07:03,749 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-31 04:07:07,693 - Avg. fwd time: 12.9952 / Avg. bwd time: 28.2620 / Avg. batch time: 890.1160 (ms) / GPU bubble ratio: 25.84%
[rank2]:2025-12-31 04:07:07,729 - Avg. fwd time: 7.6718 / Avg. bwd time: 16.7235 / Avg. batch time: 938.6903 (ms) / GPU bubble ratio: 58.42%
[rank1]:2025-12-31 04:07:07,758 - Avg. fwd time: 10.0392 / Avg. bwd time: 21.0568 / Avg. batch time: 984.4644 (ms) / GPU bubble ratio: 49.46%
[rank0]:2025-12-31 04:07:07,774 - Avg. fwd time: 8.3251 / Avg. bwd time: 18.3225 / Avg. batch time: 1004.1133 (ms) / GPU bubble ratio: 57.54%
[rank0]:2025-12-31 04:07:07,810 -  step: 750  loss: -4.0000  grad_norm:  0.2783  memory: 20.42GiB(42.99%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank2]:2025-12-31 04:07:07,796 -  step: 750  loss: -4.0000  grad_norm:  0.2783  memory: 12.06GiB(25.39%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank1]:2025-12-31 04:07:07,799 -  step: 750  loss: -4.0000  grad_norm:  0.2783  memory: 18.49GiB(38.93%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank3]:2025-12-31 04:07:07,808 -  step: 750  loss:  0.2355  grad_norm:  0.2783  memory: 29.99GiB(63.13%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank0]:2025-12-31 04:10:21,957 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:10:25,871 - Avg. fwd time: 12.9816 / Avg. bwd time: 28.1365 / Avg. batch time: 888.1121 (ms) / GPU bubble ratio: 25.92%
[rank2]:2025-12-31 04:10:25,904 - Avg. fwd time: 7.6715 / Avg. bwd time: 16.7164 / Avg. batch time: 936.4966 (ms) / GPU bubble ratio: 58.33%
[rank2]:2025-12-31 04:10:25,973 -  step: 800  loss: -4.0000  grad_norm:  1.0768  memory: 12.06GiB(25.39%)  tps: 8,267  tflops: 64.63  mfu: 20.71%
[rank2]:2025-12-31 04:10:25,973 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0768  tps: 8,425  tflops: 65.86  mfu: 19.27%
[rank2]:2025-12-31 04:10:25,973 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 04:10:25,974 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 04:10:25,951 - Avg. fwd time: 8.3255 / Avg. bwd time: 18.3051 / Avg. batch time: 1001.5273 (ms) / GPU bubble ratio: 57.46%
[rank0]:2025-12-31 04:10:25,987 -  step: 800  loss: -4.0000  grad_norm:  1.0768  memory: 20.42GiB(42.99%)  tps: 8,267  tflops: 64.63  mfu: 20.71%
[rank0]:2025-12-31 04:10:25,987 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0768  tps: 8,425  tflops: 65.86  mfu: 19.28%
[rank0]:2025-12-31 04:10:25,987 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 04:10:25,988 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 04:10:25,935 - Avg. fwd time: 10.0426 / Avg. bwd time: 21.0423 / Avg. batch time: 982.1562 (ms) / GPU bubble ratio: 49.36%
[rank1]:2025-12-31 04:10:25,976 -  step: 800  loss: -4.0000  grad_norm:  1.0768  memory: 18.49GiB(38.93%)  tps: 8,267  tflops: 64.63  mfu: 20.71%
[rank1]:2025-12-31 04:10:25,976 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0768  tps: 8,425  tflops: 65.87  mfu: 19.29%
[rank1]:2025-12-31 04:10:25,977 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 04:10:25,977 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-31 04:10:25,985 -  step: 800  loss:  0.2387  grad_norm:  1.0768  memory: 29.99GiB(63.13%)  tps: 8,267  tflops: 64.63  mfu: 20.72%
[rank3]:2025-12-31 04:10:25,986 - â„¹ï¸ final step: 800  loss:  0.2387  grad_norm:  1.0768  tps: 8,431  tflops: 65.91  mfu: 19.40%
[rank3]:2025-12-31 04:10:25,986 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 04:10:25,987 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 04:10:27,940 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-31 04:10:28,011 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0410_stage1_final800.svg
[rank2]:2025-12-31 04:10:28,011 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0410_stage2_final800.svg
[rank2]:2025-12-31 04:10:28,057 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251231_0410_stage6_final800.svg
[rank0]:2025-12-31 04:10:28,011 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0410_stage0_final800.svg
[rank0]:2025-12-31 04:10:28,056 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251231_0410_stage4_final800.svg
[rank1]:2025-12-31 04:10:28,056 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251231_0410_stage5_final800.svg
[rank2]:2025-12-31 04:10:28,155 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank2_stage2.svg
[rank2]:	> Counts Sum: 191080, Total Sum: 414720 (46.07%), Ratio(%) per element: [47.56, 46.35, 45.83, 47.91, 47.39, 47.04, 46.0, 47.04, 46.7, 46.18, 46.0, 44.96, 44.96, 45.13, 44.61, 44.79, 45.65, 45.13]
[rank0]:2025-12-31 04:10:28,157 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank0_stage0.svg
[rank0]:	> Counts Sum: 132800, Total Sum: 437760 (30.34%), Ratio(%) per element: [27.25, 31.94, 32.11, 31.77, 30.55, 31.77, 32.46, 32.46, 32.29, 32.63, 28.64, 30.2, 30.03, 28.64, 29.68, 28.81, 27.25, 29.34, 28.47]
[rank1]:2025-12-31 04:10:28,180 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank1_stage1.svg
[rank1]:	> Counts Sum: 306720, Total Sum: 622080 (49.31%), Ratio(%) per element: [49.47, 50.34, 50.17, 50.34, 50.86, 49.47, 50.34, 50.69, 50.0, 48.61, 49.3, 49.65, 49.47, 48.61, 49.13, 48.95, 48.78, 48.09, 48.61, 49.47, 48.95, 48.43, 48.26, 48.43, 48.78, 49.47, 48.43]
[rank3]:2025-12-31 04:10:28,201 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0410_final800_rank3.svg
[rank3]:			> Batch Time: 967.50 ms, GPU Bubble Ratio: 56.14%, 49.04%, 59.82%, 34.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-178ms    | [S0,MB5,F]  178-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  343-19-362ms   | [S0,MB7,F]  361-7-369ms    | [S4,MB1,B]  429-19-448ms   | [S4,MB4,F]  467-8-475ms    | [S4,MB2,B]  475-19-494ms   | [S4,MB5,F]  497-8-506ms    | [S4,MB3,B]  506-19-526ms   | [S4,MB6,F]  528-8-537ms    | [S0,MB0,B]  542-25-567ms   | [S4,MB7,F]  567-7-575ms    | [S0,MB1,B]  583-24-608ms   | [S0,MB2,B]  628-23-651ms   | [S0,MB3,B]  673-23-696ms   | [S4,MB4,B]  702-18-720ms   | [S4,MB5,B]  734-18-752ms   | [S4,MB6,B]  792-18-810ms   | [S4,MB7,B]  865-16-882ms   | [S0,MB4,B]  890-19-909ms   | [S0,MB5,B]  920-23-944ms   | [S0,MB6,B]  947-0-947ms    | [S0,MB7,B]  967-0-967ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-8-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  269-7-276ms    | [S1,MB4,F]  298-10-309ms   | [S5,MB0,B]  309-18-328ms   | [S1,MB5,F]  336-12-349ms   | [S5,MB1,B]  351-19-370ms   | [S1,MB6,F]  370-11-382ms   | [S5,MB2,B]  429-18-448ms   | [S1,MB7,F]  448-12-460ms   | [S5,MB3,B]  475-19-495ms   | [S5,MB4,F]  495-8-504ms    | [S1,MB0,B]  505-30-535ms   | [S5,MB5,F]  535-9-545ms    | [S1,MB1,B]  545-32-577ms   | [S5,MB6,F]  577-10-587ms   | [S1,MB2,B]  587-34-621ms   | [S5,MB7,F]  621-10-632ms   | [S1,MB3,B]  632-34-666ms   | [S5,MB4,B]  673-22-695ms   | [S5,MB5,B]  707-19-726ms   | [S5,MB6,B]  768-18-786ms   | [S5,MB7,B]  850-9-859ms    | [S1,MB4,B]  865-13-879ms   | [S1,MB5,B]  900-13-914ms   | [S1,MB6,B]  920-13-934ms   | [S1,MB7,B]  947-13-961ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  263-6-270ms    | [S6,MB0,B]  270-19-289ms   | [S6,MB3,F]  289-8-298ms    | [S6,MB1,B]  323-20-344ms   | [S2,MB4,F]  344-8-353ms    | [S6,MB2,B]  385-19-405ms   | [S2,MB5,F]  404-7-412ms    | [S6,MB3,B]  448-19-467ms   | [S2,MB6,F]  467-8-476ms    | [S2,MB0,B]  477-19-497ms   | [S2,MB7,F]  497-8-506ms    | [S2,MB1,B]  507-19-527ms   | [S6,MB4,F]  527-7-535ms    | [S2,MB2,B]  544-20-564ms   | [S6,MB5,F]  564-7-572ms    | [S2,MB3,B]  589-19-609ms   | [S6,MB6,F]  609-7-616ms    | [S6,MB4,B]  628-19-648ms   | [S6,MB7,F]  648-7-655ms    | [S6,MB5,B]  681-18-700ms   | [S6,MB6,B]  744-17-762ms   | [S6,MB7,B]  830-13-843ms   | [S2,MB4,B]  850-9-859ms    | [S2,MB5,B]  884-9-893ms    | [S2,MB6,B]  899-11-911ms   | [S2,MB7,B]  920-9-929ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,B]  204-49-254ms   | [S7,MB1,F]  254-17-271ms   | [S7,MB1,B]  283-33-316ms   | [S7,MB2,F]  317-16-334ms   | [S7,MB2,B]  345-33-378ms   | [S7,MB3,F]  379-17-396ms   | [S7,MB3,B]  407-34-441ms   | [S3,MB4,F]  441-9-451ms    | [S3,MB0,B]  451-12-463ms   | [S3,MB5,F]  463-10-474ms   | [S3,MB1,B]  474-12-486ms   | [S3,MB6,F]  486-10-496ms   | [S3,MB2,B]  496-16-513ms   | [S3,MB7,F]  514-10-524ms   | [S3,MB3,B]  524-22-547ms   | [S7,MB4,F]  551-16-567ms   | [S7,MB4,B]  580-33-613ms   | [S7,MB5,F]  613-16-629ms   | [S7,MB5,B]  641-33-675ms   | [S7,MB6,F]  675-18-693ms   | [S7,MB6,B]  704-33-737ms   | [S7,MB7,F]  737-17-754ms   | [S7,MB7,B]  766-56-823ms   | [S3,MB4,B]  823-14-838ms   | [S3,MB5,B]  837-13-850ms   | [S3,MB6,B]  850-12-862ms   | [S3,MB7,B]  875-16-891ms  
[rank2]:2025-12-31 04:10:28,253 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank2_stage6.svg
[rank2]:	> Counts Sum: 35720, Total Sum: 414720 (8.61%), Ratio(%) per element: [10.41, 10.59, 9.37, 10.59, 10.76, 10.93, 10.41, 10.06, 9.37, 7.98, 6.59, 7.11, 7.46, 6.25, 6.42, 6.94, 6.42, 7.29]
[rank0]:2025-12-31 04:10:28,258 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank0_stage4.svg
[rank0]:	> Counts Sum: 22120, Total Sum: 414720 (5.33%), Ratio(%) per element: [4.68, 4.51, 6.59, 4.86, 5.03, 4.68, 5.38, 6.07, 5.55, 4.86, 6.25, 5.2, 5.72, 4.68, 4.16, 6.25, 5.9, 5.55]
[rank1]:2025-12-31 04:10:28,281 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank1_stage5.svg
[rank1]:	> Counts Sum: 59760, Total Sum: 414720 (14.41%), Ratio(%) per element: [14.4, 14.4, 14.4, 14.06, 14.93, 14.4, 14.58, 14.75, 14.4, 14.23, 14.06, 14.23, 14.58, 14.4, 14.4, 14.06, 14.75, 14.23]
[rank3]:2025-12-31 04:10:28,432 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/pipeline_schedule/251231_0410_thry_final800_rank3.svg
[rank3]:			> Batch Time: 554.33 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-38ms      | [S4,MB0,F]  38-9-48ms      | [S4,MB1,F]  48-9-58ms      | [S4,MB2,F]  58-9-68ms      | [S4,MB3,F]  68-9-77ms      | [S0,MB4,F]  77-9-87ms      | [S0,MB5,F]  87-9-97ms      | [S0,MB6,F]  97-9-106ms     | [S4,MB0,B]  136-19-155ms   | [S0,MB7,F]  155-9-165ms    | [S4,MB1,B]  165-19-184ms   | [S4,MB4,F]  194-9-204ms    | [S4,MB2,B]  204-19-223ms   | [S4,MB5,F]  223-9-233ms    | [S4,MB3,B]  233-19-252ms   | [S4,MB6,F]  252-9-262ms    | [S0,MB0,B]  262-19-282ms   | [S4,MB7,F]  282-9-291ms    | [S0,MB1,B]  291-19-311ms   | [S0,MB2,B]  311-19-330ms   | [S0,MB3,B]  340-19-359ms   | [S4,MB4,B]  369-19-389ms   | [S4,MB5,B]  398-19-418ms   | [S4,MB6,B]  427-19-447ms   | [S4,MB7,B]  457-19-476ms   | [S0,MB4,B]  476-19-495ms   | [S0,MB5,B]  495-19-515ms   | [S0,MB6,B]  515-19-534ms   | [S0,MB7,B]  534-19-554ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-38ms      | [S1,MB3,F]  38-9-48ms      | [S5,MB0,F]  48-9-58ms      | [S5,MB1,F]  58-9-68ms      | [S5,MB2,F]  68-9-77ms      | [S5,MB3,F]  77-9-87ms      | [S1,MB4,F]  87-9-97ms      | [S5,MB0,B]  116-19-136ms   | [S1,MB5,F]  136-9-145ms    | [S5,MB1,B]  145-19-165ms   | [S1,MB6,F]  165-9-175ms    | [S5,MB2,B]  175-19-194ms   | [S1,MB7,F]  194-9-204ms    | [S5,MB3,B]  204-19-223ms   | [S5,MB4,F]  223-9-233ms    | [S1,MB0,B]  233-19-252ms   | [S5,MB5,F]  252-9-262ms    | [S1,MB1,B]  262-19-282ms   | [S5,MB6,F]  282-9-291ms    | [S1,MB2,B]  291-19-311ms   | [S5,MB7,F]  311-9-320ms    | [S1,MB3,B]  320-19-340ms   | [S5,MB4,B]  350-19-369ms   | [S5,MB5,B]  379-19-398ms   | [S5,MB6,B]  408-19-427ms   | [S5,MB7,B]  437-19-457ms   | [S1,MB4,B]  457-19-476ms   | [S1,MB5,B]  476-19-495ms   | [S1,MB6,B]  495-19-515ms   | [S1,MB7,B]  515-19-534ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-38ms      | [S2,MB2,F]  38-9-48ms      | [S2,MB3,F]  48-9-58ms      | [S6,MB0,F]  58-9-68ms      | [S6,MB1,F]  68-9-77ms      | [S6,MB2,F]  77-9-87ms      | [S6,MB0,B]  97-19-116ms    | [S6,MB3,F]  116-9-126ms    | [S6,MB1,B]  126-19-145ms   | [S2,MB4,F]  145-9-155ms    | [S6,MB2,B]  155-19-175ms   | [S2,MB5,F]  175-9-184ms    | [S6,MB3,B]  184-19-204ms   | [S2,MB6,F]  204-9-213ms    | [S2,MB0,B]  213-19-233ms   | [S2,MB7,F]  233-9-243ms    | [S2,MB1,B]  243-19-262ms   | [S6,MB4,F]  262-9-272ms    | [S2,MB2,B]  272-19-291ms   | [S6,MB5,F]  291-9-301ms    | [S2,MB3,B]  301-19-320ms   | [S6,MB6,F]  320-9-330ms    | [S6,MB4,B]  330-19-350ms   | [S6,MB7,F]  350-9-359ms    | [S6,MB5,B]  359-19-379ms   | [S6,MB6,B]  389-19-408ms   | [S6,MB7,B]  418-19-437ms   | [S2,MB4,B]  437-19-457ms   | [S2,MB5,B]  457-19-476ms   | [S2,MB6,B]  476-19-495ms   | [S2,MB7,B]  495-19-515ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-38ms      | [S3,MB1,F]  38-9-48ms      | [S3,MB2,F]  48-9-58ms      | [S3,MB3,F]  58-9-68ms      | [S7,MB0,F]  68-9-77ms      | [S7,MB0,B]  77-19-97ms     | [S7,MB1,F]  97-9-106ms     | [S7,MB1,B]  106-19-126ms   | [S7,MB2,F]  126-9-136ms    | [S7,MB2,B]  136-19-155ms   | [S7,MB3,F]  155-9-165ms    | [S7,MB3,B]  165-19-184ms   | [S3,MB4,F]  184-9-194ms    | [S3,MB0,B]  194-19-213ms   | [S3,MB5,F]  213-9-223ms    | [S3,MB1,B]  223-19-243ms   | [S3,MB6,F]  243-9-252ms    | [S3,MB2,B]  252-19-272ms   | [S3,MB7,F]  272-9-282ms    | [S3,MB3,B]  282-19-301ms   | [S7,MB4,F]  301-9-311ms    | [S7,MB4,B]  311-19-330ms   | [S7,MB5,F]  330-9-340ms    | [S7,MB5,B]  340-19-359ms   | [S7,MB6,F]  359-9-369ms    | [S7,MB6,B]  369-19-389ms   | [S7,MB7,F]  389-9-398ms    | [S7,MB7,B]  398-19-418ms   | [S3,MB4,B]  418-19-437ms   | [S3,MB5,B]  437-19-457ms   | [S3,MB6,B]  457-19-476ms   | [S3,MB7,B]  476-19-495ms  
[rank3]:2025-12-31 04:10:28,480 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0410_stage3_final800.svg
[rank3]:2025-12-31 04:10:28,524 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251231_0410_stage7_final800.svg
[rank3]:2025-12-31 04:10:28,622 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank3_stage3.svg
[rank3]:	> Counts Sum: 319800, Total Sum: 414720 (77.11%), Ratio(%) per element: [79.34, 79.51, 79.51, 78.81, 75.86, 78.12, 78.47, 79.34, 78.12, 76.73, 74.65, 75.69, 75.52, 75.69, 75.17, 76.73, 76.21, 74.47]
[rank3]:2025-12-31 04:10:28,702 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/frozen_params_histogram/251231_0410_rank3_stage7.svg
[rank3]:	> Counts Sum: 194120, Total Sum: 253440 (76.59%), Ratio(%) per element: [75.86, 77.25, 75.86, 75.69, 76.9, 76.73, 76.38, 77.08, 77.08, 76.56, 77.08]
[rank2]:2025-12-31 04:10:29,170 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage2.svg
[rank0]:2025-12-31 04:10:29,188 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage0.svg
[rank1]:2025-12-31 04:10:29,198 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage1.svg
[rank3]:2025-12-31 04:10:29,622 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage3.svg
[rank2]:2025-12-31 04:10:30,076 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage6.svg
[rank2]:2025-12-31 04:10:30,080 - Destroying the purge thread.
[rank0]:2025-12-31 04:10:30,085 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage4.svg
[rank0]:2025-12-31 04:10:30,090 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-31 04:10:30,115 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage5.svg
[rank1]:2025-12-31 04:10:30,118 - Destroying the purge thread.
[rank2]:2025-12-31 04:10:30,265 - Process group destroyed
[rank1]:2025-12-31 04:10:30,292 - Process group destroyed
[rank3]:2025-12-31 04:10:30,517 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1/afr_time_plot/251231_0410_stage7.svg
[rank3]:2025-12-31 04:10:30,521 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 346-371
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.88679
[rank3]:wandb:               final/avg_loss 0.23866
[rank3]:wandb:             final/avg_mfu(%) 19.40012
[rank3]:wandb:             final/avg_tflops 65.90662
[rank3]:wandb:    final/avg_throughput(tps) 8430.609
[rank3]:wandb:              final/grad_norm 1.07675
[rank3]:wandb:               final/max_loss 0.23866
[rank3]:wandb:                    grad_norm 1.07675
[rank3]:wandb: loss_metrics/global_avg_loss 0.23866
[rank3]:wandb: loss_metrics/global_max_loss 0.23866
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_Interleaved1F1B_timelyauto_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/k4z2ts7c
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_timelyauto_22_dm1/20251231-0315/wandb/run-20251231_031520-k4z2ts7c/logs
[rank3]:2025-12-31 04:10:31,859 - Process group destroyed
[rank0]:2025-12-31 04:10:32,090 - Training completed
[rank0]:2025-12-31 04:10:32,091 - Destroying the purge thread.
[rank0]:2025-12-31 04:10:32,324 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_Interleaved1F1B_timelyauto_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
