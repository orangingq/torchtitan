
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 03:39:05 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_1F1B_fullrand7_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-24 03:39:12,205 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank0]:2025-12-24 03:39:12,240 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank0]:2025-12-24 03:39:12,588 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 03:39:12,589 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 03:39:12,592 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 03:39:12,593 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-24 03:39:12,584 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 03:39:12,586 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-24 03:39:12,836 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank1]:2025-12-24 03:39:12,841 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank0]:2025-12-24 03:39:12,994 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-24 03:39:13,292 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 03:39:13,295 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-24 03:39:13,292 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 03:39:13,294 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 03:39:15,767 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-24 03:39:15,852 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 03:39:15,890 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 03:39:15,916 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-24 03:39:15,916 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-24 03:39:15,915 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 03:39:15,948 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 03:39:15,949 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-24 03:39:15,971 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-24 03:39:15,971 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-24 03:39:16,094 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 03:39:16,094 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 03:39:16,094 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-24 03:39:16,152 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 03:39:16,152 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 03:39:16,153 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-24 03:39:16,874 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 03:39:16,913 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 03:39:16,940 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-24 03:39:16,940 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-24 03:39:17,140 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 03:39:17,141 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 03:39:17,142 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run dozzgr3s
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_1F1B_fullrand7_42_dm1/20251224-0339/wandb/run-20251224_033917-dozzgr3s
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_1F1B_fullrand7_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/dozzgr3s
[rank3]:2025-12-24 03:39:18,748 - WandB logging enabled
[rank3]:2025-12-24 03:39:18,748 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 03:39:18,787 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 03:39:18,817 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-24 03:39:18,817 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-24 03:39:19,001 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 03:39:19,002 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 03:39:19,003 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 03:39:19,017 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-24 03:39:19,018 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 03:39:19,017 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_1F1B_fullrand7_42_dm1
[rank0]:2025-12-24 03:39:19,017 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-24 03:39:19,017 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 03:39:19,017 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 03:39:19,018 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-24 03:39:21,537 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 03:39:21,537 - Finished loading the checkpoint in 2.52 seconds.
[rank0]:2025-12-24 03:39:21,537 - Training starts at step 1
[rank2]:2025-12-24 03:39:26,846 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory:  6.84GiB(14.41%)  tps: 2,991  tflops: 23.38  mfu: 7.49%
[rank2]:2025-12-24 03:39:26,846 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-24 03:39:26,857 -  step:  1  loss: 10.6092  grad_norm: 203.0656  memory: 21.88GiB(46.05%)  tps: 4,062  tflops: 31.76  mfu: 10.18%
[rank3]:2025-12-24 03:39:26,857 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 03:39:26,885 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 13.10GiB(27.57%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank0]:2025-12-24 03:39:26,885 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 03:39:26,852 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 10.58GiB(22.26%)  tps: 3,297  tflops: 25.78  mfu: 8.26%
[rank1]:2025-12-24 03:39:26,852 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 03:43:18,631 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 03:43:23,325 - Avg. fwd time: 24.3846 / Avg. bwd time: 80.2231 / Avg. batch time: 982.6039 (ms) / GPU bubble ratio: 14.83%
[rank2]:2025-12-24 03:43:23,368 - Avg. fwd time: 15.3754 / Avg. bwd time: 35.8955 / Avg. batch time: 1042.0851 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-12-24 03:43:23,421 - Avg. fwd time: 19.6492 / Avg. bwd time: 46.1499 / Avg. batch time: 1115.5992 (ms) / GPU bubble ratio: 52.82%
[rank0]:2025-12-24 03:43:23,469 - Avg. fwd time: 15.9152 / Avg. bwd time: 41.4631 / Avg. batch time: 1181.4478 (ms) / GPU bubble ratio: 61.15%
[rank3]:2025-12-24 03:43:23,503 -  step: 50  loss:  9.8822  grad_norm: 24.3697  memory: 25.79GiB(54.28%)  tps: 6,785  tflops: 53.04  mfu: 17.00%
[rank2]:2025-12-24 03:43:23,491 -  step: 50  loss: -4.0000  grad_norm: 24.3697  memory:  8.66GiB(18.23%)  tps: 6,785  tflops: 53.04  mfu: 17.00%
[rank1]:2025-12-24 03:43:23,494 -  step: 50  loss: -4.0000  grad_norm: 24.3697  memory: 12.86GiB(27.07%)  tps: 6,785  tflops: 53.04  mfu: 17.00%
[rank0]:2025-12-24 03:43:23,507 -  step: 50  loss: -4.0000  grad_norm: 24.3697  memory: 16.87GiB(35.50%)  tps: 6,786  tflops: 53.05  mfu: 17.00%
[rank3]:2025-12-24 03:44:07,055 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-24 03:44:55,990 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-24 03:44:56,400 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-24 03:44:56,449 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-24 03:44:56,493 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-24 03:45:45,068 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-24 03:45:45,625 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-24 03:46:51,958 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-24 03:46:52,352 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 03:46:52,377 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 03:46:52,369 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-24 03:46:52,370 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.34)/0.34, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-24 03:46:52,523 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0346_max_batch_time.svg
[rank3]:			> Batch Time: 1034.39 ms, GPU Bubble Ratio: 55.27%, 48.60%, 59.92%, 17.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  238-42-281ms   | [S0,MB4,F]  281-15-296ms   | [S0,MB1,B]  345-41-387ms   | [S0,MB5,F]  387-15-402ms   | [S0,MB2,B]  453-41-494ms   | [S0,MB6,F]  494-15-510ms   | [S0,MB3,B]  560-41-602ms   | [S0,MB7,F]  602-15-618ms   | [S0,MB4,B]  669-41-711ms   | [S0,MB5,B]  777-41-819ms   | [S0,MB6,B]  885-41-927ms   | [S0,MB7,B]  992-41-1034ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-74ms     | [S1,MB0,B]  191-47-238ms   | [S1,MB3,F]  238-19-258ms   | [S1,MB1,B]  298-46-345ms   | [S1,MB4,F]  345-20-365ms   | [S1,MB2,B]  406-46-453ms   | [S1,MB5,F]  453-20-473ms   | [S1,MB3,B]  514-46-560ms   | [S1,MB6,F]  560-20-581ms   | [S1,MB4,B]  622-46-669ms   | [S1,MB7,F]  669-20-689ms   | [S1,MB5,B]  730-46-777ms   | [S1,MB6,B]  838-46-885ms   | [S1,MB7,B]  946-46-992ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-16-53ms     | [S2,MB1,F]  55-14-70ms     | [S2,MB0,B]  155-36-191ms   | [S2,MB2,F]  191-15-207ms   | [S2,MB1,B]  262-36-298ms   | [S2,MB3,F]  298-15-314ms   | [S2,MB2,B]  370-36-406ms   | [S2,MB4,F]  406-15-422ms   | [S2,MB3,B]  477-36-514ms   | [S2,MB5,F]  514-15-529ms   | [S2,MB4,B]  586-36-622ms   | [S2,MB6,F]  622-15-638ms   | [S2,MB5,B]  694-36-730ms   | [S2,MB7,F]  730-15-746ms   | [S2,MB6,B]  802-36-838ms   | [S2,MB7,B]  909-36-946ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  76-78-155ms    AFR(10):0.9655 | [S3,MB1,F]  155-24-179ms   | [S3,MB1,B]  179-83-262ms   AFR(10):0.9655 | [S3,MB2,F]  262-24-287ms   | [S3,MB2,B]  287-83-370ms   AFR(10):0.9655 | [S3,MB3,F]  370-24-394ms   | [S3,MB3,B]  394-83-477ms   AFR(10):0.9655 | [S3,MB4,F]  477-25-502ms   | [S3,MB4,B]  502-83-586ms   AFR(10):0.9655 | [S3,MB5,F]  586-25-611ms   | [S3,MB5,B]  611-83-694ms   AFR(10):0.9655 | [S3,MB6,F]  694-24-719ms   | [S3,MB6,B]  719-82-802ms   AFR(10):0.9655 | [S3,MB7,F]  802-24-827ms   | [S3,MB7,B]  827-82-909ms   AFR(10):0.9655
[rank3]:2025-12-24 03:46:52,657 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0346_min_batch_time.svg
[rank3]:			> Batch Time: 642.89 ms, GPU Bubble Ratio: 80.17%, 46.38%, 57.97%, 14.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  160-0-160ms    | [S0,MB4,F]  160-15-175ms   | [S0,MB1,B]  228-0-228ms    | [S0,MB5,F]  228-15-243ms   | [S0,MB2,B]  297-0-297ms    | [S0,MB6,F]  297-15-312ms   | [S0,MB3,B]  365-0-365ms    | [S0,MB7,F]  365-15-381ms   | [S0,MB4,B]  436-0-436ms    | [S0,MB5,B]  505-0-505ms    | [S0,MB6,B]  573-0-573ms    | [S0,MB7,B]  642-0-642ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-74ms     | [S1,MB0,B]  137-23-160ms   | [S1,MB3,F]  160-19-180ms   | [S1,MB1,B]  205-23-228ms   | [S1,MB4,F]  228-20-248ms   | [S1,MB2,B]  274-23-297ms   | [S1,MB5,F]  297-20-317ms   | [S1,MB3,B]  342-23-365ms   | [S1,MB6,F]  365-20-386ms   | [S1,MB4,B]  412-23-436ms   | [S1,MB7,F]  436-20-456ms   | [S1,MB5,B]  481-23-505ms   | [S1,MB6,B]  550-23-573ms   | [S1,MB7,B]  619-23-642ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-16-53ms     | [S2,MB1,F]  55-14-70ms     | [S2,MB0,B]  119-18-137ms   | [S2,MB2,F]  137-15-152ms   | [S2,MB1,B]  186-18-205ms   | [S2,MB3,F]  205-15-220ms   | [S2,MB2,B]  255-18-274ms   | [S2,MB4,F]  274-15-289ms   | [S2,MB3,B]  324-18-342ms   | [S2,MB5,F]  342-15-358ms   | [S2,MB4,B]  394-18-412ms   | [S2,MB6,F]  412-15-428ms   | [S2,MB5,B]  463-18-481ms   | [S2,MB7,F]  481-15-497ms   | [S2,MB6,B]  532-18-550ms   | [S2,MB7,B]  601-18-619ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  76-42-119ms    AFR(10):0.9655 | [S3,MB1,F]  119-24-143ms   | [S3,MB1,B]  143-43-186ms   AFR(10):0.9655 | [S3,MB2,F]  186-24-211ms   | [S3,MB2,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB3,F]  255-24-280ms   | [S3,MB3,B]  280-43-324ms   AFR(10):0.9655 | [S3,MB4,F]  324-25-349ms   | [S3,MB4,B]  349-45-394ms   AFR(10):0.9655 | [S3,MB5,F]  394-25-419ms   | [S3,MB5,B]  419-43-463ms   AFR(10):0.9655 | [S3,MB6,F]  463-24-488ms   | [S3,MB6,B]  488-44-532ms   AFR(10):0.9655 | [S3,MB7,F]  532-24-557ms   | [S3,MB7,B]  557-44-601ms   AFR(10):0.9655
[rank3]:2025-12-24 03:46:52,804 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0346_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 702.03 ms, GPU Bubble Ratio: 42.07%, 27.59%, 43.51%, 13.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  238-42-281ms   | [S0,MB4,F]  281-15-296ms   | [S0,MB1,B]  305-41-347ms   | [S0,MB5,F]  347-15-363ms   | [S0,MB2,B]  374-41-416ms   | [S0,MB6,F]  416-15-432ms   | [S0,MB3,B]  443-41-485ms   | [S0,MB7,F]  485-15-501ms   | [S0,MB4,B]  536-41-578ms   | [S0,MB5,B]  605-41-647ms   | [S0,MB6,B]  674-27-702ms   | [S0,MB7,B]  702-0-702ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-74ms     | [S1,MB0,B]  191-47-238ms   | [S1,MB3,F]  238-19-258ms   | [S1,MB1,B]  259-46-305ms   | [S1,MB4,F]  305-20-325ms   | [S1,MB2,B]  328-46-374ms   | [S1,MB5,F]  374-20-394ms   | [S1,MB3,B]  396-46-443ms   | [S1,MB6,F]  443-20-463ms   | [S1,MB4,B]  490-46-536ms   | [S1,MB7,F]  536-20-557ms   | [S1,MB5,B]  558-46-605ms   | [S1,MB6,B]  627-46-674ms   | [S1,MB7,B]  678-23-702ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-16-53ms     | [S2,MB1,F]  55-14-70ms     | [S2,MB0,B]  155-36-191ms   | [S2,MB2,F]  191-15-207ms   | [S2,MB1,B]  222-36-259ms   | [S2,MB3,F]  259-15-274ms   | [S2,MB2,B]  291-36-328ms   | [S2,MB4,F]  328-15-343ms   | [S2,MB3,B]  360-36-396ms   | [S2,MB5,F]  396-15-412ms   | [S2,MB4,B]  453-36-490ms   | [S2,MB6,F]  490-15-505ms   | [S2,MB5,B]  522-36-558ms   | [S2,MB7,F]  558-15-574ms   | [S2,MB6,B]  591-36-627ms   | [S2,MB7,B]  660-18-678ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  76-78-155ms    AFR(10):0.9655 | [S3,MB1,F]  155-24-179ms   | [S3,MB1,B]  179-43-222ms   AFR(10):0.9655 | [S3,MB2,F]  222-24-247ms   | [S3,MB2,B]  247-44-291ms   AFR(10):0.9655 | [S3,MB3,F]  291-24-316ms   | [S3,MB3,B]  316-43-360ms   AFR(10):0.9655 | [S3,MB4,F]  360-25-385ms   | [S3,MB4,B]  385-68-453ms   AFR(10):0.9655 | [S3,MB5,F]  453-25-478ms   | [S3,MB5,B]  478-43-522ms   AFR(10):0.9655 | [S3,MB6,F]  522-24-547ms   | [S3,MB6,B]  547-44-591ms   AFR(10):0.9655 | [S3,MB7,F]  591-24-616ms   | [S3,MB7,B]  616-44-660ms   AFR(10):0.9655
[rank3]:2025-12-24 03:46:52,804 - 	> Batch Time: 702.03 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank3]:2025-12-24 03:46:52,805 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.97(0.00)/0.00, [MB1] 0.97(1.00)/1.00, [MB2] 0.97(1.00)/1.00, [MB3] 0.97(1.00)/1.00, [MB4] 0.97(0.40)/0.40, [MB5] 0.97(1.00)/1.00, [MB6] 0.97(1.00)/1.00, [MB7] 0.97(1.00)/1.00
[rank2]:2025-12-24 03:46:56,189 - Avg. fwd time: 15.2660 / Avg. bwd time: 32.4364 / Avg. batch time: 985.1472 (ms) / GPU bubble ratio: 61.26%
[rank3]:2025-12-24 03:46:56,164 - Avg. fwd time: 24.6503 / Avg. bwd time: 73.2488 / Avg. batch time: 928.8645 (ms) / GPU bubble ratio: 15.68%
[rank1]:2025-12-24 03:46:56,219 - Avg. fwd time: 19.5764 / Avg. bwd time: 41.6987 / Avg. batch time: 1053.6533 (ms) / GPU bubble ratio: 53.48%
[rank1]:2025-12-24 03:46:56,252 -  step: 100  loss: -4.0000  grad_norm:  6.3774  memory: 12.86GiB(27.07%)  tps: 7,701  tflops: 60.20  mfu: 19.30%
[rank0]:2025-12-24 03:46:56,225 - Avg. fwd time: 15.7966 / Avg. bwd time: 33.1696 / Avg. batch time: 1110.3817 (ms) / GPU bubble ratio: 64.72%
[rank0]:2025-12-24 03:46:56,261 -  step: 100  loss: -4.0000  grad_norm:  6.3774  memory: 16.87GiB(35.50%)  tps: 7,701  tflops: 60.20  mfu: 19.30%
[rank2]:2025-12-24 03:46:56,247 -  step: 100  loss: -4.0000  grad_norm:  6.3774  memory:  8.66GiB(18.23%)  tps: 7,701  tflops: 60.20  mfu: 19.30%
[rank3]:2025-12-24 03:46:56,259 -  step: 100  loss:  8.9617  grad_norm:  6.3774  memory: 25.79GiB(54.28%)  tps: 7,701  tflops: 60.20  mfu: 19.30%
[rank1]:2025-12-24 03:46:56,321 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0346_stage1_step100.svg
[rank1]:2025-12-24 03:46:56,360 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0346_stage1.svg
[rank0]:2025-12-24 03:46:56,320 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0346_stage0_step100.svg
[rank0]:2025-12-24 03:46:56,358 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0346_stage0.svg
[rank2]:2025-12-24 03:46:56,330 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0346_stage2_step100.svg
[rank2]:2025-12-24 03:46:56,370 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0346_stage2.svg
[rank3]:2025-12-24 03:46:56,402 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0346_step100_rank3.svg
[rank3]:			> Batch Time: 811.50 ms, GPU Bubble Ratio: 85.00%, 58.27%, 67.54%, 31.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-15-63ms     | [S0,MB0,B]  200-0-200ms    | [S0,MB4,F]  200-14-214ms   | [S0,MB1,B]  287-0-287ms    | [S0,MB5,F]  287-14-301ms   | [S0,MB2,B]  377-0-377ms    | [S0,MB6,F]  377-14-391ms   | [S0,MB3,B]  466-0-466ms    | [S0,MB7,F]  466-14-480ms   | [S0,MB4,B]  557-0-557ms    | [S0,MB5,B]  641-0-641ms    | [S0,MB6,B]  728-0-728ms    | [S0,MB7,B]  811-0-811ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  166-23-190ms   | [S1,MB3,F]  197-18-215ms   | [S1,MB1,B]  253-23-276ms   | [S1,MB4,F]  283-18-302ms   | [S1,MB2,B]  343-23-366ms   | [S1,MB5,F]  373-19-392ms   | [S1,MB3,B]  432-23-455ms   | [S1,MB6,F]  463-18-481ms   | [S1,MB4,B]  523-23-546ms   | [S1,MB7,F]  553-18-572ms   | [S1,MB5,B]  611-23-634ms   | [S1,MB6,B]  698-23-721ms   | [S1,MB7,B]  782-23-805ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-76ms     | [S2,MB0,B]  140-18-158ms   | [S2,MB2,F]  163-14-177ms   | [S2,MB1,B]  227-18-245ms   | [S2,MB3,F]  249-14-264ms   | [S2,MB2,B]  317-18-335ms   | [S2,MB4,F]  340-14-354ms   | [S2,MB3,B]  406-18-424ms   | [S2,MB5,F]  429-14-443ms   | [S2,MB4,B]  496-18-515ms   | [S2,MB6,F]  519-14-534ms   | [S2,MB5,B]  585-18-603ms   | [S2,MB7,F]  608-14-622ms   | [S2,MB6,B]  673-18-692ms   | [S2,MB7,B]  757-18-776ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-42-130ms    | [S3,MB1,F]  137-24-161ms   | [S3,MB1,B]  173-43-216ms   | [S3,MB2,F]  223-25-249ms   | [S3,MB2,B]  261-45-306ms   | [S3,MB3,F]  314-25-340ms   | [S3,MB3,B]  352-44-396ms   | [S3,MB4,F]  403-25-428ms   | [S3,MB4,B]  441-45-486ms   | [S3,MB5,F]  493-25-519ms   | [S3,MB5,B]  531-43-574ms   | [S3,MB6,F]  582-26-608ms   | [S3,MB6,B]  619-44-663ms   | [S3,MB7,F]  670-25-696ms   | [S3,MB7,B]  708-43-752ms  
[rank3]:2025-12-24 03:46:56,446 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0346_stage3_step100.svg
[rank3]:2025-12-24 03:46:56,485 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0346_stage3.svg
[rank3]:2025-12-24 03:50:18,819 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.59(0.67)/1.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.24(0.27)/0.40, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-24 03:50:19,174 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-24 03:50:19,210 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank0]:2025-12-24 03:50:19,237 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 03:50:19,238 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.22(0.23)/0.34, [MB7] 0.59(0.67)/1.00
[rank3]:2025-12-24 03:50:23,220 - Avg. fwd time: 24.8314 / Avg. bwd time: 69.8988 / Avg. batch time: 903.5266 (ms) / GPU bubble ratio: 16.12%
[rank2]:2025-12-24 03:50:23,249 - Avg. fwd time: 15.4092 / Avg. bwd time: 33.3225 / Avg. batch time: 957.3249 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-12-24 03:50:23,286 - Avg. fwd time: 19.7441 / Avg. bwd time: 43.1609 / Avg. batch time: 1023.2909 (ms) / GPU bubble ratio: 50.82%
[rank0]:2025-12-24 03:50:23,315 - Avg. fwd time: 15.8781 / Avg. bwd time: 34.9291 / Avg. batch time: 1076.3669 (ms) / GPU bubble ratio: 62.24%
[rank2]:2025-12-24 03:50:23,336 -  step: 150  loss: -4.0000  grad_norm: 11.3553  memory:  8.66GiB(18.23%)  tps: 7,912  tflops: 61.85  mfu: 19.82%
[rank1]:2025-12-24 03:50:23,340 -  step: 150  loss: -4.0000  grad_norm: 11.3553  memory: 12.86GiB(27.07%)  tps: 7,912  tflops: 61.85  mfu: 19.82%
[rank3]:2025-12-24 03:50:23,350 -  step: 150  loss:  4.5279  grad_norm: 11.3553  memory: 25.79GiB(54.28%)  tps: 7,912  tflops: 61.85  mfu: 19.82%
[rank0]:2025-12-24 03:50:23,351 -  step: 150  loss: -4.0000  grad_norm: 11.3553  memory: 16.87GiB(35.50%)  tps: 7,912  tflops: 61.85  mfu: 19.82%
[rank3]:2025-12-24 03:53:35,082 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.38(0.40)/0.40, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-24 03:53:35,475 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-24 03:53:35,504 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-24 03:53:35,519 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 03:53:35,520 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.34)/0.34, [MB7] 0.95(1.00)/1.00
[rank2]:2025-12-24 03:53:39,143 - Avg. fwd time: 15.4904 / Avg. bwd time: 33.6645 / Avg. batch time: 932.2427 (ms) / GPU bubble ratio: 57.82%
[rank3]:2025-12-24 03:53:39,117 - Avg. fwd time: 24.9791 / Avg. bwd time: 66.9128 / Avg. batch time: 880.8274 (ms) / GPU bubble ratio: 16.54%
[rank0]:2025-12-24 03:53:39,182 - Avg. fwd time: 15.9285 / Avg. bwd time: 35.7031 / Avg. batch time: 1045.4331 (ms) / GPU bubble ratio: 60.49%
[rank2]:2025-12-24 03:53:39,204 -  step: 200  loss: -4.0000  grad_norm:  6.1352  memory:  8.66GiB(18.23%)  tps: 8,365  tflops: 65.39  mfu: 20.96%
[rank1]:2025-12-24 03:53:39,175 - Avg. fwd time: 19.8425 / Avg. bwd time: 43.7481 / Avg. batch time: 995.3368 (ms) / GPU bubble ratio: 48.89%
[rank1]:2025-12-24 03:53:39,207 -  step: 200  loss: -4.0000  grad_norm:  6.1352  memory: 12.86GiB(27.07%)  tps: 8,365  tflops: 65.39  mfu: 20.96%
[rank3]:2025-12-24 03:53:39,216 -  step: 200  loss:  1.8381  grad_norm:  6.1352  memory: 25.79GiB(54.28%)  tps: 8,365  tflops: 65.39  mfu: 20.96%
[rank0]:2025-12-24 03:53:39,218 -  step: 200  loss: -4.0000  grad_norm:  6.1352  memory: 16.87GiB(35.50%)  tps: 8,365  tflops: 65.39  mfu: 20.96%
[rank0]:2025-12-24 03:53:39,267 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0353_stage0_step200.svg
[rank2]:2025-12-24 03:53:39,272 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0353_stage2_step200.svg
[rank1]:2025-12-24 03:53:39,268 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0353_stage1_step200.svg
[rank3]:2025-12-24 03:53:39,368 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0353_step200_rank3.svg
[rank3]:			> Batch Time: 921.93 ms, GPU Bubble Ratio: 53.17%, 42.71%, 56.21%, 29.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  279-42-321ms   | [S0,MB4,F]  321-15-337ms   | [S0,MB1,B]  368-42-410ms   | [S0,MB5,F]  411-16-427ms   | [S0,MB2,B]  460-42-503ms   | [S0,MB6,F]  503-16-519ms   | [S0,MB3,B]  553-42-595ms   | [S0,MB7,F]  595-16-611ms   | [S0,MB4,B]  670-42-712ms   | [S0,MB5,B]  757-42-799ms   | [S0,MB6,B]  861-36-898ms   | [S0,MB7,B]  910-11-921ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-47-268ms   | [S1,MB3,F]  275-19-295ms   | [S1,MB1,B]  309-48-358ms   | [S1,MB4,F]  365-21-386ms   | [S1,MB2,B]  399-49-449ms   | [S1,MB5,F]  457-21-478ms   | [S1,MB3,B]  491-51-542ms   | [S1,MB6,F]  550-21-571ms   | [S1,MB4,B]  612-47-659ms   | [S1,MB7,F]  666-20-687ms   | [S1,MB5,B]  701-49-750ms   | [S1,MB6,B]  808-47-855ms   | [S1,MB7,B]  878-25-903ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-76ms     | [S2,MB0,B]  177-36-213ms   | [S2,MB2,F]  218-15-234ms   | [S2,MB1,B]  264-37-301ms   | [S2,MB3,F]  306-16-322ms   | [S2,MB2,B]  354-36-391ms   | [S2,MB4,F]  396-16-412ms   | [S2,MB3,B]  447-36-484ms   | [S2,MB5,F]  488-16-504ms   | [S2,MB4,B]  568-36-604ms   | [S2,MB6,F]  609-15-624ms   | [S2,MB5,B]  657-36-693ms   | [S2,MB7,F]  698-16-714ms   | [S2,MB6,B]  765-36-802ms   | [S2,MB7,B]  852-19-871ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-167ms    | [S3,MB1,F]  174-24-198ms   | [S3,MB1,B]  210-44-254ms   | [S3,MB2,F]  261-25-287ms   | [S3,MB2,B]  299-45-344ms   | [S3,MB3,F]  351-26-377ms   | [S3,MB3,B]  390-46-436ms   | [S3,MB4,F]  444-26-470ms   | [S3,MB4,B]  482-75-557ms   | [S3,MB5,F]  565-25-590ms   | [S3,MB5,B]  602-44-646ms   | [S3,MB6,F]  654-25-679ms   | [S3,MB6,B]  691-65-756ms   | [S3,MB7,F]  762-26-788ms   | [S3,MB7,B]  799-45-845ms  
[rank2]:2025-12-24 03:53:39,440 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0353_stage2.svg
[rank1]:2025-12-24 03:53:39,434 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0353_stage1.svg
[rank3]:2025-12-24 03:53:39,414 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0353_stage3_step200.svg
[rank0]:2025-12-24 03:53:39,428 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0353_stage0.svg
[rank3]:2025-12-24 03:53:39,583 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0353_stage3.svg
[rank3]:2025-12-24 03:56:36,136 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.41(0.40)/0.40, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 03:56:36,544 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-24 03:56:36,515 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-24 03:56:36,546 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 03:56:36,547 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.35(0.34)/0.34, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 03:56:40,080 - Avg. fwd time: 19.9572 / Avg. bwd time: 44.2295 / Avg. batch time: 966.9136 (ms) / GPU bubble ratio: 46.89%
[rank2]:2025-12-24 03:56:40,049 - Avg. fwd time: 15.5801 / Avg. bwd time: 33.8501 / Avg. batch time: 906.1153 (ms) / GPU bubble ratio: 56.36%
[rank3]:2025-12-24 03:56:40,023 - Avg. fwd time: 25.0644 / Avg. bwd time: 63.8012 / Avg. batch time: 856.6353 (ms) / GPU bubble ratio: 17.01%
[rank0]:2025-12-24 03:56:40,088 - Avg. fwd time: 15.9766 / Avg. bwd time: 35.7353 / Avg. batch time: 1011.7010 (ms) / GPU bubble ratio: 59.11%
[rank0]:2025-12-24 03:56:40,124 -  step: 250  loss: -4.0000  grad_norm:  2.2285  memory: 16.87GiB(35.50%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank1]:2025-12-24 03:56:40,114 -  step: 250  loss: -4.0000  grad_norm:  2.2285  memory: 12.86GiB(27.07%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank2]:2025-12-24 03:56:40,110 -  step: 250  loss: -4.0000  grad_norm:  2.2285  memory:  8.66GiB(18.23%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank3]:2025-12-24 03:56:40,122 -  step: 250  loss:  0.6092  grad_norm:  2.2285  memory: 25.79GiB(54.28%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank3]:2025-12-24 03:59:34,293 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 0.41(0.40)/0.40, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-24 03:59:34,658 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-24 03:59:34,687 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-24 03:59:34,689 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 03:59:34,690 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.35(0.34)/0.34, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-24 03:59:38,149 - Avg. fwd time: 25.1166 / Avg. bwd time: 61.4818 / Avg. batch time: 838.5098 (ms) / GPU bubble ratio: 17.38%
[rank2]:2025-12-24 03:59:38,176 - Avg. fwd time: 15.6316 / Avg. bwd time: 33.9839 / Avg. batch time: 886.6223 (ms) / GPU bubble ratio: 55.23%
[rank1]:2025-12-24 03:59:38,208 - Avg. fwd time: 20.0419 / Avg. bwd time: 44.5841 / Avg. batch time: 945.8735 (ms) / GPU bubble ratio: 45.34%
[rank0]:2025-12-24 03:59:38,216 - Avg. fwd time: 16.0030 / Avg. bwd time: 35.6657 / Avg. batch time: 987.1101 (ms) / GPU bubble ratio: 58.13%
[rank0]:2025-12-24 03:59:38,252 -  step: 300  loss: -4.0000  grad_norm:  0.7834  memory: 16.87GiB(35.50%)  tps: 9,198  tflops: 71.90  mfu: 23.05%
[rank3]:2025-12-24 03:59:38,250 -  step: 300  loss:  0.3368  grad_norm:  0.7834  memory: 25.79GiB(54.28%)  tps: 9,198  tflops: 71.91  mfu: 23.05%
[rank2]:2025-12-24 03:59:38,238 -  step: 300  loss: -4.0000  grad_norm:  0.7834  memory:  8.66GiB(18.23%)  tps: 9,198  tflops: 71.90  mfu: 23.05%
[rank2]:2025-12-24 03:59:38,301 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0359_stage2_step300.svg
[rank1]:2025-12-24 03:59:38,243 -  step: 300  loss: -4.0000  grad_norm:  0.7834  memory: 12.86GiB(27.07%)  tps: 9,198  tflops: 71.90  mfu: 23.05%
[rank1]:2025-12-24 03:59:38,300 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0359_stage1_step300.svg
[rank0]:2025-12-24 03:59:38,300 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0359_stage0_step300.svg
[rank3]:2025-12-24 03:59:38,406 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0359_step300_rank3.svg
[rank3]:			> Batch Time: 859.00 ms, GPU Bubble Ratio: 51.86%, 37.70%, 52.79%, 30.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  278-42-321ms   | [S0,MB4,F]  321-15-337ms   | [S0,MB1,B]  368-42-410ms   | [S0,MB5,F]  410-16-426ms   | [S0,MB2,B]  458-42-500ms   | [S0,MB6,F]  500-16-516ms   | [S0,MB3,B]  548-42-590ms   | [S0,MB7,F]  590-16-606ms   | [S0,MB4,B]  642-42-684ms   | [S0,MB5,B]  730-42-772ms   | [S0,MB6,B]  813-30-844ms   | [S0,MB7,B]  859-0-859ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  221-47-268ms   | [S1,MB3,F]  275-19-295ms   | [S1,MB1,B]  308-49-357ms   | [S1,MB4,F]  364-21-386ms   | [S1,MB2,B]  396-51-447ms   | [S1,MB5,F]  454-21-475ms   | [S1,MB3,B]  485-52-537ms   | [S1,MB6,F]  545-22-567ms   | [S1,MB4,B]  583-48-631ms   | [S1,MB7,F]  639-21-660ms   | [S1,MB5,B]  672-51-723ms   | [S1,MB6,B]  759-47-807ms   | [S1,MB7,B]  827-24-852ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-76ms     | [S2,MB0,B]  176-36-213ms   | [S2,MB2,F]  218-15-233ms   | [S2,MB1,B]  263-37-300ms   | [S2,MB3,F]  304-16-321ms   | [S2,MB2,B]  351-37-388ms   | [S2,MB4,F]  393-16-410ms   | [S2,MB3,B]  441-37-478ms   | [S2,MB5,F]  482-16-499ms   | [S2,MB4,B]  538-36-575ms   | [S2,MB6,F]  580-16-596ms   | [S2,MB5,B]  628-37-665ms   | [S2,MB7,F]  669-16-686ms   | [S2,MB6,B]  715-37-752ms   | [S2,MB7,B]  802-18-820ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-77-166ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  209-43-252ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  297-43-341ms   | [S3,MB3,F]  349-26-375ms   | [S3,MB3,B]  386-44-431ms   | [S3,MB4,F]  438-25-463ms   | [S3,MB4,B]  475-53-528ms   | [S3,MB5,F]  535-25-561ms   | [S3,MB5,B]  573-44-617ms   | [S3,MB6,F]  625-25-650ms   | [S3,MB6,B]  662-43-706ms   | [S3,MB7,F]  712-26-738ms   | [S3,MB7,B]  750-43-794ms  
[rank3]:2025-12-24 03:59:38,451 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0359_stage3_step300.svg
[rank2]:2025-12-24 03:59:38,596 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0359_stage2.svg
[rank1]:2025-12-24 03:59:38,590 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0359_stage1.svg
[rank0]:2025-12-24 03:59:38,583 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0359_stage0.svg
[rank3]:2025-12-24 03:59:38,748 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0359_stage3.svg
[rank0]:2025-12-24 04:02:35,403 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 04:02:39,002 - Avg. fwd time: 25.1621 / Avg. bwd time: 60.0147 / Avg. batch time: 827.1495 (ms) / GPU bubble ratio: 17.62%
[rank2]:2025-12-24 04:02:39,029 - Avg. fwd time: 15.6651 / Avg. bwd time: 34.0764 / Avg. batch time: 874.3674 (ms) / GPU bubble ratio: 54.49%
[rank1]:2025-12-24 04:02:39,061 - Avg. fwd time: 20.0979 / Avg. bwd time: 44.8192 / Avg. batch time: 932.5149 (ms) / GPU bubble ratio: 44.31%
[rank0]:2025-12-24 04:02:39,069 - Avg. fwd time: 16.0223 / Avg. bwd time: 35.6613 / Avg. batch time: 971.2148 (ms) / GPU bubble ratio: 57.43%
[rank0]:2025-12-24 04:02:39,105 -  step: 350  loss: -4.0000  grad_norm:  0.6594  memory: 16.87GiB(35.50%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank3]:2025-12-24 04:02:39,103 -  step: 350  loss:  0.2495  grad_norm:  0.6594  memory: 25.79GiB(54.28%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank2]:2025-12-24 04:02:39,090 -  step: 350  loss: -4.0000  grad_norm:  0.6594  memory:  8.66GiB(18.23%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank1]:2025-12-24 04:02:39,094 -  step: 350  loss: -4.0000  grad_norm:  0.6594  memory: 12.86GiB(27.07%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank0]:2025-12-24 04:05:36,163 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 04:05:39,756 - Avg. fwd time: 25.1941 / Avg. bwd time: 58.9474 / Avg. batch time: 818.8689 (ms) / GPU bubble ratio: 17.80%
[rank2]:2025-12-24 04:05:39,783 - Avg. fwd time: 15.6830 / Avg. bwd time: 34.1439 / Avg. batch time: 865.3533 (ms) / GPU bubble ratio: 53.94%
[rank0]:2025-12-24 04:05:39,823 - Avg. fwd time: 16.0365 / Avg. bwd time: 35.6227 / Avg. batch time: 959.4748 (ms) / GPU bubble ratio: 56.93%
[rank3]:2025-12-24 04:05:39,858 -  step: 400  loss:  0.2240  grad_norm:  1.1544  memory: 25.79GiB(54.28%)  tps: 9,064  tflops: 70.86  mfu: 22.71%
[rank2]:2025-12-24 04:05:39,845 -  step: 400  loss: -4.0000  grad_norm:  1.1544  memory:  8.66GiB(18.23%)  tps: 9,064  tflops: 70.86  mfu: 22.71%
[rank1]:2025-12-24 04:05:39,815 - Avg. fwd time: 20.1360 / Avg. bwd time: 44.9732 / Avg. batch time: 922.6776 (ms) / GPU bubble ratio: 43.55%
[rank1]:2025-12-24 04:05:39,849 -  step: 400  loss: -4.0000  grad_norm:  1.1544  memory: 12.86GiB(27.07%)  tps: 9,064  tflops: 70.86  mfu: 22.71%
[rank0]:2025-12-24 04:05:39,859 -  step: 400  loss: -4.0000  grad_norm:  1.1544  memory: 16.87GiB(35.50%)  tps: 9,064  tflops: 70.86  mfu: 22.71%
[rank0]:2025-12-24 04:05:39,911 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0405_stage0_step400.svg
[rank2]:2025-12-24 04:05:39,914 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0405_stage2_step400.svg
[rank1]:2025-12-24 04:05:39,911 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0405_stage1_step400.svg
[rank3]:2025-12-24 04:05:40,007 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0405_step400_rank3.svg
[rank3]:			> Batch Time: 861.50 ms, GPU Bubble Ratio: 51.99%, 37.86%, 53.03%, 30.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  280-42-322ms   | [S0,MB4,F]  322-15-338ms   | [S0,MB1,B]  368-42-410ms   | [S0,MB5,F]  410-16-426ms   | [S0,MB2,B]  458-42-501ms   | [S0,MB6,F]  501-16-517ms   | [S0,MB3,B]  549-42-591ms   | [S0,MB7,F]  592-16-608ms   | [S0,MB4,B]  646-42-688ms   | [S0,MB5,B]  734-41-775ms   | [S0,MB6,B]  818-30-848ms   | [S0,MB7,B]  861-0-861ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-62ms     | [S1,MB2,F]  68-18-87ms     | [S1,MB0,B]  222-47-269ms   | [S1,MB3,F]  276-19-296ms   | [S1,MB1,B]  309-49-358ms   | [S1,MB4,F]  365-21-386ms   | [S1,MB2,B]  397-50-448ms   | [S1,MB5,F]  455-21-477ms   | [S1,MB3,B]  487-51-538ms   | [S1,MB6,F]  546-22-568ms   | [S1,MB4,B]  586-48-634ms   | [S1,MB7,F]  643-21-664ms   | [S1,MB5,B]  676-51-727ms   | [S1,MB6,B]  763-47-811ms   | [S1,MB7,B]  830-24-855ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  62-14-76ms     | [S2,MB0,B]  177-36-214ms   | [S2,MB2,F]  219-15-234ms   | [S2,MB1,B]  264-37-301ms   | [S2,MB3,F]  305-16-322ms   | [S2,MB2,B]  352-37-389ms   | [S2,MB4,F]  394-16-411ms   | [S2,MB3,B]  442-37-479ms   | [S2,MB5,F]  484-16-500ms   | [S2,MB4,B]  541-36-578ms   | [S2,MB6,F]  582-16-598ms   | [S2,MB5,B]  631-36-668ms   | [S2,MB7,F]  673-16-689ms   | [S2,MB6,B]  719-37-756ms   | [S2,MB7,B]  805-18-823ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-167ms    | [S3,MB1,F]  174-24-198ms   | [S3,MB1,B]  210-43-254ms   | [S3,MB2,F]  261-25-287ms   | [S3,MB2,B]  298-43-342ms   | [S3,MB3,F]  349-26-376ms   | [S3,MB3,B]  387-44-432ms   | [S3,MB4,F]  439-25-465ms   | [S3,MB4,B]  477-52-529ms   | [S3,MB5,F]  538-25-563ms   | [S3,MB5,B]  576-44-620ms   | [S3,MB6,F]  628-25-654ms   | [S3,MB6,B]  665-43-709ms   | [S3,MB7,F]  716-26-742ms   | [S3,MB7,B]  754-44-798ms  
[rank3]:2025-12-24 04:05:40,055 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0405_stage3_step400.svg
[rank0]:2025-12-24 04:05:40,319 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0405_stage0.svg
[rank2]:2025-12-24 04:05:40,339 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0405_stage2.svg
[rank1]:2025-12-24 04:05:40,327 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0405_stage1.svg
[rank3]:2025-12-24 04:05:40,480 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0405_stage3.svg
[rank3]:2025-12-24 04:06:00,686 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 04:06:01,085 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 04:06:01,112 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 04:06:01,114 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 04:08:35,221 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 04:08:38,758 - Avg. fwd time: 25.2061 / Avg. bwd time: 57.9773 / Avg. batch time: 811.2067 (ms) / GPU bubble ratio: 17.97%
[rank1]:2025-12-24 04:08:38,818 - Avg. fwd time: 20.1676 / Avg. bwd time: 45.1243 / Avg. batch time: 913.8548 (ms) / GPU bubble ratio: 42.84%
[rank2]:2025-12-24 04:08:38,786 - Avg. fwd time: 15.7041 / Avg. bwd time: 34.1963 / Avg. batch time: 857.1691 (ms) / GPU bubble ratio: 53.43%
[rank0]:2025-12-24 04:08:38,827 - Avg. fwd time: 16.0478 / Avg. bwd time: 35.6070 / Avg. batch time: 949.1720 (ms) / GPU bubble ratio: 56.46%
[rank0]:2025-12-24 04:08:38,863 -  step: 450  loss: -4.0000  grad_norm:  0.3554  memory: 16.87GiB(35.50%)  tps: 9,153  tflops: 71.55  mfu: 22.93%
[rank3]:2025-12-24 04:08:38,861 -  step: 450  loss:  0.2313  grad_norm:  0.3554  memory: 25.79GiB(54.28%)  tps: 9,153  tflops: 71.55  mfu: 22.93%
[rank1]:2025-12-24 04:08:38,853 -  step: 450  loss: -4.0000  grad_norm:  0.3554  memory: 12.86GiB(27.07%)  tps: 9,153  tflops: 71.55  mfu: 22.93%
[rank2]:2025-12-24 04:08:38,848 -  step: 450  loss: -4.0000  grad_norm:  0.3554  memory:  8.66GiB(18.23%)  tps: 9,153  tflops: 71.55  mfu: 22.93%
[rank0]:2025-12-24 04:11:34,832 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 04:11:38,360 - Avg. fwd time: 25.2181 / Avg. bwd time: 57.2646 / Avg. batch time: 805.6048 (ms) / GPU bubble ratio: 18.09%
[rank2]:2025-12-24 04:11:38,388 - Avg. fwd time: 15.7158 / Avg. bwd time: 34.2357 / Avg. batch time: 851.0994 (ms) / GPU bubble ratio: 53.05%
[rank1]:2025-12-24 04:11:38,421 - Avg. fwd time: 20.1916 / Avg. bwd time: 45.2277 / Avg. batch time: 907.2700 (ms) / GPU bubble ratio: 42.32%
[rank0]:2025-12-24 04:11:38,430 - Avg. fwd time: 16.0538 / Avg. bwd time: 35.5904 / Avg. batch time: 941.4003 (ms) / GPU bubble ratio: 56.11%
[rank0]:2025-12-24 04:11:38,466 -  step: 500  loss: -4.0000  grad_norm:  0.6398  memory: 16.87GiB(35.50%)  tps: 9,122  tflops: 71.31  mfu: 22.86%
[rank3]:2025-12-24 04:11:38,464 -  step: 500  loss:  0.2253  grad_norm:  0.6398  memory: 25.79GiB(54.28%)  tps: 9,122  tflops: 71.32  mfu: 22.86%
[rank2]:2025-12-24 04:11:38,452 -  step: 500  loss: -4.0000  grad_norm:  0.6398  memory:  8.66GiB(18.23%)  tps: 9,122  tflops: 71.31  mfu: 22.86%
[rank2]:2025-12-24 04:11:38,515 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0411_stage2_step500.svg
[rank1]:2025-12-24 04:11:38,456 -  step: 500  loss: -4.0000  grad_norm:  0.6398  memory: 12.86GiB(27.07%)  tps: 9,122  tflops: 71.31  mfu: 22.86%
[rank1]:2025-12-24 04:11:38,513 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0411_stage1_step500.svg
[rank0]:2025-12-24 04:11:38,513 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0411_stage0_step500.svg
[rank3]:2025-12-24 04:11:38,611 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0411_step500_rank3.svg
[rank3]:			> Batch Time: 860.00 ms, GPU Bubble Ratio: 52.20%, 37.72%, 52.96%, 30.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-64ms     | [S0,MB0,B]  279-42-322ms   | [S0,MB4,F]  322-15-337ms   | [S0,MB1,B]  367-42-409ms   | [S0,MB5,F]  410-16-426ms   | [S0,MB2,B]  458-42-500ms   | [S0,MB6,F]  501-15-516ms   | [S0,MB3,B]  547-42-589ms   | [S0,MB7,F]  590-16-606ms   | [S0,MB4,B]  645-42-687ms   | [S0,MB5,B]  732-41-773ms   | [S0,MB6,B]  816-28-844ms   | [S0,MB7,B]  860-0-860ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-47-268ms   | [S1,MB3,F]  276-19-295ms   | [S1,MB1,B]  308-49-357ms   | [S1,MB4,F]  363-21-385ms   | [S1,MB2,B]  397-50-447ms   | [S1,MB5,F]  455-21-476ms   | [S1,MB3,B]  485-51-537ms   | [S1,MB6,F]  544-22-566ms   | [S1,MB4,B]  585-49-634ms   | [S1,MB7,F]  641-21-662ms   | [S1,MB5,B]  674-51-725ms   | [S1,MB6,B]  761-48-809ms   | [S1,MB7,B]  828-24-853ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  177-36-214ms   | [S2,MB2,F]  218-15-233ms   | [S2,MB1,B]  263-37-300ms   | [S2,MB3,F]  305-16-321ms   | [S2,MB2,B]  352-37-389ms   | [S2,MB4,F]  393-16-410ms   | [S2,MB3,B]  440-37-477ms   | [S2,MB5,F]  482-16-498ms   | [S2,MB4,B]  539-36-576ms   | [S2,MB6,F]  581-16-597ms   | [S2,MB5,B]  629-37-666ms   | [S2,MB7,F]  670-16-686ms   | [S2,MB6,B]  718-36-755ms   | [S2,MB7,B]  803-18-822ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  174-24-198ms   | [S3,MB1,B]  209-43-253ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  297-43-341ms   | [S3,MB3,F]  349-26-375ms   | [S3,MB3,B]  386-43-430ms   | [S3,MB4,F]  437-25-463ms   | [S3,MB4,B]  475-53-528ms   | [S3,MB5,F]  536-25-561ms   | [S3,MB5,B]  574-44-618ms   | [S3,MB6,F]  625-25-650ms   | [S3,MB6,B]  663-43-707ms   | [S3,MB7,F]  714-26-740ms   | [S3,MB7,B]  752-43-796ms  
[rank3]:2025-12-24 04:11:38,655 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0411_stage3_step500.svg
[rank0]:2025-12-24 04:11:39,048 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0411_stage0.svg
[rank2]:2025-12-24 04:11:39,065 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0411_stage2.svg
[rank1]:2025-12-24 04:11:39,056 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0411_stage1.svg
[rank3]:2025-12-24 04:11:39,215 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0411_stage3.svg
[rank0]:2025-12-24 04:14:34,933 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 04:14:38,517 - Avg. fwd time: 25.2251 / Avg. bwd time: 56.6763 / Avg. batch time: 800.9549 (ms) / GPU bubble ratio: 18.20%
[rank2]:2025-12-24 04:14:38,546 - Avg. fwd time: 15.7274 / Avg. bwd time: 34.2676 / Avg. batch time: 846.1141 (ms) / GPU bubble ratio: 52.73%
[rank1]:2025-12-24 04:14:38,579 - Avg. fwd time: 20.2169 / Avg. bwd time: 45.3245 / Avg. batch time: 901.8658 (ms) / GPU bubble ratio: 41.86%
[rank0]:2025-12-24 04:14:38,588 - Avg. fwd time: 16.0620 / Avg. bwd time: 35.5953 / Avg. batch time: 935.0276 (ms) / GPU bubble ratio: 55.80%
[rank0]:2025-12-24 04:14:38,624 -  step: 550  loss: -4.0000  grad_norm:  0.1724  memory: 16.87GiB(35.50%)  tps: 9,094  tflops: 71.09  mfu: 22.79%
[rank3]:2025-12-24 04:14:38,622 -  step: 550  loss:  0.2279  grad_norm:  0.1724  memory: 25.79GiB(54.28%)  tps: 9,094  tflops: 71.10  mfu: 22.79%
[rank2]:2025-12-24 04:14:38,610 -  step: 550  loss: -4.0000  grad_norm:  0.1724  memory:  8.66GiB(18.23%)  tps: 9,094  tflops: 71.09  mfu: 22.79%
[rank1]:2025-12-24 04:14:38,613 -  step: 550  loss: -4.0000  grad_norm:  0.1724  memory: 12.86GiB(27.07%)  tps: 9,094  tflops: 71.09  mfu: 22.79%
[rank0]:2025-12-24 04:17:35,744 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 04:17:39,373 - Avg. fwd time: 25.2343 / Avg. bwd time: 56.2532 / Avg. batch time: 797.6430 (ms) / GPU bubble ratio: 18.27%
[rank2]:2025-12-24 04:17:39,401 - Avg. fwd time: 15.7344 / Avg. bwd time: 34.2915 / Avg. batch time: 842.4799 (ms) / GPU bubble ratio: 52.50%
[rank0]:2025-12-24 04:17:39,443 - Avg. fwd time: 16.0697 / Avg. bwd time: 35.5931 / Avg. batch time: 930.2389 (ms) / GPU bubble ratio: 55.57%
[rank3]:2025-12-24 04:17:39,477 -  step: 600  loss:  0.2250  grad_norm:  1.0986  memory: 25.79GiB(54.28%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank2]:2025-12-24 04:17:39,465 -  step: 600  loss: -4.0000  grad_norm:  1.0986  memory:  8.66GiB(18.23%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank1]:2025-12-24 04:17:39,434 - Avg. fwd time: 20.2336 / Avg. bwd time: 45.3894 / Avg. batch time: 897.8816 (ms) / GPU bubble ratio: 41.53%
[rank1]:2025-12-24 04:17:39,469 -  step: 600  loss: -4.0000  grad_norm:  1.0986  memory: 12.86GiB(27.07%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank0]:2025-12-24 04:17:39,480 -  step: 600  loss: -4.0000  grad_norm:  1.0986  memory: 16.87GiB(35.50%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank0]:2025-12-24 04:17:39,529 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0417_stage0_step600.svg
[rank2]:2025-12-24 04:17:39,532 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0417_stage2_step600.svg
[rank1]:2025-12-24 04:17:39,529 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0417_stage1_step600.svg
[rank3]:2025-12-24 04:17:39,633 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0417_step600_rank3.svg
[rank3]:			> Batch Time: 880.00 ms, GPU Bubble Ratio: 52.42%, 39.29%, 54.17%, 29.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  280-42-322ms   | [S0,MB4,F]  322-15-337ms   | [S0,MB1,B]  368-42-410ms   | [S0,MB5,F]  411-16-427ms   | [S0,MB2,B]  459-42-501ms   | [S0,MB6,F]  502-16-518ms   | [S0,MB3,B]  550-42-592ms   | [S0,MB7,F]  592-16-608ms   | [S0,MB4,B]  662-42-704ms   | [S0,MB5,B]  750-41-792ms   | [S0,MB6,B]  835-36-871ms   | [S0,MB7,B]  880-0-880ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-62ms     | [S1,MB2,F]  68-18-87ms     | [S1,MB0,B]  222-47-269ms   | [S1,MB3,F]  276-19-296ms   | [S1,MB1,B]  309-49-359ms   | [S1,MB4,F]  365-21-387ms   | [S1,MB2,B]  397-50-448ms   | [S1,MB5,F]  456-21-477ms   | [S1,MB3,B]  487-52-539ms   | [S1,MB6,F]  547-22-569ms   | [S1,MB4,B]  604-47-651ms   | [S1,MB7,F]  659-20-679ms   | [S1,MB5,B]  693-50-743ms   | [S1,MB6,B]  781-48-829ms   | [S1,MB7,B]  848-24-872ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  62-14-76ms     | [S2,MB0,B]  177-36-214ms   | [S2,MB2,F]  219-15-234ms   | [S2,MB1,B]  264-37-301ms   | [S2,MB3,F]  306-16-322ms   | [S2,MB2,B]  353-36-390ms   | [S2,MB4,F]  394-16-411ms   | [S2,MB3,B]  442-36-479ms   | [S2,MB5,F]  484-16-500ms   | [S2,MB4,B]  559-36-596ms   | [S2,MB6,F]  601-15-617ms   | [S2,MB5,B]  648-36-685ms   | [S2,MB7,F]  690-16-706ms   | [S2,MB6,B]  737-36-774ms   | [S2,MB7,B]  823-18-841ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-167ms    | [S3,MB1,F]  174-24-198ms   | [S3,MB1,B]  210-44-254ms   | [S3,MB2,F]  261-25-287ms   | [S3,MB2,B]  298-44-342ms   | [S3,MB3,F]  349-26-376ms   | [S3,MB3,B]  388-43-432ms   | [S3,MB4,F]  439-25-465ms   | [S3,MB4,B]  476-73-550ms   | [S3,MB5,F]  556-25-582ms   | [S3,MB5,B]  594-44-638ms   | [S3,MB6,F]  645-25-671ms   | [S3,MB6,B]  683-44-727ms   | [S3,MB7,F]  734-26-760ms   | [S3,MB7,B]  772-44-816ms  
[rank3]:2025-12-24 04:17:39,679 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0417_stage3_step600.svg
[rank2]:2025-12-24 04:17:40,213 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0417_stage2.svg
[rank1]:2025-12-24 04:17:40,207 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0417_stage1.svg
[rank0]:2025-12-24 04:17:40,188 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0417_stage0.svg
[rank3]:2025-12-24 04:17:40,363 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0417_stage3.svg
[rank0]:2025-12-24 04:20:35,558 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 04:20:39,027 - Avg. fwd time: 25.2480 / Avg. bwd time: 55.7919 / Avg. batch time: 794.0631 (ms) / GPU bubble ratio: 18.35%
[rank1]:2025-12-24 04:20:39,090 - Avg. fwd time: 20.2504 / Avg. bwd time: 45.4623 / Avg. batch time: 893.7849 (ms) / GPU bubble ratio: 41.18%
[rank2]:2025-12-24 04:20:39,056 - Avg. fwd time: 15.7418 / Avg. bwd time: 34.3147 / Avg. batch time: 838.6749 (ms) / GPU bubble ratio: 52.25%
[rank2]:2025-12-24 04:20:39,121 -  step: 650  loss: -4.0000  grad_norm:  0.3232  memory:  8.66GiB(18.23%)  tps: 9,120  tflops: 71.29  mfu: 22.85%
[rank0]:2025-12-24 04:20:39,099 - Avg. fwd time: 16.0771 / Avg. bwd time: 35.6091 / Avg. batch time: 925.4581 (ms) / GPU bubble ratio: 55.32%
[rank0]:2025-12-24 04:20:39,136 -  step: 650  loss: -4.0000  grad_norm:  0.3232  memory: 16.87GiB(35.50%)  tps: 9,120  tflops: 71.29  mfu: 22.85%
[rank3]:2025-12-24 04:20:39,134 -  step: 650  loss:  0.2333  grad_norm:  0.3232  memory: 25.79GiB(54.28%)  tps: 9,120  tflops: 71.29  mfu: 22.85%
[rank1]:2025-12-24 04:20:39,125 -  step: 650  loss: -4.0000  grad_norm:  0.3232  memory: 12.86GiB(27.07%)  tps: 9,120  tflops: 71.29  mfu: 22.85%
[rank0]:2025-12-24 04:23:33,762 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 04:23:37,267 - Avg. fwd time: 15.7503 / Avg. bwd time: 34.3359 / Avg. batch time: 835.1727 (ms) / GPU bubble ratio: 52.02%
[rank3]:2025-12-24 04:23:37,237 - Avg. fwd time: 25.2591 / Avg. bwd time: 55.3720 / Avg. batch time: 790.7954 (ms) / GPU bubble ratio: 18.43%
[rank0]:2025-12-24 04:23:37,311 - Avg. fwd time: 16.0844 / Avg. bwd time: 35.6180 / Avg. batch time: 921.1182 (ms) / GPU bubble ratio: 55.10%
[rank1]:2025-12-24 04:23:37,301 - Avg. fwd time: 20.2748 / Avg. bwd time: 45.5469 / Avg. batch time: 890.0294 (ms) / GPU bubble ratio: 40.84%
[rank1]:2025-12-24 04:23:37,337 -  step: 700  loss: -4.0000  grad_norm:  0.5281  memory: 12.86GiB(27.07%)  tps: 9,194  tflops: 71.87  mfu: 23.04%
[rank2]:2025-12-24 04:23:37,332 -  step: 700  loss: -4.0000  grad_norm:  0.5281  memory:  8.66GiB(18.23%)  tps: 9,194  tflops: 71.87  mfu: 23.04%
[rank3]:2025-12-24 04:23:37,345 -  step: 700  loss:  0.1903  grad_norm:  0.5281  memory: 25.79GiB(54.28%)  tps: 9,194  tflops: 71.87  mfu: 23.04%
[rank0]:2025-12-24 04:23:37,347 -  step: 700  loss: -4.0000  grad_norm:  0.5281  memory: 16.87GiB(35.50%)  tps: 9,194  tflops: 71.87  mfu: 23.04%
[rank0]:2025-12-24 04:23:37,397 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0423_stage0_step700.svg
[rank1]:2025-12-24 04:23:37,398 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0423_stage1_step700.svg
[rank2]:2025-12-24 04:23:37,399 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0423_stage2_step700.svg
[rank3]:2025-12-24 04:23:37,493 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0423_step700_rank3.svg
[rank3]:			> Batch Time: 858.50 ms, GPU Bubble Ratio: 51.01%, 37.09%, 52.84%, 30.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  279-42-322ms   | [S0,MB4,F]  322-15-338ms   | [S0,MB1,B]  369-42-411ms   | [S0,MB5,F]  411-16-427ms   | [S0,MB2,B]  459-42-501ms   | [S0,MB6,F]  502-16-518ms   | [S0,MB3,B]  550-42-592ms   | [S0,MB7,F]  592-16-608ms   | [S0,MB4,B]  644-42-686ms   | [S0,MB5,B]  731-42-773ms   | [S0,MB6,B]  815-36-851ms   | [S0,MB7,B]  858-0-858ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-62ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  222-47-269ms   | [S1,MB3,F]  276-20-297ms   | [S1,MB1,B]  308-49-358ms   | [S1,MB4,F]  365-21-387ms   | [S1,MB2,B]  397-51-449ms   | [S1,MB5,F]  456-21-477ms   | [S1,MB3,B]  486-52-539ms   | [S1,MB6,F]  546-22-568ms   | [S1,MB4,B]  584-49-633ms   | [S1,MB7,F]  641-21-662ms   | [S1,MB5,B]  672-51-724ms   | [S1,MB6,B]  760-48-808ms   | [S1,MB7,B]  827-24-851ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-76ms     | [S2,MB0,B]  177-36-214ms   | [S2,MB2,F]  219-15-234ms   | [S2,MB1,B]  264-37-301ms   | [S2,MB3,F]  305-16-321ms   | [S2,MB2,B]  352-37-389ms   | [S2,MB4,F]  394-16-411ms   | [S2,MB3,B]  441-37-478ms   | [S2,MB5,F]  483-16-499ms   | [S2,MB4,B]  539-36-576ms   | [S2,MB6,F]  581-16-597ms   | [S2,MB5,B]  627-37-664ms   | [S2,MB7,F]  669-16-686ms   | [S2,MB6,B]  717-36-754ms   | [S2,MB7,B]  802-18-820ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-167ms    | [S3,MB1,F]  174-24-198ms   | [S3,MB1,B]  210-43-253ms   | [S3,MB2,F]  260-25-286ms   | [S3,MB2,B]  298-43-342ms   | [S3,MB3,F]  349-26-375ms   | [S3,MB3,B]  387-43-431ms   | [S3,MB4,F]  438-26-464ms   | [S3,MB4,B]  475-53-528ms   | [S3,MB5,F]  536-25-561ms   | [S3,MB5,B]  573-44-617ms   | [S3,MB6,F]  624-26-650ms   | [S3,MB6,B]  662-43-706ms   | [S3,MB7,F]  714-26-740ms   | [S3,MB7,B]  752-43-795ms  
[rank3]:2025-12-24 04:23:37,540 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0423_stage3_step700.svg
[rank0]:2025-12-24 04:23:38,181 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0423_stage0.svg
[rank1]:2025-12-24 04:23:38,194 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0423_stage1.svg
[rank2]:2025-12-24 04:23:38,207 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0423_stage2.svg
[rank3]:2025-12-24 04:23:38,347 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0423_stage3.svg
[rank0]:2025-12-24 04:26:33,863 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 04:26:37,460 - Avg. fwd time: 25.2683 / Avg. bwd time: 55.0510 / Avg. batch time: 788.3029 (ms) / GPU bubble ratio: 18.49%
[rank2]:2025-12-24 04:26:37,489 - Avg. fwd time: 15.7598 / Avg. bwd time: 34.3538 / Avg. batch time: 832.5123 (ms) / GPU bubble ratio: 51.84%
[rank0]:2025-12-24 04:26:37,534 - Avg. fwd time: 16.0905 / Avg. bwd time: 35.6065 / Avg. batch time: 917.7315 (ms) / GPU bubble ratio: 54.93%
[rank3]:2025-12-24 04:26:37,568 -  step: 750  loss:  0.2345  grad_norm:  0.2616  memory: 25.79GiB(54.28%)  tps: 9,091  tflops: 71.07  mfu: 22.78%
[rank1]:2025-12-24 04:26:37,523 - Avg. fwd time: 20.2958 / Avg. bwd time: 45.6158 / Avg. batch time: 887.1490 (ms) / GPU bubble ratio: 40.56%
[rank1]:2025-12-24 04:26:37,560 -  step: 750  loss: -4.0000  grad_norm:  0.2616  memory: 12.86GiB(27.07%)  tps: 9,091  tflops: 71.07  mfu: 22.78%
[rank2]:2025-12-24 04:26:37,555 -  step: 750  loss: -4.0000  grad_norm:  0.2616  memory:  8.66GiB(18.23%)  tps: 9,091  tflops: 71.07  mfu: 22.78%
[rank0]:2025-12-24 04:26:37,570 -  step: 750  loss: -4.0000  grad_norm:  0.2616  memory: 16.87GiB(35.50%)  tps: 9,091  tflops: 71.07  mfu: 22.78%
[rank0]:2025-12-24 04:29:34,639 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 04:29:38,194 - Avg. fwd time: 25.2754 / Avg. bwd time: 54.8286 / Avg. batch time: 786.5800 (ms) / GPU bubble ratio: 18.53%
[rank2]:2025-12-24 04:29:38,224 - Avg. fwd time: 15.7674 / Avg. bwd time: 34.3671 / Avg. batch time: 830.6099 (ms) / GPU bubble ratio: 51.71%
[rank0]:2025-12-24 04:29:38,270 - Avg. fwd time: 16.0957 / Avg. bwd time: 35.5996 / Avg. batch time: 915.1908 (ms) / GPU bubble ratio: 54.81%
[rank3]:2025-12-24 04:29:38,304 -  step: 800  loss:  0.2381  grad_norm:  1.0804  memory: 25.79GiB(54.28%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank3]:2025-12-24 04:29:38,305 - â„¹ï¸ final step: 800  loss:  0.2381  grad_norm:  1.0804  tps: 9,224  tflops: 72.11  mfu: 21.24%
[rank3]:2025-12-24 04:29:38,305 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 04:29:38,306 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 04:29:38,259 - Avg. fwd time: 20.3104 / Avg. bwd time: 45.6623 / Avg. batch time: 885.0535 (ms) / GPU bubble ratio: 40.37%
[rank1]:2025-12-24 04:29:38,295 -  step: 800  loss: -4.0000  grad_norm:  1.0804  memory: 12.86GiB(27.07%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank1]:2025-12-24 04:29:38,295 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0804  tps: 9,219  tflops: 72.07  mfu: 21.13%
[rank1]:2025-12-24 04:29:38,295 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 04:29:38,296 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-24 04:29:38,292 -  step: 800  loss: -4.0000  grad_norm:  1.0804  memory:  8.66GiB(18.23%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank2]:2025-12-24 04:29:38,292 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0804  tps: 9,215  tflops: 72.04  mfu: 21.08%
[rank2]:2025-12-24 04:29:38,292 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 04:29:38,293 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 04:29:38,306 -  step: 800  loss: -4.0000  grad_norm:  1.0804  memory: 16.87GiB(35.50%)  tps: 9,065  tflops: 70.87  mfu: 22.71%
[rank0]:2025-12-24 04:29:38,306 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0804  tps: 9,216  tflops: 72.04  mfu: 21.08%
[rank0]:2025-12-24 04:29:38,306 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 04:29:38,307 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 04:29:40,488 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-24 04:29:40,552 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank2/251224_0429_stage2_final800.svg
[rank0]:2025-12-24 04:29:40,549 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank0/251224_0429_stage0_final800.svg
[rank1]:2025-12-24 04:29:40,550 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank1/251224_0429_stage1_final800.svg
[rank3]:2025-12-24 04:29:40,656 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0429_final800_rank3.svg
[rank3]:			> Batch Time: 876.50 ms, GPU Bubble Ratio: 52.60%, 39.38%, 53.99%, 29.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  279-42-321ms   | [S0,MB4,F]  321-15-337ms   | [S0,MB1,B]  369-42-411ms   | [S0,MB5,F]  411-16-427ms   | [S0,MB2,B]  459-42-502ms   | [S0,MB6,F]  502-16-518ms   | [S0,MB3,B]  551-42-593ms   | [S0,MB7,F]  593-16-609ms   | [S0,MB4,B]  661-42-703ms   | [S0,MB5,B]  748-41-789ms   | [S0,MB6,B]  833-33-866ms   | [S0,MB7,B]  876-0-876ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  221-47-268ms   | [S1,MB3,F]  276-19-295ms   | [S1,MB1,B]  309-48-358ms   | [S1,MB4,F]  365-21-387ms   | [S1,MB2,B]  398-50-449ms   | [S1,MB5,F]  456-21-477ms   | [S1,MB3,B]  488-51-539ms   | [S1,MB6,F]  547-21-569ms   | [S1,MB4,B]  603-47-650ms   | [S1,MB7,F]  657-20-678ms   | [S1,MB5,B]  691-50-741ms   | [S1,MB6,B]  778-47-825ms   | [S1,MB7,B]  845-24-869ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-76ms     | [S2,MB0,B]  177-36-214ms   | [S2,MB2,F]  218-15-234ms   | [S2,MB1,B]  264-36-301ms   | [S2,MB3,F]  306-16-322ms   | [S2,MB2,B]  353-36-390ms   | [S2,MB4,F]  395-16-411ms   | [S2,MB3,B]  443-36-480ms   | [S2,MB5,F]  484-16-501ms   | [S2,MB4,B]  558-36-595ms   | [S2,MB6,F]  599-15-615ms   | [S2,MB5,B]  646-36-683ms   | [S2,MB7,F]  688-16-704ms   | [S2,MB6,B]  735-36-772ms   | [S2,MB7,B]  820-18-839ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-167ms    | [S3,MB1,F]  174-24-198ms   | [S3,MB1,B]  209-44-253ms   | [S3,MB2,F]  261-25-287ms   | [S3,MB2,B]  299-44-343ms   | [S3,MB3,F]  350-26-376ms   | [S3,MB3,B]  388-44-433ms   | [S3,MB4,F]  439-25-465ms   | [S3,MB4,B]  477-73-550ms   | [S3,MB5,F]  555-25-580ms   | [S3,MB5,B]  592-44-636ms   | [S3,MB6,F]  643-25-669ms   | [S3,MB6,B]  681-44-725ms   | [S3,MB7,F]  732-26-758ms   | [S3,MB7,B]  769-44-813ms  
[rank1]:2025-12-24 04:29:40,701 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_params_histogram/251224_0429_rank1_stage1.svg
[rank1]:	> Counts Sum: 149400, Total Sum: 1036800 (14.41%), Ratio(%) per element: [14.4, 14.23, 14.23, 14.75, 14.06, 14.4, 14.75, 14.58, 14.23, 14.58, 14.4, 14.23, 14.4, 14.4, 14.4, 14.23, 14.4, 14.4, 14.58, 14.58, 14.4, 14.23, 14.4, 14.23, 14.58, 14.75, 14.06, 14.58, 14.4, 14.75, 14.4, 14.4, 14.58, 14.23, 14.4, 14.23, 14.58, 14.4, 14.4, 14.4, 14.06, 14.4, 14.23, 14.58, 14.23]
[rank2]:2025-12-24 04:29:40,707 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_params_histogram/251224_0429_rank2_stage2.svg
[rank2]:	> Counts Sum: 119520, Total Sum: 829440 (14.41%), Ratio(%) per element: [14.23, 14.4, 14.58, 14.75, 14.4, 14.4, 14.58, 14.58, 14.06, 14.58, 14.23, 14.4, 14.06, 14.23, 14.75, 14.23, 14.23, 14.4, 14.75, 14.4, 14.93, 14.06, 14.4, 14.4, 14.4, 14.58, 14.23, 14.58, 14.23, 14.58, 14.23, 14.23, 14.23, 14.4, 14.4, 14.4]
[rank0]:2025-12-24 04:29:40,706 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_params_histogram/251224_0429_rank0_stage0.svg
[rank0]:	> Counts Sum: 157640, Total Sum: 852480 (18.49%), Ratio(%) per element: [21.35, 22.39, 21.87, 20.83, 21.7, 20.31, 21.18, 19.96, 20.13, 21.52, 20.48, 19.96, 19.09, 19.79, 19.79, 19.27, 18.4, 19.27, 19.27, 18.22, 18.05, 17.01, 17.53, 16.66, 17.53, 18.22, 17.01, 17.01, 16.14, 16.31, 15.45, 16.14, 15.62, 15.79, 15.1, 15.27, 14.4]
[rank3]:2025-12-24 04:29:40,806 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/pipeline_schedule/251224_0429_thry_final800_rank3.svg
[rank3]:			> Batch Time: 640.29 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-58ms     | [S0,MB3,F]  58-19-77ms     | [S0,MB0,B]  194-38-232ms   | [S0,MB4,F]  232-19-252ms   | [S0,MB1,B]  252-38-291ms   | [S0,MB5,F]  291-19-310ms   | [S0,MB2,B]  310-38-349ms   | [S0,MB6,F]  349-19-368ms   | [S0,MB3,B]  368-38-407ms   | [S0,MB7,F]  407-19-426ms   | [S0,MB4,B]  426-38-465ms   | [S0,MB5,B]  485-38-523ms   | [S0,MB6,B]  543-38-582ms   | [S0,MB7,B]  601-38-640ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-77ms     | [S1,MB0,B]  155-38-194ms   | [S1,MB3,F]  194-19-213ms   | [S1,MB1,B]  213-38-252ms   | [S1,MB4,F]  252-19-271ms   | [S1,MB2,B]  271-38-310ms   | [S1,MB5,F]  310-19-329ms   | [S1,MB3,B]  329-38-368ms   | [S1,MB6,F]  368-19-388ms   | [S1,MB4,B]  388-38-426ms   | [S1,MB7,F]  426-19-446ms   | [S1,MB5,B]  446-38-485ms   | [S1,MB6,B]  504-38-543ms   | [S1,MB7,B]  562-38-601ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-58ms     | [S2,MB1,F]  58-19-77ms     | [S2,MB0,B]  116-38-155ms   | [S2,MB2,F]  155-19-174ms   | [S2,MB1,B]  174-38-213ms   | [S2,MB3,F]  213-19-232ms   | [S2,MB2,B]  232-38-271ms   | [S2,MB4,F]  271-19-291ms   | [S2,MB3,B]  291-38-329ms   | [S2,MB5,F]  329-19-349ms   | [S2,MB4,B]  349-38-388ms   | [S2,MB6,F]  388-19-407ms   | [S2,MB5,B]  407-38-446ms   | [S2,MB7,F]  446-19-465ms   | [S2,MB6,B]  465-38-504ms   | [S2,MB7,B]  523-38-562ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  58-19-77ms     | [S3,MB0,B]  77-38-116ms    | [S3,MB1,F]  116-19-135ms   | [S3,MB1,B]  135-38-174ms   | [S3,MB2,F]  174-19-194ms   | [S3,MB2,B]  194-38-232ms   | [S3,MB3,F]  232-19-252ms   | [S3,MB3,B]  252-38-291ms   | [S3,MB4,F]  291-19-310ms   | [S3,MB4,B]  310-38-349ms   | [S3,MB5,F]  349-19-368ms   | [S3,MB5,B]  368-38-407ms   | [S3,MB6,F]  407-19-426ms   | [S3,MB6,B]  426-38-465ms   | [S3,MB7,F]  465-19-485ms   | [S3,MB7,B]  485-38-523ms  
[rank3]:2025-12-24 04:29:40,858 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_ratio_history/rank3/251224_0429_stage3_final800.svg
[rank3]:2025-12-24 04:29:41,004 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/frozen_params_histogram/251224_0429_rank3_stage3.svg
[rank3]:	> Counts Sum: 516080, Total Sum: 668160 (77.24%), Ratio(%) per element: [77.25, 77.25, 75.86, 77.95, 77.25, 78.47, 77.43, 76.21, 76.9, 77.25, 77.43, 75.86, 78.29, 76.04, 77.6, 76.73, 79.51, 77.77, 77.43, 76.9, 78.12, 76.73, 76.9, 78.12, 78.12, 76.38, 77.08, 75.34, 77.6]
[rank1]:2025-12-24 04:29:41,627 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0429_stage1.svg
[rank1]:2025-12-24 04:29:41,629 - Destroying the purge thread.
[rank2]:2025-12-24 04:29:41,638 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0429_stage2.svg
[rank2]:2025-12-24 04:29:41,640 - Destroying the purge thread.
[rank0]:2025-12-24 04:29:41,616 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0429_stage0.svg
[rank0]:2025-12-24 04:29:41,618 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-24 04:29:42,011 - Process group destroyed
[rank3]:2025-12-24 04:29:42,067 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1/afr_time_plot/251224_0429_stage3.svg
[rank3]:2025-12-24 04:29:42,070 - Destroying the purge thread.
[rank1]:2025-12-24 04:29:42,051 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 300-321
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.55233
[rank3]:wandb:               final/avg_loss 0.23806
[rank3]:wandb:             final/avg_mfu(%) 21.23916
[rank3]:wandb:             final/avg_tflops 72.11194
[rank3]:wandb:    final/avg_throughput(tps) 9224.37781
[rank3]:wandb:              final/grad_norm 1.08038
[rank3]:wandb:               final/max_loss 0.23806
[rank3]:wandb:                    grad_norm 1.08038
[rank3]:wandb: loss_metrics/global_avg_loss 0.23806
[rank3]:wandb: loss_metrics/global_max_loss 0.23806
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_1F1B_fullrand7_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/dozzgr3s
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_1F1B_fullrand7_42_dm1/20251224-0339/wandb/run-20251224_033917-dozzgr3s/logs
[rank3]:2025-12-24 04:29:43,557 - Process group destroyed
[rank0]:2025-12-24 04:29:43,618 - Training completed
[rank0]:2025-12-24 04:29:43,618 - Destroying the purge thread.
[rank0]:2025-12-24 04:29:44,079 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.0', 'layers.1', 'tok_embeddings', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.5', 'layers.4', 'layers.8', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'layers.14', 'output', 'layers.13'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_1F1B_fullrand7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_1F1B_fullrand7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_1F1B_fullrand7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_1F1B_fullrand7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_1F1B_fullrand7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_1F1B_fullrand7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_1F1B_fullrand7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_1F1B_fullrand7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
