
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 25. (ëª©) 06:55:19 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_Interleaved1F1B_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with auto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-25 06:55:25,902 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-25 06:55:25,908 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank2]:2025-12-25 06:55:25,962 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank3]:2025-12-25 06:55:26,149 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-25 06:55:26,151 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-25 06:55:26,162 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank0]:2025-12-25 06:55:26,147 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-25 06:55:26,150 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 06:55:26,153 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-25 06:55:26,154 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-25 06:55:26,219 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-25 06:55:26,221 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-25 06:55:26,337 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-25 06:55:26,340 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 06:55:26,552 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-25 06:55:29,664 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 06:55:29,667 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 06:55:29,709 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 06:55:29,737 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-25 06:55:29,749 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-25 06:55:29,708 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 06:55:29,736 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank2]:2025-12-25 06:55:29,751 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-25 06:55:29,749 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-25 06:55:29,751 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-25 06:55:29,817 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-25 06:55:29,951 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 06:55:29,954 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 06:55:29,955 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-25 06:55:29,951 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-25 06:55:29,952 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-25 06:55:29,956 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-25 06:55:29,981 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-25 06:55:30,021 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 06:55:30,023 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-25 06:55:30,050 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-25 06:55:30,063 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-25 06:55:30,064 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-25 06:55:30,254 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 06:55:30,255 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-25 06:55:30,255 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run q9fnrdk8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_auto_42_dm1/20251225-0655/wandb/run-20251225_065530-q9fnrdk8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_Interleaved1F1B_auto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/q9fnrdk8
[rank3]:2025-12-25 06:55:31,963 - WandB logging enabled
[rank3]:2025-12-25 06:55:31,963 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-25 06:55:32,002 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 06:55:32,031 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-25 06:55:32,044 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-25 06:55:32,045 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-12-25 06:55:32,234 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 06:55:32,235 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-25 06:55:32,235 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-25 06:55:32,250 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-25 06:55:32,251 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 06:55:32,250 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_auto_42_dm1
[rank2]:2025-12-25 06:55:32,251 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 06:55:32,250 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 06:55:32,251 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-25 06:55:32,251 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-25 06:55:34,663 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-25 06:55:34,663 - Finished loading the checkpoint in 2.41 seconds.
[rank0]:2025-12-25 06:55:34,663 - Training starts at step 1
[rank3]:2025-12-25 06:55:40,305 -  step:  1  loss: 10.6092  grad_norm: 203.0667  memory: 25.52GiB(53.71%)  tps: 3,948  tflops: 30.86  mfu: 9.89%
[rank3]:2025-12-25 06:55:40,305 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-25 06:55:40,303 -  step:  1  loss: -4.0000  grad_norm: 203.0667  memory: 16.23GiB(34.16%)  tps: 3,093  tflops: 24.18  mfu: 7.75%
[rank1]:2025-12-25 06:55:40,304 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-25 06:55:40,293 -  step:  1  loss: -4.0000  grad_norm: 203.0667  memory: 10.24GiB(21.56%)  tps: 3,096  tflops: 24.20  mfu: 7.76%
[rank2]:2025-12-25 06:55:40,293 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 06:55:40,329 -  step:  1  loss: -4.0000  grad_norm: 203.0667  memory: 16.58GiB(34.89%)  tps: 3,179  tflops: 24.85  mfu: 7.97%
[rank0]:2025-12-25 06:55:40,329 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 06:59:51,248 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-25 06:59:56,312 - Avg. fwd time: 14.8126 / Avg. bwd time: 41.7828 / Avg. batch time: 1121.9503 (ms) / GPU bubble ratio: 19.29%
[rank1]:2025-12-25 06:59:56,399 - Avg. fwd time: 9.8052 / Avg. bwd time: 23.8082 / Avg. batch time: 1239.7912 (ms) / GPU bubble ratio: 56.62%
[rank2]:2025-12-25 06:59:56,360 - Avg. fwd time: 8.0728 / Avg. bwd time: 19.2337 / Avg. batch time: 1181.7364 (ms) / GPU bubble ratio: 63.03%
[rank0]:2025-12-25 06:59:56,432 - Avg. fwd time: 8.3585 / Avg. bwd time: 21.2676 / Avg. batch time: 1278.7157 (ms) / GPU bubble ratio: 62.93%
[rank1]:2025-12-25 06:59:56,457 -  step: 50  loss: -4.0000  grad_norm: 24.2245  memory: 18.49GiB(38.93%)  tps: 6,268  tflops: 49.00  mfu: 15.71%
[rank2]:2025-12-25 06:59:56,453 -  step: 50  loss: -4.0000  grad_norm: 24.2245  memory: 12.06GiB(25.39%)  tps: 6,268  tflops: 49.00  mfu: 15.71%
[rank3]:2025-12-25 06:59:56,465 -  step: 50  loss:  9.8847  grad_norm: 24.2245  memory: 29.23GiB(61.52%)  tps: 6,268  tflops: 49.00  mfu: 15.71%
[rank0]:2025-12-25 06:59:56,468 -  step: 50  loss: -4.0000  grad_norm: 24.2245  memory: 20.42GiB(42.99%)  tps: 6,269  tflops: 49.01  mfu: 15.71%
[rank0]:2025-12-25 07:00:43,723 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 07:00:43,718 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 07:00:43,712 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 07:00:43,707 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 07:01:36,124 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8357e+00
[rank1]:2025-12-25 07:01:36,116 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9379e+00
[rank2]:2025-12-25 07:01:36,112 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0223e+00
[rank0]:2025-12-25 07:01:36,128 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.3824e+00
[rank1]:2025-12-25 07:02:26,738 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.1681e+00
[rank2]:2025-12-25 07:02:26,722 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.1249e+00
[rank0]:2025-12-25 07:02:26,751 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.9847e+00
[rank3]:2025-12-25 07:02:26,738 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.0328e+00
[rank3]:2025-12-25 07:03:18,970 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.0605e+00
[rank1]:2025-12-25 07:03:18,962 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 8.6547e+00
[rank2]:2025-12-25 07:03:18,958 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.0939e-01
[rank0]:2025-12-25 07:03:18,970 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.5398e+00
[rank3]:2025-12-25 07:04:09,333 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.1993e+00
[rank2]:2025-12-25 07:04:09,317 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5528e+00
[rank1]:2025-12-25 07:04:09,333 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.6619e+00
[rank0]:2025-12-25 07:04:09,313 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 07:04:09,345 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 4.5852e+00
[rank3]:2025-12-25 07:04:14,370 - Avg. fwd time: 14.8945 / Avg. bwd time: 40.6296 / Avg. batch time: 1111.8296 (ms) / GPU bubble ratio: 20.10%
[rank2]:2025-12-25 07:04:14,419 - Avg. fwd time: 8.1347 / Avg. bwd time: 17.8807 / Avg. batch time: 1172.2119 (ms) / GPU bubble ratio: 64.49%
[rank1]:2025-12-25 07:04:14,462 - Avg. fwd time: 9.8303 / Avg. bwd time: 23.9609 / Avg. batch time: 1232.4657 (ms) / GPU bubble ratio: 56.13%
[rank0]:2025-12-25 07:04:14,490 - Avg. fwd time: 8.3584 / Avg. bwd time: 21.0722 / Avg. batch time: 1270.9288 (ms) / GPU bubble ratio: 62.95%
[rank3]:2025-12-25 07:04:14,523 -  step: 100  loss:  8.3278  grad_norm: 15.9864  memory: 29.23GiB(61.52%)  tps: 6,349  tflops: 49.63  mfu: 15.91%
[rank2]:2025-12-25 07:04:14,511 -  step: 100  loss: -4.0000  grad_norm: 15.9864  memory: 12.06GiB(25.39%)  tps: 6,349  tflops: 49.63  mfu: 15.91%
[rank1]:2025-12-25 07:04:14,514 -  step: 100  loss: -4.0000  grad_norm: 15.9864  memory: 18.49GiB(38.93%)  tps: 6,349  tflops: 49.63  mfu: 15.91%
[rank0]:2025-12-25 07:04:14,521 -  step: 100  loss: -4.0000  grad_norm: 15.9864  memory: 20.42GiB(42.99%)  tps: 6,349  tflops: 49.63  mfu: 15.91%
[rank0]:2025-12-25 07:04:14,593 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0704_stage0_step100.svg
[rank2]:2025-12-25 07:04:14,594 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0704_stage2_step100.svg
[rank2]:2025-12-25 07:04:14,632 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0704_stage6_step100.svg
[rank1]:2025-12-25 07:04:14,594 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0704_stage1_step100.svg
[rank1]:2025-12-25 07:04:14,631 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0704_stage5_step100.svg
[rank0]:2025-12-25 07:04:14,632 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0704_stage4_step100.svg
[rank3]:2025-12-25 07:04:14,804 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0704_step100_rank3.svg
[rank3]:			> Batch Time: 1233.61 ms, GPU Bubble Ratio: 61.36%, 55.75%, 73.12%, 34.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  88-8-97ms      | [S4,MB2,F]  127-8-136ms    | [S4,MB3,F]  167-8-175ms    | [S0,MB4,F]  175-8-183ms    | [S0,MB5,F]  183-8-191ms    | [S0,MB6,F]  191-8-200ms    | [S4,MB0,B]  379-19-398ms   | [S0,MB7,F]  398-7-405ms    | [S4,MB1,B]  503-19-522ms   | [S4,MB4,F]  567-8-576ms    | [S4,MB2,B]  576-19-595ms   | [S4,MB5,F]  598-8-607ms    | [S4,MB3,B]  607-20-627ms   | [S4,MB6,F]  630-8-639ms    | [S0,MB0,B]  643-25-669ms   | [S4,MB7,F]  669-7-676ms    | [S0,MB1,B]  682-25-707ms   | [S0,MB2,B]  724-23-747ms   | [S0,MB3,B]  769-23-792ms   | [S4,MB4,B]  797-18-815ms   | [S4,MB5,B]  886-18-904ms   | [S4,MB6,B]  979-18-997ms   | [S4,MB7,B]  1069-18-1087ms | [S0,MB4,B]  1103-23-1126ms | [S0,MB5,B]  1137-23-1160ms | [S0,MB6,B]  1173-23-1196ms | [S0,MB7,B]  1210-23-1233ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  88-10-99ms     | [S1,MB3,F]  127-10-138ms   | [S5,MB0,F]  167-8-175ms    | [S5,MB1,F]  181-7-188ms    | [S5,MB2,F]  195-7-202ms    | [S5,MB3,F]  281-7-288ms    | [S1,MB4,F]  307-10-317ms   | [S5,MB0,B]  317-18-336ms   | [S1,MB5,F]  372-13-385ms   | [S5,MB1,B]  385-18-404ms   | [S1,MB6,F]  404-11-415ms   | [S5,MB2,B]  503-18-521ms   | [S1,MB7,F]  522-11-533ms   | [S5,MB3,B]  575-19-595ms   | [S5,MB4,F]  595-8-603ms    | [S1,MB0,B]  607-29-636ms   | [S5,MB5,F]  636-9-645ms    | [S1,MB1,B]  645-29-675ms   | [S5,MB6,F]  675-10-685ms   | [S1,MB2,B]  685-32-717ms   | [S5,MB7,F]  717-10-727ms   | [S1,MB3,B]  727-32-760ms   | [S5,MB4,B]  769-21-790ms   | [S5,MB5,B]  858-18-876ms   | [S5,MB6,B]  950-18-968ms   | [S5,MB7,B]  1044-18-1062ms | [S1,MB4,B]  1068-27-1095ms | [S1,MB5,B]  1103-27-1131ms | [S1,MB6,B]  1137-28-1165ms | [S1,MB7,B]  1173-29-1203ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  60-8-68ms      | [S2,MB2,F]  99-8-107ms     | [S2,MB3,F]  138-8-146ms    | [S6,MB0,F]  175-8-183ms    | [S6,MB1,F]  189-7-197ms    | [S6,MB2,F]  274-7-282ms    | [S6,MB0,B]  282-14-297ms   | [S6,MB3,F]  297-9-306ms    | [S6,MB1,B]  360-17-377ms   | [S2,MB4,F]  377-9-387ms    | [S6,MB2,B]  454-14-469ms   | [S2,MB5,F]  469-8-477ms    | [S6,MB3,B]  547-14-562ms   | [S2,MB6,F]  563-9-572ms    | [S2,MB0,B]  577-10-588ms   | [S2,MB7,F]  590-8-598ms    | [S2,MB1,B]  609-10-620ms   | [S6,MB4,F]  620-7-628ms    | [S2,MB2,B]  645-10-656ms   | [S6,MB5,F]  657-7-665ms    | [S2,MB3,B]  687-9-697ms    | [S6,MB6,F]  699-8-707ms    | [S6,MB4,B]  744-15-759ms   | [S6,MB7,F]  759-9-768ms    | [S6,MB5,B]  837-14-851ms   | [S6,MB6,B]  930-13-944ms   | [S6,MB7,B]  1024-13-1037ms | [S2,MB4,B]  1044-9-1053ms  | [S2,MB5,B]  1087-9-1096ms  | [S2,MB6,B]  1102-9-1111ms  | [S2,MB7,B]  1136-9-1145ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  107-7-115ms    | [S3,MB3,F]  146-7-154ms    | [S7,MB0,F]  183-15-199ms   | [S7,MB0,B]  210-54-265ms   | [S7,MB1,F]  265-19-285ms   | [S7,MB1,B]  296-57-354ms   | [S7,MB2,F]  354-22-376ms   | [S7,MB2,B]  387-59-447ms   | [S7,MB3,F]  448-21-470ms   | [S7,MB3,B]  481-60-542ms   | [S3,MB4,F]  541-13-554ms   | [S3,MB0,B]  554-13-568ms   | [S3,MB5,F]  569-11-581ms   | [S3,MB1,B]  581-13-594ms   | [S3,MB6,F]  595-11-606ms   | [S3,MB2,B]  606-12-619ms   | [S3,MB7,F]  619-11-630ms   | [S3,MB3,B]  630-12-643ms   | [S7,MB4,F]  653-17-670ms   | [S7,MB4,B]  682-56-739ms   | [S7,MB5,F]  738-21-760ms   | [S7,MB5,B]  772-58-831ms   | [S7,MB6,F]  831-21-852ms   | [S7,MB6,B]  864-59-924ms   | [S7,MB7,F]  924-21-945ms   | [S7,MB7,B]  957-59-1017ms  | [S3,MB4,B]  1017-14-1032ms | [S3,MB5,B]  1032-13-1045ms | [S3,MB6,B]  1045-12-1058ms | [S3,MB7,B]  1080-11-1092ms
[rank3]:2025-12-25 07:04:14,847 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0704_stage3_step100.svg
[rank3]:2025-12-25 07:04:14,884 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0704_stage7_step100.svg
[rank3]:2025-12-25 07:05:01,645 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.8010e-01
[rank2]:2025-12-25 07:05:01,633 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.5394e+00
[rank1]:2025-12-25 07:05:01,638 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.5643e+00
[rank0]:2025-12-25 07:05:01,645 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7492e+00
[rank3]:2025-12-25 07:05:50,984 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.0533e+00
[rank2]:2025-12-25 07:05:50,969 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5995e+00
[rank1]:2025-12-25 07:05:50,972 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3513e+00
[rank0]:2025-12-25 07:05:50,997 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.5626e+00
[rank2]:2025-12-25 07:06:43,181 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.4492e+00
[rank0]:2025-12-25 07:06:43,193 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.0169e+01
[rank1]:2025-12-25 07:06:43,186 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.2256e+00
[rank3]:2025-12-25 07:06:43,193 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.1526e+00
[rank1]:2025-12-25 07:07:31,640 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9398e+00
[rank2]:2025-12-25 07:07:31,640 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.2150e+00
[rank3]:2025-12-25 07:07:31,655 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.1455e+00
[rank0]:2025-12-25 07:07:31,663 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.2671e+00
[rank1]:2025-12-25 07:08:23,702 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.0460e-01
[rank2]:2025-12-25 07:08:23,697 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.7704e-01
[rank3]:2025-12-25 07:08:23,709 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9237e+00
[rank0]:2025-12-25 07:08:23,685 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 07:08:23,708 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.7435e+00
[rank2]:2025-12-25 07:08:28,512 - Avg. fwd time: 8.1583 / Avg. bwd time: 17.4016 / Avg. batch time: 1166.6701 (ms) / GPU bubble ratio: 64.95%
[rank3]:2025-12-25 07:08:28,473 - Avg. fwd time: 14.9302 / Avg. bwd time: 40.2016 / Avg. batch time: 1107.4622 (ms) / GPU bubble ratio: 20.35%
[rank1]:2025-12-25 07:08:28,537 - Avg. fwd time: 9.8719 / Avg. bwd time: 22.7414 / Avg. batch time: 1223.8247 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-12-25 07:08:28,576 -  step: 150  loss: -4.0000  grad_norm: 21.5231  memory: 18.49GiB(38.93%)  tps: 6,449  tflops: 50.41  mfu: 16.16%
[rank2]:2025-12-25 07:08:28,576 -  step: 150  loss: -4.0000  grad_norm: 21.5231  memory: 12.06GiB(25.39%)  tps: 6,449  tflops: 50.41  mfu: 16.16%
[rank3]:2025-12-25 07:08:28,591 -  step: 150  loss:  3.6249  grad_norm: 21.5231  memory: 29.23GiB(61.52%)  tps: 6,449  tflops: 50.41  mfu: 16.16%
[rank0]:2025-12-25 07:08:28,565 - Avg. fwd time: 8.3952 / Avg. bwd time: 20.5695 / Avg. batch time: 1261.8645 (ms) / GPU bubble ratio: 63.27%
[rank0]:2025-12-25 07:08:28,597 -  step: 150  loss: -4.0000  grad_norm: 21.5231  memory: 20.42GiB(42.99%)  tps: 6,448  tflops: 50.41  mfu: 16.16%
[rank1]:2025-12-25 07:09:12,308 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.2992e+00
[rank2]:2025-12-25 07:09:12,308 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.5507e+00
[rank0]:2025-12-25 07:09:12,331 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.8500e+00
[rank3]:2025-12-25 07:09:12,324 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.1683e+00
[rank2]:2025-12-25 07:10:04,562 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.4304e+01
[rank1]:2025-12-25 07:10:04,566 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.0854e+01
[rank0]:2025-12-25 07:10:04,573 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 6.1040e+01
[rank3]:2025-12-25 07:10:04,573 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.0572e+00
[rank1]:2025-12-25 07:10:53,062 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.7948e+00
[rank2]:2025-12-25 07:10:53,062 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.6163e+00
[rank3]:2025-12-25 07:10:53,077 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.3357e+00
[rank0]:2025-12-25 07:10:53,086 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.3592e+00
[rank1]:2025-12-25 07:11:44,913 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.1173e-01
[rank2]:2025-12-25 07:11:44,908 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.5666e+00
[rank3]:2025-12-25 07:11:44,920 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9996e+00
[rank0]:2025-12-25 07:11:44,916 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.7444e+00
[rank1]:2025-12-25 07:12:33,391 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.5393e+00
[rank2]:2025-12-25 07:12:33,391 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.0023e+00
[rank3]:2025-12-25 07:12:33,406 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.0705e+00
[rank0]:2025-12-25 07:12:33,387 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 07:12:33,414 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.3181e+00
[rank2]:2025-12-25 07:12:38,568 - Avg. fwd time: 8.1899 / Avg. bwd time: 16.8963 / Avg. batch time: 1160.7118 (ms) / GPU bubble ratio: 65.42%
[rank3]:2025-12-25 07:12:38,525 - Avg. fwd time: 14.9631 / Avg. bwd time: 39.7580 / Avg. batch time: 1102.7847 (ms) / GPU bubble ratio: 20.61%
[rank1]:2025-12-25 07:12:38,616 - Avg. fwd time: 9.9247 / Avg. bwd time: 21.6467 / Avg. batch time: 1215.3438 (ms) / GPU bubble ratio: 58.44%
[rank2]:2025-12-25 07:12:38,659 -  step: 200  loss: -4.0000  grad_norm: 16.5445  memory: 12.06GiB(25.39%)  tps: 6,551  tflops: 51.22  mfu: 16.42%
[rank3]:2025-12-25 07:12:38,671 -  step: 200  loss:  1.0955  grad_norm: 16.5445  memory: 29.23GiB(61.52%)  tps: 6,552  tflops: 51.22  mfu: 16.42%
[rank0]:2025-12-25 07:12:38,640 - Avg. fwd time: 8.4339 / Avg. bwd time: 20.0748 / Avg. batch time: 1252.5522 (ms) / GPU bubble ratio: 63.58%
[rank0]:2025-12-25 07:12:38,663 -  step: 200  loss: -4.0000  grad_norm: 16.5445  memory: 20.42GiB(42.99%)  tps: 6,552  tflops: 51.22  mfu: 16.42%
[rank1]:2025-12-25 07:12:38,662 -  step: 200  loss: -4.0000  grad_norm: 16.5445  memory: 18.49GiB(38.93%)  tps: 6,551  tflops: 51.22  mfu: 16.42%
[rank1]:2025-12-25 07:12:38,722 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0712_stage1_step200.svg
[rank2]:2025-12-25 07:12:38,722 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0712_stage2_step200.svg
[rank2]:2025-12-25 07:12:38,764 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0712_stage6_step200.svg
[rank0]:2025-12-25 07:12:38,720 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0712_stage0_step200.svg
[rank0]:2025-12-25 07:12:38,763 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0712_stage4_step200.svg
[rank1]:2025-12-25 07:12:38,764 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0712_stage5_step200.svg
[rank3]:2025-12-25 07:12:38,913 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0712_step200_rank3.svg
[rank3]:			> Batch Time: 1190.12 ms, GPU Bubble Ratio: 62.64%, 66.84%, 71.77%, 31.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-98ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-8-180ms    | [S0,MB4,F]  180-8-188ms    | [S0,MB5,F]  188-8-197ms    | [S0,MB6,F]  197-9-206ms    | [S4,MB0,B]  383-19-402ms   | [S0,MB7,F]  401-7-409ms    | [S4,MB1,B]  507-19-526ms   | [S4,MB4,F]  571-8-580ms    | [S4,MB2,B]  580-19-599ms   | [S4,MB5,F]  603-8-612ms    | [S4,MB3,B]  612-20-632ms   | [S4,MB6,F]  635-8-644ms    | [S0,MB0,B]  644-21-665ms   | [S4,MB7,F]  669-7-676ms    | [S0,MB1,B]  677-20-697ms   | [S0,MB2,B]  702-19-721ms   | [S0,MB3,B]  762-19-781ms   | [S4,MB4,B]  790-18-808ms   | [S4,MB5,B]  889-18-907ms   | [S4,MB6,B]  983-18-1001ms  | [S4,MB7,B]  1069-18-1087ms | [S0,MB4,B]  1096-19-1115ms | [S0,MB5,B]  1126-19-1145ms | [S0,MB6,B]  1148-19-1167ms | [S0,MB7,B]  1171-19-1190ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  90-12-102ms    | [S1,MB3,F]  130-12-142ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  185-7-193ms    | [S5,MB2,F]  199-7-207ms    | [S5,MB3,F]  283-7-290ms    | [S1,MB4,F]  310-11-321ms   | [S5,MB0,B]  321-14-335ms   | [S1,MB5,F]  375-14-389ms   | [S5,MB1,B]  390-14-404ms   | [S1,MB6,F]  404-12-416ms   | [S5,MB2,B]  506-14-520ms   | [S1,MB7,F]  521-12-533ms   | [S5,MB3,B]  579-15-594ms   | [S5,MB4,F]  595-7-603ms    | [S1,MB0,B]  611-15-627ms   | [S5,MB5,F]  630-8-638ms    | [S1,MB1,B]  645-15-660ms   | [S5,MB6,F]  661-9-670ms    | [S1,MB2,B]  673-15-689ms   | [S5,MB7,F]  689-9-699ms    | [S1,MB3,B]  702-14-717ms   | [S5,MB4,B]  769-13-783ms   | [S5,MB5,B]  860-13-874ms   | [S5,MB6,B]  954-13-967ms   | [S5,MB7,B]  1048-13-1062ms | [S1,MB4,B]  1068-13-1082ms | [S1,MB5,B]  1105-13-1119ms | [S1,MB6,B]  1125-13-1139ms | [S1,MB7,B]  1147-13-1161ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  61-8-69ms      | [S2,MB2,F]  102-8-110ms    | [S2,MB3,F]  142-8-150ms    | [S6,MB0,F]  179-8-187ms    | [S6,MB1,F]  193-7-201ms    | [S6,MB2,F]  277-7-284ms    | [S6,MB0,B]  284-14-299ms   | [S6,MB3,F]  300-9-309ms    | [S6,MB1,B]  363-17-380ms   | [S2,MB4,F]  381-9-390ms    | [S6,MB2,B]  457-15-472ms   | [S2,MB5,F]  473-8-481ms    | [S6,MB3,B]  551-15-566ms   | [S2,MB6,F]  567-9-577ms    | [S2,MB0,B]  582-10-593ms   | [S2,MB7,F]  595-8-604ms    | [S2,MB1,B]  615-10-625ms   | [S6,MB4,F]  626-8-634ms    | [S2,MB2,B]  646-10-657ms   | [S6,MB5,F]  658-8-666ms    | [S2,MB3,B]  679-10-689ms   | [S6,MB6,F]  689-9-698ms    | [S6,MB4,B]  746-16-762ms   | [S6,MB7,F]  763-9-772ms    | [S6,MB5,B]  840-14-854ms   | [S6,MB6,B]  934-13-947ms   | [S6,MB7,B]  1028-13-1042ms | [S2,MB4,B]  1048-9-1057ms  | [S2,MB5,B]  1089-9-1098ms  | [S2,MB6,B]  1105-9-1114ms  | [S2,MB7,B]  1125-9-1134ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  150-7-158ms    | [S7,MB0,F]  187-15-203ms   | [S7,MB0,B]  215-53-268ms   | [S7,MB1,F]  267-19-287ms   | [S7,MB1,B]  299-57-357ms   | [S7,MB2,F]  357-21-379ms   | [S7,MB2,B]  390-60-451ms   | [S7,MB3,F]  451-21-473ms   | [S7,MB3,B]  485-60-545ms   | [S3,MB4,F]  545-12-558ms   | [S3,MB0,B]  558-13-571ms   | [S3,MB5,F]  573-11-585ms   | [S3,MB1,B]  585-13-598ms   | [S3,MB6,F]  601-11-612ms   | [S3,MB2,B]  612-12-625ms   | [S3,MB7,F]  624-11-636ms   | [S3,MB3,B]  636-12-649ms   | [S7,MB4,F]  653-18-672ms   | [S7,MB4,B]  683-57-740ms   | [S7,MB5,F]  739-21-761ms   | [S7,MB5,B]  773-59-833ms   | [S7,MB6,F]  833-21-855ms   | [S7,MB6,B]  867-60-927ms   | [S7,MB7,F]  927-21-949ms   | [S7,MB7,B]  961-60-1021ms  | [S3,MB4,B]  1022-14-1036ms | [S3,MB5,B]  1036-13-1050ms | [S3,MB6,B]  1050-12-1063ms | [S3,MB7,B]  1081-11-1093ms
[rank3]:2025-12-25 07:12:38,957 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0712_stage3_step200.svg
[rank3]:2025-12-25 07:12:38,998 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0712_stage7_step200.svg
[rank1]:2025-12-25 07:13:25,602 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 5.7585e-01
[rank2]:2025-12-25 07:13:25,597 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.2732e+00
[rank3]:2025-12-25 07:13:25,608 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9072e+00
[rank0]:2025-12-25 07:13:25,601 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.1973e+00
[rank1]:2025-12-25 07:14:14,053 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8171e+00
[rank2]:2025-12-25 07:14:14,053 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5868e+00
[rank3]:2025-12-25 07:14:14,068 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.3561e+00
[rank0]:2025-12-25 07:14:14,076 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3478e+00
[rank2]:2025-12-25 07:15:05,749 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7442e+00
[rank3]:2025-12-25 07:15:05,761 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7263e+00
[rank0]:2025-12-25 07:15:05,753 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 5.3725e+00
[rank1]:2025-12-25 07:15:05,755 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1629e+00
[rank1]:2025-12-25 07:15:54,283 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.0894e+00
[rank2]:2025-12-25 07:15:54,283 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.1566e+00
[rank3]:2025-12-25 07:15:54,298 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.5194e+00
[rank0]:2025-12-25 07:15:54,306 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.5888e+00
[rank2]:2025-12-25 07:16:46,079 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.1574e-01
[rank0]:2025-12-25 07:16:46,068 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 07:16:46,083 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 9.1352e-01
[rank3]:2025-12-25 07:16:46,091 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0585e+00
[rank1]:2025-12-25 07:16:46,085 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.2973e-01
[rank3]:2025-12-25 07:16:50,801 - Avg. fwd time: 14.9746 / Avg. bwd time: 39.6775 / Avg. batch time: 1101.9566 (ms) / GPU bubble ratio: 20.65%
[rank1]:2025-12-25 07:16:50,866 - Avg. fwd time: 9.9405 / Avg. bwd time: 21.3198 / Avg. batch time: 1213.0121 (ms) / GPU bubble ratio: 58.77%
[rank2]:2025-12-25 07:16:50,842 - Avg. fwd time: 8.1943 / Avg. bwd time: 16.8214 / Avg. batch time: 1159.1846 (ms) / GPU bubble ratio: 65.47%
[rank0]:2025-12-25 07:16:50,896 - Avg. fwd time: 8.4909 / Avg. bwd time: 19.3568 / Avg. batch time: 1249.3231 (ms) / GPU bubble ratio: 64.34%
[rank3]:2025-12-25 07:16:50,922 -  step: 250  loss:  0.3884  grad_norm:  4.1997  memory: 29.23GiB(61.52%)  tps: 6,495  tflops: 50.78  mfu: 16.27%
[rank1]:2025-12-25 07:16:50,907 -  step: 250  loss: -4.0000  grad_norm:  4.1997  memory: 18.49GiB(38.93%)  tps: 6,495  tflops: 50.78  mfu: 16.27%
[rank2]:2025-12-25 07:16:50,907 -  step: 250  loss: -4.0000  grad_norm:  4.1997  memory: 12.06GiB(25.39%)  tps: 6,495  tflops: 50.78  mfu: 16.27%
[rank0]:2025-12-25 07:16:50,928 -  step: 250  loss: -4.0000  grad_norm:  4.1997  memory: 20.42GiB(42.99%)  tps: 6,495  tflops: 50.77  mfu: 16.27%
[rank1]:2025-12-25 07:17:34,538 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.6700e+00
[rank2]:2025-12-25 07:17:34,538 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5643e+00
[rank3]:2025-12-25 07:17:34,554 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.7109e+00
[rank0]:2025-12-25 07:17:34,562 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.6862e+00
[rank1]:2025-12-25 07:18:26,193 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 5.2719e+00
[rank2]:2025-12-25 07:18:26,187 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.3399e+00
[rank3]:2025-12-25 07:18:26,199 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6041e+01
[rank0]:2025-12-25 07:18:26,192 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.7439e+01
[rank1]:2025-12-25 07:19:14,039 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3289e+00
[rank3]:2025-12-25 07:19:14,054 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2418e+00
[rank2]:2025-12-25 07:19:14,039 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.8635e+00
[rank0]:2025-12-25 07:19:14,054 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.5737e+00
[rank1]:2025-12-25 07:20:05,845 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.8293e-01
[rank3]:2025-12-25 07:20:05,851 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8882e+00
[rank2]:2025-12-25 07:20:05,839 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3071e+00
[rank0]:2025-12-25 07:20:05,843 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.2456e+00
[rank1]:2025-12-25 07:20:53,571 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.5806e-01
[rank3]:2025-12-25 07:20:53,586 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.4691e-01
[rank2]:2025-12-25 07:20:53,571 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.6392e-01
[rank0]:2025-12-25 07:20:53,568 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 07:20:53,587 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.1511e-01
[rank3]:2025-12-25 07:20:58,623 - Avg. fwd time: 14.9882 / Avg. bwd time: 39.4514 / Avg. batch time: 1099.1218 (ms) / GPU bubble ratio: 20.75%
[rank1]:2025-12-25 07:20:58,710 - Avg. fwd time: 9.9687 / Avg. bwd time: 20.8467 / Avg. batch time: 1208.2006 (ms) / GPU bubble ratio: 59.19%
[rank2]:2025-12-25 07:20:58,668 - Avg. fwd time: 8.2118 / Avg. bwd time: 16.5910 / Avg. batch time: 1155.5542 (ms) / GPU bubble ratio: 65.66%
[rank0]:2025-12-25 07:20:58,735 - Avg. fwd time: 8.5396 / Avg. bwd time: 18.6970 / Avg. batch time: 1243.6483 (ms) / GPU bubble ratio: 64.96%
[rank1]:2025-12-25 07:20:58,758 -  step: 300  loss: -4.0000  grad_norm:  0.6654  memory: 18.49GiB(38.93%)  tps: 6,610  tflops: 51.68  mfu: 16.56%
[rank1]:2025-12-25 07:20:58,820 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0720_stage1_step300.svg
[rank3]:2025-12-25 07:20:58,766 -  step: 300  loss:  0.2769  grad_norm:  0.6654  memory: 29.23GiB(61.52%)  tps: 6,611  tflops: 51.68  mfu: 16.56%
[rank2]:2025-12-25 07:20:58,754 -  step: 300  loss: -4.0000  grad_norm:  0.6654  memory: 12.06GiB(25.39%)  tps: 6,611  tflops: 51.68  mfu: 16.56%
[rank2]:2025-12-25 07:20:58,820 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0720_stage2_step300.svg
[rank0]:2025-12-25 07:20:58,758 -  step: 300  loss: -4.0000  grad_norm:  0.6654  memory: 20.42GiB(42.99%)  tps: 6,611  tflops: 51.68  mfu: 16.56%
[rank0]:2025-12-25 07:20:58,822 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0720_stage0_step300.svg
[rank1]:2025-12-25 07:20:58,861 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0720_stage5_step300.svg
[rank2]:2025-12-25 07:20:58,860 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0720_stage6_step300.svg
[rank0]:2025-12-25 07:20:58,865 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0720_stage4_step300.svg
[rank3]:2025-12-25 07:20:59,023 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0720_step300_rank3.svg
[rank3]:			> Batch Time: 1173.51 ms, GPU Bubble Ratio: 67.98%, 66.27%, 71.28%, 30.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-99ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-8-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-197ms    | [S0,MB6,F]  197-9-207ms    | [S4,MB0,B]  383-14-398ms   | [S0,MB7,F]  398-8-406ms    | [S4,MB1,B]  507-14-522ms   | [S4,MB4,F]  572-8-580ms    | [S4,MB2,B]  581-15-596ms   | [S4,MB5,F]  602-9-611ms    | [S4,MB3,B]  611-15-626ms   | [S4,MB6,F]  634-9-643ms    | [S0,MB0,B]  643-16-660ms   | [S4,MB7,F]  664-8-672ms    | [S0,MB1,B]  672-16-688ms   | [S0,MB2,B]  692-14-707ms   | [S0,MB3,B]  761-14-775ms   | [S4,MB4,B]  789-13-802ms   | [S4,MB5,B]  887-13-900ms   | [S4,MB6,B]  980-13-993ms   | [S4,MB7,B]  1065-13-1078ms | [S0,MB4,B]  1088-14-1102ms | [S0,MB5,B]  1118-14-1132ms | [S0,MB6,B]  1138-14-1152ms | [S0,MB7,B]  1159-14-1173ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  90-11-102ms    | [S1,MB3,F]  130-11-142ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  186-7-193ms    | [S5,MB2,F]  200-7-207ms    | [S5,MB3,F]  284-7-291ms    | [S1,MB4,F]  311-11-322ms   | [S5,MB0,B]  322-14-336ms   | [S1,MB5,F]  376-14-390ms   | [S5,MB1,B]  391-14-405ms   | [S1,MB6,F]  405-12-417ms   | [S5,MB2,B]  507-14-521ms   | [S1,MB7,F]  522-12-534ms   | [S5,MB3,B]  580-15-595ms   | [S5,MB4,F]  595-7-603ms    | [S1,MB0,B]  610-15-626ms   | [S5,MB5,F]  628-8-636ms    | [S1,MB1,B]  643-15-658ms   | [S5,MB6,F]  659-9-668ms    | [S1,MB2,B]  669-15-684ms   | [S5,MB7,F]  685-10-695ms   | [S1,MB3,B]  695-14-709ms   | [S5,MB4,B]  768-13-782ms   | [S5,MB5,B]  859-13-872ms   | [S5,MB6,B]  951-13-964ms   | [S5,MB7,B]  1044-13-1058ms | [S1,MB4,B]  1064-13-1078ms | [S1,MB5,B]  1097-13-1111ms | [S1,MB6,B]  1117-13-1131ms | [S1,MB7,B]  1137-13-1151ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  61-8-69ms      | [S2,MB2,F]  102-8-110ms    | [S2,MB3,F]  142-8-150ms    | [S6,MB0,F]  179-8-187ms    | [S6,MB1,F]  193-7-201ms    | [S6,MB2,F]  277-7-285ms    | [S6,MB0,B]  285-14-300ms   | [S6,MB3,F]  301-9-310ms    | [S6,MB1,B]  364-17-381ms   | [S2,MB4,F]  382-9-391ms    | [S6,MB2,B]  457-15-472ms   | [S2,MB5,F]  473-8-481ms    | [S6,MB3,B]  552-15-567ms   | [S2,MB6,F]  567-9-576ms    | [S2,MB0,B]  582-10-592ms   | [S2,MB7,F]  595-8-603ms    | [S2,MB1,B]  613-10-624ms   | [S6,MB4,F]  625-8-633ms    | [S2,MB2,B]  644-10-655ms   | [S6,MB5,F]  655-8-664ms    | [S2,MB3,B]  670-10-680ms   | [S6,MB6,F]  680-9-690ms    | [S6,MB4,B]  745-16-762ms   | [S6,MB7,F]  762-9-771ms    | [S6,MB5,B]  838-14-852ms   | [S6,MB6,B]  931-13-944ms   | [S6,MB7,B]  1024-13-1038ms | [S2,MB4,B]  1044-9-1053ms  | [S2,MB5,B]  1081-9-1090ms  | [S2,MB6,B]  1096-9-1105ms  | [S2,MB7,B]  1117-9-1126ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  150-7-158ms    | [S7,MB0,F]  187-15-203ms   | [S7,MB0,B]  215-53-268ms   | [S7,MB1,F]  268-19-288ms   | [S7,MB1,B]  299-57-357ms   | [S7,MB2,F]  357-21-379ms   | [S7,MB2,B]  391-59-450ms   | [S7,MB3,F]  450-21-472ms   | [S7,MB3,B]  485-60-545ms   | [S3,MB4,F]  545-12-558ms   | [S3,MB0,B]  558-13-572ms   | [S3,MB5,F]  573-11-585ms   | [S3,MB1,B]  585-13-598ms   | [S3,MB6,F]  600-11-612ms   | [S3,MB2,B]  612-13-625ms   | [S3,MB7,F]  625-11-636ms   | [S3,MB3,B]  636-12-648ms   | [S7,MB4,F]  651-19-670ms   | [S7,MB4,B]  682-57-739ms   | [S7,MB5,F]  739-21-760ms   | [S7,MB5,B]  772-59-831ms   | [S7,MB6,F]  832-21-853ms   | [S7,MB6,B]  865-59-924ms   | [S7,MB7,F]  924-21-946ms   | [S7,MB7,B]  958-60-1018ms  | [S3,MB4,B]  1018-14-1032ms | [S3,MB5,B]  1033-13-1046ms | [S3,MB6,B]  1046-12-1059ms | [S3,MB7,B]  1072-11-1084ms
[rank3]:2025-12-25 07:20:59,066 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0720_stage3_step300.svg
[rank3]:2025-12-25 07:20:59,106 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0720_stage7_step300.svg
[rank2]:2025-12-25 07:21:45,587 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.7127e-01
[rank0]:2025-12-25 07:21:45,591 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.6536e+00
[rank1]:2025-12-25 07:21:45,592 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.1622e-01
[rank3]:2025-12-25 07:21:45,599 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.9537e-01
[rank1]:2025-12-25 07:22:33,511 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8736e+00
[rank3]:2025-12-25 07:22:33,526 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0627e+00
[rank2]:2025-12-25 07:22:33,511 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.8282e+00
[rank0]:2025-12-25 07:22:33,526 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.9894e+00
[rank0]:2025-12-25 07:23:25,330 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0747e+00
[rank1]:2025-12-25 07:23:25,331 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.6564e-01
[rank2]:2025-12-25 07:23:25,326 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.5097e-01
[rank3]:2025-12-25 07:23:25,337 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.7795e+00
[rank3]:2025-12-25 07:24:13,216 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 9.3254e-01
[rank2]:2025-12-25 07:24:13,201 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.3181e+00
[rank1]:2025-12-25 07:24:13,201 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.9562e-01
[rank0]:2025-12-25 07:24:13,217 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.4016e-01
[rank0]:2025-12-25 07:25:04,874 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 07:25:04,897 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.3702e-01
[rank1]:2025-12-25 07:25:04,890 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.8222e-02
[rank2]:2025-12-25 07:25:04,885 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8028e-01
[rank0]:2025-12-25 07:25:04,889 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.3943e-01
[rank3]:2025-12-25 07:25:09,614 - Avg. fwd time: 14.9943 / Avg. bwd time: 39.4382 / Avg. batch time: 1098.7237 (ms) / GPU bubble ratio: 20.73%
[rank2]:2025-12-25 07:25:09,652 - Avg. fwd time: 8.2166 / Avg. bwd time: 16.5820 / Avg. batch time: 1154.8543 (ms) / GPU bubble ratio: 65.64%
[rank3]:2025-12-25 07:25:09,729 -  step: 350  loss:  0.2297  grad_norm:  0.3277  memory: 29.23GiB(61.52%)  tps: 6,529  tflops: 51.04  mfu: 16.36%
[rank1]:2025-12-25 07:25:09,678 - Avg. fwd time: 9.9783 / Avg. bwd time: 20.7279 / Avg. batch time: 1207.0913 (ms) / GPU bubble ratio: 59.30%
[rank1]:2025-12-25 07:25:09,713 -  step: 350  loss: -4.0000  grad_norm:  0.3277  memory: 18.49GiB(38.93%)  tps: 6,529  tflops: 51.04  mfu: 16.36%
[rank2]:2025-12-25 07:25:09,713 -  step: 350  loss: -4.0000  grad_norm:  0.3277  memory: 12.06GiB(25.39%)  tps: 6,529  tflops: 51.04  mfu: 16.36%
[rank0]:2025-12-25 07:25:09,704 - Avg. fwd time: 8.5854 / Avg. bwd time: 18.1007 / Avg. batch time: 1241.7677 (ms) / GPU bubble ratio: 65.62%
[rank0]:2025-12-25 07:25:09,727 -  step: 350  loss: -4.0000  grad_norm:  0.3277  memory: 20.42GiB(42.99%)  tps: 6,528  tflops: 51.04  mfu: 16.36%
[rank3]:2025-12-25 07:25:52,908 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1908e-01
[rank2]:2025-12-25 07:25:52,893 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.2039e-01
[rank1]:2025-12-25 07:25:52,893 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.4054e-01
[rank0]:2025-12-25 07:25:52,909 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.2065e-01
[rank3]:2025-12-25 07:26:44,756 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.3949e-01
[rank1]:2025-12-25 07:26:44,750 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.4163e-01
[rank2]:2025-12-25 07:26:44,744 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.1012e-01
[rank0]:2025-12-25 07:26:44,749 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0684e+00
[rank3]:2025-12-25 07:27:32,694 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2523e+00
[rank1]:2025-12-25 07:27:32,678 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.2585e+00
[rank2]:2025-12-25 07:27:32,678 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.3429e+00
[rank0]:2025-12-25 07:27:32,694 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.4348e+00
[rank0]:2025-12-25 07:28:24,447 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.7562e-01
[rank3]:2025-12-25 07:28:24,454 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.1042e-01
[rank2]:2025-12-25 07:28:24,443 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.6229e-01
[rank1]:2025-12-25 07:28:24,447 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.1213e-02
[rank2]:2025-12-25 07:29:12,360 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.7635e-01
[rank1]:2025-12-25 07:29:12,360 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.8252e-01
[rank0]:2025-12-25 07:29:12,356 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 07:29:12,375 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1075e-01
[rank3]:2025-12-25 07:29:12,375 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.2663e-01
[rank2]:2025-12-25 07:29:17,532 - Avg. fwd time: 8.2296 / Avg. bwd time: 16.4365 / Avg. batch time: 1152.8198 (ms) / GPU bubble ratio: 65.77%
[rank3]:2025-12-25 07:29:17,489 - Avg. fwd time: 15.0071 / Avg. bwd time: 39.3140 / Avg. batch time: 1097.1829 (ms) / GPU bubble ratio: 20.78%
[rank1]:2025-12-25 07:29:17,576 - Avg. fwd time: 9.9970 / Avg. bwd time: 20.4418 / Avg. batch time: 1204.3018 (ms) / GPU bubble ratio: 59.56%
[rank0]:2025-12-25 07:29:17,602 - Avg. fwd time: 8.6187 / Avg. bwd time: 17.6550 / Avg. batch time: 1238.3920 (ms) / GPU bubble ratio: 66.05%
[rank2]:2025-12-25 07:29:17,621 -  step: 400  loss: -4.0000  grad_norm:  1.3587  memory: 12.06GiB(25.39%)  tps: 6,609  tflops: 51.67  mfu: 16.56%
[rank3]:2025-12-25 07:29:17,632 -  step: 400  loss:  0.2200  grad_norm:  1.3587  memory: 29.23GiB(61.52%)  tps: 6,609  tflops: 51.67  mfu: 16.56%
[rank1]:2025-12-25 07:29:17,624 -  step: 400  loss: -4.0000  grad_norm:  1.3587  memory: 18.49GiB(38.93%)  tps: 6,609  tflops: 51.66  mfu: 16.56%
[rank1]:2025-12-25 07:29:17,686 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0729_stage1_step400.svg
[rank0]:2025-12-25 07:29:17,625 -  step: 400  loss: -4.0000  grad_norm:  1.3587  memory: 20.42GiB(42.99%)  tps: 6,609  tflops: 51.67  mfu: 16.56%
[rank0]:2025-12-25 07:29:17,684 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0729_stage0_step400.svg
[rank2]:2025-12-25 07:29:17,686 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0729_stage2_step400.svg
[rank2]:2025-12-25 07:29:17,730 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0729_stage6_step400.svg
[rank1]:2025-12-25 07:29:17,730 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0729_stage5_step400.svg
[rank0]:2025-12-25 07:29:17,729 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0729_stage4_step400.svg
[rank3]:2025-12-25 07:29:17,874 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0729_step400_rank3.svg
[rank3]:			> Batch Time: 1177.48 ms, GPU Bubble Ratio: 68.08%, 66.35%, 71.35%, 30.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-99ms      | [S4,MB2,F]  131-8-140ms    | [S4,MB3,F]  172-8-181ms    | [S0,MB4,F]  181-9-190ms    | [S0,MB5,F]  190-8-198ms    | [S0,MB6,F]  198-9-208ms    | [S4,MB0,B]  384-14-399ms   | [S0,MB7,F]  398-8-406ms    | [S4,MB1,B]  508-14-522ms   | [S4,MB4,F]  573-8-581ms    | [S4,MB2,B]  582-15-597ms   | [S4,MB5,F]  603-9-612ms    | [S4,MB3,B]  612-15-627ms   | [S4,MB6,F]  635-9-644ms    | [S0,MB0,B]  644-16-660ms   | [S4,MB7,F]  665-8-673ms    | [S0,MB1,B]  673-15-689ms   | [S0,MB2,B]  693-14-708ms   | [S0,MB3,B]  763-14-777ms   | [S4,MB4,B]  791-13-805ms   | [S4,MB5,B]  891-13-904ms   | [S4,MB6,B]  984-13-998ms   | [S4,MB7,B]  1070-13-1083ms | [S0,MB4,B]  1092-14-1106ms | [S0,MB5,B]  1122-14-1136ms | [S0,MB6,B]  1142-14-1156ms | [S0,MB7,B]  1163-14-1177ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  90-12-102ms    | [S1,MB3,F]  131-12-143ms   | [S5,MB0,F]  172-8-180ms    | [S5,MB1,F]  186-7-194ms    | [S5,MB2,F]  200-7-208ms    | [S5,MB3,F]  284-7-292ms    | [S1,MB4,F]  311-11-323ms   | [S5,MB0,B]  323-14-337ms   | [S1,MB5,F]  376-14-390ms   | [S5,MB1,B]  390-14-405ms   | [S1,MB6,F]  406-12-418ms   | [S5,MB2,B]  507-14-521ms   | [S1,MB7,F]  522-12-534ms   | [S5,MB3,B]  580-15-596ms   | [S5,MB4,F]  596-7-604ms    | [S1,MB0,B]  611-15-627ms   | [S5,MB5,F]  629-8-637ms    | [S1,MB1,B]  643-15-659ms   | [S5,MB6,F]  659-9-669ms    | [S1,MB2,B]  669-15-685ms   | [S5,MB7,F]  685-9-695ms    | [S1,MB3,B]  695-14-710ms   | [S5,MB4,B]  770-13-784ms   | [S5,MB5,B]  861-13-875ms   | [S5,MB6,B]  954-13-968ms   | [S5,MB7,B]  1049-13-1063ms | [S1,MB4,B]  1069-13-1083ms | [S1,MB5,B]  1101-13-1115ms | [S1,MB6,B]  1121-13-1135ms | [S1,MB7,B]  1141-13-1155ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  61-8-69ms      | [S2,MB2,F]  102-8-110ms    | [S2,MB3,F]  143-8-151ms    | [S6,MB0,F]  180-8-188ms    | [S6,MB1,F]  194-7-202ms    | [S6,MB2,F]  278-7-286ms    | [S6,MB0,B]  286-14-301ms   | [S6,MB3,F]  301-9-310ms    | [S6,MB1,B]  364-17-381ms   | [S2,MB4,F]  382-9-391ms    | [S6,MB2,B]  458-15-473ms   | [S2,MB5,F]  474-8-482ms    | [S6,MB3,B]  553-15-568ms   | [S2,MB6,F]  568-9-578ms    | [S2,MB0,B]  584-10-594ms   | [S2,MB7,F]  596-8-604ms    | [S2,MB1,B]  615-10-625ms   | [S6,MB4,F]  626-8-634ms    | [S2,MB2,B]  645-10-656ms   | [S6,MB5,F]  656-8-665ms    | [S2,MB3,B]  671-10-681ms   | [S6,MB6,F]  681-9-691ms    | [S6,MB4,B]  747-16-764ms   | [S6,MB7,F]  764-9-773ms    | [S6,MB5,B]  841-14-855ms   | [S6,MB6,B]  935-13-948ms   | [S6,MB7,B]  1029-13-1042ms | [S2,MB4,B]  1049-9-1058ms  | [S2,MB5,B]  1085-9-1094ms  | [S2,MB6,B]  1100-9-1109ms  | [S2,MB7,B]  1121-9-1130ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  151-7-159ms    | [S7,MB0,F]  188-15-204ms   | [S7,MB0,B]  216-53-269ms   | [S7,MB1,F]  269-19-289ms   | [S7,MB1,B]  300-58-359ms   | [S7,MB2,F]  358-22-380ms   | [S7,MB2,B]  392-60-452ms   | [S7,MB3,F]  452-21-474ms   | [S7,MB3,B]  486-60-546ms   | [S3,MB4,F]  546-12-559ms   | [S3,MB0,B]  559-13-573ms   | [S3,MB5,F]  575-11-586ms   | [S3,MB1,B]  586-13-600ms   | [S3,MB6,F]  602-11-613ms   | [S3,MB2,B]  613-13-626ms   | [S3,MB7,F]  626-11-637ms   | [S3,MB3,B]  637-12-650ms   | [S7,MB4,F]  652-19-671ms   | [S7,MB4,B]  683-57-740ms   | [S7,MB5,F]  741-21-763ms   | [S7,MB5,B]  775-60-835ms   | [S7,MB6,F]  835-21-857ms   | [S7,MB6,B]  868-60-928ms   | [S7,MB7,F]  928-21-950ms   | [S7,MB7,B]  962-60-1022ms  | [S3,MB4,B]  1022-14-1037ms | [S3,MB5,B]  1037-13-1050ms | [S3,MB6,B]  1051-12-1064ms | [S3,MB7,B]  1076-12-1088ms
[rank3]:2025-12-25 07:29:17,922 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0729_stage3_step400.svg
[rank3]:2025-12-25 07:29:17,966 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0729_stage7_step400.svg
[rank3]:2025-12-25 07:29:47,058 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 07:29:47,510 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-25 07:29:47,556 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-25 07:29:47,541 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-25 07:30:04,478 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.9447e+00
[rank2]:2025-12-25 07:30:04,473 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.0462e-01
[rank3]:2025-12-25 07:30:04,485 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.5239e-01
[rank1]:2025-12-25 07:30:04,478 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.6217e-01
[rank2]:2025-12-25 07:30:52,233 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.8807e-01
[rank3]:2025-12-25 07:30:52,248 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.1461e-01
[rank1]:2025-12-25 07:30:52,233 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.9151e-01
[rank0]:2025-12-25 07:30:52,248 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.2453e-01
[rank3]:2025-12-25 07:31:43,859 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5213e-01
[rank2]:2025-12-25 07:31:43,847 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.4562e-01
[rank1]:2025-12-25 07:31:43,853 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.8622e-02
[rank0]:2025-12-25 07:31:43,851 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5590e-01
[rank3]:2025-12-25 07:32:31,816 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.4509e-01
[rank2]:2025-12-25 07:32:31,801 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.4733e-01
[rank1]:2025-12-25 07:32:31,801 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.0844e-01
[rank0]:2025-12-25 07:32:31,817 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.0078e-01
[rank3]:2025-12-25 07:33:23,508 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8269e+00
[rank2]:2025-12-25 07:33:23,495 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.1958e+00
[rank1]:2025-12-25 07:33:23,501 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.9759e-01
[rank0]:2025-12-25 07:33:23,485 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 07:33:23,500 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.3765e+00
[rank3]:2025-12-25 07:33:28,174 - Avg. fwd time: 15.0086 / Avg. bwd time: 39.3168 / Avg. batch time: 1097.0396 (ms) / GPU bubble ratio: 20.77%
[rank2]:2025-12-25 07:33:28,214 - Avg. fwd time: 8.2304 / Avg. bwd time: 16.4440 / Avg. batch time: 1152.5095 (ms) / GPU bubble ratio: 65.75%
[rank3]:2025-12-25 07:33:28,292 -  step: 450  loss:  0.2343  grad_norm:  0.1847  memory: 29.23GiB(61.52%)  tps: 6,536  tflops: 51.10  mfu: 16.38%
[rank2]:2025-12-25 07:33:28,276 -  step: 450  loss: -4.0000  grad_norm:  0.1847  memory: 12.06GiB(25.39%)  tps: 6,536  tflops: 51.10  mfu: 16.38%
[rank1]:2025-12-25 07:33:28,240 - Avg. fwd time: 10.0002 / Avg. bwd time: 20.3909 / Avg. batch time: 1203.7898 (ms) / GPU bubble ratio: 59.61%
[rank1]:2025-12-25 07:33:28,276 -  step: 450  loss: -4.0000  grad_norm:  0.1847  memory: 18.49GiB(38.93%)  tps: 6,537  tflops: 51.10  mfu: 16.38%
[rank0]:2025-12-25 07:33:28,267 - Avg. fwd time: 8.6435 / Avg. bwd time: 17.3054 / Avg. batch time: 1237.4122 (ms) / GPU bubble ratio: 66.45%
[rank0]:2025-12-25 07:33:28,290 -  step: 450  loss: -4.0000  grad_norm:  0.1847  memory: 20.42GiB(42.99%)  tps: 6,536  tflops: 51.10  mfu: 16.38%
[rank3]:2025-12-25 07:34:11,327 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.3444e-01
[rank2]:2025-12-25 07:34:11,312 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.8537e-01
[rank1]:2025-12-25 07:34:11,312 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8173e-01
[rank0]:2025-12-25 07:34:11,327 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.8554e-01
[rank3]:2025-12-25 07:35:02,908 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.6233e-01
[rank2]:2025-12-25 07:35:02,897 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.0886e-01
[rank1]:2025-12-25 07:35:02,902 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.4590e-02
[rank0]:2025-12-25 07:35:02,900 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.5396e-01
[rank2]:2025-12-25 07:35:50,752 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.7579e-01
[rank3]:2025-12-25 07:35:50,768 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.0816e-01
[rank1]:2025-12-25 07:35:50,752 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.1744e-01
[rank0]:2025-12-25 07:35:50,768 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.7164e-01
[rank0]:2025-12-25 07:36:42,575 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.4939e-01
[rank1]:2025-12-25 07:36:42,575 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.2744e-01
[rank2]:2025-12-25 07:36:42,571 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.5558e-01
[rank3]:2025-12-25 07:36:42,582 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.2005e-01
[rank2]:2025-12-25 07:37:30,381 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0779e+00
[rank3]:2025-12-25 07:37:30,396 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.6747e-01
[rank0]:2025-12-25 07:37:30,377 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 07:37:30,396 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.8364e-01
[rank1]:2025-12-25 07:37:30,381 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.4440e-01
[rank3]:2025-12-25 07:37:35,422 - Avg. fwd time: 15.0154 / Avg. bwd time: 39.2220 / Avg. batch time: 1095.8258 (ms) / GPU bubble ratio: 20.81%
[rank2]:2025-12-25 07:37:35,466 - Avg. fwd time: 8.2384 / Avg. bwd time: 16.3399 / Avg. batch time: 1150.9560 (ms) / GPU bubble ratio: 65.83%
[rank0]:2025-12-25 07:37:35,534 - Avg. fwd time: 8.6627 / Avg. bwd time: 17.0277 / Avg. batch time: 1234.9749 (ms) / GPU bubble ratio: 66.72%
[rank1]:2025-12-25 07:37:35,507 - Avg. fwd time: 10.0115 / Avg. bwd time: 20.1942 / Avg. batch time: 1201.7241 (ms) / GPU bubble ratio: 59.78%
[rank1]:2025-12-25 07:37:35,557 -  step: 500  loss: -4.0000  grad_norm:  0.3055  memory: 18.49GiB(38.93%)  tps: 6,626  tflops: 51.80  mfu: 16.60%
[rank2]:2025-12-25 07:37:35,553 -  step: 500  loss: -4.0000  grad_norm:  0.3055  memory: 12.06GiB(25.39%)  tps: 6,626  tflops: 51.80  mfu: 16.60%
[rank2]:2025-12-25 07:37:35,615 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0737_stage2_step500.svg
[rank3]:2025-12-25 07:37:35,565 -  step: 500  loss:  0.2265  grad_norm:  0.3055  memory: 29.23GiB(61.52%)  tps: 6,626  tflops: 51.80  mfu: 16.60%
[rank0]:2025-12-25 07:37:35,558 -  step: 500  loss: -4.0000  grad_norm:  0.3055  memory: 20.42GiB(42.99%)  tps: 6,626  tflops: 51.80  mfu: 16.60%
[rank0]:2025-12-25 07:37:35,613 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0737_stage0_step500.svg
[rank1]:2025-12-25 07:37:35,615 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0737_stage1_step500.svg
[rank1]:2025-12-25 07:37:35,655 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0737_stage5_step500.svg
[rank2]:2025-12-25 07:37:35,655 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0737_stage6_step500.svg
[rank0]:2025-12-25 07:37:35,654 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0737_stage4_step500.svg
[rank3]:2025-12-25 07:37:35,811 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0737_step500_rank3.svg
[rank3]:			> Batch Time: 1175.48 ms, GPU Bubble Ratio: 68.07%, 66.36%, 71.37%, 30.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-99ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-8-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-197ms    | [S0,MB6,F]  197-9-207ms    | [S4,MB0,B]  383-14-397ms   | [S0,MB7,F]  397-8-405ms    | [S4,MB1,B]  506-14-521ms   | [S4,MB4,F]  571-8-579ms    | [S4,MB2,B]  580-15-595ms   | [S4,MB5,F]  602-8-610ms    | [S4,MB3,B]  611-15-626ms   | [S4,MB6,F]  633-9-642ms    | [S0,MB0,B]  642-16-658ms   | [S4,MB7,F]  663-8-671ms    | [S0,MB1,B]  672-15-688ms   | [S0,MB2,B]  692-14-706ms   | [S0,MB3,B]  762-14-776ms   | [S4,MB4,B]  790-13-803ms   | [S4,MB5,B]  888-13-901ms   | [S4,MB6,B]  982-13-996ms   | [S4,MB7,B]  1068-13-1081ms | [S0,MB4,B]  1091-14-1105ms | [S0,MB5,B]  1120-14-1134ms | [S0,MB6,B]  1141-14-1155ms | [S0,MB7,B]  1161-14-1175ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  90-11-102ms    | [S1,MB3,F]  130-11-142ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  186-7-193ms    | [S5,MB2,F]  200-7-207ms    | [S5,MB3,F]  284-7-291ms    | [S1,MB4,F]  310-11-322ms   | [S5,MB0,B]  322-14-336ms   | [S1,MB5,F]  375-14-389ms   | [S5,MB1,B]  390-14-404ms   | [S1,MB6,F]  405-12-417ms   | [S5,MB2,B]  506-14-520ms   | [S1,MB7,F]  521-12-533ms   | [S5,MB3,B]  579-15-594ms   | [S5,MB4,F]  595-7-602ms    | [S1,MB0,B]  610-15-625ms   | [S5,MB5,F]  627-8-635ms    | [S1,MB1,B]  641-15-657ms   | [S5,MB6,F]  658-9-667ms    | [S1,MB2,B]  669-15-684ms   | [S5,MB7,F]  684-9-694ms    | [S1,MB3,B]  694-14-709ms   | [S5,MB4,B]  769-13-783ms   | [S5,MB5,B]  860-13-873ms   | [S5,MB6,B]  953-13-966ms   | [S5,MB7,B]  1047-13-1061ms | [S1,MB4,B]  1067-13-1081ms | [S1,MB5,B]  1099-13-1113ms | [S1,MB6,B]  1120-13-1134ms | [S1,MB7,B]  1140-13-1154ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  61-8-69ms      | [S2,MB2,F]  102-8-110ms    | [S2,MB3,F]  142-8-150ms    | [S6,MB0,F]  179-8-187ms    | [S6,MB1,F]  193-7-201ms    | [S6,MB2,F]  278-7-285ms    | [S6,MB0,B]  285-14-300ms   | [S6,MB3,F]  300-9-309ms    | [S6,MB1,B]  363-17-380ms   | [S2,MB4,F]  382-9-391ms    | [S6,MB2,B]  457-15-472ms   | [S2,MB5,F]  473-8-481ms    | [S6,MB3,B]  551-15-566ms   | [S2,MB6,F]  567-9-576ms    | [S2,MB0,B]  582-10-592ms   | [S2,MB7,F]  594-8-603ms    | [S2,MB1,B]  613-10-623ms   | [S6,MB4,F]  625-8-633ms    | [S2,MB2,B]  643-10-654ms   | [S6,MB5,F]  655-8-663ms    | [S2,MB3,B]  670-10-680ms   | [S6,MB6,F]  680-9-689ms    | [S6,MB4,B]  746-16-762ms   | [S6,MB7,F]  763-9-772ms    | [S6,MB5,B]  839-14-853ms   | [S6,MB6,B]  933-13-946ms   | [S6,MB7,B]  1027-13-1041ms | [S2,MB4,B]  1047-9-1056ms  | [S2,MB5,B]  1084-9-1093ms  | [S2,MB6,B]  1099-9-1108ms  | [S2,MB7,B]  1119-9-1128ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  150-7-158ms    | [S7,MB0,F]  187-15-203ms   | [S7,MB0,B]  215-53-269ms   | [S7,MB1,F]  268-19-288ms   | [S7,MB1,B]  300-57-357ms   | [S7,MB2,F]  357-21-379ms   | [S7,MB2,B]  391-60-451ms   | [S7,MB3,F]  450-21-472ms   | [S7,MB3,B]  484-60-545ms   | [S3,MB4,F]  545-12-558ms   | [S3,MB0,B]  558-13-571ms   | [S3,MB5,F]  573-11-585ms   | [S3,MB1,B]  585-13-598ms   | [S3,MB6,F]  601-11-612ms   | [S3,MB2,B]  612-13-625ms   | [S3,MB7,F]  625-11-636ms   | [S3,MB3,B]  636-12-649ms   | [S7,MB4,F]  651-19-670ms   | [S7,MB4,B]  682-57-739ms   | [S7,MB5,F]  740-21-762ms   | [S7,MB5,B]  774-59-833ms   | [S7,MB6,F]  833-21-854ms   | [S7,MB6,B]  866-60-926ms   | [S7,MB7,F]  926-21-948ms   | [S7,MB7,B]  960-60-1020ms  | [S3,MB4,B]  1021-14-1035ms | [S3,MB5,B]  1035-13-1049ms | [S3,MB6,B]  1049-12-1061ms | [S3,MB7,B]  1075-12-1087ms
[rank3]:2025-12-25 07:37:35,853 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0737_stage3_step500.svg
[rank3]:2025-12-25 07:37:35,894 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0737_stage7_step500.svg
[rank1]:2025-12-25 07:38:22,324 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.8477e-01
[rank2]:2025-12-25 07:38:22,319 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.3747e-01
[rank0]:2025-12-25 07:38:22,323 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3833e+00
[rank3]:2025-12-25 07:38:22,331 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.3266e-01
[rank1]:2025-12-25 07:39:10,185 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9471e+00
[rank0]:2025-12-25 07:39:10,200 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1439e+00
[rank2]:2025-12-25 07:39:10,185 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.0294e+00
[rank3]:2025-12-25 07:39:10,200 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0205e+00
[rank1]:2025-12-25 07:40:01,944 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.9813e-01
[rank2]:2025-12-25 07:40:01,939 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.2536e-01
[rank0]:2025-12-25 07:40:01,943 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.9980e-01
[rank3]:2025-12-25 07:40:01,951 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.9844e-01
[rank1]:2025-12-25 07:40:49,711 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.5188e-01
[rank2]:2025-12-25 07:40:49,711 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.7107e-01
[rank0]:2025-12-25 07:40:49,727 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.3077e-01
[rank3]:2025-12-25 07:40:49,727 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.9708e-01
[rank0]:2025-12-25 07:41:41,353 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 07:41:41,376 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.3125e-01
[rank1]:2025-12-25 07:41:41,370 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.8964e-01
[rank2]:2025-12-25 07:41:41,364 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.0954e-01
[rank0]:2025-12-25 07:41:41,368 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.4401e-01
[rank2]:2025-12-25 07:41:46,125 - Avg. fwd time: 8.2389 / Avg. bwd time: 16.3547 / Avg. batch time: 1150.8513 (ms) / GPU bubble ratio: 65.81%
[rank3]:2025-12-25 07:41:46,086 - Avg. fwd time: 15.0147 / Avg. bwd time: 39.2323 / Avg. batch time: 1095.8107 (ms) / GPU bubble ratio: 20.79%
[rank1]:2025-12-25 07:41:46,152 - Avg. fwd time: 10.0135 / Avg. bwd time: 20.1746 / Avg. batch time: 1201.5157 (ms) / GPU bubble ratio: 59.80%
[rank1]:2025-12-25 07:41:46,189 -  step: 550  loss: -4.0000  grad_norm:  0.6384  memory: 18.49GiB(38.93%)  tps: 6,537  tflops: 51.10  mfu: 16.38%
[rank2]:2025-12-25 07:41:46,189 -  step: 550  loss: -4.0000  grad_norm:  0.6384  memory: 12.06GiB(25.39%)  tps: 6,537  tflops: 51.10  mfu: 16.38%
[rank0]:2025-12-25 07:41:46,180 - Avg. fwd time: 8.6794 / Avg. bwd time: 16.7988 / Avg. batch time: 1234.4581 (ms) / GPU bubble ratio: 66.98%
[rank0]:2025-12-25 07:41:46,203 -  step: 550  loss: -4.0000  grad_norm:  0.6384  memory: 20.42GiB(42.99%)  tps: 6,537  tflops: 51.10  mfu: 16.38%
[rank3]:2025-12-25 07:41:46,204 -  step: 550  loss:  0.2320  grad_norm:  0.6384  memory: 29.23GiB(61.52%)  tps: 6,537  tflops: 51.10  mfu: 16.38%
[rank2]:2025-12-25 07:42:29,300 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.8210e+00
[rank0]:2025-12-25 07:42:29,316 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.8835e+00
[rank3]:2025-12-25 07:42:29,315 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.7048e+00
[rank1]:2025-12-25 07:42:29,300 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.4074e+00
[rank1]:2025-12-25 07:43:21,112 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.1849e-01
[rank2]:2025-12-25 07:43:21,107 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.2286e-01
[rank0]:2025-12-25 07:43:21,111 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.9076e+00
[rank3]:2025-12-25 07:43:21,118 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.0885e-01
[rank2]:2025-12-25 07:44:08,898 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.6978e+00
[rank0]:2025-12-25 07:44:08,913 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.2166e+00
[rank3]:2025-12-25 07:44:08,913 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.5319e-01
[rank1]:2025-12-25 07:44:08,898 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2406e+00
[rank2]:2025-12-25 07:45:00,579 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.3183e-01
[rank3]:2025-12-25 07:45:00,590 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.4460e-01
[rank0]:2025-12-25 07:45:00,583 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.9425e-01
[rank1]:2025-12-25 07:45:00,585 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.2222e-01
[rank2]:2025-12-25 07:45:48,466 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.9980e-01
[rank0]:2025-12-25 07:45:48,463 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 07:45:48,482 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.3203e-01
[rank1]:2025-12-25 07:45:48,466 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.1418e-01
[rank3]:2025-12-25 07:45:48,482 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.9236e-01
[rank2]:2025-12-25 07:45:53,643 - Avg. fwd time: 8.2457 / Avg. bwd time: 16.2756 / Avg. batch time: 1149.7608 (ms) / GPU bubble ratio: 65.88%
[rank3]:2025-12-25 07:45:53,600 - Avg. fwd time: 15.0199 / Avg. bwd time: 39.1627 / Avg. batch time: 1094.9529 (ms) / GPU bubble ratio: 20.83%
[rank1]:2025-12-25 07:45:53,690 - Avg. fwd time: 10.0226 / Avg. bwd time: 20.0303 / Avg. batch time: 1200.0710 (ms) / GPU bubble ratio: 59.93%
[rank2]:2025-12-25 07:45:53,737 -  step: 600  loss: -4.0000  grad_norm:  0.8232  memory: 12.06GiB(25.39%)  tps: 6,619  tflops: 51.74  mfu: 16.58%
[rank3]:2025-12-25 07:45:53,748 -  step: 600  loss:  0.2301  grad_norm:  0.8232  memory: 29.23GiB(61.52%)  tps: 6,619  tflops: 51.74  mfu: 16.58%
[rank0]:2025-12-25 07:45:53,718 - Avg. fwd time: 8.6931 / Avg. bwd time: 16.6094 / Avg. batch time: 1232.7589 (ms) / GPU bubble ratio: 67.16%
[rank0]:2025-12-25 07:45:53,741 -  step: 600  loss: -4.0000  grad_norm:  0.8232  memory: 20.42GiB(42.99%)  tps: 6,619  tflops: 51.74  mfu: 16.58%
[rank1]:2025-12-25 07:45:53,740 -  step: 600  loss: -4.0000  grad_norm:  0.8232  memory: 18.49GiB(38.93%)  tps: 6,618  tflops: 51.74  mfu: 16.58%
[rank1]:2025-12-25 07:45:53,799 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0745_stage1_step600.svg
[rank2]:2025-12-25 07:45:53,799 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0745_stage2_step600.svg
[rank2]:2025-12-25 07:45:53,840 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0745_stage6_step600.svg
[rank0]:2025-12-25 07:45:53,798 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0745_stage0_step600.svg
[rank0]:2025-12-25 07:45:53,839 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0745_stage4_step600.svg
[rank1]:2025-12-25 07:45:53,841 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0745_stage5_step600.svg
[rank3]:2025-12-25 07:45:53,993 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0745_step600_rank3.svg
[rank3]:			> Batch Time: 1178.48 ms, GPU Bubble Ratio: 68.14%, 66.41%, 71.40%, 30.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-99ms      | [S4,MB2,F]  131-8-139ms    | [S4,MB3,F]  171-8-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-198ms    | [S0,MB6,F]  198-9-207ms    | [S4,MB0,B]  385-14-399ms   | [S0,MB7,F]  399-8-407ms    | [S4,MB1,B]  508-14-522ms   | [S4,MB4,F]  573-8-581ms    | [S4,MB2,B]  582-15-597ms   | [S4,MB5,F]  603-9-612ms    | [S4,MB3,B]  612-15-627ms   | [S4,MB6,F]  635-9-644ms    | [S0,MB0,B]  644-16-660ms   | [S4,MB7,F]  666-8-674ms    | [S0,MB1,B]  674-15-690ms   | [S0,MB2,B]  695-14-709ms   | [S0,MB3,B]  764-14-779ms   | [S4,MB4,B]  792-13-806ms   | [S4,MB5,B]  892-13-905ms   | [S4,MB6,B]  986-13-999ms   | [S4,MB7,B]  1072-13-1085ms | [S0,MB4,B]  1094-14-1108ms | [S0,MB5,B]  1124-14-1138ms | [S0,MB6,B]  1144-14-1158ms | [S0,MB7,B]  1164-14-1178ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  90-12-102ms    | [S1,MB3,F]  131-11-143ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  186-7-194ms    | [S5,MB2,F]  200-7-208ms    | [S5,MB3,F]  284-7-292ms    | [S1,MB4,F]  310-11-322ms   | [S5,MB0,B]  322-14-337ms   | [S1,MB5,F]  377-14-391ms   | [S5,MB1,B]  391-14-405ms   | [S1,MB6,F]  406-12-419ms   | [S5,MB2,B]  507-14-521ms   | [S1,MB7,F]  522-12-535ms   | [S5,MB3,B]  580-15-596ms   | [S5,MB4,F]  596-8-604ms    | [S1,MB0,B]  611-15-627ms   | [S5,MB5,F]  630-8-638ms    | [S1,MB1,B]  643-15-659ms   | [S5,MB6,F]  660-9-670ms    | [S1,MB2,B]  670-15-686ms   | [S5,MB7,F]  686-10-696ms   | [S1,MB3,B]  696-14-711ms   | [S5,MB4,B]  771-13-785ms   | [S5,MB5,B]  863-13-877ms   | [S5,MB6,B]  956-13-970ms   | [S5,MB7,B]  1051-13-1065ms | [S1,MB4,B]  1071-13-1085ms | [S1,MB5,B]  1103-13-1117ms | [S1,MB6,B]  1123-13-1137ms | [S1,MB7,B]  1143-13-1157ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  61-8-69ms      | [S2,MB2,F]  102-8-110ms    | [S2,MB3,F]  143-8-151ms    | [S6,MB0,F]  179-8-188ms    | [S6,MB1,F]  194-7-201ms    | [S6,MB2,F]  278-7-286ms    | [S6,MB0,B]  286-14-301ms   | [S6,MB3,F]  301-9-310ms    | [S6,MB1,B]  365-17-382ms   | [S2,MB4,F]  383-9-392ms    | [S6,MB2,B]  458-15-473ms   | [S2,MB5,F]  474-8-483ms    | [S6,MB3,B]  553-15-568ms   | [S2,MB6,F]  568-9-577ms    | [S2,MB0,B]  583-10-593ms   | [S2,MB7,F]  597-8-605ms    | [S2,MB1,B]  614-10-625ms   | [S6,MB4,F]  627-8-635ms    | [S2,MB2,B]  646-10-656ms   | [S6,MB5,F]  657-8-666ms    | [S2,MB3,B]  672-10-682ms   | [S6,MB6,F]  683-9-692ms    | [S6,MB4,B]  748-16-765ms   | [S6,MB7,F]  765-9-774ms    | [S6,MB5,B]  842-14-856ms   | [S6,MB6,B]  937-13-950ms   | [S6,MB7,B]  1031-13-1044ms | [S2,MB4,B]  1051-9-1060ms  | [S2,MB5,B]  1087-9-1096ms  | [S2,MB6,B]  1102-9-1111ms  | [S2,MB7,B]  1123-9-1132ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  151-7-159ms    | [S7,MB0,F]  188-15-204ms   | [S7,MB0,B]  215-53-269ms   | [S7,MB1,F]  269-19-289ms   | [S7,MB1,B]  301-57-359ms   | [S7,MB2,F]  358-22-380ms   | [S7,MB2,B]  392-60-452ms   | [S7,MB3,F]  452-21-474ms   | [S7,MB3,B]  486-60-546ms   | [S3,MB4,F]  546-12-559ms   | [S3,MB0,B]  559-13-573ms   | [S3,MB5,F]  574-11-586ms   | [S3,MB1,B]  585-13-599ms   | [S3,MB6,F]  603-11-615ms   | [S3,MB2,B]  615-13-628ms   | [S3,MB7,F]  628-11-639ms   | [S3,MB3,B]  639-12-652ms   | [S7,MB4,F]  653-19-672ms   | [S7,MB4,B]  685-56-741ms   | [S7,MB5,F]  742-21-764ms   | [S7,MB5,B]  776-59-835ms   | [S7,MB6,F]  836-21-858ms   | [S7,MB6,B]  870-60-930ms   | [S7,MB7,F]  930-21-952ms   | [S7,MB7,B]  964-60-1024ms  | [S3,MB4,B]  1024-14-1039ms | [S3,MB5,B]  1039-13-1053ms | [S3,MB6,B]  1052-12-1065ms | [S3,MB7,B]  1078-12-1090ms
[rank3]:2025-12-25 07:45:54,038 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0745_stage3_step600.svg
[rank3]:2025-12-25 07:45:54,081 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0745_stage7_step600.svg
[rank2]:2025-12-25 07:46:40,682 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.2158e-01
[rank0]:2025-12-25 07:46:40,686 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.6366e-01
[rank3]:2025-12-25 07:46:40,694 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.2371e-01
[rank1]:2025-12-25 07:46:40,687 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1908e-01
[rank0]:2025-12-25 07:47:28,474 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5558e+00
[rank2]:2025-12-25 07:47:28,458 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.2048e+00
[rank3]:2025-12-25 07:47:28,473 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.2235e+00
[rank1]:2025-12-25 07:47:28,458 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.1038e+00
[rank3]:2025-12-25 07:48:20,164 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.4391e-01
[rank0]:2025-12-25 07:48:20,157 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.7195e-01
[rank2]:2025-12-25 07:48:20,153 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0034e-01
[rank1]:2025-12-25 07:48:20,158 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.3686e-02
[rank3]:2025-12-25 07:49:08,122 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4111e-01
[rank0]:2025-12-25 07:49:08,122 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.8863e-01
[rank2]:2025-12-25 07:49:08,107 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.6894e-01
[rank1]:2025-12-25 07:49:08,107 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.8005e-01
[rank0]:2025-12-25 07:49:59,905 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 07:49:59,915 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.7731e-01
[rank1]:2025-12-25 07:49:59,921 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.8003e-01
[rank3]:2025-12-25 07:49:59,928 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.6079e-01
[rank0]:2025-12-25 07:49:59,920 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.2191e-01
[rank3]:2025-12-25 07:50:04,607 - Avg. fwd time: 15.0213 / Avg. bwd time: 39.1808 / Avg. batch time: 1095.1269 (ms) / GPU bubble ratio: 20.81%
[rank0]:2025-12-25 07:50:04,702 - Avg. fwd time: 8.7048 / Avg. bwd time: 16.4475 / Avg. batch time: 1232.6225 (ms) / GPU bubble ratio: 67.35%
[rank2]:2025-12-25 07:50:04,645 - Avg. fwd time: 8.2457 / Avg. bwd time: 16.2930 / Avg. batch time: 1149.8857 (ms) / GPU bubble ratio: 65.86%
[rank2]:2025-12-25 07:50:04,712 -  step: 650  loss: -4.0000  grad_norm:  0.1134  memory: 12.06GiB(25.39%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank1]:2025-12-25 07:50:04,674 - Avg. fwd time: 10.0239 / Avg. bwd time: 20.0277 / Avg. batch time: 1200.1525 (ms) / GPU bubble ratio: 59.94%
[rank1]:2025-12-25 07:50:04,711 -  step: 650  loss: -4.0000  grad_norm:  0.1134  memory: 18.49GiB(38.93%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank0]:2025-12-25 07:50:04,726 -  step: 650  loss: -4.0000  grad_norm:  0.1134  memory: 20.42GiB(42.99%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank3]:2025-12-25 07:50:04,727 -  step: 650  loss:  0.2345  grad_norm:  0.1134  memory: 29.23GiB(61.52%)  tps: 6,528  tflops: 51.03  mfu: 16.36%
[rank2]:2025-12-25 07:50:47,776 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0932e+00
[rank1]:2025-12-25 07:50:47,776 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.9845e-01
[rank3]:2025-12-25 07:50:47,791 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.1902e+00
[rank0]:2025-12-25 07:50:47,792 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.4666e-01
[rank0]:2025-12-25 07:51:39,428 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.2671e-01
[rank3]:2025-12-25 07:51:39,436 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.7212e-01
[rank2]:2025-12-25 07:51:39,424 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6993e-01
[rank1]:2025-12-25 07:51:39,430 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.6130e-02
[rank3]:2025-12-25 07:52:27,370 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 8.2271e-01
[rank0]:2025-12-25 07:52:27,370 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.8114e-01
[rank2]:2025-12-25 07:52:27,354 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0141e+00
[rank1]:2025-12-25 07:52:27,355 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0897e+00
[rank2]:2025-12-25 07:53:19,151 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.4177e-02
[rank0]:2025-12-25 07:53:19,155 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.0773e-01
[rank3]:2025-12-25 07:53:19,163 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6976e-01
[rank1]:2025-12-25 07:53:19,157 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.3679e-02
[rank0]:2025-12-25 07:54:06,888 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 07:54:06,907 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.1483e+00
[rank2]:2025-12-25 07:54:06,892 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5639e+00
[rank3]:2025-12-25 07:54:06,907 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.8015e+00
[rank1]:2025-12-25 07:54:06,892 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8825e+00
[rank3]:2025-12-25 07:54:11,929 - Avg. fwd time: 15.0251 / Avg. bwd time: 39.1234 / Avg. batch time: 1094.4026 (ms) / GPU bubble ratio: 20.84%
[rank2]:2025-12-25 07:54:11,973 - Avg. fwd time: 8.2506 / Avg. bwd time: 16.2291 / Avg. batch time: 1148.9896 (ms) / GPU bubble ratio: 65.91%
[rank1]:2025-12-25 07:54:12,019 - Avg. fwd time: 10.0306 / Avg. bwd time: 19.9137 / Avg. batch time: 1198.9737 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-12-25 07:54:12,048 - Avg. fwd time: 8.7145 / Avg. bwd time: 16.3102 / Avg. batch time: 1231.2586 (ms) / GPU bubble ratio: 67.48%
[rank0]:2025-12-25 07:54:12,071 -  step: 700  loss: -4.0000  grad_norm:  0.6181  memory: 20.42GiB(42.99%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank0]:2025-12-25 07:54:12,133 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0754_stage0_step700.svg
[rank2]:2025-12-25 07:54:12,067 -  step: 700  loss: -4.0000  grad_norm:  0.6181  memory: 12.06GiB(25.39%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank2]:2025-12-25 07:54:12,132 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0754_stage2_step700.svg
[rank3]:2025-12-25 07:54:12,079 -  step: 700  loss:  0.1988  grad_norm:  0.6181  memory: 29.23GiB(61.52%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank1]:2025-12-25 07:54:12,070 -  step: 700  loss: -4.0000  grad_norm:  0.6181  memory: 18.49GiB(38.93%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank1]:2025-12-25 07:54:12,132 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0754_stage1_step700.svg
[rank0]:2025-12-25 07:54:12,178 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0754_stage4_step700.svg
[rank2]:2025-12-25 07:54:12,176 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0754_stage6_step700.svg
[rank1]:2025-12-25 07:54:12,176 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0754_stage5_step700.svg
[rank3]:2025-12-25 07:54:12,349 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0754_step700_rank3.svg
[rank3]:			> Batch Time: 1174.48 ms, GPU Bubble Ratio: 68.03%, 66.33%, 71.33%, 30.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-8-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-197ms    | [S0,MB6,F]  197-9-207ms    | [S4,MB0,B]  382-14-397ms   | [S0,MB7,F]  397-8-405ms    | [S4,MB1,B]  506-14-521ms   | [S4,MB4,F]  571-8-579ms    | [S4,MB2,B]  580-15-595ms   | [S4,MB5,F]  601-9-610ms    | [S4,MB3,B]  609-15-624ms   | [S4,MB6,F]  633-9-642ms    | [S0,MB0,B]  643-16-659ms   | [S4,MB7,F]  663-8-671ms    | [S0,MB1,B]  671-16-687ms   | [S0,MB2,B]  691-14-706ms   | [S0,MB3,B]  761-14-776ms   | [S4,MB4,B]  789-13-803ms   | [S4,MB5,B]  887-13-901ms   | [S4,MB6,B]  981-13-994ms   | [S4,MB7,B]  1067-13-1080ms | [S0,MB4,B]  1089-14-1103ms | [S0,MB5,B]  1119-14-1133ms | [S0,MB6,B]  1140-14-1154ms | [S0,MB7,B]  1160-14-1174ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  90-12-102ms    | [S1,MB3,F]  130-11-142ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  185-7-193ms    | [S5,MB2,F]  200-7-207ms    | [S5,MB3,F]  283-7-291ms    | [S1,MB4,F]  310-11-322ms   | [S5,MB0,B]  321-14-336ms   | [S1,MB5,F]  374-14-389ms   | [S5,MB1,B]  389-14-404ms   | [S1,MB6,F]  404-12-417ms   | [S5,MB2,B]  506-14-520ms   | [S1,MB7,F]  520-12-532ms   | [S5,MB3,B]  578-15-594ms   | [S5,MB4,F]  593-7-601ms    | [S1,MB0,B]  608-15-624ms   | [S5,MB5,F]  627-8-635ms    | [S1,MB1,B]  641-15-657ms   | [S5,MB6,F]  657-9-667ms    | [S1,MB2,B]  667-15-683ms   | [S5,MB7,F]  683-9-693ms    | [S1,MB3,B]  693-14-708ms   | [S5,MB4,B]  768-13-782ms   | [S5,MB5,B]  858-13-872ms   | [S5,MB6,B]  951-13-965ms   | [S5,MB7,B]  1046-13-1060ms | [S1,MB4,B]  1066-13-1080ms | [S1,MB5,B]  1098-13-1112ms | [S1,MB6,B]  1119-13-1133ms | [S1,MB7,B]  1139-13-1153ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  61-8-69ms      | [S2,MB2,F]  102-8-110ms    | [S2,MB3,F]  142-8-150ms    | [S6,MB0,F]  179-8-187ms    | [S6,MB1,F]  193-7-201ms    | [S6,MB2,F]  277-7-285ms    | [S6,MB0,B]  285-14-300ms   | [S6,MB3,F]  300-9-309ms    | [S6,MB1,B]  362-17-380ms   | [S2,MB4,F]  381-9-390ms    | [S6,MB2,B]  456-15-471ms   | [S2,MB5,F]  472-8-480ms    | [S6,MB3,B]  550-15-566ms   | [S2,MB6,F]  565-9-575ms    | [S2,MB0,B]  580-10-591ms   | [S2,MB7,F]  594-8-603ms    | [S2,MB1,B]  612-10-623ms   | [S6,MB4,F]  624-8-632ms    | [S2,MB2,B]  643-10-654ms   | [S6,MB5,F]  654-8-663ms    | [S2,MB3,B]  669-10-679ms   | [S6,MB6,F]  679-9-688ms    | [S6,MB4,B]  745-16-762ms   | [S6,MB7,F]  761-9-771ms    | [S6,MB5,B]  838-14-852ms   | [S6,MB6,B]  931-13-945ms   | [S6,MB7,B]  1026-13-1040ms | [S2,MB4,B]  1046-9-1055ms  | [S2,MB5,B]  1082-9-1091ms  | [S2,MB6,B]  1098-9-1107ms  | [S2,MB7,B]  1118-9-1127ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  150-7-158ms    | [S7,MB0,F]  187-15-203ms   | [S7,MB0,B]  215-53-268ms   | [S7,MB1,F]  268-19-288ms   | [S7,MB1,B]  299-57-357ms   | [S7,MB2,F]  356-21-378ms   | [S7,MB2,B]  390-59-450ms   | [S7,MB3,F]  450-21-472ms   | [S7,MB3,B]  484-60-544ms   | [S3,MB4,F]  544-12-557ms   | [S3,MB0,B]  557-13-571ms   | [S3,MB5,F]  573-11-584ms   | [S3,MB1,B]  584-13-597ms   | [S3,MB6,F]  600-11-611ms   | [S3,MB2,B]  611-13-624ms   | [S3,MB7,F]  625-11-636ms   | [S3,MB3,B]  636-12-649ms   | [S7,MB4,F]  650-19-669ms   | [S7,MB4,B]  681-57-738ms   | [S7,MB5,F]  739-21-761ms   | [S7,MB5,B]  773-59-832ms   | [S7,MB6,F]  832-21-854ms   | [S7,MB6,B]  865-59-925ms   | [S7,MB7,F]  925-21-946ms   | [S7,MB7,B]  959-59-1018ms  | [S3,MB4,B]  1020-14-1034ms | [S3,MB5,B]  1034-13-1048ms | [S3,MB6,B]  1048-12-1060ms | [S3,MB7,B]  1074-12-1086ms
[rank3]:2025-12-25 07:54:12,399 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0754_stage3_step700.svg
[rank3]:2025-12-25 07:54:12,446 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0754_stage7_step700.svg
[rank2]:2025-12-25 07:54:58,833 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.4221e-01
[rank0]:2025-12-25 07:54:58,837 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.1189e-01
[rank3]:2025-12-25 07:54:58,847 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.1229e-01
[rank1]:2025-12-25 07:54:58,839 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.3136e-02
[rank2]:2025-12-25 07:55:46,741 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.2366e-01
[rank0]:2025-12-25 07:55:46,756 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.2112e-01
[rank3]:2025-12-25 07:55:46,756 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1262e-01
[rank1]:2025-12-25 07:55:46,741 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.9018e-01
[rank2]:2025-12-25 07:56:38,508 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.8796e-01
[rank0]:2025-12-25 07:56:38,512 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.3849e-01
[rank1]:2025-12-25 07:56:38,514 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.6214e-01
[rank3]:2025-12-25 07:56:38,519 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9433e-01
[rank2]:2025-12-25 07:57:26,302 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 8.0038e-01
[rank0]:2025-12-25 07:57:26,318 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.6059e-01
[rank1]:2025-12-25 07:57:26,303 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.6679e-01
[rank3]:2025-12-25 07:57:26,318 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 7.2170e-01
[rank0]:2025-12-25 07:58:17,940 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 07:58:17,955 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.3018e-01
[rank1]:2025-12-25 07:58:17,956 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.6747e-01
[rank3]:2025-12-25 07:58:17,963 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.2840e-01
[rank2]:2025-12-25 07:58:17,951 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.6984e-01
[rank2]:2025-12-25 07:58:22,728 - Avg. fwd time: 8.2500 / Avg. bwd time: 16.2467 / Avg. batch time: 1149.0569 (ms) / GPU bubble ratio: 65.89%
[rank1]:2025-12-25 07:58:22,758 - Avg. fwd time: 10.0311 / Avg. bwd time: 19.9180 / Avg. batch time: 1199.0178 (ms) / GPU bubble ratio: 60.04%
[rank3]:2025-12-25 07:58:22,690 - Avg. fwd time: 15.0240 / Avg. bwd time: 39.1374 / Avg. batch time: 1094.4826 (ms) / GPU bubble ratio: 20.82%
[rank2]:2025-12-25 07:58:22,797 -  step: 750  loss: -4.0000  grad_norm:  0.5174  memory: 12.06GiB(25.39%)  tps: 6,535  tflops: 51.08  mfu: 16.37%
[rank0]:2025-12-25 07:58:22,788 - Avg. fwd time: 8.7232 / Avg. bwd time: 16.1895 / Avg. batch time: 1231.1449 (ms) / GPU bubble ratio: 67.62%
[rank0]:2025-12-25 07:58:22,811 -  step: 750  loss: -4.0000  grad_norm:  0.5174  memory: 20.42GiB(42.99%)  tps: 6,534  tflops: 51.08  mfu: 16.37%
[rank1]:2025-12-25 07:58:22,797 -  step: 750  loss: -4.0000  grad_norm:  0.5174  memory: 18.49GiB(38.93%)  tps: 6,535  tflops: 51.08  mfu: 16.37%
[rank3]:2025-12-25 07:58:22,812 -  step: 750  loss:  0.2428  grad_norm:  0.5174  memory: 29.23GiB(61.52%)  tps: 6,534  tflops: 51.08  mfu: 16.37%
[rank2]:2025-12-25 07:59:05,861 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.4284e+00
[rank0]:2025-12-25 07:59:05,877 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5057e+00
[rank1]:2025-12-25 07:59:05,861 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2629e+00
[rank3]:2025-12-25 07:59:05,877 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.3902e+00
[rank2]:2025-12-25 07:59:57,619 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.2987e-01
[rank1]:2025-12-25 07:59:57,624 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.6049e-01
[rank0]:2025-12-25 07:59:57,623 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5301e+00
[rank3]:2025-12-25 07:59:57,630 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.5650e-01
[rank1]:2025-12-25 08:00:45,407 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3772e+00
[rank0]:2025-12-25 08:00:45,423 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.3505e+00
[rank2]:2025-12-25 08:00:45,407 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.4068e+00
[rank3]:2025-12-25 08:00:45,422 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.6177e+00
[rank1]:2025-12-25 08:01:37,069 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.0025e-02
[rank0]:2025-12-25 08:01:37,069 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.4935e-01
[rank2]:2025-12-25 08:01:37,064 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0092e-01
[rank3]:2025-12-25 08:01:37,076 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9287e-01
[rank1]:2025-12-25 08:02:24,921 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9949e-01
[rank0]:2025-12-25 08:02:24,917 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-25 08:02:24,936 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2421e-01
[rank2]:2025-12-25 08:02:24,921 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.6368e-01
[rank3]:2025-12-25 08:02:24,936 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 7.2243e-01
[rank3]:2025-12-25 08:02:30,080 - Avg. fwd time: 15.0269 / Avg. bwd time: 39.0900 / Avg. batch time: 1093.8887 (ms) / GPU bubble ratio: 20.84%
[rank2]:2025-12-25 08:02:30,125 - Avg. fwd time: 8.2545 / Avg. bwd time: 16.1939 / Avg. batch time: 1148.3244 (ms) / GPU bubble ratio: 65.94%
[rank1]:2025-12-25 08:02:30,170 - Avg. fwd time: 10.0375 / Avg. bwd time: 19.8256 / Avg. batch time: 1198.0582 (ms) / GPU bubble ratio: 60.12%
[rank1]:2025-12-25 08:02:30,223 -  step: 800  loss: -4.0000  grad_norm:  1.0734  memory: 18.49GiB(38.93%)  tps: 6,622  tflops: 51.77  mfu: 16.59%
[rank1]:2025-12-25 08:02:30,223 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0734  tps: 6,928  tflops: 54.16  mfu: 15.86%
[rank1]:2025-12-25 08:02:30,223 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-25 08:02:30,224 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 08:02:30,200 - Avg. fwd time: 8.7310 / Avg. bwd time: 16.0853 / Avg. batch time: 1230.0475 (ms) / GPU bubble ratio: 67.72%
[rank0]:2025-12-25 08:02:30,224 -  step: 800  loss: -4.0000  grad_norm:  1.0734  memory: 20.42GiB(42.99%)  tps: 6,622  tflops: 51.77  mfu: 16.59%
[rank0]:2025-12-25 08:02:30,224 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0734  tps: 6,928  tflops: 54.16  mfu: 15.87%
[rank0]:2025-12-25 08:02:30,224 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-25 08:02:30,225 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-25 08:02:30,219 -  step: 800  loss: -4.0000  grad_norm:  1.0734  memory: 12.06GiB(25.39%)  tps: 6,622  tflops: 51.77  mfu: 16.59%
[rank2]:2025-12-25 08:02:30,219 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.0734  tps: 6,928  tflops: 54.16  mfu: 15.86%
[rank2]:2025-12-25 08:02:30,219 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-25 08:02:30,220 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-25 08:02:30,231 -  step: 800  loss:  0.2469  grad_norm:  1.0734  memory: 29.23GiB(61.52%)  tps: 6,622  tflops: 51.77  mfu: 16.59%
[rank3]:2025-12-25 08:02:30,232 - â„¹ï¸ final step: 800  loss:  0.2469  grad_norm:  1.0734  tps: 6,932  tflops: 54.19  mfu: 15.98%
[rank3]:2025-12-25 08:02:30,232 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-25 08:02:30,233 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 08:02:32,154 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-25 08:02:32,224 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0802_stage1_final800.svg
[rank0]:2025-12-25 08:02:32,223 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0802_stage0_final800.svg
[rank0]:2025-12-25 08:02:32,268 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251225_0802_stage4_final800.svg
[rank2]:2025-12-25 08:02:32,224 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0802_stage2_final800.svg
[rank2]:2025-12-25 08:02:32,269 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251225_0802_stage6_final800.svg
[rank1]:2025-12-25 08:02:32,269 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251225_0802_stage5_final800.svg
[rank0]:2025-12-25 08:02:32,372 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank0_stage0.svg
[rank0]:	> Counts Sum: 1170, Total Sum: 1425 (82.11%), Ratio(%) per element: [0.0, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66]
[rank2]:2025-12-25 08:02:32,369 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank2_stage2.svg
[rank2]:	> Counts Sum: 666, Total Sum: 1350 (49.33%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33]
[rank3]:2025-12-25 08:02:32,417 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0802_final800_rank3.svg
[rank3]:			> Batch Time: 1254.48 ms, GPU Bubble Ratio: 70.11%, 57.61%, 65.38%, 27.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-25ms      | [S0,MB3,F]  25-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  88-8-97ms      | [S4,MB2,F]  127-8-135ms    | [S4,MB3,F]  165-8-174ms    | [S0,MB4,F]  174-9-183ms    | [S0,MB5,F]  183-8-191ms    | [S0,MB6,F]  192-9-201ms    | [S4,MB0,B]  380-14-395ms   | [S0,MB7,F]  396-8-404ms    | [S4,MB1,B]  504-14-518ms   | [S4,MB4,F]  568-8-577ms    | [S4,MB2,B]  577-15-592ms   | [S4,MB5,F]  602-8-610ms    | [S4,MB3,B]  611-15-626ms   | [S4,MB6,F]  635-9-644ms    | [S0,MB0,B]  645-16-661ms   | [S4,MB7,F]  668-7-676ms    | [S0,MB1,B]  679-16-695ms   | [S0,MB2,B]  716-14-731ms   | [S0,MB3,B]  781-14-795ms   | [S4,MB4,B]  817-13-831ms   | [S4,MB5,B]  907-13-920ms   | [S4,MB6,B]  999-13-1013ms  | [S4,MB7,B]  1093-13-1106ms | [S0,MB4,B]  1128-14-1142ms | [S0,MB5,B]  1169-14-1183ms | [S0,MB6,B]  1204-14-1218ms | [S0,MB7,B]  1240-14-1254ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  88-10-99ms     | [S1,MB3,F]  127-10-138ms   | [S5,MB0,F]  165-8-173ms    | [S5,MB1,F]  180-7-187ms    | [S5,MB2,F]  194-7-201ms    | [S5,MB3,F]  279-7-287ms    | [S1,MB4,F]  308-10-319ms   | [S5,MB0,B]  319-17-336ms   | [S1,MB5,F]  372-13-385ms   | [S5,MB1,B]  388-18-406ms   | [S1,MB6,F]  404-11-416ms   | [S5,MB2,B]  504-18-522ms   | [S1,MB7,F]  520-11-531ms   | [S5,MB3,B]  577-19-596ms   | [S5,MB4,F]  594-7-602ms    | [S1,MB0,B]  610-26-636ms   | [S5,MB5,F]  633-8-642ms    | [S1,MB1,B]  645-28-673ms   | [S5,MB6,F]  669-9-678ms    | [S1,MB2,B]  679-30-710ms   | [S5,MB7,F]  709-10-719ms   | [S1,MB3,B]  719-32-751ms   | [S5,MB4,B]  793-18-811ms   | [S5,MB5,B]  882-18-900ms   | [S5,MB6,B]  974-18-992ms   | [S5,MB7,B]  1068-18-1086ms | [S1,MB4,B]  1094-27-1121ms | [S1,MB5,B]  1134-27-1161ms | [S1,MB6,B]  1168-27-1195ms | [S1,MB7,B]  1203-27-1231ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  99-7-106ms     | [S2,MB3,F]  137-7-145ms    | [S6,MB0,F]  173-8-181ms    | [S6,MB1,F]  187-7-195ms    | [S6,MB2,F]  273-7-280ms    | [S6,MB0,B]  281-17-298ms   | [S6,MB3,F]  298-8-307ms    | [S6,MB1,B]  360-21-382ms   | [S2,MB4,F]  380-8-389ms    | [S6,MB2,B]  454-19-474ms   | [S2,MB5,F]  471-7-479ms    | [S6,MB3,B]  548-19-567ms   | [S2,MB6,F]  566-9-575ms    | [S2,MB0,B]  582-17-600ms   | [S2,MB7,F]  597-8-606ms    | [S2,MB1,B]  615-19-634ms   | [S6,MB4,F]  631-8-639ms    | [S2,MB2,B]  648-19-667ms   | [S6,MB5,F]  664-8-673ms    | [S2,MB3,B]  681-19-701ms   | [S6,MB6,F]  699-7-707ms    | [S6,MB4,B]  765-20-786ms   | [S6,MB7,F]  786-8-795ms    | [S6,MB5,B]  857-18-876ms   | [S6,MB6,B]  950-18-968ms   | [S6,MB7,B]  1044-18-1062ms | [S2,MB4,B]  1070-18-1088ms | [S2,MB5,B]  1110-18-1128ms | [S2,MB6,B]  1134-18-1152ms | [S2,MB7,B]  1168-18-1186ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  68-7-75ms      | [S3,MB2,F]  106-7-113ms    | [S3,MB3,F]  145-7-152ms    | [S7,MB0,F]  181-15-197ms   | [S7,MB0,B]  209-53-263ms   | [S7,MB1,F]  264-19-283ms   | [S7,MB1,B]  295-57-353ms   | [S7,MB2,F]  354-21-376ms   | [S7,MB2,B]  388-60-448ms   | [S7,MB3,F]  448-21-470ms   | [S7,MB3,B]  482-60-542ms   | [S3,MB4,F]  542-12-555ms   | [S3,MB0,B]  555-24-579ms   | [S3,MB5,F]  574-11-586ms   | [S3,MB1,B]  585-24-610ms   | [S3,MB6,F]  605-11-616ms   | [S3,MB2,B]  616-23-640ms   | [S3,MB7,F]  636-10-647ms   | [S3,MB3,B]  647-23-670ms   | [S7,MB4,F]  670-18-689ms   | [S7,MB4,B]  701-57-759ms   | [S7,MB5,F]  758-21-780ms   | [S7,MB5,B]  792-59-851ms   | [S7,MB6,F]  851-21-873ms   | [S7,MB6,B]  884-60-944ms   | [S7,MB7,F]  944-21-966ms   | [S7,MB7,B]  977-60-1037ms  | [S3,MB4,B]  1038-26-1064ms | [S3,MB5,B]  1062-24-1087ms | [S3,MB6,B]  1087-24-1112ms | [S3,MB7,B]  1112-23-1136ms
[rank1]:2025-12-25 08:02:32,397 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank1_stage1.svg
[rank1]:	> Counts Sum: 945, Total Sum: 2025 (46.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66]
[rank0]:2025-12-25 08:02:32,470 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank0_stage4.svg
[rank0]:	> Counts Sum: 522, Total Sum: 1350 (38.67%), Ratio(%) per element: [77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 77.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-25 08:02:32,470 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-25 08:02:32,467 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank2_stage6.svg
[rank2]:	> Counts Sum: 333, Total Sum: 1350 (24.67%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-25 08:02:32,467 - Destroying the purge thread.
[rank1]:2025-12-25 08:02:32,495 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank1_stage5.svg
[rank1]:	> Counts Sum: 306, Total Sum: 1350 (22.67%), Ratio(%) per element: [45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-25 08:02:32,495 - Destroying the purge thread.
[rank3]:2025-12-25 08:02:32,641 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251225_0802_thry_final800_rank3.svg
[rank3]:			> Batch Time: 595.00 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-31ms     | [S0,MB3,F]  31-10-41ms     | [S4,MB0,F]  41-10-52ms     | [S4,MB1,F]  52-10-62ms     | [S4,MB2,F]  62-10-73ms     | [S4,MB3,F]  73-10-83ms     | [S0,MB4,F]  83-10-93ms     | [S0,MB5,F]  93-10-104ms    | [S0,MB6,F]  104-10-114ms   | [S4,MB0,B]  146-20-167ms   | [S0,MB7,F]  167-10-177ms   | [S4,MB1,B]  177-20-198ms   | [S4,MB4,F]  208-10-219ms   | [S4,MB2,B]  219-20-240ms   | [S4,MB5,F]  240-10-250ms   | [S4,MB3,B]  250-20-271ms   | [S4,MB6,F]  271-10-281ms   | [S0,MB0,B]  281-20-302ms   | [S4,MB7,F]  302-10-313ms   | [S0,MB1,B]  313-20-334ms   | [S0,MB2,B]  334-20-354ms   | [S0,MB3,B]  365-20-386ms   | [S4,MB4,B]  396-20-417ms   | [S4,MB5,B]  427-20-448ms   | [S4,MB6,B]  459-20-480ms   | [S4,MB7,B]  490-20-511ms   | [S0,MB4,B]  511-20-532ms   | [S0,MB5,B]  532-20-553ms   | [S0,MB6,B]  553-20-574ms   | [S0,MB7,B]  574-20-595ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-41ms     | [S1,MB3,F]  41-10-52ms     | [S5,MB0,F]  52-10-62ms     | [S5,MB1,F]  62-10-73ms     | [S5,MB2,F]  73-10-83ms     | [S5,MB3,F]  83-10-93ms     | [S1,MB4,F]  93-10-104ms    | [S5,MB0,B]  125-20-146ms   | [S1,MB5,F]  146-10-156ms   | [S5,MB1,B]  156-20-177ms   | [S1,MB6,F]  177-10-187ms   | [S5,MB2,B]  187-20-208ms   | [S1,MB7,F]  208-10-219ms   | [S5,MB3,B]  219-20-240ms   | [S5,MB4,F]  240-10-250ms   | [S1,MB0,B]  250-20-271ms   | [S5,MB5,F]  271-10-281ms   | [S1,MB1,B]  281-20-302ms   | [S5,MB6,F]  302-10-313ms   | [S1,MB2,B]  313-20-334ms   | [S5,MB7,F]  334-10-344ms   | [S1,MB3,B]  344-20-365ms   | [S5,MB4,B]  375-20-396ms   | [S5,MB5,B]  407-20-427ms   | [S5,MB6,B]  438-20-459ms   | [S5,MB7,B]  469-20-490ms   | [S1,MB4,B]  490-20-511ms   | [S1,MB5,B]  511-20-532ms   | [S1,MB6,B]  532-20-553ms   | [S1,MB7,B]  553-20-574ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms     | [S2,MB1,F]  31-10-41ms     | [S2,MB2,F]  41-10-52ms     | [S2,MB3,F]  52-10-62ms     | [S6,MB0,F]  62-10-73ms     | [S6,MB1,F]  73-10-83ms     | [S6,MB2,F]  83-10-93ms     | [S6,MB0,B]  104-20-125ms   | [S6,MB3,F]  125-10-135ms   | [S6,MB1,B]  135-20-156ms   | [S2,MB4,F]  156-10-167ms   | [S6,MB2,B]  167-20-187ms   | [S2,MB5,F]  187-10-198ms   | [S6,MB3,B]  198-20-219ms   | [S2,MB6,F]  219-10-229ms   | [S2,MB0,B]  229-20-250ms   | [S2,MB7,F]  250-10-260ms   | [S2,MB1,B]  260-20-281ms   | [S6,MB4,F]  281-10-292ms   | [S2,MB2,B]  292-20-313ms   | [S6,MB5,F]  313-10-323ms   | [S2,MB3,B]  323-20-344ms   | [S6,MB6,F]  344-10-354ms   | [S6,MB4,B]  354-20-375ms   | [S6,MB7,F]  375-10-386ms   | [S6,MB5,B]  386-20-407ms   | [S6,MB6,B]  417-20-438ms   | [S6,MB7,B]  448-20-469ms   | [S2,MB4,B]  469-20-490ms   | [S2,MB5,B]  490-20-511ms   | [S2,MB6,B]  511-20-532ms   | [S2,MB7,B]  532-20-553ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms     | [S3,MB1,F]  41-10-52ms     | [S3,MB2,F]  52-10-62ms     | [S3,MB3,F]  62-10-73ms     | [S7,MB0,F]  73-10-83ms     | [S7,MB0,B]  83-20-104ms    | [S7,MB1,F]  104-10-114ms   | [S7,MB1,B]  114-20-135ms   | [S7,MB2,F]  135-10-146ms   | [S7,MB2,B]  146-20-167ms   | [S7,MB3,F]  167-10-177ms   | [S7,MB3,B]  177-20-198ms   | [S3,MB4,F]  198-10-208ms   | [S3,MB0,B]  208-20-229ms   | [S3,MB5,F]  229-10-240ms   | [S3,MB1,B]  240-20-260ms   | [S3,MB6,F]  260-10-271ms   | [S3,MB2,B]  271-20-292ms   | [S3,MB7,F]  292-10-302ms   | [S3,MB3,B]  302-20-323ms   | [S7,MB4,F]  323-10-334ms   | [S7,MB4,B]  334-20-354ms   | [S7,MB5,F]  354-10-365ms   | [S7,MB5,B]  365-20-386ms   | [S7,MB6,F]  386-10-396ms   | [S7,MB6,B]  396-20-417ms   | [S7,MB7,F]  417-10-427ms   | [S7,MB7,B]  427-20-448ms   | [S3,MB4,B]  448-20-469ms   | [S3,MB5,B]  469-20-490ms   | [S3,MB6,B]  490-20-511ms   | [S3,MB7,B]  511-20-532ms  
[rank3]:2025-12-25 08:02:32,688 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0802_stage3_final800.svg
[rank3]:2025-12-25 08:02:32,731 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251225_0802_stage7_final800.svg
[rank3]:2025-12-25 08:02:32,831 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 1350 (49.33%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33]
[rank3]:2025-12-25 08:02:32,908 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251225_0802_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 825 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-25 08:02:32,909 - Destroying the purge thread.
[rank1]:2025-12-25 08:02:32,938 - Process group destroyed
[rank2]:2025-12-25 08:02:32,949 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 353-371
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.72729
[rank3]:wandb:               final/avg_loss 0.24687
[rank3]:wandb:             final/avg_mfu(%) 15.98213
[rank3]:wandb:             final/avg_tflops 54.18855
[rank3]:wandb:    final/avg_throughput(tps) 6931.66257
[rank3]:wandb:              final/grad_norm 1.0734
[rank3]:wandb:               final/max_loss 0.24687
[rank3]:wandb:                    grad_norm 1.0734
[rank3]:wandb: loss_metrics/global_avg_loss 0.24687
[rank3]:wandb: loss_metrics/global_max_loss 0.24687
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_Interleaved1F1B_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/q9fnrdk8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_auto_42_dm1/20251225-0655/wandb/run-20251225_065530-q9fnrdk8/logs
[rank3]:2025-12-25 08:02:34,318 - Process group destroyed
[rank0]:2025-12-25 08:02:34,471 - Training completed
[rank0]:2025-12-25 08:02:34,471 - Destroying the purge thread.
[rank0]:2025-12-25 08:02:34,906 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.3', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'norm', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_Interleaved1F1B_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_Interleaved1F1B_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
