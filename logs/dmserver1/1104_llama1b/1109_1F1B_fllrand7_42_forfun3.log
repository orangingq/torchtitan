
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 27. (ëª©) 04:00:38 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_1F1B_fullrand7_42_forfun.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-27 04:00:44,428 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank0]:2025-11-27 04:00:44,509 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank2]:2025-11-27 04:00:44,465 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank3]:2025-11-27 04:00:44,648 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank1]:2025-11-27 04:00:44,606 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-27 04:00:44,608 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 04:00:44,737 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-27 04:00:44,739 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 04:00:44,743 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-27 04:00:44,745 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-11-27 04:00:44,715 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-27 04:00:44,717 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-27 04:00:44,825 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-27 04:00:44,828 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 04:00:45,143 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-27 04:00:47,948 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-27 04:00:47,970 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-27 04:00:48,007 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 04:00:48,034 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-27 04:00:48,034 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-27 04:00:48,101 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-27 04:00:48,140 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 04:00:48,141 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-11-27 04:00:48,069 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-27 04:00:48,107 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 04:00:48,133 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-27 04:00:48,134 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-27 04:00:48,166 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-27 04:00:48,166 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-27 04:00:48,218 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 04:00:48,218 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-27 04:00:48,219 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-27 04:00:48,354 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 04:00:48,355 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-27 04:00:48,355 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-27 04:00:48,317 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 04:00:48,317 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-27 04:00:48,317 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run skhi51bd
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1/20251127-0400/wandb/run-20251127_040049-skhi51bd
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/skhi51bd
[rank3]:2025-11-27 04:00:50,761 - INFO - WandB logging enabled
[rank3]:2025-11-27 04:00:50,762 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-27 04:00:50,800 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-27 04:00:50,831 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-27 04:00:50,832 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-27 04:00:51,041 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1
[rank0]:2025-11-27 04:00:51,041 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-27 04:00:51,042 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-27 04:00:51,042 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank0]:2025-11-27 04:00:51,043 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800.
[rank3]:2025-11-27 04:00:51,022 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-27 04:00:51,023 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-27 04:00:51,023 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-27 04:00:51,041 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-27 04:00:51,042 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank1]:2025-11-27 04:00:51,041 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-27 04:00:51,042 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank2]:2025-11-27 04:00:51,042 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-27 04:00:51,044 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank0]:2025-11-27 04:00:53,500 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-27 04:00:53,500 - INFO - Finished loading the checkpoint in 2.46 seconds.
[rank0]:2025-11-27 04:00:53,500 - INFO - Training starts at step 1
[rank3]:2025-11-27 04:00:58,740 - INFO -  step:  1  loss:  2.9590  grad_norm: 26.4880  memory: 21.88GiB(46.05%)  tps: 4,128  tflops: 32.27  mfu: 10.34%
[rank3]:2025-11-27 04:00:58,741 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-27 04:00:58,732 - INFO -  step:  1  loss: -4.0000  grad_norm: 26.4880  memory: 10.58GiB(22.26%)  tps: 3,055  tflops: 23.89  mfu: 7.66%
[rank1]:2025-11-27 04:00:58,732 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-27 04:00:58,728 - INFO -  step:  1  loss: -4.0000  grad_norm: 26.4880  memory:  6.84GiB(14.41%)  tps: 3,085  tflops: 24.12  mfu: 7.73%
[rank2]:2025-11-27 04:00:58,728 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-27 04:00:58,773 - INFO -  step:  1  loss: -4.0000  grad_norm: 26.4880  memory: 13.10GiB(27.57%)  tps: 3,082  tflops: 24.09  mfu: 7.72%
[rank0]:2025-11-27 04:00:58,773 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-27 04:04:56,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:05:00,644 - INFO - Avg. fwd time: 25.4859 / Avg. bwd time: 83.0225 / Avg. batch time: 1013.7334 (ms) / GPU bubble ratio: 14.37%
[rank2]:2025-11-27 04:05:00,709 - INFO - Avg. fwd time: 15.2113 / Avg. bwd time: 35.7164 / Avg. batch time: 1072.6739 (ms) / GPU bubble ratio: 62.02%
[rank0]:2025-11-27 04:05:00,787 - INFO - Avg. fwd time: 15.2939 / Avg. bwd time: 39.8190 / Avg. batch time: 1208.7049 (ms) / GPU bubble ratio: 63.52%
[rank1]:2025-11-27 04:05:00,834 - INFO - Avg. fwd time: 19.7423 / Avg. bwd time: 45.4415 / Avg. batch time: 1145.1523 (ms) / GPU bubble ratio: 54.46%
[rank0]:2025-11-27 04:05:01,208 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.4850  memory: 16.87GiB(35.50%)  tps: 6,623  tflops: 51.78  mfu: 16.59%
[rank2]:2025-11-27 04:05:01,191 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.4850  memory:  8.66GiB(18.23%)  tps: 6,622  tflops: 51.77  mfu: 16.59%
[rank1]:2025-11-27 04:05:01,195 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.4850  memory: 12.86GiB(27.07%)  tps: 6,622  tflops: 51.77  mfu: 16.59%
[rank3]:2025-11-27 04:05:01,203 - INFO -  step: 50  loss:  2.4682  grad_norm: 24.4850  memory: 25.79GiB(54.28%)  tps: 6,622  tflops: 51.77  mfu: 16.59%
[rank3]:2025-11-27 04:05:50,995 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-27 04:06:40,548 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-27 04:06:41,107 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-11-27 04:06:41,143 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 04:06:41,170 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 04:06:41,201 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,132 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,158 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,187 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,129 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,153 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,176 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,200 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,142 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,166 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,205 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,273 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,317 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,362 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,363 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,414 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 04:06:41,433 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,451 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,460 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,504 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 04:06:41,533 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 04:06:41,534 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 04:06:41,535 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 04:06:41,535 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,538 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 04:06:41,605 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:06:41,543 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,572 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,602 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 04:06:41,643 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 04:07:50,804 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-27 04:07:51,017 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0407_max_batch_time.svg
[rank3]:			> Batch Time: 1059.50 ms, GPU Bubble Ratio: 58.10%, 50.33%, 61.27%, 16.39%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-15-31ms | [S0,MB2,FORWARD] 31-16-47ms | [S0,MB3,FORWARD] 47-15-63ms | [S0,MB0,FULL_BACKWARD] 239-40-280ms | [S0,MB4,FORWARD] 280-14-295ms | [S0,MB1,FULL_BACKWARD] 349-40-389ms | [S0,MB5,FORWARD] 389-14-404ms | [S0,MB2,FULL_BACKWARD] 461-40-501ms | [S0,MB6,FORWARD] 501-14-515ms | [S0,MB3,FULL_BACKWARD] 574-40-614ms | [S0,MB7,FORWARD] 614-14-629ms | [S0,MB4,FULL_BACKWARD] 685-40-725ms | [S0,MB5,FULL_BACKWARD] 797-39-837ms | [S0,MB6,FULL_BACKWARD] 908-39-948ms | [S0,MB7,FULL_BACKWARD] 1019-39-1059ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 36-18-54ms | [S1,MB2,FORWARD] 54-18-73ms | [S1,MB0,FULL_BACKWARD] 193-46-239ms | [S1,MB3,FORWARD] 239-19-259ms | [S1,MB1,FULL_BACKWARD] 303-46-349ms | [S1,MB4,FORWARD] 349-20-370ms | [S1,MB2,FULL_BACKWARD] 415-45-461ms | [S1,MB5,FORWARD] 461-20-481ms | [S1,MB3,FULL_BACKWARD] 528-46-574ms | [S1,MB6,FORWARD] 574-21-595ms | [S1,MB4,FULL_BACKWARD] 639-45-685ms | [S1,MB7,FORWARD] 685-20-705ms | [S1,MB5,FULL_BACKWARD] 751-45-797ms | [S1,MB6,FULL_BACKWARD] 863-45-908ms | [S1,MB7,FULL_BACKWARD] 974-45-1019ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 54-14-69ms | [S2,MB0,FULL_BACKWARD] 156-36-193ms | [S2,MB2,FORWARD] 193-14-208ms | [S2,MB1,FULL_BACKWARD] 267-35-303ms | [S2,MB3,FORWARD] 303-15-318ms | [S2,MB2,FULL_BACKWARD] 379-35-415ms | [S2,MB4,FORWARD] 415-15-431ms | [S2,MB3,FULL_BACKWARD] 492-36-528ms | [S2,MB5,FORWARD] 528-15-543ms | [S2,MB4,FULL_BACKWARD] 603-35-639ms | [S2,MB6,FORWARD] 639-15-655ms | [S2,MB5,FULL_BACKWARD] 715-35-751ms | [S2,MB7,FORWARD] 751-15-766ms | [S2,MB6,FULL_BACKWARD] 827-35-863ms | [S2,MB7,FULL_BACKWARD] 938-35-974ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 76-79-156ms AFR(10):0.9655 | [S3,MB1,FORWARD] 156-25-182ms | [S3,MB1,FULL_BACKWARD] 182-85-267ms AFR(10):0.9655 | [S3,MB2,FORWARD] 267-26-293ms | [S3,MB2,FULL_BACKWARD] 293-85-379ms AFR(10):0.9655 | [S3,MB3,FORWARD] 379-26-406ms | [S3,MB3,FULL_BACKWARD] 406-85-492ms AFR(10):0.9655 | [S3,MB4,FORWARD] 492-26-518ms | [S3,MB4,FULL_BACKWARD] 518-85-603ms AFR(10):0.9655 | [S3,MB5,FORWARD] 603-26-630ms | [S3,MB5,FULL_BACKWARD] 630-85-715ms AFR(10):0.9655 | [S3,MB6,FORWARD] 715-26-742ms | [S3,MB6,FULL_BACKWARD] 742-85-827ms AFR(10):0.9655 | [S3,MB7,FORWARD] 827-26-853ms | [S3,MB7,FULL_BACKWARD] 853-84-938ms AFR(10):0.9655 | 
[rank3]:2025-11-27 04:07:51,159 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0407_min_batch_time.svg
[rank3]:			> Batch Time: 662.81 ms, GPU Bubble Ratio: 81.47%, 47.74%, 59.16%, 14.23%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-15-31ms | [S0,MB2,FORWARD] 31-16-47ms | [S0,MB3,FORWARD] 47-15-63ms | [S0,MB0,FULL_BACKWARD] 162-0-162ms | [S0,MB4,FORWARD] 162-14-176ms | [S0,MB1,FULL_BACKWARD] 233-0-233ms | [S0,MB5,FORWARD] 233-14-248ms | [S0,MB2,FULL_BACKWARD] 304-0-304ms | [S0,MB6,FORWARD] 304-14-319ms | [S0,MB3,FULL_BACKWARD] 376-0-376ms | [S0,MB7,FORWARD] 376-14-391ms | [S0,MB4,FULL_BACKWARD] 447-0-447ms | [S0,MB5,FULL_BACKWARD] 520-0-520ms | [S0,MB6,FULL_BACKWARD] 591-0-591ms | [S0,MB7,FULL_BACKWARD] 662-0-662ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 36-18-54ms | [S1,MB2,FORWARD] 54-18-73ms | [S1,MB0,FULL_BACKWARD] 139-23-162ms | [S1,MB3,FORWARD] 162-19-181ms | [S1,MB1,FULL_BACKWARD] 209-23-233ms | [S1,MB4,FORWARD] 233-20-254ms | [S1,MB2,FULL_BACKWARD] 280-23-304ms | [S1,MB5,FORWARD] 304-20-324ms | [S1,MB3,FULL_BACKWARD] 353-23-376ms | [S1,MB6,FORWARD] 376-21-398ms | [S1,MB4,FULL_BACKWARD] 424-23-447ms | [S1,MB7,FORWARD] 447-20-468ms | [S1,MB5,FULL_BACKWARD] 497-23-520ms | [S1,MB6,FULL_BACKWARD] 568-23-591ms | [S1,MB7,FULL_BACKWARD] 639-23-662ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 54-14-69ms | [S2,MB0,FULL_BACKWARD] 120-18-139ms | [S2,MB2,FORWARD] 139-14-154ms | [S2,MB1,FULL_BACKWARD] 191-18-209ms | [S2,MB3,FORWARD] 209-15-224ms | [S2,MB2,FULL_BACKWARD] 262-18-280ms | [S2,MB4,FORWARD] 280-15-296ms | [S2,MB3,FULL_BACKWARD] 334-18-353ms | [S2,MB5,FORWARD] 353-15-368ms | [S2,MB4,FULL_BACKWARD] 405-18-424ms | [S2,MB6,FORWARD] 424-15-440ms | [S2,MB5,FULL_BACKWARD] 478-18-497ms | [S2,MB7,FORWARD] 497-15-512ms | [S2,MB6,FULL_BACKWARD] 550-18-568ms | [S2,MB7,FULL_BACKWARD] 621-18-639ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 76-43-120ms AFR(10):0.9655 | [S3,MB1,FORWARD] 120-25-146ms | [S3,MB1,FULL_BACKWARD] 146-44-191ms AFR(10):0.9655 | [S3,MB2,FORWARD] 191-26-217ms | [S3,MB2,FULL_BACKWARD] 217-45-262ms AFR(10):0.9655 | [S3,MB3,FORWARD] 262-26-289ms | [S3,MB3,FULL_BACKWARD] 289-45-334ms AFR(10):0.9655 | [S3,MB4,FORWARD] 334-26-360ms | [S3,MB4,FULL_BACKWARD] 360-45-405ms AFR(10):0.9655 | [S3,MB5,FORWARD] 405-26-432ms | [S3,MB5,FULL_BACKWARD] 432-46-478ms AFR(10):0.9655 | [S3,MB6,FORWARD] 478-26-504ms | [S3,MB6,FULL_BACKWARD] 504-45-550ms AFR(10):0.9655 | [S3,MB7,FORWARD] 550-26-576ms | [S3,MB7,FULL_BACKWARD] 576-44-621ms AFR(10):0.9655 | 
[rank3]:2025-11-27 04:07:51,310 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0407_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 722.54 ms, GPU Bubble Ratio: 45.28%, 30.24%, 45.60%, 13.05%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-15-31ms | [S0,MB2,FORWARD] 31-16-47ms | [S0,MB3,FORWARD] 47-15-63ms | [S0,MB0,FULL_BACKWARD] 239-40-280ms | [S0,MB4,FORWARD] 280-14-295ms | [S0,MB1,FULL_BACKWARD] 309-40-349ms | [S0,MB5,FORWARD] 349-14-364ms | [S0,MB2,FULL_BACKWARD] 379-40-420ms | [S0,MB6,FORWARD] 420-14-434ms | [S0,MB3,FULL_BACKWARD] 453-40-493ms | [S0,MB7,FORWARD] 493-14-508ms | [S0,MB4,FULL_BACKWARD] 523-40-563ms | [S0,MB5,FULL_BACKWARD] 620-39-659ms | [S0,MB6,FULL_BACKWARD] 691-31-722ms | [S0,MB7,FULL_BACKWARD] 722-0-722ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 36-18-54ms | [S1,MB2,FORWARD] 54-18-73ms | [S1,MB0,FULL_BACKWARD] 193-46-239ms | [S1,MB3,FORWARD] 239-19-259ms | [S1,MB1,FULL_BACKWARD] 263-46-309ms | [S1,MB4,FORWARD] 309-20-330ms | [S1,MB2,FULL_BACKWARD] 334-45-379ms | [S1,MB5,FORWARD] 379-20-400ms | [S1,MB3,FULL_BACKWARD] 406-46-453ms | [S1,MB6,FORWARD] 453-21-474ms | [S1,MB4,FULL_BACKWARD] 477-45-523ms | [S1,MB7,FORWARD] 523-20-543ms | [S1,MB5,FULL_BACKWARD] 574-45-620ms | [S1,MB6,FULL_BACKWARD] 645-45-691ms | [S1,MB7,FULL_BACKWARD] 699-23-722ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 54-14-69ms | [S2,MB0,FULL_BACKWARD] 156-36-193ms | [S2,MB2,FORWARD] 193-14-208ms | [S2,MB1,FULL_BACKWARD] 227-35-263ms | [S2,MB3,FORWARD] 263-15-278ms | [S2,MB2,FULL_BACKWARD] 298-35-334ms | [S2,MB4,FORWARD] 334-15-349ms | [S2,MB3,FULL_BACKWARD] 370-36-406ms | [S2,MB5,FORWARD] 406-15-422ms | [S2,MB4,FULL_BACKWARD] 442-35-477ms | [S2,MB6,FORWARD] 477-15-493ms | [S2,MB5,FULL_BACKWARD] 538-35-574ms | [S2,MB7,FORWARD] 574-15-589ms | [S2,MB6,FULL_BACKWARD] 609-35-645ms | [S2,MB7,FULL_BACKWARD] 680-18-699ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 76-79-156ms AFR(10):0.9655 | [S3,MB1,FORWARD] 156-25-182ms | [S3,MB1,FULL_BACKWARD] 182-44-227ms AFR(10):0.9655 | [S3,MB2,FORWARD] 227-26-253ms | [S3,MB2,FULL_BACKWARD] 253-45-298ms AFR(10):0.9655 | [S3,MB3,FORWARD] 298-26-325ms | [S3,MB3,FULL_BACKWARD] 325-45-370ms AFR(10):0.9655 | [S3,MB4,FORWARD] 370-26-396ms | [S3,MB4,FULL_BACKWARD] 396-45-442ms AFR(10):0.9655 | [S3,MB5,FORWARD] 442-26-468ms | [S3,MB5,FULL_BACKWARD] 468-69-538ms AFR(10):0.9655 | [S3,MB6,FORWARD] 538-26-564ms | [S3,MB6,FULL_BACKWARD] 564-45-609ms AFR(10):0.9655 | [S3,MB7,FORWARD] 609-26-635ms | [S3,MB7,FULL_BACKWARD] 635-44-680ms AFR(10):0.9655 | 
[rank3]:2025-11-27 04:07:51,310 - INFO - 	> Batch Time: 722.54 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank0]:2025-11-27 04:08:26,791 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:08:30,213 - INFO - Avg. fwd time: 26.5923 / Avg. bwd time: 73.0641 / Avg. batch time: 943.4689 (ms) / GPU bubble ratio: 15.50%
[rank2]:2025-11-27 04:08:30,351 - INFO - Avg. fwd time: 15.4482 / Avg. bwd time: 31.9038 / Avg. batch time: 999.4668 (ms) / GPU bubble ratio: 62.10%
[rank0]:2025-11-27 04:08:30,431 - INFO - Avg. fwd time: 15.5061 / Avg. bwd time: 30.0860 / Avg. batch time: 1121.3748 (ms) / GPU bubble ratio: 67.47%
[rank1]:2025-11-27 04:08:30,422 - INFO - Avg. fwd time: 20.0409 / Avg. bwd time: 40.4255 / Avg. batch time: 1066.9941 (ms) / GPU bubble ratio: 54.66%
[rank2]:2025-11-27 04:08:30,629 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(0.33)/1.00
[rank3]:2025-11-27 04:08:30,610 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(0.33)/1.00, [MB2] 1.00(0.33)/1.00, [MB3] 1.00(0.33)/1.00, [MB4] 1.00(0.33)/1.00, [MB5] 0.41(0.13)/0.40, [MB6] 1.00(0.33)/1.00, [MB7] 1.00(0.33)/1.00
[rank0]:2025-11-27 04:08:30,710 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.22(0.07)/0.22, [MB7] 1.00(0.33)/1.00
[rank0]:2025-11-27 04:08:30,741 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1154  memory: 16.87GiB(35.50%)  tps: 7,819  tflops: 61.13  mfu: 19.59%
[rank2]:2025-11-27 04:08:30,724 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1154  memory:  8.70GiB(18.31%)  tps: 7,819  tflops: 61.13  mfu: 19.59%
[rank3]:2025-11-27 04:08:30,712 - INFO -  step: 100  loss:  2.0411  grad_norm:  0.0000  memory: 25.79GiB(54.28%)  tps: 7,820  tflops: 61.14  mfu: 19.59%
[rank1]:2025-11-27 04:08:30,675 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(0.33)/1.00
[rank1]:2025-11-27 04:08:30,728 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1154  memory: 12.88GiB(27.11%)  tps: 7,819  tflops: 61.13  mfu: 19.59%
[rank0]:2025-11-27 04:08:30,799 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0408_stage0_step100.svg
[rank2]:2025-11-27 04:08:30,800 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0408_stage2_step100.svg
[rank1]:2025-11-27 04:08:30,798 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0408_stage1_step100.svg
[rank3]:2025-11-27 04:08:30,881 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0408_real_step100_rank3.svg
[rank3]:			> Batch Time: 953.91 ms, GPU Bubble Ratio: 72.00%, 52.40%, 60.95%, 34.12%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-15-15ms | [S0,MB1,FORWARD] 15-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 328-0-328ms | [S0,MB5,FORWARD] 328-13-341ms | [S0,MB2,FULL_BACKWARD] 439-0-439ms | [S0,MB6,FORWARD] 439-14-453ms | [S0,MB3,FULL_BACKWARD] 557-0-557ms | [S0,MB7,FORWARD] 557-14-571ms | [S0,MB4,FULL_BACKWARD] 654-34-688ms | [S0,MB5,FULL_BACKWARD] 744-40-784ms | [S0,MB6,FULL_BACKWARD] 839-35-874ms | [S0,MB7,FULL_BACKWARD] 921-32-953ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 15-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-193ms | [S1,MB3,FORWARD] 201-20-221ms | [S1,MB1,FULL_BACKWARD] 294-23-317ms | [S1,MB4,FORWARD] 324-19-344ms | [S1,MB2,FULL_BACKWARD] 405-23-428ms | [S1,MB5,FORWARD] 435-19-455ms | [S1,MB3,FULL_BACKWARD] 497-43-541ms | [S1,MB6,FORWARD] 553-20-574ms | [S1,MB4,FULL_BACKWARD] 595-45-641ms | [S1,MB7,FORWARD] 651-20-672ms | [S1,MB5,FULL_BACKWARD] 687-46-733ms | [S1,MB6,FULL_BACKWARD] 783-45-829ms | [S1,MB7,FULL_BACKWARD] 872-41-914ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 265-18-284ms | [S2,MB3,FORWARD] 291-14-305ms | [S2,MB2,FULL_BACKWARD] 359-33-393ms | [S2,MB4,FORWARD] 402-15-417ms | [S2,MB3,FULL_BACKWARD] 451-35-487ms | [S2,MB5,FORWARD] 494-15-510ms | [S2,MB4,FULL_BACKWARD] 550-35-585ms | [S2,MB6,FORWARD] 593-15-609ms | [S2,MB5,FULL_BACKWARD] 642-35-677ms | [S2,MB7,FORWARD] 685-16-701ms | [S2,MB6,FULL_BACKWARD] 742-35-777ms | [S2,MB7,FULL_BACKWARD] 834-32-866ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-43-131ms | [S3,MB1,FORWARD] 138-28-167ms | [S3,MB1,FULL_BACKWARD] 179-78-257ms | [S3,MB2,FORWARD] 262-30-293ms | [S3,MB2,FULL_BACKWARD] 304-45-350ms | [S3,MB3,FORWARD] 356-30-386ms | [S3,MB3,FULL_BACKWARD] 397-45-443ms | [S3,MB4,FORWARD] 448-30-478ms | [S3,MB4,FULL_BACKWARD] 490-45-535ms | [S3,MB5,FORWARD] 546-29-576ms | [S3,MB5,FULL_BACKWARD] 586-45-631ms | [S3,MB6,FORWARD] 639-29-668ms | [S3,MB6,FULL_BACKWARD] 679-49-729ms | [S3,MB7,FORWARD] 738-29-768ms | [S3,MB7,FULL_BACKWARD] 779-44-823ms | 
[rank3]:2025-11-27 04:08:30,923 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0408_stage3_step100.svg
[rank0]:2025-11-27 04:12:12,120 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:12:16,365 - INFO - Avg. fwd time: 26.8984 / Avg. bwd time: 71.1995 / Avg. batch time: 931.3962 (ms) / GPU bubble ratio: 15.74%
[rank3]:2025-11-27 04:12:16,371 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.59(0.67)/1.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.24(0.27)/0.40, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank1]:2025-11-27 04:12:16,457 - INFO - Avg. fwd time: 20.0554 / Avg. bwd time: 40.9491 / Avg. batch time: 1056.5723 (ms) / GPU bubble ratio: 53.81%
[rank1]:2025-11-27 04:12:16,465 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank2]:2025-11-27 04:12:16,406 - INFO - Avg. fwd time: 15.4660 / Avg. bwd time: 32.5459 / Avg. batch time: 987.8807 (ms) / GPU bubble ratio: 61.12%
[rank2]:2025-11-27 04:12:16,414 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank0]:2025-11-27 04:12:16,499 - INFO - Avg. fwd time: 15.4984 / Avg. bwd time: 30.8181 / Avg. batch time: 1112.1530 (ms) / GPU bubble ratio: 66.68%
[rank0]:2025-11-27 04:12:16,506 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.14(0.14)/0.22, [MB7] 0.59(0.67)/1.00
[rank0]:2025-11-27 04:12:16,537 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.1292  memory: 16.95GiB(35.67%)  tps: 7,256  tflops: 56.73  mfu: 18.18%
[rank2]:2025-11-27 04:12:16,520 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.1292  memory:  8.70GiB(18.31%)  tps: 7,256  tflops: 56.72  mfu: 18.18%
[rank1]:2025-11-27 04:12:16,524 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.1292  memory: 12.90GiB(27.16%)  tps: 7,256  tflops: 56.72  mfu: 18.18%
[rank3]:2025-11-27 04:12:16,532 - INFO -  step: 150  loss:  0.7082  grad_norm:  3.1292  memory: 25.79GiB(54.28%)  tps: 7,255  tflops: 56.72  mfu: 18.18%
[rank0]:2025-11-27 04:15:41,154 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:15:44,711 - INFO - Avg. fwd time: 27.2048 / Avg. bwd time: 68.0176 / Avg. batch time: 909.4060 (ms) / GPU bubble ratio: 16.23%
[rank3]:2025-11-27 04:15:44,717 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.38(0.40)/0.40, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank1]:2025-11-27 04:15:44,923 - INFO - Avg. fwd time: 20.0414 / Avg. bwd time: 40.5103 / Avg. batch time: 1034.7177 (ms) / GPU bubble ratio: 53.18%
[rank2]:2025-11-27 04:15:44,853 - INFO - Avg. fwd time: 15.4793 / Avg. bwd time: 32.5364 / Avg. batch time: 965.8189 (ms) / GPU bubble ratio: 60.23%
[rank0]:2025-11-27 04:15:44,934 - INFO - Avg. fwd time: 15.5286 / Avg. bwd time: 30.1424 / Avg. batch time: 1090.7760 (ms) / GPU bubble ratio: 66.50%
[rank1]:2025-11-27 04:15:45,204 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-11-27 04:15:45,158 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank3]:2025-11-27 04:15:45,244 - INFO -  step: 200  loss:  0.5342  grad_norm:  0.1037  memory: 26.76GiB(56.33%)  tps: 7,850  tflops: 61.37  mfu: 19.67%
[rank0]:2025-11-27 04:15:45,240 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.22(0.22)/0.22, [MB7] 0.95(1.00)/1.00
[rank0]:2025-11-27 04:15:45,271 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1037  memory: 16.95GiB(35.67%)  tps: 7,849  tflops: 61.36  mfu: 19.67%
[rank1]:2025-11-27 04:15:45,257 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1037  memory: 12.90GiB(27.16%)  tps: 7,849  tflops: 61.36  mfu: 19.67%
[rank1]:2025-11-27 04:15:45,321 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0415_stage1_step200.svg
[rank2]:2025-11-27 04:15:45,253 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1037  memory:  8.70GiB(18.31%)  tps: 7,849  tflops: 61.36  mfu: 19.67%
[rank2]:2025-11-27 04:15:45,321 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0415_stage2_step200.svg
[rank0]:2025-11-27 04:15:45,322 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0415_stage0_step200.svg
[rank3]:2025-11-27 04:15:45,418 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0415_real_step200_rank3.svg
[rank3]:			> Batch Time: 1021.03 ms, GPU Bubble Ratio: 67.82%, 54.76%, 62.83%, 31.92%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-16-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 208-12-220ms | [S0,MB4,FORWARD] 220-15-236ms | [S0,MB1,FULL_BACKWARD] 335-12-347ms | [S0,MB5,FORWARD] 345-13-359ms | [S0,MB2,FULL_BACKWARD] 447-12-459ms | [S0,MB6,FORWARD] 456-13-470ms | [S0,MB3,FULL_BACKWARD] 569-12-581ms | [S0,MB7,FORWARD] 579-14-593ms | [S0,MB4,FULL_BACKWARD] 668-40-709ms | [S0,MB5,FULL_BACKWARD] 769-40-809ms | [S0,MB6,FULL_BACKWARD] 887-39-927ms | [S0,MB7,FULL_BACKWARD] 987-33-1021ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 43-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 173-24-198ms | [S1,MB3,FORWARD] 205-20-226ms | [S1,MB1,FULL_BACKWARD] 300-24-324ms | [S1,MB4,FORWARD] 332-19-351ms | [S1,MB2,FULL_BACKWARD] 411-24-436ms | [S1,MB5,FORWARD] 443-18-462ms | [S1,MB3,FULL_BACKWARD] 508-46-555ms | [S1,MB6,FORWARD] 565-19-585ms | [S1,MB4,FULL_BACKWARD] 610-46-657ms | [S1,MB7,FORWARD] 665-20-686ms | [S1,MB5,FULL_BACKWARD] 716-46-762ms | [S1,MB6,FULL_BACKWARD] 834-45-880ms | [S1,MB7,FULL_BACKWARD] 939-42-981ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-15-79ms | [S2,MB0,FULL_BACKWARD] 143-20-164ms | [S2,MB2,FORWARD] 170-16-186ms | [S2,MB1,FULL_BACKWARD] 269-21-290ms | [S2,MB3,FORWARD] 296-14-311ms | [S2,MB2,FULL_BACKWARD] 365-36-402ms | [S2,MB4,FORWARD] 408-15-423ms | [S2,MB3,FULL_BACKWARD] 462-35-498ms | [S2,MB5,FORWARD] 505-15-520ms | [S2,MB4,FULL_BACKWARD] 563-35-599ms | [S2,MB6,FORWARD] 607-15-623ms | [S2,MB5,FULL_BACKWARD] 669-35-705ms | [S2,MB7,FORWARD] 712-15-728ms | [S2,MB6,FULL_BACKWARD] 792-35-828ms | [S2,MB7,FULL_BACKWARD] 899-33-933ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-44-132ms | [S3,MB1,FORWARD] 140-27-168ms | [S3,MB1,FULL_BACKWARD] 180-79-259ms | [S3,MB2,FORWARD] 266-30-296ms | [S3,MB2,FULL_BACKWARD] 308-46-355ms | [S3,MB3,FORWARD] 362-29-392ms | [S3,MB3,FULL_BACKWARD] 403-47-451ms | [S3,MB4,FORWARD] 459-29-489ms | [S3,MB4,FULL_BACKWARD] 500-49-549ms | [S3,MB5,FORWARD] 560-27-588ms | [S3,MB5,FULL_BACKWARD] 600-64-664ms | [S3,MB6,FORWARD] 666-27-694ms | [S3,MB6,FULL_BACKWARD] 706-75-781ms | [S3,MB7,FORWARD] 789-28-818ms | [S3,MB7,FULL_BACKWARD] 829-62-892ms | 
[rank3]:2025-11-27 04:15:45,462 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0415_stage3_step200.svg
[rank0]:2025-11-27 04:19:00,667 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:19:04,151 - INFO - Avg. fwd time: 27.5136 / Avg. bwd time: 64.3835 / Avg. batch time: 883.6211 (ms) / GPU bubble ratio: 16.80%
[rank2]:2025-11-27 04:19:04,292 - INFO - Avg. fwd time: 15.5152 / Avg. bwd time: 32.2775 / Avg. batch time: 940.1134 (ms) / GPU bubble ratio: 59.33%
[rank1]:2025-11-27 04:19:04,360 - INFO - Avg. fwd time: 20.0566 / Avg. bwd time: 39.9074 / Avg. batch time: 1009.0986 (ms) / GPU bubble ratio: 52.46%
[rank0]:2025-11-27 04:19:04,371 - INFO - Avg. fwd time: 15.5640 / Avg. bwd time: 27.8064 / Avg. batch time: 1065.1779 (ms) / GPU bubble ratio: 67.43%
[rank2]:2025-11-27 04:19:04,589 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-11-27 04:19:04,571 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.41(0.40)/0.40, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-27 04:19:04,636 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-27 04:19:04,689 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1312  memory: 12.90GiB(27.16%)  tps: 8,215  tflops: 64.22  mfu: 20.58%
[rank2]:2025-11-27 04:19:04,685 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1312  memory:  8.70GiB(18.31%)  tps: 8,215  tflops: 64.22  mfu: 20.58%
[rank3]:2025-11-27 04:19:04,673 - INFO -  step: 250  loss:  0.5484  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank0]:2025-11-27 04:19:04,671 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.22(0.22)/0.22, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-27 04:19:04,703 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1312  memory: 16.95GiB(35.67%)  tps: 8,215  tflops: 64.22  mfu: 20.58%
[rank0]:2025-11-27 04:22:21,502 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:22:25,372 - INFO - Avg. fwd time: 27.7122 / Avg. bwd time: 62.1999 / Avg. batch time: 868.1715 (ms) / GPU bubble ratio: 17.15%
[rank1]:2025-11-27 04:22:25,464 - INFO - Avg. fwd time: 20.0678 / Avg. bwd time: 39.5249 / Avg. batch time: 993.6278 (ms) / GPU bubble ratio: 52.02%
[rank2]:2025-11-27 04:22:25,413 - INFO - Avg. fwd time: 15.5413 / Avg. bwd time: 32.1103 / Avg. batch time: 924.6010 (ms) / GPU bubble ratio: 58.77%
[rank2]:2025-11-27 04:22:25,421 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-11-27 04:22:25,398 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.41(0.40)/0.40, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-27 04:22:25,505 - INFO - Avg. fwd time: 15.5878 / Avg. bwd time: 26.2178 / Avg. batch time: 1049.7177 (ms) / GPU bubble ratio: 68.14%
[rank0]:2025-11-27 04:22:25,512 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.22(0.22)/0.22, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-27 04:22:25,472 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-27 04:22:25,530 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1210  memory: 12.90GiB(27.16%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank3]:2025-11-27 04:22:25,515 - INFO -  step: 300  loss:  0.5477  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank2]:2025-11-27 04:22:25,526 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1210  memory:  8.70GiB(18.31%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank0]:2025-11-27 04:22:25,543 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1210  memory: 16.95GiB(35.67%)  tps: 8,158  tflops: 63.77  mfu: 20.44%
[rank0]:2025-11-27 04:22:25,591 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0422_stage0_step300.svg
[rank1]:2025-11-27 04:22:25,592 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0422_stage1_step300.svg
[rank2]:2025-11-27 04:22:25,592 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0422_stage2_step300.svg
[rank3]:2025-11-27 04:22:25,684 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0422_real_step300_rank3.svg
[rank3]:			> Batch Time: 976.09 ms, GPU Bubble Ratio: 71.41%, 52.56%, 61.43%, 34.05%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-51ms | [S0,MB3,FORWARD] 51-17-68ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-13-344ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-13-456ms | [S0,MB3,FULL_BACKWARD] 562-0-562ms | [S0,MB7,FORWARD] 562-13-576ms | [S0,MB4,FULL_BACKWARD] 659-41-700ms | [S0,MB5,FULL_BACKWARD] 748-40-788ms | [S0,MB6,FULL_BACKWARD] 857-39-896ms | [S0,MB7,FULL_BACKWARD] 943-33-976ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 296-23-320ms | [S1,MB4,FORWARD] 327-18-346ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 438-18-457ms | [S1,MB3,FULL_BACKWARD] 503-46-550ms | [S1,MB6,FORWARD] 559-19-579ms | [S1,MB4,FULL_BACKWARD] 600-47-648ms | [S1,MB7,FORWARD] 656-21-677ms | [S1,MB5,FULL_BACKWARD] 693-49-742ms | [S1,MB6,FULL_BACKWARD] 803-45-849ms | [S1,MB7,FULL_BACKWARD] 893-42-935ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-286ms | [S2,MB3,FORWARD] 293-14-308ms | [S2,MB2,FULL_BACKWARD] 362-36-399ms | [S2,MB4,FORWARD] 405-15-420ms | [S2,MB3,FULL_BACKWARD] 456-36-492ms | [S2,MB5,FORWARD] 500-15-515ms | [S2,MB4,FULL_BACKWARD] 553-36-589ms | [S2,MB6,FORWARD] 597-15-613ms | [S2,MB5,FULL_BACKWARD] 646-36-682ms | [S2,MB7,FORWARD] 690-16-706ms | [S2,MB6,FULL_BACKWARD] 761-35-797ms | [S2,MB7,FULL_BACKWARD] 854-32-887ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-43-131ms | [S3,MB1,FORWARD] 138-28-167ms | [S3,MB1,FULL_BACKWARD] 178-78-257ms | [S3,MB2,FORWARD] 265-30-295ms | [S3,MB2,FULL_BACKWARD] 307-45-352ms | [S3,MB3,FORWARD] 359-30-389ms | [S3,MB3,FULL_BACKWARD] 401-45-446ms | [S3,MB4,FORWARD] 453-29-483ms | [S3,MB4,FULL_BACKWARD] 495-44-540ms | [S3,MB5,FORWARD] 550-28-579ms | [S3,MB5,FULL_BACKWARD] 591-44-635ms | [S3,MB6,FORWARD] 643-27-670ms | [S3,MB6,FULL_BACKWARD] 682-68-751ms | [S3,MB7,FORWARD] 758-30-789ms | [S3,MB7,FULL_BACKWARD] 800-45-845ms | 
[rank3]:2025-11-27 04:22:25,728 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0422_stage3_step300.svg
[rank0]:2025-11-27 04:25:41,076 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:25:44,523 - INFO - Avg. fwd time: 27.8266 / Avg. bwd time: 60.7662 / Avg. batch time: 857.9044 (ms) / GPU bubble ratio: 17.39%
[rank2]:2025-11-27 04:25:44,666 - INFO - Avg. fwd time: 15.5578 / Avg. bwd time: 32.0027 / Avg. batch time: 914.3644 (ms) / GPU bubble ratio: 58.39%
[rank0]:2025-11-27 04:25:44,747 - INFO - Avg. fwd time: 15.6000 / Avg. bwd time: 25.2679 / Avg. batch time: 1039.4966 (ms) / GPU bubble ratio: 68.55%
[rank1]:2025-11-27 04:25:44,738 - INFO - Avg. fwd time: 20.0734 / Avg. bwd time: 39.2861 / Avg. batch time: 983.4098 (ms) / GPU bubble ratio: 51.71%
[rank2]:2025-11-27 04:25:45,042 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0945  memory:  8.70GiB(18.31%)  tps: 8,212  tflops: 64.20  mfu: 20.58%
[rank0]:2025-11-27 04:25:45,061 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0945  memory: 16.95GiB(35.67%)  tps: 8,212  tflops: 64.20  mfu: 20.58%
[rank1]:2025-11-27 04:25:45,046 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0945  memory: 12.90GiB(27.16%)  tps: 8,212  tflops: 64.20  mfu: 20.58%
[rank3]:2025-11-27 04:25:45,031 - INFO -  step: 350  loss:  0.5329  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,212  tflops: 64.20  mfu: 20.58%
[rank0]:2025-11-27 04:29:00,970 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:29:04,509 - INFO - Avg. fwd time: 27.9324 / Avg. bwd time: 59.4788 / Avg. batch time: 848.7199 (ms) / GPU bubble ratio: 17.61%
[rank2]:2025-11-27 04:29:04,656 - INFO - Avg. fwd time: 15.5714 / Avg. bwd time: 31.9129 / Avg. batch time: 905.1847 (ms) / GPU bubble ratio: 58.03%
[rank0]:2025-11-27 04:29:04,737 - INFO - Avg. fwd time: 15.6107 / Avg. bwd time: 24.4183 / Avg. batch time: 1030.3539 (ms) / GPU bubble ratio: 68.92%
[rank1]:2025-11-27 04:29:04,725 - INFO - Avg. fwd time: 20.0772 / Avg. bwd time: 39.0856 / Avg. batch time: 974.2573 (ms) / GPU bubble ratio: 51.42%
[rank0]:2025-11-27 04:29:05,069 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1073  memory: 16.95GiB(35.67%)  tps: 8,192  tflops: 64.04  mfu: 20.53%
[rank1]:2025-11-27 04:29:05,055 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1073  memory: 12.90GiB(27.16%)  tps: 8,192  tflops: 64.04  mfu: 20.53%
[rank3]:2025-11-27 04:29:05,039 - INFO -  step: 400  loss:  0.5365  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,192  tflops: 64.04  mfu: 20.53%
[rank2]:2025-11-27 04:29:05,051 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1073  memory:  8.70GiB(18.31%)  tps: 8,192  tflops: 64.04  mfu: 20.53%
[rank0]:2025-11-27 04:29:05,122 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0429_stage0_step400.svg
[rank1]:2025-11-27 04:29:05,122 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0429_stage1_step400.svg
[rank2]:2025-11-27 04:29:05,121 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0429_stage2_step400.svg
[rank3]:2025-11-27 04:29:05,209 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0429_real_step400_rank3.svg
[rank3]:			> Batch Time: 976.62 ms, GPU Bubble Ratio: 71.82%, 52.82%, 61.49%, 33.93%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-51ms | [S0,MB3,FORWARD] 51-16-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-13-344ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-13-456ms | [S0,MB3,FULL_BACKWARD] 563-0-563ms | [S0,MB7,FORWARD] 563-13-576ms | [S0,MB4,FULL_BACKWARD] 660-41-701ms | [S0,MB5,FULL_BACKWARD] 749-40-789ms | [S0,MB6,FULL_BACKWARD] 858-35-894ms | [S0,MB7,FULL_BACKWARD] 943-33-976ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 296-23-320ms | [S1,MB4,FORWARD] 327-18-345ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 439-18-457ms | [S1,MB3,FULL_BACKWARD] 503-47-550ms | [S1,MB6,FORWARD] 559-19-579ms | [S1,MB4,FULL_BACKWARD] 600-47-647ms | [S1,MB7,FORWARD] 656-21-677ms | [S1,MB5,FULL_BACKWARD] 693-48-741ms | [S1,MB6,FULL_BACKWARD] 806-45-851ms | [S1,MB7,FULL_BACKWARD] 894-42-936ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-15-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-286ms | [S2,MB3,FORWARD] 293-14-307ms | [S2,MB2,FULL_BACKWARD] 362-36-399ms | [S2,MB4,FORWARD] 405-15-420ms | [S2,MB3,FULL_BACKWARD] 456-36-492ms | [S2,MB5,FORWARD] 500-15-515ms | [S2,MB4,FULL_BACKWARD] 554-36-590ms | [S2,MB6,FORWARD] 597-15-613ms | [S2,MB5,FULL_BACKWARD] 646-36-682ms | [S2,MB7,FORWARD] 690-15-706ms | [S2,MB6,FULL_BACKWARD] 763-35-799ms | [S2,MB7,FULL_BACKWARD] 855-32-888ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-42-131ms | [S3,MB1,FORWARD] 138-28-167ms | [S3,MB1,FULL_BACKWARD] 179-78-257ms | [S3,MB2,FORWARD] 264-30-295ms | [S3,MB2,FULL_BACKWARD] 307-45-352ms | [S3,MB3,FORWARD] 359-29-389ms | [S3,MB3,FULL_BACKWARD] 401-44-445ms | [S3,MB4,FORWARD] 453-29-483ms | [S3,MB4,FULL_BACKWARD] 495-44-540ms | [S3,MB5,FORWARD] 551-28-580ms | [S3,MB5,FULL_BACKWARD] 591-44-636ms | [S3,MB6,FORWARD] 643-26-670ms | [S3,MB6,FULL_BACKWARD] 682-70-753ms | [S3,MB7,FORWARD] 760-30-791ms | [S3,MB7,FULL_BACKWARD] 803-44-848ms | 
[rank3]:2025-11-27 04:29:05,256 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0429_stage3_step400.svg
[rank3]:2025-11-27 04:29:27,740 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-27 04:29:28,172 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 04:29:28,254 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-27 04:29:28,218 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 04:32:20,390 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:32:24,183 - INFO - Avg. fwd time: 28.0190 / Avg. bwd time: 58.4672 / Avg. batch time: 841.5830 (ms) / GPU bubble ratio: 17.79%
[rank2]:2025-11-27 04:32:24,225 - INFO - Avg. fwd time: 15.5772 / Avg. bwd time: 31.8453 / Avg. batch time: 898.1104 (ms) / GPU bubble ratio: 57.76%
[rank1]:2025-11-27 04:32:24,276 - INFO - Avg. fwd time: 20.0829 / Avg. bwd time: 38.9394 / Avg. batch time: 967.2053 (ms) / GPU bubble ratio: 51.18%
[rank0]:2025-11-27 04:32:24,318 - INFO - Avg. fwd time: 15.6191 / Avg. bwd time: 23.7646 / Avg. batch time: 1023.3074 (ms) / GPU bubble ratio: 69.21%
[rank3]:2025-11-27 04:32:24,329 - INFO -  step: 450  loss:  0.5407  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank2]:2025-11-27 04:32:24,339 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1086  memory:  8.70GiB(18.31%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank1]:2025-11-27 04:32:24,343 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1086  memory: 12.90GiB(27.16%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank0]:2025-11-27 04:32:24,355 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1086  memory: 16.95GiB(35.67%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank0]:2025-11-27 04:35:40,769 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:35:44,247 - INFO - Avg. fwd time: 28.0679 / Avg. bwd time: 57.8508 / Avg. batch time: 837.1522 (ms) / GPU bubble ratio: 17.89%
[rank2]:2025-11-27 04:35:44,386 - INFO - Avg. fwd time: 15.5820 / Avg. bwd time: 31.7976 / Avg. batch time: 893.6469 (ms) / GPU bubble ratio: 57.59%
[rank1]:2025-11-27 04:35:44,456 - INFO - Avg. fwd time: 20.0850 / Avg. bwd time: 38.8325 / Avg. batch time: 962.7541 (ms) / GPU bubble ratio: 51.04%
[rank0]:2025-11-27 04:35:44,466 - INFO - Avg. fwd time: 15.6231 / Avg. bwd time: 23.3078 / Avg. batch time: 1018.8544 (ms) / GPU bubble ratio: 69.43%
[rank1]:2025-11-27 04:35:44,780 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1178  memory: 12.90GiB(27.16%)  tps: 8,174  tflops: 63.90  mfu: 20.48%
[rank0]:2025-11-27 04:35:44,795 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1178  memory: 16.95GiB(35.67%)  tps: 8,174  tflops: 63.90  mfu: 20.48%
[rank3]:2025-11-27 04:35:44,765 - INFO -  step: 500  loss:  0.5278  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,174  tflops: 63.90  mfu: 20.48%
[rank2]:2025-11-27 04:35:44,777 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1178  memory:  8.70GiB(18.31%)  tps: 8,174  tflops: 63.90  mfu: 20.48%
[rank1]:2025-11-27 04:35:44,844 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0435_stage1_step500.svg
[rank0]:2025-11-27 04:35:44,844 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0435_stage0_step500.svg
[rank2]:2025-11-27 04:35:44,844 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0435_stage2_step500.svg
[rank3]:2025-11-27 04:35:44,935 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0435_real_step500_rank3.svg
[rank3]:			> Batch Time: 977.53 ms, GPU Bubble Ratio: 71.88%, 52.61%, 61.52%, 33.68%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-51ms | [S0,MB3,FORWARD] 51-16-68ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-13-344ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-13-455ms | [S0,MB3,FULL_BACKWARD] 562-0-562ms | [S0,MB7,FORWARD] 562-13-575ms | [S0,MB4,FULL_BACKWARD] 659-41-700ms | [S0,MB5,FULL_BACKWARD] 748-40-788ms | [S0,MB6,FULL_BACKWARD] 861-35-896ms | [S0,MB7,FULL_BACKWARD] 944-33-977ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 296-23-319ms | [S1,MB4,FORWARD] 326-18-345ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 438-18-457ms | [S1,MB3,FULL_BACKWARD] 501-47-548ms | [S1,MB6,FORWARD] 558-19-578ms | [S1,MB4,FULL_BACKWARD] 599-47-647ms | [S1,MB7,FORWARD] 655-20-676ms | [S1,MB5,FULL_BACKWARD] 692-49-742ms | [S1,MB6,FULL_BACKWARD] 807-45-852ms | [S1,MB7,FULL_BACKWARD] 895-42-938ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-15-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-285ms | [S2,MB3,FORWARD] 293-14-307ms | [S2,MB2,FULL_BACKWARD] 361-36-398ms | [S2,MB4,FORWARD] 405-15-420ms | [S2,MB3,FULL_BACKWARD] 455-36-491ms | [S2,MB5,FORWARD] 498-15-514ms | [S2,MB4,FULL_BACKWARD] 553-36-589ms | [S2,MB6,FORWARD] 596-15-612ms | [S2,MB5,FULL_BACKWARD] 646-36-682ms | [S2,MB7,FORWARD] 689-15-705ms | [S2,MB6,FULL_BACKWARD] 764-35-800ms | [S2,MB7,FULL_BACKWARD] 856-32-889ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-43-131ms | [S3,MB1,FORWARD] 138-28-166ms | [S3,MB1,FULL_BACKWARD] 178-78-257ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 306-44-351ms | [S3,MB3,FORWARD] 358-29-388ms | [S3,MB3,FULL_BACKWARD] 400-44-445ms | [S3,MB4,FORWARD] 452-29-482ms | [S3,MB4,FULL_BACKWARD] 494-44-539ms | [S3,MB5,FORWARD] 550-28-579ms | [S3,MB5,FULL_BACKWARD] 590-44-635ms | [S3,MB6,FORWARD] 642-26-669ms | [S3,MB6,FULL_BACKWARD] 681-73-755ms | [S3,MB7,FORWARD] 761-31-792ms | [S3,MB7,FULL_BACKWARD] 804-44-849ms | 
[rank3]:2025-11-27 04:35:44,977 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0435_stage3_step500.svg
[rank0]:2025-11-27 04:39:01,655 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:39:05,150 - INFO - Avg. fwd time: 28.1274 / Avg. bwd time: 57.2733 / Avg. batch time: 833.1358 (ms) / GPU bubble ratio: 18.00%
[rank1]:2025-11-27 04:39:05,360 - INFO - Avg. fwd time: 20.0891 / Avg. bwd time: 38.7305 / Avg. batch time: 958.7489 (ms) / GPU bubble ratio: 50.92%
[rank2]:2025-11-27 04:39:05,292 - INFO - Avg. fwd time: 15.5875 / Avg. bwd time: 31.7543 / Avg. batch time: 889.6273 (ms) / GPU bubble ratio: 57.43%
[rank0]:2025-11-27 04:39:05,371 - INFO - Avg. fwd time: 15.6287 / Avg. bwd time: 22.8855 / Avg. batch time: 1014.8534 (ms) / GPU bubble ratio: 69.64%
[rank3]:2025-11-27 04:39:05,667 - INFO -  step: 550  loss:  0.5362  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,155  tflops: 63.75  mfu: 20.43%
[rank2]:2025-11-27 04:39:05,678 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1059  memory:  8.70GiB(18.31%)  tps: 8,155  tflops: 63.75  mfu: 20.43%
[rank0]:2025-11-27 04:39:05,697 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1059  memory: 16.95GiB(35.67%)  tps: 8,155  tflops: 63.75  mfu: 20.43%
[rank1]:2025-11-27 04:39:05,682 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1059  memory: 12.90GiB(27.16%)  tps: 8,155  tflops: 63.75  mfu: 20.43%
[rank0]:2025-11-27 04:42:19,417 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:42:23,306 - INFO - Avg. fwd time: 28.1694 / Avg. bwd time: 56.6183 / Avg. batch time: 828.4294 (ms) / GPU bubble ratio: 18.12%
[rank2]:2025-11-27 04:42:23,349 - INFO - Avg. fwd time: 15.5941 / Avg. bwd time: 31.7171 / Avg. batch time: 884.9707 (ms) / GPU bubble ratio: 57.23%
[rank1]:2025-11-27 04:42:23,402 - INFO - Avg. fwd time: 20.0894 / Avg. bwd time: 38.6430 / Avg. batch time: 954.0865 (ms) / GPU bubble ratio: 50.75%
[rank3]:2025-11-27 04:42:23,456 - INFO -  step: 600  loss:  0.5393  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,284  tflops: 64.76  mfu: 20.76%
[rank0]:2025-11-27 04:42:23,445 - INFO - Avg. fwd time: 15.6327 / Avg. bwd time: 22.5343 / Avg. batch time: 1010.1960 (ms) / GPU bubble ratio: 69.77%
[rank0]:2025-11-27 04:42:23,483 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1315  memory: 16.95GiB(35.67%)  tps: 8,284  tflops: 64.76  mfu: 20.76%
[rank1]:2025-11-27 04:42:23,471 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1315  memory: 12.90GiB(27.16%)  tps: 8,284  tflops: 64.76  mfu: 20.76%
[rank1]:2025-11-27 04:42:23,533 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0442_stage1_step600.svg
[rank2]:2025-11-27 04:42:23,467 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1315  memory:  8.70GiB(18.31%)  tps: 8,284  tflops: 64.76  mfu: 20.76%
[rank2]:2025-11-27 04:42:23,532 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0442_stage2_step600.svg
[rank3]:2025-11-27 04:42:23,623 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0442_real_step600_rank3.svg
[rank3]:			> Batch Time: 960.16 ms, GPU Bubble Ratio: 71.24%, 51.79%, 60.81%, 34.69%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-51ms | [S0,MB3,FORWARD] 51-16-68ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-13-344ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-13-456ms | [S0,MB3,FULL_BACKWARD] 561-0-561ms | [S0,MB7,FORWARD] 561-13-574ms | [S0,MB4,FULL_BACKWARD] 657-41-698ms | [S0,MB5,FULL_BACKWARD] 749-40-789ms | [S0,MB6,FULL_BACKWARD] 846-36-882ms | [S0,MB7,FULL_BACKWARD] 927-33-960ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-193ms | [S1,MB3,FORWARD] 201-21-222ms | [S1,MB1,FULL_BACKWARD] 295-23-319ms | [S1,MB4,FORWARD] 326-18-345ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 438-18-457ms | [S1,MB3,FULL_BACKWARD] 501-47-548ms | [S1,MB6,FORWARD] 557-19-577ms | [S1,MB4,FULL_BACKWARD] 599-46-646ms | [S1,MB7,FORWARD] 654-20-674ms | [S1,MB5,FULL_BACKWARD] 692-49-742ms | [S1,MB6,FULL_BACKWARD] 790-47-837ms | [S1,MB7,FULL_BACKWARD] 878-42-920ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-285ms | [S2,MB3,FORWARD] 292-14-307ms | [S2,MB2,FULL_BACKWARD] 361-36-398ms | [S2,MB4,FORWARD] 404-15-419ms | [S2,MB3,FULL_BACKWARD] 455-36-491ms | [S2,MB5,FORWARD] 498-15-513ms | [S2,MB4,FULL_BACKWARD] 552-36-588ms | [S2,MB6,FORWARD] 595-15-611ms | [S2,MB5,FULL_BACKWARD] 646-36-682ms | [S2,MB7,FORWARD] 689-16-705ms | [S2,MB6,FULL_BACKWARD] 747-35-783ms | [S2,MB7,FULL_BACKWARD] 838-32-871ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-42-131ms | [S3,MB1,FORWARD] 138-28-166ms | [S3,MB1,FULL_BACKWARD] 178-78-256ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 306-44-351ms | [S3,MB3,FORWARD] 358-29-388ms | [S3,MB3,FULL_BACKWARD] 399-44-444ms | [S3,MB4,FORWARD] 451-29-481ms | [S3,MB4,FULL_BACKWARD] 493-44-538ms | [S3,MB5,FORWARD] 549-28-578ms | [S3,MB5,FULL_BACKWARD] 589-44-634ms | [S3,MB6,FORWARD] 643-28-672ms | [S3,MB6,FULL_BACKWARD] 684-53-737ms | [S3,MB7,FORWARD] 744-29-774ms | [S3,MB7,FULL_BACKWARD] 785-44-830ms | 
[rank0]:2025-11-27 04:42:23,533 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0442_stage0_step600.svg
[rank3]:2025-11-27 04:42:23,668 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0442_stage3_step600.svg
[rank0]:2025-11-27 04:45:39,123 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:45:42,609 - INFO - Avg. fwd time: 28.2040 / Avg. bwd time: 56.2046 / Avg. batch time: 825.5224 (ms) / GPU bubble ratio: 18.20%
[rank1]:2025-11-27 04:45:42,816 - INFO - Avg. fwd time: 20.0928 / Avg. bwd time: 38.5835 / Avg. batch time: 951.2087 (ms) / GPU bubble ratio: 50.65%
[rank2]:2025-11-27 04:45:42,747 - INFO - Avg. fwd time: 15.5987 / Avg. bwd time: 31.6918 / Avg. batch time: 882.0946 (ms) / GPU bubble ratio: 57.11%
[rank0]:2025-11-27 04:45:42,823 - INFO - Avg. fwd time: 15.6347 / Avg. bwd time: 22.2832 / Avg. batch time: 1007.3161 (ms) / GPU bubble ratio: 69.89%
[rank3]:2025-11-27 04:45:43,125 - INFO -  step: 650  loss:  0.5482  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank0]:2025-11-27 04:45:43,155 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1170  memory: 16.95GiB(35.67%)  tps: 8,205  tflops: 64.15  mfu: 20.56%
[rank1]:2025-11-27 04:45:43,140 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1170  memory: 12.90GiB(27.16%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank2]:2025-11-27 04:45:43,137 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1170  memory:  8.70GiB(18.31%)  tps: 8,206  tflops: 64.15  mfu: 20.56%
[rank0]:2025-11-27 04:48:57,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:49:01,088 - INFO - Avg. fwd time: 28.2258 / Avg. bwd time: 55.7911 / Avg. batch time: 822.5009 (ms) / GPU bubble ratio: 18.28%
[rank2]:2025-11-27 04:49:01,228 - INFO - Avg. fwd time: 15.6027 / Avg. bwd time: 31.6622 / Avg. batch time: 879.0781 (ms) / GPU bubble ratio: 56.99%
[rank0]:2025-11-27 04:49:01,302 - INFO - Avg. fwd time: 15.6376 / Avg. bwd time: 22.0314 / Avg. batch time: 1004.2997 (ms) / GPU bubble ratio: 69.99%
[rank1]:2025-11-27 04:49:01,297 - INFO - Avg. fwd time: 20.0918 / Avg. bwd time: 38.5164 / Avg. batch time: 948.1904 (ms) / GPU bubble ratio: 50.55%
[rank2]:2025-11-27 04:49:01,594 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0952  memory:  8.70GiB(18.31%)  tps: 8,256  tflops: 64.54  mfu: 20.69%
[rank3]:2025-11-27 04:49:01,582 - INFO -  step: 700  loss:  0.5163  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,256  tflops: 64.54  mfu: 20.69%
[rank0]:2025-11-27 04:49:01,613 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0952  memory: 16.95GiB(35.67%)  tps: 8,256  tflops: 64.54  mfu: 20.69%
[rank0]:2025-11-27 04:49:01,663 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0449_stage0_step700.svg
[rank1]:2025-11-27 04:49:01,598 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0952  memory: 12.90GiB(27.16%)  tps: 8,256  tflops: 64.54  mfu: 20.69%
[rank1]:2025-11-27 04:49:01,664 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0449_stage1_step700.svg
[rank2]:2025-11-27 04:49:01,664 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0449_stage2_step700.svg
[rank3]:2025-11-27 04:49:01,752 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0449_real_step700_rank3.svg
[rank3]:			> Batch Time: 967.62 ms, GPU Bubble Ratio: 71.12%, 52.25%, 61.13%, 35.23%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-51ms | [S0,MB3,FORWARD] 51-17-68ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-13-344ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-13-456ms | [S0,MB3,FULL_BACKWARD] 562-0-562ms | [S0,MB7,FORWARD] 562-13-575ms | [S0,MB4,FULL_BACKWARD] 658-41-699ms | [S0,MB5,FULL_BACKWARD] 749-40-789ms | [S0,MB6,FULL_BACKWARD] 850-39-890ms | [S0,MB7,FULL_BACKWARD] 934-33-967ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 43-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 296-23-319ms | [S1,MB4,FORWARD] 327-18-345ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 438-18-457ms | [S1,MB3,FULL_BACKWARD] 502-46-548ms | [S1,MB6,FORWARD] 558-20-578ms | [S1,MB4,FULL_BACKWARD] 599-46-646ms | [S1,MB7,FORWARD] 655-20-676ms | [S1,MB5,FULL_BACKWARD] 692-48-741ms | [S1,MB6,FULL_BACKWARD] 796-46-842ms | [S1,MB7,FULL_BACKWARD] 885-42-927ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-285ms | [S2,MB3,FORWARD] 293-14-307ms | [S2,MB2,FULL_BACKWARD] 361-36-397ms | [S2,MB4,FORWARD] 404-15-419ms | [S2,MB3,FULL_BACKWARD] 455-36-491ms | [S2,MB5,FORWARD] 498-15-514ms | [S2,MB4,FULL_BACKWARD] 553-36-589ms | [S2,MB6,FORWARD] 596-15-612ms | [S2,MB5,FULL_BACKWARD] 646-36-682ms | [S2,MB7,FORWARD] 689-15-705ms | [S2,MB6,FULL_BACKWARD] 753-35-789ms | [S2,MB7,FULL_BACKWARD] 845-32-878ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-43-131ms | [S3,MB1,FORWARD] 138-28-166ms | [S3,MB1,FULL_BACKWARD] 179-78-257ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 306-45-351ms | [S3,MB3,FORWARD] 358-29-387ms | [S3,MB3,FULL_BACKWARD] 400-45-445ms | [S3,MB4,FORWARD] 452-29-482ms | [S3,MB4,FULL_BACKWARD] 494-44-539ms | [S3,MB5,FORWARD] 550-28-579ms | [S3,MB5,FULL_BACKWARD] 590-44-634ms | [S3,MB6,FORWARD] 643-27-671ms | [S3,MB6,FULL_BACKWARD] 682-52-735ms | [S3,MB7,FORWARD] 750-29-780ms | [S3,MB7,FULL_BACKWARD] 792-45-837ms | 
[rank3]:2025-11-27 04:49:01,797 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0449_stage3_step700.svg
[rank0]:2025-11-27 04:52:17,945 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:52:21,795 - INFO - Avg. fwd time: 28.2532 / Avg. bwd time: 55.4749 / Avg. batch time: 820.2576 (ms) / GPU bubble ratio: 18.34%
[rank2]:2025-11-27 04:52:21,839 - INFO - Avg. fwd time: 15.6074 / Avg. bwd time: 31.6402 / Avg. batch time: 876.8620 (ms) / GPU bubble ratio: 56.89%
[rank1]:2025-11-27 04:52:21,893 - INFO - Avg. fwd time: 20.0918 / Avg. bwd time: 38.4571 / Avg. batch time: 945.9754 (ms) / GPU bubble ratio: 50.49%
[rank0]:2025-11-27 04:52:21,937 - INFO - Avg. fwd time: 15.6404 / Avg. bwd time: 21.8091 / Avg. batch time: 1002.0900 (ms) / GPU bubble ratio: 70.10%
[rank2]:2025-11-27 04:52:21,958 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1388  memory:  8.70GiB(18.31%)  tps: 8,177  tflops: 63.92  mfu: 20.49%
[rank1]:2025-11-27 04:52:21,962 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1388  memory: 12.90GiB(27.16%)  tps: 8,177  tflops: 63.93  mfu: 20.49%
[rank0]:2025-11-27 04:52:21,974 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1388  memory: 16.95GiB(35.67%)  tps: 8,177  tflops: 63.93  mfu: 20.49%
[rank3]:2025-11-27 04:52:21,947 - INFO -  step: 750  loss:  0.5470  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,177  tflops: 63.93  mfu: 20.49%
[rank0]:2025-11-27 04:55:37,734 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 04:55:41,286 - INFO - Avg. fwd time: 28.2724 / Avg. bwd time: 55.2270 / Avg. batch time: 818.4840 (ms) / GPU bubble ratio: 18.39%
[rank2]:2025-11-27 04:55:41,433 - INFO - Avg. fwd time: 15.6107 / Avg. bwd time: 31.6228 / Avg. batch time: 875.0852 (ms) / GPU bubble ratio: 56.82%
[rank1]:2025-11-27 04:55:41,504 - INFO - Avg. fwd time: 20.0930 / Avg. bwd time: 38.4116 / Avg. batch time: 944.1965 (ms) / GPU bubble ratio: 50.43%
[rank0]:2025-11-27 04:55:41,516 - INFO - Avg. fwd time: 15.6423 / Avg. bwd time: 21.6454 / Avg. batch time: 1000.3139 (ms) / GPU bubble ratio: 70.18%
[rank2]:2025-11-27 04:55:41,828 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1327  memory:  8.70GiB(18.31%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank2]:2025-11-27 04:55:41,828 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1327  tps: 8,456  tflops: 66.11  mfu: 19.32%
[rank2]:2025-11-27 04:55:41,828 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-27 04:55:41,829 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank0]:2025-11-27 04:55:41,846 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1327  memory: 16.95GiB(35.67%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank0]:2025-11-27 04:55:41,846 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1327  tps: 8,456  tflops: 66.11  mfu: 19.32%
[rank0]:2025-11-27 04:55:41,847 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-27 04:55:41,847 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank1]:2025-11-27 04:55:41,831 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1327  memory: 12.90GiB(27.16%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank1]:2025-11-27 04:55:41,832 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1327  tps: 8,456  tflops: 66.11  mfu: 19.32%
[rank1]:2025-11-27 04:55:41,832 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-27 04:55:41,832 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-11-27 04:55:41,816 - INFO -  step: 800  loss:  0.5498  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank3]:2025-11-27 04:55:41,817 - INFO -  final step: 800  loss:  0.5498  grad_norm:  0.0000  tps: 8,463  tflops: 66.16  mfu: 19.47%
[rank3]:2025-11-27 04:55:41,817 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-27 04:55:41,818 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-11-27 04:55:43,862 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-27 04:55:43,924 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_0455_stage2_final800.svg
[rank0]:2025-11-27 04:55:43,924 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_0455_stage0_final800.svg
[rank1]:2025-11-27 04:55:43,924 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_0455_stage1_final800.svg
[rank3]:2025-11-27 04:55:44,009 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0455_real_final800_rank3.svg
[rank3]:			> Batch Time: 974.66 ms, GPU Bubble Ratio: 71.38%, 52.72%, 61.42%, 33.81%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 205-0-205ms | [S0,MB4,FORWARD] 205-15-220ms | [S0,MB1,FULL_BACKWARD] 331-0-331ms | [S0,MB5,FORWARD] 331-13-345ms | [S0,MB2,FULL_BACKWARD] 443-0-443ms | [S0,MB6,FORWARD] 443-13-457ms | [S0,MB3,FULL_BACKWARD] 564-0-564ms | [S0,MB7,FORWARD] 564-13-578ms | [S0,MB4,FULL_BACKWARD] 661-41-702ms | [S0,MB5,FULL_BACKWARD] 751-40-791ms | [S0,MB6,FULL_BACKWARD] 857-39-896ms | [S0,MB7,FULL_BACKWARD] 941-33-974ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 171-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 297-23-320ms | [S1,MB4,FORWARD] 328-18-347ms | [S1,MB2,FULL_BACKWARD] 409-23-432ms | [S1,MB5,FORWARD] 439-18-458ms | [S1,MB3,FULL_BACKWARD] 503-46-550ms | [S1,MB6,FORWARD] 560-19-580ms | [S1,MB4,FULL_BACKWARD] 601-46-648ms | [S1,MB7,FORWARD] 657-20-678ms | [S1,MB5,FULL_BACKWARD] 695-47-743ms | [S1,MB6,FULL_BACKWARD] 803-45-849ms | [S1,MB7,FULL_BACKWARD] 892-42-934ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-15-79ms | [S2,MB0,FULL_BACKWARD] 142-18-160ms | [S2,MB2,FORWARD] 167-16-184ms | [S2,MB1,FULL_BACKWARD] 268-18-287ms | [S2,MB3,FORWARD] 294-14-308ms | [S2,MB2,FULL_BACKWARD] 362-36-399ms | [S2,MB4,FORWARD] 406-15-421ms | [S2,MB3,FULL_BACKWARD] 457-36-493ms | [S2,MB5,FORWARD] 500-15-516ms | [S2,MB4,FULL_BACKWARD] 555-36-591ms | [S2,MB6,FORWARD] 598-15-614ms | [S2,MB5,FULL_BACKWARD] 648-36-684ms | [S2,MB7,FORWARD] 692-15-708ms | [S2,MB6,FULL_BACKWARD] 760-35-796ms | [S2,MB7,FULL_BACKWARD] 852-32-885ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-43-131ms | [S3,MB1,FORWARD] 139-28-167ms | [S3,MB1,FULL_BACKWARD] 179-78-258ms | [S3,MB2,FORWARD] 265-30-295ms | [S3,MB2,FULL_BACKWARD] 307-45-352ms | [S3,MB3,FORWARD] 359-29-389ms | [S3,MB3,FULL_BACKWARD] 401-45-447ms | [S3,MB4,FORWARD] 454-29-484ms | [S3,MB4,FULL_BACKWARD] 496-45-541ms | [S3,MB5,FORWARD] 552-28-580ms | [S3,MB5,FULL_BACKWARD] 592-44-637ms | [S3,MB6,FORWARD] 645-27-673ms | [S3,MB6,FULL_BACKWARD] 685-69-755ms | [S3,MB7,FORWARD] 757-30-787ms | [S3,MB7,FULL_BACKWARD] 800-45-845ms | 
[rank0]:2025-11-27 04:55:44,082 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0455_rank0_stage0.svg
[rank0]:	> Counts Sum: 719400, Total Sum: 864320 (83.23%), Ratio(%) per element: [81.33, 80.3, 80.47, 81.84, 82.02, 81.5, 80.99, 82.36, 82.53, 81.5, 81.84, 81.84, 83.04, 82.53, 82.19, 82.7, 83.56, 82.36, 82.53, 83.21, 83.56, 84.41, 83.39, 83.39, 84.24, 83.9, 84.24, 84.41, 85.27, 84.58, 85.61, 84.93, 85.1, 85.44, 85.1, 85.27, 85.95]
[rank0]:2025-11-27 04:55:44,082 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-27 04:55:44,077 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0455_rank1_stage1.svg
[rank1]:	> Counts Sum: 901200, Total Sum: 1051200 (85.73%), Ratio(%) per element: [85.61, 85.78, 85.78, 85.27, 86.47, 85.61, 85.44, 85.78, 85.78, 85.61, 85.78, 86.13, 85.78, 85.61, 85.61, 85.78, 85.78, 85.61, 85.61, 85.44, 85.78, 85.95, 85.95, 85.78, 85.61, 85.27, 86.13, 85.61, 85.78, 85.27, 85.61, 85.61, 85.44, 85.78, 85.61, 85.78, 85.61, 85.95, 85.61, 85.95, 86.13, 85.78, 85.78, 85.44, 86.13]
[rank1]:2025-11-27 04:55:44,077 - INFO - Destroying the purge thread.
[rank2]:2025-11-27 04:55:44,081 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0455_rank2_stage2.svg
[rank2]:	> Counts Sum: 720960, Total Sum: 840960 (85.73%), Ratio(%) per element: [85.78, 85.78, 85.44, 85.27, 86.13, 85.78, 85.44, 85.44, 86.13, 85.61, 85.78, 85.78, 86.13, 85.78, 85.78, 85.78, 85.78, 85.78, 85.44, 85.61, 85.1, 86.13, 85.78, 85.61, 85.95, 85.44, 85.95, 85.78, 85.78, 85.44, 85.78, 85.78, 85.95, 85.78, 85.61, 85.78]
[rank2]:2025-11-27 04:55:44,081 - INFO - Destroying the purge thread.
[rank3]:2025-11-27 04:55:44,143 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0455_thry_final800_rank3.svg
[rank3]:			> Batch Time: 658.48 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-19-19ms | [S0,MB1,FORWARD] 19-19-39ms | [S0,MB2,FORWARD] 39-19-59ms | [S0,MB3,FORWARD] 59-19-79ms | [S0,MB0,FULL_BACKWARD] 199-39-239ms | [S0,MB4,FORWARD] 239-19-259ms | [S0,MB1,FULL_BACKWARD] 259-39-299ms | [S0,MB5,FORWARD] 299-19-319ms | [S0,MB2,FULL_BACKWARD] 319-39-359ms | [S0,MB6,FORWARD] 359-19-379ms | [S0,MB3,FULL_BACKWARD] 379-39-419ms | [S0,MB7,FORWARD] 419-19-438ms | [S0,MB4,FULL_BACKWARD] 438-39-478ms | [S0,MB5,FULL_BACKWARD] 498-39-538ms | [S0,MB6,FULL_BACKWARD] 558-39-598ms | [S0,MB7,FULL_BACKWARD] 618-39-658ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 19-19-39ms | [S1,MB1,FORWARD] 39-19-59ms | [S1,MB2,FORWARD] 59-19-79ms | [S1,MB0,FULL_BACKWARD] 159-39-199ms | [S1,MB3,FORWARD] 199-19-219ms | [S1,MB1,FULL_BACKWARD] 219-39-259ms | [S1,MB4,FORWARD] 259-19-279ms | [S1,MB2,FULL_BACKWARD] 279-39-319ms | [S1,MB5,FORWARD] 319-19-339ms | [S1,MB3,FULL_BACKWARD] 339-39-379ms | [S1,MB6,FORWARD] 379-19-399ms | [S1,MB4,FULL_BACKWARD] 399-39-438ms | [S1,MB7,FORWARD] 438-19-458ms | [S1,MB5,FULL_BACKWARD] 458-39-498ms | [S1,MB6,FULL_BACKWARD] 518-39-558ms | [S1,MB7,FULL_BACKWARD] 578-39-618ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 39-19-59ms | [S2,MB1,FORWARD] 59-19-79ms | [S2,MB0,FULL_BACKWARD] 119-39-159ms | [S2,MB2,FORWARD] 159-19-179ms | [S2,MB1,FULL_BACKWARD] 179-39-219ms | [S2,MB3,FORWARD] 219-19-239ms | [S2,MB2,FULL_BACKWARD] 239-39-279ms | [S2,MB4,FORWARD] 279-19-299ms | [S2,MB3,FULL_BACKWARD] 299-39-339ms | [S2,MB5,FORWARD] 339-19-359ms | [S2,MB4,FULL_BACKWARD] 359-39-399ms | [S2,MB6,FORWARD] 399-19-419ms | [S2,MB5,FULL_BACKWARD] 419-39-458ms | [S2,MB7,FORWARD] 458-19-478ms | [S2,MB6,FULL_BACKWARD] 478-39-518ms | [S2,MB7,FULL_BACKWARD] 538-39-578ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 59-19-79ms | [S3,MB0,FULL_BACKWARD] 79-39-119ms | [S3,MB1,FORWARD] 119-19-139ms | [S3,MB1,FULL_BACKWARD] 139-39-179ms | [S3,MB2,FORWARD] 179-19-199ms | [S3,MB2,FULL_BACKWARD] 199-39-239ms | [S3,MB3,FORWARD] 239-19-259ms | [S3,MB3,FULL_BACKWARD] 259-39-299ms | [S3,MB4,FORWARD] 299-19-319ms | [S3,MB4,FULL_BACKWARD] 319-39-359ms | [S3,MB5,FORWARD] 359-19-379ms | [S3,MB5,FULL_BACKWARD] 379-39-419ms | [S3,MB6,FORWARD] 419-19-438ms | [S3,MB6,FULL_BACKWARD] 438-39-478ms | [S3,MB7,FORWARD] 478-19-498ms | [S3,MB7,FULL_BACKWARD] 498-39-538ms | 
[rank3]:2025-11-27 04:55:44,189 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_0455_stage3_final800.svg
[rank1]:2025-11-27 04:55:44,400 - INFO - Process group destroyed
[rank3]:2025-11-27 04:55:44,322 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0455_rank3_stage3.svg
[rank3]:	> Counts Sum: 158800, Total Sum: 677440 (23.44%), Ratio(%) per element: [24.14, 23.28, 25.0, 23.45, 22.94, 22.6, 24.65, 24.14, 23.45, 23.97, 21.91, 23.97, 22.08, 24.82, 24.65, 23.97, 21.4, 23.11, 23.63, 23.63, 22.43, 22.94, 23.8, 21.91, 22.77, 23.63, 23.63, 25.17, 22.6]
[rank3]:2025-11-27 04:55:44,322 - INFO - Destroying the purge thread.
[rank2]:2025-11-27 04:55:44,403 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 300-322
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‡â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.87174
[rank3]:wandb:               final/avg_loss 0.54976
[rank3]:wandb:             final/avg_mfu(%) 19.47369
[rank3]:wandb:             final/avg_tflops 66.16282
[rank3]:wandb:    final/avg_throughput(tps) 8463.38101
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.54976
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.54976
[rank3]:wandb: loss_metrics/global_max_loss 0.54976
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_1F1B_fullrand7_42_forfun_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/skhi51bd
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1/20251127-0400/wandb/run-20251127_040049-skhi51bd/logs
[rank3]:2025-11-27 04:55:45,895 - INFO - Process group destroyed
[rank0]:2025-11-27 04:55:46,083 - INFO - Training completed
[rank0]:2025-11-27 04:55:46,083 - INFO - Destroying the purge thread.
[rank0]:2025-11-27 04:55:46,433 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.7', 'layers.5', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.2', 'layers.0', 'layers.3', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.13', 'layers.14', 'layers.15', 'norm'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
