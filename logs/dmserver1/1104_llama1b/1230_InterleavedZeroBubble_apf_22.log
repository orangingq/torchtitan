
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 11:11:49 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_InterleavedZeroBubble_apf_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with apf x InterleavedZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-31 11:11:56,144 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank2]:2025-12-31 11:11:56,146 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-31 11:11:56,343 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank3]:2025-12-31 11:11:56,377 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank0]:2025-12-31 11:11:56,416 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 11:11:56,419 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 11:11:56,422 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 11:11:56,423 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-31 11:11:56,389 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 11:11:56,391 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-31 11:11:56,614 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 11:11:56,617 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-31 11:11:56,595 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 11:11:56,598 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 11:11:56,816 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-31 11:12:00,084 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-31 11:12:00,139 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 11:12:00,236 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 11:12:00,156 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 11:12:00,193 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 11:12:00,220 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-31 11:12:00,233 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-31 11:12:00,236 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-31 11:12:00,180 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 11:12:00,207 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-31 11:12:00,219 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-31 11:12:00,221 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-31 11:12:00,275 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 11:12:00,276 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 11:12:00,302 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-31 11:12:00,315 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-31 11:12:00,317 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-31 11:12:00,472 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 11:12:00,473 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 11:12:00,474 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-31 11:12:00,470 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 11:12:00,470 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 11:12:00,471 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-31 11:12:00,567 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 11:12:00,567 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 11:12:00,568 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ibz616tc
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_apf_22_dm1/20251231-1112/wandb/run-20251231_111203-ibz616tc
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ibz616tc
[rank3]:2025-12-31 11:12:05,066 - WandB logging enabled
[rank3]:2025-12-31 11:12:05,068 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 11:12:05,108 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 11:12:05,134 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-31 11:12:05,147 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-31 11:12:05,150 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-31 11:12:05,344 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 11:12:05,345 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 11:12:05,346 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank2]:2025-12-31 11:12:05,364 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 11:12:05,364 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_InterleavedZeroBubble_apf_22_dm1
[rank0]:2025-12-31 11:12:05,364 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 11:12:05,364 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 11:12:05,365 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-31 11:12:05,364 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-31 11:12:05,363 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 11:12:07,836 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 11:12:07,837 - Finished loading the checkpoint in 2.47 seconds.
[rank0]:2025-12-31 11:12:07,837 - Training starts at step 1
[rank3]:2025-12-31 11:12:13,165 -  step:  1  loss: 10.6092  grad_norm: 203.0660  memory: 34.21GiB(72.01%)  tps: 4,068  tflops: 31.80  mfu: 10.19%
[rank3]:2025-12-31 11:12:13,166 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 11:12:13,168 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 14.00GiB(29.46%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank0]:2025-12-31 11:12:13,169 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 11:12:13,138 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 12.75GiB(26.83%)  tps: 2,529  tflops: 19.77  mfu: 6.34%
[rank2]:2025-12-31 11:12:13,138 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-31 11:12:13,168 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 16.75GiB(35.27%)  tps: 2,526  tflops: 19.74  mfu: 6.33%
[rank1]:2025-12-31 11:12:13,169 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 11:15:59,031 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 11:16:03,673 - Avg. fwd time: 7.3381 / Avg. bwd-weight time: 10.2616 / Avg. bwd-input time: 9.4074 / Avg. batch time: 1103.7079 (ms) / GPU bubble ratio: 60.85%
[rank2]:2025-12-31 11:16:03,720 -  step: 50  loss: -4.0000  grad_norm: 24.1663  memory: 14.56GiB(30.65%)  tps: 6,963  tflops: 54.44  mfu: 17.45%
[rank0]:2025-12-31 11:16:03,688 - Avg. fwd time: 7.9423 / Avg. full-bwd time: 23.8563 (Avg. bwd-weight time: 9.7301 / Avg. bwd-input time: 9.6735) / Avg. batch time: 1146.9426 (ms) / GPU bubble ratio: 58.75%
[rank0]:2025-12-31 11:16:03,734 -  step: 50  loss: -4.0000  grad_norm: 24.1663  memory: 17.77GiB(37.40%)  tps: 6,964  tflops: 54.44  mfu: 17.45%
[rank3]:2025-12-31 11:16:03,677 - Avg. fwd time: 12.5574 / Avg. bwd-weight time: 20.0449 / Avg. bwd-input time: 22.5107 / Avg. batch time: 1097.0820 (ms) / GPU bubble ratio: 19.62%
[rank3]:2025-12-31 11:16:03,732 -  step: 50  loss:  9.8858  grad_norm: 24.1663  memory: 37.14GiB(78.18%)  tps: 6,964  tflops: 54.44  mfu: 17.45%
[rank1]:2025-12-31 11:16:03,694 - Avg. fwd time: 9.4134 / Avg. bwd-weight time: 12.5625 / Avg. bwd-input time: 12.0140 / Avg. batch time: 1138.2721 (ms) / GPU bubble ratio: 52.22%
[rank1]:2025-12-31 11:16:03,725 -  step: 50  loss: -4.0000  grad_norm: 24.1663  memory: 19.02GiB(40.04%)  tps: 6,964  tflops: 54.44  mfu: 17.45%
[rank3]:2025-12-31 11:16:45,799 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:16:46,063 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:16:46,081 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:16:46,084 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:17:33,199 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:17:33,188 - Freezing Ratio: [Stage2] 0.83, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:17:33,215 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:17:33,212 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:18:12,202 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:18:12,174 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:18:12,178 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:18:12,191 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:18:59,501 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:18:59,510 - Freezing Ratio: [Stage1] 0.81, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:18:59,531 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:18:59,528 - Freezing Ratio: [Stage3] 0.83, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:19:38,360 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:19:38,386 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:19:38,388 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:19:38,369 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:19:38,376 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:19:42,249 - Avg. fwd time: 8.0943 / Avg. full-bwd time: 20.9633 (Avg. bwd-weight time: 7.6973 / Avg. bwd-input time: 9.6850) / Avg. batch time: 1107.3052 (ms) / GPU bubble ratio: 60.60%
[rank0]:2025-12-31 11:19:42,252 -  step: 100  loss: -4.0000  grad_norm:  0.0870  memory: 20.62GiB(43.40%)  tps: 7,498  tflops: 58.61  mfu: 18.79%
[rank2]:2025-12-31 11:19:42,217 - Avg. fwd time: 7.4928 / Avg. bwd-weight time: 8.1264 / Avg. bwd-input time: 9.4529 / Avg. batch time: 1060.3796 (ms) / GPU bubble ratio: 62.17%
[rank2]:2025-12-31 11:19:42,251 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 7,497  tflops: 58.61  mfu: 18.79%
[rank3]:2025-12-31 11:19:42,181 - Avg. fwd time: 12.4349 / Avg. bwd-weight time: 15.8888 / Avg. bwd-input time: 22.4772 / Avg. batch time: 1045.4678 (ms) / GPU bubble ratio: 22.25%
[rank3]:2025-12-31 11:19:42,252 -  step: 100  loss:  9.0192  grad_norm:  0.0000  memory: 39.09GiB(82.29%)  tps: 7,498  tflops: 58.61  mfu: 18.79%
[rank1]:2025-12-31 11:19:42,238 - Avg. fwd time: 9.6019 / Avg. bwd-weight time: 9.9476 / Avg. bwd-input time: 12.0565 / Avg. batch time: 1095.4013 (ms) / GPU bubble ratio: 53.83%
[rank1]:2025-12-31 11:19:42,251 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 7,498  tflops: 58.61  mfu: 18.79%
[rank0]:2025-12-31 11:19:42,322 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1119_stage0_step100.svg
[rank2]:2025-12-31 11:19:42,323 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1119_stage2_step100.svg
[rank1]:2025-12-31 11:19:42,330 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1119_stage1_step100.svg
[rank1]:2025-12-31 11:19:42,373 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1119_stage5_step100.svg
[rank0]:2025-12-31 11:19:42,367 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1119_stage4_step100.svg
[rank2]:2025-12-31 11:19:42,368 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1119_stage6_step100.svg
[rank0]:2025-12-31 11:19:42,475 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank0_stage0.svg
[rank0]:	> Counts Sum: 46, Total Sum: 95 (48.42%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0]
[rank2]:2025-12-31 11:19:42,473 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank2_stage2.svg
[rank2]:	> Counts Sum: 43, Total Sum: 90 (47.78%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0]
[rank3]:2025-12-31 11:19:42,570 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1119_step100_rank3.svg
[rank3]:			> Batch Time: 952.34 ms, GPU Bubble Ratio: 68.91%, 62.41%, 70.41%, 42.77%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-138ms    | [S4,MB3,F]  169-9-178ms    | [S4,MB0,BI] 282-9-291ms    | [S4,MB0,BW] 291-0-291ms    | [S0,MB4,F]  292-8-300ms    | [S4,MB1,BI] 343-10-353ms   | [S4,MB1,BW] 353-0-353ms    | [S0,MB5,F]  353-8-362ms    | [S4,MB2,BI] 419-10-429ms   | [S4,MB2,BW] 429-0-429ms    | [S0,MB6,F]  430-8-438ms    | [S4,MB3,BI] 473-9-483ms    | [S4,MB3,BW] 483-0-483ms    | [S0,MB7,F]  483-8-491ms    | [S0,MB0,B]  512-11-523ms   | [S4,MB4,F]  523-8-531ms    | [S0,MB1,B]  547-10-557ms   | [S4,MB5,F]  557-8-565ms    | [S0,MB2,B]  577-10-588ms   | [S4,MB6,F]  588-8-596ms    | [S0,MB3,B]  608-10-618ms   | [S4,MB7,F]  619-8-627ms    | [S4,MB4,BI] 662-10-672ms   | [S4,MB4,BW] 673-0-673ms    | [S4,MB5,BI] 745-9-754ms    | [S4,MB5,BW] 755-0-755ms    | [S4,MB6,BI] 794-9-803ms    | [S4,MB6,BW] 803-0-803ms    | [S4,MB7,BI] 858-9-867ms    | [S4,MB7,BW] 867-0-867ms    | [S0,MB4,B]  878-9-887ms    | [S0,MB5,B]  903-9-912ms    | [S0,MB6,B]  923-9-932ms    | [S0,MB7,B]  943-9-952ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  48-11-60ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  197-7-205ms    | [S5,MB0,BI] 266-9-275ms    | [S5,MB3,F]  275-9-285ms    | [S5,MB1,BI] 327-9-336ms    | [S5,MB0,BW] 336-0-336ms    | [S1,MB4,F]  344-12-356ms   | [S5,MB2,BI] 389-10-399ms   | [S5,MB1,BW] 399-0-399ms    | [S1,MB5,F]  418-12-430ms   | [S5,MB3,BI] 453-11-465ms   | [S5,MB2,BW] 465-0-465ms    | [S1,MB6,F]  475-12-487ms   | [S1,MB0,BI] 488-15-504ms   | [S5,MB3,BW] 504-0-504ms    | [S1,MB7,F]  512-12-525ms   | [S1,MB1,BI] 525-15-540ms   | [S1,MB0,BW] 540-0-540ms    | [S5,MB4,F]  547-8-555ms    | [S1,MB2,BI] 555-15-570ms   | [S1,MB1,BW] 571-0-571ms    | [S5,MB5,F]  578-8-586ms    | [S1,MB3,BI] 586-15-601ms   | [S1,MB2,BW] 602-0-602ms    | [S5,MB6,F]  608-8-616ms    | [S5,MB4,BI] 646-10-656ms   | [S1,MB3,BW] 656-0-656ms    | [S5,MB7,F]  662-8-670ms    | [S5,MB5,BI] 712-10-722ms   | [S5,MB4,BW] 722-0-722ms    | [S5,MB6,BI] 778-9-787ms    | [S5,MB5,BW] 787-0-787ms    | [S5,MB7,BI] 843-9-852ms    | [S5,MB6,BW] 852-0-852ms    | [S1,MB4,BI] 858-13-872ms   | [S5,MB7,BW] 872-0-872ms    | [S1,MB5,BI] 883-13-897ms   | [S1,MB4,BW] 897-0-897ms    | [S1,MB6,BI] 903-13-916ms   | [S1,MB5,BW] 916-0-916ms    | [S1,MB7,BI] 922-13-936ms   | [S1,MB6,BW] 936-0-936ms    | [S1,MB7,BW] 936-0-936ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-148ms    | [S6,MB0,F]  177-7-184ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB0,BI] 250-9-259ms    | [S6,MB2,F]  259-9-268ms    | [S6,MB1,BI] 311-9-320ms    | [S6,MB3,F]  320-9-329ms    | [S6,MB2,BI] 374-8-383ms    | [S6,MB0,BW] 383-0-383ms    | [S2,MB4,F]  390-7-398ms    | [S6,MB3,BI] 437-9-447ms    | [S6,MB1,BW] 447-0-447ms    | [S2,MB5,F]  456-7-464ms    | [S2,MB0,BI] 471-10-481ms   | [S6,MB2,BW] 481-0-481ms    | [S2,MB6,F]  491-8-499ms    | [S2,MB1,BI] 500-11-511ms   | [S6,MB3,BW] 511-0-511ms    | [S2,MB7,F]  526-8-534ms    | [S2,MB2,BI] 534-10-544ms   | [S2,MB0,BW] 544-0-544ms    | [S6,MB4,F]  556-8-564ms    | [S2,MB3,BI] 565-10-575ms   | [S2,MB1,BW] 575-0-575ms    | [S6,MB5,F]  587-7-594ms    | [S6,MB4,BI] 630-9-639ms    | [S2,MB2,BW] 640-0-640ms    | [S6,MB6,F]  646-7-654ms    | [S6,MB5,BI] 696-9-705ms    | [S2,MB3,BW] 706-0-706ms    | [S6,MB7,F]  712-7-720ms    | [S6,MB6,BI] 762-9-772ms    | [S6,MB4,BW] 772-0-772ms    | [S6,MB7,BI] 828-8-836ms    | [S6,MB5,BW] 837-0-837ms    | [S2,MB4,BI] 843-8-852ms    | [S6,MB6,BW] 852-0-852ms    | [S2,MB5,BI] 868-8-877ms    | [S6,MB7,BW] 877-0-877ms    | [S2,MB6,BI] 883-8-892ms    | [S2,MB4,BW] 892-0-892ms    | [S2,MB7,BI] 903-8-911ms    | [S2,MB5,BW] 912-0-912ms    | [S2,MB6,BW] 912-0-912ms    | [S2,MB7,BW] 912-0-912ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  148-7-156ms    | [S7,MB0,F]  185-15-200ms   | [S7,MB0,BI] 212-32-244ms   | [S7,MB1,F]  244-15-259ms   | [S7,MB1,BI] 271-32-304ms   | [S7,MB2,F]  304-17-321ms   | [S7,MB2,BI] 333-33-366ms   | [S7,MB3,F]  367-17-384ms   | [S7,MB3,BI] 397-33-430ms   | [S7,MB0,BW] 431-0-431ms    | [S3,MB4,F]  439-9-448ms    | [S3,MB0,BI] 450-12-462ms   | [S7,MB1,BW] 462-0-462ms    | [S3,MB5,F]  472-8-480ms    | [S3,MB1,BI] 480-12-493ms   | [S7,MB2,BW] 493-0-493ms    | [S3,MB6,F]  502-8-510ms    | [S3,MB2,BI] 510-10-521ms   | [S7,MB3,BW] 521-0-521ms    | [S3,MB7,F]  535-8-543ms    | [S3,MB3,BI] 543-10-554ms   | [S3,MB0,BW] 553-0-553ms    | [S7,MB4,F]  565-13-579ms   | [S7,MB4,BI] 591-32-623ms   | [S3,MB1,BW] 623-0-623ms    | [S7,MB5,F]  630-15-646ms   | [S7,MB5,BI] 657-32-689ms   | [S3,MB2,BW] 689-0-689ms    | [S7,MB6,F]  696-14-710ms   | [S7,MB6,BI] 723-32-756ms   | [S3,MB3,BW] 756-0-756ms    | [S7,MB7,F]  763-14-777ms   | [S7,MB7,BI] 789-32-821ms   | [S7,MB4,BW] 821-0-821ms    | [S3,MB4,BI] 821-11-832ms   | [S7,MB5,BW] 832-0-832ms    | [S3,MB5,BI] 832-12-844ms   | [S7,MB6,BW] 844-0-844ms    | [S3,MB6,BI] 844-11-855ms   | [S7,MB7,BW] 855-0-855ms    | [S3,MB7,BI] 861-12-873ms   | [S3,MB4,BW] 873-0-873ms    | [S3,MB5,BW] 873-0-873ms    | [S3,MB6,BW] 873-0-873ms    | [S3,MB7,BW] 873-0-873ms   
[rank1]:2025-12-31 11:19:42,500 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank1_stage1.svg
[rank1]:	> Counts Sum: 64, Total Sum: 135 (47.41%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank0]:2025-12-31 11:19:42,575 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank0_stage4.svg
[rank0]:	> Counts Sum: 42, Total Sum: 90 (46.67%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank2]:2025-12-31 11:19:42,575 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank2_stage6.svg
[rank2]:	> Counts Sum: 42, Total Sum: 90 (46.67%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank3]:2025-12-31 11:19:42,611 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1119_stage3_step100.svg
[rank3]:2025-12-31 11:19:42,651 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1119_stage7_step100.svg
[rank1]:2025-12-31 11:19:42,599 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank1_stage5.svg
[rank1]:	> Counts Sum: 42, Total Sum: 90 (46.67%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank3]:2025-12-31 11:19:42,751 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank3_stage3.svg
[rank3]:	> Counts Sum: 43, Total Sum: 90 (47.78%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 20.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank3]:2025-12-31 11:19:42,830 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1119_rank3_stage7.svg
[rank3]:	> Counts Sum: 21, Total Sum: 55 (38.18%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 11:20:17,786 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:20:17,790 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:20:17,803 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:20:17,814 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:21:05,149 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:21:05,176 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:21:05,161 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:21:05,180 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:21:44,125 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:21:44,121 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:21:44,149 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:21:44,138 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:22:22,972 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:22:22,999 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:22:22,976 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:22:22,989 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:23:01,804 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 11:23:01,806 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:23:01,796 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:23:01,777 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:23:01,796 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:23:06,505 - Avg. fwd time: 8.2363 / Avg. full-bwd time: 18.3385 (Avg. bwd-weight time: 5.8490 / Avg. bwd-input time: 9.6872) / Avg. batch time: 1071.0787 (ms) / GPU bubble ratio: 62.40%
[rank3]:2025-12-31 11:23:06,495 - Avg. fwd time: 12.3270 / Avg. bwd-weight time: 12.0797 / Avg. bwd-input time: 22.4256 / Avg. batch time: 997.8993 (ms) / GPU bubble ratio: 24.91%
[rank2]:2025-12-31 11:23:06,490 - Avg. fwd time: 7.6378 / Avg. bwd-weight time: 6.1760 / Avg. bwd-input time: 9.4864 / Avg. batch time: 1020.7309 (ms) / GPU bubble ratio: 63.48%
[rank2]:2025-12-31 11:23:06,537 -  step: 150  loss: -4.0000  grad_norm: 20.1064  memory: 15.48GiB(32.59%)  tps: 8,020  tflops: 62.70  mfu: 20.10%
[rank1]:2025-12-31 11:23:06,509 - Avg. fwd time: 9.7732 / Avg. bwd-weight time: 7.5600 / Avg. bwd-input time: 12.0841 / Avg. batch time: 1056.1946 (ms) / GPU bubble ratio: 55.44%
[rank1]:2025-12-31 11:23:06,542 -  step: 150  loss: -4.0000  grad_norm: 20.1064  memory: 20.17GiB(42.46%)  tps: 8,020  tflops: 62.70  mfu: 20.09%
[rank0]:2025-12-31 11:23:06,551 -  step: 150  loss: -4.0000  grad_norm: 20.1064  memory: 20.85GiB(43.89%)  tps: 8,020  tflops: 62.69  mfu: 20.09%
[rank3]:2025-12-31 11:23:06,550 -  step: 150  loss:  6.6330  grad_norm: 20.1064  memory: 39.09GiB(82.29%)  tps: 8,020  tflops: 62.69  mfu: 20.09%
[rank2]:2025-12-31 11:23:48,991 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:23:49,000 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:23:49,020 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:23:49,018 - Freezing Ratio: [Stage3] 0.83, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:24:27,900 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:24:27,876 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:24:27,872 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:24:27,889 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:25:06,687 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:25:06,704 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:25:06,715 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:25:06,691 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:25:45,546 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:25:45,542 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:25:45,559 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:25:45,571 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:26:24,399 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:26:24,416 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:26:24,426 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:26:24,428 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:26:24,408 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:26:29,163 - Avg. fwd time: 8.3106 / Avg. full-bwd time: 16.9572 (Avg. bwd-weight time: 4.8756 / Avg. bwd-input time: 9.6861) / Avg. batch time: 1051.2047 (ms) / GPU bubble ratio: 63.36%
[rank3]:2025-12-31 11:26:29,153 - Avg. fwd time: 12.2489 / Avg. bwd-weight time: 10.0708 / Avg. bwd-input time: 22.3837 / Avg. batch time: 972.3215 (ms) / GPU bubble ratio: 26.44%
[rank2]:2025-12-31 11:26:29,149 - Avg. fwd time: 7.7138 / Avg. bwd-weight time: 5.1490 / Avg. bwd-input time: 9.5031 / Avg. batch time: 999.0741 (ms) / GPU bubble ratio: 64.18%
[rank2]:2025-12-31 11:26:29,195 -  step: 200  loss: -4.0000  grad_norm: 25.2189  memory: 15.48GiB(32.59%)  tps: 8,085  tflops: 63.20  mfu: 20.26%
[rank1]:2025-12-31 11:26:29,168 - Avg. fwd time: 9.8602 / Avg. bwd-weight time: 6.3024 / Avg. bwd-input time: 12.0978 / Avg. batch time: 1034.7651 (ms) / GPU bubble ratio: 56.30%
[rank1]:2025-12-31 11:26:29,200 -  step: 200  loss: -4.0000  grad_norm: 25.2189  memory: 20.17GiB(42.46%)  tps: 8,085  tflops: 63.20  mfu: 20.26%
[rank0]:2025-12-31 11:26:29,209 -  step: 200  loss: -4.0000  grad_norm: 25.2189  memory: 20.85GiB(43.89%)  tps: 8,085  tflops: 63.20  mfu: 20.26%
[rank0]:2025-12-31 11:26:29,259 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1126_stage0_step200.svg
[rank3]:2025-12-31 11:26:29,208 -  step: 200  loss:  4.3954  grad_norm: 25.2189  memory: 39.99GiB(84.18%)  tps: 8,085  tflops: 63.20  mfu: 20.26%
[rank2]:2025-12-31 11:26:29,259 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1126_stage2_step200.svg
[rank2]:2025-12-31 11:26:29,305 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1126_stage6_step200.svg
[rank1]:2025-12-31 11:26:29,267 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1126_stage1_step200.svg
[rank1]:2025-12-31 11:26:29,308 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1126_stage5_step200.svg
[rank0]:2025-12-31 11:26:29,305 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1126_stage4_step200.svg
[rank2]:2025-12-31 11:26:29,402 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank2_stage2.svg
[rank2]:	> Counts Sum: 141, Total Sum: 270 (52.22%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0]
[rank0]:2025-12-31 11:26:29,404 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank0_stage0.svg
[rank0]:	> Counts Sum: 151, Total Sum: 285 (52.98%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0]
[rank2]:2025-12-31 11:26:29,498 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank2_stage6.svg
[rank2]:	> Counts Sum: 140, Total Sum: 270 (51.85%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank1]:2025-12-31 11:26:29,430 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank1_stage1.svg
[rank1]:	> Counts Sum: 211, Total Sum: 405 (52.10%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank0]:2025-12-31 11:26:29,506 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank0_stage4.svg
[rank0]:	> Counts Sum: 140, Total Sum: 270 (51.85%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank3]:2025-12-31 11:26:29,510 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1126_step200_rank3.svg
[rank3]:			> Batch Time: 952.88 ms, GPU Bubble Ratio: 68.91%, 62.34%, 70.36%, 43.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-138ms    | [S4,MB3,F]  169-9-179ms    | [S4,MB0,BI] 283-9-292ms    | [S4,MB0,BW] 292-0-292ms    | [S0,MB4,F]  293-8-301ms    | [S4,MB1,BI] 343-9-353ms    | [S4,MB1,BW] 353-0-353ms    | [S0,MB5,F]  353-8-362ms    | [S4,MB2,BI] 418-10-428ms   | [S4,MB2,BW] 428-0-428ms    | [S0,MB6,F]  428-8-437ms    | [S4,MB3,BI] 472-9-481ms    | [S4,MB3,BW] 482-0-482ms    | [S0,MB7,F]  482-8-490ms    | [S0,MB0,B]  510-10-521ms   | [S4,MB4,F]  522-8-530ms    | [S0,MB1,B]  546-10-556ms   | [S4,MB5,F]  557-8-565ms    | [S0,MB2,B]  577-10-587ms   | [S4,MB6,F]  587-8-595ms    | [S0,MB3,B]  607-10-617ms   | [S4,MB7,F]  618-8-626ms    | [S4,MB4,BI] 661-10-671ms   | [S4,MB4,BW] 671-0-671ms    | [S4,MB5,BI] 744-9-753ms    | [S4,MB5,BW] 753-0-753ms    | [S4,MB6,BI] 793-9-802ms    | [S4,MB6,BW] 802-0-802ms    | [S4,MB7,BI] 858-9-867ms    | [S4,MB7,BW] 867-0-867ms    | [S0,MB4,B]  878-9-887ms    | [S0,MB5,B]  903-9-912ms    | [S0,MB6,B]  923-9-932ms    | [S0,MB7,B]  943-9-952ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  198-7-206ms    | [S5,MB0,BI] 267-9-276ms    | [S5,MB3,F]  276-9-286ms    | [S5,MB1,BI] 328-9-337ms    | [S5,MB0,BW] 337-0-337ms    | [S1,MB4,F]  344-12-356ms   | [S5,MB2,BI] 389-10-399ms   | [S5,MB1,BW] 399-0-399ms    | [S1,MB5,F]  418-12-430ms   | [S5,MB3,BI] 452-11-463ms   | [S5,MB2,BW] 464-0-464ms    | [S1,MB6,F]  474-12-486ms   | [S1,MB0,BI] 487-15-502ms   | [S5,MB3,BW] 502-0-502ms    | [S1,MB7,F]  510-12-523ms   | [S1,MB1,BI] 524-14-539ms   | [S1,MB0,BW] 539-0-539ms    | [S5,MB4,F]  546-8-554ms    | [S1,MB2,BI] 555-15-570ms   | [S1,MB1,BW] 570-0-570ms    | [S5,MB5,F]  577-8-585ms    | [S1,MB3,BI] 585-15-600ms   | [S1,MB2,BW] 601-0-601ms    | [S5,MB6,F]  607-8-616ms    | [S5,MB4,BI] 644-10-654ms   | [S1,MB3,BW] 655-0-655ms    | [S5,MB7,F]  661-8-669ms    | [S5,MB5,BI] 710-10-720ms   | [S5,MB4,BW] 720-0-720ms    | [S5,MB6,BI] 777-9-786ms    | [S5,MB5,BW] 786-0-786ms    | [S5,MB7,BI] 842-9-851ms    | [S5,MB6,BW] 851-0-851ms    | [S1,MB4,BI] 858-13-871ms   | [S5,MB7,BW] 871-0-871ms    | [S1,MB5,BI] 883-13-897ms   | [S1,MB4,BW] 897-0-897ms    | [S1,MB6,BI] 903-13-917ms   | [S1,MB5,BW] 917-0-917ms    | [S1,MB7,BI] 923-13-937ms   | [S1,MB6,BW] 937-0-937ms    | [S1,MB7,BW] 937-0-937ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-68ms      | [S2,MB2,F]  101-7-109ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB0,BI] 251-9-260ms    | [S6,MB2,F]  260-9-269ms    | [S6,MB1,BI] 311-9-321ms    | [S6,MB3,F]  321-9-330ms    | [S6,MB2,BI] 373-8-382ms    | [S6,MB0,BW] 382-0-382ms    | [S2,MB4,F]  389-7-397ms    | [S6,MB3,BI] 435-9-445ms    | [S6,MB1,BW] 445-0-445ms    | [S2,MB5,F]  454-8-462ms    | [S2,MB0,BI] 468-10-478ms   | [S6,MB2,BW] 478-0-478ms    | [S2,MB6,F]  489-8-497ms    | [S2,MB1,BI] 498-11-509ms   | [S6,MB3,BW] 509-0-509ms    | [S2,MB7,F]  524-8-532ms    | [S2,MB2,BI] 532-10-542ms   | [S2,MB0,BW] 543-0-543ms    | [S6,MB4,F]  555-8-563ms    | [S2,MB3,BI] 564-10-574ms   | [S2,MB1,BW] 574-0-574ms    | [S6,MB5,F]  586-7-594ms    | [S6,MB4,BI] 628-9-638ms    | [S2,MB2,BW] 638-0-638ms    | [S6,MB6,F]  645-7-653ms    | [S6,MB5,BI] 694-9-704ms    | [S2,MB3,BW] 704-0-704ms    | [S6,MB7,F]  711-7-718ms    | [S6,MB6,BI] 761-9-771ms    | [S6,MB4,BW] 771-0-771ms    | [S6,MB7,BI] 827-8-836ms    | [S6,MB5,BW] 836-0-836ms    | [S2,MB4,BI] 842-8-851ms    | [S6,MB6,BW] 851-0-851ms    | [S2,MB5,BI] 868-8-877ms    | [S6,MB7,BW] 877-0-877ms    | [S2,MB6,BI] 883-8-892ms    | [S2,MB4,BW] 892-0-892ms    | [S2,MB7,BI] 903-8-912ms    | [S2,MB5,BW] 912-0-912ms    | [S2,MB6,BW] 912-0-912ms    | [S2,MB7,BW] 912-0-912ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  109-7-117ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-201ms   | [S7,MB0,BI] 212-32-244ms   | [S7,MB1,F]  244-15-260ms   | [S7,MB1,BI] 272-32-305ms   | [S7,MB2,F]  305-16-322ms   | [S7,MB2,BI] 333-33-366ms   | [S7,MB3,F]  366-16-383ms   | [S7,MB3,BI] 396-33-429ms   | [S7,MB0,BW] 429-0-429ms    | [S3,MB4,F]  437-8-446ms    | [S3,MB0,BI] 446-12-459ms   | [S7,MB1,BW] 459-0-459ms    | [S3,MB5,F]  469-8-478ms    | [S3,MB1,BI] 478-12-490ms   | [S7,MB2,BW] 490-0-490ms    | [S3,MB6,F]  500-8-508ms    | [S3,MB2,BI] 508-10-519ms   | [S7,MB3,BW] 519-0-519ms    | [S3,MB7,F]  533-8-541ms    | [S3,MB3,BI] 541-10-552ms   | [S3,MB0,BW] 552-0-552ms    | [S7,MB4,F]  564-13-578ms   | [S7,MB4,BI] 589-32-621ms   | [S3,MB1,BW] 621-0-621ms    | [S7,MB5,F]  628-14-643ms   | [S7,MB5,BI] 655-32-688ms   | [S3,MB2,BW] 688-0-688ms    | [S7,MB6,F]  694-14-709ms   | [S7,MB6,BI] 722-32-754ms   | [S3,MB3,BW] 754-0-754ms    | [S7,MB7,F]  761-14-775ms   | [S7,MB7,BI] 787-32-820ms   | [S7,MB4,BW] 820-0-820ms    | [S3,MB4,BI] 820-11-831ms   | [S7,MB5,BW] 831-0-831ms    | [S3,MB5,BI] 831-12-844ms   | [S7,MB6,BW] 843-0-843ms    | [S3,MB6,BI] 843-11-855ms   | [S7,MB7,BW] 854-0-854ms    | [S3,MB7,BI] 861-12-873ms   | [S3,MB4,BW] 873-0-873ms    | [S3,MB5,BW] 873-0-873ms    | [S3,MB6,BW] 873-0-873ms    | [S3,MB7,BW] 873-0-873ms   
[rank3]:2025-12-31 11:26:29,553 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1126_stage3_step200.svg
[rank3]:2025-12-31 11:26:29,598 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1126_stage7_step200.svg
[rank1]:2025-12-31 11:26:29,531 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank1_stage5.svg
[rank1]:	> Counts Sum: 142, Total Sum: 270 (52.59%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 13.33, 0.0]
[rank3]:2025-12-31 11:26:29,696 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank3_stage3.svg
[rank3]:	> Counts Sum: 142, Total Sum: 270 (52.59%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 6.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank3]:2025-12-31 11:26:29,774 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1126_rank3_stage7.svg
[rank3]:	> Counts Sum: 70, Total Sum: 165 (42.42%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 11:27:12,157 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:27:12,169 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:27:12,188 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:27:12,183 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:27:50,988 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:27:50,984 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:27:51,001 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:27:51,011 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:28:29,815 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:28:29,792 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:28:29,788 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:28:29,804 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:29:08,658 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:29:08,633 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:29:08,630 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:29:08,646 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:29:47,511 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 11:29:47,513 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:29:47,504 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:29:47,484 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:29:47,503 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:29:51,309 - Avg. fwd time: 12.2000 / Avg. bwd-weight time: 8.7831 / Avg. bwd-input time: 22.3506 / Avg. batch time: 955.7782 (ms) / GPU bubble ratio: 27.46%
[rank2]:2025-12-31 11:29:51,346 - Avg. fwd time: 7.7593 / Avg. bwd-weight time: 4.4913 / Avg. bwd-input time: 9.5125 / Avg. batch time: 985.2807 (ms) / GPU bubble ratio: 64.66%
[rank2]:2025-12-31 11:29:51,380 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,103  tflops: 63.35  mfu: 20.30%
[rank1]:2025-12-31 11:29:51,367 - Avg. fwd time: 9.9126 / Avg. bwd-weight time: 5.4964 / Avg. bwd-input time: 12.1044 / Avg. batch time: 1021.1133 (ms) / GPU bubble ratio: 56.89%
[rank1]:2025-12-31 11:29:51,380 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,104  tflops: 63.35  mfu: 20.30%
[rank3]:2025-12-31 11:29:51,381 -  step: 250  loss:  7.2430  grad_norm:  0.0000  memory: 39.99GiB(84.18%)  tps: 8,104  tflops: 63.35  mfu: 20.31%
[rank0]:2025-12-31 11:29:51,378 - Avg. fwd time: 8.3542 / Avg. full-bwd time: 16.0637 (Avg. bwd-weight time: 4.2524 / Avg. bwd-input time: 9.6857) / Avg. batch time: 1038.5563 (ms) / GPU bubble ratio: 64.02%
[rank0]:2025-12-31 11:29:51,381 -  step: 250  loss: -4.0000  grad_norm:  0.0911  memory: 20.85GiB(43.89%)  tps: 8,104  tflops: 63.35  mfu: 20.31%
[rank3]:2025-12-31 11:30:26,299 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:30:26,295 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:30:26,311 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:30:26,322 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:31:13,223 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:31:13,223 - Freezing Ratio: [Stage3] 0.83, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:31:13,193 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:31:13,201 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:31:52,112 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:31:52,088 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:31:52,084 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:31:52,101 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:32:31,011 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:32:30,988 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:32:30,984 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:32:31,001 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:33:09,773 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:33:09,775 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:33:09,756 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:33:09,747 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:33:09,764 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:33:13,571 - Avg. fwd time: 12.1627 / Avg. bwd-weight time: 7.9863 / Avg. bwd-input time: 22.3277 / Avg. batch time: 945.3479 (ms) / GPU bubble ratio: 28.11%
[rank2]:2025-12-31 11:33:13,614 - Avg. fwd time: 7.7860 / Avg. bwd-weight time: 4.0868 / Avg. bwd-input time: 9.5191 / Avg. batch time: 976.3582 (ms) / GPU bubble ratio: 64.94%
[rank2]:2025-12-31 11:33:13,640 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,100  tflops: 63.33  mfu: 20.30%
[rank1]:2025-12-31 11:33:13,629 - Avg. fwd time: 9.9424 / Avg. bwd-weight time: 5.0007 / Avg. bwd-input time: 12.1093 / Avg. batch time: 1012.2738 (ms) / GPU bubble ratio: 57.24%
[rank1]:2025-12-31 11:33:13,640 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,100  tflops: 63.33  mfu: 20.30%
[rank0]:2025-12-31 11:33:13,638 - Avg. fwd time: 8.3808 / Avg. full-bwd time: 15.5097 (Avg. bwd-weight time: 3.8694 / Avg. bwd-input time: 9.6862) / Avg. batch time: 1030.3202 (ms) / GPU bubble ratio: 64.42%
[rank0]:2025-12-31 11:33:13,641 -  step: 300  loss: -4.0000  grad_norm:  0.0385  memory: 20.85GiB(43.89%)  tps: 8,100  tflops: 63.33  mfu: 20.30%
[rank0]:2025-12-31 11:33:13,694 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1133_stage0_step300.svg
[rank3]:2025-12-31 11:33:13,641 -  step: 300  loss:  6.5635  grad_norm:  0.0000  memory: 39.99GiB(84.18%)  tps: 8,101  tflops: 63.33  mfu: 20.30%
[rank2]:2025-12-31 11:33:13,694 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1133_stage2_step300.svg
[rank1]:2025-12-31 11:33:13,704 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1133_stage1_step300.svg
[rank1]:2025-12-31 11:33:13,743 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1133_stage5_step300.svg
[rank0]:2025-12-31 11:33:13,743 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1133_stage4_step300.svg
[rank2]:2025-12-31 11:33:13,742 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1133_stage6_step300.svg
[rank0]:2025-12-31 11:33:13,851 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank0_stage0.svg
[rank0]:	> Counts Sum: 288, Total Sum: 475 (60.63%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 4.0]
[rank2]:2025-12-31 11:33:13,847 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank2_stage2.svg
[rank2]:	> Counts Sum: 267, Total Sum: 450 (59.33%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0]
[rank1]:2025-12-31 11:33:13,866 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank1_stage1.svg
[rank1]:	> Counts Sum: 400, Total Sum: 675 (59.26%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0]
[rank0]:2025-12-31 11:33:13,972 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank0_stage4.svg
[rank0]:	> Counts Sum: 266, Total Sum: 450 (59.11%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0]
[rank3]:2025-12-31 11:33:13,942 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1133_step300_rank3.svg
[rank3]:			> Batch Time: 947.32 ms, GPU Bubble Ratio: 68.78%, 62.19%, 70.21%, 42.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  48-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-138ms    | [S4,MB3,F]  169-9-178ms    | [S4,MB0,BI] 283-9-292ms    | [S4,MB0,BW] 292-0-292ms    | [S0,MB4,F]  292-8-301ms    | [S4,MB1,BI] 343-9-352ms    | [S4,MB1,BW] 353-0-353ms    | [S0,MB5,F]  353-8-361ms    | [S4,MB2,BI] 417-10-427ms   | [S4,MB2,BW] 428-0-428ms    | [S0,MB6,F]  428-8-436ms    | [S4,MB3,BI] 470-9-480ms    | [S4,MB3,BW] 480-0-480ms    | [S0,MB7,F]  480-8-488ms    | [S0,MB0,B]  510-10-520ms   | [S4,MB4,F]  520-8-528ms    | [S0,MB1,B]  544-10-555ms   | [S4,MB5,F]  555-8-563ms    | [S0,MB2,B]  575-10-585ms   | [S4,MB6,F]  585-8-593ms    | [S0,MB3,B]  605-10-615ms   | [S4,MB7,F]  615-8-623ms    | [S4,MB4,BI] 660-10-670ms   | [S4,MB4,BW] 670-0-670ms    | [S4,MB5,BI] 740-9-749ms    | [S4,MB5,BW] 749-0-749ms    | [S4,MB6,BI] 788-9-797ms    | [S4,MB6,BW] 797-0-797ms    | [S4,MB7,BI] 853-9-862ms    | [S4,MB7,BW] 862-0-862ms    | [S0,MB4,B]  873-9-882ms    | [S0,MB5,B]  898-9-907ms    | [S0,MB6,B]  918-9-927ms    | [S0,MB7,B]  938-9-947ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  48-11-60ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  197-7-205ms    | [S5,MB0,BI] 267-9-276ms    | [S5,MB3,F]  276-9-285ms    | [S5,MB1,BI] 327-9-336ms    | [S5,MB0,BW] 336-0-336ms    | [S1,MB4,F]  343-12-355ms   | [S5,MB2,BI] 388-10-398ms   | [S5,MB1,BW] 399-0-399ms    | [S1,MB5,F]  418-12-430ms   | [S5,MB3,BI] 452-11-463ms   | [S5,MB2,BW] 463-0-463ms    | [S1,MB6,F]  472-12-484ms   | [S1,MB0,BI] 486-15-501ms   | [S5,MB3,BW] 502-0-502ms    | [S1,MB7,F]  510-12-522ms   | [S1,MB1,BI] 523-15-538ms   | [S1,MB0,BW] 538-0-538ms    | [S5,MB4,F]  544-8-553ms    | [S1,MB2,BI] 553-15-568ms   | [S1,MB1,BW] 568-0-568ms    | [S5,MB5,F]  575-8-583ms    | [S1,MB3,BI] 584-15-599ms   | [S1,MB2,BW] 599-0-599ms    | [S5,MB6,F]  605-8-613ms    | [S5,MB4,BI] 643-10-653ms   | [S1,MB3,BW] 653-0-653ms    | [S5,MB7,F]  660-8-668ms    | [S5,MB5,BI] 707-10-717ms   | [S5,MB4,BW] 717-0-717ms    | [S5,MB6,BI] 773-9-782ms    | [S5,MB5,BW] 782-0-782ms    | [S5,MB7,BI] 838-9-847ms    | [S5,MB6,BW] 847-0-847ms    | [S1,MB4,BI] 853-13-867ms   | [S5,MB7,BW] 867-0-867ms    | [S1,MB5,BI] 878-13-892ms   | [S1,MB4,BW] 892-0-892ms    | [S1,MB6,BI] 898-13-912ms   | [S1,MB5,BW] 912-0-912ms    | [S1,MB7,BI] 918-13-931ms   | [S1,MB6,BW] 932-0-932ms    | [S1,MB7,BW] 932-0-932ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-148ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB0,BI] 251-9-260ms    | [S6,MB2,F]  260-9-269ms    | [S6,MB1,BI] 311-9-320ms    | [S6,MB3,F]  320-9-330ms    | [S6,MB2,BI] 373-8-382ms    | [S6,MB0,BW] 382-0-382ms    | [S2,MB4,F]  389-7-397ms    | [S6,MB3,BI] 436-9-446ms    | [S6,MB1,BW] 446-0-446ms    | [S2,MB5,F]  454-7-462ms    | [S2,MB0,BI] 467-10-478ms   | [S6,MB2,BW] 478-0-478ms    | [S2,MB6,F]  488-8-497ms    | [S2,MB1,BI] 497-11-508ms   | [S6,MB3,BW] 508-0-508ms    | [S2,MB7,F]  523-8-531ms    | [S2,MB2,BI] 531-10-542ms   | [S2,MB0,BW] 541-0-541ms    | [S6,MB4,F]  553-8-562ms    | [S2,MB3,BI] 562-10-572ms   | [S2,MB1,BW] 572-0-572ms    | [S6,MB5,F]  584-7-592ms    | [S6,MB4,BI] 626-9-636ms    | [S2,MB2,BW] 636-0-636ms    | [S6,MB6,F]  643-7-651ms    | [S6,MB5,BI] 691-9-701ms    | [S2,MB3,BW] 700-0-700ms    | [S6,MB7,F]  707-7-715ms    | [S6,MB6,BI] 756-9-766ms    | [S6,MB4,BW] 766-0-766ms    | [S6,MB7,BI] 822-8-831ms    | [S6,MB5,BW] 831-0-831ms    | [S2,MB4,BI] 838-8-847ms    | [S6,MB6,BW] 846-0-846ms    | [S2,MB5,BI] 863-8-872ms    | [S6,MB7,BW] 872-0-872ms    | [S2,MB6,BI] 878-8-887ms    | [S2,MB4,BW] 887-0-887ms    | [S2,MB7,BI] 897-8-906ms    | [S2,MB5,BW] 906-0-906ms    | [S2,MB6,BW] 906-0-906ms    | [S2,MB7,BW] 906-0-906ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  148-7-156ms    | [S7,MB0,F]  184-15-200ms   | [S7,MB0,BI] 212-31-244ms   | [S7,MB1,F]  244-15-260ms   | [S7,MB1,BI] 271-32-304ms   | [S7,MB2,F]  304-16-321ms   | [S7,MB2,BI] 333-33-367ms   | [S7,MB3,F]  366-16-383ms   | [S7,MB3,BI] 396-33-429ms   | [S7,MB0,BW] 429-0-429ms    | [S3,MB4,F]  436-9-446ms    | [S3,MB0,BI] 446-13-459ms   | [S7,MB1,BW] 459-0-459ms    | [S3,MB5,F]  469-8-477ms    | [S3,MB1,BI] 477-12-490ms   | [S7,MB2,BW] 490-0-490ms    | [S3,MB6,F]  499-8-507ms    | [S3,MB2,BI] 507-10-518ms   | [S7,MB3,BW] 518-0-518ms    | [S3,MB7,F]  532-8-540ms    | [S3,MB3,BI] 540-10-551ms   | [S3,MB0,BW] 551-0-551ms    | [S7,MB4,F]  563-13-576ms   | [S7,MB4,BI] 588-31-620ms   | [S3,MB1,BW] 620-0-620ms    | [S7,MB5,F]  627-14-641ms   | [S7,MB5,BI] 653-32-685ms   | [S3,MB2,BW] 685-0-685ms    | [S7,MB6,F]  691-14-705ms   | [S7,MB6,BI] 718-32-750ms   | [S3,MB3,BW] 750-0-750ms    | [S7,MB7,F]  757-14-772ms   | [S7,MB7,BI] 784-32-816ms   | [S7,MB4,BW] 816-0-816ms    | [S3,MB4,BI] 816-11-827ms   | [S7,MB5,BW] 827-0-827ms    | [S3,MB5,BI] 827-12-839ms   | [S7,MB6,BW] 839-0-839ms    | [S3,MB6,BI] 839-11-850ms   | [S7,MB7,BW] 850-0-850ms    | [S3,MB7,BI] 856-12-868ms   | [S3,MB4,BW] 868-0-868ms    | [S3,MB5,BW] 868-0-868ms    | [S3,MB6,BW] 868-0-868ms    | [S3,MB7,BW] 868-0-868ms   
[rank3]:2025-12-31 11:33:13,986 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1133_stage3_step300.svg
[rank3]:2025-12-31 11:33:14,031 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1133_stage7_step300.svg
[rank2]:2025-12-31 11:33:13,950 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank2_stage6.svg
[rank2]:	> Counts Sum: 266, Total Sum: 450 (59.11%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0]
[rank1]:2025-12-31 11:33:13,966 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank1_stage5.svg
[rank1]:	> Counts Sum: 268, Total Sum: 450 (59.56%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 8.0, 0.0]
[rank3]:2025-12-31 11:33:14,130 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank3_stage3.svg
[rank3]:	> Counts Sum: 269, Total Sum: 450 (59.78%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 8.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0]
[rank3]:2025-12-31 11:33:14,209 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1133_rank3_stage7.svg
[rank3]:	> Counts Sum: 133, Total Sum: 275 (48.36%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 11:33:49,058 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:33:49,054 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:33:49,071 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:33:49,080 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:34:27,914 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:34:27,911 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:34:27,928 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:34:27,939 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:35:06,832 - Freezing Ratio: [Stage0] 0.11, [Stage4] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:35:06,809 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:35:06,805 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:35:06,822 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:35:53,944 - Freezing Ratio: [Stage3] 0.83, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:35:53,917 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:35:53,929 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:35:53,948 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:36:32,852 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 11:36:32,854 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:36:32,846 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:36:32,825 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:36:32,846 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:36:36,680 - Avg. fwd time: 12.1467 / Avg. bwd-weight time: 7.4219 / Avg. bwd-input time: 22.3180 / Avg. batch time: 938.2649 (ms) / GPU bubble ratio: 28.57%
[rank2]:2025-12-31 11:36:36,716 - Avg. fwd time: 7.8067 / Avg. bwd-weight time: 3.7985 / Avg. bwd-input time: 9.5259 / Avg. batch time: 970.4884 (ms) / GPU bubble ratio: 65.16%
[rank0]:2025-12-31 11:36:36,746 - Avg. fwd time: 8.4022 / Avg. full-bwd time: 15.0286 (Avg. bwd-weight time: 3.5956 / Avg. bwd-input time: 9.6881) / Avg. batch time: 1024.8500 (ms) / GPU bubble ratio: 64.78%
[rank0]:2025-12-31 11:36:36,748 -  step: 350  loss: -4.0000  grad_norm:  0.1073  memory: 20.85GiB(43.89%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank3]:2025-12-31 11:36:36,749 -  step: 350  loss:  4.5343  grad_norm:  0.0000  memory: 39.99GiB(84.18%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank2]:2025-12-31 11:36:36,748 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank1]:2025-12-31 11:36:36,737 - Avg. fwd time: 9.9662 / Avg. bwd-weight time: 4.6467 / Avg. bwd-input time: 12.1153 / Avg. batch time: 1006.4604 (ms) / GPU bubble ratio: 57.51%
[rank1]:2025-12-31 11:36:36,748 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,067  tflops: 63.06  mfu: 20.21%
[rank0]:2025-12-31 11:37:11,709 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:37:11,687 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:37:11,683 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:37:11,700 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:37:50,587 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:37:50,583 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:37:50,600 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:37:50,610 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:38:29,438 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:38:29,434 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:38:29,451 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:38:29,461 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:39:08,371 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:39:08,347 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:39:08,344 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:39:08,360 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:39:47,257 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:39:47,267 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:39:47,274 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:39:47,283 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:39:47,284 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:39:51,181 - Avg. fwd time: 7.8422 / Avg. bwd-weight time: 3.3240 / Avg. bwd-input time: 9.5328 / Avg. batch time: 960.7584 (ms) / GPU bubble ratio: 65.53%
[rank3]:2025-12-31 11:39:51,145 - Avg. fwd time: 12.1257 / Avg. bwd-weight time: 6.4945 / Avg. bwd-input time: 22.3064 / Avg. batch time: 926.7480 (ms) / GPU bubble ratio: 29.34%
[rank0]:2025-12-31 11:39:51,212 - Avg. fwd time: 8.4388 / Avg. full-bwd time: 14.2483 (Avg. bwd-weight time: 3.1464 / Avg. bwd-input time: 9.6908) / Avg. batch time: 1015.8097 (ms) / GPU bubble ratio: 65.38%
[rank0]:2025-12-31 11:39:51,214 -  step: 400  loss: -4.0000  grad_norm:  0.1162  memory: 20.85GiB(43.89%)  tps: 8,425  tflops: 65.86  mfu: 21.11%
[rank2]:2025-12-31 11:39:51,214 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,425  tflops: 65.86  mfu: 21.11%
[rank2]:2025-12-31 11:39:51,268 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1139_stage2_step400.svg
[rank3]:2025-12-31 11:39:51,215 -  step: 400  loss:  3.2921  grad_norm:  0.0000  memory: 39.99GiB(84.18%)  tps: 8,425  tflops: 65.86  mfu: 21.11%
[rank1]:2025-12-31 11:39:51,203 - Avg. fwd time: 10.0082 / Avg. bwd-weight time: 4.0662 / Avg. bwd-input time: 12.1244 / Avg. batch time: 996.8547 (ms) / GPU bubble ratio: 57.95%
[rank1]:2025-12-31 11:39:51,214 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,425  tflops: 65.86  mfu: 21.11%
[rank1]:2025-12-31 11:39:51,274 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1139_stage1_step400.svg
[rank0]:2025-12-31 11:39:51,269 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1139_stage0_step400.svg
[rank0]:2025-12-31 11:39:51,319 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1139_stage4_step400.svg
[rank2]:2025-12-31 11:39:51,318 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1139_stage6_step400.svg
[rank1]:2025-12-31 11:39:51,317 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1139_stage5_step400.svg
[rank0]:2025-12-31 11:39:51,422 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank0_stage0.svg
[rank0]:	> Counts Sum: 433, Total Sum: 665 (65.11%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 22.85, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 11.42]
[rank2]:2025-12-31 11:39:51,418 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank2_stage2.svg
[rank2]:	> Counts Sum: 393, Total Sum: 630 (62.38%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 0.0]
[rank1]:2025-12-31 11:39:51,440 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank1_stage1.svg
[rank1]:	> Counts Sum: 589, Total Sum: 945 (62.33%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank0]:2025-12-31 11:39:51,520 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank0_stage4.svg
[rank0]:	> Counts Sum: 392, Total Sum: 630 (62.22%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank2]:2025-12-31 11:39:51,515 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank2_stage6.svg
[rank2]:	> Counts Sum: 392, Total Sum: 630 (62.22%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank3]:2025-12-31 11:39:51,513 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1139_step400_rank3.svg
[rank3]:			> Batch Time: 953.89 ms, GPU Bubble Ratio: 70.13%, 62.27%, 70.32%, 42.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-139ms    | [S4,MB3,F]  170-9-179ms    | [S4,MB0,BI] 284-9-293ms    | [S4,MB0,BW] 293-0-293ms    | [S0,MB4,F]  293-8-301ms    | [S4,MB1,BI] 344-10-354ms   | [S4,MB1,BW] 354-0-354ms    | [S0,MB5,F]  354-8-363ms    | [S4,MB2,BI] 420-10-431ms   | [S4,MB2,BW] 431-0-431ms    | [S0,MB6,F]  431-8-439ms    | [S4,MB3,BI] 474-9-483ms    | [S4,MB3,BW] 483-0-483ms    | [S0,MB7,F]  483-8-492ms    | [S0,MB0,B]  513-9-522ms    | [S4,MB4,F]  522-8-530ms    | [S0,MB1,B]  548-9-557ms    | [S4,MB5,F]  557-8-566ms    | [S0,MB2,B]  578-9-587ms    | [S4,MB6,F]  587-8-595ms    | [S0,MB3,B]  609-8-618ms    | [S4,MB7,F]  618-8-626ms    | [S4,MB4,BI] 663-10-673ms   | [S4,MB4,BW] 673-0-673ms    | [S4,MB5,BI] 746-9-755ms    | [S4,MB5,BW] 755-0-755ms    | [S4,MB6,BI] 794-9-803ms    | [S4,MB6,BW] 803-0-803ms    | [S4,MB7,BI] 861-9-870ms    | [S4,MB7,BW] 870-0-870ms    | [S0,MB4,B]  881-7-888ms    | [S0,MB5,B]  906-7-913ms    | [S0,MB6,B]  926-7-933ms    | [S0,MB7,B]  946-7-953ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-12-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  184-7-192ms    | [S5,MB2,F]  198-7-206ms    | [S5,MB0,BI] 267-9-277ms    | [S5,MB3,F]  277-9-286ms    | [S5,MB1,BI] 329-9-338ms    | [S5,MB0,BW] 338-0-338ms    | [S1,MB4,F]  345-12-357ms   | [S5,MB2,BI] 390-10-401ms   | [S5,MB1,BW] 401-0-401ms    | [S1,MB5,F]  420-12-432ms   | [S5,MB3,BI] 455-11-466ms   | [S5,MB2,BW] 466-0-466ms    | [S1,MB6,F]  475-12-488ms   | [S1,MB0,BI] 489-15-504ms   | [S5,MB3,BW] 504-0-504ms    | [S1,MB7,F]  513-12-526ms   | [S1,MB1,BI] 525-15-541ms   | [S1,MB0,BW] 540-0-540ms    | [S5,MB4,F]  547-8-556ms    | [S1,MB2,BI] 556-15-571ms   | [S1,MB1,BW] 571-0-571ms    | [S5,MB5,F]  578-8-587ms    | [S1,MB3,BI] 587-15-602ms   | [S1,MB2,BW] 602-0-602ms    | [S5,MB6,F]  609-8-617ms    | [S5,MB4,BI] 646-10-656ms   | [S1,MB3,BW] 656-0-656ms    | [S5,MB7,F]  662-8-671ms    | [S5,MB5,BI] 711-10-722ms   | [S5,MB4,BW] 721-0-721ms    | [S5,MB6,BI] 778-9-788ms    | [S5,MB5,BW] 787-0-787ms    | [S5,MB7,BI] 845-9-854ms    | [S5,MB6,BW] 854-0-854ms    | [S1,MB4,BI] 860-13-874ms   | [S5,MB7,BW] 874-0-874ms    | [S1,MB5,BI] 885-13-899ms   | [S1,MB4,BW] 899-0-899ms    | [S1,MB6,BI] 905-13-919ms   | [S1,MB5,BW] 919-0-919ms    | [S1,MB7,BI] 925-13-939ms   | [S1,MB6,BW] 939-0-939ms    | [S1,MB7,BW] 939-0-939ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-109ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  192-7-200ms    | [S6,MB0,BI] 252-9-261ms    | [S6,MB2,F]  261-9-270ms    | [S6,MB1,BI] 313-9-322ms    | [S6,MB3,F]  322-9-331ms    | [S6,MB2,BI] 376-8-384ms    | [S6,MB0,BW] 384-0-384ms    | [S2,MB4,F]  391-7-399ms    | [S6,MB3,BI] 439-9-448ms    | [S6,MB1,BW] 449-0-449ms    | [S2,MB5,F]  457-8-465ms    | [S2,MB0,BI] 470-10-481ms   | [S6,MB2,BW] 481-0-481ms    | [S2,MB6,F]  491-8-499ms    | [S2,MB1,BI] 500-11-511ms   | [S6,MB3,BW] 511-0-511ms    | [S2,MB7,F]  526-8-534ms    | [S2,MB2,BI] 535-10-545ms   | [S2,MB0,BW] 545-0-545ms    | [S6,MB4,F]  557-8-565ms    | [S2,MB3,BI] 565-10-575ms   | [S2,MB1,BW] 576-0-576ms    | [S6,MB5,F]  588-8-596ms    | [S6,MB4,BI] 630-9-639ms    | [S2,MB2,BW] 640-0-640ms    | [S6,MB6,F]  647-7-654ms    | [S6,MB5,BI] 696-9-705ms    | [S2,MB3,BW] 706-0-706ms    | [S6,MB7,F]  712-7-720ms    | [S6,MB6,BI] 763-9-772ms    | [S6,MB4,BW] 773-0-773ms    | [S6,MB7,BI] 830-8-839ms    | [S6,MB5,BW] 839-0-839ms    | [S2,MB4,BI] 845-8-854ms    | [S6,MB6,BW] 854-0-854ms    | [S2,MB5,BI] 871-8-879ms    | [S6,MB7,BW] 880-0-880ms    | [S2,MB6,BI] 886-8-894ms    | [S2,MB4,BW] 895-0-895ms    | [S2,MB7,BI] 906-8-914ms    | [S2,MB5,BW] 915-0-915ms    | [S2,MB6,BW] 915-0-915ms    | [S2,MB7,BW] 915-0-915ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  109-7-117ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-201ms   | [S7,MB0,BI] 213-32-245ms   | [S7,MB1,F]  245-15-261ms   | [S7,MB1,BI] 273-32-306ms   | [S7,MB2,F]  306-17-324ms   | [S7,MB2,BI] 336-33-369ms   | [S7,MB3,F]  369-17-386ms   | [S7,MB3,BI] 399-33-433ms   | [S7,MB0,BW] 432-0-432ms    | [S3,MB4,F]  439-9-448ms    | [S3,MB0,BI] 448-12-461ms   | [S7,MB1,BW] 462-0-462ms    | [S3,MB5,F]  472-8-480ms    | [S3,MB1,BI] 480-12-493ms   | [S7,MB2,BW] 493-0-493ms    | [S3,MB6,F]  502-8-511ms    | [S3,MB2,BI] 511-10-521ms   | [S7,MB3,BW] 521-0-521ms    | [S3,MB7,F]  536-8-544ms    | [S3,MB3,BI] 544-10-555ms   | [S3,MB0,BW] 555-0-555ms    | [S7,MB4,F]  566-13-580ms   | [S7,MB4,BI] 591-32-623ms   | [S3,MB1,BW] 623-0-623ms    | [S7,MB5,F]  630-15-645ms   | [S7,MB5,BI] 657-32-689ms   | [S3,MB2,BW] 689-0-689ms    | [S7,MB6,F]  696-14-710ms   | [S7,MB6,BI] 724-32-756ms   | [S3,MB3,BW] 756-0-756ms    | [S7,MB7,F]  763-14-778ms   | [S7,MB7,BI] 790-32-823ms   | [S7,MB4,BW] 823-0-823ms    | [S3,MB4,BI] 823-11-834ms   | [S7,MB5,BW] 834-0-834ms    | [S3,MB5,BI] 834-12-847ms   | [S7,MB6,BW] 847-0-847ms    | [S3,MB6,BI] 847-11-858ms   | [S7,MB7,BW] 858-0-858ms    | [S3,MB7,BI] 864-12-876ms   | [S3,MB4,BW] 876-0-876ms    | [S3,MB5,BW] 876-0-876ms    | [S3,MB6,BW] 876-0-876ms    | [S3,MB7,BW] 876-0-876ms   
[rank3]:2025-12-31 11:39:51,559 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1139_stage3_step400.svg
[rank1]:2025-12-31 11:39:51,537 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank1_stage5.svg
[rank1]:	> Counts Sum: 394, Total Sum: 630 (62.54%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 5.71, 0.0]
[rank3]:2025-12-31 11:39:51,607 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1139_stage7_step400.svg
[rank3]:2025-12-31 11:39:51,706 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank3_stage3.svg
[rank3]:	> Counts Sum: 396, Total Sum: 630 (62.86%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 5.71, 5.71, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank3]:2025-12-31 11:39:51,784 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1139_rank3_stage7.svg
[rank3]:	> Counts Sum: 196, Total Sum: 385 (50.91%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 11:40:13,537 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 11:40:13,958 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 11:40:13,933 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 11:40:13,950 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 11:40:26,597 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:40:26,602 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:40:26,614 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:40:26,623 - Freezing Ratio: [Stage0] 0.05, [Stage4] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:41:13,649 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:41:13,645 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:41:13,630 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.83, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:41:13,619 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:41:52,332 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:41:52,319 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:41:52,314 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:41:52,340 - Freezing Ratio: [Stage0] 0.79, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:42:31,107 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:42:31,135 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:42:31,124 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:42:31,111 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:43:09,926 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:43:09,927 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:43:09,906 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:43:09,932 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 11:43:09,934 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:43:13,715 - Avg. fwd time: 12.1133 / Avg. bwd-weight time: 6.2204 / Avg. bwd-input time: 22.2968 / Avg. batch time: 923.1701 (ms) / GPU bubble ratio: 29.58%
[rank2]:2025-12-31 11:43:13,752 - Avg. fwd time: 7.8509 / Avg. bwd-weight time: 3.1843 / Avg. bwd-input time: 9.5354 / Avg. batch time: 957.8151 (ms) / GPU bubble ratio: 65.64%
[rank0]:2025-12-31 11:43:13,783 - Avg. fwd time: 8.4482 / Avg. full-bwd time: 13.9813 (Avg. bwd-weight time: 3.0141 / Avg. bwd-input time: 9.6912) / Avg. batch time: 1013.0347 (ms) / GPU bubble ratio: 65.58%
[rank0]:2025-12-31 11:43:13,785 -  step: 450  loss: -4.0000  grad_norm:  0.1939  memory: 21.54GiB(45.33%)  tps: 8,088  tflops: 63.23  mfu: 20.27%
[rank1]:2025-12-31 11:43:13,774 - Avg. fwd time: 10.0189 / Avg. bwd-weight time: 3.8949 / Avg. bwd-input time: 12.1284 / Avg. batch time: 993.9464 (ms) / GPU bubble ratio: 58.08%
[rank1]:2025-12-31 11:43:13,784 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,088  tflops: 63.23  mfu: 20.27%
[rank3]:2025-12-31 11:43:13,785 -  step: 450  loss:  4.7295  grad_norm:  0.0000  memory: 39.99GiB(84.18%)  tps: 8,088  tflops: 63.23  mfu: 20.27%
[rank2]:2025-12-31 11:43:13,784 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,088  tflops: 63.23  mfu: 20.27%
[rank2]:2025-12-31 11:43:48,613 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:43:48,639 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:43:48,630 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:43:48,617 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:44:27,324 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:44:27,311 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:44:27,307 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:44:27,333 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:45:06,131 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:45:06,157 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:45:06,148 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:45:06,135 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:45:45,026 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:45:45,012 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:45:45,009 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:45:45,035 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:46:23,829 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:46:23,855 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:46:23,857 - Freezing Ratio: [Stage0] 0.05, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:46:23,846 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:46:23,838 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:46:28,506 - Avg. fwd time: 10.0434 / Avg. bwd-weight time: 3.5309 / Avg. bwd-input time: 12.1354 / Avg. batch time: 987.7310 (ms) / GPU bubble ratio: 58.35%
[rank3]:2025-12-31 11:46:28,493 - Avg. fwd time: 12.0932 / Avg. bwd-weight time: 5.6387 / Avg. bwd-input time: 22.2840 / Avg. batch time: 915.7462 (ms) / GPU bubble ratio: 30.08%
[rank2]:2025-12-31 11:46:28,488 - Avg. fwd time: 7.8723 / Avg. bwd-weight time: 2.8868 / Avg. bwd-input time: 9.5411 / Avg. batch time: 951.5207 (ms) / GPU bubble ratio: 65.86%
[rank2]:2025-12-31 11:46:28,535 -  step: 500  loss: -4.0000  grad_norm: 22.8731  memory: 15.48GiB(32.59%)  tps: 8,413  tflops: 65.77  mfu: 21.08%
[rank0]:2025-12-31 11:46:28,501 - Avg. fwd time: 8.4698 / Avg. full-bwd time: 13.4912 (Avg. bwd-weight time: 2.7324 / Avg. bwd-input time: 9.6918) / Avg. batch time: 1007.1696 (ms) / GPU bubble ratio: 65.96%
[rank0]:2025-12-31 11:46:28,549 -  step: 500  loss: -4.0000  grad_norm: 22.8731  memory: 21.54GiB(45.33%)  tps: 8,412  tflops: 65.76  mfu: 21.08%
[rank1]:2025-12-31 11:46:28,538 -  step: 500  loss: -4.0000  grad_norm: 22.8731  memory: 20.17GiB(42.46%)  tps: 8,413  tflops: 65.77  mfu: 21.08%
[rank1]:2025-12-31 11:46:28,604 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1146_stage1_step500.svg
[rank3]:2025-12-31 11:46:28,547 -  step: 500  loss:  4.7358  grad_norm: 22.8731  memory: 40.07GiB(84.35%)  tps: 8,412  tflops: 65.76  mfu: 21.08%
[rank2]:2025-12-31 11:46:28,598 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1146_stage2_step500.svg
[rank0]:2025-12-31 11:46:28,598 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1146_stage0_step500.svg
[rank0]:2025-12-31 11:46:28,642 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1146_stage4_step500.svg
[rank1]:2025-12-31 11:46:28,642 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1146_stage5_step500.svg
[rank2]:2025-12-31 11:46:28,642 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1146_stage6_step500.svg
[rank2]:2025-12-31 11:46:28,739 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank2_stage2.svg
[rank2]:	> Counts Sum: 505, Total Sum: 810 (62.35%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.22, 0.0]
[rank0]:2025-12-31 11:46:28,741 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank0_stage0.svg
[rank0]:	> Counts Sum: 567, Total Sum: 855 (66.32%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 35.55, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.22, 22.22]
[rank1]:2025-12-31 11:46:28,765 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank1_stage1.svg
[rank1]:	> Counts Sum: 757, Total Sum: 1215 (62.30%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.22, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank2]:2025-12-31 11:46:28,840 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank2_stage6.svg
[rank2]:	> Counts Sum: 504, Total Sum: 810 (62.22%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank0]:2025-12-31 11:46:28,840 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank0_stage4.svg
[rank0]:	> Counts Sum: 504, Total Sum: 810 (62.22%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank1]:2025-12-31 11:46:28,863 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank1_stage5.svg
[rank1]:	> Counts Sum: 507, Total Sum: 810 (62.59%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 2.22, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 4.44, 0.0]
[rank3]:2025-12-31 11:46:28,844 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1146_step500_rank3.svg
[rank3]:			> Batch Time: 953.30 ms, GPU Bubble Ratio: 68.98%, 62.31%, 70.35%, 42.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-138ms    | [S4,MB3,F]  169-9-178ms    | [S4,MB0,BI] 283-9-292ms    | [S4,MB0,BW] 292-0-292ms    | [S0,MB4,F]  292-8-301ms    | [S4,MB1,BI] 342-9-352ms    | [S4,MB1,BW] 352-0-352ms    | [S0,MB5,F]  352-8-361ms    | [S4,MB2,BI] 417-10-428ms   | [S4,MB2,BW] 428-0-428ms    | [S0,MB6,F]  429-8-437ms    | [S4,MB3,BI] 471-9-481ms    | [S4,MB3,BW] 481-0-481ms    | [S0,MB7,F]  481-8-490ms    | [S0,MB0,B]  511-10-522ms   | [S4,MB4,F]  522-8-530ms    | [S0,MB1,B]  546-10-557ms   | [S4,MB5,F]  557-8-565ms    | [S0,MB2,B]  576-10-586ms   | [S4,MB6,F]  587-8-595ms    | [S0,MB3,B]  607-10-617ms   | [S4,MB7,F]  617-8-625ms    | [S4,MB4,BI] 661-10-671ms   | [S4,MB4,BW] 671-0-671ms    | [S4,MB5,BI] 743-9-752ms    | [S4,MB5,BW] 752-0-752ms    | [S4,MB6,BI] 792-9-801ms    | [S4,MB6,BW] 801-0-801ms    | [S4,MB7,BI] 858-9-867ms    | [S4,MB7,BW] 868-0-868ms    | [S0,MB4,B]  879-9-888ms    | [S0,MB5,B]  904-9-913ms    | [S0,MB6,B]  924-9-933ms    | [S0,MB7,B]  944-9-953ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  197-7-205ms    | [S5,MB0,BI] 267-9-276ms    | [S5,MB3,F]  276-9-285ms    | [S5,MB1,BI] 327-9-336ms    | [S5,MB0,BW] 336-0-336ms    | [S1,MB4,F]  343-12-355ms   | [S5,MB2,BI] 388-10-398ms   | [S5,MB1,BW] 398-0-398ms    | [S1,MB5,F]  418-12-430ms   | [S5,MB3,BI] 452-11-463ms   | [S5,MB2,BW] 463-0-463ms    | [S1,MB6,F]  473-12-485ms   | [S1,MB0,BI] 487-15-503ms   | [S5,MB3,BW] 503-0-503ms    | [S1,MB7,F]  512-12-524ms   | [S1,MB1,BI] 524-15-539ms   | [S1,MB0,BW] 539-0-539ms    | [S5,MB4,F]  546-8-555ms    | [S1,MB2,BI] 555-15-570ms   | [S1,MB1,BW] 570-0-570ms    | [S5,MB5,F]  577-8-585ms    | [S1,MB3,BI] 585-15-600ms   | [S1,MB2,BW] 601-0-601ms    | [S5,MB6,F]  607-8-615ms    | [S5,MB4,BI] 644-10-654ms   | [S1,MB3,BW] 655-0-655ms    | [S5,MB7,F]  661-8-669ms    | [S5,MB5,BI] 710-10-720ms   | [S5,MB4,BW] 720-0-720ms    | [S5,MB6,BI] 776-9-785ms    | [S5,MB5,BW] 785-0-785ms    | [S5,MB7,BI] 843-9-852ms    | [S5,MB6,BW] 852-0-852ms    | [S1,MB4,BI] 858-13-872ms   | [S5,MB7,BW] 872-0-872ms    | [S1,MB5,BI] 884-13-897ms   | [S1,MB4,BW] 897-0-897ms    | [S1,MB6,BI] 903-13-917ms   | [S1,MB5,BW] 917-0-917ms    | [S1,MB7,BI] 923-13-937ms   | [S1,MB6,BW] 937-0-937ms    | [S1,MB7,BW] 937-0-937ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB0,BI] 251-9-260ms    | [S6,MB2,F]  260-9-269ms    | [S6,MB1,BI] 311-9-320ms    | [S6,MB3,F]  320-9-329ms    | [S6,MB2,BI] 373-8-382ms    | [S6,MB0,BW] 382-0-382ms    | [S2,MB4,F]  389-7-396ms    | [S6,MB3,BI] 436-9-446ms    | [S6,MB1,BW] 446-0-446ms    | [S2,MB5,F]  454-7-462ms    | [S2,MB0,BI] 469-10-479ms   | [S6,MB2,BW] 479-0-479ms    | [S2,MB6,F]  490-8-498ms    | [S2,MB1,BI] 499-11-510ms   | [S6,MB3,BW] 510-0-510ms    | [S2,MB7,F]  525-8-533ms    | [S2,MB2,BI] 533-10-543ms   | [S2,MB0,BW] 544-0-544ms    | [S6,MB4,F]  555-8-563ms    | [S2,MB3,BI] 563-10-573ms   | [S2,MB1,BW] 574-0-574ms    | [S6,MB5,F]  586-7-594ms    | [S6,MB4,BI] 628-9-638ms    | [S2,MB2,BW] 638-0-638ms    | [S6,MB6,F]  645-7-652ms    | [S6,MB5,BI] 694-9-703ms    | [S2,MB3,BW] 704-0-704ms    | [S6,MB7,F]  710-7-718ms    | [S6,MB6,BI] 760-9-769ms    | [S6,MB4,BW] 770-0-770ms    | [S6,MB7,BI] 828-8-836ms    | [S6,MB5,BW] 837-0-837ms    | [S2,MB4,BI] 843-8-852ms    | [S6,MB6,BW] 852-0-852ms    | [S2,MB5,BI] 868-9-877ms    | [S6,MB7,BW] 877-0-877ms    | [S2,MB6,BI] 883-8-892ms    | [S2,MB4,BW] 892-0-892ms    | [S2,MB7,BI] 903-9-912ms    | [S2,MB5,BW] 912-0-912ms    | [S2,MB6,BW] 912-0-912ms    | [S2,MB7,BW] 912-0-912ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-200ms   | [S7,MB0,BI] 212-31-244ms   | [S7,MB1,F]  244-15-259ms   | [S7,MB1,BI] 271-32-304ms   | [S7,MB2,F]  304-17-321ms   | [S7,MB2,BI] 333-33-366ms   | [S7,MB3,F]  366-17-383ms   | [S7,MB3,BI] 396-33-429ms   | [S7,MB0,BW] 430-0-430ms    | [S3,MB4,F]  438-9-447ms    | [S3,MB0,BI] 447-13-460ms   | [S7,MB1,BW] 460-0-460ms    | [S3,MB5,F]  470-8-479ms    | [S3,MB1,BI] 479-12-492ms   | [S7,MB2,BW] 492-0-492ms    | [S3,MB6,F]  501-8-509ms    | [S3,MB2,BI] 509-10-520ms   | [S7,MB3,BW] 520-0-520ms    | [S3,MB7,F]  534-8-542ms    | [S3,MB3,BI] 542-10-553ms   | [S3,MB0,BW] 553-0-553ms    | [S7,MB4,F]  564-13-578ms   | [S7,MB4,BI] 590-32-622ms   | [S3,MB1,BW] 622-0-622ms    | [S7,MB5,F]  628-14-643ms   | [S7,MB5,BI] 655-32-687ms   | [S3,MB2,BW] 687-0-687ms    | [S7,MB6,F]  694-14-709ms   | [S7,MB6,BI] 720-32-753ms   | [S3,MB3,BW] 753-0-753ms    | [S7,MB7,F]  760-15-775ms   | [S7,MB7,BI] 789-32-821ms   | [S7,MB4,BW] 821-0-821ms    | [S3,MB4,BI] 821-11-832ms   | [S7,MB5,BW] 832-0-832ms    | [S3,MB5,BI] 832-12-844ms   | [S7,MB6,BW] 844-0-844ms    | [S3,MB6,BI] 844-11-855ms   | [S7,MB7,BW] 855-0-855ms    | [S3,MB7,BI] 861-12-873ms   | [S3,MB4,BW] 873-0-873ms    | [S3,MB5,BW] 873-0-873ms    | [S3,MB6,BW] 873-0-873ms    | [S3,MB7,BW] 873-0-873ms   
[rank3]:2025-12-31 11:46:28,891 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1146_stage3_step500.svg
[rank3]:2025-12-31 11:46:28,934 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1146_stage7_step500.svg
[rank3]:2025-12-31 11:46:29,033 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank3_stage3.svg
[rank3]:	> Counts Sum: 508, Total Sum: 810 (62.72%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 4.44, 4.44, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank3]:2025-12-31 11:46:29,112 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1146_rank3_stage7.svg
[rank3]:	> Counts Sum: 252, Total Sum: 495 (50.91%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 11:47:11,486 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:47:11,516 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:47:11,497 - Freezing Ratio: [Stage1] 0.81, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:47:11,512 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:47:50,347 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:47:50,373 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:47:50,351 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:47:50,364 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:48:29,198 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:48:29,202 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:48:29,215 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:48:29,224 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:49:07,897 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:49:07,910 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:49:07,895 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:49:07,920 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:49:46,644 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:49:46,641 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:49:46,623 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:49:46,648 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 11:49:46,649 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:49:50,514 - Avg. fwd time: 7.8789 / Avg. bwd-weight time: 2.7935 / Avg. bwd-input time: 9.5441 / Avg. batch time: 949.6619 (ms) / GPU bubble ratio: 65.94%
[rank3]:2025-12-31 11:49:50,478 - Avg. fwd time: 12.0885 / Avg. bwd-weight time: 5.4565 / Avg. bwd-input time: 22.2794 / Avg. batch time: 913.4490 (ms) / GPU bubble ratio: 30.24%
[rank3]:2025-12-31 11:49:50,547 -  step: 550  loss:  3.5650  grad_norm:  0.0000  memory: 40.07GiB(84.35%)  tps: 8,111  tflops: 63.41  mfu: 20.32%
[rank1]:2025-12-31 11:49:50,536 - Avg. fwd time: 10.0505 / Avg. bwd-weight time: 3.4169 / Avg. bwd-input time: 12.1388 / Avg. batch time: 985.8972 (ms) / GPU bubble ratio: 58.44%
[rank1]:2025-12-31 11:49:50,546 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,111  tflops: 63.40  mfu: 20.32%
[rank2]:2025-12-31 11:49:50,546 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,110  tflops: 63.40  mfu: 20.32%
[rank0]:2025-12-31 11:49:50,545 - Avg. fwd time: 8.4768 / Avg. full-bwd time: 13.2854 (Avg. bwd-weight time: 2.6439 / Avg. bwd-input time: 9.6923) / Avg. batch time: 1005.3971 (ms) / GPU bubble ratio: 66.12%
[rank0]:2025-12-31 11:49:50,547 -  step: 550  loss: -4.0000  grad_norm:  0.7240  memory: 21.54GiB(45.33%)  tps: 8,111  tflops: 63.41  mfu: 20.32%
[rank3]:2025-12-31 11:50:25,485 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:50:25,498 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:50:25,481 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:50:25,508 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:51:04,418 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:51:04,431 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:51:04,414 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:51:04,441 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:51:43,071 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:51:43,083 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:51:43,068 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:51:43,093 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:52:21,835 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:52:21,848 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:52:21,831 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:52:21,858 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:53:00,681 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:53:00,689 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:53:00,672 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:53:00,698 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:53:00,699 - Freezing Ratio: [Stage0] 0.11, [Stage4] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:53:05,441 - Avg. fwd time: 7.8943 / Avg. bwd-weight time: 2.5781 / Avg. bwd-input time: 9.5478 / Avg. batch time: 945.1036 (ms) / GPU bubble ratio: 66.11%
[rank0]:2025-12-31 11:53:05,455 - Avg. fwd time: 8.4926 / Avg. full-bwd time: 12.9330 (Avg. bwd-weight time: 2.4400 / Avg. bwd-input time: 9.6920) / Avg. batch time: 1001.1517 (ms) / GPU bubble ratio: 66.40%
[rank3]:2025-12-31 11:53:05,446 - Avg. fwd time: 12.0747 / Avg. bwd-weight time: 5.0358 / Avg. bwd-input time: 22.2673 / Avg. batch time: 908.0757 (ms) / GPU bubble ratio: 30.62%
[rank3]:2025-12-31 11:53:05,500 -  step: 600  loss:  2.9383  grad_norm: 34.9639  memory: 40.07GiB(84.35%)  tps: 8,404  tflops: 65.70  mfu: 21.06%
[rank1]:2025-12-31 11:53:05,461 - Avg. fwd time: 10.0675 / Avg. bwd-weight time: 3.1534 / Avg. bwd-input time: 12.1421 / Avg. batch time: 981.3866 (ms) / GPU bubble ratio: 58.65%
[rank1]:2025-12-31 11:53:05,492 -  step: 600  loss: -4.0000  grad_norm: 34.9639  memory: 20.17GiB(42.46%)  tps: 8,404  tflops: 65.70  mfu: 21.06%
[rank2]:2025-12-31 11:53:05,488 -  step: 600  loss: -4.0000  grad_norm: 34.9639  memory: 15.48GiB(32.59%)  tps: 8,405  tflops: 65.70  mfu: 21.06%
[rank2]:2025-12-31 11:53:05,553 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1153_stage2_step600.svg
[rank0]:2025-12-31 11:53:05,502 -  step: 600  loss: -4.0000  grad_norm: 34.9639  memory: 21.54GiB(45.33%)  tps: 8,404  tflops: 65.70  mfu: 21.06%
[rank0]:2025-12-31 11:53:05,555 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1153_stage0_step600.svg
[rank1]:2025-12-31 11:53:05,559 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1153_stage1_step600.svg
[rank1]:2025-12-31 11:53:05,599 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1153_stage5_step600.svg
[rank2]:2025-12-31 11:53:05,600 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1153_stage6_step600.svg
[rank0]:2025-12-31 11:53:05,606 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1153_stage4_step600.svg
[rank1]:2025-12-31 11:53:05,737 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank1_stage1.svg
[rank1]:	> Counts Sum: 947, Total Sum: 1485 (63.77%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 1.81, 1.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0]
[rank2]:2025-12-31 11:53:05,698 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank2_stage2.svg
[rank2]:	> Counts Sum: 631, Total Sum: 990 (63.74%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 1.81, 0.0]
[rank0]:2025-12-31 11:53:05,728 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank0_stage0.svg
[rank0]:	> Counts Sum: 720, Total Sum: 1045 (68.90%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 45.45, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 1.81, 34.54]
[rank3]:2025-12-31 11:53:05,802 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1153_step600_rank3.svg
[rank3]:			> Batch Time: 950.36 ms, GPU Bubble Ratio: 70.17%, 62.25%, 70.28%, 43.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-138ms    | [S4,MB3,F]  169-9-178ms    | [S4,MB0,BI] 283-9-292ms    | [S4,MB0,BW] 292-0-292ms    | [S0,MB4,F]  292-8-300ms    | [S4,MB1,BI] 343-10-353ms   | [S4,MB1,BW] 353-0-353ms    | [S0,MB5,F]  353-8-362ms    | [S4,MB2,BI] 417-10-427ms   | [S4,MB2,BW] 427-0-427ms    | [S0,MB6,F]  428-8-436ms    | [S4,MB3,BI] 470-9-480ms    | [S4,MB3,BW] 480-0-480ms    | [S0,MB7,F]  480-8-489ms    | [S0,MB0,B]  510-9-519ms    | [S4,MB4,F]  519-8-527ms    | [S0,MB1,B]  545-9-554ms    | [S4,MB5,F]  554-8-562ms    | [S0,MB2,B]  575-8-584ms    | [S4,MB6,F]  584-8-592ms    | [S0,MB3,B]  606-8-614ms    | [S4,MB7,F]  615-8-623ms    | [S4,MB4,BI] 660-10-670ms   | [S4,MB4,BW] 670-0-670ms    | [S4,MB5,BI] 741-9-750ms    | [S4,MB5,BW] 750-0-750ms    | [S4,MB6,BI] 789-9-798ms    | [S4,MB6,BW] 799-0-799ms    | [S4,MB7,BI] 857-9-866ms    | [S4,MB7,BW] 866-0-866ms    | [S0,MB4,B]  877-7-885ms    | [S0,MB5,B]  903-7-910ms    | [S0,MB6,B]  922-7-930ms    | [S0,MB7,B]  942-7-950ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  197-7-205ms    | [S5,MB0,BI] 266-9-275ms    | [S5,MB3,F]  276-9-285ms    | [S5,MB1,BI] 327-9-336ms    | [S5,MB0,BW] 336-0-336ms    | [S1,MB4,F]  343-12-355ms   | [S5,MB2,BI] 388-10-398ms   | [S5,MB1,BW] 398-0-398ms    | [S1,MB5,F]  417-12-429ms   | [S5,MB3,BI] 451-11-463ms   | [S5,MB2,BW] 462-0-462ms    | [S1,MB6,F]  472-12-485ms   | [S1,MB0,BI] 486-15-502ms   | [S5,MB3,BW] 502-0-502ms    | [S1,MB7,F]  510-12-523ms   | [S1,MB1,BI] 523-15-538ms   | [S1,MB0,BW] 538-0-538ms    | [S5,MB4,F]  545-8-553ms    | [S1,MB2,BI] 553-15-568ms   | [S1,MB1,BW] 569-0-569ms    | [S5,MB5,F]  575-8-584ms    | [S1,MB3,BI] 584-15-599ms   | [S1,MB2,BW] 599-0-599ms    | [S5,MB6,F]  606-8-614ms    | [S5,MB4,BI] 643-10-653ms   | [S1,MB3,BW] 654-0-654ms    | [S5,MB7,F]  660-8-668ms    | [S5,MB5,BI] 708-10-718ms   | [S5,MB4,BW] 719-0-719ms    | [S5,MB6,BI] 774-9-783ms    | [S5,MB5,BW] 783-0-783ms    | [S5,MB7,BI] 842-9-851ms    | [S5,MB6,BW] 851-0-851ms    | [S1,MB4,BI] 857-13-871ms   | [S5,MB7,BW] 871-0-871ms    | [S1,MB5,BI] 882-13-896ms   | [S1,MB4,BW] 896-0-896ms    | [S1,MB6,BI] 902-13-916ms   | [S1,MB5,BW] 916-0-916ms    | [S1,MB7,BI] 922-13-936ms   | [S1,MB6,BW] 936-0-936ms    | [S1,MB7,BW] 936-0-936ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-148ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB0,BI] 250-9-260ms    | [S6,MB2,F]  259-9-269ms    | [S6,MB1,BI] 311-9-320ms    | [S6,MB3,F]  320-9-329ms    | [S6,MB2,BI] 373-8-382ms    | [S6,MB0,BW] 382-0-382ms    | [S2,MB4,F]  389-7-397ms    | [S6,MB3,BI] 435-9-445ms    | [S6,MB1,BW] 445-0-445ms    | [S2,MB5,F]  453-7-461ms    | [S2,MB0,BI] 468-10-479ms   | [S6,MB2,BW] 478-0-478ms    | [S2,MB6,F]  489-8-497ms    | [S2,MB1,BI] 497-11-508ms   | [S6,MB3,BW] 508-0-508ms    | [S2,MB7,F]  523-8-532ms    | [S2,MB2,BI] 531-10-542ms   | [S2,MB0,BW] 542-0-542ms    | [S6,MB4,F]  554-8-562ms    | [S2,MB3,BI] 562-10-572ms   | [S2,MB1,BW] 573-0-573ms    | [S6,MB5,F]  584-7-592ms    | [S6,MB4,BI] 627-9-636ms    | [S2,MB2,BW] 637-0-637ms    | [S6,MB6,F]  644-7-652ms    | [S6,MB5,BI] 692-9-702ms    | [S2,MB3,BW] 702-0-702ms    | [S6,MB7,F]  709-7-717ms    | [S6,MB6,BI] 758-9-767ms    | [S6,MB4,BW] 768-0-768ms    | [S6,MB7,BI] 827-8-835ms    | [S6,MB5,BW] 835-0-835ms    | [S2,MB4,BI] 842-8-851ms    | [S6,MB6,BW] 851-0-851ms    | [S2,MB5,BI] 867-9-876ms    | [S6,MB7,BW] 876-0-876ms    | [S2,MB6,BI] 882-8-891ms    | [S2,MB4,BW] 891-0-891ms    | [S2,MB7,BI] 902-9-911ms    | [S2,MB5,BW] 911-0-911ms    | [S2,MB6,BW] 911-0-911ms    | [S2,MB7,BW] 911-0-911ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-200ms   | [S7,MB0,BI] 212-31-244ms   | [S7,MB1,F]  244-15-259ms   | [S7,MB1,BI] 271-32-304ms   | [S7,MB2,F]  304-17-321ms   | [S7,MB2,BI] 333-32-366ms   | [S7,MB3,F]  366-17-383ms   | [S7,MB3,BI] 395-33-428ms   | [S7,MB0,BW] 428-0-428ms    | [S3,MB4,F]  436-8-445ms    | [S3,MB0,BI] 446-12-459ms   | [S7,MB1,BW] 460-0-460ms    | [S3,MB5,F]  469-8-477ms    | [S3,MB1,BI] 477-12-490ms   | [S7,MB2,BW] 490-0-490ms    | [S3,MB6,F]  499-8-507ms    | [S3,MB2,BI] 507-10-518ms   | [S7,MB3,BW] 518-0-518ms    | [S3,MB7,F]  533-8-541ms    | [S3,MB3,BI] 540-10-551ms   | [S3,MB0,BW] 551-0-551ms    | [S7,MB4,F]  563-13-577ms   | [S7,MB4,BI] 588-32-620ms   | [S3,MB1,BW] 620-0-620ms    | [S7,MB5,F]  627-15-643ms   | [S7,MB5,BI] 653-32-686ms   | [S3,MB2,BW] 686-0-686ms    | [S7,MB6,F]  692-14-707ms   | [S7,MB6,BI] 719-32-751ms   | [S3,MB3,BW] 751-0-751ms    | [S7,MB7,F]  758-14-773ms   | [S7,MB7,BI] 787-32-819ms   | [S7,MB4,BW] 819-0-819ms    | [S3,MB4,BI] 819-11-830ms   | [S7,MB5,BW] 830-0-830ms    | [S3,MB5,BI] 830-11-842ms   | [S7,MB6,BW] 842-0-842ms    | [S3,MB6,BI] 842-11-853ms   | [S7,MB7,BW] 853-0-853ms    | [S3,MB7,BI] 860-12-872ms   | [S3,MB4,BW] 872-0-872ms    | [S3,MB5,BW] 872-0-872ms    | [S3,MB6,BW] 872-0-872ms    | [S3,MB7,BW] 872-0-872ms   
[rank1]:2025-12-31 11:53:05,835 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank1_stage5.svg
[rank1]:	> Counts Sum: 633, Total Sum: 990 (63.94%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 1.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 3.63, 0.0]
[rank2]:2025-12-31 11:53:05,794 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank2_stage6.svg
[rank2]:	> Counts Sum: 630, Total Sum: 990 (63.64%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0]
[rank0]:2025-12-31 11:53:05,832 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank0_stage4.svg
[rank0]:	> Counts Sum: 630, Total Sum: 990 (63.64%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0]
[rank3]:2025-12-31 11:53:05,844 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1153_stage3_step600.svg
[rank3]:2025-12-31 11:53:05,889 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1153_stage7_step600.svg
[rank3]:2025-12-31 11:53:05,986 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank3_stage3.svg
[rank3]:	> Counts Sum: 634, Total Sum: 990 (64.04%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 3.63, 3.63, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0]
[rank3]:2025-12-31 11:53:06,065 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1153_rank3_stage7.svg
[rank3]:	> Counts Sum: 315, Total Sum: 605 (52.07%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 11:53:48,351 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:53:48,336 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:53:48,325 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:53:48,355 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:54:27,045 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:54:27,028 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:54:27,055 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:54:27,032 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:55:05,807 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:55:05,790 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:55:05,816 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:55:05,793 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:55:44,584 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:55:44,597 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:55:44,606 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:55:44,581 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:56:23,552 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:56:23,550 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:56:23,532 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:56:23,558 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 11:56:23,560 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:56:27,358 - Avg. fwd time: 12.0666 / Avg. bwd-weight time: 4.9278 / Avg. bwd-input time: 22.2638 / Avg. batch time: 906.6047 (ms) / GPU bubble ratio: 30.72%
[rank1]:2025-12-31 11:56:27,416 - Avg. fwd time: 10.0704 / Avg. bwd-weight time: 3.0854 / Avg. bwd-input time: 12.1444 / Avg. batch time: 980.1859 (ms) / GPU bubble ratio: 58.70%
[rank2]:2025-12-31 11:56:27,395 - Avg. fwd time: 7.8971 / Avg. bwd-weight time: 2.5228 / Avg. bwd-input time: 9.5500 / Avg. batch time: 943.8945 (ms) / GPU bubble ratio: 66.15%
[rank0]:2025-12-31 11:56:27,425 - Avg. fwd time: 8.4959 / Avg. full-bwd time: 12.8244 (Avg. bwd-weight time: 2.3873 / Avg. bwd-input time: 9.6934) / Avg. batch time: 1000.0019 (ms) / GPU bubble ratio: 66.48%
[rank0]:2025-12-31 11:56:27,427 -  step: 650  loss: -4.0000  grad_norm:  1.5902  memory: 21.54GiB(45.33%)  tps: 8,114  tflops: 63.43  mfu: 20.33%
[rank3]:2025-12-31 11:56:27,427 -  step: 650  loss:  3.7019  grad_norm:  0.0000  memory: 40.07GiB(84.35%)  tps: 8,114  tflops: 63.43  mfu: 20.33%
[rank1]:2025-12-31 11:56:27,426 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,114  tflops: 63.43  mfu: 20.33%
[rank2]:2025-12-31 11:56:27,426 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,113  tflops: 63.43  mfu: 20.33%
[rank3]:2025-12-31 11:57:02,280 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:57:02,293 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:57:02,276 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:57:02,302 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:57:41,065 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:57:41,079 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:57:41,062 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:57:41,088 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:58:19,916 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:58:19,929 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:58:19,912 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:58:19,938 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:58:58,785 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:58:58,802 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:58:58,811 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:58:58,789 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:59:37,527 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 11:59:37,517 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 11:59:37,534 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 11:59:37,543 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:59:37,544 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 11:59:41,334 - Avg. fwd time: 12.0549 / Avg. bwd-weight time: 4.5760 / Avg. bwd-input time: 22.2581 / Avg. batch time: 902.1394 (ms) / GPU bubble ratio: 31.03%
[rank3]:2025-12-31 11:59:41,402 -  step: 700  loss:  3.7823  grad_norm:  0.0000  memory: 40.07GiB(84.35%)  tps: 8,447  tflops: 66.03  mfu: 21.16%
[rank1]:2025-12-31 11:59:41,392 - Avg. fwd time: 10.0845 / Avg. bwd-weight time: 2.8652 / Avg. bwd-input time: 12.1494 / Avg. batch time: 976.4424 (ms) / GPU bubble ratio: 58.87%
[rank1]:2025-12-31 11:59:41,402 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,446  tflops: 66.03  mfu: 21.16%
[rank1]:2025-12-31 11:59:41,460 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1159_stage1_step700.svg
[rank2]:2025-12-31 11:59:41,370 - Avg. fwd time: 7.9099 / Avg. bwd-weight time: 2.3428 / Avg. bwd-input time: 9.5538 / Avg. batch time: 940.1019 (ms) / GPU bubble ratio: 66.29%
[rank2]:2025-12-31 11:59:41,402 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,446  tflops: 66.03  mfu: 21.16%
[rank2]:2025-12-31 11:59:41,454 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1159_stage2_step700.svg
[rank0]:2025-12-31 11:59:41,400 - Avg. fwd time: 8.5087 / Avg. full-bwd time: 12.5129 (Avg. bwd-weight time: 2.2169 / Avg. bwd-input time: 9.6955) / Avg. batch time: 996.4549 (ms) / GPU bubble ratio: 66.73%
[rank0]:2025-12-31 11:59:41,402 -  step: 700  loss: -4.0000  grad_norm:  1.2679  memory: 21.54GiB(45.33%)  tps: 8,446  tflops: 66.03  mfu: 21.16%
[rank0]:2025-12-31 11:59:41,454 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1159_stage0_step700.svg
[rank1]:2025-12-31 11:59:41,503 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1159_stage5_step700.svg
[rank2]:2025-12-31 11:59:41,502 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1159_stage6_step700.svg
[rank0]:2025-12-31 11:59:41,502 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1159_stage4_step700.svg
[rank1]:2025-12-31 11:59:41,627 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank1_stage1.svg
[rank1]:	> Counts Sum: 1157, Total Sum: 1755 (65.93%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 1.53, 1.53, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0]
[rank2]:2025-12-31 11:59:41,600 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank2_stage2.svg
[rank2]:	> Counts Sum: 771, Total Sum: 1170 (65.90%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 1.53, 0.0]
[rank0]:2025-12-31 11:59:41,602 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank0_stage0.svg
[rank0]:	> Counts Sum: 887, Total Sum: 1235 (71.82%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 52.3, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 1.53, 41.53]
[rank3]:2025-12-31 11:59:41,704 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1159_step700_rank3.svg
[rank3]:			> Batch Time: 949.37 ms, GPU Bubble Ratio: 70.08%, 62.14%, 70.22%, 42.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  48-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-138ms    | [S4,MB3,F]  169-9-178ms    | [S4,MB0,BI] 283-9-292ms    | [S4,MB0,BW] 292-0-292ms    | [S0,MB4,F]  292-8-300ms    | [S4,MB1,BI] 343-10-353ms   | [S4,MB1,BW] 353-0-353ms    | [S0,MB5,F]  353-8-361ms    | [S4,MB2,BI] 417-10-427ms   | [S4,MB2,BW] 428-0-428ms    | [S0,MB6,F]  428-8-436ms    | [S4,MB3,BI] 470-9-480ms    | [S4,MB3,BW] 480-0-480ms    | [S0,MB7,F]  480-8-489ms    | [S0,MB0,B]  509-9-518ms    | [S4,MB4,F]  519-8-527ms    | [S0,MB1,B]  545-9-554ms    | [S4,MB5,F]  554-8-562ms    | [S0,MB2,B]  575-8-584ms    | [S4,MB6,F]  584-8-592ms    | [S0,MB3,B]  606-8-614ms    | [S4,MB7,F]  615-8-623ms    | [S4,MB4,BI] 660-10-670ms   | [S4,MB4,BW] 670-0-670ms    | [S4,MB5,BI] 740-9-749ms    | [S4,MB5,BW] 750-0-750ms    | [S4,MB6,BI] 789-9-798ms    | [S4,MB6,BW] 798-0-798ms    | [S4,MB7,BI] 856-9-865ms    | [S4,MB7,BW] 865-0-865ms    | [S0,MB4,B]  876-7-884ms    | [S0,MB5,B]  901-7-909ms    | [S0,MB6,B]  921-7-929ms    | [S0,MB7,B]  941-7-949ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  48-11-60ms     | [S1,MB2,F]  89-11-100ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  197-7-205ms    | [S5,MB0,BI] 266-9-276ms    | [S5,MB3,F]  276-9-285ms    | [S5,MB1,BI] 327-9-336ms    | [S5,MB0,BW] 336-0-336ms    | [S1,MB4,F]  343-12-356ms   | [S5,MB2,BI] 388-10-398ms   | [S5,MB1,BW] 398-0-398ms    | [S1,MB5,F]  417-12-429ms   | [S5,MB3,BI] 452-11-463ms   | [S5,MB2,BW] 463-0-463ms    | [S1,MB6,F]  472-12-484ms   | [S1,MB0,BI] 486-15-501ms   | [S5,MB3,BW] 502-0-502ms    | [S1,MB7,F]  510-12-522ms   | [S1,MB1,BI] 522-15-537ms   | [S1,MB0,BW] 537-0-537ms    | [S5,MB4,F]  544-8-553ms    | [S1,MB2,BI] 553-15-569ms   | [S1,MB1,BW] 568-0-568ms    | [S5,MB5,F]  575-8-584ms    | [S1,MB3,BI] 584-15-599ms   | [S1,MB2,BW] 599-0-599ms    | [S5,MB6,F]  606-8-614ms    | [S5,MB4,BI] 643-10-654ms   | [S1,MB3,BW] 653-0-653ms    | [S5,MB7,F]  660-8-668ms    | [S5,MB5,BI] 708-10-718ms   | [S5,MB4,BW] 718-0-718ms    | [S5,MB6,BI] 773-9-782ms    | [S5,MB5,BW] 782-0-782ms    | [S5,MB7,BI] 840-9-850ms    | [S5,MB6,BW] 850-0-850ms    | [S1,MB4,BI] 856-13-870ms   | [S5,MB7,BW] 869-0-869ms    | [S1,MB5,BI] 881-13-895ms   | [S1,MB4,BW] 895-0-895ms    | [S1,MB6,BI] 901-13-915ms   | [S1,MB5,BW] 915-0-915ms    | [S1,MB7,BI] 921-13-935ms   | [S1,MB6,BW] 935-0-935ms    | [S1,MB7,BW] 935-0-935ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  100-7-108ms    | [S2,MB3,F]  141-7-148ms    | [S6,MB0,F]  177-7-184ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB0,BI] 251-9-260ms    | [S6,MB2,F]  260-9-269ms    | [S6,MB1,BI] 311-9-320ms    | [S6,MB3,F]  320-9-329ms    | [S6,MB2,BI] 373-8-382ms    | [S6,MB0,BW] 382-0-382ms    | [S2,MB4,F]  389-7-397ms    | [S6,MB3,BI] 436-9-445ms    | [S6,MB1,BW] 446-0-446ms    | [S2,MB5,F]  454-7-462ms    | [S2,MB0,BI] 467-10-478ms   | [S6,MB2,BW] 477-0-477ms    | [S2,MB6,F]  488-8-497ms    | [S2,MB1,BI] 497-11-508ms   | [S6,MB3,BW] 508-0-508ms    | [S2,MB7,F]  523-8-531ms    | [S2,MB2,BI] 531-10-542ms   | [S2,MB0,BW] 541-0-541ms    | [S6,MB4,F]  554-8-562ms    | [S2,MB3,BI] 562-10-573ms   | [S2,MB1,BW] 572-0-572ms    | [S6,MB5,F]  584-7-592ms    | [S6,MB4,BI] 627-9-637ms    | [S2,MB2,BW] 637-0-637ms    | [S6,MB6,F]  644-7-652ms    | [S6,MB5,BI] 692-9-702ms    | [S2,MB3,BW] 702-0-702ms    | [S6,MB7,F]  708-7-716ms    | [S6,MB6,BI] 757-9-767ms    | [S6,MB4,BW] 767-0-767ms    | [S6,MB7,BI] 825-8-834ms    | [S6,MB5,BW] 834-0-834ms    | [S2,MB4,BI] 841-8-850ms    | [S6,MB6,BW] 849-0-849ms    | [S2,MB5,BI] 866-8-875ms    | [S6,MB7,BW] 875-0-875ms    | [S2,MB6,BI] 881-8-890ms    | [S2,MB4,BW] 890-0-890ms    | [S2,MB7,BI] 901-9-910ms    | [S2,MB5,BW] 910-0-910ms    | [S2,MB6,BW] 910-0-910ms    | [S2,MB7,BW] 910-0-910ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  148-7-156ms    | [S7,MB0,F]  184-15-200ms   | [S7,MB0,BI] 212-31-244ms   | [S7,MB1,F]  244-15-259ms   | [S7,MB1,BI] 271-32-304ms   | [S7,MB2,F]  304-17-321ms   | [S7,MB2,BI] 333-33-366ms   | [S7,MB3,F]  366-17-383ms   | [S7,MB3,BI] 396-33-429ms   | [S7,MB0,BW] 429-0-429ms    | [S3,MB4,F]  436-9-445ms    | [S3,MB0,BI] 445-13-458ms   | [S7,MB1,BW] 458-0-458ms    | [S3,MB5,F]  469-8-477ms    | [S3,MB1,BI] 477-12-490ms   | [S7,MB2,BW] 490-0-490ms    | [S3,MB6,F]  499-8-507ms    | [S3,MB2,BI] 507-10-518ms   | [S7,MB3,BW] 518-0-518ms    | [S3,MB7,F]  532-8-540ms    | [S3,MB3,BI] 541-10-551ms   | [S3,MB0,BW] 551-0-551ms    | [S7,MB4,F]  563-13-577ms   | [S7,MB4,BI] 589-31-621ms   | [S3,MB1,BW] 621-0-621ms    | [S7,MB5,F]  628-15-643ms   | [S7,MB5,BI] 653-32-685ms   | [S3,MB2,BW] 686-0-686ms    | [S7,MB6,F]  693-14-707ms   | [S7,MB6,BI] 719-32-751ms   | [S3,MB3,BW] 751-0-751ms    | [S7,MB7,F]  757-14-772ms   | [S7,MB7,BI] 786-32-819ms   | [S7,MB4,BW] 819-0-819ms    | [S3,MB4,BI] 819-11-830ms   | [S7,MB5,BW] 830-0-830ms    | [S3,MB5,BI] 830-12-842ms   | [S7,MB6,BW] 841-0-841ms    | [S3,MB6,BI] 841-11-853ms   | [S7,MB7,BW] 852-0-852ms    | [S3,MB7,BI] 859-12-871ms   | [S3,MB4,BW] 871-0-871ms    | [S3,MB5,BW] 871-0-871ms    | [S3,MB6,BW] 871-0-871ms    | [S3,MB7,BW] 871-0-871ms   
[rank1]:2025-12-31 11:59:41,726 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank1_stage5.svg
[rank1]:	> Counts Sum: 773, Total Sum: 1170 (66.07%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 1.53, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 3.07, 0.0]
[rank2]:2025-12-31 11:59:41,697 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank2_stage6.svg
[rank2]:	> Counts Sum: 770, Total Sum: 1170 (65.81%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0]
[rank0]:2025-12-31 11:59:41,699 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank0_stage4.svg
[rank0]:	> Counts Sum: 770, Total Sum: 1170 (65.81%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0]
[rank3]:2025-12-31 11:59:41,749 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1159_stage3_step700.svg
[rank3]:2025-12-31 11:59:41,798 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1159_stage7_step700.svg
[rank3]:2025-12-31 11:59:41,896 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank3_stage3.svg
[rank3]:	> Counts Sum: 774, Total Sum: 1170 (66.15%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 3.07, 3.07, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0]
[rank3]:2025-12-31 11:59:41,974 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1159_rank3_stage7.svg
[rank3]:	> Counts Sum: 385, Total Sum: 715 (53.85%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:00:16,797 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:00:16,823 - Freezing Ratio: [Stage0] 0.11, [Stage4] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:00:16,800 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:00:16,814 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:01:04,017 - Freezing Ratio: [Stage3] 0.83, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:01:03,990 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:01:04,001 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:01:04,020 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:01:42,918 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:01:42,944 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:01:42,921 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:01:42,935 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:02:21,804 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:02:21,780 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:02:21,776 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:02:21,793 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:03:00,669 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:03:00,653 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:03:00,667 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:03:00,673 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 12:03:00,675 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:03:04,519 - Avg. fwd time: 12.0556 / Avg. bwd-weight time: 4.5407 / Avg. bwd-input time: 22.2614 / Avg. batch time: 901.7556 (ms) / GPU bubble ratio: 31.05%
[rank3]:2025-12-31 12:03:04,586 -  step: 750  loss:  3.2239  grad_norm:  0.0000  memory: 40.07GiB(84.35%)  tps: 8,064  tflops: 63.04  mfu: 20.20%
[rank2]:2025-12-31 12:03:04,554 - Avg. fwd time: 7.9109 / Avg. bwd-weight time: 2.3245 / Avg. bwd-input time: 9.5563 / Avg. batch time: 939.8433 (ms) / GPU bubble ratio: 66.31%
[rank2]:2025-12-31 12:03:04,585 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,064  tflops: 63.04  mfu: 20.20%
[rank1]:2025-12-31 12:03:04,576 - Avg. fwd time: 10.0858 / Avg. bwd-weight time: 2.8428 / Avg. bwd-input time: 12.1532 / Avg. batch time: 976.1978 (ms) / GPU bubble ratio: 58.89%
[rank1]:2025-12-31 12:03:04,585 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,064  tflops: 63.04  mfu: 20.20%
[rank0]:2025-12-31 12:03:04,584 - Avg. fwd time: 8.5103 / Avg. full-bwd time: 12.4685 (Avg. bwd-weight time: 2.1995 / Avg. bwd-input time: 9.6981) / Avg. batch time: 996.2216 (ms) / GPU bubble ratio: 66.77%
[rank0]:2025-12-31 12:03:04,586 -  step: 750  loss: -4.0000  grad_norm:  0.6004  memory: 21.59GiB(45.45%)  tps: 8,064  tflops: 63.04  mfu: 20.20%
[rank3]:2025-12-31 12:03:39,520 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:03:39,515 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:03:39,533 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:03:39,541 - Freezing Ratio: [Stage0] 0.84, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:04:18,441 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:04:18,437 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:04:18,454 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:04:18,463 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:04:57,229 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:04:57,242 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:04:57,225 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:04:57,251 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:05:36,030 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:05:36,034 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:05:36,047 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:05:36,057 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:06:14,919 - Freezing Ratio: [Stage3] 0.78, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-31 12:06:14,909 - Freezing Ratio: [Stage2] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-31 12:06:14,926 - Freezing Ratio: [Stage1] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-31 12:06:14,935 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 12:06:14,936 - Freezing Ratio: [Stage0] 0.89, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 12:06:18,808 - Avg. fwd time: 12.0495 / Avg. bwd-weight time: 4.2571 / Avg. bwd-input time: 22.2595 / Avg. batch time: 898.2442 (ms) / GPU bubble ratio: 31.30%
[rank2]:2025-12-31 12:06:18,844 - Avg. fwd time: 7.9214 / Avg. bwd-weight time: 2.1793 / Avg. bwd-input time: 9.5601 / Avg. batch time: 936.8726 (ms) / GPU bubble ratio: 66.42%
[rank2]:2025-12-31 12:06:18,876 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 15.48GiB(32.59%)  tps: 8,433  tflops: 65.92  mfu: 21.13%
[rank2]:2025-12-31 12:06:18,876 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 8,547  tflops: 66.82  mfu: 19.44%
[rank2]:2025-12-31 12:06:18,876 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 12:06:18,877 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 12:06:18,866 - Avg. fwd time: 10.0980 / Avg. bwd-weight time: 2.6653 / Avg. bwd-input time: 12.1585 / Avg. batch time: 973.2703 (ms) / GPU bubble ratio: 59.03%
[rank1]:2025-12-31 12:06:18,876 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.17GiB(42.46%)  tps: 8,433  tflops: 65.92  mfu: 21.13%
[rank1]:2025-12-31 12:06:18,876 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 8,547  tflops: 66.82  mfu: 19.43%
[rank1]:2025-12-31 12:06:18,876 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 12:06:18,876 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 12:06:18,874 - Avg. fwd time: 8.5214 / Avg. full-bwd time: 12.2195 (Avg. bwd-weight time: 2.0622 / Avg. bwd-input time: 9.6998) / Avg. batch time: 993.4513 (ms) / GPU bubble ratio: 66.96%
[rank0]:2025-12-31 12:06:18,876 -  step: 800  loss: -4.0000  grad_norm:  2.4451  memory: 21.59GiB(45.45%)  tps: 8,433  tflops: 65.92  mfu: 21.13%
[rank0]:2025-12-31 12:06:18,876 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  2.4451  tps: 8,547  tflops: 66.82  mfu: 19.44%
[rank0]:2025-12-31 12:06:18,876 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 12:06:18,877 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-31 12:06:18,876 -  step: 800  loss:  2.8558  grad_norm:  0.0000  memory: 40.07GiB(84.35%)  tps: 8,433  tflops: 65.92  mfu: 21.13%
[rank3]:2025-12-31 12:06:18,877 - â„¹ï¸ final step: 800  loss:  2.8558  grad_norm:  0.0000  tps: 8,560  tflops: 66.92  mfu: 19.66%
[rank3]:2025-12-31 12:06:18,877 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 12:06:18,878 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 12:06:20,810 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-31 12:06:20,884 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1206_stage2_final800.svg
[rank1]:2025-12-31 12:06:20,891 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1206_stage1_final800.svg
[rank0]:2025-12-31 12:06:20,883 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1206_stage0_final800.svg
[rank2]:2025-12-31 12:06:20,933 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank2/251231_1206_stage6_final800.svg
[rank1]:2025-12-31 12:06:20,936 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank1/251231_1206_stage5_final800.svg
[rank0]:2025-12-31 12:06:20,933 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank0/251231_1206_stage4_final800.svg
[rank2]:2025-12-31 12:06:21,031 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank2_stage2.svg
[rank2]:	> Counts Sum: 897, Total Sum: 1350 (66.44%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 0.0]
[rank1]:2025-12-31 12:06:21,061 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank1_stage1.svg
[rank1]:	> Counts Sum: 1346, Total Sum: 2025 (66.47%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 1.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0]
[rank0]:2025-12-31 12:06:21,034 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank0_stage0.svg
[rank0]:	> Counts Sum: 1040, Total Sum: 1425 (72.98%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 57.33, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 48.0]
[rank3]:2025-12-31 12:06:21,135 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1206_final800_rank3.svg
[rank3]:			> Batch Time: 955.77 ms, GPU Bubble Ratio: 69.11%, 62.49%, 70.49%, 43.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-9-98ms      | [S4,MB2,F]  129-9-138ms    | [S4,MB3,F]  169-9-178ms    | [S4,MB0,BI] 282-9-292ms    | [S4,MB0,BW] 292-0-292ms    | [S0,MB4,F]  293-8-301ms    | [S4,MB1,BI] 342-10-352ms   | [S4,MB1,BW] 352-0-352ms    | [S0,MB5,F]  353-8-362ms    | [S4,MB2,BI] 416-10-426ms   | [S4,MB2,BW] 427-0-427ms    | [S0,MB6,F]  428-8-437ms    | [S4,MB3,BI] 472-9-482ms    | [S4,MB3,BW] 482-0-482ms    | [S0,MB7,F]  484-8-492ms    | [S0,MB0,B]  513-10-523ms   | [S4,MB4,F]  523-8-531ms    | [S0,MB1,B]  548-10-558ms   | [S4,MB5,F]  558-8-566ms    | [S0,MB2,B]  579-10-589ms   | [S4,MB6,F]  588-8-596ms    | [S0,MB3,B]  609-10-619ms   | [S4,MB7,F]  619-8-627ms    | [S4,MB4,BI] 664-10-674ms   | [S4,MB4,BW] 674-0-674ms    | [S4,MB5,BI] 746-9-755ms    | [S4,MB5,BW] 755-0-755ms    | [S4,MB6,BI] 795-9-804ms    | [S4,MB6,BW] 804-0-804ms    | [S4,MB7,BI] 861-9-870ms    | [S4,MB7,BW] 870-0-870ms    | [S0,MB4,B]  881-9-890ms    | [S0,MB5,B]  906-9-915ms    | [S0,MB6,B]  926-9-935ms    | [S0,MB7,B]  946-9-955ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  89-11-100ms    | [S1,MB3,F]  129-11-140ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  197-7-205ms    | [S5,MB0,BI] 266-9-276ms    | [S5,MB3,F]  276-9-285ms    | [S5,MB1,BI] 326-9-335ms    | [S5,MB0,BW] 336-0-336ms    | [S1,MB4,F]  343-12-355ms   | [S5,MB2,BI] 387-10-397ms   | [S5,MB1,BW] 397-0-397ms    | [S1,MB5,F]  416-12-428ms   | [S5,MB3,BI] 451-11-462ms   | [S5,MB2,BW] 462-0-462ms    | [S1,MB6,F]  474-12-486ms   | [S1,MB0,BI] 488-15-504ms   | [S5,MB3,BW] 504-0-504ms    | [S1,MB7,F]  513-12-526ms   | [S1,MB1,BI] 526-14-541ms   | [S1,MB0,BW] 541-0-541ms    | [S5,MB4,F]  548-8-557ms    | [S1,MB2,BI] 557-15-572ms   | [S1,MB1,BW] 572-0-572ms    | [S5,MB5,F]  579-8-587ms    | [S1,MB3,BI] 587-15-602ms   | [S1,MB2,BW] 603-0-603ms    | [S5,MB6,F]  609-8-617ms    | [S5,MB4,BI] 647-10-657ms   | [S1,MB3,BW] 657-0-657ms    | [S5,MB7,F]  664-8-672ms    | [S5,MB5,BI] 713-10-723ms   | [S5,MB4,BW] 723-0-723ms    | [S5,MB6,BI] 780-9-789ms    | [S5,MB5,BW] 789-0-789ms    | [S5,MB7,BI] 846-9-855ms    | [S5,MB6,BW] 855-0-855ms    | [S1,MB4,BI] 861-13-875ms   | [S5,MB7,BW] 875-0-875ms    | [S1,MB5,BI] 886-13-900ms   | [S1,MB4,BW] 900-0-900ms    | [S1,MB6,BI] 906-13-920ms   | [S1,MB5,BW] 920-0-920ms    | [S1,MB7,BI] 926-13-940ms   | [S1,MB6,BW] 940-0-940ms    | [S1,MB7,BW] 940-0-940ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  100-7-108ms    | [S2,MB3,F]  141-7-148ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB0,BI] 250-9-260ms    | [S6,MB2,F]  259-9-269ms    | [S6,MB1,BI] 310-9-320ms    | [S6,MB3,F]  320-9-329ms    | [S6,MB2,BI] 372-8-381ms    | [S6,MB0,BW] 381-0-381ms    | [S2,MB4,F]  388-7-396ms    | [S6,MB3,BI] 435-9-444ms    | [S6,MB1,BW] 444-0-444ms    | [S2,MB5,F]  453-7-461ms    | [S2,MB0,BI] 470-10-480ms   | [S6,MB2,BW] 480-0-480ms    | [S2,MB6,F]  491-8-499ms    | [S2,MB1,BI] 500-10-511ms   | [S6,MB3,BW] 512-0-512ms    | [S2,MB7,F]  527-8-535ms    | [S2,MB2,BI] 535-10-545ms   | [S2,MB0,BW] 545-0-545ms    | [S6,MB4,F]  557-8-565ms    | [S2,MB3,BI] 566-10-576ms   | [S2,MB1,BW] 576-0-576ms    | [S6,MB5,F]  588-7-596ms    | [S6,MB4,BI] 631-9-640ms    | [S2,MB2,BW] 640-0-640ms    | [S6,MB6,F]  647-7-655ms    | [S6,MB5,BI] 697-9-706ms    | [S2,MB3,BW] 707-0-707ms    | [S6,MB7,F]  714-7-721ms    | [S6,MB6,BI] 763-9-773ms    | [S6,MB4,BW] 773-0-773ms    | [S6,MB7,BI] 830-8-839ms    | [S6,MB5,BW] 839-0-839ms    | [S2,MB4,BI] 846-8-854ms    | [S6,MB6,BW] 855-0-855ms    | [S2,MB5,BI] 871-8-880ms    | [S6,MB7,BW] 880-0-880ms    | [S2,MB6,BI] 886-8-895ms    | [S2,MB4,BW] 895-0-895ms    | [S2,MB7,BI] 906-8-915ms    | [S2,MB5,BW] 915-0-915ms    | [S2,MB6,BW] 915-0-915ms    | [S2,MB7,BW] 915-0-915ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  148-7-156ms    | [S7,MB0,F]  184-15-200ms   | [S7,MB0,BI] 212-31-244ms   | [S7,MB1,F]  244-15-259ms   | [S7,MB1,BI] 271-32-304ms   | [S7,MB2,F]  304-17-321ms   | [S7,MB2,BI] 332-33-366ms   | [S7,MB3,F]  366-16-383ms   | [S7,MB3,BI] 395-33-428ms   | [S7,MB0,BW] 428-0-428ms    | [S3,MB4,F]  439-9-448ms    | [S3,MB0,BI] 449-12-462ms   | [S7,MB1,BW] 462-0-462ms    | [S3,MB5,F]  472-8-480ms    | [S3,MB1,BI] 480-12-493ms   | [S7,MB2,BW] 493-0-493ms    | [S3,MB6,F]  502-8-511ms    | [S3,MB2,BI] 511-10-522ms   | [S7,MB3,BW] 521-0-521ms    | [S3,MB7,F]  536-8-544ms    | [S3,MB3,BI] 544-10-555ms   | [S3,MB0,BW] 554-0-554ms    | [S7,MB4,F]  566-13-580ms   | [S7,MB4,BI] 592-32-624ms   | [S3,MB1,BW] 624-0-624ms    | [S7,MB5,F]  631-15-646ms   | [S7,MB5,BI] 658-32-690ms   | [S3,MB2,BW] 690-0-690ms    | [S7,MB6,F]  697-14-712ms   | [S7,MB6,BI] 724-32-756ms   | [S3,MB3,BW] 757-0-757ms    | [S7,MB7,F]  763-15-779ms   | [S7,MB7,BI] 791-32-823ms   | [S7,MB4,BW] 823-0-823ms    | [S3,MB4,BI] 823-11-835ms   | [S7,MB5,BW] 834-0-834ms    | [S3,MB5,BI] 834-11-846ms   | [S7,MB6,BW] 847-0-847ms    | [S3,MB6,BI] 847-11-858ms   | [S7,MB7,BW] 858-0-858ms    | [S3,MB7,BI] 864-12-876ms   | [S3,MB4,BW] 876-0-876ms    | [S3,MB5,BW] 876-0-876ms    | [S3,MB6,BW] 876-0-876ms    | [S3,MB7,BW] 876-0-876ms   
[rank2]:2025-12-31 12:06:21,131 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank2_stage6.svg
[rank2]:	> Counts Sum: 896, Total Sum: 1350 (66.37%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0]
[rank2]:2025-12-31 12:06:21,131 - Destroying the purge thread.
[rank1]:2025-12-31 12:06:21,161 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank1_stage5.svg
[rank1]:	> Counts Sum: 899, Total Sum: 1350 (66.59%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 1.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 2.66, 0.0]
[rank1]:2025-12-31 12:06:21,161 - Destroying the purge thread.
[rank0]:2025-12-31 12:06:21,133 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank0_stage4.svg
[rank0]:	> Counts Sum: 896, Total Sum: 1350 (66.37%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0]
[rank0]:2025-12-31 12:06:21,133 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-31 12:06:21,456 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/pipeline_schedule/251231_1206_thry_final800_rank3.svg
[rank3]:			> Batch Time: 494.37 ms, GPU Bubble Ratio: 5.88%, 5.88%, 5.88%, 5.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-38ms      | [S4,MB0,F]  38-9-48ms      | [S4,MB1,F]  48-9-58ms      | [S4,MB2,F]  58-9-67ms      | [S4,MB3,F]  67-9-77ms      | [S4,MB0,BI] 106-9-116ms    | [S4,MB0,BW] 116-9-126ms    | [S0,MB4,F]  126-9-135ms    | [S4,MB1,BI] 135-9-145ms    | [S4,MB1,BW] 145-9-155ms    | [S0,MB5,F]  155-9-164ms    | [S4,MB2,BI] 164-9-174ms    | [S4,MB2,BW] 174-9-184ms    | [S0,MB6,F]  184-9-193ms    | [S4,MB3,BI] 193-9-203ms    | [S4,MB3,BW] 203-9-213ms    | [S0,MB7,F]  213-9-222ms    | [S0,MB0,B]  222-19-242ms   | [S4,MB4,F]  242-9-252ms    | [S0,MB1,B]  252-19-271ms   | [S4,MB5,F]  271-9-281ms    | [S0,MB2,B]  281-19-300ms   | [S4,MB6,F]  300-9-310ms    | [S0,MB3,B]  310-19-329ms   | [S4,MB7,F]  329-9-339ms    | [S4,MB4,BI] 339-9-348ms    | [S4,MB4,BW] 348-9-358ms    | [S4,MB5,BI] 358-9-368ms    | [S4,MB5,BW] 368-9-378ms    | [S4,MB6,BI] 378-9-387ms    | [S4,MB6,BW] 387-9-397ms    | [S4,MB7,BI] 397-9-407ms    | [S4,MB7,BW] 407-9-416ms    | [S0,MB4,B]  416-19-436ms   | [S0,MB5,B]  436-19-455ms   | [S0,MB6,B]  455-19-474ms   | [S0,MB7,B]  474-19-494ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-38ms      | [S1,MB3,F]  38-9-48ms      | [S5,MB0,F]  48-9-58ms      | [S5,MB1,F]  58-9-67ms      | [S5,MB2,F]  67-9-77ms      | [S5,MB0,BI] 96-9-106ms     | [S5,MB3,F]  106-9-116ms    | [S5,MB1,BI] 116-9-126ms    | [S5,MB0,BW] 126-9-135ms    | [S1,MB4,F]  135-9-145ms    | [S5,MB2,BI] 145-9-155ms    | [S5,MB1,BW] 155-9-164ms    | [S1,MB5,F]  164-9-174ms    | [S5,MB3,BI] 174-9-184ms    | [S5,MB2,BW] 184-9-193ms    | [S1,MB6,F]  193-9-203ms    | [S1,MB0,BI] 203-9-213ms    | [S5,MB3,BW] 213-9-222ms    | [S1,MB7,F]  222-9-232ms    | [S1,MB1,BI] 232-9-242ms    | [S1,MB0,BW] 242-9-252ms    | [S5,MB4,F]  252-9-261ms    | [S1,MB2,BI] 261-9-271ms    | [S1,MB1,BW] 271-9-281ms    | [S5,MB5,F]  281-9-290ms    | [S1,MB3,BI] 290-9-300ms    | [S1,MB2,BW] 300-9-310ms    | [S5,MB6,F]  310-9-319ms    | [S5,MB4,BI] 319-9-329ms    | [S1,MB3,BW] 329-9-339ms    | [S5,MB7,F]  339-9-348ms    | [S5,MB5,BI] 348-9-358ms    | [S5,MB4,BW] 358-9-368ms    | [S5,MB6,BI] 368-9-378ms    | [S5,MB5,BW] 378-9-387ms    | [S5,MB7,BI] 387-9-397ms    | [S5,MB6,BW] 397-9-407ms    | [S1,MB4,BI] 407-9-416ms    | [S5,MB7,BW] 416-9-426ms    | [S1,MB5,BI] 426-9-436ms    | [S1,MB4,BW] 436-9-445ms    | [S1,MB6,BI] 445-9-455ms    | [S1,MB5,BW] 455-9-465ms    | [S1,MB7,BI] 465-9-474ms    | [S1,MB6,BW] 474-9-484ms    | [S1,MB7,BW] 484-9-494ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-38ms      | [S2,MB2,F]  38-9-48ms      | [S2,MB3,F]  48-9-58ms      | [S6,MB0,F]  58-9-67ms      | [S6,MB1,F]  67-9-77ms      | [S6,MB0,BI] 87-9-96ms      | [S6,MB2,F]  96-9-106ms     | [S6,MB1,BI] 106-9-116ms    | [S6,MB3,F]  116-9-126ms    | [S6,MB2,BI] 126-9-135ms    | [S6,MB0,BW] 135-9-145ms    | [S2,MB4,F]  145-9-155ms    | [S6,MB3,BI] 155-9-164ms    | [S6,MB1,BW] 164-9-174ms    | [S2,MB5,F]  174-9-184ms    | [S2,MB0,BI] 184-9-193ms    | [S6,MB2,BW] 193-9-203ms    | [S2,MB6,F]  203-9-213ms    | [S2,MB1,BI] 213-9-222ms    | [S6,MB3,BW] 222-9-232ms    | [S2,MB7,F]  232-9-242ms    | [S2,MB2,BI] 242-9-252ms    | [S2,MB0,BW] 252-9-261ms    | [S6,MB4,F]  261-9-271ms    | [S2,MB3,BI] 271-9-281ms    | [S2,MB1,BW] 281-9-290ms    | [S6,MB5,F]  290-9-300ms    | [S6,MB4,BI] 300-9-310ms    | [S2,MB2,BW] 310-9-319ms    | [S6,MB6,F]  319-9-329ms    | [S6,MB5,BI] 329-9-339ms    | [S2,MB3,BW] 339-9-348ms    | [S6,MB7,F]  348-9-358ms    | [S6,MB6,BI] 358-9-368ms    | [S6,MB4,BW] 368-9-378ms    | [S6,MB7,BI] 378-9-387ms    | [S6,MB5,BW] 387-9-397ms    | [S2,MB4,BI] 397-9-407ms    | [S6,MB6,BW] 407-9-416ms    | [S2,MB5,BI] 416-9-426ms    | [S6,MB7,BW] 426-9-436ms    | [S2,MB6,BI] 436-9-445ms    | [S2,MB4,BW] 445-9-455ms    | [S2,MB7,BI] 455-9-465ms    | [S2,MB5,BW] 465-9-474ms    | [S2,MB6,BW] 474-9-484ms    | [S2,MB7,BW] 484-9-494ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-38ms      | [S3,MB1,F]  38-9-48ms      | [S3,MB2,F]  48-9-58ms      | [S3,MB3,F]  58-9-67ms      | [S7,MB0,F]  67-9-77ms      | [S7,MB0,BI] 77-9-87ms      | [S7,MB1,F]  87-9-96ms      | [S7,MB1,BI] 96-9-106ms     | [S7,MB2,F]  106-9-116ms    | [S7,MB2,BI] 116-9-126ms    | [S7,MB3,F]  126-9-135ms    | [S7,MB3,BI] 135-9-145ms    | [S7,MB0,BW] 145-9-155ms    | [S3,MB4,F]  155-9-164ms    | [S3,MB0,BI] 164-9-174ms    | [S7,MB1,BW] 174-9-184ms    | [S3,MB5,F]  184-9-193ms    | [S3,MB1,BI] 193-9-203ms    | [S7,MB2,BW] 203-9-213ms    | [S3,MB6,F]  213-9-222ms    | [S3,MB2,BI] 222-9-232ms    | [S7,MB3,BW] 232-9-242ms    | [S3,MB7,F]  242-9-252ms    | [S3,MB3,BI] 252-9-261ms    | [S3,MB0,BW] 261-9-271ms    | [S7,MB4,F]  271-9-281ms    | [S7,MB4,BI] 281-9-290ms    | [S3,MB1,BW] 290-9-300ms    | [S7,MB5,F]  300-9-310ms    | [S7,MB5,BI] 310-9-319ms    | [S3,MB2,BW] 319-9-329ms    | [S7,MB6,F]  329-9-339ms    | [S7,MB6,BI] 339-9-348ms    | [S3,MB3,BW] 348-9-358ms    | [S7,MB7,F]  358-9-368ms    | [S7,MB7,BI] 368-9-378ms    | [S7,MB4,BW] 378-9-387ms    | [S3,MB4,BI] 387-9-397ms    | [S7,MB5,BW] 397-9-407ms    | [S3,MB5,BI] 407-9-416ms    | [S7,MB6,BW] 416-9-426ms    | [S3,MB6,BI] 426-9-436ms    | [S7,MB7,BW] 436-9-445ms    | [S3,MB7,BI] 445-9-455ms    | [S3,MB4,BW] 455-9-465ms    | [S3,MB5,BW] 465-9-474ms    | [S3,MB6,BW] 474-9-484ms    | [S3,MB7,BW] 484-9-494ms   
[rank3]:2025-12-31 12:06:21,502 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1206_stage3_final800.svg
[rank3]:2025-12-31 12:06:21,550 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_ratio_history/rank3/251231_1206_stage7_final800.svg
[rank3]:2025-12-31 12:06:21,649 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank3_stage3.svg
[rank3]:	> Counts Sum: 901, Total Sum: 1350 (66.74%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 2.66, 2.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 0.0]
[rank2]:2025-12-31 12:06:21,650 - Process group destroyed
[rank1]:2025-12-31 12:06:21,643 - Process group destroyed
[rank3]:2025-12-31 12:06:21,739 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1/frozen_params_histogram/251231_1206_rank3_stage7.svg
[rank3]:	> Counts Sum: 448, Total Sum: 825 (54.30%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:06:21,740 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 383-401
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–‚â–â–‚â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–„â–‚â–…â–„â–ƒâ–â–ƒâ–ƒâ–‚â–â–‚â–‚â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–‡â–„â–‚â–…â–„â–ƒâ–â–ƒâ–ƒâ–‚â–â–‚â–‚â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.82793
[rank3]:wandb:               final/avg_loss 2.85583
[rank3]:wandb:             final/avg_mfu(%) 19.66223
[rank3]:wandb:             final/avg_tflops 66.91997
[rank3]:wandb:    final/avg_throughput(tps) 8560.23383
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 2.85583
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.85583
[rank3]:wandb: loss_metrics/global_max_loss 2.85583
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_InterleavedZeroBubble_apf_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ibz616tc
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_apf_22_dm1/20251231-1112/wandb/run-20251231_111203-ibz616tc/logs
[rank3]:2025-12-31 12:06:23,149 - Process group destroyed
[rank0]:2025-12-31 12:06:23,134 - Training completed
[rank0]:2025-12-31 12:06:23,134 - Destroying the purge thread.
[rank0]:2025-12-31 12:06:23,219 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.2', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: InterleavedZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_InterleavedZeroBubble_apf_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
