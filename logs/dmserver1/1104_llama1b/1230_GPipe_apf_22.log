
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 17:49:03 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_GPipe_apf_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-30 17:49:09,528 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:2025-12-30 17:49:09,528 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-30 17:49:09,752 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank3]:2025-12-30 17:49:09,762 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank0]:2025-12-30 17:49:09,784 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 17:49:09,786 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 17:49:09,790 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 17:49:09,791 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-30 17:49:09,797 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 17:49:09,799 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-30 17:49:10,143 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 17:49:10,146 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 17:49:10,192 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-30 17:49:10,165 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 17:49:10,167 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 17:49:13,458 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-30 17:49:13,462 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 17:49:13,543 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 17:49:13,501 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 17:49:13,526 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 17:49:13,526 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-30 17:49:13,584 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 17:49:13,613 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 17:49:13,613 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-30 17:49:13,609 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 17:49:13,647 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 17:49:13,648 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-30 17:49:13,674 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 17:49:13,675 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-30 17:49:13,708 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 17:49:13,708 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 17:49:13,708 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-30 17:49:13,821 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 17:49:13,822 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 17:49:13,823 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-30 17:49:13,862 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 17:49:13,862 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 17:49:13,862 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 92q01b48
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_GPipe_apf_22_dm1/20251230-1749/wandb/run-20251230_174914-92q01b48
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_GPipe_apf_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/92q01b48
[rank3]:2025-12-30 17:49:15,840 - WandB logging enabled
[rank3]:2025-12-30 17:49:15,841 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 17:49:15,880 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 17:49:15,909 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 17:49:15,909 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-30 17:49:16,129 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 17:49:16,129 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_GPipe_apf_22_dm1
[rank0]:2025-12-30 17:49:16,129 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-30 17:49:16,129 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 17:49:16,130 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 17:49:16,130 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-30 17:49:16,112 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 17:49:16,113 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 17:49:16,113 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-30 17:49:16,129 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 17:49:18,701 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-30 17:49:18,701 - Finished loading the checkpoint in 2.57 seconds.
[rank0]:2025-12-30 17:49:18,701 - Training starts at step 1
[rank1]:2025-12-30 17:49:24,224 -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory: 12.75GiB(26.83%)  tps: 3,080  tflops: 24.08  mfu: 7.72%
[rank1]:2025-12-30 17:49:24,224 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-30 17:49:24,219 -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory: 10.24GiB(21.56%)  tps: 3,057  tflops: 23.90  mfu: 7.66%
[rank2]:2025-12-30 17:49:24,219 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 17:49:24,257 -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory: 13.25GiB(27.89%)  tps: 3,089  tflops: 24.15  mfu: 7.74%
[rank0]:2025-12-30 17:49:24,257 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 17:49:24,229 -  step:  1  loss: 10.6088  grad_norm: 116.5367  memory: 24.19GiB(50.91%)  tps: 3,926  tflops: 30.69  mfu: 9.84%
[rank3]:2025-12-30 17:49:24,230 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-30 17:51:23,397 - Avg. fwd time: 6.9876 / Avg. bwd time: 19.3167 / Avg. batch time: 525.8615 (ms) / GPU bubble ratio: 59.98%
[rank1]:2025-12-30 17:51:23,427 - Avg. fwd time: 9.0776 / Avg. bwd time: 24.8723 / Avg. batch time: 566.1386 (ms) / GPU bubble ratio: 52.03%
[rank3]:2025-12-30 17:51:23,372 - Avg. fwd time: 10.8039 / Avg. bwd time: 43.4396 / Avg. batch time: 493.7198 (ms) / GPU bubble ratio: 12.11%
[rank0]:2025-12-30 17:51:23,457 - Avg. fwd time: 8.2322 / Avg. bwd time: 25.1614 / Avg. batch time: 605.1318 (ms) / GPU bubble ratio: 55.85%
[rank0]:2025-12-30 17:53:23,220 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 17:53:28,078 - Avg. fwd time: 10.8140 / Avg. bwd time: 43.6494 / Avg. batch time: 495.3659 (ms) / GPU bubble ratio: 12.04%
[rank1]:2025-12-30 17:53:28,133 - Avg. fwd time: 9.0864 / Avg. bwd time: 24.9403 / Avg. batch time: 567.1099 (ms) / GPU bubble ratio: 52.00%
[rank1]:2025-12-30 17:53:28,188 -  step: 50  loss: -8.0000  grad_norm: 12.8532  memory: 15.15GiB(31.89%)  tps: 6,581  tflops: 51.45  mfu: 16.49%
[rank2]:2025-12-30 17:53:28,103 - Avg. fwd time: 6.9891 / Avg. bwd time: 19.3626 / Avg. batch time: 527.1334 (ms) / GPU bubble ratio: 60.01%
[rank2]:2025-12-30 17:53:28,184 -  step: 50  loss: -8.0000  grad_norm: 12.8532  memory: 12.26GiB(25.80%)  tps: 6,581  tflops: 51.45  mfu: 16.49%
[rank3]:2025-12-30 17:53:28,196 -  step: 50  loss:  9.9167  grad_norm: 12.8532  memory: 26.98GiB(56.79%)  tps: 6,581  tflops: 51.45  mfu: 16.49%
[rank0]:2025-12-30 17:53:28,163 - Avg. fwd time: 8.2583 / Avg. bwd time: 25.2131 / Avg. batch time: 605.7694 (ms) / GPU bubble ratio: 55.80%
[rank0]:2025-12-30 17:53:28,199 -  step: 50  loss: -8.0000  grad_norm: 12.8532  memory: 17.08GiB(35.95%)  tps: 6,582  tflops: 51.46  mfu: 16.49%
[rank3]:2025-12-30 17:54:12,833 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:54:13,041 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:54:13,069 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-30 17:54:13,096 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:55:03,049 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:55:03,057 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-30 17:55:03,070 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 17:55:03,077 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:55:27,403 - Avg. fwd time: 7.1121 / Avg. bwd time: 18.5155 / Avg. batch time: 521.3669 (ms) / GPU bubble ratio: 60.68%
[rank3]:2025-12-30 17:55:27,389 - Avg. fwd time: 10.9064 / Avg. bwd time: 42.9648 / Avg. batch time: 490.5866 (ms) / GPU bubble ratio: 12.15%
[rank1]:2025-12-30 17:55:27,419 - Avg. fwd time: 9.2434 / Avg. bwd time: 23.8445 / Avg. batch time: 560.0912 (ms) / GPU bubble ratio: 52.74%
[rank0]:2025-12-30 17:55:27,433 - Avg. fwd time: 8.3857 / Avg. bwd time: 23.9089 / Avg. batch time: 597.3101 (ms) / GPU bubble ratio: 56.75%
[rank2]:2025-12-30 17:55:43,647 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:55:43,647 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank0]:2025-12-30 17:55:43,648 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-30 17:55:43,678 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:56:33,874 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 17:56:33,897 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 17:56:33,904 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:56:33,882 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank0]:2025-12-30 17:57:14,190 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 17:57:14,192 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:57:14,187 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:57:14,187 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 17:57:14,218 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:57:18,172 - Avg. fwd time: 7.3126 / Avg. bwd time: 17.0836 / Avg. batch time: 511.4295 (ms) / GPU bubble ratio: 61.84%
[rank3]:2025-12-30 17:57:18,158 - Avg. fwd time: 11.0450 / Avg. bwd time: 41.7766 / Avg. batch time: 482.1633 (ms) / GPU bubble ratio: 12.36%
[rank1]:2025-12-30 17:57:18,188 - Avg. fwd time: 9.4924 / Avg. bwd time: 22.0055 / Avg. batch time: 548.1933 (ms) / GPU bubble ratio: 54.03%
[rank1]:2025-12-30 17:57:18,203 -  step: 100  loss: -8.0000  grad_norm:  7.2105  memory: 16.21GiB(34.11%)  tps: 7,123  tflops: 55.68  mfu: 17.85%
[rank2]:2025-12-30 17:57:18,203 -  step: 100  loss: -8.0000  grad_norm:  7.2105  memory: 13.10GiB(27.57%)  tps: 7,123  tflops: 55.68  mfu: 17.85%
[rank0]:2025-12-30 17:57:18,202 - Avg. fwd time: 8.5739 / Avg. bwd time: 21.7581 / Avg. batch time: 583.1613 (ms) / GPU bubble ratio: 58.39%
[rank0]:2025-12-30 17:57:18,204 -  step: 100  loss: -8.0000  grad_norm:  7.2105  memory: 19.07GiB(40.15%)  tps: 7,123  tflops: 55.69  mfu: 17.85%
[rank0]:2025-12-30 17:57:18,293 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1757_stage0_step100.svg
[rank3]:2025-12-30 17:57:18,219 -  step: 100  loss:  8.8264  grad_norm:  7.2105  memory: 29.97GiB(63.08%)  tps: 7,123  tflops: 55.68  mfu: 17.85%
[rank1]:2025-12-30 17:57:18,294 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1757_stage1_step100.svg
[rank2]:2025-12-30 17:57:18,293 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1757_stage2_step100.svg
[rank3]:2025-12-30 17:57:18,378 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1757_step100_rank3.svg
[rank3]:			> Batch Time: 495.14 ms, GPU Bubble Ratio: 70.30%, 64.77%, 72.74%, 25.46%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-38ms      | [S0,MB4,F]  38-9-47ms      | [S0,MB5,F]  48-10-58ms     | [S0,MB6,F]  58-9-67ms      | [S0,MB7,F]  67-10-77ms     | [S0,MB0,B]  246-8-254ms    | [S0,MB1,B]  280-8-288ms    | [S0,MB2,B]  314-8-323ms    | [S0,MB3,B]  348-8-356ms    | [S0,MB4,B]  383-8-391ms    | [S0,MB5,B]  419-8-427ms    | [S0,MB6,B]  454-8-463ms    | [S0,MB7,B]  486-8-495ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  75-11-86ms     | [S1,MB5,F]  94-11-105ms    | [S1,MB6,F]  113-11-124ms   | [S1,MB7,F]  133-11-144ms   | [S1,MB0,B]  232-10-243ms   | [S1,MB1,B]  266-10-276ms   | [S1,MB2,B]  300-10-311ms   | [S1,MB3,B]  334-10-345ms   | [S1,MB4,B]  369-10-380ms   | [S1,MB5,B]  405-10-415ms   | [S1,MB6,B]  440-10-451ms   | [S1,MB7,B]  472-10-483ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  91-8-100ms     | [S2,MB5,F]  110-8-119ms    | [S2,MB6,F]  130-8-138ms    | [S2,MB7,F]  149-8-158ms    | [S2,MB0,B]  221-8-229ms    | [S2,MB1,B]  254-8-262ms    | [S2,MB2,B]  289-8-297ms    | [S2,MB3,B]  322-8-331ms    | [S2,MB4,B]  357-8-366ms    | [S2,MB5,B]  393-8-401ms    | [S2,MB6,B]  428-8-437ms    | [S2,MB7,B]  460-8-468ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  88-11-100ms    | [S3,MB4,F]  107-11-119ms   | [S3,MB5,F]  127-11-138ms   | [S3,MB6,F]  146-11-158ms   | [S3,MB7,F]  165-11-177ms   | [S3,MB0,B]  183-31-214ms   | [S3,MB1,B]  214-32-247ms   | [S3,MB2,B]  247-34-282ms   | [S3,MB3,B]  281-33-315ms   | [S3,MB4,B]  315-34-350ms   | [S3,MB5,B]  351-35-387ms   | [S3,MB6,B]  386-35-422ms   | [S3,MB7,B]  422-34-456ms  
[rank2]:2025-12-30 17:57:18,446 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1757_rank2_stage2.svg
[rank2]:	> Counts Sum: 85, Total Sum: 180 (47.22%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank0]:2025-12-30 17:57:18,450 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1757_rank0_stage0.svg
[rank0]:	> Counts Sum: 88, Total Sum: 185 (47.57%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank3]:2025-12-30 17:57:18,423 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1757_stage3_step100.svg
[rank1]:2025-12-30 17:57:18,442 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1757_rank1_stage1.svg
[rank1]:	> Counts Sum: 108, Total Sum: 225 (48.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 20.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 20.0]
[rank3]:2025-12-30 17:57:18,556 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1757_rank3_stage3.svg
[rank3]:	> Counts Sum: 63, Total Sum: 145 (43.45%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 17:57:54,943 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:57:54,942 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:57:54,941 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-30 17:57:54,972 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:58:45,041 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-30 17:58:45,072 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 17:58:45,064 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:58:45,048 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 17:59:09,119 - Avg. fwd time: 7.4312 / Avg. bwd time: 16.2217 / Avg. batch time: 505.3883 (ms) / GPU bubble ratio: 62.56%
[rank3]:2025-12-30 17:59:09,104 - Avg. fwd time: 11.1252 / Avg. bwd time: 41.0489 / Avg. batch time: 476.9594 (ms) / GPU bubble ratio: 12.49%
[rank1]:2025-12-30 17:59:09,135 - Avg. fwd time: 9.6406 / Avg. bwd time: 20.8965 / Avg. batch time: 540.9718 (ms) / GPU bubble ratio: 54.84%
[rank0]:2025-12-30 17:59:09,149 - Avg. fwd time: 8.6852 / Avg. bwd time: 20.4426 / Avg. batch time: 574.5652 (ms) / GPU bubble ratio: 59.44%
[rank2]:2025-12-30 17:59:25,358 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-30 17:59:25,359 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 17:59:25,359 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 17:59:25,389 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:00:05,674 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:00:05,675 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:00:05,705 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:00:05,674 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:00:45,990 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:00:46,000 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:00:46,003 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:00:46,022 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:00:45,993 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:00:50,961 - Avg. fwd time: 7.6034 / Avg. bwd time: 14.9819 / Avg. batch time: 496.3746 (ms) / GPU bubble ratio: 63.60%
[rank3]:2025-12-30 18:00:50,935 - Avg. fwd time: 11.2408 / Avg. bwd time: 39.9710 / Avg. batch time: 469.2392 (ms) / GPU bubble ratio: 12.69%
[rank1]:2025-12-30 18:00:50,991 - Avg. fwd time: 9.8525 / Avg. bwd time: 19.2871 / Avg. batch time: 530.2857 (ms) / GPU bubble ratio: 56.04%
[rank2]:2025-12-30 18:00:51,044 -  step: 150  loss: -8.0000  grad_norm:  9.9676  memory: 13.15GiB(27.69%)  tps: 7,698  tflops: 60.18  mfu: 19.29%
[rank0]:2025-12-30 18:00:51,022 - Avg. fwd time: 8.8420 / Avg. bwd time: 18.5792 / Avg. batch time: 561.9594 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-12-30 18:00:51,058 -  step: 150  loss: -8.0000  grad_norm:  9.9676  memory: 19.07GiB(40.15%)  tps: 7,697  tflops: 60.17  mfu: 19.29%
[rank3]:2025-12-30 18:00:51,056 -  step: 150  loss:  5.4044  grad_norm:  9.9676  memory: 29.97GiB(63.08%)  tps: 7,698  tflops: 60.18  mfu: 19.29%
[rank1]:2025-12-30 18:00:51,048 -  step: 150  loss: -8.0000  grad_norm:  9.9676  memory: 16.21GiB(34.11%)  tps: 7,698  tflops: 60.18  mfu: 19.29%
[rank1]:2025-12-30 18:01:36,153 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:01:36,177 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:01:36,146 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:01:36,170 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:02:16,695 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:02:16,694 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:02:16,695 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:02:16,726 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:02:40,886 - Avg. fwd time: 7.6544 / Avg. bwd time: 14.5979 / Avg. batch time: 493.7457 (ms) / GPU bubble ratio: 63.95%
[rank0]:2025-12-30 18:02:40,917 - Avg. fwd time: 8.8866 / Avg. bwd time: 18.0202 / Avg. batch time: 558.2277 (ms) / GPU bubble ratio: 61.44%
[rank3]:2025-12-30 18:02:40,871 - Avg. fwd time: 11.2750 / Avg. bwd time: 39.6610 / Avg. batch time: 467.0254 (ms) / GPU bubble ratio: 12.75%
[rank1]:2025-12-30 18:02:40,903 - Avg. fwd time: 9.9173 / Avg. bwd time: 18.7916 / Avg. batch time: 527.1328 (ms) / GPU bubble ratio: 56.43%
[rank2]:2025-12-30 18:02:57,183 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:02:57,184 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:02:57,215 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:02:57,183 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:03:37,562 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:03:37,563 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:03:37,594 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:03:37,563 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:04:18,111 - Freezing Ratio: [Stage2] 0.08, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:04:18,144 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:04:18,114 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:04:18,116 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:04:18,111 - Freezing Ratio: [Stage1] 0.04, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:04:23,138 - Avg. fwd time: 7.7553 / Avg. bwd time: 13.8630 / Avg. batch time: 488.6546 (ms) / GPU bubble ratio: 64.61%
[rank3]:2025-12-30 18:04:23,111 - Avg. fwd time: 11.3460 / Avg. bwd time: 39.0501 / Avg. batch time: 462.6975 (ms) / GPU bubble ratio: 12.87%
[rank1]:2025-12-30 18:04:23,170 - Avg. fwd time: 10.0441 / Avg. bwd time: 17.8485 / Avg. batch time: 521.0670 (ms) / GPU bubble ratio: 57.18%
[rank2]:2025-12-30 18:04:23,223 -  step: 200  loss: -8.0000  grad_norm:  7.8175  memory: 13.15GiB(27.69%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank3]:2025-12-30 18:04:23,235 -  step: 200  loss:  1.6390  grad_norm:  7.8175  memory: 29.97GiB(63.08%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank0]:2025-12-30 18:04:23,201 - Avg. fwd time: 8.9791 / Avg. bwd time: 16.9400 / Avg. batch time: 551.0577 (ms) / GPU bubble ratio: 62.37%
[rank0]:2025-12-30 18:04:23,237 -  step: 200  loss: -8.0000  grad_norm:  7.8175  memory: 19.07GiB(40.15%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank1]:2025-12-30 18:04:23,226 -  step: 200  loss: -8.0000  grad_norm:  7.8175  memory: 16.34GiB(34.40%)  tps: 7,722  tflops: 60.37  mfu: 19.35%
[rank2]:2025-12-30 18:04:23,284 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1804_stage2_step200.svg
[rank0]:2025-12-30 18:04:23,291 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1804_stage0_step200.svg
[rank1]:2025-12-30 18:04:23,285 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1804_stage1_step200.svg
[rank2]:2025-12-30 18:04:23,430 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1804_rank2_stage2.svg
[rank2]:	> Counts Sum: 294, Total Sum: 540 (54.44%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 26.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 26.66, 26.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank3]:2025-12-30 18:04:23,373 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1804_step200_rank3.svg
[rank3]:			> Batch Time: 496.24 ms, GPU Bubble Ratio: 70.39%, 65.14%, 72.97%, 25.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-38ms      | [S0,MB4,F]  38-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S0,MB7,F]  67-10-77ms     | [S0,MB0,B]  246-8-255ms    | [S0,MB1,B]  280-8-288ms    | [S0,MB2,B]  315-8-323ms    | [S0,MB3,B]  349-8-357ms    | [S0,MB4,B]  384-8-392ms    | [S0,MB5,B]  420-8-428ms    | [S0,MB6,B]  455-8-463ms    | [S0,MB7,B]  487-8-496ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  75-10-86ms     | [S1,MB5,F]  94-10-105ms    | [S1,MB6,F]  113-10-124ms   | [S1,MB7,F]  132-10-143ms   | [S1,MB0,B]  233-10-243ms   | [S1,MB1,B]  266-10-276ms   | [S1,MB2,B]  301-10-311ms   | [S1,MB3,B]  335-10-346ms   | [S1,MB4,B]  370-10-381ms   | [S1,MB5,B]  406-10-417ms   | [S1,MB6,B]  441-10-451ms   | [S1,MB7,B]  473-10-484ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  91-8-99ms      | [S2,MB5,F]  110-8-118ms    | [S2,MB6,F]  129-8-138ms    | [S2,MB7,F]  148-8-157ms    | [S2,MB0,B]  221-8-229ms    | [S2,MB1,B]  254-8-263ms    | [S2,MB2,B]  289-8-298ms    | [S2,MB3,B]  323-8-332ms    | [S2,MB4,B]  358-8-367ms    | [S2,MB5,B]  394-8-403ms    | [S2,MB6,B]  429-8-438ms    | [S2,MB7,B]  461-8-470ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  88-11-99ms     | [S3,MB4,F]  107-11-118ms   | [S3,MB5,F]  126-11-138ms   | [S3,MB6,F]  145-11-157ms   | [S3,MB7,F]  165-11-176ms   | [S3,MB0,B]  182-31-214ms   | [S3,MB1,B]  214-33-248ms   | [S3,MB2,B]  248-35-283ms   | [S3,MB3,B]  282-34-317ms   | [S3,MB4,B]  317-35-352ms   | [S3,MB5,B]  352-36-388ms   | [S3,MB6,B]  387-35-423ms   | [S3,MB7,B]  423-34-457ms  
[rank3]:2025-12-30 18:04:23,420 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1804_stage3_step200.svg
[rank0]:2025-12-30 18:04:23,441 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1804_rank0_stage0.svg
[rank0]:	> Counts Sum: 292, Total Sum: 555 (52.61%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank1]:2025-12-30 18:04:23,429 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1804_rank1_stage1.svg
[rank1]:	> Counts Sum: 365, Total Sum: 675 (54.07%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 13.33, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 33.33, 33.33, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 6.66]
[rank3]:2025-12-30 18:04:23,549 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1804_rank3_stage3.svg
[rank3]:	> Counts Sum: 211, Total Sum: 435 (48.51%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 6.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-30 18:05:08,823 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:05:08,845 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:05:08,853 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:05:08,829 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:05:49,272 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:05:49,273 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:05:49,272 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:05:49,303 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:06:13,595 - Avg. fwd time: 11.3646 / Avg. bwd time: 38.9308 / Avg. batch time: 461.8896 (ms) / GPU bubble ratio: 12.89%
[rank2]:2025-12-30 18:06:13,610 - Avg. fwd time: 7.7786 / Avg. bwd time: 13.6905 / Avg. batch time: 487.6956 (ms) / GPU bubble ratio: 64.78%
[rank0]:2025-12-30 18:06:13,643 - Avg. fwd time: 9.0010 / Avg. bwd time: 16.6850 / Avg. batch time: 549.5961 (ms) / GPU bubble ratio: 62.61%
[rank1]:2025-12-30 18:06:13,628 - Avg. fwd time: 10.0741 / Avg. bwd time: 17.6303 / Avg. batch time: 519.8765 (ms) / GPU bubble ratio: 57.37%
[rank2]:2025-12-30 18:06:29,688 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:06:29,719 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:06:29,688 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:06:29,690 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:07:10,125 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:07:10,156 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:07:10,125 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:07:10,126 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:07:50,475 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:07:50,511 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:07:50,478 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:07:50,486 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:07:50,489 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:07:54,470 - Avg. fwd time: 7.8525 / Avg. bwd time: 13.1513 / Avg. batch time: 483.6685 (ms) / GPU bubble ratio: 65.26%
[rank2]:2025-12-30 18:07:54,504 -  step: 250  loss: -8.0000  grad_norm:  5.6356  memory: 13.15GiB(27.69%)  tps: 7,755  tflops: 60.62  mfu: 19.43%
[rank3]:2025-12-30 18:07:54,455 - Avg. fwd time: 11.4131 / Avg. bwd time: 38.4508 / Avg. batch time: 458.4314 (ms) / GPU bubble ratio: 12.98%
[rank3]:2025-12-30 18:07:54,521 -  step: 250  loss:  5.2578  grad_norm:  5.6356  memory: 29.97GiB(63.08%)  tps: 7,755  tflops: 60.62  mfu: 19.43%
[rank1]:2025-12-30 18:07:54,487 - Avg. fwd time: 10.1652 / Avg. bwd time: 16.9390 / Avg. batch time: 515.1310 (ms) / GPU bubble ratio: 57.91%
[rank1]:2025-12-30 18:07:54,504 -  step: 250  loss: -8.0000  grad_norm:  5.6356  memory: 16.34GiB(34.40%)  tps: 7,755  tflops: 60.62  mfu: 19.43%
[rank0]:2025-12-30 18:07:54,503 - Avg. fwd time: 9.0703 / Avg. bwd time: 15.8819 / Avg. batch time: 544.0274 (ms) / GPU bubble ratio: 63.31%
[rank0]:2025-12-30 18:07:54,505 -  step: 250  loss: -8.0000  grad_norm:  5.6356  memory: 19.07GiB(40.15%)  tps: 7,755  tflops: 60.63  mfu: 19.43%
[rank3]:2025-12-30 18:08:30,781 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:08:30,750 - Freezing Ratio: [Stage2] 0.11, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:08:30,750 - Freezing Ratio: [Stage1] 0.07, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:08:30,751 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:09:20,566 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:09:20,583 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:09:20,559 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:09:20,590 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:09:44,783 - Avg. fwd time: 11.4123 / Avg. bwd time: 38.4065 / Avg. batch time: 458.0680 (ms) / GPU bubble ratio: 12.99%
[rank2]:2025-12-30 18:09:44,799 - Avg. fwd time: 7.8556 / Avg. bwd time: 13.1105 / Avg. batch time: 483.2439 (ms) / GPU bubble ratio: 65.29%
[rank1]:2025-12-30 18:09:44,817 - Avg. fwd time: 10.1691 / Avg. bwd time: 16.8922 / Avg. batch time: 514.6477 (ms) / GPU bubble ratio: 57.93%
[rank0]:2025-12-30 18:09:44,832 - Avg. fwd time: 9.0743 / Avg. bwd time: 15.8263 / Avg. batch time: 543.4779 (ms) / GPU bubble ratio: 63.35%
[rank3]:2025-12-30 18:10:00,974 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:10:00,942 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:10:00,943 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:10:00,943 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:10:41,431 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:10:41,399 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:10:41,400 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:10:41,401 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:11:21,616 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:11:21,616 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:11:21,619 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:11:21,621 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:11:21,647 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:11:25,595 - Avg. fwd time: 11.4499 / Avg. bwd time: 38.0514 / Avg. batch time: 455.5235 (ms) / GPU bubble ratio: 13.06%
[rank2]:2025-12-30 18:11:25,611 - Avg. fwd time: 7.9106 / Avg. bwd time: 12.7061 / Avg. batch time: 480.2778 (ms) / GPU bubble ratio: 65.66%
[rank1]:2025-12-30 18:11:25,629 - Avg. fwd time: 10.2374 / Avg. bwd time: 16.3742 / Avg. batch time: 511.1426 (ms) / GPU bubble ratio: 58.35%
[rank0]:2025-12-30 18:11:25,645 - Avg. fwd time: 9.1247 / Avg. bwd time: 15.2045 / Avg. batch time: 539.3312 (ms) / GPU bubble ratio: 63.91%
[rank3]:2025-12-30 18:11:25,662 -  step: 300  loss:  4.0908  grad_norm:  6.2746  memory: 29.97GiB(63.08%)  tps: 7,760  tflops: 60.66  mfu: 19.44%
[rank2]:2025-12-30 18:11:25,647 -  step: 300  loss: -8.0000  grad_norm:  6.2746  memory: 13.15GiB(27.69%)  tps: 7,760  tflops: 60.66  mfu: 19.44%
[rank2]:2025-12-30 18:11:25,709 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1811_stage2_step300.svg
[rank1]:2025-12-30 18:11:25,647 -  step: 300  loss: -8.0000  grad_norm:  6.2746  memory: 16.34GiB(34.40%)  tps: 7,760  tflops: 60.66  mfu: 19.44%
[rank1]:2025-12-30 18:11:25,709 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1811_stage1_step300.svg
[rank0]:2025-12-30 18:11:25,647 -  step: 300  loss: -8.0000  grad_norm:  6.2746  memory: 19.07GiB(40.15%)  tps: 7,760  tflops: 60.66  mfu: 19.44%
[rank0]:2025-12-30 18:11:25,709 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1811_stage0_step300.svg
[rank3]:2025-12-30 18:11:25,799 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1811_step300_rank3.svg
[rank3]:			> Batch Time: 492.30 ms, GPU Bubble Ratio: 71.20%, 64.76%, 72.71%, 25.42%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-37ms      | [S0,MB4,F]  37-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S0,MB7,F]  67-10-77ms     | [S0,MB0,B]  247-8-255ms    | [S0,MB1,B]  280-7-288ms    | [S0,MB2,B]  314-8-322ms    | [S0,MB3,B]  347-8-355ms    | [S0,MB4,B]  383-8-391ms    | [S0,MB5,B]  418-8-426ms    | [S0,MB6,B]  453-8-461ms    | [S0,MB7,B]  484-8-492ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  75-11-86ms     | [S1,MB5,F]  94-11-105ms    | [S1,MB6,F]  113-10-124ms   | [S1,MB7,F]  133-11-144ms   | [S1,MB0,B]  233-10-243ms   | [S1,MB1,B]  266-10-277ms   | [S1,MB2,B]  300-10-310ms   | [S1,MB3,B]  334-10-344ms   | [S1,MB4,B]  370-10-380ms   | [S1,MB5,B]  404-10-415ms   | [S1,MB6,B]  439-10-450ms   | [S1,MB7,B]  470-10-481ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  91-8-100ms     | [S2,MB5,F]  110-8-119ms    | [S2,MB6,F]  130-8-138ms    | [S2,MB7,F]  149-8-157ms    | [S2,MB0,B]  221-8-229ms    | [S2,MB1,B]  255-8-263ms    | [S2,MB2,B]  288-8-296ms    | [S2,MB3,B]  322-8-330ms    | [S2,MB4,B]  358-8-366ms    | [S2,MB5,B]  392-8-401ms    | [S2,MB6,B]  427-8-436ms    | [S2,MB7,B]  459-8-467ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  88-11-99ms     | [S3,MB4,F]  107-11-119ms   | [S3,MB5,F]  126-11-138ms   | [S3,MB6,F]  146-11-157ms   | [S3,MB7,F]  165-11-177ms   | [S3,MB0,B]  182-31-214ms   | [S3,MB1,B]  214-33-247ms   | [S3,MB2,B]  248-33-281ms   | [S3,MB3,B]  281-33-315ms   | [S3,MB4,B]  315-34-350ms   | [S3,MB5,B]  351-35-387ms   | [S3,MB6,B]  385-35-421ms   | [S3,MB7,B]  421-34-456ms  
[rank3]:2025-12-30 18:11:25,844 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1811_stage3_step300.svg
[rank2]:2025-12-30 18:11:25,856 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1811_rank2_stage2.svg
[rank2]:	> Counts Sum: 575, Total Sum: 900 (63.89%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 20.0, 40.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 48.0, 20.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 32.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 12.0, 0.0]
[rank1]:2025-12-30 18:11:25,852 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1811_rank1_stage1.svg
[rank1]:	> Counts Sum: 698, Total Sum: 1125 (62.04%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 36.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 32.0, 52.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 4.0]
[rank0]:2025-12-30 18:11:25,859 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1811_rank0_stage0.svg
[rank0]:	> Counts Sum: 557, Total Sum: 925 (60.22%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 8.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 12.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0]
[rank3]:2025-12-30 18:11:25,977 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1811_rank3_stage3.svg
[rank3]:	> Counts Sum: 400, Total Sum: 725 (55.17%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 4.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-30 18:12:02,270 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:12:02,270 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:12:02,271 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:12:02,302 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:12:42,567 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:12:42,566 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:12:42,602 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:12:42,567 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:13:06,751 - Avg. fwd time: 11.4828 / Avg. bwd time: 37.7575 / Avg. batch time: 453.4299 (ms) / GPU bubble ratio: 13.12%
[rank1]:2025-12-30 18:13:06,786 - Avg. fwd time: 10.2955 / Avg. bwd time: 15.9360 / Avg. batch time: 508.2682 (ms) / GPU bubble ratio: 58.71%
[rank2]:2025-12-30 18:13:06,768 - Avg. fwd time: 7.9572 / Avg. bwd time: 12.3636 / Avg. batch time: 477.8607 (ms) / GPU bubble ratio: 65.98%
[rank0]:2025-12-30 18:13:06,802 - Avg. fwd time: 9.1670 / Avg. bwd time: 14.6685 / Avg. batch time: 535.9018 (ms) / GPU bubble ratio: 64.42%
[rank2]:2025-12-30 18:13:23,082 - Freezing Ratio: [Stage2] 0.08, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:13:23,083 - Freezing Ratio: [Stage0] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:13:23,083 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:13:23,115 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:14:13,098 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:14:13,114 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:14:13,090 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:14:13,121 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:14:53,492 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:14:53,487 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:14:53,499 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:14:53,502 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:14:53,518 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:14:57,515 - Avg. fwd time: 7.9530 / Avg. bwd time: 12.3912 / Avg. batch time: 478.0982 (ms) / GPU bubble ratio: 65.96%
[rank3]:2025-12-30 18:14:57,495 - Avg. fwd time: 11.4803 / Avg. bwd time: 37.7876 / Avg. batch time: 453.6502 (ms) / GPU bubble ratio: 13.12%
[rank1]:2025-12-30 18:14:57,534 - Avg. fwd time: 10.2909 / Avg. bwd time: 15.9755 / Avg. batch time: 508.5442 (ms) / GPU bubble ratio: 58.68%
[rank1]:2025-12-30 18:14:57,552 -  step: 350  loss: -8.0000  grad_norm:  3.4967  memory: 16.34GiB(34.40%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank2]:2025-12-30 18:14:57,552 -  step: 350  loss: -8.0000  grad_norm:  3.4967  memory: 13.15GiB(27.69%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank3]:2025-12-30 18:14:57,568 -  step: 350  loss:  1.6446  grad_norm:  3.4967  memory: 29.97GiB(63.08%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank0]:2025-12-30 18:14:57,550 - Avg. fwd time: 9.1624 / Avg. bwd time: 14.6869 / Avg. batch time: 536.1909 (ms) / GPU bubble ratio: 64.42%
[rank0]:2025-12-30 18:14:57,552 -  step: 350  loss: -8.0000  grad_norm:  3.4967  memory: 19.07GiB(40.15%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank1]:2025-12-30 18:15:33,946 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:15:33,945 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:15:33,947 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:15:33,979 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:16:14,388 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:16:14,387 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:16:14,420 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:16:14,389 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:16:38,510 - Avg. fwd time: 10.3379 / Avg. bwd time: 15.6276 / Avg. batch time: 506.2003 (ms) / GPU bubble ratio: 58.96%
[rank2]:2025-12-30 18:16:38,491 - Avg. fwd time: 7.9909 / Avg. bwd time: 12.1209 / Avg. batch time: 476.1125 (ms) / GPU bubble ratio: 66.21%
[rank3]:2025-12-30 18:16:38,474 - Avg. fwd time: 11.5061 / Avg. bwd time: 37.5491 / Avg. batch time: 451.9457 (ms) / GPU bubble ratio: 13.17%
[rank0]:2025-12-30 18:16:38,527 - Avg. fwd time: 9.1970 / Avg. bwd time: 14.2531 / Avg. batch time: 533.3981 (ms) / GPU bubble ratio: 64.83%
[rank1]:2025-12-30 18:16:54,700 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:16:54,699 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:16:54,733 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:16:54,701 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:17:34,915 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:17:34,917 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:17:34,916 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:17:34,946 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:18:15,252 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:18:15,252 - Freezing Ratio: [Stage2] 0.94, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:18:15,255 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:18:15,257 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:18:15,284 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:18:19,341 - Avg. fwd time: 10.3788 / Avg. bwd time: 15.3233 / Avg. batch time: 504.1048 (ms) / GPU bubble ratio: 59.21%
[rank1]:2025-12-30 18:18:19,359 -  step: 400  loss: -8.0000  grad_norm:  0.2709  memory: 16.34GiB(34.40%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank2]:2025-12-30 18:18:19,321 - Avg. fwd time: 8.0239 / Avg. bwd time: 11.8842 / Avg. batch time: 474.3298 (ms) / GPU bubble ratio: 66.42%
[rank2]:2025-12-30 18:18:19,359 -  step: 400  loss: -8.0000  grad_norm:  0.2709  memory: 13.15GiB(27.69%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank0]:2025-12-30 18:18:19,357 - Avg. fwd time: 9.2265 / Avg. bwd time: 13.8701 / Avg. batch time: 530.9075 (ms) / GPU bubble ratio: 65.20%
[rank0]:2025-12-30 18:18:19,359 -  step: 400  loss: -8.0000  grad_norm:  0.2709  memory: 19.07GiB(40.15%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank3]:2025-12-30 18:18:19,303 - Avg. fwd time: 11.5276 / Avg. bwd time: 37.3357 / Avg. batch time: 450.4061 (ms) / GPU bubble ratio: 13.21%
[rank3]:2025-12-30 18:18:19,374 -  step: 400  loss:  0.4484  grad_norm:  0.2709  memory: 29.97GiB(63.08%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank1]:2025-12-30 18:18:19,426 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1818_stage1_step400.svg
[rank2]:2025-12-30 18:18:19,427 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1818_stage2_step400.svg
[rank0]:2025-12-30 18:18:19,425 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1818_stage0_step400.svg
[rank0]:2025-12-30 18:18:19,577 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1818_rank0_stage0.svg
[rank0]:	> Counts Sum: 833, Total Sum: 1295 (64.32%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 28.57, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 28.57, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank3]:2025-12-30 18:18:19,511 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1818_step400_rank3.svg
[rank3]:			> Batch Time: 491.75 ms, GPU Bubble Ratio: 71.24%, 64.61%, 72.60%, 25.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-37ms      | [S0,MB4,F]  37-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S0,MB7,F]  67-10-77ms     | [S0,MB0,B]  246-8-254ms    | [S0,MB1,B]  279-7-287ms    | [S0,MB2,B]  314-8-322ms    | [S0,MB3,B]  347-8-355ms    | [S0,MB4,B]  382-8-390ms    | [S0,MB5,B]  418-8-426ms    | [S0,MB6,B]  453-8-461ms    | [S0,MB7,B]  483-7-491ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  75-11-86ms     | [S1,MB5,F]  94-10-105ms    | [S1,MB6,F]  113-10-124ms   | [S1,MB7,F]  132-10-143ms   | [S1,MB0,B]  232-10-243ms   | [S1,MB1,B]  265-10-276ms   | [S1,MB2,B]  300-10-311ms   | [S1,MB3,B]  333-10-344ms   | [S1,MB4,B]  368-10-379ms   | [S1,MB5,B]  403-10-414ms   | [S1,MB6,B]  439-10-450ms   | [S1,MB7,B]  469-10-480ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  91-8-99ms      | [S2,MB5,F]  110-8-119ms    | [S2,MB6,F]  129-8-138ms    | [S2,MB7,F]  148-8-157ms    | [S2,MB0,B]  220-8-228ms    | [S2,MB1,B]  254-8-262ms    | [S2,MB2,B]  289-8-297ms    | [S2,MB3,B]  322-8-330ms    | [S2,MB4,B]  356-8-365ms    | [S2,MB5,B]  392-8-400ms    | [S2,MB6,B]  427-8-435ms    | [S2,MB7,B]  458-8-466ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB1,F]  49-11-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  88-11-99ms     | [S3,MB4,F]  107-11-119ms   | [S3,MB5,F]  126-11-138ms   | [S3,MB6,F]  145-11-157ms   | [S3,MB7,F]  165-11-176ms   | [S3,MB0,B]  182-31-214ms   | [S3,MB1,B]  214-33-247ms   | [S3,MB2,B]  247-34-281ms   | [S3,MB3,B]  282-33-315ms   | [S3,MB4,B]  315-34-350ms   | [S3,MB5,B]  350-35-385ms   | [S3,MB6,B]  385-34-420ms   | [S3,MB7,B]  420-34-454ms  
[rank3]:2025-12-30 18:18:19,560 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1818_stage3_step400.svg
[rank1]:2025-12-30 18:18:19,572 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1818_rank1_stage1.svg
[rank1]:	> Counts Sum: 1037, Total Sum: 1575 (65.84%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 48.57, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 45.71, 60.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 2.85]
[rank2]:2025-12-30 18:18:19,588 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1818_rank2_stage2.svg
[rank2]:	> Counts Sum: 872, Total Sum: 1260 (69.21%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 37.14, 51.42, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 60.0, 14.28, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 45.71, 14.28, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 22.85, 5.71]
[rank3]:2025-12-30 18:18:19,689 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1818_rank3_stage3.svg
[rank3]:	> Counts Sum: 594, Total Sum: 1015 (58.52%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 2.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 14.28, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 18:18:42,505 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 18:18:42,736 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 18:18:42,725 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 18:18:42,745 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 18:18:55,844 - Freezing Ratio: [Stage1] 0.07, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:18:55,843 - Freezing Ratio: [Stage2] 0.17, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:18:55,845 - Freezing Ratio: [Stage0] 0.05, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:18:55,875 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:19:45,730 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:19:45,722 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:19:45,753 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:19:45,746 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:20:10,009 - Avg. fwd time: 8.0158 / Avg. bwd time: 11.9335 / Avg. batch time: 474.6743 (ms) / GPU bubble ratio: 66.38%
[rank3]:2025-12-30 18:20:09,991 - Avg. fwd time: 11.5205 / Avg. bwd time: 37.3773 / Avg. batch time: 450.6822 (ms) / GPU bubble ratio: 13.20%
[rank1]:2025-12-30 18:20:10,028 - Avg. fwd time: 10.3693 / Avg. bwd time: 15.3904 / Avg. batch time: 504.5162 (ms) / GPU bubble ratio: 59.15%
[rank0]:2025-12-30 18:20:10,046 - Avg. fwd time: 9.2191 / Avg. bwd time: 13.9399 / Avg. batch time: 531.3871 (ms) / GPU bubble ratio: 65.13%
[rank0]:2025-12-30 18:20:26,054 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:20:26,053 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:20:26,053 - Freezing Ratio: [Stage2] 0.94, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:20:26,085 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:21:06,417 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:21:06,416 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:21:06,418 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:21:06,449 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:21:46,799 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:21:46,807 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:21:46,809 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:21:46,794 - Freezing Ratio: [Stage2] 0.94, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:21:46,827 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:21:50,784 - Avg. fwd time: 11.5390 / Avg. bwd time: 37.2000 / Avg. batch time: 449.4087 (ms) / GPU bubble ratio: 13.24%
[rank1]:2025-12-30 18:21:50,822 - Avg. fwd time: 10.4035 / Avg. bwd time: 15.1335 / Avg. batch time: 502.7664 (ms) / GPU bubble ratio: 59.37%
[rank1]:2025-12-30 18:21:50,840 -  step: 450  loss: -8.0000  grad_norm:  4.7559  memory: 16.34GiB(34.40%)  tps: 7,747  tflops: 60.56  mfu: 19.41%
[rank0]:2025-12-30 18:21:50,839 - Avg. fwd time: 9.2437 / Avg. bwd time: 13.6190 / Avg. batch time: 529.3036 (ms) / GPU bubble ratio: 65.44%
[rank0]:2025-12-30 18:21:50,841 -  step: 450  loss: -8.0000  grad_norm:  4.7559  memory: 19.07GiB(40.15%)  tps: 7,747  tflops: 60.56  mfu: 19.41%
[rank2]:2025-12-30 18:21:50,802 - Avg. fwd time: 8.0432 / Avg. bwd time: 11.7290 / Avg. batch time: 473.1886 (ms) / GPU bubble ratio: 66.57%
[rank2]:2025-12-30 18:21:50,840 -  step: 450  loss: -8.0000  grad_norm:  4.7559  memory: 13.15GiB(27.69%)  tps: 7,747  tflops: 60.56  mfu: 19.41%
[rank3]:2025-12-30 18:21:50,857 -  step: 450  loss:  0.9000  grad_norm:  4.7559  memory: 29.97GiB(63.08%)  tps: 7,747  tflops: 60.56  mfu: 19.41%
[rank1]:2025-12-30 18:22:27,108 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:22:27,108 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:22:27,106 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:22:27,139 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:23:07,297 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:23:07,298 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:23:07,296 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:23:07,327 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:23:31,586 - Avg. fwd time: 10.4338 / Avg. bwd time: 14.9038 / Avg. batch time: 501.1327 (ms) / GPU bubble ratio: 59.55%
[rank2]:2025-12-30 18:23:31,566 - Avg. fwd time: 8.0676 / Avg. bwd time: 11.5463 / Avg. batch time: 471.7921 (ms) / GPU bubble ratio: 66.74%
[rank3]:2025-12-30 18:23:31,548 - Avg. fwd time: 11.5543 / Avg. bwd time: 37.0342 / Avg. batch time: 448.2026 (ms) / GPU bubble ratio: 13.27%
[rank0]:2025-12-30 18:23:31,604 - Avg. fwd time: 9.2653 / Avg. bwd time: 13.3271 / Avg. batch time: 527.3671 (ms) / GPU bubble ratio: 65.73%
[rank1]:2025-12-30 18:23:47,710 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:23:47,713 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:23:47,710 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:23:47,742 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:24:28,116 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:24:28,115 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:24:28,114 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:24:28,147 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:25:08,330 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:25:08,332 - Freezing Ratio: [Stage0] 0.05, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:25:08,326 - Freezing Ratio: [Stage1] 0.07, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:25:08,326 - Freezing Ratio: [Stage2] 0.11, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:25:08,359 - Freezing Ratio: [Stage3] 0.07, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:25:13,211 - Avg. fwd time: 8.0866 / Avg. bwd time: 11.4043 / Avg. batch time: 470.6860 (ms) / GPU bubble ratio: 66.87%
[rank3]:2025-12-30 18:25:13,182 - Avg. fwd time: 11.5661 / Avg. bwd time: 36.9032 / Avg. batch time: 447.2451 (ms) / GPU bubble ratio: 13.30%
[rank1]:2025-12-30 18:25:13,246 - Avg. fwd time: 10.4574 / Avg. bwd time: 14.7254 / Avg. batch time: 499.8437 (ms) / GPU bubble ratio: 59.69%
[rank1]:2025-12-30 18:25:13,306 -  step: 500  loss: -8.0000  grad_norm: 15.8878  memory: 16.34GiB(34.40%)  tps: 8,092  tflops: 63.26  mfu: 20.28%
[rank0]:2025-12-30 18:25:13,281 - Avg. fwd time: 9.2825 / Avg. bwd time: 13.1101 / Avg. batch time: 525.8551 (ms) / GPU bubble ratio: 65.93%
[rank0]:2025-12-30 18:25:13,317 -  step: 500  loss: -8.0000  grad_norm: 15.8878  memory: 19.07GiB(40.15%)  tps: 8,092  tflops: 63.26  mfu: 20.28%
[rank2]:2025-12-30 18:25:13,302 -  step: 500  loss: -8.0000  grad_norm: 15.8878  memory: 13.15GiB(27.69%)  tps: 8,092  tflops: 63.26  mfu: 20.28%
[rank3]:2025-12-30 18:25:13,314 -  step: 500  loss:  0.6030  grad_norm: 15.8878  memory: 29.97GiB(63.08%)  tps: 8,093  tflops: 63.26  mfu: 20.28%
[rank1]:2025-12-30 18:25:13,374 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1825_stage1_step500.svg
[rank0]:2025-12-30 18:25:13,378 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1825_stage0_step500.svg
[rank2]:2025-12-30 18:25:13,372 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1825_stage2_step500.svg
[rank3]:2025-12-30 18:25:13,456 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1825_step500_rank3.svg
[rank3]:			> Batch Time: 495.80 ms, GPU Bubble Ratio: 71.33%, 64.83%, 72.86%, 25.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-37ms      | [S0,MB4,F]  37-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S0,MB7,F]  67-10-77ms     | [S0,MB0,B]  247-8-256ms    | [S0,MB1,B]  281-8-289ms    | [S0,MB2,B]  314-8-322ms    | [S0,MB3,B]  349-8-357ms    | [S0,MB4,B]  384-8-392ms    | [S0,MB5,B]  420-8-428ms    | [S0,MB6,B]  455-8-463ms    | [S0,MB7,B]  487-8-495ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  75-11-86ms     | [S1,MB5,F]  94-11-105ms    | [S1,MB6,F]  113-10-124ms   | [S1,MB7,F]  133-10-143ms   | [S1,MB0,B]  233-10-244ms   | [S1,MB1,B]  267-10-278ms   | [S1,MB2,B]  300-10-311ms   | [S1,MB3,B]  335-10-346ms   | [S1,MB4,B]  370-10-381ms   | [S1,MB5,B]  406-10-417ms   | [S1,MB6,B]  441-10-452ms   | [S1,MB7,B]  473-10-484ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  91-8-100ms     | [S2,MB5,F]  110-8-119ms    | [S2,MB6,F]  130-8-138ms    | [S2,MB7,F]  149-8-157ms    | [S2,MB0,B]  221-8-229ms    | [S2,MB1,B]  255-8-263ms    | [S2,MB2,B]  289-8-297ms    | [S2,MB3,B]  323-8-331ms    | [S2,MB4,B]  358-8-367ms    | [S2,MB5,B]  394-8-403ms    | [S2,MB6,B]  429-8-438ms    | [S2,MB7,B]  462-8-470ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  88-11-99ms     | [S3,MB4,F]  107-11-119ms   | [S3,MB5,F]  126-11-138ms   | [S3,MB6,F]  146-11-157ms   | [S3,MB7,F]  165-11-177ms   | [S3,MB0,B]  183-31-214ms   | [S3,MB1,B]  214-32-247ms   | [S3,MB2,B]  248-33-282ms   | [S3,MB3,B]  282-33-316ms   | [S3,MB4,B]  316-35-352ms   | [S3,MB5,B]  352-36-388ms   | [S3,MB6,B]  387-35-423ms   | [S3,MB7,B]  422-34-457ms  
[rank1]:2025-12-30 18:25:13,522 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1825_rank1_stage1.svg
[rank1]:	> Counts Sum: 1345, Total Sum: 2025 (66.42%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 4.44, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 57.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 55.55, 66.66, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.22, 2.22]
[rank0]:2025-12-30 18:25:13,541 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1825_rank0_stage0.svg
[rank0]:	> Counts Sum: 1082, Total Sum: 1665 (64.98%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 40.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.22, 42.22, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank2]:2025-12-30 18:25:13,534 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1825_rank2_stage2.svg
[rank2]:	> Counts Sum: 1142, Total Sum: 1620 (70.49%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 46.66, 57.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 60.0, 11.11, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 55.55, 26.66, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 17.77, 22.22]
[rank3]:2025-12-30 18:25:13,503 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1825_stage3_step500.svg
[rank3]:2025-12-30 18:25:13,635 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1825_rank3_stage3.svg
[rank3]:	> Counts Sum: 775, Total Sum: 1305 (59.39%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 2.22, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 28.88, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 11.11, 0.0, 0.0]
[rank1]:2025-12-30 18:25:58,583 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:25:58,576 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:25:58,599 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:25:58,608 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:26:39,040 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:26:39,040 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:26:39,039 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:26:39,071 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:27:03,277 - Avg. fwd time: 8.0801 / Avg. bwd time: 11.4498 / Avg. batch time: 471.0394 (ms) / GPU bubble ratio: 66.83%
[rank3]:2025-12-30 18:27:03,258 - Avg. fwd time: 11.5610 / Avg. bwd time: 36.9457 / Avg. batch time: 447.5440 (ms) / GPU bubble ratio: 13.29%
[rank0]:2025-12-30 18:27:03,316 - Avg. fwd time: 9.2767 / Avg. bwd time: 13.1669 / Avg. batch time: 526.3251 (ms) / GPU bubble ratio: 65.89%
[rank1]:2025-12-30 18:27:03,298 - Avg. fwd time: 10.4495 / Avg. bwd time: 14.7853 / Avg. batch time: 500.2587 (ms) / GPU bubble ratio: 59.65%
[rank0]:2025-12-30 18:27:19,566 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:27:19,565 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:27:19,565 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:27:19,596 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:27:59,916 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:27:59,917 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:27:59,915 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:27:59,947 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:28:40,337 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:28:40,342 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:28:40,344 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:28:40,330 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:28:40,362 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:28:44,400 - Avg. fwd time: 10.4740 / Avg. bwd time: 14.6052 / Avg. batch time: 499.0767 (ms) / GPU bubble ratio: 59.80%
[rank1]:2025-12-30 18:28:44,421 -  step: 550  loss: -8.0000  grad_norm:  0.4092  memory: 16.34GiB(34.40%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank0]:2025-12-30 18:28:44,419 - Avg. fwd time: 9.2944 / Avg. bwd time: 12.9396 / Avg. batch time: 524.9086 (ms) / GPU bubble ratio: 66.11%
[rank0]:2025-12-30 18:28:44,421 -  step: 550  loss: -8.0000  grad_norm:  0.4092  memory: 19.07GiB(40.15%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank2]:2025-12-30 18:28:44,379 - Avg. fwd time: 8.1000 / Avg. bwd time: 11.3108 / Avg. batch time: 470.0412 (ms) / GPU bubble ratio: 66.96%
[rank2]:2025-12-30 18:28:44,421 -  step: 550  loss: -8.0000  grad_norm:  0.4092  memory: 13.15GiB(27.69%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank3]:2025-12-30 18:28:44,360 - Avg. fwd time: 11.5754 / Avg. bwd time: 36.8249 / Avg. batch time: 446.6913 (ms) / GPU bubble ratio: 13.32%
[rank3]:2025-12-30 18:28:44,437 -  step: 550  loss:  0.3582  grad_norm:  0.4092  memory: 29.97GiB(63.08%)  tps: 7,761  tflops: 60.67  mfu: 19.44%
[rank0]:2025-12-30 18:29:20,814 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:29:20,813 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:29:20,813 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:29:20,847 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:30:01,267 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:30:01,266 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:30:01,267 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:30:01,296 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:30:25,357 - Avg. fwd time: 8.1179 / Avg. bwd time: 11.1835 / Avg. batch time: 469.0816 (ms) / GPU bubble ratio: 67.08%
[rank3]:2025-12-30 18:30:25,337 - Avg. fwd time: 11.5877 / Avg. bwd time: 36.7093 / Avg. batch time: 445.8643 (ms) / GPU bubble ratio: 13.34%
[rank1]:2025-12-30 18:30:25,378 - Avg. fwd time: 10.4960 / Avg. bwd time: 14.4401 / Avg. batch time: 497.9487 (ms) / GPU bubble ratio: 59.94%
[rank0]:2025-12-30 18:30:25,397 - Avg. fwd time: 9.3105 / Avg. bwd time: 12.7398 / Avg. batch time: 523.5758 (ms) / GPU bubble ratio: 66.31%
[rank1]:2025-12-30 18:30:41,566 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:30:41,566 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:30:41,566 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:30:41,599 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:31:21,865 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:31:21,866 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:31:21,865 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:31:21,897 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:32:02,213 - Freezing Ratio: [Stage1] 0.09, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:32:02,213 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:32:02,216 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:32:02,218 - Freezing Ratio: [Stage0] 0.08, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:32:02,244 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:32:07,183 - Avg. fwd time: 11.5974 / Avg. bwd time: 36.6214 / Avg. batch time: 445.2368 (ms) / GPU bubble ratio: 13.36%
[rank1]:2025-12-30 18:32:07,250 - Avg. fwd time: 10.5132 / Avg. bwd time: 14.3126 / Avg. batch time: 497.0876 (ms) / GPU bubble ratio: 60.05%
[rank2]:2025-12-30 18:32:07,214 - Avg. fwd time: 8.1317 / Avg. bwd time: 11.0857 / Avg. batch time: 468.3513 (ms) / GPU bubble ratio: 67.17%
[rank0]:2025-12-30 18:32:07,286 - Avg. fwd time: 9.3225 / Avg. bwd time: 12.5761 / Avg. batch time: 522.5454 (ms) / GPU bubble ratio: 66.47%
[rank3]:2025-12-30 18:32:07,320 -  step: 600  loss:  0.3152  grad_norm:  8.5283  memory: 29.97GiB(63.08%)  tps: 8,076  tflops: 63.13  mfu: 20.23%
[rank1]:2025-12-30 18:32:07,311 -  step: 600  loss: -8.0000  grad_norm:  8.5283  memory: 16.34GiB(34.40%)  tps: 8,075  tflops: 63.13  mfu: 20.23%
[rank1]:2025-12-30 18:32:07,370 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1832_stage1_step600.svg
[rank2]:2025-12-30 18:32:07,308 -  step: 600  loss: -8.0000  grad_norm:  8.5283  memory: 13.15GiB(27.69%)  tps: 8,075  tflops: 63.13  mfu: 20.23%
[rank2]:2025-12-30 18:32:07,370 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1832_stage2_step600.svg
[rank0]:2025-12-30 18:32:07,322 -  step: 600  loss: -8.0000  grad_norm:  8.5283  memory: 19.07GiB(40.15%)  tps: 8,075  tflops: 63.13  mfu: 20.23%
[rank0]:2025-12-30 18:32:07,370 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1832_stage0_step600.svg
[rank3]:2025-12-30 18:32:07,461 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1832_step600_rank3.svg
[rank3]:			> Batch Time: 493.38 ms, GPU Bubble Ratio: 71.27%, 64.76%, 72.65%, 25.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-28ms      | [S0,MB3,F]  28-9-37ms      | [S0,MB4,F]  37-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-66ms      | [S0,MB7,F]  66-9-76ms      | [S0,MB0,B]  246-8-254ms    | [S0,MB1,B]  279-8-287ms    | [S0,MB2,B]  314-8-322ms    | [S0,MB3,B]  347-8-355ms    | [S0,MB4,B]  383-8-391ms    | [S0,MB5,B]  419-8-427ms    | [S0,MB6,B]  453-8-461ms    | [S0,MB7,B]  485-8-493ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  94-10-104ms    | [S1,MB6,F]  113-10-124ms   | [S1,MB7,F]  132-10-143ms   | [S1,MB0,B]  232-10-243ms   | [S1,MB1,B]  265-10-276ms   | [S1,MB2,B]  300-10-310ms   | [S1,MB3,B]  333-10-344ms   | [S1,MB4,B]  369-10-380ms   | [S1,MB5,B]  404-10-415ms   | [S1,MB6,B]  439-10-450ms   | [S1,MB7,B]  471-10-482ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  52-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-99ms      | [S2,MB5,F]  110-8-118ms    | [S2,MB6,F]  129-8-137ms    | [S2,MB7,F]  148-8-156ms    | [S2,MB0,B]  220-8-229ms    | [S2,MB1,B]  254-8-262ms    | [S2,MB2,B]  288-8-296ms    | [S2,MB3,B]  322-8-330ms    | [S2,MB4,B]  357-8-365ms    | [S2,MB5,B]  393-8-401ms    | [S2,MB6,B]  428-8-436ms    | [S2,MB7,B]  459-8-468ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB1,F]  49-11-61ms     | [S3,MB2,F]  68-11-80ms     | [S3,MB3,F]  87-11-99ms     | [S3,MB4,F]  106-11-118ms   | [S3,MB5,F]  126-11-137ms   | [S3,MB6,F]  145-11-157ms   | [S3,MB7,F]  164-11-176ms   | [S3,MB0,B]  182-31-213ms   | [S3,MB1,B]  213-33-247ms   | [S3,MB2,B]  247-34-281ms   | [S3,MB3,B]  281-34-316ms   | [S3,MB4,B]  315-35-351ms   | [S3,MB5,B]  350-35-386ms   | [S3,MB6,B]  386-35-421ms   | [S3,MB7,B]  421-35-456ms  
[rank3]:2025-12-30 18:32:07,509 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1832_stage3_step600.svg
[rank1]:2025-12-30 18:32:07,518 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1832_rank1_stage1.svg
[rank1]:	> Counts Sum: 1700, Total Sum: 2475 (68.69%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 18.18, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 10.9, 63.63, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 60.0, 70.9, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 1.81, 1.81]
[rank2]:2025-12-30 18:32:07,519 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1832_rank2_stage2.svg
[rank2]:	> Counts Sum: 1415, Total Sum: 1980 (71.46%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 38.18, 54.54, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 49.09, 9.09, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 61.81, 23.63, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 21.81, 23.63]
[rank0]:2025-12-30 18:32:07,521 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1832_rank0_stage0.svg
[rank0]:	> Counts Sum: 1364, Total Sum: 2035 (67.03%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 49.09, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 7.27, 50.9, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0]
[rank3]:2025-12-30 18:32:07,642 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1832_rank3_stage3.svg
[rank3]:	> Counts Sum: 980, Total Sum: 1595 (61.44%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 1.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 38.18, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 23.63, 0.0, 0.0]
[rank1]:2025-12-30 18:32:52,701 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:32:52,724 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:32:52,693 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:32:52,718 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:33:33,036 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:33:33,036 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:33:33,037 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:33:33,067 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:33:57,280 - Avg. fwd time: 11.5923 / Avg. bwd time: 36.6673 / Avg. batch time: 445.5617 (ms) / GPU bubble ratio: 13.35%
[rank1]:2025-12-30 18:33:57,323 - Avg. fwd time: 10.5046 / Avg. bwd time: 14.3794 / Avg. batch time: 497.5481 (ms) / GPU bubble ratio: 59.99%
[rank2]:2025-12-30 18:33:57,301 - Avg. fwd time: 8.1246 / Avg. bwd time: 11.1371 / Avg. batch time: 468.7425 (ms) / GPU bubble ratio: 67.13%
[rank0]:2025-12-30 18:33:57,342 - Avg. fwd time: 9.3165 / Avg. bwd time: 12.6457 / Avg. batch time: 523.0771 (ms) / GPU bubble ratio: 66.41%
[rank1]:2025-12-30 18:34:13,411 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:34:13,411 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:34:13,412 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:34:13,442 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:34:53,914 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:34:53,913 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:34:53,945 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:34:53,913 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:35:34,408 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:35:34,379 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:35:34,387 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:35:34,389 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:35:34,375 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:35:38,371 - Avg. fwd time: 11.6027 / Avg. bwd time: 36.5744 / Avg. batch time: 444.9001 (ms) / GPU bubble ratio: 13.37%
[rank1]:2025-12-30 18:35:38,413 - Avg. fwd time: 10.5234 / Avg. bwd time: 14.2417 / Avg. batch time: 496.6345 (ms) / GPU bubble ratio: 60.11%
[rank1]:2025-12-30 18:35:38,433 -  step: 650  loss: -8.0000  grad_norm:  0.5589  memory: 16.34GiB(34.40%)  tps: 7,760  tflops: 60.67  mfu: 19.44%
[rank0]:2025-12-30 18:35:38,432 - Avg. fwd time: 9.3303 / Avg. bwd time: 12.4809 / Avg. batch time: 521.9944 (ms) / GPU bubble ratio: 66.57%
[rank0]:2025-12-30 18:35:38,434 -  step: 650  loss: -8.0000  grad_norm:  0.5589  memory: 19.07GiB(40.15%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank2]:2025-12-30 18:35:38,391 - Avg. fwd time: 8.1397 / Avg. bwd time: 11.0301 / Avg. batch time: 467.9687 (ms) / GPU bubble ratio: 67.23%
[rank2]:2025-12-30 18:35:38,433 -  step: 650  loss: -8.0000  grad_norm:  0.5589  memory: 13.15GiB(27.69%)  tps: 7,760  tflops: 60.67  mfu: 19.44%
[rank3]:2025-12-30 18:35:38,449 -  step: 650  loss:  0.3105  grad_norm:  0.5589  memory: 29.97GiB(63.08%)  tps: 7,760  tflops: 60.67  mfu: 19.44%
[rank0]:2025-12-30 18:36:14,684 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:36:14,684 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:36:14,683 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:36:14,715 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:36:54,873 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:36:54,872 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:36:54,904 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:36:54,872 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:37:19,170 - Avg. fwd time: 11.6112 / Avg. bwd time: 36.4834 / Avg. batch time: 444.2393 (ms) / GPU bubble ratio: 13.39%
[rank2]:2025-12-30 18:37:19,190 - Avg. fwd time: 8.1533 / Avg. bwd time: 10.9304 / Avg. batch time: 467.2034 (ms) / GPU bubble ratio: 67.32%
[rank1]:2025-12-30 18:37:19,213 - Avg. fwd time: 10.5403 / Avg. bwd time: 14.1139 / Avg. batch time: 495.7390 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-12-30 18:37:19,232 - Avg. fwd time: 9.3424 / Avg. bwd time: 12.3198 / Avg. batch time: 520.9336 (ms) / GPU bubble ratio: 66.73%
[rank1]:2025-12-30 18:37:35,371 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:37:35,372 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:37:35,371 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:37:35,402 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:38:15,966 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:38:15,966 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:38:15,965 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:38:15,997 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:38:56,499 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:38:56,502 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:38:56,504 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:38:56,499 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:38:56,530 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:39:00,493 - Avg. fwd time: 11.6202 / Avg. bwd time: 36.4090 / Avg. batch time: 443.7154 (ms) / GPU bubble ratio: 13.41%
[rank2]:2025-12-30 18:39:00,513 - Avg. fwd time: 8.1661 / Avg. bwd time: 10.8383 / Avg. batch time: 466.5829 (ms) / GPU bubble ratio: 67.42%
[rank3]:2025-12-30 18:39:00,573 -  step: 700  loss:  0.2846  grad_norm:  0.4109  memory: 29.97GiB(63.08%)  tps: 8,106  tflops: 63.37  mfu: 20.31%
[rank1]:2025-12-30 18:39:00,536 - Avg. fwd time: 10.5561 / Avg. bwd time: 13.9958 / Avg. batch time: 494.9979 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-12-30 18:39:00,558 -  step: 700  loss: -8.0000  grad_norm:  0.4109  memory: 16.34GiB(34.40%)  tps: 8,106  tflops: 63.37  mfu: 20.31%
[rank0]:2025-12-30 18:39:00,556 - Avg. fwd time: 9.3538 / Avg. bwd time: 12.1703 / Avg. batch time: 520.0391 (ms) / GPU bubble ratio: 66.89%
[rank0]:2025-12-30 18:39:00,558 -  step: 700  loss: -8.0000  grad_norm:  0.4109  memory: 19.07GiB(40.15%)  tps: 8,106  tflops: 63.37  mfu: 20.31%
[rank0]:2025-12-30 18:39:00,623 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1839_stage0_step700.svg
[rank2]:2025-12-30 18:39:00,558 -  step: 700  loss: -8.0000  grad_norm:  0.4109  memory: 13.15GiB(27.69%)  tps: 8,106  tflops: 63.37  mfu: 20.31%
[rank2]:2025-12-30 18:39:00,638 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1839_stage2_step700.svg
[rank1]:2025-12-30 18:39:00,636 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1839_stage1_step700.svg
[rank3]:2025-12-30 18:39:00,711 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1839_step700_rank3.svg
[rank3]:			> Batch Time: 495.91 ms, GPU Bubble Ratio: 71.24%, 64.84%, 72.80%, 25.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-37ms      | [S0,MB4,F]  37-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S0,MB7,F]  67-10-77ms     | [S0,MB0,B]  246-8-254ms    | [S0,MB1,B]  280-8-288ms    | [S0,MB2,B]  314-8-322ms    | [S0,MB3,B]  349-8-357ms    | [S0,MB4,B]  385-8-393ms    | [S0,MB5,B]  420-8-428ms    | [S0,MB6,B]  456-8-464ms    | [S0,MB7,B]  487-8-495ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-11-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  75-11-86ms     | [S1,MB5,F]  94-11-105ms    | [S1,MB6,F]  113-11-124ms   | [S1,MB7,F]  132-11-143ms   | [S1,MB0,B]  232-10-243ms   | [S1,MB1,B]  266-10-277ms   | [S1,MB2,B]  300-10-311ms   | [S1,MB3,B]  335-10-346ms   | [S1,MB4,B]  371-10-382ms   | [S1,MB5,B]  406-10-417ms   | [S1,MB6,B]  441-10-452ms   | [S1,MB7,B]  473-10-484ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  52-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  91-8-99ms      | [S2,MB5,F]  110-8-119ms    | [S2,MB6,F]  129-8-138ms    | [S2,MB7,F]  149-8-157ms    | [S2,MB0,B]  221-8-229ms    | [S2,MB1,B]  255-8-263ms    | [S2,MB2,B]  289-8-297ms    | [S2,MB3,B]  324-8-332ms    | [S2,MB4,B]  359-8-367ms    | [S2,MB5,B]  394-8-403ms    | [S2,MB6,B]  430-8-438ms    | [S2,MB7,B]  462-8-470ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB1,F]  49-11-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  88-11-99ms     | [S3,MB4,F]  107-11-119ms   | [S3,MB5,F]  126-11-138ms   | [S3,MB6,F]  146-11-157ms   | [S3,MB7,F]  165-11-177ms   | [S3,MB0,B]  183-31-215ms   | [S3,MB1,B]  214-33-248ms   | [S3,MB2,B]  248-34-283ms   | [S3,MB3,B]  282-35-317ms   | [S3,MB4,B]  317-34-351ms   | [S3,MB5,B]  352-35-388ms   | [S3,MB6,B]  388-35-423ms   | [S3,MB7,B]  423-35-458ms  
[rank3]:2025-12-30 18:39:00,755 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1839_stage3_step700.svg
[rank1]:2025-12-30 18:39:00,783 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1839_rank1_stage1.svg
[rank1]:	> Counts Sum: 2089, Total Sum: 2925 (71.42%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 27.69, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 21.53, 66.15, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 60.0, 73.84, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 1.53, 1.53]
[rank0]:2025-12-30 18:39:00,779 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1839_rank0_stage0.svg
[rank0]:	> Counts Sum: 1676, Total Sum: 2405 (69.69%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 55.38, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 16.92, 52.3, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0]
[rank2]:2025-12-30 18:39:00,789 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1839_rank2_stage2.svg
[rank2]:	> Counts Sum: 1712, Total Sum: 2340 (73.16%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 32.3, 46.15, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 41.53, 7.69, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 66.15, 20.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 30.76, 20.0]
[rank3]:2025-12-30 18:39:00,891 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1839_rank3_stage3.svg
[rank3]:	> Counts Sum: 1211, Total Sum: 1885 (64.24%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 1.53, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 46.15, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 6.15, 32.3, 0.0, 0.0]
[rank1]:2025-12-30 18:39:37,258 - Freezing Ratio: [Stage1] 0.07, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:39:37,259 - Freezing Ratio: [Stage0] 0.05, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:39:37,258 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:39:37,289 - Freezing Ratio: [Stage3] 0.10, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:40:27,520 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:40:27,543 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:40:27,512 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:40:27,535 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:40:51,739 - Avg. fwd time: 11.6137 / Avg. bwd time: 36.4732 / Avg. batch time: 444.1789 (ms) / GPU bubble ratio: 13.39%
[rank2]:2025-12-30 18:40:51,760 - Avg. fwd time: 8.1564 / Avg. bwd time: 10.9064 / Avg. batch time: 467.1267 (ms) / GPU bubble ratio: 67.35%
[rank1]:2025-12-30 18:40:51,784 - Avg. fwd time: 10.5444 / Avg. bwd time: 14.0836 / Avg. batch time: 495.6298 (ms) / GPU bubble ratio: 60.25%
[rank0]:2025-12-30 18:40:51,805 - Avg. fwd time: 9.3455 / Avg. bwd time: 12.2727 / Avg. batch time: 520.7759 (ms) / GPU bubble ratio: 66.79%
[rank3]:2025-12-30 18:41:08,077 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:41:08,047 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:41:08,048 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:41:08,047 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:41:48,327 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:41:48,296 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:41:48,296 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:41:48,296 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:42:28,601 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:42:28,597 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:42:28,628 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:42:28,609 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:42:28,612 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:42:32,640 - Avg. fwd time: 8.1683 / Avg. bwd time: 10.8216 / Avg. batch time: 466.4696 (ms) / GPU bubble ratio: 67.43%
[rank3]:2025-12-30 18:42:32,619 - Avg. fwd time: 11.6212 / Avg. bwd time: 36.3946 / Avg. batch time: 443.6083 (ms) / GPU bubble ratio: 13.41%
[rank3]:2025-12-30 18:42:32,702 -  step: 750  loss:  0.3236  grad_norm:  0.1488  memory: 29.97GiB(63.08%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank1]:2025-12-30 18:42:32,663 - Avg. fwd time: 10.5593 / Avg. bwd time: 13.9735 / Avg. batch time: 494.8592 (ms) / GPU bubble ratio: 60.34%
[rank1]:2025-12-30 18:42:32,685 -  step: 750  loss: -8.0000  grad_norm:  0.1488  memory: 16.34GiB(34.40%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank0]:2025-12-30 18:42:32,684 - Avg. fwd time: 9.3563 / Avg. bwd time: 12.1379 / Avg. batch time: 519.8660 (ms) / GPU bubble ratio: 66.92%
[rank0]:2025-12-30 18:42:32,686 -  step: 750  loss: -8.0000  grad_norm:  0.1488  memory: 19.07GiB(40.15%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank2]:2025-12-30 18:42:32,685 -  step: 750  loss: -8.0000  grad_norm:  0.1488  memory: 13.15GiB(27.69%)  tps: 7,724  tflops: 60.38  mfu: 19.35%
[rank2]:2025-12-30 18:43:08,990 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:43:08,990 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:43:08,991 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:43:09,021 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:43:49,533 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:43:49,534 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:43:49,535 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:43:49,563 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:44:13,714 - Avg. fwd time: 10.5734 / Avg. bwd time: 13.8707 / Avg. batch time: 494.1618 (ms) / GPU bubble ratio: 60.43%
[rank3]:2025-12-30 18:44:13,668 - Avg. fwd time: 11.6286 / Avg. bwd time: 36.3237 / Avg. batch time: 443.1001 (ms) / GPU bubble ratio: 13.42%
[rank2]:2025-12-30 18:44:13,690 - Avg. fwd time: 8.1794 / Avg. bwd time: 10.7419 / Avg. batch time: 465.8782 (ms) / GPU bubble ratio: 67.51%
[rank0]:2025-12-30 18:44:13,734 - Avg. fwd time: 9.3659 / Avg. bwd time: 12.0090 / Avg. batch time: 519.0359 (ms) / GPU bubble ratio: 67.05%
[rank2]:2025-12-30 18:44:29,879 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:44:29,880 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:44:29,879 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:44:29,909 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:45:10,229 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:45:10,230 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:45:10,230 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:45:10,260 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank2]:2025-12-30 18:45:50,669 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 18:45:50,672 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:45:50,674 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:45:50,700 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 18:45:50,669 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 18:45:54,762 - Avg. fwd time: 11.6367 / Avg. bwd time: 36.2591 / Avg. batch time: 442.6472 (ms) / GPU bubble ratio: 13.44%
[rank2]:2025-12-30 18:45:54,784 - Avg. fwd time: 8.1901 / Avg. bwd time: 10.6674 / Avg. batch time: 465.3485 (ms) / GPU bubble ratio: 67.58%
[rank0]:2025-12-30 18:45:54,829 - Avg. fwd time: 9.3754 / Avg. bwd time: 11.8881 / Avg. batch time: 518.2828 (ms) / GPU bubble ratio: 67.18%
[rank0]:2025-12-30 18:45:54,832 -  step: 800  loss: -8.0000  grad_norm:  0.1395  memory: 19.07GiB(40.15%)  tps: 8,105  tflops: 63.36  mfu: 20.31%
[rank0]:2025-12-30 18:45:54,832 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1395  tps: 8,189  tflops: 64.02  mfu: 18.71%
[rank0]:2025-12-30 18:45:54,832 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 18:45:54,833 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 18:45:54,847 -  step: 800  loss:  0.3063  grad_norm:  0.1395  memory: 29.97GiB(63.08%)  tps: 8,105  tflops: 63.36  mfu: 20.31%
[rank3]:2025-12-30 18:45:54,847 - â„¹ï¸ final step: 800  loss:  0.3063  grad_norm:  0.1395  tps: 8,195  tflops: 64.06  mfu: 18.83%
[rank3]:2025-12-30 18:45:54,848 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 18:45:54,849 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-30 18:45:54,809 - Avg. fwd time: 10.5870 / Avg. bwd time: 13.7749 / Avg. batch time: 493.5343 (ms) / GPU bubble ratio: 60.51%
[rank1]:2025-12-30 18:45:54,831 -  step: 800  loss: -8.0000  grad_norm:  0.1395  memory: 16.34GiB(34.40%)  tps: 8,105  tflops: 63.36  mfu: 20.31%
[rank1]:2025-12-30 18:45:54,831 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1395  tps: 8,189  tflops: 64.02  mfu: 18.71%
[rank1]:2025-12-30 18:45:54,831 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 18:45:54,832 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 18:45:54,831 -  step: 800  loss: -8.0000  grad_norm:  0.1395  memory: 13.15GiB(27.69%)  tps: 8,105  tflops: 63.36  mfu: 20.31%
[rank2]:2025-12-30 18:45:54,831 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1395  tps: 8,189  tflops: 64.02  mfu: 18.71%
[rank2]:2025-12-30 18:45:54,831 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-30 18:45:54,832 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 18:45:56,815 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-30 18:45:56,888 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank2/251230_1845_stage2_final800.svg
[rank0]:2025-12-30 18:45:56,889 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank0/251230_1845_stage0_final800.svg
[rank1]:2025-12-30 18:45:56,888 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank1/251230_1845_stage1_final800.svg
[rank0]:2025-12-30 18:45:57,046 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1845_rank0_stage0.svg
[rank0]:	> Counts Sum: 1955, Total Sum: 2775 (70.45%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 60.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 26.66, 45.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0]
[rank0]:2025-12-30 18:45:57,046 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-30 18:45:56,975 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1845_final800_rank3.svg
[rank3]:			> Batch Time: 496.23 ms, GPU Bubble Ratio: 71.21%, 64.95%, 72.84%, 24.97%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-37ms      | [S0,MB4,F]  37-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S0,MB7,F]  67-10-77ms     | [S0,MB0,B]  247-8-255ms    | [S0,MB1,B]  281-8-289ms    | [S0,MB2,B]  315-8-323ms    | [S0,MB3,B]  349-8-357ms    | [S0,MB4,B]  385-8-393ms    | [S0,MB5,B]  420-8-428ms    | [S0,MB6,B]  456-8-464ms    | [S0,MB7,B]  488-8-496ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-11-67ms     | [S1,MB4,F]  75-10-86ms     | [S1,MB5,F]  94-10-105ms    | [S1,MB6,F]  113-10-124ms   | [S1,MB7,F]  132-10-143ms   | [S1,MB0,B]  233-10-244ms   | [S1,MB1,B]  267-10-278ms   | [S1,MB2,B]  301-10-312ms   | [S1,MB3,B]  336-10-346ms   | [S1,MB4,B]  371-10-382ms   | [S1,MB5,B]  406-10-417ms   | [S1,MB6,B]  442-10-452ms   | [S1,MB7,B]  473-10-484ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  34-8-43ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  91-8-99ms      | [S2,MB5,F]  110-8-118ms    | [S2,MB6,F]  129-8-138ms    | [S2,MB7,F]  148-8-157ms    | [S2,MB0,B]  221-8-229ms    | [S2,MB1,B]  255-8-263ms    | [S2,MB2,B]  289-8-298ms    | [S2,MB3,B]  324-8-332ms    | [S2,MB4,B]  359-8-367ms    | [S2,MB5,B]  395-8-403ms    | [S2,MB6,B]  430-8-438ms    | [S2,MB7,B]  462-8-470ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  88-11-99ms     | [S3,MB4,F]  107-11-118ms   | [S3,MB5,F]  126-11-138ms   | [S3,MB6,F]  145-11-157ms   | [S3,MB7,F]  164-11-176ms   | [S3,MB0,B]  182-31-214ms   | [S3,MB1,B]  214-33-248ms   | [S3,MB2,B]  248-34-283ms   | [S3,MB3,B]  282-34-317ms   | [S3,MB4,B]  317-35-353ms   | [S3,MB5,B]  352-36-388ms   | [S3,MB6,B]  388-35-424ms   | [S3,MB7,B]  423-35-458ms  
[rank1]:2025-12-30 18:45:57,035 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1845_rank1_stage1.svg
[rank1]:	> Counts Sum: 2431, Total Sum: 3375 (72.03%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 36.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 29.33, 58.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 52.0, 76.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 1.33]
[rank1]:2025-12-30 18:45:57,036 - Destroying the purge thread.
[rank2]:2025-12-30 18:45:57,041 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1845_rank2_stage2.svg
[rank2]:	> Counts Sum: 1982, Total Sum: 2700 (73.41%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 28.0, 40.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 36.0, 6.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 69.33, 17.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 38.66, 17.33]
[rank2]:2025-12-30 18:45:57,041 - Destroying the purge thread.
[rank2]:2025-12-30 18:45:57,068 - Process group destroyed
[rank3]:2025-12-30 18:45:57,112 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/pipeline_schedule/251230_1845_thry_final800_rank3.svg
[rank3]:			> Batch Time: 336.99 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB4,F]  40-10-51ms     | [S0,MB5,F]  51-10-61ms     | [S0,MB6,F]  61-10-71ms     | [S0,MB7,F]  71-10-81ms     | [S0,MB0,B]  173-20-194ms   | [S0,MB1,B]  194-20-214ms   | [S0,MB2,B]  214-20-234ms   | [S0,MB3,B]  234-20-255ms   | [S0,MB4,B]  255-20-275ms   | [S0,MB5,B]  275-20-296ms   | [S0,MB6,B]  296-20-316ms   | [S0,MB7,B]  316-20-336ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB3,F]  40-10-51ms     | [S1,MB4,F]  51-10-61ms     | [S1,MB5,F]  61-10-71ms     | [S1,MB6,F]  71-10-81ms     | [S1,MB7,F]  81-10-91ms     | [S1,MB0,B]  153-20-173ms   | [S1,MB1,B]  173-20-194ms   | [S1,MB2,B]  194-20-214ms   | [S1,MB3,B]  214-20-234ms   | [S1,MB4,B]  234-20-255ms   | [S1,MB5,B]  255-20-275ms   | [S1,MB6,B]  275-20-296ms   | [S1,MB7,B]  296-20-316ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB2,F]  40-10-51ms     | [S2,MB3,F]  51-10-61ms     | [S2,MB4,F]  61-10-71ms     | [S2,MB5,F]  71-10-81ms     | [S2,MB6,F]  81-10-91ms     | [S2,MB7,F]  91-10-102ms    | [S2,MB0,B]  132-20-153ms   | [S2,MB1,B]  153-20-173ms   | [S2,MB2,B]  173-20-194ms   | [S2,MB3,B]  194-20-214ms   | [S2,MB4,B]  214-20-234ms   | [S2,MB5,B]  234-20-255ms   | [S2,MB6,B]  255-20-275ms   | [S2,MB7,B]  275-20-296ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB1,F]  40-10-51ms     | [S3,MB2,F]  51-10-61ms     | [S3,MB3,F]  61-10-71ms     | [S3,MB4,F]  71-10-81ms     | [S3,MB5,F]  81-10-91ms     | [S3,MB6,F]  91-10-102ms    | [S3,MB7,F]  102-10-112ms   | [S3,MB0,B]  112-20-132ms   | [S3,MB1,B]  132-20-153ms   | [S3,MB2,B]  153-20-173ms   | [S3,MB3,B]  173-20-194ms   | [S3,MB4,B]  194-20-214ms   | [S3,MB5,B]  214-20-234ms   | [S3,MB6,B]  234-20-255ms   | [S3,MB7,B]  255-20-275ms  
[rank3]:2025-12-30 18:45:57,160 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_ratio_history/rank3/251230_1845_stage3_final800.svg
[rank1]:2025-12-30 18:45:57,078 - Process group destroyed
[rank3]:2025-12-30 18:45:57,294 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1/frozen_params_histogram/251230_1845_rank3_stage3.svg
[rank3]:	> Counts Sum: 1426, Total Sum: 2175 (65.56%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 1.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 52.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 16.0, 40.0, 0.0, 0.0]
[rank3]:2025-12-30 18:45:57,295 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 370-391
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–‚â–â–‚â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–„â–„â–‚â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–„â–„â–‚â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.99874
[rank3]:wandb:               final/avg_loss 0.30626
[rank3]:wandb:             final/avg_mfu(%) 18.83432
[rank3]:wandb:             final/avg_tflops 64.06148
[rank3]:wandb:    final/avg_throughput(tps) 8194.58367
[rank3]:wandb:              final/grad_norm 0.13952
[rank3]:wandb:               final/max_loss 0.30626
[rank3]:wandb:                    grad_norm 0.13952
[rank3]:wandb: loss_metrics/global_avg_loss 0.30626
[rank3]:wandb: loss_metrics/global_max_loss 0.30626
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_GPipe_apf_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/92q01b48
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_GPipe_apf_22_dm1/20251230-1749/wandb/run-20251230_174914-92q01b48/logs
[rank3]:2025-12-30 18:45:58,611 - Process group destroyed
[rank0]:2025-12-30 18:45:59,047 - Training completed
[rank0]:2025-12-30 18:45:59,047 - Destroying the purge thread.
[rank0]:2025-12-30 18:45:59,129 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.9', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.8', 'layers.4', 'layers.6', 'layers.5'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.3', 'layers.2', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.15', 'norm', 'output', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_GPipe_apf_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_GPipe_apf_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_GPipe_apf_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_GPipe_apf_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_GPipe_apf_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_GPipe_apf_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_GPipe_apf_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_GPipe_apf_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
