
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 21:29:37 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_1F1B_timelyauto_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with timelyauto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-30 21:29:43,331 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank3]:2025-12-30 21:29:43,331 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank1]:2025-12-30 21:29:43,455 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank0]:2025-12-30 21:29:43,588 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:2025-12-30 21:29:43,542 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank2]:2025-12-30 21:29:43,544 - Building 1-D device mesh with ['pp'], [4]
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank3]:2025-12-30 21:29:43,553 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 21:29:43,556 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-30 21:29:43,670 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 21:29:43,673 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 21:29:43,786 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 21:29:43,789 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 21:29:43,792 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 21:29:43,794 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-30 21:29:44,175 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 21:29:46,921 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-30 21:29:46,956 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 21:29:47,003 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 21:29:46,954 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 21:29:47,029 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 21:29:47,030 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-30 21:29:47,004 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 21:29:47,032 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 21:29:47,032 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-30 21:29:47,092 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 21:29:47,134 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 21:29:47,223 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 21:29:47,224 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 21:29:47,224 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-30 21:29:47,218 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 21:29:47,218 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 21:29:47,219 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-30 21:29:47,136 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-30 21:29:47,164 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 21:29:47,164 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-30 21:29:47,353 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 21:29:47,353 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 21:29:47,354 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 7de1kmn9
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_1F1B_timelyauto_22_dm1/20251230-2129/wandb/run-20251230_212948-7de1kmn9
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_1F1B_timelyauto_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/7de1kmn9
[rank3]:2025-12-30 21:29:49,486 - WandB logging enabled
[rank3]:2025-12-30 21:29:49,486 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 21:29:49,527 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 21:29:49,555 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 21:29:49,556 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-30 21:29:49,759 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-30 21:29:49,759 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 21:29:49,760 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_1F1B_timelyauto_22_dm1
[rank3]:2025-12-30 21:29:49,742 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 21:29:49,743 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 21:29:49,760 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-30 21:29:49,744 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-30 21:29:49,759 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 21:29:49,760 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 21:29:49,761 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-30 21:29:52,226 - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-12-30 21:29:52,226 - Finished loading the checkpoint in 2.47 seconds.
[rank0]:2025-12-30 21:29:52,226 - Training starts at step 1
[rank2]:2025-12-30 21:29:57,488 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory:  6.84GiB(14.41%)  tps: 3,126  tflops: 24.43  mfu: 7.83%
[rank2]:2025-12-30 21:29:57,488 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 21:29:57,498 -  step:  1  loss: 10.6092  grad_norm: 203.0660  memory: 21.88GiB(46.05%)  tps: 4,112  tflops: 32.15  mfu: 10.30%
[rank3]:2025-12-30 21:29:57,499 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 21:29:57,525 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 13.10GiB(27.57%)  tps: 3,154  tflops: 24.65  mfu: 7.90%
[rank0]:2025-12-30 21:29:57,526 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 21:29:57,491 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 10.58GiB(22.26%)  tps: 3,125  tflops: 24.43  mfu: 7.83%
[rank1]:2025-12-30 21:29:57,491 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 21:33:50,186 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 21:33:54,863 - Avg. fwd time: 24.6328 / Avg. bwd time: 80.8207 / Avg. batch time: 988.9968 (ms) / GPU bubble ratio: 14.70%
[rank1]:2025-12-30 21:33:54,957 - Avg. fwd time: 19.7302 / Avg. bwd time: 45.6012 / Avg. batch time: 1120.1351 (ms) / GPU bubble ratio: 53.34%
[rank2]:2025-12-30 21:33:54,905 - Avg. fwd time: 14.9409 / Avg. bwd time: 35.2759 / Avg. batch time: 1047.2783 (ms) / GPU bubble ratio: 61.64%
[rank3]:2025-12-30 21:33:55,039 -  step: 50  loss:  9.8846  grad_norm: 23.9686  memory: 25.79GiB(54.28%)  tps: 6,759  tflops: 52.84  mfu: 16.94%
[rank1]:2025-12-30 21:33:55,030 -  step: 50  loss: -4.0000  grad_norm: 23.9686  memory: 12.86GiB(27.07%)  tps: 6,759  tflops: 52.84  mfu: 16.94%
[rank0]:2025-12-30 21:33:55,005 - Avg. fwd time: 16.1306 / Avg. bwd time: 41.8826 / Avg. batch time: 1186.0583 (ms) / GPU bubble ratio: 60.87%
[rank0]:2025-12-30 21:33:55,044 -  step: 50  loss: -4.0000  grad_norm: 23.9686  memory: 16.87GiB(35.50%)  tps: 6,760  tflops: 52.85  mfu: 16.94%
[rank2]:2025-12-30 21:33:55,027 -  step: 50  loss: -4.0000  grad_norm: 23.9686  memory:  8.66GiB(18.23%)  tps: 6,759  tflops: 52.84  mfu: 16.94%
[rank3]:2025-12-30 21:34:38,345 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-30 21:35:26,927 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-30 21:35:27,335 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-30 21:35:27,385 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-30 21:35:27,429 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-30 21:36:15,594 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-30 21:36:16,152 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-30 21:37:24,358 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-30 21:37:24,807 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 21:37:24,837 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 21:37:24,838 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank1]:2025-12-30 21:37:24,838 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 21:37:24,993 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2137_max_batch_time.svg
[rank3]:			> Batch Time: 1029.62 ms, GPU Bubble Ratio: 54.54%, 49.01%, 60.71%, 17.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  237-42-279ms   | [S0,MB4,F]  279-15-295ms   | [S0,MB1,B]  341-42-384ms   | [S0,MB5,F]  384-15-399ms   | [S0,MB2,B]  449-42-491ms   | [S0,MB6,F]  491-15-507ms   | [S0,MB3,B]  556-42-599ms   | [S0,MB7,F]  599-15-614ms   | [S0,MB4,B]  665-42-707ms   | [S0,MB5,B]  772-42-815ms   | [S0,MB6,B]  880-42-922ms   | [S0,MB7,B]  987-42-1029ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  191-46-237ms   | [S1,MB3,F]  237-19-257ms   | [S1,MB1,B]  296-45-341ms   | [S1,MB4,F]  341-20-361ms   | [S1,MB2,B]  403-45-449ms   | [S1,MB5,F]  449-20-469ms   | [S1,MB3,B]  510-46-556ms   | [S1,MB6,F]  556-20-576ms   | [S1,MB4,B]  619-46-665ms   | [S1,MB7,F]  665-20-685ms   | [S1,MB5,B]  726-45-772ms   | [S1,MB6,B]  834-45-880ms   | [S1,MB7,B]  941-45-987ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  155-35-191ms   | [S2,MB2,F]  191-14-205ms   | [S2,MB1,B]  260-35-296ms   | [S2,MB3,F]  296-15-311ms   | [S2,MB2,B]  367-35-403ms   | [S2,MB4,F]  403-15-418ms   | [S2,MB3,B]  475-35-510ms   | [S2,MB5,F]  510-15-525ms   | [S2,MB4,B]  583-35-619ms   | [S2,MB6,F]  619-15-634ms   | [S2,MB5,B]  691-35-726ms   | [S2,MB7,F]  726-14-741ms   | [S2,MB6,B]  799-35-834ms   | [S2,MB7,B]  906-35-941ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-78-155ms    AFR(10):0.9655 | [S3,MB1,F]  155-24-179ms   | [S3,MB1,B]  179-81-260ms   AFR(10):0.9655 | [S3,MB2,F]  260-24-285ms   | [S3,MB2,B]  285-82-367ms   AFR(10):0.9655 | [S3,MB3,F]  367-24-392ms   | [S3,MB3,B]  392-82-475ms   AFR(10):0.9655 | [S3,MB4,F]  475-25-500ms   | [S3,MB4,B]  500-83-583ms   AFR(10):0.9655 | [S3,MB5,F]  583-25-608ms   | [S3,MB5,B]  608-82-691ms   AFR(10):0.9655 | [S3,MB6,F]  691-25-716ms   | [S3,MB6,B]  716-82-799ms   AFR(10):0.9655 | [S3,MB7,F]  799-24-823ms   | [S3,MB7,B]  823-82-906ms   AFR(10):0.9655
[rank3]:2025-12-30 21:37:25,128 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2137_min_batch_time.svg
[rank3]:			> Batch Time: 646.11 ms, GPU Bubble Ratio: 79.90%, 47.28%, 59.37%, 14.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  159-0-159ms    | [S0,MB4,F]  159-15-174ms   | [S0,MB1,B]  227-0-227ms    | [S0,MB5,F]  227-15-243ms   | [S0,MB2,B]  296-0-296ms    | [S0,MB6,F]  296-15-312ms   | [S0,MB3,B]  366-0-366ms    | [S0,MB7,F]  366-15-382ms   | [S0,MB4,B]  436-0-436ms    | [S0,MB5,B]  506-0-506ms    | [S0,MB6,B]  576-0-576ms    | [S0,MB7,B]  646-0-646ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  136-22-159ms   | [S1,MB3,F]  159-19-179ms   | [S1,MB1,B]  204-22-227ms   | [S1,MB4,F]  227-20-247ms   | [S1,MB2,B]  273-22-296ms   | [S1,MB5,F]  296-20-316ms   | [S1,MB3,B]  343-23-366ms   | [S1,MB6,F]  366-20-386ms   | [S1,MB4,B]  413-22-436ms   | [S1,MB7,F]  436-20-456ms   | [S1,MB5,B]  483-23-506ms   | [S1,MB6,B]  554-22-576ms   | [S1,MB7,B]  623-22-646ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  118-17-136ms   | [S2,MB2,F]  136-14-151ms   | [S2,MB1,B]  186-17-204ms   | [S2,MB3,F]  204-15-219ms   | [S2,MB2,B]  255-17-273ms   | [S2,MB4,F]  273-15-288ms   | [S2,MB3,B]  325-17-343ms   | [S2,MB5,F]  343-15-358ms   | [S2,MB4,B]  395-17-413ms   | [S2,MB6,F]  413-15-428ms   | [S2,MB5,B]  465-17-483ms   | [S2,MB7,F]  483-14-498ms   | [S2,MB6,B]  536-17-554ms   | [S2,MB7,B]  605-17-623ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-42-118ms    AFR(10):0.9655 | [S3,MB1,F]  118-24-143ms   | [S3,MB1,B]  143-43-186ms   AFR(10):0.9655 | [S3,MB2,F]  186-24-211ms   | [S3,MB2,B]  211-44-255ms   AFR(10):0.9655 | [S3,MB3,F]  255-24-280ms   | [S3,MB3,B]  280-45-325ms   AFR(10):0.9655 | [S3,MB4,F]  325-25-350ms   | [S3,MB4,B]  350-45-395ms   AFR(10):0.9655 | [S3,MB5,F]  395-25-421ms   | [S3,MB5,B]  421-44-465ms   AFR(10):0.9655 | [S3,MB6,F]  465-25-491ms   | [S3,MB6,B]  491-45-536ms   AFR(10):0.9655 | [S3,MB7,F]  536-24-560ms   | [S3,MB7,B]  560-44-605ms   AFR(10):0.9655
[rank3]:2025-12-30 21:37:25,273 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2137_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 705.01 ms, GPU Bubble Ratio: 41.51%, 28.81%, 45.14%, 13.22%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  237-42-279ms   | [S0,MB4,F]  279-15-295ms   | [S0,MB1,B]  304-42-346ms   | [S0,MB5,F]  346-15-362ms   | [S0,MB2,B]  373-42-415ms   | [S0,MB6,F]  415-15-431ms   | [S0,MB3,B]  443-42-485ms   | [S0,MB7,F]  485-15-501ms   | [S0,MB4,B]  513-42-556ms   | [S0,MB5,B]  583-42-625ms   | [S0,MB6,B]  676-28-705ms   | [S0,MB7,B]  705-0-705ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  191-46-237ms   | [S1,MB3,F]  237-19-257ms   | [S1,MB1,B]  258-45-304ms   | [S1,MB4,F]  304-20-324ms   | [S1,MB2,B]  327-45-373ms   | [S1,MB5,F]  373-20-393ms   | [S1,MB3,B]  397-46-443ms   | [S1,MB6,F]  443-20-463ms   | [S1,MB4,B]  467-46-513ms   | [S1,MB7,F]  513-20-534ms   | [S1,MB5,B]  537-45-583ms   | [S1,MB6,B]  630-45-676ms   | [S1,MB7,B]  682-22-705ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  155-35-191ms   | [S2,MB2,F]  191-14-205ms   | [S2,MB1,B]  222-35-258ms   | [S2,MB3,F]  258-15-273ms   | [S2,MB2,B]  292-35-327ms   | [S2,MB4,F]  327-15-342ms   | [S2,MB3,B]  361-35-397ms   | [S2,MB5,F]  397-15-412ms   | [S2,MB4,B]  432-35-467ms   | [S2,MB6,F]  467-15-482ms   | [S2,MB5,B]  502-35-537ms   | [S2,MB7,F]  537-14-552ms   | [S2,MB6,B]  595-35-630ms   | [S2,MB7,B]  664-17-682ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-78-155ms    AFR(10):0.9655 | [S3,MB1,F]  155-24-179ms   | [S3,MB1,B]  179-43-222ms   AFR(10):0.9655 | [S3,MB2,F]  222-24-247ms   | [S3,MB2,B]  247-44-292ms   AFR(10):0.9655 | [S3,MB3,F]  292-24-316ms   | [S3,MB3,B]  316-45-361ms   AFR(10):0.9655 | [S3,MB4,F]  361-25-387ms   | [S3,MB4,B]  387-45-432ms   AFR(10):0.9655 | [S3,MB5,F]  432-25-457ms   | [S3,MB5,B]  457-44-502ms   AFR(10):0.9655 | [S3,MB6,F]  502-25-527ms   | [S3,MB6,B]  527-67-595ms   AFR(10):0.9655 | [S3,MB7,F]  595-24-619ms   | [S3,MB7,B]  619-44-664ms   AFR(10):0.9655
[rank3]:2025-12-30 21:37:25,274 - 	> Batch Time: 705.01 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank3]:2025-12-30 21:37:25,277 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 1.00/1.00
[rank3]:2025-12-30 21:37:28,719 - Avg. fwd time: 24.8118 / Avg. bwd time: 74.0380 / Avg. batch time: 936.0931 (ms) / GPU bubble ratio: 15.52%
[rank2]:2025-12-30 21:37:28,746 - Avg. fwd time: 14.8180 / Avg. bwd time: 31.8240 / Avg. batch time: 991.2565 (ms) / GPU bubble ratio: 62.36%
[rank0]:2025-12-30 21:37:28,781 - Avg. fwd time: 15.9970 / Avg. bwd time: 33.5062 / Avg. batch time: 1115.7849 (ms) / GPU bubble ratio: 64.51%
[rank0]:2025-12-30 21:37:28,817 -  step: 100  loss: -4.0000  grad_norm:  8.0034  memory: 16.87GiB(35.50%)  tps: 7,664  tflops: 59.92  mfu: 19.20%
[rank3]:2025-12-30 21:37:28,815 -  step: 100  loss:  8.9074  grad_norm:  8.0034  memory: 25.79GiB(54.28%)  tps: 7,664  tflops: 59.92  mfu: 19.20%
[rank1]:2025-12-30 21:37:28,775 - Avg. fwd time: 19.5629 / Avg. bwd time: 41.1346 / Avg. batch time: 1059.0322 (ms) / GPU bubble ratio: 54.15%
[rank1]:2025-12-30 21:37:28,808 -  step: 100  loss: -4.0000  grad_norm:  8.0034  memory: 12.86GiB(27.07%)  tps: 7,664  tflops: 59.91  mfu: 19.20%
[rank2]:2025-12-30 21:37:28,802 -  step: 100  loss: -4.0000  grad_norm:  8.0034  memory:  8.66GiB(18.23%)  tps: 7,664  tflops: 59.91  mfu: 19.20%
[rank0]:2025-12-30 21:37:28,875 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2137_stage0_step100.svg
[rank1]:2025-12-30 21:37:28,875 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2137_stage1_step100.svg
[rank2]:2025-12-30 21:37:28,874 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2137_stage2_step100.svg
[rank3]:2025-12-30 21:37:28,953 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2137_step100_rank3.svg
[rank3]:			> Batch Time: 862.50 ms, GPU Bubble Ratio: 85.79%, 61.39%, 70.18%, 29.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-15-64ms     | [S0,MB0,B]  199-0-199ms    | [S0,MB4,F]  199-14-214ms   | [S0,MB1,B]  285-0-285ms    | [S0,MB5,F]  285-14-299ms   | [S0,MB2,B]  374-0-374ms    | [S0,MB6,F]  374-14-388ms   | [S0,MB3,B]  462-0-462ms    | [S0,MB7,F]  462-14-477ms   | [S0,MB4,B]  569-0-569ms    | [S0,MB5,B]  657-0-657ms    | [S0,MB6,B]  759-0-759ms    | [S0,MB7,B]  862-0-862ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  42-18-61ms     | [S1,MB2,F]  67-18-85ms     | [S1,MB0,B]  169-22-191ms   | [S1,MB3,F]  196-18-215ms   | [S1,MB1,B]  254-22-277ms   | [S1,MB4,F]  281-19-300ms   | [S1,MB2,B]  343-22-366ms   | [S1,MB5,F]  370-18-389ms   | [S1,MB3,B]  431-23-455ms   | [S1,MB6,F]  459-18-478ms   | [S1,MB4,B]  538-22-561ms   | [S1,MB7,F]  565-18-584ms   | [S1,MB5,B]  628-23-651ms   | [S1,MB6,B]  730-22-753ms   | [S1,MB7,B]  833-22-856ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  140-17-158ms   | [S2,MB2,F]  165-14-180ms   | [S2,MB1,B]  225-17-243ms   | [S2,MB3,F]  250-14-265ms   | [S2,MB2,B]  314-17-332ms   | [S2,MB4,F]  339-14-354ms   | [S2,MB3,B]  403-17-421ms   | [S2,MB5,F]  428-14-443ms   | [S2,MB4,B]  510-17-528ms   | [S2,MB6,F]  535-14-549ms   | [S2,MB5,B]  600-17-618ms   | [S2,MB7,F]  624-14-638ms   | [S2,MB6,B]  706-17-724ms   | [S2,MB7,B]  809-17-827ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-42-130ms    | [S3,MB1,F]  137-23-161ms   | [S3,MB1,B]  172-42-215ms   | [S3,MB2,F]  222-25-248ms   | [S3,MB2,B]  260-43-304ms   | [S3,MB3,F]  311-25-337ms   | [S3,MB3,B]  349-44-394ms   | [S3,MB4,F]  400-26-426ms   | [S3,MB4,B]  438-62-501ms   | [S3,MB5,F]  507-26-533ms   | [S3,MB5,B]  545-44-590ms   | [S3,MB6,F]  596-25-622ms   | [S3,MB6,B]  634-63-697ms   | [S3,MB7,F]  703-26-730ms   | [S3,MB7,B]  740-63-803ms  
[rank3]:2025-12-30 21:37:28,995 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2137_stage3_step100.svg
[rank1]:2025-12-30 21:37:29,022 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2137_rank1_stage1.svg
[rank1]:	> Counts Sum: 28800, Total Sum: 28800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-30 21:37:29,030 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2137_rank2_stage2.svg
[rank2]:	> Counts Sum: 23040, Total Sum: 23040 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-30 21:37:29,029 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2137_rank0_stage0.svg
[rank0]:	> Counts Sum: 23680, Total Sum: 23680 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-30 21:37:29,066 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2137_stage0.svg
[rank1]:2025-12-30 21:37:29,059 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2137_stage1.svg
[rank2]:2025-12-30 21:37:29,067 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2137_stage2.svg
[rank3]:2025-12-30 21:37:29,128 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2137_rank3_stage3.svg
[rank3]:	> Counts Sum: 17920, Total Sum: 18560 (96.55%), Ratio(%) per element: [100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 93.75, 100.0, 100.0, 93.75, 100.0, 93.75, 93.75, 100.0, 93.75, 93.75, 87.5, 100.0, 100.0, 100.0, 93.75, 93.75, 81.25]
[rank3]:2025-12-30 21:37:29,167 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2137_stage3.svg
[rank3]:2025-12-30 21:41:00,683 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.27/0.40, [MB7] 0.67/1.00
[rank0]:2025-12-30 21:41:00,664 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 21:41:00,687 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.22/0.32, [MB7] 0.67/1.00
[rank1]:2025-12-30 21:41:00,675 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-12-30 21:41:00,671 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-12-30 21:41:04,585 - Avg. fwd time: 24.9556 / Avg. bwd time: 72.1110 / Avg. batch time: 922.2783 (ms) / GPU bubble ratio: 15.80%
[rank2]:2025-12-30 21:41:04,616 - Avg. fwd time: 14.8426 / Avg. bwd time: 32.7072 / Avg. batch time: 975.2901 (ms) / GPU bubble ratio: 61.00%
[rank0]:2025-12-30 21:41:04,673 - Avg. fwd time: 16.0362 / Avg. bwd time: 35.4516 / Avg. batch time: 1094.4495 (ms) / GPU bubble ratio: 62.36%
[rank0]:2025-12-30 21:41:04,709 -  step: 150  loss: -4.0000  grad_norm:  8.6808  memory: 16.87GiB(35.50%)  tps: 7,589  tflops: 59.33  mfu: 19.02%
[rank3]:2025-12-30 21:41:04,707 -  step: 150  loss:  4.3383  grad_norm:  8.6808  memory: 25.79GiB(54.28%)  tps: 7,589  tflops: 59.33  mfu: 19.02%
[rank1]:2025-12-30 21:41:04,651 - Avg. fwd time: 19.7404 / Avg. bwd time: 42.4425 / Avg. batch time: 1040.4006 (ms) / GPU bubble ratio: 52.19%
[rank1]:2025-12-30 21:41:04,698 -  step: 150  loss: -4.0000  grad_norm:  8.6808  memory: 12.86GiB(27.07%)  tps: 7,589  tflops: 59.33  mfu: 19.02%
[rank2]:2025-12-30 21:41:04,695 -  step: 150  loss: -4.0000  grad_norm:  8.6808  memory:  8.66GiB(18.23%)  tps: 7,589  tflops: 59.33  mfu: 19.02%
[rank0]:2025-12-30 21:44:16,247 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-30 21:44:16,269 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-30 21:44:16,263 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 21:44:16,280 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank3]:2025-12-30 21:44:16,279 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 1.00/1.00
[rank3]:2025-12-30 21:44:19,864 - Avg. fwd time: 25.0261 / Avg. bwd time: 68.4177 / Avg. batch time: 894.1282 (ms) / GPU bubble ratio: 16.39%
[rank0]:2025-12-30 21:44:19,928 - Avg. fwd time: 16.0995 / Avg. bwd time: 36.2440 / Avg. batch time: 1058.1545 (ms) / GPU bubble ratio: 60.43%
[rank3]:2025-12-30 21:44:19,963 -  step: 200  loss:  1.6052  grad_norm:  5.7235  memory: 25.79GiB(54.28%)  tps: 8,391  tflops: 65.60  mfu: 21.03%
[rank1]:2025-12-30 21:44:19,921 - Avg. fwd time: 19.8332 / Avg. bwd time: 43.0868 / Avg. batch time: 1007.3762 (ms) / GPU bubble ratio: 50.03%
[rank1]:2025-12-30 21:44:19,954 -  step: 200  loss: -4.0000  grad_norm:  5.7235  memory: 12.86GiB(27.07%)  tps: 8,391  tflops: 65.60  mfu: 21.02%
[rank2]:2025-12-30 21:44:19,891 - Avg. fwd time: 14.9036 / Avg. bwd time: 33.0535 / Avg. batch time: 944.8876 (ms) / GPU bubble ratio: 59.40%
[rank2]:2025-12-30 21:44:19,950 -  step: 200  loss: -4.0000  grad_norm:  5.7235  memory:  8.66GiB(18.23%)  tps: 8,391  tflops: 65.60  mfu: 21.02%
[rank0]:2025-12-30 21:44:19,965 -  step: 200  loss: -4.0000  grad_norm:  5.7235  memory: 16.87GiB(35.50%)  tps: 8,391  tflops: 65.60  mfu: 21.02%
[rank0]:2025-12-30 21:44:20,014 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2144_stage0_step200.svg
[rank1]:2025-12-30 21:44:20,015 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2144_stage1_step200.svg
[rank2]:2025-12-30 21:44:20,015 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2144_stage2_step200.svg
[rank3]:2025-12-30 21:44:20,110 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2144_step200_rank3.svg
[rank3]:			> Batch Time: 916.93 ms, GPU Bubble Ratio: 52.74%, 42.55%, 57.13%, 29.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  272-42-315ms   | [S0,MB4,F]  315-15-331ms   | [S0,MB1,B]  365-42-407ms   | [S0,MB5,F]  408-16-424ms   | [S0,MB2,B]  454-42-497ms   | [S0,MB6,F]  497-16-514ms   | [S0,MB3,B]  546-42-589ms   | [S0,MB7,F]  589-16-606ms   | [S0,MB4,B]  653-42-695ms   | [S0,MB5,B]  745-42-787ms   | [S0,MB6,B]  857-35-892ms   | [S0,MB7,B]  906-10-916ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  218-46-264ms   | [S1,MB3,F]  269-20-289ms   | [S1,MB1,B]  310-47-357ms   | [S1,MB4,F]  362-21-383ms   | [S1,MB2,B]  397-49-446ms   | [S1,MB5,F]  451-22-473ms   | [S1,MB3,B]  487-51-538ms   | [S1,MB6,F]  543-22-565ms   | [S1,MB4,B]  596-46-643ms   | [S1,MB7,F]  649-20-670ms   | [S1,MB5,B]  689-49-739ms   | [S1,MB6,B]  804-46-851ms   | [S1,MB7,B]  874-25-900ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  171-36-208ms   | [S2,MB2,F]  214-14-229ms   | [S2,MB1,B]  263-36-299ms   | [S2,MB3,F]  307-15-322ms   | [S2,MB2,B]  350-36-386ms   | [S2,MB4,F]  393-15-409ms   | [S2,MB3,B]  440-36-476ms   | [S2,MB5,F]  484-15-499ms   | [S2,MB4,B]  550-36-586ms   | [S2,MB6,F]  593-15-608ms   | [S2,MB5,B]  643-36-679ms   | [S2,MB7,F]  687-15-702ms   | [S2,MB6,B]  762-35-798ms   | [S2,MB7,B]  850-18-868ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-73-161ms    | [S3,MB1,F]  168-23-192ms   | [S3,MB1,B]  205-44-250ms   | [S3,MB2,F]  260-25-286ms   | [S3,MB2,B]  295-44-339ms   | [S3,MB3,F]  346-26-373ms   | [S3,MB3,B]  384-45-430ms   | [S3,MB4,F]  437-26-463ms   | [S3,MB4,B]  475-64-540ms   | [S3,MB5,F]  547-26-573ms   | [S3,MB5,B]  585-47-632ms   | [S3,MB6,F]  640-25-665ms   | [S3,MB6,B]  677-75-753ms   | [S3,MB7,F]  759-26-785ms   | [S3,MB7,B]  797-45-843ms  
[rank3]:2025-12-30 21:44:20,153 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2144_stage3_step200.svg
[rank1]:2025-12-30 21:44:20,159 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2144_rank1_stage1.svg
[rank1]:	> Counts Sum: 41400, Total Sum: 172800 (23.96%), Ratio(%) per element: [26.04, 26.04, 23.95, 26.04, 25.0, 27.08, 25.0, 26.04, 25.0, 27.08, 27.08, 26.04, 26.04, 26.04, 25.0, 26.04, 26.04, 27.08, 23.95, 22.91, 25.0, 23.95, 22.91, 22.91, 22.91, 27.08, 22.91, 21.87, 22.91, 20.83, 21.87, 22.91, 21.87, 21.87, 20.83, 22.91, 20.83, 25.0, 22.91, 19.79, 20.83, 22.91, 21.87, 20.83, 23.95]
[rank2]:2025-12-30 21:44:20,166 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2144_rank2_stage2.svg
[rank2]:	> Counts Sum: 33120, Total Sum: 138240 (23.96%), Ratio(%) per element: [27.08, 23.95, 25.0, 21.87, 23.95, 23.95, 25.0, 25.0, 26.04, 25.0, 25.0, 25.0, 26.04, 25.0, 23.95, 22.91, 25.0, 22.91, 25.0, 25.0, 25.0, 23.95, 23.95, 22.91, 23.95, 25.0, 25.0, 20.83, 22.91, 23.95, 22.91, 22.91, 21.87, 21.87, 20.83, 21.87]
[rank0]:2025-12-30 21:44:20,167 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2144_rank0_stage0.svg
[rank0]:	> Counts Sum: 37440, Total Sum: 142080 (26.35%), Ratio(%) per element: [23.95, 33.33, 28.12, 30.2, 28.12, 31.25, 29.16, 30.2, 32.29, 29.16, 28.12, 27.08, 28.12, 30.2, 29.16, 26.04, 28.12, 29.16, 25.0, 25.0, 22.91, 21.87, 26.04, 25.0, 23.95, 22.91, 23.95, 25.0, 21.87, 25.0, 22.91, 22.91, 19.79, 23.95, 21.87, 26.04, 27.08]
[rank0]:2025-12-30 21:44:20,332 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2144_stage0.svg
[rank3]:2025-12-30 21:44:20,285 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2144_rank3_stage3.svg
[rank3]:	> Counts Sum: 69680, Total Sum: 111360 (62.57%), Ratio(%) per element: [70.83, 68.75, 72.91, 64.58, 72.91, 68.75, 71.87, 69.79, 69.79, 71.87, 67.7, 76.04, 66.66, 70.83, 69.79, 67.7, 72.91, 73.95, 44.79, 48.95, 50.0, 50.0, 54.16, 50.0, 50.0, 51.04, 51.04, 48.95, 47.91]
[rank1]:2025-12-30 21:44:20,322 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2144_stage1.svg
[rank2]:2025-12-30 21:44:20,333 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2144_stage2.svg
[rank3]:2025-12-30 21:44:20,451 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2144_stage3.svg
[rank2]:2025-12-30 21:47:16,633 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 21:47:16,626 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 21:47:16,648 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank3]:2025-12-30 21:47:16,646 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 1.00/1.00
[rank1]:2025-12-30 21:47:16,637 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 21:47:20,185 - Avg. fwd time: 25.0700 / Avg. bwd time: 64.9850 / Avg. batch time: 866.9322 (ms) / GPU bubble ratio: 16.90%
[rank2]:2025-12-30 21:47:20,212 - Avg. fwd time: 14.9596 / Avg. bwd time: 33.2520 / Avg. batch time: 915.7157 (ms) / GPU bubble ratio: 57.88%
[rank2]:2025-12-30 21:47:20,271 -  step: 250  loss: -4.0000  grad_norm:  3.1538  memory:  8.66GiB(18.23%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank0]:2025-12-30 21:47:20,249 - Avg. fwd time: 16.1627 / Avg. bwd time: 36.2479 / Avg. batch time: 1021.1498 (ms) / GPU bubble ratio: 58.94%
[rank0]:2025-12-30 21:47:20,286 -  step: 250  loss: -4.0000  grad_norm:  3.1538  memory: 16.87GiB(35.50%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank3]:2025-12-30 21:47:20,284 -  step: 250  loss:  0.5432  grad_norm:  3.1538  memory: 25.79GiB(54.28%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank1]:2025-12-30 21:47:20,243 - Avg. fwd time: 20.0084 / Avg. bwd time: 43.7383 / Avg. batch time: 975.8423 (ms) / GPU bubble ratio: 47.74%
[rank1]:2025-12-30 21:47:20,275 -  step: 250  loss: -4.0000  grad_norm:  3.1538  memory: 12.86GiB(27.07%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank3]:2025-12-30 21:50:17,908 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 1.00/1.00
[rank0]:2025-12-30 21:50:17,878 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 21:50:17,911 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank2]:2025-12-30 21:50:17,895 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-30 21:50:17,901 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 21:50:21,460 - Avg. fwd time: 25.1226 / Avg. bwd time: 62.8108 / Avg. batch time: 849.8545 (ms) / GPU bubble ratio: 17.22%
[rank0]:2025-12-30 21:50:21,527 - Avg. fwd time: 16.2015 / Avg. bwd time: 36.2251 / Avg. batch time: 997.5141 (ms) / GPU bubble ratio: 57.95%
[rank2]:2025-12-30 21:50:21,489 - Avg. fwd time: 15.0026 / Avg. bwd time: 33.4022 / Avg. batch time: 897.2842 (ms) / GPU bubble ratio: 56.84%
[rank1]:2025-12-30 21:50:21,520 - Avg. fwd time: 20.1327 / Avg. bwd time: 44.2038 / Avg. batch time: 955.8580 (ms) / GPU bubble ratio: 46.15%
[rank1]:2025-12-30 21:50:21,554 -  step: 300  loss: -4.0000  grad_norm:  0.5471  memory: 12.86GiB(27.07%)  tps: 9,038  tflops: 70.65  mfu: 22.65%
[rank3]:2025-12-30 21:50:21,563 -  step: 300  loss:  0.3142  grad_norm:  0.5471  memory: 25.79GiB(54.28%)  tps: 9,038  tflops: 70.66  mfu: 22.65%
[rank0]:2025-12-30 21:50:21,564 -  step: 300  loss: -4.0000  grad_norm:  0.5471  memory: 16.87GiB(35.50%)  tps: 9,038  tflops: 70.66  mfu: 22.65%
[rank0]:2025-12-30 21:50:21,613 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2150_stage0_step300.svg
[rank2]:2025-12-30 21:50:21,549 -  step: 300  loss: -4.0000  grad_norm:  0.5471  memory:  8.66GiB(18.23%)  tps: 9,038  tflops: 70.66  mfu: 22.65%
[rank2]:2025-12-30 21:50:21,617 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2150_stage2_step300.svg
[rank1]:2025-12-30 21:50:21,613 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2150_stage1_step300.svg
[rank3]:2025-12-30 21:50:21,748 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2150_step300_rank3.svg
[rank3]:			> Batch Time: 880.00 ms, GPU Bubble Ratio: 52.85%, 38.42%, 54.96%, 29.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  277-43-320ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  367-42-410ms   | [S0,MB5,F]  410-16-426ms   | [S0,MB2,B]  457-42-500ms   | [S0,MB6,F]  500-16-516ms   | [S0,MB3,B]  548-42-591ms   | [S0,MB7,F]  591-16-607ms   | [S0,MB4,B]  637-42-680ms   | [S0,MB5,B]  725-42-767ms   | [S0,MB6,B]  836-27-863ms   | [S0,MB7,B]  880-0-880ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  222-46-268ms   | [S1,MB3,F]  273-19-293ms   | [S1,MB1,B]  310-48-359ms   | [S1,MB4,F]  363-22-386ms   | [S1,MB2,B]  399-50-449ms   | [S1,MB5,F]  454-22-476ms   | [S1,MB3,B]  487-52-540ms   | [S1,MB6,F]  545-23-568ms   | [S1,MB4,B]  576-52-629ms   | [S1,MB7,F]  634-22-656ms   | [S1,MB5,B]  665-53-718ms   | [S1,MB6,B]  783-46-829ms   | [S1,MB7,B]  849-23-873ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  175-36-212ms   | [S2,MB2,F]  219-14-234ms   | [S2,MB1,B]  263-36-300ms   | [S2,MB3,F]  307-15-323ms   | [S2,MB2,B]  352-36-388ms   | [S2,MB4,F]  396-15-411ms   | [S2,MB3,B]  441-36-477ms   | [S2,MB5,F]  484-15-500ms   | [S2,MB4,B]  529-36-566ms   | [S2,MB6,F]  573-15-588ms   | [S2,MB5,B]  617-36-654ms   | [S2,MB7,F]  661-15-677ms   | [S2,MB6,B]  740-36-776ms   | [S2,MB7,B]  824-18-842ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-165ms    | [S3,MB1,F]  172-24-197ms   | [S3,MB1,B]  208-43-252ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  297-44-342ms   | [S3,MB3,F]  349-26-375ms   | [S3,MB3,B]  387-43-430ms   | [S3,MB4,F]  438-26-464ms   | [S3,MB4,B]  475-44-519ms   | [S3,MB5,F]  526-26-552ms   | [S3,MB5,B]  564-43-607ms   | [S3,MB6,F]  614-26-640ms   | [S3,MB6,B]  653-76-729ms   | [S3,MB7,F]  737-25-762ms   | [S3,MB7,B]  774-43-817ms  
[rank3]:2025-12-30 21:50:21,791 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2150_stage3_step300.svg
[rank0]:2025-12-30 21:50:21,764 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2150_rank0_stage0.svg
[rank0]:	> Counts Sum: 57040, Total Sum: 260480 (21.90%), Ratio(%) per element: [19.88, 26.7, 23.86, 23.86, 22.15, 25.56, 23.86, 25.56, 26.13, 25.0, 24.43, 23.29, 23.29, 26.13, 24.43, 21.59, 23.29, 22.72, 21.59, 21.02, 18.75, 18.75, 20.45, 21.02, 20.45, 18.18, 19.88, 21.02, 18.75, 21.02, 19.31, 18.75, 17.61, 20.45, 18.75, 21.02, 21.59]
[rank2]:2025-12-30 21:50:21,774 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2150_rank2_stage2.svg
[rank2]:	> Counts Sum: 47520, Total Sum: 253440 (18.75%), Ratio(%) per element: [20.45, 18.75, 19.31, 17.61, 18.75, 18.75, 19.31, 19.31, 19.88, 19.31, 19.31, 19.31, 19.88, 19.31, 18.75, 18.18, 19.31, 18.18, 19.31, 19.31, 19.31, 18.75, 18.75, 18.18, 18.75, 19.31, 19.31, 17.04, 18.18, 18.75, 18.18, 18.18, 17.61, 17.61, 17.04, 17.61]
[rank1]:2025-12-30 21:50:21,758 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2150_rank1_stage1.svg
[rank1]:	> Counts Sum: 59400, Total Sum: 316800 (18.75%), Ratio(%) per element: [19.88, 19.88, 18.75, 19.88, 19.31, 20.45, 19.31, 19.88, 19.31, 20.45, 20.45, 19.88, 19.88, 19.88, 19.31, 19.88, 19.88, 20.45, 18.75, 18.18, 19.31, 18.75, 18.18, 18.18, 18.18, 20.45, 18.18, 17.61, 18.18, 17.04, 17.61, 18.18, 17.61, 17.61, 17.04, 18.18, 17.04, 19.31, 18.18, 16.47, 17.04, 18.18, 17.61, 17.04, 18.75]
[rank3]:2025-12-30 21:50:21,924 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2150_rank3_stage3.svg
[rank3]:	> Counts Sum: 144080, Total Sum: 204160 (70.57%), Ratio(%) per element: [77.27, 76.13, 78.4, 73.86, 76.7, 75.0, 77.84, 76.7, 76.7, 75.56, 72.15, 76.7, 72.15, 74.43, 74.43, 72.72, 76.7, 76.7, 59.65, 61.93, 63.63, 62.5, 64.2, 62.5, 63.06, 62.5, 62.5, 63.06, 60.79]
[rank1]:2025-12-30 21:50:22,045 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2150_stage1.svg
[rank0]:2025-12-30 21:50:22,049 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2150_stage0.svg
[rank2]:2025-12-30 21:50:22,069 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2150_stage2.svg
[rank3]:2025-12-30 21:50:22,219 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2150_stage3.svg
[rank0]:2025-12-30 21:53:18,458 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 21:53:22,018 - Avg. fwd time: 25.1482 / Avg. bwd time: 61.1586 / Avg. batch time: 836.7798 (ms) / GPU bubble ratio: 17.49%
[rank2]:2025-12-30 21:53:22,046 - Avg. fwd time: 15.0319 / Avg. bwd time: 33.5070 / Avg. batch time: 883.3238 (ms) / GPU bubble ratio: 56.04%
[rank1]:2025-12-30 21:53:22,077 - Avg. fwd time: 20.2195 / Avg. bwd time: 44.5313 / Avg. batch time: 940.7808 (ms) / GPU bubble ratio: 44.94%
[rank3]:2025-12-30 21:53:22,120 -  step: 350  loss:  0.2432  grad_norm:  0.7227  memory: 25.79GiB(54.28%)  tps: 9,074  tflops: 70.94  mfu: 22.74%
[rank0]:2025-12-30 21:53:22,085 - Avg. fwd time: 16.2321 / Avg. bwd time: 36.2384 / Avg. batch time: 979.8284 (ms) / GPU bubble ratio: 57.16%
[rank0]:2025-12-30 21:53:22,121 -  step: 350  loss: -4.0000  grad_norm:  0.7227  memory: 16.87GiB(35.50%)  tps: 9,074  tflops: 70.94  mfu: 22.74%
[rank2]:2025-12-30 21:53:22,107 -  step: 350  loss: -4.0000  grad_norm:  0.7227  memory:  8.66GiB(18.23%)  tps: 9,074  tflops: 70.94  mfu: 22.74%
[rank1]:2025-12-30 21:53:22,110 -  step: 350  loss: -4.0000  grad_norm:  0.7227  memory: 12.86GiB(27.07%)  tps: 9,074  tflops: 70.94  mfu: 22.74%
[rank0]:2025-12-30 21:56:18,692 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 21:56:22,227 - Avg. fwd time: 25.1695 / Avg. bwd time: 59.9272 / Avg. batch time: 827.0684 (ms) / GPU bubble ratio: 17.69%
[rank2]:2025-12-30 21:56:22,254 - Avg. fwd time: 15.0475 / Avg. bwd time: 33.5802 / Avg. batch time: 872.8772 (ms) / GPU bubble ratio: 55.43%
[rank0]:2025-12-30 21:56:22,294 - Avg. fwd time: 16.2516 / Avg. bwd time: 36.2179 / Avg. batch time: 966.5917 (ms) / GPU bubble ratio: 56.57%
[rank1]:2025-12-30 21:56:22,285 - Avg. fwd time: 20.2740 / Avg. bwd time: 44.7509 / Avg. batch time: 929.4982 (ms) / GPU bubble ratio: 44.03%
[rank1]:2025-12-30 21:56:22,319 -  step: 400  loss: -4.0000  grad_norm:  0.8152  memory: 12.86GiB(27.07%)  tps: 9,092  tflops: 71.07  mfu: 22.78%
[rank3]:2025-12-30 21:56:22,328 -  step: 400  loss:  0.2227  grad_norm:  0.8152  memory: 25.79GiB(54.28%)  tps: 9,092  tflops: 71.08  mfu: 22.78%
[rank2]:2025-12-30 21:56:22,315 -  step: 400  loss: -4.0000  grad_norm:  0.8152  memory:  8.66GiB(18.23%)  tps: 9,092  tflops: 71.07  mfu: 22.78%
[rank2]:2025-12-30 21:56:22,382 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2156_stage2_step400.svg
[rank0]:2025-12-30 21:56:22,330 -  step: 400  loss: -4.0000  grad_norm:  0.8152  memory: 16.87GiB(35.50%)  tps: 9,092  tflops: 71.07  mfu: 22.78%
[rank0]:2025-12-30 21:56:22,381 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2156_stage0_step400.svg
[rank1]:2025-12-30 21:56:22,382 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2156_stage1_step400.svg
[rank3]:2025-12-30 21:56:22,472 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2156_step400_rank3.svg
[rank3]:			> Batch Time: 880.50 ms, GPU Bubble Ratio: 51.99%, 39.14%, 55.18%, 29.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  278-42-320ms   | [S0,MB4,F]  321-15-336ms   | [S0,MB1,B]  367-42-409ms   | [S0,MB5,F]  409-16-425ms   | [S0,MB2,B]  456-42-499ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  547-42-590ms   | [S0,MB7,F]  590-16-606ms   | [S0,MB4,B]  637-42-679ms   | [S0,MB5,B]  725-42-767ms   | [S0,MB6,B]  836-35-871ms   | [S0,MB7,B]  880-0-880ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  223-46-269ms   | [S1,MB3,F]  274-19-294ms   | [S1,MB1,B]  310-48-359ms   | [S1,MB4,F]  363-22-385ms   | [S1,MB2,B]  398-49-448ms   | [S1,MB5,F]  453-22-475ms   | [S1,MB3,B]  488-51-539ms   | [S1,MB6,F]  543-22-566ms   | [S1,MB4,B]  577-51-628ms   | [S1,MB7,F]  633-22-656ms   | [S1,MB5,B]  666-52-718ms   | [S1,MB6,B]  783-46-829ms   | [S1,MB7,B]  850-23-874ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-213ms   | [S2,MB2,F]  220-14-235ms   | [S2,MB1,B]  263-36-300ms   | [S2,MB3,F]  307-15-322ms   | [S2,MB2,B]  351-36-388ms   | [S2,MB4,F]  395-15-410ms   | [S2,MB3,B]  440-36-477ms   | [S2,MB5,F]  484-15-500ms   | [S2,MB4,B]  530-36-566ms   | [S2,MB6,F]  574-15-589ms   | [S2,MB5,B]  620-36-656ms   | [S2,MB7,F]  663-15-679ms   | [S2,MB6,B]  741-36-777ms   | [S2,MB7,B]  825-18-843ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  209-43-253ms   | [S3,MB2,F]  260-25-286ms   | [S3,MB2,B]  297-43-341ms   | [S3,MB3,F]  348-26-374ms   | [S3,MB3,B]  386-44-430ms   | [S3,MB4,F]  438-25-463ms   | [S3,MB4,B]  476-44-520ms   | [S3,MB5,F]  527-26-553ms   | [S3,MB5,B]  565-44-610ms   | [S3,MB6,F]  617-25-643ms   | [S3,MB6,B]  655-76-732ms   | [S3,MB7,F]  738-25-763ms   | [S3,MB7,B]  775-43-819ms  
[rank1]:2025-12-30 21:56:22,526 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2156_rank1_stage1.svg
[rank1]:	> Counts Sum: 77400, Total Sum: 460800 (16.80%), Ratio(%) per element: [17.57, 17.57, 16.79, 17.57, 17.18, 17.96, 17.18, 17.57, 17.18, 17.96, 17.96, 17.57, 17.57, 17.57, 17.18, 17.57, 17.57, 17.96, 16.79, 16.4, 17.18, 16.79, 16.4, 16.4, 16.4, 17.96, 16.4, 16.01, 16.4, 15.62, 16.01, 16.4, 16.01, 16.01, 15.62, 16.4, 15.62, 17.18, 16.4, 15.23, 15.62, 16.4, 16.01, 15.62, 16.79]
[rank3]:2025-12-30 21:56:22,519 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2156_stage3_step400.svg
[rank2]:2025-12-30 21:56:22,538 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2156_rank2_stage2.svg
[rank2]:	> Counts Sum: 61920, Total Sum: 368640 (16.80%), Ratio(%) per element: [17.96, 16.79, 17.18, 16.01, 16.79, 16.79, 17.18, 17.18, 17.57, 17.18, 17.18, 17.18, 17.57, 17.18, 16.79, 16.4, 17.18, 16.4, 17.18, 17.18, 17.18, 16.79, 16.79, 16.4, 16.79, 17.18, 17.18, 15.62, 16.4, 16.79, 16.4, 16.4, 16.01, 16.01, 15.62, 16.01]
[rank0]:2025-12-30 21:56:22,531 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2156_rank0_stage0.svg
[rank0]:	> Counts Sum: 76640, Total Sum: 378880 (20.23%), Ratio(%) per element: [17.96, 24.6, 22.65, 22.65, 22.65, 23.82, 23.04, 23.82, 23.43, 24.21, 21.48, 20.7, 20.31, 23.04, 21.87, 20.31, 21.48, 20.31, 19.14, 20.31, 17.57, 17.18, 18.75, 19.53, 19.14, 17.57, 19.14, 18.75, 17.18, 18.75, 17.57, 17.57, 16.79, 19.53, 16.79, 19.14, 19.53]
[rank3]:2025-12-30 21:56:22,652 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2156_rank3_stage3.svg
[rank3]:	> Counts Sum: 218480, Total Sum: 296960 (73.57%), Ratio(%) per element: [78.12, 78.51, 79.68, 77.34, 78.9, 77.34, 78.9, 79.68, 77.73, 77.34, 74.6, 78.51, 75.0, 77.34, 75.0, 75.39, 78.9, 78.51, 65.62, 66.4, 68.35, 66.4, 67.96, 67.18, 67.57, 66.79, 66.79, 67.57, 66.01]
[rank2]:2025-12-30 21:56:22,963 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2156_stage2.svg
[rank0]:2025-12-30 21:56:22,950 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2156_stage0.svg
[rank1]:2025-12-30 21:56:22,937 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2156_stage1.svg
[rank3]:2025-12-30 21:56:23,078 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2156_stage3.svg
[rank3]:2025-12-30 21:56:42,891 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 21:56:43,269 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 21:56:43,299 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 21:56:43,297 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 21:59:18,257 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-30 21:59:21,842 - Avg. fwd time: 15.0630 / Avg. bwd time: 33.6452 / Avg. batch time: 864.1262 (ms) / GPU bubble ratio: 54.91%
[rank3]:2025-12-30 21:59:21,813 - Avg. fwd time: 25.1952 / Avg. bwd time: 58.8723 / Avg. batch time: 818.8507 (ms) / GPU bubble ratio: 17.87%
[rank0]:2025-12-30 21:59:21,883 - Avg. fwd time: 16.2712 / Avg. bwd time: 36.2064 / Avg. batch time: 955.6971 (ms) / GPU bubble ratio: 56.07%
[rank0]:2025-12-30 21:59:21,919 -  step: 450  loss: -4.0000  grad_norm:  0.2451  memory: 16.87GiB(35.50%)  tps: 9,123  tflops: 71.32  mfu: 22.86%
[rank2]:2025-12-30 21:59:21,905 -  step: 450  loss: -4.0000  grad_norm:  0.2451  memory:  8.66GiB(18.23%)  tps: 9,123  tflops: 71.32  mfu: 22.86%
[rank1]:2025-12-30 21:59:21,874 - Avg. fwd time: 20.3238 / Avg. bwd time: 44.9438 / Avg. batch time: 920.1183 (ms) / GPU bubble ratio: 43.25%
[rank1]:2025-12-30 21:59:21,908 -  step: 450  loss: -4.0000  grad_norm:  0.2451  memory: 12.86GiB(27.07%)  tps: 9,123  tflops: 71.32  mfu: 22.86%
[rank3]:2025-12-30 21:59:21,917 -  step: 450  loss:  0.2303  grad_norm:  0.2451  memory: 25.79GiB(54.28%)  tps: 9,123  tflops: 71.32  mfu: 22.86%
[rank0]:2025-12-30 22:02:18,607 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 22:02:22,161 - Avg. fwd time: 15.0761 / Avg. bwd time: 33.6910 / Avg. batch time: 857.7381 (ms) / GPU bubble ratio: 54.52%
[rank1]:2025-12-30 22:02:22,193 - Avg. fwd time: 20.3692 / Avg. bwd time: 45.1020 / Avg. batch time: 913.2127 (ms) / GPU bubble ratio: 42.65%
[rank3]:2025-12-30 22:02:22,133 - Avg. fwd time: 25.2102 / Avg. bwd time: 58.1201 / Avg. batch time: 812.9274 (ms) / GPU bubble ratio: 17.99%
[rank0]:2025-12-30 22:02:22,202 - Avg. fwd time: 16.2847 / Avg. bwd time: 36.2015 / Avg. batch time: 947.5781 (ms) / GPU bubble ratio: 55.69%
[rank0]:2025-12-30 22:02:22,238 -  step: 500  loss: -4.0000  grad_norm:  0.1976  memory: 16.87GiB(35.50%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank2]:2025-12-30 22:02:22,224 -  step: 500  loss: -4.0000  grad_norm:  0.1976  memory:  8.66GiB(18.23%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank1]:2025-12-30 22:02:22,228 -  step: 500  loss: -4.0000  grad_norm:  0.1976  memory: 12.86GiB(27.07%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank1]:2025-12-30 22:02:22,285 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2202_stage1_step500.svg
[rank3]:2025-12-30 22:02:22,237 -  step: 500  loss:  0.2253  grad_norm:  0.1976  memory: 25.79GiB(54.28%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank0]:2025-12-30 22:02:22,285 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2202_stage0_step500.svg
[rank2]:2025-12-30 22:02:22,287 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2202_stage2_step500.svg
[rank3]:2025-12-30 22:02:22,381 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2202_step500_rank3.svg
[rank3]:			> Batch Time: 874.50 ms, GPU Bubble Ratio: 51.69%, 38.33%, 54.80%, 29.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  363-42-405ms   | [S0,MB5,F]  405-16-422ms   | [S0,MB2,B]  452-42-495ms   | [S0,MB6,F]  496-16-512ms   | [S0,MB3,B]  543-42-586ms   | [S0,MB7,F]  586-16-603ms   | [S0,MB4,B]  633-42-675ms   | [S0,MB5,B]  721-42-763ms   | [S0,MB6,B]  830-35-865ms   | [S0,MB7,B]  874-0-874ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  271-19-290ms   | [S1,MB1,B]  306-48-354ms   | [S1,MB4,F]  359-21-381ms   | [S1,MB2,B]  394-50-444ms   | [S1,MB5,F]  449-22-471ms   | [S1,MB3,B]  484-51-535ms   | [S1,MB6,F]  540-22-563ms   | [S1,MB4,B]  572-52-625ms   | [S1,MB7,F]  629-22-652ms   | [S1,MB5,B]  661-52-714ms   | [S1,MB6,B]  776-46-823ms   | [S1,MB7,B]  844-23-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-210ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  259-36-295ms   | [S2,MB3,F]  303-15-318ms   | [S2,MB2,B]  347-36-384ms   | [S2,MB4,F]  391-15-406ms   | [S2,MB3,B]  437-36-474ms   | [S2,MB5,F]  481-15-496ms   | [S2,MB4,B]  525-36-562ms   | [S2,MB6,F]  569-15-585ms   | [S2,MB5,B]  614-36-651ms   | [S2,MB7,F]  658-15-674ms   | [S2,MB6,B]  734-35-770ms   | [S2,MB7,B]  819-18-837ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-23-194ms   | [S3,MB1,B]  205-43-248ms   | [S3,MB2,F]  256-24-281ms   | [S3,MB2,B]  293-43-337ms   | [S3,MB3,F]  344-26-370ms   | [S3,MB3,B]  382-43-426ms   | [S3,MB4,F]  434-25-460ms   | [S3,MB4,B]  471-44-515ms   | [S3,MB5,F]  522-25-548ms   | [S3,MB5,B]  560-43-604ms   | [S3,MB6,F]  612-26-638ms   | [S3,MB6,B]  649-75-724ms   | [S3,MB7,F]  731-25-757ms   | [S3,MB7,B]  769-43-812ms  
[rank3]:2025-12-30 22:02:22,424 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2202_stage3_step500.svg
[rank0]:2025-12-30 22:02:22,437 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2202_rank0_stage0.svg
[rank0]:	> Counts Sum: 96240, Total Sum: 497280 (19.35%), Ratio(%) per element: [17.55, 23.51, 22.32, 22.02, 22.02, 23.21, 22.32, 22.91, 22.61, 23.51, 19.34, 19.04, 19.04, 20.83, 20.53, 19.04, 20.23, 18.75, 18.15, 18.45, 16.96, 17.26, 17.85, 18.45, 18.15, 17.26, 19.04, 18.75, 16.66, 18.15, 16.66, 16.36, 16.66, 18.45, 16.07, 19.04, 18.75]
[rank2]:2025-12-30 22:02:22,439 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2202_rank2_stage2.svg
[rank2]:	> Counts Sum: 76320, Total Sum: 483840 (15.77%), Ratio(%) per element: [16.66, 15.77, 16.07, 15.17, 15.77, 15.77, 16.07, 16.07, 16.36, 16.07, 16.07, 16.07, 16.36, 16.07, 15.77, 15.47, 16.07, 15.47, 16.07, 16.07, 16.07, 15.77, 15.77, 15.47, 15.77, 16.07, 16.07, 14.88, 15.47, 15.77, 15.47, 15.47, 15.17, 15.17, 14.88, 15.17]
[rank1]:2025-12-30 22:02:22,429 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2202_rank1_stage1.svg
[rank1]:	> Counts Sum: 95400, Total Sum: 604800 (15.77%), Ratio(%) per element: [16.36, 16.36, 15.77, 16.36, 16.07, 16.66, 16.07, 16.36, 16.07, 16.66, 16.66, 16.36, 16.36, 16.36, 16.07, 16.36, 16.36, 16.66, 15.77, 15.47, 16.07, 15.77, 15.47, 15.47, 15.47, 16.66, 15.47, 15.17, 15.47, 14.88, 15.17, 15.47, 15.17, 15.17, 14.88, 15.47, 14.88, 16.07, 15.47, 14.58, 14.88, 15.47, 15.17, 14.88, 15.77]
[rank3]:2025-12-30 22:02:22,554 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2202_rank3_stage3.svg
[rank3]:	> Counts Sum: 292880, Total Sum: 389760 (75.14%), Ratio(%) per element: [79.76, 80.05, 81.54, 78.57, 80.05, 79.16, 80.65, 80.65, 79.46, 77.97, 75.59, 78.27, 75.89, 77.38, 76.48, 76.48, 78.86, 78.86, 67.85, 69.64, 70.23, 69.04, 69.94, 69.64, 69.94, 68.75, 69.04, 69.94, 69.34]
[rank1]:2025-12-30 22:02:22,965 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2202_stage1.svg
[rank0]:2025-12-30 22:02:22,974 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2202_stage0.svg
[rank2]:2025-12-30 22:02:22,988 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2202_stage2.svg
[rank3]:2025-12-30 22:02:23,106 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2202_stage3.svg
[rank0]:2025-12-30 22:05:19,052 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 22:05:22,657 - Avg. fwd time: 25.2097 / Avg. bwd time: 57.4902 / Avg. batch time: 807.8625 (ms) / GPU bubble ratio: 18.10%
[rank2]:2025-12-30 22:05:22,684 - Avg. fwd time: 15.0847 / Avg. bwd time: 33.7269 / Avg. batch time: 852.3275 (ms) / GPU bubble ratio: 54.19%
[rank1]:2025-12-30 22:05:22,717 - Avg. fwd time: 20.4013 / Avg. bwd time: 45.2299 / Avg. batch time: 907.3687 (ms) / GPU bubble ratio: 42.13%
[rank1]:2025-12-30 22:05:22,751 -  step: 550  loss: -4.0000  grad_norm:  0.2726  memory: 12.86GiB(27.07%)  tps: 9,076  tflops: 70.95  mfu: 22.74%
[rank3]:2025-12-30 22:05:22,760 -  step: 550  loss:  0.2284  grad_norm:  0.2726  memory: 25.79GiB(54.28%)  tps: 9,076  tflops: 70.95  mfu: 22.74%
[rank0]:2025-12-30 22:05:22,725 - Avg. fwd time: 16.2945 / Avg. bwd time: 36.1546 / Avg. batch time: 940.7349 (ms) / GPU bubble ratio: 55.40%
[rank0]:2025-12-30 22:05:22,761 -  step: 550  loss: -4.0000  grad_norm:  0.2726  memory: 16.87GiB(35.50%)  tps: 9,076  tflops: 70.95  mfu: 22.74%
[rank2]:2025-12-30 22:05:22,747 -  step: 550  loss: -4.0000  grad_norm:  0.2726  memory:  8.66GiB(18.23%)  tps: 9,076  tflops: 70.95  mfu: 22.74%
[rank0]:2025-12-30 22:08:19,912 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 22:08:23,510 - Avg. fwd time: 25.2205 / Avg. bwd time: 57.0048 / Avg. batch time: 804.0333 (ms) / GPU bubble ratio: 18.19%
[rank2]:2025-12-30 22:08:23,538 - Avg. fwd time: 15.0936 / Avg. bwd time: 33.7545 / Avg. batch time: 848.1805 (ms) / GPU bubble ratio: 53.93%
[rank1]:2025-12-30 22:08:23,571 - Avg. fwd time: 20.4287 / Avg. bwd time: 45.3364 / Avg. batch time: 902.8653 (ms) / GPU bubble ratio: 41.73%
[rank3]:2025-12-30 22:08:23,613 -  step: 600  loss:  0.2270  grad_norm:  1.1266  memory: 25.79GiB(54.28%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank0]:2025-12-30 22:08:23,579 - Avg. fwd time: 16.3072 / Avg. bwd time: 36.1691 / Avg. batch time: 935.4069 (ms) / GPU bubble ratio: 55.12%
[rank0]:2025-12-30 22:08:23,616 -  step: 600  loss: -4.0000  grad_norm:  1.1266  memory: 16.87GiB(35.50%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank2]:2025-12-30 22:08:23,601 -  step: 600  loss: -4.0000  grad_norm:  1.1266  memory:  8.66GiB(18.23%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank1]:2025-12-30 22:08:23,605 -  step: 600  loss: -4.0000  grad_norm:  1.1266  memory: 12.86GiB(27.07%)  tps: 9,059  tflops: 70.82  mfu: 22.70%
[rank1]:2025-12-30 22:08:23,665 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2208_stage1_step600.svg
[rank0]:2025-12-30 22:08:23,666 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2208_stage0_step600.svg
[rank2]:2025-12-30 22:08:23,665 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2208_stage2_step600.svg
[rank3]:2025-12-30 22:08:23,757 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2208_step600_rank3.svg
[rank3]:			> Batch Time: 876.00 ms, GPU Bubble Ratio: 52.00%, 38.57%, 55.02%, 29.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  365-42-407ms   | [S0,MB5,F]  408-16-424ms   | [S0,MB2,B]  454-42-497ms   | [S0,MB6,F]  497-16-513ms   | [S0,MB3,B]  545-42-587ms   | [S0,MB7,F]  588-16-604ms   | [S0,MB4,B]  634-42-676ms   | [S0,MB5,B]  723-42-765ms   | [S0,MB6,B]  830-33-863ms   | [S0,MB7,B]  876-0-876ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  220-46-266ms   | [S1,MB3,F]  271-19-290ms   | [S1,MB1,B]  309-48-357ms   | [S1,MB4,F]  362-21-384ms   | [S1,MB2,B]  395-49-445ms   | [S1,MB5,F]  451-22-473ms   | [S1,MB3,B]  485-52-537ms   | [S1,MB6,F]  541-22-564ms   | [S1,MB4,B]  575-51-626ms   | [S1,MB7,F]  630-22-652ms   | [S1,MB5,B]  663-52-716ms   | [S1,MB6,B]  777-46-823ms   | [S1,MB7,B]  845-23-869ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  217-14-231ms   | [S2,MB1,B]  262-36-298ms   | [S2,MB3,F]  306-15-321ms   | [S2,MB2,B]  348-36-385ms   | [S2,MB4,F]  392-15-407ms   | [S2,MB3,B]  438-36-474ms   | [S2,MB5,F]  482-15-497ms   | [S2,MB4,B]  527-36-564ms   | [S2,MB6,F]  572-15-587ms   | [S2,MB5,B]  616-36-652ms   | [S2,MB7,F]  660-15-676ms   | [S2,MB6,B]  735-35-771ms   | [S2,MB7,B]  821-18-839ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-195ms   | [S3,MB1,B]  207-43-251ms   | [S3,MB2,F]  259-24-284ms   | [S3,MB2,B]  294-43-338ms   | [S3,MB3,F]  345-26-371ms   | [S3,MB3,B]  383-44-427ms   | [S3,MB4,F]  435-25-461ms   | [S3,MB4,B]  473-44-517ms   | [S3,MB5,F]  524-26-551ms   | [S3,MB5,B]  562-44-606ms   | [S3,MB6,F]  613-25-639ms   | [S3,MB6,B]  651-72-724ms   | [S3,MB7,F]  732-25-757ms   | [S3,MB7,B]  770-44-814ms  
[rank3]:2025-12-30 22:08:23,801 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2208_stage3_step600.svg
[rank0]:2025-12-30 22:08:23,818 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2208_rank0_stage0.svg
[rank0]:	> Counts Sum: 115840, Total Sum: 615680 (18.81%), Ratio(%) per element: [17.78, 22.83, 21.39, 21.39, 21.63, 22.83, 21.63, 21.63, 21.87, 22.35, 19.23, 18.75, 18.75, 20.43, 19.95, 18.26, 19.47, 18.26, 18.02, 17.78, 16.58, 16.82, 17.3, 17.78, 17.54, 17.06, 18.5, 17.78, 16.34, 17.3, 16.58, 16.1, 15.86, 18.02, 15.62, 18.5, 18.02]
[rank2]:2025-12-30 22:08:23,816 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2208_rank2_stage2.svg
[rank2]:	> Counts Sum: 90720, Total Sum: 599040 (15.14%), Ratio(%) per element: [15.86, 15.14, 15.38, 14.66, 15.14, 15.14, 15.38, 15.38, 15.62, 15.38, 15.38, 15.38, 15.62, 15.38, 15.14, 14.9, 15.38, 14.9, 15.38, 15.38, 15.38, 15.14, 15.14, 14.9, 15.14, 15.38, 15.38, 14.42, 14.9, 15.14, 14.9, 14.9, 14.66, 14.66, 14.42, 14.66]
[rank1]:2025-12-30 22:08:23,807 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2208_rank1_stage1.svg
[rank1]:	> Counts Sum: 113400, Total Sum: 748800 (15.14%), Ratio(%) per element: [15.62, 15.62, 15.14, 15.62, 15.38, 15.86, 15.38, 15.62, 15.38, 15.86, 15.86, 15.62, 15.62, 15.62, 15.38, 15.62, 15.62, 15.86, 15.14, 14.9, 15.38, 15.14, 14.9, 14.9, 14.9, 15.86, 14.9, 14.66, 14.9, 14.42, 14.66, 14.9, 14.66, 14.66, 14.42, 14.9, 14.42, 15.38, 14.9, 14.18, 14.42, 14.9, 14.66, 14.42, 15.14]
[rank3]:2025-12-30 22:08:23,932 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2208_rank3_stage3.svg
[rank3]:	> Counts Sum: 367280, Total Sum: 482560 (76.11%), Ratio(%) per element: [80.28, 80.28, 81.97, 79.32, 81.0, 80.04, 81.73, 81.25, 80.76, 78.6, 76.92, 78.36, 76.68, 77.88, 77.4, 76.92, 79.08, 79.32, 69.47, 71.15, 71.87, 70.91, 70.91, 71.39, 71.39, 69.95, 70.19, 71.39, 70.67]
[rank1]:2025-12-30 22:08:24,468 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2208_stage1.svg
[rank0]:2025-12-30 22:08:24,489 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2208_stage0.svg
[rank2]:2025-12-30 22:08:24,497 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2208_stage2.svg
[rank3]:2025-12-30 22:08:24,620 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2208_stage3.svg
[rank0]:2025-12-30 22:11:21,081 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 22:11:24,645 - Avg. fwd time: 25.2306 / Avg. bwd time: 56.5668 / Avg. batch time: 800.5953 (ms) / GPU bubble ratio: 18.26%
[rank2]:2025-12-30 22:11:24,675 - Avg. fwd time: 15.1021 / Avg. bwd time: 33.7797 / Avg. batch time: 844.5026 (ms) / GPU bubble ratio: 53.69%
[rank1]:2025-12-30 22:11:24,708 - Avg. fwd time: 20.4536 / Avg. bwd time: 45.4271 / Avg. batch time: 898.8843 (ms) / GPU bubble ratio: 41.37%
[rank3]:2025-12-30 22:11:24,752 -  step: 650  loss:  0.2337  grad_norm:  0.3712  memory: 25.79GiB(54.28%)  tps: 9,045  tflops: 70.71  mfu: 22.66%
[rank0]:2025-12-30 22:11:24,718 - Avg. fwd time: 16.3162 / Avg. bwd time: 36.1545 / Avg. batch time: 930.7240 (ms) / GPU bubble ratio: 54.90%
[rank0]:2025-12-30 22:11:24,754 -  step: 650  loss: -4.0000  grad_norm:  0.3712  memory: 16.87GiB(35.50%)  tps: 9,045  tflops: 70.71  mfu: 22.66%
[rank2]:2025-12-30 22:11:24,739 -  step: 650  loss: -4.0000  grad_norm:  0.3712  memory:  8.66GiB(18.23%)  tps: 9,045  tflops: 70.71  mfu: 22.66%
[rank1]:2025-12-30 22:11:24,743 -  step: 650  loss: -4.0000  grad_norm:  0.3712  memory: 12.86GiB(27.07%)  tps: 9,045  tflops: 70.71  mfu: 22.66%
[rank0]:2025-12-30 22:14:21,516 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 22:14:24,998 - Avg. fwd time: 25.2390 / Avg. bwd time: 56.1950 / Avg. batch time: 797.6748 (ms) / GPU bubble ratio: 18.33%
[rank2]:2025-12-30 22:14:25,027 - Avg. fwd time: 15.1086 / Avg. bwd time: 33.8021 / Avg. batch time: 841.3468 (ms) / GPU bubble ratio: 53.49%
[rank1]:2025-12-30 22:14:25,060 - Avg. fwd time: 20.4769 / Avg. bwd time: 45.5050 / Avg. batch time: 895.4734 (ms) / GPU bubble ratio: 41.05%
[rank0]:2025-12-30 22:14:25,070 - Avg. fwd time: 16.3213 / Avg. bwd time: 36.1383 / Avg. batch time: 926.7125 (ms) / GPU bubble ratio: 54.71%
[rank2]:2025-12-30 22:14:25,092 -  step: 700  loss: -4.0000  grad_norm:  0.3780  memory:  8.66GiB(18.23%)  tps: 9,084  tflops: 71.02  mfu: 22.76%
[rank1]:2025-12-30 22:14:25,096 -  step: 700  loss: -4.0000  grad_norm:  0.3780  memory: 12.86GiB(27.07%)  tps: 9,084  tflops: 71.02  mfu: 22.76%
[rank1]:2025-12-30 22:14:25,157 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2214_stage1_step700.svg
[rank3]:2025-12-30 22:14:25,105 -  step: 700  loss:  0.1901  grad_norm:  0.3780  memory: 25.79GiB(54.28%)  tps: 9,085  tflops: 71.02  mfu: 22.76%
[rank0]:2025-12-30 22:14:25,106 -  step: 700  loss: -4.0000  grad_norm:  0.3780  memory: 16.87GiB(35.50%)  tps: 9,084  tflops: 71.02  mfu: 22.76%
[rank0]:2025-12-30 22:14:25,156 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2214_stage0_step700.svg
[rank2]:2025-12-30 22:14:25,158 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2214_stage2_step700.svg
[rank3]:2025-12-30 22:14:25,251 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2214_step700_rank3.svg
[rank3]:			> Batch Time: 876.00 ms, GPU Bubble Ratio: 52.20%, 38.33%, 54.97%, 29.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  277-42-319ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  366-42-409ms   | [S0,MB5,F]  409-16-425ms   | [S0,MB2,B]  456-42-498ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  546-42-589ms   | [S0,MB7,F]  589-16-606ms   | [S0,MB4,B]  635-42-677ms   | [S0,MB5,B]  723-42-765ms   | [S0,MB6,B]  831-32-863ms   | [S0,MB7,B]  876-0-876ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  222-46-269ms   | [S1,MB3,F]  273-19-293ms   | [S1,MB1,B]  310-49-359ms   | [S1,MB4,F]  363-22-385ms   | [S1,MB2,B]  398-50-448ms   | [S1,MB5,F]  452-22-474ms   | [S1,MB3,B]  486-52-538ms   | [S1,MB6,F]  543-22-566ms   | [S1,MB4,B]  575-52-627ms   | [S1,MB7,F]  631-22-654ms   | [S1,MB5,B]  663-52-716ms   | [S1,MB6,B]  778-46-824ms   | [S1,MB7,B]  845-23-869ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-212ms   | [S2,MB2,F]  219-14-234ms   | [S2,MB1,B]  263-36-299ms   | [S2,MB3,F]  306-15-322ms   | [S2,MB2,B]  351-36-388ms   | [S2,MB4,F]  395-15-410ms   | [S2,MB3,B]  439-36-476ms   | [S2,MB5,F]  483-15-498ms   | [S2,MB4,B]  528-36-564ms   | [S2,MB6,F]  571-15-587ms   | [S2,MB5,B]  616-36-652ms   | [S2,MB7,F]  660-15-675ms   | [S2,MB6,B]  735-35-771ms   | [S2,MB7,B]  819-18-838ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  209-43-253ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  297-43-341ms   | [S3,MB3,F]  348-26-374ms   | [S3,MB3,B]  386-43-430ms   | [S3,MB4,F]  436-25-462ms   | [S3,MB4,B]  474-44-518ms   | [S3,MB5,F]  525-26-551ms   | [S3,MB5,B]  563-43-607ms   | [S3,MB6,F]  613-25-639ms   | [S3,MB6,B]  650-75-726ms   | [S3,MB7,F]  733-25-758ms   | [S3,MB7,B]  770-43-813ms  
[rank3]:2025-12-30 22:14:25,297 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2214_stage3_step700.svg
[rank2]:2025-12-30 22:14:25,311 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2214_rank2_stage2.svg
[rank2]:	> Counts Sum: 105120, Total Sum: 714240 (14.72%), Ratio(%) per element: [15.32, 14.71, 14.91, 14.31, 14.71, 14.71, 14.91, 14.91, 15.12, 14.91, 14.91, 14.91, 15.12, 14.91, 14.71, 14.51, 14.91, 14.51, 14.91, 14.91, 14.91, 14.71, 14.71, 14.51, 14.71, 14.91, 14.91, 14.11, 14.51, 14.71, 14.51, 14.51, 14.31, 14.31, 14.11, 14.31]
[rank1]:2025-12-30 22:14:25,299 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2214_rank1_stage1.svg
[rank1]:	> Counts Sum: 131400, Total Sum: 892800 (14.72%), Ratio(%) per element: [15.12, 15.12, 14.71, 15.12, 14.91, 15.32, 14.91, 15.12, 14.91, 15.32, 15.32, 15.12, 15.12, 15.12, 14.91, 15.12, 15.12, 15.32, 14.71, 14.51, 14.91, 14.71, 14.51, 14.51, 14.51, 15.32, 14.51, 14.31, 14.51, 14.11, 14.31, 14.51, 14.31, 14.31, 14.11, 14.51, 14.11, 14.91, 14.51, 13.91, 14.11, 14.51, 14.31, 14.11, 14.71]
[rank0]:2025-12-30 22:14:25,307 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2214_rank0_stage0.svg
[rank0]:	> Counts Sum: 135440, Total Sum: 734080 (18.45%), Ratio(%) per element: [17.94, 22.17, 21.37, 20.96, 21.37, 22.37, 20.96, 21.16, 21.57, 22.17, 18.54, 17.94, 18.34, 19.55, 19.15, 17.54, 19.15, 17.74, 17.54, 17.54, 16.53, 16.33, 17.13, 17.13, 17.54, 16.73, 18.54, 17.54, 16.33, 16.73, 16.73, 16.12, 15.92, 17.54, 15.32, 17.74, 17.54]
[rank3]:2025-12-30 22:14:25,429 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2214_rank3_stage3.svg
[rank3]:	> Counts Sum: 441680, Total Sum: 575360 (76.77%), Ratio(%) per element: [81.04, 81.25, 82.45, 80.24, 82.05, 80.84, 82.25, 81.85, 81.45, 78.83, 77.41, 78.83, 77.21, 78.02, 77.21, 77.01, 78.83, 79.03, 70.76, 71.97, 72.98, 71.77, 71.97, 72.37, 72.17, 70.76, 71.37, 72.37, 71.77]
[rank1]:2025-12-30 22:14:26,081 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2214_stage1.svg
[rank0]:2025-12-30 22:14:26,092 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2214_stage0.svg
[rank2]:2025-12-30 22:14:26,106 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2214_stage2.svg
[rank3]:2025-12-30 22:14:26,235 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2214_stage3.svg
[rank0]:2025-12-30 22:17:22,353 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 22:17:25,878 - Avg. fwd time: 25.2382 / Avg. bwd time: 55.8596 / Avg. batch time: 794.9778 (ms) / GPU bubble ratio: 18.39%
[rank1]:2025-12-30 22:17:25,941 - Avg. fwd time: 20.4967 / Avg. bwd time: 45.5720 / Avg. batch time: 892.3825 (ms) / GPU bubble ratio: 40.77%
[rank0]:2025-12-30 22:17:25,951 - Avg. fwd time: 16.3266 / Avg. bwd time: 36.1489 / Avg. batch time: 923.1019 (ms) / GPU bubble ratio: 54.52%
[rank2]:2025-12-30 22:17:25,907 - Avg. fwd time: 15.1206 / Avg. bwd time: 33.8196 / Avg. batch time: 838.4781 (ms) / GPU bubble ratio: 53.31%
[rank2]:2025-12-30 22:17:25,972 -  step: 750  loss: -4.0000  grad_norm:  0.2253  memory:  8.66GiB(18.23%)  tps: 9,058  tflops: 70.81  mfu: 22.70%
[rank3]:2025-12-30 22:17:25,985 -  step: 750  loss:  0.2353  grad_norm:  0.2253  memory: 25.79GiB(54.28%)  tps: 9,058  tflops: 70.81  mfu: 22.70%
[rank1]:2025-12-30 22:17:25,976 -  step: 750  loss: -4.0000  grad_norm:  0.2253  memory: 12.86GiB(27.07%)  tps: 9,058  tflops: 70.81  mfu: 22.70%
[rank0]:2025-12-30 22:17:25,987 -  step: 750  loss: -4.0000  grad_norm:  0.2253  memory: 16.87GiB(35.50%)  tps: 9,058  tflops: 70.81  mfu: 22.70%
[rank0]:2025-12-30 22:20:23,222 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 22:20:26,887 - Avg. fwd time: 25.2488 / Avg. bwd time: 55.5991 / Avg. batch time: 792.9787 (ms) / GPU bubble ratio: 18.44%
[rank1]:2025-12-30 22:20:26,950 - Avg. fwd time: 20.5173 / Avg. bwd time: 45.6311 / Avg. batch time: 890.0105 (ms) / GPU bubble ratio: 40.54%
[rank1]:2025-12-30 22:20:26,986 -  step: 800  loss: -4.0000  grad_norm:  1.3273  memory: 12.86GiB(27.07%)  tps: 9,051  tflops: 70.76  mfu: 22.68%
[rank1]:2025-12-30 22:20:26,986 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.3273  tps: 9,162  tflops: 71.63  mfu: 20.99%
[rank1]:2025-12-30 22:20:26,986 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 22:20:26,987 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 22:20:26,960 - Avg. fwd time: 16.3327 / Avg. bwd time: 36.1559 / Avg. batch time: 920.2747 (ms) / GPU bubble ratio: 54.37%
[rank2]:2025-12-30 22:20:26,916 - Avg. fwd time: 15.1345 / Avg. bwd time: 33.8358 / Avg. batch time: 836.3009 (ms) / GPU bubble ratio: 53.16%
[rank2]:2025-12-30 22:20:26,982 -  step: 800  loss: -4.0000  grad_norm:  1.3273  memory:  8.66GiB(18.23%)  tps: 9,051  tflops: 70.76  mfu: 22.68%
[rank2]:2025-12-30 22:20:26,982 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.3273  tps: 9,162  tflops: 71.63  mfu: 20.99%
[rank2]:2025-12-30 22:20:26,982 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-30 22:20:26,983 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 22:20:26,995 -  step: 800  loss:  0.2383  grad_norm:  1.3273  memory: 25.79GiB(54.28%)  tps: 9,052  tflops: 70.76  mfu: 22.68%
[rank3]:2025-12-30 22:20:26,995 - â„¹ï¸ final step: 800  loss:  0.2383  grad_norm:  1.3273  tps: 9,170  tflops: 71.69  mfu: 21.13%
[rank3]:2025-12-30 22:20:26,996 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 22:20:26,997 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 22:20:26,996 -  step: 800  loss: -4.0000  grad_norm:  1.3273  memory: 16.87GiB(35.50%)  tps: 9,051  tflops: 70.76  mfu: 22.68%
[rank0]:2025-12-30 22:20:26,997 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.3273  tps: 9,163  tflops: 71.63  mfu: 20.99%
[rank0]:2025-12-30 22:20:26,997 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 22:20:26,997 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 22:20:28,957 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-30 22:20:29,019 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_2220_stage1_final800.svg
[rank0]:2025-12-30 22:20:29,019 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_2220_stage0_final800.svg
[rank2]:2025-12-30 22:20:29,026 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_2220_stage2_final800.svg
[rank3]:2025-12-30 22:20:29,113 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2220_final800_rank3.svg
[rank3]:			> Batch Time: 878.50 ms, GPU Bubble Ratio: 51.93%, 39.12%, 55.14%, 29.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  276-42-318ms   | [S0,MB4,F]  319-15-334ms   | [S0,MB1,B]  367-42-409ms   | [S0,MB5,F]  410-16-426ms   | [S0,MB2,B]  457-42-500ms   | [S0,MB6,F]  500-16-516ms   | [S0,MB3,B]  548-42-590ms   | [S0,MB7,F]  591-16-607ms   | [S0,MB4,B]  638-42-680ms   | [S0,MB5,B]  726-42-768ms   | [S0,MB6,B]  833-35-869ms   | [S0,MB7,B]  878-0-878ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-46-268ms   | [S1,MB3,F]  272-19-292ms   | [S1,MB1,B]  310-48-358ms   | [S1,MB4,F]  363-21-385ms   | [S1,MB2,B]  399-49-448ms   | [S1,MB5,F]  454-22-476ms   | [S1,MB3,B]  488-51-539ms   | [S1,MB6,F]  544-22-567ms   | [S1,MB4,B]  577-51-628ms   | [S1,MB7,F]  634-22-656ms   | [S1,MB5,B]  666-52-718ms   | [S1,MB6,B]  780-46-827ms   | [S1,MB7,B]  848-23-872ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  175-36-211ms   | [S2,MB2,F]  218-14-233ms   | [S2,MB1,B]  263-36-300ms   | [S2,MB3,F]  307-15-322ms   | [S2,MB2,B]  352-36-388ms   | [S2,MB4,F]  396-15-411ms   | [S2,MB3,B]  441-36-477ms   | [S2,MB5,F]  485-15-500ms   | [S2,MB4,B]  530-36-566ms   | [S2,MB6,F]  574-15-589ms   | [S2,MB5,B]  619-36-655ms   | [S2,MB7,F]  663-15-678ms   | [S2,MB6,B]  738-35-774ms   | [S2,MB7,B]  823-18-841ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-165ms    | [S3,MB1,F]  172-24-196ms   | [S3,MB1,B]  208-43-252ms   | [S3,MB2,F]  260-25-286ms   | [S3,MB2,B]  298-44-342ms   | [S3,MB3,F]  349-26-375ms   | [S3,MB3,B]  386-44-431ms   | [S3,MB4,F]  438-25-464ms   | [S3,MB4,B]  475-44-520ms   | [S3,MB5,F]  527-26-553ms   | [S3,MB5,B]  565-44-609ms   | [S3,MB6,F]  616-25-642ms   | [S3,MB6,B]  654-75-729ms   | [S3,MB7,F]  735-25-760ms   | [S3,MB7,B]  772-44-816ms  
[rank1]:2025-12-30 22:20:29,165 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2220_rank1_stage1.svg
[rank1]:	> Counts Sum: 149400, Total Sum: 1036800 (14.41%), Ratio(%) per element: [14.75, 14.75, 14.4, 14.75, 14.58, 14.93, 14.58, 14.75, 14.58, 14.93, 14.93, 14.75, 14.75, 14.75, 14.58, 14.75, 14.75, 14.93, 14.4, 14.23, 14.58, 14.4, 14.23, 14.23, 14.23, 14.93, 14.23, 14.06, 14.23, 13.88, 14.06, 14.23, 14.06, 14.06, 13.88, 14.23, 13.88, 14.58, 14.23, 13.71, 13.88, 14.23, 14.06, 13.88, 14.4]
[rank0]:2025-12-30 22:20:29,173 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2220_rank0_stage0.svg
[rank0]:	> Counts Sum: 155040, Total Sum: 852480 (18.19%), Ratio(%) per element: [17.53, 21.7, 20.65, 21.0, 20.83, 21.7, 20.83, 20.65, 21.52, 21.87, 18.57, 17.7, 17.88, 19.61, 18.75, 17.36, 18.75, 17.53, 17.7, 17.18, 16.66, 16.31, 16.84, 16.66, 17.01, 16.49, 18.22, 17.18, 15.79, 16.14, 16.66, 16.14, 15.79, 17.36, 15.45, 17.53, 17.18]
[rank3]:2025-12-30 22:20:29,254 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/pipeline_schedule/251230_2220_thry_final800_rank3.svg
[rank3]:			> Batch Time: 639.88 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-58ms     | [S0,MB3,F]  58-19-77ms     | [S0,MB0,B]  193-38-232ms   | [S0,MB4,F]  232-19-252ms   | [S0,MB1,B]  252-38-290ms   | [S0,MB5,F]  290-19-310ms   | [S0,MB2,B]  310-38-349ms   | [S0,MB6,F]  349-19-368ms   | [S0,MB3,B]  368-38-407ms   | [S0,MB7,F]  407-19-426ms   | [S0,MB4,B]  426-38-465ms   | [S0,MB5,B]  484-38-523ms   | [S0,MB6,B]  542-38-581ms   | [S0,MB7,B]  601-38-639ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-77ms     | [S1,MB0,B]  155-38-193ms   | [S1,MB3,F]  193-19-213ms   | [S1,MB1,B]  213-38-252ms   | [S1,MB4,F]  252-19-271ms   | [S1,MB2,B]  271-38-310ms   | [S1,MB5,F]  310-19-329ms   | [S1,MB3,B]  329-38-368ms   | [S1,MB6,F]  368-19-387ms   | [S1,MB4,B]  387-38-426ms   | [S1,MB7,F]  426-19-445ms   | [S1,MB5,B]  445-38-484ms   | [S1,MB6,B]  504-38-542ms   | [S1,MB7,B]  562-38-601ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-58ms     | [S2,MB1,F]  58-19-77ms     | [S2,MB0,B]  116-38-155ms   | [S2,MB2,F]  155-19-174ms   | [S2,MB1,B]  174-38-213ms   | [S2,MB3,F]  213-19-232ms   | [S2,MB2,B]  232-38-271ms   | [S2,MB4,F]  271-19-290ms   | [S2,MB3,B]  290-38-329ms   | [S2,MB5,F]  329-19-349ms   | [S2,MB4,B]  349-38-387ms   | [S2,MB6,F]  387-19-407ms   | [S2,MB5,B]  407-38-445ms   | [S2,MB7,F]  445-19-465ms   | [S2,MB6,B]  465-38-504ms   | [S2,MB7,B]  523-38-562ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  58-19-77ms     | [S3,MB0,B]  77-38-116ms    | [S3,MB1,F]  116-19-135ms   | [S3,MB1,B]  135-38-174ms   | [S3,MB2,F]  174-19-193ms   | [S3,MB2,B]  193-38-232ms   | [S3,MB3,F]  232-19-252ms   | [S3,MB3,B]  252-38-290ms   | [S3,MB4,F]  290-19-310ms   | [S3,MB4,B]  310-38-349ms   | [S3,MB5,F]  349-19-368ms   | [S3,MB5,B]  368-38-407ms   | [S3,MB6,F]  407-19-426ms   | [S3,MB6,B]  426-38-465ms   | [S3,MB7,F]  465-19-484ms   | [S3,MB7,B]  484-38-523ms  
[rank2]:2025-12-30 22:20:29,215 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2220_rank2_stage2.svg
[rank2]:	> Counts Sum: 119520, Total Sum: 829440 (14.41%), Ratio(%) per element: [14.93, 14.4, 14.58, 14.06, 14.4, 14.4, 14.58, 14.58, 14.75, 14.58, 14.58, 14.58, 14.75, 14.58, 14.4, 14.23, 14.58, 14.23, 14.58, 14.58, 14.58, 14.4, 14.4, 14.23, 14.4, 14.58, 14.58, 13.88, 14.23, 14.4, 14.23, 14.23, 14.06, 14.06, 13.88, 14.06]
[rank3]:2025-12-30 22:20:29,301 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_2220_stage3_final800.svg
[rank3]:2025-12-30 22:20:29,432 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/frozen_params_histogram/251230_2220_rank3_stage3.svg
[rank3]:	> Counts Sum: 516080, Total Sum: 668160 (77.24%), Ratio(%) per element: [81.07, 81.25, 82.63, 80.38, 82.81, 81.07, 82.11, 81.94, 81.94, 79.16, 77.95, 79.16, 77.43, 77.95, 77.43, 77.43, 79.16, 79.34, 71.87, 72.91, 73.61, 72.39, 72.91, 72.74, 73.09, 71.7, 72.56, 73.26, 72.56]
[rank1]:2025-12-30 22:20:30,075 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2220_stage1.svg
[rank1]:2025-12-30 22:20:30,078 - Destroying the purge thread.
[rank0]:2025-12-30 22:20:30,102 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2220_stage0.svg
[rank0]:2025-12-30 22:20:30,104 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-30 22:20:30,141 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2220_stage2.svg
[rank2]:2025-12-30 22:20:30,142 - Destroying the purge thread.
[rank2]:2025-12-30 22:20:30,276 - Process group destroyed
[rank1]:2025-12-30 22:20:30,313 - Process group destroyed
[rank3]:2025-12-30 22:20:30,390 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1/afr_time_plot/251230_2220_stage3.svg
[rank3]:2025-12-30 22:20:30,392 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 316-337
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.57344
[rank3]:wandb:               final/avg_loss 0.23825
[rank3]:wandb:             final/avg_mfu(%) 21.13426
[rank3]:wandb:             final/avg_tflops 71.68578
[rank3]:wandb:    final/avg_throughput(tps) 9169.86529
[rank3]:wandb:              final/grad_norm 1.32726
[rank3]:wandb:               final/max_loss 0.23825
[rank3]:wandb:                    grad_norm 1.32726
[rank3]:wandb: loss_metrics/global_avg_loss 0.23825
[rank3]:wandb: loss_metrics/global_max_loss 0.23825
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_1F1B_timelyauto_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/7de1kmn9
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_1F1B_timelyauto_22_dm1/20251230-2129/wandb/run-20251230_212948-7de1kmn9/logs
[rank3]:2025-12-30 22:20:31,773 - Process group destroyed
[rank0]:2025-12-30 22:20:32,104 - Training completed
[rank0]:2025-12-30 22:20:32,104 - Destroying the purge thread.
[rank0]:2025-12-30 22:20:32,375 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.5', 'layers.8', 'layers.4', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.11', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.2', 'tok_embeddings', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.14', 'norm', 'output', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_1F1B_timelyauto_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_1F1B_timelyauto_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_1F1B_timelyauto_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_1F1B_timelyauto_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_1F1B_timelyauto_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_1F1B_timelyauto_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_1F1B_timelyauto_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_1F1B_timelyauto_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
