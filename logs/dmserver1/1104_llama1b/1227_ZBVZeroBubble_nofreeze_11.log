
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 00:58:33 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_ZBVZeroBubble_nofreeze_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with nofreeze x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-28 00:58:39,820 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:2025-12-28 00:58:39,841 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank0]:"
[rank1]:2025-12-28 00:58:39,954 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank3]:2025-12-28 00:58:40,046 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank0]:2025-12-28 00:58:40,092 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 00:58:40,094 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-28 00:58:40,104 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 00:58:40,106 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 00:58:40,100 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 00:58:40,101 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-28 00:58:40,242 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 00:58:40,245 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 00:58:40,303 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 00:58:40,306 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 00:58:40,498 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-28 00:58:43,651 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 00:58:43,694 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 00:58:43,649 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 00:58:43,694 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 00:58:43,606 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:2025-12-28 00:58:43,723 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-28 00:58:43,736 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-28 00:58:43,738 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-28 00:58:43,721 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-28 00:58:43,734 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-28 00:58:43,736 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-28 00:58:43,907 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 00:58:43,952 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 00:58:43,981 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-28 00:58:43,993 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-28 00:58:43,995 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-28 00:58:43,958 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 00:58:43,959 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 00:58:43,960 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank2]:2025-12-28 00:58:43,927 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 00:58:43,927 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 00:58:43,927 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-28 00:58:44,195 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 00:58:44,196 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 00:58:44,196 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run 1o5pjjhm
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_nofreeze_11_dm1/20251228-0058/wandb/run-20251228_005845-1o5pjjhm
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1227_ZBVZeroBubble_nofreeze_11_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/1o5pjjhm
[rank0]:2025-12-28 00:58:46,461 - WandB logging enabled
[rank0]:2025-12-28 00:58:46,461 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 00:58:46,499 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 00:58:46,500 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 00:58:46,527 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-28 00:58:46,540 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-28 00:58:46,542 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-28 00:58:46,770 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-28 00:58:46,770 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 00:58:46,749 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 00:58:46,750 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 00:58:46,751 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-28 00:58:46,769 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_ZBVZeroBubble_nofreeze_11_dm1
[rank0]:2025-12-28 00:58:46,770 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 00:58:46,770 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 00:58:46,771 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-28 00:58:46,770 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 00:58:50,331 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-28 00:58:50,332 - Finished loading the checkpoint in 3.56 seconds.
[rank0]:2025-12-28 00:58:50,332 - Training starts at step 1
[rank0]:2025-12-28 00:58:55,592 -  step:  1  loss: 10.6092  grad_norm: 203.0649  memory: 30.01GiB(63.17%)  tps: 3,604  tflops: 28.18  mfu: 9.03%
[rank0]:2025-12-28 00:58:55,593 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 00:58:55,542 -  step:  1  loss: -4.0000  grad_norm: 203.0649  memory: 11.98GiB(25.23%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank2]:2025-12-28 00:58:55,543 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 00:58:55,543 -  step:  1  loss: -4.0000  grad_norm: 203.0649  memory: 13.45GiB(28.31%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank1]:2025-12-28 00:58:55,559 -  step:  1  loss: -4.0000  grad_norm: 203.0649  memory: 15.58GiB(32.80%)  tps: 2,823  tflops: 22.07  mfu: 7.07%
[rank3]:2025-12-28 00:58:55,544 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 00:58:55,559 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 01:02:29,267 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:02:33,890 - Avg. fwd time: 7.7144 / Avg. bwd-weight time: 9.6505 / Avg. bwd-input time: 9.5066 / Avg. batch time: 1014.8205 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-12-28 01:02:33,884 - Avg. fwd time: 7.8914 / Avg. bwd-weight time: 9.9366 / Avg. bwd-input time: 9.8070 / Avg. batch time: 1019.9330 (ms) / GPU bubble ratio: 56.65%
[rank3]:2025-12-28 01:02:33,958 -  step: 50  loss: -4.0000  grad_norm: 24.2124  memory: 15.27GiB(32.13%)  tps: 7,351  tflops: 57.47  mfu: 18.42%
[rank2]:2025-12-28 01:02:33,958 -  step: 50  loss: -4.0000  grad_norm: 24.2124  memory: 13.80GiB(29.05%)  tps: 7,351  tflops: 57.47  mfu: 18.42%
[rank1]:2025-12-28 01:02:33,907 - Avg. fwd time: 9.9091 / Avg. bwd-weight time: 13.0301 / Avg. bwd-input time: 12.3162 / Avg. batch time: 1058.4905 (ms) / GPU bubble ratio: 46.71%
[rank1]:2025-12-28 01:02:33,962 -  step: 50  loss: -4.0000  grad_norm: 24.2124  memory: 17.83GiB(37.53%)  tps: 7,352  tflops: 57.47  mfu: 18.42%
[rank0]:2025-12-28 01:02:33,912 - Avg. fwd time: 12.9555 / Avg. full-bwd time: 27.7569 (Avg. bwd-weight time: 28.5813 / Avg. bwd-input time: 33.6487) / Avg. batch time: 1074.0131 (ms) / GPU bubble ratio: 13.67%
[rank0]:2025-12-28 01:02:33,985 -  step: 50  loss:  9.8833  grad_norm: 24.2124  memory: 35.32GiB(74.36%)  tps: 7,352  tflops: 57.48  mfu: 18.42%
[rank0]:2025-12-28 01:06:13,197 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 01:06:17,819 - Avg. fwd time: 7.8835 / Avg. bwd-weight time: 9.9751 / Avg. bwd-input time: 9.8182 / Avg. batch time: 1022.6073 (ms) / GPU bubble ratio: 56.70%
[rank2]:2025-12-28 01:06:17,892 -  step: 100  loss: -4.0000  grad_norm: 16.0323  memory: 13.80GiB(29.05%)  tps: 7,316  tflops: 57.20  mfu: 18.33%
[rank1]:2025-12-28 01:06:17,843 - Avg. fwd time: 9.9036 / Avg. bwd-weight time: 13.0905 / Avg. bwd-input time: 12.3458 / Avg. batch time: 1061.4131 (ms) / GPU bubble ratio: 46.73%
[rank3]:2025-12-28 01:06:17,827 - Avg. fwd time: 7.7043 / Avg. bwd-weight time: 9.6861 / Avg. bwd-input time: 9.5162 / Avg. batch time: 1017.5129 (ms) / GPU bubble ratio: 57.69%
[rank3]:2025-12-28 01:06:17,892 -  step: 100  loss: -4.0000  grad_norm: 16.0323  memory: 15.27GiB(32.13%)  tps: 7,316  tflops: 57.20  mfu: 18.33%
[rank0]:2025-12-28 01:06:17,846 - Avg. fwd time: 12.9912 / Avg. full-bwd time: 27.8786 (Avg. bwd-weight time: 28.7673 / Avg. bwd-input time: 33.6765) / Avg. batch time: 1076.8858 (ms) / GPU bubble ratio: 13.60%
[rank1]:2025-12-28 01:06:17,895 -  step: 100  loss: -4.0000  grad_norm: 16.0323  memory: 17.83GiB(37.53%)  tps: 7,316  tflops: 57.20  mfu: 18.33%
[rank0]:2025-12-28 01:06:17,919 -  step: 100  loss:  8.2172  grad_norm: 16.0323  memory: 35.32GiB(74.36%)  tps: 7,316  tflops: 57.20  mfu: 18.33%
[rank3]:2025-12-28 01:06:18,296 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0106_step100_rank3.svg
[rank3]:			> Batch Time: 1073.39 ms, GPU Bubble Ratio: 13.22%, 47.29%, 58.72%, 59.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 225-33-258ms   | [S7,MB1,BW] 258-27-286ms   | [S7,MB2,F]  285-17-303ms   | [S7,MB2,BI] 314-34-348ms   | [S7,MB2,BW] 349-30-379ms   | [S7,MB3,F]  378-18-396ms   | [S7,MB3,BI] 408-34-443ms   | [S7,MB3,BW] 443-29-473ms   | [S0,MB7,F]  473-9-483ms    | [S0,MB0,B]  483-29-512ms   | [S7,MB4,F]  512-17-529ms   | [S7,MB4,BI] 542-33-575ms   | [S7,MB4,BW] 575-28-603ms   | [S0,MB1,B]  603-28-631ms   | [S7,MB5,F]  631-17-648ms   | [S7,MB5,BI] 660-33-693ms   | [S7,MB5,BW] 693-29-722ms   | [S0,MB2,B]  722-28-750ms   | [S7,MB6,F]  750-17-767ms   | [S7,MB6,BI] 779-33-812ms   | [S7,MB6,BW] 812-29-841ms   | [S0,MB3,B]  842-28-870ms   | [S7,MB7,F]  870-17-887ms   | [S7,MB7,BI] 899-33-932ms   | [S7,MB7,BW] 932-29-961ms   | [S0,MB4,B]  962-28-990ms   | [S0,MB5,B]  990-27-1018ms  | [S0,MB6,B]  1018-27-1046ms | [S0,MB7,B]  1047-26-1073ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-180ms    | [S6,MB0,BW] 180-10-191ms   | [S6,MB2,F]  190-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-278ms   | [S6,MB3,F]  278-7-285ms    | [S6,MB2,BI] 349-9-358ms    | [S6,MB2,BW] 358-10-369ms   | [S1,MB6,F]  369-11-380ms   | [S1,MB0,BI] 380-15-396ms   | [S1,MB0,BW] 396-15-411ms   | [S6,MB4,F]  411-8-419ms    | [S6,MB3,BI] 443-10-454ms   | [S6,MB3,BW] 454-9-464ms    | [S1,MB7,F]  484-13-497ms   | [S1,MB1,BI] 497-15-513ms   | [S1,MB1,BW] 512-14-527ms   | [S6,MB5,F]  528-7-535ms    | [S6,MB4,BI] 575-10-586ms   | [S6,MB4,BW] 586-9-596ms    | [S1,MB2,BI] 610-14-624ms   | [S1,MB2,BW] 624-14-639ms   | [S6,MB6,F]  703-7-710ms    | [S6,MB5,BI] 710-9-720ms    | [S6,MB5,BW] 720-10-731ms   | [S1,MB3,BI] 732-14-747ms   | [S1,MB3,BW] 746-14-761ms   | [S6,MB7,F]  821-7-828ms    | [S6,MB6,BI] 828-9-838ms    | [S6,MB6,BW] 838-11-849ms   | [S1,MB4,BI] 850-14-865ms   | [S6,MB7,BI] 932-10-942ms   | [S1,MB5,BI] 942-14-957ms   | [S1,MB4,BW] 957-15-973ms   | [S1,MB6,BI] 973-14-987ms   | [S1,MB5,BW] 987-16-1003ms  | [S1,MB7,BI] 1004-15-1019ms | [S1,MB6,BW] 1019-17-1036ms | [S6,MB7,BW] 1036-11-1048ms | [S1,MB7,BW] 1047-17-1064ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-7-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 180-9-189ms    | [S5,MB0,BW] 189-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 295-10-305ms   | [S2,MB0,BW] 305-9-315ms    | [S5,MB4,F]  315-7-322ms    | [S5,MB2,BI] 358-10-368ms   | [S5,MB2,BW] 368-9-378ms    | [S2,MB6,F]  380-9-390ms    | [S2,MB1,BI] 392-10-402ms   | [S2,MB1,BW] 402-9-412ms    | [S5,MB5,F]  412-7-419ms    | [S5,MB3,BI] 488-10-499ms   | [S5,MB3,BW] 499-11-511ms   | [S2,MB7,F]  511-7-518ms    | [S2,MB2,BI] 518-10-528ms   | [S2,MB2,BW] 528-9-538ms    | [S5,MB6,F]  538-7-546ms    | [S5,MB4,BI] 604-10-614ms   | [S5,MB4,BW] 614-9-624ms    | [S2,MB3,BI] 707-9-716ms    | [S2,MB3,BW] 716-9-725ms    | [S5,MB7,F]  732-7-739ms    | [S5,MB5,BI] 739-9-748ms    | [S5,MB5,BW] 749-9-758ms    | [S2,MB4,BI] 825-9-834ms    | [S5,MB6,BI] 843-10-853ms   | [S2,MB5,BI] 853-10-863ms   | [S5,MB7,BI] 946-9-955ms    | [S2,MB6,BI] 955-10-965ms   | [S2,MB4,BW] 965-10-975ms   | [S2,MB7,BI] 980-9-989ms    | [S2,MB5,BW] 989-10-999ms   | [S5,MB6,BW] 999-9-1008ms   | [S5,MB7,BW] 1009-9-1018ms  | [S2,MB6,BW] 1018-10-1028ms | [S2,MB7,BW] 1028-10-1038ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-198ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-214ms    | [S3,MB0,BI] 214-9-224ms    | [S3,MB0,BW] 223-9-233ms    | [S4,MB4,F]  233-7-240ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 385-11-396ms   | [S4,MB2,BW] 396-9-406ms    | [S3,MB6,F]  406-7-413ms    | [S3,MB2,BI] 413-9-422ms    | [S3,MB2,BW] 422-9-432ms    | [S4,MB6,F]  432-7-439ms    | [S4,MB3,BI] 503-9-513ms    | [S4,MB3,BW] 513-10-523ms   | [S3,MB7,F]  524-7-531ms    | [S3,MB3,BI] 531-9-540ms    | [S3,MB3,BW] 540-9-549ms    | [S4,MB7,F]  549-7-556ms    | [S4,MB4,BI] 700-10-710ms   | [S4,MB4,BW] 710-9-719ms    | [S3,MB4,BI] 719-10-729ms   | [S4,MB5,BI] 818-9-828ms    | [S3,MB5,BI] 828-8-837ms    | [S4,MB6,BI] 854-9-863ms    | [S3,MB6,BI] 863-8-872ms    | [S4,MB7,BI] 955-8-964ms    | [S3,MB7,BI] 964-8-973ms    | [S3,MB4,BW] 973-10-983ms   | [S4,MB5,BW] 983-9-992ms    | [S4,MB6,BW] 993-9-1002ms   | [S4,MB7,BW] 1002-9-1012ms  | [S3,MB5,BW] 1012-9-1021ms  | [S3,MB6,BW] 1021-10-1031ms | [S3,MB7,BW] 1032-10-1042ms
[rank0]:2025-12-28 01:09:57,530 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 01:10:02,211 - Avg. fwd time: 7.8761 / Avg. bwd-weight time: 9.9878 / Avg. bwd-input time: 9.8258 / Avg. batch time: 1024.3000 (ms) / GPU bubble ratio: 56.75%
[rank1]:2025-12-28 01:10:02,236 - Avg. fwd time: 9.8971 / Avg. bwd-weight time: 13.1102 / Avg. bwd-input time: 12.3609 / Avg. batch time: 1063.1768 (ms) / GPU bubble ratio: 46.77%
[rank1]:2025-12-28 01:10:02,287 -  step: 150  loss: -4.0000  grad_norm: 25.3334  memory: 17.83GiB(37.53%)  tps: 7,302  tflops: 57.08  mfu: 18.29%
[rank0]:2025-12-28 01:10:02,238 - Avg. fwd time: 13.0154 / Avg. full-bwd time: 27.9325 (Avg. bwd-weight time: 28.8244 / Avg. bwd-input time: 33.6833) / Avg. batch time: 1078.5621 (ms) / GPU bubble ratio: 13.61%
[rank3]:2025-12-28 01:10:02,218 - Avg. fwd time: 7.6970 / Avg. bwd-weight time: 9.6948 / Avg. bwd-input time: 9.5247 / Avg. batch time: 1018.6237 (ms) / GPU bubble ratio: 57.72%
[rank3]:2025-12-28 01:10:02,284 -  step: 150  loss: -4.0000  grad_norm: 25.3334  memory: 15.27GiB(32.13%)  tps: 7,302  tflops: 57.08  mfu: 18.29%
[rank2]:2025-12-28 01:10:02,284 -  step: 150  loss: -4.0000  grad_norm: 25.3334  memory: 13.80GiB(29.05%)  tps: 7,302  tflops: 57.08  mfu: 18.29%
[rank0]:2025-12-28 01:10:02,311 -  step: 150  loss:  2.7867  grad_norm: 25.3334  memory: 35.32GiB(74.36%)  tps: 7,302  tflops: 57.08  mfu: 18.29%
[rank0]:2025-12-28 01:13:41,462 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 01:13:46,168 - Avg. fwd time: 7.8713 / Avg. bwd-weight time: 9.9970 / Avg. bwd-input time: 9.8452 / Avg. batch time: 1024.6824 (ms) / GPU bubble ratio: 56.73%
[rank3]:2025-12-28 01:13:46,174 - Avg. fwd time: 7.6916 / Avg. bwd-weight time: 9.6990 / Avg. bwd-input time: 9.5478 / Avg. batch time: 1019.0713 (ms) / GPU bubble ratio: 57.71%
[rank2]:2025-12-28 01:13:46,240 -  step: 200  loss: -4.0000  grad_norm: 14.6112  memory: 13.80GiB(29.05%)  tps: 7,316  tflops: 57.19  mfu: 18.33%
[rank1]:2025-12-28 01:13:46,193 - Avg. fwd time: 9.8952 / Avg. bwd-weight time: 13.1291 / Avg. bwd-input time: 12.3944 / Avg. batch time: 1063.7058 (ms) / GPU bubble ratio: 46.72%
[rank1]:2025-12-28 01:13:46,243 -  step: 200  loss: -4.0000  grad_norm: 14.6112  memory: 17.83GiB(37.53%)  tps: 7,316  tflops: 57.19  mfu: 18.33%
[rank0]:2025-12-28 01:13:46,194 - Avg. fwd time: 13.0300 / Avg. full-bwd time: 27.9581 (Avg. bwd-weight time: 28.8353 / Avg. bwd-input time: 33.6888) / Avg. batch time: 1078.8681 (ms) / GPU bubble ratio: 13.58%
[rank0]:2025-12-28 01:13:46,266 -  step: 200  loss:  0.9626  grad_norm: 14.6112  memory: 35.32GiB(74.36%)  tps: 7,316  tflops: 57.19  mfu: 18.33%
[rank3]:2025-12-28 01:13:46,240 -  step: 200  loss: -4.0000  grad_norm: 14.6112  memory: 15.27GiB(32.13%)  tps: 7,316  tflops: 57.19  mfu: 18.33%
[rank3]:2025-12-28 01:13:46,607 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0113_step200_rank3.svg
[rank3]:			> Batch Time: 1079.38 ms, GPU Bubble Ratio: 13.16%, 47.17%, 58.71%, 59.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-34-258ms   | [S7,MB1,BW] 258-27-286ms   | [S7,MB2,F]  286-17-304ms   | [S7,MB2,BI] 316-34-350ms   | [S7,MB2,BW] 350-30-380ms   | [S7,MB3,F]  380-18-398ms   | [S7,MB3,BI] 409-34-444ms   | [S7,MB3,BW] 444-30-474ms   | [S0,MB7,F]  475-9-485ms    | [S0,MB0,B]  485-29-514ms   | [S7,MB4,F]  513-18-531ms   | [S7,MB4,BI] 543-33-577ms   | [S7,MB4,BW] 577-29-606ms   | [S0,MB1,B]  605-28-634ms   | [S7,MB5,F]  634-17-651ms   | [S7,MB5,BI] 664-33-697ms   | [S7,MB5,BW] 698-29-727ms   | [S0,MB2,B]  727-28-755ms   | [S7,MB6,F]  755-17-772ms   | [S7,MB6,BI] 785-33-818ms   | [S7,MB6,BW] 819-30-849ms   | [S0,MB3,B]  847-28-875ms   | [S7,MB7,F]  876-17-893ms   | [S7,MB7,BI] 906-33-939ms   | [S7,MB7,BW] 941-29-970ms   | [S0,MB4,B]  969-28-997ms   | [S0,MB5,B]  996-28-1024ms  | [S0,MB6,B]  1025-27-1052ms | [S0,MB7,B]  1053-26-1079ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  83-11-94ms     | [S6,MB0,F]  94-9-104ms     | [S1,MB5,F]  104-13-117ms   | [S6,MB1,F]  117-8-125ms    | [S6,MB0,BI] 171-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  277-7-285ms    | [S6,MB2,BI] 350-9-359ms    | [S6,MB2,BW] 359-10-370ms   | [S1,MB6,F]  370-11-381ms   | [S1,MB0,BI] 381-16-397ms   | [S1,MB0,BW] 397-15-413ms   | [S6,MB4,F]  413-8-421ms    | [S6,MB3,BI] 444-10-455ms   | [S6,MB3,BW] 455-9-465ms    | [S1,MB7,F]  485-13-499ms   | [S1,MB1,BI] 499-15-514ms   | [S1,MB1,BW] 514-14-529ms   | [S6,MB5,F]  529-7-537ms    | [S6,MB4,BI] 577-10-588ms   | [S6,MB4,BW] 588-9-598ms    | [S1,MB2,BI] 612-14-627ms   | [S1,MB2,BW] 626-14-641ms   | [S6,MB6,F]  707-7-714ms    | [S6,MB5,BI] 714-9-724ms    | [S6,MB5,BW] 724-10-735ms   | [S1,MB3,BI] 737-14-751ms   | [S1,MB3,BW] 751-14-766ms   | [S6,MB7,F]  828-7-835ms    | [S6,MB6,BI] 835-9-845ms    | [S6,MB6,BW] 845-11-856ms   | [S1,MB4,BI] 857-14-871ms   | [S6,MB7,BI] 940-10-951ms   | [S1,MB5,BI] 951-15-966ms   | [S1,MB4,BW] 966-15-981ms   | [S1,MB6,BI] 981-14-996ms   | [S1,MB5,BW] 996-16-1013ms  | [S1,MB7,BI] 1012-15-1028ms | [S1,MB6,BW] 1028-17-1045ms | [S6,MB7,BW] 1045-11-1057ms | [S1,MB7,BW] 1056-17-1074ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-103ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-314ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 359-10-370ms   | [S5,MB2,BW] 370-9-379ms    | [S2,MB6,F]  382-9-392ms    | [S2,MB1,BI] 393-10-404ms   | [S2,MB1,BW] 404-9-414ms    | [S5,MB5,F]  414-7-421ms    | [S5,MB3,BI] 490-10-500ms   | [S5,MB3,BW] 501-11-512ms   | [S2,MB7,F]  512-7-519ms    | [S2,MB2,BI] 519-10-530ms   | [S2,MB2,BW] 530-9-540ms    | [S5,MB6,F]  540-7-547ms    | [S5,MB4,BI] 606-10-616ms   | [S5,MB4,BW] 616-9-626ms    | [S2,MB3,BI] 711-9-720ms    | [S2,MB3,BW] 720-9-730ms    | [S5,MB7,F]  737-7-744ms    | [S5,MB5,BI] 744-9-754ms    | [S5,MB5,BW] 754-9-763ms    | [S2,MB4,BI] 832-9-841ms    | [S5,MB6,BI] 849-10-859ms   | [S2,MB5,BI] 859-10-869ms   | [S5,MB7,BI] 953-9-962ms    | [S2,MB6,BI] 963-10-973ms   | [S2,MB4,BW] 973-10-983ms   | [S2,MB7,BI] 988-9-997ms    | [S2,MB5,BW] 997-10-1007ms  | [S5,MB6,BW] 1007-9-1017ms  | [S5,MB7,BW] 1017-9-1027ms  | [S2,MB6,BW] 1026-10-1036ms | [S2,MB7,BW] 1036-10-1047ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-7-44ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-102ms     | [S4,MB3,F]  102-8-110ms    | [S4,MB0,BI] 190-9-199ms    | [S4,MB0,BW] 199-9-209ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-225ms    | [S3,MB0,BW] 225-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-306ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-325ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 387-11-398ms   | [S4,MB2,BW] 398-9-408ms    | [S3,MB6,F]  407-7-414ms    | [S3,MB2,BI] 415-9-424ms    | [S3,MB2,BW] 424-9-434ms    | [S4,MB6,F]  433-7-441ms    | [S4,MB3,BI] 505-10-515ms   | [S4,MB3,BW] 515-10-525ms   | [S3,MB7,F]  525-7-532ms    | [S3,MB3,BI] 532-9-542ms    | [S3,MB3,BW] 542-9-551ms    | [S4,MB7,F]  551-7-559ms    | [S4,MB4,BI] 704-10-714ms   | [S4,MB4,BW] 714-9-724ms    | [S3,MB4,BI] 724-10-734ms   | [S4,MB5,BI] 825-9-835ms    | [S3,MB5,BI] 835-9-844ms    | [S4,MB6,BI] 860-9-869ms    | [S3,MB6,BI] 869-9-878ms    | [S4,MB7,BI] 963-9-972ms    | [S3,MB7,BI] 972-9-981ms    | [S3,MB4,BW] 981-10-991ms   | [S4,MB5,BW] 991-9-1001ms   | [S4,MB6,BW] 1000-9-1010ms  | [S4,MB7,BW] 1010-9-1019ms  | [S3,MB5,BW] 1019-9-1029ms  | [S3,MB6,BW] 1029-10-1039ms | [S3,MB7,BW] 1039-10-1049ms
[rank0]:2025-12-28 01:17:25,653 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:17:30,283 - Avg. fwd time: 7.6858 / Avg. bwd-weight time: 9.7035 / Avg. bwd-input time: 9.5682 / Avg. batch time: 1019.2164 (ms) / GPU bubble ratio: 57.68%
[rank2]:2025-12-28 01:17:30,277 - Avg. fwd time: 7.8662 / Avg. bwd-weight time: 10.0027 / Avg. bwd-input time: 9.8627 / Avg. batch time: 1025.0849 (ms) / GPU bubble ratio: 56.72%
[rank2]:2025-12-28 01:17:30,345 -  step: 250  loss: -4.0000  grad_norm:  3.2124  memory: 13.80GiB(29.05%)  tps: 7,311  tflops: 57.15  mfu: 18.32%
[rank1]:2025-12-28 01:17:30,302 - Avg. fwd time: 9.8913 / Avg. bwd-weight time: 13.1403 / Avg. bwd-input time: 12.4180 / Avg. batch time: 1064.1726 (ms) / GPU bubble ratio: 46.70%
[rank1]:2025-12-28 01:17:30,349 -  step: 250  loss: -4.0000  grad_norm:  3.2124  memory: 17.83GiB(37.53%)  tps: 7,311  tflops: 57.15  mfu: 18.32%
[rank0]:2025-12-28 01:17:30,299 - Avg. fwd time: 13.0286 / Avg. full-bwd time: 27.9672 (Avg. bwd-weight time: 28.8561 / Avg. bwd-input time: 33.6829) / Avg. batch time: 1079.1971 (ms) / GPU bubble ratio: 13.59%
[rank0]:2025-12-28 01:17:30,372 -  step: 250  loss:  0.3449  grad_norm:  3.2124  memory: 35.32GiB(74.36%)  tps: 7,311  tflops: 57.15  mfu: 18.32%
[rank3]:2025-12-28 01:17:30,345 -  step: 250  loss: -4.0000  grad_norm:  3.2124  memory: 15.27GiB(32.13%)  tps: 7,311  tflops: 57.15  mfu: 18.32%
[rank0]:2025-12-28 01:21:09,221 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 01:21:13,847 - Avg. fwd time: 7.8609 / Avg. bwd-weight time: 10.0043 / Avg. bwd-input time: 9.8734 / Avg. batch time: 1024.9394 (ms) / GPU bubble ratio: 56.70%
[rank3]:2025-12-28 01:21:13,854 - Avg. fwd time: 7.6795 / Avg. bwd-weight time: 9.7038 / Avg. bwd-input time: 9.5806 / Avg. batch time: 1019.1575 (ms) / GPU bubble ratio: 57.67%
[rank3]:2025-12-28 01:21:13,917 -  step: 300  loss: -4.0000  grad_norm:  0.5010  memory: 15.27GiB(32.13%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank2]:2025-12-28 01:21:13,917 -  step: 300  loss: -4.0000  grad_norm:  0.5010  memory: 13.80GiB(29.05%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank1]:2025-12-28 01:21:13,871 - Avg. fwd time: 9.8856 / Avg. bwd-weight time: 13.1445 / Avg. bwd-input time: 12.4316 / Avg. batch time: 1064.0661 (ms) / GPU bubble ratio: 46.68%
[rank1]:2025-12-28 01:21:13,921 -  step: 300  loss: -4.0000  grad_norm:  0.5010  memory: 17.83GiB(37.53%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank0]:2025-12-28 01:21:13,871 - Avg. fwd time: 13.0260 / Avg. full-bwd time: 27.9698 (Avg. bwd-weight time: 28.8571 / Avg. bwd-input time: 33.6765) / Avg. batch time: 1078.9783 (ms) / GPU bubble ratio: 13.58%
[rank0]:2025-12-28 01:21:13,944 -  step: 300  loss:  0.2495  grad_norm:  0.5010  memory: 35.32GiB(74.36%)  tps: 7,328  tflops: 57.29  mfu: 18.36%
[rank3]:2025-12-28 01:21:14,287 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0121_step300_rank3.svg
[rank3]:			> Batch Time: 1073.36 ms, GPU Bubble Ratio: 13.06%, 47.06%, 58.58%, 59.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-257ms   | [S7,MB1,BW] 257-27-285ms   | [S7,MB2,F]  285-17-302ms   | [S7,MB2,BI] 314-33-348ms   | [S7,MB2,BW] 348-30-378ms   | [S7,MB3,F]  379-18-397ms   | [S7,MB3,BI] 409-34-444ms   | [S7,MB3,BW] 443-29-473ms   | [S0,MB7,F]  474-9-483ms    | [S0,MB0,B]  483-29-513ms   | [S7,MB4,F]  512-18-530ms   | [S7,MB4,BI] 543-33-576ms   | [S7,MB4,BW] 576-29-605ms   | [S0,MB1,B]  604-28-633ms   | [S7,MB5,F]  632-17-650ms   | [S7,MB5,BI] 662-33-696ms   | [S7,MB5,BW] 696-29-725ms   | [S0,MB2,B]  723-28-751ms   | [S7,MB6,F]  751-17-768ms   | [S7,MB6,BI] 781-33-814ms   | [S7,MB6,BW] 815-29-844ms   | [S0,MB3,B]  842-28-870ms   | [S7,MB7,F]  871-17-888ms   | [S7,MB7,BI] 900-33-933ms   | [S7,MB7,BW] 933-29-962ms   | [S0,MB4,B]  963-28-991ms   | [S0,MB5,B]  991-27-1019ms  | [S0,MB6,B]  1019-28-1047ms | [S0,MB7,B]  1047-26-1073ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-180ms    | [S6,MB0,BW] 180-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 257-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  277-7-285ms    | [S6,MB2,BI] 348-9-358ms    | [S6,MB2,BW] 358-10-368ms   | [S1,MB6,F]  369-11-380ms   | [S1,MB0,BI] 380-16-396ms   | [S1,MB0,BW] 396-15-411ms   | [S6,MB4,F]  411-8-419ms    | [S6,MB3,BI] 444-10-454ms   | [S6,MB3,BW] 454-9-464ms    | [S1,MB7,F]  484-13-497ms   | [S1,MB1,BI] 498-15-513ms   | [S1,MB1,BW] 513-14-528ms   | [S6,MB5,F]  528-7-536ms    | [S6,MB4,BI] 576-10-586ms   | [S6,MB4,BW] 586-9-596ms    | [S1,MB2,BI] 611-14-626ms   | [S1,MB2,BW] 625-14-640ms   | [S6,MB6,F]  705-7-712ms    | [S6,MB5,BI] 712-9-722ms    | [S6,MB5,BW] 722-10-733ms   | [S1,MB3,BI] 734-14-748ms   | [S1,MB3,BW] 748-14-763ms   | [S6,MB7,F]  824-7-832ms    | [S6,MB6,BI] 831-9-841ms    | [S6,MB6,BW] 841-11-853ms   | [S1,MB4,BI] 852-14-867ms   | [S6,MB7,BI] 933-10-943ms   | [S1,MB5,BI] 943-14-958ms   | [S1,MB4,BW] 958-15-974ms   | [S1,MB6,BI] 974-14-989ms   | [S1,MB5,BW] 989-16-1005ms  | [S1,MB7,BI] 1005-15-1021ms | [S1,MB6,BW] 1021-17-1038ms | [S6,MB7,BW] 1038-11-1050ms | [S1,MB7,BW] 1049-17-1067ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-7-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-304ms   | [S2,MB0,BW] 304-9-314ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 358-10-368ms   | [S5,MB2,BW] 368-9-378ms    | [S2,MB6,F]  380-9-390ms    | [S2,MB1,BI] 392-10-402ms   | [S2,MB1,BW] 402-9-412ms    | [S5,MB5,F]  412-7-420ms    | [S5,MB3,BI] 489-10-499ms   | [S5,MB3,BW] 499-11-511ms   | [S2,MB7,F]  511-7-518ms    | [S2,MB2,BI] 518-10-529ms   | [S2,MB2,BW] 529-9-538ms    | [S5,MB6,F]  539-7-546ms    | [S5,MB4,BI] 605-10-615ms   | [S5,MB4,BW] 615-9-625ms    | [S2,MB3,BI] 709-9-718ms    | [S2,MB3,BW] 718-9-728ms    | [S5,MB7,F]  734-7-741ms    | [S5,MB5,BI] 741-9-751ms    | [S5,MB5,BW] 751-9-760ms    | [S2,MB4,BI] 828-9-837ms    | [S5,MB6,BI] 844-10-854ms   | [S2,MB5,BI] 855-10-865ms   | [S5,MB7,BI] 946-9-955ms    | [S2,MB6,BI] 956-10-966ms   | [S2,MB4,BW] 966-10-976ms   | [S2,MB7,BI] 981-9-990ms    | [S2,MB5,BW] 990-10-1000ms  | [S5,MB6,BW] 1001-9-1010ms  | [S5,MB7,BW] 1010-9-1020ms  | [S2,MB6,BW] 1020-10-1030ms | [S2,MB7,BW] 1030-10-1040ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-241ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 385-11-396ms   | [S4,MB2,BW] 396-9-406ms    | [S3,MB6,F]  406-6-413ms    | [S3,MB2,BI] 413-9-422ms    | [S3,MB2,BW] 422-9-432ms    | [S4,MB6,F]  432-7-439ms    | [S4,MB3,BI] 503-10-513ms   | [S4,MB3,BW] 514-10-524ms   | [S3,MB7,F]  524-7-531ms    | [S3,MB3,BI] 531-9-540ms    | [S3,MB3,BW] 540-9-550ms    | [S4,MB7,F]  550-7-557ms    | [S4,MB4,BI] 702-10-712ms   | [S4,MB4,BW] 712-9-722ms    | [S3,MB4,BI] 722-10-732ms   | [S4,MB5,BI] 821-9-831ms    | [S3,MB5,BI] 831-8-840ms    | [S4,MB6,BI] 855-9-864ms    | [S3,MB6,BI] 864-9-873ms    | [S4,MB7,BI] 956-9-965ms    | [S3,MB7,BI] 965-9-974ms    | [S3,MB4,BW] 974-10-984ms   | [S4,MB5,BW] 984-9-994ms    | [S4,MB6,BW] 994-9-1003ms   | [S4,MB7,BW] 1003-9-1013ms  | [S3,MB5,BW] 1013-9-1022ms  | [S3,MB6,BW] 1023-10-1033ms | [S3,MB7,BW] 1033-10-1043ms
[rank0]:2025-12-28 01:24:52,873 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:24:57,534 - Avg. fwd time: 7.6750 / Avg. bwd-weight time: 9.7031 / Avg. bwd-input time: 9.5865 / Avg. batch time: 1018.9459 (ms) / GPU bubble ratio: 57.66%
[rank2]:2025-12-28 01:24:57,528 - Avg. fwd time: 7.8573 / Avg. bwd-weight time: 10.0035 / Avg. bwd-input time: 9.8787 / Avg. batch time: 1024.8664 (ms) / GPU bubble ratio: 56.69%
[rank1]:2025-12-28 01:24:57,551 - Avg. fwd time: 9.8815 / Avg. bwd-weight time: 13.1463 / Avg. bwd-input time: 12.4385 / Avg. batch time: 1064.0319 (ms) / GPU bubble ratio: 46.67%
[rank0]:2025-12-28 01:24:57,553 - Avg. fwd time: 13.0224 / Avg. full-bwd time: 27.9686 (Avg. bwd-weight time: 28.8484 / Avg. bwd-input time: 33.6681) / Avg. batch time: 1078.8886 (ms) / GPU bubble ratio: 13.59%
[rank3]:2025-12-28 01:24:57,599 -  step: 350  loss: -4.0000  grad_norm:  0.1963  memory: 15.27GiB(32.13%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank2]:2025-12-28 01:24:57,599 -  step: 350  loss: -4.0000  grad_norm:  0.1963  memory: 13.80GiB(29.05%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank1]:2025-12-28 01:24:57,603 -  step: 350  loss: -4.0000  grad_norm:  0.1963  memory: 17.83GiB(37.53%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank0]:2025-12-28 01:24:57,626 -  step: 350  loss:  0.2101  grad_norm:  0.1963  memory: 35.32GiB(74.36%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank0]:2025-12-28 01:28:36,183 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 01:28:40,915 - Avg. fwd time: 13.0188 / Avg. full-bwd time: 27.9696 (Avg. bwd-weight time: 28.8429 / Avg. bwd-input time: 33.6611) / Avg. batch time: 1078.6316 (ms) / GPU bubble ratio: 13.59%
[rank3]:2025-12-28 01:28:40,898 - Avg. fwd time: 7.6717 / Avg. bwd-weight time: 9.7022 / Avg. bwd-input time: 9.5893 / Avg. batch time: 1018.7309 (ms) / GPU bubble ratio: 57.65%
[rank2]:2025-12-28 01:28:40,892 - Avg. fwd time: 7.8540 / Avg. bwd-weight time: 10.0019 / Avg. bwd-input time: 9.8809 / Avg. batch time: 1024.5532 (ms) / GPU bubble ratio: 56.68%
[rank1]:2025-12-28 01:28:40,916 - Avg. fwd time: 9.8788 / Avg. bwd-weight time: 13.1478 / Avg. bwd-input time: 12.4424 / Avg. batch time: 1063.7747 (ms) / GPU bubble ratio: 46.65%
[rank0]:2025-12-28 01:28:40,987 -  step: 400  loss:  0.2044  grad_norm:  0.1733  memory: 35.32GiB(74.36%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank3]:2025-12-28 01:28:40,961 -  step: 400  loss: -4.0000  grad_norm:  0.1733  memory: 15.27GiB(32.13%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank2]:2025-12-28 01:28:40,961 -  step: 400  loss: -4.0000  grad_norm:  0.1733  memory: 13.80GiB(29.05%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank1]:2025-12-28 01:28:40,964 -  step: 400  loss: -4.0000  grad_norm:  0.1733  memory: 17.83GiB(37.53%)  tps: 7,335  tflops: 57.34  mfu: 18.38%
[rank3]:2025-12-28 01:28:41,332 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0128_step400_rank3.svg
[rank3]:			> Batch Time: 1072.34 ms, GPU Bubble Ratio: 13.00%, 46.98%, 58.60%, 59.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-26-197ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 258-27-285ms   | [S7,MB2,F]  285-17-302ms   | [S7,MB2,BI] 315-33-349ms   | [S7,MB2,BW] 349-30-379ms   | [S7,MB3,F]  379-18-397ms   | [S7,MB3,BI] 409-34-443ms   | [S7,MB3,BW] 443-30-473ms   | [S0,MB7,F]  474-9-483ms    | [S0,MB0,B]  484-29-513ms   | [S7,MB4,F]  512-18-530ms   | [S7,MB4,BI] 542-33-576ms   | [S7,MB4,BW] 576-28-604ms   | [S0,MB1,B]  603-28-631ms   | [S7,MB5,F]  631-17-648ms   | [S7,MB5,BI] 661-33-694ms   | [S7,MB5,BW] 694-29-723ms   | [S0,MB2,B]  722-28-750ms   | [S7,MB6,F]  751-17-768ms   | [S7,MB6,BI] 781-33-814ms   | [S7,MB6,BW] 815-29-844ms   | [S0,MB3,B]  843-28-871ms   | [S7,MB7,F]  871-17-888ms   | [S7,MB7,BI] 901-33-934ms   | [S7,MB7,BW] 934-29-964ms   | [S0,MB4,B]  962-28-990ms   | [S0,MB5,B]  990-27-1018ms  | [S0,MB6,B]  1018-28-1046ms | [S0,MB7,B]  1046-26-1072ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-94ms     | [S6,MB0,F]  94-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  278-7-285ms    | [S6,MB2,BI] 349-9-358ms    | [S6,MB2,BW] 358-10-369ms   | [S1,MB6,F]  369-11-380ms   | [S1,MB0,BI] 380-16-396ms   | [S1,MB0,BW] 396-15-412ms   | [S6,MB4,F]  411-8-420ms    | [S6,MB3,BI] 443-10-453ms   | [S6,MB3,BW] 454-9-463ms    | [S1,MB7,F]  484-13-498ms   | [S1,MB1,BI] 498-15-513ms   | [S1,MB1,BW] 513-14-528ms   | [S6,MB5,F]  528-7-536ms    | [S6,MB4,BI] 576-10-586ms   | [S6,MB4,BW] 586-9-596ms    | [S1,MB2,BI] 610-14-625ms   | [S1,MB2,BW] 624-14-639ms   | [S6,MB6,F]  704-7-711ms    | [S6,MB5,BI] 711-9-721ms    | [S6,MB5,BW] 721-10-732ms   | [S1,MB3,BI] 733-14-747ms   | [S1,MB3,BW] 748-14-763ms   | [S6,MB7,F]  824-7-832ms    | [S6,MB6,BI] 831-9-841ms    | [S6,MB6,BW] 841-11-853ms   | [S1,MB4,BI] 853-14-867ms   | [S6,MB7,BI] 934-10-944ms   | [S1,MB5,BI] 945-14-960ms   | [S1,MB4,BW] 960-15-975ms   | [S1,MB6,BI] 976-14-991ms   | [S1,MB5,BW] 990-16-1007ms  | [S1,MB7,BI] 1006-15-1022ms | [S1,MB6,BW] 1022-17-1040ms | [S6,MB7,BW] 1039-11-1051ms | [S1,MB7,BW] 1051-17-1069ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-314ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 358-10-369ms   | [S5,MB2,BW] 369-9-378ms    | [S2,MB6,F]  381-9-391ms    | [S2,MB1,BI] 392-10-403ms   | [S2,MB1,BW] 403-9-413ms    | [S5,MB5,F]  413-7-420ms    | [S5,MB3,BI] 489-10-500ms   | [S5,MB3,BW] 500-11-511ms   | [S2,MB7,F]  511-7-519ms    | [S2,MB2,BI] 519-10-529ms   | [S2,MB2,BW] 529-9-539ms    | [S5,MB6,F]  539-7-546ms    | [S5,MB4,BI] 604-10-614ms   | [S5,MB4,BW] 614-9-624ms    | [S2,MB3,BI] 708-9-717ms    | [S2,MB3,BW] 717-9-727ms    | [S5,MB7,F]  733-7-740ms    | [S5,MB5,BI] 740-9-750ms    | [S5,MB5,BW] 750-9-759ms    | [S2,MB4,BI] 828-9-837ms    | [S5,MB6,BI] 844-10-854ms   | [S2,MB5,BI] 855-10-865ms   | [S5,MB7,BI] 948-9-957ms    | [S2,MB6,BI] 957-10-967ms   | [S2,MB4,BW] 967-10-977ms   | [S2,MB7,BI] 982-9-992ms    | [S2,MB5,BW] 992-10-1002ms  | [S5,MB6,BW] 1002-9-1011ms  | [S5,MB7,BW] 1011-9-1021ms  | [S2,MB6,BW] 1021-9-1031ms  | [S2,MB7,BW] 1031-10-1041ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-306ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 385-11-397ms   | [S4,MB2,BW] 397-9-406ms    | [S3,MB6,F]  406-6-413ms    | [S3,MB2,BI] 413-9-423ms    | [S3,MB2,BW] 423-9-432ms    | [S4,MB6,F]  432-7-440ms    | [S4,MB3,BI] 504-9-514ms    | [S4,MB3,BW] 514-10-524ms   | [S3,MB7,F]  524-7-532ms    | [S3,MB3,BI] 531-9-541ms    | [S3,MB3,BW] 541-9-550ms    | [S4,MB7,F]  550-7-558ms    | [S4,MB4,BI] 701-10-711ms   | [S4,MB4,BW] 711-9-720ms    | [S3,MB4,BI] 720-10-731ms   | [S4,MB5,BI] 821-9-831ms    | [S3,MB5,BI] 831-8-840ms    | [S4,MB6,BI] 855-9-864ms    | [S3,MB6,BI] 864-9-873ms    | [S4,MB7,BI] 958-8-967ms    | [S3,MB7,BI] 967-8-976ms    | [S3,MB4,BW] 976-10-986ms   | [S4,MB5,BW] 986-9-995ms    | [S4,MB6,BW] 995-9-1005ms   | [S4,MB7,BW] 1005-9-1014ms  | [S3,MB5,BW] 1014-9-1024ms  | [S3,MB6,BW] 1024-10-1034ms | [S3,MB7,BW] 1034-10-1044ms
[rank0]:2025-12-28 01:29:06,621 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-28 01:29:06,829 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 01:29:06,823 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 01:29:06,848 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 01:32:19,598 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:32:24,228 - Avg. fwd time: 7.6684 / Avg. bwd-weight time: 9.7023 / Avg. bwd-input time: 9.5920 / Avg. batch time: 1018.3930 (ms) / GPU bubble ratio: 57.64%
[rank2]:2025-12-28 01:32:24,220 - Avg. fwd time: 7.8507 / Avg. bwd-weight time: 10.0005 / Avg. bwd-input time: 9.8827 / Avg. batch time: 1024.2954 (ms) / GPU bubble ratio: 56.68%
[rank0]:2025-12-28 01:32:24,245 - Avg. fwd time: 13.0110 / Avg. full-bwd time: 27.9660 (Avg. bwd-weight time: 28.8362 / Avg. bwd-input time: 33.6487) / Avg. batch time: 1078.4142 (ms) / GPU bubble ratio: 13.60%
[rank0]:2025-12-28 01:32:24,317 -  step: 450  loss:  0.2177  grad_norm:  0.2025  memory: 35.32GiB(74.36%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank3]:2025-12-28 01:32:24,291 -  step: 450  loss: -4.0000  grad_norm:  0.2025  memory: 15.27GiB(32.13%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank1]:2025-12-28 01:32:24,245 - Avg. fwd time: 9.8757 / Avg. bwd-weight time: 13.1497 / Avg. bwd-input time: 12.4454 / Avg. batch time: 1063.5681 (ms) / GPU bubble ratio: 46.64%
[rank1]:2025-12-28 01:32:24,294 -  step: 450  loss: -4.0000  grad_norm:  0.2025  memory: 17.83GiB(37.53%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank2]:2025-12-28 01:32:24,291 -  step: 450  loss: -4.0000  grad_norm:  0.2025  memory: 13.80GiB(29.05%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank0]:2025-12-28 01:36:02,623 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 01:36:07,254 - Avg. fwd time: 7.8482 / Avg. bwd-weight time: 9.9985 / Avg. bwd-input time: 9.8833 / Avg. batch time: 1023.9367 (ms) / GPU bubble ratio: 56.67%
[rank2]:2025-12-28 01:36:07,323 -  step: 500  loss: -4.0000  grad_norm:  0.1881  memory: 13.80GiB(29.05%)  tps: 7,346  tflops: 57.43  mfu: 18.41%
[rank0]:2025-12-28 01:36:07,277 - Avg. fwd time: 13.0056 / Avg. full-bwd time: 27.9629 (Avg. bwd-weight time: 28.8286 / Avg. bwd-input time: 33.6400) / Avg. batch time: 1078.0907 (ms) / GPU bubble ratio: 13.59%
[rank3]:2025-12-28 01:36:07,260 - Avg. fwd time: 7.6662 / Avg. bwd-weight time: 9.7028 / Avg. bwd-input time: 9.5936 / Avg. batch time: 1018.1361 (ms) / GPU bubble ratio: 57.63%
[rank3]:2025-12-28 01:36:07,323 -  step: 500  loss: -4.0000  grad_norm:  0.1881  memory: 15.27GiB(32.13%)  tps: 7,346  tflops: 57.43  mfu: 18.41%
[rank1]:2025-12-28 01:36:07,278 - Avg. fwd time: 9.8730 / Avg. bwd-weight time: 13.1503 / Avg. bwd-input time: 12.4462 / Avg. batch time: 1063.2471 (ms) / GPU bubble ratio: 46.62%
[rank1]:2025-12-28 01:36:07,326 -  step: 500  loss: -4.0000  grad_norm:  0.1881  memory: 17.83GiB(37.53%)  tps: 7,346  tflops: 57.43  mfu: 18.41%
[rank0]:2025-12-28 01:36:07,350 -  step: 500  loss:  0.2100  grad_norm:  0.1881  memory: 35.32GiB(74.36%)  tps: 7,346  tflops: 57.43  mfu: 18.41%
[rank3]:2025-12-28 01:36:07,696 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0136_step500_rank3.svg
[rank3]:			> Batch Time: 1071.38 ms, GPU Bubble Ratio: 13.20%, 47.04%, 58.58%, 59.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 257-27-284ms   | [S7,MB2,F]  284-17-301ms   | [S7,MB2,BI] 314-33-347ms   | [S7,MB2,BW] 347-30-378ms   | [S7,MB3,F]  378-18-396ms   | [S7,MB3,BI] 408-34-442ms   | [S7,MB3,BW] 442-29-471ms   | [S0,MB7,F]  472-9-482ms    | [S0,MB0,B]  482-29-511ms   | [S7,MB4,F]  510-17-528ms   | [S7,MB4,BI] 539-33-573ms   | [S7,MB4,BW] 573-28-602ms   | [S0,MB1,B]  602-28-630ms   | [S7,MB5,F]  629-17-646ms   | [S7,MB5,BI] 658-33-692ms   | [S7,MB5,BW] 692-29-721ms   | [S0,MB2,B]  721-28-749ms   | [S7,MB6,F]  749-17-766ms   | [S7,MB6,BI] 778-33-811ms   | [S7,MB6,BW] 812-29-841ms   | [S0,MB3,B]  841-28-869ms   | [S7,MB7,F]  869-17-886ms   | [S7,MB7,BI] 898-33-931ms   | [S7,MB7,BW] 931-29-961ms   | [S0,MB4,B]  961-28-989ms   | [S0,MB5,B]  989-27-1016ms  | [S0,MB6,B]  1017-28-1045ms | [S0,MB7,B]  1045-26-1071ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-124ms    | [S6,MB0,BI] 171-9-180ms    | [S6,MB0,BW] 180-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 257-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  277-7-285ms    | [S6,MB2,BI] 347-9-357ms    | [S6,MB2,BW] 357-10-368ms   | [S1,MB6,F]  368-10-379ms   | [S1,MB0,BI] 379-16-395ms   | [S1,MB0,BW] 395-15-410ms   | [S6,MB4,F]  410-8-418ms    | [S6,MB3,BI] 442-10-453ms   | [S6,MB3,BW] 453-9-463ms    | [S1,MB7,F]  482-13-496ms   | [S1,MB1,BI] 495-15-511ms   | [S1,MB1,BW] 511-14-526ms   | [S6,MB5,F]  526-7-534ms    | [S6,MB4,BI] 573-10-584ms   | [S6,MB4,BW] 584-9-594ms    | [S1,MB2,BI] 609-14-623ms   | [S1,MB2,BW] 623-14-638ms   | [S6,MB6,F]  701-7-708ms    | [S6,MB5,BI] 709-9-718ms    | [S6,MB5,BW] 718-10-729ms   | [S1,MB3,BI] 731-14-745ms   | [S1,MB3,BW] 745-14-760ms   | [S6,MB7,F]  821-7-828ms    | [S6,MB6,BI] 828-9-838ms    | [S6,MB6,BW] 838-11-850ms   | [S1,MB4,BI] 850-14-865ms   | [S6,MB7,BI] 931-10-942ms   | [S1,MB5,BI] 942-14-957ms   | [S1,MB4,BW] 957-15-973ms   | [S1,MB6,BI] 973-14-988ms   | [S1,MB5,BW] 987-16-1003ms  | [S1,MB7,BI] 1004-15-1019ms | [S1,MB6,BW] 1020-17-1037ms | [S6,MB7,BW] 1037-11-1049ms | [S1,MB7,BW] 1048-17-1065ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-7-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 180-9-189ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-314ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 357-10-367ms   | [S5,MB2,BW] 367-9-377ms    | [S2,MB6,F]  379-9-389ms    | [S2,MB1,BI] 391-10-401ms   | [S2,MB1,BW] 401-9-411ms    | [S5,MB5,F]  411-7-418ms    | [S5,MB3,BI] 487-10-498ms   | [S5,MB3,BW] 498-11-509ms   | [S2,MB7,F]  510-7-517ms    | [S2,MB2,BI] 517-10-527ms   | [S2,MB2,BW] 527-9-537ms    | [S5,MB6,F]  537-7-544ms    | [S5,MB4,BI] 602-10-612ms   | [S5,MB4,BW] 613-9-622ms    | [S2,MB3,BI] 705-9-714ms    | [S2,MB3,BW] 715-9-724ms    | [S5,MB7,F]  731-7-738ms    | [S5,MB5,BI] 739-9-748ms    | [S5,MB5,BW] 748-9-758ms    | [S2,MB4,BI] 825-9-834ms    | [S5,MB6,BI] 843-10-853ms   | [S2,MB5,BI] 853-10-863ms   | [S5,MB7,BI] 945-9-954ms    | [S2,MB6,BI] 954-10-964ms   | [S2,MB4,BW] 965-10-975ms   | [S2,MB7,BI] 980-9-989ms    | [S2,MB5,BW] 989-9-999ms    | [S5,MB6,BW] 999-9-1008ms   | [S5,MB7,BW] 1008-9-1018ms  | [S2,MB6,BW] 1018-9-1028ms  | [S2,MB7,BW] 1028-10-1038ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-241ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 384-11-395ms   | [S4,MB2,BW] 395-9-405ms    | [S3,MB6,F]  405-6-412ms    | [S3,MB2,BI] 412-9-421ms    | [S3,MB2,BW] 421-9-431ms    | [S4,MB6,F]  431-7-438ms    | [S4,MB3,BI] 502-10-512ms   | [S4,MB3,BW] 512-10-522ms   | [S3,MB7,F]  522-7-529ms    | [S3,MB3,BI] 530-9-539ms    | [S3,MB3,BW] 539-9-548ms    | [S4,MB7,F]  548-7-555ms    | [S4,MB4,BI] 698-10-708ms   | [S4,MB4,BW] 709-9-718ms    | [S3,MB4,BI] 718-10-729ms   | [S4,MB5,BI] 818-9-828ms    | [S3,MB5,BI] 828-8-837ms    | [S4,MB6,BI] 854-9-863ms    | [S3,MB6,BI] 863-9-872ms    | [S4,MB7,BI] 955-8-964ms    | [S3,MB7,BI] 964-8-973ms    | [S3,MB4,BW] 973-10-983ms   | [S4,MB5,BW] 983-9-992ms    | [S4,MB6,BW] 993-9-1002ms   | [S4,MB7,BW] 1002-9-1012ms  | [S3,MB5,BW] 1012-9-1021ms  | [S3,MB6,BW] 1021-10-1031ms | [S3,MB7,BW] 1031-10-1041ms
[rank0]:2025-12-28 01:39:45,929 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 01:39:50,622 - Avg. fwd time: 13.0013 / Avg. full-bwd time: 27.9613 (Avg. bwd-weight time: 28.8216 / Avg. bwd-input time: 33.6320) / Avg. batch time: 1077.9619 (ms) / GPU bubble ratio: 13.60%
[rank2]:2025-12-28 01:39:50,597 - Avg. fwd time: 7.8467 / Avg. bwd-weight time: 9.9970 / Avg. bwd-input time: 9.8839 / Avg. batch time: 1023.7697 (ms) / GPU bubble ratio: 56.67%
[rank3]:2025-12-28 01:39:50,604 - Avg. fwd time: 7.6645 / Avg. bwd-weight time: 9.7018 / Avg. bwd-input time: 9.5942 / Avg. batch time: 1017.9073 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-12-28 01:39:50,622 - Avg. fwd time: 9.8708 / Avg. bwd-weight time: 13.1501 / Avg. bwd-input time: 12.4464 / Avg. batch time: 1063.1068 (ms) / GPU bubble ratio: 46.62%
[rank0]:2025-12-28 01:39:50,694 -  step: 550  loss:  0.2211  grad_norm:  0.1807  memory: 35.32GiB(74.36%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank2]:2025-12-28 01:39:50,668 -  step: 550  loss: -4.0000  grad_norm:  0.1807  memory: 13.80GiB(29.05%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank3]:2025-12-28 01:39:50,668 -  step: 550  loss: -4.0000  grad_norm:  0.1807  memory: 15.27GiB(32.13%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank1]:2025-12-28 01:39:50,671 -  step: 550  loss: -4.0000  grad_norm:  0.1807  memory: 17.83GiB(37.53%)  tps: 7,336  tflops: 57.35  mfu: 18.38%
[rank0]:2025-12-28 01:43:29,325 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 01:43:34,020 - Avg. fwd time: 7.8454 / Avg. bwd-weight time: 9.9950 / Avg. bwd-input time: 9.8841 / Avg. batch time: 1023.6516 (ms) / GPU bubble ratio: 56.67%
[rank3]:2025-12-28 01:43:34,027 - Avg. fwd time: 7.6636 / Avg. bwd-weight time: 9.7008 / Avg. bwd-input time: 9.5948 / Avg. batch time: 1017.8684 (ms) / GPU bubble ratio: 57.62%
[rank2]:2025-12-28 01:43:34,089 -  step: 600  loss: -4.0000  grad_norm:  0.1811  memory: 13.80GiB(29.05%)  tps: 7,333  tflops: 57.33  mfu: 18.37%
[rank1]:2025-12-28 01:43:34,044 - Avg. fwd time: 9.8692 / Avg. bwd-weight time: 13.1493 / Avg. bwd-input time: 12.4463 / Avg. batch time: 1063.0197 (ms) / GPU bubble ratio: 46.62%
[rank1]:2025-12-28 01:43:34,092 -  step: 600  loss: -4.0000  grad_norm:  0.1811  memory: 17.83GiB(37.53%)  tps: 7,333  tflops: 57.33  mfu: 18.37%
[rank0]:2025-12-28 01:43:34,043 - Avg. fwd time: 13.0007 / Avg. full-bwd time: 27.9631 (Avg. bwd-weight time: 28.8219 / Avg. bwd-input time: 33.6302) / Avg. batch time: 1077.8857 (ms) / GPU bubble ratio: 13.60%
[rank0]:2025-12-28 01:43:34,115 -  step: 600  loss:  0.2127  grad_norm:  0.1811  memory: 35.32GiB(74.36%)  tps: 7,333  tflops: 57.33  mfu: 18.37%
[rank3]:2025-12-28 01:43:34,089 -  step: 600  loss: -4.0000  grad_norm:  0.1811  memory: 15.27GiB(32.13%)  tps: 7,333  tflops: 57.33  mfu: 18.37%
[rank3]:2025-12-28 01:43:34,465 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0143_step600_rank3.svg
[rank3]:			> Batch Time: 1072.31 ms, GPU Bubble Ratio: 13.00%, 47.11%, 58.67%, 59.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 258-27-285ms   | [S7,MB2,F]  285-17-302ms   | [S7,MB2,BI] 315-34-349ms   | [S7,MB2,BW] 349-30-379ms   | [S7,MB3,F]  379-18-397ms   | [S7,MB3,BI] 409-34-444ms   | [S7,MB3,BW] 443-30-473ms   | [S0,MB7,F]  473-9-483ms    | [S0,MB0,B]  483-29-512ms   | [S7,MB4,F]  513-18-531ms   | [S7,MB4,BI] 543-33-576ms   | [S7,MB4,BW] 576-29-605ms   | [S0,MB1,B]  604-28-632ms   | [S7,MB5,F]  631-17-648ms   | [S7,MB5,BI] 661-33-694ms   | [S7,MB5,BW] 694-29-723ms   | [S0,MB2,B]  722-28-750ms   | [S7,MB6,F]  749-17-766ms   | [S7,MB6,BI] 778-33-811ms   | [S7,MB6,BW] 812-29-841ms   | [S0,MB3,B]  842-28-870ms   | [S7,MB7,F]  870-17-887ms   | [S7,MB7,BI] 899-33-932ms   | [S7,MB7,BW] 932-29-961ms   | [S0,MB4,B]  961-27-989ms   | [S0,MB5,B]  989-27-1017ms  | [S0,MB6,B]  1017-28-1045ms | [S0,MB7,B]  1046-26-1072ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-180ms    | [S6,MB0,BW] 180-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-278ms   | [S6,MB3,F]  278-7-285ms    | [S6,MB2,BI] 349-9-358ms    | [S6,MB2,BW] 358-10-369ms   | [S1,MB6,F]  369-11-380ms   | [S1,MB0,BI] 380-16-396ms   | [S1,MB0,BW] 396-15-411ms   | [S6,MB4,F]  412-8-420ms    | [S6,MB3,BI] 444-10-454ms   | [S6,MB3,BW] 454-9-464ms    | [S1,MB7,F]  483-13-497ms   | [S1,MB1,BI] 497-15-512ms   | [S1,MB1,BW] 512-14-527ms   | [S6,MB5,F]  527-7-535ms    | [S6,MB4,BI] 576-10-587ms   | [S6,MB4,BW] 587-9-597ms    | [S1,MB2,BI] 611-14-625ms   | [S1,MB2,BW] 625-14-640ms   | [S6,MB6,F]  703-7-711ms    | [S6,MB5,BI] 711-9-720ms    | [S6,MB5,BW] 720-10-731ms   | [S1,MB3,BI] 732-14-747ms   | [S1,MB3,BW] 747-14-761ms   | [S6,MB7,F]  821-7-829ms    | [S6,MB6,BI] 829-9-838ms    | [S6,MB6,BW] 838-11-850ms   | [S1,MB4,BI] 851-14-865ms   | [S6,MB7,BI] 932-10-942ms   | [S1,MB5,BI] 943-14-958ms   | [S1,MB4,BW] 958-15-973ms   | [S1,MB6,BI] 973-14-988ms   | [S1,MB5,BW] 988-16-1004ms  | [S1,MB7,BI] 1004-15-1020ms | [S1,MB6,BW] 1020-17-1037ms | [S6,MB7,BW] 1037-11-1049ms | [S1,MB7,BW] 1049-17-1066ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-7-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 180-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-314ms    | [S5,MB4,F]  315-7-322ms    | [S5,MB2,BI] 358-10-368ms   | [S5,MB2,BW] 368-9-378ms    | [S2,MB6,F]  380-9-390ms    | [S2,MB1,BI] 392-10-402ms   | [S2,MB1,BW] 403-9-412ms    | [S5,MB5,F]  413-7-420ms    | [S5,MB3,BI] 489-10-499ms   | [S5,MB3,BW] 499-11-511ms   | [S2,MB7,F]  511-7-518ms    | [S2,MB2,BI] 518-10-529ms   | [S2,MB2,BW] 528-9-538ms    | [S5,MB6,F]  538-7-546ms    | [S5,MB4,BI] 605-10-615ms   | [S5,MB4,BW] 615-9-625ms    | [S2,MB3,BI] 707-9-716ms    | [S2,MB3,BW] 716-9-726ms    | [S5,MB7,F]  733-7-740ms    | [S5,MB5,BI] 740-9-749ms    | [S5,MB5,BW] 749-9-759ms    | [S2,MB4,BI] 825-9-834ms    | [S5,MB6,BI] 843-10-853ms   | [S2,MB5,BI] 853-10-863ms   | [S5,MB7,BI] 946-9-955ms    | [S2,MB6,BI] 955-10-965ms   | [S2,MB4,BW] 965-10-975ms   | [S2,MB7,BI] 980-9-989ms    | [S2,MB5,BW] 990-9-1000ms   | [S5,MB6,BW] 1000-9-1009ms  | [S5,MB7,BW] 1009-9-1019ms  | [S2,MB6,BW] 1019-9-1028ms  | [S2,MB7,BW] 1028-10-1038ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-241ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 306-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  325-7-332ms    | [S4,MB2,BI] 385-11-396ms   | [S4,MB2,BW] 396-9-406ms    | [S3,MB6,F]  406-7-413ms    | [S3,MB2,BI] 413-9-422ms    | [S3,MB2,BW] 422-9-432ms    | [S4,MB6,F]  432-7-439ms    | [S4,MB3,BI] 503-10-513ms   | [S4,MB3,BW] 513-10-524ms   | [S3,MB7,F]  524-7-531ms    | [S3,MB3,BI] 531-9-540ms    | [S3,MB3,BW] 540-9-550ms    | [S4,MB7,F]  550-7-557ms    | [S4,MB4,BI] 700-10-710ms   | [S4,MB4,BW] 711-9-720ms    | [S3,MB4,BI] 720-10-730ms   | [S4,MB5,BI] 818-9-828ms    | [S3,MB5,BI] 828-8-837ms    | [S4,MB6,BI] 854-9-863ms    | [S3,MB6,BI] 863-9-872ms    | [S4,MB7,BI] 956-8-965ms    | [S3,MB7,BI] 965-8-974ms    | [S3,MB4,BW] 974-10-984ms   | [S4,MB5,BW] 984-9-993ms    | [S4,MB6,BW] 993-9-1003ms   | [S4,MB7,BW] 1003-9-1012ms  | [S3,MB5,BW] 1012-9-1022ms  | [S3,MB6,BW] 1022-10-1032ms | [S3,MB7,BW] 1032-10-1042ms
[rank0]:2025-12-28 01:47:13,230 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:47:17,860 - Avg. fwd time: 7.6630 / Avg. bwd-weight time: 9.7000 / Avg. bwd-input time: 9.5957 / Avg. batch time: 1017.8819 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-12-28 01:47:17,923 -  step: 650  loss: -4.0000  grad_norm:  0.1732  memory: 15.27GiB(32.13%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank0]:2025-12-28 01:47:17,877 - Avg. fwd time: 13.0013 / Avg. full-bwd time: 27.9671 (Avg. bwd-weight time: 28.8223 / Avg. bwd-input time: 33.6299) / Avg. batch time: 1077.9828 (ms) / GPU bubble ratio: 13.60%
[rank1]:2025-12-28 01:47:17,878 - Avg. fwd time: 9.8682 / Avg. bwd-weight time: 13.1488 / Avg. bwd-input time: 12.4465 / Avg. batch time: 1063.1050 (ms) / GPU bubble ratio: 46.63%
[rank1]:2025-12-28 01:47:17,926 -  step: 650  loss: -4.0000  grad_norm:  0.1732  memory: 17.83GiB(37.53%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank2]:2025-12-28 01:47:17,853 - Avg. fwd time: 7.8443 / Avg. bwd-weight time: 9.9931 / Avg. bwd-input time: 9.8843 / Avg. batch time: 1023.7090 (ms) / GPU bubble ratio: 56.67%
[rank2]:2025-12-28 01:47:17,923 -  step: 650  loss: -4.0000  grad_norm:  0.1732  memory: 13.80GiB(29.05%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank0]:2025-12-28 01:47:17,949 -  step: 650  loss:  0.2208  grad_norm:  0.1732  memory: 35.32GiB(74.36%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank0]:2025-12-28 01:50:56,729 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:51:01,375 - Avg. fwd time: 7.6621 / Avg. bwd-weight time: 9.6989 / Avg. bwd-input time: 9.5964 / Avg. batch time: 1017.8972 (ms) / GPU bubble ratio: 57.63%
[rank1]:2025-12-28 01:51:01,394 - Avg. fwd time: 9.8671 / Avg. bwd-weight time: 13.1488 / Avg. bwd-input time: 12.4466 / Avg. batch time: 1063.0831 (ms) / GPU bubble ratio: 46.63%
[rank2]:2025-12-28 01:51:01,368 - Avg. fwd time: 7.8432 / Avg. bwd-weight time: 9.9909 / Avg. bwd-input time: 9.8847 / Avg. batch time: 1023.6516 (ms) / GPU bubble ratio: 56.67%
[rank0]:2025-12-28 01:51:01,394 - Avg. fwd time: 13.0017 / Avg. full-bwd time: 27.9690 (Avg. bwd-weight time: 28.8244 / Avg. bwd-input time: 33.6292) / Avg. batch time: 1077.9541 (ms) / GPU bubble ratio: 13.59%
[rank3]:2025-12-28 01:51:01,440 -  step: 700  loss: -4.0000  grad_norm:  0.1622  memory: 15.27GiB(32.13%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank1]:2025-12-28 01:51:01,443 -  step: 700  loss: -4.0000  grad_norm:  0.1622  memory: 17.83GiB(37.53%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank2]:2025-12-28 01:51:01,440 -  step: 700  loss: -4.0000  grad_norm:  0.1622  memory: 13.80GiB(29.05%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank0]:2025-12-28 01:51:01,466 -  step: 700  loss:  0.1791  grad_norm:  0.1622  memory: 35.32GiB(74.36%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank3]:2025-12-28 01:51:01,808 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0151_step700_rank3.svg
[rank3]:			> Batch Time: 1076.44 ms, GPU Bubble Ratio: 13.23%, 47.29%, 58.80%, 59.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  110-16-126ms   | [S7,MB0,BI] 138-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 258-27-285ms   | [S7,MB2,F]  285-17-302ms   | [S7,MB2,BI] 315-33-349ms   | [S7,MB2,BW] 349-30-379ms   | [S7,MB3,F]  379-18-397ms   | [S7,MB3,BI] 409-34-443ms   | [S7,MB3,BW] 444-29-473ms   | [S0,MB7,F]  474-9-484ms    | [S0,MB0,B]  483-29-513ms   | [S7,MB4,F]  512-18-530ms   | [S7,MB4,BI] 542-33-576ms   | [S7,MB4,BW] 576-29-605ms   | [S0,MB1,B]  604-28-632ms   | [S7,MB5,F]  632-17-650ms   | [S7,MB5,BI] 662-33-695ms   | [S7,MB5,BW] 695-29-724ms   | [S0,MB2,B]  724-28-753ms   | [S7,MB6,F]  752-17-769ms   | [S7,MB6,BI] 782-33-815ms   | [S7,MB6,BW] 815-29-845ms   | [S0,MB3,B]  845-28-873ms   | [S7,MB7,F]  874-17-891ms   | [S7,MB7,BI] 903-33-936ms   | [S7,MB7,BW] 936-29-966ms   | [S0,MB4,B]  966-28-994ms   | [S0,MB5,B]  993-27-1021ms  | [S0,MB6,B]  1022-27-1049ms | [S0,MB7,B]  1050-26-1076ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-124ms    | [S6,MB0,BI] 171-9-180ms    | [S6,MB0,BW] 180-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-277ms   | [S6,MB3,F]  278-7-285ms    | [S6,MB2,BI] 349-9-358ms    | [S6,MB2,BW] 358-10-369ms   | [S1,MB6,F]  369-11-380ms   | [S1,MB0,BI] 380-15-396ms   | [S1,MB0,BW] 396-15-411ms   | [S6,MB4,F]  412-8-420ms    | [S6,MB3,BI] 444-10-454ms   | [S6,MB3,BW] 454-9-464ms    | [S1,MB7,F]  484-13-497ms   | [S1,MB1,BI] 498-15-513ms   | [S1,MB1,BW] 513-14-528ms   | [S6,MB5,F]  528-7-536ms    | [S6,MB4,BI] 576-10-586ms   | [S6,MB4,BW] 586-9-596ms    | [S1,MB2,BI] 611-14-626ms   | [S1,MB2,BW] 625-14-640ms   | [S6,MB6,F]  704-7-712ms    | [S6,MB5,BI] 711-9-721ms    | [S6,MB5,BW] 721-10-732ms   | [S1,MB3,BI] 734-14-748ms   | [S1,MB3,BW] 748-14-763ms   | [S6,MB7,F]  825-7-832ms    | [S6,MB6,BI] 832-9-841ms    | [S6,MB6,BW] 842-11-853ms   | [S1,MB4,BI] 854-14-869ms   | [S6,MB7,BI] 937-10-947ms   | [S1,MB5,BI] 947-14-962ms   | [S1,MB4,BW] 962-15-978ms   | [S1,MB6,BI] 978-14-993ms   | [S1,MB5,BW] 993-16-1009ms  | [S1,MB7,BI] 1009-15-1025ms | [S1,MB6,BW] 1025-17-1042ms | [S6,MB7,BW] 1042-11-1054ms | [S1,MB7,BW] 1053-17-1071ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-7-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 180-9-189ms    | [S5,MB0,BW] 189-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-276ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-314ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 358-10-368ms   | [S5,MB2,BW] 368-9-378ms    | [S2,MB6,F]  381-9-390ms    | [S2,MB1,BI] 392-10-403ms   | [S2,MB1,BW] 403-9-413ms    | [S5,MB5,F]  413-7-420ms    | [S5,MB3,BI] 489-10-499ms   | [S5,MB3,BW] 499-11-511ms   | [S2,MB7,F]  511-7-518ms    | [S2,MB2,BI] 518-10-529ms   | [S2,MB2,BW] 529-9-539ms    | [S5,MB6,F]  539-7-546ms    | [S5,MB4,BI] 605-10-615ms   | [S5,MB4,BW] 615-9-625ms    | [S2,MB3,BI] 708-9-717ms    | [S2,MB3,BW] 717-9-727ms    | [S5,MB7,F]  734-7-741ms    | [S5,MB5,BI] 741-9-751ms    | [S5,MB5,BW] 751-9-760ms    | [S2,MB4,BI] 829-9-838ms    | [S5,MB6,BI] 847-10-857ms   | [S2,MB5,BI] 857-10-867ms   | [S5,MB7,BI] 950-9-959ms    | [S2,MB6,BI] 960-10-970ms   | [S2,MB4,BW] 970-10-980ms   | [S2,MB7,BI] 985-9-994ms    | [S2,MB5,BW] 994-9-1004ms   | [S5,MB6,BW] 1004-9-1014ms  | [S5,MB7,BW] 1014-9-1023ms  | [S2,MB6,BW] 1023-9-1033ms  | [S2,MB7,BW] 1033-10-1043ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  233-7-241ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  324-7-332ms    | [S4,MB2,BI] 385-11-397ms   | [S4,MB2,BW] 397-9-406ms    | [S3,MB6,F]  406-6-413ms    | [S3,MB2,BI] 413-9-423ms    | [S3,MB2,BW] 423-9-432ms    | [S4,MB6,F]  432-7-439ms    | [S4,MB3,BI] 504-10-514ms   | [S4,MB3,BW] 514-10-524ms   | [S3,MB7,F]  524-7-531ms    | [S3,MB3,BI] 531-9-540ms    | [S3,MB3,BW] 540-9-550ms    | [S4,MB7,F]  550-7-557ms    | [S4,MB4,BI] 701-10-711ms   | [S4,MB4,BW] 711-9-721ms    | [S3,MB4,BI] 721-10-731ms   | [S4,MB5,BI] 822-9-832ms    | [S3,MB5,BI] 832-8-841ms    | [S4,MB6,BI] 858-9-867ms    | [S3,MB6,BI] 867-9-876ms    | [S4,MB7,BI] 960-8-969ms    | [S3,MB7,BI] 969-8-978ms    | [S3,MB4,BW] 978-10-988ms   | [S4,MB5,BW] 988-9-997ms    | [S4,MB6,BW] 998-9-1007ms   | [S4,MB7,BW] 1007-9-1017ms  | [S3,MB5,BW] 1017-9-1026ms  | [S3,MB6,BW] 1026-9-1036ms  | [S3,MB7,BW] 1036-10-1046ms
[rank0]:2025-12-28 01:54:40,594 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:54:45,252 - Avg. fwd time: 7.6614 / Avg. bwd-weight time: 9.6978 / Avg. bwd-input time: 9.5969 / Avg. batch time: 1017.9162 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-12-28 01:54:45,252 - Avg. fwd time: 7.8423 / Avg. bwd-weight time: 9.9889 / Avg. bwd-input time: 9.8850 / Avg. batch time: 1023.7067 (ms) / GPU bubble ratio: 56.68%
[rank0]:2025-12-28 01:54:45,270 - Avg. fwd time: 13.0025 / Avg. full-bwd time: 27.9712 (Avg. bwd-weight time: 28.8271 / Avg. bwd-input time: 33.6292) / Avg. batch time: 1078.0486 (ms) / GPU bubble ratio: 13.60%
[rank1]:2025-12-28 01:54:45,271 - Avg. fwd time: 9.8663 / Avg. bwd-weight time: 13.1487 / Avg. bwd-input time: 12.4468 / Avg. batch time: 1063.1704 (ms) / GPU bubble ratio: 46.63%
[rank1]:2025-12-28 01:54:45,319 -  step: 750  loss: -4.0000  grad_norm:  0.1972  memory: 17.83GiB(37.53%)  tps: 7,318  tflops: 57.21  mfu: 18.34%
[rank3]:2025-12-28 01:54:45,316 -  step: 750  loss: -4.0000  grad_norm:  0.1972  memory: 15.27GiB(32.13%)  tps: 7,318  tflops: 57.21  mfu: 18.34%
[rank2]:2025-12-28 01:54:45,316 -  step: 750  loss: -4.0000  grad_norm:  0.1972  memory: 13.80GiB(29.05%)  tps: 7,318  tflops: 57.21  mfu: 18.34%
[rank0]:2025-12-28 01:54:45,342 -  step: 750  loss:  0.2177  grad_norm:  0.1972  memory: 35.32GiB(74.36%)  tps: 7,318  tflops: 57.21  mfu: 18.34%
[rank0]:2025-12-28 01:58:24,168 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 01:58:28,888 - Avg. fwd time: 7.6611 / Avg. bwd-weight time: 9.6968 / Avg. bwd-input time: 9.5975 / Avg. batch time: 1017.9513 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-12-28 01:58:28,882 - Avg. fwd time: 7.8419 / Avg. bwd-weight time: 9.9867 / Avg. bwd-input time: 9.8854 / Avg. batch time: 1023.6773 (ms) / GPU bubble ratio: 56.68%
[rank1]:2025-12-28 01:58:28,906 - Avg. fwd time: 9.8657 / Avg. bwd-weight time: 13.1482 / Avg. bwd-input time: 12.4467 / Avg. batch time: 1063.1711 (ms) / GPU bubble ratio: 46.63%
[rank0]:2025-12-28 01:58:28,903 - Avg. fwd time: 13.0029 / Avg. full-bwd time: 27.9740 (Avg. bwd-weight time: 28.8307 / Avg. bwd-input time: 33.6297) / Avg. batch time: 1078.0576 (ms) / GPU bubble ratio: 13.59%
[rank3]:2025-12-28 01:58:28,949 -  step: 800  loss: -4.0000  grad_norm:  0.1890  memory: 15.27GiB(32.13%)  tps: 7,326  tflops: 57.27  mfu: 18.36%
[rank3]:2025-12-28 01:58:28,949 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1890  tps: 7,769  tflops: 60.73  mfu: 17.69%
[rank3]:2025-12-28 01:58:28,949 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 01:58:28,950 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-28 01:58:28,949 -  step: 800  loss: -4.0000  grad_norm:  0.1890  memory: 13.80GiB(29.05%)  tps: 7,326  tflops: 57.27  mfu: 18.36%
[rank2]:2025-12-28 01:58:28,949 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1890  tps: 7,769  tflops: 60.73  mfu: 17.69%
[rank2]:2025-12-28 01:58:28,949 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 01:58:28,950 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 01:58:28,953 -  step: 800  loss: -4.0000  grad_norm:  0.1890  memory: 17.83GiB(37.53%)  tps: 7,326  tflops: 57.27  mfu: 18.36%
[rank1]:2025-12-28 01:58:28,953 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1890  tps: 7,769  tflops: 60.74  mfu: 17.69%
[rank1]:2025-12-28 01:58:28,953 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 01:58:28,954 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 01:58:28,976 -  step: 800  loss:  0.2240  grad_norm:  0.1890  memory: 35.32GiB(74.36%)  tps: 7,326  tflops: 57.27  mfu: 18.36%
[rank0]:2025-12-28 01:58:28,976 - â„¹ï¸ final step: 800  loss:  0.2240  grad_norm:  0.1890  tps: 7,775  tflops: 60.78  mfu: 17.81%
[rank0]:2025-12-28 01:58:28,977 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 01:58:28,977 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 01:58:31,501 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-28 01:58:31,528 - Destroying the purge thread.
[rank1]:2025-12-28 01:58:31,528 - Destroying the purge thread.
[rank0]:2025-12-28 01:58:31,528 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-28 01:58:31,847 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0158_final800_rank3.svg
[rank3]:			> Batch Time: 1072.34 ms, GPU Bubble Ratio: 12.96%, 47.05%, 58.59%, 59.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-25-196ms   | [S7,MB1,F]  197-15-212ms   | [S7,MB1,BI] 224-33-258ms   | [S7,MB1,BW] 258-27-286ms   | [S7,MB2,F]  285-17-302ms   | [S7,MB2,BI] 315-33-348ms   | [S7,MB2,BW] 349-30-379ms   | [S7,MB3,F]  379-18-397ms   | [S7,MB3,BI] 409-34-443ms   | [S7,MB3,BW] 443-29-473ms   | [S0,MB7,F]  473-9-483ms    | [S0,MB0,B]  483-29-513ms   | [S7,MB4,F]  512-18-530ms   | [S7,MB4,BI] 542-33-576ms   | [S7,MB4,BW] 576-29-605ms   | [S0,MB1,B]  603-28-632ms   | [S7,MB5,F]  631-17-649ms   | [S7,MB5,BI] 661-33-695ms   | [S7,MB5,BW] 695-29-724ms   | [S0,MB2,B]  723-28-751ms   | [S7,MB6,F]  751-17-768ms   | [S7,MB6,BI] 780-33-814ms   | [S7,MB6,BW] 814-29-843ms   | [S0,MB3,B]  842-28-870ms   | [S7,MB7,F]  870-17-887ms   | [S7,MB7,BI] 900-33-933ms   | [S7,MB7,BW] 933-29-962ms   | [S0,MB4,B]  962-28-990ms   | [S0,MB5,B]  990-27-1018ms  | [S0,MB6,B]  1018-28-1046ms | [S0,MB7,B]  1046-26-1072ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-94ms     | [S6,MB0,F]  94-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 171-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-198ms    | [S6,MB1,BI] 258-9-267ms    | [S6,MB1,BW] 267-10-278ms   | [S6,MB3,F]  278-7-285ms    | [S6,MB2,BI] 349-9-358ms    | [S6,MB2,BW] 358-10-369ms   | [S1,MB6,F]  369-11-380ms   | [S1,MB0,BI] 380-16-396ms   | [S1,MB0,BW] 396-15-411ms   | [S6,MB4,F]  411-8-419ms    | [S6,MB3,BI] 444-10-454ms   | [S6,MB3,BW] 454-9-464ms    | [S1,MB7,F]  484-13-497ms   | [S1,MB1,BI] 497-15-513ms   | [S1,MB1,BW] 513-14-528ms   | [S6,MB5,F]  528-7-536ms    | [S6,MB4,BI] 576-10-586ms   | [S6,MB4,BW] 586-9-596ms    | [S1,MB2,BI] 611-14-625ms   | [S1,MB2,BW] 625-14-639ms   | [S6,MB6,F]  704-7-712ms    | [S6,MB5,BI] 711-9-721ms    | [S6,MB5,BW] 721-10-732ms   | [S1,MB3,BI] 733-14-748ms   | [S1,MB3,BW] 748-14-762ms   | [S6,MB7,F]  823-7-831ms    | [S6,MB6,BI] 830-9-840ms    | [S6,MB6,BW] 840-11-852ms   | [S1,MB4,BI] 852-14-866ms   | [S6,MB7,BI] 933-10-944ms   | [S1,MB5,BI] 944-14-959ms   | [S1,MB4,BW] 959-15-974ms   | [S1,MB6,BI] 974-14-989ms   | [S1,MB5,BW] 989-16-1006ms  | [S1,MB7,BI] 1005-15-1021ms | [S1,MB6,BW] 1021-17-1038ms | [S6,MB7,BW] 1038-11-1050ms | [S1,MB7,BW] 1050-17-1067ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-7-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-200ms   | [S5,MB3,F]  200-7-207ms    | [S5,MB1,BI] 267-9-277ms    | [S5,MB1,BW] 276-10-287ms   | [S2,MB5,F]  287-7-295ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-9-315ms    | [S5,MB4,F]  314-7-322ms    | [S5,MB2,BI] 358-10-368ms   | [S5,MB2,BW] 368-9-378ms    | [S2,MB6,F]  380-9-390ms    | [S2,MB1,BI] 392-10-403ms   | [S2,MB1,BW] 403-9-412ms    | [S5,MB5,F]  412-7-420ms    | [S5,MB3,BI] 489-10-499ms   | [S5,MB3,BW] 499-11-511ms   | [S2,MB7,F]  511-7-518ms    | [S2,MB2,BI] 518-10-529ms   | [S2,MB2,BW] 529-9-538ms    | [S5,MB6,F]  538-7-546ms    | [S5,MB4,BI] 604-10-615ms   | [S5,MB4,BW] 615-9-624ms    | [S2,MB3,BI] 708-9-717ms    | [S2,MB3,BW] 717-9-727ms    | [S5,MB7,F]  733-7-740ms    | [S5,MB5,BI] 740-9-750ms    | [S5,MB5,BW] 750-9-759ms    | [S2,MB4,BI] 827-9-836ms    | [S5,MB6,BI] 844-10-854ms   | [S2,MB5,BI] 854-10-864ms   | [S5,MB7,BI] 947-9-956ms    | [S2,MB6,BI] 956-10-966ms   | [S2,MB4,BW] 966-10-976ms   | [S2,MB7,BI] 981-9-991ms    | [S2,MB5,BW] 991-10-1001ms  | [S5,MB6,BW] 1001-9-1010ms  | [S5,MB7,BW] 1010-9-1020ms  | [S2,MB6,BW] 1020-9-1030ms  | [S2,MB7,BW] 1030-10-1040ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 190-8-199ms    | [S4,MB0,BW] 199-9-208ms    | [S3,MB4,F]  208-6-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-9-234ms    | [S4,MB4,F]  234-7-241ms    | [S4,MB1,BI] 277-10-287ms   | [S4,MB1,BW] 287-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 306-9-315ms    | [S3,MB1,BW] 315-9-324ms    | [S4,MB5,F]  325-7-332ms    | [S4,MB2,BI] 385-11-396ms   | [S4,MB2,BW] 396-9-406ms    | [S3,MB6,F]  406-7-413ms    | [S3,MB2,BI] 413-9-422ms    | [S3,MB2,BW] 422-9-432ms    | [S4,MB6,F]  432-7-439ms    | [S4,MB3,BI] 503-10-513ms   | [S4,MB3,BW] 513-10-524ms   | [S3,MB7,F]  524-7-531ms    | [S3,MB3,BI] 531-9-540ms    | [S3,MB3,BW] 540-9-550ms    | [S4,MB7,F]  550-7-557ms    | [S4,MB4,BI] 701-10-711ms   | [S4,MB4,BW] 711-9-721ms    | [S3,MB4,BI] 721-10-731ms   | [S4,MB5,BI] 820-9-830ms    | [S3,MB5,BI] 830-8-839ms    | [S4,MB6,BI] 855-9-864ms    | [S3,MB6,BI] 864-9-873ms    | [S4,MB7,BI] 957-8-966ms    | [S3,MB7,BI] 966-8-975ms    | [S3,MB4,BW] 975-10-985ms   | [S4,MB5,BW] 985-9-994ms    | [S4,MB6,BW] 994-9-1004ms   | [S4,MB7,BW] 1004-9-1013ms  | [S3,MB5,BW] 1013-9-1023ms  | [S3,MB6,BW] 1023-10-1033ms | [S3,MB7,BW] 1033-10-1043ms
[rank2]:2025-12-28 01:58:31,833 - Process group destroyed
[rank1]:2025-12-28 01:58:31,915 - Process group destroyed
[rank3]:2025-12-28 01:58:32,175 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1/pipeline_schedule/251228_0158_thry_final800_rank3.svg
[rank3]:			> Batch Time: 460.00 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-38ms      | [S0,MB4,F]  38-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S7,MB0,F]  67-9-76ms      | [S7,MB0,BI] 76-9-86ms      | [S7,MB0,BW] 86-9-95ms      | [S7,MB1,F]  95-9-105ms     | [S7,MB1,BI] 105-9-114ms    | [S7,MB1,BW] 114-9-124ms    | [S7,MB2,F]  124-9-134ms    | [S7,MB2,BI] 134-9-143ms    | [S7,MB2,BW] 143-9-153ms    | [S7,MB3,F]  153-9-162ms    | [S7,MB3,BI] 162-9-172ms    | [S7,MB3,BW] 172-9-182ms    | [S0,MB7,F]  182-9-191ms    | [S0,MB0,B]  191-19-210ms   | [S7,MB4,F]  210-9-220ms    | [S7,MB4,BI] 220-9-229ms    | [S7,MB4,BW] 229-9-239ms    | [S0,MB1,B]  239-19-258ms   | [S7,MB5,F]  258-9-268ms    | [S7,MB5,BI] 268-9-277ms    | [S7,MB5,BW] 277-9-287ms    | [S0,MB2,B]  287-19-306ms   | [S7,MB6,F]  306-9-316ms    | [S7,MB6,BI] 316-9-325ms    | [S7,MB6,BW] 325-9-335ms    | [S0,MB3,B]  335-19-354ms   | [S7,MB7,F]  354-9-364ms    | [S7,MB7,BI] 364-9-373ms    | [S7,MB7,BW] 373-9-383ms    | [S0,MB4,B]  383-19-402ms   | [S0,MB5,B]  402-19-421ms   | [S0,MB6,B]  421-19-440ms   | [S0,MB7,B]  440-19-459ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-28ms      | [S1,MB2,F]  28-9-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-9-57ms      | [S6,MB0,F]  57-9-67ms      | [S1,MB5,F]  67-9-76ms      | [S6,MB1,F]  76-9-86ms      | [S6,MB0,BI] 86-9-95ms      | [S6,MB0,BW] 95-9-105ms     | [S6,MB2,F]  105-9-114ms    | [S6,MB1,BI] 114-9-124ms    | [S6,MB1,BW] 124-9-134ms    | [S6,MB3,F]  134-9-143ms    | [S6,MB2,BI] 143-9-153ms    | [S6,MB2,BW] 153-9-162ms    | [S1,MB6,F]  162-9-172ms    | [S1,MB0,BI] 172-9-182ms    | [S1,MB0,BW] 182-9-191ms    | [S6,MB4,F]  191-9-201ms    | [S6,MB3,BI] 201-9-210ms    | [S6,MB3,BW] 210-9-220ms    | [S1,MB7,F]  220-9-229ms    | [S1,MB1,BI] 229-9-239ms    | [S1,MB1,BW] 239-9-249ms    | [S6,MB5,F]  249-9-258ms    | [S6,MB4,BI] 258-9-268ms    | [S6,MB4,BW] 268-9-277ms    | [S1,MB2,BI] 277-9-287ms    | [S1,MB2,BW] 287-9-297ms    | [S6,MB6,F]  297-9-306ms    | [S6,MB5,BI] 306-9-316ms    | [S6,MB5,BW] 316-9-325ms    | [S1,MB3,BI] 325-9-335ms    | [S1,MB3,BW] 335-9-344ms    | [S6,MB7,F]  344-9-354ms    | [S6,MB6,BI] 354-9-364ms    | [S6,MB6,BW] 364-9-373ms    | [S1,MB4,BI] 373-9-383ms    | [S6,MB7,BI] 383-9-392ms    | [S1,MB5,BI] 392-9-402ms    | [S1,MB4,BW] 402-9-412ms    | [S1,MB6,BI] 412-9-421ms    | [S1,MB5,BW] 421-9-431ms    | [S1,MB7,BI] 431-9-440ms    | [S1,MB6,BW] 440-9-450ms    | [S6,MB7,BW] 450-9-459ms    | [S1,MB7,BW] 459-9-469ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-28ms      | [S2,MB1,F]  28-9-38ms      | [S2,MB2,F]  38-9-47ms      | [S5,MB0,F]  47-9-57ms      | [S2,MB3,F]  57-9-67ms      | [S5,MB1,F]  67-9-76ms      | [S2,MB4,F]  76-9-86ms      | [S5,MB2,F]  86-9-95ms      | [S5,MB0,BI] 95-9-105ms     | [S5,MB0,BW] 105-9-114ms    | [S5,MB3,F]  114-9-124ms    | [S5,MB1,BI] 124-9-134ms    | [S5,MB1,BW] 134-9-143ms    | [S2,MB5,F]  143-9-153ms    | [S2,MB0,BI] 153-9-162ms    | [S2,MB0,BW] 162-9-172ms    | [S5,MB4,F]  172-9-182ms    | [S5,MB2,BI] 182-9-191ms    | [S5,MB2,BW] 191-9-201ms    | [S2,MB6,F]  201-9-210ms    | [S2,MB1,BI] 210-9-220ms    | [S2,MB1,BW] 220-9-229ms    | [S5,MB5,F]  229-9-239ms    | [S5,MB3,BI] 239-9-249ms    | [S5,MB3,BW] 249-9-258ms    | [S2,MB7,F]  258-9-268ms    | [S2,MB2,BI] 268-9-277ms    | [S2,MB2,BW] 277-9-287ms    | [S5,MB6,F]  287-9-297ms    | [S5,MB4,BI] 297-9-306ms    | [S5,MB4,BW] 306-9-316ms    | [S2,MB3,BI] 316-9-325ms    | [S2,MB3,BW] 325-9-335ms    | [S5,MB7,F]  335-9-344ms    | [S5,MB5,BI] 344-9-354ms    | [S5,MB5,BW] 354-9-364ms    | [S2,MB4,BI] 364-9-373ms    | [S5,MB6,BI] 373-9-383ms    | [S2,MB5,BI] 383-9-392ms    | [S5,MB7,BI] 392-9-402ms    | [S2,MB6,BI] 402-9-412ms    | [S2,MB4,BW] 412-9-421ms    | [S2,MB7,BI] 421-9-431ms    | [S2,MB5,BW] 431-9-440ms    | [S5,MB6,BW] 440-9-450ms    | [S5,MB7,BW] 450-9-459ms    | [S2,MB6,BW] 459-9-469ms    | [S2,MB7,BW] 469-9-479ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-9-38ms      | [S4,MB0,F]  38-9-47ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  57-9-67ms      | [S3,MB2,F]  67-9-76ms      | [S4,MB2,F]  76-9-86ms      | [S3,MB3,F]  86-9-95ms      | [S4,MB3,F]  95-9-105ms     | [S4,MB0,BI] 105-9-114ms    | [S4,MB0,BW] 114-9-124ms    | [S3,MB4,F]  124-9-134ms    | [S3,MB0,BI] 134-9-143ms    | [S3,MB0,BW] 143-9-153ms    | [S4,MB4,F]  153-9-162ms    | [S4,MB1,BI] 162-9-172ms    | [S4,MB1,BW] 172-9-182ms    | [S3,MB5,F]  182-9-191ms    | [S3,MB1,BI] 191-9-201ms    | [S3,MB1,BW] 201-9-210ms    | [S4,MB5,F]  210-9-220ms    | [S4,MB2,BI] 220-9-229ms    | [S4,MB2,BW] 229-9-239ms    | [S3,MB6,F]  239-9-249ms    | [S3,MB2,BI] 249-9-258ms    | [S3,MB2,BW] 258-9-268ms    | [S4,MB6,F]  268-9-277ms    | [S4,MB3,BI] 277-9-287ms    | [S4,MB3,BW] 287-9-297ms    | [S3,MB7,F]  297-9-306ms    | [S3,MB3,BI] 306-9-316ms    | [S3,MB3,BW] 316-9-325ms    | [S4,MB7,F]  325-9-335ms    | [S4,MB4,BI] 335-9-344ms    | [S4,MB4,BW] 344-9-354ms    | [S3,MB4,BI] 354-9-364ms    | [S4,MB5,BI] 364-9-373ms    | [S3,MB5,BI] 373-9-383ms    | [S4,MB6,BI] 383-9-392ms    | [S3,MB6,BI] 392-9-402ms    | [S4,MB7,BI] 402-9-412ms    | [S3,MB7,BI] 412-9-421ms    | [S3,MB4,BW] 421-9-431ms    | [S4,MB5,BW] 431-9-440ms    | [S4,MB6,BW] 440-9-450ms    | [S4,MB7,BW] 450-9-459ms    | [S3,MB5,BW] 459-9-469ms    | [S3,MB6,BW] 469-9-479ms    | [S3,MB7,BW] 479-9-488ms   
[rank3]:2025-12-28 01:58:32,176 - Destroying the purge thread.
[rank3]:2025-12-28 01:58:32,351 - Process group destroyed
[rank0]:2025-12-28 01:58:33,529 - Training completed
[rank0]:2025-12-28 01:58:33,530 - Destroying the purge thread.
[rank0]:wandb: updating run metadata
[rank0]:wandb: uploading history steps 16-16, summary, console lines 74-76
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 4.21465
[rank0]:wandb:               final/avg_loss 0.22401
[rank0]:wandb:             final/avg_mfu(%) 17.80985
[rank0]:wandb:             final/avg_tflops 60.77968
[rank0]:wandb:    final/avg_throughput(tps) 7774.7844
[rank0]:wandb:              final/grad_norm 0.18903
[rank0]:wandb:               final/max_loss 0.22401
[rank0]:wandb:                    grad_norm 0.18903
[rank0]:wandb: loss_metrics/global_avg_loss 0.22401
[rank0]:wandb: loss_metrics/global_max_loss 0.22401
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1227_ZBVZeroBubble_nofreeze_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/1o5pjjhm
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_nofreeze_11_dm1/20251228-0058/wandb/run-20251228_005845-1o5pjjhm/logs
[rank0]:2025-12-28 01:58:34,927 - Process group destroyed
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_ZBVZeroBubble_nofreeze_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.3', 'layers.2'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings'}
[rank0]:Stage 7: Modules to keep: {'norm', 'output', 'layers.15'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
