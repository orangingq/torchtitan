
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 21:02:03 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_1F1B_fullrand7_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-28 21:02:10,007 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:2025-12-28 21:02:10,186 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 21:02:10,188 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-28 21:02:10,288 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank2]:2025-12-28 21:02:10,264 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank0]:2025-12-28 21:02:10,346 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank1]:2025-12-28 21:02:10,504 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 21:02:10,507 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-28 21:02:10,460 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 21:02:10,463 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 21:02:10,577 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 21:02:10,580 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 21:02:10,585 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 21:02:10,586 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-28 21:02:10,971 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 21:02:14,340 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-28 21:02:14,507 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 21:02:14,491 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 21:02:14,618 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 21:02:14,538 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 21:02:14,539 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 21:02:14,562 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 21:02:14,562 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-28 21:02:14,536 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 21:02:14,562 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 21:02:14,563 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-28 21:02:14,657 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 21:02:14,683 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 21:02:14,683 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-28 21:02:14,785 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 21:02:14,785 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 21:02:14,786 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-28 21:02:14,777 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 21:02:14,778 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 21:02:14,779 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-28 21:02:14,884 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 21:02:14,885 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 21:02:14,885 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run gamxgle8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_1F1B_fullrand7_11_dm1/20251228-2102/wandb/run-20251228_210215-gamxgle8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_1F1B_fullrand7_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/gamxgle8
[rank3]:2025-12-28 21:02:17,001 - WandB logging enabled
[rank3]:2025-12-28 21:02:17,001 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 21:02:17,038 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 21:02:17,066 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 21:02:17,066 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-28 21:02:17,260 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 21:02:17,260 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 21:02:17,261 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-12-28 21:02:17,277 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-28 21:02:17,277 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-28 21:02:17,277 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 21:02:17,277 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_1F1B_fullrand7_11_dm1
[rank0]:2025-12-28 21:02:17,277 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 21:02:17,278 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 21:02:17,278 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-28 21:02:19,888 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 21:02:19,888 - Finished loading the checkpoint in 2.61 seconds.
[rank0]:2025-12-28 21:02:19,888 - Training starts at step 1
[rank1]:2025-12-28 21:02:25,142 -  step:  1  loss: -4.0000  grad_norm: 203.0670  memory: 10.58GiB(22.26%)  tps: 3,090  tflops: 24.15  mfu: 7.74%
[rank1]:2025-12-28 21:02:25,143 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 21:02:25,141 -  step:  1  loss: -4.0000  grad_norm: 203.0670  memory:  6.84GiB(14.41%)  tps: 3,126  tflops: 24.43  mfu: 7.83%
[rank2]:2025-12-28 21:02:25,141 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 21:02:25,176 -  step:  1  loss: -4.0000  grad_norm: 203.0670  memory: 13.10GiB(27.57%)  tps: 3,080  tflops: 24.08  mfu: 7.72%
[rank0]:2025-12-28 21:02:25,176 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 21:02:25,151 -  step:  1  loss: 10.6092  grad_norm: 203.0670  memory: 21.88GiB(46.05%)  tps: 4,040  tflops: 31.58  mfu: 10.12%
[rank3]:2025-12-28 21:02:25,152 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 21:06:17,713 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-28 21:06:22,435 - Avg. fwd time: 14.9127 / Avg. bwd time: 35.2922 / Avg. batch time: 1046.4852 (ms) / GPU bubble ratio: 61.62%
[rank3]:2025-12-28 21:06:22,393 - Avg. fwd time: 24.6494 / Avg. bwd time: 80.7054 / Avg. batch time: 988.2558 (ms) / GPU bubble ratio: 14.71%
[rank1]:2025-12-28 21:06:22,487 - Avg. fwd time: 19.6949 / Avg. bwd time: 45.5842 / Avg. batch time: 1119.2938 (ms) / GPU bubble ratio: 53.34%
[rank3]:2025-12-28 21:06:22,568 -  step: 50  loss:  9.8830  grad_norm: 24.1144  memory: 25.79GiB(54.28%)  tps: 6,763  tflops: 52.87  mfu: 16.95%
[rank0]:2025-12-28 21:06:22,535 - Avg. fwd time: 16.0739 / Avg. bwd time: 41.8970 / Avg. batch time: 1185.2564 (ms) / GPU bubble ratio: 60.87%
[rank0]:2025-12-28 21:06:22,572 -  step: 50  loss: -4.0000  grad_norm: 24.1144  memory: 16.87GiB(35.50%)  tps: 6,764  tflops: 52.87  mfu: 16.95%
[rank2]:2025-12-28 21:06:22,556 -  step: 50  loss: -4.0000  grad_norm: 24.1144  memory:  8.66GiB(18.23%)  tps: 6,763  tflops: 52.87  mfu: 16.95%
[rank1]:2025-12-28 21:06:22,560 -  step: 50  loss: -4.0000  grad_norm: 24.1144  memory: 12.86GiB(27.07%)  tps: 6,763  tflops: 52.87  mfu: 16.95%
[rank3]:2025-12-28 21:07:05,751 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-28 21:07:54,222 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-28 21:07:54,624 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-28 21:07:54,674 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-28 21:07:54,718 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-28 21:08:42,851 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-28 21:08:43,407 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-28 21:09:50,697 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-28 21:09:51,130 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-28 21:09:51,169 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-28 21:09:51,160 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-28 21:09:51,166 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.31)/0.31, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-28 21:09:51,335 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2109_max_batch_time.svg
[rank3]:			> Batch Time: 1028.16 ms, GPU Bubble Ratio: 54.55%, 48.81%, 60.65%, 17.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  236-42-278ms   | [S0,MB4,F]  278-15-294ms   | [S0,MB1,B]  341-42-383ms   | [S0,MB5,F]  383-15-399ms   | [S0,MB2,B]  447-42-489ms   | [S0,MB6,F]  489-15-505ms   | [S0,MB3,B]  554-42-596ms   | [S0,MB7,F]  596-15-612ms   | [S0,MB4,B]  662-42-704ms   | [S0,MB5,B]  771-42-813ms   | [S0,MB6,B]  878-42-920ms   | [S0,MB7,B]  986-42-1028ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  190-46-236ms   | [S1,MB3,F]  236-19-255ms   | [S1,MB1,B]  295-45-341ms   | [S1,MB4,F]  341-20-362ms   | [S1,MB2,B]  401-46-447ms   | [S1,MB5,F]  447-20-468ms   | [S1,MB3,B]  508-46-554ms   | [S1,MB6,F]  554-20-574ms   | [S1,MB4,B]  616-45-662ms   | [S1,MB7,F]  662-20-682ms   | [S1,MB5,B]  725-46-771ms   | [S1,MB6,B]  832-45-878ms   | [S1,MB7,B]  940-45-986ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  154-35-190ms   | [S2,MB2,F]  190-14-204ms   | [S2,MB1,B]  259-35-295ms   | [S2,MB3,F]  295-14-310ms   | [S2,MB2,B]  365-35-401ms   | [S2,MB4,F]  401-14-416ms   | [S2,MB3,B]  472-35-508ms   | [S2,MB5,F]  508-14-523ms   | [S2,MB4,B]  580-35-616ms   | [S2,MB6,F]  616-15-631ms   | [S2,MB5,B]  689-35-725ms   | [S2,MB7,F]  725-15-740ms   | [S2,MB6,B]  797-35-832ms   | [S2,MB7,B]  904-35-940ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-77-154ms    AFR(10):0.9655 | [S3,MB1,F]  154-24-178ms   | [S3,MB1,B]  178-81-259ms   AFR(10):0.9655 | [S3,MB2,F]  259-24-284ms   | [S3,MB2,B]  284-81-365ms   AFR(10):0.9655 | [S3,MB3,F]  365-25-390ms   | [S3,MB3,B]  390-81-472ms   AFR(10):0.9655 | [S3,MB4,F]  472-24-497ms   | [S3,MB4,B]  497-83-580ms   AFR(10):0.9655 | [S3,MB5,F]  580-25-605ms   | [S3,MB5,B]  605-83-689ms   AFR(10):0.9655 | [S3,MB6,F]  689-24-714ms   | [S3,MB6,B]  714-82-797ms   AFR(10):0.9655 | [S3,MB7,F]  797-24-821ms   | [S3,MB7,B]  821-83-904ms   AFR(10):0.9655
[rank3]:2025-12-28 21:09:51,467 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2109_min_batch_time.svg
[rank3]:			> Batch Time: 644.68 ms, GPU Bubble Ratio: 79.99%, 46.96%, 59.28%, 14.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  158-0-158ms    | [S0,MB4,F]  158-15-174ms   | [S0,MB1,B]  226-0-226ms    | [S0,MB5,F]  226-15-241ms   | [S0,MB2,B]  294-0-294ms    | [S0,MB6,F]  294-15-310ms   | [S0,MB3,B]  364-0-364ms    | [S0,MB7,F]  364-15-380ms   | [S0,MB4,B]  434-0-434ms    | [S0,MB5,B]  505-0-505ms    | [S0,MB6,B]  574-0-574ms    | [S0,MB7,B]  644-0-644ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  135-22-158ms   | [S1,MB3,F]  158-19-178ms   | [S1,MB1,B]  203-22-226ms   | [S1,MB4,F]  226-20-246ms   | [S1,MB2,B]  271-23-294ms   | [S1,MB5,F]  294-20-315ms   | [S1,MB3,B]  341-23-364ms   | [S1,MB6,F]  364-20-385ms   | [S1,MB4,B]  411-22-434ms   | [S1,MB7,F]  434-20-454ms   | [S1,MB5,B]  482-22-505ms   | [S1,MB6,B]  552-22-574ms   | [S1,MB7,B]  621-22-644ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  118-17-135ms   | [S2,MB2,F]  135-14-150ms   | [S2,MB1,B]  185-17-203ms   | [S2,MB3,F]  203-14-218ms   | [S2,MB2,B]  253-17-271ms   | [S2,MB4,F]  271-14-286ms   | [S2,MB3,B]  323-17-341ms   | [S2,MB5,F]  341-14-356ms   | [S2,MB4,B]  393-17-411ms   | [S2,MB6,F]  411-15-426ms   | [S2,MB5,B]  464-17-482ms   | [S2,MB7,F]  482-15-497ms   | [S2,MB6,B]  534-17-552ms   | [S2,MB7,B]  604-17-621ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-41-118ms    AFR(10):0.9655 | [S3,MB1,F]  118-24-142ms   | [S3,MB1,B]  142-43-185ms   AFR(10):0.9655 | [S3,MB2,F]  185-24-209ms   | [S3,MB2,B]  209-43-253ms   AFR(10):0.9655 | [S3,MB3,F]  253-25-279ms   | [S3,MB3,B]  279-44-323ms   AFR(10):0.9655 | [S3,MB4,F]  323-24-348ms   | [S3,MB4,B]  348-45-393ms   AFR(10):0.9655 | [S3,MB5,F]  393-25-419ms   | [S3,MB5,B]  419-45-464ms   AFR(10):0.9655 | [S3,MB6,F]  464-24-489ms   | [S3,MB6,B]  489-44-534ms   AFR(10):0.9655 | [S3,MB7,F]  534-24-558ms   | [S3,MB7,B]  558-45-604ms   AFR(10):0.9655
[rank3]:2025-12-28 21:09:51,614 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2109_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 702.84 ms, GPU Bubble Ratio: 41.37%, 28.38%, 44.96%, 13.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  236-42-278ms   | [S0,MB4,F]  278-15-294ms   | [S0,MB1,B]  302-42-345ms   | [S0,MB5,F]  345-15-360ms   | [S0,MB2,B]  371-42-413ms   | [S0,MB6,F]  413-15-429ms   | [S0,MB3,B]  463-42-505ms   | [S0,MB7,F]  505-15-521ms   | [S0,MB4,B]  533-42-575ms   | [S0,MB5,B]  604-42-646ms   | [S0,MB6,B]  673-29-702ms   | [S0,MB7,B]  702-0-702ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  190-46-236ms   | [S1,MB3,F]  236-19-255ms   | [S1,MB1,B]  256-45-302ms   | [S1,MB4,F]  302-20-323ms   | [S1,MB2,B]  325-46-371ms   | [S1,MB5,F]  371-20-392ms   | [S1,MB3,B]  417-46-463ms   | [S1,MB6,F]  463-20-484ms   | [S1,MB4,B]  487-45-533ms   | [S1,MB7,F]  533-20-553ms   | [S1,MB5,B]  558-46-604ms   | [S1,MB6,B]  627-45-673ms   | [S1,MB7,B]  680-22-702ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  154-35-190ms   | [S2,MB2,F]  190-14-204ms   | [S2,MB1,B]  221-35-256ms   | [S2,MB3,F]  256-14-271ms   | [S2,MB2,B]  289-35-325ms   | [S2,MB4,F]  325-14-340ms   | [S2,MB3,B]  382-35-417ms   | [S2,MB5,F]  417-14-432ms   | [S2,MB4,B]  451-35-487ms   | [S2,MB6,F]  487-15-502ms   | [S2,MB5,B]  522-35-558ms   | [S2,MB7,F]  558-15-573ms   | [S2,MB6,B]  592-35-627ms   | [S2,MB7,B]  662-17-680ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-77-154ms    AFR(10):0.9655 | [S3,MB1,F]  154-24-178ms   | [S3,MB1,B]  178-43-221ms   AFR(10):0.9655 | [S3,MB2,F]  221-24-246ms   | [S3,MB2,B]  246-43-289ms   AFR(10):0.9655 | [S3,MB3,F]  289-25-315ms   | [S3,MB3,B]  315-66-382ms   AFR(10):0.9655 | [S3,MB4,F]  382-24-406ms   | [S3,MB4,B]  406-45-451ms   AFR(10):0.9655 | [S3,MB5,F]  451-25-477ms   | [S3,MB5,B]  477-45-522ms   AFR(10):0.9655 | [S3,MB6,F]  522-24-547ms   | [S3,MB6,B]  547-44-592ms   AFR(10):0.9655 | [S3,MB7,F]  592-24-617ms   | [S3,MB7,B]  617-45-662ms   AFR(10):0.9655
[rank3]:2025-12-28 21:09:51,614 - 	> Batch Time: 702.84 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank3]:2025-12-28 21:09:51,615 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.97(0.00)/0.00, [MB1] 0.97(1.00)/1.00, [MB2] 0.97(1.00)/1.00, [MB3] 0.97(0.40)/0.40, [MB4] 0.97(1.00)/1.00, [MB5] 0.97(1.00)/1.00, [MB6] 0.97(1.00)/1.00, [MB7] 0.97(1.00)/1.00
[rank2]:2025-12-28 21:09:55,076 - Avg. fwd time: 14.8052 / Avg. bwd time: 31.8492 / Avg. batch time: 987.8945 (ms) / GPU bubble ratio: 62.22%
[rank3]:2025-12-28 21:09:55,049 - Avg. fwd time: 24.7646 / Avg. bwd time: 73.6550 / Avg. batch time: 932.6961 (ms) / GPU bubble ratio: 15.58%
[rank1]:2025-12-28 21:09:55,106 - Avg. fwd time: 19.5474 / Avg. bwd time: 41.1177 / Avg. batch time: 1055.6329 (ms) / GPU bubble ratio: 54.03%
[rank0]:2025-12-28 21:09:55,112 - Avg. fwd time: 15.9475 / Avg. bwd time: 33.5112 / Avg. batch time: 1112.4107 (ms) / GPU bubble ratio: 64.43%
[rank2]:2025-12-28 21:09:55,134 -  step: 100  loss: -4.0000  grad_norm:  8.1084  memory:  8.66GiB(18.23%)  tps: 7,707  tflops: 60.25  mfu: 19.31%
[rank3]:2025-12-28 21:09:55,146 -  step: 100  loss:  8.9255  grad_norm:  8.1084  memory: 25.79GiB(54.28%)  tps: 7,707  tflops: 60.25  mfu: 19.31%
[rank1]:2025-12-28 21:09:55,139 -  step: 100  loss: -4.0000  grad_norm:  8.1084  memory: 12.86GiB(27.07%)  tps: 7,707  tflops: 60.25  mfu: 19.31%
[rank1]:2025-12-28 21:09:55,209 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2109_stage1_step100.svg
[rank0]:2025-12-28 21:09:55,149 -  step: 100  loss: -4.0000  grad_norm:  8.1084  memory: 16.87GiB(35.50%)  tps: 7,707  tflops: 60.25  mfu: 19.31%
[rank0]:2025-12-28 21:09:55,209 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2109_stage0_step100.svg
[rank2]:2025-12-28 21:09:55,219 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2109_stage2_step100.svg
[rank3]:2025-12-28 21:09:55,284 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2109_step100_rank3.svg
[rank3]:			> Batch Time: 841.50 ms, GPU Bubble Ratio: 85.40%, 60.44%, 69.38%, 29.96%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-64ms     | [S0,MB0,B]  198-0-198ms    | [S0,MB4,F]  198-14-213ms   | [S0,MB1,B]  284-0-284ms    | [S0,MB5,F]  284-14-299ms   | [S0,MB2,B]  371-0-371ms    | [S0,MB6,F]  371-14-386ms   | [S0,MB3,B]  462-0-462ms    | [S0,MB7,F]  462-14-476ms   | [S0,MB4,B]  564-0-564ms    | [S0,MB5,B]  671-0-671ms    | [S0,MB6,B]  758-0-758ms    | [S0,MB7,B]  841-0-841ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  42-18-61ms     | [S1,MB2,F]  67-18-85ms     | [S1,MB0,B]  168-22-190ms   | [S1,MB3,F]  195-18-213ms   | [S1,MB1,B]  253-23-276ms   | [S1,MB4,F]  281-18-299ms   | [S1,MB2,B]  340-23-363ms   | [S1,MB5,F]  368-18-387ms   | [S1,MB3,B]  431-23-454ms   | [S1,MB6,F]  458-18-477ms   | [S1,MB4,B]  534-22-557ms   | [S1,MB7,F]  561-18-580ms   | [S1,MB5,B]  642-22-665ms   | [S1,MB6,B]  729-22-751ms   | [S1,MB7,B]  812-22-835ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  139-17-157ms   | [S2,MB2,F]  164-14-178ms   | [S2,MB1,B]  225-17-243ms   | [S2,MB3,F]  250-14-265ms   | [S2,MB2,B]  313-17-331ms   | [S2,MB4,F]  338-14-352ms   | [S2,MB3,B]  402-17-420ms   | [S2,MB5,F]  427-14-441ms   | [S2,MB4,B]  506-17-524ms   | [S2,MB6,F]  531-14-545ms   | [S2,MB5,B]  615-17-633ms   | [S2,MB7,F]  639-14-653ms   | [S2,MB6,B]  705-17-723ms   | [S2,MB7,B]  788-17-806ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-41-129ms    | [S3,MB1,F]  136-23-160ms   | [S3,MB1,B]  171-43-215ms   | [S3,MB2,F]  222-24-247ms   | [S3,MB2,B]  259-44-303ms   | [S3,MB3,F]  310-25-336ms   | [S3,MB3,B]  348-44-392ms   | [S3,MB4,F]  399-25-425ms   | [S3,MB4,B]  436-62-498ms   | [S3,MB5,F]  503-26-529ms   | [S3,MB5,B]  541-63-604ms   | [S3,MB6,F]  612-26-638ms   | [S3,MB6,B]  650-45-695ms   | [S3,MB7,F]  702-26-728ms   | [S3,MB7,B]  739-43-783ms  
[rank3]:2025-12-28 21:09:55,326 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2109_stage3_step100.svg
[rank2]:2025-12-28 21:09:55,375 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2109_rank2_stage2.svg
[rank2]:	> Counts Sum: 23040, Total Sum: 23040 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-28 21:09:55,362 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2109_rank1_stage1.svg
[rank1]:	> Counts Sum: 28800, Total Sum: 28800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-28 21:09:55,400 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2109_stage1.svg
[rank0]:2025-12-28 21:09:55,366 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2109_rank0_stage0.svg
[rank0]:	> Counts Sum: 23680, Total Sum: 23680 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-28 21:09:55,404 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2109_stage0.svg
[rank2]:2025-12-28 21:09:55,413 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2109_stage2.svg
[rank3]:2025-12-28 21:09:55,457 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2109_rank3_stage3.svg
[rank3]:	> Counts Sum: 17920, Total Sum: 18560 (96.55%), Ratio(%) per element: [100.0, 93.75, 93.75, 100.0, 93.75, 100.0, 87.5, 100.0, 87.5, 100.0, 100.0, 87.5, 93.75, 100.0, 100.0, 100.0, 93.75, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 87.5, 100.0, 100.0, 87.5]
[rank3]:2025-12-28 21:09:55,495 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2109_stage3.svg
[rank3]:2025-12-28 21:13:15,121 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.59(0.67)/1.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.24(0.27)/0.40, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-28 21:13:15,433 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-28 21:13:15,471 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank0]:2025-12-28 21:13:15,497 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 21:13:15,498 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.19(0.21)/0.31, [MB7] 0.59(0.67)/1.00
[rank3]:2025-12-28 21:13:19,475 - Avg. fwd time: 24.8354 / Avg. bwd time: 69.5143 / Avg. batch time: 901.7352 (ms) / GPU bubble ratio: 16.30%
[rank2]:2025-12-28 21:13:19,504 - Avg. fwd time: 14.9128 / Avg. bwd time: 32.7339 / Avg. batch time: 954.5781 (ms) / GPU bubble ratio: 60.07%
[rank1]:2025-12-28 21:13:19,541 - Avg. fwd time: 19.6794 / Avg. bwd time: 42.4330 / Avg. batch time: 1019.3825 (ms) / GPU bubble ratio: 51.25%
[rank1]:2025-12-28 21:13:19,592 -  step: 150  loss: -4.0000  grad_norm: 12.2680  memory: 12.86GiB(27.07%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank0]:2025-12-28 21:13:19,567 - Avg. fwd time: 16.0414 / Avg. bwd time: 35.5046 / Avg. batch time: 1073.2345 (ms) / GPU bubble ratio: 61.58%
[rank2]:2025-12-28 21:13:19,589 -  step: 150  loss: -4.0000  grad_norm: 12.2680  memory:  8.66GiB(18.23%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank3]:2025-12-28 21:13:19,601 -  step: 150  loss:  4.3358  grad_norm: 12.2680  memory: 25.79GiB(54.28%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank0]:2025-12-28 21:13:19,603 -  step: 150  loss: -4.0000  grad_norm: 12.2680  memory: 16.87GiB(35.50%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank3]:2025-12-28 21:16:26,436 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.38(0.40)/0.40, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-28 21:16:26,806 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-28 21:16:26,835 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-28 21:16:26,845 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 21:16:26,846 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.31)/0.31, [MB7] 0.95(1.00)/1.00
[rank3]:2025-12-28 21:16:30,432 - Avg. fwd time: 24.9287 / Avg. bwd time: 65.9507 / Avg. batch time: 874.3659 (ms) / GPU bubble ratio: 16.85%
[rank2]:2025-12-28 21:16:30,460 - Avg. fwd time: 14.9753 / Avg. bwd time: 33.0918 / Avg. batch time: 925.0325 (ms) / GPU bubble ratio: 58.43%
[rank2]:2025-12-28 21:16:30,519 -  step: 200  loss: -4.0000  grad_norm:  4.5060  memory:  8.66GiB(18.23%)  tps: 8,581  tflops: 67.08  mfu: 21.50%
[rank3]:2025-12-28 21:16:30,531 -  step: 200  loss:  1.3526  grad_norm:  4.5060  memory: 25.79GiB(54.28%)  tps: 8,581  tflops: 67.08  mfu: 21.50%
[rank1]:2025-12-28 21:16:30,491 - Avg. fwd time: 19.8053 / Avg. bwd time: 43.0992 / Avg. batch time: 987.2614 (ms) / GPU bubble ratio: 49.03%
[rank1]:2025-12-28 21:16:30,523 -  step: 200  loss: -4.0000  grad_norm:  4.5060  memory: 12.86GiB(27.07%)  tps: 8,581  tflops: 67.08  mfu: 21.50%
[rank0]:2025-12-28 21:16:30,497 - Avg. fwd time: 16.1212 / Avg. bwd time: 36.1206 / Avg. batch time: 1036.9726 (ms) / GPU bubble ratio: 59.70%
[rank0]:2025-12-28 21:16:30,534 -  step: 200  loss: -4.0000  grad_norm:  4.5060  memory: 16.87GiB(35.50%)  tps: 8,581  tflops: 67.08  mfu: 21.50%
[rank2]:2025-12-28 21:16:30,586 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2116_stage2_step200.svg
[rank1]:2025-12-28 21:16:30,584 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2116_stage1_step200.svg
[rank0]:2025-12-28 21:16:30,582 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2116_stage0_step200.svg
[rank3]:2025-12-28 21:16:30,677 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2116_step200_rank3.svg
[rank3]:			> Batch Time: 882.95 ms, GPU Bubble Ratio: 51.42%, 40.23%, 55.19%, 31.15%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  276-42-318ms   | [S0,MB4,F]  319-15-334ms   | [S0,MB1,B]  367-42-409ms   | [S0,MB5,F]  409-16-426ms   | [S0,MB2,B]  462-42-504ms   | [S0,MB6,F]  505-16-521ms   | [S0,MB3,B]  559-42-602ms   | [S0,MB7,F]  602-16-618ms   | [S0,MB4,B]  651-42-693ms   | [S0,MB5,B]  741-42-783ms   | [S0,MB6,B]  824-33-857ms   | [S0,MB7,B]  874-8-882ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-46-268ms   | [S1,MB3,F]  272-20-292ms   | [S1,MB1,B]  310-47-358ms   | [S1,MB4,F]  364-21-385ms   | [S1,MB2,B]  400-50-450ms   | [S1,MB5,F]  459-20-480ms   | [S1,MB3,B]  504-47-551ms   | [S1,MB6,F]  556-21-577ms   | [S1,MB4,B]  593-49-643ms   | [S1,MB7,F]  647-22-670ms   | [S1,MB5,B]  683-50-734ms   | [S1,MB6,B]  770-46-816ms   | [S1,MB7,B]  842-25-867ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  175-36-211ms   | [S2,MB2,F]  218-14-233ms   | [S2,MB1,B]  264-36-300ms   | [S2,MB3,F]  307-15-323ms   | [S2,MB2,B]  353-36-390ms   | [S2,MB4,F]  397-15-412ms   | [S2,MB3,B]  457-36-493ms   | [S2,MB5,F]  500-15-516ms   | [S2,MB4,B]  546-36-583ms   | [S2,MB6,F]  590-15-606ms   | [S2,MB5,B]  636-36-672ms   | [S2,MB7,F]  680-15-695ms   | [S2,MB6,B]  727-36-764ms   | [S2,MB7,B]  816-19-835ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-165ms    | [S3,MB1,F]  172-24-196ms   | [S3,MB1,B]  207-45-253ms   | [S3,MB2,F]  261-25-286ms   | [S3,MB2,B]  298-45-343ms   | [S3,MB3,F]  350-26-376ms   | [S3,MB3,B]  388-55-444ms   | [S3,MB4,F]  454-24-479ms   | [S3,MB4,B]  491-45-536ms   | [S3,MB5,F]  543-26-569ms   | [S3,MB5,B]  581-44-625ms   | [S3,MB6,F]  633-26-659ms   | [S3,MB6,B]  671-45-716ms   | [S3,MB7,F]  724-26-750ms   | [S3,MB7,B]  762-46-808ms  
[rank3]:2025-12-28 21:16:30,721 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2116_stage3_step200.svg
[rank1]:2025-12-28 21:16:30,740 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2116_rank1_stage1.svg
[rank1]:	> Counts Sum: 41400, Total Sum: 172800 (23.96%), Ratio(%) per element: [22.91, 23.95, 23.95, 26.04, 22.91, 22.91, 22.91, 23.95, 23.95, 21.87, 21.87, 23.95, 22.91, 23.95, 23.95, 25.0, 23.95, 23.95, 22.91, 26.04, 21.87, 22.91, 25.0, 25.0, 26.04, 23.95, 25.0, 23.95, 21.87, 25.0, 22.91, 25.0, 25.0, 25.0, 23.95, 23.95, 22.91, 26.04, 26.04, 23.95, 23.95, 22.91, 22.91, 23.95, 25.0]
[rank0]:2025-12-28 21:16:30,736 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2116_rank0_stage0.svg
[rank0]:	> Counts Sum: 37280, Total Sum: 142080 (26.24%), Ratio(%) per element: [27.08, 30.2, 29.16, 27.08, 31.25, 31.25, 27.08, 28.12, 32.29, 26.04, 27.08, 27.08, 30.2, 27.08, 29.16, 26.04, 27.08, 28.12, 27.08, 30.2, 25.0, 25.0, 26.04, 26.04, 25.0, 19.79, 25.0, 25.0, 25.0, 21.87, 20.83, 26.04, 25.0, 20.83, 21.87, 21.87, 21.87]
[rank2]:2025-12-28 21:16:30,738 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2116_rank2_stage2.svg
[rank2]:	> Counts Sum: 33120, Total Sum: 138240 (23.96%), Ratio(%) per element: [25.0, 25.0, 23.95, 22.91, 21.87, 26.04, 23.95, 23.95, 25.0, 26.04, 25.0, 23.95, 26.04, 22.91, 25.0, 22.91, 22.91, 23.95, 22.91, 21.87, 25.0, 21.87, 23.95, 23.95, 23.95, 26.04, 23.95, 23.95, 22.91, 21.87, 22.91, 25.0, 25.0, 22.91, 23.95, 23.95]
[rank2]:2025-12-28 21:16:30,901 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2116_stage2.svg
[rank3]:2025-12-28 21:16:30,852 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2116_rank3_stage3.svg
[rank3]:	> Counts Sum: 69680, Total Sum: 111360 (62.57%), Ratio(%) per element: [63.54, 58.33, 60.41, 59.37, 57.29, 65.62, 65.62, 65.62, 61.45, 65.62, 64.58, 69.79, 63.54, 63.54, 66.66, 59.37, 62.5, 59.37, 56.25, 58.33, 64.58, 63.54, 57.29, 62.5, 66.66, 61.45, 58.33, 66.66, 66.66]
[rank1]:2025-12-28 21:16:30,903 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2116_stage1.svg
[rank0]:2025-12-28 21:16:30,898 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2116_stage0.svg
[rank3]:2025-12-28 21:16:31,015 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2116_stage3.svg
[rank3]:2025-12-28 21:19:27,550 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 0.41(0.40)/0.40, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-28 21:19:27,908 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-28 21:19:27,939 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-28 21:19:27,936 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-28 21:19:27,940 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.31)/0.31, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-28 21:19:31,467 - Avg. fwd time: 25.0078 / Avg. bwd time: 63.0793 / Avg. batch time: 851.7748 (ms) / GPU bubble ratio: 17.27%
[rank2]:2025-12-28 21:19:31,495 - Avg. fwd time: 15.0291 / Avg. bwd time: 33.2788 / Avg. batch time: 900.5020 (ms) / GPU bubble ratio: 57.08%
[rank2]:2025-12-28 21:19:31,554 -  step: 250  loss: -4.0000  grad_norm:  2.3438  memory:  8.66GiB(18.23%)  tps: 9,050  tflops: 70.75  mfu: 22.68%
[rank0]:2025-12-28 21:19:31,532 - Avg. fwd time: 16.1666 / Avg. bwd time: 36.1657 / Avg. batch time: 1004.9577 (ms) / GPU bubble ratio: 58.34%
[rank0]:2025-12-28 21:19:31,569 -  step: 250  loss: -4.0000  grad_norm:  2.3438  memory: 16.87GiB(35.50%)  tps: 9,050  tflops: 70.75  mfu: 22.68%
[rank1]:2025-12-28 21:19:31,525 - Avg. fwd time: 19.9571 / Avg. bwd time: 43.5400 / Avg. batch time: 960.4901 (ms) / GPU bubble ratio: 47.11%
[rank1]:2025-12-28 21:19:31,560 -  step: 250  loss: -4.0000  grad_norm:  2.3438  memory: 12.86GiB(27.07%)  tps: 9,050  tflops: 70.75  mfu: 22.68%
[rank3]:2025-12-28 21:19:31,567 -  step: 250  loss:  0.4352  grad_norm:  2.3438  memory: 25.79GiB(54.28%)  tps: 9,050  tflops: 70.75  mfu: 22.68%
[rank3]:2025-12-28 21:22:27,120 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 0.41(0.40)/0.40, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-28 21:22:27,481 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-28 21:22:27,510 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-28 21:22:27,512 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 21:22:27,513 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.31)/0.31, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-28 21:22:31,076 - Avg. fwd time: 15.0719 / Avg. bwd time: 33.4098 / Avg. batch time: 883.1123 (ms) / GPU bubble ratio: 56.08%
[rank3]:2025-12-28 21:22:31,047 - Avg. fwd time: 25.0402 / Avg. bwd time: 61.0513 / Avg. batch time: 835.7284 (ms) / GPU bubble ratio: 17.59%
[rank0]:2025-12-28 21:22:31,115 - Avg. fwd time: 16.1913 / Avg. bwd time: 36.1732 / Avg. batch time: 982.5926 (ms) / GPU bubble ratio: 57.37%
[rank1]:2025-12-28 21:22:31,107 - Avg. fwd time: 20.0608 / Avg. bwd time: 43.8799 / Avg. batch time: 941.6228 (ms) / GPU bubble ratio: 45.68%
[rank1]:2025-12-28 21:22:31,141 -  step: 300  loss: -4.0000  grad_norm:  0.3093  memory: 12.94GiB(27.24%)  tps: 9,123  tflops: 71.32  mfu: 22.86%
[rank0]:2025-12-28 21:22:31,152 -  step: 300  loss: -4.0000  grad_norm:  0.3093  memory: 17.26GiB(36.33%)  tps: 9,123  tflops: 71.32  mfu: 22.86%
[rank2]:2025-12-28 21:22:31,137 -  step: 300  loss: -4.0000  grad_norm:  0.3093  memory:  8.66GiB(18.23%)  tps: 9,123  tflops: 71.32  mfu: 22.86%
[rank3]:2025-12-28 21:22:31,150 -  step: 300  loss:  0.2725  grad_norm:  0.3093  memory: 25.79GiB(54.28%)  tps: 9,124  tflops: 71.32  mfu: 22.86%
[rank0]:2025-12-28 21:22:31,200 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2122_stage0_step300.svg
[rank1]:2025-12-28 21:22:31,201 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2122_stage1_step300.svg
[rank2]:2025-12-28 21:22:31,202 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2122_stage2_step300.svg
[rank3]:2025-12-28 21:22:31,299 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2122_step300_rank3.svg
[rank3]:			> Batch Time: 873.50 ms, GPU Bubble Ratio: 52.16%, 39.49%, 54.74%, 29.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  364-42-406ms   | [S0,MB5,F]  406-16-423ms   | [S0,MB2,B]  454-42-497ms   | [S0,MB6,F]  497-16-514ms   | [S0,MB3,B]  567-42-609ms   | [S0,MB7,F]  610-16-626ms   | [S0,MB4,B]  658-42-701ms   | [S0,MB5,B]  749-42-791ms   | [S0,MB6,B]  830-31-861ms   | [S0,MB7,B]  873-0-873ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  271-19-291ms   | [S1,MB1,B]  306-48-355ms   | [S1,MB4,F]  360-21-382ms   | [S1,MB2,B]  395-50-446ms   | [S1,MB5,F]  451-22-473ms   | [S1,MB3,B]  512-47-559ms   | [S1,MB6,F]  564-21-585ms   | [S1,MB4,B]  602-48-651ms   | [S1,MB7,F]  655-21-677ms   | [S1,MB5,B]  690-51-742ms   | [S1,MB6,B]  775-47-823ms   | [S1,MB7,B]  841-24-865ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  172-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  259-36-296ms   | [S2,MB3,F]  303-15-319ms   | [S2,MB2,B]  348-36-384ms   | [S2,MB4,F]  392-15-407ms   | [S2,MB3,B]  466-36-502ms   | [S2,MB5,F]  509-15-524ms   | [S2,MB4,B]  554-36-591ms   | [S2,MB6,F]  599-15-614ms   | [S2,MB5,B]  644-36-680ms   | [S2,MB7,F]  688-15-703ms   | [S2,MB6,B]  732-36-768ms   | [S2,MB7,B]  816-18-834ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-74-162ms    | [S3,MB1,F]  169-23-193ms   | [S3,MB1,B]  206-43-249ms   | [S3,MB2,F]  256-25-282ms   | [S3,MB2,B]  293-43-337ms   | [S3,MB3,F]  344-25-370ms   | [S3,MB3,B]  382-73-455ms   | [S3,MB4,F]  462-25-488ms   | [S3,MB4,B]  500-43-544ms   | [S3,MB5,F]  551-25-577ms   | [S3,MB5,B]  589-43-633ms   | [S3,MB6,F]  640-26-666ms   | [S3,MB6,B]  678-43-722ms   | [S3,MB7,F]  729-25-754ms   | [S3,MB7,B]  766-43-810ms  
[rank0]:2025-12-28 21:22:31,358 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2122_rank0_stage0.svg
[rank0]:	> Counts Sum: 56480, Total Sum: 260480 (21.68%), Ratio(%) per element: [22.15, 25.56, 24.43, 23.86, 25.0, 25.0, 22.72, 23.29, 25.56, 21.59, 21.59, 23.86, 23.29, 23.86, 23.29, 22.72, 21.59, 22.72, 21.59, 23.29, 21.02, 21.59, 21.02, 21.02, 23.29, 16.47, 20.45, 19.88, 20.45, 18.75, 19.31, 21.02, 19.31, 17.61, 17.61, 17.61, 18.75]
[rank1]:2025-12-28 21:22:31,352 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2122_rank1_stage1.svg
[rank1]:	> Counts Sum: 59400, Total Sum: 316800 (18.75%), Ratio(%) per element: [18.18, 18.75, 18.75, 19.88, 18.18, 18.18, 18.18, 18.75, 18.75, 17.61, 17.61, 18.75, 18.18, 18.75, 18.75, 19.31, 18.75, 18.75, 18.18, 19.88, 17.61, 18.18, 19.31, 19.31, 19.88, 18.75, 19.31, 18.75, 17.61, 19.31, 18.18, 19.31, 19.31, 19.31, 18.75, 18.75, 18.18, 19.88, 19.88, 18.75, 18.75, 18.18, 18.18, 18.75, 19.31]
[rank2]:2025-12-28 21:22:31,356 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2122_rank2_stage2.svg
[rank2]:	> Counts Sum: 47520, Total Sum: 253440 (18.75%), Ratio(%) per element: [19.31, 19.31, 18.75, 18.18, 17.61, 19.88, 18.75, 18.75, 19.31, 19.88, 19.31, 18.75, 19.88, 18.18, 19.31, 18.18, 18.18, 18.75, 18.18, 17.61, 19.31, 17.61, 18.75, 18.75, 18.75, 19.88, 18.75, 18.75, 18.18, 17.61, 18.18, 19.31, 19.31, 18.18, 18.75, 18.75]
[rank3]:2025-12-28 21:22:31,343 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2122_stage3_step300.svg
[rank3]:2025-12-28 21:22:31,478 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2122_rank3_stage3.svg
[rank3]:	> Counts Sum: 144080, Total Sum: 204160 (70.57%), Ratio(%) per element: [69.88, 67.61, 68.75, 69.31, 68.75, 74.43, 71.02, 72.15, 70.45, 71.02, 72.15, 75.56, 70.45, 71.59, 72.15, 69.88, 71.02, 68.75, 67.61, 68.75, 71.02, 71.02, 67.61, 69.88, 74.43, 70.45, 67.04, 72.72, 71.02]
[rank0]:2025-12-28 21:22:31,653 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2122_stage0.svg
[rank1]:2025-12-28 21:22:31,651 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2122_stage1.svg
[rank2]:2025-12-28 21:22:31,650 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2122_stage2.svg
[rank3]:2025-12-28 21:22:31,770 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2122_stage3.svg
[rank0]:2025-12-28 21:25:27,585 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 21:25:31,117 - Avg. fwd time: 25.0624 / Avg. bwd time: 59.5971 / Avg. batch time: 824.1991 (ms) / GPU bubble ratio: 17.83%
[rank1]:2025-12-28 21:25:31,177 - Avg. fwd time: 20.1129 / Avg. bwd time: 44.1147 / Avg. batch time: 928.1195 (ms) / GPU bubble ratio: 44.64%
[rank1]:2025-12-28 21:25:31,212 -  step: 350  loss: -4.0000  grad_norm:  0.1574  memory: 12.94GiB(27.24%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank0]:2025-12-28 21:25:31,185 - Avg. fwd time: 16.2093 / Avg. bwd time: 36.1857 / Avg. batch time: 966.5942 (ms) / GPU bubble ratio: 56.64%
[rank0]:2025-12-28 21:25:31,222 -  step: 350  loss: -4.0000  grad_norm:  0.1574  memory: 17.26GiB(36.33%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank2]:2025-12-28 21:25:31,145 - Avg. fwd time: 15.1031 / Avg. bwd time: 33.5017 / Avg. batch time: 870.6605 (ms) / GPU bubble ratio: 55.34%
[rank2]:2025-12-28 21:25:31,207 -  step: 350  loss: -4.0000  grad_norm:  0.1574  memory:  8.66GiB(18.23%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank3]:2025-12-28 21:25:31,219 -  step: 350  loss:  0.2189  grad_norm:  0.1574  memory: 25.79GiB(54.28%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank0]:2025-12-28 21:28:25,726 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 21:28:29,308 - Avg. fwd time: 25.0751 / Avg. bwd time: 58.3986 / Avg. batch time: 814.7492 (ms) / GPU bubble ratio: 18.04%
[rank2]:2025-12-28 21:28:29,336 - Avg. fwd time: 15.1273 / Avg. bwd time: 33.5694 / Avg. batch time: 860.4812 (ms) / GPU bubble ratio: 54.73%
[rank3]:2025-12-28 21:28:29,411 -  step: 400  loss:  0.2092  grad_norm:  0.1550  memory: 25.79GiB(54.28%)  tps: 9,195  tflops: 71.88  mfu: 23.04%
[rank1]:2025-12-28 21:28:29,368 - Avg. fwd time: 20.1541 / Avg. bwd time: 44.3056 / Avg. batch time: 917.1417 (ms) / GPU bubble ratio: 43.77%
[rank1]:2025-12-28 21:28:29,401 -  step: 400  loss: -4.0000  grad_norm:  0.1550  memory: 12.94GiB(27.24%)  tps: 9,195  tflops: 71.88  mfu: 23.04%
[rank2]:2025-12-28 21:28:29,398 -  step: 400  loss: -4.0000  grad_norm:  0.1550  memory:  8.66GiB(18.23%)  tps: 9,195  tflops: 71.88  mfu: 23.04%
[rank0]:2025-12-28 21:28:29,376 - Avg. fwd time: 16.2263 / Avg. bwd time: 36.1853 / Avg. batch time: 953.7489 (ms) / GPU bubble ratio: 56.04%
[rank0]:2025-12-28 21:28:29,412 -  step: 400  loss: -4.0000  grad_norm:  0.1550  memory: 17.26GiB(36.33%)  tps: 9,195  tflops: 71.88  mfu: 23.04%
[rank3]:2025-12-28 21:28:29,560 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2128_step400_rank3.svg
[rank3]:			> Batch Time: 875.00 ms, GPU Bubble Ratio: 52.26%, 39.74%, 54.89%, 29.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  273-42-316ms   | [S0,MB4,F]  316-15-332ms   | [S0,MB1,B]  362-42-405ms   | [S0,MB5,F]  405-16-421ms   | [S0,MB2,B]  453-43-496ms   | [S0,MB6,F]  496-16-512ms   | [S0,MB3,B]  568-42-610ms   | [S0,MB7,F]  610-16-626ms   | [S0,MB4,B]  658-42-701ms   | [S0,MB5,B]  749-42-791ms   | [S0,MB6,B]  830-30-860ms   | [S0,MB7,B]  875-0-875ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  219-46-265ms   | [S1,MB3,F]  270-19-289ms   | [S1,MB1,B]  306-47-354ms   | [S1,MB4,F]  359-21-380ms   | [S1,MB2,B]  394-51-445ms   | [S1,MB5,F]  450-22-472ms   | [S1,MB3,B]  512-47-560ms   | [S1,MB6,F]  564-21-586ms   | [S1,MB4,B]  603-48-651ms   | [S1,MB7,F]  654-21-676ms   | [S1,MB5,B]  691-51-742ms   | [S1,MB6,B]  776-47-823ms   | [S1,MB7,B]  844-24-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  172-36-208ms   | [S2,MB2,F]  215-14-230ms   | [S2,MB1,B]  260-36-296ms   | [S2,MB3,F]  303-15-319ms   | [S2,MB2,B]  347-36-384ms   | [S2,MB4,F]  391-15-407ms   | [S2,MB3,B]  466-35-502ms   | [S2,MB5,F]  509-15-524ms   | [S2,MB4,B]  556-36-592ms   | [S2,MB6,F]  600-15-615ms   | [S2,MB5,B]  645-36-681ms   | [S2,MB7,F]  688-15-704ms   | [S2,MB6,B]  733-36-770ms   | [S2,MB7,B]  818-18-836ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-73-161ms    | [S3,MB1,F]  169-24-193ms   | [S3,MB1,B]  205-43-248ms   | [S3,MB2,F]  257-24-282ms   | [S3,MB2,B]  294-44-338ms   | [S3,MB3,F]  345-26-371ms   | [S3,MB3,B]  382-74-456ms   | [S3,MB4,F]  463-26-489ms   | [S3,MB4,B]  501-43-545ms   | [S3,MB5,F]  553-25-578ms   | [S3,MB5,B]  589-44-633ms   | [S3,MB6,F]  642-26-668ms   | [S3,MB6,B]  680-44-724ms   | [S3,MB7,F]  730-25-756ms   | [S3,MB7,B]  768-44-812ms  
[rank1]:2025-12-28 21:28:29,465 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2128_stage1_step400.svg
[rank2]:2025-12-28 21:28:29,466 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2128_stage2_step400.svg
[rank0]:2025-12-28 21:28:29,465 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2128_stage0_step400.svg
[rank3]:2025-12-28 21:28:29,610 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2128_stage3_step400.svg
[rank1]:2025-12-28 21:28:29,612 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2128_rank1_stage1.svg
[rank1]:	> Counts Sum: 77400, Total Sum: 460800 (16.80%), Ratio(%) per element: [16.4, 16.79, 16.79, 17.57, 16.4, 16.4, 16.4, 16.79, 16.79, 16.01, 16.01, 16.79, 16.4, 16.79, 16.79, 17.18, 16.79, 16.79, 16.4, 17.57, 16.01, 16.4, 17.18, 17.18, 17.57, 16.79, 17.18, 16.79, 16.01, 17.18, 16.4, 17.18, 17.18, 17.18, 16.79, 16.79, 16.4, 17.57, 17.57, 16.79, 16.79, 16.4, 16.4, 16.79, 17.18]
[rank2]:2025-12-28 21:28:29,626 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2128_rank2_stage2.svg
[rank2]:	> Counts Sum: 61920, Total Sum: 368640 (16.80%), Ratio(%) per element: [17.18, 17.18, 16.79, 16.4, 16.01, 17.57, 16.79, 16.79, 17.18, 17.57, 17.18, 16.79, 17.57, 16.4, 17.18, 16.4, 16.4, 16.79, 16.4, 16.01, 17.18, 16.01, 16.79, 16.79, 16.79, 17.57, 16.79, 16.79, 16.4, 16.01, 16.4, 17.18, 17.18, 16.4, 16.79, 16.79]
[rank0]:2025-12-28 21:28:29,618 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2128_rank0_stage0.svg
[rank0]:	> Counts Sum: 75680, Total Sum: 378880 (19.97%), Ratio(%) per element: [20.31, 23.04, 22.65, 22.65, 22.65, 22.26, 22.26, 22.26, 22.65, 19.92, 20.7, 22.65, 21.48, 22.26, 20.7, 21.09, 19.53, 20.31, 19.92, 21.09, 19.14, 19.14, 19.92, 19.92, 20.7, 15.62, 19.53, 17.57, 18.75, 17.57, 18.35, 18.35, 17.18, 16.79, 16.79, 16.01, 17.18]
[rank3]:2025-12-28 21:28:29,746 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2128_rank3_stage3.svg
[rank3]:	> Counts Sum: 218480, Total Sum: 296960 (73.57%), Ratio(%) per element: [73.43, 71.48, 72.26, 73.82, 72.26, 76.17, 75.39, 75.39, 72.65, 73.04, 75.39, 76.56, 73.43, 74.6, 74.6, 72.65, 74.21, 71.48, 72.26, 71.87, 74.21, 73.43, 72.26, 71.87, 76.17, 73.82, 69.92, 75.0, 73.82]
[rank1]:2025-12-28 21:28:30,029 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2128_stage1.svg
[rank2]:2025-12-28 21:28:30,037 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2128_stage2.svg
[rank0]:2025-12-28 21:28:30,037 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2128_stage0.svg
[rank3]:2025-12-28 21:28:30,161 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2128_stage3.svg
[rank3]:2025-12-28 21:28:50,460 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 21:28:50,871 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 21:28:50,872 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 21:28:50,843 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 21:31:25,909 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 21:31:29,346 - Avg. fwd time: 25.0858 / Avg. bwd time: 57.5758 / Avg. batch time: 808.1690 (ms) / GPU bubble ratio: 18.17%
[rank2]:2025-12-28 21:31:29,373 - Avg. fwd time: 15.1449 / Avg. bwd time: 33.6276 / Avg. batch time: 853.3679 (ms) / GPU bubble ratio: 54.28%
[rank0]:2025-12-28 21:31:29,415 - Avg. fwd time: 16.2492 / Avg. bwd time: 36.1774 / Avg. batch time: 944.5736 (ms) / GPU bubble ratio: 55.60%
[rank0]:2025-12-28 21:31:29,452 -  step: 450  loss: -4.0000  grad_norm:  0.1754  memory: 17.26GiB(36.33%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank3]:2025-12-28 21:31:29,450 -  step: 450  loss:  0.2211  grad_norm:  0.1754  memory: 25.79GiB(54.28%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank1]:2025-12-28 21:31:29,406 - Avg. fwd time: 20.1973 / Avg. bwd time: 44.4567 / Avg. batch time: 909.4225 (ms) / GPU bubble ratio: 43.13%
[rank1]:2025-12-28 21:31:29,442 -  step: 450  loss: -4.0000  grad_norm:  0.1754  memory: 12.94GiB(27.24%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank2]:2025-12-28 21:31:29,437 -  step: 450  loss: -4.0000  grad_norm:  0.1754  memory:  8.66GiB(18.23%)  tps: 9,100  tflops: 71.14  mfu: 22.80%
[rank0]:2025-12-28 21:34:23,151 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 21:34:26,669 - Avg. fwd time: 25.0821 / Avg. bwd time: 56.7732 / Avg. batch time: 801.7387 (ms) / GPU bubble ratio: 18.32%
[rank2]:2025-12-28 21:34:26,698 - Avg. fwd time: 15.1590 / Avg. bwd time: 33.6726 / Avg. batch time: 846.4749 (ms) / GPU bubble ratio: 53.85%
[rank1]:2025-12-28 21:34:26,731 - Avg. fwd time: 20.2259 / Avg. bwd time: 44.6020 / Avg. batch time: 902.0525 (ms) / GPU bubble ratio: 42.51%
[rank1]:2025-12-28 21:34:26,766 -  step: 500  loss: -4.0000  grad_norm:  0.1652  memory: 12.94GiB(27.24%)  tps: 9,240  tflops: 72.23  mfu: 23.15%
[rank3]:2025-12-28 21:34:26,775 -  step: 500  loss:  0.2148  grad_norm:  0.1652  memory: 25.79GiB(54.28%)  tps: 9,240  tflops: 72.23  mfu: 23.15%
[rank2]:2025-12-28 21:34:26,762 -  step: 500  loss: -4.0000  grad_norm:  0.1652  memory:  8.66GiB(18.23%)  tps: 9,240  tflops: 72.23  mfu: 23.15%
[rank0]:2025-12-28 21:34:26,740 - Avg. fwd time: 16.2669 / Avg. bwd time: 36.1737 / Avg. batch time: 936.0487 (ms) / GPU bubble ratio: 55.18%
[rank0]:2025-12-28 21:34:26,776 -  step: 500  loss: -4.0000  grad_norm:  0.1652  memory: 17.26GiB(36.33%)  tps: 9,240  tflops: 72.23  mfu: 23.15%
[rank1]:2025-12-28 21:34:26,825 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2134_stage1_step500.svg
[rank2]:2025-12-28 21:34:26,829 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2134_stage2_step500.svg
[rank0]:2025-12-28 21:34:26,824 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2134_stage0_step500.svg
[rank1]:2025-12-28 21:34:26,973 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2134_rank1_stage1.svg
[rank1]:	> Counts Sum: 95400, Total Sum: 604800 (15.77%), Ratio(%) per element: [15.47, 15.77, 15.77, 16.36, 15.47, 15.47, 15.47, 15.77, 15.77, 15.17, 15.17, 15.77, 15.47, 15.77, 15.77, 16.07, 15.77, 15.77, 15.47, 16.36, 15.17, 15.47, 16.07, 16.07, 16.36, 15.77, 16.07, 15.77, 15.17, 16.07, 15.47, 16.07, 16.07, 16.07, 15.77, 15.77, 15.47, 16.36, 16.36, 15.77, 15.77, 15.47, 15.47, 15.77, 16.07]
[rank3]:2025-12-28 21:34:26,921 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2134_step500_rank3.svg
[rank3]:			> Batch Time: 855.00 ms, GPU Bubble Ratio: 50.71%, 37.75%, 53.75%, 31.10%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  273-43-316ms   | [S0,MB4,F]  316-15-332ms   | [S0,MB1,B]  363-42-406ms   | [S0,MB5,F]  406-16-422ms   | [S0,MB2,B]  456-42-499ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  552-42-595ms   | [S0,MB7,F]  595-16-611ms   | [S0,MB4,B]  642-42-685ms   | [S0,MB5,B]  730-42-772ms   | [S0,MB6,B]  811-32-843ms   | [S0,MB7,B]  855-0-855ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  218-46-265ms   | [S1,MB3,F]  269-19-289ms   | [S1,MB1,B]  307-47-355ms   | [S1,MB4,F]  360-21-381ms   | [S1,MB2,B]  395-50-445ms   | [S1,MB5,F]  453-21-474ms   | [S1,MB3,B]  494-48-543ms   | [S1,MB6,F]  549-21-571ms   | [S1,MB4,B]  582-51-634ms   | [S1,MB7,F]  639-22-662ms   | [S1,MB5,B]  670-51-722ms   | [S1,MB6,B]  757-47-804ms   | [S1,MB7,B]  824-24-849ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  172-36-208ms   | [S2,MB2,F]  215-14-230ms   | [S2,MB1,B]  260-36-297ms   | [S2,MB3,F]  304-15-319ms   | [S2,MB2,B]  348-36-384ms   | [S2,MB4,F]  391-15-407ms   | [S2,MB3,B]  447-36-484ms   | [S2,MB5,F]  491-15-506ms   | [S2,MB4,B]  535-36-572ms   | [S2,MB6,F]  579-15-595ms   | [S2,MB5,B]  624-36-660ms   | [S2,MB7,F]  667-15-683ms   | [S2,MB6,B]  714-36-751ms   | [S2,MB7,B]  799-18-817ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-73-162ms    | [S3,MB1,F]  169-24-193ms   | [S3,MB1,B]  206-43-249ms   | [S3,MB2,F]  257-24-282ms   | [S3,MB2,B]  294-43-338ms   | [S3,MB3,F]  344-25-370ms   | [S3,MB3,B]  382-52-435ms   | [S3,MB4,F]  444-24-469ms   | [S3,MB4,B]  481-44-525ms   | [S3,MB5,F]  532-25-558ms   | [S3,MB5,B]  569-43-613ms   | [S3,MB6,F]  620-26-646ms   | [S3,MB6,B]  659-44-703ms   | [S3,MB7,F]  711-25-737ms   | [S3,MB7,B]  748-43-792ms  
[rank3]:2025-12-28 21:34:26,964 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2134_stage3_step500.svg
[rank2]:2025-12-28 21:34:26,994 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2134_rank2_stage2.svg
[rank2]:	> Counts Sum: 76320, Total Sum: 483840 (15.77%), Ratio(%) per element: [16.07, 16.07, 15.77, 15.47, 15.17, 16.36, 15.77, 15.77, 16.07, 16.36, 16.07, 15.77, 16.36, 15.47, 16.07, 15.47, 15.47, 15.77, 15.47, 15.17, 16.07, 15.17, 15.77, 15.77, 15.77, 16.36, 15.77, 15.77, 15.47, 15.17, 15.47, 16.07, 16.07, 15.47, 15.77, 15.77]
[rank0]:2025-12-28 21:34:26,978 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2134_rank0_stage0.svg
[rank0]:	> Counts Sum: 94880, Total Sum: 497280 (19.08%), Ratio(%) per element: [20.23, 21.72, 21.72, 22.02, 21.13, 21.72, 21.42, 20.83, 21.42, 19.64, 20.53, 21.13, 20.23, 20.83, 19.34, 20.23, 19.04, 19.64, 18.45, 20.23, 18.15, 18.45, 19.04, 19.04, 19.64, 15.77, 18.45, 16.36, 17.55, 16.66, 16.96, 17.85, 16.66, 16.36, 15.77, 15.17, 16.36]
[rank3]:2025-12-28 21:34:27,104 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2134_rank3_stage3.svg
[rank3]:	> Counts Sum: 292880, Total Sum: 389760 (75.14%), Ratio(%) per element: [75.89, 73.21, 74.7, 75.29, 74.4, 77.08, 75.89, 77.38, 75.29, 75.29, 75.89, 77.67, 75.0, 75.59, 75.29, 74.7, 75.59, 73.51, 73.8, 73.51, 75.0, 75.0, 74.1, 73.8, 77.08, 74.7, 72.91, 75.89, 75.59]
[rank1]:2025-12-28 21:34:27,519 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2134_stage1.svg
[rank2]:2025-12-28 21:34:27,596 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2134_stage2.svg
[rank0]:2025-12-28 21:34:27,525 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2134_stage0.svg
[rank3]:2025-12-28 21:34:27,645 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2134_stage3.svg
[rank0]:2025-12-28 21:37:23,096 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-28 21:37:26,722 - Avg. fwd time: 20.2423 / Avg. bwd time: 44.6945 / Avg. batch time: 896.8573 (ms) / GPU bubble ratio: 42.08%
[rank3]:2025-12-28 21:37:26,660 - Avg. fwd time: 25.0844 / Avg. bwd time: 56.2156 / Avg. batch time: 797.2878 (ms) / GPU bubble ratio: 18.42%
[rank0]:2025-12-28 21:37:26,731 - Avg. fwd time: 16.2806 / Avg. bwd time: 36.1998 / Avg. batch time: 929.9177 (ms) / GPU bubble ratio: 54.85%
[rank2]:2025-12-28 21:37:26,689 - Avg. fwd time: 15.1692 / Avg. bwd time: 33.7052 / Avg. batch time: 841.6606 (ms) / GPU bubble ratio: 53.54%
[rank1]:2025-12-28 21:37:26,758 -  step: 550  loss: -4.0000  grad_norm:  0.1447  memory: 12.94GiB(27.24%)  tps: 9,103  tflops: 71.16  mfu: 22.81%
[rank3]:2025-12-28 21:37:26,767 -  step: 550  loss:  0.2194  grad_norm:  0.1447  memory: 25.79GiB(54.28%)  tps: 9,103  tflops: 71.16  mfu: 22.81%
[rank0]:2025-12-28 21:37:26,768 -  step: 550  loss: -4.0000  grad_norm:  0.1447  memory: 17.26GiB(36.33%)  tps: 9,103  tflops: 71.16  mfu: 22.81%
[rank2]:2025-12-28 21:37:26,753 -  step: 550  loss: -4.0000  grad_norm:  0.1447  memory:  8.66GiB(18.23%)  tps: 9,103  tflops: 71.16  mfu: 22.81%
[rank0]:2025-12-28 21:40:22,105 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-28 21:40:25,675 - Avg. fwd time: 20.2532 / Avg. bwd time: 44.7604 / Avg. batch time: 892.3714 (ms) / GPU bubble ratio: 41.72%
[rank3]:2025-12-28 21:40:25,614 - Avg. fwd time: 25.0813 / Avg. bwd time: 55.7331 / Avg. batch time: 793.4537 (ms) / GPU bubble ratio: 18.52%
[rank2]:2025-12-28 21:40:25,642 - Avg. fwd time: 15.1771 / Avg. bwd time: 33.7259 / Avg. batch time: 837.5102 (ms) / GPU bubble ratio: 53.29%
[rank0]:2025-12-28 21:40:25,685 - Avg. fwd time: 16.2873 / Avg. bwd time: 36.1864 / Avg. batch time: 924.6427 (ms) / GPU bubble ratio: 54.60%
[rank1]:2025-12-28 21:40:25,710 -  step: 600  loss: -4.0000  grad_norm:  0.1534  memory: 12.94GiB(27.24%)  tps: 9,156  tflops: 71.57  mfu: 22.94%
[rank1]:2025-12-28 21:40:25,772 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2140_stage1_step600.svg
[rank3]:2025-12-28 21:40:25,719 -  step: 600  loss:  0.2135  grad_norm:  0.1534  memory: 25.79GiB(54.28%)  tps: 9,156  tflops: 71.57  mfu: 22.94%
[rank2]:2025-12-28 21:40:25,707 -  step: 600  loss: -4.0000  grad_norm:  0.1534  memory:  8.66GiB(18.23%)  tps: 9,155  tflops: 71.57  mfu: 22.94%
[rank2]:2025-12-28 21:40:25,772 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2140_stage2_step600.svg
[rank0]:2025-12-28 21:40:25,721 -  step: 600  loss: -4.0000  grad_norm:  0.1534  memory: 17.26GiB(36.33%)  tps: 9,155  tflops: 71.57  mfu: 22.94%
[rank0]:2025-12-28 21:40:25,771 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2140_stage0_step600.svg
[rank3]:2025-12-28 21:40:25,866 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2140_step600_rank3.svg
[rank3]:			> Batch Time: 859.00 ms, GPU Bubble Ratio: 51.08%, 38.45%, 54.10%, 30.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  275-42-318ms   | [S0,MB4,F]  318-15-333ms   | [S0,MB1,B]  365-42-407ms   | [S0,MB5,F]  407-16-424ms   | [S0,MB2,B]  456-42-499ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  555-42-597ms   | [S0,MB7,F]  597-16-613ms   | [S0,MB4,B]  644-42-687ms   | [S0,MB5,B]  733-42-775ms   | [S0,MB6,B]  814-33-847ms   | [S0,MB7,B]  859-0-859ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  220-46-267ms   | [S1,MB3,F]  271-19-291ms   | [S1,MB1,B]  308-47-355ms   | [S1,MB4,F]  361-21-383ms   | [S1,MB2,B]  395-50-445ms   | [S1,MB5,F]  453-21-474ms   | [S1,MB3,B]  499-47-547ms   | [S1,MB6,F]  551-21-572ms   | [S1,MB4,B]  585-50-636ms   | [S1,MB7,F]  640-22-663ms   | [S1,MB5,B]  675-51-726ms   | [S1,MB6,B]  760-46-807ms   | [S1,MB7,B]  828-24-852ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  174-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  261-36-297ms   | [S2,MB3,F]  305-15-320ms   | [S2,MB2,B]  348-36-385ms   | [S2,MB4,F]  392-15-407ms   | [S2,MB3,B]  452-36-488ms   | [S2,MB5,F]  496-15-511ms   | [S2,MB4,B]  539-36-575ms   | [S2,MB6,F]  583-15-598ms   | [S2,MB5,B]  628-36-664ms   | [S2,MB7,F]  672-15-687ms   | [S2,MB6,B]  718-36-754ms   | [S2,MB7,B]  803-18-821ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  171-24-195ms   | [S3,MB1,B]  207-43-250ms   | [S3,MB2,F]  258-24-283ms   | [S3,MB2,B]  294-43-338ms   | [S3,MB3,F]  345-25-371ms   | [S3,MB3,B]  382-55-438ms   | [S3,MB4,F]  449-24-474ms   | [S3,MB4,B]  485-43-529ms   | [S3,MB5,F]  536-25-562ms   | [S3,MB5,B]  573-43-617ms   | [S3,MB6,F]  625-25-651ms   | [S3,MB6,B]  663-44-707ms   | [S3,MB7,F]  715-25-740ms   | [S3,MB7,B]  752-43-796ms  
[rank1]:2025-12-28 21:40:25,917 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2140_rank1_stage1.svg
[rank1]:	> Counts Sum: 113400, Total Sum: 748800 (15.14%), Ratio(%) per element: [14.9, 15.14, 15.14, 15.62, 14.9, 14.9, 14.9, 15.14, 15.14, 14.66, 14.66, 15.14, 14.9, 15.14, 15.14, 15.38, 15.14, 15.14, 14.9, 15.62, 14.66, 14.9, 15.38, 15.38, 15.62, 15.14, 15.38, 15.14, 14.66, 15.38, 14.9, 15.38, 15.38, 15.38, 15.14, 15.14, 14.9, 15.62, 15.62, 15.14, 15.14, 14.9, 14.9, 15.14, 15.38]
[rank3]:2025-12-28 21:40:25,910 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2140_stage3_step600.svg
[rank2]:2025-12-28 21:40:25,925 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2140_rank2_stage2.svg
[rank2]:	> Counts Sum: 90720, Total Sum: 599040 (15.14%), Ratio(%) per element: [15.38, 15.38, 15.14, 14.9, 14.66, 15.62, 15.14, 15.14, 15.38, 15.62, 15.38, 15.14, 15.62, 14.9, 15.38, 14.9, 14.9, 15.14, 14.9, 14.66, 15.38, 14.66, 15.14, 15.14, 15.14, 15.62, 15.14, 15.14, 14.9, 14.66, 14.9, 15.38, 15.38, 14.9, 15.14, 15.14]
[rank0]:2025-12-28 21:40:25,925 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2140_rank0_stage0.svg
[rank0]:	> Counts Sum: 114080, Total Sum: 615680 (18.53%), Ratio(%) per element: [19.71, 21.15, 20.91, 20.91, 21.15, 21.15, 20.91, 20.19, 20.91, 19.23, 19.95, 20.43, 19.47, 20.19, 19.23, 19.23, 18.26, 18.75, 18.26, 19.47, 18.02, 18.02, 18.26, 18.5, 18.75, 15.62, 17.78, 16.34, 16.58, 16.1, 16.1, 17.3, 16.34, 15.62, 15.38, 15.38, 15.86]
[rank3]:2025-12-28 21:40:26,042 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2140_rank3_stage3.svg
[rank3]:	> Counts Sum: 367280, Total Sum: 482560 (76.11%), Ratio(%) per element: [76.68, 75.0, 75.48, 76.2, 75.0, 77.64, 76.2, 77.88, 75.96, 76.2, 77.64, 77.64, 76.44, 77.16, 76.68, 75.72, 76.68, 74.27, 75.0, 74.75, 75.72, 75.96, 75.24, 74.27, 77.16, 75.96, 74.75, 77.4, 76.44]
[rank2]:2025-12-28 21:40:26,583 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2140_stage2.svg
[rank0]:2025-12-28 21:40:26,604 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2140_stage0.svg
[rank1]:2025-12-28 21:40:26,584 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2140_stage1.svg
[rank3]:2025-12-28 21:40:26,708 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2140_stage3.svg
[rank0]:2025-12-28 21:43:21,283 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 21:43:24,725 - Avg. fwd time: 25.0801 / Avg. bwd time: 55.3047 / Avg. batch time: 790.0215 (ms) / GPU bubble ratio: 18.60%
[rank2]:2025-12-28 21:43:24,755 - Avg. fwd time: 15.1856 / Avg. bwd time: 33.7465 / Avg. batch time: 833.8253 (ms) / GPU bubble ratio: 53.05%
[rank2]:2025-12-28 21:43:24,820 -  step: 650  loss: -4.0000  grad_norm:  0.1602  memory:  8.66GiB(18.23%)  tps: 9,147  tflops: 71.51  mfu: 22.92%
[rank1]:2025-12-28 21:43:24,788 - Avg. fwd time: 20.2684 / Avg. bwd time: 44.8283 / Avg. batch time: 888.3997 (ms) / GPU bubble ratio: 41.38%
[rank1]:2025-12-28 21:43:24,824 -  step: 650  loss: -4.0000  grad_norm:  0.1602  memory: 12.94GiB(27.24%)  tps: 9,147  tflops: 71.51  mfu: 22.92%
[rank0]:2025-12-28 21:43:24,798 - Avg. fwd time: 16.2919 / Avg. bwd time: 36.1784 / Avg. batch time: 919.9938 (ms) / GPU bubble ratio: 54.37%
[rank0]:2025-12-28 21:43:24,834 -  step: 650  loss: -4.0000  grad_norm:  0.1602  memory: 17.26GiB(36.33%)  tps: 9,147  tflops: 71.51  mfu: 22.92%
[rank3]:2025-12-28 21:43:24,833 -  step: 650  loss:  0.2245  grad_norm:  0.1602  memory: 25.79GiB(54.28%)  tps: 9,147  tflops: 71.51  mfu: 22.92%
[rank0]:2025-12-28 21:46:20,138 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 21:46:23,595 - Avg. fwd time: 25.0888 / Avg. bwd time: 54.9567 / Avg. batch time: 787.2907 (ms) / GPU bubble ratio: 18.66%
[rank2]:2025-12-28 21:46:23,624 - Avg. fwd time: 15.1944 / Avg. bwd time: 33.7694 / Avg. batch time: 830.8683 (ms) / GPU bubble ratio: 52.86%
[rank0]:2025-12-28 21:46:23,668 - Avg. fwd time: 16.2986 / Avg. bwd time: 36.1945 / Avg. batch time: 916.2209 (ms) / GPU bubble ratio: 54.17%
[rank3]:2025-12-28 21:46:23,703 -  step: 700  loss:  0.1828  grad_norm:  0.1224  memory: 25.79GiB(54.28%)  tps: 9,160  tflops: 71.61  mfu: 22.95%
[rank1]:2025-12-28 21:46:23,658 - Avg. fwd time: 20.2812 / Avg. bwd time: 44.8867 / Avg. batch time: 885.2002 (ms) / GPU bubble ratio: 41.10%
[rank1]:2025-12-28 21:46:23,694 -  step: 700  loss: -4.0000  grad_norm:  0.1224  memory: 12.94GiB(27.24%)  tps: 9,160  tflops: 71.61  mfu: 22.95%
[rank2]:2025-12-28 21:46:23,690 -  step: 700  loss: -4.0000  grad_norm:  0.1224  memory:  8.66GiB(18.23%)  tps: 9,160  tflops: 71.61  mfu: 22.95%
[rank2]:2025-12-28 21:46:23,756 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2146_stage2_step700.svg
[rank0]:2025-12-28 21:46:23,705 -  step: 700  loss: -4.0000  grad_norm:  0.1224  memory: 17.26GiB(36.33%)  tps: 9,160  tflops: 71.61  mfu: 22.95%
[rank0]:2025-12-28 21:46:23,756 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2146_stage0_step700.svg
[rank1]:2025-12-28 21:46:23,756 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2146_stage1_step700.svg
[rank3]:2025-12-28 21:46:23,853 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2146_step700_rank3.svg
[rank3]:			> Batch Time: 875.50 ms, GPU Bubble Ratio: 51.65%, 39.57%, 54.86%, 29.62%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  277-43-320ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  365-42-408ms   | [S0,MB5,F]  408-16-425ms   | [S0,MB2,B]  456-43-499ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  570-42-612ms   | [S0,MB7,F]  612-16-628ms   | [S0,MB4,B]  660-42-702ms   | [S0,MB5,B]  750-42-792ms   | [S0,MB6,B]  832-35-867ms   | [S0,MB7,B]  875-0-875ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  222-46-269ms   | [S1,MB3,F]  273-19-293ms   | [S1,MB1,B]  309-47-357ms   | [S1,MB4,F]  362-21-384ms   | [S1,MB2,B]  397-51-448ms   | [S1,MB5,F]  453-22-475ms   | [S1,MB3,B]  513-47-561ms   | [S1,MB6,F]  566-21-587ms   | [S1,MB4,B]  603-48-652ms   | [S1,MB7,F]  656-21-678ms   | [S1,MB5,B]  692-51-743ms   | [S1,MB6,B]  777-47-825ms   | [S1,MB7,B]  844-24-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-212ms   | [S2,MB2,F]  219-14-234ms   | [S2,MB1,B]  262-36-299ms   | [S2,MB3,F]  306-15-322ms   | [S2,MB2,B]  350-36-387ms   | [S2,MB4,F]  394-15-410ms   | [S2,MB3,B]  467-36-503ms   | [S2,MB5,F]  510-15-525ms   | [S2,MB4,B]  556-36-593ms   | [S2,MB6,F]  600-15-616ms   | [S2,MB5,B]  645-36-682ms   | [S2,MB7,F]  689-15-704ms   | [S2,MB6,B]  734-36-771ms   | [S2,MB7,B]  819-18-837ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-165ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  208-43-252ms   | [S3,MB2,F]  259-25-284ms   | [S3,MB2,B]  296-43-340ms   | [S3,MB3,F]  347-26-373ms   | [S3,MB3,B]  384-72-457ms   | [S3,MB4,F]  464-26-490ms   | [S3,MB4,B]  502-43-546ms   | [S3,MB5,F]  553-25-579ms   | [S3,MB5,B]  590-44-634ms   | [S3,MB6,F]  642-26-668ms   | [S3,MB6,B]  680-43-724ms   | [S3,MB7,F]  731-25-757ms   | [S3,MB7,B]  769-44-813ms  
[rank3]:2025-12-28 21:46:23,900 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2146_stage3_step700.svg
[rank1]:2025-12-28 21:46:23,906 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2146_rank1_stage1.svg
[rank1]:	> Counts Sum: 131400, Total Sum: 892800 (14.72%), Ratio(%) per element: [14.51, 14.71, 14.71, 15.12, 14.51, 14.51, 14.51, 14.71, 14.71, 14.31, 14.31, 14.71, 14.51, 14.71, 14.71, 14.91, 14.71, 14.71, 14.51, 15.12, 14.31, 14.51, 14.91, 14.91, 15.12, 14.71, 14.91, 14.71, 14.31, 14.91, 14.51, 14.91, 14.91, 14.91, 14.71, 14.71, 14.51, 15.12, 15.12, 14.71, 14.71, 14.51, 14.51, 14.71, 14.91]
[rank2]:2025-12-28 21:46:23,907 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2146_rank2_stage2.svg
[rank2]:	> Counts Sum: 105120, Total Sum: 714240 (14.72%), Ratio(%) per element: [14.91, 14.91, 14.71, 14.51, 14.31, 15.12, 14.71, 14.71, 14.91, 15.12, 14.91, 14.71, 15.12, 14.51, 14.91, 14.51, 14.51, 14.71, 14.51, 14.31, 14.91, 14.31, 14.71, 14.71, 14.71, 15.12, 14.71, 14.71, 14.51, 14.31, 14.51, 14.91, 14.91, 14.51, 14.71, 14.71]
[rank0]:2025-12-28 21:46:23,913 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2146_rank0_stage0.svg
[rank0]:	> Counts Sum: 133280, Total Sum: 734080 (18.16%), Ratio(%) per element: [19.15, 20.96, 20.56, 20.16, 20.56, 20.56, 20.76, 19.95, 20.56, 19.35, 19.95, 19.75, 18.95, 19.15, 18.75, 18.54, 18.14, 18.54, 17.54, 19.15, 17.54, 17.54, 17.54, 18.34, 18.34, 15.32, 17.13, 15.92, 16.33, 15.72, 15.52, 17.54, 16.12, 15.32, 15.32, 15.12, 15.92]
[rank3]:2025-12-28 21:46:24,032 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2146_rank3_stage3.svg
[rank3]:	> Counts Sum: 441680, Total Sum: 575360 (76.77%), Ratio(%) per element: [77.62, 76.41, 76.2, 76.41, 75.6, 78.02, 77.01, 78.02, 77.01, 77.01, 78.42, 77.62, 77.01, 77.21, 77.01, 76.41, 77.41, 75.0, 76.2, 75.4, 76.61, 76.61, 76.0, 75.4, 77.82, 76.61, 75.0, 77.82, 77.21]
[rank1]:2025-12-28 21:46:24,705 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2146_stage1.svg
[rank2]:2025-12-28 21:46:24,695 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2146_stage2.svg
[rank0]:2025-12-28 21:46:24,723 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2146_stage0.svg
[rank3]:2025-12-28 21:46:24,824 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2146_stage3.svg
[rank0]:2025-12-28 21:49:19,965 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 21:49:23,429 - Avg. fwd time: 25.0912 / Avg. bwd time: 54.6563 / Avg. batch time: 784.8950 (ms) / GPU bubble ratio: 18.72%
[rank2]:2025-12-28 21:49:23,459 - Avg. fwd time: 15.2010 / Avg. bwd time: 33.7885 / Avg. batch time: 828.2920 (ms) / GPU bubble ratio: 52.68%
[rank0]:2025-12-28 21:49:23,503 - Avg. fwd time: 16.3074 / Avg. bwd time: 36.1965 / Avg. batch time: 912.9495 (ms) / GPU bubble ratio: 53.99%
[rank1]:2025-12-28 21:49:23,493 - Avg. fwd time: 20.2954 / Avg. bwd time: 44.9401 / Avg. batch time: 882.4233 (ms) / GPU bubble ratio: 40.86%
[rank1]:2025-12-28 21:49:23,529 -  step: 750  loss: -4.0000  grad_norm:  0.1762  memory: 12.94GiB(27.24%)  tps: 9,111  tflops: 71.22  mfu: 22.83%
[rank3]:2025-12-28 21:49:23,538 -  step: 750  loss:  0.2211  grad_norm:  0.1762  memory: 25.79GiB(54.28%)  tps: 9,111  tflops: 71.22  mfu: 22.83%
[rank2]:2025-12-28 21:49:23,525 -  step: 750  loss: -4.0000  grad_norm:  0.1762  memory:  8.66GiB(18.23%)  tps: 9,111  tflops: 71.22  mfu: 22.83%
[rank0]:2025-12-28 21:49:23,540 -  step: 750  loss: -4.0000  grad_norm:  0.1762  memory: 17.26GiB(36.33%)  tps: 9,111  tflops: 71.22  mfu: 22.83%
[rank0]:2025-12-28 21:52:18,848 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-28 21:52:22,452 - Avg. fwd time: 15.2067 / Avg. bwd time: 33.8042 / Avg. batch time: 826.0666 (ms) / GPU bubble ratio: 52.54%
[rank1]:2025-12-28 21:52:22,486 - Avg. fwd time: 20.3065 / Avg. bwd time: 44.9862 / Avg. batch time: 880.0161 (ms) / GPU bubble ratio: 40.64%
[rank3]:2025-12-28 21:52:22,420 - Avg. fwd time: 25.0931 / Avg. bwd time: 54.4001 / Avg. batch time: 782.8428 (ms) / GPU bubble ratio: 18.76%
[rank0]:2025-12-28 21:52:22,496 - Avg. fwd time: 16.3152 / Avg. bwd time: 36.2001 / Avg. batch time: 910.1076 (ms) / GPU bubble ratio: 53.84%
[rank0]:2025-12-28 21:52:22,533 -  step: 800  loss: -4.0000  grad_norm:  0.1668  memory: 17.26GiB(36.33%)  tps: 9,153  tflops: 71.56  mfu: 22.94%
[rank0]:2025-12-28 21:52:22,533 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1668  tps: 9,260  tflops: 72.39  mfu: 21.19%
[rank0]:2025-12-28 21:52:22,533 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 21:52:22,533 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-28 21:52:22,518 -  step: 800  loss: -4.0000  grad_norm:  0.1668  memory:  8.66GiB(18.23%)  tps: 9,153  tflops: 71.56  mfu: 22.94%
[rank2]:2025-12-28 21:52:22,518 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1668  tps: 9,260  tflops: 72.39  mfu: 21.20%
[rank2]:2025-12-28 21:52:22,518 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 21:52:22,519 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 21:52:22,522 -  step: 800  loss: -4.0000  grad_norm:  0.1668  memory: 12.94GiB(27.24%)  tps: 9,153  tflops: 71.56  mfu: 22.94%
[rank1]:2025-12-28 21:52:22,522 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1668  tps: 9,260  tflops: 72.39  mfu: 21.19%
[rank1]:2025-12-28 21:52:22,522 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 21:52:22,523 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 21:52:22,531 -  step: 800  loss:  0.2273  grad_norm:  0.1668  memory: 25.79GiB(54.28%)  tps: 9,154  tflops: 71.56  mfu: 22.94%
[rank3]:2025-12-28 21:52:22,532 - â„¹ï¸ final step: 800  loss:  0.2273  grad_norm:  0.1668  tps: 9,267  tflops: 72.45  mfu: 21.33%
[rank3]:2025-12-28 21:52:22,532 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 21:52:22,533 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 21:52:24,508 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-28 21:52:24,574 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank2/251228_2152_stage2_final800.svg
[rank1]:2025-12-28 21:52:24,573 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank1/251228_2152_stage1_final800.svg
[rank0]:2025-12-28 21:52:24,572 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank0/251228_2152_stage0_final800.svg
[rank3]:2025-12-28 21:52:24,663 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2152_final800_rank3.svg
[rank3]:			> Batch Time: 873.50 ms, GPU Bubble Ratio: 51.60%, 39.82%, 54.86%, 29.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  365-42-408ms   | [S0,MB5,F]  408-16-424ms   | [S0,MB2,B]  457-42-499ms   | [S0,MB6,F]  500-16-516ms   | [S0,MB3,B]  567-42-609ms   | [S0,MB7,F]  609-16-625ms   | [S0,MB4,B]  658-42-700ms   | [S0,MB5,B]  747-42-789ms   | [S0,MB6,B]  829-36-865ms   | [S0,MB7,B]  873-0-873ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  271-19-291ms   | [S1,MB1,B]  309-47-357ms   | [S1,MB4,F]  362-21-383ms   | [S1,MB2,B]  397-50-447ms   | [S1,MB5,F]  453-21-475ms   | [S1,MB3,B]  511-47-558ms   | [S1,MB6,F]  563-21-584ms   | [S1,MB4,B]  601-48-650ms   | [S1,MB7,F]  654-21-676ms   | [S1,MB5,B]  689-50-740ms   | [S1,MB6,B]  775-46-822ms   | [S1,MB7,B]  842-24-867ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  262-36-299ms   | [S2,MB3,F]  306-15-321ms   | [S2,MB2,B]  350-36-386ms   | [S2,MB4,F]  394-15-409ms   | [S2,MB3,B]  465-36-501ms   | [S2,MB5,F]  508-15-523ms   | [S2,MB4,B]  554-36-590ms   | [S2,MB6,F]  598-15-613ms   | [S2,MB5,B]  643-36-679ms   | [S2,MB7,F]  686-15-702ms   | [S2,MB6,B]  732-36-768ms   | [S2,MB7,B]  817-18-835ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-43-250ms   | [S3,MB2,F]  259-25-284ms   | [S3,MB2,B]  296-44-340ms   | [S3,MB3,F]  347-25-373ms   | [S3,MB3,B]  384-72-457ms   | [S3,MB4,F]  461-25-487ms   | [S3,MB4,B]  499-44-543ms   | [S3,MB5,F]  551-25-576ms   | [S3,MB5,B]  588-44-633ms   | [S3,MB6,F]  640-26-666ms   | [S3,MB6,B]  678-44-722ms   | [S3,MB7,F]  729-25-754ms   | [S3,MB7,B]  766-44-811ms  
[rank0]:2025-12-28 21:52:24,746 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2152_rank0_stage0.svg
[rank0]:	> Counts Sum: 152480, Total Sum: 852480 (17.89%), Ratio(%) per element: [19.09, 21.0, 19.96, 20.13, 19.96, 20.13, 20.48, 20.13, 19.61, 18.92, 19.61, 19.61, 18.75, 18.4, 18.05, 18.57, 17.88, 18.22, 17.01, 18.92, 18.05, 17.53, 17.53, 18.05, 17.7, 15.45, 17.01, 15.79, 15.79, 15.27, 15.62, 17.18, 15.97, 14.93, 15.1, 14.75, 15.45]
[rank2]:2025-12-28 21:52:24,732 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2152_rank2_stage2.svg
[rank2]:	> Counts Sum: 119520, Total Sum: 829440 (14.41%), Ratio(%) per element: [14.58, 14.58, 14.4, 14.23, 14.06, 14.75, 14.4, 14.4, 14.58, 14.75, 14.58, 14.4, 14.75, 14.23, 14.58, 14.23, 14.23, 14.4, 14.23, 14.06, 14.58, 14.06, 14.4, 14.4, 14.4, 14.75, 14.4, 14.4, 14.23, 14.06, 14.23, 14.58, 14.58, 14.23, 14.4, 14.4]
[rank1]:2025-12-28 21:52:24,732 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2152_rank1_stage1.svg
[rank1]:	> Counts Sum: 149400, Total Sum: 1036800 (14.41%), Ratio(%) per element: [14.23, 14.4, 14.4, 14.75, 14.23, 14.23, 14.23, 14.4, 14.4, 14.06, 14.06, 14.4, 14.23, 14.4, 14.4, 14.58, 14.4, 14.4, 14.23, 14.75, 14.06, 14.23, 14.58, 14.58, 14.75, 14.4, 14.58, 14.4, 14.06, 14.58, 14.23, 14.58, 14.58, 14.58, 14.4, 14.4, 14.23, 14.75, 14.75, 14.4, 14.4, 14.23, 14.23, 14.4, 14.58]
[rank3]:2025-12-28 21:52:24,805 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/pipeline_schedule/251228_2152_thry_final800_rank3.svg
[rank3]:			> Batch Time: 636.43 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-57ms     | [S0,MB3,F]  57-19-77ms     | [S0,MB0,B]  192-38-231ms   | [S0,MB4,F]  231-19-250ms   | [S0,MB1,B]  250-38-289ms   | [S0,MB5,F]  289-19-308ms   | [S0,MB2,B]  308-38-347ms   | [S0,MB6,F]  347-19-366ms   | [S0,MB3,B]  366-38-405ms   | [S0,MB7,F]  405-19-424ms   | [S0,MB4,B]  424-38-462ms   | [S0,MB5,B]  482-38-520ms   | [S0,MB6,B]  540-38-578ms   | [S0,MB7,B]  597-38-636ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB0,B]  154-38-192ms   | [S1,MB3,F]  192-19-212ms   | [S1,MB1,B]  212-38-250ms   | [S1,MB4,F]  250-19-270ms   | [S1,MB2,B]  270-38-308ms   | [S1,MB5,F]  308-19-327ms   | [S1,MB3,B]  327-38-366ms   | [S1,MB6,F]  366-19-385ms   | [S1,MB4,B]  385-38-424ms   | [S1,MB7,F]  424-19-443ms   | [S1,MB5,B]  443-38-482ms   | [S1,MB6,B]  501-38-540ms   | [S1,MB7,B]  559-38-597ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-57ms     | [S2,MB1,F]  57-19-77ms     | [S2,MB0,B]  115-38-154ms   | [S2,MB2,F]  154-19-173ms   | [S2,MB1,B]  173-38-212ms   | [S2,MB3,F]  212-19-231ms   | [S2,MB2,B]  231-38-270ms   | [S2,MB4,F]  270-19-289ms   | [S2,MB3,B]  289-38-327ms   | [S2,MB5,F]  327-19-347ms   | [S2,MB4,B]  347-38-385ms   | [S2,MB6,F]  385-19-405ms   | [S2,MB5,B]  405-38-443ms   | [S2,MB7,F]  443-19-462ms   | [S2,MB6,B]  462-38-501ms   | [S2,MB7,B]  520-38-559ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  57-19-77ms     | [S3,MB0,B]  77-38-115ms    | [S3,MB1,F]  115-19-135ms   | [S3,MB1,B]  135-38-173ms   | [S3,MB2,F]  173-19-192ms   | [S3,MB2,B]  192-38-231ms   | [S3,MB3,F]  231-19-250ms   | [S3,MB3,B]  250-38-289ms   | [S3,MB4,F]  289-19-308ms   | [S3,MB4,B]  308-38-347ms   | [S3,MB5,F]  347-19-366ms   | [S3,MB5,B]  366-38-405ms   | [S3,MB6,F]  405-19-424ms   | [S3,MB6,B]  424-38-462ms   | [S3,MB7,F]  462-19-482ms   | [S3,MB7,B]  482-38-520ms  
[rank3]:2025-12-28 21:52:24,854 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_ratio_history/rank3/251228_2152_stage3_final800.svg
[rank3]:2025-12-28 21:52:24,985 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/frozen_params_histogram/251228_2152_rank3_stage3.svg
[rank3]:	> Counts Sum: 516080, Total Sum: 668160 (77.24%), Ratio(%) per element: [78.29, 77.08, 76.9, 77.25, 76.21, 78.29, 77.08, 77.95, 77.25, 77.77, 78.47, 77.77, 78.12, 78.12, 77.25, 77.25, 77.43, 75.34, 76.9, 76.38, 76.73, 76.56, 76.73, 76.21, 77.77, 77.08, 76.04, 77.95, 77.6]
[rank2]:2025-12-28 21:52:25,661 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2152_stage2.svg
[rank2]:2025-12-28 21:52:25,664 - Destroying the purge thread.
[rank1]:2025-12-28 21:52:25,669 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2152_stage1.svg
[rank1]:2025-12-28 21:52:25,671 - Destroying the purge thread.
[rank0]:2025-12-28 21:52:25,686 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2152_stage0.svg
[rank0]:2025-12-28 21:52:25,688 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-28 21:52:25,717 - Process group destroyed
[rank1]:2025-12-28 21:52:25,722 - Process group destroyed
[rank3]:2025-12-28 21:52:25,895 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1/afr_time_plot/251228_2152_stage3.svg
[rank3]:2025-12-28 21:52:25,898 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 315-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.53583
[rank3]:wandb:               final/avg_loss 0.22734
[rank3]:wandb:             final/avg_mfu(%) 21.33354
[rank3]:wandb:             final/avg_tflops 72.44844
[rank3]:wandb:    final/avg_throughput(tps) 9267.42257
[rank3]:wandb:              final/grad_norm 0.1668
[rank3]:wandb:               final/max_loss 0.22734
[rank3]:wandb:                    grad_norm 0.1668
[rank3]:wandb: loss_metrics/global_avg_loss 0.22734
[rank3]:wandb: loss_metrics/global_max_loss 0.22734
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_1F1B_fullrand7_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/gamxgle8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_1F1B_fullrand7_11_dm1/20251228-2102/wandb/run-20251228_210215-gamxgle8/logs
[rank3]:2025-12-28 21:52:27,322 - Process group destroyed
[rank0]:2025-12-28 21:52:27,688 - Training completed
[rank0]:2025-12-28 21:52:27,689 - Destroying the purge thread.
[rank0]:2025-12-28 21:52:27,781 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.2', 'layers.1', 'tok_embeddings', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.4', 'layers.8', 'layers.7', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'norm', 'layers.14', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_1F1B_fullrand7_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_1F1B_fullrand7_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_1F1B_fullrand7_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_1F1B_fullrand7_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_1F1B_fullrand7_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_1F1B_fullrand7_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_1F1B_fullrand7_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_1F1B_fullrand7_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
