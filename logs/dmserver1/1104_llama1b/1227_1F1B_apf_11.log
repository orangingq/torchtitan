
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 29. (ì›”) 00:39:29 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_1F1B_apf_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with apf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-29 00:39:35,962 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank1]:2025-12-29 00:39:36,052 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank2]:2025-12-29 00:39:36,127 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank0]:2025-12-29 00:39:36,156 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-29 00:39:36,158 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-29 00:39:36,162 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-29 00:39:36,163 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-29 00:39:36,325 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-29 00:39:36,328 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-29 00:39:36,244 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank2]:2025-12-29 00:39:36,386 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-29 00:39:36,389 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-29 00:39:36,552 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-29 00:39:36,557 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-29 00:39:36,562 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-29 00:39:40,314 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-29 00:39:40,351 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-29 00:39:40,378 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-29 00:39:40,378 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-29 00:39:40,585 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-29 00:39:40,561 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-29 00:39:40,562 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-29 00:39:40,562 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-29 00:39:40,733 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-29 00:39:40,772 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-29 00:39:40,773 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-29 00:39:40,800 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-29 00:39:40,800 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-29 00:39:40,778 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-29 00:39:40,818 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-29 00:39:40,847 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-29 00:39:40,847 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-29 00:39:40,991 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-29 00:39:40,991 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-29 00:39:40,992 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-29 00:39:41,033 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-29 00:39:41,033 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-29 00:39:41,042 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ub0wwsdd
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_1F1B_apf_11_dm1/20251229-0039/wandb/run-20251229_003941-ub0wwsdd
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_1F1B_apf_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ub0wwsdd
[rank3]:2025-12-29 00:39:42,724 - WandB logging enabled
[rank3]:2025-12-29 00:39:42,725 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-29 00:39:42,766 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-29 00:39:42,796 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-29 00:39:42,796 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-29 00:39:43,028 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-29 00:39:43,029 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-29 00:39:43,030 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-12-29 00:39:43,049 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_1F1B_apf_11_dm1
[rank0]:2025-12-29 00:39:43,049 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-29 00:39:43,049 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-29 00:39:43,050 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-29 00:39:43,047 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-29 00:39:43,047 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-29 00:39:43,047 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-29 00:39:45,534 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-29 00:39:45,534 - Finished loading the checkpoint in 2.48 seconds.
[rank0]:2025-12-29 00:39:45,534 - Training starts at step 1
[rank1]:2025-12-29 00:39:50,827 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 10.58GiB(22.26%)  tps: 3,274  tflops: 25.59  mfu: 8.20%
[rank1]:2025-12-29 00:39:50,828 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-29 00:39:50,823 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory:  6.84GiB(14.41%)  tps: 3,129  tflops: 24.46  mfu: 7.84%
[rank2]:2025-12-29 00:39:50,824 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-29 00:39:50,835 -  step:  1  loss: 10.6092  grad_norm: 203.0665  memory: 21.88GiB(46.05%)  tps: 4,062  tflops: 31.76  mfu: 10.18%
[rank3]:2025-12-29 00:39:50,836 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-29 00:39:50,864 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 13.10GiB(27.57%)  tps: 3,247  tflops: 25.39  mfu: 8.14%
[rank0]:2025-12-29 00:39:50,864 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-29 00:43:43,507 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-29 00:43:48,205 - Avg. fwd time: 14.9063 / Avg. bwd time: 35.2862 / Avg. batch time: 1046.8681 (ms) / GPU bubble ratio: 61.64%
[rank3]:2025-12-29 00:43:48,162 - Avg. fwd time: 24.6662 / Avg. bwd time: 80.7411 / Avg. batch time: 988.6318 (ms) / GPU bubble ratio: 14.70%
[rank1]:2025-12-29 00:43:48,256 - Avg. fwd time: 19.7521 / Avg. bwd time: 45.6114 / Avg. batch time: 1119.7269 (ms) / GPU bubble ratio: 53.30%
[rank2]:2025-12-29 00:43:48,326 -  step: 50  loss: -4.0000  grad_norm: 24.2219  memory:  8.66GiB(18.23%)  tps: 6,761  tflops: 52.85  mfu: 16.94%
[rank3]:2025-12-29 00:43:48,338 -  step: 50  loss:  9.8853  grad_norm: 24.2219  memory: 25.79GiB(54.28%)  tps: 6,761  tflops: 52.85  mfu: 16.94%
[rank1]:2025-12-29 00:43:48,329 -  step: 50  loss: -4.0000  grad_norm: 24.2219  memory: 12.86GiB(27.07%)  tps: 6,761  tflops: 52.85  mfu: 16.94%
[rank0]:2025-12-29 00:43:48,304 - Avg. fwd time: 16.1348 / Avg. bwd time: 41.8692 / Avg. batch time: 1185.7514 (ms) / GPU bubble ratio: 60.87%
[rank0]:2025-12-29 00:43:48,341 -  step: 50  loss: -4.0000  grad_norm: 24.2219  memory: 16.87GiB(35.50%)  tps: 6,761  tflops: 52.86  mfu: 16.94%
[rank3]:2025-12-29 00:44:31,603 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:44:31,999 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:44:32,092 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:44:32,047 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:45:20,734 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:45:20,713 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:45:20,744 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:45:20,721 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:46:01,409 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:46:01,379 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:46:01,379 - Freezing Ratio: [Stage1] 0.04, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:46:01,379 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:46:50,241 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:46:50,251 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:46:50,219 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:46:50,225 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:47:30,693 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:47:30,664 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 00:47:30,665 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:47:30,663 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:47:30,664 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:47:34,581 - Avg. fwd time: 25.0820 / Avg. bwd time: 77.2747 / Avg. batch time: 964.1413 (ms) / GPU bubble ratio: 15.07%
[rank2]:2025-12-29 00:47:34,606 - Avg. fwd time: 15.1046 / Avg. bwd time: 31.7307 / Avg. batch time: 1018.3747 (ms) / GPU bubble ratio: 63.21%
[rank2]:2025-12-29 00:47:34,662 -  step: 100  loss: -4.0000  grad_norm: 14.0407  memory:  9.58GiB(20.16%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank1]:2025-12-29 00:47:34,636 - Avg. fwd time: 19.9283 / Avg. bwd time: 40.9807 / Avg. batch time: 1086.1984 (ms) / GPU bubble ratio: 55.14%
[rank1]:2025-12-29 00:47:34,662 -  step: 100  loss: -4.0000  grad_norm: 14.0407  memory: 14.00GiB(29.46%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank3]:2025-12-29 00:47:34,677 -  step: 100  loss:  8.7901  grad_norm: 14.0407  memory: 27.74GiB(58.39%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank0]:2025-12-29 00:47:34,660 - Avg. fwd time: 16.3485 / Avg. bwd time: 37.0742 / Avg. batch time: 1146.9820 (ms) / GPU bubble ratio: 62.74%
[rank0]:2025-12-29 00:47:34,662 -  step: 100  loss: -4.0000  grad_norm: 14.0407  memory: 18.72GiB(39.41%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank0]:2025-12-29 00:47:34,745 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0047_stage0_step100.svg
[rank2]:2025-12-29 00:47:34,753 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0047_stage2_step100.svg
[rank1]:2025-12-29 00:47:34,752 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0047_stage1_step100.svg
[rank3]:2025-12-29 00:47:34,848 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0047_step100_rank3.svg
[rank3]:			> Batch Time: 992.78 ms, GPU Bubble Ratio: 71.26%, 64.92%, 72.83%, 27.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-18-52ms     | [S0,MB3,F]  52-18-70ms     | [S0,MB0,B]  215-18-234ms   | [S0,MB4,F]  234-16-250ms   | [S0,MB1,B]  322-18-341ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  431-18-449ms   | [S0,MB6,F]  450-16-466ms   | [S0,MB3,B]  542-18-560ms   | [S0,MB7,F]  561-16-577ms   | [S0,MB4,B]  652-18-671ms   | [S0,MB5,B]  761-18-780ms   | [S0,MB6,B]  868-18-886ms   | [S0,MB7,B]  974-18-992ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  184-23-208ms   | [S1,MB3,F]  212-20-233ms   | [S1,MB1,B]  291-23-314ms   | [S1,MB4,F]  318-20-339ms   | [S1,MB2,B]  400-23-423ms   | [S1,MB5,F]  427-20-448ms   | [S1,MB3,B]  510-23-534ms   | [S1,MB6,F]  538-20-559ms   | [S1,MB4,B]  621-23-644ms   | [S1,MB7,F]  649-20-669ms   | [S1,MB5,B]  732-23-755ms   | [S1,MB6,B]  838-23-861ms   | [S1,MB7,B]  944-23-967ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  156-18-174ms   | [S2,MB2,F]  181-15-197ms   | [S2,MB1,B]  263-18-281ms   | [S2,MB3,F]  288-15-303ms   | [S2,MB2,B]  371-18-389ms   | [S2,MB4,F]  397-15-412ms   | [S2,MB3,B]  482-18-500ms   | [S2,MB5,F]  507-15-523ms   | [S2,MB4,B]  593-18-611ms   | [S2,MB6,F]  618-15-633ms   | [S2,MB5,B]  704-18-722ms   | [S2,MB7,F]  729-15-744ms   | [S2,MB6,B]  814-18-832ms   | [S2,MB7,B]  920-17-938ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-58-146ms    | [S3,MB1,F]  153-24-178ms   | [S3,MB1,B]  190-62-252ms   | [S3,MB2,F]  259-26-286ms   | [S3,MB2,B]  297-63-361ms   | [S3,MB3,F]  368-26-395ms   | [S3,MB3,B]  408-64-472ms   | [S3,MB4,F]  479-26-506ms   | [S3,MB4,B]  518-64-583ms   | [S3,MB5,F]  590-26-616ms   | [S3,MB5,B]  630-64-694ms   | [S3,MB6,F]  701-27-728ms   | [S3,MB6,B]  740-64-805ms   | [S3,MB7,F]  811-26-837ms   | [S3,MB7,B]  851-64-915ms  
[rank3]:2025-12-29 00:47:34,898 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0047_stage3_step100.svg
[rank0]:2025-12-29 00:47:34,906 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0047_rank0_stage0.svg
[rank0]:	> Counts Sum: 92, Total Sum: 185 (49.73%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 20.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 20.0]
[rank2]:2025-12-29 00:47:34,916 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0047_rank2_stage2.svg
[rank2]:	> Counts Sum: 85, Total Sum: 180 (47.22%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank1]:2025-12-29 00:47:34,901 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0047_rank1_stage1.svg
[rank1]:	> Counts Sum: 108, Total Sum: 225 (48.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 20.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank3]:2025-12-29 00:47:35,037 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0047_rank3_stage3.svg
[rank3]:	> Counts Sum: 64, Total Sum: 145 (44.14%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 20.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 00:48:11,375 - Freezing Ratio: [Stage0] 0.03, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:48:11,403 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:48:11,373 - Freezing Ratio: [Stage2] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:48:11,374 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:49:00,257 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:49:00,234 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:49:00,242 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:49:00,270 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:49:40,904 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:49:40,903 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:49:40,904 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:49:40,933 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:50:21,418 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:50:21,447 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:50:21,417 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:50:21,418 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:51:01,991 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:51:01,969 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 00:51:01,972 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:51:01,960 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:51:01,961 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:51:06,711 - Avg. fwd time: 25.4430 / Avg. bwd time: 73.9824 / Avg. batch time: 940.6499 (ms) / GPU bubble ratio: 15.44%
[rank2]:2025-12-29 00:51:06,754 - Avg. fwd time: 15.2754 / Avg. bwd time: 28.4491 / Avg. batch time: 991.5570 (ms) / GPU bubble ratio: 64.72%
[rank1]:2025-12-29 00:51:06,807 - Avg. fwd time: 20.0627 / Avg. bwd time: 36.7174 / Avg. batch time: 1054.9763 (ms) / GPU bubble ratio: 56.94%
[rank3]:2025-12-29 00:51:06,890 -  step: 150  loss:  5.3587  grad_norm: 19.0221  memory: 27.89GiB(58.72%)  tps: 7,721  tflops: 60.36  mfu: 19.35%
[rank0]:2025-12-29 00:51:06,855 - Avg. fwd time: 16.5074 / Avg. bwd time: 32.6822 / Avg. batch time: 1111.1812 (ms) / GPU bubble ratio: 64.59%
[rank0]:2025-12-29 00:51:06,893 -  step: 150  loss: -4.0000  grad_norm: 19.0221  memory: 18.76GiB(39.49%)  tps: 7,720  tflops: 60.35  mfu: 19.34%
[rank2]:2025-12-29 00:51:06,877 -  step: 150  loss: -4.0000  grad_norm: 19.0221  memory:  9.58GiB(20.16%)  tps: 7,720  tflops: 60.36  mfu: 19.34%
[rank1]:2025-12-29 00:51:06,881 -  step: 150  loss: -4.0000  grad_norm: 19.0221  memory: 14.00GiB(29.46%)  tps: 7,720  tflops: 60.35  mfu: 19.34%
[rank3]:2025-12-29 00:51:50,850 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:51:50,860 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:51:50,827 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:51:50,835 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:52:31,573 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:52:31,603 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:52:31,574 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:52:31,573 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:53:12,066 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:53:12,036 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:53:12,037 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:53:12,037 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:53:52,436 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:53:52,437 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:53:52,437 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:53:52,466 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:54:32,762 - Freezing Ratio: [Stage2] 0.11, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:54:32,763 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 00:54:32,765 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:54:32,763 - Freezing Ratio: [Stage1] 0.04, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:54:32,793 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:54:37,522 - Avg. fwd time: 25.6145 / Avg. bwd time: 72.2149 / Avg. batch time: 927.8520 (ms) / GPU bubble ratio: 15.65%
[rank2]:2025-12-29 00:54:37,565 - Avg. fwd time: 15.3589 / Avg. bwd time: 26.7060 / Avg. batch time: 976.9143 (ms) / GPU bubble ratio: 65.55%
[rank1]:2025-12-29 00:54:37,617 - Avg. fwd time: 20.1338 / Avg. bwd time: 34.4678 / Avg. batch time: 1038.0235 (ms) / GPU bubble ratio: 57.92%
[rank2]:2025-12-29 00:54:37,688 -  step: 200  loss: -4.0000  grad_norm: 15.2536  memory:  9.58GiB(20.16%)  tps: 7,772  tflops: 60.76  mfu: 19.47%
[rank0]:2025-12-29 00:54:37,666 - Avg. fwd time: 16.5931 / Avg. bwd time: 30.3801 / Avg. batch time: 1091.8359 (ms) / GPU bubble ratio: 65.58%
[rank0]:2025-12-29 00:54:37,704 -  step: 200  loss: -4.0000  grad_norm: 15.2536  memory: 18.76GiB(39.49%)  tps: 7,772  tflops: 60.76  mfu: 19.47%
[rank1]:2025-12-29 00:54:37,691 -  step: 200  loss: -4.0000  grad_norm: 15.2536  memory: 14.00GiB(29.46%)  tps: 7,772  tflops: 60.76  mfu: 19.47%
[rank1]:2025-12-29 00:54:37,751 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0054_stage1_step200.svg
[rank3]:2025-12-29 00:54:37,700 -  step: 200  loss:  1.6077  grad_norm: 15.2536  memory: 27.89GiB(58.72%)  tps: 7,772  tflops: 60.76  mfu: 19.47%
[rank2]:2025-12-29 00:54:37,750 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0054_stage2_step200.svg
[rank0]:2025-12-29 00:54:37,750 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0054_stage0_step200.svg
[rank3]:2025-12-29 00:54:37,852 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0054_step200_rank3.svg
[rank3]:			> Batch Time: 990.83 ms, GPU Bubble Ratio: 71.16%, 64.88%, 72.76%, 27.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  215-18-234ms   | [S0,MB4,F]  234-16-250ms   | [S0,MB1,B]  322-18-341ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  430-18-449ms   | [S0,MB6,F]  449-16-465ms   | [S0,MB3,B]  541-18-560ms   | [S0,MB7,F]  560-16-576ms   | [S0,MB4,B]  651-18-670ms   | [S0,MB5,B]  759-18-777ms   | [S0,MB6,B]  866-18-885ms   | [S0,MB7,B]  972-18-990ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  184-23-207ms   | [S1,MB3,F]  212-20-233ms   | [S1,MB1,B]  291-23-314ms   | [S1,MB4,F]  318-20-339ms   | [S1,MB2,B]  399-23-422ms   | [S1,MB5,F]  426-20-447ms   | [S1,MB3,B]  510-23-533ms   | [S1,MB6,F]  538-20-558ms   | [S1,MB4,B]  620-23-643ms   | [S1,MB7,F]  648-20-668ms   | [S1,MB5,B]  729-23-752ms   | [S1,MB6,B]  837-23-860ms   | [S1,MB7,B]  942-23-965ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  156-17-174ms   | [S2,MB2,F]  181-15-197ms   | [S2,MB1,B]  262-18-280ms   | [S2,MB3,F]  287-15-303ms   | [S2,MB2,B]  371-18-389ms   | [S2,MB4,F]  396-15-412ms   | [S2,MB3,B]  481-18-499ms   | [S2,MB5,F]  507-15-522ms   | [S2,MB4,B]  592-18-610ms   | [S2,MB6,F]  617-15-633ms   | [S2,MB5,B]  701-18-719ms   | [S2,MB7,F]  726-15-741ms   | [S2,MB6,B]  813-18-831ms   | [S2,MB7,B]  918-18-936ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-58-146ms    | [S3,MB1,F]  153-25-178ms   | [S3,MB1,B]  189-62-252ms   | [S3,MB2,F]  259-26-285ms   | [S3,MB2,B]  296-63-360ms   | [S3,MB3,F]  368-26-394ms   | [S3,MB3,B]  407-63-471ms   | [S3,MB4,F]  478-27-506ms   | [S3,MB4,B]  517-64-582ms   | [S3,MB5,F]  589-26-615ms   | [S3,MB5,B]  626-63-690ms   | [S3,MB6,F]  697-27-725ms   | [S3,MB6,B]  738-64-802ms   | [S3,MB7,F]  810-26-836ms   | [S3,MB7,B]  848-64-912ms  
[rank2]:2025-12-29 00:54:37,897 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0054_rank2_stage2.svg
[rank2]:	> Counts Sum: 300, Total Sum: 540 (55.56%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 13.33, 26.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 60.0, 33.33, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank0]:2025-12-29 00:54:37,898 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0054_rank0_stage0.svg
[rank0]:	> Counts Sum: 297, Total Sum: 555 (53.51%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 6.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 26.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 6.66]
[rank1]:2025-12-29 00:54:37,895 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0054_rank1_stage1.svg
[rank1]:	> Counts Sum: 362, Total Sum: 675 (53.63%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 40.0, 26.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank3]:2025-12-29 00:54:37,899 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0054_stage3_step200.svg
[rank3]:2025-12-29 00:54:38,027 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0054_rank3_stage3.svg
[rank3]:	> Counts Sum: 214, Total Sum: 435 (49.20%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 26.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 00:55:21,639 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:55:21,616 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:55:21,650 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:55:21,623 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:56:01,860 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:56:01,894 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:56:01,860 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:56:01,861 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:56:42,206 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:56:42,236 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:56:42,206 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:56:42,207 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:57:22,873 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:57:22,872 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:57:22,874 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:57:22,903 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:58:03,658 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 00:58:03,660 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:58:03,649 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:58:03,649 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:58:03,680 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:58:07,633 - Avg. fwd time: 25.7097 / Avg. bwd time: 71.0652 / Avg. batch time: 919.4041 (ms) / GPU bubble ratio: 15.79%
[rank1]:2025-12-29 00:58:07,688 - Avg. fwd time: 20.1582 / Avg. bwd time: 33.0022 / Avg. batch time: 1026.9400 (ms) / GPU bubble ratio: 58.59%
[rank1]:2025-12-29 00:58:07,715 -  step: 250  loss: -4.0000  grad_norm: 11.6157  memory: 14.00GiB(29.46%)  tps: 7,801  tflops: 60.98  mfu: 19.55%
[rank2]:2025-12-29 00:58:07,658 - Avg. fwd time: 15.4007 / Avg. bwd time: 25.5753 / Avg. batch time: 967.3399 (ms) / GPU bubble ratio: 66.11%
[rank2]:2025-12-29 00:58:07,715 -  step: 250  loss: -4.0000  grad_norm: 11.6157  memory:  9.58GiB(20.16%)  tps: 7,801  tflops: 60.98  mfu: 19.55%
[rank3]:2025-12-29 00:58:07,732 -  step: 250  loss:  5.0400  grad_norm: 11.6157  memory: 27.89GiB(58.72%)  tps: 7,801  tflops: 60.98  mfu: 19.55%
[rank0]:2025-12-29 00:58:07,714 - Avg. fwd time: 16.6335 / Avg. bwd time: 28.8906 / Avg. batch time: 1079.2056 (ms) / GPU bubble ratio: 66.25%
[rank0]:2025-12-29 00:58:07,716 -  step: 250  loss: -4.0000  grad_norm: 11.6157  memory: 18.76GiB(39.49%)  tps: 7,801  tflops: 60.99  mfu: 19.55%
[rank2]:2025-12-29 00:58:44,358 - Freezing Ratio: [Stage2] 0.11, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:58:44,359 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:58:44,389 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:58:44,360 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-29 00:59:33,316 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 00:59:33,324 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank3]:2025-12-29 00:59:33,340 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-29 00:59:33,349 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:00:14,151 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:00:14,150 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:00:14,180 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:00:14,151 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:00:55,058 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:00:55,057 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:00:55,059 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:00:55,087 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:01:35,784 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:01:35,786 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:01:35,784 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:01:35,795 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:01:35,813 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:01:39,833 - Avg. fwd time: 20.1745 / Avg. bwd time: 32.1054 / Avg. batch time: 1021.3528 (ms) / GPU bubble ratio: 59.05%
[rank2]:2025-12-29 01:01:39,802 - Avg. fwd time: 15.4262 / Avg. bwd time: 24.8779 / Avg. batch time: 962.6878 (ms) / GPU bubble ratio: 66.51%
[rank3]:2025-12-29 01:01:39,776 - Avg. fwd time: 25.8042 / Avg. bwd time: 70.4828 / Avg. batch time: 915.5041 (ms) / GPU bubble ratio: 15.86%
[rank1]:2025-12-29 01:01:39,859 -  step: 300  loss: -4.0000  grad_norm: 13.2519  memory: 14.00GiB(29.46%)  tps: 7,723  tflops: 60.38  mfu: 19.35%
[rank1]:2025-12-29 01:01:39,922 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0101_stage1_step300.svg
[rank2]:2025-12-29 01:01:39,859 -  step: 300  loss: -4.0000  grad_norm: 13.2519  memory:  9.58GiB(20.16%)  tps: 7,723  tflops: 60.38  mfu: 19.35%
[rank2]:2025-12-29 01:01:39,923 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0101_stage2_step300.svg
[rank0]:2025-12-29 01:01:39,857 - Avg. fwd time: 16.6572 / Avg. bwd time: 27.9736 / Avg. batch time: 1072.6550 (ms) / GPU bubble ratio: 66.71%
[rank0]:2025-12-29 01:01:39,859 -  step: 300  loss: -4.0000  grad_norm: 13.2519  memory: 18.76GiB(39.49%)  tps: 7,723  tflops: 60.38  mfu: 19.35%
[rank0]:2025-12-29 01:01:39,923 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0101_stage0_step300.svg
[rank3]:2025-12-29 01:01:39,875 -  step: 300  loss:  3.7049  grad_norm: 13.2519  memory: 27.89GiB(58.72%)  tps: 7,723  tflops: 60.38  mfu: 19.35%
[rank3]:2025-12-29 01:01:40,020 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0101_step300_rank3.svg
[rank3]:			> Batch Time: 1000.75 ms, GPU Bubble Ratio: 71.49%, 65.29%, 73.12%, 27.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  216-18-235ms   | [S0,MB4,F]  235-16-251ms   | [S0,MB1,B]  326-18-345ms   | [S0,MB5,F]  345-16-361ms   | [S0,MB2,B]  437-18-455ms   | [S0,MB6,F]  455-16-472ms   | [S0,MB3,B]  548-18-567ms   | [S0,MB7,F]  567-16-583ms   | [S0,MB4,B]  658-18-677ms   | [S0,MB5,B]  767-18-786ms   | [S0,MB6,B]  874-18-893ms   | [S0,MB7,B]  982-18-1000ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-209ms   | [S1,MB3,F]  213-20-233ms   | [S1,MB1,B]  295-23-318ms   | [S1,MB4,F]  323-20-343ms   | [S1,MB2,B]  406-23-429ms   | [S1,MB5,F]  433-20-454ms   | [S1,MB3,B]  517-23-540ms   | [S1,MB6,F]  545-20-565ms   | [S1,MB4,B]  627-23-650ms   | [S1,MB7,F]  655-20-675ms   | [S1,MB5,B]  737-23-760ms   | [S1,MB6,B]  844-23-867ms   | [S1,MB7,B]  952-23-975ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  157-17-175ms   | [S2,MB2,F]  182-15-198ms   | [S2,MB1,B]  267-17-285ms   | [S2,MB3,F]  292-15-308ms   | [S2,MB2,B]  378-18-396ms   | [S2,MB4,F]  403-15-418ms   | [S2,MB3,B]  489-17-507ms   | [S2,MB5,F]  514-15-529ms   | [S2,MB4,B]  599-17-616ms   | [S2,MB6,F]  624-15-639ms   | [S2,MB5,B]  709-17-727ms   | [S2,MB7,F]  735-15-750ms   | [S2,MB6,B]  820-17-838ms   | [S2,MB7,B]  927-17-944ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-60-147ms    | [S3,MB1,F]  155-26-181ms   | [S3,MB1,B]  193-64-257ms   | [S3,MB2,F]  264-27-291ms   | [S3,MB2,B]  303-64-367ms   | [S3,MB3,F]  374-27-402ms   | [S3,MB3,B]  414-64-479ms   | [S3,MB4,F]  486-27-513ms   | [S3,MB4,B]  524-64-589ms   | [S3,MB5,F]  596-27-623ms   | [S3,MB5,B]  636-64-700ms   | [S3,MB6,F]  707-27-734ms   | [S3,MB6,B]  746-64-810ms   | [S3,MB7,F]  817-27-844ms   | [S3,MB7,B]  856-64-920ms  
[rank1]:2025-12-29 01:01:40,067 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0101_rank1_stage1.svg
[rank1]:	> Counts Sum: 691, Total Sum: 1125 (61.42%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 8.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 56.0, 20.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 16.0, 0.0]
[rank2]:2025-12-29 01:01:40,087 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0101_rank2_stage2.svg
[rank2]:	> Counts Sum: 581, Total Sum: 900 (64.56%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 16.0, 32.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 68.0, 32.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 8.0, 12.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 12.0, 16.0]
[rank0]:2025-12-29 01:01:40,077 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0101_rank0_stage0.svg
[rank0]:	> Counts Sum: 560, Total Sum: 925 (60.54%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 8.0, 4.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 16.0, 4.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 4.0]
[rank3]:2025-12-29 01:01:40,065 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0101_stage3_step300.svg
[rank3]:2025-12-29 01:01:40,200 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0101_rank3_stage3.svg
[rank3]:	> Counts Sum: 406, Total Sum: 725 (56.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 8.0, 20.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 01:02:16,778 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:02:16,777 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:02:16,779 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:02:16,808 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:02:57,575 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:02:57,576 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:02:57,577 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:02:57,605 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:03:38,463 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:03:38,463 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:03:38,464 - Freezing Ratio: [Stage0] 0.03, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:03:38,493 - Freezing Ratio: [Stage3] 0.07, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:04:27,501 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:04:27,508 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:04:27,535 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:04:27,524 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:05:08,290 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:05:08,290 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:05:08,299 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 01:05:08,301 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:05:08,321 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:05:12,318 - Avg. fwd time: 25.8836 / Avg. bwd time: 70.0808 / Avg. batch time: 912.9214 (ms) / GPU bubble ratio: 15.91%
[rank2]:2025-12-29 01:05:12,345 - Avg. fwd time: 15.4479 / Avg. bwd time: 24.3908 / Avg. batch time: 959.6235 (ms) / GPU bubble ratio: 66.79%
[rank2]:2025-12-29 01:05:12,402 -  step: 350  loss: -4.0000  grad_norm:  7.4049  memory:  9.58GiB(20.16%)  tps: 7,709  tflops: 60.26  mfu: 19.31%
[rank1]:2025-12-29 01:05:12,376 - Avg. fwd time: 20.1968 / Avg. bwd time: 31.4673 / Avg. batch time: 1017.6260 (ms) / GPU bubble ratio: 59.38%
[rank1]:2025-12-29 01:05:12,402 -  step: 350  loss: -4.0000  grad_norm:  7.4049  memory: 14.00GiB(29.46%)  tps: 7,709  tflops: 60.26  mfu: 19.31%
[rank0]:2025-12-29 01:05:12,401 - Avg. fwd time: 16.6725 / Avg. bwd time: 27.2418 / Avg. batch time: 1068.1521 (ms) / GPU bubble ratio: 67.11%
[rank0]:2025-12-29 01:05:12,403 -  step: 350  loss: -4.0000  grad_norm:  7.4049  memory: 18.76GiB(39.49%)  tps: 7,709  tflops: 60.26  mfu: 19.31%
[rank3]:2025-12-29 01:05:12,418 -  step: 350  loss:  1.2787  grad_norm:  7.4049  memory: 27.89GiB(58.72%)  tps: 7,709  tflops: 60.26  mfu: 19.31%
[rank1]:2025-12-29 01:05:49,125 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:05:49,125 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:05:49,127 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:05:49,156 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:06:30,057 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:06:30,058 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:06:30,058 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:06:30,088 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:07:10,730 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:07:10,730 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:07:10,760 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:07:10,731 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:07:51,352 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:07:51,352 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:07:51,382 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:07:51,353 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:08:32,035 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:08:32,035 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:08:32,065 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:08:32,035 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:08:32,037 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:08:36,081 - Avg. fwd time: 25.9836 / Avg. bwd time: 69.2973 / Avg. batch time: 907.4515 (ms) / GPU bubble ratio: 16.00%
[rank2]:2025-12-29 01:08:36,108 - Avg. fwd time: 15.4860 / Avg. bwd time: 23.5979 / Avg. batch time: 953.3164 (ms) / GPU bubble ratio: 67.20%
[rank2]:2025-12-29 01:08:36,166 -  step: 400  loss: -4.0000  grad_norm:  0.7315  memory:  9.58GiB(20.16%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank1]:2025-12-29 01:08:36,139 - Avg. fwd time: 20.2326 / Avg. bwd time: 30.4215 / Avg. batch time: 1010.2672 (ms) / GPU bubble ratio: 59.89%
[rank1]:2025-12-29 01:08:36,166 -  step: 400  loss: -4.0000  grad_norm:  0.7315  memory: 14.00GiB(29.46%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank3]:2025-12-29 01:08:36,182 -  step: 400  loss:  0.3895  grad_norm:  0.7315  memory: 27.89GiB(58.72%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank0]:2025-12-29 01:08:36,165 - Avg. fwd time: 16.7049 / Avg. bwd time: 26.0409 / Avg. batch time: 1059.5613 (ms) / GPU bubble ratio: 67.73%
[rank0]:2025-12-29 01:08:36,167 -  step: 400  loss: -4.0000  grad_norm:  0.7315  memory: 18.76GiB(39.49%)  tps: 8,041  tflops: 62.86  mfu: 20.15%
[rank2]:2025-12-29 01:08:36,236 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0108_stage2_step400.svg
[rank1]:2025-12-29 01:08:36,236 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0108_stage1_step400.svg
[rank0]:2025-12-29 01:08:36,235 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0108_stage0_step400.svg
[rank2]:2025-12-29 01:08:36,387 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0108_rank2_stage2.svg
[rank2]:	> Counts Sum: 852, Total Sum: 1260 (67.62%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.42, 22.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 74.28, 22.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 28.57, 11.42, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.42, 11.42]
[rank1]:2025-12-29 01:08:36,381 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0108_rank1_stage1.svg
[rank1]:	> Counts Sum: 1037, Total Sum: 1575 (65.84%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 17.14, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 5.71, 8.57, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 62.85, 34.28, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 34.28, 0.0]
[rank3]:2025-12-29 01:08:36,338 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0108_step400_rank3.svg
[rank3]:			> Batch Time: 997.31 ms, GPU Bubble Ratio: 72.55%, 65.02%, 72.88%, 27.62%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  216-17-234ms   | [S0,MB4,F]  234-16-250ms   | [S0,MB1,B]  324-17-341ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  435-17-452ms   | [S0,MB6,F]  452-16-468ms   | [S0,MB3,B]  544-17-561ms   | [S0,MB7,F]  562-16-578ms   | [S0,MB4,B]  656-17-673ms   | [S0,MB5,B]  764-17-781ms   | [S0,MB6,B]  873-17-890ms   | [S0,MB7,B]  980-17-997ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  42-20-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-208ms   | [S1,MB3,F]  213-20-233ms   | [S1,MB1,B]  292-23-315ms   | [S1,MB4,F]  320-20-341ms   | [S1,MB2,B]  403-23-426ms   | [S1,MB5,F]  431-20-452ms   | [S1,MB3,B]  513-23-536ms   | [S1,MB6,F]  541-20-561ms   | [S1,MB4,B]  625-23-648ms   | [S1,MB7,F]  652-20-673ms   | [S1,MB5,B]  734-23-757ms   | [S1,MB6,B]  843-23-866ms   | [S1,MB7,B]  950-23-973ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  157-17-175ms   | [S2,MB2,F]  182-15-198ms   | [S2,MB1,B]  264-18-282ms   | [S2,MB3,F]  289-15-305ms   | [S2,MB2,B]  375-18-393ms   | [S2,MB4,F]  400-15-416ms   | [S2,MB3,B]  485-18-503ms   | [S2,MB5,F]  510-15-526ms   | [S2,MB4,B]  596-18-614ms   | [S2,MB6,F]  621-15-637ms   | [S2,MB5,B]  706-18-724ms   | [S2,MB7,F]  731-15-747ms   | [S2,MB6,B]  819-18-837ms   | [S2,MB7,B]  926-18-944ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  87-59-147ms    | [S3,MB1,F]  154-25-180ms   | [S3,MB1,B]  191-62-254ms   | [S3,MB2,F]  261-27-288ms   | [S3,MB2,B]  300-64-364ms   | [S3,MB3,F]  373-26-400ms   | [S3,MB3,B]  411-64-475ms   | [S3,MB4,F]  482-27-509ms   | [S3,MB4,B]  521-64-586ms   | [S3,MB5,F]  593-27-620ms   | [S3,MB5,B]  632-64-696ms   | [S3,MB6,F]  703-27-731ms   | [S3,MB6,B]  744-64-808ms   | [S3,MB7,F]  816-27-843ms   | [S3,MB7,B]  854-64-919ms  
[rank3]:2025-12-29 01:08:36,389 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0108_stage3_step400.svg
[rank0]:2025-12-29 01:08:36,387 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0108_rank0_stage0.svg
[rank0]:	> Counts Sum: 836, Total Sum: 1295 (64.56%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 25.71, 2.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.42, 17.14, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 8.57, 2.85]
[rank3]:2025-12-29 01:08:36,519 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0108_rank3_stage3.svg
[rank3]:	> Counts Sum: 608, Total Sum: 1015 (59.90%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 22.85, 14.28, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 20.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 01:08:59,206 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-29 01:08:59,675 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-29 01:08:59,649 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-29 01:08:59,692 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-29 01:09:12,944 - Freezing Ratio: [Stage2] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:09:12,943 - Freezing Ratio: [Stage1] 0.07, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:09:12,945 - Freezing Ratio: [Stage0] 0.08, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:09:12,973 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:10:01,676 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:10:01,669 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:10:01,701 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:10:01,692 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:10:42,352 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:10:42,322 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:10:42,323 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:10:42,323 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:11:22,992 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:11:22,992 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:11:22,993 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:11:23,022 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:12:03,733 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:12:03,702 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:12:03,702 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:12:03,712 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 01:12:03,714 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:12:07,684 - Avg. fwd time: 26.0144 / Avg. bwd time: 69.0704 / Avg. batch time: 905.8827 (ms) / GPU bubble ratio: 16.03%
[rank2]:2025-12-29 01:12:07,711 - Avg. fwd time: 15.4926 / Avg. bwd time: 23.3687 / Avg. batch time: 951.5308 (ms) / GPU bubble ratio: 67.33%
[rank2]:2025-12-29 01:12:07,770 -  step: 450  loss: -4.0000  grad_norm:  5.4771  memory:  9.58GiB(20.16%)  tps: 7,743  tflops: 60.53  mfu: 19.40%
[rank1]:2025-12-29 01:12:07,742 - Avg. fwd time: 20.2418 / Avg. bwd time: 30.1071 / Avg. batch time: 1008.1519 (ms) / GPU bubble ratio: 60.05%
[rank1]:2025-12-29 01:12:07,770 -  step: 450  loss: -4.0000  grad_norm:  5.4771  memory: 14.00GiB(29.46%)  tps: 7,743  tflops: 60.53  mfu: 19.40%
[rank0]:2025-12-29 01:12:07,768 - Avg. fwd time: 16.7152 / Avg. bwd time: 25.6516 / Avg. batch time: 1057.0326 (ms) / GPU bubble ratio: 67.94%
[rank0]:2025-12-29 01:12:07,770 -  step: 450  loss: -4.0000  grad_norm:  5.4771  memory: 18.76GiB(39.49%)  tps: 7,743  tflops: 60.53  mfu: 19.40%
[rank3]:2025-12-29 01:12:07,785 -  step: 450  loss:  0.5985  grad_norm:  5.4771  memory: 27.89GiB(58.72%)  tps: 7,743  tflops: 60.53  mfu: 19.40%
[rank3]:2025-12-29 01:12:44,297 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:12:44,267 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:12:44,267 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:12:44,268 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:13:24,784 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:13:24,814 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:13:24,783 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:13:24,783 - Freezing Ratio: [Stage1] 0.91, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:14:05,399 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:14:05,399 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:14:05,400 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:14:05,429 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:14:46,161 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:14:46,132 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:14:46,132 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:14:46,133 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:15:26,798 - Freezing Ratio: [Stage2] 0.08, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:15:26,828 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:15:26,798 - Freezing Ratio: [Stage1] 0.09, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:15:26,799 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:15:26,801 - Freezing Ratio: [Stage0] 0.08, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:15:31,514 - Avg. fwd time: 15.5136 / Avg. bwd time: 22.8749 / Avg. batch time: 947.3109 (ms) / GPU bubble ratio: 67.58%
[rank3]:2025-12-29 01:15:31,469 - Avg. fwd time: 26.0691 / Avg. bwd time: 68.5536 / Avg. batch time: 902.1838 (ms) / GPU bubble ratio: 16.09%
[rank1]:2025-12-29 01:15:31,568 - Avg. fwd time: 20.2615 / Avg. bwd time: 29.4496 / Avg. batch time: 1003.2607 (ms) / GPU bubble ratio: 60.36%
[rank1]:2025-12-29 01:15:31,644 -  step: 500  loss: -4.0000  grad_norm: 15.6387  memory: 14.00GiB(29.46%)  tps: 8,036  tflops: 62.82  mfu: 20.14%
[rank0]:2025-12-29 01:15:31,619 - Avg. fwd time: 16.7410 / Avg. bwd time: 24.9007 / Avg. batch time: 1051.3654 (ms) / GPU bubble ratio: 68.31%
[rank0]:2025-12-29 01:15:31,657 -  step: 500  loss: -4.0000  grad_norm: 15.6387  memory: 18.76GiB(39.49%)  tps: 8,036  tflops: 62.82  mfu: 20.13%
[rank2]:2025-12-29 01:15:31,640 -  step: 500  loss: -4.0000  grad_norm: 15.6387  memory:  9.58GiB(20.16%)  tps: 8,036  tflops: 62.83  mfu: 20.14%
[rank2]:2025-12-29 01:15:31,703 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0115_stage2_step500.svg
[rank3]:2025-12-29 01:15:31,653 -  step: 500  loss:  0.4801  grad_norm: 15.6387  memory: 27.89GiB(58.72%)  tps: 8,037  tflops: 62.83  mfu: 20.14%
[rank1]:2025-12-29 01:15:31,703 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0115_stage1_step500.svg
[rank0]:2025-12-29 01:15:31,706 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0115_stage0_step500.svg
[rank3]:2025-12-29 01:15:31,802 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0115_step500_rank3.svg
[rank3]:			> Batch Time: 1000.19 ms, GPU Bubble Ratio: 71.48%, 65.23%, 72.97%, 27.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  217-18-236ms   | [S0,MB4,F]  235-16-252ms   | [S0,MB1,B]  325-18-343ms   | [S0,MB5,F]  342-16-359ms   | [S0,MB2,B]  434-18-453ms   | [S0,MB6,F]  453-16-469ms   | [S0,MB3,B]  545-18-563ms   | [S0,MB7,F]  564-16-580ms   | [S0,MB4,B]  656-18-675ms   | [S0,MB5,B]  767-18-785ms   | [S0,MB6,B]  873-18-892ms   | [S0,MB7,B]  981-18-1000ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  186-23-209ms   | [S1,MB3,F]  214-20-234ms   | [S1,MB1,B]  294-23-317ms   | [S1,MB4,F]  321-20-342ms   | [S1,MB2,B]  403-23-426ms   | [S1,MB5,F]  431-20-451ms   | [S1,MB3,B]  514-23-537ms   | [S1,MB6,F]  541-20-562ms   | [S1,MB4,B]  625-23-648ms   | [S1,MB7,F]  653-20-673ms   | [S1,MB5,B]  737-23-760ms   | [S1,MB6,B]  844-23-867ms   | [S1,MB7,B]  952-23-975ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  157-18-176ms   | [S2,MB2,F]  183-15-198ms   | [S2,MB1,B]  265-18-283ms   | [S2,MB3,F]  290-15-306ms   | [S2,MB2,B]  375-18-393ms   | [S2,MB4,F]  400-15-416ms   | [S2,MB3,B]  485-18-504ms   | [S2,MB5,F]  511-15-526ms   | [S2,MB4,B]  597-18-615ms   | [S2,MB6,F]  622-15-637ms   | [S2,MB5,B]  708-18-726ms   | [S2,MB7,F]  734-15-749ms   | [S2,MB6,B]  819-18-837ms   | [S2,MB7,B]  927-18-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-59-147ms    | [S3,MB1,F]  154-25-180ms   | [S3,MB1,B]  192-62-255ms   | [S3,MB2,F]  262-26-289ms   | [S3,MB2,B]  301-64-365ms   | [S3,MB3,F]  372-26-399ms   | [S3,MB3,B]  411-64-476ms   | [S3,MB4,F]  483-27-510ms   | [S3,MB4,B]  522-65-587ms   | [S3,MB5,F]  594-26-621ms   | [S3,MB5,B]  633-64-698ms   | [S3,MB6,F]  705-27-733ms   | [S3,MB6,B]  745-64-809ms   | [S3,MB7,F]  816-27-843ms   | [S3,MB7,B]  857-64-921ms  
[rank2]:2025-12-29 01:15:31,854 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0115_rank2_stage2.svg
[rank2]:	> Counts Sum: 1096, Total Sum: 1620 (67.65%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 8.88, 17.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 75.55, 17.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 40.0, 8.88, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 17.77, 8.88]
[rank3]:2025-12-29 01:15:31,849 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0115_stage3_step500.svg
[rank1]:2025-12-29 01:15:31,847 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0115_rank1_stage1.svg
[rank1]:	> Counts Sum: 1359, Total Sum: 2025 (67.11%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 31.11, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 20.0, 22.22, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 68.88, 37.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 40.0, 0.0]
[rank0]:2025-12-29 01:15:31,869 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0115_rank0_stage0.svg
[rank0]:	> Counts Sum: 1090, Total Sum: 1665 (65.47%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 37.77, 2.22, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.11, 28.88, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 20.0, 2.22]
[rank3]:2025-12-29 01:15:31,979 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0115_rank3_stage3.svg
[rank3]:	> Counts Sum: 788, Total Sum: 1305 (60.38%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 17.77, 11.11, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 33.33, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 8.88, 0.0, 0.0]
[rank3]:2025-12-29 01:16:15,981 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:16:15,958 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:16:15,965 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:16:15,991 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:16:56,616 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:16:56,586 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:16:56,586 - Freezing Ratio: [Stage1] 0.93, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:16:56,587 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:17:37,275 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:17:37,275 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:17:37,276 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:17:37,308 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:18:17,842 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:18:17,842 - Freezing Ratio: [Stage1] 0.91, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:18:17,843 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:18:17,872 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:18:58,386 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:18:58,385 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:18:58,395 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 01:18:58,398 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:18:58,416 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:19:02,401 - Avg. fwd time: 26.0930 / Avg. bwd time: 68.4020 / Avg. batch time: 901.1603 (ms) / GPU bubble ratio: 16.11%
[rank2]:2025-12-29 01:19:02,429 - Avg. fwd time: 15.5221 / Avg. bwd time: 22.7320 / Avg. batch time: 946.1459 (ms) / GPU bubble ratio: 67.65%
[rank2]:2025-12-29 01:19:02,488 -  step: 550  loss: -4.0000  grad_norm:  0.3832  memory:  9.58GiB(20.16%)  tps: 7,771  tflops: 60.75  mfu: 19.47%
[rank3]:2025-12-29 01:19:02,504 -  step: 550  loss:  0.3142  grad_norm:  0.3832  memory: 27.97GiB(58.88%)  tps: 7,770  tflops: 60.75  mfu: 19.47%
[rank1]:2025-12-29 01:19:02,461 - Avg. fwd time: 20.2720 / Avg. bwd time: 29.2472 / Avg. batch time: 1001.8816 (ms) / GPU bubble ratio: 60.46%
[rank1]:2025-12-29 01:19:02,488 -  step: 550  loss: -4.0000  grad_norm:  0.3832  memory: 14.00GiB(29.46%)  tps: 7,771  tflops: 60.75  mfu: 19.47%
[rank0]:2025-12-29 01:19:02,487 - Avg. fwd time: 16.7494 / Avg. bwd time: 24.6218 / Avg. batch time: 1049.6898 (ms) / GPU bubble ratio: 68.47%
[rank0]:2025-12-29 01:19:02,489 -  step: 550  loss: -4.0000  grad_norm:  0.3832  memory: 18.76GiB(39.49%)  tps: 7,771  tflops: 60.75  mfu: 19.47%
[rank2]:2025-12-29 01:19:39,123 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:19:39,153 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:19:39,123 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:19:39,124 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:20:20,047 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:20:20,077 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:20:20,047 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:20:20,048 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:21:00,865 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:21:00,835 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:21:00,835 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:21:00,836 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:21:41,597 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:21:41,596 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:21:41,597 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:21:41,626 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:22:22,308 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:22:22,309 - Freezing Ratio: [Stage0] 0.08, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:22:22,336 - Freezing Ratio: [Stage3] 0.07, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:22:22,307 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:22:22,307 - Freezing Ratio: [Stage1] 0.11, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:22:27,123 - Avg. fwd time: 26.1461 / Avg. bwd time: 68.0499 / Avg. batch time: 898.7709 (ms) / GPU bubble ratio: 16.16%
[rank2]:2025-12-29 01:22:27,168 - Avg. fwd time: 15.5406 / Avg. bwd time: 22.3833 / Avg. batch time: 943.3864 (ms) / GPU bubble ratio: 67.84%
[rank1]:2025-12-29 01:22:27,223 - Avg. fwd time: 20.2902 / Avg. bwd time: 28.7782 / Avg. batch time: 998.6481 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-12-29 01:22:27,300 -  step: 600  loss: -4.0000  grad_norm:  7.0048  memory: 14.00GiB(29.46%)  tps: 8,000  tflops: 62.54  mfu: 20.04%
[rank0]:2025-12-29 01:22:27,275 - Avg. fwd time: 16.7677 / Avg. bwd time: 24.0859 / Avg. batch time: 1045.9035 (ms) / GPU bubble ratio: 68.75%
[rank3]:2025-12-29 01:22:27,309 -  step: 600  loss:  0.2865  grad_norm:  7.0048  memory: 27.97GiB(58.88%)  tps: 8,000  tflops: 62.54  mfu: 20.04%
[rank2]:2025-12-29 01:22:27,296 -  step: 600  loss: -4.0000  grad_norm:  7.0048  memory:  9.58GiB(20.16%)  tps: 8,000  tflops: 62.54  mfu: 20.04%
[rank2]:2025-12-29 01:22:27,366 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0122_stage2_step600.svg
[rank1]:2025-12-29 01:22:27,367 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0122_stage1_step600.svg
[rank0]:2025-12-29 01:22:27,312 -  step: 600  loss: -4.0000  grad_norm:  7.0048  memory: 18.76GiB(39.49%)  tps: 7,999  tflops: 62.53  mfu: 20.04%
[rank0]:2025-12-29 01:22:27,380 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0122_stage0_step600.svg
[rank3]:2025-12-29 01:22:27,462 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0122_step600_rank3.svg
[rank3]:			> Batch Time: 998.31 ms, GPU Bubble Ratio: 72.49%, 65.08%, 72.82%, 27.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-18-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB0,B]  217-17-234ms   | [S0,MB4,F]  234-16-250ms   | [S0,MB1,B]  325-17-343ms   | [S0,MB5,F]  343-16-359ms   | [S0,MB2,B]  434-17-451ms   | [S0,MB6,F]  452-16-468ms   | [S0,MB3,B]  546-17-563ms   | [S0,MB7,F]  563-16-579ms   | [S0,MB4,B]  656-17-673ms   | [S0,MB5,B]  767-17-784ms   | [S0,MB6,B]  873-17-890ms   | [S0,MB7,B]  981-17-998ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  186-23-209ms   | [S1,MB3,F]  213-20-234ms   | [S1,MB1,B]  294-23-317ms   | [S1,MB4,F]  322-20-342ms   | [S1,MB2,B]  403-23-426ms   | [S1,MB5,F]  431-20-451ms   | [S1,MB3,B]  514-23-538ms   | [S1,MB6,F]  542-20-563ms   | [S1,MB4,B]  625-23-648ms   | [S1,MB7,F]  653-20-673ms   | [S1,MB5,B]  737-23-760ms   | [S1,MB6,B]  843-23-866ms   | [S1,MB7,B]  951-23-974ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  157-18-176ms   | [S2,MB2,F]  183-15-198ms   | [S2,MB1,B]  266-18-284ms   | [S2,MB3,F]  291-15-307ms   | [S2,MB2,B]  375-18-393ms   | [S2,MB4,F]  400-15-416ms   | [S2,MB3,B]  486-18-504ms   | [S2,MB5,F]  511-15-527ms   | [S2,MB4,B]  597-18-615ms   | [S2,MB6,F]  622-15-637ms   | [S2,MB5,B]  709-18-727ms   | [S2,MB7,F]  734-15-750ms   | [S2,MB6,B]  819-18-837ms   | [S2,MB7,B]  927-18-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-60-148ms    | [S3,MB1,F]  154-25-180ms   | [S3,MB1,B]  193-62-256ms   | [S3,MB2,F]  263-27-290ms   | [S3,MB2,B]  301-64-366ms   | [S3,MB3,F]  372-26-399ms   | [S3,MB3,B]  411-64-475ms   | [S3,MB4,F]  483-27-511ms   | [S3,MB4,B]  523-64-587ms   | [S3,MB5,F]  594-26-621ms   | [S3,MB5,B]  634-64-699ms   | [S3,MB6,F]  706-27-733ms   | [S3,MB6,B]  744-64-809ms   | [S3,MB7,F]  816-27-843ms   | [S3,MB7,B]  856-64-921ms  
[rank3]:2025-12-29 01:22:27,511 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0122_stage3_step600.svg
[rank2]:2025-12-29 01:22:27,516 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0122_rank2_stage2.svg
[rank2]:	> Counts Sum: 1364, Total Sum: 1980 (68.89%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 7.27, 14.54, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 61.81, 14.54, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 47.27, 7.27, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 29.09, 7.27]
[rank1]:2025-12-29 01:22:27,514 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0122_rank1_stage1.svg
[rank1]:	> Counts Sum: 1724, Total Sum: 2475 (69.66%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 10.9, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 27.27, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 30.9, 34.54, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 72.72, 45.45, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 49.09, 0.0]
[rank0]:2025-12-29 01:22:27,532 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0122_rank0_stage0.svg
[rank0]:	> Counts Sum: 1376, Total Sum: 2035 (67.62%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 47.27, 1.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 21.81, 25.45, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 30.9, 1.81]
[rank3]:2025-12-29 01:22:27,642 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0122_rank3_stage3.svg
[rank3]:	> Counts Sum: 994, Total Sum: 1595 (62.32%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 14.54, 9.09, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 43.63, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 21.81, 0.0, 0.0]
[rank2]:2025-12-29 01:23:11,589 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:23:11,612 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:23:11,596 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:23:11,622 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:23:52,191 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:23:52,158 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:23:52,158 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:23:52,159 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:24:32,787 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:24:32,817 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:24:32,787 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:24:32,786 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:25:13,505 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:25:13,475 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:25:13,475 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:25:13,476 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:25:54,203 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:25:54,234 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:25:54,202 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:25:54,212 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 01:25:54,214 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:25:58,208 - Avg. fwd time: 15.5454 / Avg. bwd time: 22.3023 / Avg. batch time: 942.6965 (ms) / GPU bubble ratio: 67.88%
[rank3]:2025-12-29 01:25:58,180 - Avg. fwd time: 26.1584 / Avg. bwd time: 67.9614 / Avg. batch time: 898.1601 (ms) / GPU bubble ratio: 16.17%
[rank1]:2025-12-29 01:25:58,241 - Avg. fwd time: 20.2984 / Avg. bwd time: 28.6596 / Avg. batch time: 997.8318 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-12-29 01:25:58,269 -  step: 650  loss: -4.0000  grad_norm:  0.5905  memory: 14.00GiB(29.46%)  tps: 7,766  tflops: 60.71  mfu: 19.46%
[rank0]:2025-12-29 01:25:58,268 - Avg. fwd time: 16.7727 / Avg. bwd time: 23.9346 / Avg. batch time: 1044.9294 (ms) / GPU bubble ratio: 68.83%
[rank0]:2025-12-29 01:25:58,270 -  step: 650  loss: -4.0000  grad_norm:  0.5905  memory: 18.76GiB(39.49%)  tps: 7,767  tflops: 60.72  mfu: 19.46%
[rank2]:2025-12-29 01:25:58,269 -  step: 650  loss: -4.0000  grad_norm:  0.5905  memory:  9.58GiB(20.16%)  tps: 7,766  tflops: 60.71  mfu: 19.46%
[rank3]:2025-12-29 01:25:58,285 -  step: 650  loss:  0.2887  grad_norm:  0.5905  memory: 27.97GiB(58.88%)  tps: 7,766  tflops: 60.71  mfu: 19.46%
[rank2]:2025-12-29 01:26:34,867 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:26:34,896 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:26:34,866 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:26:34,867 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:27:15,362 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:27:15,362 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:27:15,363 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:27:15,392 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:27:55,998 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:27:56,028 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:27:55,997 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:27:55,998 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:28:36,760 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:28:36,760 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:28:36,760 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:28:36,790 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:29:17,542 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:29:17,543 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:29:17,545 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:29:17,543 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:29:17,572 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:29:21,529 - Avg. fwd time: 26.1917 / Avg. bwd time: 67.6462 / Avg. batch time: 895.9035 (ms) / GPU bubble ratio: 16.21%
[rank2]:2025-12-29 01:29:21,558 - Avg. fwd time: 15.5582 / Avg. bwd time: 22.0086 / Avg. batch time: 940.1291 (ms) / GPU bubble ratio: 68.03%
[rank2]:2025-12-29 01:29:21,619 -  step: 700  loss: -4.0000  grad_norm:  0.4071  memory:  9.58GiB(20.16%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank3]:2025-12-29 01:29:21,635 -  step: 700  loss:  0.2587  grad_norm:  0.4071  memory: 27.97GiB(58.88%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank1]:2025-12-29 01:29:21,591 - Avg. fwd time: 20.3091 / Avg. bwd time: 28.2655 / Avg. batch time: 994.8668 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-12-29 01:29:21,619 -  step: 700  loss: -4.0000  grad_norm:  0.4071  memory: 14.00GiB(29.46%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank0]:2025-12-29 01:29:21,618 - Avg. fwd time: 16.7858 / Avg. bwd time: 23.4663 / Avg. batch time: 1041.4853 (ms) / GPU bubble ratio: 69.08%
[rank0]:2025-12-29 01:29:21,620 -  step: 700  loss: -4.0000  grad_norm:  0.4071  memory: 18.76GiB(39.49%)  tps: 8,057  tflops: 62.99  mfu: 20.19%
[rank2]:2025-12-29 01:29:21,686 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0129_stage2_step700.svg
[rank1]:2025-12-29 01:29:21,685 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0129_stage1_step700.svg
[rank0]:2025-12-29 01:29:21,686 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0129_stage0_step700.svg
[rank2]:2025-12-29 01:29:21,840 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0129_rank2_stage2.svg
[rank2]:	> Counts Sum: 1653, Total Sum: 2340 (70.64%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 6.15, 12.3, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 52.3, 12.3, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 40.0, 6.15, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 38.46, 6.15]
[rank3]:2025-12-29 01:29:21,779 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0129_step700_rank3.svg
[rank3]:			> Batch Time: 999.39 ms, GPU Bubble Ratio: 72.57%, 65.17%, 72.86%, 27.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  217-17-235ms   | [S0,MB4,F]  235-16-251ms   | [S0,MB1,B]  326-17-344ms   | [S0,MB5,F]  344-16-360ms   | [S0,MB2,B]  437-17-455ms   | [S0,MB6,F]  455-16-471ms   | [S0,MB3,B]  549-17-566ms   | [S0,MB7,F]  566-16-582ms   | [S0,MB4,B]  659-17-676ms   | [S0,MB5,B]  768-17-785ms   | [S0,MB6,B]  876-17-893ms   | [S0,MB7,B]  982-17-999ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  186-23-209ms   | [S1,MB3,F]  214-20-235ms   | [S1,MB1,B]  295-23-319ms   | [S1,MB4,F]  323-20-344ms   | [S1,MB2,B]  406-23-429ms   | [S1,MB5,F]  434-20-454ms   | [S1,MB3,B]  517-23-541ms   | [S1,MB6,F]  545-20-566ms   | [S1,MB4,B]  628-23-651ms   | [S1,MB7,F]  656-20-676ms   | [S1,MB5,B]  738-23-761ms   | [S1,MB6,B]  846-23-869ms   | [S1,MB7,B]  952-23-975ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-51ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  158-18-176ms   | [S2,MB2,F]  183-15-199ms   | [S2,MB1,B]  267-18-285ms   | [S2,MB3,F]  292-15-308ms   | [S2,MB2,B]  378-18-396ms   | [S2,MB4,F]  403-15-419ms   | [S2,MB3,B]  489-18-507ms   | [S2,MB5,F]  514-15-530ms   | [S2,MB4,B]  599-18-618ms   | [S2,MB6,F]  625-15-641ms   | [S2,MB5,B]  710-18-728ms   | [S2,MB7,F]  735-15-751ms   | [S2,MB6,B]  821-18-840ms   | [S2,MB7,B]  927-18-946ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  51-23-75ms     | [S3,MB0,B]  87-60-148ms    | [S3,MB1,F]  155-25-181ms   | [S3,MB1,B]  193-64-257ms   | [S3,MB2,F]  264-27-291ms   | [S3,MB2,B]  302-64-367ms   | [S3,MB3,F]  375-27-402ms   | [S3,MB3,B]  414-64-479ms   | [S3,MB4,F]  486-27-513ms   | [S3,MB4,B]  525-64-589ms   | [S3,MB5,F]  596-27-624ms   | [S3,MB5,B]  636-64-700ms   | [S3,MB6,F]  707-27-734ms   | [S3,MB6,B]  747-64-812ms   | [S3,MB7,F]  819-27-846ms   | [S3,MB7,B]  857-64-922ms  
[rank3]:2025-12-29 01:29:21,830 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0129_stage3_step700.svg
[rank1]:2025-12-29 01:29:21,830 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0129_rank1_stage1.svg
[rank1]:	> Counts Sum: 2122, Total Sum: 2925 (72.55%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 23.07, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 23.07, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 40.0, 43.07, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 67.69, 52.3, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 53.84, 0.0]
[rank0]:2025-12-29 01:29:21,843 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0129_rank0_stage0.svg
[rank0]:	> Counts Sum: 1691, Total Sum: 2405 (70.31%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 53.84, 1.53, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 30.76, 21.53, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 38.46, 1.53]
[rank3]:2025-12-29 01:29:21,961 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0129_rank3_stage3.svg
[rank3]:	> Counts Sum: 1215, Total Sum: 1885 (64.46%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 12.3, 7.69, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 40.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 32.3, 0.0, 0.0]
[rank2]:2025-12-29 01:29:58,436 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:29:58,436 - Freezing Ratio: [Stage1] 0.04, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:29:58,466 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:29:58,437 - Freezing Ratio: [Stage0] 0.08, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:30:47,337 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:30:47,344 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:30:47,360 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:30:47,370 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:31:28,068 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:31:28,098 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:31:28,068 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:31:28,069 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:32:08,765 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:32:08,765 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:32:08,766 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:32:08,795 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:32:49,394 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:32:49,425 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:32:49,394 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:32:49,404 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 01:32:49,406 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:32:53,471 - Avg. fwd time: 15.5594 / Avg. bwd time: 21.9867 / Avg. batch time: 940.0062 (ms) / GPU bubble ratio: 68.05%
[rank1]:2025-12-29 01:32:53,504 - Avg. fwd time: 20.3139 / Avg. bwd time: 28.2292 / Avg. batch time: 994.7026 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-12-29 01:32:53,533 -  step: 750  loss: -4.0000  grad_norm:  0.2382  memory: 14.00GiB(29.46%)  tps: 7,731  tflops: 60.44  mfu: 19.37%
[rank3]:2025-12-29 01:32:53,443 - Avg. fwd time: 26.1983 / Avg. bwd time: 67.6260 / Avg. batch time: 895.7953 (ms) / GPU bubble ratio: 16.21%
[rank0]:2025-12-29 01:32:53,531 - Avg. fwd time: 16.7868 / Avg. bwd time: 23.4085 / Avg. batch time: 1041.2583 (ms) / GPU bubble ratio: 69.12%
[rank0]:2025-12-29 01:32:53,533 -  step: 750  loss: -4.0000  grad_norm:  0.2382  memory: 18.76GiB(39.49%)  tps: 7,731  tflops: 60.44  mfu: 19.37%
[rank2]:2025-12-29 01:32:53,533 -  step: 750  loss: -4.0000  grad_norm:  0.2382  memory:  9.58GiB(20.16%)  tps: 7,731  tflops: 60.44  mfu: 19.37%
[rank3]:2025-12-29 01:32:53,548 -  step: 750  loss:  0.3071  grad_norm:  0.2382  memory: 27.97GiB(58.88%)  tps: 7,732  tflops: 60.44  mfu: 19.37%
[rank1]:2025-12-29 01:33:30,180 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:33:30,180 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:33:30,180 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:33:30,211 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:34:10,977 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:34:10,976 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:34:11,006 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:34:10,976 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:34:51,593 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:34:51,592 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:34:51,592 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:34:51,622 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:35:32,112 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:35:32,112 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:35:32,142 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:35:32,113 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-29 01:36:12,700 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-29 01:36:12,701 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:36:12,702 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank2]:2025-12-29 01:36:12,700 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:36:12,730 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank3]:2025-12-29 01:36:16,750 - Avg. fwd time: 26.2257 / Avg. bwd time: 67.3795 / Avg. batch time: 894.0395 (ms) / GPU bubble ratio: 16.24%
[rank2]:2025-12-29 01:36:16,779 - Avg. fwd time: 15.5711 / Avg. bwd time: 21.7498 / Avg. batch time: 937.9999 (ms) / GPU bubble ratio: 68.17%
[rank0]:2025-12-29 01:36:16,840 - Avg. fwd time: 16.7948 / Avg. bwd time: 23.0330 / Avg. batch time: 1038.5389 (ms) / GPU bubble ratio: 69.32%
[rank0]:2025-12-29 01:36:16,842 -  step: 800  loss: -4.0000  grad_norm:  0.1865  memory: 18.76GiB(39.49%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank0]:2025-12-29 01:36:16,842 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1865  tps: 8,202  tflops: 64.12  mfu: 18.74%
[rank0]:2025-12-29 01:36:16,842 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-29 01:36:16,843 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-29 01:36:16,857 -  step: 800  loss:  0.2920  grad_norm:  0.1865  memory: 27.97GiB(58.88%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank3]:2025-12-29 01:36:16,858 - â„¹ï¸ final step: 800  loss:  0.2920  grad_norm:  0.1865  tps: 8,206  tflops: 64.15  mfu: 18.86%
[rank3]:2025-12-29 01:36:16,858 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-29 01:36:16,859 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-29 01:36:16,842 -  step: 800  loss: -4.0000  grad_norm:  0.1865  memory:  9.58GiB(20.16%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank2]:2025-12-29 01:36:16,842 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1865  tps: 8,200  tflops: 64.11  mfu: 18.73%
[rank2]:2025-12-29 01:36:16,842 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-29 01:36:16,842 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-29 01:36:16,813 - Avg. fwd time: 20.3236 / Avg. bwd time: 27.9118 / Avg. batch time: 992.3747 (ms) / GPU bubble ratio: 61.12%
[rank1]:2025-12-29 01:36:16,842 -  step: 800  loss: -4.0000  grad_norm:  0.1865  memory: 14.00GiB(29.46%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank1]:2025-12-29 01:36:16,842 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1865  tps: 8,202  tflops: 64.12  mfu: 18.75%
[rank1]:2025-12-29 01:36:16,842 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-29 01:36:16,843 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-29 01:36:18,929 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-29 01:36:18,991 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank2/251229_0136_stage2_final800.svg
[rank1]:2025-12-29 01:36:18,991 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank1/251229_0136_stage1_final800.svg
[rank0]:2025-12-29 01:36:18,992 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank0/251229_0136_stage0_final800.svg
[rank3]:2025-12-29 01:36:19,085 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0136_final800_rank3.svg
[rank3]:			> Batch Time: 1002.14 ms, GPU Bubble Ratio: 71.65%, 65.25%, 72.99%, 27.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-51ms     | [S0,MB3,F]  51-17-69ms     | [S0,MB0,B]  217-18-236ms   | [S0,MB4,F]  235-16-252ms   | [S0,MB1,B]  326-18-344ms   | [S0,MB5,F]  344-16-360ms   | [S0,MB2,B]  436-18-455ms   | [S0,MB6,F]  454-16-470ms   | [S0,MB3,B]  547-18-566ms   | [S0,MB7,F]  565-16-581ms   | [S0,MB4,B]  658-18-677ms   | [S0,MB5,B]  768-18-787ms   | [S0,MB6,B]  876-18-894ms   | [S0,MB7,B]  983-18-1002ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  186-23-209ms   | [S1,MB3,F]  214-20-234ms   | [S1,MB1,B]  295-23-318ms   | [S1,MB4,F]  322-20-343ms   | [S1,MB2,B]  405-23-428ms   | [S1,MB5,F]  433-20-453ms   | [S1,MB3,B]  516-23-539ms   | [S1,MB6,F]  544-20-565ms   | [S1,MB4,B]  627-23-650ms   | [S1,MB7,F]  655-20-675ms   | [S1,MB5,B]  739-23-762ms   | [S1,MB6,B]  846-23-869ms   | [S1,MB7,B]  954-23-977ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  158-18-176ms   | [S2,MB2,F]  183-15-199ms   | [S2,MB1,B]  266-18-285ms   | [S2,MB3,F]  292-15-307ms   | [S2,MB2,B]  377-18-395ms   | [S2,MB4,F]  402-15-418ms   | [S2,MB3,B]  488-18-506ms   | [S2,MB5,F]  513-15-529ms   | [S2,MB4,B]  599-18-617ms   | [S2,MB6,F]  624-15-640ms   | [S2,MB5,B]  710-18-728ms   | [S2,MB7,F]  735-15-751ms   | [S2,MB6,B]  821-18-839ms   | [S2,MB7,B]  929-18-947ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  87-60-148ms    | [S3,MB1,F]  155-25-180ms   | [S3,MB1,B]  193-63-257ms   | [S3,MB2,F]  263-26-290ms   | [S3,MB2,B]  302-64-367ms   | [S3,MB3,F]  374-26-401ms   | [S3,MB3,B]  413-64-478ms   | [S3,MB4,F]  485-27-512ms   | [S3,MB4,B]  524-64-589ms   | [S3,MB5,F]  596-26-623ms   | [S3,MB5,B]  635-64-700ms   | [S3,MB6,F]  707-27-734ms   | [S3,MB6,B]  746-64-811ms   | [S3,MB7,F]  818-26-845ms   | [S3,MB7,B]  858-64-923ms  
[rank0]:2025-12-29 01:36:19,144 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0136_rank0_stage0.svg
[rank0]:	> Counts Sum: 1979, Total Sum: 2775 (71.32%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 58.66, 1.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 38.66, 18.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 45.33, 1.33]
[rank0]:2025-12-29 01:36:19,144 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-29 01:36:19,141 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0136_rank2_stage2.svg
[rank2]:	> Counts Sum: 1913, Total Sum: 2700 (70.85%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 5.33, 10.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 45.33, 10.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 34.66, 5.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 44.0, 5.33]
[rank2]:2025-12-29 01:36:19,142 - Destroying the purge thread.
[rank1]:2025-12-29 01:36:19,137 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0136_rank1_stage1.svg
[rank1]:	> Counts Sum: 2479, Total Sum: 3375 (73.45%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 30.66, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 20.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 46.66, 48.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 58.66, 56.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 58.66, 0.0]
[rank1]:2025-12-29 01:36:19,137 - Destroying the purge thread.
[rank3]:2025-12-29 01:36:19,220 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/pipeline_schedule/251229_0136_thry_final800_rank3.svg
[rank3]:			> Batch Time: 653.00 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-39ms     | [S0,MB2,F]  39-19-59ms     | [S0,MB3,F]  59-19-79ms     | [S0,MB0,B]  197-39-237ms   | [S0,MB4,F]  237-19-257ms   | [S0,MB1,B]  257-39-296ms   | [S0,MB5,F]  296-19-316ms   | [S0,MB2,B]  316-39-356ms   | [S0,MB6,F]  356-19-375ms   | [S0,MB3,B]  375-39-415ms   | [S0,MB7,F]  415-19-435ms   | [S0,MB4,B]  435-39-474ms   | [S0,MB5,B]  494-39-534ms   | [S0,MB6,B]  554-39-593ms   | [S0,MB7,B]  613-39-652ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-39ms     | [S1,MB1,F]  39-19-59ms     | [S1,MB2,F]  59-19-79ms     | [S1,MB0,B]  158-39-197ms   | [S1,MB3,F]  197-19-217ms   | [S1,MB1,B]  217-39-257ms   | [S1,MB4,F]  257-19-277ms   | [S1,MB2,B]  277-39-316ms   | [S1,MB5,F]  316-19-336ms   | [S1,MB3,B]  336-39-375ms   | [S1,MB6,F]  375-19-395ms   | [S1,MB4,B]  395-39-435ms   | [S1,MB7,F]  435-19-455ms   | [S1,MB5,B]  455-39-494ms   | [S1,MB6,B]  514-39-554ms   | [S1,MB7,B]  573-39-613ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  39-19-59ms     | [S2,MB1,F]  59-19-79ms     | [S2,MB0,B]  118-39-158ms   | [S2,MB2,F]  158-19-178ms   | [S2,MB1,B]  178-39-217ms   | [S2,MB3,F]  217-19-237ms   | [S2,MB2,B]  237-39-277ms   | [S2,MB4,F]  277-19-296ms   | [S2,MB3,B]  296-39-336ms   | [S2,MB5,F]  336-19-356ms   | [S2,MB4,B]  356-39-395ms   | [S2,MB6,F]  395-19-415ms   | [S2,MB5,B]  415-39-455ms   | [S2,MB7,F]  455-19-474ms   | [S2,MB6,B]  474-39-514ms   | [S2,MB7,B]  534-39-573ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  59-19-79ms     | [S3,MB0,B]  79-39-118ms    | [S3,MB1,F]  118-19-138ms   | [S3,MB1,B]  138-39-178ms   | [S3,MB2,F]  178-19-197ms   | [S3,MB2,B]  197-39-237ms   | [S3,MB3,F]  237-19-257ms   | [S3,MB3,B]  257-39-296ms   | [S3,MB4,F]  296-19-316ms   | [S3,MB4,B]  316-39-356ms   | [S3,MB5,F]  356-19-375ms   | [S3,MB5,B]  375-39-415ms   | [S3,MB6,F]  415-19-435ms   | [S3,MB6,B]  435-39-474ms   | [S3,MB7,F]  474-19-494ms   | [S3,MB7,B]  494-39-534ms  
[rank3]:2025-12-29 01:36:19,271 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_ratio_history/rank3/251229_0136_stage3_final800.svg
[rank3]:2025-12-29 01:36:19,398 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1/frozen_params_histogram/251229_0136_rank3_stage3.svg
[rank3]:	> Counts Sum: 1412, Total Sum: 2175 (64.92%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 10.66, 6.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 34.66, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 38.66, 0.0, 0.0]
[rank3]:2025-12-29 01:36:19,399 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-29 01:36:19,459 - Process group destroyed
[rank1]:2025-12-29 01:36:19,460 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 354-374
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–‚â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–„â–ƒâ–‚â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–„â–ƒâ–‚â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.99301
[rank3]:wandb:               final/avg_loss 0.29203
[rank3]:wandb:             final/avg_mfu(%) 18.86453
[rank3]:wandb:             final/avg_tflops 64.15347
[rank3]:wandb:    final/avg_throughput(tps) 8206.35079
[rank3]:wandb:              final/grad_norm 0.18653
[rank3]:wandb:               final/max_loss 0.29203
[rank3]:wandb:                    grad_norm 0.18653
[rank3]:wandb: loss_metrics/global_avg_loss 0.29203
[rank3]:wandb: loss_metrics/global_max_loss 0.29203
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_1F1B_apf_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ub0wwsdd
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_1F1B_apf_11_dm1/20251229-0039/wandb/run-20251229_003941-ub0wwsdd/logs
[rank3]:2025-12-29 01:36:20,974 - Process group destroyed
[rank0]:2025-12-29 01:36:21,144 - Training completed
[rank0]:2025-12-29 01:36:21,145 - Destroying the purge thread.
[rank0]:2025-12-29 01:36:21,546 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.2', 'layers.1', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.8', 'layers.6', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.15', 'layers.13', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_1F1B_apf_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_1F1B_apf_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_1F1B_apf_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_1F1B_apf_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_1F1B_apf_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_1F1B_apf_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_1F1B_apf_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_1F1B_apf_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
