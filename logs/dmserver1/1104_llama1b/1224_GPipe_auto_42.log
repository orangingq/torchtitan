
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 13:58:49 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_GPipe_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-24 13:58:56,244 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-24 13:58:56,357 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank2]:2025-12-24 13:58:56,352 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank1]:2025-12-24 13:58:56,415 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-24 13:58:56,424 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 13:58:56,427 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 13:58:56,664 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 13:58:56,667 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 13:58:56,671 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 13:58:56,672 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-24 13:58:56,639 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 13:58:56,642 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-24 13:58:56,730 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 13:58:56,733 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 13:58:57,070 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-24 13:58:59,893 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-24 13:59:00,022 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 13:59:00,045 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 13:59:00,084 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 13:59:00,085 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-24 13:59:00,111 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-24 13:59:00,111 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-24 13:59:00,086 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 13:59:00,115 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-24 13:59:00,115 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-24 13:59:00,321 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 13:59:00,321 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 13:59:00,322 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-24 13:59:00,313 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 13:59:00,313 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 13:59:00,314 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-24 13:59:00,453 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 13:59:00,493 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 13:59:00,522 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-24 13:59:00,522 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-24 13:59:00,728 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 13:59:00,729 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 13:59:00,729 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run d3qktkl9
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_GPipe_auto_42_dm1/20251224-1358/wandb/run-20251224_135901-d3qktkl9
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_GPipe_auto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/d3qktkl9
[rank3]:2025-12-24 13:59:02,084 - WandB logging enabled
[rank3]:2025-12-24 13:59:02,085 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 13:59:02,124 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 13:59:02,150 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-24 13:59:02,151 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-24 13:59:02,352 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_GPipe_auto_42_dm1
[rank0]:2025-12-24 13:59:02,352 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 13:59:02,352 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 13:59:02,353 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-24 13:59:02,352 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-24 13:59:02,335 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 13:59:02,335 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 13:59:02,336 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 13:59:02,352 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-24 13:59:02,352 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 13:59:04,972 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 13:59:04,973 - Finished loading the checkpoint in 2.62 seconds.
[rank0]:2025-12-24 13:59:04,973 - Training starts at step 1
[rank2]:2025-12-24 13:59:10,524 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 10.24GiB(21.56%)  tps: 3,140  tflops: 24.54  mfu: 7.87%
[rank2]:2025-12-24 13:59:10,524 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-24 13:59:10,534 -  step:  1  loss: 10.6088  grad_norm: 116.5372  memory: 24.19GiB(50.91%)  tps: 3,897  tflops: 30.47  mfu: 9.77%
[rank3]:2025-12-24 13:59:10,535 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 13:59:10,525 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 12.75GiB(26.83%)  tps: 3,267  tflops: 25.54  mfu: 8.18%
[rank1]:2025-12-24 13:59:10,525 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 13:59:10,558 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 13.25GiB(27.89%)  tps: 3,129  tflops: 24.46  mfu: 7.84%
[rank0]:2025-12-24 13:59:10,558 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-24 14:01:10,061 - Avg. fwd time: 7.1733 / Avg. bwd time: 19.6877 / Avg. batch time: 527.3112 (ms) / GPU bubble ratio: 59.25%
[rank3]:2025-12-24 14:01:10,036 - Avg. fwd time: 10.8178 / Avg. bwd time: 43.5172 / Avg. batch time: 494.5181 (ms) / GPU bubble ratio: 12.10%
[rank1]:2025-12-24 14:01:10,092 - Avg. fwd time: 9.2330 / Avg. bwd time: 25.2741 / Avg. batch time: 567.9472 (ms) / GPU bubble ratio: 51.39%
[rank0]:2025-12-24 14:01:10,121 - Avg. fwd time: 8.2040 / Avg. bwd time: 24.9481 / Avg. batch time: 606.8299 (ms) / GPU bubble ratio: 56.29%
[rank0]:2025-12-24 14:03:09,674 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 14:03:14,538 - Avg. fwd time: 10.8170 / Avg. bwd time: 43.5736 / Avg. batch time: 494.7788 (ms) / GPU bubble ratio: 12.06%
[rank2]:2025-12-24 14:03:14,563 - Avg. fwd time: 7.1713 / Avg. bwd time: 19.7286 / Avg. batch time: 527.1905 (ms) / GPU bubble ratio: 59.18%
[rank0]:2025-12-24 14:03:14,623 - Avg. fwd time: 8.1921 / Avg. bwd time: 24.9846 / Avg. batch time: 606.0336 (ms) / GPU bubble ratio: 56.20%
[rank0]:2025-12-24 14:03:14,659 -  step: 50  loss: -8.0000  grad_norm: 12.9389  memory: 17.08GiB(35.95%)  tps: 6,578  tflops: 51.42  mfu: 16.48%
[rank1]:2025-12-24 14:03:14,593 - Avg. fwd time: 9.2441 / Avg. bwd time: 25.3519 / Avg. batch time: 567.5286 (ms) / GPU bubble ratio: 51.23%
[rank1]:2025-12-24 14:03:14,648 -  step: 50  loss: -8.0000  grad_norm: 12.9389  memory: 15.15GiB(31.89%)  tps: 6,577  tflops: 51.42  mfu: 16.48%
[rank3]:2025-12-24 14:03:14,657 -  step: 50  loss:  9.9251  grad_norm: 12.9389  memory: 26.98GiB(56.79%)  tps: 6,577  tflops: 51.42  mfu: 16.48%
[rank2]:2025-12-24 14:03:14,645 -  step: 50  loss: -8.0000  grad_norm: 12.9389  memory: 12.26GiB(25.80%)  tps: 6,577  tflops: 51.42  mfu: 16.48%
[rank2]:2025-12-24 14:03:59,557 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-24 14:03:59,562 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-24 14:03:59,557 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-24 14:03:59,557 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-24 14:04:49,460 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3477e+00
[rank1]:2025-12-24 14:04:49,453 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1178e+00
[rank0]:2025-12-24 14:04:49,466 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.5099e+00
[rank2]:2025-12-24 14:04:49,449 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1333e+00
[rank3]:2025-12-24 14:05:16,864 - Avg. fwd time: 10.8692 / Avg. bwd time: 43.1381 / Avg. batch time: 491.6429 (ms) / GPU bubble ratio: 12.12%
[rank1]:2025-12-24 14:05:16,912 - Avg. fwd time: 9.2440 / Avg. bwd time: 25.4374 / Avg. batch time: 563.5768 (ms) / GPU bubble ratio: 50.77%
[rank2]:2025-12-24 14:05:16,881 - Avg. fwd time: 7.2617 / Avg. bwd time: 19.0715 / Avg. batch time: 523.2449 (ms) / GPU bubble ratio: 59.74%
[rank0]:2025-12-24 14:05:16,943 - Avg. fwd time: 8.1903 / Avg. bwd time: 25.0196 / Avg. batch time: 601.9913 (ms) / GPU bubble ratio: 55.87%
[rank3]:2025-12-24 14:05:35,235 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6708e+00
[rank1]:2025-12-24 14:05:35,236 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5501e+00
[rank0]:2025-12-24 14:05:35,249 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.4067e+00
[rank2]:2025-12-24 14:05:35,220 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3284e+00
[rank3]:2025-12-24 14:06:25,192 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.3195e+00
[rank0]:2025-12-24 14:06:25,197 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3060e+01
[rank1]:2025-12-24 14:06:25,184 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6175e+00
[rank2]:2025-12-24 14:06:25,180 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0540e+00
[rank2]:2025-12-24 14:07:10,224 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0732e+00
[rank0]:2025-12-24 14:07:10,222 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 14:07:10,243 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7060e+00
[rank3]:2025-12-24 14:07:10,239 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4221e+00
[rank1]:2025-12-24 14:07:10,240 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1553e+00
[rank2]:2025-12-24 14:07:15,021 - Avg. fwd time: 7.3983 / Avg. bwd time: 18.0530 / Avg. batch time: 516.7954 (ms) / GPU bubble ratio: 60.60%
[rank0]:2025-12-24 14:07:15,070 - Avg. fwd time: 8.2533 / Avg. bwd time: 24.4650 / Avg. batch time: 594.9225 (ms) / GPU bubble ratio: 56.00%
[rank3]:2025-12-24 14:07:14,995 - Avg. fwd time: 10.9419 / Avg. bwd time: 42.4034 / Avg. batch time: 486.3060 (ms) / GPU bubble ratio: 12.24%
[rank1]:2025-12-24 14:07:15,040 - Avg. fwd time: 9.2593 / Avg. bwd time: 25.4218 / Avg. batch time: 557.1283 (ms) / GPU bubble ratio: 50.20%
[rank1]:2025-12-24 14:07:15,082 -  step: 100  loss: -8.0000  grad_norm:  8.3293  memory: 15.15GiB(31.89%)  tps: 6,814  tflops: 53.27  mfu: 17.07%
[rank2]:2025-12-24 14:07:15,092 -  step: 100  loss: -8.0000  grad_norm:  8.3293  memory: 12.26GiB(25.80%)  tps: 6,814  tflops: 53.27  mfu: 17.07%
[rank0]:2025-12-24 14:07:15,106 -  step: 100  loss: -8.0000  grad_norm:  8.3293  memory: 17.08GiB(35.95%)  tps: 6,814  tflops: 53.27  mfu: 17.07%
[rank3]:2025-12-24 14:07:15,104 -  step: 100  loss:  8.5344  grad_norm:  8.3293  memory: 28.29GiB(59.55%)  tps: 6,814  tflops: 53.27  mfu: 17.07%
[rank2]:2025-12-24 14:07:15,205 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1407_stage2_step100.svg
[rank0]:2025-12-24 14:07:15,197 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1407_stage0_step100.svg
[rank1]:2025-12-24 14:07:15,199 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1407_stage1_step100.svg
[rank3]:2025-12-24 14:07:15,292 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1407_step100_rank3.svg
[rank3]:			> Batch Time: 549.52 ms, GPU Bubble Ratio: 58.73%, 48.49%, 71.40%, 27.60%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB4,F]  35-8-44ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-9-61ms      | [S0,MB7,F]  61-8-70ms      | [S0,MB0,B]  263-19-283ms   | [S0,MB1,B]  301-19-320ms   | [S0,MB2,B]  341-19-360ms   | [S0,MB3,B]  379-19-399ms   | [S0,MB4,B]  418-19-437ms   | [S0,MB5,B]  456-19-476ms   | [S0,MB6,B]  495-19-514ms   | [S0,MB7,B]  530-19-549ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-9-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-9-83ms      | [S1,MB5,F]  93-9-102ms     | [S1,MB6,F]  112-9-121ms    | [S1,MB7,F]  131-9-140ms    | [S1,MB0,B]  237-25-263ms   | [S1,MB1,B]  274-25-300ms   | [S1,MB2,B]  311-25-337ms   | [S1,MB3,B]  349-26-375ms   | [S1,MB4,B]  388-26-414ms   | [S1,MB5,B]  427-26-453ms   | [S1,MB6,B]  465-26-492ms   | [S1,MB7,B]  500-26-527ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-8-40ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  220-11-232ms   | [S2,MB1,B]  259-11-271ms   | [S2,MB2,B]  296-11-308ms   | [S2,MB3,B]  334-11-346ms   | [S2,MB4,B]  373-11-385ms   | [S2,MB5,B]  412-11-424ms   | [S2,MB6,B]  450-11-462ms   | [S2,MB7,B]  486-11-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  163-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  214-36-251ms   | [S3,MB2,B]  252-38-291ms   | [S3,MB3,B]  290-38-329ms   | [S3,MB4,B]  327-38-366ms   | [S3,MB5,B]  366-38-405ms   | [S3,MB6,B]  405-39-445ms   | [S3,MB7,B]  444-39-483ms  
[rank3]:2025-12-24 14:07:15,337 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1407_stage3_step100.svg
[rank3]:2025-12-24 14:07:59,345 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3567e-01
[rank1]:2025-12-24 14:07:59,322 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5946e+00
[rank2]:2025-12-24 14:07:59,333 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1665e-01
[rank0]:2025-12-24 14:07:59,351 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5629e+00
[rank2]:2025-12-24 14:08:44,456 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2065e+00
[rank0]:2025-12-24 14:08:44,475 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.8865e+00
[rank1]:2025-12-24 14:08:44,472 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.8829e-01
[rank3]:2025-12-24 14:08:44,471 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9443e+00
[rank3]:2025-12-24 14:09:13,645 - Avg. fwd time: 10.9631 / Avg. bwd time: 42.1685 / Avg. batch time: 484.5746 (ms) / GPU bubble ratio: 12.28%
[rank2]:2025-12-24 14:09:13,671 - Avg. fwd time: 7.4435 / Avg. bwd time: 17.7204 / Avg. batch time: 514.7860 (ms) / GPU bubble ratio: 60.89%
[rank0]:2025-12-24 14:09:13,721 - Avg. fwd time: 8.2938 / Avg. bwd time: 24.1303 / Avg. batch time: 591.1132 (ms) / GPU bubble ratio: 56.12%
[rank1]:2025-12-24 14:09:13,690 - Avg. fwd time: 9.4416 / Avg. bwd time: 24.0632 / Avg. batch time: 553.6930 (ms) / GPU bubble ratio: 51.59%
[rank2]:2025-12-24 14:09:33,503 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1924e+00
[rank0]:2025-12-24 14:09:33,520 - Freezing Ratio: [Stage0] 0.49, Threshold: 5.1393e+00
[rank3]:2025-12-24 14:09:33,514 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2121e+01
[rank1]:2025-12-24 14:09:33,491 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9159e+00
[rank2]:2025-12-24 14:10:18,546 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4685e+00
[rank0]:2025-12-24 14:10:18,566 - Freezing Ratio: [Stage0] 0.00, Threshold: 7.5475e+00
[rank3]:2025-12-24 14:10:18,562 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4526e+00
[rank1]:2025-12-24 14:10:18,563 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2948e-01
[rank0]:2025-12-24 14:11:07,548 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 14:11:07,575 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9192e+00
[rank3]:2025-12-24 14:11:07,572 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6321e+00
[rank1]:2025-12-24 14:11:07,548 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2158e+00
[rank2]:2025-12-24 14:11:07,559 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4149e-01
[rank3]:2025-12-24 14:11:12,001 - Avg. fwd time: 10.9850 / Avg. bwd time: 41.9900 / Avg. batch time: 483.3042 (ms) / GPU bubble ratio: 12.31%
[rank2]:2025-12-24 14:11:12,020 - Avg. fwd time: 7.4813 / Avg. bwd time: 17.4444 / Avg. batch time: 513.1901 (ms) / GPU bubble ratio: 61.14%
[rank0]:2025-12-24 14:11:12,078 - Avg. fwd time: 8.3262 / Avg. bwd time: 23.8528 / Avg. batch time: 588.3635 (ms) / GPU bubble ratio: 56.25%
[rank1]:2025-12-24 14:11:12,051 - Avg. fwd time: 9.5520 / Avg. bwd time: 23.2405 / Avg. batch time: 551.2389 (ms) / GPU bubble ratio: 52.41%
[rank1]:2025-12-24 14:11:12,102 -  step: 150  loss: -8.0000  grad_norm: 10.6187  memory: 15.15GiB(31.89%)  tps: 6,913  tflops: 54.04  mfu: 17.32%
[rank2]:2025-12-24 14:11:12,088 -  step: 150  loss: -8.0000  grad_norm: 10.6187  memory: 12.26GiB(25.80%)  tps: 6,913  tflops: 54.04  mfu: 17.32%
[rank0]:2025-12-24 14:11:12,102 -  step: 150  loss: -8.0000  grad_norm: 10.6187  memory: 17.08GiB(35.95%)  tps: 6,913  tflops: 54.04  mfu: 17.32%
[rank3]:2025-12-24 14:11:12,105 -  step: 150  loss:  4.0504  grad_norm: 10.6187  memory: 28.29GiB(59.55%)  tps: 6,913  tflops: 54.04  mfu: 17.32%
[rank2]:2025-12-24 14:11:52,416 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6519e+00
[rank0]:2025-12-24 14:11:52,431 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.1598e+00
[rank3]:2025-12-24 14:11:52,432 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5365e+00
[rank1]:2025-12-24 14:11:52,432 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1840e-01
[rank2]:2025-12-24 14:12:41,568 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2522e-01
[rank3]:2025-12-24 14:12:41,579 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9201e+00
[rank0]:2025-12-24 14:12:41,584 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2199e-01
[rank1]:2025-12-24 14:12:41,556 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2589e+00
[rank2]:2025-12-24 14:13:08,385 - Avg. fwd time: 7.5344 / Avg. bwd time: 17.0530 / Avg. batch time: 510.8451 (ms) / GPU bubble ratio: 61.50%
[rank3]:2025-12-24 14:13:08,367 - Avg. fwd time: 11.0177 / Avg. bwd time: 41.7192 / Avg. batch time: 481.3914 (ms) / GPU bubble ratio: 12.36%
[rank1]:2025-12-24 14:13:08,417 - Avg. fwd time: 9.5960 / Avg. bwd time: 22.9289 / Avg. batch time: 548.5726 (ms) / GPU bubble ratio: 52.57%
[rank0]:2025-12-24 14:13:08,439 - Avg. fwd time: 8.3924 / Avg. bwd time: 23.2951 / Avg. batch time: 585.1203 (ms) / GPU bubble ratio: 56.68%
[rank2]:2025-12-24 14:13:26,423 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0542e+00
[rank3]:2025-12-24 14:13:26,439 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2778e+00
[rank1]:2025-12-24 14:13:26,440 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5002e+00
[rank0]:2025-12-24 14:13:26,439 - Freezing Ratio: [Stage0] 0.00, Threshold: 7.9447e+00
[rank2]:2025-12-24 14:14:15,452 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3527e+00
[rank1]:2025-12-24 14:14:15,440 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6815e+00
[rank3]:2025-12-24 14:14:15,464 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5117e+00
[rank0]:2025-12-24 14:14:15,468 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0414e+00
[rank1]:2025-12-24 14:15:00,294 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9094e+00
[rank3]:2025-12-24 14:15:00,293 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1255e+01
[rank0]:2025-12-24 14:15:00,276 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 14:15:00,293 - Freezing Ratio: [Stage0] 0.00, Threshold: 6.8773e+00
[rank2]:2025-12-24 14:15:00,278 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.0856e+00
[rank2]:2025-12-24 14:15:04,858 - Avg. fwd time: 7.5686 / Avg. bwd time: 16.8040 / Avg. batch time: 509.1587 (ms) / GPU bubble ratio: 61.71%
[rank1]:2025-12-24 14:15:04,878 - Avg. fwd time: 9.6368 / Avg. bwd time: 22.6429 / Avg. batch time: 546.5862 (ms) / GPU bubble ratio: 52.75%
[rank3]:2025-12-24 14:15:04,830 - Avg. fwd time: 11.0450 / Avg. bwd time: 41.5168 / Avg. batch time: 479.9850 (ms) / GPU bubble ratio: 12.39%
[rank0]:2025-12-24 14:15:04,909 - Avg. fwd time: 8.4351 / Avg. bwd time: 22.9212 / Avg. batch time: 582.7428 (ms) / GPU bubble ratio: 56.95%
[rank2]:2025-12-24 14:15:04,931 -  step: 200  loss: -8.0000  grad_norm: 15.0934  memory: 12.26GiB(25.80%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank1]:2025-12-24 14:15:04,921 -  step: 200  loss: -8.0000  grad_norm: 15.0934  memory: 15.15GiB(31.89%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank3]:2025-12-24 14:15:04,937 -  step: 200  loss:  1.3020  grad_norm: 15.0934  memory: 28.29GiB(59.55%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank0]:2025-12-24 14:15:04,945 -  step: 200  loss: -8.0000  grad_norm: 15.0934  memory: 17.08GiB(35.95%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank0]:2025-12-24 14:15:04,998 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1415_stage0_step200.svg
[rank2]:2025-12-24 14:15:04,998 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1415_stage2_step200.svg
[rank1]:2025-12-24 14:15:05,001 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1415_stage1_step200.svg
[rank3]:2025-12-24 14:15:05,084 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1415_step200_rank3.svg
[rank3]:			> Batch Time: 546.12 ms, GPU Bubble Ratio: 62.26%, 48.68%, 71.27%, 27.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-8-73ms      | [S0,MB0,B]  265-16-281ms   | [S0,MB1,B]  301-16-318ms   | [S0,MB2,B]  339-16-356ms   | [S0,MB3,B]  376-16-393ms   | [S0,MB4,B]  414-16-431ms   | [S0,MB5,B]  454-16-470ms   | [S0,MB6,B]  493-16-509ms   | [S0,MB7,B]  529-16-546ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  93-8-102ms     | [S1,MB6,F]  112-8-121ms    | [S1,MB7,F]  131-8-140ms    | [S1,MB0,B]  237-25-262ms   | [S1,MB1,B]  273-25-299ms   | [S1,MB2,B]  310-25-335ms   | [S1,MB3,B]  347-25-373ms   | [S1,MB4,B]  385-25-411ms   | [S1,MB5,B]  424-25-450ms   | [S1,MB6,B]  463-25-489ms   | [S1,MB7,B]  499-26-525ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-8-41ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-99ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  222-11-234ms   | [S2,MB1,B]  258-11-270ms   | [S2,MB2,B]  295-11-307ms   | [S2,MB3,B]  332-11-344ms   | [S2,MB4,B]  371-11-382ms   | [S2,MB5,B]  409-11-421ms   | [S2,MB6,B]  449-11-460ms   | [S2,MB7,B]  485-11-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-80ms     | [S3,MB3,F]  87-11-99ms     | [S3,MB4,F]  106-11-118ms   | [S3,MB5,F]  125-11-137ms   | [S3,MB6,F]  144-11-156ms   | [S3,MB7,F]  163-11-175ms   | [S3,MB0,B]  181-34-216ms   | [S3,MB1,B]  215-35-251ms   | [S3,MB2,B]  252-36-288ms   | [S3,MB3,B]  288-38-326ms   | [S3,MB4,B]  325-38-364ms   | [S3,MB5,B]  364-39-403ms   | [S3,MB6,B]  403-39-442ms   | [S3,MB7,B]  442-39-481ms  
[rank3]:2025-12-24 14:15:05,130 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1415_stage3_step200.svg
[rank1]:2025-12-24 14:15:46,053 - Freezing Ratio: [Stage1] 0.00, Threshold: 5.5690e+00
[rank2]:2025-12-24 14:15:46,064 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2006e+00
[rank3]:2025-12-24 14:15:46,068 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9368e+00
[rank0]:2025-12-24 14:15:46,081 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2611e+00
[rank2]:2025-12-24 14:16:30,923 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.8810e+00
[rank1]:2025-12-24 14:16:30,940 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2272e+00
[rank3]:2025-12-24 14:16:30,939 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8179e+00
[rank0]:2025-12-24 14:16:30,939 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0863e+01
[rank3]:2025-12-24 14:16:57,641 - Avg. fwd time: 11.0951 / Avg. bwd time: 41.0684 / Avg. batch time: 476.8002 (ms) / GPU bubble ratio: 12.48%
[rank2]:2025-12-24 14:16:57,668 - Avg. fwd time: 7.5737 / Avg. bwd time: 16.7796 / Avg. batch time: 505.9993 (ms) / GPU bubble ratio: 61.50%
[rank1]:2025-12-24 14:16:57,688 - Avg. fwd time: 9.6943 / Avg. bwd time: 22.2063 / Avg. batch time: 542.9753 (ms) / GPU bubble ratio: 53.00%
[rank0]:2025-12-24 14:16:57,712 - Avg. fwd time: 8.4784 / Avg. bwd time: 22.5613 / Avg. batch time: 578.7738 (ms) / GPU bubble ratio: 57.10%
[rank2]:2025-12-24 14:17:15,425 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3180e-01
[rank3]:2025-12-24 14:17:15,430 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7047e+00
[rank1]:2025-12-24 14:17:15,414 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2458e+00
[rank0]:2025-12-24 14:17:15,429 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2393e-01
[rank2]:2025-12-24 14:18:00,283 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7595e+00
[rank3]:2025-12-24 14:18:00,298 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2130e+00
[rank1]:2025-12-24 14:18:00,299 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0588e-01
[rank0]:2025-12-24 14:18:00,298 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7403e+00
[rank1]:2025-12-24 14:18:44,871 - Freezing Ratio: [Stage1] 0.00, Threshold: 8.4457e-01
[rank0]:2025-12-24 14:18:44,872 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 14:18:44,886 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0508e+00
[rank2]:2025-12-24 14:18:44,883 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5356e-01
[rank3]:2025-12-24 14:18:44,887 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4690e+00
[rank2]:2025-12-24 14:18:49,300 - Avg. fwd time: 7.5815 / Avg. bwd time: 16.7289 / Avg. batch time: 503.3678 (ms) / GPU bubble ratio: 61.36%
[rank3]:2025-12-24 14:18:49,281 - Avg. fwd time: 11.1336 / Avg. bwd time: 40.7092 / Avg. batch time: 474.2294 (ms) / GPU bubble ratio: 12.54%
[rank1]:2025-12-24 14:18:49,332 - Avg. fwd time: 9.7339 / Avg. bwd time: 21.9088 / Avg. batch time: 540.0378 (ms) / GPU bubble ratio: 53.13%
[rank1]:2025-12-24 14:18:49,378 -  step: 250  loss: -8.0000  grad_norm:  2.1222  memory: 15.15GiB(31.89%)  tps: 7,299  tflops: 57.06  mfu: 18.29%
[rank0]:2025-12-24 14:18:49,356 - Avg. fwd time: 8.5455 / Avg. bwd time: 21.9618 / Avg. batch time: 575.2224 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-12-24 14:18:49,379 -  step: 250  loss: -8.0000  grad_norm:  2.1222  memory: 17.08GiB(35.95%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank2]:2025-12-24 14:18:49,365 -  step: 250  loss: -8.0000  grad_norm:  2.1222  memory: 12.26GiB(25.80%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank3]:2025-12-24 14:18:49,381 -  step: 250  loss:  0.4072  grad_norm:  2.1222  memory: 28.29GiB(59.55%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank1]:2025-12-24 14:19:29,832 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.4479e-01
[rank0]:2025-12-24 14:19:29,831 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0409e+00
[rank2]:2025-12-24 14:19:29,815 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1195e+00
[rank3]:2025-12-24 14:19:29,831 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1624e-01
[rank1]:2025-12-24 14:20:14,374 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3533e+01
[rank0]:2025-12-24 14:20:14,389 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2876e+01
[rank2]:2025-12-24 14:20:14,386 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4294e+00
[rank3]:2025-12-24 14:20:14,389 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2250e+01
[rank3]:2025-12-24 14:20:40,710 - Avg. fwd time: 11.1660 / Avg. bwd time: 40.4314 / Avg. batch time: 472.2634 (ms) / GPU bubble ratio: 12.60%
[rank2]:2025-12-24 14:20:40,728 - Avg. fwd time: 7.6049 / Avg. bwd time: 16.5613 / Avg. batch time: 501.2205 (ms) / GPU bubble ratio: 61.43%
[rank1]:2025-12-24 14:20:40,750 - Avg. fwd time: 9.7770 / Avg. bwd time: 21.5743 / Avg. batch time: 537.5295 (ms) / GPU bubble ratio: 53.34%
[rank0]:2025-12-24 14:20:40,774 - Avg. fwd time: 8.6004 / Avg. bwd time: 21.4709 / Avg. batch time: 572.2125 (ms) / GPU bubble ratio: 57.96%
[rank1]:2025-12-24 14:20:58,337 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2046e+00
[rank0]:2025-12-24 14:20:58,352 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0125e+00
[rank2]:2025-12-24 14:20:58,337 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3003e+00
[rank3]:2025-12-24 14:20:58,353 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4227e+00
[rank1]:2025-12-24 14:21:43,028 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1215e+00
[rank2]:2025-12-24 14:21:43,040 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1771e-01
[rank3]:2025-12-24 14:21:43,043 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2875e-01
[rank0]:2025-12-24 14:21:43,043 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9658e+00
[rank1]:2025-12-24 14:22:27,057 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3782e+00
[rank0]:2025-12-24 14:22:27,056 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 14:22:27,072 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8662e+00
[rank2]:2025-12-24 14:22:27,057 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1116e+00
[rank3]:2025-12-24 14:22:27,073 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2683e-01
[rank3]:2025-12-24 14:22:31,467 - Avg. fwd time: 11.1925 / Avg. bwd time: 40.2111 / Avg. batch time: 470.7075 (ms) / GPU bubble ratio: 12.64%
[rank2]:2025-12-24 14:22:31,496 - Avg. fwd time: 7.6212 / Avg. bwd time: 16.4521 / Avg. batch time: 499.5449 (ms) / GPU bubble ratio: 61.45%
[rank3]:2025-12-24 14:22:31,566 -  step: 300  loss:  0.2968  grad_norm:  0.3748  memory: 28.29GiB(59.55%)  tps: 7,374  tflops: 57.65  mfu: 18.48%
[rank1]:2025-12-24 14:22:31,517 - Avg. fwd time: 9.8589 / Avg. bwd time: 20.9273 / Avg. batch time: 535.1729 (ms) / GPU bubble ratio: 53.98%
[rank1]:2025-12-24 14:22:31,550 -  step: 300  loss: -8.0000  grad_norm:  0.3748  memory: 15.15GiB(31.89%)  tps: 7,374  tflops: 57.65  mfu: 18.48%
[rank0]:2025-12-24 14:22:31,541 - Avg. fwd time: 8.6471 / Avg. bwd time: 21.0618 / Avg. batch time: 569.4369 (ms) / GPU bubble ratio: 58.26%
[rank0]:2025-12-24 14:22:31,564 -  step: 300  loss: -8.0000  grad_norm:  0.3748  memory: 17.08GiB(35.95%)  tps: 7,374  tflops: 57.65  mfu: 18.48%
[rank2]:2025-12-24 14:22:31,560 -  step: 300  loss: -8.0000  grad_norm:  0.3748  memory: 12.26GiB(25.80%)  tps: 7,374  tflops: 57.64  mfu: 18.48%
[rank2]:2025-12-24 14:22:31,618 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1422_stage2_step300.svg
[rank1]:2025-12-24 14:22:31,621 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1422_stage1_step300.svg
[rank0]:2025-12-24 14:22:31,619 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1422_stage0_step300.svg
[rank3]:2025-12-24 14:22:31,703 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1422_step300_rank3.svg
[rank3]:			> Batch Time: 540.12 ms, GPU Bubble Ratio: 61.78%, 63.56%, 70.79%, 26.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  254-16-271ms   | [S0,MB1,B]  292-16-308ms   | [S0,MB2,B]  331-16-348ms   | [S0,MB3,B]  370-16-386ms   | [S0,MB4,B]  408-16-425ms   | [S0,MB5,B]  448-16-464ms   | [S0,MB6,B]  486-16-503ms   | [S0,MB7,B]  523-16-540ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  75-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-123ms   | [S1,MB7,F]  131-10-142ms   | [S1,MB0,B]  237-13-251ms   | [S1,MB1,B]  275-13-288ms   | [S1,MB2,B]  314-13-327ms   | [S1,MB3,B]  352-13-366ms   | [S1,MB4,B]  391-13-405ms   | [S1,MB5,B]  431-13-445ms   | [S1,MB6,B]  469-13-483ms   | [S1,MB7,B]  506-13-520ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  90-8-99ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  259-11-271ms   | [S2,MB2,B]  298-11-309ms   | [S2,MB3,B]  336-11-348ms   | [S2,MB4,B]  375-11-387ms   | [S2,MB5,B]  414-11-425ms   | [S2,MB6,B]  452-11-463ms   | [S2,MB7,B]  487-11-499ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  69-11-80ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  163-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  214-36-251ms   | [S3,MB2,B]  252-39-291ms   | [S3,MB3,B]  291-39-330ms   | [S3,MB4,B]  329-39-369ms   | [S3,MB5,B]  368-39-408ms   | [S3,MB6,B]  407-39-446ms   | [S3,MB7,B]  445-39-484ms  
[rank3]:2025-12-24 14:22:31,749 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1422_stage3_step300.svg
[rank2]:2025-12-24 14:23:11,853 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.6190e-01
[rank3]:2025-12-24 14:23:11,857 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4057e+00
[rank1]:2025-12-24 14:23:11,841 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2621e+00
[rank0]:2025-12-24 14:23:11,857 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5660e-01
[rank2]:2025-12-24 14:23:55,884 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7911e+00
[rank1]:2025-12-24 14:23:55,885 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0331e+00
[rank3]:2025-12-24 14:23:55,900 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8796e+00
[rank0]:2025-12-24 14:23:55,900 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5363e+00
[rank3]:2025-12-24 14:24:22,598 - Avg. fwd time: 11.2158 / Avg. bwd time: 40.0201 / Avg. batch time: 469.3593 (ms) / GPU bubble ratio: 12.67%
[rank2]:2025-12-24 14:24:22,627 - Avg. fwd time: 7.6208 / Avg. bwd time: 16.4684 / Avg. batch time: 498.2502 (ms) / GPU bubble ratio: 61.32%
[rank1]:2025-12-24 14:24:22,648 - Avg. fwd time: 9.9287 / Avg. bwd time: 20.3799 / Avg. batch time: 533.3018 (ms) / GPU bubble ratio: 54.53%
[rank0]:2025-12-24 14:24:22,673 - Avg. fwd time: 8.6876 / Avg. bwd time: 20.7168 / Avg. batch time: 567.2135 (ms) / GPU bubble ratio: 58.53%
[rank0]:2025-12-24 14:24:40,655 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3125e+00
[rank2]:2025-12-24 14:24:40,651 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3688e+00
[rank1]:2025-12-24 14:24:40,640 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5000e+00
[rank3]:2025-12-24 14:24:40,655 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7203e+00
[rank2]:2025-12-24 14:25:24,642 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.6550e-01
[rank1]:2025-12-24 14:25:24,642 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.1486e-01
[rank3]:2025-12-24 14:25:24,658 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4064e-01
[rank0]:2025-12-24 14:25:24,657 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1175e+00
[rank2]:2025-12-24 14:26:09,200 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6247e-01
[rank1]:2025-12-24 14:26:09,188 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.3807e-01
[rank3]:2025-12-24 14:26:09,204 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0495e+00
[rank0]:2025-12-24 14:26:09,189 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 14:26:09,203 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3136e+00
[rank3]:2025-12-24 14:26:13,530 - Avg. fwd time: 11.2380 / Avg. bwd time: 39.8534 / Avg. batch time: 468.1985 (ms) / GPU bubble ratio: 12.70%
[rank2]:2025-12-24 14:26:13,550 - Avg. fwd time: 7.6245 / Avg. bwd time: 16.4554 / Avg. batch time: 497.0676 (ms) / GPU bubble ratio: 61.24%
[rank2]:2025-12-24 14:26:13,605 -  step: 350  loss: -8.0000  grad_norm:  0.1792  memory: 12.26GiB(25.80%)  tps: 7,379  tflops: 57.68  mfu: 18.49%
[rank1]:2025-12-24 14:26:13,571 - Avg. fwd time: 9.9890 / Avg. bwd time: 19.9104 / Avg. batch time: 531.6258 (ms) / GPU bubble ratio: 55.01%
[rank1]:2025-12-24 14:26:13,605 -  step: 350  loss: -8.0000  grad_norm:  0.1792  memory: 15.15GiB(31.89%)  tps: 7,378  tflops: 57.68  mfu: 18.49%
[rank3]:2025-12-24 14:26:13,621 -  step: 350  loss:  0.2459  grad_norm:  0.1792  memory: 28.29GiB(59.55%)  tps: 7,378  tflops: 57.68  mfu: 18.49%
[rank0]:2025-12-24 14:26:13,596 - Avg. fwd time: 8.7232 / Avg. bwd time: 20.4211 / Avg. batch time: 565.2359 (ms) / GPU bubble ratio: 58.75%
[rank0]:2025-12-24 14:26:13,619 -  step: 350  loss: -8.0000  grad_norm:  0.1792  memory: 17.08GiB(35.95%)  tps: 7,378  tflops: 57.68  mfu: 18.49%
[rank2]:2025-12-24 14:26:53,049 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.5605e-01
[rank1]:2025-12-24 14:26:53,049 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9784e-01
[rank3]:2025-12-24 14:26:53,065 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7259e-01
[rank0]:2025-12-24 14:26:53,064 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2117e-01
[rank2]:2025-12-24 14:27:37,716 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2840e-01
[rank1]:2025-12-24 14:27:37,705 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6969e+00
[rank3]:2025-12-24 14:27:37,720 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.9727e-01
[rank0]:2025-12-24 14:27:37,720 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7926e+00
[rank3]:2025-12-24 14:28:03,970 - Avg. fwd time: 11.2565 / Avg. bwd time: 39.7030 / Avg. batch time: 467.1401 (ms) / GPU bubble ratio: 12.73%
[rank2]:2025-12-24 14:28:03,991 - Avg. fwd time: 7.6399 / Avg. bwd time: 16.3495 / Avg. batch time: 495.8928 (ms) / GPU bubble ratio: 61.30%
[rank1]:2025-12-24 14:28:04,013 - Avg. fwd time: 10.0410 / Avg. bwd time: 19.5031 / Avg. batch time: 530.0231 (ms) / GPU bubble ratio: 55.41%
[rank0]:2025-12-24 14:28:04,037 - Avg. fwd time: 8.7539 / Avg. bwd time: 20.1644 / Avg. batch time: 563.3706 (ms) / GPU bubble ratio: 58.94%
[rank2]:2025-12-24 14:28:21,643 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6303e+00
[rank1]:2025-12-24 14:28:21,643 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9289e+00
[rank3]:2025-12-24 14:28:21,659 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3454e+00
[rank0]:2025-12-24 14:28:21,658 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3462e+00
[rank0]:2025-12-24 14:29:06,192 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2720e-01
[rank2]:2025-12-24 14:29:06,188 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3076e-01
[rank1]:2025-12-24 14:29:06,176 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3205e-01
[rank3]:2025-12-24 14:29:06,192 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1309e+00
[rank1]:2025-12-24 14:29:50,331 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.5246e-01
[rank3]:2025-12-24 14:29:50,346 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6271e-01
[rank0]:2025-12-24 14:29:50,329 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 14:29:50,346 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4891e+00
[rank2]:2025-12-24 14:29:50,331 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.2211e-01
[rank2]:2025-12-24 14:29:54,791 - Avg. fwd time: 7.6505 / Avg. bwd time: 16.2776 / Avg. batch time: 494.9835 (ms) / GPU bubble ratio: 61.33%
[rank1]:2025-12-24 14:29:54,814 - Avg. fwd time: 10.0865 / Avg. bwd time: 19.1462 / Avg. batch time: 528.7393 (ms) / GPU bubble ratio: 55.77%
[rank3]:2025-12-24 14:29:54,762 - Avg. fwd time: 11.2740 / Avg. bwd time: 39.5821 / Avg. batch time: 466.3108 (ms) / GPU bubble ratio: 12.75%
[rank0]:2025-12-24 14:29:54,839 - Avg. fwd time: 8.7817 / Avg. bwd time: 19.9394 / Avg. batch time: 561.8597 (ms) / GPU bubble ratio: 59.11%
[rank0]:2025-12-24 14:29:54,862 -  step: 400  loss: -8.0000  grad_norm:  0.3668  memory: 17.08GiB(35.95%)  tps: 7,405  tflops: 57.89  mfu: 18.56%
[rank2]:2025-12-24 14:29:54,858 -  step: 400  loss: -8.0000  grad_norm:  0.3668  memory: 12.26GiB(25.80%)  tps: 7,405  tflops: 57.89  mfu: 18.55%
[rank1]:2025-12-24 14:29:54,848 -  step: 400  loss: -8.0000  grad_norm:  0.3668  memory: 15.15GiB(31.89%)  tps: 7,405  tflops: 57.89  mfu: 18.56%
[rank1]:2025-12-24 14:29:54,922 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1429_stage1_step400.svg
[rank3]:2025-12-24 14:29:54,864 -  step: 400  loss:  0.2305  grad_norm:  0.3668  memory: 28.29GiB(59.55%)  tps: 7,406  tflops: 57.89  mfu: 18.56%
[rank0]:2025-12-24 14:29:54,920 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1429_stage0_step400.svg
[rank2]:2025-12-24 14:29:54,920 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1429_stage2_step400.svg
[rank3]:2025-12-24 14:29:55,002 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1429_step400_rank3.svg
[rank3]:			> Batch Time: 536.61 ms, GPU Bubble Ratio: 61.54%, 63.40%, 70.68%, 25.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  254-16-270ms   | [S0,MB1,B]  291-16-308ms   | [S0,MB2,B]  330-16-346ms   | [S0,MB3,B]  368-16-385ms   | [S0,MB4,B]  407-16-424ms   | [S0,MB5,B]  445-16-462ms   | [S0,MB6,B]  484-16-501ms   | [S0,MB7,B]  520-16-536ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-123ms   | [S1,MB7,F]  131-10-142ms   | [S1,MB0,B]  236-13-250ms   | [S1,MB1,B]  274-13-288ms   | [S1,MB2,B]  313-13-327ms   | [S1,MB3,B]  351-13-365ms   | [S1,MB4,B]  390-13-404ms   | [S1,MB5,B]  428-13-442ms   | [S1,MB6,B]  467-13-481ms   | [S1,MB7,B]  502-13-516ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-99ms      | [S2,MB5,F]  109-8-118ms    | [S2,MB6,F]  128-8-137ms    | [S2,MB7,F]  148-8-156ms    | [S2,MB0,B]  222-11-233ms   | [S2,MB1,B]  259-11-271ms   | [S2,MB2,B]  297-11-308ms   | [S2,MB3,B]  335-11-347ms   | [S2,MB4,B]  374-11-386ms   | [S2,MB5,B]  413-11-424ms   | [S2,MB6,B]  451-11-463ms   | [S2,MB7,B]  487-11-498ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-80ms     | [S3,MB3,F]  87-11-99ms     | [S3,MB4,F]  106-11-118ms   | [S3,MB5,F]  125-11-137ms   | [S3,MB6,F]  144-11-156ms   | [S3,MB7,F]  163-11-175ms   | [S3,MB0,B]  181-34-215ms   | [S3,MB1,B]  215-36-252ms   | [S3,MB2,B]  252-38-291ms   | [S3,MB3,B]  290-39-329ms   | [S3,MB4,B]  329-39-368ms   | [S3,MB5,B]  367-39-407ms   | [S3,MB6,B]  406-39-445ms   | [S3,MB7,B]  445-39-484ms  
[rank3]:2025-12-24 14:29:55,051 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1429_stage3_step400.svg
[rank3]:2025-12-24 14:30:20,275 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 14:30:20,541 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 14:30:20,553 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 14:30:20,573 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 14:30:35,154 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1630e+00
[rank1]:2025-12-24 14:30:35,142 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0406e+00
[rank3]:2025-12-24 14:30:35,158 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3806e+00
[rank0]:2025-12-24 14:30:35,158 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1707e+00
[rank3]:2025-12-24 14:31:19,040 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.1776e+00
[rank1]:2025-12-24 14:31:19,025 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0280e+00
[rank0]:2025-12-24 14:31:19,040 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.0732e+00
[rank2]:2025-12-24 14:31:19,024 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.3006e+00
[rank3]:2025-12-24 14:31:45,761 - Avg. fwd time: 11.2880 / Avg. bwd time: 39.4689 / Avg. batch time: 465.5200 (ms) / GPU bubble ratio: 12.77%
[rank2]:2025-12-24 14:31:45,791 - Avg. fwd time: 7.6484 / Avg. bwd time: 16.2957 / Avg. batch time: 494.2357 (ms) / GPU bubble ratio: 61.24%
[rank1]:2025-12-24 14:31:45,814 - Avg. fwd time: 10.1260 / Avg. bwd time: 18.8308 / Avg. batch time: 527.6602 (ms) / GPU bubble ratio: 56.10%
[rank0]:2025-12-24 14:31:45,839 - Avg. fwd time: 8.8044 / Avg. bwd time: 19.7407 / Avg. batch time: 560.5789 (ms) / GPU bubble ratio: 59.26%
[rank3]:2025-12-24 14:32:03,511 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8214e+00
[rank1]:2025-12-24 14:32:03,496 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6693e+00
[rank0]:2025-12-24 14:32:03,511 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3925e-01
[rank2]:2025-12-24 14:32:03,508 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0184e-01
[rank1]:2025-12-24 14:32:47,440 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0753e+00
[rank3]:2025-12-24 14:32:47,455 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5367e+00
[rank0]:2025-12-24 14:32:47,455 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9876e+00
[rank2]:2025-12-24 14:32:47,439 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9144e+00
[rank0]:2025-12-24 14:33:31,949 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 14:33:31,963 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5202e+00
[rank2]:2025-12-24 14:33:31,960 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4848e-01
[rank1]:2025-12-24 14:33:31,948 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7413e+00
[rank3]:2025-12-24 14:33:31,965 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0643e+00
[rank2]:2025-12-24 14:33:36,265 - Avg. fwd time: 7.6486 / Avg. bwd time: 16.2924 / Avg. batch time: 493.4397 (ms) / GPU bubble ratio: 61.19%
[rank1]:2025-12-24 14:33:36,288 - Avg. fwd time: 10.1602 / Avg. bwd time: 18.5499 / Avg. batch time: 526.5679 (ms) / GPU bubble ratio: 56.38%
[rank1]:2025-12-24 14:33:36,322 -  step: 450  loss: -8.0000  grad_norm:  0.1150  memory: 15.15GiB(31.89%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank3]:2025-12-24 14:33:36,244 - Avg. fwd time: 11.2996 / Avg. bwd time: 39.3599 / Avg. batch time: 464.7381 (ms) / GPU bubble ratio: 12.79%
[rank0]:2025-12-24 14:33:36,313 - Avg. fwd time: 8.8239 / Avg. bwd time: 19.5635 / Avg. batch time: 559.3046 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-24 14:33:36,337 -  step: 450  loss: -8.0000  grad_norm:  0.1150  memory: 17.08GiB(35.95%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank2]:2025-12-24 14:33:36,322 -  step: 450  loss: -8.0000  grad_norm:  0.1150  memory: 12.26GiB(25.80%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank3]:2025-12-24 14:33:36,338 -  step: 450  loss:  0.2417  grad_norm:  0.1150  memory: 28.29GiB(59.55%)  tps: 7,398  tflops: 57.83  mfu: 18.54%
[rank0]:2025-12-24 14:34:15,805 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5019e+00
[rank2]:2025-12-24 14:34:15,790 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.9454e-01
[rank3]:2025-12-24 14:34:15,806 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4171e-01
[rank1]:2025-12-24 14:34:15,790 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.6026e-01
[rank1]:2025-12-24 14:35:00,300 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4846e-01
[rank3]:2025-12-24 14:35:00,316 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4967e-01
[rank2]:2025-12-24 14:35:00,312 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2422e-01
[rank0]:2025-12-24 14:35:00,316 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0387e+00
[rank2]:2025-12-24 14:35:26,616 - Avg. fwd time: 7.6589 / Avg. bwd time: 16.2150 / Avg. batch time: 492.6836 (ms) / GPU bubble ratio: 61.23%
[rank1]:2025-12-24 14:35:26,639 - Avg. fwd time: 10.1913 / Avg. bwd time: 18.2986 / Avg. batch time: 525.5475 (ms) / GPU bubble ratio: 56.63%
[rank3]:2025-12-24 14:35:26,595 - Avg. fwd time: 11.3099 / Avg. bwd time: 39.2663 / Avg. batch time: 464.0690 (ms) / GPU bubble ratio: 12.81%
[rank0]:2025-12-24 14:35:26,665 - Avg. fwd time: 8.8412 / Avg. bwd time: 19.4047 / Avg. batch time: 558.1208 (ms) / GPU bubble ratio: 59.51%
[rank2]:2025-12-24 14:35:44,202 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3133e-01
[rank0]:2025-12-24 14:35:44,217 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6116e-01
[rank1]:2025-12-24 14:35:44,202 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.2628e-01
[rank3]:2025-12-24 14:35:44,217 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5993e-01
[rank3]:2025-12-24 14:36:28,867 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0059e-01
[rank2]:2025-12-24 14:36:28,863 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7297e-01
[rank0]:2025-12-24 14:36:28,866 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3269e+00
[rank1]:2025-12-24 14:36:28,851 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3692e+00
[rank2]:2025-12-24 14:37:12,721 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6456e+00
[rank0]:2025-12-24 14:37:12,720 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 14:37:12,736 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5230e+00
[rank1]:2025-12-24 14:37:12,721 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1453e+00
[rank3]:2025-12-24 14:37:12,736 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0314e+00
[rank3]:2025-12-24 14:37:17,119 - Avg. fwd time: 11.3199 / Avg. bwd time: 39.1829 / Avg. batch time: 463.4806 (ms) / GPU bubble ratio: 12.83%
[rank2]:2025-12-24 14:37:17,150 - Avg. fwd time: 7.6662 / Avg. bwd time: 16.1630 / Avg. batch time: 492.0354 (ms) / GPU bubble ratio: 61.26%
[rank1]:2025-12-24 14:37:17,173 - Avg. fwd time: 10.2194 / Avg. bwd time: 18.0725 / Avg. batch time: 524.6612 (ms) / GPU bubble ratio: 56.86%
[rank3]:2025-12-24 14:37:17,224 -  step: 500  loss:  0.2400  grad_norm:  0.1339  memory: 28.29GiB(59.55%)  tps: 7,417  tflops: 57.99  mfu: 18.59%
[rank2]:2025-12-24 14:37:17,218 -  step: 500  loss: -8.0000  grad_norm:  0.1339  memory: 12.26GiB(25.80%)  tps: 7,417  tflops: 57.98  mfu: 18.58%
[rank0]:2025-12-24 14:37:17,199 - Avg. fwd time: 8.8573 / Avg. bwd time: 19.2619 / Avg. batch time: 557.0889 (ms) / GPU bubble ratio: 59.62%
[rank0]:2025-12-24 14:37:17,222 -  step: 500  loss: -8.0000  grad_norm:  0.1339  memory: 17.08GiB(35.95%)  tps: 7,417  tflops: 57.99  mfu: 18.59%
[rank0]:2025-12-24 14:37:17,276 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1437_stage0_step500.svg
[rank1]:2025-12-24 14:37:17,208 -  step: 500  loss: -8.0000  grad_norm:  0.1339  memory: 15.15GiB(31.89%)  tps: 7,417  tflops: 57.99  mfu: 18.59%
[rank1]:2025-12-24 14:37:17,277 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1437_stage1_step500.svg
[rank2]:2025-12-24 14:37:17,275 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1437_stage2_step500.svg
[rank3]:2025-12-24 14:37:17,364 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1437_step500_rank3.svg
[rank3]:			> Batch Time: 537.61 ms, GPU Bubble Ratio: 61.60%, 63.46%, 70.68%, 26.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  254-16-271ms   | [S0,MB1,B]  292-16-308ms   | [S0,MB2,B]  330-16-346ms   | [S0,MB3,B]  369-16-386ms   | [S0,MB4,B]  408-16-425ms   | [S0,MB5,B]  447-16-463ms   | [S0,MB6,B]  485-16-501ms   | [S0,MB7,B]  521-16-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-123ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  237-13-251ms   | [S1,MB1,B]  274-13-288ms   | [S1,MB2,B]  313-13-326ms   | [S1,MB3,B]  352-13-366ms   | [S1,MB4,B]  391-13-405ms   | [S1,MB5,B]  430-13-443ms   | [S1,MB6,B]  468-13-481ms   | [S1,MB7,B]  503-13-517ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-11-233ms   | [S2,MB1,B]  258-11-270ms   | [S2,MB2,B]  297-11-308ms   | [S2,MB3,B]  335-11-346ms   | [S2,MB4,B]  373-11-385ms   | [S2,MB5,B]  412-11-423ms   | [S2,MB6,B]  450-11-462ms   | [S2,MB7,B]  485-11-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-80ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  163-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  214-36-251ms   | [S3,MB2,B]  252-38-290ms   | [S3,MB3,B]  290-39-329ms   | [S3,MB4,B]  328-39-367ms   | [S3,MB5,B]  367-39-406ms   | [S3,MB6,B]  405-39-444ms   | [S3,MB7,B]  444-39-483ms  
[rank3]:2025-12-24 14:37:17,408 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1437_stage3_step500.svg
[rank3]:2025-12-24 14:37:57,585 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.5713e-01
[rank2]:2025-12-24 14:37:57,581 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6530e-01
[rank0]:2025-12-24 14:37:57,585 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8827e-01
[rank1]:2025-12-24 14:37:57,570 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8223e+00
[rank3]:2025-12-24 14:38:41,544 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3551e+00
[rank2]:2025-12-24 14:38:41,529 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1840e+00
[rank0]:2025-12-24 14:38:41,544 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8872e+00
[rank1]:2025-12-24 14:38:41,529 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9920e+00
[rank3]:2025-12-24 14:39:08,072 - Avg. fwd time: 11.3294 / Avg. bwd time: 39.1082 / Avg. batch time: 462.9567 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-12-24 14:39:08,102 - Avg. fwd time: 7.6640 / Avg. bwd time: 16.1834 / Avg. batch time: 491.5496 (ms) / GPU bubble ratio: 61.19%
[rank1]:2025-12-24 14:39:08,129 - Avg. fwd time: 10.2451 / Avg. bwd time: 17.8683 / Avg. batch time: 523.9611 (ms) / GPU bubble ratio: 57.08%
[rank0]:2025-12-24 14:39:08,156 - Avg. fwd time: 8.8723 / Avg. bwd time: 19.1335 / Avg. batch time: 556.2580 (ms) / GPU bubble ratio: 59.72%
[rank2]:2025-12-24 14:39:26,030 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5995e-01
[rank0]:2025-12-24 14:39:26,033 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4624e-01
[rank1]:2025-12-24 14:39:26,018 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0785e-01
[rank3]:2025-12-24 14:39:26,034 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9620e-01
[rank3]:2025-12-24 14:40:09,847 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7245e+00
[rank2]:2025-12-24 14:40:09,831 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6154e+00
[rank0]:2025-12-24 14:40:09,847 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0773e+00
[rank1]:2025-12-24 14:40:09,831 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6316e+00
[rank1]:2025-12-24 14:40:54,569 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.6773e-01
[rank3]:2025-12-24 14:40:54,585 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1985e-01
[rank2]:2025-12-24 14:40:54,581 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4932e-01
[rank0]:2025-12-24 14:40:54,571 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 14:40:54,584 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1735e+00
[rank3]:2025-12-24 14:40:58,956 - Avg. fwd time: 11.3389 / Avg. bwd time: 39.0426 / Avg. batch time: 462.5065 (ms) / GPU bubble ratio: 12.85%
[rank2]:2025-12-24 14:40:58,978 - Avg. fwd time: 7.6643 / Avg. bwd time: 16.1848 / Avg. batch time: 491.0938 (ms) / GPU bubble ratio: 61.15%
[rank2]:2025-12-24 14:40:59,038 -  step: 550  loss: -8.0000  grad_norm:  0.1022  memory: 12.26GiB(25.80%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank0]:2025-12-24 14:40:59,029 - Avg. fwd time: 8.8861 / Avg. bwd time: 19.0169 / Avg. batch time: 555.4867 (ms) / GPU bubble ratio: 59.81%
[rank0]:2025-12-24 14:40:59,052 -  step: 550  loss: -8.0000  grad_norm:  0.1022  memory: 17.08GiB(35.95%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank1]:2025-12-24 14:40:59,002 - Avg. fwd time: 10.2685 / Avg. bwd time: 17.6826 / Avg. batch time: 523.3095 (ms) / GPU bubble ratio: 57.27%
[rank1]:2025-12-24 14:40:59,038 -  step: 550  loss: -8.0000  grad_norm:  0.1022  memory: 15.15GiB(31.89%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank3]:2025-12-24 14:40:59,053 -  step: 550  loss:  0.2459  grad_norm:  0.1022  memory: 28.29GiB(59.55%)  tps: 7,386  tflops: 57.74  mfu: 18.51%
[rank1]:2025-12-24 14:41:38,831 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7629e+00
[rank3]:2025-12-24 14:41:38,846 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1704e+00
[rank2]:2025-12-24 14:41:38,831 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5974e+00
[rank0]:2025-12-24 14:41:38,846 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7009e-01
[rank2]:2025-12-24 14:42:23,469 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9207e-01
[rank0]:2025-12-24 14:42:23,473 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6556e+00
[rank1]:2025-12-24 14:42:23,457 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8949e+00
[rank3]:2025-12-24 14:42:23,473 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7596e+00
[rank3]:2025-12-24 14:42:49,700 - Avg. fwd time: 11.3472 / Avg. bwd time: 38.9861 / Avg. batch time: 462.1192 (ms) / GPU bubble ratio: 12.87%
[rank0]:2025-12-24 14:42:49,774 - Avg. fwd time: 8.8992 / Avg. bwd time: 18.9101 / Avg. batch time: 554.7458 (ms) / GPU bubble ratio: 59.90%
[rank2]:2025-12-24 14:42:49,722 - Avg. fwd time: 7.6727 / Avg. bwd time: 16.1247 / Avg. batch time: 490.6379 (ms) / GPU bubble ratio: 61.20%
[rank1]:2025-12-24 14:42:49,747 - Avg. fwd time: 10.2899 / Avg. bwd time: 17.5128 / Avg. batch time: 522.6756 (ms) / GPU bubble ratio: 57.45%
[rank2]:2025-12-24 14:43:07,421 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3368e+00
[rank1]:2025-12-24 14:43:07,422 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.8894e-01
[rank3]:2025-12-24 14:43:07,437 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7193e-01
[rank0]:2025-12-24 14:43:07,437 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2473e+00
[rank2]:2025-12-24 14:43:52,166 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1137e-01
[rank0]:2025-12-24 14:43:52,170 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0268e-01
[rank1]:2025-12-24 14:43:52,155 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4920e-01
[rank3]:2025-12-24 14:43:52,170 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.7099e-01
[rank0]:2025-12-24 14:44:36,247 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 14:44:36,247 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0617e-01
[rank1]:2025-12-24 14:44:36,247 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0298e+00
[rank3]:2025-12-24 14:44:36,263 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0810e-01
[rank0]:2025-12-24 14:44:36,262 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9025e-01
[rank3]:2025-12-24 14:44:40,708 - Avg. fwd time: 11.3557 / Avg. bwd time: 38.9400 / Avg. batch time: 461.8187 (ms) / GPU bubble ratio: 12.87%
[rank2]:2025-12-24 14:44:40,739 - Avg. fwd time: 7.6784 / Avg. bwd time: 16.0841 / Avg. batch time: 490.2892 (ms) / GPU bubble ratio: 61.23%
[rank1]:2025-12-24 14:44:40,766 - Avg. fwd time: 10.3095 / Avg. bwd time: 17.3570 / Avg. batch time: 522.1638 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-12-24 14:44:40,818 -  step: 600  loss:  0.2407  grad_norm:  0.4902  memory: 28.29GiB(59.55%)  tps: 7,388  tflops: 57.76  mfu: 18.51%
[rank0]:2025-12-24 14:44:40,793 - Avg. fwd time: 8.9114 / Avg. bwd time: 18.8121 / Avg. batch time: 554.1360 (ms) / GPU bubble ratio: 59.98%
[rank0]:2025-12-24 14:44:40,816 -  step: 600  loss: -8.0000  grad_norm:  0.4902  memory: 17.08GiB(35.95%)  tps: 7,388  tflops: 57.76  mfu: 18.51%
[rank2]:2025-12-24 14:44:40,812 -  step: 600  loss: -8.0000  grad_norm:  0.4902  memory: 12.26GiB(25.80%)  tps: 7,388  tflops: 57.75  mfu: 18.51%
[rank1]:2025-12-24 14:44:40,802 -  step: 600  loss: -8.0000  grad_norm:  0.4902  memory: 15.15GiB(31.89%)  tps: 7,388  tflops: 57.76  mfu: 18.51%
[rank0]:2025-12-24 14:44:40,872 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1444_stage0_step600.svg
[rank2]:2025-12-24 14:44:40,872 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1444_stage2_step600.svg
[rank1]:2025-12-24 14:44:40,874 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1444_stage1_step600.svg
[rank3]:2025-12-24 14:44:40,958 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1444_step600_rank3.svg
[rank3]:			> Batch Time: 534.09 ms, GPU Bubble Ratio: 61.40%, 63.29%, 70.60%, 25.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  253-16-270ms   | [S0,MB1,B]  291-16-308ms   | [S0,MB2,B]  330-16-346ms   | [S0,MB3,B]  367-16-384ms   | [S0,MB4,B]  406-16-422ms   | [S0,MB5,B]  443-16-460ms   | [S0,MB6,B]  482-16-499ms   | [S0,MB7,B]  517-16-534ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-123ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  236-13-250ms   | [S1,MB1,B]  274-13-288ms   | [S1,MB2,B]  313-13-326ms   | [S1,MB3,B]  350-13-364ms   | [S1,MB4,B]  388-13-402ms   | [S1,MB5,B]  426-13-440ms   | [S1,MB6,B]  465-13-479ms   | [S1,MB7,B]  500-13-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-11-233ms   | [S2,MB1,B]  259-11-271ms   | [S2,MB2,B]  298-11-309ms   | [S2,MB3,B]  335-11-347ms   | [S2,MB4,B]  374-11-385ms   | [S2,MB5,B]  412-11-423ms   | [S2,MB6,B]  451-11-462ms   | [S2,MB7,B]  486-11-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-156ms   | [S3,MB7,F]  163-11-175ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  215-38-253ms   | [S3,MB2,B]  253-38-291ms   | [S3,MB3,B]  291-38-330ms   | [S3,MB4,B]  329-38-367ms   | [S3,MB5,B]  367-38-406ms   | [S3,MB6,B]  405-38-444ms   | [S3,MB7,B]  444-39-483ms  
[rank3]:2025-12-24 14:44:41,004 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1444_stage3_step600.svg
[rank3]:2025-12-24 14:45:21,265 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.8103e-01
[rank0]:2025-12-24 14:45:21,265 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3222e+00
[rank2]:2025-12-24 14:45:21,261 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5442e-01
[rank1]:2025-12-24 14:45:21,249 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1868e+00
[rank0]:2025-12-24 14:46:05,355 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3541e+00
[rank2]:2025-12-24 14:46:05,340 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2651e+00
[rank1]:2025-12-24 14:46:05,340 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2610e+00
[rank3]:2025-12-24 14:46:05,355 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9460e-01
[rank3]:2025-12-24 14:46:32,188 - Avg. fwd time: 11.3628 / Avg. bwd time: 38.8957 / Avg. batch time: 461.5238 (ms) / GPU bubble ratio: 12.88%
[rank0]:2025-12-24 14:46:32,274 - Avg. fwd time: 8.9218 / Avg. bwd time: 18.7219 / Avg. batch time: 553.6355 (ms) / GPU bubble ratio: 60.05%
[rank2]:2025-12-24 14:46:32,221 - Avg. fwd time: 7.6761 / Avg. bwd time: 16.1021 / Avg. batch time: 490.0271 (ms) / GPU bubble ratio: 61.18%
[rank1]:2025-12-24 14:46:32,246 - Avg. fwd time: 10.3272 / Avg. bwd time: 17.2136 / Avg. batch time: 521.7524 (ms) / GPU bubble ratio: 57.77%
[rank2]:2025-12-24 14:46:50,093 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8388e-01
[rank0]:2025-12-24 14:46:50,097 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1181e-01
[rank1]:2025-12-24 14:46:50,082 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5774e+00
[rank3]:2025-12-24 14:46:50,097 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5406e+00
[rank0]:2025-12-24 14:47:34,275 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0061e+00
[rank2]:2025-12-24 14:47:34,260 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3694e+00
[rank1]:2025-12-24 14:47:34,261 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2218e+00
[rank3]:2025-12-24 14:47:34,276 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0427e+00
[rank3]:2025-12-24 14:48:18,994 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5455e+00
[rank0]:2025-12-24 14:48:18,980 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 14:48:18,994 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6021e+00
[rank2]:2025-12-24 14:48:18,990 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8479e-01
[rank1]:2025-12-24 14:48:18,979 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.4197e-01
[rank3]:2025-12-24 14:48:23,317 - Avg. fwd time: 11.3691 / Avg. bwd time: 38.8536 / Avg. batch time: 461.2376 (ms) / GPU bubble ratio: 12.89%
[rank2]:2025-12-24 14:48:23,340 - Avg. fwd time: 7.6756 / Avg. bwd time: 16.1052 / Avg. batch time: 489.7379 (ms) / GPU bubble ratio: 61.15%
[rank3]:2025-12-24 14:48:23,418 -  step: 650  loss:  0.2454  grad_norm:  0.0740  memory: 28.29GiB(59.55%)  tps: 7,360  tflops: 57.54  mfu: 18.44%
[rank0]:2025-12-24 14:48:23,393 - Avg. fwd time: 8.9313 / Avg. bwd time: 18.6383 / Avg. batch time: 553.1234 (ms) / GPU bubble ratio: 60.13%
[rank0]:2025-12-24 14:48:23,416 -  step: 650  loss: -8.0000  grad_norm:  0.0740  memory: 17.08GiB(35.95%)  tps: 7,360  tflops: 57.54  mfu: 18.44%
[rank2]:2025-12-24 14:48:23,402 -  step: 650  loss: -8.0000  grad_norm:  0.0740  memory: 12.26GiB(25.80%)  tps: 7,361  tflops: 57.54  mfu: 18.44%
[rank1]:2025-12-24 14:48:23,365 - Avg. fwd time: 10.3435 / Avg. bwd time: 17.0811 / Avg. batch time: 521.3242 (ms) / GPU bubble ratio: 57.92%
[rank1]:2025-12-24 14:48:23,402 -  step: 650  loss: -8.0000  grad_norm:  0.0740  memory: 15.15GiB(31.89%)  tps: 7,360  tflops: 57.54  mfu: 18.44%
[rank2]:2025-12-24 14:49:02,991 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0129e+00
[rank1]:2025-12-24 14:49:02,992 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3454e+00
[rank3]:2025-12-24 14:49:03,007 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5373e+00
[rank0]:2025-12-24 14:49:03,007 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0818e+00
[rank1]:2025-12-24 14:49:47,565 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9399e+00
[rank3]:2025-12-24 14:49:47,580 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0266e+00
[rank2]:2025-12-24 14:49:47,577 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6873e-01
[rank0]:2025-12-24 14:49:47,580 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9234e+00
[rank3]:2025-12-24 14:50:14,042 - Avg. fwd time: 11.3746 / Avg. bwd time: 38.8144 / Avg. batch time: 460.9679 (ms) / GPU bubble ratio: 12.90%
[rank2]:2025-12-24 14:50:14,066 - Avg. fwd time: 7.6820 / Avg. bwd time: 16.0567 / Avg. batch time: 489.4130 (ms) / GPU bubble ratio: 61.20%
[rank1]:2025-12-24 14:50:14,091 - Avg. fwd time: 10.3585 / Avg. bwd time: 16.9582 / Avg. batch time: 520.8701 (ms) / GPU bubble ratio: 58.04%
[rank0]:2025-12-24 14:50:14,120 - Avg. fwd time: 8.9397 / Avg. bwd time: 18.5607 / Avg. batch time: 552.5898 (ms) / GPU bubble ratio: 60.19%
[rank2]:2025-12-24 14:50:31,685 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4351e+00
[rank0]:2025-12-24 14:50:31,701 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5559e+00
[rank1]:2025-12-24 14:50:31,685 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8358e+00
[rank3]:2025-12-24 14:50:31,701 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3209e+00
[rank1]:2025-12-24 14:51:16,380 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.8419e-01
[rank3]:2025-12-24 14:51:16,396 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1364e-01
[rank2]:2025-12-24 14:51:16,392 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8270e-01
[rank0]:2025-12-24 14:51:16,396 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0087e+00
[rank0]:2025-12-24 14:52:00,319 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 14:52:00,320 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.6795e+00
[rank1]:2025-12-24 14:52:00,320 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.9199e+00
[rank3]:2025-12-24 14:52:00,336 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3149e+00
[rank0]:2025-12-24 14:52:00,335 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4407e+00
[rank3]:2025-12-24 14:52:04,705 - Avg. fwd time: 11.3795 / Avg. bwd time: 38.7759 / Avg. batch time: 460.6986 (ms) / GPU bubble ratio: 12.91%
[rank0]:2025-12-24 14:52:04,791 - Avg. fwd time: 8.9473 / Avg. bwd time: 18.4885 / Avg. batch time: 552.0867 (ms) / GPU bubble ratio: 60.24%
[rank0]:2025-12-24 14:52:04,815 -  step: 700  loss: -8.0000  grad_norm:  0.1326  memory: 17.08GiB(35.95%)  tps: 7,400  tflops: 57.85  mfu: 18.54%
[rank2]:2025-12-24 14:52:04,737 - Avg. fwd time: 7.6862 / Avg. bwd time: 16.0237 / Avg. batch time: 489.1037 (ms) / GPU bubble ratio: 61.22%
[rank2]:2025-12-24 14:52:04,810 -  step: 700  loss: -8.0000  grad_norm:  0.1326  memory: 12.26GiB(25.80%)  tps: 7,400  tflops: 57.85  mfu: 18.54%
[rank1]:2025-12-24 14:52:04,763 - Avg. fwd time: 10.3723 / Avg. bwd time: 16.8440 / Avg. batch time: 520.4405 (ms) / GPU bubble ratio: 58.16%
[rank1]:2025-12-24 14:52:04,800 -  step: 700  loss: -8.0000  grad_norm:  0.1326  memory: 15.15GiB(31.89%)  tps: 7,400  tflops: 57.85  mfu: 18.54%
[rank3]:2025-12-24 14:52:04,816 -  step: 700  loss:  0.2110  grad_norm:  0.1326  memory: 28.29GiB(59.55%)  tps: 7,400  tflops: 57.85  mfu: 18.54%
[rank0]:2025-12-24 14:52:04,872 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1452_stage0_step700.svg
[rank2]:2025-12-24 14:52:04,872 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1452_stage2_step700.svg
[rank1]:2025-12-24 14:52:04,873 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1452_stage1_step700.svg
[rank3]:2025-12-24 14:52:04,955 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1452_step700_rank3.svg
[rank3]:			> Batch Time: 537.59 ms, GPU Bubble Ratio: 61.64%, 63.49%, 70.71%, 25.84%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  254-16-271ms   | [S0,MB1,B]  292-16-309ms   | [S0,MB2,B]  331-16-348ms   | [S0,MB3,B]  370-16-386ms   | [S0,MB4,B]  408-16-424ms   | [S0,MB5,B]  447-16-464ms   | [S0,MB6,B]  486-16-503ms   | [S0,MB7,B]  521-16-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  237-13-251ms   | [S1,MB1,B]  275-13-289ms   | [S1,MB2,B]  314-13-328ms   | [S1,MB3,B]  353-13-367ms   | [S1,MB4,B]  391-13-404ms   | [S1,MB5,B]  430-13-444ms   | [S1,MB6,B]  469-13-483ms   | [S1,MB7,B]  503-13-517ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  259-11-270ms   | [S2,MB2,B]  297-11-308ms   | [S2,MB3,B]  335-11-347ms   | [S2,MB4,B]  374-11-386ms   | [S2,MB5,B]  412-11-424ms   | [S2,MB6,B]  451-11-463ms   | [S2,MB7,B]  487-11-498ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-80ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  163-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  252-39-291ms   | [S3,MB3,B]  290-39-329ms   | [S3,MB4,B]  329-39-368ms   | [S3,MB5,B]  368-39-407ms   | [S3,MB6,B]  406-39-445ms   | [S3,MB7,B]  444-39-484ms  
[rank3]:2025-12-24 14:52:05,002 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1452_stage3_step700.svg
[rank1]:2025-12-24 14:52:45,190 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5610e-01
[rank3]:2025-12-24 14:52:45,205 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6239e-01
[rank2]:2025-12-24 14:52:45,201 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5066e-01
[rank0]:2025-12-24 14:52:45,205 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5716e-01
[rank1]:2025-12-24 14:53:29,265 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6960e-01
[rank3]:2025-12-24 14:53:29,281 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8883e-01
[rank2]:2025-12-24 14:53:29,265 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3092e-01
[rank0]:2025-12-24 14:53:29,280 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8720e-01
[rank3]:2025-12-24 14:53:55,975 - Avg. fwd time: 11.3847 / Avg. bwd time: 38.7432 / Avg. batch time: 460.4775 (ms) / GPU bubble ratio: 12.91%
[rank0]:2025-12-24 14:53:56,063 - Avg. fwd time: 8.9546 / Avg. bwd time: 18.4219 / Avg. batch time: 551.7138 (ms) / GPU bubble ratio: 60.30%
[rank2]:2025-12-24 14:53:56,008 - Avg. fwd time: 7.6839 / Avg. bwd time: 16.0411 / Avg. batch time: 488.9112 (ms) / GPU bubble ratio: 61.18%
[rank1]:2025-12-24 14:53:56,034 - Avg. fwd time: 10.3854 / Avg. bwd time: 16.7381 / Avg. batch time: 520.1366 (ms) / GPU bubble ratio: 58.28%
[rank3]:2025-12-24 14:54:14,057 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1430e+00
[rank0]:2025-12-24 14:54:14,057 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5895e-01
[rank2]:2025-12-24 14:54:14,054 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7396e-01
[rank1]:2025-12-24 14:54:14,042 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7396e+00
[rank2]:2025-12-24 14:54:58,045 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9748e+00
[rank1]:2025-12-24 14:54:58,045 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2246e+00
[rank3]:2025-12-24 14:54:58,061 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1447e+00
[rank0]:2025-12-24 14:54:58,060 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1472e+00
[rank3]:2025-12-24 14:55:42,773 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9426e+00
[rank0]:2025-12-24 14:55:42,759 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 14:55:42,773 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1004e-01
[rank2]:2025-12-24 14:55:42,769 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5778e-01
[rank1]:2025-12-24 14:55:42,757 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7757e+00
[rank3]:2025-12-24 14:55:47,141 - Avg. fwd time: 11.3902 / Avg. bwd time: 38.7123 / Avg. batch time: 460.2735 (ms) / GPU bubble ratio: 12.92%
[rank2]:2025-12-24 14:55:47,166 - Avg. fwd time: 7.6836 / Avg. bwd time: 16.0460 / Avg. batch time: 488.7070 (ms) / GPU bubble ratio: 61.16%
[rank1]:2025-12-24 14:55:47,192 - Avg. fwd time: 10.3979 / Avg. bwd time: 16.6394 / Avg. batch time: 519.8289 (ms) / GPU bubble ratio: 58.39%
[rank1]:2025-12-24 14:55:47,230 -  step: 750  loss: -8.0000  grad_norm:  0.0973  memory: 15.15GiB(31.89%)  tps: 7,366  tflops: 57.58  mfu: 18.46%
[rank3]:2025-12-24 14:55:47,246 -  step: 750  loss:  0.2580  grad_norm:  0.0973  memory: 28.29GiB(59.55%)  tps: 7,366  tflops: 57.58  mfu: 18.46%
[rank0]:2025-12-24 14:55:47,221 - Avg. fwd time: 8.9617 / Avg. bwd time: 18.3597 / Avg. batch time: 551.3425 (ms) / GPU bubble ratio: 60.36%
[rank0]:2025-12-24 14:55:47,244 -  step: 750  loss: -8.0000  grad_norm:  0.0973  memory: 17.08GiB(35.95%)  tps: 7,366  tflops: 57.58  mfu: 18.46%
[rank2]:2025-12-24 14:55:47,230 -  step: 750  loss: -8.0000  grad_norm:  0.0973  memory: 12.26GiB(25.80%)  tps: 7,366  tflops: 57.59  mfu: 18.46%
[rank3]:2025-12-24 14:56:26,952 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5891e+00
[rank0]:2025-12-24 14:56:26,951 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2927e+00
[rank2]:2025-12-24 14:56:26,936 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1627e+00
[rank1]:2025-12-24 14:56:26,937 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4004e+00
[rank2]:2025-12-24 14:57:11,715 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1329e-01
[rank0]:2025-12-24 14:57:11,719 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3653e+00
[rank1]:2025-12-24 14:57:11,704 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3454e+00
[rank3]:2025-12-24 14:57:11,719 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8940e+00
[rank1]:2025-12-24 14:57:38,105 - Avg. fwd time: 10.4094 / Avg. bwd time: 16.5469 / Avg. batch time: 519.5007 (ms) / GPU bubble ratio: 58.49%
[rank3]:2025-12-24 14:57:38,054 - Avg. fwd time: 11.3949 / Avg. bwd time: 38.6845 / Avg. batch time: 460.0885 (ms) / GPU bubble ratio: 12.92%
[rank2]:2025-12-24 14:57:38,079 - Avg. fwd time: 7.6892 / Avg. bwd time: 16.0056 / Avg. batch time: 488.4755 (ms) / GPU bubble ratio: 61.19%
[rank0]:2025-12-24 14:57:38,135 - Avg. fwd time: 8.9685 / Avg. bwd time: 18.3015 / Avg. batch time: 550.9557 (ms) / GPU bubble ratio: 60.40%
[rank1]:2025-12-24 14:57:55,791 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2005e+00
[rank3]:2025-12-24 14:57:55,806 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2976e+00
[rank2]:2025-12-24 14:57:55,790 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1848e+00
[rank0]:2025-12-24 14:57:55,806 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3322e+00
[rank1]:2025-12-24 14:58:40,483 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1281e+00
[rank3]:2025-12-24 14:58:40,499 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0931e-01
[rank2]:2025-12-24 14:58:40,495 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9268e-01
[rank0]:2025-12-24 14:58:40,498 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5101e-01
[rank1]:2025-12-24 14:59:24,640 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8470e+00
[rank3]:2025-12-24 14:59:24,656 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5788e+00
[rank2]:2025-12-24 14:59:24,640 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6052e+00
[rank0]:2025-12-24 14:59:24,639 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 14:59:24,656 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6296e+00
[rank3]:2025-12-24 14:59:29,116 - Avg. fwd time: 11.3998 / Avg. bwd time: 38.6599 / Avg. batch time: 459.9308 (ms) / GPU bubble ratio: 12.93%
[rank2]:2025-12-24 14:59:29,150 - Avg. fwd time: 7.6932 / Avg. bwd time: 15.9786 / Avg. batch time: 488.2856 (ms) / GPU bubble ratio: 61.22%
[rank0]:2025-12-24 14:59:29,206 - Avg. fwd time: 8.9750 / Avg. bwd time: 18.2469 / Avg. batch time: 550.6204 (ms) / GPU bubble ratio: 60.45%
[rank1]:2025-12-24 14:59:29,176 - Avg. fwd time: 10.4205 / Avg. bwd time: 16.4601 / Avg. batch time: 519.2208 (ms) / GPU bubble ratio: 58.58%
[rank1]:2025-12-24 14:59:29,215 -  step: 800  loss: -8.0000  grad_norm:  0.5020  memory: 15.15GiB(31.89%)  tps: 7,381  tflops: 57.70  mfu: 18.49%
[rank1]:2025-12-24 14:59:29,215 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5020  tps: 7,676  tflops: 60.00  mfu: 17.56%
[rank1]:2025-12-24 14:59:29,215 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 14:59:29,216 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 14:59:29,231 -  step: 800  loss:  0.2601  grad_norm:  0.5020  memory: 28.29GiB(59.55%)  tps: 7,381  tflops: 57.70  mfu: 18.49%
[rank3]:2025-12-24 14:59:29,232 - â„¹ï¸ final step: 800  loss:  0.2601  grad_norm:  0.5020  tps: 7,679  tflops: 60.03  mfu: 17.66%
[rank3]:2025-12-24 14:59:29,232 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 14:59:29,233 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-24 14:59:29,225 -  step: 800  loss: -8.0000  grad_norm:  0.5020  memory: 12.26GiB(25.80%)  tps: 7,380  tflops: 57.70  mfu: 18.49%
[rank2]:2025-12-24 14:59:29,225 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5020  tps: 7,675  tflops: 60.00  mfu: 17.54%
[rank2]:2025-12-24 14:59:29,225 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 14:59:29,226 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 14:59:29,229 -  step: 800  loss: -8.0000  grad_norm:  0.5020  memory: 17.08GiB(35.95%)  tps: 7,381  tflops: 57.70  mfu: 18.49%
[rank0]:2025-12-24 14:59:29,229 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5020  tps: 7,675  tflops: 60.00  mfu: 17.54%
[rank0]:2025-12-24 14:59:29,229 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 14:59:29,230 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 14:59:31,306 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-24 14:59:31,381 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank2/251224_1459_stage2_final800.svg
[rank0]:2025-12-24 14:59:31,383 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank0/251224_1459_stage0_final800.svg
[rank1]:2025-12-24 14:59:31,384 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank1/251224_1459_stage1_final800.svg
[rank3]:2025-12-24 14:59:31,464 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1459_final800_rank3.svg
[rank3]:			> Batch Time: 543.12 ms, GPU Bubble Ratio: 62.06%, 63.88%, 60.81%, 26.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-8-72ms      | [S0,MB0,B]  261-16-277ms   | [S0,MB1,B]  297-16-314ms   | [S0,MB2,B]  335-16-351ms   | [S0,MB3,B]  373-16-390ms   | [S0,MB4,B]  412-16-429ms   | [S0,MB5,B]  452-16-468ms   | [S0,MB6,B]  490-16-507ms   | [S0,MB7,B]  526-16-543ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  239-13-253ms   | [S1,MB1,B]  278-13-292ms   | [S1,MB2,B]  316-13-330ms   | [S1,MB3,B]  355-13-369ms   | [S1,MB4,B]  394-13-408ms   | [S1,MB5,B]  433-13-446ms   | [S1,MB6,B]  472-13-485ms   | [S1,MB7,B]  507-13-521ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-7-41ms      | [S2,MB2,F]  53-7-60ms      | [S2,MB3,F]  71-7-78ms      | [S2,MB4,F]  90-7-97ms      | [S2,MB5,F]  109-7-116ms    | [S2,MB6,F]  128-7-135ms    | [S2,MB7,F]  147-7-154ms    | [S2,MB0,B]  221-16-238ms   | [S2,MB1,B]  259-19-278ms   | [S2,MB2,B]  297-19-316ms   | [S2,MB3,B]  335-19-355ms   | [S2,MB4,B]  374-19-393ms   | [S2,MB5,B]  412-19-432ms   | [S2,MB6,B]  451-19-471ms   | [S2,MB7,B]  487-19-507ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  163-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  215-36-252ms   | [S3,MB2,B]  252-38-290ms   | [S3,MB3,B]  290-39-329ms   | [S3,MB4,B]  328-39-367ms   | [S3,MB5,B]  367-39-406ms   | [S3,MB6,B]  406-39-445ms   | [S3,MB7,B]  444-39-484ms  
[rank1]:2025-12-24 14:59:31,541 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_params_histogram/251224_1459_rank1_stage1.svg
[rank1]:	> Counts Sum: 2268, Total Sum: 3375 (67.20%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-24 14:59:31,541 - Destroying the purge thread.
[rank3]:2025-12-24 14:59:31,600 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/pipeline_schedule/251224_1459_thry_final800_rank3.svg
[rank3]:			> Batch Time: 318.17 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-38ms      | [S0,MB4,F]  38-9-48ms      | [S0,MB5,F]  48-9-57ms      | [S0,MB6,F]  57-9-67ms      | [S0,MB7,F]  67-9-77ms      | [S0,MB0,B]  163-19-183ms   | [S0,MB1,B]  183-19-202ms   | [S0,MB2,B]  202-19-221ms   | [S0,MB3,B]  221-19-241ms   | [S0,MB4,B]  241-19-260ms   | [S0,MB5,B]  260-19-279ms   | [S0,MB6,B]  279-19-298ms   | [S0,MB7,B]  298-19-318ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-28ms      | [S1,MB2,F]  28-9-38ms      | [S1,MB3,F]  38-9-48ms      | [S1,MB4,F]  48-9-57ms      | [S1,MB5,F]  57-9-67ms      | [S1,MB6,F]  67-9-77ms      | [S1,MB7,F]  77-9-86ms      | [S1,MB0,B]  144-19-163ms   | [S1,MB1,B]  163-19-183ms   | [S1,MB2,B]  183-19-202ms   | [S1,MB3,B]  202-19-221ms   | [S1,MB4,B]  221-19-241ms   | [S1,MB5,B]  241-19-260ms   | [S1,MB6,B]  260-19-279ms   | [S1,MB7,B]  279-19-298ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-28ms      | [S2,MB1,F]  28-9-38ms      | [S2,MB2,F]  38-9-48ms      | [S2,MB3,F]  48-9-57ms      | [S2,MB4,F]  57-9-67ms      | [S2,MB5,F]  67-9-77ms      | [S2,MB6,F]  77-9-86ms      | [S2,MB7,F]  86-9-96ms      | [S2,MB0,B]  125-19-144ms   | [S2,MB1,B]  144-19-163ms   | [S2,MB2,B]  163-19-183ms   | [S2,MB3,B]  183-19-202ms   | [S2,MB4,B]  202-19-221ms   | [S2,MB5,B]  221-19-241ms   | [S2,MB6,B]  241-19-260ms   | [S2,MB7,B]  260-19-279ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-9-38ms      | [S3,MB1,F]  38-9-48ms      | [S3,MB2,F]  48-9-57ms      | [S3,MB3,F]  57-9-67ms      | [S3,MB4,F]  67-9-77ms      | [S3,MB5,F]  77-9-86ms      | [S3,MB6,F]  86-9-96ms      | [S3,MB7,F]  96-9-106ms     | [S3,MB0,B]  106-19-125ms   | [S3,MB1,B]  125-19-144ms   | [S3,MB2,B]  144-19-163ms   | [S3,MB3,B]  163-19-183ms   | [S3,MB4,B]  183-19-202ms   | [S3,MB5,B]  202-19-221ms   | [S3,MB6,B]  221-19-241ms   | [S3,MB7,B]  241-19-260ms  
[rank2]:2025-12-24 14:59:31,546 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_params_histogram/251224_1459_rank2_stage2.svg
[rank2]:	> Counts Sum: 999, Total Sum: 2700 (37.00%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-24 14:59:31,547 - Destroying the purge thread.
[rank0]:2025-12-24 14:59:31,547 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_params_histogram/251224_1459_rank0_stage0.svg
[rank0]:	> Counts Sum: 1755, Total Sum: 2775 (63.24%), Ratio(%) per element: [0.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-24 14:59:31,547 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-24 14:59:31,648 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_ratio_history/rank3/251224_1459_stage3_final800.svg
[rank3]:2025-12-24 14:59:31,780 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1/frozen_params_histogram/251224_1459_rank3_stage3.svg
[rank3]:	> Counts Sum: 1224, Total Sum: 2175 (56.28%), Ratio(%) per element: [90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-24 14:59:31,781 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-24 14:59:31,986 - Process group destroyed
[rank1]:2025-12-24 14:59:32,007 - Process group destroyed
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.26713
[rank3]:wandb:               final/avg_loss 0.26011
[rank3]:wandb:             final/avg_mfu(%) 17.65631
[rank3]:wandb:             final/avg_tflops 60.03214
[rank3]:wandb:    final/avg_throughput(tps) 7679.16035
[rank3]:wandb:              final/grad_norm 0.50203
[rank3]:wandb:               final/max_loss 0.26011
[rank3]:wandb:                    grad_norm 0.50203
[rank3]:wandb: loss_metrics/global_avg_loss 0.26011
[rank3]:wandb: loss_metrics/global_max_loss 0.26011
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_GPipe_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/d3qktkl9
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_GPipe_auto_42_dm1/20251224-1358/wandb/run-20251224_135901-d3qktkl9/logs
[rank3]:2025-12-24 14:59:32,987 - Process group destroyed
[rank0]:2025-12-24 14:59:33,547 - Training completed
[rank0]:2025-12-24 14:59:33,547 - Destroying the purge thread.
[rank0]:2025-12-24 14:59:34,037 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.11', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.1', 'layers.0', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.8', 'layers.5', 'layers.7', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'output', 'norm', 'layers.13', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_GPipe_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_GPipe_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_GPipe_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_GPipe_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_GPipe_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_GPipe_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_GPipe_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_GPipe_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
