
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 27. (í† ) 23:24:15 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_ZBVZeroBubble_timelyapf_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with timelyapf x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-27 23:24:21,796 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank0]:2025-12-27 23:24:21,797 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank3]:2025-12-27 23:24:21,997 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank2]:2025-12-27 23:24:21,973 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank1]:2025-12-27 23:24:22,050 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-27 23:24:22,052 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 23:24:22,043 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-27 23:24:22,046 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 23:24:22,051 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-27 23:24:22,052 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-27 23:24:22,217 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-27 23:24:22,219 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-27 23:24:22,211 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-27 23:24:22,214 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 23:24:22,451 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-27 23:24:25,565 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-27 23:24:25,766 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-27 23:24:25,805 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 23:24:25,834 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-27 23:24:25,848 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-27 23:24:25,850 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-27 23:24:25,995 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-27 23:24:26,058 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-27 23:24:26,097 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 23:24:26,124 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank3]:2025-12-27 23:24:26,034 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 23:24:26,062 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-27 23:24:26,075 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-27 23:24:26,077 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-27 23:24:26,059 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 23:24:26,060 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-27 23:24:26,060 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-27 23:24:26,137 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-27 23:24:26,138 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-27 23:24:26,329 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 23:24:26,330 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-27 23:24:26,290 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 23:24:26,290 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-27 23:24:26,330 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:2025-12-27 23:24:26,291 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run ssq1q8on
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_timelyapf_11_dm1/20251227-2324/wandb/run-20251227_232426-ssq1q8on
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1227_ZBVZeroBubble_timelyapf_11_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ssq1q8on
[rank0]:2025-12-27 23:24:27,880 - WandB logging enabled
[rank0]:2025-12-27 23:24:27,881 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 23:24:27,921 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 23:24:27,923 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-27 23:24:27,951 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-27 23:24:27,965 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-27 23:24:27,967 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-27 23:24:28,176 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 23:24:28,157 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 23:24:28,176 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 23:24:28,158 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-27 23:24:28,159 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-27 23:24:28,175 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_ZBVZeroBubble_timelyapf_11_dm1
[rank0]:2025-12-27 23:24:28,175 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 23:24:28,176 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-27 23:24:28,176 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-27 23:24:28,175 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 23:24:31,631 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-27 23:24:31,631 - Finished loading the checkpoint in 3.46 seconds.
[rank0]:2025-12-27 23:24:31,632 - Training starts at step 1
[rank3]:2025-12-27 23:24:36,620 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 13.43GiB(28.27%)  tps: 3,096  tflops: 24.20  mfu: 7.76%
[rank3]:2025-12-27 23:24:36,621 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-27 23:24:36,643 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 15.52GiB(32.68%)  tps: 3,107  tflops: 24.29  mfu: 7.79%
[rank2]:2025-12-27 23:24:36,621 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 11.98GiB(25.23%)  tps: 3,030  tflops: 23.69  mfu: 7.59%
[rank1]:2025-12-27 23:24:36,643 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-27 23:24:36,621 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-27 23:24:36,676 -  step:  1  loss: 10.6092  grad_norm: 203.0663  memory: 30.01GiB(63.17%)  tps: 3,744  tflops: 29.27  mfu: 9.38%
[rank0]:2025-12-27 23:24:36,676 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-27 23:28:10,562 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-27 23:28:15,193 - Avg. fwd time: 7.7200 / Avg. bwd-weight time: 9.6553 / Avg. bwd-input time: 9.5210 / Avg. batch time: 1014.5974 (ms) / GPU bubble ratio: 57.59%
[rank1]:2025-12-27 23:28:15,210 - Avg. fwd time: 9.9007 / Avg. bwd-weight time: 13.0263 / Avg. bwd-input time: 12.3404 / Avg. batch time: 1058.2234 (ms) / GPU bubble ratio: 46.68%
[rank2]:2025-12-27 23:28:15,187 - Avg. fwd time: 7.9055 / Avg. bwd-weight time: 9.9443 / Avg. bwd-input time: 9.8243 / Avg. batch time: 1019.5466 (ms) / GPU bubble ratio: 56.57%
[rank0]:2025-12-27 23:28:15,214 - Avg. fwd time: 12.9258 / Avg. full-bwd time: 27.7822 (Avg. bwd-weight time: 28.6338 / Avg. bwd-input time: 33.6290) / Avg. batch time: 1073.9358 (ms) / GPU bubble ratio: 13.67%
[rank3]:2025-12-27 23:28:15,260 -  step: 50  loss: -4.0000  grad_norm: 23.7470  memory: 15.27GiB(32.13%)  tps: 7,344  tflops: 57.41  mfu: 18.40%
[rank1]:2025-12-27 23:28:15,264 -  step: 50  loss: -4.0000  grad_norm: 23.7470  memory: 17.85GiB(37.57%)  tps: 7,344  tflops: 57.42  mfu: 18.40%
[rank2]:2025-12-27 23:28:15,260 -  step: 50  loss: -4.0000  grad_norm: 23.7470  memory: 13.80GiB(29.05%)  tps: 7,344  tflops: 57.41  mfu: 18.40%
[rank0]:2025-12-27 23:28:15,287 -  step: 50  loss:  9.8821  grad_norm: 23.7470  memory: 35.32GiB(74.36%)  tps: 7,345  tflops: 57.42  mfu: 18.40%
[rank3]:2025-12-27 23:28:55,539 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-12-27 23:29:40,096 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-27 23:29:40,284 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-27 23:29:40,308 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-27 23:29:40,288 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-27 23:30:25,198 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-27 23:30:25,303 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-12-27 23:31:29,638 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-27 23:31:30,282 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank2]:2025-12-27 23:31:30,384 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB6] 0.19/0.19, [MB7] 1.00/1.00
[rank1]:2025-12-27 23:31:30,397 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.39/0.39, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.86/0.86, [MB6] 0.99/0.99, [MB7] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-27 23:31:30,404 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.48/0.48, [MB6] 0.36/0.36, [MB7] 0.56/0.56
[rank3]:2025-12-27 23:31:30,784 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2331_max_batch_time.svg
[rank3]:			> Batch Time: 952.70 ms, GPU Bubble Ratio: 1.60%, 40.49%, 53.34%, 54.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  75-16-92ms     | [S7,MB0,BI] 92-32-124ms    | [S7,MB0,BW] 124-25-150ms   | [S7,MB1,F]  150-15-165ms   | [S7,MB1,BI] 165-34-199ms   | [S7,MB1,BW] 199-28-228ms   | [S7,MB2,F]  228-17-245ms   | [S7,MB2,BI] 245-34-279ms   | [S7,MB2,BW] 279-30-310ms   | [S7,MB3,F]  310-18-328ms   | [S7,MB3,BI] 328-34-363ms   | [S7,MB3,BW] 363-29-392ms   | [S0,MB7,F]  392-9-402ms    | [S0,MB0,B]  402-29-431ms   | [S7,MB4,F]  431-18-449ms   | [S7,MB4,BI] 449-34-483ms   | [S7,MB4,BW] 483-30-514ms   | [S0,MB1,B]  514-28-543ms   | [S7,MB5,F]  543-17-560ms   | [S7,MB5,BI] 560-33-594ms   | [S7,MB5,BW] 594-30-624ms   | [S0,MB2,B]  624-28-652ms   | [S7,MB6,F]  652-17-670ms   | [S7,MB6,BI] 670-33-703ms   | [S7,MB6,BW] 703-29-733ms   | [S0,MB3,B]  733-28-761ms   | [S7,MB7,F]  761-17-779ms   | [S7,MB7,BI] 779-33-812ms   | [S7,MB7,BW] 812-29-842ms   | [S0,MB4,B]  842-28-870ms   | [S0,MB5,B]  870-28-898ms   | [S0,MB6,B]  898-27-926ms   | [S0,MB7,B]  926-26-952ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-11-43ms     | [S1,MB3,F]  43-11-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-9-75ms      | [S1,MB5,F]  75-12-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 124-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-151ms    | [S6,MB1,BI] 199-9-208ms    | [S6,MB1,BW] 208-10-219ms   | [S6,MB3,F]  219-7-226ms    | [S6,MB2,BI] 279-9-289ms    | [S6,MB2,BW] 289-10-300ms   | [S1,MB6,F]  300-11-311ms   | [S1,MB0,BI] 311-15-327ms   | [S1,MB0,BW] 327-15-342ms   | [S6,MB4,F]  342-8-350ms    | [S6,MB3,BI] 363-10-373ms   | [S6,MB3,BW] 373-9-383ms    | [S1,MB7,F]  402-13-416ms   | [S1,MB1,BI] 416-15-431ms   | [S1,MB1,BW] 431-14-446ms   | [S6,MB5,F]  446-7-454ms    | [S6,MB4,BI] 483-10-494ms   | [S6,MB4,BW] 494-9-504ms    | [S1,MB2,BI] 504-14-518ms   | [S1,MB2,BW] 518-14-533ms   | [S6,MB6,F]  533-7-540ms    | [S6,MB5,BI] 594-9-604ms    | [S6,MB5,BW] 604-10-615ms   | [S1,MB3,BI] 615-14-629ms   | [S1,MB3,BW] 629-14-644ms   | [S6,MB7,F]  644-7-651ms    | [S6,MB6,BI] 703-9-713ms    | [S6,MB6,BW] 713-11-724ms   | [S1,MB4,BI] 724-14-739ms   | [S6,MB7,BI] 812-10-822ms   | [S1,MB5,BI] 822-15-837ms   | [S1,MB4,BW] 837-15-853ms   | [S1,MB6,BI] 853-14-868ms   | [S1,MB5,BW] 868-16-884ms   | [S1,MB7,BI] 884-15-900ms   | [S1,MB6,BW] 900-17-917ms   | [S6,MB7,BW] 917-11-928ms   | [S1,MB7,BW] 928-17-945ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-8-68ms      | [S5,MB1,F]  68-7-75ms      | [S2,MB4,F]  75-8-84ms      | [S5,MB2,F]  84-8-92ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-153ms   | [S5,MB3,F]  153-7-160ms    | [S5,MB1,BI] 208-9-217ms    | [S5,MB1,BW] 217-10-228ms   | [S2,MB5,F]  228-7-235ms    | [S2,MB0,BI] 235-10-246ms   | [S2,MB0,BW] 246-9-256ms    | [S5,MB4,F]  256-7-263ms    | [S5,MB2,BI] 289-10-299ms   | [S5,MB2,BW] 299-9-309ms    | [S2,MB6,F]  311-9-321ms    | [S2,MB1,BI] 321-10-331ms   | [S2,MB1,BW] 331-9-341ms    | [S5,MB5,F]  341-7-348ms    | [S5,MB3,BI] 373-10-384ms   | [S5,MB3,BW] 384-11-396ms   | [S2,MB7,F]  416-7-423ms    | [S2,MB2,BI] 423-10-433ms   | [S2,MB2,BW] 433-9-443ms    | [S5,MB6,F]  443-7-451ms    | [S5,MB4,BI] 494-10-504ms   | [S5,MB4,BW] 504-9-514ms    | [S2,MB3,BI] 514-9-523ms    | [S2,MB3,BW] 523-9-533ms    | [S5,MB7,F]  533-7-540ms    | [S5,MB5,BI] 604-9-613ms    | [S5,MB5,BW] 613-9-623ms    | [S2,MB4,BI] 623-9-632ms    | [S5,MB6,BI] 713-10-723ms   | [S2,MB5,BI] 723-10-733ms   | [S5,MB7,BI] 822-9-832ms    | [S2,MB6,BI] 832-10-842ms   | [S2,MB4,BW] 842-10-852ms   | [S2,MB7,BI] 852-9-861ms    | [S2,MB5,BW] 861-10-871ms   | [S5,MB6,BW] 871-9-881ms    | [S5,MB7,BW] 881-9-890ms    | [S2,MB6,BW] 890-9-900ms    | [S2,MB7,BW] 900-10-910ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-53ms      | [S4,MB1,F]  53-7-60ms      | [S3,MB2,F]  60-7-68ms      | [S4,MB2,F]  68-8-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-8-152ms    | [S4,MB0,BW] 152-9-161ms    AFR(10):1.0000 | [S3,MB4,F]  161-7-168ms    | [S3,MB0,BI] 168-9-177ms    | [S3,MB0,BW] 177-9-187ms    AFR(10):1.0000 | [S4,MB4,F]  187-7-194ms    | [S4,MB1,BI] 217-10-228ms   | [S4,MB1,BW] 228-10-238ms   AFR(10):1.0000 | [S3,MB5,F]  238-8-246ms    | [S3,MB1,BI] 246-9-255ms    | [S3,MB1,BW] 255-9-265ms    AFR(10):1.0000 | [S4,MB5,F]  265-7-273ms    | [S4,MB2,BI] 299-11-310ms   | [S4,MB2,BW] 310-9-320ms    AFR(10):1.0000 | [S3,MB6,F]  321-7-328ms    | [S3,MB2,BI] 328-9-337ms    | [S3,MB2,BW] 337-9-346ms    AFR(10):1.0000 | [S4,MB6,F]  346-7-354ms    | [S4,MB3,BI] 384-9-394ms    | [S4,MB3,BW] 394-10-404ms   AFR(10):1.0000 | [S3,MB7,F]  423-7-430ms    | [S3,MB3,BI] 430-9-439ms    | [S3,MB3,BW] 439-9-449ms    AFR(10):1.0000 | [S4,MB7,F]  449-7-456ms    | [S4,MB4,BI] 504-10-514ms   | [S4,MB4,BW] 514-9-524ms    AFR(10):1.0000 | [S3,MB4,BI] 524-10-534ms   | [S4,MB5,BI] 613-9-623ms    | [S3,MB5,BI] 623-8-632ms    | [S4,MB6,BI] 723-9-732ms    | [S3,MB6,BI] 732-8-741ms    | [S4,MB7,BI] 832-8-840ms    | [S3,MB7,BI] 840-8-849ms    | [S3,MB4,BW] 849-10-860ms   AFR(10):1.0000 | [S4,MB5,BW] 860-9-869ms    AFR(10):1.0000 | [S4,MB6,BW] 869-9-879ms    AFR(10):1.0000 | [S4,MB7,BW] 879-9-888ms    AFR(10):1.0000 | [S3,MB5,BW] 888-9-898ms    AFR(10):1.0000 | [S3,MB6,BW] 898-10-908ms   AFR(10):1.0000 | [S3,MB7,BW] 908-10-918ms   AFR(10):1.0000
[rank3]:2025-12-27 23:31:31,066 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2331_min_batch_time.svg
[rank3]:			> Batch Time: 557.27 ms, GPU Bubble Ratio: 10.26%, 36.07%, 49.03%, 50.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  75-16-92ms     | [S7,MB0,BI] 92-32-124ms    | [S7,MB0,BW] 124-0-125ms    | [S7,MB1,F]  125-15-140ms   | [S7,MB1,BI] 140-34-174ms   | [S7,MB1,BW] 174-0-174ms    | [S7,MB2,F]  174-17-192ms   | [S7,MB2,BI] 192-34-226ms   | [S7,MB2,BW] 226-0-226ms    | [S7,MB3,F]  226-18-244ms   | [S7,MB3,BI] 244-34-279ms   | [S7,MB3,BW] 279-0-279ms    | [S0,MB7,F]  279-9-289ms    | [S0,MB0,B]  289-0-289ms    | [S7,MB4,F]  289-18-307ms   | [S7,MB4,BI] 307-34-341ms   | [S7,MB4,BW] 341-0-341ms    | [S0,MB1,B]  341-0-341ms    | [S7,MB5,F]  341-17-359ms   | [S7,MB5,BI] 359-33-392ms   | [S7,MB5,BW] 392-0-393ms    | [S0,MB2,B]  393-0-393ms    | [S7,MB6,F]  393-17-410ms   | [S7,MB6,BI] 410-33-444ms   | [S7,MB6,BW] 444-0-444ms    | [S0,MB3,B]  444-0-444ms    | [S7,MB7,F]  444-17-461ms   | [S7,MB7,BI] 461-33-495ms   | [S7,MB7,BW] 495-20-515ms   | [S0,MB4,B]  515-0-515ms    | [S0,MB5,B]  520-0-520ms    | [S0,MB6,B]  539-0-539ms    | [S0,MB7,B]  557-0-557ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-11-43ms     | [S1,MB3,F]  43-11-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-9-75ms      | [S1,MB5,F]  75-12-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 124-9-134ms    | [S6,MB0,BW] 134-0-134ms    | [S6,MB2,F]  134-7-141ms    | [S6,MB1,BI] 174-9-183ms    | [S6,MB1,BW] 183-0-183ms    | [S6,MB3,F]  183-7-191ms    | [S6,MB2,BI] 226-9-235ms    | [S6,MB2,BW] 235-0-235ms    | [S1,MB6,F]  235-11-246ms   | [S1,MB0,BI] 246-15-262ms   | [S1,MB0,BW] 262-0-262ms    | [S6,MB4,F]  262-8-270ms    | [S6,MB3,BI] 279-10-289ms   | [S6,MB3,BW] 289-0-289ms    | [S1,MB7,F]  289-13-303ms   | [S1,MB1,BI] 303-15-319ms   | [S1,MB1,BW] 319-0-319ms    | [S6,MB5,F]  319-7-326ms    | [S6,MB4,BI] 341-10-351ms   | [S6,MB4,BW] 351-0-351ms    | [S1,MB2,BI] 351-14-366ms   | [S1,MB2,BW] 366-0-366ms    | [S6,MB6,F]  366-7-373ms    | [S6,MB5,BI] 392-9-402ms    | [S6,MB5,BW] 402-0-402ms    | [S1,MB3,BI] 402-14-416ms   | [S1,MB3,BW] 416-0-416ms    | [S6,MB7,F]  416-7-424ms    | [S6,MB6,BI] 444-9-453ms    | [S6,MB6,BW] 453-0-453ms    | [S1,MB4,BI] 453-14-468ms   | [S6,MB7,BI] 495-10-505ms   | [S1,MB5,BI] 505-15-520ms   | [S1,MB4,BW] 520-0-520ms    | [S1,MB6,BI] 524-14-539ms   | [S1,MB5,BW] 539-0-539ms    | [S1,MB7,BI] 541-15-557ms   | [S1,MB6,BW] 557-0-557ms    | [S6,MB7,BW] 557-0-557ms    | [S1,MB7,BW] 557-0-557ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-8-68ms      | [S5,MB1,F]  68-7-75ms      | [S2,MB4,F]  75-8-84ms      | [S5,MB2,F]  84-8-92ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-0-143ms    | [S5,MB3,F]  143-7-150ms    | [S5,MB1,BI] 183-9-192ms    | [S5,MB1,BW] 192-0-192ms    | [S2,MB5,F]  192-7-200ms    | [S2,MB0,BI] 200-10-210ms   | [S2,MB0,BW] 210-0-210ms    | [S5,MB4,F]  210-7-218ms    | [S5,MB2,BI] 235-10-245ms   | [S5,MB2,BW] 245-0-245ms    | [S2,MB6,F]  246-9-256ms    | [S2,MB1,BI] 256-10-267ms   | [S2,MB1,BW] 267-0-267ms    | [S5,MB5,F]  267-7-274ms    | [S5,MB3,BI] 289-10-300ms   | [S5,MB3,BW] 300-0-300ms    | [S2,MB7,F]  303-7-310ms    | [S2,MB2,BI] 310-10-321ms   | [S2,MB2,BW] 321-0-321ms    | [S5,MB6,F]  321-7-328ms    | [S5,MB4,BI] 351-10-362ms   | [S5,MB4,BW] 362-0-362ms    | [S2,MB3,BI] 362-9-371ms    | [S2,MB3,BW] 371-0-371ms    | [S5,MB7,F]  371-7-378ms    | [S5,MB5,BI] 402-9-411ms    | [S5,MB5,BW] 411-0-411ms    | [S2,MB4,BI] 411-9-421ms    | [S5,MB6,BI] 453-10-463ms   | [S2,MB5,BI] 463-10-474ms   | [S5,MB7,BI] 505-9-514ms    | [S2,MB6,BI] 514-10-524ms   | [S2,MB4,BW] 524-0-524ms    | [S2,MB7,BI] 532-9-541ms    | [S2,MB5,BW] 541-0-541ms    | [S5,MB6,BW] 541-0-541ms    | [S5,MB7,BW] 541-0-541ms    | [S2,MB6,BW] 541-0-541ms    | [S2,MB7,BW] 541-0-541ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-53ms      | [S4,MB1,F]  53-7-60ms      | [S3,MB2,F]  60-7-68ms      | [S4,MB2,F]  68-8-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-8-152ms    | [S4,MB0,BW] 152-0-152ms    AFR(10):1.0000 | [S3,MB4,F]  152-7-159ms    | [S3,MB0,BI] 159-9-168ms    | [S3,MB0,BW] 168-0-168ms    AFR(10):1.0000 | [S4,MB4,F]  168-7-176ms    | [S4,MB1,BI] 192-10-203ms   | [S4,MB1,BW] 203-0-203ms    AFR(10):1.0000 | [S3,MB5,F]  203-8-211ms    | [S3,MB1,BI] 211-9-220ms    | [S3,MB1,BW] 220-0-220ms    AFR(10):1.0000 | [S4,MB5,F]  220-7-228ms    | [S4,MB2,BI] 245-11-257ms   | [S4,MB2,BW] 257-0-257ms    AFR(10):1.0000 | [S3,MB6,F]  257-7-264ms    | [S3,MB2,BI] 264-9-273ms    | [S3,MB2,BW] 273-0-273ms    AFR(10):1.0000 | [S4,MB6,F]  273-7-280ms    | [S4,MB3,BI] 300-9-310ms    | [S4,MB3,BW] 310-0-310ms    AFR(10):1.0000 | [S3,MB7,F]  310-7-318ms    | [S3,MB3,BI] 318-9-327ms    | [S3,MB3,BW] 327-0-327ms    AFR(10):1.0000 | [S4,MB7,F]  327-7-334ms    | [S4,MB4,BI] 362-10-372ms   | [S4,MB4,BW] 372-0-372ms    AFR(10):1.0000 | [S3,MB4,BI] 372-10-383ms   | [S4,MB5,BI] 411-9-421ms    | [S3,MB5,BI] 421-8-430ms    | [S4,MB6,BI] 463-9-472ms    | [S3,MB6,BI] 472-8-481ms    | [S4,MB7,BI] 514-8-523ms    | [S3,MB7,BI] 523-8-532ms    | [S3,MB4,BW] 532-0-532ms    AFR(10):1.0000 | [S4,MB5,BW] 532-0-532ms    AFR(10):1.0000 | [S4,MB6,BW] 532-0-532ms    AFR(10):1.0000 | [S4,MB7,BW] 532-0-532ms    AFR(10):1.0000 | [S3,MB5,BW] 532-0-532ms    AFR(10):1.0000 | [S3,MB6,BW] 532-0-532ms    AFR(10):1.0000 | [S3,MB7,BW] 532-0-532ms    AFR(10):1.0000
[rank3]:2025-12-27 23:31:31,396 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2331_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 583.90 ms, GPU Bubble Ratio: 2.61%, 19.66%, 28.10%, 31.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  75-16-92ms     | [S7,MB0,BI] 92-32-124ms    | [S7,MB0,BW] 124-15-140ms   | [S7,MB1,F]  140-15-155ms   | [S7,MB1,BI] 155-34-189ms   | [S7,MB1,BW] 189-0-189ms    | [S7,MB2,F]  189-17-207ms   | [S7,MB2,BI] 207-34-241ms   | [S7,MB2,BW] 241-0-241ms    | [S7,MB3,F]  241-18-259ms   | [S7,MB3,BI] 259-34-294ms   | [S7,MB3,BW] 294-0-294ms    | [S0,MB7,F]  294-9-304ms    | [S0,MB0,B]  304-0-304ms    | [S7,MB4,F]  304-18-322ms   | [S7,MB4,BI] 322-34-356ms   | [S7,MB4,BW] 356-0-356ms    | [S0,MB1,B]  356-0-356ms    | [S7,MB5,F]  356-17-374ms   | [S7,MB5,BI] 374-33-407ms   | [S7,MB5,BW] 407-0-408ms    | [S0,MB2,B]  408-0-408ms    | [S7,MB6,F]  408-17-425ms   | [S7,MB6,BI] 425-33-459ms   | [S7,MB6,BW] 459-0-459ms    | [S0,MB3,B]  459-0-459ms    | [S7,MB7,F]  459-17-476ms   | [S7,MB7,BI] 476-33-510ms   | [S7,MB7,BW] 510-29-539ms   | [S0,MB4,B]  539-0-539ms    | [S0,MB5,B]  539-14-554ms   | [S0,MB6,B]  554-17-572ms   | [S0,MB7,B]  572-11-583ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-11-43ms     | [S1,MB3,F]  43-11-54ms     | [S1,MB4,F]  54-11-65ms     | [S6,MB0,F]  65-9-75ms      | [S1,MB5,F]  75-12-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 124-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-151ms    | [S6,MB1,BI] 189-9-198ms    | [S6,MB1,BW] 198-10-209ms   | [S6,MB3,F]  209-7-216ms    | [S6,MB2,BI] 241-9-250ms    | [S6,MB2,BW] 250-10-261ms   | [S1,MB6,F]  261-11-272ms   | [S1,MB0,BI] 272-15-288ms   | [S1,MB0,BW] 288-0-288ms    | [S6,MB4,F]  288-8-296ms    | [S6,MB3,BI] 296-10-307ms   | [S6,MB3,BW] 307-9-317ms    | [S1,MB7,F]  317-13-331ms   | [S1,MB1,BI] 331-15-346ms   | [S1,MB1,BW] 346-2-348ms    | [S6,MB5,F]  348-7-356ms    | [S6,MB4,BI] 356-10-366ms   | [S6,MB4,BW] 366-9-376ms    | [S1,MB2,BI] 376-14-391ms   | [S1,MB2,BW] 391-9-400ms    | [S6,MB6,F]  400-7-408ms    | [S6,MB5,BI] 408-9-417ms    | [S6,MB5,BW] 417-10-428ms   | [S1,MB3,BI] 428-14-443ms   | [S1,MB3,BW] 443-9-452ms    | [S6,MB7,F]  452-7-459ms    | [S6,MB6,BI] 459-9-468ms    | [S6,MB6,BW] 468-11-480ms   | [S1,MB4,BI] 480-14-494ms   | [S6,MB7,BI] 510-10-520ms   | [S1,MB5,BI] 520-15-535ms   | [S1,MB4,BW] 535-4-539ms    | [S1,MB6,BI] 539-14-554ms   | [S1,MB5,BW] 554-2-556ms    | [S1,MB7,BI] 556-15-572ms   | [S1,MB6,BW] 572-0-572ms    | [S6,MB7,BW] 572-11-583ms   | [S1,MB7,BW] 583-0-583ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-8-68ms      | [S5,MB1,F]  68-7-75ms      | [S2,MB4,F]  75-8-84ms      | [S5,MB2,F]  84-8-92ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-153ms   | [S5,MB3,F]  153-7-160ms    | [S5,MB1,BI] 198-9-207ms    | [S5,MB1,BW] 207-10-218ms   | [S2,MB5,F]  218-7-225ms    | [S2,MB0,BI] 225-10-236ms   | [S2,MB0,BW] 236-9-246ms    | [S5,MB4,F]  246-7-253ms    | [S5,MB2,BI] 253-10-263ms   | [S5,MB2,BW] 263-9-273ms    | [S2,MB6,F]  273-9-283ms    | [S2,MB1,BI] 283-10-294ms   | [S2,MB1,BW] 294-9-303ms    | [S5,MB5,F]  303-7-311ms    | [S5,MB3,BI] 311-10-321ms   | [S5,MB3,BW] 321-11-333ms   | [S2,MB7,F]  333-7-341ms    | [S2,MB2,BI] 341-10-351ms   | [S2,MB2,BW] 351-9-361ms    | [S5,MB6,F]  361-7-368ms    | [S5,MB4,BI] 368-10-379ms   | [S5,MB4,BW] 379-9-388ms    | [S2,MB3,BI] 388-9-398ms    | [S2,MB3,BW] 398-9-408ms    | [S5,MB7,F]  408-7-415ms    | [S5,MB5,BI] 417-9-427ms    | [S5,MB5,BW] 427-9-436ms    | [S2,MB4,BI] 436-9-445ms    | [S5,MB6,BI] 468-10-479ms   | [S2,MB5,BI] 479-10-489ms   | [S5,MB7,BI] 520-9-529ms    | [S2,MB6,BI] 529-10-539ms   | [S2,MB4,BW] 539-7-547ms    | [S2,MB7,BI] 547-9-556ms    | [S2,MB5,BW] 556-0-556ms    | [S5,MB6,BW] 556-9-566ms    | [S5,MB7,BW] 566-9-576ms    | [S2,MB6,BW] 576-7-583ms    | [S2,MB7,BW] 583-0-583ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-53ms      | [S4,MB1,F]  53-7-60ms      | [S3,MB2,F]  60-7-68ms      | [S4,MB2,F]  68-8-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-8-152ms    | [S4,MB0,BW] 152-9-161ms    AFR(10):1.0000 | [S3,MB4,F]  161-7-168ms    | [S3,MB0,BI] 168-9-177ms    | [S3,MB0,BW] 177-9-187ms    AFR(10):1.0000 | [S4,MB4,F]  187-7-194ms    | [S4,MB1,BI] 207-10-218ms   | [S4,MB1,BW] 218-10-228ms   AFR(10):1.0000 | [S3,MB5,F]  228-8-236ms    | [S3,MB1,BI] 236-9-245ms    | [S3,MB1,BW] 245-9-255ms    AFR(10):1.0000 | [S4,MB5,F]  255-7-263ms    | [S4,MB2,BI] 263-11-275ms   | [S4,MB2,BW] 275-9-284ms    AFR(10):1.0000 | [S3,MB6,F]  284-7-291ms    | [S3,MB2,BI] 291-9-301ms    | [S3,MB2,BW] 301-9-310ms    AFR(10):1.0000 | [S4,MB6,F]  310-7-318ms    | [S4,MB3,BI] 321-9-331ms    | [S4,MB3,BW] 331-10-342ms   AFR(10):1.0000 | [S3,MB7,F]  342-7-349ms    | [S3,MB3,BI] 349-9-358ms    | [S3,MB3,BW] 358-9-368ms    AFR(10):1.0000 | [S4,MB7,F]  368-7-375ms    | [S4,MB4,BI] 379-10-389ms   | [S4,MB4,BW] 389-9-398ms    AFR(10):1.0000 | [S3,MB4,BI] 398-10-409ms   | [S4,MB5,BI] 427-9-437ms    | [S3,MB5,BI] 437-8-445ms    | [S4,MB6,BI] 479-9-488ms    | [S3,MB6,BI] 488-8-497ms    | [S4,MB7,BI] 529-8-538ms    | [S3,MB7,BI] 538-8-547ms    | [S3,MB4,BW] 547-0-547ms    AFR(10):1.0000 | [S4,MB5,BW] 547-9-556ms    AFR(10):1.0000 | [S4,MB6,BW] 556-9-566ms    AFR(10):1.0000 | [S4,MB7,BW] 566-9-575ms    AFR(10):1.0000 | [S3,MB5,BW] 575-7-583ms    AFR(10):1.0000 | [S3,MB6,BW] 583-0-583ms    AFR(10):1.0000 | [S3,MB7,BW] 583-0-583ms    AFR(10):1.0000
[rank3]:2025-12-27 23:31:31,396 - 	> Batch Time: 583.90 ms (Average Freeze Ratio: 0.38, Time Reduction Rate: 0.39)
[rank3]:2025-12-27 23:31:31,397 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB5] 0.18/0.18, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-27 23:31:34,627 - Avg. fwd time: 7.9584 / Avg. bwd-weight time: 7.9578 / Avg. bwd-input time: 9.8396 / Avg. batch time: 964.1436 (ms) / GPU bubble ratio: 57.26%
[rank2]:2025-12-27 23:31:34,683 -  step: 100  loss: -4.0000  grad_norm:  3.8725  memory: 14.70GiB(30.94%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank1]:2025-12-27 23:31:34,627 - Avg. fwd time: 9.9354 / Avg. bwd-weight time: 10.3973 / Avg. bwd-input time: 12.3593 / Avg. batch time: 1001.5236 (ms) / GPU bubble ratio: 47.77%
[rank1]:2025-12-27 23:31:34,686 -  step: 100  loss: -4.0000  grad_norm:  3.8725  memory: 18.98GiB(39.95%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank3]:2025-12-27 23:31:34,624 - Avg. fwd time: 7.7048 / Avg. bwd-weight time: 7.7247 / Avg. bwd-input time: 9.5411 / Avg. batch time: 953.0413 (ms) / GPU bubble ratio: 58.08%
[rank3]:2025-12-27 23:31:34,683 -  step: 100  loss: -4.0000  grad_norm:  3.8725  memory: 16.16GiB(34.02%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank0]:2025-12-27 23:31:34,638 - Avg. fwd time: 12.8555 / Avg. full-bwd time: 22.0838 (Avg. bwd-weight time: 23.6356 / Avg. bwd-input time: 33.5822) / Avg. batch time: 1017.1599 (ms) / GPU bubble ratio: 17.41%
[rank2]:2025-12-27 23:31:34,771 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2331_stage2_step100.svg
[rank1]:2025-12-27 23:31:34,770 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2331_stage1_step100.svg
[rank0]:2025-12-27 23:31:34,708 -  step: 100  loss:  8.8149  grad_norm:  3.8725  memory: 40.23GiB(84.68%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank0]:2025-12-27 23:31:34,771 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2331_stage0_step100.svg
[rank2]:2025-12-27 23:31:34,808 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2331_stage5_step100.svg
[rank1]:2025-12-27 23:31:34,809 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2331_stage6_step100.svg
[rank0]:2025-12-27 23:31:34,809 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2331_stage7_step100.svg
[rank2]:2025-12-27 23:31:34,909 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank2_stage2.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-27 23:31:34,937 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank1_stage1.svg
[rank1]:	> Counts Sum: 17280, Total Sum: 17280 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-27 23:31:34,995 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2331_step100_rank3.svg
[rank3]:			> Batch Time: 792.00 ms, GPU Bubble Ratio: 36.09%, 54.76%, 63.62%, 65.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-40ms      | [S0,MB5,F]  40-9-49ms      | [S0,MB6,F]  49-7-57ms      | [S7,MB0,F]  110-16-126ms   | [S7,MB0,BI] 138-32-170ms   | [S7,MB0,BW] 170-0-170ms    | [S7,MB1,F]  171-16-187ms   | [S7,MB1,BI] 200-33-233ms   | [S7,MB1,BW] 233-20-254ms   | [S7,MB2,F]  254-17-271ms   | [S7,MB2,BI] 283-34-317ms   | [S7,MB2,BW] 317-0-317ms    | [S7,MB3,F]  317-17-334ms   | [S7,MB3,BI] 347-34-381ms   | [S7,MB3,BW] 381-21-403ms   | [S0,MB7,F]  403-9-412ms    | [S0,MB0,B]  412-0-412ms    | [S7,MB4,F]  419-17-436ms   | [S7,MB4,BI] 448-33-481ms   | [S7,MB4,BW] 481-0-481ms    | [S0,MB1,B]  488-0-488ms    | [S7,MB5,F]  492-14-506ms   | [S7,MB5,BI] 518-32-550ms   | [S7,MB5,BW] 550-0-550ms    | [S0,MB2,B]  557-0-557ms    | [S7,MB6,F]  571-14-585ms   | [S7,MB6,BI] 598-32-631ms   | [S7,MB6,BW] 631-0-631ms    | [S0,MB3,B]  638-0-638ms    | [S7,MB7,F]  652-14-666ms   | [S7,MB7,BI] 678-32-711ms   | [S7,MB7,BW] 711-0-711ms    | [S0,MB4,B]  719-0-719ms    | [S0,MB5,B]  743-0-743ms    | [S0,MB6,B]  768-0-768ms    | [S0,MB7,B]  792-0-792ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  26-10-37ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-124ms    | [S6,MB0,BI] 170-9-180ms    | [S6,MB0,BW] 180-0-180ms    | [S6,MB2,F]  180-8-189ms    | [S6,MB1,BI] 235-9-244ms    | [S6,MB1,BW] 244-0-244ms    | [S6,MB3,F]  244-8-253ms    | [S6,MB2,BI] 316-9-326ms    | [S6,MB2,BW] 326-0-326ms    | [S1,MB6,F]  326-12-338ms   | [S1,MB0,BI] 338-15-354ms   | [S1,MB0,BW] 354-0-354ms    | [S6,MB4,F]  354-7-362ms    | [S6,MB3,BI] 383-9-393ms    | [S6,MB3,BW] 393-0-393ms    | [S1,MB7,F]  412-13-426ms   | [S1,MB1,BI] 426-15-441ms   | [S1,MB1,BW] 441-0-441ms    | [S6,MB5,F]  441-7-449ms    | [S6,MB4,BI] 480-11-492ms   | [S6,MB4,BW] 492-0-492ms    | [S1,MB2,BI] 499-14-513ms   | [S1,MB2,BW] 513-0-513ms    | [S6,MB6,F]  557-7-564ms    | [S6,MB5,BI] 564-10-574ms   | [S6,MB5,BW] 574-0-574ms    | [S1,MB3,BI] 580-14-594ms   | [S1,MB3,BW] 594-0-594ms    | [S6,MB7,F]  637-7-644ms    | [S6,MB6,BI] 644-10-654ms   | [S6,MB6,BW] 655-0-655ms    | [S1,MB4,BI] 661-14-675ms   | [S6,MB7,BI] 711-10-722ms   | [S1,MB5,BI] 722-14-737ms   | [S1,MB4,BW] 737-0-737ms    | [S1,MB6,BI] 748-14-762ms   | [S1,MB5,BW] 762-0-762ms    | [S1,MB7,BI] 771-14-785ms   | [S1,MB6,BW] 785-0-785ms    | [S6,MB7,BW] 785-0-785ms    | [S1,MB7,BW] 785-0-785ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  37-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  93-8-102ms     | [S5,MB2,F]  110-8-119ms    | [S5,MB0,BI] 180-9-189ms    | [S5,MB0,BW] 189-0-189ms    | [S5,MB3,F]  189-8-198ms    | [S5,MB1,BI] 245-9-254ms    | [S5,MB1,BW] 254-0-254ms    | [S2,MB5,F]  254-8-263ms    | [S2,MB0,BI] 262-10-273ms   | [S2,MB0,BW] 273-0-273ms    | [S5,MB4,F]  273-7-281ms    | [S5,MB2,BI] 326-10-336ms   | [S5,MB2,BW] 336-0-336ms    | [S2,MB6,F]  339-9-348ms    | [S2,MB1,BI] 350-10-361ms   | [S2,MB1,BW] 361-0-361ms    | [S5,MB5,F]  361-7-368ms    | [S5,MB3,BI] 416-10-427ms   | [S5,MB3,BW] 427-0-427ms    | [S2,MB7,F]  427-9-437ms    | [S2,MB2,BI] 439-10-449ms   | [S2,MB2,BW] 449-0-449ms    | [S5,MB6,F]  450-7-457ms    | [S5,MB4,BI] 493-10-503ms   | [S5,MB4,BW] 503-0-503ms    | [S2,MB3,BI] 560-9-570ms    | [S2,MB3,BW] 569-0-569ms    | [S5,MB7,F]  580-7-587ms    | [S5,MB5,BI] 587-9-596ms    | [S5,MB5,BW] 596-0-596ms    | [S2,MB4,BI] 641-9-650ms    | [S5,MB6,BI] 654-10-665ms   | [S2,MB5,BI] 665-10-675ms   | [S5,MB7,BI] 722-9-731ms    | [S2,MB6,BI] 731-10-741ms   | [S2,MB4,BW] 741-0-741ms    | [S2,MB7,BI] 756-9-765ms    | [S2,MB5,BW] 765-0-765ms    | [S5,MB6,BW] 765-0-765ms    | [S5,MB7,BW] 765-0-765ms    | [S2,MB6,BW] 765-0-765ms    | [S2,MB7,BW] 766-0-766ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-78ms      | [S3,MB3,F]  93-7-101ms     | [S4,MB3,F]  101-8-109ms    | [S4,MB0,BI] 189-8-198ms    | [S4,MB0,BW] 198-0-198ms    | [S3,MB4,F]  198-6-205ms    | [S3,MB0,BI] 205-8-214ms    | [S3,MB0,BW] 214-0-214ms    | [S4,MB4,F]  214-7-221ms    | [S4,MB1,BI] 254-11-265ms   | [S4,MB1,BW] 265-0-265ms    | [S3,MB5,F]  265-7-273ms    | [S3,MB1,BI] 273-9-282ms    | [S3,MB1,BW] 283-0-283ms    | [S4,MB5,F]  283-7-290ms    | [S4,MB2,BI] 343-11-354ms   | [S4,MB2,BW] 354-0-354ms    | [S3,MB6,F]  354-7-362ms    | [S3,MB2,BI] 362-9-371ms    | [S3,MB2,BW] 371-0-371ms    | [S4,MB6,F]  371-7-378ms    | [S4,MB3,BI] 431-11-443ms   | [S4,MB3,BW] 443-0-443ms    | [S3,MB7,F]  444-7-451ms    | [S3,MB3,BI] 451-9-460ms    | [S3,MB3,BW] 460-0-460ms    | [S4,MB7,F]  460-7-468ms    | [S4,MB4,BI] 553-10-563ms   | [S4,MB4,BW] 563-0-563ms    | [S3,MB4,BI] 563-9-572ms    | [S4,MB5,BI] 634-9-644ms    | [S3,MB5,BI] 643-8-652ms    | [S4,MB6,BI] 665-9-674ms    | [S3,MB6,BI] 674-9-683ms    | [S4,MB7,BI] 731-8-740ms    | [S3,MB7,BI] 740-8-749ms    | [S3,MB4,BW] 749-0-749ms    | [S4,MB5,BW] 749-0-749ms    | [S4,MB6,BW] 749-0-749ms    | [S4,MB7,BW] 750-0-750ms    | [S3,MB5,BW] 750-0-750ms    | [S3,MB6,BW] 750-0-750ms    | [S3,MB7,BW] 750-0-750ms   
[rank0]:2025-12-27 23:31:34,916 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank0_stage0.svg
[rank0]:	> Counts Sum: 12160, Total Sum: 12160 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-27 23:31:34,997 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank0_stage7.svg
[rank0]:	> Counts Sum: 6400, Total Sum: 7040 (90.91%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 68.75, 81.25, 68.75, 81.25]
[rank2]:2025-12-27 23:31:35,006 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-27 23:31:35,045 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage2.svg
[rank2]:2025-12-27 23:31:35,080 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage5.svg
[rank1]:2025-12-27 23:31:35,039 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-27 23:31:35,079 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage1.svg
[rank3]:2025-12-27 23:31:35,037 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2331_stage3_step100.svg
[rank3]:2025-12-27 23:31:35,075 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2331_stage4_step100.svg
[rank0]:2025-12-27 23:31:35,039 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage0.svg
[rank0]:2025-12-27 23:31:35,077 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage7.svg
[rank1]:2025-12-27 23:31:35,116 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage6.svg
[rank3]:2025-12-27 23:31:35,183 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank3_stage3.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-27 23:31:35,282 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2331_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 11520 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2025-12-27 23:31:35,321 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage3.svg
[rank3]:2025-12-27 23:31:35,356 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2331_stage4.svg
[rank0]:2025-12-27 23:34:47,870 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-27 23:34:48,132 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB5] 0.12/0.18, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-12-27 23:34:48,137 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.67/1.00, [MB3] 0.00/0.00, [MB1] 0.57/0.86, [MB4] 0.00/0.00, [MB2] 0.22/0.33, [MB5] 0.00/0.00, [MB3] 0.26/0.39, [MB6] 0.00/0.00, [MB4] 0.49/0.73, [MB5] 0.57/0.86, [MB6] 0.66/0.99, [MB7] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-12-27 23:34:48,129 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.17/0.25, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB6] 0.13/0.19, [MB7] 0.67/1.00
[rank0]:2025-12-27 23:34:48,185 - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.40, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB4] 0.67/1.00, [MB1] 0.67/1.00, [MB5] 0.67/1.00, [MB2] 0.67/1.00, [MB6] 0.67/1.00, [MB3] 0.67/1.00, [MB7] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.32/0.48, [MB6] 0.24/0.36, [MB7] 0.37/0.56
[rank3]:2025-12-27 23:34:52,184 - Avg. fwd time: 7.7131 / Avg. bwd-weight time: 7.9453 / Avg. bwd-input time: 9.5613 / Avg. batch time: 932.2507 (ms) / GPU bubble ratio: 56.72%
[rank3]:2025-12-27 23:34:52,248 -  step: 150  loss: -4.0000  grad_norm: 20.5143  memory: 16.16GiB(34.02%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank2]:2025-12-27 23:34:52,187 - Avg. fwd time: 7.9519 / Avg. bwd-weight time: 8.3066 / Avg. bwd-input time: 9.8674 / Avg. batch time: 943.8586 (ms) / GPU bubble ratio: 55.71%
[rank2]:2025-12-27 23:34:52,248 -  step: 150  loss: -4.0000  grad_norm: 20.5143  memory: 14.74GiB(31.02%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank1]:2025-12-27 23:34:52,189 - Avg. fwd time: 9.9093 / Avg. bwd-weight time: 9.9451 / Avg. bwd-input time: 12.3626 / Avg. batch time: 975.4272 (ms) / GPU bubble ratio: 47.15%
[rank1]:2025-12-27 23:34:52,252 -  step: 150  loss: -4.0000  grad_norm: 20.5143  memory: 18.98GiB(39.95%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank0]:2025-12-27 23:34:52,203 - Avg. fwd time: 12.9011 / Avg. full-bwd time: 20.4263 (Avg. bwd-weight time: 22.6143 / Avg. bwd-input time: 33.6612) / Avg. batch time: 992.8979 (ms) / GPU bubble ratio: 17.41%
[rank0]:2025-12-27 23:34:52,275 -  step: 150  loss:  4.1731  grad_norm: 20.5143  memory: 41.50GiB(87.35%)  tps: 8,293  tflops: 64.83  mfu: 20.78%
[rank0]:2025-12-27 23:37:56,776 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-27 23:37:57,187 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.39/0.39, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.86/0.86, [MB6] 0.99/0.99, [MB7] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-27 23:37:57,182 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB6] 0.19/0.19, [MB7] 1.00/1.00
[rank3]:2025-12-27 23:37:57,183 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB5] 0.18/0.18, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-27 23:37:57,236 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.48/0.48, [MB6] 0.36/0.36, [MB7] 0.56/0.56
[rank1]:2025-12-27 23:38:00,553 - Avg. fwd time: 9.8863 / Avg. bwd-weight time: 9.3186 / Avg. bwd-input time: 12.3847 / Avg. batch time: 951.4012 (ms) / GPU bubble ratio: 46.87%
[rank2]:2025-12-27 23:38:00,553 - Avg. fwd time: 7.9584 / Avg. bwd-weight time: 8.3892 / Avg. bwd-input time: 9.8918 / Avg. batch time: 923.2895 (ms) / GPU bubble ratio: 54.53%
[rank0]:2025-12-27 23:38:00,559 - Avg. fwd time: 12.9350 / Avg. full-bwd time: 19.0750 (Avg. bwd-weight time: 21.2476 / Avg. bwd-input time: 33.7177) / Avg. batch time: 970.1077 (ms) / GPU bubble ratio: 17.61%
[rank3]:2025-12-27 23:38:00,549 - Avg. fwd time: 7.7228 / Avg. bwd-weight time: 7.9500 / Avg. bwd-input time: 9.5985 / Avg. batch time: 911.4191 (ms) / GPU bubble ratio: 55.64%
[rank3]:2025-12-27 23:38:00,602 -  step: 200  loss: -4.0000  grad_norm:  3.8121  memory: 16.16GiB(34.02%)  tps: 8,699  tflops: 68.00  mfu: 21.80%
[rank1]:2025-12-27 23:38:00,604 -  step: 200  loss: -4.0000  grad_norm:  3.8121  memory: 18.98GiB(39.95%)  tps: 8,699  tflops: 68.00  mfu: 21.80%
[rank1]:2025-12-27 23:38:00,665 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2338_stage1_step200.svg
[rank2]:2025-12-27 23:38:00,602 -  step: 200  loss: -4.0000  grad_norm:  3.8121  memory: 14.74GiB(31.02%)  tps: 8,699  tflops: 68.00  mfu: 21.80%
[rank2]:2025-12-27 23:38:00,666 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2338_stage2_step200.svg
[rank0]:2025-12-27 23:38:00,613 -  step: 200  loss:  1.0862  grad_norm:  3.8121  memory: 41.50GiB(87.35%)  tps: 8,699  tflops: 68.01  mfu: 21.80%
[rank0]:2025-12-27 23:38:00,666 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2338_stage0_step200.svg
[rank1]:2025-12-27 23:38:00,707 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2338_stage6_step200.svg
[rank2]:2025-12-27 23:38:00,708 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2338_stage5_step200.svg
[rank0]:2025-12-27 23:38:00,707 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2338_stage7_step200.svg
[rank1]:2025-12-27 23:38:00,830 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank1_stage1.svg
[rank1]:	> Counts Sum: 63800, Total Sum: 103680 (61.54%), Ratio(%) per element: [71.87, 72.91, 73.95, 66.66, 72.91, 67.7, 63.54, 33.33, 32.29, 67.7, 69.79, 73.95, 75.0, 75.0, 71.87, 68.75, 28.12, 27.08, 72.91, 68.75, 67.7, 76.04, 66.66, 67.7, 70.83, 29.16, 29.16]
[rank2]:2025-12-27 23:38:00,806 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank2_stage2.svg
[rank2]:	> Counts Sum: 23840, Total Sum: 69120 (34.49%), Ratio(%) per element: [37.5, 39.58, 34.37, 38.54, 38.54, 37.5, 38.54, 22.91, 21.87, 33.33, 37.5, 37.5, 43.75, 39.58, 37.5, 37.5, 20.83, 23.95]
[rank0]:2025-12-27 23:38:00,810 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank0_stage0.svg
[rank0]:	> Counts Sum: 46200, Total Sum: 72960 (63.32%), Ratio(%) per element: [77.08, 70.83, 63.54, 77.08, 77.08, 75.0, 72.91, 71.87, 30.2, 25.0, 70.83, 59.37, 75.0, 76.04, 70.83, 67.7, 73.95, 29.16, 39.58]
[rank0]:2025-12-27 23:38:00,888 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank0_stage7.svg
[rank0]:	> Counts Sum: 26120, Total Sum: 42240 (61.84%), Ratio(%) per element: [78.12, 78.12, 78.12, 78.12, 77.08, 79.16, 76.04, 33.33, 36.45, 32.29, 33.33]
[rank1]:2025-12-27 23:38:00,927 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 69120 (16.67%), Ratio(%) per element: [16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66]
[rank2]:2025-12-27 23:38:00,905 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 69120 (16.67%), Ratio(%) per element: [16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66]
[rank3]:2025-12-27 23:38:00,945 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2338_step200_rank3.svg
[rank3]:			> Batch Time: 877.25 ms, GPU Bubble Ratio: 20.44%, 46.58%, 51.49%, 53.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-23-194ms   | [S7,MB1,F]  194-15-210ms   | [S7,MB1,BI] 221-33-255ms   | [S7,MB1,BW] 255-21-277ms   | [S7,MB2,F]  276-18-294ms   | [S7,MB2,BI] 306-34-340ms   | [S7,MB2,BW] 340-0-340ms    | [S7,MB3,F]  340-17-358ms   | [S7,MB3,BI] 371-34-406ms   | [S7,MB3,BW] 406-0-406ms    | [S0,MB7,F]  407-9-417ms    | [S0,MB0,B]  418-11-429ms   | [S7,MB4,F]  429-18-447ms   | [S7,MB4,BI] 459-34-494ms   | [S7,MB4,BW] 494-23-517ms   | [S0,MB1,B]  517-11-528ms   | [S7,MB5,F]  528-17-546ms   | [S7,MB5,BI] 557-33-591ms   | [S7,MB5,BW] 591-22-614ms   | [S0,MB2,B]  614-10-624ms   | [S7,MB6,F]  628-17-645ms   | [S7,MB6,BI] 658-33-691ms   | [S7,MB6,BW] 691-0-691ms    | [S0,MB3,B]  698-5-703ms    | [S7,MB7,F]  712-14-727ms   | [S7,MB7,BI] 740-32-773ms   | [S7,MB7,BW] 773-27-800ms   | [S0,MB4,B]  802-9-811ms    | [S0,MB5,B]  811-18-830ms   | [S0,MB6,B]  834-18-852ms   | [S0,MB7,B]  859-18-877ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-94ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 172-9-181ms    | [S6,MB0,BW] 181-10-192ms   | [S6,MB2,F]  191-7-199ms    | [S6,MB1,BI] 257-9-266ms    | [S6,MB1,BW] 266-10-277ms   | [S6,MB3,F]  276-7-284ms    | [S6,MB2,BI] 340-9-349ms    | [S6,MB2,BW] 349-10-360ms   | [S1,MB6,F]  360-11-371ms   | [S1,MB0,BI] 371-16-387ms   | [S1,MB0,BW] 387-0-388ms    | [S6,MB4,F]  388-7-396ms    | [S6,MB3,BI] 406-11-418ms   | [S6,MB3,BW] 417-11-429ms   | [S1,MB7,F]  430-11-442ms   | [S1,MB1,BI] 442-16-459ms   | [S1,MB1,BW] 459-0-459ms    | [S6,MB5,F]  459-8-468ms    | [S6,MB4,BI] 496-10-506ms   | [S6,MB4,BW] 506-10-517ms   | [S1,MB2,BI] 525-14-539ms   | [S1,MB2,BW] 540-10-551ms   | [S6,MB6,F]  614-7-621ms    | [S6,MB5,BI] 621-10-631ms   | [S6,MB5,BW] 631-10-642ms   | [S1,MB3,BI] 642-14-656ms   | [S1,MB3,BW] 656-8-665ms    | [S6,MB7,F]  698-7-705ms    | [S6,MB6,BI] 705-10-716ms   | [S6,MB6,BW] 716-10-727ms   | [S1,MB4,BI] 727-14-741ms   | [S6,MB7,BI] 773-10-784ms   | [S1,MB5,BI] 784-15-799ms   | [S1,MB4,BW] 799-3-802ms    | [S1,MB6,BI] 812-14-827ms   | [S1,MB5,BW] 827-0-828ms    | [S1,MB7,BI] 837-14-851ms   | [S1,MB6,BW] 851-0-852ms    | [S6,MB7,BW] 852-10-862ms   | [S1,MB7,BW] 862-0-862ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-201ms   | [S5,MB3,F]  201-7-208ms    | [S5,MB1,BI] 266-9-275ms    | [S5,MB1,BW] 276-10-286ms   | [S2,MB5,F]  286-7-293ms    | [S2,MB0,BI] 294-10-304ms   | [S2,MB0,BW] 304-9-313ms    | [S5,MB4,F]  314-7-321ms    | [S5,MB2,BI] 350-10-360ms   | [S5,MB2,BW] 360-9-370ms    | [S2,MB6,F]  372-9-382ms    | [S2,MB1,BI] 384-10-394ms   | [S2,MB1,BW] 395-9-405ms    | [S5,MB5,F]  405-7-412ms    | [S5,MB3,BI] 424-10-434ms   | [S5,MB3,BW] 434-10-444ms   | [S2,MB7,F]  444-9-454ms    | [S2,MB2,BI] 456-10-466ms   | [S2,MB2,BW] 467-9-476ms    | [S5,MB6,F]  477-7-484ms    | [S5,MB4,BI] 518-10-529ms   | [S5,MB4,BW] 529-9-539ms    | [S2,MB3,BI] 618-9-627ms    | [S2,MB3,BW] 627-10-637ms   | [S5,MB7,F]  642-7-649ms    | [S5,MB5,BI] 649-9-658ms    | [S5,MB5,BW] 658-9-668ms    | [S2,MB4,BI] 702-9-711ms    | [S5,MB6,BI] 716-10-726ms   | [S2,MB5,BI] 727-10-737ms   | [S5,MB7,BI] 787-9-796ms    | [S2,MB6,BI] 796-10-806ms   | [S2,MB4,BW] 806-8-814ms    | [S2,MB7,BI] 821-9-830ms    | [S2,MB5,BW] 831-0-831ms    | [S5,MB6,BW] 831-10-841ms   | [S5,MB7,BW] 841-9-851ms    | [S2,MB6,BW] 851-7-858ms    | [S2,MB7,BW] 858-0-858ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 191-8-200ms    | [S4,MB0,BW] 200-9-209ms    | [S3,MB4,F]  209-6-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-9-235ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 276-10-286ms   | [S4,MB1,BW] 286-10-297ms   | [S3,MB5,F]  297-8-305ms    | [S3,MB1,BI] 305-9-314ms    | [S3,MB1,BW] 314-9-324ms    | [S4,MB5,F]  324-7-331ms    | [S4,MB2,BI] 377-11-388ms   | [S4,MB2,BW] 388-9-398ms    | [S3,MB6,F]  398-7-405ms    | [S3,MB2,BI] 405-9-414ms    | [S3,MB2,BW] 414-9-424ms    | [S4,MB6,F]  424-7-432ms    | [S4,MB3,BI] 449-12-461ms   | [S4,MB3,BW] 461-9-470ms    | [S3,MB7,F]  471-7-478ms    | [S3,MB3,BI] 478-9-487ms    | [S3,MB3,BW] 488-10-498ms   | [S4,MB7,F]  498-8-506ms    | [S4,MB4,BI] 611-10-621ms   | [S4,MB4,BW] 621-9-630ms    | [S3,MB4,BI] 630-10-641ms   | [S4,MB5,BI] 695-9-705ms    | [S3,MB5,BI] 705-8-714ms    | [S4,MB6,BI] 727-9-736ms    | [S3,MB6,BI] 736-9-745ms    | [S4,MB7,BI] 796-9-805ms    | [S3,MB7,BI] 805-9-814ms    | [S3,MB4,BW] 814-0-814ms    | [S4,MB5,BW] 815-10-825ms   | [S4,MB6,BW] 825-9-835ms    | [S4,MB7,BW] 835-9-844ms    | [S3,MB5,BW] 844-8-853ms    | [S3,MB6,BW] 853-0-853ms    | [S3,MB7,BW] 853-0-853ms   
[rank3]:2025-12-27 23:38:00,989 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2338_stage3_step200.svg
[rank1]:2025-12-27 23:38:01,091 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage1.svg
[rank2]:2025-12-27 23:38:01,074 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage2.svg
[rank0]:2025-12-27 23:38:01,056 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage0.svg
[rank3]:2025-12-27 23:38:01,032 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2338_stage4_step200.svg
[rank3]:2025-12-27 23:38:01,133 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank3_stage3.svg
[rank3]:	> Counts Sum: 27560, Total Sum: 69120 (39.87%), Ratio(%) per element: [47.91, 44.79, 44.79, 44.79, 39.58, 45.83, 41.66, 26.04, 25.0, 44.79, 41.66, 43.75, 45.83, 46.87, 41.66, 42.7, 28.12, 21.87]
[rank1]:2025-12-27 23:38:01,249 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage6.svg
[rank2]:2025-12-27 23:38:01,235 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage5.svg
[rank0]:2025-12-27 23:38:01,223 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage7.svg
[rank3]:2025-12-27 23:38:01,232 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2338_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 69120 (16.67%), Ratio(%) per element: [16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66, 16.66]
[rank3]:2025-12-27 23:38:01,402 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage3.svg
[rank3]:2025-12-27 23:38:01,560 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2338_stage4.svg
[rank0]:2025-12-27 23:40:43,974 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-27 23:40:44,433 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.39/0.39, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.86/0.86, [MB6] 0.99/0.99, [MB7] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-12-27 23:40:44,481 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.48/0.48, [MB6] 0.36/0.36, [MB7] 0.56/0.56
[rank3]:2025-12-27 23:40:44,431 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB5] 0.18/0.18, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-27 23:40:44,431 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB6] 0.19/0.19, [MB7] 1.00/1.00
[rank1]:2025-12-27 23:40:47,743 - Avg. fwd time: 9.8669 / Avg. bwd-weight time: 8.7961 / Avg. bwd-input time: 12.4823 / Avg. batch time: 916.4923 (ms) / GPU bubble ratio: 45.63%
[rank1]:2025-12-27 23:40:47,798 -  step: 250  loss: -4.0000  grad_norm:  4.3869  memory: 18.98GiB(39.95%)  tps: 9,799  tflops: 76.61  mfu: 24.55%
[rank3]:2025-12-27 23:40:47,740 - Avg. fwd time: 7.7437 / Avg. bwd-weight time: 7.9245 / Avg. bwd-input time: 9.6609 / Avg. batch time: 878.1646 (ms) / GPU bubble ratio: 53.85%
[rank3]:2025-12-27 23:40:47,797 -  step: 250  loss: -4.0000  grad_norm:  4.3869  memory: 16.16GiB(34.02%)  tps: 9,799  tflops: 76.61  mfu: 24.55%
[rank0]:2025-12-27 23:40:47,751 - Avg. fwd time: 12.8375 / Avg. full-bwd time: 16.4299 (Avg. bwd-weight time: 18.2531 / Avg. bwd-input time: 33.6253) / Avg. batch time: 935.0310 (ms) / GPU bubble ratio: 19.59%
[rank0]:2025-12-27 23:40:47,823 -  step: 250  loss:  0.4027  grad_norm:  4.3869  memory: 41.50GiB(87.35%)  tps: 9,799  tflops: 76.60  mfu: 24.55%
[rank2]:2025-12-27 23:40:47,743 - Avg. fwd time: 7.9939 / Avg. bwd-weight time: 8.4038 / Avg. bwd-input time: 9.9499 / Avg. batch time: 890.7430 (ms) / GPU bubble ratio: 52.67%
[rank2]:2025-12-27 23:40:47,797 -  step: 250  loss: -4.0000  grad_norm:  4.3869  memory: 14.74GiB(31.02%)  tps: 9,799  tflops: 76.61  mfu: 24.55%
[rank0]:2025-12-27 23:43:30,642 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-27 23:43:31,112 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.86/0.86, [MB4] 0.00/0.00, [MB2] 0.33/0.33, [MB5] 0.00/0.00, [MB3] 0.39/0.39, [MB6] 0.00/0.00, [MB4] 0.73/0.73, [MB5] 0.86/0.86, [MB6] 0.99/0.99, [MB7] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-27 23:43:31,107 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.25/0.25, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB6] 0.19/0.19, [MB7] 1.00/1.00
[rank3]:2025-12-27 23:43:31,106 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB5] 0.18/0.18, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-27 23:43:31,156 - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.48/0.48, [MB6] 0.36/0.36, [MB7] 0.56/0.56
[rank1]:2025-12-27 23:43:34,435 - Avg. fwd time: 9.8535 / Avg. bwd-weight time: 8.4428 / Avg. bwd-input time: 12.5508 / Avg. batch time: 892.9034 (ms) / GPU bubble ratio: 44.72%
[rank0]:2025-12-27 23:43:34,442 - Avg. fwd time: 12.7681 / Avg. full-bwd time: 14.7013 (Avg. bwd-weight time: 16.2581 / Avg. bwd-input time: 33.5606) / Avg. batch time: 911.5347 (ms) / GPU bubble ratio: 20.96%
[rank2]:2025-12-27 23:43:34,435 - Avg. fwd time: 8.0179 / Avg. bwd-weight time: 8.4281 / Avg. bwd-input time: 9.9932 / Avg. batch time: 868.8368 (ms) / GPU bubble ratio: 51.31%
[rank3]:2025-12-27 23:43:34,432 - Avg. fwd time: 7.7580 / Avg. bwd-weight time: 7.9057 / Avg. bwd-input time: 9.7075 / Avg. batch time: 855.8754 (ms) / GPU bubble ratio: 52.57%
[rank1]:2025-12-27 23:43:34,489 -  step: 300  loss: -4.0000  grad_norm:  0.4979  memory: 18.98GiB(39.95%)  tps: 9,829  tflops: 76.84  mfu: 24.63%
[rank0]:2025-12-27 23:43:34,510 -  step: 300  loss:  0.2844  grad_norm:  0.4979  memory: 41.50GiB(87.35%)  tps: 9,829  tflops: 76.84  mfu: 24.63%
[rank2]:2025-12-27 23:43:34,487 -  step: 300  loss: -4.0000  grad_norm:  0.4979  memory: 14.74GiB(31.02%)  tps: 9,829  tflops: 76.84  mfu: 24.63%
[rank3]:2025-12-27 23:43:34,487 -  step: 300  loss: -4.0000  grad_norm:  0.4979  memory: 16.16GiB(34.02%)  tps: 9,829  tflops: 76.84  mfu: 24.63%
[rank1]:2025-12-27 23:43:34,561 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2343_stage1_step300.svg
[rank1]:2025-12-27 23:43:34,602 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2343_stage6_step300.svg
[rank0]:2025-12-27 23:43:34,561 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2343_stage0_step300.svg
[rank0]:2025-12-27 23:43:34,602 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2343_stage7_step300.svg
[rank2]:2025-12-27 23:43:34,560 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2343_stage2_step300.svg
[rank2]:2025-12-27 23:43:34,601 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2343_stage5_step300.svg
[rank1]:2025-12-27 23:43:34,726 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank1_stage1.svg
[rank1]:	> Counts Sum: 130200, Total Sum: 190080 (68.50%), Ratio(%) per element: [78.4, 80.11, 78.4, 76.7, 80.68, 74.43, 73.29, 36.93, 37.5, 75.56, 77.84, 78.97, 80.11, 80.11, 77.84, 74.43, 38.63, 35.79, 79.54, 77.84, 72.15, 80.11, 73.86, 77.84, 76.7, 38.06, 37.5]
[rank0]:2025-12-27 23:43:34,705 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank0_stage0.svg
[rank0]:	> Counts Sum: 95000, Total Sum: 133760 (71.02%), Ratio(%) per element: [81.25, 77.84, 73.29, 81.25, 81.25, 77.84, 78.97, 77.27, 45.45, 42.04, 76.7, 69.31, 81.81, 76.13, 78.97, 76.7, 77.84, 44.88, 50.56]
[rank2]:2025-12-27 23:43:34,697 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank2_stage2.svg
[rank2]:	> Counts Sum: 41440, Total Sum: 126720 (32.70%), Ratio(%) per element: [36.36, 34.09, 33.52, 35.79, 36.93, 33.52, 36.36, 23.86, 23.29, 31.81, 35.22, 36.93, 36.36, 36.93, 36.36, 34.09, 22.72, 24.43]
[rank1]:2025-12-27 23:43:34,824 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 126720 (9.09%), Ratio(%) per element: [9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09]
[rank0]:2025-12-27 23:43:34,785 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank0_stage7.svg
[rank0]:	> Counts Sum: 54120, Total Sum: 77440 (69.89%), Ratio(%) per element: [80.11, 78.4, 79.54, 77.84, 81.25, 81.81, 77.84, 53.97, 53.97, 51.7, 52.27]
[rank2]:2025-12-27 23:43:34,794 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 126720 (9.09%), Ratio(%) per element: [9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09]
[rank3]:2025-12-27 23:43:34,825 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2343_step300_rank3.svg
[rank3]:			> Batch Time: 792.58 ms, GPU Bubble Ratio: 28.99%, 40.43%, 45.66%, 48.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-21-193ms   | [S7,MB1,F]  193-15-209ms   | [S7,MB1,BI] 221-33-254ms   | [S7,MB1,BW] 254-0-254ms    | [S7,MB2,F]  254-17-272ms   | [S7,MB2,BI] 283-33-317ms   | [S7,MB2,BW] 317-0-317ms    | [S7,MB3,F]  317-17-334ms   | [S7,MB3,BI] 346-34-380ms   | [S7,MB3,BW] 380-0-380ms    | [S0,MB7,F]  380-9-390ms    | [S0,MB0,B]  390-0-390ms    | [S7,MB4,F]  398-17-415ms   | [S7,MB4,BI] 427-32-460ms   | [S7,MB4,BW] 460-0-460ms    | [S0,MB1,B]  467-0-467ms    | [S7,MB5,F]  471-14-486ms   | [S7,MB5,BI] 498-32-530ms   | [S7,MB5,BW] 531-0-531ms    | [S0,MB2,B]  537-0-537ms    | [S7,MB6,F]  552-14-566ms   | [S7,MB6,BI] 579-32-611ms   | [S7,MB6,BW] 611-0-611ms    | [S0,MB3,B]  618-0-618ms    | [S7,MB7,F]  632-14-646ms   | [S7,MB7,BI] 658-32-690ms   | [S7,MB7,BW] 691-28-719ms   | [S0,MB4,B]  719-0-719ms    | [S0,MB5,B]  723-15-739ms   | [S0,MB6,B]  751-19-770ms   | [S0,MB7,B]  776-16-792ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 173-9-182ms    | [S6,MB0,BW] 182-10-193ms   | [S6,MB2,F]  192-7-200ms    | [S6,MB1,BI] 254-9-264ms    | [S6,MB1,BW] 264-10-274ms   | [S6,MB3,F]  274-7-282ms    | [S6,MB2,BI] 317-9-327ms    | [S6,MB2,BW] 327-10-338ms   | [S1,MB6,F]  337-11-348ms   | [S1,MB0,BI] 348-15-364ms   | [S1,MB0,BW] 365-0-365ms    | [S6,MB4,F]  365-7-373ms    | [S6,MB3,BI] 380-12-393ms   | [S6,MB3,BW] 393-11-405ms   | [S1,MB7,F]  405-11-416ms   | [S1,MB1,BI] 416-16-433ms   | [S1,MB1,BW] 433-0-433ms    | [S6,MB5,F]  433-8-442ms    | [S6,MB4,BI] 460-12-473ms   | [S6,MB4,BW] 472-10-483ms   | [S1,MB2,BI] 483-14-498ms   | [S1,MB2,BW] 498-11-509ms   | [S6,MB6,F]  537-7-544ms    | [S6,MB5,BI] 544-10-555ms   | [S6,MB5,BW] 555-10-565ms   | [S1,MB3,BI] 566-14-581ms   | [S1,MB3,BW] 580-8-589ms    | [S6,MB7,F]  617-7-625ms    | [S6,MB6,BI] 625-10-635ms   | [S6,MB6,BW] 635-10-646ms   | [S1,MB4,BI] 646-14-661ms   | [S6,MB7,BI] 691-10-701ms   | [S1,MB5,BI] 701-15-716ms   | [S1,MB4,BW] 716-1-718ms    | [S1,MB6,BI] 730-14-744ms   | [S1,MB5,BW] 744-0-745ms    | [S1,MB7,BI] 754-14-768ms   | [S1,MB6,BW] 768-0-768ms    | [S6,MB7,BW] 768-10-779ms   | [S1,MB7,BW] 779-0-779ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  93-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 182-9-192ms    | [S5,MB0,BW] 191-10-202ms   | [S5,MB3,F]  201-7-209ms    | [S5,MB1,BI] 264-9-273ms    | [S5,MB1,BW] 273-10-284ms   | [S2,MB5,F]  284-7-291ms    | [S2,MB0,BI] 291-10-301ms   | [S2,MB0,BW] 301-9-311ms    | [S5,MB4,F]  311-7-319ms    | [S5,MB2,BI] 327-10-338ms   | [S5,MB2,BW] 338-10-348ms   | [S2,MB6,F]  350-10-360ms   | [S2,MB1,BI] 361-11-372ms   | [S2,MB1,BW] 372-9-382ms    | [S5,MB5,F]  382-7-390ms    | [S5,MB3,BI] 395-10-406ms   | [S5,MB3,BW] 406-10-416ms   | [S2,MB7,F]  417-10-428ms   | [S2,MB2,BI] 428-11-440ms   | [S2,MB2,BW] 440-10-450ms   | [S5,MB6,F]  451-8-459ms    | [S5,MB4,BI] 473-11-484ms   | [S5,MB4,BW] 484-10-494ms   | [S2,MB3,BI] 540-9-550ms    | [S2,MB3,BW] 550-10-561ms   | [S5,MB7,F]  564-7-572ms    | [S5,MB5,BI] 572-9-582ms    | [S5,MB5,BW] 581-9-591ms    | [S2,MB4,BI] 621-9-631ms    | [S5,MB6,BI] 635-10-646ms   | [S2,MB5,BI] 646-10-656ms   | [S5,MB7,BI] 703-9-713ms    | [S2,MB6,BI] 713-10-723ms   | [S2,MB4,BW] 723-6-729ms    | [S2,MB7,BI] 738-9-747ms    | [S2,MB5,BW] 747-0-747ms    | [S5,MB6,BW] 747-10-758ms   | [S5,MB7,BW] 758-9-768ms    | [S2,MB6,BW] 767-8-776ms    | [S2,MB7,BW] 776-0-776ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-78ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 192-9-201ms    | [S4,MB0,BW] 201-9-210ms    | [S3,MB4,F]  210-6-217ms    | [S3,MB0,BI] 217-9-226ms    | [S3,MB0,BW] 226-9-236ms    | [S4,MB4,F]  236-7-243ms    | [S4,MB1,BI] 273-10-284ms   | [S4,MB1,BW] 284-10-294ms   | [S3,MB5,F]  294-8-302ms    | [S3,MB1,BI] 302-9-312ms    | [S3,MB1,BW] 312-9-321ms    | [S4,MB5,F]  321-7-329ms    | [S4,MB2,BI] 354-11-366ms   | [S4,MB2,BW] 366-9-376ms    | [S3,MB6,F]  376-7-383ms    | [S3,MB2,BI] 383-9-393ms    | [S3,MB2,BW] 393-9-403ms    | [S4,MB6,F]  403-8-411ms    | [S4,MB3,BI] 421-12-434ms   | [S4,MB3,BW] 434-9-444ms    | [S3,MB7,F]  444-7-452ms    | [S3,MB3,BI] 451-9-461ms    | [S3,MB3,BW] 461-10-472ms   | [S4,MB7,F]  472-8-480ms    | [S4,MB4,BI] 534-10-544ms   | [S4,MB4,BW] 544-9-554ms    | [S3,MB4,BI] 553-10-564ms   | [S4,MB5,BI] 614-10-624ms   | [S3,MB5,BI] 624-9-634ms    | [S4,MB6,BI] 646-9-656ms    | [S3,MB6,BI] 655-9-665ms    | [S4,MB7,BI] 713-9-723ms    | [S3,MB7,BI] 722-9-732ms    | [S3,MB4,BW] 731-0-731ms    | [S4,MB5,BW] 731-10-742ms   | [S4,MB6,BW] 742-9-751ms    | [S4,MB7,BW] 751-9-761ms    | [S3,MB5,BW] 761-7-768ms    | [S3,MB6,BW] 768-0-768ms    | [S3,MB7,BW] 768-0-768ms   
[rank3]:2025-12-27 23:43:34,867 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2343_stage3_step300.svg
[rank3]:2025-12-27 23:43:34,911 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2343_stage4_step300.svg
[rank3]:2025-12-27 23:43:35,010 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank3_stage3.svg
[rank3]:	> Counts Sum: 50360, Total Sum: 126720 (39.74%), Ratio(%) per element: [43.75, 42.61, 43.18, 43.75, 40.9, 42.04, 40.34, 31.25, 30.68, 43.18, 42.04, 42.61, 42.61, 43.18, 41.47, 40.34, 32.38, 28.97]
[rank1]:2025-12-27 23:43:35,119 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage1.svg
[rank0]:2025-12-27 23:43:35,089 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage0.svg
[rank2]:2025-12-27 23:43:35,087 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage2.svg
[rank3]:2025-12-27 23:43:35,107 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2343_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 126720 (9.09%), Ratio(%) per element: [9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09]
[rank1]:2025-12-27 23:43:35,399 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage6.svg
[rank0]:2025-12-27 23:43:35,386 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage7.svg
[rank2]:2025-12-27 23:43:35,368 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage5.svg
[rank3]:2025-12-27 23:43:35,399 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage3.svg
[rank3]:2025-12-27 23:43:35,683 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2343_stage4.svg
[rank0]:2025-12-27 23:46:18,699 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-27 23:46:22,491 - Avg. fwd time: 12.7156 / Avg. full-bwd time: 13.4782 (Avg. bwd-weight time: 14.8356 / Avg. bwd-input time: 33.5188) / Avg. batch time: 895.0837 (ms) / GPU bubble ratio: 22.01%
[rank2]:2025-12-27 23:46:22,487 - Avg. fwd time: 8.0355 / Avg. bwd-weight time: 8.4385 / Avg. bwd-input time: 10.0234 / Avg. batch time: 853.3638 (ms) / GPU bubble ratio: 50.32%
[rank2]:2025-12-27 23:46:22,537 -  step: 350  loss: -4.0000  grad_norm:  0.1378  memory: 14.74GiB(31.02%)  tps: 9,750  tflops: 76.22  mfu: 24.43%
[rank1]:2025-12-27 23:46:22,488 - Avg. fwd time: 9.8448 / Avg. bwd-weight time: 8.1879 / Avg. bwd-input time: 12.5999 / Avg. batch time: 876.2676 (ms) / GPU bubble ratio: 44.07%
[rank1]:2025-12-27 23:46:22,538 -  step: 350  loss: -4.0000  grad_norm:  0.1378  memory: 18.98GiB(39.95%)  tps: 9,750  tflops: 76.22  mfu: 24.43%
[rank3]:2025-12-27 23:46:22,482 - Avg. fwd time: 7.7690 / Avg. bwd-weight time: 7.8919 / Avg. bwd-input time: 9.7421 / Avg. batch time: 839.9824 (ms) / GPU bubble ratio: 51.61%
[rank3]:2025-12-27 23:46:22,537 -  step: 350  loss: -4.0000  grad_norm:  0.1378  memory: 16.16GiB(34.02%)  tps: 9,750  tflops: 76.22  mfu: 24.43%
[rank0]:2025-12-27 23:46:22,562 -  step: 350  loss:  0.2345  grad_norm:  0.1378  memory: 41.50GiB(87.35%)  tps: 9,749  tflops: 76.22  mfu: 24.43%
[rank0]:2025-12-27 23:49:05,771 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-27 23:49:09,591 - Avg. fwd time: 7.7760 / Avg. bwd-weight time: 7.8771 / Avg. bwd-input time: 9.7641 / Avg. batch time: 828.2009 (ms) / GPU bubble ratio: 50.90%
[rank3]:2025-12-27 23:49:09,641 -  step: 400  loss: -4.0000  grad_norm:  0.2178  memory: 16.16GiB(34.02%)  tps: 9,805  tflops: 76.65  mfu: 24.57%
[rank2]:2025-12-27 23:49:09,593 - Avg. fwd time: 8.0480 / Avg. bwd-weight time: 8.4470 / Avg. bwd-input time: 10.0450 / Avg. batch time: 841.7854 (ms) / GPU bubble ratio: 49.55%
[rank2]:2025-12-27 23:49:09,641 -  step: 400  loss: -4.0000  grad_norm:  0.2178  memory: 14.74GiB(31.02%)  tps: 9,805  tflops: 76.65  mfu: 24.57%
[rank0]:2025-12-27 23:49:09,596 - Avg. fwd time: 12.6818 / Avg. full-bwd time: 12.5662 (Avg. bwd-weight time: 13.7854 / Avg. bwd-input time: 33.4893) / Avg. batch time: 882.6810 (ms) / GPU bubble ratio: 22.78%
[rank0]:2025-12-27 23:49:09,665 -  step: 400  loss:  0.2193  grad_norm:  0.2178  memory: 41.50GiB(87.35%)  tps: 9,805  tflops: 76.65  mfu: 24.57%
[rank1]:2025-12-27 23:49:09,592 - Avg. fwd time: 9.8391 / Avg. bwd-weight time: 7.9943 / Avg. bwd-input time: 12.6348 / Avg. batch time: 863.8190 (ms) / GPU bubble ratio: 43.57%
[rank1]:2025-12-27 23:49:09,641 -  step: 400  loss: -4.0000  grad_norm:  0.2178  memory: 18.98GiB(39.95%)  tps: 9,805  tflops: 76.65  mfu: 24.57%
[rank2]:2025-12-27 23:49:09,721 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2349_stage2_step400.svg
[rank2]:2025-12-27 23:49:09,766 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2349_stage5_step400.svg
[rank0]:2025-12-27 23:49:09,723 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2349_stage0_step400.svg
[rank0]:2025-12-27 23:49:09,769 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2349_stage7_step400.svg
[rank1]:2025-12-27 23:49:09,722 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2349_stage1_step400.svg
[rank1]:2025-12-27 23:49:09,769 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2349_stage6_step400.svg
[rank2]:2025-12-27 23:49:09,864 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank2_stage2.svg
[rank2]:	> Counts Sum: 59040, Total Sum: 184320 (32.03%), Ratio(%) per element: [35.15, 34.37, 32.42, 34.37, 34.76, 33.98, 35.15, 24.6, 23.82, 32.03, 33.2, 35.54, 35.15, 35.54, 33.98, 34.37, 23.43, 24.6]
[rank0]:2025-12-27 23:49:09,878 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank0_stage0.svg
[rank0]:	> Counts Sum: 143800, Total Sum: 194560 (73.91%), Ratio(%) per element: [82.03, 80.46, 77.73, 81.25, 81.64, 79.68, 80.07, 79.29, 50.78, 48.43, 80.85, 74.6, 83.98, 79.29, 80.46, 79.68, 79.29, 50.39, 54.29]
[rank2]:2025-12-27 23:49:09,962 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 184320 (6.25%), Ratio(%) per element: [6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25]
[rank0]:2025-12-27 23:49:09,960 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank0_stage7.svg
[rank0]:	> Counts Sum: 82120, Total Sum: 112640 (72.90%), Ratio(%) per element: [80.85, 79.68, 80.85, 78.9, 81.64, 80.46, 79.68, 60.93, 60.54, 58.98, 59.37]
[rank1]:2025-12-27 23:49:09,898 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank1_stage1.svg
[rank1]:	> Counts Sum: 196600, Total Sum: 276480 (71.11%), Ratio(%) per element: [80.46, 81.64, 81.25, 79.68, 82.03, 78.9, 78.12, 40.23, 39.84, 78.51, 79.29, 81.25, 82.42, 82.03, 80.46, 76.56, 41.79, 39.06, 82.03, 80.07, 76.17, 80.07, 77.73, 79.29, 80.07, 41.4, 39.45]
[rank3]:2025-12-27 23:49:09,983 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2349_step400_rank3.svg
[rank3]:			> Batch Time: 795.32 ms, GPU Bubble Ratio: 28.88%, 40.89%, 45.82%, 48.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 172-23-195ms   | [S7,MB1,F]  195-15-211ms   | [S7,MB1,BI] 222-33-256ms   | [S7,MB1,BW] 256-0-256ms    | [S7,MB2,F]  256-17-273ms   | [S7,MB2,BI] 286-34-320ms   | [S7,MB2,BW] 320-0-320ms    | [S7,MB3,F]  320-17-337ms   | [S7,MB3,BI] 350-34-384ms   | [S7,MB3,BW] 384-0-384ms    | [S0,MB7,F]  384-9-394ms    | [S0,MB0,B]  394-0-394ms    | [S7,MB4,F]  402-17-420ms   | [S7,MB4,BI] 432-33-465ms   | [S7,MB4,BW] 464-0-464ms    | [S0,MB1,B]  471-0-471ms    | [S7,MB5,F]  475-15-491ms   | [S7,MB5,BI] 503-32-536ms   | [S7,MB5,BW] 537-0-537ms    | [S0,MB2,B]  543-0-543ms    | [S7,MB6,F]  558-14-572ms   | [S7,MB6,BI] 584-32-617ms   | [S7,MB6,BW] 617-0-617ms    | [S0,MB3,B]  624-0-624ms    | [S7,MB7,F]  638-14-653ms   | [S7,MB7,BI] 665-32-698ms   | [S7,MB7,BW] 698-28-726ms   | [S0,MB4,B]  724-0-724ms    | [S0,MB5,B]  731-20-751ms   | [S0,MB6,B]  759-16-775ms   | [S0,MB7,B]  783-11-795ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  83-11-94ms     | [S6,MB0,F]  94-9-104ms     | [S1,MB5,F]  104-13-117ms   | [S6,MB1,F]  117-8-125ms    | [S6,MB0,BI] 172-9-181ms    | [S6,MB0,BW] 181-10-192ms   | [S6,MB2,F]  192-7-199ms    | [S6,MB1,BI] 256-9-265ms    | [S6,MB1,BW] 265-10-275ms   | [S6,MB3,F]  276-7-283ms    | [S6,MB2,BI] 320-9-329ms    | [S6,MB2,BW] 329-10-340ms   | [S1,MB6,F]  340-11-351ms   | [S1,MB0,BI] 351-15-367ms   | [S1,MB0,BW] 367-0-367ms    | [S6,MB4,F]  367-7-375ms    | [S6,MB3,BI] 384-12-397ms   | [S6,MB3,BW] 396-11-408ms   | [S1,MB7,F]  408-11-420ms   | [S1,MB1,BI] 420-16-436ms   | [S1,MB1,BW] 436-0-437ms    | [S6,MB5,F]  437-8-446ms    | [S6,MB4,BI] 464-12-477ms   | [S6,MB4,BW] 476-10-487ms   | [S1,MB2,BI] 487-14-502ms   | [S1,MB2,BW] 502-7-510ms    | [S6,MB6,F]  543-7-550ms    | [S6,MB5,BI] 550-10-561ms   | [S6,MB5,BW] 561-10-571ms   | [S1,MB3,BI] 571-14-586ms   | [S1,MB3,BW] 586-10-596ms   | [S6,MB7,F]  623-7-631ms    | [S6,MB6,BI] 631-10-642ms   | [S6,MB6,BW] 642-10-653ms   | [S1,MB4,BI] 653-14-668ms   | [S6,MB7,BI] 698-10-708ms   | [S1,MB5,BI] 709-15-724ms   | [S1,MB4,BW] 724-1-725ms    | [S1,MB6,BI] 737-14-752ms   | [S1,MB5,BW] 752-0-752ms    | [S1,MB7,BI] 761-14-776ms   | [S1,MB6,BW] 776-0-776ms    | [S6,MB7,BW] 776-10-786ms   | [S1,MB7,BW] 787-0-787ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-103ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-191ms    | [S5,MB0,BW] 191-10-201ms   | [S5,MB3,F]  201-7-208ms    | [S5,MB1,BI] 265-9-274ms    | [S5,MB1,BW] 275-10-285ms   | [S2,MB5,F]  285-7-293ms    | [S2,MB0,BI] 293-10-303ms   | [S2,MB0,BW] 303-9-313ms    | [S5,MB4,F]  313-7-321ms    | [S5,MB2,BI] 330-10-341ms   | [S5,MB2,BW] 341-10-351ms   | [S2,MB6,F]  353-10-363ms   | [S2,MB1,BI] 364-11-375ms   | [S2,MB1,BW] 375-9-385ms    | [S5,MB5,F]  385-7-393ms    | [S5,MB3,BI] 399-10-410ms   | [S5,MB3,BW] 410-10-420ms   | [S2,MB7,F]  422-10-432ms   | [S2,MB2,BI] 433-11-445ms   | [S2,MB2,BW] 445-10-455ms   | [S5,MB6,F]  455-7-463ms    | [S5,MB4,BI] 477-11-488ms   | [S5,MB4,BW] 488-9-498ms    | [S2,MB3,BI] 546-9-556ms    | [S2,MB3,BW] 556-10-566ms   | [S5,MB7,F]  571-7-578ms    | [S5,MB5,BI] 578-9-587ms    | [S5,MB5,BW] 587-9-597ms    | [S2,MB4,BI] 627-9-637ms    | [S5,MB6,BI] 642-10-652ms   | [S2,MB5,BI] 652-10-662ms   | [S5,MB7,BI] 711-9-720ms    | [S2,MB6,BI] 720-10-730ms   | [S2,MB4,BW] 731-8-739ms    | [S2,MB7,BI] 746-9-755ms    | [S2,MB5,BW] 755-0-755ms    | [S5,MB6,BW] 755-10-765ms   | [S5,MB7,BW] 766-9-775ms    | [S2,MB6,BW] 775-8-783ms    | [S2,MB7,BW] 783-0-783ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-102ms     | [S4,MB3,F]  102-8-110ms    | [S4,MB0,BI] 191-9-200ms    | [S4,MB0,BW] 200-9-209ms    | [S3,MB4,F]  209-6-216ms    | [S3,MB0,BI] 216-9-226ms    | [S3,MB0,BW] 225-9-235ms    | [S4,MB4,F]  235-7-243ms    | [S4,MB1,BI] 275-10-285ms   | [S4,MB1,BW] 285-10-296ms   | [S3,MB5,F]  296-8-304ms    | [S3,MB1,BI] 304-9-313ms    | [S3,MB1,BW] 313-9-323ms    | [S4,MB5,F]  323-7-331ms    | [S4,MB2,BI] 357-11-369ms   | [S4,MB2,BW] 369-9-379ms    | [S3,MB6,F]  379-7-386ms    | [S3,MB2,BI] 386-9-395ms    | [S3,MB2,BW] 395-9-405ms    | [S4,MB6,F]  405-8-413ms    | [S4,MB3,BI] 426-12-439ms   | [S4,MB3,BW] 439-9-449ms    | [S3,MB7,F]  449-7-456ms    | [S3,MB3,BI] 456-9-466ms    | [S3,MB3,BW] 466-10-476ms   | [S4,MB7,F]  476-8-484ms    | [S4,MB4,BI] 539-10-550ms   | [S4,MB4,BW] 550-9-559ms    | [S3,MB4,BI] 559-10-570ms   | [S4,MB5,BI] 620-10-630ms   | [S3,MB5,BI] 630-9-639ms    | [S4,MB6,BI] 653-9-662ms    | [S3,MB6,BI] 662-9-671ms    | [S4,MB7,BI] 721-9-730ms    | [S3,MB7,BI] 730-9-739ms    | [S3,MB4,BW] 739-0-739ms    | [S4,MB5,BW] 739-10-749ms   | [S4,MB6,BW] 749-9-759ms    | [S4,MB7,BW] 759-9-768ms    | [S3,MB5,BW] 768-7-775ms    | [S3,MB6,BW] 775-0-775ms    | [S3,MB7,BW] 775-0-775ms   
[rank3]:2025-12-27 23:49:10,028 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2349_stage3_step400.svg
[rank3]:2025-12-27 23:49:10,072 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2349_stage4_step400.svg
[rank1]:2025-12-27 23:49:10,001 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 184320 (6.25%), Ratio(%) per element: [6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25]
[rank3]:2025-12-27 23:49:10,170 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank3_stage3.svg
[rank3]:	> Counts Sum: 73160, Total Sum: 184320 (39.69%), Ratio(%) per element: [42.57, 42.18, 42.18, 42.18, 40.23, 41.4, 40.23, 33.2, 32.81, 41.79, 41.4, 42.18, 42.57, 42.57, 41.01, 40.23, 33.98, 31.64]
[rank3]:2025-12-27 23:49:10,267 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2349_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 184320 (6.25%), Ratio(%) per element: [6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25, 6.25]
[rank2]:2025-12-27 23:49:10,379 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage2.svg
[rank0]:2025-12-27 23:49:10,406 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage0.svg
[rank1]:2025-12-27 23:49:10,428 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage1.svg
[rank3]:2025-12-27 23:49:10,690 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage3.svg
[rank2]:2025-12-27 23:49:10,804 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage5.svg
[rank0]:2025-12-27 23:49:10,849 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage7.svg
[rank1]:2025-12-27 23:49:10,851 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage6.svg
[rank3]:2025-12-27 23:49:11,126 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2349_stage4.svg
[rank0]:2025-12-27 23:49:29,604 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-27 23:49:30,069 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-27 23:49:30,071 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-27 23:49:30,072 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-27 23:51:53,691 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-27 23:51:57,462 - Avg. fwd time: 9.8332 / Avg. bwd-weight time: 7.8356 / Avg. bwd-input time: 12.6607 / Avg. batch time: 854.0055 (ms) / GPU bubble ratio: 43.18%
[rank2]:2025-12-27 23:51:57,463 - Avg. fwd time: 8.0579 / Avg. bwd-weight time: 8.4579 / Avg. bwd-input time: 10.0614 / Avg. batch time: 832.6616 (ms) / GPU bubble ratio: 48.93%
[rank0]:2025-12-27 23:51:57,469 - Avg. fwd time: 12.6514 / Avg. full-bwd time: 11.8341 (Avg. bwd-weight time: 12.9508 / Avg. bwd-input time: 33.4567) / Avg. batch time: 872.8268 (ms) / GPU bubble ratio: 23.43%
[rank3]:2025-12-27 23:51:57,460 - Avg. fwd time: 7.7819 / Avg. bwd-weight time: 7.8684 / Avg. bwd-input time: 9.7813 / Avg. batch time: 818.8172 (ms) / GPU bubble ratio: 50.31%
[rank1]:2025-12-27 23:51:57,517 -  step: 450  loss: -4.0000  grad_norm:  0.1905  memory: 18.98GiB(39.95%)  tps: 9,760  tflops: 76.30  mfu: 24.45%
[rank2]:2025-12-27 23:51:57,514 -  step: 450  loss: -4.0000  grad_norm:  0.1905  memory: 14.74GiB(31.02%)  tps: 9,760  tflops: 76.30  mfu: 24.45%
[rank0]:2025-12-27 23:51:57,540 -  step: 450  loss:  0.2302  grad_norm:  0.1905  memory: 41.50GiB(87.35%)  tps: 9,760  tflops: 76.30  mfu: 24.45%
[rank3]:2025-12-27 23:51:57,514 -  step: 450  loss: -4.0000  grad_norm:  0.1905  memory: 16.16GiB(34.02%)  tps: 9,760  tflops: 76.30  mfu: 24.45%
[rank0]:2025-12-27 23:54:40,062 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-27 23:54:43,852 - Avg. fwd time: 9.8294 / Avg. bwd-weight time: 7.7166 / Avg. bwd-input time: 12.6809 / Avg. batch time: 845.9646 (ms) / GPU bubble ratio: 42.83%
[rank1]:2025-12-27 23:54:43,899 -  step: 500  loss: -4.0000  grad_norm:  0.2667  memory: 18.98GiB(39.95%)  tps: 9,847  tflops: 76.98  mfu: 24.67%
[rank0]:2025-12-27 23:54:43,855 - Avg. fwd time: 12.6256 / Avg. full-bwd time: 11.2504 (Avg. bwd-weight time: 12.2765 / Avg. bwd-input time: 33.4323) / Avg. batch time: 864.9333 (ms) / GPU bubble ratio: 23.96%
[rank0]:2025-12-27 23:54:43,908 -  step: 500  loss:  0.2269  grad_norm:  0.2667  memory: 41.50GiB(87.35%)  tps: 9,848  tflops: 76.99  mfu: 24.68%
[rank2]:2025-12-27 23:54:43,850 - Avg. fwd time: 8.0659 / Avg. bwd-weight time: 8.4648 / Avg. bwd-input time: 10.0742 / Avg. batch time: 825.2076 (ms) / GPU bubble ratio: 48.42%
[rank3]:2025-12-27 23:54:43,849 - Avg. fwd time: 7.7874 / Avg. bwd-weight time: 7.8587 / Avg. bwd-input time: 9.7950 / Avg. batch time: 811.2031 (ms) / GPU bubble ratio: 49.82%
[rank3]:2025-12-27 23:54:43,897 -  step: 500  loss: -4.0000  grad_norm:  0.2667  memory: 16.16GiB(34.02%)  tps: 9,847  tflops: 76.98  mfu: 24.67%
[rank2]:2025-12-27 23:54:43,897 -  step: 500  loss: -4.0000  grad_norm:  0.2667  memory: 14.74GiB(31.02%)  tps: 9,847  tflops: 76.98  mfu: 24.67%
[rank1]:2025-12-27 23:54:43,958 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2354_stage1_step500.svg
[rank1]:2025-12-27 23:54:43,999 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251227_2354_stage6_step500.svg
[rank0]:2025-12-27 23:54:43,959 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2354_stage0_step500.svg
[rank0]:2025-12-27 23:54:43,999 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251227_2354_stage7_step500.svg
[rank2]:2025-12-27 23:54:43,963 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2354_stage2_step500.svg
[rank2]:2025-12-27 23:54:44,003 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251227_2354_stage5_step500.svg
[rank0]:2025-12-27 23:54:44,106 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank0_stage0.svg
[rank0]:	> Counts Sum: 192600, Total Sum: 255360 (75.42%), Ratio(%) per element: [82.73, 82.44, 78.86, 82.14, 81.25, 80.65, 81.84, 82.14, 53.86, 51.78, 82.44, 77.97, 84.52, 79.46, 80.65, 80.35, 80.35, 53.27, 56.25]
[rank2]:2025-12-27 23:54:44,101 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank2_stage2.svg
[rank2]:	> Counts Sum: 76640, Total Sum: 241920 (31.68%), Ratio(%) per element: [33.92, 34.82, 33.03, 34.22, 33.63, 34.22, 33.92, 24.7, 24.1, 32.44, 33.63, 33.92, 33.33, 34.22, 33.92, 33.63, 23.8, 24.7]
[rank1]:2025-12-27 23:54:44,125 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank1_stage1.svg
[rank1]:	> Counts Sum: 263000, Total Sum: 362880 (72.48%), Ratio(%) per element: [81.84, 82.44, 82.44, 80.95, 82.73, 80.65, 80.35, 42.26, 41.07, 80.65, 80.05, 81.54, 83.33, 82.73, 82.14, 79.46, 43.15, 40.17, 81.84, 80.95, 78.27, 81.84, 79.46, 81.54, 81.25, 42.26, 41.36]
[rank0]:2025-12-27 23:54:44,189 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank0_stage7.svg
[rank0]:	> Counts Sum: 110120, Total Sum: 147840 (74.49%), Ratio(%) per element: [80.95, 79.76, 80.95, 79.76, 81.84, 81.25, 80.65, 64.28, 63.98, 62.79, 63.09]
[rank3]:2025-12-27 23:54:44,222 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251227_2354_step500_rank3.svg
[rank3]:			> Batch Time: 792.06 ms, GPU Bubble Ratio: 29.58%, 40.93%, 45.57%, 48.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-126ms   | [S7,MB0,BI] 138-32-171ms   | [S7,MB0,BW] 171-22-193ms   | [S7,MB1,F]  193-15-209ms   | [S7,MB1,BI] 221-33-254ms   | [S7,MB1,BW] 254-0-254ms    | [S7,MB2,F]  254-17-271ms   | [S7,MB2,BI] 283-34-317ms   | [S7,MB2,BW] 317-0-317ms    | [S7,MB3,F]  317-17-334ms   | [S7,MB3,BI] 347-34-381ms   | [S7,MB3,BW] 381-0-381ms    | [S0,MB7,F]  381-9-391ms    | [S0,MB0,B]  391-0-391ms    | [S7,MB4,F]  399-17-417ms   | [S7,MB4,BI] 427-33-460ms   | [S7,MB4,BW] 461-0-461ms    | [S0,MB1,B]  468-0-468ms    | [S7,MB5,F]  472-16-488ms   | [S7,MB5,BI] 499-32-532ms   | [S7,MB5,BW] 532-0-532ms    | [S0,MB2,B]  539-0-539ms    | [S7,MB6,F]  553-14-567ms   | [S7,MB6,BI] 580-32-612ms   | [S7,MB6,BW] 613-0-613ms    | [S0,MB3,B]  619-0-619ms    | [S7,MB7,F]  634-14-648ms   | [S7,MB7,BI] 661-32-693ms   | [S7,MB7,BW] 694-27-721ms   | [S0,MB4,B]  722-0-722ms    | [S0,MB5,B]  726-15-741ms   | [S0,MB6,B]  754-14-769ms   | [S0,MB7,B]  778-13-792ms  
[rank2]:2025-12-27 23:54:44,197 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank2_stage5.svg
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 172-9-182ms    | [S6,MB0,BW] 182-10-192ms   | [S6,MB2,F]  192-7-199ms    | [S6,MB1,BI] 254-9-263ms    | [S6,MB1,BW] 263-10-274ms   | [S6,MB3,F]  274-7-281ms    | [S6,MB2,BI] 317-9-327ms    | [S6,MB2,BW] 326-10-337ms   | [S1,MB6,F]  337-11-349ms   | [S1,MB0,BI] 348-16-364ms   | [S1,MB0,BW] 364-0-364ms    | [S6,MB4,F]  364-7-372ms    | [S6,MB3,BI] 381-12-394ms   | [S6,MB3,BW] 393-11-405ms   | [S1,MB7,F]  405-11-416ms   | [S1,MB1,BI] 416-16-433ms   | [S1,MB1,BW] 433-0-433ms    | [S6,MB5,F]  433-8-442ms    | [S6,MB4,BI] 461-12-473ms   | [S6,MB4,BW] 473-10-484ms   | [S1,MB2,BI] 484-14-499ms   | [S1,MB2,BW] 499-8-508ms    | [S6,MB6,F]  538-7-546ms    | [S6,MB5,BI] 546-10-556ms   | [S6,MB5,BW] 556-10-567ms   | [S1,MB3,BI] 567-14-582ms   | [S1,MB3,BW] 582-7-589ms    | [S6,MB7,F]  619-7-627ms    | [S6,MB6,BI] 627-10-637ms   | [S6,MB6,BW] 637-10-648ms   | [S1,MB4,BI] 648-14-663ms   | [S6,MB7,BI] 693-10-704ms   | [S1,MB5,BI] 704-15-719ms   | [S1,MB4,BW] 719-1-720ms    | [S1,MB6,BI] 732-14-747ms   | [S1,MB5,BW] 747-0-748ms    | [S1,MB7,BI] 757-14-771ms   | [S1,MB6,BW] 771-0-771ms    | [S6,MB7,BW] 771-10-782ms   | [S1,MB7,BW] 782-0-782ms   
[rank2]:	> Counts Sum: 11520, Total Sum: 241920 (4.76%), Ratio(%) per element: [4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76]
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  93-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 182-9-191ms    | [S5,MB0,BW] 191-10-201ms   | [S5,MB3,F]  201-7-208ms    | [S5,MB1,BI] 263-9-273ms    | [S5,MB1,BW] 273-10-284ms   | [S2,MB5,F]  284-7-291ms    | [S2,MB0,BI] 291-10-301ms   | [S2,MB0,BW] 301-9-311ms    | [S5,MB4,F]  311-7-319ms    | [S5,MB2,BI] 327-10-338ms   | [S5,MB2,BW] 338-10-348ms   | [S2,MB6,F]  349-10-360ms   | [S2,MB1,BI] 361-11-372ms   | [S2,MB1,BW] 372-9-382ms    | [S5,MB5,F]  382-7-390ms    | [S5,MB3,BI] 396-10-407ms   | [S5,MB3,BW] 408-10-418ms   | [S2,MB7,F]  419-10-429ms   | [S2,MB2,BI] 430-11-441ms   | [S2,MB2,BW] 441-10-452ms   | [S5,MB6,F]  452-7-460ms    | [S5,MB4,BI] 473-11-485ms   | [S5,MB4,BW] 484-9-494ms    | [S2,MB3,BI] 541-9-551ms    | [S2,MB3,BW] 551-10-562ms   | [S5,MB7,F]  566-7-573ms    | [S5,MB5,BI] 573-9-583ms    | [S5,MB5,BW] 582-9-592ms    | [S2,MB4,BI] 622-9-632ms    | [S5,MB6,BI] 637-10-647ms   | [S2,MB5,BI] 647-10-658ms   | [S5,MB7,BI] 706-9-716ms    | [S2,MB6,BI] 716-10-726ms   | [S2,MB4,BW] 726-7-733ms    | [S2,MB7,BI] 741-9-750ms    | [S2,MB5,BW] 750-0-750ms    | [S5,MB6,BW] 750-10-761ms   | [S5,MB7,BW] 761-9-770ms    | [S2,MB6,BW] 770-9-780ms    | [S2,MB7,BW] 779-0-779ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 191-9-200ms    | [S4,MB0,BW] 200-9-210ms    | [S3,MB4,F]  209-7-216ms    | [S3,MB0,BI] 216-9-226ms    | [S3,MB0,BW] 226-9-235ms    | [S4,MB4,F]  235-7-243ms    | [S4,MB1,BI] 273-10-284ms   | [S4,MB1,BW] 284-10-294ms   | [S3,MB5,F]  294-8-302ms    | [S3,MB1,BI] 302-9-312ms    | [S3,MB1,BW] 312-9-321ms    | [S4,MB5,F]  321-7-329ms    | [S4,MB2,BI] 354-11-366ms   | [S4,MB2,BW] 366-9-375ms    | [S3,MB6,F]  375-7-382ms    | [S3,MB2,BI] 383-9-392ms    | [S3,MB2,BW] 392-9-402ms    | [S4,MB6,F]  402-8-410ms    | [S4,MB3,BI] 423-12-435ms   | [S4,MB3,BW] 436-9-445ms    | [S3,MB7,F]  445-7-452ms    | [S3,MB3,BI] 452-9-462ms    | [S3,MB3,BW] 462-10-472ms   | [S4,MB7,F]  472-8-480ms    | [S4,MB4,BI] 535-10-545ms   | [S4,MB4,BW] 546-9-555ms    | [S3,MB4,BI] 555-10-566ms   | [S4,MB5,BI] 616-10-626ms   | [S3,MB5,BI] 626-9-635ms    | [S4,MB6,BI] 648-9-657ms    | [S3,MB6,BI] 657-9-666ms    | [S4,MB7,BI] 717-9-726ms    | [S3,MB7,BI] 726-9-735ms    | [S3,MB4,BW] 735-0-735ms    | [S4,MB5,BW] 735-10-745ms   | [S4,MB6,BW] 745-9-754ms    | [S4,MB7,BW] 754-9-764ms    | [S3,MB5,BW] 764-7-771ms    | [S3,MB6,BW] 772-0-772ms    | [S3,MB7,BW] 772-0-772ms   
[rank1]:2025-12-27 23:54:44,226 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 241920 (4.76%), Ratio(%) per element: [4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76]
[rank3]:2025-12-27 23:54:44,263 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2354_stage3_step500.svg
[rank3]:2025-12-27 23:54:44,303 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251227_2354_stage4_step500.svg
[rank3]:2025-12-27 23:54:44,400 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank3_stage3.svg
[rank3]:	> Counts Sum: 95960, Total Sum: 241920 (39.67%), Ratio(%) per element: [42.26, 41.36, 41.36, 41.66, 40.47, 41.07, 39.58, 34.22, 33.92, 41.07, 41.66, 41.96, 42.26, 42.26, 40.47, 40.47, 34.82, 33.03]
[rank3]:2025-12-27 23:54:44,498 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251227_2354_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 241920 (4.76%), Ratio(%) per element: [4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76, 4.76]
[rank1]:2025-12-27 23:54:44,770 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage1.svg
[rank0]:2025-12-27 23:54:44,757 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage0.svg
[rank2]:2025-12-27 23:54:44,743 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage2.svg
[rank3]:2025-12-27 23:54:45,047 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage3.svg
[rank2]:2025-12-27 23:54:45,291 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage5.svg
[rank1]:2025-12-27 23:54:45,322 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage6.svg
[rank0]:2025-12-27 23:54:45,332 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage7.svg
[rank3]:2025-12-27 23:54:45,577 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251227_2354_stage4.svg
[rank0]:2025-12-27 23:57:28,128 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-27 23:57:31,919 - Avg. fwd time: 7.7905 / Avg. bwd-weight time: 7.8516 / Avg. bwd-input time: 9.8046 / Avg. batch time: 805.1387 (ms) / GPU bubble ratio: 49.43%
[rank2]:2025-12-27 23:57:31,926 - Avg. fwd time: 8.0719 / Avg. bwd-weight time: 8.4671 / Avg. bwd-input time: 10.0835 / Avg. batch time: 819.3142 (ms) / GPU bubble ratio: 48.01%
[rank1]:2025-12-27 23:57:31,923 - Avg. fwd time: 9.8263 / Avg. bwd-weight time: 7.6217 / Avg. bwd-input time: 12.6974 / Avg. batch time: 839.6286 (ms) / GPU bubble ratio: 42.55%
[rank0]:2025-12-27 23:57:31,931 - Avg. fwd time: 12.6066 / Avg. full-bwd time: 10.7531 (Avg. bwd-weight time: 11.7400 / Avg. bwd-input time: 33.4115) / Avg. batch time: 858.4810 (ms) / GPU bubble ratio: 24.41%
[rank3]:2025-12-27 23:57:31,976 -  step: 550  loss: -4.0000  grad_norm:  0.1467  memory: 16.16GiB(34.02%)  tps: 9,748  tflops: 76.20  mfu: 24.42%
[rank2]:2025-12-27 23:57:31,976 -  step: 550  loss: -4.0000  grad_norm:  0.1467  memory: 14.74GiB(31.02%)  tps: 9,748  tflops: 76.20  mfu: 24.42%
[rank1]:2025-12-27 23:57:31,977 -  step: 550  loss: -4.0000  grad_norm:  0.1467  memory: 18.98GiB(39.95%)  tps: 9,748  tflops: 76.20  mfu: 24.42%
[rank0]:2025-12-27 23:57:32,001 -  step: 550  loss:  0.2303  grad_norm:  0.1467  memory: 41.50GiB(87.35%)  tps: 9,747  tflops: 76.20  mfu: 24.42%
[rank0]:2025-12-28 00:00:14,816 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-28 00:00:18,650 - Avg. fwd time: 9.8244 / Avg. bwd-weight time: 7.5478 / Avg. bwd-input time: 12.7112 / Avg. batch time: 834.1766 (ms) / GPU bubble ratio: 42.30%
[rank2]:2025-12-28 00:00:18,650 - Avg. fwd time: 8.0775 / Avg. bwd-weight time: 8.4689 / Avg. bwd-input time: 10.0914 / Avg. batch time: 814.2044 (ms) / GPU bubble ratio: 47.65%
[rank3]:2025-12-28 00:00:18,645 - Avg. fwd time: 7.7937 / Avg. bwd-weight time: 7.8457 / Avg. bwd-input time: 9.8124 / Avg. batch time: 799.9935 (ms) / GPU bubble ratio: 49.10%
[rank0]:2025-12-28 00:00:18,653 - Avg. fwd time: 12.5885 / Avg. full-bwd time: 10.3563 (Avg. bwd-weight time: 11.2844 / Avg. bwd-input time: 33.3939) / Avg. batch time: 853.0195 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-12-28 00:00:18,698 -  step: 600  loss: -4.0000  grad_norm:  0.3095  memory: 18.98GiB(39.95%)  tps: 9,827  tflops: 76.82  mfu: 24.62%
[rank2]:2025-12-28 00:00:18,695 -  step: 600  loss: -4.0000  grad_norm:  0.3095  memory: 14.74GiB(31.02%)  tps: 9,827  tflops: 76.83  mfu: 24.62%
[rank2]:2025-12-28 00:00:18,759 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_0000_stage2_step600.svg
[rank3]:2025-12-28 00:00:18,695 -  step: 600  loss: -4.0000  grad_norm:  0.3095  memory: 16.16GiB(34.02%)  tps: 9,827  tflops: 76.83  mfu: 24.62%
[rank0]:2025-12-28 00:00:18,706 -  step: 600  loss:  0.2274  grad_norm:  0.3095  memory: 41.50GiB(87.35%)  tps: 9,828  tflops: 76.83  mfu: 24.63%
[rank0]:2025-12-28 00:00:18,761 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_0000_stage0_step600.svg
[rank1]:2025-12-28 00:00:18,761 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_0000_stage1_step600.svg
[rank1]:2025-12-28 00:00:18,804 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_0000_stage6_step600.svg
[rank2]:2025-12-28 00:00:18,801 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_0000_stage5_step600.svg
[rank0]:2025-12-28 00:00:18,803 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_0000_stage7_step600.svg
[rank1]:2025-12-28 00:00:18,932 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank1_stage1.svg
[rank1]:	> Counts Sum: 329400, Total Sum: 449280 (73.32%), Ratio(%) per element: [83.41, 84.13, 82.93, 82.45, 82.93, 82.21, 81.25, 43.75, 40.86, 81.0, 81.25, 82.21, 83.17, 82.45, 82.69, 81.0, 43.99, 41.82, 82.69, 82.21, 79.32, 82.21, 80.04, 82.93, 81.49, 42.3, 42.78]
[rank2]:2025-12-28 00:00:18,898 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank2_stage2.svg
[rank2]:	> Counts Sum: 94240, Total Sum: 299520 (31.46%), Ratio(%) per element: [34.13, 33.89, 32.45, 33.65, 33.65, 32.93, 33.17, 24.75, 24.27, 31.97, 32.93, 33.89, 33.65, 34.13, 34.37, 33.65, 24.03, 24.75]
[rank0]:2025-12-28 00:00:18,909 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank0_stage0.svg
[rank0]:	> Counts Sum: 241400, Total Sum: 316160 (76.35%), Ratio(%) per element: [82.93, 82.21, 78.84, 82.45, 81.73, 82.69, 82.93, 83.41, 55.76, 54.08, 82.45, 79.8, 83.65, 80.52, 82.45, 81.0, 81.0, 55.28, 57.45]
[rank1]:2025-12-28 00:00:19,031 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 299520 (3.85%), Ratio(%) per element: [3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84]
[rank2]:2025-12-28 00:00:18,995 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 299520 (3.85%), Ratio(%) per element: [3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84]
[rank3]:2025-12-28 00:00:19,025 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251228_0000_step600_rank3.svg
[rank3]:			> Batch Time: 790.93 ms, GPU Bubble Ratio: 29.05%, 40.24%, 45.79%, 48.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-23-195ms   | [S7,MB1,F]  195-16-211ms   | [S7,MB1,BI] 223-33-256ms   | [S7,MB1,BW] 257-0-257ms    | [S7,MB2,F]  257-17-274ms   | [S7,MB2,BI] 287-34-321ms   | [S7,MB2,BW] 321-0-321ms    | [S7,MB3,F]  321-17-338ms   | [S7,MB3,BI] 350-34-384ms   | [S7,MB3,BW] 384-0-384ms    | [S0,MB7,F]  384-9-394ms    | [S0,MB0,B]  394-0-394ms    | [S7,MB4,F]  402-17-419ms   | [S7,MB4,BI] 431-33-464ms   | [S7,MB4,BW] 464-0-464ms    | [S0,MB1,B]  471-0-471ms    | [S7,MB5,F]  476-14-490ms   | [S7,MB5,BI] 502-32-535ms   | [S7,MB5,BW] 535-0-535ms    | [S0,MB2,B]  542-0-542ms    | [S7,MB6,F]  556-14-570ms   | [S7,MB6,BI] 583-32-615ms   | [S7,MB6,BW] 616-0-616ms    | [S0,MB3,B]  622-0-622ms    | [S7,MB7,F]  637-14-651ms   | [S7,MB7,BI] 663-32-696ms   | [S7,MB7,BW] 695-28-723ms   | [S0,MB4,B]  723-0-723ms    | [S0,MB5,B]  728-16-745ms   | [S0,MB6,B]  756-19-776ms   | [S0,MB7,B]  780-10-790ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-13-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 172-9-181ms    | [S6,MB0,BW] 181-10-191ms   | [S6,MB2,F]  191-7-199ms    | [S6,MB1,BI] 257-9-266ms    | [S6,MB1,BW] 266-10-276ms   | [S6,MB3,F]  276-7-284ms    | [S6,MB2,BI] 321-9-330ms    | [S6,MB2,BW] 330-10-341ms   | [S1,MB6,F]  341-11-352ms   | [S1,MB0,BI] 352-15-368ms   | [S1,MB0,BW] 368-0-368ms    | [S6,MB4,F]  368-7-376ms    | [S6,MB3,BI] 384-12-397ms   | [S6,MB3,BW] 397-11-408ms   | [S1,MB7,F]  408-11-420ms   | [S1,MB1,BI] 420-16-436ms   | [S1,MB1,BW] 436-0-437ms    | [S6,MB5,F]  437-8-446ms    | [S6,MB4,BI] 464-12-477ms   | [S6,MB4,BW] 477-10-488ms   | [S1,MB2,BI] 488-14-502ms   | [S1,MB2,BW] 502-10-513ms   | [S6,MB6,F]  541-7-549ms    | [S6,MB5,BI] 549-10-559ms   | [S6,MB5,BW] 559-10-570ms   | [S1,MB3,BI] 570-14-585ms   | [S1,MB3,BW] 585-8-593ms    | [S6,MB7,F]  622-7-629ms    | [S6,MB6,BI] 629-10-640ms   | [S6,MB6,BW] 640-10-651ms   | [S1,MB4,BI] 651-14-666ms   | [S6,MB7,BI] 695-10-706ms   | [S1,MB5,BI] 706-15-721ms   | [S1,MB4,BW] 721-2-724ms    | [S1,MB6,BI] 735-14-749ms   | [S1,MB5,BW] 749-0-750ms    | [S1,MB7,BI] 759-14-773ms   | [S1,MB6,BW] 773-0-773ms    | [S6,MB7,BW] 773-10-784ms   | [S1,MB7,BW] 784-0-784ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 181-9-190ms    | [S5,MB0,BW] 190-10-201ms   | [S5,MB3,F]  201-7-208ms    | [S5,MB1,BI] 266-9-275ms    | [S5,MB1,BW] 275-10-286ms   | [S2,MB5,F]  286-7-293ms    | [S2,MB0,BI] 293-10-304ms   | [S2,MB0,BW] 304-9-313ms    | [S5,MB4,F]  313-7-321ms    | [S5,MB2,BI] 330-10-341ms   | [S5,MB2,BW] 341-10-351ms   | [S2,MB6,F]  353-10-363ms   | [S2,MB1,BI] 365-11-376ms   | [S2,MB1,BW] 376-9-385ms    | [S5,MB5,F]  386-7-393ms    | [S5,MB3,BI] 400-10-410ms   | [S5,MB3,BW] 410-10-420ms   | [S2,MB7,F]  421-10-432ms   | [S2,MB2,BI] 433-11-445ms   | [S2,MB2,BW] 445-10-455ms   | [S5,MB6,F]  455-7-463ms    | [S5,MB4,BI] 477-11-488ms   | [S5,MB4,BW] 489-9-499ms    | [S2,MB3,BI] 545-9-554ms    | [S2,MB3,BW] 554-10-565ms   | [S5,MB7,F]  569-7-576ms    | [S5,MB5,BI] 576-9-586ms    | [S5,MB5,BW] 586-9-596ms    | [S2,MB4,BI] 626-9-635ms    | [S5,MB6,BI] 640-10-650ms   | [S2,MB5,BI] 651-10-661ms   | [S5,MB7,BI] 709-9-718ms    | [S2,MB6,BI] 718-10-728ms   | [S2,MB4,BW] 728-7-735ms    | [S2,MB7,BI] 743-9-752ms    | [S2,MB5,BW] 753-0-753ms    | [S5,MB6,BW] 753-10-763ms   | [S5,MB7,BW] 763-9-773ms    | [S2,MB6,BW] 773-7-780ms    | [S2,MB7,BW] 780-0-780ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 191-8-200ms    | [S4,MB0,BW] 200-9-209ms    | [S3,MB4,F]  209-7-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-9-234ms    | [S4,MB4,F]  234-7-242ms    | [S4,MB1,BI] 275-10-286ms   | [S4,MB1,BW] 286-10-296ms   | [S3,MB5,F]  296-8-304ms    | [S3,MB1,BI] 304-9-314ms    | [S3,MB1,BW] 314-9-323ms    | [S4,MB5,F]  323-7-331ms    | [S4,MB2,BI] 358-11-369ms   | [S4,MB2,BW] 369-9-379ms    | [S3,MB6,F]  379-7-386ms    | [S3,MB2,BI] 386-9-396ms    | [S3,MB2,BW] 396-9-406ms    | [S4,MB6,F]  406-8-414ms    | [S4,MB3,BI] 426-12-439ms   | [S4,MB3,BW] 439-9-448ms    | [S3,MB7,F]  448-7-456ms    | [S3,MB3,BI] 456-9-465ms    | [S3,MB3,BW] 465-10-476ms   | [S4,MB7,F]  476-8-484ms    | [S4,MB4,BI] 538-10-548ms   | [S4,MB4,BW] 549-9-558ms    | [S3,MB4,BI] 558-10-569ms   | [S4,MB5,BI] 619-10-629ms   | [S3,MB5,BI] 629-9-638ms    | [S4,MB6,BI] 651-9-660ms    | [S3,MB6,BI] 660-9-669ms    | [S4,MB7,BI] 719-9-728ms    | [S3,MB7,BI] 728-9-737ms    | [S3,MB4,BW] 737-0-737ms    | [S4,MB5,BW] 737-10-747ms   | [S4,MB6,BW] 747-9-756ms    | [S4,MB7,BW] 756-9-766ms    | [S3,MB5,BW] 766-7-774ms    | [S3,MB6,BW] 774-0-774ms    | [S3,MB7,BW] 774-0-774ms   
[rank3]:2025-12-28 00:00:19,068 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_0000_stage3_step600.svg
[rank0]:2025-12-28 00:00:18,992 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank0_stage7.svg
[rank0]:	> Counts Sum: 138120, Total Sum: 183040 (75.46%), Ratio(%) per element: [80.76, 80.52, 81.25, 80.28, 81.73, 81.73, 80.76, 66.34, 66.1, 65.14, 65.38]
[rank3]:2025-12-28 00:00:19,110 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_0000_stage4_step600.svg
[rank3]:2025-12-28 00:00:19,209 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank3_stage3.svg
[rank3]:	> Counts Sum: 118760, Total Sum: 299520 (39.65%), Ratio(%) per element: [41.58, 41.1, 40.86, 41.34, 40.86, 40.62, 40.14, 34.85, 34.61, 40.86, 42.06, 41.82, 41.82, 41.58, 40.38, 39.9, 35.33, 33.89]
[rank3]:2025-12-28 00:00:19,308 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0000_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 299520 (3.85%), Ratio(%) per element: [3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84]
[rank2]:2025-12-28 00:00:19,666 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage2.svg
[rank1]:2025-12-28 00:00:19,708 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage1.svg
[rank0]:2025-12-28 00:00:19,702 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage0.svg
[rank3]:2025-12-28 00:00:20,014 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage3.svg
[rank2]:2025-12-28 00:00:20,341 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage5.svg
[rank1]:2025-12-28 00:00:20,373 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage6.svg
[rank0]:2025-12-28 00:00:20,412 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage7.svg
[rank3]:2025-12-28 00:00:20,666 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0000_stage4.svg
[rank0]:2025-12-28 00:03:03,483 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-28 00:03:07,271 - Avg. fwd time: 8.0816 / Avg. bwd-weight time: 8.4714 / Avg. bwd-input time: 10.0974 / Avg. batch time: 810.0114 (ms) / GPU bubble ratio: 47.36%
[rank0]:2025-12-28 00:03:07,276 - Avg. fwd time: 12.5742 / Avg. full-bwd time: 10.0145 (Avg. bwd-weight time: 10.9001 / Avg. bwd-input time: 33.3800) / Avg. batch time: 848.5724 (ms) / GPU bubble ratio: 25.10%
[rank3]:2025-12-28 00:03:07,269 - Avg. fwd time: 7.7964 / Avg. bwd-weight time: 7.8400 / Avg. bwd-input time: 9.8195 / Avg. batch time: 795.6650 (ms) / GPU bubble ratio: 48.81%
[rank1]:2025-12-28 00:03:07,273 - Avg. fwd time: 9.8223 / Avg. bwd-weight time: 7.4880 / Avg. bwd-input time: 12.7227 / Avg. batch time: 829.6811 (ms) / GPU bubble ratio: 42.08%
[rank2]:2025-12-28 00:03:07,322 -  step: 650  loss: -4.0000  grad_norm:  0.1229  memory: 14.74GiB(31.02%)  tps: 9,716  tflops: 75.96  mfu: 24.34%
[rank0]:2025-12-28 00:03:07,347 -  step: 650  loss:  0.2328  grad_norm:  0.1229  memory: 41.50GiB(87.35%)  tps: 9,715  tflops: 75.95  mfu: 24.34%
[rank3]:2025-12-28 00:03:07,322 -  step: 650  loss: -4.0000  grad_norm:  0.1229  memory: 16.16GiB(34.02%)  tps: 9,716  tflops: 75.96  mfu: 24.34%
[rank1]:2025-12-28 00:03:07,323 -  step: 650  loss: -4.0000  grad_norm:  0.1229  memory: 18.98GiB(39.95%)  tps: 9,716  tflops: 75.96  mfu: 24.35%
[rank0]:2025-12-28 00:05:50,243 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-28 00:05:54,042 - Avg. fwd time: 9.8200 / Avg. bwd-weight time: 7.4240 / Avg. bwd-input time: 12.7316 / Avg. batch time: 825.7398 (ms) / GPU bubble ratio: 41.92%
[rank1]:2025-12-28 00:05:54,096 -  step: 700  loss: -4.0000  grad_norm:  0.1509  memory: 18.98GiB(39.95%)  tps: 9,824  tflops: 76.80  mfu: 24.62%
[rank3]:2025-12-28 00:05:54,036 - Avg. fwd time: 7.7992 / Avg. bwd-weight time: 7.8369 / Avg. bwd-input time: 9.8260 / Avg. batch time: 791.9684 (ms) / GPU bubble ratio: 48.56%
[rank3]:2025-12-28 00:05:54,096 -  step: 700  loss: -4.0000  grad_norm:  0.1509  memory: 16.16GiB(34.02%)  tps: 9,824  tflops: 76.80  mfu: 24.62%
[rank2]:2025-12-28 00:05:54,041 - Avg. fwd time: 8.0855 / Avg. bwd-weight time: 8.4769 / Avg. bwd-input time: 10.1031 / Avg. batch time: 806.3282 (ms) / GPU bubble ratio: 47.09%
[rank2]:2025-12-28 00:05:54,096 -  step: 700  loss: -4.0000  grad_norm:  0.1509  memory: 14.74GiB(31.02%)  tps: 9,824  tflops: 76.80  mfu: 24.62%
[rank0]:2025-12-28 00:05:54,051 - Avg. fwd time: 12.5617 / Avg. full-bwd time: 9.7491 (Avg. bwd-weight time: 10.5697 / Avg. bwd-input time: 33.3688) / Avg. batch time: 844.6961 (ms) / GPU bubble ratio: 25.36%
[rank1]:2025-12-28 00:05:54,177 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_0005_stage1_step700.svg
[rank2]:2025-12-28 00:05:54,175 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_0005_stage2_step700.svg
[rank0]:2025-12-28 00:05:54,122 -  step: 700  loss:  0.1928  grad_norm:  0.1509  memory: 41.50GiB(87.35%)  tps: 9,824  tflops: 76.80  mfu: 24.62%
[rank0]:2025-12-28 00:05:54,178 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_0005_stage0_step700.svg
[rank1]:2025-12-28 00:05:54,222 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_0005_stage6_step700.svg
[rank2]:2025-12-28 00:05:54,218 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_0005_stage5_step700.svg
[rank0]:2025-12-28 00:05:54,222 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_0005_stage7_step700.svg
[rank1]:2025-12-28 00:05:54,355 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank1_stage1.svg
[rank1]:	> Counts Sum: 395800, Total Sum: 535680 (73.89%), Ratio(%) per element: [83.46, 83.87, 83.66, 82.66, 82.86, 82.45, 81.85, 44.95, 41.33, 82.25, 82.25, 83.46, 83.66, 83.06, 83.06, 82.05, 44.75, 42.13, 83.46, 82.66, 80.44, 82.45, 81.04, 82.66, 82.66, 42.74, 42.94]
[rank2]:2025-12-28 00:05:54,316 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank2_stage2.svg
[rank2]:	> Counts Sum: 111840, Total Sum: 357120 (31.32%), Ratio(%) per element: [33.87, 34.27, 33.66, 32.66, 33.87, 32.45, 32.45, 24.79, 24.39, 31.45, 32.45, 33.46, 33.87, 34.07, 33.66, 33.26, 24.19, 24.79]
[rank0]:2025-12-28 00:05:54,327 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank0_stage0.svg
[rank0]:	> Counts Sum: 290200, Total Sum: 376960 (76.98%), Ratio(%) per element: [83.06, 81.65, 80.84, 82.86, 82.66, 82.05, 83.87, 83.46, 56.85, 55.44, 82.86, 81.04, 83.06, 82.05, 82.66, 81.45, 81.85, 56.45, 58.46]
[rank0]:2025-12-28 00:05:54,408 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank0_stage7.svg
[rank0]:	> Counts Sum: 166120, Total Sum: 218240 (76.12%), Ratio(%) per element: [81.45, 80.84, 81.45, 80.04, 81.85, 81.85, 80.84, 67.74, 67.54, 66.73, 66.93]
[rank1]:2025-12-28 00:05:54,455 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 357120 (3.23%), Ratio(%) per element: [3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22]
[rank3]:2025-12-28 00:05:54,437 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251228_0005_step700_rank3.svg
[rank3]:			> Batch Time: 790.20 ms, GPU Bubble Ratio: 28.46%, 40.66%, 45.57%, 48.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-21-192ms   | [S7,MB1,F]  193-16-209ms   | [S7,MB1,BI] 221-33-254ms   | [S7,MB1,BW] 254-0-254ms    | [S7,MB2,F]  254-17-272ms   | [S7,MB2,BI] 283-33-317ms   | [S7,MB2,BW] 318-0-318ms    | [S7,MB3,F]  318-17-335ms   | [S7,MB3,BI] 346-34-381ms   | [S7,MB3,BW] 381-0-381ms    | [S0,MB7,F]  381-9-390ms    | [S0,MB0,B]  390-0-390ms    | [S7,MB4,F]  398-17-416ms   | [S7,MB4,BI] 427-32-460ms   | [S7,MB4,BW] 460-0-460ms    | [S0,MB1,B]  467-0-467ms    | [S7,MB5,F]  471-14-486ms   | [S7,MB5,BI] 497-32-530ms   | [S7,MB5,BW] 530-0-530ms    | [S0,MB2,B]  537-0-537ms    | [S7,MB6,F]  551-14-566ms   | [S7,MB6,BI] 579-32-611ms   | [S7,MB6,BW] 612-0-612ms    | [S0,MB3,B]  618-0-618ms    | [S7,MB7,F]  633-14-647ms   | [S7,MB7,BI] 660-32-692ms   | [S7,MB7,BW] 692-28-720ms   | [S0,MB4,B]  720-0-720ms    | [S0,MB5,B]  725-20-746ms   | [S0,MB6,B]  753-19-772ms   | [S0,MB7,B]  777-12-790ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-93ms     | [S6,MB0,F]  93-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 172-9-182ms    | [S6,MB0,BW] 182-10-192ms   | [S6,MB2,F]  192-7-199ms    | [S6,MB1,BI] 254-9-263ms    | [S6,MB1,BW] 264-10-274ms   | [S6,MB3,F]  274-7-281ms    | [S6,MB2,BI] 318-9-327ms    | [S6,MB2,BW] 327-10-338ms   | [S1,MB6,F]  338-11-349ms   | [S1,MB0,BI] 349-15-365ms   | [S1,MB0,BW] 365-0-365ms    | [S6,MB4,F]  365-8-373ms    | [S6,MB3,BI] 381-12-393ms   | [S6,MB3,BW] 393-11-405ms   | [S1,MB7,F]  405-11-416ms   | [S1,MB1,BI] 416-16-433ms   | [S1,MB1,BW] 433-0-433ms    | [S6,MB5,F]  433-8-442ms    | [S6,MB4,BI] 460-12-473ms   | [S6,MB4,BW] 473-10-484ms   | [S1,MB2,BI] 483-14-498ms   | [S1,MB2,BW] 498-8-507ms    | [S6,MB6,F]  537-7-544ms    | [S6,MB5,BI] 544-10-554ms   | [S6,MB5,BW] 554-10-565ms   | [S1,MB3,BI] 565-14-580ms   | [S1,MB3,BW] 580-8-589ms    | [S6,MB7,F]  618-7-626ms    | [S6,MB6,BI] 626-10-636ms   | [S6,MB6,BW] 636-10-647ms   | [S1,MB4,BI] 647-14-662ms   | [S6,MB7,BI] 692-10-703ms   | [S1,MB5,BI] 703-15-718ms   | [S1,MB4,BW] 718-1-719ms    | [S1,MB6,BI] 731-14-746ms   | [S1,MB5,BW] 746-0-746ms    | [S1,MB7,BI] 756-14-770ms   | [S1,MB6,BW] 770-0-770ms    | [S6,MB7,BW] 770-10-781ms   | [S1,MB7,BW] 781-0-781ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  37-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-8-81ms      | [S5,MB1,F]  81-7-89ms      | [S2,MB4,F]  93-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 182-9-191ms    | [S5,MB0,BW] 191-10-201ms   | [S5,MB3,F]  201-7-208ms    | [S5,MB1,BI] 264-9-273ms    | [S5,MB1,BW] 273-10-284ms   | [S2,MB5,F]  284-7-291ms    | [S2,MB0,BI] 291-10-301ms   | [S2,MB0,BW] 301-9-311ms    | [S5,MB4,F]  311-7-319ms    | [S5,MB2,BI] 327-10-338ms   | [S5,MB2,BW] 338-10-348ms   | [S2,MB6,F]  350-10-360ms   | [S2,MB1,BI] 362-11-373ms   | [S2,MB1,BW] 373-9-383ms    | [S5,MB5,F]  383-7-391ms    | [S5,MB3,BI] 395-10-406ms   | [S5,MB3,BW] 406-10-416ms   | [S2,MB7,F]  417-10-428ms   | [S2,MB2,BI] 429-11-440ms   | [S2,MB2,BW] 440-10-451ms   | [S5,MB6,F]  451-7-459ms    | [S5,MB4,BI] 473-11-484ms   | [S5,MB4,BW] 484-9-494ms    | [S2,MB3,BI] 540-9-549ms    | [S2,MB3,BW] 549-10-560ms   | [S5,MB7,F]  564-7-572ms    | [S5,MB5,BI] 571-9-581ms    | [S5,MB5,BW] 581-9-591ms    | [S2,MB4,BI] 621-9-631ms    | [S5,MB6,BI] 636-10-646ms   | [S2,MB5,BI] 646-10-657ms   | [S5,MB7,BI] 705-9-714ms    | [S2,MB6,BI] 714-10-725ms   | [S2,MB4,BW] 724-7-732ms    | [S2,MB7,BI] 739-9-749ms    | [S2,MB5,BW] 749-0-749ms    | [S5,MB6,BW] 749-10-759ms   | [S5,MB7,BW] 759-9-769ms    | [S2,MB6,BW] 769-7-777ms    | [S2,MB7,BW] 776-0-776ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 191-9-200ms    | [S4,MB0,BW] 200-9-210ms    | [S3,MB4,F]  209-6-216ms    | [S3,MB0,BI] 216-9-226ms    | [S3,MB0,BW] 226-9-235ms    | [S4,MB4,F]  235-7-243ms    | [S4,MB1,BI] 273-10-284ms   | [S4,MB1,BW] 284-10-294ms   | [S3,MB5,F]  294-8-302ms    | [S3,MB1,BI] 302-9-312ms    | [S3,MB1,BW] 312-9-321ms    | [S4,MB5,F]  321-7-329ms    | [S4,MB2,BI] 355-11-366ms   | [S4,MB2,BW] 366-9-376ms    | [S3,MB6,F]  376-7-383ms    | [S3,MB2,BI] 383-9-393ms    | [S3,MB2,BW] 393-9-403ms    | [S4,MB6,F]  403-8-411ms    | [S4,MB3,BI] 422-12-434ms   | [S4,MB3,BW] 434-9-444ms    | [S3,MB7,F]  444-7-452ms    | [S3,MB3,BI] 451-9-461ms    | [S3,MB3,BW] 461-10-472ms   | [S4,MB7,F]  472-8-480ms    | [S4,MB4,BI] 533-10-544ms   | [S4,MB4,BW] 543-9-553ms    | [S3,MB4,BI] 553-10-563ms   | [S4,MB5,BI] 615-10-625ms   | [S3,MB5,BI] 625-9-634ms    | [S4,MB6,BI] 647-9-656ms    | [S3,MB6,BI] 656-9-665ms    | [S4,MB7,BI] 715-9-724ms    | [S3,MB7,BI] 724-9-733ms    | [S3,MB4,BW] 733-0-733ms    | [S4,MB5,BW] 733-10-743ms   | [S4,MB6,BW] 743-9-752ms    | [S4,MB7,BW] 752-9-762ms    | [S3,MB5,BW] 762-7-770ms    | [S3,MB6,BW] 770-0-770ms    | [S3,MB7,BW] 770-0-770ms   
[rank3]:2025-12-28 00:05:54,483 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_0005_stage3_step700.svg
[rank2]:2025-12-28 00:05:54,412 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 357120 (3.23%), Ratio(%) per element: [3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22]
[rank3]:2025-12-28 00:05:54,527 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_0005_stage4_step700.svg
[rank3]:2025-12-28 00:05:54,625 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank3_stage3.svg
[rank3]:	> Counts Sum: 141560, Total Sum: 357120 (39.64%), Ratio(%) per element: [41.53, 41.12, 40.92, 40.92, 40.72, 40.52, 39.91, 35.28, 35.08, 41.12, 41.33, 41.73, 41.33, 41.33, 40.52, 39.91, 35.68, 34.47]
[rank3]:2025-12-28 00:05:54,724 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0005_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 357120 (3.23%), Ratio(%) per element: [3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22, 3.22]
[rank1]:2025-12-28 00:05:55,262 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage1.svg
[rank0]:2025-12-28 00:05:55,249 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage0.svg
[rank2]:2025-12-28 00:05:55,211 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage2.svg
[rank3]:2025-12-28 00:05:55,539 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage3.svg
[rank2]:2025-12-28 00:05:55,989 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage5.svg
[rank1]:2025-12-28 00:05:56,051 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage6.svg
[rank0]:2025-12-28 00:05:56,081 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage7.svg
[rank3]:2025-12-28 00:05:56,325 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0005_stage4.svg
[rank0]:2025-12-28 00:08:38,377 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-28 00:08:42,151 - Avg. fwd time: 7.8016 / Avg. bwd-weight time: 7.8303 / Avg. bwd-input time: 9.8310 / Avg. batch time: 788.6621 (ms) / GPU bubble ratio: 48.34%
[rank3]:2025-12-28 00:08:42,201 -  step: 750  loss: -4.0000  grad_norm:  0.2120  memory: 16.16GiB(34.02%)  tps: 9,746  tflops: 76.19  mfu: 24.42%
[rank1]:2025-12-28 00:08:42,155 - Avg. fwd time: 9.8184 / Avg. bwd-weight time: 7.3692 / Avg. bwd-input time: 12.7396 / Avg. batch time: 822.3456 (ms) / GPU bubble ratio: 41.77%
[rank1]:2025-12-28 00:08:42,202 -  step: 750  loss: -4.0000  grad_norm:  0.2120  memory: 18.98GiB(39.95%)  tps: 9,746  tflops: 76.19  mfu: 24.42%
[rank0]:2025-12-28 00:08:42,156 - Avg. fwd time: 12.5516 / Avg. full-bwd time: 9.4735 (Avg. bwd-weight time: 10.2821 / Avg. bwd-input time: 33.3556) / Avg. batch time: 841.2415 (ms) / GPU bubble ratio: 25.62%
[rank2]:2025-12-28 00:08:42,154 - Avg. fwd time: 8.0886 / Avg. bwd-weight time: 8.4769 / Avg. bwd-input time: 10.1078 / Avg. batch time: 803.1683 (ms) / GPU bubble ratio: 46.86%
[rank2]:2025-12-28 00:08:42,201 -  step: 750  loss: -4.0000  grad_norm:  0.2120  memory: 14.74GiB(31.02%)  tps: 9,746  tflops: 76.19  mfu: 24.42%
[rank0]:2025-12-28 00:08:42,225 -  step: 750  loss:  0.2347  grad_norm:  0.2120  memory: 41.50GiB(87.35%)  tps: 9,746  tflops: 76.19  mfu: 24.42%
[rank0]:2025-12-28 00:11:25,430 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 00:11:29,295 - Avg. fwd time: 7.8025 / Avg. bwd-weight time: 7.8271 / Avg. bwd-input time: 9.8352 / Avg. batch time: 785.9867 (ms) / GPU bubble ratio: 48.16%
[rank0]:2025-12-28 00:11:29,305 - Avg. fwd time: 12.5445 / Avg. full-bwd time: 9.2512 (Avg. bwd-weight time: 10.0431 / Avg. bwd-input time: 33.3497) / Avg. batch time: 838.3442 (ms) / GPU bubble ratio: 25.82%
[rank1]:2025-12-28 00:11:29,299 - Avg. fwd time: 9.8170 / Avg. bwd-weight time: 7.3268 / Avg. bwd-input time: 12.7466 / Avg. batch time: 819.4847 (ms) / GPU bubble ratio: 41.64%
[rank2]:2025-12-28 00:11:29,299 - Avg. fwd time: 8.0912 / Avg. bwd-weight time: 8.4803 / Avg. bwd-input time: 10.1114 / Avg. batch time: 800.5468 (ms) / GPU bubble ratio: 46.67%
[rank3]:2025-12-28 00:11:29,350 -  step: 800  loss: -4.0000  grad_norm:  0.1691  memory: 16.16GiB(34.02%)  tps: 9,802  tflops: 76.63  mfu: 24.56%
[rank3]:2025-12-28 00:11:29,351 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1691  tps: 9,865  tflops: 77.12  mfu: 22.57%
[rank3]:2025-12-28 00:11:29,351 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 00:11:29,351 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 00:11:29,374 -  step: 800  loss:  0.2394  grad_norm:  0.1691  memory: 41.50GiB(87.35%)  tps: 9,802  tflops: 76.63  mfu: 24.56%
[rank0]:2025-12-28 00:11:29,375 - â„¹ï¸ final step: 800  loss:  0.2394  grad_norm:  0.1691  tps: 9,872  tflops: 77.17  mfu: 22.66%
[rank0]:2025-12-28 00:11:29,375 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 00:11:29,376 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 00:11:29,352 -  step: 800  loss: -4.0000  grad_norm:  0.1691  memory: 18.98GiB(39.95%)  tps: 9,802  tflops: 76.63  mfu: 24.56%
[rank1]:2025-12-28 00:11:29,352 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1691  tps: 9,866  tflops: 77.12  mfu: 22.57%
[rank1]:2025-12-28 00:11:29,352 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 00:11:29,353 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-28 00:11:29,351 -  step: 800  loss: -4.0000  grad_norm:  0.1691  memory: 14.74GiB(31.02%)  tps: 9,802  tflops: 76.63  mfu: 24.56%
[rank2]:2025-12-28 00:11:29,351 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1691  tps: 9,865  tflops: 77.12  mfu: 22.56%
[rank2]:2025-12-28 00:11:29,351 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 00:11:29,351 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 00:11:32,013 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-28 00:11:32,091 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_0011_stage0_final800.svg
[rank1]:2025-12-28 00:11:32,091 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_0011_stage1_final800.svg
[rank1]:2025-12-28 00:11:32,138 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_0011_stage6_final800.svg
[rank2]:2025-12-28 00:11:32,093 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_0011_stage2_final800.svg
[rank2]:2025-12-28 00:11:32,138 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_0011_stage5_final800.svg
[rank0]:2025-12-28 00:11:32,137 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_0011_stage7_final800.svg
[rank2]:2025-12-28 00:11:32,235 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank2_stage2.svg
[rank2]:	> Counts Sum: 129440, Total Sum: 414720 (31.21%), Ratio(%) per element: [33.15, 33.68, 33.68, 32.29, 33.15, 32.63, 32.63, 24.82, 24.47, 32.81, 32.46, 32.98, 33.5, 33.85, 33.15, 33.15, 24.47, 24.82]
[rank0]:2025-12-28 00:11:32,243 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank0_stage0.svg
[rank0]:	> Counts Sum: 339000, Total Sum: 437760 (77.44%), Ratio(%) per element: [83.85, 82.11, 81.94, 82.63, 82.81, 82.46, 83.33, 84.2, 57.81, 56.42, 83.33, 81.25, 83.33, 81.59, 82.63, 82.29, 82.98, 57.29, 59.02]
[rank0]:2025-12-28 00:11:32,325 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank0_stage7.svg
[rank0]:	> Counts Sum: 194120, Total Sum: 253440 (76.59%), Ratio(%) per element: [81.77, 80.9, 81.77, 80.2, 81.94, 81.94, 80.72, 68.75, 68.57, 67.88, 68.05]
[rank1]:2025-12-28 00:11:32,266 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank1_stage1.svg
[rank1]:	> Counts Sum: 462200, Total Sum: 622080 (74.30%), Ratio(%) per element: [84.37, 83.5, 84.02, 83.15, 83.15, 82.81, 82.63, 45.65, 41.84, 82.98, 82.81, 83.15, 83.5, 83.33, 83.15, 82.63, 45.48, 42.18, 83.5, 83.15, 80.55, 83.5, 81.94, 82.81, 83.15, 43.4, 43.57]
[rank2]:2025-12-28 00:11:32,330 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank2_stage5.svg
[rank2]:	> Counts Sum: 11520, Total Sum: 414720 (2.78%), Ratio(%) per element: [2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77]
[rank3]:2025-12-28 00:11:32,359 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251228_0011_final800_rank3.svg
[rank3]:			> Batch Time: 795.59 ms, GPU Bubble Ratio: 28.70%, 40.99%, 46.13%, 48.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  110-16-127ms   | [S7,MB0,BI] 139-32-171ms   | [S7,MB0,BW] 171-22-194ms   | [S7,MB1,F]  194-15-210ms   | [S7,MB1,BI] 222-33-255ms   | [S7,MB1,BW] 255-0-255ms    | [S7,MB2,F]  256-17-273ms   | [S7,MB2,BI] 285-34-319ms   | [S7,MB2,BW] 319-0-319ms    | [S7,MB3,F]  320-17-337ms   | [S7,MB3,BI] 349-34-384ms   | [S7,MB3,BW] 384-0-384ms    | [S0,MB7,F]  384-9-393ms    | [S0,MB0,B]  394-0-394ms    | [S7,MB4,F]  401-17-419ms   | [S7,MB4,BI] 431-33-464ms   | [S7,MB4,BW] 464-0-464ms    | [S0,MB1,B]  471-0-471ms    | [S7,MB5,F]  475-16-492ms   | [S7,MB5,BI] 503-32-536ms   | [S7,MB5,BW] 536-0-536ms    | [S0,MB2,B]  543-0-543ms    | [S7,MB6,F]  557-14-572ms   | [S7,MB6,BI] 584-32-616ms   | [S7,MB6,BW] 616-0-616ms    | [S0,MB3,B]  623-0-623ms    | [S7,MB7,F]  637-14-652ms   | [S7,MB7,BI] 664-32-696ms   | [S7,MB7,BW] 696-28-725ms   | [S0,MB4,B]  724-0-724ms    | [S0,MB5,B]  729-16-746ms   | [S0,MB6,B]  757-18-776ms   | [S0,MB7,B]  781-14-795ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  44-11-55ms     | [S1,MB3,F]  61-11-72ms     | [S1,MB4,F]  82-11-94ms     | [S6,MB0,F]  94-9-103ms     | [S1,MB5,F]  103-12-116ms   | [S6,MB1,F]  116-8-125ms    | [S6,MB0,BI] 172-9-182ms    | [S6,MB0,BW] 182-10-192ms   | [S6,MB2,F]  192-7-199ms    | [S6,MB1,BI] 255-9-265ms    | [S6,MB1,BW] 265-10-275ms   | [S6,MB3,F]  275-7-283ms    | [S6,MB2,BI] 319-9-329ms    | [S6,MB2,BW] 329-10-340ms   | [S1,MB6,F]  340-11-351ms   | [S1,MB0,BI] 351-15-367ms   | [S1,MB0,BW] 367-0-367ms    | [S6,MB4,F]  367-7-375ms    | [S6,MB3,BI] 383-12-396ms   | [S6,MB3,BW] 396-11-408ms   | [S1,MB7,F]  408-11-419ms   | [S1,MB1,BI] 419-16-436ms   | [S1,MB1,BW] 436-0-436ms    | [S6,MB5,F]  436-8-445ms    | [S6,MB4,BI] 464-12-477ms   | [S6,MB4,BW] 477-10-488ms   | [S1,MB2,BI] 488-14-502ms   | [S1,MB2,BW] 502-9-512ms    | [S6,MB6,F]  542-7-550ms    | [S6,MB5,BI] 550-10-560ms   | [S6,MB5,BW] 560-10-571ms   | [S1,MB3,BI] 571-14-585ms   | [S1,MB3,BW] 586-8-594ms    | [S6,MB7,F]  623-7-630ms    | [S6,MB6,BI] 630-10-641ms   | [S6,MB6,BW] 641-10-652ms   | [S1,MB4,BI] 651-14-666ms   | [S6,MB7,BI] 696-10-707ms   | [S1,MB5,BI] 707-15-722ms   | [S1,MB4,BW] 722-2-725ms    | [S1,MB6,BI] 735-14-750ms   | [S1,MB5,BW] 750-0-751ms    | [S1,MB7,BI] 760-14-774ms   | [S1,MB6,BW] 774-0-774ms    | [S6,MB7,BW] 774-10-785ms   | [S1,MB7,BW] 785-0-785ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-8-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  94-8-102ms     | [S5,MB2,F]  111-8-119ms    | [S5,MB0,BI] 182-9-191ms    | [S5,MB0,BW] 191-10-201ms   | [S5,MB3,F]  201-7-208ms    | [S5,MB1,BI] 265-9-274ms    | [S5,MB1,BW] 274-10-285ms   | [S2,MB5,F]  285-7-292ms    | [S2,MB0,BI] 292-10-303ms   | [S2,MB0,BW] 303-9-312ms    | [S5,MB4,F]  312-7-320ms    | [S5,MB2,BI] 329-10-340ms   | [S5,MB2,BW] 340-10-350ms   | [S2,MB6,F]  352-10-362ms   | [S2,MB1,BI] 364-10-375ms   | [S2,MB1,BW] 375-9-384ms    | [S5,MB5,F]  385-7-392ms    | [S5,MB3,BI] 399-10-409ms   | [S5,MB3,BW] 410-10-420ms   | [S2,MB7,F]  421-10-431ms   | [S2,MB2,BI] 432-11-444ms   | [S2,MB2,BW] 444-10-454ms   | [S5,MB6,F]  454-7-462ms    | [S5,MB4,BI] 477-11-488ms   | [S5,MB4,BW] 488-9-498ms    | [S2,MB3,BI] 546-9-555ms    | [S2,MB3,BW] 556-10-566ms   | [S5,MB7,F]  570-7-577ms    | [S5,MB5,BI] 577-9-587ms    | [S5,MB5,BW] 587-9-597ms    | [S2,MB4,BI] 626-9-636ms    | [S5,MB6,BI] 641-10-651ms   | [S2,MB5,BI] 651-10-661ms   | [S5,MB7,BI] 710-9-719ms    | [S2,MB6,BI] 719-10-729ms   | [S2,MB4,BW] 729-7-736ms    | [S2,MB7,BI] 744-9-753ms    | [S2,MB5,BW] 754-0-754ms    | [S5,MB6,BW] 754-10-764ms   | [S5,MB7,BW] 764-9-773ms    | [S2,MB6,BW] 773-8-781ms    | [S2,MB7,BW] 781-0-781ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-7-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-8-79ms      | [S3,MB3,F]  94-7-101ms     | [S4,MB3,F]  101-8-110ms    | [S4,MB0,BI] 191-8-200ms    | [S4,MB0,BW] 200-9-209ms    | [S3,MB4,F]  209-6-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-9-235ms    | [S4,MB4,F]  235-7-242ms    | [S4,MB1,BI] 274-10-285ms   | [S4,MB1,BW] 285-10-295ms   | [S3,MB5,F]  295-8-303ms    | [S3,MB1,BI] 303-9-313ms    | [S3,MB1,BW] 313-9-322ms    | [S4,MB5,F]  323-7-330ms    | [S4,MB2,BI] 356-11-368ms   | [S4,MB2,BW] 368-9-378ms    | [S3,MB6,F]  378-7-385ms    | [S3,MB2,BI] 385-9-395ms    | [S3,MB2,BW] 395-9-405ms    | [S4,MB6,F]  405-8-413ms    | [S4,MB3,BI] 425-12-438ms   | [S4,MB3,BW] 438-9-447ms    | [S3,MB7,F]  447-7-455ms    | [S3,MB3,BI] 455-9-464ms    | [S3,MB3,BW] 464-10-475ms   | [S4,MB7,F]  475-8-483ms    | [S4,MB4,BI] 539-10-549ms   | [S4,MB4,BW] 550-9-559ms    | [S3,MB4,BI] 559-10-570ms   | [S4,MB5,BI] 619-10-629ms   | [S3,MB5,BI] 629-9-638ms    | [S4,MB6,BI] 652-9-661ms    | [S3,MB6,BI] 661-9-670ms    | [S4,MB7,BI] 719-9-728ms    | [S3,MB7,BI] 728-9-737ms    | [S3,MB4,BW] 737-0-737ms    | [S4,MB5,BW] 737-10-747ms   | [S4,MB6,BW] 748-9-757ms    | [S4,MB7,BW] 757-9-766ms    | [S3,MB5,BW] 766-7-774ms    | [S3,MB6,BW] 774-0-774ms    | [S3,MB7,BW] 774-0-774ms   
[rank1]:2025-12-28 00:11:32,368 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank1_stage6.svg
[rank1]:	> Counts Sum: 11520, Total Sum: 414720 (2.78%), Ratio(%) per element: [2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77]
[rank3]:2025-12-28 00:11:32,686 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/pipeline_schedule/251228_0011_thry_final800_rank3.svg
[rank3]:			> Batch Time: 458.49 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-28ms      | [S0,MB3,F]  28-9-38ms      | [S0,MB4,F]  38-9-47ms      | [S0,MB5,F]  47-9-57ms      | [S0,MB6,F]  57-9-66ms      | [S7,MB0,F]  66-9-76ms      | [S7,MB0,BI] 76-9-85ms      | [S7,MB0,BW] 85-9-95ms      | [S7,MB1,F]  95-9-105ms     | [S7,MB1,BI] 105-9-114ms    | [S7,MB1,BW] 114-9-124ms    | [S7,MB2,F]  124-9-133ms    | [S7,MB2,BI] 133-9-143ms    | [S7,MB2,BW] 143-9-152ms    | [S7,MB3,F]  152-9-162ms    | [S7,MB3,BI] 162-9-171ms    | [S7,MB3,BW] 171-9-181ms    | [S0,MB7,F]  181-9-191ms    | [S0,MB0,B]  191-19-210ms   | [S7,MB4,F]  210-9-219ms    | [S7,MB4,BI] 219-9-229ms    | [S7,MB4,BW] 229-9-238ms    | [S0,MB1,B]  238-19-257ms   | [S7,MB5,F]  257-9-267ms    | [S7,MB5,BI] 267-9-277ms    | [S7,MB5,BW] 277-9-286ms    | [S0,MB2,B]  286-19-305ms   | [S7,MB6,F]  305-9-315ms    | [S7,MB6,BI] 315-9-324ms    | [S7,MB6,BW] 324-9-334ms    | [S0,MB3,B]  334-19-353ms   | [S7,MB7,F]  353-9-362ms    | [S7,MB7,BI] 362-9-372ms    | [S7,MB7,BW] 372-9-382ms    | [S0,MB4,B]  382-19-401ms   | [S0,MB5,B]  401-19-420ms   | [S0,MB6,B]  420-19-439ms   | [S0,MB7,B]  439-19-458ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-28ms      | [S1,MB2,F]  28-9-38ms      | [S1,MB3,F]  38-9-47ms      | [S1,MB4,F]  47-9-57ms      | [S6,MB0,F]  57-9-66ms      | [S1,MB5,F]  66-9-76ms      | [S6,MB1,F]  76-9-85ms      | [S6,MB0,BI] 85-9-95ms      | [S6,MB0,BW] 95-9-105ms     | [S6,MB2,F]  105-9-114ms    | [S6,MB1,BI] 114-9-124ms    | [S6,MB1,BW] 124-9-133ms    | [S6,MB3,F]  133-9-143ms    | [S6,MB2,BI] 143-9-152ms    | [S6,MB2,BW] 152-9-162ms    | [S1,MB6,F]  162-9-171ms    | [S1,MB0,BI] 171-9-181ms    | [S1,MB0,BW] 181-9-191ms    | [S6,MB4,F]  191-9-200ms    | [S6,MB3,BI] 200-9-210ms    | [S6,MB3,BW] 210-9-219ms    | [S1,MB7,F]  219-9-229ms    | [S1,MB1,BI] 229-9-238ms    | [S1,MB1,BW] 238-9-248ms    | [S6,MB5,F]  248-9-257ms    | [S6,MB4,BI] 257-9-267ms    | [S6,MB4,BW] 267-9-277ms    | [S1,MB2,BI] 277-9-286ms    | [S1,MB2,BW] 286-9-296ms    | [S6,MB6,F]  296-9-305ms    | [S6,MB5,BI] 305-9-315ms    | [S6,MB5,BW] 315-9-324ms    | [S1,MB3,BI] 324-9-334ms    | [S1,MB3,BW] 334-9-343ms    | [S6,MB7,F]  343-9-353ms    | [S6,MB6,BI] 353-9-362ms    | [S6,MB6,BW] 362-9-372ms    | [S1,MB4,BI] 372-9-382ms    | [S6,MB7,BI] 382-9-391ms    | [S1,MB5,BI] 391-9-401ms    | [S1,MB4,BW] 401-9-410ms    | [S1,MB6,BI] 410-9-420ms    | [S1,MB5,BW] 420-9-429ms    | [S1,MB7,BI] 429-9-439ms    | [S1,MB6,BW] 439-9-448ms    | [S6,MB7,BW] 448-9-458ms    | [S1,MB7,BW] 458-9-468ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-28ms      | [S2,MB1,F]  28-9-38ms      | [S2,MB2,F]  38-9-47ms      | [S5,MB0,F]  47-9-57ms      | [S2,MB3,F]  57-9-66ms      | [S5,MB1,F]  66-9-76ms      | [S2,MB4,F]  76-9-85ms      | [S5,MB2,F]  85-9-95ms      | [S5,MB0,BI] 95-9-105ms     | [S5,MB0,BW] 105-9-114ms    | [S5,MB3,F]  114-9-124ms    | [S5,MB1,BI] 124-9-133ms    | [S5,MB1,BW] 133-9-143ms    | [S2,MB5,F]  143-9-152ms    | [S2,MB0,BI] 152-9-162ms    | [S2,MB0,BW] 162-9-171ms    | [S5,MB4,F]  171-9-181ms    | [S5,MB2,BI] 181-9-191ms    | [S5,MB2,BW] 191-9-200ms    | [S2,MB6,F]  200-9-210ms    | [S2,MB1,BI] 210-9-219ms    | [S2,MB1,BW] 219-9-229ms    | [S5,MB5,F]  229-9-238ms    | [S5,MB3,BI] 238-9-248ms    | [S5,MB3,BW] 248-9-257ms    | [S2,MB7,F]  257-9-267ms    | [S2,MB2,BI] 267-9-277ms    | [S2,MB2,BW] 277-9-286ms    | [S5,MB6,F]  286-9-296ms    | [S5,MB4,BI] 296-9-305ms    | [S5,MB4,BW] 305-9-315ms    | [S2,MB3,BI] 315-9-324ms    | [S2,MB3,BW] 324-9-334ms    | [S5,MB7,F]  334-9-343ms    | [S5,MB5,BI] 343-9-353ms    | [S5,MB5,BW] 353-9-362ms    | [S2,MB4,BI] 362-9-372ms    | [S5,MB6,BI] 372-9-382ms    | [S2,MB5,BI] 382-9-391ms    | [S5,MB7,BI] 391-9-401ms    | [S2,MB6,BI] 401-9-410ms    | [S2,MB4,BW] 410-9-420ms    | [S2,MB7,BI] 420-9-429ms    | [S2,MB5,BW] 429-9-439ms    | [S5,MB6,BW] 439-9-448ms    | [S5,MB7,BW] 448-9-458ms    | [S2,MB6,BW] 458-9-468ms    | [S2,MB7,BW] 468-9-477ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-9-38ms      | [S4,MB0,F]  38-9-47ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  57-9-66ms      | [S3,MB2,F]  66-9-76ms      | [S4,MB2,F]  76-9-85ms      | [S3,MB3,F]  85-9-95ms      | [S4,MB3,F]  95-9-105ms     | [S4,MB0,BI] 105-9-114ms    | [S4,MB0,BW] 114-9-124ms    | [S3,MB4,F]  124-9-133ms    | [S3,MB0,BI] 133-9-143ms    | [S3,MB0,BW] 143-9-152ms    | [S4,MB4,F]  152-9-162ms    | [S4,MB1,BI] 162-9-171ms    | [S4,MB1,BW] 171-9-181ms    | [S3,MB5,F]  181-9-191ms    | [S3,MB1,BI] 191-9-200ms    | [S3,MB1,BW] 200-9-210ms    | [S4,MB5,F]  210-9-219ms    | [S4,MB2,BI] 219-9-229ms    | [S4,MB2,BW] 229-9-238ms    | [S3,MB6,F]  238-9-248ms    | [S3,MB2,BI] 248-9-257ms    | [S3,MB2,BW] 257-9-267ms    | [S4,MB6,F]  267-9-277ms    | [S4,MB3,BI] 277-9-286ms    | [S4,MB3,BW] 286-9-296ms    | [S3,MB7,F]  296-9-305ms    | [S3,MB3,BI] 305-9-315ms    | [S3,MB3,BW] 315-9-324ms    | [S4,MB7,F]  324-9-334ms    | [S4,MB4,BI] 334-9-343ms    | [S4,MB4,BW] 343-9-353ms    | [S3,MB4,BI] 353-9-362ms    | [S4,MB5,BI] 362-9-372ms    | [S3,MB5,BI] 372-9-382ms    | [S4,MB6,BI] 382-9-391ms    | [S3,MB6,BI] 391-9-401ms    | [S4,MB7,BI] 401-9-410ms    | [S3,MB7,BI] 410-9-420ms    | [S3,MB4,BW] 420-9-429ms    | [S4,MB5,BW] 429-9-439ms    | [S4,MB6,BW] 439-9-448ms    | [S4,MB7,BW] 448-9-458ms    | [S3,MB5,BW] 458-9-468ms    | [S3,MB6,BW] 468-9-477ms    | [S3,MB7,BW] 477-9-487ms   
[rank3]:2025-12-28 00:11:32,732 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_0011_stage3_final800.svg
[rank3]:2025-12-28 00:11:32,778 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_0011_stage4_final800.svg
[rank3]:2025-12-28 00:11:32,876 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank3_stage3.svg
[rank3]:	> Counts Sum: 164360, Total Sum: 414720 (39.63%), Ratio(%) per element: [41.14, 40.62, 40.79, 40.97, 40.45, 40.45, 40.45, 35.59, 35.41, 41.31, 40.79, 41.49, 41.49, 41.14, 40.27, 40.1, 35.93, 34.89]
[rank3]:2025-12-28 00:11:32,974 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/frozen_params_histogram/251228_0011_rank3_stage4.svg
[rank3]:	> Counts Sum: 11520, Total Sum: 414720 (2.78%), Ratio(%) per element: [2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77, 2.77]
[rank0]:2025-12-28 00:11:33,290 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage0.svg
[rank1]:2025-12-28 00:11:33,297 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage1.svg
[rank2]:2025-12-28 00:11:33,267 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage2.svg
[rank3]:2025-12-28 00:11:33,939 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage3.svg
[rank1]:2025-12-28 00:11:34,198 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage6.svg
[rank1]:2025-12-28 00:11:34,201 - Destroying the purge thread.
[rank2]:2025-12-28 00:11:34,181 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage5.svg
[rank2]:2025-12-28 00:11:34,184 - Destroying the purge thread.
[rank0]:2025-12-28 00:11:34,246 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage7.svg
[rank0]:2025-12-28 00:11:34,250 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-28 00:11:34,452 - Process group destroyed
[rank1]:2025-12-28 00:11:34,516 - Process group destroyed
[rank3]:2025-12-28 00:11:34,843 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1/afr_time_plot/251228_0011_stage4.svg
[rank3]:2025-12-28 00:11:34,847 - Destroying the purge thread.
[rank3]:2025-12-28 00:11:34,939 - Process group destroyed
[rank0]:2025-12-28 00:11:36,251 - Training completed
[rank0]:2025-12-28 00:11:36,252 - Destroying the purge thread.
[rank0]:wandb: updating run metadata
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.31933
[rank0]:wandb:               final/avg_loss 0.2394
[rank0]:wandb:             final/avg_mfu(%) 22.66109
[rank0]:wandb:             final/avg_tflops 77.17377
[rank0]:wandb:    final/avg_throughput(tps) 9871.87504
[rank0]:wandb:              final/grad_norm 0.16912
[rank0]:wandb:               final/max_loss 0.2394
[rank0]:wandb:                    grad_norm 0.16912
[rank0]:wandb: loss_metrics/global_avg_loss 0.2394
[rank0]:wandb: loss_metrics/global_max_loss 0.2394
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1227_ZBVZeroBubble_timelyapf_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ssq1q8on
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_timelyapf_11_dm1/20251227-2324/wandb/run-20251227_232426-ssq1q8on/logs
[rank0]:2025-12-28 00:11:37,532 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_ZBVZeroBubble_timelyapf_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings'}
[rank0]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
