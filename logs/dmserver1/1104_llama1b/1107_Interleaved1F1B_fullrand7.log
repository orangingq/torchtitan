
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 07. (ê¸ˆ) 08:02:43 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1107_Interleaved1F1B_fullrand7.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
âœ”ï¸Running with fullrand7 x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-07 08:02:49,886 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank1]:2025-11-07 08:02:49,885 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank0]:2025-11-07 08:02:50,124 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-07 08:02:50,127 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 08:02:50,130 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-07 08:02:50,095 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank1]:2025-11-07 08:02:50,128 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-07 08:02:50,130 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-07 08:02:50,263 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-07 08:02:50,266 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-07 08:02:50,183 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:2025-11-07 08:02:50,347 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-07 08:02:50,350 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 08:02:50,647 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-07 08:02:51,031 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-07 08:02:53,969 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-07 08:02:54,046 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-07 08:02:54,085 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 08:02:54,116 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-07 08:02:54,158 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 08:02:54,159 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-07 08:02:54,184 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank2]:2025-11-07 08:02:54,131 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-07 08:02:54,172 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-07 08:02:54,112 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-07 08:02:54,125 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-07 08:02:54,127 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-07 08:02:54,197 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-07 08:02:54,199 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-07 08:02:54,198 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-07 08:02:54,211 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-07 08:02:54,212 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-07 08:02:54,300 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-07 08:02:54,300 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-07 08:02:54,301 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-07 08:02:54,386 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 08:02:54,386 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-07 08:02:54,386 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-07 08:02:54,389 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-07 08:02:54,389 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-07 08:02:54,390 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run igdm504j
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1107_Interleaved1F1B_fullrand7_dm1/20251107-0802/wandb/run-20251107_080255-igdm504j
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1107_Interleaved1F1B_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/igdm504j
[rank3]:2025-11-07 08:02:58,712 - INFO - WandB logging enabled
[rank3]:2025-11-07 08:02:58,713 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-07 08:02:58,752 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 08:02:58,781 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-07 08:02:58,794 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-07 08:02:58,795 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-07 08:02:58,975 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1107_Interleaved1F1B_fullrand7_dm1
[rank0]:2025-11-07 08:02:58,976 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 08:02:58,976 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-07 08:02:58,976 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-07 08:02:58,976 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-07 08:02:58,976 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-07 08:02:58,964 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 08:02:58,965 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-07 08:02:58,965 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-07 08:02:58,975 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 08:03:01,034 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-07 08:03:01,034 - INFO - Finished loading the checkpoint in 2.06 seconds.
[rank0]:2025-11-07 08:03:01,034 - INFO - Training starts at step 1
[rank2]:2025-11-07 08:03:04,266 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8867  memory:  6.31GiB(13.29%)  tps: 1,623  tflops: 12.36  mfu: 3.96%
[rank2]:2025-11-07 08:03:04,266 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-07 08:03:04,277 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8867  memory:  9.58GiB(20.17%)  tps: 1,608  tflops: 12.24  mfu: 3.92%
[rank1]:2025-11-07 08:03:04,277 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-07 08:03:04,278 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8867  memory: 15.04GiB(31.66%)  tps: 2,966  tflops: 22.59  mfu: 7.24%
[rank3]:2025-11-07 08:03:04,279 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-07 08:03:04,302 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8867  memory: 10.96GiB(23.08%)  tps: 1,615  tflops: 12.30  mfu: 3.94%
[rank0]:2025-11-07 08:03:04,302 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-07 08:05:11,804 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 08:05:14,163 - INFO - Avg. fwd time: 6.5453 / Avg. bwd time: 21.3775 / Avg. batch time: 555.2263 (ms) / GPU bubble ratio: 19.53%
[rank0]:2025-11-07 08:05:14,241 - INFO - Avg. fwd time: 4.0917 / Avg. bwd time: 11.9678 / Avg. batch time: 640.6074 (ms) / GPU bubble ratio: 59.89%
[rank2]:2025-11-07 08:05:14,221 - INFO - Avg. fwd time: 3.9365 / Avg. bwd time: 9.9871 / Avg. batch time: 588.8311 (ms) / GPU bubble ratio: 62.17%
[rank1]:2025-11-07 08:05:14,318 - INFO - Avg. fwd time: 4.8473 / Avg. bwd time: 12.1472 / Avg. batch time: 617.9470 (ms) / GPU bubble ratio: 56.00%
[rank1]:2025-11-07 08:05:14,488 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.2820  memory: 11.85GiB(24.93%)  tps: 6,166  tflops: 46.96  mfu: 15.05%
[rank0]:2025-11-07 08:05:14,499 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.2820  memory: 14.71GiB(30.97%)  tps: 6,166  tflops: 46.96  mfu: 15.05%
[rank2]:2025-11-07 08:05:14,485 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.2820  memory:  8.13GiB(17.12%)  tps: 6,165  tflops: 46.95  mfu: 15.05%
[rank3]:2025-11-07 08:05:14,497 - INFO -  step: 50  loss:  9.1984  grad_norm: 15.2820  memory: 18.46GiB(38.86%)  tps: 6,165  tflops: 46.96  mfu: 15.05%
[rank3]:2025-11-07 08:05:41,374 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-07 08:06:08,110 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-07 08:06:08,419 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-07 08:06:08,448 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,458 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,466 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,456 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,465 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,477 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,492 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,507 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,527 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,466 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,482 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,501 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,522 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,465 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,480 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,498 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,517 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,475 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,488 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,509 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,530 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,551 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,584 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,610 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,540 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,600 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,624 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,537 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,558 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,616 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,622 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,601 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,634 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,668 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,643 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,674 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,683 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,694 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,701 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,712 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,720 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,674 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,693 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,697 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,706 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,713 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,718 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,732 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,668 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,683 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,691 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,697 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,704 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,714 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,725 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,677 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,683 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,695 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,702 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:08,709 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 08:06:08,731 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,747 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 08:06:08,759 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 08:06:08,738 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 08:06:48,310 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-07 08:06:48,618 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0806_max_batch_time.svg
[rank3]:> Batch Time: 522.46 ms, GPU Bubble Ratio: 50.33%, 47.46%, 56.94%, 12.33%
[rank3]:2025-11-07 08:06:48,863 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0806_min_batch_time.svg
[rank3]:> Batch Time: 330.30 ms, GPU Bubble Ratio: 68.97%, 49.13%, 57.48%, 10.20%
[rank3]:2025-11-07 08:06:49,117 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0806_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 353.69 ms, GPU Bubble Ratio: 37.87%, 32.99%, 43.16%, 8.87%
[rank3]:2025-11-07 08:06:49,118 - INFO - 	> Batch Time: 353.69 ms (Average Freeze Ratio: 0.39, Time Reduction Rate: 0.32)
[rank0]:2025-11-07 08:07:08,083 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 08:07:10,008 - INFO - Avg. fwd time: 4.1511 / Avg. bwd time: 8.6977 / Avg. batch time: 558.9793 (ms) / GPU bubble ratio: 63.22%
[rank0]:2025-11-07 08:07:09,952 - INFO - Avg. fwd time: 4.2954 / Avg. bwd time: 9.4347 / Avg. batch time: 603.7148 (ms) / GPU bubble ratio: 63.61%
[rank3]:2025-11-07 08:07:09,975 - INFO - Avg. fwd time: 6.9691 / Avg. bwd time: 18.9298 / Avg. batch time: 526.4755 (ms) / GPU bubble ratio: 21.29%
[rank3]:2025-11-07 08:07:09,983 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB0] 0.33/1.00, [MB1] 0.25/0.76, [MB2] 0.33/1.00, [MB3] 0.00/0.00, [MB4] 0.33/1.00, [MB5] 0.13/0.40, [MB6] 0.33/1.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.21/0.64
[rank1]:2025-11-07 08:07:10,020 - INFO - Avg. fwd time: 5.1131 / Avg. bwd time: 10.4505 / Avg. batch time: 585.0742 (ms) / GPU bubble ratio: 57.44%
[rank2]:2025-11-07 08:07:10,209 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.29/0.88, [MB6] 0.22/0.65, [MB7] 0.33/1.00
[rank0]:2025-11-07 08:07:10,217 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.07/0.22, [MB4] 0.05/0.14, [MB5] 0.33/1.00, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-11-07 08:07:10,222 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2324  memory: 14.71GiB(30.97%)  tps: 7,079  tflops: 53.91  mfu: 17.28%
[rank3]:2025-11-07 08:07:10,219 - INFO -  step: 100  loss:  4.7578  grad_norm:  0.2324  memory: 18.95GiB(39.89%)  tps: 7,079  tflops: 53.92  mfu: 17.28%
[rank2]:2025-11-07 08:07:10,222 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2324  memory:  8.13GiB(17.12%)  tps: 7,078  tflops: 53.91  mfu: 17.28%
[rank2]:2025-11-07 08:07:10,281 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0807_stage2_step100.svg
[rank1]:2025-11-07 08:07:10,216 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-07 08:07:10,222 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2324  memory: 11.85GiB(24.93%)  tps: 7,078  tflops: 53.91  mfu: 17.28%
[rank1]:2025-11-07 08:07:10,279 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0807_stage1_step100.svg
[rank0]:2025-11-07 08:07:10,279 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0807_stage0_step100.svg
[rank0]:2025-11-07 08:07:10,316 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0807_stage4_step100.svg
[rank2]:2025-11-07 08:07:10,319 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0807_stage6_step100.svg
[rank1]:2025-11-07 08:07:10,317 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0807_stage5_step100.svg
[rank3]:2025-11-07 08:07:10,452 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0807_real_step100_rank3.svg
[rank3]:> Batch Time: 507.50 ms, GPU Bubble Ratio: 71.80%, 60.68%, 64.88%, 34.57%
[rank3]:2025-11-07 08:07:10,494 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0807_stage3_step100.svg
[rank3]:2025-11-07 08:07:10,529 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0807_stage7_step100.svg
[rank0]:2025-11-07 08:09:05,778 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 08:09:07,970 - INFO - Avg. fwd time: 7.0784 / Avg. bwd time: 18.2320 / Avg. batch time: 518.4748 (ms) / GPU bubble ratio: 21.89%
[rank3]:2025-11-07 08:09:07,974 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.51/0.76, [MB2] 0.67/1.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.27/0.40, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.43/0.64
[rank1]:2025-11-07 08:09:08,010 - INFO - Avg. fwd time: 5.1701 / Avg. bwd time: 10.0437 / Avg. batch time: 574.9060 (ms) / GPU bubble ratio: 57.66%
[rank1]:2025-11-07 08:09:08,015 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-07 08:09:08,039 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.5622  memory: 12.18GiB(25.63%)  tps: 6,953  tflops: 52.96  mfu: 16.97%
[rank2]:2025-11-07 08:09:07,991 - INFO - Avg. fwd time: 4.2040 / Avg. bwd time: 8.5946 / Avg. batch time: 550.5322 (ms) / GPU bubble ratio: 62.80%
[rank2]:2025-11-07 08:09:07,997 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.59/0.88, [MB6] 0.43/0.65, [MB7] 0.67/1.00
[rank2]:2025-11-07 08:09:08,037 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.5622  memory:  8.52GiB(17.94%)  tps: 6,953  tflops: 52.96  mfu: 16.97%
[rank0]:2025-11-07 08:09:08,026 - INFO - Avg. fwd time: 4.3110 / Avg. bwd time: 8.9460 / Avg. batch time: 592.2740 (ms) / GPU bubble ratio: 64.19%
[rank0]:2025-11-07 08:09:08,030 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.14/0.22, [MB4] 0.09/0.14, [MB5] 0.67/1.00, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-11-07 08:09:08,040 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.5622  memory: 14.71GiB(30.97%)  tps: 6,953  tflops: 52.96  mfu: 16.97%
[rank3]:2025-11-07 08:09:08,052 - INFO -  step: 150  loss:  2.3607  grad_norm: 21.5622  memory: 19.46GiB(40.96%)  tps: 6,952  tflops: 52.95  mfu: 16.97%
[rank0]:2025-11-07 08:10:58,002 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 08:10:59,972 - INFO - Avg. fwd time: 4.3502 / Avg. bwd time: 8.4721 / Avg. batch time: 581.9295 (ms) / GPU bubble ratio: 64.75%
[rank3]:2025-11-07 08:10:59,989 - INFO - Avg. fwd time: 7.1842 / Avg. bwd time: 17.5501 / Avg. batch time: 511.4462 (ms) / GPU bubble ratio: 22.62%
[rank3]:2025-11-07 08:10:59,996 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.76/0.76, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.40/0.40, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.64/0.64
[rank1]:2025-11-07 08:11:00,062 - INFO - Avg. fwd time: 5.2467 / Avg. bwd time: 9.5105 / Avg. batch time: 565.6504 (ms) / GPU bubble ratio: 58.26%
[rank2]:2025-11-07 08:11:00,015 - INFO - Avg. fwd time: 4.2556 / Avg. bwd time: 8.3536 / Avg. batch time: 542.8004 (ms) / GPU bubble ratio: 62.83%
[rank3]:2025-11-07 08:11:00,251 - INFO -  step: 200  loss:  0.5569  grad_norm:  1.1200  memory: 19.46GiB(40.96%)  tps: 7,301  tflops: 55.61  mfu: 17.82%
[rank1]:2025-11-07 08:11:00,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 08:11:00,240 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.1200  memory: 12.18GiB(25.63%)  tps: 7,301  tflops: 55.61  mfu: 17.82%
[rank2]:2025-11-07 08:11:00,220 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.65/0.65, [MB7] 1.00/1.00
[rank2]:2025-11-07 08:11:00,238 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.1200  memory:  8.52GiB(17.94%)  tps: 7,301  tflops: 55.61  mfu: 17.82%
[rank2]:2025-11-07 08:11:00,302 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0811_stage2_step200.svg
[rank0]:2025-11-07 08:11:00,232 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.22/0.22, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-07 08:11:00,238 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.1200  memory: 14.71GiB(30.97%)  tps: 7,301  tflops: 55.61  mfu: 17.82%
[rank0]:2025-11-07 08:11:00,301 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0811_stage0_step200.svg
[rank1]:2025-11-07 08:11:00,301 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0811_stage1_step200.svg
[rank1]:2025-11-07 08:11:00,344 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0811_stage5_step200.svg
[rank2]:2025-11-07 08:11:00,344 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0811_stage6_step200.svg
[rank0]:2025-11-07 08:11:00,344 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0811_stage4_step200.svg
[rank3]:2025-11-07 08:11:00,491 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0811_real_step200_rank3.svg
[rank3]:> Batch Time: 535.90 ms, GPU Bubble Ratio: 67.67%, 61.95%, 65.29%, 34.56%
[rank3]:2025-11-07 08:11:00,534 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0811_stage3_step200.svg
[rank3]:2025-11-07 08:11:00,575 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0811_stage7_step200.svg
[rank0]:2025-11-07 08:12:44,219 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 08:12:46,074 - INFO - Avg. fwd time: 7.3014 / Avg. bwd time: 16.6805 / Avg. batch time: 501.5936 (ms) / GPU bubble ratio: 23.50%
[rank3]:2025-11-07 08:12:46,081 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.76/0.76, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.40/0.40, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.64/0.64
[rank2]:2025-11-07 08:12:46,105 - INFO - Avg. fwd time: 4.3229 / Avg. bwd time: 7.9992 / Avg. batch time: 532.3169 (ms) / GPU bubble ratio: 62.96%
[rank0]:2025-11-07 08:12:46,052 - INFO - Avg. fwd time: 4.3864 / Avg. bwd time: 7.6759 / Avg. batch time: 568.4528 (ms) / GPU bubble ratio: 66.05%
[rank1]:2025-11-07 08:12:46,120 - INFO - Avg. fwd time: 5.3295 / Avg. bwd time: 8.9834 / Avg. batch time: 553.8344 (ms) / GPU bubble ratio: 58.65%
[rank3]:2025-11-07 08:12:46,306 - INFO -  step: 250  loss:  0.5266  grad_norm:  0.1047  memory: 19.46GiB(40.96%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank1]:2025-11-07 08:12:46,305 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 08:12:46,311 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1047  memory: 12.18GiB(25.63%)  tps: 7,723  tflops: 58.82  mfu: 18.85%
[rank2]:2025-11-07 08:12:46,297 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.65/0.65, [MB7] 1.00/1.00
[rank2]:2025-11-07 08:12:46,311 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1047  memory:  8.52GiB(17.94%)  tps: 7,723  tflops: 58.82  mfu: 18.85%
[rank0]:2025-11-07 08:12:46,305 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.22/0.22, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-07 08:12:46,311 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1047  memory: 14.71GiB(30.97%)  tps: 7,723  tflops: 58.82  mfu: 18.85%
[rank0]:2025-11-07 08:14:29,044 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 08:14:31,163 - INFO - Avg. fwd time: 7.3879 / Avg. bwd time: 16.0075 / Avg. batch time: 494.0030 (ms) / GPU bubble ratio: 24.23%
[rank3]:2025-11-07 08:14:31,168 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.76/0.76, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.40/0.40, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.64/0.64
[rank3]:2025-11-07 08:14:31,220 - INFO -  step: 300  loss:  0.5092  grad_norm:  0.1114  memory: 19.46GiB(40.96%)  tps: 7,808  tflops: 59.47  mfu: 19.06%
[rank1]:2025-11-07 08:14:31,201 - INFO - Avg. fwd time: 5.3866 / Avg. bwd time: 8.6252 / Avg. batch time: 544.7740 (ms) / GPU bubble ratio: 58.85%
[rank1]:2025-11-07 08:14:31,206 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 08:14:31,221 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1114  memory: 12.18GiB(25.63%)  tps: 7,809  tflops: 59.47  mfu: 19.06%
[rank2]:2025-11-07 08:14:31,184 - INFO - Avg. fwd time: 4.3693 / Avg. bwd time: 7.7651 / Avg. batch time: 524.1494 (ms) / GPU bubble ratio: 62.96%
[rank2]:2025-11-07 08:14:31,189 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.65/0.65, [MB7] 1.00/1.00
[rank2]:2025-11-07 08:14:31,221 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1114  memory:  8.52GiB(17.94%)  tps: 7,809  tflops: 59.47  mfu: 19.06%
[rank2]:2025-11-07 08:14:31,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0814_stage2_step300.svg
[rank0]:2025-11-07 08:14:31,212 - INFO - Avg. fwd time: 4.4100 / Avg. bwd time: 7.1442 / Avg. batch time: 558.2807 (ms) / GPU bubble ratio: 66.89%
[rank0]:2025-11-07 08:14:31,215 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.22/0.22, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-07 08:14:31,221 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1114  memory: 14.71GiB(30.97%)  tps: 7,809  tflops: 59.47  mfu: 19.06%
[rank0]:2025-11-07 08:14:31,269 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0814_stage0_step300.svg
[rank1]:2025-11-07 08:14:31,269 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0814_stage1_step300.svg
[rank1]:2025-11-07 08:14:31,309 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0814_stage5_step300.svg
[rank2]:2025-11-07 08:14:31,311 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0814_stage6_step300.svg
[rank0]:2025-11-07 08:14:31,310 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0814_stage4_step300.svg
[rank3]:2025-11-07 08:14:31,454 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0814_real_step300_rank3.svg
[rank3]:> Batch Time: 517.50 ms, GPU Bubble Ratio: 72.20%, 61.09%, 65.18%, 34.32%
[rank3]:2025-11-07 08:14:31,495 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0814_stage3_step300.svg
[rank3]:2025-11-07 08:14:31,534 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0814_stage7_step300.svg
[rank0]:2025-11-07 08:16:14,820 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 08:16:16,672 - INFO - Avg. fwd time: 7.4376 / Avg. bwd time: 15.6242 / Avg. batch time: 489.6877 (ms) / GPU bubble ratio: 24.65%
[rank2]:2025-11-07 08:16:16,701 - INFO - Avg. fwd time: 4.3961 / Avg. bwd time: 7.6198 / Avg. batch time: 519.6169 (ms) / GPU bubble ratio: 63.00%
[rank0]:2025-11-07 08:16:16,651 - INFO - Avg. fwd time: 4.4217 / Avg. bwd time: 6.8273 / Avg. batch time: 552.5154 (ms) / GPU bubble ratio: 67.42%
[rank1]:2025-11-07 08:16:16,718 - INFO - Avg. fwd time: 5.4197 / Avg. bwd time: 8.4049 / Avg. batch time: 539.6920 (ms) / GPU bubble ratio: 59.01%
[rank3]:2025-11-07 08:16:16,904 - INFO -  step: 350  loss:  0.5169  grad_norm:  0.0939  memory: 19.46GiB(40.96%)  tps: 7,752  tflops: 59.04  mfu: 18.92%
[rank2]:2025-11-07 08:16:16,908 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0939  memory:  8.52GiB(17.94%)  tps: 7,751  tflops: 59.03  mfu: 18.92%
[rank0]:2025-11-07 08:16:16,908 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0939  memory: 14.71GiB(30.97%)  tps: 7,751  tflops: 59.03  mfu: 18.92%
[rank1]:2025-11-07 08:16:16,908 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0939  memory: 12.18GiB(25.63%)  tps: 7,751  tflops: 59.03  mfu: 18.92%
[rank0]:2025-11-07 08:18:00,568 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 08:18:02,435 - INFO - Avg. fwd time: 4.4341 / Avg. bwd time: 6.5399 / Avg. batch time: 547.4533 (ms) / GPU bubble ratio: 67.93%
[rank1]:2025-11-07 08:18:02,504 - INFO - Avg. fwd time: 5.4493 / Avg. bwd time: 8.2114 / Avg. batch time: 535.2341 (ms) / GPU bubble ratio: 59.16%
[rank3]:2025-11-07 08:18:02,463 - INFO - Avg. fwd time: 7.4794 / Avg. bwd time: 15.3079 / Avg. batch time: 486.0561 (ms) / GPU bubble ratio: 24.99%
[rank2]:2025-11-07 08:18:02,490 - INFO - Avg. fwd time: 4.4190 / Avg. bwd time: 7.4928 / Avg. batch time: 515.6427 (ms) / GPU bubble ratio: 63.04%
[rank1]:2025-11-07 08:18:02,701 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1107  memory: 12.18GiB(25.63%)  tps: 7,743  tflops: 58.98  mfu: 18.90%
[rank3]:2025-11-07 08:18:02,699 - INFO -  step: 400  loss:  0.5135  grad_norm:  0.1107  memory: 19.46GiB(40.96%)  tps: 7,743  tflops: 58.98  mfu: 18.90%
[rank2]:2025-11-07 08:18:02,701 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1107  memory:  8.52GiB(17.94%)  tps: 7,743  tflops: 58.98  mfu: 18.90%
[rank2]:2025-11-07 08:18:02,755 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0818_stage2_step400.svg
[rank0]:2025-11-07 08:18:02,701 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1107  memory: 14.71GiB(30.97%)  tps: 7,743  tflops: 58.98  mfu: 18.90%
[rank0]:2025-11-07 08:18:02,755 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0818_stage0_step400.svg
[rank1]:2025-11-07 08:18:02,757 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0818_stage1_step400.svg
[rank1]:2025-11-07 08:18:02,804 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0818_stage5_step400.svg
[rank2]:2025-11-07 08:18:02,800 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0818_stage6_step400.svg
[rank0]:2025-11-07 08:18:02,800 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0818_stage4_step400.svg
[rank3]:2025-11-07 08:18:02,937 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0818_real_step400_rank3.svg
[rank3]:> Batch Time: 516.50 ms, GPU Bubble Ratio: 71.41%, 60.97%, 65.20%, 34.75%
[rank3]:2025-11-07 08:18:02,983 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0818_stage3_step400.svg
[rank3]:2025-11-07 08:18:03,026 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0818_stage7_step400.svg
[rank3]:2025-11-07 08:18:13,967 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-07 08:18:14,189 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-07 08:18:14,181 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 08:18:14,189 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 08:19:46,485 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 08:19:48,558 - INFO - Avg. fwd time: 7.5127 / Avg. bwd time: 15.0559 / Avg. batch time: 483.1891 (ms) / GPU bubble ratio: 25.27%
[rank2]:2025-11-07 08:19:48,579 - INFO - Avg. fwd time: 4.4378 / Avg. bwd time: 7.3957 / Avg. batch time: 512.6314 (ms) / GPU bubble ratio: 63.07%
[rank0]:2025-11-07 08:19:48,610 - INFO - Avg. fwd time: 4.4467 / Avg. bwd time: 6.3020 / Avg. batch time: 543.6205 (ms) / GPU bubble ratio: 68.36%
[rank1]:2025-11-07 08:19:48,597 - INFO - Avg. fwd time: 5.4727 / Avg. bwd time: 8.0634 / Avg. batch time: 531.8556 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-11-07 08:19:48,620 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0998  memory: 12.18GiB(25.63%)  tps: 7,734  tflops: 58.91  mfu: 18.88%
[rank3]:2025-11-07 08:19:48,616 - INFO -  step: 450  loss:  0.5114  grad_norm:  0.0998  memory: 19.46GiB(40.96%)  tps: 7,734  tflops: 58.91  mfu: 18.88%
[rank2]:2025-11-07 08:19:48,620 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0998  memory:  8.52GiB(17.94%)  tps: 7,734  tflops: 58.91  mfu: 18.88%
[rank0]:2025-11-07 08:19:48,620 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0998  memory: 14.71GiB(30.97%)  tps: 7,734  tflops: 58.91  mfu: 18.88%
[rank0]:2025-11-07 08:21:32,535 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 08:21:34,413 - INFO - Avg. fwd time: 4.4523 / Avg. bwd time: 6.1551 / Avg. batch time: 541.0550 (ms) / GPU bubble ratio: 68.63%
[rank1]:2025-11-07 08:21:34,482 - INFO - Avg. fwd time: 5.4888 / Avg. bwd time: 7.9619 / Avg. batch time: 529.6077 (ms) / GPU bubble ratio: 59.36%
[rank2]:2025-11-07 08:21:34,467 - INFO - Avg. fwd time: 4.4508 / Avg. bwd time: 7.3285 / Avg. batch time: 510.6369 (ms) / GPU bubble ratio: 63.09%
[rank3]:2025-11-07 08:21:34,442 - INFO - Avg. fwd time: 7.5351 / Avg. bwd time: 14.8923 / Avg. batch time: 481.3839 (ms) / GPU bubble ratio: 25.46%
[rank1]:2025-11-07 08:21:34,677 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1065  memory: 12.18GiB(25.63%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank1]:2025-11-07 08:21:34,725 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0821_stage1_step500.svg
[rank2]:2025-11-07 08:21:34,677 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1065  memory:  8.52GiB(17.94%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank2]:2025-11-07 08:21:34,726 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0821_stage2_step500.svg
[rank3]:2025-11-07 08:21:34,674 - INFO -  step: 500  loss:  0.5313  grad_norm:  0.1065  memory: 19.46GiB(40.96%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank0]:2025-11-07 08:21:34,677 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1065  memory: 14.71GiB(30.97%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank0]:2025-11-07 08:21:34,725 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0821_stage0_step500.svg
[rank1]:2025-11-07 08:21:34,765 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0821_stage5_step500.svg
[rank2]:2025-11-07 08:21:34,766 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0821_stage6_step500.svg
[rank0]:2025-11-07 08:21:34,765 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0821_stage4_step500.svg
[rank3]:2025-11-07 08:21:34,913 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0821_real_step500_rank3.svg
[rank3]:> Batch Time: 515.00 ms, GPU Bubble Ratio: 71.87%, 60.76%, 65.04%, 35.08%
[rank3]:2025-11-07 08:21:34,955 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0821_stage3_step500.svg
[rank3]:2025-11-07 08:21:34,994 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0821_stage7_step500.svg
[rank0]:2025-11-07 08:23:17,748 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 08:23:19,604 - INFO - Avg. fwd time: 4.4601 / Avg. bwd time: 6.0035 / Avg. batch time: 538.2050 (ms) / GPU bubble ratio: 68.89%
[rank2]:2025-11-07 08:23:19,661 - INFO - Avg. fwd time: 4.4660 / Avg. bwd time: 7.2643 / Avg. batch time: 508.3370 (ms) / GPU bubble ratio: 63.08%
[rank1]:2025-11-07 08:23:19,674 - INFO - Avg. fwd time: 5.5063 / Avg. bwd time: 7.8649 / Avg. batch time: 527.0641 (ms) / GPU bubble ratio: 59.41%
[rank3]:2025-11-07 08:23:19,628 - INFO - Avg. fwd time: 7.5602 / Avg. bwd time: 14.6950 / Avg. batch time: 479.1611 (ms) / GPU bubble ratio: 25.69%
[rank1]:2025-11-07 08:23:19,860 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1071  memory: 12.18GiB(25.63%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank2]:2025-11-07 08:23:19,860 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1071  memory:  8.52GiB(17.94%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank3]:2025-11-07 08:23:19,857 - INFO -  step: 550  loss:  0.5721  grad_norm:  0.1071  memory: 19.46GiB(40.96%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank0]:2025-11-07 08:23:19,860 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1071  memory: 14.71GiB(30.97%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank0]:2025-11-07 08:25:03,005 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 08:25:05,110 - INFO - Avg. fwd time: 7.5795 / Avg. bwd time: 14.5466 / Avg. batch time: 477.4539 (ms) / GPU bubble ratio: 25.85%
[rank1]:2025-11-07 08:25:05,152 - INFO - Avg. fwd time: 5.5187 / Avg. bwd time: 7.7847 / Avg. batch time: 525.0032 (ms) / GPU bubble ratio: 59.46%
[rank1]:2025-11-07 08:25:05,175 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0951  memory: 12.18GiB(25.63%)  tps: 7,779  tflops: 59.24  mfu: 18.99%
[rank1]:2025-11-07 08:25:05,226 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0825_stage1_step600.svg
[rank2]:2025-11-07 08:25:05,133 - INFO - Avg. fwd time: 4.4761 / Avg. bwd time: 7.2116 / Avg. batch time: 506.4742 (ms) / GPU bubble ratio: 63.08%
[rank2]:2025-11-07 08:25:05,175 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0951  memory:  8.52GiB(17.94%)  tps: 7,779  tflops: 59.24  mfu: 18.99%
[rank2]:2025-11-07 08:25:05,225 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0825_stage2_step600.svg
[rank3]:2025-11-07 08:25:05,172 - INFO -  step: 600  loss:  0.5091  grad_norm:  0.0951  memory: 19.46GiB(40.96%)  tps: 7,779  tflops: 59.24  mfu: 18.99%
[rank0]:2025-11-07 08:25:05,166 - INFO - Avg. fwd time: 4.4656 / Avg. bwd time: 5.8834 / Avg. batch time: 535.8949 (ms) / GPU bubble ratio: 69.10%
[rank0]:2025-11-07 08:25:05,175 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0951  memory: 14.71GiB(30.97%)  tps: 7,779  tflops: 59.24  mfu: 18.99%
[rank0]:2025-11-07 08:25:05,225 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0825_stage0_step600.svg
[rank1]:2025-11-07 08:25:05,268 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0825_stage5_step600.svg
[rank2]:2025-11-07 08:25:05,267 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0825_stage6_step600.svg
[rank0]:2025-11-07 08:25:05,268 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0825_stage4_step600.svg
[rank3]:2025-11-07 08:25:05,408 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0825_real_step600_rank3.svg
[rank3]:> Batch Time: 513.50 ms, GPU Bubble Ratio: 71.32%, 60.69%, 64.90%, 35.11%
[rank3]:2025-11-07 08:25:05,451 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0825_stage3_step600.svg
[rank3]:2025-11-07 08:25:05,492 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0825_stage7_step600.svg
[rank0]:2025-11-07 08:26:48,567 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 08:26:50,390 - INFO - Avg. fwd time: 4.4711 / Avg. bwd time: 5.7874 / Avg. batch time: 534.2861 (ms) / GPU bubble ratio: 69.28%
[rank1]:2025-11-07 08:26:50,462 - INFO - Avg. fwd time: 5.5280 / Avg. bwd time: 7.7263 / Avg. batch time: 523.5776 (ms) / GPU bubble ratio: 59.50%
[rank3]:2025-11-07 08:26:50,417 - INFO - Avg. fwd time: 7.5946 / Avg. bwd time: 14.4357 / Avg. batch time: 476.2106 (ms) / GPU bubble ratio: 25.98%
[rank2]:2025-11-07 08:26:50,451 - INFO - Avg. fwd time: 4.4840 / Avg. bwd time: 7.1729 / Avg. batch time: 505.1944 (ms) / GPU bubble ratio: 63.08%
[rank1]:2025-11-07 08:26:50,639 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1080  memory: 12.18GiB(25.63%)  tps: 7,768  tflops: 59.16  mfu: 18.96%
[rank3]:2025-11-07 08:26:50,635 - INFO -  step: 650  loss:  0.5158  grad_norm:  0.1080  memory: 19.46GiB(40.96%)  tps: 7,768  tflops: 59.16  mfu: 18.96%
[rank2]:2025-11-07 08:26:50,639 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1080  memory:  8.52GiB(17.94%)  tps: 7,768  tflops: 59.16  mfu: 18.96%
[rank0]:2025-11-07 08:26:50,639 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1080  memory: 14.71GiB(30.97%)  tps: 7,768  tflops: 59.16  mfu: 18.96%
[rank0]:2025-11-07 08:28:34,242 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 08:28:36,178 - INFO - Avg. fwd time: 4.4913 / Avg. bwd time: 7.1336 / Avg. batch time: 503.9265 (ms) / GPU bubble ratio: 63.09%
[rank0]:2025-11-07 08:28:36,120 - INFO - Avg. fwd time: 4.4745 / Avg. bwd time: 5.7043 / Avg. batch time: 532.6873 (ms) / GPU bubble ratio: 69.43%
[rank3]:2025-11-07 08:28:36,145 - INFO - Avg. fwd time: 7.6070 / Avg. bwd time: 14.3362 / Avg. batch time: 475.0652 (ms) / GPU bubble ratio: 26.10%
[rank1]:2025-11-07 08:28:36,190 - INFO - Avg. fwd time: 5.5367 / Avg. bwd time: 7.6668 / Avg. batch time: 522.1612 (ms) / GPU bubble ratio: 59.54%
[rank2]:2025-11-07 08:28:36,379 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0888  memory:  8.52GiB(17.94%)  tps: 7,747  tflops: 59.01  mfu: 18.91%
[rank0]:2025-11-07 08:28:36,379 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0888  memory: 14.71GiB(30.97%)  tps: 7,747  tflops: 59.01  mfu: 18.91%
[rank3]:2025-11-07 08:28:36,375 - INFO -  step: 700  loss:  0.4938  grad_norm:  0.0888  memory: 19.46GiB(40.96%)  tps: 7,747  tflops: 59.01  mfu: 18.91%
[rank1]:2025-11-07 08:28:36,379 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0888  memory: 12.18GiB(25.63%)  tps: 7,747  tflops: 59.01  mfu: 18.91%
[rank2]:2025-11-07 08:28:36,431 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0828_stage2_step700.svg
[rank2]:2025-11-07 08:28:36,475 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0828_stage6_step700.svg
[rank0]:2025-11-07 08:28:36,431 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0828_stage0_step700.svg
[rank0]:2025-11-07 08:28:36,474 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0828_stage4_step700.svg
[rank1]:2025-11-07 08:28:36,431 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0828_stage1_step700.svg
[rank1]:2025-11-07 08:28:36,474 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0828_stage5_step700.svg
[rank3]:2025-11-07 08:28:36,611 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0828_real_step700_rank3.svg
[rank3]:> Batch Time: 514.50 ms, GPU Bubble Ratio: 71.26%, 60.88%, 65.08%, 34.99%
[rank3]:2025-11-07 08:28:36,656 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0828_stage3_step700.svg
[rank3]:2025-11-07 08:28:36,699 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0828_stage7_step700.svg
[rank0]:2025-11-07 08:30:19,589 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-07 08:30:21,700 - INFO - Avg. fwd time: 4.4971 / Avg. bwd time: 7.0999 / Avg. batch time: 502.7642 (ms) / GPU bubble ratio: 63.09%
[rank0]:2025-11-07 08:30:21,735 - INFO - Avg. fwd time: 4.4775 / Avg. bwd time: 5.6271 / Avg. batch time: 531.2417 (ms) / GPU bubble ratio: 69.57%
[rank0]:2025-11-07 08:30:21,745 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1037  memory: 14.71GiB(30.97%)  tps: 7,775  tflops: 59.21  mfu: 18.98%
[rank3]:2025-11-07 08:30:21,676 - INFO - Avg. fwd time: 7.6205 / Avg. bwd time: 14.2387 / Avg. batch time: 473.9361 (ms) / GPU bubble ratio: 26.20%
[rank3]:2025-11-07 08:30:21,742 - INFO -  step: 750  loss:  0.5457  grad_norm:  0.1037  memory: 19.46GiB(40.96%)  tps: 7,775  tflops: 59.21  mfu: 18.98%
[rank1]:2025-11-07 08:30:21,721 - INFO - Avg. fwd time: 5.5438 / Avg. bwd time: 7.6158 / Avg. batch time: 520.8733 (ms) / GPU bubble ratio: 59.58%
[rank1]:2025-11-07 08:30:21,745 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1037  memory: 12.18GiB(25.63%)  tps: 7,775  tflops: 59.21  mfu: 18.98%
[rank2]:2025-11-07 08:30:21,745 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1037  memory:  8.52GiB(17.94%)  tps: 7,775  tflops: 59.21  mfu: 18.98%
[rank0]:2025-11-07 08:32:04,444 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 08:32:06,283 - INFO - Avg. fwd time: 4.4803 / Avg. bwd time: 5.5673 / Avg. batch time: 530.0446 (ms) / GPU bubble ratio: 69.67%
[rank3]:2025-11-07 08:32:06,307 - INFO - Avg. fwd time: 7.6323 / Avg. bwd time: 14.1587 / Avg. batch time: 473.0346 (ms) / GPU bubble ratio: 26.29%
[rank2]:2025-11-07 08:32:06,343 - INFO - Avg. fwd time: 4.5027 / Avg. bwd time: 7.0745 / Avg. batch time: 501.7847 (ms) / GPU bubble ratio: 63.08%
[rank1]:2025-11-07 08:32:06,355 - INFO - Avg. fwd time: 5.5501 / Avg. bwd time: 7.5776 / Avg. batch time: 519.7976 (ms) / GPU bubble ratio: 59.59%
[rank2]:2025-11-07 08:32:06,531 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1024  memory:  8.52GiB(17.94%)  tps: 7,818  tflops: 59.54  mfu: 19.08%
[rank0]:2025-11-07 08:32:06,531 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1024  memory: 14.71GiB(30.97%)  tps: 7,818  tflops: 59.54  mfu: 19.08%
[rank0]:2025-11-07 08:32:06,585 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0832_stage0_step800.svg
[rank3]:2025-11-07 08:32:06,528 - INFO -  step: 800  loss:  0.4988  grad_norm:  0.1024  memory: 19.46GiB(40.96%)  tps: 7,818  tflops: 59.54  mfu: 19.08%
[rank1]:2025-11-07 08:32:06,531 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1024  memory: 12.18GiB(25.63%)  tps: 7,818  tflops: 59.54  mfu: 19.08%
[rank1]:2025-11-07 08:32:06,585 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0832_stage1_step800.svg
[rank2]:2025-11-07 08:32:06,585 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0832_stage2_step800.svg
[rank2]:2025-11-07 08:32:06,631 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0832_stage6_step800.svg
[rank0]:2025-11-07 08:32:06,630 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0832_stage4_step800.svg
[rank1]:2025-11-07 08:32:06,630 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0832_stage5_step800.svg
[rank3]:2025-11-07 08:32:06,770 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0832_real_step800_rank3.svg
[rank3]:> Batch Time: 505.50 ms, GPU Bubble Ratio: 71.80%, 60.04%, 64.31%, 35.63%
[rank3]:2025-11-07 08:32:06,816 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0832_stage3_step800.svg
[rank3]:2025-11-07 08:32:06,860 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0832_stage7_step800.svg
[rank3]:2025-11-07 08:32:29,502 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 08:32:29,714 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-07 08:32:29,714 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-07 08:32:29,707 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 08:33:50,308 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 08:33:52,157 - INFO - Avg. fwd time: 4.4830 / Avg. bwd time: 5.5037 / Avg. batch time: 529.0577 (ms) / GPU bubble ratio: 69.80%
[rank1]:2025-11-07 08:33:52,229 - INFO - Avg. fwd time: 5.5561 / Avg. bwd time: 7.5382 / Avg. batch time: 518.9357 (ms) / GPU bubble ratio: 59.63%
[rank3]:2025-11-07 08:33:52,187 - INFO - Avg. fwd time: 7.6405 / Avg. bwd time: 14.0939 / Avg. batch time: 472.2969 (ms) / GPU bubble ratio: 26.37%
[rank2]:2025-11-07 08:33:52,217 - INFO - Avg. fwd time: 4.5073 / Avg. bwd time: 7.0490 / Avg. batch time: 501.0221 (ms) / GPU bubble ratio: 63.10%
[rank0]:2025-11-07 08:33:52,415 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1204  memory: 14.71GiB(30.97%)  tps: 7,737  tflops: 58.93  mfu: 18.89%
[rank1]:2025-11-07 08:33:52,415 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1204  memory: 12.18GiB(25.63%)  tps: 7,737  tflops: 58.93  mfu: 18.89%
[rank3]:2025-11-07 08:33:52,413 - INFO -  step: 850  loss:  0.5092  grad_norm:  0.1204  memory: 19.46GiB(40.96%)  tps: 7,737  tflops: 58.92  mfu: 18.89%
[rank2]:2025-11-07 08:33:52,415 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1204  memory:  8.52GiB(17.94%)  tps: 7,737  tflops: 58.93  mfu: 18.89%
[rank0]:2025-11-07 08:35:35,242 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 08:35:37,350 - INFO - Avg. fwd time: 7.6519 / Avg. bwd time: 14.0203 / Avg. batch time: 471.5155 (ms) / GPU bubble ratio: 26.46%
[rank2]:2025-11-07 08:35:37,375 - INFO - Avg. fwd time: 4.5117 / Avg. bwd time: 7.0264 / Avg. batch time: 500.1671 (ms) / GPU bubble ratio: 63.09%
[rank2]:2025-11-07 08:35:37,422 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0931  memory:  8.52GiB(17.94%)  tps: 7,801  tflops: 59.42  mfu: 19.04%
[rank3]:2025-11-07 08:35:37,420 - INFO -  step: 900  loss:  0.4813  grad_norm:  0.0931  memory: 19.46GiB(40.96%)  tps: 7,802  tflops: 59.42  mfu: 19.04%
[rank1]:2025-11-07 08:35:37,397 - INFO - Avg. fwd time: 5.5614 / Avg. bwd time: 7.5035 / Avg. batch time: 517.9962 (ms) / GPU bubble ratio: 59.64%
[rank1]:2025-11-07 08:35:37,422 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0931  memory: 12.18GiB(25.63%)  tps: 7,801  tflops: 59.42  mfu: 19.04%
[rank1]:2025-11-07 08:35:37,470 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0835_stage1_step900.svg
[rank0]:2025-11-07 08:35:37,413 - INFO - Avg. fwd time: 4.4840 / Avg. bwd time: 5.4588 / Avg. batch time: 528.0106 (ms) / GPU bubble ratio: 69.87%
[rank0]:2025-11-07 08:35:37,422 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0931  memory: 14.71GiB(30.97%)  tps: 7,801  tflops: 59.42  mfu: 19.04%
[rank0]:2025-11-07 08:35:37,470 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0835_stage0_step900.svg
[rank2]:2025-11-07 08:35:37,471 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0835_stage2_step900.svg
[rank2]:2025-11-07 08:35:37,511 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0835_stage6_step900.svg
[rank1]:2025-11-07 08:35:37,510 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0835_stage5_step900.svg
[rank0]:2025-11-07 08:35:37,510 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0835_stage4_step900.svg
[rank3]:2025-11-07 08:35:37,659 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0835_real_step900_rank3.svg
[rank3]:> Batch Time: 516.00 ms, GPU Bubble Ratio: 71.06%, 60.96%, 65.07%, 34.77%
[rank3]:2025-11-07 08:35:37,700 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0835_stage3_step900.svg
[rank3]:2025-11-07 08:35:37,739 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0835_stage7_step900.svg
[rank0]:2025-11-07 08:37:20,464 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 08:37:22,324 - INFO - Avg. fwd time: 4.4852 / Avg. bwd time: 5.4188 / Avg. batch time: 527.1842 (ms) / GPU bubble ratio: 69.94%
[rank2]:2025-11-07 08:37:22,385 - INFO - Avg. fwd time: 4.5147 / Avg. bwd time: 7.0093 / Avg. batch time: 499.4911 (ms) / GPU bubble ratio: 63.09%
[rank1]:2025-11-07 08:37:22,394 - INFO - Avg. fwd time: 5.5652 / Avg. bwd time: 7.4772 / Avg. batch time: 517.2544 (ms) / GPU bubble ratio: 59.66%
[rank3]:2025-11-07 08:37:22,352 - INFO - Avg. fwd time: 7.6604 / Avg. bwd time: 13.9604 / Avg. batch time: 470.8383 (ms) / GPU bubble ratio: 26.53%
[rank2]:2025-11-07 08:37:22,579 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0980  memory:  8.52GiB(17.94%)  tps: 7,790  tflops: 59.33  mfu: 19.02%
[rank1]:2025-11-07 08:37:22,579 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0980  memory: 12.18GiB(25.63%)  tps: 7,790  tflops: 59.33  mfu: 19.02%
[rank3]:2025-11-07 08:37:22,578 - INFO -  step: 950  loss:  0.5238  grad_norm:  0.0980  memory: 19.46GiB(40.96%)  tps: 7,790  tflops: 59.33  mfu: 19.02%
[rank0]:2025-11-07 08:37:22,579 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0980  memory: 14.71GiB(30.97%)  tps: 7,790  tflops: 59.33  mfu: 19.02%
[rank0]:2025-11-07 08:39:05,535 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 08:39:07,382 - INFO - Avg. fwd time: 4.4871 / Avg. bwd time: 5.3786 / Avg. batch time: 526.3679 (ms) / GPU bubble ratio: 70.01%
[rank3]:2025-11-07 08:39:07,414 - INFO - Avg. fwd time: 7.6650 / Avg. bwd time: 13.9105 / Avg. batch time: 470.2515 (ms) / GPU bubble ratio: 26.59%
[rank1]:2025-11-07 08:39:07,454 - INFO - Avg. fwd time: 5.5703 / Avg. bwd time: 7.4492 / Avg. batch time: 516.5276 (ms) / GPU bubble ratio: 59.67%
[rank2]:2025-11-07 08:39:07,442 - INFO - Avg. fwd time: 4.5190 / Avg. bwd time: 6.9908 / Avg. batch time: 498.8355 (ms) / GPU bubble ratio: 63.08%
[rank2]:2025-11-07 08:39:07,628 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0954  memory:  8.52GiB(17.94%)  tps: 7,798  tflops: 59.39  mfu: 19.04%
[rank3]:2025-11-07 08:39:07,625 - INFO -  step: 1000  loss:  0.5113  grad_norm:  0.0954  memory: 19.46GiB(40.96%)  tps: 7,799  tflops: 59.40  mfu: 19.04%
[rank1]:2025-11-07 08:39:07,628 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0954  memory: 12.18GiB(25.63%)  tps: 7,798  tflops: 59.39  mfu: 19.04%
[rank0]:2025-11-07 08:39:07,628 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0954  memory: 14.71GiB(30.97%)  tps: 7,798  tflops: 59.39  mfu: 19.04%
[rank0]:2025-11-07 08:39:07,678 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0839_stage0_step1000.svg
[rank2]:2025-11-07 08:39:07,679 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0839_stage2_step1000.svg
[rank2]:2025-11-07 08:39:07,721 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0839_stage6_step1000.svg
[rank1]:2025-11-07 08:39:07,680 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0839_stage1_step1000.svg
[rank1]:2025-11-07 08:39:07,721 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0839_stage5_step1000.svg
[rank0]:2025-11-07 08:39:07,719 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0839_stage4_step1000.svg
[rank3]:2025-11-07 08:39:07,865 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0839_real_step1000_rank3.svg
[rank3]:> Batch Time: 508.00 ms, GPU Bubble Ratio: 70.78%, 60.24%, 64.53%, 35.52%
[rank3]:2025-11-07 08:39:07,908 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0839_stage3_step1000.svg
[rank3]:2025-11-07 08:39:07,948 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0839_stage7_step1000.svg
[rank0]:2025-11-07 08:40:50,988 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 08:40:53,076 - INFO - Avg. fwd time: 7.6705 / Avg. bwd time: 13.8611 / Avg. batch time: 469.7082 (ms) / GPU bubble ratio: 26.66%
[rank2]:2025-11-07 08:40:53,104 - INFO - Avg. fwd time: 4.5227 / Avg. bwd time: 6.9743 / Avg. batch time: 498.2840 (ms) / GPU bubble ratio: 63.08%
[rank2]:2025-11-07 08:40:53,154 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1163  memory:  8.52GiB(17.94%)  tps: 7,763  tflops: 59.13  mfu: 18.95%
[rank3]:2025-11-07 08:40:53,151 - INFO -  step: 1050  loss:  0.5511  grad_norm:  0.1163  memory: 19.46GiB(40.96%)  tps: 7,763  tflops: 59.13  mfu: 18.95%
[rank0]:2025-11-07 08:40:53,145 - INFO - Avg. fwd time: 4.4883 / Avg. bwd time: 5.3445 / Avg. batch time: 525.6766 (ms) / GPU bubble ratio: 70.07%
[rank0]:2025-11-07 08:40:53,154 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1163  memory: 14.71GiB(30.97%)  tps: 7,763  tflops: 59.12  mfu: 18.95%
[rank1]:2025-11-07 08:40:53,128 - INFO - Avg. fwd time: 5.5744 / Avg. bwd time: 7.4237 / Avg. batch time: 515.9144 (ms) / GPU bubble ratio: 59.69%
[rank1]:2025-11-07 08:40:53,154 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1163  memory: 12.18GiB(25.63%)  tps: 7,763  tflops: 59.13  mfu: 18.95%
[rank0]:2025-11-07 08:42:36,059 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 08:42:37,942 - INFO - Avg. fwd time: 4.4900 / Avg. bwd time: 5.3099 / Avg. batch time: 525.0582 (ms) / GPU bubble ratio: 70.14%
[rank2]:2025-11-07 08:42:38,003 - INFO - Avg. fwd time: 4.5256 / Avg. bwd time: 6.9608 / Avg. batch time: 497.7793 (ms) / GPU bubble ratio: 63.08%
[rank3]:2025-11-07 08:42:37,968 - INFO - Avg. fwd time: 7.6745 / Avg. bwd time: 13.8222 / Avg. batch time: 469.2526 (ms) / GPU bubble ratio: 26.70%
[rank1]:2025-11-07 08:42:38,014 - INFO - Avg. fwd time: 5.5775 / Avg. bwd time: 7.4034 / Avg. batch time: 515.3590 (ms) / GPU bubble ratio: 59.70%
[rank2]:2025-11-07 08:42:38,197 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1017  memory:  8.52GiB(17.94%)  tps: 7,799  tflops: 59.40  mfu: 19.04%
[rank3]:2025-11-07 08:42:38,195 - INFO -  step: 1100  loss:  0.5186  grad_norm:  0.1017  memory: 19.46GiB(40.96%)  tps: 7,799  tflops: 59.40  mfu: 19.04%
[rank0]:2025-11-07 08:42:38,197 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1017  memory: 14.71GiB(30.97%)  tps: 7,799  tflops: 59.40  mfu: 19.04%
[rank0]:2025-11-07 08:42:38,247 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0842_stage0_step1100.svg
[rank1]:2025-11-07 08:42:38,197 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1017  memory: 12.18GiB(25.63%)  tps: 7,799  tflops: 59.40  mfu: 19.04%
[rank1]:2025-11-07 08:42:38,247 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0842_stage1_step1100.svg
[rank2]:2025-11-07 08:42:38,248 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0842_stage2_step1100.svg
[rank2]:2025-11-07 08:42:38,290 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0842_stage6_step1100.svg
[rank0]:2025-11-07 08:42:38,288 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0842_stage4_step1100.svg
[rank1]:2025-11-07 08:42:38,289 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0842_stage5_step1100.svg
[rank3]:2025-11-07 08:42:38,433 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0842_real_step1100_rank3.svg
[rank3]:> Batch Time: 508.75 ms, GPU Bubble Ratio: 71.40%, 60.46%, 64.63%, 35.56%
[rank3]:2025-11-07 08:42:38,477 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0842_stage3_step1100.svg
[rank3]:2025-11-07 08:42:38,519 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0842_stage7_step1100.svg
[rank0]:2025-11-07 08:44:21,844 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 08:44:23,690 - INFO - Avg. fwd time: 4.4923 / Avg. bwd time: 5.2748 / Avg. batch time: 524.5650 (ms) / GPU bubble ratio: 70.21%
[rank2]:2025-11-07 08:44:23,750 - INFO - Avg. fwd time: 4.5286 / Avg. bwd time: 6.9470 / Avg. batch time: 497.4075 (ms) / GPU bubble ratio: 63.09%
[rank1]:2025-11-07 08:44:23,761 - INFO - Avg. fwd time: 5.5809 / Avg. bwd time: 7.3821 / Avg. batch time: 514.9331 (ms) / GPU bubble ratio: 59.72%
[rank3]:2025-11-07 08:44:23,717 - INFO - Avg. fwd time: 7.6786 / Avg. bwd time: 13.7883 / Avg. batch time: 468.8902 (ms) / GPU bubble ratio: 26.75%
[rank2]:2025-11-07 08:44:23,937 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0961  memory:  8.52GiB(17.94%)  tps: 7,747  tflops: 59.01  mfu: 18.91%
[rank1]:2025-11-07 08:44:23,937 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0961  memory: 12.18GiB(25.63%)  tps: 7,747  tflops: 59.01  mfu: 18.91%
[rank0]:2025-11-07 08:44:23,937 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0961  memory: 14.71GiB(30.97%)  tps: 7,747  tflops: 59.01  mfu: 18.91%
[rank3]:2025-11-07 08:44:23,934 - INFO -  step: 1150  loss:  0.5203  grad_norm:  0.0961  memory: 19.46GiB(40.96%)  tps: 7,748  tflops: 59.01  mfu: 18.91%
[rank0]:2025-11-07 08:46:06,976 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 08:46:09,111 - INFO - Avg. fwd time: 4.5307 / Avg. bwd time: 6.9348 / Avg. batch time: 496.9477 (ms) / GPU bubble ratio: 63.09%
[rank3]:2025-11-07 08:46:09,083 - INFO - Avg. fwd time: 7.6833 / Avg. bwd time: 13.7526 / Avg. batch time: 468.4776 (ms) / GPU bubble ratio: 26.79%
[rank0]:2025-11-07 08:46:09,156 - INFO - Avg. fwd time: 4.4932 / Avg. bwd time: 5.2504 / Avg. batch time: 524.0021 (ms) / GPU bubble ratio: 70.25%
[rank2]:2025-11-07 08:46:09,165 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0983  memory:  8.52GiB(17.94%)  tps: 7,785  tflops: 59.29  mfu: 19.00%
[rank2]:2025-11-07 08:46:09,166 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0983  tps: 7,892  tflops: 60.11  mfu: 18.02%
[rank2]:2025-11-07 08:46:09,166 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-07 08:46:09,166 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-07 08:46:09,164 - INFO -  step: 1200  loss:  0.5181  grad_norm:  0.0983  memory: 19.46GiB(40.96%)  tps: 7,785  tflops: 59.29  mfu: 19.00%
[rank3]:2025-11-07 08:46:09,165 - INFO -  final step: 1200  loss:  0.5181  grad_norm:  0.0983  tps: 7,906  tflops: 60.22  mfu: 18.15%
[rank3]:2025-11-07 08:46:09,165 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-07 08:46:09,166 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-07 08:46:09,136 - INFO - Avg. fwd time: 5.5841 / Avg. bwd time: 7.3626 / Avg. batch time: 514.4271 (ms) / GPU bubble ratio: 59.73%
[rank1]:2025-11-07 08:46:09,165 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0983  memory: 12.18GiB(25.63%)  tps: 7,785  tflops: 59.29  mfu: 19.00%
[rank1]:2025-11-07 08:46:09,166 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0983  tps: 7,892  tflops: 60.11  mfu: 18.01%
[rank1]:2025-11-07 08:46:09,166 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-07 08:46:09,166 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-07 08:46:09,165 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0983  memory: 14.71GiB(30.97%)  tps: 7,785  tflops: 59.29  mfu: 19.00%
[rank0]:2025-11-07 08:46:09,165 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0983  tps: 7,892  tflops: 60.11  mfu: 18.01%
[rank0]:2025-11-07 08:46:09,166 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-07 08:46:09,166 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-07 08:46:11,225 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-07 08:46:11,302 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0846_stage2_final1200.svg
[rank1]:2025-11-07 08:46:11,302 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0846_stage1_final1200.svg
[rank0]:2025-11-07 08:46:11,305 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0846_stage0_final1200.svg
[rank2]:2025-11-07 08:46:11,408 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank2_stage2.svg
[rank2]:	> Counts Sum: 364720, Total Sum: 650880 (56.03%), Ratio(%) per element: [55.08, 55.97, 55.86, 55.53, 56.74, 55.64, 56.3, 56.41, 55.08, 56.74, 55.42, 55.3, 56.52, 56.19, 56.19, 55.64, 57.07, 56.85]
[rank1]:2025-11-07 08:46:11,433 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank1_stage1.svg
[rank1]:	> Counts Sum: 495360, Total Sum: 976320 (50.74%), Ratio(%) per element: [50.77, 51.1, 50.88, 50.66, 50.88, 50.77, 51.21, 50.88, 51.32, 50.22, 51.43, 50.22, 50.99, 50.88, 50.77, 50.99, 50.66, 50.33, 50.99, 50.44, 50.66, 50.66, 50.88, 49.66, 50.55, 50.33, 50.66]
[rank0]:2025-11-07 08:46:11,420 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank0_stage0.svg
[rank0]:	> Counts Sum: 451880, Total Sum: 687040 (65.77%), Ratio(%) per element: [59.29, 62.05, 62.5, 61.39, 63.05, 62.94, 63.71, 62.83, 64.71, 65.37, 66.15, 67.14, 66.92, 68.14, 68.8, 70.13, 69.69, 71.68, 73.11]
[rank2]:2025-11-07 08:46:11,451 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251107_0846_stage6_final1200.svg
[rank3]:2025-11-07 08:46:11,482 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0846_real_final1200_rank3.svg
[rank3]:> Batch Time: 513.50 ms, GPU Bubble Ratio: 71.47%, 60.74%, 64.94%, 34.94%
[rank1]:2025-11-07 08:46:11,475 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251107_0846_stage5_final1200.svg
[rank0]:2025-11-07 08:46:11,465 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251107_0846_stage4_final1200.svg
[rank2]:2025-11-07 08:46:11,550 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank2_stage6.svg
[rank2]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.39, 86.39, 86.5, 86.5, 86.39, 86.28, 86.17, 86.72, 86.5, 86.17, 86.28, 86.28, 86.28, 86.17, 86.39, 86.39, 86.28, 86.28]
[rank2]:2025-11-07 08:46:11,550 - INFO - Destroying the purge thread.
[rank1]:2025-11-07 08:46:11,574 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank1_stage5.svg
[rank1]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.06, 86.5, 86.39, 86.39, 86.06, 86.39, 86.28, 86.28, 86.39, 86.72, 86.39, 86.39, 86.39, 86.39, 86.39, 86.28, 86.28, 86.39]
[rank1]:2025-11-07 08:46:11,575 - INFO - Destroying the purge thread.
[rank0]:2025-11-07 08:46:11,570 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank0_stage4.svg
[rank0]:	> Counts Sum: 622200, Total Sum: 650880 (95.59%), Ratio(%) per element: [96.12, 96.01, 95.9, 95.57, 94.8, 95.9, 96.01, 95.13, 94.57, 95.35, 95.46, 95.24, 95.68, 96.34, 95.24, 95.68, 95.79, 95.79]
[rank0]:2025-11-07 08:46:11,571 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-07 08:46:11,720 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251107_0846_thry_final1200_rank3.svg
[rank3]:> Batch Time: 319.65 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-07 08:46:11,764 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0846_stage3_final1200.svg
[rank3]:2025-11-07 08:46:11,867 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank3_stage3.svg
[rank3]:	> Counts Sum: 141560, Total Sum: 650880 (21.75%), Ratio(%) per element: [20.35, 23.11, 23.23, 21.68, 24.33, 20.68, 22.23, 20.46, 21.12, 21.9, 22.23, 21.12, 22.23, 21.46, 21.01, 21.68, 21.12, 21.46]
[rank3]:2025-11-07 08:46:11,909 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251107_0846_stage7_final1200.svg
[rank2]:2025-11-07 08:46:11,941 - INFO - Process group destroyed
[rank3]:2025-11-07 08:46:11,988 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251107_0846_rank3_stage7.svg
[rank3]:	> Counts Sum: 90640, Total Sum: 397760 (22.79%), Ratio(%) per element: [22.23, 21.9, 21.34, 23.11, 22.01, 23.0, 24.11, 23.78, 22.89, 22.67, 23.56]
[rank3]:2025-11-07 08:46:11,989 - INFO - Destroying the purge thread.
[rank1]:2025-11-07 08:46:11,970 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 23-24, summary, console lines 305-320
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.07229
[rank3]:wandb:               final/avg_loss 0.51805
[rank3]:wandb:             final/avg_mfu(%) 18.14685
[rank3]:wandb:             final/avg_tflops 60.21539
[rank3]:wandb:    final/avg_throughput(tps) 7906.21101
[rank3]:wandb:              final/grad_norm 0.09835
[rank3]:wandb:               final/max_loss 0.51805
[rank3]:wandb:                    grad_norm 0.09835
[rank3]:wandb: loss_metrics/global_avg_loss 0.51805
[rank3]:wandb: loss_metrics/global_max_loss 0.51805
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1107_Interleaved1F1B_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/igdm504j
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1107_Interleaved1F1B_fullrand7_dm1/20251107-0802/wandb/run-20251107_080255-igdm504j/logs
[rank3]:2025-11-07 08:46:13,443 - INFO - Process group destroyed
[rank0]:2025-11-07 08:46:13,571 - INFO - Training completed
[rank0]:2025-11-07 08:46:13,571 - INFO - Destroying the purge thread.
[rank0]:2025-11-07 08:46:13,958 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.3', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'norm', 'output'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1107_Interleaved1F1B_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1107_Interleaved1F1B_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1107_Interleaved1F1B_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1107_Interleaved1F1B_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1107_Interleaved1F1B_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1107_Interleaved1F1B_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1107_Interleaved1F1B_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
