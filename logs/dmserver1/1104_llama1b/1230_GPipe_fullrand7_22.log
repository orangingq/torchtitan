
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 14:03:30 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_GPipe_fullrand7_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-30 14:03:36,559 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank0]:2025-12-30 14:03:36,750 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank2]:2025-12-30 14:03:36,787 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-30 14:03:36,805 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank3]:2025-12-30 14:03:36,786 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 14:03:36,789 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 14:03:37,152 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 14:03:37,155 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 14:03:37,159 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 14:03:37,160 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-30 14:03:37,197 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 14:03:37,199 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-30 14:03:37,225 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 14:03:37,228 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 14:03:37,571 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 14:03:40,422 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-30 14:03:40,585 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 14:03:40,649 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 14:03:40,586 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 14:03:40,650 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 14:03:40,651 - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-12-30 14:03:40,582 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 14:03:40,649 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 14:03:40,687 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 14:03:40,688 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-30 14:03:40,679 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 14:03:40,679 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-30 14:03:40,678 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 14:03:40,678 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-30 14:03:40,904 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 14:03:40,904 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 14:03:40,905 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-30 14:03:40,909 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 14:03:40,909 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 14:03:40,909 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-30 14:03:40,908 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 14:03:40,909 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 14:03:40,910 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run jxwcj2ba
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_GPipe_fullrand7_22_dm1/20251230-1403/wandb/run-20251230_140341-jxwcj2ba
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_GPipe_fullrand7_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/jxwcj2ba
[rank3]:2025-12-30 14:03:42,992 - WandB logging enabled
[rank3]:2025-12-30 14:03:42,992 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 14:03:43,033 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 14:03:43,063 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 14:03:43,063 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-30 14:03:43,252 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 14:03:43,252 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 14:03:43,253 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-12-30 14:03:43,269 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_GPipe_fullrand7_22_dm1
[rank0]:2025-12-30 14:03:43,269 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 14:03:43,270 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 14:03:43,270 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-30 14:03:43,269 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-30 14:03:43,269 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-30 14:03:43,268 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 14:03:45,969 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-30 14:03:45,969 - Finished loading the checkpoint in 2.70 seconds.
[rank0]:2025-12-30 14:03:45,969 - Training starts at step 1
[rank1]:2025-12-30 14:03:51,444 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory: 12.75GiB(26.83%)  tps: 3,036  tflops: 23.73  mfu: 7.61%
[rank1]:2025-12-30 14:03:51,444 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-30 14:03:51,441 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory: 10.24GiB(21.56%)  tps: 3,037  tflops: 23.74  mfu: 7.61%
[rank2]:2025-12-30 14:03:51,441 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 14:03:51,451 -  step:  1  loss: 10.6088  grad_norm: 116.5368  memory: 24.19GiB(50.91%)  tps: 3,894  tflops: 30.44  mfu: 9.76%
[rank3]:2025-12-30 14:03:51,451 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 14:03:51,478 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory: 13.25GiB(27.89%)  tps: 3,026  tflops: 23.66  mfu: 7.58%
[rank0]:2025-12-30 14:03:51,478 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 14:05:50,022 - Avg. fwd time: 9.0378 / Avg. bwd time: 24.8877 / Avg. batch time: 562.9260 (ms) / GPU bubble ratio: 51.79%
[rank2]:2025-12-30 14:05:49,992 - Avg. fwd time: 6.9687 / Avg. bwd time: 19.2400 / Avg. batch time: 522.5415 (ms) / GPU bubble ratio: 59.88%
[rank3]:2025-12-30 14:05:49,967 - Avg. fwd time: 10.7357 / Avg. bwd time: 43.1086 / Avg. batch time: 490.4739 (ms) / GPU bubble ratio: 12.18%
[rank0]:2025-12-30 14:05:50,052 - Avg. fwd time: 8.1356 / Avg. bwd time: 25.0696 / Avg. batch time: 601.7887 (ms) / GPU bubble ratio: 55.86%
[rank0]:2025-12-30 14:07:49,885 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-30 14:07:54,791 - Avg. fwd time: 9.0599 / Avg. bwd time: 24.9905 / Avg. batch time: 565.6797 (ms) / GPU bubble ratio: 51.84%
[rank2]:2025-12-30 14:07:54,761 - Avg. fwd time: 6.9771 / Avg. bwd time: 19.3053 / Avg. batch time: 525.6280 (ms) / GPU bubble ratio: 60.00%
[rank3]:2025-12-30 14:07:54,736 - Avg. fwd time: 10.7718 / Avg. bwd time: 43.5106 / Avg. batch time: 493.8967 (ms) / GPU bubble ratio: 12.07%
[rank1]:2025-12-30 14:07:54,846 -  step: 50  loss: -8.0000  grad_norm: 12.6916  memory: 15.15GiB(31.89%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank0]:2025-12-30 14:07:54,821 - Avg. fwd time: 8.1688 / Avg. bwd time: 25.1450 / Avg. batch time: 604.2330 (ms) / GPU bubble ratio: 55.89%
[rank0]:2025-12-30 14:07:54,858 -  step: 50  loss: -8.0000  grad_norm: 12.6916  memory: 17.08GiB(35.95%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank3]:2025-12-30 14:07:54,855 -  step: 50  loss:  9.9146  grad_norm: 12.6916  memory: 26.98GiB(56.79%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank2]:2025-12-30 14:07:54,843 -  step: 50  loss: -8.0000  grad_norm: 12.6916  memory: 12.26GiB(25.80%)  tps: 6,597  tflops: 51.57  mfu: 16.53%
[rank3]:2025-12-30 14:08:39,407 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-30 14:09:29,206 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-30 14:09:29,535 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-12-30 14:09:48,208 - Avg. fwd time: 9.0637 / Avg. bwd time: 23.8764 / Avg. batch time: 550.0360 (ms) / GPU bubble ratio: 52.09%
[rank2]:2025-12-30 14:09:48,192 - Avg. fwd time: 6.9757 / Avg. bwd time: 18.4540 / Avg. batch time: 511.2462 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-12-30 14:09:48,213 - Avg. fwd time: 8.1730 / Avg. bwd time: 23.1578 / Avg. batch time: 586.4642 (ms) / GPU bubble ratio: 57.26%
[rank3]:2025-12-30 14:09:48,177 - Avg. fwd time: 10.7758 / Avg. bwd time: 41.8394 / Avg. batch time: 480.5126 (ms) / GPU bubble ratio: 12.40%
[rank3]:2025-12-30 14:10:00,450 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-30 14:10:00,809 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1410_max_batch_time.svg
[rank3]:			> Batch Time: 538.14 ms, GPU Bubble Ratio: 50.07%, 49.00%, 60.62%, 18.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  201-25-226ms   | [S0,MB1,B]  244-25-269ms   | [S0,MB2,B]  288-25-313ms   | [S0,MB3,B]  333-25-358ms   | [S0,MB4,B]  377-25-403ms   | [S0,MB5,B]  422-25-447ms   | [S0,MB6,B]  467-25-492ms   | [S0,MB7,B]  512-25-538ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  176-24-201ms   | [S1,MB1,B]  219-25-244ms   | [S1,MB2,B]  263-25-288ms   | [S1,MB3,B]  308-25-333ms   | [S1,MB4,B]  352-25-377ms   | [S1,MB5,B]  397-25-422ms   | [S1,MB6,B]  442-25-467ms   | [S1,MB7,B]  487-25-512ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  156-19-176ms   | [S2,MB1,B]  199-19-219ms   | [S2,MB2,B]  243-19-263ms   | [S2,MB3,B]  288-19-308ms   | [S2,MB4,B]  333-19-352ms   | [S2,MB5,B]  377-19-397ms   | [S2,MB6,B]  422-19-442ms   | [S2,MB7,B]  467-19-487ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-115ms   | [S3,MB0,B]  115-40-156ms   AFR(10):0.9655 | [S3,MB1,B]  156-43-199ms   AFR(10):0.9655 | [S3,MB2,B]  199-44-243ms   AFR(10):0.9655 | [S3,MB3,B]  243-44-288ms   AFR(10):0.9655 | [S3,MB4,B]  288-44-333ms   AFR(10):0.9655 | [S3,MB5,B]  333-44-377ms   AFR(10):0.9655 | [S3,MB6,B]  377-45-422ms   AFR(10):0.9655 | [S3,MB7,B]  422-45-467ms   AFR(10):0.9655
[rank3]:2025-12-30 14:10:00,939 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1410_min_batch_time.svg
[rank3]:			> Batch Time: 308.21 ms, GPU Bubble Ratio: 78.72%, 48.58%, 60.35%, 15.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  156-0-156ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB2,B]  200-0-200ms    | [S0,MB3,B]  221-0-221ms    | [S0,MB4,B]  243-0-243ms    | [S0,MB5,B]  264-0-264ms    | [S0,MB6,B]  286-0-286ms    | [S0,MB7,B]  308-0-308ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  145-10-156ms   | [S1,MB1,B]  167-10-177ms   | [S1,MB2,B]  189-10-200ms   | [S1,MB3,B]  210-10-221ms   | [S1,MB4,B]  232-10-243ms   | [S1,MB5,B]  254-10-264ms   | [S1,MB6,B]  275-10-286ms   | [S1,MB7,B]  297-10-308ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  137-8-145ms    | [S2,MB1,B]  158-8-167ms    | [S2,MB2,B]  181-8-189ms    | [S2,MB3,B]  202-8-210ms    | [S2,MB4,B]  224-8-232ms    | [S2,MB5,B]  245-8-254ms    | [S2,MB6,B]  267-8-275ms    | [S2,MB7,B]  289-8-297ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-115ms   | [S3,MB0,B]  115-21-137ms   AFR(10):0.9655 | [S3,MB1,B]  137-21-158ms   AFR(10):0.9655 | [S3,MB2,B]  158-22-181ms   AFR(10):0.9655 | [S3,MB3,B]  181-21-202ms   AFR(10):0.9655 | [S3,MB4,B]  202-21-224ms   AFR(10):0.9655 | [S3,MB5,B]  224-21-245ms   AFR(10):0.9655 | [S3,MB6,B]  245-21-267ms   AFR(10):0.9655 | [S3,MB7,B]  267-21-289ms   AFR(10):0.9655
[rank3]:2025-12-30 14:10:01,076 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1410_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 340.43 ms, GPU Bubble Ratio: 41.65%, 33.14%, 41.13%, 14.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  201-25-226ms   | [S0,MB1,B]  232-25-258ms   | [S0,MB2,B]  258-25-283ms   | [S0,MB3,B]  283-25-308ms   | [S0,MB4,B]  308-10-319ms   | [S0,MB5,B]  319-21-340ms   | [S0,MB6,B]  340-0-340ms    | [S0,MB7,B]  340-0-340ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  176-24-201ms   | [S1,MB1,B]  210-22-232ms   | [S1,MB2,B]  232-25-257ms   | [S1,MB3,B]  257-25-283ms   | [S1,MB4,B]  283-14-297ms   | [S1,MB5,B]  297-21-319ms   | [S1,MB6,B]  319-10-329ms   | [S1,MB7,B]  329-10-340ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  156-19-176ms   | [S2,MB1,B]  191-19-210ms   | [S2,MB2,B]  213-19-232ms   | [S2,MB3,B]  234-19-254ms   | [S2,MB4,B]  256-19-275ms   | [S2,MB5,B]  278-19-297ms   | [S2,MB6,B]  299-19-319ms   | [S2,MB7,B]  321-8-329ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-115ms   | [S3,MB0,B]  115-40-156ms   AFR(10):0.9655 | [S3,MB1,B]  156-34-191ms   AFR(10):0.9655 | [S3,MB2,B]  191-22-213ms   AFR(10):0.9655 | [S3,MB3,B]  213-21-234ms   AFR(10):0.9655 | [S3,MB4,B]  234-21-256ms   AFR(10):0.9655 | [S3,MB5,B]  256-21-278ms   AFR(10):0.9655 | [S3,MB6,B]  278-21-299ms   AFR(10):0.9655 | [S3,MB7,B]  299-21-321ms   AFR(10):0.9655
[rank3]:2025-12-30 14:10:01,077 - 	> Batch Time: 340.43 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.37)
[rank3]:2025-12-30 14:11:23,690 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.10(0.13)/0.40, [MB2] 0.28(0.33)/1.00, [MB3] 0.28(0.33)/1.00, [MB4] 0.28(0.33)/1.00, [MB5] 0.28(0.33)/1.00, [MB6] 0.28(0.33)/1.00, [MB7] 0.28(0.33)/1.00
[rank2]:2025-12-30 14:11:23,858 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.01)/0.02, [MB7] 0.28(0.33)/1.00
[rank1]:2025-12-30 14:11:23,879 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.04(0.07)/0.20, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.20(0.25)/0.75, [MB5] 0.07(0.09)/0.26, [MB6] 0.27(0.33)/1.00, [MB7] 0.27(0.33)/1.00
[rank0]:2025-12-30 14:11:23,900 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 14:11:23,901 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.16(0.20)/0.60, [MB5] 0.05(0.05)/0.16, [MB6] 0.27(0.33)/1.00, [MB7] 0.27(0.33)/1.00
[rank3]:2025-12-30 14:11:28,285 - Avg. fwd time: 10.7703 / Avg. bwd time: 38.9957 / Avg. batch time: 457.7023 (ms) / GPU bubble ratio: 13.02%
[rank2]:2025-12-30 14:11:28,307 - Avg. fwd time: 6.9739 / Avg. bwd time: 18.1404 / Avg. batch time: 490.6484 (ms) / GPU bubble ratio: 59.05%
[rank1]:2025-12-30 14:11:28,334 - Avg. fwd time: 9.0714 / Avg. bwd time: 22.9451 / Avg. batch time: 528.4300 (ms) / GPU bubble ratio: 51.53%
[rank0]:2025-12-30 14:11:28,357 - Avg. fwd time: 8.1699 / Avg. bwd time: 21.6210 / Avg. batch time: 560.9486 (ms) / GPU bubble ratio: 57.51%
[rank2]:2025-12-30 14:11:28,379 -  step: 100  loss: -8.0000  grad_norm:  6.3433  memory: 12.26GiB(25.80%)  tps: 7,673  tflops: 59.98  mfu: 19.22%
[rank2]:2025-12-30 14:11:28,467 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1411_stage2_step100.svg
[rank1]:2025-12-30 14:11:28,382 -  step: 100  loss: -8.0000  grad_norm:  6.3433  memory: 15.15GiB(31.89%)  tps: 7,673  tflops: 59.98  mfu: 19.22%
[rank1]:2025-12-30 14:11:28,455 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1411_stage1_step100.svg
[rank0]:2025-12-30 14:11:28,393 -  step: 100  loss: -8.0000  grad_norm:  6.3433  memory: 17.08GiB(35.95%)  tps: 7,673  tflops: 59.98  mfu: 19.23%
[rank0]:2025-12-30 14:11:28,454 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1411_stage0_step100.svg
[rank3]:2025-12-30 14:11:28,392 -  step: 100  loss:  8.6401  grad_norm:  6.3433  memory: 26.98GiB(56.79%)  tps: 7,673  tflops: 59.98  mfu: 19.23%
[rank3]:2025-12-30 14:11:28,539 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1411_step100_rank3.svg
[rank3]:			> Batch Time: 549.53 ms, GPU Bubble Ratio: 54.26%, 52.08%, 61.56%, 27.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  270-25-296ms   | [S0,MB1,B]  311-25-337ms   | [S0,MB2,B]  353-25-378ms   | [S0,MB3,B]  386-25-411ms   | [S0,MB4,B]  418-18-436ms   | [S0,MB5,B]  460-24-484ms   | [S0,MB6,B]  495-23-518ms   | [S0,MB7,B]  531-18-549ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  242-24-267ms   | [S1,MB1,B]  284-24-308ms   | [S1,MB2,B]  324-25-349ms   | [S1,MB3,B]  356-25-382ms   | [S1,MB4,B]  391-24-415ms   | [S1,MB5,B]  432-24-457ms   | [S1,MB6,B]  471-21-492ms   | [S1,MB7,B]  509-20-529ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-239ms   | [S2,MB1,B]  262-19-281ms   | [S2,MB2,B]  301-19-321ms   | [S2,MB3,B]  333-19-352ms   | [S2,MB4,B]  368-19-388ms   | [S2,MB5,B]  409-19-429ms   | [S2,MB6,B]  448-19-467ms   | [S2,MB7,B]  487-18-506ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  213-41-255ms   | [S3,MB2,B]  255-40-295ms   | [S3,MB3,B]  294-32-326ms   | [S3,MB4,B]  326-32-358ms   | [S3,MB5,B]  361-40-402ms   | [S3,MB6,B]  402-41-444ms   | [S3,MB7,B]  440-42-483ms  
[rank3]:2025-12-30 14:11:28,583 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1411_stage3_step100.svg
[rank2]:2025-12-30 14:11:28,630 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1411_rank2_stage2.svg
[rank2]:	> Counts Sum: 26800, Total Sum: 69120 (38.77%), Ratio(%) per element: [37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 45.83, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5]
[rank1]:2025-12-30 14:11:28,611 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1411_rank1_stage1.svg
[rank1]:	> Counts Sum: 43440, Total Sum: 86400 (50.28%), Ratio(%) per element: [50.0, 58.33, 50.0, 50.0, 45.83, 45.83, 50.0, 50.0, 50.0, 50.0, 45.83, 54.16, 45.83, 54.16, 45.83, 54.16, 41.66, 54.16, 41.66, 50.0, 50.0, 54.16, 45.83, 58.33, 54.16, 45.83, 62.5, 54.16, 45.83, 50.0, 54.16, 54.16, 54.16, 54.16, 45.83, 58.33, 50.0, 45.83, 50.0, 45.83, 45.83, 50.0, 54.16, 41.66, 50.0]
[rank0]:2025-12-30 14:11:28,618 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1411_rank0_stage0.svg
[rank0]:	> Counts Sum: 34080, Total Sum: 71040 (47.97%), Ratio(%) per element: [54.16, 54.16, 50.0, 45.83, 41.66, 50.0, 50.0, 54.16, 54.16, 54.16, 50.0, 50.0, 41.66, 54.16, 50.0, 50.0, 50.0, 50.0, 54.16, 45.83, 50.0, 41.66, 50.0, 45.83, 45.83, 41.66, 54.16, 41.66, 45.83, 50.0, 45.83, 41.66, 45.83, 45.83, 41.66, 41.66, 41.66]
[rank2]:2025-12-30 14:11:28,724 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1411_stage2.svg
[rank1]:2025-12-30 14:11:28,705 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1411_stage1.svg
[rank0]:2025-12-30 14:11:28,712 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1411_stage0.svg
[rank3]:2025-12-30 14:11:28,721 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1411_rank3_stage3.svg
[rank3]:	> Counts Sum: 36880, Total Sum: 55680 (66.24%), Ratio(%) per element: [70.83, 62.5, 58.33, 62.5, 62.5, 58.33, 66.66, 66.66, 70.83, 62.5, 66.66, 70.83, 79.16, 70.83, 58.33, 75.0, 58.33, 70.83, 70.83, 66.66, 58.33, 58.33, 62.5, 75.0, 66.66, 70.83, 62.5, 66.66, 70.83]
[rank3]:2025-12-30 14:11:28,815 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1411_stage3.svg
[rank2]:2025-12-30 14:13:17,696 - Avg. fwd time: 6.9728 / Avg. bwd time: 18.3451 / Avg. batch time: 485.1586 (ms) / GPU bubble ratio: 58.25%
[rank3]:2025-12-30 14:13:17,671 - Avg. fwd time: 10.7635 / Avg. bwd time: 38.4292 / Avg. batch time: 453.1064 (ms) / GPU bubble ratio: 13.15%
[rank1]:2025-12-30 14:13:17,722 - Avg. fwd time: 9.0745 / Avg. bwd time: 23.0125 / Avg. batch time: 522.3512 (ms) / GPU bubble ratio: 50.86%
[rank0]:2025-12-30 14:13:17,746 - Avg. fwd time: 8.1837 / Avg. bwd time: 21.8051 / Avg. batch time: 554.1131 (ms) / GPU bubble ratio: 56.70%
[rank3]:2025-12-30 14:15:00,202 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.27)/0.40, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-30 14:15:00,409 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.01)/0.02, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-30 14:15:00,426 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.11(0.14)/0.20, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.44(0.50)/0.75, [MB5] 0.16(0.18)/0.26, [MB6] 0.60(0.67)/1.00, [MB7] 0.60(0.67)/1.00
[rank0]:2025-12-30 14:15:00,444 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-30 14:15:00,446 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.35(0.40)/0.60, [MB5] 0.08(0.10)/0.16, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank3]:2025-12-30 14:15:04,445 - Avg. fwd time: 10.7606 / Avg. bwd time: 37.8872 / Avg. batch time: 448.7384 (ms) / GPU bubble ratio: 13.27%
[rank2]:2025-12-30 14:15:04,466 - Avg. fwd time: 6.9710 / Avg. bwd time: 18.4609 / Avg. batch time: 479.9454 (ms) / GPU bubble ratio: 57.61%
[rank2]:2025-12-30 14:15:04,528 -  step: 150  loss: -8.0000  grad_norm: 18.8700  memory: 12.26GiB(25.80%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank1]:2025-12-30 14:15:04,489 - Avg. fwd time: 9.0777 / Avg. bwd time: 22.8815 / Avg. batch time: 516.7100 (ms) / GPU bubble ratio: 50.52%
[rank1]:2025-12-30 14:15:04,532 -  step: 150  loss: -8.0000  grad_norm: 18.8700  memory: 15.15GiB(31.89%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank0]:2025-12-30 14:15:04,506 - Avg. fwd time: 8.1925 / Avg. bwd time: 21.7570 / Avg. batch time: 547.6242 (ms) / GPU bubble ratio: 56.25%
[rank0]:2025-12-30 14:15:04,543 -  step: 150  loss: -8.0000  grad_norm: 18.8700  memory: 17.08GiB(35.95%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank3]:2025-12-30 14:15:04,541 -  step: 150  loss:  3.8602  grad_norm: 18.8700  memory: 26.98GiB(56.79%)  tps: 7,580  tflops: 59.26  mfu: 18.99%
[rank2]:2025-12-30 14:16:44,965 - Avg. fwd time: 6.9702 / Avg. bwd time: 18.4887 / Avg. batch time: 471.3230 (ms) / GPU bubble ratio: 56.79%
[rank1]:2025-12-30 14:16:44,992 - Avg. fwd time: 9.0811 / Avg. bwd time: 22.7245 / Avg. batch time: 508.4490 (ms) / GPU bubble ratio: 49.96%
[rank3]:2025-12-30 14:16:44,945 - Avg. fwd time: 10.7626 / Avg. bwd time: 36.8200 / Avg. batch time: 440.2133 (ms) / GPU bubble ratio: 13.53%
[rank0]:2025-12-30 14:16:45,010 - Avg. fwd time: 8.2012 / Avg. bwd time: 21.6367 / Avg. batch time: 538.4678 (ms) / GPU bubble ratio: 55.67%
[rank3]:2025-12-30 14:18:18,544 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.38(0.40)/0.40, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-30 14:18:18,737 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.03(0.02)/0.02, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-30 14:18:18,752 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.20(0.20)/0.20, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.69(0.75)/0.75, [MB5] 0.24(0.26)/0.26, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-30 14:18:18,761 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 14:18:18,761 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.57(0.60)/0.60, [MB5] 0.14(0.16)/0.16, [MB6] 0.95(1.00)/1.00, [MB7] 0.95(1.00)/1.00
[rank2]:2025-12-30 14:18:22,506 - Avg. fwd time: 6.9689 / Avg. bwd time: 18.4937 / Avg. batch time: 463.6151 (ms) / GPU bubble ratio: 56.06%
[rank3]:2025-12-30 14:18:22,463 - Avg. fwd time: 10.7621 / Avg. bwd time: 35.8372 / Avg. batch time: 432.3503 (ms) / GPU bubble ratio: 13.77%
[rank1]:2025-12-30 14:18:22,533 - Avg. fwd time: 9.0828 / Avg. bwd time: 22.4757 / Avg. batch time: 501.2078 (ms) / GPU bubble ratio: 49.63%
[rank1]:2025-12-30 14:18:22,564 -  step: 200  loss: -8.0000  grad_norm:  1.6625  memory: 15.15GiB(31.89%)  tps: 8,273  tflops: 64.68  mfu: 20.73%
[rank1]:2025-12-30 14:18:22,624 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1418_stage1_step200.svg
[rank2]:2025-12-30 14:18:22,560 -  step: 200  loss: -8.0000  grad_norm:  1.6625  memory: 12.26GiB(25.80%)  tps: 8,273  tflops: 64.68  mfu: 20.73%
[rank2]:2025-12-30 14:18:22,625 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1418_stage2_step200.svg
[rank3]:2025-12-30 14:18:22,573 -  step: 200  loss:  1.4343  grad_norm:  1.6625  memory: 26.98GiB(56.79%)  tps: 8,274  tflops: 64.68  mfu: 20.73%
[rank0]:2025-12-30 14:18:22,539 - Avg. fwd time: 8.2019 / Avg. bwd time: 21.3224 / Avg. batch time: 529.8270 (ms) / GPU bubble ratio: 55.42%
[rank0]:2025-12-30 14:18:22,575 -  step: 200  loss: -8.0000  grad_norm:  1.6625  memory: 17.08GiB(35.95%)  tps: 8,273  tflops: 64.68  mfu: 20.73%
[rank0]:2025-12-30 14:18:22,628 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1418_stage0_step200.svg
[rank3]:2025-12-30 14:18:22,713 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1418_step200_rank3.svg
[rank3]:			> Batch Time: 462.68 ms, GPU Bubble Ratio: 52.61%, 49.45%, 56.07%, 31.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  273-25-299ms   | [S0,MB1,B]  301-25-326ms   | [S0,MB2,B]  335-25-361ms   | [S0,MB3,B]  365-25-391ms   | [S0,MB4,B]  392-21-414ms   | [S0,MB5,B]  417-23-441ms   | [S0,MB6,B]  442-2-444ms    | [S0,MB7,B]  458-3-462ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  274-22-297ms   | [S1,MB2,B]  306-25-332ms   | [S1,MB3,B]  335-26-361ms   | [S1,MB4,B]  365-15-381ms   | [S1,MB5,B]  392-20-413ms   | [S1,MB6,B]  417-12-429ms   | [S1,MB7,B]  442-12-455ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  222-19-242ms   | [S2,MB1,B]  250-19-270ms   | [S2,MB2,B]  283-19-303ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  335-20-356ms   | [S2,MB5,B]  367-20-388ms   | [S2,MB6,B]  393-19-413ms   | [S2,MB7,B]  416-8-425ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  175-40-215ms   | [S3,MB1,B]  215-28-244ms   | [S3,MB2,B]  244-33-277ms   | [S3,MB3,B]  277-23-300ms   | [S3,MB4,B]  301-23-324ms   | [S3,MB5,B]  324-33-358ms   | [S3,MB6,B]  358-23-381ms   | [S3,MB7,B]  382-23-406ms  
[rank1]:2025-12-30 14:18:22,768 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1418_rank1_stage1.svg
[rank1]:	> Counts Sum: 116640, Total Sum: 374400 (31.15%), Ratio(%) per element: [29.8, 35.57, 31.73, 30.76, 26.92, 32.69, 29.8, 29.8, 26.92, 32.69, 27.88, 27.88, 31.73, 37.5, 37.5, 35.57, 25.96, 31.73, 30.76, 31.73, 26.92, 31.73, 30.76, 30.76, 29.8, 34.61, 30.76, 30.76, 27.88, 32.69, 30.76, 28.84, 34.61, 29.8, 30.76, 32.69, 27.88, 31.73, 36.53, 31.73, 30.76, 27.88, 35.57, 28.84, 31.73]
[rank2]:2025-12-30 14:18:22,774 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1418_rank2_stage2.svg
[rank2]:	> Counts Sum: 45360, Total Sum: 299520 (15.14%), Ratio(%) per element: [17.3, 12.5, 17.3, 16.34, 12.5, 14.42, 15.38, 16.34, 16.34, 15.38, 15.38, 15.38, 14.42, 14.42, 14.42, 14.42, 16.34, 16.34, 16.34, 15.38, 15.38, 16.34, 14.42, 14.42, 13.46, 16.34, 13.46, 12.5, 13.46, 13.46, 16.34, 14.42, 16.34, 17.3, 15.38, 15.38]
[rank3]:2025-12-30 14:18:22,758 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1418_stage3_step200.svg
[rank0]:2025-12-30 14:18:22,784 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1418_rank0_stage0.svg
[rank0]:	> Counts Sum: 85760, Total Sum: 307840 (27.86%), Ratio(%) per element: [34.61, 38.46, 32.69, 29.8, 25.96, 35.57, 31.73, 33.65, 33.65, 35.57, 33.65, 29.8, 28.84, 32.69, 32.69, 30.76, 30.76, 31.73, 32.69, 32.69, 28.84, 27.88, 27.88, 25.0, 24.03, 24.03, 22.11, 26.92, 20.19, 25.96, 19.23, 19.23, 14.42, 20.19, 19.23, 23.07, 14.42]
[rank3]:2025-12-30 14:18:22,893 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1418_rank3_stage3.svg
[rank3]:	> Counts Sum: 130640, Total Sum: 241280 (54.14%), Ratio(%) per element: [54.8, 51.92, 52.88, 50.96, 56.73, 52.88, 48.07, 61.53, 56.73, 47.11, 50.96, 50.96, 52.88, 52.88, 50.96, 54.8, 50.0, 61.53, 61.53, 54.8, 57.69, 52.88, 55.76, 50.96, 55.76, 61.53, 50.96, 54.8, 54.8]
[rank2]:2025-12-30 14:18:23,118 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1418_stage2.svg
[rank1]:2025-12-30 14:18:23,110 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1418_stage1.svg
[rank0]:2025-12-30 14:18:23,137 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1418_stage0.svg
[rank3]:2025-12-30 14:18:23,239 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1418_stage3.svg
[rank3]:2025-12-30 14:19:57,121 - Avg. fwd time: 10.7612 / Avg. bwd time: 34.6946 / Avg. batch time: 423.2041 (ms) / GPU bubble ratio: 14.07%
[rank2]:2025-12-30 14:19:57,164 - Avg. fwd time: 6.9679 / Avg. bwd time: 18.4956 / Avg. batch time: 456.8386 (ms) / GPU bubble ratio: 55.41%
[rank0]:2025-12-30 14:19:57,196 - Avg. fwd time: 8.1992 / Avg. bwd time: 20.8441 / Avg. batch time: 521.2139 (ms) / GPU bubble ratio: 55.42%
[rank1]:2025-12-30 14:19:57,189 - Avg. fwd time: 9.0859 / Avg. bwd time: 22.2354 / Avg. batch time: 494.3302 (ms) / GPU bubble ratio: 49.31%
[rank3]:2025-12-30 14:21:27,023 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-30 14:21:27,204 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.03(0.02)/0.02, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-30 14:21:27,222 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 14:21:27,223 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.59(0.60)/0.60, [MB5] 0.16(0.16)/0.16, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-30 14:21:27,218 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.20(0.20)/0.20, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.76(0.75)/0.75, [MB5] 0.27(0.26)/0.26, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-30 14:21:30,849 - Avg. fwd time: 10.7590 / Avg. bwd time: 33.7681 / Avg. batch time: 415.7749 (ms) / GPU bubble ratio: 14.32%
[rank2]:2025-12-30 14:21:30,896 - Avg. fwd time: 6.9666 / Avg. bwd time: 18.5019 / Avg. batch time: 451.3202 (ms) / GPU bubble ratio: 54.86%
[rank2]:2025-12-30 14:21:30,947 -  step: 250  loss: -8.0000  grad_norm:  0.4127  memory: 12.26GiB(25.80%)  tps: 8,697  tflops: 67.99  mfu: 21.79%
[rank0]:2025-12-30 14:21:30,925 - Avg. fwd time: 8.1973 / Avg. bwd time: 20.4557 / Avg. batch time: 514.1520 (ms) / GPU bubble ratio: 55.42%
[rank0]:2025-12-30 14:21:30,961 -  step: 250  loss: -8.0000  grad_norm:  0.4127  memory: 17.08GiB(35.95%)  tps: 8,697  tflops: 67.99  mfu: 21.79%
[rank3]:2025-12-30 14:21:30,960 -  step: 250  loss:  0.5133  grad_norm:  0.4127  memory: 26.98GiB(56.79%)  tps: 8,697  tflops: 67.99  mfu: 21.79%
[rank1]:2025-12-30 14:21:30,918 - Avg. fwd time: 9.0882 / Avg. bwd time: 22.0441 / Avg. batch time: 488.6558 (ms) / GPU bubble ratio: 49.03%
[rank1]:2025-12-30 14:21:30,950 -  step: 250  loss: -8.0000  grad_norm:  0.4127  memory: 15.15GiB(31.89%)  tps: 8,697  tflops: 67.99  mfu: 21.79%
[rank3]:2025-12-30 14:23:05,120 - Avg. fwd time: 10.7574 / Avg. bwd time: 33.0236 / Avg. batch time: 409.8050 (ms) / GPU bubble ratio: 14.53%
[rank2]:2025-12-30 14:23:05,166 - Avg. fwd time: 6.9658 / Avg. bwd time: 18.5130 / Avg. batch time: 446.9942 (ms) / GPU bubble ratio: 54.40%
[rank1]:2025-12-30 14:23:05,188 - Avg. fwd time: 9.0903 / Avg. bwd time: 21.9089 / Avg. batch time: 484.2212 (ms) / GPU bubble ratio: 48.79%
[rank0]:2025-12-30 14:23:05,195 - Avg. fwd time: 8.1958 / Avg. bwd time: 20.1857 / Avg. batch time: 508.5813 (ms) / GPU bubble ratio: 55.36%
[rank3]:2025-12-30 14:24:36,243 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-30 14:24:36,454 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 14:24:36,455 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.59(0.60)/0.60, [MB5] 0.16(0.16)/0.16, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-30 14:24:36,450 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.20(0.20)/0.20, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.76(0.75)/0.75, [MB5] 0.27(0.26)/0.26, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-30 14:24:36,436 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.03(0.02)/0.02, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-30 14:24:40,178 - Avg. fwd time: 10.7565 / Avg. bwd time: 32.4522 / Avg. batch time: 405.2271 (ms) / GPU bubble ratio: 14.70%
[rank2]:2025-12-30 14:24:40,220 - Avg. fwd time: 6.9651 / Avg. bwd time: 18.5191 / Avg. batch time: 443.4974 (ms) / GPU bubble ratio: 54.03%
[rank0]:2025-12-30 14:24:40,254 - Avg. fwd time: 8.1954 / Avg. bwd time: 19.9627 / Avg. batch time: 504.2785 (ms) / GPU bubble ratio: 55.33%
[rank0]:2025-12-30 14:24:40,290 -  step: 300  loss: -8.0000  grad_norm:  0.2361  memory: 17.08GiB(35.95%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank1]:2025-12-30 14:24:40,246 - Avg. fwd time: 9.0912 / Avg. bwd time: 21.7489 / Avg. batch time: 480.8656 (ms) / GPU bubble ratio: 48.69%
[rank1]:2025-12-30 14:24:40,279 -  step: 300  loss: -8.0000  grad_norm:  0.2361  memory: 15.15GiB(31.89%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank3]:2025-12-30 14:24:40,288 -  step: 300  loss:  0.3029  grad_norm:  0.2361  memory: 26.98GiB(56.79%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank2]:2025-12-30 14:24:40,275 -  step: 300  loss: -8.0000  grad_norm:  0.2361  memory: 12.26GiB(25.80%)  tps: 8,654  tflops: 67.65  mfu: 21.68%
[rank0]:2025-12-30 14:24:40,348 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1424_stage0_step300.svg
[rank1]:2025-12-30 14:24:40,338 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1424_stage1_step300.svg
[rank2]:2025-12-30 14:24:40,345 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1424_stage2_step300.svg
[rank0]:2025-12-30 14:24:40,504 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1424_rank0_stage0.svg
[rank0]:	> Counts Sum: 167360, Total Sum: 544640 (30.73%), Ratio(%) per element: [36.95, 39.67, 34.23, 34.78, 31.52, 36.41, 34.23, 34.78, 35.86, 35.32, 34.78, 35.32, 31.52, 36.41, 34.78, 32.6, 33.15, 32.06, 34.23, 33.15, 29.34, 29.89, 31.52, 28.8, 29.34, 28.26, 26.63, 28.26, 24.45, 28.8, 26.08, 22.82, 20.1, 23.91, 22.28, 25.0, 19.56]
[rank1]:2025-12-30 14:24:40,482 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1424_rank1_stage1.svg
[rank1]:	> Counts Sum: 232640, Total Sum: 662400 (35.12%), Ratio(%) per element: [35.32, 36.41, 34.23, 36.41, 34.23, 36.41, 32.6, 33.69, 33.15, 37.5, 34.23, 33.69, 35.32, 41.3, 39.13, 36.41, 32.6, 35.32, 34.23, 36.41, 33.69, 32.6, 36.41, 34.23, 34.23, 38.04, 34.23, 33.15, 33.69, 35.32, 35.86, 34.78, 35.86, 33.69, 35.86, 36.41, 33.15, 34.78, 40.21, 34.23, 32.6, 32.6, 38.04, 33.15, 34.78]
[rank3]:2025-12-30 14:24:40,430 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1424_step300_rank3.svg
[rank3]:			> Batch Time: 458.75 ms, GPU Bubble Ratio: 55.32%, 49.29%, 55.46%, 35.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  307-25-332ms   | [S0,MB2,B]  336-25-362ms   | [S0,MB3,B]  366-25-392ms   | [S0,MB4,B]  394-13-407ms   | [S0,MB5,B]  419-23-442ms   | [S0,MB6,B]  444-0-444ms    | [S0,MB7,B]  458-0-458ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  282-21-303ms   | [S1,MB2,B]  307-25-333ms   | [S1,MB3,B]  336-26-363ms   | [S1,MB4,B]  366-16-383ms   | [S1,MB5,B]  394-21-415ms   | [S1,MB6,B]  418-11-430ms   | [S1,MB7,B]  444-11-455ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  283-20-304ms   | [S2,MB3,B]  307-20-328ms   | [S2,MB4,B]  336-20-356ms   | [S2,MB5,B]  368-20-388ms   | [S2,MB6,B]  393-19-413ms   | [S2,MB7,B]  418-9-427ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  252-22-274ms   | [S3,MB3,B]  274-21-296ms   | [S3,MB4,B]  296-22-319ms   | [S3,MB5,B]  318-22-341ms   | [S3,MB6,B]  341-22-363ms   | [S3,MB7,B]  363-22-385ms  
[rank3]:2025-12-30 14:24:40,474 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1424_stage3_step300.svg
[rank2]:2025-12-30 14:24:40,495 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1424_rank2_stage2.svg
[rank2]:	> Counts Sum: 74960, Total Sum: 529920 (14.15%), Ratio(%) per element: [15.21, 13.04, 15.21, 15.21, 12.5, 13.58, 14.67, 15.21, 14.67, 14.13, 14.13, 14.13, 13.58, 13.58, 14.13, 13.58, 14.67, 14.67, 14.67, 14.13, 14.67, 14.67, 13.58, 13.58, 13.04, 14.67, 13.58, 13.04, 13.58, 13.04, 15.21, 13.58, 14.67, 15.21, 14.13, 14.13]
[rank3]:2025-12-30 14:24:40,612 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1424_rank3_stage3.svg
[rank3]:	> Counts Sum: 279440, Total Sum: 426880 (65.46%), Ratio(%) per element: [65.76, 66.84, 65.21, 64.13, 67.39, 65.21, 61.41, 70.1, 66.3, 60.86, 63.04, 63.58, 64.13, 65.76, 62.5, 65.76, 61.41, 69.56, 70.1, 64.67, 67.93, 63.58, 67.39, 64.13, 64.67, 71.19, 63.58, 64.67, 67.39]
[rank1]:2025-12-30 14:24:41,087 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1424_stage1.svg
[rank2]:2025-12-30 14:24:41,093 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1424_stage2.svg
[rank0]:2025-12-30 14:24:41,151 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1424_stage0.svg
[rank3]:2025-12-30 14:24:41,215 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1424_stage3.svg
[rank3]:2025-12-30 14:26:16,332 - Avg. fwd time: 10.7508 / Avg. bwd time: 31.9684 / Avg. batch time: 401.3072 (ms) / GPU bubble ratio: 14.84%
[rank0]:2025-12-30 14:26:16,413 - Avg. fwd time: 8.1945 / Avg. bwd time: 19.7668 / Avg. batch time: 500.7671 (ms) / GPU bubble ratio: 55.33%
[rank2]:2025-12-30 14:26:16,378 - Avg. fwd time: 6.9640 / Avg. bwd time: 18.5181 / Avg. batch time: 440.6785 (ms) / GPU bubble ratio: 53.74%
[rank1]:2025-12-30 14:26:16,404 - Avg. fwd time: 9.0917 / Avg. bwd time: 21.6283 / Avg. batch time: 478.1565 (ms) / GPU bubble ratio: 48.60%
[rank0]:2025-12-30 14:27:46,178 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-30 14:27:49,971 - Avg. fwd time: 9.0918 / Avg. bwd time: 21.5166 / Avg. batch time: 475.1926 (ms) / GPU bubble ratio: 48.47%
[rank3]:2025-12-30 14:27:49,911 - Avg. fwd time: 10.7459 / Avg. bwd time: 31.4695 / Avg. batch time: 397.2750 (ms) / GPU bubble ratio: 14.99%
[rank2]:2025-12-30 14:27:49,949 - Avg. fwd time: 6.9632 / Avg. bwd time: 18.5176 / Avg. batch time: 437.7145 (ms) / GPU bubble ratio: 53.43%
[rank1]:2025-12-30 14:27:50,005 -  step: 350  loss: -8.0000  grad_norm:  0.1079  memory: 15.15GiB(31.89%)  tps: 8,636  tflops: 67.51  mfu: 21.64%
[rank0]:2025-12-30 14:27:49,979 - Avg. fwd time: 8.1941 / Avg. bwd time: 19.5879 / Avg. batch time: 497.1147 (ms) / GPU bubble ratio: 55.29%
[rank0]:2025-12-30 14:27:50,016 -  step: 350  loss: -8.0000  grad_norm:  0.1079  memory: 17.08GiB(35.95%)  tps: 8,636  tflops: 67.51  mfu: 21.64%
[rank3]:2025-12-30 14:27:50,014 -  step: 350  loss:  0.2323  grad_norm:  0.1079  memory: 26.98GiB(56.79%)  tps: 8,636  tflops: 67.51  mfu: 21.64%
[rank2]:2025-12-30 14:27:50,001 -  step: 350  loss: -8.0000  grad_norm:  0.1079  memory: 12.26GiB(25.80%)  tps: 8,636  tflops: 67.51  mfu: 21.64%
[rank2]:2025-12-30 14:29:25,341 - Avg. fwd time: 6.9630 / Avg. bwd time: 18.5170 / Avg. batch time: 435.7417 (ms) / GPU bubble ratio: 53.22%
[rank0]:2025-12-30 14:29:25,374 - Avg. fwd time: 8.1950 / Avg. bwd time: 19.4142 / Avg. batch time: 494.5232 (ms) / GPU bubble ratio: 55.34%
[rank1]:2025-12-30 14:29:25,366 - Avg. fwd time: 9.0928 / Avg. bwd time: 21.4199 / Avg. batch time: 473.1958 (ms) / GPU bubble ratio: 48.41%
[rank3]:2025-12-30 14:29:25,306 - Avg. fwd time: 10.7440 / Avg. bwd time: 31.1406 / Avg. batch time: 394.6276 (ms) / GPU bubble ratio: 15.09%
[rank0]:2025-12-30 14:30:56,682 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 14:31:00,415 - Avg. fwd time: 10.7425 / Avg. bwd time: 30.8246 / Avg. batch time: 392.0863 (ms) / GPU bubble ratio: 15.19%
[rank0]:2025-12-30 14:31:00,486 - Avg. fwd time: 8.1961 / Avg. bwd time: 19.2914 / Avg. batch time: 492.1948 (ms) / GPU bubble ratio: 55.32%
[rank0]:2025-12-30 14:31:00,523 -  step: 400  loss: -8.0000  grad_norm:  0.1136  memory: 17.08GiB(35.95%)  tps: 8,600  tflops: 67.23  mfu: 21.55%
[rank2]:2025-12-30 14:31:00,450 - Avg. fwd time: 6.9630 / Avg. bwd time: 18.5159 / Avg. batch time: 433.8712 (ms) / GPU bubble ratio: 53.02%
[rank2]:2025-12-30 14:31:00,508 -  step: 400  loss: -8.0000  grad_norm:  0.1136  memory: 12.26GiB(25.80%)  tps: 8,600  tflops: 67.23  mfu: 21.55%
[rank1]:2025-12-30 14:31:00,478 - Avg. fwd time: 9.0936 / Avg. bwd time: 21.3450 / Avg. batch time: 471.3860 (ms) / GPU bubble ratio: 48.34%
[rank1]:2025-12-30 14:31:00,512 -  step: 400  loss: -8.0000  grad_norm:  0.1136  memory: 15.15GiB(31.89%)  tps: 8,600  tflops: 67.23  mfu: 21.55%
[rank3]:2025-12-30 14:31:00,521 -  step: 400  loss:  0.2142  grad_norm:  0.1136  memory: 26.98GiB(56.79%)  tps: 8,600  tflops: 67.23  mfu: 21.55%
[rank0]:2025-12-30 14:31:00,575 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1431_stage0_step400.svg
[rank2]:2025-12-30 14:31:00,575 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1431_stage2_step400.svg
[rank1]:2025-12-30 14:31:00,575 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1431_stage1_step400.svg
[rank3]:2025-12-30 14:31:00,663 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1431_step400_rank3.svg
[rank3]:			> Batch Time: 460.00 ms, GPU Bubble Ratio: 55.31%, 49.18%, 55.60%, 34.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  308-25-333ms   | [S0,MB2,B]  337-25-363ms   | [S0,MB3,B]  367-25-393ms   | [S0,MB4,B]  394-14-409ms   | [S0,MB5,B]  420-22-443ms   | [S0,MB6,B]  445-0-445ms    | [S0,MB7,B]  460-0-460ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  283-21-304ms   | [S1,MB2,B]  308-25-334ms   | [S1,MB3,B]  337-26-363ms   | [S1,MB4,B]  367-17-385ms   | [S1,MB5,B]  394-22-417ms   | [S1,MB6,B]  420-11-431ms   | [S1,MB7,B]  444-11-456ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  260-19-280ms   | [S2,MB2,B]  285-19-305ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  337-20-357ms   | [S2,MB5,B]  369-20-389ms   | [S2,MB6,B]  394-19-414ms   | [S2,MB7,B]  419-9-428ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-40-255ms   | [S3,MB2,B]  253-22-276ms   | [S3,MB3,B]  276-21-298ms   | [S3,MB4,B]  298-22-320ms   | [S3,MB5,B]  320-22-342ms   | [S3,MB6,B]  343-22-365ms   | [S3,MB7,B]  365-22-387ms  
[rank3]:2025-12-30 14:31:00,713 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1431_stage3_step400.svg
[rank0]:2025-12-30 14:31:00,747 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1431_rank0_stage0.svg
[rank2]:2025-12-30 14:31:00,735 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1431_rank2_stage2.svg
[rank0]:	> Counts Sum: 248960, Total Sum: 781440 (31.86%), Ratio(%) per element: [37.5, 39.77, 35.98, 35.6, 34.46, 37.87, 34.84, 35.22, 34.84, 36.74, 35.6, 34.84, 32.19, 36.36, 35.6, 33.33, 34.09, 33.71, 33.33, 34.84, 30.68, 30.68, 32.95, 29.92, 29.16, 31.06, 28.03, 29.54, 25.37, 30.68, 26.13, 25.0, 23.1, 26.51, 23.86, 26.51, 22.72]
[rank2]:	> Counts Sum: 104560, Total Sum: 760320 (13.75%), Ratio(%) per element: [14.39, 12.87, 14.39, 14.39, 12.5, 13.63, 14.01, 14.39, 14.39, 14.01, 13.63, 13.63, 13.25, 13.25, 13.63, 13.25, 14.01, 14.01, 14.01, 13.63, 14.01, 14.01, 13.25, 13.25, 13.25, 14.01, 13.25, 12.87, 13.25, 12.87, 15.15, 13.63, 14.77, 14.77, 13.63, 13.63]
[rank1]:2025-12-30 14:31:00,732 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1431_rank1_stage1.svg
[rank1]:	> Counts Sum: 348640, Total Sum: 950400 (36.68%), Ratio(%) per element: [35.98, 37.12, 35.98, 37.5, 36.36, 37.12, 35.98, 33.71, 36.74, 38.25, 35.22, 35.6, 37.5, 40.9, 40.15, 36.74, 33.71, 36.74, 35.6, 37.12, 34.84, 33.33, 37.5, 38.25, 36.36, 38.63, 37.12, 37.12, 35.6, 37.87, 38.63, 37.5, 36.74, 34.09, 36.36, 37.5, 34.84, 36.36, 40.53, 35.6, 34.84, 34.84, 40.15, 35.98, 35.98]
[rank3]:2025-12-30 14:31:00,848 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1431_rank3_stage3.svg
[rank3]:	> Counts Sum: 428240, Total Sum: 612480 (69.92%), Ratio(%) per element: [70.07, 70.83, 70.07, 68.56, 71.21, 70.45, 66.28, 73.1, 69.31, 66.66, 68.93, 68.56, 68.56, 70.83, 67.8, 70.45, 67.42, 72.72, 72.72, 68.93, 71.59, 68.56, 71.96, 68.93, 69.69, 74.24, 68.56, 69.31, 71.21]
[rank2]:2025-12-30 14:31:01,593 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1431_stage2.svg
[rank0]:2025-12-30 14:31:01,606 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1431_stage0.svg
[rank1]:2025-12-30 14:31:01,587 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1431_stage1.svg
[rank3]:2025-12-30 14:31:01,680 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1431_stage3.svg
[rank3]:2025-12-30 14:31:23,199 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 14:31:23,431 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 14:31:23,417 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 14:31:23,434 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 14:32:35,921 - Avg. fwd time: 6.9620 / Avg. bwd time: 18.5156 / Avg. batch time: 432.0807 (ms) / GPU bubble ratio: 52.83%
[rank1]:2025-12-30 14:32:35,943 - Avg. fwd time: 9.0931 / Avg. bwd time: 21.2853 / Avg. batch time: 469.6158 (ms) / GPU bubble ratio: 48.25%
[rank3]:2025-12-30 14:32:35,872 - Avg. fwd time: 10.7389 / Avg. bwd time: 30.5229 / Avg. batch time: 389.6448 (ms) / GPU bubble ratio: 15.28%
[rank0]:2025-12-30 14:32:35,952 - Avg. fwd time: 8.1967 / Avg. bwd time: 19.1812 / Avg. batch time: 489.9655 (ms) / GPU bubble ratio: 55.30%
[rank0]:2025-12-30 14:34:07,654 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 14:34:11,367 - Avg. fwd time: 10.7357 / Avg. bwd time: 30.2948 / Avg. batch time: 387.7931 (ms) / GPU bubble ratio: 15.36%
[rank1]:2025-12-30 14:34:11,436 - Avg. fwd time: 9.0919 / Avg. bwd time: 21.2231 / Avg. batch time: 468.3401 (ms) / GPU bubble ratio: 48.22%
[rank2]:2025-12-30 14:34:11,410 - Avg. fwd time: 6.9609 / Avg. bwd time: 18.5155 / Avg. batch time: 430.7605 (ms) / GPU bubble ratio: 52.69%
[rank2]:2025-12-30 14:34:11,467 -  step: 450  loss: -8.0000  grad_norm:  0.1020  memory: 12.26GiB(25.80%)  tps: 8,580  tflops: 67.07  mfu: 21.50%
[rank0]:2025-12-30 14:34:11,445 - Avg. fwd time: 8.1965 / Avg. bwd time: 19.0722 / Avg. batch time: 488.2823 (ms) / GPU bubble ratio: 55.32%
[rank0]:2025-12-30 14:34:11,481 -  step: 450  loss: -8.0000  grad_norm:  0.1020  memory: 17.08GiB(35.95%)  tps: 8,580  tflops: 67.07  mfu: 21.50%
[rank1]:2025-12-30 14:34:11,470 -  step: 450  loss: -8.0000  grad_norm:  0.1020  memory: 15.15GiB(31.89%)  tps: 8,580  tflops: 67.07  mfu: 21.50%
[rank3]:2025-12-30 14:34:11,480 -  step: 450  loss:  0.2251  grad_norm:  0.1020  memory: 26.98GiB(56.79%)  tps: 8,580  tflops: 67.07  mfu: 21.50%
[rank2]:2025-12-30 14:35:45,575 - Avg. fwd time: 6.9601 / Avg. bwd time: 18.5125 / Avg. batch time: 429.2591 (ms) / GPU bubble ratio: 52.53%
[rank3]:2025-12-30 14:35:45,527 - Avg. fwd time: 10.7332 / Avg. bwd time: 30.0397 / Avg. batch time: 385.7319 (ms) / GPU bubble ratio: 15.44%
[rank0]:2025-12-30 14:35:45,612 - Avg. fwd time: 8.1962 / Avg. bwd time: 18.9749 / Avg. batch time: 486.4020 (ms) / GPU bubble ratio: 55.31%
[rank1]:2025-12-30 14:35:45,602 - Avg. fwd time: 9.0914 / Avg. bwd time: 21.1734 / Avg. batch time: 466.8255 (ms) / GPU bubble ratio: 48.14%
[rank0]:2025-12-30 14:37:16,445 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 14:37:20,211 - Avg. fwd time: 10.7319 / Avg. bwd time: 29.8208 / Avg. batch time: 383.9690 (ms) / GPU bubble ratio: 15.51%
[rank3]:2025-12-30 14:37:20,326 -  step: 500  loss:  0.2173  grad_norm:  0.1088  memory: 26.98GiB(56.79%)  tps: 8,676  tflops: 67.82  mfu: 21.74%
[rank0]:2025-12-30 14:37:20,292 - Avg. fwd time: 8.1959 / Avg. bwd time: 18.8861 / Avg. batch time: 484.8431 (ms) / GPU bubble ratio: 55.31%
[rank0]:2025-12-30 14:37:20,328 -  step: 500  loss: -8.0000  grad_norm:  0.1088  memory: 17.08GiB(35.95%)  tps: 8,676  tflops: 67.82  mfu: 21.74%
[rank2]:2025-12-30 14:37:20,256 - Avg. fwd time: 6.9598 / Avg. bwd time: 18.5109 / Avg. batch time: 427.9636 (ms) / GPU bubble ratio: 52.39%
[rank2]:2025-12-30 14:37:20,314 -  step: 500  loss: -8.0000  grad_norm:  0.1088  memory: 12.26GiB(25.80%)  tps: 8,676  tflops: 67.82  mfu: 21.74%
[rank1]:2025-12-30 14:37:20,283 - Avg. fwd time: 9.0913 / Avg. bwd time: 21.1184 / Avg. batch time: 465.5956 (ms) / GPU bubble ratio: 48.09%
[rank1]:2025-12-30 14:37:20,318 -  step: 500  loss: -8.0000  grad_norm:  0.1088  memory: 15.15GiB(31.89%)  tps: 8,676  tflops: 67.82  mfu: 21.74%
[rank0]:2025-12-30 14:37:20,375 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1437_stage0_step500.svg
[rank2]:2025-12-30 14:37:20,376 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1437_stage2_step500.svg
[rank1]:2025-12-30 14:37:20,376 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1437_stage1_step500.svg
[rank3]:2025-12-30 14:37:20,463 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1437_step500_rank3.svg
[rank3]:			> Batch Time: 462.75 ms, GPU Bubble Ratio: 55.73%, 49.65%, 56.00%, 35.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  310-25-335ms   | [S0,MB2,B]  340-25-365ms   | [S0,MB3,B]  370-25-396ms   | [S0,MB4,B]  397-13-410ms   | [S0,MB5,B]  422-23-446ms   | [S0,MB6,B]  448-0-448ms    | [S0,MB7,B]  462-0-462ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  284-22-306ms   | [S1,MB2,B]  310-26-337ms   | [S1,MB3,B]  340-26-366ms   | [S1,MB4,B]  370-16-386ms   | [S1,MB5,B]  397-21-418ms   | [S1,MB6,B]  422-11-433ms   | [S1,MB7,B]  448-11-459ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  261-19-280ms   | [S2,MB2,B]  286-20-306ms   | [S2,MB3,B]  310-20-330ms   | [S2,MB4,B]  340-20-360ms   | [S2,MB5,B]  371-20-392ms   | [S2,MB6,B]  397-19-416ms   | [S2,MB7,B]  422-8-431ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-39-254ms   | [S3,MB2,B]  254-22-277ms   | [S3,MB3,B]  277-21-298ms   | [S3,MB4,B]  298-22-320ms   | [S3,MB5,B]  320-22-343ms   | [S3,MB6,B]  343-21-364ms   | [S3,MB7,B]  364-21-386ms  
[rank3]:2025-12-30 14:37:20,506 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1437_stage3_step500.svg
[rank0]:2025-12-30 14:37:20,526 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1437_rank0_stage0.svg
[rank0]:	> Counts Sum: 330560, Total Sum: 1018240 (32.46%), Ratio(%) per element: [37.79, 40.11, 36.62, 35.75, 35.46, 37.79, 35.17, 36.04, 35.75, 36.33, 37.2, 36.04, 32.84, 36.04, 36.62, 33.72, 34.59, 33.72, 33.43, 35.17, 31.39, 30.52, 32.26, 30.52, 30.23, 31.68, 29.36, 31.1, 26.74, 30.81, 27.61, 25.29, 24.41, 27.03, 25.0, 27.32, 23.54]
[rank2]:2025-12-30 14:37:20,522 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1437_rank2_stage2.svg
[rank2]:	> Counts Sum: 134160, Total Sum: 990720 (13.54%), Ratio(%) per element: [14.24, 13.08, 14.24, 13.95, 12.5, 13.66, 13.66, 13.95, 13.95, 13.66, 13.37, 13.37, 13.08, 13.08, 13.37, 13.37, 13.66, 13.66, 13.95, 13.37, 13.66, 13.66, 13.08, 13.08, 13.37, 13.66, 13.08, 12.79, 13.08, 13.08, 14.53, 13.37, 14.24, 14.24, 13.37, 13.95]
[rank1]:2025-12-30 14:37:20,520 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1437_rank1_stage1.svg
[rank1]:	> Counts Sum: 464640, Total Sum: 1238400 (37.52%), Ratio(%) per element: [36.91, 38.37, 38.08, 38.08, 37.2, 38.08, 37.2, 35.17, 36.91, 38.66, 36.04, 37.2, 37.5, 41.86, 39.82, 38.08, 35.46, 38.95, 36.33, 37.5, 35.46, 34.88, 38.08, 38.08, 36.33, 40.11, 38.08, 37.5, 36.62, 38.95, 38.66, 38.66, 38.08, 35.17, 37.5, 38.37, 36.04, 37.2, 40.4, 35.46, 36.33, 36.04, 39.24, 36.91, 36.62]
[rank3]:2025-12-30 14:37:20,641 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1437_rank3_stage3.svg
[rank3]:	> Counts Sum: 577040, Total Sum: 798080 (72.30%), Ratio(%) per element: [72.38, 72.67, 72.67, 70.93, 74.12, 72.38, 69.47, 74.7, 72.67, 69.47, 71.51, 72.09, 71.22, 72.67, 70.93, 72.67, 69.76, 74.41, 74.41, 70.93, 73.25, 71.51, 74.41, 72.09, 72.09, 75.87, 70.93, 71.22, 73.25]
[rank2]:2025-12-30 14:37:21,633 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1437_stage2.svg
[rank3]:2025-12-30 14:37:21,731 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1437_stage3.svg
[rank0]:2025-12-30 14:37:21,634 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1437_stage0.svg
[rank1]:2025-12-30 14:37:21,638 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1437_stage1.svg
[rank3]:2025-12-30 14:38:56,770 - Avg. fwd time: 10.7299 / Avg. bwd time: 29.6354 / Avg. batch time: 382.4696 (ms) / GPU bubble ratio: 15.57%
[rank1]:2025-12-30 14:38:56,837 - Avg. fwd time: 9.0911 / Avg. bwd time: 21.0768 / Avg. batch time: 464.6292 (ms) / GPU bubble ratio: 48.06%
[rank0]:2025-12-30 14:38:56,847 - Avg. fwd time: 8.1958 / Avg. bwd time: 18.8117 / Avg. batch time: 483.5799 (ms) / GPU bubble ratio: 55.32%
[rank2]:2025-12-30 14:38:56,810 - Avg. fwd time: 6.9595 / Avg. bwd time: 18.5083 / Avg. batch time: 426.9216 (ms) / GPU bubble ratio: 52.28%
[rank0]:2025-12-30 14:40:28,096 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 14:40:31,847 - Avg. fwd time: 10.7281 / Avg. bwd time: 29.4672 / Avg. batch time: 381.1077 (ms) / GPU bubble ratio: 15.62%
[rank2]:2025-12-30 14:40:31,893 - Avg. fwd time: 6.9592 / Avg. bwd time: 18.5037 / Avg. batch time: 425.9107 (ms) / GPU bubble ratio: 52.17%
[rank1]:2025-12-30 14:40:31,919 - Avg. fwd time: 9.0905 / Avg. bwd time: 21.0278 / Avg. batch time: 463.7006 (ms) / GPU bubble ratio: 48.04%
[rank1]:2025-12-30 14:40:31,955 -  step: 550  loss: -8.0000  grad_norm:  0.0901  memory: 15.15GiB(31.89%)  tps: 8,549  tflops: 66.84  mfu: 21.42%
[rank3]:2025-12-30 14:40:31,964 -  step: 550  loss:  0.2250  grad_norm:  0.0901  memory: 26.98GiB(56.79%)  tps: 8,550  tflops: 66.84  mfu: 21.42%
[rank0]:2025-12-30 14:40:31,930 - Avg. fwd time: 8.1956 / Avg. bwd time: 18.7465 / Avg. batch time: 482.3825 (ms) / GPU bubble ratio: 55.32%
[rank0]:2025-12-30 14:40:31,966 -  step: 550  loss: -8.0000  grad_norm:  0.0901  memory: 17.08GiB(35.95%)  tps: 8,549  tflops: 66.84  mfu: 21.42%
[rank2]:2025-12-30 14:40:31,952 -  step: 550  loss: -8.0000  grad_norm:  0.0901  memory: 12.26GiB(25.80%)  tps: 8,549  tflops: 66.84  mfu: 21.42%
[rank3]:2025-12-30 14:42:07,716 - Avg. fwd time: 10.7284 / Avg. bwd time: 29.3450 / Avg. batch time: 380.1347 (ms) / GPU bubble ratio: 15.66%
[rank1]:2025-12-30 14:42:07,782 - Avg. fwd time: 9.0905 / Avg. bwd time: 20.9879 / Avg. batch time: 463.0144 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-12-30 14:42:07,793 - Avg. fwd time: 8.1956 / Avg. bwd time: 18.6882 / Avg. batch time: 481.4504 (ms) / GPU bubble ratio: 55.33%
[rank2]:2025-12-30 14:42:07,760 - Avg. fwd time: 6.9590 / Avg. bwd time: 18.5015 / Avg. batch time: 425.2054 (ms) / GPU bubble ratio: 52.10%
[rank0]:2025-12-30 14:43:38,131 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 14:43:41,926 - Avg. fwd time: 10.7285 / Avg. bwd time: 29.1785 / Avg. batch time: 378.8044 (ms) / GPU bubble ratio: 15.72%
[rank1]:2025-12-30 14:43:41,984 - Avg. fwd time: 9.0904 / Avg. bwd time: 20.9449 / Avg. batch time: 462.0426 (ms) / GPU bubble ratio: 48.00%
[rank1]:2025-12-30 14:43:42,020 -  step: 600  loss: -8.0000  grad_norm:  0.1101  memory: 15.15GiB(31.89%)  tps: 8,620  tflops: 67.39  mfu: 21.60%
[rank0]:2025-12-30 14:43:41,995 - Avg. fwd time: 8.1958 / Avg. bwd time: 18.6312 / Avg. batch time: 480.2532 (ms) / GPU bubble ratio: 55.31%
[rank0]:2025-12-30 14:43:42,031 -  step: 600  loss: -8.0000  grad_norm:  0.1101  memory: 17.08GiB(35.95%)  tps: 8,620  tflops: 67.39  mfu: 21.60%
[rank3]:2025-12-30 14:43:42,029 -  step: 600  loss:  0.2200  grad_norm:  0.1101  memory: 26.98GiB(56.79%)  tps: 8,620  tflops: 67.39  mfu: 21.60%
[rank2]:2025-12-30 14:43:41,958 - Avg. fwd time: 6.9588 / Avg. bwd time: 18.5002 / Avg. batch time: 424.1988 (ms) / GPU bubble ratio: 51.99%
[rank2]:2025-12-30 14:43:42,017 -  step: 600  loss: -8.0000  grad_norm:  0.1101  memory: 12.26GiB(25.80%)  tps: 8,620  tflops: 67.39  mfu: 21.60%
[rank1]:2025-12-30 14:43:42,082 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1443_stage1_step600.svg
[rank0]:2025-12-30 14:43:42,081 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1443_stage0_step600.svg
[rank2]:2025-12-30 14:43:42,081 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1443_stage2_step600.svg
[rank1]:2025-12-30 14:43:42,228 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1443_rank1_stage1.svg
[rank1]:	> Counts Sum: 580640, Total Sum: 1526400 (38.04%), Ratio(%) per element: [37.5, 39.15, 38.2, 39.15, 37.26, 37.5, 37.97, 36.55, 37.97, 39.38, 35.84, 37.5, 37.73, 41.27, 40.8, 38.91, 36.08, 39.15, 37.73, 38.67, 36.32, 35.61, 38.91, 38.67, 37.5, 39.85, 38.2, 37.97, 37.73, 38.67, 37.97, 38.2, 38.91, 36.79, 37.97, 39.15, 36.79, 37.26, 40.09, 36.32, 36.55, 37.26, 39.85, 37.26, 37.5]
[rank0]:2025-12-30 14:43:42,239 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1443_rank0_stage0.svg
[rank0]:	> Counts Sum: 412160, Total Sum: 1255040 (32.84%), Ratio(%) per element: [37.73, 40.09, 37.26, 36.08, 36.55, 37.97, 36.32, 35.84, 37.02, 36.08, 37.26, 36.32, 33.25, 36.08, 35.84, 33.49, 34.19, 34.19, 33.25, 35.14, 33.25, 31.36, 33.25, 30.42, 31.13, 32.07, 29.71, 30.66, 28.06, 30.66, 29.0, 26.17, 25.7, 27.35, 25.0, 27.12, 24.05]
[rank3]:2025-12-30 14:43:42,171 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1443_step600_rank3.svg
[rank3]:			> Batch Time: 451.25 ms, GPU Bubble Ratio: 54.47%, 48.79%, 55.04%, 36.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  299-25-325ms   | [S0,MB2,B]  329-25-354ms   | [S0,MB3,B]  358-25-384ms   | [S0,MB4,B]  386-13-399ms   | [S0,MB5,B]  410-24-435ms   | [S0,MB6,B]  436-0-436ms    | [S0,MB7,B]  451-0-451ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  272-22-295ms   | [S1,MB2,B]  299-25-325ms   | [S1,MB3,B]  328-26-354ms   | [S1,MB4,B]  358-15-374ms   | [S1,MB5,B]  386-20-407ms   | [S1,MB6,B]  410-11-421ms   | [S1,MB7,B]  436-11-447ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-59ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  248-19-268ms   | [S2,MB2,B]  274-19-294ms   | [S2,MB3,B]  299-20-319ms   | [S2,MB4,B]  328-20-348ms   | [S2,MB5,B]  360-20-380ms   | [S2,MB6,B]  385-19-405ms   | [S2,MB7,B]  410-8-419ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-27-241ms   | [S3,MB2,B]  241-22-264ms   | [S3,MB3,B]  263-21-285ms   | [S3,MB4,B]  285-22-307ms   | [S3,MB5,B]  307-22-329ms   | [S3,MB6,B]  329-21-351ms   | [S3,MB7,B]  351-21-373ms  
[rank3]:2025-12-30 14:43:42,217 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1443_stage3_step600.svg
[rank2]:2025-12-30 14:43:42,230 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1443_rank2_stage2.svg
[rank2]:	> Counts Sum: 163760, Total Sum: 1221120 (13.41%), Ratio(%) per element: [13.91, 13.2, 13.91, 13.67, 12.5, 13.44, 13.44, 13.67, 13.67, 13.67, 13.2, 13.2, 12.97, 13.2, 13.44, 13.44, 13.67, 13.44, 13.67, 13.44, 13.44, 13.44, 12.97, 12.97, 13.2, 13.44, 12.97, 12.73, 13.2, 12.97, 14.15, 13.2, 13.91, 14.38, 13.2, 13.67]
[rank3]:2025-12-30 14:43:42,353 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1443_rank3_stage3.svg
[rank3]:	> Counts Sum: 725840, Total Sum: 983680 (73.79%), Ratio(%) per element: [74.29, 74.29, 73.82, 72.64, 75.7, 73.82, 70.99, 75.47, 74.05, 71.22, 73.34, 73.82, 73.11, 74.52, 73.11, 73.82, 71.93, 74.76, 75.7, 72.4, 74.29, 73.34, 75.0, 73.58, 73.34, 76.88, 72.64, 73.34, 74.52]
[rank1]:2025-12-30 14:43:43,609 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1443_stage1.svg
[rank0]:2025-12-30 14:43:43,621 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1443_stage0.svg
[rank2]:2025-12-30 14:43:43,609 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1443_stage2.svg
[rank3]:2025-12-30 14:43:43,712 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1443_stage3.svg
[rank3]:2025-12-30 14:45:19,258 - Avg. fwd time: 10.7272 / Avg. bwd time: 29.0676 / Avg. batch time: 377.9054 (ms) / GPU bubble ratio: 15.76%
[rank0]:2025-12-30 14:45:19,340 - Avg. fwd time: 8.1956 / Avg. bwd time: 18.5872 / Avg. batch time: 479.4746 (ms) / GPU bubble ratio: 55.31%
[rank1]:2025-12-30 14:45:19,329 - Avg. fwd time: 9.0906 / Avg. bwd time: 20.9114 / Avg. batch time: 461.4722 (ms) / GPU bubble ratio: 47.99%
[rank2]:2025-12-30 14:45:19,304 - Avg. fwd time: 6.9588 / Avg. bwd time: 18.4995 / Avg. batch time: 423.5813 (ms) / GPU bubble ratio: 51.92%
[rank0]:2025-12-30 14:46:50,106 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-30 14:46:53,864 - Avg. fwd time: 10.7256 / Avg. bwd time: 28.9412 / Avg. batch time: 376.8810 (ms) / GPU bubble ratio: 15.80%
[rank2]:2025-12-30 14:46:53,900 - Avg. fwd time: 6.9585 / Avg. bwd time: 18.4984 / Avg. batch time: 422.8321 (ms) / GPU bubble ratio: 51.84%
[rank3]:2025-12-30 14:46:53,973 -  step: 650  loss:  0.2305  grad_norm:  0.0902  memory: 26.98GiB(56.79%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank1]:2025-12-30 14:46:53,926 - Avg. fwd time: 9.0904 / Avg. bwd time: 20.8846 / Avg. batch time: 460.7079 (ms) / GPU bubble ratio: 47.95%
[rank1]:2025-12-30 14:46:53,963 -  step: 650  loss: -8.0000  grad_norm:  0.0902  memory: 15.15GiB(31.89%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank0]:2025-12-30 14:46:53,937 - Avg. fwd time: 8.1954 / Avg. bwd time: 18.5324 / Avg. batch time: 478.5185 (ms) / GPU bubble ratio: 55.32%
[rank0]:2025-12-30 14:46:53,974 -  step: 650  loss: -8.0000  grad_norm:  0.0902  memory: 17.08GiB(35.95%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank2]:2025-12-30 14:46:53,959 -  step: 650  loss: -8.0000  grad_norm:  0.0902  memory: 12.26GiB(25.80%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank3]:2025-12-30 14:48:29,985 - Avg. fwd time: 10.7247 / Avg. bwd time: 28.8542 / Avg. batch time: 376.1766 (ms) / GPU bubble ratio: 15.83%
[rank2]:2025-12-30 14:48:30,031 - Avg. fwd time: 6.9585 / Avg. bwd time: 18.4982 / Avg. batch time: 422.3941 (ms) / GPU bubble ratio: 51.79%
[rank0]:2025-12-30 14:48:30,068 - Avg. fwd time: 8.1956 / Avg. bwd time: 18.4793 / Avg. batch time: 477.9166 (ms) / GPU bubble ratio: 55.35%
[rank1]:2025-12-30 14:48:30,057 - Avg. fwd time: 9.0905 / Avg. bwd time: 20.8652 / Avg. batch time: 460.2836 (ms) / GPU bubble ratio: 47.94%
[rank0]:2025-12-30 14:50:00,557 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 14:50:04,247 - Avg. fwd time: 10.7239 / Avg. bwd time: 28.7261 / Avg. batch time: 375.1454 (ms) / GPU bubble ratio: 15.87%
[rank1]:2025-12-30 14:50:04,312 - Avg. fwd time: 9.0904 / Avg. bwd time: 20.8463 / Avg. batch time: 459.5634 (ms) / GPU bubble ratio: 47.89%
[rank1]:2025-12-30 14:50:04,349 -  step: 700  loss: -8.0000  grad_norm:  0.0803  memory: 15.15GiB(31.89%)  tps: 8,606  tflops: 67.28  mfu: 21.56%
[rank3]:2025-12-30 14:50:04,359 -  step: 700  loss:  0.1899  grad_norm:  0.0803  memory: 26.98GiB(56.79%)  tps: 8,606  tflops: 67.28  mfu: 21.56%
[rank0]:2025-12-30 14:50:04,324 - Avg. fwd time: 8.1952 / Avg. bwd time: 18.4361 / Avg. batch time: 477.0309 (ms) / GPU bubble ratio: 55.34%
[rank2]:2025-12-30 14:50:04,288 - Avg. fwd time: 6.9583 / Avg. bwd time: 18.4984 / Avg. batch time: 421.6376 (ms) / GPU bubble ratio: 51.70%
[rank2]:2025-12-30 14:50:04,346 -  step: 700  loss: -8.0000  grad_norm:  0.0803  memory: 12.26GiB(25.80%)  tps: 8,606  tflops: 67.28  mfu: 21.56%
[rank1]:2025-12-30 14:50:04,411 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1450_stage1_step700.svg
[rank0]:2025-12-30 14:50:04,360 -  step: 700  loss: -8.0000  grad_norm:  0.0803  memory: 17.08GiB(35.95%)  tps: 8,606  tflops: 67.28  mfu: 21.56%
[rank0]:2025-12-30 14:50:04,411 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1450_stage0_step700.svg
[rank2]:2025-12-30 14:50:04,411 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1450_stage2_step700.svg
[rank1]:2025-12-30 14:50:04,556 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1450_rank1_stage1.svg
[rank1]:	> Counts Sum: 696640, Total Sum: 1814400 (38.40%), Ratio(%) per element: [38.09, 39.28, 38.29, 40.27, 37.69, 38.49, 37.89, 38.09, 38.49, 39.08, 37.1, 38.29, 38.88, 41.07, 40.47, 38.29, 36.7, 39.28, 37.89, 39.88, 37.3, 36.3, 39.08, 38.69, 37.89, 39.88, 38.88, 38.29, 38.29, 38.49, 38.09, 38.49, 38.69, 37.89, 38.29, 39.28, 37.69, 37.3, 39.88, 36.3, 36.7, 37.5, 39.88, 37.1, 37.89]
[rank3]:2025-12-30 14:50:04,495 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1450_step700_rank3.svg
[rank3]:			> Batch Time: 453.50 ms, GPU Bubble Ratio: 54.83%, 47.82%, 54.96%, 37.08%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  301-25-326ms   | [S0,MB2,B]  330-25-355ms   | [S0,MB3,B]  359-25-385ms   | [S0,MB4,B]  387-12-399ms   | [S0,MB5,B]  413-24-437ms   | [S0,MB6,B]  438-0-438ms    | [S0,MB7,B]  453-0-453ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  274-23-297ms   | [S1,MB2,B]  300-25-326ms   | [S1,MB3,B]  330-26-356ms   | [S1,MB4,B]  359-17-377ms   | [S1,MB5,B]  387-22-409ms   | [S1,MB6,B]  413-11-425ms   | [S1,MB7,B]  438-11-450ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  249-19-269ms   | [S2,MB2,B]  275-19-295ms   | [S2,MB3,B]  300-20-320ms   | [S2,MB4,B]  329-20-350ms   | [S2,MB5,B]  361-20-381ms   | [S2,MB6,B]  387-20-407ms   | [S2,MB7,B]  412-8-421ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-27-242ms   | [S3,MB2,B]  243-21-264ms   | [S3,MB3,B]  265-21-287ms   | [S3,MB4,B]  287-22-309ms   | [S3,MB5,B]  309-22-331ms   | [S3,MB6,B]  332-21-353ms   | [S3,MB7,B]  354-21-375ms  
[rank3]:2025-12-30 14:50:04,541 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1450_stage3_step700.svg
[rank2]:2025-12-30 14:50:04,561 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1450_rank2_stage2.svg
[rank2]:	> Counts Sum: 193360, Total Sum: 1451520 (13.32%), Ratio(%) per element: [13.69, 13.09, 13.88, 13.49, 12.5, 13.29, 13.29, 13.49, 13.88, 13.88, 13.09, 13.09, 12.89, 13.09, 13.29, 13.29, 13.49, 13.49, 13.49, 13.49, 13.49, 13.29, 12.89, 12.89, 13.09, 13.29, 13.09, 12.89, 13.09, 12.89, 13.88, 13.09, 13.69, 14.08, 13.09, 13.49]
[rank0]:2025-12-30 14:50:04,563 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1450_rank0_stage0.svg
[rank0]:	> Counts Sum: 493760, Total Sum: 1491840 (33.10%), Ratio(%) per element: [37.69, 40.27, 36.9, 37.1, 36.3, 38.29, 36.5, 35.91, 37.3, 36.7, 36.9, 35.91, 34.52, 36.9, 35.31, 34.32, 34.12, 34.12, 33.92, 34.72, 33.73, 31.94, 32.93, 31.34, 30.95, 32.93, 29.96, 30.35, 28.37, 29.96, 29.56, 26.78, 26.38, 27.38, 25.99, 27.38, 24.8]
[rank3]:2025-12-30 14:50:04,676 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1450_rank3_stage3.svg
[rank3]:	> Counts Sum: 874640, Total Sum: 1169280 (74.80%), Ratio(%) per element: [75.99, 75.19, 75.39, 74.2, 75.99, 74.4, 72.61, 76.19, 74.4, 72.61, 74.2, 74.6, 73.61, 75.59, 74.4, 74.8, 73.61, 75.79, 76.19, 73.61, 75.39, 74.6, 75.59, 74.4, 74.8, 77.18, 74.0, 74.6, 75.19]
[rank1]:2025-12-30 14:50:06,175 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1450_stage1.svg
[rank0]:2025-12-30 14:50:06,195 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1450_stage0.svg
[rank2]:2025-12-30 14:50:06,183 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1450_stage2.svg
[rank3]:2025-12-30 14:50:06,263 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1450_stage3.svg
[rank3]:2025-12-30 14:51:41,488 - Avg. fwd time: 10.7238 / Avg. bwd time: 28.6504 / Avg. batch time: 374.5397 (ms) / GPU bubble ratio: 15.90%
[rank1]:2025-12-30 14:51:41,557 - Avg. fwd time: 9.0902 / Avg. bwd time: 20.8164 / Avg. batch time: 459.0992 (ms) / GPU bubble ratio: 47.89%
[rank0]:2025-12-30 14:51:41,569 - Avg. fwd time: 8.1952 / Avg. bwd time: 18.3842 / Avg. batch time: 476.4135 (ms) / GPU bubble ratio: 55.37%
[rank2]:2025-12-30 14:51:41,530 - Avg. fwd time: 6.9582 / Avg. bwd time: 18.4959 / Avg. batch time: 421.2056 (ms) / GPU bubble ratio: 51.65%
[rank0]:2025-12-30 14:53:13,636 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 14:53:17,405 - Avg. fwd time: 10.7228 / Avg. bwd time: 28.5751 / Avg. batch time: 373.9290 (ms) / GPU bubble ratio: 15.92%
[rank0]:2025-12-30 14:53:17,483 - Avg. fwd time: 8.1948 / Avg. bwd time: 18.3579 / Avg. batch time: 475.9061 (ms) / GPU bubble ratio: 55.36%
[rank0]:2025-12-30 14:53:17,519 -  step: 750  loss: -8.0000  grad_norm:  0.1145  memory: 17.08GiB(35.95%)  tps: 8,482  tflops: 66.31  mfu: 21.25%
[rank2]:2025-12-30 14:53:17,443 - Avg. fwd time: 6.9582 / Avg. bwd time: 18.4942 / Avg. batch time: 420.7860 (ms) / GPU bubble ratio: 51.61%
[rank2]:2025-12-30 14:53:17,504 -  step: 750  loss: -8.0000  grad_norm:  0.1145  memory: 12.26GiB(25.80%)  tps: 8,482  tflops: 66.31  mfu: 21.25%
[rank3]:2025-12-30 14:53:17,517 -  step: 750  loss:  0.2291  grad_norm:  0.1145  memory: 26.98GiB(56.79%)  tps: 8,482  tflops: 66.31  mfu: 21.25%
[rank1]:2025-12-30 14:53:17,470 - Avg. fwd time: 9.0897 / Avg. bwd time: 20.7924 / Avg. batch time: 458.7341 (ms) / GPU bubble ratio: 47.89%
[rank1]:2025-12-30 14:53:17,508 -  step: 750  loss: -8.0000  grad_norm:  0.1145  memory: 15.15GiB(31.89%)  tps: 8,482  tflops: 66.31  mfu: 21.25%
[rank3]:2025-12-30 14:54:53,455 - Avg. fwd time: 10.7239 / Avg. bwd time: 28.5106 / Avg. batch time: 373.4233 (ms) / GPU bubble ratio: 15.95%
[rank1]:2025-12-30 14:54:53,519 - Avg. fwd time: 9.0896 / Avg. bwd time: 20.7696 / Avg. batch time: 458.4046 (ms) / GPU bubble ratio: 47.89%
[rank2]:2025-12-30 14:54:53,493 - Avg. fwd time: 6.9585 / Avg. bwd time: 18.4947 / Avg. batch time: 420.4229 (ms) / GPU bubble ratio: 51.57%
[rank0]:2025-12-30 14:54:53,533 - Avg. fwd time: 8.1946 / Avg. bwd time: 18.3192 / Avg. batch time: 475.4432 (ms) / GPU bubble ratio: 55.39%
[rank0]:2025-12-30 14:56:25,553 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 14:56:29,353 - Avg. fwd time: 10.7256 / Avg. bwd time: 28.4538 / Avg. batch time: 372.9852 (ms) / GPU bubble ratio: 15.97%
[rank0]:2025-12-30 14:56:29,424 - Avg. fwd time: 8.1949 / Avg. bwd time: 18.2795 / Avg. batch time: 474.9944 (ms) / GPU bubble ratio: 55.41%
[rank0]:2025-12-30 14:56:29,461 -  step: 800  loss: -8.0000  grad_norm:  0.1066  memory: 17.08GiB(35.95%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank0]:2025-12-30 14:56:29,461 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1066  tps: 8,790  tflops: 68.71  mfu: 20.09%
[rank0]:2025-12-30 14:56:29,461 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 14:56:29,462 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 14:56:29,459 -  step: 800  loss:  0.2338  grad_norm:  0.1066  memory: 26.98GiB(56.79%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank3]:2025-12-30 14:56:29,460 - â„¹ï¸ final step: 800  loss:  0.2338  grad_norm:  0.1066  tps: 8,796  tflops: 68.77  mfu: 20.22%
[rank3]:2025-12-30 14:56:29,460 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 14:56:29,461 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-30 14:56:29,411 - Avg. fwd time: 9.0902 / Avg. bwd time: 20.7592 / Avg. batch time: 458.0809 (ms) / GPU bubble ratio: 47.87%
[rank1]:2025-12-30 14:56:29,450 -  step: 800  loss: -8.0000  grad_norm:  0.1066  memory: 15.15GiB(31.89%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank1]:2025-12-30 14:56:29,450 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1066  tps: 8,790  tflops: 68.71  mfu: 20.09%
[rank1]:2025-12-30 14:56:29,450 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 14:56:29,451 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 14:56:29,385 - Avg. fwd time: 6.9587 / Avg. bwd time: 18.4928 / Avg. batch time: 420.1405 (ms) / GPU bubble ratio: 51.54%
[rank2]:2025-12-30 14:56:29,446 -  step: 800  loss: -8.0000  grad_norm:  0.1066  memory: 12.26GiB(25.80%)  tps: 8,536  tflops: 66.73  mfu: 21.39%
[rank2]:2025-12-30 14:56:29,446 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1066  tps: 8,790  tflops: 68.71  mfu: 20.09%
[rank2]:2025-12-30 14:56:29,447 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-30 14:56:29,447 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 14:56:31,428 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-30 14:56:31,502 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1456_stage0_final800.svg
[rank1]:2025-12-30 14:56:31,499 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1456_stage1_final800.svg
[rank2]:2025-12-30 14:56:31,500 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1456_stage2_final800.svg
[rank0]:2025-12-30 14:56:31,657 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1456_rank0_stage0.svg
[rank0]:	> Counts Sum: 575360, Total Sum: 1728640 (33.28%), Ratio(%) per element: [37.84, 39.89, 37.15, 37.5, 36.64, 38.69, 36.13, 36.81, 37.5, 36.81, 37.15, 35.78, 34.58, 36.81, 35.1, 34.58, 34.41, 33.9, 34.07, 35.27, 33.73, 32.36, 33.39, 31.5, 31.33, 32.87, 29.79, 31.16, 28.76, 30.47, 29.28, 27.05, 26.88, 27.22, 26.71, 27.39, 24.82]
[rank3]:2025-12-30 14:56:31,587 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1456_final800_rank3.svg
[rank3]:			> Batch Time: 459.75 ms, GPU Bubble Ratio: 55.37%, 48.92%, 55.68%, 34.99%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  307-25-332ms   | [S0,MB2,B]  337-25-362ms   | [S0,MB3,B]  367-25-392ms   | [S0,MB4,B]  394-13-408ms   | [S0,MB5,B]  420-23-444ms   | [S0,MB6,B]  445-0-445ms    | [S0,MB7,B]  459-0-459ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  281-22-304ms   | [S1,MB2,B]  308-25-334ms   | [S1,MB3,B]  337-26-363ms   | [S1,MB4,B]  367-16-383ms   | [S1,MB5,B]  394-22-417ms   | [S1,MB6,B]  420-11-431ms   | [S1,MB7,B]  444-11-456ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-20-329ms   | [S2,MB4,B]  337-20-357ms   | [S2,MB5,B]  368-20-388ms   | [S2,MB6,B]  394-19-414ms   | [S2,MB7,B]  419-8-428ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-38-252ms   | [S3,MB2,B]  251-23-275ms   | [S3,MB3,B]  275-21-297ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-342ms   | [S3,MB6,B]  341-22-364ms   | [S3,MB7,B]  364-22-386ms  
[rank1]:2025-12-30 14:56:31,644 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1456_rank1_stage1.svg
[rank1]:	> Counts Sum: 812640, Total Sum: 2102400 (38.65%), Ratio(%) per element: [37.5, 39.72, 38.52, 39.38, 38.18, 39.04, 38.35, 38.52, 40.23, 39.04, 37.15, 38.69, 38.69, 41.26, 41.09, 38.35, 37.15, 39.04, 38.86, 39.89, 38.18, 37.5, 38.69, 39.21, 37.84, 39.72, 39.55, 38.52, 38.69, 39.04, 38.35, 38.01, 39.04, 37.84, 38.18, 39.21, 38.01, 38.01, 39.72, 36.81, 37.15, 37.5, 39.72, 37.84, 38.18]
[rank2]:2025-12-30 14:56:31,648 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1456_rank2_stage2.svg
[rank2]:	> Counts Sum: 222960, Total Sum: 1681920 (13.26%), Ratio(%) per element: [13.52, 13.01, 13.69, 13.35, 12.67, 13.18, 13.35, 13.52, 13.69, 13.86, 13.01, 13.18, 12.84, 13.18, 13.18, 13.35, 13.52, 13.35, 13.52, 13.35, 13.35, 13.18, 12.84, 12.84, 13.01, 13.18, 13.01, 12.84, 13.01, 12.84, 13.69, 13.01, 13.69, 13.86, 13.01, 13.35]
[rank3]:2025-12-30 14:56:31,720 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/pipeline_schedule/251230_1456_thry_final800_rank3.svg
[rank3]:			> Batch Time: 288.25 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-69ms      | [S0,MB0,B]  148-17-165ms   | [S0,MB1,B]  165-17-183ms   | [S0,MB2,B]  183-17-200ms   | [S0,MB3,B]  200-17-218ms   | [S0,MB4,B]  218-17-235ms   | [S0,MB5,B]  235-17-253ms   | [S0,MB6,B]  253-17-270ms   | [S0,MB7,B]  270-17-288ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-34ms      | [S1,MB3,F]  34-8-43ms      | [S1,MB4,F]  43-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-69ms      | [S1,MB7,F]  69-8-78ms      | [S1,MB0,B]  131-17-148ms   | [S1,MB1,B]  148-17-165ms   | [S1,MB2,B]  165-17-183ms   | [S1,MB3,B]  183-17-200ms   | [S1,MB4,B]  200-17-218ms   | [S1,MB5,B]  218-17-235ms   | [S1,MB6,B]  235-17-253ms   | [S1,MB7,B]  253-17-270ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-34ms      | [S2,MB2,F]  34-8-43ms      | [S2,MB3,F]  43-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-69ms      | [S2,MB6,F]  69-8-78ms      | [S2,MB7,F]  78-8-87ms      | [S2,MB0,B]  113-17-131ms   | [S2,MB1,B]  131-17-148ms   | [S2,MB2,B]  148-17-165ms   | [S2,MB3,B]  165-17-183ms   | [S2,MB4,B]  183-17-200ms   | [S2,MB5,B]  200-17-218ms   | [S2,MB6,B]  218-17-235ms   | [S2,MB7,B]  235-17-253ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-34ms      | [S3,MB1,F]  34-8-43ms      | [S3,MB2,F]  43-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-69ms      | [S3,MB5,F]  69-8-78ms      | [S3,MB6,F]  78-8-87ms      | [S3,MB7,F]  87-8-96ms      | [S3,MB0,B]  96-17-113ms    | [S3,MB1,B]  113-17-131ms   | [S3,MB2,B]  131-17-148ms   | [S3,MB3,B]  148-17-165ms   | [S3,MB4,B]  165-17-183ms   | [S3,MB5,B]  183-17-200ms   | [S3,MB6,B]  200-17-218ms   | [S3,MB7,B]  218-17-235ms  
[rank3]:2025-12-30 14:56:31,768 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1456_stage3_final800.svg
[rank3]:2025-12-30 14:56:31,903 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/frozen_params_histogram/251230_1456_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [76.54, 75.85, 75.85, 74.82, 76.71, 75.34, 73.97, 76.71, 75.0, 73.97, 75.0, 75.17, 74.31, 76.19, 74.82, 75.85, 74.82, 76.19, 76.71, 74.48, 76.36, 75.51, 76.19, 75.51, 75.17, 77.73, 75.0, 75.51, 75.17]
[rank0]:2025-12-30 14:56:33,549 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1456_stage0.svg
[rank0]:2025-12-30 14:56:33,553 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-30 14:56:33,538 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1456_stage1.svg
[rank1]:2025-12-30 14:56:33,541 - Destroying the purge thread.
[rank2]:2025-12-30 14:56:33,532 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1456_stage2.svg
[rank2]:2025-12-30 14:56:33,536 - Destroying the purge thread.
[rank3]:2025-12-30 14:56:33,752 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1/afr_time_plot/251230_1456_stage3.svg
[rank3]:2025-12-30 14:56:33,755 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-12-30 14:56:33,949 - Process group destroyed
[rank2]:2025-12-30 14:56:33,955 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 331-352
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.72515
[rank3]:wandb:               final/avg_loss 0.23381
[rank3]:wandb:             final/avg_mfu(%) 20.22036
[rank3]:wandb:             final/avg_tflops 68.7663
[rank3]:wandb:    final/avg_throughput(tps) 8796.41253
[rank3]:wandb:              final/grad_norm 0.10657
[rank3]:wandb:               final/max_loss 0.23381
[rank3]:wandb:                    grad_norm 0.10657
[rank3]:wandb: loss_metrics/global_avg_loss 0.23381
[rank3]:wandb: loss_metrics/global_max_loss 0.23381
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_GPipe_fullrand7_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/jxwcj2ba
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_GPipe_fullrand7_22_dm1/20251230-1403/wandb/run-20251230_140341-jxwcj2ba/logs
[rank3]:2025-12-30 14:56:34,924 - Process group destroyed
[rank0]:2025-12-30 14:56:35,553 - Training completed
[rank0]:2025-12-30 14:56:35,553 - Destroying the purge thread.
[rank0]:2025-12-30 14:56:36,029 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.1', 'layers.2', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.5', 'layers.8', 'layers.7', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'layers.14', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_GPipe_fullrand7_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_GPipe_fullrand7_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_GPipe_fullrand7_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_GPipe_fullrand7_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_GPipe_fullrand7_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_GPipe_fullrand7_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_GPipe_fullrand7_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_GPipe_fullrand7_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
