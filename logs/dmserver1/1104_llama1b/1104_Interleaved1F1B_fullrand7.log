
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 05. (ìˆ˜) 13:59:55 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_Interleaved1F1B_fullrand7.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with fullrand7 x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-05 14:00:01,956 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-11-05 14:00:01,994 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-05 14:00:01,976 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-11-05 14:00:01,976 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 14:00:02,312 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-05 14:00:02,315 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 14:00:02,318 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-05 14:00:02,327 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-05 14:00:02,329 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-05 14:00:02,283 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-05 14:00:02,286 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-05 14:00:02,299 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 14:00:02,301 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 14:00:02,651 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-05 14:00:03,073 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-11-05 14:00:06,117 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-05 14:00:06,156 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 14:00:06,061 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 14:00:06,101 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 14:00:06,125 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-05 14:00:06,138 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-05 14:00:06,139 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-05 14:00:06,210 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-05 14:00:06,183 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-05 14:00:06,195 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-05 14:00:06,197 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-05 14:00:06,357 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 14:00:06,309 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 14:00:06,309 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-05 14:00:06,310 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-05 14:00:06,366 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 14:00:06,366 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 14:00:06,397 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 14:00:06,398 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-11-05 14:00:06,367 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-05 14:00:06,425 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-05 14:00:06,438 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-05 14:00:06,439 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-05 14:00:06,616 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 14:00:06,616 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 14:00:06,617 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run c12gzqq2
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_fullrand7_dm1/20251105-1400/wandb/run-20251105_140007-c12gzqq2
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_Interleaved1F1B_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/c12gzqq2
[rank3]:2025-11-05 14:00:08,494 - INFO - WandB logging enabled
[rank3]:2025-11-05 14:00:08,495 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-05 14:00:08,532 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 14:00:08,560 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-05 14:00:08,573 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-05 14:00:08,575 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-05 14:00:08,791 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 14:00:08,790 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_fullrand7_dm1
[rank0]:2025-11-05 14:00:08,791 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 14:00:08,791 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-05 14:00:08,791 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-05 14:00:08,800 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-05 14:00:08,772 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 14:00:08,773 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-05 14:00:08,774 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-05 14:00:08,791 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 14:00:11,019 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-05 14:00:11,019 - INFO - Finished loading the checkpoint in 2.23 seconds.
[rank0]:2025-11-05 14:00:11,019 - INFO - Training starts at step 1
[rank1]:2025-11-05 14:00:14,356 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8877  memory:  9.58GiB(20.17%)  tps: 1,998  tflops: 15.22  mfu: 4.88%
[rank1]:2025-11-05 14:00:14,357 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-05 14:00:14,344 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8877  memory:  6.31GiB(13.29%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank2]:2025-11-05 14:00:14,344 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-05 14:00:14,356 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8877  memory: 15.04GiB(31.66%)  tps: 2,815  tflops: 21.44  mfu: 6.87%
[rank3]:2025-11-05 14:00:14,356 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 14:00:14,381 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8877  memory: 10.95GiB(23.04%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank0]:2025-11-05 14:00:14,381 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 14:02:23,569 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:02:25,935 - INFO - Avg. fwd time: 6.7260 / Avg. bwd time: 21.8340 / Avg. batch time: 565.3206 (ms) / GPU bubble ratio: 19.17%
[rank2]:2025-11-05 14:02:25,993 - INFO - Avg. fwd time: 3.9613 / Avg. bwd time: 10.0289 / Avg. batch time: 597.9559 (ms) / GPU bubble ratio: 62.57%
[rank0]:2025-11-05 14:02:26,013 - INFO - Avg. fwd time: 4.0909 / Avg. bwd time: 11.9825 / Avg. batch time: 650.0082 (ms) / GPU bubble ratio: 60.44%
[rank1]:2025-11-05 14:02:26,095 - INFO - Avg. fwd time: 4.8623 / Avg. bwd time: 12.2421 / Avg. batch time: 627.3495 (ms) / GPU bubble ratio: 56.38%
[rank0]:2025-11-05 14:02:26,272 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.8352  memory: 14.75GiB(31.06%)  tps: 6,087  tflops: 46.36  mfu: 14.86%
[rank1]:2025-11-05 14:02:26,261 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.8352  memory: 11.85GiB(24.93%)  tps: 6,086  tflops: 46.35  mfu: 14.86%
[rank2]:2025-11-05 14:02:26,258 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.8352  memory:  8.13GiB(17.12%)  tps: 6,086  tflops: 46.35  mfu: 14.86%
[rank3]:2025-11-05 14:02:26,270 - INFO -  step: 50  loss:  9.2204  grad_norm: 15.8352  memory: 18.46GiB(38.86%)  tps: 6,086  tflops: 46.35  mfu: 14.86%
[rank3]:2025-11-05 14:02:53,290 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-05 14:03:20,164 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank2]:2025-11-05 14:03:20,510 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,526 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,474 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-05 14:03:20,503 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,513 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,521 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,529 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,520 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,536 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,555 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,521 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,538 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,558 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,542 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,562 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,579 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,599 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,541 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,562 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,583 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,603 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,572 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,592 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,612 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,579 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,600 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,656 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,639 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,665 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,697 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,728 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,656 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,689 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,722 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,730 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,671 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,677 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,721 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,737 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,745 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,751 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,758 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,768 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,680 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,727 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,747 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,751 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,760 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,767 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,772 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,736 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,747 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,754 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,765 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,772 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 14:03:20,785 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,736 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,748 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,755 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:03:20,761 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,779 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 14:03:20,792 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,786 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,801 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 14:03:20,813 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 14:04:00,091 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-05 14:04:00,399 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1404_max_batch_time.svg
[rank3]:> Batch Time: 527.24 ms, GPU Bubble Ratio: 50.87%, 47.78%, 57.25%, 12.21%
[rank3]:2025-11-05 14:04:00,642 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1404_min_batch_time.svg
[rank3]:> Batch Time: 328.49 ms, GPU Bubble Ratio: 68.88%, 48.81%, 57.22%, 10.21%
[rank3]:2025-11-05 14:04:00,905 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1404_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.63 ms, GPU Bubble Ratio: 40.96%, 36.08%, 45.85%, 8.44%
[rank3]:2025-11-05 14:04:00,905 - INFO - 	> Batch Time: 371.63 ms (Average Freeze Ratio: 0.37, Time Reduction Rate: 0.30)
[rank0]:2025-11-05 14:04:19,903 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:04:21,803 - INFO - Avg. fwd time: 7.0647 / Avg. bwd time: 19.1749 / Avg. batch time: 531.9610 (ms) / GPU bubble ratio: 21.08%
[rank3]:2025-11-05 14:04:21,811 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.20/0.60, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB0] 0.33/1.00, [MB1] 0.31/0.94, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.22/0.66
[rank1]:2025-11-05 14:04:21,844 - INFO - Avg. fwd time: 5.1246 / Avg. bwd time: 10.5086 / Avg. batch time: 589.8978 (ms) / GPU bubble ratio: 57.60%
[rank0]:2025-11-05 14:04:21,775 - INFO - Avg. fwd time: 4.2894 / Avg. bwd time: 9.4590 / Avg. batch time: 608.5251 (ms) / GPU bubble ratio: 63.85%
[rank2]:2025-11-05 14:04:21,830 - INFO - Avg. fwd time: 4.1696 / Avg. bwd time: 8.7195 / Avg. batch time: 563.6540 (ms) / GPU bubble ratio: 63.41%
[rank1]:2025-11-05 14:04:22,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-05 14:04:22,045 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2662  memory: 11.85GiB(24.93%)  tps: 7,075  tflops: 53.89  mfu: 17.27%
[rank0]:2025-11-05 14:04:22,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.06/0.18, [MB4] 0.19/0.58, [MB5] 0.19/0.56, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-11-05 14:04:22,045 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2662  memory: 14.75GiB(31.06%)  tps: 7,076  tflops: 53.89  mfu: 17.27%
[rank2]:2025-11-05 14:04:22,031 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.30/0.89, [MB6] 0.22/0.66, [MB7] 0.33/1.00
[rank2]:2025-11-05 14:04:22,045 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2662  memory:  8.13GiB(17.12%)  tps: 7,075  tflops: 53.89  mfu: 17.27%
[rank2]:2025-11-05 14:04:22,104 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1404_stage2_step100.svg
[rank3]:2025-11-05 14:04:22,043 - INFO -  step: 100  loss:  4.7704  grad_norm:  0.2662  memory: 18.46GiB(38.86%)  tps: 7,076  tflops: 53.89  mfu: 17.27%
[rank1]:2025-11-05 14:04:22,102 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1404_stage1_step100.svg
[rank1]:2025-11-05 14:04:22,139 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1404_stage5_step100.svg
[rank0]:2025-11-05 14:04:22,102 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1404_stage0_step100.svg
[rank0]:2025-11-05 14:04:22,139 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1404_stage4_step100.svg
[rank2]:2025-11-05 14:04:22,142 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1404_stage6_step100.svg
[rank3]:2025-11-05 14:04:22,281 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1404_real_step100_rank3.svg
[rank3]:> Batch Time: 509.50 ms, GPU Bubble Ratio: 71.35%, 60.81%, 64.99%, 33.98%
[rank3]:2025-11-05 14:04:22,324 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1404_stage3_step100.svg
[rank3]:2025-11-05 14:04:22,361 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1404_stage7_step100.svg
[rank0]:2025-11-05 14:06:20,202 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-05 14:06:22,467 - INFO - Avg. fwd time: 4.2191 / Avg. bwd time: 8.5315 / Avg. batch time: 556.5100 (ms) / GPU bubble ratio: 63.34%
[rank2]:2025-11-05 14:06:22,473 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.59/0.89, [MB6] 0.44/0.66, [MB7] 0.67/1.00
[rank3]:2025-11-05 14:06:22,448 - INFO - Avg. fwd time: 7.1412 / Avg. bwd time: 18.6161 / Avg. batch time: 526.3408 (ms) / GPU bubble ratio: 21.70%
[rank3]:2025-11-05 14:06:22,452 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.60, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.62/0.94, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.44/0.66
[rank1]:2025-11-05 14:06:22,486 - INFO - Avg. fwd time: 5.1716 / Avg. bwd time: 10.1674 / Avg. batch time: 581.1222 (ms) / GPU bubble ratio: 57.77%
[rank1]:2025-11-05 14:06:22,491 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-11-05 14:06:22,501 - INFO - Avg. fwd time: 4.3102 / Avg. bwd time: 9.2495 / Avg. batch time: 599.0521 (ms) / GPU bubble ratio: 63.78%
[rank0]:2025-11-05 14:06:22,505 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.12/0.18, [MB4] 0.39/0.58, [MB5] 0.37/0.56, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-11-05 14:06:22,514 - INFO -  step: 150  loss: -4.0000  grad_norm:  7.5988  memory: 15.07GiB(31.71%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank2]:2025-11-05 14:06:22,514 - INFO -  step: 150  loss: -4.0000  grad_norm:  7.5988  memory:  8.27GiB(17.40%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank3]:2025-11-05 14:06:22,527 - INFO -  step: 150  loss:  1.4765  grad_norm:  7.5988  memory: 18.95GiB(39.89%)  tps: 6,799  tflops: 51.79  mfu: 16.60%
[rank1]:2025-11-05 14:06:22,515 - INFO -  step: 150  loss: -4.0000  grad_norm:  7.5988  memory: 12.16GiB(25.59%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank0]:2025-11-05 14:08:11,531 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 14:08:13,436 - INFO - Avg. fwd time: 4.3490 / Avg. bwd time: 8.6531 / Avg. batch time: 586.2964 (ms) / GPU bubble ratio: 64.52%
[rank2]:2025-11-05 14:08:13,482 - INFO - Avg. fwd time: 4.2752 / Avg. bwd time: 8.2702 / Avg. batch time: 546.4509 (ms) / GPU bubble ratio: 63.27%
[rank1]:2025-11-05 14:08:13,527 - INFO - Avg. fwd time: 5.2350 / Avg. bwd time: 9.7178 / Avg. batch time: 569.6886 (ms) / GPU bubble ratio: 58.00%
[rank3]:2025-11-05 14:08:13,457 - INFO - Avg. fwd time: 7.2347 / Avg. bwd time: 17.8525 / Avg. batch time: 517.6324 (ms) / GPU bubble ratio: 22.46%
[rank3]:2025-11-05 14:08:13,464 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.60/0.60, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.94/0.94, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.66/0.66
[rank2]:2025-11-05 14:08:13,682 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.89/0.89, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank2]:2025-11-05 14:08:13,699 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1765  memory:  8.29GiB(17.44%)  tps: 7,368  tflops: 56.12  mfu: 17.99%
[rank1]:2025-11-05 14:08:13,691 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 14:08:13,699 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1765  memory: 12.16GiB(25.59%)  tps: 7,368  tflops: 56.12  mfu: 17.99%
[rank3]:2025-11-05 14:08:13,699 - INFO -  step: 200  loss:  0.5550  grad_norm:  0.1765  memory: 18.95GiB(39.89%)  tps: 7,369  tflops: 56.12  mfu: 17.99%
[rank0]:2025-11-05 14:08:13,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.18/0.18, [MB4] 0.58/0.58, [MB5] 0.56/0.56, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-05 14:08:13,698 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1765  memory: 15.07GiB(31.71%)  tps: 7,368  tflops: 56.12  mfu: 17.99%
[rank0]:2025-11-05 14:08:13,749 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1408_stage0_step200.svg
[rank2]:2025-11-05 14:08:13,751 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1408_stage2_step200.svg
[rank2]:2025-11-05 14:08:13,792 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1408_stage6_step200.svg
[rank1]:2025-11-05 14:08:13,750 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1408_stage1_step200.svg
[rank1]:2025-11-05 14:08:13,791 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1408_stage5_step200.svg
[rank0]:2025-11-05 14:08:13,790 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1408_stage4_step200.svg
[rank3]:2025-11-05 14:08:13,943 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1408_real_step200_rank3.svg
[rank3]:> Batch Time: 528.62 ms, GPU Bubble Ratio: 66.78%, 60.50%, 64.76%, 33.59%
[rank3]:2025-11-05 14:08:13,987 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1408_stage3_step200.svg
[rank3]:2025-11-05 14:08:14,028 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1408_stage7_step200.svg
[rank0]:2025-11-05 14:09:59,177 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 14:10:01,060 - INFO - Avg. fwd time: 4.3837 / Avg. bwd time: 7.8184 / Avg. batch time: 572.9979 (ms) / GPU bubble ratio: 65.93%
[rank2]:2025-11-05 14:10:01,117 - INFO - Avg. fwd time: 4.3404 / Avg. bwd time: 7.9338 / Avg. batch time: 536.3197 (ms) / GPU bubble ratio: 63.38%
[rank1]:2025-11-05 14:10:01,130 - INFO - Avg. fwd time: 5.3171 / Avg. bwd time: 9.1407 / Avg. batch time: 558.1275 (ms) / GPU bubble ratio: 58.55%
[rank3]:2025-11-05 14:10:01,088 - INFO - Avg. fwd time: 7.3361 / Avg. bwd time: 17.0397 / Avg. batch time: 508.7001 (ms) / GPU bubble ratio: 23.33%
[rank3]:2025-11-05 14:10:01,096 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.60/0.60, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.94/0.94, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.66/0.66
[rank2]:2025-11-05 14:10:01,310 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.89/0.89, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank2]:2025-11-05 14:10:01,325 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2757  memory:  8.29GiB(17.44%)  tps: 7,612  tflops: 57.97  mfu: 18.58%
[rank1]:2025-11-05 14:10:01,318 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 14:10:01,324 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2757  memory: 12.16GiB(25.59%)  tps: 7,612  tflops: 57.97  mfu: 18.58%
[rank3]:2025-11-05 14:10:01,337 - INFO -  step: 250  loss:  0.3351  grad_norm:  0.2757  memory: 18.95GiB(39.89%)  tps: 7,611  tflops: 57.97  mfu: 18.58%
[rank0]:2025-11-05 14:10:01,319 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.18/0.18, [MB4] 0.58/0.58, [MB5] 0.56/0.56, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-05 14:10:01,324 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2757  memory: 15.07GiB(31.71%)  tps: 7,612  tflops: 57.97  mfu: 18.58%
[rank0]:2025-11-05 14:11:45,357 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:11:47,468 - INFO - Avg. fwd time: 7.3945 / Avg. bwd time: 16.4610 / Avg. batch time: 502.0501 (ms) / GPU bubble ratio: 23.97%
[rank3]:2025-11-05 14:11:47,473 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.60/0.60, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.94/0.94, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.66/0.66
[rank2]:2025-11-05 14:11:47,489 - INFO - Avg. fwd time: 4.3833 / Avg. bwd time: 7.7076 / Avg. batch time: 528.7183 (ms) / GPU bubble ratio: 63.41%
[rank2]:2025-11-05 14:11:47,494 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.89/0.89, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank0]:2025-11-05 14:11:47,516 - INFO - Avg. fwd time: 4.4008 / Avg. bwd time: 7.2886 / Avg. batch time: 563.2818 (ms) / GPU bubble ratio: 66.80%
[rank0]:2025-11-05 14:11:47,520 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.18/0.18, [MB4] 0.58/0.58, [MB5] 0.56/0.56, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-05 14:11:47,525 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0993  memory: 15.07GiB(31.71%)  tps: 7,714  tflops: 58.75  mfu: 18.83%
[rank1]:2025-11-05 14:11:47,505 - INFO - Avg. fwd time: 5.3710 / Avg. bwd time: 8.7521 / Avg. batch time: 549.5803 (ms) / GPU bubble ratio: 58.88%
[rank1]:2025-11-05 14:11:47,510 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 14:11:47,525 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0993  memory: 12.16GiB(25.59%)  tps: 7,714  tflops: 58.75  mfu: 18.83%
[rank3]:2025-11-05 14:11:47,524 - INFO -  step: 300  loss:  0.2855  grad_norm:  0.0993  memory: 18.95GiB(39.89%)  tps: 7,715  tflops: 58.76  mfu: 18.83%
[rank2]:2025-11-05 14:11:47,525 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0993  memory:  8.29GiB(17.44%)  tps: 7,714  tflops: 58.75  mfu: 18.83%
[rank2]:2025-11-05 14:11:47,579 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1411_stage2_step300.svg
[rank0]:2025-11-05 14:11:47,574 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1411_stage0_step300.svg
[rank0]:2025-11-05 14:11:47,613 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1411_stage4_step300.svg
[rank1]:2025-11-05 14:11:47,574 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1411_stage1_step300.svg
[rank1]:2025-11-05 14:11:47,613 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1411_stage5_step300.svg
[rank2]:2025-11-05 14:11:47,622 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1411_stage6_step300.svg
[rank3]:2025-11-05 14:11:47,762 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1411_real_step300_rank3.svg
[rank3]:> Batch Time: 516.00 ms, GPU Bubble Ratio: 71.09%, 61.10%, 65.18%, 34.09%
[rank3]:2025-11-05 14:11:47,805 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1411_stage3_step300.svg
[rank3]:2025-11-05 14:11:47,845 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1411_stage7_step300.svg
[rank0]:2025-11-05 14:13:32,029 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-05 14:13:33,974 - INFO - Avg. fwd time: 5.4042 / Avg. bwd time: 8.5122 / Avg. batch time: 544.4537 (ms) / GPU bubble ratio: 59.10%
[rank0]:2025-11-05 14:13:33,910 - INFO - Avg. fwd time: 4.4123 / Avg. bwd time: 6.9522 / Avg. batch time: 557.4336 (ms) / GPU bubble ratio: 67.38%
[rank3]:2025-11-05 14:13:33,931 - INFO - Avg. fwd time: 7.4294 / Avg. bwd time: 16.1068 / Avg. batch time: 497.9341 (ms) / GPU bubble ratio: 24.37%
[rank2]:2025-11-05 14:13:33,961 - INFO - Avg. fwd time: 4.4099 / Avg. bwd time: 7.5679 / Avg. batch time: 524.1781 (ms) / GPU bubble ratio: 63.44%
[rank1]:2025-11-05 14:13:34,165 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1334  memory: 12.16GiB(25.59%)  tps: 7,682  tflops: 58.51  mfu: 18.75%
[rank0]:2025-11-05 14:13:34,165 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1334  memory: 15.07GiB(31.71%)  tps: 7,682  tflops: 58.51  mfu: 18.75%
[rank3]:2025-11-05 14:13:34,177 - INFO -  step: 350  loss:  0.2717  grad_norm:  0.1334  memory: 18.95GiB(39.89%)  tps: 7,681  tflops: 58.50  mfu: 18.75%
[rank2]:2025-11-05 14:13:34,165 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1334  memory:  8.29GiB(17.44%)  tps: 7,682  tflops: 58.51  mfu: 18.75%
[rank0]:2025-11-05 14:15:18,947 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:15:20,858 - INFO - Avg. fwd time: 7.4597 / Avg. bwd time: 15.8238 / Avg. batch time: 494.7350 (ms) / GPU bubble ratio: 24.70%
[rank0]:2025-11-05 14:15:20,831 - INFO - Avg. fwd time: 4.4226 / Avg. bwd time: 6.6572 / Avg. batch time: 552.5558 (ms) / GPU bubble ratio: 67.92%
[rank2]:2025-11-05 14:15:20,886 - INFO - Avg. fwd time: 4.4320 / Avg. bwd time: 7.4459 / Avg. batch time: 520.4384 (ms) / GPU bubble ratio: 63.48%
[rank1]:2025-11-05 14:15:20,895 - INFO - Avg. fwd time: 5.4324 / Avg. bwd time: 8.3008 / Avg. batch time: 540.2031 (ms) / GPU bubble ratio: 59.32%
[rank3]:2025-11-05 14:15:21,094 - INFO -  step: 400  loss:  0.2643  grad_norm:  0.1146  memory: 18.95GiB(39.89%)  tps: 7,662  tflops: 58.36  mfu: 18.70%
[rank0]:2025-11-05 14:15:21,094 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1146  memory: 15.07GiB(31.71%)  tps: 7,661  tflops: 58.35  mfu: 18.70%
[rank2]:2025-11-05 14:15:21,094 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1146  memory:  8.29GiB(17.44%)  tps: 7,661  tflops: 58.35  mfu: 18.70%
[rank1]:2025-11-05 14:15:21,094 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1146  memory: 12.16GiB(25.59%)  tps: 7,661  tflops: 58.35  mfu: 18.70%
[rank1]:2025-11-05 14:15:21,147 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1415_stage1_step400.svg
[rank0]:2025-11-05 14:15:21,147 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1415_stage0_step400.svg
[rank0]:2025-11-05 14:15:21,192 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1415_stage4_step400.svg
[rank2]:2025-11-05 14:15:21,149 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1415_stage2_step400.svg
[rank2]:2025-11-05 14:15:21,195 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1415_stage6_step400.svg
[rank1]:2025-11-05 14:15:21,192 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1415_stage5_step400.svg
[rank3]:2025-11-05 14:15:21,334 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1415_real_step400_rank3.svg
[rank3]:> Batch Time: 520.00 ms, GPU Bubble Ratio: 71.64%, 61.37%, 65.41%, 33.80%
[rank3]:2025-11-05 14:15:21,381 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1415_stage3_step400.svg
[rank3]:2025-11-05 14:15:21,425 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1415_stage7_step400.svg
[rank3]:2025-11-05 14:15:32,581 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 14:15:32,803 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 14:15:32,796 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 14:15:32,803 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 14:17:06,014 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-05 14:17:08,090 - INFO - Avg. fwd time: 7.4846 / Avg. bwd time: 15.5989 / Avg. batch time: 492.1946 (ms) / GPU bubble ratio: 24.96%
[rank2]:2025-11-05 14:17:08,114 - INFO - Avg. fwd time: 4.4502 / Avg. bwd time: 7.3528 / Avg. batch time: 517.5997 (ms) / GPU bubble ratio: 63.51%
[rank2]:2025-11-05 14:17:08,154 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1108  memory:  8.29GiB(17.44%)  tps: 7,652  tflops: 58.28  mfu: 18.68%
[rank0]:2025-11-05 14:17:08,145 - INFO - Avg. fwd time: 4.4315 / Avg. bwd time: 6.4299 / Avg. batch time: 548.8501 (ms) / GPU bubble ratio: 68.34%
[rank0]:2025-11-05 14:17:08,154 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1108  memory: 15.07GiB(31.71%)  tps: 7,652  tflops: 58.28  mfu: 18.68%
[rank1]:2025-11-05 14:17:08,132 - INFO - Avg. fwd time: 5.4558 / Avg. bwd time: 8.1401 / Avg. batch time: 536.9756 (ms) / GPU bubble ratio: 59.49%
[rank1]:2025-11-05 14:17:08,154 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1108  memory: 12.16GiB(25.59%)  tps: 7,652  tflops: 58.28  mfu: 18.68%
[rank3]:2025-11-05 14:17:08,151 - INFO -  step: 450  loss:  0.2587  grad_norm:  0.1108  memory: 18.95GiB(39.89%)  tps: 7,652  tflops: 58.28  mfu: 18.68%
[rank0]:2025-11-05 14:18:52,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 14:18:54,734 - INFO - Avg. fwd time: 4.4362 / Avg. bwd time: 6.2834 / Avg. batch time: 546.1240 (ms) / GPU bubble ratio: 68.59%
[rank3]:2025-11-05 14:18:54,762 - INFO - Avg. fwd time: 7.5040 / Avg. bwd time: 15.4378 / Avg. batch time: 490.3740 (ms) / GPU bubble ratio: 25.15%
[rank2]:2025-11-05 14:18:54,788 - INFO - Avg. fwd time: 4.4624 / Avg. bwd time: 7.2889 / Avg. batch time: 515.4726 (ms) / GPU bubble ratio: 63.52%
[rank1]:2025-11-05 14:18:54,798 - INFO - Avg. fwd time: 5.4729 / Avg. bwd time: 8.0301 / Avg. batch time: 534.5797 (ms) / GPU bubble ratio: 59.59%
[rank2]:2025-11-05 14:18:54,996 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1146  memory:  8.29GiB(17.44%)  tps: 7,667  tflops: 58.40  mfu: 18.72%
[rank1]:2025-11-05 14:18:54,996 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1146  memory: 12.16GiB(25.59%)  tps: 7,667  tflops: 58.40  mfu: 18.72%
[rank0]:2025-11-05 14:18:54,996 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1146  memory: 15.07GiB(31.71%)  tps: 7,667  tflops: 58.40  mfu: 18.72%
[rank3]:2025-11-05 14:18:55,009 - INFO -  step: 500  loss:  0.2814  grad_norm:  0.1146  memory: 18.95GiB(39.89%)  tps: 7,666  tflops: 58.39  mfu: 18.71%
[rank2]:2025-11-05 14:18:55,068 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1418_stage2_step500.svg
[rank2]:2025-11-05 14:18:55,109 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1418_stage6_step500.svg
[rank1]:2025-11-05 14:18:55,059 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1418_stage1_step500.svg
[rank1]:2025-11-05 14:18:55,099 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1418_stage5_step500.svg
[rank0]:2025-11-05 14:18:55,059 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1418_stage0_step500.svg
[rank0]:2025-11-05 14:18:55,099 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1418_stage4_step500.svg
[rank3]:2025-11-05 14:18:55,245 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1418_real_step500_rank3.svg
[rank3]:> Batch Time: 524.00 ms, GPU Bubble Ratio: 71.57%, 61.60%, 65.68%, 34.12%
[rank3]:2025-11-05 14:18:55,287 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1418_stage3_step500.svg
[rank3]:2025-11-05 14:18:55,326 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1418_stage7_step500.svg
[rank0]:2025-11-05 14:20:40,527 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 14:20:42,437 - INFO - Avg. fwd time: 4.4414 / Avg. bwd time: 6.1356 / Avg. batch time: 543.9847 (ms) / GPU bubble ratio: 68.89%
[rank3]:2025-11-05 14:20:42,469 - INFO - Avg. fwd time: 7.5236 / Avg. bwd time: 15.3014 / Avg. batch time: 488.9874 (ms) / GPU bubble ratio: 25.31%
[rank2]:2025-11-05 14:20:42,497 - INFO - Avg. fwd time: 4.4747 / Avg. bwd time: 7.2272 / Avg. batch time: 513.9030 (ms) / GPU bubble ratio: 63.57%
[rank1]:2025-11-05 14:20:42,509 - INFO - Avg. fwd time: 5.4874 / Avg. bwd time: 7.9246 / Avg. batch time: 532.7540 (ms) / GPU bubble ratio: 59.72%
[rank0]:2025-11-05 14:20:42,701 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1238  memory: 15.07GiB(31.71%)  tps: 7,606  tflops: 57.93  mfu: 18.57%
[rank3]:2025-11-05 14:20:42,713 - INFO -  step: 550  loss:  0.3245  grad_norm:  0.1238  memory: 18.95GiB(39.89%)  tps: 7,606  tflops: 57.93  mfu: 18.57%
[rank2]:2025-11-05 14:20:42,701 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1238  memory:  8.29GiB(17.44%)  tps: 7,606  tflops: 57.93  mfu: 18.57%
[rank1]:2025-11-05 14:20:42,701 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1238  memory: 12.16GiB(25.59%)  tps: 7,606  tflops: 57.93  mfu: 18.57%
[rank0]:2025-11-05 14:22:27,870 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 14:22:30,051 - INFO - Avg. fwd time: 4.4472 / Avg. bwd time: 6.0018 / Avg. batch time: 542.1243 (ms) / GPU bubble ratio: 69.16%
[rank1]:2025-11-05 14:22:30,037 - INFO - Avg. fwd time: 5.4996 / Avg. bwd time: 7.8364 / Avg. batch time: 531.1503 (ms) / GPU bubble ratio: 59.83%
[rank1]:2025-11-05 14:22:30,060 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0980  memory: 12.16GiB(25.59%)  tps: 7,630  tflops: 58.12  mfu: 18.63%
[rank3]:2025-11-05 14:22:29,994 - INFO - Avg. fwd time: 7.5371 / Avg. bwd time: 15.1951 / Avg. batch time: 487.8530 (ms) / GPU bubble ratio: 25.45%
[rank3]:2025-11-05 14:22:30,059 - INFO -  step: 600  loss:  0.2425  grad_norm:  0.0980  memory: 19.46GiB(40.96%)  tps: 7,632  tflops: 58.12  mfu: 18.63%
[rank2]:2025-11-05 14:22:30,017 - INFO - Avg. fwd time: 4.4846 / Avg. bwd time: 7.1771 / Avg. batch time: 512.5110 (ms) / GPU bubble ratio: 63.59%
[rank2]:2025-11-05 14:22:30,060 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0980  memory:  8.29GiB(17.44%)  tps: 7,630  tflops: 58.12  mfu: 18.63%
[rank0]:2025-11-05 14:22:30,060 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0980  memory: 15.07GiB(31.71%)  tps: 7,630  tflops: 58.12  mfu: 18.63%
[rank0]:2025-11-05 14:22:30,111 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1422_stage0_step600.svg
[rank0]:2025-11-05 14:22:30,156 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1422_stage4_step600.svg
[rank1]:2025-11-05 14:22:30,111 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1422_stage1_step600.svg
[rank1]:2025-11-05 14:22:30,152 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1422_stage5_step600.svg
[rank2]:2025-11-05 14:22:30,110 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1422_stage2_step600.svg
[rank2]:2025-11-05 14:22:30,152 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1422_stage6_step600.svg
[rank3]:2025-11-05 14:22:30,295 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1422_real_step600_rank3.svg
[rank3]:> Batch Time: 517.50 ms, GPU Bubble Ratio: 71.61%, 61.14%, 65.20%, 33.97%
[rank3]:2025-11-05 14:22:30,339 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1422_stage3_step600.svg
[rank3]:2025-11-05 14:22:30,380 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1422_stage7_step600.svg
[rank0]:2025-11-05 14:24:15,473 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 14:24:17,374 - INFO - Avg. fwd time: 4.4504 / Avg. bwd time: 5.9115 / Avg. batch time: 540.7647 (ms) / GPU bubble ratio: 69.34%
[rank3]:2025-11-05 14:24:17,401 - INFO - Avg. fwd time: 7.5483 / Avg. bwd time: 15.1100 / Avg. batch time: 486.9400 (ms) / GPU bubble ratio: 25.55%
[rank2]:2025-11-05 14:24:17,429 - INFO - Avg. fwd time: 4.4915 / Avg. bwd time: 7.1406 / Avg. batch time: 511.4957 (ms) / GPU bubble ratio: 63.61%
[rank1]:2025-11-05 14:24:17,441 - INFO - Avg. fwd time: 5.5085 / Avg. bwd time: 7.7726 / Avg. batch time: 529.9793 (ms) / GPU bubble ratio: 59.90%
[rank2]:2025-11-05 14:24:17,630 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1240  memory:  8.29GiB(17.44%)  tps: 7,616  tflops: 58.00  mfu: 18.59%
[rank0]:2025-11-05 14:24:17,630 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1240  memory: 15.07GiB(31.71%)  tps: 7,616  tflops: 58.00  mfu: 18.59%
[rank1]:2025-11-05 14:24:17,630 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1240  memory: 12.16GiB(25.59%)  tps: 7,616  tflops: 58.00  mfu: 18.59%
[rank3]:2025-11-05 14:24:17,642 - INFO -  step: 650  loss:  0.2547  grad_norm:  0.1240  memory: 19.46GiB(40.96%)  tps: 7,615  tflops: 57.99  mfu: 18.59%
[rank0]:2025-11-05 14:26:02,356 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 14:26:04,265 - INFO - Avg. fwd time: 4.4552 / Avg. bwd time: 5.8105 / Avg. batch time: 539.2440 (ms) / GPU bubble ratio: 69.54%
[rank3]:2025-11-05 14:26:04,299 - INFO - Avg. fwd time: 7.5588 / Avg. bwd time: 15.0219 / Avg. batch time: 485.9530 (ms) / GPU bubble ratio: 25.65%
[rank1]:2025-11-05 14:26:04,336 - INFO - Avg. fwd time: 5.5175 / Avg. bwd time: 7.7080 / Avg. batch time: 528.6530 (ms) / GPU bubble ratio: 59.97%
[rank2]:2025-11-05 14:26:04,326 - INFO - Avg. fwd time: 4.4986 / Avg. bwd time: 7.1033 / Avg. batch time: 510.3235 (ms) / GPU bubble ratio: 63.62%
[rank0]:2025-11-05 14:26:04,524 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1059  memory: 15.07GiB(31.71%)  tps: 7,664  tflops: 58.37  mfu: 18.71%
[rank3]:2025-11-05 14:26:04,538 - INFO -  step: 700  loss:  0.2340  grad_norm:  0.1059  memory: 19.46GiB(40.96%)  tps: 7,664  tflops: 58.37  mfu: 18.71%
[rank1]:2025-11-05 14:26:04,524 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1059  memory: 12.16GiB(25.59%)  tps: 7,664  tflops: 58.37  mfu: 18.71%
[rank2]:2025-11-05 14:26:04,524 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1059  memory:  8.29GiB(17.44%)  tps: 7,664  tflops: 58.37  mfu: 18.71%
[rank2]:2025-11-05 14:26:04,594 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1426_stage2_step700.svg
[rank0]:2025-11-05 14:26:04,590 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1426_stage0_step700.svg
[rank1]:2025-11-05 14:26:04,591 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1426_stage1_step700.svg
[rank1]:2025-11-05 14:26:04,634 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1426_stage5_step700.svg
[rank2]:2025-11-05 14:26:04,638 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1426_stage6_step700.svg
[rank0]:2025-11-05 14:26:04,633 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1426_stage4_step700.svg
[rank3]:2025-11-05 14:26:04,779 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1426_real_step700_rank3.svg
[rank3]:> Batch Time: 526.50 ms, GPU Bubble Ratio: 72.25%, 61.93%, 65.86%, 33.16%
[rank3]:2025-11-05 14:26:04,825 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1426_stage3_step700.svg
[rank3]:2025-11-05 14:26:04,868 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1426_stage7_step700.svg
[rank0]:2025-11-05 14:27:49,644 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-05 14:27:51,740 - INFO - Avg. fwd time: 4.5043 / Avg. bwd time: 7.0710 / Avg. batch time: 509.4215 (ms) / GPU bubble ratio: 63.64%
[rank3]:2025-11-05 14:27:51,712 - INFO - Avg. fwd time: 7.5647 / Avg. bwd time: 14.9513 / Avg. batch time: 485.1395 (ms) / GPU bubble ratio: 25.74%
[rank3]:2025-11-05 14:27:51,782 - INFO -  step: 750  loss:  0.2941  grad_norm:  0.1113  memory: 19.46GiB(40.96%)  tps: 7,639  tflops: 58.18  mfu: 18.65%
[rank1]:2025-11-05 14:27:51,761 - INFO - Avg. fwd time: 5.5244 / Avg. bwd time: 7.6516 / Avg. batch time: 527.6182 (ms) / GPU bubble ratio: 60.04%
[rank1]:2025-11-05 14:27:51,785 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1113  memory: 12.16GiB(25.59%)  tps: 7,638  tflops: 58.17  mfu: 18.64%
[rank0]:2025-11-05 14:27:51,775 - INFO - Avg. fwd time: 4.4590 / Avg. bwd time: 5.7236 / Avg. batch time: 538.0426 (ms) / GPU bubble ratio: 69.72%
[rank0]:2025-11-05 14:27:51,785 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1113  memory: 15.07GiB(31.71%)  tps: 7,638  tflops: 58.17  mfu: 18.64%
[rank2]:2025-11-05 14:27:51,785 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1113  memory:  8.29GiB(17.44%)  tps: 7,638  tflops: 58.17  mfu: 18.64%
[rank0]:2025-11-05 14:29:35,737 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:29:37,630 - INFO - Avg. fwd time: 7.5697 / Avg. bwd time: 14.8824 / Avg. batch time: 484.2975 (ms) / GPU bubble ratio: 25.82%
[rank0]:2025-11-05 14:29:37,604 - INFO - Avg. fwd time: 4.4607 / Avg. bwd time: 5.6685 / Avg. batch time: 536.8502 (ms) / GPU bubble ratio: 69.81%
[rank2]:2025-11-05 14:29:37,658 - INFO - Avg. fwd time: 4.5088 / Avg. bwd time: 7.0458 / Avg. batch time: 508.4590 (ms) / GPU bubble ratio: 63.64%
[rank1]:2025-11-05 14:29:37,670 - INFO - Avg. fwd time: 5.5300 / Avg. bwd time: 7.6091 / Avg. batch time: 526.5525 (ms) / GPU bubble ratio: 60.08%
[rank3]:2025-11-05 14:29:37,851 - INFO -  step: 800  loss:  0.2425  grad_norm:  0.1175  memory: 19.46GiB(40.96%)  tps: 7,723  tflops: 58.82  mfu: 18.85%
[rank1]:2025-11-05 14:29:37,855 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1175  memory: 12.16GiB(25.59%)  tps: 7,723  tflops: 58.82  mfu: 18.85%
[rank0]:2025-11-05 14:29:37,855 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1175  memory: 15.07GiB(31.71%)  tps: 7,723  tflops: 58.82  mfu: 18.85%
[rank2]:2025-11-05 14:29:37,855 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1175  memory:  8.29GiB(17.44%)  tps: 7,723  tflops: 58.82  mfu: 18.85%
[rank1]:2025-11-05 14:29:37,908 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1429_stage1_step800.svg
[rank1]:2025-11-05 14:29:37,954 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1429_stage5_step800.svg
[rank0]:2025-11-05 14:29:37,908 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1429_stage0_step800.svg
[rank0]:2025-11-05 14:29:37,954 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1429_stage4_step800.svg
[rank2]:2025-11-05 14:29:37,922 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1429_stage2_step800.svg
[rank2]:2025-11-05 14:29:37,972 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1429_stage6_step800.svg
[rank3]:2025-11-05 14:29:38,108 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1429_real_step800_rank3.svg
[rank3]:> Batch Time: 515.50 ms, GPU Bubble Ratio: 71.12%, 61.04%, 65.17%, 33.75%
[rank3]:2025-11-05 14:29:38,158 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1429_stage3_step800.svg
[rank3]:2025-11-05 14:29:38,204 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1429_stage7_step800.svg
[rank3]:2025-11-05 14:30:00,606 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 14:30:00,818 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 14:30:00,821 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 14:30:00,821 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 14:31:22,792 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 14:31:24,682 - INFO - Avg. fwd time: 4.4638 / Avg. bwd time: 5.6071 / Avg. batch time: 535.8115 (ms) / GPU bubble ratio: 69.93%
[rank2]:2025-11-05 14:31:24,735 - INFO - Avg. fwd time: 4.5145 / Avg. bwd time: 7.0204 / Avg. batch time: 507.6530 (ms) / GPU bubble ratio: 63.64%
[rank3]:2025-11-05 14:31:24,708 - INFO - Avg. fwd time: 7.5761 / Avg. bwd time: 14.8157 / Avg. batch time: 483.5416 (ms) / GPU bubble ratio: 25.91%
[rank1]:2025-11-05 14:31:24,746 - INFO - Avg. fwd time: 5.5365 / Avg. bwd time: 7.5658 / Avg. batch time: 525.6433 (ms) / GPU bubble ratio: 60.12%
[rank2]:2025-11-05 14:31:24,932 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1271  memory:  8.29GiB(17.44%)  tps: 7,651  tflops: 58.27  mfu: 18.68%
[rank3]:2025-11-05 14:31:24,943 - INFO -  step: 850  loss:  0.2501  grad_norm:  0.1271  memory: 19.46GiB(40.96%)  tps: 7,650  tflops: 58.26  mfu: 18.67%
[rank1]:2025-11-05 14:31:24,932 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1271  memory: 12.16GiB(25.59%)  tps: 7,651  tflops: 58.27  mfu: 18.68%
[rank0]:2025-11-05 14:31:24,932 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1271  memory: 15.07GiB(31.71%)  tps: 7,651  tflops: 58.27  mfu: 18.68%
[rank0]:2025-11-05 14:33:10,261 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:33:12,411 - INFO - Avg. fwd time: 7.5831 / Avg. bwd time: 14.7749 / Avg. batch time: 483.1357 (ms) / GPU bubble ratio: 25.96%
[rank2]:2025-11-05 14:33:12,442 - INFO - Avg. fwd time: 4.5186 / Avg. bwd time: 6.9985 / Avg. batch time: 507.1363 (ms) / GPU bubble ratio: 63.66%
[rank2]:2025-11-05 14:33:12,490 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0979  memory:  8.29GiB(17.44%)  tps: 7,616  tflops: 58.01  mfu: 18.59%
[rank3]:2025-11-05 14:33:12,501 - INFO -  step: 900  loss:  0.2175  grad_norm:  0.0979  memory: 19.46GiB(40.96%)  tps: 7,616  tflops: 58.01  mfu: 18.59%
[rank1]:2025-11-05 14:33:12,464 - INFO - Avg. fwd time: 5.5416 / Avg. bwd time: 7.5278 / Avg. batch time: 525.0384 (ms) / GPU bubble ratio: 60.17%
[rank1]:2025-11-05 14:33:12,490 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0979  memory: 12.16GiB(25.59%)  tps: 7,616  tflops: 58.01  mfu: 18.59%
[rank1]:2025-11-05 14:33:12,550 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1433_stage1_step900.svg
[rank0]:2025-11-05 14:33:12,480 - INFO - Avg. fwd time: 4.4659 / Avg. bwd time: 5.5521 / Avg. batch time: 535.0957 (ms) / GPU bubble ratio: 70.05%
[rank0]:2025-11-05 14:33:12,490 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0979  memory: 15.07GiB(31.71%)  tps: 7,616  tflops: 58.01  mfu: 18.59%
[rank0]:2025-11-05 14:33:12,550 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1433_stage0_step900.svg
[rank2]:2025-11-05 14:33:12,553 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1433_stage2_step900.svg
[rank2]:2025-11-05 14:33:12,594 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1433_stage6_step900.svg
[rank1]:2025-11-05 14:33:12,589 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1433_stage5_step900.svg
[rank0]:2025-11-05 14:33:12,589 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1433_stage4_step900.svg
[rank3]:2025-11-05 14:33:12,760 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1433_real_step900_rank3.svg
[rank3]:> Batch Time: 525.00 ms, GPU Bubble Ratio: 71.88%, 61.70%, 65.71%, 33.26%
[rank3]:2025-11-05 14:33:12,804 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1433_stage3_step900.svg
[rank3]:2025-11-05 14:33:12,845 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1433_stage7_step900.svg
[rank0]:2025-11-05 14:34:57,819 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 14:34:59,689 - INFO - Avg. fwd time: 4.4677 / Avg. bwd time: 5.5119 / Avg. batch time: 534.5222 (ms) / GPU bubble ratio: 70.13%
[rank3]:2025-11-05 14:34:59,712 - INFO - Avg. fwd time: 7.5894 / Avg. bwd time: 14.7359 / Avg. batch time: 482.7427 (ms) / GPU bubble ratio: 26.01%
[rank2]:2025-11-05 14:34:59,744 - INFO - Avg. fwd time: 4.5221 / Avg. bwd time: 6.9815 / Avg. batch time: 506.7183 (ms) / GPU bubble ratio: 63.68%
[rank1]:2025-11-05 14:34:59,756 - INFO - Avg. fwd time: 5.5461 / Avg. bwd time: 7.4990 / Avg. batch time: 524.5499 (ms) / GPU bubble ratio: 60.21%
[rank3]:2025-11-05 14:34:59,934 - INFO -  step: 950  loss:  0.2673  grad_norm:  0.1102  memory: 19.46GiB(40.96%)  tps: 7,625  tflops: 58.08  mfu: 18.61%
[rank2]:2025-11-05 14:34:59,936 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1102  memory:  8.29GiB(17.44%)  tps: 7,624  tflops: 58.07  mfu: 18.61%
[rank1]:2025-11-05 14:34:59,936 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1102  memory: 12.16GiB(25.59%)  tps: 7,624  tflops: 58.07  mfu: 18.61%
[rank0]:2025-11-05 14:34:59,936 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1102  memory: 15.07GiB(31.71%)  tps: 7,624  tflops: 58.07  mfu: 18.61%
[rank0]:2025-11-05 14:36:45,285 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 14:36:47,200 - INFO - Avg. fwd time: 4.4688 / Avg. bwd time: 5.4705 / Avg. batch time: 533.8490 (ms) / GPU bubble ratio: 70.21%
[rank3]:2025-11-05 14:36:47,235 - INFO - Avg. fwd time: 7.5952 / Avg. bwd time: 14.6983 / Avg. batch time: 482.3360 (ms) / GPU bubble ratio: 26.05%
[rank2]:2025-11-05 14:36:47,263 - INFO - Avg. fwd time: 4.5250 / Avg. bwd time: 6.9639 / Avg. batch time: 506.2087 (ms) / GPU bubble ratio: 63.69%
[rank1]:2025-11-05 14:36:47,274 - INFO - Avg. fwd time: 5.5506 / Avg. bwd time: 7.4685 / Avg. batch time: 523.9669 (ms) / GPU bubble ratio: 60.24%
[rank3]:2025-11-05 14:36:47,471 - INFO -  step: 1000  loss:  0.2591  grad_norm:  0.1095  memory: 19.46GiB(40.96%)  tps: 7,618  tflops: 58.02  mfu: 18.60%
[rank2]:2025-11-05 14:36:47,460 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1095  memory:  8.29GiB(17.44%)  tps: 7,619  tflops: 58.03  mfu: 18.60%
[rank1]:2025-11-05 14:36:47,460 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1095  memory: 12.16GiB(25.59%)  tps: 7,619  tflops: 58.03  mfu: 18.60%
[rank1]:2025-11-05 14:36:47,526 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1436_stage1_step1000.svg
[rank0]:2025-11-05 14:36:47,460 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1095  memory: 15.07GiB(31.71%)  tps: 7,619  tflops: 58.03  mfu: 18.60%
[rank0]:2025-11-05 14:36:47,526 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1436_stage0_step1000.svg
[rank2]:2025-11-05 14:36:47,534 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1436_stage2_step1000.svg
[rank2]:2025-11-05 14:36:47,576 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1436_stage6_step1000.svg
[rank1]:2025-11-05 14:36:47,567 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1436_stage5_step1000.svg
[rank0]:2025-11-05 14:36:47,567 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1436_stage4_step1000.svg
[rank3]:2025-11-05 14:36:47,733 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1436_real_step1000_rank3.svg
[rank3]:> Batch Time: 524.50 ms, GPU Bubble Ratio: 71.92%, 61.61%, 65.70%, 33.82%
[rank3]:2025-11-05 14:36:47,777 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1436_stage3_step1000.svg
[rank3]:2025-11-05 14:36:47,818 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1436_stage7_step1000.svg
[rank0]:2025-11-05 14:38:32,515 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-05 14:38:34,645 - INFO - Avg. fwd time: 4.5291 / Avg. bwd time: 6.9477 / Avg. batch time: 505.6934 (ms) / GPU bubble ratio: 63.69%
[rank3]:2025-11-05 14:38:34,618 - INFO - Avg. fwd time: 7.6027 / Avg. bwd time: 14.6507 / Avg. batch time: 481.8404 (ms) / GPU bubble ratio: 26.11%
[rank1]:2025-11-05 14:38:34,669 - INFO - Avg. fwd time: 5.5555 / Avg. bwd time: 7.4417 / Avg. batch time: 523.3882 (ms) / GPU bubble ratio: 60.27%
[rank1]:2025-11-05 14:38:34,696 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1164  memory: 12.16GiB(25.59%)  tps: 7,639  tflops: 58.18  mfu: 18.65%
[rank2]:2025-11-05 14:38:34,696 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1164  memory:  8.29GiB(17.44%)  tps: 7,639  tflops: 58.18  mfu: 18.65%
[rank0]:2025-11-05 14:38:34,687 - INFO - Avg. fwd time: 4.4705 / Avg. bwd time: 5.4315 / Avg. batch time: 533.1916 (ms) / GPU bubble ratio: 70.29%
[rank0]:2025-11-05 14:38:34,696 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1164  memory: 15.07GiB(31.71%)  tps: 7,639  tflops: 58.18  mfu: 18.65%
[rank3]:2025-11-05 14:38:34,694 - INFO -  step: 1050  loss:  0.3025  grad_norm:  0.1164  memory: 19.46GiB(40.96%)  tps: 7,640  tflops: 58.19  mfu: 18.65%
[rank0]:2025-11-05 14:40:19,732 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:40:21,686 - INFO - Avg. fwd time: 7.6074 / Avg. bwd time: 14.6206 / Avg. batch time: 481.5191 (ms) / GPU bubble ratio: 26.14%
[rank0]:2025-11-05 14:40:21,663 - INFO - Avg. fwd time: 4.4717 / Avg. bwd time: 5.4037 / Avg. batch time: 532.6888 (ms) / GPU bubble ratio: 70.34%
[rank1]:2025-11-05 14:40:21,730 - INFO - Avg. fwd time: 5.5589 / Avg. bwd time: 7.4206 / Avg. batch time: 522.9490 (ms) / GPU bubble ratio: 60.29%
[rank2]:2025-11-05 14:40:21,719 - INFO - Avg. fwd time: 4.5316 / Avg. bwd time: 6.9350 / Avg. batch time: 505.3055 (ms) / GPU bubble ratio: 63.69%
[rank1]:2025-11-05 14:40:21,910 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1081  memory: 12.16GiB(25.59%)  tps: 7,641  tflops: 58.19  mfu: 18.65%
[rank3]:2025-11-05 14:40:21,921 - INFO -  step: 1100  loss:  0.2624  grad_norm:  0.1081  memory: 19.46GiB(40.96%)  tps: 7,640  tflops: 58.19  mfu: 18.65%
[rank0]:2025-11-05 14:40:21,910 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1081  memory: 15.07GiB(31.71%)  tps: 7,641  tflops: 58.19  mfu: 18.65%
[rank0]:2025-11-05 14:40:21,971 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1440_stage0_step1100.svg
[rank2]:2025-11-05 14:40:21,910 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1081  memory:  8.29GiB(17.44%)  tps: 7,641  tflops: 58.19  mfu: 18.65%
[rank2]:2025-11-05 14:40:21,973 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1440_stage2_step1100.svg
[rank1]:2025-11-05 14:40:21,971 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1440_stage1_step1100.svg
[rank1]:2025-11-05 14:40:22,012 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1440_stage5_step1100.svg
[rank0]:2025-11-05 14:40:22,012 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1440_stage4_step1100.svg
[rank2]:2025-11-05 14:40:22,014 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1440_stage6_step1100.svg
[rank3]:2025-11-05 14:40:22,157 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1440_real_step1100_rank3.svg
[rank3]:> Batch Time: 523.00 ms, GPU Bubble Ratio: 71.41%, 61.53%, 65.66%, 33.77%
[rank3]:2025-11-05 14:40:22,201 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1440_stage3_step1100.svg
[rank3]:2025-11-05 14:40:22,242 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1440_stage7_step1100.svg
[rank0]:2025-11-05 14:42:07,082 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 14:42:08,984 - INFO - Avg. fwd time: 4.4727 / Avg. bwd time: 5.3727 / Avg. batch time: 532.1817 (ms) / GPU bubble ratio: 70.40%
[rank3]:2025-11-05 14:42:09,017 - INFO - Avg. fwd time: 7.6114 / Avg. bwd time: 14.5870 / Avg. batch time: 481.1598 (ms) / GPU bubble ratio: 26.18%
[rank2]:2025-11-05 14:42:09,055 - INFO - Avg. fwd time: 4.5348 / Avg. bwd time: 6.9213 / Avg. batch time: 504.9227 (ms) / GPU bubble ratio: 63.70%
[rank1]:2025-11-05 14:42:09,059 - INFO - Avg. fwd time: 5.5624 / Avg. bwd time: 7.3977 / Avg. batch time: 522.5109 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-11-05 14:42:09,235 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1024  memory: 15.07GiB(31.71%)  tps: 7,633  tflops: 58.13  mfu: 18.63%
[rank3]:2025-11-05 14:42:09,247 - INFO -  step: 1150  loss:  0.2616  grad_norm:  0.1024  memory: 19.46GiB(40.96%)  tps: 7,633  tflops: 58.13  mfu: 18.63%
[rank2]:2025-11-05 14:42:09,235 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1024  memory:  8.29GiB(17.44%)  tps: 7,633  tflops: 58.13  mfu: 18.63%
[rank1]:2025-11-05 14:42:09,235 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1024  memory: 12.16GiB(25.59%)  tps: 7,633  tflops: 58.13  mfu: 18.63%
[rank0]:2025-11-05 14:43:53,721 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 14:43:55,894 - INFO - Avg. fwd time: 7.6145 / Avg. bwd time: 14.5532 / Avg. batch time: 480.7810 (ms) / GPU bubble ratio: 26.23%
[rank0]:2025-11-05 14:43:55,972 - INFO - Avg. fwd time: 4.4738 / Avg. bwd time: 5.3425 / Avg. batch time: 531.6291 (ms) / GPU bubble ratio: 70.46%
[rank0]:2025-11-05 14:43:55,981 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1102  memory: 15.07GiB(31.71%)  tps: 7,674  tflops: 58.45  mfu: 18.73%
[rank0]:2025-11-05 14:43:55,981 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1102  tps: 7,788  tflops: 59.32  mfu: 17.80%
[rank0]:2025-11-05 14:43:55,982 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-05 14:43:55,982 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-05 14:43:55,996 - INFO -  step: 1200  loss:  0.2643  grad_norm:  0.1102  memory: 19.46GiB(40.96%)  tps: 7,674  tflops: 58.45  mfu: 18.73%
[rank3]:2025-11-05 14:43:55,997 - INFO -  final step: 1200  loss:  0.2643  grad_norm:  0.1102  tps: 7,795  tflops: 59.37  mfu: 17.88%
[rank3]:2025-11-05 14:43:55,997 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-05 14:43:55,998 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-05 14:43:55,927 - INFO - Avg. fwd time: 4.5377 / Avg. bwd time: 6.9088 / Avg. batch time: 504.4795 (ms) / GPU bubble ratio: 63.70%
[rank2]:2025-11-05 14:43:55,981 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1102  memory:  8.29GiB(17.44%)  tps: 7,674  tflops: 58.45  mfu: 18.73%
[rank2]:2025-11-05 14:43:55,982 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1102  tps: 7,787  tflops: 59.31  mfu: 17.80%
[rank2]:2025-11-05 14:43:55,982 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-05 14:43:55,983 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-05 14:43:55,953 - INFO - Avg. fwd time: 5.5656 / Avg. bwd time: 7.3761 / Avg. batch time: 522.0196 (ms) / GPU bubble ratio: 60.33%
[rank1]:2025-11-05 14:43:55,981 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1102  memory: 12.16GiB(25.59%)  tps: 7,674  tflops: 58.45  mfu: 18.73%
[rank1]:2025-11-05 14:43:55,982 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1102  tps: 7,788  tflops: 59.31  mfu: 17.80%
[rank1]:2025-11-05 14:43:55,982 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-05 14:43:55,982 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-05 14:43:57,916 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-05 14:43:57,998 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1443_stage2_final1200.svg
[rank1]:2025-11-05 14:43:57,997 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1443_stage1_final1200.svg
[rank0]:2025-11-05 14:43:57,997 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1443_stage0_final1200.svg
[rank2]:2025-11-05 14:43:58,105 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank2_stage2.svg
[rank2]:	> Counts Sum: 364560, Total Sum: 650880 (56.01%), Ratio(%) per element: [55.97, 56.85, 55.53, 55.86, 57.19, 55.97, 54.86, 56.3, 55.75, 54.86, 57.07, 55.53, 55.75, 56.63, 55.64, 56.08, 55.42, 56.85]
[rank1]:2025-11-05 14:43:58,129 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank1_stage1.svg
[rank1]:	> Counts Sum: 495360, Total Sum: 976320 (50.74%), Ratio(%) per element: [50.77, 50.66, 51.21, 50.77, 50.55, 50.77, 50.77, 51.1, 50.99, 50.22, 51.43, 51.1, 50.33, 50.99, 50.99, 50.33, 50.55, 50.99, 50.33, 50.77, 50.77, 50.33, 50.77, 50.77, 50.44, 50.22, 50.88]
[rank0]:2025-11-05 14:43:58,106 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank0_stage0.svg
[rank0]:	> Counts Sum: 451840, Total Sum: 687040 (65.77%), Ratio(%) per element: [57.19, 57.63, 57.19, 58.4, 57.74, 60.61, 59.84, 62.83, 63.05, 65.48, 65.26, 64.6, 67.47, 70.46, 71.79, 73.56, 75.55, 79.64, 81.19]
[rank0]:2025-11-05 14:43:58,149 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251105_1443_stage4_final1200.svg
[rank3]:2025-11-05 14:43:58,189 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1443_real_final1200_rank3.svg
[rank3]:> Batch Time: 522.00 ms, GPU Bubble Ratio: 71.83%, 61.51%, 65.56%, 34.25%
[rank2]:2025-11-05 14:43:58,148 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251105_1443_stage6_final1200.svg
[rank1]:2025-11-05 14:43:58,173 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251105_1443_stage5_final1200.svg
[rank0]:2025-11-05 14:43:58,249 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank0_stage4.svg
[rank0]:	> Counts Sum: 626400, Total Sum: 650880 (96.24%), Ratio(%) per element: [96.9, 96.23, 96.01, 95.57, 95.9, 96.23, 96.57, 96.23, 96.01, 96.01, 96.23, 95.46, 95.79, 96.46, 96.57, 96.79, 96.23, 97.01]
[rank0]:2025-11-05 14:43:58,249 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-05 14:43:58,248 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank2_stage6.svg
[rank2]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.39, 86.28, 86.17, 86.17, 86.61, 86.39, 86.61, 86.5, 86.5, 86.5, 86.06, 86.06, 86.61, 86.17, 86.28, 86.06, 86.5, 86.5]
[rank2]:2025-11-05 14:43:58,249 - INFO - Destroying the purge thread.
[rank1]:2025-11-05 14:43:58,273 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank1_stage5.svg
[rank1]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.06, 86.28, 86.17, 85.95, 86.61, 86.5, 86.5, 86.5, 86.28, 86.39, 86.39, 86.28, 86.39, 86.39, 86.28, 86.5, 86.39, 86.5]
[rank1]:2025-11-05 14:43:58,273 - INFO - Destroying the purge thread.
[rank3]:2025-11-05 14:43:58,446 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/pipeline_schedule/251105_1443_thry_final1200_rank3.svg
[rank3]:> Batch Time: 318.70 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-05 14:43:58,492 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1443_stage3_final1200.svg
[rank2]:2025-11-05 14:43:58,486 - INFO - Process group destroyed
[rank1]:2025-11-05 14:43:58,501 - INFO - Process group destroyed
[rank3]:2025-11-05 14:43:58,602 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank3_stage3.svg
[rank3]:	> Counts Sum: 205760, Total Sum: 650880 (31.61%), Ratio(%) per element: [31.74, 30.19, 31.08, 32.07, 31.63, 31.63, 32.07, 30.86, 31.96, 31.3, 30.75, 31.19, 32.74, 31.63, 31.85, 31.41, 32.07, 32.74]
[rank3]:2025-11-05 14:43:58,646 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251105_1443_stage7_final1200.svg
[rank3]:2025-11-05 14:43:58,729 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1/frozen_params_histogram/251105_1443_rank3_stage7.svg
[rank3]:	> Counts Sum: 125200, Total Sum: 397760 (31.48%), Ratio(%) per element: [31.19, 31.41, 30.75, 32.19, 32.07, 30.75, 32.07, 32.41, 31.52, 30.42, 31.41]
[rank3]:2025-11-05 14:43:58,729 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.10194
[rank3]:wandb:               final/avg_loss 0.26429
[rank3]:wandb:             final/avg_mfu(%) 17.87929
[rank3]:wandb:             final/avg_tflops 59.36623
[rank3]:wandb:    final/avg_throughput(tps) 7794.71783
[rank3]:wandb:              final/grad_norm 0.11016
[rank3]:wandb:               final/max_loss 0.26429
[rank3]:wandb:                    grad_norm 0.11016
[rank3]:wandb: loss_metrics/global_avg_loss 0.26429
[rank3]:wandb: loss_metrics/global_max_loss 0.26429
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_Interleaved1F1B_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/c12gzqq2
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_fullrand7_dm1/20251105-1400/wandb/run-20251105_140007-c12gzqq2/logs
[rank3]:2025-11-05 14:44:00,051 - INFO - Process group destroyed
[rank0]:2025-11-05 14:44:00,249 - INFO - Training completed
[rank0]:2025-11-05 14:44:00,250 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 14:44:00,555 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.2', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_Interleaved1F1B_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_Interleaved1F1B_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_Interleaved1F1B_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_Interleaved1F1B_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_Interleaved1F1B_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
