
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 06:11:47 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_1F1B_nofreeze_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with nofreeze x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-24 06:11:53,985 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-24 06:11:53,987 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-24 06:11:54,044 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-24 06:11:54,222 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 06:11:54,226 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 06:11:54,288 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 06:11:54,290 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 06:11:54,293 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 06:11:54,294 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-24 06:11:54,238 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank1]:2025-12-24 06:11:54,381 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 06:11:54,384 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-24 06:11:54,531 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 06:11:54,534 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 06:11:54,689 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-24 06:11:57,520 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-24 06:11:57,673 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 06:11:57,714 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 06:11:57,715 - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-12-24 06:11:57,734 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 06:11:57,741 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-24 06:11:57,741 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-24 06:11:57,774 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 06:11:57,800 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-24 06:11:57,800 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-24 06:11:57,927 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 06:11:57,970 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 06:11:57,998 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-24 06:11:57,999 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-24 06:11:57,960 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 06:11:57,961 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 06:11:57,961 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-24 06:11:58,021 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 06:11:58,021 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 06:11:58,021 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-24 06:11:58,184 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 06:11:58,184 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 06:11:58,185 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 0xix6ahc
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_1F1B_nofreeze_42_dm1/20251224-0611/wandb/run-20251224_061158-0xix6ahc
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_1F1B_nofreeze_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/0xix6ahc
[rank3]:2025-12-24 06:11:59,904 - WandB logging enabled
[rank3]:2025-12-24 06:11:59,904 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 06:11:59,945 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 06:11:59,976 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-24 06:11:59,977 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-24 06:12:00,178 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 06:12:00,179 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 06:12:00,180 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 06:12:00,195 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-24 06:12:00,196 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 06:12:00,195 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_1F1B_nofreeze_42_dm1
[rank0]:2025-12-24 06:12:00,196 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 06:12:00,196 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 06:12:00,196 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-24 06:12:00,196 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 06:12:03,096 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 06:12:03,096 - Finished loading the checkpoint in 2.90 seconds.
[rank0]:2025-12-24 06:12:03,096 - Training starts at step 1
[rank3]:2025-12-24 06:12:08,499 -  step:  1  loss: 10.6092  grad_norm: 203.0657  memory: 21.88GiB(46.05%)  tps: 3,832  tflops: 29.96  mfu: 9.60%
[rank3]:2025-12-24 06:12:08,500 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-24 06:12:08,490 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory:  6.84GiB(14.41%)  tps: 3,115  tflops: 24.35  mfu: 7.80%
[rank2]:2025-12-24 06:12:08,491 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 06:12:08,536 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 13.10GiB(27.57%)  tps: 3,028  tflops: 23.67  mfu: 7.59%
[rank0]:2025-12-24 06:12:08,536 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 06:12:08,491 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 10.58GiB(22.26%)  tps: 3,058  tflops: 23.90  mfu: 7.66%
[rank1]:2025-12-24 06:12:08,491 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 06:16:01,595 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 06:16:06,352 - Avg. fwd time: 15.4205 / Avg. bwd time: 35.9359 / Avg. batch time: 1048.5953 (ms) / GPU bubble ratio: 60.82%
[rank3]:2025-12-24 06:16:06,310 - Avg. fwd time: 24.6376 / Avg. bwd time: 80.9118 / Avg. batch time: 989.3664 (ms) / GPU bubble ratio: 14.65%
[rank1]:2025-12-24 06:16:06,405 - Avg. fwd time: 19.8098 / Avg. bwd time: 46.4451 / Avg. batch time: 1122.4965 (ms) / GPU bubble ratio: 52.78%
[rank0]:2025-12-24 06:16:06,453 - Avg. fwd time: 16.0070 / Avg. bwd time: 41.5275 / Avg. batch time: 1188.3278 (ms) / GPU bubble ratio: 61.27%
[rank2]:2025-12-24 06:16:06,475 -  step: 50  loss: -4.0000  grad_norm: 24.5130  memory:  8.66GiB(18.23%)  tps: 6,747  tflops: 52.74  mfu: 16.90%
[rank1]:2025-12-24 06:16:06,478 -  step: 50  loss: -4.0000  grad_norm: 24.5130  memory: 12.86GiB(27.07%)  tps: 6,747  tflops: 52.74  mfu: 16.90%
[rank0]:2025-12-24 06:16:06,491 -  step: 50  loss: -4.0000  grad_norm: 24.5130  memory: 16.87GiB(35.50%)  tps: 6,748  tflops: 52.75  mfu: 16.91%
[rank3]:2025-12-24 06:16:06,486 -  step: 50  loss:  9.8839  grad_norm: 24.5130  memory: 25.79GiB(54.28%)  tps: 6,747  tflops: 52.74  mfu: 16.90%
[rank0]:2025-12-24 06:20:05,036 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:20:09,707 - Avg. fwd time: 24.6736 / Avg. bwd time: 81.1361 / Avg. batch time: 991.3721 (ms) / GPU bubble ratio: 14.62%
[rank2]:2025-12-24 06:20:09,750 - Avg. fwd time: 15.4336 / Avg. bwd time: 36.0186 / Avg. batch time: 1050.2637 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-12-24 06:20:09,803 - Avg. fwd time: 19.7927 / Avg. bwd time: 46.5448 / Avg. batch time: 1123.7676 (ms) / GPU bubble ratio: 52.77%
[rank0]:2025-12-24 06:20:09,851 - Avg. fwd time: 16.0266 / Avg. bwd time: 41.5924 / Avg. batch time: 1189.2616 (ms) / GPU bubble ratio: 61.24%
[rank1]:2025-12-24 06:20:09,876 -  step: 100  loss: -4.0000  grad_norm: 15.6798  memory: 12.86GiB(27.07%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank2]:2025-12-24 06:20:09,873 -  step: 100  loss: -4.0000  grad_norm: 15.6798  memory:  8.66GiB(18.23%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank3]:2025-12-24 06:20:09,885 -  step: 100  loss:  8.2096  grad_norm: 15.6798  memory: 25.79GiB(54.28%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank0]:2025-12-24 06:20:09,889 -  step: 100  loss: -4.0000  grad_norm: 15.6798  memory: 16.87GiB(35.50%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank3]:2025-12-24 06:20:10,066 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0620_step100_rank3.svg
[rank3]:			> Batch Time: 1182.72 ms, GPU Bubble Ratio: 60.86%, 55.07%, 65.11%, 28.22%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  278-42-320ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  401-41-443ms   | [S0,MB5,F]  443-15-458ms   | [S0,MB2,B]  526-41-568ms   | [S0,MB6,F]  568-15-584ms   | [S0,MB3,B]  650-41-691ms   | [S0,MB7,F]  691-15-707ms   | [S0,MB4,B]  775-41-816ms   | [S0,MB5,B]  897-41-939ms   | [S0,MB6,B]  1020-41-1062ms | [S0,MB7,B]  1141-41-1182ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-46-268ms   | [S1,MB3,F]  274-19-294ms   | [S1,MB1,B]  343-46-390ms   | [S1,MB4,F]  397-20-417ms   | [S1,MB2,B]  469-46-516ms   | [S1,MB5,F]  523-20-543ms   | [S1,MB3,B]  593-47-640ms   | [S1,MB6,F]  646-20-667ms   | [S1,MB4,B]  718-46-765ms   | [S1,MB7,F]  772-20-792ms   | [S1,MB5,B]  843-46-890ms   | [S1,MB6,B]  967-46-1014ms  | [S1,MB7,B]  1088-46-1134ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  177-36-213ms   | [S2,MB2,F]  218-15-233ms   | [S2,MB1,B]  300-36-336ms   | [S2,MB3,F]  340-15-356ms   | [S2,MB2,B]  426-36-462ms   | [S2,MB4,F]  466-15-482ms   | [S2,MB3,B]  549-36-585ms   | [S2,MB5,F]  590-15-605ms   | [S2,MB4,B]  675-36-711ms   | [S2,MB6,F]  715-15-731ms   | [S2,MB5,B]  800-36-836ms   | [S2,MB7,F]  840-15-855ms   | [S2,MB6,B]  925-36-961ms   | [S2,MB7,B]  1046-36-1082ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  174-24-198ms   | [S3,MB1,B]  209-81-291ms   | [S3,MB2,F]  297-24-321ms   | [S3,MB2,B]  333-82-416ms   | [S3,MB3,F]  423-24-448ms   | [S3,MB3,B]  459-81-540ms   | [S3,MB4,F]  545-24-570ms   | [S3,MB4,B]  583-82-665ms   | [S3,MB5,F]  671-25-696ms   | [S3,MB5,B]  708-82-790ms   | [S3,MB6,F]  796-24-821ms   | [S3,MB6,B]  833-82-916ms   | [S3,MB7,F]  922-24-947ms   | [S3,MB7,B]  958-82-1040ms 
[rank0]:2025-12-24 06:24:08,586 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 06:24:13,369 - Avg. fwd time: 15.4276 / Avg. bwd time: 36.0517 / Avg. batch time: 1051.0133 (ms) / GPU bubble ratio: 60.82%
[rank3]:2025-12-24 06:24:13,326 - Avg. fwd time: 24.6791 / Avg. bwd time: 81.2207 / Avg. batch time: 992.0705 (ms) / GPU bubble ratio: 14.60%
[rank0]:2025-12-24 06:24:13,472 - Avg. fwd time: 16.0264 / Avg. bwd time: 41.6116 / Avg. batch time: 1189.7872 (ms) / GPU bubble ratio: 61.24%
[rank1]:2025-12-24 06:24:13,423 - Avg. fwd time: 19.7993 / Avg. bwd time: 46.5939 / Avg. batch time: 1124.4091 (ms) / GPU bubble ratio: 52.76%
[rank2]:2025-12-24 06:24:13,494 -  step: 150  loss: -4.0000  grad_norm: 31.5908  memory:  8.66GiB(18.23%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank0]:2025-12-24 06:24:13,509 -  step: 150  loss: -4.0000  grad_norm: 31.5908  memory: 16.87GiB(35.50%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank3]:2025-12-24 06:24:13,506 -  step: 150  loss:  3.1888  grad_norm: 31.5908  memory: 25.79GiB(54.28%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank1]:2025-12-24 06:24:13,497 -  step: 150  loss: -4.0000  grad_norm: 31.5908  memory: 12.86GiB(27.07%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank0]:2025-12-24 06:28:12,221 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:28:16,984 - Avg. fwd time: 24.6934 / Avg. bwd time: 81.2624 / Avg. batch time: 992.5082 (ms) / GPU bubble ratio: 14.60%
[rank2]:2025-12-24 06:28:17,028 - Avg. fwd time: 15.4305 / Avg. bwd time: 36.1159 / Avg. batch time: 1051.3989 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-12-24 06:28:17,082 - Avg. fwd time: 19.8133 / Avg. bwd time: 46.6701 / Avg. batch time: 1124.7880 (ms) / GPU bubble ratio: 52.71%
[rank0]:2025-12-24 06:28:17,131 - Avg. fwd time: 16.0433 / Avg. bwd time: 41.6538 / Avg. batch time: 1190.1409 (ms) / GPU bubble ratio: 61.22%
[rank0]:2025-12-24 06:28:17,169 -  step: 200  loss: -4.0000  grad_norm: 15.6170  memory: 16.87GiB(35.50%)  tps: 6,724  tflops: 52.57  mfu: 16.85%
[rank3]:2025-12-24 06:28:17,165 -  step: 200  loss:  1.0192  grad_norm: 15.6170  memory: 25.79GiB(54.28%)  tps: 6,724  tflops: 52.57  mfu: 16.85%
[rank2]:2025-12-24 06:28:17,153 -  step: 200  loss: -4.0000  grad_norm: 15.6170  memory:  8.66GiB(18.23%)  tps: 6,724  tflops: 52.57  mfu: 16.85%
[rank1]:2025-12-24 06:28:17,156 -  step: 200  loss: -4.0000  grad_norm: 15.6170  memory: 12.86GiB(27.07%)  tps: 6,724  tflops: 52.57  mfu: 16.85%
[rank3]:2025-12-24 06:28:17,313 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0628_step200_rank3.svg
[rank3]:			> Batch Time: 1189.84 ms, GPU Bubble Ratio: 60.97%, 54.90%, 65.05%, 28.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  277-42-320ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  401-41-443ms   | [S0,MB5,F]  443-15-459ms   | [S0,MB2,B]  526-42-568ms   | [S0,MB6,F]  568-15-583ms   | [S0,MB3,B]  650-41-692ms   | [S0,MB7,F]  692-15-708ms   | [S0,MB4,B]  777-41-819ms   | [S0,MB5,B]  899-41-941ms   | [S0,MB6,B]  1025-41-1066ms | [S0,MB7,B]  1148-41-1189ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-47-267ms   | [S1,MB3,F]  274-20-294ms   | [S1,MB1,B]  344-47-391ms   | [S1,MB4,F]  398-20-419ms   | [S1,MB2,B]  468-47-515ms   | [S1,MB5,F]  522-20-543ms   | [S1,MB3,B]  593-47-640ms   | [S1,MB6,F]  647-20-668ms   | [S1,MB4,B]  719-47-766ms   | [S1,MB7,F]  774-20-794ms   | [S1,MB5,B]  846-47-893ms   | [S1,MB6,B]  971-47-1018ms  | [S1,MB7,B]  1094-46-1141ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-76ms     | [S2,MB0,B]  175-36-212ms   | [S2,MB2,F]  216-15-232ms   | [S2,MB1,B]  300-36-336ms   | [S2,MB3,F]  341-15-356ms   | [S2,MB2,B]  423-36-460ms   | [S2,MB4,F]  465-15-480ms   | [S2,MB3,B]  548-36-585ms   | [S2,MB5,F]  590-15-605ms   | [S2,MB4,B]  675-36-711ms   | [S2,MB6,F]  716-15-731ms   | [S2,MB5,B]  801-36-837ms   | [S2,MB7,F]  842-15-858ms   | [S2,MB6,B]  929-36-965ms   | [S2,MB7,B]  1052-36-1088ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-77-165ms    | [S3,MB1,F]  172-24-196ms   | [S3,MB1,B]  208-82-290ms   | [S3,MB2,F]  297-24-322ms   | [S3,MB2,B]  333-82-416ms   | [S3,MB3,F]  420-25-446ms   | [S3,MB3,B]  458-82-541ms   | [S3,MB4,F]  546-25-571ms   | [S3,MB4,B]  583-82-665ms   | [S3,MB5,F]  672-24-697ms   | [S3,MB5,B]  709-82-791ms   | [S3,MB6,F]  798-25-823ms   | [S3,MB6,B]  835-82-918ms   | [S3,MB7,F]  926-24-950ms   | [S3,MB7,B]  963-82-1045ms 
[rank0]:2025-12-24 06:32:16,214 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:32:20,905 - Avg. fwd time: 24.7104 / Avg. bwd time: 81.2809 / Avg. batch time: 992.7862 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 06:32:20,949 - Avg. fwd time: 15.4294 / Avg. bwd time: 36.1735 / Avg. batch time: 1051.7475 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-12-24 06:32:21,003 - Avg. fwd time: 19.8174 / Avg. bwd time: 46.7246 / Avg. batch time: 1125.1527 (ms) / GPU bubble ratio: 52.69%
[rank2]:2025-12-24 06:32:21,074 -  step: 250  loss: -4.0000  grad_norm:  4.1167  memory:  8.66GiB(18.23%)  tps: 6,717  tflops: 52.51  mfu: 16.83%
[rank0]:2025-12-24 06:32:21,052 - Avg. fwd time: 16.0554 / Avg. bwd time: 41.6806 / Avg. batch time: 1190.5048 (ms) / GPU bubble ratio: 61.20%
[rank0]:2025-12-24 06:32:21,091 -  step: 250  loss: -4.0000  grad_norm:  4.1167  memory: 16.87GiB(35.50%)  tps: 6,717  tflops: 52.51  mfu: 16.83%
[rank3]:2025-12-24 06:32:21,087 -  step: 250  loss:  0.3665  grad_norm:  4.1167  memory: 25.79GiB(54.28%)  tps: 6,717  tflops: 52.51  mfu: 16.83%
[rank1]:2025-12-24 06:32:21,078 -  step: 250  loss: -4.0000  grad_norm:  4.1167  memory: 12.86GiB(27.07%)  tps: 6,717  tflops: 52.51  mfu: 16.83%
[rank0]:2025-12-24 06:36:20,037 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:36:24,727 - Avg. fwd time: 24.7192 / Avg. bwd time: 81.3031 / Avg. batch time: 993.0289 (ms) / GPU bubble ratio: 14.59%
[rank1]:2025-12-24 06:36:24,826 - Avg. fwd time: 19.8171 / Avg. bwd time: 46.7626 / Avg. batch time: 1125.3686 (ms) / GPU bubble ratio: 52.67%
[rank2]:2025-12-24 06:36:24,772 - Avg. fwd time: 15.4256 / Avg. bwd time: 36.2173 / Avg. batch time: 1051.9697 (ms) / GPU bubble ratio: 60.73%
[rank3]:2025-12-24 06:36:24,910 -  step: 300  loss:  0.2702  grad_norm:  0.6215  memory: 25.79GiB(54.28%)  tps: 6,720  tflops: 52.53  mfu: 16.84%
[rank1]:2025-12-24 06:36:24,901 -  step: 300  loss: -4.0000  grad_norm:  0.6215  memory: 12.86GiB(27.07%)  tps: 6,720  tflops: 52.53  mfu: 16.84%
[rank0]:2025-12-24 06:36:24,876 - Avg. fwd time: 16.0620 / Avg. bwd time: 41.6979 / Avg. batch time: 1190.7147 (ms) / GPU bubble ratio: 61.19%
[rank0]:2025-12-24 06:36:24,914 -  step: 300  loss: -4.0000  grad_norm:  0.6215  memory: 16.87GiB(35.50%)  tps: 6,720  tflops: 52.53  mfu: 16.84%
[rank2]:2025-12-24 06:36:24,897 -  step: 300  loss: -4.0000  grad_norm:  0.6215  memory:  8.66GiB(18.23%)  tps: 6,720  tflops: 52.53  mfu: 16.84%
[rank3]:2025-12-24 06:36:25,063 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0636_step300_rank3.svg
[rank3]:			> Batch Time: 1191.91 ms, GPU Bubble Ratio: 61.02%, 55.11%, 65.09%, 28.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  278-42-320ms   | [S0,MB4,F]  320-15-336ms   | [S0,MB1,B]  402-41-443ms   | [S0,MB5,F]  444-15-460ms   | [S0,MB2,B]  527-42-569ms   | [S0,MB6,F]  569-15-584ms   | [S0,MB3,B]  655-41-696ms   | [S0,MB7,F]  697-15-712ms   | [S0,MB4,B]  778-41-819ms   | [S0,MB5,B]  900-41-942ms   | [S0,MB6,B]  1025-41-1066ms | [S0,MB7,B]  1150-41-1191ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-47-267ms   | [S1,MB3,F]  274-19-294ms   | [S1,MB1,B]  344-47-391ms   | [S1,MB4,F]  398-20-419ms   | [S1,MB2,B]  469-47-517ms   | [S1,MB5,F]  523-20-544ms   | [S1,MB3,B]  597-47-644ms   | [S1,MB6,F]  652-20-672ms   | [S1,MB4,B]  721-46-768ms   | [S1,MB7,F]  774-20-795ms   | [S1,MB5,B]  846-47-893ms   | [S1,MB6,B]  972-46-1019ms  | [S1,MB7,B]  1095-46-1142ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-213ms   | [S2,MB2,F]  217-15-233ms   | [S2,MB1,B]  300-36-337ms   | [S2,MB3,F]  341-15-357ms   | [S2,MB2,B]  425-36-462ms   | [S2,MB4,F]  466-15-482ms   | [S2,MB3,B]  553-36-589ms   | [S2,MB5,F]  594-15-609ms   | [S2,MB4,B]  677-36-713ms   | [S2,MB6,F]  718-15-733ms   | [S2,MB5,B]  802-36-838ms   | [S2,MB7,F]  843-15-858ms   | [S2,MB6,B]  929-36-965ms   | [S2,MB7,B]  1053-36-1089ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  209-82-291ms   | [S3,MB2,F]  297-24-322ms   | [S3,MB2,B]  334-82-416ms   | [S3,MB3,F]  422-25-447ms   | [S3,MB3,B]  459-82-541ms   | [S3,MB4,F]  549-24-574ms   | [S3,MB4,B]  586-82-669ms   | [S3,MB5,F]  673-25-699ms   | [S3,MB5,B]  709-82-792ms   | [S3,MB6,F]  799-24-824ms   | [S3,MB6,B]  836-82-918ms   | [S3,MB7,F]  925-25-950ms   | [S3,MB7,B]  964-82-1047ms 
[rank0]:2025-12-24 06:40:23,937 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:40:28,684 - Avg. fwd time: 24.7252 / Avg. bwd time: 81.3233 / Avg. batch time: 993.2409 (ms) / GPU bubble ratio: 14.58%
[rank2]:2025-12-24 06:40:28,729 - Avg. fwd time: 15.4183 / Avg. bwd time: 36.2432 / Avg. batch time: 1052.2240 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-12-24 06:40:28,784 - Avg. fwd time: 19.8201 / Avg. bwd time: 46.7864 / Avg. batch time: 1125.6217 (ms) / GPU bubble ratio: 52.66%
[rank0]:2025-12-24 06:40:28,834 - Avg. fwd time: 16.0666 / Avg. bwd time: 41.7086 / Avg. batch time: 1190.9583 (ms) / GPU bubble ratio: 61.19%
[rank3]:2025-12-24 06:40:28,868 -  step: 350  loss:  0.2270  grad_norm:  0.7816  memory: 25.79GiB(54.28%)  tps: 6,716  tflops: 52.50  mfu: 16.83%
[rank2]:2025-12-24 06:40:28,855 -  step: 350  loss: -4.0000  grad_norm:  0.7816  memory:  8.66GiB(18.23%)  tps: 6,716  tflops: 52.50  mfu: 16.83%
[rank1]:2025-12-24 06:40:28,859 -  step: 350  loss: -4.0000  grad_norm:  0.7816  memory: 12.86GiB(27.07%)  tps: 6,716  tflops: 52.50  mfu: 16.83%
[rank0]:2025-12-24 06:40:28,871 -  step: 350  loss: -4.0000  grad_norm:  0.7816  memory: 16.87GiB(35.50%)  tps: 6,716  tflops: 52.50  mfu: 16.83%
[rank0]:2025-12-24 06:44:27,519 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:44:32,283 - Avg. fwd time: 24.7232 / Avg. bwd time: 81.3244 / Avg. batch time: 993.2265 (ms) / GPU bubble ratio: 14.58%
[rank2]:2025-12-24 06:44:32,327 - Avg. fwd time: 15.4104 / Avg. bwd time: 36.2608 / Avg. batch time: 1052.1873 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-12-24 06:44:32,382 - Avg. fwd time: 19.8232 / Avg. bwd time: 46.8030 / Avg. batch time: 1125.5895 (ms) / GPU bubble ratio: 52.65%
[rank1]:2025-12-24 06:44:32,456 -  step: 400  loss: -4.0000  grad_norm:  0.1994  memory: 12.86GiB(27.07%)  tps: 6,726  tflops: 52.58  mfu: 16.85%
[rank2]:2025-12-24 06:44:32,453 -  step: 400  loss: -4.0000  grad_norm:  0.1994  memory:  8.66GiB(18.23%)  tps: 6,726  tflops: 52.58  mfu: 16.85%
[rank0]:2025-12-24 06:44:32,431 - Avg. fwd time: 16.0714 / Avg. bwd time: 41.7164 / Avg. batch time: 1190.9218 (ms) / GPU bubble ratio: 61.18%
[rank0]:2025-12-24 06:44:32,468 -  step: 400  loss: -4.0000  grad_norm:  0.1994  memory: 16.87GiB(35.50%)  tps: 6,726  tflops: 52.58  mfu: 16.85%
[rank3]:2025-12-24 06:44:32,465 -  step: 400  loss:  0.2119  grad_norm:  0.1994  memory: 25.79GiB(54.28%)  tps: 6,726  tflops: 52.58  mfu: 16.85%
[rank3]:2025-12-24 06:44:32,617 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0644_step400_rank3.svg
[rank3]:			> Batch Time: 1191.88 ms, GPU Bubble Ratio: 61.02%, 55.13%, 65.15%, 28.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  279-42-321ms   | [S0,MB4,F]  321-15-337ms   | [S0,MB1,B]  402-41-444ms   | [S0,MB5,F]  444-15-460ms   | [S0,MB2,B]  528-41-569ms   | [S0,MB6,F]  570-15-585ms   | [S0,MB3,B]  654-41-695ms   | [S0,MB7,F]  696-15-711ms   | [S0,MB4,B]  779-41-821ms   | [S0,MB5,B]  903-41-944ms   | [S0,MB6,B]  1027-41-1068ms | [S0,MB7,B]  1150-41-1191ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-47-268ms   | [S1,MB3,F]  276-19-295ms   | [S1,MB1,B]  345-47-392ms   | [S1,MB4,F]  399-20-420ms   | [S1,MB2,B]  470-46-517ms   | [S1,MB5,F]  524-20-545ms   | [S1,MB3,B]  596-47-643ms   | [S1,MB6,F]  650-20-671ms   | [S1,MB4,B]  722-47-769ms   | [S1,MB7,F]  776-20-796ms   | [S1,MB5,B]  848-46-895ms   | [S1,MB6,B]  974-46-1021ms  | [S1,MB7,B]  1095-46-1142ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-213ms   | [S2,MB2,F]  218-15-233ms   | [S2,MB1,B]  300-36-337ms   | [S2,MB3,F]  341-15-357ms   | [S2,MB2,B]  426-36-462ms   | [S2,MB4,F]  467-15-482ms   | [S2,MB3,B]  551-36-588ms   | [S2,MB5,F]  592-15-608ms   | [S2,MB4,B]  677-36-714ms   | [S2,MB6,F]  719-15-734ms   | [S2,MB5,B]  804-36-841ms   | [S2,MB7,F]  845-15-861ms   | [S2,MB6,B]  931-36-968ms   | [S2,MB7,B]  1053-36-1090ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  173-24-198ms   | [S3,MB1,B]  209-82-291ms   | [S3,MB2,F]  297-24-322ms   | [S3,MB2,B]  334-82-417ms   | [S3,MB3,F]  423-25-448ms   | [S3,MB3,B]  460-82-543ms   | [S3,MB4,F]  548-25-574ms   | [S3,MB4,B]  585-82-668ms   | [S3,MB5,F]  674-24-699ms   | [S3,MB5,B]  712-83-795ms   | [S3,MB6,F]  801-25-826ms   | [S3,MB6,B]  838-82-921ms   | [S3,MB7,F]  928-24-953ms   | [S3,MB7,B]  964-83-1047ms 
[rank3]:2025-12-24 06:44:59,948 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 06:45:00,364 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 06:45:00,415 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 06:45:00,459 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 06:48:30,994 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:48:35,679 - Avg. fwd time: 24.7171 / Avg. bwd time: 81.3192 / Avg. batch time: 993.1370 (ms) / GPU bubble ratio: 14.58%
[rank2]:2025-12-24 06:48:35,725 - Avg. fwd time: 15.4040 / Avg. bwd time: 36.2736 / Avg. batch time: 1052.1268 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-12-24 06:48:35,779 - Avg. fwd time: 19.8288 / Avg. bwd time: 46.8161 / Avg. batch time: 1125.5299 (ms) / GPU bubble ratio: 52.63%
[rank1]:2025-12-24 06:48:35,856 -  step: 450  loss: -4.0000  grad_norm:  0.2781  memory: 12.86GiB(27.07%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank0]:2025-12-24 06:48:35,830 - Avg. fwd time: 16.0772 / Avg. bwd time: 41.7225 / Avg. batch time: 1190.8564 (ms) / GPU bubble ratio: 61.17%
[rank0]:2025-12-24 06:48:35,869 -  step: 450  loss: -4.0000  grad_norm:  0.2781  memory: 16.87GiB(35.50%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank3]:2025-12-24 06:48:35,865 -  step: 450  loss:  0.2217  grad_norm:  0.2781  memory: 25.79GiB(54.28%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank2]:2025-12-24 06:48:35,852 -  step: 450  loss: -4.0000  grad_norm:  0.2781  memory:  8.66GiB(18.23%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank0]:2025-12-24 06:52:34,368 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:52:39,055 - Avg. fwd time: 24.7119 / Avg. bwd time: 81.3086 / Avg. batch time: 993.0054 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 06:52:39,101 - Avg. fwd time: 15.3980 / Avg. bwd time: 36.2821 / Avg. batch time: 1051.9707 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-12-24 06:52:39,157 - Avg. fwd time: 19.8373 / Avg. bwd time: 46.8286 / Avg. batch time: 1125.3878 (ms) / GPU bubble ratio: 52.61%
[rank0]:2025-12-24 06:52:39,208 - Avg. fwd time: 16.0787 / Avg. bwd time: 41.7272 / Avg. batch time: 1190.7137 (ms) / GPU bubble ratio: 61.16%
[rank3]:2025-12-24 06:52:39,243 -  step: 500  loss:  0.2123  grad_norm:  0.1849  memory: 25.79GiB(54.28%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank2]:2025-12-24 06:52:39,230 -  step: 500  loss: -4.0000  grad_norm:  0.1849  memory:  8.66GiB(18.23%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank1]:2025-12-24 06:52:39,234 -  step: 500  loss: -4.0000  grad_norm:  0.1849  memory: 12.86GiB(27.07%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank0]:2025-12-24 06:52:39,246 -  step: 500  loss: -4.0000  grad_norm:  0.1849  memory: 16.87GiB(35.50%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank3]:2025-12-24 06:52:39,399 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0652_step500_rank3.svg
[rank3]:			> Batch Time: 1188.81 ms, GPU Bubble Ratio: 60.98%, 54.95%, 65.13%, 28.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  278-42-321ms   | [S0,MB4,F]  321-15-336ms   | [S0,MB1,B]  401-41-442ms   | [S0,MB5,F]  442-15-458ms   | [S0,MB2,B]  526-41-567ms   | [S0,MB6,F]  568-15-583ms   | [S0,MB3,B]  650-41-691ms   | [S0,MB7,F]  692-15-707ms   | [S0,MB4,B]  777-41-819ms   | [S0,MB5,B]  899-41-941ms   | [S0,MB6,B]  1023-41-1065ms | [S0,MB7,B]  1147-41-1188ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-47-268ms   | [S1,MB3,F]  275-20-295ms   | [S1,MB1,B]  343-47-390ms   | [S1,MB4,F]  397-20-418ms   | [S1,MB2,B]  468-46-515ms   | [S1,MB5,F]  522-20-543ms   | [S1,MB3,B]  592-47-639ms   | [S1,MB6,F]  647-20-667ms   | [S1,MB4,B]  719-46-766ms   | [S1,MB7,F]  774-20-795ms   | [S1,MB5,B]  846-46-893ms   | [S1,MB6,B]  970-47-1017ms  | [S1,MB7,B]  1093-46-1140ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-212ms   | [S2,MB2,F]  217-15-232ms   | [S2,MB1,B]  299-36-335ms   | [S2,MB3,F]  340-15-355ms   | [S2,MB2,B]  423-36-460ms   | [S2,MB4,F]  465-15-480ms   | [S2,MB3,B]  548-36-584ms   | [S2,MB5,F]  589-15-605ms   | [S2,MB4,B]  675-36-711ms   | [S2,MB6,F]  716-15-732ms   | [S2,MB5,B]  802-36-838ms   | [S2,MB7,F]  843-15-858ms   | [S2,MB6,B]  928-36-964ms   | [S2,MB7,B]  1051-36-1087ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-166ms    | [S3,MB1,F]  173-23-196ms   | [S3,MB1,B]  208-81-289ms   | [S3,MB2,F]  296-24-321ms   | [S3,MB2,B]  333-82-415ms   | [S3,MB3,F]  420-25-446ms   | [S3,MB3,B]  458-82-540ms   | [S3,MB4,F]  545-25-570ms   | [S3,MB4,B]  582-82-665ms   | [S3,MB5,F]  672-25-697ms   | [S3,MB5,B]  709-82-792ms   | [S3,MB6,F]  798-24-823ms   | [S3,MB6,B]  835-82-918ms   | [S3,MB7,F]  924-24-949ms   | [S3,MB7,B]  962-82-1044ms 
[rank0]:2025-12-24 06:56:37,764 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 06:56:42,508 - Avg. fwd time: 24.7077 / Avg. bwd time: 81.3029 / Avg. batch time: 992.9208 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 06:56:42,553 - Avg. fwd time: 15.3921 / Avg. bwd time: 36.2884 / Avg. batch time: 1051.9075 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-12-24 06:56:42,609 - Avg. fwd time: 19.8446 / Avg. bwd time: 46.8352 / Avg. batch time: 1125.3219 (ms) / GPU bubble ratio: 52.60%
[rank2]:2025-12-24 06:56:42,682 -  step: 550  loss: -4.0000  grad_norm:  0.1795  memory:  8.66GiB(18.23%)  tps: 6,730  tflops: 52.61  mfu: 16.86%
[rank1]:2025-12-24 06:56:42,685 -  step: 550  loss: -4.0000  grad_norm:  0.1795  memory: 12.86GiB(27.07%)  tps: 6,730  tflops: 52.61  mfu: 16.86%
[rank0]:2025-12-24 06:56:42,660 - Avg. fwd time: 16.0806 / Avg. bwd time: 41.7311 / Avg. batch time: 1190.6420 (ms) / GPU bubble ratio: 61.16%
[rank0]:2025-12-24 06:56:42,699 -  step: 550  loss: -4.0000  grad_norm:  0.1795  memory: 16.87GiB(35.50%)  tps: 6,730  tflops: 52.61  mfu: 16.86%
[rank3]:2025-12-24 06:56:42,694 -  step: 550  loss:  0.2209  grad_norm:  0.1795  memory: 25.79GiB(54.28%)  tps: 6,730  tflops: 52.61  mfu: 16.86%
[rank0]:2025-12-24 07:00:41,200 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 07:00:45,983 - Avg. fwd time: 24.7059 / Avg. bwd time: 81.3022 / Avg. batch time: 992.8979 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 07:00:46,029 - Avg. fwd time: 15.3883 / Avg. bwd time: 36.2929 / Avg. batch time: 1051.8619 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-12-24 07:00:46,085 - Avg. fwd time: 19.8477 / Avg. bwd time: 46.8387 / Avg. batch time: 1125.2763 (ms) / GPU bubble ratio: 52.59%
[rank0]:2025-12-24 07:00:46,137 - Avg. fwd time: 16.0808 / Avg. bwd time: 41.7322 / Avg. batch time: 1190.5917 (ms) / GPU bubble ratio: 61.15%
[rank3]:2025-12-24 07:00:46,172 -  step: 600  loss:  0.2138  grad_norm:  0.1794  memory: 25.79GiB(54.28%)  tps: 6,729  tflops: 52.61  mfu: 16.86%
[rank1]:2025-12-24 07:00:46,162 -  step: 600  loss: -4.0000  grad_norm:  0.1794  memory: 12.86GiB(27.07%)  tps: 6,729  tflops: 52.61  mfu: 16.86%
[rank0]:2025-12-24 07:00:46,174 -  step: 600  loss: -4.0000  grad_norm:  0.1794  memory: 16.87GiB(35.50%)  tps: 6,729  tflops: 52.61  mfu: 16.86%
[rank2]:2025-12-24 07:00:46,159 -  step: 600  loss: -4.0000  grad_norm:  0.1794  memory:  8.66GiB(18.23%)  tps: 6,729  tflops: 52.61  mfu: 16.86%
[rank3]:2025-12-24 07:00:46,320 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0700_step600_rank3.svg
[rank3]:			> Batch Time: 1189.78 ms, GPU Bubble Ratio: 61.02%, 55.01%, 65.16%, 28.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  278-42-320ms   | [S0,MB4,F]  320-15-336ms   | [S0,MB1,B]  401-41-443ms   | [S0,MB5,F]  443-15-459ms   | [S0,MB2,B]  526-42-568ms   | [S0,MB6,F]  568-15-583ms   | [S0,MB3,B]  652-41-693ms   | [S0,MB7,F]  694-15-709ms   | [S0,MB4,B]  778-41-820ms   | [S0,MB5,B]  901-41-943ms   | [S0,MB6,B]  1026-41-1067ms | [S0,MB7,B]  1148-41-1189ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-47-268ms   | [S1,MB3,F]  275-20-295ms   | [S1,MB1,B]  344-46-391ms   | [S1,MB4,F]  398-20-418ms   | [S1,MB2,B]  469-47-516ms   | [S1,MB5,F]  522-20-543ms   | [S1,MB3,B]  594-47-641ms   | [S1,MB6,F]  648-20-669ms   | [S1,MB4,B]  721-46-768ms   | [S1,MB7,F]  775-20-795ms   | [S1,MB5,B]  848-46-895ms   | [S1,MB6,B]  972-47-1019ms  | [S1,MB7,B]  1094-46-1141ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-76ms     | [S2,MB0,B]  176-36-213ms   | [S2,MB2,F]  217-15-232ms   | [S2,MB1,B]  300-36-336ms   | [S2,MB3,F]  341-15-356ms   | [S2,MB2,B]  425-36-461ms   | [S2,MB4,F]  466-15-481ms   | [S2,MB3,B]  551-36-587ms   | [S2,MB5,F]  591-15-607ms   | [S2,MB4,B]  677-36-713ms   | [S2,MB6,F]  718-15-733ms   | [S2,MB5,B]  804-36-840ms   | [S2,MB7,F]  845-15-860ms   | [S2,MB6,B]  930-36-966ms   | [S2,MB7,B]  1053-36-1089ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-77-166ms    | [S3,MB1,F]  173-23-197ms   | [S3,MB1,B]  208-82-290ms   | [S3,MB2,F]  297-25-322ms   | [S3,MB2,B]  334-82-416ms   | [S3,MB3,F]  422-25-447ms   | [S3,MB3,B]  459-82-542ms   | [S3,MB4,F]  548-25-573ms   | [S3,MB4,B]  585-82-667ms   | [S3,MB5,F]  674-25-699ms   | [S3,MB5,B]  711-83-794ms   | [S3,MB6,F]  801-24-825ms   | [S3,MB6,B]  838-82-920ms   | [S3,MB7,F]  927-24-951ms   | [S3,MB7,B]  963-82-1046ms 
[rank0]:2025-12-24 07:04:44,985 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 07:04:49,690 - Avg. fwd time: 24.7051 / Avg. bwd time: 81.3070 / Avg. batch time: 992.9304 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 07:04:49,737 - Avg. fwd time: 15.3857 / Avg. bwd time: 36.2979 / Avg. batch time: 1051.9081 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-12-24 07:04:49,794 - Avg. fwd time: 19.8507 / Avg. bwd time: 46.8428 / Avg. batch time: 1125.3216 (ms) / GPU bubble ratio: 52.59%
[rank0]:2025-12-24 07:04:49,846 - Avg. fwd time: 16.0800 / Avg. bwd time: 41.7335 / Avg. batch time: 1190.6290 (ms) / GPU bubble ratio: 61.15%
[rank2]:2025-12-24 07:04:49,867 -  step: 650  loss: -4.0000  grad_norm:  0.1631  memory:  8.66GiB(18.23%)  tps: 6,723  tflops: 52.56  mfu: 16.84%
[rank3]:2025-12-24 07:04:49,880 -  step: 650  loss:  0.2241  grad_norm:  0.1631  memory: 25.79GiB(54.28%)  tps: 6,723  tflops: 52.56  mfu: 16.84%
[rank1]:2025-12-24 07:04:49,871 -  step: 650  loss: -4.0000  grad_norm:  0.1631  memory: 12.86GiB(27.07%)  tps: 6,723  tflops: 52.56  mfu: 16.84%
[rank0]:2025-12-24 07:04:49,883 -  step: 650  loss: -4.0000  grad_norm:  0.1631  memory: 16.87GiB(35.50%)  tps: 6,723  tflops: 52.56  mfu: 16.84%
[rank0]:2025-12-24 07:08:48,630 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 07:08:53,312 - Avg. fwd time: 24.7061 / Avg. bwd time: 81.3120 / Avg. batch time: 992.9777 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 07:08:53,359 - Avg. fwd time: 15.3832 / Avg. bwd time: 36.3019 / Avg. batch time: 1051.9381 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-12-24 07:08:53,416 - Avg. fwd time: 19.8516 / Avg. bwd time: 46.8451 / Avg. batch time: 1125.3524 (ms) / GPU bubble ratio: 52.59%
[rank0]:2025-12-24 07:08:53,468 - Avg. fwd time: 16.0776 / Avg. bwd time: 41.7345 / Avg. batch time: 1190.6530 (ms) / GPU bubble ratio: 61.16%
[rank2]:2025-12-24 07:08:53,490 -  step: 700  loss: -4.0000  grad_norm:  0.1619  memory:  8.66GiB(18.23%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank3]:2025-12-24 07:08:53,502 -  step: 700  loss:  0.1823  grad_norm:  0.1619  memory: 25.79GiB(54.28%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank1]:2025-12-24 07:08:53,493 -  step: 700  loss: -4.0000  grad_norm:  0.1619  memory: 12.86GiB(27.07%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank0]:2025-12-24 07:08:53,505 -  step: 700  loss: -4.0000  grad_norm:  0.1619  memory: 16.87GiB(35.50%)  tps: 6,725  tflops: 52.57  mfu: 16.85%
[rank3]:2025-12-24 07:08:53,649 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0708_step700_rank3.svg
[rank3]:			> Batch Time: 1188.78 ms, GPU Bubble Ratio: 61.00%, 55.02%, 65.11%, 28.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  278-42-321ms   | [S0,MB4,F]  321-15-336ms   | [S0,MB1,B]  402-41-443ms   | [S0,MB5,F]  444-15-459ms   | [S0,MB2,B]  526-42-568ms   | [S0,MB6,F]  568-15-584ms   | [S0,MB3,B]  651-41-693ms   | [S0,MB7,F]  693-15-709ms   | [S0,MB4,B]  777-41-818ms   | [S0,MB5,B]  899-41-941ms   | [S0,MB6,B]  1025-41-1066ms | [S0,MB7,B]  1147-41-1188ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-47-268ms   | [S1,MB3,F]  275-19-295ms   | [S1,MB1,B]  344-47-391ms   | [S1,MB4,F]  398-20-419ms   | [S1,MB2,B]  469-46-516ms   | [S1,MB5,F]  523-20-543ms   | [S1,MB3,B]  594-47-641ms   | [S1,MB6,F]  648-20-668ms   | [S1,MB4,B]  720-46-766ms   | [S1,MB7,F]  773-20-793ms   | [S1,MB5,B]  846-46-892ms   | [S1,MB6,B]  971-47-1018ms  | [S1,MB7,B]  1093-46-1140ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-213ms   | [S2,MB2,F]  218-15-233ms   | [S2,MB1,B]  300-36-337ms   | [S2,MB3,F]  341-15-356ms   | [S2,MB2,B]  425-36-461ms   | [S2,MB4,F]  466-15-481ms   | [S2,MB3,B]  549-36-586ms   | [S2,MB5,F]  591-15-606ms   | [S2,MB4,B]  675-36-711ms   | [S2,MB6,F]  717-15-732ms   | [S2,MB5,B]  802-36-838ms   | [S2,MB7,F]  843-15-858ms   | [S2,MB6,B]  929-36-965ms   | [S2,MB7,B]  1050-36-1086ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  209-81-291ms   | [S3,MB2,F]  297-24-322ms   | [S3,MB2,B]  334-82-416ms   | [S3,MB3,F]  421-24-446ms   | [S3,MB3,B]  458-82-541ms   | [S3,MB4,F]  546-25-571ms   | [S3,MB4,B]  583-82-666ms   | [S3,MB5,F]  672-25-697ms   | [S3,MB5,B]  708-82-791ms   | [S3,MB6,F]  798-25-823ms   | [S3,MB6,B]  835-82-918ms   | [S3,MB7,F]  925-24-949ms   | [S3,MB7,B]  962-82-1045ms 
[rank0]:2025-12-24 07:12:52,276 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 07:12:57,030 - Avg. fwd time: 24.7052 / Avg. bwd time: 81.3150 / Avg. batch time: 992.9956 (ms) / GPU bubble ratio: 14.59%
[rank2]:2025-12-24 07:12:57,077 - Avg. fwd time: 15.3805 / Avg. bwd time: 36.3050 / Avg. batch time: 1051.9702 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-12-24 07:12:57,134 - Avg. fwd time: 19.8536 / Avg. bwd time: 46.8476 / Avg. batch time: 1125.3893 (ms) / GPU bubble ratio: 52.58%
[rank0]:2025-12-24 07:12:57,186 - Avg. fwd time: 16.0759 / Avg. bwd time: 41.7359 / Avg. batch time: 1190.6850 (ms) / GPU bubble ratio: 61.16%
[rank2]:2025-12-24 07:12:57,208 -  step: 750  loss: -4.0000  grad_norm:  0.1937  memory:  8.66GiB(18.23%)  tps: 6,723  tflops: 52.55  mfu: 16.84%
[rank3]:2025-12-24 07:12:57,220 -  step: 750  loss:  0.2228  grad_norm:  0.1937  memory: 25.79GiB(54.28%)  tps: 6,723  tflops: 52.55  mfu: 16.84%
[rank1]:2025-12-24 07:12:57,211 -  step: 750  loss: -4.0000  grad_norm:  0.1937  memory: 12.86GiB(27.07%)  tps: 6,723  tflops: 52.55  mfu: 16.84%
[rank0]:2025-12-24 07:12:57,223 -  step: 750  loss: -4.0000  grad_norm:  0.1937  memory: 16.87GiB(35.50%)  tps: 6,723  tflops: 52.55  mfu: 16.84%
[rank0]:2025-12-24 07:16:55,927 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 07:17:00,765 - Avg. fwd time: 15.3779 / Avg. bwd time: 36.3066 / Avg. batch time: 1051.9927 (ms) / GPU bubble ratio: 60.70%
[rank3]:2025-12-24 07:17:00,717 - Avg. fwd time: 24.7045 / Avg. bwd time: 81.3203 / Avg. batch time: 993.0328 (ms) / GPU bubble ratio: 14.58%
[rank1]:2025-12-24 07:17:00,822 - Avg. fwd time: 19.8554 / Avg. bwd time: 46.8488 / Avg. batch time: 1125.4126 (ms) / GPU bubble ratio: 52.58%
[rank1]:2025-12-24 07:17:00,899 -  step: 800  loss: -4.0000  grad_norm:  0.1835  memory: 12.86GiB(27.07%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank1]:2025-12-24 07:17:00,899 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1835  tps: 7,136  tflops: 55.79  mfu: 16.31%
[rank1]:2025-12-24 07:17:00,900 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 07:17:00,900 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 07:17:00,874 - Avg. fwd time: 16.0753 / Avg. bwd time: 41.7377 / Avg. batch time: 1190.7024 (ms) / GPU bubble ratio: 61.16%
[rank0]:2025-12-24 07:17:00,911 -  step: 800  loss: -4.0000  grad_norm:  0.1835  memory: 16.87GiB(35.50%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank0]:2025-12-24 07:17:00,912 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1835  tps: 7,136  tflops: 55.79  mfu: 16.31%
[rank0]:2025-12-24 07:17:00,912 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 07:17:00,912 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-24 07:17:00,896 -  step: 800  loss: -4.0000  grad_norm:  0.1835  memory:  8.66GiB(18.23%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank2]:2025-12-24 07:17:00,896 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1835  tps: 7,136  tflops: 55.79  mfu: 16.32%
[rank2]:2025-12-24 07:17:00,896 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 07:17:00,897 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 07:17:00,909 -  step: 800  loss:  0.2263  grad_norm:  0.1835  memory: 25.79GiB(54.28%)  tps: 6,723  tflops: 52.56  mfu: 16.85%
[rank3]:2025-12-24 07:17:00,909 - â„¹ï¸ final step: 800  loss:  0.2263  grad_norm:  0.1835  tps: 7,140  tflops: 55.82  mfu: 16.43%
[rank3]:2025-12-24 07:17:00,910 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 07:17:00,911 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 07:17:02,804 - Destroying the purge thread.
[rank0]:2025-12-24 07:17:02,791 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-24 07:17:02,804 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-24 07:17:02,804 - Destroying the purge thread.
[rank3]:2025-12-24 07:17:02,941 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0717_final800_rank3.svg
[rank3]:			> Batch Time: 1189.81 ms, GPU Bubble Ratio: 61.00%, 55.07%, 65.13%, 28.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  278-42-320ms   | [S0,MB4,F]  321-15-336ms   | [S0,MB1,B]  401-41-443ms   | [S0,MB5,F]  443-15-459ms   | [S0,MB2,B]  526-41-568ms   | [S0,MB6,F]  568-15-584ms   | [S0,MB3,B]  652-41-694ms   | [S0,MB7,F]  694-15-710ms   | [S0,MB4,B]  778-41-820ms   | [S0,MB5,B]  901-41-942ms   | [S0,MB6,B]  1026-41-1067ms | [S0,MB7,B]  1148-41-1189ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-47-268ms   | [S1,MB3,F]  275-19-295ms   | [S1,MB1,B]  344-47-391ms   | [S1,MB4,F]  398-20-419ms   | [S1,MB2,B]  469-46-516ms   | [S1,MB5,F]  523-20-543ms   | [S1,MB3,B]  595-47-642ms   | [S1,MB6,F]  649-20-669ms   | [S1,MB4,B]  721-46-768ms   | [S1,MB7,F]  775-20-795ms   | [S1,MB5,B]  847-46-894ms   | [S1,MB6,B]  972-46-1019ms  | [S1,MB7,B]  1095-46-1142ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-53ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-213ms   | [S2,MB2,F]  217-15-233ms   | [S2,MB1,B]  300-36-336ms   | [S2,MB3,F]  341-15-356ms   | [S2,MB2,B]  425-36-461ms   | [S2,MB4,F]  466-15-481ms   | [S2,MB3,B]  551-36-587ms   | [S2,MB5,F]  592-15-607ms   | [S2,MB4,B]  677-36-713ms   | [S2,MB6,F]  718-15-733ms   | [S2,MB5,B]  803-36-839ms   | [S2,MB7,F]  844-15-859ms   | [S2,MB6,B]  929-36-966ms   | [S2,MB7,B]  1052-36-1088ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  209-81-291ms   | [S3,MB2,F]  297-24-322ms   | [S3,MB2,B]  334-82-416ms   | [S3,MB3,F]  422-25-447ms   | [S3,MB3,B]  459-82-541ms   | [S3,MB4,F]  548-25-573ms   | [S3,MB4,B]  585-82-667ms   | [S3,MB5,F]  674-24-699ms   | [S3,MB5,B]  710-82-793ms   | [S3,MB6,F]  800-24-824ms   | [S3,MB6,B]  837-82-919ms   | [S3,MB7,F]  926-24-951ms   | [S3,MB7,B]  963-82-1046ms 
[rank3]:2025-12-24 07:17:03,076 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1/pipeline_schedule/251224_0717_thry_final800_rank3.svg
[rank3]:			> Batch Time: 627.69 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-57ms     | [S0,MB3,F]  57-19-76ms     | [S0,MB0,B]  190-38-228ms   | [S0,MB4,F]  228-19-247ms   | [S0,MB1,B]  247-38-285ms   | [S0,MB5,F]  285-19-304ms   | [S0,MB2,B]  304-38-342ms   | [S0,MB6,F]  342-19-361ms   | [S0,MB3,B]  361-38-399ms   | [S0,MB7,F]  399-19-418ms   | [S0,MB4,B]  418-38-456ms   | [S0,MB5,B]  475-38-513ms   | [S0,MB6,B]  532-38-570ms   | [S0,MB7,B]  589-38-627ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-76ms     | [S1,MB0,B]  152-38-190ms   | [S1,MB3,F]  190-19-209ms   | [S1,MB1,B]  209-38-247ms   | [S1,MB4,F]  247-19-266ms   | [S1,MB2,B]  266-38-304ms   | [S1,MB5,F]  304-19-323ms   | [S1,MB3,B]  323-38-361ms   | [S1,MB6,F]  361-19-380ms   | [S1,MB4,B]  380-38-418ms   | [S1,MB7,F]  418-19-437ms   | [S1,MB5,B]  437-38-475ms   | [S1,MB6,B]  494-38-532ms   | [S1,MB7,B]  551-38-589ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-57ms     | [S2,MB1,F]  57-19-76ms     | [S2,MB0,B]  114-38-152ms   | [S2,MB2,F]  152-19-171ms   | [S2,MB1,B]  171-38-209ms   | [S2,MB3,F]  209-19-228ms   | [S2,MB2,B]  228-38-266ms   | [S2,MB4,F]  266-19-285ms   | [S2,MB3,B]  285-38-323ms   | [S2,MB5,F]  323-19-342ms   | [S2,MB4,B]  342-38-380ms   | [S2,MB6,F]  380-19-399ms   | [S2,MB5,B]  399-38-437ms   | [S2,MB7,F]  437-19-456ms   | [S2,MB6,B]  456-38-494ms   | [S2,MB7,B]  513-38-551ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  57-19-76ms     | [S3,MB0,B]  76-38-114ms    | [S3,MB1,F]  114-19-133ms   | [S3,MB1,B]  133-38-171ms   | [S3,MB2,F]  171-19-190ms   | [S3,MB2,B]  190-38-228ms   | [S3,MB3,F]  228-19-247ms   | [S3,MB3,B]  247-38-285ms   | [S3,MB4,F]  285-19-304ms   | [S3,MB4,B]  304-38-342ms   | [S3,MB5,F]  342-19-361ms   | [S3,MB5,B]  361-38-399ms   | [S3,MB6,F]  399-19-418ms   | [S3,MB6,B]  418-38-456ms   | [S3,MB7,F]  456-19-475ms   | [S3,MB7,B]  475-38-513ms  
[rank3]:2025-12-24 07:17:03,077 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-12-24 07:17:03,222 - Process group destroyed
[rank1]:2025-12-24 07:17:03,311 - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.58932
[rank3]:wandb:               final/avg_loss 0.22629
[rank3]:wandb:             final/avg_mfu(%) 16.42728
[rank3]:wandb:             final/avg_tflops 55.81764
[rank3]:wandb:    final/avg_throughput(tps) 7140.05178
[rank3]:wandb:              final/grad_norm 0.18347
[rank3]:wandb:               final/max_loss 0.22629
[rank3]:wandb:                    grad_norm 0.18347
[rank3]:wandb: loss_metrics/global_avg_loss 0.22629
[rank3]:wandb: loss_metrics/global_max_loss 0.22629
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_1F1B_nofreeze_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/0xix6ahc
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_1F1B_nofreeze_42_dm1/20251224-0611/wandb/run-20251224_061158-0xix6ahc/logs
[rank3]:2025-12-24 07:17:04,184 - Process group destroyed
[rank0]:2025-12-24 07:17:04,804 - Training completed
[rank0]:2025-12-24 07:17:04,804 - Destroying the purge thread.
[rank0]:2025-12-24 07:17:05,285 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.5', 'layers.8', 'layers.6', 'layers.7'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'tok_embeddings', 'layers.1', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.9', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'output', 'norm', 'layers.15', 'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_1F1B_nofreeze_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_1F1B_nofreeze_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_1F1B_nofreeze_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_1F1B_nofreeze_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_1F1B_nofreeze_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_1F1B_nofreeze_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_1F1B_nofreeze_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_1F1B_nofreeze_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
