
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 19:48:16 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_1F1B_fullrand7_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-30 19:48:23,266 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank1]:2025-12-30 19:48:23,267 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank0]:2025-12-30 19:48:23,415 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank3]:2025-12-30 19:48:23,519 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 19:48:23,521 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-30 19:48:23,549 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-30 19:48:23,528 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 19:48:23,530 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 19:48:23,633 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 19:48:23,635 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 19:48:23,639 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 19:48:23,641 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-30 19:48:23,732 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 19:48:23,735 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 19:48:24,042 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 19:48:27,339 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-30 19:48:27,438 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 19:48:27,475 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 19:48:27,494 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 19:48:27,533 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 19:48:27,535 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-30 19:48:27,565 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 19:48:27,566 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-30 19:48:27,502 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 19:48:27,502 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-30 19:48:27,597 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 19:48:27,636 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 19:48:27,663 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 19:48:27,663 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-30 19:48:27,701 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 19:48:27,701 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 19:48:27,701 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-30 19:48:27,807 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 19:48:27,808 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 19:48:27,808 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-30 19:48:27,896 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 19:48:27,897 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 19:48:27,897 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run rnw7nkbb
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_1F1B_fullrand7_22_dm1/20251230-1948/wandb/run-20251230_194829-rnw7nkbb
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_1F1B_fullrand7_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/rnw7nkbb
[rank3]:2025-12-30 19:48:31,091 - WandB logging enabled
[rank3]:2025-12-30 19:48:31,092 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 19:48:31,131 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 19:48:31,161 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 19:48:31,161 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-30 19:48:31,346 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 19:48:31,347 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 19:48:31,348 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-30 19:48:31,363 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-30 19:48:31,364 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-30 19:48:31,364 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 19:48:31,364 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_1F1B_fullrand7_22_dm1
[rank0]:2025-12-30 19:48:31,364 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 19:48:31,364 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 19:48:31,365 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-30 19:48:33,965 - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-12-30 19:48:33,965 - Finished loading the checkpoint in 2.60 seconds.
[rank0]:2025-12-30 19:48:33,965 - Training starts at step 1
[rank1]:2025-12-30 19:48:39,264 -  step:  1  loss: -4.0000  grad_norm: 203.0662  memory: 10.58GiB(22.26%)  tps: 2,780  tflops: 21.73  mfu: 6.96%
[rank1]:2025-12-30 19:48:39,264 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 19:48:39,270 -  step:  1  loss: 10.6092  grad_norm: 203.0662  memory: 21.88GiB(46.05%)  tps: 4,027  tflops: 31.48  mfu: 10.09%
[rank3]:2025-12-30 19:48:39,271 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-30 19:48:39,261 -  step:  1  loss: -4.0000  grad_norm: 203.0662  memory:  6.84GiB(14.41%)  tps: 2,819  tflops: 22.04  mfu: 7.06%
[rank2]:2025-12-30 19:48:39,262 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 19:48:39,299 -  step:  1  loss: -4.0000  grad_norm: 203.0662  memory: 13.10GiB(27.57%)  tps: 2,785  tflops: 21.77  mfu: 6.98%
[rank0]:2025-12-30 19:48:39,299 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 19:52:31,275 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 19:52:35,917 - Avg. fwd time: 24.5650 / Avg. bwd time: 80.4926 / Avg. batch time: 986.0270 (ms) / GPU bubble ratio: 14.76%
[rank2]:2025-12-30 19:52:35,959 - Avg. fwd time: 14.9749 / Avg. bwd time: 35.2256 / Avg. batch time: 1044.1666 (ms) / GPU bubble ratio: 61.54%
[rank0]:2025-12-30 19:52:36,059 - Avg. fwd time: 16.0838 / Avg. bwd time: 41.8456 / Avg. batch time: 1182.7998 (ms) / GPU bubble ratio: 60.82%
[rank1]:2025-12-30 19:52:36,011 - Avg. fwd time: 19.7440 / Avg. bwd time: 45.6206 / Avg. batch time: 1116.8995 (ms) / GPU bubble ratio: 53.18%
[rank1]:2025-12-30 19:52:36,084 -  step: 50  loss: -4.0000  grad_norm: 24.0980  memory: 12.86GiB(27.07%)  tps: 6,780  tflops: 53.00  mfu: 16.99%
[rank2]:2025-12-30 19:52:36,081 -  step: 50  loss: -4.0000  grad_norm: 24.0980  memory:  8.66GiB(18.23%)  tps: 6,780  tflops: 53.00  mfu: 16.99%
[rank0]:2025-12-30 19:52:36,097 -  step: 50  loss: -4.0000  grad_norm: 24.0980  memory: 16.87GiB(35.50%)  tps: 6,781  tflops: 53.01  mfu: 16.99%
[rank3]:2025-12-30 19:52:36,093 -  step: 50  loss:  9.8862  grad_norm: 24.0980  memory: 25.79GiB(54.28%)  tps: 6,780  tflops: 53.00  mfu: 16.99%
[rank3]:2025-12-30 19:53:19,210 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-30 19:54:07,614 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-30 19:54:08,020 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-30 19:54:08,070 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-30 19:54:08,114 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-30 19:54:56,253 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-30 19:54:56,801 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-30 19:56:02,674 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-30 19:56:03,066 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 19:56:03,082 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.33)/0.33, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-30 19:56:03,081 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-30 19:56:03,088 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-30 19:56:03,239 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_1956_max_batch_time.svg
[rank3]:			> Batch Time: 1026.98 ms, GPU Bubble Ratio: 54.59%, 48.64%, 60.60%, 17.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  236-42-278ms   | [S0,MB4,F]  278-15-294ms   | [S0,MB1,B]  340-42-382ms   | [S0,MB5,F]  382-15-398ms   | [S0,MB2,B]  446-42-489ms   | [S0,MB6,F]  489-15-504ms   | [S0,MB3,B]  554-42-597ms   | [S0,MB7,F]  597-15-612ms   | [S0,MB4,B]  663-42-705ms   | [S0,MB5,B]  770-42-812ms   | [S0,MB6,B]  877-42-919ms   | [S0,MB7,B]  984-42-1026ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  36-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  189-46-236ms   | [S1,MB3,F]  236-19-255ms   | [S1,MB1,B]  294-46-340ms   | [S1,MB4,F]  340-20-361ms   | [S1,MB2,B]  400-46-446ms   | [S1,MB5,F]  446-20-467ms   | [S1,MB3,B]  508-46-554ms   | [S1,MB6,F]  554-20-575ms   | [S1,MB4,B]  617-46-663ms   | [S1,MB7,F]  663-20-684ms   | [S1,MB5,B]  724-46-770ms   | [S1,MB6,B]  831-45-877ms   | [S1,MB7,B]  939-45-984ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  153-35-189ms   | [S2,MB2,F]  189-14-204ms   | [S2,MB1,B]  259-35-294ms   | [S2,MB3,F]  294-15-309ms   | [S2,MB2,B]  365-35-400ms   | [S2,MB4,F]  400-15-415ms   | [S2,MB3,B]  473-35-508ms   | [S2,MB5,F]  508-15-523ms   | [S2,MB4,B]  581-35-617ms   | [S2,MB6,F]  617-15-632ms   | [S2,MB5,B]  689-35-724ms   | [S2,MB7,F]  724-15-739ms   | [S2,MB6,B]  796-35-831ms   | [S2,MB7,B]  903-35-939ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-77-153ms    AFR(10):0.9655 | [S3,MB1,F]  153-24-177ms   | [S3,MB1,B]  177-81-259ms   AFR(10):0.9655 | [S3,MB2,F]  259-24-283ms   | [S3,MB2,B]  283-81-365ms   AFR(10):0.9655 | [S3,MB3,F]  365-24-389ms   | [S3,MB3,B]  389-83-473ms   AFR(10):0.9655 | [S3,MB4,F]  473-25-498ms   | [S3,MB4,B]  498-83-581ms   AFR(10):0.9655 | [S3,MB5,F]  581-25-606ms   | [S3,MB5,B]  606-82-689ms   AFR(10):0.9655 | [S3,MB6,F]  689-24-713ms   | [S3,MB6,B]  713-82-796ms   AFR(10):0.9655 | [S3,MB7,F]  796-25-821ms   | [S3,MB7,B]  821-82-903ms   AFR(10):0.9655
[rank3]:2025-12-30 19:56:03,376 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_1956_min_batch_time.svg
[rank3]:			> Batch Time: 642.08 ms, GPU Bubble Ratio: 80.03%, 46.65%, 59.07%, 14.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  158-0-158ms    | [S0,MB4,F]  158-15-174ms   | [S0,MB1,B]  227-0-227ms    | [S0,MB5,F]  227-15-243ms   | [S0,MB2,B]  295-0-295ms    | [S0,MB6,F]  295-15-311ms   | [S0,MB3,B]  365-0-365ms    | [S0,MB7,F]  365-15-380ms   | [S0,MB4,B]  435-0-435ms    | [S0,MB5,B]  504-0-504ms    | [S0,MB6,B]  573-0-573ms    | [S0,MB7,B]  642-0-642ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  36-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  136-22-158ms   | [S1,MB3,F]  158-19-178ms   | [S1,MB1,B]  204-22-227ms   | [S1,MB4,F]  227-20-247ms   | [S1,MB2,B]  273-22-295ms   | [S1,MB5,F]  295-20-316ms   | [S1,MB3,B]  342-23-365ms   | [S1,MB6,F]  365-20-385ms   | [S1,MB4,B]  412-23-435ms   | [S1,MB7,F]  435-20-456ms   | [S1,MB5,B]  481-23-504ms   | [S1,MB6,B]  550-22-573ms   | [S1,MB7,B]  619-22-642ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  118-17-136ms   | [S2,MB2,F]  136-14-150ms   | [S2,MB1,B]  186-17-204ms   | [S2,MB3,F]  204-15-219ms   | [S2,MB2,B]  255-17-273ms   | [S2,MB4,F]  273-15-288ms   | [S2,MB3,B]  324-17-342ms   | [S2,MB5,F]  342-15-357ms   | [S2,MB4,B]  394-17-412ms   | [S2,MB6,F]  412-15-427ms   | [S2,MB5,B]  463-17-481ms   | [S2,MB7,F]  481-15-496ms   | [S2,MB6,B]  532-17-550ms   | [S2,MB7,B]  601-17-619ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-41-118ms    AFR(10):0.9655 | [S3,MB1,F]  118-24-142ms   | [S3,MB1,B]  142-44-186ms   AFR(10):0.9655 | [S3,MB2,F]  186-24-210ms   | [S3,MB2,B]  210-44-255ms   AFR(10):0.9655 | [S3,MB3,F]  255-24-279ms   | [S3,MB3,B]  279-44-324ms   AFR(10):0.9655 | [S3,MB4,F]  324-25-349ms   | [S3,MB4,B]  349-44-394ms   AFR(10):0.9655 | [S3,MB5,F]  394-25-419ms   | [S3,MB5,B]  419-44-463ms   AFR(10):0.9655 | [S3,MB6,F]  463-24-488ms   | [S3,MB6,B]  488-44-532ms   AFR(10):0.9655 | [S3,MB7,F]  532-25-557ms   | [S3,MB7,B]  557-44-601ms   AFR(10):0.9655
[rank3]:2025-12-30 19:56:03,524 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_1956_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 699.81 ms, GPU Bubble Ratio: 41.36%, 27.90%, 44.71%, 13.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  236-42-278ms   | [S0,MB4,F]  278-15-294ms   | [S0,MB1,B]  325-42-368ms   | [S0,MB5,F]  368-15-383ms   | [S0,MB2,B]  394-42-437ms   | [S0,MB6,F]  437-15-452ms   | [S0,MB3,B]  463-42-505ms   | [S0,MB7,F]  505-15-521ms   | [S0,MB4,B]  533-42-576ms   | [S0,MB5,B]  602-42-645ms   | [S0,MB6,B]  671-28-699ms   | [S0,MB7,B]  699-0-699ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  36-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  189-46-236ms   | [S1,MB3,F]  236-19-255ms   | [S1,MB1,B]  279-46-325ms   | [S1,MB4,F]  325-20-346ms   | [S1,MB2,B]  348-46-394ms   | [S1,MB5,F]  394-20-415ms   | [S1,MB3,B]  417-46-463ms   | [S1,MB6,F]  463-20-484ms   | [S1,MB4,B]  487-46-533ms   | [S1,MB7,F]  533-20-554ms   | [S1,MB5,B]  556-46-602ms   | [S1,MB6,B]  625-45-671ms   | [S1,MB7,B]  677-22-699ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  153-35-189ms   | [S2,MB2,F]  189-14-204ms   | [S2,MB1,B]  244-35-279ms   | [S2,MB3,F]  279-15-294ms   | [S2,MB2,B]  313-35-348ms   | [S2,MB4,F]  348-15-363ms   | [S2,MB3,B]  382-35-417ms   | [S2,MB5,F]  417-15-432ms   | [S2,MB4,B]  452-35-487ms   | [S2,MB6,F]  487-15-502ms   | [S2,MB5,B]  521-35-556ms   | [S2,MB7,F]  556-15-571ms   | [S2,MB6,B]  590-35-625ms   | [S2,MB7,B]  659-17-677ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-77-153ms    AFR(10):0.9655 | [S3,MB1,F]  153-24-177ms   | [S3,MB1,B]  177-66-244ms   AFR(10):0.9655 | [S3,MB2,F]  244-24-268ms   | [S3,MB2,B]  268-44-313ms   AFR(10):0.9655 | [S3,MB3,F]  313-24-337ms   | [S3,MB3,B]  337-44-382ms   AFR(10):0.9655 | [S3,MB4,F]  382-25-407ms   | [S3,MB4,B]  407-44-452ms   AFR(10):0.9655 | [S3,MB5,F]  452-25-477ms   | [S3,MB5,B]  477-44-521ms   AFR(10):0.9655 | [S3,MB6,F]  521-24-545ms   | [S3,MB6,B]  545-44-590ms   AFR(10):0.9655 | [S3,MB7,F]  590-25-615ms   | [S3,MB7,B]  615-44-659ms   AFR(10):0.9655
[rank3]:2025-12-30 19:56:03,525 - 	> Batch Time: 699.81 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank3]:2025-12-30 19:56:03,526 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.97(0.00)/0.00, [MB1] 0.97(0.40)/0.40, [MB2] 0.97(1.00)/1.00, [MB3] 0.97(1.00)/1.00, [MB4] 0.97(1.00)/1.00, [MB5] 0.97(1.00)/1.00, [MB6] 0.97(1.00)/1.00, [MB7] 0.97(1.00)/1.00
[rank0]:2025-12-30 19:56:07,029 - Avg. fwd time: 15.9374 / Avg. bwd time: 33.4663 / Avg. batch time: 1107.2073 (ms) / GPU bubble ratio: 64.30%
[rank3]:2025-12-30 19:56:06,966 - Avg. fwd time: 24.7165 / Avg. bwd time: 73.0730 / Avg. batch time: 927.7465 (ms) / GPU bubble ratio: 15.68%
[rank3]:2025-12-30 19:56:07,063 -  step: 100  loss:  9.0242  grad_norm:  6.9912  memory: 25.79GiB(54.28%)  tps: 7,766  tflops: 60.71  mfu: 19.46%
[rank2]:2025-12-30 19:56:06,994 - Avg. fwd time: 14.8498 / Avg. bwd time: 31.7999 / Avg. batch time: 982.8123 (ms) / GPU bubble ratio: 62.03%
[rank2]:2025-12-30 19:56:07,051 -  step: 100  loss: -4.0000  grad_norm:  6.9912  memory:  8.66GiB(18.23%)  tps: 7,766  tflops: 60.71  mfu: 19.46%
[rank1]:2025-12-30 19:56:07,023 - Avg. fwd time: 19.5959 / Avg. bwd time: 41.1760 / Avg. batch time: 1050.4969 (ms) / GPU bubble ratio: 53.72%
[rank1]:2025-12-30 19:56:07,056 -  step: 100  loss: -4.0000  grad_norm:  6.9912  memory: 12.86GiB(27.07%)  tps: 7,766  tflops: 60.71  mfu: 19.46%
[rank0]:2025-12-30 19:56:07,066 -  step: 100  loss: -4.0000  grad_norm:  6.9912  memory: 16.87GiB(35.50%)  tps: 7,766  tflops: 60.71  mfu: 19.46%
[rank0]:2025-12-30 19:56:07,124 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_1956_stage0_step100.svg
[rank2]:2025-12-30 19:56:07,126 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_1956_stage2_step100.svg
[rank1]:2025-12-30 19:56:07,124 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_1956_stage1_step100.svg
[rank3]:2025-12-30 19:56:07,207 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_1956_step100_rank3.svg
[rank3]:			> Batch Time: 808.50 ms, GPU Bubble Ratio: 84.82%, 58.85%, 68.10%, 31.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-64ms     | [S0,MB0,B]  198-0-198ms    | [S0,MB4,F]  198-14-213ms   | [S0,MB1,B]  284-0-284ms    | [S0,MB5,F]  284-14-299ms   | [S0,MB2,B]  373-0-373ms    | [S0,MB6,F]  373-14-387ms   | [S0,MB3,B]  462-0-462ms    | [S0,MB7,F]  462-14-476ms   | [S0,MB4,B]  552-0-552ms    | [S0,MB5,B]  638-0-638ms    | [S0,MB6,B]  723-0-723ms    | [S0,MB7,B]  808-0-808ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  42-18-61ms     | [S1,MB2,F]  67-18-85ms     | [S1,MB0,B]  168-22-190ms   | [S1,MB3,F]  195-18-213ms   | [S1,MB1,B]  253-22-276ms   | [S1,MB4,F]  281-18-299ms   | [S1,MB2,B]  342-23-365ms   | [S1,MB5,F]  369-18-388ms   | [S1,MB3,B]  431-23-454ms   | [S1,MB6,F]  458-18-477ms   | [S1,MB4,B]  520-23-543ms   | [S1,MB7,F]  548-18-566ms   | [S1,MB5,B]  609-23-632ms   | [S1,MB6,B]  694-22-717ms   | [S1,MB7,B]  779-22-802ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  139-17-157ms   | [S2,MB2,F]  164-14-178ms   | [S2,MB1,B]  225-17-243ms   | [S2,MB3,F]  250-14-265ms   | [S2,MB2,B]  314-17-332ms   | [S2,MB4,F]  339-14-353ms   | [S2,MB3,B]  402-17-420ms   | [S2,MB5,F]  427-14-442ms   | [S2,MB4,B]  492-17-510ms   | [S2,MB6,F]  517-14-532ms   | [S2,MB5,B]  581-17-599ms   | [S2,MB7,F]  605-14-619ms   | [S2,MB6,B]  670-17-688ms   | [S2,MB7,B]  755-17-773ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-41-129ms    | [S3,MB1,F]  136-23-160ms   | [S3,MB1,B]  171-43-215ms   | [S3,MB2,F]  222-25-248ms   | [S3,MB2,B]  260-43-304ms   | [S3,MB3,F]  311-25-337ms   | [S3,MB3,B]  348-44-392ms   | [S3,MB4,F]  399-25-425ms   | [S3,MB4,B]  437-44-482ms   | [S3,MB5,F]  489-25-515ms   | [S3,MB5,B]  527-43-571ms   | [S3,MB6,F]  578-25-603ms   | [S3,MB6,B]  615-44-660ms   | [S3,MB7,F]  667-25-693ms   | [S3,MB7,B]  704-44-748ms  
[rank3]:2025-12-30 19:56:07,252 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_1956_stage3_step100.svg
[rank2]:2025-12-30 19:56:07,280 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_1956_rank2_stage2.svg
[rank2]:	> Counts Sum: 23040, Total Sum: 23040 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-30 19:56:07,273 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_1956_rank1_stage1.svg
[rank1]:	> Counts Sum: 28800, Total Sum: 28800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-30 19:56:07,278 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_1956_rank0_stage0.svg
[rank0]:	> Counts Sum: 23680, Total Sum: 23680 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-30 19:56:07,315 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_1956_stage0.svg
[rank2]:2025-12-30 19:56:07,318 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_1956_stage2.svg
[rank1]:2025-12-30 19:56:07,311 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_1956_stage1.svg
[rank3]:2025-12-30 19:56:07,391 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_1956_rank3_stage3.svg
[rank3]:	> Counts Sum: 17920, Total Sum: 18560 (96.55%), Ratio(%) per element: [100.0, 93.75, 100.0, 93.75, 100.0, 93.75, 93.75, 100.0, 100.0, 93.75, 81.25, 87.5, 93.75, 100.0, 93.75, 100.0, 93.75, 100.0, 100.0, 100.0, 87.5, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0]
[rank3]:2025-12-30 19:56:07,431 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_1956_stage3.svg
[rank3]:2025-12-30 19:59:28,992 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.24(0.27)/0.40, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.59(0.67)/1.00, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank0]:2025-12-30 19:59:29,404 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 19:59:29,405 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.19(0.22)/0.33, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-30 19:59:29,335 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank1]:2025-12-30 19:59:29,375 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.60(0.67)/1.00
[rank2]:2025-12-30 19:59:33,583 - Avg. fwd time: 14.8981 / Avg. bwd time: 32.7026 / Avg. batch time: 955.3184 (ms) / GPU bubble ratio: 60.14%
[rank3]:2025-12-30 19:59:33,550 - Avg. fwd time: 24.8011 / Avg. bwd time: 69.6465 / Avg. batch time: 902.5807 (ms) / GPU bubble ratio: 16.29%
[rank1]:2025-12-30 19:59:33,622 - Avg. fwd time: 19.7133 / Avg. bwd time: 42.4792 / Avg. batch time: 1020.2351 (ms) / GPU bubble ratio: 51.23%
[rank0]:2025-12-30 19:59:33,653 - Avg. fwd time: 16.0416 / Avg. bwd time: 35.2872 / Avg. batch time: 1073.3300 (ms) / GPU bubble ratio: 61.74%
[rank0]:2025-12-30 19:59:33,691 -  step: 150  loss: -4.0000  grad_norm: 30.2656  memory: 16.87GiB(35.50%)  tps: 7,929  tflops: 61.99  mfu: 19.87%
[rank2]:2025-12-30 19:59:33,674 -  step: 150  loss: -4.0000  grad_norm: 30.2656  memory:  8.66GiB(18.23%)  tps: 7,929  tflops: 61.99  mfu: 19.87%
[rank3]:2025-12-30 19:59:33,687 -  step: 150  loss:  4.1546  grad_norm: 30.2656  memory: 25.79GiB(54.28%)  tps: 7,929  tflops: 61.99  mfu: 19.87%
[rank1]:2025-12-30 19:59:33,678 -  step: 150  loss: -4.0000  grad_norm: 30.2656  memory: 12.86GiB(27.07%)  tps: 7,929  tflops: 61.99  mfu: 19.87%
[rank3]:2025-12-30 20:02:43,280 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.38(0.40)/0.40, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.93(1.00)/1.00, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-30 20:02:43,650 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-12-30 20:02:43,680 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-12-30 20:02:43,689 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 20:02:43,690 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.30(0.33)/0.33, [MB7] 0.95(1.00)/1.00
[rank3]:2025-12-30 20:02:47,278 - Avg. fwd time: 24.9040 / Avg. bwd time: 66.3605 / Avg. batch time: 877.2728 (ms) / GPU bubble ratio: 16.77%
[rank2]:2025-12-30 20:02:47,306 - Avg. fwd time: 14.9341 / Avg. bwd time: 33.1200 / Avg. batch time: 928.3428 (ms) / GPU bubble ratio: 58.59%
[rank2]:2025-12-30 20:02:47,365 -  step: 200  loss: -4.0000  grad_norm:  5.0504  memory:  8.66GiB(18.23%)  tps: 8,459  tflops: 66.13  mfu: 21.19%
[rank0]:2025-12-30 20:02:47,343 - Avg. fwd time: 16.1084 / Avg. bwd time: 36.0136 / Avg. batch time: 1040.4883 (ms) / GPU bubble ratio: 59.92%
[rank3]:2025-12-30 20:02:47,377 -  step: 200  loss:  1.5715  grad_norm:  5.0504  memory: 25.79GiB(54.28%)  tps: 8,459  tflops: 66.13  mfu: 21.19%
[rank0]:2025-12-30 20:02:47,380 -  step: 200  loss: -4.0000  grad_norm:  5.0504  memory: 16.87GiB(35.50%)  tps: 8,459  tflops: 66.13  mfu: 21.19%
[rank1]:2025-12-30 20:02:47,336 - Avg. fwd time: 19.8390 / Avg. bwd time: 43.1501 / Avg. batch time: 990.7026 (ms) / GPU bubble ratio: 49.14%
[rank1]:2025-12-30 20:02:47,371 -  step: 200  loss: -4.0000  grad_norm:  5.0504  memory: 12.86GiB(27.07%)  tps: 8,459  tflops: 66.13  mfu: 21.19%
[rank2]:2025-12-30 20:02:47,429 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_2002_stage2_step200.svg
[rank0]:2025-12-30 20:02:47,428 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_2002_stage0_step200.svg
[rank1]:2025-12-30 20:02:47,430 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_2002_stage1_step200.svg
[rank2]:2025-12-30 20:02:47,578 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2002_rank2_stage2.svg
[rank2]:	> Counts Sum: 33120, Total Sum: 138240 (23.96%), Ratio(%) per element: [25.0, 22.91, 23.95, 25.0, 22.91, 21.87, 22.91, 22.91, 25.0, 25.0, 25.0, 25.0, 23.95, 21.87, 23.95, 22.91, 25.0, 26.04, 25.0, 22.91, 22.91, 23.95, 22.91, 23.95, 21.87, 23.95, 23.95, 22.91, 22.91, 22.91, 26.04, 21.87, 25.0, 26.04, 26.04, 26.04]
[rank0]:2025-12-30 20:02:47,581 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2002_rank0_stage0.svg
[rank3]:2025-12-30 20:02:47,526 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2002_step200_rank3.svg
[rank0]:	> Counts Sum: 37520, Total Sum: 142080 (26.41%), Ratio(%) per element: [31.25, 32.29, 28.12, 31.25, 26.04, 28.12, 30.2, 31.25, 30.2, 27.08, 26.04, 26.04, 25.0, 27.08, 28.12, 27.08, 29.16, 28.12, 31.25, 26.04, 23.95, 26.04, 28.12, 22.91, 22.91, 20.83, 30.2, 26.04, 20.83, 23.95, 23.95, 23.95, 25.0, 22.91, 21.87, 22.91, 20.83]
[rank3]:			> Batch Time: 893.50 ms, GPU Bubble Ratio: 51.76%, 40.77%, 55.75%, 30.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  276-42-318ms   | [S0,MB4,F]  318-15-334ms   | [S0,MB1,B]  393-42-435ms   | [S0,MB5,F]  435-16-451ms   | [S0,MB2,B]  484-42-527ms   | [S0,MB6,F]  527-16-543ms   | [S0,MB3,B]  575-42-618ms   | [S0,MB7,F]  618-16-634ms   | [S0,MB4,B]  667-42-709ms   | [S0,MB5,B]  756-42-798ms   | [S0,MB6,B]  838-37-875ms   | [S0,MB7,B]  886-7-893ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-46-268ms   | [S1,MB3,F]  272-19-292ms   | [S1,MB1,B]  338-46-384ms   | [S1,MB4,F]  389-20-410ms   | [S1,MB2,B]  428-48-477ms   | [S1,MB5,F]  481-21-503ms   | [S1,MB3,B]  518-50-568ms   | [S1,MB6,F]  572-22-594ms   | [S1,MB4,B]  608-50-659ms   | [S1,MB7,F]  663-22-685ms   | [S1,MB5,B]  699-51-750ms   | [S1,MB6,B]  784-47-832ms   | [S1,MB7,B]  854-25-879ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  175-36-211ms   | [S2,MB2,F]  218-14-233ms   | [S2,MB1,B]  292-35-328ms   | [S2,MB3,F]  335-14-350ms   | [S2,MB2,B]  382-36-418ms   | [S2,MB4,F]  425-15-441ms   | [S2,MB3,B]  471-36-507ms   | [S2,MB5,F]  514-15-530ms   | [S2,MB4,B]  561-36-598ms   | [S2,MB6,F]  605-15-620ms   | [S2,MB5,B]  652-36-688ms   | [S2,MB7,F]  695-15-710ms   | [S2,MB6,B]  742-36-778ms   | [S2,MB7,B]  827-19-846ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-165ms    | [S3,MB1,F]  172-24-196ms   | [S3,MB1,B]  208-74-282ms   | [S3,MB2,F]  289-25-314ms   | [S3,MB2,B]  326-44-370ms   | [S3,MB3,F]  378-25-404ms   | [S3,MB3,B]  416-44-460ms   | [S3,MB4,F]  468-26-494ms   | [S3,MB4,B]  506-45-551ms   | [S3,MB5,F]  558-25-584ms   | [S3,MB5,B]  596-45-642ms   | [S3,MB6,F]  649-26-675ms   | [S3,MB6,B]  687-44-731ms   | [S3,MB7,F]  738-25-764ms   | [S3,MB7,B]  776-44-820ms  
[rank3]:2025-12-30 20:02:47,571 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_2002_stage3_step200.svg
[rank1]:2025-12-30 20:02:47,577 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2002_rank1_stage1.svg
[rank1]:	> Counts Sum: 41400, Total Sum: 172800 (23.96%), Ratio(%) per element: [22.91, 22.91, 26.04, 25.0, 21.87, 23.95, 21.87, 22.91, 22.91, 22.91, 21.87, 22.91, 22.91, 23.95, 23.95, 22.91, 21.87, 26.04, 25.0, 25.0, 25.0, 23.95, 22.91, 26.04, 26.04, 22.91, 26.04, 26.04, 26.04, 23.95, 25.0, 25.0, 23.95, 23.95, 23.95, 25.0, 27.08, 23.95, 23.95, 22.91, 23.95, 22.91, 22.91, 19.79, 25.0]
[rank2]:2025-12-30 20:02:47,741 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2002_stage2.svg
[rank3]:2025-12-30 20:02:47,704 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2002_rank3_stage3.svg
[rank0]:2025-12-30 20:02:47,743 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2002_stage0.svg
[rank3]:	> Counts Sum: 69680, Total Sum: 111360 (62.57%), Ratio(%) per element: [58.33, 59.37, 64.58, 57.29, 61.45, 58.33, 52.08, 69.79, 62.5, 63.54, 59.37, 57.29, 61.45, 60.41, 59.37, 59.37, 61.45, 68.75, 65.62, 65.62, 67.7, 65.62, 68.75, 61.45, 67.7, 68.75, 62.5, 62.5, 63.54]
[rank1]:2025-12-30 20:02:47,742 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2002_stage1.svg
[rank3]:2025-12-30 20:02:47,872 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2002_stage3.svg
[rank3]:2025-12-30 20:05:41,883 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-30 20:05:42,241 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-30 20:05:42,272 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 20:05:42,273 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.33)/0.33, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-30 20:05:42,270 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-30 20:05:45,698 - Avg. fwd time: 24.9903 / Avg. bwd time: 63.0757 / Avg. batch time: 851.5289 (ms) / GPU bubble ratio: 17.26%
[rank1]:2025-12-30 20:05:45,757 - Avg. fwd time: 19.9891 / Avg. bwd time: 43.7512 / Avg. batch time: 960.6998 (ms) / GPU bubble ratio: 46.92%
[rank2]:2025-12-30 20:05:45,726 - Avg. fwd time: 14.9882 / Avg. bwd time: 33.3205 / Avg. batch time: 900.5936 (ms) / GPU bubble ratio: 57.09%
[rank0]:2025-12-30 20:05:45,764 - Avg. fwd time: 16.1559 / Avg. bwd time: 36.0101 / Avg. batch time: 1005.2131 (ms) / GPU bubble ratio: 58.48%
[rank3]:2025-12-30 20:05:45,799 -  step: 250  loss:  0.5324  grad_norm:  2.4321  memory: 25.79GiB(54.28%)  tps: 9,183  tflops: 71.79  mfu: 23.01%
[rank1]:2025-12-30 20:05:45,791 -  step: 250  loss: -4.0000  grad_norm:  2.4321  memory: 12.86GiB(27.07%)  tps: 9,183  tflops: 71.79  mfu: 23.01%
[rank2]:2025-12-30 20:05:45,788 -  step: 250  loss: -4.0000  grad_norm:  2.4321  memory:  8.66GiB(18.23%)  tps: 9,183  tflops: 71.79  mfu: 23.01%
[rank0]:2025-12-30 20:05:45,801 -  step: 250  loss: -4.0000  grad_norm:  2.4321  memory: 16.87GiB(35.50%)  tps: 9,183  tflops: 71.79  mfu: 23.01%
[rank3]:2025-12-30 20:08:39,243 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.41(0.40)/0.40, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-30 20:08:39,607 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-30 20:08:39,635 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank0]:2025-12-30 20:08:39,637 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 20:08:39,638 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.32(0.33)/0.33, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-30 20:08:43,084 - Avg. fwd time: 25.0416 / Avg. bwd time: 60.8096 / Avg. batch time: 833.7362 (ms) / GPU bubble ratio: 17.62%
[rank1]:2025-12-30 20:08:43,144 - Avg. fwd time: 20.1163 / Avg. bwd time: 44.1998 / Avg. batch time: 940.0273 (ms) / GPU bubble ratio: 45.26%
[rank1]:2025-12-30 20:08:43,178 -  step: 300  loss: -4.0000  grad_norm:  0.2794  memory: 12.86GiB(27.07%)  tps: 9,236  tflops: 72.21  mfu: 23.14%
[rank2]:2025-12-30 20:08:43,113 - Avg. fwd time: 15.0210 / Avg. bwd time: 33.4709 / Avg. batch time: 881.4261 (ms) / GPU bubble ratio: 55.99%
[rank2]:2025-12-30 20:08:43,173 -  step: 300  loss: -4.0000  grad_norm:  0.2794  memory:  8.66GiB(18.23%)  tps: 9,236  tflops: 72.21  mfu: 23.14%
[rank0]:2025-12-30 20:08:43,151 - Avg. fwd time: 16.1885 / Avg. bwd time: 36.0418 / Avg. batch time: 981.0449 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-12-30 20:08:43,187 -  step: 300  loss: -4.0000  grad_norm:  0.2794  memory: 16.87GiB(35.50%)  tps: 9,236  tflops: 72.21  mfu: 23.14%
[rank0]:2025-12-30 20:08:43,236 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_2008_stage0_step300.svg
[rank3]:2025-12-30 20:08:43,185 -  step: 300  loss:  0.3021  grad_norm:  0.2794  memory: 25.79GiB(54.28%)  tps: 9,236  tflops: 72.21  mfu: 23.14%
[rank1]:2025-12-30 20:08:43,235 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_2008_stage1_step300.svg
[rank2]:2025-12-30 20:08:43,237 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_2008_stage2_step300.svg
[rank3]:2025-12-30 20:08:43,329 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2008_step300_rank3.svg
[rank3]:			> Batch Time: 855.50 ms, GPU Bubble Ratio: 50.08%, 37.09%, 53.63%, 30.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  278-42-320ms   | [S0,MB4,F]  321-15-336ms   | [S0,MB1,B]  374-42-417ms   | [S0,MB5,F]  417-16-433ms   | [S0,MB2,B]  466-42-508ms   | [S0,MB6,F]  508-16-525ms   | [S0,MB3,B]  555-42-597ms   | [S0,MB7,F]  598-16-614ms   | [S0,MB4,B]  645-42-688ms   | [S0,MB5,B]  733-42-775ms   | [S0,MB6,B]  811-39-850ms   | [S0,MB7,B]  855-0-855ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  220-46-266ms   | [S1,MB3,F]  275-19-294ms   | [S1,MB1,B]  319-46-366ms   | [S1,MB4,F]  370-20-391ms   | [S1,MB2,B]  407-50-457ms   | [S1,MB5,F]  462-22-484ms   | [S1,MB3,B]  495-51-547ms   | [S1,MB6,F]  551-22-574ms   | [S1,MB4,B]  584-52-637ms   | [S1,MB7,F]  641-22-664ms   | [S1,MB5,B]  672-52-725ms   | [S1,MB6,B]  757-47-805ms   | [S1,MB7,B]  824-24-849ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-210ms   | [S2,MB2,F]  217-15-232ms   | [S2,MB1,B]  273-36-309ms   | [S2,MB3,F]  316-15-331ms   | [S2,MB2,B]  360-36-397ms   | [S2,MB4,F]  404-15-420ms   | [S2,MB3,B]  448-36-485ms   | [S2,MB5,F]  492-15-507ms   | [S2,MB4,B]  536-36-573ms   | [S2,MB6,F]  582-15-597ms   | [S2,MB5,B]  626-36-662ms   | [S2,MB7,F]  670-15-685ms   | [S2,MB6,B]  714-36-751ms   | [S2,MB7,B]  799-18-818ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-164ms    | [S3,MB1,F]  171-24-195ms   | [S3,MB1,B]  206-52-259ms   | [S3,MB2,F]  270-24-294ms   | [S3,MB2,B]  306-43-350ms   | [S3,MB3,F]  357-25-383ms   | [S3,MB3,B]  393-44-437ms   | [S3,MB4,F]  445-26-471ms   | [S3,MB4,B]  482-43-526ms   | [S3,MB5,F]  533-26-559ms   | [S3,MB5,B]  572-44-616ms   | [S3,MB6,F]  623-25-648ms   | [S3,MB6,B]  660-43-703ms   | [S3,MB7,F]  711-26-737ms   | [S3,MB7,B]  749-43-793ms  
[rank1]:2025-12-30 20:08:43,379 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2008_rank1_stage1.svg
[rank1]:	> Counts Sum: 59400, Total Sum: 316800 (18.75%), Ratio(%) per element: [18.18, 18.18, 19.88, 19.31, 17.61, 18.75, 17.61, 18.18, 18.18, 18.18, 17.61, 18.18, 18.18, 18.75, 18.75, 18.18, 17.61, 19.88, 19.31, 19.31, 19.31, 18.75, 18.18, 19.88, 19.88, 18.18, 19.88, 19.88, 19.88, 18.75, 19.31, 19.31, 18.75, 18.75, 18.75, 19.31, 20.45, 18.75, 18.75, 18.18, 18.75, 18.18, 18.18, 16.47, 19.31]
[rank2]:2025-12-30 20:08:43,386 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2008_rank2_stage2.svg
[rank2]:	> Counts Sum: 47520, Total Sum: 253440 (18.75%), Ratio(%) per element: [19.31, 18.18, 18.75, 19.31, 18.18, 17.61, 18.18, 18.18, 19.31, 19.31, 19.31, 19.31, 18.75, 17.61, 18.75, 18.18, 19.31, 19.88, 19.31, 18.18, 18.18, 18.75, 18.18, 18.75, 17.61, 18.75, 18.75, 18.18, 18.18, 18.18, 19.88, 17.61, 19.31, 19.88, 19.88, 19.88]
[rank0]:2025-12-30 20:08:43,388 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2008_rank0_stage0.svg
[rank0]:	> Counts Sum: 57120, Total Sum: 260480 (21.93%), Ratio(%) per element: [25.0, 26.7, 22.72, 25.0, 22.72, 24.43, 25.56, 24.43, 23.86, 22.15, 23.86, 22.15, 21.59, 23.86, 23.86, 22.15, 24.43, 23.29, 23.29, 22.15, 22.72, 20.45, 22.72, 21.02, 19.31, 18.18, 22.15, 21.02, 17.61, 19.88, 19.31, 19.88, 19.31, 19.31, 17.61, 19.31, 18.18]
[rank3]:2025-12-30 20:08:43,372 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_2008_stage3_step300.svg
[rank3]:2025-12-30 20:08:43,502 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2008_rank3_stage3.svg
[rank3]:	> Counts Sum: 144080, Total Sum: 204160 (70.57%), Ratio(%) per element: [68.18, 70.45, 71.59, 66.47, 69.88, 68.18, 65.34, 74.43, 70.45, 71.59, 68.75, 68.18, 70.45, 71.02, 67.04, 69.31, 68.75, 71.59, 72.72, 71.02, 74.43, 72.72, 74.43, 70.45, 72.15, 73.86, 68.75, 71.59, 72.72]
[rank1]:2025-12-30 20:08:43,666 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2008_stage1.svg
[rank2]:2025-12-30 20:08:43,677 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2008_stage2.svg
[rank0]:2025-12-30 20:08:43,671 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2008_stage0.svg
[rank3]:2025-12-30 20:08:43,802 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2008_stage3.svg
[rank0]:2025-12-30 20:11:37,560 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 20:11:41,082 - Avg. fwd time: 25.0723 / Avg. bwd time: 59.2080 / Avg. batch time: 821.1137 (ms) / GPU bubble ratio: 17.89%
[rank1]:2025-12-30 20:11:41,141 - Avg. fwd time: 20.2126 / Avg. bwd time: 44.5134 / Avg. batch time: 925.3843 (ms) / GPU bubble ratio: 44.04%
[rank0]:2025-12-30 20:11:41,149 - Avg. fwd time: 16.2117 / Avg. bwd time: 36.0255 / Avg. batch time: 963.8900 (ms) / GPU bubble ratio: 56.64%
[rank2]:2025-12-30 20:11:41,110 - Avg. fwd time: 15.0487 / Avg. bwd time: 33.5713 / Avg. batch time: 867.8624 (ms) / GPU bubble ratio: 55.18%
[rank2]:2025-12-30 20:11:41,170 -  step: 350  loss: -4.0000  grad_norm:  0.1950  memory:  8.66GiB(18.23%)  tps: 9,205  tflops: 71.96  mfu: 23.06%
[rank3]:2025-12-30 20:11:41,183 -  step: 350  loss:  0.2329  grad_norm:  0.1950  memory: 25.79GiB(54.28%)  tps: 9,205  tflops: 71.96  mfu: 23.06%
[rank1]:2025-12-30 20:11:41,174 -  step: 350  loss: -4.0000  grad_norm:  0.1950  memory: 12.86GiB(27.07%)  tps: 9,205  tflops: 71.96  mfu: 23.06%
[rank0]:2025-12-30 20:11:41,185 -  step: 350  loss: -4.0000  grad_norm:  0.1950  memory: 16.87GiB(35.50%)  tps: 9,205  tflops: 71.96  mfu: 23.06%
[rank0]:2025-12-30 20:14:35,955 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 20:14:39,445 - Avg. fwd time: 25.0940 / Avg. bwd time: 58.0835 / Avg. batch time: 812.1940 (ms) / GPU bubble ratio: 18.07%
[rank2]:2025-12-30 20:14:39,472 - Avg. fwd time: 15.0624 / Avg. bwd time: 33.6410 / Avg. batch time: 858.1908 (ms) / GPU bubble ratio: 54.60%
[rank3]:2025-12-30 20:14:39,546 -  step: 400  loss:  0.2117  grad_norm:  0.1477  memory: 25.79GiB(54.28%)  tps: 9,186  tflops: 71.81  mfu: 23.02%
[rank0]:2025-12-30 20:14:39,512 - Avg. fwd time: 16.2295 / Avg. bwd time: 36.0332 / Avg. batch time: 951.5332 (ms) / GPU bubble ratio: 56.06%
[rank0]:2025-12-30 20:14:39,548 -  step: 400  loss: -4.0000  grad_norm:  0.1477  memory: 16.87GiB(35.50%)  tps: 9,186  tflops: 71.81  mfu: 23.02%
[rank1]:2025-12-30 20:14:39,504 - Avg. fwd time: 20.2709 / Avg. bwd time: 44.7301 / Avg. batch time: 914.9081 (ms) / GPU bubble ratio: 43.16%
[rank1]:2025-12-30 20:14:39,537 -  step: 400  loss: -4.0000  grad_norm:  0.1477  memory: 12.86GiB(27.07%)  tps: 9,186  tflops: 71.81  mfu: 23.02%
[rank2]:2025-12-30 20:14:39,533 -  step: 400  loss: -4.0000  grad_norm:  0.1477  memory:  8.66GiB(18.23%)  tps: 9,186  tflops: 71.81  mfu: 23.02%
[rank2]:2025-12-30 20:14:39,600 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_2014_stage2_step400.svg
[rank0]:2025-12-30 20:14:39,600 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_2014_stage0_step400.svg
[rank1]:2025-12-30 20:14:39,601 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_2014_stage1_step400.svg
[rank3]:2025-12-30 20:14:39,696 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2014_step400_rank3.svg
[rank3]:			> Batch Time: 855.00 ms, GPU Bubble Ratio: 50.14%, 37.10%, 53.82%, 30.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  278-43-321ms   | [S0,MB4,F]  322-15-337ms   | [S0,MB1,B]  372-42-415ms   | [S0,MB5,F]  415-16-431ms   | [S0,MB2,B]  463-42-505ms   | [S0,MB6,F]  505-16-522ms   | [S0,MB3,B]  554-42-596ms   | [S0,MB7,F]  597-16-613ms   | [S0,MB4,B]  643-42-686ms   | [S0,MB5,B]  731-42-773ms   | [S0,MB6,B]  809-38-847ms   | [S0,MB7,B]  855-0-855ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  68-18-86ms     | [S1,MB0,B]  220-46-267ms   | [S1,MB3,F]  275-19-295ms   | [S1,MB1,B]  317-47-364ms   | [S1,MB4,F]  369-21-390ms   | [S1,MB2,B]  405-49-455ms   | [S1,MB5,F]  459-22-481ms   | [S1,MB3,B]  494-51-546ms   | [S1,MB6,F]  550-23-573ms   | [S1,MB4,B]  583-52-635ms   | [S1,MB7,F]  640-22-662ms   | [S1,MB5,B]  671-53-724ms   | [S1,MB6,B]  755-47-803ms   | [S1,MB7,B]  823-24-847ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  270-36-306ms   | [S2,MB3,F]  314-14-329ms   | [S2,MB2,B]  358-36-395ms   | [S2,MB4,F]  402-15-418ms   | [S2,MB3,B]  447-36-484ms   | [S2,MB5,F]  491-15-506ms   | [S2,MB4,B]  535-36-572ms   | [S2,MB6,F]  580-15-595ms   | [S2,MB5,B]  624-36-660ms   | [S2,MB7,F]  668-15-683ms   | [S2,MB6,B]  713-36-749ms   | [S2,MB7,B]  799-18-817ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-51-258ms   | [S3,MB2,F]  267-24-291ms   | [S3,MB2,B]  304-43-348ms   | [S3,MB3,F]  355-25-381ms   | [S3,MB3,B]  393-43-436ms   | [S3,MB4,F]  444-26-470ms   | [S3,MB4,B]  481-43-525ms   | [S3,MB5,F]  532-25-558ms   | [S3,MB5,B]  570-44-614ms   | [S3,MB6,F]  621-26-647ms   | [S3,MB6,B]  659-44-703ms   | [S3,MB7,F]  709-25-735ms   | [S3,MB7,B]  748-44-792ms  
[rank3]:2025-12-30 20:14:39,744 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_2014_stage3_step400.svg
[rank0]:2025-12-30 20:14:39,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2014_rank0_stage0.svg
[rank0]:	> Counts Sum: 76720, Total Sum: 378880 (20.25%), Ratio(%) per element: [23.43, 24.6, 20.7, 22.65, 20.7, 23.82, 23.04, 21.87, 22.26, 21.09, 21.48, 20.7, 20.31, 22.65, 22.65, 20.7, 22.26, 21.87, 21.48, 21.48, 20.7, 19.92, 19.53, 18.35, 17.57, 17.57, 19.53, 19.53, 17.18, 17.96, 18.35, 18.35, 17.18, 17.18, 16.4, 17.57, 16.4]
[rank1]:2025-12-30 20:14:39,750 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2014_rank1_stage1.svg
[rank1]:	> Counts Sum: 77400, Total Sum: 460800 (16.80%), Ratio(%) per element: [16.4, 16.4, 17.57, 17.18, 16.01, 16.79, 16.01, 16.4, 16.4, 16.4, 16.01, 16.4, 16.4, 16.79, 16.79, 16.4, 16.01, 17.57, 17.18, 17.18, 17.18, 16.79, 16.4, 17.57, 17.57, 16.4, 17.57, 17.57, 17.57, 16.79, 17.18, 17.18, 16.79, 16.79, 16.79, 17.18, 17.96, 16.79, 16.79, 16.4, 16.79, 16.4, 16.4, 15.23, 17.18]
[rank2]:2025-12-30 20:14:39,748 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2014_rank2_stage2.svg
[rank2]:	> Counts Sum: 61920, Total Sum: 368640 (16.80%), Ratio(%) per element: [17.18, 16.4, 16.79, 17.18, 16.4, 16.01, 16.4, 16.4, 17.18, 17.18, 17.18, 17.18, 16.79, 16.01, 16.79, 16.4, 17.18, 17.57, 17.18, 16.4, 16.4, 16.79, 16.4, 16.79, 16.01, 16.79, 16.79, 16.4, 16.4, 16.4, 17.57, 16.01, 17.18, 17.57, 17.57, 17.57]
[rank3]:2025-12-30 20:14:39,879 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2014_rank3_stage3.svg
[rank3]:	> Counts Sum: 218480, Total Sum: 296960 (73.57%), Ratio(%) per element: [72.26, 74.21, 75.0, 71.09, 73.04, 71.87, 69.53, 76.56, 72.65, 73.04, 72.65, 71.48, 73.43, 74.21, 71.09, 73.43, 71.87, 74.6, 74.6, 73.43, 76.17, 74.6, 76.95, 73.82, 74.21, 76.56, 72.65, 72.65, 75.78]
[rank0]:2025-12-30 20:14:40,169 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2014_stage0.svg
[rank1]:2025-12-30 20:14:40,165 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2014_stage1.svg
[rank2]:2025-12-30 20:14:40,165 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2014_stage2.svg
[rank3]:2025-12-30 20:14:40,343 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2014_stage3.svg
[rank3]:2025-12-30 20:14:59,989 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 20:15:00,394 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 20:15:00,392 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 20:15:00,364 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 20:17:34,869 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 20:17:38,377 - Avg. fwd time: 25.1078 / Avg. bwd time: 57.2198 / Avg. batch time: 805.3069 (ms) / GPU bubble ratio: 18.21%
[rank2]:2025-12-30 20:17:38,406 - Avg. fwd time: 15.0740 / Avg. bwd time: 33.6901 / Avg. batch time: 850.7712 (ms) / GPU bubble ratio: 54.15%
[rank3]:2025-12-30 20:17:38,481 -  step: 450  loss:  0.2225  grad_norm:  0.1763  memory: 25.79GiB(54.28%)  tps: 9,157  tflops: 71.58  mfu: 22.94%
[rank0]:2025-12-30 20:17:38,446 - Avg. fwd time: 16.2385 / Avg. bwd time: 36.0235 / Avg. batch time: 942.0271 (ms) / GPU bubble ratio: 55.62%
[rank0]:2025-12-30 20:17:38,482 -  step: 450  loss: -4.0000  grad_norm:  0.1763  memory: 16.87GiB(35.50%)  tps: 9,156  tflops: 71.58  mfu: 22.94%
[rank1]:2025-12-30 20:17:38,438 - Avg. fwd time: 20.2934 / Avg. bwd time: 44.8748 / Avg. batch time: 906.8705 (ms) / GPU bubble ratio: 42.51%
[rank1]:2025-12-30 20:17:38,472 -  step: 450  loss: -4.0000  grad_norm:  0.1763  memory: 12.86GiB(27.07%)  tps: 9,156  tflops: 71.58  mfu: 22.94%
[rank2]:2025-12-30 20:17:38,468 -  step: 450  loss: -4.0000  grad_norm:  0.1763  memory:  8.66GiB(18.23%)  tps: 9,156  tflops: 71.58  mfu: 22.94%
[rank0]:2025-12-30 20:20:33,638 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 20:20:37,161 - Avg. fwd time: 25.1088 / Avg. bwd time: 56.5662 / Avg. batch time: 799.9994 (ms) / GPU bubble ratio: 18.32%
[rank2]:2025-12-30 20:20:37,190 - Avg. fwd time: 15.0762 / Avg. bwd time: 33.7235 / Avg. batch time: 844.9770 (ms) / GPU bubble ratio: 53.80%
[rank2]:2025-12-30 20:20:37,253 -  step: 500  loss: -4.0000  grad_norm:  0.1705  memory:  8.66GiB(18.23%)  tps: 9,164  tflops: 71.64  mfu: 22.96%
[rank0]:2025-12-30 20:20:37,231 - Avg. fwd time: 16.2432 / Avg. bwd time: 36.0473 / Avg. batch time: 934.5599 (ms) / GPU bubble ratio: 55.24%
[rank0]:2025-12-30 20:20:37,267 -  step: 500  loss: -4.0000  grad_norm:  0.1705  memory: 16.87GiB(35.50%)  tps: 9,164  tflops: 71.64  mfu: 22.96%
[rank1]:2025-12-30 20:20:37,222 - Avg. fwd time: 20.3008 / Avg. bwd time: 44.9664 / Avg. batch time: 900.5758 (ms) / GPU bubble ratio: 42.02%
[rank1]:2025-12-30 20:20:37,257 -  step: 500  loss: -4.0000  grad_norm:  0.1705  memory: 12.86GiB(27.07%)  tps: 9,164  tflops: 71.64  mfu: 22.96%
[rank3]:2025-12-30 20:20:37,265 -  step: 500  loss:  0.2162  grad_norm:  0.1705  memory: 25.79GiB(54.28%)  tps: 9,164  tflops: 71.64  mfu: 22.96%
[rank2]:2025-12-30 20:20:37,314 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_2020_stage2_step500.svg
[rank0]:2025-12-30 20:20:37,314 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_2020_stage0_step500.svg
[rank1]:2025-12-30 20:20:37,315 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_2020_stage1_step500.svg
[rank3]:2025-12-30 20:20:37,414 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2020_step500_rank3.svg
[rank3]:			> Batch Time: 874.00 ms, GPU Bubble Ratio: 51.76%, 39.48%, 54.96%, 29.62%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  275-42-318ms   | [S0,MB4,F]  318-15-334ms   | [S0,MB1,B]  390-42-432ms   | [S0,MB5,F]  432-16-448ms   | [S0,MB2,B]  481-42-523ms   | [S0,MB6,F]  524-16-540ms   | [S0,MB3,B]  571-42-614ms   | [S0,MB7,F]  614-16-630ms   | [S0,MB4,B]  660-42-703ms   | [S0,MB5,B]  749-42-791ms   | [S0,MB6,B]  829-36-865ms   | [S0,MB7,B]  874-0-874ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-46-267ms   | [S1,MB3,F]  272-19-291ms   | [S1,MB1,B]  336-46-382ms   | [S1,MB4,F]  386-20-407ms   | [S1,MB2,B]  424-48-472ms   | [S1,MB5,F]  477-21-499ms   | [S1,MB3,B]  513-50-563ms   | [S1,MB6,F]  568-22-590ms   | [S1,MB4,B]  602-51-653ms   | [S1,MB7,F]  657-22-679ms   | [S1,MB5,B]  690-51-742ms   | [S1,MB6,B]  775-47-822ms   | [S1,MB7,B]  843-24-867ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  174-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  289-35-325ms   | [S2,MB3,F]  332-14-347ms   | [S2,MB2,B]  377-36-413ms   | [S2,MB4,F]  421-15-436ms   | [S2,MB3,B]  465-36-502ms   | [S2,MB5,F]  509-15-525ms   | [S2,MB4,B]  555-36-591ms   | [S2,MB6,F]  599-15-614ms   | [S2,MB5,B]  644-36-680ms   | [S2,MB7,F]  687-15-703ms   | [S2,MB6,B]  732-36-769ms   | [S2,MB7,B]  817-18-836ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-76-164ms    | [S3,MB1,F]  171-23-195ms   | [S3,MB1,B]  206-74-280ms   | [S3,MB2,F]  286-25-312ms   | [S3,MB2,B]  323-43-367ms   | [S3,MB3,F]  374-25-400ms   | [S3,MB3,B]  412-43-456ms   | [S3,MB4,F]  462-26-488ms   | [S3,MB4,B]  500-43-544ms   | [S3,MB5,F]  552-25-578ms   | [S3,MB5,B]  590-43-633ms   | [S3,MB6,F]  641-25-666ms   | [S3,MB6,B]  679-43-722ms   | [S3,MB7,F]  729-25-755ms   | [S3,MB7,B]  767-43-810ms  
[rank2]:2025-12-30 20:20:37,462 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2020_rank2_stage2.svg
[rank2]:	> Counts Sum: 76320, Total Sum: 483840 (15.77%), Ratio(%) per element: [16.07, 15.47, 15.77, 16.07, 15.47, 15.17, 15.47, 15.47, 16.07, 16.07, 16.07, 16.07, 15.77, 15.17, 15.77, 15.47, 16.07, 16.36, 16.07, 15.47, 15.47, 15.77, 15.47, 15.77, 15.17, 15.77, 15.77, 15.47, 15.47, 15.47, 16.36, 15.17, 16.07, 16.36, 16.36, 16.36]
[rank0]:2025-12-30 20:20:37,464 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2020_rank0_stage0.svg
[rank0]:	> Counts Sum: 96320, Total Sum: 497280 (19.37%), Ratio(%) per element: [21.72, 23.21, 19.94, 22.32, 20.23, 23.21, 21.72, 20.83, 21.42, 20.23, 21.13, 20.23, 19.94, 20.83, 21.72, 19.64, 20.83, 20.23, 21.42, 20.53, 18.75, 18.75, 19.34, 18.15, 17.55, 17.26, 18.45, 17.85, 16.07, 17.26, 17.85, 16.96, 16.07, 16.07, 16.07, 16.96, 15.77]
[rank1]:2025-12-30 20:20:37,462 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2020_rank1_stage1.svg
[rank1]:	> Counts Sum: 95400, Total Sum: 604800 (15.77%), Ratio(%) per element: [15.47, 15.47, 16.36, 16.07, 15.17, 15.77, 15.17, 15.47, 15.47, 15.47, 15.17, 15.47, 15.47, 15.77, 15.77, 15.47, 15.17, 16.36, 16.07, 16.07, 16.07, 15.77, 15.47, 16.36, 16.36, 15.47, 16.36, 16.36, 16.36, 15.77, 16.07, 16.07, 15.77, 15.77, 15.77, 16.07, 16.66, 15.77, 15.77, 15.47, 15.77, 15.47, 15.47, 14.58, 16.07]
[rank3]:2025-12-30 20:20:37,458 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_2020_stage3_step500.svg
[rank3]:2025-12-30 20:20:37,590 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2020_rank3_stage3.svg
[rank3]:	> Counts Sum: 292880, Total Sum: 389760 (75.14%), Ratio(%) per element: [73.8, 75.89, 76.48, 72.61, 75.29, 74.1, 71.42, 77.38, 74.1, 75.0, 74.7, 73.8, 74.7, 76.19, 73.21, 75.0, 73.51, 75.89, 76.48, 74.4, 77.08, 75.59, 77.97, 75.0, 75.89, 77.97, 74.4, 74.7, 76.48]
[rank2]:2025-12-30 20:20:38,008 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2020_stage2.svg
[rank0]:2025-12-30 20:20:37,992 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2020_stage0.svg
[rank1]:2025-12-30 20:20:37,991 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2020_stage1.svg
[rank3]:2025-12-30 20:20:38,143 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2020_stage3.svg
[rank0]:2025-12-30 20:23:31,748 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 20:23:35,294 - Avg. fwd time: 25.1144 / Avg. bwd time: 55.9406 / Avg. batch time: 795.0191 (ms) / GPU bubble ratio: 18.44%
[rank0]:2025-12-30 20:23:35,366 - Avg. fwd time: 16.2497 / Avg. bwd time: 36.0363 / Avg. batch time: 927.8572 (ms) / GPU bubble ratio: 54.92%
[rank2]:2025-12-30 20:23:35,324 - Avg. fwd time: 15.0823 / Avg. bwd time: 33.7524 / Avg. batch time: 839.6434 (ms) / GPU bubble ratio: 53.47%
[rank2]:2025-12-30 20:23:35,388 -  step: 550  loss: -4.0000  grad_norm:  0.1472  memory:  8.66GiB(18.23%)  tps: 9,198  tflops: 71.90  mfu: 23.05%
[rank1]:2025-12-30 20:23:35,357 - Avg. fwd time: 20.3222 / Avg. bwd time: 45.0718 / Avg. batch time: 894.8321 (ms) / GPU bubble ratio: 41.54%
[rank1]:2025-12-30 20:23:35,392 -  step: 550  loss: -4.0000  grad_norm:  0.1472  memory: 12.86GiB(27.07%)  tps: 9,198  tflops: 71.90  mfu: 23.05%
[rank3]:2025-12-30 20:23:35,400 -  step: 550  loss:  0.2211  grad_norm:  0.1472  memory: 25.79GiB(54.28%)  tps: 9,198  tflops: 71.90  mfu: 23.05%
[rank0]:2025-12-30 20:23:35,403 -  step: 550  loss: -4.0000  grad_norm:  0.1472  memory: 16.87GiB(35.50%)  tps: 9,198  tflops: 71.90  mfu: 23.05%
[rank0]:2025-12-30 20:26:30,264 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 20:26:33,851 - Avg. fwd time: 25.1093 / Avg. bwd time: 55.4966 / Avg. batch time: 791.3804 (ms) / GPU bubble ratio: 18.52%
[rank0]:2025-12-30 20:26:33,924 - Avg. fwd time: 16.2480 / Avg. bwd time: 36.0063 / Avg. batch time: 922.7162 (ms) / GPU bubble ratio: 54.70%
[rank2]:2025-12-30 20:26:33,879 - Avg. fwd time: 15.0805 / Avg. bwd time: 33.7676 / Avg. batch time: 835.6671 (ms) / GPU bubble ratio: 53.24%
[rank2]:2025-12-30 20:26:33,946 -  step: 600  loss: -4.0000  grad_norm:  0.1474  memory:  8.66GiB(18.23%)  tps: 9,176  tflops: 71.73  mfu: 22.99%
[rank1]:2025-12-30 20:26:33,915 - Avg. fwd time: 20.3464 / Avg. bwd time: 45.1320 / Avg. batch time: 890.4962 (ms) / GPU bubble ratio: 41.18%
[rank1]:2025-12-30 20:26:33,950 -  step: 600  loss: -4.0000  grad_norm:  0.1474  memory: 12.86GiB(27.07%)  tps: 9,176  tflops: 71.73  mfu: 22.99%
[rank3]:2025-12-30 20:26:33,959 -  step: 600  loss:  0.2150  grad_norm:  0.1474  memory: 25.79GiB(54.28%)  tps: 9,176  tflops: 71.73  mfu: 22.99%
[rank0]:2025-12-30 20:26:33,960 -  step: 600  loss: -4.0000  grad_norm:  0.1474  memory: 16.87GiB(35.50%)  tps: 9,176  tflops: 71.73  mfu: 22.99%
[rank0]:2025-12-30 20:26:34,009 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_2026_stage0_step600.svg
[rank2]:2025-12-30 20:26:34,010 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_2026_stage2_step600.svg
[rank1]:2025-12-30 20:26:34,009 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_2026_stage1_step600.svg
[rank1]:2025-12-30 20:26:34,159 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2026_rank1_stage1.svg
[rank1]:	> Counts Sum: 113400, Total Sum: 748800 (15.14%), Ratio(%) per element: [14.9, 14.9, 15.62, 15.38, 14.66, 15.14, 14.66, 14.9, 14.9, 14.9, 14.66, 14.9, 14.9, 15.14, 15.14, 14.9, 14.66, 15.62, 15.38, 15.38, 15.38, 15.14, 14.9, 15.62, 15.62, 14.9, 15.62, 15.62, 15.62, 15.14, 15.38, 15.38, 15.14, 15.14, 15.14, 15.38, 15.86, 15.14, 15.14, 14.9, 15.14, 14.9, 14.9, 14.18, 15.38]
[rank3]:2025-12-30 20:26:34,108 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2026_step600_rank3.svg
[rank3]:			> Batch Time: 854.00 ms, GPU Bubble Ratio: 50.68%, 37.69%, 54.01%, 30.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  277-42-320ms   | [S0,MB4,F]  320-15-336ms   | [S0,MB1,B]  376-42-418ms   | [S0,MB5,F]  418-16-434ms   | [S0,MB2,B]  465-42-508ms   | [S0,MB6,F]  508-16-524ms   | [S0,MB3,B]  555-42-598ms   | [S0,MB7,F]  598-16-614ms   | [S0,MB4,B]  644-42-686ms   | [S0,MB5,B]  730-42-772ms   | [S0,MB6,B]  808-36-844ms   | [S0,MB7,B]  854-0-854ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-46-267ms   | [S1,MB3,F]  274-19-294ms   | [S1,MB1,B]  320-47-368ms   | [S1,MB4,F]  372-21-394ms   | [S1,MB2,B]  407-49-457ms   | [S1,MB5,F]  462-21-484ms   | [S1,MB3,B]  496-51-547ms   | [S1,MB6,F]  552-22-575ms   | [S1,MB4,B]  584-51-635ms   | [S1,MB7,F]  641-22-663ms   | [S1,MB5,B]  672-51-724ms   | [S1,MB6,B]  755-46-802ms   | [S1,MB7,B]  823-23-847ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  174-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  274-36-310ms   | [S2,MB3,F]  317-14-332ms   | [S2,MB2,B]  361-36-397ms   | [S2,MB4,F]  404-15-420ms   | [S2,MB3,B]  449-36-485ms   | [S2,MB5,F]  493-15-508ms   | [S2,MB4,B]  537-36-573ms   | [S2,MB6,F]  581-15-596ms   | [S2,MB5,B]  625-36-661ms   | [S2,MB7,F]  669-15-684ms   | [S2,MB6,B]  712-36-748ms   | [S2,MB7,B]  797-18-816ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  87-76-164ms    | [S3,MB1,F]  171-23-195ms   | [S3,MB1,B]  207-54-261ms   | [S3,MB2,F]  271-24-295ms   | [S3,MB2,B]  307-43-351ms   | [S3,MB3,F]  358-25-383ms   | [S3,MB3,B]  394-43-438ms   | [S3,MB4,F]  446-25-472ms   | [S3,MB4,B]  483-43-527ms   | [S3,MB5,F]  534-25-559ms   | [S3,MB5,B]  571-44-615ms   | [S3,MB6,F]  622-25-648ms   | [S3,MB6,B]  659-43-703ms   | [S3,MB7,F]  709-26-735ms   | [S3,MB7,B]  747-43-791ms  
[rank3]:2025-12-30 20:26:34,153 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_2026_stage3_step600.svg
[rank0]:2025-12-30 20:26:34,158 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2026_rank0_stage0.svg
[rank0]:	> Counts Sum: 115920, Total Sum: 615680 (18.83%), Ratio(%) per element: [21.63, 22.59, 19.95, 20.91, 20.19, 21.87, 21.39, 21.15, 21.15, 19.71, 20.67, 20.19, 19.71, 20.67, 20.91, 19.23, 20.19, 18.75, 20.43, 20.19, 17.78, 18.02, 18.5, 17.54, 17.06, 17.06, 17.54, 17.54, 15.62, 16.58, 17.54, 16.34, 15.38, 15.62, 15.62, 16.1, 15.14]
[rank2]:2025-12-30 20:26:34,158 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2026_rank2_stage2.svg
[rank2]:	> Counts Sum: 90720, Total Sum: 599040 (15.14%), Ratio(%) per element: [15.38, 14.9, 15.14, 15.38, 14.9, 14.66, 14.9, 14.9, 15.38, 15.38, 15.38, 15.38, 15.14, 14.66, 15.14, 14.9, 15.38, 15.62, 15.38, 14.9, 14.9, 15.14, 14.9, 15.14, 14.66, 15.14, 15.14, 14.9, 14.9, 14.9, 15.62, 14.66, 15.38, 15.62, 15.62, 15.62]
[rank3]:2025-12-30 20:26:34,288 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2026_rank3_stage3.svg
[rank3]:	> Counts Sum: 367280, Total Sum: 482560 (76.11%), Ratio(%) per element: [74.75, 76.68, 76.92, 74.27, 76.92, 75.0, 73.07, 78.12, 75.96, 75.72, 75.72, 75.72, 75.72, 76.68, 74.51, 76.2, 74.27, 76.44, 77.16, 75.24, 77.16, 77.16, 78.6, 76.44, 75.96, 78.6, 75.0, 75.72, 77.4]
[rank0]:2025-12-30 20:26:34,808 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2026_stage0.svg
[rank2]:2025-12-30 20:26:34,824 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2026_stage2.svg
[rank1]:2025-12-30 20:26:34,814 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2026_stage1.svg
[rank3]:2025-12-30 20:26:34,970 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2026_stage3.svg
[rank0]:2025-12-30 20:29:30,511 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 20:29:33,921 - Avg. fwd time: 25.1123 / Avg. bwd time: 55.1457 / Avg. batch time: 788.5374 (ms) / GPU bubble ratio: 18.58%
[rank1]:2025-12-30 20:29:33,984 - Avg. fwd time: 20.3632 / Avg. bwd time: 45.1842 / Avg. batch time: 887.1066 (ms) / GPU bubble ratio: 40.89%
[rank2]:2025-12-30 20:29:33,951 - Avg. fwd time: 15.0801 / Avg. bwd time: 33.7834 / Avg. batch time: 832.5803 (ms) / GPU bubble ratio: 53.05%
[rank0]:2025-12-30 20:29:33,993 - Avg. fwd time: 16.2479 / Avg. bwd time: 36.0036 / Avg. batch time: 918.6467 (ms) / GPU bubble ratio: 54.50%
[rank0]:2025-12-30 20:29:34,029 -  step: 650  loss: -4.0000  grad_norm:  0.1549  memory: 16.87GiB(35.50%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank1]:2025-12-30 20:29:34,019 -  step: 650  loss: -4.0000  grad_norm:  0.1549  memory: 12.86GiB(27.07%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank2]:2025-12-30 20:29:34,015 -  step: 650  loss: -4.0000  grad_norm:  0.1549  memory:  8.66GiB(18.23%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank3]:2025-12-30 20:29:34,028 -  step: 650  loss:  0.2257  grad_norm:  0.1549  memory: 25.79GiB(54.28%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank0]:2025-12-30 20:32:28,881 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 20:32:32,412 - Avg. fwd time: 15.0830 / Avg. bwd time: 33.7996 / Avg. batch time: 829.6044 (ms) / GPU bubble ratio: 52.86%
[rank3]:2025-12-30 20:32:32,382 - Avg. fwd time: 25.1173 / Avg. bwd time: 54.8031 / Avg. batch time: 785.8052 (ms) / GPU bubble ratio: 18.64%
[rank0]:2025-12-30 20:32:32,455 - Avg. fwd time: 16.2493 / Avg. bwd time: 36.0039 / Avg. batch time: 914.8502 (ms) / GPU bubble ratio: 54.31%
[rank2]:2025-12-30 20:32:32,477 -  step: 700  loss: -4.0000  grad_norm:  0.1213  memory:  8.66GiB(18.23%)  tps: 9,181  tflops: 71.77  mfu: 23.00%
[rank1]:2025-12-30 20:32:32,445 - Avg. fwd time: 20.3702 / Avg. bwd time: 45.2373 / Avg. batch time: 883.8881 (ms) / GPU bubble ratio: 40.62%
[rank1]:2025-12-30 20:32:32,481 -  step: 700  loss: -4.0000  grad_norm:  0.1213  memory: 12.86GiB(27.07%)  tps: 9,181  tflops: 71.77  mfu: 23.00%
[rank3]:2025-12-30 20:32:32,489 -  step: 700  loss:  0.1862  grad_norm:  0.1213  memory: 25.79GiB(54.28%)  tps: 9,181  tflops: 71.77  mfu: 23.00%
[rank0]:2025-12-30 20:32:32,491 -  step: 700  loss: -4.0000  grad_norm:  0.1213  memory: 16.87GiB(35.50%)  tps: 9,181  tflops: 71.77  mfu: 23.00%
[rank0]:2025-12-30 20:32:32,544 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_2032_stage0_step700.svg
[rank2]:2025-12-30 20:32:32,542 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_2032_stage2_step700.svg
[rank1]:2025-12-30 20:32:32,543 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_2032_stage1_step700.svg
[rank3]:2025-12-30 20:32:32,639 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2032_step700_rank3.svg
[rank3]:			> Batch Time: 857.50 ms, GPU Bubble Ratio: 51.51%, 37.61%, 53.98%, 30.77%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  277-42-320ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  376-42-418ms   | [S0,MB5,F]  419-16-435ms   | [S0,MB2,B]  465-42-508ms   | [S0,MB6,F]  508-16-524ms   | [S0,MB3,B]  554-42-597ms   | [S0,MB7,F]  597-16-613ms   | [S0,MB4,B]  644-42-687ms   | [S0,MB5,B]  733-42-775ms   | [S0,MB6,B]  812-29-841ms   | [S0,MB7,B]  857-0-857ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  273-19-293ms   | [S1,MB1,B]  320-47-367ms   | [S1,MB4,F]  372-21-394ms   | [S1,MB2,B]  407-49-456ms   | [S1,MB5,F]  461-21-483ms   | [S1,MB3,B]  496-51-547ms   | [S1,MB6,F]  551-22-574ms   | [S1,MB4,B]  584-51-636ms   | [S1,MB7,F]  640-22-663ms   | [S1,MB5,B]  674-52-726ms   | [S1,MB6,B]  758-47-806ms   | [S1,MB7,B]  827-24-851ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-15-231ms   | [S2,MB1,B]  274-36-310ms   | [S2,MB3,F]  317-15-332ms   | [S2,MB2,B]  360-36-396ms   | [S2,MB4,F]  403-15-419ms   | [S2,MB3,B]  448-36-485ms   | [S2,MB5,F]  492-15-507ms   | [S2,MB4,B]  537-36-573ms   | [S2,MB6,F]  580-15-596ms   | [S2,MB5,B]  626-36-662ms   | [S2,MB7,F]  669-15-685ms   | [S2,MB6,B]  714-36-751ms   | [S2,MB7,B]  800-18-819ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-54-260ms   | [S3,MB2,F]  271-24-296ms   | [S3,MB2,B]  307-43-350ms   | [S3,MB3,F]  357-25-382ms   | [S3,MB3,B]  394-43-438ms   | [S3,MB4,F]  445-26-471ms   | [S3,MB4,B]  483-43-527ms   | [S3,MB5,F]  534-25-560ms   | [S3,MB5,B]  572-44-616ms   | [S3,MB6,F]  623-25-649ms   | [S3,MB6,B]  661-43-705ms   | [S3,MB7,F]  712-25-737ms   | [S3,MB7,B]  749-44-793ms  
[rank2]:2025-12-30 20:32:32,692 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2032_rank2_stage2.svg
[rank2]:	> Counts Sum: 105120, Total Sum: 714240 (14.72%), Ratio(%) per element: [14.91, 14.51, 14.71, 14.91, 14.51, 14.31, 14.51, 14.51, 14.91, 14.91, 14.91, 14.91, 14.71, 14.31, 14.71, 14.51, 14.91, 15.12, 14.91, 14.51, 14.51, 14.71, 14.51, 14.71, 14.31, 14.71, 14.71, 14.51, 14.51, 14.51, 15.12, 14.31, 14.91, 15.12, 15.12, 15.12]
[rank1]:2025-12-30 20:32:32,691 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2032_rank1_stage1.svg
[rank1]:	> Counts Sum: 131400, Total Sum: 892800 (14.72%), Ratio(%) per element: [14.51, 14.51, 15.12, 14.91, 14.31, 14.71, 14.31, 14.51, 14.51, 14.51, 14.31, 14.51, 14.51, 14.71, 14.71, 14.51, 14.31, 15.12, 14.91, 14.91, 14.91, 14.71, 14.51, 15.12, 15.12, 14.51, 15.12, 15.12, 15.12, 14.71, 14.91, 14.91, 14.71, 14.71, 14.71, 14.91, 15.32, 14.71, 14.71, 14.51, 14.71, 14.51, 14.51, 13.91, 14.91]
[rank3]:2025-12-30 20:32:32,686 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_2032_stage3_step700.svg
[rank0]:2025-12-30 20:32:32,709 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2032_rank0_stage0.svg
[rank0]:	> Counts Sum: 135520, Total Sum: 734080 (18.46%), Ratio(%) per element: [21.16, 21.57, 19.75, 20.96, 20.36, 20.96, 20.76, 20.76, 19.95, 19.55, 20.36, 19.95, 19.15, 20.36, 20.16, 18.75, 20.36, 18.75, 19.35, 19.95, 17.54, 17.33, 18.14, 16.93, 17.33, 16.33, 17.33, 16.73, 16.12, 16.53, 16.93, 15.92, 14.91, 15.92, 15.12, 15.92, 14.91]
[rank3]:2025-12-30 20:32:32,817 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2032_rank3_stage3.svg
[rank3]:	> Counts Sum: 441680, Total Sum: 575360 (76.77%), Ratio(%) per element: [76.61, 77.01, 77.62, 75.2, 77.41, 76.0, 73.79, 78.42, 76.41, 76.2, 76.41, 76.61, 76.2, 77.41, 76.0, 76.41, 75.6, 76.81, 77.62, 75.4, 77.62, 77.62, 78.62, 77.01, 77.01, 78.83, 76.2, 76.41, 77.62]
[rank2]:2025-12-30 20:32:33,496 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2032_stage2.svg
[rank1]:2025-12-30 20:32:33,477 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2032_stage1.svg
[rank0]:2025-12-30 20:32:33,493 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2032_stage0.svg
[rank3]:2025-12-30 20:32:33,636 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2032_stage3.svg
[rank0]:2025-12-30 20:35:29,244 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-30 20:35:32,737 - Avg. fwd time: 15.0863 / Avg. bwd time: 33.8143 / Avg. batch time: 827.3460 (ms) / GPU bubble ratio: 52.72%
[rank3]:2025-12-30 20:35:32,708 - Avg. fwd time: 25.1217 / Avg. bwd time: 54.5447 / Avg. batch time: 783.7315 (ms) / GPU bubble ratio: 18.68%
[rank1]:2025-12-30 20:35:32,771 - Avg. fwd time: 20.3897 / Avg. bwd time: 45.2930 / Avg. batch time: 881.4118 (ms) / GPU bubble ratio: 40.38%
[rank0]:2025-12-30 20:35:32,781 - Avg. fwd time: 16.2519 / Avg. bwd time: 36.0199 / Avg. batch time: 911.8736 (ms) / GPU bubble ratio: 54.14%
[rank0]:2025-12-30 20:35:32,817 -  step: 750  loss: -4.0000  grad_norm:  0.1676  memory: 16.87GiB(35.50%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank2]:2025-12-30 20:35:32,803 -  step: 750  loss: -4.0000  grad_norm:  0.1676  memory:  8.66GiB(18.23%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank3]:2025-12-30 20:35:32,815 -  step: 750  loss:  0.2225  grad_norm:  0.1676  memory: 25.79GiB(54.28%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank1]:2025-12-30 20:35:32,806 -  step: 750  loss: -4.0000  grad_norm:  0.1676  memory: 12.86GiB(27.07%)  tps: 9,086  tflops: 71.03  mfu: 22.77%
[rank0]:2025-12-30 20:38:28,853 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 20:38:32,472 - Avg. fwd time: 15.0913 / Avg. bwd time: 33.8282 / Avg. batch time: 825.4479 (ms) / GPU bubble ratio: 52.59%
[rank3]:2025-12-30 20:38:32,443 - Avg. fwd time: 25.1344 / Avg. bwd time: 54.3232 / Avg. batch time: 782.0231 (ms) / GPU bubble ratio: 18.72%
[rank1]:2025-12-30 20:38:32,506 - Avg. fwd time: 20.4132 / Avg. bwd time: 45.3437 / Avg. batch time: 879.3229 (ms) / GPU bubble ratio: 40.17%
[rank0]:2025-12-30 20:38:32,517 - Avg. fwd time: 16.2544 / Avg. bwd time: 36.0164 / Avg. batch time: 909.3465 (ms) / GPU bubble ratio: 54.01%
[rank0]:2025-12-30 20:38:32,553 -  step: 800  loss: -4.0000  grad_norm:  0.1585  memory: 16.87GiB(35.50%)  tps: 9,116  tflops: 71.26  mfu: 22.84%
[rank0]:2025-12-30 20:38:32,553 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1585  tps: 9,269  tflops: 72.46  mfu: 21.18%
[rank0]:2025-12-30 20:38:32,553 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 20:38:32,554 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 20:38:32,538 -  step: 800  loss: -4.0000  grad_norm:  0.1585  memory:  8.66GiB(18.23%)  tps: 9,116  tflops: 71.26  mfu: 22.84%
[rank2]:2025-12-30 20:38:32,539 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1585  tps: 9,269  tflops: 72.46  mfu: 21.19%
[rank2]:2025-12-30 20:38:32,539 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-30 20:38:32,539 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 20:38:32,551 -  step: 800  loss:  0.2282  grad_norm:  0.1585  memory: 25.79GiB(54.28%)  tps: 9,116  tflops: 71.26  mfu: 22.84%
[rank3]:2025-12-30 20:38:32,552 - â„¹ï¸ final step: 800  loss:  0.2282  grad_norm:  0.1585  tps: 9,280  tflops: 72.55  mfu: 21.36%
[rank3]:2025-12-30 20:38:32,552 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 20:38:32,553 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-30 20:38:32,542 -  step: 800  loss: -4.0000  grad_norm:  0.1585  memory: 12.86GiB(27.07%)  tps: 9,116  tflops: 71.26  mfu: 22.84%
[rank1]:2025-12-30 20:38:32,542 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1585  tps: 9,269  tflops: 72.46  mfu: 21.18%
[rank1]:2025-12-30 20:38:32,542 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 20:38:32,543 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 20:38:34,515 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-30 20:38:34,582 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank1/251230_2038_stage1_final800.svg
[rank0]:2025-12-30 20:38:34,584 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank0/251230_2038_stage0_final800.svg
[rank2]:2025-12-30 20:38:34,583 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank2/251230_2038_stage2_final800.svg
[rank3]:2025-12-30 20:38:34,673 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2038_final800_rank3.svg
[rank3]:			> Batch Time: 871.00 ms, GPU Bubble Ratio: 51.71%, 39.08%, 54.82%, 29.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  275-42-318ms   | [S0,MB4,F]  318-15-333ms   | [S0,MB1,B]  386-42-428ms   | [S0,MB5,F]  428-16-444ms   | [S0,MB2,B]  478-42-521ms   | [S0,MB6,F]  521-16-537ms   | [S0,MB3,B]  569-42-612ms   | [S0,MB7,F]  612-16-628ms   | [S0,MB4,B]  659-42-701ms   | [S0,MB5,B]  747-42-789ms   | [S0,MB6,B]  826-34-861ms   | [S0,MB7,B]  871-0-871ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  272-19-292ms   | [S1,MB1,B]  331-46-378ms   | [S1,MB4,F]  383-20-403ms   | [S1,MB2,B]  422-48-470ms   | [S1,MB5,F]  475-21-497ms   | [S1,MB3,B]  510-50-561ms   | [S1,MB6,F]  566-22-588ms   | [S1,MB4,B]  599-51-651ms   | [S1,MB7,F]  655-22-678ms   | [S1,MB5,B]  688-51-740ms   | [S1,MB6,B]  773-46-820ms   | [S1,MB7,B]  840-24-864ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  285-35-321ms   | [S2,MB3,F]  328-15-343ms   | [S2,MB2,B]  375-36-411ms   | [S2,MB4,F]  419-15-434ms   | [S2,MB3,B]  463-36-500ms   | [S2,MB5,F]  507-15-523ms   | [S2,MB4,B]  552-36-588ms   | [S2,MB6,F]  596-15-611ms   | [S2,MB5,B]  641-36-677ms   | [S2,MB7,F]  685-15-700ms   | [S2,MB6,B]  730-36-766ms   | [S2,MB7,B]  815-18-833ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-71-278ms   | [S3,MB2,F]  282-25-307ms   | [S3,MB2,B]  320-44-364ms   | [S3,MB3,F]  372-25-397ms   | [S3,MB3,B]  409-44-453ms   | [S3,MB4,F]  460-25-486ms   | [S3,MB4,B]  498-44-542ms   | [S3,MB5,F]  549-25-575ms   | [S3,MB5,B]  587-44-631ms   | [S3,MB6,F]  638-25-664ms   | [S3,MB6,B]  676-44-720ms   | [S3,MB7,F]  727-25-752ms   | [S3,MB7,B]  764-44-808ms  
[rank1]:2025-12-30 20:38:34,729 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2038_rank1_stage1.svg
[rank1]:	> Counts Sum: 149400, Total Sum: 1036800 (14.41%), Ratio(%) per element: [14.23, 14.23, 14.75, 14.58, 14.06, 14.4, 14.06, 14.23, 14.23, 14.23, 14.06, 14.23, 14.23, 14.4, 14.4, 14.23, 14.06, 14.75, 14.58, 14.58, 14.58, 14.4, 14.23, 14.75, 14.75, 14.23, 14.75, 14.75, 14.75, 14.4, 14.58, 14.58, 14.4, 14.4, 14.4, 14.58, 14.93, 14.4, 14.4, 14.23, 14.4, 14.23, 14.23, 13.71, 14.58]
[rank0]:2025-12-30 20:38:34,736 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2038_rank0_stage0.svg
[rank0]:	> Counts Sum: 155120, Total Sum: 852480 (18.20%), Ratio(%) per element: [20.65, 21.35, 20.13, 21.0, 20.31, 21.0, 19.96, 20.48, 19.44, 19.61, 19.44, 19.79, 19.09, 19.61, 19.61, 18.92, 19.79, 18.75, 18.75, 19.61, 17.18, 16.84, 17.7, 17.01, 16.84, 16.31, 17.01, 16.49, 15.97, 16.49, 16.31, 15.79, 15.1, 15.62, 14.75, 15.45, 14.93]
[rank2]:2025-12-30 20:38:34,732 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2038_rank2_stage2.svg
[rank2]:	> Counts Sum: 119520, Total Sum: 829440 (14.41%), Ratio(%) per element: [14.58, 14.23, 14.4, 14.58, 14.23, 14.06, 14.23, 14.23, 14.58, 14.58, 14.58, 14.58, 14.4, 14.06, 14.4, 14.23, 14.58, 14.75, 14.58, 14.23, 14.23, 14.4, 14.23, 14.4, 14.06, 14.4, 14.4, 14.23, 14.23, 14.23, 14.75, 14.06, 14.58, 14.75, 14.75, 14.75]
[rank3]:2025-12-30 20:38:34,812 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/pipeline_schedule/251230_2038_thry_final800_rank3.svg
[rank3]:			> Batch Time: 636.24 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-57ms     | [S0,MB3,F]  57-19-77ms     | [S0,MB0,B]  192-38-231ms   | [S0,MB4,F]  231-19-250ms   | [S0,MB1,B]  250-38-289ms   | [S0,MB5,F]  289-19-308ms   | [S0,MB2,B]  308-38-347ms   | [S0,MB6,F]  347-19-366ms   | [S0,MB3,B]  366-38-404ms   | [S0,MB7,F]  404-19-424ms   | [S0,MB4,B]  424-38-462ms   | [S0,MB5,B]  482-38-520ms   | [S0,MB6,B]  539-38-578ms   | [S0,MB7,B]  597-38-636ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB0,B]  154-38-192ms   | [S1,MB3,F]  192-19-212ms   | [S1,MB1,B]  212-38-250ms   | [S1,MB4,F]  250-19-269ms   | [S1,MB2,B]  269-38-308ms   | [S1,MB5,F]  308-19-327ms   | [S1,MB3,B]  327-38-366ms   | [S1,MB6,F]  366-19-385ms   | [S1,MB4,B]  385-38-424ms   | [S1,MB7,F]  424-19-443ms   | [S1,MB5,B]  443-38-482ms   | [S1,MB6,B]  501-38-539ms   | [S1,MB7,B]  559-38-597ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-57ms     | [S2,MB1,F]  57-19-77ms     | [S2,MB0,B]  115-38-154ms   | [S2,MB2,F]  154-19-173ms   | [S2,MB1,B]  173-38-212ms   | [S2,MB3,F]  212-19-231ms   | [S2,MB2,B]  231-38-269ms   | [S2,MB4,F]  269-19-289ms   | [S2,MB3,B]  289-38-327ms   | [S2,MB5,F]  327-19-347ms   | [S2,MB4,B]  347-38-385ms   | [S2,MB6,F]  385-19-404ms   | [S2,MB5,B]  404-38-443ms   | [S2,MB7,F]  443-19-462ms   | [S2,MB6,B]  462-38-501ms   | [S2,MB7,B]  520-38-559ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  57-19-77ms     | [S3,MB0,B]  77-38-115ms    | [S3,MB1,F]  115-19-134ms   | [S3,MB1,B]  134-38-173ms   | [S3,MB2,F]  173-19-192ms   | [S3,MB2,B]  192-38-231ms   | [S3,MB3,F]  231-19-250ms   | [S3,MB3,B]  250-38-289ms   | [S3,MB4,F]  289-19-308ms   | [S3,MB4,B]  308-38-347ms   | [S3,MB5,F]  347-19-366ms   | [S3,MB5,B]  366-38-404ms   | [S3,MB6,F]  404-19-424ms   | [S3,MB6,B]  424-38-462ms   | [S3,MB7,F]  462-19-482ms   | [S3,MB7,B]  482-38-520ms  
[rank3]:2025-12-30 20:38:34,859 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_ratio_history/rank3/251230_2038_stage3_final800.svg
[rank3]:2025-12-30 20:38:34,989 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/frozen_params_histogram/251230_2038_rank3_stage3.svg
[rank3]:	> Counts Sum: 516080, Total Sum: 668160 (77.24%), Ratio(%) per element: [77.77, 77.43, 78.29, 75.86, 77.77, 76.38, 74.82, 78.47, 76.38, 76.73, 76.73, 76.73, 76.56, 77.95, 76.38, 77.08, 76.9, 77.08, 77.6, 76.56, 78.29, 78.29, 78.47, 77.25, 77.43, 78.99, 76.73, 77.25, 77.6]
[rank0]:2025-12-30 20:38:35,643 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2038_stage0.svg
[rank0]:2025-12-30 20:38:35,645 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-30 20:38:35,655 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2038_stage2.svg
[rank2]:2025-12-30 20:38:35,657 - Destroying the purge thread.
[rank1]:2025-12-30 20:38:35,641 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2038_stage1.svg
[rank1]:2025-12-30 20:38:35,642 - Destroying the purge thread.
[rank2]:2025-12-30 20:38:35,860 - Process group destroyed
[rank3]:2025-12-30 20:38:35,929 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1/afr_time_plot/251230_2038_stage3.svg
[rank1]:2025-12-30 20:38:35,874 - Process group destroyed
[rank3]:2025-12-30 20:38:35,931 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 316-337
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.53104
[rank3]:wandb:               final/avg_loss 0.22823
[rank3]:wandb:             final/avg_mfu(%) 21.36369
[rank3]:wandb:             final/avg_tflops 72.54669
[rank3]:wandb:    final/avg_throughput(tps) 9279.99004
[rank3]:wandb:              final/grad_norm 0.15848
[rank3]:wandb:               final/max_loss 0.22823
[rank3]:wandb:                    grad_norm 0.15848
[rank3]:wandb: loss_metrics/global_avg_loss 0.22823
[rank3]:wandb: loss_metrics/global_max_loss 0.22823
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_1F1B_fullrand7_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/rnw7nkbb
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_1F1B_fullrand7_22_dm1/20251230-1948/wandb/run-20251230_194829-rnw7nkbb/logs
[rank3]:2025-12-30 20:38:37,445 - Process group destroyed
[rank0]:2025-12-30 20:38:37,645 - Training completed
[rank0]:2025-12-30 20:38:37,645 - Destroying the purge thread.
[rank0]:2025-12-30 20:38:37,944 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.2', 'layers.3', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.7', 'layers.6', 'layers.5', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'norm', 'layers.14', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_1F1B_fullrand7_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_1F1B_fullrand7_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_1F1B_fullrand7_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_1F1B_fullrand7_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_1F1B_fullrand7_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_1F1B_fullrand7_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_1F1B_fullrand7_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_1F1B_fullrand7_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
