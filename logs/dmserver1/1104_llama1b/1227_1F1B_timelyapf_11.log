
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 21:52:29 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_1F1B_timelyapf_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-28 21:52:36,351 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank2]:2025-12-28 21:52:36,347 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank3]:2025-12-28 21:52:36,589 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank0]:2025-12-28 21:52:36,639 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank1]:2025-12-28 21:52:36,663 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 21:52:36,665 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-28 21:52:36,659 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 21:52:36,662 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 21:52:36,904 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 21:52:36,906 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 21:52:36,963 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 21:52:36,967 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 21:52:36,972 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 21:52:36,973 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-28 21:52:37,368 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 21:52:40,126 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-28 21:52:40,173 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 21:52:40,299 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 21:52:40,215 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 21:52:40,242 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 21:52:40,243 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-28 21:52:40,339 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 21:52:40,340 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 21:52:40,364 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 21:52:40,365 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-28 21:52:40,452 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 21:52:40,496 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 21:52:40,496 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 21:52:40,496 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 21:52:40,497 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-28 21:52:40,523 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 21:52:40,523 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-28 21:52:40,572 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 21:52:40,572 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 21:52:40,573 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-28 21:52:40,711 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 21:52:40,711 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 21:52:40,711 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 4fxi6ren
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_1F1B_timelyapf_11_dm1/20251228-2152/wandb/run-20251228_215241-4fxi6ren
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_1F1B_timelyapf_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/4fxi6ren
[rank3]:2025-12-28 21:52:42,321 - WandB logging enabled
[rank3]:2025-12-28 21:52:42,321 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 21:52:42,362 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 21:52:42,392 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 21:52:42,392 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-28 21:52:42,596 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 21:52:42,597 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 21:52:42,598 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-28 21:52:42,614 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-28 21:52:42,614 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 21:52:42,614 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_1F1B_timelyapf_11_dm1
[rank0]:2025-12-28 21:52:42,614 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 21:52:42,615 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 21:52:42,615 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-28 21:52:42,617 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 21:52:45,248 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 21:52:45,248 - Finished loading the checkpoint in 2.63 seconds.
[rank0]:2025-12-28 21:52:45,248 - Training starts at step 1
[rank3]:2025-12-28 21:52:50,613 -  step:  1  loss: 10.6092  grad_norm: 203.0669  memory: 21.88GiB(46.05%)  tps: 3,973  tflops: 31.06  mfu: 9.95%
[rank3]:2025-12-28 21:52:50,614 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 21:52:50,604 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 10.58GiB(22.26%)  tps: 3,242  tflops: 25.34  mfu: 8.12%
[rank1]:2025-12-28 21:52:50,605 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 21:52:50,604 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory:  6.84GiB(14.41%)  tps: 3,154  tflops: 24.66  mfu: 7.90%
[rank2]:2025-12-28 21:52:50,604 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 21:52:50,639 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 13.10GiB(27.57%)  tps: 3,182  tflops: 24.87  mfu: 7.97%
[rank0]:2025-12-28 21:52:50,639 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 21:56:43,463 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-28 21:56:48,225 - Avg. fwd time: 19.6969 / Avg. bwd time: 45.5766 / Avg. batch time: 1120.9984 (ms) / GPU bubble ratio: 53.42%
[rank2]:2025-12-28 21:56:48,173 - Avg. fwd time: 14.9265 / Avg. bwd time: 35.2997 / Avg. batch time: 1048.1121 (ms) / GPU bubble ratio: 61.66%
[rank3]:2025-12-28 21:56:48,131 - Avg. fwd time: 24.6509 / Avg. bwd time: 80.9056 / Avg. batch time: 989.8059 (ms) / GPU bubble ratio: 14.69%
[rank1]:2025-12-28 21:56:48,300 -  step: 50  loss: -4.0000  grad_norm: 23.9611  memory: 12.86GiB(27.07%)  tps: 6,755  tflops: 52.81  mfu: 16.93%
[rank2]:2025-12-28 21:56:48,296 -  step: 50  loss: -4.0000  grad_norm: 23.9611  memory:  8.66GiB(18.23%)  tps: 6,755  tflops: 52.81  mfu: 16.93%
[rank3]:2025-12-28 21:56:48,308 -  step: 50  loss:  9.8798  grad_norm: 23.9611  memory: 25.79GiB(54.28%)  tps: 6,755  tflops: 52.81  mfu: 16.93%
[rank0]:2025-12-28 21:56:48,274 - Avg. fwd time: 16.1175 / Avg. bwd time: 41.9240 / Avg. batch time: 1187.0884 (ms) / GPU bubble ratio: 60.88%
[rank0]:2025-12-28 21:56:48,313 -  step: 50  loss: -4.0000  grad_norm: 23.9611  memory: 16.87GiB(35.50%)  tps: 6,756  tflops: 52.81  mfu: 16.93%
[rank3]:2025-12-28 21:57:31,597 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-28 21:58:20,101 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-28 21:58:20,510 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-28 21:58:20,604 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-28 21:58:20,560 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-28 21:59:08,852 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-28 21:59:09,404 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-28 22:00:15,808 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-28 22:00:16,218 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 22:00:16,247 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 22:00:16,247 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 22:00:16,247 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:00:16,395 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2200_max_batch_time.svg
[rank3]:			> Batch Time: 1028.56 ms, GPU Bubble Ratio: 54.61%, 49.09%, 60.67%, 17.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  236-42-279ms   | [S0,MB4,F]  279-15-294ms   | [S0,MB1,B]  341-42-383ms   | [S0,MB5,F]  383-15-399ms   | [S0,MB2,B]  448-42-490ms   | [S0,MB6,F]  490-15-506ms   | [S0,MB3,B]  555-42-597ms   | [S0,MB7,F]  597-15-613ms   | [S0,MB4,B]  663-42-705ms   | [S0,MB5,B]  771-42-813ms   | [S0,MB6,B]  879-42-921ms   | [S0,MB7,B]  986-42-1028ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  190-46-236ms   | [S1,MB3,F]  236-19-256ms   | [S1,MB1,B]  295-45-341ms   | [S1,MB4,F]  341-20-361ms   | [S1,MB2,B]  402-45-448ms   | [S1,MB5,F]  448-20-468ms   | [S1,MB3,B]  509-45-555ms   | [S1,MB6,F]  555-20-575ms   | [S1,MB4,B]  617-45-663ms   | [S1,MB7,F]  663-19-683ms   | [S1,MB5,B]  725-45-771ms   | [S1,MB6,B]  833-45-879ms   | [S1,MB7,B]  940-45-986ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  154-35-190ms   | [S2,MB2,F]  190-14-205ms   | [S2,MB1,B]  260-35-295ms   | [S2,MB3,F]  295-14-310ms   | [S2,MB2,B]  366-35-402ms   | [S2,MB4,F]  402-15-417ms   | [S2,MB3,B]  474-35-509ms   | [S2,MB5,F]  509-14-524ms   | [S2,MB4,B]  581-35-617ms   | [S2,MB6,F]  617-15-632ms   | [S2,MB5,B]  690-35-725ms   | [S2,MB7,F]  725-15-740ms   | [S2,MB6,B]  798-35-833ms   | [S2,MB7,B]  905-35-940ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-78-154ms    AFR(10):0.9655 | [S3,MB1,F]  154-24-178ms   | [S3,MB1,B]  178-81-260ms   AFR(10):0.9655 | [S3,MB2,F]  260-24-285ms   | [S3,MB2,B]  285-81-366ms   AFR(10):0.9655 | [S3,MB3,F]  366-24-391ms   | [S3,MB3,B]  391-82-474ms   AFR(10):0.9655 | [S3,MB4,F]  474-24-499ms   | [S3,MB4,B]  499-82-581ms   AFR(10):0.9655 | [S3,MB5,F]  581-25-607ms   | [S3,MB5,B]  607-83-690ms   AFR(10):0.9655 | [S3,MB6,F]  690-25-715ms   | [S3,MB6,B]  715-82-798ms   AFR(10):0.9655 | [S3,MB7,F]  798-24-822ms   | [S3,MB7,B]  822-82-905ms   AFR(10):0.9655
[rank3]:2025-12-28 22:00:16,528 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2200_min_batch_time.svg
[rank3]:			> Batch Time: 640.96 ms, GPU Bubble Ratio: 79.88%, 46.89%, 59.08%, 14.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  158-0-158ms    | [S0,MB4,F]  158-15-174ms   | [S0,MB1,B]  226-0-226ms    | [S0,MB5,F]  226-15-242ms   | [S0,MB2,B]  295-0-295ms    | [S0,MB6,F]  295-15-310ms   | [S0,MB3,B]  363-0-363ms    | [S0,MB7,F]  363-15-379ms   | [S0,MB4,B]  432-0-432ms    | [S0,MB5,B]  502-0-502ms    | [S0,MB6,B]  570-0-570ms    | [S0,MB7,B]  640-0-640ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  135-22-158ms   | [S1,MB3,F]  158-19-178ms   | [S1,MB1,B]  203-23-226ms   | [S1,MB4,F]  226-20-246ms   | [S1,MB2,B]  272-23-295ms   | [S1,MB5,F]  295-20-315ms   | [S1,MB3,B]  340-22-363ms   | [S1,MB6,F]  363-20-383ms   | [S1,MB4,B]  409-22-432ms   | [S1,MB7,F]  432-19-452ms   | [S1,MB5,B]  478-23-502ms   | [S1,MB6,B]  548-22-570ms   | [S1,MB7,B]  618-22-640ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  118-17-135ms   | [S2,MB2,F]  135-14-150ms   | [S2,MB1,B]  185-17-203ms   | [S2,MB3,F]  203-14-218ms   | [S2,MB2,B]  254-17-272ms   | [S2,MB4,F]  272-15-287ms   | [S2,MB3,B]  323-17-340ms   | [S2,MB5,F]  340-14-355ms   | [S2,MB4,B]  391-17-409ms   | [S2,MB6,F]  409-15-424ms   | [S2,MB5,B]  461-17-478ms   | [S2,MB7,F]  478-15-494ms   | [S2,MB6,B]  530-17-548ms   | [S2,MB7,B]  600-17-618ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-41-118ms    AFR(10):0.9655 | [S3,MB1,F]  118-24-142ms   | [S3,MB1,B]  142-43-185ms   AFR(10):0.9655 | [S3,MB2,F]  185-24-210ms   | [S3,MB2,B]  210-44-254ms   AFR(10):0.9655 | [S3,MB3,F]  254-24-279ms   | [S3,MB3,B]  279-43-323ms   AFR(10):0.9655 | [S3,MB4,F]  323-24-347ms   | [S3,MB4,B]  347-43-391ms   AFR(10):0.9655 | [S3,MB5,F]  391-25-417ms   | [S3,MB5,B]  417-44-461ms   AFR(10):0.9655 | [S3,MB6,F]  461-25-486ms   | [S3,MB6,B]  486-43-530ms   AFR(10):0.9655 | [S3,MB7,F]  530-24-554ms   | [S3,MB7,B]  554-45-600ms   AFR(10):0.9655
[rank3]:2025-12-28 22:00:16,669 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2200_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 699.74 ms, GPU Bubble Ratio: 39.29%, 28.43%, 44.71%, 13.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-17-66ms     | [S0,MB0,B]  236-42-279ms   | [S0,MB4,F]  279-15-294ms   | [S0,MB1,B]  303-42-345ms   | [S0,MB5,F]  345-15-361ms   | [S0,MB2,B]  372-42-414ms   | [S0,MB6,F]  414-15-430ms   | [S0,MB3,B]  440-42-483ms   | [S0,MB7,F]  483-15-498ms   | [S0,MB4,B]  509-42-551ms   | [S0,MB5,B]  579-42-621ms   | [S0,MB6,B]  647-42-689ms   | [S0,MB7,B]  699-0-699ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-37ms     | [S1,MB1,F]  37-18-55ms     | [S1,MB2,F]  55-18-73ms     | [S1,MB0,B]  190-46-236ms   | [S1,MB3,F]  236-19-256ms   | [S1,MB1,B]  257-45-303ms   | [S1,MB4,F]  303-20-323ms   | [S1,MB2,B]  326-45-372ms   | [S1,MB5,F]  372-20-392ms   | [S1,MB3,B]  395-45-440ms   | [S1,MB6,F]  440-20-461ms   | [S1,MB4,B]  463-45-509ms   | [S1,MB7,F]  509-19-529ms   | [S1,MB5,B]  533-45-579ms   | [S1,MB6,B]  602-45-647ms   | [S1,MB7,B]  677-22-699ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-15-52ms     | [S2,MB1,F]  55-14-69ms     | [S2,MB0,B]  154-35-190ms   | [S2,MB2,F]  190-14-205ms   | [S2,MB1,B]  221-35-257ms   | [S2,MB3,F]  257-14-272ms   | [S2,MB2,B]  290-35-326ms   | [S2,MB4,F]  326-15-341ms   | [S2,MB3,B]  359-35-395ms   | [S2,MB5,F]  395-14-409ms   | [S2,MB4,B]  428-35-463ms   | [S2,MB6,F]  463-15-478ms   | [S2,MB5,B]  497-35-533ms   | [S2,MB7,F]  533-15-548ms   | [S2,MB6,B]  566-35-602ms   | [S2,MB7,B]  659-17-677ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  76-78-154ms    AFR(10):0.9655 | [S3,MB1,F]  154-24-178ms   | [S3,MB1,B]  178-43-221ms   AFR(10):0.9655 | [S3,MB2,F]  221-24-246ms   | [S3,MB2,B]  246-44-290ms   AFR(10):0.9655 | [S3,MB3,F]  290-24-315ms   | [S3,MB3,B]  315-43-359ms   AFR(10):0.9655 | [S3,MB4,F]  359-24-384ms   | [S3,MB4,B]  384-43-428ms   AFR(10):0.9655 | [S3,MB5,F]  428-25-453ms   | [S3,MB5,B]  453-44-497ms   AFR(10):0.9655 | [S3,MB6,F]  497-25-522ms   | [S3,MB6,B]  522-43-566ms   AFR(10):0.9655 | [S3,MB7,F]  566-24-591ms   | [S3,MB7,B]  591-67-659ms   AFR(10):0.9655
[rank3]:2025-12-28 22:00:16,669 - 	> Batch Time: 699.74 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.32)
[rank3]:2025-12-28 22:00:16,688 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.40/0.40
[rank2]:2025-12-28 22:00:20,068 - Avg. fwd time: 14.8119 / Avg. bwd time: 31.8387 / Avg. batch time: 986.6169 (ms) / GPU bubble ratio: 62.17%
[rank0]:2025-12-28 22:00:20,103 - Avg. fwd time: 15.9602 / Avg. bwd time: 33.5169 / Avg. batch time: 1111.1824 (ms) / GPU bubble ratio: 64.38%
[rank1]:2025-12-28 22:00:20,097 - Avg. fwd time: 19.4998 / Avg. bwd time: 41.1063 / Avg. batch time: 1054.3535 (ms) / GPU bubble ratio: 54.01%
[rank3]:2025-12-28 22:00:20,043 - Avg. fwd time: 24.7834 / Avg. bwd time: 73.4876 / Avg. batch time: 931.4423 (ms) / GPU bubble ratio: 15.60%
[rank2]:2025-12-28 22:00:20,125 -  step: 100  loss: -4.0000  grad_norm:  7.3754  memory:  9.58GiB(20.16%)  tps: 7,735  tflops: 60.47  mfu: 19.38%
[rank2]:2025-12-28 22:00:20,198 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2200_stage2_step100.svg
[rank0]:2025-12-28 22:00:20,139 -  step: 100  loss: -4.0000  grad_norm:  7.3754  memory: 18.74GiB(39.45%)  tps: 7,735  tflops: 60.47  mfu: 19.38%
[rank0]:2025-12-28 22:00:20,200 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2200_stage0_step100.svg
[rank1]:2025-12-28 22:00:20,129 -  step: 100  loss: -4.0000  grad_norm:  7.3754  memory: 14.00GiB(29.46%)  tps: 7,735  tflops: 60.47  mfu: 19.38%
[rank1]:2025-12-28 22:00:20,198 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2200_stage1_step100.svg
[rank3]:2025-12-28 22:00:20,138 -  step: 100  loss:  8.9345  grad_norm:  7.3754  memory: 28.48GiB(59.95%)  tps: 7,735  tflops: 60.47  mfu: 19.38%
[rank3]:2025-12-28 22:00:20,278 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2200_step100_rank3.svg
[rank3]:			> Batch Time: 823.00 ms, GPU Bubble Ratio: 85.12%, 59.54%, 68.73%, 31.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-15-64ms     | [S0,MB0,B]  198-0-198ms    | [S0,MB4,F]  198-14-213ms   | [S0,MB1,B]  284-0-284ms    | [S0,MB5,F]  284-14-298ms   | [S0,MB2,B]  371-0-371ms    | [S0,MB6,F]  371-14-386ms   | [S0,MB3,B]  460-0-460ms    | [S0,MB7,F]  460-14-475ms   | [S0,MB4,B]  550-0-550ms    | [S0,MB5,B]  637-0-637ms    | [S0,MB6,B]  720-0-720ms    | [S0,MB7,B]  823-0-823ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  42-18-61ms     | [S1,MB2,F]  67-18-85ms     | [S1,MB0,B]  167-22-190ms   | [S1,MB3,F]  195-18-213ms   | [S1,MB1,B]  253-23-276ms   | [S1,MB4,F]  281-18-299ms   | [S1,MB2,B]  341-23-364ms   | [S1,MB5,F]  368-18-387ms   | [S1,MB3,B]  430-22-453ms   | [S1,MB6,F]  457-18-476ms   | [S1,MB4,B]  519-22-542ms   | [S1,MB7,F]  546-18-565ms   | [S1,MB5,B]  607-23-630ms   | [S1,MB6,B]  691-22-714ms   | [S1,MB7,B]  793-22-816ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  139-17-157ms   | [S2,MB2,F]  164-14-178ms   | [S2,MB1,B]  225-17-243ms   | [S2,MB3,F]  250-14-264ms   | [S2,MB2,B]  313-17-331ms   | [S2,MB4,F]  338-14-352ms   | [S2,MB3,B]  402-17-420ms   | [S2,MB5,F]  427-14-441ms   | [S2,MB4,B]  490-17-508ms   | [S2,MB6,F]  515-14-530ms   | [S2,MB5,B]  579-17-596ms   | [S2,MB7,F]  604-14-618ms   | [S2,MB6,B]  667-17-684ms   | [S2,MB7,B]  769-17-786ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-41-129ms    | [S3,MB1,F]  136-23-160ms   | [S3,MB1,B]  171-43-214ms   | [S3,MB2,F]  222-25-247ms   | [S3,MB2,B]  259-44-303ms   | [S3,MB3,F]  310-25-336ms   | [S3,MB3,B]  348-43-392ms   | [S3,MB4,F]  399-25-425ms   | [S3,MB4,B]  436-43-480ms   | [S3,MB5,F]  487-25-513ms   | [S3,MB5,B]  525-43-569ms   | [S3,MB6,F]  576-25-601ms   | [S3,MB6,B]  613-43-657ms   | [S3,MB7,F]  664-25-689ms   | [S3,MB7,B]  700-62-762ms  
[rank2]:2025-12-28 22:00:20,352 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2200_rank2_stage2.svg
[rank2]:	> Counts Sum: 23040, Total Sum: 23040 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2025-12-28 22:00:20,391 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2200_stage2.svg
[rank0]:2025-12-28 22:00:20,358 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2200_rank0_stage0.svg
[rank0]:	> Counts Sum: 23680, Total Sum: 23680 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2025-12-28 22:00:20,395 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2200_stage0.svg
[rank1]:2025-12-28 22:00:20,351 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2200_rank1_stage1.svg
[rank1]:	> Counts Sum: 28800, Total Sum: 28800 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2025-12-28 22:00:20,390 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2200_stage1.svg
[rank3]:2025-12-28 22:00:20,320 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2200_stage3_step100.svg
[rank3]:2025-12-28 22:00:20,452 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2200_rank3_stage3.svg
[rank3]:	> Counts Sum: 17920, Total Sum: 18560 (96.55%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 75.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 68.75, 93.75, 87.5, 93.75]
[rank3]:2025-12-28 22:00:20,491 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2200_stage3.svg
[rank0]:2025-12-28 22:03:49,032 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 22:03:49,081 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-12-28 22:03:49,059 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-12-28 22:03:49,076 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.27/0.40
[rank2]:2025-12-28 22:03:49,053 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-12-28 22:03:53,238 - Avg. fwd time: 24.9591 / Avg. bwd time: 71.6340 / Avg. batch time: 918.0898 (ms) / GPU bubble ratio: 15.83%
[rank2]:2025-12-28 22:03:53,267 - Avg. fwd time: 14.8913 / Avg. bwd time: 32.5668 / Avg. batch time: 969.9838 (ms) / GPU bubble ratio: 60.86%
[rank0]:2025-12-28 22:03:53,330 - Avg. fwd time: 16.0406 / Avg. bwd time: 35.4680 / Avg. batch time: 1086.5805 (ms) / GPU bubble ratio: 62.08%
[rank0]:2025-12-28 22:03:53,366 -  step: 150  loss: -4.0000  grad_norm: 20.8723  memory: 18.76GiB(39.49%)  tps: 7,684  tflops: 60.07  mfu: 19.25%
[rank1]:2025-12-28 22:03:53,301 - Avg. fwd time: 19.6977 / Avg. bwd time: 42.2544 / Avg. batch time: 1033.9288 (ms) / GPU bubble ratio: 52.06%
[rank1]:2025-12-28 22:03:53,355 -  step: 150  loss: -4.0000  grad_norm: 20.8723  memory: 14.00GiB(29.46%)  tps: 7,684  tflops: 60.07  mfu: 19.25%
[rank3]:2025-12-28 22:03:53,364 -  step: 150  loss:  4.4468  grad_norm: 20.8723  memory: 28.73GiB(60.48%)  tps: 7,684  tflops: 60.07  mfu: 19.25%
[rank2]:2025-12-28 22:03:53,352 -  step: 150  loss: -4.0000  grad_norm: 20.8723  memory:  9.58GiB(20.16%)  tps: 7,684  tflops: 60.07  mfu: 19.25%
[rank1]:2025-12-28 22:07:11,489 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:07:11,506 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.40/0.40
[rank0]:2025-12-28 22:07:11,453 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 22:07:11,513 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-12-28 22:07:11,481 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 22:07:15,116 - Avg. fwd time: 19.8086 / Avg. bwd time: 42.7394 / Avg. batch time: 1010.1183 (ms) / GPU bubble ratio: 50.46%
[rank1]:2025-12-28 22:07:15,148 -  step: 200  loss: -4.0000  grad_norm:  4.9544  memory: 14.00GiB(29.46%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank0]:2025-12-28 22:07:15,122 - Avg. fwd time: 16.0922 / Avg. bwd time: 36.4284 / Avg. batch time: 1060.2087 (ms) / GPU bubble ratio: 60.37%
[rank3]:2025-12-28 22:07:15,060 - Avg. fwd time: 25.0457 / Avg. bwd time: 69.3007 / Avg. batch time: 900.1702 (ms) / GPU bubble ratio: 16.15%
[rank2]:2025-12-28 22:07:15,085 - Avg. fwd time: 14.9297 / Avg. bwd time: 32.8477 / Avg. batch time: 949.3425 (ms) / GPU bubble ratio: 59.74%
[rank2]:2025-12-28 22:07:15,144 -  step: 200  loss: -4.0000  grad_norm:  4.9544  memory:  9.58GiB(20.16%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank1]:2025-12-28 22:07:15,209 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2207_stage1_step200.svg
[rank0]:2025-12-28 22:07:15,158 -  step: 200  loss: -4.0000  grad_norm:  4.9544  memory: 18.76GiB(39.49%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank0]:2025-12-28 22:07:15,209 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2207_stage0_step200.svg
[rank3]:2025-12-28 22:07:15,156 -  step: 200  loss:  1.4984  grad_norm:  4.9544  memory: 28.79GiB(60.61%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank2]:2025-12-28 22:07:15,208 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2207_stage2_step200.svg
[rank3]:2025-12-28 22:07:15,299 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2207_step200_rank3.svg
[rank3]:			> Batch Time: 932.33 ms, GPU Bubble Ratio: 52.01%, 44.03%, 57.91%, 29.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  275-42-318ms   | [S0,MB4,F]  318-15-334ms   | [S0,MB1,B]  366-42-409ms   | [S0,MB5,F]  409-16-425ms   | [S0,MB2,B]  456-42-499ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  561-42-603ms   | [S0,MB7,F]  604-16-620ms   | [S0,MB4,B]  653-42-695ms   | [S0,MB5,B]  756-42-798ms   | [S0,MB6,B]  840-42-882ms   | [S0,MB7,B]  913-18-932ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  221-46-268ms   | [S1,MB3,F]  272-19-292ms   | [S1,MB1,B]  310-48-359ms   | [S1,MB4,F]  363-21-385ms   | [S1,MB2,B]  398-49-448ms   | [S1,MB5,F]  453-22-475ms   | [S1,MB3,B]  506-47-553ms   | [S1,MB6,F]  558-21-579ms   | [S1,MB4,B]  594-49-644ms   | [S1,MB7,F]  649-21-671ms   | [S1,MB5,B]  702-47-749ms   | [S1,MB6,B]  787-46-834ms   | [S1,MB7,B]  883-23-907ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  175-36-211ms   | [S2,MB2,F]  218-14-233ms   | [S2,MB1,B]  263-36-300ms   | [S2,MB3,F]  307-15-322ms   | [S2,MB2,B]  351-36-388ms   | [S2,MB4,F]  395-15-410ms   | [S2,MB3,B]  459-36-495ms   | [S2,MB5,F]  503-15-518ms   | [S2,MB4,B]  548-36-584ms   | [S2,MB6,F]  591-15-607ms   | [S2,MB5,B]  655-35-691ms   | [S2,MB7,F]  698-15-714ms   | [S2,MB6,B]  744-36-781ms   | [S2,MB7,B]  859-18-877ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-76-165ms    | [S3,MB1,F]  172-24-196ms   | [S3,MB1,B]  208-44-252ms   | [S3,MB2,F]  261-25-286ms   | [S3,MB2,B]  297-43-341ms   | [S3,MB3,F]  348-26-374ms   | [S3,MB3,B]  386-63-449ms   | [S3,MB4,F]  457-26-483ms   | [S3,MB4,B]  493-44-538ms   | [S3,MB5,F]  545-25-571ms   | [S3,MB5,B]  582-63-646ms   | [S3,MB6,F]  653-25-678ms   | [S3,MB6,B]  691-44-735ms   | [S3,MB7,F]  742-25-767ms   | [S3,MB7,B]  779-73-852ms  
[rank3]:2025-12-28 22:07:15,342 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2207_stage3_step200.svg
[rank2]:2025-12-28 22:07:15,359 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2207_rank2_stage2.svg
[rank2]:	> Counts Sum: 33120, Total Sum: 138240 (23.96%), Ratio(%) per element: [27.08, 25.0, 23.95, 23.95, 26.04, 25.0, 26.04, 20.83, 20.83, 25.0, 25.0, 25.0, 26.04, 26.04, 22.91, 26.04, 18.75, 19.79, 23.95, 23.95, 25.0, 26.04, 26.04, 25.0, 26.04, 18.75, 20.83, 23.95, 23.95, 25.0, 26.04, 25.0, 25.0, 25.0, 20.83, 18.75]
[rank1]:2025-12-28 22:07:15,356 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2207_rank1_stage1.svg
[rank1]:	> Counts Sum: 41400, Total Sum: 172800 (23.96%), Ratio(%) per element: [25.0, 26.04, 25.0, 23.95, 26.04, 26.04, 25.0, 18.75, 19.79, 22.91, 26.04, 26.04, 26.04, 25.0, 25.0, 21.87, 17.7, 18.75, 25.0, 27.08, 26.04, 25.0, 27.08, 26.04, 25.0, 20.83, 18.75, 25.0, 23.95, 26.04, 22.91, 26.04, 25.0, 25.0, 21.87, 22.91, 25.0, 22.91, 26.04, 26.04, 27.08, 23.95, 25.0, 19.79, 17.7]
[rank0]:2025-12-28 22:07:15,363 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2207_rank0_stage0.svg
[rank0]:	> Counts Sum: 34080, Total Sum: 142080 (23.99%), Ratio(%) per element: [27.08, 25.0, 25.0, 25.0, 25.0, 26.04, 22.91, 26.04, 18.75, 18.75, 25.0, 27.08, 26.04, 26.04, 26.04, 23.95, 27.08, 18.75, 19.79, 25.0, 26.04, 23.95, 23.95, 26.04, 25.0, 25.0, 18.75, 19.79, 23.95, 26.04, 25.0, 26.04, 25.0, 25.0, 23.95, 19.79, 19.79]
[rank1]:2025-12-28 22:07:15,521 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2207_stage1.svg
[rank0]:2025-12-28 22:07:15,530 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2207_stage0.svg
[rank3]:2025-12-28 22:07:15,471 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2207_rank3_stage3.svg
[rank3]:	> Counts Sum: 69680, Total Sum: 111360 (62.57%), Ratio(%) per element: [76.04, 73.95, 77.08, 73.95, 73.95, 68.75, 76.04, 34.37, 41.66, 78.12, 77.08, 75.0, 71.87, 79.16, 71.87, 76.04, 30.2, 32.29, 80.2, 70.83, 73.95, 67.7, 67.7, 66.66, 73.95, 32.29, 32.29, 29.16, 32.29]
[rank2]:2025-12-28 22:07:15,524 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2207_stage2.svg
[rank3]:2025-12-28 22:07:15,631 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2207_stage3.svg
[rank0]:2025-12-28 22:10:11,698 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 22:10:11,747 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:10:11,740 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.40/0.40
[rank2]:2025-12-28 22:10:11,717 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 22:10:11,728 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:10:15,258 - Avg. fwd time: 25.0732 / Avg. bwd time: 65.7089 / Avg. batch time: 871.7404 (ms) / GPU bubble ratio: 16.69%
[rank2]:2025-12-28 22:10:15,284 - Avg. fwd time: 14.9943 / Avg. bwd time: 33.0851 / Avg. batch time: 919.1672 (ms) / GPU bubble ratio: 58.15%
[rank0]:2025-12-28 22:10:15,322 - Avg. fwd time: 16.1362 / Avg. bwd time: 36.5734 / Avg. batch time: 1022.5017 (ms) / GPU bubble ratio: 58.76%
[rank0]:2025-12-28 22:10:15,358 -  step: 250  loss: -4.0000  grad_norm:  2.6792  memory: 18.76GiB(39.49%)  tps: 9,092  tflops: 71.08  mfu: 22.78%
[rank3]:2025-12-28 22:10:15,356 -  step: 250  loss:  0.5023  grad_norm:  2.6792  memory: 28.79GiB(60.61%)  tps: 9,092  tflops: 71.08  mfu: 22.78%
[rank2]:2025-12-28 22:10:15,344 -  step: 250  loss: -4.0000  grad_norm:  2.6792  memory:  9.58GiB(20.16%)  tps: 9,092  tflops: 71.08  mfu: 22.78%
[rank1]:2025-12-28 22:10:15,315 - Avg. fwd time: 19.9952 / Avg. bwd time: 43.4840 / Avg. batch time: 977.7712 (ms) / GPU bubble ratio: 48.06%
[rank1]:2025-12-28 22:10:15,348 -  step: 250  loss: -4.0000  grad_norm:  2.6792  memory: 14.00GiB(29.46%)  tps: 9,092  tflops: 71.08  mfu: 22.78%
[rank0]:2025-12-28 22:13:11,807 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 22:13:11,865 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:13:11,859 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.40/0.40
[rank2]:2025-12-28 22:13:11,836 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-12-28 22:13:11,847 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-12-28 22:13:15,356 - Avg. fwd time: 25.1019 / Avg. bwd time: 63.3235 / Avg. batch time: 852.9497 (ms) / GPU bubble ratio: 17.06%
[rank0]:2025-12-28 22:13:15,421 - Avg. fwd time: 16.1647 / Avg. bwd time: 36.6673 / Avg. batch time: 997.5149 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-12-28 22:13:15,382 - Avg. fwd time: 15.0330 / Avg. bwd time: 33.2540 / Avg. batch time: 899.1902 (ms) / GPU bubble ratio: 57.04%
[rank1]:2025-12-28 22:13:15,413 - Avg. fwd time: 20.0905 / Avg. bwd time: 43.9581 / Avg. batch time: 956.3614 (ms) / GPU bubble ratio: 46.42%
[rank3]:2025-12-28 22:13:15,455 -  step: 300  loss:  0.3064  grad_norm:  1.5976  memory: 28.79GiB(60.61%)  tps: 9,097  tflops: 71.12  mfu: 22.79%
[rank0]:2025-12-28 22:13:15,457 -  step: 300  loss: -4.0000  grad_norm:  1.5976  memory: 18.76GiB(39.49%)  tps: 9,097  tflops: 71.12  mfu: 22.79%
[rank0]:2025-12-28 22:13:15,505 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2213_stage0_step300.svg
[rank2]:2025-12-28 22:13:15,443 -  step: 300  loss: -4.0000  grad_norm:  1.5976  memory:  9.58GiB(20.16%)  tps: 9,097  tflops: 71.12  mfu: 22.79%
[rank2]:2025-12-28 22:13:15,504 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2213_stage2_step300.svg
[rank1]:2025-12-28 22:13:15,446 -  step: 300  loss: -4.0000  grad_norm:  1.5976  memory: 14.02GiB(29.50%)  tps: 9,097  tflops: 71.12  mfu: 22.79%
[rank1]:2025-12-28 22:13:15,505 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2213_stage1_step300.svg
[rank3]:2025-12-28 22:13:15,603 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2213_step300_rank3.svg
[rank3]:			> Batch Time: 872.50 ms, GPU Bubble Ratio: 50.89%, 38.54%, 54.64%, 29.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  273-42-316ms   | [S0,MB4,F]  316-15-332ms   | [S0,MB1,B]  363-42-406ms   | [S0,MB5,F]  406-16-422ms   | [S0,MB2,B]  452-42-495ms   | [S0,MB6,F]  495-16-511ms   | [S0,MB3,B]  543-42-585ms   | [S0,MB7,F]  585-16-602ms   | [S0,MB4,B]  632-42-674ms   | [S0,MB5,B]  720-42-762ms   | [S0,MB6,B]  799-42-841ms   | [S0,MB7,B]  872-0-872ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  219-46-265ms   | [S1,MB3,F]  270-19-289ms   | [S1,MB1,B]  306-48-355ms   | [S1,MB4,F]  360-21-381ms   | [S1,MB2,B]  394-50-444ms   | [S1,MB5,F]  449-22-471ms   | [S1,MB3,B]  483-51-534ms   | [S1,MB6,F]  539-22-562ms   | [S1,MB4,B]  571-52-623ms   | [S1,MB7,F]  628-22-651ms   | [S1,MB5,B]  660-52-713ms   | [S1,MB6,B]  745-47-793ms   | [S1,MB7,B]  842-23-866ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  172-36-209ms   | [S2,MB2,F]  216-14-230ms   | [S2,MB1,B]  260-36-296ms   | [S2,MB3,F]  304-15-319ms   | [S2,MB2,B]  347-36-384ms   | [S2,MB4,F]  391-15-406ms   | [S2,MB3,B]  436-36-472ms   | [S2,MB5,F]  480-15-495ms   | [S2,MB4,B]  524-36-561ms   | [S2,MB6,F]  568-15-583ms   | [S2,MB5,B]  613-36-650ms   | [S2,MB7,F]  657-15-673ms   | [S2,MB6,B]  702-36-739ms   | [S2,MB7,B]  817-18-836ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  87-74-162ms    | [S3,MB1,F]  169-23-193ms   | [S3,MB1,B]  205-43-249ms   | [S3,MB2,F]  257-25-282ms   | [S3,MB2,B]  293-43-337ms   | [S3,MB3,F]  344-25-370ms   | [S3,MB3,B]  382-43-426ms   | [S3,MB4,F]  433-25-459ms   | [S3,MB4,B]  470-44-514ms   | [S3,MB5,F]  521-25-547ms   | [S3,MB5,B]  559-43-603ms   | [S3,MB6,F]  610-25-636ms   | [S3,MB6,B]  648-43-692ms   | [S3,MB7,F]  699-25-725ms   | [S3,MB7,B]  737-74-811ms  
[rank3]:2025-12-28 22:13:15,646 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2213_stage3_step300.svg
[rank0]:2025-12-28 22:13:15,660 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2213_rank0_stage0.svg
[rank0]:	> Counts Sum: 48880, Total Sum: 260480 (18.77%), Ratio(%) per element: [20.45, 19.31, 19.31, 19.31, 19.31, 19.88, 18.18, 19.88, 15.9, 15.9, 19.31, 20.45, 19.88, 19.88, 19.88, 18.75, 20.45, 15.9, 16.47, 19.31, 19.88, 18.75, 18.75, 19.88, 19.31, 19.31, 15.9, 16.47, 18.75, 19.88, 19.31, 19.88, 19.31, 19.31, 18.75, 16.47, 16.47]
[rank2]:2025-12-28 22:13:15,653 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2213_rank2_stage2.svg
[rank2]:	> Counts Sum: 47520, Total Sum: 253440 (18.75%), Ratio(%) per element: [20.45, 19.31, 18.75, 18.75, 19.88, 19.31, 19.88, 17.04, 17.04, 19.31, 19.31, 19.31, 19.88, 19.88, 18.18, 19.88, 15.9, 16.47, 18.75, 18.75, 19.31, 19.88, 19.88, 19.31, 19.88, 15.9, 17.04, 18.75, 18.75, 19.31, 19.88, 19.31, 19.31, 19.31, 17.04, 15.9]
[rank1]:2025-12-28 22:13:15,652 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2213_rank1_stage1.svg
[rank1]:	> Counts Sum: 59400, Total Sum: 316800 (18.75%), Ratio(%) per element: [19.31, 19.88, 19.31, 18.75, 19.88, 19.88, 19.31, 15.9, 16.47, 18.18, 19.88, 19.88, 19.88, 19.31, 19.31, 17.61, 15.34, 15.9, 19.31, 20.45, 19.88, 19.31, 20.45, 19.88, 19.31, 17.04, 15.9, 19.31, 18.75, 19.88, 18.18, 19.88, 19.31, 19.31, 17.61, 18.18, 19.31, 18.18, 19.88, 19.88, 20.45, 18.75, 19.31, 16.47, 15.34]
[rank3]:2025-12-28 22:13:15,782 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2213_rank3_stage3.svg
[rank3]:	> Counts Sum: 144080, Total Sum: 204160 (70.57%), Ratio(%) per element: [80.68, 78.97, 78.97, 77.27, 78.4, 75.56, 78.97, 52.84, 56.81, 78.4, 80.68, 77.27, 76.7, 80.68, 76.13, 78.97, 50.56, 51.7, 80.11, 76.7, 77.84, 74.43, 72.15, 72.15, 78.4, 51.7, 51.7, 50.0, 51.7]
[rank0]:2025-12-28 22:13:15,955 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2213_stage0.svg
[rank2]:2025-12-28 22:13:15,939 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2213_stage2.svg
[rank1]:2025-12-28 22:13:15,940 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2213_stage1.svg
[rank3]:2025-12-28 22:13:16,072 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2213_stage3.svg
[rank0]:2025-12-28 22:16:11,724 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-28 22:16:15,352 - Avg. fwd time: 20.1645 / Avg. bwd time: 44.3142 / Avg. batch time: 940.6696 (ms) / GPU bubble ratio: 45.16%
[rank0]:2025-12-28 22:16:15,359 - Avg. fwd time: 16.1846 / Avg. bwd time: 36.7349 / Avg. batch time: 979.2698 (ms) / GPU bubble ratio: 56.77%
[rank3]:2025-12-28 22:16:15,293 - Avg. fwd time: 25.1258 / Avg. bwd time: 61.5549 / Avg. batch time: 839.0383 (ms) / GPU bubble ratio: 17.35%
[rank2]:2025-12-28 22:16:15,320 - Avg. fwd time: 15.0622 / Avg. bwd time: 33.3840 / Avg. batch time: 884.5009 (ms) / GPU bubble ratio: 56.18%
[rank1]:2025-12-28 22:16:15,384 -  step: 350  loss: -4.0000  grad_norm:  0.5296  memory: 14.02GiB(29.50%)  tps: 9,105  tflops: 71.18  mfu: 22.81%
[rank0]:2025-12-28 22:16:15,395 -  step: 350  loss: -4.0000  grad_norm:  0.5296  memory: 18.76GiB(39.49%)  tps: 9,105  tflops: 71.18  mfu: 22.81%
[rank3]:2025-12-28 22:16:15,393 -  step: 350  loss:  0.2393  grad_norm:  0.5296  memory: 28.79GiB(60.61%)  tps: 9,105  tflops: 71.18  mfu: 22.81%
[rank2]:2025-12-28 22:16:15,381 -  step: 350  loss: -4.0000  grad_norm:  0.5296  memory:  9.60GiB(20.20%)  tps: 9,105  tflops: 71.18  mfu: 22.81%
[rank0]:2025-12-28 22:19:10,940 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 22:19:14,554 - Avg. fwd time: 25.1392 / Avg. bwd time: 60.2203 / Avg. batch time: 828.5019 (ms) / GPU bubble ratio: 17.58%
[rank2]:2025-12-28 22:19:14,580 - Avg. fwd time: 15.0850 / Avg. bwd time: 33.4796 / Avg. batch time: 873.3350 (ms) / GPU bubble ratio: 55.51%
[rank1]:2025-12-28 22:19:14,612 - Avg. fwd time: 20.2217 / Avg. bwd time: 44.5825 / Avg. batch time: 928.7552 (ms) / GPU bubble ratio: 44.18%
[rank1]:2025-12-28 22:19:14,645 -  step: 400  loss: -4.0000  grad_norm:  0.8333  memory: 14.02GiB(29.50%)  tps: 9,140  tflops: 71.45  mfu: 22.90%
[rank0]:2025-12-28 22:19:14,620 - Avg. fwd time: 16.2044 / Avg. bwd time: 36.7845 / Avg. batch time: 965.4422 (ms) / GPU bubble ratio: 56.09%
[rank0]:2025-12-28 22:19:14,656 -  step: 400  loss: -4.0000  grad_norm:  0.8333  memory: 18.76GiB(39.49%)  tps: 9,140  tflops: 71.45  mfu: 22.90%
[rank3]:2025-12-28 22:19:14,655 -  step: 400  loss:  0.2214  grad_norm:  0.8333  memory: 28.85GiB(60.73%)  tps: 9,140  tflops: 71.45  mfu: 22.90%
[rank2]:2025-12-28 22:19:14,642 -  step: 400  loss: -4.0000  grad_norm:  0.8333  memory:  9.60GiB(20.20%)  tps: 9,140  tflops: 71.45  mfu: 22.90%
[rank2]:2025-12-28 22:19:14,710 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2219_stage2_step400.svg
[rank1]:2025-12-28 22:19:14,710 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2219_stage1_step400.svg
[rank0]:2025-12-28 22:19:14,707 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2219_stage0_step400.svg
[rank3]:2025-12-28 22:19:14,795 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2219_step400_rank3.svg
[rank3]:			> Batch Time: 871.50 ms, GPU Bubble Ratio: 50.75%, 38.24%, 54.61%, 29.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  365-42-407ms   | [S0,MB5,F]  407-16-424ms   | [S0,MB2,B]  454-42-496ms   | [S0,MB6,F]  497-16-513ms   | [S0,MB3,B]  544-42-587ms   | [S0,MB7,F]  587-16-603ms   | [S0,MB4,B]  633-42-676ms   | [S0,MB5,B]  720-42-762ms   | [S0,MB6,B]  800-42-842ms   | [S0,MB7,B]  871-0-871ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-46-266ms   | [S1,MB3,F]  271-19-290ms   | [S1,MB1,B]  308-48-357ms   | [S1,MB4,F]  361-21-383ms   | [S1,MB2,B]  396-50-446ms   | [S1,MB5,F]  450-22-472ms   | [S1,MB3,B]  485-51-536ms   | [S1,MB6,F]  541-22-563ms   | [S1,MB4,B]  572-52-624ms   | [S1,MB7,F]  630-22-652ms   | [S1,MB5,B]  661-52-714ms   | [S1,MB6,B]  746-47-793ms   | [S1,MB7,B]  840-23-864ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  217-14-231ms   | [S2,MB1,B]  261-36-297ms   | [S2,MB3,F]  304-15-320ms   | [S2,MB2,B]  349-36-385ms   | [S2,MB4,F]  392-15-408ms   | [S2,MB3,B]  437-36-474ms   | [S2,MB5,F]  481-15-497ms   | [S2,MB4,B]  525-36-562ms   | [S2,MB6,F]  569-15-584ms   | [S2,MB5,B]  614-36-651ms   | [S2,MB7,F]  658-15-673ms   | [S2,MB6,B]  703-36-739ms   | [S2,MB7,B]  815-18-833ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-43-250ms   | [S3,MB2,F]  258-25-283ms   | [S3,MB2,B]  295-43-339ms   | [S3,MB3,F]  346-26-372ms   | [S3,MB3,B]  383-43-427ms   | [S3,MB4,F]  434-25-460ms   | [S3,MB4,B]  472-43-516ms   | [S3,MB5,F]  522-25-548ms   | [S3,MB5,B]  560-43-604ms   | [S3,MB6,F]  611-25-637ms   | [S3,MB6,B]  648-44-692ms   | [S3,MB7,F]  700-26-726ms   | [S3,MB7,B]  738-71-809ms  
[rank1]:2025-12-28 22:19:14,863 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2219_rank1_stage1.svg
[rank1]:	> Counts Sum: 77400, Total Sum: 460800 (16.80%), Ratio(%) per element: [17.18, 17.57, 17.18, 16.79, 17.57, 17.57, 17.18, 14.84, 15.23, 16.4, 17.57, 17.57, 17.57, 17.18, 17.18, 16.01, 14.45, 14.84, 17.18, 17.96, 17.57, 17.18, 17.96, 17.57, 17.18, 15.62, 14.84, 17.18, 16.79, 17.57, 16.4, 17.57, 17.18, 17.18, 16.01, 16.4, 17.18, 16.4, 17.57, 17.57, 17.96, 16.79, 17.18, 15.23, 14.45]
[rank0]:2025-12-28 22:19:14,858 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2219_rank0_stage0.svg
[rank0]:	> Counts Sum: 63680, Total Sum: 378880 (16.81%), Ratio(%) per element: [17.96, 17.18, 17.18, 17.18, 17.18, 17.57, 16.4, 17.57, 14.84, 14.84, 17.18, 17.96, 17.57, 17.57, 17.57, 16.79, 17.96, 14.84, 15.23, 17.18, 17.57, 16.79, 16.79, 17.57, 17.18, 17.18, 14.84, 15.23, 16.79, 17.57, 17.18, 17.57, 17.18, 17.18, 16.79, 15.23, 15.23]
[rank3]:2025-12-28 22:19:14,842 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2219_stage3_step400.svg
[rank2]:2025-12-28 22:19:14,864 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2219_rank2_stage2.svg
[rank2]:	> Counts Sum: 61920, Total Sum: 368640 (16.80%), Ratio(%) per element: [17.96, 17.18, 16.79, 16.79, 17.57, 17.18, 17.57, 15.62, 15.62, 17.18, 17.18, 17.18, 17.57, 17.57, 16.4, 17.57, 14.84, 15.23, 16.79, 16.79, 17.18, 17.57, 17.57, 17.18, 17.57, 14.84, 15.62, 16.79, 16.79, 17.18, 17.57, 17.18, 17.18, 17.18, 15.62, 14.84]
[rank3]:2025-12-28 22:19:14,970 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2219_rank3_stage3.svg
[rank3]:	> Counts Sum: 218480, Total Sum: 296960 (73.57%), Ratio(%) per element: [81.64, 79.68, 80.85, 78.51, 79.68, 77.34, 79.68, 59.76, 62.5, 80.85, 80.46, 78.51, 77.73, 81.25, 76.95, 80.07, 58.2, 58.98, 80.46, 78.12, 80.07, 76.17, 76.17, 75.0, 78.9, 59.37, 58.98, 57.81, 59.76]
[rank1]:2025-12-28 22:19:15,278 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2219_stage1.svg
[rank0]:2025-12-28 22:19:15,275 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2219_stage0.svg
[rank2]:2025-12-28 22:19:15,277 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2219_stage2.svg
[rank3]:2025-12-28 22:19:15,375 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2219_stage3.svg
[rank3]:2025-12-28 22:19:35,422 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 22:19:35,823 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 22:19:35,850 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 22:19:35,853 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 22:22:11,439 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 22:22:14,970 - Avg. fwd time: 25.1454 / Avg. bwd time: 59.2345 / Avg. batch time: 820.6864 (ms) / GPU bubble ratio: 17.75%
[rank2]:2025-12-28 22:22:14,997 - Avg. fwd time: 15.0960 / Avg. bwd time: 33.5488 / Avg. batch time: 865.0371 (ms) / GPU bubble ratio: 55.01%
[rank1]:2025-12-28 22:22:15,030 - Avg. fwd time: 20.2633 / Avg. bwd time: 44.7794 / Avg. batch time: 919.8604 (ms) / GPU bubble ratio: 43.43%
[rank0]:2025-12-28 22:22:15,038 - Avg. fwd time: 16.2209 / Avg. bwd time: 36.8232 / Avg. batch time: 955.0586 (ms) / GPU bubble ratio: 55.57%
[rank0]:2025-12-28 22:22:15,074 -  step: 450  loss: -4.0000  grad_norm:  0.2477  memory: 18.76GiB(39.49%)  tps: 9,081  tflops: 70.99  mfu: 22.75%
[rank3]:2025-12-28 22:22:15,073 -  step: 450  loss:  0.2288  grad_norm:  0.2477  memory: 29.24GiB(61.55%)  tps: 9,081  tflops: 70.99  mfu: 22.75%
[rank2]:2025-12-28 22:22:15,060 -  step: 450  loss: -4.0000  grad_norm:  0.2477  memory:  9.60GiB(20.20%)  tps: 9,081  tflops: 70.99  mfu: 22.75%
[rank1]:2025-12-28 22:22:15,065 -  step: 450  loss: -4.0000  grad_norm:  0.2477  memory: 14.02GiB(29.50%)  tps: 9,081  tflops: 70.99  mfu: 22.75%
[rank0]:2025-12-28 22:25:11,458 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 22:25:15,027 - Avg. fwd time: 25.1534 / Avg. bwd time: 58.4500 / Avg. batch time: 814.4919 (ms) / GPU bubble ratio: 17.88%
[rank2]:2025-12-28 22:25:15,055 - Avg. fwd time: 15.1057 / Avg. bwd time: 33.6012 / Avg. batch time: 858.4350 (ms) / GPU bubble ratio: 54.61%
[rank3]:2025-12-28 22:25:15,130 -  step: 500  loss:  0.2243  grad_norm:  0.5223  memory: 29.24GiB(61.55%)  tps: 9,099  tflops: 71.14  mfu: 22.80%
[rank2]:2025-12-28 22:25:15,118 -  step: 500  loss: -4.0000  grad_norm:  0.5223  memory:  9.60GiB(20.20%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank0]:2025-12-28 22:25:15,096 - Avg. fwd time: 16.2312 / Avg. bwd time: 36.8538 / Avg. batch time: 946.7842 (ms) / GPU bubble ratio: 55.14%
[rank0]:2025-12-28 22:25:15,132 -  step: 500  loss: -4.0000  grad_norm:  0.5223  memory: 18.76GiB(39.49%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank1]:2025-12-28 22:25:15,087 - Avg. fwd time: 20.2978 / Avg. bwd time: 44.9344 / Avg. batch time: 912.7792 (ms) / GPU bubble ratio: 42.83%
[rank1]:2025-12-28 22:25:15,121 -  step: 500  loss: -4.0000  grad_norm:  0.5223  memory: 14.02GiB(29.50%)  tps: 9,099  tflops: 71.13  mfu: 22.80%
[rank2]:2025-12-28 22:25:15,185 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2225_stage2_step500.svg
[rank0]:2025-12-28 22:25:15,183 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2225_stage0_step500.svg
[rank1]:2025-12-28 22:25:15,185 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2225_stage1_step500.svg
[rank3]:2025-12-28 22:25:15,293 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2225_step500_rank3.svg
[rank3]:			> Batch Time: 868.50 ms, GPU Bubble Ratio: 50.64%, 38.20%, 54.51%, 29.58%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  274-42-317ms   | [S0,MB4,F]  317-15-332ms   | [S0,MB1,B]  363-42-405ms   | [S0,MB5,F]  406-16-422ms   | [S0,MB2,B]  453-42-495ms   | [S0,MB6,F]  495-16-512ms   | [S0,MB3,B]  542-42-584ms   | [S0,MB7,F]  585-16-601ms   | [S0,MB4,B]  632-42-674ms   | [S0,MB5,B]  720-42-762ms   | [S0,MB6,B]  798-42-840ms   | [S0,MB7,B]  868-0-868ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-85ms     | [S1,MB0,B]  219-46-266ms   | [S1,MB3,F]  270-19-290ms   | [S1,MB1,B]  307-48-355ms   | [S1,MB4,F]  360-21-381ms   | [S1,MB2,B]  395-50-445ms   | [S1,MB5,F]  449-22-472ms   | [S1,MB3,B]  483-51-534ms   | [S1,MB6,F]  538-22-561ms   | [S1,MB4,B]  572-52-624ms   | [S1,MB7,F]  628-22-651ms   | [S1,MB5,B]  661-52-714ms   | [S1,MB6,B]  744-46-791ms   | [S1,MB7,B]  838-23-861ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-13-75ms     | [S2,MB0,B]  173-36-209ms   | [S2,MB2,F]  216-14-231ms   | [S2,MB1,B]  261-36-297ms   | [S2,MB3,F]  304-15-320ms   | [S2,MB2,B]  348-36-384ms   | [S2,MB4,F]  392-15-407ms   | [S2,MB3,B]  436-36-473ms   | [S2,MB5,F]  480-15-496ms   | [S2,MB4,B]  524-36-561ms   | [S2,MB6,F]  568-15-584ms   | [S2,MB5,B]  613-36-649ms   | [S2,MB7,F]  657-15-673ms   | [S2,MB6,B]  701-36-738ms   | [S2,MB7,B]  813-18-831ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-75-163ms    | [S3,MB1,F]  170-24-194ms   | [S3,MB1,B]  206-43-249ms   | [S3,MB2,F]  258-24-282ms   | [S3,MB2,B]  293-43-337ms   | [S3,MB3,F]  345-26-371ms   | [S3,MB3,B]  382-43-426ms   | [S3,MB4,F]  433-25-459ms   | [S3,MB4,B]  470-44-515ms   | [S3,MB5,F]  521-26-547ms   | [S3,MB5,B]  559-43-603ms   | [S3,MB6,F]  610-26-636ms   | [S3,MB6,B]  647-43-691ms   | [S3,MB7,F]  698-25-724ms   | [S3,MB7,B]  736-71-808ms  
[rank3]:2025-12-28 22:25:15,352 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2225_stage3_step500.svg
[rank2]:2025-12-28 22:25:15,343 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2225_rank2_stage2.svg
[rank2]:	> Counts Sum: 76320, Total Sum: 483840 (15.77%), Ratio(%) per element: [16.66, 16.07, 15.77, 15.77, 16.36, 16.07, 16.36, 14.88, 14.88, 16.07, 16.07, 16.07, 16.36, 16.36, 15.47, 16.36, 14.28, 14.58, 15.77, 15.77, 16.07, 16.36, 16.36, 16.07, 16.36, 14.28, 14.88, 15.77, 15.77, 16.07, 16.36, 16.07, 16.07, 16.07, 14.88, 14.28]
[rank0]:2025-12-28 22:25:15,341 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2225_rank0_stage0.svg
[rank0]:	> Counts Sum: 78480, Total Sum: 497280 (15.78%), Ratio(%) per element: [16.66, 16.07, 16.07, 16.07, 16.07, 16.36, 15.47, 16.36, 14.28, 14.28, 16.07, 16.66, 16.36, 16.36, 16.36, 15.77, 16.66, 14.28, 14.58, 16.07, 16.36, 15.77, 15.77, 16.36, 16.07, 16.07, 14.28, 14.58, 15.77, 16.36, 16.07, 16.36, 16.07, 16.07, 15.77, 14.58, 14.58]
[rank1]:2025-12-28 22:25:15,338 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2225_rank1_stage1.svg
[rank1]:	> Counts Sum: 95400, Total Sum: 604800 (15.77%), Ratio(%) per element: [16.07, 16.36, 16.07, 15.77, 16.36, 16.36, 16.07, 14.28, 14.58, 15.47, 16.36, 16.36, 16.36, 16.07, 16.07, 15.17, 13.98, 14.28, 16.07, 16.66, 16.36, 16.07, 16.66, 16.36, 16.07, 14.88, 14.28, 16.07, 15.77, 16.36, 15.47, 16.36, 16.07, 16.07, 15.17, 15.47, 16.07, 15.47, 16.36, 16.36, 16.66, 15.77, 16.07, 14.58, 13.98]
[rank3]:2025-12-28 22:25:15,484 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2225_rank3_stage3.svg
[rank3]:	> Counts Sum: 292880, Total Sum: 389760 (75.14%), Ratio(%) per element: [82.14, 79.46, 80.05, 79.76, 80.35, 78.57, 80.95, 63.39, 65.47, 81.25, 81.54, 79.76, 79.46, 80.95, 78.57, 80.05, 62.2, 62.79, 80.65, 78.86, 80.95, 77.67, 77.97, 76.48, 78.57, 63.09, 62.79, 61.9, 63.39]
[rank2]:2025-12-28 22:25:15,885 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2225_stage2.svg
[rank0]:2025-12-28 22:25:15,891 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2225_stage0.svg
[rank1]:2025-12-28 22:25:15,883 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2225_stage1.svg
[rank3]:2025-12-28 22:25:16,021 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2225_stage3.svg
[rank0]:2025-12-28 22:28:12,237 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 22:28:15,869 - Avg. fwd time: 25.1635 / Avg. bwd time: 57.8087 / Avg. batch time: 809.4626 (ms) / GPU bubble ratio: 18.00%
[rank3]:2025-12-28 22:28:15,973 -  step: 550  loss:  0.2294  grad_norm:  0.5729  memory: 29.24GiB(61.55%)  tps: 9,060  tflops: 70.83  mfu: 22.70%
[rank2]:2025-12-28 22:28:15,897 - Avg. fwd time: 15.1199 / Avg. bwd time: 33.6422 / Avg. batch time: 853.0974 (ms) / GPU bubble ratio: 54.27%
[rank2]:2025-12-28 22:28:15,961 -  step: 550  loss: -4.0000  grad_norm:  0.5729  memory:  9.60GiB(20.20%)  tps: 9,060  tflops: 70.83  mfu: 22.70%
[rank0]:2025-12-28 22:28:15,939 - Avg. fwd time: 16.2386 / Avg. bwd time: 36.8790 / Avg. batch time: 940.0826 (ms) / GPU bubble ratio: 54.80%
[rank0]:2025-12-28 22:28:15,975 -  step: 550  loss: -4.0000  grad_norm:  0.5729  memory: 18.76GiB(39.49%)  tps: 9,060  tflops: 70.83  mfu: 22.70%
[rank1]:2025-12-28 22:28:15,930 - Avg. fwd time: 20.3256 / Avg. bwd time: 45.0659 / Avg. batch time: 907.0543 (ms) / GPU bubble ratio: 42.33%
[rank1]:2025-12-28 22:28:15,965 -  step: 550  loss: -4.0000  grad_norm:  0.5729  memory: 14.02GiB(29.50%)  tps: 9,060  tflops: 70.83  mfu: 22.70%
[rank0]:2025-12-28 22:31:12,683 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-28 22:31:16,354 - Avg. fwd time: 15.1403 / Avg. bwd time: 33.6778 / Avg. batch time: 848.7605 (ms) / GPU bubble ratio: 53.99%
[rank2]:2025-12-28 22:31:16,417 -  step: 600  loss: -4.0000  grad_norm:  1.0371  memory:  9.60GiB(20.20%)  tps: 9,079  tflops: 70.98  mfu: 22.75%
[rank3]:2025-12-28 22:31:16,326 - Avg. fwd time: 25.1761 / Avg. bwd time: 57.2881 / Avg. batch time: 805.4129 (ms) / GPU bubble ratio: 18.09%
[rank1]:2025-12-28 22:31:16,387 - Avg. fwd time: 20.3670 / Avg. bwd time: 45.2003 / Avg. batch time: 902.3889 (ms) / GPU bubble ratio: 41.87%
[rank1]:2025-12-28 22:31:16,421 -  step: 600  loss: -4.0000  grad_norm:  1.0371  memory: 14.02GiB(29.50%)  tps: 9,079  tflops: 70.98  mfu: 22.75%
[rank0]:2025-12-28 22:31:16,396 - Avg. fwd time: 16.2449 / Avg. bwd time: 36.9004 / Avg. batch time: 934.6053 (ms) / GPU bubble ratio: 54.51%
[rank2]:2025-12-28 22:31:16,480 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2231_stage2_step600.svg
[rank3]:2025-12-28 22:31:16,430 -  step: 600  loss:  0.2252  grad_norm:  1.0371  memory: 29.24GiB(61.55%)  tps: 9,079  tflops: 70.98  mfu: 22.75%
[rank1]:2025-12-28 22:31:16,480 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2231_stage1_step600.svg
[rank0]:2025-12-28 22:31:16,432 -  step: 600  loss: -4.0000  grad_norm:  1.0371  memory: 18.76GiB(39.49%)  tps: 9,079  tflops: 70.98  mfu: 22.75%
[rank0]:2025-12-28 22:31:16,481 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2231_stage0_step600.svg
[rank3]:2025-12-28 22:31:16,574 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2231_step600_rank3.svg
[rank3]:			> Batch Time: 875.00 ms, GPU Bubble Ratio: 50.92%, 38.14%, 54.83%, 29.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  49-16-65ms     | [S0,MB0,B]  277-42-319ms   | [S0,MB4,F]  320-15-335ms   | [S0,MB1,B]  366-42-409ms   | [S0,MB5,F]  408-16-425ms   | [S0,MB2,B]  456-42-499ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  548-42-590ms   | [S0,MB7,F]  590-16-607ms   | [S0,MB4,B]  636-42-679ms   | [S0,MB5,B]  725-42-767ms   | [S0,MB6,B]  804-42-846ms   | [S0,MB7,B]  875-0-875ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  222-46-269ms   | [S1,MB3,F]  274-19-293ms   | [S1,MB1,B]  310-49-359ms   | [S1,MB4,F]  363-22-385ms   | [S1,MB2,B]  398-50-448ms   | [S1,MB5,F]  453-22-475ms   | [S1,MB3,B]  487-52-539ms   | [S1,MB6,F]  544-22-567ms   | [S1,MB4,B]  576-52-628ms   | [S1,MB7,F]  633-22-655ms   | [S1,MB5,B]  664-53-717ms   | [S1,MB6,B]  750-47-798ms   | [S1,MB7,B]  845-23-868ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  175-36-212ms   | [S2,MB2,F]  219-14-234ms   | [S2,MB1,B]  263-36-299ms   | [S2,MB3,F]  306-15-322ms   | [S2,MB2,B]  351-36-388ms   | [S2,MB4,F]  395-15-410ms   | [S2,MB3,B]  440-36-476ms   | [S2,MB5,F]  484-15-499ms   | [S2,MB4,B]  529-36-565ms   | [S2,MB6,F]  573-15-588ms   | [S2,MB5,B]  617-36-654ms   | [S2,MB7,F]  661-15-676ms   | [S2,MB6,B]  707-36-744ms   | [S2,MB7,B]  820-17-838ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-77-166ms    | [S3,MB1,F]  172-24-197ms   | [S3,MB1,B]  208-43-252ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  297-43-341ms   | [S3,MB3,F]  348-26-374ms   | [S3,MB3,B]  386-44-430ms   | [S3,MB4,F]  437-25-463ms   | [S3,MB4,B]  475-44-519ms   | [S3,MB5,F]  526-26-552ms   | [S3,MB5,B]  564-43-608ms   | [S3,MB6,F]  615-26-641ms   | [S3,MB6,B]  653-44-697ms   | [S3,MB7,F]  704-26-730ms   | [S3,MB7,B]  742-72-814ms  
[rank1]:2025-12-28 22:31:16,624 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2231_rank1_stage1.svg
[rank1]:	> Counts Sum: 113400, Total Sum: 748800 (15.14%), Ratio(%) per element: [15.38, 15.62, 15.38, 15.14, 15.62, 15.62, 15.38, 13.94, 14.18, 14.9, 15.62, 15.62, 15.62, 15.38, 15.38, 14.66, 13.7, 13.94, 15.38, 15.86, 15.62, 15.38, 15.86, 15.62, 15.38, 14.42, 13.94, 15.38, 15.14, 15.62, 14.9, 15.62, 15.38, 15.38, 14.66, 14.9, 15.38, 14.9, 15.62, 15.62, 15.86, 15.14, 15.38, 14.18, 13.7]
[rank2]:2025-12-28 22:31:16,629 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2231_rank2_stage2.svg
[rank2]:	> Counts Sum: 90720, Total Sum: 599040 (15.14%), Ratio(%) per element: [15.86, 15.38, 15.14, 15.14, 15.62, 15.38, 15.62, 14.42, 14.42, 15.38, 15.38, 15.38, 15.62, 15.62, 14.9, 15.62, 13.94, 14.18, 15.14, 15.14, 15.38, 15.62, 15.62, 15.38, 15.62, 13.94, 14.42, 15.14, 15.14, 15.38, 15.62, 15.38, 15.38, 15.38, 14.42, 13.94]
[rank3]:2025-12-28 22:31:16,653 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2231_stage3_step600.svg
[rank0]:2025-12-28 22:31:16,634 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2231_rank0_stage0.svg
[rank0]:	> Counts Sum: 93280, Total Sum: 615680 (15.15%), Ratio(%) per element: [15.86, 15.38, 15.38, 15.38, 15.38, 15.62, 14.9, 15.62, 13.94, 13.94, 15.38, 15.86, 15.62, 15.62, 15.62, 15.14, 15.86, 13.94, 14.18, 15.38, 15.62, 15.14, 15.14, 15.62, 15.38, 15.38, 13.94, 14.18, 15.14, 15.62, 15.38, 15.62, 15.38, 15.38, 15.14, 14.18, 14.18]
[rank3]:2025-12-28 22:31:16,784 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2231_rank3_stage3.svg
[rank3]:	> Counts Sum: 367280, Total Sum: 482560 (76.11%), Ratio(%) per element: [82.21, 79.32, 80.76, 80.76, 80.52, 79.08, 81.49, 65.62, 67.3, 81.25, 81.73, 79.8, 80.28, 80.76, 78.84, 80.52, 64.66, 65.14, 80.52, 79.8, 81.0, 78.84, 79.32, 77.4, 79.56, 65.38, 65.14, 64.42, 65.62]
[rank2]:2025-12-28 22:31:17,282 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2231_stage2.svg
[rank1]:2025-12-28 22:31:17,281 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2231_stage1.svg
[rank0]:2025-12-28 22:31:17,308 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2231_stage0.svg
[rank3]:2025-12-28 22:31:17,439 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2231_stage3.svg
[rank0]:2025-12-28 22:34:14,483 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-28 22:34:18,042 - Avg. fwd time: 15.1498 / Avg. bwd time: 33.7124 / Avg. batch time: 845.2590 (ms) / GPU bubble ratio: 53.75%
[rank3]:2025-12-28 22:34:18,013 - Avg. fwd time: 25.1944 / Avg. bwd time: 56.8550 / Avg. batch time: 802.1147 (ms) / GPU bubble ratio: 18.17%
[rank2]:2025-12-28 22:34:18,107 -  step: 650  loss: -4.0000  grad_norm:  0.1585  memory:  9.60GiB(20.20%)  tps: 9,018  tflops: 70.50  mfu: 22.59%
[rank1]:2025-12-28 22:34:18,076 - Avg. fwd time: 20.3925 / Avg. bwd time: 45.3011 / Avg. batch time: 898.6131 (ms) / GPU bubble ratio: 41.52%
[rank1]:2025-12-28 22:34:18,111 -  step: 650  loss: -4.0000  grad_norm:  0.1585  memory: 14.02GiB(29.50%)  tps: 9,018  tflops: 70.50  mfu: 22.59%
[rank0]:2025-12-28 22:34:18,085 - Avg. fwd time: 16.2530 / Avg. bwd time: 36.9197 / Avg. batch time: 930.1418 (ms) / GPU bubble ratio: 54.27%
[rank0]:2025-12-28 22:34:18,122 -  step: 650  loss: -4.0000  grad_norm:  0.1585  memory: 18.76GiB(39.49%)  tps: 9,018  tflops: 70.50  mfu: 22.59%
[rank3]:2025-12-28 22:34:18,120 -  step: 650  loss:  0.2302  grad_norm:  0.1585  memory: 29.24GiB(61.55%)  tps: 9,018  tflops: 70.50  mfu: 22.59%
[rank0]:2025-12-28 22:37:15,415 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 22:37:18,974 - Avg. fwd time: 25.2164 / Avg. bwd time: 56.4843 / Avg. batch time: 799.3391 (ms) / GPU bubble ratio: 18.23%
[rank2]:2025-12-28 22:37:19,003 - Avg. fwd time: 15.1596 / Avg. bwd time: 33.7413 / Avg. batch time: 842.2797 (ms) / GPU bubble ratio: 53.55%
[rank2]:2025-12-28 22:37:19,069 -  step: 700  loss: -4.0000  grad_norm:  0.3835  memory:  9.60GiB(20.20%)  tps: 9,054  tflops: 70.78  mfu: 22.69%
[rank0]:2025-12-28 22:37:19,047 - Avg. fwd time: 16.2613 / Avg. bwd time: 36.9376 / Avg. batch time: 926.3460 (ms) / GPU bubble ratio: 54.06%
[rank0]:2025-12-28 22:37:19,083 -  step: 700  loss: -4.0000  grad_norm:  0.3835  memory: 18.76GiB(39.49%)  tps: 9,054  tflops: 70.78  mfu: 22.69%
[rank3]:2025-12-28 22:37:19,081 -  step: 700  loss:  0.1911  grad_norm:  0.3835  memory: 29.24GiB(61.55%)  tps: 9,054  tflops: 70.78  mfu: 22.69%
[rank1]:2025-12-28 22:37:19,037 - Avg. fwd time: 20.4164 / Avg. bwd time: 45.3851 / Avg. batch time: 895.4041 (ms) / GPU bubble ratio: 41.21%
[rank1]:2025-12-28 22:37:19,072 -  step: 700  loss: -4.0000  grad_norm:  0.3835  memory: 14.02GiB(29.50%)  tps: 9,054  tflops: 70.78  mfu: 22.69%
[rank2]:2025-12-28 22:37:19,134 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2237_stage2_step700.svg
[rank0]:2025-12-28 22:37:19,134 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2237_stage0_step700.svg
[rank1]:2025-12-28 22:37:19,133 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2237_stage1_step700.svg
[rank0]:2025-12-28 22:37:19,288 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2237_rank0_stage0.svg
[rank0]:	> Counts Sum: 108080, Total Sum: 734080 (14.72%), Ratio(%) per element: [15.32, 14.91, 14.91, 14.91, 14.91, 15.12, 14.51, 15.12, 13.7, 13.7, 14.91, 15.32, 15.12, 15.12, 15.12, 14.71, 15.32, 13.7, 13.91, 14.91, 15.12, 14.71, 14.71, 15.12, 14.91, 14.91, 13.7, 13.91, 14.71, 15.12, 14.91, 15.12, 14.91, 14.91, 14.71, 13.91, 13.91]
[rank3]:2025-12-28 22:37:19,225 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2237_step700_rank3.svg
[rank3]:			> Batch Time: 879.00 ms, GPU Bubble Ratio: 51.14%, 38.68%, 54.93%, 29.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  277-42-320ms   | [S0,MB4,F]  320-15-336ms   | [S0,MB1,B]  366-42-409ms   | [S0,MB5,F]  409-16-425ms   | [S0,MB2,B]  457-42-500ms   | [S0,MB6,F]  500-16-517ms   | [S0,MB3,B]  548-42-590ms   | [S0,MB7,F]  591-16-607ms   | [S0,MB4,B]  638-42-680ms   | [S0,MB5,B]  725-42-767ms   | [S0,MB6,B]  804-42-846ms   | [S0,MB7,B]  879-0-879ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  222-46-269ms   | [S1,MB3,F]  274-19-294ms   | [S1,MB1,B]  310-48-358ms   | [S1,MB4,F]  363-22-385ms   | [S1,MB2,B]  398-50-449ms   | [S1,MB5,F]  454-22-476ms   | [S1,MB3,B]  488-51-540ms   | [S1,MB6,F]  544-22-567ms   | [S1,MB4,B]  577-52-629ms   | [S1,MB7,F]  634-22-657ms   | [S1,MB5,B]  666-52-718ms   | [S1,MB6,B]  750-47-797ms   | [S1,MB7,B]  849-23-872ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  176-36-212ms   | [S2,MB2,F]  219-14-234ms   | [S2,MB1,B]  263-36-300ms   | [S2,MB3,F]  307-15-322ms   | [S2,MB2,B]  351-36-388ms   | [S2,MB4,F]  395-15-411ms   | [S2,MB3,B]  441-36-478ms   | [S2,MB5,F]  485-15-500ms   | [S2,MB4,B]  530-36-566ms   | [S2,MB6,F]  574-15-589ms   | [S2,MB5,B]  619-36-655ms   | [S2,MB7,F]  663-15-678ms   | [S2,MB6,B]  707-36-744ms   | [S2,MB7,B]  824-18-842ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-78-166ms    | [S3,MB1,F]  173-24-197ms   | [S3,MB1,B]  209-43-252ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  297-43-341ms   | [S3,MB3,F]  348-26-375ms   | [S3,MB3,B]  386-44-431ms   | [S3,MB4,F]  438-25-464ms   | [S3,MB4,B]  476-44-520ms   | [S3,MB5,F]  527-26-553ms   | [S3,MB5,B]  565-43-609ms   | [S3,MB6,F]  616-25-642ms   | [S3,MB6,B]  653-44-698ms   | [S3,MB7,F]  704-26-731ms   | [S3,MB7,B]  742-75-818ms  
[rank3]:2025-12-28 22:37:19,271 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2237_stage3_step700.svg
[rank1]:2025-12-28 22:37:19,280 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2237_rank1_stage1.svg
[rank1]:	> Counts Sum: 131400, Total Sum: 892800 (14.72%), Ratio(%) per element: [14.91, 15.12, 14.91, 14.71, 15.12, 15.12, 14.91, 13.7, 13.91, 14.51, 15.12, 15.12, 15.12, 14.91, 14.91, 14.31, 13.5, 13.7, 14.91, 15.32, 15.12, 14.91, 15.32, 15.12, 14.91, 14.11, 13.7, 14.91, 14.71, 15.12, 14.51, 15.12, 14.91, 14.91, 14.31, 14.51, 14.91, 14.51, 15.12, 15.12, 15.32, 14.71, 14.91, 13.91, 13.5]
[rank2]:2025-12-28 22:37:19,286 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2237_rank2_stage2.svg
[rank2]:	> Counts Sum: 105120, Total Sum: 714240 (14.72%), Ratio(%) per element: [15.32, 14.91, 14.71, 14.71, 15.12, 14.91, 15.12, 14.11, 14.11, 14.91, 14.91, 14.91, 15.12, 15.12, 14.51, 15.12, 13.7, 13.91, 14.71, 14.71, 14.91, 15.12, 15.12, 14.91, 15.12, 13.7, 14.11, 14.71, 14.71, 14.91, 15.12, 14.91, 14.91, 14.91, 14.11, 13.7]
[rank3]:2025-12-28 22:37:19,401 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2237_rank3_stage3.svg
[rank3]:	> Counts Sum: 441680, Total Sum: 575360 (76.77%), Ratio(%) per element: [81.85, 79.43, 80.44, 81.25, 81.04, 79.63, 81.65, 67.13, 68.54, 81.25, 81.25, 80.84, 80.84, 80.64, 79.83, 81.25, 66.33, 66.73, 80.84, 79.83, 81.04, 79.63, 80.04, 77.82, 79.83, 66.93, 66.93, 66.12, 67.13]
[rank2]:2025-12-28 22:37:20,077 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2237_stage2.svg
[rank0]:2025-12-28 22:37:20,094 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2237_stage0.svg
[rank1]:2025-12-28 22:37:20,069 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2237_stage1.svg
[rank3]:2025-12-28 22:37:20,184 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2237_stage3.svg
[rank0]:2025-12-28 22:40:16,843 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-28 22:40:20,422 - Avg. fwd time: 25.2252 / Avg. bwd time: 56.1542 / Avg. batch time: 796.7738 (ms) / GPU bubble ratio: 18.29%
[rank2]:2025-12-28 22:40:20,451 - Avg. fwd time: 15.1680 / Avg. bwd time: 33.7673 / Avg. batch time: 839.5519 (ms) / GPU bubble ratio: 53.37%
[rank2]:2025-12-28 22:40:20,517 -  step: 750  loss: -4.0000  grad_norm:  0.3406  memory:  9.60GiB(20.20%)  tps: 9,030  tflops: 70.59  mfu: 22.62%
[rank3]:2025-12-28 22:40:20,530 -  step: 750  loss:  0.2343  grad_norm:  0.3406  memory: 29.24GiB(61.55%)  tps: 9,030  tflops: 70.59  mfu: 22.62%
[rank0]:2025-12-28 22:40:20,495 - Avg. fwd time: 16.2668 / Avg. bwd time: 36.9527 / Avg. batch time: 922.9081 (ms) / GPU bubble ratio: 53.87%
[rank0]:2025-12-28 22:40:20,531 -  step: 750  loss: -4.0000  grad_norm:  0.3406  memory: 18.76GiB(39.49%)  tps: 9,030  tflops: 70.59  mfu: 22.62%
[rank1]:2025-12-28 22:40:20,485 - Avg. fwd time: 20.4352 / Avg. bwd time: 45.4673 / Avg. batch time: 892.4773 (ms) / GPU bubble ratio: 40.93%
[rank1]:2025-12-28 22:40:20,521 -  step: 750  loss: -4.0000  grad_norm:  0.3406  memory: 14.02GiB(29.50%)  tps: 9,030  tflops: 70.59  mfu: 22.62%
[rank0]:2025-12-28 22:43:17,678 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 22:43:21,323 - Avg. fwd time: 25.2378 / Avg. bwd time: 55.8736 / Avg. batch time: 794.6374 (ms) / GPU bubble ratio: 18.34%
[rank1]:2025-12-28 22:43:21,387 - Avg. fwd time: 20.4580 / Avg. bwd time: 45.5372 / Avg. batch time: 890.0068 (ms) / GPU bubble ratio: 40.68%
[rank2]:2025-12-28 22:43:21,352 - Avg. fwd time: 15.1745 / Avg. bwd time: 33.7883 / Avg. batch time: 837.2638 (ms) / GPU bubble ratio: 53.22%
[rank2]:2025-12-28 22:43:21,420 -  step: 800  loss: -4.0000  grad_norm:  0.9422  memory:  9.60GiB(20.20%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank2]:2025-12-28 22:43:21,420 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.9422  tps: 9,158  tflops: 71.60  mfu: 20.98%
[rank2]:2025-12-28 22:43:21,420 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 22:43:21,420 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 22:43:21,432 -  step: 800  loss:  0.2373  grad_norm:  0.9422  memory: 29.24GiB(61.55%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank3]:2025-12-28 22:43:21,433 - â„¹ï¸ final step: 800  loss:  0.2373  grad_norm:  0.9422  tps: 9,165  tflops: 71.65  mfu: 21.10%
[rank3]:2025-12-28 22:43:21,433 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 22:43:21,434 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 22:43:21,398 - Avg. fwd time: 16.2714 / Avg. bwd time: 36.9656 / Avg. batch time: 919.9931 (ms) / GPU bubble ratio: 53.71%
[rank0]:2025-12-28 22:43:21,434 -  step: 800  loss: -4.0000  grad_norm:  0.9422  memory: 18.76GiB(39.49%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank0]:2025-12-28 22:43:21,434 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.9422  tps: 9,159  tflops: 71.60  mfu: 20.99%
[rank0]:2025-12-28 22:43:21,434 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 22:43:21,435 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 22:43:21,423 -  step: 800  loss: -4.0000  grad_norm:  0.9422  memory: 14.02GiB(29.50%)  tps: 9,057  tflops: 70.80  mfu: 22.69%
[rank1]:2025-12-28 22:43:21,423 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.9422  tps: 9,159  tflops: 71.60  mfu: 21.00%
[rank1]:2025-12-28 22:43:21,423 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 22:43:21,424 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 22:43:23,401 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-28 22:43:23,479 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank0/251228_2243_stage0_final800.svg
[rank1]:2025-12-28 22:43:23,466 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank1/251228_2243_stage1_final800.svg
[rank2]:2025-12-28 22:43:23,466 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank2/251228_2243_stage2_final800.svg
[rank3]:2025-12-28 22:43:23,552 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2243_final800_rank3.svg
[rank3]:			> Batch Time: 876.00 ms, GPU Bubble Ratio: 51.10%, 39.04%, 54.96%, 29.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-15-32ms     | [S0,MB2,F]  32-16-48ms     | [S0,MB3,F]  48-16-65ms     | [S0,MB0,B]  275-42-317ms   | [S0,MB4,F]  317-15-333ms   | [S0,MB1,B]  366-42-408ms   | [S0,MB5,F]  409-16-425ms   | [S0,MB2,B]  456-42-499ms   | [S0,MB6,F]  499-16-515ms   | [S0,MB3,B]  547-42-589ms   | [S0,MB7,F]  590-16-606ms   | [S0,MB4,B]  636-42-679ms   | [S0,MB5,B]  725-42-767ms   | [S0,MB6,B]  805-42-847ms   | [S0,MB7,B]  876-0-876ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  220-46-266ms   | [S1,MB3,F]  271-19-291ms   | [S1,MB1,B]  310-47-358ms   | [S1,MB4,F]  363-21-384ms   | [S1,MB2,B]  398-49-448ms   | [S1,MB5,F]  453-22-475ms   | [S1,MB3,B]  487-50-538ms   | [S1,MB6,F]  543-22-566ms   | [S1,MB4,B]  576-51-628ms   | [S1,MB7,F]  633-22-655ms   | [S1,MB5,B]  665-52-717ms   | [S1,MB6,B]  751-46-798ms   | [S1,MB7,B]  846-23-869ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-14-75ms     | [S2,MB0,B]  174-36-210ms   | [S2,MB2,F]  217-14-232ms   | [S2,MB1,B]  263-36-299ms   | [S2,MB3,F]  307-15-322ms   | [S2,MB2,B]  351-36-388ms   | [S2,MB4,F]  395-15-410ms   | [S2,MB3,B]  440-36-477ms   | [S2,MB5,F]  484-15-500ms   | [S2,MB4,B]  529-36-565ms   | [S2,MB6,F]  573-15-588ms   | [S2,MB5,B]  618-36-654ms   | [S2,MB7,F]  662-15-677ms   | [S2,MB6,B]  707-36-744ms   | [S2,MB7,B]  821-18-839ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-76-164ms    | [S3,MB1,F]  171-24-195ms   | [S3,MB1,B]  207-43-251ms   | [S3,MB2,F]  260-25-285ms   | [S3,MB2,B]  297-44-341ms   | [S3,MB3,F]  348-25-374ms   | [S3,MB3,B]  386-44-430ms   | [S3,MB4,F]  437-25-463ms   | [S3,MB4,B]  475-44-519ms   | [S3,MB5,F]  526-26-552ms   | [S3,MB5,B]  564-44-608ms   | [S3,MB6,F]  615-25-641ms   | [S3,MB6,B]  653-44-697ms   | [S3,MB7,F]  705-25-731ms   | [S3,MB7,B]  742-73-815ms  
[rank2]:2025-12-28 22:43:23,613 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2243_rank2_stage2.svg
[rank2]:	> Counts Sum: 119520, Total Sum: 829440 (14.41%), Ratio(%) per element: [14.93, 14.58, 14.4, 14.4, 14.75, 14.58, 14.75, 13.88, 13.88, 14.58, 14.58, 14.58, 14.75, 14.75, 14.23, 14.75, 13.54, 13.71, 14.4, 14.4, 14.58, 14.75, 14.75, 14.58, 14.75, 13.54, 13.88, 14.4, 14.4, 14.58, 14.75, 14.58, 14.58, 14.58, 13.88, 13.54]
[rank0]:2025-12-28 22:43:23,642 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2243_rank0_stage0.svg
[rank0]:	> Counts Sum: 122880, Total Sum: 852480 (14.41%), Ratio(%) per element: [14.93, 14.58, 14.58, 14.58, 14.58, 14.75, 14.23, 14.75, 13.54, 13.54, 14.58, 14.93, 14.75, 14.75, 14.75, 14.4, 14.93, 13.54, 13.71, 14.58, 14.75, 14.4, 14.4, 14.75, 14.58, 14.58, 13.54, 13.71, 14.4, 14.75, 14.58, 14.75, 14.58, 14.58, 14.4, 13.71, 13.71]
[rank1]:2025-12-28 22:43:23,609 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2243_rank1_stage1.svg
[rank1]:	> Counts Sum: 149400, Total Sum: 1036800 (14.41%), Ratio(%) per element: [14.58, 14.75, 14.58, 14.4, 14.75, 14.75, 14.58, 13.54, 13.71, 14.23, 14.75, 14.75, 14.75, 14.58, 14.58, 14.06, 13.36, 13.54, 14.58, 14.93, 14.75, 14.58, 14.93, 14.75, 14.58, 13.88, 13.54, 14.58, 14.4, 14.75, 14.23, 14.75, 14.58, 14.58, 14.06, 14.23, 14.58, 14.23, 14.75, 14.75, 14.93, 14.4, 14.58, 13.71, 13.36]
[rank3]:2025-12-28 22:43:23,687 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/pipeline_schedule/251228_2243_thry_final800_rank3.svg
[rank3]:			> Batch Time: 639.47 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-58ms     | [S0,MB3,F]  58-19-77ms     | [S0,MB0,B]  193-38-232ms   | [S0,MB4,F]  232-19-251ms   | [S0,MB1,B]  251-38-290ms   | [S0,MB5,F]  290-19-310ms   | [S0,MB2,B]  310-38-348ms   | [S0,MB6,F]  348-19-368ms   | [S0,MB3,B]  368-38-406ms   | [S0,MB7,F]  406-19-426ms   | [S0,MB4,B]  426-38-465ms   | [S0,MB5,B]  484-38-523ms   | [S0,MB6,B]  542-38-581ms   | [S0,MB7,B]  600-38-639ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-77ms     | [S1,MB0,B]  155-38-193ms   | [S1,MB3,F]  193-19-213ms   | [S1,MB1,B]  213-38-251ms   | [S1,MB4,F]  251-19-271ms   | [S1,MB2,B]  271-38-310ms   | [S1,MB5,F]  310-19-329ms   | [S1,MB3,B]  329-38-368ms   | [S1,MB6,F]  368-19-387ms   | [S1,MB4,B]  387-38-426ms   | [S1,MB7,F]  426-19-445ms   | [S1,MB5,B]  445-38-484ms   | [S1,MB6,B]  503-38-542ms   | [S1,MB7,B]  561-38-600ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-58ms     | [S2,MB1,F]  58-19-77ms     | [S2,MB0,B]  116-38-155ms   | [S2,MB2,F]  155-19-174ms   | [S2,MB1,B]  174-38-213ms   | [S2,MB3,F]  213-19-232ms   | [S2,MB2,B]  232-38-271ms   | [S2,MB4,F]  271-19-290ms   | [S2,MB3,B]  290-38-329ms   | [S2,MB5,F]  329-19-348ms   | [S2,MB4,B]  348-38-387ms   | [S2,MB6,F]  387-19-406ms   | [S2,MB5,B]  406-38-445ms   | [S2,MB7,F]  445-19-465ms   | [S2,MB6,B]  465-38-503ms   | [S2,MB7,B]  523-38-561ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  58-19-77ms     | [S3,MB0,B]  77-38-116ms    | [S3,MB1,F]  116-19-135ms   | [S3,MB1,B]  135-38-174ms   | [S3,MB2,F]  174-19-193ms   | [S3,MB2,B]  193-38-232ms   | [S3,MB3,F]  232-19-251ms   | [S3,MB3,B]  251-38-290ms   | [S3,MB4,F]  290-19-310ms   | [S3,MB4,B]  310-38-348ms   | [S3,MB5,F]  348-19-368ms   | [S3,MB5,B]  368-38-406ms   | [S3,MB6,F]  406-19-426ms   | [S3,MB6,B]  426-38-465ms   | [S3,MB7,F]  465-19-484ms   | [S3,MB7,B]  484-38-523ms  
[rank3]:2025-12-28 22:43:23,734 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_ratio_history/rank3/251228_2243_stage3_final800.svg
[rank3]:2025-12-28 22:43:23,864 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/frozen_params_histogram/251228_2243_rank3_stage3.svg
[rank3]:	> Counts Sum: 516080, Total Sum: 668160 (77.24%), Ratio(%) per element: [81.94, 79.51, 80.72, 81.42, 81.25, 80.03, 81.25, 68.22, 69.44, 81.77, 81.77, 81.59, 80.72, 81.25, 80.2, 81.42, 67.53, 67.88, 81.07, 79.68, 81.42, 79.51, 79.86, 78.47, 80.2, 68.05, 68.05, 67.36, 68.22]
[rank2]:2025-12-28 22:43:24,525 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2243_stage2.svg
[rank2]:2025-12-28 22:43:24,526 - Destroying the purge thread.
[rank1]:2025-12-28 22:43:24,518 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2243_stage1.svg
[rank1]:2025-12-28 22:43:24,520 - Destroying the purge thread.
[rank0]:2025-12-28 22:43:24,627 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2243_stage0.svg
[rank0]:2025-12-28 22:43:24,630 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-28 22:43:24,678 - Process group destroyed
[rank2]:2025-12-28 22:43:24,684 - Process group destroyed
[rank3]:2025-12-28 22:43:24,768 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1/afr_time_plot/251228_2243_stage3.svg
[rank3]:2025-12-28 22:43:24,770 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 315-336
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.57533
[rank3]:wandb:               final/avg_loss 0.23729
[rank3]:wandb:             final/avg_mfu(%) 21.10305
[rank3]:wandb:             final/avg_tflops 71.6479
[rank3]:wandb:    final/avg_throughput(tps) 9165.01899
[rank3]:wandb:              final/grad_norm 0.94221
[rank3]:wandb:               final/max_loss 0.23729
[rank3]:wandb:                    grad_norm 0.94221
[rank3]:wandb: loss_metrics/global_avg_loss 0.23729
[rank3]:wandb: loss_metrics/global_max_loss 0.23729
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_1F1B_timelyapf_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/4fxi6ren
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_1F1B_timelyapf_11_dm1/20251228-2152/wandb/run-20251228_215241-4fxi6ren/logs
[rank3]:2025-12-28 22:43:26,215 - Process group destroyed
[rank0]:2025-12-28 22:43:26,631 - Training completed
[rank0]:2025-12-28 22:43:26,631 - Destroying the purge thread.
[rank0]:2025-12-28 22:43:26,788 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.9', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.2', 'layers.0', 'tok_embeddings', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.8', 'layers.7', 'layers.5', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.14', 'norm', 'layers.15', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_1F1B_timelyapf_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_1F1B_timelyapf_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_1F1B_timelyapf_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_1F1B_timelyapf_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_1F1B_timelyapf_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_1F1B_timelyapf_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_1F1B_timelyapf_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_1F1B_timelyapf_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
