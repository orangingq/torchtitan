
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 19:59:19 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_GPipe_auto_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-28 19:59:25,308 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank2]:2025-12-28 19:59:25,308 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank1]:2025-12-28 19:59:25,435 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank0]:2025-12-28 19:59:25,549 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 19:59:25,552 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 19:59:25,555 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 19:59:25,556 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-28 19:59:25,536 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 19:59:25,539 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 19:59:25,516 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank1]:2025-12-28 19:59:25,667 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 19:59:25,670 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 19:59:25,737 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 19:59:25,739 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 19:59:25,948 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 19:59:28,767 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-28 19:59:28,919 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 19:59:28,961 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 19:59:28,962 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 19:59:28,989 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 19:59:28,989 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-28 19:59:28,959 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 19:59:28,997 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 19:59:29,023 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 19:59:29,023 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-28 19:59:29,185 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 19:59:29,185 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 19:59:29,186 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-28 19:59:29,245 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 19:59:29,245 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 19:59:29,246 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-28 19:59:29,334 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-28 19:59:29,372 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 19:59:29,399 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 19:59:29,400 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-28 19:59:29,584 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 19:59:29,584 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 19:59:29,585 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run texq5rfh
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_GPipe_auto_11_dm1/20251228-1959/wandb/run-20251228_195930-texq5rfh
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_GPipe_auto_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/texq5rfh
[rank3]:2025-12-28 19:59:31,506 - WandB logging enabled
[rank3]:2025-12-28 19:59:31,507 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 19:59:31,545 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 19:59:31,572 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 19:59:31,573 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-28 19:59:31,795 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 19:59:31,797 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_GPipe_auto_11_dm1
[rank0]:2025-12-28 19:59:31,798 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 19:59:31,798 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 19:59:31,798 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-28 19:59:31,795 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-28 19:59:31,777 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 19:59:31,777 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 19:59:31,778 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-28 19:59:31,795 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 19:59:34,205 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 19:59:34,206 - Finished loading the checkpoint in 2.41 seconds.
[rank0]:2025-12-28 19:59:34,206 - Training starts at step 1
[rank0]:2025-12-28 19:59:39,772 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 13.25GiB(27.89%)  tps: 3,031  tflops: 23.70  mfu: 7.59%
[rank1]:2025-12-28 19:59:39,741 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 12.75GiB(26.83%)  tps: 3,161  tflops: 24.71  mfu: 7.92%
[rank0]:2025-12-28 19:59:39,772 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-28 19:59:39,741 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 19:59:39,745 -  step:  1  loss: 10.6088  grad_norm: 116.5372  memory: 24.19GiB(50.91%)  tps: 3,997  tflops: 31.25  mfu: 10.02%
[rank3]:2025-12-28 19:59:39,746 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 19:59:39,735 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 10.24GiB(21.56%)  tps: 3,052  tflops: 23.86  mfu: 7.65%
[rank2]:2025-12-28 19:59:39,735 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 20:01:38,917 - Avg. fwd time: 10.8068 / Avg. bwd time: 43.4621 / Avg. batch time: 493.8936 (ms) / GPU bubble ratio: 12.10%
[rank2]:2025-12-28 20:01:38,941 - Avg. fwd time: 6.9778 / Avg. bwd time: 19.3029 / Avg. batch time: 526.0825 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-12-28 20:01:39,001 - Avg. fwd time: 8.1612 / Avg. bwd time: 25.1194 / Avg. batch time: 605.1196 (ms) / GPU bubble ratio: 56.00%
[rank1]:2025-12-28 20:01:38,971 - Avg. fwd time: 9.0727 / Avg. bwd time: 24.8704 / Avg. batch time: 566.2274 (ms) / GPU bubble ratio: 52.04%
[rank0]:2025-12-28 20:03:39,220 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 20:03:44,104 - Avg. fwd time: 10.8262 / Avg. bwd time: 43.7827 / Avg. batch time: 496.5438 (ms) / GPU bubble ratio: 12.02%
[rank1]:2025-12-28 20:03:44,159 - Avg. fwd time: 9.0785 / Avg. bwd time: 24.9176 / Avg. batch time: 568.2063 (ms) / GPU bubble ratio: 52.14%
[rank1]:2025-12-28 20:03:44,214 -  step: 50  loss: -8.0000  grad_norm: 12.5938  memory: 15.15GiB(31.89%)  tps: 6,568  tflops: 51.34  mfu: 16.46%
[rank0]:2025-12-28 20:03:44,189 - Avg. fwd time: 8.1933 / Avg. bwd time: 25.1670 / Avg. batch time: 606.8041 (ms) / GPU bubble ratio: 56.02%
[rank0]:2025-12-28 20:03:44,226 -  step: 50  loss: -8.0000  grad_norm: 12.5938  memory: 17.08GiB(35.95%)  tps: 6,568  tflops: 51.35  mfu: 16.46%
[rank2]:2025-12-28 20:03:44,129 - Avg. fwd time: 6.9794 / Avg. bwd time: 19.3496 / Avg. batch time: 528.3395 (ms) / GPU bubble ratio: 60.13%
[rank2]:2025-12-28 20:03:44,211 -  step: 50  loss: -8.0000  grad_norm: 12.5938  memory: 12.26GiB(25.80%)  tps: 6,568  tflops: 51.34  mfu: 16.46%
[rank3]:2025-12-28 20:03:44,223 -  step: 50  loss:  9.9073  grad_norm: 12.5938  memory: 26.98GiB(56.79%)  tps: 6,568  tflops: 51.34  mfu: 16.46%
[rank3]:2025-12-28 20:04:29,352 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-28 20:04:29,345 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-28 20:04:29,357 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-28 20:04:29,340 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-28 20:05:19,442 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.3493e+00
[rank3]:2025-12-28 20:05:19,437 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4440e+00
[rank1]:2025-12-28 20:05:19,430 - Freezing Ratio: [Stage1] 0.20, Threshold: 2.0002e+00
[rank2]:2025-12-28 20:05:19,425 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0560e+00
[rank3]:2025-12-28 20:05:46,761 - Avg. fwd time: 10.8860 / Avg. bwd time: 43.3902 / Avg. batch time: 493.8510 (ms) / GPU bubble ratio: 12.08%
[rank2]:2025-12-28 20:05:46,778 - Avg. fwd time: 7.0708 / Avg. bwd time: 18.7068 / Avg. batch time: 524.8677 (ms) / GPU bubble ratio: 60.71%
[rank0]:2025-12-28 20:05:46,836 - Avg. fwd time: 8.2105 / Avg. bwd time: 25.2043 / Avg. batch time: 603.0141 (ms) / GPU bubble ratio: 55.67%
[rank1]:2025-12-28 20:05:46,805 - Avg. fwd time: 9.1078 / Avg. bwd time: 24.7488 / Avg. batch time: 564.4824 (ms) / GPU bubble ratio: 52.02%
[rank3]:2025-12-28 20:06:05,081 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6432e+00
[rank0]:2025-12-28 20:06:05,094 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.6147e+00
[rank1]:2025-12-28 20:06:05,078 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6641e+00
[rank2]:2025-12-28 20:06:05,066 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6047e+00
[rank1]:2025-12-28 20:06:54,670 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4072e+00
[rank0]:2025-12-28 20:06:54,674 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3048e+01
[rank2]:2025-12-28 20:06:54,666 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2129e+00
[rank3]:2025-12-28 20:06:54,677 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2286e+00
[rank2]:2025-12-28 20:07:39,119 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0290e+00
[rank0]:2025-12-28 20:07:39,117 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 20:07:39,134 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2083e+00
[rank1]:2025-12-28 20:07:39,126 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1362e+00
[rank0]:2025-12-28 20:07:39,138 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4543e+00
[rank3]:2025-12-28 20:07:43,940 - Avg. fwd time: 10.9584 / Avg. bwd time: 42.6637 / Avg. batch time: 488.5865 (ms) / GPU bubble ratio: 12.20%
[rank2]:2025-12-28 20:07:43,966 - Avg. fwd time: 7.2077 / Avg. bwd time: 17.7042 / Avg. batch time: 518.5400 (ms) / GPU bubble ratio: 61.57%
[rank0]:2025-12-28 20:07:44,021 - Avg. fwd time: 8.3536 / Avg. bwd time: 24.0123 / Avg. batch time: 594.7447 (ms) / GPU bubble ratio: 56.46%
[rank1]:2025-12-28 20:07:43,996 - Avg. fwd time: 9.1917 / Avg. bwd time: 24.1347 / Avg. batch time: 557.4908 (ms) / GPU bubble ratio: 52.18%
[rank1]:2025-12-28 20:07:44,044 -  step: 100  loss: -8.0000  grad_norm:  7.5017  memory: 15.15GiB(31.89%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank2]:2025-12-28 20:07:44,041 -  step: 100  loss: -8.0000  grad_norm:  7.5017  memory: 12.26GiB(25.80%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank2]:2025-12-28 20:07:44,125 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2007_stage2_step100.svg
[rank0]:2025-12-28 20:07:44,048 -  step: 100  loss: -8.0000  grad_norm:  7.5017  memory: 17.08GiB(35.95%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank0]:2025-12-28 20:07:44,121 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2007_stage0_step100.svg
[rank3]:2025-12-28 20:07:44,053 -  step: 100  loss:  8.6086  grad_norm:  7.5017  memory: 28.29GiB(59.55%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank1]:2025-12-28 20:07:44,129 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2007_stage1_step100.svg
[rank3]:2025-12-28 20:07:44,220 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2007_step100_rank3.svg
[rank3]:			> Batch Time: 545.59 ms, GPU Bubble Ratio: 58.27%, 57.18%, 71.86%, 27.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-9-44ms      | [S0,MB5,F]  44-8-52ms      | [S0,MB6,F]  52-9-62ms      | [S0,MB7,F]  62-8-70ms      | [S0,MB0,B]  259-19-279ms   | [S0,MB1,B]  297-19-316ms   | [S0,MB2,B]  335-19-354ms   | [S0,MB3,B]  372-19-392ms   | [S0,MB4,B]  411-19-430ms   | [S0,MB5,B]  450-19-469ms   | [S0,MB6,B]  489-19-509ms   | [S0,MB7,B]  526-19-545ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB3,F]  56-9-66ms      | [S1,MB4,F]  75-9-84ms      | [S1,MB5,F]  93-9-103ms     | [S1,MB6,F]  112-9-122ms    | [S1,MB7,F]  131-9-140ms    | [S1,MB0,B]  236-19-256ms   | [S1,MB1,B]  274-19-293ms   | [S1,MB2,B]  312-19-331ms   | [S1,MB3,B]  350-19-369ms   | [S1,MB4,B]  388-19-408ms   | [S1,MB5,B]  427-19-446ms   | [S1,MB6,B]  466-19-486ms   | [S1,MB7,B]  502-19-522ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-8-41ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  259-11-270ms   | [S2,MB2,B]  298-11-309ms   | [S2,MB3,B]  335-11-346ms   | [S2,MB4,B]  374-11-385ms   | [S2,MB5,B]  412-11-423ms   | [S2,MB6,B]  452-11-463ms   | [S2,MB7,B]  488-11-499ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  143-11-155ms   | [S3,MB7,F]  162-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  214-37-251ms   | [S3,MB2,B]  253-38-291ms   | [S3,MB3,B]  291-38-329ms   | [S3,MB4,B]  328-39-367ms   | [S3,MB5,B]  367-39-406ms   | [S3,MB6,B]  405-39-444ms   | [S3,MB7,B]  445-39-484ms  
[rank2]:2025-12-28 20:07:44,286 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2007_rank2_stage2.svg
[rank2]:	> Counts Sum: 54, Total Sum: 180 (30.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-28 20:07:44,281 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2007_rank0_stage0.svg
[rank0]:	> Counts Sum: 54, Total Sum: 185 (29.19%), Ratio(%) per element: [0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:07:44,265 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2007_stage3_step100.svg
[rank1]:2025-12-28 20:07:44,282 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2007_rank1_stage1.svg
[rank1]:	> Counts Sum: 27, Total Sum: 225 (12.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:07:44,399 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2007_rank3_stage3.svg
[rank3]:	> Counts Sum: 36, Total Sum: 145 (24.83%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:08:28,876 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1892e-01
[rank0]:2025-12-28 20:08:28,884 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3392e+00
[rank1]:2025-12-28 20:08:28,881 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.6568e-01
[rank3]:2025-12-28 20:08:28,887 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0567e+00
[rank2]:2025-12-28 20:09:13,070 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6050e+00
[rank3]:2025-12-28 20:09:13,086 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1056e+00
[rank0]:2025-12-28 20:09:13,090 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.7718e+00
[rank1]:2025-12-28 20:09:13,070 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8948e+00
[rank2]:2025-12-28 20:09:42,649 - Avg. fwd time: 7.2521 / Avg. bwd time: 17.3734 / Avg. batch time: 516.7162 (ms) / GPU bubble ratio: 61.87%
[rank3]:2025-12-28 20:09:42,622 - Avg. fwd time: 10.9760 / Avg. bwd time: 42.4576 / Avg. batch time: 487.0622 (ms) / GPU bubble ratio: 12.24%
[rank1]:2025-12-28 20:09:42,680 - Avg. fwd time: 9.2903 / Avg. bwd time: 23.3807 / Avg. batch time: 554.8498 (ms) / GPU bubble ratio: 52.89%
[rank0]:2025-12-28 20:09:42,705 - Avg. fwd time: 8.4609 / Avg. bwd time: 23.1063 / Avg. batch time: 591.1449 (ms) / GPU bubble ratio: 57.28%
[rank2]:2025-12-28 20:10:02,651 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3308e+00
[rank1]:2025-12-28 20:10:02,655 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4375e-01
[rank3]:2025-12-28 20:10:02,663 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7925e+00
[rank0]:2025-12-28 20:10:02,659 - Freezing Ratio: [Stage0] 0.49, Threshold: 8.6067e+00
[rank0]:2025-12-28 20:10:46,767 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2814e+00
[rank3]:2025-12-28 20:10:46,764 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1222e+00
[rank1]:2025-12-28 20:10:46,748 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0353e+00
[rank2]:2025-12-28 20:10:46,748 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9980e+00
[rank0]:2025-12-28 20:11:35,709 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 20:11:35,719 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5276e+00
[rank2]:2025-12-28 20:11:35,715 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7819e-01
[rank3]:2025-12-28 20:11:35,728 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0198e-01
[rank1]:2025-12-28 20:11:35,720 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5935e-01
[rank0]:2025-12-28 20:11:40,133 - Avg. fwd time: 8.5560 / Avg. bwd time: 22.3116 / Avg. batch time: 587.9213 (ms) / GPU bubble ratio: 58.00%
[rank0]:2025-12-28 20:11:40,160 -  step: 150  loss: -8.0000  grad_norm:  9.8867  memory: 17.08GiB(35.95%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank2]:2025-12-28 20:11:40,088 - Avg. fwd time: 7.2900 / Avg. bwd time: 17.0977 / Avg. batch time: 514.9487 (ms) / GPU bubble ratio: 62.11%
[rank2]:2025-12-28 20:11:40,143 -  step: 150  loss: -8.0000  grad_norm:  9.8867  memory: 12.26GiB(25.80%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank3]:2025-12-28 20:11:40,071 - Avg. fwd time: 10.9912 / Avg. bwd time: 42.2640 / Avg. batch time: 485.6214 (ms) / GPU bubble ratio: 12.27%
[rank1]:2025-12-28 20:11:40,107 - Avg. fwd time: 9.3678 / Avg. bwd time: 22.8052 / Avg. batch time: 552.4607 (ms) / GPU bubble ratio: 53.41%
[rank1]:2025-12-28 20:11:40,143 -  step: 150  loss: -8.0000  grad_norm:  9.8867  memory: 15.15GiB(31.89%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank3]:2025-12-28 20:11:40,158 -  step: 150  loss:  4.9436  grad_norm:  9.8867  memory: 28.29GiB(59.55%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank1]:2025-12-28 20:12:19,933 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9727e+00
[rank3]:2025-12-28 20:12:19,948 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8294e+00
[rank2]:2025-12-28 20:12:19,933 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1658e+00
[rank0]:2025-12-28 20:12:19,952 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7926e+00
[rank0]:2025-12-28 20:13:09,152 - Freezing Ratio: [Stage0] 0.49, Threshold: 5.9180e+00
[rank3]:2025-12-28 20:13:09,160 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.4767e+00
[rank2]:2025-12-28 20:13:09,148 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9333e+00
[rank1]:2025-12-28 20:13:09,153 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.3652e-01
[rank2]:2025-12-28 20:13:35,491 - Avg. fwd time: 7.3438 / Avg. bwd time: 16.7099 / Avg. batch time: 512.4430 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-12-28 20:13:35,474 - Avg. fwd time: 11.0178 / Avg. bwd time: 41.9795 / Avg. batch time: 483.5476 (ms) / GPU bubble ratio: 12.32%
[rank1]:2025-12-28 20:13:35,511 - Avg. fwd time: 9.4587 / Avg. bwd time: 22.1310 / Avg. batch time: 549.2489 (ms) / GPU bubble ratio: 53.99%
[rank0]:2025-12-28 20:13:35,536 - Avg. fwd time: 8.6251 / Avg. bwd time: 21.7443 / Avg. batch time: 584.1210 (ms) / GPU bubble ratio: 58.41%
[rank2]:2025-12-28 20:13:53,265 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8816e+00
[rank0]:2025-12-28 20:13:53,285 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8423e+00
[rank1]:2025-12-28 20:13:53,265 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9298e+00
[rank3]:2025-12-28 20:13:53,281 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5922e+00
[rank2]:2025-12-28 20:14:42,278 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0939e-01
[rank0]:2025-12-28 20:14:42,282 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2727e+00
[rank1]:2025-12-28 20:14:42,283 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6984e-01
[rank3]:2025-12-28 20:14:42,290 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2789e-01
[rank0]:2025-12-28 20:15:26,414 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 20:15:26,436 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9907e+00
[rank2]:2025-12-28 20:15:26,416 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6011e+00
[rank1]:2025-12-28 20:15:26,416 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4668e+00
[rank3]:2025-12-28 20:15:26,432 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.3818e+00
[rank2]:2025-12-28 20:15:31,354 - Avg. fwd time: 7.3784 / Avg. bwd time: 16.4632 / Avg. batch time: 510.8491 (ms) / GPU bubble ratio: 62.66%
[rank3]:2025-12-28 20:15:31,328 - Avg. fwd time: 11.0341 / Avg. bwd time: 41.8000 / Avg. batch time: 482.2315 (ms) / GPU bubble ratio: 12.35%
[rank0]:2025-12-28 20:15:31,409 - Avg. fwd time: 8.6794 / Avg. bwd time: 21.3054 / Avg. batch time: 581.5981 (ms) / GPU bubble ratio: 58.76%
[rank0]:2025-12-28 20:15:31,433 -  step: 200  loss: -8.0000  grad_norm:  7.1284  memory: 17.08GiB(35.95%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank2]:2025-12-28 20:15:31,428 -  step: 200  loss: -8.0000  grad_norm:  7.1284  memory: 12.26GiB(25.80%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank1]:2025-12-28 20:15:31,386 - Avg. fwd time: 9.5196 / Avg. bwd time: 21.6848 / Avg. batch time: 547.1827 (ms) / GPU bubble ratio: 54.38%
[rank1]:2025-12-28 20:15:31,432 -  step: 200  loss: -8.0000  grad_norm:  7.1284  memory: 15.15GiB(31.89%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank3]:2025-12-28 20:15:31,441 -  step: 200  loss:  1.3685  grad_norm:  7.1284  memory: 28.29GiB(59.55%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank0]:2025-12-28 20:15:31,494 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2015_stage0_step200.svg
[rank2]:2025-12-28 20:15:31,494 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2015_stage2_step200.svg
[rank1]:2025-12-28 20:15:31,498 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2015_stage1_step200.svg
[rank0]:2025-12-28 20:15:31,650 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2015_rank0_stage0.svg
[rank0]:	> Counts Sum: 270, Total Sum: 555 (48.65%), Ratio(%) per element: [0.0, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:15:31,646 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2015_rank2_stage2.svg
[rank2]:	> Counts Sum: 189, Total Sum: 540 (35.00%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-28 20:15:31,645 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2015_rank1_stage1.svg
[rank1]:	> Counts Sum: 207, Total Sum: 675 (30.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:15:31,586 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2015_step200_rank3.svg
[rank3]:			> Batch Time: 536.06 ms, GPU Bubble Ratio: 57.50%, 64.11%, 71.48%, 26.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-9-44ms      | [S0,MB5,F]  44-8-52ms      | [S0,MB6,F]  52-9-62ms      | [S0,MB7,F]  62-8-71ms      | [S0,MB0,B]  251-19-271ms   | [S0,MB1,B]  288-19-307ms   | [S0,MB2,B]  326-19-345ms   | [S0,MB3,B]  365-19-384ms   | [S0,MB4,B]  403-19-423ms   | [S0,MB5,B]  441-19-460ms   | [S0,MB6,B]  480-19-499ms   | [S0,MB7,B]  516-19-536ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-103ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  130-10-141ms   | [S1,MB0,B]  235-13-248ms   | [S1,MB1,B]  271-13-284ms   | [S1,MB2,B]  309-13-322ms   | [S1,MB3,B]  348-13-361ms   | [S1,MB4,B]  386-13-400ms   | [S1,MB5,B]  424-13-438ms   | [S1,MB6,B]  463-13-476ms   | [S1,MB7,B]  499-13-512ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  108-8-117ms    | [S2,MB6,F]  127-8-135ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  220-11-231ms   | [S2,MB1,B]  257-11-268ms   | [S2,MB2,B]  295-11-306ms   | [S2,MB3,B]  334-11-345ms   | [S2,MB4,B]  372-11-383ms   | [S2,MB5,B]  410-10-421ms   | [S2,MB6,B]  449-10-460ms   | [S2,MB7,B]  485-11-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  105-11-117ms   | [S3,MB5,F]  124-11-135ms   | [S3,MB6,F]  143-11-154ms   | [S3,MB7,F]  162-11-173ms   | [S3,MB0,B]  179-34-214ms   | [S3,MB1,B]  214-36-250ms   | [S3,MB2,B]  250-38-289ms   | [S3,MB3,B]  288-38-327ms   | [S3,MB4,B]  327-39-366ms   | [S3,MB5,B]  366-38-405ms   | [S3,MB6,B]  403-39-442ms   | [S3,MB7,B]  442-39-482ms  
[rank3]:2025-12-28 20:15:31,631 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2015_stage3_step200.svg
[rank3]:2025-12-28 20:15:31,765 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2015_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 435 (28.97%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:16:15,881 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7874e+00
[rank1]:2025-12-28 20:16:15,886 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6336e+00
[rank0]:2025-12-28 20:16:15,885 - Freezing Ratio: [Stage0] 0.49, Threshold: 5.9844e+00
[rank3]:2025-12-28 20:16:15,893 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.4239e+00
[rank2]:2025-12-28 20:16:59,827 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1356e+00
[rank1]:2025-12-28 20:16:59,827 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4076e+00
[rank0]:2025-12-28 20:16:59,847 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0805e+00
[rank3]:2025-12-28 20:16:59,843 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2109e+00
[rank3]:2025-12-28 20:17:29,316 - Avg. fwd time: 11.0361 / Avg. bwd time: 41.7602 / Avg. batch time: 481.9238 (ms) / GPU bubble ratio: 12.36%
[rank2]:2025-12-28 20:17:29,343 - Avg. fwd time: 7.3845 / Avg. bwd time: 16.4217 / Avg. batch time: 510.5268 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-12-28 20:17:29,375 - Avg. fwd time: 9.5401 / Avg. bwd time: 21.5434 / Avg. batch time: 546.7068 (ms) / GPU bubble ratio: 54.52%
[rank0]:2025-12-28 20:17:29,398 - Avg. fwd time: 8.7269 / Avg. bwd time: 20.9120 / Avg. batch time: 580.7105 (ms) / GPU bubble ratio: 59.17%
[rank2]:2025-12-28 20:17:48,927 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1027e+00
[rank1]:2025-12-28 20:17:48,931 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.6360e-01
[rank0]:2025-12-28 20:17:48,930 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0319e+00
[rank3]:2025-12-28 20:17:48,938 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0507e+00
[rank1]:2025-12-28 20:18:33,119 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.8141e+00
[rank2]:2025-12-28 20:18:33,119 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8561e+00
[rank3]:2025-12-28 20:18:33,134 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1787e+00
[rank0]:2025-12-28 20:18:33,138 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5925e+00
[rank1]:2025-12-28 20:19:22,357 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.3859e-01
[rank2]:2025-12-28 20:19:22,353 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2798e+00
[rank3]:2025-12-28 20:19:22,366 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6003e+00
[rank0]:2025-12-28 20:19:22,349 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 20:19:22,357 - Freezing Ratio: [Stage0] 0.49, Threshold: 4.7264e+00
[rank3]:2025-12-28 20:19:26,671 - Avg. fwd time: 11.0406 / Avg. bwd time: 41.7140 / Avg. batch time: 481.5839 (ms) / GPU bubble ratio: 12.36%
[rank1]:2025-12-28 20:19:26,709 - Avg. fwd time: 9.5617 / Avg. bwd time: 21.3816 / Avg. batch time: 546.0994 (ms) / GPU bubble ratio: 54.67%
[rank1]:2025-12-28 20:19:26,745 -  step: 250  loss: -8.0000  grad_norm:  7.7350  memory: 15.15GiB(31.89%)  tps: 6,963  tflops: 54.43  mfu: 17.45%
[rank2]:2025-12-28 20:19:26,689 - Avg. fwd time: 7.3935 / Avg. bwd time: 16.3526 / Avg. batch time: 510.0942 (ms) / GPU bubble ratio: 62.76%
[rank2]:2025-12-28 20:19:26,745 -  step: 250  loss: -8.0000  grad_norm:  7.7350  memory: 12.26GiB(25.80%)  tps: 6,963  tflops: 54.43  mfu: 17.45%
[rank3]:2025-12-28 20:19:26,761 -  step: 250  loss:  1.7756  grad_norm:  7.7350  memory: 28.29GiB(59.55%)  tps: 6,963  tflops: 54.43  mfu: 17.45%
[rank0]:2025-12-28 20:19:26,735 - Avg. fwd time: 8.7628 / Avg. bwd time: 20.6080 / Avg. batch time: 579.7831 (ms) / GPU bubble ratio: 59.47%
[rank0]:2025-12-28 20:19:26,762 -  step: 250  loss: -8.0000  grad_norm:  7.7350  memory: 17.08GiB(35.95%)  tps: 6,962  tflops: 54.43  mfu: 17.44%
[rank1]:2025-12-28 20:20:06,511 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4646e+00
[rank2]:2025-12-28 20:20:06,511 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1499e+00
[rank0]:2025-12-28 20:20:06,530 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3174e+00
[rank3]:2025-12-28 20:20:06,526 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9146e+00
[rank1]:2025-12-28 20:20:55,547 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2880e+00
[rank2]:2025-12-28 20:20:55,542 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4585e+00
[rank0]:2025-12-28 20:20:55,546 - Freezing Ratio: [Stage0] 0.49, Threshold: 6.7176e+00
[rank3]:2025-12-28 20:20:55,554 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1964e+00
[rank3]:2025-12-28 20:21:22,033 - Avg. fwd time: 11.0536 / Avg. bwd time: 41.5795 / Avg. batch time: 480.6063 (ms) / GPU bubble ratio: 12.39%
[rank1]:2025-12-28 20:21:22,073 - Avg. fwd time: 9.6012 / Avg. bwd time: 21.0807 / Avg. batch time: 544.6044 (ms) / GPU bubble ratio: 54.93%
[rank2]:2025-12-28 20:21:22,052 - Avg. fwd time: 7.4175 / Avg. bwd time: 16.1716 / Avg. batch time: 508.9151 (ms) / GPU bubble ratio: 62.92%
[rank0]:2025-12-28 20:21:22,100 - Avg. fwd time: 8.7876 / Avg. bwd time: 20.4017 / Avg. batch time: 578.0721 (ms) / GPU bubble ratio: 59.60%
[rank1]:2025-12-28 20:21:39,821 - Freezing Ratio: [Stage1] 0.00, Threshold: 7.1218e+00
[rank2]:2025-12-28 20:21:39,821 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1233e+00
[rank3]:2025-12-28 20:21:39,836 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6421e+00
[rank0]:2025-12-28 20:21:39,841 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8302e+00
[rank1]:2025-12-28 20:22:29,181 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.8684e-01
[rank2]:2025-12-28 20:22:29,176 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0881e+00
[rank0]:2025-12-28 20:22:29,180 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0681e+00
[rank3]:2025-12-28 20:22:29,188 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5939e+00
[rank1]:2025-12-28 20:23:13,128 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3059e+00
[rank2]:2025-12-28 20:23:13,128 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5973e+00
[rank0]:2025-12-28 20:23:13,127 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 20:23:13,148 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0147e+00
[rank3]:2025-12-28 20:23:13,144 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5707e+00
[rank2]:2025-12-28 20:23:17,962 - Avg. fwd time: 7.4331 / Avg. bwd time: 16.0492 / Avg. batch time: 508.1196 (ms) / GPU bubble ratio: 63.03%
[rank3]:2025-12-28 20:23:17,934 - Avg. fwd time: 11.0604 / Avg. bwd time: 41.4909 / Avg. batch time: 479.9506 (ms) / GPU bubble ratio: 12.41%
[rank1]:2025-12-28 20:23:17,994 - Avg. fwd time: 9.6278 / Avg. bwd time: 20.8670 / Avg. batch time: 543.5858 (ms) / GPU bubble ratio: 55.12%
[rank1]:2025-12-28 20:23:18,041 -  step: 300  loss: -8.0000  grad_norm:  2.6450  memory: 15.15GiB(31.89%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank2]:2025-12-28 20:23:18,038 -  step: 300  loss: -8.0000  grad_norm:  2.6450  memory: 12.26GiB(25.80%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank0]:2025-12-28 20:23:18,019 - Avg. fwd time: 8.8081 / Avg. bwd time: 20.2203 / Avg. batch time: 576.8643 (ms) / GPU bubble ratio: 59.74%
[rank0]:2025-12-28 20:23:18,042 -  step: 300  loss: -8.0000  grad_norm:  2.6450  memory: 17.08GiB(35.95%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank3]:2025-12-28 20:23:18,050 -  step: 300  loss:  0.4966  grad_norm:  2.6450  memory: 28.29GiB(59.55%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank1]:2025-12-28 20:23:18,105 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2023_stage1_step300.svg
[rank2]:2025-12-28 20:23:18,103 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2023_stage2_step300.svg
[rank0]:2025-12-28 20:23:18,103 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2023_stage0_step300.svg
[rank1]:2025-12-28 20:23:18,251 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2023_rank1_stage1.svg
[rank1]:	> Counts Sum: 387, Total Sum: 1125 (34.40%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:23:18,255 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2023_rank2_stage2.svg
[rank2]:	> Counts Sum: 324, Total Sum: 900 (36.00%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-28 20:23:18,260 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2023_rank0_stage0.svg
[rank0]:	> Counts Sum: 495, Total Sum: 925 (53.51%), Ratio(%) per element: [0.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:23:18,202 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2023_step300_rank3.svg
[rank3]:			> Batch Time: 537.09 ms, GPU Bubble Ratio: 57.53%, 64.09%, 71.46%, 25.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB4,F]  35-9-44ms      | [S0,MB5,F]  44-8-53ms      | [S0,MB6,F]  53-9-62ms      | [S0,MB7,F]  62-8-71ms      | [S0,MB0,B]  252-19-272ms   | [S0,MB1,B]  290-19-309ms   | [S0,MB2,B]  328-19-347ms   | [S0,MB3,B]  367-19-387ms   | [S0,MB4,B]  406-19-426ms   | [S0,MB5,B]  445-19-464ms   | [S0,MB6,B]  483-19-503ms   | [S0,MB7,B]  517-19-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  236-13-249ms   | [S1,MB1,B]  273-13-286ms   | [S1,MB2,B]  311-13-325ms   | [S1,MB3,B]  350-13-364ms   | [S1,MB4,B]  389-13-403ms   | [S1,MB5,B]  428-13-442ms   | [S1,MB6,B]  466-13-480ms   | [S1,MB7,B]  500-13-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  220-11-231ms   | [S2,MB1,B]  258-11-269ms   | [S2,MB2,B]  297-11-308ms   | [S2,MB3,B]  336-11-347ms   | [S2,MB4,B]  375-11-386ms   | [S2,MB5,B]  414-10-425ms   | [S2,MB6,B]  452-11-463ms   | [S2,MB7,B]  486-11-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  143-11-155ms   | [S3,MB7,F]  162-11-173ms   | [S3,MB0,B]  179-34-214ms   | [S3,MB1,B]  213-36-250ms   | [S3,MB2,B]  251-39-291ms   | [S3,MB3,B]  290-39-330ms   | [S3,MB4,B]  329-39-368ms   | [S3,MB5,B]  368-39-408ms   | [S3,MB6,B]  407-39-446ms   | [S3,MB7,B]  445-39-484ms  
[rank3]:2025-12-28 20:23:18,248 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2023_stage3_step300.svg
[rank3]:2025-12-28 20:23:18,380 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2023_rank3_stage3.svg
[rank3]:	> Counts Sum: 216, Total Sum: 725 (29.79%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-28 20:24:02,255 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4714e+01
[rank1]:2025-12-28 20:24:02,255 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7394e+00
[rank2]:2025-12-28 20:24:02,251 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3841e+00
[rank3]:2025-12-28 20:24:02,263 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1984e+00
[rank0]:2025-12-28 20:24:45,714 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1985e+00
[rank3]:2025-12-28 20:24:45,714 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3619e+00
[rank1]:2025-12-28 20:24:45,698 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1510e+00
[rank2]:2025-12-28 20:24:45,698 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4559e-01
[rank2]:2025-12-28 20:25:14,922 - Avg. fwd time: 7.4313 / Avg. bwd time: 16.0504 / Avg. batch time: 507.8502 (ms) / GPU bubble ratio: 63.01%
[rank3]:2025-12-28 20:25:14,894 - Avg. fwd time: 11.0549 / Avg. bwd time: 41.4605 / Avg. batch time: 479.6583 (ms) / GPU bubble ratio: 12.41%
[rank1]:2025-12-28 20:25:14,955 - Avg. fwd time: 9.6308 / Avg. bwd time: 20.8299 / Avg. batch time: 543.2731 (ms) / GPU bubble ratio: 55.14%
[rank0]:2025-12-28 20:25:14,979 - Avg. fwd time: 8.8390 / Avg. bwd time: 19.9434 / Avg. batch time: 576.2628 (ms) / GPU bubble ratio: 60.04%
[rank2]:2025-12-28 20:25:34,628 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6126e+00
[rank1]:2025-12-28 20:25:34,632 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1380e+00
[rank0]:2025-12-28 20:25:34,631 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6201e+00
[rank3]:2025-12-28 20:25:34,639 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7327e+00
[rank2]:2025-12-28 20:26:18,096 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5028e+00
[rank1]:2025-12-28 20:26:18,096 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3008e+00
[rank0]:2025-12-28 20:26:18,111 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6580e+00
[rank3]:2025-12-28 20:26:18,111 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1418e+00
[rank0]:2025-12-28 20:27:06,900 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-28 20:27:06,909 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1422e-01
[rank2]:2025-12-28 20:27:06,904 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4906e-01
[rank3]:2025-12-28 20:27:06,917 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.9686e-01
[rank0]:2025-12-28 20:27:06,908 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7293e+00
[rank1]:2025-12-28 20:27:11,251 - Avg. fwd time: 9.6388 / Avg. bwd time: 20.7674 / Avg. batch time: 542.8232 (ms) / GPU bubble ratio: 55.19%
[rank2]:2025-12-28 20:27:11,230 - Avg. fwd time: 7.4336 / Avg. bwd time: 16.0285 / Avg. batch time: 507.4684 (ms) / GPU bubble ratio: 63.01%
[rank3]:2025-12-28 20:27:11,210 - Avg. fwd time: 11.0528 / Avg. bwd time: 41.4195 / Avg. batch time: 479.3105 (ms) / GPU bubble ratio: 12.42%
[rank3]:2025-12-28 20:27:11,301 -  step: 350  loss:  0.2558  grad_norm:  0.2620  memory: 28.29GiB(59.55%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank0]:2025-12-28 20:27:11,276 - Avg. fwd time: 8.8652 / Avg. bwd time: 19.7067 / Avg. batch time: 575.5660 (ms) / GPU bubble ratio: 60.29%
[rank0]:2025-12-28 20:27:11,299 -  step: 350  loss: -8.0000  grad_norm:  0.2620  memory: 17.08GiB(35.95%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank1]:2025-12-28 20:27:11,285 -  step: 350  loss: -8.0000  grad_norm:  0.2620  memory: 15.15GiB(31.89%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank2]:2025-12-28 20:27:11,285 -  step: 350  loss: -8.0000  grad_norm:  0.2620  memory: 12.26GiB(25.80%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank2]:2025-12-28 20:27:50,560 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.3998e-01
[rank1]:2025-12-28 20:27:50,560 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.7674e-01
[rank0]:2025-12-28 20:27:50,576 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8985e-01
[rank3]:2025-12-28 20:27:50,580 - Freezing Ratio: [Stage3] 0.00, Threshold: 8.6083e-01
[rank2]:2025-12-28 20:28:39,636 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6673e-01
[rank1]:2025-12-28 20:28:39,641 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5925e-01
[rank3]:2025-12-28 20:28:39,649 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0785e-01
[rank0]:2025-12-28 20:28:39,640 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0019e+00
[rank2]:2025-12-28 20:29:05,713 - Avg. fwd time: 7.4484 / Avg. bwd time: 15.9198 / Avg. batch time: 506.6318 (ms) / GPU bubble ratio: 63.10%
[rank3]:2025-12-28 20:29:05,693 - Avg. fwd time: 11.0599 / Avg. bwd time: 41.3235 / Avg. batch time: 478.5954 (ms) / GPU bubble ratio: 12.44%
[rank0]:2025-12-28 20:29:05,759 - Avg. fwd time: 8.8901 / Avg. bwd time: 19.5023 / Avg. batch time: 574.3349 (ms) / GPU bubble ratio: 60.45%
[rank1]:2025-12-28 20:29:05,734 - Avg. fwd time: 9.6624 / Avg. bwd time: 20.5909 / Avg. batch time: 541.8051 (ms) / GPU bubble ratio: 55.33%
[rank2]:2025-12-28 20:29:23,237 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4290e-01
[rank1]:2025-12-28 20:29:23,237 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5512e+00
[rank3]:2025-12-28 20:29:23,252 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2831e+00
[rank0]:2025-12-28 20:29:23,252 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2391e+00
[rank1]:2025-12-28 20:30:12,096 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4902e-02
[rank2]:2025-12-28 20:30:12,092 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1538e-01
[rank3]:2025-12-28 20:30:12,108 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5714e-01
[rank0]:2025-12-28 20:30:12,095 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1691e-01
[rank2]:2025-12-28 20:30:55,813 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.6150e-01
[rank1]:2025-12-28 20:30:55,814 - Freezing Ratio: [Stage1] 0.00, Threshold: 8.3236e-01
[rank0]:2025-12-28 20:30:55,812 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 20:30:55,829 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0749e+00
[rank3]:2025-12-28 20:30:55,829 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.4801e-01
[rank3]:2025-12-28 20:31:00,710 - Avg. fwd time: 11.0647 / Avg. bwd time: 41.2574 / Avg. batch time: 478.1024 (ms) / GPU bubble ratio: 12.45%
[rank2]:2025-12-28 20:31:00,739 - Avg. fwd time: 7.4589 / Avg. bwd time: 15.8462 / Avg. batch time: 506.0554 (ms) / GPU bubble ratio: 63.16%
[rank1]:2025-12-28 20:31:00,773 - Avg. fwd time: 9.6800 / Avg. bwd time: 20.4661 / Avg. batch time: 541.0985 (ms) / GPU bubble ratio: 55.43%
[rank0]:2025-12-28 20:31:00,798 - Avg. fwd time: 8.9130 / Avg. bwd time: 19.3240 / Avg. batch time: 573.4451 (ms) / GPU bubble ratio: 60.61%
[rank2]:2025-12-28 20:31:00,818 -  step: 400  loss: -8.0000  grad_norm:  0.1072  memory: 12.26GiB(25.80%)  tps: 7,138  tflops: 55.80  mfu: 17.89%
[rank2]:2025-12-28 20:31:00,887 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2031_stage2_step400.svg
[rank1]:2025-12-28 20:31:00,821 -  step: 400  loss: -8.0000  grad_norm:  0.1072  memory: 15.15GiB(31.89%)  tps: 7,138  tflops: 55.80  mfu: 17.88%
[rank1]:2025-12-28 20:31:00,888 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2031_stage1_step400.svg
[rank0]:2025-12-28 20:31:00,822 -  step: 400  loss: -8.0000  grad_norm:  0.1072  memory: 17.08GiB(35.95%)  tps: 7,138  tflops: 55.80  mfu: 17.89%
[rank0]:2025-12-28 20:31:00,892 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2031_stage0_step400.svg
[rank3]:2025-12-28 20:31:00,830 -  step: 400  loss:  0.2212  grad_norm:  0.1072  memory: 28.29GiB(59.55%)  tps: 7,138  tflops: 55.80  mfu: 17.89%
[rank3]:2025-12-28 20:31:00,971 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2031_step400_rank3.svg
[rank3]:			> Batch Time: 528.70 ms, GPU Bubble Ratio: 60.68%, 63.58%, 71.09%, 25.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-65ms      | [S0,MB7,F]  65-9-74ms      | [S0,MB0,B]  251-16-268ms   | [S0,MB1,B]  288-16-305ms   | [S0,MB2,B]  327-16-343ms   | [S0,MB3,B]  365-16-381ms   | [S0,MB4,B]  401-16-418ms   | [S0,MB5,B]  439-16-456ms   | [S0,MB6,B]  476-16-493ms   | [S0,MB7,B]  512-16-528ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  130-10-141ms   | [S1,MB0,B]  235-13-248ms   | [S1,MB1,B]  271-13-285ms   | [S1,MB2,B]  310-13-324ms   | [S1,MB3,B]  348-13-362ms   | [S1,MB4,B]  385-13-398ms   | [S1,MB5,B]  423-13-436ms   | [S1,MB6,B]  460-13-473ms   | [S1,MB7,B]  495-13-509ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  127-8-135ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  257-11-268ms   | [S2,MB2,B]  296-11-307ms   | [S2,MB3,B]  334-11-345ms   | [S2,MB4,B]  370-11-382ms   | [S2,MB5,B]  408-10-419ms   | [S2,MB6,B]  445-10-456ms   | [S2,MB7,B]  481-10-492ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  124-11-136ms   | [S3,MB6,F]  143-11-154ms   | [S3,MB7,F]  162-11-173ms   | [S3,MB0,B]  179-34-214ms   | [S3,MB1,B]  214-36-250ms   | [S3,MB2,B]  250-38-289ms   | [S3,MB3,B]  289-38-327ms   | [S3,MB4,B]  327-38-365ms   | [S3,MB5,B]  364-38-402ms   | [S3,MB6,B]  402-39-441ms   | [S3,MB7,B]  439-39-478ms  
[rank2]:2025-12-28 20:31:01,042 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2031_rank2_stage2.svg
[rank2]:	> Counts Sum: 459, Total Sum: 1260 (36.43%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-28 20:31:01,037 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2031_rank1_stage1.svg
[rank1]:	> Counts Sum: 567, Total Sum: 1575 (36.00%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-28 20:31:01,065 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2031_rank0_stage0.svg
[rank0]:	> Counts Sum: 765, Total Sum: 1295 (59.07%), Ratio(%) per element: [0.0, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:31:01,020 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2031_stage3_step400.svg
[rank3]:2025-12-28 20:31:01,151 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2031_rank3_stage3.svg
[rank3]:	> Counts Sum: 306, Total Sum: 1015 (30.15%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:31:28,876 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 20:31:29,084 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 20:31:29,111 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 20:31:29,128 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 20:31:45,177 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3100e-01
[rank2]:2025-12-28 20:31:45,173 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9786e-01
[rank0]:2025-12-28 20:31:45,177 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4143e+00
[rank3]:2025-12-28 20:31:45,185 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1689e+00
[rank2]:2025-12-28 20:32:28,899 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.4354e+00
[rank1]:2025-12-28 20:32:28,899 - Freezing Ratio: [Stage1] 0.00, Threshold: 8.8642e+00
[rank0]:2025-12-28 20:32:28,915 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8205e+00
[rank3]:2025-12-28 20:32:28,915 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.6197e+00
[rank2]:2025-12-28 20:32:58,422 - Avg. fwd time: 7.4569 / Avg. bwd time: 15.8616 / Avg. batch time: 506.1693 (ms) / GPU bubble ratio: 63.15%
[rank3]:2025-12-28 20:32:58,393 - Avg. fwd time: 11.0637 / Avg. bwd time: 41.2698 / Avg. batch time: 478.1935 (ms) / GPU bubble ratio: 12.45%
[rank1]:2025-12-28 20:32:58,457 - Avg. fwd time: 9.6807 / Avg. bwd time: 20.4637 / Avg. batch time: 541.2068 (ms) / GPU bubble ratio: 55.44%
[rank0]:2025-12-28 20:32:58,482 - Avg. fwd time: 8.9325 / Avg. bwd time: 19.1665 / Avg. batch time: 573.3920 (ms) / GPU bubble ratio: 60.80%
[rank2]:2025-12-28 20:33:18,014 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.9033e-01
[rank1]:2025-12-28 20:33:18,019 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2793e-01
[rank0]:2025-12-28 20:33:18,018 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5837e-01
[rank3]:2025-12-28 20:33:18,026 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3569e+00
[rank1]:2025-12-28 20:34:01,821 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8406e+00
[rank0]:2025-12-28 20:34:01,836 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1581e+00
[rank3]:2025-12-28 20:34:01,836 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7898e+00
[rank2]:2025-12-28 20:34:01,820 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1514e+00
[rank1]:2025-12-28 20:34:51,090 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.4927e-01
[rank0]:2025-12-28 20:34:51,081 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 20:34:51,089 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9948e+00
[rank3]:2025-12-28 20:34:51,098 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7619e+00
[rank2]:2025-12-28 20:34:51,085 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7881e+00
[rank3]:2025-12-28 20:34:55,384 - Avg. fwd time: 11.0642 / Avg. bwd time: 41.2702 / Avg. batch time: 478.2007 (ms) / GPU bubble ratio: 12.45%
[rank2]:2025-12-28 20:34:55,405 - Avg. fwd time: 7.4574 / Avg. bwd time: 15.8552 / Avg. batch time: 506.1613 (ms) / GPU bubble ratio: 63.15%
[rank2]:2025-12-28 20:34:55,462 -  step: 450  loss: -8.0000  grad_norm:  0.1022  memory: 12.26GiB(25.80%)  tps: 6,982  tflops: 54.59  mfu: 17.50%
[rank1]:2025-12-28 20:34:55,427 - Avg. fwd time: 9.6841 / Avg. bwd time: 20.4359 / Avg. batch time: 541.1685 (ms) / GPU bubble ratio: 55.47%
[rank1]:2025-12-28 20:34:55,462 -  step: 450  loss: -8.0000  grad_norm:  0.1022  memory: 15.15GiB(31.89%)  tps: 6,983  tflops: 54.59  mfu: 17.50%
[rank0]:2025-12-28 20:34:55,453 - Avg. fwd time: 8.9492 / Avg. bwd time: 19.0264 / Avg. batch time: 573.2091 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-12-28 20:34:55,476 -  step: 450  loss: -8.0000  grad_norm:  0.1022  memory: 17.08GiB(35.95%)  tps: 6,982  tflops: 54.58  mfu: 17.49%
[rank3]:2025-12-28 20:34:55,478 -  step: 450  loss:  0.2430  grad_norm:  0.1022  memory: 28.29GiB(59.55%)  tps: 6,982  tflops: 54.59  mfu: 17.50%
[rank2]:2025-12-28 20:35:34,907 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.1462e-01
[rank1]:2025-12-28 20:35:34,907 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6860e-01
[rank0]:2025-12-28 20:35:34,922 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1987e-01
[rank3]:2025-12-28 20:35:34,922 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4239e-01
[rank1]:2025-12-28 20:36:24,121 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.4405e-02
[rank3]:2025-12-28 20:36:24,128 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9075e-01
[rank0]:2025-12-28 20:36:24,120 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7623e-01
[rank2]:2025-12-28 20:36:24,116 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6148e-01
[rank2]:2025-12-28 20:36:50,508 - Avg. fwd time: 7.4679 / Avg. bwd time: 15.7781 / Avg. batch time: 505.7278 (ms) / GPU bubble ratio: 63.23%
[rank1]:2025-12-28 20:36:50,531 - Avg. fwd time: 9.7003 / Avg. bwd time: 20.3143 / Avg. batch time: 540.6095 (ms) / GPU bubble ratio: 55.58%
[rank3]:2025-12-28 20:36:50,487 - Avg. fwd time: 11.0713 / Avg. bwd time: 41.2196 / Avg. batch time: 477.8534 (ms) / GPU bubble ratio: 12.46%
[rank0]:2025-12-28 20:36:50,557 - Avg. fwd time: 8.9648 / Avg. bwd time: 18.9011 / Avg. batch time: 572.5210 (ms) / GPU bubble ratio: 61.06%
[rank2]:2025-12-28 20:37:08,110 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4990e-01
[rank1]:2025-12-28 20:37:08,110 - Freezing Ratio: [Stage1] 0.00, Threshold: 6.3760e-01
[rank3]:2025-12-28 20:37:08,126 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2717e-01
[rank0]:2025-12-28 20:37:08,126 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3066e-01
[rank3]:2025-12-28 20:37:57,342 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6519e-01
[rank1]:2025-12-28 20:37:57,334 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4631e-01
[rank0]:2025-12-28 20:37:57,334 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0780e+00
[rank2]:2025-12-28 20:37:57,329 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7111e-01
[rank3]:2025-12-28 20:38:41,000 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0322e+00
[rank1]:2025-12-28 20:38:40,984 - Freezing Ratio: [Stage1] 0.00, Threshold: 9.5431e-01
[rank0]:2025-12-28 20:38:40,983 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 20:38:41,000 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8309e+00
[rank2]:2025-12-28 20:38:40,984 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4798e-01
[rank3]:2025-12-28 20:38:45,763 - Avg. fwd time: 11.0754 / Avg. bwd time: 41.1773 / Avg. batch time: 477.5473 (ms) / GPU bubble ratio: 12.46%
[rank2]:2025-12-28 20:38:45,793 - Avg. fwd time: 7.4749 / Avg. bwd time: 15.7252 / Avg. batch time: 505.3616 (ms) / GPU bubble ratio: 63.27%
[rank2]:2025-12-28 20:38:45,874 -  step: 500  loss: -8.0000  grad_norm:  0.1266  memory: 12.26GiB(25.80%)  tps: 7,111  tflops: 55.59  mfu: 17.82%
[rank3]:2025-12-28 20:38:45,886 -  step: 500  loss:  0.2400  grad_norm:  0.1266  memory: 28.29GiB(59.55%)  tps: 7,111  tflops: 55.59  mfu: 17.82%
[rank1]:2025-12-28 20:38:45,828 - Avg. fwd time: 9.7119 / Avg. bwd time: 20.2282 / Avg. batch time: 540.1540 (ms) / GPU bubble ratio: 55.66%
[rank1]:2025-12-28 20:38:45,877 -  step: 500  loss: -8.0000  grad_norm:  0.1266  memory: 15.15GiB(31.89%)  tps: 7,111  tflops: 55.59  mfu: 17.82%
[rank0]:2025-12-28 20:38:45,855 - Avg. fwd time: 8.9788 / Avg. bwd time: 18.7881 / Avg. batch time: 571.9497 (ms) / GPU bubble ratio: 61.16%
[rank0]:2025-12-28 20:38:45,878 -  step: 500  loss: -8.0000  grad_norm:  0.1266  memory: 17.08GiB(35.95%)  tps: 7,111  tflops: 55.59  mfu: 17.82%
[rank2]:2025-12-28 20:38:45,941 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2038_stage2_step500.svg
[rank1]:2025-12-28 20:38:45,939 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2038_stage1_step500.svg
[rank0]:2025-12-28 20:38:45,942 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2038_stage0_step500.svg
[rank3]:2025-12-28 20:38:46,023 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2038_step500_rank3.svg
[rank3]:			> Batch Time: 534.69 ms, GPU Bubble Ratio: 61.12%, 63.87%, 71.38%, 25.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-64ms      | [S0,MB7,F]  64-9-74ms      | [S0,MB0,B]  253-16-270ms   | [S0,MB1,B]  290-16-306ms   | [S0,MB2,B]  329-16-345ms   | [S0,MB3,B]  367-16-384ms   | [S0,MB4,B]  405-16-422ms   | [S0,MB5,B]  444-16-461ms   | [S0,MB6,B]  483-16-499ms   | [S0,MB7,B]  518-16-534ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-123ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  236-13-250ms   | [S1,MB1,B]  273-13-287ms   | [S1,MB2,B]  312-13-325ms   | [S1,MB3,B]  350-13-364ms   | [S1,MB4,B]  388-13-402ms   | [S1,MB5,B]  427-13-441ms   | [S1,MB6,B]  466-13-479ms   | [S1,MB7,B]  501-13-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-10-232ms   | [S2,MB1,B]  259-11-270ms   | [S2,MB2,B]  297-11-308ms   | [S2,MB3,B]  336-11-347ms   | [S2,MB4,B]  374-11-385ms   | [S2,MB5,B]  413-10-424ms   | [S2,MB6,B]  452-10-463ms   | [S2,MB7,B]  487-10-498ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  124-11-136ms   | [S3,MB6,F]  143-11-155ms   | [S3,MB7,F]  162-11-174ms   | [S3,MB0,B]  180-34-214ms   | [S3,MB1,B]  214-38-252ms   | [S3,MB2,B]  252-38-291ms   | [S3,MB3,B]  290-38-329ms   | [S3,MB4,B]  329-39-368ms   | [S3,MB5,B]  367-39-406ms   | [S3,MB6,B]  406-39-445ms   | [S3,MB7,B]  445-39-484ms  
[rank3]:2025-12-28 20:38:46,067 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2038_stage3_step500.svg
[rank1]:2025-12-28 20:38:46,083 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2038_rank1_stage1.svg
[rank1]:	> Counts Sum: 747, Total Sum: 2025 (36.89%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-28 20:38:46,099 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2038_rank0_stage0.svg
[rank0]:	> Counts Sum: 1035, Total Sum: 1665 (62.16%), Ratio(%) per element: [0.0, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:38:46,094 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2038_rank2_stage2.svg
[rank2]:	> Counts Sum: 594, Total Sum: 1620 (36.67%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:38:46,203 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2038_rank3_stage3.svg
[rank3]:	> Counts Sum: 396, Total Sum: 1305 (30.34%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-28 20:39:30,170 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6489e-01
[rank0]:2025-12-28 20:39:30,170 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.9774e-01
[rank2]:2025-12-28 20:39:30,166 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2348e-01
[rank3]:2025-12-28 20:39:30,178 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2936e-01
[rank0]:2025-12-28 20:40:13,740 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4360e+00
[rank1]:2025-12-28 20:40:13,725 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1294e+00
[rank2]:2025-12-28 20:40:13,725 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5718e+00
[rank3]:2025-12-28 20:40:13,740 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7018e+00
[rank2]:2025-12-28 20:40:42,935 - Avg. fwd time: 7.4720 / Avg. bwd time: 15.7413 / Avg. batch time: 505.3576 (ms) / GPU bubble ratio: 63.25%
[rank3]:2025-12-28 20:40:42,905 - Avg. fwd time: 11.0722 / Avg. bwd time: 41.1767 / Avg. batch time: 477.5157 (ms) / GPU bubble ratio: 12.47%
[rank1]:2025-12-28 20:40:42,970 - Avg. fwd time: 9.7099 / Avg. bwd time: 20.2371 / Avg. batch time: 540.1589 (ms) / GPU bubble ratio: 55.65%
[rank0]:2025-12-28 20:40:42,997 - Avg. fwd time: 8.9898 / Avg. bwd time: 18.6853 / Avg. batch time: 571.8476 (ms) / GPU bubble ratio: 61.28%
[rank2]:2025-12-28 20:41:02,622 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2442e-01
[rank3]:2025-12-28 20:41:02,633 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5085e-01
[rank0]:2025-12-28 20:41:02,625 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3584e+00
[rank1]:2025-12-28 20:41:02,626 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4661e-01
[rank1]:2025-12-28 20:41:46,047 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3986e+00
[rank2]:2025-12-28 20:41:46,047 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.1059e-01
[rank3]:2025-12-28 20:41:46,063 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2489e+00
[rank0]:2025-12-28 20:41:46,062 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8256e-01
[rank0]:2025-12-28 20:42:35,013 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 20:42:35,020 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1251e+00
[rank1]:2025-12-28 20:42:35,021 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2984e-01
[rank2]:2025-12-28 20:42:35,016 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5209e-01
[rank3]:2025-12-28 20:42:35,029 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8057e-01
[rank2]:2025-12-28 20:42:39,366 - Avg. fwd time: 7.4714 / Avg. bwd time: 15.7401 / Avg. batch time: 505.2508 (ms) / GPU bubble ratio: 63.25%
[rank3]:2025-12-28 20:42:39,344 - Avg. fwd time: 11.0702 / Avg. bwd time: 41.1665 / Avg. batch time: 477.4171 (ms) / GPU bubble ratio: 12.47%
[rank0]:2025-12-28 20:42:39,417 - Avg. fwd time: 9.0002 / Avg. bwd time: 18.5915 / Avg. batch time: 571.6292 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-12-28 20:42:39,390 - Avg. fwd time: 9.7110 / Avg. bwd time: 20.2240 / Avg. batch time: 540.0384 (ms) / GPU bubble ratio: 55.66%
[rank1]:2025-12-28 20:42:39,426 -  step: 550  loss: -8.0000  grad_norm:  0.0707  memory: 15.15GiB(31.89%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank2]:2025-12-28 20:42:39,426 -  step: 550  loss: -8.0000  grad_norm:  0.0707  memory: 12.26GiB(25.80%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank3]:2025-12-28 20:42:39,443 -  step: 550  loss:  0.2436  grad_norm:  0.0707  memory: 28.29GiB(59.55%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank0]:2025-12-28 20:42:39,440 -  step: 550  loss: -8.0000  grad_norm:  0.0707  memory: 17.08GiB(35.95%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank1]:2025-12-28 20:43:18,777 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9175e+00
[rank2]:2025-12-28 20:43:18,776 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2464e+00
[rank3]:2025-12-28 20:43:18,792 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.7845e-01
[rank0]:2025-12-28 20:43:18,792 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5170e-01
[rank2]:2025-12-28 20:44:07,995 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7824e-01
[rank3]:2025-12-28 20:44:08,008 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8121e-01
[rank0]:2025-12-28 20:44:07,999 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9295e-01
[rank1]:2025-12-28 20:44:08,000 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1392e-01
[rank2]:2025-12-28 20:44:34,111 - Avg. fwd time: 7.4793 / Avg. bwd time: 15.6801 / Avg. batch time: 504.8631 (ms) / GPU bubble ratio: 63.30%
[rank3]:2025-12-28 20:44:34,089 - Avg. fwd time: 11.0749 / Avg. bwd time: 41.1218 / Avg. batch time: 477.0962 (ms) / GPU bubble ratio: 12.48%
[rank0]:2025-12-28 20:44:34,162 - Avg. fwd time: 9.0103 / Avg. bwd time: 18.5063 / Avg. batch time: 571.0567 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-12-28 20:44:34,135 - Avg. fwd time: 9.7231 / Avg. bwd time: 20.1318 / Avg. batch time: 539.5553 (ms) / GPU bubble ratio: 55.73%
[rank3]:2025-12-28 20:44:51,681 - Freezing Ratio: [Stage3] 0.00, Threshold: 8.5659e-01
[rank0]:2025-12-28 20:44:51,681 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9976e+00
[rank1]:2025-12-28 20:44:51,665 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.4716e-01
[rank2]:2025-12-28 20:44:51,666 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2792e+00
[rank2]:2025-12-28 20:45:40,580 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3022e-01
[rank3]:2025-12-28 20:45:40,592 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3706e-01
[rank0]:2025-12-28 20:45:40,584 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6375e-01
[rank1]:2025-12-28 20:45:40,585 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.3694e-02
[rank2]:2025-12-28 20:46:24,159 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.9420e-01
[rank3]:2025-12-28 20:46:24,175 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0148e-01
[rank0]:2025-12-28 20:46:24,158 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 20:46:24,175 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4495e+00
[rank1]:2025-12-28 20:46:24,159 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1454e+00
[rank2]:2025-12-28 20:46:29,082 - Avg. fwd time: 7.4847 / Avg. bwd time: 15.6398 / Avg. batch time: 504.5431 (ms) / GPU bubble ratio: 63.33%
[rank3]:2025-12-28 20:46:29,051 - Avg. fwd time: 11.0773 / Avg. bwd time: 41.0853 / Avg. batch time: 476.8220 (ms) / GPU bubble ratio: 12.48%
[rank1]:2025-12-28 20:46:29,118 - Avg. fwd time: 9.7321 / Avg. bwd time: 20.0679 / Avg. batch time: 539.1698 (ms) / GPU bubble ratio: 55.78%
[rank2]:2025-12-28 20:46:29,164 -  step: 600  loss: -8.0000  grad_norm:  0.1216  memory: 12.26GiB(25.80%)  tps: 7,132  tflops: 55.75  mfu: 17.87%
[rank3]:2025-12-28 20:46:29,177 -  step: 600  loss:  0.2311  grad_norm:  0.1216  memory: 28.29GiB(59.55%)  tps: 7,132  tflops: 55.75  mfu: 17.87%
[rank0]:2025-12-28 20:46:29,145 - Avg. fwd time: 9.0202 / Avg. bwd time: 18.4284 / Avg. batch time: 570.5906 (ms) / GPU bubble ratio: 61.52%
[rank0]:2025-12-28 20:46:29,168 -  step: 600  loss: -8.0000  grad_norm:  0.1216  memory: 17.08GiB(35.95%)  tps: 7,132  tflops: 55.75  mfu: 17.87%
[rank0]:2025-12-28 20:46:29,231 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2046_stage0_step600.svg
[rank1]:2025-12-28 20:46:29,167 -  step: 600  loss: -8.0000  grad_norm:  0.1216  memory: 15.15GiB(31.89%)  tps: 7,132  tflops: 55.75  mfu: 17.87%
[rank1]:2025-12-28 20:46:29,231 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2046_stage1_step600.svg
[rank2]:2025-12-28 20:46:29,231 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2046_stage2_step600.svg
[rank2]:2025-12-28 20:46:29,385 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2046_rank2_stage2.svg
[rank2]:	> Counts Sum: 729, Total Sum: 1980 (36.82%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:46:29,314 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2046_step600_rank3.svg
[rank3]:			> Batch Time: 528.69 ms, GPU Bubble Ratio: 60.74%, 63.62%, 71.13%, 25.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  251-16-268ms   | [S0,MB1,B]  288-16-305ms   | [S0,MB2,B]  326-16-343ms   | [S0,MB3,B]  364-16-381ms   | [S0,MB4,B]  401-16-418ms   | [S0,MB5,B]  438-16-455ms   | [S0,MB6,B]  476-16-493ms   | [S0,MB7,B]  512-16-528ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-103ms    | [S1,MB6,F]  111-10-122ms   | [S1,MB7,F]  130-10-141ms   | [S1,MB0,B]  234-13-248ms   | [S1,MB1,B]  272-13-285ms   | [S1,MB2,B]  310-13-323ms   | [S1,MB3,B]  347-13-361ms   | [S1,MB4,B]  384-13-398ms   | [S1,MB5,B]  422-13-435ms   | [S1,MB6,B]  459-13-473ms   | [S1,MB7,B]  495-13-509ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  108-8-116ms    | [S2,MB6,F]  127-8-135ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  220-10-231ms   | [S2,MB1,B]  257-10-268ms   | [S2,MB2,B]  295-10-306ms   | [S2,MB3,B]  333-11-344ms   | [S2,MB4,B]  370-11-381ms   | [S2,MB5,B]  407-10-418ms   | [S2,MB6,B]  445-10-456ms   | [S2,MB7,B]  481-10-492ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  49-10-60ms     | [S3,MB2,F]  68-10-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  105-11-116ms   | [S3,MB5,F]  124-11-135ms   | [S3,MB6,F]  143-11-154ms   | [S3,MB7,F]  162-11-173ms   | [S3,MB0,B]  179-34-213ms   | [S3,MB1,B]  213-37-251ms   | [S3,MB2,B]  251-38-289ms   | [S3,MB3,B]  289-37-327ms   | [S3,MB4,B]  326-38-364ms   | [S3,MB5,B]  363-38-402ms   | [S3,MB6,B]  401-38-439ms   | [S3,MB7,B]  439-39-478ms  
[rank3]:2025-12-28 20:46:29,360 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2046_stage3_step600.svg
[rank0]:2025-12-28 20:46:29,388 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2046_rank0_stage0.svg
[rank0]:	> Counts Sum: 1305, Total Sum: 2035 (64.13%), Ratio(%) per element: [0.0, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-28 20:46:29,379 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2046_rank1_stage1.svg
[rank1]:	> Counts Sum: 927, Total Sum: 2475 (37.45%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 45.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:46:29,489 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2046_rank3_stage3.svg
[rank3]:	> Counts Sum: 486, Total Sum: 1595 (30.47%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:47:13,500 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7558e-01
[rank3]:2025-12-28 20:47:13,513 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5486e-01
[rank1]:2025-12-28 20:47:13,504 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.3202e-02
[rank0]:2025-12-28 20:47:13,504 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1212e-01
[rank2]:2025-12-28 20:47:57,147 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.0638e-01
[rank3]:2025-12-28 20:47:57,163 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.1504e-01
[rank1]:2025-12-28 20:47:57,148 - Freezing Ratio: [Stage1] 0.00, Threshold: 6.0005e-01
[rank0]:2025-12-28 20:47:57,163 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2039e+00
[rank2]:2025-12-28 20:48:26,621 - Avg. fwd time: 7.4823 / Avg. bwd time: 15.6575 / Avg. batch time: 504.6463 (ms) / GPU bubble ratio: 63.32%
[rank3]:2025-12-28 20:48:26,589 - Avg. fwd time: 11.0758 / Avg. bwd time: 41.0963 / Avg. batch time: 476.8970 (ms) / GPU bubble ratio: 12.48%
[rank1]:2025-12-28 20:48:26,657 - Avg. fwd time: 9.7305 / Avg. bwd time: 20.0837 / Avg. batch time: 539.2901 (ms) / GPU bubble ratio: 55.77%
[rank0]:2025-12-28 20:48:26,685 - Avg. fwd time: 9.0289 / Avg. bwd time: 18.3569 / Avg. batch time: 570.6376 (ms) / GPU bubble ratio: 61.61%
[rank2]:2025-12-28 20:48:46,217 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3434e-01
[rank3]:2025-12-28 20:48:46,229 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.7900e-01
[rank1]:2025-12-28 20:48:46,221 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0595e-01
[rank0]:2025-12-28 20:48:46,220 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6738e+00
[rank2]:2025-12-28 20:49:29,991 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6974e+00
[rank3]:2025-12-28 20:49:30,008 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.7768e-01
[rank1]:2025-12-28 20:49:29,991 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6598e+00
[rank0]:2025-12-28 20:49:30,007 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6886e+00
[rank1]:2025-12-28 20:50:19,101 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8993e-01
[rank0]:2025-12-28 20:50:19,093 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 20:50:19,100 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0464e+00
[rank2]:2025-12-28 20:50:19,097 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6139e+00
[rank3]:2025-12-28 20:50:19,109 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5835e+00
[rank3]:2025-12-28 20:50:23,402 - Avg. fwd time: 11.0753 / Avg. bwd time: 41.0956 / Avg. batch time: 476.8856 (ms) / GPU bubble ratio: 12.48%
[rank2]:2025-12-28 20:50:23,425 - Avg. fwd time: 7.4819 / Avg. bwd time: 15.6610 / Avg. batch time: 504.6346 (ms) / GPU bubble ratio: 63.31%
[rank2]:2025-12-28 20:50:23,490 -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory: 12.26GiB(25.80%)  tps: 6,992  tflops: 54.66  mfu: 17.52%
[rank1]:2025-12-28 20:50:23,453 - Avg. fwd time: 9.7316 / Avg. bwd time: 20.0809 / Avg. batch time: 539.2762 (ms) / GPU bubble ratio: 55.77%
[rank1]:2025-12-28 20:50:23,490 -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory: 15.15GiB(31.89%)  tps: 6,992  tflops: 54.66  mfu: 17.52%
[rank0]:2025-12-28 20:50:23,481 - Avg. fwd time: 9.0371 / Avg. bwd time: 18.2912 / Avg. batch time: 570.5572 (ms) / GPU bubble ratio: 61.68%
[rank0]:2025-12-28 20:50:23,505 -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory: 17.08GiB(35.95%)  tps: 6,992  tflops: 54.66  mfu: 17.52%
[rank3]:2025-12-28 20:50:23,507 -  step: 650  loss:  0.2447  grad_norm:  0.0683  memory: 28.29GiB(59.55%)  tps: 6,992  tflops: 54.66  mfu: 17.52%
[rank2]:2025-12-28 20:51:02,737 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5889e+00
[rank3]:2025-12-28 20:51:02,752 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1484e+00
[rank1]:2025-12-28 20:51:02,737 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1141e+00
[rank0]:2025-12-28 20:51:02,752 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4050e+00
[rank1]:2025-12-28 20:51:51,738 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0381e-01
[rank0]:2025-12-28 20:51:51,738 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7478e+00
[rank2]:2025-12-28 20:51:51,734 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5343e-01
[rank3]:2025-12-28 20:51:51,747 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0001e+00
[rank2]:2025-12-28 20:52:17,990 - Avg. fwd time: 7.4885 / Avg. bwd time: 15.6137 / Avg. batch time: 504.2830 (ms) / GPU bubble ratio: 63.35%
[rank3]:2025-12-28 20:52:17,967 - Avg. fwd time: 11.0785 / Avg. bwd time: 41.0552 / Avg. batch time: 476.5855 (ms) / GPU bubble ratio: 12.49%
[rank1]:2025-12-28 20:52:18,015 - Avg. fwd time: 9.7418 / Avg. bwd time: 20.0095 / Avg. batch time: 538.8522 (ms) / GPU bubble ratio: 55.83%
[rank0]:2025-12-28 20:52:18,044 - Avg. fwd time: 9.0454 / Avg. bwd time: 18.2302 / Avg. batch time: 570.0707 (ms) / GPU bubble ratio: 61.72%
[rank2]:2025-12-28 20:52:35,418 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5340e+00
[rank3]:2025-12-28 20:52:35,434 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5215e+00
[rank1]:2025-12-28 20:52:35,418 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5713e+00
[rank0]:2025-12-28 20:52:35,433 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5269e+00
[rank2]:2025-12-28 20:53:24,511 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0380e-01
[rank3]:2025-12-28 20:53:24,525 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8928e-01
[rank1]:2025-12-28 20:53:24,515 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0942e-02
[rank0]:2025-12-28 20:53:24,514 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7101e-01
[rank2]:2025-12-28 20:54:08,000 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1478e+00
[rank1]:2025-12-28 20:54:08,000 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9360e+00
[rank0]:2025-12-28 20:54:07,999 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-28 20:54:08,015 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0602e+00
[rank3]:2025-12-28 20:54:08,016 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3083e+00
[rank3]:2025-12-28 20:54:12,786 - Avg. fwd time: 11.0801 / Avg. bwd time: 41.0236 / Avg. batch time: 476.3436 (ms) / GPU bubble ratio: 12.49%
[rank2]:2025-12-28 20:54:12,818 - Avg. fwd time: 7.4927 / Avg. bwd time: 15.5815 / Avg. batch time: 504.0045 (ms) / GPU bubble ratio: 63.37%
[rank2]:2025-12-28 20:54:12,903 -  step: 700  loss: -8.0000  grad_norm:  0.1138  memory: 12.26GiB(25.80%)  tps: 7,142  tflops: 55.83  mfu: 17.89%
[rank1]:2025-12-28 20:54:12,856 - Avg. fwd time: 9.7486 / Avg. bwd time: 19.9591 / Avg. batch time: 538.5211 (ms) / GPU bubble ratio: 55.87%
[rank1]:2025-12-28 20:54:12,907 -  step: 700  loss: -8.0000  grad_norm:  0.1138  memory: 15.15GiB(31.89%)  tps: 7,142  tflops: 55.83  mfu: 17.89%
[rank0]:2025-12-28 20:54:12,884 - Avg. fwd time: 9.0524 / Avg. bwd time: 18.1734 / Avg. batch time: 569.6809 (ms) / GPU bubble ratio: 61.77%
[rank0]:2025-12-28 20:54:12,908 -  step: 700  loss: -8.0000  grad_norm:  0.1138  memory: 17.08GiB(35.95%)  tps: 7,142  tflops: 55.83  mfu: 17.90%
[rank2]:2025-12-28 20:54:12,970 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2054_stage2_step700.svg
[rank3]:2025-12-28 20:54:12,916 -  step: 700  loss:  0.2093  grad_norm:  0.1138  memory: 28.29GiB(59.55%)  tps: 7,142  tflops: 55.83  mfu: 17.89%
[rank1]:2025-12-28 20:54:12,973 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2054_stage1_step700.svg
[rank0]:2025-12-28 20:54:12,970 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2054_stage0_step700.svg
[rank3]:2025-12-28 20:54:13,062 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2054_step700_rank3.svg
[rank3]:			> Batch Time: 531.19 ms, GPU Bubble Ratio: 60.85%, 63.63%, 71.18%, 25.59%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-64ms      | [S0,MB7,F]  64-9-74ms      | [S0,MB0,B]  252-16-269ms   | [S0,MB1,B]  289-16-305ms   | [S0,MB2,B]  327-16-344ms   | [S0,MB3,B]  365-16-382ms   | [S0,MB4,B]  404-16-420ms   | [S0,MB5,B]  441-16-457ms   | [S0,MB6,B]  479-16-496ms   | [S0,MB7,B]  514-16-531ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  130-10-141ms   | [S1,MB0,B]  235-13-249ms   | [S1,MB1,B]  272-13-286ms   | [S1,MB2,B]  310-13-324ms   | [S1,MB3,B]  349-13-362ms   | [S1,MB4,B]  387-13-400ms   | [S1,MB5,B]  424-13-438ms   | [S1,MB6,B]  462-13-476ms   | [S1,MB7,B]  497-13-511ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  127-8-136ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  220-10-231ms   | [S2,MB1,B]  258-11-269ms   | [S2,MB2,B]  296-11-307ms   | [S2,MB3,B]  335-11-346ms   | [S2,MB4,B]  372-11-383ms   | [S2,MB5,B]  410-10-421ms   | [S2,MB6,B]  448-10-459ms   | [S2,MB7,B]  483-10-493ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  49-11-60ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  124-11-136ms   | [S3,MB6,F]  143-11-154ms   | [S3,MB7,F]  162-11-174ms   | [S3,MB0,B]  180-34-214ms   | [S3,MB1,B]  214-37-251ms   | [S3,MB2,B]  251-38-289ms   | [S3,MB3,B]  289-37-327ms   | [S3,MB4,B]  328-38-366ms   | [S3,MB5,B]  366-38-404ms   | [S3,MB6,B]  403-39-442ms   | [S3,MB7,B]  441-39-480ms  
[rank3]:2025-12-28 20:54:13,109 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2054_stage3_step700.svg
[rank1]:2025-12-28 20:54:13,119 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2054_rank1_stage1.svg
[rank1]:	> Counts Sum: 1107, Total Sum: 2925 (37.85%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 46.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-28 20:54:13,126 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2054_rank0_stage0.svg
[rank0]:	> Counts Sum: 1575, Total Sum: 2405 (65.49%), Ratio(%) per element: [0.0, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:54:13,119 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2054_rank2_stage2.svg
[rank2]:	> Counts Sum: 864, Total Sum: 2340 (36.92%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 20:54:13,239 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2054_rank3_stage3.svg
[rank3]:	> Counts Sum: 576, Total Sum: 1885 (30.56%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 20:54:57,128 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5069e-01
[rank3]:2025-12-28 20:54:57,140 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2872e-01
[rank1]:2025-12-28 20:54:57,133 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.9722e-02
[rank0]:2025-12-28 20:54:57,131 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2911e+00
[rank2]:2025-12-28 20:55:40,566 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4730e-01
[rank3]:2025-12-28 20:55:40,582 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.9245e-01
[rank1]:2025-12-28 20:55:40,566 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1730e-01
[rank0]:2025-12-28 20:55:40,582 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.2178e-01
[rank3]:2025-12-28 20:56:09,749 - Avg. fwd time: 11.0769 / Avg. bwd time: 41.0258 / Avg. batch time: 476.3342 (ms) / GPU bubble ratio: 12.49%
[rank2]:2025-12-28 20:56:09,782 - Avg. fwd time: 7.4899 / Avg. bwd time: 15.5976 / Avg. batch time: 504.0223 (ms) / GPU bubble ratio: 63.35%
[rank1]:2025-12-28 20:56:09,819 - Avg. fwd time: 9.7459 / Avg. bwd time: 19.9755 / Avg. batch time: 538.5564 (ms) / GPU bubble ratio: 55.85%
[rank0]:2025-12-28 20:56:09,848 - Avg. fwd time: 9.0580 / Avg. bwd time: 18.1200 / Avg. batch time: 569.6602 (ms) / GPU bubble ratio: 61.83%
[rank2]:2025-12-28 20:56:29,463 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4603e-01
[rank3]:2025-12-28 20:56:29,475 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9649e-01
[rank1]:2025-12-28 20:56:29,468 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6713e-01
[rank0]:2025-12-28 20:56:29,467 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5815e-01
[rank1]:2025-12-28 20:57:12,960 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3887e+00
[rank3]:2025-12-28 20:57:12,975 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6587e+00
[rank2]:2025-12-28 20:57:12,960 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8246e+00
[rank0]:2025-12-28 20:57:12,975 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1287e+00
[rank1]:2025-12-28 20:58:01,936 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1530e-01
[rank3]:2025-12-28 20:58:01,943 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5401e+00
[rank2]:2025-12-28 20:58:01,931 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5871e-01
[rank0]:2025-12-28 20:58:01,927 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-28 20:58:01,935 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1169e+00
[rank3]:2025-12-28 20:58:06,254 - Avg. fwd time: 11.0761 / Avg. bwd time: 41.0235 / Avg. batch time: 476.3088 (ms) / GPU bubble ratio: 12.49%
[rank2]:2025-12-28 20:58:06,278 - Avg. fwd time: 7.4890 / Avg. bwd time: 15.6016 / Avg. batch time: 503.9975 (ms) / GPU bubble ratio: 63.35%
[rank1]:2025-12-28 20:58:06,304 - Avg. fwd time: 9.7456 / Avg. bwd time: 19.9755 / Avg. batch time: 538.5313 (ms) / GPU bubble ratio: 55.85%
[rank1]:2025-12-28 20:58:06,342 -  step: 750  loss: -8.0000  grad_norm:  0.0843  memory: 15.15GiB(31.89%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank3]:2025-12-28 20:58:06,358 -  step: 750  loss:  0.2511  grad_norm:  0.0843  memory: 28.29GiB(59.55%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank2]:2025-12-28 20:58:06,342 -  step: 750  loss: -8.0000  grad_norm:  0.0843  memory: 12.26GiB(25.80%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank0]:2025-12-28 20:58:06,333 - Avg. fwd time: 9.0633 / Avg. bwd time: 18.0702 / Avg. batch time: 569.5835 (ms) / GPU bubble ratio: 61.89%
[rank0]:2025-12-28 20:58:06,356 -  step: 750  loss: -8.0000  grad_norm:  0.0843  memory: 17.08GiB(35.95%)  tps: 7,018  tflops: 54.87  mfu: 17.59%
[rank2]:2025-12-28 20:58:45,666 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.9554e-01
[rank0]:2025-12-28 20:58:45,681 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1026e-01
[rank1]:2025-12-28 20:58:45,666 - Freezing Ratio: [Stage1] 0.00, Threshold: 6.7456e-01
[rank3]:2025-12-28 20:58:45,682 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2714e+00
[rank2]:2025-12-28 20:59:34,924 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8577e-01
[rank0]:2025-12-28 20:59:34,928 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4047e+00
[rank1]:2025-12-28 20:59:34,928 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4784e-01
[rank3]:2025-12-28 20:59:34,937 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0358e-01
[rank3]:2025-12-28 21:00:01,089 - Avg. fwd time: 11.0798 / Avg. bwd time: 40.9969 / Avg. batch time: 476.1258 (ms) / GPU bubble ratio: 12.50%
[rank2]:2025-12-28 21:00:01,114 - Avg. fwd time: 7.4944 / Avg. bwd time: 15.5618 / Avg. batch time: 503.7702 (ms) / GPU bubble ratio: 63.39%
[rank0]:2025-12-28 21:00:01,170 - Avg. fwd time: 9.0688 / Avg. bwd time: 18.0238 / Avg. batch time: 569.2462 (ms) / GPU bubble ratio: 61.92%
[rank1]:2025-12-28 21:00:01,140 - Avg. fwd time: 9.7537 / Avg. bwd time: 19.9159 / Avg. batch time: 538.2421 (ms) / GPU bubble ratio: 55.90%
[rank3]:2025-12-28 21:00:18,755 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7211e+00
[rank2]:2025-12-28 21:00:18,740 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3103e+00
[rank0]:2025-12-28 21:00:18,755 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7340e+00
[rank1]:2025-12-28 21:00:18,740 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1946e+00
[rank1]:2025-12-28 21:01:07,982 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6503e-01
[rank3]:2025-12-28 21:01:07,989 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9720e-01
[rank0]:2025-12-28 21:01:07,981 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9015e-01
[rank2]:2025-12-28 21:01:07,977 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4486e-01
[rank0]:2025-12-28 21:01:51,899 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-28 21:01:51,900 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9754e+00
[rank1]:2025-12-28 21:01:51,900 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9311e+00
[rank3]:2025-12-28 21:01:51,915 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7482e+00
[rank0]:2025-12-28 21:01:51,915 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4812e+00
[rank3]:2025-12-28 21:01:56,809 - Avg. fwd time: 11.0827 / Avg. bwd time: 40.9843 / Avg. batch time: 476.0471 (ms) / GPU bubble ratio: 12.50%
[rank2]:2025-12-28 21:01:56,843 - Avg. fwd time: 7.4982 / Avg. bwd time: 15.5353 / Avg. batch time: 503.6621 (ms) / GPU bubble ratio: 63.41%
[rank0]:2025-12-28 21:01:56,910 - Avg. fwd time: 9.0739 / Avg. bwd time: 17.9806 / Avg. batch time: 569.0534 (ms) / GPU bubble ratio: 61.97%
[rank1]:2025-12-28 21:01:56,880 - Avg. fwd time: 9.7597 / Avg. bwd time: 19.8746 / Avg. batch time: 538.0928 (ms) / GPU bubble ratio: 55.94%
[rank1]:2025-12-28 21:01:56,932 -  step: 800  loss: -8.0000  grad_norm:  0.1164  memory: 15.15GiB(31.89%)  tps: 7,105  tflops: 55.55  mfu: 17.80%
[rank1]:2025-12-28 21:01:56,932 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1164  tps: 7,432  tflops: 58.10  mfu: 16.99%
[rank1]:2025-12-28 21:01:56,933 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 21:01:56,933 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 21:01:56,941 -  step: 800  loss:  0.2499  grad_norm:  0.1164  memory: 28.29GiB(59.55%)  tps: 7,106  tflops: 55.55  mfu: 17.80%
[rank3]:2025-12-28 21:01:56,942 - â„¹ï¸ final step: 800  loss:  0.2499  grad_norm:  0.1164  tps: 7,437  tflops: 58.14  mfu: 17.12%
[rank3]:2025-12-28 21:01:56,942 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 21:01:56,943 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-28 21:01:56,929 -  step: 800  loss: -8.0000  grad_norm:  0.1164  memory: 12.26GiB(25.80%)  tps: 7,105  tflops: 55.55  mfu: 17.80%
[rank2]:2025-12-28 21:01:56,929 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1164  tps: 7,432  tflops: 58.10  mfu: 16.98%
[rank2]:2025-12-28 21:01:56,929 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 21:01:56,930 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 21:01:56,933 -  step: 800  loss: -8.0000  grad_norm:  0.1164  memory: 17.08GiB(35.95%)  tps: 7,106  tflops: 55.55  mfu: 17.80%
[rank0]:2025-12-28 21:01:56,933 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1164  tps: 7,431  tflops: 58.10  mfu: 16.97%
[rank0]:2025-12-28 21:01:56,933 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 21:01:56,934 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 21:01:58,914 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-28 21:01:58,984 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank2/251228_2101_stage2_final800.svg
[rank0]:2025-12-28 21:01:58,984 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank0/251228_2101_stage0_final800.svg
[rank1]:2025-12-28 21:01:58,987 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank1/251228_2101_stage1_final800.svg
[rank3]:2025-12-28 21:01:59,073 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2101_final800_rank3.svg
[rank3]:			> Batch Time: 587.20 ms, GPU Bubble Ratio: 64.74%, 54.32%, 64.65%, 28.04%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  261-16-277ms   | [S0,MB1,B]  310-16-327ms   | [S0,MB2,B]  353-16-369ms   | [S0,MB3,B]  397-16-413ms   | [S0,MB4,B]  440-16-457ms   | [S0,MB5,B]  484-16-501ms   | [S0,MB6,B]  529-16-545ms   | [S0,MB7,B]  570-16-587ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-9-45ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-9-83ms      | [S1,MB5,F]  92-9-101ms     | [S1,MB6,F]  111-8-120ms    | [S1,MB7,F]  129-8-138ms    | [S1,MB0,B]  238-20-259ms   | [S1,MB1,B]  282-24-306ms   | [S1,MB2,B]  325-24-349ms   | [S1,MB3,B]  368-24-393ms   | [S1,MB4,B]  412-24-437ms   | [S1,MB5,B]  456-24-481ms   | [S1,MB6,B]  500-24-525ms   | [S1,MB7,B]  542-24-567ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-7-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  89-6-96ms      | [S2,MB5,F]  108-6-114ms    | [S2,MB6,F]  126-6-133ms    | [S2,MB7,F]  144-6-151ms    | [S2,MB0,B]  221-16-237ms   | [S2,MB1,B]  261-19-280ms   | [S2,MB2,B]  302-19-322ms   | [S2,MB3,B]  346-19-365ms   | [S2,MB4,B]  389-19-409ms   | [S2,MB5,B]  433-19-453ms   | [S2,MB6,B]  478-19-497ms   | [S2,MB7,B]  519-19-538ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  86-10-97ms     | [S3,MB4,F]  104-10-115ms   | [S3,MB5,F]  123-10-134ms   | [S3,MB6,F]  141-10-152ms   | [S3,MB7,F]  160-10-171ms   | [S3,MB0,B]  177-35-212ms   | [S3,MB1,B]  214-40-255ms   | [S3,MB2,B]  254-41-296ms   | [S3,MB3,B]  296-42-338ms   | [S3,MB4,B]  339-43-382ms   | [S3,MB5,B]  383-43-426ms   | [S3,MB6,B]  427-43-470ms   | [S3,MB7,B]  471-43-515ms  
[rank1]:2025-12-28 21:01:59,140 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2101_rank1_stage1.svg
[rank1]:	> Counts Sum: 1287, Total Sum: 3375 (38.13%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-28 21:01:59,140 - Destroying the purge thread.
[rank3]:2025-12-28 21:01:59,203 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/pipeline_schedule/251228_2101_thry_final800_rank3.svg
[rank3]:			> Batch Time: 301.78 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-9-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-9-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  155-18-173ms   | [S0,MB1,B]  173-18-192ms   | [S0,MB2,B]  192-18-210ms   | [S0,MB3,B]  210-18-228ms   | [S0,MB4,B]  228-18-246ms   | [S0,MB5,B]  246-18-265ms   | [S0,MB6,B]  265-18-283ms   | [S0,MB7,B]  283-18-301ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-18ms       | [S1,MB1,F]  18-9-27ms      | [S1,MB2,F]  27-9-36ms      | [S1,MB3,F]  36-9-45ms      | [S1,MB4,F]  45-9-54ms      | [S1,MB5,F]  54-9-64ms      | [S1,MB6,F]  64-9-73ms      | [S1,MB7,F]  73-9-82ms      | [S1,MB0,B]  137-18-155ms   | [S1,MB1,B]  155-18-173ms   | [S1,MB2,B]  173-18-192ms   | [S1,MB3,B]  192-18-210ms   | [S1,MB4,B]  210-18-228ms   | [S1,MB5,B]  228-18-246ms   | [S1,MB6,B]  246-18-265ms   | [S1,MB7,B]  265-18-283ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  18-9-27ms      | [S2,MB1,F]  27-9-36ms      | [S2,MB2,F]  36-9-45ms      | [S2,MB3,F]  45-9-54ms      | [S2,MB4,F]  54-9-64ms      | [S2,MB5,F]  64-9-73ms      | [S2,MB6,F]  73-9-82ms      | [S2,MB7,F]  82-9-91ms      | [S2,MB0,B]  118-18-137ms   | [S2,MB1,B]  137-18-155ms   | [S2,MB2,B]  155-18-173ms   | [S2,MB3,B]  173-18-192ms   | [S2,MB4,B]  192-18-210ms   | [S2,MB5,B]  210-18-228ms   | [S2,MB6,B]  228-18-246ms   | [S2,MB7,B]  246-18-265ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  27-9-36ms      | [S3,MB1,F]  36-9-45ms      | [S3,MB2,F]  45-9-54ms      | [S3,MB3,F]  54-9-64ms      | [S3,MB4,F]  64-9-73ms      | [S3,MB5,F]  73-9-82ms      | [S3,MB6,F]  82-9-91ms      | [S3,MB7,F]  91-9-100ms     | [S3,MB0,B]  100-18-118ms   | [S3,MB1,B]  118-18-137ms   | [S3,MB2,B]  137-18-155ms   | [S3,MB3,B]  155-18-173ms   | [S3,MB4,B]  173-18-192ms   | [S3,MB5,B]  192-18-210ms   | [S3,MB6,B]  210-18-228ms   | [S3,MB7,B]  228-18-246ms  
[rank2]:2025-12-28 21:01:59,134 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2101_rank2_stage2.svg
[rank2]:	> Counts Sum: 999, Total Sum: 2700 (37.00%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-28 21:01:59,134 - Destroying the purge thread.
[rank0]:2025-12-28 21:01:59,137 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2101_rank0_stage0.svg
[rank0]:	> Counts Sum: 1845, Total Sum: 2775 (66.49%), Ratio(%) per element: [0.0, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-28 21:01:59,137 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-28 21:01:59,251 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_ratio_history/rank3/251228_2101_stage3_final800.svg
[rank3]:2025-12-28 21:01:59,379 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1/frozen_params_histogram/251228_2101_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 2175 (30.62%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-28 21:01:59,380 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-12-28 21:01:59,553 - Process group destroyed
[rank2]:2025-12-28 21:01:59,570 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 369-390
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.4063
[rank3]:wandb:               final/avg_loss 0.24992
[rank3]:wandb:             final/avg_mfu(%) 17.11586
[rank3]:wandb:             final/avg_tflops 58.13616
[rank3]:wandb:    final/avg_throughput(tps) 7436.63163
[rank3]:wandb:              final/grad_norm 0.11642
[rank3]:wandb:               final/max_loss 0.24992
[rank3]:wandb:                    grad_norm 0.11642
[rank3]:wandb: loss_metrics/global_avg_loss 0.24992
[rank3]:wandb: loss_metrics/global_max_loss 0.24992
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_GPipe_auto_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/texq5rfh
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_GPipe_auto_11_dm1/20251228-1959/wandb/run-20251228_195930-texq5rfh/logs
[rank3]:2025-12-28 21:02:01,158 - Process group destroyed
[rank0]:2025-12-28 21:02:01,138 - Training completed
[rank0]:2025-12-28 21:02:01,138 - Destroying the purge thread.
[rank0]:2025-12-28 21:02:01,655 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.2', 'layers.3', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.9', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.6', 'layers.8', 'layers.5'}
[rank3]:Stage 3: Modules to keep: {'output', 'norm', 'layers.14', 'layers.15', 'layers.13'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_GPipe_auto_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_GPipe_auto_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_GPipe_auto_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_GPipe_auto_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_GPipe_auto_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_GPipe_auto_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_GPipe_auto_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_GPipe_auto_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
