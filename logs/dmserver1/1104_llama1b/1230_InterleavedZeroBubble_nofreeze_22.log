
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 10:08:32 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_InterleavedZeroBubble_nofreeze_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with nofreeze x InterleavedZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-31 10:08:39,006 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank2]:2025-12-31 10:08:39,006 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-31 10:08:39,183 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank0]:2025-12-31 10:08:39,231 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 10:08:39,233 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 10:08:39,236 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 10:08:39,237 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-31 10:08:39,214 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank2]:2025-12-31 10:08:39,227 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 10:08:39,230 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-31 10:08:39,554 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 10:08:39,557 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-31 10:08:39,565 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 10:08:39,567 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 10:08:39,631 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-31 10:08:42,588 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-31 10:08:42,740 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 10:08:42,778 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 10:08:42,779 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 10:08:42,805 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank2]:2025-12-31 10:08:42,730 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 10:08:42,757 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 10:08:42,777 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-31 10:08:42,789 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-31 10:08:42,791 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-31 10:08:42,817 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-31 10:08:42,819 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-31 10:08:42,982 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 10:08:42,982 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 10:08:42,983 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-31 10:08:43,043 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 10:08:43,043 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 10:08:43,043 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-31 10:08:43,329 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 10:08:43,367 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 10:08:43,395 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-31 10:08:43,408 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-31 10:08:43,411 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-31 10:08:43,617 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 10:08:43,617 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 10:08:43,618 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run v1i0p5ke
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_nofreeze_22_dm1/20251231-1008/wandb/run-20251231_100843-v1i0p5ke
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/v1i0p5ke
[rank3]:2025-12-31 10:08:44,921 - WandB logging enabled
[rank3]:2025-12-31 10:08:44,922 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 10:08:44,962 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 10:08:44,992 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-31 10:08:45,005 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-31 10:08:45,007 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-31 10:08:45,197 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 10:08:45,198 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 10:08:45,199 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-12-31 10:08:45,218 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank0]:2025-12-31 10:08:45,219 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 10:08:45,220 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank3]:2025-12-31 10:08:45,214 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-31 10:08:45,215 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-31 10:08:45,215 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 10:08:45,220 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-31 10:08:47,759 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 10:08:47,759 - Finished loading the checkpoint in 2.54 seconds.
[rank0]:2025-12-31 10:08:47,759 - Training starts at step 1
[rank1]:2025-12-31 10:08:53,203 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 16.75GiB(35.27%)  tps: 3,332  tflops: 26.04  mfu: 8.35%
[rank1]:2025-12-31 10:08:53,203 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 10:08:53,205 -  step:  1  loss: 10.6092  grad_norm: 203.0657  memory: 34.21GiB(72.01%)  tps: 3,977  tflops: 31.09  mfu: 9.96%
[rank3]:2025-12-31 10:08:53,205 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 10:08:53,182 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 12.75GiB(26.83%)  tps: 3,143  tflops: 24.57  mfu: 7.88%
[rank2]:2025-12-31 10:08:53,182 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 10:08:53,208 -  step:  1  loss: -4.0000  grad_norm: 203.0657  memory: 14.00GiB(29.46%)  tps: 3,142  tflops: 24.56  mfu: 7.87%
[rank0]:2025-12-31 10:08:53,208 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 10:12:39,049 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 10:12:43,715 - Avg. fwd time: 12.5426 / Avg. bwd-weight time: 20.0404 / Avg. bwd-input time: 22.5248 / Avg. batch time: 1097.1590 (ms) / GPU bubble ratio: 19.64%
[rank0]:2025-12-31 10:12:43,725 - Avg. fwd time: 7.9542 / Avg. full-bwd time: 23.8147 (Avg. bwd-weight time: 9.7482 / Avg. bwd-input time: 9.6785) / Avg. batch time: 1147.4182 (ms) / GPU bubble ratio: 58.76%
[rank2]:2025-12-31 10:12:43,710 - Avg. fwd time: 7.3425 / Avg. bwd-weight time: 10.2646 / Avg. bwd-input time: 9.4214 / Avg. batch time: 1104.0215 (ms) / GPU bubble ratio: 60.83%
[rank1]:2025-12-31 10:12:43,731 - Avg. fwd time: 9.4163 / Avg. bwd-weight time: 12.6033 / Avg. bwd-input time: 12.0311 / Avg. batch time: 1138.9678 (ms) / GPU bubble ratio: 52.17%
[rank1]:2025-12-31 10:12:43,762 -  step: 50  loss: -4.0000  grad_norm: 24.3116  memory: 19.02GiB(40.04%)  tps: 6,964  tflops: 54.44  mfu: 17.45%
[rank3]:2025-12-31 10:12:43,769 -  step: 50  loss:  9.8852  grad_norm: 24.3116  memory: 37.14GiB(78.18%)  tps: 6,964  tflops: 54.44  mfu: 17.45%
[rank0]:2025-12-31 10:12:43,771 -  step: 50  loss: -4.0000  grad_norm: 24.3116  memory: 17.77GiB(37.40%)  tps: 6,964  tflops: 54.44  mfu: 17.45%
[rank2]:2025-12-31 10:12:43,757 -  step: 50  loss: -4.0000  grad_norm: 24.3116  memory: 14.54GiB(30.61%)  tps: 6,964  tflops: 54.44  mfu: 17.45%
[rank0]:2025-12-31 10:16:34,618 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:16:39,239 - Avg. fwd time: 7.3291 / Avg. bwd-weight time: 10.2922 / Avg. bwd-input time: 9.4331 / Avg. batch time: 1104.9106 (ms) / GPU bubble ratio: 60.82%
[rank3]:2025-12-31 10:16:39,244 - Avg. fwd time: 12.5504 / Avg. bwd-weight time: 20.1125 / Avg. bwd-input time: 22.5366 / Avg. batch time: 1098.2662 (ms) / GPU bubble ratio: 19.58%
[rank0]:2025-12-31 10:16:39,254 - Avg. fwd time: 7.9322 / Avg. full-bwd time: 23.8421 (Avg. bwd-weight time: 9.7619 / Avg. bwd-input time: 9.6867) / Avg. batch time: 1148.2339 (ms) / GPU bubble ratio: 58.79%
[rank0]:2025-12-31 10:16:39,300 -  step: 100  loss: -4.0000  grad_norm: 17.1647  memory: 17.77GiB(37.40%)  tps: 6,956  tflops: 54.38  mfu: 17.43%
[rank2]:2025-12-31 10:16:39,286 -  step: 100  loss: -4.0000  grad_norm: 17.1647  memory: 14.54GiB(30.61%)  tps: 6,956  tflops: 54.38  mfu: 17.43%
[rank3]:2025-12-31 10:16:39,298 -  step: 100  loss:  8.2245  grad_norm: 17.1647  memory: 37.14GiB(78.18%)  tps: 6,956  tflops: 54.38  mfu: 17.43%
[rank1]:2025-12-31 10:16:39,259 - Avg. fwd time: 9.4083 / Avg. bwd-weight time: 12.6353 / Avg. bwd-input time: 12.0435 / Avg. batch time: 1139.8740 (ms) / GPU bubble ratio: 52.15%
[rank1]:2025-12-31 10:16:39,291 -  step: 100  loss: -4.0000  grad_norm: 17.1647  memory: 19.02GiB(40.04%)  tps: 6,956  tflops: 54.38  mfu: 17.43%
[rank3]:2025-12-31 10:16:39,668 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1016_step100_rank3.svg
[rank3]:			> Batch Time: 1140.58 ms, GPU Bubble Ratio: 58.44%, 52.14%, 62.04%, 22.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S4,MB0,BI] 274-9-283ms    | [S4,MB0,BW] 283-9-293ms    | [S0,MB4,F]  292-7-300ms    | [S4,MB1,BI] 333-9-343ms    | [S4,MB1,BW] 343-9-353ms    | [S0,MB5,F]  353-7-360ms    | [S4,MB2,BI] 407-10-418ms   | [S4,MB2,BW] 418-9-427ms    | [S0,MB6,F]  428-7-435ms    | [S4,MB3,BI] 475-10-485ms   | [S4,MB3,BW] 485-9-494ms    | [S0,MB7,F]  495-7-502ms    | [S0,MB0,B]  525-24-549ms   | [S4,MB4,F]  549-7-556ms    | [S0,MB1,B]  571-24-595ms   | [S4,MB5,F]  595-7-603ms    | [S0,MB2,B]  620-24-644ms   | [S4,MB6,F]  644-7-651ms    | [S0,MB3,B]  661-24-685ms   | [S4,MB7,F]  685-7-692ms    | [S4,MB4,BI] 729-10-739ms   | [S4,MB4,BW] 739-9-749ms    | [S4,MB5,BI] 828-9-837ms    | [S4,MB5,BW] 837-9-847ms    | [S4,MB6,BI] 880-9-889ms    | [S4,MB6,BW] 889-9-898ms    | [S4,MB7,BI] 952-9-961ms    | [S4,MB7,BW] 961-9-970ms    | [S0,MB4,B]  997-23-1021ms  | [S0,MB5,B]  1037-23-1060ms | [S0,MB6,B]  1077-23-1100ms | [S0,MB7,B]  1117-23-1140ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-7-168ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB0,BI] 258-9-267ms    | [S5,MB3,F]  267-8-276ms    | [S5,MB1,BI] 318-9-327ms    | [S5,MB0,BW] 327-10-338ms   | [S1,MB4,F]  337-10-348ms   | [S5,MB2,BI] 379-10-389ms   | [S5,MB1,BW] 389-9-398ms    | [S1,MB5,F]  407-11-418ms   | [S5,MB3,BI] 442-9-452ms    | [S5,MB2,BW] 452-9-461ms    | [S1,MB6,F]  476-11-487ms   | [S1,MB0,BI] 491-14-506ms   | [S5,MB3,BW] 506-9-515ms    | [S1,MB7,F]  526-11-537ms   | [S1,MB1,BI] 541-14-556ms   | [S1,MB0,BW] 556-15-572ms   | [S5,MB4,F]  572-7-580ms    | [S1,MB2,BI] 590-15-605ms   | [S1,MB1,BW] 605-15-621ms   | [S5,MB5,F]  621-7-629ms    | [S1,MB3,BI] 639-15-654ms   | [S1,MB2,BW] 655-15-670ms   | [S5,MB6,F]  670-7-678ms    | [S5,MB4,BI] 713-10-723ms   | [S1,MB3,BW] 723-15-738ms   | [S5,MB7,F]  738-7-745ms    | [S5,MB5,BI] 789-9-798ms    | [S5,MB4,BW] 799-9-808ms    | [S5,MB6,BI] 864-9-873ms    | [S5,MB5,BW] 873-10-883ms   | [S5,MB7,BI] 936-9-945ms    | [S5,MB6,BW] 945-10-955ms   | [S1,MB4,BI] 977-13-990ms   | [S5,MB7,BW] 991-10-1001ms  | [S1,MB5,BI] 1016-13-1030ms | [S1,MB4,BW] 1030-15-1045ms | [S1,MB6,BI] 1056-14-1070ms | [S1,MB5,BW] 1070-15-1085ms | [S1,MB7,BI] 1095-14-1110ms | [S1,MB6,BW] 1110-15-1125ms | [S1,MB7,BW] 1125-15-1140ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB0,BI] 242-9-251ms    | [S6,MB2,F]  251-8-259ms    | [S6,MB1,BI] 301-9-311ms    | [S6,MB3,F]  311-8-319ms    | [S6,MB2,BI] 363-8-372ms    | [S6,MB0,BW] 372-10-382ms   | [S2,MB4,F]  382-7-390ms    | [S6,MB3,BI] 426-9-435ms    | [S6,MB1,BW] 435-10-446ms   | [S2,MB5,F]  446-7-453ms    | [S2,MB0,BI] 474-9-484ms    | [S6,MB2,BW] 484-10-495ms   | [S2,MB6,F]  495-7-502ms    | [S2,MB1,BI] 525-9-535ms    | [S6,MB3,BW] 534-10-545ms   | [S2,MB7,F]  545-7-552ms    | [S2,MB2,BI] 573-9-583ms    | [S2,MB0,BW] 583-10-594ms   | [S6,MB4,F]  594-7-601ms    | [S2,MB3,BI] 622-9-632ms    | [S2,MB1,BW] 632-10-643ms   | [S6,MB5,F]  643-7-650ms    | [S6,MB4,BI] 696-9-705ms    | [S2,MB2,BW] 706-10-716ms   | [S6,MB6,F]  716-7-723ms    | [S6,MB5,BI] 772-9-782ms    | [S2,MB3,BW] 782-10-792ms   | [S6,MB7,F]  792-7-799ms    | [S6,MB6,BI] 847-9-856ms    | [S6,MB4,BW] 857-10-867ms   | [S6,MB7,BI] 920-8-929ms    | [S6,MB5,BW] 929-10-939ms   | [S2,MB4,BI] 961-8-970ms    | [S6,MB6,BW] 970-10-980ms   | [S2,MB5,BI] 1001-9-1010ms  | [S6,MB7,BW] 1010-10-1020ms | [S2,MB6,BI] 1040-9-1049ms  | [S2,MB4,BW] 1049-10-1059ms | [S2,MB7,BI] 1079-9-1088ms  | [S2,MB5,BW] 1088-10-1098ms | [S2,MB6,BW] 1098-9-1108ms  | [S2,MB7,BW] 1108-9-1118ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,BI] 204-31-236ms   | [S7,MB1,F]  236-14-250ms   | [S7,MB1,BI] 262-32-295ms   | [S7,MB2,F]  295-16-312ms   | [S7,MB2,BI] 324-33-357ms   | [S7,MB3,F]  357-16-373ms   | [S7,MB3,BI] 386-33-419ms   | [S7,MB0,BW] 419-27-446ms   | [S3,MB4,F]  446-8-455ms    | [S3,MB0,BI] 455-12-467ms   | [S7,MB1,BW] 467-29-496ms   | [S3,MB5,F]  496-9-505ms    | [S3,MB1,BI] 505-12-517ms   | [S7,MB2,BW] 517-28-546ms   | [S3,MB6,F]  546-8-555ms    | [S3,MB2,BI] 555-11-566ms   | [S7,MB3,BW] 567-28-595ms   | [S3,MB7,F]  595-9-604ms    | [S3,MB3,BI] 604-11-616ms   | [S3,MB0,BW] 616-12-628ms   | [S7,MB4,F]  628-16-644ms   | [S7,MB4,BI] 656-33-689ms   | [S3,MB1,BW] 689-11-701ms   | [S7,MB5,F]  701-18-719ms   | [S7,MB5,BI] 732-33-765ms   | [S3,MB2,BW] 766-11-777ms   | [S7,MB6,F]  777-18-795ms   | [S7,MB6,BI] 807-33-840ms   | [S3,MB3,BW] 840-11-852ms   | [S7,MB7,F]  852-18-871ms   | [S7,MB7,BI] 881-33-914ms   | [S7,MB4,BW] 914-28-943ms   | [S3,MB4,BI] 944-11-955ms   | [S7,MB5,BW] 955-28-983ms   | [S3,MB5,BI] 983-11-994ms   | [S7,MB6,BW] 994-28-1023ms  | [S3,MB6,BI] 1022-11-1033ms | [S7,MB7,BW] 1033-28-1062ms | [S3,MB7,BI] 1061-11-1072ms | [S3,MB4,BW] 1072-12-1084ms | [S3,MB5,BW] 1084-11-1095ms | [S3,MB6,BW] 1096-11-1107ms | [S3,MB7,BW] 1107-11-1118ms
[rank0]:2025-12-31 10:20:30,516 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 10:20:35,249 - Avg. fwd time: 12.5547 / Avg. bwd-weight time: 20.1426 / Avg. bwd-input time: 22.5433 / Avg. batch time: 1098.7802 (ms) / GPU bubble ratio: 19.56%
[rank2]:2025-12-31 10:20:35,243 - Avg. fwd time: 7.3207 / Avg. bwd-weight time: 10.3001 / Avg. bwd-input time: 9.4411 / Avg. batch time: 1105.8203 (ms) / GPU bubble ratio: 60.84%
[rank1]:2025-12-31 10:20:35,262 - Avg. fwd time: 9.4003 / Avg. bwd-weight time: 12.6450 / Avg. bwd-input time: 12.0501 / Avg. batch time: 1140.7874 (ms) / GPU bubble ratio: 52.18%
[rank3]:2025-12-31 10:20:35,304 -  step: 150  loss:  3.2116  grad_norm: 24.0351  memory: 37.14GiB(78.18%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank0]:2025-12-31 10:20:35,258 - Avg. fwd time: 7.9247 / Avg. full-bwd time: 23.8491 (Avg. bwd-weight time: 9.7657 / Avg. bwd-input time: 9.6919) / Avg. batch time: 1149.1149 (ms) / GPU bubble ratio: 58.82%
[rank0]:2025-12-31 10:20:35,306 -  step: 150  loss: -4.0000  grad_norm: 24.0351  memory: 17.77GiB(37.40%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank2]:2025-12-31 10:20:35,291 -  step: 150  loss: -4.0000  grad_norm: 24.0351  memory: 14.54GiB(30.61%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank1]:2025-12-31 10:20:35,295 -  step: 150  loss: -4.0000  grad_norm: 24.0351  memory: 19.02GiB(40.04%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank0]:2025-12-31 10:24:27,385 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:24:32,157 - Avg. fwd time: 7.3195 / Avg. bwd-weight time: 10.3073 / Avg. bwd-input time: 9.4642 / Avg. batch time: 1107.3115 (ms) / GPU bubble ratio: 60.86%
[rank3]:2025-12-31 10:24:32,162 - Avg. fwd time: 12.5880 / Avg. bwd-weight time: 20.1929 / Avg. bwd-input time: 22.5729 / Avg. batch time: 1100.5278 (ms) / GPU bubble ratio: 19.52%
[rank0]:2025-12-31 10:24:32,172 - Avg. fwd time: 7.9266 / Avg. full-bwd time: 23.8831 (Avg. bwd-weight time: 9.7714 / Avg. bwd-input time: 9.7152) / Avg. batch time: 1150.6829 (ms) / GPU bubble ratio: 58.83%
[rank2]:2025-12-31 10:24:32,204 -  step: 200  loss: -4.0000  grad_norm: 15.5692  memory: 14.54GiB(30.61%)  tps: 6,916  tflops: 54.06  mfu: 17.33%
[rank3]:2025-12-31 10:24:32,217 -  step: 200  loss:  1.0388  grad_norm: 15.5692  memory: 37.14GiB(78.18%)  tps: 6,916  tflops: 54.06  mfu: 17.33%
[rank0]:2025-12-31 10:24:32,218 -  step: 200  loss: -4.0000  grad_norm: 15.5692  memory: 17.77GiB(37.40%)  tps: 6,916  tflops: 54.06  mfu: 17.33%
[rank1]:2025-12-31 10:24:32,178 - Avg. fwd time: 9.4058 / Avg. bwd-weight time: 12.6624 / Avg. bwd-input time: 12.0837 / Avg. batch time: 1142.4277 (ms) / GPU bubble ratio: 52.17%
[rank1]:2025-12-31 10:24:32,209 -  step: 200  loss: -4.0000  grad_norm: 15.5692  memory: 19.02GiB(40.04%)  tps: 6,916  tflops: 54.06  mfu: 17.33%
[rank3]:2025-12-31 10:24:32,563 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1024_step200_rank3.svg
[rank3]:			> Batch Time: 1155.69 ms, GPU Bubble Ratio: 58.72%, 52.40%, 62.31%, 22.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-170ms    | [S4,MB0,BI] 275-9-284ms    | [S4,MB0,BW] 285-9-294ms    | [S0,MB4,F]  294-7-301ms    | [S4,MB1,BI] 336-10-346ms   | [S4,MB1,BW] 346-9-355ms    | [S0,MB5,F]  355-7-363ms    | [S4,MB2,BI] 411-10-421ms   | [S4,MB2,BW] 421-9-431ms    | [S0,MB6,F]  431-7-438ms    | [S4,MB3,BI] 480-10-490ms   | [S4,MB3,BW] 490-9-500ms    | [S0,MB7,F]  500-7-507ms    | [S0,MB0,B]  531-24-556ms   | [S4,MB4,F]  555-7-562ms    | [S0,MB1,B]  578-24-603ms   | [S4,MB5,F]  603-7-611ms    | [S0,MB2,B]  628-24-652ms   | [S4,MB6,F]  653-7-660ms    | [S0,MB3,B]  670-24-694ms   | [S4,MB7,F]  694-7-701ms    | [S4,MB4,BI] 738-10-748ms   | [S4,MB4,BW] 748-9-758ms    | [S4,MB5,BI] 838-9-847ms    | [S4,MB5,BW] 848-9-857ms    | [S4,MB6,BI] 890-9-899ms    | [S4,MB6,BW] 900-9-909ms    | [S4,MB7,BI] 965-9-974ms    | [S4,MB7,BW] 974-9-984ms    | [S0,MB4,B]  1010-23-1033ms | [S0,MB5,B]  1051-23-1074ms | [S0,MB6,B]  1091-23-1114ms | [S0,MB7,B]  1132-23-1155ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB0,BI] 259-9-268ms    | [S5,MB3,F]  268-8-277ms    | [S5,MB1,BI] 320-9-329ms    | [S5,MB0,BW] 329-11-340ms   | [S1,MB4,F]  340-10-351ms   | [S5,MB2,BI] 382-10-392ms   | [S5,MB1,BW] 392-9-401ms    | [S1,MB5,F]  411-11-422ms   | [S5,MB3,BI] 446-10-456ms   | [S5,MB2,BW] 456-9-466ms    | [S1,MB6,F]  480-11-491ms   | [S1,MB0,BI] 496-14-511ms   | [S5,MB3,BW] 511-9-521ms    | [S1,MB7,F]  532-11-543ms   | [S1,MB1,BI] 548-14-563ms   | [S1,MB0,BW] 563-15-578ms   | [S5,MB4,F]  579-7-586ms    | [S1,MB2,BI] 598-15-613ms   | [S1,MB1,BW] 613-15-629ms   | [S5,MB5,F]  630-7-637ms    | [S1,MB3,BI] 648-15-663ms   | [S1,MB2,BW] 663-15-679ms   | [S5,MB6,F]  679-7-686ms    | [S5,MB4,BI] 721-10-731ms   | [S1,MB3,BW] 731-15-747ms   | [S5,MB7,F]  747-7-754ms    | [S5,MB5,BI] 797-10-807ms   | [S5,MB4,BW] 807-9-817ms    | [S5,MB6,BI] 875-9-884ms    | [S5,MB5,BW] 884-10-894ms   | [S5,MB7,BI] 949-9-958ms    | [S5,MB6,BW] 959-10-969ms   | [S1,MB4,BI] 989-13-1003ms  | [S5,MB7,BW] 1003-10-1013ms | [S1,MB5,BI] 1030-14-1044ms | [S1,MB4,BW] 1043-15-1058ms | [S1,MB6,BI] 1070-14-1085ms | [S1,MB5,BW] 1084-15-1099ms | [S1,MB7,BI] 1110-14-1125ms | [S1,MB6,BW] 1125-15-1140ms | [S1,MB7,BW] 1140-15-1156ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  135-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB0,BI] 243-9-252ms    | [S6,MB2,F]  253-8-261ms    | [S6,MB1,BI] 303-9-313ms    | [S6,MB3,F]  313-8-321ms    | [S6,MB2,BI] 366-9-375ms    | [S6,MB0,BW] 375-10-385ms   | [S2,MB4,F]  385-7-392ms    | [S6,MB3,BI] 429-9-439ms    | [S6,MB1,BW] 439-10-450ms   | [S2,MB5,F]  450-7-457ms    | [S2,MB0,BI] 480-10-490ms   | [S6,MB2,BW] 490-10-500ms   | [S2,MB6,F]  500-7-507ms    | [S2,MB1,BI] 531-9-541ms    | [S6,MB3,BW] 541-10-552ms   | [S2,MB7,F]  552-7-559ms    | [S2,MB2,BI] 581-10-591ms   | [S2,MB0,BW] 591-10-602ms   | [S6,MB4,F]  601-7-608ms    | [S2,MB3,BI] 631-10-641ms   | [S2,MB1,BW] 641-10-652ms   | [S6,MB5,F]  651-7-659ms    | [S6,MB4,BI] 705-9-715ms    | [S2,MB2,BW] 714-10-725ms   | [S6,MB6,F]  725-7-733ms    | [S6,MB5,BI] 781-9-791ms    | [S2,MB3,BW] 790-10-801ms   | [S6,MB7,F]  801-7-808ms    | [S6,MB6,BI] 856-9-866ms    | [S6,MB4,BW] 866-10-877ms   | [S6,MB7,BI] 933-9-942ms    | [S6,MB5,BW] 942-10-953ms   | [S2,MB4,BI] 973-9-982ms    | [S6,MB6,BW] 982-10-993ms   | [S2,MB5,BI] 1013-9-1023ms  | [S6,MB7,BW] 1023-10-1033ms | [S2,MB6,BI] 1053-9-1062ms  | [S2,MB4,BW] 1062-10-1073ms | [S2,MB7,BI] 1094-9-1103ms  | [S2,MB5,BW] 1103-10-1114ms | [S2,MB6,BW] 1114-9-1124ms  | [S2,MB7,BW] 1123-9-1133ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-149ms    | [S7,MB0,F]  177-15-193ms   | [S7,MB0,BI] 205-32-237ms   | [S7,MB1,F]  237-14-252ms   | [S7,MB1,BI] 264-32-297ms   | [S7,MB2,F]  297-16-314ms   | [S7,MB2,BI] 325-33-359ms   | [S7,MB3,F]  359-17-377ms   | [S7,MB3,BI] 389-34-423ms   | [S7,MB0,BW] 423-27-450ms   | [S3,MB4,F]  450-9-459ms    | [S3,MB0,BI] 459-12-472ms   | [S7,MB1,BW] 472-29-502ms   | [S3,MB5,F]  502-9-511ms    | [S3,MB1,BI] 511-12-524ms   | [S7,MB2,BW] 524-28-553ms   | [S3,MB6,F]  553-8-562ms    | [S3,MB2,BI] 562-11-574ms   | [S7,MB3,BW] 574-28-603ms   | [S3,MB7,F]  603-9-612ms    | [S3,MB3,BI] 612-12-624ms   | [S3,MB0,BW] 624-12-636ms   | [S7,MB4,F]  636-16-652ms   | [S7,MB4,BI] 664-33-698ms   | [S3,MB1,BW] 698-12-710ms   | [S7,MB5,F]  710-18-729ms   | [S7,MB5,BI] 740-33-774ms   | [S3,MB2,BW] 774-11-786ms   | [S7,MB6,F]  786-19-805ms   | [S7,MB6,BI] 816-34-850ms   | [S3,MB3,BW] 850-11-861ms   | [S7,MB7,F]  862-19-881ms   | [S7,MB7,BI] 893-34-927ms   | [S7,MB4,BW] 927-28-956ms   | [S3,MB4,BI] 956-11-967ms   | [S7,MB5,BW] 967-29-996ms   | [S3,MB5,BI] 996-11-1007ms  | [S7,MB6,BW] 1007-28-1036ms | [S3,MB6,BI] 1035-11-1046ms | [S7,MB7,BW] 1047-28-1076ms | [S3,MB7,BI] 1076-11-1087ms | [S3,MB4,BW] 1087-12-1099ms | [S3,MB5,BW] 1100-11-1112ms | [S3,MB6,BW] 1111-11-1123ms | [S3,MB7,BW] 1123-11-1135ms
[rank0]:2025-12-31 10:28:23,858 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:28:28,515 - Avg. fwd time: 7.3152 / Avg. bwd-weight time: 10.3107 / Avg. bwd-input time: 9.4830 / Avg. batch time: 1107.6235 (ms) / GPU bubble ratio: 60.84%
[rank2]:2025-12-31 10:28:28,561 -  step: 250  loss: -4.0000  grad_norm:  4.3079  memory: 14.54GiB(30.61%)  tps: 6,932  tflops: 54.19  mfu: 17.37%
[rank0]:2025-12-31 10:28:28,530 - Avg. fwd time: 7.9234 / Avg. full-bwd time: 23.8929 (Avg. bwd-weight time: 9.7729 / Avg. bwd-input time: 9.7334) / Avg. batch time: 1151.0353 (ms) / GPU bubble ratio: 58.82%
[rank0]:2025-12-31 10:28:28,576 -  step: 250  loss: -4.0000  grad_norm:  4.3079  memory: 17.77GiB(37.40%)  tps: 6,932  tflops: 54.19  mfu: 17.37%
[rank1]:2025-12-31 10:28:28,536 - Avg. fwd time: 9.4045 / Avg. bwd-weight time: 12.6699 / Avg. bwd-input time: 12.1059 / Avg. batch time: 1142.8187 (ms) / GPU bubble ratio: 52.15%
[rank1]:2025-12-31 10:28:28,566 -  step: 250  loss: -4.0000  grad_norm:  4.3079  memory: 19.02GiB(40.04%)  tps: 6,932  tflops: 54.19  mfu: 17.37%
[rank3]:2025-12-31 10:28:28,519 - Avg. fwd time: 12.5842 / Avg. bwd-weight time: 20.2020 / Avg. bwd-input time: 22.5790 / Avg. batch time: 1100.6447 (ms) / GPU bubble ratio: 19.52%
[rank3]:2025-12-31 10:28:28,574 -  step: 250  loss:  0.3599  grad_norm:  4.3079  memory: 37.14GiB(78.18%)  tps: 6,932  tflops: 54.19  mfu: 17.37%
[rank0]:2025-12-31 10:32:19,309 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:32:23,959 - Avg. fwd time: 7.3107 / Avg. bwd-weight time: 10.3102 / Avg. bwd-input time: 9.4942 / Avg. batch time: 1107.1677 (ms) / GPU bubble ratio: 60.82%
[rank0]:2025-12-31 10:32:23,974 - Avg. fwd time: 7.9193 / Avg. full-bwd time: 23.8965 (Avg. bwd-weight time: 9.7719 / Avg. bwd-input time: 9.7451) / Avg. batch time: 1150.5920 (ms) / GPU bubble ratio: 58.80%
[rank1]:2025-12-31 10:32:23,980 - Avg. fwd time: 9.4011 / Avg. bwd-weight time: 12.6712 / Avg. bwd-input time: 12.1195 / Avg. batch time: 1142.3913 (ms) / GPU bubble ratio: 52.11%
[rank3]:2025-12-31 10:32:23,964 - Avg. fwd time: 12.5774 / Avg. bwd-weight time: 20.1961 / Avg. bwd-input time: 22.5746 / Avg. batch time: 1100.3087 (ms) / GPU bubble ratio: 19.52%
[rank2]:2025-12-31 10:32:24,006 -  step: 300  loss: -4.0000  grad_norm:  1.2521  memory: 14.54GiB(30.61%)  tps: 6,959  tflops: 54.40  mfu: 17.44%
[rank0]:2025-12-31 10:32:24,020 -  step: 300  loss: -4.0000  grad_norm:  1.2521  memory: 17.77GiB(37.40%)  tps: 6,959  tflops: 54.40  mfu: 17.44%
[rank1]:2025-12-31 10:32:24,010 -  step: 300  loss: -4.0000  grad_norm:  1.2521  memory: 19.02GiB(40.04%)  tps: 6,959  tflops: 54.40  mfu: 17.44%
[rank3]:2025-12-31 10:32:24,018 -  step: 300  loss:  0.2746  grad_norm:  1.2521  memory: 37.14GiB(78.18%)  tps: 6,959  tflops: 54.40  mfu: 17.44%
[rank3]:2025-12-31 10:32:24,363 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1032_step300_rank3.svg
[rank3]:			> Batch Time: 1145.66 ms, GPU Bubble Ratio: 58.49%, 52.12%, 62.08%, 23.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  160-8-169ms    | [S4,MB0,BI] 274-9-283ms    | [S4,MB0,BW] 284-9-293ms    | [S0,MB4,F]  293-7-300ms    | [S4,MB1,BI] 334-10-344ms   | [S4,MB1,BW] 344-9-354ms    | [S0,MB5,F]  354-7-361ms    | [S4,MB2,BI] 408-10-418ms   | [S4,MB2,BW] 418-9-428ms    | [S0,MB6,F]  428-7-435ms    | [S4,MB3,BI] 476-10-487ms   | [S4,MB3,BW] 487-9-496ms    | [S0,MB7,F]  496-7-504ms    | [S0,MB0,B]  527-24-552ms   | [S4,MB4,F]  552-7-559ms    | [S0,MB1,B]  574-24-598ms   | [S4,MB5,F]  598-7-605ms    | [S0,MB2,B]  623-24-647ms   | [S4,MB6,F]  647-7-654ms    | [S0,MB3,B]  664-24-688ms   | [S4,MB7,F]  688-7-695ms    | [S4,MB4,BI] 732-10-742ms   | [S4,MB4,BW] 742-9-752ms    | [S4,MB5,BI] 831-9-840ms    | [S4,MB5,BW] 840-9-850ms    | [S4,MB6,BI] 883-9-892ms    | [S4,MB6,BW] 892-9-902ms    | [S4,MB7,BI] 957-9-966ms    | [S4,MB7,BW] 966-9-976ms    | [S0,MB4,B]  1002-23-1025ms | [S0,MB5,B]  1043-23-1066ms | [S0,MB6,B]  1082-23-1105ms | [S0,MB7,B]  1122-23-1145ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  174-7-181ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB0,BI] 258-9-267ms    | [S5,MB3,F]  268-8-276ms    | [S5,MB1,BI] 318-9-327ms    | [S5,MB0,BW] 327-11-338ms   | [S1,MB4,F]  338-10-349ms   | [S5,MB2,BI] 379-10-389ms   | [S5,MB1,BW] 389-9-398ms    | [S1,MB5,F]  408-11-419ms   | [S5,MB3,BI] 442-10-452ms   | [S5,MB2,BW] 452-9-462ms    | [S1,MB6,F]  477-11-488ms   | [S1,MB0,BI] 493-14-508ms   | [S5,MB3,BW] 508-9-517ms    | [S1,MB7,F]  528-11-539ms   | [S1,MB1,BI] 544-14-558ms   | [S1,MB0,BW] 559-15-574ms   | [S5,MB4,F]  575-7-582ms    | [S1,MB2,BI] 593-15-608ms   | [S1,MB1,BW] 608-15-623ms   | [S5,MB5,F]  624-7-631ms    | [S1,MB3,BI] 642-15-657ms   | [S1,MB2,BW] 657-15-673ms   | [S5,MB6,F]  673-7-681ms    | [S5,MB4,BI] 716-10-726ms   | [S1,MB3,BW] 726-15-741ms   | [S5,MB7,F]  741-7-748ms    | [S5,MB5,BI] 790-10-800ms   | [S5,MB4,BW] 800-9-810ms    | [S5,MB6,BI] 867-9-876ms    | [S5,MB5,BW] 876-10-886ms   | [S5,MB7,BI] 941-9-950ms    | [S5,MB6,BW] 950-10-960ms   | [S1,MB4,BI] 981-13-995ms   | [S5,MB7,BW] 995-10-1005ms  | [S1,MB5,BI] 1022-14-1036ms | [S1,MB4,BW] 1036-15-1051ms | [S1,MB6,BI] 1061-14-1075ms | [S1,MB5,BW] 1075-15-1090ms | [S1,MB7,BI] 1101-14-1116ms | [S1,MB6,BW] 1115-15-1130ms | [S1,MB7,BW] 1131-15-1147ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  182-6-189ms    | [S6,MB0,BI] 242-9-251ms    | [S6,MB2,F]  252-8-260ms    | [S6,MB1,BI] 302-9-311ms    | [S6,MB3,F]  311-8-319ms    | [S6,MB2,BI] 363-9-372ms    | [S6,MB0,BW] 372-10-383ms   | [S2,MB4,F]  383-7-390ms    | [S6,MB3,BI] 426-9-436ms    | [S6,MB1,BW] 436-10-446ms   | [S2,MB5,F]  446-7-453ms    | [S2,MB0,BI] 477-9-487ms    | [S6,MB2,BW] 487-10-498ms   | [S2,MB6,F]  497-7-504ms    | [S2,MB1,BI] 527-9-537ms    | [S6,MB3,BW] 537-10-548ms   | [S2,MB7,F]  548-7-555ms    | [S2,MB2,BI] 576-10-586ms   | [S2,MB0,BW] 586-10-596ms   | [S6,MB4,F]  596-7-603ms    | [S2,MB3,BI] 625-10-635ms   | [S2,MB1,BW] 635-10-646ms   | [S6,MB5,F]  646-7-653ms    | [S6,MB4,BI] 699-9-709ms    | [S2,MB2,BW] 709-10-719ms   | [S6,MB6,F]  719-7-726ms    | [S6,MB5,BI] 773-9-783ms    | [S2,MB3,BW] 783-10-794ms   | [S6,MB7,F]  794-7-801ms    | [S6,MB6,BI] 849-9-859ms    | [S6,MB4,BW] 859-10-870ms   | [S6,MB7,BI] 925-9-934ms    | [S6,MB5,BW] 934-10-944ms   | [S2,MB4,BI] 965-9-974ms    | [S6,MB6,BW] 974-10-984ms   | [S2,MB5,BI] 1005-9-1014ms  | [S6,MB7,BW] 1015-10-1025ms | [S2,MB6,BI] 1045-9-1054ms  | [S2,MB4,BW] 1054-10-1064ms | [S2,MB7,BI] 1085-9-1094ms  | [S2,MB5,BW] 1094-10-1104ms | [S2,MB6,BW] 1104-9-1114ms  | [S2,MB7,BW] 1113-9-1123ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,BI] 204-31-236ms   | [S7,MB1,F]  236-14-251ms   | [S7,MB1,BI] 262-32-295ms   | [S7,MB2,F]  295-16-312ms   | [S7,MB2,BI] 324-33-357ms   | [S7,MB3,F]  357-16-373ms   | [S7,MB3,BI] 386-33-420ms   | [S7,MB0,BW] 419-27-447ms   | [S3,MB4,F]  448-8-457ms    | [S3,MB0,BI] 457-12-469ms   | [S7,MB1,BW] 469-29-498ms   | [S3,MB5,F]  498-9-507ms    | [S3,MB1,BI] 507-12-520ms   | [S7,MB2,BW] 520-28-549ms   | [S3,MB6,F]  549-8-557ms    | [S3,MB2,BI] 557-11-569ms   | [S7,MB3,BW] 569-28-598ms   | [S3,MB7,F]  598-8-606ms    | [S3,MB3,BI] 607-11-619ms   | [S3,MB0,BW] 618-12-631ms   | [S7,MB4,F]  630-16-647ms   | [S7,MB4,BI] 659-33-692ms   | [S3,MB1,BW] 692-11-704ms   | [S7,MB5,F]  704-18-722ms   | [S7,MB5,BI] 734-33-767ms   | [S3,MB2,BW] 767-11-778ms   | [S7,MB6,F]  779-17-796ms   | [S7,MB6,BI] 809-33-842ms   | [S3,MB3,BW] 843-11-854ms   | [S7,MB7,F]  854-18-873ms   | [S7,MB7,BI] 885-33-919ms   | [S7,MB4,BW] 919-28-947ms   | [S3,MB4,BI] 947-11-958ms   | [S7,MB5,BW] 959-29-988ms   | [S3,MB5,BI] 987-11-998ms   | [S7,MB6,BW] 999-28-1027ms  | [S3,MB6,BI] 1027-11-1038ms | [S7,MB7,BW] 1039-28-1067ms | [S3,MB7,BI] 1067-11-1078ms | [S3,MB4,BW] 1078-12-1090ms | [S3,MB5,BW] 1090-11-1102ms | [S3,MB6,BW] 1101-11-1112ms | [S3,MB7,BW] 1113-11-1124ms
[rank0]:2025-12-31 10:36:15,051 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:36:19,750 - Avg. fwd time: 7.3081 / Avg. bwd-weight time: 10.3086 / Avg. bwd-input time: 9.5008 / Avg. batch time: 1107.0380 (ms) / GPU bubble ratio: 60.81%
[rank0]:2025-12-31 10:36:19,764 - Avg. fwd time: 7.9165 / Avg. full-bwd time: 23.8971 (Avg. bwd-weight time: 9.7698 / Avg. bwd-input time: 9.7524) / Avg. batch time: 1150.4718 (ms) / GPU bubble ratio: 58.80%
[rank1]:2025-12-31 10:36:19,769 - Avg. fwd time: 9.3995 / Avg. bwd-weight time: 12.6721 / Avg. bwd-input time: 12.1285 / Avg. batch time: 1142.2909 (ms) / GPU bubble ratio: 52.10%
[rank3]:2025-12-31 10:36:19,756 - Avg. fwd time: 12.5726 / Avg. bwd-weight time: 20.1911 / Avg. bwd-input time: 22.5697 / Avg. batch time: 1100.0400 (ms) / GPU bubble ratio: 19.52%
[rank2]:2025-12-31 10:36:19,799 -  step: 350  loss: -4.0000  grad_norm:  0.2971  memory: 14.54GiB(30.61%)  tps: 6,948  tflops: 54.32  mfu: 17.41%
[rank0]:2025-12-31 10:36:19,813 -  step: 350  loss: -4.0000  grad_norm:  0.2971  memory: 17.77GiB(37.40%)  tps: 6,948  tflops: 54.32  mfu: 17.41%
[rank1]:2025-12-31 10:36:19,802 -  step: 350  loss: -4.0000  grad_norm:  0.2971  memory: 19.02GiB(40.04%)  tps: 6,948  tflops: 54.32  mfu: 17.41%
[rank3]:2025-12-31 10:36:19,811 -  step: 350  loss:  0.2245  grad_norm:  0.2971  memory: 37.14GiB(78.18%)  tps: 6,949  tflops: 54.32  mfu: 17.41%
[rank0]:2025-12-31 10:40:11,104 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 10:40:15,873 - Avg. fwd time: 9.4008 / Avg. bwd-weight time: 12.6755 / Avg. bwd-input time: 12.1357 / Avg. batch time: 1142.4296 (ms) / GPU bubble ratio: 52.09%
[rank2]:2025-12-31 10:40:15,854 - Avg. fwd time: 7.3080 / Avg. bwd-weight time: 10.3086 / Avg. bwd-input time: 9.5063 / Avg. batch time: 1107.1431 (ms) / GPU bubble ratio: 60.80%
[rank2]:2025-12-31 10:40:15,901 -  step: 400  loss: -4.0000  grad_norm:  0.2535  memory: 14.54GiB(30.61%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank3]:2025-12-31 10:40:15,859 - Avg. fwd time: 12.5726 / Avg. bwd-weight time: 20.1998 / Avg. bwd-input time: 22.5758 / Avg. batch time: 1100.2653 (ms) / GPU bubble ratio: 19.51%
[rank3]:2025-12-31 10:40:15,913 -  step: 400  loss:  0.2132  grad_norm:  0.2535  memory: 37.14GiB(78.18%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank0]:2025-12-31 10:40:15,867 - Avg. fwd time: 7.9164 / Avg. full-bwd time: 23.9023 (Avg. bwd-weight time: 9.7695 / Avg. bwd-input time: 9.7592) / Avg. batch time: 1150.5887 (ms) / GPU bubble ratio: 58.79%
[rank0]:2025-12-31 10:40:15,915 -  step: 400  loss: -4.0000  grad_norm:  0.2535  memory: 17.77GiB(37.40%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank1]:2025-12-31 10:40:15,905 -  step: 400  loss: -4.0000  grad_norm:  0.2535  memory: 19.02GiB(40.04%)  tps: 6,939  tflops: 54.25  mfu: 17.39%
[rank3]:2025-12-31 10:40:16,248 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1040_step400_rank3.svg
[rank3]:			> Batch Time: 1153.69 ms, GPU Bubble Ratio: 58.66%, 52.33%, 62.28%, 22.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  161-8-170ms    | [S4,MB0,BI] 276-9-285ms    | [S4,MB0,BW] 285-9-295ms    | [S0,MB4,F]  294-7-302ms    | [S4,MB1,BI] 336-10-346ms   | [S4,MB1,BW] 346-9-355ms    | [S0,MB5,F]  355-7-363ms    | [S4,MB2,BI] 410-10-420ms   | [S4,MB2,BW] 420-9-430ms    | [S0,MB6,F]  430-7-437ms    | [S4,MB3,BI] 479-10-489ms   | [S4,MB3,BW] 489-9-499ms    | [S0,MB7,F]  499-7-506ms    | [S0,MB0,B]  531-24-556ms   | [S4,MB4,F]  555-7-562ms    | [S0,MB1,B]  577-24-602ms   | [S4,MB5,F]  602-7-610ms    | [S0,MB2,B]  628-24-652ms   | [S4,MB6,F]  652-7-659ms    | [S0,MB3,B]  669-24-693ms   | [S4,MB7,F]  694-7-701ms    | [S4,MB4,BI] 738-10-748ms   | [S4,MB4,BW] 748-9-758ms    | [S4,MB5,BI] 837-9-846ms    | [S4,MB5,BW] 847-9-856ms    | [S4,MB6,BI] 890-9-899ms    | [S4,MB6,BW] 899-9-908ms    | [S4,MB7,BI] 963-9-972ms    | [S4,MB7,BW] 973-9-982ms    | [S0,MB4,B]  1009-23-1032ms | [S0,MB5,B]  1050-23-1073ms | [S0,MB6,B]  1090-23-1113ms | [S0,MB7,B]  1130-23-1153ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-97ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB0,BI] 259-9-269ms    | [S5,MB3,F]  269-8-277ms    | [S5,MB1,BI] 320-9-329ms    | [S5,MB0,BW] 329-11-340ms   | [S1,MB4,F]  340-10-351ms   | [S5,MB2,BI] 382-10-392ms   | [S5,MB1,BW] 392-9-401ms    | [S1,MB5,F]  410-11-421ms   | [S5,MB3,BI] 445-10-455ms   | [S5,MB2,BW] 455-9-465ms    | [S1,MB6,F]  479-11-490ms   | [S1,MB0,BI] 496-14-511ms   | [S5,MB3,BW] 511-9-520ms    | [S1,MB7,F]  532-11-543ms   | [S1,MB1,BI] 547-14-562ms   | [S1,MB0,BW] 562-15-578ms   | [S5,MB4,F]  579-7-586ms    | [S1,MB2,BI] 597-15-612ms   | [S1,MB1,BW] 612-15-628ms   | [S5,MB5,F]  629-7-636ms    | [S1,MB3,BI] 647-15-662ms   | [S1,MB2,BW] 663-15-678ms   | [S5,MB6,F]  678-7-686ms    | [S5,MB4,BI] 721-10-731ms   | [S1,MB3,BW] 732-15-747ms   | [S5,MB7,F]  747-7-754ms    | [S5,MB5,BI] 797-10-807ms   | [S5,MB4,BW] 807-9-816ms    | [S5,MB6,BI] 874-9-883ms    | [S5,MB5,BW] 883-10-893ms   | [S5,MB7,BI] 948-9-957ms    | [S5,MB6,BW] 957-10-967ms   | [S1,MB4,BI] 988-13-1002ms  | [S5,MB7,BW] 1002-10-1012ms | [S1,MB5,BI] 1028-14-1042ms | [S1,MB4,BW] 1043-15-1058ms | [S1,MB6,BI] 1068-14-1083ms | [S1,MB5,BW] 1083-15-1098ms | [S1,MB7,BI] 1108-14-1123ms | [S1,MB6,BW] 1122-15-1137ms | [S1,MB7,BW] 1138-15-1154ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  135-6-142ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB0,BI] 244-9-253ms    | [S6,MB2,F]  253-8-261ms    | [S6,MB1,BI] 303-9-313ms    | [S6,MB3,F]  313-8-321ms    | [S6,MB2,BI] 366-8-375ms    | [S6,MB0,BW] 375-10-386ms   | [S2,MB4,F]  385-7-392ms    | [S6,MB3,BI] 429-9-439ms    | [S6,MB1,BW] 439-10-450ms   | [S2,MB5,F]  449-7-457ms    | [S2,MB0,BI] 479-9-489ms    | [S6,MB2,BW] 489-10-500ms   | [S2,MB6,F]  500-7-507ms    | [S2,MB1,BI] 531-9-541ms    | [S6,MB3,BW] 540-10-551ms   | [S2,MB7,F]  551-7-559ms    | [S2,MB2,BI] 580-10-590ms   | [S2,MB0,BW] 590-10-601ms   | [S6,MB4,F]  600-7-608ms    | [S2,MB3,BI] 630-10-640ms   | [S2,MB1,BW] 640-10-651ms   | [S6,MB5,F]  651-7-658ms    | [S6,MB4,BI] 705-9-715ms    | [S2,MB2,BW] 714-10-725ms   | [S6,MB6,F]  725-7-732ms    | [S6,MB5,BI] 780-9-790ms    | [S2,MB3,BW] 790-10-801ms   | [S6,MB7,F]  800-7-808ms    | [S6,MB6,BI] 855-9-865ms    | [S6,MB4,BW] 865-10-876ms   | [S6,MB7,BI] 932-9-941ms    | [S6,MB5,BW] 941-10-951ms   | [S2,MB4,BI] 972-9-981ms    | [S6,MB6,BW] 981-10-992ms   | [S2,MB5,BI] 1013-9-1022ms  | [S6,MB7,BW] 1022-10-1032ms | [S2,MB6,BI] 1052-9-1061ms  | [S2,MB4,BW] 1061-10-1072ms | [S2,MB7,BI] 1092-9-1101ms  | [S2,MB5,BW] 1101-10-1112ms | [S2,MB6,BW] 1111-9-1121ms  | [S2,MB7,BW] 1120-9-1130ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  142-7-149ms    | [S7,MB0,F]  177-15-193ms   | [S7,MB0,BI] 205-32-237ms   | [S7,MB1,F]  237-14-252ms   | [S7,MB1,BI] 264-33-297ms   | [S7,MB2,F]  297-15-313ms   | [S7,MB2,BI] 325-33-359ms   | [S7,MB3,F]  359-16-376ms   | [S7,MB3,BI] 388-34-422ms   | [S7,MB0,BW] 422-27-450ms   | [S3,MB4,F]  450-9-459ms    | [S3,MB0,BI] 459-12-471ms   | [S7,MB1,BW] 472-29-501ms   | [S3,MB5,F]  501-9-510ms    | [S3,MB1,BI] 511-12-523ms   | [S7,MB2,BW] 523-29-552ms   | [S3,MB6,F]  552-8-561ms    | [S3,MB2,BI] 561-12-573ms   | [S7,MB3,BW] 573-28-602ms   | [S3,MB7,F]  602-9-611ms    | [S3,MB3,BI] 611-12-623ms   | [S3,MB0,BW] 623-12-636ms   | [S7,MB4,F]  636-16-652ms   | [S7,MB4,BI] 664-33-698ms   | [S3,MB1,BW] 698-11-709ms   | [S7,MB5,F]  710-18-729ms   | [S7,MB5,BI] 740-33-774ms   | [S3,MB2,BW] 773-11-785ms   | [S7,MB6,F]  785-18-804ms   | [S7,MB6,BI] 815-34-849ms   | [S3,MB3,BW] 849-11-860ms   | [S7,MB7,F]  861-18-880ms   | [S7,MB7,BI] 891-33-925ms   | [S7,MB4,BW] 925-28-954ms   | [S3,MB4,BI] 954-11-966ms   | [S7,MB5,BW] 966-29-995ms   | [S3,MB5,BI] 995-11-1006ms  | [S7,MB6,BW] 1006-28-1035ms | [S3,MB6,BI] 1034-11-1045ms | [S7,MB7,BW] 1046-28-1075ms | [S3,MB7,BI] 1074-11-1085ms | [S3,MB4,BW] 1085-12-1098ms | [S3,MB5,BW] 1097-11-1109ms | [S3,MB6,BW] 1109-11-1121ms | [S3,MB7,BW] 1120-11-1132ms
[rank3]:2025-12-31 10:40:42,954 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 10:40:43,233 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 10:40:43,252 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 10:40:43,252 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 10:44:07,155 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 10:44:11,824 - Avg. fwd time: 12.5721 / Avg. bwd-weight time: 20.2025 / Avg. bwd-input time: 22.5750 / Avg. batch time: 1100.2720 (ms) / GPU bubble ratio: 19.51%
[rank0]:2025-12-31 10:44:11,832 - Avg. fwd time: 7.9158 / Avg. full-bwd time: 23.9085 (Avg. bwd-weight time: 9.7691 / Avg. bwd-input time: 9.7629) / Avg. batch time: 1150.6764 (ms) / GPU bubble ratio: 58.79%
[rank1]:2025-12-31 10:44:11,839 - Avg. fwd time: 9.4006 / Avg. bwd-weight time: 12.6780 / Avg. bwd-input time: 12.1406 / Avg. batch time: 1142.5422 (ms) / GPU bubble ratio: 52.08%
[rank1]:2025-12-31 10:44:11,870 -  step: 450  loss: -4.0000  grad_norm:  0.2511  memory: 19.02GiB(40.04%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank2]:2025-12-31 10:44:11,819 - Avg. fwd time: 7.3068 / Avg. bwd-weight time: 10.3088 / Avg. bwd-input time: 9.5091 / Avg. batch time: 1107.2284 (ms) / GPU bubble ratio: 60.80%
[rank2]:2025-12-31 10:44:11,866 -  step: 450  loss: -4.0000  grad_norm:  0.2511  memory: 14.54GiB(30.61%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank3]:2025-12-31 10:44:11,878 -  step: 450  loss:  0.2216  grad_norm:  0.2511  memory: 37.14GiB(78.18%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank0]:2025-12-31 10:44:11,880 -  step: 450  loss: -4.0000  grad_norm:  0.2511  memory: 17.77GiB(37.40%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank0]:2025-12-31 10:48:02,355 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:48:07,005 - Avg. fwd time: 7.3053 / Avg. bwd-weight time: 10.3081 / Avg. bwd-input time: 9.5099 / Avg. batch time: 1106.8620 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-12-31 10:48:07,019 - Avg. fwd time: 7.9147 / Avg. full-bwd time: 23.9123 (Avg. bwd-weight time: 9.7679 / Avg. bwd-input time: 9.7645) / Avg. batch time: 1150.3057 (ms) / GPU bubble ratio: 58.78%
[rank3]:2025-12-31 10:48:07,011 - Avg. fwd time: 12.5650 / Avg. bwd-weight time: 20.1982 / Avg. bwd-input time: 22.5696 / Avg. batch time: 1099.9816 (ms) / GPU bubble ratio: 19.51%
[rank1]:2025-12-31 10:48:07,025 - Avg. fwd time: 9.3988 / Avg. bwd-weight time: 12.6783 / Avg. bwd-input time: 12.1423 / Avg. batch time: 1142.1828 (ms) / GPU bubble ratio: 52.06%
[rank1]:2025-12-31 10:48:07,057 -  step: 500  loss: -4.0000  grad_norm:  0.2152  memory: 19.02GiB(40.04%)  tps: 6,966  tflops: 54.46  mfu: 17.46%
[rank2]:2025-12-31 10:48:07,053 -  step: 500  loss: -4.0000  grad_norm:  0.2152  memory: 14.54GiB(30.61%)  tps: 6,966  tflops: 54.46  mfu: 17.46%
[rank0]:2025-12-31 10:48:07,067 -  step: 500  loss: -4.0000  grad_norm:  0.2152  memory: 17.77GiB(37.40%)  tps: 6,966  tflops: 54.46  mfu: 17.46%
[rank3]:2025-12-31 10:48:07,065 -  step: 500  loss:  0.2123  grad_norm:  0.2152  memory: 37.14GiB(78.18%)  tps: 6,966  tflops: 54.46  mfu: 17.46%
[rank3]:2025-12-31 10:48:07,402 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1048_step500_rank3.svg
[rank3]:			> Batch Time: 1139.64 ms, GPU Bubble Ratio: 58.27%, 51.90%, 61.91%, 22.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  160-8-169ms    | [S4,MB0,BI] 274-9-283ms    | [S4,MB0,BW] 283-9-293ms    | [S0,MB4,F]  293-7-300ms    | [S4,MB1,BI] 334-9-343ms    | [S4,MB1,BW] 344-9-353ms    | [S0,MB5,F]  353-7-361ms    | [S4,MB2,BI] 407-10-417ms   | [S4,MB2,BW] 417-9-427ms    | [S0,MB6,F]  427-7-434ms    | [S4,MB3,BI] 473-10-483ms   | [S4,MB3,BW] 484-9-493ms    | [S0,MB7,F]  493-7-501ms    | [S0,MB0,B]  524-24-549ms   | [S4,MB4,F]  548-7-555ms    | [S0,MB1,B]  571-24-595ms   | [S4,MB5,F]  595-7-603ms    | [S0,MB2,B]  620-24-644ms   | [S4,MB6,F]  644-7-651ms    | [S0,MB3,B]  661-24-685ms   | [S4,MB7,F]  685-7-692ms    | [S4,MB4,BI] 729-10-739ms   | [S4,MB4,BW] 739-9-749ms    | [S4,MB5,BI] 827-9-836ms    | [S4,MB5,BW] 836-9-846ms    | [S4,MB6,BI] 879-9-888ms    | [S4,MB6,BW] 888-9-898ms    | [S4,MB7,BI] 952-9-961ms    | [S4,MB7,BW] 961-9-971ms    | [S0,MB4,B]  995-23-1019ms  | [S0,MB5,B]  1036-23-1059ms | [S0,MB6,B]  1076-23-1099ms | [S0,MB7,B]  1116-23-1139ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  174-7-181ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB0,BI] 258-9-267ms    | [S5,MB3,F]  267-8-276ms    | [S5,MB1,BI] 318-9-327ms    | [S5,MB0,BW] 327-11-338ms   | [S1,MB4,F]  337-10-348ms   | [S5,MB2,BI] 379-10-389ms   | [S5,MB1,BW] 389-9-398ms    | [S1,MB5,F]  407-11-418ms   | [S5,MB3,BI] 442-9-452ms    | [S5,MB2,BW] 452-9-461ms    | [S1,MB6,F]  474-10-485ms   | [S1,MB0,BI] 490-14-504ms   | [S5,MB3,BW] 505-9-514ms    | [S1,MB7,F]  525-11-536ms   | [S1,MB1,BI] 541-14-555ms   | [S1,MB0,BW] 556-15-571ms   | [S5,MB4,F]  572-7-579ms    | [S1,MB2,BI] 590-15-605ms   | [S1,MB1,BW] 605-15-621ms   | [S5,MB5,F]  622-7-629ms    | [S1,MB3,BI] 639-15-654ms   | [S1,MB2,BW] 654-15-670ms   | [S5,MB6,F]  670-7-678ms    | [S5,MB4,BI] 712-10-722ms   | [S1,MB3,BW] 723-15-738ms   | [S5,MB7,F]  738-7-745ms    | [S5,MB5,BI] 787-10-797ms   | [S5,MB4,BW] 797-9-807ms    | [S5,MB6,BI] 864-9-873ms    | [S5,MB5,BW] 873-10-883ms   | [S5,MB7,BI] 936-9-945ms    | [S5,MB6,BW] 945-10-955ms   | [S1,MB4,BI] 975-13-988ms   | [S5,MB7,BW] 989-10-999ms   | [S1,MB5,BI] 1015-14-1029ms | [S1,MB4,BW] 1029-15-1044ms | [S1,MB6,BI] 1054-14-1068ms | [S1,MB5,BW] 1069-15-1084ms | [S1,MB7,BI] 1094-14-1109ms | [S1,MB6,BW] 1109-15-1124ms | [S1,MB7,BW] 1124-15-1140ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  183-6-189ms    | [S6,MB0,BI] 242-9-251ms    | [S6,MB2,F]  251-8-259ms    | [S6,MB1,BI] 302-9-311ms    | [S6,MB3,F]  311-8-319ms    | [S6,MB2,BI] 363-8-372ms    | [S6,MB0,BW] 372-10-382ms   | [S2,MB4,F]  382-7-389ms    | [S6,MB3,BI] 425-9-435ms    | [S6,MB1,BW] 435-10-446ms   | [S2,MB5,F]  446-7-453ms    | [S2,MB0,BI] 473-9-483ms    | [S6,MB2,BW] 483-10-494ms   | [S2,MB6,F]  494-7-501ms    | [S2,MB1,BI] 524-9-534ms    | [S6,MB3,BW] 534-10-545ms   | [S2,MB7,F]  544-7-551ms    | [S2,MB2,BI] 573-10-583ms   | [S2,MB0,BW] 583-10-593ms   | [S6,MB4,F]  593-7-600ms    | [S2,MB3,BI] 622-10-632ms   | [S2,MB1,BW] 632-10-643ms   | [S6,MB5,F]  643-7-650ms    | [S6,MB4,BI] 696-9-706ms    | [S2,MB2,BW] 706-10-716ms   | [S6,MB6,F]  716-7-723ms    | [S6,MB5,BI] 771-9-781ms    | [S2,MB3,BW] 781-10-791ms   | [S6,MB7,F]  791-7-798ms    | [S6,MB6,BI] 846-9-856ms    | [S6,MB4,BW] 856-10-866ms   | [S6,MB7,BI] 920-8-929ms    | [S6,MB5,BW] 929-10-939ms   | [S2,MB4,BI] 959-9-968ms    | [S6,MB6,BW] 968-10-978ms   | [S2,MB5,BI] 999-9-1008ms   | [S6,MB7,BW] 1008-10-1018ms | [S2,MB6,BI] 1039-9-1048ms  | [S2,MB4,BW] 1048-10-1058ms | [S2,MB7,BI] 1079-9-1088ms  | [S2,MB5,BW] 1088-10-1098ms | [S2,MB6,BW] 1098-9-1108ms  | [S2,MB7,BW] 1107-9-1117ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,BI] 204-31-236ms   | [S7,MB1,F]  236-14-250ms   | [S7,MB1,BI] 263-32-295ms   | [S7,MB2,F]  295-16-311ms   | [S7,MB2,BI] 323-33-356ms   | [S7,MB3,F]  356-16-373ms   | [S7,MB3,BI] 385-33-418ms   | [S7,MB0,BW] 418-27-445ms   | [S3,MB4,F]  445-8-453ms    | [S3,MB0,BI] 453-12-465ms   | [S7,MB1,BW] 466-28-495ms   | [S3,MB5,F]  495-9-504ms    | [S3,MB1,BI] 504-12-516ms   | [S7,MB2,BW] 517-28-545ms   | [S3,MB6,F]  545-8-554ms    | [S3,MB2,BI] 554-11-566ms   | [S7,MB3,BW] 566-28-594ms   | [S3,MB7,F]  595-8-604ms    | [S3,MB3,BI] 604-12-616ms   | [S3,MB0,BW] 615-12-627ms   | [S7,MB4,F]  628-16-644ms   | [S7,MB4,BI] 656-33-690ms   | [S3,MB1,BW] 689-11-701ms   | [S7,MB5,F]  701-18-719ms   | [S7,MB5,BI] 731-33-764ms   | [S3,MB2,BW] 764-11-776ms   | [S7,MB6,F]  776-18-794ms   | [S7,MB6,BI] 806-33-839ms   | [S3,MB3,BW] 840-11-851ms   | [S7,MB7,F]  851-18-869ms   | [S7,MB7,BI] 881-33-914ms   | [S7,MB4,BW] 914-28-942ms   | [S3,MB4,BI] 941-11-952ms   | [S7,MB5,BW] 952-28-981ms   | [S3,MB5,BI] 981-11-992ms   | [S7,MB6,BW] 993-28-1021ms  | [S3,MB6,BI] 1021-11-1032ms | [S7,MB7,BW] 1032-28-1061ms | [S3,MB7,BI] 1061-11-1072ms | [S3,MB4,BW] 1072-12-1084ms | [S3,MB5,BW] 1084-11-1096ms | [S3,MB6,BW] 1096-11-1107ms | [S3,MB7,BW] 1107-11-1118ms
[rank0]:2025-12-31 10:51:58,203 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:52:02,930 - Avg. fwd time: 7.3050 / Avg. bwd-weight time: 10.3079 / Avg. bwd-input time: 9.5109 / Avg. batch time: 1106.8852 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-12-31 10:52:02,944 - Avg. fwd time: 7.9146 / Avg. full-bwd time: 23.9166 (Avg. bwd-weight time: 9.7669 / Avg. bwd-input time: 9.7660) / Avg. batch time: 1150.3254 (ms) / GPU bubble ratio: 58.77%
[rank3]:2025-12-31 10:52:02,935 - Avg. fwd time: 12.5622 / Avg. bwd-weight time: 20.1994 / Avg. bwd-input time: 22.5688 / Avg. batch time: 1099.9373 (ms) / GPU bubble ratio: 19.51%
[rank1]:2025-12-31 10:52:02,951 - Avg. fwd time: 9.3988 / Avg. bwd-weight time: 12.6793 / Avg. bwd-input time: 12.1444 / Avg. batch time: 1142.2169 (ms) / GPU bubble ratio: 52.06%
[rank1]:2025-12-31 10:52:02,982 -  step: 550  loss: -4.0000  grad_norm:  0.1757  memory: 19.02GiB(40.04%)  tps: 6,945  tflops: 54.29  mfu: 17.40%
[rank2]:2025-12-31 10:52:02,978 -  step: 550  loss: -4.0000  grad_norm:  0.1757  memory: 14.54GiB(30.61%)  tps: 6,945  tflops: 54.29  mfu: 17.40%
[rank0]:2025-12-31 10:52:02,992 -  step: 550  loss: -4.0000  grad_norm:  0.1757  memory: 17.77GiB(37.40%)  tps: 6,945  tflops: 54.29  mfu: 17.40%
[rank3]:2025-12-31 10:52:02,990 -  step: 550  loss:  0.2210  grad_norm:  0.1757  memory: 37.14GiB(78.18%)  tps: 6,945  tflops: 54.29  mfu: 17.40%
[rank0]:2025-12-31 10:55:54,768 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 10:55:59,540 - Avg. fwd time: 7.3052 / Avg. bwd-weight time: 10.3079 / Avg. bwd-input time: 9.5118 / Avg. batch time: 1107.1771 (ms) / GPU bubble ratio: 60.80%
[rank0]:2025-12-31 10:55:59,553 - Avg. fwd time: 7.9157 / Avg. full-bwd time: 23.9225 (Avg. bwd-weight time: 9.7671 / Avg. bwd-input time: 9.7684) / Avg. batch time: 1150.6163 (ms) / GPU bubble ratio: 58.78%
[rank3]:2025-12-31 10:55:59,545 - Avg. fwd time: 12.5695 / Avg. bwd-weight time: 20.2104 / Avg. bwd-input time: 22.5740 / Avg. batch time: 1100.3155 (ms) / GPU bubble ratio: 19.51%
[rank1]:2025-12-31 10:55:59,558 - Avg. fwd time: 9.4005 / Avg. bwd-weight time: 12.6801 / Avg. bwd-input time: 12.1463 / Avg. batch time: 1142.5037 (ms) / GPU bubble ratio: 52.07%
[rank1]:2025-12-31 10:55:59,591 -  step: 600  loss: -4.0000  grad_norm:  0.1780  memory: 19.02GiB(40.04%)  tps: 6,925  tflops: 54.13  mfu: 17.35%
[rank2]:2025-12-31 10:55:59,587 -  step: 600  loss: -4.0000  grad_norm:  0.1780  memory: 14.54GiB(30.61%)  tps: 6,925  tflops: 54.13  mfu: 17.35%
[rank0]:2025-12-31 10:55:59,601 -  step: 600  loss: -4.0000  grad_norm:  0.1780  memory: 17.77GiB(37.40%)  tps: 6,925  tflops: 54.13  mfu: 17.35%
[rank3]:2025-12-31 10:55:59,599 -  step: 600  loss:  0.2139  grad_norm:  0.1780  memory: 37.14GiB(78.18%)  tps: 6,925  tflops: 54.13  mfu: 17.35%
[rank3]:2025-12-31 10:55:59,939 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1055_step600_rank3.svg
[rank3]:			> Batch Time: 1152.67 ms, GPU Bubble Ratio: 58.66%, 52.46%, 62.32%, 22.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-170ms    | [S4,MB0,BI] 275-9-284ms    | [S4,MB0,BW] 284-9-294ms    | [S0,MB4,F]  294-7-301ms    | [S4,MB1,BI] 335-10-345ms   | [S4,MB1,BW] 345-9-355ms    | [S0,MB5,F]  355-7-362ms    | [S4,MB2,BI] 409-10-419ms   | [S4,MB2,BW] 419-9-429ms    | [S0,MB6,F]  429-7-437ms    | [S4,MB3,BI] 478-10-488ms   | [S4,MB3,BW] 488-9-498ms    | [S0,MB7,F]  498-7-506ms    | [S0,MB0,B]  530-24-555ms   | [S4,MB4,F]  553-7-560ms    | [S0,MB1,B]  577-24-602ms   | [S4,MB5,F]  602-7-610ms    | [S0,MB2,B]  627-24-651ms   | [S4,MB6,F]  651-7-658ms    | [S0,MB3,B]  668-24-692ms   | [S4,MB7,F]  692-7-699ms    | [S4,MB4,BI] 737-10-747ms   | [S4,MB4,BW] 747-9-756ms    | [S4,MB5,BI] 836-9-845ms    | [S4,MB5,BW] 845-9-855ms    | [S4,MB6,BI] 889-9-898ms    | [S4,MB6,BW] 898-9-907ms    | [S4,MB7,BI] 962-9-971ms    | [S4,MB7,BW] 971-9-981ms    | [S0,MB4,B]  1008-23-1031ms | [S0,MB5,B]  1049-23-1072ms | [S0,MB6,B]  1089-23-1112ms | [S0,MB7,B]  1129-23-1152ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-134ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB0,BI] 259-9-268ms    | [S5,MB3,F]  268-8-277ms    | [S5,MB1,BI] 319-9-329ms    | [S5,MB0,BW] 329-10-340ms   | [S1,MB4,F]  339-10-350ms   | [S5,MB2,BI] 381-10-391ms   | [S5,MB1,BW] 391-9-400ms    | [S1,MB5,F]  409-11-420ms   | [S5,MB3,BI] 445-9-455ms    | [S5,MB2,BW] 455-9-464ms    | [S1,MB6,F]  479-11-490ms   | [S1,MB0,BI] 495-14-510ms   | [S5,MB3,BW] 510-9-519ms    | [S1,MB7,F]  530-11-542ms   | [S1,MB1,BI] 547-14-562ms   | [S1,MB0,BW] 561-15-577ms   | [S5,MB4,F]  578-7-585ms    | [S1,MB2,BI] 596-15-611ms   | [S1,MB1,BW] 611-15-627ms   | [S5,MB5,F]  628-8-636ms    | [S1,MB3,BI] 646-15-661ms   | [S1,MB2,BW] 661-15-677ms   | [S5,MB6,F]  677-7-685ms    | [S5,MB4,BI] 720-10-730ms   | [S1,MB3,BW] 730-15-745ms   | [S5,MB7,F]  746-7-753ms    | [S5,MB5,BI] 796-10-806ms   | [S5,MB4,BW] 806-9-816ms    | [S5,MB6,BI] 873-9-882ms    | [S5,MB5,BW] 882-10-892ms   | [S5,MB7,BI] 946-9-955ms    | [S5,MB6,BW] 955-10-965ms   | [S1,MB4,BI] 987-13-1001ms  | [S5,MB7,BW] 1001-10-1011ms | [S1,MB5,BI] 1028-14-1042ms | [S1,MB4,BW] 1042-15-1057ms | [S1,MB6,BI] 1068-14-1082ms | [S1,MB5,BW] 1082-15-1097ms | [S1,MB7,BI] 1107-14-1121ms | [S1,MB6,BW] 1122-15-1137ms | [S1,MB7,BW] 1137-14-1152ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB0,BI] 243-9-252ms    | [S6,MB2,F]  252-8-260ms    | [S6,MB1,BI] 303-9-313ms    | [S6,MB3,F]  313-8-321ms    | [S6,MB2,BI] 365-8-374ms    | [S6,MB0,BW] 374-10-384ms   | [S2,MB4,F]  384-7-391ms    | [S6,MB3,BI] 428-9-438ms    | [S6,MB1,BW] 438-10-448ms   | [S2,MB5,F]  449-7-456ms    | [S2,MB0,BI] 478-9-488ms    | [S6,MB2,BW] 488-10-499ms   | [S2,MB6,F]  499-7-506ms    | [S2,MB1,BI] 530-9-540ms    | [S6,MB3,BW] 540-10-551ms   | [S2,MB7,F]  550-7-558ms    | [S2,MB2,BI] 579-10-589ms   | [S2,MB0,BW] 589-10-600ms   | [S6,MB4,F]  599-7-607ms    | [S2,MB3,BI] 629-10-639ms   | [S2,MB1,BW] 639-10-650ms   | [S6,MB5,F]  650-7-657ms    | [S6,MB4,BI] 703-9-713ms    | [S2,MB2,BW] 713-10-723ms   | [S6,MB6,F]  724-7-731ms    | [S6,MB5,BI] 779-9-789ms    | [S2,MB3,BW] 789-10-800ms   | [S6,MB7,F]  800-7-807ms    | [S6,MB6,BI] 854-9-864ms    | [S6,MB4,BW] 864-10-875ms   | [S6,MB7,BI] 930-8-939ms    | [S6,MB5,BW] 939-10-950ms   | [S2,MB4,BI] 971-9-980ms    | [S6,MB6,BW] 980-10-991ms   | [S2,MB5,BI] 1012-9-1021ms  | [S6,MB7,BW] 1021-10-1032ms | [S2,MB6,BI] 1052-9-1061ms  | [S2,MB4,BW] 1061-10-1072ms | [S2,MB7,BI] 1091-9-1100ms  | [S2,MB5,BW] 1101-10-1112ms | [S2,MB6,BW] 1111-9-1121ms  | [S2,MB7,BW] 1120-9-1130ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,BI] 204-32-236ms   | [S7,MB1,F]  236-14-251ms   | [S7,MB1,BI] 263-33-297ms   | [S7,MB2,F]  297-16-313ms   | [S7,MB2,BI] 324-33-358ms   | [S7,MB3,F]  358-16-375ms   | [S7,MB3,BI] 387-33-421ms   | [S7,MB0,BW] 421-27-449ms   | [S3,MB4,F]  449-9-458ms    | [S3,MB0,BI] 458-12-471ms   | [S7,MB1,BW] 471-29-500ms   | [S3,MB5,F]  501-9-510ms    | [S3,MB1,BI] 510-12-523ms   | [S7,MB2,BW] 522-28-551ms   | [S3,MB6,F]  552-8-561ms    | [S3,MB2,BI] 561-11-573ms   | [S7,MB3,BW] 573-28-601ms   | [S3,MB7,F]  601-9-610ms    | [S3,MB3,BI] 610-12-622ms   | [S3,MB0,BW] 622-12-635ms   | [S7,MB4,F]  634-16-651ms   | [S7,MB4,BI] 663-33-696ms   | [S3,MB1,BW] 697-12-709ms   | [S7,MB5,F]  709-18-727ms   | [S7,MB5,BI] 739-33-773ms   | [S3,MB2,BW] 773-11-784ms   | [S7,MB6,F]  785-18-804ms   | [S7,MB6,BI] 814-34-848ms   | [S3,MB3,BW] 848-11-859ms   | [S7,MB7,F]  860-18-879ms   | [S7,MB7,BI] 890-33-924ms   | [S7,MB4,BW] 924-29-953ms   | [S3,MB4,BI] 953-11-964ms   | [S7,MB5,BW] 964-29-993ms   | [S3,MB5,BI] 994-11-1005ms  | [S7,MB6,BW] 1005-28-1034ms | [S3,MB6,BI] 1034-11-1045ms | [S7,MB7,BW] 1045-28-1074ms | [S3,MB7,BI] 1073-11-1084ms | [S3,MB4,BW] 1085-12-1097ms | [S3,MB5,BW] 1097-11-1109ms | [S3,MB6,BW] 1108-11-1120ms | [S3,MB7,BW] 1120-11-1132ms
[rank0]:2025-12-31 10:59:50,875 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 10:59:55,546 - Avg. fwd time: 9.4008 / Avg. bwd-weight time: 12.6799 / Avg. bwd-input time: 12.1473 / Avg. batch time: 1142.4709 (ms) / GPU bubble ratio: 52.06%
[rank2]:2025-12-31 10:59:55,525 - Avg. fwd time: 7.3049 / Avg. bwd-weight time: 10.3076 / Avg. bwd-input time: 9.5124 / Avg. batch time: 1107.1563 (ms) / GPU bubble ratio: 60.80%
[rank2]:2025-12-31 10:59:55,573 -  step: 650  loss: -4.0000  grad_norm:  0.1809  memory: 14.54GiB(30.61%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank0]:2025-12-31 10:59:55,539 - Avg. fwd time: 7.9158 / Avg. full-bwd time: 23.9250 (Avg. bwd-weight time: 9.7665 / Avg. bwd-input time: 9.7695) / Avg. batch time: 1150.5882 (ms) / GPU bubble ratio: 58.77%
[rank0]:2025-12-31 10:59:55,586 -  step: 650  loss: -4.0000  grad_norm:  0.1809  memory: 17.77GiB(37.40%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank3]:2025-12-31 10:59:55,530 - Avg. fwd time: 12.5662 / Avg. bwd-weight time: 20.2104 / Avg. bwd-input time: 22.5731 / Avg. batch time: 1100.2395 (ms) / GPU bubble ratio: 19.51%
[rank3]:2025-12-31 10:59:55,585 -  step: 650  loss:  0.2234  grad_norm:  0.1809  memory: 37.14GiB(78.18%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank1]:2025-12-31 10:59:55,577 -  step: 650  loss: -4.0000  grad_norm:  0.1809  memory: 19.02GiB(40.04%)  tps: 6,943  tflops: 54.28  mfu: 17.40%
[rank0]:2025-12-31 11:03:46,006 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 11:03:50,675 - Avg. fwd time: 9.4003 / Avg. bwd-weight time: 12.6790 / Avg. bwd-input time: 12.1475 / Avg. batch time: 1142.1834 (ms) / GPU bubble ratio: 52.05%
[rank2]:2025-12-31 11:03:50,654 - Avg. fwd time: 7.3039 / Avg. bwd-weight time: 10.3072 / Avg. bwd-input time: 9.5126 / Avg. batch time: 1106.8855 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-12-31 11:03:50,668 - Avg. fwd time: 7.9151 / Avg. full-bwd time: 23.9257 (Avg. bwd-weight time: 9.7654 / Avg. bwd-input time: 9.7698) / Avg. batch time: 1150.3097 (ms) / GPU bubble ratio: 58.77%
[rank3]:2025-12-31 11:03:50,660 - Avg. fwd time: 12.5599 / Avg. bwd-weight time: 20.2077 / Avg. bwd-input time: 22.5695 / Avg. batch time: 1100.0274 (ms) / GPU bubble ratio: 19.51%
[rank2]:2025-12-31 11:03:50,702 -  step: 700  loss: -4.0000  grad_norm:  0.1667  memory: 14.54GiB(30.61%)  tps: 6,968  tflops: 54.47  mfu: 17.46%
[rank1]:2025-12-31 11:03:50,706 -  step: 700  loss: -4.0000  grad_norm:  0.1667  memory: 19.02GiB(40.04%)  tps: 6,968  tflops: 54.47  mfu: 17.46%
[rank0]:2025-12-31 11:03:50,716 -  step: 700  loss: -4.0000  grad_norm:  0.1667  memory: 17.77GiB(37.40%)  tps: 6,968  tflops: 54.47  mfu: 17.46%
[rank3]:2025-12-31 11:03:50,714 -  step: 700  loss:  0.1814  grad_norm:  0.1667  memory: 37.14GiB(78.18%)  tps: 6,968  tflops: 54.47  mfu: 17.46%
[rank3]:2025-12-31 11:03:51,059 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1103_step700_rank3.svg
[rank3]:			> Batch Time: 1141.64 ms, GPU Bubble Ratio: 58.33%, 52.03%, 61.97%, 22.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  160-8-169ms    | [S4,MB0,BI] 274-9-283ms    | [S4,MB0,BW] 284-9-293ms    | [S0,MB4,F]  293-7-300ms    | [S4,MB1,BI] 333-10-343ms   | [S4,MB1,BW] 344-9-353ms    | [S0,MB5,F]  353-7-361ms    | [S4,MB2,BI] 407-10-417ms   | [S4,MB2,BW] 417-9-427ms    | [S0,MB6,F]  427-7-434ms    | [S4,MB3,BI] 474-10-485ms   | [S4,MB3,BW] 485-9-494ms    | [S0,MB7,F]  494-7-502ms    | [S0,MB0,B]  525-24-550ms   | [S4,MB4,F]  549-7-556ms    | [S0,MB1,B]  572-24-596ms   | [S4,MB5,F]  596-7-604ms    | [S0,MB2,B]  621-24-645ms   | [S4,MB6,F]  645-7-652ms    | [S0,MB3,B]  663-24-687ms   | [S4,MB7,F]  687-7-694ms    | [S4,MB4,BI] 730-10-740ms   | [S4,MB4,BW] 741-9-750ms    | [S4,MB5,BI] 829-9-838ms    | [S4,MB5,BW] 838-9-848ms    | [S4,MB6,BI] 881-9-890ms    | [S4,MB6,BW] 890-9-900ms    | [S4,MB7,BI] 954-9-963ms    | [S4,MB7,BW] 963-9-972ms    | [S0,MB4,B]  997-23-1020ms  | [S0,MB5,B]  1038-23-1061ms | [S0,MB6,B]  1078-23-1101ms | [S0,MB7,B]  1118-23-1141ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  174-7-181ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB0,BI] 258-9-267ms    | [S5,MB3,F]  267-8-276ms    | [S5,MB1,BI] 318-9-327ms    | [S5,MB0,BW] 327-11-338ms   | [S1,MB4,F]  338-10-348ms   | [S5,MB2,BI] 379-10-389ms   | [S5,MB1,BW] 389-9-399ms    | [S1,MB5,F]  407-11-418ms   | [S5,MB3,BI] 442-9-452ms    | [S5,MB2,BW] 452-9-462ms    | [S1,MB6,F]  475-10-486ms   | [S1,MB0,BI] 491-14-506ms   | [S5,MB3,BW] 506-9-515ms    | [S1,MB7,F]  526-11-537ms   | [S1,MB1,BI] 542-14-556ms   | [S1,MB0,BW] 557-15-572ms   | [S5,MB4,F]  573-7-580ms    | [S1,MB2,BI] 591-15-606ms   | [S1,MB1,BW] 606-15-621ms   | [S5,MB5,F]  622-7-630ms    | [S1,MB3,BI] 640-15-655ms   | [S1,MB2,BW] 656-15-671ms   | [S5,MB6,F]  671-7-679ms    | [S5,MB4,BI] 714-10-724ms   | [S1,MB3,BW] 724-15-740ms   | [S5,MB7,F]  740-7-747ms    | [S5,MB5,BI] 789-9-799ms    | [S5,MB4,BW] 799-9-808ms    | [S5,MB6,BI] 865-9-874ms    | [S5,MB5,BW] 875-10-885ms   | [S5,MB7,BI] 938-9-947ms    | [S5,MB6,BW] 947-10-957ms   | [S1,MB4,BI] 977-13-990ms   | [S5,MB7,BW] 991-10-1001ms  | [S1,MB5,BI] 1017-14-1031ms | [S1,MB4,BW] 1031-15-1046ms | [S1,MB6,BI] 1056-14-1070ms | [S1,MB5,BW] 1071-15-1086ms | [S1,MB7,BI] 1097-14-1111ms | [S1,MB6,BW] 1111-15-1126ms | [S1,MB7,BW] 1126-15-1141ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  183-6-189ms    | [S6,MB0,BI] 242-9-251ms    | [S6,MB2,F]  251-8-259ms    | [S6,MB1,BI] 302-9-311ms    | [S6,MB3,F]  311-8-319ms    | [S6,MB2,BI] 364-8-372ms    | [S6,MB0,BW] 373-10-383ms   | [S2,MB4,F]  383-7-390ms    | [S6,MB3,BI] 426-9-436ms    | [S6,MB1,BW] 436-10-446ms   | [S2,MB5,F]  446-7-453ms    | [S2,MB0,BI] 474-9-484ms    | [S6,MB2,BW] 484-10-495ms   | [S2,MB6,F]  495-7-502ms    | [S2,MB1,BI] 525-9-535ms    | [S6,MB3,BW] 535-10-546ms   | [S2,MB7,F]  546-7-553ms    | [S2,MB2,BI] 574-9-584ms    | [S2,MB0,BW] 584-10-594ms   | [S6,MB4,F]  594-7-601ms    | [S2,MB3,BI] 623-10-633ms   | [S2,MB1,BW] 633-10-644ms   | [S6,MB5,F]  644-7-651ms    | [S6,MB4,BI] 697-9-707ms    | [S2,MB2,BW] 707-10-718ms   | [S6,MB6,F]  718-7-725ms    | [S6,MB5,BI] 772-9-782ms    | [S2,MB3,BW] 782-10-792ms   | [S6,MB7,F]  793-7-800ms    | [S6,MB6,BI] 848-9-858ms    | [S6,MB4,BW] 858-10-868ms   | [S6,MB7,BI] 922-8-931ms    | [S6,MB5,BW] 931-10-941ms   | [S2,MB4,BI] 961-9-970ms    | [S6,MB6,BW] 970-10-980ms   | [S2,MB5,BI] 1001-9-1010ms  | [S6,MB7,BW] 1010-10-1020ms | [S2,MB6,BI] 1041-9-1050ms  | [S2,MB4,BW] 1050-10-1060ms | [S2,MB7,BI] 1081-9-1090ms  | [S2,MB5,BW] 1090-10-1100ms | [S2,MB6,BW] 1100-9-1110ms  | [S2,MB7,BW] 1109-9-1119ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,BI] 204-31-236ms   | [S7,MB1,F]  236-14-250ms   | [S7,MB1,BI] 262-32-295ms   | [S7,MB2,F]  295-16-311ms   | [S7,MB2,BI] 324-33-357ms   | [S7,MB3,F]  357-16-373ms   | [S7,MB3,BI] 385-33-419ms   | [S7,MB0,BW] 419-27-446ms   | [S3,MB4,F]  446-8-454ms    | [S3,MB0,BI] 454-12-467ms   | [S7,MB1,BW] 467-29-496ms   | [S3,MB5,F]  496-9-505ms    | [S3,MB1,BI] 505-12-518ms   | [S7,MB2,BW] 518-28-546ms   | [S3,MB6,F]  546-8-555ms    | [S3,MB2,BI] 555-11-567ms   | [S7,MB3,BW] 567-28-595ms   | [S3,MB7,F]  596-8-604ms    | [S3,MB3,BI] 605-11-617ms   | [S3,MB0,BW] 617-12-629ms   | [S7,MB4,F]  629-16-645ms   | [S7,MB4,BI] 657-33-690ms   | [S3,MB1,BW] 691-11-702ms   | [S7,MB5,F]  703-18-721ms   | [S7,MB5,BI] 732-33-766ms   | [S3,MB2,BW] 766-11-777ms   | [S7,MB6,F]  777-17-794ms   | [S7,MB6,BI] 807-33-841ms   | [S3,MB3,BW] 841-12-853ms   | [S7,MB7,F]  853-18-871ms   | [S7,MB7,BI] 882-33-915ms   | [S7,MB4,BW] 916-29-945ms   | [S3,MB4,BI] 943-11-954ms   | [S7,MB5,BW] 954-29-983ms   | [S3,MB5,BI] 983-11-994ms   | [S7,MB6,BW] 995-28-1023ms  | [S3,MB6,BI] 1023-11-1034ms | [S7,MB7,BW] 1034-28-1063ms | [S3,MB7,BI] 1063-11-1074ms | [S3,MB4,BW] 1074-12-1086ms | [S3,MB5,BW] 1086-11-1098ms | [S3,MB6,BW] 1098-11-1109ms | [S3,MB7,BW] 1109-11-1120ms
[rank0]:2025-12-31 11:07:42,442 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 11:07:47,217 - Avg. fwd time: 7.9160 / Avg. full-bwd time: 23.9296 (Avg. bwd-weight time: 9.7656 / Avg. bwd-input time: 9.7714) / Avg. batch time: 1150.5124 (ms) / GPU bubble ratio: 58.77%
[rank3]:2025-12-31 11:07:47,210 - Avg. fwd time: 12.5617 / Avg. bwd-weight time: 20.2131 / Avg. bwd-input time: 22.5725 / Avg. batch time: 1100.1949 (ms) / GPU bubble ratio: 19.51%
[rank1]:2025-12-31 11:07:47,224 - Avg. fwd time: 9.4013 / Avg. bwd-weight time: 12.6784 / Avg. bwd-input time: 12.1486 / Avg. batch time: 1142.3624 (ms) / GPU bubble ratio: 52.06%
[rank1]:2025-12-31 11:07:47,256 -  step: 750  loss: -4.0000  grad_norm:  0.1957  memory: 19.02GiB(40.04%)  tps: 6,926  tflops: 54.15  mfu: 17.35%
[rank2]:2025-12-31 11:07:47,204 - Avg. fwd time: 7.3042 / Avg. bwd-weight time: 10.3072 / Avg. bwd-input time: 9.5135 / Avg. batch time: 1107.0925 (ms) / GPU bubble ratio: 60.80%
[rank2]:2025-12-31 11:07:47,252 -  step: 750  loss: -4.0000  grad_norm:  0.1957  memory: 14.54GiB(30.61%)  tps: 6,926  tflops: 54.15  mfu: 17.35%
[rank0]:2025-12-31 11:07:47,266 -  step: 750  loss: -4.0000  grad_norm:  0.1957  memory: 17.77GiB(37.40%)  tps: 6,926  tflops: 54.15  mfu: 17.35%
[rank3]:2025-12-31 11:07:47,264 -  step: 750  loss:  0.2257  grad_norm:  0.1957  memory: 37.14GiB(78.18%)  tps: 6,926  tflops: 54.15  mfu: 17.35%
[rank0]:2025-12-31 11:11:38,719 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 11:11:43,495 - Avg. fwd time: 9.4020 / Avg. bwd-weight time: 12.6777 / Avg. bwd-input time: 12.1493 / Avg. batch time: 1142.4367 (ms) / GPU bubble ratio: 52.06%
[rank2]:2025-12-31 11:11:43,476 - Avg. fwd time: 7.3044 / Avg. bwd-weight time: 10.3072 / Avg. bwd-input time: 9.5140 / Avg. batch time: 1107.1945 (ms) / GPU bubble ratio: 60.80%
[rank3]:2025-12-31 11:11:43,482 - Avg. fwd time: 12.5646 / Avg. bwd-weight time: 20.2176 / Avg. bwd-input time: 22.5752 / Avg. batch time: 1100.3582 (ms) / GPU bubble ratio: 19.51%
[rank3]:2025-12-31 11:11:43,536 -  step: 800  loss:  0.2262  grad_norm:  0.1814  memory: 37.14GiB(78.18%)  tps: 6,934  tflops: 54.21  mfu: 17.38%
[rank3]:2025-12-31 11:11:43,537 - â„¹ï¸ final step: 800  loss:  0.2262  grad_norm:  0.1814  tps: 7,371  tflops: 57.63  mfu: 16.96%
[rank3]:2025-12-31 11:11:43,537 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 11:11:43,538 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 11:11:43,489 - Avg. fwd time: 7.9164 / Avg. full-bwd time: 23.9318 (Avg. bwd-weight time: 9.7655 / Avg. bwd-input time: 9.7724) / Avg. batch time: 1150.6086 (ms) / GPU bubble ratio: 58.77%
[rank0]:2025-12-31 11:11:43,538 -  step: 800  loss: -4.0000  grad_norm:  0.1814  memory: 17.77GiB(37.40%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank0]:2025-12-31 11:11:43,538 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1814  tps: 7,367  tflops: 57.59  mfu: 16.84%
[rank0]:2025-12-31 11:11:43,538 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 11:11:43,539 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 11:11:43,528 -  step: 800  loss: -4.0000  grad_norm:  0.1814  memory: 19.02GiB(40.04%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank1]:2025-12-31 11:11:43,528 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1814  tps: 7,368  tflops: 57.60  mfu: 16.87%
[rank1]:2025-12-31 11:11:43,528 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 11:11:43,528 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-31 11:11:43,524 -  step: 800  loss: -4.0000  grad_norm:  0.1814  memory: 14.54GiB(30.61%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank2]:2025-12-31 11:11:43,524 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1814  tps: 7,367  tflops: 57.59  mfu: 16.84%
[rank2]:2025-12-31 11:11:43,524 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 11:11:43,525 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-31 11:11:45,518 - Destroying the purge thread.
[rank0]:2025-12-31 11:11:45,487 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-31 11:11:45,517 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-31 11:11:45,518 - Destroying the purge thread.
[rank1]:2025-12-31 11:11:45,595 - Process group destroyed
[rank2]:2025-12-31 11:11:45,587 - Process group destroyed
[rank3]:2025-12-31 11:11:45,853 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1111_final800_rank3.svg
[rank3]:			> Batch Time: 1149.66 ms, GPU Bubble Ratio: 58.59%, 52.28%, 62.19%, 22.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S4,MB0,BI] 275-9-284ms    | [S4,MB0,BW] 284-9-294ms    | [S0,MB4,F]  294-7-301ms    | [S4,MB1,BI] 335-10-345ms   | [S4,MB1,BW] 345-9-354ms    | [S0,MB5,F]  354-7-362ms    | [S4,MB2,BI] 408-10-419ms   | [S4,MB2,BW] 419-9-428ms    | [S0,MB6,F]  429-7-436ms    | [S4,MB3,BI] 476-10-487ms   | [S4,MB3,BW] 487-9-497ms    | [S0,MB7,F]  497-7-504ms    | [S0,MB0,B]  528-24-552ms   | [S4,MB4,F]  551-7-559ms    | [S0,MB1,B]  574-24-599ms   | [S4,MB5,F]  599-7-606ms    | [S0,MB2,B]  624-24-648ms   | [S4,MB6,F]  648-7-655ms    | [S0,MB3,B]  665-24-689ms   | [S4,MB7,F]  689-7-696ms    | [S4,MB4,BI] 733-10-743ms   | [S4,MB4,BW] 744-9-753ms    | [S4,MB5,BI] 833-9-842ms    | [S4,MB5,BW] 842-9-851ms    | [S4,MB6,BI] 885-9-894ms    | [S4,MB6,BW] 894-9-903ms    | [S4,MB7,BI] 959-9-968ms    | [S4,MB7,BW] 968-9-978ms    | [S0,MB4,B]  1004-23-1028ms | [S0,MB5,B]  1045-23-1068ms | [S0,MB6,B]  1085-23-1108ms | [S0,MB7,B]  1126-23-1149ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-134ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB0,BI] 258-9-268ms    | [S5,MB3,F]  268-8-276ms    | [S5,MB1,BI] 319-9-328ms    | [S5,MB0,BW] 328-10-339ms   | [S1,MB4,F]  338-10-349ms   | [S5,MB2,BI] 380-10-390ms   | [S5,MB1,BW] 390-9-399ms    | [S1,MB5,F]  408-11-419ms   | [S5,MB3,BI] 443-10-453ms   | [S5,MB2,BW] 453-9-463ms    | [S1,MB6,F]  477-11-488ms   | [S1,MB0,BI] 493-14-508ms   | [S5,MB3,BW] 508-9-517ms    | [S1,MB7,F]  528-11-539ms   | [S1,MB1,BI] 544-14-559ms   | [S1,MB0,BW] 559-15-574ms   | [S5,MB4,F]  575-7-583ms    | [S1,MB2,BI] 593-15-608ms   | [S1,MB1,BW] 609-15-624ms   | [S5,MB5,F]  625-7-633ms    | [S1,MB3,BI] 643-15-658ms   | [S1,MB2,BW] 659-15-674ms   | [S5,MB6,F]  674-7-682ms    | [S5,MB4,BI] 717-10-727ms   | [S1,MB3,BW] 727-15-742ms   | [S5,MB7,F]  742-7-749ms    | [S5,MB5,BI] 792-10-802ms   | [S5,MB4,BW] 802-9-811ms    | [S5,MB6,BI] 869-9-878ms    | [S5,MB5,BW] 878-10-888ms   | [S5,MB7,BI] 943-9-952ms    | [S5,MB6,BW] 952-10-962ms   | [S1,MB4,BI] 984-13-997ms   | [S5,MB7,BW] 997-10-1007ms  | [S1,MB5,BI] 1024-14-1038ms | [S1,MB4,BW] 1038-15-1053ms | [S1,MB6,BI] 1064-14-1078ms | [S1,MB5,BW] 1078-15-1093ms | [S1,MB7,BI] 1104-14-1119ms | [S1,MB6,BW] 1119-15-1134ms | [S1,MB7,BW] 1134-15-1149ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB0,BI] 243-9-252ms    | [S6,MB2,F]  252-8-260ms    | [S6,MB1,BI] 303-9-312ms    | [S6,MB3,F]  312-8-320ms    | [S6,MB2,BI] 364-8-373ms    | [S6,MB0,BW] 373-10-384ms   | [S2,MB4,F]  383-7-390ms    | [S6,MB3,BI] 427-9-437ms    | [S6,MB1,BW] 437-10-447ms   | [S2,MB5,F]  447-7-454ms    | [S2,MB0,BI] 477-9-487ms    | [S6,MB2,BW] 487-10-497ms   | [S2,MB6,F]  497-7-505ms    | [S2,MB1,BI] 527-9-537ms    | [S6,MB3,BW] 537-10-548ms   | [S2,MB7,F]  548-7-555ms    | [S2,MB2,BI] 576-10-586ms   | [S2,MB0,BW] 586-10-597ms   | [S6,MB4,F]  597-7-604ms    | [S2,MB3,BI] 626-10-636ms   | [S2,MB1,BW] 636-10-647ms   | [S6,MB5,F]  647-7-654ms    | [S6,MB4,BI] 700-9-710ms    | [S2,MB2,BW] 710-10-720ms   | [S6,MB6,F]  720-7-727ms    | [S6,MB5,BI] 775-9-785ms    | [S2,MB3,BW] 785-10-795ms   | [S6,MB7,F]  796-7-803ms    | [S6,MB6,BI] 851-9-861ms    | [S6,MB4,BW] 861-10-871ms   | [S6,MB7,BI] 927-8-936ms    | [S6,MB5,BW] 936-10-946ms   | [S2,MB4,BI] 968-9-977ms    | [S6,MB6,BW] 977-10-987ms   | [S2,MB5,BI] 1008-9-1017ms  | [S6,MB7,BW] 1017-10-1028ms | [S2,MB6,BI] 1048-9-1057ms  | [S2,MB4,BW] 1057-10-1068ms | [S2,MB7,BI] 1088-9-1097ms  | [S2,MB5,BW] 1097-10-1108ms | [S2,MB6,BW] 1107-9-1117ms  | [S2,MB7,BW] 1117-9-1127ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,BI] 204-32-236ms   | [S7,MB1,F]  236-14-251ms   | [S7,MB1,BI] 263-32-296ms   | [S7,MB2,F]  296-16-312ms   | [S7,MB2,BI] 324-33-358ms   | [S7,MB3,F]  358-16-375ms   | [S7,MB3,BI] 386-33-420ms   | [S7,MB0,BW] 420-27-448ms   | [S3,MB4,F]  447-8-456ms    | [S3,MB0,BI] 456-12-469ms   | [S7,MB1,BW] 469-29-498ms   | [S3,MB5,F]  498-9-508ms    | [S3,MB1,BI] 507-12-520ms   | [S7,MB2,BW] 520-28-549ms   | [S3,MB6,F]  549-8-557ms    | [S3,MB2,BI] 558-11-570ms   | [S7,MB3,BW] 570-28-598ms   | [S3,MB7,F]  598-9-607ms    | [S3,MB3,BI] 607-12-619ms   | [S3,MB0,BW] 619-12-632ms   | [S7,MB4,F]  631-16-648ms   | [S7,MB4,BI] 660-33-693ms   | [S3,MB1,BW] 693-11-705ms   | [S7,MB5,F]  705-18-723ms   | [S7,MB5,BI] 735-33-769ms   | [S3,MB2,BW] 769-11-780ms   | [S7,MB6,F]  781-18-799ms   | [S7,MB6,BI] 811-33-845ms   | [S3,MB3,BW] 845-11-856ms   | [S7,MB7,F]  856-18-875ms   | [S7,MB7,BI] 887-33-921ms   | [S7,MB4,BW] 921-28-950ms   | [S3,MB4,BI] 949-11-961ms   | [S7,MB5,BW] 961-29-990ms   | [S3,MB5,BI] 990-11-1001ms  | [S7,MB6,BW] 1001-28-1030ms | [S3,MB6,BI] 1030-11-1041ms | [S7,MB7,BW] 1041-28-1070ms | [S3,MB7,BI] 1070-11-1081ms | [S3,MB4,BW] 1081-12-1093ms | [S3,MB5,BW] 1094-11-1106ms | [S3,MB6,BW] 1105-11-1117ms | [S3,MB7,BW] 1116-11-1128ms
[rank3]:2025-12-31 11:11:46,186 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1/pipeline_schedule/251231_1111_thry_final800_rank3.svg
[rank3]:			> Batch Time: 473.74 ms, GPU Bubble Ratio: 5.88%, 5.88%, 5.88%, 5.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-9-37ms      | [S4,MB0,F]  37-9-46ms      | [S4,MB1,F]  46-9-55ms      | [S4,MB2,F]  55-9-65ms      | [S4,MB3,F]  65-9-74ms      | [S4,MB0,BI] 102-9-111ms    | [S4,MB0,BW] 111-9-120ms    | [S0,MB4,F]  120-9-130ms    | [S4,MB1,BI] 130-9-139ms    | [S4,MB1,BW] 139-9-148ms    | [S0,MB5,F]  148-9-157ms    | [S4,MB2,BI] 157-9-167ms    | [S4,MB2,BW] 167-9-176ms    | [S0,MB6,F]  176-9-185ms    | [S4,MB3,BI] 185-9-195ms    | [S4,MB3,BW] 195-9-204ms    | [S0,MB7,F]  204-9-213ms    | [S0,MB0,B]  213-18-232ms   | [S4,MB4,F]  232-9-241ms    | [S0,MB1,B]  241-18-260ms   | [S4,MB5,F]  260-9-269ms    | [S0,MB2,B]  269-18-287ms   | [S4,MB6,F]  287-9-297ms    | [S0,MB3,B]  297-18-315ms   | [S4,MB7,F]  315-9-325ms    | [S4,MB4,BI] 325-9-334ms    | [S4,MB4,BW] 334-9-343ms    | [S4,MB5,BI] 343-9-352ms    | [S4,MB5,BW] 352-9-362ms    | [S4,MB6,BI] 362-9-371ms    | [S4,MB6,BW] 371-9-380ms    | [S4,MB7,BI] 380-9-390ms    | [S4,MB7,BW] 390-9-399ms    | [S0,MB4,B]  399-18-418ms   | [S0,MB5,B]  418-18-436ms   | [S0,MB6,B]  436-18-455ms   | [S0,MB7,B]  455-18-473ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-18ms       | [S1,MB1,F]  18-9-27ms      | [S1,MB2,F]  27-9-37ms      | [S1,MB3,F]  37-9-46ms      | [S5,MB0,F]  46-9-55ms      | [S5,MB1,F]  55-9-65ms      | [S5,MB2,F]  65-9-74ms      | [S5,MB0,BI] 92-9-102ms     | [S5,MB3,F]  102-9-111ms    | [S5,MB1,BI] 111-9-120ms    | [S5,MB0,BW] 120-9-130ms    | [S1,MB4,F]  130-9-139ms    | [S5,MB2,BI] 139-9-148ms    | [S5,MB1,BW] 148-9-157ms    | [S1,MB5,F]  157-9-167ms    | [S5,MB3,BI] 167-9-176ms    | [S5,MB2,BW] 176-9-185ms    | [S1,MB6,F]  185-9-195ms    | [S1,MB0,BI] 195-9-204ms    | [S5,MB3,BW] 204-9-213ms    | [S1,MB7,F]  213-9-222ms    | [S1,MB1,BI] 222-9-232ms    | [S1,MB0,BW] 232-9-241ms    | [S5,MB4,F]  241-9-250ms    | [S1,MB2,BI] 250-9-260ms    | [S1,MB1,BW] 260-9-269ms    | [S5,MB5,F]  269-9-278ms    | [S1,MB3,BI] 278-9-287ms    | [S1,MB2,BW] 287-9-297ms    | [S5,MB6,F]  297-9-306ms    | [S5,MB4,BI] 306-9-315ms    | [S1,MB3,BW] 315-9-325ms    | [S5,MB7,F]  325-9-334ms    | [S5,MB5,BI] 334-9-343ms    | [S5,MB4,BW] 343-9-352ms    | [S5,MB6,BI] 352-9-362ms    | [S5,MB5,BW] 362-9-371ms    | [S5,MB7,BI] 371-9-380ms    | [S5,MB6,BW] 380-9-390ms    | [S1,MB4,BI] 390-9-399ms    | [S5,MB7,BW] 399-9-408ms    | [S1,MB5,BI] 408-9-418ms    | [S1,MB4,BW] 418-9-427ms    | [S1,MB6,BI] 427-9-436ms    | [S1,MB5,BW] 436-9-445ms    | [S1,MB7,BI] 445-9-455ms    | [S1,MB6,BW] 455-9-464ms    | [S1,MB7,BW] 464-9-473ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  18-9-27ms      | [S2,MB1,F]  27-9-37ms      | [S2,MB2,F]  37-9-46ms      | [S2,MB3,F]  46-9-55ms      | [S6,MB0,F]  55-9-65ms      | [S6,MB1,F]  65-9-74ms      | [S6,MB0,BI] 83-9-92ms      | [S6,MB2,F]  92-9-102ms     | [S6,MB1,BI] 102-9-111ms    | [S6,MB3,F]  111-9-120ms    | [S6,MB2,BI] 120-9-130ms    | [S6,MB0,BW] 130-9-139ms    | [S2,MB4,F]  139-9-148ms    | [S6,MB3,BI] 148-9-157ms    | [S6,MB1,BW] 157-9-167ms    | [S2,MB5,F]  167-9-176ms    | [S2,MB0,BI] 176-9-185ms    | [S6,MB2,BW] 185-9-195ms    | [S2,MB6,F]  195-9-204ms    | [S2,MB1,BI] 204-9-213ms    | [S6,MB3,BW] 213-9-222ms    | [S2,MB7,F]  222-9-232ms    | [S2,MB2,BI] 232-9-241ms    | [S2,MB0,BW] 241-9-250ms    | [S6,MB4,F]  250-9-260ms    | [S2,MB3,BI] 260-9-269ms    | [S2,MB1,BW] 269-9-278ms    | [S6,MB5,F]  278-9-287ms    | [S6,MB4,BI] 287-9-297ms    | [S2,MB2,BW] 297-9-306ms    | [S6,MB6,F]  306-9-315ms    | [S6,MB5,BI] 315-9-325ms    | [S2,MB3,BW] 325-9-334ms    | [S6,MB7,F]  334-9-343ms    | [S6,MB6,BI] 343-9-352ms    | [S6,MB4,BW] 352-9-362ms    | [S6,MB7,BI] 362-9-371ms    | [S6,MB5,BW] 371-9-380ms    | [S2,MB4,BI] 380-9-390ms    | [S6,MB6,BW] 390-9-399ms    | [S2,MB5,BI] 399-9-408ms    | [S6,MB7,BW] 408-9-418ms    | [S2,MB6,BI] 418-9-427ms    | [S2,MB4,BW] 427-9-436ms    | [S2,MB7,BI] 436-9-445ms    | [S2,MB5,BW] 445-9-455ms    | [S2,MB6,BW] 455-9-464ms    | [S2,MB7,BW] 464-9-473ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  27-9-37ms      | [S3,MB1,F]  37-9-46ms      | [S3,MB2,F]  46-9-55ms      | [S3,MB3,F]  55-9-65ms      | [S7,MB0,F]  65-9-74ms      | [S7,MB0,BI] 74-9-83ms      | [S7,MB1,F]  83-9-92ms      | [S7,MB1,BI] 92-9-102ms     | [S7,MB2,F]  102-9-111ms    | [S7,MB2,BI] 111-9-120ms    | [S7,MB3,F]  120-9-130ms    | [S7,MB3,BI] 130-9-139ms    | [S7,MB0,BW] 139-9-148ms    | [S3,MB4,F]  148-9-157ms    | [S3,MB0,BI] 157-9-167ms    | [S7,MB1,BW] 167-9-176ms    | [S3,MB5,F]  176-9-185ms    | [S3,MB1,BI] 185-9-195ms    | [S7,MB2,BW] 195-9-204ms    | [S3,MB6,F]  204-9-213ms    | [S3,MB2,BI] 213-9-222ms    | [S7,MB3,BW] 222-9-232ms    | [S3,MB7,F]  232-9-241ms    | [S3,MB3,BI] 241-9-250ms    | [S3,MB0,BW] 250-9-260ms    | [S7,MB4,F]  260-9-269ms    | [S7,MB4,BI] 269-9-278ms    | [S3,MB1,BW] 278-9-287ms    | [S7,MB5,F]  287-9-297ms    | [S7,MB5,BI] 297-9-306ms    | [S3,MB2,BW] 306-9-315ms    | [S7,MB6,F]  315-9-325ms    | [S7,MB6,BI] 325-9-334ms    | [S3,MB3,BW] 334-9-343ms    | [S7,MB7,F]  343-9-352ms    | [S7,MB7,BI] 352-9-362ms    | [S7,MB4,BW] 362-9-371ms    | [S3,MB4,BI] 371-9-380ms    | [S7,MB5,BW] 380-9-390ms    | [S3,MB5,BI] 390-9-399ms    | [S7,MB6,BW] 399-9-408ms    | [S3,MB6,BI] 408-9-418ms    | [S7,MB7,BW] 418-9-427ms    | [S3,MB7,BI] 427-9-436ms    | [S3,MB4,BW] 436-9-445ms    | [S3,MB5,BW] 445-9-455ms    | [S3,MB6,BW] 455-9-464ms    | [S3,MB7,BW] 464-9-473ms   
[rank3]:2025-12-31 11:11:46,187 - Destroying the purge thread.
[rank3]:wandb: uploading history steps 16-16, summary, console lines 266-278
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.44535
[rank3]:wandb:               final/avg_loss 0.22619
[rank3]:wandb:             final/avg_mfu(%) 16.96223
[rank3]:wandb:             final/avg_tflops 57.62541
[rank3]:wandb:    final/avg_throughput(tps) 7371.29734
[rank3]:wandb:              final/grad_norm 0.18141
[rank3]:wandb:               final/max_loss 0.22619
[rank3]:wandb:                    grad_norm 0.18141
[rank3]:wandb: loss_metrics/global_avg_loss 0.22619
[rank3]:wandb: loss_metrics/global_max_loss 0.22619
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_InterleavedZeroBubble_nofreeze_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/v1i0p5ke
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_nofreeze_22_dm1/20251231-1008/wandb/run-20251231_100843-v1i0p5ke/logs
[rank0]:2025-12-31 11:11:47,518 - Training completed
[rank0]:2025-12-31 11:11:47,518 - Destroying the purge thread.
[rank3]:2025-12-31 11:11:47,604 - Process group destroyed
[rank0]:2025-12-31 11:11:47,697 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: InterleavedZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_InterleavedZeroBubble_nofreeze_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
