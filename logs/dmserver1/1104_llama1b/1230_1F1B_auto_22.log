
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 00:22:18 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_1F1B_auto_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with auto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-12-31 00:22:24,812 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank2]:2025-12-31 00:22:24,821 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank0]:2025-12-31 00:22:24,969 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank1]:2025-12-31 00:22:25,079 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank3]:2025-12-31 00:22:25,216 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 00:22:25,221 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 00:22:25,219 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-31 00:22:25,223 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 00:22:25,327 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 00:22:25,330 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 00:22:25,333 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 00:22:25,334 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-31 00:22:25,391 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 00:22:25,396 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 00:22:25,728 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-31 00:22:28,765 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 00:22:28,804 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 00:22:28,829 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-31 00:22:28,830 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-31 00:22:28,835 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 00:22:28,906 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-31 00:22:28,872 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 00:22:28,900 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-31 00:22:28,901 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-31 00:22:29,029 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 00:22:29,029 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 00:22:29,030 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-31 00:22:29,060 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 00:22:29,100 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 00:22:29,102 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 00:22:29,128 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-31 00:22:29,129 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-31 00:22:29,084 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 00:22:29,084 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 00:22:29,084 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-31 00:22:29,334 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 00:22:29,334 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 00:22:29,335 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run hf0my93x
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_1F1B_auto_22_dm1/20251231-0022/wandb/run-20251231_002229-hf0my93x
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_1F1B_auto_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/hf0my93x
[rank3]:2025-12-31 00:22:31,120 - WandB logging enabled
[rank3]:2025-12-31 00:22:31,121 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 00:22:31,160 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 00:22:31,189 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-31 00:22:31,190 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-31 00:22:31,394 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 00:22:31,394 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_1F1B_auto_22_dm1
[rank0]:2025-12-31 00:22:31,395 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 00:22:31,395 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 00:22:31,395 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-31 00:22:31,394 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-31 00:22:31,377 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 00:22:31,378 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 00:22:31,379 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-31 00:22:31,393 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 00:22:33,823 - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-12-31 00:22:33,824 - Finished loading the checkpoint in 2.43 seconds.
[rank0]:2025-12-31 00:22:33,824 - Training starts at step 1
[rank1]:2025-12-31 00:22:39,056 -  step:  1  loss: -4.0000  grad_norm: 203.0668  memory: 10.58GiB(22.26%)  tps: 3,196  tflops: 24.99  mfu: 8.01%
[rank1]:2025-12-31 00:22:39,061 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 00:22:39,063 -  step:  1  loss: 10.6092  grad_norm: 203.0668  memory: 21.88GiB(46.05%)  tps: 4,148  tflops: 32.42  mfu: 10.39%
[rank3]:2025-12-31 00:22:39,064 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 00:22:39,053 -  step:  1  loss: -4.0000  grad_norm: 203.0668  memory:  6.84GiB(14.41%)  tps: 3,219  tflops: 25.16  mfu: 8.07%
[rank2]:2025-12-31 00:22:39,053 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 00:22:39,091 -  step:  1  loss: -4.0000  grad_norm: 203.0668  memory: 13.10GiB(27.57%)  tps: 3,280  tflops: 25.64  mfu: 8.22%
[rank0]:2025-12-31 00:22:39,091 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 00:26:32,187 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 00:26:36,851 - Avg. fwd time: 24.6867 / Avg. bwd time: 81.0878 / Avg. batch time: 991.6016 (ms) / GPU bubble ratio: 14.66%
[rank1]:2025-12-31 00:26:36,946 - Avg. fwd time: 19.6609 / Avg. bwd time: 45.5691 / Avg. batch time: 1122.5033 (ms) / GPU bubble ratio: 53.51%
[rank2]:2025-12-31 00:26:36,894 - Avg. fwd time: 14.9170 / Avg. bwd time: 35.2781 / Avg. batch time: 1049.8079 (ms) / GPU bubble ratio: 61.75%
[rank1]:2025-12-31 00:26:37,019 -  step: 50  loss: -4.0000  grad_norm: 23.9631  memory: 12.86GiB(27.07%)  tps: 6,748  tflops: 52.75  mfu: 16.91%
[rank2]:2025-12-31 00:26:37,015 -  step: 50  loss: -4.0000  grad_norm: 23.9631  memory:  8.66GiB(18.23%)  tps: 6,747  tflops: 52.75  mfu: 16.91%
[rank3]:2025-12-31 00:26:37,028 -  step: 50  loss:  9.8807  grad_norm: 23.9631  memory: 25.79GiB(54.28%)  tps: 6,747  tflops: 52.75  mfu: 16.91%
[rank0]:2025-12-31 00:26:36,994 - Avg. fwd time: 16.1495 / Avg. bwd time: 41.8802 / Avg. batch time: 1188.4773 (ms) / GPU bubble ratio: 60.94%
[rank0]:2025-12-31 00:26:37,032 -  step: 50  loss: -4.0000  grad_norm: 23.9631  memory: 16.87GiB(35.50%)  tps: 6,748  tflops: 52.75  mfu: 16.91%
[rank3]:2025-12-31 00:27:20,763 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 00:27:20,751 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-31 00:27:20,756 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-31 00:27:20,770 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-31 00:28:09,194 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7186e+00
[rank3]:2025-12-31 00:28:09,201 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6476e+00
[rank2]:2025-12-31 00:28:09,190 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2190e+00
[rank0]:2025-12-31 00:28:09,208 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.8802e+00
[rank3]:2025-12-31 00:28:55,530 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6818e+00
[rank2]:2025-12-31 00:28:55,511 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4043e+00
[rank1]:2025-12-31 00:28:55,527 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7587e+00
[rank0]:2025-12-31 00:28:55,540 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.0986e+00
[rank3]:2025-12-31 00:29:43,973 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3171e+00
[rank1]:2025-12-31 00:29:43,965 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4242e+00
[rank2]:2025-12-31 00:29:43,961 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0909e+00
[rank0]:2025-12-31 00:29:43,975 - Freezing Ratio: [Stage0] 0.00, Threshold: 7.8652e+00
[rank2]:2025-12-31 00:30:28,345 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6666e+00
[rank3]:2025-12-31 00:30:28,361 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8060e+00
[rank1]:2025-12-31 00:30:28,361 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9512e+00
[rank0]:2025-12-31 00:30:28,341 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 00:30:28,375 - Freezing Ratio: [Stage0] 0.24, Threshold: 4.4540e+00
[rank2]:2025-12-31 00:30:32,987 - Avg. fwd time: 15.0621 / Avg. bwd time: 32.7027 / Avg. batch time: 1033.8470 (ms) / GPU bubble ratio: 63.04%
[rank3]:2025-12-31 00:30:32,945 - Avg. fwd time: 24.9157 / Avg. bwd time: 79.2488 / Avg. batch time: 978.6530 (ms) / GPU bubble ratio: 14.85%
[rank2]:2025-12-31 00:30:33,084 -  step: 100  loss: -4.0000  grad_norm: 15.9231  memory:  8.66GiB(18.23%)  tps: 6,940  tflops: 54.26  mfu: 17.39%
[rank3]:2025-12-31 00:30:33,097 -  step: 100  loss:  8.3436  grad_norm: 15.9231  memory: 25.79GiB(54.28%)  tps: 6,940  tflops: 54.26  mfu: 17.39%
[rank1]:2025-12-31 00:30:33,020 - Avg. fwd time: 19.6847 / Avg. bwd time: 45.5416 / Avg. batch time: 1106.1306 (ms) / GPU bubble ratio: 52.83%
[rank1]:2025-12-31 00:30:33,075 -  step: 100  loss: -4.0000  grad_norm: 15.9231  memory: 12.86GiB(27.07%)  tps: 6,941  tflops: 54.26  mfu: 17.39%
[rank0]:2025-12-31 00:30:33,064 - Avg. fwd time: 16.1897 / Avg. bwd time: 41.4578 / Avg. batch time: 1171.2854 (ms) / GPU bubble ratio: 60.63%
[rank0]:2025-12-31 00:30:33,098 -  step: 100  loss: -4.0000  grad_norm: 15.9231  memory: 16.87GiB(35.50%)  tps: 6,940  tflops: 54.26  mfu: 17.39%
[rank2]:2025-12-31 00:30:33,171 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0030_stage2_step100.svg
[rank1]:2025-12-31 00:30:33,173 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0030_stage1_step100.svg
[rank0]:2025-12-31 00:30:33,167 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0030_stage0_step100.svg
[rank3]:2025-12-31 00:30:33,273 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0030_step100_rank3.svg
[rank3]:			> Batch Time: 1084.00 ms, GPU Bubble Ratio: 56.96%, 51.59%, 72.24%, 29.67%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-16-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  250-42-293ms   | [S0,MB4,F]  293-15-308ms   | [S0,MB1,B]  362-42-404ms   | [S0,MB5,F]  404-15-420ms   | [S0,MB2,B]  476-42-518ms   | [S0,MB6,F]  518-15-534ms   | [S0,MB3,B]  591-42-633ms   | [S0,MB7,F]  633-15-649ms   | [S0,MB4,B]  707-42-749ms   | [S0,MB5,B]  821-42-863ms   | [S0,MB6,B]  930-42-972ms   | [S0,MB7,B]  1042-42-1084ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-18-61ms     | [S1,MB2,F]  67-18-85ms     | [S1,MB0,B]  196-45-242ms   | [S1,MB3,F]  247-19-266ms   | [S1,MB1,B]  308-45-354ms   | [S1,MB4,F]  359-20-379ms   | [S1,MB2,B]  422-46-468ms   | [S1,MB5,F]  472-20-493ms   | [S1,MB3,B]  537-45-583ms   | [S1,MB6,F]  587-20-607ms   | [S1,MB4,B]  653-45-699ms   | [S1,MB7,F]  703-20-724ms   | [S1,MB5,B]  768-45-814ms   | [S1,MB6,B]  877-45-923ms   | [S1,MB7,B]  990-45-1035ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-15-76ms     | [S2,MB0,B]  163-22-186ms   | [S2,MB2,F]  193-15-208ms   | [S2,MB1,B]  276-22-298ms   | [S2,MB3,F]  305-15-320ms   | [S2,MB2,B]  389-22-412ms   | [S2,MB4,F]  419-15-434ms   | [S2,MB3,B]  504-22-526ms   | [S2,MB5,F]  533-15-549ms   | [S2,MB4,B]  620-22-642ms   | [S2,MB6,F]  650-15-665ms   | [S2,MB5,B]  735-22-757ms   | [S2,MB7,F]  765-15-780ms   | [S2,MB6,B]  849-22-871ms   | [S2,MB7,B]  960-22-982ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-66-153ms    | [S3,MB1,F]  160-25-186ms   | [S3,MB1,B]  197-69-266ms   | [S3,MB2,F]  273-25-298ms   | [S3,MB2,B]  310-69-380ms   | [S3,MB3,F]  386-26-413ms   | [S3,MB3,B]  425-70-495ms   | [S3,MB4,F]  501-26-528ms   | [S3,MB4,B]  540-70-611ms   | [S3,MB5,F]  617-26-644ms   | [S3,MB5,B]  656-69-726ms   | [S3,MB6,F]  732-26-759ms   | [S3,MB6,B]  770-70-840ms   | [S3,MB7,F]  846-26-873ms   | [S3,MB7,B]  885-69-955ms  
[rank2]:2025-12-31 00:30:33,332 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0030_rank2_stage2.svg
[rank2]:	> Counts Sum: 54, Total Sum: 180 (30.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 00:30:33,319 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0030_stage3_step100.svg
[rank1]:2025-12-31 00:30:33,321 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0030_rank1_stage1.svg
[rank1]:	> Counts Sum: 36, Total Sum: 225 (16.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 00:30:33,321 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0030_rank0_stage0.svg
[rank0]:	> Counts Sum: 18, Total Sum: 185 (9.73%), Ratio(%) per element: [0.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 00:30:33,459 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0030_rank3_stage3.svg
[rank3]:	> Counts Sum: 27, Total Sum: 145 (18.62%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 00:31:16,117 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6930e+00
[rank1]:2025-12-31 00:31:16,105 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4801e+00
[rank3]:2025-12-31 00:31:16,128 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1579e-01
[rank0]:2025-12-31 00:31:16,129 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0188e+00
[rank2]:2025-12-31 00:32:00,770 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.9418e+00
[rank1]:2025-12-31 00:32:00,785 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.8803e-01
[rank3]:2025-12-31 00:32:00,785 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9940e+00
[rank0]:2025-12-31 00:32:00,801 - Freezing Ratio: [Stage0] 0.24, Threshold: 4.0257e+00
[rank2]:2025-12-31 00:32:48,333 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3590e+00
[rank1]:2025-12-31 00:32:48,321 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9739e+00
[rank3]:2025-12-31 00:32:48,345 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0093e+01
[rank0]:2025-12-31 00:32:48,347 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.3967e+01
[rank2]:2025-12-31 00:33:32,726 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6317e+00
[rank1]:2025-12-31 00:33:32,742 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5684e-01
[rank3]:2025-12-31 00:33:32,741 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7999e+00
[rank0]:2025-12-31 00:33:32,751 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.3874e+00
[rank2]:2025-12-31 00:34:20,212 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2697e+00
[rank1]:2025-12-31 00:34:20,200 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8297e+00
[rank3]:2025-12-31 00:34:20,224 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0289e+00
[rank0]:2025-12-31 00:34:20,205 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 00:34:20,227 - Freezing Ratio: [Stage0] 0.24, Threshold: 7.2335e+00
[rank2]:2025-12-31 00:34:24,566 - Avg. fwd time: 15.1259 / Avg. bwd time: 31.7484 / Avg. batch time: 1025.3888 (ms) / GPU bubble ratio: 63.43%
[rank3]:2025-12-31 00:34:24,536 - Avg. fwd time: 25.0320 / Avg. bwd time: 78.2018 / Avg. batch time: 971.1694 (ms) / GPU bubble ratio: 14.96%
[rank2]:2025-12-31 00:34:24,673 -  step: 150  loss: -4.0000  grad_norm: 21.1400  memory:  8.66GiB(18.23%)  tps: 7,075  tflops: 55.31  mfu: 17.73%
[rank1]:2025-12-31 00:34:24,618 - Avg. fwd time: 19.8244 / Avg. bwd time: 42.0534 / Avg. batch time: 1094.1103 (ms) / GPU bubble ratio: 54.76%
[rank1]:2025-12-31 00:34:24,687 -  step: 150  loss: -4.0000  grad_norm: 21.1400  memory: 12.86GiB(27.07%)  tps: 7,074  tflops: 55.30  mfu: 17.72%
[rank3]:2025-12-31 00:34:24,689 -  step: 150  loss:  3.7740  grad_norm: 21.1400  memory: 25.79GiB(54.28%)  tps: 7,075  tflops: 55.31  mfu: 17.73%
[rank0]:2025-12-31 00:34:24,662 - Avg. fwd time: 16.2499 / Avg. bwd time: 40.4051 / Avg. batch time: 1158.0609 (ms) / GPU bubble ratio: 60.86%
[rank0]:2025-12-31 00:34:24,696 -  step: 150  loss: -4.0000  grad_norm: 21.1400  memory: 16.87GiB(35.50%)  tps: 7,074  tflops: 55.30  mfu: 17.73%
[rank2]:2025-12-31 00:35:04,697 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2082e+00
[rank0]:2025-12-31 00:35:04,723 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.8788e+00
[rank1]:2025-12-31 00:35:04,713 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.4772e-01
[rank3]:2025-12-31 00:35:04,713 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6053e+00
[rank2]:2025-12-31 00:35:52,224 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5434e-01
[rank0]:2025-12-31 00:35:52,233 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.8028e+00
[rank3]:2025-12-31 00:35:52,236 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0239e+00
[rank1]:2025-12-31 00:35:52,213 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3191e+00
[rank2]:2025-12-31 00:36:36,499 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.8248e+00
[rank0]:2025-12-31 00:36:36,526 - Freezing Ratio: [Stage0] 0.49, Threshold: 4.4150e+00
[rank1]:2025-12-31 00:36:36,515 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7599e-01
[rank3]:2025-12-31 00:36:36,514 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5458e+00
[rank0]:2025-12-31 00:37:23,904 - Freezing Ratio: [Stage0] 0.24, Threshold: 5.4303e+00
[rank3]:2025-12-31 00:37:23,907 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6042e+00
[rank1]:2025-12-31 00:37:23,884 - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4850e+00
[rank2]:2025-12-31 00:37:23,896 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9180e+00
[rank0]:2025-12-31 00:38:08,162 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 00:38:08,181 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9111e+00
[rank1]:2025-12-31 00:38:08,181 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3871e-01
[rank2]:2025-12-31 00:38:08,166 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.6633e+00
[rank0]:2025-12-31 00:38:08,192 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7891e+00
[rank3]:2025-12-31 00:38:12,840 - Avg. fwd time: 25.1597 / Avg. bwd time: 77.1973 / Avg. batch time: 964.1424 (ms) / GPU bubble ratio: 15.07%
[rank2]:2025-12-31 00:38:12,884 - Avg. fwd time: 15.1847 / Avg. bwd time: 30.7572 / Avg. batch time: 1017.2602 (ms) / GPU bubble ratio: 63.87%
[rank0]:2025-12-31 00:38:12,958 - Avg. fwd time: 16.3098 / Avg. bwd time: 39.1762 / Avg. batch time: 1147.6156 (ms) / GPU bubble ratio: 61.32%
[rank3]:2025-12-31 00:38:12,990 -  step: 200  loss:  1.1581  grad_norm: 18.8425  memory: 25.79GiB(54.28%)  tps: 7,177  tflops: 56.10  mfu: 17.98%
[rank1]:2025-12-31 00:38:12,918 - Avg. fwd time: 19.8784 / Avg. bwd time: 41.0835 / Avg. batch time: 1084.9564 (ms) / GPU bubble ratio: 55.05%
[rank1]:2025-12-31 00:38:12,968 -  step: 200  loss: -4.0000  grad_norm: 18.8425  memory: 12.86GiB(27.07%)  tps: 7,177  tflops: 56.11  mfu: 17.98%
[rank2]:2025-12-31 00:38:12,978 -  step: 200  loss: -4.0000  grad_norm: 18.8425  memory:  8.66GiB(18.23%)  tps: 7,176  tflops: 56.10  mfu: 17.98%
[rank2]:2025-12-31 00:38:13,043 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0038_stage2_step200.svg
[rank0]:2025-12-31 00:38:12,988 -  step: 200  loss: -4.0000  grad_norm: 18.8425  memory: 16.87GiB(35.50%)  tps: 7,177  tflops: 56.10  mfu: 17.98%
[rank0]:2025-12-31 00:38:13,040 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0038_stage0_step200.svg
[rank1]:2025-12-31 00:38:13,045 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0038_stage1_step200.svg
[rank3]:2025-12-31 00:38:13,134 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0038_step200_rank3.svg
[rank3]:			> Batch Time: 1084.53 ms, GPU Bubble Ratio: 60.16%, 51.48%, 72.13%, 29.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-16-33ms     | [S0,MB2,F]  33-16-50ms     | [S0,MB3,F]  50-17-67ms     | [S0,MB0,B]  250-37-288ms   | [S0,MB4,F]  287-15-303ms   | [S0,MB1,B]  363-37-400ms   | [S0,MB5,F]  400-15-416ms   | [S0,MB2,B]  477-37-514ms   | [S0,MB6,F]  514-15-530ms   | [S0,MB3,B]  592-37-630ms   | [S0,MB7,F]  630-16-646ms   | [S0,MB4,B]  709-37-746ms   | [S0,MB5,B]  824-37-861ms   | [S0,MB6,B]  933-37-971ms   | [S0,MB7,B]  1047-37-1084ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  195-46-242ms   | [S1,MB3,F]  246-20-267ms   | [S1,MB1,B]  308-46-354ms   | [S1,MB4,F]  359-20-380ms   | [S1,MB2,B]  422-45-468ms   | [S1,MB5,F]  473-20-493ms   | [S1,MB3,B]  537-45-583ms   | [S1,MB6,F]  588-20-609ms   | [S1,MB4,B]  654-45-700ms   | [S1,MB7,F]  705-20-725ms   | [S1,MB5,B]  770-45-816ms   | [S1,MB6,B]  881-45-927ms   | [S1,MB7,B]  993-45-1039ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-15-76ms     | [S2,MB0,B]  163-22-185ms   | [S2,MB2,F]  192-15-208ms   | [S2,MB1,B]  275-22-297ms   | [S2,MB3,F]  305-15-320ms   | [S2,MB2,B]  389-22-412ms   | [S2,MB4,F]  419-15-434ms   | [S2,MB3,B]  505-22-527ms   | [S2,MB5,F]  534-15-550ms   | [S2,MB4,B]  622-22-644ms   | [S2,MB6,F]  651-15-667ms   | [S2,MB5,B]  738-22-760ms   | [S2,MB7,F]  767-15-783ms   | [S2,MB6,B]  852-22-875ms   | [S2,MB7,B]  965-22-987ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  87-65-153ms    | [S3,MB1,F]  160-24-185ms   | [S3,MB1,B]  197-69-266ms   | [S3,MB2,F]  272-25-298ms   | [S3,MB2,B]  310-70-380ms   | [S3,MB3,F]  386-26-413ms   | [S3,MB3,B]  425-70-495ms   | [S3,MB4,F]  502-26-528ms   | [S3,MB4,B]  541-70-611ms   | [S3,MB5,F]  618-26-645ms   | [S3,MB5,B]  658-70-728ms   | [S3,MB6,F]  735-26-761ms   | [S3,MB6,B]  772-70-843ms   | [S3,MB7,F]  849-26-876ms   | [S3,MB7,B]  888-70-959ms  
[rank3]:2025-12-31 00:38:13,179 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0038_stage3_step200.svg
[rank2]:2025-12-31 00:38:13,195 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0038_rank2_stage2.svg
[rank2]:	> Counts Sum: 189, Total Sum: 540 (35.00%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 00:38:13,197 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0038_rank0_stage0.svg
[rank0]:	> Counts Sum: 126, Total Sum: 555 (22.70%), Ratio(%) per element: [0.0, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 00:38:13,196 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0038_rank1_stage1.svg
[rank1]:	> Counts Sum: 216, Total Sum: 675 (32.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 00:38:13,309 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0038_rank3_stage3.svg
[rank3]:	> Counts Sum: 117, Total Sum: 435 (26.90%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 00:38:55,902 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8277e-01
[rank0]:2025-12-31 00:38:55,913 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.0659e+00
[rank3]:2025-12-31 00:38:55,913 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3612e+00
[rank1]:2025-12-31 00:38:55,890 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1244e+00
[rank1]:2025-12-31 00:39:40,094 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.2667e-01
[rank3]:2025-12-31 00:39:40,093 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8753e+00
[rank2]:2025-12-31 00:39:40,078 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2097e+00
[rank0]:2025-12-31 00:39:40,104 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1081e+00
[rank0]:2025-12-31 00:40:27,024 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5502e+00
[rank1]:2025-12-31 00:40:27,009 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1287e+01
[rank3]:2025-12-31 00:40:27,032 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9742e+00
[rank2]:2025-12-31 00:40:27,020 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4133e+00
[rank0]:2025-12-31 00:41:10,104 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7360e+00
[rank1]:2025-12-31 00:41:10,087 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1099e+00
[rank3]:2025-12-31 00:41:10,102 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7907e+00
[rank2]:2025-12-31 00:41:10,087 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8404e+00
[rank2]:2025-12-31 00:41:57,302 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3581e-01
[rank0]:2025-12-31 00:41:57,296 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 00:41:57,310 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3503e+00
[rank1]:2025-12-31 00:41:57,291 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.0323e-01
[rank3]:2025-12-31 00:41:57,315 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1397e+00
[rank3]:2025-12-31 00:42:01,488 - Avg. fwd time: 25.1773 / Avg. bwd time: 76.9381 / Avg. batch time: 962.2013 (ms) / GPU bubble ratio: 15.10%
[rank2]:2025-12-31 00:42:01,519 - Avg. fwd time: 15.1998 / Avg. bwd time: 30.6204 / Avg. batch time: 1015.1604 (ms) / GPU bubble ratio: 63.89%
[rank1]:2025-12-31 00:42:01,553 - Avg. fwd time: 19.9466 / Avg. bwd time: 39.1000 / Avg. batch time: 1080.8426 (ms) / GPU bubble ratio: 56.30%
[rank2]:2025-12-31 00:42:01,598 -  step: 250  loss: -4.0000  grad_norm:  3.9349  memory:  8.66GiB(18.23%)  tps: 7,166  tflops: 56.02  mfu: 17.96%
[rank0]:2025-12-31 00:42:01,589 - Avg. fwd time: 16.3813 / Avg. bwd time: 37.5393 / Avg. batch time: 1141.8087 (ms) / GPU bubble ratio: 62.22%
[rank0]:2025-12-31 00:42:01,612 -  step: 250  loss: -4.0000  grad_norm:  3.9349  memory: 16.87GiB(35.50%)  tps: 7,166  tflops: 56.02  mfu: 17.96%
[rank1]:2025-12-31 00:42:01,598 -  step: 250  loss: -4.0000  grad_norm:  3.9349  memory: 12.86GiB(27.07%)  tps: 7,166  tflops: 56.02  mfu: 17.96%
[rank3]:2025-12-31 00:42:01,613 -  step: 250  loss:  0.3858  grad_norm:  3.9349  memory: 25.79GiB(54.28%)  tps: 7,166  tflops: 56.02  mfu: 17.96%
[rank1]:2025-12-31 00:42:40,324 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4903e+00
[rank3]:2025-12-31 00:42:40,340 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6717e+00
[rank2]:2025-12-31 00:42:40,324 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.8419e+00
[rank0]:2025-12-31 00:42:40,340 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.9513e+00
[rank0]:2025-12-31 00:43:27,382 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0056e+00
[rank1]:2025-12-31 00:43:27,366 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2146e+00
[rank3]:2025-12-31 00:43:27,390 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1949e+00
[rank2]:2025-12-31 00:43:27,378 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5580e+00
[rank2]:2025-12-31 00:44:10,410 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.0330e+00
[rank3]:2025-12-31 00:44:10,425 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7087e+00
[rank1]:2025-12-31 00:44:10,410 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9948e+00
[rank0]:2025-12-31 00:44:10,428 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1895e+00
[rank2]:2025-12-31 00:44:57,668 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2791e+00
[rank3]:2025-12-31 00:44:57,680 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0029e+00
[rank0]:2025-12-31 00:44:57,674 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9724e+00
[rank1]:2025-12-31 00:44:57,657 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5301e+00
[rank1]:2025-12-31 00:45:40,557 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.6790e-01
[rank0]:2025-12-31 00:45:40,553 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 00:45:40,574 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1255e+00
[rank2]:2025-12-31 00:45:40,557 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3975e-01
[rank3]:2025-12-31 00:45:40,573 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8673e-01
[rank3]:2025-12-31 00:45:45,134 - Avg. fwd time: 25.2214 / Avg. bwd time: 76.4409 / Avg. batch time: 958.5622 (ms) / GPU bubble ratio: 15.15%
[rank2]:2025-12-31 00:45:45,177 - Avg. fwd time: 15.2238 / Avg. bwd time: 30.1833 / Avg. batch time: 1011.0240 (ms) / GPU bubble ratio: 64.07%
[rank1]:2025-12-31 00:45:45,212 - Avg. fwd time: 19.9938 / Avg. bwd time: 37.1542 / Avg. batch time: 1074.7317 (ms) / GPU bubble ratio: 57.46%
[rank1]:2025-12-31 00:45:45,257 -  step: 300  loss: -4.0000  grad_norm:  0.6369  memory: 12.86GiB(27.07%)  tps: 7,325  tflops: 57.27  mfu: 18.35%
[rank0]:2025-12-31 00:45:45,248 - Avg. fwd time: 16.4378 / Avg. bwd time: 36.0056 / Avg. batch time: 1134.1100 (ms) / GPU bubble ratio: 63.01%
[rank0]:2025-12-31 00:45:45,271 -  step: 300  loss: -4.0000  grad_norm:  0.6369  memory: 16.87GiB(35.50%)  tps: 7,325  tflops: 57.27  mfu: 18.35%
[rank2]:2025-12-31 00:45:45,266 -  step: 300  loss: -4.0000  grad_norm:  0.6369  memory:  8.66GiB(18.23%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank2]:2025-12-31 00:45:45,332 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0045_stage2_step300.svg
[rank3]:2025-12-31 00:45:45,280 -  step: 300  loss:  0.2836  grad_norm:  0.6369  memory: 25.79GiB(54.28%)  tps: 7,325  tflops: 57.27  mfu: 18.35%
[rank1]:2025-12-31 00:45:45,333 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0045_stage1_step300.svg
[rank0]:2025-12-31 00:45:45,331 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0045_stage0_step300.svg
[rank3]:2025-12-31 00:45:45,429 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0045_step300_rank3.svg
[rank3]:			> Batch Time: 1055.41 ms, GPU Bubble Ratio: 65.79%, 63.91%, 71.27%, 27.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  231-28-260ms   | [S0,MB4,F]  260-16-276ms   | [S0,MB1,B]  343-28-371ms   | [S0,MB5,F]  371-16-387ms   | [S0,MB2,B]  457-28-485ms   | [S0,MB6,F]  485-16-501ms   | [S0,MB3,B]  573-28-601ms   | [S0,MB7,F]  602-16-618ms   | [S0,MB4,B]  688-28-716ms   | [S0,MB5,B]  802-28-830ms   | [S0,MB6,B]  914-28-942ms   | [S0,MB7,B]  1027-28-1055ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  68-19-88ms     | [S1,MB0,B]  196-27-223ms   | [S1,MB3,F]  228-20-248ms   | [S1,MB1,B]  307-27-335ms   | [S1,MB4,F]  339-20-360ms   | [S1,MB2,B]  421-27-449ms   | [S1,MB5,F]  453-20-474ms   | [S1,MB3,B]  538-27-565ms   | [S1,MB6,F]  570-20-590ms   | [S1,MB4,B]  652-27-680ms   | [S1,MB7,F]  684-20-705ms   | [S1,MB5,B]  768-27-796ms   | [S1,MB6,B]  880-27-907ms   | [S1,MB7,B]  993-27-1020ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-77ms     | [S2,MB0,B]  163-22-185ms   | [S2,MB2,F]  192-15-208ms   | [S2,MB1,B]  275-22-297ms   | [S2,MB3,F]  304-15-320ms   | [S2,MB2,B]  388-22-411ms   | [S2,MB4,F]  418-15-434ms   | [S2,MB3,B]  505-22-527ms   | [S2,MB5,F]  534-15-550ms   | [S2,MB4,B]  620-22-642ms   | [S2,MB6,F]  649-15-665ms   | [S2,MB5,B]  736-22-758ms   | [S2,MB7,F]  765-15-781ms   | [S2,MB6,B]  851-22-873ms   | [S2,MB7,B]  964-22-986ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-65-153ms    | [S3,MB1,F]  160-24-184ms   | [S3,MB1,B]  197-69-266ms   | [S3,MB2,F]  272-25-297ms   | [S3,MB2,B]  310-69-380ms   | [S3,MB3,F]  386-26-412ms   | [S3,MB3,B]  424-70-495ms   | [S3,MB4,F]  502-26-528ms   | [S3,MB4,B]  539-70-609ms   | [S3,MB5,F]  617-26-643ms   | [S3,MB5,B]  655-70-725ms   | [S3,MB6,F]  733-26-759ms   | [S3,MB6,B]  770-70-840ms   | [S3,MB7,F]  848-26-874ms   | [S3,MB7,B]  887-70-957ms  
[rank3]:2025-12-31 00:45:45,474 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0045_stage3_step300.svg
[rank1]:2025-12-31 00:45:45,476 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0045_rank1_stage1.svg
[rank1]:	> Counts Sum: 540, Total Sum: 1125 (48.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 00:45:45,480 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0045_rank0_stage0.svg
[rank0]:	> Counts Sum: 378, Total Sum: 925 (40.86%), Ratio(%) per element: [0.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 00:45:45,484 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0045_rank2_stage2.svg
[rank2]:	> Counts Sum: 324, Total Sum: 900 (36.00%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 00:45:45,608 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0045_rank3_stage3.svg
[rank3]:	> Counts Sum: 207, Total Sum: 725 (28.55%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 00:46:27,914 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9149e-01
[rank0]:2025-12-31 00:46:27,929 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9802e-01
[rank2]:2025-12-31 00:46:27,925 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9322e-01
[rank3]:2025-12-31 00:46:27,937 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9427e-01
[rank2]:2025-12-31 00:47:11,035 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3299e+00
[rank1]:2025-12-31 00:47:11,036 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2957e+00
[rank3]:2025-12-31 00:47:11,051 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2043e+00
[rank0]:2025-12-31 00:47:11,053 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1607e+00
[rank2]:2025-12-31 00:47:58,283 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2774e-01
[rank1]:2025-12-31 00:47:58,272 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4811e+00
[rank3]:2025-12-31 00:47:58,295 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6498e+00
[rank0]:2025-12-31 00:47:58,288 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5946e+00
[rank1]:2025-12-31 00:48:41,388 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5822e-01
[rank3]:2025-12-31 00:48:41,404 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7401e-01
[rank0]:2025-12-31 00:48:41,405 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4619e+00
[rank2]:2025-12-31 00:48:41,388 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.1609e-01
[rank1]:2025-12-31 00:49:28,455 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1884e-01
[rank0]:2025-12-31 00:49:28,460 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 00:49:28,471 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7332e-01
[rank2]:2025-12-31 00:49:28,467 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2303e-01
[rank3]:2025-12-31 00:49:28,479 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2223e-01
[rank2]:2025-12-31 00:49:32,723 - Avg. fwd time: 15.2245 / Avg. bwd time: 30.1741 / Avg. batch time: 1010.7384 (ms) / GPU bubble ratio: 64.07%
[rank1]:2025-12-31 00:49:32,758 - Avg. fwd time: 20.0320 / Avg. bwd time: 35.7607 / Avg. batch time: 1073.0310 (ms) / GPU bubble ratio: 58.40%
[rank3]:2025-12-31 00:49:32,693 - Avg. fwd time: 25.2386 / Avg. bwd time: 76.3884 / Avg. batch time: 958.2717 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-31 00:49:32,803 -  step: 350  loss: -4.0000  grad_norm:  0.1968  memory:  8.66GiB(18.23%)  tps: 7,201  tflops: 56.29  mfu: 18.04%
[rank1]:2025-12-31 00:49:32,803 -  step: 350  loss: -4.0000  grad_norm:  0.1968  memory: 12.86GiB(27.07%)  tps: 7,200  tflops: 56.29  mfu: 18.04%
[rank3]:2025-12-31 00:49:32,819 -  step: 350  loss:  0.2355  grad_norm:  0.1968  memory: 25.79GiB(54.28%)  tps: 7,201  tflops: 56.29  mfu: 18.04%
[rank0]:2025-12-31 00:49:32,794 - Avg. fwd time: 16.4802 / Avg. bwd time: 34.9092 / Avg. batch time: 1131.2762 (ms) / GPU bubble ratio: 63.66%
[rank0]:2025-12-31 00:49:32,817 -  step: 350  loss: -4.0000  grad_norm:  0.1968  memory: 16.87GiB(35.50%)  tps: 7,200  tflops: 56.29  mfu: 18.04%
[rank2]:2025-12-31 00:50:11,630 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9695e-01
[rank1]:2025-12-31 00:50:11,631 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9278e-01
[rank3]:2025-12-31 00:50:11,646 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0343e-01
[rank0]:2025-12-31 00:50:11,646 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5194e+00
[rank1]:2025-12-31 00:50:58,866 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4622e+00
[rank3]:2025-12-31 00:50:58,889 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.0041e-01
[rank0]:2025-12-31 00:50:58,883 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0409e+00
[rank2]:2025-12-31 00:50:58,878 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2488e-01
[rank3]:2025-12-31 00:51:41,913 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8442e+00
[rank1]:2025-12-31 00:51:41,898 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0889e+00
[rank0]:2025-12-31 00:51:41,913 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3845e+00
[rank2]:2025-12-31 00:51:41,897 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8487e+00
[rank3]:2025-12-31 00:52:28,903 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9982e-01
[rank1]:2025-12-31 00:52:28,879 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3519e-01
[rank0]:2025-12-31 00:52:28,895 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3438e-01
[rank2]:2025-12-31 00:52:28,891 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3219e-01
[rank3]:2025-12-31 00:53:11,950 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9849e-01
[rank1]:2025-12-31 00:53:11,935 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6800e-01
[rank0]:2025-12-31 00:53:11,930 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 00:53:11,950 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.1433e-01
[rank2]:2025-12-31 00:53:11,934 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.9669e-01
[rank3]:2025-12-31 00:53:16,583 - Avg. fwd time: 25.2680 / Avg. bwd time: 76.0993 / Avg. batch time: 956.1939 (ms) / GPU bubble ratio: 15.19%
[rank1]:2025-12-31 00:53:16,662 - Avg. fwd time: 20.0567 / Avg. bwd time: 34.7137 / Avg. batch time: 1069.5890 (ms) / GPU bubble ratio: 59.03%
[rank2]:2025-12-31 00:53:16,627 - Avg. fwd time: 15.2413 / Avg. bwd time: 29.8972 / Avg. batch time: 1008.3520 (ms) / GPU bubble ratio: 64.19%
[rank2]:2025-12-31 00:53:16,717 -  step: 400  loss: -4.0000  grad_norm:  0.8131  memory:  8.66GiB(18.23%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank3]:2025-12-31 00:53:16,729 -  step: 400  loss:  0.2229  grad_norm:  0.8131  memory: 25.79GiB(54.28%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank1]:2025-12-31 00:53:16,707 -  step: 400  loss: -4.0000  grad_norm:  0.8131  memory: 12.86GiB(27.07%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank0]:2025-12-31 00:53:16,698 - Avg. fwd time: 16.5131 / Avg. bwd time: 34.0853 / Avg. batch time: 1126.9828 (ms) / GPU bubble ratio: 64.08%
[rank0]:2025-12-31 00:53:16,722 -  step: 400  loss: -4.0000  grad_norm:  0.8131  memory: 16.87GiB(35.50%)  tps: 7,317  tflops: 57.20  mfu: 18.33%
[rank0]:2025-12-31 00:53:16,783 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0053_stage0_step400.svg
[rank2]:2025-12-31 00:53:16,783 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0053_stage2_step400.svg
[rank1]:2025-12-31 00:53:16,785 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0053_stage1_step400.svg
[rank3]:2025-12-31 00:53:16,873 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0053_step400_rank3.svg
[rank3]:			> Batch Time: 1055.38 ms, GPU Bubble Ratio: 65.80%, 63.92%, 71.26%, 27.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  232-28-261ms   | [S0,MB4,F]  261-16-277ms   | [S0,MB1,B]  344-28-372ms   | [S0,MB5,F]  372-16-388ms   | [S0,MB2,B]  458-28-487ms   | [S0,MB6,F]  487-16-503ms   | [S0,MB3,B]  574-28-602ms   | [S0,MB7,F]  602-16-618ms   | [S0,MB4,B]  691-28-719ms   | [S0,MB5,B]  805-28-833ms   | [S0,MB6,B]  916-28-944ms   | [S0,MB7,B]  1027-28-1055ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  197-27-224ms   | [S1,MB3,F]  229-20-249ms   | [S1,MB1,B]  308-27-336ms   | [S1,MB4,F]  340-20-361ms   | [S1,MB2,B]  423-27-451ms   | [S1,MB5,F]  455-20-475ms   | [S1,MB3,B]  538-27-566ms   | [S1,MB6,F]  570-20-590ms   | [S1,MB4,B]  655-27-682ms   | [S1,MB7,F]  687-20-707ms   | [S1,MB5,B]  771-27-798ms   | [S1,MB6,B]  882-27-910ms   | [S1,MB7,B]  993-27-1021ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  164-22-187ms   | [S2,MB2,F]  194-15-209ms   | [S2,MB1,B]  276-22-298ms   | [S2,MB3,F]  305-15-321ms   | [S2,MB2,B]  391-22-413ms   | [S2,MB4,F]  420-15-436ms   | [S2,MB3,B]  506-22-528ms   | [S2,MB5,F]  535-15-551ms   | [S2,MB4,B]  622-22-645ms   | [S2,MB6,F]  652-15-667ms   | [S2,MB5,B]  738-22-761ms   | [S2,MB7,F]  768-15-783ms   | [S2,MB6,B]  854-22-876ms   | [S2,MB7,B]  965-22-987ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  87-66-154ms    | [S3,MB1,F]  161-24-186ms   | [S3,MB1,B]  198-69-267ms   | [S3,MB2,F]  273-25-298ms   | [S3,MB2,B]  312-69-381ms   | [S3,MB3,F]  388-26-415ms   | [S3,MB3,B]  426-70-496ms   | [S3,MB4,F]  503-26-529ms   | [S3,MB4,B]  541-70-612ms   | [S3,MB5,F]  619-25-645ms   | [S3,MB5,B]  658-71-729ms   | [S3,MB6,F]  735-26-761ms   | [S3,MB6,B]  773-70-844ms   | [S3,MB7,F]  851-26-877ms   | [S3,MB7,B]  889-70-959ms  
[rank3]:2025-12-31 00:53:16,921 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0053_stage3_step400.svg
[rank1]:2025-12-31 00:53:16,927 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0053_rank1_stage1.svg
[rank1]:	> Counts Sum: 900, Total Sum: 1575 (57.14%), Ratio(%) per element: [71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 00:53:16,930 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0053_rank0_stage0.svg
[rank0]:	> Counts Sum: 648, Total Sum: 1295 (50.04%), Ratio(%) per element: [0.0, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 00:53:16,932 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0053_rank2_stage2.svg
[rank2]:	> Counts Sum: 459, Total Sum: 1260 (36.43%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 00:53:17,086 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0053_rank3_stage3.svg
[rank3]:	> Counts Sum: 297, Total Sum: 1015 (29.26%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 00:53:43,520 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 00:53:43,940 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 00:53:43,969 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 00:53:44,000 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 00:53:59,371 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1513e+00
[rank3]:2025-12-31 00:53:59,394 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.3981e-01
[rank0]:2025-12-31 00:53:59,387 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7289e+00
[rank2]:2025-12-31 00:53:59,382 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2615e-01
[rank2]:2025-12-31 00:54:42,222 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.1281e+00
[rank1]:2025-12-31 00:54:42,222 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.6987e+00
[rank3]:2025-12-31 00:54:42,238 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.4691e+00
[rank0]:2025-12-31 00:54:42,237 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8688e+00
[rank1]:2025-12-31 00:55:29,106 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7987e+00
[rank3]:2025-12-31 00:55:29,129 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0062e+00
[rank0]:2025-12-31 00:55:29,121 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9702e+00
[rank2]:2025-12-31 00:55:29,117 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7641e-01
[rank2]:2025-12-31 00:56:12,145 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3132e+00
[rank1]:2025-12-31 00:56:12,145 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4031e+00
[rank3]:2025-12-31 00:56:12,160 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3081e+00
[rank0]:2025-12-31 00:56:12,164 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6826e+00
[rank2]:2025-12-31 00:56:59,302 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2042e-01
[rank1]:2025-12-31 00:56:59,291 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1862e+00
[rank3]:2025-12-31 00:56:59,315 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6572e+00
[rank0]:2025-12-31 00:56:59,297 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 00:56:59,310 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5789e+00
[rank2]:2025-12-31 00:57:03,524 - Avg. fwd time: 15.2376 / Avg. bwd time: 29.9160 / Avg. batch time: 1008.1623 (ms) / GPU bubble ratio: 64.17%
[rank3]:2025-12-31 00:57:03,493 - Avg. fwd time: 25.2605 / Avg. bwd time: 76.0772 / Avg. batch time: 955.9550 (ms) / GPU bubble ratio: 15.19%
[rank0]:2025-12-31 00:57:03,596 - Avg. fwd time: 16.5364 / Avg. bwd time: 33.4431 / Avg. batch time: 1125.2997 (ms) / GPU bubble ratio: 64.47%
[rank2]:2025-12-31 00:57:03,605 -  step: 450  loss: -4.0000  grad_norm:  0.2335  memory:  8.66GiB(18.23%)  tps: 7,221  tflops: 56.45  mfu: 18.09%
[rank1]:2025-12-31 00:57:03,560 - Avg. fwd time: 20.0762 / Avg. bwd time: 33.8969 / Avg. batch time: 1068.5708 (ms) / GPU bubble ratio: 59.59%
[rank1]:2025-12-31 00:57:03,605 -  step: 450  loss: -4.0000  grad_norm:  0.2335  memory: 12.86GiB(27.07%)  tps: 7,221  tflops: 56.45  mfu: 18.09%
[rank3]:2025-12-31 00:57:03,624 -  step: 450  loss:  0.2381  grad_norm:  0.2335  memory: 25.79GiB(54.28%)  tps: 7,221  tflops: 56.45  mfu: 18.09%
[rank0]:2025-12-31 00:57:03,619 -  step: 450  loss: -4.0000  grad_norm:  0.2335  memory: 16.87GiB(35.50%)  tps: 7,221  tflops: 56.45  mfu: 18.09%
[rank2]:2025-12-31 00:57:42,373 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4826e-01
[rank1]:2025-12-31 00:57:42,373 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5207e-01
[rank3]:2025-12-31 00:57:42,388 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7426e-01
[rank0]:2025-12-31 00:57:42,389 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3201e-01
[rank2]:2025-12-31 00:58:29,417 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2883e-01
[rank1]:2025-12-31 00:58:29,405 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6818e-01
[rank3]:2025-12-31 00:58:29,428 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6509e-01
[rank0]:2025-12-31 00:58:29,424 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3627e-01
[rank1]:2025-12-31 00:59:12,518 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.7696e-01
[rank3]:2025-12-31 00:59:12,533 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1337e-01
[rank0]:2025-12-31 00:59:12,533 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.0236e-01
[rank2]:2025-12-31 00:59:12,518 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4148e-01
[rank2]:2025-12-31 00:59:59,754 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7519e-01
[rank3]:2025-12-31 00:59:59,766 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.7982e-01
[rank1]:2025-12-31 00:59:59,743 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.8631e-01
[rank0]:2025-12-31 00:59:59,758 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1165e+00
[rank1]:2025-12-31 01:00:42,848 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0519e+00
[rank0]:2025-12-31 01:00:42,844 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 01:00:42,864 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1558e+00
[rank2]:2025-12-31 01:00:42,848 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.5062e-01
[rank3]:2025-12-31 01:00:42,863 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4363e-01
[rank3]:2025-12-31 01:00:47,452 - Avg. fwd time: 25.2806 / Avg. bwd time: 75.8840 / Avg. batch time: 954.5673 (ms) / GPU bubble ratio: 15.22%
[rank2]:2025-12-31 01:00:47,496 - Avg. fwd time: 15.2461 / Avg. bwd time: 29.7160 / Avg. batch time: 1006.5449 (ms) / GPU bubble ratio: 64.26%
[rank1]:2025-12-31 01:00:47,532 - Avg. fwd time: 20.0877 / Avg. bwd time: 33.2425 / Avg. batch time: 1066.2889 (ms) / GPU bubble ratio: 59.99%
[rank0]:2025-12-31 01:00:47,569 - Avg. fwd time: 16.5534 / Avg. bwd time: 32.9290 / Avg. batch time: 1122.4845 (ms) / GPU bubble ratio: 64.73%
[rank0]:2025-12-31 01:00:47,592 -  step: 500  loss: -4.0000  grad_norm:  0.2382  memory: 16.87GiB(35.50%)  tps: 7,315  tflops: 57.19  mfu: 18.33%
[rank2]:2025-12-31 01:00:47,588 -  step: 500  loss: -4.0000  grad_norm:  0.2382  memory:  8.66GiB(18.23%)  tps: 7,315  tflops: 57.18  mfu: 18.33%
[rank3]:2025-12-31 01:00:47,600 -  step: 500  loss:  0.2323  grad_norm:  0.2382  memory: 25.79GiB(54.28%)  tps: 7,315  tflops: 57.19  mfu: 18.33%
[rank1]:2025-12-31 01:00:47,578 -  step: 500  loss: -4.0000  grad_norm:  0.2382  memory: 12.86GiB(27.07%)  tps: 7,315  tflops: 57.19  mfu: 18.33%
[rank1]:2025-12-31 01:00:47,653 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0100_stage1_step500.svg
[rank0]:2025-12-31 01:00:47,650 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0100_stage0_step500.svg
[rank2]:2025-12-31 01:00:47,651 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0100_stage2_step500.svg
[rank3]:2025-12-31 01:00:47,746 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0100_step500_rank3.svg
[rank3]:			> Batch Time: 1057.38 ms, GPU Bubble Ratio: 65.89%, 64.05%, 71.37%, 27.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  232-28-260ms   | [S0,MB4,F]  260-16-276ms   | [S0,MB1,B]  343-28-371ms   | [S0,MB5,F]  371-16-387ms   | [S0,MB2,B]  459-28-487ms   | [S0,MB6,F]  488-16-504ms   | [S0,MB3,B]  574-28-602ms   | [S0,MB7,F]  603-16-619ms   | [S0,MB4,B]  692-28-720ms   | [S0,MB5,B]  806-28-834ms   | [S0,MB6,B]  918-28-946ms   | [S0,MB7,B]  1029-28-1057ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  68-19-88ms     | [S1,MB0,B]  196-27-224ms   | [S1,MB3,F]  228-20-249ms   | [S1,MB1,B]  308-27-335ms   | [S1,MB4,F]  339-20-360ms   | [S1,MB2,B]  424-27-451ms   | [S1,MB5,F]  456-20-476ms   | [S1,MB3,B]  539-27-566ms   | [S1,MB6,F]  571-20-591ms   | [S1,MB4,B]  656-27-684ms   | [S1,MB7,F]  688-20-708ms   | [S1,MB5,B]  772-27-799ms   | [S1,MB6,B]  884-27-911ms   | [S1,MB7,B]  995-27-1022ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-77ms     | [S2,MB0,B]  164-22-186ms   | [S2,MB2,F]  193-15-209ms   | [S2,MB1,B]  275-22-297ms   | [S2,MB3,F]  305-15-320ms   | [S2,MB2,B]  391-22-413ms   | [S2,MB4,F]  421-15-436ms   | [S2,MB3,B]  506-22-528ms   | [S2,MB5,F]  536-15-551ms   | [S2,MB4,B]  624-22-646ms   | [S2,MB6,F]  653-15-669ms   | [S2,MB5,B]  739-22-761ms   | [S2,MB7,F]  769-15-784ms   | [S2,MB6,B]  855-22-877ms   | [S2,MB7,B]  967-22-989ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-66-153ms    | [S3,MB1,F]  160-24-185ms   | [S3,MB1,B]  197-69-267ms   | [S3,MB2,F]  272-26-299ms   | [S3,MB2,B]  312-70-382ms   | [S3,MB3,F]  388-26-414ms   | [S3,MB3,B]  427-70-497ms   | [S3,MB4,F]  503-26-530ms   | [S3,MB4,B]  543-70-613ms   | [S3,MB5,F]  621-26-647ms   | [S3,MB5,B]  660-70-730ms   | [S3,MB6,F]  736-26-762ms   | [S3,MB6,B]  775-70-846ms   | [S3,MB7,F]  852-26-878ms   | [S3,MB7,B]  890-70-961ms  
[rank2]:2025-12-31 01:00:47,805 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0100_rank2_stage2.svg
[rank2]:	> Counts Sum: 594, Total Sum: 1620 (36.67%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 01:00:47,792 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0100_stage3_step500.svg
[rank1]:2025-12-31 01:00:47,796 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0100_rank1_stage1.svg
[rank1]:	> Counts Sum: 1260, Total Sum: 2025 (62.22%), Ratio(%) per element: [77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 01:00:47,799 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0100_rank0_stage0.svg
[rank0]:	> Counts Sum: 918, Total Sum: 1665 (55.14%), Ratio(%) per element: [0.0, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 01:00:47,931 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0100_rank3_stage3.svg
[rank3]:	> Counts Sum: 387, Total Sum: 1305 (29.66%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 01:01:30,226 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5370e+00
[rank0]:2025-12-31 01:01:30,244 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0154e+00
[rank2]:2025-12-31 01:01:30,237 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7185e-01
[rank3]:2025-12-31 01:01:30,249 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5747e-01
[rank2]:2025-12-31 01:02:13,425 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8948e+00
[rank3]:2025-12-31 01:02:13,440 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8314e+00
[rank1]:2025-12-31 01:02:13,425 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5108e+00
[rank0]:2025-12-31 01:02:13,440 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6247e+00
[rank3]:2025-12-31 01:03:00,612 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3705e-01
[rank1]:2025-12-31 01:03:00,589 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.4112e-01
[rank0]:2025-12-31 01:03:00,604 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1181e-01
[rank2]:2025-12-31 01:03:00,601 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5026e-01
[rank2]:2025-12-31 01:03:43,519 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.3699e-01
[rank1]:2025-12-31 01:03:43,519 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4163e+00
[rank3]:2025-12-31 01:03:43,534 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9029e-01
[rank0]:2025-12-31 01:03:43,534 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1544e+00
[rank1]:2025-12-31 01:04:30,655 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1473e+00
[rank0]:2025-12-31 01:04:30,660 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 01:04:30,672 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9669e-01
[rank2]:2025-12-31 01:04:30,667 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2397e-01
[rank3]:2025-12-31 01:04:30,679 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4466e-01
[rank3]:2025-12-31 01:04:34,901 - Avg. fwd time: 25.2793 / Avg. bwd time: 75.9044 / Avg. batch time: 954.7177 (ms) / GPU bubble ratio: 15.21%
[rank2]:2025-12-31 01:04:34,932 - Avg. fwd time: 15.2436 / Avg. bwd time: 29.7465 / Avg. batch time: 1006.7374 (ms) / GPU bubble ratio: 64.25%
[rank2]:2025-12-31 01:04:35,014 -  step: 550  loss: -4.0000  grad_norm:  0.1075  memory:  8.66GiB(18.23%)  tps: 7,204  tflops: 56.32  mfu: 18.05%
[rank1]:2025-12-31 01:04:34,968 - Avg. fwd time: 20.1014 / Avg. bwd time: 32.7067 / Avg. batch time: 1065.9372 (ms) / GPU bubble ratio: 60.37%
[rank1]:2025-12-31 01:04:35,014 -  step: 550  loss: -4.0000  grad_norm:  0.1075  memory: 12.86GiB(27.07%)  tps: 7,204  tflops: 56.32  mfu: 18.05%
[rank3]:2025-12-31 01:04:35,030 -  step: 550  loss:  0.2381  grad_norm:  0.1075  memory: 25.79GiB(54.28%)  tps: 7,204  tflops: 56.32  mfu: 18.05%
[rank0]:2025-12-31 01:04:35,005 - Avg. fwd time: 16.5693 / Avg. bwd time: 32.5088 / Avg. batch time: 1121.6957 (ms) / GPU bubble ratio: 65.00%
[rank0]:2025-12-31 01:04:35,031 -  step: 550  loss: -4.0000  grad_norm:  0.1075  memory: 16.87GiB(35.50%)  tps: 7,204  tflops: 56.32  mfu: 18.05%
[rank1]:2025-12-31 01:05:13,893 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3649e+00
[rank3]:2025-12-31 01:05:13,908 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1767e+00
[rank0]:2025-12-31 01:05:13,909 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1461e+00
[rank2]:2025-12-31 01:05:13,893 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5361e+00
[rank2]:2025-12-31 01:06:01,121 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9523e-01
[rank1]:2025-12-31 01:06:01,110 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5460e+00
[rank3]:2025-12-31 01:06:01,133 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6345e-01
[rank0]:2025-12-31 01:06:01,126 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9495e+00
[rank2]:2025-12-31 01:06:44,085 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3694e+00
[rank1]:2025-12-31 01:06:44,085 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8682e+00
[rank3]:2025-12-31 01:06:44,101 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1674e-01
[rank0]:2025-12-31 01:06:44,101 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4458e+00
[rank3]:2025-12-31 01:07:31,201 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8066e-01
[rank1]:2025-12-31 01:07:31,178 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.1082e-01
[rank0]:2025-12-31 01:07:31,197 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7315e-01
[rank2]:2025-12-31 01:07:31,190 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7702e-01
[rank0]:2025-12-31 01:08:14,268 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 01:08:14,287 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1216e-01
[rank2]:2025-12-31 01:08:14,272 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5399e-01
[rank1]:2025-12-31 01:08:14,272 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4228e-01
[rank3]:2025-12-31 01:08:14,287 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4960e-01
[rank2]:2025-12-31 01:08:19,014 - Avg. fwd time: 15.2503 / Avg. bwd time: 29.5927 / Avg. batch time: 1005.5288 (ms) / GPU bubble ratio: 64.32%
[rank3]:2025-12-31 01:08:18,969 - Avg. fwd time: 25.2990 / Avg. bwd time: 75.7558 / Avg. batch time: 953.6851 (ms) / GPU bubble ratio: 15.23%
[rank1]:2025-12-31 01:08:19,050 - Avg. fwd time: 20.1135 / Avg. bwd time: 32.2598 / Avg. batch time: 1064.2756 (ms) / GPU bubble ratio: 60.63%
[rank0]:2025-12-31 01:08:19,088 - Avg. fwd time: 16.5825 / Avg. bwd time: 32.1585 / Avg. batch time: 1119.6730 (ms) / GPU bubble ratio: 65.17%
[rank2]:2025-12-31 01:08:19,107 -  step: 600  loss: -4.0000  grad_norm:  0.5788  memory:  8.66GiB(18.23%)  tps: 7,311  tflops: 57.16  mfu: 18.32%
[rank3]:2025-12-31 01:08:19,120 -  step: 600  loss:  0.2328  grad_norm:  0.5788  memory: 25.79GiB(54.28%)  tps: 7,311  tflops: 57.16  mfu: 18.32%
[rank1]:2025-12-31 01:08:19,097 -  step: 600  loss: -4.0000  grad_norm:  0.5788  memory: 12.86GiB(27.07%)  tps: 7,312  tflops: 57.16  mfu: 18.32%
[rank0]:2025-12-31 01:08:19,111 -  step: 600  loss: -4.0000  grad_norm:  0.5788  memory: 16.87GiB(35.50%)  tps: 7,312  tflops: 57.16  mfu: 18.32%
[rank0]:2025-12-31 01:08:19,172 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0108_stage0_step600.svg
[rank2]:2025-12-31 01:08:19,173 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0108_stage2_step600.svg
[rank3]:2025-12-31 01:08:19,267 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0108_step600_rank3.svg
[rank3]:			> Batch Time: 1057.38 ms, GPU Bubble Ratio: 65.84%, 63.99%, 71.35%, 27.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-69ms     | [S0,MB0,B]  231-28-260ms   | [S0,MB4,F]  260-16-276ms   | [S0,MB1,B]  344-28-372ms   | [S0,MB5,F]  372-16-388ms   | [S0,MB2,B]  458-28-487ms   | [S0,MB6,F]  487-16-503ms   | [S0,MB3,B]  574-28-602ms   | [S0,MB7,F]  603-16-619ms   | [S0,MB4,B]  690-28-718ms   | [S0,MB5,B]  806-28-834ms   | [S0,MB6,B]  915-28-943ms   | [S0,MB7,B]  1029-28-1057ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  69-19-88ms     | [S1,MB0,B]  196-27-223ms   | [S1,MB3,F]  228-20-248ms   | [S1,MB1,B]  309-27-336ms   | [S1,MB4,F]  341-20-361ms   | [S1,MB2,B]  423-27-451ms   | [S1,MB5,F]  455-20-476ms   | [S1,MB3,B]  539-27-566ms   | [S1,MB6,F]  571-20-591ms   | [S1,MB4,B]  654-27-682ms   | [S1,MB7,F]  686-20-707ms   | [S1,MB5,B]  772-27-800ms   | [S1,MB6,B]  881-27-909ms   | [S1,MB7,B]  995-27-1023ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-77ms     | [S2,MB0,B]  163-22-186ms   | [S2,MB2,F]  193-15-208ms   | [S2,MB1,B]  276-22-299ms   | [S2,MB3,F]  305-15-321ms   | [S2,MB2,B]  390-22-413ms   | [S2,MB4,F]  420-15-436ms   | [S2,MB3,B]  506-22-528ms   | [S2,MB5,F]  536-15-551ms   | [S2,MB4,B]  622-22-644ms   | [S2,MB6,F]  651-15-667ms   | [S2,MB5,B]  740-22-762ms   | [S2,MB7,F]  769-15-785ms   | [S2,MB6,B]  853-22-875ms   | [S2,MB7,B]  967-22-989ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-65-153ms    | [S3,MB1,F]  160-24-185ms   | [S3,MB1,B]  198-69-267ms   | [S3,MB2,F]  273-25-299ms   | [S3,MB2,B]  311-70-382ms   | [S3,MB3,F]  387-26-414ms   | [S3,MB3,B]  426-71-497ms   | [S3,MB4,F]  503-26-530ms   | [S3,MB4,B]  542-71-613ms   | [S3,MB5,F]  619-26-645ms   | [S3,MB5,B]  658-70-729ms   | [S3,MB6,F]  737-26-763ms   | [S3,MB6,B]  773-70-844ms   | [S3,MB7,F]  850-26-876ms   | [S3,MB7,B]  888-70-959ms  
[rank1]:2025-12-31 01:08:19,174 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0108_stage1_step600.svg
[rank3]:2025-12-31 01:08:19,317 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0108_stage3_step600.svg
[rank1]:2025-12-31 01:08:19,321 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0108_rank1_stage1.svg
[rank1]:	> Counts Sum: 1620, Total Sum: 2475 (65.45%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 01:08:19,326 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0108_rank0_stage0.svg
[rank0]:	> Counts Sum: 1188, Total Sum: 2035 (58.38%), Ratio(%) per element: [0.0, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 01:08:19,326 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0108_rank2_stage2.svg
[rank2]:	> Counts Sum: 729, Total Sum: 1980 (36.82%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 01:08:19,452 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0108_rank3_stage3.svg
[rank3]:	> Counts Sum: 477, Total Sum: 1595 (29.91%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 01:09:01,767 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0324e+00
[rank2]:2025-12-31 01:09:01,759 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3308e-01
[rank3]:2025-12-31 01:09:01,771 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3128e-01
[rank1]:2025-12-31 01:09:01,748 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6279e-01
[rank0]:2025-12-31 01:09:44,796 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2570e+00
[rank2]:2025-12-31 01:09:44,779 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3024e+00
[rank1]:2025-12-31 01:09:44,779 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8239e+00
[rank3]:2025-12-31 01:09:44,795 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1973e+00
[rank1]:2025-12-31 01:10:31,822 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.8183e-01
[rank3]:2025-12-31 01:10:31,845 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5026e-01
[rank0]:2025-12-31 01:10:31,840 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1156e+00
[rank2]:2025-12-31 01:10:31,833 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3308e-01
[rank0]:2025-12-31 01:11:15,048 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1464e+00
[rank2]:2025-12-31 01:11:15,031 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.3122e-01
[rank1]:2025-12-31 01:11:15,031 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2506e+00
[rank3]:2025-12-31 01:11:15,047 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.5736e-01
[rank1]:2025-12-31 01:12:02,351 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1104e-01
[rank0]:2025-12-31 01:12:02,356 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 01:12:02,369 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4774e+00
[rank2]:2025-12-31 01:12:02,362 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8030e-01
[rank3]:2025-12-31 01:12:02,375 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6135e-01
[rank3]:2025-12-31 01:12:06,572 - Avg. fwd time: 25.3013 / Avg. bwd time: 75.7848 / Avg. batch time: 953.9354 (ms) / GPU bubble ratio: 15.23%
[rank2]:2025-12-31 01:12:06,605 - Avg. fwd time: 15.2479 / Avg. bwd time: 29.6282 / Avg. batch time: 1005.8240 (ms) / GPU bubble ratio: 64.31%
[rank1]:2025-12-31 01:12:06,641 - Avg. fwd time: 20.1229 / Avg. bwd time: 31.8836 / Avg. batch time: 1064.1902 (ms) / GPU bubble ratio: 60.90%
[rank0]:2025-12-31 01:12:06,679 - Avg. fwd time: 16.5945 / Avg. bwd time: 31.8630 / Avg. batch time: 1119.2795 (ms) / GPU bubble ratio: 65.37%
[rank0]:2025-12-31 01:12:06,702 -  step: 650  loss: -4.0000  grad_norm:  0.1114  memory: 16.87GiB(35.50%)  tps: 7,199  tflops: 56.28  mfu: 18.04%
[rank2]:2025-12-31 01:12:06,688 -  step: 650  loss: -4.0000  grad_norm:  0.1114  memory:  8.66GiB(18.23%)  tps: 7,199  tflops: 56.28  mfu: 18.04%
[rank1]:2025-12-31 01:12:06,688 -  step: 650  loss: -4.0000  grad_norm:  0.1114  memory: 12.86GiB(27.07%)  tps: 7,199  tflops: 56.28  mfu: 18.04%
[rank3]:2025-12-31 01:12:06,704 -  step: 650  loss:  0.2401  grad_norm:  0.1114  memory: 25.79GiB(54.28%)  tps: 7,199  tflops: 56.28  mfu: 18.04%
[rank2]:2025-12-31 01:12:45,541 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.0500e-01
[rank0]:2025-12-31 01:12:45,560 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5075e+00
[rank1]:2025-12-31 01:12:45,541 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0653e-01
[rank3]:2025-12-31 01:12:45,557 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0751e+00
[rank2]:2025-12-31 01:13:32,626 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1456e-01
[rank0]:2025-12-31 01:13:32,630 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2734e-01
[rank3]:2025-12-31 01:13:32,638 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6046e-01
[rank1]:2025-12-31 01:13:32,615 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.4464e-01
[rank2]:2025-12-31 01:14:15,859 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2698e+00
[rank0]:2025-12-31 01:14:15,876 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1713e+00
[rank1]:2025-12-31 01:14:15,860 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1511e+00
[rank3]:2025-12-31 01:14:15,875 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0571e+00
[rank1]:2025-12-31 01:15:03,180 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7704e-01
[rank2]:2025-12-31 01:15:03,192 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0718e-01
[rank0]:2025-12-31 01:15:03,198 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5918e-01
[rank3]:2025-12-31 01:15:03,203 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6582e-01
[rank2]:2025-12-31 01:15:46,266 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9545e+00
[rank0]:2025-12-31 01:15:46,262 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 01:15:46,284 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0775e+00
[rank3]:2025-12-31 01:15:46,281 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9997e+00
[rank1]:2025-12-31 01:15:46,266 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4995e+00
[rank3]:2025-12-31 01:15:50,838 - Avg. fwd time: 25.3168 / Avg. bwd time: 75.6752 / Avg. batch time: 953.1806 (ms) / GPU bubble ratio: 15.24%
[rank2]:2025-12-31 01:15:50,884 - Avg. fwd time: 15.2535 / Avg. bwd time: 29.5062 / Avg. batch time: 1004.9299 (ms) / GPU bubble ratio: 64.37%
[rank1]:2025-12-31 01:15:50,921 - Avg. fwd time: 20.1331 / Avg. bwd time: 31.5612 / Avg. batch time: 1062.9709 (ms) / GPU bubble ratio: 61.09%
[rank2]:2025-12-31 01:15:50,978 -  step: 700  loss: -4.0000  grad_norm:  0.2757  memory:  8.66GiB(18.23%)  tps: 7,305  tflops: 57.11  mfu: 18.30%
[rank0]:2025-12-31 01:15:50,960 - Avg. fwd time: 16.6046 / Avg. bwd time: 31.6100 / Avg. batch time: 1117.8005 (ms) / GPU bubble ratio: 65.49%
[rank0]:2025-12-31 01:15:50,984 -  step: 700  loss: -4.0000  grad_norm:  0.2757  memory: 16.87GiB(35.50%)  tps: 7,305  tflops: 57.11  mfu: 18.30%
[rank3]:2025-12-31 01:15:50,991 -  step: 700  loss:  0.2038  grad_norm:  0.2757  memory: 25.79GiB(54.28%)  tps: 7,305  tflops: 57.11  mfu: 18.30%
[rank1]:2025-12-31 01:15:50,969 -  step: 700  loss: -4.0000  grad_norm:  0.2757  memory: 12.86GiB(27.07%)  tps: 7,305  tflops: 57.11  mfu: 18.30%
[rank1]:2025-12-31 01:15:51,047 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0115_stage1_step700.svg
[rank2]:2025-12-31 01:15:51,047 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0115_stage2_step700.svg
[rank0]:2025-12-31 01:15:51,049 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0115_stage0_step700.svg
[rank3]:2025-12-31 01:15:51,153 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0115_step700_rank3.svg
[rank3]:			> Batch Time: 1056.41 ms, GPU Bubble Ratio: 65.81%, 63.92%, 71.31%, 27.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  231-28-259ms   | [S0,MB4,F]  259-16-275ms   | [S0,MB1,B]  344-28-372ms   | [S0,MB5,F]  372-16-388ms   | [S0,MB2,B]  457-28-486ms   | [S0,MB6,F]  486-16-502ms   | [S0,MB3,B]  575-28-603ms   | [S0,MB7,F]  604-16-620ms   | [S0,MB4,B]  691-28-719ms   | [S0,MB5,B]  804-28-832ms   | [S0,MB6,B]  916-28-944ms   | [S0,MB7,B]  1028-28-1056ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  68-20-88ms     | [S1,MB0,B]  195-27-223ms   | [S1,MB3,F]  227-20-248ms   | [S1,MB1,B]  309-27-336ms   | [S1,MB4,F]  340-20-361ms   | [S1,MB2,B]  422-27-450ms   | [S1,MB5,F]  454-20-475ms   | [S1,MB3,B]  540-27-567ms   | [S1,MB6,F]  572-20-592ms   | [S1,MB4,B]  656-27-683ms   | [S1,MB7,F]  688-20-708ms   | [S1,MB5,B]  770-27-798ms   | [S1,MB6,B]  882-27-909ms   | [S1,MB7,B]  994-27-1022ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-77ms     | [S2,MB0,B]  163-22-185ms   | [S2,MB2,F]  192-15-208ms   | [S2,MB1,B]  276-22-298ms   | [S2,MB3,F]  305-15-321ms   | [S2,MB2,B]  390-22-412ms   | [S2,MB4,F]  419-15-435ms   | [S2,MB3,B]  507-22-529ms   | [S2,MB5,F]  536-15-552ms   | [S2,MB4,B]  623-22-645ms   | [S2,MB6,F]  652-15-668ms   | [S2,MB5,B]  738-22-760ms   | [S2,MB7,F]  767-15-783ms   | [S2,MB6,B]  853-22-876ms   | [S2,MB7,B]  966-22-988ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-65-153ms    | [S3,MB1,F]  160-24-184ms   | [S3,MB1,B]  197-69-266ms   | [S3,MB2,F]  273-25-299ms   | [S3,MB2,B]  311-70-381ms   | [S3,MB3,F]  387-26-413ms   | [S3,MB3,B]  425-70-496ms   | [S3,MB4,F]  504-26-530ms   | [S3,MB4,B]  542-70-613ms   | [S3,MB5,F]  620-26-646ms   | [S3,MB5,B]  657-70-728ms   | [S3,MB6,F]  735-26-761ms   | [S3,MB6,B]  773-70-844ms   | [S3,MB7,F]  850-26-877ms   | [S3,MB7,B]  889-70-960ms  
[rank2]:2025-12-31 01:15:51,199 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0115_rank2_stage2.svg
[rank2]:	> Counts Sum: 864, Total Sum: 2340 (36.92%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 01:15:51,198 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0115_rank0_stage0.svg
[rank0]:	> Counts Sum: 1458, Total Sum: 2405 (60.62%), Ratio(%) per element: [0.0, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 01:15:51,206 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0115_stage3_step700.svg
[rank1]:2025-12-31 01:15:51,191 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0115_rank1_stage1.svg
[rank1]:	> Counts Sum: 1980, Total Sum: 2925 (67.69%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 01:15:51,348 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0115_rank3_stage3.svg
[rank3]:	> Counts Sum: 567, Total Sum: 1885 (30.08%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 01:16:33,694 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0508e-01
[rank2]:2025-12-31 01:16:33,706 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2067e-01
[rank0]:2025-12-31 01:16:33,710 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4781e-01
[rank3]:2025-12-31 01:16:33,718 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6954e-01
[rank2]:2025-12-31 01:17:16,798 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0520e+00
[rank0]:2025-12-31 01:17:16,817 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7228e-01
[rank1]:2025-12-31 01:17:16,798 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3779e-01
[rank3]:2025-12-31 01:17:16,813 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6259e-01
[rank1]:2025-12-31 01:18:04,101 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.5312e-01
[rank3]:2025-12-31 01:18:04,124 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1172e-01
[rank2]:2025-12-31 01:18:04,112 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2988e-01
[rank0]:2025-12-31 01:18:04,119 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7536e-01
[rank1]:2025-12-31 01:18:47,246 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.6664e-01
[rank3]:2025-12-31 01:18:47,261 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.4112e-01
[rank2]:2025-12-31 01:18:47,246 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.5307e-01
[rank0]:2025-12-31 01:18:47,265 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0503e+00
[rank1]:2025-12-31 01:19:34,412 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9157e-01
[rank3]:2025-12-31 01:19:34,436 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7961e-01
[rank2]:2025-12-31 01:19:34,423 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0689e-01
[rank0]:2025-12-31 01:19:34,417 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 01:19:34,430 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7391e-01
[rank3]:2025-12-31 01:19:38,667 - Avg. fwd time: 25.3169 / Avg. bwd time: 75.7122 / Avg. batch time: 953.4756 (ms) / GPU bubble ratio: 15.23%
[rank2]:2025-12-31 01:19:38,699 - Avg. fwd time: 15.2508 / Avg. bwd time: 29.5434 / Avg. batch time: 1005.2788 (ms) / GPU bubble ratio: 64.35%
[rank2]:2025-12-31 01:19:38,784 -  step: 750  loss: -4.0000  grad_norm:  0.4169  memory:  8.66GiB(18.23%)  tps: 7,192  tflops: 56.22  mfu: 18.02%
[rank0]:2025-12-31 01:19:38,775 - Avg. fwd time: 16.6137 / Avg. bwd time: 31.3904 / Avg. batch time: 1117.6407 (ms) / GPU bubble ratio: 65.64%
[rank0]:2025-12-31 01:19:38,798 -  step: 750  loss: -4.0000  grad_norm:  0.4169  memory: 16.87GiB(35.50%)  tps: 7,192  tflops: 56.22  mfu: 18.02%
[rank1]:2025-12-31 01:19:38,737 - Avg. fwd time: 20.1403 / Avg. bwd time: 31.2812 / Avg. batch time: 1063.0368 (ms) / GPU bubble ratio: 61.30%
[rank1]:2025-12-31 01:19:38,784 -  step: 750  loss: -4.0000  grad_norm:  0.4169  memory: 12.86GiB(27.07%)  tps: 7,192  tflops: 56.22  mfu: 18.02%
[rank3]:2025-12-31 01:19:38,799 -  step: 750  loss:  0.2495  grad_norm:  0.4169  memory: 25.79GiB(54.28%)  tps: 7,192  tflops: 56.22  mfu: 18.02%
[rank1]:2025-12-31 01:20:17,750 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3925e+00
[rank3]:2025-12-31 01:20:17,766 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2035e+00
[rank2]:2025-12-31 01:20:17,750 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1909e+00
[rank0]:2025-12-31 01:20:17,766 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7442e-01
[rank2]:2025-12-31 01:21:04,973 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8136e-01
[rank0]:2025-12-31 01:21:04,980 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2987e+00
[rank1]:2025-12-31 01:21:04,962 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6664e+00
[rank3]:2025-12-31 01:21:04,986 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6973e-01
[rank2]:2025-12-31 01:21:48,145 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7061e+00
[rank0]:2025-12-31 01:21:48,164 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6976e+00
[rank1]:2025-12-31 01:21:48,146 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7065e+00
[rank3]:2025-12-31 01:21:48,161 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6511e+00
[rank2]:2025-12-31 01:22:35,330 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2879e-01
[rank1]:2025-12-31 01:22:35,319 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5910e-01
[rank3]:2025-12-31 01:22:35,342 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0076e-01
[rank0]:2025-12-31 01:22:35,334 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5180e-01
[rank0]:2025-12-31 01:23:18,548 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 01:23:18,569 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8320e-01
[rank2]:2025-12-31 01:23:18,552 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9789e-01
[rank1]:2025-12-31 01:23:18,552 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1517e-01
[rank3]:2025-12-31 01:23:18,568 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0858e-01
[rank3]:2025-12-31 01:23:23,256 - Avg. fwd time: 25.3303 / Avg. bwd time: 75.6323 / Avg. batch time: 952.9425 (ms) / GPU bubble ratio: 15.24%
[rank0]:2025-12-31 01:23:23,379 - Avg. fwd time: 16.6213 / Avg. bwd time: 31.1981 / Avg. batch time: 1116.5438 (ms) / GPU bubble ratio: 65.74%
[rank2]:2025-12-31 01:23:23,303 - Avg. fwd time: 15.2559 / Avg. bwd time: 29.4411 / Avg. batch time: 1004.6278 (ms) / GPU bubble ratio: 64.41%
[rank1]:2025-12-31 01:23:23,340 - Avg. fwd time: 20.1485 / Avg. bwd time: 31.0360 / Avg. batch time: 1062.1382 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-12-31 01:23:23,388 -  step: 800  loss: -4.0000  grad_norm:  0.8054  memory: 12.86GiB(27.07%)  tps: 7,295  tflops: 57.03  mfu: 18.28%
[rank1]:2025-12-31 01:23:23,388 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.8054  tps: 7,621  tflops: 59.58  mfu: 17.42%
[rank1]:2025-12-31 01:23:23,388 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 01:23:23,389 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-31 01:23:23,410 -  step: 800  loss:  0.2521  grad_norm:  0.8054  memory: 25.79GiB(54.28%)  tps: 7,294  tflops: 57.02  mfu: 18.28%
[rank3]:2025-12-31 01:23:23,411 - â„¹ï¸ final step: 800  loss:  0.2521  grad_norm:  0.8054  tps: 7,626  tflops: 59.62  mfu: 17.56%
[rank3]:2025-12-31 01:23:23,411 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 01:23:23,412 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 01:23:23,402 -  step: 800  loss: -4.0000  grad_norm:  0.8054  memory: 16.87GiB(35.50%)  tps: 7,295  tflops: 57.03  mfu: 18.28%
[rank0]:2025-12-31 01:23:23,402 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.8054  tps: 7,622  tflops: 59.58  mfu: 17.43%
[rank0]:2025-12-31 01:23:23,402 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 01:23:23,403 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-31 01:23:23,398 -  step: 800  loss: -4.0000  grad_norm:  0.8054  memory:  8.66GiB(18.23%)  tps: 7,294  tflops: 57.02  mfu: 18.28%
[rank2]:2025-12-31 01:23:23,398 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.8054  tps: 7,621  tflops: 59.58  mfu: 17.42%
[rank2]:2025-12-31 01:23:23,398 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 01:23:23,398 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 01:23:25,780 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-31 01:23:25,853 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0123_stage0_final800.svg
[rank2]:2025-12-31 01:23:25,850 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0123_stage2_final800.svg
[rank1]:2025-12-31 01:23:25,854 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0123_stage1_final800.svg
[rank3]:2025-12-31 01:23:25,939 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0123_final800_rank3.svg
[rank3]:			> Batch Time: 1139.41 ms, GPU Bubble Ratio: 68.33%, 66.60%, 64.76%, 28.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  249-28-278ms   | [S0,MB4,F]  280-16-296ms   | [S0,MB1,B]  370-28-398ms   | [S0,MB5,F]  402-16-418ms   | [S0,MB2,B]  494-28-522ms   | [S0,MB6,F]  525-16-541ms   | [S0,MB3,B]  619-28-647ms   | [S0,MB7,F]  649-16-665ms   | [S0,MB4,B]  745-28-773ms   | [S0,MB5,B]  869-28-897ms   | [S0,MB6,B]  990-28-1018ms  | [S0,MB7,B]  1111-28-1139ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  68-19-88ms     | [S1,MB0,B]  209-27-237ms   | [S1,MB3,F]  246-20-266ms   | [S1,MB1,B]  333-27-361ms   | [S1,MB4,F]  367-20-387ms   | [S1,MB2,B]  458-27-485ms   | [S1,MB5,F]  491-20-511ms   | [S1,MB3,B]  582-27-610ms   | [S1,MB6,F]  616-20-636ms   | [S1,MB4,B]  707-27-735ms   | [S1,MB7,F]  741-20-762ms   | [S1,MB5,B]  833-27-861ms   | [S1,MB6,B]  954-27-982ms   | [S1,MB7,B]  1075-27-1103ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-14-77ms     | [S2,MB0,B]  167-32-200ms   | [S2,MB2,F]  206-15-221ms   | [S2,MB1,B]  288-35-323ms   | [S2,MB3,F]  330-15-346ms   | [S2,MB2,B]  412-35-448ms   | [S2,MB4,F]  455-15-470ms   | [S2,MB3,B]  537-35-572ms   | [S2,MB5,F]  580-15-595ms   | [S2,MB4,B]  661-35-697ms   | [S2,MB6,F]  704-15-720ms   | [S2,MB5,B]  787-35-822ms   | [S2,MB7,F]  830-15-846ms   | [S2,MB6,B]  913-35-948ms   | [S2,MB7,B]  1034-35-1069ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-69-157ms    | [S3,MB1,F]  164-24-189ms   | [S3,MB1,B]  201-74-275ms   | [S3,MB2,F]  285-25-310ms   | [S3,MB2,B]  322-74-396ms   | [S3,MB3,F]  409-25-435ms   | [S3,MB3,B]  446-75-521ms   | [S3,MB4,F]  534-25-560ms   | [S3,MB4,B]  570-77-648ms   | [S3,MB5,F]  659-25-684ms   | [S3,MB5,B]  696-79-776ms   | [S3,MB6,F]  784-25-810ms   | [S3,MB6,B]  821-80-902ms   | [S3,MB7,F]  910-25-935ms   | [S3,MB7,B]  946-80-1026ms 
[rank2]:2025-12-31 01:23:25,998 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0123_rank2_stage2.svg
[rank2]:	> Counts Sum: 999, Total Sum: 2700 (37.00%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 01:23:25,998 - Destroying the purge thread.
[rank1]:2025-12-31 01:23:25,997 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0123_rank1_stage1.svg
[rank1]:	> Counts Sum: 2340, Total Sum: 3375 (69.33%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 01:23:25,997 - Destroying the purge thread.
[rank0]:2025-12-31 01:23:26,003 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0123_rank0_stage0.svg
[rank0]:	> Counts Sum: 1728, Total Sum: 2775 (62.27%), Ratio(%) per element: [0.0, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 01:23:26,003 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-31 01:23:26,054 - Process group destroyed
[rank1]:2025-12-31 01:23:26,056 - Process group destroyed
[rank3]:2025-12-31 01:23:26,076 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/pipeline_schedule/251231_0123_thry_final800_rank3.svg
[rank3]:			> Batch Time: 637.59 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-57ms     | [S0,MB3,F]  57-19-77ms     | [S0,MB0,B]  193-38-231ms   | [S0,MB4,F]  231-19-251ms   | [S0,MB1,B]  251-38-289ms   | [S0,MB5,F]  289-19-309ms   | [S0,MB2,B]  309-38-347ms   | [S0,MB6,F]  347-19-367ms   | [S0,MB3,B]  367-38-405ms   | [S0,MB7,F]  405-19-425ms   | [S0,MB4,B]  425-38-463ms   | [S0,MB5,B]  483-38-521ms   | [S0,MB6,B]  540-38-579ms   | [S0,MB7,B]  598-38-637ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB0,B]  154-38-193ms   | [S1,MB3,F]  193-19-212ms   | [S1,MB1,B]  212-38-251ms   | [S1,MB4,F]  251-19-270ms   | [S1,MB2,B]  270-38-309ms   | [S1,MB5,F]  309-19-328ms   | [S1,MB3,B]  328-38-367ms   | [S1,MB6,F]  367-19-386ms   | [S1,MB4,B]  386-38-425ms   | [S1,MB7,F]  425-19-444ms   | [S1,MB5,B]  444-38-483ms   | [S1,MB6,B]  502-38-540ms   | [S1,MB7,B]  560-38-598ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-57ms     | [S2,MB1,F]  57-19-77ms     | [S2,MB0,B]  115-38-154ms   | [S2,MB2,F]  154-19-173ms   | [S2,MB1,B]  173-38-212ms   | [S2,MB3,F]  212-19-231ms   | [S2,MB2,B]  231-38-270ms   | [S2,MB4,F]  270-19-289ms   | [S2,MB3,B]  289-38-328ms   | [S2,MB5,F]  328-19-347ms   | [S2,MB4,B]  347-38-386ms   | [S2,MB6,F]  386-19-405ms   | [S2,MB5,B]  405-38-444ms   | [S2,MB7,F]  444-19-463ms   | [S2,MB6,B]  463-38-502ms   | [S2,MB7,B]  521-38-560ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  57-19-77ms     | [S3,MB0,B]  77-38-115ms    | [S3,MB1,F]  115-19-135ms   | [S3,MB1,B]  135-38-173ms   | [S3,MB2,F]  173-19-193ms   | [S3,MB2,B]  193-38-231ms   | [S3,MB3,F]  231-19-251ms   | [S3,MB3,B]  251-38-289ms   | [S3,MB4,F]  289-19-309ms   | [S3,MB4,B]  309-38-347ms   | [S3,MB5,F]  347-19-367ms   | [S3,MB5,B]  367-38-405ms   | [S3,MB6,F]  405-19-425ms   | [S3,MB6,B]  425-38-463ms   | [S3,MB7,F]  463-19-483ms   | [S3,MB7,B]  483-38-521ms  
[rank3]:2025-12-31 01:23:26,126 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0123_stage3_final800.svg
[rank3]:2025-12-31 01:23:26,259 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1/frozen_params_histogram/251231_0123_rank3_stage3.svg
[rank3]:	> Counts Sum: 657, Total Sum: 2175 (30.21%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 01:23:26,260 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 354-375
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.29672
[rank3]:wandb:               final/avg_loss 0.25209
[rank3]:wandb:             final/avg_mfu(%) 17.55978
[rank3]:wandb:             final/avg_tflops 59.61882
[rank3]:wandb:    final/avg_throughput(tps) 7626.28917
[rank3]:wandb:              final/grad_norm 0.80542
[rank3]:wandb:               final/max_loss 0.25209
[rank3]:wandb:                    grad_norm 0.80542
[rank3]:wandb: loss_metrics/global_avg_loss 0.25209
[rank3]:wandb: loss_metrics/global_max_loss 0.25209
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_1F1B_auto_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/hf0my93x
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_1F1B_auto_22_dm1/20251231-0022/wandb/run-20251231_002229-hf0my93x/logs
[rank3]:2025-12-31 01:23:27,591 - Process group destroyed
[rank0]:2025-12-31 01:23:28,003 - Training completed
[rank0]:2025-12-31 01:23:28,003 - Destroying the purge thread.
[rank0]:2025-12-31 01:23:28,202 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.7', 'layers.5', 'layers.4', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'layers.3', 'layers.1', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'norm', 'layers.14', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_1F1B_auto_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_1F1B_auto_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_1F1B_auto_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_1F1B_auto_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_1F1B_auto_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_1F1B_auto_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_1F1B_auto_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_1F1B_auto_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
