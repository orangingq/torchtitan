
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 29. (ì›”) 01:36:23 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_1F1B_auto_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with auto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-29 01:36:29,757 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:2025-12-29 01:36:29,757 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank1]:2025-12-29 01:36:30,000 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-29 01:36:30,002 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-29 01:36:30,005 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-29 01:36:30,007 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-29 01:36:30,009 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-29 01:36:30,010 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-29 01:36:29,991 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank2]:2025-12-29 01:36:30,100 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank3]:2025-12-29 01:36:30,181 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-29 01:36:30,184 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-29 01:36:30,352 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-29 01:36:30,354 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-29 01:36:30,412 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-29 01:36:33,198 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-29 01:36:33,349 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-29 01:36:33,389 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-29 01:36:33,390 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-29 01:36:33,417 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-29 01:36:33,418 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-29 01:36:33,495 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-29 01:36:33,533 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-29 01:36:33,560 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-29 01:36:33,560 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-29 01:36:33,659 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-29 01:36:33,659 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-29 01:36:33,660 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-29 01:36:33,781 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-29 01:36:33,781 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-29 01:36:33,782 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-29 01:36:33,939 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-29 01:36:33,976 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-29 01:36:34,003 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-29 01:36:34,004 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-29 01:36:34,195 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-29 01:36:34,196 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-29 01:36:34,196 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ien1lbnm
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_1F1B_auto_11_dm1/20251229-0136/wandb/run-20251229_013634-ien1lbnm
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_1F1B_auto_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ien1lbnm
[rank3]:2025-12-29 01:36:35,547 - WandB logging enabled
[rank3]:2025-12-29 01:36:35,547 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-29 01:36:35,589 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-29 01:36:35,619 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-29 01:36:35,619 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-29 01:36:35,830 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-29 01:36:35,830 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_1F1B_auto_11_dm1
[rank0]:2025-12-29 01:36:35,830 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-29 01:36:35,833 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-29 01:36:35,833 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-29 01:36:35,811 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-29 01:36:35,812 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-29 01:36:35,812 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-29 01:36:35,829 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-29 01:36:35,830 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-29 01:36:38,229 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-29 01:36:38,230 - Finished loading the checkpoint in 2.40 seconds.
[rank0]:2025-12-29 01:36:38,230 - Training starts at step 1
[rank0]:2025-12-29 01:36:43,550 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 13.10GiB(27.57%)  tps: 3,225  tflops: 25.21  mfu: 8.08%
[rank0]:2025-12-29 01:36:43,550 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-29 01:36:43,515 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 10.58GiB(22.26%)  tps: 3,283  tflops: 25.66  mfu: 8.23%
[rank1]:2025-12-29 01:36:43,521 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-29 01:36:43,512 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory:  6.84GiB(14.41%)  tps: 3,436  tflops: 26.86  mfu: 8.61%
[rank2]:2025-12-29 01:36:43,513 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-29 01:36:43,523 -  step:  1  loss: 10.6092  grad_norm: 203.0665  memory: 21.88GiB(46.05%)  tps: 4,132  tflops: 32.30  mfu: 10.35%
[rank3]:2025-12-29 01:36:43,524 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-29 01:40:36,875 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-29 01:40:41,546 - Avg. fwd time: 24.7614 / Avg. bwd time: 81.0730 / Avg. batch time: 992.1006 (ms) / GPU bubble ratio: 14.66%
[rank1]:2025-12-29 01:40:41,641 - Avg. fwd time: 19.8880 / Avg. bwd time: 45.7374 / Avg. batch time: 1123.2635 (ms) / GPU bubble ratio: 53.26%
[rank2]:2025-12-29 01:40:41,589 - Avg. fwd time: 14.9533 / Avg. bwd time: 35.3084 / Avg. batch time: 1050.3834 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-12-29 01:40:41,688 - Avg. fwd time: 16.1613 / Avg. bwd time: 41.8873 / Avg. batch time: 1189.2855 (ms) / GPU bubble ratio: 60.95%
[rank0]:2025-12-29 01:40:41,727 -  step: 50  loss: -4.0000  grad_norm: 24.2244  memory: 16.87GiB(35.50%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank1]:2025-12-29 01:40:41,713 -  step: 50  loss: -4.0000  grad_norm: 24.2244  memory: 12.86GiB(27.07%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank2]:2025-12-29 01:40:41,710 -  step: 50  loss: -4.0000  grad_norm: 24.2244  memory:  8.66GiB(18.23%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank3]:2025-12-29 01:40:41,722 -  step: 50  loss:  9.8856  grad_norm: 24.2244  memory: 25.79GiB(54.28%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank1]:2025-12-29 01:41:25,618 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-29 01:41:25,614 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-29 01:41:25,632 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-29 01:41:25,626 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-29 01:42:14,230 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3273e+00
[rank1]:2025-12-29 01:42:14,234 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5769e+00
[rank0]:2025-12-29 01:42:14,249 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.8222e+00
[rank3]:2025-12-29 01:42:14,242 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6274e+00
[rank3]:2025-12-29 01:43:00,792 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7069e+00
[rank2]:2025-12-29 01:43:00,772 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5155e+00
[rank1]:2025-12-29 01:43:00,788 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8131e+00
[rank0]:2025-12-29 01:43:00,799 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1364e+00
[rank3]:2025-12-29 01:43:49,570 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8377e+00
[rank2]:2025-12-29 01:43:49,558 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2071e+00
[rank0]:2025-12-29 01:43:49,576 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2873e+01
[rank1]:2025-12-29 01:43:49,562 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5888e+00
[rank3]:2025-12-29 01:44:34,109 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4037e+00
[rank2]:2025-12-29 01:44:34,094 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4886e+00
[rank0]:2025-12-29 01:44:34,090 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:44:34,124 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8020e+00
[rank1]:2025-12-29 01:44:34,110 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7876e+00
[rank3]:2025-12-29 01:44:38,690 - Avg. fwd time: 25.0190 / Avg. bwd time: 79.3806 / Avg. batch time: 980.5209 (ms) / GPU bubble ratio: 14.82%
[rank2]:2025-12-29 01:44:38,732 - Avg. fwd time: 15.0902 / Avg. bwd time: 32.7344 / Avg. batch time: 1035.7780 (ms) / GPU bubble ratio: 63.06%
[rank1]:2025-12-29 01:44:38,766 - Avg. fwd time: 19.9460 / Avg. bwd time: 45.7177 / Avg. batch time: 1108.2527 (ms) / GPU bubble ratio: 52.60%
[rank3]:2025-12-29 01:44:38,837 -  step: 100  loss:  8.3175  grad_norm: 14.5656  memory: 25.79GiB(54.28%)  tps: 6,910  tflops: 54.02  mfu: 17.31%
[rank2]:2025-12-29 01:44:38,825 -  step: 100  loss: -4.0000  grad_norm: 14.5656  memory:  8.66GiB(18.23%)  tps: 6,910  tflops: 54.02  mfu: 17.31%
[rank1]:2025-12-29 01:44:38,815 -  step: 100  loss: -4.0000  grad_norm: 14.5656  memory: 12.86GiB(27.07%)  tps: 6,910  tflops: 54.02  mfu: 17.31%
[rank0]:2025-12-29 01:44:38,805 - Avg. fwd time: 16.1952 / Avg. bwd time: 41.8892 / Avg. batch time: 1173.8961 (ms) / GPU bubble ratio: 60.42%
[rank0]:2025-12-29 01:44:38,835 -  step: 100  loss: -4.0000  grad_norm: 14.5656  memory: 16.87GiB(35.50%)  tps: 6,910  tflops: 54.02  mfu: 17.31%
[rank2]:2025-12-29 01:44:38,911 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0144_stage2_step100.svg
[rank1]:2025-12-29 01:44:38,910 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0144_stage1_step100.svg
[rank0]:2025-12-29 01:44:38,904 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0144_stage0_step100.svg
[rank3]:2025-12-29 01:44:39,005 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0144_step100_rank3.svg
[rank3]:			> Batch Time: 1093.09 ms, GPU Bubble Ratio: 57.25%, 51.92%, 72.54%, 30.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-16-32ms     | [S0,MB2,F]  32-16-49ms     | [S0,MB3,F]  49-16-66ms     | [S0,MB0,B]  249-42-292ms   | [S0,MB4,F]  291-15-307ms   | [S0,MB1,B]  363-42-405ms   | [S0,MB5,F]  405-15-420ms   | [S0,MB2,B]  479-42-521ms   | [S0,MB6,F]  521-15-537ms   | [S0,MB3,B]  595-42-637ms   | [S0,MB7,F]  638-15-653ms   | [S0,MB4,B]  714-42-756ms   | [S0,MB5,B]  828-42-870ms   | [S0,MB6,B]  939-42-981ms   | [S0,MB7,B]  1051-42-1093ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  43-18-61ms     | [S1,MB2,F]  67-18-86ms     | [S1,MB0,B]  195-46-241ms   | [S1,MB3,F]  246-20-266ms   | [S1,MB1,B]  309-46-355ms   | [S1,MB4,F]  359-20-380ms   | [S1,MB2,B]  425-46-471ms   | [S1,MB5,F]  475-20-496ms   | [S1,MB3,B]  541-46-587ms   | [S1,MB6,F]  592-20-612ms   | [S1,MB4,B]  659-45-705ms   | [S1,MB7,F]  710-20-730ms   | [S1,MB5,B]  775-45-821ms   | [S1,MB6,B]  887-45-933ms   | [S1,MB7,B]  999-45-1044ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  61-15-76ms     | [S2,MB0,B]  163-22-185ms   | [S2,MB2,F]  192-15-207ms   | [S2,MB1,B]  276-22-299ms   | [S2,MB3,F]  306-15-321ms   | [S2,MB2,B]  392-22-414ms   | [S2,MB4,F]  421-15-437ms   | [S2,MB3,B]  508-22-530ms   | [S2,MB5,F]  538-15-553ms   | [S2,MB4,B]  626-22-648ms   | [S2,MB6,F]  656-15-671ms   | [S2,MB5,B]  743-22-765ms   | [S2,MB7,F]  772-15-788ms   | [S2,MB6,B]  859-22-881ms   | [S2,MB7,B]  970-22-992ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-65-152ms    | [S3,MB1,F]  159-25-185ms   | [S3,MB1,B]  197-70-267ms   | [S3,MB2,F]  273-26-300ms   | [S3,MB2,B]  312-70-383ms   | [S3,MB3,F]  389-25-415ms   | [S3,MB3,B]  427-70-498ms   | [S3,MB4,F]  505-26-531ms   | [S3,MB4,B]  545-71-616ms   | [S3,MB5,F]  623-26-650ms   | [S3,MB5,B]  663-69-733ms   | [S3,MB6,F]  740-26-766ms   | [S3,MB6,B]  779-70-849ms   | [S3,MB7,F]  856-26-882ms   | [S3,MB7,B]  894-70-964ms  
[rank2]:2025-12-29 01:44:39,065 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0144_rank2_stage2.svg
[rank2]:	> Counts Sum: 54, Total Sum: 180 (30.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 01:44:39,061 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0144_rank1_stage1.svg
[rank1]:	> Counts Sum: 36, Total Sum: 225 (16.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 01:44:39,059 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0144_rank0_stage0.svg
[rank0]:	> Counts Sum: 18, Total Sum: 185 (9.73%), Ratio(%) per element: [0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 01:44:39,050 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0144_stage3_step100.svg
[rank3]:2025-12-29 01:44:39,188 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0144_rank3_stage3.svg
[rank3]:	> Counts Sum: 27, Total Sum: 145 (18.62%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 01:45:21,725 - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5397e-01
[rank0]:2025-12-29 01:45:21,746 - Freezing Ratio: [Stage0] 0.00, Threshold: 8.3615e-01
[rank3]:2025-12-29 01:45:21,748 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1728e-01
[rank2]:2025-12-29 01:45:21,736 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3606e-01
[rank3]:2025-12-29 01:46:06,247 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4051e+00
[rank2]:2025-12-29 01:46:06,231 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3369e+00
[rank1]:2025-12-29 01:46:06,247 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.5832e-01
[rank0]:2025-12-29 01:46:06,261 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9983e+00
[rank1]:2025-12-29 01:46:53,645 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4267e+00
[rank0]:2025-12-29 01:46:53,666 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1519e+00
[rank3]:2025-12-29 01:46:53,669 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0359e+01
[rank2]:2025-12-29 01:46:53,657 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5206e+00
[rank3]:2025-12-29 01:47:38,274 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6701e+00
[rank2]:2025-12-29 01:47:38,259 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4692e+00
[rank1]:2025-12-29 01:47:38,275 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3626e-01
[rank0]:2025-12-29 01:47:38,289 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8049e+00
[rank1]:2025-12-29 01:48:25,487 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6963e+00
[rank0]:2025-12-29 01:48:25,492 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 01:48:25,502 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.4455e+00
[rank3]:2025-12-29 01:48:25,511 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9613e+00
[rank2]:2025-12-29 01:48:25,498 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0237e+00
[rank3]:2025-12-29 01:48:29,831 - Avg. fwd time: 25.1216 / Avg. bwd time: 78.3144 / Avg. batch time: 972.7513 (ms) / GPU bubble ratio: 14.93%
[rank2]:2025-12-29 01:48:29,860 - Avg. fwd time: 15.1186 / Avg. bwd time: 31.7817 / Avg. batch time: 1027.0074 (ms) / GPU bubble ratio: 63.47%
[rank2]:2025-12-29 01:48:29,973 -  step: 150  loss: -4.0000  grad_norm: 21.2856  memory:  8.66GiB(18.23%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank1]:2025-12-29 01:48:29,913 - Avg. fwd time: 19.9960 / Avg. bwd time: 42.1819 / Avg. batch time: 1095.8201 (ms) / GPU bubble ratio: 54.61%
[rank1]:2025-12-29 01:48:29,987 -  step: 150  loss: -4.0000  grad_norm: 21.2856  memory: 12.86GiB(27.07%)  tps: 7,087  tflops: 55.41  mfu: 17.76%
[rank0]:2025-12-29 01:48:29,962 - Avg. fwd time: 16.2838 / Avg. bwd time: 39.8546 / Avg. batch time: 1159.2486 (ms) / GPU bubble ratio: 61.26%
[rank0]:2025-12-29 01:48:30,000 -  step: 150  loss: -4.0000  grad_norm: 21.2856  memory: 16.87GiB(35.50%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank3]:2025-12-29 01:48:29,989 -  step: 150  loss:  3.8110  grad_norm: 21.2856  memory: 25.79GiB(54.28%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank2]:2025-12-29 01:49:10,237 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7640e+00
[rank1]:2025-12-29 01:49:10,253 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0604e-01
[rank3]:2025-12-29 01:49:10,253 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0949e+00
[rank0]:2025-12-29 01:49:10,269 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8966e-01
[rank3]:2025-12-29 01:49:57,647 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0700e+00
[rank2]:2025-12-29 01:49:57,635 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0849e-01
[rank1]:2025-12-29 01:49:57,623 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2988e+00
[rank0]:2025-12-29 01:49:57,639 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.7471e+00
[rank2]:2025-12-29 01:50:42,189 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5108e+01
[rank3]:2025-12-29 01:50:42,205 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2931e+00
[rank1]:2025-12-29 01:50:42,205 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8640e+00
[rank0]:2025-12-29 01:50:42,221 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5786e+00
[rank2]:2025-12-29 01:51:28,810 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0745e+01
[rank1]:2025-12-29 01:51:28,810 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0194e+01
[rank3]:2025-12-29 01:51:28,834 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4720e+00
[rank0]:2025-12-29 01:51:28,826 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1386e+00
[rank2]:2025-12-29 01:52:11,932 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4850e+00
[rank1]:2025-12-29 01:52:11,933 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.1780e+00
[rank3]:2025-12-29 01:52:11,948 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7313e+00
[rank0]:2025-12-29 01:52:11,929 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:52:11,948 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9071e+00
[rank3]:2025-12-29 01:52:16,580 - Avg. fwd time: 25.2304 / Avg. bwd time: 77.3075 / Avg. batch time: 965.5413 (ms) / GPU bubble ratio: 15.04%
[rank2]:2025-12-29 01:52:16,609 - Avg. fwd time: 15.1967 / Avg. bwd time: 30.0494 / Avg. batch time: 1017.9495 (ms) / GPU bubble ratio: 64.44%
[rank2]:2025-12-29 01:52:16,687 -  step: 200  loss: -4.0000  grad_norm: 17.7464  memory:  8.66GiB(18.23%)  tps: 7,227  tflops: 56.50  mfu: 18.11%
[rank1]:2025-12-29 01:52:16,643 - Avg. fwd time: 20.0154 / Avg. bwd time: 40.2442 / Avg. batch time: 1084.7566 (ms) / GPU bubble ratio: 55.56%
[rank1]:2025-12-29 01:52:16,687 -  step: 200  loss: -4.0000  grad_norm: 17.7464  memory: 12.86GiB(27.07%)  tps: 7,227  tflops: 56.50  mfu: 18.11%
[rank3]:2025-12-29 01:52:16,709 -  step: 200  loss:  1.1635  grad_norm: 17.7464  memory: 25.79GiB(54.28%)  tps: 7,227  tflops: 56.49  mfu: 18.11%
[rank0]:2025-12-29 01:52:16,678 - Avg. fwd time: 16.3607 / Avg. bwd time: 38.2732 / Avg. batch time: 1146.5205 (ms) / GPU bubble ratio: 61.88%
[rank0]:2025-12-29 01:52:16,705 -  step: 200  loss: -4.0000  grad_norm: 17.7464  memory: 16.87GiB(35.50%)  tps: 7,227  tflops: 56.50  mfu: 18.11%
[rank2]:2025-12-29 01:52:16,762 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0152_stage2_step200.svg
[rank1]:2025-12-29 01:52:16,763 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0152_stage1_step200.svg
[rank0]:2025-12-29 01:52:16,762 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0152_stage0_step200.svg
[rank3]:2025-12-29 01:52:16,857 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0152_step200_rank3.svg
[rank3]:			> Batch Time: 1058.36 ms, GPU Bubble Ratio: 65.89%, 64.03%, 71.51%, 27.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  232-28-260ms   | [S0,MB4,F]  261-16-277ms   | [S0,MB1,B]  343-28-371ms   | [S0,MB5,F]  372-16-388ms   | [S0,MB2,B]  457-28-485ms   | [S0,MB6,F]  486-16-502ms   | [S0,MB3,B]  574-28-602ms   | [S0,MB7,F]  603-16-619ms   | [S0,MB4,B]  692-28-720ms   | [S0,MB5,B]  806-28-834ms   | [S0,MB6,B]  917-28-945ms   | [S0,MB7,B]  1030-28-1058ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  43-19-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  197-27-224ms   | [S1,MB3,F]  229-20-249ms   | [S1,MB1,B]  308-27-335ms   | [S1,MB4,F]  340-20-360ms   | [S1,MB2,B]  422-27-449ms   | [S1,MB5,F]  454-20-474ms   | [S1,MB3,B]  539-27-566ms   | [S1,MB6,F]  571-20-591ms   | [S1,MB4,B]  656-27-683ms   | [S1,MB7,F]  688-20-708ms   | [S1,MB5,B]  771-27-799ms   | [S1,MB6,B]  883-27-911ms   | [S1,MB7,B]  996-27-1024ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  164-22-187ms   | [S2,MB2,F]  194-15-209ms   | [S2,MB1,B]  275-22-298ms   | [S2,MB3,F]  305-15-321ms   | [S2,MB2,B]  389-22-412ms   | [S2,MB4,F]  419-15-434ms   | [S2,MB3,B]  506-22-529ms   | [S2,MB5,F]  536-15-551ms   | [S2,MB4,B]  623-22-645ms   | [S2,MB6,F]  652-15-668ms   | [S2,MB5,B]  739-22-761ms   | [S2,MB7,F]  768-15-784ms   | [S2,MB6,B]  855-22-877ms   | [S2,MB7,B]  967-22-989ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-66-154ms    | [S3,MB1,F]  161-24-186ms   | [S3,MB1,B]  198-69-267ms   | [S3,MB2,F]  272-25-298ms   | [S3,MB2,B]  310-70-380ms   | [S3,MB3,F]  386-26-413ms   | [S3,MB3,B]  425-71-496ms   | [S3,MB4,F]  503-26-530ms   | [S3,MB4,B]  543-70-614ms   | [S3,MB5,F]  620-26-647ms   | [S3,MB5,B]  659-70-729ms   | [S3,MB6,F]  736-26-762ms   | [S3,MB6,B]  774-70-845ms   | [S3,MB7,F]  851-26-878ms   | [S3,MB7,B]  890-70-961ms  
[rank3]:2025-12-29 01:52:16,903 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0152_stage3_step200.svg
[rank0]:2025-12-29 01:52:16,913 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0152_rank0_stage0.svg
[rank0]:	> Counts Sum: 171, Total Sum: 555 (30.81%), Ratio(%) per element: [0.0, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-29 01:52:16,909 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0152_rank2_stage2.svg
[rank2]:	> Counts Sum: 243, Total Sum: 540 (45.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 01:52:16,906 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0152_rank1_stage1.svg
[rank1]:	> Counts Sum: 252, Total Sum: 675 (37.33%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 01:52:17,040 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0152_rank3_stage3.svg
[rank3]:	> Counts Sum: 117, Total Sum: 435 (26.90%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-29 01:52:59,142 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1522e+00
[rank1]:2025-12-29 01:52:59,142 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0171e+00
[rank3]:2025-12-29 01:52:59,166 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.3173e-01
[rank0]:2025-12-29 01:52:59,158 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7068e+00
[rank2]:2025-12-29 01:53:42,377 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4602e+01
[rank1]:2025-12-29 01:53:42,377 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.1431e+00
[rank3]:2025-12-29 01:53:42,392 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1732e+00
[rank0]:2025-12-29 01:53:42,396 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8247e+00
[rank1]:2025-12-29 01:54:29,180 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0273e+00
[rank3]:2025-12-29 01:54:29,203 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4496e+00
[rank0]:2025-12-29 01:54:29,198 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2005e+00
[rank2]:2025-12-29 01:54:29,180 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4158e+00
[rank2]:2025-12-29 01:55:12,562 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7218e+00
[rank1]:2025-12-29 01:55:12,562 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.6787e+00
[rank3]:2025-12-29 01:55:12,577 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8304e+00
[rank0]:2025-12-29 01:55:12,578 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1501e+00
[rank2]:2025-12-29 01:55:59,466 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2152e-01
[rank1]:2025-12-29 01:55:59,467 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.6684e-01
[rank0]:2025-12-29 01:55:59,472 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 01:55:59,482 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7772e+00
[rank3]:2025-12-29 01:55:59,490 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1287e-01
[rank3]:2025-12-29 01:56:03,710 - Avg. fwd time: 25.2728 / Avg. bwd time: 77.1708 / Avg. batch time: 964.7735 (ms) / GPU bubble ratio: 15.05%
[rank2]:2025-12-29 01:56:03,739 - Avg. fwd time: 15.2652 / Avg. bwd time: 28.4976 / Avg. batch time: 1015.6227 (ms) / GPU bubble ratio: 65.53%
[rank1]:2025-12-29 01:56:03,774 - Avg. fwd time: 20.0651 / Avg. bwd time: 37.6755 / Avg. batch time: 1079.8485 (ms) / GPU bubble ratio: 57.22%
[rank0]:2025-12-29 01:56:03,809 - Avg. fwd time: 16.4406 / Avg. bwd time: 36.2842 / Avg. batch time: 1139.5543 (ms) / GPU bubble ratio: 62.99%
[rank0]:2025-12-29 01:56:03,834 -  step: 250  loss: -4.0000  grad_norm:  4.0850  memory: 16.87GiB(35.50%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank3]:2025-12-29 01:56:03,834 -  step: 250  loss:  0.3921  grad_norm:  4.0850  memory: 25.79GiB(54.28%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank2]:2025-12-29 01:56:03,818 -  step: 250  loss: -4.0000  grad_norm:  4.0850  memory:  8.66GiB(18.23%)  tps: 7,213  tflops: 56.39  mfu: 18.07%
[rank1]:2025-12-29 01:56:03,818 -  step: 250  loss: -4.0000  grad_norm:  4.0850  memory: 12.86GiB(27.07%)  tps: 7,213  tflops: 56.39  mfu: 18.07%
[rank3]:2025-12-29 01:56:42,888 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3306e+00
[rank2]:2025-12-29 01:56:42,872 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2968e+00
[rank1]:2025-12-29 01:56:42,873 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.1444e+00
[rank0]:2025-12-29 01:56:42,888 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5199e+00
[rank0]:2025-12-29 01:57:29,643 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9992e+00
[rank3]:2025-12-29 01:57:29,647 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2142e+00
[rank2]:2025-12-29 01:57:29,624 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7980e+00
[rank1]:2025-12-29 01:57:29,624 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.8569e+00
[rank3]:2025-12-29 01:58:13,005 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4221e+00
[rank2]:2025-12-29 01:58:12,990 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1776e-01
[rank1]:2025-12-29 01:58:12,990 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.6205e-01
[rank0]:2025-12-29 01:58:13,008 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.6942e-01
[rank2]:2025-12-29 01:59:00,120 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6163e+00
[rank1]:2025-12-29 01:59:00,120 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5098e+00
[rank0]:2025-12-29 01:59:00,137 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9998e+00
[rank3]:2025-12-29 01:59:00,144 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0024e+00
[rank0]:2025-12-29 01:59:43,404 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 01:59:43,424 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2122e+00
[rank3]:2025-12-29 01:59:43,423 - Freezing Ratio: [Stage3] 0.00, Threshold: 8.9301e-01
[rank2]:2025-12-29 01:59:43,408 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.5041e-01
[rank1]:2025-12-29 01:59:43,408 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0499e+00
[rank3]:2025-12-29 01:59:47,998 - Avg. fwd time: 25.3388 / Avg. bwd time: 76.7713 / Avg. batch time: 962.1016 (ms) / GPU bubble ratio: 15.09%
[rank2]:2025-12-29 01:59:48,028 - Avg. fwd time: 15.3145 / Avg. bwd time: 27.4787 / Avg. batch time: 1011.8673 (ms) / GPU bubble ratio: 66.17%
[rank1]:2025-12-29 01:59:48,063 - Avg. fwd time: 20.1087 / Avg. bwd time: 35.9719 / Avg. batch time: 1074.3792 (ms) / GPU bubble ratio: 58.24%
[rank0]:2025-12-29 01:59:48,099 - Avg. fwd time: 16.4942 / Avg. bwd time: 34.9643 / Avg. batch time: 1132.7150 (ms) / GPU bubble ratio: 63.66%
[rank0]:2025-12-29 01:59:48,123 -  step: 300  loss: -4.0000  grad_norm:  0.6088  memory: 16.87GiB(35.50%)  tps: 7,305  tflops: 57.11  mfu: 18.30%
[rank3]:2025-12-29 01:59:48,132 -  step: 300  loss:  0.2873  grad_norm:  0.6088  memory: 25.79GiB(54.28%)  tps: 7,305  tflops: 57.10  mfu: 18.30%
[rank2]:2025-12-29 01:59:48,108 -  step: 300  loss: -4.0000  grad_norm:  0.6088  memory:  8.66GiB(18.23%)  tps: 7,305  tflops: 57.11  mfu: 18.30%
[rank2]:2025-12-29 01:59:48,183 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0159_stage2_step300.svg
[rank1]:2025-12-29 01:59:48,108 -  step: 300  loss: -4.0000  grad_norm:  0.6088  memory: 12.86GiB(27.07%)  tps: 7,305  tflops: 57.11  mfu: 18.30%
[rank1]:2025-12-29 01:59:48,185 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0159_stage1_step300.svg
[rank0]:2025-12-29 01:59:48,183 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0159_stage0_step300.svg
[rank3]:2025-12-29 01:59:48,278 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0159_step300_rank3.svg
[rank3]:			> Batch Time: 1061.44 ms, GPU Bubble Ratio: 65.94%, 63.95%, 71.45%, 27.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-69ms     | [S0,MB0,B]  232-28-261ms   | [S0,MB4,F]  261-16-277ms   | [S0,MB1,B]  344-28-373ms   | [S0,MB5,F]  373-16-389ms   | [S0,MB2,B]  460-28-488ms   | [S0,MB6,F]  488-16-504ms   | [S0,MB3,B]  576-28-605ms   | [S0,MB7,F]  605-16-621ms   | [S0,MB4,B]  692-28-720ms   | [S0,MB5,B]  807-28-836ms   | [S0,MB6,B]  920-28-949ms   | [S0,MB7,B]  1033-28-1061ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  69-19-89ms     | [S1,MB0,B]  197-27-224ms   | [S1,MB3,F]  229-20-249ms   | [S1,MB1,B]  309-27-336ms   | [S1,MB4,F]  341-20-361ms   | [S1,MB2,B]  424-27-452ms   | [S1,MB5,F]  456-21-477ms   | [S1,MB3,B]  541-27-568ms   | [S1,MB6,F]  573-20-594ms   | [S1,MB4,B]  656-27-684ms   | [S1,MB7,F]  688-20-709ms   | [S1,MB5,B]  773-27-801ms   | [S1,MB6,B]  886-27-914ms   | [S1,MB7,B]  998-27-1025ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  164-22-187ms   | [S2,MB2,F]  194-15-209ms   | [S2,MB1,B]  276-22-299ms   | [S2,MB3,F]  306-15-321ms   | [S2,MB2,B]  392-22-414ms   | [S2,MB4,F]  421-15-437ms   | [S2,MB3,B]  508-22-531ms   | [S2,MB5,F]  538-15-553ms   | [S2,MB4,B]  624-22-646ms   | [S2,MB6,F]  653-15-669ms   | [S2,MB5,B]  741-22-763ms   | [S2,MB7,F]  770-15-786ms   | [S2,MB6,B]  857-22-880ms   | [S2,MB7,B]  969-22-991ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-67-154ms    | [S3,MB1,F]  161-24-186ms   | [S3,MB1,B]  198-69-268ms   | [S3,MB2,F]  273-26-299ms   | [S3,MB2,B]  312-70-382ms   | [S3,MB3,F]  388-27-416ms   | [S3,MB3,B]  427-70-498ms   | [S3,MB4,F]  505-26-532ms   | [S3,MB4,B]  544-70-615ms   | [S3,MB5,F]  621-26-647ms   | [S3,MB5,B]  660-70-730ms   | [S3,MB6,F]  738-26-764ms   | [S3,MB6,B]  777-70-847ms   | [S3,MB7,F]  854-26-881ms   | [S3,MB7,B]  892-71-963ms  
[rank3]:2025-12-29 01:59:48,323 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0159_stage3_step300.svg
[rank2]:2025-12-29 01:59:48,330 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0159_rank2_stage2.svg
[rank2]:	> Counts Sum: 513, Total Sum: 900 (57.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 01:59:48,331 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0159_rank1_stage1.svg
[rank1]:	> Counts Sum: 612, Total Sum: 1125 (54.40%), Ratio(%) per element: [68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 01:59:48,335 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0159_rank0_stage0.svg
[rank0]:	> Counts Sum: 441, Total Sum: 925 (47.68%), Ratio(%) per element: [0.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 01:59:48,456 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0159_rank3_stage3.svg
[rank3]:	> Counts Sum: 207, Total Sum: 725 (28.55%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-29 02:00:30,549 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9497e+00
[rank1]:2025-12-29 02:00:30,549 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9273e+00
[rank0]:2025-12-29 02:00:30,569 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5065e+00
[rank3]:2025-12-29 02:00:30,573 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.8734e-01
[rank3]:2025-12-29 02:01:13,853 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1556e+00
[rank1]:2025-12-29 02:01:13,838 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9062e+00
[rank2]:2025-12-29 02:01:13,837 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6809e+00
[rank0]:2025-12-29 02:01:13,855 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5242e+00
[rank2]:2025-12-29 02:02:00,627 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7119e+00
[rank1]:2025-12-29 02:02:00,627 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0369e+00
[rank0]:2025-12-29 02:02:00,643 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3205e+00
[rank3]:2025-12-29 02:02:00,651 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3449e+00
[rank3]:2025-12-29 02:02:43,778 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.0897e-01
[rank2]:2025-12-29 02:02:43,762 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5803e+00
[rank1]:2025-12-29 02:02:43,762 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0451e+00
[rank0]:2025-12-29 02:02:43,779 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1224e+00
[rank0]:2025-12-29 02:03:30,329 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-29 02:03:30,348 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7866e-01
[rank2]:2025-12-29 02:03:30,323 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8530e-01
[rank1]:2025-12-29 02:03:30,324 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9637e-01
[rank0]:2025-12-29 02:03:30,339 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5304e-01
[rank3]:2025-12-29 02:03:34,539 - Avg. fwd time: 25.3443 / Avg. bwd time: 76.7098 / Avg. batch time: 961.6462 (ms) / GPU bubble ratio: 15.10%
[rank2]:2025-12-29 02:03:34,570 - Avg. fwd time: 15.3501 / Avg. bwd time: 26.7468 / Avg. batch time: 1010.6785 (ms) / GPU bubble ratio: 66.68%
[rank1]:2025-12-29 02:03:34,604 - Avg. fwd time: 20.1362 / Avg. bwd time: 34.7496 / Avg. batch time: 1071.9560 (ms) / GPU bubble ratio: 59.04%
[rank0]:2025-12-29 02:03:34,640 - Avg. fwd time: 16.5347 / Avg. bwd time: 34.0190 / Avg. batch time: 1129.3150 (ms) / GPU bubble ratio: 64.19%
[rank3]:2025-12-29 02:03:34,665 -  step: 350  loss:  0.2397  grad_norm:  0.2868  memory: 25.79GiB(54.28%)  tps: 7,233  tflops: 56.54  mfu: 18.12%
[rank2]:2025-12-29 02:03:34,649 -  step: 350  loss: -4.0000  grad_norm:  0.2868  memory:  8.66GiB(18.23%)  tps: 7,232  tflops: 56.54  mfu: 18.12%
[rank1]:2025-12-29 02:03:34,649 -  step: 350  loss: -4.0000  grad_norm:  0.2868  memory: 12.86GiB(27.07%)  tps: 7,232  tflops: 56.54  mfu: 18.12%
[rank0]:2025-12-29 02:03:34,665 -  step: 350  loss: -4.0000  grad_norm:  0.2868  memory: 16.87GiB(35.50%)  tps: 7,232  tflops: 56.54  mfu: 18.12%
[rank3]:2025-12-29 02:04:13,506 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4492e-01
[rank2]:2025-12-29 02:04:13,490 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6303e-01
[rank1]:2025-12-29 02:04:13,491 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.2950e-01
[rank0]:2025-12-29 02:04:13,506 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9897e-01
[rank0]:2025-12-29 02:05:00,355 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9373e+00
[rank2]:2025-12-29 02:05:00,340 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1040e+00
[rank3]:2025-12-29 02:05:00,363 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0245e+00
[rank1]:2025-12-29 02:05:00,340 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6751e+00
[rank1]:2025-12-29 02:05:43,677 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6839e+00
[rank0]:2025-12-29 02:05:43,695 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0202e+00
[rank2]:2025-12-29 02:05:43,677 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0892e+00
[rank3]:2025-12-29 02:05:43,693 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9715e+00
[rank2]:2025-12-29 02:06:30,379 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0290e-01
[rank3]:2025-12-29 02:06:30,403 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8304e-01
[rank1]:2025-12-29 02:06:30,379 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1407e-01
[rank0]:2025-12-29 02:06:30,396 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4764e-01
[rank0]:2025-12-29 02:07:13,703 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 02:07:13,723 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4230e-01
[rank2]:2025-12-29 02:07:13,706 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7830e-01
[rank3]:2025-12-29 02:07:13,722 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2006e-01
[rank1]:2025-12-29 02:07:13,706 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5093e-01
[rank3]:2025-12-29 02:07:18,367 - Avg. fwd time: 25.3795 / Avg. bwd time: 76.4356 / Avg. batch time: 959.7319 (ms) / GPU bubble ratio: 15.13%
[rank2]:2025-12-29 02:07:18,398 - Avg. fwd time: 15.3774 / Avg. bwd time: 26.1963 / Avg. batch time: 1008.1766 (ms) / GPU bubble ratio: 67.01%
[rank2]:2025-12-29 02:07:18,479 -  step: 400  loss: -4.0000  grad_norm:  0.4653  memory:  8.66GiB(18.23%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank1]:2025-12-29 02:07:18,433 - Avg. fwd time: 20.1631 / Avg. bwd time: 33.8322 / Avg. batch time: 1068.5325 (ms) / GPU bubble ratio: 59.57%
[rank1]:2025-12-29 02:07:18,479 -  step: 400  loss: -4.0000  grad_norm:  0.4653  memory: 12.86GiB(27.07%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank0]:2025-12-29 02:07:18,470 - Avg. fwd time: 16.5640 / Avg. bwd time: 33.3102 / Avg. batch time: 1125.1618 (ms) / GPU bubble ratio: 64.54%
[rank0]:2025-12-29 02:07:18,493 -  step: 400  loss: -4.0000  grad_norm:  0.4653  memory: 16.87GiB(35.50%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank2]:2025-12-29 02:07:18,556 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0207_stage2_step400.svg
[rank3]:2025-12-29 02:07:18,501 -  step: 400  loss:  0.2245  grad_norm:  0.4653  memory: 25.79GiB(54.28%)  tps: 7,320  tflops: 57.22  mfu: 18.34%
[rank1]:2025-12-29 02:07:18,560 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0207_stage1_step400.svg
[rank0]:2025-12-29 02:07:18,558 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0207_stage0_step400.svg
[rank3]:2025-12-29 02:07:18,646 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0207_step400_rank3.svg
[rank3]:			> Batch Time: 1062.42 ms, GPU Bubble Ratio: 65.95%, 63.94%, 71.46%, 27.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-51ms     | [S0,MB3,F]  51-17-69ms     | [S0,MB0,B]  232-28-260ms   | [S0,MB4,F]  260-16-276ms   | [S0,MB1,B]  345-28-373ms   | [S0,MB5,F]  373-16-390ms   | [S0,MB2,B]  460-28-489ms   | [S0,MB6,F]  489-16-505ms   | [S0,MB3,B]  577-28-605ms   | [S0,MB7,F]  605-16-621ms   | [S0,MB4,B]  694-28-722ms   | [S0,MB5,B]  807-28-836ms   | [S0,MB6,B]  921-28-949ms   | [S0,MB7,B]  1034-28-1062ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-19-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  196-27-224ms   | [S1,MB3,F]  229-20-249ms   | [S1,MB1,B]  310-27-337ms   | [S1,MB4,F]  342-20-362ms   | [S1,MB2,B]  425-27-452ms   | [S1,MB5,F]  457-20-478ms   | [S1,MB3,B]  541-27-568ms   | [S1,MB6,F]  573-21-594ms   | [S1,MB4,B]  658-27-685ms   | [S1,MB7,F]  690-20-711ms   | [S1,MB5,B]  773-27-801ms   | [S1,MB6,B]  887-27-915ms   | [S1,MB7,B]  1000-27-1027ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  164-22-186ms   | [S2,MB2,F]  193-15-209ms   | [S2,MB1,B]  278-22-300ms   | [S2,MB3,F]  307-15-323ms   | [S2,MB2,B]  392-22-415ms   | [S2,MB4,F]  422-15-437ms   | [S2,MB3,B]  508-22-531ms   | [S2,MB5,F]  538-15-553ms   | [S2,MB4,B]  625-22-648ms   | [S2,MB6,F]  655-15-670ms   | [S2,MB5,B]  741-22-763ms   | [S2,MB7,F]  770-15-786ms   | [S2,MB6,B]  858-22-881ms   | [S2,MB7,B]  971-22-994ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-65-153ms    | [S3,MB1,F]  161-25-186ms   | [S3,MB1,B]  198-70-268ms   | [S3,MB2,F]  275-26-301ms   | [S3,MB2,B]  313-70-383ms   | [S3,MB3,F]  389-26-416ms   | [S3,MB3,B]  428-70-499ms   | [S3,MB4,F]  505-26-532ms   | [S3,MB4,B]  544-70-615ms   | [S3,MB5,F]  622-26-649ms   | [S3,MB5,B]  660-71-732ms   | [S3,MB6,F]  738-26-764ms   | [S3,MB6,B]  777-71-849ms   | [S3,MB7,F]  855-26-882ms   | [S3,MB7,B]  894-71-965ms  
[rank3]:2025-12-29 02:07:18,694 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0207_stage3_step400.svg
[rank0]:2025-12-29 02:07:18,713 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0207_rank0_stage0.svg
[rank0]:	> Counts Sum: 711, Total Sum: 1295 (54.90%), Ratio(%) per element: [0.0, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-29 02:07:18,703 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0207_rank2_stage2.svg
[rank2]:	> Counts Sum: 783, Total Sum: 1260 (62.14%), Ratio(%) per element: [82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 02:07:18,709 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0207_rank1_stage1.svg
[rank1]:	> Counts Sum: 972, Total Sum: 1575 (61.71%), Ratio(%) per element: [77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:07:18,828 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0207_rank3_stage3.svg
[rank3]:	> Counts Sum: 297, Total Sum: 1015 (29.26%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:07:45,036 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-29 02:07:45,440 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-29 02:07:45,471 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-29 02:07:45,502 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-29 02:08:00,708 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3573e+00
[rank1]:2025-12-29 02:08:00,708 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3504e+00
[rank3]:2025-12-29 02:08:00,732 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0740e+00
[rank0]:2025-12-29 02:08:00,724 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7263e+00
[rank0]:2025-12-29 02:08:43,729 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6906e+00
[rank2]:2025-12-29 02:08:43,714 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5898e+00
[rank1]:2025-12-29 02:08:43,714 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9498e+00
[rank3]:2025-12-29 02:08:43,729 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9218e+00
[rank1]:2025-12-29 02:09:30,038 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2523e+00
[rank2]:2025-12-29 02:09:30,038 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1117e+00
[rank3]:2025-12-29 02:09:30,061 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.2294e-01
[rank0]:2025-12-29 02:09:30,054 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1296e+00
[rank3]:2025-12-29 02:10:13,152 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2966e+00
[rank0]:2025-12-29 02:10:13,153 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3587e+00
[rank1]:2025-12-29 02:10:13,136 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4833e+00
[rank2]:2025-12-29 02:10:13,136 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4074e+00
[rank0]:2025-12-29 02:10:59,831 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-29 02:10:59,826 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9431e+00
[rank1]:2025-12-29 02:10:59,826 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0590e+00
[rank3]:2025-12-29 02:10:59,850 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3106e+00
[rank0]:2025-12-29 02:10:59,845 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5070e+00
[rank2]:2025-12-29 02:11:04,067 - Avg. fwd time: 15.3935 / Avg. bwd time: 25.7647 / Avg. batch time: 1007.2647 (ms) / GPU bubble ratio: 67.31%
[rank3]:2025-12-29 02:11:04,036 - Avg. fwd time: 25.3681 / Avg. bwd time: 76.3875 / Avg. batch time: 959.2515 (ms) / GPU bubble ratio: 15.14%
[rank0]:2025-12-29 02:11:04,140 - Avg. fwd time: 16.5867 / Avg. bwd time: 32.7563 / Avg. batch time: 1122.9494 (ms) / GPU bubble ratio: 64.85%
[rank2]:2025-12-29 02:11:04,149 -  step: 450  loss: -4.0000  grad_norm:  0.1286  memory:  8.66GiB(18.23%)  tps: 7,260  tflops: 56.76  mfu: 18.19%
[rank1]:2025-12-29 02:11:04,103 - Avg. fwd time: 20.1784 / Avg. bwd time: 33.1138 / Avg. batch time: 1066.8947 (ms) / GPU bubble ratio: 60.04%
[rank1]:2025-12-29 02:11:04,149 -  step: 450  loss: -4.0000  grad_norm:  0.1286  memory: 12.86GiB(27.07%)  tps: 7,260  tflops: 56.76  mfu: 18.19%
[rank3]:2025-12-29 02:11:04,165 -  step: 450  loss:  0.2383  grad_norm:  0.1286  memory: 25.79GiB(54.28%)  tps: 7,260  tflops: 56.76  mfu: 18.19%
[rank0]:2025-12-29 02:11:04,165 -  step: 450  loss: -4.0000  grad_norm:  0.1286  memory: 16.87GiB(35.50%)  tps: 7,260  tflops: 56.76  mfu: 18.19%
[rank0]:2025-12-29 02:11:42,995 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6147e-01
[rank1]:2025-12-29 02:11:42,978 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1102e-01
[rank2]:2025-12-29 02:11:42,977 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0547e-01
[rank3]:2025-12-29 02:11:42,993 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3455e-01
[rank1]:2025-12-29 02:12:29,671 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1425e-01
[rank2]:2025-12-29 02:12:29,670 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1284e-01
[rank3]:2025-12-29 02:12:29,694 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1408e-01
[rank0]:2025-12-29 02:12:29,686 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6447e-01
[rank0]:2025-12-29 02:13:13,017 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9725e-01
[rank1]:2025-12-29 02:13:13,001 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7043e-01
[rank2]:2025-12-29 02:13:13,001 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3951e-01
[rank3]:2025-12-29 02:13:13,017 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9897e-01
[rank0]:2025-12-29 02:13:59,876 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1319e+00
[rank1]:2025-12-29 02:13:59,860 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2516e-01
[rank2]:2025-12-29 02:13:59,860 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4526e+00
[rank3]:2025-12-29 02:13:59,883 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0423e-01
[rank0]:2025-12-29 02:14:43,135 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-29 02:14:43,139 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3663e+00
[rank1]:2025-12-29 02:14:43,139 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4144e+00
[rank3]:2025-12-29 02:14:43,154 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.8885e-01
[rank0]:2025-12-29 02:14:43,156 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3853e+00
[rank3]:2025-12-29 02:14:47,722 - Avg. fwd time: 25.3882 / Avg. bwd time: 76.1979 / Avg. batch time: 957.8967 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-29 02:14:47,753 - Avg. fwd time: 15.4108 / Avg. bwd time: 25.4203 / Avg. batch time: 1005.5373 (ms) / GPU bubble ratio: 67.52%
[rank0]:2025-12-29 02:14:47,826 - Avg. fwd time: 16.6043 / Avg. bwd time: 32.3147 / Avg. batch time: 1120.1862 (ms) / GPU bubble ratio: 65.06%
[rank0]:2025-12-29 02:14:47,849 -  step: 500  loss: -4.0000  grad_norm:  0.2207  memory: 16.87GiB(35.50%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank1]:2025-12-29 02:14:47,789 - Avg. fwd time: 20.1923 / Avg. bwd time: 32.5410 / Avg. batch time: 1064.5886 (ms) / GPU bubble ratio: 60.37%
[rank1]:2025-12-29 02:14:47,835 -  step: 500  loss: -4.0000  grad_norm:  0.2207  memory: 12.86GiB(27.07%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank2]:2025-12-29 02:14:47,835 -  step: 500  loss: -4.0000  grad_norm:  0.2207  memory:  8.66GiB(18.23%)  tps: 7,325  tflops: 57.26  mfu: 18.35%
[rank3]:2025-12-29 02:14:47,857 -  step: 500  loss:  0.2355  grad_norm:  0.2207  memory: 25.79GiB(54.28%)  tps: 7,324  tflops: 57.26  mfu: 18.35%
[rank0]:2025-12-29 02:14:47,908 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0214_stage0_step500.svg
[rank1]:2025-12-29 02:14:47,909 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0214_stage1_step500.svg
[rank2]:2025-12-29 02:14:47,908 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0214_stage2_step500.svg
[rank3]:2025-12-29 02:14:48,002 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0214_step500_rank3.svg
[rank3]:			> Batch Time: 1063.42 ms, GPU Bubble Ratio: 66.02%, 64.05%, 71.51%, 27.91%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  231-28-260ms   | [S0,MB4,F]  260-16-276ms   | [S0,MB1,B]  344-28-373ms   | [S0,MB5,F]  373-16-389ms   | [S0,MB2,B]  460-28-488ms   | [S0,MB6,F]  488-16-504ms   | [S0,MB3,B]  577-28-605ms   | [S0,MB7,F]  605-16-621ms   | [S0,MB4,B]  694-28-722ms   | [S0,MB5,B]  809-28-838ms   | [S0,MB6,B]  924-28-952ms   | [S0,MB7,B]  1035-28-1063ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  68-20-89ms     | [S1,MB0,B]  196-27-224ms   | [S1,MB3,F]  228-20-248ms   | [S1,MB1,B]  309-27-336ms   | [S1,MB4,F]  341-20-361ms   | [S1,MB2,B]  425-27-452ms   | [S1,MB5,F]  457-20-478ms   | [S1,MB3,B]  541-27-569ms   | [S1,MB6,F]  574-20-595ms   | [S1,MB4,B]  659-27-687ms   | [S1,MB7,F]  691-20-712ms   | [S1,MB5,B]  775-27-803ms   | [S1,MB6,B]  890-27-917ms   | [S1,MB7,B]  1001-27-1028ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  163-22-186ms   | [S2,MB2,F]  193-15-208ms   | [S2,MB1,B]  276-22-299ms   | [S2,MB3,F]  306-15-321ms   | [S2,MB2,B]  392-22-415ms   | [S2,MB4,F]  422-15-437ms   | [S2,MB3,B]  509-22-531ms   | [S2,MB5,F]  538-15-554ms   | [S2,MB4,B]  626-22-649ms   | [S2,MB6,F]  656-15-672ms   | [S2,MB5,B]  742-22-765ms   | [S2,MB7,F]  772-15-787ms   | [S2,MB6,B]  861-22-884ms   | [S2,MB7,B]  972-22-994ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-65-153ms    | [S3,MB1,F]  160-24-185ms   | [S3,MB1,B]  198-69-267ms   | [S3,MB2,F]  273-25-299ms   | [S3,MB2,B]  312-70-383ms   | [S3,MB3,F]  389-26-416ms   | [S3,MB3,B]  428-70-499ms   | [S3,MB4,F]  506-26-532ms   | [S3,MB4,B]  545-70-616ms   | [S3,MB5,F]  623-26-650ms   | [S3,MB5,B]  662-70-732ms   | [S3,MB6,F]  739-26-766ms   | [S3,MB6,B]  778-70-849ms   | [S3,MB7,F]  858-26-884ms   | [S3,MB7,B]  896-70-967ms  
[rank3]:2025-12-29 02:14:48,046 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0214_stage3_step500.svg
[rank1]:2025-12-29 02:14:48,059 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0214_rank1_stage1.svg
[rank1]:	> Counts Sum: 1332, Total Sum: 2025 (65.78%), Ratio(%) per element: [82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-29 02:14:48,055 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0214_rank2_stage2.svg
[rank2]:	> Counts Sum: 1053, Total Sum: 1620 (65.00%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 02:14:48,065 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0214_rank0_stage0.svg
[rank0]:	> Counts Sum: 981, Total Sum: 1665 (58.92%), Ratio(%) per element: [0.0, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:14:48,177 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0214_rank3_stage3.svg
[rank3]:	> Counts Sum: 387, Total Sum: 1305 (29.66%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:15:30,204 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4013e-01
[rank0]:2025-12-29 02:15:30,195 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3979e-01
[rank2]:2025-12-29 02:15:30,180 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2466e+00
[rank1]:2025-12-29 02:15:30,180 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6051e+00
[rank0]:2025-12-29 02:16:13,534 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2174e+00
[rank3]:2025-12-29 02:16:13,531 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8533e+00
[rank2]:2025-12-29 02:16:13,515 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9401e+00
[rank1]:2025-12-29 02:16:13,515 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4458e+00
[rank2]:2025-12-29 02:17:00,228 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1000e+00
[rank1]:2025-12-29 02:17:00,229 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9261e-01
[rank0]:2025-12-29 02:17:00,244 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3206e-01
[rank3]:2025-12-29 02:17:00,252 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2040e-01
[rank0]:2025-12-29 02:17:43,268 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1319e+00
[rank3]:2025-12-29 02:17:43,265 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9004e+00
[rank1]:2025-12-29 02:17:43,249 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9064e+00
[rank2]:2025-12-29 02:17:43,249 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1845e+00
[rank2]:2025-12-29 02:18:29,972 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3006e+00
[rank1]:2025-12-29 02:18:29,972 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.9711e-01
[rank0]:2025-12-29 02:18:29,977 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 02:18:29,990 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5630e-01
[rank3]:2025-12-29 02:18:29,995 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1152e+00
[rank3]:2025-12-29 02:18:34,251 - Avg. fwd time: 25.3838 / Avg. bwd time: 76.2138 / Avg. batch time: 957.9830 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-29 02:18:34,282 - Avg. fwd time: 15.4243 / Avg. bwd time: 25.1362 / Avg. batch time: 1005.3404 (ms) / GPU bubble ratio: 67.72%
[rank0]:2025-12-29 02:18:34,355 - Avg. fwd time: 16.6169 / Avg. bwd time: 31.9516 / Avg. batch time: 1119.1381 (ms) / GPU bubble ratio: 65.28%
[rank3]:2025-12-29 02:18:34,380 -  step: 550  loss:  0.2421  grad_norm:  0.2119  memory: 25.79GiB(54.28%)  tps: 7,233  tflops: 56.54  mfu: 18.12%
[rank2]:2025-12-29 02:18:34,364 -  step: 550  loss: -4.0000  grad_norm:  0.2119  memory:  8.66GiB(18.23%)  tps: 7,233  tflops: 56.54  mfu: 18.12%
[rank1]:2025-12-29 02:18:34,318 - Avg. fwd time: 20.2036 / Avg. bwd time: 32.0707 / Avg. batch time: 1063.9160 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-12-29 02:18:34,364 -  step: 550  loss: -4.0000  grad_norm:  0.2119  memory: 12.86GiB(27.07%)  tps: 7,233  tflops: 56.54  mfu: 18.12%
[rank0]:2025-12-29 02:18:34,378 -  step: 550  loss: -4.0000  grad_norm:  0.2119  memory: 16.87GiB(35.50%)  tps: 7,233  tflops: 56.54  mfu: 18.12%
[rank0]:2025-12-29 02:19:13,392 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.0538e-01
[rank3]:2025-12-29 02:19:13,392 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0158e+00
[rank2]:2025-12-29 02:19:13,376 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2627e+00
[rank1]:2025-12-29 02:19:13,376 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6652e+00
[rank2]:2025-12-29 02:20:00,273 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9242e+00
[rank1]:2025-12-29 02:20:00,274 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5398e+00
[rank0]:2025-12-29 02:20:00,289 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7621e+00
[rank3]:2025-12-29 02:20:00,297 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8034e-01
[rank0]:2025-12-29 02:20:43,522 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5642e+00
[rank3]:2025-12-29 02:20:43,522 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.5535e-01
[rank2]:2025-12-29 02:20:43,507 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8878e+00
[rank1]:2025-12-29 02:20:43,507 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2349e+00
[rank3]:2025-12-29 02:21:30,322 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5761e-01
[rank1]:2025-12-29 02:21:30,298 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.5895e-01
[rank2]:2025-12-29 02:21:30,298 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8723e-01
[rank0]:2025-12-29 02:21:30,317 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0157e+00
[rank0]:2025-12-29 02:22:13,700 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 02:22:13,721 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0240e-01
[rank3]:2025-12-29 02:22:13,719 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1637e-01
[rank1]:2025-12-29 02:22:13,703 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9501e-01
[rank2]:2025-12-29 02:22:13,704 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7319e-01
[rank3]:2025-12-29 02:22:18,379 - Avg. fwd time: 25.4017 / Avg. bwd time: 76.0876 / Avg. batch time: 957.1172 (ms) / GPU bubble ratio: 15.17%
[rank2]:2025-12-29 02:22:18,411 - Avg. fwd time: 15.4358 / Avg. bwd time: 24.9000 / Avg. batch time: 1004.2190 (ms) / GPU bubble ratio: 67.87%
[rank2]:2025-12-29 02:22:18,494 -  step: 600  loss: -4.0000  grad_norm:  0.5050  memory:  8.66GiB(18.23%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank1]:2025-12-29 02:22:18,447 - Avg. fwd time: 20.2170 / Avg. bwd time: 31.6795 / Avg. batch time: 1062.4028 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-12-29 02:22:18,494 -  step: 600  loss: -4.0000  grad_norm:  0.5050  memory: 12.86GiB(27.07%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank0]:2025-12-29 02:22:18,485 - Avg. fwd time: 16.6281 / Avg. bwd time: 31.6499 / Avg. batch time: 1117.3140 (ms) / GPU bubble ratio: 65.43%
[rank0]:2025-12-29 02:22:18,510 -  step: 600  loss: -4.0000  grad_norm:  0.5050  memory: 16.87GiB(35.50%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank3]:2025-12-29 02:22:18,516 -  step: 600  loss:  0.2361  grad_norm:  0.5050  memory: 25.79GiB(54.28%)  tps: 7,310  tflops: 57.15  mfu: 18.32%
[rank2]:2025-12-29 02:22:18,569 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0222_stage2_step600.svg
[rank1]:2025-12-29 02:22:18,572 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0222_stage1_step600.svg
[rank0]:2025-12-29 02:22:18,570 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0222_stage0_step600.svg
[rank3]:2025-12-29 02:22:18,661 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0222_step600_rank3.svg
[rank3]:			> Batch Time: 1066.41 ms, GPU Bubble Ratio: 66.10%, 64.09%, 71.62%, 27.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-69ms     | [S0,MB0,B]  233-28-262ms   | [S0,MB4,F]  262-16-278ms   | [S0,MB1,B]  345-28-374ms   | [S0,MB5,F]  374-16-390ms   | [S0,MB2,B]  461-28-490ms   | [S0,MB6,F]  490-16-506ms   | [S0,MB3,B]  579-28-607ms   | [S0,MB7,F]  607-16-623ms   | [S0,MB4,B]  697-28-725ms   | [S0,MB5,B]  812-28-841ms   | [S0,MB6,B]  925-28-953ms   | [S0,MB7,B]  1038-28-1066ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-20-36ms     | [S1,MB1,F]  43-19-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  198-27-225ms   | [S1,MB3,F]  230-20-250ms   | [S1,MB1,B]  310-27-337ms   | [S1,MB4,F]  342-20-362ms   | [S1,MB2,B]  426-27-454ms   | [S1,MB5,F]  458-20-479ms   | [S1,MB3,B]  543-27-571ms   | [S1,MB6,F]  575-20-596ms   | [S1,MB4,B]  661-27-689ms   | [S1,MB7,F]  693-20-714ms   | [S1,MB5,B]  778-27-806ms   | [S1,MB6,B]  891-27-918ms   | [S1,MB7,B]  1003-27-1031ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  165-22-187ms   | [S2,MB2,F]  195-15-210ms   | [S2,MB1,B]  278-22-300ms   | [S2,MB3,F]  307-15-323ms   | [S2,MB2,B]  393-22-416ms   | [S2,MB4,F]  423-15-438ms   | [S2,MB3,B]  511-22-533ms   | [S2,MB5,F]  540-15-555ms   | [S2,MB4,B]  628-22-651ms   | [S2,MB6,F]  658-15-673ms   | [S2,MB5,B]  746-22-768ms   | [S2,MB7,F]  775-15-791ms   | [S2,MB6,B]  862-22-884ms   | [S2,MB7,B]  974-22-996ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  88-67-155ms    | [S3,MB1,F]  162-24-187ms   | [S3,MB1,B]  199-69-269ms   | [S3,MB2,F]  275-25-300ms   | [S3,MB2,B]  313-70-384ms   | [S3,MB3,F]  390-26-417ms   | [S3,MB3,B]  430-70-501ms   | [S3,MB4,F]  508-26-534ms   | [S3,MB4,B]  547-71-618ms   | [S3,MB5,F]  625-26-652ms   | [S3,MB5,B]  664-71-736ms   | [S3,MB6,F]  743-26-769ms   | [S3,MB6,B]  781-71-852ms   | [S3,MB7,F]  859-26-886ms   | [S3,MB7,B]  897-70-968ms  
[rank0]:2025-12-29 02:22:18,731 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0222_rank0_stage0.svg
[rank0]:	> Counts Sum: 1251, Total Sum: 2035 (61.47%), Ratio(%) per element: [0.0, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:22:18,707 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0222_stage3_step600.svg
[rank2]:2025-12-29 02:22:18,731 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0222_rank2_stage2.svg
[rank2]:	> Counts Sum: 1323, Total Sum: 1980 (66.82%), Ratio(%) per element: [89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 02:22:18,730 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0222_rank1_stage1.svg
[rank1]:	> Counts Sum: 1692, Total Sum: 2475 (68.36%), Ratio(%) per element: [85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:22:18,837 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0222_rank3_stage3.svg
[rank3]:	> Counts Sum: 477, Total Sum: 1595 (29.91%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 02:23:01,200 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6969e-01
[rank2]:2025-12-29 02:23:01,185 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.6334e-01
[rank3]:2025-12-29 02:23:01,208 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2556e-01
[rank1]:2025-12-29 02:23:01,185 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1954e-01
[rank2]:2025-12-29 02:23:44,615 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4582e+00
[rank0]:2025-12-29 02:23:44,633 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3016e+00
[rank1]:2025-12-29 02:23:44,615 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9647e+00
[rank3]:2025-12-29 02:23:44,631 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6843e+00
[rank1]:2025-12-29 02:24:31,630 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.2166e-01
[rank2]:2025-12-29 02:24:31,629 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9286e-01
[rank3]:2025-12-29 02:24:31,653 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2944e-01
[rank0]:2025-12-29 02:24:31,645 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5231e+00
[rank0]:2025-12-29 02:25:14,961 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9134e+00
[rank1]:2025-12-29 02:25:14,945 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0877e+00
[rank3]:2025-12-29 02:25:14,960 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8264e-01
[rank2]:2025-12-29 02:25:14,945 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8388e-01
[rank1]:2025-12-29 02:26:01,670 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.5663e-01
[rank2]:2025-12-29 02:26:01,670 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1721e+00
[rank0]:2025-12-29 02:26:01,676 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 02:26:01,686 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4941e+00
[rank3]:2025-12-29 02:26:01,696 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0226e-01
[rank3]:2025-12-29 02:26:05,850 - Avg. fwd time: 25.4017 / Avg. bwd time: 76.1480 / Avg. batch time: 957.5985 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-29 02:26:05,882 - Avg. fwd time: 15.4466 / Avg. bwd time: 24.7005 / Avg. batch time: 1004.5012 (ms) / GPU bubble ratio: 68.03%
[rank3]:2025-12-29 02:26:05,981 -  step: 650  loss:  0.2425  grad_norm:  0.1163  memory: 25.79GiB(54.28%)  tps: 7,203  tflops: 56.31  mfu: 18.05%
[rank1]:2025-12-29 02:26:05,918 - Avg. fwd time: 20.2243 / Avg. bwd time: 31.3484 / Avg. batch time: 1062.3504 (ms) / GPU bubble ratio: 61.16%
[rank1]:2025-12-29 02:26:05,965 -  step: 650  loss: -4.0000  grad_norm:  0.1163  memory: 12.86GiB(27.07%)  tps: 7,203  tflops: 56.31  mfu: 18.05%
[rank2]:2025-12-29 02:26:05,965 -  step: 650  loss: -4.0000  grad_norm:  0.1163  memory:  8.66GiB(18.23%)  tps: 7,203  tflops: 56.31  mfu: 18.05%
[rank0]:2025-12-29 02:26:05,956 - Avg. fwd time: 16.6369 / Avg. bwd time: 31.3943 / Avg. batch time: 1116.9958 (ms) / GPU bubble ratio: 65.60%
[rank0]:2025-12-29 02:26:05,980 -  step: 650  loss: -4.0000  grad_norm:  0.1163  memory: 16.87GiB(35.50%)  tps: 7,203  tflops: 56.31  mfu: 18.05%
[rank0]:2025-12-29 02:26:44,785 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3314e+00
[rank1]:2025-12-29 02:26:44,767 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.1469e-01
[rank3]:2025-12-29 02:26:44,782 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.8099e-01
[rank2]:2025-12-29 02:26:44,767 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1635e+00
[rank2]:2025-12-29 02:27:31,411 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4530e-01
[rank0]:2025-12-29 02:27:31,430 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8914e-01
[rank1]:2025-12-29 02:27:31,411 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0150e-01
[rank3]:2025-12-29 02:27:31,434 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3407e-01
[rank0]:2025-12-29 02:28:14,715 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4117e+00
[rank3]:2025-12-29 02:28:14,712 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0357e+00
[rank1]:2025-12-29 02:28:14,696 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1169e+00
[rank2]:2025-12-29 02:28:14,696 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1842e+00
[rank1]:2025-12-29 02:29:01,603 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3464e+00
[rank2]:2025-12-29 02:29:01,602 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6456e-01
[rank0]:2025-12-29 02:29:01,621 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1162e+00
[rank3]:2025-12-29 02:29:01,625 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3746e-01
[rank2]:2025-12-29 02:29:44,802 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6736e+00
[rank0]:2025-12-29 02:29:44,799 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 02:29:44,818 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5463e+00
[rank1]:2025-12-29 02:29:44,802 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2265e+00
[rank3]:2025-12-29 02:29:44,818 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5877e+00
[rank3]:2025-12-29 02:29:49,359 - Avg. fwd time: 25.4108 / Avg. bwd time: 76.0225 / Avg. batch time: 956.6675 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-29 02:29:49,391 - Avg. fwd time: 15.4532 / Avg. bwd time: 24.5278 / Avg. batch time: 1003.3817 (ms) / GPU bubble ratio: 68.12%
[rank1]:2025-12-29 02:29:49,428 - Avg. fwd time: 20.2298 / Avg. bwd time: 31.0630 / Avg. batch time: 1060.9439 (ms) / GPU bubble ratio: 61.32%
[rank2]:2025-12-29 02:29:49,475 -  step: 700  loss: -4.0000  grad_norm:  0.2306  memory:  8.66GiB(18.23%)  tps: 7,330  tflops: 57.31  mfu: 18.37%
[rank0]:2025-12-29 02:29:49,466 - Avg. fwd time: 16.6417 / Avg. bwd time: 31.1733 / Avg. batch time: 1115.3593 (ms) / GPU bubble ratio: 65.70%
[rank0]:2025-12-29 02:29:49,491 -  step: 700  loss: -4.0000  grad_norm:  0.2306  memory: 16.87GiB(35.50%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank1]:2025-12-29 02:29:49,475 -  step: 700  loss: -4.0000  grad_norm:  0.2306  memory: 12.86GiB(27.07%)  tps: 7,330  tflops: 57.31  mfu: 18.37%
[rank1]:2025-12-29 02:29:49,555 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0229_stage1_step700.svg
[rank3]:2025-12-29 02:29:49,498 -  step: 700  loss:  0.2068  grad_norm:  0.2306  memory: 25.79GiB(54.28%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank2]:2025-12-29 02:29:49,551 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0229_stage2_step700.svg
[rank0]:2025-12-29 02:29:49,552 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0229_stage0_step700.svg
[rank3]:2025-12-29 02:29:49,643 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0229_step700_rank3.svg
[rank3]:			> Batch Time: 1058.38 ms, GPU Bubble Ratio: 65.92%, 63.93%, 71.41%, 27.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  232-28-260ms   | [S0,MB4,F]  260-16-276ms   | [S0,MB1,B]  344-28-372ms   | [S0,MB5,F]  372-16-388ms   | [S0,MB2,B]  458-28-486ms   | [S0,MB6,F]  487-16-503ms   | [S0,MB3,B]  574-28-602ms   | [S0,MB7,F]  603-16-619ms   | [S0,MB4,B]  691-28-719ms   | [S0,MB5,B]  806-28-834ms   | [S0,MB6,B]  918-28-946ms   | [S0,MB7,B]  1030-28-1058ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-19-62ms     | [S1,MB2,F]  68-20-88ms     | [S1,MB0,B]  196-27-224ms   | [S1,MB3,F]  228-20-249ms   | [S1,MB1,B]  309-27-336ms   | [S1,MB4,F]  340-20-361ms   | [S1,MB2,B]  423-27-450ms   | [S1,MB5,F]  454-20-475ms   | [S1,MB3,B]  539-27-566ms   | [S1,MB6,F]  571-20-591ms   | [S1,MB4,B]  656-27-683ms   | [S1,MB7,F]  688-20-708ms   | [S1,MB5,B]  772-27-799ms   | [S1,MB6,B]  884-27-912ms   | [S1,MB7,B]  996-27-1023ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-77ms     | [S2,MB0,B]  164-22-186ms   | [S2,MB2,F]  193-15-209ms   | [S2,MB1,B]  276-22-298ms   | [S2,MB3,F]  305-15-321ms   | [S2,MB2,B]  390-22-412ms   | [S2,MB4,F]  419-15-435ms   | [S2,MB3,B]  506-22-528ms   | [S2,MB5,F]  536-15-551ms   | [S2,MB4,B]  623-22-645ms   | [S2,MB6,F]  652-15-668ms   | [S2,MB5,B]  739-22-761ms   | [S2,MB7,F]  769-15-784ms   | [S2,MB6,B]  856-22-878ms   | [S2,MB7,B]  967-22-989ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-66-154ms    | [S3,MB1,F]  161-24-186ms   | [S3,MB1,B]  198-69-267ms   | [S3,MB2,F]  273-25-299ms   | [S3,MB2,B]  311-70-382ms   | [S3,MB3,F]  387-26-413ms   | [S3,MB3,B]  426-70-497ms   | [S3,MB4,F]  503-26-529ms   | [S3,MB4,B]  541-70-612ms   | [S3,MB5,F]  620-26-646ms   | [S3,MB5,B]  659-70-729ms   | [S3,MB6,F]  736-26-762ms   | [S3,MB6,B]  775-71-846ms   | [S3,MB7,F]  852-26-878ms   | [S3,MB7,B]  891-70-962ms  
[rank2]:2025-12-29 02:29:49,699 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0229_rank2_stage2.svg
[rank2]:	> Counts Sum: 1593, Total Sum: 2340 (68.08%), Ratio(%) per element: [90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 02:29:49,705 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0229_rank0_stage0.svg
[rank0]:	> Counts Sum: 1521, Total Sum: 2405 (63.24%), Ratio(%) per element: [0.0, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 02:29:49,702 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0229_rank1_stage1.svg
[rank1]:	> Counts Sum: 2052, Total Sum: 2925 (70.15%), Ratio(%) per element: [87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:29:49,690 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0229_stage3_step700.svg
[rank3]:2025-12-29 02:29:49,831 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0229_rank3_stage3.svg
[rank3]:	> Counts Sum: 567, Total Sum: 1885 (30.08%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 02:30:31,893 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3483e-01
[rank1]:2025-12-29 02:30:31,875 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7042e-01
[rank3]:2025-12-29 02:30:31,898 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6214e-01
[rank2]:2025-12-29 02:30:31,874 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1883e-01
[rank2]:2025-12-29 02:31:15,224 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0118e+00
[rank0]:2025-12-29 02:31:15,242 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8692e-01
[rank1]:2025-12-29 02:31:15,224 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.2553e-01
[rank3]:2025-12-29 02:31:15,239 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7104e-01
[rank1]:2025-12-29 02:32:02,126 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.3007e-01
[rank3]:2025-12-29 02:32:02,149 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1553e-01
[rank2]:2025-12-29 02:32:02,126 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0577e+00
[rank0]:2025-12-29 02:32:02,144 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4351e-01
[rank1]:2025-12-29 02:32:45,377 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.8621e-01
[rank3]:2025-12-29 02:32:45,393 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.2920e-01
[rank2]:2025-12-29 02:32:45,377 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0037e+00
[rank0]:2025-12-29 02:32:45,394 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0715e+00
[rank1]:2025-12-29 02:33:32,238 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6939e-01
[rank3]:2025-12-29 02:33:32,262 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8631e-01
[rank2]:2025-12-29 02:33:32,238 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0730e-01
[rank0]:2025-12-29 02:33:32,244 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-29 02:33:32,257 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5805e-01
[rank3]:2025-12-29 02:33:36,530 - Avg. fwd time: 25.4139 / Avg. bwd time: 76.0623 / Avg. batch time: 957.0086 (ms) / GPU bubble ratio: 15.17%
[rank2]:2025-12-29 02:33:36,562 - Avg. fwd time: 15.4611 / Avg. bwd time: 24.3791 / Avg. batch time: 1003.5845 (ms) / GPU bubble ratio: 68.24%
[rank0]:2025-12-29 02:33:36,638 - Avg. fwd time: 16.6494 / Avg. bwd time: 30.9838 / Avg. batch time: 1115.1203 (ms) / GPU bubble ratio: 65.83%
[rank1]:2025-12-29 02:33:36,600 - Avg. fwd time: 20.2358 / Avg. bwd time: 30.8172 / Avg. batch time: 1060.8992 (ms) / GPU bubble ratio: 61.50%
[rank1]:2025-12-29 02:33:36,647 -  step: 750  loss: -4.0000  grad_norm:  0.1440  memory: 12.86GiB(27.07%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank3]:2025-12-29 02:33:36,663 -  step: 750  loss:  0.2541  grad_norm:  0.1440  memory: 25.79GiB(54.28%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank2]:2025-12-29 02:33:36,647 -  step: 750  loss: -4.0000  grad_norm:  0.1440  memory:  8.66GiB(18.23%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank0]:2025-12-29 02:33:36,662 -  step: 750  loss: -4.0000  grad_norm:  0.1440  memory: 16.87GiB(35.50%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank1]:2025-12-29 02:34:15,684 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1376e+00
[rank3]:2025-12-29 02:34:15,699 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2186e+00
[rank2]:2025-12-29 02:34:15,684 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2847e-01
[rank0]:2025-12-29 02:34:15,702 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3265e-01
[rank2]:2025-12-29 02:35:02,604 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4257e+00
[rank0]:2025-12-29 02:35:02,619 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4495e+00
[rank1]:2025-12-29 02:35:02,604 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8721e+00
[rank3]:2025-12-29 02:35:02,627 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4000e-01
[rank2]:2025-12-29 02:35:45,974 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5081e+00
[rank0]:2025-12-29 02:35:45,991 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2208e+00
[rank1]:2025-12-29 02:35:45,974 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6526e+00
[rank3]:2025-12-29 02:35:45,990 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8547e+00
[rank2]:2025-12-29 02:36:32,832 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7073e-01
[rank0]:2025-12-29 02:36:32,848 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7902e-01
[rank1]:2025-12-29 02:36:32,832 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8976e-01
[rank3]:2025-12-29 02:36:32,855 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0239e-01
[rank2]:2025-12-29 02:37:16,287 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5459e-01
[rank0]:2025-12-29 02:37:16,283 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-29 02:37:16,304 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8157e-01
[rank1]:2025-12-29 02:37:16,287 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4460e-01
[rank3]:2025-12-29 02:37:16,302 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1229e-01
[rank3]:2025-12-29 02:37:20,970 - Avg. fwd time: 25.4295 / Avg. bwd time: 75.9860 / Avg. batch time: 956.5235 (ms) / GPU bubble ratio: 15.18%
[rank2]:2025-12-29 02:37:21,003 - Avg. fwd time: 15.4683 / Avg. bwd time: 24.2493 / Avg. batch time: 1002.9565 (ms) / GPU bubble ratio: 68.32%
[rank1]:2025-12-29 02:37:21,041 - Avg. fwd time: 20.2413 / Avg. bwd time: 30.6026 / Avg. batch time: 1060.0551 (ms) / GPU bubble ratio: 61.63%
[rank2]:2025-12-29 02:37:21,089 -  step: 800  loss: -4.0000  grad_norm:  0.6438  memory:  8.66GiB(18.23%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank2]:2025-12-29 02:37:21,089 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.6438  tps: 7,637  tflops: 59.70  mfu: 17.49%
[rank2]:2025-12-29 02:37:21,089 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-29 02:37:21,089 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-29 02:37:21,080 - Avg. fwd time: 16.6551 / Avg. bwd time: 30.8182 / Avg. batch time: 1114.1049 (ms) / GPU bubble ratio: 65.91%
[rank0]:2025-12-29 02:37:21,103 -  step: 800  loss: -4.0000  grad_norm:  0.6438  memory: 16.87GiB(35.50%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank0]:2025-12-29 02:37:21,103 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.6438  tps: 7,636  tflops: 59.69  mfu: 17.46%
[rank0]:2025-12-29 02:37:21,103 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-29 02:37:21,104 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-29 02:37:21,089 -  step: 800  loss: -4.0000  grad_norm:  0.6438  memory: 12.86GiB(27.07%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank1]:2025-12-29 02:37:21,089 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.6438  tps: 7,636  tflops: 59.70  mfu: 17.46%
[rank1]:2025-12-29 02:37:21,089 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-29 02:37:21,090 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-29 02:37:21,111 -  step: 800  loss:  0.2547  grad_norm:  0.6438  memory: 25.79GiB(54.28%)  tps: 7,300  tflops: 57.07  mfu: 18.29%
[rank3]:2025-12-29 02:37:21,112 - â„¹ï¸ final step: 800  loss:  0.2547  grad_norm:  0.6438  tps: 7,640  tflops: 59.73  mfu: 17.59%
[rank3]:2025-12-29 02:37:21,112 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-29 02:37:21,113 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-29 02:37:23,154 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-29 02:37:23,225 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank0/251229_0237_stage0_final800.svg
[rank1]:2025-12-29 02:37:23,229 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank1/251229_0237_stage1_final800.svg
[rank2]:2025-12-29 02:37:23,221 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank2/251229_0237_stage2_final800.svg
[rank3]:2025-12-29 02:37:23,311 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0237_final800_rank3.svg
[rank3]:			> Batch Time: 1131.42 ms, GPU Bubble Ratio: 68.08%, 66.27%, 73.26%, 27.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-33ms     | [S0,MB2,F]  33-17-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB0,B]  238-28-267ms   | [S0,MB4,F]  266-16-282ms   | [S0,MB1,B]  360-28-389ms   | [S0,MB5,F]  390-16-406ms   | [S0,MB2,B]  484-28-512ms   | [S0,MB6,F]  515-16-531ms   | [S0,MB3,B]  610-28-638ms   | [S0,MB7,F]  640-16-656ms   | [S0,MB4,B]  736-28-764ms   | [S0,MB5,B]  859-28-888ms   | [S0,MB6,B]  981-28-1009ms  | [S0,MB7,B]  1103-28-1131ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  43-19-62ms     | [S1,MB2,F]  69-19-88ms     | [S1,MB0,B]  201-27-229ms   | [S1,MB3,F]  235-20-255ms   | [S1,MB1,B]  323-27-350ms   | [S1,MB4,F]  357-20-377ms   | [S1,MB2,B]  448-27-475ms   | [S1,MB5,F]  481-20-501ms   | [S1,MB3,B]  573-27-601ms   | [S1,MB6,F]  606-20-627ms   | [S1,MB4,B]  699-27-726ms   | [S1,MB7,F]  732-20-753ms   | [S1,MB5,B]  825-27-852ms   | [S1,MB6,B]  946-27-974ms   | [S1,MB7,B]  1068-27-1096ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  168-22-191ms   | [S2,MB2,F]  198-15-213ms   | [S2,MB1,B]  289-22-311ms   | [S2,MB3,F]  320-15-335ms   | [S2,MB2,B]  414-22-436ms   | [S2,MB4,F]  445-15-461ms   | [S2,MB3,B]  539-22-561ms   | [S2,MB5,F]  570-15-586ms   | [S2,MB4,B]  664-22-687ms   | [S2,MB6,F]  696-15-712ms   | [S2,MB5,B]  790-22-812ms   | [S2,MB7,F]  822-15-837ms   | [S2,MB6,B]  915-22-938ms   | [S2,MB7,B]  1036-22-1059ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-76ms     | [S3,MB0,B]  87-70-158ms    | [S3,MB1,F]  165-24-189ms   | [S3,MB1,B]  201-74-276ms   | [S3,MB2,F]  286-25-311ms   | [S3,MB2,B]  323-75-398ms   | [S3,MB3,F]  411-25-437ms   | [S3,MB3,B]  447-77-524ms   | [S3,MB4,F]  536-25-562ms   | [S3,MB4,B]  573-78-651ms   | [S3,MB5,F]  661-25-687ms   | [S3,MB5,B]  698-80-779ms   | [S3,MB6,F]  787-25-813ms   | [S3,MB6,B]  823-80-904ms   | [S3,MB7,F]  912-25-938ms   | [S3,MB7,B]  949-80-1029ms 
[rank2]:2025-12-29 02:37:23,366 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0237_rank2_stage2.svg
[rank2]:	> Counts Sum: 1863, Total Sum: 2700 (69.00%), Ratio(%) per element: [92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-29 02:37:23,366 - Destroying the purge thread.
[rank0]:2025-12-29 02:37:23,379 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0237_rank0_stage0.svg
[rank0]:	> Counts Sum: 1791, Total Sum: 2775 (64.54%), Ratio(%) per element: [0.0, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-29 02:37:23,379 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-29 02:37:23,386 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0237_rank1_stage1.svg
[rank1]:	> Counts Sum: 2412, Total Sum: 3375 (71.47%), Ratio(%) per element: [89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-29 02:37:23,386 - Destroying the purge thread.
[rank3]:2025-12-29 02:37:23,449 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/pipeline_schedule/251229_0237_thry_final800_rank3.svg
[rank3]:			> Batch Time: 641.72 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-38ms     | [S0,MB2,F]  38-19-58ms     | [S0,MB3,F]  58-19-77ms     | [S0,MB0,B]  194-38-233ms   | [S0,MB4,F]  233-19-252ms   | [S0,MB1,B]  252-38-291ms   | [S0,MB5,F]  291-19-311ms   | [S0,MB2,B]  311-38-350ms   | [S0,MB6,F]  350-19-369ms   | [S0,MB3,B]  369-38-408ms   | [S0,MB7,F]  408-19-427ms   | [S0,MB4,B]  427-38-466ms   | [S0,MB5,B]  486-38-525ms   | [S0,MB6,B]  544-38-583ms   | [S0,MB7,B]  602-38-641ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-77ms     | [S1,MB0,B]  155-38-194ms   | [S1,MB3,F]  194-19-213ms   | [S1,MB1,B]  213-38-252ms   | [S1,MB4,F]  252-19-272ms   | [S1,MB2,B]  272-38-311ms   | [S1,MB5,F]  311-19-330ms   | [S1,MB3,B]  330-38-369ms   | [S1,MB6,F]  369-19-388ms   | [S1,MB4,B]  388-38-427ms   | [S1,MB7,F]  427-19-447ms   | [S1,MB5,B]  447-38-486ms   | [S1,MB6,B]  505-38-544ms   | [S1,MB7,B]  563-38-602ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-19-58ms     | [S2,MB1,F]  58-19-77ms     | [S2,MB0,B]  116-38-155ms   | [S2,MB2,F]  155-19-175ms   | [S2,MB1,B]  175-38-213ms   | [S2,MB3,F]  213-19-233ms   | [S2,MB2,B]  233-38-272ms   | [S2,MB4,F]  272-19-291ms   | [S2,MB3,B]  291-38-330ms   | [S2,MB5,F]  330-19-350ms   | [S2,MB4,B]  350-38-388ms   | [S2,MB6,F]  388-19-408ms   | [S2,MB5,B]  408-38-447ms   | [S2,MB7,F]  447-19-466ms   | [S2,MB6,B]  466-38-505ms   | [S2,MB7,B]  525-38-563ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  58-19-77ms     | [S3,MB0,B]  77-38-116ms    | [S3,MB1,F]  116-19-136ms   | [S3,MB1,B]  136-38-175ms   | [S3,MB2,F]  175-19-194ms   | [S3,MB2,B]  194-38-233ms   | [S3,MB3,F]  233-19-252ms   | [S3,MB3,B]  252-38-291ms   | [S3,MB4,F]  291-19-311ms   | [S3,MB4,B]  311-38-350ms   | [S3,MB5,F]  350-19-369ms   | [S3,MB5,B]  369-38-408ms   | [S3,MB6,F]  408-19-427ms   | [S3,MB6,B]  427-38-466ms   | [S3,MB7,F]  466-19-486ms   | [S3,MB7,B]  486-38-525ms  
[rank3]:2025-12-29 02:37:23,497 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_ratio_history/rank3/251229_0237_stage3_final800.svg
[rank1]:2025-12-29 02:37:23,535 - Process group destroyed
[rank2]:2025-12-29 02:37:23,527 - Process group destroyed
[rank3]:2025-12-29 02:37:23,631 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1/frozen_params_histogram/251229_0237_rank3_stage3.svg
[rank3]:	> Counts Sum: 657, Total Sum: 2175 (30.21%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-29 02:37:23,632 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 354-374
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.2888
[rank3]:wandb:               final/avg_loss 0.25474
[rank3]:wandb:             final/avg_mfu(%) 17.58959
[rank3]:wandb:             final/avg_tflops 59.72881
[rank3]:wandb:    final/avg_throughput(tps) 7640.35915
[rank3]:wandb:              final/grad_norm 0.64376
[rank3]:wandb:               final/max_loss 0.25474
[rank3]:wandb:                    grad_norm 0.64376
[rank3]:wandb: loss_metrics/global_avg_loss 0.25474
[rank3]:wandb: loss_metrics/global_max_loss 0.25474
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_1F1B_auto_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ien1lbnm
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_1F1B_auto_11_dm1/20251229-0136/wandb/run-20251229_013634-ien1lbnm/logs
[rank3]:2025-12-29 02:37:25,094 - Process group destroyed
[rank0]:2025-12-29 02:37:25,379 - Training completed
[rank0]:2025-12-29 02:37:25,380 - Destroying the purge thread.
[rank0]:2025-12-29 02:37:25,597 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.2', 'layers.0', 'tok_embeddings', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.8', 'layers.4', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'norm', 'output', 'layers.13', 'layers.15', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_1F1B_auto_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_1F1B_auto_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_1F1B_auto_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_1F1B_auto_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_1F1B_auto_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_1F1B_auto_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_1F1B_auto_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_1F1B_auto_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
