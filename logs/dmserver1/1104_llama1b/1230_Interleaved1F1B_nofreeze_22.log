
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 04:10:34 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_Interleaved1F1B_nofreeze_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-31 04:10:40,739 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank3]:2025-12-31 04:10:40,731 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank2]:2025-12-31 04:10:40,874 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank0]:2025-12-31 04:10:40,849 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank1]:2025-12-31 04:10:40,935 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 04:10:40,938 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-31 04:10:40,955 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 04:10:40,957 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 04:10:41,130 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 04:10:41,133 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 04:10:41,137 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 04:10:41,138 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-31 04:10:41,142 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 04:10:41,144 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 04:10:41,535 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-31 04:10:44,245 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 04:10:44,285 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 04:10:44,310 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-31 04:10:44,322 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-31 04:10:44,323 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-31 04:10:44,258 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-31 04:10:44,404 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 04:10:44,414 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 04:10:44,446 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 04:10:44,481 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-31 04:10:44,496 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-31 04:10:44,498 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-31 04:10:44,511 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 04:10:44,512 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 04:10:44,512 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-31 04:10:44,457 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 04:10:44,459 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 04:10:44,485 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-31 04:10:44,498 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-31 04:10:44,499 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-31 04:10:44,701 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 04:10:44,701 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 04:10:44,702 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-31 04:10:44,720 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 04:10:44,720 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 04:10:44,721 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run wgjopf13
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_nofreeze_22_dm1/20251231-0410/wandb/run-20251231_041045-wgjopf13
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/wgjopf13
[rank3]:2025-12-31 04:10:46,511 - WandB logging enabled
[rank3]:2025-12-31 04:10:46,511 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 04:10:46,550 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 04:10:46,580 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-31 04:10:46,593 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-31 04:10:46,594 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-31 04:10:46,801 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 04:10:46,800 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_Interleaved1F1B_nofreeze_22_dm1
[rank0]:2025-12-31 04:10:46,801 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 04:10:46,801 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 04:10:46,801 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-31 04:10:46,800 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-31 04:10:46,783 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 04:10:46,783 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 04:10:46,784 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-31 04:10:46,800 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 04:10:49,261 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 04:10:49,261 - Finished loading the checkpoint in 2.46 seconds.
[rank0]:2025-12-31 04:10:49,261 - Training starts at step 1
[rank2]:2025-12-31 04:10:54,817 -  step:  1  loss: -4.0000  grad_norm: 203.0659  memory: 10.24GiB(21.56%)  tps: 3,160  tflops: 24.70  mfu: 7.92%
[rank2]:2025-12-31 04:10:54,817 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 04:10:54,852 -  step:  1  loss: -4.0000  grad_norm: 203.0659  memory: 16.58GiB(34.89%)  tps: 3,152  tflops: 24.64  mfu: 7.90%
[rank0]:2025-12-31 04:10:54,853 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-31 04:10:54,821 -  step:  1  loss: -4.0000  grad_norm: 203.0659  memory: 16.23GiB(34.16%)  tps: 3,110  tflops: 24.31  mfu: 7.79%
[rank1]:2025-12-31 04:10:54,821 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 04:10:54,829 -  step:  1  loss: 10.6092  grad_norm: 203.0659  memory: 25.52GiB(53.71%)  tps: 3,959  tflops: 30.95  mfu: 9.92%
[rank3]:2025-12-31 04:10:54,829 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 04:14:59,561 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:15:04,499 - Avg. fwd time: 14.2619 / Avg. bwd time: 40.2894 / Avg. batch time: 1087.8925 (ms) / GPU bubble ratio: 19.77%
[rank2]:2025-12-31 04:15:04,548 - Avg. fwd time: 7.7594 / Avg. bwd time: 18.7235 / Avg. batch time: 1148.6995 (ms) / GPU bubble ratio: 63.11%
[rank0]:2025-12-31 04:15:04,622 - Avg. fwd time: 8.3166 / Avg. bwd time: 21.2110 / Avg. batch time: 1246.4405 (ms) / GPU bubble ratio: 62.10%
[rank0]:2025-12-31 04:15:04,657 -  step: 50  loss: -4.0000  grad_norm: 24.1696  memory: 20.42GiB(42.99%)  tps: 6,428  tflops: 50.25  mfu: 16.11%
[rank1]:2025-12-31 04:15:04,589 - Avg. fwd time: 9.7862 / Avg. bwd time: 23.9702 / Avg. batch time: 1207.6553 (ms) / GPU bubble ratio: 55.28%
[rank1]:2025-12-31 04:15:04,647 -  step: 50  loss: -4.0000  grad_norm: 24.1696  memory: 18.49GiB(38.93%)  tps: 6,427  tflops: 50.24  mfu: 16.10%
[rank2]:2025-12-31 04:15:04,643 -  step: 50  loss: -4.0000  grad_norm: 24.1696  memory: 12.06GiB(25.39%)  tps: 6,427  tflops: 50.24  mfu: 16.10%
[rank3]:2025-12-31 04:15:04,655 -  step: 50  loss:  9.8791  grad_norm: 24.1696  memory: 29.23GiB(61.52%)  tps: 6,427  tflops: 50.24  mfu: 16.10%
[rank0]:2025-12-31 04:19:14,618 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:19:19,538 - Avg. fwd time: 14.2745 / Avg. bwd time: 40.3460 / Avg. batch time: 1088.9005 (ms) / GPU bubble ratio: 19.74%
[rank2]:2025-12-31 04:19:19,588 - Avg. fwd time: 7.7506 / Avg. bwd time: 18.7667 / Avg. batch time: 1149.6010 (ms) / GPU bubble ratio: 63.09%
[rank2]:2025-12-31 04:19:19,684 -  step: 100  loss: -4.0000  grad_norm: 15.8166  memory: 12.06GiB(25.39%)  tps: 6,424  tflops: 50.22  mfu: 16.10%
[rank0]:2025-12-31 04:19:19,662 - Avg. fwd time: 8.3123 / Avg. bwd time: 21.2497 / Avg. batch time: 1247.4213 (ms) / GPU bubble ratio: 62.08%
[rank0]:2025-12-31 04:19:19,698 -  step: 100  loss: -4.0000  grad_norm: 15.8166  memory: 20.42GiB(42.99%)  tps: 6,424  tflops: 50.22  mfu: 16.10%
[rank1]:2025-12-31 04:19:19,629 - Avg. fwd time: 9.7835 / Avg. bwd time: 24.0019 / Avg. batch time: 1208.5778 (ms) / GPU bubble ratio: 55.27%
[rank1]:2025-12-31 04:19:19,687 -  step: 100  loss: -4.0000  grad_norm: 15.8166  memory: 18.49GiB(38.93%)  tps: 6,424  tflops: 50.22  mfu: 16.10%
[rank3]:2025-12-31 04:19:19,696 -  step: 100  loss:  8.2079  grad_norm: 15.8166  memory: 29.23GiB(61.52%)  tps: 6,424  tflops: 50.22  mfu: 16.10%
[rank3]:2025-12-31 04:19:19,961 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0419_step100_rank3.svg
[rank3]:			> Batch Time: 1243.67 ms, GPU Bubble Ratio: 61.90%, 56.50%, 65.84%, 29.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-94ms      | [S4,MB2,F]  123-8-131ms    | [S4,MB3,F]  160-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-193ms    | [S4,MB0,B]  370-19-389ms   | [S0,MB7,F]  388-7-396ms    | [S4,MB1,B]  488-19-507ms   | [S4,MB4,F]  550-8-558ms    | [S4,MB2,B]  558-19-577ms   | [S4,MB5,F]  586-8-594ms    | [S4,MB3,B]  595-19-614ms   | [S4,MB6,F]  620-8-629ms    | [S0,MB0,B]  630-25-655ms   | [S4,MB7,F]  655-7-663ms    | [S0,MB1,B]  667-24-691ms   | [S0,MB2,B]  709-23-732ms   | [S0,MB3,B]  769-23-792ms   | [S4,MB4,B]  805-18-823ms   | [S4,MB5,B]  892-18-910ms   | [S4,MB6,B]  980-18-998ms   | [S4,MB7,B]  1069-18-1087ms | [S0,MB4,B]  1105-23-1128ms | [S0,MB5,B]  1147-23-1170ms | [S0,MB6,B]  1182-23-1205ms | [S0,MB7,B]  1220-23-1243ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  273-7-280ms    | [S1,MB4,F]  302-10-313ms   | [S5,MB0,B]  313-18-331ms   | [S1,MB5,F]  363-12-375ms   | [S5,MB1,B]  377-18-396ms   | [S1,MB6,F]  396-11-407ms   | [S5,MB2,B]  488-18-507ms   | [S1,MB7,F]  507-11-518ms   | [S5,MB3,B]  558-19-577ms   | [S5,MB4,F]  577-7-585ms    | [S1,MB0,B]  594-28-623ms   | [S5,MB5,F]  621-9-630ms    | [S1,MB1,B]  631-29-661ms   | [S5,MB6,F]  660-10-670ms   | [S1,MB2,B]  670-32-702ms   | [S5,MB7,F]  702-10-712ms   | [S1,MB3,B]  713-33-746ms   | [S5,MB4,B]  781-18-799ms   | [S5,MB5,B]  868-17-885ms   | [S5,MB6,B]  955-17-973ms   | [S5,MB7,B]  1044-17-1062ms | [S1,MB4,B]  1071-27-1098ms | [S1,MB5,B]  1113-27-1140ms | [S1,MB6,B]  1146-28-1174ms | [S1,MB7,B]  1181-30-1211ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-103ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  266-6-273ms    | [S6,MB0,B]  273-19-292ms   | [S6,MB3,F]  292-8-301ms    | [S6,MB1,B]  350-20-371ms   | [S2,MB4,F]  370-8-379ms    | [S6,MB2,B]  440-19-459ms   | [S2,MB5,F]  460-7-467ms    | [S6,MB3,B]  531-19-550ms   | [S2,MB6,F]  550-8-559ms    | [S2,MB0,B]  566-19-586ms   | [S2,MB7,F]  584-8-593ms    | [S2,MB1,B]  601-19-620ms   | [S6,MB4,F]  620-8-629ms    | [S2,MB2,B]  635-19-655ms   | [S6,MB5,F]  655-7-662ms    | [S2,MB3,B]  670-19-689ms   | [S6,MB6,F]  690-7-697ms    | [S6,MB4,B]  754-20-774ms   | [S6,MB7,F]  774-8-782ms    | [S6,MB5,B]  843-18-861ms   | [S6,MB6,B]  931-17-949ms   | [S6,MB7,B]  1021-17-1038ms | [S2,MB4,B]  1047-17-1065ms | [S2,MB5,B]  1088-17-1106ms | [S2,MB6,B]  1112-17-1130ms | [S2,MB7,B]  1146-17-1164ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  103-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,B]  204-53-257ms   | [S7,MB1,F]  257-18-276ms   | [S7,MB1,B]  287-56-344ms   | [S7,MB2,F]  344-20-365ms   | [S7,MB2,B]  376-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  467-57-524ms   | [S3,MB4,F]  524-11-536ms   | [S3,MB0,B]  535-24-560ms   | [S3,MB5,F]  559-10-570ms   | [S3,MB1,B]  570-23-594ms   | [S3,MB6,F]  594-10-604ms   | [S3,MB2,B]  605-23-628ms   | [S3,MB7,F]  628-10-638ms   | [S3,MB3,B]  638-22-661ms   | [S7,MB4,F]  661-18-679ms   | [S7,MB4,B]  691-55-747ms   | [S7,MB5,F]  747-21-768ms   | [S7,MB5,B]  779-57-836ms   | [S7,MB6,F]  837-21-858ms   | [S7,MB6,B]  869-57-926ms   | [S7,MB7,F]  925-20-946ms   | [S7,MB7,B]  956-57-1014ms  | [S3,MB4,B]  1013-25-1039ms | [S3,MB5,B]  1039-24-1064ms | [S3,MB6,B]  1064-24-1089ms | [S3,MB7,B]  1088-23-1112ms
[rank0]:2025-12-31 04:23:30,022 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:23:35,014 - Avg. fwd time: 14.2889 / Avg. bwd time: 40.3719 / Avg. batch time: 1089.4861 (ms) / GPU bubble ratio: 19.73%
[rank2]:2025-12-31 04:23:35,064 - Avg. fwd time: 7.7432 / Avg. bwd time: 18.7814 / Avg. batch time: 1150.5273 (ms) / GPU bubble ratio: 63.11%
[rank1]:2025-12-31 04:23:35,111 - Avg. fwd time: 9.7813 / Avg. bwd time: 24.0251 / Avg. batch time: 1209.6282 (ms) / GPU bubble ratio: 55.28%
[rank0]:2025-12-31 04:23:35,144 - Avg. fwd time: 8.3089 / Avg. bwd time: 21.2588 / Avg. batch time: 1248.4800 (ms) / GPU bubble ratio: 62.11%
[rank2]:2025-12-31 04:23:35,165 -  step: 150  loss: -4.0000  grad_norm: 24.6763  memory: 12.06GiB(25.39%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank1]:2025-12-31 04:23:35,169 -  step: 150  loss: -4.0000  grad_norm: 24.6763  memory: 18.49GiB(38.93%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank0]:2025-12-31 04:23:35,179 -  step: 150  loss: -4.0000  grad_norm: 24.6763  memory: 20.42GiB(42.99%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank3]:2025-12-31 04:23:35,177 -  step: 150  loss:  3.3015  grad_norm: 24.6763  memory: 29.23GiB(61.52%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank0]:2025-12-31 04:27:45,626 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:27:50,652 - Avg. fwd time: 14.3042 / Avg. bwd time: 40.3995 / Avg. batch time: 1090.1434 (ms) / GPU bubble ratio: 19.71%
[rank2]:2025-12-31 04:27:50,702 - Avg. fwd time: 7.7396 / Avg. bwd time: 18.8102 / Avg. batch time: 1151.1336 (ms) / GPU bubble ratio: 63.10%
[rank1]:2025-12-31 04:27:50,751 - Avg. fwd time: 9.7825 / Avg. bwd time: 24.0666 / Avg. batch time: 1210.3255 (ms) / GPU bubble ratio: 55.25%
[rank2]:2025-12-31 04:27:50,806 -  step: 200  loss: -4.0000  grad_norm: 15.6106  memory: 12.06GiB(25.39%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-31 04:27:50,784 - Avg. fwd time: 8.3087 / Avg. bwd time: 21.2855 / Avg. batch time: 1249.2046 (ms) / GPU bubble ratio: 62.10%
[rank0]:2025-12-31 04:27:50,820 -  step: 200  loss: -4.0000  grad_norm: 15.6106  memory: 20.42GiB(42.99%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank1]:2025-12-31 04:27:50,809 -  step: 200  loss: -4.0000  grad_norm: 15.6106  memory: 18.49GiB(38.93%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank3]:2025-12-31 04:27:50,818 -  step: 200  loss:  1.0432  grad_norm: 15.6106  memory: 29.23GiB(61.52%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank3]:2025-12-31 04:27:51,067 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0427_step200_rank3.svg
[rank3]:			> Batch Time: 1252.75 ms, GPU Bubble Ratio: 62.03%, 56.30%, 65.90%, 29.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  178-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  369-19-388ms   | [S0,MB7,F]  388-7-395ms    | [S4,MB1,B]  488-19-507ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  587-8-596ms    | [S4,MB3,B]  596-19-615ms   | [S4,MB6,F]  622-8-630ms    | [S0,MB0,B]  632-25-657ms   | [S4,MB7,F]  659-7-666ms    | [S0,MB1,B]  670-24-695ms   | [S0,MB2,B]  713-23-736ms   | [S0,MB3,B]  771-23-795ms   | [S4,MB4,B]  809-18-827ms   | [S4,MB5,B]  896-18-914ms   | [S4,MB6,B]  985-18-1003ms  | [S4,MB7,B]  1076-18-1094ms | [S0,MB4,B]  1112-23-1135ms | [S0,MB5,B]  1155-23-1178ms | [S0,MB6,B]  1191-23-1214ms | [S0,MB7,B]  1229-23-1252ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  273-7-280ms    | [S1,MB4,F]  303-10-314ms   | [S5,MB0,B]  313-18-332ms   | [S1,MB5,F]  362-12-374ms   | [S5,MB1,B]  377-18-396ms   | [S1,MB6,F]  396-11-407ms   | [S5,MB2,B]  488-18-506ms   | [S1,MB7,F]  507-11-518ms   | [S5,MB3,B]  559-19-578ms   | [S5,MB4,F]  579-7-586ms    | [S1,MB0,B]  596-28-624ms   | [S5,MB5,F]  624-9-633ms    | [S1,MB1,B]  634-31-665ms   | [S5,MB6,F]  664-10-674ms   | [S1,MB2,B]  674-33-707ms   | [S5,MB7,F]  706-10-717ms   | [S1,MB3,B]  716-34-750ms   | [S5,MB4,B]  784-18-802ms   | [S5,MB5,B]  871-18-889ms   | [S5,MB6,B]  961-18-979ms   | [S5,MB7,B]  1051-18-1069ms | [S1,MB4,B]  1078-27-1105ms | [S1,MB5,B]  1120-27-1148ms | [S1,MB6,B]  1155-28-1184ms | [S1,MB7,B]  1190-31-1221ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  267-6-274ms    | [S6,MB0,B]  274-19-293ms   | [S6,MB3,F]  293-8-302ms    | [S6,MB1,B]  350-20-370ms   | [S2,MB4,F]  371-8-379ms    | [S6,MB2,B]  439-19-458ms   | [S2,MB5,F]  458-7-466ms    | [S6,MB3,B]  531-19-550ms   | [S2,MB6,F]  550-8-558ms    | [S2,MB0,B]  568-19-587ms   | [S2,MB7,F]  587-8-595ms    | [S2,MB1,B]  602-19-622ms   | [S6,MB4,F]  622-8-630ms    | [S2,MB2,B]  636-19-656ms   | [S6,MB5,F]  656-7-663ms    | [S2,MB3,B]  673-19-693ms   | [S6,MB6,F]  692-7-700ms    | [S6,MB4,B]  756-20-777ms   | [S6,MB7,F]  777-8-785ms    | [S6,MB5,B]  846-18-865ms   | [S6,MB6,B]  937-17-954ms   | [S6,MB7,B]  1027-17-1045ms | [S2,MB4,B]  1053-18-1071ms | [S2,MB5,B]  1096-17-1114ms | [S2,MB6,B]  1120-18-1138ms | [S2,MB7,B]  1155-18-1173ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,B]  204-53-257ms   | [S7,MB1,F]  257-18-276ms   | [S7,MB1,B]  287-56-343ms   | [S7,MB2,F]  343-20-364ms   | [S7,MB2,B]  376-57-433ms   | [S7,MB3,F]  433-21-454ms   | [S7,MB3,B]  466-57-524ms   | [S3,MB4,F]  524-11-536ms   | [S3,MB0,B]  536-24-560ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  572-24-596ms   | [S3,MB6,F]  595-10-606ms   | [S3,MB2,B]  606-23-629ms   | [S3,MB7,F]  629-10-640ms   | [S3,MB3,B]  640-22-663ms   | [S7,MB4,F]  663-18-682ms   | [S7,MB4,B]  693-56-750ms   | [S7,MB5,F]  749-21-771ms   | [S7,MB5,B]  782-57-840ms   | [S7,MB6,F]  840-21-861ms   | [S7,MB6,B]  873-57-931ms   | [S7,MB7,F]  930-21-952ms   | [S7,MB7,B]  962-57-1020ms  | [S3,MB4,B]  1020-25-1046ms | [S3,MB5,B]  1046-24-1071ms | [S3,MB6,B]  1070-24-1095ms | [S3,MB7,B]  1095-23-1119ms
[rank0]:2025-12-31 04:32:01,282 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:32:06,221 - Avg. fwd time: 14.3062 / Avg. bwd time: 40.3937 / Avg. batch time: 1090.0604 (ms) / GPU bubble ratio: 19.71%
[rank2]:2025-12-31 04:32:06,272 - Avg. fwd time: 7.7349 / Avg. bwd time: 18.8308 / Avg. batch time: 1151.2779 (ms) / GPU bubble ratio: 63.08%
[rank1]:2025-12-31 04:32:06,313 - Avg. fwd time: 9.7819 / Avg. bwd time: 24.1062 / Avg. batch time: 1210.6286 (ms) / GPU bubble ratio: 55.21%
[rank2]:2025-12-31 04:32:06,369 -  step: 250  loss: -4.0000  grad_norm:  3.5483  memory: 12.06GiB(25.39%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank0]:2025-12-31 04:32:06,347 - Avg. fwd time: 8.3070 / Avg. bwd time: 21.3016 / Avg. batch time: 1249.5247 (ms) / GPU bubble ratio: 62.09%
[rank0]:2025-12-31 04:32:06,383 -  step: 250  loss: -4.0000  grad_norm:  3.5483  memory: 20.42GiB(42.99%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank1]:2025-12-31 04:32:06,372 -  step: 250  loss: -4.0000  grad_norm:  3.5483  memory: 18.49GiB(38.93%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank3]:2025-12-31 04:32:06,381 -  step: 250  loss:  0.3627  grad_norm:  3.5483  memory: 29.23GiB(61.52%)  tps: 6,411  tflops: 50.12  mfu: 16.06%
[rank0]:2025-12-31 04:36:16,970 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:36:21,900 - Avg. fwd time: 14.3123 / Avg. bwd time: 40.4026 / Avg. batch time: 1090.2621 (ms) / GPU bubble ratio: 19.70%
[rank2]:2025-12-31 04:36:21,949 - Avg. fwd time: 7.7328 / Avg. bwd time: 18.8483 / Avg. batch time: 1151.4488 (ms) / GPU bubble ratio: 63.06%
[rank1]:2025-12-31 04:36:21,992 - Avg. fwd time: 9.7855 / Avg. bwd time: 24.1464 / Avg. batch time: 1210.9257 (ms) / GPU bubble ratio: 55.17%
[rank0]:2025-12-31 04:36:22,028 - Avg. fwd time: 8.3070 / Avg. bwd time: 21.3167 / Avg. batch time: 1249.8395 (ms) / GPU bubble ratio: 62.08%
[rank0]:2025-12-31 04:36:22,064 -  step: 300  loss: -4.0000  grad_norm:  0.5677  memory: 20.42GiB(42.99%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank3]:2025-12-31 04:36:22,062 -  step: 300  loss:  0.2653  grad_norm:  0.5677  memory: 29.23GiB(61.52%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank2]:2025-12-31 04:36:22,050 -  step: 300  loss: -4.0000  grad_norm:  0.5677  memory: 12.06GiB(25.39%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank1]:2025-12-31 04:36:22,053 -  step: 300  loss: -4.0000  grad_norm:  0.5677  memory: 18.49GiB(38.93%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank3]:2025-12-31 04:36:22,312 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0436_step300_rank3.svg
[rank3]:			> Batch Time: 1249.73 ms, GPU Bubble Ratio: 61.90%, 56.31%, 65.81%, 29.62%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  86-8-94ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  160-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-193ms    | [S4,MB0,B]  369-19-389ms   | [S0,MB7,F]  389-7-396ms    | [S4,MB1,B]  489-19-508ms   | [S4,MB4,F]  550-8-558ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  585-8-594ms    | [S4,MB3,B]  594-19-614ms   | [S4,MB6,F]  620-8-629ms    | [S0,MB0,B]  630-25-655ms   | [S4,MB7,F]  657-7-665ms    | [S0,MB1,B]  668-24-693ms   | [S0,MB2,B]  711-23-735ms   | [S0,MB3,B]  770-23-793ms   | [S4,MB4,B]  808-18-826ms   | [S4,MB5,B]  892-18-910ms   | [S4,MB6,B]  983-18-1001ms  | [S4,MB7,B]  1073-18-1091ms | [S0,MB4,B]  1108-23-1131ms | [S0,MB5,B]  1152-23-1175ms | [S0,MB6,B]  1189-23-1212ms | [S0,MB7,B]  1226-23-1249ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  273-7-280ms    | [S1,MB4,F]  302-10-313ms   | [S5,MB0,B]  313-18-332ms   | [S1,MB5,F]  363-12-375ms   | [S5,MB1,B]  378-18-396ms   | [S1,MB6,F]  396-11-408ms   | [S5,MB2,B]  488-18-507ms   | [S1,MB7,F]  507-11-518ms   | [S5,MB3,B]  558-19-578ms   | [S5,MB4,F]  578-7-585ms    | [S1,MB0,B]  593-28-622ms   | [S5,MB5,F]  622-9-631ms    | [S1,MB1,B]  631-30-662ms   | [S5,MB6,F]  661-10-672ms   | [S1,MB2,B]  672-32-705ms   | [S5,MB7,F]  705-10-715ms   | [S1,MB3,B]  715-34-749ms   | [S5,MB4,B]  783-18-801ms   | [S5,MB5,B]  868-18-886ms   | [S5,MB6,B]  959-18-977ms   | [S5,MB7,B]  1048-18-1066ms | [S1,MB4,B]  1074-27-1102ms | [S1,MB5,B]  1117-27-1145ms | [S1,MB6,B]  1152-28-1181ms | [S1,MB7,B]  1188-30-1219ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  267-6-273ms    | [S6,MB0,B]  273-19-293ms   | [S6,MB3,F]  293-8-301ms    | [S6,MB1,B]  351-20-371ms   | [S2,MB4,F]  371-8-379ms    | [S6,MB2,B]  440-19-459ms   | [S2,MB5,F]  459-7-466ms    | [S6,MB3,B]  530-19-549ms   | [S2,MB6,F]  549-8-558ms    | [S2,MB0,B]  566-19-585ms   | [S2,MB7,F]  585-8-594ms    | [S2,MB1,B]  601-19-620ms   | [S6,MB4,F]  620-8-629ms    | [S2,MB2,B]  635-19-654ms   | [S6,MB5,F]  655-7-662ms    | [S2,MB3,B]  671-19-691ms   | [S6,MB6,F]  691-7-698ms    | [S6,MB4,B]  755-20-776ms   | [S6,MB7,F]  776-8-785ms    | [S6,MB5,B]  843-18-862ms   | [S6,MB6,B]  934-17-952ms   | [S6,MB7,B]  1024-17-1041ms | [S2,MB4,B]  1050-18-1068ms | [S2,MB5,B]  1092-17-1110ms | [S2,MB6,B]  1117-18-1135ms | [S2,MB7,B]  1151-18-1169ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,B]  204-53-257ms   | [S7,MB1,F]  257-18-276ms   | [S7,MB1,B]  287-56-344ms   | [S7,MB2,F]  344-20-365ms   | [S7,MB2,B]  376-57-434ms   | [S7,MB3,F]  433-21-455ms   | [S7,MB3,B]  467-57-524ms   | [S3,MB4,F]  524-11-536ms   | [S3,MB0,B]  534-24-559ms   | [S3,MB5,F]  559-10-570ms   | [S3,MB1,B]  570-23-594ms   | [S3,MB6,F]  594-10-604ms   | [S3,MB2,B]  605-23-628ms   | [S3,MB7,F]  628-10-639ms   | [S3,MB3,B]  639-22-662ms   | [S7,MB4,F]  662-18-681ms   | [S7,MB4,B]  692-56-748ms   | [S7,MB5,F]  749-21-770ms   | [S7,MB5,B]  780-57-838ms   | [S7,MB6,F]  837-21-858ms   | [S7,MB6,B]  870-57-928ms   | [S7,MB7,F]  927-21-949ms   | [S7,MB7,B]  960-57-1018ms  | [S3,MB4,B]  1016-25-1042ms | [S3,MB5,B]  1043-24-1068ms | [S3,MB6,B]  1068-24-1093ms | [S3,MB7,B]  1093-23-1117ms
[rank0]:2025-12-31 04:40:32,597 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:40:37,577 - Avg. fwd time: 14.3088 / Avg. bwd time: 40.4042 / Avg. batch time: 1090.2175 (ms) / GPU bubble ratio: 19.70%
[rank2]:2025-12-31 04:40:37,627 - Avg. fwd time: 7.7316 / Avg. bwd time: 18.8576 / Avg. batch time: 1151.5268 (ms) / GPU bubble ratio: 63.06%
[rank1]:2025-12-31 04:40:37,673 - Avg. fwd time: 9.7897 / Avg. bwd time: 24.1733 / Avg. batch time: 1211.0872 (ms) / GPU bubble ratio: 55.13%
[rank0]:2025-12-31 04:40:37,708 - Avg. fwd time: 8.3079 / Avg. bwd time: 21.3264 / Avg. batch time: 1250.0161 (ms) / GPU bubble ratio: 62.07%
[rank2]:2025-12-31 04:40:37,729 -  step: 350  loss: -4.0000  grad_norm:  0.2188  memory: 12.06GiB(25.39%)  tps: 6,408  tflops: 50.09  mfu: 16.06%
[rank1]:2025-12-31 04:40:37,733 -  step: 350  loss: -4.0000  grad_norm:  0.2188  memory: 18.49GiB(38.93%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-31 04:40:37,744 -  step: 350  loss: -4.0000  grad_norm:  0.2188  memory: 20.42GiB(42.99%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank3]:2025-12-31 04:40:37,742 -  step: 350  loss:  0.2144  grad_norm:  0.2188  memory: 29.23GiB(61.52%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-31 04:44:47,469 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:44:52,461 - Avg. fwd time: 14.2992 / Avg. bwd time: 40.3942 / Avg. batch time: 1089.8910 (ms) / GPU bubble ratio: 19.71%
[rank2]:2025-12-31 04:44:52,510 - Avg. fwd time: 7.7298 / Avg. bwd time: 18.8602 / Avg. batch time: 1151.1664 (ms) / GPU bubble ratio: 63.04%
[rank1]:2025-12-31 04:44:52,555 - Avg. fwd time: 9.7908 / Avg. bwd time: 24.1838 / Avg. batch time: 1210.7422 (ms) / GPU bubble ratio: 55.10%
[rank0]:2025-12-31 04:44:52,591 - Avg. fwd time: 8.3074 / Avg. bwd time: 21.3281 / Avg. batch time: 1249.6771 (ms) / GPU bubble ratio: 62.06%
[rank3]:2025-12-31 04:44:52,624 -  step: 400  loss:  0.2046  grad_norm:  0.1678  memory: 29.23GiB(61.52%)  tps: 6,428  tflops: 50.25  mfu: 16.11%
[rank2]:2025-12-31 04:44:52,612 -  step: 400  loss: -4.0000  grad_norm:  0.1678  memory: 12.06GiB(25.39%)  tps: 6,428  tflops: 50.25  mfu: 16.11%
[rank1]:2025-12-31 04:44:52,615 -  step: 400  loss: -4.0000  grad_norm:  0.1678  memory: 18.49GiB(38.93%)  tps: 6,428  tflops: 50.25  mfu: 16.11%
[rank0]:2025-12-31 04:44:52,626 -  step: 400  loss: -4.0000  grad_norm:  0.1678  memory: 20.42GiB(42.99%)  tps: 6,428  tflops: 50.25  mfu: 16.11%
[rank3]:2025-12-31 04:44:52,873 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0444_step400_rank3.svg
[rank3]:			> Batch Time: 1247.70 ms, GPU Bubble Ratio: 61.93%, 56.36%, 65.83%, 29.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  178-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  387-7-394ms    | [S4,MB1,B]  486-19-505ms   | [S4,MB4,F]  548-8-556ms    | [S4,MB2,B]  556-19-575ms   | [S4,MB5,F]  583-8-592ms    | [S4,MB3,B]  592-19-611ms   | [S4,MB6,F]  618-8-626ms    | [S0,MB0,B]  628-25-653ms   | [S4,MB7,F]  655-7-662ms    | [S0,MB1,B]  666-24-690ms   | [S0,MB2,B]  708-23-732ms   | [S0,MB3,B]  768-23-792ms   | [S4,MB4,B]  805-18-823ms   | [S4,MB5,B]  891-18-909ms   | [S4,MB6,B]  981-18-999ms   | [S4,MB7,B]  1072-18-1090ms | [S0,MB4,B]  1109-23-1132ms | [S0,MB5,B]  1151-23-1174ms | [S0,MB6,B]  1187-23-1210ms | [S0,MB7,B]  1224-23-1247ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-8-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-197ms    | [S5,MB3,F]  273-7-280ms    | [S1,MB4,F]  303-10-314ms   | [S5,MB0,B]  314-18-332ms   | [S1,MB5,F]  361-12-374ms   | [S5,MB1,B]  376-18-395ms   | [S1,MB6,F]  395-11-406ms   | [S5,MB2,B]  485-18-504ms   | [S1,MB7,F]  504-11-515ms   | [S5,MB3,B]  556-19-575ms   | [S5,MB4,F]  575-7-583ms    | [S1,MB0,B]  592-28-620ms   | [S5,MB5,F]  620-9-629ms    | [S1,MB1,B]  629-30-659ms   | [S5,MB6,F]  659-10-669ms   | [S1,MB2,B]  669-32-702ms   | [S5,MB7,F]  702-10-712ms   | [S1,MB3,B]  712-34-746ms   | [S5,MB4,B]  780-18-799ms   | [S5,MB5,B]  866-18-884ms   | [S5,MB6,B]  956-18-974ms   | [S5,MB7,B]  1047-18-1065ms | [S1,MB4,B]  1074-27-1102ms | [S1,MB5,B]  1116-27-1144ms | [S1,MB6,B]  1151-28-1180ms | [S1,MB7,B]  1186-30-1216ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  267-6-274ms    | [S6,MB0,B]  274-19-293ms   | [S6,MB3,F]  293-8-302ms    | [S6,MB1,B]  349-20-369ms   | [S2,MB4,F]  369-8-378ms    | [S6,MB2,B]  438-19-458ms   | [S2,MB5,F]  458-7-465ms    | [S6,MB3,B]  527-19-547ms   | [S2,MB6,F]  547-8-555ms    | [S2,MB0,B]  563-19-583ms   | [S2,MB7,F]  583-8-591ms    | [S2,MB1,B]  598-19-618ms   | [S6,MB4,F]  618-8-626ms    | [S2,MB2,B]  632-19-652ms   | [S6,MB5,F]  652-7-660ms    | [S2,MB3,B]  667-19-687ms   | [S6,MB6,F]  688-7-695ms    | [S6,MB4,B]  753-20-774ms   | [S6,MB7,F]  774-8-782ms    | [S6,MB5,B]  842-18-860ms   | [S6,MB6,B]  932-17-950ms   | [S6,MB7,B]  1024-17-1041ms | [S2,MB4,B]  1050-17-1068ms | [S2,MB5,B]  1092-17-1110ms | [S2,MB6,B]  1116-17-1134ms | [S2,MB7,B]  1150-18-1168ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,B]  204-53-258ms   | [S7,MB1,F]  258-18-276ms   | [S7,MB1,B]  287-55-343ms   | [S7,MB2,F]  343-20-363ms   | [S7,MB2,B]  375-57-432ms   | [S7,MB3,F]  432-21-453ms   | [S7,MB3,B]  464-57-521ms   | [S3,MB4,F]  521-11-533ms   | [S3,MB0,B]  533-24-557ms   | [S3,MB5,F]  557-10-567ms   | [S3,MB1,B]  568-23-591ms   | [S3,MB6,F]  592-10-602ms   | [S3,MB2,B]  602-23-625ms   | [S3,MB7,F]  626-10-636ms   | [S3,MB3,B]  636-22-659ms   | [S7,MB4,F]  659-18-677ms   | [S7,MB4,B]  690-56-746ms   | [S7,MB5,F]  747-21-768ms   | [S7,MB5,B]  778-57-835ms   | [S7,MB6,F]  835-21-856ms   | [S7,MB6,B]  868-57-926ms   | [S7,MB7,F]  926-21-947ms   | [S7,MB7,B]  959-57-1016ms  | [S3,MB4,B]  1017-26-1043ms | [S3,MB5,B]  1043-24-1067ms | [S3,MB6,B]  1067-24-1092ms | [S3,MB7,B]  1092-23-1116ms
[rank3]:2025-12-31 04:45:21,591 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 04:45:22,040 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 04:45:22,076 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 04:45:22,102 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 04:49:02,506 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:49:07,453 - Avg. fwd time: 14.2905 / Avg. bwd time: 40.3887 / Avg. batch time: 1089.6525 (ms) / GPU bubble ratio: 19.71%
[rank2]:2025-12-31 04:49:07,502 - Avg. fwd time: 7.7280 / Avg. bwd time: 18.8622 / Avg. batch time: 1151.0170 (ms) / GPU bubble ratio: 63.04%
[rank1]:2025-12-31 04:49:07,544 - Avg. fwd time: 9.7915 / Avg. bwd time: 24.1921 / Avg. batch time: 1210.5915 (ms) / GPU bubble ratio: 55.08%
[rank2]:2025-12-31 04:49:07,602 -  step: 450  loss: -4.0000  grad_norm:  0.2262  memory: 12.06GiB(25.39%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank1]:2025-12-31 04:49:07,605 -  step: 450  loss: -4.0000  grad_norm:  0.2262  memory: 18.49GiB(38.93%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank0]:2025-12-31 04:49:07,580 - Avg. fwd time: 8.3085 / Avg. bwd time: 21.3338 / Avg. batch time: 1249.5348 (ms) / GPU bubble ratio: 62.04%
[rank0]:2025-12-31 04:49:07,617 -  step: 450  loss: -4.0000  grad_norm:  0.2262  memory: 20.42GiB(42.99%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank3]:2025-12-31 04:49:07,615 -  step: 450  loss:  0.2191  grad_norm:  0.2262  memory: 29.23GiB(61.52%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank0]:2025-12-31 04:53:16,588 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:53:21,527 - Avg. fwd time: 14.2837 / Avg. bwd time: 40.3645 / Avg. batch time: 1089.1330 (ms) / GPU bubble ratio: 19.72%
[rank2]:2025-12-31 04:53:21,576 - Avg. fwd time: 7.7255 / Avg. bwd time: 18.8598 / Avg. batch time: 1150.4568 (ms) / GPU bubble ratio: 63.03%
[rank0]:2025-12-31 04:53:21,663 - Avg. fwd time: 8.3063 / Avg. bwd time: 21.3315 / Avg. batch time: 1248.9258 (ms) / GPU bubble ratio: 62.03%
[rank1]:2025-12-31 04:53:21,620 - Avg. fwd time: 9.7872 / Avg. bwd time: 24.1796 / Avg. batch time: 1209.9779 (ms) / GPU bubble ratio: 55.08%
[rank1]:2025-12-31 04:53:21,687 -  step: 500  loss: -4.0000  grad_norm:  0.1917  memory: 18.49GiB(38.93%)  tps: 6,448  tflops: 50.41  mfu: 16.16%
[rank3]:2025-12-31 04:53:21,697 -  step: 500  loss:  0.2109  grad_norm:  0.1917  memory: 29.23GiB(61.52%)  tps: 6,448  tflops: 50.41  mfu: 16.16%
[rank2]:2025-12-31 04:53:21,684 -  step: 500  loss: -4.0000  grad_norm:  0.1917  memory: 12.06GiB(25.39%)  tps: 6,448  tflops: 50.41  mfu: 16.16%
[rank0]:2025-12-31 04:53:21,699 -  step: 500  loss: -4.0000  grad_norm:  0.1917  memory: 20.42GiB(42.99%)  tps: 6,448  tflops: 50.41  mfu: 16.16%
[rank3]:2025-12-31 04:53:21,949 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0453_step500_rank3.svg
[rank3]:			> Batch Time: 1242.72 ms, GPU Bubble Ratio: 61.81%, 56.40%, 65.77%, 29.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-94ms      | [S4,MB2,F]  123-8-131ms    | [S4,MB3,F]  160-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-193ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  386-7-394ms    | [S4,MB1,B]  486-19-505ms   | [S4,MB4,F]  547-8-555ms    | [S4,MB2,B]  555-19-574ms   | [S4,MB5,F]  582-8-591ms    | [S4,MB3,B]  591-19-610ms   | [S4,MB6,F]  616-8-624ms    | [S0,MB0,B]  626-25-651ms   | [S4,MB7,F]  653-7-660ms    | [S0,MB1,B]  664-24-689ms   | [S0,MB2,B]  706-23-730ms   | [S0,MB3,B]  764-23-788ms   | [S4,MB4,B]  801-18-819ms   | [S4,MB5,B]  888-18-906ms   | [S4,MB6,B]  979-18-997ms   | [S4,MB7,B]  1071-18-1089ms | [S0,MB4,B]  1106-23-1129ms | [S0,MB5,B]  1148-23-1171ms | [S0,MB6,B]  1182-23-1205ms | [S0,MB7,B]  1219-23-1242ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  174-7-181ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  272-7-279ms    | [S1,MB4,F]  302-10-312ms   | [S5,MB0,B]  312-18-330ms   | [S1,MB5,F]  361-12-373ms   | [S5,MB1,B]  376-18-394ms   | [S1,MB6,F]  394-11-406ms   | [S5,MB2,B]  485-18-504ms   | [S1,MB7,F]  504-10-515ms   | [S5,MB3,B]  555-19-574ms   | [S5,MB4,F]  574-7-582ms    | [S1,MB0,B]  590-28-619ms   | [S5,MB5,F]  619-9-628ms    | [S1,MB1,B]  628-30-658ms   | [S5,MB6,F]  658-10-668ms   | [S1,MB2,B]  668-32-700ms   | [S5,MB7,F]  700-10-710ms   | [S1,MB3,B]  710-33-743ms   | [S5,MB4,B]  776-18-795ms   | [S5,MB5,B]  864-18-882ms   | [S5,MB6,B]  954-18-972ms   | [S5,MB7,B]  1046-18-1064ms | [S1,MB4,B]  1072-27-1099ms | [S1,MB5,B]  1114-27-1142ms | [S1,MB6,B]  1148-27-1176ms | [S1,MB7,B]  1181-29-1211ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-103ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  168-7-176ms    | [S6,MB1,F]  182-6-189ms    | [S6,MB2,F]  266-6-273ms    | [S6,MB0,B]  273-19-292ms   | [S6,MB3,F]  292-8-300ms    | [S6,MB1,B]  349-20-369ms   | [S2,MB4,F]  369-8-377ms    | [S6,MB2,B]  438-19-457ms   | [S2,MB5,F]  457-7-464ms    | [S6,MB3,B]  527-19-546ms   | [S2,MB6,F]  546-8-555ms    | [S2,MB0,B]  562-19-582ms   | [S2,MB7,F]  582-8-590ms    | [S2,MB1,B]  597-19-616ms   | [S6,MB4,F]  616-8-625ms    | [S2,MB2,B]  631-19-650ms   | [S6,MB5,F]  650-7-658ms    | [S2,MB3,B]  667-19-686ms   | [S6,MB6,F]  686-7-694ms    | [S6,MB4,B]  749-20-770ms   | [S6,MB7,F]  770-8-778ms    | [S6,MB5,B]  839-18-857ms   | [S6,MB6,B]  930-17-948ms   | [S6,MB7,B]  1022-17-1039ms | [S2,MB4,B]  1047-18-1065ms | [S2,MB5,B]  1089-17-1107ms | [S2,MB6,B]  1114-17-1132ms | [S2,MB7,B]  1147-18-1165ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  103-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,B]  204-53-257ms   | [S7,MB1,F]  256-18-275ms   | [S7,MB1,B]  287-55-343ms   | [S7,MB2,F]  342-20-363ms   | [S7,MB2,B]  374-57-431ms   | [S7,MB3,F]  431-21-452ms   | [S7,MB3,B]  464-57-521ms   | [S3,MB4,F]  521-11-532ms   | [S3,MB0,B]  532-24-557ms   | [S3,MB5,F]  556-10-567ms   | [S3,MB1,B]  566-23-590ms   | [S3,MB6,F]  590-10-601ms   | [S3,MB2,B]  601-23-624ms   | [S3,MB7,F]  624-10-634ms   | [S3,MB3,B]  634-22-656ms   | [S7,MB4,F]  656-18-675ms   | [S7,MB4,B]  686-55-742ms   | [S7,MB5,F]  742-21-764ms   | [S7,MB5,B]  775-57-833ms   | [S7,MB6,F]  832-21-853ms   | [S7,MB6,B]  865-57-923ms   | [S7,MB7,F]  923-21-944ms   | [S7,MB7,B]  956-57-1013ms  | [S3,MB4,B]  1014-25-1040ms | [S3,MB5,B]  1040-24-1064ms | [S3,MB6,B]  1065-24-1090ms | [S3,MB7,B]  1089-23-1113ms
[rank0]:2025-12-31 04:57:30,931 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 04:57:35,914 - Avg. fwd time: 14.2737 / Avg. bwd time: 40.3504 / Avg. batch time: 1088.7297 (ms) / GPU bubble ratio: 19.72%
[rank2]:2025-12-31 04:57:35,964 - Avg. fwd time: 7.7238 / Avg. bwd time: 18.8591 / Avg. batch time: 1150.1192 (ms) / GPU bubble ratio: 63.02%
[rank1]:2025-12-31 04:57:36,006 - Avg. fwd time: 9.7850 / Avg. bwd time: 24.1740 / Avg. batch time: 1209.5970 (ms) / GPU bubble ratio: 55.08%
[rank2]:2025-12-31 04:57:36,064 -  step: 550  loss: -4.0000  grad_norm:  0.1774  memory: 12.06GiB(25.39%)  tps: 6,441  tflops: 50.35  mfu: 16.14%
[rank3]:2025-12-31 04:57:36,077 -  step: 550  loss:  0.2198  grad_norm:  0.1774  memory: 29.23GiB(61.52%)  tps: 6,441  tflops: 50.35  mfu: 16.14%
[rank0]:2025-12-31 04:57:36,043 - Avg. fwd time: 8.3055 / Avg. bwd time: 21.3317 / Avg. batch time: 1248.5472 (ms) / GPU bubble ratio: 62.02%
[rank0]:2025-12-31 04:57:36,079 -  step: 550  loss: -4.0000  grad_norm:  0.1774  memory: 20.42GiB(42.99%)  tps: 6,441  tflops: 50.35  mfu: 16.14%
[rank1]:2025-12-31 04:57:36,068 -  step: 550  loss: -4.0000  grad_norm:  0.1774  memory: 18.49GiB(38.93%)  tps: 6,441  tflops: 50.35  mfu: 16.14%
[rank0]:2025-12-31 05:01:45,691 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 05:01:50,708 - Avg. fwd time: 14.2740 / Avg. bwd time: 40.3458 / Avg. batch time: 1088.6545 (ms) / GPU bubble ratio: 19.73%
[rank2]:2025-12-31 05:01:50,758 - Avg. fwd time: 7.7231 / Avg. bwd time: 18.8592 / Avg. batch time: 1149.9901 (ms) / GPU bubble ratio: 63.02%
[rank0]:2025-12-31 05:01:50,841 - Avg. fwd time: 8.3057 / Avg. bwd time: 21.3326 / Avg. batch time: 1248.3904 (ms) / GPU bubble ratio: 62.01%
[rank0]:2025-12-31 05:01:50,877 -  step: 600  loss: -4.0000  grad_norm:  0.1769  memory: 20.42GiB(42.99%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank1]:2025-12-31 05:01:50,804 - Avg. fwd time: 9.7827 / Avg. bwd time: 24.1669 / Avg. batch time: 1209.4311 (ms) / GPU bubble ratio: 55.09%
[rank1]:2025-12-31 05:01:50,867 -  step: 600  loss: -4.0000  grad_norm:  0.1769  memory: 18.49GiB(38.93%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank2]:2025-12-31 05:01:50,863 -  step: 600  loss: -4.0000  grad_norm:  0.1769  memory: 12.06GiB(25.39%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank3]:2025-12-31 05:01:50,875 -  step: 600  loss:  0.2129  grad_norm:  0.1769  memory: 29.23GiB(61.52%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank3]:2025-12-31 05:01:51,124 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0501_step600_rank3.svg
[rank3]:			> Batch Time: 1245.78 ms, GPU Bubble Ratio: 61.82%, 56.49%, 65.82%, 29.59%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  387-7-394ms    | [S4,MB1,B]  487-19-506ms   | [S4,MB4,F]  548-8-556ms    | [S4,MB2,B]  557-19-576ms   | [S4,MB5,F]  583-8-591ms    | [S4,MB3,B]  592-19-611ms   | [S4,MB6,F]  617-8-625ms    | [S0,MB0,B]  627-25-652ms   | [S4,MB7,F]  654-7-661ms    | [S0,MB1,B]  665-24-690ms   | [S0,MB2,B]  708-23-731ms   | [S0,MB3,B]  766-23-789ms   | [S4,MB4,B]  803-18-821ms   | [S4,MB5,B]  891-18-909ms   | [S4,MB6,B]  981-18-999ms   | [S4,MB7,B]  1073-18-1091ms | [S0,MB4,B]  1108-23-1131ms | [S0,MB5,B]  1151-23-1174ms | [S0,MB6,B]  1186-23-1209ms | [S0,MB7,B]  1222-23-1245ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-7-169ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  273-7-280ms    | [S1,MB4,F]  302-10-313ms   | [S5,MB0,B]  313-18-332ms   | [S1,MB5,F]  361-12-374ms   | [S5,MB1,B]  376-18-395ms   | [S1,MB6,F]  395-11-406ms   | [S5,MB2,B]  486-18-505ms   | [S1,MB7,F]  505-10-516ms   | [S5,MB3,B]  556-19-576ms   | [S5,MB4,F]  576-7-583ms    | [S1,MB0,B]  591-28-619ms   | [S5,MB5,F]  620-9-629ms    | [S1,MB1,B]  629-30-659ms   | [S5,MB6,F]  658-9-668ms    | [S1,MB2,B]  668-32-700ms   | [S5,MB7,F]  701-10-712ms   | [S1,MB3,B]  712-33-745ms   | [S5,MB4,B]  778-18-796ms   | [S5,MB5,B]  866-18-884ms   | [S5,MB6,B]  956-18-974ms   | [S5,MB7,B]  1048-18-1066ms | [S1,MB4,B]  1074-27-1102ms | [S1,MB5,B]  1116-27-1144ms | [S1,MB6,B]  1150-28-1178ms | [S1,MB7,B]  1186-30-1217ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  267-6-274ms    | [S6,MB0,B]  273-19-293ms   | [S6,MB3,F]  293-8-301ms    | [S6,MB1,B]  349-20-370ms   | [S2,MB4,F]  369-8-378ms    | [S6,MB2,B]  439-19-459ms   | [S2,MB5,F]  458-7-466ms    | [S6,MB3,B]  529-19-548ms   | [S2,MB6,F]  548-8-556ms    | [S2,MB0,B]  563-19-583ms   | [S2,MB7,F]  583-8-591ms    | [S2,MB1,B]  597-19-616ms   | [S6,MB4,F]  616-8-625ms    | [S2,MB2,B]  631-19-651ms   | [S6,MB5,F]  651-7-658ms    | [S2,MB3,B]  668-19-688ms   | [S6,MB6,F]  688-7-695ms    | [S6,MB4,B]  750-20-770ms   | [S6,MB7,F]  771-8-779ms    | [S6,MB5,B]  842-18-860ms   | [S6,MB6,B]  932-17-950ms   | [S6,MB7,B]  1024-17-1042ms | [S2,MB4,B]  1050-18-1068ms | [S2,MB5,B]  1092-17-1110ms | [S2,MB6,B]  1116-18-1134ms | [S2,MB7,B]  1150-17-1168ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,B]  204-53-257ms   | [S7,MB1,F]  257-18-276ms   | [S7,MB1,B]  287-55-343ms   | [S7,MB2,F]  343-21-364ms   | [S7,MB2,B]  375-57-432ms   | [S7,MB3,F]  433-21-454ms   | [S7,MB3,B]  465-57-522ms   | [S3,MB4,F]  523-11-534ms   | [S3,MB0,B]  533-24-558ms   | [S3,MB5,F]  556-10-567ms   | [S3,MB1,B]  567-23-590ms   | [S3,MB6,F]  591-10-601ms   | [S3,MB2,B]  601-23-624ms   | [S3,MB7,F]  625-10-635ms   | [S3,MB3,B]  635-22-657ms   | [S7,MB4,F]  657-18-676ms   | [S7,MB4,B]  688-55-743ms   | [S7,MB5,F]  744-21-765ms   | [S7,MB5,B]  777-57-834ms   | [S7,MB6,F]  835-21-856ms   | [S7,MB6,B]  868-57-926ms   | [S7,MB7,F]  926-21-947ms   | [S7,MB7,B]  959-57-1017ms  | [S3,MB4,B]  1017-25-1042ms | [S3,MB5,B]  1043-24-1067ms | [S3,MB6,B]  1067-24-1092ms | [S3,MB7,B]  1092-23-1116ms
[rank0]:2025-12-31 05:06:01,008 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 05:06:05,970 - Avg. fwd time: 14.2760 / Avg. bwd time: 40.3425 / Avg. batch time: 1088.6279 (ms) / GPU bubble ratio: 19.73%
[rank2]:2025-12-31 05:06:06,020 - Avg. fwd time: 7.7224 / Avg. bwd time: 18.8600 / Avg. batch time: 1150.0069 (ms) / GPU bubble ratio: 63.02%
[rank1]:2025-12-31 05:06:06,067 - Avg. fwd time: 9.7815 / Avg. bwd time: 24.1651 / Avg. batch time: 1209.4465 (ms) / GPU bubble ratio: 55.09%
[rank0]:2025-12-31 05:06:06,105 - Avg. fwd time: 8.3063 / Avg. bwd time: 21.3344 / Avg. batch time: 1248.4170 (ms) / GPU bubble ratio: 62.01%
[rank2]:2025-12-31 05:06:06,127 -  step: 650  loss: -4.0000  grad_norm:  0.1667  memory: 12.06GiB(25.39%)  tps: 6,418  tflops: 50.18  mfu: 16.08%
[rank1]:2025-12-31 05:06:06,131 -  step: 650  loss: -4.0000  grad_norm:  0.1667  memory: 18.49GiB(38.93%)  tps: 6,418  tflops: 50.18  mfu: 16.08%
[rank0]:2025-12-31 05:06:06,141 -  step: 650  loss: -4.0000  grad_norm:  0.1667  memory: 20.42GiB(42.99%)  tps: 6,418  tflops: 50.18  mfu: 16.08%
[rank3]:2025-12-31 05:06:06,139 -  step: 650  loss:  0.2231  grad_norm:  0.1667  memory: 29.23GiB(61.52%)  tps: 6,419  tflops: 50.18  mfu: 16.08%
[rank0]:2025-12-31 05:10:16,013 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 05:10:20,972 - Avg. fwd time: 14.2783 / Avg. bwd time: 40.3413 / Avg. batch time: 1088.6416 (ms) / GPU bubble ratio: 19.72%
[rank2]:2025-12-31 05:10:21,022 - Avg. fwd time: 7.7216 / Avg. bwd time: 18.8603 / Avg. batch time: 1149.9755 (ms) / GPU bubble ratio: 63.02%
[rank3]:2025-12-31 05:10:21,140 -  step: 700  loss:  0.1826  grad_norm:  0.1589  memory: 29.23GiB(61.52%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank1]:2025-12-31 05:10:21,068 - Avg. fwd time: 9.7802 / Avg. bwd time: 24.1620 / Avg. batch time: 1209.3923 (ms) / GPU bubble ratio: 55.10%
[rank1]:2025-12-31 05:10:21,132 -  step: 700  loss: -4.0000  grad_norm:  0.1589  memory: 18.49GiB(38.93%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank0]:2025-12-31 05:10:21,107 - Avg. fwd time: 8.3064 / Avg. bwd time: 21.3357 / Avg. batch time: 1248.3716 (ms) / GPU bubble ratio: 62.01%
[rank0]:2025-12-31 05:10:21,142 -  step: 700  loss: -4.0000  grad_norm:  0.1589  memory: 20.42GiB(42.99%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank2]:2025-12-31 05:10:21,128 -  step: 700  loss: -4.0000  grad_norm:  0.1589  memory: 12.06GiB(25.39%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank3]:2025-12-31 05:10:21,389 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0510_step700_rank3.svg
[rank3]:			> Batch Time: 1242.75 ms, GPU Bubble Ratio: 61.73%, 56.40%, 65.74%, 29.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-193ms    | [S4,MB0,B]  367-19-386ms   | [S0,MB7,F]  386-7-393ms    | [S4,MB1,B]  486-19-505ms   | [S4,MB4,F]  549-8-557ms    | [S4,MB2,B]  557-19-576ms   | [S4,MB5,F]  582-8-591ms    | [S4,MB3,B]  591-19-610ms   | [S4,MB6,F]  617-8-626ms    | [S0,MB0,B]  626-25-651ms   | [S4,MB7,F]  652-7-660ms    | [S0,MB1,B]  665-24-690ms   | [S0,MB2,B]  707-23-731ms   | [S0,MB3,B]  766-23-789ms   | [S4,MB4,B]  803-18-821ms   | [S4,MB5,B]  888-18-906ms   | [S4,MB6,B]  978-18-996ms   | [S4,MB7,B]  1070-18-1088ms | [S0,MB4,B]  1105-23-1128ms | [S0,MB5,B]  1148-23-1171ms | [S0,MB6,B]  1182-23-1205ms | [S0,MB7,B]  1219-23-1242ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  161-7-168ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  273-7-280ms    | [S1,MB4,F]  302-10-313ms   | [S5,MB0,B]  313-18-331ms   | [S1,MB5,F]  360-12-373ms   | [S5,MB1,B]  375-18-394ms   | [S1,MB6,F]  394-11-405ms   | [S5,MB2,B]  485-18-504ms   | [S1,MB7,F]  504-10-515ms   | [S5,MB3,B]  556-19-576ms   | [S5,MB4,F]  576-7-583ms    | [S1,MB0,B]  590-28-619ms   | [S5,MB5,F]  618-9-627ms    | [S1,MB1,B]  628-30-658ms   | [S5,MB6,F]  659-10-669ms   | [S1,MB2,B]  669-32-701ms   | [S5,MB7,F]  701-10-711ms   | [S1,MB3,B]  711-34-745ms   | [S5,MB4,B]  778-18-796ms   | [S5,MB5,B]  864-18-882ms   | [S5,MB6,B]  953-18-971ms   | [S5,MB7,B]  1045-18-1063ms | [S1,MB4,B]  1071-27-1099ms | [S1,MB5,B]  1114-27-1142ms | [S1,MB6,B]  1147-27-1175ms | [S1,MB7,B]  1182-28-1211ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  266-6-273ms    | [S6,MB0,B]  273-19-293ms   | [S6,MB3,F]  293-8-301ms    | [S6,MB1,B]  348-20-368ms   | [S2,MB4,F]  368-8-377ms    | [S6,MB2,B]  437-19-457ms   | [S2,MB5,F]  456-7-464ms    | [S6,MB3,B]  529-19-548ms   | [S2,MB6,F]  548-8-557ms    | [S2,MB0,B]  562-19-582ms   | [S2,MB7,F]  581-8-590ms    | [S2,MB1,B]  597-19-617ms   | [S6,MB4,F]  617-8-625ms    | [S2,MB2,B]  631-19-651ms   | [S6,MB5,F]  651-7-658ms    | [S2,MB3,B]  667-19-687ms   | [S6,MB6,F]  686-7-694ms    | [S6,MB4,B]  750-20-771ms   | [S6,MB7,F]  771-8-780ms    | [S6,MB5,B]  839-18-858ms   | [S6,MB6,B]  929-17-946ms   | [S6,MB7,B]  1021-17-1039ms | [S2,MB4,B]  1047-18-1065ms | [S2,MB5,B]  1089-17-1107ms | [S2,MB6,B]  1114-17-1132ms | [S2,MB7,B]  1147-18-1165ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  176-15-192ms   | [S7,MB0,B]  204-53-257ms   | [S7,MB1,F]  257-18-276ms   | [S7,MB1,B]  287-55-343ms   | [S7,MB2,F]  341-20-362ms   | [S7,MB2,B]  373-57-431ms   | [S7,MB3,F]  431-21-452ms   | [S7,MB3,B]  464-57-522ms   | [S3,MB4,F]  522-12-534ms   | [S3,MB0,B]  533-24-558ms   | [S3,MB5,F]  556-10-567ms   | [S3,MB1,B]  566-23-590ms   | [S3,MB6,F]  591-10-601ms   | [S3,MB2,B]  601-23-625ms   | [S3,MB7,F]  624-10-635ms   | [S3,MB3,B]  635-22-657ms   | [S7,MB4,F]  657-18-676ms   | [S7,MB4,B]  688-55-744ms   | [S7,MB5,F]  743-21-765ms   | [S7,MB5,B]  775-57-832ms   | [S7,MB6,F]  833-21-854ms   | [S7,MB6,B]  865-57-923ms   | [S7,MB7,F]  922-21-944ms   | [S7,MB7,B]  956-57-1013ms  | [S3,MB4,B]  1014-25-1040ms | [S3,MB5,B]  1040-24-1065ms | [S3,MB6,B]  1064-24-1089ms | [S3,MB7,B]  1088-23-1112ms
[rank0]:2025-12-31 05:14:31,254 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 05:14:36,258 - Avg. fwd time: 14.2811 / Avg. bwd time: 40.3424 / Avg. batch time: 1088.6986 (ms) / GPU bubble ratio: 19.72%
[rank2]:2025-12-31 05:14:36,306 - Avg. fwd time: 7.7212 / Avg. bwd time: 18.8610 / Avg. batch time: 1150.0515 (ms) / GPU bubble ratio: 63.02%
[rank1]:2025-12-31 05:14:36,349 - Avg. fwd time: 9.7796 / Avg. bwd time: 24.1594 / Avg. batch time: 1209.4318 (ms) / GPU bubble ratio: 55.10%
[rank0]:2025-12-31 05:14:36,388 - Avg. fwd time: 8.3065 / Avg. bwd time: 21.3368 / Avg. batch time: 1248.4174 (ms) / GPU bubble ratio: 62.01%
[rank2]:2025-12-31 05:14:36,410 -  step: 750  loss: -4.0000  grad_norm:  0.1888  memory: 12.06GiB(25.39%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank3]:2025-12-31 05:14:36,422 -  step: 750  loss:  0.2191  grad_norm:  0.1888  memory: 29.23GiB(61.52%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank1]:2025-12-31 05:14:36,413 -  step: 750  loss: -4.0000  grad_norm:  0.1888  memory: 18.49GiB(38.93%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank0]:2025-12-31 05:14:36,424 -  step: 750  loss: -4.0000  grad_norm:  0.1888  memory: 20.42GiB(42.99%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank0]:2025-12-31 05:18:46,015 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 05:18:51,097 - Avg. fwd time: 7.7206 / Avg. bwd time: 18.8608 / Avg. batch time: 1149.9537 (ms) / GPU bubble ratio: 63.02%
[rank3]:2025-12-31 05:18:51,048 - Avg. fwd time: 14.2780 / Avg. bwd time: 40.3414 / Avg. batch time: 1088.6351 (ms) / GPU bubble ratio: 19.72%
[rank2]:2025-12-31 05:18:51,205 -  step: 800  loss: -4.0000  grad_norm:  0.1819  memory: 12.06GiB(25.39%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank2]:2025-12-31 05:18:51,205 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1819  tps: 6,815  tflops: 53.28  mfu: 15.61%
[rank2]:2025-12-31 05:18:51,205 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 05:18:51,206 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 05:18:51,144 - Avg. fwd time: 9.7806 / Avg. bwd time: 24.1612 / Avg. batch time: 1209.3170 (ms) / GPU bubble ratio: 55.09%
[rank1]:2025-12-31 05:18:51,209 -  step: 800  loss: -4.0000  grad_norm:  0.1819  memory: 18.49GiB(38.93%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank1]:2025-12-31 05:18:51,209 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1819  tps: 6,815  tflops: 53.28  mfu: 15.60%
[rank1]:2025-12-31 05:18:51,209 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 05:18:51,209 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-31 05:18:51,217 -  step: 800  loss:  0.2248  grad_norm:  0.1819  memory: 29.23GiB(61.52%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank3]:2025-12-31 05:18:51,218 - â„¹ï¸ final step: 800  loss:  0.2248  grad_norm:  0.1819  tps: 6,819  tflops: 53.31  mfu: 15.73%
[rank3]:2025-12-31 05:18:51,218 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 05:18:51,219 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 05:18:51,183 - Avg. fwd time: 8.3068 / Avg. bwd time: 21.3368 / Avg. batch time: 1248.3088 (ms) / GPU bubble ratio: 62.00%
[rank0]:2025-12-31 05:18:51,220 -  step: 800  loss: -4.0000  grad_norm:  0.1819  memory: 20.42GiB(42.99%)  tps: 6,430  tflops: 50.27  mfu: 16.11%
[rank0]:2025-12-31 05:18:51,220 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1819  tps: 6,815  tflops: 53.28  mfu: 15.61%
[rank0]:2025-12-31 05:18:51,220 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 05:18:51,220 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 05:18:53,205 - Destroying the purge thread.
[rank2]:2025-12-31 05:18:53,205 - Destroying the purge thread.
[rank0]:2025-12-31 05:18:53,180 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-31 05:18:53,205 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-31 05:18:53,429 - Process group destroyed
[rank3]:2025-12-31 05:18:53,436 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0518_final800_rank3.svg
[rank3]:			> Batch Time: 1246.73 ms, GPU Bubble Ratio: 61.87%, 56.34%, 65.83%, 29.58%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  123-8-132ms    | [S4,MB3,F]  161-8-169ms    | [S0,MB4,F]  169-8-177ms    | [S0,MB5,F]  177-7-185ms    | [S0,MB6,F]  185-8-194ms    | [S4,MB0,B]  369-19-388ms   | [S0,MB7,F]  388-7-395ms    | [S4,MB1,B]  487-19-506ms   | [S4,MB4,F]  548-8-556ms    | [S4,MB2,B]  557-19-576ms   | [S4,MB5,F]  584-8-593ms    | [S4,MB3,B]  593-19-612ms   | [S4,MB6,F]  618-8-627ms    | [S0,MB0,B]  628-25-653ms   | [S4,MB7,F]  655-7-662ms    | [S0,MB1,B]  667-24-691ms   | [S0,MB2,B]  709-23-732ms   | [S0,MB3,B]  768-23-792ms   | [S4,MB4,B]  805-18-823ms   | [S4,MB5,B]  892-18-910ms   | [S4,MB6,B]  982-18-1000ms  | [S4,MB7,B]  1073-18-1091ms | [S0,MB4,B]  1108-23-1131ms | [S0,MB5,B]  1151-23-1174ms | [S0,MB6,B]  1187-23-1210ms | [S0,MB7,B]  1223-23-1246ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  123-10-134ms   | [S5,MB0,F]  160-7-168ms    | [S5,MB1,F]  175-7-182ms    | [S5,MB2,F]  189-7-196ms    | [S5,MB3,F]  273-7-280ms    | [S1,MB4,F]  302-10-313ms   | [S5,MB0,B]  313-18-331ms   | [S1,MB5,F]  362-12-374ms   | [S5,MB1,B]  377-18-395ms   | [S1,MB6,F]  395-11-407ms   | [S5,MB2,B]  486-18-505ms   | [S1,MB7,F]  505-11-516ms   | [S5,MB3,B]  557-19-576ms   | [S5,MB4,F]  576-7-583ms    | [S1,MB0,B]  592-28-621ms   | [S5,MB5,F]  621-9-630ms    | [S1,MB1,B]  630-30-660ms   | [S5,MB6,F]  660-10-670ms   | [S1,MB2,B]  670-32-702ms   | [S5,MB7,F]  702-10-713ms   | [S1,MB3,B]  712-33-746ms   | [S5,MB4,B]  780-18-799ms   | [S5,MB5,B]  867-18-885ms   | [S5,MB6,B]  957-18-975ms   | [S5,MB7,B]  1048-18-1066ms | [S1,MB4,B]  1074-27-1101ms | [S1,MB5,B]  1117-27-1145ms | [S1,MB6,B]  1151-28-1180ms | [S1,MB7,B]  1186-30-1216ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  97-6-104ms     | [S2,MB3,F]  134-6-141ms    | [S6,MB0,F]  169-7-176ms    | [S6,MB1,F]  183-6-190ms    | [S6,MB2,F]  267-6-274ms    | [S6,MB0,B]  274-19-293ms   | [S6,MB3,F]  293-8-301ms    | [S6,MB1,B]  350-20-370ms   | [S2,MB4,F]  370-8-378ms    | [S6,MB2,B]  439-19-458ms   | [S2,MB5,F]  458-7-465ms    | [S6,MB3,B]  529-19-548ms   | [S2,MB6,F]  548-8-557ms    | [S2,MB0,B]  564-19-584ms   | [S2,MB7,F]  584-8-592ms    | [S2,MB1,B]  599-19-618ms   | [S6,MB4,F]  618-8-627ms    | [S2,MB2,B]  633-19-653ms   | [S6,MB5,F]  653-7-660ms    | [S2,MB3,B]  669-19-689ms   | [S6,MB6,F]  689-7-696ms    | [S6,MB4,B]  753-20-773ms   | [S6,MB7,F]  774-8-782ms    | [S6,MB5,B]  842-18-861ms   | [S6,MB6,B]  933-17-951ms   | [S6,MB7,B]  1024-17-1042ms | [S2,MB4,B]  1050-17-1068ms | [S2,MB5,B]  1092-17-1110ms | [S2,MB6,B]  1117-17-1135ms | [S2,MB7,B]  1150-18-1168ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  66-7-73ms      | [S3,MB2,F]  104-7-111ms    | [S3,MB3,F]  141-7-148ms    | [S7,MB0,F]  177-15-192ms   | [S7,MB0,B]  204-53-257ms   | [S7,MB1,F]  257-18-276ms   | [S7,MB1,B]  287-55-343ms   | [S7,MB2,F]  343-20-364ms   | [S7,MB2,B]  375-57-432ms   | [S7,MB3,F]  432-21-453ms   | [S7,MB3,B]  465-57-522ms   | [S3,MB4,F]  522-11-534ms   | [S3,MB0,B]  534-24-558ms   | [S3,MB5,F]  557-10-568ms   | [S3,MB1,B]  568-23-592ms   | [S3,MB6,F]  592-10-603ms   | [S3,MB2,B]  603-23-626ms   | [S3,MB7,F]  626-10-637ms   | [S3,MB3,B]  637-22-660ms   | [S7,MB4,F]  659-18-678ms   | [S7,MB4,B]  690-56-746ms   | [S7,MB5,F]  746-21-768ms   | [S7,MB5,B]  778-57-836ms   | [S7,MB6,F]  836-21-857ms   | [S7,MB6,B]  869-57-927ms   | [S7,MB7,F]  926-21-948ms   | [S7,MB7,B]  959-57-1017ms  | [S3,MB4,B]  1016-25-1042ms | [S3,MB5,B]  1042-24-1067ms | [S3,MB6,B]  1067-24-1092ms | [S3,MB7,B]  1092-23-1116ms
[rank1]:2025-12-31 05:18:53,457 - Process group destroyed
[rank3]:2025-12-31 05:18:53,665 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1/pipeline_schedule/251231_0518_thry_final800_rank3.svg
[rank3]:			> Batch Time: 573.53 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S4,MB0,F]  40-10-50ms     | [S4,MB1,F]  50-10-60ms     | [S4,MB2,F]  60-10-70ms     | [S4,MB3,F]  70-10-80ms     | [S0,MB4,F]  80-10-90ms     | [S0,MB5,F]  90-10-100ms    | [S0,MB6,F]  100-10-110ms   | [S4,MB0,B]  140-20-160ms   | [S0,MB7,F]  160-10-171ms   | [S4,MB1,B]  171-20-191ms   | [S4,MB4,F]  201-10-211ms   | [S4,MB2,B]  211-20-231ms   | [S4,MB5,F]  231-10-241ms   | [S4,MB3,B]  241-20-261ms   | [S4,MB6,F]  261-10-271ms   | [S0,MB0,B]  271-20-291ms   | [S4,MB7,F]  291-10-301ms   | [S0,MB1,B]  301-20-321ms   | [S0,MB2,B]  321-20-342ms   | [S0,MB3,B]  352-20-372ms   | [S4,MB4,B]  382-20-402ms   | [S4,MB5,B]  412-20-432ms   | [S4,MB6,B]  442-20-462ms   | [S4,MB7,B]  472-20-493ms   | [S0,MB4,B]  493-20-513ms   | [S0,MB5,B]  513-20-533ms   | [S0,MB6,B]  533-20-553ms   | [S0,MB7,B]  553-20-573ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB3,F]  40-10-50ms     | [S5,MB0,F]  50-10-60ms     | [S5,MB1,F]  60-10-70ms     | [S5,MB2,F]  70-10-80ms     | [S5,MB3,F]  80-10-90ms     | [S1,MB4,F]  90-10-100ms    | [S5,MB0,B]  120-20-140ms   | [S1,MB5,F]  140-10-150ms   | [S5,MB1,B]  150-20-171ms   | [S1,MB6,F]  171-10-181ms   | [S5,MB2,B]  181-20-201ms   | [S1,MB7,F]  201-10-211ms   | [S5,MB3,B]  211-20-231ms   | [S5,MB4,F]  231-10-241ms   | [S1,MB0,B]  241-20-261ms   | [S5,MB5,F]  261-10-271ms   | [S1,MB1,B]  271-20-291ms   | [S5,MB6,F]  291-10-301ms   | [S1,MB2,B]  301-20-321ms   | [S5,MB7,F]  321-10-332ms   | [S1,MB3,B]  332-20-352ms   | [S5,MB4,B]  362-20-382ms   | [S5,MB5,B]  392-20-412ms   | [S5,MB6,B]  422-20-442ms   | [S5,MB7,B]  452-20-472ms   | [S1,MB4,B]  472-20-493ms   | [S1,MB5,B]  493-20-513ms   | [S1,MB6,B]  513-20-533ms   | [S1,MB7,B]  533-20-553ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB2,F]  40-10-50ms     | [S2,MB3,F]  50-10-60ms     | [S6,MB0,F]  60-10-70ms     | [S6,MB1,F]  70-10-80ms     | [S6,MB2,F]  80-10-90ms     | [S6,MB0,B]  100-20-120ms   | [S6,MB3,F]  120-10-130ms   | [S6,MB1,B]  130-20-150ms   | [S2,MB4,F]  150-10-160ms   | [S6,MB2,B]  160-20-181ms   | [S2,MB5,F]  181-10-191ms   | [S6,MB3,B]  191-20-211ms   | [S2,MB6,F]  211-10-221ms   | [S2,MB0,B]  221-20-241ms   | [S2,MB7,F]  241-10-251ms   | [S2,MB1,B]  251-20-271ms   | [S6,MB4,F]  271-10-281ms   | [S2,MB2,B]  281-20-301ms   | [S6,MB5,F]  301-10-311ms   | [S2,MB3,B]  311-20-332ms   | [S6,MB6,F]  332-10-342ms   | [S6,MB4,B]  342-20-362ms   | [S6,MB7,F]  362-10-372ms   | [S6,MB5,B]  372-20-392ms   | [S6,MB6,B]  402-20-422ms   | [S6,MB7,B]  432-20-452ms   | [S2,MB4,B]  452-20-472ms   | [S2,MB5,B]  472-20-493ms   | [S2,MB6,B]  493-20-513ms   | [S2,MB7,B]  513-20-533ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB1,F]  40-10-50ms     | [S3,MB2,F]  50-10-60ms     | [S3,MB3,F]  60-10-70ms     | [S7,MB0,F]  70-10-80ms     | [S7,MB0,B]  80-20-100ms    | [S7,MB1,F]  100-10-110ms   | [S7,MB1,B]  110-20-130ms   | [S7,MB2,F]  130-10-140ms   | [S7,MB2,B]  140-20-160ms   | [S7,MB3,F]  160-10-171ms   | [S7,MB3,B]  171-20-191ms   | [S3,MB4,F]  191-10-201ms   | [S3,MB0,B]  201-20-221ms   | [S3,MB5,F]  221-10-231ms   | [S3,MB1,B]  231-20-251ms   | [S3,MB6,F]  251-10-261ms   | [S3,MB2,B]  261-20-281ms   | [S3,MB7,F]  281-10-291ms   | [S3,MB3,B]  291-20-311ms   | [S7,MB4,F]  311-10-321ms   | [S7,MB4,B]  321-20-342ms   | [S7,MB5,F]  342-10-352ms   | [S7,MB5,B]  352-20-372ms   | [S7,MB6,F]  372-10-382ms   | [S7,MB6,B]  382-20-402ms   | [S7,MB7,F]  402-10-412ms   | [S7,MB7,B]  412-20-432ms   | [S3,MB4,B]  432-20-452ms   | [S3,MB5,B]  452-20-472ms   | [S3,MB6,B]  472-20-493ms   | [S3,MB7,B]  493-20-513ms  
[rank3]:2025-12-31 05:18:53,666 - Destroying the purge thread.
[rank3]:wandb: uploading history steps 15-16, summary, console lines 261-278
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.80545
[rank3]:wandb:               final/avg_loss 0.22476
[rank3]:wandb:             final/avg_mfu(%) 15.73009
[rank3]:wandb:             final/avg_tflops 53.30719
[rank3]:wandb:    final/avg_throughput(tps) 6818.92177
[rank3]:wandb:              final/grad_norm 0.18188
[rank3]:wandb:               final/max_loss 0.22476
[rank3]:wandb:                    grad_norm 0.18188
[rank3]:wandb: loss_metrics/global_avg_loss 0.22476
[rank3]:wandb: loss_metrics/global_max_loss 0.22476
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_Interleaved1F1B_nofreeze_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/wgjopf13
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_nofreeze_22_dm1/20251231-0410/wandb/run-20251231_041045-wgjopf13/logs
[rank3]:2025-12-31 05:18:54,972 - Process group destroyed
[rank0]:2025-12-31 05:18:55,205 - Training completed
[rank0]:2025-12-31 05:18:55,205 - Destroying the purge thread.
[rank0]:2025-12-31 05:18:55,562 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.3', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'norm', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_Interleaved1F1B_nofreeze_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
