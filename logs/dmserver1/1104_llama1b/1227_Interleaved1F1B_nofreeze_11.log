
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 27. (í† ) 19:21:58 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_Interleaved1F1B_nofreeze_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-27 19:22:04,592 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank2]:2025-12-27 19:22:04,584 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank3]:2025-12-27 19:22:04,580 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank1]:2025-12-27 19:22:04,646 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank2]:2025-12-27 19:22:04,886 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-27 19:22:04,888 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-27 19:22:04,858 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-27 19:22:04,861 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-27 19:22:04,948 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-27 19:22:04,951 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 19:22:04,900 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-27 19:22:04,903 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 19:22:04,907 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-27 19:22:04,908 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-27 19:22:05,308 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-27 19:22:08,246 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-27 19:22:08,341 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-27 19:22:08,382 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 19:22:08,405 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 19:22:08,443 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 19:22:08,445 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-27 19:22:08,471 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-27 19:22:08,484 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-27 19:22:08,485 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-27 19:22:08,410 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-27 19:22:08,423 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-27 19:22:08,424 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-27 19:22:08,530 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-27 19:22:08,568 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 19:22:08,595 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-27 19:22:08,608 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-27 19:22:08,609 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-27 19:22:08,673 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 19:22:08,673 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-27 19:22:08,674 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-27 19:22:08,605 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 19:22:08,606 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-27 19:22:08,606 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-27 19:22:08,798 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 19:22:08,798 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-27 19:22:08,799 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 1dg3ij7n
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_Interleaved1F1B_nofreeze_11_dm1/20251227-1922/wandb/run-20251227_192209-1dg3ij7n
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/1dg3ij7n
[rank3]:2025-12-27 19:22:11,079 - WandB logging enabled
[rank3]:2025-12-27 19:22:11,080 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-27 19:22:11,121 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 19:22:11,150 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-27 19:22:11,164 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-27 19:22:11,166 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-27 19:22:11,377 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 19:22:11,375 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_Interleaved1F1B_nofreeze_11_dm1
[rank2]:2025-12-27 19:22:11,377 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 19:22:11,376 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 19:22:11,376 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-27 19:22:11,376 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-27 19:22:11,359 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 19:22:11,359 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-27 19:22:11,360 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-27 19:22:11,377 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 19:22:13,885 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-27 19:22:13,885 - Finished loading the checkpoint in 2.51 seconds.
[rank0]:2025-12-27 19:22:13,885 - Training starts at step 1
[rank1]:2025-12-27 19:22:19,452 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 16.23GiB(34.16%)  tps: 3,011  tflops: 23.54  mfu: 7.54%
[rank1]:2025-12-27 19:22:19,452 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-27 19:22:19,459 -  step:  1  loss: 10.6092  grad_norm: 203.0669  memory: 25.52GiB(53.71%)  tps: 3,931  tflops: 30.73  mfu: 9.85%
[rank3]:2025-12-27 19:22:19,460 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-27 19:22:19,447 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 10.24GiB(21.56%)  tps: 2,962  tflops: 23.15  mfu: 7.42%
[rank2]:2025-12-27 19:22:19,447 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-27 19:22:19,483 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 16.58GiB(34.89%)  tps: 2,968  tflops: 23.20  mfu: 7.44%
[rank0]:2025-12-27 19:22:19,483 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-27 19:26:24,619 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 19:26:29,602 - Avg. fwd time: 7.8384 / Avg. bwd time: 18.8212 / Avg. batch time: 1150.2251 (ms) / GPU bubble ratio: 62.92%
[rank3]:2025-12-27 19:26:29,556 - Avg. fwd time: 14.2110 / Avg. bwd time: 40.2308 / Avg. batch time: 1087.8828 (ms) / GPU bubble ratio: 19.93%
[rank2]:2025-12-27 19:26:29,698 -  step: 50  loss: -4.0000  grad_norm: 24.3861  memory: 12.06GiB(25.39%)  tps: 6,416  tflops: 50.16  mfu: 16.08%
[rank1]:2025-12-27 19:26:29,645 - Avg. fwd time: 9.9349 / Avg. bwd time: 24.1858 / Avg. batch time: 1209.5999 (ms) / GPU bubble ratio: 54.87%
[rank1]:2025-12-27 19:26:29,702 -  step: 50  loss: -4.0000  grad_norm: 24.3861  memory: 18.49GiB(38.93%)  tps: 6,416  tflops: 50.16  mfu: 16.08%
[rank3]:2025-12-27 19:26:29,710 -  step: 50  loss:  9.8844  grad_norm: 24.3861  memory: 29.23GiB(61.52%)  tps: 6,416  tflops: 50.16  mfu: 16.08%
[rank0]:2025-12-27 19:26:29,677 - Avg. fwd time: 8.3062 / Avg. bwd time: 21.1010 / Avg. batch time: 1248.4312 (ms) / GPU bubble ratio: 62.31%
[rank0]:2025-12-27 19:26:29,713 -  step: 50  loss: -4.0000  grad_norm: 24.3861  memory: 20.42GiB(42.99%)  tps: 6,417  tflops: 50.16  mfu: 16.08%
[rank0]:2025-12-27 19:30:40,415 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 19:30:45,369 - Avg. fwd time: 14.2391 / Avg. bwd time: 40.3044 / Avg. batch time: 1089.4483 (ms) / GPU bubble ratio: 19.90%
[rank2]:2025-12-27 19:30:45,419 - Avg. fwd time: 7.8331 / Avg. bwd time: 18.8667 / Avg. batch time: 1151.7016 (ms) / GPU bubble ratio: 62.91%
[rank2]:2025-12-27 19:30:45,519 -  step: 100  loss: -4.0000  grad_norm: 16.4650  memory: 12.06GiB(25.39%)  tps: 6,404  tflops: 50.07  mfu: 16.05%
[rank1]:2025-12-27 19:30:45,465 - Avg. fwd time: 9.9348 / Avg. bwd time: 24.2478 / Avg. batch time: 1211.2693 (ms) / GPU bubble ratio: 54.85%
[rank1]:2025-12-27 19:30:45,523 -  step: 100  loss: -4.0000  grad_norm: 16.4650  memory: 18.49GiB(38.93%)  tps: 6,404  tflops: 50.07  mfu: 16.05%
[rank0]:2025-12-27 19:30:45,498 - Avg. fwd time: 8.2995 / Avg. bwd time: 21.1347 / Avg. batch time: 1250.1606 (ms) / GPU bubble ratio: 62.33%
[rank0]:2025-12-27 19:30:45,534 -  step: 100  loss: -4.0000  grad_norm: 16.4650  memory: 20.42GiB(42.99%)  tps: 6,404  tflops: 50.07  mfu: 16.05%
[rank3]:2025-12-27 19:30:45,531 -  step: 100  loss:  8.2221  grad_norm: 16.4650  memory: 29.23GiB(61.52%)  tps: 6,405  tflops: 50.07  mfu: 16.05%
[rank3]:2025-12-27 19:30:45,849 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_1930_step100_rank3.svg
[rank3]:			> Batch Time: 1249.52 ms, GPU Bubble Ratio: 62.22%, 56.15%, 65.78%, 29.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  387-7-394ms    | [S4,MB1,B]  489-19-508ms   | [S4,MB4,F]  550-8-558ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  586-8-594ms    | [S4,MB3,B]  595-19-614ms   | [S4,MB6,F]  622-8-630ms    | [S0,MB0,B]  631-25-656ms   | [S4,MB7,F]  657-7-664ms    | [S0,MB1,B]  668-24-693ms   | [S0,MB2,B]  710-23-734ms   | [S0,MB3,B]  770-23-793ms   | [S4,MB4,B]  807-18-825ms   | [S4,MB5,B]  895-18-913ms   | [S4,MB6,B]  983-18-1001ms  | [S4,MB7,B]  1073-18-1091ms | [S0,MB4,B]  1109-23-1132ms | [S0,MB5,B]  1152-23-1175ms | [S0,MB6,B]  1188-23-1211ms | [S0,MB7,B]  1226-23-1249ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  273-7-281ms    | [S1,MB4,F]  303-10-314ms   | [S5,MB0,B]  314-18-332ms   | [S1,MB5,F]  361-12-374ms   | [S5,MB1,B]  377-18-396ms   | [S1,MB6,F]  396-11-407ms   | [S5,MB2,B]  488-18-507ms   | [S1,MB7,F]  507-11-518ms   | [S5,MB3,B]  559-19-578ms   | [S5,MB4,F]  578-7-586ms    | [S1,MB0,B]  595-28-623ms   | [S5,MB5,F]  622-9-631ms    | [S1,MB1,B]  631-30-661ms   | [S5,MB6,F]  661-10-671ms   | [S1,MB2,B]  671-32-703ms   | [S5,MB7,F]  703-10-714ms   | [S1,MB3,B]  714-33-748ms   | [S5,MB4,B]  782-18-801ms   | [S5,MB5,B]  870-18-888ms   | [S5,MB6,B]  959-18-977ms   | [S5,MB7,B]  1048-18-1066ms | [S1,MB4,B]  1075-27-1103ms | [S1,MB5,B]  1117-27-1145ms | [S1,MB6,B]  1151-28-1180ms | [S1,MB7,B]  1187-30-1217ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  267-7-275ms    | [S6,MB0,B]  274-19-294ms   | [S6,MB3,F]  293-8-302ms    | [S6,MB1,B]  351-19-370ms   | [S2,MB4,F]  370-8-379ms    | [S6,MB2,B]  440-19-460ms   | [S2,MB5,F]  460-7-467ms    | [S6,MB3,B]  531-19-550ms   | [S2,MB6,F]  550-8-559ms    | [S2,MB0,B]  567-19-586ms   | [S2,MB7,F]  586-8-594ms    | [S2,MB1,B]  602-19-622ms   | [S6,MB4,F]  622-8-630ms    | [S2,MB2,B]  636-19-656ms   | [S6,MB5,F]  656-7-664ms    | [S2,MB3,B]  669-20-689ms   | [S6,MB6,F]  690-7-697ms    | [S6,MB4,B]  756-19-776ms   | [S6,MB7,F]  776-8-784ms    | [S6,MB5,B]  846-18-864ms   | [S6,MB6,B]  935-17-953ms   | [S6,MB7,B]  1024-17-1042ms | [S2,MB4,B]  1050-18-1068ms | [S2,MB5,B]  1092-18-1110ms | [S2,MB6,B]  1117-18-1135ms | [S2,MB7,B]  1151-18-1169ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-258ms   | [S7,MB1,F]  258-18-277ms   | [S7,MB1,B]  288-56-345ms   | [S7,MB2,F]  345-21-366ms   | [S7,MB2,B]  376-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  466-57-524ms   | [S3,MB4,F]  524-12-537ms   | [S3,MB0,B]  536-24-561ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  572-23-596ms   | [S3,MB6,F]  596-10-606ms   | [S3,MB2,B]  607-23-630ms   | [S3,MB7,F]  630-10-640ms   | [S3,MB3,B]  640-22-663ms   | [S7,MB4,F]  662-18-680ms   | [S7,MB4,B]  692-56-749ms   | [S7,MB5,F]  750-21-771ms   | [S7,MB5,B]  783-57-840ms   | [S7,MB6,F]  839-21-860ms   | [S7,MB6,B]  872-57-930ms   | [S7,MB7,F]  928-21-949ms   | [S7,MB7,B]  959-57-1017ms  | [S3,MB4,B]  1017-26-1043ms | [S3,MB5,B]  1043-24-1068ms | [S3,MB6,B]  1068-24-1093ms | [S3,MB7,B]  1092-23-1116ms
[rank0]:2025-12-27 19:34:56,514 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 19:35:01,558 - Avg. fwd time: 7.8264 / Avg. bwd time: 18.8865 / Avg. batch time: 1152.8883 (ms) / GPU bubble ratio: 62.93%
[rank3]:2025-12-27 19:35:01,508 - Avg. fwd time: 14.2629 / Avg. bwd time: 40.3347 / Avg. batch time: 1090.2612 (ms) / GPU bubble ratio: 19.88%
[rank1]:2025-12-27 19:35:01,605 - Avg. fwd time: 9.9303 / Avg. bwd time: 24.2645 / Avg. batch time: 1212.3987 (ms) / GPU bubble ratio: 54.87%
[rank1]:2025-12-27 19:35:01,663 -  step: 150  loss: -4.0000  grad_norm: 27.1870  memory: 18.49GiB(38.93%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank0]:2025-12-27 19:35:01,638 - Avg. fwd time: 8.2963 / Avg. bwd time: 21.1462 / Avg. batch time: 1251.2994 (ms) / GPU bubble ratio: 62.35%
[rank0]:2025-12-27 19:35:01,674 -  step: 150  loss: -4.0000  grad_norm: 27.1870  memory: 20.42GiB(42.99%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank2]:2025-12-27 19:35:01,659 -  step: 150  loss: -4.0000  grad_norm: 27.1870  memory: 12.06GiB(25.39%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank3]:2025-12-27 19:35:01,671 -  step: 150  loss:  3.2457  grad_norm: 27.1870  memory: 29.23GiB(61.52%)  tps: 6,397  tflops: 50.01  mfu: 16.03%
[rank0]:2025-12-27 19:39:12,756 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 19:39:17,800 - Avg. fwd time: 14.2840 / Avg. bwd time: 40.3682 / Avg. batch time: 1091.0923 (ms) / GPU bubble ratio: 19.86%
[rank1]:2025-12-27 19:39:17,895 - Avg. fwd time: 9.9253 / Avg. bwd time: 24.2910 / Avg. batch time: 1213.1081 (ms) / GPU bubble ratio: 54.87%
[rank2]:2025-12-27 19:39:17,850 - Avg. fwd time: 7.8225 / Avg. bwd time: 18.9137 / Avg. batch time: 1153.6113 (ms) / GPU bubble ratio: 62.92%
[rank1]:2025-12-27 19:39:17,954 -  step: 200  loss: -4.0000  grad_norm: 15.2029  memory: 18.49GiB(38.93%)  tps: 6,393  tflops: 49.98  mfu: 16.02%
[rank2]:2025-12-27 19:39:17,950 -  step: 200  loss: -4.0000  grad_norm: 15.2029  memory: 12.06GiB(25.39%)  tps: 6,393  tflops: 49.98  mfu: 16.02%
[rank0]:2025-12-27 19:39:17,929 - Avg. fwd time: 8.2970 / Avg. bwd time: 21.1705 / Avg. batch time: 1252.0329 (ms) / GPU bubble ratio: 62.34%
[rank0]:2025-12-27 19:39:17,966 -  step: 200  loss: -4.0000  grad_norm: 15.2029  memory: 20.42GiB(42.99%)  tps: 6,393  tflops: 49.98  mfu: 16.02%
[rank3]:2025-12-27 19:39:17,963 -  step: 200  loss:  1.0086  grad_norm: 15.2029  memory: 29.23GiB(61.52%)  tps: 6,393  tflops: 49.98  mfu: 16.02%
[rank3]:2025-12-27 19:39:18,226 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_1939_step200_rank3.svg
[rank3]:			> Batch Time: 1252.58 ms, GPU Bubble Ratio: 62.13%, 56.10%, 65.69%, 29.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  387-7-395ms    | [S4,MB1,B]  489-19-508ms   | [S4,MB4,F]  550-8-558ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  586-8-594ms    | [S4,MB3,B]  594-19-613ms   | [S4,MB6,F]  621-8-630ms    | [S0,MB0,B]  631-25-656ms   | [S4,MB7,F]  658-7-666ms    | [S0,MB1,B]  670-24-694ms   | [S0,MB2,B]  713-23-736ms   | [S0,MB3,B]  770-23-793ms   | [S4,MB4,B]  808-18-826ms   | [S4,MB5,B]  895-18-913ms   | [S4,MB6,B]  986-18-1004ms  | [S4,MB7,B]  1077-18-1095ms | [S0,MB4,B]  1112-23-1135ms | [S0,MB5,B]  1156-23-1179ms | [S0,MB6,B]  1192-23-1215ms | [S0,MB7,B]  1229-23-1252ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  274-7-281ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  361-12-374ms   | [S5,MB1,B]  377-19-396ms   | [S1,MB6,F]  396-11-408ms   | [S5,MB2,B]  488-18-507ms   | [S1,MB7,F]  507-11-518ms   | [S5,MB3,B]  559-19-578ms   | [S5,MB4,F]  578-7-586ms    | [S1,MB0,B]  594-29-623ms   | [S5,MB5,F]  623-9-632ms    | [S1,MB1,B]  632-30-662ms   | [S5,MB6,F]  663-10-673ms   | [S1,MB2,B]  673-32-706ms   | [S5,MB7,F]  706-10-717ms   | [S1,MB3,B]  717-34-751ms   | [S5,MB4,B]  782-18-801ms   | [S5,MB5,B]  870-18-889ms   | [S5,MB6,B]  961-18-979ms   | [S5,MB7,B]  1051-18-1070ms | [S1,MB4,B]  1078-27-1106ms | [S1,MB5,B]  1121-28-1149ms | [S1,MB6,B]  1156-28-1185ms | [S1,MB7,B]  1192-29-1221ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-192ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-294ms   | [S6,MB3,F]  295-8-303ms    | [S6,MB1,B]  351-19-371ms   | [S2,MB4,F]  371-8-379ms    | [S6,MB2,B]  441-19-461ms   | [S2,MB5,F]  461-7-468ms    | [S6,MB3,B]  531-19-551ms   | [S2,MB6,F]  550-8-559ms    | [S2,MB0,B]  566-19-586ms   | [S2,MB7,F]  586-8-594ms    | [S2,MB1,B]  602-19-622ms   | [S6,MB4,F]  621-8-630ms    | [S2,MB2,B]  636-19-656ms   | [S6,MB5,F]  656-7-664ms    | [S2,MB3,B]  670-20-691ms   | [S6,MB6,F]  691-7-698ms    | [S6,MB4,B]  756-19-776ms   | [S6,MB7,F]  776-8-784ms    | [S6,MB5,B]  845-18-864ms   | [S6,MB6,B]  936-18-954ms   | [S6,MB7,B]  1027-18-1045ms | [S2,MB4,B]  1053-18-1072ms | [S2,MB5,B]  1096-18-1114ms | [S2,MB6,B]  1120-18-1139ms | [S2,MB7,B]  1155-18-1174ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-6-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  259-18-277ms   | [S7,MB1,B]  289-56-345ms   | [S7,MB2,F]  345-21-366ms   | [S7,MB2,B]  377-57-435ms   | [S7,MB3,F]  435-21-456ms   | [S7,MB3,B]  467-57-525ms   | [S3,MB4,F]  525-12-537ms   | [S3,MB0,B]  536-24-560ms   | [S3,MB5,F]  560-10-571ms   | [S3,MB1,B]  571-23-595ms   | [S3,MB6,F]  595-10-606ms   | [S3,MB2,B]  606-23-629ms   | [S3,MB7,F]  630-10-640ms   | [S3,MB3,B]  640-22-663ms   | [S7,MB4,F]  663-18-682ms   | [S7,MB4,B]  693-56-749ms   | [S7,MB5,F]  750-21-771ms   | [S7,MB5,B]  782-57-840ms   | [S7,MB6,F]  839-21-860ms   | [S7,MB6,B]  872-57-930ms   | [S7,MB7,F]  930-21-951ms   | [S7,MB7,B]  963-57-1021ms  | [S3,MB4,B]  1020-26-1046ms | [S3,MB5,B]  1046-24-1070ms | [S3,MB6,B]  1070-24-1095ms | [S3,MB7,B]  1095-23-1119ms
[rank0]:2025-12-27 19:43:29,037 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 19:43:34,043 - Avg. fwd time: 7.8183 / Avg. bwd time: 18.9350 / Avg. batch time: 1153.8482 (ms) / GPU bubble ratio: 62.90%
[rank3]:2025-12-27 19:43:33,992 - Avg. fwd time: 14.2805 / Avg. bwd time: 40.3771 / Avg. batch time: 1091.1352 (ms) / GPU bubble ratio: 19.85%
[rank1]:2025-12-27 19:43:34,087 - Avg. fwd time: 9.9223 / Avg. bwd time: 24.3201 / Avg. batch time: 1213.4150 (ms) / GPU bubble ratio: 54.85%
[rank1]:2025-12-27 19:43:34,146 -  step: 250  loss: -4.0000  grad_norm:  3.4231  memory: 18.49GiB(38.93%)  tps: 6,395  tflops: 49.99  mfu: 16.02%
[rank2]:2025-12-27 19:43:34,142 -  step: 250  loss: -4.0000  grad_norm:  3.4231  memory: 12.06GiB(25.39%)  tps: 6,395  tflops: 49.99  mfu: 16.02%
[rank0]:2025-12-27 19:43:34,121 - Avg. fwd time: 8.2962 / Avg. bwd time: 21.1893 / Avg. batch time: 1252.3573 (ms) / GPU bubble ratio: 62.33%
[rank0]:2025-12-27 19:43:34,157 -  step: 250  loss: -4.0000  grad_norm:  3.4231  memory: 20.42GiB(42.99%)  tps: 6,395  tflops: 49.99  mfu: 16.02%
[rank3]:2025-12-27 19:43:34,155 -  step: 250  loss:  0.3579  grad_norm:  3.4231  memory: 29.23GiB(61.52%)  tps: 6,395  tflops: 50.00  mfu: 16.02%
[rank0]:2025-12-27 19:47:44,363 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 19:47:49,293 - Avg. fwd time: 14.2691 / Avg. bwd time: 40.3669 / Avg. batch time: 1090.7438 (ms) / GPU bubble ratio: 19.85%
[rank2]:2025-12-27 19:47:49,343 - Avg. fwd time: 7.8141 / Avg. bwd time: 18.9469 / Avg. batch time: 1153.3825 (ms) / GPU bubble ratio: 62.88%
[rank1]:2025-12-27 19:47:49,388 - Avg. fwd time: 9.9180 / Avg. bwd time: 24.3325 / Avg. batch time: 1212.9263 (ms) / GPU bubble ratio: 54.82%
[rank2]:2025-12-27 19:47:49,444 -  step: 300  loss: -4.0000  grad_norm:  0.5174  memory: 12.06GiB(25.39%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank1]:2025-12-27 19:47:49,447 -  step: 300  loss: -4.0000  grad_norm:  0.5174  memory: 18.49GiB(38.93%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank3]:2025-12-27 19:47:49,456 -  step: 300  loss:  0.2509  grad_norm:  0.5174  memory: 29.23GiB(61.52%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank0]:2025-12-27 19:47:49,422 - Avg. fwd time: 8.2935 / Avg. bwd time: 21.1980 / Avg. batch time: 1251.8659 (ms) / GPU bubble ratio: 62.31%
[rank0]:2025-12-27 19:47:49,458 -  step: 300  loss: -4.0000  grad_norm:  0.5174  memory: 20.42GiB(42.99%)  tps: 6,418  tflops: 50.17  mfu: 16.08%
[rank3]:2025-12-27 19:47:49,705 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_1947_step300_rank3.svg
[rank3]:			> Batch Time: 1247.52 ms, GPU Bubble Ratio: 62.10%, 55.97%, 65.64%, 29.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-132ms    | [S4,MB3,F]  161-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  367-19-386ms   | [S0,MB7,F]  386-7-393ms    | [S4,MB1,B]  486-19-505ms   | [S4,MB4,F]  548-8-556ms    | [S4,MB2,B]  556-19-575ms   | [S4,MB5,F]  583-8-591ms    | [S4,MB3,B]  592-19-611ms   | [S4,MB6,F]  618-8-626ms    | [S0,MB0,B]  628-25-653ms   | [S4,MB7,F]  654-7-662ms    | [S0,MB1,B]  667-24-692ms   | [S0,MB2,B]  710-23-733ms   | [S0,MB3,B]  765-23-788ms   | [S4,MB4,B]  803-18-821ms   | [S4,MB5,B]  892-18-910ms   | [S4,MB6,B]  981-18-999ms   | [S4,MB7,B]  1072-18-1090ms | [S0,MB4,B]  1107-23-1130ms | [S0,MB5,B]  1151-23-1174ms | [S0,MB6,B]  1187-23-1210ms | [S0,MB7,B]  1224-23-1247ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-97ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  161-8-169ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  274-7-281ms    | [S1,MB4,F]  303-10-314ms   | [S5,MB0,B]  314-19-333ms   | [S1,MB5,F]  360-12-372ms   | [S5,MB1,B]  376-19-395ms   | [S1,MB6,F]  395-11-406ms   | [S5,MB2,B]  486-18-504ms   | [S1,MB7,F]  505-11-516ms   | [S5,MB3,B]  556-19-575ms   | [S5,MB4,F]  575-7-583ms    | [S1,MB0,B]  591-29-620ms   | [S5,MB5,F]  620-9-629ms    | [S1,MB1,B]  630-30-660ms   | [S5,MB6,F]  660-10-670ms   | [S1,MB2,B]  670-32-703ms   | [S5,MB7,F]  703-10-713ms   | [S1,MB3,B]  713-34-747ms   | [S5,MB4,B]  778-18-796ms   | [S5,MB5,B]  867-18-885ms   | [S5,MB6,B]  956-18-974ms   | [S5,MB7,B]  1047-18-1065ms | [S1,MB4,B]  1072-27-1100ms | [S1,MB5,B]  1115-28-1143ms | [S1,MB6,B]  1150-28-1178ms | [S1,MB7,B]  1186-30-1217ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  97-7-104ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  169-7-177ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  267-7-275ms    | [S6,MB0,B]  274-19-294ms   | [S6,MB3,F]  293-8-302ms    | [S6,MB1,B]  350-19-369ms   | [S2,MB4,F]  369-8-378ms    | [S6,MB2,B]  439-19-458ms   | [S2,MB5,F]  458-7-466ms    | [S6,MB3,B]  528-19-547ms   | [S2,MB6,F]  547-8-556ms    | [S2,MB0,B]  563-19-583ms   | [S2,MB7,F]  583-8-592ms    | [S2,MB1,B]  598-19-617ms   | [S6,MB4,F]  618-8-626ms    | [S2,MB2,B]  632-19-652ms   | [S6,MB5,F]  652-7-659ms    | [S2,MB3,B]  668-20-688ms   | [S6,MB6,F]  688-7-696ms    | [S6,MB4,B]  751-19-771ms   | [S6,MB7,F]  771-8-779ms    | [S6,MB5,B]  841-18-860ms   | [S6,MB6,B]  932-18-950ms   | [S6,MB7,B]  1023-18-1041ms | [S2,MB4,B]  1048-18-1067ms | [S2,MB5,B]  1091-18-1109ms | [S2,MB6,B]  1116-18-1134ms | [S2,MB7,B]  1150-18-1168ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  104-6-111ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-258ms   | [S7,MB1,F]  258-18-277ms   | [S7,MB1,B]  288-55-344ms   | [S7,MB2,F]  343-21-364ms   | [S7,MB2,B]  375-56-432ms   | [S7,MB3,F]  432-21-453ms   | [S7,MB3,B]  464-57-522ms   | [S3,MB4,F]  521-12-533ms   | [S3,MB0,B]  534-24-558ms   | [S3,MB5,F]  557-10-568ms   | [S3,MB1,B]  568-23-591ms   | [S3,MB6,F]  591-10-602ms   | [S3,MB2,B]  602-23-626ms   | [S3,MB7,F]  626-10-636ms   | [S3,MB3,B]  636-22-658ms   | [S7,MB4,F]  658-18-676ms   | [S7,MB4,B]  689-56-745ms   | [S7,MB5,F]  745-21-766ms   | [S7,MB5,B]  778-56-835ms   | [S7,MB6,F]  835-20-856ms   | [S7,MB6,B]  868-57-926ms   | [S7,MB7,F]  925-21-946ms   | [S7,MB7,B]  958-57-1016ms  | [S3,MB4,B]  1016-25-1042ms | [S3,MB5,B]  1041-24-1066ms | [S3,MB6,B]  1066-24-1091ms | [S3,MB7,B]  1090-23-1114ms
[rank0]:2025-12-27 19:51:59,958 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 19:52:04,948 - Avg. fwd time: 14.2658 / Avg. bwd time: 40.3593 / Avg. batch time: 1090.5454 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 19:52:05,003 - Avg. fwd time: 7.8115 / Avg. bwd time: 18.9527 / Avg. batch time: 1153.3125 (ms) / GPU bubble ratio: 62.87%
[rank1]:2025-12-27 19:52:05,048 - Avg. fwd time: 9.9181 / Avg. bwd time: 24.3426 / Avg. batch time: 1212.8228 (ms) / GPU bubble ratio: 54.80%
[rank1]:2025-12-27 19:52:05,108 -  step: 350  loss: -4.0000  grad_norm:  0.1990  memory: 18.49GiB(38.93%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank3]:2025-12-27 19:52:05,117 -  step: 350  loss:  0.2106  grad_norm:  0.1990  memory: 29.23GiB(61.52%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-27 19:52:05,083 - Avg. fwd time: 8.2909 / Avg. bwd time: 21.2018 / Avg. batch time: 1251.7577 (ms) / GPU bubble ratio: 62.30%
[rank0]:2025-12-27 19:52:05,119 -  step: 350  loss: -4.0000  grad_norm:  0.1990  memory: 20.42GiB(42.99%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank2]:2025-12-27 19:52:05,105 -  step: 350  loss: -4.0000  grad_norm:  0.1990  memory: 12.06GiB(25.39%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-27 19:56:15,199 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 19:56:20,200 - Avg. fwd time: 14.2622 / Avg. bwd time: 40.3483 / Avg. batch time: 1090.2993 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 19:56:20,250 - Avg. fwd time: 7.8096 / Avg. bwd time: 18.9555 / Avg. batch time: 1153.0058 (ms) / GPU bubble ratio: 62.86%
[rank1]:2025-12-27 19:56:20,292 - Avg. fwd time: 9.9179 / Avg. bwd time: 24.3480 / Avg. batch time: 1212.5019 (ms) / GPU bubble ratio: 54.78%
[rank1]:2025-12-27 19:56:20,352 -  step: 400  loss: -4.0000  grad_norm:  0.1737  memory: 18.49GiB(38.93%)  tps: 6,419  tflops: 50.18  mfu: 16.08%
[rank0]:2025-12-27 19:56:20,327 - Avg. fwd time: 8.2886 / Avg. bwd time: 21.2018 / Avg. batch time: 1251.4324 (ms) / GPU bubble ratio: 62.30%
[rank0]:2025-12-27 19:56:20,363 -  step: 400  loss: -4.0000  grad_norm:  0.1737  memory: 20.42GiB(42.99%)  tps: 6,419  tflops: 50.18  mfu: 16.08%
[rank2]:2025-12-27 19:56:20,349 -  step: 400  loss: -4.0000  grad_norm:  0.1737  memory: 12.06GiB(25.39%)  tps: 6,419  tflops: 50.18  mfu: 16.08%
[rank3]:2025-12-27 19:56:20,360 -  step: 400  loss:  0.2043  grad_norm:  0.1737  memory: 29.23GiB(61.52%)  tps: 6,419  tflops: 50.18  mfu: 16.08%
[rank3]:2025-12-27 19:56:20,611 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_1956_step400_rank3.svg
[rank3]:			> Batch Time: 1251.48 ms, GPU Bubble Ratio: 62.20%, 55.98%, 65.72%, 29.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  387-7-394ms    | [S4,MB1,B]  488-19-507ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  585-8-593ms    | [S4,MB3,B]  593-19-612ms   | [S4,MB6,F]  620-8-628ms    | [S0,MB0,B]  630-25-655ms   | [S4,MB7,F]  656-7-664ms    | [S0,MB1,B]  669-24-693ms   | [S0,MB2,B]  711-23-735ms   | [S0,MB3,B]  767-23-790ms   | [S4,MB4,B]  805-18-823ms   | [S4,MB5,B]  894-18-912ms   | [S4,MB6,B]  984-18-1002ms  | [S4,MB7,B]  1075-18-1093ms | [S0,MB4,B]  1111-23-1134ms | [S0,MB5,B]  1155-23-1178ms | [S0,MB6,B]  1191-23-1214ms | [S0,MB7,B]  1228-23-1251ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-18-334ms   | [S1,MB5,F]  361-12-373ms   | [S5,MB1,B]  376-19-395ms   | [S1,MB6,F]  395-11-407ms   | [S5,MB2,B]  488-18-507ms   | [S1,MB7,F]  507-11-518ms   | [S5,MB3,B]  559-19-578ms   | [S5,MB4,F]  578-7-586ms    | [S1,MB0,B]  593-29-622ms   | [S5,MB5,F]  622-9-631ms    | [S1,MB1,B]  631-30-661ms   | [S5,MB6,F]  662-10-672ms   | [S1,MB2,B]  672-32-704ms   | [S5,MB7,F]  704-10-715ms   | [S1,MB3,B]  715-33-748ms   | [S5,MB4,B]  779-18-798ms   | [S5,MB5,B]  869-18-887ms   | [S5,MB6,B]  959-18-977ms   | [S5,MB7,B]  1050-18-1068ms | [S1,MB4,B]  1076-27-1104ms | [S1,MB5,B]  1119-28-1147ms | [S1,MB6,B]  1154-28-1183ms | [S1,MB7,B]  1190-30-1221ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-295ms   | [S6,MB3,F]  295-8-303ms    | [S6,MB1,B]  351-19-370ms   | [S2,MB4,F]  370-8-378ms    | [S6,MB2,B]  440-19-459ms   | [S2,MB5,F]  460-7-467ms    | [S6,MB3,B]  531-19-550ms   | [S2,MB6,F]  550-8-559ms    | [S2,MB0,B]  565-19-585ms   | [S2,MB7,F]  584-8-593ms    | [S2,MB1,B]  600-19-620ms   | [S6,MB4,F]  620-8-629ms    | [S2,MB2,B]  634-19-654ms   | [S6,MB5,F]  654-7-662ms    | [S2,MB3,B]  670-20-690ms   | [S6,MB6,F]  690-7-697ms    | [S6,MB4,B]  753-19-772ms   | [S6,MB7,F]  772-8-781ms    | [S6,MB5,B]  844-18-863ms   | [S6,MB6,B]  935-18-953ms   | [S6,MB7,B]  1026-18-1044ms | [S2,MB4,B]  1051-18-1070ms | [S2,MB5,B]  1094-18-1112ms | [S2,MB6,B]  1119-18-1138ms | [S2,MB7,B]  1154-18-1173ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  289-55-344ms   | [S7,MB2,F]  344-21-365ms   | [S7,MB2,B]  377-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  466-57-524ms   | [S3,MB4,F]  525-12-537ms   | [S3,MB0,B]  536-24-560ms   | [S3,MB5,F]  559-10-570ms   | [S3,MB1,B]  570-23-594ms   | [S3,MB6,F]  593-10-604ms   | [S3,MB2,B]  604-23-627ms   | [S3,MB7,F]  627-10-638ms   | [S3,MB3,B]  637-22-660ms   | [S7,MB4,F]  660-18-678ms   | [S7,MB4,B]  690-56-746ms   | [S7,MB5,F]  746-21-767ms   | [S7,MB5,B]  780-57-837ms   | [S7,MB6,F]  838-21-859ms   | [S7,MB6,B]  870-57-928ms   | [S7,MB7,F]  928-21-949ms   | [S7,MB7,B]  961-57-1018ms  | [S3,MB4,B]  1019-26-1045ms | [S3,MB5,B]  1045-24-1069ms | [S3,MB6,B]  1069-24-1094ms | [S3,MB7,B]  1094-23-1118ms
[rank3]:2025-12-27 19:56:49,365 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-27 19:56:49,811 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-27 19:56:49,847 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-27 19:56:49,872 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-27 20:00:30,631 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 20:00:35,642 - Avg. fwd time: 7.8077 / Avg. bwd time: 18.9579 / Avg. batch time: 1152.9060 (ms) / GPU bubble ratio: 62.85%
[rank3]:2025-12-27 20:00:35,592 - Avg. fwd time: 14.2605 / Avg. bwd time: 40.3407 / Avg. batch time: 1090.1320 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 20:00:35,740 -  step: 450  loss: -4.0000  grad_norm:  0.2087  memory: 12.06GiB(25.39%)  tps: 6,415  tflops: 50.15  mfu: 16.07%
[rank3]:2025-12-27 20:00:35,753 -  step: 450  loss:  0.2182  grad_norm:  0.2087  memory: 29.23GiB(61.52%)  tps: 6,415  tflops: 50.15  mfu: 16.07%
[rank1]:2025-12-27 20:00:35,683 - Avg. fwd time: 9.9147 / Avg. bwd time: 24.3489 / Avg. batch time: 1212.4033 (ms) / GPU bubble ratio: 54.78%
[rank1]:2025-12-27 20:00:35,744 -  step: 450  loss: -4.0000  grad_norm:  0.2087  memory: 18.49GiB(38.93%)  tps: 6,415  tflops: 50.15  mfu: 16.07%
[rank0]:2025-12-27 20:00:35,719 - Avg. fwd time: 8.2875 / Avg. bwd time: 21.2035 / Avg. batch time: 1251.3307 (ms) / GPU bubble ratio: 62.29%
[rank0]:2025-12-27 20:00:35,754 -  step: 450  loss: -4.0000  grad_norm:  0.2087  memory: 20.42GiB(42.99%)  tps: 6,415  tflops: 50.15  mfu: 16.07%
[rank0]:2025-12-27 20:04:45,638 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 20:04:50,571 - Avg. fwd time: 14.2568 / Avg. bwd time: 40.3278 / Avg. batch time: 1089.8472 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 20:04:50,621 - Avg. fwd time: 7.8062 / Avg. bwd time: 18.9589 / Avg. batch time: 1152.5876 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-12-27 20:04:50,663 - Avg. fwd time: 9.9127 / Avg. bwd time: 24.3473 / Avg. batch time: 1212.0620 (ms) / GPU bubble ratio: 54.77%
[rank0]:2025-12-27 20:04:50,700 - Avg. fwd time: 8.2863 / Avg. bwd time: 21.2042 / Avg. batch time: 1250.9874 (ms) / GPU bubble ratio: 62.28%
[rank2]:2025-12-27 20:04:50,721 -  step: 500  loss: -4.0000  grad_norm:  0.1912  memory: 12.06GiB(25.39%)  tps: 6,426  tflops: 50.23  mfu: 16.10%
[rank3]:2025-12-27 20:04:50,733 -  step: 500  loss:  0.2103  grad_norm:  0.1912  memory: 29.23GiB(61.52%)  tps: 6,426  tflops: 50.23  mfu: 16.10%
[rank1]:2025-12-27 20:04:50,725 -  step: 500  loss: -4.0000  grad_norm:  0.1912  memory: 18.49GiB(38.93%)  tps: 6,426  tflops: 50.23  mfu: 16.10%
[rank0]:2025-12-27 20:04:50,736 -  step: 500  loss: -4.0000  grad_norm:  0.1912  memory: 20.42GiB(42.99%)  tps: 6,426  tflops: 50.23  mfu: 16.10%
[rank3]:2025-12-27 20:04:50,984 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_2004_step500_rank3.svg
[rank3]:			> Batch Time: 1244.50 ms, GPU Bubble Ratio: 61.98%, 56.09%, 65.55%, 29.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  367-19-386ms   | [S0,MB7,F]  385-7-393ms    | [S4,MB1,B]  488-19-507ms   | [S4,MB4,F]  550-8-558ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  584-8-593ms    | [S4,MB3,B]  593-19-612ms   | [S4,MB6,F]  619-8-628ms    | [S0,MB0,B]  629-25-654ms   | [S4,MB7,F]  655-7-663ms    | [S0,MB1,B]  667-24-691ms   | [S0,MB2,B]  709-23-732ms   | [S0,MB3,B]  766-23-789ms   | [S4,MB4,B]  804-18-822ms   | [S4,MB5,B]  892-18-910ms   | [S4,MB6,B]  981-18-999ms   | [S4,MB7,B]  1072-18-1090ms | [S0,MB4,B]  1107-23-1130ms | [S0,MB5,B]  1151-23-1174ms | [S0,MB6,B]  1185-23-1208ms | [S0,MB7,B]  1221-23-1244ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  273-7-281ms    | [S1,MB4,F]  303-10-314ms   | [S5,MB0,B]  314-18-333ms   | [S1,MB5,F]  360-12-372ms   | [S5,MB1,B]  375-19-394ms   | [S1,MB6,F]  394-11-406ms   | [S5,MB2,B]  488-18-507ms   | [S1,MB7,F]  507-11-518ms   | [S5,MB3,B]  558-19-577ms   | [S5,MB4,F]  578-7-585ms    | [S1,MB0,B]  593-29-622ms   | [S5,MB5,F]  621-9-630ms    | [S1,MB1,B]  630-30-660ms   | [S5,MB6,F]  660-9-670ms    | [S1,MB2,B]  670-32-702ms   | [S5,MB7,F]  702-10-713ms   | [S1,MB3,B]  712-33-746ms   | [S5,MB4,B]  779-18-797ms   | [S5,MB5,B]  867-18-885ms   | [S5,MB6,B]  956-18-974ms   | [S5,MB7,B]  1047-18-1065ms | [S1,MB4,B]  1072-27-1100ms | [S1,MB5,B]  1116-27-1144ms | [S1,MB6,B]  1150-28-1178ms | [S1,MB7,B]  1184-29-1213ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  97-7-104ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  267-7-274ms    | [S6,MB0,B]  274-19-294ms   | [S6,MB3,F]  294-8-302ms    | [S6,MB1,B]  350-19-369ms   | [S2,MB4,F]  369-8-377ms    | [S6,MB2,B]  440-19-460ms   | [S2,MB5,F]  460-7-467ms    | [S6,MB3,B]  530-19-550ms   | [S2,MB6,F]  550-8-558ms    | [S2,MB0,B]  565-19-585ms   | [S2,MB7,F]  584-8-593ms    | [S2,MB1,B]  600-19-620ms   | [S6,MB4,F]  620-8-628ms    | [S2,MB2,B]  634-19-654ms   | [S6,MB5,F]  654-7-661ms    | [S2,MB3,B]  668-20-688ms   | [S6,MB6,F]  688-7-696ms    | [S6,MB4,B]  753-19-772ms   | [S6,MB7,F]  772-8-781ms    | [S6,MB5,B]  842-18-860ms   | [S6,MB6,B]  931-18-949ms   | [S6,MB7,B]  1023-17-1041ms | [S2,MB4,B]  1048-18-1066ms | [S2,MB5,B]  1091-18-1109ms | [S2,MB6,B]  1115-18-1133ms | [S2,MB7,B]  1150-18-1169ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-111ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-258ms   | [S7,MB1,F]  258-18-277ms   | [S7,MB1,B]  288-55-343ms   | [S7,MB2,F]  343-21-364ms   | [S7,MB2,B]  376-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  466-57-524ms   | [S3,MB4,F]  524-11-536ms   | [S3,MB0,B]  535-24-559ms   | [S3,MB5,F]  559-10-570ms   | [S3,MB1,B]  570-23-594ms   | [S3,MB6,F]  593-10-604ms   | [S3,MB2,B]  604-23-627ms   | [S3,MB7,F]  627-10-638ms   | [S3,MB3,B]  638-22-660ms   | [S7,MB4,F]  660-18-679ms   | [S7,MB4,B]  690-55-746ms   | [S7,MB5,F]  746-21-767ms   | [S7,MB5,B]  778-57-835ms   | [S7,MB6,F]  835-21-856ms   | [S7,MB6,B]  868-57-925ms   | [S7,MB7,F]  925-21-946ms   | [S7,MB7,B]  958-57-1016ms  | [S3,MB4,B]  1015-25-1041ms | [S3,MB5,B]  1039-24-1064ms | [S3,MB6,B]  1064-24-1089ms | [S3,MB7,B]  1088-23-1112ms
[rank0]:2025-12-27 20:09:01,214 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 20:09:06,203 - Avg. fwd time: 14.2564 / Avg. bwd time: 40.3257 / Avg. batch time: 1089.7984 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 20:09:06,254 - Avg. fwd time: 7.8053 / Avg. bwd time: 18.9594 / Avg. batch time: 1152.5918 (ms) / GPU bubble ratio: 62.85%
[rank0]:2025-12-27 20:09:06,339 - Avg. fwd time: 8.2855 / Avg. bwd time: 21.2043 / Avg. batch time: 1250.9888 (ms) / GPU bubble ratio: 62.28%
[rank1]:2025-12-27 20:09:06,302 - Avg. fwd time: 9.9119 / Avg. bwd time: 24.3486 / Avg. batch time: 1212.0653 (ms) / GPU bubble ratio: 54.77%
[rank2]:2025-12-27 20:09:06,361 -  step: 550  loss: -4.0000  grad_norm:  0.1815  memory: 12.06GiB(25.39%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-27 20:09:06,375 -  step: 550  loss: -4.0000  grad_norm:  0.1815  memory: 20.42GiB(42.99%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank1]:2025-12-27 20:09:06,364 -  step: 550  loss: -4.0000  grad_norm:  0.1815  memory: 18.49GiB(38.93%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank3]:2025-12-27 20:09:06,373 -  step: 550  loss:  0.2205  grad_norm:  0.1815  memory: 29.23GiB(61.52%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-27 20:13:16,702 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 20:13:21,740 - Avg. fwd time: 14.2550 / Avg. bwd time: 40.3258 / Avg. batch time: 1089.7714 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 20:13:21,791 - Avg. fwd time: 7.8048 / Avg. bwd time: 18.9598 / Avg. batch time: 1152.5199 (ms) / GPU bubble ratio: 62.84%
[rank1]:2025-12-27 20:13:21,838 - Avg. fwd time: 9.9112 / Avg. bwd time: 24.3512 / Avg. batch time: 1212.0128 (ms) / GPU bubble ratio: 54.77%
[rank0]:2025-12-27 20:13:21,875 - Avg. fwd time: 8.2854 / Avg. bwd time: 21.2048 / Avg. batch time: 1250.9373 (ms) / GPU bubble ratio: 62.28%
[rank0]:2025-12-27 20:13:21,911 -  step: 600  loss: -4.0000  grad_norm:  0.1802  memory: 20.42GiB(42.99%)  tps: 6,412  tflops: 50.12  mfu: 16.07%
[rank3]:2025-12-27 20:13:21,909 -  step: 600  loss:  0.2128  grad_norm:  0.1802  memory: 29.23GiB(61.52%)  tps: 6,412  tflops: 50.12  mfu: 16.07%
[rank2]:2025-12-27 20:13:21,897 -  step: 600  loss: -4.0000  grad_norm:  0.1802  memory: 12.06GiB(25.39%)  tps: 6,412  tflops: 50.12  mfu: 16.07%
[rank1]:2025-12-27 20:13:21,900 -  step: 600  loss: -4.0000  grad_norm:  0.1802  memory: 18.49GiB(38.93%)  tps: 6,412  tflops: 50.12  mfu: 16.07%
[rank3]:2025-12-27 20:13:22,167 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_2013_step600_rank3.svg
[rank3]:			> Batch Time: 1249.50 ms, GPU Bubble Ratio: 62.11%, 55.96%, 65.67%, 29.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-179ms    | [S0,MB5,F]  179-7-186ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  386-7-394ms    | [S4,MB1,B]  490-19-509ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  560-19-579ms   | [S4,MB5,F]  586-8-595ms    | [S4,MB3,B]  595-19-614ms   | [S4,MB6,F]  621-8-630ms    | [S0,MB0,B]  631-25-656ms   | [S4,MB7,F]  658-7-665ms    | [S0,MB1,B]  670-24-695ms   | [S0,MB2,B]  713-23-736ms   | [S0,MB3,B]  768-23-791ms   | [S4,MB4,B]  806-18-824ms   | [S4,MB5,B]  893-18-911ms   | [S4,MB6,B]  983-18-1001ms  | [S4,MB7,B]  1074-18-1092ms | [S0,MB4,B]  1110-23-1133ms | [S0,MB5,B]  1153-23-1176ms | [S0,MB6,B]  1189-23-1212ms | [S0,MB7,B]  1226-23-1249ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  274-7-282ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-18-334ms   | [S1,MB5,F]  361-12-373ms   | [S5,MB1,B]  376-18-395ms   | [S1,MB6,F]  395-11-407ms   | [S5,MB2,B]  489-18-508ms   | [S1,MB7,F]  508-11-519ms   | [S5,MB3,B]  559-19-578ms   | [S5,MB4,F]  578-7-586ms    | [S1,MB0,B]  594-29-623ms   | [S5,MB5,F]  623-9-632ms    | [S1,MB1,B]  633-30-663ms   | [S5,MB6,F]  663-10-673ms   | [S1,MB2,B]  673-32-706ms   | [S5,MB7,F]  706-10-716ms   | [S1,MB3,B]  716-34-750ms   | [S5,MB4,B]  781-18-799ms   | [S5,MB5,B]  868-18-886ms   | [S5,MB6,B]  958-18-976ms   | [S5,MB7,B]  1049-18-1067ms | [S1,MB4,B]  1075-27-1103ms | [S1,MB5,B]  1118-27-1146ms | [S1,MB6,B]  1152-29-1181ms | [S1,MB7,B]  1188-30-1218ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-295ms   | [S6,MB3,F]  295-8-303ms    | [S6,MB1,B]  351-19-370ms   | [S2,MB4,F]  370-8-378ms    | [S6,MB2,B]  441-19-460ms   | [S2,MB5,F]  460-7-467ms    | [S6,MB3,B]  531-19-550ms   | [S2,MB6,F]  550-8-559ms    | [S2,MB0,B]  567-19-587ms   | [S2,MB7,F]  586-8-595ms    | [S2,MB1,B]  602-19-622ms   | [S6,MB4,F]  621-8-630ms    | [S2,MB2,B]  636-19-656ms   | [S6,MB5,F]  656-7-663ms    | [S2,MB3,B]  671-20-691ms   | [S6,MB6,F]  691-7-699ms    | [S6,MB4,B]  755-19-774ms   | [S6,MB7,F]  774-8-783ms    | [S6,MB5,B]  843-18-862ms   | [S6,MB6,B]  933-18-951ms   | [S6,MB7,B]  1024-17-1042ms | [S2,MB4,B]  1050-18-1068ms | [S2,MB5,B]  1093-18-1111ms | [S2,MB6,B]  1118-18-1136ms | [S2,MB7,B]  1152-18-1171ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  259-18-278ms   | [S7,MB1,B]  289-55-345ms   | [S7,MB2,F]  344-21-365ms   | [S7,MB2,B]  377-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  467-57-525ms   | [S3,MB4,F]  525-12-537ms   | [S3,MB0,B]  536-24-561ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  572-23-596ms   | [S3,MB6,F]  595-10-606ms   | [S3,MB2,B]  606-23-629ms   | [S3,MB7,F]  629-10-640ms   | [S3,MB3,B]  640-22-662ms   | [S7,MB4,F]  662-18-680ms   | [S7,MB4,B]  692-56-748ms   | [S7,MB5,F]  748-21-769ms   | [S7,MB5,B]  780-57-838ms   | [S7,MB6,F]  837-21-858ms   | [S7,MB6,B]  870-57-927ms   | [S7,MB7,F]  927-21-948ms   | [S7,MB7,B]  959-57-1017ms  | [S3,MB4,B]  1017-26-1043ms | [S3,MB5,B]  1043-24-1068ms | [S3,MB6,B]  1067-24-1092ms | [S3,MB7,B]  1092-23-1116ms
[rank0]:2025-12-27 20:17:32,825 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 20:17:37,812 - Avg. fwd time: 14.2557 / Avg. bwd time: 40.3298 / Avg. batch time: 1089.8398 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 20:17:37,863 - Avg. fwd time: 7.8046 / Avg. bwd time: 18.9612 / Avg. batch time: 1152.6413 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-12-27 20:17:37,905 - Avg. fwd time: 9.9101 / Avg. bwd time: 24.3525 / Avg. batch time: 1212.1313 (ms) / GPU bubble ratio: 54.77%
[rank2]:2025-12-27 20:17:37,965 -  step: 650  loss: -4.0000  grad_norm:  0.1724  memory: 12.06GiB(25.39%)  tps: 6,398  tflops: 50.02  mfu: 16.03%
[rank0]:2025-12-27 20:17:37,943 - Avg. fwd time: 8.2852 / Avg. bwd time: 21.2058 / Avg. batch time: 1251.0569 (ms) / GPU bubble ratio: 62.28%
[rank0]:2025-12-27 20:17:37,980 -  step: 650  loss: -4.0000  grad_norm:  0.1724  memory: 20.42GiB(42.99%)  tps: 6,398  tflops: 50.02  mfu: 16.03%
[rank3]:2025-12-27 20:17:37,977 -  step: 650  loss:  0.2222  grad_norm:  0.1724  memory: 29.23GiB(61.52%)  tps: 6,398  tflops: 50.02  mfu: 16.03%
[rank1]:2025-12-27 20:17:37,968 -  step: 650  loss: -4.0000  grad_norm:  0.1724  memory: 18.49GiB(38.93%)  tps: 6,398  tflops: 50.02  mfu: 16.03%
[rank0]:2025-12-27 20:21:48,588 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 20:21:53,603 - Avg. fwd time: 7.8044 / Avg. bwd time: 18.9614 / Avg. batch time: 1152.6873 (ms) / GPU bubble ratio: 62.85%
[rank3]:2025-12-27 20:21:53,553 - Avg. fwd time: 14.2581 / Avg. bwd time: 40.3323 / Avg. batch time: 1089.9183 (ms) / GPU bubble ratio: 19.86%
[rank1]:2025-12-27 20:21:53,647 - Avg. fwd time: 9.9088 / Avg. bwd time: 24.3513 / Avg. batch time: 1212.1716 (ms) / GPU bubble ratio: 54.78%
[rank2]:2025-12-27 20:21:53,707 -  step: 700  loss: -4.0000  grad_norm:  0.1622  memory: 12.06GiB(25.39%)  tps: 6,406  tflops: 50.08  mfu: 16.05%
[rank0]:2025-12-27 20:21:53,686 - Avg. fwd time: 8.2843 / Avg. bwd time: 21.2066 / Avg. batch time: 1251.0980 (ms) / GPU bubble ratio: 62.28%
[rank0]:2025-12-27 20:21:53,722 -  step: 700  loss: -4.0000  grad_norm:  0.1622  memory: 20.42GiB(42.99%)  tps: 6,406  tflops: 50.08  mfu: 16.05%
[rank3]:2025-12-27 20:21:53,719 -  step: 700  loss:  0.1795  grad_norm:  0.1622  memory: 29.23GiB(61.52%)  tps: 6,407  tflops: 50.08  mfu: 16.05%
[rank1]:2025-12-27 20:21:53,711 -  step: 700  loss: -4.0000  grad_norm:  0.1622  memory: 18.49GiB(38.93%)  tps: 6,406  tflops: 50.08  mfu: 16.05%
[rank3]:2025-12-27 20:21:53,974 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_2021_step700_rank3.svg
[rank3]:			> Batch Time: 1252.50 ms, GPU Bubble Ratio: 62.25%, 56.21%, 65.77%, 29.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  86-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  369-19-388ms   | [S0,MB7,F]  387-7-395ms    | [S4,MB1,B]  490-19-509ms   | [S4,MB4,F]  551-8-559ms    | [S4,MB2,B]  560-19-579ms   | [S4,MB5,F]  586-8-595ms    | [S4,MB3,B]  595-19-614ms   | [S4,MB6,F]  621-8-630ms    | [S0,MB0,B]  631-25-656ms   | [S4,MB7,F]  657-7-664ms    | [S0,MB1,B]  670-24-695ms   | [S0,MB2,B]  714-23-737ms   | [S0,MB3,B]  768-23-791ms   | [S4,MB4,B]  806-18-824ms   | [S4,MB5,B]  894-18-912ms   | [S4,MB6,B]  985-18-1003ms  | [S4,MB7,B]  1075-18-1093ms | [S0,MB4,B]  1110-23-1133ms | [S0,MB5,B]  1155-23-1178ms | [S0,MB6,B]  1191-23-1214ms | [S0,MB7,B]  1229-23-1252ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  86-10-97ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  274-7-281ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  362-12-374ms   | [S5,MB1,B]  377-19-396ms   | [S1,MB6,F]  396-11-408ms   | [S5,MB2,B]  489-18-508ms   | [S1,MB7,F]  508-11-519ms   | [S5,MB3,B]  560-19-579ms   | [S5,MB4,F]  579-7-587ms    | [S1,MB0,B]  595-29-624ms   | [S5,MB5,F]  623-9-632ms    | [S1,MB1,B]  632-30-662ms   | [S5,MB6,F]  664-10-674ms   | [S1,MB2,B]  674-32-706ms   | [S5,MB7,F]  707-10-717ms   | [S1,MB3,B]  717-33-751ms   | [S5,MB4,B]  781-18-799ms   | [S5,MB5,B]  869-18-887ms   | [S5,MB6,B]  960-18-978ms   | [S5,MB7,B]  1050-18-1068ms | [S1,MB4,B]  1076-27-1104ms | [S1,MB5,B]  1119-27-1147ms | [S1,MB6,B]  1154-28-1183ms | [S1,MB7,B]  1190-29-1220ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  97-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-294ms   | [S6,MB3,F]  294-8-303ms    | [S6,MB1,B]  351-19-371ms   | [S2,MB4,F]  371-8-379ms    | [S6,MB2,B]  441-19-461ms   | [S2,MB5,F]  461-7-468ms    | [S6,MB3,B]  532-19-551ms   | [S2,MB6,F]  551-8-560ms    | [S2,MB0,B]  567-19-586ms   | [S2,MB7,F]  586-8-594ms    | [S2,MB1,B]  602-19-622ms   | [S6,MB4,F]  622-8-630ms    | [S2,MB2,B]  636-19-656ms   | [S6,MB5,F]  656-7-663ms    | [S2,MB3,B]  671-20-691ms   | [S6,MB6,F]  691-7-698ms    | [S6,MB4,B]  755-19-774ms   | [S6,MB7,F]  774-8-782ms    | [S6,MB5,B]  844-18-863ms   | [S6,MB6,B]  935-18-953ms   | [S6,MB7,B]  1026-18-1044ms | [S2,MB4,B]  1051-18-1069ms | [S2,MB5,B]  1095-18-1113ms | [S2,MB6,B]  1120-18-1139ms | [S2,MB7,B]  1154-18-1173ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  104-6-111ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  258-19-277ms   | [S7,MB1,B]  289-55-345ms   | [S7,MB2,F]  345-21-366ms   | [S7,MB2,B]  377-57-434ms   | [S7,MB3,F]  435-21-456ms   | [S7,MB3,B]  467-57-525ms   | [S3,MB4,F]  525-12-537ms   | [S3,MB0,B]  537-24-562ms   | [S3,MB5,F]  561-10-572ms   | [S3,MB1,B]  571-23-595ms   | [S3,MB6,F]  595-10-606ms   | [S3,MB2,B]  606-23-629ms   | [S3,MB7,F]  629-10-640ms   | [S3,MB3,B]  639-22-662ms   | [S7,MB4,F]  662-18-681ms   | [S7,MB4,B]  692-56-748ms   | [S7,MB5,F]  748-21-769ms   | [S7,MB5,B]  781-57-838ms   | [S7,MB6,F]  838-21-859ms   | [S7,MB6,B]  871-57-929ms   | [S7,MB7,F]  929-21-950ms   | [S7,MB7,B]  961-57-1018ms  | [S3,MB4,B]  1019-26-1045ms | [S3,MB5,B]  1043-24-1068ms | [S3,MB6,B]  1068-24-1093ms | [S3,MB7,B]  1093-23-1117ms
[rank0]:2025-12-27 20:26:04,571 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 20:26:09,557 - Avg. fwd time: 14.2580 / Avg. bwd time: 40.3365 / Avg. batch time: 1089.9834 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 20:26:09,607 - Avg. fwd time: 7.8043 / Avg. bwd time: 18.9618 / Avg. batch time: 1152.7846 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-12-27 20:26:09,652 - Avg. fwd time: 9.9083 / Avg. bwd time: 24.3533 / Avg. batch time: 1212.2746 (ms) / GPU bubble ratio: 54.78%
[rank0]:2025-12-27 20:26:09,691 - Avg. fwd time: 8.2840 / Avg. bwd time: 21.2076 / Avg. batch time: 1251.2035 (ms) / GPU bubble ratio: 62.29%
[rank0]:2025-12-27 20:26:09,727 -  step: 750  loss: -4.0000  grad_norm:  0.1969  memory: 20.42GiB(42.99%)  tps: 6,400  tflops: 50.03  mfu: 16.04%
[rank2]:2025-12-27 20:26:09,713 -  step: 750  loss: -4.0000  grad_norm:  0.1969  memory: 12.06GiB(25.39%)  tps: 6,400  tflops: 50.03  mfu: 16.04%
[rank3]:2025-12-27 20:26:09,725 -  step: 750  loss:  0.2179  grad_norm:  0.1969  memory: 29.23GiB(61.52%)  tps: 6,400  tflops: 50.03  mfu: 16.04%
[rank1]:2025-12-27 20:26:09,716 -  step: 750  loss: -4.0000  grad_norm:  0.1969  memory: 18.49GiB(38.93%)  tps: 6,400  tflops: 50.03  mfu: 16.04%
[rank0]:2025-12-27 20:30:20,165 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 20:30:25,212 - Avg. fwd time: 14.2572 / Avg. bwd time: 40.3378 / Avg. batch time: 1089.9939 (ms) / GPU bubble ratio: 19.86%
[rank2]:2025-12-27 20:30:25,262 - Avg. fwd time: 7.8043 / Avg. bwd time: 18.9617 / Avg. batch time: 1152.7665 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-12-27 20:30:25,306 - Avg. fwd time: 9.9078 / Avg. bwd time: 24.3549 / Avg. batch time: 1212.2721 (ms) / GPU bubble ratio: 54.78%
[rank2]:2025-12-27 20:30:25,367 -  step: 800  loss: -4.0000  grad_norm:  0.1888  memory: 12.06GiB(25.39%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank2]:2025-12-27 20:30:25,367 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1888  tps: 6,798  tflops: 53.15  mfu: 15.55%
[rank2]:2025-12-27 20:30:25,367 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-27 20:30:25,367 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 20:30:25,345 - Avg. fwd time: 8.2840 / Avg. bwd time: 21.2085 / Avg. batch time: 1251.2015 (ms) / GPU bubble ratio: 62.29%
[rank0]:2025-12-27 20:30:25,381 -  step: 800  loss: -4.0000  grad_norm:  0.1888  memory: 20.42GiB(42.99%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank0]:2025-12-27 20:30:25,381 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1888  tps: 6,798  tflops: 53.15  mfu: 15.55%
[rank0]:2025-12-27 20:30:25,382 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-27 20:30:25,382 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-27 20:30:25,370 -  step: 800  loss: -4.0000  grad_norm:  0.1888  memory: 18.49GiB(38.93%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank1]:2025-12-27 20:30:25,370 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1888  tps: 6,799  tflops: 53.15  mfu: 15.55%
[rank1]:2025-12-27 20:30:25,370 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-27 20:30:25,371 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-27 20:30:25,379 -  step: 800  loss:  0.2240  grad_norm:  0.1888  memory: 29.23GiB(61.52%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank3]:2025-12-27 20:30:25,379 - â„¹ï¸ final step: 800  loss:  0.2240  grad_norm:  0.1888  tps: 6,803  tflops: 53.18  mfu: 15.69%
[rank3]:2025-12-27 20:30:25,379 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-27 20:30:25,380 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-27 20:30:27,432 - Destroying the purge thread.
[rank2]:2025-12-27 20:30:27,466 - Process group destroyed
[rank0]:2025-12-27 20:30:27,411 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-27 20:30:27,432 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-27 20:30:27,433 - Destroying the purge thread.
[rank1]:2025-12-27 20:30:27,611 - Process group destroyed
[rank3]:2025-12-27 20:30:27,684 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_2030_final800_rank3.svg
[rank3]:			> Batch Time: 1250.52 ms, GPU Bubble Ratio: 62.16%, 56.08%, 65.71%, 29.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-179ms    | [S0,MB5,F]  179-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  368-19-387ms   | [S0,MB7,F]  387-7-394ms    | [S4,MB1,B]  489-19-508ms   | [S4,MB4,F]  550-8-558ms    | [S4,MB2,B]  559-19-578ms   | [S4,MB5,F]  585-8-594ms    | [S4,MB3,B]  594-19-613ms   | [S4,MB6,F]  621-8-629ms    | [S0,MB0,B]  630-25-655ms   | [S4,MB7,F]  657-7-664ms    | [S0,MB1,B]  669-24-694ms   | [S0,MB2,B]  711-23-735ms   | [S0,MB3,B]  768-23-791ms   | [S4,MB4,B]  806-18-824ms   | [S4,MB5,B]  894-18-912ms   | [S4,MB6,B]  984-18-1002ms  | [S4,MB7,B]  1075-18-1093ms | [S0,MB4,B]  1111-23-1134ms | [S0,MB5,B]  1154-23-1177ms | [S0,MB6,B]  1190-23-1213ms | [S0,MB7,B]  1227-23-1250ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  274-7-281ms    | [S1,MB4,F]  304-10-314ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  361-12-374ms   | [S5,MB1,B]  377-19-396ms   | [S1,MB6,F]  396-11-407ms   | [S5,MB2,B]  489-18-507ms   | [S1,MB7,F]  507-11-519ms   | [S5,MB3,B]  559-19-578ms   | [S5,MB4,F]  578-7-586ms    | [S1,MB0,B]  594-29-623ms   | [S5,MB5,F]  622-9-631ms    | [S1,MB1,B]  632-30-662ms   | [S5,MB6,F]  662-10-672ms   | [S1,MB2,B]  672-32-705ms   | [S5,MB7,F]  705-10-715ms   | [S1,MB3,B]  715-33-749ms   | [S5,MB4,B]  780-18-799ms   | [S5,MB5,B]  869-18-887ms   | [S5,MB6,B]  959-18-977ms   | [S5,MB7,B]  1050-18-1068ms | [S1,MB4,B]  1076-27-1104ms | [S1,MB5,B]  1119-27-1147ms | [S1,MB6,B]  1154-28-1183ms | [S1,MB7,B]  1189-30-1219ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-294ms   | [S6,MB3,F]  294-8-303ms    | [S6,MB1,B]  351-19-370ms   | [S2,MB4,F]  370-8-379ms    | [S6,MB2,B]  441-19-460ms   | [S2,MB5,F]  460-7-468ms    | [S6,MB3,B]  531-19-550ms   | [S2,MB6,F]  550-8-559ms    | [S2,MB0,B]  566-19-586ms   | [S2,MB7,F]  585-8-594ms    | [S2,MB1,B]  601-19-621ms   | [S6,MB4,F]  621-8-629ms    | [S2,MB2,B]  635-19-655ms   | [S6,MB5,F]  655-7-662ms    | [S2,MB3,B]  670-20-690ms   | [S6,MB6,F]  690-7-697ms    | [S6,MB4,B]  754-19-774ms   | [S6,MB7,F]  774-8-782ms    | [S6,MB5,B]  844-18-863ms   | [S6,MB6,B]  935-18-953ms   | [S6,MB7,B]  1026-18-1044ms | [S2,MB4,B]  1051-18-1069ms | [S2,MB5,B]  1094-18-1112ms | [S2,MB6,B]  1119-18-1137ms | [S2,MB7,B]  1153-18-1172ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  258-18-277ms   | [S7,MB1,B]  289-55-344ms   | [S7,MB2,F]  344-21-365ms   | [S7,MB2,B]  377-57-434ms   | [S7,MB3,F]  434-21-455ms   | [S7,MB3,B]  467-57-525ms   | [S3,MB4,F]  524-12-536ms   | [S3,MB0,B]  536-24-560ms   | [S3,MB5,F]  560-10-571ms   | [S3,MB1,B]  571-23-595ms   | [S3,MB6,F]  594-10-605ms   | [S3,MB2,B]  605-23-628ms   | [S3,MB7,F]  628-10-639ms   | [S3,MB3,B]  639-22-661ms   | [S7,MB4,F]  661-18-679ms   | [S7,MB4,B]  691-56-747ms   | [S7,MB5,F]  748-21-769ms   | [S7,MB5,B]  780-57-838ms   | [S7,MB6,F]  838-21-859ms   | [S7,MB6,B]  871-57-928ms   | [S7,MB7,F]  928-21-949ms   | [S7,MB7,B]  961-57-1018ms  | [S3,MB4,B]  1018-26-1044ms | [S3,MB5,B]  1044-24-1069ms | [S3,MB6,B]  1069-24-1094ms | [S3,MB7,B]  1093-23-1117ms
[rank3]:2025-12-27 20:30:27,927 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1/pipeline_schedule/251227_2030_thry_final800_rank3.svg
[rank3]:			> Batch Time: 576.28 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S4,MB0,F]  40-10-50ms     | [S4,MB1,F]  50-10-60ms     | [S4,MB2,F]  60-10-70ms     | [S4,MB3,F]  70-10-80ms     | [S0,MB4,F]  80-10-90ms     | [S0,MB5,F]  90-10-101ms    | [S0,MB6,F]  101-10-111ms   | [S4,MB0,B]  141-20-161ms   | [S0,MB7,F]  161-10-171ms   | [S4,MB1,B]  171-20-192ms   | [S4,MB4,F]  202-10-212ms   | [S4,MB2,B]  212-20-232ms   | [S4,MB5,F]  232-10-242ms   | [S4,MB3,B]  242-20-262ms   | [S4,MB6,F]  262-10-272ms   | [S0,MB0,B]  272-20-293ms   | [S4,MB7,F]  293-10-303ms   | [S0,MB1,B]  303-20-323ms   | [S0,MB2,B]  323-20-343ms   | [S0,MB3,B]  353-20-374ms   | [S4,MB4,B]  384-20-404ms   | [S4,MB5,B]  414-20-434ms   | [S4,MB6,B]  444-20-465ms   | [S4,MB7,B]  475-20-495ms   | [S0,MB4,B]  495-20-515ms   | [S0,MB5,B]  515-20-535ms   | [S0,MB6,B]  535-20-556ms   | [S0,MB7,B]  556-20-576ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB3,F]  40-10-50ms     | [S5,MB0,F]  50-10-60ms     | [S5,MB1,F]  60-10-70ms     | [S5,MB2,F]  70-10-80ms     | [S5,MB3,F]  80-10-90ms     | [S1,MB4,F]  90-10-101ms    | [S5,MB0,B]  121-20-141ms   | [S1,MB5,F]  141-10-151ms   | [S5,MB1,B]  151-20-171ms   | [S1,MB6,F]  171-10-181ms   | [S5,MB2,B]  181-20-202ms   | [S1,MB7,F]  202-10-212ms   | [S5,MB3,B]  212-20-232ms   | [S5,MB4,F]  232-10-242ms   | [S1,MB0,B]  242-20-262ms   | [S5,MB5,F]  262-10-272ms   | [S1,MB1,B]  272-20-293ms   | [S5,MB6,F]  293-10-303ms   | [S1,MB2,B]  303-20-323ms   | [S5,MB7,F]  323-10-333ms   | [S1,MB3,B]  333-20-353ms   | [S5,MB4,B]  363-20-384ms   | [S5,MB5,B]  394-20-414ms   | [S5,MB6,B]  424-20-444ms   | [S5,MB7,B]  454-20-475ms   | [S1,MB4,B]  475-20-495ms   | [S1,MB5,B]  495-20-515ms   | [S1,MB6,B]  515-20-535ms   | [S1,MB7,B]  535-20-556ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB2,F]  40-10-50ms     | [S2,MB3,F]  50-10-60ms     | [S6,MB0,F]  60-10-70ms     | [S6,MB1,F]  70-10-80ms     | [S6,MB2,F]  80-10-90ms     | [S6,MB0,B]  101-20-121ms   | [S6,MB3,F]  121-10-131ms   | [S6,MB1,B]  131-20-151ms   | [S2,MB4,F]  151-10-161ms   | [S6,MB2,B]  161-20-181ms   | [S2,MB5,F]  181-10-192ms   | [S6,MB3,B]  192-20-212ms   | [S2,MB6,F]  212-10-222ms   | [S2,MB0,B]  222-20-242ms   | [S2,MB7,F]  242-10-252ms   | [S2,MB1,B]  252-20-272ms   | [S6,MB4,F]  272-10-283ms   | [S2,MB2,B]  283-20-303ms   | [S6,MB5,F]  303-10-313ms   | [S2,MB3,B]  313-20-333ms   | [S6,MB6,F]  333-10-343ms   | [S6,MB4,B]  343-20-363ms   | [S6,MB7,F]  363-10-374ms   | [S6,MB5,B]  374-20-394ms   | [S6,MB6,B]  404-20-424ms   | [S6,MB7,B]  434-20-454ms   | [S2,MB4,B]  454-20-475ms   | [S2,MB5,B]  475-20-495ms   | [S2,MB6,B]  495-20-515ms   | [S2,MB7,B]  515-20-535ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB1,F]  40-10-50ms     | [S3,MB2,F]  50-10-60ms     | [S3,MB3,F]  60-10-70ms     | [S7,MB0,F]  70-10-80ms     | [S7,MB0,B]  80-20-101ms    | [S7,MB1,F]  101-10-111ms   | [S7,MB1,B]  111-20-131ms   | [S7,MB2,F]  131-10-141ms   | [S7,MB2,B]  141-20-161ms   | [S7,MB3,F]  161-10-171ms   | [S7,MB3,B]  171-20-192ms   | [S3,MB4,F]  192-10-202ms   | [S3,MB0,B]  202-20-222ms   | [S3,MB5,F]  222-10-232ms   | [S3,MB1,B]  232-20-252ms   | [S3,MB6,F]  252-10-262ms   | [S3,MB2,B]  262-20-283ms   | [S3,MB7,F]  283-10-293ms   | [S3,MB3,B]  293-20-313ms   | [S7,MB4,F]  313-10-323ms   | [S7,MB4,B]  323-20-343ms   | [S7,MB5,F]  343-10-353ms   | [S7,MB5,B]  353-20-374ms   | [S7,MB6,F]  374-10-384ms   | [S7,MB6,B]  384-20-404ms   | [S7,MB7,F]  404-10-414ms   | [S7,MB7,B]  414-20-434ms   | [S3,MB4,B]  434-20-454ms   | [S3,MB5,B]  454-20-475ms   | [S3,MB6,B]  475-20-495ms   | [S3,MB7,B]  495-20-515ms  
[rank3]:2025-12-27 20:30:27,928 - Destroying the purge thread.
[rank3]:wandb: uploading history steps 16-16, summary, console lines 265-277
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.81674
[rank3]:wandb:               final/avg_loss 0.22398
[rank3]:wandb:             final/avg_mfu(%) 15.69054
[rank3]:wandb:             final/avg_tflops 53.1823
[rank3]:wandb:    final/avg_throughput(tps) 6802.94621
[rank3]:wandb:              final/grad_norm 0.18884
[rank3]:wandb:               final/max_loss 0.22398
[rank3]:wandb:                    grad_norm 0.18884
[rank3]:wandb: loss_metrics/global_avg_loss 0.22398
[rank3]:wandb: loss_metrics/global_max_loss 0.22398
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_Interleaved1F1B_nofreeze_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/1dg3ij7n
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_Interleaved1F1B_nofreeze_11_dm1/20251227-1922/wandb/run-20251227_192209-1dg3ij7n/logs
[rank0]:2025-12-27 20:30:29,433 - Training completed
[rank0]:2025-12-27 20:30:29,433 - Destroying the purge thread.
[rank3]:2025-12-27 20:30:29,497 - Process group destroyed
[rank0]:2025-12-27 20:30:29,602 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'norm', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_Interleaved1F1B_nofreeze_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
