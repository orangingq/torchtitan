
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 12:06:25 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_InterleavedZeroBubble_auto_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with auto x InterleavedZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-31 12:06:31,795 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank3]:2025-12-31 12:06:31,790 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank2]:2025-12-31 12:06:31,962 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-31 12:06:31,977 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank0]:2025-12-31 12:06:32,054 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 12:06:32,057 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 12:06:32,066 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 12:06:32,067 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-31 12:06:32,042 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 12:06:32,044 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-31 12:06:32,210 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 12:06:32,213 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-31 12:06:32,219 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 12:06:32,222 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 12:06:32,458 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-31 12:06:36,912 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-31 12:06:36,819 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 12:06:36,860 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 12:06:36,889 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-31 12:06:36,902 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-31 12:06:36,904 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-31 12:06:36,863 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 12:06:36,902 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 12:06:36,930 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-31 12:06:36,942 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-31 12:06:36,944 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-31 12:06:37,065 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 12:06:37,115 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 12:06:37,117 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 12:06:37,144 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-31 12:06:37,157 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-31 12:06:37,159 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-31 12:06:37,116 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 12:06:37,116 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 12:06:37,117 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-31 12:06:37,156 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 12:06:37,157 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 12:06:37,157 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-31 12:06:37,350 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 12:06:37,350 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 12:06:37,351 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run nxv2n40f
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_auto_22_dm1/20251231-1206/wandb/run-20251231_120640-nxv2n40f
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/nxv2n40f
[rank3]:2025-12-31 12:06:41,831 - WandB logging enabled
[rank3]:2025-12-31 12:06:41,831 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 12:06:41,869 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 12:06:41,896 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-31 12:06:41,909 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-31 12:06:41,911 - Using pipeline schedule InterleavedZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-31 12:06:42,110 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 12:06:42,111 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 12:06:42,111 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-31 12:06:42,129 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 12:06:42,127 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_InterleavedZeroBubble_auto_22_dm1
[rank0]:2025-12-31 12:06:42,127 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 12:06:42,127 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 12:06:42,128 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-31 12:06:42,130 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-31 12:06:42,132 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 12:06:44,680 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-31 12:06:44,681 - Finished loading the checkpoint in 2.55 seconds.
[rank0]:2025-12-31 12:06:44,681 - Training starts at step 1
[rank1]:2025-12-31 12:06:50,128 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 16.75GiB(35.27%)  tps: 2,478  tflops: 19.37  mfu: 6.21%
[rank1]:2025-12-31 12:06:50,128 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 12:06:50,132 -  step:  1  loss: 10.6092  grad_norm: 203.0665  memory: 34.21GiB(72.01%)  tps: 3,967  tflops: 31.01  mfu: 9.94%
[rank3]:2025-12-31 12:06:50,132 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-31 12:06:50,109 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 12.75GiB(26.83%)  tps: 2,473  tflops: 19.34  mfu: 6.20%
[rank2]:2025-12-31 12:06:50,109 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 12:06:50,142 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 14.00GiB(29.46%)  tps: 2,516  tflops: 19.67  mfu: 6.30%
[rank0]:2025-12-31 12:06:50,142 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 12:10:36,736 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 12:10:41,391 - Avg. fwd time: 12.6164 / Avg. bwd-weight time: 20.1326 / Avg. bwd-input time: 22.5704 / Avg. batch time: 1100.5320 (ms) / GPU bubble ratio: 19.57%
[rank2]:2025-12-31 12:10:41,387 - Avg. fwd time: 7.3483 / Avg. bwd-weight time: 10.2561 / Avg. bwd-input time: 9.4396 / Avg. batch time: 1106.9841 (ms) / GPU bubble ratio: 60.91%
[rank2]:2025-12-31 12:10:41,437 -  step: 50  loss: -4.0000  grad_norm: 24.2458  memory: 14.56GiB(30.65%)  tps: 6,941  tflops: 54.26  mfu: 17.39%
[rank1]:2025-12-31 12:10:41,407 - Avg. fwd time: 9.4303 / Avg. bwd-weight time: 12.5928 / Avg. bwd-input time: 12.0078 / Avg. batch time: 1142.0989 (ms) / GPU bubble ratio: 52.33%
[rank0]:2025-12-31 12:10:41,402 - Avg. fwd time: 7.9546 / Avg. full-bwd time: 23.8585 (Avg. bwd-weight time: 9.7398 / Avg. bwd-input time: 9.6638) / Avg. batch time: 1150.7621 (ms) / GPU bubble ratio: 58.86%
[rank3]:2025-12-31 12:10:41,449 -  step: 50  loss:  9.8844  grad_norm: 24.2458  memory: 37.14GiB(78.18%)  tps: 6,941  tflops: 54.26  mfu: 17.39%
[rank1]:2025-12-31 12:10:41,442 -  step: 50  loss: -4.0000  grad_norm: 24.2458  memory: 19.04GiB(40.08%)  tps: 6,941  tflops: 54.26  mfu: 17.39%
[rank0]:2025-12-31 12:10:41,451 -  step: 50  loss: -4.0000  grad_norm: 24.2458  memory: 17.77GiB(37.40%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank2]:2025-12-31 12:11:23,992 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:11:24,007 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-31 12:11:23,998 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-31 12:11:24,007 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 12:12:11,123 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0853e+00
[rank3]:2025-12-31 12:12:11,138 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.7296e+00
[rank0]:2025-12-31 12:12:11,139 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.8737e+00
[rank1]:2025-12-31 12:12:11,131 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.7885e+00
[rank2]:2025-12-31 12:12:57,073 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-31 12:12:57,153 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.1044e+00
[rank1]:2025-12-31 12:12:57,148 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5071e+00
[rank3]:2025-12-31 12:12:57,142 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2730e+00
[rank0]:2025-12-31 12:13:44,240 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.4734e+00
[rank1]:2025-12-31 12:13:44,236 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.4189e+00
[rank2]:2025-12-31 12:13:44,228 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:13:44,243 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.4555e+00
[rank3]:2025-12-31 12:14:29,849 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.7102e+00
[rank0]:2025-12-31 12:14:29,828 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 12:14:29,845 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.8612e+00
[rank1]:2025-12-31 12:14:29,854 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.0355e+00
[rank0]:2025-12-31 12:14:29,860 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 4.6383e+00
[rank2]:2025-12-31 12:14:34,440 - Avg. fwd time: 7.3910 / Avg. bwd-weight time: 9.1446 / Avg. bwd-input time: 9.4466 / Avg. batch time: 1097.4408 (ms) / GPU bubble ratio: 62.12%
[rank3]:2025-12-31 12:14:34,473 - Avg. fwd time: 12.5755 / Avg. bwd-weight time: 18.9532 / Avg. bwd-input time: 22.4941 / Avg. batch time: 1085.1565 (ms) / GPU bubble ratio: 20.35%
[rank3]:2025-12-31 12:14:34,527 -  step: 100  loss:  8.3335  grad_norm: 16.1954  memory: 37.14GiB(78.18%)  tps: 7,029  tflops: 54.95  mfu: 17.61%
[rank1]:2025-12-31 12:14:34,488 - Avg. fwd time: 9.4215 / Avg. bwd-weight time: 12.6249 / Avg. bwd-input time: 12.0365 / Avg. batch time: 1135.6955 (ms) / GPU bubble ratio: 51.98%
[rank1]:2025-12-31 12:14:34,520 -  step: 100  loss: -4.0000  grad_norm: 16.1954  memory: 19.04GiB(40.08%)  tps: 7,029  tflops: 54.95  mfu: 17.61%
[rank2]:2025-12-31 12:14:34,502 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 14.56GiB(30.65%)  tps: 7,030  tflops: 54.96  mfu: 17.61%
[rank0]:2025-12-31 12:14:34,481 - Avg. fwd time: 7.9584 / Avg. full-bwd time: 23.3795 (Avg. bwd-weight time: 9.7573 / Avg. bwd-input time: 9.6724) / Avg. batch time: 1143.7452 (ms) / GPU bubble ratio: 58.92%
[rank0]:2025-12-31 12:14:34,526 -  step: 100  loss: -4.0000  grad_norm: 16.1954  memory: 17.77GiB(37.40%)  tps: 7,030  tflops: 54.95  mfu: 17.61%
[rank1]:2025-12-31 12:14:34,626 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1214_stage1_step100.svg
[rank2]:2025-12-31 12:14:34,628 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1214_stage2_step100.svg
[rank0]:2025-12-31 12:14:34,601 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1214_stage0_step100.svg
[rank0]:2025-12-31 12:14:34,639 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1214_stage4_step100.svg
[rank1]:2025-12-31 12:14:34,663 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1214_stage5_step100.svg
[rank2]:2025-12-31 12:14:34,666 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1214_stage6_step100.svg
[rank0]:2025-12-31 12:14:34,745 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank0_stage0.svg
[rank0]:	> Counts Sum: 18, Total Sum: 95 (18.95%), Ratio(%) per element: [0.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 12:14:34,789 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank1_stage1.svg
[rank1]:	> Counts Sum: 0, Total Sum: 135 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:14:34,767 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank2_stage2.svg
[rank2]:	> Counts Sum: 36, Total Sum: 90 (40.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank0]:2025-12-31 12:14:34,842 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank0_stage4.svg
[rank0]:	> Counts Sum: 0, Total Sum: 90 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:14:34,883 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1214_step100_rank3.svg
[rank3]:			> Batch Time: 1113.58 ms, GPU Bubble Ratio: 57.40%, 50.98%, 61.08%, 30.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-96ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  163-8-171ms    | [S4,MB0,BI] 276-9-285ms    | [S4,MB0,BW] 286-9-295ms    | [S0,MB4,F]  295-7-302ms    | [S4,MB1,BI] 336-9-346ms    | [S4,MB1,BW] 346-9-356ms    | [S0,MB5,F]  356-7-363ms    | [S4,MB2,BI] 410-10-421ms   | [S4,MB2,BW] 421-9-430ms    | [S0,MB6,F]  430-7-438ms    | [S4,MB3,BI] 480-10-490ms   | [S4,MB3,BW] 490-9-500ms    | [S0,MB7,F]  500-7-507ms    | [S0,MB0,B]  531-24-555ms   | [S4,MB4,F]  554-7-561ms    | [S0,MB1,B]  578-24-602ms   | [S4,MB5,F]  602-7-609ms    | [S0,MB2,B]  627-24-651ms   | [S4,MB6,F]  652-7-659ms    | [S0,MB3,B]  668-24-692ms   | [S4,MB7,F]  692-7-699ms    | [S4,MB4,BI] 731-10-741ms   | [S4,MB4,BW] 741-9-750ms    | [S4,MB5,BI] 815-9-824ms    | [S4,MB5,BW] 824-9-833ms    | [S4,MB6,BI] 864-9-873ms    | [S4,MB6,BW] 873-9-883ms    | [S4,MB7,BI] 930-9-939ms    | [S4,MB7,BW] 939-10-949ms   | [S0,MB4,B]  973-23-996ms   | [S0,MB5,B]  1011-23-1035ms | [S0,MB6,B]  1051-23-1074ms | [S0,MB7,B]  1090-23-1113ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-10-136ms   | [S5,MB0,F]  163-7-171ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB0,BI] 260-9-270ms    | [S5,MB3,F]  270-8-278ms    | [S5,MB1,BI] 320-9-329ms    | [S5,MB0,BW] 329-10-340ms   | [S1,MB4,F]  340-10-351ms   | [S5,MB2,BI] 382-9-392ms    | [S5,MB1,BW] 392-9-401ms    | [S1,MB5,F]  410-11-421ms   | [S5,MB3,BI] 445-9-455ms    | [S5,MB2,BW] 455-9-465ms    | [S1,MB6,F]  480-11-491ms   | [S1,MB0,BI] 496-14-510ms   | [S5,MB3,BW] 510-9-520ms    | [S1,MB7,F]  532-11-543ms   | [S1,MB1,BI] 547-14-562ms   | [S1,MB0,BW] 562-15-577ms   | [S5,MB4,F]  579-7-586ms    | [S1,MB2,BI] 596-15-611ms   | [S1,MB1,BW] 612-15-627ms   | [S5,MB5,F]  629-7-636ms    | [S1,MB3,BI] 646-15-661ms   | [S1,MB2,BW] 661-15-677ms   | [S5,MB6,F]  677-7-684ms    | [S5,MB4,BI] 714-10-724ms   | [S1,MB3,BW] 724-15-740ms   | [S5,MB7,F]  740-7-747ms    | [S5,MB5,BI] 781-9-790ms    | [S5,MB4,BW] 791-9-800ms    | [S5,MB6,BI] 849-9-858ms    | [S5,MB5,BW] 858-10-868ms   | [S5,MB7,BI] 914-9-923ms    | [S5,MB6,BW] 924-10-934ms   | [S1,MB4,BI] 952-13-966ms   | [S5,MB7,BW] 966-10-976ms   | [S1,MB5,BI] 991-13-1004ms  | [S1,MB4,BW] 1005-15-1020ms | [S1,MB6,BI] 1030-14-1044ms | [S1,MB5,BW] 1044-15-1059ms | [S1,MB7,BI] 1068-14-1083ms | [S1,MB6,BW] 1083-15-1098ms | [S1,MB7,BW] 1098-15-1113ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-66ms      | [S2,MB2,F]  98-6-105ms     | [S2,MB3,F]  136-6-143ms    | [S6,MB0,F]  171-7-179ms    | [S6,MB1,F]  185-6-192ms    | [S6,MB0,BI] 245-9-254ms    | [S6,MB2,F]  254-8-262ms    | [S6,MB1,BI] 304-9-314ms    | [S6,MB3,F]  314-8-322ms    | [S6,MB2,BI] 366-8-375ms    | [S6,MB0,BW] 375-10-386ms   | [S2,MB4,F]  386-7-393ms    | [S6,MB3,BI] 429-9-439ms    | [S6,MB1,BW] 439-10-449ms   | [S2,MB5,F]  449-7-456ms    | [S2,MB0,BI] 480-9-490ms    | [S6,MB2,BW] 489-10-500ms   | [S2,MB6,F]  500-7-507ms    | [S2,MB1,BI] 531-9-541ms    | [S6,MB3,BW] 540-10-551ms   | [S2,MB7,F]  551-7-558ms    | [S2,MB2,BI] 580-10-590ms   | [S2,MB0,BW] 590-10-601ms   | [S6,MB4,F]  599-7-607ms    | [S2,MB3,BI] 629-10-639ms   | [S2,MB1,BW] 639-10-650ms   | [S6,MB5,F]  650-7-657ms    | [S6,MB4,BI] 697-10-707ms   | [S2,MB2,BW] 708-10-718ms   | [S6,MB6,F]  717-7-724ms    | [S6,MB5,BI] 764-9-774ms    | [S2,MB3,BW] 774-10-784ms   | [S6,MB7,F]  784-7-791ms    | [S6,MB6,BI] 832-9-842ms    | [S6,MB4,BW] 842-10-852ms   | [S6,MB7,BI] 899-8-908ms    | [S6,MB5,BW] 907-10-917ms   | [S2,MB4,BI] 936-8-945ms    | [S6,MB6,BW] 945-10-955ms   | [S2,MB5,BI] 975-8-984ms    | [S6,MB7,BW] 984-10-994ms   | [S2,MB6,BI] 1014-8-1023ms  | [S2,MB4,BW] 1023-10-1033ms | [S2,MB7,BI] 1052-8-1061ms  | [S2,MB5,BW] 1061-10-1071ms | [S2,MB6,BW] 1071-9-1081ms  | [S2,MB7,BW] 1081-9-1091ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  105-7-113ms    | [S3,MB3,F]  143-7-151ms    | [S7,MB0,F]  179-15-194ms   | [S7,MB0,BI] 206-31-238ms   | [S7,MB1,F]  238-14-253ms   | [S7,MB1,BI] 265-32-298ms   | [S7,MB2,F]  298-17-315ms   | [S7,MB2,BI] 326-33-360ms   | [S7,MB3,F]  360-16-377ms   | [S7,MB3,BI] 388-33-422ms   | [S7,MB0,BW] 422-27-450ms   | [S3,MB4,F]  450-9-460ms    | [S3,MB0,BI] 460-12-472ms   | [S7,MB1,BW] 472-28-501ms   | [S3,MB5,F]  501-9-511ms    | [S3,MB1,BI] 510-12-523ms   | [S7,MB2,BW] 523-28-551ms   | [S3,MB6,F]  552-9-561ms    | [S3,MB2,BI] 562-11-573ms   | [S7,MB3,BW] 573-28-601ms   | [S3,MB7,F]  601-9-611ms    | [S3,MB3,BI] 611-11-622ms   | [S3,MB0,BW] 623-0-623ms    | [S7,MB4,F]  631-15-647ms   | [S7,MB4,BI] 658-32-691ms   | [S3,MB1,BW] 691-0-691ms    | [S7,MB5,F]  698-15-714ms   | [S7,MB5,BI] 725-32-758ms   | [S3,MB2,BW] 758-0-758ms    | [S7,MB6,F]  765-14-780ms   | [S7,MB6,BI] 793-32-825ms   | [S3,MB3,BW] 825-0-825ms    | [S7,MB7,F]  832-15-848ms   | [S7,MB7,BI] 859-32-892ms   | [S7,MB4,BW] 892-27-919ms   | [S3,MB4,BI] 919-10-930ms   | [S7,MB5,BW] 930-28-958ms   | [S3,MB5,BI] 958-10-968ms   | [S7,MB6,BW] 968-28-996ms   | [S3,MB6,BI] 996-11-1007ms  | [S7,MB7,BW] 1007-28-1035ms | [S3,MB7,BI] 1036-11-1047ms | [S3,MB4,BW] 1047-0-1047ms  | [S3,MB5,BW] 1047-0-1047ms  | [S3,MB6,BW] 1047-0-1047ms  | [S3,MB7,BW] 1047-0-1047ms 
[rank3]:2025-12-31 12:14:34,927 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1214_stage3_step100.svg
[rank1]:2025-12-31 12:14:34,887 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank1_stage5.svg
[rank1]:	> Counts Sum: 0, Total Sum: 90 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:14:34,863 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank2_stage6.svg
[rank2]:	> Counts Sum: 18, Total Sum: 90 (20.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:14:34,965 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1214_stage7_step100.svg
[rank3]:2025-12-31 12:14:35,067 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank3_stage3.svg
[rank3]:	> Counts Sum: 36, Total Sum: 90 (40.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank3]:2025-12-31 12:14:35,147 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1214_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 55 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:15:17,270 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-31 12:15:17,355 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.5053e+00
[rank1]:2025-12-31 12:15:17,352 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.5404e+00
[rank3]:2025-12-31 12:15:17,359 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.2355e+00
[rank1]:2025-12-31 12:16:03,167 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-31 12:16:03,228 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 4.3472e+00
[rank2]:2025-12-31 12:16:03,213 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:16:03,216 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.9386e+00
[rank0]:2025-12-31 12:16:50,221 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 8.8041e+00
[rank1]:2025-12-31 12:16:50,217 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 12:16:50,209 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1608e+01
[rank3]:2025-12-31 12:16:50,225 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0343e+01
[rank1]:2025-12-31 12:17:36,079 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.6919e+00
[rank0]:2025-12-31 12:17:36,084 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 5.4868e+00
[rank2]:2025-12-31 12:17:36,060 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.2304e+00
[rank3]:2025-12-31 12:17:36,072 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.9627e+00
[rank0]:2025-12-31 12:18:23,158 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-31 12:18:23,170 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.5513e+00
[rank0]:2025-12-31 12:18:23,189 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.7192e+00
[rank2]:2025-12-31 12:18:23,178 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.5665e+00
[rank3]:2025-12-31 12:18:23,193 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3971e+00
[rank2]:2025-12-31 12:18:27,745 - Avg. fwd time: 7.4175 / Avg. bwd-weight time: 8.5363 / Avg. bwd-input time: 9.4508 / Avg. batch time: 1093.0357 (ms) / GPU bubble ratio: 62.81%
[rank3]:2025-12-31 12:18:27,733 - Avg. fwd time: 12.5511 / Avg. bwd-weight time: 18.5182 / Avg. bwd-input time: 22.4597 / Avg. batch time: 1079.8239 (ms) / GPU bubble ratio: 20.68%
[rank1]:2025-12-31 12:18:27,793 - Avg. fwd time: 9.4774 / Avg. bwd-weight time: 11.2779 / Avg. bwd-input time: 12.0125 / Avg. batch time: 1129.8001 (ms) / GPU bubble ratio: 53.59%
[rank1]:2025-12-31 12:18:27,818 -  step: 150  loss: -4.0000  grad_norm: 22.1971  memory: 19.04GiB(40.08%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank0]:2025-12-31 12:18:27,790 - Avg. fwd time: 7.9760 / Avg. full-bwd time: 22.6684 (Avg. bwd-weight time: 9.7605 / Avg. bwd-input time: 9.6801) / Avg. batch time: 1141.1720 (ms) / GPU bubble ratio: 59.30%
[rank0]:2025-12-31 12:18:27,826 -  step: 150  loss: -4.0000  grad_norm: 22.1971  memory: 17.77GiB(37.40%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank2]:2025-12-31 12:18:27,806 -  step: 150  loss: -4.0000  grad_norm: 22.1971  memory: 14.56GiB(30.65%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank3]:2025-12-31 12:18:27,817 -  step: 150  loss:  3.5875  grad_norm: 22.1971  memory: 37.14GiB(78.18%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank1]:2025-12-31 12:19:09,267 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.0942e+00
[rank0]:2025-12-31 12:19:09,272 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.5969e+00
[rank3]:2025-12-31 12:19:09,260 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.0324e+00
[rank2]:2025-12-31 12:19:09,248 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.7011e+00
[rank1]:2025-12-31 12:19:56,494 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 12:19:56,565 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1310e+00
[rank2]:2025-12-31 12:19:56,549 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.1358e+00
[rank0]:2025-12-31 12:19:56,561 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.9549e+00
[rank1]:2025-12-31 12:20:42,584 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:20:42,578 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.3271e+00
[rank2]:2025-12-31 12:20:42,567 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.4679e+00
[rank0]:2025-12-31 12:20:42,592 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.9005e+00
[rank1]:2025-12-31 12:21:29,656 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.5715e+00
[rank2]:2025-12-31 12:21:29,650 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.0973e+00
[rank3]:2025-12-31 12:21:29,664 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8538e+00
[rank0]:2025-12-31 12:21:29,661 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.2851e+00
[rank2]:2025-12-31 12:22:15,673 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-31 12:22:15,747 - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.8182e+00
[rank3]:2025-12-31 12:22:15,741 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.5122e+00
[rank0]:2025-12-31 12:22:15,721 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 12:22:15,752 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.5887e+00
[rank1]:2025-12-31 12:22:20,459 - Avg. fwd time: 9.4885 / Avg. bwd-weight time: 10.9543 / Avg. bwd-input time: 12.0321 / Avg. batch time: 1127.7795 (ms) / GPU bubble ratio: 53.93%
[rank2]:2025-12-31 12:22:20,470 - Avg. fwd time: 7.4498 / Avg. bwd-weight time: 7.9788 / Avg. bwd-input time: 9.4632 / Avg. batch time: 1088.9451 (ms) / GPU bubble ratio: 63.43%
[rank3]:2025-12-31 12:22:20,476 - Avg. fwd time: 12.5502 / Avg. bwd-weight time: 18.0840 / Avg. bwd-input time: 22.4520 / Avg. batch time: 1075.0560 (ms) / GPU bubble ratio: 20.99%
[rank0]:2025-12-31 12:22:20,480 - Avg. fwd time: 7.9815 / Avg. full-bwd time: 22.5096 (Avg. bwd-weight time: 9.7657 / Avg. bwd-input time: 9.6952) / Avg. batch time: 1139.5632 (ms) / GPU bubble ratio: 59.33%
[rank1]:2025-12-31 12:22:20,511 -  step: 200  loss: -4.0000  grad_norm: 17.1815  memory: 19.04GiB(40.08%)  tps: 7,041  tflops: 55.04  mfu: 17.64%
[rank2]:2025-12-31 12:22:20,518 -  step: 200  loss: -4.0000  grad_norm: 17.1815  memory: 14.56GiB(30.65%)  tps: 7,040  tflops: 55.04  mfu: 17.64%
[rank3]:2025-12-31 12:22:20,531 -  step: 200  loss:  1.1661  grad_norm: 17.1815  memory: 37.14GiB(78.18%)  tps: 7,040  tflops: 55.04  mfu: 17.64%
[rank0]:2025-12-31 12:22:20,529 -  step: 200  loss: -4.0000  grad_norm: 17.1815  memory: 17.77GiB(37.40%)  tps: 7,041  tflops: 55.04  mfu: 17.64%
[rank0]:2025-12-31 12:22:20,583 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1222_stage0_step200.svg
[rank1]:2025-12-31 12:22:20,584 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1222_stage1_step200.svg
[rank1]:2025-12-31 12:22:20,625 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1222_stage5_step200.svg
[rank2]:2025-12-31 12:22:20,585 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1222_stage2_step200.svg
[rank2]:2025-12-31 12:22:20,627 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1222_stage6_step200.svg
[rank0]:2025-12-31 12:22:20,623 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1222_stage4_step200.svg
[rank1]:2025-12-31 12:22:20,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank1_stage1.svg
[rank1]:	> Counts Sum: 99, Total Sum: 405 (24.44%), Ratio(%) per element: [26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0]
[rank2]:2025-12-31 12:22:20,724 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank2_stage2.svg
[rank2]:	> Counts Sum: 108, Total Sum: 270 (40.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank0]:2025-12-31 12:22:20,724 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank0_stage0.svg
[rank0]:	> Counts Sum: 63, Total Sum: 285 (22.11%), Ratio(%) per element: [0.0, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 12:22:20,855 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank1_stage5.svg
[rank1]:	> Counts Sum: 18, Total Sum: 270 (6.67%), Ratio(%) per element: [13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:22:20,821 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank2_stage6.svg
[rank2]:	> Counts Sum: 27, Total Sum: 270 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:22:20,849 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1222_step200_rank3.svg
[rank3]:			> Batch Time: 1126.69 ms, GPU Bubble Ratio: 57.67%, 51.17%, 75.47%, 30.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  88-8-97ms      | [S4,MB2,F]  127-8-135ms    | [S4,MB3,F]  166-8-174ms    | [S4,MB0,BI] 280-9-289ms    | [S4,MB0,BW] 289-9-299ms    | [S0,MB4,F]  299-7-306ms    | [S4,MB1,BI] 340-10-350ms   | [S4,MB1,BW] 351-9-360ms    | [S0,MB5,F]  360-7-368ms    | [S4,MB2,BI] 415-10-425ms   | [S4,MB2,BW] 426-9-435ms    | [S0,MB6,F]  435-7-443ms    | [S4,MB3,BI] 485-10-495ms   | [S4,MB3,BW] 495-9-505ms    | [S0,MB7,F]  505-7-512ms    | [S0,MB0,B]  537-24-562ms   | [S4,MB4,F]  561-7-568ms    | [S0,MB1,B]  584-24-609ms   | [S4,MB5,F]  609-7-616ms    | [S0,MB2,B]  635-24-659ms   | [S4,MB6,F]  658-7-666ms    | [S0,MB3,B]  675-24-699ms   | [S4,MB7,F]  699-7-707ms    | [S4,MB4,BI] 738-10-748ms   | [S4,MB4,BW] 748-9-758ms    | [S4,MB5,BI] 824-9-833ms    | [S4,MB5,BW] 833-9-843ms    | [S4,MB6,BI] 873-9-882ms    | [S4,MB6,BW] 883-9-892ms    | [S4,MB7,BI] 939-9-948ms    | [S4,MB7,BW] 948-10-958ms   | [S0,MB4,B]  983-23-1006ms  | [S0,MB5,B]  1023-23-1047ms | [S0,MB6,B]  1064-23-1087ms | [S0,MB7,B]  1103-23-1126ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  88-10-99ms     | [S1,MB3,F]  127-10-138ms   | [S5,MB0,F]  166-7-174ms    | [S5,MB1,F]  180-7-187ms    | [S5,MB2,F]  194-7-201ms    | [S5,MB0,BI] 264-9-273ms    | [S5,MB3,F]  273-8-282ms    | [S5,MB1,BI] 325-9-334ms    | [S5,MB0,BW] 334-10-345ms   | [S1,MB4,F]  344-10-355ms   | [S5,MB2,BI] 386-10-396ms   | [S5,MB1,BW] 396-9-406ms    | [S1,MB5,F]  415-11-426ms   | [S5,MB3,BI] 450-10-460ms   | [S5,MB2,BW] 461-9-470ms    | [S1,MB6,F]  486-11-497ms   | [S1,MB0,BI] 501-14-516ms   | [S5,MB3,BW] 516-9-526ms    | [S1,MB7,F]  538-11-549ms   | [S1,MB1,BI] 553-15-568ms   | [S1,MB0,BW] 568-15-584ms   | [S5,MB4,F]  585-7-592ms    | [S1,MB2,BI] 603-15-618ms   | [S1,MB1,BW] 619-15-634ms   | [S5,MB5,F]  635-7-643ms    | [S1,MB3,BI] 653-15-669ms   | [S1,MB2,BW] 669-15-684ms   | [S5,MB6,F]  684-7-692ms    | [S5,MB4,BI] 721-10-731ms   | [S1,MB3,BW] 731-15-747ms   | [S5,MB7,F]  746-7-754ms    | [S5,MB5,BI] 789-10-799ms   | [S5,MB4,BW] 799-9-809ms    | [S5,MB6,BI] 858-9-867ms    | [S5,MB5,BW] 867-10-877ms   | [S5,MB7,BI] 923-9-932ms    | [S5,MB6,BW] 932-10-942ms   | [S1,MB4,BI] 962-13-976ms   | [S5,MB7,BW] 976-10-986ms   | [S1,MB5,BI] 1002-14-1016ms | [S1,MB4,BW] 1016-15-1031ms | [S1,MB6,BI] 1042-14-1057ms | [S1,MB5,BW] 1056-15-1071ms | [S1,MB7,BI] 1082-14-1097ms | [S1,MB6,BW] 1096-15-1111ms | [S1,MB7,BW] 1111-15-1126ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  99-7-107ms     | [S2,MB3,F]  138-7-146ms    | [S6,MB0,F]  174-7-182ms    | [S6,MB1,F]  188-7-195ms    | [S6,MB0,BI] 248-9-257ms    | [S6,MB2,F]  257-8-266ms    | [S6,MB1,BI] 308-9-318ms    | [S6,MB3,F]  318-8-326ms    | [S6,MB2,BI] 371-8-380ms    | [S6,MB0,BW] 379-0-379ms    | [S2,MB4,F]  387-7-395ms    | [S6,MB3,BI] 434-9-444ms    | [S6,MB1,BW] 444-0-444ms    | [S2,MB5,F]  451-7-459ms    | [S2,MB0,BI] 485-9-495ms    | [S6,MB2,BW] 495-0-495ms    | [S2,MB6,F]  502-7-510ms    | [S2,MB1,BI] 537-9-547ms    | [S6,MB3,BW] 547-0-547ms    | [S2,MB7,F]  554-7-562ms    | [S2,MB2,BI] 587-9-597ms    | [S2,MB0,BW] 596-0-596ms    | [S6,MB4,F]  603-7-611ms    | [S2,MB3,BI] 637-9-647ms    | [S2,MB1,BW] 647-0-647ms    | [S6,MB5,F]  654-7-661ms    | [S6,MB4,BI] 704-9-714ms    | [S2,MB2,BW] 714-0-714ms    | [S6,MB6,F]  721-7-729ms    | [S6,MB5,BI] 773-9-783ms    | [S2,MB3,BW] 782-0-782ms    | [S6,MB7,F]  790-7-797ms    | [S6,MB6,BI] 841-9-851ms    | [S6,MB4,BW] 851-0-851ms    | [S6,MB7,BI] 908-8-917ms    | [S6,MB5,BW] 917-0-917ms    | [S2,MB4,BI] 947-8-956ms    | [S6,MB6,BW] 956-0-956ms    | [S2,MB5,BI] 987-8-996ms    | [S6,MB7,BW] 996-0-996ms    | [S2,MB6,BI] 1027-8-1036ms  | [S2,MB4,BW] 1036-0-1036ms  | [S2,MB7,BI] 1066-8-1075ms  | [S2,MB5,BW] 1075-0-1075ms  | [S2,MB6,BW] 1075-0-1075ms  | [S2,MB7,BW] 1075-0-1075ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-8-76ms      | [S3,MB2,F]  107-7-115ms    | [S3,MB3,F]  145-7-153ms    | [S7,MB0,F]  182-15-197ms   | [S7,MB0,BI] 209-32-241ms   | [S7,MB1,F]  241-15-256ms   | [S7,MB1,BI] 269-33-302ms   | [S7,MB2,F]  302-17-319ms   | [S7,MB2,BI] 330-33-364ms   | [S7,MB3,F]  364-17-381ms   | [S7,MB3,BI] 393-33-427ms   | [S7,MB0,BW] 427-27-455ms   | [S3,MB4,F]  455-9-465ms    | [S3,MB0,BI] 465-12-478ms   | [S7,MB1,BW] 478-29-507ms   | [S3,MB5,F]  507-9-517ms    | [S3,MB1,BI] 517-12-529ms   | [S7,MB2,BW] 529-28-558ms   | [S3,MB6,F]  558-9-568ms    | [S3,MB2,BI] 568-11-580ms   | [S7,MB3,BW] 580-28-609ms   | [S3,MB7,F]  608-9-618ms    | [S3,MB3,BI] 618-11-630ms   | [S3,MB0,BW] 630-0-630ms    | [S7,MB4,F]  637-15-653ms   | [S7,MB4,BI] 665-33-698ms   | [S3,MB1,BW] 698-0-698ms    | [S7,MB5,F]  706-15-722ms   | [S7,MB5,BI] 733-32-766ms   | [S3,MB2,BW] 766-0-766ms    | [S7,MB6,F]  774-16-790ms   | [S7,MB6,BI] 802-32-835ms   | [S3,MB3,BW] 835-0-835ms    | [S7,MB7,F]  842-14-856ms   | [S7,MB7,BI] 868-32-901ms   | [S7,MB4,BW] 901-27-929ms   | [S3,MB4,BI] 929-11-940ms   | [S7,MB5,BW] 940-28-969ms   | [S3,MB5,BI] 969-11-980ms   | [S7,MB6,BW] 980-28-1009ms  | [S3,MB6,BI] 1009-11-1020ms | [S7,MB7,BW] 1020-28-1049ms | [S3,MB7,BI] 1049-11-1060ms | [S3,MB4,BW] 1060-0-1060ms  | [S3,MB5,BW] 1060-0-1060ms  | [S3,MB6,BW] 1060-0-1060ms  | [S3,MB7,BW] 1060-0-1060ms 
[rank0]:2025-12-31 12:22:20,821 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank0_stage4.svg
[rank0]:	> Counts Sum: 0, Total Sum: 270 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:22:20,896 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1222_stage3_step200.svg
[rank3]:2025-12-31 12:22:20,938 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1222_stage7_step200.svg
[rank3]:2025-12-31 12:22:21,038 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 270 (46.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66]
[rank3]:2025-12-31 12:22:21,119 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1222_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 165 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 12:23:03,590 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.8895e+00
[rank2]:2025-12-31 12:23:03,598 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:23:03,613 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0772e+00
[rank0]:2025-12-31 12:23:03,610 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.5386e+00
[rank3]:2025-12-31 12:23:49,494 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.6697e+00
[rank2]:2025-12-31 12:23:49,490 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6509e+00
[rank0]:2025-12-31 12:23:49,506 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.8155e+00
[rank1]:2025-12-31 12:23:49,501 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.6304e+00
[rank1]:2025-12-31 12:24:36,735 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 12:24:36,806 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3934e+00
[rank2]:2025-12-31 12:24:36,783 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.4491e+00
[rank0]:2025-12-31 12:24:36,803 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.4459e+00
[rank1]:2025-12-31 12:25:22,747 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:25:22,741 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.5771e+00
[rank2]:2025-12-31 12:25:22,737 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.8030e+00
[rank0]:2025-12-31 12:25:22,752 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.6878e+00
[rank3]:2025-12-31 12:26:09,766 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.1943e-01
[rank1]:2025-12-31 12:26:09,759 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2733e+00
[rank0]:2025-12-31 12:26:09,728 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 12:26:09,750 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-31 12:26:09,742 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.4225e+00
[rank3]:2025-12-31 12:26:14,213 - Avg. fwd time: 12.5471 / Avg. bwd-weight time: 18.0105 / Avg. bwd-input time: 22.4543 / Avg. batch time: 1074.3801 (ms) / GPU bubble ratio: 21.05%
[rank1]:2025-12-31 12:26:14,275 - Avg. fwd time: 9.5044 / Avg. bwd-weight time: 10.5152 / Avg. bwd-input time: 12.0448 / Avg. batch time: 1126.5346 (ms) / GPU bubble ratio: 54.46%
[rank0]:2025-12-31 12:26:14,270 - Avg. fwd time: 8.0050 / Avg. full-bwd time: 22.0946 (Avg. bwd-weight time: 9.3788 / Avg. bwd-input time: 9.7158) / Avg. batch time: 1139.3961 (ms) / GPU bubble ratio: 59.84%
[rank2]:2025-12-31 12:26:14,254 - Avg. fwd time: 7.4497 / Avg. bwd-weight time: 8.0364 / Avg. bwd-input time: 9.4864 / Avg. batch time: 1088.4958 (ms) / GPU bubble ratio: 63.29%
[rank2]:2025-12-31 12:26:14,294 -  step: 250  loss: -4.0000  grad_norm:  4.1960  memory: 14.56GiB(30.65%)  tps: 7,008  tflops: 54.79  mfu: 17.56%
[rank3]:2025-12-31 12:26:14,299 -  step: 250  loss:  0.3892  grad_norm:  4.1960  memory: 37.14GiB(78.18%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank1]:2025-12-31 12:26:14,300 -  step: 250  loss: -4.0000  grad_norm:  4.1960  memory: 19.04GiB(40.08%)  tps: 7,008  tflops: 54.79  mfu: 17.56%
[rank0]:2025-12-31 12:26:14,309 -  step: 250  loss: -4.0000  grad_norm:  4.1960  memory: 17.77GiB(37.40%)  tps: 7,008  tflops: 54.79  mfu: 17.56%
[rank3]:2025-12-31 12:26:55,528 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2620e+00
[rank1]:2025-12-31 12:26:55,532 - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 4.4532e+00
[rank2]:2025-12-31 12:26:55,524 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.4439e+00
[rank0]:2025-12-31 12:26:55,539 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-31 12:27:42,698 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.5938e+00
[rank2]:2025-12-31 12:27:42,694 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.1336e+00
[rank0]:2025-12-31 12:27:42,718 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.6700e+00
[rank3]:2025-12-31 12:27:42,718 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.9567e-01
[rank3]:2025-12-31 12:28:28,301 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.4500e+00
[rank1]:2025-12-31 12:28:28,307 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 5.8773e+00
[rank2]:2025-12-31 12:28:28,297 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.1632e+00
[rank0]:2025-12-31 12:28:28,309 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.5479e+00
[rank3]:2025-12-31 12:29:15,786 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.4039e+00
[rank1]:2025-12-31 12:29:15,762 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.7767e+00
[rank2]:2025-12-31 12:29:15,762 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.6487e+00
[rank0]:2025-12-31 12:29:15,786 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 5.9880e+00
[rank3]:2025-12-31 12:30:01,275 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.2425e+01
[rank1]:2025-12-31 12:30:01,282 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.2665e+01
[rank2]:2025-12-31 12:30:01,271 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.2315e+01
[rank0]:2025-12-31 12:30:01,249 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 12:30:01,283 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.6207e+01
[rank3]:2025-12-31 12:30:05,762 - Avg. fwd time: 12.5240 / Avg. bwd-weight time: 17.7684 / Avg. bwd-input time: 22.4372 / Avg. batch time: 1070.9905 (ms) / GPU bubble ratio: 21.22%
[rank1]:2025-12-31 12:30:05,790 - Avg. fwd time: 9.5052 / Avg. bwd-weight time: 10.4246 / Avg. bwd-input time: 12.0544 / Avg. batch time: 1124.0792 (ms) / GPU bubble ratio: 54.47%
[rank2]:2025-12-31 12:30:05,773 - Avg. fwd time: 7.4492 / Avg. bwd-weight time: 8.0379 / Avg. bwd-input time: 9.5026 / Avg. batch time: 1086.3507 (ms) / GPU bubble ratio: 63.19%
[rank0]:2025-12-31 12:30:05,811 - Avg. fwd time: 8.0001 / Avg. full-bwd time: 22.0831 (Avg. bwd-weight time: 9.4421 / Avg. bwd-input time: 9.7271) / Avg. batch time: 1137.6347 (ms) / GPU bubble ratio: 59.74%
[rank3]:2025-12-31 12:30:05,837 -  step: 300  loss:  0.2801  grad_norm:  0.8673  memory: 37.14GiB(78.18%)  tps: 7,076  tflops: 55.32  mfu: 17.73%
[rank1]:2025-12-31 12:30:05,825 -  step: 300  loss: -4.0000  grad_norm:  0.8673  memory: 19.04GiB(40.08%)  tps: 7,077  tflops: 55.32  mfu: 17.73%
[rank1]:2025-12-31 12:30:05,893 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1230_stage1_step300.svg
[rank2]:2025-12-31 12:30:05,819 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 14.56GiB(30.65%)  tps: 7,077  tflops: 55.32  mfu: 17.73%
[rank2]:2025-12-31 12:30:05,894 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1230_stage2_step300.svg
[rank0]:2025-12-31 12:30:05,843 -  step: 300  loss: -4.0000  grad_norm:  0.8673  memory: 17.77GiB(37.40%)  tps: 7,076  tflops: 55.32  mfu: 17.73%
[rank0]:2025-12-31 12:30:05,892 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1230_stage0_step300.svg
[rank1]:2025-12-31 12:30:05,934 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1230_stage5_step300.svg
[rank2]:2025-12-31 12:30:05,934 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1230_stage6_step300.svg
[rank0]:2025-12-31 12:30:05,934 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1230_stage4_step300.svg
[rank1]:2025-12-31 12:30:06,057 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank1_stage1.svg
[rank1]:	> Counts Sum: 189, Total Sum: 675 (28.00%), Ratio(%) per element: [32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0]
[rank2]:2025-12-31 12:30:06,031 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank2_stage2.svg
[rank2]:	> Counts Sum: 198, Total Sum: 450 (44.00%), Ratio(%) per element: [44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0]
[rank0]:2025-12-31 12:30:06,036 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank0_stage0.svg
[rank0]:	> Counts Sum: 117, Total Sum: 475 (24.63%), Ratio(%) per element: [0.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0]
[rank1]:2025-12-31 12:30:06,153 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank1_stage5.svg
[rank1]:	> Counts Sum: 27, Total Sum: 450 (6.00%), Ratio(%) per element: [12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:30:06,127 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank2_stage6.svg
[rank2]:	> Counts Sum: 36, Total Sum: 450 (8.00%), Ratio(%) per element: [16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 12:30:06,138 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank0_stage4.svg
[rank0]:	> Counts Sum: 9, Total Sum: 450 (2.00%), Ratio(%) per element: [4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:30:06,202 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1230_step300_rank3.svg
[rank3]:			> Batch Time: 1111.11 ms, GPU Bubble Ratio: 60.24%, 50.69%, 60.84%, 30.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  88-8-96ms      | [S4,MB2,F]  126-8-134ms    | [S4,MB3,F]  164-8-172ms    | [S4,MB0,BI] 278-9-287ms    | [S4,MB0,BW] 287-9-297ms    | [S0,MB4,F]  297-7-304ms    | [S4,MB1,BI] 338-10-348ms   | [S4,MB1,BW] 348-9-358ms    | [S0,MB5,F]  358-7-365ms    | [S4,MB2,BI] 412-10-422ms   | [S4,MB2,BW] 422-9-432ms    | [S0,MB6,F]  432-7-440ms    | [S4,MB3,BI] 480-10-491ms   | [S4,MB3,BW] 491-9-500ms    | [S0,MB7,F]  500-7-508ms    | [S0,MB0,B]  533-20-553ms   | [S4,MB4,F]  551-7-558ms    | [S0,MB1,B]  578-20-598ms   | [S4,MB5,F]  598-7-605ms    | [S0,MB2,B]  628-19-648ms   | [S4,MB6,F]  648-7-655ms    | [S0,MB3,B]  669-19-689ms   | [S4,MB7,F]  689-7-696ms    | [S4,MB4,BI] 731-10-741ms   | [S4,MB4,BW] 741-9-751ms    | [S4,MB5,BI] 815-9-824ms    | [S4,MB5,BW] 825-9-834ms    | [S4,MB6,BI] 865-9-874ms    | [S4,MB6,BW] 874-9-884ms    | [S4,MB7,BI] 929-9-938ms    | [S4,MB7,BW] 939-9-948ms    | [S0,MB4,B]  974-19-993ms   | [S0,MB5,B]  1013-19-1032ms | [S0,MB6,B]  1052-19-1071ms | [S0,MB7,B]  1092-19-1111ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  126-10-136ms   | [S5,MB0,F]  163-7-171ms    | [S5,MB1,F]  178-7-185ms    | [S5,MB2,F]  192-7-199ms    | [S5,MB0,BI] 261-9-271ms    | [S5,MB3,F]  271-8-279ms    | [S5,MB1,BI] 322-9-331ms    | [S5,MB0,BW] 331-10-342ms   | [S1,MB4,F]  342-10-353ms   | [S5,MB2,BI] 384-10-394ms   | [S5,MB1,BW] 394-9-403ms    | [S1,MB5,F]  412-11-423ms   | [S5,MB3,BI] 447-10-457ms   | [S5,MB2,BW] 457-9-467ms    | [S1,MB6,F]  481-11-492ms   | [S1,MB0,BI] 497-14-511ms   | [S5,MB3,BW] 511-9-521ms    | [S1,MB7,F]  534-11-545ms   | [S1,MB1,BI] 548-14-563ms   | [S1,MB0,BW] 563-15-579ms   | [S5,MB4,F]  579-7-587ms    | [S1,MB2,BI] 597-15-612ms   | [S1,MB1,BW] 612-15-628ms   | [S5,MB5,F]  629-7-637ms    | [S1,MB3,BI] 647-15-662ms   | [S1,MB2,BW] 662-15-678ms   | [S5,MB6,F]  676-7-684ms    | [S5,MB4,BI] 714-10-724ms   | [S1,MB3,BW] 724-15-740ms   | [S5,MB7,F]  739-7-746ms    | [S5,MB5,BI] 781-10-791ms   | [S5,MB4,BW] 791-9-800ms    | [S5,MB6,BI] 849-9-858ms    | [S5,MB5,BW] 858-10-868ms   | [S5,MB7,BI] 914-9-923ms    | [S5,MB6,BW] 923-10-933ms   | [S1,MB4,BI] 954-13-967ms   | [S5,MB7,BW] 967-10-977ms   | [S1,MB5,BI] 992-14-1006ms  | [S1,MB4,BW] 1006-15-1021ms | [S1,MB6,BI] 1032-14-1046ms | [S1,MB5,BW] 1045-15-1060ms | [S1,MB7,BI] 1071-14-1086ms | [S1,MB6,BW] 1085-15-1100ms | [S1,MB7,BW] 1099-15-1114ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  98-6-105ms     | [S2,MB3,F]  136-6-143ms    | [S6,MB0,F]  171-7-179ms    | [S6,MB1,F]  185-6-192ms    | [S6,MB0,BI] 245-9-255ms    | [S6,MB2,F]  255-8-263ms    | [S6,MB1,BI] 306-9-316ms    | [S6,MB3,F]  315-8-324ms    | [S6,MB2,BI] 368-8-377ms    | [S6,MB0,BW] 377-10-387ms   | [S2,MB4,F]  386-7-393ms    | [S6,MB3,BI] 431-9-440ms    | [S6,MB1,BW] 441-10-451ms   | [S2,MB5,F]  451-7-458ms    | [S2,MB0,BI] 480-9-490ms    | [S6,MB2,BW] 490-10-501ms   | [S2,MB6,F]  500-7-507ms    | [S2,MB1,BI] 531-10-541ms   | [S6,MB3,BW] 541-10-552ms   | [S2,MB7,F]  552-7-559ms    | [S2,MB2,BI] 580-10-590ms   | [S2,MB0,BW] 590-10-601ms   | [S6,MB4,F]  600-7-608ms    | [S2,MB3,BI] 630-10-640ms   | [S2,MB1,BW] 640-10-651ms   | [S6,MB5,F]  650-7-657ms    | [S6,MB4,BI] 697-10-707ms   | [S2,MB2,BW] 707-10-718ms   | [S6,MB6,F]  717-7-724ms    | [S6,MB5,BI] 764-10-774ms   | [S2,MB3,BW] 774-10-784ms   | [S6,MB7,F]  784-7-791ms    | [S6,MB6,BI] 832-10-842ms   | [S6,MB4,BW] 842-10-852ms   | [S6,MB7,BI] 898-9-907ms    | [S6,MB5,BW] 907-10-917ms   | [S2,MB4,BI] 937-9-947ms    | [S6,MB6,BW] 947-10-957ms   | [S2,MB5,BI] 977-9-986ms    | [S6,MB7,BW] 986-10-996ms   | [S2,MB6,BI] 1016-9-1025ms  | [S2,MB4,BW] 1025-10-1035ms | [S2,MB7,BI] 1055-9-1064ms  | [S2,MB5,BW] 1064-10-1074ms | [S2,MB6,BW] 1073-9-1083ms  | [S2,MB7,BW] 1082-9-1092ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-75ms      | [S3,MB2,F]  105-7-113ms    | [S3,MB3,F]  143-7-151ms    | [S7,MB0,F]  179-15-195ms   | [S7,MB0,BI] 207-32-239ms   | [S7,MB1,F]  239-14-254ms   | [S7,MB1,BI] 266-32-299ms   | [S7,MB2,F]  299-16-316ms   | [S7,MB2,BI] 328-33-361ms   | [S7,MB3,F]  361-16-378ms   | [S7,MB3,BI] 390-33-424ms   | [S7,MB0,BW] 424-27-451ms   | [S3,MB4,F]  451-9-460ms    | [S3,MB0,BI] 460-12-473ms   | [S7,MB1,BW] 473-28-502ms   | [S3,MB5,F]  501-9-511ms    | [S3,MB1,BI] 511-12-524ms   | [S7,MB2,BW] 524-28-552ms   | [S3,MB6,F]  552-9-562ms    | [S3,MB2,BI] 562-11-573ms   | [S7,MB3,BW] 573-28-601ms   | [S3,MB7,F]  601-9-611ms    | [S3,MB3,BI] 611-11-623ms   | [S3,MB0,BW] 623-0-623ms    | [S7,MB4,F]  630-15-646ms   | [S7,MB4,BI] 658-32-691ms   | [S3,MB1,BW] 691-0-691ms    | [S7,MB5,F]  697-14-712ms   | [S7,MB5,BI] 725-32-758ms   | [S3,MB2,BW] 757-0-757ms    | [S7,MB6,F]  764-15-779ms   | [S7,MB6,BI] 793-32-825ms   | [S3,MB3,BW] 826-0-826ms    | [S7,MB7,F]  832-15-848ms   | [S7,MB7,BI] 858-32-891ms   | [S7,MB4,BW] 891-27-919ms   | [S3,MB4,BI] 920-10-931ms   | [S7,MB5,BW] 931-28-959ms   | [S3,MB5,BI] 959-11-970ms   | [S7,MB6,BW] 970-28-998ms   | [S3,MB6,BI] 998-11-1009ms  | [S7,MB7,BW] 1010-28-1038ms | [S3,MB7,BI] 1038-11-1049ms | [S3,MB4,BW] 1049-0-1049ms  | [S3,MB5,BW] 1049-0-1049ms  | [S3,MB6,BW] 1049-0-1049ms  | [S3,MB7,BW] 1049-0-1049ms 
[rank3]:2025-12-31 12:30:06,249 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1230_stage3_step300.svg
[rank3]:2025-12-31 12:30:06,292 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1230_stage7_step300.svg
[rank3]:2025-12-31 12:30:06,401 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank3_stage3.svg
[rank3]:	> Counts Sum: 234, Total Sum: 450 (52.00%), Ratio(%) per element: [52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0]
[rank3]:2025-12-31 12:30:06,488 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1230_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 275 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:30:47,518 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 12:30:47,580 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1075e+01
[rank1]:2025-12-31 12:30:47,568 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.1299e+01
[rank0]:2025-12-31 12:30:47,588 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.1421e+01
[rank1]:2025-12-31 12:31:32,878 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.5989e+00
[rank3]:2025-12-31 12:31:32,890 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.5068e+00
[rank0]:2025-12-31 12:31:32,893 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.8458e+00
[rank2]:2025-12-31 12:31:32,888 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-31 12:32:18,514 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.4379e+00
[rank3]:2025-12-31 12:32:18,526 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1367e+00
[rank0]:2025-12-31 12:32:18,534 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5568e+00
[rank2]:2025-12-31 12:32:18,522 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.6927e+00
[rank1]:2025-12-31 12:33:03,692 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.3884e-01
[rank3]:2025-12-31 12:33:03,704 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.5810e-01
[rank0]:2025-12-31 12:33:03,700 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-31 12:33:03,700 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0678e+00
[rank1]:2025-12-31 12:33:49,171 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-31 12:33:49,194 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-31 12:33:49,189 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.4852e-01
[rank3]:2025-12-31 12:33:49,201 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.8535e-01
[rank0]:2025-12-31 12:33:49,208 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-31 12:33:53,741 - Avg. fwd time: 9.5548 / Avg. bwd-weight time: 9.5069 / Avg. bwd-input time: 12.0408 / Avg. batch time: 1117.8534 (ms) / GPU bubble ratio: 55.48%
[rank1]:2025-12-31 12:33:53,782 -  step: 350  loss: -4.0000  grad_norm:  0.2890  memory: 19.04GiB(40.08%)  tps: 7,187  tflops: 56.19  mfu: 18.01%
[rank3]:2025-12-31 12:33:53,712 - Avg. fwd time: 12.4974 / Avg. bwd-weight time: 17.2382 / Avg. bwd-input time: 22.3999 / Avg. batch time: 1064.1970 (ms) / GPU bubble ratio: 21.62%
[rank3]:2025-12-31 12:33:53,794 -  step: 350  loss:  0.2274  grad_norm:  0.2890  memory: 37.14GiB(78.18%)  tps: 7,187  tflops: 56.19  mfu: 18.01%
[rank0]:2025-12-31 12:33:53,767 - Avg. fwd time: 8.0268 / Avg. full-bwd time: 21.4598 (Avg. bwd-weight time: 9.2084 / Avg. bwd-input time: 9.7376) / Avg. batch time: 1134.0702 (ms) / GPU bubble ratio: 60.17%
[rank0]:2025-12-31 12:33:53,804 -  step: 350  loss: -4.0000  grad_norm:  0.2890  memory: 17.77GiB(37.40%)  tps: 7,187  tflops: 56.19  mfu: 18.01%
[rank2]:2025-12-31 12:33:53,752 - Avg. fwd time: 7.4521 / Avg. bwd-weight time: 7.9471 / Avg. bwd-input time: 9.5142 / Avg. batch time: 1083.4504 (ms) / GPU bubble ratio: 63.21%
[rank2]:2025-12-31 12:33:53,789 -  step: 350  loss: -4.0000  grad_norm:  0.2890  memory: 14.56GiB(30.65%)  tps: 7,187  tflops: 56.18  mfu: 18.01%
[rank1]:2025-12-31 12:34:34,914 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:34:34,926 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3781e+00
[rank0]:2025-12-31 12:34:34,938 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 7.2343e+00
[rank2]:2025-12-31 12:34:34,922 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.4164e+00
[rank0]:2025-12-31 12:35:20,625 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.0024e+00
[rank2]:2025-12-31 12:35:20,606 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.8975e+00
[rank1]:2025-12-31 12:35:20,624 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1493e+00
[rank3]:2025-12-31 12:35:20,618 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.7117e+00
[rank3]:2025-12-31 12:36:06,329 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.9418e+00
[rank1]:2025-12-31 12:36:06,279 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-31 12:36:06,341 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.0351e+01
[rank2]:2025-12-31 12:36:06,326 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.6701e+00
[rank2]:2025-12-31 12:36:51,710 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 12:36:51,778 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.8149e+01
[rank1]:2025-12-31 12:36:51,782 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-31 12:36:51,785 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.4833e+01
[rank0]:2025-12-31 12:37:37,096 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 12:37:37,128 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.1755e-01
[rank1]:2025-12-31 12:37:37,134 - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 9.9833e-01
[rank0]:2025-12-31 12:37:37,124 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-31 12:37:37,124 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:37:41,655 - Avg. fwd time: 12.4712 / Avg. bwd-weight time: 16.8419 / Avg. bwd-input time: 22.3698 / Avg. batch time: 1058.7294 (ms) / GPU bubble ratio: 21.89%
[rank1]:2025-12-31 12:37:41,695 - Avg. fwd time: 9.5591 / Avg. bwd-weight time: 9.3986 / Avg. bwd-input time: 12.0448 / Avg. batch time: 1115.0401 (ms) / GPU bubble ratio: 55.51%
[rank0]:2025-12-31 12:37:41,705 - Avg. fwd time: 8.0344 / Avg. full-bwd time: 21.3042 (Avg. bwd-weight time: 9.0331 / Avg. bwd-input time: 9.7425) / Avg. batch time: 1131.3674 (ms) / GPU bubble ratio: 60.30%
[rank2]:2025-12-31 12:37:41,695 - Avg. fwd time: 7.4551 / Avg. bwd-weight time: 7.8527 / Avg. bwd-input time: 9.5207 / Avg. batch time: 1080.6330 (ms) / GPU bubble ratio: 63.24%
[rank3]:2025-12-31 12:37:41,731 -  step: 400  loss:  0.2166  grad_norm:  0.3964  memory: 37.14GiB(78.18%)  tps: 7,188  tflops: 56.19  mfu: 18.01%
[rank1]:2025-12-31 12:37:41,723 -  step: 400  loss: -4.0000  grad_norm:  0.3964  memory: 19.04GiB(40.08%)  tps: 7,188  tflops: 56.19  mfu: 18.01%
[rank1]:2025-12-31 12:37:41,790 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1237_stage1_step400.svg
[rank0]:2025-12-31 12:37:41,736 -  step: 400  loss: -4.0000  grad_norm:  0.3964  memory: 17.77GiB(37.40%)  tps: 7,188  tflops: 56.19  mfu: 18.01%
[rank0]:2025-12-31 12:37:41,790 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1237_stage0_step400.svg
[rank2]:2025-12-31 12:37:41,726 -  step: 400  loss: -4.0000  grad_norm:  0.3964  memory: 14.56GiB(30.65%)  tps: 7,188  tflops: 56.19  mfu: 18.01%
[rank2]:2025-12-31 12:37:41,790 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1237_stage2_step400.svg
[rank1]:2025-12-31 12:37:41,834 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1237_stage5_step400.svg
[rank0]:2025-12-31 12:37:41,835 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1237_stage4_step400.svg
[rank2]:2025-12-31 12:37:41,834 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1237_stage6_step400.svg
[rank1]:2025-12-31 12:37:41,957 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank1_stage1.svg
[rank1]:	> Counts Sum: 360, Total Sum: 945 (38.10%), Ratio(%) per element: [42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28]
[rank0]:2025-12-31 12:37:41,938 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank0_stage0.svg
[rank0]:	> Counts Sum: 216, Total Sum: 665 (32.48%), Ratio(%) per element: [0.0, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42, 11.42]
[rank2]:2025-12-31 12:37:41,930 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank2_stage2.svg
[rank2]:	> Counts Sum: 252, Total Sum: 630 (40.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank3]:2025-12-31 12:37:42,072 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1237_step400_rank3.svg
[rank3]:			> Batch Time: 1106.53 ms, GPU Bubble Ratio: 69.92%, 50.51%, 60.66%, 30.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  53-9-62ms      | [S4,MB1,F]  91-8-100ms     | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  167-8-176ms    | [S4,MB0,BI] 281-9-290ms    | [S4,MB0,BW] 290-0-290ms    | [S0,MB4,F]  292-8-300ms    | [S4,MB1,BI] 341-9-351ms    | [S4,MB1,BW] 351-0-351ms    | [S0,MB5,F]  353-8-361ms    | [S4,MB2,BI] 416-10-426ms   | [S4,MB2,BW] 426-0-426ms    | [S0,MB6,F]  427-8-436ms    | [S4,MB3,BI] 484-10-494ms   | [S4,MB3,BW] 494-0-494ms    | [S0,MB7,F]  495-8-503ms    | [S0,MB0,B]  534-15-550ms   | [S4,MB4,F]  549-7-557ms    | [S0,MB1,B]  581-15-597ms   | [S4,MB5,F]  597-7-605ms    | [S0,MB2,B]  631-15-646ms   | [S4,MB6,F]  647-7-655ms    | [S0,MB3,B]  672-15-687ms   | [S4,MB7,F]  688-7-696ms    | [S4,MB4,BI] 734-10-744ms   | [S4,MB4,BW] 744-0-744ms    | [S4,MB5,BI] 818-9-827ms    | [S4,MB5,BW] 827-0-827ms    | [S4,MB6,BI] 866-9-875ms    | [S4,MB6,BW] 876-0-876ms    | [S4,MB7,BI] 931-9-940ms    | [S4,MB7,BW] 941-0-941ms    | [S0,MB4,B]  975-14-989ms   | [S0,MB5,B]  1014-14-1029ms | [S0,MB6,B]  1053-14-1067ms | [S0,MB7,B]  1092-14-1106ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  88-10-98ms     | [S1,MB3,F]  126-10-137ms   | [S5,MB0,F]  164-7-172ms    | [S5,MB1,F]  178-7-185ms    | [S5,MB2,F]  193-7-200ms    | [S5,MB0,BI] 262-9-271ms    | [S5,MB3,F]  272-8-280ms    | [S5,MB1,BI] 322-9-332ms    | [S5,MB0,BW] 332-10-343ms   | [S1,MB4,F]  342-10-353ms   | [S5,MB2,BI] 384-10-394ms   | [S5,MB1,BW] 394-9-403ms    | [S1,MB5,F]  412-11-423ms   | [S5,MB3,BI] 447-9-457ms    | [S5,MB2,BW] 457-9-466ms    | [S1,MB6,F]  481-11-492ms   | [S1,MB0,BI] 497-14-511ms   | [S5,MB3,BW] 511-9-521ms    | [S1,MB7,F]  532-11-543ms   | [S1,MB1,BI] 548-14-562ms   | [S1,MB0,BW] 563-15-578ms   | [S5,MB4,F]  579-7-586ms    | [S1,MB2,BI] 597-15-612ms   | [S1,MB1,BW] 612-15-628ms   | [S5,MB5,F]  629-7-636ms    | [S1,MB3,BI] 647-15-662ms   | [S1,MB2,BW] 662-15-677ms   | [S5,MB6,F]  677-7-684ms    | [S5,MB4,BI] 713-10-723ms   | [S1,MB3,BW] 724-15-739ms   | [S5,MB7,F]  739-7-746ms    | [S5,MB5,BI] 779-10-789ms   | [S5,MB4,BW] 789-9-799ms    | [S5,MB6,BI] 847-9-856ms    | [S5,MB5,BW] 856-10-866ms   | [S5,MB7,BI] 912-9-921ms    | [S5,MB6,BW] 921-10-931ms   | [S1,MB4,BI] 951-13-964ms   | [S5,MB7,BW] 965-10-975ms   | [S1,MB5,BI] 991-14-1005ms  | [S1,MB4,BW] 1004-15-1019ms | [S1,MB6,BI] 1031-14-1045ms | [S1,MB5,BW] 1045-15-1060ms | [S1,MB7,BI] 1070-14-1085ms | [S1,MB6,BW] 1085-15-1100ms | [S1,MB7,BW] 1099-15-1114ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  98-6-105ms     | [S2,MB3,F]  137-6-144ms    | [S6,MB0,F]  172-7-180ms    | [S6,MB1,F]  186-6-193ms    | [S6,MB0,BI] 246-9-255ms    | [S6,MB2,F]  255-8-264ms    | [S6,MB1,BI] 306-9-316ms    | [S6,MB3,F]  316-8-324ms    | [S6,MB2,BI] 368-8-377ms    | [S6,MB0,BW] 377-10-387ms   | [S2,MB4,F]  387-7-394ms    | [S6,MB3,BI] 430-9-440ms    | [S6,MB1,BW] 440-10-451ms   | [S2,MB5,F]  451-7-458ms    | [S2,MB0,BI] 479-9-489ms    | [S6,MB2,BW] 490-10-500ms   | [S2,MB6,F]  500-7-507ms    | [S2,MB1,BI] 531-9-541ms    | [S6,MB3,BW] 541-10-552ms   | [S2,MB7,F]  551-7-558ms    | [S2,MB2,BI] 580-10-590ms   | [S2,MB0,BW] 590-10-601ms   | [S6,MB4,F]  600-7-607ms    | [S2,MB3,BI] 629-10-640ms   | [S2,MB1,BW] 640-10-651ms   | [S6,MB5,F]  650-7-657ms    | [S6,MB4,BI] 696-10-707ms   | [S2,MB2,BW] 706-10-717ms   | [S6,MB6,F]  717-7-724ms    | [S6,MB5,BI] 762-10-772ms   | [S2,MB3,BW] 772-10-783ms   | [S6,MB7,F]  783-7-791ms    | [S6,MB6,BI] 830-10-840ms   | [S6,MB4,BW] 840-10-850ms   | [S6,MB7,BI] 896-8-905ms    | [S6,MB5,BW] 905-10-915ms   | [S2,MB4,BI] 935-9-944ms    | [S6,MB6,BW] 944-10-954ms   | [S2,MB5,BI] 975-9-984ms    | [S6,MB7,BW] 984-10-994ms   | [S2,MB6,BI] 1015-9-1024ms  | [S2,MB4,BW] 1024-10-1034ms | [S2,MB7,BI] 1054-9-1064ms  | [S2,MB5,BW] 1063-10-1074ms | [S2,MB6,BW] 1072-9-1082ms  | [S2,MB7,BW] 1082-9-1092ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-75ms      | [S3,MB2,F]  105-7-113ms    | [S3,MB3,F]  143-7-151ms    | [S7,MB0,F]  180-15-196ms   | [S7,MB0,BI] 208-32-240ms   | [S7,MB1,F]  240-14-255ms   | [S7,MB1,BI] 267-32-300ms   | [S7,MB2,F]  300-16-316ms   | [S7,MB2,BI] 328-33-361ms   | [S7,MB3,F]  361-16-378ms   | [S7,MB3,BI] 390-33-424ms   | [S7,MB0,BW] 424-27-451ms   | [S3,MB4,F]  451-9-460ms    | [S3,MB0,BI] 460-12-472ms   | [S7,MB1,BW] 472-28-501ms   | [S3,MB5,F]  501-9-511ms    | [S3,MB1,BI] 511-12-523ms   | [S7,MB2,BW] 523-28-552ms   | [S3,MB6,F]  552-9-561ms    | [S3,MB2,BI] 561-11-573ms   | [S7,MB3,BW] 573-28-601ms   | [S3,MB7,F]  601-9-611ms    | [S3,MB3,BI] 611-11-623ms   | [S3,MB0,BW] 623-0-623ms    | [S7,MB4,F]  630-15-646ms   | [S7,MB4,BI] 658-32-691ms   | [S3,MB1,BW] 690-0-690ms    | [S7,MB5,F]  697-14-711ms   | [S7,MB5,BI] 724-32-756ms   | [S3,MB2,BW] 756-0-756ms    | [S7,MB6,F]  763-16-780ms   | [S7,MB6,BI] 791-32-824ms   | [S3,MB3,BW] 824-0-824ms    | [S7,MB7,F]  830-14-845ms   | [S7,MB7,BI] 857-32-889ms   | [S7,MB4,BW] 889-27-917ms   | [S3,MB4,BI] 917-11-928ms   | [S7,MB5,BW] 928-28-957ms   | [S3,MB5,BI] 957-10-968ms   | [S7,MB6,BW] 968-28-996ms   | [S3,MB6,BI] 996-10-1007ms  | [S7,MB7,BW] 1008-28-1036ms | [S3,MB7,BI] 1036-11-1047ms | [S3,MB4,BW] 1048-0-1048ms  | [S3,MB5,BW] 1048-0-1048ms  | [S3,MB6,BW] 1048-0-1048ms  | [S3,MB7,BW] 1048-0-1048ms 
[rank1]:2025-12-31 12:37:42,055 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank1_stage5.svg
[rank1]:	> Counts Sum: 45, Total Sum: 630 (7.14%), Ratio(%) per element: [14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 12:37:42,040 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank0_stage4.svg
[rank0]:	> Counts Sum: 27, Total Sum: 630 (4.29%), Ratio(%) per element: [8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 8.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:37:42,028 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank2_stage6.svg
[rank2]:	> Counts Sum: 45, Total Sum: 630 (7.14%), Ratio(%) per element: [14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 14.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:37:42,121 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1237_stage3_step400.svg
[rank3]:2025-12-31 12:37:42,166 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1237_stage7_step400.svg
[rank3]:2025-12-31 12:37:42,268 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank3_stage3.svg
[rank3]:	> Counts Sum: 414, Total Sum: 630 (65.71%), Ratio(%) per element: [65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71]
[rank3]:2025-12-31 12:37:42,347 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1237_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 385 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:38:07,794 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 12:38:08,271 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 12:38:08,285 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 12:38:08,271 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-31 12:38:23,122 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.7845e+00
[rank1]:2025-12-31 12:38:23,115 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.9519e+00
[rank0]:2025-12-31 12:38:23,130 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 12:38:23,120 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.1654e+00
[rank2]:2025-12-31 12:39:08,729 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.3925e+00
[rank3]:2025-12-31 12:39:08,741 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.6983e-01
[rank1]:2025-12-31 12:39:08,748 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.1172e+00
[rank0]:2025-12-31 12:39:08,753 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.3614e+01
[rank3]:2025-12-31 12:39:54,034 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.4412e+00
[rank1]:2025-12-31 12:39:54,023 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.2994e+00
[rank0]:2025-12-31 12:39:54,042 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.3906e+00
[rank2]:2025-12-31 12:39:54,032 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.1829e+00
[rank3]:2025-12-31 12:40:39,717 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1564e+00
[rank1]:2025-12-31 12:40:39,723 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.3245e+00
[rank0]:2025-12-31 12:40:39,732 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 4.1683e+00
[rank2]:2025-12-31 12:40:39,705 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.2220e+00
[rank2]:2025-12-31 12:41:25,228 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.5706e+00
[rank1]:2025-12-31 12:41:25,220 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8101e+00
[rank3]:2025-12-31 12:41:25,231 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9422e+00
[rank0]:2025-12-31 12:41:25,226 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 12:41:25,239 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.5218e+00
[rank3]:2025-12-31 12:41:29,704 - Avg. fwd time: 12.4498 / Avg. bwd-weight time: 16.5296 / Avg. bwd-input time: 22.3413 / Avg. batch time: 1054.3325 (ms) / GPU bubble ratio: 22.12%
[rank2]:2025-12-31 12:41:29,719 - Avg. fwd time: 7.4540 / Avg. bwd-weight time: 7.8714 / Avg. bwd-input time: 9.5262 / Avg. batch time: 1078.3830 (ms) / GPU bubble ratio: 63.13%
[rank1]:2025-12-31 12:41:29,765 - Avg. fwd time: 9.5615 / Avg. bwd-weight time: 9.3201 / Avg. bwd-input time: 12.0468 / Avg. batch time: 1112.4140 (ms) / GPU bubble ratio: 55.52%
[rank1]:2025-12-31 12:41:29,789 -  step: 450  loss: -4.0000  grad_norm:  0.6841  memory: 19.04GiB(40.08%)  tps: 7,184  tflops: 56.16  mfu: 18.00%
[rank3]:2025-12-31 12:41:29,789 -  step: 450  loss:  0.2291  grad_norm:  0.6841  memory: 37.14GiB(78.18%)  tps: 7,184  tflops: 56.16  mfu: 18.00%
[rank0]:2025-12-31 12:41:29,759 - Avg. fwd time: 8.0301 / Avg. full-bwd time: 21.3039 (Avg. bwd-weight time: 9.1134 / Avg. bwd-input time: 9.7457) / Avg. batch time: 1129.2910 (ms) / GPU bubble ratio: 60.17%
[rank0]:2025-12-31 12:41:29,798 -  step: 450  loss: -4.0000  grad_norm:  0.6841  memory: 17.77GiB(37.40%)  tps: 7,184  tflops: 56.16  mfu: 18.00%
[rank2]:2025-12-31 12:41:29,771 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 14.56GiB(30.65%)  tps: 7,185  tflops: 56.17  mfu: 18.00%
[rank2]:2025-12-31 12:42:10,877 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-31 12:42:10,951 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 8.4436e+00
[rank3]:2025-12-31 12:42:10,945 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.6731e+00
[rank0]:2025-12-31 12:42:10,957 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.3059e+01
[rank1]:2025-12-31 12:42:56,317 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.8176e+03
[rank0]:2025-12-31 12:42:56,336 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.7826e+03
[rank2]:2025-12-31 12:42:56,325 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:42:56,329 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.7673e+03
[rank3]:2025-12-31 12:43:41,568 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5548e-01
[rank1]:2025-12-31 12:43:41,532 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-31 12:43:41,565 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-31 12:43:41,566 - Freezing Ratio: [Stage2] 0.50, [Stage6] 0.00, Threshold: 8.6684e-01
[rank3]:2025-12-31 12:44:27,130 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0975e+00
[rank1]:2025-12-31 12:44:27,118 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-31 12:44:27,137 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 12:44:27,118 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.0568e+00
[rank3]:2025-12-31 12:45:12,704 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0513e-01
[rank1]:2025-12-31 12:45:12,709 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.4063e-01
[rank0]:2025-12-31 12:45:12,683 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 12:45:12,717 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.7988e+00
[rank2]:2025-12-31 12:45:12,700 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0706e+00
[rank3]:2025-12-31 12:45:17,174 - Avg. fwd time: 12.4347 / Avg. bwd-weight time: 16.2823 / Avg. bwd-input time: 22.3209 / Avg. batch time: 1050.9527 (ms) / GPU bubble ratio: 22.30%
[rank1]:2025-12-31 12:45:17,203 - Avg. fwd time: 9.5730 / Avg. bwd-weight time: 9.0678 / Avg. bwd-input time: 12.0425 / Avg. batch time: 1109.9712 (ms) / GPU bubble ratio: 55.77%
[rank0]:2025-12-31 12:45:17,223 - Avg. fwd time: 8.0350 / Avg. full-bwd time: 21.1962 (Avg. bwd-weight time: 8.9821 / Avg. bwd-input time: 9.7480) / Avg. batch time: 1127.4811 (ms) / GPU bubble ratio: 60.27%
[rank2]:2025-12-31 12:45:17,186 - Avg. fwd time: 7.4512 / Avg. bwd-weight time: 7.8134 / Avg. bwd-input time: 9.5277 / Avg. batch time: 1076.6384 (ms) / GPU bubble ratio: 63.16%
[rank2]:2025-12-31 12:45:17,237 -  step: 500  loss: -4.0000  grad_norm:  0.2999  memory: 14.56GiB(30.65%)  tps: 7,203  tflops: 56.31  mfu: 18.05%
[rank3]:2025-12-31 12:45:17,249 -  step: 500  loss:  0.2223  grad_norm:  0.2999  memory: 37.14GiB(78.18%)  tps: 7,203  tflops: 56.31  mfu: 18.05%
[rank1]:2025-12-31 12:45:17,231 -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 19.04GiB(40.08%)  tps: 7,204  tflops: 56.31  mfu: 18.05%
[rank1]:2025-12-31 12:45:17,305 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1245_stage1_step500.svg
[rank0]:2025-12-31 12:45:17,255 -  step: 500  loss: -4.0000  grad_norm:  0.2999  memory: 17.77GiB(37.40%)  tps: 7,203  tflops: 56.31  mfu: 18.05%
[rank0]:2025-12-31 12:45:17,304 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1245_stage0_step500.svg
[rank2]:2025-12-31 12:45:17,305 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1245_stage2_step500.svg
[rank2]:2025-12-31 12:45:17,345 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1245_stage6_step500.svg
[rank1]:2025-12-31 12:45:17,344 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1245_stage5_step500.svg
[rank0]:2025-12-31 12:45:17,344 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1245_stage4_step500.svg
[rank2]:2025-12-31 12:45:17,440 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank2_stage2.svg
[rank2]:	> Counts Sum: 333, Total Sum: 810 (41.11%), Ratio(%) per element: [42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank1]:2025-12-31 12:45:17,465 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank1_stage1.svg
[rank1]:	> Counts Sum: 522, Total Sum: 1215 (42.96%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 42.22, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank0]:2025-12-31 12:45:17,444 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank0_stage0.svg
[rank0]:	> Counts Sum: 279, Total Sum: 855 (32.63%), Ratio(%) per element: [0.0, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 11.11, 11.11, 11.11, 11.11, 11.11, 11.11, 11.11, 11.11, 11.11]
[rank2]:2025-12-31 12:45:17,536 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank2_stage6.svg
[rank2]:	> Counts Sum: 54, Total Sum: 810 (6.67%), Ratio(%) per element: [13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:45:17,582 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1245_step500_rank3.svg
[rank3]:			> Batch Time: 1110.62 ms, GPU Bubble Ratio: 57.20%, 50.85%, 60.91%, 30.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-134ms    | [S4,MB3,F]  163-8-172ms    | [S4,MB0,BI] 277-9-286ms    | [S4,MB0,BW] 286-9-296ms    | [S0,MB4,F]  296-7-303ms    | [S4,MB1,BI] 337-9-347ms    | [S4,MB1,BW] 347-9-357ms    | [S0,MB5,F]  357-7-364ms    | [S4,MB2,BI] 411-10-421ms   | [S4,MB2,BW] 422-9-431ms    | [S0,MB6,F]  431-7-439ms    | [S4,MB3,BI] 480-10-490ms   | [S4,MB3,BW] 490-9-500ms    | [S0,MB7,F]  500-7-507ms    | [S0,MB0,B]  531-24-556ms   | [S4,MB4,F]  553-7-561ms    | [S0,MB1,B]  578-24-602ms   | [S4,MB5,F]  601-7-608ms    | [S0,MB2,B]  628-24-652ms   | [S4,MB6,F]  651-7-658ms    | [S0,MB3,B]  667-24-691ms   | [S4,MB7,F]  691-7-698ms    | [S4,MB4,BI] 729-10-739ms   | [S4,MB4,BW] 740-9-749ms    | [S4,MB5,BI] 811-9-820ms    | [S4,MB5,BW] 820-9-829ms    | [S4,MB6,BI] 860-9-869ms    | [S4,MB6,BW] 869-9-879ms    | [S4,MB7,BI] 925-9-934ms    | [S4,MB7,BW] 935-10-945ms   | [S0,MB4,B]  969-23-992ms   | [S0,MB5,B]  1008-23-1031ms | [S0,MB6,B]  1047-23-1070ms | [S0,MB7,B]  1087-23-1110ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-10-136ms   | [S5,MB0,F]  163-7-171ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB0,BI] 261-9-270ms    | [S5,MB3,F]  270-8-279ms    | [S5,MB1,BI] 321-9-330ms    | [S5,MB0,BW] 330-10-341ms   | [S1,MB4,F]  340-10-351ms   | [S5,MB2,BI] 383-10-393ms   | [S5,MB1,BW] 393-9-402ms    | [S1,MB5,F]  411-11-422ms   | [S5,MB3,BI] 446-9-456ms    | [S5,MB2,BW] 456-9-465ms    | [S1,MB6,F]  481-11-492ms   | [S1,MB0,BI] 497-14-511ms   | [S5,MB3,BW] 511-9-521ms    | [S1,MB7,F]  532-11-543ms   | [S1,MB1,BI] 548-14-563ms   | [S1,MB0,BW] 563-15-578ms   | [S5,MB4,F]  579-7-586ms    | [S1,MB2,BI] 597-15-612ms   | [S1,MB1,BW] 612-15-627ms   | [S5,MB5,F]  628-7-636ms    | [S1,MB3,BI] 646-15-661ms   | [S1,MB2,BW] 661-15-676ms   | [S5,MB6,F]  676-7-683ms    | [S5,MB4,BI] 713-10-723ms   | [S1,MB3,BW] 723-15-739ms   | [S5,MB7,F]  737-7-744ms    | [S5,MB5,BI] 779-10-789ms   | [S5,MB4,BW] 789-9-798ms    | [S5,MB6,BI] 844-9-853ms    | [S5,MB5,BW] 853-10-863ms   | [S5,MB7,BI] 910-9-919ms    | [S5,MB6,BW] 919-10-929ms   | [S1,MB4,BI] 948-13-962ms   | [S5,MB7,BW] 962-10-972ms   | [S1,MB5,BI] 987-14-1001ms  | [S1,MB4,BW] 1001-15-1016ms | [S1,MB6,BI] 1026-14-1040ms | [S1,MB5,BW] 1040-15-1055ms | [S1,MB7,BI] 1065-14-1080ms | [S1,MB6,BW] 1080-15-1095ms | [S1,MB7,BW] 1093-15-1108ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-6-66ms      | [S2,MB2,F]  98-6-104ms     | [S2,MB3,F]  136-6-143ms    | [S6,MB0,F]  171-7-179ms    | [S6,MB1,F]  185-6-192ms    | [S6,MB0,BI] 245-9-254ms    | [S6,MB2,F]  254-8-262ms    | [S6,MB1,BI] 305-9-314ms    | [S6,MB3,F]  314-8-323ms    | [S6,MB2,BI] 367-8-376ms    | [S6,MB0,BW] 376-10-387ms   | [S2,MB4,F]  386-7-393ms    | [S6,MB3,BI] 429-9-439ms    | [S6,MB1,BW] 439-10-450ms   | [S2,MB5,F]  450-7-457ms    | [S2,MB0,BI] 480-9-490ms    | [S6,MB2,BW] 490-10-501ms   | [S2,MB6,F]  500-7-508ms    | [S2,MB1,BI] 531-9-541ms    | [S6,MB3,BW] 541-10-552ms   | [S2,MB7,F]  552-7-559ms    | [S2,MB2,BI] 580-10-590ms   | [S2,MB0,BW] 590-10-601ms   | [S6,MB4,F]  599-7-606ms    | [S2,MB3,BI] 630-10-640ms   | [S2,MB1,BW] 640-10-650ms   | [S6,MB5,F]  649-7-656ms    | [S6,MB4,BI] 697-10-707ms   | [S2,MB2,BW] 707-10-717ms   | [S6,MB6,F]  716-7-723ms    | [S6,MB5,BI] 762-10-772ms   | [S2,MB3,BW] 772-10-783ms   | [S6,MB7,F]  782-7-789ms    | [S6,MB6,BI] 827-10-837ms   | [S6,MB4,BW] 837-10-847ms   | [S6,MB7,BI] 894-8-903ms    | [S6,MB5,BW] 903-10-913ms   | [S2,MB4,BI] 932-9-941ms    | [S6,MB6,BW] 941-10-951ms   | [S2,MB5,BI] 971-9-980ms    | [S6,MB7,BW] 980-10-990ms   | [S2,MB6,BI] 1010-9-1019ms  | [S2,MB4,BW] 1020-10-1030ms | [S2,MB7,BI] 1049-8-1058ms  | [S2,MB5,BW] 1058-10-1068ms | [S2,MB6,BW] 1067-9-1076ms  | [S2,MB7,BW] 1075-9-1085ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  66-7-74ms      | [S3,MB2,F]  104-7-112ms    | [S3,MB3,F]  143-7-150ms    | [S7,MB0,F]  179-15-194ms   | [S7,MB0,BI] 206-31-238ms   | [S7,MB1,F]  239-14-253ms   | [S7,MB1,BI] 265-32-298ms   | [S7,MB2,F]  298-16-314ms   | [S7,MB2,BI] 327-33-361ms   | [S7,MB3,F]  360-16-377ms   | [S7,MB3,BI] 390-33-423ms   | [S7,MB0,BW] 423-27-450ms   | [S3,MB4,F]  450-9-460ms    | [S3,MB0,BI] 460-12-473ms   | [S7,MB1,BW] 473-28-502ms   | [S3,MB5,F]  502-9-512ms    | [S3,MB1,BI] 512-12-524ms   | [S7,MB2,BW] 524-28-552ms   | [S3,MB6,F]  552-9-562ms    | [S3,MB2,BI] 562-11-573ms   | [S7,MB3,BW] 573-28-601ms   | [S3,MB7,F]  602-9-611ms    | [S3,MB3,BI] 612-11-623ms   | [S3,MB0,BW] 624-0-624ms    | [S7,MB4,F]  631-15-646ms   | [S7,MB4,BI] 658-32-691ms   | [S3,MB1,BW] 691-0-691ms    | [S7,MB5,F]  697-14-711ms   | [S7,MB5,BI] 724-32-756ms   | [S3,MB2,BW] 756-0-756ms    | [S7,MB6,F]  763-14-777ms   | [S7,MB6,BI] 789-32-821ms   | [S3,MB3,BW] 821-0-821ms    | [S7,MB7,F]  828-14-843ms   | [S7,MB7,BI] 856-32-888ms   | [S7,MB4,BW] 888-26-914ms   | [S3,MB4,BI] 915-10-926ms   | [S7,MB5,BW] 926-28-954ms   | [S3,MB5,BI] 954-10-964ms   | [S7,MB6,BW] 965-28-993ms   | [S3,MB6,BI] 993-10-1003ms  | [S7,MB7,BW] 1004-28-1032ms | [S3,MB7,BI] 1032-11-1043ms | [S3,MB4,BW] 1043-0-1043ms  | [S3,MB5,BW] 1043-0-1043ms  | [S3,MB6,BW] 1043-0-1043ms  | [S3,MB7,BW] 1043-0-1043ms 
[rank1]:2025-12-31 12:45:17,562 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank1_stage5.svg
[rank1]:	> Counts Sum: 63, Total Sum: 810 (7.78%), Ratio(%) per element: [15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 15.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 12:45:17,541 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank0_stage4.svg
[rank0]:	> Counts Sum: 36, Total Sum: 810 (4.44%), Ratio(%) per element: [8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:45:17,626 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1245_stage3_step500.svg
[rank3]:2025-12-31 12:45:17,667 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1245_stage7_step500.svg
[rank3]:2025-12-31 12:45:17,769 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank3_stage3.svg
[rank3]:	> Counts Sum: 594, Total Sum: 810 (73.33%), Ratio(%) per element: [73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33]
[rank3]:2025-12-31 12:45:17,848 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1245_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 495 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 12:45:58,673 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 12:45:58,717 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1880e+00
[rank0]:2025-12-31 12:45:58,724 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7668e+00
[rank2]:2025-12-31 12:45:58,705 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.2908e+00
[rank2]:2025-12-31 12:46:44,350 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.9217e+00
[rank3]:2025-12-31 12:46:44,353 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0232e+00
[rank1]:2025-12-31 12:46:44,360 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-31 12:46:44,365 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 8.8636e+00
[rank2]:2025-12-31 12:47:29,866 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 12:47:29,936 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3938e+00
[rank1]:2025-12-31 12:47:29,939 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.5862e+00
[rank0]:2025-12-31 12:47:29,941 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7198e+00
[rank3]:2025-12-31 12:48:15,509 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1316e+00
[rank1]:2025-12-31 12:48:15,517 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8244e+00
[rank2]:2025-12-31 12:48:15,505 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-31 12:48:15,520 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.0386e+01
[rank3]:2025-12-31 12:49:00,989 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.7951e-01
[rank1]:2025-12-31 12:49:00,995 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.1151e+00
[rank2]:2025-12-31 12:49:00,986 - Freezing Ratio: [Stage2] 0.50, [Stage6] 0.00, Threshold: 1.2828e+00
[rank0]:2025-12-31 12:49:00,977 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 12:49:00,997 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.0752e+00
[rank3]:2025-12-31 12:49:05,542 - Avg. fwd time: 12.4208 / Avg. bwd-weight time: 16.0795 / Avg. bwd-input time: 22.3046 / Avg. batch time: 1048.0515 (ms) / GPU bubble ratio: 22.44%
[rank1]:2025-12-31 12:49:05,571 - Avg. fwd time: 9.5679 / Avg. bwd-weight time: 9.1736 / Avg. bwd-input time: 12.0495 / Avg. batch time: 1109.1839 (ms) / GPU bubble ratio: 55.58%
[rank1]:2025-12-31 12:49:05,610 -  step: 550  loss: -4.0000  grad_norm:  1.1016  memory: 19.04GiB(40.08%)  tps: 7,174  tflops: 56.08  mfu: 17.98%
[rank2]:2025-12-31 12:49:05,553 - Avg. fwd time: 7.4526 / Avg. bwd-weight time: 7.7569 / Avg. bwd-input time: 9.5296 / Avg. batch time: 1075.1960 (ms) / GPU bubble ratio: 63.19%
[rank2]:2025-12-31 12:49:05,610 -  step: 550  loss: -4.0000  grad_norm:  1.1016  memory: 14.56GiB(30.65%)  tps: 7,174  tflops: 56.08  mfu: 17.98%
[rank0]:2025-12-31 12:49:05,595 - Avg. fwd time: 8.0324 / Avg. full-bwd time: 21.2055 (Avg. bwd-weight time: 9.0529 / Avg. bwd-input time: 9.7495) / Avg. batch time: 1126.1666 (ms) / GPU bubble ratio: 60.17%
[rank0]:2025-12-31 12:49:05,631 -  step: 550  loss: -4.0000  grad_norm:  1.1016  memory: 17.77GiB(37.40%)  tps: 7,174  tflops: 56.08  mfu: 17.98%
[rank3]:2025-12-31 12:49:05,622 -  step: 550  loss:  0.2296  grad_norm:  1.1016  memory: 37.14GiB(78.18%)  tps: 7,174  tflops: 56.09  mfu: 17.98%
[rank3]:2025-12-31 12:49:47,021 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0464e+00
[rank1]:2025-12-31 12:49:47,009 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9054e+00
[rank2]:2025-12-31 12:49:47,009 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.2025e+00
[rank0]:2025-12-31 12:49:47,032 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.4364e+00
[rank3]:2025-12-31 12:50:32,666 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3183e+00
[rank1]:2025-12-31 12:50:32,670 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.7868e+00
[rank2]:2025-12-31 12:50:32,661 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6766e+00
[rank0]:2025-12-31 12:50:32,672 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7117e+00
[rank2]:2025-12-31 12:51:18,604 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.2881e+00
[rank1]:2025-12-31 12:51:18,604 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.1817e+00
[rank3]:2025-12-31 12:51:18,616 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0471e+00
[rank0]:2025-12-31 12:51:18,627 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 7.6562e+00
[rank2]:2025-12-31 12:52:04,160 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.4502e+00
[rank0]:2025-12-31 12:52:04,171 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.0913e+00
[rank3]:2025-12-31 12:52:04,164 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.0932e+00
[rank1]:2025-12-31 12:52:04,170 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 3.6488e+00
[rank0]:2025-12-31 12:52:50,127 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 12:52:50,135 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.7947e-01
[rank3]:2025-12-31 12:52:50,146 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7682e-01
[rank2]:2025-12-31 12:52:50,135 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.3106e-01
[rank0]:2025-12-31 12:52:50,158 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 7.8909e+00
[rank3]:2025-12-31 12:52:54,716 - Avg. fwd time: 12.4188 / Avg. bwd-weight time: 15.9166 / Avg. bwd-input time: 22.2972 / Avg. batch time: 1046.1293 (ms) / GPU bubble ratio: 22.56%
[rank1]:2025-12-31 12:52:54,779 - Avg. fwd time: 9.5773 / Avg. bwd-weight time: 9.0946 / Avg. bwd-input time: 12.0510 / Avg. batch time: 1107.9098 (ms) / GPU bubble ratio: 55.63%
[rank1]:2025-12-31 12:52:54,802 -  step: 600  loss: -4.0000  grad_norm:  0.8107  memory: 19.04GiB(40.08%)  tps: 7,149  tflops: 55.88  mfu: 17.91%
[rank3]:2025-12-31 12:52:54,803 -  step: 600  loss:  0.2256  grad_norm:  0.8107  memory: 37.14GiB(78.18%)  tps: 7,149  tflops: 55.89  mfu: 17.91%
[rank2]:2025-12-31 12:52:54,758 - Avg. fwd time: 7.4550 / Avg. bwd-weight time: 7.7201 / Avg. bwd-input time: 9.5324 / Avg. batch time: 1073.9501 (ms) / GPU bubble ratio: 63.19%
[rank2]:2025-12-31 12:52:54,797 -  step: 600  loss: -4.0000  grad_norm:  0.8107  memory: 14.56GiB(30.65%)  tps: 7,149  tflops: 55.89  mfu: 17.91%
[rank0]:2025-12-31 12:52:54,766 - Avg. fwd time: 8.0296 / Avg. full-bwd time: 21.2791 (Avg. bwd-weight time: 9.1130 / Avg. bwd-input time: 9.7526) / Avg. batch time: 1125.4732 (ms) / GPU bubble ratio: 60.05%
[rank0]:2025-12-31 12:52:54,808 -  step: 600  loss: -4.0000  grad_norm:  0.8107  memory: 17.77GiB(37.40%)  tps: 7,149  tflops: 55.89  mfu: 17.91%
[rank1]:2025-12-31 12:52:54,860 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1252_stage1_step600.svg
[rank1]:2025-12-31 12:52:54,902 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1252_stage5_step600.svg
[rank2]:2025-12-31 12:52:54,860 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1252_stage2_step600.svg
[rank2]:2025-12-31 12:52:54,903 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1252_stage6_step600.svg
[rank0]:2025-12-31 12:52:54,860 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1252_stage0_step600.svg
[rank0]:2025-12-31 12:52:54,904 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1252_stage4_step600.svg
[rank1]:2025-12-31 12:52:55,024 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank1_stage1.svg
[rank1]:	> Counts Sum: 603, Total Sum: 1485 (40.61%), Ratio(%) per element: [43.63, 43.63, 43.63, 43.63, 43.63, 43.63, 43.63, 43.63, 43.63, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18]
[rank2]:2025-12-31 12:52:54,999 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank2_stage2.svg
[rank2]:	> Counts Sum: 396, Total Sum: 990 (40.00%), Ratio(%) per element: [41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 41.81, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18, 38.18]
[rank0]:2025-12-31 12:52:55,004 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank0_stage0.svg
[rank0]:	> Counts Sum: 324, Total Sum: 1045 (31.00%), Ratio(%) per element: [0.0, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09]
[rank1]:2025-12-31 12:52:55,121 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank1_stage5.svg
[rank1]:	> Counts Sum: 63, Total Sum: 990 (6.36%), Ratio(%) per element: [12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 12:52:55,097 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank2_stage6.svg
[rank2]:	> Counts Sum: 63, Total Sum: 990 (6.36%), Ratio(%) per element: [12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 12.72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 12:52:55,102 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank0_stage4.svg
[rank0]:	> Counts Sum: 36, Total Sum: 990 (3.64%), Ratio(%) per element: [7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 7.27, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 12:52:55,129 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1252_step600_rank3.svg
[rank3]:			> Batch Time: 1118.64 ms, GPU Bubble Ratio: 57.37%, 61.60%, 67.98%, 30.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-97ms      | [S4,MB2,F]  129-8-137ms    | [S4,MB3,F]  169-8-177ms    | [S4,MB0,BI] 282-9-292ms    | [S4,MB0,BW] 292-9-301ms    | [S0,MB4,F]  301-7-308ms    | [S4,MB1,BI] 343-9-353ms    | [S4,MB1,BW] 353-9-363ms    | [S0,MB5,F]  363-7-370ms    | [S4,MB2,BI] 418-10-428ms   | [S4,MB2,BW] 428-9-438ms    | [S0,MB6,F]  438-7-445ms    | [S4,MB3,BI] 487-10-497ms   | [S4,MB3,BW] 497-9-507ms    | [S0,MB7,F]  507-7-514ms    | [S0,MB0,B]  538-24-563ms   | [S4,MB4,F]  562-7-569ms    | [S0,MB1,B]  585-24-609ms   | [S4,MB5,F]  609-7-617ms    | [S0,MB2,B]  635-24-659ms   | [S4,MB6,F]  659-7-667ms    | [S0,MB3,B]  675-24-699ms   | [S4,MB7,F]  699-7-706ms    | [S4,MB4,BI] 738-10-748ms   | [S4,MB4,BW] 748-9-758ms    | [S4,MB5,BI] 820-9-829ms    | [S4,MB5,BW] 829-9-839ms    | [S4,MB6,BI] 870-9-879ms    | [S4,MB6,BW] 879-9-889ms    | [S4,MB7,BI] 936-9-945ms    | [S4,MB7,BW] 945-10-955ms   | [S0,MB4,B]  978-23-1001ms  | [S0,MB5,B]  1017-23-1040ms | [S0,MB6,B]  1056-23-1079ms | [S0,MB7,B]  1095-23-1118ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-190ms    | [S5,MB2,F]  197-7-204ms    | [S5,MB0,BI] 266-9-276ms    | [S5,MB3,F]  276-8-284ms    | [S5,MB1,BI] 327-9-336ms    | [S5,MB0,BW] 336-10-347ms   | [S1,MB4,F]  347-12-359ms   | [S5,MB2,BI] 389-9-399ms    | [S5,MB1,BW] 398-9-408ms    | [S1,MB5,F]  418-12-430ms   | [S5,MB3,BI] 452-9-462ms    | [S5,MB2,BW] 462-9-472ms    | [S1,MB6,F]  488-12-500ms   | [S1,MB0,BI] 503-14-518ms   | [S5,MB3,BW] 518-9-528ms    | [S1,MB7,F]  539-12-551ms   | [S1,MB1,BI] 555-14-569ms   | [S1,MB0,BW] 570-0-570ms    | [S5,MB4,F]  585-7-593ms    | [S1,MB2,BI] 604-15-619ms   | [S1,MB1,BW] 619-0-619ms    | [S5,MB5,F]  635-7-642ms    | [S1,MB3,BI] 654-14-668ms   | [S1,MB2,BW] 668-0-668ms    | [S5,MB6,F]  676-7-683ms    | [S5,MB4,BI] 721-10-731ms   | [S1,MB3,BW] 731-0-731ms    | [S5,MB7,F]  739-7-746ms    | [S5,MB5,BI] 787-10-797ms   | [S5,MB4,BW] 797-9-807ms    | [S5,MB6,BI] 854-9-863ms    | [S5,MB5,BW] 863-10-873ms   | [S5,MB7,BI] 920-9-929ms    | [S5,MB6,BW] 929-10-939ms   | [S1,MB4,BI] 957-13-971ms   | [S5,MB7,BW] 971-10-981ms   | [S1,MB5,BI] 996-14-1010ms  | [S1,MB4,BW] 1010-0-1010ms  | [S1,MB6,BI] 1035-13-1049ms | [S1,MB5,BW] 1049-0-1049ms  | [S1,MB7,BI] 1074-13-1088ms | [S1,MB6,BW] 1088-0-1088ms  | [S1,MB7,BW] 1092-0-1092ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-6-198ms    | [S6,MB0,BI] 251-9-260ms    | [S6,MB2,F]  260-8-268ms    | [S6,MB1,BI] 311-9-320ms    | [S6,MB3,F]  321-8-329ms    | [S6,MB2,BI] 373-8-382ms    | [S6,MB0,BW] 382-10-392ms   | [S2,MB4,F]  392-7-400ms    | [S6,MB3,BI] 436-9-446ms    | [S6,MB1,BW] 446-10-456ms   | [S2,MB5,F]  456-7-464ms    | [S2,MB0,BI] 487-9-497ms    | [S6,MB2,BW] 497-10-507ms   | [S2,MB6,F]  507-8-515ms    | [S2,MB1,BI] 538-10-548ms   | [S6,MB3,BW] 548-10-559ms   | [S2,MB7,F]  559-8-567ms    | [S2,MB2,BI] 587-10-597ms   | [S2,MB0,BW] 597-0-597ms    | [S6,MB4,F]  604-7-611ms    | [S2,MB3,BI] 637-10-647ms   | [S2,MB1,BW] 647-0-647ms    | [S6,MB5,F]  654-7-661ms    | [S6,MB4,BI] 704-9-714ms    | [S2,MB2,BW] 714-0-714ms    | [S6,MB6,F]  722-7-729ms    | [S6,MB5,BI] 771-9-781ms    | [S2,MB3,BW] 781-0-781ms    | [S6,MB7,F]  788-6-795ms    | [S6,MB6,BI] 837-9-847ms    | [S6,MB4,BW] 847-10-857ms   | [S6,MB7,BI] 905-8-914ms    | [S6,MB5,BW] 913-10-923ms   | [S2,MB4,BI] 941-9-950ms    | [S6,MB6,BW] 951-10-961ms   | [S2,MB5,BI] 981-9-990ms    | [S6,MB7,BW] 990-10-1000ms  | [S2,MB6,BI] 1020-9-1029ms  | [S2,MB4,BW] 1029-0-1029ms  | [S2,MB7,BI] 1059-8-1068ms  | [S2,MB5,BW] 1068-0-1068ms  | [S2,MB6,BW] 1070-0-1070ms  | [S2,MB7,BW] 1072-0-1072ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-8-76ms      | [S3,MB2,F]  109-7-117ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-201ms   | [S7,MB0,BI] 212-32-244ms   | [S7,MB1,F]  244-15-259ms   | [S7,MB1,BI] 272-32-304ms   | [S7,MB2,F]  304-17-322ms   | [S7,MB2,BI] 333-33-366ms   | [S7,MB3,F]  366-16-383ms   | [S7,MB3,BI] 396-33-430ms   | [S7,MB0,BW] 429-27-457ms   | [S3,MB4,F]  457-9-467ms    | [S3,MB0,BI] 467-12-479ms   | [S7,MB1,BW] 479-28-508ms   | [S3,MB5,F]  508-9-518ms    | [S3,MB1,BI] 518-12-530ms   | [S7,MB2,BW] 531-28-559ms   | [S3,MB6,F]  559-9-569ms    | [S3,MB2,BI] 568-11-580ms   | [S7,MB3,BW] 580-28-608ms   | [S3,MB7,F]  608-9-618ms    | [S3,MB3,BI] 618-11-630ms   | [S3,MB0,BW] 630-0-630ms    | [S7,MB4,F]  637-15-653ms   | [S7,MB4,BI] 665-32-698ms   | [S3,MB1,BW] 698-0-698ms    | [S7,MB5,F]  705-14-719ms   | [S7,MB5,BI] 731-32-764ms   | [S3,MB2,BW] 764-0-764ms    | [S7,MB6,F]  771-14-786ms   | [S7,MB6,BI] 798-32-831ms   | [S3,MB3,BW] 831-0-831ms    | [S7,MB7,F]  837-14-852ms   | [S7,MB7,BI] 865-32-898ms   | [S7,MB4,BW] 898-27-926ms   | [S3,MB4,BI] 924-10-935ms   | [S7,MB5,BW] 934-28-963ms   | [S3,MB5,BI] 963-10-974ms   | [S7,MB6,BW] 974-28-1002ms  | [S3,MB6,BI] 1002-11-1014ms | [S7,MB7,BW] 1013-28-1042ms | [S3,MB7,BI] 1042-11-1053ms | [S3,MB4,BW] 1053-0-1053ms  | [S3,MB5,BW] 1053-0-1053ms  | [S3,MB6,BW] 1053-0-1053ms  | [S3,MB7,BW] 1053-0-1053ms 
[rank3]:2025-12-31 12:52:55,177 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1252_stage3_step600.svg
[rank3]:2025-12-31 12:52:55,218 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1252_stage7_step600.svg
[rank3]:2025-12-31 12:52:55,315 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank3_stage3.svg
[rank3]:	> Counts Sum: 774, Total Sum: 990 (78.18%), Ratio(%) per element: [78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18]
[rank3]:2025-12-31 12:52:55,395 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1252_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 605 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 12:53:36,340 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 9.0914e-01
[rank3]:2025-12-31 12:53:36,334 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.6268e-01
[rank2]:2025-12-31 12:53:36,329 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 9.1037e-01
[rank0]:2025-12-31 12:53:36,341 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7710e+00
[rank1]:2025-12-31 12:54:22,088 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8315e+00
[rank3]:2025-12-31 12:54:22,099 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3386e+00
[rank2]:2025-12-31 12:54:22,088 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.0010e+00
[rank0]:2025-12-31 12:54:22,111 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 9.0536e+00
[rank3]:2025-12-31 12:55:07,541 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0989e-01
[rank1]:2025-12-31 12:55:07,546 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 3.7742e-01
[rank2]:2025-12-31 12:55:07,537 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.6791e-01
[rank0]:2025-12-31 12:55:07,548 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.5109e+00
[rank2]:2025-12-31 12:55:53,426 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 12:55:53,492 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6022e+00
[rank1]:2025-12-31 12:55:53,480 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8487e+00
[rank0]:2025-12-31 12:55:53,504 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.3206e+01
[rank0]:2025-12-31 12:56:39,008 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 12:56:39,029 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.9154e+00
[rank2]:2025-12-31 12:56:39,017 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 12:56:39,021 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0247e+00
[rank1]:2025-12-31 12:56:39,028 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.8232e+00
[rank3]:2025-12-31 12:56:43,500 - Avg. fwd time: 12.4119 / Avg. bwd-weight time: 15.7747 / Avg. bwd-input time: 22.2865 / Avg. batch time: 1044.2125 (ms) / GPU bubble ratio: 22.66%
[rank2]:2025-12-31 12:56:43,541 - Avg. fwd time: 7.4565 / Avg. bwd-weight time: 7.6793 / Avg. bwd-input time: 9.5338 / Avg. batch time: 1073.0978 (ms) / GPU bubble ratio: 63.22%
[rank3]:2025-12-31 12:56:43,581 -  step: 650  loss:  0.2317  grad_norm:  0.3449  memory: 37.14GiB(78.18%)  tps: 7,162  tflops: 55.99  mfu: 17.94%
[rank1]:2025-12-31 12:56:43,530 - Avg. fwd time: 9.5792 / Avg. bwd-weight time: 9.1218 / Avg. bwd-input time: 12.0538 / Avg. batch time: 1107.0282 (ms) / GPU bubble ratio: 55.55%
[rank1]:2025-12-31 12:56:43,569 -  step: 650  loss: -4.0000  grad_norm:  0.3449  memory: 19.04GiB(40.08%)  tps: 7,162  tflops: 55.99  mfu: 17.94%
[rank0]:2025-12-31 12:56:43,554 - Avg. fwd time: 8.0285 / Avg. full-bwd time: 21.2828 (Avg. bwd-weight time: 9.1634 / Avg. bwd-input time: 9.7543) / Avg. batch time: 1124.6542 (ms) / GPU bubble ratio: 59.98%
[rank0]:2025-12-31 12:56:43,590 -  step: 650  loss: -4.0000  grad_norm:  0.3449  memory: 17.77GiB(37.40%)  tps: 7,161  tflops: 55.98  mfu: 17.94%
[rank2]:2025-12-31 12:56:43,576 -  step: 650  loss: -4.0000  grad_norm:  0.3449  memory: 14.56GiB(30.65%)  tps: 7,162  tflops: 55.99  mfu: 17.94%
[rank1]:2025-12-31 12:57:24,680 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2630e+00
[rank0]:2025-12-31 12:57:24,705 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 8.7299e+00
[rank2]:2025-12-31 12:57:24,687 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3283e+00
[rank3]:2025-12-31 12:57:24,692 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1060e+00
[rank3]:2025-12-31 12:58:10,118 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.7559e-01
[rank1]:2025-12-31 12:58:10,123 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 5.6572e-01
[rank2]:2025-12-31 12:58:10,106 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.7769e-01
[rank0]:2025-12-31 12:58:10,126 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.4210e-01
[rank3]:2025-12-31 12:58:55,839 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1803e+00
[rank2]:2025-12-31 12:58:55,835 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.4681e+00
[rank1]:2025-12-31 12:58:55,828 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.5639e+00
[rank0]:2025-12-31 12:58:55,851 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.4591e+00
[rank3]:2025-12-31 12:59:41,408 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0986e-01
[rank2]:2025-12-31 12:59:41,396 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.3972e-01
[rank1]:2025-12-31 12:59:41,414 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 4.5175e-01
[rank0]:2025-12-31 12:59:41,412 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.8757e-01
[rank0]:2025-12-31 13:00:27,043 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-31 13:00:27,059 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.9931e+00
[rank3]:2025-12-31 13:00:27,063 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.1735e+00
[rank1]:2025-12-31 13:00:27,051 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9997e+00
[rank0]:2025-12-31 13:00:27,076 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.8071e+00
[rank2]:2025-12-31 13:00:31,539 - Avg. fwd time: 7.4558 / Avg. bwd-weight time: 7.7034 / Avg. bwd-input time: 9.5355 / Avg. batch time: 1072.1399 (ms) / GPU bubble ratio: 63.15%
[rank2]:2025-12-31 13:00:31,592 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 14.56GiB(30.65%)  tps: 7,185  tflops: 56.17  mfu: 18.00%
[rank3]:2025-12-31 13:00:31,527 - Avg. fwd time: 12.4021 / Avg. bwd-weight time: 15.6503 / Avg. bwd-input time: 22.2753 / Avg. batch time: 1042.4739 (ms) / GPU bubble ratio: 22.76%
[rank3]:2025-12-31 13:00:31,610 -  step: 700  loss:  0.1921  grad_norm:  0.6081  memory: 37.14GiB(78.18%)  tps: 7,185  tflops: 56.17  mfu: 18.00%
[rank1]:2025-12-31 13:00:31,586 - Avg. fwd time: 9.5847 / Avg. bwd-weight time: 9.0574 / Avg. bwd-input time: 12.0532 / Avg. batch time: 1105.7295 (ms) / GPU bubble ratio: 55.58%
[rank1]:2025-12-31 13:00:31,609 -  step: 700  loss: -4.0000  grad_norm:  0.6081  memory: 19.04GiB(40.08%)  tps: 7,185  tflops: 56.17  mfu: 18.00%
[rank0]:2025-12-31 13:00:31,571 - Avg. fwd time: 8.0279 / Avg. full-bwd time: 21.2677 (Avg. bwd-weight time: 9.1919 / Avg. bwd-input time: 9.7560) / Avg. batch time: 1123.7746 (ms) / GPU bubble ratio: 59.94%
[rank0]:2025-12-31 13:00:31,606 -  step: 700  loss: -4.0000  grad_norm:  0.6081  memory: 17.77GiB(37.40%)  tps: 7,185  tflops: 56.17  mfu: 18.00%
[rank2]:2025-12-31 13:00:31,663 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1300_stage2_step700.svg
[rank2]:2025-12-31 13:00:31,707 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1300_stage6_step700.svg
[rank1]:2025-12-31 13:00:31,663 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1300_stage1_step700.svg
[rank1]:2025-12-31 13:00:31,707 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1300_stage5_step700.svg
[rank0]:2025-12-31 13:00:31,662 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1300_stage0_step700.svg
[rank0]:2025-12-31 13:00:31,705 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1300_stage4_step700.svg
[rank2]:2025-12-31 13:00:31,803 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank2_stage2.svg
[rank2]:	> Counts Sum: 486, Total Sum: 1170 (41.54%), Ratio(%) per element: [43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 43.07, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank1]:2025-12-31 13:00:31,828 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank1_stage1.svg
[rank1]:	> Counts Sum: 738, Total Sum: 1755 (42.05%), Ratio(%) per element: [44.61, 44.61, 44.61, 44.61, 44.61, 44.61, 44.61, 44.61, 44.61, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank0]:2025-12-31 13:00:31,805 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank0_stage0.svg
[rank0]:	> Counts Sum: 387, Total Sum: 1235 (31.34%), Ratio(%) per element: [0.0, 55.38, 55.38, 55.38, 55.38, 55.38, 55.38, 55.38, 55.38, 55.38, 10.76, 10.76, 10.76, 10.76, 10.76, 10.76, 10.76, 10.76, 10.76]
[rank2]:2025-12-31 13:00:31,900 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank2_stage6.svg
[rank2]:	> Counts Sum: 81, Total Sum: 1170 (6.92%), Ratio(%) per element: [13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 13.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 13:00:31,927 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank1_stage5.svg
[rank1]:	> Counts Sum: 63, Total Sum: 1170 (5.38%), Ratio(%) per element: [10.76, 10.76, 10.76, 10.76, 10.76, 10.76, 10.76, 10.76, 10.76, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 13:00:31,902 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank0_stage4.svg
[rank0]:	> Counts Sum: 45, Total Sum: 1170 (3.85%), Ratio(%) per element: [7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 7.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 13:00:31,932 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1300_step700_rank3.svg
[rank3]:			> Batch Time: 1112.64 ms, GPU Bubble Ratio: 57.18%, 61.53%, 61.00%, 30.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  88-8-96ms      | [S4,MB2,F]  127-8-136ms    | [S4,MB3,F]  167-8-175ms    | [S4,MB0,BI] 280-9-290ms    | [S4,MB0,BW] 290-9-299ms    | [S0,MB4,F]  299-7-306ms    | [S4,MB1,BI] 340-10-350ms   | [S4,MB1,BW] 350-9-360ms    | [S0,MB5,F]  360-7-367ms    | [S4,MB2,BI] 416-10-426ms   | [S4,MB2,BW] 426-9-436ms    | [S0,MB6,F]  434-7-442ms    | [S4,MB3,BI] 484-10-494ms   | [S4,MB3,BW] 494-9-504ms    | [S0,MB7,F]  503-7-511ms    | [S0,MB0,B]  535-24-560ms   | [S4,MB4,F]  557-7-565ms    | [S0,MB1,B]  582-24-607ms   | [S4,MB5,F]  604-7-611ms    | [S0,MB2,B]  632-24-656ms   | [S4,MB6,F]  653-7-660ms    | [S0,MB3,B]  672-24-697ms   | [S4,MB7,F]  694-7-701ms    | [S4,MB4,BI] 734-10-744ms   | [S4,MB4,BW] 744-9-753ms    | [S4,MB5,BI] 814-9-823ms    | [S4,MB5,BW] 823-9-833ms    | [S4,MB6,BI] 863-9-872ms    | [S4,MB6,BW] 872-9-882ms    | [S4,MB7,BI] 930-9-939ms    | [S4,MB7,BW] 939-10-949ms   | [S0,MB4,B]  971-23-994ms   | [S0,MB5,B]  1010-23-1034ms | [S0,MB6,B]  1050-23-1073ms | [S0,MB7,B]  1089-23-1112ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  48-11-60ms     | [S1,MB2,F]  88-11-100ms    | [S1,MB3,F]  127-11-139ms   | [S5,MB0,F]  166-7-174ms    | [S5,MB1,F]  180-7-187ms    | [S5,MB2,F]  194-7-202ms    | [S5,MB0,BI] 263-9-273ms    | [S5,MB3,F]  273-8-281ms    | [S5,MB1,BI] 324-9-333ms    | [S5,MB0,BW] 333-10-344ms   | [S1,MB4,F]  344-12-356ms   | [S5,MB2,BI] 385-10-395ms   | [S5,MB1,BW] 395-9-405ms    | [S1,MB5,F]  414-12-426ms   | [S5,MB3,BI] 449-9-459ms    | [S5,MB2,BW] 459-9-468ms    | [S1,MB6,F]  483-12-496ms   | [S1,MB0,BI] 499-14-514ms   | [S5,MB3,BW] 514-9-524ms    | [S1,MB7,F]  534-12-547ms   | [S1,MB1,BI] 550-14-565ms   | [S1,MB0,BW] 565-0-565ms    | [S5,MB4,F]  581-7-588ms    | [S1,MB2,BI] 599-14-614ms   | [S1,MB1,BW] 614-0-614ms    | [S5,MB5,F]  630-7-637ms    | [S1,MB3,BI] 649-14-663ms   | [S1,MB2,BW] 663-0-663ms    | [S5,MB6,F]  673-7-680ms    | [S5,MB4,BI] 715-9-725ms    | [S1,MB3,BW] 725-0-725ms    | [S5,MB7,F]  735-7-742ms    | [S5,MB5,BI] 782-9-791ms    | [S5,MB4,BW] 792-9-801ms    | [S5,MB6,BI] 848-9-857ms    | [S5,MB5,BW] 857-10-867ms   | [S5,MB7,BI] 914-9-923ms    | [S5,MB6,BW] 923-10-933ms   | [S1,MB4,BI] 950-13-964ms   | [S5,MB7,BW] 964-10-974ms   | [S1,MB5,BI] 989-13-1003ms  | [S1,MB4,BW] 1004-0-1004ms  | [S1,MB6,BI] 1029-13-1042ms | [S1,MB5,BW] 1043-0-1043ms  | [S1,MB7,BI] 1068-13-1082ms | [S1,MB6,BW] 1082-0-1082ms  | [S1,MB7,BW] 1085-0-1085ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-6-67ms      | [S2,MB2,F]  99-6-106ms     | [S2,MB3,F]  139-6-146ms    | [S6,MB0,F]  174-7-182ms    | [S6,MB1,F]  188-6-195ms    | [S6,MB0,BI] 248-9-257ms    | [S6,MB2,F]  257-8-265ms    | [S6,MB1,BI] 308-9-317ms    | [S6,MB3,F]  317-8-325ms    | [S6,MB2,BI] 370-8-379ms    | [S6,MB0,BW] 379-10-389ms   | [S2,MB4,F]  389-7-396ms    | [S6,MB3,BI] 433-9-442ms    | [S6,MB1,BW] 442-10-453ms   | [S2,MB5,F]  453-7-460ms    | [S2,MB0,BI] 483-9-492ms    | [S6,MB2,BW] 493-10-503ms   | [S2,MB6,F]  503-7-510ms    | [S2,MB1,BI] 534-9-543ms    | [S6,MB3,BW] 544-10-554ms   | [S2,MB7,F]  554-7-561ms    | [S2,MB2,BI] 583-10-593ms   | [S2,MB0,BW] 593-10-603ms   | [S6,MB4,F]  603-7-610ms    | [S2,MB3,BI] 632-10-642ms   | [S2,MB1,BW] 642-10-653ms   | [S6,MB5,F]  653-7-660ms    | [S6,MB4,BI] 699-10-709ms   | [S2,MB2,BW] 709-10-719ms   | [S6,MB6,F]  719-7-726ms    | [S6,MB5,BI] 765-9-775ms    | [S2,MB3,BW] 775-10-786ms   | [S6,MB7,F]  785-7-792ms    | [S6,MB6,BI] 831-9-840ms    | [S6,MB4,BW] 841-10-851ms   | [S6,MB7,BI] 898-8-907ms    | [S6,MB5,BW] 907-10-917ms   | [S2,MB4,BI] 935-9-944ms    | [S6,MB6,BW] 944-10-954ms   | [S2,MB5,BI] 974-9-983ms    | [S6,MB7,BW] 983-10-993ms   | [S2,MB6,BI] 1013-9-1022ms  | [S2,MB4,BW] 1022-10-1032ms | [S2,MB7,BI] 1052-9-1061ms  | [S2,MB5,BW] 1061-10-1071ms | [S2,MB6,BW] 1071-9-1080ms  | [S2,MB7,BW] 1080-9-1089ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-75ms      | [S3,MB2,F]  106-7-114ms    | [S3,MB3,F]  146-7-154ms    | [S7,MB0,F]  182-15-198ms   | [S7,MB0,BI] 209-31-241ms   | [S7,MB1,F]  241-14-256ms   | [S7,MB1,BI] 269-32-301ms   | [S7,MB2,F]  301-16-317ms   | [S7,MB2,BI] 330-33-363ms   | [S7,MB3,F]  363-16-380ms   | [S7,MB3,BI] 392-33-425ms   | [S7,MB0,BW] 426-27-453ms   | [S3,MB4,F]  452-9-462ms    | [S3,MB0,BI] 463-12-475ms   | [S7,MB1,BW] 475-28-504ms   | [S3,MB5,F]  504-9-514ms    | [S3,MB1,BI] 514-12-526ms   | [S7,MB2,BW] 526-28-555ms   | [S3,MB6,F]  554-9-564ms    | [S3,MB2,BI] 564-11-575ms   | [S7,MB3,BW] 575-28-603ms   | [S3,MB7,F]  603-9-613ms    | [S3,MB3,BI] 613-11-625ms   | [S3,MB0,BW] 625-0-625ms    | [S7,MB4,F]  632-15-648ms   | [S7,MB4,BI] 660-32-692ms   | [S3,MB1,BW] 692-0-692ms    | [S7,MB5,F]  699-14-713ms   | [S7,MB5,BI] 726-32-759ms   | [S3,MB2,BW] 759-0-759ms    | [S7,MB6,F]  766-14-780ms   | [S7,MB6,BI] 792-32-825ms   | [S3,MB3,BW] 825-0-825ms    | [S7,MB7,F]  831-14-846ms   | [S7,MB7,BI] 859-32-891ms   | [S7,MB4,BW] 891-26-918ms   | [S3,MB4,BI] 918-10-928ms   | [S7,MB5,BW] 928-28-956ms   | [S3,MB5,BI] 956-10-967ms   | [S7,MB6,BW] 967-28-995ms   | [S3,MB6,BI] 995-10-1006ms  | [S7,MB7,BW] 1006-28-1035ms | [S3,MB7,BI] 1035-11-1046ms | [S3,MB4,BW] 1046-0-1046ms  | [S3,MB5,BW] 1046-0-1046ms  | [S3,MB6,BW] 1046-0-1046ms  | [S3,MB7,BW] 1046-0-1046ms 
[rank3]:2025-12-31 13:00:31,980 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1300_stage3_step700.svg
[rank3]:2025-12-31 13:00:32,022 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1300_stage7_step700.svg
[rank3]:2025-12-31 13:00:32,119 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank3_stage3.svg
[rank3]:	> Counts Sum: 954, Total Sum: 1170 (81.54%), Ratio(%) per element: [81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53]
[rank3]:2025-12-31 13:00:32,204 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1300_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 715 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 13:01:12,809 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 13:01:12,879 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.5212e+00
[rank1]:2025-12-31 13:01:12,886 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 6.8748e+00
[rank0]:2025-12-31 13:01:12,875 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-31 13:01:58,601 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 13:01:58,605 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6148e+00
[rank1]:2025-12-31 13:01:58,593 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.7841e-01
[rank0]:2025-12-31 13:01:58,617 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 13:02:44,250 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0205e+00
[rank3]:2025-12-31 13:02:44,254 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.3645e-01
[rank1]:2025-12-31 13:02:44,260 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.6824e-01
[rank0]:2025-12-31 13:02:44,266 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.0311e+00
[rank1]:2025-12-31 13:03:29,924 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-31 13:03:29,962 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.1187e+00
[rank3]:2025-12-31 13:03:29,974 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.3015e-01
[rank0]:2025-12-31 13:03:29,985 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 8.7467e-01
[rank3]:2025-12-31 13:04:15,506 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.3704e-01
[rank2]:2025-12-31 13:04:15,502 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 7.6866e-01
[rank1]:2025-12-31 13:04:15,512 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-31 13:04:15,498 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 13:04:15,517 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.0783e+01
[rank3]:2025-12-31 13:04:20,021 - Avg. fwd time: 12.3918 / Avg. bwd-weight time: 15.5425 / Avg. bwd-input time: 22.2654 / Avg. batch time: 1040.8843 (ms) / GPU bubble ratio: 22.84%
[rank3]:2025-12-31 13:04:20,103 -  step: 750  loss:  0.2372  grad_norm:  0.2167  memory: 37.14GiB(78.18%)  tps: 7,170  tflops: 56.06  mfu: 17.97%
[rank2]:2025-12-31 13:04:20,032 - Avg. fwd time: 7.4562 / Avg. bwd-weight time: 7.6759 / Avg. bwd-input time: 9.5358 / Avg. batch time: 1071.3491 (ms) / GPU bubble ratio: 63.16%
[rank2]:2025-12-31 13:04:20,091 -  step: 750  loss: -4.0000  grad_norm:  0.2167  memory: 14.56GiB(30.65%)  tps: 7,170  tflops: 56.05  mfu: 17.97%
[rank1]:2025-12-31 13:04:20,079 - Avg. fwd time: 9.5849 / Avg. bwd-weight time: 9.0258 / Avg. bwd-input time: 12.0533 / Avg. batch time: 1104.9717 (ms) / GPU bubble ratio: 55.60%
[rank1]:2025-12-31 13:04:20,102 -  step: 750  loss: -4.0000  grad_norm:  0.2167  memory: 19.04GiB(40.08%)  tps: 7,170  tflops: 56.06  mfu: 17.97%
[rank0]:2025-12-31 13:04:20,070 - Avg. fwd time: 8.0266 / Avg. full-bwd time: 21.3322 (Avg. bwd-weight time: 9.1123 / Avg. bwd-input time: 9.7567) / Avg. batch time: 1123.1008 (ms) / GPU bubble ratio: 59.93%
[rank0]:2025-12-31 13:04:20,109 -  step: 750  loss: -4.0000  grad_norm:  0.2167  memory: 17.77GiB(37.40%)  tps: 7,170  tflops: 56.05  mfu: 17.97%
[rank3]:2025-12-31 13:05:01,012 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3873e+00
[rank2]:2025-12-31 13:05:01,000 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.3856e+00
[rank1]:2025-12-31 13:05:01,018 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.0586e+00
[rank0]:2025-12-31 13:05:01,020 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.3363e+00
[rank1]:2025-12-31 13:05:46,842 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.3926e+00
[rank2]:2025-12-31 13:05:46,849 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.4314e+00
[rank3]:2025-12-31 13:05:46,853 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0308e+00
[rank0]:2025-12-31 13:05:46,865 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.1477e+00
[rank2]:2025-12-31 13:06:32,330 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-31 13:06:32,399 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.5360e+00
[rank1]:2025-12-31 13:06:32,405 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.4669e+00
[rank0]:2025-12-31 13:06:32,406 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.3293e+00
[rank1]:2025-12-31 13:07:18,276 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3485e-01
[rank2]:2025-12-31 13:07:18,283 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 13:07:18,287 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.4290e-01
[rank0]:2025-12-31 13:07:18,299 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.6546e+00
[rank1]:2025-12-31 13:08:04,003 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.0926e-01
[rank2]:2025-12-31 13:08:03,993 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.9538e-01
[rank3]:2025-12-31 13:08:03,997 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.2611e-01
[rank0]:2025-12-31 13:08:03,970 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 13:08:04,004 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 9.3383e-01
[rank1]:2025-12-31 13:08:08,625 - Avg. fwd time: 9.5853 / Avg. bwd-weight time: 9.0515 / Avg. bwd-input time: 12.0545 / Avg. batch time: 1104.4369 (ms) / GPU bubble ratio: 55.54%
[rank2]:2025-12-31 13:08:08,608 - Avg. fwd time: 7.4574 / Avg. bwd-weight time: 7.6454 / Avg. bwd-input time: 9.5363 / Avg. batch time: 1070.8226 (ms) / GPU bubble ratio: 63.18%
[rank3]:2025-12-31 13:08:08,596 - Avg. fwd time: 12.3883 / Avg. bwd-weight time: 15.4527 / Avg. bwd-input time: 22.2613 / Avg. batch time: 1039.7375 (ms) / GPU bubble ratio: 22.90%
[rank0]:2025-12-31 13:08:08,649 - Avg. fwd time: 8.0258 / Avg. full-bwd time: 21.3317 (Avg. bwd-weight time: 9.1531 / Avg. bwd-input time: 9.7580) / Avg. batch time: 1122.5801 (ms) / GPU bubble ratio: 59.88%
[rank1]:2025-12-31 13:08:08,664 -  step: 800  loss: -4.0000  grad_norm:  1.5104  memory: 19.04GiB(40.08%)  tps: 7,168  tflops: 56.04  mfu: 17.96%
[rank1]:2025-12-31 13:08:08,664 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.5104  tps: 7,545  tflops: 58.98  mfu: 17.15%
[rank1]:2025-12-31 13:08:08,664 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 13:08:08,665 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-31 13:08:08,664 -  step: 800  loss: -4.0000  grad_norm:  1.5104  memory: 14.56GiB(30.65%)  tps: 7,168  tflops: 56.04  mfu: 17.96%
[rank2]:2025-12-31 13:08:08,664 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.5104  tps: 7,545  tflops: 58.98  mfu: 17.15%
[rank2]:2025-12-31 13:08:08,664 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 13:08:08,665 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-31 13:08:08,676 -  step: 800  loss:  0.2388  grad_norm:  1.5104  memory: 37.14GiB(78.18%)  tps: 7,168  tflops: 56.04  mfu: 17.96%
[rank3]:2025-12-31 13:08:08,677 - â„¹ï¸ final step: 800  loss:  0.2388  grad_norm:  1.5104  tps: 7,555  tflops: 59.06  mfu: 17.37%
[rank3]:2025-12-31 13:08:08,677 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 13:08:08,678 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 13:08:08,686 -  step: 800  loss: -4.0000  grad_norm:  1.5104  memory: 17.77GiB(37.40%)  tps: 7,168  tflops: 56.03  mfu: 17.96%
[rank0]:2025-12-31 13:08:08,686 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.5104  tps: 7,545  tflops: 58.98  mfu: 17.16%
[rank0]:2025-12-31 13:08:08,686 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 13:08:08,686 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 13:08:10,579 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-31 13:08:10,652 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1308_stage0_final800.svg
[rank1]:2025-12-31 13:08:10,653 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1308_stage1_final800.svg
[rank1]:2025-12-31 13:08:10,699 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank1/251231_1308_stage5_final800.svg
[rank2]:2025-12-31 13:08:10,653 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1308_stage2_final800.svg
[rank2]:2025-12-31 13:08:10,698 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank2/251231_1308_stage6_final800.svg
[rank0]:2025-12-31 13:08:10,697 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank0/251231_1308_stage4_final800.svg
[rank1]:2025-12-31 13:08:10,823 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank1_stage1.svg
[rank1]:	> Counts Sum: 873, Total Sum: 2025 (43.11%), Ratio(%) per element: [45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33, 41.33]
[rank2]:2025-12-31 13:08:10,796 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank2_stage2.svg
[rank2]:	> Counts Sum: 558, Total Sum: 1350 (41.33%), Ratio(%) per element: [42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank0]:2025-12-31 13:08:10,798 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank0_stage0.svg
[rank0]:	> Counts Sum: 414, Total Sum: 1425 (29.05%), Ratio(%) per element: [0.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33, 9.33]
[rank1]:2025-12-31 13:08:10,920 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank1_stage5.svg
[rank1]:	> Counts Sum: 72, Total Sum: 1350 (5.33%), Ratio(%) per element: [10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 10.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 13:08:10,920 - Destroying the purge thread.
[rank2]:2025-12-31 13:08:10,893 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank2_stage6.svg
[rank2]:	> Counts Sum: 90, Total Sum: 1350 (6.67%), Ratio(%) per element: [13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 13:08:10,893 - Destroying the purge thread.
[rank2]:2025-12-31 13:08:10,924 - Process group destroyed
[rank3]:2025-12-31 13:08:10,925 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1308_final800_rank3.svg
[rank3]:			> Batch Time: 1120.47 ms, GPU Bubble Ratio: 57.98%, 51.52%, 61.35%, 30.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  88-8-96ms      | [S4,MB2,F]  127-8-135ms    | [S4,MB3,F]  165-8-174ms    | [S4,MB0,BI] 279-9-288ms    | [S4,MB0,BW] 288-9-298ms    | [S0,MB4,F]  298-7-305ms    | [S4,MB1,BI] 339-9-349ms    | [S4,MB1,BW] 349-9-359ms    | [S0,MB5,F]  359-7-366ms    | [S4,MB2,BI] 413-10-424ms   | [S4,MB2,BW] 424-9-434ms    | [S0,MB6,F]  433-7-440ms    | [S4,MB3,BI] 481-10-492ms   | [S4,MB3,BW] 492-9-502ms    | [S0,MB7,F]  501-7-509ms    | [S0,MB0,B]  533-20-553ms   | [S4,MB4,F]  554-7-561ms    | [S0,MB1,B]  580-24-604ms   | [S4,MB5,F]  602-7-609ms    | [S0,MB2,B]  630-24-654ms   | [S4,MB6,F]  651-7-658ms    | [S0,MB3,B]  670-24-694ms   | [S4,MB7,F]  691-7-698ms    | [S4,MB4,BI] 734-10-744ms   | [S4,MB4,BW] 744-9-753ms    | [S4,MB5,BI] 819-9-828ms    | [S4,MB5,BW] 828-9-838ms    | [S4,MB6,BI] 869-9-878ms    | [S4,MB6,BW] 878-9-887ms    | [S4,MB7,BI] 935-9-944ms    | [S4,MB7,BW] 944-9-954ms    | [S0,MB4,B]  978-23-1001ms  | [S0,MB5,B]  1018-23-1041ms | [S0,MB6,B]  1058-23-1081ms | [S0,MB7,B]  1097-23-1120ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  88-10-99ms     | [S1,MB3,F]  126-10-137ms   | [S5,MB0,F]  165-7-173ms    | [S5,MB1,F]  179-7-186ms    | [S5,MB2,F]  194-7-201ms    | [S5,MB0,BI] 263-9-272ms    | [S5,MB3,F]  272-8-281ms    | [S5,MB1,BI] 323-9-332ms    | [S5,MB0,BW] 332-10-343ms   | [S1,MB4,F]  343-11-354ms   | [S5,MB2,BI] 385-10-395ms   | [S5,MB1,BW] 395-9-404ms    | [S1,MB5,F]  413-11-424ms   | [S5,MB3,BI] 448-9-458ms    | [S5,MB2,BW] 458-9-468ms    | [S1,MB6,F]  482-11-493ms   | [S1,MB0,BI] 498-14-512ms   | [S5,MB3,BW] 513-9-522ms    | [S1,MB7,F]  534-11-545ms   | [S1,MB1,BI] 549-14-564ms   | [S1,MB0,BW] 564-12-577ms   | [S5,MB4,F]  580-7-588ms    | [S1,MB2,BI] 599-15-614ms   | [S1,MB1,BW] 614-15-629ms   | [S5,MB5,F]  630-7-638ms    | [S1,MB3,BI] 648-15-663ms   | [S1,MB2,BW] 663-15-679ms   | [S5,MB6,F]  675-7-683ms    | [S5,MB4,BI] 717-10-727ms   | [S1,MB3,BW] 727-15-742ms   | [S5,MB7,F]  738-7-745ms    | [S5,MB5,BI] 785-10-795ms   | [S5,MB4,BW] 795-9-804ms    | [S5,MB6,BI] 853-9-862ms    | [S5,MB5,BW] 862-10-872ms   | [S5,MB7,BI] 919-9-928ms    | [S5,MB6,BW] 928-10-938ms   | [S1,MB4,BI] 958-13-971ms   | [S5,MB7,BW] 971-10-981ms   | [S1,MB5,BI] 997-14-1011ms  | [S1,MB4,BW] 1011-15-1026ms | [S1,MB6,BI] 1037-14-1051ms | [S1,MB5,BW] 1051-15-1066ms | [S1,MB7,BI] 1076-14-1090ms | [S1,MB6,BW] 1090-15-1105ms | [S1,MB7,BW] 1099-14-1114ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  99-7-106ms     | [S2,MB3,F]  137-7-144ms    | [S6,MB0,F]  173-7-181ms    | [S6,MB1,F]  187-6-194ms    | [S6,MB0,BI] 247-9-256ms    | [S6,MB2,F]  256-8-265ms    | [S6,MB1,BI] 307-9-317ms    | [S6,MB3,F]  316-8-325ms    | [S6,MB2,BI] 369-8-378ms    | [S6,MB0,BW] 378-10-388ms   | [S2,MB4,F]  388-7-395ms    | [S6,MB3,BI] 432-9-442ms    | [S6,MB1,BW] 441-10-452ms   | [S2,MB5,F]  452-7-459ms    | [S2,MB0,BI] 481-9-491ms    | [S6,MB2,BW] 491-10-502ms   | [S2,MB6,F]  501-7-509ms    | [S2,MB1,BI] 533-9-543ms    | [S6,MB3,BW] 542-10-553ms   | [S2,MB7,F]  553-7-560ms    | [S2,MB2,BI] 582-10-592ms   | [S2,MB0,BW] 592-9-601ms    | [S6,MB4,F]  601-7-608ms    | [S2,MB3,BI] 631-10-641ms   | [S2,MB1,BW] 642-10-652ms   | [S6,MB5,F]  651-7-658ms    | [S6,MB4,BI] 700-9-710ms    | [S2,MB2,BW] 710-10-721ms   | [S6,MB6,F]  719-7-726ms    | [S6,MB5,BI] 768-9-778ms    | [S2,MB3,BW] 778-10-789ms   | [S6,MB7,F]  787-7-794ms    | [S6,MB6,BI] 836-9-846ms    | [S6,MB4,BW] 846-10-856ms   | [S6,MB7,BI] 903-8-912ms    | [S6,MB5,BW] 912-10-922ms   | [S2,MB4,BI] 942-9-951ms    | [S6,MB6,BW] 951-10-961ms   | [S2,MB5,BI] 981-9-990ms    | [S6,MB7,BW] 990-10-1000ms  | [S2,MB6,BI] 1021-9-1030ms  | [S2,MB4,BW] 1030-10-1040ms | [S2,MB7,BI] 1060-8-1069ms  | [S2,MB5,BW] 1069-10-1079ms | [S2,MB6,BW] 1075-9-1084ms  | [S2,MB7,BW] 1082-9-1092ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-75ms      | [S3,MB2,F]  106-7-114ms    | [S3,MB3,F]  145-7-153ms    | [S7,MB0,F]  181-15-197ms   | [S7,MB0,BI] 209-32-241ms   | [S7,MB1,F]  241-14-255ms   | [S7,MB1,BI] 268-32-300ms   | [S7,MB2,F]  300-16-317ms   | [S7,MB2,BI] 329-33-362ms   | [S7,MB3,F]  363-16-379ms   | [S7,MB3,BI] 391-33-425ms   | [S7,MB0,BW] 425-27-452ms   | [S3,MB4,F]  452-9-461ms    | [S3,MB0,BI] 461-12-474ms   | [S7,MB1,BW] 474-28-503ms   | [S3,MB5,F]  503-9-513ms    | [S3,MB1,BI] 513-12-525ms   | [S7,MB2,BW] 525-28-554ms   | [S3,MB6,F]  554-9-563ms    | [S3,MB2,BI] 563-11-575ms   | [S7,MB3,BW] 575-28-603ms   | [S3,MB7,F]  604-9-613ms    | [S3,MB3,BI] 613-11-625ms   | [S3,MB0,BW] 625-0-625ms    | [S7,MB4,F]  633-15-649ms   | [S7,MB4,BI] 661-32-693ms   | [S3,MB1,BW] 694-0-694ms    | [S7,MB5,F]  702-15-717ms   | [S7,MB5,BI] 729-32-762ms   | [S3,MB2,BW] 762-0-762ms    | [S7,MB6,F]  769-16-785ms   | [S7,MB6,BI] 797-32-829ms   | [S3,MB3,BW] 830-0-830ms    | [S7,MB7,F]  837-15-852ms   | [S7,MB7,BI] 864-32-896ms   | [S7,MB4,BW] 897-27-924ms   | [S3,MB4,BI] 924-10-935ms   | [S7,MB5,BW] 935-28-963ms   | [S3,MB5,BI] 964-10-975ms   | [S7,MB6,BW] 975-28-1003ms  | [S3,MB6,BI] 1003-11-1014ms | [S7,MB7,BW] 1014-28-1043ms | [S3,MB7,BI] 1043-11-1054ms | [S3,MB4,BW] 1054-0-1054ms  | [S3,MB5,BW] 1054-0-1054ms  | [S3,MB6,BW] 1054-0-1054ms  | [S3,MB7,BW] 1054-0-1054ms 
[rank0]:2025-12-31 13:08:10,896 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank0_stage4.svg
[rank0]:	> Counts Sum: 45, Total Sum: 1350 (3.33%), Ratio(%) per element: [6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 13:08:10,896 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-31 13:08:11,239 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/pipeline_schedule/251231_1308_thry_final800_rank3.svg
[rank3]:			> Batch Time: 473.52 ms, GPU Bubble Ratio: 5.88%, 5.88%, 5.88%, 5.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-9-37ms      | [S4,MB0,F]  37-9-46ms      | [S4,MB1,F]  46-9-55ms      | [S4,MB2,F]  55-9-64ms      | [S4,MB3,F]  64-9-74ms      | [S4,MB0,BI] 102-9-111ms    | [S4,MB0,BW] 111-9-120ms    | [S0,MB4,F]  120-9-129ms    | [S4,MB1,BI] 129-9-139ms    | [S4,MB1,BW] 139-9-148ms    | [S0,MB5,F]  148-9-157ms    | [S4,MB2,BI] 157-9-167ms    | [S4,MB2,BW] 167-9-176ms    | [S0,MB6,F]  176-9-185ms    | [S4,MB3,BI] 185-9-194ms    | [S4,MB3,BW] 194-9-204ms    | [S0,MB7,F]  204-9-213ms    | [S0,MB0,B]  213-18-232ms   | [S4,MB4,F]  232-9-241ms    | [S0,MB1,B]  241-18-259ms   | [S4,MB5,F]  259-9-269ms    | [S0,MB2,B]  269-18-287ms   | [S4,MB6,F]  287-9-297ms    | [S0,MB3,B]  297-18-315ms   | [S4,MB7,F]  315-9-324ms    | [S4,MB4,BI] 324-9-334ms    | [S4,MB4,BW] 334-9-343ms    | [S4,MB5,BI] 343-9-352ms    | [S4,MB5,BW] 352-9-362ms    | [S4,MB6,BI] 362-9-371ms    | [S4,MB6,BW] 371-9-380ms    | [S4,MB7,BI] 380-9-389ms    | [S4,MB7,BW] 389-9-399ms    | [S0,MB4,B]  399-18-417ms   | [S0,MB5,B]  417-18-436ms   | [S0,MB6,B]  436-18-454ms   | [S0,MB7,B]  454-18-473ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-18ms       | [S1,MB1,F]  18-9-27ms      | [S1,MB2,F]  27-9-37ms      | [S1,MB3,F]  37-9-46ms      | [S5,MB0,F]  46-9-55ms      | [S5,MB1,F]  55-9-64ms      | [S5,MB2,F]  64-9-74ms      | [S5,MB0,BI] 92-9-102ms     | [S5,MB3,F]  102-9-111ms    | [S5,MB1,BI] 111-9-120ms    | [S5,MB0,BW] 120-9-129ms    | [S1,MB4,F]  129-9-139ms    | [S5,MB2,BI] 139-9-148ms    | [S5,MB1,BW] 148-9-157ms    | [S1,MB5,F]  157-9-167ms    | [S5,MB3,BI] 167-9-176ms    | [S5,MB2,BW] 176-9-185ms    | [S1,MB6,F]  185-9-194ms    | [S1,MB0,BI] 194-9-204ms    | [S5,MB3,BW] 204-9-213ms    | [S1,MB7,F]  213-9-222ms    | [S1,MB1,BI] 222-9-232ms    | [S1,MB0,BW] 232-9-241ms    | [S5,MB4,F]  241-9-250ms    | [S1,MB2,BI] 250-9-259ms    | [S1,MB1,BW] 259-9-269ms    | [S5,MB5,F]  269-9-278ms    | [S1,MB3,BI] 278-9-287ms    | [S1,MB2,BW] 287-9-297ms    | [S5,MB6,F]  297-9-306ms    | [S5,MB4,BI] 306-9-315ms    | [S1,MB3,BW] 315-9-324ms    | [S5,MB7,F]  324-9-334ms    | [S5,MB5,BI] 334-9-343ms    | [S5,MB4,BW] 343-9-352ms    | [S5,MB6,BI] 352-9-362ms    | [S5,MB5,BW] 362-9-371ms    | [S5,MB7,BI] 371-9-380ms    | [S5,MB6,BW] 380-9-389ms    | [S1,MB4,BI] 389-9-399ms    | [S5,MB7,BW] 399-9-408ms    | [S1,MB5,BI] 408-9-417ms    | [S1,MB4,BW] 417-9-427ms    | [S1,MB6,BI] 427-9-436ms    | [S1,MB5,BW] 436-9-445ms    | [S1,MB7,BI] 445-9-454ms    | [S1,MB6,BW] 454-9-464ms    | [S1,MB7,BW] 464-9-473ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  18-9-27ms      | [S2,MB1,F]  27-9-37ms      | [S2,MB2,F]  37-9-46ms      | [S2,MB3,F]  46-9-55ms      | [S6,MB0,F]  55-9-64ms      | [S6,MB1,F]  64-9-74ms      | [S6,MB0,BI] 83-9-92ms      | [S6,MB2,F]  92-9-102ms     | [S6,MB1,BI] 102-9-111ms    | [S6,MB3,F]  111-9-120ms    | [S6,MB2,BI] 120-9-129ms    | [S6,MB0,BW] 129-9-139ms    | [S2,MB4,F]  139-9-148ms    | [S6,MB3,BI] 148-9-157ms    | [S6,MB1,BW] 157-9-167ms    | [S2,MB5,F]  167-9-176ms    | [S2,MB0,BI] 176-9-185ms    | [S6,MB2,BW] 185-9-194ms    | [S2,MB6,F]  194-9-204ms    | [S2,MB1,BI] 204-9-213ms    | [S6,MB3,BW] 213-9-222ms    | [S2,MB7,F]  222-9-232ms    | [S2,MB2,BI] 232-9-241ms    | [S2,MB0,BW] 241-9-250ms    | [S6,MB4,F]  250-9-259ms    | [S2,MB3,BI] 259-9-269ms    | [S2,MB1,BW] 269-9-278ms    | [S6,MB5,F]  278-9-287ms    | [S6,MB4,BI] 287-9-297ms    | [S2,MB2,BW] 297-9-306ms    | [S6,MB6,F]  306-9-315ms    | [S6,MB5,BI] 315-9-324ms    | [S2,MB3,BW] 324-9-334ms    | [S6,MB7,F]  334-9-343ms    | [S6,MB6,BI] 343-9-352ms    | [S6,MB4,BW] 352-9-362ms    | [S6,MB7,BI] 362-9-371ms    | [S6,MB5,BW] 371-9-380ms    | [S2,MB4,BI] 380-9-389ms    | [S6,MB6,BW] 389-9-399ms    | [S2,MB5,BI] 399-9-408ms    | [S6,MB7,BW] 408-9-417ms    | [S2,MB6,BI] 417-9-427ms    | [S2,MB4,BW] 427-9-436ms    | [S2,MB7,BI] 436-9-445ms    | [S2,MB5,BW] 445-9-454ms    | [S2,MB6,BW] 454-9-464ms    | [S2,MB7,BW] 464-9-473ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  27-9-37ms      | [S3,MB1,F]  37-9-46ms      | [S3,MB2,F]  46-9-55ms      | [S3,MB3,F]  55-9-64ms      | [S7,MB0,F]  64-9-74ms      | [S7,MB0,BI] 74-9-83ms      | [S7,MB1,F]  83-9-92ms      | [S7,MB1,BI] 92-9-102ms     | [S7,MB2,F]  102-9-111ms    | [S7,MB2,BI] 111-9-120ms    | [S7,MB3,F]  120-9-129ms    | [S7,MB3,BI] 129-9-139ms    | [S7,MB0,BW] 139-9-148ms    | [S3,MB4,F]  148-9-157ms    | [S3,MB0,BI] 157-9-167ms    | [S7,MB1,BW] 167-9-176ms    | [S3,MB5,F]  176-9-185ms    | [S3,MB1,BI] 185-9-194ms    | [S7,MB2,BW] 194-9-204ms    | [S3,MB6,F]  204-9-213ms    | [S3,MB2,BI] 213-9-222ms    | [S7,MB3,BW] 222-9-232ms    | [S3,MB7,F]  232-9-241ms    | [S3,MB3,BI] 241-9-250ms    | [S3,MB0,BW] 250-9-259ms    | [S7,MB4,F]  259-9-269ms    | [S7,MB4,BI] 269-9-278ms    | [S3,MB1,BW] 278-9-287ms    | [S7,MB5,F]  287-9-297ms    | [S7,MB5,BI] 297-9-306ms    | [S3,MB2,BW] 306-9-315ms    | [S7,MB6,F]  315-9-324ms    | [S7,MB6,BI] 324-9-334ms    | [S3,MB3,BW] 334-9-343ms    | [S7,MB7,F]  343-9-352ms    | [S7,MB7,BI] 352-9-362ms    | [S7,MB4,BW] 362-9-371ms    | [S3,MB4,BI] 371-9-380ms    | [S7,MB5,BW] 380-9-389ms    | [S3,MB5,BI] 389-9-399ms    | [S7,MB6,BW] 399-9-408ms    | [S3,MB6,BI] 408-9-417ms    | [S7,MB7,BW] 417-9-427ms    | [S3,MB7,BI] 427-9-436ms    | [S3,MB4,BW] 436-9-445ms    | [S3,MB5,BW] 445-9-454ms    | [S3,MB6,BW] 454-9-464ms    | [S3,MB7,BW] 464-9-473ms   
[rank3]:2025-12-31 13:08:11,288 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1308_stage3_final800.svg
[rank3]:2025-12-31 13:08:11,333 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_ratio_history/rank3/251231_1308_stage7_final800.svg
[rank1]:2025-12-31 13:08:11,417 - Process group destroyed
[rank3]:2025-12-31 13:08:11,434 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank3_stage3.svg
[rank3]:	> Counts Sum: 1134, Total Sum: 1350 (84.00%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0]
[rank3]:2025-12-31 13:08:11,514 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1/frozen_params_histogram/251231_1308_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 825 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 13:08:11,515 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.33739
[rank3]:wandb:               final/avg_loss 0.23878
[rank3]:wandb:             final/avg_mfu(%) 17.37087
[rank3]:wandb:             final/avg_tflops 59.05973
[rank3]:wandb:    final/avg_throughput(tps) 7554.77172
[rank3]:wandb:              final/grad_norm 1.51042
[rank3]:wandb:               final/max_loss 0.23878
[rank3]:wandb:                    grad_norm 1.51042
[rank3]:wandb: loss_metrics/global_avg_loss 0.23878
[rank3]:wandb: loss_metrics/global_max_loss 0.23878
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_InterleavedZeroBubble_auto_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/nxv2n40f
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_auto_22_dm1/20251231-1206/wandb/run-20251231_120640-nxv2n40f/logs
[rank0]:2025-12-31 13:08:12,896 - Training completed
[rank0]:2025-12-31 13:08:12,896 - Destroying the purge thread.
[rank3]:2025-12-31 13:08:13,040 - Process group destroyed
[rank0]:2025-12-31 13:08:13,075 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.3', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: InterleavedZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_InterleavedZeroBubble_auto_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
