
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 15:55:10 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_Interleaved1F1B_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-24 15:55:16,876 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank0]:2025-12-24 15:55:17,020 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-24 15:55:17,021 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-24 15:55:17,031 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank2]:2025-12-24 15:55:17,051 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 15:55:17,053 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 15:55:17,359 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 15:55:17,361 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 15:55:17,365 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 15:55:17,366 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-24 15:55:17,374 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 15:55:17,377 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-24 15:55:17,386 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 15:55:17,388 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 15:55:17,763 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-24 15:55:20,591 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-24 15:55:20,796 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 15:55:20,743 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 15:55:20,785 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 15:55:20,786 - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-12-24 15:55:20,837 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 15:55:20,864 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-24 15:55:20,877 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-24 15:55:20,879 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 15:55:20,812 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-24 15:55:20,825 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-24 15:55:20,826 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-24 15:55:20,809 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 15:55:20,850 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 15:55:20,876 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-24 15:55:20,888 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-24 15:55:20,890 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-24 15:55:21,074 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 15:55:21,074 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 15:55:21,075 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-24 15:55:21,027 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 15:55:21,027 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 15:55:21,027 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-24 15:55:21,078 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 15:55:21,078 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 15:55:21,079 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run sndoa15k
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_timelyapf_42_dm1/20251224-1555/wandb/run-20251224_155522-sndoa15k
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/sndoa15k
[rank3]:2025-12-24 15:55:23,084 - WandB logging enabled
[rank3]:2025-12-24 15:55:23,084 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 15:55:23,121 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 15:55:23,149 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-24 15:55:23,163 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-24 15:55:23,164 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 15:55:23,369 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_timelyapf_42_dm1
[rank0]:2025-12-24 15:55:23,369 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 15:55:23,369 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 15:55:23,370 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-24 15:55:23,351 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 15:55:23,369 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-24 15:55:23,352 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 15:55:23,352 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 15:55:23,368 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-24 15:55:23,368 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 15:55:25,789 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 15:55:25,789 - Finished loading the checkpoint in 2.42 seconds.
[rank0]:2025-12-24 15:55:25,789 - Training starts at step 1
[rank2]:2025-12-24 15:55:31,369 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 10.24GiB(21.56%)  tps: 3,115  tflops: 24.35  mfu: 7.81%
[rank2]:2025-12-24 15:55:31,369 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-24 15:55:31,381 -  step:  1  loss: 10.6092  grad_norm: 203.0665  memory: 25.52GiB(53.71%)  tps: 3,968  tflops: 31.02  mfu: 9.94%
[rank3]:2025-12-24 15:55:31,382 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 15:55:31,374 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 16.23GiB(34.16%)  tps: 3,110  tflops: 24.31  mfu: 7.79%
[rank1]:2025-12-24 15:55:31,378 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 15:55:31,408 -  step:  1  loss: -4.0000  grad_norm: 203.0665  memory: 16.58GiB(34.89%)  tps: 3,085  tflops: 24.11  mfu: 7.73%
[rank0]:2025-12-24 15:55:31,408 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 15:59:38,088 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 15:59:43,077 - Avg. fwd time: 14.4341 / Avg. bwd time: 40.4988 / Avg. batch time: 1095.9514 (ms) / GPU bubble ratio: 19.80%
[rank2]:2025-12-24 15:59:43,128 - Avg. fwd time: 7.8466 / Avg. bwd time: 18.8798 / Avg. batch time: 1157.8942 (ms) / GPU bubble ratio: 63.07%
[rank1]:2025-12-24 15:59:43,175 - Avg. fwd time: 9.9501 / Avg. bwd time: 24.3059 / Avg. batch time: 1217.6115 (ms) / GPU bubble ratio: 54.99%
[rank3]:2025-12-24 15:59:43,241 -  step: 50  loss:  9.8809  grad_norm: 23.9652  memory: 29.23GiB(61.52%)  tps: 6,375  tflops: 49.84  mfu: 15.97%
[rank2]:2025-12-24 15:59:43,229 -  step: 50  loss: -4.0000  grad_norm: 23.9652  memory: 12.06GiB(25.39%)  tps: 6,375  tflops: 49.84  mfu: 15.97%
[rank0]:2025-12-24 15:59:43,207 - Avg. fwd time: 8.2950 / Avg. bwd time: 21.0859 / Avg. batch time: 1256.4608 (ms) / GPU bubble ratio: 62.59%
[rank0]:2025-12-24 15:59:43,243 -  step: 50  loss: -4.0000  grad_norm: 23.9652  memory: 20.42GiB(42.99%)  tps: 6,376  tflops: 49.84  mfu: 15.98%
[rank1]:2025-12-24 15:59:43,232 -  step: 50  loss: -4.0000  grad_norm: 23.9652  memory: 18.49GiB(38.93%)  tps: 6,375  tflops: 49.84  mfu: 15.97%
[rank3]:2025-12-24 16:00:29,149 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-24 16:01:20,637 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-24 16:01:21,074 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-24 16:01:21,110 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-24 16:01:21,136 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-24 16:02:12,399 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-24 16:02:12,946 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-24 16:03:30,053 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-24 16:03:30,488 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 16:03:30,527 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.71/0.71, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank0]:2025-12-24 16:03:30,527 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.46/0.46, [MB5] 0.41/0.41, [MB6] 0.41/0.41, [MB7] 1.00/1.00
[rank1]:2025-12-24 16:03:30,533 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 16:03:30,785 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1603_max_batch_time.svg
[rank3]:			> Batch Time: 1013.55 ms, GPU Bubble Ratio: 53.38%, 45.54%, 57.65%, 12.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-100ms     | [S4,MB0,B]  178-19-197ms   | [S0,MB7,F]  197-7-204ms    | [S4,MB1,B]  254-19-273ms   | [S4,MB4,F]  386-8-395ms    | [S4,MB2,B]  395-19-414ms   | [S4,MB5,F]  422-8-431ms    | [S4,MB3,B]  431-19-450ms   | [S4,MB6,F]  457-8-466ms    | [S0,MB0,B]  466-25-491ms   | [S4,MB7,F]  491-7-499ms    | [S0,MB1,B]  499-24-524ms   | [S0,MB2,B]  542-23-566ms   | [S0,MB3,B]  587-23-611ms   | [S4,MB4,B]  627-18-645ms   | [S4,MB5,B]  706-18-724ms   | [S4,MB6,B]  785-18-803ms   | [S4,MB7,B]  865-18-883ms   | [S0,MB4,B]  901-23-924ms   | [S0,MB5,B]  929-23-953ms   | [S0,MB6,B]  958-23-982ms   | [S0,MB7,B]  990-23-1013ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-11-95ms     | [S5,MB0,B]  159-18-178ms   | [S1,MB5,F]  178-12-190ms   | [S5,MB1,B]  235-18-254ms   | [S1,MB6,F]  254-11-266ms   | [S5,MB2,B]  314-18-333ms   | [S1,MB7,F]  333-11-344ms   | [S5,MB3,B]  394-19-413ms   | [S5,MB4,F]  413-7-421ms    | [S1,MB0,B]  431-29-460ms   | [S5,MB5,F]  460-9-469ms    | [S1,MB1,B]  469-30-499ms   | [S5,MB6,F]  499-10-510ms   | [S1,MB2,B]  510-32-542ms   | [S5,MB7,F]  542-10-553ms   | [S1,MB3,B]  553-34-587ms   | [S5,MB4,B]  609-18-627ms   | [S5,MB5,B]  687-18-706ms   | [S5,MB6,B]  766-18-785ms   | [S5,MB7,B]  847-18-865ms   | [S1,MB4,B]  873-27-901ms   | [S1,MB5,B]  901-28-929ms   | [S1,MB6,B]  929-29-958ms   | [S1,MB7,B]  958-31-990ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-8-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  140-19-159ms   | [S6,MB3,F]  159-8-167ms    | [S6,MB1,B]  216-19-235ms   | [S2,MB4,F]  235-8-244ms    | [S6,MB2,B]  295-19-314ms   | [S2,MB5,F]  314-7-322ms    | [S6,MB3,B]  374-19-394ms   | [S2,MB6,F]  394-8-402ms    | [S2,MB0,B]  411-19-431ms   | [S2,MB7,F]  431-8-439ms    | [S2,MB1,B]  446-19-466ms   | [S6,MB4,F]  466-8-475ms    | [S2,MB2,B]  480-19-500ms   | [S6,MB5,F]  500-7-508ms    | [S2,MB3,B]  514-20-534ms   | [S6,MB6,F]  534-7-542ms    | [S6,MB4,B]  589-19-609ms   | [S6,MB7,F]  609-8-617ms    | [S6,MB5,B]  669-18-687ms   | [S6,MB6,B]  748-17-766ms   | [S6,MB7,B]  828-18-847ms   | [S2,MB4,B]  855-18-873ms   | [S2,MB5,B]  880-18-898ms   | [S2,MB6,B]  905-18-923ms   | [S2,MB7,B]  929-18-947ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-54-140ms    AFR(10):0.9091 | [S7,MB1,F]  140-19-159ms   | [S7,MB1,B]  159-57-216ms   AFR(10):0.9091 | [S7,MB2,F]  216-21-237ms   | [S7,MB2,B]  237-57-295ms   AFR(10):0.9091 | [S7,MB3,F]  295-21-316ms   | [S7,MB3,B]  316-58-374ms   AFR(10):0.9091 | [S3,MB4,F]  374-12-386ms   | [S3,MB0,B]  386-24-411ms   AFR(10):1.0000 | [S3,MB5,F]  411-11-422ms   | [S3,MB1,B]  422-24-446ms   AFR(10):1.0000 | [S3,MB6,F]  446-10-457ms   | [S3,MB2,B]  457-23-480ms   AFR(10):1.0000 | [S3,MB7,F]  480-10-491ms   | [S3,MB3,B]  491-22-514ms   AFR(10):1.0000 | [S7,MB4,F]  514-18-532ms   | [S7,MB4,B]  532-56-589ms   AFR(10):0.9091 | [S7,MB5,F]  589-21-611ms   | [S7,MB5,B]  611-58-669ms   AFR(10):0.9091 | [S7,MB6,F]  669-21-690ms   | [S7,MB6,B]  690-58-748ms   AFR(10):0.9091 | [S7,MB7,F]  748-21-770ms   | [S7,MB7,B]  770-58-828ms   AFR(10):0.9091 | [S3,MB4,B]  828-26-855ms   AFR(10):1.0000 | [S3,MB5,B]  855-24-880ms   AFR(10):1.0000 | [S3,MB6,B]  880-25-905ms   AFR(10):1.0000 | [S3,MB7,B]  905-23-929ms   AFR(10):1.0000
[rank3]:2025-12-24 16:03:31,020 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1603_min_batch_time.svg
[rank3]:			> Batch Time: 705.98 ms, GPU Bubble Ratio: 70.32%, 49.95%, 59.69%, 9.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-100ms     | [S4,MB0,B]  138-10-148ms   | [S0,MB7,F]  148-7-156ms    | [S4,MB1,B]  191-10-201ms   | [S4,MB4,F]  308-8-317ms    | [S4,MB2,B]  317-10-327ms   | [S4,MB5,F]  333-8-341ms    | [S4,MB3,B]  341-10-352ms   | [S4,MB6,F]  357-8-365ms    | [S0,MB0,B]  365-0-365ms    | [S4,MB7,F]  380-7-387ms    | [S0,MB1,B]  387-0-387ms    | [S0,MB2,B]  398-0-398ms    | [S0,MB3,B]  424-0-424ms    | [S4,MB4,B]  465-9-474ms    | [S4,MB5,B]  537-9-546ms    | [S4,MB6,B]  592-9-601ms    | [S4,MB7,B]  647-9-656ms    | [S0,MB4,B]  664-0-664ms    | [S0,MB5,B]  678-0-678ms    | [S0,MB6,B]  691-0-691ms    | [S0,MB7,B]  705-0-705ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-11-95ms     | [S5,MB0,B]  129-9-138ms    | [S1,MB5,F]  138-12-151ms   | [S5,MB1,B]  181-9-191ms    | [S1,MB6,F]  191-11-202ms   | [S5,MB2,B]  236-9-246ms    | [S1,MB7,F]  246-11-257ms   | [S5,MB3,B]  307-10-317ms   | [S5,MB4,F]  317-7-325ms    | [S1,MB0,B]  332-15-348ms   | [S5,MB5,F]  348-9-357ms    | [S1,MB1,B]  357-15-372ms   | [S5,MB6,F]  372-10-382ms   | [S1,MB2,B]  382-15-398ms   | [S5,MB7,F]  398-10-409ms   | [S1,MB3,B]  409-15-424ms   | [S5,MB4,B]  455-9-465ms    | [S5,MB5,B]  528-9-537ms    | [S5,MB6,B]  582-9-592ms    | [S5,MB7,B]  638-9-647ms    | [S1,MB4,B]  650-13-664ms   | [S1,MB5,B]  664-13-678ms   | [S1,MB6,B]  678-13-691ms   | [S1,MB7,B]  691-13-705ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-8-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  118-10-129ms   | [S6,MB3,F]  129-8-137ms    | [S6,MB1,B]  171-10-181ms   | [S2,MB4,F]  181-8-190ms    | [S6,MB2,B]  226-10-236ms   | [S2,MB5,F]  236-7-244ms    | [S6,MB3,B]  296-10-307ms   | [S2,MB6,F]  307-8-315ms    | [S2,MB0,B]  322-10-332ms   | [S2,MB7,F]  332-8-341ms    | [S2,MB1,B]  346-10-356ms   | [S6,MB4,F]  356-8-365ms    | [S2,MB2,B]  369-10-380ms   | [S6,MB5,F]  380-7-388ms    | [S2,MB3,B]  392-10-403ms   | [S6,MB6,F]  403-7-410ms    | [S6,MB4,B]  445-10-455ms   | [S6,MB7,F]  455-8-464ms    | [S6,MB5,B]  518-10-528ms   | [S6,MB6,B]  573-9-582ms    | [S6,MB7,B]  629-9-638ms    | [S2,MB4,B]  640-9-650ms    | [S2,MB5,B]  653-9-662ms    | [S2,MB6,B]  665-9-674ms    | [S2,MB7,B]  677-9-686ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-32-118ms    AFR(10):0.9091 | [S7,MB1,F]  118-19-137ms   | [S7,MB1,B]  137-33-171ms   AFR(10):0.9091 | [S7,MB2,F]  171-21-192ms   | [S7,MB2,B]  192-33-226ms   AFR(10):0.9091 | [S7,MB3,F]  226-21-247ms   | [S7,MB3,B]  247-49-296ms   AFR(10):0.9091 | [S3,MB4,F]  296-12-308ms   | [S3,MB0,B]  308-13-322ms   AFR(10):1.0000 | [S3,MB5,F]  322-11-333ms   | [S3,MB1,B]  333-13-346ms   AFR(10):1.0000 | [S3,MB6,F]  346-10-357ms   | [S3,MB2,B]  357-12-369ms   AFR(10):1.0000 | [S3,MB7,F]  369-10-380ms   | [S3,MB3,B]  380-12-392ms   AFR(10):1.0000 | [S7,MB4,F]  392-18-411ms   | [S7,MB4,B]  411-33-445ms   AFR(10):0.9091 | [S7,MB5,F]  445-21-466ms   | [S7,MB5,B]  466-51-518ms   AFR(10):0.9091 | [S7,MB6,F]  518-21-539ms   | [S7,MB6,B]  539-34-573ms   AFR(10):0.9091 | [S7,MB7,F]  573-21-595ms   | [S7,MB7,B]  595-33-629ms   AFR(10):0.9091 | [S3,MB4,B]  629-11-640ms   AFR(10):1.0000 | [S3,MB5,B]  640-12-653ms   AFR(10):1.0000 | [S3,MB6,B]  653-11-665ms   AFR(10):1.0000 | [S3,MB7,B]  665-12-677ms   AFR(10):1.0000
[rank3]:2025-12-24 16:03:31,270 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1603_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 729.76 ms, GPU Bubble Ratio: 42.96%, 33.91%, 46.33%, 8.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-100ms     | [S4,MB0,B]  156-19-175ms   | [S0,MB7,F]  175-7-183ms    | [S4,MB1,B]  209-19-228ms   | [S4,MB4,F]  314-8-322ms    | [S4,MB2,B]  322-19-341ms   | [S4,MB5,F]  341-8-350ms    | [S4,MB3,B]  350-19-369ms   | [S4,MB6,F]  369-8-378ms    | [S0,MB0,B]  378-25-403ms   | [S4,MB7,F]  403-7-411ms    | [S0,MB1,B]  418-24-442ms   | [S0,MB2,B]  461-23-484ms   | [S0,MB3,B]  505-23-529ms   | [S4,MB4,B]  529-18-547ms   | [S4,MB5,B]  579-18-597ms   | [S4,MB6,B]  633-18-651ms   | [S4,MB7,B]  673-15-689ms   | [S0,MB4,B]  689-12-701ms   | [S0,MB5,B]  701-13-715ms   | [S0,MB6,B]  715-13-729ms   | [S0,MB7,B]  729-0-729ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-11-95ms     | [S5,MB0,B]  137-18-156ms   | [S1,MB5,F]  156-12-169ms   | [S5,MB1,B]  190-18-209ms   | [S1,MB6,F]  209-11-221ms   | [S5,MB2,B]  245-18-264ms   | [S1,MB7,F]  264-11-275ms   | [S5,MB3,B]  321-19-340ms   | [S5,MB4,F]  340-7-348ms    | [S1,MB0,B]  349-29-378ms   | [S5,MB5,F]  378-9-387ms    | [S1,MB1,B]  387-30-418ms   | [S5,MB6,F]  418-10-428ms   | [S1,MB2,B]  428-32-461ms   | [S5,MB7,F]  461-10-471ms   | [S1,MB3,B]  471-34-505ms   | [S5,MB4,B]  505-18-524ms   | [S5,MB5,B]  560-18-579ms   | [S5,MB6,B]  615-18-633ms   | [S5,MB7,B]  664-9-673ms    | [S1,MB4,B]  673-13-687ms   | [S1,MB5,B]  687-13-701ms   | [S1,MB6,B]  701-13-715ms   | [S1,MB7,B]  715-13-729ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-8-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  118-19-137ms   | [S6,MB3,F]  137-8-146ms    | [S6,MB1,B]  171-19-190ms   | [S2,MB4,F]  190-8-199ms    | [S6,MB2,B]  226-19-245ms   | [S2,MB5,F]  245-7-252ms    | [S6,MB3,B]  302-19-321ms   | [S2,MB6,F]  321-8-329ms    | [S2,MB0,B]  329-19-349ms   | [S2,MB7,F]  349-8-357ms    | [S2,MB1,B]  357-19-377ms   | [S6,MB4,F]  377-8-386ms    | [S2,MB2,B]  386-19-406ms   | [S6,MB5,F]  406-7-413ms    | [S2,MB3,B]  413-20-434ms   | [S6,MB6,F]  434-7-441ms    | [S6,MB4,B]  462-19-481ms   | [S6,MB7,F]  481-8-490ms    | [S6,MB5,B]  541-18-560ms   | [S6,MB6,B]  597-17-615ms   | [S6,MB7,B]  652-11-664ms   | [S2,MB4,B]  664-9-673ms    | [S2,MB5,B]  677-10-687ms   | [S2,MB6,B]  689-12-701ms   | [S2,MB7,B]  706-9-715ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-32-118ms    AFR(10):0.9091 | [S7,MB1,F]  118-19-137ms   | [S7,MB1,B]  137-33-171ms   AFR(10):0.9091 | [S7,MB2,F]  171-21-192ms   | [S7,MB2,B]  192-33-226ms   AFR(10):0.9091 | [S7,MB3,F]  226-21-247ms   | [S7,MB3,B]  247-54-302ms   AFR(10):0.9091 | [S3,MB4,F]  302-12-314ms   | [S3,MB0,B]  314-13-327ms   AFR(10):1.0000 | [S3,MB5,F]  327-11-338ms   | [S3,MB1,B]  338-13-351ms   AFR(10):1.0000 | [S3,MB6,F]  351-10-362ms   | [S3,MB2,B]  362-14-376ms   AFR(10):1.0000 | [S3,MB7,F]  376-10-387ms   | [S3,MB3,B]  387-22-410ms   AFR(10):1.0000 | [S7,MB4,F]  410-18-428ms   | [S7,MB4,B]  428-33-462ms   AFR(10):0.9091 | [S7,MB5,F]  462-21-483ms   | [S7,MB5,B]  483-58-541ms   AFR(10):0.9091 | [S7,MB6,F]  541-21-563ms   | [S7,MB6,B]  563-34-597ms   AFR(10):0.9091 | [S7,MB7,F]  597-21-618ms   | [S7,MB7,B]  618-33-652ms   AFR(10):0.9091 | [S3,MB4,B]  652-11-664ms   AFR(10):1.0000 | [S3,MB5,B]  664-12-677ms   AFR(10):1.0000 | [S3,MB6,B]  677-11-689ms   AFR(10):1.0000 | [S3,MB7,B]  689-17-706ms   AFR(10):1.0000
[rank3]:2025-12-24 16:03:31,271 - 	> Batch Time: 729.76 ms (Average Freeze Ratio: 0.38, Time Reduction Rate: 0.28)
[rank3]:2025-12-24 16:03:31,290 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.85/0.85, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank3]:2025-12-24 16:03:35,143 - Avg. fwd time: 14.2456 / Avg. bwd time: 37.4841 / Avg. batch time: 1046.0770 (ms) / GPU bubble ratio: 20.88%
[rank2]:2025-12-24 16:03:35,177 - Avg. fwd time: 7.8089 / Avg. bwd time: 17.0935 / Avg. batch time: 1106.5942 (ms) / GPU bubble ratio: 63.99%
[rank1]:2025-12-24 16:03:35,202 - Avg. fwd time: 9.9041 / Avg. bwd time: 21.8578 / Avg. batch time: 1161.6609 (ms) / GPU bubble ratio: 56.25%
[rank3]:2025-12-24 16:03:35,244 -  step: 100  loss:  8.8153  grad_norm:  7.1808  memory: 31.20GiB(65.67%)  tps: 7,062  tflops: 55.21  mfu: 17.69%
[rank2]:2025-12-24 16:03:35,232 -  step: 100  loss: -4.0000  grad_norm:  7.1808  memory: 12.98GiB(27.32%)  tps: 7,062  tflops: 55.21  mfu: 17.69%
[rank1]:2025-12-24 16:03:35,236 -  step: 100  loss: -4.0000  grad_norm:  7.1808  memory: 19.63GiB(41.31%)  tps: 7,062  tflops: 55.21  mfu: 17.69%
[rank1]:2025-12-24 16:03:35,307 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1603_stage1_step100.svg
[rank0]:2025-12-24 16:03:35,210 - Avg. fwd time: 8.2714 / Avg. bwd time: 17.8306 / Avg. batch time: 1195.5972 (ms) / GPU bubble ratio: 65.07%
[rank0]:2025-12-24 16:03:35,247 -  step: 100  loss: -4.0000  grad_norm:  7.1808  memory: 22.24GiB(46.82%)  tps: 7,062  tflops: 55.21  mfu: 17.69%
[rank0]:2025-12-24 16:03:35,308 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1603_stage0_step100.svg
[rank2]:2025-12-24 16:03:35,307 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1603_stage2_step100.svg
[rank2]:2025-12-24 16:03:35,345 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1603_stage6_step100.svg
[rank2]:2025-12-24 16:03:35,385 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage2.svg
[rank1]:2025-12-24 16:03:35,346 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1603_stage5_step100.svg
[rank1]:2025-12-24 16:03:35,385 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage1.svg
[rank0]:2025-12-24 16:03:35,348 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1603_stage4_step100.svg
[rank0]:2025-12-24 16:03:35,388 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage0.svg
[rank2]:2025-12-24 16:03:35,422 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage6.svg
[rank1]:2025-12-24 16:03:35,422 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage5.svg
[rank0]:2025-12-24 16:03:35,426 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage4.svg
[rank3]:2025-12-24 16:03:35,485 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1603_step100_rank3.svg
[rank3]:			> Batch Time: 955.50 ms, GPU Bubble Ratio: 78.14%, 63.39%, 70.50%, 33.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  16-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  171-7-179ms    | [S0,MB5,F]  179-8-187ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  340-10-350ms   | [S0,MB7,F]  350-7-358ms    | [S4,MB1,B]  431-10-441ms   | [S4,MB4,F]  469-8-478ms    | [S4,MB2,B]  478-10-488ms   | [S4,MB5,F]  498-8-506ms    | [S4,MB3,B]  506-10-516ms   | [S4,MB6,F]  525-8-534ms    | [S0,MB0,B]  534-0-534ms    | [S4,MB7,F]  552-7-559ms    | [S0,MB1,B]  560-0-560ms    | [S0,MB2,B]  580-0-580ms    | [S0,MB3,B]  638-0-638ms    | [S4,MB4,B]  658-9-667ms    | [S4,MB5,B]  755-9-764ms    | [S4,MB6,B]  818-9-827ms    | [S4,MB7,B]  869-9-878ms    | [S0,MB4,B]  889-0-889ms    | [S0,MB5,B]  915-0-915ms    | [S0,MB6,B]  935-0-935ms    | [S0,MB7,B]  955-0-955ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  269-7-276ms    | [S1,MB4,F]  290-10-301ms   | [S5,MB0,B]  301-9-310ms    | [S1,MB5,F]  334-12-346ms   | [S5,MB1,B]  346-9-356ms    | [S1,MB6,F]  356-11-367ms   | [S5,MB2,B]  431-9-440ms    | [S1,MB7,F]  440-11-451ms   | [S5,MB3,B]  477-10-488ms   | [S5,MB4,F]  489-7-496ms    | [S1,MB0,B]  505-15-520ms   | [S5,MB5,F]  521-8-529ms    | [S1,MB1,B]  533-15-549ms   | [S5,MB6,F]  549-8-558ms    | [S1,MB2,B]  558-15-573ms   | [S5,MB7,F]  574-9-583ms    | [S1,MB3,B]  583-15-598ms   | [S5,MB4,B]  642-9-651ms    | [S5,MB5,B]  724-9-733ms    | [S5,MB6,B]  790-9-799ms    | [S5,MB7,B]  852-9-861ms    | [S1,MB4,B]  868-13-882ms   | [S1,MB5,B]  894-13-908ms   | [S1,MB6,B]  914-13-928ms   | [S1,MB7,B]  934-13-948ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  136-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  263-7-270ms    | [S6,MB0,B]  270-10-281ms   | [S6,MB3,F]  281-8-289ms    | [S6,MB1,B]  324-10-334ms   | [S2,MB4,F]  334-8-342ms    | [S6,MB2,B]  386-10-397ms   | [S2,MB5,F]  397-7-404ms    | [S6,MB3,B]  451-10-461ms   | [S2,MB6,F]  462-7-469ms    | [S2,MB0,B]  477-10-488ms   | [S2,MB7,F]  489-7-496ms    | [S2,MB1,B]  505-10-516ms   | [S6,MB4,F]  516-7-524ms    | [S2,MB2,B]  533-10-544ms   | [S6,MB5,F]  544-8-552ms    | [S2,MB3,B]  556-10-566ms   | [S6,MB6,F]  566-7-574ms    | [S6,MB4,B]  624-10-634ms   | [S6,MB7,F]  635-8-644ms    | [S6,MB5,B]  706-10-716ms   | [S6,MB6,B]  773-9-782ms    | [S6,MB7,B]  837-9-846ms    | [S2,MB4,B]  852-9-861ms    | [S2,MB5,B]  879-9-888ms    | [S2,MB6,B]  894-9-903ms    | [S2,MB7,B]  914-9-923ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-7-112ms    | [S3,MB3,F]  143-7-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-48-254ms   | [S7,MB1,F]  253-18-271ms   | [S7,MB1,B]  284-33-317ms   | [S7,MB2,F]  317-17-334ms   | [S7,MB2,B]  346-33-380ms   | [S7,MB3,F]  379-17-397ms   | [S7,MB3,B]  408-34-443ms   | [S3,MB4,F]  444-9-454ms    | [S3,MB0,B]  454-12-467ms   | [S3,MB5,F]  467-10-477ms   | [S3,MB1,B]  477-12-490ms   | [S3,MB6,F]  490-9-500ms    | [S3,MB2,B]  501-12-513ms   | [S3,MB7,F]  513-10-524ms   | [S3,MB3,B]  523-12-535ms   | [S7,MB4,F]  539-18-557ms   | [S7,MB4,B]  570-49-620ms   | [S7,MB5,F]  617-19-637ms   | [S7,MB5,B]  648-51-700ms   | [S7,MB6,F]  700-21-721ms   | [S7,MB6,B]  733-33-767ms   | [S7,MB7,F]  766-17-784ms   | [S7,MB7,B]  796-33-830ms   | [S3,MB4,B]  829-11-841ms   | [S3,MB5,B]  842-12-854ms   | [S3,MB6,B]  855-11-866ms   | [S3,MB7,B]  872-12-884ms  
[rank3]:2025-12-24 16:03:35,530 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1603_stage3_step100.svg
[rank3]:2025-12-24 16:03:35,569 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1603_stage7_step100.svg
[rank3]:2025-12-24 16:03:35,611 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage3.svg
[rank3]:2025-12-24 16:03:35,648 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1603_stage7.svg
[rank0]:2025-12-24 16:07:21,703 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-24 16:07:21,714 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.48/0.71, [MB4] 0.67/1.00, [MB5] 0.56/0.83, [MB6] 0.40/0.60, [MB7] 0.67/1.00
[rank3]:2025-12-24 16:07:21,739 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.27/0.40, [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.57/0.85, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.37/0.55
[rank1]:2025-12-24 16:07:21,727 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-24 16:07:21,743 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.22/0.33, [MB4] 0.30/0.46, [MB5] 0.27/0.41, [MB6] 0.27/0.41, [MB7] 0.67/1.00
[rank3]:2025-12-24 16:07:26,270 - Avg. fwd time: 14.2156 / Avg. bwd time: 36.5426 / Avg. batch time: 1031.7076 (ms) / GPU bubble ratio: 21.28%
[rank2]:2025-12-24 16:07:26,301 - Avg. fwd time: 7.8087 / Avg. bwd time: 17.1552 / Avg. batch time: 1088.6577 (ms) / GPU bubble ratio: 63.31%
[rank3]:2025-12-24 16:07:26,382 -  step: 150  loss:  4.2705  grad_norm: 20.3642  memory: 31.47GiB(66.25%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank1]:2025-12-24 16:07:26,328 - Avg. fwd time: 9.9500 / Avg. bwd time: 21.8013 / Avg. batch time: 1140.3123 (ms) / GPU bubble ratio: 55.45%
[rank1]:2025-12-24 16:07:26,373 -  step: 150  loss: -4.0000  grad_norm: 20.3642  memory: 19.63GiB(41.31%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank0]:2025-12-24 16:07:26,348 - Avg. fwd time: 8.2635 / Avg. bwd time: 18.4228 / Avg. batch time: 1172.5279 (ms) / GPU bubble ratio: 63.58%
[rank0]:2025-12-24 16:07:26,384 -  step: 150  loss: -4.0000  grad_norm: 20.3642  memory: 22.34GiB(47.02%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank2]:2025-12-24 16:07:26,370 -  step: 150  loss: -4.0000  grad_norm: 20.3642  memory: 12.98GiB(27.32%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank0]:2025-12-24 16:10:58,385 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 16:10:58,437 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.85/0.85, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank1]:2025-12-24 16:10:58,422 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-24 16:10:58,414 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.71/0.71, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank0]:2025-12-24 16:10:58,444 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.46/0.46, [MB5] 0.41/0.41, [MB6] 0.41/0.41, [MB7] 1.00/1.00
[rank3]:2025-12-24 16:11:02,376 - Avg. fwd time: 14.1003 / Avg. bwd time: 35.1456 / Avg. batch time: 1009.4963 (ms) / GPU bubble ratio: 21.95%
[rank3]:2025-12-24 16:11:02,476 -  step: 200  loss:  1.1906  grad_norm:  4.9874  memory: 32.37GiB(68.14%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank1]:2025-12-24 16:11:02,433 - Avg. fwd time: 9.9857 / Avg. bwd time: 21.5533 / Avg. batch time: 1111.9134 (ms) / GPU bubble ratio: 54.62%
[rank1]:2025-12-24 16:11:02,467 -  step: 200  loss: -4.0000  grad_norm:  4.9874  memory: 19.65GiB(41.35%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank2]:2025-12-24 16:11:02,408 - Avg. fwd time: 7.8051 / Avg. bwd time: 17.0825 / Avg. batch time: 1063.2910 (ms) / GPU bubble ratio: 62.55%
[rank2]:2025-12-24 16:11:02,464 -  step: 200  loss: -4.0000  grad_norm:  4.9874  memory: 12.98GiB(27.32%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank0]:2025-12-24 16:11:02,442 - Avg. fwd time: 8.2635 / Avg. bwd time: 18.6150 / Avg. batch time: 1142.3976 (ms) / GPU bubble ratio: 62.35%
[rank0]:2025-12-24 16:11:02,478 -  step: 200  loss: -4.0000  grad_norm:  4.9874  memory: 22.34GiB(47.02%)  tps: 7,582  tflops: 59.27  mfu: 19.00%
[rank1]:2025-12-24 16:11:02,530 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1611_stage1_step200.svg
[rank1]:2025-12-24 16:11:02,574 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1611_stage5_step200.svg
[rank2]:2025-12-24 16:11:02,530 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1611_stage2_step200.svg
[rank2]:2025-12-24 16:11:02,572 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1611_stage6_step200.svg
[rank0]:2025-12-24 16:11:02,530 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1611_stage0_step200.svg
[rank0]:2025-12-24 16:11:02,573 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1611_stage4_step200.svg
[rank3]:2025-12-24 16:11:02,725 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1611_step200_rank3.svg
[rank3]:			> Batch Time: 975.57 ms, GPU Bubble Ratio: 55.50%, 49.19%, 59.74%, 34.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  323-19-342ms   | [S0,MB7,F]  342-7-349ms    | [S4,MB1,B]  413-19-432ms   | [S4,MB4,F]  470-8-479ms    | [S4,MB2,B]  479-19-498ms   | [S4,MB5,F]  500-8-508ms    | [S4,MB3,B]  509-19-528ms   | [S4,MB6,F]  530-8-538ms    | [S0,MB0,B]  545-25-570ms   | [S4,MB7,F]  570-7-578ms    | [S0,MB1,B]  586-24-610ms   | [S0,MB2,B]  630-23-653ms   | [S0,MB3,B]  675-23-699ms   | [S4,MB4,B]  704-18-722ms   | [S4,MB5,B]  760-18-778ms   | [S4,MB6,B]  828-18-846ms   | [S4,MB7,B]  875-16-891ms   | [S0,MB4,B]  897-17-915ms   | [S0,MB5,B]  928-19-947ms   | [S0,MB6,B]  950-14-964ms   | [S0,MB7,B]  971-4-975ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  87-11-98ms     | [S1,MB3,F]  125-11-136ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  254-7-261ms    | [S1,MB4,F]  284-10-295ms   | [S5,MB0,B]  295-19-315ms   | [S1,MB5,F]  316-12-329ms   | [S5,MB1,B]  332-19-351ms   | [S1,MB6,F]  351-11-363ms   | [S5,MB2,B]  413-19-432ms   | [S1,MB7,F]  432-11-443ms   | [S5,MB3,B]  478-19-498ms   | [S5,MB4,F]  498-8-507ms    | [S1,MB0,B]  508-29-538ms   | [S5,MB5,F]  538-9-547ms    | [S1,MB1,B]  547-31-579ms   | [S5,MB6,F]  579-10-589ms   | [S1,MB2,B]  589-34-623ms   | [S5,MB7,F]  623-10-633ms   | [S1,MB3,B]  634-34-668ms   | [S5,MB4,B]  675-22-697ms   | [S5,MB5,B]  734-18-753ms   | [S5,MB6,B]  802-18-821ms   | [S5,MB7,B]  859-9-868ms    | [S1,MB4,B]  874-14-888ms   | [S1,MB5,B]  907-14-921ms   | [S1,MB6,B]  928-14-942ms   | [S1,MB7,B]  950-14-964ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  136-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  185-7-192ms    | [S6,MB2,F]  248-7-255ms    | [S6,MB0,B]  255-19-274ms   | [S6,MB3,F]  274-8-283ms    | [S6,MB1,B]  305-19-325ms   | [S2,MB4,F]  325-8-334ms    | [S6,MB2,B]  368-19-388ms   | [S2,MB5,F]  388-7-395ms    | [S6,MB3,B]  451-19-470ms   | [S2,MB6,F]  470-8-479ms    | [S2,MB0,B]  479-20-499ms   | [S2,MB7,F]  499-8-508ms    | [S2,MB1,B]  509-20-530ms   | [S6,MB4,F]  530-7-538ms    | [S2,MB2,B]  545-20-566ms   | [S6,MB5,F]  566-7-574ms    | [S2,MB3,B]  591-19-611ms   | [S6,MB6,F]  611-7-618ms    | [S6,MB4,B]  630-19-650ms   | [S6,MB7,F]  650-7-657ms    | [S6,MB5,B]  709-18-728ms   | [S6,MB6,B]  778-18-796ms   | [S6,MB7,B]  842-10-853ms   | [S2,MB4,B]  859-9-868ms    | [S2,MB5,B]  891-9-901ms    | [S2,MB6,B]  907-13-920ms   | [S2,MB7,B]  927-9-937ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  105-7-112ms    | [S3,MB3,F]  143-6-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-32-239ms   | [S7,MB1,F]  238-15-254ms   | [S7,MB1,B]  266-33-299ms   | [S7,MB2,F]  299-17-316ms   | [S7,MB2,B]  328-33-362ms   | [S7,MB3,F]  362-17-379ms   | [S7,MB3,B]  391-53-444ms   | [S3,MB4,F]  444-12-457ms   | [S3,MB0,B]  456-13-470ms   | [S3,MB5,F]  469-10-480ms   | [S3,MB1,B]  480-13-493ms   | [S3,MB6,F]  493-10-503ms   | [S3,MB2,B]  503-13-516ms   | [S3,MB7,F]  517-10-527ms   | [S3,MB3,B]  527-23-551ms   | [S7,MB4,F]  553-17-570ms   | [S7,MB4,B]  582-33-616ms   | [S7,MB5,F]  616-16-633ms   | [S7,MB5,B]  644-57-702ms   | [S7,MB6,F]  702-21-724ms   | [S7,MB6,B]  736-34-770ms   | [S7,MB7,F]  771-17-789ms   | [S7,MB7,B]  801-34-835ms   | [S3,MB4,B]  835-12-847ms   | [S3,MB5,B]  847-13-861ms   | [S3,MB6,B]  861-12-873ms   | [S3,MB7,B]  884-15-900ms  
[rank3]:2025-12-24 16:11:02,771 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1611_stage3_step200.svg
[rank1]:2025-12-24 16:11:02,744 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage1.svg
[rank2]:2025-12-24 16:11:02,741 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage2.svg
[rank0]:2025-12-24 16:11:02,745 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage0.svg
[rank3]:2025-12-24 16:11:02,815 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1611_stage7_step200.svg
[rank1]:2025-12-24 16:11:02,907 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage5.svg
[rank2]:2025-12-24 16:11:02,906 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage6.svg
[rank0]:2025-12-24 16:11:02,911 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage4.svg
[rank3]:2025-12-24 16:11:02,982 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage3.svg
[rank3]:2025-12-24 16:11:03,146 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1611_stage7.svg
[rank2]:2025-12-24 16:14:17,762 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.71/0.71, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank0]:2025-12-24 16:14:17,740 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 16:14:17,786 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.85/0.85, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank1]:2025-12-24 16:14:17,769 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-24 16:14:17,792 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.46/0.46, [MB5] 0.41/0.41, [MB6] 0.41/0.41, [MB7] 1.00/1.00
[rank3]:2025-12-24 16:14:21,667 - Avg. fwd time: 13.9091 / Avg. bwd time: 33.4521 / Avg. batch time: 981.1561 (ms) / GPU bubble ratio: 22.77%
[rank1]:2025-12-24 16:14:21,725 - Avg. fwd time: 10.0205 / Avg. bwd time: 21.4034 / Avg. batch time: 1079.5945 (ms) / GPU bubble ratio: 53.43%
[rank1]:2025-12-24 16:14:21,761 -  step: 250  loss: -4.0000  grad_norm:  1.4564  memory: 19.65GiB(41.35%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank2]:2025-12-24 16:14:21,701 - Avg. fwd time: 7.8005 / Avg. bwd time: 16.9837 / Avg. batch time: 1033.1329 (ms) / GPU bubble ratio: 61.62%
[rank2]:2025-12-24 16:14:21,757 -  step: 250  loss: -4.0000  grad_norm:  1.4564  memory: 12.98GiB(27.32%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank0]:2025-12-24 16:14:21,735 - Avg. fwd time: 8.2657 / Avg. bwd time: 18.4630 / Avg. batch time: 1107.1351 (ms) / GPU bubble ratio: 61.37%
[rank0]:2025-12-24 16:14:21,771 -  step: 250  loss: -4.0000  grad_norm:  1.4564  memory: 22.34GiB(47.02%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank3]:2025-12-24 16:14:21,769 -  step: 250  loss:  0.4128  grad_norm:  1.4564  memory: 32.37GiB(68.14%)  tps: 8,221  tflops: 64.27  mfu: 20.60%
[rank2]:2025-12-24 16:17:37,124 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.71/0.71, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank1]:2025-12-24 16:17:37,132 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-24 16:17:37,095 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 16:17:37,154 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.46/0.46, [MB5] 0.41/0.41, [MB6] 0.41/0.41, [MB7] 1.00/1.00
[rank3]:2025-12-24 16:17:37,148 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.85/0.85, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank3]:2025-12-24 16:17:41,042 - Avg. fwd time: 13.7957 / Avg. bwd time: 32.3143 / Avg. batch time: 962.2853 (ms) / GPU bubble ratio: 23.33%
[rank2]:2025-12-24 16:17:41,077 - Avg. fwd time: 7.7974 / Avg. bwd time: 16.9215 / Avg. batch time: 1013.0782 (ms) / GPU bubble ratio: 60.96%
[rank2]:2025-12-24 16:17:41,135 -  step: 300  loss: -4.0000  grad_norm:  0.8231  memory: 12.98GiB(27.32%)  tps: 8,218  tflops: 64.24  mfu: 20.59%
[rank1]:2025-12-24 16:17:41,102 - Avg. fwd time: 10.0419 / Avg. bwd time: 21.3048 / Avg. batch time: 1058.3354 (ms) / GPU bubble ratio: 52.61%
[rank1]:2025-12-24 16:17:41,138 -  step: 300  loss: -4.0000  grad_norm:  0.8231  memory: 19.65GiB(41.35%)  tps: 8,218  tflops: 64.24  mfu: 20.59%
[rank0]:2025-12-24 16:17:41,113 - Avg. fwd time: 8.2656 / Avg. bwd time: 18.4128 / Avg. batch time: 1084.0164 (ms) / GPU bubble ratio: 60.62%
[rank0]:2025-12-24 16:17:41,149 -  step: 300  loss: -4.0000  grad_norm:  0.8231  memory: 22.34GiB(47.02%)  tps: 8,218  tflops: 64.24  mfu: 20.59%
[rank3]:2025-12-24 16:17:41,147 -  step: 300  loss:  0.2969  grad_norm:  0.8231  memory: 32.37GiB(68.14%)  tps: 8,218  tflops: 64.24  mfu: 20.59%
[rank2]:2025-12-24 16:17:41,201 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1617_stage2_step300.svg
[rank2]:2025-12-24 16:17:41,243 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1617_stage6_step300.svg
[rank1]:2025-12-24 16:17:41,199 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1617_stage1_step300.svg
[rank1]:2025-12-24 16:17:41,241 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1617_stage5_step300.svg
[rank0]:2025-12-24 16:17:41,199 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1617_stage0_step300.svg
[rank0]:2025-12-24 16:17:41,241 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1617_stage4_step300.svg
[rank3]:2025-12-24 16:17:41,398 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1617_step300_rank3.svg
[rank3]:			> Batch Time: 968.50 ms, GPU Bubble Ratio: 55.77%, 48.82%, 59.71%, 33.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-8-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  323-19-342ms   | [S0,MB7,F]  342-7-350ms    | [S4,MB1,B]  413-19-432ms   | [S4,MB4,F]  470-8-479ms    | [S4,MB2,B]  479-19-498ms   | [S4,MB5,F]  500-8-508ms    | [S4,MB3,B]  508-19-528ms   | [S4,MB6,F]  530-8-538ms    | [S0,MB0,B]  545-25-570ms   | [S4,MB7,F]  571-7-578ms    | [S0,MB1,B]  586-24-611ms   | [S0,MB2,B]  631-23-655ms   | [S0,MB3,B]  677-23-700ms   | [S4,MB4,B]  705-18-723ms   | [S4,MB5,B]  760-18-778ms   | [S4,MB6,B]  826-18-844ms   | [S4,MB7,B]  872-14-886ms   | [S0,MB4,B]  893-13-906ms   | [S0,MB5,B]  924-19-943ms   | [S0,MB6,B]  946-17-964ms   | [S0,MB7,B]  968-0-968ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-10-136ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  254-7-261ms    | [S1,MB4,F]  283-10-294ms   | [S5,MB0,B]  294-19-314ms   | [S1,MB5,F]  316-12-329ms   | [S5,MB1,B]  332-19-351ms   | [S1,MB6,F]  351-11-363ms   | [S5,MB2,B]  413-19-432ms   | [S1,MB7,F]  432-11-443ms   | [S5,MB3,B]  478-19-498ms   | [S5,MB4,F]  498-8-506ms    | [S1,MB0,B]  508-29-538ms   | [S5,MB5,F]  538-9-547ms    | [S1,MB1,B]  547-31-578ms   | [S5,MB6,F]  579-10-590ms   | [S1,MB2,B]  590-34-624ms   | [S5,MB7,F]  624-10-635ms   | [S1,MB3,B]  635-34-670ms   | [S5,MB4,B]  676-22-698ms   | [S5,MB5,B]  734-18-753ms   | [S5,MB6,B]  801-18-819ms   | [S5,MB7,B]  856-9-865ms    | [S1,MB4,B]  871-14-885ms   | [S1,MB5,B]  903-14-917ms   | [S1,MB6,B]  923-14-937ms   | [S1,MB7,B]  946-14-960ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-192ms    | [S6,MB2,F]  248-7-255ms    | [S6,MB0,B]  255-19-274ms   | [S6,MB3,F]  274-8-282ms    | [S6,MB1,B]  306-19-325ms   | [S2,MB4,F]  325-8-333ms    | [S6,MB2,B]  368-19-388ms   | [S2,MB5,F]  388-7-395ms    | [S6,MB3,B]  451-19-471ms   | [S2,MB6,F]  471-8-480ms    | [S2,MB0,B]  480-20-500ms   | [S2,MB7,F]  500-8-508ms    | [S2,MB1,B]  509-20-529ms   | [S6,MB4,F]  529-8-537ms    | [S2,MB2,B]  545-21-566ms   | [S6,MB5,F]  566-7-574ms    | [S2,MB3,B]  592-19-612ms   | [S6,MB6,F]  612-7-619ms    | [S6,MB4,B]  631-20-651ms   | [S6,MB7,F]  651-7-658ms    | [S6,MB5,B]  709-18-728ms   | [S6,MB6,B]  776-18-795ms   | [S6,MB7,B]  840-9-850ms    | [S2,MB4,B]  855-9-865ms    | [S2,MB5,B]  887-9-896ms    | [S2,MB6,B]  903-11-914ms   | [S2,MB7,B]  923-9-932ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-32-238ms   | [S7,MB1,F]  238-15-254ms   | [S7,MB1,B]  266-32-299ms   | [S7,MB2,F]  299-17-316ms   | [S7,MB2,B]  328-33-361ms   | [S7,MB3,F]  362-17-379ms   | [S7,MB3,B]  391-54-446ms   | [S3,MB4,F]  445-12-457ms   | [S3,MB0,B]  457-13-471ms   | [S3,MB5,F]  470-10-481ms   | [S3,MB1,B]  481-13-494ms   | [S3,MB6,F]  494-10-504ms   | [S3,MB2,B]  504-12-517ms   | [S3,MB7,F]  517-10-527ms   | [S3,MB3,B]  528-23-551ms   | [S7,MB4,F]  553-17-571ms   | [S7,MB4,B]  583-33-616ms   | [S7,MB5,F]  616-16-633ms   | [S7,MB5,B]  645-57-703ms   | [S7,MB6,F]  702-21-724ms   | [S7,MB6,B]  736-34-770ms   | [S7,MB7,F]  770-17-787ms   | [S7,MB7,B]  799-33-833ms   | [S3,MB4,B]  833-12-845ms   | [S3,MB5,B]  845-12-858ms   | [S3,MB6,B]  858-11-870ms   | [S3,MB7,B]  880-16-897ms  
[rank3]:2025-12-24 16:17:41,442 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1617_stage3_step300.svg
[rank3]:2025-12-24 16:17:41,482 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1617_stage7_step300.svg
[rank2]:2025-12-24 16:17:41,539 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage2.svg
[rank1]:2025-12-24 16:17:41,539 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage1.svg
[rank0]:2025-12-24 16:17:41,542 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage0.svg
[rank3]:2025-12-24 16:17:41,774 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage3.svg
[rank2]:2025-12-24 16:17:41,829 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage6.svg
[rank1]:2025-12-24 16:17:41,829 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage5.svg
[rank0]:2025-12-24 16:17:41,836 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage4.svg
[rank3]:2025-12-24 16:17:42,060 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1617_stage7.svg
