
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 15:49:22 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_GPipe_timelyauto_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-30 15:49:28,640 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank2]:2025-12-30 15:49:28,639 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank3]:2025-12-30 15:49:28,773 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank0]:2025-12-30 15:49:28,758 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank1]:2025-12-30 15:49:28,865 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 15:49:28,867 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-30 15:49:28,852 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 15:49:28,854 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 15:49:29,003 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 15:49:29,006 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 15:49:29,010 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 15:49:29,011 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-30 15:49:29,025 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 15:49:29,027 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 15:49:29,407 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 15:49:32,704 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-30 15:49:32,918 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 15:49:32,878 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 15:49:32,918 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 15:49:32,919 - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-30 15:49:32,846 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 15:49:32,884 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 15:49:32,913 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 15:49:32,913 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-30 15:49:32,955 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 15:49:32,983 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 15:49:32,983 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-30 15:49:32,946 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 15:49:32,946 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-30 15:49:33,106 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 15:49:33,107 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 15:49:33,107 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-30 15:49:33,175 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 15:49:33,175 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 15:49:33,176 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-30 15:49:33,140 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 15:49:33,140 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 15:49:33,140 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run w26n2etw
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_GPipe_timelyauto_22_dm1/20251230-1549/wandb/run-20251230_154933-w26n2etw
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_GPipe_timelyauto_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/w26n2etw
[rank3]:2025-12-30 15:49:35,254 - WandB logging enabled
[rank3]:2025-12-30 15:49:35,255 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 15:49:35,294 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 15:49:35,320 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 15:49:35,321 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-30 15:49:35,509 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 15:49:35,510 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 15:49:35,511 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-12-30 15:49:35,530 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-30 15:49:35,527 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-30 15:49:35,530 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 15:49:35,527 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_GPipe_timelyauto_22_dm1
[rank0]:2025-12-30 15:49:35,528 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 15:49:35,528 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 15:49:35,528 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-30 15:49:38,103 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-30 15:49:38,103 - Finished loading the checkpoint in 2.57 seconds.
[rank0]:2025-12-30 15:49:38,103 - Training starts at step 1
[rank3]:2025-12-30 15:49:43,630 -  step:  1  loss: 10.6088  grad_norm: 116.5369  memory: 24.19GiB(50.91%)  tps: 3,932  tflops: 30.74  mfu: 9.85%
[rank3]:2025-12-30 15:49:43,631 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-30 15:49:43,620 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory: 10.24GiB(21.56%)  tps: 3,052  tflops: 23.86  mfu: 7.65%
[rank2]:2025-12-30 15:49:43,620 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 15:49:43,636 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory: 12.75GiB(26.83%)  tps: 3,068  tflops: 23.98  mfu: 7.69%
[rank1]:2025-12-30 15:49:43,637 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 15:49:43,657 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory: 13.25GiB(27.89%)  tps: 3,051  tflops: 23.85  mfu: 7.65%
[rank0]:2025-12-30 15:49:43,657 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 15:51:42,040 - Avg. fwd time: 10.7409 / Avg. bwd time: 43.1001 / Avg. batch time: 490.4671 (ms) / GPU bubble ratio: 12.18%
[rank1]:2025-12-30 15:51:42,095 - Avg. fwd time: 9.0467 / Avg. bwd time: 24.8447 / Avg. batch time: 562.8324 (ms) / GPU bubble ratio: 51.83%
[rank2]:2025-12-30 15:51:42,065 - Avg. fwd time: 6.9722 / Avg. bwd time: 19.2790 / Avg. batch time: 522.6149 (ms) / GPU bubble ratio: 59.82%
[rank0]:2025-12-30 15:51:42,125 - Avg. fwd time: 8.2003 / Avg. bwd time: 25.0993 / Avg. batch time: 601.6541 (ms) / GPU bubble ratio: 55.72%
[rank0]:2025-12-30 15:53:40,990 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 15:53:45,815 - Avg. fwd time: 10.7435 / Avg. bwd time: 43.2571 / Avg. batch time: 491.6342 (ms) / GPU bubble ratio: 12.13%
[rank2]:2025-12-30 15:53:45,840 - Avg. fwd time: 6.9712 / Avg. bwd time: 19.3105 / Avg. batch time: 523.3742 (ms) / GPU bubble ratio: 59.83%
[rank1]:2025-12-30 15:53:45,870 - Avg. fwd time: 9.0515 / Avg. bwd time: 24.9140 / Avg. batch time: 563.3030 (ms) / GPU bubble ratio: 51.76%
[rank1]:2025-12-30 15:53:45,926 -  step: 50  loss: -8.0000  grad_norm: 12.9265  memory: 15.15GiB(31.89%)  tps: 6,627  tflops: 51.81  mfu: 16.60%
[rank3]:2025-12-30 15:53:45,935 -  step: 50  loss:  9.9133  grad_norm: 12.9265  memory: 26.98GiB(56.79%)  tps: 6,627  tflops: 51.80  mfu: 16.60%
[rank2]:2025-12-30 15:53:45,922 -  step: 50  loss: -8.0000  grad_norm: 12.9265  memory: 12.26GiB(25.80%)  tps: 6,627  tflops: 51.80  mfu: 16.60%
[rank0]:2025-12-30 15:53:45,901 - Avg. fwd time: 8.1874 / Avg. bwd time: 25.1466 / Avg. batch time: 601.8025 (ms) / GPU bubble ratio: 55.69%
[rank0]:2025-12-30 15:53:45,937 -  step: 50  loss: -8.0000  grad_norm: 12.9265  memory: 17.08GiB(35.95%)  tps: 6,627  tflops: 51.81  mfu: 16.61%
[rank3]:2025-12-30 15:54:30,185 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-30 15:55:19,629 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-30 15:55:19,939 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-12-30 15:55:38,654 - Avg. fwd time: 9.0501 / Avg. bwd time: 23.8048 / Avg. batch time: 547.5437 (ms) / GPU bubble ratio: 52.00%
[rank0]:2025-12-30 15:55:38,659 - Avg. fwd time: 8.1783 / Avg. bwd time: 23.1496 / Avg. batch time: 583.9032 (ms) / GPU bubble ratio: 57.08%
[rank3]:2025-12-30 15:55:38,624 - Avg. fwd time: 10.7442 / Avg. bwd time: 41.5746 / Avg. batch time: 478.1484 (ms) / GPU bubble ratio: 12.46%
[rank2]:2025-12-30 15:55:38,639 - Avg. fwd time: 6.9670 / Avg. bwd time: 18.4478 / Avg. batch time: 508.8653 (ms) / GPU bubble ratio: 60.04%
[rank3]:2025-12-30 15:55:50,919 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-30 15:55:51,251 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1555_max_batch_time.svg
[rank3]:			> Batch Time: 532.75 ms, GPU Bubble Ratio: 49.63%, 48.60%, 60.29%, 18.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  200-25-225ms   | [S0,MB1,B]  243-25-268ms   | [S0,MB2,B]  286-25-312ms   | [S0,MB3,B]  330-25-355ms   | [S0,MB4,B]  374-25-400ms   | [S0,MB5,B]  419-25-444ms   | [S0,MB6,B]  462-25-488ms   | [S0,MB7,B]  507-25-532ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-64ms      | [S1,MB6,F]  64-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  175-24-200ms   | [S1,MB1,B]  218-24-243ms   | [S1,MB2,B]  261-25-286ms   | [S1,MB3,B]  305-25-330ms   | [S1,MB4,B]  349-25-374ms   | [S1,MB5,B]  393-25-419ms   | [S1,MB6,B]  437-25-462ms   | [S1,MB7,B]  482-25-507ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  64-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  156-19-175ms   | [S2,MB1,B]  198-19-218ms   | [S2,MB2,B]  241-19-261ms   | [S2,MB3,B]  285-19-305ms   | [S2,MB4,B]  330-19-349ms   | [S2,MB5,B]  374-19-393ms   | [S2,MB6,B]  418-19-437ms   | [S2,MB7,B]  462-19-482ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-52ms     | [S3,MB2,F]  52-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-83ms     | [S3,MB5,F]  83-10-94ms     | [S3,MB6,F]  94-10-104ms    | [S3,MB7,F]  104-10-115ms   | [S3,MB0,B]  115-40-156ms   AFR(10):0.9655 | [S3,MB1,B]  156-42-198ms   AFR(10):0.9655 | [S3,MB2,B]  198-43-241ms   AFR(10):0.9655 | [S3,MB3,B]  241-43-285ms   AFR(10):0.9655 | [S3,MB4,B]  285-44-330ms   AFR(10):0.9655 | [S3,MB5,B]  330-44-374ms   AFR(10):0.9655 | [S3,MB6,B]  374-43-418ms   AFR(10):0.9655 | [S3,MB7,B]  418-44-462ms   AFR(10):0.9655
[rank3]:2025-12-30 15:55:51,374 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1555_min_batch_time.svg
[rank3]:			> Batch Time: 309.29 ms, GPU Bubble Ratio: 78.82%, 48.84%, 60.54%, 15.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  156-0-156ms    | [S0,MB1,B]  178-0-178ms    | [S0,MB2,B]  200-0-200ms    | [S0,MB3,B]  221-0-221ms    | [S0,MB4,B]  243-0-243ms    | [S0,MB5,B]  265-0-265ms    | [S0,MB6,B]  287-0-287ms    | [S0,MB7,B]  309-0-309ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-64ms      | [S1,MB6,F]  64-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  145-10-156ms   | [S1,MB1,B]  167-10-178ms   | [S1,MB2,B]  189-10-200ms   | [S1,MB3,B]  210-10-221ms   | [S1,MB4,B]  233-10-243ms   | [S1,MB5,B]  254-10-265ms   | [S1,MB6,B]  276-10-287ms   | [S1,MB7,B]  298-10-309ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  64-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  137-8-145ms    | [S2,MB1,B]  159-8-167ms    | [S2,MB2,B]  181-8-189ms    | [S2,MB3,B]  202-8-210ms    | [S2,MB4,B]  224-8-233ms    | [S2,MB5,B]  246-8-254ms    | [S2,MB6,B]  268-8-276ms    | [S2,MB7,B]  290-8-298ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-52ms     | [S3,MB2,F]  52-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-83ms     | [S3,MB5,F]  83-10-94ms     | [S3,MB6,F]  94-10-104ms    | [S3,MB7,F]  104-10-115ms   | [S3,MB0,B]  115-21-137ms   AFR(10):0.9655 | [S3,MB1,B]  137-21-159ms   AFR(10):0.9655 | [S3,MB2,B]  159-22-181ms   AFR(10):0.9655 | [S3,MB3,B]  181-21-202ms   AFR(10):0.9655 | [S3,MB4,B]  202-22-224ms   AFR(10):0.9655 | [S3,MB5,B]  224-21-246ms   AFR(10):0.9655 | [S3,MB6,B]  246-22-268ms   AFR(10):0.9655 | [S3,MB7,B]  268-21-290ms   AFR(10):0.9655
[rank3]:2025-12-30 15:55:51,508 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1555_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 340.55 ms, GPU Bubble Ratio: 41.41%, 32.91%, 41.29%, 14.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  200-25-225ms   | [S0,MB1,B]  231-25-257ms   | [S0,MB2,B]  257-18-275ms   | [S0,MB3,B]  275-21-297ms   | [S0,MB4,B]  297-22-319ms   | [S0,MB5,B]  319-21-340ms   | [S0,MB6,B]  340-0-340ms    | [S0,MB7,B]  340-0-340ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-64ms      | [S1,MB6,F]  64-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  175-24-200ms   | [S1,MB1,B]  209-22-231ms   | [S1,MB2,B]  231-25-257ms   | [S1,MB3,B]  257-18-275ms   | [S1,MB4,B]  275-21-297ms   | [S1,MB5,B]  297-22-319ms   | [S1,MB6,B]  319-10-329ms   | [S1,MB7,B]  329-10-340ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-62ms      | [S2,MB5,F]  64-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  156-19-175ms   | [S2,MB1,B]  190-19-209ms   | [S2,MB2,B]  212-19-231ms   | [S2,MB3,B]  233-19-253ms   | [S2,MB4,B]  256-19-275ms   | [S2,MB5,B]  277-19-297ms   | [S2,MB6,B]  300-19-319ms   | [S2,MB7,B]  321-8-329ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-52ms     | [S3,MB2,F]  52-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-83ms     | [S3,MB5,F]  83-10-94ms     | [S3,MB6,F]  94-10-104ms    | [S3,MB7,F]  104-10-115ms   | [S3,MB0,B]  115-40-156ms   AFR(10):0.9655 | [S3,MB1,B]  156-34-190ms   AFR(10):0.9655 | [S3,MB2,B]  190-22-212ms   AFR(10):0.9655 | [S3,MB3,B]  212-21-233ms   AFR(10):0.9655 | [S3,MB4,B]  233-22-256ms   AFR(10):0.9655 | [S3,MB5,B]  256-21-277ms   AFR(10):0.9655 | [S3,MB6,B]  277-22-300ms   AFR(10):0.9655 | [S3,MB7,B]  300-21-321ms   AFR(10):0.9655
[rank3]:2025-12-30 15:55:51,508 - 	> Batch Time: 340.55 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.36)
[rank0]:2025-12-30 15:57:15,927 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 15:57:15,941 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.03, [MB7] 0.33/1.00
[rank1]:2025-12-30 15:57:15,945 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.07/0.20, [MB2] 0.00/0.00, [MB3] 0.16/0.48, [MB4] 0.08/0.24, [MB5] 0.07/0.21, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-12-30 15:57:15,957 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.09/0.28, [MB3] 0.05/0.14, [MB4] 0.04/0.13, [MB5] 0.05/0.16, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-12-30 15:57:15,954 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-12-30 15:57:20,509 - Avg. fwd time: 10.7386 / Avg. bwd time: 39.2251 / Avg. batch time: 459.2897 (ms) / GPU bubble ratio: 12.97%
[rank2]:2025-12-30 15:57:20,530 - Avg. fwd time: 6.9646 / Avg. bwd time: 18.0712 / Avg. batch time: 491.0238 (ms) / GPU bubble ratio: 59.21%
[rank1]:2025-12-30 15:57:20,556 - Avg. fwd time: 9.0587 / Avg. bwd time: 22.9301 / Avg. batch time: 528.4112 (ms) / GPU bubble ratio: 51.57%
[rank1]:2025-12-30 15:57:20,607 -  step: 100  loss: -8.0000  grad_norm:  7.7813  memory: 15.15GiB(31.89%)  tps: 7,632  tflops: 59.66  mfu: 19.12%
[rank0]:2025-12-30 15:57:20,582 - Avg. fwd time: 8.1688 / Avg. bwd time: 21.6862 / Avg. batch time: 561.2903 (ms) / GPU bubble ratio: 57.45%
[rank0]:2025-12-30 15:57:20,618 -  step: 100  loss: -8.0000  grad_norm:  7.7813  memory: 17.08GiB(35.95%)  tps: 7,632  tflops: 59.66  mfu: 19.12%
[rank3]:2025-12-30 15:57:20,616 -  step: 100  loss:  8.6374  grad_norm:  7.7813  memory: 26.98GiB(56.79%)  tps: 7,632  tflops: 59.66  mfu: 19.12%
[rank2]:2025-12-30 15:57:20,603 -  step: 100  loss: -8.0000  grad_norm:  7.7813  memory: 12.26GiB(25.80%)  tps: 7,632  tflops: 59.66  mfu: 19.12%
[rank1]:2025-12-30 15:57:20,675 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1557_stage1_step100.svg
[rank0]:2025-12-30 15:57:20,676 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1557_stage0_step100.svg
[rank2]:2025-12-30 15:57:20,675 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1557_stage2_step100.svg
[rank1]:2025-12-30 15:57:20,825 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1557_rank1_stage1.svg
[rank1]:	> Counts Sum: 43200, Total Sum: 86400 (50.00%), Ratio(%) per element: [50.0, 50.0, 41.66, 58.33, 45.83, 50.0, 45.83, 41.66, 58.33, 41.66, 41.66, 50.0, 50.0, 54.16, 45.83, 58.33, 54.16, 50.0, 45.83, 54.16, 58.33, 50.0, 50.0, 50.0, 45.83, 54.16, 45.83, 45.83, 50.0, 54.16, 58.33, 45.83, 45.83, 45.83, 45.83, 45.83, 45.83, 62.5, 54.16, 45.83, 45.83, 58.33, 50.0, 58.33, 50.0]
[rank0]:2025-12-30 15:57:20,832 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1557_rank0_stage0.svg
[rank0]:	> Counts Sum: 33840, Total Sum: 71040 (47.64%), Ratio(%) per element: [50.0, 54.16, 50.0, 50.0, 45.83, 50.0, 41.66, 54.16, 50.0, 41.66, 45.83, 50.0, 50.0, 45.83, 45.83, 41.66, 50.0, 45.83, 54.16, 50.0, 45.83, 41.66, 41.66, 50.0, 50.0, 41.66, 50.0, 45.83, 45.83, 41.66, 45.83, 50.0, 50.0, 50.0, 45.83, 50.0, 50.0]
[rank3]:2025-12-30 15:57:20,752 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1557_step100_rank3.svg
[rank3]:			> Batch Time: 569.81 ms, GPU Bubble Ratio: 55.79%, 53.76%, 63.62%, 27.03%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-7-56ms      | [S0,MB7,F]  56-8-64ms      | [S0,MB0,B]  270-25-295ms   | [S0,MB1,B]  312-25-337ms   | [S0,MB2,B]  353-24-377ms   | [S0,MB3,B]  393-24-418ms   | [S0,MB4,B]  436-24-460ms   | [S0,MB5,B]  478-23-502ms   | [S0,MB6,B]  516-16-532ms   | [S0,MB7,B]  548-21-569ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  242-24-267ms   | [S1,MB1,B]  284-24-309ms   | [S1,MB2,B]  324-25-350ms   | [S1,MB3,B]  366-24-390ms   | [S1,MB4,B]  407-25-432ms   | [S1,MB5,B]  450-24-475ms   | [S1,MB6,B]  490-22-513ms   | [S1,MB7,B]  525-20-545ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-239ms   | [S2,MB1,B]  261-19-281ms   | [S2,MB2,B]  302-19-321ms   | [S2,MB3,B]  343-19-363ms   | [S2,MB4,B]  384-19-404ms   | [S2,MB5,B]  428-19-447ms   | [S2,MB6,B]  468-19-487ms   | [S2,MB7,B]  506-15-522ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-167ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  213-41-254ms   | [S3,MB2,B]  255-40-295ms   | [S3,MB3,B]  295-41-336ms   | [S3,MB4,B]  336-41-378ms   | [S3,MB5,B]  378-42-420ms   | [S3,MB6,B]  420-40-461ms   | [S3,MB7,B]  461-41-503ms  
[rank3]:2025-12-30 15:57:20,793 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1557_stage3_step100.svg
[rank2]:2025-12-30 15:57:20,829 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1557_rank2_stage2.svg
[rank2]:	> Counts Sum: 26800, Total Sum: 69120 (38.77%), Ratio(%) per element: [37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 41.66, 41.66, 37.5, 41.66, 37.5, 37.5]
[rank1]:2025-12-30 15:57:20,912 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1557_stage1.svg
[rank0]:2025-12-30 15:57:20,921 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1557_stage0.svg
[rank3]:2025-12-30 15:57:20,927 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1557_rank3_stage3.svg
[rank3]:	> Counts Sum: 36880, Total Sum: 55680 (66.24%), Ratio(%) per element: [83.33, 66.66, 75.0, 79.16, 70.83, 70.83, 75.0, 70.83, 75.0, 79.16, 66.66, 70.83, 58.33, 79.16, 70.83, 75.0, 70.83, 75.0, 58.33, 58.33, 58.33, 54.16, 45.83, 50.0, 58.33, 54.16, 58.33, 54.16, 58.33]
[rank2]:2025-12-30 15:57:20,918 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1557_stage2.svg
[rank3]:2025-12-30 15:57:21,031 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1557_stage3.svg
[rank1]:2025-12-30 15:59:12,841 - Avg. fwd time: 9.0614 / Avg. bwd time: 23.0096 / Avg. batch time: 524.4562 (ms) / GPU bubble ratio: 51.08%
[rank2]:2025-12-30 15:59:12,814 - Avg. fwd time: 6.9632 / Avg. bwd time: 18.2534 / Avg. batch time: 487.2089 (ms) / GPU bubble ratio: 58.59%
[rank0]:2025-12-30 15:59:12,867 - Avg. fwd time: 8.1673 / Avg. bwd time: 22.0458 / Avg. batch time: 557.5149 (ms) / GPU bubble ratio: 56.65%
[rank3]:2025-12-30 15:59:12,793 - Avg. fwd time: 10.7358 / Avg. bwd time: 38.8610 / Avg. batch time: 456.3408 (ms) / GPU bubble ratio: 13.05%
[rank1]:2025-12-30 16:00:54,086 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.20, [MB2] 0.00/0.00, [MB3] 0.32/0.48, [MB4] 0.16/0.24, [MB5] 0.14/0.21, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-30 16:00:54,094 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-12-30 16:00:54,081 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.03, [MB7] 0.67/1.00
[rank0]:2025-12-30 16:00:54,075 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 16:00:54,097 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.19/0.28, [MB3] 0.10/0.14, [MB4] 0.09/0.13, [MB5] 0.10/0.16, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-30 16:00:57,980 - Avg. fwd time: 10.7399 / Avg. bwd time: 38.1569 / Avg. batch time: 450.7363 (ms) / GPU bubble ratio: 13.21%
[rank2]:2025-12-30 16:00:58,000 - Avg. fwd time: 6.9629 / Avg. bwd time: 18.3572 / Avg. batch time: 480.7792 (ms) / GPU bubble ratio: 57.87%
[rank1]:2025-12-30 16:00:58,021 - Avg. fwd time: 9.0673 / Avg. bwd time: 22.8955 / Avg. batch time: 517.4216 (ms) / GPU bubble ratio: 50.58%
[rank1]:2025-12-30 16:00:58,064 -  step: 150  loss: -8.0000  grad_norm:  5.5299  memory: 15.15GiB(31.89%)  tps: 7,534  tflops: 58.90  mfu: 18.88%
[rank3]:2025-12-30 16:00:58,073 -  step: 150  loss:  3.8248  grad_norm:  5.5299  memory: 26.98GiB(56.79%)  tps: 7,534  tflops: 58.90  mfu: 18.88%
[rank2]:2025-12-30 16:00:58,061 -  step: 150  loss: -8.0000  grad_norm:  5.5299  memory: 12.26GiB(25.80%)  tps: 7,534  tflops: 58.90  mfu: 18.88%
[rank0]:2025-12-30 16:00:58,039 - Avg. fwd time: 8.1758 / Avg. bwd time: 22.1188 / Avg. batch time: 549.3002 (ms) / GPU bubble ratio: 55.88%
[rank0]:2025-12-30 16:00:58,075 -  step: 150  loss: -8.0000  grad_norm:  5.5299  memory: 17.08GiB(35.95%)  tps: 7,534  tflops: 58.90  mfu: 18.88%
[rank3]:2025-12-30 16:02:38,675 - Avg. fwd time: 10.7468 / Avg. bwd time: 37.2159 / Avg. batch time: 443.2615 (ms) / GPU bubble ratio: 13.44%
[rank2]:2025-12-30 16:02:38,693 - Avg. fwd time: 6.9646 / Avg. bwd time: 18.4236 / Avg. batch time: 472.9412 (ms) / GPU bubble ratio: 57.05%
[rank1]:2025-12-30 16:02:38,712 - Avg. fwd time: 9.0729 / Avg. bwd time: 22.6731 / Avg. batch time: 509.3404 (ms) / GPU bubble ratio: 50.14%
[rank0]:2025-12-30 16:02:38,734 - Avg. fwd time: 8.1903 / Avg. bwd time: 22.0490 / Avg. batch time: 540.1852 (ms) / GPU bubble ratio: 55.22%
[rank1]:2025-12-30 16:04:13,329 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.20/0.20, [MB2] 0.00/0.00, [MB3] 0.48/0.48, [MB4] 0.24/0.24, [MB5] 0.21/0.21, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 16:04:13,339 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-30 16:04:13,324 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank0]:2025-12-30 16:04:13,310 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 16:04:13,340 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.28/0.28, [MB3] 0.14/0.14, [MB4] 0.13/0.13, [MB5] 0.16/0.16, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 16:04:16,982 - Avg. fwd time: 10.7468 / Avg. bwd time: 36.2294 / Avg. batch time: 435.3648 (ms) / GPU bubble ratio: 13.68%
[rank1]:2025-12-30 16:04:17,039 - Avg. fwd time: 9.0771 / Avg. bwd time: 22.4304 / Avg. batch time: 502.2060 (ms) / GPU bubble ratio: 49.81%
[rank1]:2025-12-30 16:04:17,071 -  step: 200  loss: -8.0000  grad_norm:  1.5645  memory: 15.15GiB(31.89%)  tps: 8,233  tflops: 64.36  mfu: 20.63%
[rank3]:2025-12-30 16:04:17,080 -  step: 200  loss:  1.4195  grad_norm:  1.5645  memory: 26.98GiB(56.79%)  tps: 8,233  tflops: 64.36  mfu: 20.63%
[rank2]:2025-12-30 16:04:17,013 - Avg. fwd time: 6.9646 / Avg. bwd time: 18.4481 / Avg. batch time: 465.6826 (ms) / GPU bubble ratio: 56.34%
[rank2]:2025-12-30 16:04:17,067 -  step: 200  loss: -8.0000  grad_norm:  1.5645  memory: 12.26GiB(25.80%)  tps: 8,233  tflops: 64.36  mfu: 20.63%
[rank0]:2025-12-30 16:04:17,045 - Avg. fwd time: 8.1961 / Avg. bwd time: 21.7937 / Avg. batch time: 531.8602 (ms) / GPU bubble ratio: 54.89%
[rank0]:2025-12-30 16:04:17,082 -  step: 200  loss: -8.0000  grad_norm:  1.5645  memory: 17.08GiB(35.95%)  tps: 8,233  tflops: 64.36  mfu: 20.63%
[rank1]:2025-12-30 16:04:17,131 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1604_stage1_step200.svg
[rank2]:2025-12-30 16:04:17,131 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1604_stage2_step200.svg
[rank0]:2025-12-30 16:04:17,132 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1604_stage0_step200.svg
[rank1]:2025-12-30 16:04:17,277 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1604_rank1_stage1.svg
[rank1]:	> Counts Sum: 114560, Total Sum: 374400 (30.60%), Ratio(%) per element: [36.53, 38.46, 39.42, 38.46, 34.61, 40.38, 34.61, 34.61, 30.76, 34.61, 29.8, 32.69, 32.69, 39.42, 35.57, 35.57, 36.53, 31.73, 31.73, 28.84, 34.61, 28.84, 28.84, 31.73, 28.84, 37.5, 25.96, 28.84, 21.15, 18.26, 25.0, 23.07, 25.96, 25.0, 28.84, 23.07, 27.88, 30.76, 26.92, 23.07, 25.0, 30.76, 28.84, 27.88, 23.07]
[rank3]:2025-12-30 16:04:17,222 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1604_step200_rank3.svg
[rank3]:			> Batch Time: 460.96 ms, GPU Bubble Ratio: 52.01%, 48.56%, 55.47%, 34.84%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  308-25-333ms   | [S0,MB2,B]  337-22-360ms   | [S0,MB3,B]  362-24-386ms   | [S0,MB4,B]  388-24-412ms   | [S0,MB5,B]  417-24-441ms   | [S0,MB6,B]  442-5-448ms    | [S0,MB7,B]  457-3-460ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  282-22-305ms   | [S1,MB2,B]  308-25-334ms   | [S1,MB3,B]  337-19-357ms   | [S1,MB4,B]  362-22-384ms   | [S1,MB5,B]  388-24-413ms   | [S1,MB6,B]  416-12-429ms   | [S1,MB7,B]  442-11-454ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  259-19-279ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  337-20-357ms   | [S2,MB5,B]  362-20-382ms   | [S2,MB6,B]  388-19-407ms   | [S2,MB7,B]  416-10-427ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-38-253ms   | [S3,MB2,B]  253-22-275ms   | [S3,MB3,B]  276-22-298ms   | [S3,MB4,B]  298-23-321ms   | [S3,MB5,B]  321-22-344ms   | [S3,MB6,B]  344-22-366ms   | [S3,MB7,B]  366-22-389ms  
[rank3]:2025-12-30 16:04:17,266 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1604_stage3_step200.svg
[rank2]:2025-12-30 16:04:17,280 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1604_rank2_stage2.svg
[rank2]:	> Counts Sum: 45600, Total Sum: 299520 (15.22%), Ratio(%) per element: [18.26, 18.26, 16.34, 15.38, 18.26, 18.26, 18.26, 18.26, 16.34, 20.19, 17.3, 15.38, 15.38, 14.42, 14.42, 17.3, 15.38, 15.38, 15.38, 16.34, 13.46, 17.3, 14.42, 16.34, 14.42, 14.42, 16.34, 10.57, 10.57, 13.46, 12.5, 12.5, 11.53, 12.5, 11.53, 11.53]
[rank0]:2025-12-30 16:04:17,287 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1604_rank0_stage0.svg
[rank0]:	> Counts Sum: 84880, Total Sum: 307840 (27.57%), Ratio(%) per element: [22.11, 37.5, 30.76, 34.61, 33.65, 39.42, 28.84, 36.53, 34.61, 36.53, 30.76, 31.73, 27.88, 38.46, 34.61, 27.88, 33.65, 31.73, 33.65, 25.96, 21.15, 20.19, 22.11, 24.03, 25.0, 22.11, 22.11, 22.11, 24.03, 18.26, 24.03, 22.11, 19.23, 22.11, 17.3, 20.19, 23.07]
[rank3]:2025-12-30 16:04:17,399 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1604_rank3_stage3.svg
[rank3]:	> Counts Sum: 130640, Total Sum: 241280 (54.14%), Ratio(%) per element: [63.46, 61.53, 60.57, 58.65, 65.38, 61.53, 64.42, 61.53, 56.73, 62.5, 54.8, 62.5, 54.8, 58.65, 61.53, 61.53, 59.61, 63.46, 39.42, 43.26, 38.46, 45.19, 46.15, 41.34, 43.26, 48.07, 41.34, 44.23, 46.15]
[rank1]:2025-12-30 16:04:17,608 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1604_stage1.svg
[rank2]:2025-12-30 16:04:17,620 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1604_stage2.svg
[rank0]:2025-12-30 16:04:17,634 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1604_stage0.svg
[rank3]:2025-12-30 16:04:17,743 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1604_stage3.svg
[rank3]:2025-12-30 16:05:51,563 - Avg. fwd time: 10.7441 / Avg. bwd time: 35.1115 / Avg. batch time: 426.3963 (ms) / GPU bubble ratio: 13.97%
[rank1]:2025-12-30 16:05:51,623 - Avg. fwd time: 9.0833 / Avg. bwd time: 22.2042 / Avg. batch time: 495.2188 (ms) / GPU bubble ratio: 49.46%
[rank2]:2025-12-30 16:05:51,597 - Avg. fwd time: 6.9646 / Avg. bwd time: 18.4611 / Avg. batch time: 458.4049 (ms) / GPU bubble ratio: 55.63%
[rank0]:2025-12-30 16:05:51,630 - Avg. fwd time: 8.1996 / Avg. bwd time: 21.3379 / Avg. batch time: 523.0211 (ms) / GPU bubble ratio: 54.82%
[rank2]:2025-12-30 16:07:21,840 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank1]:2025-12-30 16:07:21,844 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.20/0.20, [MB2] 0.00/0.00, [MB3] 0.48/0.48, [MB4] 0.24/0.24, [MB5] 0.21/0.21, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 16:07:21,835 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 16:07:21,852 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 16:07:21,855 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.28/0.28, [MB3] 0.14/0.14, [MB4] 0.13/0.13, [MB5] 0.16/0.16, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 16:07:25,480 - Avg. fwd time: 10.7400 / Avg. bwd time: 34.2046 / Avg. batch time: 419.1050 (ms) / GPU bubble ratio: 14.21%
[rank2]:2025-12-30 16:07:25,512 - Avg. fwd time: 6.9635 / Avg. bwd time: 18.4757 / Avg. batch time: 452.4567 (ms) / GPU bubble ratio: 55.02%
[rank0]:2025-12-30 16:07:25,546 - Avg. fwd time: 8.2022 / Avg. bwd time: 21.0202 / Avg. batch time: 515.8974 (ms) / GPU bubble ratio: 54.68%
[rank1]:2025-12-30 16:07:25,539 - Avg. fwd time: 9.0863 / Avg. bwd time: 22.0242 / Avg. batch time: 489.5787 (ms) / GPU bubble ratio: 49.16%
[rank3]:2025-12-30 16:07:25,581 -  step: 250  loss:  0.4961  grad_norm:  0.5427  memory: 26.98GiB(56.79%)  tps: 8,692  tflops: 67.95  mfu: 21.78%
[rank2]:2025-12-30 16:07:25,568 -  step: 250  loss: -8.0000  grad_norm:  0.5427  memory: 12.26GiB(25.80%)  tps: 8,692  tflops: 67.95  mfu: 21.78%
[rank0]:2025-12-30 16:07:25,582 -  step: 250  loss: -8.0000  grad_norm:  0.5427  memory: 17.08GiB(35.95%)  tps: 8,692  tflops: 67.95  mfu: 21.78%
[rank1]:2025-12-30 16:07:25,571 -  step: 250  loss: -8.0000  grad_norm:  0.5427  memory: 15.15GiB(31.89%)  tps: 8,692  tflops: 67.95  mfu: 21.78%
[rank3]:2025-12-30 16:08:59,462 - Avg. fwd time: 10.7370 / Avg. bwd time: 33.4650 / Avg. batch time: 413.1612 (ms) / GPU bubble ratio: 14.41%
[rank2]:2025-12-30 16:08:59,497 - Avg. fwd time: 6.9621 / Avg. bwd time: 18.4887 / Avg. batch time: 447.5684 (ms) / GPU bubble ratio: 54.51%
[rank1]:2025-12-30 16:08:59,524 - Avg. fwd time: 9.0877 / Avg. bwd time: 21.8627 / Avg. batch time: 484.9722 (ms) / GPU bubble ratio: 48.94%
[rank0]:2025-12-30 16:08:59,531 - Avg. fwd time: 8.2021 / Avg. bwd time: 20.7421 / Avg. batch time: 510.0744 (ms) / GPU bubble ratio: 54.60%
[rank2]:2025-12-30 16:10:30,366 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.03/0.03, [MB7] 1.00/1.00
[rank1]:2025-12-30 16:10:30,371 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.20/0.20, [MB2] 0.00/0.00, [MB3] 0.48/0.48, [MB4] 0.24/0.24, [MB5] 0.21/0.21, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 16:10:30,351 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 16:10:30,381 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.28/0.28, [MB3] 0.14/0.14, [MB4] 0.13/0.13, [MB5] 0.16/0.16, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 16:10:30,378 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-30 16:10:34,099 - Avg. fwd time: 6.9607 / Avg. bwd time: 18.4976 / Avg. batch time: 443.7826 (ms) / GPU bubble ratio: 54.11%
[rank3]:2025-12-30 16:10:34,064 - Avg. fwd time: 10.7328 / Avg. bwd time: 32.8956 / Avg. batch time: 408.5700 (ms) / GPU bubble ratio: 14.57%
[rank1]:2025-12-30 16:10:34,126 - Avg. fwd time: 9.0875 / Avg. bwd time: 21.7220 / Avg. batch time: 481.3713 (ms) / GPU bubble ratio: 48.80%
[rank1]:2025-12-30 16:10:34,159 -  step: 300  loss: -8.0000  grad_norm:  0.2227  memory: 15.15GiB(31.89%)  tps: 8,688  tflops: 67.92  mfu: 21.77%
[rank2]:2025-12-30 16:10:34,155 -  step: 300  loss: -8.0000  grad_norm:  0.2227  memory: 12.26GiB(25.80%)  tps: 8,688  tflops: 67.92  mfu: 21.77%
[rank0]:2025-12-30 16:10:34,133 - Avg. fwd time: 8.2014 / Avg. bwd time: 20.4828 / Avg. batch time: 505.4624 (ms) / GPU bubble ratio: 54.60%
[rank0]:2025-12-30 16:10:34,169 -  step: 300  loss: -8.0000  grad_norm:  0.2227  memory: 17.08GiB(35.95%)  tps: 8,688  tflops: 67.92  mfu: 21.77%
[rank3]:2025-12-30 16:10:34,168 -  step: 300  loss:  0.2974  grad_norm:  0.2227  memory: 26.98GiB(56.79%)  tps: 8,688  tflops: 67.92  mfu: 21.77%
[rank1]:2025-12-30 16:10:34,217 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1610_stage1_step300.svg
[rank2]:2025-12-30 16:10:34,217 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1610_stage2_step300.svg
[rank0]:2025-12-30 16:10:34,217 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1610_stage0_step300.svg
[rank3]:2025-12-30 16:10:34,308 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1610_step300_rank3.svg
[rank3]:			> Batch Time: 455.25 ms, GPU Bubble Ratio: 55.52%, 48.07%, 55.05%, 34.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  309-25-334ms   | [S0,MB2,B]  337-18-355ms   | [S0,MB3,B]  361-20-381ms   | [S0,MB4,B]  387-24-411ms   | [S0,MB5,B]  414-23-438ms   | [S0,MB6,B]  439-0-439ms    | [S0,MB7,B]  455-0-455ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  283-22-305ms   | [S1,MB2,B]  309-25-334ms   | [S1,MB3,B]  337-20-357ms   | [S1,MB4,B]  361-23-384ms   | [S1,MB5,B]  387-23-410ms   | [S1,MB6,B]  414-12-426ms   | [S1,MB7,B]  439-11-451ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  259-19-279ms   | [S2,MB2,B]  285-20-305ms   | [S2,MB3,B]  308-20-329ms   | [S2,MB4,B]  337-20-357ms   | [S2,MB5,B]  361-20-381ms   | [S2,MB6,B]  387-20-407ms   | [S2,MB7,B]  414-9-423ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-167ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  214-39-253ms   | [S3,MB2,B]  253-23-276ms   | [S3,MB3,B]  275-21-297ms   | [S3,MB4,B]  297-22-320ms   | [S3,MB5,B]  320-22-342ms   | [S3,MB6,B]  342-22-365ms   | [S3,MB7,B]  365-22-387ms  
[rank1]:2025-12-30 16:10:34,367 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1610_rank1_stage1.svg
[rank1]:	> Counts Sum: 228160, Total Sum: 662400 (34.44%), Ratio(%) per element: [44.56, 44.56, 45.65, 46.19, 43.47, 46.19, 45.65, 43.47, 42.39, 38.04, 34.78, 35.32, 35.32, 41.84, 38.04, 35.32, 34.78, 35.32, 34.23, 34.23, 34.78, 33.15, 32.06, 34.78, 33.15, 35.32, 31.52, 32.6, 27.71, 24.45, 27.71, 26.63, 30.43, 28.8, 30.97, 28.26, 29.34, 29.89, 27.71, 26.63, 28.8, 30.43, 30.97, 27.71, 26.63]
[rank2]:2025-12-30 16:10:34,369 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1610_rank2_stage2.svg
[rank2]:	> Counts Sum: 75200, Total Sum: 529920 (14.19%), Ratio(%) per element: [16.3, 15.76, 14.67, 14.13, 15.76, 15.76, 15.76, 15.76, 15.76, 16.84, 15.21, 14.67, 14.13, 13.58, 13.58, 15.21, 14.13, 14.67, 14.13, 14.67, 13.04, 15.76, 13.58, 15.21, 13.58, 13.58, 15.21, 11.41, 11.95, 13.04, 12.5, 12.5, 12.5, 12.5, 11.95, 11.95]
[rank0]:2025-12-30 16:10:34,371 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1610_rank0_stage0.svg
[rank0]:	> Counts Sum: 164880, Total Sum: 544640 (30.27%), Ratio(%) per element: [26.63, 38.58, 34.23, 34.78, 33.15, 40.21, 31.52, 37.5, 36.95, 35.86, 36.41, 33.15, 31.52, 36.41, 35.86, 30.97, 32.06, 32.06, 32.6, 30.43, 26.63, 27.71, 25.0, 25.54, 26.63, 27.71, 26.63, 27.17, 27.17, 24.45, 26.08, 25.54, 24.45, 23.91, 21.19, 26.63, 26.63]
[rank3]:2025-12-30 16:10:34,351 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1610_stage3_step300.svg
[rank3]:2025-12-30 16:10:34,483 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1610_rank3_stage3.svg
[rank3]:	> Counts Sum: 279440, Total Sum: 426880 (65.46%), Ratio(%) per element: [72.28, 72.28, 72.28, 70.65, 73.91, 72.82, 73.91, 72.28, 69.02, 67.93, 64.67, 69.56, 65.21, 67.39, 68.47, 70.1, 69.56, 69.02, 54.89, 58.69, 54.89, 58.15, 59.78, 57.06, 57.6, 60.86, 57.06, 57.6, 60.32]
[rank1]:2025-12-30 16:10:34,950 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1610_stage1.svg
[rank2]:2025-12-30 16:10:34,966 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1610_stage2.svg
[rank0]:2025-12-30 16:10:34,959 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1610_stage0.svg
[rank3]:2025-12-30 16:10:35,074 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1610_stage3.svg
[rank0]:2025-12-30 16:12:08,821 - Avg. fwd time: 8.1997 / Avg. bwd time: 20.3034 / Avg. batch time: 501.3251 (ms) / GPU bubble ratio: 54.52%
[rank3]:2025-12-30 16:12:08,749 - Avg. fwd time: 10.7261 / Avg. bwd time: 32.3721 / Avg. batch time: 404.3234 (ms) / GPU bubble ratio: 14.73%
[rank1]:2025-12-30 16:12:08,814 - Avg. fwd time: 9.0875 / Avg. bwd time: 21.6122 / Avg. batch time: 478.0914 (ms) / GPU bubble ratio: 48.63%
[rank2]:2025-12-30 16:12:08,787 - Avg. fwd time: 6.9592 / Avg. bwd time: 18.5028 / Avg. batch time: 440.3894 (ms) / GPU bubble ratio: 53.75%
[rank0]:2025-12-30 16:13:38,814 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 16:13:42,533 - Avg. fwd time: 10.7239 / Avg. bwd time: 31.9206 / Avg. batch time: 400.6929 (ms) / GPU bubble ratio: 14.86%
[rank1]:2025-12-30 16:13:42,592 - Avg. fwd time: 9.0884 / Avg. bwd time: 21.5063 / Avg. batch time: 475.2090 (ms) / GPU bubble ratio: 48.49%
[rank1]:2025-12-30 16:13:42,625 -  step: 350  loss: -8.0000  grad_norm:  0.1073  memory: 15.15GiB(31.89%)  tps: 8,693  tflops: 67.96  mfu: 21.78%
[rank2]:2025-12-30 16:13:42,566 - Avg. fwd time: 6.9586 / Avg. bwd time: 18.5102 / Avg. batch time: 437.4153 (ms) / GPU bubble ratio: 53.42%
[rank2]:2025-12-30 16:13:42,621 -  step: 350  loss: -8.0000  grad_norm:  0.1073  memory: 12.26GiB(25.80%)  tps: 8,693  tflops: 67.96  mfu: 21.78%
[rank0]:2025-12-30 16:13:42,600 - Avg. fwd time: 8.2003 / Avg. bwd time: 20.1447 / Avg. batch time: 497.7113 (ms) / GPU bubble ratio: 54.44%
[rank0]:2025-12-30 16:13:42,636 -  step: 350  loss: -8.0000  grad_norm:  0.1073  memory: 17.08GiB(35.95%)  tps: 8,693  tflops: 67.96  mfu: 21.78%
[rank3]:2025-12-30 16:13:42,635 -  step: 350  loss:  0.2305  grad_norm:  0.1073  memory: 26.98GiB(56.79%)  tps: 8,693  tflops: 67.96  mfu: 21.78%
[rank1]:2025-12-30 16:15:17,156 - Avg. fwd time: 9.0907 / Avg. bwd time: 21.4424 / Avg. batch time: 472.9735 (ms) / GPU bubble ratio: 48.36%
[rank2]:2025-12-30 16:15:17,130 - Avg. fwd time: 6.9582 / Avg. bwd time: 18.5151 / Avg. batch time: 435.2410 (ms) / GPU bubble ratio: 53.18%
[rank3]:2025-12-30 16:15:17,103 - Avg. fwd time: 10.7259 / Avg. bwd time: 31.5879 / Avg. batch time: 398.0511 (ms) / GPU bubble ratio: 14.96%
[rank0]:2025-12-30 16:15:17,164 - Avg. fwd time: 8.2008 / Avg. bwd time: 19.9564 / Avg. batch time: 494.8401 (ms) / GPU bubble ratio: 54.48%
[rank0]:2025-12-30 16:16:47,402 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 16:16:51,100 - Avg. fwd time: 6.9577 / Avg. bwd time: 18.5169 / Avg. batch time: 433.0088 (ms) / GPU bubble ratio: 52.93%
[rank3]:2025-12-30 16:16:51,066 - Avg. fwd time: 10.7268 / Avg. bwd time: 31.2462 / Avg. batch time: 395.3286 (ms) / GPU bubble ratio: 15.06%
[rank0]:2025-12-30 16:16:51,135 - Avg. fwd time: 8.2018 / Avg. bwd time: 19.8001 / Avg. batch time: 492.1485 (ms) / GPU bubble ratio: 54.48%
[rank0]:2025-12-30 16:16:51,171 -  step: 400  loss: -8.0000  grad_norm:  0.1102  memory: 17.08GiB(35.95%)  tps: 8,690  tflops: 67.94  mfu: 21.77%
[rank1]:2025-12-30 16:16:51,127 - Avg. fwd time: 9.0925 / Avg. bwd time: 21.3725 / Avg. batch time: 470.8379 (ms) / GPU bubble ratio: 48.24%
[rank1]:2025-12-30 16:16:51,161 -  step: 400  loss: -8.0000  grad_norm:  0.1102  memory: 15.15GiB(31.89%)  tps: 8,690  tflops: 67.94  mfu: 21.77%
[rank2]:2025-12-30 16:16:51,157 -  step: 400  loss: -8.0000  grad_norm:  0.1102  memory: 12.26GiB(25.80%)  tps: 8,690  tflops: 67.94  mfu: 21.77%
[rank3]:2025-12-30 16:16:51,169 -  step: 400  loss:  0.2138  grad_norm:  0.1102  memory: 26.98GiB(56.79%)  tps: 8,690  tflops: 67.94  mfu: 21.77%
[rank1]:2025-12-30 16:16:51,225 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1616_stage1_step400.svg
[rank0]:2025-12-30 16:16:51,223 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1616_stage0_step400.svg
[rank2]:2025-12-30 16:16:51,224 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1616_stage2_step400.svg
[rank1]:2025-12-30 16:16:51,375 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1616_rank1_stage1.svg
[rank0]:2025-12-30 16:16:51,376 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1616_rank0_stage0.svg
[rank1]:	> Counts Sum: 341760, Total Sum: 950400 (35.96%), Ratio(%) per element: [44.31, 44.31, 46.96, 46.59, 42.8, 44.31, 45.83, 43.93, 42.8, 39.39, 37.87, 37.87, 39.39, 42.8, 40.15, 38.63, 37.87, 37.5, 35.22, 36.36, 37.12, 37.12, 35.98, 37.12, 34.84, 37.87, 32.19, 33.71, 29.54, 27.65, 29.16, 30.68, 30.68, 30.68, 31.81, 29.54, 30.68, 30.68, 29.16, 27.27, 30.3, 30.68, 32.19, 27.65, 28.78]
[rank0]:	> Counts Sum: 244880, Total Sum: 781440 (31.34%), Ratio(%) per element: [28.03, 40.15, 34.46, 35.22, 33.33, 42.42, 33.33, 38.25, 35.6, 35.98, 37.12, 32.95, 31.43, 34.84, 36.74, 30.68, 32.95, 32.57, 33.71, 32.19, 27.65, 28.03, 28.03, 26.13, 28.03, 29.16, 27.27, 28.78, 29.54, 26.51, 29.16, 28.03, 25.75, 25.75, 23.86, 28.4, 27.27]
[rank2]:2025-12-30 16:16:51,380 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1616_rank2_stage2.svg
[rank2]:	> Counts Sum: 104800, Total Sum: 760320 (13.78%), Ratio(%) per element: [15.53, 14.77, 14.39, 14.01, 14.77, 14.77, 14.77, 14.77, 14.77, 15.53, 15.15, 14.01, 13.63, 13.25, 13.25, 14.39, 14.01, 14.01, 14.01, 14.01, 12.87, 14.77, 13.25, 14.77, 13.25, 13.25, 14.39, 11.74, 12.5, 12.87, 12.5, 12.5, 12.5, 12.87, 12.12, 12.12]
[rank3]:2025-12-30 16:16:51,321 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1616_step400_rank3.svg
[rank3]:			> Batch Time: 451.75 ms, GPU Bubble Ratio: 56.03%, 48.73%, 54.68%, 33.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  273-25-298ms   | [S0,MB1,B]  308-25-333ms   | [S0,MB2,B]  337-16-354ms   | [S0,MB3,B]  358-18-377ms   | [S0,MB4,B]  385-23-409ms   | [S0,MB5,B]  411-22-434ms   | [S0,MB6,B]  436-0-436ms    | [S0,MB7,B]  451-0-451ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  283-21-305ms   | [S1,MB2,B]  308-25-334ms   | [S1,MB3,B]  337-18-355ms   | [S1,MB4,B]  360-21-382ms   | [S1,MB5,B]  385-22-408ms   | [S1,MB6,B]  411-12-423ms   | [S1,MB7,B]  436-11-447ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  222-19-241ms   | [S2,MB1,B]  260-19-279ms   | [S2,MB2,B]  285-20-305ms   | [S2,MB3,B]  308-20-329ms   | [S2,MB4,B]  337-20-357ms   | [S2,MB5,B]  360-20-380ms   | [S2,MB6,B]  385-20-405ms   | [S2,MB7,B]  411-9-420ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-38-254ms   | [S3,MB2,B]  253-24-277ms   | [S3,MB3,B]  276-22-298ms   | [S3,MB4,B]  298-22-320ms   | [S3,MB5,B]  320-22-343ms   | [S3,MB6,B]  343-22-366ms   | [S3,MB7,B]  366-22-388ms  
[rank3]:2025-12-30 16:16:51,368 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1616_stage3_step400.svg
[rank3]:2025-12-30 16:16:51,497 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1616_rank3_stage3.svg
[rank3]:	> Counts Sum: 428240, Total Sum: 612480 (69.92%), Ratio(%) per element: [76.13, 76.13, 74.62, 74.62, 77.27, 75.75, 75.75, 75.0, 73.86, 72.72, 68.56, 72.34, 69.69, 71.59, 71.59, 73.48, 72.72, 71.21, 61.36, 64.01, 62.5, 63.63, 65.15, 63.63, 64.01, 65.9, 64.39, 64.01, 65.9]
[rank1]:2025-12-30 16:16:52,218 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1616_stage1.svg
[rank0]:2025-12-30 16:16:52,226 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1616_stage0.svg
[rank2]:2025-12-30 16:16:52,247 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1616_stage2.svg
[rank3]:2025-12-30 16:16:52,338 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1616_stage3.svg
[rank3]:2025-12-30 16:17:13,366 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 16:17:13,570 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 16:17:13,584 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 16:17:13,586 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 16:18:24,873 - Avg. fwd time: 6.9573 / Avg. bwd time: 18.5200 / Avg. batch time: 430.6969 (ms) / GPU bubble ratio: 52.68%
[rank1]:2025-12-30 16:18:24,900 - Avg. fwd time: 9.0933 / Avg. bwd time: 21.2927 / Avg. batch time: 468.6307 (ms) / GPU bubble ratio: 48.13%
[rank0]:2025-12-30 16:18:24,910 - Avg. fwd time: 8.2014 / Avg. bwd time: 19.7040 / Avg. batch time: 489.4496 (ms) / GPU bubble ratio: 54.39%
[rank3]:2025-12-30 16:18:24,839 - Avg. fwd time: 10.7249 / Avg. bwd time: 30.8874 / Avg. batch time: 392.4428 (ms) / GPU bubble ratio: 15.17%
[rank0]:2025-12-30 16:19:55,423 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 16:19:59,047 - Avg. fwd time: 10.7211 / Avg. bwd time: 30.6249 / Avg. batch time: 390.3107 (ms) / GPU bubble ratio: 15.26%
[rank3]:2025-12-30 16:19:59,153 -  step: 450  loss:  0.2252  grad_norm:  0.1004  memory: 26.98GiB(56.79%)  tps: 8,716  tflops: 68.14  mfu: 21.84%
[rank1]:2025-12-30 16:19:59,109 - Avg. fwd time: 9.0926 / Avg. bwd time: 21.2464 / Avg. batch time: 467.0637 (ms) / GPU bubble ratio: 48.03%
[rank1]:2025-12-30 16:19:59,144 -  step: 450  loss: -8.0000  grad_norm:  0.1004  memory: 15.15GiB(31.89%)  tps: 8,716  tflops: 68.14  mfu: 21.84%
[rank2]:2025-12-30 16:19:59,083 - Avg. fwd time: 6.9562 / Avg. bwd time: 18.5194 / Avg. batch time: 429.0497 (ms) / GPU bubble ratio: 52.50%
[rank2]:2025-12-30 16:19:59,140 -  step: 450  loss: -8.0000  grad_norm:  0.1004  memory: 12.26GiB(25.80%)  tps: 8,716  tflops: 68.14  mfu: 21.84%
[rank0]:2025-12-30 16:19:59,118 - Avg. fwd time: 8.2004 / Avg. bwd time: 19.6122 / Avg. batch time: 487.4460 (ms) / GPU bubble ratio: 54.35%
[rank0]:2025-12-30 16:19:59,155 -  step: 450  loss: -8.0000  grad_norm:  0.1004  memory: 17.08GiB(35.95%)  tps: 8,716  tflops: 68.14  mfu: 21.84%
[rank3]:2025-12-30 16:21:32,744 - Avg. fwd time: 10.7164 / Avg. bwd time: 30.3801 / Avg. batch time: 388.3120 (ms) / GPU bubble ratio: 15.33%
[rank2]:2025-12-30 16:21:32,782 - Avg. fwd time: 6.9551 / Avg. bwd time: 18.5185 / Avg. batch time: 427.4199 (ms) / GPU bubble ratio: 52.32%
[rank1]:2025-12-30 16:21:32,809 - Avg. fwd time: 9.0914 / Avg. bwd time: 21.1936 / Avg. batch time: 465.5122 (ms) / GPU bubble ratio: 47.95%
[rank0]:2025-12-30 16:21:32,818 - Avg. fwd time: 8.1983 / Avg. bwd time: 19.5174 / Avg. batch time: 485.5015 (ms) / GPU bubble ratio: 54.33%
[rank0]:2025-12-30 16:23:03,382 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 16:23:07,070 - Avg. fwd time: 10.7132 / Avg. bwd time: 30.1848 / Avg. batch time: 386.7222 (ms) / GPU bubble ratio: 15.40%
[rank2]:2025-12-30 16:23:07,106 - Avg. fwd time: 6.9542 / Avg. bwd time: 18.5133 / Avg. batch time: 426.1518 (ms) / GPU bubble ratio: 52.19%
[rank1]:2025-12-30 16:23:07,131 - Avg. fwd time: 9.0901 / Avg. bwd time: 21.1452 / Avg. batch time: 464.2737 (ms) / GPU bubble ratio: 47.90%
[rank1]:2025-12-30 16:23:07,166 -  step: 500  loss: -8.0000  grad_norm:  0.1076  memory: 15.15GiB(31.89%)  tps: 8,714  tflops: 68.12  mfu: 21.83%
[rank0]:2025-12-30 16:23:07,141 - Avg. fwd time: 8.1965 / Avg. bwd time: 19.4385 / Avg. batch time: 483.9096 (ms) / GPU bubble ratio: 54.31%
[rank0]:2025-12-30 16:23:07,177 -  step: 500  loss: -8.0000  grad_norm:  0.1076  memory: 17.08GiB(35.95%)  tps: 8,714  tflops: 68.12  mfu: 21.83%
[rank3]:2025-12-30 16:23:07,175 -  step: 500  loss:  0.2173  grad_norm:  0.1076  memory: 26.98GiB(56.79%)  tps: 8,714  tflops: 68.12  mfu: 21.83%
[rank2]:2025-12-30 16:23:07,163 -  step: 500  loss: -8.0000  grad_norm:  0.1076  memory: 12.26GiB(25.80%)  tps: 8,714  tflops: 68.12  mfu: 21.83%
[rank1]:2025-12-30 16:23:07,225 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1623_stage1_step500.svg
[rank0]:2025-12-30 16:23:07,224 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1623_stage0_step500.svg
[rank2]:2025-12-30 16:23:07,225 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1623_stage2_step500.svg
[rank1]:2025-12-30 16:23:07,369 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1623_rank1_stage1.svg
[rank1]:	> Counts Sum: 455360, Total Sum: 1238400 (36.77%), Ratio(%) per element: [47.67, 47.09, 49.12, 48.54, 46.51, 47.67, 48.54, 47.38, 45.05, 39.53, 39.53, 39.53, 40.69, 43.31, 40.4, 40.4, 40.11, 38.95, 35.46, 35.46, 35.17, 35.75, 34.3, 35.75, 34.88, 36.33, 32.84, 33.13, 29.65, 29.36, 28.77, 31.1, 30.81, 30.81, 31.39, 30.81, 30.81, 30.81, 29.36, 28.77, 30.81, 31.1, 32.84, 28.48, 29.65]
[rank0]:2025-12-30 16:23:07,376 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1623_rank0_stage0.svg
[rank0]:	> Counts Sum: 324880, Total Sum: 1018240 (31.91%), Ratio(%) per element: [27.61, 40.11, 36.91, 36.04, 34.3, 42.44, 34.88, 37.5, 36.33, 34.88, 35.75, 34.01, 31.1, 34.59, 35.46, 31.68, 34.01, 32.26, 33.43, 31.68, 28.48, 28.48, 29.06, 27.32, 29.36, 29.65, 29.06, 30.23, 29.06, 28.48, 29.36, 29.65, 27.32, 27.32, 25.29, 29.06, 28.19]
[rank3]:2025-12-30 16:23:07,313 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1623_step500_rank3.svg
[rank3]:			> Batch Time: 452.75 ms, GPU Bubble Ratio: 53.87%, 48.24%, 55.12%, 34.49%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  271-25-297ms   | [S0,MB1,B]  306-25-331ms   | [S0,MB2,B]  336-22-358ms   | [S0,MB3,B]  360-23-384ms   | [S0,MB4,B]  386-24-411ms   | [S0,MB5,B]  414-22-436ms   | [S0,MB6,B]  438-0-438ms    | [S0,MB7,B]  452-0-452ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  281-20-301ms   | [S1,MB2,B]  307-25-332ms   | [S1,MB3,B]  336-20-356ms   | [S1,MB4,B]  360-23-384ms   | [S1,MB5,B]  386-22-409ms   | [S1,MB6,B]  414-12-426ms   | [S1,MB7,B]  437-11-449ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  283-19-303ms   | [S2,MB3,B]  307-20-327ms   | [S2,MB4,B]  335-20-356ms   | [S2,MB5,B]  360-20-380ms   | [S2,MB6,B]  386-19-405ms   | [S2,MB7,B]  413-8-422ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-38-252ms   | [S3,MB2,B]  251-22-274ms   | [S3,MB3,B]  274-21-296ms   | [S3,MB4,B]  296-22-318ms   | [S3,MB5,B]  318-22-340ms   | [S3,MB6,B]  340-22-363ms   | [S3,MB7,B]  363-22-385ms  
[rank3]:2025-12-30 16:23:07,358 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1623_stage3_step500.svg
[rank2]:2025-12-30 16:23:07,374 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1623_rank2_stage2.svg
[rank2]:	> Counts Sum: 134400, Total Sum: 990720 (13.57%), Ratio(%) per element: [14.82, 14.24, 14.24, 13.95, 14.53, 14.24, 14.24, 14.24, 14.53, 14.82, 14.53, 13.66, 13.37, 13.08, 13.08, 14.24, 13.66, 13.66, 14.53, 13.66, 12.79, 14.53, 13.37, 14.24, 13.08, 13.08, 13.95, 11.91, 12.5, 12.79, 12.5, 12.5, 12.5, 12.79, 12.2, 12.2]
[rank3]:2025-12-30 16:23:07,489 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1623_rank3_stage3.svg
[rank3]:	> Counts Sum: 577040, Total Sum: 798080 (72.30%), Ratio(%) per element: [77.32, 76.74, 75.87, 76.16, 78.77, 77.03, 76.74, 76.45, 75.87, 73.54, 71.51, 74.12, 71.8, 73.54, 73.54, 75.0, 74.7, 73.83, 65.4, 67.15, 66.86, 66.86, 68.6, 68.02, 67.44, 69.76, 67.44, 67.44, 69.18]
[rank1]:2025-12-30 16:23:08,444 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1623_stage1.svg
[rank0]:2025-12-30 16:23:08,468 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1623_stage0.svg
[rank2]:2025-12-30 16:23:08,472 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1623_stage2.svg
[rank3]:2025-12-30 16:23:08,575 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1623_stage3.svg
[rank2]:2025-12-30 16:24:42,714 - Avg. fwd time: 6.9537 / Avg. bwd time: 18.5114 / Avg. batch time: 425.0093 (ms) / GPU bubble ratio: 52.07%
[rank3]:2025-12-30 16:24:42,677 - Avg. fwd time: 10.7106 / Avg. bwd time: 29.9989 / Avg. batch time: 385.2115 (ms) / GPU bubble ratio: 15.46%
[rank1]:2025-12-30 16:24:42,741 - Avg. fwd time: 9.0900 / Avg. bwd time: 21.1178 / Avg. batch time: 463.1699 (ms) / GPU bubble ratio: 47.82%
[rank0]:2025-12-30 16:24:42,751 - Avg. fwd time: 8.1957 / Avg. bwd time: 19.3640 / Avg. batch time: 482.4862 (ms) / GPU bubble ratio: 54.30%
[rank0]:2025-12-30 16:26:13,267 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-30 16:26:16,956 - Avg. fwd time: 9.0898 / Avg. bwd time: 21.0716 / Avg. batch time: 462.1204 (ms) / GPU bubble ratio: 47.79%
[rank2]:2025-12-30 16:26:16,931 - Avg. fwd time: 6.9535 / Avg. bwd time: 18.5102 / Avg. batch time: 423.8903 (ms) / GPU bubble ratio: 51.94%
[rank3]:2025-12-30 16:26:16,898 - Avg. fwd time: 10.7091 / Avg. bwd time: 29.8355 / Avg. batch time: 383.8924 (ms) / GPU bubble ratio: 15.51%
[rank0]:2025-12-30 16:26:16,966 - Avg. fwd time: 8.1949 / Avg. bwd time: 19.2787 / Avg. batch time: 481.1477 (ms) / GPU bubble ratio: 54.32%
[rank0]:2025-12-30 16:26:17,003 -  step: 550  loss: -8.0000  grad_norm:  0.0889  memory: 17.08GiB(35.95%)  tps: 8,631  tflops: 67.47  mfu: 21.63%
[rank1]:2025-12-30 16:26:16,992 -  step: 550  loss: -8.0000  grad_norm:  0.0889  memory: 15.15GiB(31.89%)  tps: 8,631  tflops: 67.47  mfu: 21.63%
[rank2]:2025-12-30 16:26:16,988 -  step: 550  loss: -8.0000  grad_norm:  0.0889  memory: 12.26GiB(25.80%)  tps: 8,631  tflops: 67.47  mfu: 21.63%
[rank3]:2025-12-30 16:26:17,001 -  step: 550  loss:  0.2228  grad_norm:  0.0889  memory: 26.98GiB(56.79%)  tps: 8,631  tflops: 67.47  mfu: 21.63%
[rank3]:2025-12-30 16:27:50,721 - Avg. fwd time: 10.7088 / Avg. bwd time: 29.6744 / Avg. batch time: 382.6003 (ms) / GPU bubble ratio: 15.56%
[rank2]:2025-12-30 16:27:50,759 - Avg. fwd time: 6.9535 / Avg. bwd time: 18.5093 / Avg. batch time: 422.7783 (ms) / GPU bubble ratio: 51.82%
[rank1]:2025-12-30 16:27:50,786 - Avg. fwd time: 9.0899 / Avg. bwd time: 21.0199 / Avg. batch time: 461.0730 (ms) / GPU bubble ratio: 47.76%
[rank0]:2025-12-30 16:27:50,796 - Avg. fwd time: 8.1949 / Avg. bwd time: 19.2194 / Avg. batch time: 479.8366 (ms) / GPU bubble ratio: 54.29%
[rank0]:2025-12-30 16:29:21,587 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 16:29:25,319 - Avg. fwd time: 10.7092 / Avg. bwd time: 29.5498 / Avg. batch time: 381.6065 (ms) / GPU bubble ratio: 15.60%
[rank2]:2025-12-30 16:29:25,356 - Avg. fwd time: 6.9535 / Avg. bwd time: 18.5070 / Avg. batch time: 421.9616 (ms) / GPU bubble ratio: 51.73%
[rank1]:2025-12-30 16:29:25,388 - Avg. fwd time: 9.0902 / Avg. bwd time: 20.9904 / Avg. batch time: 460.2838 (ms) / GPU bubble ratio: 47.72%
[rank0]:2025-12-30 16:29:25,400 - Avg. fwd time: 8.1948 / Avg. bwd time: 19.1491 / Avg. batch time: 478.8068 (ms) / GPU bubble ratio: 54.31%
[rank3]:2025-12-30 16:29:25,434 -  step: 600  loss:  0.2208  grad_norm:  0.1071  memory: 26.98GiB(56.79%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank2]:2025-12-30 16:29:25,422 -  step: 600  loss: -8.0000  grad_norm:  0.1071  memory: 12.26GiB(25.80%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank2]:2025-12-30 16:29:25,486 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1629_stage2_step600.svg
[rank0]:2025-12-30 16:29:25,436 -  step: 600  loss: -8.0000  grad_norm:  0.1071  memory: 17.08GiB(35.95%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank1]:2025-12-30 16:29:25,425 -  step: 600  loss: -8.0000  grad_norm:  0.1071  memory: 15.15GiB(31.89%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank0]:2025-12-30 16:29:25,486 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1629_stage0_step600.svg
[rank1]:2025-12-30 16:29:25,486 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1629_stage1_step600.svg
[rank3]:2025-12-30 16:29:25,575 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1629_step600_rank3.svg
[rank3]:			> Batch Time: 455.25 ms, GPU Bubble Ratio: 54.22%, 48.22%, 55.19%, 34.10%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  309-25-335ms   | [S0,MB2,B]  338-20-359ms   | [S0,MB3,B]  362-24-386ms   | [S0,MB4,B]  388-24-412ms   | [S0,MB5,B]  415-23-438ms   | [S0,MB6,B]  440-0-440ms    | [S0,MB7,B]  455-0-455ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-24-269ms   | [S1,MB1,B]  284-22-306ms   | [S1,MB2,B]  309-25-335ms   | [S1,MB3,B]  338-20-358ms   | [S1,MB4,B]  362-21-384ms   | [S1,MB5,B]  388-24-412ms   | [S1,MB6,B]  415-12-428ms   | [S1,MB7,B]  440-11-452ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  261-19-280ms   | [S2,MB2,B]  286-19-306ms   | [S2,MB3,B]  309-20-329ms   | [S2,MB4,B]  338-20-358ms   | [S2,MB5,B]  362-20-382ms   | [S2,MB6,B]  387-20-408ms   | [S2,MB7,B]  415-8-424ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-39-254ms   | [S3,MB2,B]  254-22-277ms   | [S3,MB3,B]  276-21-298ms   | [S3,MB4,B]  298-22-321ms   | [S3,MB5,B]  321-22-343ms   | [S3,MB6,B]  343-22-366ms   | [S3,MB7,B]  366-22-388ms  
[rank3]:2025-12-30 16:29:25,620 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1629_stage3_step600.svg
[rank2]:2025-12-30 16:29:25,647 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1629_rank2_stage2.svg
[rank2]:	> Counts Sum: 164000, Total Sum: 1221120 (13.43%), Ratio(%) per element: [14.38, 14.15, 13.91, 13.67, 14.38, 14.15, 13.91, 13.91, 14.15, 14.38, 14.15, 13.44, 13.2, 12.97, 12.97, 13.91, 13.44, 13.67, 14.38, 13.67, 12.73, 14.15, 13.2, 14.15, 12.97, 12.97, 13.67, 12.26, 12.73, 12.73, 12.73, 12.5, 12.5, 12.73, 12.26, 12.26]
[rank1]:2025-12-30 16:29:25,641 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1629_rank1_stage1.svg
[rank1]:	> Counts Sum: 568960, Total Sum: 1526400 (37.27%), Ratio(%) per element: [48.82, 46.93, 49.52, 49.05, 45.99, 47.87, 48.11, 48.11, 46.22, 39.85, 39.38, 41.03, 41.03, 44.1, 41.5, 41.74, 40.33, 40.09, 36.32, 35.37, 36.55, 35.61, 36.08, 36.08, 35.14, 36.55, 33.72, 33.01, 29.95, 29.71, 29.0, 31.6, 31.36, 31.6, 31.6, 30.89, 31.13, 31.13, 30.89, 28.77, 30.89, 32.07, 33.25, 29.0, 30.18]
[rank0]:2025-12-30 16:29:25,644 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1629_rank0_stage0.svg
[rank0]:	> Counts Sum: 404880, Total Sum: 1255040 (32.26%), Ratio(%) per element: [28.06, 39.62, 36.08, 36.32, 34.43, 41.74, 35.37, 37.73, 35.37, 34.19, 36.32, 33.49, 31.13, 34.66, 36.08, 31.6, 34.43, 32.31, 33.72, 31.6, 29.24, 29.0, 30.42, 28.77, 30.66, 31.13, 29.71, 31.36, 29.95, 29.0, 29.48, 29.24, 28.77, 27.35, 25.7, 30.18, 29.24]
[rank3]:2025-12-30 16:29:25,756 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1629_rank3_stage3.svg
[rank3]:	> Counts Sum: 725840, Total Sum: 983680 (73.79%), Ratio(%) per element: [78.3, 78.06, 77.12, 77.59, 79.95, 78.53, 78.06, 78.06, 77.35, 74.52, 73.34, 75.23, 73.58, 74.52, 74.52, 75.7, 75.7, 74.52, 67.92, 69.33, 68.39, 69.1, 70.51, 70.04, 69.33, 70.99, 69.33, 69.57, 70.51]
[rank1]:2025-12-30 16:29:26,996 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1629_stage1.svg
[rank2]:2025-12-30 16:29:27,025 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1629_stage2.svg
[rank0]:2025-12-30 16:29:27,021 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1629_stage0.svg
[rank3]:2025-12-30 16:29:27,123 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1629_stage3.svg
[rank3]:2025-12-30 16:31:01,791 - Avg. fwd time: 10.7104 / Avg. bwd time: 29.4409 / Avg. batch time: 380.7479 (ms) / GPU bubble ratio: 15.64%
[rank2]:2025-12-30 16:31:01,829 - Avg. fwd time: 6.9535 / Avg. bwd time: 18.5064 / Avg. batch time: 421.2775 (ms) / GPU bubble ratio: 51.65%
[rank1]:2025-12-30 16:31:01,854 - Avg. fwd time: 9.0906 / Avg. bwd time: 20.9621 / Avg. batch time: 459.6200 (ms) / GPU bubble ratio: 47.69%
[rank0]:2025-12-30 16:31:01,865 - Avg. fwd time: 8.1946 / Avg. bwd time: 19.0915 / Avg. batch time: 477.9206 (ms) / GPU bubble ratio: 54.33%
[rank0]:2025-12-30 16:32:31,715 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 16:32:35,365 - Avg. fwd time: 10.7117 / Avg. bwd time: 29.2892 / Avg. batch time: 379.5462 (ms) / GPU bubble ratio: 15.69%
[rank1]:2025-12-30 16:32:35,420 - Avg. fwd time: 9.0911 / Avg. bwd time: 20.9468 / Avg. batch time: 458.7460 (ms) / GPU bubble ratio: 47.62%
[rank1]:2025-12-30 16:32:35,457 -  step: 650  loss: -8.0000  grad_norm:  0.0949  memory: 15.15GiB(31.89%)  tps: 8,622  tflops: 67.40  mfu: 21.60%
[rank2]:2025-12-30 16:32:35,397 - Avg. fwd time: 6.9536 / Avg. bwd time: 18.5061 / Avg. batch time: 420.3577 (ms) / GPU bubble ratio: 51.55%
[rank2]:2025-12-30 16:32:35,453 -  step: 650  loss: -8.0000  grad_norm:  0.0949  memory: 12.26GiB(25.80%)  tps: 8,622  tflops: 67.40  mfu: 21.60%
[rank0]:2025-12-30 16:32:35,432 - Avg. fwd time: 8.1950 / Avg. bwd time: 19.0342 / Avg. batch time: 476.8407 (ms) / GPU bubble ratio: 54.32%
[rank3]:2025-12-30 16:32:35,466 -  step: 650  loss:  0.2306  grad_norm:  0.0949  memory: 26.98GiB(56.79%)  tps: 8,622  tflops: 67.40  mfu: 21.60%
[rank0]:2025-12-30 16:32:35,468 -  step: 650  loss: -8.0000  grad_norm:  0.0949  memory: 17.08GiB(35.95%)  tps: 8,622  tflops: 67.40  mfu: 21.60%
[rank3]:2025-12-30 16:34:08,966 - Avg. fwd time: 10.7134 / Avg. bwd time: 29.1816 / Avg. batch time: 378.7011 (ms) / GPU bubble ratio: 15.72%
[rank1]:2025-12-30 16:34:09,028 - Avg. fwd time: 9.0923 / Avg. bwd time: 20.9216 / Avg. batch time: 457.9377 (ms) / GPU bubble ratio: 47.57%
[rank2]:2025-12-30 16:34:09,001 - Avg. fwd time: 6.9537 / Avg. bwd time: 18.5046 / Avg. batch time: 419.6637 (ms) / GPU bubble ratio: 51.47%
[rank0]:2025-12-30 16:34:09,040 - Avg. fwd time: 8.1963 / Avg. bwd time: 18.9711 / Avg. batch time: 475.8440 (ms) / GPU bubble ratio: 54.33%
[rank0]:2025-12-30 16:35:39,232 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 16:35:42,960 - Avg. fwd time: 10.7151 / Avg. bwd time: 29.0890 / Avg. batch time: 377.9764 (ms) / GPU bubble ratio: 15.75%
[rank2]:2025-12-30 16:35:42,995 - Avg. fwd time: 6.9538 / Avg. bwd time: 18.5045 / Avg. batch time: 419.0260 (ms) / GPU bubble ratio: 51.40%
[rank3]:2025-12-30 16:35:43,067 -  step: 700  loss:  0.1895  grad_norm:  0.0817  memory: 26.98GiB(56.79%)  tps: 8,734  tflops: 68.27  mfu: 21.88%
[rank1]:2025-12-30 16:35:43,021 - Avg. fwd time: 9.0931 / Avg. bwd time: 20.8955 / Avg. batch time: 457.2555 (ms) / GPU bubble ratio: 47.53%
[rank1]:2025-12-30 16:35:43,058 -  step: 700  loss: -8.0000  grad_norm:  0.0817  memory: 15.15GiB(31.89%)  tps: 8,733  tflops: 68.27  mfu: 21.88%
[rank2]:2025-12-30 16:35:43,055 -  step: 700  loss: -8.0000  grad_norm:  0.0817  memory: 12.26GiB(25.80%)  tps: 8,733  tflops: 68.27  mfu: 21.88%
[rank0]:2025-12-30 16:35:43,033 - Avg. fwd time: 8.1970 / Avg. bwd time: 18.9049 / Avg. batch time: 474.9867 (ms) / GPU bubble ratio: 54.35%
[rank0]:2025-12-30 16:35:43,069 -  step: 700  loss: -8.0000  grad_norm:  0.0817  memory: 17.08GiB(35.95%)  tps: 8,733  tflops: 68.27  mfu: 21.88%
[rank1]:2025-12-30 16:35:43,120 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1635_stage1_step700.svg
[rank2]:2025-12-30 16:35:43,121 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1635_stage2_step700.svg
[rank0]:2025-12-30 16:35:43,120 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1635_stage0_step700.svg
[rank3]:2025-12-30 16:35:43,206 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1635_step700_rank3.svg
[rank3]:			> Batch Time: 454.00 ms, GPU Bubble Ratio: 54.47%, 48.54%, 55.12%, 33.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  273-25-298ms   | [S0,MB1,B]  309-25-334ms   | [S0,MB2,B]  338-17-356ms   | [S0,MB3,B]  361-24-385ms   | [S0,MB4,B]  387-24-412ms   | [S0,MB5,B]  414-23-437ms   | [S0,MB6,B]  439-0-439ms    | [S0,MB7,B]  454-0-454ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  245-25-270ms   | [S1,MB1,B]  284-22-306ms   | [S1,MB2,B]  309-25-335ms   | [S1,MB3,B]  338-19-357ms   | [S1,MB4,B]  362-22-384ms   | [S1,MB5,B]  387-22-409ms   | [S1,MB6,B]  414-12-426ms   | [S1,MB7,B]  438-11-450ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  222-19-242ms   | [S2,MB1,B]  260-19-280ms   | [S2,MB2,B]  286-19-306ms   | [S2,MB3,B]  310-20-330ms   | [S2,MB4,B]  338-20-358ms   | [S2,MB5,B]  361-20-382ms   | [S2,MB6,B]  387-19-406ms   | [S2,MB7,B]  413-8-422ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  175-40-215ms   | [S3,MB1,B]  215-39-254ms   | [S3,MB2,B]  254-23-278ms   | [S3,MB3,B]  277-21-299ms   | [S3,MB4,B]  299-22-321ms   | [S3,MB5,B]  321-22-344ms   | [S3,MB6,B]  344-22-366ms   | [S3,MB7,B]  366-22-388ms  
[rank3]:2025-12-30 16:35:43,252 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1635_stage3_step700.svg
[rank1]:2025-12-30 16:35:43,266 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1635_rank1_stage1.svg
[rank1]:	> Counts Sum: 682560, Total Sum: 1814400 (37.62%), Ratio(%) per element: [49.2, 46.82, 48.61, 48.8, 46.62, 48.8, 48.61, 48.8, 46.82, 41.46, 40.27, 41.86, 41.46, 43.84, 41.86, 42.85, 40.47, 40.67, 36.3, 35.71, 37.1, 35.11, 35.51, 35.91, 35.11, 36.3, 33.92, 32.73, 29.76, 29.96, 29.76, 31.74, 30.95, 32.73, 31.54, 31.94, 31.74, 31.34, 31.94, 29.76, 31.34, 31.94, 33.33, 30.15, 31.15]
[rank2]:2025-12-30 16:35:43,271 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1635_rank2_stage2.svg
[rank2]:	> Counts Sum: 193600, Total Sum: 1451520 (13.34%), Ratio(%) per element: [14.28, 14.08, 13.69, 13.49, 14.08, 14.28, 14.08, 13.69, 13.88, 14.08, 13.88, 13.29, 13.09, 12.89, 12.89, 13.88, 13.29, 13.49, 14.08, 13.69, 12.69, 13.88, 13.09, 13.88, 12.89, 12.89, 13.49, 12.3, 12.89, 12.69, 12.69, 12.5, 12.5, 12.69, 12.3, 12.5]
[rank0]:2025-12-30 16:35:43,273 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1635_rank0_stage0.svg
[rank0]:	> Counts Sum: 484880, Total Sum: 1491840 (32.50%), Ratio(%) per element: [29.56, 39.08, 36.5, 36.7, 34.72, 40.67, 36.7, 37.89, 34.72, 34.92, 35.71, 33.73, 31.15, 35.11, 35.11, 31.94, 34.72, 32.53, 33.92, 31.74, 30.15, 29.16, 30.75, 29.36, 30.75, 30.75, 29.76, 31.74, 30.35, 29.16, 29.96, 29.16, 28.76, 27.97, 27.77, 30.35, 29.36]
[rank3]:2025-12-30 16:35:43,384 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1635_rank3_stage3.svg
[rank3]:	> Counts Sum: 874640, Total Sum: 1169280 (74.80%), Ratio(%) per element: [78.96, 78.57, 78.17, 78.37, 80.55, 79.76, 78.57, 78.76, 77.97, 75.59, 74.2, 75.99, 74.8, 75.59, 75.19, 76.19, 76.78, 75.79, 69.44, 70.83, 69.84, 70.43, 71.23, 71.42, 70.63, 72.02, 70.63, 71.03, 71.82]
[rank1]:2025-12-30 16:35:44,830 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1635_stage1.svg
[rank2]:2025-12-30 16:35:44,882 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1635_stage2.svg
[rank0]:2025-12-30 16:35:44,885 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1635_stage0.svg
[rank3]:2025-12-30 16:35:44,983 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1635_stage3.svg
[rank3]:2025-12-30 16:37:18,684 - Avg. fwd time: 10.7142 / Avg. bwd time: 28.9800 / Avg. batch time: 377.0952 (ms) / GPU bubble ratio: 15.79%
[rank2]:2025-12-30 16:37:18,716 - Avg. fwd time: 6.9538 / Avg. bwd time: 18.5036 / Avg. batch time: 418.3291 (ms) / GPU bubble ratio: 51.32%
[rank1]:2025-12-30 16:37:18,742 - Avg. fwd time: 9.0931 / Avg. bwd time: 20.8628 / Avg. batch time: 456.6192 (ms) / GPU bubble ratio: 47.52%
[rank0]:2025-12-30 16:37:18,754 - Avg. fwd time: 8.1974 / Avg. bwd time: 18.8834 / Avg. batch time: 474.1866 (ms) / GPU bubble ratio: 54.31%
[rank0]:2025-12-30 16:38:49,354 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 16:38:53,089 - Avg. fwd time: 10.7149 / Avg. bwd time: 28.8845 / Avg. batch time: 376.3380 (ms) / GPU bubble ratio: 15.82%
[rank0]:2025-12-30 16:38:53,162 - Avg. fwd time: 8.1980 / Avg. bwd time: 18.8596 / Avg. batch time: 473.5080 (ms) / GPU bubble ratio: 54.29%
[rank2]:2025-12-30 16:38:53,123 - Avg. fwd time: 6.9540 / Avg. bwd time: 18.5035 / Avg. batch time: 417.7306 (ms) / GPU bubble ratio: 51.25%
[rank1]:2025-12-30 16:38:53,150 - Avg. fwd time: 9.0936 / Avg. bwd time: 20.8475 / Avg. batch time: 456.0932 (ms) / GPU bubble ratio: 47.48%
[rank1]:2025-12-30 16:38:53,188 -  step: 750  loss: -8.0000  grad_norm:  0.1088  memory: 15.15GiB(31.89%)  tps: 8,617  tflops: 67.37  mfu: 21.59%
[rank3]:2025-12-30 16:38:53,197 -  step: 750  loss:  0.2293  grad_norm:  0.1088  memory: 26.98GiB(56.79%)  tps: 8,617  tflops: 67.37  mfu: 21.59%
[rank0]:2025-12-30 16:38:53,199 -  step: 750  loss: -8.0000  grad_norm:  0.1088  memory: 17.08GiB(35.95%)  tps: 8,617  tflops: 67.37  mfu: 21.59%
[rank2]:2025-12-30 16:38:53,184 -  step: 750  loss: -8.0000  grad_norm:  0.1088  memory: 12.26GiB(25.80%)  tps: 8,617  tflops: 67.37  mfu: 21.59%
[rank1]:2025-12-30 16:40:28,164 - Avg. fwd time: 9.0938 / Avg. bwd time: 20.8362 / Avg. batch time: 455.6906 (ms) / GPU bubble ratio: 47.46%
[rank3]:2025-12-30 16:40:28,101 - Avg. fwd time: 10.7141 / Avg. bwd time: 28.8077 / Avg. batch time: 375.7157 (ms) / GPU bubble ratio: 15.85%
[rank0]:2025-12-30 16:40:28,178 - Avg. fwd time: 8.1975 / Avg. bwd time: 18.8288 / Avg. batch time: 472.9623 (ms) / GPU bubble ratio: 54.29%
[rank2]:2025-12-30 16:40:28,138 - Avg. fwd time: 6.9540 / Avg. bwd time: 18.5038 / Avg. batch time: 417.2997 (ms) / GPU bubble ratio: 51.20%
[rank0]:2025-12-30 16:41:57,504 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 16:42:01,277 - Avg. fwd time: 10.7127 / Avg. bwd time: 28.6972 / Avg. batch time: 374.8195 (ms) / GPU bubble ratio: 15.88%
[rank1]:2025-12-30 16:42:01,339 - Avg. fwd time: 9.0941 / Avg. bwd time: 20.8238 / Avg. batch time: 455.0284 (ms) / GPU bubble ratio: 47.40%
[rank1]:2025-12-30 16:42:01,378 -  step: 800  loss: -8.0000  grad_norm:  0.1080  memory: 15.15GiB(31.89%)  tps: 8,706  tflops: 68.06  mfu: 21.81%
[rank1]:2025-12-30 16:42:01,378 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1080  tps: 8,847  tflops: 69.16  mfu: 20.24%
[rank1]:2025-12-30 16:42:01,378 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 16:42:01,379 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 16:42:01,387 -  step: 800  loss:  0.2341  grad_norm:  0.1080  memory: 26.98GiB(56.79%)  tps: 8,706  tflops: 68.06  mfu: 21.81%
[rank3]:2025-12-30 16:42:01,388 - â„¹ï¸ final step: 800  loss:  0.2341  grad_norm:  0.1080  tps: 8,853  tflops: 69.21  mfu: 20.36%
[rank3]:2025-12-30 16:42:01,388 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 16:42:01,389 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 16:42:01,312 - Avg. fwd time: 6.9539 / Avg. bwd time: 18.5036 / Avg. batch time: 416.6200 (ms) / GPU bubble ratio: 51.12%
[rank2]:2025-12-30 16:42:01,374 -  step: 800  loss: -8.0000  grad_norm:  0.1080  memory: 12.26GiB(25.80%)  tps: 8,706  tflops: 68.06  mfu: 21.81%
[rank2]:2025-12-30 16:42:01,374 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1080  tps: 8,846  tflops: 69.16  mfu: 20.23%
[rank2]:2025-12-30 16:42:01,375 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-30 16:42:01,375 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 16:42:01,353 - Avg. fwd time: 8.1969 / Avg. bwd time: 18.7933 / Avg. batch time: 472.1661 (ms) / GPU bubble ratio: 54.27%
[rank0]:2025-12-30 16:42:01,389 -  step: 800  loss: -8.0000  grad_norm:  0.1080  memory: 17.08GiB(35.95%)  tps: 8,706  tflops: 68.06  mfu: 21.81%
[rank0]:2025-12-30 16:42:01,389 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1080  tps: 8,846  tflops: 69.16  mfu: 20.23%
[rank0]:2025-12-30 16:42:01,389 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 16:42:01,390 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 16:42:03,406 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank2/251230_1642_stage2_final800.svg
[rank0]:2025-12-30 16:42:03,336 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-30 16:42:03,406 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank0/251230_1642_stage0_final800.svg
[rank1]:2025-12-30 16:42:03,406 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank1/251230_1642_stage1_final800.svg
[rank3]:2025-12-30 16:42:03,489 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1642_final800_rank3.svg
[rank3]:			> Batch Time: 454.50 ms, GPU Bubble Ratio: 53.58%, 48.00%, 55.15%, 34.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  307-25-333ms   | [S0,MB2,B]  337-22-359ms   | [S0,MB3,B]  361-24-385ms   | [S0,MB4,B]  387-24-411ms   | [S0,MB5,B]  414-23-438ms   | [S0,MB6,B]  439-0-439ms    | [S0,MB7,B]  454-0-454ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  281-22-304ms   | [S1,MB2,B]  308-25-333ms   | [S1,MB3,B]  337-19-356ms   | [S1,MB4,B]  361-22-384ms   | [S1,MB5,B]  387-23-411ms   | [S1,MB6,B]  414-12-426ms   | [S1,MB7,B]  439-11-451ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  337-20-357ms   | [S2,MB5,B]  361-20-381ms   | [S2,MB6,B]  387-19-407ms   | [S2,MB7,B]  414-9-423ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-38-252ms   | [S3,MB2,B]  252-23-275ms   | [S3,MB3,B]  275-22-297ms   | [S3,MB4,B]  297-22-320ms   | [S3,MB5,B]  319-22-342ms   | [S3,MB6,B]  342-22-365ms   | [S3,MB7,B]  364-22-387ms  
[rank1]:2025-12-30 16:42:03,550 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1642_rank1_stage1.svg
[rank1]:	> Counts Sum: 796160, Total Sum: 2102400 (37.87%), Ratio(%) per element: [48.97, 46.74, 47.77, 48.45, 46.06, 48.45, 49.14, 48.63, 47.08, 42.97, 40.58, 41.78, 42.12, 44.69, 41.6, 42.29, 40.41, 41.6, 36.47, 35.95, 37.32, 35.95, 36.13, 36.47, 35.61, 36.3, 35.61, 33.21, 30.3, 31.16, 30.47, 32.02, 31.5, 33.21, 31.67, 32.36, 31.84, 30.99, 32.02, 30.13, 31.33, 32.02, 33.04, 29.96, 31.5]
[rank2]:2025-12-30 16:42:03,554 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1642_rank2_stage2.svg
[rank2]:	> Counts Sum: 223200, Total Sum: 1681920 (13.27%), Ratio(%) per element: [14.21, 14.04, 13.52, 13.35, 14.04, 14.04, 13.86, 13.69, 13.69, 13.86, 13.86, 13.18, 13.18, 12.84, 12.84, 13.86, 13.18, 13.52, 13.86, 13.52, 12.84, 13.69, 13.01, 13.69, 12.84, 12.84, 13.35, 12.32, 12.84, 12.67, 12.67, 12.5, 12.5, 12.84, 12.32, 12.5]
[rank0]:2025-12-30 16:42:03,557 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1642_rank0_stage0.svg
[rank0]:	> Counts Sum: 564880, Total Sum: 1728640 (32.68%), Ratio(%) per element: [29.1, 38.01, 36.47, 36.3, 35.61, 40.58, 36.47, 37.5, 34.24, 35.1, 36.13, 33.73, 31.67, 35.27, 35.1, 32.53, 34.76, 33.39, 33.56, 31.84, 30.3, 30.3, 30.65, 30.13, 30.82, 30.99, 30.3, 32.7, 30.13, 28.76, 30.13, 29.79, 29.1, 28.25, 28.59, 30.47, 30.13]
[rank3]:2025-12-30 16:42:03,619 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/pipeline_schedule/251230_1642_thry_final800_rank3.svg
[rank3]:			> Batch Time: 288.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-69ms      | [S0,MB0,B]  148-17-165ms   | [S0,MB1,B]  165-17-183ms   | [S0,MB2,B]  183-17-200ms   | [S0,MB3,B]  200-17-218ms   | [S0,MB4,B]  218-17-235ms   | [S0,MB5,B]  235-17-253ms   | [S0,MB6,B]  253-17-270ms   | [S0,MB7,B]  270-17-288ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-34ms      | [S1,MB3,F]  34-8-43ms      | [S1,MB4,F]  43-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-69ms      | [S1,MB7,F]  69-8-78ms      | [S1,MB0,B]  130-17-148ms   | [S1,MB1,B]  148-17-165ms   | [S1,MB2,B]  165-17-183ms   | [S1,MB3,B]  183-17-200ms   | [S1,MB4,B]  200-17-218ms   | [S1,MB5,B]  218-17-235ms   | [S1,MB6,B]  235-17-253ms   | [S1,MB7,B]  253-17-270ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-34ms      | [S2,MB2,F]  34-8-43ms      | [S2,MB3,F]  43-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-69ms      | [S2,MB6,F]  69-8-78ms      | [S2,MB7,F]  78-8-87ms      | [S2,MB0,B]  113-17-130ms   | [S2,MB1,B]  130-17-148ms   | [S2,MB2,B]  148-17-165ms   | [S2,MB3,B]  165-17-183ms   | [S2,MB4,B]  183-17-200ms   | [S2,MB5,B]  200-17-218ms   | [S2,MB6,B]  218-17-235ms   | [S2,MB7,B]  235-17-253ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-34ms      | [S3,MB1,F]  34-8-43ms      | [S3,MB2,F]  43-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-69ms      | [S3,MB5,F]  69-8-78ms      | [S3,MB6,F]  78-8-87ms      | [S3,MB7,F]  87-8-96ms      | [S3,MB0,B]  96-17-113ms    | [S3,MB1,B]  113-17-130ms   | [S3,MB2,B]  130-17-148ms   | [S3,MB3,B]  148-17-165ms   | [S3,MB4,B]  165-17-183ms   | [S3,MB5,B]  183-17-200ms   | [S3,MB6,B]  200-17-218ms   | [S3,MB7,B]  218-17-235ms  
[rank3]:2025-12-30 16:42:03,666 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_ratio_history/rank3/251230_1642_stage3_final800.svg
[rank3]:2025-12-30 16:42:03,797 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/frozen_params_histogram/251230_1642_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [79.28, 79.1, 78.42, 78.76, 80.3, 80.13, 79.28, 79.28, 78.25, 76.54, 74.82, 76.19, 75.68, 76.54, 76.19, 76.88, 77.05, 76.36, 70.37, 71.91, 71.4, 71.4, 72.26, 72.08, 71.74, 72.94, 71.91, 72.43, 72.94]
[rank1]:2025-12-30 16:42:05,385 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1642_stage1.svg
[rank1]:2025-12-30 16:42:05,388 - Destroying the purge thread.
[rank0]:2025-12-30 16:42:05,417 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1642_stage0.svg
[rank0]:2025-12-30 16:42:05,420 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-30 16:42:05,417 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1642_stage2.svg
[rank2]:2025-12-30 16:42:05,420 - Destroying the purge thread.
[rank1]:2025-12-30 16:42:05,658 - Process group destroyed
[rank3]:2025-12-30 16:42:05,656 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1/afr_time_plot/251230_1642_stage3.svg
[rank3]:2025-12-30 16:42:05,660 - Destroying the purge thread.
[rank2]:2025-12-30 16:42:05,656 - Process group destroyed
[rank3]:wandb: uploading history steps 15-15, summary, console lines 331-350
[rank3]:wandb: uploading history steps 16-16, summary, console lines 351-352
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.70124
[rank3]:wandb:               final/avg_loss 0.23413
[rank3]:wandb:             final/avg_mfu(%) 20.36281
[rank3]:wandb:             final/avg_tflops 69.21071
[rank3]:wandb:    final/avg_throughput(tps) 8853.25998
[rank3]:wandb:              final/grad_norm 0.10796
[rank3]:wandb:               final/max_loss 0.23413
[rank3]:wandb:                    grad_norm 0.10796
[rank3]:wandb: loss_metrics/global_avg_loss 0.23413
[rank3]:wandb: loss_metrics/global_max_loss 0.23413
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_GPipe_timelyauto_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/w26n2etw
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_GPipe_timelyauto_22_dm1/20251230-1549/wandb/run-20251230_154933-w26n2etw/logs
[rank3]:2025-12-30 16:42:07,212 - Process group destroyed
[rank0]:2025-12-30 16:42:07,420 - Training completed
[rank0]:2025-12-30 16:42:07,421 - Destroying the purge thread.
[rank0]:2025-12-30 16:42:07,749 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.3', 'layers.1', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.8', 'layers.6', 'layers.7', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'norm', 'layers.15', 'layers.13', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_GPipe_timelyauto_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_GPipe_timelyauto_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_GPipe_timelyauto_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_GPipe_timelyauto_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_GPipe_timelyauto_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_GPipe_timelyauto_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_GPipe_timelyauto_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_GPipe_timelyauto_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
