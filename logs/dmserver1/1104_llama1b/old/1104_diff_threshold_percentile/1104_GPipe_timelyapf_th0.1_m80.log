
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 06. (ëª©) 11:21:45 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_GPipe_timelyapf_th0.1_m80.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: monitoring steps = 50 -> 80
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: monitoring steps = 50 -> 80" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.1
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-06 11:21:51,209 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: monitoring steps = 50 -> 80"
[rank3]:2025-11-06 11:21:51,387 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-06 11:21:51,389 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-06 11:21:52,034 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:for timelyapf: monitoring steps = 50 -> 80"
[rank0]:2025-11-06 11:21:52,033 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:for timelyapf: monitoring steps = 50 -> 80"
[rank2]:2025-11-06 11:21:52,020 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:for timelyapf: monitoring steps = 50 -> 80"
[rank2]:2025-11-06 11:21:52,240 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-06 11:21:52,242 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-06 11:21:52,314 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-06 11:21:52,317 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 11:21:52,318 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-06 11:21:52,321 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 11:21:52,323 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-06 11:21:52,838 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-06 11:21:53,346 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-06 11:21:56,015 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-06 11:21:56,171 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-06 11:21:56,163 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-06 11:21:56,198 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-06 11:21:56,211 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 11:21:56,239 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-06 11:21:56,239 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-06 11:21:56,204 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 11:21:56,205 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-06 11:21:56,230 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-06 11:21:56,230 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-06 11:21:56,238 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 11:21:56,266 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-06 11:21:56,267 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-06 11:21:56,465 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 11:21:56,466 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-06 11:21:56,453 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 11:21:56,453 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-06 11:21:56,454 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-06 11:21:56,466 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-06 11:21:56,466 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 11:21:56,466 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-06 11:21:56,467 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run nwz6kluj
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_GPipe_timelyapf_th0.1_m80_dm1/20251106-1121/wandb/run-20251106_112157-nwz6kluj
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/nwz6kluj
[rank3]:2025-11-06 11:21:58,254 - INFO - WandB logging enabled
[rank3]:2025-11-06 11:21:58,255 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-06 11:21:58,292 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 11:21:58,320 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-06 11:21:58,321 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-11-06 11:21:58,506 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 11:21:58,507 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-06 11:21:58,508 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-06 11:21:58,525 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 11:21:58,524 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_GPipe_timelyapf_th0.1_m80_dm1
[rank0]:2025-11-06 11:21:58,525 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 11:21:58,525 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-06 11:21:58,525 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-06 11:21:58,524 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-06 11:21:58,525 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 11:22:00,809 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-06 11:22:00,809 - INFO - Finished loading the checkpoint in 2.28 seconds.
[rank0]:2025-11-06 11:22:00,809 - INFO - Training starts at step 1
[rank3]:2025-11-06 11:22:03,888 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8877  memory: 24.19GiB(50.91%)  tps: 2,929  tflops: 22.31  mfu: 7.15%
[rank3]:2025-11-06 11:22:03,888 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-06 11:22:03,883 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8877  memory: 12.38GiB(26.05%)  tps: 2,136  tflops: 16.27  mfu: 5.21%
[rank1]:2025-11-06 11:22:03,883 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-06 11:22:03,881 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8877  memory:  9.99GiB(21.03%)  tps: 2,144  tflops: 16.33  mfu: 5.23%
[rank2]:2025-11-06 11:22:03,882 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 11:22:03,920 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8877  memory: 12.80GiB(26.95%)  tps: 2,123  tflops: 16.17  mfu: 5.18%
[rank0]:2025-11-06 11:22:03,920 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 11:24:03,965 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 11:24:06,198 - INFO - Avg. fwd time: 11.0382 / Avg. bwd time: 43.4580 / Avg. batch time: 495.7707 (ms) / GPU bubble ratio: 12.06%
[rank2]:2025-11-06 11:24:06,269 - INFO - Avg. fwd time: 7.0982 / Avg. bwd time: 18.6730 / Avg. batch time: 527.5042 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-11-06 11:24:06,308 - INFO - Avg. fwd time: 8.9682 / Avg. bwd time: 23.6974 / Avg. batch time: 566.9226 (ms) / GPU bubble ratio: 53.90%
[rank0]:2025-11-06 11:24:06,316 - INFO - Avg. fwd time: 7.7897 / Avg. bwd time: 23.3434 / Avg. batch time: 603.9932 (ms) / GPU bubble ratio: 58.76%
[rank3]:2025-11-06 11:24:06,502 - INFO -  step: 50  loss:  9.2159  grad_norm: 15.5528  memory: 26.98GiB(56.79%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank1]:2025-11-06 11:24:06,493 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5528  memory: 14.64GiB(30.82%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank2]:2025-11-06 11:24:06,489 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5528  memory: 11.81GiB(24.85%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank0]:2025-11-06 11:24:06,504 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5528  memory: 16.57GiB(34.88%)  tps: 6,549  tflops: 49.88  mfu: 15.99%
[rank3]:2025-11-06 11:24:31,999 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-06 11:24:58,603 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank1]:2025-11-06 11:24:58,849 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank2]:2025-11-06 11:24:58,822 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank0]:2025-11-06 11:24:58,874 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank3]:2025-11-06 11:25:30,102 - INFO - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-06 11:25:30,419 - INFO - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-06 11:25:33,898 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,662 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,681 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,693 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 11:25:35,644 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 11:25:35,682 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,625 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,650 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,690 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,646 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,665 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,677 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,687 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,697 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,702 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,735 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,772 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 11:25:35,719 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 11:25:35,756 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,727 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,820 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 11:25:35,857 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 11:25:35,842 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 11:25:35,882 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,860 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,900 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,883 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 11:25:35,924 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,942 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 11:25:35,985 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,922 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:25:35,963 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 11:26:07,367 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:26:08,680 - INFO - Avg. fwd time: 8.0231 / Avg. bwd time: 19.2561 / Avg. batch time: 574.6094 (ms) / GPU bubble ratio: 62.02%
[rank3]:2025-11-06 11:26:08,864 - INFO - Avg. fwd time: 11.6102 / Avg. bwd time: 40.1746 / Avg. batch time: 473.9943 (ms) / GPU bubble ratio: 12.60%
[rank3]:2025-11-06 11:26:08,870 - INFO - [Step 100] âœ”ï¸  Setting Lowerbound
[rank2]:2025-11-06 11:26:08,902 - INFO - Avg. fwd time: 7.3847 / Avg. bwd time: 16.9038 / Avg. batch time: 505.5930 (ms) / GPU bubble ratio: 61.57%
[rank1]:2025-11-06 11:26:08,950 - INFO - Avg. fwd time: 9.3547 / Avg. bwd time: 21.4894 / Avg. batch time: 542.2082 (ms) / GPU bubble ratio: 54.49%
[rank2]:2025-11-06 11:26:09,062 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-06 11:26:09,062 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 6,683  tflops: 50.90  mfu: 16.31%
[rank1]:2025-11-06 11:26:09,060 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.17/0.17, [MB4] 0.04/0.04, [MB5] 0.27/0.27, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank1]:2025-11-06 11:26:09,061 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 6,684  tflops: 50.90  mfu: 16.32%
[rank0]:2025-11-06 11:26:09,073 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.13/0.13, [MB5] 0.51/0.51, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-06 11:26:09,074 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 6,684  tflops: 50.90  mfu: 16.32%
[rank3]:2025-11-06 11:26:09,286 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1126_max_batch_time.svg
[rank3]:> Batch Time: 545.19 ms, GPU Bubble Ratio: 53.72%, 51.33%, 61.74%, 17.57%
[rank3]:2025-11-06 11:26:09,431 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1126_min_batch_time.svg
[rank3]:> Batch Time: 312.68 ms, GPU Bubble Ratio: 79.96%, 49.87%, 60.57%, 15.31%
[rank3]:2025-11-06 11:26:09,592 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1126_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 364.13 ms, GPU Bubble Ratio: 45.01%, 36.13%, 45.64%, 13.15%
[rank3]:2025-11-06 11:26:09,593 - INFO - 	> Batch Time: 364.13 ms (Average Freeze Ratio: 0.35, Time Reduction Rate: 0.33)
[rank3]:2025-11-06 11:26:09,595 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 11:26:09,598 - INFO -  step: 100  loss:  4.3154  grad_norm:  0.0079  memory: 30.46GiB(64.11%)  tps: 6,655  tflops: 50.69  mfu: 16.25%
[rank0]:2025-11-06 11:26:09,656 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1126_stage0_step100.svg
[rank3]:2025-11-06 11:26:09,732 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1126_real_step100_rank3.svg
[rank3]:> Batch Time: 402.00 ms, GPU Bubble Ratio: 82.04%, 57.14%, 66.17%, 29.07%
[rank2]:2025-11-06 11:26:09,656 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1126_stage2_step100.svg
[rank1]:2025-11-06 11:26:09,656 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1126_stage1_step100.svg
[rank3]:2025-11-06 11:26:09,773 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1126_stage3_step100.svg
[rank0]:2025-11-06 11:27:55,272 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 11:27:57,365 - INFO - Avg. fwd time: 12.0679 / Avg. bwd time: 36.7089 / Avg. batch time: 449.8731 (ms) / GPU bubble ratio: 13.26%
[rank2]:2025-11-06 11:27:57,385 - INFO - Avg. fwd time: 7.6443 / Avg. bwd time: 15.2430 / Avg. batch time: 479.3488 (ms) / GPU bubble ratio: 61.80%
[rank1]:2025-11-06 11:27:57,409 - INFO - Avg. fwd time: 9.6691 / Avg. bwd time: 19.4480 / Avg. batch time: 514.1534 (ms) / GPU bubble ratio: 54.70%
[rank0]:2025-11-06 11:27:57,426 - INFO - Avg. fwd time: 8.2543 / Avg. bwd time: 16.1817 / Avg. batch time: 543.6227 (ms) / GPU bubble ratio: 64.04%
[rank0]:2025-11-06 11:27:58,264 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.09/0.13, [MB5] 0.34/0.51, [MB6] 0.37/0.55, [MB7] 0.67/1.00
[rank0]:2025-11-06 11:27:58,264 - INFO -  step: 150  loss: -4.0000  grad_norm: 20.5076  memory: 17.06GiB(35.91%)  tps: 7,503  tflops: 57.14  mfu: 18.31%
[rank2]:2025-11-06 11:27:58,606 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-06 11:27:58,606 - INFO -  step: 150  loss: -4.0000  grad_norm: 20.5076  memory: 12.31GiB(25.92%)  tps: 7,478  tflops: 56.96  mfu: 18.26%
[rank1]:2025-11-06 11:27:59,152 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.11/0.17, [MB4] 0.02/0.04, [MB5] 0.18/0.27, [MB6] 0.62/0.93, [MB7] 0.67/1.00
[rank1]:2025-11-06 11:27:59,153 - INFO -  step: 150  loss: -4.0000  grad_norm: 20.5076  memory: 15.23GiB(32.05%)  tps: 7,441  tflops: 56.67  mfu: 18.16%
[rank3]:2025-11-06 11:28:00,275 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.67/1.00, [MB3] 0.40/0.60, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-06 11:28:00,279 - INFO -  step: 150  loss:  4.6029  grad_norm: 20.5076  memory: 30.95GiB(65.14%)  tps: 7,402  tflops: 56.37  mfu: 18.07%
[rank0]:2025-11-06 11:29:36,667 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 11:29:38,214 - INFO - Avg. fwd time: 12.3594 / Avg. bwd time: 34.2427 / Avg. batch time: 432.4452 (ms) / GPU bubble ratio: 13.79%
[rank1]:2025-11-06 11:29:38,306 - INFO - Avg. fwd time: 9.8675 / Avg. bwd time: 18.0442 / Avg. batch time: 498.9495 (ms) / GPU bubble ratio: 55.25%
[rank0]:2025-11-06 11:29:38,271 - INFO - Avg. fwd time: 8.4041 / Avg. bwd time: 14.6866 / Avg. batch time: 528.6954 (ms) / GPU bubble ratio: 65.06%
[rank2]:2025-11-06 11:29:38,267 - INFO - Avg. fwd time: 7.7922 / Avg. bwd time: 14.2266 / Avg. batch time: 465.5408 (ms) / GPU bubble ratio: 62.16%
[rank3]:2025-11-06 11:29:38,610 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 11:29:38,614 - INFO -  step: 200  loss:  1.9235  grad_norm: 29.7622  memory: 31.43GiB(66.17%)  tps: 8,331  tflops: 63.45  mfu: 20.34%
[rank0]:2025-11-06 11:29:38,604 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.13/0.13, [MB5] 0.51/0.51, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-06 11:29:38,605 - INFO -  step: 200  loss: -4.0000  grad_norm: 29.7622  memory: 17.06GiB(35.91%)  tps: 8,164  tflops: 62.18  mfu: 19.93%
[rank2]:2025-11-06 11:29:38,676 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-06 11:29:38,677 - INFO -  step: 200  loss: -4.0000  grad_norm: 29.7622  memory: 12.31GiB(25.92%)  tps: 8,186  tflops: 62.35  mfu: 19.98%
[rank1]:2025-11-06 11:29:38,956 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.17/0.17, [MB4] 0.04/0.04, [MB5] 0.27/0.27, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank1]:2025-11-06 11:29:38,956 - INFO -  step: 200  loss: -4.0000  grad_norm: 29.7622  memory: 15.23GiB(32.05%)  tps: 8,208  tflops: 62.52  mfu: 20.04%
[rank1]:2025-11-06 11:29:39,006 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1129_stage1_step200.svg
[rank0]:2025-11-06 11:29:39,006 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1129_stage0_step200.svg
[rank2]:2025-11-06 11:29:39,008 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1129_stage2_step200.svg
[rank3]:2025-11-06 11:29:39,101 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1129_real_step200_rank3.svg
[rank3]:> Batch Time: 419.40 ms, GPU Bubble Ratio: 64.91%, 55.05%, 64.53%, 31.21%
[rank3]:2025-11-06 11:29:39,145 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1129_stage3_step200.svg
[rank0]:2025-11-06 11:31:00,836 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:31:02,134 - INFO - Avg. fwd time: 8.5369 / Avg. bwd time: 11.7544 / Avg. batch time: 502.5293 (ms) / GPU bubble ratio: 67.70%
[rank2]:2025-11-06 11:31:02,353 - INFO - Avg. fwd time: 7.9798 / Avg. bwd time: 12.9914 / Avg. batch time: 444.6165 (ms) / GPU bubble ratio: 62.27%
[rank3]:2025-11-06 11:31:02,314 - INFO - Avg. fwd time: 12.6823 / Avg. bwd time: 31.6292 / Avg. batch time: 414.0980 (ms) / GPU bubble ratio: 14.39%
[rank1]:2025-11-06 11:31:02,399 - INFO - Avg. fwd time: 10.0986 / Avg. bwd time: 16.5145 / Avg. batch time: 476.2860 (ms) / GPU bubble ratio: 55.30%
[rank2]:2025-11-06 11:31:02,479 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-06 11:31:02,490 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,774  tflops: 74.44  mfu: 23.86%
[rank1]:2025-11-06 11:31:02,492 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.17/0.17, [MB4] 0.04/0.04, [MB5] 0.27/0.27, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank1]:2025-11-06 11:31:02,493 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank0]:2025-11-06 11:31:02,491 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.13/0.13, [MB5] 0.51/0.51, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-06 11:31:02,492 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,766  tflops: 74.38  mfu: 23.84%
[rank3]:2025-11-06 11:31:02,479 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 11:31:02,492 - INFO -  step: 250  loss:  2.1207  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,767  tflops: 74.39  mfu: 23.84%
[rank0]:2025-11-06 11:32:24,288 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-06 11:32:25,980 - INFO - Avg. fwd time: 10.2538 / Avg. bwd time: 15.4830 / Avg. batch time: 461.2716 (ms) / GPU bubble ratio: 55.36%
[rank2]:2025-11-06 11:32:25,963 - INFO - Avg. fwd time: 8.1033 / Avg. bwd time: 12.1757 / Avg. batch time: 430.7669 (ms) / GPU bubble ratio: 62.34%
[rank2]:2025-11-06 11:32:25,966 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 11:32:25,944 - INFO - Avg. fwd time: 12.8928 / Avg. bwd time: 29.9113 / Avg. batch time: 402.0252 (ms) / GPU bubble ratio: 14.82%
[rank3]:2025-11-06 11:32:25,960 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-06 11:32:25,988 - INFO - Avg. fwd time: 8.6214 / Avg. bwd time: 9.6977 / Avg. batch time: 485.0984 (ms) / GPU bubble ratio: 69.79%
[rank0]:2025-11-06 11:32:25,991 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.13/0.13, [MB5] 0.51/0.51, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-06 11:32:25,992 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank0]:2025-11-06 11:32:26,041 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1132_stage0_step300.svg
[rank1]:2025-11-06 11:32:25,984 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.17/0.17, [MB4] 0.04/0.04, [MB5] 0.27/0.27, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank1]:2025-11-06 11:32:25,989 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank1]:2025-11-06 11:32:26,041 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1132_stage1_step300.svg
[rank2]:2025-11-06 11:32:25,989 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank2]:2025-11-06 11:32:26,042 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1132_stage2_step300.svg
[rank3]:2025-11-06 11:32:25,991 - INFO -  step: 300  loss:  1.9192  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank3]:2025-11-06 11:32:26,134 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1132_real_step300_rank3.svg
[rank3]:> Batch Time: 403.25 ms, GPU Bubble Ratio: 82.12%, 57.09%, 66.21%, 29.08%
[rank3]:2025-11-06 11:32:26,178 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1132_stage3_step300.svg
[rank0]:2025-11-06 11:33:48,362 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:33:49,667 - INFO - Avg. fwd time: 8.6742 / Avg. bwd time: 8.4331 / Avg. batch time: 474.6299 (ms) / GPU bubble ratio: 71.17%
[rank2]:2025-11-06 11:33:49,879 - INFO - Avg. fwd time: 8.1797 / Avg. bwd time: 11.6743 / Avg. batch time: 422.4699 (ms) / GPU bubble ratio: 62.40%
[rank3]:2025-11-06 11:33:49,840 - INFO - Avg. fwd time: 13.0272 / Avg. bwd time: 28.8659 / Avg. batch time: 394.7436 (ms) / GPU bubble ratio: 15.10%
[rank1]:2025-11-06 11:33:49,926 - INFO - Avg. fwd time: 10.3514 / Avg. bwd time: 14.8491 / Avg. batch time: 452.2643 (ms) / GPU bubble ratio: 55.42%
[rank1]:2025-11-06 11:33:50,018 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,749  tflops: 74.25  mfu: 23.80%
[rank2]:2025-11-06 11:33:50,016 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,749  tflops: 74.25  mfu: 23.80%
[rank3]:2025-11-06 11:33:50,018 - INFO -  step: 350  loss:  2.1406  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,750  tflops: 74.25  mfu: 23.80%
[rank0]:2025-11-06 11:33:50,018 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,749  tflops: 74.25  mfu: 23.80%
[rank0]:2025-11-06 11:35:12,355 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:35:13,673 - INFO - Avg. fwd time: 8.7219 / Avg. bwd time: 7.3196 / Avg. batch time: 465.3494 (ms) / GPU bubble ratio: 72.42%
[rank3]:2025-11-06 11:35:13,858 - INFO - Avg. fwd time: 13.1469 / Avg. bwd time: 27.9512 / Avg. batch time: 388.3731 (ms) / GPU bubble ratio: 15.34%
[rank2]:2025-11-06 11:35:13,897 - INFO - Avg. fwd time: 8.2472 / Avg. bwd time: 11.2337 / Avg. batch time: 415.1287 (ms) / GPU bubble ratio: 62.46%
[rank1]:2025-11-06 11:35:13,945 - INFO - Avg. fwd time: 10.4351 / Avg. bwd time: 14.2928 / Avg. batch time: 444.2833 (ms) / GPU bubble ratio: 55.47%
[rank1]:2025-11-06 11:35:14,039 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,750  tflops: 74.26  mfu: 23.80%
[rank1]:2025-11-06 11:35:14,098 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1135_stage1_step400.svg
[rank0]:2025-11-06 11:35:14,039 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,750  tflops: 74.26  mfu: 23.80%
[rank0]:2025-11-06 11:35:14,096 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1135_stage0_step400.svg
[rank3]:2025-11-06 11:35:14,038 - INFO -  step: 400  loss:  1.9276  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,750  tflops: 74.26  mfu: 23.80%
[rank2]:2025-11-06 11:35:14,037 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,750  tflops: 74.26  mfu: 23.80%
[rank2]:2025-11-06 11:35:14,092 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1135_stage2_step400.svg
[rank3]:2025-11-06 11:35:14,177 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1135_real_step400_rank3.svg
[rank3]:> Batch Time: 404.25 ms, GPU Bubble Ratio: 82.12%, 57.18%, 66.27%, 29.00%
[rank3]:2025-11-06 11:35:14,223 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1135_stage3_step400.svg
[rank3]:2025-11-06 11:35:22,865 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 11:35:23,037 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 11:35:23,023 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 11:35:23,037 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 11:36:36,234 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-06 11:36:37,898 - INFO - Avg. fwd time: 10.5000 / Avg. bwd time: 13.8670 / Avg. batch time: 438.2436 (ms) / GPU bubble ratio: 55.52%
[rank1]:2025-11-06 11:36:37,907 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,768  tflops: 74.39  mfu: 23.84%
[rank2]:2025-11-06 11:36:37,880 - INFO - Avg. fwd time: 8.2994 / Avg. bwd time: 10.8967 / Avg. batch time: 409.5758 (ms) / GPU bubble ratio: 62.51%
[rank2]:2025-11-06 11:36:37,907 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,768  tflops: 74.39  mfu: 23.84%
[rank0]:2025-11-06 11:36:37,906 - INFO - Avg. fwd time: 8.7566 / Avg. bwd time: 6.4659 / Avg. batch time: 458.2998 (ms) / GPU bubble ratio: 73.43%
[rank0]:2025-11-06 11:36:37,908 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,768  tflops: 74.39  mfu: 23.84%
[rank3]:2025-11-06 11:36:37,864 - INFO - Avg. fwd time: 13.2396 / Avg. bwd time: 27.2513 / Avg. batch time: 383.5086 (ms) / GPU bubble ratio: 15.54%
[rank3]:2025-11-06 11:36:37,908 - INFO -  step: 450  loss:  2.1287  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,768  tflops: 74.39  mfu: 23.84%
[rank0]:2025-11-06 11:38:00,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:38:01,545 - INFO - Avg. fwd time: 8.7810 / Avg. bwd time: 5.8783 / Avg. batch time: 453.4906 (ms) / GPU bubble ratio: 74.14%
[rank3]:2025-11-06 11:38:01,731 - INFO - Avg. fwd time: 13.3062 / Avg. bwd time: 26.7772 / Avg. batch time: 380.2445 (ms) / GPU bubble ratio: 15.67%
[rank2]:2025-11-06 11:38:01,769 - INFO - Avg. fwd time: 8.3360 / Avg. bwd time: 10.6654 / Avg. batch time: 405.7962 (ms) / GPU bubble ratio: 62.54%
[rank1]:2025-11-06 11:38:01,818 - INFO - Avg. fwd time: 10.5455 / Avg. bwd time: 13.5748 / Avg. batch time: 434.1287 (ms) / GPU bubble ratio: 55.55%
[rank2]:2025-11-06 11:38:01,911 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,752  tflops: 74.27  mfu: 23.81%
[rank1]:2025-11-06 11:38:01,913 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,752  tflops: 74.27  mfu: 23.80%
[rank0]:2025-11-06 11:38:01,912 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,752  tflops: 74.27  mfu: 23.81%
[rank0]:2025-11-06 11:38:01,962 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1138_stage0_step500.svg
[rank3]:2025-11-06 11:38:01,912 - INFO -  step: 500  loss:  1.9285  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,752  tflops: 74.27  mfu: 23.81%
[rank2]:2025-11-06 11:38:01,961 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1138_stage2_step500.svg
[rank1]:2025-11-06 11:38:01,962 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1138_stage1_step500.svg
[rank3]:2025-11-06 11:38:02,051 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1138_real_step500_rank3.svg
[rank3]:> Batch Time: 406.00 ms, GPU Bubble Ratio: 82.25%, 57.32%, 66.39%, 28.93%
[rank3]:2025-11-06 11:38:02,094 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1138_stage3_step500.svg
[rank0]:2025-11-06 11:39:24,579 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:39:25,891 - INFO - Avg. fwd time: 8.8076 / Avg. bwd time: 5.3148 / Avg. batch time: 448.9656 (ms) / GPU bubble ratio: 74.84%
[rank3]:2025-11-06 11:39:26,074 - INFO - Avg. fwd time: 13.3713 / Avg. bwd time: 26.3244 / Avg. batch time: 377.1445 (ms) / GPU bubble ratio: 15.80%
[rank1]:2025-11-06 11:39:26,158 - INFO - Avg. fwd time: 10.5888 / Avg. bwd time: 13.2950 / Avg. batch time: 430.2569 (ms) / GPU bubble ratio: 55.59%
[rank2]:2025-11-06 11:39:26,113 - INFO - Avg. fwd time: 8.3711 / Avg. bwd time: 10.4438 / Avg. batch time: 402.2459 (ms) / GPU bubble ratio: 62.58%
[rank1]:2025-11-06 11:39:26,252 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,713  tflops: 73.98  mfu: 23.71%
[rank0]:2025-11-06 11:39:26,252 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,713  tflops: 73.98  mfu: 23.71%
[rank3]:2025-11-06 11:39:26,252 - INFO -  step: 550  loss:  2.0943  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,713  tflops: 73.98  mfu: 23.71%
[rank2]:2025-11-06 11:39:26,251 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,713  tflops: 73.98  mfu: 23.71%
[rank0]:2025-11-06 11:40:48,298 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 11:40:49,975 - INFO - Avg. fwd time: 8.4003 / Avg. bwd time: 10.2610 / Avg. batch time: 399.2348 (ms) / GPU bubble ratio: 62.61%
[rank3]:2025-11-06 11:40:49,957 - INFO - Avg. fwd time: 13.4235 / Avg. bwd time: 25.9477 / Avg. batch time: 374.5434 (ms) / GPU bubble ratio: 15.91%
[rank3]:2025-11-06 11:40:50,005 - INFO -  step: 600  loss:  1.9204  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,781  tflops: 74.50  mfu: 23.88%
[rank0]:2025-11-06 11:40:50,002 - INFO - Avg. fwd time: 8.8264 / Avg. bwd time: 4.8500 / Avg. batch time: 445.1404 (ms) / GPU bubble ratio: 75.42%
[rank0]:2025-11-06 11:40:50,005 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,781  tflops: 74.50  mfu: 23.88%
[rank1]:2025-11-06 11:40:49,994 - INFO - Avg. fwd time: 10.6249 / Avg. bwd time: 13.0638 / Avg. batch time: 426.9843 (ms) / GPU bubble ratio: 55.62%
[rank1]:2025-11-06 11:40:50,003 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,781  tflops: 74.50  mfu: 23.88%
[rank1]:2025-11-06 11:40:50,054 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1140_stage1_step600.svg
[rank2]:2025-11-06 11:40:50,003 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,781  tflops: 74.50  mfu: 23.88%
[rank2]:2025-11-06 11:40:50,056 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1140_stage2_step600.svg
[rank0]:2025-11-06 11:40:50,055 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1140_stage0_step600.svg
[rank3]:2025-11-06 11:40:50,144 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1140_real_step600_rank3.svg
[rank3]:> Batch Time: 404.50 ms, GPU Bubble Ratio: 82.16%, 57.16%, 66.26%, 28.87%
[rank3]:2025-11-06 11:40:50,188 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1140_stage3_step600.svg
[rank0]:2025-11-06 11:42:12,308 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:42:13,603 - INFO - Avg. fwd time: 8.8405 / Avg. bwd time: 4.5117 / Avg. batch time: 442.3627 (ms) / GPU bubble ratio: 75.85%
[rank3]:2025-11-06 11:42:13,786 - INFO - Avg. fwd time: 13.4607 / Avg. bwd time: 25.6706 / Avg. batch time: 372.6210 (ms) / GPU bubble ratio: 15.99%
[rank2]:2025-11-06 11:42:13,823 - INFO - Avg. fwd time: 8.4211 / Avg. bwd time: 10.1275 / Avg. batch time: 397.0514 (ms) / GPU bubble ratio: 62.63%
[rank1]:2025-11-06 11:42:13,871 - INFO - Avg. fwd time: 10.6505 / Avg. bwd time: 12.8948 / Avg. batch time: 424.6065 (ms) / GPU bubble ratio: 55.64%
[rank1]:2025-11-06 11:42:13,962 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,757  tflops: 74.31  mfu: 23.82%
[rank2]:2025-11-06 11:42:13,961 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,757  tflops: 74.31  mfu: 23.82%
[rank3]:2025-11-06 11:42:13,962 - INFO -  step: 650  loss:  2.1329  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,758  tflops: 74.32  mfu: 23.82%
[rank0]:2025-11-06 11:42:13,963 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,757  tflops: 74.31  mfu: 23.82%
[rank0]:2025-11-06 11:43:36,176 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:43:37,503 - INFO - Avg. fwd time: 8.8559 / Avg. bwd time: 4.1723 / Avg. batch time: 439.4849 (ms) / GPU bubble ratio: 76.28%
[rank3]:2025-11-06 11:43:37,683 - INFO - Avg. fwd time: 13.4961 / Avg. bwd time: 25.3878 / Avg. batch time: 370.6384 (ms) / GPU bubble ratio: 16.07%
[rank2]:2025-11-06 11:43:37,722 - INFO - Avg. fwd time: 8.4418 / Avg. bwd time: 9.9932 / Avg. batch time: 394.7643 (ms) / GPU bubble ratio: 62.64%
[rank1]:2025-11-06 11:43:37,770 - INFO - Avg. fwd time: 10.6755 / Avg. bwd time: 12.7247 / Avg. batch time: 422.1231 (ms) / GPU bubble ratio: 55.65%
[rank1]:2025-11-06 11:43:37,861 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,764  tflops: 74.37  mfu: 23.84%
[rank2]:2025-11-06 11:43:37,860 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,764  tflops: 74.37  mfu: 23.84%
[rank2]:2025-11-06 11:43:37,913 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1143_stage2_step700.svg
[rank3]:2025-11-06 11:43:37,861 - INFO -  step: 700  loss:  1.9247  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,764  tflops: 74.37  mfu: 23.84%
[rank0]:2025-11-06 11:43:37,862 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,764  tflops: 74.37  mfu: 23.84%
[rank0]:2025-11-06 11:43:37,918 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1143_stage0_step700.svg
[rank1]:2025-11-06 11:43:37,913 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1143_stage1_step700.svg
[rank3]:2025-11-06 11:43:38,001 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1143_real_step700_rank3.svg
[rank3]:> Batch Time: 403.75 ms, GPU Bubble Ratio: 82.07%, 57.22%, 66.26%, 29.12%
[rank3]:2025-11-06 11:43:38,046 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1143_stage3_step700.svg
[rank0]:2025-11-06 11:45:00,091 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 11:45:01,732 - INFO - Avg. fwd time: 13.5240 / Avg. bwd time: 25.1382 / Avg. batch time: 368.8631 (ms) / GPU bubble ratio: 16.15%
[rank1]:2025-11-06 11:45:01,769 - INFO - Avg. fwd time: 10.6958 / Avg. bwd time: 12.5774 / Avg. batch time: 419.9477 (ms) / GPU bubble ratio: 55.66%
[rank2]:2025-11-06 11:45:01,749 - INFO - Avg. fwd time: 8.4589 / Avg. bwd time: 9.8768 / Avg. batch time: 392.7580 (ms) / GPU bubble ratio: 62.65%
[rank2]:2025-11-06 11:45:01,781 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,762  tflops: 74.35  mfu: 23.83%
[rank3]:2025-11-06 11:45:01,782 - INFO -  step: 750  loss:  2.1195  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,762  tflops: 74.35  mfu: 23.83%
[rank1]:2025-11-06 11:45:01,781 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,762  tflops: 74.35  mfu: 23.83%
[rank0]:2025-11-06 11:45:01,780 - INFO - Avg. fwd time: 8.8686 / Avg. bwd time: 3.8804 / Avg. batch time: 436.9790 (ms) / GPU bubble ratio: 76.66%
[rank0]:2025-11-06 11:45:01,783 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,762  tflops: 74.35  mfu: 23.83%
[rank0]:2025-11-06 11:46:23,643 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:46:24,972 - INFO - Avg. fwd time: 8.8768 / Avg. bwd time: 3.6609 / Avg. batch time: 435.0556 (ms) / GPU bubble ratio: 76.95%
[rank3]:2025-11-06 11:46:25,158 - INFO - Avg. fwd time: 13.5452 / Avg. bwd time: 24.9510 / Avg. batch time: 367.5322 (ms) / GPU bubble ratio: 16.21%
[rank2]:2025-11-06 11:46:25,197 - INFO - Avg. fwd time: 8.4717 / Avg. bwd time: 9.7893 / Avg. batch time: 391.2275 (ms) / GPU bubble ratio: 62.66%
[rank1]:2025-11-06 11:46:25,245 - INFO - Avg. fwd time: 10.7116 / Avg. bwd time: 12.4669 / Avg. batch time: 418.2885 (ms) / GPU bubble ratio: 55.67%
[rank2]:2025-11-06 11:46:25,334 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,805  tflops: 74.67  mfu: 23.93%
[rank3]:2025-11-06 11:46:25,335 - INFO -  step: 800  loss:  1.9199  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,805  tflops: 74.68  mfu: 23.93%
[rank0]:2025-11-06 11:46:25,336 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,805  tflops: 74.67  mfu: 23.93%
[rank1]:2025-11-06 11:46:25,335 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,804  tflops: 74.67  mfu: 23.93%
[rank2]:2025-11-06 11:46:25,389 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1146_stage2_step800.svg
[rank0]:2025-11-06 11:46:25,391 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1146_stage0_step800.svg
[rank1]:2025-11-06 11:46:25,390 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1146_stage1_step800.svg
[rank3]:2025-11-06 11:46:25,475 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1146_real_step800_rank3.svg
[rank3]:> Batch Time: 403.25 ms, GPU Bubble Ratio: 82.12%, 57.15%, 66.24%, 29.13%
[rank3]:2025-11-06 11:46:25,522 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1146_stage3_step800.svg
[rank3]:2025-11-06 11:46:43,334 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 11:46:43,489 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 11:46:43,502 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 11:46:43,513 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 11:47:47,427 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:47:48,736 - INFO - Avg. fwd time: 8.8857 / Avg. bwd time: 3.4342 / Avg. batch time: 433.1462 (ms) / GPU bubble ratio: 77.25%
[rank3]:2025-11-06 11:47:48,914 - INFO - Avg. fwd time: 13.5681 / Avg. bwd time: 24.7609 / Avg. batch time: 366.1933 (ms) / GPU bubble ratio: 16.27%
[rank2]:2025-11-06 11:47:48,953 - INFO - Avg. fwd time: 8.4850 / Avg. bwd time: 9.6991 / Avg. batch time: 389.7110 (ms) / GPU bubble ratio: 62.67%
[rank1]:2025-11-06 11:47:49,000 - INFO - Avg. fwd time: 10.7280 / Avg. bwd time: 12.3533 / Avg. batch time: 416.6414 (ms) / GPU bubble ratio: 55.68%
[rank2]:2025-11-06 11:47:49,087 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,781  tflops: 74.49  mfu: 23.88%
[rank1]:2025-11-06 11:47:49,089 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,781  tflops: 74.49  mfu: 23.88%
[rank3]:2025-11-06 11:47:49,089 - INFO -  step: 850  loss:  2.0993  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,781  tflops: 74.50  mfu: 23.88%
[rank0]:2025-11-06 11:47:49,090 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,781  tflops: 74.50  mfu: 23.88%
[rank0]:2025-11-06 11:49:11,380 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-06 11:49:13,091 - INFO - Avg. fwd time: 10.7440 / Avg. bwd time: 12.2534 / Avg. batch time: 415.2291 (ms) / GPU bubble ratio: 55.69%
[rank3]:2025-11-06 11:49:13,049 - INFO - Avg. fwd time: 13.5906 / Avg. bwd time: 24.5971 / Avg. batch time: 365.0726 (ms) / GPU bubble ratio: 16.32%
[rank2]:2025-11-06 11:49:13,068 - INFO - Avg. fwd time: 8.4972 / Avg. bwd time: 9.6198 / Avg. batch time: 388.4100 (ms) / GPU bubble ratio: 62.68%
[rank2]:2025-11-06 11:49:13,104 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,751  tflops: 74.26  mfu: 23.80%
[rank2]:2025-11-06 11:49:13,153 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1149_stage2_step900.svg
[rank1]:2025-11-06 11:49:13,104 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,751  tflops: 74.26  mfu: 23.80%
[rank1]:2025-11-06 11:49:13,155 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1149_stage1_step900.svg
[rank3]:2025-11-06 11:49:13,105 - INFO -  step: 900  loss:  1.9145  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,751  tflops: 74.26  mfu: 23.80%
[rank0]:2025-11-06 11:49:13,102 - INFO - Avg. fwd time: 8.8945 / Avg. bwd time: 3.2340 / Avg. batch time: 431.5042 (ms) / GPU bubble ratio: 77.51%
[rank0]:2025-11-06 11:49:13,105 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,751  tflops: 74.26  mfu: 23.80%
[rank0]:2025-11-06 11:49:13,158 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1149_stage0_step900.svg
[rank3]:2025-11-06 11:49:13,245 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1149_real_step900_rank3.svg
[rank3]:> Batch Time: 404.75 ms, GPU Bubble Ratio: 82.16%, 57.25%, 66.30%, 28.95%
[rank3]:2025-11-06 11:49:13,288 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1149_stage3_step900.svg
[rank0]:2025-11-06 11:50:35,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:50:36,697 - INFO - Avg. fwd time: 8.9006 / Avg. bwd time: 3.0801 / Avg. batch time: 430.2563 (ms) / GPU bubble ratio: 77.72%
[rank3]:2025-11-06 11:50:36,882 - INFO - Avg. fwd time: 13.6078 / Avg. bwd time: 24.4724 / Avg. batch time: 364.2110 (ms) / GPU bubble ratio: 16.36%
[rank2]:2025-11-06 11:50:36,920 - INFO - Avg. fwd time: 8.5068 / Avg. bwd time: 9.5592 / Avg. batch time: 387.4337 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-11-06 11:50:36,967 - INFO - Avg. fwd time: 10.7555 / Avg. bwd time: 12.1770 / Avg. batch time: 414.1658 (ms) / GPU bubble ratio: 55.70%
[rank2]:2025-11-06 11:50:37,051 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,759  tflops: 74.32  mfu: 23.82%
[rank1]:2025-11-06 11:50:37,053 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,758  tflops: 74.32  mfu: 23.82%
[rank3]:2025-11-06 11:50:37,052 - INFO -  step: 950  loss:  2.1168  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,759  tflops: 74.32  mfu: 23.82%
[rank0]:2025-11-06 11:50:37,053 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,759  tflops: 74.32  mfu: 23.82%
[rank0]:2025-11-06 11:51:59,130 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:52:00,473 - INFO - Avg. fwd time: 8.9068 / Avg. bwd time: 2.9181 / Avg. batch time: 428.9188 (ms) / GPU bubble ratio: 77.94%
[rank3]:2025-11-06 11:52:00,664 - INFO - Avg. fwd time: 13.6259 / Avg. bwd time: 24.3422 / Avg. batch time: 363.3131 (ms) / GPU bubble ratio: 16.40%
[rank1]:2025-11-06 11:52:00,749 - INFO - Avg. fwd time: 10.7676 / Avg. bwd time: 12.0967 / Avg. batch time: 413.0260 (ms) / GPU bubble ratio: 55.71%
[rank2]:2025-11-06 11:52:00,701 - INFO - Avg. fwd time: 8.5169 / Avg. bwd time: 9.4955 / Avg. batch time: 386.3872 (ms) / GPU bubble ratio: 62.71%
[rank1]:2025-11-06 11:52:00,839 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,777  tflops: 74.47  mfu: 23.87%
[rank1]:2025-11-06 11:52:00,889 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1152_stage1_step1000.svg
[rank2]:2025-11-06 11:52:00,838 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,777  tflops: 74.47  mfu: 23.87%
[rank2]:2025-11-06 11:52:00,891 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1152_stage2_step1000.svg
[rank3]:2025-11-06 11:52:00,840 - INFO -  step: 1000  loss:  1.9297  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,777  tflops: 74.47  mfu: 23.87%
[rank0]:2025-11-06 11:52:00,840 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,777  tflops: 74.47  mfu: 23.87%
[rank0]:2025-11-06 11:52:00,894 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1152_stage0_step1000.svg
[rank3]:2025-11-06 11:52:00,979 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1152_real_step1000_rank3.svg
[rank3]:> Batch Time: 406.00 ms, GPU Bubble Ratio: 82.25%, 57.36%, 66.40%, 29.18%
[rank3]:2025-11-06 11:52:01,022 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1152_stage3_step1000.svg
[rank0]:2025-11-06 11:53:23,338 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 11:53:25,013 - INFO - Avg. fwd time: 8.5261 / Avg. bwd time: 9.4384 / Avg. batch time: 385.5058 (ms) / GPU bubble ratio: 62.72%
[rank3]:2025-11-06 11:53:24,993 - INFO - Avg. fwd time: 13.6441 / Avg. bwd time: 24.2276 / Avg. batch time: 362.5409 (ms) / GPU bubble ratio: 16.43%
[rank0]:2025-11-06 11:53:25,045 - INFO - Avg. fwd time: 8.9129 / Avg. bwd time: 2.7723 / Avg. batch time: 427.7831 (ms) / GPU bubble ratio: 78.15%
[rank0]:2025-11-06 11:53:25,047 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,728  tflops: 74.09  mfu: 23.75%
[rank1]:2025-11-06 11:53:25,034 - INFO - Avg. fwd time: 10.7794 / Avg. bwd time: 12.0246 / Avg. batch time: 412.0633 (ms) / GPU bubble ratio: 55.73%
[rank1]:2025-11-06 11:53:25,046 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,729  tflops: 74.09  mfu: 23.75%
[rank2]:2025-11-06 11:53:25,046 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,728  tflops: 74.09  mfu: 23.75%
[rank3]:2025-11-06 11:53:25,048 - INFO -  step: 1050  loss:  2.0989  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,729  tflops: 74.09  mfu: 23.75%
[rank0]:2025-11-06 11:54:47,394 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:54:48,725 - INFO - Avg. fwd time: 8.9173 / Avg. bwd time: 2.6585 / Avg. batch time: 426.8850 (ms) / GPU bubble ratio: 78.31%
[rank3]:2025-11-06 11:54:48,916 - INFO - Avg. fwd time: 13.6588 / Avg. bwd time: 24.1390 / Avg. batch time: 361.9492 (ms) / GPU bubble ratio: 16.46%
[rank2]:2025-11-06 11:54:48,955 - INFO - Avg. fwd time: 8.5334 / Avg. bwd time: 9.3939 / Avg. batch time: 384.8094 (ms) / GPU bubble ratio: 62.73%
[rank1]:2025-11-06 11:54:49,003 - INFO - Avg. fwd time: 10.7884 / Avg. bwd time: 11.9686 / Avg. batch time: 411.3027 (ms) / GPU bubble ratio: 55.74%
[rank3]:2025-11-06 11:54:49,093 - INFO -  step: 1100  loss:  1.9398  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,747  tflops: 74.24  mfu: 23.79%
[rank2]:2025-11-06 11:54:49,094 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,747  tflops: 74.23  mfu: 23.79%
[rank0]:2025-11-06 11:54:49,093 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,747  tflops: 74.24  mfu: 23.79%
[rank0]:2025-11-06 11:54:49,143 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1154_stage0_step1100.svg
[rank1]:2025-11-06 11:54:49,093 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,747  tflops: 74.23  mfu: 23.79%
[rank1]:2025-11-06 11:54:49,142 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1154_stage1_step1100.svg
[rank3]:2025-11-06 11:54:49,234 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1154_real_step1100_rank3.svg
[rank3]:> Batch Time: 405.75 ms, GPU Bubble Ratio: 82.23%, 57.26%, 66.35%, 28.77%
[rank2]:2025-11-06 11:54:49,144 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1154_stage2_step1100.svg
[rank3]:2025-11-06 11:54:49,278 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1154_stage3_step1100.svg
[rank0]:2025-11-06 11:56:11,633 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 11:56:12,940 - INFO - Avg. fwd time: 8.9223 / Avg. bwd time: 2.5369 / Avg. batch time: 425.9707 (ms) / GPU bubble ratio: 78.48%
[rank3]:2025-11-06 11:56:13,127 - INFO - Avg. fwd time: 13.6751 / Avg. bwd time: 24.0461 / Avg. batch time: 361.3359 (ms) / GPU bubble ratio: 16.49%
[rank2]:2025-11-06 11:56:13,165 - INFO - Avg. fwd time: 8.5415 / Avg. bwd time: 9.3468 / Avg. batch time: 384.1065 (ms) / GPU bubble ratio: 62.74%
[rank1]:2025-11-06 11:56:13,211 - INFO - Avg. fwd time: 10.7988 / Avg. bwd time: 11.9093 / Avg. batch time: 410.5331 (ms) / GPU bubble ratio: 55.75%
[rank3]:2025-11-06 11:56:13,297 - INFO -  step: 1150  loss:  2.1281  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,729  tflops: 74.10  mfu: 23.75%
[rank2]:2025-11-06 11:56:13,295 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,729  tflops: 74.10  mfu: 23.75%
[rank0]:2025-11-06 11:56:13,297 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,729  tflops: 74.10  mfu: 23.75%
[rank1]:2025-11-06 11:56:13,297 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,729  tflops: 74.10  mfu: 23.75%
[rank0]:2025-11-06 11:57:35,396 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 11:57:37,069 - INFO - Avg. fwd time: 13.6884 / Avg. bwd time: 23.9576 / Avg. batch time: 360.7354 (ms) / GPU bubble ratio: 16.51%
[rank3]:2025-11-06 11:57:37,126 - INFO -  step: 1200  loss:  1.9334  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 9,773  tflops: 74.43  mfu: 23.86%
[rank3]:2025-11-06 11:57:37,127 - INFO -  final step: 1200  loss:  1.9334  grad_norm:  0.0000  tps: 9,576  tflops: 72.93  mfu: 22.17%
[rank3]:2025-11-06 11:57:37,127 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 11:57:37,128 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 11:57:37,090 - INFO - Avg. fwd time: 8.5488 / Avg. bwd time: 9.3037 / Avg. batch time: 383.4043 (ms) / GPU bubble ratio: 62.75%
[rank2]:2025-11-06 11:57:37,124 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 12.31GiB(25.92%)  tps: 9,772  tflops: 74.43  mfu: 23.86%
[rank2]:2025-11-06 11:57:37,124 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0000  tps: 9,566  tflops: 72.86  mfu: 22.09%
[rank2]:2025-11-06 11:57:37,124 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 11:57:37,125 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 11:57:37,123 - INFO - Avg. fwd time: 8.9265 / Avg. bwd time: 2.4260 / Avg. batch time: 425.0717 (ms) / GPU bubble ratio: 78.63%
[rank0]:2025-11-06 11:57:37,126 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 17.06GiB(35.91%)  tps: 9,772  tflops: 74.43  mfu: 23.86%
[rank0]:2025-11-06 11:57:37,126 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0000  tps: 9,566  tflops: 72.86  mfu: 22.09%
[rank0]:2025-11-06 11:57:37,126 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 11:57:37,127 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-06 11:57:37,112 - INFO - Avg. fwd time: 10.8080 / Avg. bwd time: 11.8547 / Avg. batch time: 409.7698 (ms) / GPU bubble ratio: 55.76%
[rank1]:2025-11-06 11:57:37,124 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 15.23GiB(32.05%)  tps: 9,772  tflops: 74.43  mfu: 23.86%
[rank1]:2025-11-06 11:57:37,124 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0000  tps: 9,566  tflops: 72.86  mfu: 22.09%
[rank1]:2025-11-06 11:57:37,124 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 11:57:37,125 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 11:57:39,367 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1157_stage2_final1200.svg
[rank0]:2025-11-06 11:57:39,303 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-06 11:57:39,367 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1157_stage0_final1200.svg
[rank1]:2025-11-06 11:57:39,367 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1157_stage1_final1200.svg
[rank3]:2025-11-06 11:57:39,459 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1157_real_final1200_rank3.svg
[rank3]:> Batch Time: 405.50 ms, GPU Bubble Ratio: 82.24%, 57.36%, 66.39%, 29.12%
[rank2]:2025-11-06 11:57:39,529 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1157_rank2_stage2.svg
[rank2]:	> Counts Sum: 1113120, Total Sum: 1290240 (86.27%), Ratio(%) per element: [86.38, 86.27, 86.16, 86.27, 86.38, 86.27, 86.27, 86.38, 86.27, 86.27, 86.16, 86.27, 86.38, 86.16, 86.27, 86.27, 86.27, 86.04, 86.16, 86.16, 86.27, 86.27, 86.27, 86.27, 86.16, 86.6, 86.27, 86.38, 86.27, 86.27, 86.27, 86.16, 86.38, 86.38, 86.04, 86.38]
[rank2]:2025-11-06 11:57:39,529 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 11:57:39,530 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1157_rank0_stage0.svg
[rank0]:	> Counts Sum: 955560, Total Sum: 1326080 (72.06%), Ratio(%) per element: [70.98, 72.09, 70.53, 71.54, 73.1, 70.53, 74.33, 71.42, 73.43, 72.65, 72.54, 73.54, 72.76, 69.97, 72.87, 72.43, 72.32, 72.54, 71.87, 71.42, 71.31, 71.87, 73.88, 70.53, 72.54, 71.87, 72.43, 72.87, 71.2, 71.09, 72.2, 71.54, 70.87, 71.31, 72.32, 69.97, 75.33]
[rank0]:2025-11-06 11:57:39,530 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-06 11:57:39,520 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1157_rank1_stage1.svg
[rank1]:	> Counts Sum: 1121840, Total Sum: 1612800 (69.56%), Ratio(%) per element: [69.53, 69.53, 70.42, 69.41, 69.86, 69.19, 70.87, 71.09, 68.63, 68.08, 69.53, 70.08, 69.75, 69.19, 69.64, 69.53, 69.64, 69.86, 70.31, 69.08, 69.41, 68.52, 69.97, 69.86, 69.41, 68.97, 68.97, 70.42, 68.86, 69.41, 70.08, 69.97, 69.08, 67.74, 69.64, 71.31, 70.64, 69.08, 69.64, 69.53, 69.41, 68.3, 68.97, 69.86, 69.64]
[rank1]:2025-11-06 11:57:39,521 - INFO - Destroying the purge thread.
[rank3]:2025-11-06 11:57:39,608 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1157_thry_final1200_rank3.svg
[rank3]:> Batch Time: 351.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-06 11:57:39,654 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1157_stage3_final1200.svg
[rank2]:2025-11-06 11:57:39,628 - INFO - Process group destroyed
[rank1]:2025-11-06 11:57:39,618 - INFO - Process group destroyed
[rank3]:2025-11-06 11:57:39,819 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1157_rank3_stage3.svg
[rank3]:	> Counts Sum: 328200, Total Sum: 1039360 (31.58%), Ratio(%) per element: [31.36, 30.8, 32.14, 32.03, 31.8, 31.36, 30.46, 32.25, 33.59, 31.25, 31.47, 32.03, 31.36, 32.03, 32.25, 31.47, 30.91, 32.36, 30.46, 31.8, 31.25, 33.03, 30.69, 31.02, 31.8, 31.13, 30.8, 32.25, 30.46]
[rank3]:2025-11-06 11:57:39,820 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 23-24, summary, console lines 285-297
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.71102
[rank3]:wandb:               final/avg_loss 1.93343
[rank3]:wandb:             final/avg_mfu(%) 22.17402
[rank3]:wandb:             final/avg_tflops 72.9295
[rank3]:wandb:    final/avg_throughput(tps) 9575.55956
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 1.93343
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 1.93343
[rank3]:wandb: loss_metrics/global_max_loss 1.93343
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_GPipe_timelyapf_th0.1_m80_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/nwz6kluj
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_GPipe_timelyapf_th0.1_m80_dm1/20251106-1121/wandb/run-20251106_112157-nwz6kluj/logs
[rank3]:2025-11-06 11:57:41,111 - INFO - Process group destroyed
[rank0]:2025-11-06 11:57:41,530 - INFO - Training completed
[rank0]:2025-11-06 11:57:41,530 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 11:57:41,622 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'layers.1', 'layers.3', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.8', 'layers.7', 'layers.6', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'norm', 'output', 'layers.15', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: monitoring steps = 50 -> 80"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_GPipe_timelyapf_th0.1_m80_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.1
[rank3]:		- percentile: 70
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
