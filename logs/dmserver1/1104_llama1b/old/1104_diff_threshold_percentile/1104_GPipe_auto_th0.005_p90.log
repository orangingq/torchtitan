
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 06. (ëª©) 01:30:43 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_GPipe_auto_th0.005_p90.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.005 --freezing.percentile=90
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-06 01:30:49,675 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-06 01:30:49,681 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-11-06 01:30:49,694 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-11-06 01:30:49,811 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-06 01:30:49,905 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-06 01:30:49,908 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 01:30:49,911 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-06 01:30:49,938 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-06 01:30:49,940 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-06 01:30:49,949 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-06 01:30:49,952 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-06 01:30:50,048 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-06 01:30:50,050 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 01:30:50,487 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-06 01:30:50,861 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-11-06 01:30:53,716 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-06 01:30:53,753 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 01:30:53,780 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-06 01:30:53,781 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-06 01:30:53,941 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-06 01:30:53,953 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 01:30:53,954 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-06 01:30:53,954 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-06 01:30:54,089 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-06 01:30:54,137 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 01:30:54,139 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-06 01:30:54,165 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-06 01:30:54,165 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-06 01:30:54,091 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-06 01:30:54,136 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 01:30:54,165 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-06 01:30:54,165 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-06 01:30:54,351 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 01:30:54,351 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-06 01:30:54,352 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-06 01:30:54,341 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 01:30:54,341 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-06 01:30:54,342 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ugzht7yu
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1_th0.005_p90/20251106-0130/wandb/run-20251106_013054-ugzht7yu
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_GPipe_auto_dm1_th0.005_p90
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ugzht7yu
[rank3]:2025-11-06 01:30:55,736 - INFO - WandB logging enabled
[rank3]:2025-11-06 01:30:55,737 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-06 01:30:55,774 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 01:30:55,802 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-06 01:30:55,803 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-11-06 01:30:55,976 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 01:30:55,977 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-06 01:30:55,978 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-11-06 01:30:55,992 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_GPipe_auto_dm1_th0.005_p90
[rank0]:2025-11-06 01:30:55,992 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 01:30:55,993 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-06 01:30:55,993 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-06 01:30:55,992 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-06 01:30:55,992 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-06 01:30:55,992 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 01:30:58,175 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-06 01:30:58,175 - INFO - Finished loading the checkpoint in 2.18 seconds.
[rank0]:2025-11-06 01:30:58,175 - INFO - Training starts at step 1
[rank0]:2025-11-06 01:31:01,283 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8865  memory: 12.80GiB(26.95%)  tps: 2,293  tflops: 17.46  mfu: 5.60%
[rank0]:2025-11-06 01:31:01,284 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-06 01:31:01,251 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8865  memory: 12.38GiB(26.05%)  tps: 2,185  tflops: 16.64  mfu: 5.33%
[rank1]:2025-11-06 01:31:01,251 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-06 01:31:01,258 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8865  memory: 24.19GiB(50.91%)  tps: 2,989  tflops: 22.76  mfu: 7.30%
[rank3]:2025-11-06 01:31:01,259 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-06 01:31:01,247 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8865  memory:  9.99GiB(21.03%)  tps: 2,304  tflops: 17.55  mfu: 5.62%
[rank2]:2025-11-06 01:31:01,247 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 01:33:02,840 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:33:05,077 - INFO - Avg. fwd time: 11.2276 / Avg. bwd time: 44.3540 / Avg. batch time: 504.5307 (ms) / GPU bubble ratio: 11.87%
[rank2]:2025-11-06 01:33:05,151 - INFO - Avg. fwd time: 7.1211 / Avg. bwd time: 18.7437 / Avg. batch time: 536.4481 (ms) / GPU bubble ratio: 61.43%
[rank0]:2025-11-06 01:33:05,198 - INFO - Avg. fwd time: 7.8234 / Avg. bwd time: 23.3804 / Avg. batch time: 612.5852 (ms) / GPU bubble ratio: 59.25%
[rank1]:2025-11-06 01:33:05,190 - INFO - Avg. fwd time: 9.0281 / Avg. bwd time: 23.7961 / Avg. batch time: 575.6588 (ms) / GPU bubble ratio: 54.38%
[rank0]:2025-11-06 01:33:05,384 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3647  memory: 16.57GiB(34.88%)  tps: 6,469  tflops: 49.27  mfu: 15.79%
[rank1]:2025-11-06 01:33:05,373 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3647  memory: 14.64GiB(30.82%)  tps: 6,468  tflops: 49.26  mfu: 15.79%
[rank3]:2025-11-06 01:33:05,382 - INFO -  step: 50  loss:  9.2057  grad_norm: 15.3647  memory: 26.98GiB(56.79%)  tps: 6,468  tflops: 49.26  mfu: 15.79%
[rank2]:2025-11-06 01:33:05,369 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3647  memory: 11.81GiB(24.85%)  tps: 6,468  tflops: 49.26  mfu: 15.79%
[rank0]:2025-11-06 01:33:30,939 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-06 01:33:30,927 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-06 01:33:30,922 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-06 01:33:30,934 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-06 01:33:56,411 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.5151e+01
[rank1]:2025-11-06 01:33:56,400 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5938e+00
[rank2]:2025-11-06 01:33:56,396 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.4837e+00
[rank3]:2025-11-06 01:33:56,407 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1558e+01
[rank1]:2025-11-06 01:34:19,844 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 4.0588e+00
[rank2]:2025-11-06 01:34:19,839 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3582e+00
[rank3]:2025-11-06 01:34:19,843 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9370e+00
[rank0]:2025-11-06 01:34:19,851 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.5860e+00
[rank2]:2025-11-06 01:34:45,192 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0906e+00
[rank0]:2025-11-06 01:34:45,207 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 6.4650e+01
[rank1]:2025-11-06 01:34:45,192 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.0225e+00
[rank3]:2025-11-06 01:34:45,203 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9598e+01
[rank0]:2025-11-06 01:35:06,145 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:35:08,173 - INFO - Avg. fwd time: 11.3588 / Avg. bwd time: 43.5160 / Avg. batch time: 498.7698 (ms) / GPU bubble ratio: 11.98%
[rank2]:2025-11-06 01:35:08,230 - INFO - Avg. fwd time: 7.2060 / Avg. bwd time: 18.2076 / Avg. batch time: 529.6594 (ms) / GPU bubble ratio: 61.62%
[rank0]:2025-11-06 01:35:08,313 - INFO - Avg. fwd time: 7.8683 / Avg. bwd time: 22.9653 / Avg. batch time: 604.4591 (ms) / GPU bubble ratio: 59.19%
[rank1]:2025-11-06 01:35:08,337 - INFO - Avg. fwd time: 9.0728 / Avg. bwd time: 23.7074 / Avg. batch time: 568.3641 (ms) / GPU bubble ratio: 53.86%
[rank1]:2025-11-06 01:35:08,506 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.3009e+00
[rank1]:2025-11-06 01:35:08,507 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.1370  memory: 14.64GiB(30.82%)  tps: 6,653  tflops: 50.67  mfu: 16.24%
[rank2]:2025-11-06 01:35:08,490 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5373e+00
[rank2]:2025-11-06 01:35:08,490 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.1370  memory: 11.83GiB(24.89%)  tps: 6,654  tflops: 50.68  mfu: 16.24%
[rank3]:2025-11-06 01:35:08,505 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7800e+00
[rank3]:2025-11-06 01:35:08,508 - INFO -  step: 100  loss:  3.0570  grad_norm: 22.1370  memory: 28.29GiB(59.55%)  tps: 6,653  tflops: 50.67  mfu: 16.24%
[rank0]:2025-11-06 01:35:08,513 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.6898e+00
[rank0]:2025-11-06 01:35:08,514 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.1370  memory: 16.57GiB(34.88%)  tps: 6,653  tflops: 50.67  mfu: 16.24%
[rank0]:2025-11-06 01:35:08,579 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0135_stage0_step100.svg
[rank1]:2025-11-06 01:35:08,586 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0135_stage1_step100.svg
[rank2]:2025-11-06 01:35:08,584 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0135_stage2_step100.svg
[rank3]:2025-11-06 01:35:08,684 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0135_real_step100_rank3.svg
[rank3]:> Batch Time: 566.19 ms, GPU Bubble Ratio: 58.70%, 52.87%, 72.82%, 27.56%
[rank3]:2025-11-06 01:35:08,728 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0135_stage3_step100.svg
[rank0]:2025-11-06 01:35:34,021 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.9186e+01
[rank1]:2025-11-06 01:35:34,005 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0619e+00
[rank2]:2025-11-06 01:35:34,006 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0378e+00
[rank3]:2025-11-06 01:35:34,017 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.1566e+00
[rank2]:2025-11-06 01:35:57,290 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.8872e+00
[rank0]:2025-11-06 01:35:57,313 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4690e+01
[rank1]:2025-11-06 01:35:57,306 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3116e+01
[rank3]:2025-11-06 01:35:57,306 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4573e+00
[rank1]:2025-11-06 01:36:22,274 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6243e+00
[rank0]:2025-11-06 01:36:22,286 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.6732e+00
[rank3]:2025-11-06 01:36:22,290 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1538e+00
[rank2]:2025-11-06 01:36:22,278 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1677e+00
[rank1]:2025-11-06 01:36:45,596 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1878e+00
[rank0]:2025-11-06 01:36:45,603 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.7890e+00
[rank3]:2025-11-06 01:36:45,595 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.8109e+00
[rank2]:2025-11-06 01:36:45,580 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5920e+00
[rank0]:2025-11-06 01:37:07,942 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 01:37:10,361 - INFO - Avg. fwd time: 7.3445 / Avg. bwd time: 17.2584 / Avg. batch time: 525.9139 (ms) / GPU bubble ratio: 62.58%
[rank3]:2025-11-06 01:37:10,336 - INFO - Avg. fwd time: 11.4192 / Avg. bwd time: 43.1050 / Avg. batch time: 495.9263 (ms) / GPU bubble ratio: 12.04%
[rank1]:2025-11-06 01:37:10,380 - INFO - Avg. fwd time: 9.2346 / Avg. bwd time: 22.6658 / Avg. batch time: 563.4995 (ms) / GPU bubble ratio: 54.71%
[rank1]:2025-11-06 01:37:10,415 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.7578e+00
[rank1]:2025-11-06 01:37:10,416 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.8456  memory: 14.66GiB(30.86%)  tps: 6,720  tflops: 51.18  mfu: 16.40%
[rank0]:2025-11-06 01:37:10,405 - INFO - Avg. fwd time: 7.9896 / Avg. bwd time: 22.0710 / Avg. batch time: 598.5844 (ms) / GPU bubble ratio: 59.82%
[rank0]:2025-11-06 01:37:10,435 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.0068e+00
[rank0]:2025-11-06 01:37:10,435 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.8456  memory: 16.57GiB(34.88%)  tps: 6,719  tflops: 51.17  mfu: 16.40%
[rank2]:2025-11-06 01:37:10,427 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4493e+00
[rank2]:2025-11-06 01:37:10,427 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.8456  memory: 11.83GiB(24.89%)  tps: 6,718  tflops: 51.17  mfu: 16.40%
[rank3]:2025-11-06 01:37:10,438 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0182e+00
[rank3]:2025-11-06 01:37:10,442 - INFO -  step: 150  loss:  0.5124  grad_norm:  5.8456  memory: 28.29GiB(59.55%)  tps: 6,718  tflops: 51.17  mfu: 16.40%
[rank1]:2025-11-06 01:37:33,742 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1007e-01
[rank0]:2025-11-06 01:37:33,749 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4678e+00
[rank2]:2025-11-06 01:37:33,725 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.9781e-01
[rank3]:2025-11-06 01:37:33,741 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5866e+00
[rank1]:2025-11-06 01:37:58,356 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4696e+01
[rank0]:2025-11-06 01:37:58,371 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2481e+01
[rank2]:2025-11-06 01:37:58,368 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9953e+01
[rank3]:2025-11-06 01:37:58,379 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6937e+01
[rank1]:2025-11-06 01:38:20,839 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6731e+00
[rank0]:2025-11-06 01:38:20,854 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4961e+00
[rank3]:2025-11-06 01:38:20,854 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6514e+00
[rank2]:2025-11-06 01:38:20,839 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9801e+00
[rank2]:2025-11-06 01:38:45,505 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2918e-01
[rank1]:2025-11-06 01:38:45,493 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4786e-01
[rank0]:2025-11-06 01:38:45,509 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7418e-01
[rank3]:2025-11-06 01:38:45,517 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9533e-01
[rank0]:2025-11-06 01:39:05,773 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:39:07,745 - INFO - Avg. fwd time: 11.4616 / Avg. bwd time: 42.7711 / Avg. batch time: 493.5765 (ms) / GPU bubble ratio: 12.10%
[rank2]:2025-11-06 01:39:07,804 - INFO - Avg. fwd time: 7.4401 / Avg. bwd time: 16.6370 / Avg. batch time: 522.7921 (ms) / GPU bubble ratio: 63.16%
[rank1]:2025-11-06 01:39:07,855 - INFO - Avg. fwd time: 9.4636 / Avg. bwd time: 21.0778 / Avg. batch time: 558.6880 (ms) / GPU bubble ratio: 56.27%
[rank0]:2025-11-06 01:39:07,833 - INFO - Avg. fwd time: 8.1621 / Avg. bwd time: 20.8788 / Avg. batch time: 592.5295 (ms) / GPU bubble ratio: 60.79%
[rank2]:2025-11-06 01:39:08,038 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.2793e-01
[rank2]:2025-11-06 01:39:08,038 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4299  memory: 11.83GiB(24.89%)  tps: 6,965  tflops: 53.05  mfu: 17.00%
[rank1]:2025-11-06 01:39:08,038 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9805e-01
[rank1]:2025-11-06 01:39:08,038 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4299  memory: 14.66GiB(30.86%)  tps: 6,965  tflops: 53.04  mfu: 17.00%
[rank1]:2025-11-06 01:39:08,111 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0139_stage1_step200.svg
[rank0]:2025-11-06 01:39:08,053 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6325e-01
[rank0]:2025-11-06 01:39:08,053 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4299  memory: 16.57GiB(34.88%)  tps: 6,965  tflops: 53.05  mfu: 17.00%
[rank0]:2025-11-06 01:39:08,109 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0139_stage0_step200.svg
[rank3]:2025-11-06 01:39:08,053 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3573e-01
[rank3]:2025-11-06 01:39:08,057 - INFO -  step: 200  loss:  0.2481  grad_norm:  0.4299  memory: 28.29GiB(59.55%)  tps: 6,965  tflops: 53.05  mfu: 17.00%
[rank2]:2025-11-06 01:39:08,110 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0139_stage2_step200.svg
[rank3]:2025-11-06 01:39:08,203 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0139_real_step200_rank3.svg
[rank3]:> Batch Time: 594.36 ms, GPU Bubble Ratio: 66.65%, 67.99%, 65.19%, 25.66%
[rank3]:2025-11-06 01:39:08,249 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0139_stage3_step200.svg
[rank1]:2025-11-06 01:39:32,948 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0600e-01
[rank2]:2025-11-06 01:39:32,960 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2446e-01
[rank3]:2025-11-06 01:39:32,972 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8164e-01
[rank0]:2025-11-06 01:39:32,964 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3091e-01
[rank1]:2025-11-06 01:39:55,526 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5920e-01
[rank0]:2025-11-06 01:39:55,541 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7786e-01
[rank2]:2025-11-06 01:39:55,526 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.9608e-01
[rank3]:2025-11-06 01:39:55,542 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8460e-01
[rank1]:2025-11-06 01:40:20,319 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.3293e-01
[rank0]:2025-11-06 01:40:20,335 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6885e+00
[rank2]:2025-11-06 01:40:20,331 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7217e-01
[rank3]:2025-11-06 01:40:20,343 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.3257e-01
[rank1]:2025-11-06 01:40:42,885 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2999e+00
[rank0]:2025-11-06 01:40:42,900 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4919e+00
[rank2]:2025-11-06 01:40:42,885 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.5340e-01
[rank3]:2025-11-06 01:40:42,900 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.5894e-01
[rank0]:2025-11-06 01:41:05,187 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:41:07,379 - INFO - Avg. fwd time: 11.4889 / Avg. bwd time: 42.6950 / Avg. batch time: 493.1787 (ms) / GPU bubble ratio: 12.11%
[rank1]:2025-11-06 01:41:07,434 - INFO - Avg. fwd time: 9.7012 / Avg. bwd time: 19.4104 / Avg. batch time: 556.2121 (ms) / GPU bubble ratio: 58.13%
[rank0]:2025-11-06 01:41:07,400 - INFO - Avg. fwd time: 8.3216 / Avg. bwd time: 19.7880 / Avg. batch time: 588.9244 (ms) / GPU bubble ratio: 61.82%
[rank2]:2025-11-06 01:41:07,455 - INFO - Avg. fwd time: 7.4907 / Avg. bwd time: 16.3332 / Avg. batch time: 522.0917 (ms) / GPU bubble ratio: 63.49%
[rank1]:2025-11-06 01:41:07,646 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6038e-01
[rank1]:2025-11-06 01:41:07,647 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2680  memory: 14.66GiB(30.86%)  tps: 6,849  tflops: 52.16  mfu: 16.72%
[rank0]:2025-11-06 01:41:07,662 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1241e+00
[rank0]:2025-11-06 01:41:07,662 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2680  memory: 16.57GiB(34.88%)  tps: 6,849  tflops: 52.16  mfu: 16.72%
[rank2]:2025-11-06 01:41:07,658 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0041e-01
[rank2]:2025-11-06 01:41:07,658 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2680  memory: 11.83GiB(24.89%)  tps: 6,848  tflops: 52.16  mfu: 16.72%
[rank3]:2025-11-06 01:41:07,670 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8078e-01
[rank3]:2025-11-06 01:41:07,673 - INFO -  step: 250  loss:  0.2553  grad_norm:  0.2680  memory: 28.29GiB(59.55%)  tps: 6,849  tflops: 52.16  mfu: 16.72%
[rank1]:2025-11-06 01:41:30,171 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0388e-01
[rank0]:2025-11-06 01:41:30,186 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0677e-01
[rank2]:2025-11-06 01:41:30,171 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.2854e-01
[rank3]:2025-11-06 01:41:30,187 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.5766e-01
[rank1]:2025-11-06 01:41:54,931 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6436e-01
[rank3]:2025-11-06 01:41:54,955 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4838e-01
[rank0]:2025-11-06 01:41:54,946 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7889e-01
[rank2]:2025-11-06 01:41:54,943 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7326e-01
[rank1]:2025-11-06 01:42:17,454 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8190e+00
[rank2]:2025-11-06 01:42:17,454 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1497e+00
[rank3]:2025-11-06 01:42:17,471 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2309e+00
[rank0]:2025-11-06 01:42:17,470 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9293e+00
[rank1]:2025-11-06 01:42:42,098 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3819e+00
[rank0]:2025-11-06 01:42:42,113 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8258e+00
[rank2]:2025-11-06 01:42:42,109 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6212e+00
[rank3]:2025-11-06 01:42:42,121 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7692e+00
[rank0]:2025-11-06 01:43:02,320 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:43:04,514 - INFO - Avg. fwd time: 11.5217 / Avg. bwd time: 42.5023 / Avg. batch time: 491.8932 (ms) / GPU bubble ratio: 12.14%
[rank0]:2025-11-06 01:43:04,575 - INFO - Avg. fwd time: 8.4229 / Avg. bwd time: 19.0771 / Avg. batch time: 585.3261 (ms) / GPU bubble ratio: 62.41%
[rank0]:2025-11-06 01:43:04,600 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.8403e-01
[rank0]:2025-11-06 01:43:04,600 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2164  memory: 16.57GiB(34.88%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank1]:2025-11-06 01:43:04,552 - INFO - Avg. fwd time: 9.8527 / Avg. bwd time: 18.3233 / Avg. batch time: 553.3521 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-11-06 01:43:04,584 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0293e-01
[rank1]:2025-11-06 01:43:04,585 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2164  memory: 14.66GiB(30.86%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank2]:2025-11-06 01:43:04,533 - INFO - Avg. fwd time: 7.5426 / Avg. bwd time: 16.0010 / Avg. batch time: 520.3856 (ms) / GPU bubble ratio: 63.81%
[rank2]:2025-11-06 01:43:04,585 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0211e-01
[rank2]:2025-11-06 01:43:04,585 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2164  memory: 11.83GiB(24.89%)  tps: 7,006  tflops: 53.36  mfu: 17.10%
[rank3]:2025-11-06 01:43:04,600 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0192e-01
[rank3]:2025-11-06 01:43:04,603 - INFO -  step: 300  loss:  0.2361  grad_norm:  0.2164  memory: 28.29GiB(59.55%)  tps: 7,006  tflops: 53.36  mfu: 17.10%
[rank0]:2025-11-06 01:43:04,652 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0143_stage0_step300.svg
[rank1]:2025-11-06 01:43:04,657 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0143_stage1_step300.svg
[rank2]:2025-11-06 01:43:04,656 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0143_stage2_step300.svg
[rank3]:2025-11-06 01:43:04,761 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0143_real_step300_rank3.svg
[rank3]:> Batch Time: 544.84 ms, GPU Bubble Ratio: 63.65%, 65.10%, 71.62%, 25.06%
[rank3]:2025-11-06 01:43:04,805 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0143_stage3_step300.svg
[rank0]:2025-11-06 01:43:29,396 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0855e+00
[rank2]:2025-11-06 01:43:29,392 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2834e-01
[rank1]:2025-11-06 01:43:29,381 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3463e+00
[rank3]:2025-11-06 01:43:29,404 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1967e-01
[rank0]:2025-11-06 01:43:51,865 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3317e+00
[rank2]:2025-11-06 01:43:51,850 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8074e-01
[rank1]:2025-11-06 01:43:51,850 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.1607e-01
[rank3]:2025-11-06 01:43:51,866 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.0440e-01
[rank1]:2025-11-06 01:44:16,522 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.3818e-01
[rank0]:2025-11-06 01:44:16,538 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4188e+00
[rank2]:2025-11-06 01:44:16,534 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7724e-01
[rank3]:2025-11-06 01:44:16,546 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2380e-01
[rank0]:2025-11-06 01:44:39,030 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0480e-01
[rank2]:2025-11-06 01:44:39,015 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.3861e-01
[rank1]:2025-11-06 01:44:39,015 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1696e-01
[rank3]:2025-11-06 01:44:39,031 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5662e-01
[rank0]:2025-11-06 01:45:01,209 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:45:03,386 - INFO - Avg. fwd time: 11.5291 / Avg. bwd time: 42.4767 / Avg. batch time: 491.7410 (ms) / GPU bubble ratio: 12.14%
[rank0]:2025-11-06 01:45:03,408 - INFO - Avg. fwd time: 8.4845 / Avg. bwd time: 18.6385 / Avg. batch time: 583.9588 (ms) / GPU bubble ratio: 62.84%
[rank2]:2025-11-06 01:45:03,462 - INFO - Avg. fwd time: 7.5539 / Avg. bwd time: 15.9254 / Avg. batch time: 520.1918 (ms) / GPU bubble ratio: 63.89%
[rank1]:2025-11-06 01:45:03,443 - INFO - Avg. fwd time: 9.9436 / Avg. bwd time: 17.6516 / Avg. batch time: 552.4409 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-11-06 01:45:03,665 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0919e-01
[rank0]:2025-11-06 01:45:03,666 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1967  memory: 16.57GiB(34.88%)  tps: 6,880  tflops: 52.40  mfu: 16.80%
[rank2]:2025-11-06 01:45:03,661 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0273e-01
[rank2]:2025-11-06 01:45:03,662 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1967  memory: 11.83GiB(24.89%)  tps: 6,880  tflops: 52.40  mfu: 16.79%
[rank1]:2025-11-06 01:45:03,650 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5895e+00
[rank1]:2025-11-06 01:45:03,650 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1967  memory: 14.66GiB(30.86%)  tps: 6,880  tflops: 52.40  mfu: 16.80%
[rank3]:2025-11-06 01:45:03,674 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1549e-01
[rank3]:2025-11-06 01:45:03,677 - INFO -  step: 350  loss:  0.2432  grad_norm:  0.1967  memory: 28.29GiB(59.55%)  tps: 6,880  tflops: 52.40  mfu: 16.79%
[rank1]:2025-11-06 01:45:26,114 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.8747e-01
[rank0]:2025-11-06 01:45:26,129 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2512e+00
[rank2]:2025-11-06 01:45:26,113 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.4718e-01
[rank3]:2025-11-06 01:45:26,129 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.5822e-01
[rank0]:2025-11-06 01:45:50,717 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2986e+00
[rank2]:2025-11-06 01:45:50,713 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1512e+00
[rank3]:2025-11-06 01:45:50,725 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2070e+00
[rank1]:2025-11-06 01:45:50,701 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0901e+00
[rank0]:2025-11-06 01:46:13,202 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8914e-01
[rank2]:2025-11-06 01:46:13,186 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.0234e-01
[rank3]:2025-11-06 01:46:13,202 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0331e+00
[rank1]:2025-11-06 01:46:13,186 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1208e-01
[rank1]:2025-11-06 01:46:37,804 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6245e+00
[rank0]:2025-11-06 01:46:37,819 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3132e+00
[rank2]:2025-11-06 01:46:37,815 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.7515e-01
[rank3]:2025-11-06 01:46:37,826 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7175e-01
[rank0]:2025-11-06 01:46:58,005 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 01:47:00,015 - INFO - Avg. fwd time: 7.5756 / Avg. bwd time: 15.7743 / Avg. batch time: 519.2420 (ms) / GPU bubble ratio: 64.02%
[rank3]:2025-11-06 01:46:59,958 - INFO - Avg. fwd time: 11.5413 / Avg. bwd time: 42.3736 / Avg. batch time: 491.0064 (ms) / GPU bubble ratio: 12.16%
[rank0]:2025-11-06 01:47:00,043 - INFO - Avg. fwd time: 8.5379 / Avg. bwd time: 18.2517 / Avg. batch time: 581.9741 (ms) / GPU bubble ratio: 63.17%
[rank1]:2025-11-06 01:47:00,066 - INFO - Avg. fwd time: 10.0230 / Avg. bwd time: 17.0594 / Avg. batch time: 550.8585 (ms) / GPU bubble ratio: 60.67%
[rank2]:2025-11-06 01:47:00,252 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1111e+00
[rank2]:2025-11-06 01:47:00,253 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4901  memory: 11.83GiB(24.89%)  tps: 7,026  tflops: 53.51  mfu: 17.15%
[rank0]:2025-11-06 01:47:00,267 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7514e+00
[rank0]:2025-11-06 01:47:00,268 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4901  memory: 16.57GiB(34.88%)  tps: 7,026  tflops: 53.51  mfu: 17.15%
[rank3]:2025-11-06 01:47:00,268 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3291e+00
[rank3]:2025-11-06 01:47:00,271 - INFO -  step: 400  loss:  0.2428  grad_norm:  0.4901  memory: 28.29GiB(59.55%)  tps: 7,026  tflops: 53.51  mfu: 17.15%
[rank1]:2025-11-06 01:47:00,252 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0877e+00
[rank1]:2025-11-06 01:47:00,253 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4901  memory: 14.66GiB(30.86%)  tps: 7,026  tflops: 53.51  mfu: 17.15%
[rank1]:2025-11-06 01:47:00,329 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0147_stage1_step400.svg
[rank2]:2025-11-06 01:47:00,327 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0147_stage2_step400.svg
[rank0]:2025-11-06 01:47:00,327 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0147_stage0_step400.svg
[rank3]:2025-11-06 01:47:00,418 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0147_real_step400_rank3.svg
[rank3]:> Batch Time: 546.84 ms, GPU Bubble Ratio: 63.82%, 65.28%, 71.78%, 24.68%
[rank3]:2025-11-06 01:47:00,466 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0147_stage3_step400.svg
[rank3]:2025-11-06 01:47:13,122 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 01:47:13,337 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 01:47:13,350 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 01:47:13,369 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 01:47:25,012 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9934e-01
[rank0]:2025-11-06 01:47:25,015 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5931e+00
[rank3]:2025-11-06 01:47:25,023 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4271e-01
[rank1]:2025-11-06 01:47:25,000 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0878e+00
[rank2]:2025-11-06 01:47:47,449 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0171e+00
[rank0]:2025-11-06 01:47:47,464 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8942e+00
[rank3]:2025-11-06 01:47:47,464 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5692e-01
[rank1]:2025-11-06 01:47:47,449 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1785e+00
[rank0]:2025-11-06 01:48:12,051 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3485e-01
[rank2]:2025-11-06 01:48:12,047 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1007e-01
[rank3]:2025-11-06 01:48:12,059 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5766e-01
[rank1]:2025-11-06 01:48:12,036 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0374e-01
[rank2]:2025-11-06 01:48:34,524 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7389e+00
[rank0]:2025-11-06 01:48:34,539 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1846e-01
[rank3]:2025-11-06 01:48:34,539 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9527e+00
[rank1]:2025-11-06 01:48:34,523 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1761e+00
[rank0]:2025-11-06 01:48:56,703 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:48:59,084 - INFO - Avg. fwd time: 11.5424 / Avg. bwd time: 42.3717 / Avg. batch time: 490.9962 (ms) / GPU bubble ratio: 12.16%
[rank2]:2025-11-06 01:48:59,112 - INFO - Avg. fwd time: 7.5787 / Avg. bwd time: 15.7460 / Avg. batch time: 519.2167 (ms) / GPU bubble ratio: 64.06%
[rank0]:2025-11-06 01:48:59,155 - INFO - Avg. fwd time: 8.5778 / Avg. bwd time: 17.9550 / Avg. batch time: 581.1514 (ms) / GPU bubble ratio: 63.48%
[rank1]:2025-11-06 01:48:59,132 - INFO - Avg. fwd time: 10.0827 / Avg. bwd time: 16.6038 / Avg. batch time: 550.3453 (ms) / GPU bubble ratio: 61.21%
[rank1]:2025-11-06 01:48:59,165 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9132e-01
[rank1]:2025-11-06 01:48:59,166 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2005  memory: 14.66GiB(30.86%)  tps: 6,889  tflops: 52.47  mfu: 16.82%
[rank2]:2025-11-06 01:48:59,177 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8254e-01
[rank2]:2025-11-06 01:48:59,177 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2005  memory: 11.83GiB(24.89%)  tps: 6,888  tflops: 52.46  mfu: 16.82%
[rank0]:2025-11-06 01:48:59,180 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1060e+00
[rank0]:2025-11-06 01:48:59,181 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2005  memory: 16.57GiB(34.88%)  tps: 6,889  tflops: 52.47  mfu: 16.82%
[rank3]:2025-11-06 01:48:59,189 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4843e+00
[rank3]:2025-11-06 01:48:59,193 - INFO -  step: 450  loss:  0.2412  grad_norm:  0.2005  memory: 28.29GiB(59.55%)  tps: 6,889  tflops: 52.47  mfu: 16.82%
[rank2]:2025-11-06 01:49:21,729 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6063e+00
[rank0]:2025-11-06 01:49:21,744 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9781e+00
[rank1]:2025-11-06 01:49:21,729 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5155e+00
[rank3]:2025-11-06 01:49:21,744 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9580e+00
[rank2]:2025-11-06 01:49:46,467 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.8126e-01
[rank1]:2025-11-06 01:49:46,455 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.9856e-01
[rank0]:2025-11-06 01:49:46,470 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5546e+00
[rank3]:2025-11-06 01:49:46,479 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9686e-01
[rank2]:2025-11-06 01:50:09,046 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1611e-01
[rank1]:2025-11-06 01:50:09,046 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2523e-01
[rank3]:2025-11-06 01:50:09,062 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8348e-01
[rank0]:2025-11-06 01:50:09,062 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5879e+00
[rank2]:2025-11-06 01:50:33,814 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1747e+00
[rank1]:2025-11-06 01:50:33,802 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1149e+00
[rank3]:2025-11-06 01:50:33,826 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3438e+00
[rank0]:2025-11-06 01:50:33,818 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2185e+00
[rank0]:2025-11-06 01:50:54,095 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:50:56,088 - INFO - Avg. fwd time: 11.5566 / Avg. bwd time: 42.3213 / Avg. batch time: 490.7051 (ms) / GPU bubble ratio: 12.16%
[rank2]:2025-11-06 01:50:56,146 - INFO - Avg. fwd time: 7.5960 / Avg. bwd time: 15.6371 / Avg. batch time: 518.7798 (ms) / GPU bubble ratio: 64.17%
[rank1]:2025-11-06 01:50:56,197 - INFO - Avg. fwd time: 10.1258 / Avg. bwd time: 16.2919 / Avg. batch time: 549.5741 (ms) / GPU bubble ratio: 61.54%
[rank0]:2025-11-06 01:50:56,174 - INFO - Avg. fwd time: 8.6059 / Avg. bwd time: 17.7517 / Avg. batch time: 580.1691 (ms) / GPU bubble ratio: 63.66%
[rank2]:2025-11-06 01:50:56,380 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5536e+00
[rank2]:2025-11-06 01:50:56,380 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4662  memory: 11.83GiB(24.89%)  tps: 6,990  tflops: 53.23  mfu: 17.06%
[rank1]:2025-11-06 01:50:56,380 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2501e+00
[rank1]:2025-11-06 01:50:56,380 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4662  memory: 14.66GiB(30.86%)  tps: 6,989  tflops: 53.23  mfu: 17.06%
[rank3]:2025-11-06 01:50:56,396 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3307e+00
[rank3]:2025-11-06 01:50:56,399 - INFO -  step: 500  loss:  0.2651  grad_norm:  0.4662  memory: 28.29GiB(59.55%)  tps: 6,989  tflops: 53.23  mfu: 17.06%
[rank0]:2025-11-06 01:50:56,395 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1366e+00
[rank0]:2025-11-06 01:50:56,396 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4662  memory: 16.57GiB(34.88%)  tps: 6,989  tflops: 53.23  mfu: 17.06%
[rank2]:2025-11-06 01:50:56,451 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0150_stage2_step500.svg
[rank1]:2025-11-06 01:50:56,452 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0150_stage1_step500.svg
[rank0]:2025-11-06 01:50:56,450 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0150_stage0_step500.svg
[rank3]:2025-11-06 01:50:56,549 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0150_real_step500_rank3.svg
[rank3]:> Batch Time: 593.85 ms, GPU Bubble Ratio: 66.66%, 68.01%, 65.18%, 25.44%
[rank3]:2025-11-06 01:50:56,592 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0150_stage3_step500.svg
[rank2]:2025-11-06 01:51:21,341 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4741e-01
[rank1]:2025-11-06 01:51:21,330 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3767e+00
[rank3]:2025-11-06 01:51:21,353 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0289e-01
[rank0]:2025-11-06 01:51:21,345 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7245e+00
[rank2]:2025-11-06 01:51:43,908 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0250e+00
[rank1]:2025-11-06 01:51:43,907 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2848e+00
[rank3]:2025-11-06 01:51:43,923 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8599e+00
[rank0]:2025-11-06 01:51:43,923 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2666e+00
[rank1]:2025-11-06 01:52:08,705 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4597e-01
[rank0]:2025-11-06 01:52:08,720 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1049e-01
[rank3]:2025-11-06 01:52:08,728 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.6390e-01
[rank2]:2025-11-06 01:52:08,717 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2408e-01
[rank3]:2025-11-06 01:52:31,302 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7929e+00
[rank2]:2025-11-06 01:52:31,287 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0694e+00
[rank1]:2025-11-06 01:52:31,287 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0620e+00
[rank0]:2025-11-06 01:52:31,302 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1783e+00
[rank0]:2025-11-06 01:52:53,657 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:52:55,873 - INFO - Avg. fwd time: 11.5633 / Avg. bwd time: 42.3330 / Avg. batch time: 490.8510 (ms) / GPU bubble ratio: 12.16%
[rank2]:2025-11-06 01:52:55,944 - INFO - Avg. fwd time: 7.6040 / Avg. bwd time: 15.5943 / Avg. batch time: 518.8995 (ms) / GPU bubble ratio: 64.23%
[rank1]:2025-11-06 01:52:55,925 - INFO - Avg. fwd time: 10.1691 / Avg. bwd time: 15.9938 / Avg. batch time: 549.3739 (ms) / GPU bubble ratio: 61.90%
[rank0]:2025-11-06 01:52:55,895 - INFO - Avg. fwd time: 8.6330 / Avg. bwd time: 17.5578 / Avg. batch time: 579.7680 (ms) / GPU bubble ratio: 63.86%
[rank3]:2025-11-06 01:52:56,158 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.6051e-01
[rank3]:2025-11-06 01:52:56,161 - INFO -  step: 550  loss:  0.3058  grad_norm:  0.1956  memory: 28.29GiB(59.55%)  tps: 6,840  tflops: 52.10  mfu: 16.70%
[rank2]:2025-11-06 01:52:56,146 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.9462e-01
[rank2]:2025-11-06 01:52:56,146 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1956  memory: 11.83GiB(24.89%)  tps: 6,840  tflops: 52.10  mfu: 16.70%
[rank1]:2025-11-06 01:52:56,134 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2170e+00
[rank1]:2025-11-06 01:52:56,135 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1956  memory: 14.66GiB(30.86%)  tps: 6,841  tflops: 52.10  mfu: 16.70%
[rank0]:2025-11-06 01:52:56,149 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2781e+00
[rank0]:2025-11-06 01:52:56,150 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1956  memory: 16.57GiB(34.88%)  tps: 6,841  tflops: 52.10  mfu: 16.70%
[rank2]:2025-11-06 01:53:18,760 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2517e+00
[rank1]:2025-11-06 01:53:18,760 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1200e+00
[rank3]:2025-11-06 01:53:18,776 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.9964e-01
[rank0]:2025-11-06 01:53:18,776 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5705e+00
[rank1]:2025-11-06 01:53:43,556 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7984e+00
[rank3]:2025-11-06 01:53:43,579 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5320e+00
[rank2]:2025-11-06 01:53:43,567 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1798e+00
[rank0]:2025-11-06 01:53:43,571 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3416e+00
[rank1]:2025-11-06 01:54:06,102 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5825e+00
[rank3]:2025-11-06 01:54:06,117 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1465e+00
[rank2]:2025-11-06 01:54:06,102 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8527e+00
[rank0]:2025-11-06 01:54:06,117 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3136e+00
[rank1]:2025-11-06 01:54:30,842 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9910e+00
[rank3]:2025-11-06 01:54:30,866 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3296e+00
[rank2]:2025-11-06 01:54:30,854 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3739e+00
[rank0]:2025-11-06 01:54:30,858 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2425e+00
[rank0]:2025-11-06 01:54:51,122 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-06 01:54:53,379 - INFO - Avg. fwd time: 10.2047 / Avg. bwd time: 15.7482 / Avg. batch time: 548.6852 (ms) / GPU bubble ratio: 62.16%
[rank3]:2025-11-06 01:54:53,338 - INFO - Avg. fwd time: 11.5742 / Avg. bwd time: 42.2856 / Avg. batch time: 490.5583 (ms) / GPU bubble ratio: 12.17%
[rank0]:2025-11-06 01:54:53,402 - INFO - Avg. fwd time: 8.6559 / Avg. bwd time: 17.3977 / Avg. batch time: 578.9146 (ms) / GPU bubble ratio: 64.00%
[rank0]:2025-11-06 01:54:53,427 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1405e+00
[rank3]:2025-11-06 01:54:53,427 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0936e+00
[rank0]:2025-11-06 01:54:53,428 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2167  memory: 16.57GiB(34.88%)  tps: 6,985  tflops: 53.20  mfu: 17.05%
[rank2]:2025-11-06 01:54:53,358 - INFO - Avg. fwd time: 7.6204 / Avg. bwd time: 15.4925 / Avg. batch time: 518.4724 (ms) / GPU bubble ratio: 64.34%
[rank2]:2025-11-06 01:54:53,412 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4230e+00
[rank2]:2025-11-06 01:54:53,413 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2167  memory: 11.83GiB(24.89%)  tps: 6,986  tflops: 53.21  mfu: 17.05%
[rank1]:2025-11-06 01:54:53,412 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5868e+00
[rank1]:2025-11-06 01:54:53,413 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2167  memory: 14.66GiB(30.86%)  tps: 6,985  tflops: 53.20  mfu: 17.05%
[rank1]:2025-11-06 01:54:53,485 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0154_stage1_step600.svg
[rank0]:2025-11-06 01:54:53,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0154_stage0_step600.svg
[rank3]:2025-11-06 01:54:53,431 - INFO -  step: 600  loss:  0.2315  grad_norm:  0.2167  memory: 28.29GiB(59.55%)  tps: 6,986  tflops: 53.20  mfu: 17.05%
[rank2]:2025-11-06 01:54:53,483 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0154_stage2_step600.svg
[rank3]:2025-11-06 01:54:53,577 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0154_real_step600_rank3.svg
[rank3]:> Batch Time: 546.84 ms, GPU Bubble Ratio: 63.80%, 65.23%, 71.74%, 25.12%
[rank3]:2025-11-06 01:54:53,622 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0154_stage3_step600.svg
[rank1]:2025-11-06 01:55:18,276 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6078e-01
[rank0]:2025-11-06 01:55:18,291 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1919e-01
[rank3]:2025-11-06 01:55:18,300 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.3921e-01
[rank2]:2025-11-06 01:55:18,288 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0700e-01
[rank2]:2025-11-06 01:55:40,792 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.4067e-01
[rank1]:2025-11-06 01:55:40,792 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2258e+00
[rank0]:2025-11-06 01:55:40,807 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3785e+00
[rank3]:2025-11-06 01:55:40,807 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1104e-01
[rank1]:2025-11-06 01:56:05,524 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.6840e-01
[rank0]:2025-11-06 01:56:05,539 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0465e+00
[rank3]:2025-11-06 01:56:05,547 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.3597e-01
[rank2]:2025-11-06 01:56:05,535 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5204e-01
[rank1]:2025-11-06 01:56:28,017 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1381e+00
[rank0]:2025-11-06 01:56:28,033 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2389e+00
[rank2]:2025-11-06 01:56:28,017 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2439e+00
[rank3]:2025-11-06 01:56:28,033 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0696e+00
[rank0]:2025-11-06 01:56:50,265 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:56:52,444 - INFO - Avg. fwd time: 11.5755 / Avg. bwd time: 42.2956 / Avg. batch time: 490.6481 (ms) / GPU bubble ratio: 12.16%
[rank1]:2025-11-06 01:56:52,496 - INFO - Avg. fwd time: 10.2292 / Avg. bwd time: 15.5674 / Avg. batch time: 548.5939 (ms) / GPU bubble ratio: 62.38%
[rank0]:2025-11-06 01:56:52,466 - INFO - Avg. fwd time: 8.6717 / Avg. bwd time: 17.2799 / Avg. batch time: 578.7005 (ms) / GPU bubble ratio: 64.12%
[rank2]:2025-11-06 01:56:52,517 - INFO - Avg. fwd time: 7.6211 / Avg. bwd time: 15.4874 / Avg. batch time: 518.5749 (ms) / GPU bubble ratio: 64.35%
[rank1]:2025-11-06 01:56:52,703 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9383e+00
[rank1]:2025-11-06 01:56:52,704 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2017  memory: 14.66GiB(30.86%)  tps: 6,867  tflops: 52.30  mfu: 16.76%
[rank0]:2025-11-06 01:56:52,718 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1023e+00
[rank0]:2025-11-06 01:56:52,719 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2017  memory: 16.57GiB(34.88%)  tps: 6,867  tflops: 52.30  mfu: 16.76%
[rank2]:2025-11-06 01:56:52,715 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6264e-01
[rank2]:2025-11-06 01:56:52,715 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2017  memory: 11.83GiB(24.89%)  tps: 6,867  tflops: 52.30  mfu: 16.76%
[rank3]:2025-11-06 01:56:52,726 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7456e-01
[rank3]:2025-11-06 01:56:52,730 - INFO -  step: 650  loss:  0.2393  grad_norm:  0.2017  memory: 28.29GiB(59.55%)  tps: 6,867  tflops: 52.30  mfu: 16.76%
[rank1]:2025-11-06 01:57:15,175 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3517e-01
[rank0]:2025-11-06 01:57:15,190 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1782e-01
[rank3]:2025-11-06 01:57:15,190 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3004e-01
[rank2]:2025-11-06 01:57:15,175 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4213e-01
[rank2]:2025-11-06 01:57:39,855 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8728e-01
[rank1]:2025-11-06 01:57:39,844 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6669e-01
[rank0]:2025-11-06 01:57:39,859 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7474e-01
[rank3]:2025-11-06 01:57:39,867 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9504e-01
[rank1]:2025-11-06 01:58:02,328 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4841e+00
[rank0]:2025-11-06 01:58:02,343 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0107e+00
[rank3]:2025-11-06 01:58:02,343 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.2501e-01
[rank2]:2025-11-06 01:58:02,328 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.5383e-01
[rank0]:2025-11-06 01:58:27,057 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5600e-01
[rank1]:2025-11-06 01:58:27,042 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1069e+00
[rank3]:2025-11-06 01:58:27,065 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.3090e-01
[rank2]:2025-11-06 01:58:27,053 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2534e-01
[rank0]:2025-11-06 01:58:47,227 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:58:49,185 - INFO - Avg. fwd time: 11.5797 / Avg. bwd time: 42.2584 / Avg. batch time: 490.3816 (ms) / GPU bubble ratio: 12.17%
[rank2]:2025-11-06 01:58:49,242 - INFO - Avg. fwd time: 7.6285 / Avg. bwd time: 15.4342 / Avg. batch time: 518.2255 (ms) / GPU bubble ratio: 64.40%
[rank1]:2025-11-06 01:58:49,294 - INFO - Avg. fwd time: 10.2529 / Avg. bwd time: 15.3856 / Avg. batch time: 548.0477 (ms) / GPU bubble ratio: 62.57%
[rank0]:2025-11-06 01:58:49,271 - INFO - Avg. fwd time: 8.6873 / Avg. bwd time: 17.1614 / Avg. batch time: 578.0310 (ms) / GPU bubble ratio: 64.23%
[rank0]:2025-11-06 01:58:49,488 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9961e-01
[rank0]:2025-11-06 01:58:49,488 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.2434  memory: 16.57GiB(34.88%)  tps: 7,016  tflops: 53.43  mfu: 17.13%
[rank1]:2025-11-06 01:58:49,472 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6230e-01
[rank1]:2025-11-06 01:58:49,473 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.2434  memory: 14.66GiB(30.86%)  tps: 7,016  tflops: 53.43  mfu: 17.13%
[rank3]:2025-11-06 01:58:49,488 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5691e-01
[rank3]:2025-11-06 01:58:49,491 - INFO -  step: 700  loss:  0.2228  grad_norm:  0.2434  memory: 28.29GiB(59.55%)  tps: 7,016  tflops: 53.44  mfu: 17.13%
[rank2]:2025-11-06 01:58:49,472 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2160e-01
[rank2]:2025-11-06 01:58:49,473 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.2434  memory: 11.83GiB(24.89%)  tps: 7,016  tflops: 53.44  mfu: 17.13%
[rank2]:2025-11-06 01:58:49,546 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0158_stage2_step700.svg
[rank0]:2025-11-06 01:58:49,543 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0158_stage0_step700.svg
[rank1]:2025-11-06 01:58:49,558 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0158_stage1_step700.svg
[rank3]:2025-11-06 01:58:49,637 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0158_real_step700_rank3.svg
[rank3]:> Batch Time: 547.83 ms, GPU Bubble Ratio: 63.94%, 65.38%, 71.85%, 25.01%
[rank3]:2025-11-06 01:58:49,685 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0158_stage3_step700.svg
[rank1]:2025-11-06 01:59:14,285 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.6185e-01
[rank0]:2025-11-06 01:59:14,300 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7572e+00
[rank3]:2025-11-06 01:59:14,308 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2420e-01
[rank2]:2025-11-06 01:59:14,296 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6556e-01
[rank2]:2025-11-06 01:59:36,809 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3257e+00
[rank1]:2025-11-06 01:59:36,809 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9765e+00
[rank0]:2025-11-06 01:59:36,824 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3629e-01
[rank3]:2025-11-06 01:59:36,824 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5865e+00
[rank1]:2025-11-06 02:00:01,498 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1726e+00
[rank0]:2025-11-06 02:00:01,514 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1718e+00
[rank2]:2025-11-06 02:00:01,510 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5063e-01
[rank3]:2025-11-06 02:00:01,522 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.9779e-01
[rank2]:2025-11-06 02:00:24,044 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6837e+00
[rank3]:2025-11-06 02:00:24,060 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2473e+00
[rank1]:2025-11-06 02:00:24,044 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5771e+00
[rank0]:2025-11-06 02:00:24,060 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2063e+00
[rank0]:2025-11-06 02:00:46,301 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:00:48,706 - INFO - Avg. fwd time: 11.5797 / Avg. bwd time: 42.2765 / Avg. batch time: 490.5266 (ms) / GPU bubble ratio: 12.17%
[rank1]:2025-11-06 02:00:48,756 - INFO - Avg. fwd time: 10.2734 / Avg. bwd time: 15.2292 / Avg. batch time: 548.0432 (ms) / GPU bubble ratio: 62.77%
[rank2]:2025-11-06 02:00:48,734 - INFO - Avg. fwd time: 7.6270 / Avg. bwd time: 15.4413 / Avg. batch time: 518.3885 (ms) / GPU bubble ratio: 64.40%
[rank2]:2025-11-06 02:00:48,802 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0053e-01
[rank2]:2025-11-06 02:00:48,803 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2368  memory: 11.83GiB(24.89%)  tps: 6,865  tflops: 52.29  mfu: 16.76%
[rank1]:2025-11-06 02:00:48,790 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.3633e-01
[rank1]:2025-11-06 02:00:48,791 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2368  memory: 14.66GiB(30.86%)  tps: 6,866  tflops: 52.29  mfu: 16.76%
[rank0]:2025-11-06 02:00:48,780 - INFO - Avg. fwd time: 8.7010 / Avg. bwd time: 17.0597 / Avg. batch time: 577.9232 (ms) / GPU bubble ratio: 64.34%
[rank0]:2025-11-06 02:00:48,806 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3565e-01
[rank0]:2025-11-06 02:00:48,806 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2368  memory: 16.57GiB(34.88%)  tps: 6,866  tflops: 52.29  mfu: 16.76%
[rank3]:2025-11-06 02:00:48,813 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8792e-01
[rank3]:2025-11-06 02:00:48,817 - INFO -  step: 750  loss:  0.2766  grad_norm:  0.2368  memory: 28.29GiB(59.55%)  tps: 6,865  tflops: 52.29  mfu: 16.76%
[rank1]:2025-11-06 02:01:11,372 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6679e+00
[rank0]:2025-11-06 02:01:11,387 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0731e+00
[rank2]:2025-11-06 02:01:11,372 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4617e+00
[rank3]:2025-11-06 02:01:11,388 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0511e+00
[rank2]:2025-11-06 02:01:36,156 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1523e+00
[rank3]:2025-11-06 02:01:36,167 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0581e+00
[rank1]:2025-11-06 02:01:36,144 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3295e+00
[rank0]:2025-11-06 02:01:36,159 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6495e+00
[rank2]:2025-11-06 02:01:58,770 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.1275e-01
[rank3]:2025-11-06 02:01:58,785 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1625e-01
[rank1]:2025-11-06 02:01:58,770 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.1850e-01
[rank0]:2025-11-06 02:01:58,785 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1686e+00
[rank1]:2025-11-06 02:02:23,571 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4900e-01
[rank0]:2025-11-06 02:02:23,586 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3145e-01
[rank2]:2025-11-06 02:02:23,582 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8555e-01
[rank3]:2025-11-06 02:02:23,594 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6370e-01
[rank0]:2025-11-06 02:02:43,899 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 02:02:45,940 - INFO - Avg. fwd time: 7.6349 / Avg. bwd time: 15.3905 / Avg. batch time: 518.2146 (ms) / GPU bubble ratio: 64.45%
[rank3]:2025-11-06 02:02:45,879 - INFO - Avg. fwd time: 11.5875 / Avg. bwd time: 42.2560 / Avg. batch time: 490.4236 (ms) / GPU bubble ratio: 12.17%
[rank1]:2025-11-06 02:02:45,994 - INFO - Avg. fwd time: 10.2894 / Avg. bwd time: 15.1127 / Avg. batch time: 547.7428 (ms) / GPU bubble ratio: 62.90%
[rank0]:2025-11-06 02:02:45,968 - INFO - Avg. fwd time: 8.7116 / Avg. bwd time: 16.9839 / Avg. batch time: 577.5431 (ms) / GPU bubble ratio: 64.41%
[rank1]:2025-11-06 02:02:46,179 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1989e+00
[rank1]:2025-11-06 02:02:46,179 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2961  memory: 14.66GiB(30.86%)  tps: 6,979  tflops: 53.15  mfu: 17.04%
[rank0]:2025-11-06 02:02:46,194 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3270e+00
[rank0]:2025-11-06 02:02:46,194 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2961  memory: 16.57GiB(34.88%)  tps: 6,979  tflops: 53.15  mfu: 17.04%
[rank2]:2025-11-06 02:02:46,178 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5438e+00
[rank2]:2025-11-06 02:02:46,179 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2961  memory: 11.83GiB(24.89%)  tps: 6,979  tflops: 53.16  mfu: 17.04%
[rank3]:2025-11-06 02:02:46,194 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1392e+00
[rank3]:2025-11-06 02:02:46,198 - INFO -  step: 800  loss:  0.2291  grad_norm:  0.2961  memory: 28.29GiB(59.55%)  tps: 6,979  tflops: 53.15  mfu: 17.04%
[rank1]:2025-11-06 02:02:46,271 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0202_stage1_step800.svg
[rank0]:2025-11-06 02:02:46,266 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0202_stage0_step800.svg
[rank2]:2025-11-06 02:02:46,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0202_stage2_step800.svg
[rank3]:2025-11-06 02:02:46,347 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0202_real_step800_rank3.svg
[rank3]:> Batch Time: 595.35 ms, GPU Bubble Ratio: 66.73%, 68.09%, 65.27%, 25.49%
[rank3]:2025-11-06 02:02:46,396 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0202_stage3_step800.svg
[rank2]:2025-11-06 02:03:11,164 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9286e-01
[rank3]:2025-11-06 02:03:11,175 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8869e-01
[rank1]:2025-11-06 02:03:11,152 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3787e-01
[rank0]:2025-11-06 02:03:11,167 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9980e-01
[rank3]:2025-11-06 02:03:12,578 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 02:03:12,838 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 02:03:12,856 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 02:03:12,823 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-11-06 02:03:33,728 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2477e+00
[rank1]:2025-11-06 02:03:33,712 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3400e+00
[rank0]:2025-11-06 02:03:33,727 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0708e+00
[rank2]:2025-11-06 02:03:33,712 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0281e+00
[rank2]:2025-11-06 02:03:58,520 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6311e-01
[rank3]:2025-11-06 02:03:58,532 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7906e-01
[rank1]:2025-11-06 02:03:58,508 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4965e-01
[rank0]:2025-11-06 02:03:58,523 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.6403e-01
[rank1]:2025-11-06 02:04:21,123 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5849e+00
[rank2]:2025-11-06 02:04:21,123 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.2751e-01
[rank3]:2025-11-06 02:04:21,139 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0156e+00
[rank0]:2025-11-06 02:04:21,138 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2029e+00
[rank0]:2025-11-06 02:04:43,502 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:04:45,706 - INFO - Avg. fwd time: 11.5907 / Avg. bwd time: 42.2704 / Avg. batch time: 490.5649 (ms) / GPU bubble ratio: 12.16%
[rank1]:2025-11-06 02:04:45,761 - INFO - Avg. fwd time: 10.3065 / Avg. bwd time: 14.9935 / Avg. batch time: 547.7538 (ms) / GPU bubble ratio: 63.05%
[rank0]:2025-11-06 02:04:45,728 - INFO - Avg. fwd time: 8.7225 / Avg. bwd time: 16.9060 / Avg. batch time: 577.4739 (ms) / GPU bubble ratio: 64.50%
[rank2]:2025-11-06 02:04:45,783 - INFO - Avg. fwd time: 7.6376 / Avg. bwd time: 15.3782 / Avg. batch time: 518.3536 (ms) / GPU bubble ratio: 64.48%
[rank2]:2025-11-06 02:04:45,982 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3831e+00
[rank2]:2025-11-06 02:04:45,982 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2040  memory: 11.83GiB(24.89%)  tps: 6,838  tflops: 52.08  mfu: 16.69%
[rank3]:2025-11-06 02:04:45,994 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4282e+00
[rank3]:2025-11-06 02:04:45,997 - INFO -  step: 850  loss:  0.2332  grad_norm:  0.2040  memory: 28.29GiB(59.55%)  tps: 6,838  tflops: 52.08  mfu: 16.69%
[rank1]:2025-11-06 02:04:45,970 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7962e+00
[rank1]:2025-11-06 02:04:45,971 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2040  memory: 14.66GiB(30.86%)  tps: 6,839  tflops: 52.08  mfu: 16.69%
[rank0]:2025-11-06 02:04:45,985 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1389e+00
[rank0]:2025-11-06 02:04:45,986 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2040  memory: 16.57GiB(34.88%)  tps: 6,839  tflops: 52.08  mfu: 16.69%
[rank2]:2025-11-06 02:05:08,615 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4361e-01
[rank3]:2025-11-06 02:05:08,631 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.3123e-01
[rank1]:2025-11-06 02:05:08,615 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1872e+00
[rank0]:2025-11-06 02:05:08,630 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5486e-01
[rank3]:2025-11-06 02:05:33,590 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0457e-01
[rank1]:2025-11-06 02:05:33,567 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9923e-01
[rank0]:2025-11-06 02:05:33,582 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.3212e-01
[rank2]:2025-11-06 02:05:33,578 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3795e-01
[rank3]:2025-11-06 02:05:56,220 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0909e+00
[rank1]:2025-11-06 02:05:56,204 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2082e+00
[rank0]:2025-11-06 02:05:56,219 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5958e+00
[rank2]:2025-11-06 02:05:56,204 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2292e+00
[rank3]:2025-11-06 02:06:21,128 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.8372e-01
[rank1]:2025-11-06 02:06:21,105 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7448e-01
[rank0]:2025-11-06 02:06:21,120 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3664e-01
[rank2]:2025-11-06 02:06:21,117 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1369e-01
[rank0]:2025-11-06 02:06:41,438 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:06:43,639 - INFO - Avg. fwd time: 11.5996 / Avg. bwd time: 42.2545 / Avg. batch time: 490.5115 (ms) / GPU bubble ratio: 12.17%
[rank1]:2025-11-06 02:06:43,683 - INFO - Avg. fwd time: 10.3220 / Avg. bwd time: 14.8892 / Avg. batch time: 547.5179 (ms) / GPU bubble ratio: 63.16%
[rank0]:2025-11-06 02:06:43,708 - INFO - Avg. fwd time: 8.7333 / Avg. bwd time: 16.8379 / Avg. batch time: 577.1707 (ms) / GPU bubble ratio: 64.56%
[rank2]:2025-11-06 02:06:43,660 - INFO - Avg. fwd time: 7.6472 / Avg. bwd time: 15.3237 / Avg. batch time: 518.2280 (ms) / GPU bubble ratio: 64.54%
[rank2]:2025-11-06 02:06:43,718 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.6597e-01
[rank2]:2025-11-06 02:06:43,718 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3259  memory: 11.83GiB(24.89%)  tps: 6,958  tflops: 52.99  mfu: 16.98%
[rank3]:2025-11-06 02:06:43,733 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8695e+00
[rank3]:2025-11-06 02:06:43,737 - INFO -  step: 900  loss:  0.2058  grad_norm:  0.3259  memory: 28.29GiB(59.55%)  tps: 6,958  tflops: 52.99  mfu: 16.98%
[rank1]:2025-11-06 02:06:43,718 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.2109e-01
[rank1]:2025-11-06 02:06:43,718 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3259  memory: 14.66GiB(30.86%)  tps: 6,957  tflops: 52.99  mfu: 16.98%
[rank1]:2025-11-06 02:06:43,790 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0206_stage1_step900.svg
[rank0]:2025-11-06 02:06:43,733 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0786e+00
[rank0]:2025-11-06 02:06:43,734 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3259  memory: 16.57GiB(34.88%)  tps: 6,957  tflops: 52.99  mfu: 16.98%
[rank0]:2025-11-06 02:06:43,785 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0206_stage0_step900.svg
[rank2]:2025-11-06 02:06:43,791 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0206_stage2_step900.svg
[rank3]:2025-11-06 02:06:43,886 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0206_real_step900_rank3.svg
[rank3]:> Batch Time: 546.89 ms, GPU Bubble Ratio: 63.75%, 65.21%, 71.68%, 24.57%
[rank3]:2025-11-06 02:06:43,929 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0206_stage3_step900.svg
[rank3]:2025-11-06 02:07:08,707 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4661e+00
[rank1]:2025-11-06 02:07:08,684 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7547e+00
[rank0]:2025-11-06 02:07:08,699 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5000e+00
[rank2]:2025-11-06 02:07:08,696 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5696e+00
[rank1]:2025-11-06 02:07:31,255 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.2925e-01
[rank0]:2025-11-06 02:07:31,271 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.7466e-01
[rank2]:2025-11-06 02:07:31,255 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.0742e-01
[rank3]:2025-11-06 02:07:31,271 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0776e-01
[rank3]:2025-11-06 02:07:56,050 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3595e-01
[rank1]:2025-11-06 02:07:56,027 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4123e-01
[rank0]:2025-11-06 02:07:56,042 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2562e-01
[rank2]:2025-11-06 02:07:56,038 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0690e-01
[rank2]:2025-11-06 02:08:18,558 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9106e-01
[rank3]:2025-11-06 02:08:18,574 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5536e-01
[rank1]:2025-11-06 02:08:18,558 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2854e-01
[rank0]:2025-11-06 02:08:18,574 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6385e-01
[rank0]:2025-11-06 02:08:40,773 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:08:42,963 - INFO - Avg. fwd time: 11.6006 / Avg. bwd time: 42.2689 / Avg. batch time: 490.6347 (ms) / GPU bubble ratio: 12.16%
[rank1]:2025-11-06 02:08:43,016 - INFO - Avg. fwd time: 10.3333 / Avg. bwd time: 14.8075 / Avg. batch time: 547.5728 (ms) / GPU bubble ratio: 63.27%
[rank0]:2025-11-06 02:08:42,986 - INFO - Avg. fwd time: 8.7410 / Avg. bwd time: 16.7845 / Avg. batch time: 577.1700 (ms) / GPU bubble ratio: 64.62%
[rank2]:2025-11-06 02:08:43,035 - INFO - Avg. fwd time: 7.6467 / Avg. bwd time: 15.3287 / Avg. batch time: 518.3711 (ms) / GPU bubble ratio: 64.54%
[rank3]:2025-11-06 02:08:43,241 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9089e-01
[rank1]:2025-11-06 02:08:43,218 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1150e-01
[rank1]:2025-11-06 02:08:43,218 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.3074  memory: 14.66GiB(30.86%)  tps: 6,855  tflops: 52.21  mfu: 16.73%
[rank0]:2025-11-06 02:08:43,233 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.5338e-01
[rank0]:2025-11-06 02:08:43,234 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.3074  memory: 16.57GiB(34.88%)  tps: 6,855  tflops: 52.21  mfu: 16.73%
[rank2]:2025-11-06 02:08:43,229 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2758e-01
[rank2]:2025-11-06 02:08:43,230 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.3074  memory: 11.83GiB(24.89%)  tps: 6,855  tflops: 52.21  mfu: 16.73%
[rank3]:2025-11-06 02:08:43,245 - INFO -  step: 950  loss:  0.2494  grad_norm:  0.3074  memory: 28.29GiB(59.55%)  tps: 6,855  tflops: 52.21  mfu: 16.73%
[rank3]:2025-11-06 02:09:05,752 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3822e-01
[rank1]:2025-11-06 02:09:05,736 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1426e+00
[rank0]:2025-11-06 02:09:05,752 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2555e+00
[rank2]:2025-11-06 02:09:05,736 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0028e+00
[rank1]:2025-11-06 02:09:30,403 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0149e+00
[rank0]:2025-11-06 02:09:30,418 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5411e+00
[rank2]:2025-11-06 02:09:30,414 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8492e-01
[rank3]:2025-11-06 02:09:30,426 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1392e-01
[rank3]:2025-11-06 02:09:52,925 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8008e-01
[rank1]:2025-11-06 02:09:52,909 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4520e+00
[rank0]:2025-11-06 02:09:52,925 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2256e+00
[rank2]:2025-11-06 02:09:52,909 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.7272e-01
[rank3]:2025-11-06 02:10:17,645 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6384e+00
[rank1]:2025-11-06 02:10:17,622 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5531e+00
[rank0]:2025-11-06 02:10:17,637 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3879e+00
[rank2]:2025-11-06 02:10:17,633 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0312e+00
[rank0]:2025-11-06 02:10:37,810 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:10:39,792 - INFO - Avg. fwd time: 11.6025 / Avg. bwd time: 42.2463 / Avg. batch time: 490.4688 (ms) / GPU bubble ratio: 12.17%
[rank0]:2025-11-06 02:10:39,879 - INFO - Avg. fwd time: 8.7484 / Avg. bwd time: 16.7280 / Avg. batch time: 576.8034 (ms) / GPU bubble ratio: 64.67%
[rank1]:2025-11-06 02:10:39,903 - INFO - Avg. fwd time: 10.3441 / Avg. bwd time: 14.7206 / Avg. batch time: 547.2660 (ms) / GPU bubble ratio: 63.36%
[rank2]:2025-11-06 02:10:39,851 - INFO - Avg. fwd time: 7.6507 / Avg. bwd time: 15.2998 / Avg. batch time: 518.1580 (ms) / GPU bubble ratio: 64.57%
[rank3]:2025-11-06 02:10:40,091 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.6221e-01
[rank3]:2025-11-06 02:10:40,094 - INFO -  step: 1000  loss:  0.2406  grad_norm:  0.2663  memory: 28.29GiB(59.55%)  tps: 7,011  tflops: 53.40  mfu: 17.11%
[rank0]:2025-11-06 02:10:40,090 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6566e+00
[rank0]:2025-11-06 02:10:40,091 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2663  memory: 16.57GiB(34.88%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank1]:2025-11-06 02:10:40,075 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1438e+00
[rank1]:2025-11-06 02:10:40,075 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2663  memory: 14.66GiB(30.86%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank2]:2025-11-06 02:10:40,075 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3211e+00
[rank2]:2025-11-06 02:10:40,075 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2663  memory: 11.83GiB(24.89%)  tps: 7,011  tflops: 53.40  mfu: 17.11%
[rank0]:2025-11-06 02:10:40,147 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0210_stage0_step1000.svg
[rank1]:2025-11-06 02:10:40,149 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0210_stage1_step1000.svg
[rank2]:2025-11-06 02:10:40,147 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0210_stage2_step1000.svg
[rank3]:2025-11-06 02:10:40,248 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0210_real_step1000_rank3.svg
[rank3]:> Batch Time: 547.85 ms, GPU Bubble Ratio: 63.89%, 65.40%, 71.85%, 24.91%
[rank3]:2025-11-06 02:10:40,294 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0210_stage3_step1000.svg
[rank3]:2025-11-06 02:11:04,915 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9084e-01
[rank0]:2025-11-06 02:11:04,907 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8887e-01
[rank2]:2025-11-06 02:11:04,905 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1010e-01
[rank1]:2025-11-06 02:11:04,891 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.2214e-01
[rank3]:2025-11-06 02:11:27,442 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5380e+00
[rank0]:2025-11-06 02:11:27,442 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0052e+00
[rank2]:2025-11-06 02:11:27,427 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0627e+00
[rank1]:2025-11-06 02:11:27,426 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3618e+00
[rank2]:2025-11-06 02:11:52,090 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1152e-01
[rank0]:2025-11-06 02:11:52,094 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7783e-01
[rank1]:2025-11-06 02:11:52,079 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4088e-01
[rank3]:2025-11-06 02:11:52,102 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3327e+00
[rank3]:2025-11-06 02:12:14,609 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8975e+00
[rank2]:2025-11-06 02:12:14,593 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3970e+00
[rank0]:2025-11-06 02:12:14,608 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5606e-01
[rank1]:2025-11-06 02:12:14,593 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0469e-01
[rank0]:2025-11-06 02:12:36,800 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:12:39,204 - INFO - Avg. fwd time: 11.6011 / Avg. bwd time: 42.2570 / Avg. batch time: 490.5425 (ms) / GPU bubble ratio: 12.17%
[rank2]:2025-11-06 02:12:39,233 - INFO - Avg. fwd time: 7.6486 / Avg. bwd time: 15.3116 / Avg. batch time: 518.2564 (ms) / GPU bubble ratio: 64.56%
[rank0]:2025-11-06 02:12:39,283 - INFO - Avg. fwd time: 8.7554 / Avg. bwd time: 16.6771 / Avg. batch time: 576.7668 (ms) / GPU bubble ratio: 64.72%
[rank1]:2025-11-06 02:12:39,257 - INFO - Avg. fwd time: 10.3539 / Avg. bwd time: 14.6420 / Avg. batch time: 547.2812 (ms) / GPU bubble ratio: 63.46%
[rank1]:2025-11-06 02:12:39,293 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1145e+00
[rank1]:2025-11-06 02:12:39,293 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2074  memory: 14.66GiB(30.86%)  tps: 6,871  tflops: 52.33  mfu: 16.77%
[rank3]:2025-11-06 02:12:39,316 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9278e-01
[rank3]:2025-11-06 02:12:39,319 - INFO -  step: 1050  loss:  0.2848  grad_norm:  0.2074  memory: 28.29GiB(59.55%)  tps: 6,871  tflops: 52.33  mfu: 16.77%
[rank2]:2025-11-06 02:12:39,304 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5396e-01
[rank2]:2025-11-06 02:12:39,305 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2074  memory: 11.83GiB(24.89%)  tps: 6,871  tflops: 52.33  mfu: 16.77%
[rank0]:2025-11-06 02:12:39,308 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8282e+00
[rank0]:2025-11-06 02:12:39,308 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2074  memory: 16.57GiB(34.88%)  tps: 6,871  tflops: 52.33  mfu: 16.77%
[rank2]:2025-11-06 02:13:01,770 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3715e+00
[rank1]:2025-11-06 02:13:01,770 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7755e+00
[rank0]:2025-11-06 02:13:01,785 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7823e+00
[rank3]:2025-11-06 02:13:01,786 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9150e+00
[rank1]:2025-11-06 02:13:26,441 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5871e+00
[rank3]:2025-11-06 02:13:26,465 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1292e+00
[rank2]:2025-11-06 02:13:26,452 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7694e+00
[rank0]:2025-11-06 02:13:26,456 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6501e+00
[rank3]:2025-11-06 02:13:49,005 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1230e-01
[rank2]:2025-11-06 02:13:48,990 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4222e+00
[rank0]:2025-11-06 02:13:49,005 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6421e+00
[rank1]:2025-11-06 02:13:48,990 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7066e+00
[rank1]:2025-11-06 02:14:13,702 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1128e+00
[rank0]:2025-11-06 02:14:13,717 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6146e+00
[rank3]:2025-11-06 02:14:13,726 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7064e-01
[rank2]:2025-11-06 02:14:13,714 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3137e-01
[rank0]:2025-11-06 02:14:33,977 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:14:35,958 - INFO - Avg. fwd time: 11.6037 / Avg. bwd time: 42.2339 / Avg. batch time: 490.3777 (ms) / GPU bubble ratio: 12.17%
[rank2]:2025-11-06 02:14:36,016 - INFO - Avg. fwd time: 7.6532 / Avg. bwd time: 15.2795 / Avg. batch time: 518.0454 (ms) / GPU bubble ratio: 64.59%
[rank0]:2025-11-06 02:14:36,044 - INFO - Avg. fwd time: 8.7606 / Avg. bwd time: 16.6375 / Avg. batch time: 576.4494 (ms) / GPU bubble ratio: 64.75%
[rank1]:2025-11-06 02:14:36,066 - INFO - Avg. fwd time: 10.3613 / Avg. bwd time: 14.5812 / Avg. batch time: 547.0047 (ms) / GPU bubble ratio: 63.52%
[rank1]:2025-11-06 02:14:36,243 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0804e+00
[rank1]:2025-11-06 02:14:36,243 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3480  memory: 14.66GiB(30.86%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank3]:2025-11-06 02:14:36,258 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.2438e-01
[rank3]:2025-11-06 02:14:36,261 - INFO -  step: 1100  loss:  0.2452  grad_norm:  0.3480  memory: 28.29GiB(59.55%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank2]:2025-11-06 02:14:36,243 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.6256e-01
[rank2]:2025-11-06 02:14:36,243 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3480  memory: 11.83GiB(24.89%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank2]:2025-11-06 02:14:36,314 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0214_stage2_step1100.svg
[rank1]:2025-11-06 02:14:36,316 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0214_stage1_step1100.svg
[rank0]:2025-11-06 02:14:36,258 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0374e+00
[rank0]:2025-11-06 02:14:36,258 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3480  memory: 16.57GiB(34.88%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank0]:2025-11-06 02:14:36,312 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0214_stage0_step1100.svg
[rank3]:2025-11-06 02:14:36,409 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0214_real_step1100_rank3.svg
[rank3]:> Batch Time: 593.85 ms, GPU Bubble Ratio: 66.68%, 68.06%, 65.22%, 25.72%
[rank3]:2025-11-06 02:14:36,454 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0214_stage3_step1100.svg
[rank1]:2025-11-06 02:15:01,151 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4759e+00
[rank0]:2025-11-06 02:15:01,166 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1334e-01
[rank3]:2025-11-06 02:15:01,174 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1475e-01
[rank2]:2025-11-06 02:15:01,162 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6915e-01
[rank3]:2025-11-06 02:15:23,745 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.1685e-01
[rank2]:2025-11-06 02:15:23,730 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.2795e-01
[rank0]:2025-11-06 02:15:23,745 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3968e+00
[rank1]:2025-11-06 02:15:23,730 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0013e-01
[rank2]:2025-11-06 02:15:48,512 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2096e-01
[rank0]:2025-11-06 02:15:48,516 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.0573e-01
[rank1]:2025-11-06 02:15:48,500 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3286e-01
[rank3]:2025-11-06 02:15:48,524 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1477e+00
[rank2]:2025-11-06 02:16:11,129 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7972e+00
[rank0]:2025-11-06 02:16:11,145 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0162e+00
[rank1]:2025-11-06 02:16:11,129 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0371e+00
[rank3]:2025-11-06 02:16:11,145 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6503e+00
[rank0]:2025-11-06 02:16:33,477 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:16:35,680 - INFO - Avg. fwd time: 11.6057 / Avg. bwd time: 42.2393 / Avg. batch time: 490.4370 (ms) / GPU bubble ratio: 12.17%
[rank2]:2025-11-06 02:16:35,752 - INFO - Avg. fwd time: 7.6542 / Avg. bwd time: 15.2749 / Avg. batch time: 518.1105 (ms) / GPU bubble ratio: 64.60%
[rank0]:2025-11-06 02:16:35,704 - INFO - Avg. fwd time: 8.7669 / Avg. bwd time: 16.5955 / Avg. batch time: 576.4041 (ms) / GPU bubble ratio: 64.80%
[rank1]:2025-11-06 02:16:35,733 - INFO - Avg. fwd time: 10.3699 / Avg. bwd time: 14.5171 / Avg. batch time: 547.0019 (ms) / GPU bubble ratio: 63.60%
[rank3]:2025-11-06 02:16:35,959 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1013e+00
[rank3]:2025-11-06 02:16:35,962 - INFO -  step: 1150  loss:  0.2463  grad_norm:  0.2155  memory: 28.29GiB(59.55%)  tps: 6,844  tflops: 52.12  mfu: 16.71%
[rank2]:2025-11-06 02:16:35,947 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2608e-01
[rank2]:2025-11-06 02:16:35,948 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2155  memory: 11.83GiB(24.89%)  tps: 6,844  tflops: 52.12  mfu: 16.71%
[rank0]:2025-11-06 02:16:35,951 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3337e-01
[rank0]:2025-11-06 02:16:35,951 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2155  memory: 16.57GiB(34.88%)  tps: 6,844  tflops: 52.13  mfu: 16.71%
[rank1]:2025-11-06 02:16:35,936 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3054e-01
[rank1]:2025-11-06 02:16:35,936 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2155  memory: 14.66GiB(30.86%)  tps: 6,844  tflops: 52.13  mfu: 16.71%
[rank1]:2025-11-06 02:16:58,534 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.1054e-01
[rank3]:2025-11-06 02:16:58,550 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6137e+00
[rank2]:2025-11-06 02:16:58,534 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1410e+00
[rank0]:2025-11-06 02:16:58,549 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3556e-01
[rank3]:2025-11-06 02:17:23,409 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5868e-01
[rank2]:2025-11-06 02:17:23,397 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9300e-01
[rank0]:2025-11-06 02:17:23,401 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1546e-01
[rank1]:2025-11-06 02:17:23,386 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.3491e-01
[rank3]:2025-11-06 02:17:46,043 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1504e-01
[rank2]:2025-11-06 02:17:46,028 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.2140e-01
[rank0]:2025-11-06 02:17:46,043 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8637e-01
[rank1]:2025-11-06 02:17:46,028 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4644e+00
[rank1]:2025-11-06 02:18:10,923 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0338e-01
[rank3]:2025-11-06 02:18:10,947 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3878e-01
[rank2]:2025-11-06 02:18:10,935 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2086e-01
[rank0]:2025-11-06 02:18:10,939 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1980e+00
[rank0]:2025-11-06 02:18:31,306 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:18:33,546 - INFO - Avg. fwd time: 11.6106 / Avg. bwd time: 42.2279 / Avg. batch time: 490.3859 (ms) / GPU bubble ratio: 12.17%
[rank2]:2025-11-06 02:18:33,568 - INFO - Avg. fwd time: 7.6605 / Avg. bwd time: 15.2383 / Avg. batch time: 518.0098 (ms) / GPU bubble ratio: 64.64%
[rank0]:2025-11-06 02:18:33,619 - INFO - Avg. fwd time: 8.7731 / Avg. bwd time: 16.5578 / Avg. batch time: 576.2068 (ms) / GPU bubble ratio: 64.83%
[rank1]:2025-11-06 02:18:33,593 - INFO - Avg. fwd time: 10.3789 / Avg. bwd time: 14.4598 / Avg. batch time: 546.8421 (ms) / GPU bubble ratio: 63.66%
[rank1]:2025-11-06 02:18:33,629 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4195e-01
[rank1]:2025-11-06 02:18:33,630 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3205  memory: 14.66GiB(30.86%)  tps: 6,960  tflops: 53.01  mfu: 16.99%
[rank1]:2025-11-06 02:18:33,630 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.3205  tps: 7,161  tflops: 54.54  mfu: 16.36%
[rank1]:2025-11-06 02:18:33,630 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 02:18:33,631 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-06 02:18:33,645 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.6393e-01
[rank3]:2025-11-06 02:18:33,648 - INFO -  step: 1200  loss:  0.2460  grad_norm:  0.3205  memory: 28.29GiB(59.55%)  tps: 6,961  tflops: 53.02  mfu: 16.99%
[rank3]:2025-11-06 02:18:33,649 - INFO -  final step: 1200  loss:  0.2460  grad_norm:  0.3205  tps: 7,166  tflops: 54.58  mfu: 16.44%
[rank3]:2025-11-06 02:18:33,649 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 02:18:33,650 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 02:18:33,629 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4763e-01
[rank2]:2025-11-06 02:18:33,630 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3205  memory: 11.83GiB(24.89%)  tps: 6,961  tflops: 53.02  mfu: 16.99%
[rank2]:2025-11-06 02:18:33,630 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.3205  tps: 7,162  tflops: 54.55  mfu: 16.37%
[rank2]:2025-11-06 02:18:33,630 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 02:18:33,631 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 02:18:33,644 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3286e-01
[rank0]:2025-11-06 02:18:33,645 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3205  memory: 16.57GiB(34.88%)  tps: 6,960  tflops: 53.01  mfu: 16.99%
[rank0]:2025-11-06 02:18:33,645 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.3205  tps: 7,162  tflops: 54.55  mfu: 16.37%
[rank0]:2025-11-06 02:18:33,645 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 02:18:33,646 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 02:18:36,007 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank2/251106_0218_stage2_final1200.svg
[rank0]:2025-11-06 02:18:35,941 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-06 02:18:36,005 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank0/251106_0218_stage0_final1200.svg
[rank1]:2025-11-06 02:18:36,008 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank1/251106_0218_stage1_final1200.svg
[rank3]:2025-11-06 02:18:36,099 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0218_real_final1200_rank3.svg
[rank3]:> Batch Time: 589.36 ms, GPU Bubble Ratio: 66.43%, 67.78%, 65.01%, 25.93%
[rank1]:2025-11-06 02:18:36,163 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/frozen_params_histogram/251106_0218_rank1_stage1.svg
[rank1]:	> Counts Sum: 3852, Total Sum: 5175 (74.43%), Ratio(%) per element: [94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-06 02:18:36,163 - INFO - Destroying the purge thread.
[rank2]:2025-11-06 02:18:36,167 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/frozen_params_histogram/251106_0218_rank2_stage2.svg
[rank2]:	> Counts Sum: 1512, Total Sum: 4140 (36.52%), Ratio(%) per element: [48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-06 02:18:36,167 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 02:18:36,162 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/frozen_params_histogram/251106_0218_rank0_stage0.svg
[rank0]:	> Counts Sum: 2916, Total Sum: 4255 (68.53%), Ratio(%) per element: [0.0, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 91.3, 91.3, 91.3, 91.3, 91.3, 91.3, 91.3, 91.3, 91.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-06 02:18:36,163 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-06 02:18:36,244 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/pipeline_schedule/251106_0218_thry_final1200_rank3.svg
[rank3]:> Batch Time: 315.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-06 02:18:36,290 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/freeze_ratio_history/rank3/251106_0218_stage3_final1200.svg
[rank3]:2025-11-06 02:18:36,426 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90/frozen_params_histogram/251106_0218_rank3_stage3.svg
[rank3]:	> Counts Sum: 1026, Total Sum: 3335 (30.76%), Ratio(%) per element: [49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-06 02:18:36,427 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-11-06 02:18:36,587 - INFO - Process group destroyed
[rank2]:2025-11-06 02:18:36,642 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 23-24, summary, console lines 373-386
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.28626
[rank3]:wandb:               final/avg_loss 0.24599
[rank3]:wandb:             final/avg_mfu(%) 16.43632
[rank3]:wandb:             final/avg_tflops 54.57993
[rank3]:wandb:    final/avg_throughput(tps) 7166.28153
[rank3]:wandb:              final/grad_norm 0.32055
[rank3]:wandb:               final/max_loss 0.24599
[rank3]:wandb:                    grad_norm 0.32055
[rank3]:wandb: loss_metrics/global_avg_loss 0.24599
[rank3]:wandb: loss_metrics/global_max_loss 0.24599
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_GPipe_auto_dm1_th0.005_p90 at: https://wandb.ai/orangingq/torchtitan/runs/ugzht7yu
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1_th0.005_p90/20251106-0130/wandb/run-20251106_013054-ugzht7yu/logs
[rank3]:2025-11-06 02:18:37,625 - INFO - Process group destroyed
[rank0]:2025-11-06 02:18:38,163 - INFO - Training completed
[rank0]:2025-11-06 02:18:38,164 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 02:18:38,612 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.6', 'layers.5', 'layers.8', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.2', 'layers.3', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'norm', 'output', 'layers.14', 'layers.15', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_GPipe_auto_dm1_th0.005_p90
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_GPipe_auto_dm1_th0.005_p90
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_GPipe_auto_dm1_th0.005_p90
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1_th0.005_p90
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.005_p90
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_GPipe_auto_dm1_th0.005_p90
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_GPipe_auto_dm1_th0.005_p90
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_GPipe_auto_dm1_th0.005_p90
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.005
[rank3]:		- percentile: 90
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
