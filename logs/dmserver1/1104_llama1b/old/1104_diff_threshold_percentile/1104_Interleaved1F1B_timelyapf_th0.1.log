
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 06. (ëª©) 05:09:54 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_Interleaved1F1B_timelyapf_th0.1.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.1
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-06 05:10:00,441 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-11-06 05:10:00,441 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-06 05:10:00,610 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-06 05:10:00,676 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-06 05:10:00,680 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-06 05:10:00,678 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-06 05:10:00,680 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-06 05:10:00,682 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 05:10:00,795 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-06 05:10:00,798 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 05:10:00,802 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-06 05:10:00,889 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-06 05:10:00,892 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 05:10:01,277 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-06 05:10:01,692 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-11-06 05:10:04,739 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-06 05:10:04,779 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 05:10:04,806 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-06 05:10:04,818 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-06 05:10:04,820 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-06 05:10:04,922 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-06 05:10:04,990 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 05:10:04,990 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-06 05:10:04,991 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-06 05:10:05,088 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-06 05:10:05,127 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 05:10:05,156 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank0]:2025-11-06 05:10:05,069 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-06 05:10:05,113 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 05:10:05,114 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-06 05:10:05,140 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-06 05:10:05,152 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-06 05:10:05,154 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-06 05:10:05,170 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-06 05:10:05,172 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-06 05:10:05,347 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 05:10:05,347 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-06 05:10:05,348 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-06 05:10:05,331 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 05:10:05,331 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-06 05:10:05,332 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run hyqwvc71
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_dm1_th0.1/20251106-0510/wandb/run-20251106_051006-hyqwvc71
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/hyqwvc71
[rank3]:2025-11-06 05:10:07,126 - INFO - WandB logging enabled
[rank3]:2025-11-06 05:10:07,127 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-06 05:10:07,165 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 05:10:07,194 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-06 05:10:07,207 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-06 05:10:07,209 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-06 05:10:07,403 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 05:10:07,403 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank0]:2025-11-06 05:10:07,403 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 05:10:07,404 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank2]:2025-11-06 05:10:07,403 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 05:10:07,404 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-11-06 05:10:07,385 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 05:10:07,386 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-06 05:10:07,387 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-06 05:10:07,403 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 05:10:09,585 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-06 05:10:09,585 - INFO - Finished loading the checkpoint in 2.18 seconds.
[rank0]:2025-11-06 05:10:09,585 - INFO - Training starts at step 1
[rank1]:2025-11-06 05:10:12,868 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8864  memory:  9.58GiB(20.17%)  tps: 2,026  tflops: 15.43  mfu: 4.94%
[rank1]:2025-11-06 05:10:12,868 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-06 05:10:12,856 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8864  memory:  6.31GiB(13.29%)  tps: 2,120  tflops: 16.15  mfu: 5.18%
[rank2]:2025-11-06 05:10:12,856 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-06 05:10:12,867 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8864  memory: 15.04GiB(31.66%)  tps: 2,875  tflops: 21.90  mfu: 7.02%
[rank3]:2025-11-06 05:10:12,867 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 05:10:12,890 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8864  memory: 10.96GiB(23.08%)  tps: 2,107  tflops: 16.05  mfu: 5.14%
[rank0]:2025-11-06 05:10:12,890 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 05:12:21,503 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 05:12:23,862 - INFO - Avg. fwd time: 6.6656 / Avg. bwd time: 21.6616 / Avg. batch time: 561.5481 (ms) / GPU bubble ratio: 19.29%
[rank0]:2025-11-06 05:12:23,941 - INFO - Avg. fwd time: 4.0914 / Avg. bwd time: 11.9737 / Avg. batch time: 646.4334 (ms) / GPU bubble ratio: 60.24%
[rank2]:2025-11-06 05:12:23,921 - INFO - Avg. fwd time: 3.9538 / Avg. bwd time: 10.0151 / Avg. batch time: 594.4774 (ms) / GPU bubble ratio: 62.40%
[rank1]:2025-11-06 05:12:24,019 - INFO - Avg. fwd time: 4.8491 / Avg. bwd time: 12.1879 / Avg. batch time: 623.7231 (ms) / GPU bubble ratio: 56.30%
[rank1]:2025-11-06 05:12:24,190 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5405  memory: 11.85GiB(24.93%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank3]:2025-11-06 05:12:24,198 - INFO -  step: 50  loss:  9.2028  grad_norm: 15.5405  memory: 18.46GiB(38.86%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank0]:2025-11-06 05:12:24,200 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5405  memory: 14.71GiB(30.97%)  tps: 6,114  tflops: 46.56  mfu: 14.92%
[rank2]:2025-11-06 05:12:24,186 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5405  memory:  8.13GiB(17.12%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank3]:2025-11-06 05:12:51,241 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-06 05:13:19,334 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-06 05:13:19,643 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-06 05:13:21,918 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:21,933 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:21,950 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:21,968 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:22,487 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:22,505 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,281 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,291 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,299 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,308 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,320 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,341 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,521 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,492 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,546 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,512 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,527 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,547 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,517 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,577 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,574 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,646 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,564 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,584 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,604 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,573 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,630 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,655 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,647 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,680 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,713 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,721 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,728 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,670 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,719 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,738 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,743 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,662 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,668 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,712 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,728 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,736 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,743 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,750 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,688 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,719 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,727 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,739 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,745 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,757 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,763 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,739 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,747 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:13:24,753 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,751 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,759 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,764 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,778 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,793 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 05:13:24,805 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,760 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,771 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 05:13:24,783 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 05:13:24,776 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 05:14:04,341 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-06 05:14:04,640 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0514_max_batch_time.svg
[rank3]:> Batch Time: 527.07 ms, GPU Bubble Ratio: 50.84%, 47.86%, 57.24%, 12.13%
[rank3]:2025-11-06 05:14:04,875 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0514_min_batch_time.svg
[rank3]:> Batch Time: 331.90 ms, GPU Bubble Ratio: 69.17%, 49.37%, 57.63%, 10.12%
[rank3]:2025-11-06 05:14:05,130 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0514_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.58 ms, GPU Bubble Ratio: 40.98%, 36.16%, 45.85%, 8.45%
[rank3]:2025-11-06 05:14:05,131 - INFO - 	> Batch Time: 371.58 ms (Average Freeze Ratio: 0.37, Time Reduction Rate: 0.29)
[rank0]:2025-11-06 05:14:24,348 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 05:14:26,220 - INFO - Avg. fwd time: 4.2863 / Avg. bwd time: 9.4527 / Avg. batch time: 607.9510 (ms) / GPU bubble ratio: 63.84%
[rank3]:2025-11-06 05:14:26,246 - INFO - Avg. fwd time: 7.0351 / Avg. bwd time: 19.1449 / Avg. batch time: 530.6032 (ms) / GPU bubble ratio: 21.06%
[rank1]:2025-11-06 05:14:26,289 - INFO - Avg. fwd time: 5.1145 / Avg. bwd time: 10.4729 / Avg. batch time: 589.2924 (ms) / GPU bubble ratio: 57.68%
[rank2]:2025-11-06 05:14:26,276 - INFO - Avg. fwd time: 4.1649 / Avg. bwd time: 8.7126 / Avg. batch time: 563.1504 (ms) / GPU bubble ratio: 63.41%
[rank3]:2025-11-06 05:14:27,067 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.20/0.60, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB0] 0.33/1.00, [MB1] 0.00/0.00, [MB2] 0.31/0.94, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.22/0.66
[rank3]:2025-11-06 05:14:27,069 - INFO -  step: 100  loss:  4.7316  grad_norm:  0.2402  memory: 18.95GiB(39.89%)  tps: 6,667  tflops: 50.78  mfu: 16.28%
[rank2]:2025-11-06 05:14:27,616 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.30/0.89, [MB6] 0.22/0.66, [MB7] 0.33/1.00
[rank2]:2025-11-06 05:14:27,617 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2402  memory:  8.13GiB(17.12%)  tps: 6,637  tflops: 50.55  mfu: 16.20%
[rank0]:2025-11-06 05:14:27,681 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.06/0.19, [MB4] 0.05/0.14, [MB5] 0.33/1.00, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-11-06 05:14:27,681 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2402  memory: 14.71GiB(30.97%)  tps: 6,634  tflops: 50.53  mfu: 16.19%
[rank1]:2025-11-06 05:14:27,680 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-06 05:14:27,681 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.2402  memory: 11.85GiB(24.93%)  tps: 6,634  tflops: 50.52  mfu: 16.19%
[rank2]:2025-11-06 05:14:27,740 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0514_stage2_step100.svg
[rank0]:2025-11-06 05:14:27,738 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0514_stage0_step100.svg
[rank0]:2025-11-06 05:14:27,775 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0514_stage4_step100.svg
[rank1]:2025-11-06 05:14:27,739 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0514_stage1_step100.svg
[rank1]:2025-11-06 05:14:27,777 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0514_stage5_step100.svg
[rank2]:2025-11-06 05:14:27,777 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0514_stage6_step100.svg
[rank3]:2025-11-06 05:14:27,912 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0514_real_step100_rank3.svg
[rank3]:> Batch Time: 509.00 ms, GPU Bubble Ratio: 71.39%, 60.81%, 64.98%, 33.70%
[rank3]:2025-11-06 05:14:27,954 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0514_stage3_step100.svg
[rank3]:2025-11-06 05:14:27,990 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0514_stage7_step100.svg
[rank0]:2025-11-06 05:16:41,386 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 05:16:43,707 - INFO - Avg. fwd time: 7.1234 / Avg. bwd time: 18.4514 / Avg. batch time: 522.3235 (ms) / GPU bubble ratio: 21.66%
[rank0]:2025-11-06 05:16:43,775 - INFO - Avg. fwd time: 4.3156 / Avg. bwd time: 9.4056 / Avg. batch time: 603.6792 (ms) / GPU bubble ratio: 63.63%
[rank1]:2025-11-06 05:16:43,754 - INFO - Avg. fwd time: 5.1597 / Avg. bwd time: 10.1062 / Avg. batch time: 583.7596 (ms) / GPU bubble ratio: 58.16%
[rank2]:2025-11-06 05:16:43,734 - INFO - Avg. fwd time: 4.2103 / Avg. bwd time: 8.5738 / Avg. batch time: 558.9281 (ms) / GPU bubble ratio: 63.40%
[rank2]:2025-11-06 05:16:45,479 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.60/0.89, [MB6] 0.44/0.66, [MB7] 0.67/1.00
[rank2]:2025-11-06 05:16:45,480 - INFO -  step: 150  loss: -4.0000  grad_norm:  9.3047  memory:  8.46GiB(17.81%)  tps: 5,942  tflops: 45.26  mfu: 14.51%
[rank1]:2025-11-06 05:16:45,789 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-06 05:16:45,789 - INFO -  step: 150  loss: -4.0000  grad_norm:  9.3047  memory: 12.37GiB(26.04%)  tps: 5,932  tflops: 45.18  mfu: 14.48%
[rank0]:2025-11-06 05:16:48,018 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.13/0.19, [MB4] 0.10/0.14, [MB5] 0.67/1.00, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-11-06 05:16:48,019 - INFO -  step: 150  loss: -4.0000  grad_norm:  9.3047  memory: 14.97GiB(31.51%)  tps: 5,837  tflops: 44.46  mfu: 14.25%
[rank3]:2025-11-06 05:16:48,438 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.60, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.00/0.00, [MB2] 0.62/0.94, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.44/0.66
[rank3]:2025-11-06 05:16:48,442 - INFO -  step: 150  loss:  2.6178  grad_norm:  9.3047  memory: 19.46GiB(40.96%)  tps: 5,795  tflops: 44.13  mfu: 14.15%
[rank0]:2025-11-06 05:18:50,455 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 05:18:52,356 - INFO - Avg. fwd time: 7.2115 / Avg. bwd time: 17.6308 / Avg. batch time: 512.5615 (ms) / GPU bubble ratio: 22.45%
[rank0]:2025-11-06 05:18:52,356 - INFO - Avg. fwd time: 4.3476 / Avg. bwd time: 8.8783 / Avg. batch time: 599.3496 (ms) / GPU bubble ratio: 64.69%
[rank2]:2025-11-06 05:18:52,385 - INFO - Avg. fwd time: 4.2693 / Avg. bwd time: 8.2556 / Avg. batch time: 557.5405 (ms) / GPU bubble ratio: 64.06%
[rank1]:2025-11-06 05:18:52,426 - INFO - Avg. fwd time: 5.2345 / Avg. bwd time: 9.5714 / Avg. batch time: 580.7313 (ms) / GPU bubble ratio: 59.21%
[rank3]:2025-11-06 05:18:52,978 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.60/0.60, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.94/0.94, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.66/0.66
[rank3]:2025-11-06 05:18:52,981 - INFO -  step: 200  loss:  0.5642  grad_norm:  0.1213  memory: 19.46GiB(40.96%)  tps: 6,578  tflops: 50.10  mfu: 16.06%
[rank2]:2025-11-06 05:18:53,651 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.89/0.89, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank2]:2025-11-06 05:18:53,652 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1213  memory:  8.46GiB(17.81%)  tps: 6,391  tflops: 48.68  mfu: 15.60%
[rank0]:2025-11-06 05:18:53,729 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.19/0.19, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-06 05:18:53,730 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1213  memory: 14.97GiB(31.51%)  tps: 6,517  tflops: 49.63  mfu: 15.91%
[rank0]:2025-11-06 05:18:53,961 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0518_stage0_step200.svg
[rank1]:2025-11-06 05:18:53,910 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 05:18:53,911 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1213  memory: 12.37GiB(26.04%)  tps: 6,394  tflops: 48.70  mfu: 15.61%
[rank1]:2025-11-06 05:18:53,961 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0518_stage1_step200.svg
[rank2]:2025-11-06 05:18:53,961 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0518_stage2_step200.svg
[rank0]:2025-11-06 05:18:54,002 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0518_stage4_step200.svg
[rank1]:2025-11-06 05:18:54,002 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0518_stage5_step200.svg
[rank2]:2025-11-06 05:18:54,003 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0518_stage6_step200.svg
[rank3]:2025-11-06 05:18:54,151 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0518_real_step200_rank3.svg
[rank3]:> Batch Time: 528.95 ms, GPU Bubble Ratio: 65.01%, 61.78%, 65.27%, 34.41%
[rank3]:2025-11-06 05:18:54,198 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0518_stage3_step200.svg
[rank3]:2025-11-06 05:18:54,244 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0518_stage7_step200.svg
[rank0]:2025-11-06 05:20:45,656 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 05:20:47,496 - INFO - Avg. fwd time: 4.3832 / Avg. bwd time: 8.0036 / Avg. batch time: 585.0636 (ms) / GPU bubble ratio: 66.13%
[rank2]:2025-11-06 05:20:47,547 - INFO - Avg. fwd time: 4.3365 / Avg. bwd time: 7.9158 / Avg. batch time: 546.7705 (ms) / GPU bubble ratio: 64.15%
[rank3]:2025-11-06 05:20:47,518 - INFO - Avg. fwd time: 7.3146 / Avg. bwd time: 16.7693 / Avg. batch time: 502.3109 (ms) / GPU bubble ratio: 23.29%
[rank1]:2025-11-06 05:20:47,560 - INFO - Avg. fwd time: 5.3176 / Avg. bwd time: 9.0159 / Avg. batch time: 568.5329 (ms) / GPU bubble ratio: 59.66%
[rank3]:2025-11-06 05:20:48,338 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.60/0.60, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.94/0.94, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.66/0.66
[rank3]:2025-11-06 05:20:48,340 - INFO -  step: 250  loss:  0.4156  grad_norm:  0.1183  memory: 19.46GiB(40.96%)  tps: 7,101  tflops: 54.09  mfu: 17.34%
[rank2]:2025-11-06 05:20:48,828 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.89/0.89, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank2]:2025-11-06 05:20:48,829 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1183  memory:  8.46GiB(17.81%)  tps: 7,113  tflops: 54.17  mfu: 17.36%
[rank1]:2025-11-06 05:20:48,855 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 05:20:48,855 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1183  memory: 12.37GiB(26.04%)  tps: 7,127  tflops: 54.28  mfu: 17.40%
[rank0]:2025-11-06 05:20:48,894 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.19/0.19, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-06 05:20:48,895 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1183  memory: 14.97GiB(31.51%)  tps: 7,113  tflops: 54.18  mfu: 17.36%
[rank0]:2025-11-06 05:22:40,356 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 05:22:42,489 - INFO - Avg. fwd time: 7.3773 / Avg. bwd time: 16.2437 / Avg. batch time: 496.0518 (ms) / GPU bubble ratio: 23.81%
[rank2]:2025-11-06 05:22:42,510 - INFO - Avg. fwd time: 4.3778 / Avg. bwd time: 7.6931 / Avg. batch time: 539.5984 (ms) / GPU bubble ratio: 64.21%
[rank1]:2025-11-06 05:22:42,527 - INFO - Avg. fwd time: 5.3687 / Avg. bwd time: 8.6488 / Avg. batch time: 560.4195 (ms) / GPU bubble ratio: 59.98%
[rank0]:2025-11-06 05:22:42,538 - INFO - Avg. fwd time: 4.4061 / Avg. bwd time: 7.4135 / Avg. batch time: 575.5932 (ms) / GPU bubble ratio: 67.14%
[rank2]:2025-11-06 05:22:43,535 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.89/0.89, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank2]:2025-11-06 05:22:43,536 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1932  memory:  8.46GiB(17.81%)  tps: 7,142  tflops: 54.39  mfu: 17.43%
[rank1]:2025-11-06 05:22:43,619 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 05:22:43,620 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1932  memory: 12.37GiB(26.04%)  tps: 7,138  tflops: 54.37  mfu: 17.42%
[rank0]:2025-11-06 05:22:43,684 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.19/0.19, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-06 05:22:43,684 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1932  memory: 14.97GiB(31.51%)  tps: 7,137  tflops: 54.35  mfu: 17.42%
[rank3]:2025-11-06 05:22:46,156 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.60/0.60, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.94/0.94, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.66/0.66
[rank3]:2025-11-06 05:22:46,158 - INFO -  step: 300  loss:  0.2929  grad_norm:  0.1932  memory: 19.46GiB(40.96%)  tps: 6,953  tflops: 52.96  mfu: 16.97%
[rank2]:2025-11-06 05:22:46,213 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0522_stage2_step300.svg
[rank2]:2025-11-06 05:22:46,254 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0522_stage6_step300.svg
[rank1]:2025-11-06 05:22:46,213 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0522_stage1_step300.svg
[rank1]:2025-11-06 05:22:46,252 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0522_stage5_step300.svg
[rank0]:2025-11-06 05:22:46,212 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0522_stage0_step300.svg
[rank0]:2025-11-06 05:22:46,253 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0522_stage4_step300.svg
[rank3]:2025-11-06 05:22:46,404 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0522_real_step300_rank3.svg
[rank3]:> Batch Time: 522.50 ms, GPU Bubble Ratio: 72.19%, 61.64%, 65.50%, 33.40%
[rank3]:2025-11-06 05:22:46,460 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0522_stage3_step300.svg
[rank3]:2025-11-06 05:22:46,515 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0522_stage7_step300.svg
[rank0]:2025-11-06 05:24:38,285 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 05:24:40,197 - INFO - Avg. fwd time: 7.4192 / Avg. bwd time: 15.9202 / Avg. batch time: 492.3054 (ms) / GPU bubble ratio: 24.15%
[rank2]:2025-11-06 05:24:40,225 - INFO - Avg. fwd time: 4.4042 / Avg. bwd time: 7.5570 / Avg. batch time: 535.7920 (ms) / GPU bubble ratio: 64.28%
[rank1]:2025-11-06 05:24:40,237 - INFO - Avg. fwd time: 5.4018 / Avg. bwd time: 8.4233 / Avg. batch time: 556.0342 (ms) / GPU bubble ratio: 60.22%
[rank0]:2025-11-06 05:24:40,172 - INFO - Avg. fwd time: 4.4186 / Avg. bwd time: 7.0528 / Avg. batch time: 570.3347 (ms) / GPU bubble ratio: 67.82%
[rank2]:2025-11-06 05:24:41,456 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1281  memory:  8.46GiB(17.81%)  tps: 6,947  tflops: 52.91  mfu: 16.96%
[rank0]:2025-11-06 05:24:41,476 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1281  memory: 14.97GiB(31.51%)  tps: 6,955  tflops: 52.97  mfu: 16.98%
[rank1]:2025-11-06 05:24:41,584 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1281  memory: 12.37GiB(26.04%)  tps: 6,945  tflops: 52.89  mfu: 16.95%
[rank3]:2025-11-06 05:24:43,971 - INFO -  step: 350  loss:  0.2746  grad_norm:  0.1281  memory: 19.46GiB(40.96%)  tps: 6,954  tflops: 52.96  mfu: 16.97%
[rank0]:2025-11-06 05:26:35,986 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 05:26:37,891 - INFO - Avg. fwd time: 4.4299 / Avg. bwd time: 6.7358 / Avg. batch time: 567.0528 (ms) / GPU bubble ratio: 68.49%
[rank3]:2025-11-06 05:26:37,915 - INFO - Avg. fwd time: 7.4573 / Avg. bwd time: 15.6470 / Avg. batch time: 489.1791 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-11-06 05:26:37,956 - INFO - Avg. fwd time: 5.4312 / Avg. bwd time: 8.2255 / Avg. batch time: 553.4390 (ms) / GPU bubble ratio: 60.52%
[rank2]:2025-11-06 05:26:37,944 - INFO - Avg. fwd time: 4.4284 / Avg. bwd time: 7.4370 / Avg. batch time: 533.7060 (ms) / GPU bubble ratio: 64.43%
[rank1]:2025-11-06 05:26:39,251 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1218  memory: 12.37GiB(26.04%)  tps: 6,962  tflops: 53.02  mfu: 16.99%
[rank0]:2025-11-06 05:26:39,260 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1218  memory: 14.97GiB(31.51%)  tps: 6,955  tflops: 52.97  mfu: 16.98%
[rank2]:2025-11-06 05:26:39,227 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1218  memory:  8.46GiB(17.81%)  tps: 6,956  tflops: 52.98  mfu: 16.98%
[rank3]:2025-11-06 05:26:41,933 - INFO -  step: 400  loss:  0.2663  grad_norm:  0.1218  memory: 19.46GiB(40.96%)  tps: 6,945  tflops: 52.89  mfu: 16.95%
[rank1]:2025-11-06 05:26:41,986 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0526_stage1_step400.svg
[rank0]:2025-11-06 05:26:41,986 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0526_stage0_step400.svg
[rank2]:2025-11-06 05:26:41,988 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0526_stage2_step400.svg
[rank1]:2025-11-06 05:26:42,029 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0526_stage5_step400.svg
[rank0]:2025-11-06 05:26:42,029 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0526_stage4_step400.svg
[rank2]:2025-11-06 05:26:42,034 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0526_stage6_step400.svg
[rank3]:2025-11-06 05:26:42,177 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0526_real_step400_rank3.svg
[rank3]:> Batch Time: 521.50 ms, GPU Bubble Ratio: 72.19%, 61.49%, 65.50%, 33.61%
[rank3]:2025-11-06 05:26:42,223 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0526_stage3_step400.svg
[rank3]:2025-11-06 05:26:42,266 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0526_stage7_step400.svg
[rank3]:2025-11-06 05:26:53,198 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 05:26:53,417 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 05:26:53,417 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 05:26:53,409 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 05:28:32,937 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-06 05:28:35,045 - INFO - Avg. fwd time: 5.4537 / Avg. bwd time: 8.0722 / Avg. batch time: 549.5640 (ms) / GPU bubble ratio: 60.62%
[rank3]:2025-11-06 05:28:35,006 - INFO - Avg. fwd time: 7.4833 / Avg. bwd time: 15.4185 / Avg. batch time: 486.4311 (ms) / GPU bubble ratio: 24.67%
[rank2]:2025-11-06 05:28:35,027 - INFO - Avg. fwd time: 4.4463 / Avg. bwd time: 7.3444 / Avg. batch time: 530.2212 (ms) / GPU bubble ratio: 64.42%
[rank0]:2025-11-06 05:28:35,057 - INFO - Avg. fwd time: 4.4389 / Avg. bwd time: 6.4884 / Avg. batch time: 562.6223 (ms) / GPU bubble ratio: 68.92%
[rank3]:2025-11-06 05:28:35,623 - INFO -  step: 450  loss:  0.2618  grad_norm:  0.1068  memory: 19.46GiB(40.96%)  tps: 7,206  tflops: 54.88  mfu: 17.59%
[rank2]:2025-11-06 05:28:36,102 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1068  memory:  8.46GiB(17.81%)  tps: 7,009  tflops: 53.38  mfu: 17.11%
[rank0]:2025-11-06 05:28:36,232 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1068  memory: 14.97GiB(31.51%)  tps: 7,003  tflops: 53.34  mfu: 17.10%
[rank1]:2025-11-06 05:28:36,221 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1068  memory: 12.37GiB(26.04%)  tps: 7,004  tflops: 53.34  mfu: 17.10%
[rank0]:2025-11-06 05:30:24,142 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-06 05:30:26,091 - INFO - Avg. fwd time: 5.4712 / Avg. bwd time: 7.9669 / Avg. batch time: 545.4919 (ms) / GPU bubble ratio: 60.58%
[rank0]:2025-11-06 05:30:26,025 - INFO - Avg. fwd time: 4.4458 / Avg. bwd time: 6.3192 / Avg. batch time: 558.1692 (ms) / GPU bubble ratio: 69.14%
[rank3]:2025-11-06 05:30:26,052 - INFO - Avg. fwd time: 7.5030 / Avg. bwd time: 15.2358 / Avg. batch time: 484.1786 (ms) / GPU bubble ratio: 24.86%
[rank2]:2025-11-06 05:30:26,079 - INFO - Avg. fwd time: 4.4603 / Avg. bwd time: 7.2794 / Avg. batch time: 526.4189 (ms) / GPU bubble ratio: 64.32%
[rank3]:2025-11-06 05:30:26,879 - INFO -  step: 500  loss:  0.2848  grad_norm:  0.1203  memory: 19.46GiB(40.96%)  tps: 7,363  tflops: 56.08  mfu: 17.97%
[rank1]:2025-11-06 05:30:27,364 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1203  memory: 12.37GiB(26.04%)  tps: 7,371  tflops: 56.14  mfu: 17.99%
[rank0]:2025-11-06 05:30:27,395 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1203  memory: 14.97GiB(31.51%)  tps: 7,369  tflops: 56.13  mfu: 17.99%
[rank2]:2025-11-06 05:30:27,361 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1203  memory:  8.46GiB(17.81%)  tps: 7,363  tflops: 56.08  mfu: 17.97%
[rank1]:2025-11-06 05:30:27,443 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0530_stage1_step500.svg
[rank1]:2025-11-06 05:30:27,483 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0530_stage5_step500.svg
[rank0]:2025-11-06 05:30:27,443 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0530_stage0_step500.svg
[rank0]:2025-11-06 05:30:27,482 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0530_stage4_step500.svg
[rank2]:2025-11-06 05:30:27,444 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0530_stage2_step500.svg
[rank2]:2025-11-06 05:30:27,483 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0530_stage6_step500.svg
[rank3]:2025-11-06 05:30:27,628 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0530_real_step500_rank3.svg
[rank3]:> Batch Time: 515.00 ms, GPU Bubble Ratio: 71.55%, 60.99%, 65.07%, 34.04%
[rank3]:2025-11-06 05:30:27,670 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0530_stage3_step500.svg
[rank3]:2025-11-06 05:30:27,709 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0530_stage7_step500.svg
[rank0]:2025-11-06 05:32:22,032 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 05:32:23,944 - INFO - Avg. fwd time: 4.4514 / Avg. bwd time: 6.1577 / Avg. batch time: 556.8868 (ms) / GPU bubble ratio: 69.52%
[rank3]:2025-11-06 05:32:23,968 - INFO - Avg. fwd time: 7.5210 / Avg. bwd time: 15.1036 / Avg. batch time: 482.6632 (ms) / GPU bubble ratio: 25.00%
[rank1]:2025-11-06 05:32:24,011 - INFO - Avg. fwd time: 5.4852 / Avg. bwd time: 7.8659 / Avg. batch time: 544.6190 (ms) / GPU bubble ratio: 60.78%
[rank2]:2025-11-06 05:32:23,997 - INFO - Avg. fwd time: 4.4721 / Avg. bwd time: 7.2182 / Avg. batch time: 525.8023 (ms) / GPU bubble ratio: 64.43%
[rank2]:2025-11-06 05:32:25,234 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1289  memory:  8.46GiB(17.81%)  tps: 6,950  tflops: 52.93  mfu: 16.97%
[rank0]:2025-11-06 05:32:25,270 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1289  memory: 14.97GiB(31.51%)  tps: 6,950  tflops: 52.93  mfu: 16.97%
[rank1]:2025-11-06 05:32:25,359 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1289  memory: 12.37GiB(26.04%)  tps: 6,943  tflops: 52.88  mfu: 16.95%
[rank3]:2025-11-06 05:32:27,948 - INFO -  step: 550  loss:  0.3294  grad_norm:  0.1289  memory: 19.46GiB(40.96%)  tps: 6,766  tflops: 51.53  mfu: 16.52%
[rank0]:2025-11-06 05:34:22,052 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 05:34:24,168 - INFO - Avg. fwd time: 4.4824 / Avg. bwd time: 7.1682 / Avg. batch time: 526.2720 (ms) / GPU bubble ratio: 64.58%
[rank1]:2025-11-06 05:34:24,188 - INFO - Avg. fwd time: 5.4976 / Avg. bwd time: 7.7828 / Avg. batch time: 544.8780 (ms) / GPU bubble ratio: 61.00%
[rank3]:2025-11-06 05:34:24,146 - INFO - Avg. fwd time: 7.5371 / Avg. bwd time: 14.9900 / Avg. batch time: 481.3545 (ms) / GPU bubble ratio: 25.12%
[rank0]:2025-11-06 05:34:24,202 - INFO - Avg. fwd time: 4.4570 / Avg. bwd time: 6.0190 / Avg. batch time: 556.8462 (ms) / GPU bubble ratio: 69.90%
[rank3]:2025-11-06 05:34:24,645 - INFO -  step: 600  loss:  0.2469  grad_norm:  0.0984  memory: 19.46GiB(40.96%)  tps: 7,020  tflops: 53.47  mfu: 17.14%
[rank1]:2025-11-06 05:34:25,306 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0984  memory: 12.37GiB(26.04%)  tps: 6,830  tflops: 52.02  mfu: 16.67%
[rank0]:2025-11-06 05:34:25,285 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0984  memory: 14.97GiB(31.51%)  tps: 6,826  tflops: 51.99  mfu: 16.66%
[rank2]:2025-11-06 05:34:25,333 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0984  memory:  8.46GiB(17.81%)  tps: 6,821  tflops: 51.95  mfu: 16.65%
[rank1]:2025-11-06 05:34:25,398 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0534_stage1_step600.svg
[rank0]:2025-11-06 05:34:25,399 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0534_stage0_step600.svg
[rank2]:2025-11-06 05:34:25,398 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0534_stage2_step600.svg
[rank2]:2025-11-06 05:34:25,439 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0534_stage6_step600.svg
[rank1]:2025-11-06 05:34:25,441 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0534_stage5_step600.svg
[rank0]:2025-11-06 05:34:25,441 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0534_stage4_step600.svg
[rank3]:2025-11-06 05:34:25,564 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0534_real_step600_rank3.svg
[rank3]:> Batch Time: 514.50 ms, GPU Bubble Ratio: 71.48%, 60.87%, 64.97%, 34.44%
[rank3]:2025-11-06 05:34:25,607 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0534_stage3_step600.svg
[rank3]:2025-11-06 05:34:25,647 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0534_stage7_step600.svg
[rank0]:2025-11-06 05:36:16,901 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 05:36:18,784 - INFO - Avg. fwd time: 4.4619 / Avg. bwd time: 5.9147 / Avg. batch time: 555.1402 (ms) / GPU bubble ratio: 70.09%
[rank1]:2025-11-06 05:36:18,849 - INFO - Avg. fwd time: 5.5073 / Avg. bwd time: 7.7217 / Avg. batch time: 543.4325 (ms) / GPU bubble ratio: 61.05%
[rank3]:2025-11-06 05:36:18,807 - INFO - Avg. fwd time: 7.5464 / Avg. bwd time: 14.8950 / Avg. batch time: 480.1829 (ms) / GPU bubble ratio: 25.22%
[rank2]:2025-11-06 05:36:18,836 - INFO - Avg. fwd time: 4.4907 / Avg. bwd time: 7.1307 / Avg. batch time: 524.9823 (ms) / GPU bubble ratio: 64.58%
[rank2]:2025-11-06 05:36:20,076 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1128  memory:  8.46GiB(17.81%)  tps: 7,139  tflops: 54.38  mfu: 17.43%
[rank1]:2025-11-06 05:36:20,149 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1128  memory: 12.37GiB(26.04%)  tps: 7,133  tflops: 54.33  mfu: 17.41%
[rank0]:2025-11-06 05:36:20,123 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1128  memory: 14.97GiB(31.51%)  tps: 7,134  tflops: 54.33  mfu: 17.41%
[rank3]:2025-11-06 05:36:22,592 - INFO -  step: 650  loss:  0.2588  grad_norm:  0.1128  memory: 19.46GiB(40.96%)  tps: 6,946  tflops: 52.90  mfu: 16.95%
[rank0]:2025-11-06 05:38:13,512 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 05:38:15,418 - INFO - Avg. fwd time: 7.5571 / Avg. bwd time: 14.7991 / Avg. batch time: 479.0341 (ms) / GPU bubble ratio: 25.33%
[rank0]:2025-11-06 05:38:15,384 - INFO - Avg. fwd time: 4.4657 / Avg. bwd time: 5.8174 / Avg. batch time: 554.0112 (ms) / GPU bubble ratio: 70.30%
[rank2]:2025-11-06 05:38:15,446 - INFO - Avg. fwd time: 4.4979 / Avg. bwd time: 7.0933 / Avg. batch time: 524.2669 (ms) / GPU bubble ratio: 64.62%
[rank1]:2025-11-06 05:38:15,458 - INFO - Avg. fwd time: 5.5158 / Avg. bwd time: 7.6603 / Avg. batch time: 542.5590 (ms) / GPU bubble ratio: 61.14%
[rank3]:2025-11-06 05:38:16,236 - INFO -  step: 700  loss:  0.2366  grad_norm:  0.1023  memory: 19.46GiB(40.96%)  tps: 7,209  tflops: 54.90  mfu: 17.60%
[rank2]:2025-11-06 05:38:16,700 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1023  memory:  8.46GiB(17.81%)  tps: 7,024  tflops: 53.50  mfu: 17.15%
[rank1]:2025-11-06 05:38:16,761 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1023  memory: 12.37GiB(26.04%)  tps: 7,025  tflops: 53.50  mfu: 17.15%
[rank1]:2025-11-06 05:38:16,822 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0538_stage1_step700.svg
[rank0]:2025-11-06 05:38:16,772 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1023  memory: 14.97GiB(31.51%)  tps: 7,023  tflops: 53.49  mfu: 17.14%
[rank0]:2025-11-06 05:38:16,822 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0538_stage0_step700.svg
[rank2]:2025-11-06 05:38:16,823 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0538_stage2_step700.svg
[rank2]:2025-11-06 05:38:16,866 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0538_stage6_step700.svg
[rank1]:2025-11-06 05:38:16,865 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0538_stage5_step700.svg
[rank0]:2025-11-06 05:38:16,865 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0538_stage4_step700.svg
[rank3]:2025-11-06 05:38:17,003 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0538_real_step700_rank3.svg
[rank3]:> Batch Time: 514.50 ms, GPU Bubble Ratio: 71.41%, 60.97%, 65.08%, 33.98%
[rank3]:2025-11-06 05:38:17,047 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0538_stage3_step700.svg
[rank3]:2025-11-06 05:38:17,089 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0538_stage7_step700.svg
[rank0]:2025-11-06 05:40:08,367 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 05:40:10,484 - INFO - Avg. fwd time: 7.5670 / Avg. bwd time: 14.7273 / Avg. batch time: 478.2034 (ms) / GPU bubble ratio: 25.41%
[rank2]:2025-11-06 05:40:10,508 - INFO - Avg. fwd time: 4.5044 / Avg. bwd time: 7.0622 / Avg. batch time: 522.9823 (ms) / GPU bubble ratio: 64.61%
[rank1]:2025-11-06 05:40:10,531 - INFO - Avg. fwd time: 5.5240 / Avg. bwd time: 7.6080 / Avg. batch time: 541.1436 (ms) / GPU bubble ratio: 61.17%
[rank0]:2025-11-06 05:40:10,545 - INFO - Avg. fwd time: 4.4690 / Avg. bwd time: 5.7312 / Avg. batch time: 552.4064 (ms) / GPU bubble ratio: 70.46%
[rank1]:2025-11-06 05:40:11,661 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1134  memory: 12.37GiB(26.04%)  tps: 7,130  tflops: 54.30  mfu: 17.40%
[rank0]:2025-11-06 05:40:11,709 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1134  memory: 14.97GiB(31.51%)  tps: 7,127  tflops: 54.28  mfu: 17.40%
[rank2]:2025-11-06 05:40:11,767 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1134  memory:  8.46GiB(17.81%)  tps: 7,119  tflops: 54.22  mfu: 17.38%
[rank3]:2025-11-06 05:40:13,980 - INFO -  step: 750  loss:  0.2971  grad_norm:  0.1134  memory: 19.46GiB(40.96%)  tps: 6,958  tflops: 52.99  mfu: 16.98%
[rank0]:2025-11-06 05:42:05,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-06 05:42:07,219 - INFO - Avg. fwd time: 5.5305 / Avg. bwd time: 7.5690 / Avg. batch time: 540.8624 (ms) / GPU bubble ratio: 61.25%
[rank0]:2025-11-06 05:42:07,153 - INFO - Avg. fwd time: 4.4711 / Avg. bwd time: 5.6686 / Avg. batch time: 551.9603 (ms) / GPU bubble ratio: 70.61%
[rank3]:2025-11-06 05:42:07,170 - INFO - Avg. fwd time: 7.5752 / Avg. bwd time: 14.6680 / Avg. batch time: 477.5131 (ms) / GPU bubble ratio: 25.47%
[rank2]:2025-11-06 05:42:07,207 - INFO - Avg. fwd time: 4.5096 / Avg. bwd time: 7.0383 / Avg. batch time: 522.7878 (ms) / GPU bubble ratio: 64.66%
[rank3]:2025-11-06 05:42:07,954 - INFO -  step: 800  loss:  0.2439  grad_norm:  0.1140  memory: 19.46GiB(40.96%)  tps: 7,188  tflops: 54.74  mfu: 17.55%
[rank2]:2025-11-06 05:42:08,470 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1140  memory:  8.46GiB(17.81%)  tps: 7,020  tflops: 53.46  mfu: 17.14%
[rank1]:2025-11-06 05:42:08,532 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1140  memory: 12.37GiB(26.04%)  tps: 7,009  tflops: 53.39  mfu: 17.11%
[rank1]:2025-11-06 05:42:08,609 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0542_stage1_step800.svg
[rank1]:2025-11-06 05:42:08,652 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0542_stage5_step800.svg
[rank0]:2025-11-06 05:42:08,556 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1140  memory: 14.97GiB(31.51%)  tps: 7,011  tflops: 53.40  mfu: 17.11%
[rank0]:2025-11-06 05:42:08,609 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0542_stage0_step800.svg
[rank0]:2025-11-06 05:42:08,653 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0542_stage4_step800.svg
[rank2]:2025-11-06 05:42:08,609 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0542_stage2_step800.svg
[rank2]:2025-11-06 05:42:08,654 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0542_stage6_step800.svg
[rank3]:2025-11-06 05:42:08,788 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0542_real_step800_rank3.svg
[rank3]:> Batch Time: 524.00 ms, GPU Bubble Ratio: 72.17%, 61.67%, 65.68%, 33.84%
[rank3]:2025-11-06 05:42:08,834 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0542_stage3_step800.svg
[rank3]:2025-11-06 05:42:08,877 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0542_stage7_step800.svg
[rank3]:2025-11-06 05:42:32,501 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 05:42:32,730 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 05:42:32,730 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 05:42:32,722 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 05:43:57,291 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 05:43:59,183 - INFO - Avg. fwd time: 4.4729 / Avg. bwd time: 5.6074 / Avg. batch time: 549.7999 (ms) / GPU bubble ratio: 70.66%
[rank3]:2025-11-06 05:43:59,200 - INFO - Avg. fwd time: 7.5824 / Avg. bwd time: 14.6009 / Avg. batch time: 476.6725 (ms) / GPU bubble ratio: 25.54%
[rank1]:2025-11-06 05:43:59,251 - INFO - Avg. fwd time: 5.5368 / Avg. bwd time: 7.5279 / Avg. batch time: 538.8630 (ms) / GPU bubble ratio: 61.21%
[rank2]:2025-11-06 05:43:59,238 - INFO - Avg. fwd time: 4.5144 / Avg. bwd time: 7.0131 / Avg. batch time: 520.8922 (ms) / GPU bubble ratio: 64.59%
[rank1]:2025-11-06 05:44:00,516 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1237  memory: 12.37GiB(26.04%)  tps: 7,315  tflops: 55.72  mfu: 17.86%
[rank2]:2025-11-06 05:44:00,577 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1237  memory:  8.46GiB(17.81%)  tps: 7,307  tflops: 55.65  mfu: 17.84%
[rank0]:2025-11-06 05:44:00,598 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1237  memory: 14.97GiB(31.51%)  tps: 7,312  tflops: 55.69  mfu: 17.85%
[rank3]:2025-11-06 05:44:03,216 - INFO -  step: 850  loss:  0.2524  grad_norm:  0.1237  memory: 19.46GiB(40.96%)  tps: 7,107  tflops: 54.13  mfu: 17.35%
[rank0]:2025-11-06 05:45:54,417 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 05:45:56,519 - INFO - Avg. fwd time: 7.5881 / Avg. bwd time: 14.5494 / Avg. batch time: 476.0451 (ms) / GPU bubble ratio: 25.60%
[rank2]:2025-11-06 05:45:56,544 - INFO - Avg. fwd time: 4.5181 / Avg. bwd time: 6.9906 / Avg. batch time: 520.7053 (ms) / GPU bubble ratio: 64.64%
[rank1]:2025-11-06 05:45:56,568 - INFO - Avg. fwd time: 5.5418 / Avg. bwd time: 7.4912 / Avg. batch time: 538.5840 (ms) / GPU bubble ratio: 61.28%
[rank0]:2025-11-06 05:45:56,584 - INFO - Avg. fwd time: 4.4740 / Avg. bwd time: 5.5558 / Avg. batch time: 549.3661 (ms) / GPU bubble ratio: 70.79%
[rank3]:2025-11-06 05:45:57,158 - INFO -  step: 900  loss:  0.2201  grad_norm:  0.0922  memory: 19.46GiB(40.96%)  tps: 7,190  tflops: 54.76  mfu: 17.55%
[rank2]:2025-11-06 05:45:57,680 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0922  memory:  8.46GiB(17.81%)  tps: 6,996  tflops: 53.28  mfu: 17.08%
[rank1]:2025-11-06 05:45:57,745 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0922  memory: 12.37GiB(26.04%)  tps: 6,988  tflops: 53.22  mfu: 17.06%
[rank0]:2025-11-06 05:45:57,728 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0922  memory: 14.97GiB(31.51%)  tps: 6,994  tflops: 53.27  mfu: 17.07%
[rank2]:2025-11-06 05:45:57,793 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0545_stage2_step900.svg
[rank1]:2025-11-06 05:45:57,818 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0545_stage1_step900.svg
[rank1]:2025-11-06 05:45:57,856 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0545_stage5_step900.svg
[rank0]:2025-11-06 05:45:57,818 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0545_stage0_step900.svg
[rank0]:2025-11-06 05:45:57,856 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0545_stage4_step900.svg
[rank2]:2025-11-06 05:45:57,832 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0545_stage6_step900.svg
[rank3]:2025-11-06 05:45:57,979 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0545_real_step900_rank3.svg
[rank3]:> Batch Time: 514.50 ms, GPU Bubble Ratio: 71.06%, 60.99%, 65.10%, 34.23%
[rank3]:2025-11-06 05:45:58,019 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0545_stage3_step900.svg
[rank3]:2025-11-06 05:45:58,057 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0545_stage7_step900.svg
[rank0]:2025-11-06 05:47:51,721 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 05:47:53,607 - INFO - Avg. fwd time: 7.5928 / Avg. bwd time: 14.5133 / Avg. batch time: 475.6297 (ms) / GPU bubble ratio: 25.64%
[rank0]:2025-11-06 05:47:53,584 - INFO - Avg. fwd time: 4.4752 / Avg. bwd time: 5.5123 / Avg. batch time: 549.2182 (ms) / GPU bubble ratio: 70.90%
[rank2]:2025-11-06 05:47:53,635 - INFO - Avg. fwd time: 4.5212 / Avg. bwd time: 6.9735 / Avg. batch time: 520.7157 (ms) / GPU bubble ratio: 64.68%
[rank1]:2025-11-06 05:47:53,650 - INFO - Avg. fwd time: 5.5456 / Avg. bwd time: 7.4630 / Avg. batch time: 538.5435 (ms) / GPU bubble ratio: 61.35%
[rank3]:2025-11-06 05:47:54,600 - INFO -  step: 950  loss:  0.2701  grad_norm:  0.1065  memory: 19.46GiB(40.96%)  tps: 6,975  tflops: 53.13  mfu: 17.03%
[rank0]:2025-11-06 05:47:54,914 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1065  memory: 14.97GiB(31.51%)  tps: 6,991  tflops: 53.24  mfu: 17.06%
[rank2]:2025-11-06 05:47:54,930 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1065  memory:  8.46GiB(17.81%)  tps: 6,987  tflops: 53.21  mfu: 17.06%
[rank1]:2025-11-06 05:47:54,950 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1065  memory: 12.37GiB(26.04%)  tps: 6,989  tflops: 53.23  mfu: 17.06%
[rank0]:2025-11-06 05:49:49,015 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 05:49:50,966 - INFO - Avg. fwd time: 7.5987 / Avg. bwd time: 14.4771 / Avg. batch time: 475.2342 (ms) / GPU bubble ratio: 25.68%
[rank0]:2025-11-06 05:49:50,931 - INFO - Avg. fwd time: 4.4773 / Avg. bwd time: 5.4629 / Avg. batch time: 548.8210 (ms) / GPU bubble ratio: 71.02%
[rank2]:2025-11-06 05:49:50,991 - INFO - Avg. fwd time: 4.5249 / Avg. bwd time: 6.9560 / Avg. batch time: 520.5172 (ms) / GPU bubble ratio: 64.71%
[rank1]:2025-11-06 05:49:51,005 - INFO - Avg. fwd time: 5.5495 / Avg. bwd time: 7.4338 / Avg. batch time: 538.2678 (ms) / GPU bubble ratio: 61.41%
[rank2]:2025-11-06 05:49:52,236 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1063  memory:  8.46GiB(17.81%)  tps: 6,983  tflops: 53.19  mfu: 17.05%
[rank1]:2025-11-06 05:49:52,305 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1063  memory: 12.37GiB(26.04%)  tps: 6,981  tflops: 53.17  mfu: 17.04%
[rank0]:2025-11-06 05:49:52,324 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1063  memory: 14.97GiB(31.51%)  tps: 6,977  tflops: 53.14  mfu: 17.03%
[rank3]:2025-11-06 05:49:54,766 - INFO -  step: 1000  loss:  0.2629  grad_norm:  0.1063  memory: 19.46GiB(40.96%)  tps: 6,817  tflops: 51.92  mfu: 16.64%
[rank2]:2025-11-06 05:49:54,816 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0549_stage2_step1000.svg
[rank1]:2025-11-06 05:49:54,816 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0549_stage1_step1000.svg
[rank1]:2025-11-06 05:49:54,856 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0549_stage5_step1000.svg
[rank0]:2025-11-06 05:49:54,815 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0549_stage0_step1000.svg
[rank0]:2025-11-06 05:49:54,856 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0549_stage4_step1000.svg
[rank2]:2025-11-06 05:49:54,857 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0549_stage6_step1000.svg
[rank3]:2025-11-06 05:49:55,003 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0549_real_step1000_rank3.svg
[rank3]:> Batch Time: 522.00 ms, GPU Bubble Ratio: 71.66%, 61.61%, 65.60%, 33.61%
[rank3]:2025-11-06 05:49:55,046 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0549_stage3_step1000.svg
[rank3]:2025-11-06 05:49:55,086 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0549_stage7_step1000.svg
[rank0]:2025-11-06 05:51:43,401 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 05:51:45,492 - INFO - Avg. fwd time: 7.6051 / Avg. bwd time: 14.4316 / Avg. batch time: 474.6846 (ms) / GPU bubble ratio: 25.72%
[rank2]:2025-11-06 05:51:45,520 - INFO - Avg. fwd time: 4.5280 / Avg. bwd time: 6.9395 / Avg. batch time: 519.1059 (ms) / GPU bubble ratio: 64.65%
[rank1]:2025-11-06 05:51:45,545 - INFO - Avg. fwd time: 5.5536 / Avg. bwd time: 7.4072 / Avg. batch time: 536.7885 (ms) / GPU bubble ratio: 61.37%
[rank0]:2025-11-06 05:51:45,563 - INFO - Avg. fwd time: 4.4785 / Avg. bwd time: 5.4253 / Avg. batch time: 547.2392 (ms) / GPU bubble ratio: 71.04%
[rank3]:2025-11-06 05:51:46,095 - INFO -  step: 1050  loss:  0.3062  grad_norm:  0.1230  memory: 19.46GiB(40.96%)  tps: 7,359  tflops: 56.04  mfu: 17.96%
[rank2]:2025-11-06 05:51:46,573 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1230  memory:  8.46GiB(17.81%)  tps: 7,165  tflops: 54.57  mfu: 17.49%
[rank1]:2025-11-06 05:51:46,724 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1230  memory: 12.37GiB(26.04%)  tps: 7,160  tflops: 54.53  mfu: 17.48%
[rank0]:2025-11-06 05:51:46,747 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1230  memory: 14.97GiB(31.51%)  tps: 7,159  tflops: 54.53  mfu: 17.48%
[rank0]:2025-11-06 05:53:40,572 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 05:53:42,479 - INFO - Avg. fwd time: 7.6079 / Avg. bwd time: 14.4043 / Avg. batch time: 474.3541 (ms) / GPU bubble ratio: 25.75%
[rank0]:2025-11-06 05:53:42,455 - INFO - Avg. fwd time: 4.4796 / Avg. bwd time: 5.3936 / Avg. batch time: 547.1830 (ms) / GPU bubble ratio: 71.13%
[rank2]:2025-11-06 05:53:42,508 - INFO - Avg. fwd time: 4.5305 / Avg. bwd time: 6.9271 / Avg. batch time: 519.1934 (ms) / GPU bubble ratio: 64.69%
[rank1]:2025-11-06 05:53:42,523 - INFO - Avg. fwd time: 5.5566 / Avg. bwd time: 7.3863 / Avg. batch time: 536.8209 (ms) / GPU bubble ratio: 61.42%
[rank3]:2025-11-06 05:53:43,264 - INFO -  step: 1100  loss:  0.2652  grad_norm:  0.1137  memory: 19.46GiB(40.96%)  tps: 6,992  tflops: 53.25  mfu: 17.07%
[rank2]:2025-11-06 05:53:43,792 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1137  memory:  8.46GiB(17.81%)  tps: 6,989  tflops: 53.23  mfu: 17.06%
[rank1]:2025-11-06 05:53:43,801 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1137  memory: 12.37GiB(26.04%)  tps: 6,997  tflops: 53.29  mfu: 17.08%
[rank0]:2025-11-06 05:53:43,861 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1137  memory: 14.97GiB(31.51%)  tps: 6,995  tflops: 53.27  mfu: 17.08%
[rank2]:2025-11-06 05:53:43,912 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0553_stage2_step1100.svg
[rank2]:2025-11-06 05:53:43,953 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0553_stage6_step1100.svg
[rank1]:2025-11-06 05:53:43,910 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0553_stage1_step1100.svg
[rank1]:2025-11-06 05:53:43,951 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0553_stage5_step1100.svg
[rank0]:2025-11-06 05:53:43,910 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0553_stage0_step1100.svg
[rank0]:2025-11-06 05:53:43,950 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0553_stage4_step1100.svg
[rank3]:2025-11-06 05:53:44,100 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0553_real_step1100_rank3.svg
[rank3]:> Batch Time: 522.50 ms, GPU Bubble Ratio: 72.30%, 61.60%, 65.60%, 33.78%
[rank3]:2025-11-06 05:53:44,142 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0553_stage3_step1100.svg
[rank3]:2025-11-06 05:53:44,182 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0553_stage7_step1100.svg
[rank0]:2025-11-06 05:55:38,641 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 05:55:40,520 - INFO - Avg. fwd time: 7.6095 / Avg. bwd time: 14.3745 / Avg. batch time: 473.9717 (ms) / GPU bubble ratio: 25.79%
[rank0]:2025-11-06 05:55:40,484 - INFO - Avg. fwd time: 4.4806 / Avg. bwd time: 5.3597 / Avg. batch time: 547.0844 (ms) / GPU bubble ratio: 71.22%
[rank1]:2025-11-06 05:55:40,563 - INFO - Avg. fwd time: 5.5599 / Avg. bwd time: 7.3636 / Avg. batch time: 536.8195 (ms) / GPU bubble ratio: 61.48%
[rank2]:2025-11-06 05:55:40,549 - INFO - Avg. fwd time: 4.5331 / Avg. bwd time: 6.9141 / Avg. batch time: 519.2494 (ms) / GPU bubble ratio: 64.73%
[rank3]:2025-11-06 05:55:41,159 - INFO -  step: 1150  loss:  0.2634  grad_norm:  0.0987  memory: 19.46GiB(40.96%)  tps: 6,949  tflops: 52.92  mfu: 16.96%
[rank0]:2025-11-06 05:55:41,835 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0987  memory: 14.97GiB(31.51%)  tps: 6,944  tflops: 52.89  mfu: 16.95%
[rank2]:2025-11-06 05:55:41,813 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0987  memory:  8.46GiB(17.81%)  tps: 6,941  tflops: 52.87  mfu: 16.94%
[rank1]:2025-11-06 05:55:41,907 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0987  memory: 12.37GiB(26.04%)  tps: 6,936  tflops: 52.83  mfu: 16.93%
[rank0]:2025-11-06 05:57:33,305 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 05:57:35,448 - INFO - Avg. fwd time: 4.5354 / Avg. bwd time: 6.9017 / Avg. batch time: 518.6369 (ms) / GPU bubble ratio: 64.72%
[rank3]:2025-11-06 05:57:35,419 - INFO - Avg. fwd time: 7.6129 / Avg. bwd time: 14.3413 / Avg. batch time: 473.5554 (ms) / GPU bubble ratio: 25.82%
[rank0]:2025-11-06 05:57:35,494 - INFO - Avg. fwd time: 4.4815 / Avg. bwd time: 5.3279 / Avg. batch time: 546.3554 (ms) / GPU bubble ratio: 71.27%
[rank1]:2025-11-06 05:57:35,474 - INFO - Avg. fwd time: 5.5626 / Avg. bwd time: 7.3431 / Avg. batch time: 536.1551 (ms) / GPU bubble ratio: 61.49%
[rank3]:2025-11-06 05:57:35,922 - INFO -  step: 1200  loss:  0.2672  grad_norm:  0.1145  memory: 19.46GiB(40.96%)  tps: 7,138  tflops: 54.37  mfu: 17.43%
[rank3]:2025-11-06 05:57:35,923 - INFO -  final step: 1200  loss:  0.2672  grad_norm:  0.1145  tps: 7,189  tflops: 54.75  mfu: 16.52%
[rank3]:2025-11-06 05:57:35,923 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 05:57:35,924 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-06 05:57:36,600 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1145  memory: 12.37GiB(26.04%)  tps: 7,143  tflops: 54.40  mfu: 17.44%
[rank1]:2025-11-06 05:57:36,600 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1145  tps: 7,181  tflops: 54.70  mfu: 16.43%
[rank1]:2025-11-06 05:57:36,600 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 05:57:36,601 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 05:57:36,570 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1145  memory:  8.46GiB(17.81%)  tps: 7,139  tflops: 54.37  mfu: 17.43%
[rank2]:2025-11-06 05:57:36,570 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1145  tps: 7,182  tflops: 54.70  mfu: 16.43%
[rank2]:2025-11-06 05:57:36,570 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 05:57:36,571 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 05:57:36,650 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1145  memory: 14.97GiB(31.51%)  tps: 7,135  tflops: 54.34  mfu: 17.42%
[rank0]:2025-11-06 05:57:36,650 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1145  tps: 7,182  tflops: 54.70  mfu: 16.44%
[rank0]:2025-11-06 05:57:36,650 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 05:57:36,650 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 05:57:38,885 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-06 05:57:38,954 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0557_stage2_final1200.svg
[rank0]:2025-11-06 05:57:38,953 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0557_stage0_final1200.svg
[rank1]:2025-11-06 05:57:38,954 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0557_stage1_final1200.svg
[rank2]:2025-11-06 05:57:39,060 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank2_stage2.svg
[rank2]:	> Counts Sum: 364520, Total Sum: 650880 (56.00%), Ratio(%) per element: [54.42, 54.86, 56.52, 56.63, 55.53, 56.63, 56.3, 57.3, 55.64, 56.41, 55.19, 56.74, 55.86, 56.08, 56.63, 55.08, 56.19, 55.97]
[rank0]:2025-11-06 05:57:39,058 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank0_stage0.svg
[rank0]:	> Counts Sum: 451840, Total Sum: 687040 (65.77%), Ratio(%) per element: [67.36, 66.03, 66.59, 64.93, 64.49, 65.15, 64.49, 66.7, 65.7, 66.92, 65.92, 65.59, 64.49, 67.58, 65.37, 64.49, 64.93, 66.7, 66.03]
[rank0]:2025-11-06 05:57:39,100 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank0/251106_0557_stage4_final1200.svg
[rank1]:2025-11-06 05:57:39,083 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank1_stage1.svg
[rank1]:	> Counts Sum: 495360, Total Sum: 976320 (50.74%), Ratio(%) per element: [50.55, 50.66, 50.66, 50.33, 50.88, 50.88, 51.1, 51.32, 50.99, 50.55, 50.88, 50.88, 50.77, 50.22, 50.88, 50.66, 50.77, 50.66, 50.99, 50.88, 50.66, 50.88, 50.33, 50.66, 50.33, 50.55, 50.88]
[rank1]:2025-11-06 05:57:39,125 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank1/251106_0557_stage5_final1200.svg
[rank2]:2025-11-06 05:57:39,103 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank2/251106_0557_stage6_final1200.svg
[rank3]:2025-11-06 05:57:39,139 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0557_real_final1200_rank3.svg
[rank3]:> Batch Time: 518.50 ms, GPU Bubble Ratio: 71.78%, 61.29%, 65.34%, 34.39%
[rank0]:2025-11-06 05:57:39,195 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank0_stage4.svg
[rank0]:	> Counts Sum: 626360, Total Sum: 650880 (96.23%), Ratio(%) per element: [95.68, 95.24, 95.57, 96.34, 95.57, 95.46, 96.12, 98.23, 96.68, 95.79, 96.01, 96.68, 95.68, 95.9, 95.46, 96.12, 98.0, 97.56]
[rank0]:2025-11-06 05:57:39,195 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-06 05:57:39,221 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank1_stage5.svg
[rank1]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.39, 86.28, 86.5, 86.39, 86.17, 86.39, 86.06, 87.05, 86.39, 86.39, 86.28, 86.17, 85.95, 86.5, 86.28, 86.28, 86.5, 86.39]
[rank1]:2025-11-06 05:57:39,222 - INFO - Destroying the purge thread.
[rank2]:2025-11-06 05:57:39,206 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank2_stage6.svg
[rank2]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.28, 86.17, 85.95, 86.5, 86.39, 86.72, 86.28, 86.61, 86.72, 86.17, 86.28, 86.06, 86.39, 86.17, 86.28, 86.17, 86.28, 86.94]
[rank2]:2025-11-06 05:57:39,207 - INFO - Destroying the purge thread.
[rank3]:2025-11-06 05:57:39,379 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/pipeline_schedule/251106_0557_thry_final1200_rank3.svg
[rank3]:> Batch Time: 318.65 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank1]:2025-11-06 05:57:39,391 - INFO - Process group destroyed
[rank2]:2025-11-06 05:57:39,396 - INFO - Process group destroyed
[rank3]:2025-11-06 05:57:39,424 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0557_stage3_final1200.svg
[rank3]:2025-11-06 05:57:39,530 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank3_stage3.svg
[rank3]:	> Counts Sum: 205760, Total Sum: 650880 (31.61%), Ratio(%) per element: [31.41, 31.85, 31.96, 31.41, 30.3, 30.97, 31.52, 37.05, 30.3, 29.86, 30.64, 31.52, 31.08, 30.64, 31.19, 30.86, 35.73, 30.64]
[rank3]:2025-11-06 05:57:39,573 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/freeze_ratio_history/rank3/251106_0557_stage7_final1200.svg
[rank3]:2025-11-06 05:57:39,654 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1/frozen_params_histogram/251106_0557_rank3_stage7.svg
[rank3]:	> Counts Sum: 125200, Total Sum: 397760 (31.48%), Ratio(%) per element: [31.3, 29.97, 30.42, 31.08, 30.97, 30.3, 30.19, 32.07, 32.74, 36.61, 30.53]
[rank3]:2025-11-06 05:57:39,655 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 24-24, summary, console lines 309-319
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.27897
[rank3]:wandb:               final/avg_loss 0.26722
[rank3]:wandb:             final/avg_mfu(%) 16.51769
[rank3]:wandb:             final/avg_tflops 54.75464
[rank3]:wandb:    final/avg_throughput(tps) 7189.22095
[rank3]:wandb:              final/grad_norm 0.11454
[rank3]:wandb:               final/max_loss 0.26722
[rank3]:wandb:                    grad_norm 0.11454
[rank3]:wandb: loss_metrics/global_avg_loss 0.26722
[rank3]:wandb: loss_metrics/global_max_loss 0.26722
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_Interleaved1F1B_timelyapf_dm1_th0.1 at: https://wandb.ai/orangingq/torchtitan/runs/hyqwvc71
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_dm1_th0.1/20251106-0510/wandb/run-20251106_051006-hyqwvc71/logs
[rank3]:2025-11-06 05:57:40,937 - INFO - Process group destroyed
[rank0]:2025-11-06 05:57:41,195 - INFO - Training completed
[rank0]:2025-11-06 05:57:41,196 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 05:57:41,374 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'norm', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_Interleaved1F1B_timelyapf_dm1_th0.1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.1
[rank3]:		- percentile: 70
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
