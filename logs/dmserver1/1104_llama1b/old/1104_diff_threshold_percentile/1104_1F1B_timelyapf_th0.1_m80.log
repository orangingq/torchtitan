
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 06. (ëª©) 11:57:43 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_1F1B_timelyapf_th0.1_m80.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: monitoring steps = 50 -> 80
âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: monitoring steps = 50 -> 80" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.1
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-06 11:57:49,925 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:for timelyapf: monitoring steps = 50 -> 80"
[rank1]:2025-11-06 11:57:50,011 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:for timelyapf: monitoring steps = 50 -> 80"
[rank2]:2025-11-06 11:57:50,109 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-06 11:57:50,111 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-06 11:57:50,180 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-06 11:57:50,182 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 11:57:50,625 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:for timelyapf: monitoring steps = 50 -> 80"
[rank3]:2025-11-06 11:57:50,619 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: monitoring steps = 50 -> 80"
[rank0]:2025-11-06 11:57:50,877 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-06 11:57:50,879 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 11:57:50,883 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-06 11:57:50,885 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-06 11:57:50,887 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 11:57:51,228 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-06 11:57:51,638 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-11-06 11:57:54,639 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-06 11:57:54,676 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 11:57:54,703 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-06 11:57:54,703 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-06 11:57:54,813 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-06 11:57:54,855 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 11:57:54,883 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-06 11:57:54,883 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-06 11:57:54,874 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 11:57:54,875 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-06 11:57:54,875 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-06 11:57:55,062 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 11:57:55,062 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-06 11:57:55,063 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-06 11:57:55,284 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-06 11:57:55,433 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-06 11:57:55,472 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 11:57:55,473 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-06 11:57:55,497 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-06 11:57:55,497 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-06 11:57:55,682 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 11:57:55,682 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-06 11:57:55,682 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 11eee7fx
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_1F1B_timelyapf_th0.1_m80_dm1/20251106-1157/wandb/run-20251106_115755-11eee7fx
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/11eee7fx
[rank3]:2025-11-06 11:57:56,796 - INFO - WandB logging enabled
[rank3]:2025-11-06 11:57:56,797 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-06 11:57:56,836 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 11:57:56,866 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-06 11:57:56,866 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-06 11:57:57,069 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 11:57:57,070 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-06 11:57:57,071 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-11-06 11:57:57,086 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 11:57:57,086 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_1F1B_timelyapf_th0.1_m80_dm1
[rank0]:2025-11-06 11:57:57,086 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 11:57:57,087 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-06 11:57:57,087 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-06 11:57:57,086 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-06 11:57:57,085 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 11:57:59,498 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-06 11:57:59,498 - INFO - Finished loading the checkpoint in 2.41 seconds.
[rank0]:2025-11-06 11:57:59,498 - INFO - Training starts at step 1
[rank1]:2025-11-06 11:58:02,659 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8893  memory:  6.76GiB(14.24%)  tps: 2,099  tflops: 15.99  mfu: 5.12%
[rank1]:2025-11-06 11:58:02,659 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-06 11:58:02,666 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8893  memory: 12.97GiB(27.30%)  tps: 2,811  tflops: 21.41  mfu: 6.86%
[rank3]:2025-11-06 11:58:02,667 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-06 11:58:02,656 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8893  memory:  4.63GiB(9.75%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank2]:2025-11-06 11:58:02,656 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 11:58:02,693 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8893  memory:  9.19GiB(19.34%)  tps: 2,269  tflops: 17.28  mfu: 5.54%
[rank0]:2025-11-06 11:58:02,693 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 12:00:05,111 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:00:07,372 - INFO - Avg. fwd time: 13.2282 / Avg. bwd time: 41.4567 / Avg. batch time: 509.9726 (ms) / GPU bubble ratio: 14.22%
[rank2]:2025-11-06 12:00:07,412 - INFO - Avg. fwd time: 7.1724 / Avg. bwd time: 18.7364 / Avg. batch time: 541.8158 (ms) / GPU bubble ratio: 61.75%
[rank1]:2025-11-06 12:00:07,446 - INFO - Avg. fwd time: 9.2174 / Avg. bwd time: 23.6306 / Avg. batch time: 580.5356 (ms) / GPU bubble ratio: 54.73%
[rank0]:2025-11-06 12:00:07,442 - INFO - Avg. fwd time: 7.2147 / Avg. bwd time: 23.2240 / Avg. batch time: 617.3838 (ms) / GPU bubble ratio: 60.56%
[rank3]:2025-11-06 12:00:07,687 - INFO -  step: 50  loss:  9.2024  grad_norm: 15.6507  memory: 16.39GiB(34.50%)  tps: 6,422  tflops: 48.91  mfu: 15.68%
[rank1]:2025-11-06 12:00:07,678 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.6507  memory:  9.03GiB(19.01%)  tps: 6,422  tflops: 48.91  mfu: 15.68%
[rank0]:2025-11-06 12:00:07,689 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.6507  memory: 12.97GiB(27.31%)  tps: 6,423  tflops: 48.92  mfu: 15.68%
[rank2]:2025-11-06 12:00:07,675 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.6507  memory:  6.43GiB(13.53%)  tps: 6,422  tflops: 48.91  mfu: 15.68%
[rank3]:2025-11-06 12:00:33,360 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-06 12:01:00,431 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank1]:2025-11-06 12:01:00,676 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank2]:2025-11-06 12:01:00,651 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank0]:2025-11-06 12:01:00,702 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank3]:2025-11-06 12:01:32,350 - INFO - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-06 12:01:32,669 - INFO - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-06 12:01:35,138 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:01:35,166 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:01:35,196 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:35,796 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:35,831 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:37,970 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:37,996 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:38,024 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,794 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,817 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:38,797 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:01:38,852 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:01:38,876 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,833 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,857 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,881 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,903 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,928 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:38,900 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:38,903 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:38,947 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:38,948 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:38,948 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:01:38,948 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:01:38,921 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:01:38,961 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:01:38,953 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:38,940 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:38,974 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:38,989 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:01:39,010 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:01:38,991 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:02:10,955 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 12:02:12,293 - INFO - Avg. fwd time: 7.4465 / Avg. bwd time: 19.1135 / Avg. batch time: 586.5702 (ms) / GPU bubble ratio: 63.78%
[rank3]:2025-11-06 12:02:12,463 - INFO - Avg. fwd time: 13.4327 / Avg. bwd time: 37.9261 / Avg. batch time: 483.1767 (ms) / GPU bubble ratio: 14.96%
[rank3]:2025-11-06 12:02:12,471 - INFO - [Step 100] âœ”ï¸  Setting Lowerbound
[rank2]:2025-11-06 12:02:12,491 - INFO - Avg. fwd time: 7.4343 / Avg. bwd time: 16.9129 / Avg. batch time: 518.4829 (ms) / GPU bubble ratio: 62.43%
[rank1]:2025-11-06 12:02:12,505 - INFO - Avg. fwd time: 9.5159 / Avg. bwd time: 21.3432 / Avg. batch time: 554.4288 (ms) / GPU bubble ratio: 55.47%
[rank2]:2025-11-06 12:02:12,712 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-06 12:02:12,713 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory:  6.43GiB(13.53%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank1]:2025-11-06 12:02:12,704 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 12:02:12,705 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory:  9.03GiB(19.01%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank0]:2025-11-06 12:02:12,704 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-06 12:02:12,707 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 12.97GiB(27.31%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank3]:2025-11-06 12:02:12,941 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1202_max_batch_time.svg
[rank3]:> Batch Time: 533.42 ms, GPU Bubble Ratio: 53.90%, 50.49%, 60.91%, 17.79%
[rank3]:2025-11-06 12:02:13,099 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1202_min_batch_time.svg
[rank3]:> Batch Time: 321.76 ms, GPU Bubble Ratio: 82.05%, 50.88%, 61.53%, 14.79%
[rank3]:2025-11-06 12:02:13,270 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1202_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 368.67 ms, GPU Bubble Ratio: 42.99%, 31.96%, 46.32%, 12.91%
[rank3]:2025-11-06 12:02:13,271 - INFO - 	> Batch Time: 368.67 ms (Average Freeze Ratio: 0.29, Time Reduction Rate: 0.31)
[rank3]:2025-11-06 12:02:13,274 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.60/0.60, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 12:02:13,277 - INFO -  step: 100  loss:  4.3092  grad_norm:  0.0038  memory: 16.39GiB(34.50%)  tps: 6,523  tflops: 49.68  mfu: 15.92%
[rank1]:2025-11-06 12:02:13,338 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1202_stage1_step100.svg
[rank0]:2025-11-06 12:02:13,344 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1202_stage0_step100.svg
[rank2]:2025-11-06 12:02:13,338 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1202_stage2_step100.svg
[rank3]:2025-11-06 12:02:13,425 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1202_real_step100_rank3.svg
[rank3]:> Batch Time: 410.50 ms, GPU Bubble Ratio: 83.45%, 58.12%, 66.85%, 31.50%
[rank3]:2025-11-06 12:02:13,471 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1202_stage3_step100.svg
[rank0]:2025-11-06 12:04:24,953 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:04:27,018 - INFO - Avg. fwd time: 13.6172 / Avg. bwd time: 35.1276 / Avg. batch time: 462.7793 (ms) / GPU bubble ratio: 15.74%
[rank2]:2025-11-06 12:04:27,042 - INFO - Avg. fwd time: 7.4481 / Avg. bwd time: 16.7768 / Avg. batch time: 499.7258 (ms) / GPU bubble ratio: 61.22%
[rank1]:2025-11-06 12:04:27,070 - INFO - Avg. fwd time: 9.5709 / Avg. bwd time: 20.8416 / Avg. batch time: 535.4725 (ms) / GPU bubble ratio: 54.56%
[rank0]:2025-11-06 12:04:27,098 - INFO - Avg. fwd time: 7.6078 / Avg. bwd time: 17.9195 / Avg. batch time: 567.1201 (ms) / GPU bubble ratio: 63.99%
[rank2]:2025-11-06 12:04:29,626 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-06 12:04:29,627 - INFO -  step: 150  loss: -4.0000  grad_norm:  1.8654  memory:  6.53GiB(13.74%)  tps: 5,983  tflops: 45.57  mfu: 14.61%
[rank1]:2025-11-06 12:04:30,250 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-11-06 12:04:30,251 - INFO -  step: 150  loss: -4.0000  grad_norm:  1.8654  memory:  9.36GiB(19.71%)  tps: 5,956  tflops: 45.36  mfu: 14.54%
[rank3]:2025-11-06 12:04:33,916 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.40/0.60, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-06 12:04:33,923 - INFO -  step: 150  loss:  0.9906  grad_norm:  1.8654  memory: 17.37GiB(36.55%)  tps: 5,825  tflops: 44.36  mfu: 14.22%
[rank0]:2025-11-06 12:04:34,133 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.35/0.52, [MB7] 0.67/1.00
[rank0]:2025-11-06 12:04:34,134 - INFO -  step: 150  loss: -4.0000  grad_norm:  1.8654  memory: 13.33GiB(28.05%)  tps: 5,792  tflops: 44.12  mfu: 14.14%
[rank0]:2025-11-06 12:06:42,370 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:06:44,147 - INFO - Avg. fwd time: 13.7172 / Avg. bwd time: 33.3002 / Avg. batch time: 449.2203 (ms) / GPU bubble ratio: 16.27%
[rank0]:2025-11-06 12:06:44,244 - INFO - Avg. fwd time: 7.7053 / Avg. bwd time: 17.4147 / Avg. batch time: 551.2266 (ms) / GPU bubble ratio: 63.54%
[rank2]:2025-11-06 12:06:44,211 - INFO - Avg. fwd time: 7.4682 / Avg. bwd time: 16.6298 / Avg. batch time: 484.1704 (ms) / GPU bubble ratio: 60.18%
[rank1]:2025-11-06 12:06:44,249 - INFO - Avg. fwd time: 9.6218 / Avg. bwd time: 20.4335 / Avg. batch time: 519.7885 (ms) / GPU bubble ratio: 53.74%
[rank2]:2025-11-06 12:06:46,836 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-06 12:06:46,837 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1748  memory:  6.53GiB(13.74%)  tps: 5,970  tflops: 45.47  mfu: 14.57%
[rank1]:2025-11-06 12:06:48,541 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 12:06:48,542 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1748  memory:  9.44GiB(19.87%)  tps: 5,924  tflops: 45.12  mfu: 14.46%
[rank3]:2025-11-06 12:06:49,126 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.60/0.60, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 12:06:49,129 - INFO -  step: 200  loss:  0.2695  grad_norm:  0.1748  memory: 17.37GiB(36.55%)  tps: 6,059  tflops: 46.15  mfu: 14.79%
[rank0]:2025-11-06 12:06:49,756 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-06 12:06:49,757 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1748  memory: 13.40GiB(28.22%)  tps: 6,040  tflops: 46.00  mfu: 14.75%
[rank1]:2025-11-06 12:06:49,822 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1206_stage1_step200.svg
[rank0]:2025-11-06 12:06:49,808 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1206_stage0_step200.svg
[rank2]:2025-11-06 12:06:49,821 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1206_stage2_step200.svg
[rank3]:2025-11-06 12:06:49,905 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1206_real_step200_rank3.svg
[rank3]:> Batch Time: 483.42 ms, GPU Bubble Ratio: 63.09%, 52.78%, 60.98%, 34.00%
[rank3]:2025-11-06 12:06:49,949 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1206_stage3_step200.svg
[rank0]:2025-11-06 12:08:53,942 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:08:55,698 - INFO - Avg. fwd time: 13.8099 / Avg. bwd time: 31.7184 / Avg. batch time: 437.2966 (ms) / GPU bubble ratio: 16.71%
[rank1]:2025-11-06 12:08:55,804 - INFO - Avg. fwd time: 9.6750 / Avg. bwd time: 20.0444 / Avg. batch time: 507.4652 (ms) / GPU bubble ratio: 53.15%
[rank0]:2025-11-06 12:08:55,759 - INFO - Avg. fwd time: 7.7750 / Avg. bwd time: 15.9820 / Avg. batch time: 538.4198 (ms) / GPU bubble ratio: 64.70%
[rank2]:2025-11-06 12:08:55,766 - INFO - Avg. fwd time: 7.4897 / Avg. bwd time: 16.4784 / Avg. batch time: 471.9696 (ms) / GPU bubble ratio: 59.37%
[rank2]:2025-11-06 12:08:58,351 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-06 12:08:58,351 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1464  memory:  6.53GiB(13.74%)  tps: 6,229  tflops: 47.44  mfu: 15.21%
[rank1]:2025-11-06 12:08:59,000 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 12:08:59,001 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1464  memory:  9.44GiB(19.87%)  tps: 6,279  tflops: 47.83  mfu: 15.33%
[rank3]:2025-11-06 12:09:01,308 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.60/0.60, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 12:09:01,314 - INFO -  step: 250  loss:  0.2550  grad_norm:  0.1464  memory: 17.37GiB(36.55%)  tps: 6,198  tflops: 47.20  mfu: 15.13%
[rank0]:2025-11-06 12:09:02,293 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-06 12:09:02,294 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1464  memory: 13.40GiB(28.22%)  tps: 6,181  tflops: 47.08  mfu: 15.09%
[rank0]:2025-11-06 12:11:06,550 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:11:08,508 - INFO - Avg. fwd time: 13.8712 / Avg. bwd time: 30.6813 / Avg. batch time: 429.4771 (ms) / GPU bubble ratio: 17.01%
[rank2]:2025-11-06 12:11:08,532 - INFO - Avg. fwd time: 7.5044 / Avg. bwd time: 16.3817 / Avg. batch time: 462.9976 (ms) / GPU bubble ratio: 58.73%
[rank1]:2025-11-06 12:11:08,559 - INFO - Avg. fwd time: 9.7092 / Avg. bwd time: 19.7949 / Avg. batch time: 498.4117 (ms) / GPU bubble ratio: 52.64%
[rank0]:2025-11-06 12:11:08,582 - INFO - Avg. fwd time: 7.8145 / Avg. bwd time: 14.9772 / Avg. batch time: 529.0372 (ms) / GPU bubble ratio: 65.53%
[rank1]:2025-11-06 12:11:11,746 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 12:11:11,747 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1098  memory:  9.44GiB(19.87%)  tps: 6,171  tflops: 47.00  mfu: 15.06%
[rank2]:2025-11-06 12:11:11,963 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-06 12:11:11,964 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1098  memory:  6.53GiB(13.74%)  tps: 6,131  tflops: 46.70  mfu: 14.97%
[rank3]:2025-11-06 12:11:13,194 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.60/0.60, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-06 12:11:13,198 - INFO -  step: 300  loss:  0.2352  grad_norm:  0.1098  memory: 17.37GiB(36.55%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank0]:2025-11-06 12:11:13,875 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-06 12:11:13,875 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1098  memory: 13.40GiB(28.22%)  tps: 6,226  tflops: 47.42  mfu: 15.20%
[rank0]:2025-11-06 12:11:13,925 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1211_stage0_step300.svg
[rank2]:2025-11-06 12:11:13,927 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1211_stage2_step300.svg
[rank1]:2025-11-06 12:11:13,925 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1211_stage1_step300.svg
[rank3]:2025-11-06 12:11:14,020 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1211_real_step300_rank3.svg
[rank3]:> Batch Time: 482.55 ms, GPU Bubble Ratio: 69.78%, 52.62%, 60.88%, 34.03%
[rank3]:2025-11-06 12:11:14,063 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1211_stage3_step300.svg
[rank0]:2025-11-06 12:13:20,911 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:13:22,689 - INFO - Avg. fwd time: 13.9129 / Avg. bwd time: 30.0693 / Avg. batch time: 424.9360 (ms) / GPU bubble ratio: 17.20%
[rank1]:2025-11-06 12:13:22,792 - INFO - Avg. fwd time: 9.7317 / Avg. bwd time: 19.6414 / Avg. batch time: 493.2043 (ms) / GPU bubble ratio: 52.36%
[rank0]:2025-11-06 12:13:22,747 - INFO - Avg. fwd time: 7.8404 / Avg. bwd time: 14.3585 / Avg. batch time: 523.6300 (ms) / GPU bubble ratio: 66.08%
[rank2]:2025-11-06 12:13:22,754 - INFO - Avg. fwd time: 7.5148 / Avg. bwd time: 16.3227 / Avg. batch time: 457.8424 (ms) / GPU bubble ratio: 58.35%
[rank2]:2025-11-06 12:13:25,336 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1043  memory:  6.53GiB(13.74%)  tps: 6,142  tflops: 46.78  mfu: 14.99%
[rank1]:2025-11-06 12:13:25,855 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1043  memory:  9.44GiB(19.87%)  tps: 6,109  tflops: 46.53  mfu: 14.91%
[rank3]:2025-11-06 12:13:27,444 - INFO -  step: 350  loss:  0.2354  grad_norm:  0.1043  memory: 17.37GiB(36.55%)  tps: 6,102  tflops: 46.48  mfu: 14.90%
[rank0]:2025-11-06 12:13:30,338 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1043  memory: 13.40GiB(28.22%)  tps: 6,003  tflops: 45.72  mfu: 14.65%
[rank0]:2025-11-06 12:15:31,926 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:15:33,702 - INFO - Avg. fwd time: 13.9374 / Avg. bwd time: 29.4571 / Avg. batch time: 420.2190 (ms) / GPU bubble ratio: 17.39%
[rank0]:2025-11-06 12:15:33,760 - INFO - Avg. fwd time: 7.8612 / Avg. bwd time: 13.8037 / Avg. batch time: 518.0322 (ms) / GPU bubble ratio: 66.54%
[rank2]:2025-11-06 12:15:33,768 - INFO - Avg. fwd time: 7.5219 / Avg. bwd time: 16.2654 / Avg. batch time: 452.4669 (ms) / GPU bubble ratio: 57.94%
[rank1]:2025-11-06 12:15:33,806 - INFO - Avg. fwd time: 9.7473 / Avg. bwd time: 19.5038 / Avg. batch time: 487.7885 (ms) / GPU bubble ratio: 52.03%
[rank2]:2025-11-06 12:15:36,378 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1347  memory:  6.53GiB(13.74%)  tps: 6,251  tflops: 47.61  mfu: 15.26%
[rank1]:2025-11-06 12:15:37,084 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1347  memory:  9.44GiB(19.87%)  tps: 6,243  tflops: 47.54  mfu: 15.24%
[rank0]:2025-11-06 12:15:39,394 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1347  memory: 13.40GiB(28.22%)  tps: 6,348  tflops: 48.34  mfu: 15.50%
[rank3]:2025-11-06 12:15:40,420 - INFO -  step: 400  loss:  0.2427  grad_norm:  0.1347  memory: 17.37GiB(36.55%)  tps: 6,161  tflops: 46.92  mfu: 15.04%
[rank0]:2025-11-06 12:15:40,476 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1215_stage0_step400.svg
[rank1]:2025-11-06 12:15:40,475 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1215_stage1_step400.svg
[rank2]:2025-11-06 12:15:40,476 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1215_stage2_step400.svg
[rank3]:2025-11-06 12:15:40,580 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1215_real_step400_rank3.svg
[rank3]:> Batch Time: 480.77 ms, GPU Bubble Ratio: 69.02%, 52.64%, 60.89%, 34.15%
[rank3]:2025-11-06 12:15:40,631 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1215_stage3_step400.svg
[rank3]:2025-11-06 12:15:51,086 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 12:15:51,304 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 12:15:51,280 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 12:15:51,323 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 12:17:43,170 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 12:17:45,117 - INFO - Avg. fwd time: 13.9445 / Avg. bwd time: 29.0241 / Avg. batch time: 416.8456 (ms) / GPU bubble ratio: 17.54%
[rank2]:2025-11-06 12:17:45,142 - INFO - Avg. fwd time: 7.5261 / Avg. bwd time: 16.2185 / Avg. batch time: 448.6951 (ms) / GPU bubble ratio: 57.66%
[rank1]:2025-11-06 12:17:45,169 - INFO - Avg. fwd time: 9.7575 / Avg. bwd time: 19.3897 / Avg. batch time: 483.9580 (ms) / GPU bubble ratio: 51.82%
[rank0]:2025-11-06 12:17:45,193 - INFO - Avg. fwd time: 7.8761 / Avg. bwd time: 13.3749 / Avg. batch time: 514.0515 (ms) / GPU bubble ratio: 66.93%
[rank1]:2025-11-06 12:17:48,338 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1697  memory:  9.44GiB(19.87%)  tps: 6,241  tflops: 47.54  mfu: 15.24%
[rank2]:2025-11-06 12:17:48,608 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1697  memory:  6.53GiB(13.74%)  tps: 6,195  tflops: 47.18  mfu: 15.12%
[rank3]:2025-11-06 12:17:49,924 - INFO -  step: 450  loss:  0.2359  grad_norm:  0.1697  memory: 17.37GiB(36.55%)  tps: 6,326  tflops: 48.18  mfu: 15.44%
[rank0]:2025-11-06 12:17:50,602 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1697  memory: 13.40GiB(28.22%)  tps: 6,244  tflops: 47.55  mfu: 15.24%
[rank0]:2025-11-06 12:19:54,345 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:19:56,122 - INFO - Avg. fwd time: 13.9544 / Avg. bwd time: 28.7257 / Avg. batch time: 414.5333 (ms) / GPU bubble ratio: 17.63%
[rank0]:2025-11-06 12:19:56,183 - INFO - Avg. fwd time: 7.8863 / Avg. bwd time: 13.0836 / Avg. batch time: 511.9735 (ms) / GPU bubble ratio: 67.23%
[rank1]:2025-11-06 12:19:56,227 - INFO - Avg. fwd time: 9.7652 / Avg. bwd time: 19.3122 / Avg. batch time: 481.9778 (ms) / GPU bubble ratio: 51.74%
[rank2]:2025-11-06 12:19:56,190 - INFO - Avg. fwd time: 7.5296 / Avg. bwd time: 16.1873 / Avg. batch time: 446.7548 (ms) / GPU bubble ratio: 57.53%
[rank2]:2025-11-06 12:19:58,713 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1232  memory:  6.53GiB(13.74%)  tps: 6,296  tflops: 47.96  mfu: 15.37%
[rank1]:2025-11-06 12:19:59,524 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1232  memory:  9.44GiB(19.87%)  tps: 6,245  tflops: 47.56  mfu: 15.24%
[rank0]:2025-11-06 12:20:01,833 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1232  memory: 13.40GiB(28.22%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank3]:2025-11-06 12:20:02,776 - INFO -  step: 500  loss:  0.2685  grad_norm:  0.1232  memory: 17.37GiB(36.55%)  tps: 6,166  tflops: 46.96  mfu: 15.05%
[rank0]:2025-11-06 12:20:02,828 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1220_stage0_step500.svg
[rank1]:2025-11-06 12:20:02,826 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1219_stage1_step500.svg
[rank2]:2025-11-06 12:20:02,826 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1219_stage2_step500.svg
[rank3]:2025-11-06 12:20:02,925 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1220_real_step500_rank3.svg
[rank3]:> Batch Time: 484.25 ms, GPU Bubble Ratio: 69.88%, 53.07%, 61.19%, 33.49%
[rank3]:2025-11-06 12:20:02,970 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1220_stage3_step500.svg
[rank0]:2025-11-06 12:22:09,796 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:22:11,590 - INFO - Avg. fwd time: 13.9677 / Avg. bwd time: 28.4843 / Avg. batch time: 412.7224 (ms) / GPU bubble ratio: 17.71%
[rank0]:2025-11-06 12:22:11,650 - INFO - Avg. fwd time: 7.8960 / Avg. bwd time: 12.8169 / Avg. batch time: 510.1118 (ms) / GPU bubble ratio: 67.52%
[rank2]:2025-11-06 12:22:11,657 - INFO - Avg. fwd time: 7.5332 / Avg. bwd time: 16.1572 / Avg. batch time: 445.0369 (ms) / GPU bubble ratio: 57.41%
[rank1]:2025-11-06 12:22:11,694 - INFO - Avg. fwd time: 9.7742 / Avg. bwd time: 19.2370 / Avg. batch time: 480.2117 (ms) / GPU bubble ratio: 51.67%
[rank1]:2025-11-06 12:22:14,918 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1614  memory:  9.44GiB(19.87%)  tps: 6,051  tflops: 46.08  mfu: 14.77%
[rank2]:2025-11-06 12:22:15,364 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1614  memory:  6.53GiB(13.74%)  tps: 5,995  tflops: 45.66  mfu: 14.63%
[rank3]:2025-11-06 12:22:16,563 - INFO -  step: 550  loss:  0.3008  grad_norm:  0.1614  memory: 17.37GiB(36.55%)  tps: 6,123  tflops: 46.64  mfu: 14.95%
[rank0]:2025-11-06 12:22:17,818 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1614  memory: 13.40GiB(28.22%)  tps: 6,024  tflops: 45.88  mfu: 14.71%
[rank0]:2025-11-06 12:24:20,929 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:24:22,894 - INFO - Avg. fwd time: 13.9836 / Avg. bwd time: 28.2230 / Avg. batch time: 410.7454 (ms) / GPU bubble ratio: 17.79%
[rank2]:2025-11-06 12:24:22,919 - INFO - Avg. fwd time: 7.5368 / Avg. bwd time: 16.1343 / Avg. batch time: 442.6884 (ms) / GPU bubble ratio: 57.22%
[rank0]:2025-11-06 12:24:22,973 - INFO - Avg. fwd time: 7.9053 / Avg. bwd time: 12.5821 / Avg. batch time: 507.6615 (ms) / GPU bubble ratio: 67.71%
[rank1]:2025-11-06 12:24:22,947 - INFO - Avg. fwd time: 9.7824 / Avg. bwd time: 19.1797 / Avg. batch time: 477.8362 (ms) / GPU bubble ratio: 51.51%
[rank2]:2025-11-06 12:24:25,438 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1283  memory:  6.53GiB(13.74%)  tps: 6,298  tflops: 47.97  mfu: 15.37%
[rank1]:2025-11-06 12:24:26,045 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1283  memory:  9.44GiB(19.87%)  tps: 6,247  tflops: 47.58  mfu: 15.25%
[rank3]:2025-11-06 12:24:27,688 - INFO -  step: 600  loss:  0.2269  grad_norm:  0.1283  memory: 17.37GiB(36.55%)  tps: 6,248  tflops: 47.58  mfu: 15.25%
[rank0]:2025-11-06 12:24:30,557 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1283  memory: 13.40GiB(28.22%)  tps: 6,172  tflops: 47.00  mfu: 15.07%
[rank0]:2025-11-06 12:24:30,611 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1224_stage0_step600.svg
[rank1]:2025-11-06 12:24:30,610 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1224_stage1_step600.svg
[rank2]:2025-11-06 12:24:30,609 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1224_stage2_step600.svg
[rank3]:2025-11-06 12:24:30,704 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1224_real_step600_rank3.svg
[rank3]:> Batch Time: 482.23 ms, GPU Bubble Ratio: 69.71%, 52.65%, 60.92%, 33.98%
[rank3]:2025-11-06 12:24:30,750 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1224_stage3_step600.svg
[rank0]:2025-11-06 12:26:38,842 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:26:40,599 - INFO - Avg. fwd time: 13.9976 / Avg. bwd time: 28.0591 / Avg. batch time: 409.5455 (ms) / GPU bubble ratio: 17.85%
[rank0]:2025-11-06 12:26:40,657 - INFO - Avg. fwd time: 7.9133 / Avg. bwd time: 12.4171 / Avg. batch time: 506.4408 (ms) / GPU bubble ratio: 67.88%
[rank2]:2025-11-06 12:26:40,668 - INFO - Avg. fwd time: 7.5400 / Avg. bwd time: 16.1189 / Avg. batch time: 441.5278 (ms) / GPU bubble ratio: 57.13%
[rank1]:2025-11-06 12:26:40,704 - INFO - Avg. fwd time: 9.7896 / Avg. bwd time: 19.1377 / Avg. batch time: 476.6584 (ms) / GPU bubble ratio: 51.45%
[rank1]:2025-11-06 12:26:43,855 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1466  memory:  9.44GiB(19.87%)  tps: 5,944  tflops: 45.27  mfu: 14.51%
[rank2]:2025-11-06 12:26:44,194 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1466  memory:  6.53GiB(13.74%)  tps: 5,904  tflops: 44.97  mfu: 14.41%
[rank3]:2025-11-06 12:26:45,555 - INFO -  step: 650  loss:  0.2375  grad_norm:  0.1466  memory: 17.37GiB(36.55%)  tps: 5,942  tflops: 45.26  mfu: 14.51%
[rank0]:2025-11-06 12:26:46,274 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1466  memory: 13.40GiB(28.22%)  tps: 6,036  tflops: 45.97  mfu: 14.73%
[rank0]:2025-11-06 12:28:49,204 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:28:50,983 - INFO - Avg. fwd time: 14.0133 / Avg. bwd time: 27.8630 / Avg. batch time: 408.0849 (ms) / GPU bubble ratio: 17.91%
[rank2]:2025-11-06 12:28:51,050 - INFO - Avg. fwd time: 7.5434 / Avg. bwd time: 16.1039 / Avg. batch time: 440.8481 (ms) / GPU bubble ratio: 57.09%
[rank0]:2025-11-06 12:28:51,043 - INFO - Avg. fwd time: 7.9188 / Avg. bwd time: 12.2581 / Avg. batch time: 505.6821 (ms) / GPU bubble ratio: 68.08%
[rank1]:2025-11-06 12:28:51,088 - INFO - Avg. fwd time: 9.7984 / Avg. bwd time: 19.0980 / Avg. batch time: 475.9625 (ms) / GPU bubble ratio: 51.43%
[rank2]:2025-11-06 12:28:53,666 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1131  memory:  6.53GiB(13.74%)  tps: 6,327  tflops: 48.19  mfu: 15.45%
[rank1]:2025-11-06 12:28:54,290 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1131  memory:  9.44GiB(19.87%)  tps: 6,281  tflops: 47.83  mfu: 15.33%
[rank0]:2025-11-06 12:28:56,570 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1131  memory: 13.40GiB(28.22%)  tps: 6,287  tflops: 47.88  mfu: 15.35%
[rank3]:2025-11-06 12:28:57,800 - INFO -  step: 700  loss:  0.2172  grad_norm:  0.1131  memory: 17.37GiB(36.55%)  tps: 6,195  tflops: 47.18  mfu: 15.12%
[rank1]:2025-11-06 12:28:57,854 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1228_stage1_step700.svg
[rank2]:2025-11-06 12:28:57,853 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1228_stage2_step700.svg
[rank0]:2025-11-06 12:28:57,854 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1228_stage0_step700.svg
[rank3]:2025-11-06 12:28:57,948 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1228_real_step700_rank3.svg
[rank3]:> Batch Time: 481.50 ms, GPU Bubble Ratio: 69.72%, 52.49%, 60.84%, 33.96%
[rank3]:2025-11-06 12:28:57,995 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1228_stage3_step700.svg
[rank0]:2025-11-06 12:31:03,182 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 12:31:05,165 - INFO - Avg. fwd time: 7.5454 / Avg. bwd time: 16.0886 / Avg. batch time: 441.1136 (ms) / GPU bubble ratio: 57.14%
[rank3]:2025-11-06 12:31:05,139 - INFO - Avg. fwd time: 14.0227 / Avg. bwd time: 27.7038 / Avg. batch time: 406.8892 (ms) / GPU bubble ratio: 17.96%
[rank1]:2025-11-06 12:31:05,194 - INFO - Avg. fwd time: 9.8042 / Avg. bwd time: 19.0597 / Avg. batch time: 476.2026 (ms) / GPU bubble ratio: 51.51%
[rank0]:2025-11-06 12:31:05,226 - INFO - Avg. fwd time: 7.9235 / Avg. bwd time: 12.1122 / Avg. batch time: 505.8695 (ms) / GPU bubble ratio: 68.31%
[rank2]:2025-11-06 12:31:07,740 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1452  memory:  6.53GiB(13.74%)  tps: 6,110  tflops: 46.54  mfu: 14.92%
[rank1]:2025-11-06 12:31:08,122 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1452  memory:  9.44GiB(19.87%)  tps: 6,121  tflops: 46.62  mfu: 14.94%
[rank3]:2025-11-06 12:31:10,065 - INFO -  step: 750  loss:  0.2743  grad_norm:  0.1452  memory: 17.37GiB(36.55%)  tps: 6,194  tflops: 47.17  mfu: 15.12%
[rank0]:2025-11-06 12:31:12,882 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1452  memory: 13.40GiB(28.22%)  tps: 6,010  tflops: 45.77  mfu: 14.67%
[rank0]:2025-11-06 12:33:18,819 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:33:20,595 - INFO - Avg. fwd time: 14.0234 / Avg. bwd time: 27.5823 / Avg. batch time: 405.9232 (ms) / GPU bubble ratio: 18.00%
[rank0]:2025-11-06 12:33:20,652 - INFO - Avg. fwd time: 7.9265 / Avg. bwd time: 11.9999 / Avg. batch time: 505.5269 (ms) / GPU bubble ratio: 68.47%
[rank2]:2025-11-06 12:33:20,662 - INFO - Avg. fwd time: 7.5465 / Avg. bwd time: 16.0763 / Avg. batch time: 440.8340 (ms) / GPU bubble ratio: 57.13%
[rank1]:2025-11-06 12:33:20,699 - INFO - Avg. fwd time: 9.8078 / Avg. bwd time: 19.0291 / Avg. batch time: 475.9015 (ms) / GPU bubble ratio: 51.52%
[rank2]:2025-11-06 12:33:23,250 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1346  memory:  6.53GiB(13.74%)  tps: 6,045  tflops: 46.04  mfu: 14.76%
[rank1]:2025-11-06 12:33:23,775 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1346  memory:  9.44GiB(19.87%)  tps: 6,039  tflops: 45.99  mfu: 14.74%
[rank0]:2025-11-06 12:33:27,441 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1346  memory: 13.40GiB(28.22%)  tps: 6,088  tflops: 46.37  mfu: 14.86%
[rank3]:2025-11-06 12:33:27,477 - INFO -  step: 800  loss:  0.2232  grad_norm:  0.1346  memory: 17.37GiB(36.55%)  tps: 5,962  tflops: 45.41  mfu: 14.55%
[rank0]:2025-11-06 12:33:27,533 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1233_stage0_step800.svg
[rank1]:2025-11-06 12:33:27,533 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1233_stage1_step800.svg
[rank2]:2025-11-06 12:33:27,531 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1233_stage2_step800.svg
[rank3]:2025-11-06 12:33:27,635 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1233_real_step800_rank3.svg
[rank3]:> Batch Time: 479.25 ms, GPU Bubble Ratio: 68.89%, 52.55%, 60.76%, 34.23%
[rank3]:2025-11-06 12:33:27,685 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1233_stage3_step800.svg
[rank3]:2025-11-06 12:33:54,883 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 12:33:55,094 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 12:33:55,069 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 12:33:55,111 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 12:35:29,171 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:35:30,916 - INFO - Avg. fwd time: 14.0262 / Avg. bwd time: 27.4526 / Avg. batch time: 404.9141 (ms) / GPU bubble ratio: 18.05%
[rank0]:2025-11-06 12:35:30,975 - INFO - Avg. fwd time: 7.9296 / Avg. bwd time: 11.8861 / Avg. batch time: 504.0569 (ms) / GPU bubble ratio: 68.55%
[rank2]:2025-11-06 12:35:30,987 - INFO - Avg. fwd time: 7.5475 / Avg. bwd time: 16.0629 / Avg. batch time: 439.4291 (ms) / GPU bubble ratio: 57.02%
[rank1]:2025-11-06 12:35:31,019 - INFO - Avg. fwd time: 9.8106 / Avg. bwd time: 18.9966 / Avg. batch time: 474.4744 (ms) / GPU bubble ratio: 51.43%
[rank1]:2025-11-06 12:35:34,125 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1847  memory:  9.44GiB(19.87%)  tps: 6,285  tflops: 47.86  mfu: 15.34%
[rank2]:2025-11-06 12:35:34,574 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1847  memory:  6.53GiB(13.74%)  tps: 6,238  tflops: 47.51  mfu: 15.23%
[rank3]:2025-11-06 12:35:35,662 - INFO -  step: 850  loss:  0.2326  grad_norm:  0.1847  memory: 17.37GiB(36.55%)  tps: 6,391  tflops: 48.67  mfu: 15.60%
[rank0]:2025-11-06 12:35:36,336 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1847  memory: 13.40GiB(28.22%)  tps: 6,356  tflops: 48.41  mfu: 15.51%
[rank0]:2025-11-06 12:37:39,920 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:37:41,884 - INFO - Avg. fwd time: 14.0330 / Avg. bwd time: 27.3410 / Avg. batch time: 404.0813 (ms) / GPU bubble ratio: 18.09%
[rank2]:2025-11-06 12:37:41,913 - INFO - Avg. fwd time: 7.5489 / Avg. bwd time: 16.0517 / Avg. batch time: 438.2139 (ms) / GPU bubble ratio: 56.92%
[rank1]:2025-11-06 12:37:41,942 - INFO - Avg. fwd time: 9.8147 / Avg. bwd time: 18.9701 / Avg. batch time: 473.2492 (ms) / GPU bubble ratio: 51.34%
[rank0]:2025-11-06 12:37:41,969 - INFO - Avg. fwd time: 7.9332 / Avg. bwd time: 11.7808 / Avg. batch time: 502.8005 (ms) / GPU bubble ratio: 68.63%
[rank1]:2025-11-06 12:37:44,877 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1124  memory:  9.44GiB(19.87%)  tps: 6,265  tflops: 47.72  mfu: 15.29%
[rank2]:2025-11-06 12:37:45,235 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1124  memory:  6.53GiB(13.74%)  tps: 6,270  tflops: 47.75  mfu: 15.30%
[rank3]:2025-11-06 12:37:46,749 - INFO -  step: 900  loss:  0.2057  grad_norm:  0.1124  memory: 17.37GiB(36.55%)  tps: 6,249  tflops: 47.60  mfu: 15.26%
[rank0]:2025-11-06 12:37:47,453 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1124  memory: 13.40GiB(28.22%)  tps: 6,248  tflops: 47.59  mfu: 15.25%
[rank0]:2025-11-06 12:37:47,502 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1237_stage0_step900.svg
[rank2]:2025-11-06 12:37:47,503 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1237_stage2_step900.svg
[rank1]:2025-11-06 12:37:47,502 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1237_stage1_step900.svg
[rank3]:2025-11-06 12:37:47,600 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1237_real_step900_rank3.svg
[rank3]:> Batch Time: 481.47 ms, GPU Bubble Ratio: 69.88%, 52.63%, 60.91%, 34.12%
[rank3]:2025-11-06 12:37:47,643 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1237_stage3_step900.svg
[rank0]:2025-11-06 12:39:50,631 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:39:52,396 - INFO - Avg. fwd time: 14.0394 / Avg. bwd time: 27.2503 / Avg. batch time: 403.4063 (ms) / GPU bubble ratio: 18.12%
[rank0]:2025-11-06 12:39:52,454 - INFO - Avg. fwd time: 7.9358 / Avg. bwd time: 11.6945 / Avg. batch time: 501.8172 (ms) / GPU bubble ratio: 68.71%
[rank2]:2025-11-06 12:39:52,463 - INFO - Avg. fwd time: 7.5503 / Avg. bwd time: 16.0437 / Avg. batch time: 437.2689 (ms) / GPU bubble ratio: 56.83%
[rank1]:2025-11-06 12:39:52,502 - INFO - Avg. fwd time: 9.8183 / Avg. bwd time: 18.9505 / Avg. batch time: 472.2926 (ms) / GPU bubble ratio: 51.27%
[rank2]:2025-11-06 12:39:55,016 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1304  memory:  6.53GiB(13.74%)  tps: 6,312  tflops: 48.08  mfu: 15.41%
[rank1]:2025-11-06 12:39:56,757 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1304  memory:  9.44GiB(19.87%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank3]:2025-11-06 12:39:57,379 - INFO -  step: 950  loss:  0.2496  grad_norm:  0.1304  memory: 17.37GiB(36.55%)  tps: 6,271  tflops: 47.76  mfu: 15.31%
[rank0]:2025-11-06 12:39:57,976 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1304  memory: 13.40GiB(28.22%)  tps: 6,276  tflops: 47.80  mfu: 15.32%
[rank0]:2025-11-06 12:42:02,663 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:42:04,460 - INFO - Avg. fwd time: 14.0488 / Avg. bwd time: 27.1771 / Avg. batch time: 402.9004 (ms) / GPU bubble ratio: 18.14%
[rank0]:2025-11-06 12:42:04,520 - INFO - Avg. fwd time: 7.9400 / Avg. bwd time: 11.6180 / Avg. batch time: 501.3346 (ms) / GPU bubble ratio: 68.79%
[rank2]:2025-11-06 12:42:04,529 - INFO - Avg. fwd time: 7.5520 / Avg. bwd time: 16.0362 / Avg. batch time: 436.8189 (ms) / GPU bubble ratio: 56.80%
[rank1]:2025-11-06 12:42:04,567 - INFO - Avg. fwd time: 9.8221 / Avg. bwd time: 18.9298 / Avg. batch time: 471.8286 (ms) / GPU bubble ratio: 51.25%
[rank2]:2025-11-06 12:42:07,108 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1262  memory:  6.53GiB(13.74%)  tps: 6,202  tflops: 47.23  mfu: 15.14%
[rank1]:2025-11-06 12:42:07,708 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1262  memory:  9.44GiB(19.87%)  tps: 6,256  tflops: 47.65  mfu: 15.27%
[rank0]:2025-11-06 12:42:10,111 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1262  memory: 13.40GiB(28.22%)  tps: 6,200  tflops: 47.22  mfu: 15.13%
[rank3]:2025-11-06 12:42:11,276 - INFO -  step: 1000  loss:  0.2365  grad_norm:  0.1262  memory: 17.37GiB(36.55%)  tps: 6,118  tflops: 46.60  mfu: 14.94%
[rank0]:2025-11-06 12:42:11,328 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1242_stage0_step1000.svg
[rank2]:2025-11-06 12:42:11,327 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1242_stage2_step1000.svg
[rank1]:2025-11-06 12:42:11,326 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1242_stage1_step1000.svg
[rank3]:2025-11-06 12:42:11,428 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1242_real_step1000_rank3.svg
[rank3]:> Batch Time: 485.06 ms, GPU Bubble Ratio: 69.22%, 52.97%, 61.13%, 34.11%
[rank3]:2025-11-06 12:42:11,471 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1242_stage3_step1000.svg
[rank0]:2025-11-06 12:44:12,791 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:44:14,750 - INFO - Avg. fwd time: 14.0579 / Avg. bwd time: 27.1039 / Avg. batch time: 402.3914 (ms) / GPU bubble ratio: 18.17%
[rank2]:2025-11-06 12:44:14,778 - INFO - Avg. fwd time: 7.5541 / Avg. bwd time: 16.0304 / Avg. batch time: 436.0411 (ms) / GPU bubble ratio: 56.73%
[rank0]:2025-11-06 12:44:14,836 - INFO - Avg. fwd time: 7.9430 / Avg. bwd time: 11.5582 / Avg. batch time: 500.5352 (ms) / GPU bubble ratio: 68.83%
[rank1]:2025-11-06 12:44:14,808 - INFO - Avg. fwd time: 9.8260 / Avg. bwd time: 18.9134 / Avg. batch time: 471.0504 (ms) / GPU bubble ratio: 51.19%
[rank2]:2025-11-06 12:44:17,315 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1369  memory:  6.53GiB(13.74%)  tps: 6,292  tflops: 47.92  mfu: 15.36%
[rank1]:2025-11-06 12:44:17,978 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1369  memory:  9.44GiB(19.87%)  tps: 6,288  tflops: 47.89  mfu: 15.35%
[rank0]:2025-11-06 12:44:20,169 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1369  memory: 13.40GiB(28.22%)  tps: 6,299  tflops: 47.97  mfu: 15.38%
[rank3]:2025-11-06 12:44:21,381 - INFO -  step: 1050  loss:  0.2775  grad_norm:  0.1369  memory: 17.37GiB(36.55%)  tps: 6,297  tflops: 47.96  mfu: 15.37%
[rank0]:2025-11-06 12:46:24,700 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:46:26,494 - INFO - Avg. fwd time: 14.0641 / Avg. bwd time: 27.0374 / Avg. batch time: 401.9067 (ms) / GPU bubble ratio: 18.19%
[rank2]:2025-11-06 12:46:26,569 - INFO - Avg. fwd time: 7.5552 / Avg. bwd time: 16.0250 / Avg. batch time: 436.2843 (ms) / GPU bubble ratio: 56.76%
[rank0]:2025-11-06 12:46:26,561 - INFO - Avg. fwd time: 7.9451 / Avg. bwd time: 11.4940 / Avg. batch time: 500.7568 (ms) / GPU bubble ratio: 68.94%
[rank1]:2025-11-06 12:46:26,606 - INFO - Avg. fwd time: 9.8286 / Avg. bwd time: 18.8999 / Avg. batch time: 471.2911 (ms) / GPU bubble ratio: 51.23%
[rank2]:2025-11-06 12:46:29,185 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1283  memory:  6.53GiB(13.74%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank1]:2025-11-06 12:46:29,778 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1283  memory:  9.44GiB(19.87%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank3]:2025-11-06 12:46:31,645 - INFO -  step: 1100  loss:  0.2426  grad_norm:  0.1283  memory: 17.37GiB(36.55%)  tps: 6,289  tflops: 47.90  mfu: 15.35%
[rank0]:2025-11-06 12:46:33,782 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1283  memory: 13.40GiB(28.22%)  tps: 6,131  tflops: 46.70  mfu: 14.97%
[rank0]:2025-11-06 12:46:33,834 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1246_stage0_step1100.svg
[rank1]:2025-11-06 12:46:33,835 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1246_stage1_step1100.svg
[rank2]:2025-11-06 12:46:33,833 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1246_stage2_step1100.svg
[rank3]:2025-11-06 12:46:33,936 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1246_real_step1100_rank3.svg
[rank3]:> Batch Time: 482.30 ms, GPU Bubble Ratio: 69.81%, 52.74%, 60.96%, 34.03%
[rank3]:2025-11-06 12:46:33,981 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1246_stage3_step1100.svg
[rank0]:2025-11-06 12:48:36,484 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:48:38,243 - INFO - Avg. fwd time: 14.0670 / Avg. bwd time: 26.9609 / Avg. batch time: 401.3109 (ms) / GPU bubble ratio: 18.21%
[rank0]:2025-11-06 12:48:38,304 - INFO - Avg. fwd time: 7.9473 / Avg. bwd time: 11.4364 / Avg. batch time: 500.4223 (ms) / GPU bubble ratio: 69.01%
[rank2]:2025-11-06 12:48:38,308 - INFO - Avg. fwd time: 7.5560 / Avg. bwd time: 16.0182 / Avg. batch time: 435.9741 (ms) / GPU bubble ratio: 56.74%
[rank1]:2025-11-06 12:48:38,345 - INFO - Avg. fwd time: 9.8307 / Avg. bwd time: 18.8837 / Avg. batch time: 470.9747 (ms) / GPU bubble ratio: 51.23%
[rank2]:2025-11-06 12:48:40,916 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1146  memory:  6.53GiB(13.74%)  tps: 6,219  tflops: 47.36  mfu: 15.18%
[rank1]:2025-11-06 12:48:41,556 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1146  memory:  9.44GiB(19.87%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-11-06 12:48:43,649 - INFO -  step: 1150  loss:  0.2398  grad_norm:  0.1146  memory: 17.37GiB(36.55%)  tps: 6,206  tflops: 47.27  mfu: 15.15%
[rank0]:2025-11-06 12:48:45,006 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1146  memory: 13.40GiB(28.22%)  tps: 6,243  tflops: 47.55  mfu: 15.24%
[rank0]:2025-11-06 12:50:47,079 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:50:49,055 - INFO - Avg. fwd time: 14.0703 / Avg. bwd time: 26.8923 / Avg. batch time: 400.7930 (ms) / GPU bubble ratio: 18.24%
[rank0]:2025-11-06 12:50:49,146 - INFO - Avg. fwd time: 7.9499 / Avg. bwd time: 11.3793 / Avg. batch time: 499.6304 (ms) / GPU bubble ratio: 69.05%
[rank2]:2025-11-06 12:50:49,086 - INFO - Avg. fwd time: 7.5568 / Avg. bwd time: 16.0118 / Avg. batch time: 435.2052 (ms) / GPU bubble ratio: 56.68%
[rank1]:2025-11-06 12:50:49,118 - INFO - Avg. fwd time: 9.8326 / Avg. bwd time: 18.8688 / Avg. batch time: 470.2005 (ms) / GPU bubble ratio: 51.17%
[rank1]:2025-11-06 12:50:52,276 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1508  memory:  9.44GiB(19.87%)  tps: 6,267  tflops: 47.73  mfu: 15.30%
[rank1]:2025-11-06 12:50:52,276 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1508  tps: 6,446  tflops: 49.09  mfu: 14.74%
[rank1]:2025-11-06 12:50:52,277 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 12:50:52,277 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 12:50:52,385 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1508  memory:  6.53GiB(13.74%)  tps: 6,231  tflops: 47.46  mfu: 15.21%
[rank2]:2025-11-06 12:50:52,385 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1508  tps: 6,445  tflops: 49.09  mfu: 14.73%
[rank2]:2025-11-06 12:50:52,386 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 12:50:52,386 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-06 12:50:54,198 - INFO -  step: 1200  loss:  0.2423  grad_norm:  0.1508  memory: 17.37GiB(36.55%)  tps: 6,275  tflops: 47.79  mfu: 15.32%
[rank3]:2025-11-06 12:50:54,199 - INFO -  final step: 1200  loss:  0.2423  grad_norm:  0.1508  tps: 6,446  tflops: 49.09  mfu: 14.80%
[rank3]:2025-11-06 12:50:54,199 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 12:50:54,200 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 12:50:54,691 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1508  memory: 13.40GiB(28.22%)  tps: 6,317  tflops: 48.11  mfu: 15.42%
[rank0]:2025-11-06 12:50:54,692 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1508  tps: 6,442  tflops: 49.06  mfu: 14.74%
[rank0]:2025-11-06 12:50:54,692 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 12:50:54,693 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 12:50:56,940 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-06 12:50:57,032 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1250_stage0_final1200.svg
[rank2]:2025-11-06 12:50:57,035 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1250_stage2_final1200.svg
[rank1]:2025-11-06 12:50:57,025 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1250_stage1_final1200.svg
[rank3]:2025-11-06 12:50:57,119 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1250_real_final1200_rank3.svg
[rank3]:> Batch Time: 483.56 ms, GPU Bubble Ratio: 69.83%, 52.89%, 61.06%, 34.28%
[rank1]:2025-11-06 12:50:57,181 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1250_rank1_stage1.svg
[rank1]:	> Counts Sum: 1391400, Total Sum: 1612800 (86.27%), Ratio(%) per element: [86.04, 86.38, 86.38, 86.16, 85.93, 86.04, 86.27, 86.71, 86.6, 86.38, 86.16, 86.49, 86.16, 85.93, 86.49, 86.16, 86.83, 86.38, 86.27, 86.04, 86.38, 86.27, 86.38, 86.27, 86.16, 86.6, 86.04, 86.04, 86.04, 86.16, 86.16, 86.16, 86.04, 86.27, 86.71, 86.16, 86.16, 86.27, 86.16, 86.04, 86.04, 86.27, 86.27, 86.71, 86.49]
[rank1]:2025-11-06 12:50:57,181 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 12:50:57,207 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1250_rank0_stage0.svg
[rank0]:	> Counts Sum: 1062560, Total Sum: 1326080 (80.13%), Ratio(%) per element: [78.79, 78.9, 78.34, 78.68, 79.01, 78.79, 78.01, 79.12, 79.01, 81.25, 78.34, 78.9, 79.01, 79.57, 79.46, 80.02, 78.45, 86.71, 84.04, 80.46, 78.45, 78.45, 79.24, 79.46, 78.68, 78.23, 86.27, 84.48, 79.46, 79.12, 79.46, 79.57, 79.24, 78.23, 80.35, 86.38, 84.59]
[rank0]:2025-11-06 12:50:57,208 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-06 12:50:57,197 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1250_rank2_stage2.svg
[rank2]:	> Counts Sum: 1113120, Total Sum: 1290240 (86.27%), Ratio(%) per element: [86.16, 86.27, 85.93, 86.38, 86.04, 86.27, 86.27, 86.71, 86.38, 86.16, 86.04, 86.27, 86.27, 86.27, 85.93, 86.04, 86.83, 86.6, 86.27, 86.04, 86.38, 86.04, 86.16, 86.27, 86.27, 86.94, 86.49, 86.38, 86.16, 86.38, 86.04, 86.16, 86.04, 86.16, 86.16, 86.49]
[rank2]:2025-11-06 12:50:57,197 - INFO - Destroying the purge thread.
[rank3]:2025-11-06 12:50:57,269 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1250_thry_final1200_rank3.svg
[rank3]:> Batch Time: 325.52 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-06 12:50:57,314 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1250_stage3_final1200.svg
[rank3]:2025-11-06 12:50:57,454 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1250_rank3_stage3.svg
[rank3]:	> Counts Sum: 328200, Total Sum: 1039360 (31.58%), Ratio(%) per element: [29.12, 29.24, 28.45, 28.9, 28.68, 28.45, 28.79, 40.62, 41.74, 29.12, 28.01, 29.79, 28.9, 28.68, 28.34, 29.68, 39.06, 41.51, 29.79, 28.57, 28.9, 28.9, 28.79, 29.68, 29.35, 37.61, 37.16, 40.62, 29.12]
[rank3]:2025-11-06 12:50:57,455 - INFO - Destroying the purge thread.
[rank3]:wandb: uploading history steps 23-23, summary, console lines 285-289; updating run metadata
[rank2]:2025-11-06 12:50:57,658 - INFO - Process group destroyed
[rank1]:2025-11-06 12:50:57,636 - INFO - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.54184
[rank3]:wandb:               final/avg_loss 0.24231
[rank3]:wandb:             final/avg_mfu(%) 14.79922
[rank3]:wandb:             final/avg_tflops 49.09203
[rank3]:wandb:    final/avg_throughput(tps) 6445.72743
[rank3]:wandb:              final/grad_norm 0.15082
[rank3]:wandb:               final/max_loss 0.24231
[rank3]:wandb:                    grad_norm 0.15082
[rank3]:wandb: loss_metrics/global_avg_loss 0.24231
[rank3]:wandb: loss_metrics/global_max_loss 0.24231
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_1F1B_timelyapf_th0.1_m80_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/11eee7fx
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_1F1B_timelyapf_th0.1_m80_dm1/20251106-1157/wandb/run-20251106_115755-11eee7fx/logs
[rank3]:2025-11-06 12:50:58,608 - INFO - Process group destroyed
[rank0]:2025-11-06 12:50:59,208 - INFO - Training completed
[rank0]:2025-11-06 12:50:59,208 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 12:50:59,660 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.5', 'layers.6', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.1', 'layers.2', 'tok_embeddings', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.15', 'output', 'layers.13', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: monitoring steps = 50 -> 80"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.1
[rank3]:		- percentile: 70
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
