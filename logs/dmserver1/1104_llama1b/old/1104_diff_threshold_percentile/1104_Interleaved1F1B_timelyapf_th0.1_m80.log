
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 06. (ëª©) 12:51:02 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_Interleaved1F1B_timelyapf_th0.1_m80.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: monitoring steps = 50 -> 80
âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: monitoring steps = 50 -> 80" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.1
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-06 12:51:08,647 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:for timelyapf: monitoring steps = 50 -> 80"
[rank0]:2025-11-06 12:51:08,831 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-06 12:51:08,833 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 12:51:08,837 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-06 12:51:09,196 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:2025-11-06 12:51:09,227 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:for timelyapf: monitoring steps = 50 -> 80"
[rank2]:for timelyapf: monitoring steps = 50 -> 80"
[rank3]:2025-11-06 12:51:09,202 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: monitoring steps = 50 -> 80"
[rank1]:2025-11-06 12:51:09,457 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-06 12:51:09,459 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-06 12:51:09,475 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-06 12:51:09,478 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-06 12:51:09,492 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-06 12:51:09,494 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-06 12:51:09,826 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-06 12:51:10,240 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-06 12:51:13,185 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-06 12:51:13,179 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-06 12:51:13,219 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 12:51:13,246 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-06 12:51:13,259 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-06 12:51:13,260 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-06 12:51:13,367 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-06 12:51:13,352 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-06 12:51:13,409 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 12:51:13,410 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-06 12:51:13,427 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-06 12:51:13,438 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-06 12:51:13,440 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-06 12:51:13,460 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-06 12:51:13,461 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-06 12:51:13,394 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 12:51:13,413 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-06 12:51:13,425 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-06 12:51:13,427 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-06 12:51:13,461 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-06 12:51:13,641 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-06 12:51:13,641 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-06 12:51:13,642 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-06 12:51:13,638 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-06 12:51:13,639 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-06 12:51:13,639 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run m5dohwod
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/20251106-1251/wandb/run-20251106_125114-m5dohwod
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/m5dohwod
[rank3]:2025-11-06 12:51:15,517 - INFO - WandB logging enabled
[rank3]:2025-11-06 12:51:15,518 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-06 12:51:15,559 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 12:51:15,590 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-06 12:51:15,604 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-06 12:51:15,605 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-11-06 12:51:15,814 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-06 12:51:15,815 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-06 12:51:15,815 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-06 12:51:15,831 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 12:51:15,831 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank0]:2025-11-06 12:51:15,831 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 12:51:15,832 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-06 12:51:15,832 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-06 12:51:15,831 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-06 12:51:15,831 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-06 12:51:18,308 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-06 12:51:18,308 - INFO - Finished loading the checkpoint in 2.48 seconds.
[rank0]:2025-11-06 12:51:18,308 - INFO - Training starts at step 1
[rank1]:2025-11-06 12:51:21,726 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8891  memory:  9.58GiB(20.17%)  tps: 1,967  tflops: 14.98  mfu: 4.80%
[rank1]:2025-11-06 12:51:21,726 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-06 12:51:21,722 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8891  memory: 15.04GiB(31.66%)  tps: 2,660  tflops: 20.26  mfu: 6.49%
[rank3]:2025-11-06 12:51:21,722 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 12:51:21,748 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8891  memory: 10.96GiB(23.08%)  tps: 1,965  tflops: 14.97  mfu: 4.80%
[rank0]:2025-11-06 12:51:21,748 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-06 12:51:21,710 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8891  memory:  6.31GiB(13.29%)  tps: 1,930  tflops: 14.70  mfu: 4.71%
[rank2]:2025-11-06 12:51:21,710 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-06 12:53:30,698 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 12:53:33,050 - INFO - Avg. fwd time: 6.6702 / Avg. bwd time: 21.7657 / Avg. batch time: 563.5277 (ms) / GPU bubble ratio: 19.26%
[rank2]:2025-11-06 12:53:33,109 - INFO - Avg. fwd time: 3.9428 / Avg. bwd time: 10.0167 / Avg. batch time: 596.3359 (ms) / GPU bubble ratio: 62.55%
[rank0]:2025-11-06 12:53:33,129 - INFO - Avg. fwd time: 4.0686 / Avg. bwd time: 11.9669 / Avg. batch time: 648.3888 (ms) / GPU bubble ratio: 60.43%
[rank1]:2025-11-06 12:53:33,210 - INFO - Avg. fwd time: 4.8576 / Avg. bwd time: 12.2014 / Avg. batch time: 625.6534 (ms) / GPU bubble ratio: 56.37%
[rank2]:2025-11-06 12:53:33,374 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5580  memory:  8.13GiB(17.12%)  tps: 6,097  tflops: 46.44  mfu: 14.88%
[rank1]:2025-11-06 12:53:33,377 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5580  memory: 11.85GiB(24.93%)  tps: 6,098  tflops: 46.44  mfu: 14.89%
[rank0]:2025-11-06 12:53:33,388 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.5580  memory: 14.71GiB(30.97%)  tps: 6,099  tflops: 46.45  mfu: 14.89%
[rank3]:2025-11-06 12:53:33,386 - INFO -  step: 50  loss:  9.2041  grad_norm: 15.5580  memory: 18.46GiB(38.86%)  tps: 6,098  tflops: 46.44  mfu: 14.88%
[rank3]:2025-11-06 12:54:00,449 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-06 12:54:28,589 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank2]:2025-11-06 12:54:28,821 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank1]:2025-11-06 12:54:28,838 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank0]:2025-11-06 12:54:28,854 - WARNING - [Step 70] â³ Monitoring Upperbound... (280/290)
[rank3]:2025-11-06 12:55:00,535 - INFO - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-06 12:55:00,851 - INFO - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-06 12:55:03,258 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:03,275 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:03,294 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:03,311 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:05,185 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:05,203 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,507 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,517 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,527 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,536 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,549 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,570 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:05,880 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:05,872 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:05,888 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:05,899 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:05,853 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:05,907 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,882 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:05,934 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:05,990 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:05,912 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:05,934 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:05,947 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:05,938 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,010 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:05,939 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,010 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,019 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,052 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,084 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,093 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,024 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,031 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,077 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,091 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,100 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,106 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,034 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,085 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,101 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,106 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,043 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,077 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,085 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,091 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,103 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,111 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-06 12:55:06,119 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,103 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,111 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,121 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,130 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-06 12:55:06,140 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,113 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,123 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,134 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:06,147 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,114 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,122 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,127 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,141 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,156 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-06 12:55:06,169 - WARNING - Batch index 321 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-06 12:55:43,039 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 12:55:44,718 - INFO - Avg. fwd time: 4.2098 / Avg. bwd time: 10.2656 / Avg. batch time: 619.6657 (ms) / GPU bubble ratio: 62.62%
[rank2]:2025-11-06 12:55:44,819 - INFO - Avg. fwd time: 4.0796 / Avg. bwd time: 9.1153 / Avg. batch time: 572.0029 (ms) / GPU bubble ratio: 63.09%
[rank1]:2025-11-06 12:55:44,836 - INFO - Avg. fwd time: 5.0309 / Avg. bwd time: 11.0673 / Avg. batch time: 599.4829 (ms) / GPU bubble ratio: 57.03%
[rank3]:2025-11-06 12:55:44,796 - INFO - Avg. fwd time: 6.9159 / Avg. bwd time: 19.9902 / Avg. batch time: 541.0595 (ms) / GPU bubble ratio: 20.43%
[rank3]:2025-11-06 12:55:44,802 - INFO - [Step 100] âœ”ï¸  Setting Lowerbound
[rank2]:2025-11-06 12:55:45,037 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.86/0.86, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank2]:2025-11-06 12:55:45,038 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory:  8.13GiB(17.12%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank0]:2025-11-06 12:55:45,038 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.24, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 0.68/0.68, [MB7] 1.00/1.00
[rank0]:2025-11-06 12:55:45,038 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 14.71GiB(30.97%)  tps: 6,223  tflops: 47.39  mfu: 15.19%
[rank1]:2025-11-06 12:55:45,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 12:55:45,039 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 11.85GiB(24.93%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank3]:2025-11-06 12:55:45,289 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1255_max_batch_time.svg
[rank3]:> Batch Time: 523.84 ms, GPU Bubble Ratio: 50.61%, 47.53%, 57.05%, 12.24%
[rank3]:2025-11-06 12:55:45,532 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1255_min_batch_time.svg
[rank3]:> Batch Time: 320.58 ms, GPU Bubble Ratio: 68.23%, 47.58%, 56.27%, 10.60%
[rank1]:2025-11-06 12:55:45,862 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1255_stage1_step100.svg
[rank3]:2025-11-06 12:55:45,793 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1255_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 365.76 ms, GPU Bubble Ratio: 40.13%, 35.11%, 45.00%, 8.59%
[rank3]:2025-11-06 12:55:45,794 - INFO - 	> Batch Time: 365.76 ms (Average Freeze Ratio: 0.37, Time Reduction Rate: 0.30)
[rank3]:2025-11-06 12:55:45,797 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.60/0.60, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.98/0.98, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.62/0.62
[rank3]:2025-11-06 12:55:45,799 - INFO -  step: 100  loss:  4.2809  grad_norm:  0.0026  memory: 18.46GiB(38.86%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank0]:2025-11-06 12:55:45,857 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1255_stage0_step100.svg
[rank0]:2025-11-06 12:55:45,896 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1255_stage4_step100.svg
[rank2]:2025-11-06 12:55:45,860 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1255_stage2_step100.svg
[rank2]:2025-11-06 12:55:45,898 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1255_stage6_step100.svg
[rank1]:2025-11-06 12:55:45,902 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1255_stage5_step100.svg
[rank3]:2025-11-06 12:55:46,030 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1255_real_step100_rank3.svg
[rank3]:> Batch Time: 475.50 ms, GPU Bubble Ratio: 75.87%, 61.33%, 67.90%, 35.70%
[rank3]:2025-11-06 12:55:46,072 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1255_stage3_step100.svg
[rank3]:2025-11-06 12:55:46,109 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1255_stage7_step100.svg
[rank0]:2025-11-06 12:57:57,665 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-06 12:57:59,936 - INFO - Avg. fwd time: 4.1802 / Avg. bwd time: 8.6231 / Avg. batch time: 563.0781 (ms) / GPU bubble ratio: 63.62%
[rank3]:2025-11-06 12:57:59,912 - INFO - Avg. fwd time: 7.0662 / Avg. bwd time: 18.7188 / Avg. batch time: 525.6092 (ms) / GPU bubble ratio: 21.51%
[rank0]:2025-11-06 12:57:59,972 - INFO - Avg. fwd time: 4.2834 / Avg. bwd time: 9.4423 / Avg. batch time: 607.3870 (ms) / GPU bubble ratio: 63.84%
[rank1]:2025-11-06 12:57:59,956 - INFO - Avg. fwd time: 5.1449 / Avg. bwd time: 10.2114 / Avg. batch time: 588.1155 (ms) / GPU bubble ratio: 58.22%
[rank2]:2025-11-06 12:58:01,306 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.58/0.86, [MB6] 0.41/0.62, [MB7] 0.67/1.00
[rank2]:2025-11-06 12:58:01,306 - INFO -  step: 150  loss: -4.0000  grad_norm: 15.3380  memory:  8.48GiB(17.86%)  tps: 6,012  tflops: 45.79  mfu: 14.68%
[rank0]:2025-11-06 12:58:01,857 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.16/0.24, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.46/0.68, [MB7] 0.67/1.00
[rank0]:2025-11-06 12:58:01,857 - INFO -  step: 150  loss: -4.0000  grad_norm: 15.3380  memory: 14.79GiB(31.14%)  tps: 5,987  tflops: 45.60  mfu: 14.62%
[rank1]:2025-11-06 12:58:02,433 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-06 12:58:02,433 - INFO -  step: 150  loss: -4.0000  grad_norm: 15.3380  memory: 12.63GiB(26.58%)  tps: 5,962  tflops: 45.41  mfu: 14.55%
[rank3]:2025-11-06 12:58:04,028 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.40/0.60, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.00/0.00, [MB2] 0.66/0.98, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.41/0.62
[rank3]:2025-11-06 12:58:04,033 - INFO -  step: 150  loss:  1.4038  grad_norm: 15.3380  memory: 18.95GiB(39.89%)  tps: 5,926  tflops: 45.14  mfu: 14.47%
[rank0]:2025-11-06 13:00:10,218 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 13:00:12,115 - INFO - Avg. fwd time: 4.3309 / Avg. bwd time: 8.9889 / Avg. batch time: 605.3546 (ms) / GPU bubble ratio: 64.79%
[rank2]:2025-11-06 13:00:12,165 - INFO - Avg. fwd time: 4.2443 / Avg. bwd time: 8.3211 / Avg. batch time: 562.2088 (ms) / GPU bubble ratio: 64.24%
[rank3]:2025-11-06 13:00:12,138 - INFO - Avg. fwd time: 7.1871 / Avg. bwd time: 17.7589 / Avg. batch time: 514.1432 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-11-06 13:00:12,210 - INFO - Avg. fwd time: 5.2228 / Avg. bwd time: 9.6213 / Avg. batch time: 586.4269 (ms) / GPU bubble ratio: 59.50%
[rank2]:2025-11-06 13:00:13,597 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.86/0.86, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank2]:2025-11-06 13:00:13,597 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2166  memory:  8.48GiB(17.86%)  tps: 6,192  tflops: 47.16  mfu: 15.12%
[rank0]:2025-11-06 13:00:13,771 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.24, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 0.68/0.68, [MB7] 1.00/1.00
[rank0]:2025-11-06 13:00:13,772 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2166  memory: 14.87GiB(31.30%)  tps: 6,210  tflops: 47.30  mfu: 15.16%
[rank1]:2025-11-06 13:00:14,026 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 13:00:14,026 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2166  memory: 12.63GiB(26.58%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank2]:2025-11-06 13:00:16,113 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1300_stage2_step200.svg
[rank3]:2025-11-06 13:00:16,057 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.60/0.60, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.98/0.98, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.62/0.62
[rank3]:2025-11-06 13:00:16,059 - INFO -  step: 200  loss:  0.2933  grad_norm:  0.2166  memory: 19.46GiB(40.96%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank1]:2025-11-06 13:00:16,113 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1300_stage1_step200.svg
[rank0]:2025-11-06 13:00:16,114 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1300_stage0_step200.svg
[rank2]:2025-11-06 13:00:16,157 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1300_stage6_step200.svg
[rank1]:2025-11-06 13:00:16,156 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1300_stage5_step200.svg
[rank0]:2025-11-06 13:00:16,158 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1300_stage4_step200.svg
[rank3]:2025-11-06 13:00:16,305 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1300_real_step200_rank3.svg
[rank3]:> Batch Time: 522.49 ms, GPU Bubble Ratio: 65.61%, 60.55%, 65.58%, 34.56%
[rank3]:2025-11-06 13:00:16,350 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1300_stage3_step200.svg
[rank3]:2025-11-06 13:00:16,392 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1300_stage7_step200.svg
[rank0]:2025-11-06 13:02:17,598 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 13:02:19,483 - INFO - Avg. fwd time: 7.2880 / Avg. bwd time: 16.9293 / Avg. batch time: 504.3929 (ms) / GPU bubble ratio: 23.18%
[rank0]:2025-11-06 13:02:19,459 - INFO - Avg. fwd time: 4.3718 / Avg. bwd time: 8.0139 / Avg. batch time: 597.6567 (ms) / GPU bubble ratio: 66.84%
[rank1]:2025-11-06 13:02:19,525 - INFO - Avg. fwd time: 5.3013 / Avg. bwd time: 9.0437 / Avg. batch time: 580.9296 (ms) / GPU bubble ratio: 60.49%
[rank2]:2025-11-06 13:02:19,512 - INFO - Avg. fwd time: 4.3088 / Avg. bwd time: 7.9666 / Avg. batch time: 558.3736 (ms) / GPU bubble ratio: 64.83%
[rank1]:2025-11-06 13:02:20,909 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 13:02:20,910 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1201  memory: 12.63GiB(26.58%)  tps: 6,456  tflops: 49.17  mfu: 15.76%
[rank2]:2025-11-06 13:02:20,911 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.86/0.86, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank2]:2025-11-06 13:02:20,911 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1201  memory:  8.48GiB(17.86%)  tps: 6,435  tflops: 49.01  mfu: 15.71%
[rank0]:2025-11-06 13:02:20,943 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.24, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 0.68/0.68, [MB7] 1.00/1.00
[rank0]:2025-11-06 13:02:20,944 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1201  memory: 14.87GiB(31.30%)  tps: 6,442  tflops: 49.06  mfu: 15.72%
[rank3]:2025-11-06 13:02:23,213 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.60/0.60, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.98/0.98, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.62/0.62
[rank3]:2025-11-06 13:02:23,215 - INFO -  step: 250  loss:  0.2652  grad_norm:  0.1201  memory: 19.46GiB(40.96%)  tps: 6,443  tflops: 49.07  mfu: 15.73%
[rank0]:2025-11-06 13:04:22,564 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 13:04:24,701 - INFO - Avg. fwd time: 7.3559 / Avg. bwd time: 16.3359 / Avg. batch time: 497.3237 (ms) / GPU bubble ratio: 23.78%
[rank2]:2025-11-06 13:04:24,721 - INFO - Avg. fwd time: 4.3532 / Avg. bwd time: 7.7323 / Avg. batch time: 555.7715 (ms) / GPU bubble ratio: 65.21%
[rank1]:2025-11-06 13:04:24,741 - INFO - Avg. fwd time: 5.3528 / Avg. bwd time: 8.6652 / Avg. batch time: 577.2419 (ms) / GPU bubble ratio: 61.15%
[rank0]:2025-11-06 13:04:24,758 - INFO - Avg. fwd time: 4.3957 / Avg. bwd time: 7.3986 / Avg. batch time: 592.5245 (ms) / GPU bubble ratio: 68.15%
[rank2]:2025-11-06 13:04:26,076 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.86/0.86, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank2]:2025-11-06 13:04:26,076 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1018  memory:  8.48GiB(17.86%)  tps: 6,545  tflops: 49.85  mfu: 15.98%
[rank0]:2025-11-06 13:04:26,177 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.24, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 0.68/0.68, [MB7] 1.00/1.00
[rank0]:2025-11-06 13:04:26,178 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1018  memory: 14.87GiB(31.30%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank1]:2025-11-06 13:04:26,344 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-06 13:04:26,344 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1018  memory: 12.63GiB(26.58%)  tps: 6,531  tflops: 49.74  mfu: 15.94%
[rank3]:2025-11-06 13:04:29,708 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.60/0.60, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.98/0.98, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.62/0.62
[rank3]:2025-11-06 13:04:29,712 - INFO -  step: 300  loss:  0.2465  grad_norm:  0.1018  memory: 19.46GiB(40.96%)  tps: 6,476  tflops: 49.33  mfu: 15.81%
[rank2]:2025-11-06 13:04:29,764 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1304_stage2_step300.svg
[rank1]:2025-11-06 13:04:29,766 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1304_stage1_step300.svg
[rank0]:2025-11-06 13:04:29,765 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1304_stage0_step300.svg
[rank2]:2025-11-06 13:04:29,806 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1304_stage6_step300.svg
[rank1]:2025-11-06 13:04:29,807 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1304_stage5_step300.svg
[rank0]:2025-11-06 13:04:29,806 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1304_stage4_step300.svg
[rank3]:2025-11-06 13:04:29,950 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1304_real_step300_rank3.svg
[rank3]:> Batch Time: 517.00 ms, GPU Bubble Ratio: 72.10%, 61.31%, 65.36%, 33.93%
[rank3]:2025-11-06 13:04:29,992 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1304_stage3_step300.svg
[rank3]:2025-11-06 13:04:30,032 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1304_stage7_step300.svg
[rank0]:2025-11-06 13:06:33,056 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 13:06:34,955 - INFO - Avg. fwd time: 4.4092 / Avg. bwd time: 7.0333 / Avg. batch time: 591.7341 (ms) / GPU bubble ratio: 69.06%
[rank3]:2025-11-06 13:06:34,988 - INFO - Avg. fwd time: 7.3964 / Avg. bwd time: 16.0102 / Avg. batch time: 493.5516 (ms) / GPU bubble ratio: 24.12%
[rank2]:2025-11-06 13:06:35,015 - INFO - Avg. fwd time: 4.3780 / Avg. bwd time: 7.5889 / Avg. batch time: 556.4649 (ms) / GPU bubble ratio: 65.59%
[rank1]:2025-11-06 13:06:35,025 - INFO - Avg. fwd time: 5.3833 / Avg. bwd time: 8.4323 / Avg. batch time: 577.2848 (ms) / GPU bubble ratio: 61.71%
[rank0]:2025-11-06 13:06:36,420 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1090  memory: 14.87GiB(31.30%)  tps: 6,290  tflops: 47.91  mfu: 15.35%
[rank2]:2025-11-06 13:06:36,410 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1090  memory:  8.48GiB(17.86%)  tps: 6,285  tflops: 47.87  mfu: 15.34%
[rank1]:2025-11-06 13:06:36,449 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1090  memory: 12.63GiB(26.58%)  tps: 6,296  tflops: 47.96  mfu: 15.37%
[rank3]:2025-11-06 13:06:39,139 - INFO -  step: 350  loss:  0.2507  grad_norm:  0.1090  memory: 19.46GiB(40.96%)  tps: 6,330  tflops: 48.21  mfu: 15.45%
[rank0]:2025-11-06 13:08:39,718 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 13:08:41,632 - INFO - Avg. fwd time: 7.4333 / Avg. bwd time: 15.7340 / Avg. batch time: 490.4163 (ms) / GPU bubble ratio: 24.42%
[rank0]:2025-11-06 13:08:41,605 - INFO - Avg. fwd time: 4.4210 / Avg. bwd time: 6.7022 / Avg. batch time: 590.4346 (ms) / GPU bubble ratio: 69.86%
[rank2]:2025-11-06 13:08:41,661 - INFO - Avg. fwd time: 4.4003 / Avg. bwd time: 7.4622 / Avg. batch time: 556.3027 (ms) / GPU bubble ratio: 65.88%
[rank1]:2025-11-06 13:08:41,673 - INFO - Avg. fwd time: 5.4107 / Avg. bwd time: 8.2272 / Avg. batch time: 576.7520 (ms) / GPU bubble ratio: 62.17%
[rank0]:2025-11-06 13:08:43,023 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1048  memory: 14.87GiB(31.30%)  tps: 6,471  tflops: 49.28  mfu: 15.80%
[rank1]:2025-11-06 13:08:43,051 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1048  memory: 12.63GiB(26.58%)  tps: 6,471  tflops: 49.28  mfu: 15.80%
[rank2]:2025-11-06 13:08:43,116 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1048  memory:  8.48GiB(17.86%)  tps: 6,465  tflops: 49.24  mfu: 15.78%
[rank3]:2025-11-06 13:08:45,434 - INFO -  step: 400  loss:  0.2514  grad_norm:  0.1048  memory: 19.46GiB(40.96%)  tps: 6,486  tflops: 49.40  mfu: 15.83%
[rank0]:2025-11-06 13:08:45,491 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1308_stage0_step400.svg
[rank2]:2025-11-06 13:08:45,496 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1308_stage2_step400.svg
[rank1]:2025-11-06 13:08:45,492 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1308_stage1_step400.svg
[rank0]:2025-11-06 13:08:45,537 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1308_stage4_step400.svg
[rank2]:2025-11-06 13:08:45,543 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1308_stage6_step400.svg
[rank1]:2025-11-06 13:08:45,536 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1308_stage5_step400.svg
[rank3]:2025-11-06 13:08:45,671 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1308_real_step400_rank3.svg
[rank3]:> Batch Time: 520.00 ms, GPU Bubble Ratio: 72.61%, 61.52%, 65.57%, 34.49%
[rank3]:2025-11-06 13:08:45,717 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1308_stage3_step400.svg
[rank3]:2025-11-06 13:08:45,760 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1308_stage7_step400.svg
[rank3]:2025-11-06 13:08:56,758 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 13:08:56,968 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 13:08:56,961 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 13:08:56,967 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 13:10:44,816 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 13:10:46,915 - INFO - Avg. fwd time: 7.4637 / Avg. bwd time: 15.5072 / Avg. batch time: 487.7827 (ms) / GPU bubble ratio: 24.65%
[rank1]:2025-11-06 13:10:46,955 - INFO - Avg. fwd time: 5.4329 / Avg. bwd time: 8.0705 / Avg. batch time: 574.5877 (ms) / GPU bubble ratio: 62.40%
[rank0]:2025-11-06 13:10:46,970 - INFO - Avg. fwd time: 4.4311 / Avg. bwd time: 6.4389 / Avg. batch time: 587.8766 (ms) / GPU bubble ratio: 70.42%
[rank2]:2025-11-06 13:10:46,937 - INFO - Avg. fwd time: 4.4180 / Avg. bwd time: 7.3660 / Avg. batch time: 554.3364 (ms) / GPU bubble ratio: 65.99%
[rank0]:2025-11-06 13:10:48,023 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1034  memory: 14.87GiB(31.30%)  tps: 6,554  tflops: 49.91  mfu: 16.00%
[rank1]:2025-11-06 13:10:48,130 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1034  memory: 12.63GiB(26.58%)  tps: 6,549  tflops: 49.88  mfu: 15.99%
[rank2]:2025-11-06 13:10:48,200 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1034  memory:  8.48GiB(17.86%)  tps: 6,549  tflops: 49.88  mfu: 15.99%
[rank3]:2025-11-06 13:10:50,744 - INFO -  step: 450  loss:  0.2490  grad_norm:  0.1034  memory: 19.46GiB(40.96%)  tps: 6,537  tflops: 49.79  mfu: 15.96%
[rank0]:2025-11-06 13:12:50,037 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 13:12:51,941 - INFO - Avg. fwd time: 4.4357 / Avg. bwd time: 6.2734 / Avg. batch time: 588.0150 (ms) / GPU bubble ratio: 70.86%
[rank3]:2025-11-06 13:12:51,972 - INFO - Avg. fwd time: 7.4838 / Avg. bwd time: 15.3596 / Avg. batch time: 486.0985 (ms) / GPU bubble ratio: 24.81%
[rank1]:2025-11-06 13:12:52,009 - INFO - Avg. fwd time: 5.4478 / Avg. bwd time: 7.9625 / Avg. batch time: 575.0246 (ms) / GPU bubble ratio: 62.69%
[rank2]:2025-11-06 13:12:52,000 - INFO - Avg. fwd time: 4.4298 / Avg. bwd time: 7.2999 / Avg. batch time: 555.0713 (ms) / GPU bubble ratio: 66.19%
[rank2]:2025-11-06 13:12:53,252 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1123  memory:  8.48GiB(17.86%)  tps: 6,551  tflops: 49.89  mfu: 15.99%
[rank1]:2025-11-06 13:12:53,392 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1123  memory: 12.63GiB(26.58%)  tps: 6,540  tflops: 49.81  mfu: 15.96%
[rank0]:2025-11-06 13:12:53,640 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1123  memory: 14.87GiB(31.30%)  tps: 6,521  tflops: 49.67  mfu: 15.92%
[rank3]:2025-11-06 13:12:56,051 - INFO -  step: 500  loss:  0.2796  grad_norm:  0.1123  memory: 19.46GiB(40.96%)  tps: 6,538  tflops: 49.79  mfu: 15.96%
[rank1]:2025-11-06 13:12:56,108 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1312_stage1_step500.svg
[rank1]:2025-11-06 13:12:56,149 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1312_stage5_step500.svg
[rank2]:2025-11-06 13:12:56,104 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1312_stage2_step500.svg
[rank2]:2025-11-06 13:12:56,144 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1312_stage6_step500.svg
[rank0]:2025-11-06 13:12:56,103 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1312_stage0_step500.svg
[rank0]:2025-11-06 13:12:56,142 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1312_stage4_step500.svg
[rank3]:2025-11-06 13:12:56,290 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1312_real_step500_rank3.svg
[rank3]:> Batch Time: 521.00 ms, GPU Bubble Ratio: 71.76%, 61.62%, 65.55%, 33.86%
[rank3]:2025-11-06 13:12:56,333 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1312_stage3_step500.svg
[rank3]:2025-11-06 13:12:56,373 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1312_stage7_step500.svg
[rank0]:2025-11-06 13:14:55,923 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 13:14:57,809 - INFO - Avg. fwd time: 4.4427 / Avg. bwd time: 6.0969 / Avg. batch time: 585.6746 (ms) / GPU bubble ratio: 71.21%
[rank1]:2025-11-06 13:14:57,876 - INFO - Avg. fwd time: 5.4619 / Avg. bwd time: 7.8586 / Avg. batch time: 573.1371 (ms) / GPU bubble ratio: 62.81%
[rank2]:2025-11-06 13:14:57,865 - INFO - Avg. fwd time: 4.4411 / Avg. bwd time: 7.2370 / Avg. batch time: 553.5300 (ms) / GPU bubble ratio: 66.24%
[rank3]:2025-11-06 13:14:57,838 - INFO - Avg. fwd time: 7.5017 / Avg. bwd time: 15.2160 / Avg. batch time: 484.4069 (ms) / GPU bubble ratio: 24.96%
[rank1]:2025-11-06 13:14:59,228 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1177  memory: 12.63GiB(26.58%)  tps: 6,510  tflops: 49.58  mfu: 15.89%
[rank2]:2025-11-06 13:14:59,283 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1177  memory:  8.48GiB(17.86%)  tps: 6,500  tflops: 49.51  mfu: 15.87%
[rank0]:2025-11-06 13:14:59,444 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1177  memory: 14.87GiB(31.30%)  tps: 6,512  tflops: 49.59  mfu: 15.90%
[rank3]:2025-11-06 13:15:01,603 - INFO -  step: 550  loss:  0.3223  grad_norm:  0.1177  memory: 19.46GiB(40.96%)  tps: 6,525  tflops: 49.70  mfu: 15.93%
[rank0]:2025-11-06 13:17:00,711 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 13:17:02,879 - INFO - Avg. fwd time: 4.4500 / Avg. bwd time: 7.1842 / Avg. batch time: 553.0283 (ms) / GPU bubble ratio: 66.34%
[rank3]:2025-11-06 13:17:02,856 - INFO - Avg. fwd time: 7.5169 / Avg. bwd time: 15.0842 / Avg. batch time: 482.8263 (ms) / GPU bubble ratio: 25.10%
[rank1]:2025-11-06 13:17:02,899 - INFO - Avg. fwd time: 5.4736 / Avg. bwd time: 7.7723 / Avg. batch time: 572.3519 (ms) / GPU bubble ratio: 62.97%
[rank0]:2025-11-06 13:17:02,912 - INFO - Avg. fwd time: 4.4467 / Avg. bwd time: 5.9607 / Avg. batch time: 584.5208 (ms) / GPU bubble ratio: 71.51%
[rank2]:2025-11-06 13:17:04,020 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0958  memory:  8.48GiB(17.86%)  tps: 6,567  tflops: 50.02  mfu: 16.03%
[rank0]:2025-11-06 13:17:04,064 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0958  memory: 14.87GiB(31.30%)  tps: 6,574  tflops: 50.07  mfu: 16.05%
[rank1]:2025-11-06 13:17:04,087 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0958  memory: 12.63GiB(26.58%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank2]:2025-11-06 13:17:06,782 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1317_stage2_step600.svg
[rank0]:2025-11-06 13:17:06,789 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1317_stage0_step600.svg
[rank3]:2025-11-06 13:17:06,730 - INFO -  step: 600  loss:  0.2385  grad_norm:  0.0958  memory: 19.46GiB(40.96%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank1]:2025-11-06 13:17:06,782 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1317_stage1_step600.svg
[rank1]:2025-11-06 13:17:06,824 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1317_stage5_step600.svg
[rank2]:2025-11-06 13:17:06,824 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1317_stage6_step600.svg
[rank0]:2025-11-06 13:17:06,831 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1317_stage4_step600.svg
[rank3]:2025-11-06 13:17:06,975 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1317_real_step600_rank3.svg
[rank3]:> Batch Time: 519.00 ms, GPU Bubble Ratio: 71.92%, 61.48%, 65.52%, 33.93%
[rank3]:2025-11-06 13:17:07,019 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1317_stage3_step600.svg
[rank3]:2025-11-06 13:17:07,060 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1317_stage7_step600.svg
[rank0]:2025-11-06 13:19:05,977 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 13:19:07,859 - INFO - Avg. fwd time: 4.4511 / Avg. bwd time: 5.8567 / Avg. batch time: 583.9149 (ms) / GPU bubble ratio: 71.76%
[rank1]:2025-11-06 13:19:07,929 - INFO - Avg. fwd time: 5.4830 / Avg. bwd time: 7.7102 / Avg. batch time: 571.7952 (ms) / GPU bubble ratio: 63.08%
[rank2]:2025-11-06 13:19:07,914 - INFO - Avg. fwd time: 4.4578 / Avg. bwd time: 7.1460 / Avg. batch time: 552.6491 (ms) / GPU bubble ratio: 66.41%
[rank3]:2025-11-06 13:19:07,894 - INFO - Avg. fwd time: 7.5291 / Avg. bwd time: 14.9912 / Avg. batch time: 481.7618 (ms) / GPU bubble ratio: 25.21%
[rank0]:2025-11-06 13:19:09,175 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1096  memory: 14.87GiB(31.30%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank1]:2025-11-06 13:19:09,318 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1096  memory: 12.63GiB(26.58%)  tps: 6,542  tflops: 49.82  mfu: 15.97%
[rank2]:2025-11-06 13:19:09,325 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1096  memory:  8.48GiB(17.86%)  tps: 6,538  tflops: 49.79  mfu: 15.96%
[rank3]:2025-11-06 13:19:12,150 - INFO -  step: 650  loss:  0.2519  grad_norm:  0.1096  memory: 19.46GiB(40.96%)  tps: 6,532  tflops: 49.75  mfu: 15.94%
[rank0]:2025-11-06 13:21:10,768 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 13:21:12,727 - INFO - Avg. fwd time: 4.4652 / Avg. bwd time: 7.1085 / Avg. batch time: 552.5808 (ms) / GPU bubble ratio: 66.49%
[rank0]:2025-11-06 13:21:12,674 - INFO - Avg. fwd time: 4.4555 / Avg. bwd time: 5.7566 / Avg. batch time: 583.5461 (ms) / GPU bubble ratio: 72.00%
[rank3]:2025-11-06 13:21:12,708 - INFO - Avg. fwd time: 7.5427 / Avg. bwd time: 14.8952 / Avg. batch time: 480.6494 (ms) / GPU bubble ratio: 25.31%
[rank1]:2025-11-06 13:21:12,744 - INFO - Avg. fwd time: 5.4928 / Avg. bwd time: 7.6481 / Avg. batch time: 571.5519 (ms) / GPU bubble ratio: 63.21%
[rank0]:2025-11-06 13:21:13,953 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0984  memory: 14.87GiB(31.30%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank2]:2025-11-06 13:21:14,043 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0984  memory:  8.48GiB(17.86%)  tps: 6,568  tflops: 50.03  mfu: 16.03%
[rank1]:2025-11-06 13:21:14,095 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0984  memory: 12.63GiB(26.58%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank0]:2025-11-06 13:21:16,853 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1321_stage0_step700.svg
[rank3]:2025-11-06 13:21:16,799 - INFO -  step: 700  loss:  0.2312  grad_norm:  0.0984  memory: 19.46GiB(40.96%)  tps: 6,572  tflops: 50.05  mfu: 16.04%
[rank1]:2025-11-06 13:21:16,853 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1321_stage1_step700.svg
[rank1]:2025-11-06 13:21:16,897 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1321_stage5_step700.svg
[rank2]:2025-11-06 13:21:16,855 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1321_stage2_step700.svg
[rank2]:2025-11-06 13:21:16,903 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1321_stage6_step700.svg
[rank0]:2025-11-06 13:21:16,897 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1321_stage4_step700.svg
[rank3]:2025-11-06 13:21:17,044 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1321_real_step700_rank3.svg
[rank3]:> Batch Time: 521.50 ms, GPU Bubble Ratio: 72.26%, 61.58%, 65.56%, 33.85%
[rank3]:2025-11-06 13:21:17,089 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1321_stage3_step700.svg
[rank3]:2025-11-06 13:21:17,132 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1321_stage7_step700.svg
[rank0]:2025-11-06 13:23:17,676 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-06 13:23:19,894 - INFO - Avg. fwd time: 4.4734 / Avg. bwd time: 7.0802 / Avg. batch time: 552.0828 (ms) / GPU bubble ratio: 66.52%
[rank3]:2025-11-06 13:23:19,858 - INFO - Avg. fwd time: 7.5586 / Avg. bwd time: 14.8220 / Avg. batch time: 480.0408 (ms) / GPU bubble ratio: 25.40%
[rank0]:2025-11-06 13:23:19,931 - INFO - Avg. fwd time: 4.4626 / Avg. bwd time: 5.6769 / Avg. batch time: 582.7033 (ms) / GPU bubble ratio: 72.16%
[rank1]:2025-11-06 13:23:19,915 - INFO - Avg. fwd time: 5.5027 / Avg. bwd time: 7.5977 / Avg. batch time: 570.9102 (ms) / GPU bubble ratio: 63.29%
[rank0]:2025-11-06 13:23:21,020 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1115  memory: 14.87GiB(31.30%)  tps: 6,447  tflops: 49.10  mfu: 15.74%
[rank1]:2025-11-06 13:23:21,054 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1115  memory: 12.63GiB(26.58%)  tps: 6,453  tflops: 49.14  mfu: 15.75%
[rank2]:2025-11-06 13:23:21,073 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1115  memory:  8.48GiB(17.86%)  tps: 6,449  tflops: 49.12  mfu: 15.74%
[rank3]:2025-11-06 13:23:23,805 - INFO -  step: 750  loss:  0.2903  grad_norm:  0.1115  memory: 19.46GiB(40.96%)  tps: 6,451  tflops: 49.13  mfu: 15.75%
[rank0]:2025-11-06 13:25:24,291 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 13:25:26,186 - INFO - Avg. fwd time: 4.4651 / Avg. bwd time: 5.6164 / Avg. batch time: 583.5792 (ms) / GPU bubble ratio: 72.36%
[rank2]:2025-11-06 13:25:26,245 - INFO - Avg. fwd time: 4.4783 / Avg. bwd time: 7.0561 / Avg. batch time: 553.1337 (ms) / GPU bubble ratio: 66.64%
[rank3]:2025-11-06 13:25:26,221 - INFO - Avg. fwd time: 7.5676 / Avg. bwd time: 14.7652 / Avg. batch time: 479.4521 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-11-06 13:25:26,256 - INFO - Avg. fwd time: 5.5086 / Avg. bwd time: 7.5580 / Avg. batch time: 571.8301 (ms) / GPU bubble ratio: 63.44%
[rank0]:2025-11-06 13:25:27,384 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1107  memory: 14.87GiB(31.30%)  tps: 6,483  tflops: 49.38  mfu: 15.83%
[rank1]:2025-11-06 13:25:27,595 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1107  memory: 12.63GiB(26.58%)  tps: 6,474  tflops: 49.31  mfu: 15.80%
[rank2]:2025-11-06 13:25:27,619 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1107  memory:  8.48GiB(17.86%)  tps: 6,474  tflops: 49.30  mfu: 15.80%
[rank3]:2025-11-06 13:25:29,981 - INFO -  step: 800  loss:  0.2405  grad_norm:  0.1107  memory: 19.46GiB(40.96%)  tps: 6,493  tflops: 49.45  mfu: 15.85%
[rank1]:2025-11-06 13:25:30,048 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1325_stage1_step800.svg
[rank2]:2025-11-06 13:25:30,048 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1325_stage2_step800.svg
[rank0]:2025-11-06 13:25:30,048 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1325_stage0_step800.svg
[rank0]:2025-11-06 13:25:30,094 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1325_stage4_step800.svg
[rank1]:2025-11-06 13:25:30,094 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1325_stage5_step800.svg
[rank2]:2025-11-06 13:25:30,094 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1325_stage6_step800.svg
[rank3]:2025-11-06 13:25:30,227 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1325_real_step800_rank3.svg
[rank3]:> Batch Time: 518.50 ms, GPU Bubble Ratio: 72.04%, 61.48%, 65.46%, 34.05%
[rank3]:2025-11-06 13:25:30,274 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1325_stage3_step800.svg
[rank3]:2025-11-06 13:25:30,318 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1325_stage7_step800.svg
[rank3]:2025-11-06 13:25:56,771 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 13:25:56,970 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 13:25:56,962 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 13:25:56,970 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 13:27:29,614 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 13:27:31,483 - INFO - Avg. fwd time: 4.4675 / Avg. bwd time: 5.5532 / Avg. batch time: 582.5945 (ms) / GPU bubble ratio: 72.48%
[rank3]:2025-11-06 13:27:31,518 - INFO - Avg. fwd time: 7.5753 / Avg. bwd time: 14.6973 / Avg. batch time: 478.6306 (ms) / GPU bubble ratio: 25.55%
[rank1]:2025-11-06 13:27:31,551 - INFO - Avg. fwd time: 5.5138 / Avg. bwd time: 7.5158 / Avg. batch time: 570.8772 (ms) / GPU bubble ratio: 63.48%
[rank2]:2025-11-06 13:27:31,539 - INFO - Avg. fwd time: 4.4829 / Avg. bwd time: 7.0302 / Avg. batch time: 552.3212 (ms) / GPU bubble ratio: 66.65%
[rank0]:2025-11-06 13:27:32,699 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1213  memory: 14.87GiB(31.30%)  tps: 6,537  tflops: 49.79  mfu: 15.96%
[rank2]:2025-11-06 13:27:32,875 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1213  memory:  8.48GiB(17.86%)  tps: 6,540  tflops: 49.81  mfu: 15.97%
[rank1]:2025-11-06 13:27:32,938 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1213  memory: 12.63GiB(26.58%)  tps: 6,536  tflops: 49.78  mfu: 15.95%
[rank3]:2025-11-06 13:27:35,379 - INFO -  step: 850  loss:  0.2469  grad_norm:  0.1213  memory: 19.46GiB(40.96%)  tps: 6,533  tflops: 49.76  mfu: 15.95%
[rank0]:2025-11-06 13:29:35,185 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 13:29:37,314 - INFO - Avg. fwd time: 7.5812 / Avg. bwd time: 14.6457 / Avg. batch time: 478.0075 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-11-06 13:29:37,364 - INFO - Avg. fwd time: 5.5180 / Avg. bwd time: 7.4780 / Avg. batch time: 570.8485 (ms) / GPU bubble ratio: 63.57%
[rank2]:2025-11-06 13:29:37,341 - INFO - Avg. fwd time: 4.4864 / Avg. bwd time: 7.0066 / Avg. batch time: 552.3635 (ms) / GPU bubble ratio: 66.71%
[rank0]:2025-11-06 13:29:37,381 - INFO - Avg. fwd time: 4.4687 / Avg. bwd time: 5.4957 / Avg. batch time: 582.7177 (ms) / GPU bubble ratio: 72.64%
[rank0]:2025-11-06 13:29:38,392 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0996  memory: 14.87GiB(31.30%)  tps: 6,518  tflops: 49.64  mfu: 15.91%
[rank1]:2025-11-06 13:29:38,610 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0996  memory: 12.63GiB(26.58%)  tps: 6,519  tflops: 49.65  mfu: 15.91%
[rank2]:2025-11-06 13:29:38,775 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0996  memory:  8.48GiB(17.86%)  tps: 6,507  tflops: 49.56  mfu: 15.88%
[rank3]:2025-11-06 13:29:41,379 - INFO -  step: 900  loss:  0.2168  grad_norm:  0.0996  memory: 19.46GiB(40.96%)  tps: 6,502  tflops: 49.52  mfu: 15.87%
[rank0]:2025-11-06 13:29:41,430 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1329_stage0_step900.svg
[rank0]:2025-11-06 13:29:41,469 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1329_stage4_step900.svg
[rank1]:2025-11-06 13:29:41,430 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1329_stage1_step900.svg
[rank1]:2025-11-06 13:29:41,470 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1329_stage5_step900.svg
[rank2]:2025-11-06 13:29:41,437 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1329_stage2_step900.svg
[rank2]:2025-11-06 13:29:41,480 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1329_stage6_step900.svg
[rank3]:2025-11-06 13:29:41,618 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1329_real_step900_rank3.svg
[rank3]:> Batch Time: 520.00 ms, GPU Bubble Ratio: 71.97%, 61.62%, 65.62%, 33.86%
[rank3]:2025-11-06 13:29:41,659 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1329_stage3_step900.svg
[rank3]:2025-11-06 13:29:41,697 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1329_stage7_step900.svg
[rank0]:2025-11-06 13:31:40,804 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 13:31:42,709 - INFO - Avg. fwd time: 7.5877 / Avg. bwd time: 14.5978 / Avg. batch time: 477.4390 (ms) / GPU bubble ratio: 25.65%
[rank0]:2025-11-06 13:31:42,679 - INFO - Avg. fwd time: 4.4693 / Avg. bwd time: 5.4532 / Avg. batch time: 582.4943 (ms) / GPU bubble ratio: 72.74%
[rank2]:2025-11-06 13:31:42,745 - INFO - Avg. fwd time: 4.4896 / Avg. bwd time: 6.9881 / Avg. batch time: 552.2730 (ms) / GPU bubble ratio: 66.75%
[rank1]:2025-11-06 13:31:42,750 - INFO - Avg. fwd time: 5.5216 / Avg. bwd time: 7.4491 / Avg. batch time: 570.6557 (ms) / GPU bubble ratio: 63.63%
[rank0]:2025-11-06 13:31:43,913 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1071  memory: 14.87GiB(31.30%)  tps: 6,526  tflops: 49.71  mfu: 15.93%
[rank2]:2025-11-06 13:31:43,972 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1071  memory:  8.48GiB(17.86%)  tps: 6,543  tflops: 49.84  mfu: 15.97%
[rank1]:2025-11-06 13:31:44,067 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1071  memory: 12.63GiB(26.58%)  tps: 6,530  tflops: 49.73  mfu: 15.94%
[rank3]:2025-11-06 13:31:46,641 - INFO -  step: 950  loss:  0.2687  grad_norm:  0.1071  memory: 19.46GiB(40.96%)  tps: 6,540  tflops: 49.81  mfu: 15.96%
[rank0]:2025-11-06 13:33:46,033 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 13:33:47,972 - INFO - Avg. fwd time: 7.5959 / Avg. bwd time: 14.5495 / Avg. batch time: 476.8950 (ms) / GPU bubble ratio: 25.70%
[rank2]:2025-11-06 13:33:48,008 - INFO - Avg. fwd time: 4.4926 / Avg. bwd time: 6.9691 / Avg. batch time: 552.4108 (ms) / GPU bubble ratio: 66.80%
[rank0]:2025-11-06 13:33:47,950 - INFO - Avg. fwd time: 4.4703 / Avg. bwd time: 5.4099 / Avg. batch time: 582.4260 (ms) / GPU bubble ratio: 72.86%
[rank1]:2025-11-06 13:33:48,020 - INFO - Avg. fwd time: 5.5254 / Avg. bwd time: 7.4193 / Avg. batch time: 570.6857 (ms) / GPU bubble ratio: 63.71%
[rank2]:2025-11-06 13:33:49,309 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1083  memory:  8.48GiB(17.86%)  tps: 6,536  tflops: 49.78  mfu: 15.96%
[rank0]:2025-11-06 13:33:49,240 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1083  memory: 14.87GiB(31.30%)  tps: 6,537  tflops: 49.78  mfu: 15.96%
[rank1]:2025-11-06 13:33:49,365 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1083  memory: 12.63GiB(26.58%)  tps: 6,538  tflops: 49.80  mfu: 15.96%
[rank3]:2025-11-06 13:33:51,786 - INFO -  step: 1000  loss:  0.2558  grad_norm:  0.1083  memory: 19.46GiB(40.96%)  tps: 6,546  tflops: 49.86  mfu: 15.98%
[rank1]:2025-11-06 13:33:51,837 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1333_stage1_step1000.svg
[rank1]:2025-11-06 13:33:51,878 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1333_stage5_step1000.svg
[rank2]:2025-11-06 13:33:51,846 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1333_stage2_step1000.svg
[rank2]:2025-11-06 13:33:51,889 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1333_stage6_step1000.svg
[rank0]:2025-11-06 13:33:51,837 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1333_stage0_step1000.svg
[rank0]:2025-11-06 13:33:51,879 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1333_stage4_step1000.svg
[rank3]:2025-11-06 13:33:52,019 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1333_real_step1000_rank3.svg
[rank3]:> Batch Time: 520.50 ms, GPU Bubble Ratio: 71.57%, 61.61%, 65.63%, 34.07%
[rank3]:2025-11-06 13:33:52,061 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1333_stage3_step1000.svg
[rank3]:2025-11-06 13:33:52,101 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1333_stage7_step1000.svg
[rank0]:2025-11-06 13:35:51,850 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-06 13:35:53,972 - INFO - Avg. fwd time: 7.6042 / Avg. bwd time: 14.5044 / Avg. batch time: 476.3919 (ms) / GPU bubble ratio: 25.75%
[rank2]:2025-11-06 13:35:53,999 - INFO - Avg. fwd time: 4.4958 / Avg. bwd time: 6.9519 / Avg. batch time: 552.0518 (ms) / GPU bubble ratio: 66.82%
[rank1]:2025-11-06 13:35:54,023 - INFO - Avg. fwd time: 5.5289 / Avg. bwd time: 7.3928 / Avg. batch time: 570.2332 (ms) / GPU bubble ratio: 63.74%
[rank0]:2025-11-06 13:35:54,041 - INFO - Avg. fwd time: 4.4717 / Avg. bwd time: 5.3673 / Avg. batch time: 581.8471 (ms) / GPU bubble ratio: 72.94%
[rank2]:2025-11-06 13:35:55,100 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1233  memory:  8.48GiB(17.86%)  tps: 6,512  tflops: 49.60  mfu: 15.90%
[rank0]:2025-11-06 13:35:55,165 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1233  memory: 14.87GiB(31.30%)  tps: 6,505  tflops: 49.55  mfu: 15.88%
[rank1]:2025-11-06 13:35:55,187 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1233  memory: 12.63GiB(26.58%)  tps: 6,511  tflops: 49.59  mfu: 15.89%
[rank3]:2025-11-06 13:35:57,806 - INFO -  step: 1050  loss:  0.2993  grad_norm:  0.1233  memory: 19.46GiB(40.96%)  tps: 6,501  tflops: 49.51  mfu: 15.87%
[rank0]:2025-11-06 13:37:57,555 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 13:37:59,453 - INFO - Avg. fwd time: 4.4723 / Avg. bwd time: 5.3338 / Avg. batch time: 582.3690 (ms) / GPU bubble ratio: 73.06%
[rank1]:2025-11-06 13:37:59,525 - INFO - Avg. fwd time: 5.5317 / Avg. bwd time: 7.3714 / Avg. batch time: 570.8172 (ms) / GPU bubble ratio: 63.83%
[rank2]:2025-11-06 13:37:59,514 - INFO - Avg. fwd time: 4.4979 / Avg. bwd time: 6.9390 / Avg. batch time: 552.7112 (ms) / GPU bubble ratio: 66.89%
[rank3]:2025-11-06 13:37:59,489 - INFO - Avg. fwd time: 7.6075 / Avg. bwd time: 14.4745 / Avg. batch time: 476.0220 (ms) / GPU bubble ratio: 25.78%
[rank2]:2025-11-06 13:38:00,692 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1088  memory:  8.48GiB(17.86%)  tps: 6,523  tflops: 49.68  mfu: 15.92%
[rank1]:2025-11-06 13:38:00,839 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1088  memory: 12.63GiB(26.58%)  tps: 6,520  tflops: 49.65  mfu: 15.92%
[rank0]:2025-11-06 13:38:00,780 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1088  memory: 14.87GiB(31.30%)  tps: 6,522  tflops: 49.67  mfu: 15.92%
[rank3]:2025-11-06 13:38:03,234 - INFO -  step: 1100  loss:  0.2590  grad_norm:  0.1088  memory: 19.46GiB(40.96%)  tps: 6,531  tflops: 49.74  mfu: 15.94%
[rank1]:2025-11-06 13:38:03,285 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1338_stage1_step1100.svg
[rank1]:2025-11-06 13:38:03,326 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1338_stage5_step1100.svg
[rank2]:2025-11-06 13:38:03,284 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1338_stage2_step1100.svg
[rank2]:2025-11-06 13:38:03,325 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1338_stage6_step1100.svg
[rank0]:2025-11-06 13:38:03,284 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1338_stage0_step1100.svg
[rank0]:2025-11-06 13:38:03,325 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1338_stage4_step1100.svg
[rank3]:2025-11-06 13:38:03,468 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1338_real_step1100_rank3.svg
[rank3]:> Batch Time: 519.00 ms, GPU Bubble Ratio: 72.03%, 61.53%, 65.49%, 33.69%
[rank3]:2025-11-06 13:38:03,511 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1338_stage3_step1100.svg
[rank3]:2025-11-06 13:38:03,551 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1338_stage7_step1100.svg
[rank0]:2025-11-06 13:40:03,098 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-06 13:40:04,973 - INFO - Avg. fwd time: 4.4728 / Avg. bwd time: 5.2968 / Avg. batch time: 581.8695 (ms) / GPU bubble ratio: 73.14%
[rank3]:2025-11-06 13:40:05,005 - INFO - Avg. fwd time: 7.6107 / Avg. bwd time: 14.4393 / Avg. batch time: 475.5781 (ms) / GPU bubble ratio: 25.82%
[rank2]:2025-11-06 13:40:05,033 - INFO - Avg. fwd time: 4.5002 / Avg. bwd time: 6.9247 / Avg. batch time: 552.3629 (ms) / GPU bubble ratio: 66.91%
[rank1]:2025-11-06 13:40:05,046 - INFO - Avg. fwd time: 5.5345 / Avg. bwd time: 7.3483 / Avg. batch time: 570.3872 (ms) / GPU bubble ratio: 63.86%
[rank2]:2025-11-06 13:40:06,210 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0970  memory:  8.48GiB(17.86%)  tps: 6,527  tflops: 49.71  mfu: 15.93%
[rank0]:2025-11-06 13:40:06,295 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0970  memory: 14.87GiB(31.30%)  tps: 6,527  tflops: 49.71  mfu: 15.93%
[rank1]:2025-11-06 13:40:06,348 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0970  memory: 12.63GiB(26.58%)  tps: 6,527  tflops: 49.71  mfu: 15.93%
[rank3]:2025-11-06 13:40:08,611 - INFO -  step: 1150  loss:  0.2601  grad_norm:  0.0970  memory: 19.46GiB(40.96%)  tps: 6,534  tflops: 49.76  mfu: 15.95%
[rank0]:2025-11-06 13:42:07,888 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 13:42:10,028 - INFO - Avg. fwd time: 7.6131 / Avg. bwd time: 14.4087 / Avg. batch time: 475.1863 (ms) / GPU bubble ratio: 25.85%
[rank2]:2025-11-06 13:42:10,056 - INFO - Avg. fwd time: 4.5022 / Avg. bwd time: 6.9120 / Avg. batch time: 552.3822 (ms) / GPU bubble ratio: 66.94%
[rank0]:2025-11-06 13:42:10,100 - INFO - Avg. fwd time: 4.4736 / Avg. bwd time: 5.2648 / Avg. batch time: 581.7428 (ms) / GPU bubble ratio: 73.22%
[rank1]:2025-11-06 13:42:10,081 - INFO - Avg. fwd time: 5.5374 / Avg. bwd time: 7.3270 / Avg. batch time: 570.3347 (ms) / GPU bubble ratio: 63.91%
[rank0]:2025-11-06 13:42:11,175 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1116  memory: 14.87GiB(31.30%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank0]:2025-11-06 13:42:11,175 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1116  tps: 6,698  tflops: 51.01  mfu: 15.30%
[rank0]:2025-11-06 13:42:11,175 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 13:42:11,187 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-06 13:42:11,195 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1116  memory: 12.63GiB(26.58%)  tps: 6,562  tflops: 49.97  mfu: 16.02%
[rank1]:2025-11-06 13:42:11,197 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1116  tps: 6,698  tflops: 51.01  mfu: 15.30%
[rank1]:2025-11-06 13:42:11,197 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 13:42:11,198 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 13:42:11,237 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1116  memory:  8.48GiB(17.86%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank2]:2025-11-06 13:42:11,237 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1116  tps: 6,697  tflops: 51.01  mfu: 15.29%
[rank2]:2025-11-06 13:42:11,237 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 13:42:11,238 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-06 13:42:14,144 - INFO -  step: 1200  loss:  0.2612  grad_norm:  0.1116  memory: 19.46GiB(40.96%)  tps: 6,526  tflops: 49.70  mfu: 15.93%
[rank3]:2025-11-06 13:42:14,153 - INFO -  final step: 1200  loss:  0.2612  grad_norm:  0.1116  tps: 6,696  tflops: 51.00  mfu: 15.35%
[rank3]:2025-11-06 13:42:14,153 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 13:42:14,154 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 13:42:16,238 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-06 13:42:16,319 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1342_stage0_final1200.svg
[rank1]:2025-11-06 13:42:16,319 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1342_stage1_final1200.svg
[rank2]:2025-11-06 13:42:16,318 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1342_stage2_final1200.svg
[rank3]:2025-11-06 13:42:16,503 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1342_real_final1200_rank3.svg
[rank3]:> Batch Time: 520.50 ms, GPU Bubble Ratio: 72.14%, 61.60%, 65.59%, 34.05%
[rank2]:2025-11-06 13:42:16,424 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank2_stage2.svg
[rank2]:	> Counts Sum: 364160, Total Sum: 645120 (56.45%), Ratio(%) per element: [56.47, 56.02, 56.25, 56.8, 56.25, 55.91, 56.36, 56.8, 56.69, 56.91, 56.25, 55.8, 56.02, 57.25, 56.8, 56.36, 56.58, 56.47]
[rank2]:2025-11-06 13:42:16,467 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank2/251106_1342_stage6_final1200.svg
[rank0]:2025-11-06 13:42:16,427 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank0_stage0.svg
[rank0]:	> Counts Sum: 450520, Total Sum: 680960 (66.16%), Ratio(%) per element: [65.95, 65.73, 65.84, 66.07, 67.07, 65.17, 66.62, 65.84, 65.06, 66.96, 66.07, 65.95, 66.29, 66.4, 66.18, 65.84, 66.4, 67.74, 65.73]
[rank0]:2025-11-06 13:42:16,469 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank0/251106_1342_stage4_final1200.svg
[rank1]:2025-11-06 13:42:16,453 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank1_stage1.svg
[rank1]:	> Counts Sum: 488160, Total Sum: 967680 (50.45%), Ratio(%) per element: [50.44, 50.44, 49.88, 50.78, 50.33, 50.33, 50.55, 51.22, 50.66, 50.66, 50.78, 50.66, 50.11, 50.22, 50.66, 50.55, 50.44, 50.44, 50.55, 50.55, 50.11, 50.22, 50.33, 50.11, 50.11, 50.55, 50.22]
[rank1]:2025-11-06 13:42:16,497 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank1/251106_1342_stage5_final1200.svg
[rank2]:2025-11-06 13:42:16,566 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank2_stage6.svg
[rank2]:	> Counts Sum: 556560, Total Sum: 645120 (86.27%), Ratio(%) per element: [86.27, 86.04, 86.04, 86.38, 86.16, 86.16, 86.04, 86.38, 86.71, 86.04, 86.27, 86.04, 86.38, 86.27, 86.16, 86.27, 86.38, 86.83]
[rank2]:2025-11-06 13:42:16,567 - INFO - Destroying the purge thread.
[rank2]:2025-11-06 13:42:16,604 - INFO - Process group destroyed
[rank0]:2025-11-06 13:42:16,567 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank0_stage4.svg
[rank0]:	> Counts Sum: 616400, Total Sum: 645120 (95.55%), Ratio(%) per element: [94.3, 94.75, 94.64, 95.2, 95.42, 95.42, 94.64, 98.21, 95.42, 95.75, 95.87, 94.97, 95.08, 95.31, 95.2, 94.97, 97.99, 96.65]
[rank0]:2025-11-06 13:42:16,567 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-06 13:42:16,599 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank1_stage5.svg
[rank1]:	> Counts Sum: 556560, Total Sum: 645120 (86.27%), Ratio(%) per element: [86.16, 86.38, 86.38, 86.16, 86.16, 86.04, 86.38, 86.71, 86.38, 86.27, 86.38, 86.04, 86.49, 86.16, 86.04, 85.93, 86.49, 86.27]
[rank1]:2025-11-06 13:42:16,599 - INFO - Destroying the purge thread.
[rank1]:2025-11-06 13:42:16,635 - INFO - Process group destroyed
[rank3]:2025-11-06 13:42:16,742 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/pipeline_schedule/251106_1342_thry_final1200_rank3.svg
[rank3]:> Batch Time: 317.41 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-06 13:42:16,788 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1342_stage3_final1200.svg
[rank3]:2025-11-06 13:42:16,895 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank3_stage3.svg
[rank3]:	> Counts Sum: 201400, Total Sum: 645120 (31.22%), Ratio(%) per element: [30.69, 30.91, 30.46, 30.58, 30.13, 30.8, 30.58, 35.37, 30.58, 31.47, 30.13, 30.58, 30.58, 30.91, 30.24, 30.58, 36.16, 31.13]
[rank3]:2025-11-06 13:42:16,937 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/freeze_ratio_history/rank3/251106_1342_stage7_final1200.svg
[rank3]:2025-11-06 13:42:17,016 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/frozen_params_histogram/251106_1342_rank3_stage7.svg
[rank3]:	> Counts Sum: 122560, Total Sum: 394240 (31.09%), Ratio(%) per element: [28.01, 27.34, 28.12, 28.12, 28.12, 28.57, 28.57, 36.71, 39.95, 40.73, 27.67]
[rank3]:2025-11-06 13:42:17,017 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.44681
[rank3]:wandb:               final/avg_loss 0.26118
[rank3]:wandb:             final/avg_mfu(%) 15.35129
[rank3]:wandb:             final/avg_tflops 50.99865
[rank3]:wandb:    final/avg_throughput(tps) 6696.06468
[rank3]:wandb:              final/grad_norm 0.11157
[rank3]:wandb:               final/max_loss 0.26118
[rank3]:wandb:                    grad_norm 0.11157
[rank3]:wandb: loss_metrics/global_avg_loss 0.26118
[rank3]:wandb: loss_metrics/global_max_loss 0.26118
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/m5dohwod
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1/20251106-1251/wandb/run-20251106_125114-m5dohwod/logs
[rank3]:2025-11-06 13:42:18,114 - INFO - Process group destroyed
[rank0]:2025-11-06 13:42:18,568 - INFO - Training completed
[rank0]:2025-11-06 13:42:18,568 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 13:42:18,623 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: monitoring steps = 50 -> 80"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_Interleaved1F1B_timelyapf_th0.1_m80_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.1
[rank3]:		- percentile: 70
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
