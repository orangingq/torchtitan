
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 05. (ìˆ˜) 23:41:37 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_GPipe_auto_th0.03_p85.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.03 --freezing.percentile=85
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-05 23:41:43,848 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 23:41:43,878 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-11-05 23:41:43,867 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-05 23:41:43,878 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 23:41:44,210 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 23:41:44,226 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 23:41:44,228 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 23:41:44,213 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 23:41:44,216 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-05 23:41:44,222 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-05 23:41:44,224 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-05 23:41:44,193 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-05 23:41:44,196 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 23:41:44,665 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-05 23:41:45,123 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-11-05 23:41:48,304 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 23:41:48,343 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 23:41:48,305 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-05 23:41:48,386 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-05 23:41:48,424 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 23:41:48,451 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-05 23:41:48,451 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-05 23:41:48,371 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-05 23:41:48,372 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-05 23:41:48,456 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 23:41:48,544 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 23:41:48,544 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-05 23:41:48,545 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-05 23:41:48,495 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 23:41:48,497 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-05 23:41:48,522 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-05 23:41:48,522 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-05 23:41:48,625 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 23:41:48,626 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-05 23:41:48,626 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-05 23:41:48,697 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 23:41:48,697 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 23:41:48,698 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run tgppw2z4
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1_th0.03_p85/20251105-2341/wandb/run-20251105_234149-tgppw2z4
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_GPipe_auto_dm1_th0.03_p85
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/tgppw2z4
[rank3]:2025-11-05 23:41:50,063 - INFO - WandB logging enabled
[rank3]:2025-11-05 23:41:50,064 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-05 23:41:50,102 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 23:41:50,128 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-05 23:41:50,129 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-05 23:41:50,312 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-05 23:41:50,312 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 23:41:50,312 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_GPipe_auto_dm1_th0.03_p85
[rank0]:2025-11-05 23:41:50,312 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-05 23:41:50,301 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 23:41:50,312 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-05 23:41:50,312 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-11-05 23:41:50,302 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-05 23:41:50,302 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-05 23:41:50,311 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 23:41:52,560 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-05 23:41:52,560 - INFO - Finished loading the checkpoint in 2.25 seconds.
[rank0]:2025-11-05 23:41:52,560 - INFO - Training starts at step 1
[rank3]:2025-11-05 23:41:55,666 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8856  memory: 24.19GiB(50.91%)  tps: 2,946  tflops: 22.44  mfu: 7.19%
[rank3]:2025-11-05 23:41:55,667 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-05 23:41:55,656 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8856  memory:  9.99GiB(21.03%)  tps: 2,241  tflops: 17.07  mfu: 5.47%
[rank2]:2025-11-05 23:41:55,656 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-05 23:41:55,660 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8856  memory: 12.38GiB(26.05%)  tps: 2,264  tflops: 17.25  mfu: 5.53%
[rank1]:2025-11-05 23:41:55,660 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 23:41:55,698 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8856  memory: 12.80GiB(26.95%)  tps: 2,275  tflops: 17.33  mfu: 5.55%
[rank0]:2025-11-05 23:41:55,698 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 23:43:57,287 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:43:59,525 - INFO - Avg. fwd time: 11.2163 / Avg. bwd time: 44.3396 / Avg. batch time: 504.3303 (ms) / GPU bubble ratio: 11.87%
[rank1]:2025-11-05 23:43:59,637 - INFO - Avg. fwd time: 9.0443 / Avg. bwd time: 23.8520 / Avg. batch time: 575.5269 (ms) / GPU bubble ratio: 54.27%
[rank2]:2025-11-05 23:43:59,598 - INFO - Avg. fwd time: 7.1194 / Avg. bwd time: 18.7553 / Avg. batch time: 536.2190 (ms) / GPU bubble ratio: 61.40%
[rank0]:2025-11-05 23:43:59,644 - INFO - Avg. fwd time: 7.8207 / Avg. bwd time: 23.3559 / Avg. batch time: 612.5553 (ms) / GPU bubble ratio: 59.28%
[rank3]:2025-11-05 23:43:59,828 - INFO -  step: 50  loss:  9.2117  grad_norm: 15.2657  memory: 26.98GiB(56.79%)  tps: 6,466  tflops: 49.25  mfu: 15.78%
[rank1]:2025-11-05 23:43:59,819 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.2657  memory: 14.64GiB(30.82%)  tps: 6,466  tflops: 49.25  mfu: 15.78%
[rank2]:2025-11-05 23:43:59,816 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.2657  memory: 11.81GiB(24.85%)  tps: 6,466  tflops: 49.25  mfu: 15.78%
[rank0]:2025-11-05 23:43:59,830 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.2657  memory: 16.57GiB(34.88%)  tps: 6,467  tflops: 49.26  mfu: 15.79%
[rank1]:2025-11-05 23:44:25,403 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-05 23:44:25,403 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-05 23:44:25,403 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-05 23:44:25,407 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-05 23:44:50,876 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1375e+01
[rank1]:2025-11-05 23:44:50,868 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4827e+00
[rank2]:2025-11-05 23:44:50,864 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.2825e+00
[rank0]:2025-11-05 23:44:50,880 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.4277e+01
[rank3]:2025-11-05 23:45:14,295 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0939e+00
[rank1]:2025-11-05 23:45:14,295 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8524e+00
[rank0]:2025-11-05 23:45:14,302 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.9234e+00
[rank2]:2025-11-05 23:45:14,291 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.1495e+00
[rank1]:2025-11-05 23:45:39,711 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.0550e+00
[rank3]:2025-11-05 23:45:39,718 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5226e+01
[rank0]:2025-11-05 23:45:39,722 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.3817e+01
[rank2]:2025-11-05 23:45:39,707 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1110e+00
[rank0]:2025-11-05 23:46:00,340 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:46:02,351 - INFO - Avg. fwd time: 11.3548 / Avg. bwd time: 43.4386 / Avg. batch time: 498.1290 (ms) / GPU bubble ratio: 12.00%
[rank2]:2025-11-05 23:46:02,411 - INFO - Avg. fwd time: 7.2018 / Avg. bwd time: 18.2166 / Avg. batch time: 528.9947 (ms) / GPU bubble ratio: 61.56%
[rank1]:2025-11-05 23:46:02,505 - INFO - Avg. fwd time: 9.1047 / Avg. bwd time: 23.5582 / Avg. batch time: 567.5508 (ms) / GPU bubble ratio: 53.96%
[rank0]:2025-11-05 23:46:02,489 - INFO - Avg. fwd time: 7.8611 / Avg. bwd time: 22.9356 / Avg. batch time: 603.6938 (ms) / GPU bubble ratio: 59.19%
[rank1]:2025-11-05 23:46:02,675 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4253e+00
[rank1]:2025-11-05 23:46:02,676 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.1713  memory: 14.64GiB(30.82%)  tps: 6,668  tflops: 50.78  mfu: 16.28%
[rank3]:2025-11-05 23:46:02,683 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6284e+00
[rank3]:2025-11-05 23:46:02,686 - INFO -  step: 100  loss:  3.0290  grad_norm: 22.1713  memory: 28.29GiB(59.55%)  tps: 6,668  tflops: 50.78  mfu: 16.28%
[rank0]:2025-11-05 23:46:02,691 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6047e+00
[rank0]:2025-11-05 23:46:02,691 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.1713  memory: 16.57GiB(34.88%)  tps: 6,668  tflops: 50.78  mfu: 16.28%
[rank2]:2025-11-05 23:46:02,667 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0106e+00
[rank2]:2025-11-05 23:46:02,668 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.1713  memory: 11.83GiB(24.89%)  tps: 6,668  tflops: 50.79  mfu: 16.28%
[rank1]:2025-11-05 23:46:02,764 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251105_2346_stage1_step100.svg
[rank0]:2025-11-05 23:46:02,760 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251105_2346_stage0_step100.svg
[rank2]:2025-11-05 23:46:02,762 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251105_2346_stage2_step100.svg
[rank3]:2025-11-05 23:46:02,878 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251105_2346_real_step100_rank3.svg
[rank3]:> Batch Time: 561.16 ms, GPU Bubble Ratio: 58.47%, 58.88%, 72.59%, 26.72%
[rank3]:2025-11-05 23:46:02,923 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251105_2346_stage3_step100.svg
[rank1]:2025-11-05 23:46:28,381 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7998e+00
[rank0]:2025-11-05 23:46:28,393 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.9991e+01
[rank3]:2025-11-05 23:46:28,388 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7386e+00
[rank2]:2025-11-05 23:46:28,377 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5092e+00
[rank1]:2025-11-05 23:46:51,244 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.0357e+00
[rank3]:2025-11-05 23:46:51,255 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7319e+00
[rank0]:2025-11-05 23:46:51,263 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0220e+01
[rank2]:2025-11-05 23:46:51,240 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.3207e+00
[rank2]:2025-11-05 23:47:16,426 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2761e+01
[rank3]:2025-11-05 23:47:16,438 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4019e+00
[rank1]:2025-11-05 23:47:16,431 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0659e+01
[rank0]:2025-11-05 23:47:16,434 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5347e+00
[rank3]:2025-11-05 23:47:38,901 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5903e+00
[rank0]:2025-11-05 23:47:38,901 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.8248e+00
[rank1]:2025-11-05 23:47:38,886 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.0449e+00
[rank2]:2025-11-05 23:47:38,886 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6808e+00
[rank0]:2025-11-05 23:48:01,640 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 23:48:04,091 - INFO - Avg. fwd time: 7.3414 / Avg. bwd time: 17.2664 / Avg. batch time: 525.3144 (ms) / GPU bubble ratio: 62.52%
[rank3]:2025-11-05 23:48:04,065 - INFO - Avg. fwd time: 11.4195 / Avg. bwd time: 43.0308 / Avg. batch time: 495.3549 (ms) / GPU bubble ratio: 12.06%
[rank1]:2025-11-05 23:48:04,121 - INFO - Avg. fwd time: 9.2720 / Avg. bwd time: 22.3706 / Avg. batch time: 562.4991 (ms) / GPU bubble ratio: 55.00%
[rank0]:2025-11-05 23:48:04,145 - INFO - Avg. fwd time: 8.0331 / Avg. bwd time: 21.6925 / Avg. batch time: 597.2597 (ms) / GPU bubble ratio: 60.18%
[rank2]:2025-11-05 23:48:04,167 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5156e+00
[rank2]:2025-11-05 23:48:04,168 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.4251  memory: 11.83GiB(24.89%)  tps: 6,742  tflops: 51.35  mfu: 16.46%
[rank3]:2025-11-05 23:48:04,179 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6619e+00
[rank3]:2025-11-05 23:48:04,182 - INFO -  step: 150  loss:  0.4947  grad_norm:  5.4251  memory: 28.29GiB(59.55%)  tps: 6,743  tflops: 51.35  mfu: 16.46%
[rank1]:2025-11-05 23:48:04,172 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5210e+00
[rank1]:2025-11-05 23:48:04,172 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.4251  memory: 14.66GiB(30.86%)  tps: 6,743  tflops: 51.35  mfu: 16.46%
[rank0]:2025-11-05 23:48:04,175 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3927e+00
[rank0]:2025-11-05 23:48:04,175 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.4251  memory: 16.57GiB(34.88%)  tps: 6,743  tflops: 51.36  mfu: 16.46%
[rank3]:2025-11-05 23:48:26,674 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.9088e+00
[rank1]:2025-11-05 23:48:26,658 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.1000e+00
[rank0]:2025-11-05 23:48:26,674 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1888e+01
[rank2]:2025-11-05 23:48:26,658 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.3773e+00
[rank0]:2025-11-05 23:48:51,736 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1255e+00
[rank1]:2025-11-05 23:48:51,737 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9706e+00
[rank2]:2025-11-05 23:48:51,732 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1143e+00
[rank3]:2025-11-05 23:48:51,744 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.3777e+00
[rank1]:2025-11-05 23:49:14,269 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9014e-01
[rank2]:2025-11-05 23:49:14,269 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.8453e-01
[rank3]:2025-11-05 23:49:14,284 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.6131e-01
[rank0]:2025-11-05 23:49:14,284 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3071e-01
[rank3]:2025-11-05 23:49:39,450 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4712e-01
[rank1]:2025-11-05 23:49:39,443 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6327e-01
[rank0]:2025-11-05 23:49:39,442 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3576e+00
[rank2]:2025-11-05 23:49:39,439 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4573e-01
[rank0]:2025-11-05 23:49:59,695 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:50:01,646 - INFO - Avg. fwd time: 11.4730 / Avg. bwd time: 42.7154 / Avg. batch time: 493.2418 (ms) / GPU bubble ratio: 12.11%
[rank0]:2025-11-05 23:50:01,732 - INFO - Avg. fwd time: 8.2279 / Avg. bwd time: 20.3175 / Avg. batch time: 591.8634 (ms) / GPU bubble ratio: 61.42%
[rank2]:2025-11-05 23:50:01,704 - INFO - Avg. fwd time: 7.4384 / Avg. bwd time: 16.6467 / Avg. batch time: 522.4482 (ms) / GPU bubble ratio: 63.12%
[rank1]:2025-11-05 23:50:01,754 - INFO - Avg. fwd time: 9.4168 / Avg. bwd time: 21.3833 / Avg. batch time: 558.5478 (ms) / GPU bubble ratio: 55.89%
[rank2]:2025-11-05 23:50:01,940 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.6868e-01
[rank2]:2025-11-05 23:50:01,941 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2900  memory: 11.83GiB(24.89%)  tps: 6,956  tflops: 52.98  mfu: 16.98%
[rank3]:2025-11-05 23:50:01,956 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.4250e-01
[rank3]:2025-11-05 23:50:01,959 - INFO -  step: 200  loss:  0.2471  grad_norm:  0.2900  memory: 28.29GiB(59.55%)  tps: 6,956  tflops: 52.98  mfu: 16.98%
[rank1]:2025-11-05 23:50:01,940 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1357e-01
[rank1]:2025-11-05 23:50:01,941 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2900  memory: 14.66GiB(30.86%)  tps: 6,956  tflops: 52.98  mfu: 16.98%
[rank1]:2025-11-05 23:50:02,013 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251105_2350_stage1_step200.svg
[rank0]:2025-11-05 23:50:01,956 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5835e+00
[rank0]:2025-11-05 23:50:01,956 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2900  memory: 16.57GiB(34.88%)  tps: 6,955  tflops: 52.97  mfu: 16.98%
[rank0]:2025-11-05 23:50:02,012 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251105_2350_stage0_step200.svg
[rank2]:2025-11-05 23:50:02,011 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251105_2350_stage2_step200.svg
[rank3]:2025-11-05 23:50:02,107 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251105_2350_real_step200_rank3.svg
[rank3]:> Batch Time: 606.34 ms, GPU Bubble Ratio: 67.34%, 56.70%, 65.84%, 27.23%
[rank3]:2025-11-05 23:50:02,152 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251105_2350_stage3_step200.svg
[rank3]:2025-11-05 23:50:27,309 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7863e-01
[rank1]:2025-11-05 23:50:27,302 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.8547e-02
[rank0]:2025-11-05 23:50:27,301 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0431e+00
[rank2]:2025-11-05 23:50:27,297 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9471e-01
[rank3]:2025-11-05 23:50:49,861 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3344e-01
[rank1]:2025-11-05 23:50:49,845 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.8175e-01
[rank0]:2025-11-05 23:50:49,861 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2988e-01
[rank2]:2025-11-05 23:50:49,845 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8392e-01
[rank1]:2025-11-05 23:51:15,032 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5429e-01
[rank0]:2025-11-05 23:51:15,032 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2216e+00
[rank2]:2025-11-05 23:51:15,028 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1132e-01
[rank3]:2025-11-05 23:51:15,040 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9525e-01
[rank1]:2025-11-05 23:51:37,549 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0462e+00
[rank0]:2025-11-05 23:51:37,564 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1961e+00
[rank2]:2025-11-05 23:51:37,549 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.2436e-01
[rank3]:2025-11-05 23:51:37,564 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.1927e-01
[rank0]:2025-11-05 23:52:00,218 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:52:02,429 - INFO - Avg. fwd time: 11.5096 / Avg. bwd time: 42.6123 / Avg. batch time: 492.7028 (ms) / GPU bubble ratio: 12.12%
[rank0]:2025-11-05 23:52:02,463 - INFO - Avg. fwd time: 8.3659 / Avg. bwd time: 19.3454 / Avg. batch time: 589.4416 (ms) / GPU bubble ratio: 62.39%
[rank2]:2025-11-05 23:52:02,501 - INFO - Avg. fwd time: 7.4887 / Avg. bwd time: 16.3421 / Avg. batch time: 521.6225 (ms) / GPU bubble ratio: 63.45%
[rank1]:2025-11-05 23:52:02,541 - INFO - Avg. fwd time: 9.4986 / Avg. bwd time: 20.8658 / Avg. batch time: 557.1468 (ms) / GPU bubble ratio: 56.40%
[rank3]:2025-11-05 23:52:02,725 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7827e-01
[rank3]:2025-11-05 23:52:02,728 - INFO -  step: 250  loss:  0.2559  grad_norm:  0.3379  memory: 28.29GiB(59.55%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank1]:2025-11-05 23:52:02,718 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2753e-01
[rank1]:2025-11-05 23:52:02,718 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3379  memory: 14.66GiB(30.86%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank0]:2025-11-05 23:52:02,717 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7874e-01
[rank0]:2025-11-05 23:52:02,718 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3379  memory: 16.57GiB(34.88%)  tps: 6,784  tflops: 51.67  mfu: 16.56%
[rank2]:2025-11-05 23:52:02,714 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7307e-01
[rank2]:2025-11-05 23:52:02,714 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3379  memory: 11.83GiB(24.89%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank2]:2025-11-05 23:52:25,231 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0020e-01
[rank1]:2025-11-05 23:52:25,231 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4134e-01
[rank3]:2025-11-05 23:52:25,247 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.7568e-01
[rank0]:2025-11-05 23:52:25,247 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4919e-01
[rank1]:2025-11-05 23:52:50,435 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4256e-01
[rank3]:2025-11-05 23:52:50,442 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1372e-01
[rank0]:2025-11-05 23:52:50,434 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1128e+00
[rank2]:2025-11-05 23:52:50,430 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7565e-01
[rank1]:2025-11-05 23:53:12,948 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0465e+00
[rank3]:2025-11-05 23:53:12,963 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1505e+00
[rank0]:2025-11-05 23:53:12,963 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0029e+00
[rank2]:2025-11-05 23:53:12,948 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2974e+00
[rank3]:2025-11-05 23:53:38,113 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4738e+00
[rank0]:2025-11-05 23:53:38,106 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8670e+00
[rank2]:2025-11-05 23:53:38,102 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3073e+00
[rank1]:2025-11-05 23:53:38,106 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.6030e-01
[rank0]:2025-11-05 23:53:58,360 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-05 23:54:00,611 - INFO - Avg. fwd time: 9.5744 / Avg. bwd time: 20.3460 / Avg. batch time: 554.9946 (ms) / GPU bubble ratio: 56.87%
[rank0]:2025-11-05 23:54:00,633 - INFO - Avg. fwd time: 8.4578 / Avg. bwd time: 18.7121 / Avg. batch time: 586.6283 (ms) / GPU bubble ratio: 62.95%
[rank3]:2025-11-05 23:54:00,573 - INFO - Avg. fwd time: 11.5399 / Avg. bwd time: 42.4367 / Avg. batch time: 491.5278 (ms) / GPU bubble ratio: 12.15%
[rank2]:2025-11-05 23:54:00,591 - INFO - Avg. fwd time: 7.5406 / Avg. bwd time: 16.0092 / Avg. batch time: 520.0341 (ms) / GPU bubble ratio: 63.77%
[rank2]:2025-11-05 23:54:00,644 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9514e-01
[rank2]:2025-11-05 23:54:00,644 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1563  memory: 11.83GiB(24.89%)  tps: 6,947  tflops: 52.91  mfu: 16.96%
[rank1]:2025-11-05 23:54:00,644 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.1510e-01
[rank1]:2025-11-05 23:54:00,644 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1563  memory: 14.66GiB(30.86%)  tps: 6,947  tflops: 52.91  mfu: 16.96%
[rank1]:2025-11-05 23:54:00,716 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251105_2354_stage1_step300.svg
[rank0]:2025-11-05 23:54:00,659 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.9727e-01
[rank0]:2025-11-05 23:54:00,660 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1563  memory: 16.57GiB(34.88%)  tps: 6,946  tflops: 52.90  mfu: 16.96%
[rank0]:2025-11-05 23:54:00,721 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251105_2354_stage0_step300.svg
[rank3]:2025-11-05 23:54:00,659 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.3672e-01
[rank3]:2025-11-05 23:54:00,662 - INFO -  step: 300  loss:  0.2352  grad_norm:  0.1563  memory: 28.29GiB(59.55%)  tps: 6,946  tflops: 52.91  mfu: 16.96%
[rank2]:2025-11-05 23:54:00,715 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251105_2354_stage2_step300.svg
[rank3]:2025-11-05 23:54:00,810 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251105_2354_real_step300_rank3.svg
[rank3]:> Batch Time: 546.33 ms, GPU Bubble Ratio: 63.76%, 65.10%, 71.71%, 25.05%
[rank3]:2025-11-05 23:54:00,853 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251105_2354_stage3_step300.svg
[rank2]:2025-11-05 23:54:25,904 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8319e-01
[rank1]:2025-11-05 23:54:25,908 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.7353e-01
[rank0]:2025-11-05 23:54:25,907 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5102e+00
[rank3]:2025-11-05 23:54:25,915 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9426e-01
[rank1]:2025-11-05 23:54:48,368 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1440e+00
[rank0]:2025-11-05 23:54:48,384 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5489e+00
[rank3]:2025-11-05 23:54:48,384 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.6505e-01
[rank2]:2025-11-05 23:54:48,368 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8829e-01
[rank3]:2025-11-05 23:55:13,453 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.3232e-01
[rank2]:2025-11-05 23:55:13,441 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9276e-01
[rank1]:2025-11-05 23:55:13,446 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2899e-01
[rank0]:2025-11-05 23:55:13,445 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3295e+00
[rank0]:2025-11-05 23:55:35,929 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3561e+00
[rank1]:2025-11-05 23:55:35,914 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1841e-01
[rank3]:2025-11-05 23:55:35,929 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1208e-01
[rank2]:2025-11-05 23:55:35,913 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.0460e-01
[rank0]:2025-11-05 23:55:58,447 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:56:00,674 - INFO - Avg. fwd time: 11.5413 / Avg. bwd time: 42.4158 / Avg. batch time: 491.3641 (ms) / GPU bubble ratio: 12.15%
[rank0]:2025-11-05 23:56:00,708 - INFO - Avg. fwd time: 8.5136 / Avg. bwd time: 18.3219 / Avg. batch time: 585.8287 (ms) / GPU bubble ratio: 63.35%
[rank1]:2025-11-05 23:56:00,785 - INFO - Avg. fwd time: 9.5936 / Avg. bwd time: 20.2017 / Avg. batch time: 554.6076 (ms) / GPU bubble ratio: 57.02%
[rank2]:2025-11-05 23:56:00,746 - INFO - Avg. fwd time: 7.5521 / Avg. bwd time: 15.9343 / Avg. batch time: 519.8165 (ms) / GPU bubble ratio: 63.85%
[rank0]:2025-11-05 23:56:00,961 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0617e-01
[rank0]:2025-11-05 23:56:00,961 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.2093  memory: 16.57GiB(34.88%)  tps: 6,810  tflops: 51.86  mfu: 16.62%
[rank1]:2025-11-05 23:56:00,961 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3471e-01
[rank1]:2025-11-05 23:56:00,962 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.2093  memory: 14.66GiB(30.86%)  tps: 6,809  tflops: 51.86  mfu: 16.62%
[rank3]:2025-11-05 23:56:00,969 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9523e-01
[rank3]:2025-11-05 23:56:00,972 - INFO -  step: 350  loss:  0.2442  grad_norm:  0.2093  memory: 28.29GiB(59.55%)  tps: 6,809  tflops: 51.86  mfu: 16.62%
[rank2]:2025-11-05 23:56:00,957 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5755e-01
[rank2]:2025-11-05 23:56:00,958 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.2093  memory: 11.83GiB(24.89%)  tps: 6,809  tflops: 51.86  mfu: 16.62%
[rank0]:2025-11-05 23:56:23,404 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8842e+00
[rank1]:2025-11-05 23:56:23,389 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.9849e-01
[rank3]:2025-11-05 23:56:23,407 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.3031e-01
[rank2]:2025-11-05 23:56:23,389 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.1127e-01
[rank2]:2025-11-05 23:56:48,380 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0406e+00
[rank0]:2025-11-05 23:56:48,384 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7282e+00
[rank1]:2025-11-05 23:56:48,385 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1484e+00
[rank3]:2025-11-05 23:56:48,392 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3157e+00
[rank0]:2025-11-05 23:57:10,838 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9415e-01
[rank1]:2025-11-05 23:57:10,823 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.8737e-01
[rank2]:2025-11-05 23:57:10,822 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4726e-01
[rank3]:2025-11-05 23:57:10,838 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.4029e-01
[rank0]:2025-11-05 23:57:35,861 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9041e+00
[rank1]:2025-11-05 23:57:35,862 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0960e-01
[rank2]:2025-11-05 23:57:35,857 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6574e-01
[rank3]:2025-11-05 23:57:35,869 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5667e-01
[rank0]:2025-11-05 23:57:56,003 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:57:57,956 - INFO - Avg. fwd time: 11.5449 / Avg. bwd time: 42.3129 / Avg. batch time: 490.5588 (ms) / GPU bubble ratio: 12.17%
[rank0]:2025-11-05 23:57:58,040 - INFO - Avg. fwd time: 8.5614 / Avg. bwd time: 17.9764 / Avg. batch time: 584.1778 (ms) / GPU bubble ratio: 63.66%
[rank1]:2025-11-05 23:57:58,063 - INFO - Avg. fwd time: 9.6249 / Avg. bwd time: 19.9582 / Avg. batch time: 553.3215 (ms) / GPU bubble ratio: 57.23%
[rank2]:2025-11-05 23:57:58,012 - INFO - Avg. fwd time: 7.5735 / Avg. bwd time: 15.7815 / Avg. batch time: 518.7992 (ms) / GPU bubble ratio: 63.99%
[rank1]:2025-11-05 23:57:58,248 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2237e+00
[rank1]:2025-11-05 23:57:58,248 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2763  memory: 14.66GiB(30.86%)  tps: 6,985  tflops: 53.20  mfu: 17.05%
[rank2]:2025-11-05 23:57:58,247 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9749e+00
[rank2]:2025-11-05 23:57:58,248 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2763  memory: 11.83GiB(24.89%)  tps: 6,984  tflops: 53.19  mfu: 17.05%
[rank3]:2025-11-05 23:57:58,263 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5876e+00
[rank3]:2025-11-05 23:57:58,266 - INFO -  step: 400  loss:  0.2428  grad_norm:  0.2763  memory: 28.29GiB(59.55%)  tps: 6,984  tflops: 53.19  mfu: 17.05%
[rank0]:2025-11-05 23:57:58,263 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8376e+00
[rank0]:2025-11-05 23:57:58,263 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2763  memory: 16.57GiB(34.88%)  tps: 6,984  tflops: 53.19  mfu: 17.05%
[rank0]:2025-11-05 23:57:58,322 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251105_2357_stage0_step400.svg
[rank1]:2025-11-05 23:57:58,323 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251105_2357_stage1_step400.svg
[rank2]:2025-11-05 23:57:58,322 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251105_2357_stage2_step400.svg
[rank3]:2025-11-05 23:57:58,411 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251105_2357_real_step400_rank3.svg
[rank3]:> Batch Time: 544.81 ms, GPU Bubble Ratio: 63.69%, 65.11%, 71.68%, 24.59%
[rank3]:2025-11-05 23:57:58,458 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251105_2357_stage3_step400.svg
[rank3]:2025-11-05 23:58:11,311 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 23:58:11,564 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 23:58:11,548 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 23:58:11,522 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 23:58:23,392 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1178e+00
[rank1]:2025-11-05 23:58:23,393 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.5907e-01
[rank2]:2025-11-05 23:58:23,388 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6198e-01
[rank3]:2025-11-05 23:58:23,400 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4453e-01
[rank0]:2025-11-05 23:58:45,819 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6534e+00
[rank1]:2025-11-05 23:58:45,804 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5053e+00
[rank2]:2025-11-05 23:58:45,804 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.3952e-01
[rank3]:2025-11-05 23:58:45,819 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.4523e-01
[rank2]:2025-11-05 23:59:10,792 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5439e-01
[rank0]:2025-11-05 23:59:10,796 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3934e+00
[rank1]:2025-11-05 23:59:10,797 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0567e-01
[rank3]:2025-11-05 23:59:10,804 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.7727e-01
[rank2]:2025-11-05 23:59:33,157 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8513e+00
[rank0]:2025-11-05 23:59:33,172 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0101e+00
[rank1]:2025-11-05 23:59:33,157 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0019e+00
[rank3]:2025-11-05 23:59:33,173 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8149e+00
[rank0]:2025-11-05 23:59:55,594 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 23:59:58,026 - INFO - Avg. fwd time: 7.5763 / Avg. bwd time: 15.7515 / Avg. batch time: 518.5790 (ms) / GPU bubble ratio: 64.01%
[rank3]:2025-11-05 23:59:57,999 - INFO - Avg. fwd time: 11.5371 / Avg. bwd time: 42.2959 / Avg. batch time: 490.3517 (ms) / GPU bubble ratio: 12.17%
[rank2]:2025-11-05 23:59:58,101 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0216e-01
[rank2]:2025-11-05 23:59:58,102 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2047  memory: 11.83GiB(24.89%)  tps: 6,835  tflops: 52.06  mfu: 16.68%
[rank0]:2025-11-05 23:59:58,080 - INFO - Avg. fwd time: 8.5974 / Avg. bwd time: 17.7112 / Avg. batch time: 583.5954 (ms) / GPU bubble ratio: 63.94%
[rank0]:2025-11-05 23:59:58,105 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0291e+00
[rank0]:2025-11-05 23:59:58,105 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2047  memory: 16.57GiB(34.88%)  tps: 6,836  tflops: 52.06  mfu: 16.69%
[rank1]:2025-11-05 23:59:58,057 - INFO - Avg. fwd time: 9.6307 / Avg. bwd time: 19.8904 / Avg. batch time: 553.0180 (ms) / GPU bubble ratio: 57.29%
[rank1]:2025-11-05 23:59:58,106 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4190e-01
[rank1]:2025-11-05 23:59:58,106 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2047  memory: 14.66GiB(30.86%)  tps: 6,835  tflops: 52.05  mfu: 16.68%
[rank3]:2025-11-05 23:59:58,113 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1314e+00
[rank3]:2025-11-05 23:59:58,116 - INFO -  step: 450  loss:  0.2407  grad_norm:  0.2047  memory: 28.29GiB(59.55%)  tps: 6,835  tflops: 52.06  mfu: 16.69%
[rank0]:2025-11-06 00:00:20,557 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0143e+00
[rank2]:2025-11-06 00:00:20,542 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3550e+00
[rank1]:2025-11-06 00:00:20,542 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1315e+00
[rank3]:2025-11-06 00:00:20,558 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4446e+00
[rank0]:2025-11-06 00:00:45,548 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9218e+00
[rank2]:2025-11-06 00:00:45,545 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.5037e-01
[rank1]:2025-11-06 00:00:45,549 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6331e-01
[rank3]:2025-11-06 00:00:45,556 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2593e-01
[rank0]:2025-11-06 00:01:08,011 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0184e+00
[rank2]:2025-11-06 00:01:07,996 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1936e-01
[rank1]:2025-11-06 00:01:07,996 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0126e-01
[rank3]:2025-11-06 00:01:08,011 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7564e-01
[rank0]:2025-11-06 00:01:33,012 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2142e+00
[rank2]:2025-11-06 00:01:33,008 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7828e+00
[rank1]:2025-11-06 00:01:33,012 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2065e+00
[rank3]:2025-11-06 00:01:33,020 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8336e+00
[rank0]:2025-11-06 00:01:53,208 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:01:55,175 - INFO - Avg. fwd time: 11.5369 / Avg. bwd time: 42.2147 / Avg. batch time: 489.6951 (ms) / GPU bubble ratio: 12.19%
[rank0]:2025-11-06 00:01:55,263 - INFO - Avg. fwd time: 8.6238 / Avg. bwd time: 17.5289 / Avg. batch time: 582.4241 (ms) / GPU bubble ratio: 64.08%
[rank2]:2025-11-06 00:01:55,235 - INFO - Avg. fwd time: 7.5926 / Avg. bwd time: 15.6397 / Avg. batch time: 517.7748 (ms) / GPU bubble ratio: 64.10%
[rank1]:2025-11-06 00:01:55,288 - INFO - Avg. fwd time: 9.6545 / Avg. bwd time: 19.7207 / Avg. batch time: 552.0322 (ms) / GPU bubble ratio: 57.43%
[rank2]:2025-11-06 00:01:55,475 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6623e+00
[rank2]:2025-11-06 00:01:55,476 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2529  memory: 11.83GiB(24.89%)  tps: 6,979  tflops: 53.16  mfu: 17.04%
[rank1]:2025-11-06 00:01:55,475 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0581e+00
[rank1]:2025-11-06 00:01:55,476 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2529  memory: 14.66GiB(30.86%)  tps: 6,980  tflops: 53.16  mfu: 17.04%
[rank3]:2025-11-06 00:01:55,491 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8081e+00
[rank3]:2025-11-06 00:01:55,494 - INFO -  step: 500  loss:  0.2645  grad_norm:  0.2529  memory: 28.29GiB(59.55%)  tps: 6,979  tflops: 53.16  mfu: 17.04%
[rank0]:2025-11-06 00:01:55,491 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1282e+00
[rank0]:2025-11-06 00:01:55,491 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2529  memory: 16.57GiB(34.88%)  tps: 6,979  tflops: 53.15  mfu: 17.04%
[rank0]:2025-11-06 00:01:55,575 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0001_stage0_step500.svg
[rank2]:2025-11-06 00:01:55,573 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0001_stage2_step500.svg
[rank1]:2025-11-06 00:01:55,548 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0001_stage1_step500.svg
[rank3]:2025-11-06 00:01:55,644 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0001_real_step500_rank3.svg
[rank3]:> Batch Time: 602.83 ms, GPU Bubble Ratio: 67.17%, 56.51%, 65.78%, 27.07%
[rank3]:2025-11-06 00:01:55,687 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0001_stage3_step500.svg
[rank2]:2025-11-06 00:02:20,708 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8036e-01
[rank1]:2025-11-06 00:02:20,712 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.1525e-01
[rank3]:2025-11-06 00:02:20,719 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9814e-01
[rank0]:2025-11-06 00:02:20,712 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8557e+00
[rank2]:2025-11-06 00:02:43,140 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8135e+00
[rank1]:2025-11-06 00:02:43,140 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3102e+00
[rank3]:2025-11-06 00:02:43,155 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5356e+00
[rank0]:2025-11-06 00:02:43,155 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2668e+00
[rank2]:2025-11-06 00:03:08,282 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4998e-01
[rank1]:2025-11-06 00:03:08,286 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7895e-01
[rank3]:2025-11-06 00:03:08,293 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0118e-01
[rank0]:2025-11-06 00:03:08,285 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3855e-01
[rank0]:2025-11-06 00:03:30,796 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7041e+00
[rank2]:2025-11-06 00:03:30,781 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2134e+00
[rank1]:2025-11-06 00:03:30,780 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1312e+00
[rank3]:2025-11-06 00:03:30,796 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6340e+00
[rank0]:2025-11-06 00:03:53,462 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:03:55,700 - INFO - Avg. fwd time: 11.5350 / Avg. bwd time: 42.2040 / Avg. batch time: 489.5936 (ms) / GPU bubble ratio: 12.19%
[rank0]:2025-11-06 00:03:55,734 - INFO - Avg. fwd time: 8.6498 / Avg. bwd time: 17.3553 / Avg. batch time: 582.0226 (ms) / GPU bubble ratio: 64.26%
[rank2]:2025-11-06 00:03:55,771 - INFO - Avg. fwd time: 7.5997 / Avg. bwd time: 15.5941 / Avg. batch time: 517.6340 (ms) / GPU bubble ratio: 64.15%
[rank1]:2025-11-06 00:03:55,813 - INFO - Avg. fwd time: 9.6669 / Avg. bwd time: 19.6425 / Avg. batch time: 551.8073 (ms) / GPU bubble ratio: 57.51%
[rank0]:2025-11-06 00:03:55,988 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3300e+00
[rank0]:2025-11-06 00:03:55,988 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2749  memory: 16.57GiB(34.88%)  tps: 6,799  tflops: 51.78  mfu: 16.60%
[rank2]:2025-11-06 00:03:55,984 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2325e-01
[rank2]:2025-11-06 00:03:55,985 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2749  memory: 11.83GiB(24.89%)  tps: 6,798  tflops: 51.77  mfu: 16.59%
[rank1]:2025-11-06 00:03:55,989 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.1878e-01
[rank1]:2025-11-06 00:03:55,989 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2749  memory: 14.66GiB(30.86%)  tps: 6,798  tflops: 51.77  mfu: 16.59%
[rank3]:2025-11-06 00:03:55,996 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0587e+00
[rank3]:2025-11-06 00:03:55,999 - INFO -  step: 550  loss:  0.3045  grad_norm:  0.2749  memory: 28.29GiB(59.55%)  tps: 6,798  tflops: 51.78  mfu: 16.60%
[rank0]:2025-11-06 00:04:18,532 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2400e+00
[rank2]:2025-11-06 00:04:18,516 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.7914e-01
[rank1]:2025-11-06 00:04:18,516 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.8682e-01
[rank3]:2025-11-06 00:04:18,532 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1814e+00
[rank2]:2025-11-06 00:04:43,702 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0449e+00
[rank1]:2025-11-06 00:04:43,707 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.6722e-01
[rank3]:2025-11-06 00:04:43,714 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1648e+00
[rank0]:2025-11-06 00:04:43,706 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2524e+00
[rank0]:2025-11-06 00:05:06,293 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2479e+00
[rank2]:2025-11-06 00:05:06,279 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.1241e+00
[rank1]:2025-11-06 00:05:06,278 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4486e+00
[rank3]:2025-11-06 00:05:06,293 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8015e+00
[rank0]:2025-11-06 00:05:31,502 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9673e+00
[rank2]:2025-11-06 00:05:31,499 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0892e+00
[rank1]:2025-11-06 00:05:31,503 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4914e-01
[rank3]:2025-11-06 00:05:31,510 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6302e+00
[rank0]:2025-11-06 00:05:51,797 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:05:54,012 - INFO - Avg. fwd time: 11.5436 / Avg. bwd time: 42.1626 / Avg. batch time: 489.3299 (ms) / GPU bubble ratio: 12.20%
[rank0]:2025-11-06 00:05:54,076 - INFO - Avg. fwd time: 8.6703 / Avg. bwd time: 17.2128 / Avg. batch time: 581.3271 (ms) / GPU bubble ratio: 64.38%
[rank2]:2025-11-06 00:05:54,032 - INFO - Avg. fwd time: 7.6162 / Avg. bwd time: 15.4913 / Avg. batch time: 517.2400 (ms) / GPU bubble ratio: 64.26%
[rank2]:2025-11-06 00:05:54,086 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5042e+00
[rank2]:2025-11-06 00:05:54,087 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2102  memory: 11.83GiB(24.89%)  tps: 6,936  tflops: 52.83  mfu: 16.93%
[rank1]:2025-11-06 00:05:54,053 - INFO - Avg. fwd time: 9.6904 / Avg. bwd time: 19.4886 / Avg. batch time: 551.2551 (ms) / GPU bubble ratio: 57.65%
[rank1]:2025-11-06 00:05:54,086 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6923e+00
[rank1]:2025-11-06 00:05:54,087 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2102  memory: 14.66GiB(30.86%)  tps: 6,937  tflops: 52.83  mfu: 16.93%
[rank3]:2025-11-06 00:05:54,102 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5252e+00
[rank3]:2025-11-06 00:05:54,105 - INFO -  step: 600  loss:  0.2317  grad_norm:  0.2102  memory: 28.29GiB(59.55%)  tps: 6,936  tflops: 52.83  mfu: 16.93%
[rank0]:2025-11-06 00:05:54,102 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4826e+00
[rank0]:2025-11-06 00:05:54,102 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2102  memory: 16.57GiB(34.88%)  tps: 6,936  tflops: 52.82  mfu: 16.93%
[rank0]:2025-11-06 00:05:54,160 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0005_stage0_step600.svg
[rank2]:2025-11-06 00:05:54,160 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0005_stage2_step600.svg
[rank1]:2025-11-06 00:05:54,159 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0005_stage1_step600.svg
[rank3]:2025-11-06 00:05:54,254 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0005_real_step600_rank3.svg
[rank3]:> Batch Time: 546.88 ms, GPU Bubble Ratio: 63.80%, 65.14%, 71.73%, 24.92%
[rank3]:2025-11-06 00:05:54,303 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0005_stage3_step600.svg
[rank1]:2025-11-06 00:06:19,448 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6843e-01
[rank3]:2025-11-06 00:06:19,454 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5040e-01
[rank0]:2025-11-06 00:06:19,447 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.4585e-01
[rank2]:2025-11-06 00:06:19,443 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2265e-01
[rank0]:2025-11-06 00:06:42,022 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7258e+00
[rank2]:2025-11-06 00:06:42,007 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4482e-01
[rank1]:2025-11-06 00:06:42,007 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6873e+00
[rank3]:2025-11-06 00:06:42,022 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7628e-01
[rank2]:2025-11-06 00:07:07,300 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9540e-01
[rank1]:2025-11-06 00:07:07,304 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9667e-01
[rank3]:2025-11-06 00:07:07,311 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1012e-01
[rank0]:2025-11-06 00:07:07,303 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.9351e-01
[rank3]:2025-11-06 00:07:29,866 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5936e+00
[rank0]:2025-11-06 00:07:29,866 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2079e+00
[rank2]:2025-11-06 00:07:29,851 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1559e+00
[rank1]:2025-11-06 00:07:29,851 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.3223e-01
[rank0]:2025-11-06 00:07:52,574 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:07:54,794 - INFO - Avg. fwd time: 11.5451 / Avg. bwd time: 42.1921 / Avg. batch time: 489.5783 (ms) / GPU bubble ratio: 12.19%
[rank0]:2025-11-06 00:07:54,827 - INFO - Avg. fwd time: 8.6865 / Avg. bwd time: 17.1100 / Avg. batch time: 581.4785 (ms) / GPU bubble ratio: 64.51%
[rank2]:2025-11-06 00:07:54,866 - INFO - Avg. fwd time: 7.6181 / Avg. bwd time: 15.4881 / Avg. batch time: 517.5089 (ms) / GPU bubble ratio: 64.28%
[rank1]:2025-11-06 00:07:54,906 - INFO - Avg. fwd time: 9.6945 / Avg. bwd time: 19.4749 / Avg. batch time: 551.5117 (ms) / GPU bubble ratio: 57.69%
[rank1]:2025-11-06 00:07:55,080 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4103e-01
[rank1]:2025-11-06 00:07:55,081 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2058  memory: 14.66GiB(30.86%)  tps: 6,771  tflops: 51.57  mfu: 16.53%
[rank3]:2025-11-06 00:07:55,087 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8827e-01
[rank3]:2025-11-06 00:07:55,091 - INFO -  step: 650  loss:  0.2362  grad_norm:  0.2058  memory: 28.29GiB(59.55%)  tps: 6,771  tflops: 51.57  mfu: 16.53%
[rank0]:2025-11-06 00:07:55,079 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.7241e-01
[rank0]:2025-11-06 00:07:55,080 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2058  memory: 16.57GiB(34.88%)  tps: 6,772  tflops: 51.57  mfu: 16.53%
[rank2]:2025-11-06 00:07:55,076 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1304e-01
[rank2]:2025-11-06 00:07:55,076 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2058  memory: 11.83GiB(24.89%)  tps: 6,771  tflops: 51.57  mfu: 16.53%
[rank1]:2025-11-06 00:08:17,608 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.9917e-01
[rank3]:2025-11-06 00:08:17,624 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.0863e-01
[rank0]:2025-11-06 00:08:17,624 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.2462e-01
[rank2]:2025-11-06 00:08:17,608 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.9364e-01
[rank1]:2025-11-06 00:08:42,742 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5636e-01
[rank3]:2025-11-06 00:08:42,749 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9313e-01
[rank0]:2025-11-06 00:08:42,741 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2634e+00
[rank2]:2025-11-06 00:08:42,737 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1516e-01
[rank0]:2025-11-06 00:09:05,216 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0828e+00
[rank2]:2025-11-06 00:09:05,201 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0418e-01
[rank1]:2025-11-06 00:09:05,201 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5336e+00
[rank3]:2025-11-06 00:09:05,216 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0023e+00
[rank3]:2025-11-06 00:09:30,326 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.6123e-01
[rank2]:2025-11-06 00:09:30,314 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8979e-01
[rank0]:2025-11-06 00:09:30,318 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7254e+00
[rank1]:2025-11-06 00:09:30,319 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.9310e-01
[rank0]:2025-11-06 00:09:50,478 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:09:52,438 - INFO - Avg. fwd time: 11.5457 / Avg. bwd time: 42.1655 / Avg. batch time: 489.3673 (ms) / GPU bubble ratio: 12.19%
[rank2]:2025-11-06 00:09:52,495 - INFO - Avg. fwd time: 7.6263 / Avg. bwd time: 15.4357 / Avg. batch time: 517.2209 (ms) / GPU bubble ratio: 64.33%
[rank0]:2025-11-06 00:09:52,523 - INFO - Avg. fwd time: 8.7018 / Avg. bwd time: 17.0054 / Avg. batch time: 580.9982 (ms) / GPU bubble ratio: 64.60%
[rank1]:2025-11-06 00:09:52,547 - INFO - Avg. fwd time: 9.7065 / Avg. bwd time: 19.3934 / Avg. batch time: 551.1396 (ms) / GPU bubble ratio: 57.76%
[rank1]:2025-11-06 00:09:52,724 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.2855e-01
[rank1]:2025-11-06 00:09:52,725 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1920  memory: 14.66GiB(30.86%)  tps: 6,963  tflops: 53.03  mfu: 17.00%
[rank3]:2025-11-06 00:09:52,740 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0346e-01
[rank3]:2025-11-06 00:09:52,743 - INFO -  step: 700  loss:  0.2223  grad_norm:  0.1920  memory: 28.29GiB(59.55%)  tps: 6,963  tflops: 53.03  mfu: 17.00%
[rank0]:2025-11-06 00:09:52,740 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1906e+00
[rank0]:2025-11-06 00:09:52,740 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1920  memory: 16.57GiB(34.88%)  tps: 6,962  tflops: 53.03  mfu: 17.00%
[rank0]:2025-11-06 00:09:52,798 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0009_stage0_step700.svg
[rank2]:2025-11-06 00:09:52,724 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8600e-01
[rank2]:2025-11-06 00:09:52,725 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1920  memory: 11.83GiB(24.89%)  tps: 6,963  tflops: 53.03  mfu: 17.00%
[rank2]:2025-11-06 00:09:52,798 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0009_stage2_step700.svg
[rank1]:2025-11-06 00:09:52,799 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0009_stage1_step700.svg
[rank3]:2025-11-06 00:09:52,889 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0009_real_step700_rank3.svg
[rank3]:> Batch Time: 547.84 ms, GPU Bubble Ratio: 63.87%, 65.32%, 71.86%, 24.98%
[rank3]:2025-11-06 00:09:52,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0009_stage3_step700.svg
[rank2]:2025-11-06 00:10:17,927 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7868e-01
[rank0]:2025-11-06 00:10:17,931 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6703e+00
[rank1]:2025-11-06 00:10:17,932 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8538e-01
[rank3]:2025-11-06 00:10:17,938 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4253e-01
[rank1]:2025-11-06 00:10:40,398 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0845e+00
[rank3]:2025-11-06 00:10:40,413 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5914e+00
[rank2]:2025-11-06 00:10:40,398 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7135e+00
[rank0]:2025-11-06 00:10:40,413 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0378e+00
[rank1]:2025-11-06 00:11:05,436 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3920e-01
[rank3]:2025-11-06 00:11:05,443 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5273e-01
[rank2]:2025-11-06 00:11:05,431 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8050e-01
[rank0]:2025-11-06 00:11:05,434 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7821e-01
[rank1]:2025-11-06 00:11:27,876 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7573e+00
[rank3]:2025-11-06 00:11:27,892 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5012e+00
[rank0]:2025-11-06 00:11:27,892 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1569e+00
[rank2]:2025-11-06 00:11:27,876 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6534e+00
[rank0]:2025-11-06 00:11:50,408 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 00:11:52,867 - INFO - Avg. fwd time: 7.6249 / Avg. bwd time: 15.4424 / Avg. batch time: 517.2676 (ms) / GPU bubble ratio: 64.32%
[rank1]:2025-11-06 00:11:52,899 - INFO - Avg. fwd time: 9.7055 / Avg. bwd time: 19.3950 / Avg. batch time: 551.1862 (ms) / GPU bubble ratio: 57.76%
[rank3]:2025-11-06 00:11:52,838 - INFO - Avg. fwd time: 11.5410 / Avg. bwd time: 42.1735 / Avg. batch time: 489.3910 (ms) / GPU bubble ratio: 12.19%
[rank0]:2025-11-06 00:11:52,924 - INFO - Avg. fwd time: 8.7153 / Avg. bwd time: 16.9151 / Avg. batch time: 580.9550 (ms) / GPU bubble ratio: 64.71%
[rank0]:2025-11-06 00:11:52,950 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9923e-01
[rank0]:2025-11-06 00:11:52,950 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2068  memory: 16.57GiB(34.88%)  tps: 6,815  tflops: 51.90  mfu: 16.64%
[rank2]:2025-11-06 00:11:52,946 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1187e-01
[rank2]:2025-11-06 00:11:52,946 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2068  memory: 11.83GiB(24.89%)  tps: 6,814  tflops: 51.90  mfu: 16.63%
[rank1]:2025-11-06 00:11:52,950 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9905e-01
[rank1]:2025-11-06 00:11:52,950 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2068  memory: 14.66GiB(30.86%)  tps: 6,814  tflops: 51.90  mfu: 16.63%
[rank3]:2025-11-06 00:11:52,957 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.8167e-01
[rank3]:2025-11-06 00:11:52,960 - INFO -  step: 750  loss:  0.2738  grad_norm:  0.2068  memory: 28.29GiB(59.55%)  tps: 6,814  tflops: 51.90  mfu: 16.63%
[rank2]:2025-11-06 00:12:15,360 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2286e+00
[rank0]:2025-11-06 00:12:15,376 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8819e-01
[rank1]:2025-11-06 00:12:15,360 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5671e+00
[rank3]:2025-11-06 00:12:15,376 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1162e+00
[rank3]:2025-11-06 00:12:40,494 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1874e+00
[rank2]:2025-11-06 00:12:40,483 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6423e-01
[rank0]:2025-11-06 00:12:40,487 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6283e+00
[rank1]:2025-11-06 00:12:40,487 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.7334e-01
[rank2]:2025-11-06 00:13:02,958 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.1926e-01
[rank0]:2025-11-06 00:13:02,974 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4786e+00
[rank1]:2025-11-06 00:13:02,958 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.7013e-01
[rank3]:2025-11-06 00:13:02,974 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6583e-01
[rank0]:2025-11-06 00:13:28,092 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9507e-01
[rank2]:2025-11-06 00:13:28,088 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5016e-01
[rank1]:2025-11-06 00:13:28,093 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1300e-01
[rank3]:2025-11-06 00:13:28,100 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9001e-01
[rank0]:2025-11-06 00:13:48,327 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:13:50,285 - INFO - Avg. fwd time: 11.5425 / Avg. bwd time: 42.1388 / Avg. batch time: 489.1246 (ms) / GPU bubble ratio: 12.20%
[rank2]:2025-11-06 00:13:50,343 - INFO - Avg. fwd time: 7.6326 / Avg. bwd time: 15.3908 / Avg. batch time: 516.9305 (ms) / GPU bubble ratio: 64.37%
[rank0]:2025-11-06 00:13:50,371 - INFO - Avg. fwd time: 8.7253 / Avg. bwd time: 16.8474 / Avg. batch time: 580.4699 (ms) / GPU bubble ratio: 64.76%
[rank1]:2025-11-06 00:13:50,394 - INFO - Avg. fwd time: 9.7159 / Avg. bwd time: 19.3186 / Avg. batch time: 550.7700 (ms) / GPU bubble ratio: 57.83%
[rank3]:2025-11-06 00:13:50,588 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3334e+00
[rank2]:2025-11-06 00:13:50,572 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6633e+00
[rank2]:2025-11-06 00:13:50,573 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1854  memory: 11.83GiB(24.89%)  tps: 6,964  tflops: 53.04  mfu: 17.00%
[rank2]:2025-11-06 00:13:50,647 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0013_stage2_step800.svg
[rank0]:2025-11-06 00:13:50,588 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8327e+00
[rank0]:2025-11-06 00:13:50,588 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1854  memory: 16.57GiB(34.88%)  tps: 6,964  tflops: 53.04  mfu: 17.00%
[rank0]:2025-11-06 00:13:50,648 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0013_stage0_step800.svg
[rank1]:2025-11-06 00:13:50,572 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3930e+00
[rank1]:2025-11-06 00:13:50,573 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1854  memory: 14.66GiB(30.86%)  tps: 6,965  tflops: 53.04  mfu: 17.00%
[rank1]:2025-11-06 00:13:50,648 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0013_stage1_step800.svg
[rank3]:2025-11-06 00:13:50,591 - INFO -  step: 800  loss:  0.2286  grad_norm:  0.1854  memory: 28.29GiB(59.55%)  tps: 6,964  tflops: 53.04  mfu: 17.00%
[rank3]:2025-11-06 00:13:50,740 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0013_real_step800_rank3.svg
[rank3]:> Batch Time: 603.84 ms, GPU Bubble Ratio: 67.19%, 56.55%, 65.77%, 27.07%
[rank3]:2025-11-06 00:13:50,789 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0013_stage3_step800.svg
[rank3]:2025-11-06 00:14:15,916 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2784e-01
[rank2]:2025-11-06 00:14:15,904 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1273e-01
[rank0]:2025-11-06 00:14:15,908 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.0418e-01
[rank1]:2025-11-06 00:14:15,909 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7621e-01
[rank3]:2025-11-06 00:14:17,325 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 00:14:17,572 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-06 00:14:17,586 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-06 00:14:17,606 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-06 00:14:38,399 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3385e+00
[rank0]:2025-11-06 00:14:38,414 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0937e+00
[rank1]:2025-11-06 00:14:38,399 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0823e+00
[rank3]:2025-11-06 00:14:38,414 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0571e+00
[rank2]:2025-11-06 00:15:03,584 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8947e-01
[rank0]:2025-11-06 00:15:03,588 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9549e-01
[rank1]:2025-11-06 00:15:03,590 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4801e-01
[rank3]:2025-11-06 00:15:03,596 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1772e-01
[rank2]:2025-11-06 00:15:26,119 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.4860e-01
[rank0]:2025-11-06 00:15:26,135 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1392e+00
[rank1]:2025-11-06 00:15:26,119 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6397e+00
[rank3]:2025-11-06 00:15:26,135 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2660e+00
[rank0]:2025-11-06 00:15:48,796 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:15:51,029 - INFO - Avg. fwd time: 11.5429 / Avg. bwd time: 42.1445 / Avg. batch time: 489.1735 (ms) / GPU bubble ratio: 12.20%
[rank2]:2025-11-06 00:15:51,100 - INFO - Avg. fwd time: 7.6349 / Avg. bwd time: 15.3772 / Avg. batch time: 516.9795 (ms) / GPU bubble ratio: 64.39%
[rank0]:2025-11-06 00:15:51,062 - INFO - Avg. fwd time: 8.7363 / Avg. bwd time: 16.7775 / Avg. batch time: 580.4252 (ms) / GPU bubble ratio: 64.83%
[rank1]:2025-11-06 00:15:51,141 - INFO - Avg. fwd time: 9.7193 / Avg. bwd time: 19.2943 / Avg. batch time: 550.7950 (ms) / GPU bubble ratio: 57.86%
[rank2]:2025-11-06 00:15:51,312 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0911e+00
[rank2]:2025-11-06 00:15:51,312 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2663  memory: 11.83GiB(24.89%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank0]:2025-11-06 00:15:51,315 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9576e+00
[rank0]:2025-11-06 00:15:51,316 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2663  memory: 16.57GiB(34.88%)  tps: 6,786  tflops: 51.68  mfu: 16.56%
[rank1]:2025-11-06 00:15:51,316 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3401e+00
[rank1]:2025-11-06 00:15:51,317 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2663  memory: 14.66GiB(30.86%)  tps: 6,785  tflops: 51.67  mfu: 16.56%
[rank3]:2025-11-06 00:15:51,323 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6202e+00
[rank3]:2025-11-06 00:15:51,327 - INFO -  step: 850  loss:  0.2309  grad_norm:  0.2663  memory: 28.29GiB(59.55%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank2]:2025-11-06 00:16:13,890 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1025e-01
[rank0]:2025-11-06 00:16:13,905 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9334e-01
[rank1]:2025-11-06 00:16:13,890 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1598e+00
[rank3]:2025-11-06 00:16:13,906 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.9613e-01
[rank0]:2025-11-06 00:16:39,171 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1832e+00
[rank2]:2025-11-06 00:16:39,167 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0029e-01
[rank1]:2025-11-06 00:16:39,172 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5768e-01
[rank3]:2025-11-06 00:16:39,179 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8757e-01
[rank0]:2025-11-06 00:17:01,770 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9428e+00
[rank2]:2025-11-06 00:17:01,755 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2790e+00
[rank1]:2025-11-06 00:17:01,755 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2818e+00
[rank3]:2025-11-06 00:17:01,770 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3681e+00
[rank0]:2025-11-06 00:17:27,023 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4763e-01
[rank1]:2025-11-06 00:17:27,025 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6018e-01
[rank2]:2025-11-06 00:17:27,020 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6628e-01
[rank3]:2025-11-06 00:17:27,031 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4251e-01
[rank0]:2025-11-06 00:17:47,338 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:17:49,575 - INFO - Avg. fwd time: 11.5496 / Avg. bwd time: 42.1245 / Avg. batch time: 489.0673 (ms) / GPU bubble ratio: 12.20%
[rank0]:2025-11-06 00:17:49,644 - INFO - Avg. fwd time: 8.7467 / Avg. bwd time: 16.7162 / Avg. batch time: 580.1093 (ms) / GPU bubble ratio: 64.89%
[rank0]:2025-11-06 00:17:49,669 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7176e-01
[rank0]:2025-11-06 00:17:49,670 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2189  memory: 16.57GiB(34.88%)  tps: 6,922  tflops: 52.72  mfu: 16.90%
[rank1]:2025-11-06 00:17:49,618 - INFO - Avg. fwd time: 9.7316 / Avg. bwd time: 19.2132 / Avg. batch time: 550.5350 (ms) / GPU bubble ratio: 57.94%
[rank1]:2025-11-06 00:17:49,654 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9505e-01
[rank1]:2025-11-06 00:17:49,654 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2189  memory: 14.66GiB(30.86%)  tps: 6,923  tflops: 52.72  mfu: 16.90%
[rank2]:2025-11-06 00:17:49,596 - INFO - Avg. fwd time: 7.6441 / Avg. bwd time: 15.3213 / Avg. batch time: 516.8001 (ms) / GPU bubble ratio: 64.45%
[rank2]:2025-11-06 00:17:49,654 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.5911e-01
[rank2]:2025-11-06 00:17:49,654 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2189  memory: 11.83GiB(24.89%)  tps: 6,922  tflops: 52.72  mfu: 16.90%
[rank3]:2025-11-06 00:17:49,669 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4228e+00
[rank3]:2025-11-06 00:17:49,672 - INFO -  step: 900  loss:  0.2023  grad_norm:  0.2189  memory: 28.29GiB(59.55%)  tps: 6,922  tflops: 52.72  mfu: 16.90%
[rank0]:2025-11-06 00:17:49,726 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0017_stage0_step900.svg
[rank1]:2025-11-06 00:17:49,724 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0017_stage1_step900.svg
[rank2]:2025-11-06 00:17:49,722 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0017_stage2_step900.svg
[rank3]:2025-11-06 00:17:49,819 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0017_real_step900_rank3.svg
[rank3]:> Batch Time: 548.87 ms, GPU Bubble Ratio: 63.86%, 65.33%, 71.84%, 25.25%
[rank3]:2025-11-06 00:17:49,861 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0017_stage3_step900.svg
[rank1]:2025-11-06 00:18:15,076 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4072e+00
[rank0]:2025-11-06 00:18:15,075 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8210e+00
[rank2]:2025-11-06 00:18:15,072 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2834e+00
[rank3]:2025-11-06 00:18:15,083 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6781e+00
[rank3]:2025-11-06 00:18:37,684 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.4613e-01
[rank1]:2025-11-06 00:18:37,668 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4531e-01
[rank0]:2025-11-06 00:18:37,683 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.6546e-01
[rank2]:2025-11-06 00:18:37,668 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.0699e-01
[rank0]:2025-11-06 00:19:02,926 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5011e-01
[rank1]:2025-11-06 00:19:02,927 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1401e-01
[rank2]:2025-11-06 00:19:02,923 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0479e-01
[rank3]:2025-11-06 00:19:02,934 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1723e-01
[rank1]:2025-11-06 00:19:25,411 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.5890e-01
[rank2]:2025-11-06 00:19:25,411 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0568e-01
[rank3]:2025-11-06 00:19:25,427 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7760e-01
[rank0]:2025-11-06 00:19:25,426 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1535e+00
[rank0]:2025-11-06 00:19:47,999 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:19:50,216 - INFO - Avg. fwd time: 11.5497 / Avg. bwd time: 42.1430 / Avg. batch time: 489.2174 (ms) / GPU bubble ratio: 12.20%
[rank0]:2025-11-06 00:19:50,249 - INFO - Avg. fwd time: 8.7545 / Avg. bwd time: 16.6689 / Avg. batch time: 580.2365 (ms) / GPU bubble ratio: 64.95%
[rank1]:2025-11-06 00:19:50,328 - INFO - Avg. fwd time: 9.7314 / Avg. bwd time: 19.2167 / Avg. batch time: 550.7091 (ms) / GPU bubble ratio: 57.95%
[rank2]:2025-11-06 00:19:50,287 - INFO - Avg. fwd time: 7.6439 / Avg. bwd time: 15.3263 / Avg. batch time: 516.9689 (ms) / GPU bubble ratio: 64.45%
[rank0]:2025-11-06 00:19:50,497 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7402e+00
[rank0]:2025-11-06 00:19:50,498 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2156  memory: 16.57GiB(34.88%)  tps: 6,780  tflops: 51.64  mfu: 16.55%
[rank1]:2025-11-06 00:19:50,499 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5716e-01
[rank1]:2025-11-06 00:19:50,499 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2156  memory: 14.66GiB(30.86%)  tps: 6,779  tflops: 51.63  mfu: 16.55%
[rank2]:2025-11-06 00:19:50,494 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5687e-01
[rank2]:2025-11-06 00:19:50,494 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2156  memory: 11.83GiB(24.89%)  tps: 6,779  tflops: 51.63  mfu: 16.55%
[rank3]:2025-11-06 00:19:50,505 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2763e-01
[rank3]:2025-11-06 00:19:50,509 - INFO -  step: 950  loss:  0.2457  grad_norm:  0.2156  memory: 28.29GiB(59.55%)  tps: 6,780  tflops: 51.63  mfu: 16.55%
[rank1]:2025-11-06 00:20:12,971 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7048e+00
[rank2]:2025-11-06 00:20:12,971 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1158e+00
[rank3]:2025-11-06 00:20:12,986 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5515e-01
[rank0]:2025-11-06 00:20:12,986 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9674e+00
[rank3]:2025-11-06 00:20:38,030 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9313e-01
[rank0]:2025-11-06 00:20:38,022 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3329e+00
[rank1]:2025-11-06 00:20:38,023 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2591e-01
[rank2]:2025-11-06 00:20:38,018 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8092e-01
[rank0]:2025-11-06 00:21:00,436 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9744e+00
[rank1]:2025-11-06 00:21:00,421 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7354e+00
[rank2]:2025-11-06 00:21:00,421 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1640e+00
[rank3]:2025-11-06 00:21:00,437 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.6408e-01
[rank0]:2025-11-06 00:21:25,478 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9758e+00
[rank1]:2025-11-06 00:21:25,479 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1941e+00
[rank2]:2025-11-06 00:21:25,475 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9735e+00
[rank3]:2025-11-06 00:21:25,486 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8603e+00
[rank0]:2025-11-06 00:21:45,611 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:21:47,579 - INFO - Avg. fwd time: 11.5475 / Avg. bwd time: 42.1194 / Avg. batch time: 489.0086 (ms) / GPU bubble ratio: 12.20%
[rank0]:2025-11-06 00:21:47,663 - INFO - Avg. fwd time: 8.7611 / Avg. bwd time: 16.6181 / Avg. batch time: 579.8806 (ms) / GPU bubble ratio: 64.99%
[rank1]:2025-11-06 00:21:47,687 - INFO - Avg. fwd time: 9.7361 / Avg. bwd time: 19.1719 / Avg. batch time: 550.4068 (ms) / GPU bubble ratio: 57.98%
[rank2]:2025-11-06 00:21:47,635 - INFO - Avg. fwd time: 7.6478 / Avg. bwd time: 15.2971 / Avg. batch time: 516.7131 (ms) / GPU bubble ratio: 64.48%
[rank0]:2025-11-06 00:21:47,882 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9605e+00
[rank0]:2025-11-06 00:21:47,883 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3127  memory: 16.57GiB(34.88%)  tps: 6,979  tflops: 53.15  mfu: 17.04%
[rank1]:2025-11-06 00:21:47,867 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1316e+00
[rank1]:2025-11-06 00:21:47,867 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3127  memory: 14.66GiB(30.86%)  tps: 6,980  tflops: 53.16  mfu: 17.04%
[rank2]:2025-11-06 00:21:47,867 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2388e+00
[rank2]:2025-11-06 00:21:47,867 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3127  memory: 11.83GiB(24.89%)  tps: 6,979  tflops: 53.16  mfu: 17.04%
[rank3]:2025-11-06 00:21:47,883 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0012e+00
[rank3]:2025-11-06 00:21:47,886 - INFO -  step: 1000  loss:  0.2371  grad_norm:  0.3127  memory: 28.29GiB(59.55%)  tps: 6,979  tflops: 53.16  mfu: 17.04%
[rank0]:2025-11-06 00:21:47,939 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0021_stage0_step1000.svg
[rank1]:2025-11-06 00:21:47,939 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0021_stage1_step1000.svg
[rank2]:2025-11-06 00:21:47,938 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0021_stage2_step1000.svg
[rank3]:2025-11-06 00:21:48,033 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0021_real_step1000_rank3.svg
[rank3]:> Batch Time: 545.82 ms, GPU Bubble Ratio: 63.78%, 65.29%, 71.80%, 24.84%
[rank3]:2025-11-06 00:21:48,077 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0021_stage3_step1000.svg
[rank2]:2025-11-06 00:22:13,028 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1844e-01
[rank0]:2025-11-06 00:22:13,032 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4612e+00
[rank1]:2025-11-06 00:22:13,033 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1824e-01
[rank3]:2025-11-06 00:22:13,040 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0598e-01
[rank2]:2025-11-06 00:22:35,419 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8291e+00
[rank0]:2025-11-06 00:22:35,435 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9417e-01
[rank1]:2025-11-06 00:22:35,420 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0198e+00
[rank3]:2025-11-06 00:22:35,435 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6508e+00
[rank2]:2025-11-06 00:23:00,533 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0916e-01
[rank0]:2025-11-06 00:23:00,537 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.0857e-01
[rank1]:2025-11-06 00:23:00,538 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9381e-01
[rank3]:2025-11-06 00:23:00,545 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0731e+00
[rank2]:2025-11-06 00:23:22,986 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4086e-01
[rank0]:2025-11-06 00:23:23,001 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.1410e-01
[rank1]:2025-11-06 00:23:22,986 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7624e-01
[rank3]:2025-11-06 00:23:23,002 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2467e+00
[rank0]:2025-11-06 00:23:45,590 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:23:48,024 - INFO - Avg. fwd time: 11.5445 / Avg. bwd time: 42.1286 / Avg. batch time: 489.0566 (ms) / GPU bubble ratio: 12.20%
[rank2]:2025-11-06 00:23:48,055 - INFO - Avg. fwd time: 7.6456 / Avg. bwd time: 15.3083 / Avg. batch time: 516.7848 (ms) / GPU bubble ratio: 64.47%
[rank2]:2025-11-06 00:23:48,136 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0484e-01
[rank2]:2025-11-06 00:23:48,137 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2330  memory: 11.83GiB(24.89%)  tps: 6,811  tflops: 51.88  mfu: 16.63%
[rank0]:2025-11-06 00:23:48,115 - INFO - Avg. fwd time: 8.7671 / Avg. bwd time: 16.5726 / Avg. batch time: 579.9184 (ms) / GPU bubble ratio: 65.04%
[rank0]:2025-11-06 00:23:48,140 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3502e+00
[rank0]:2025-11-06 00:23:48,140 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2330  memory: 16.57GiB(34.88%)  tps: 6,812  tflops: 51.88  mfu: 16.63%
[rank1]:2025-11-06 00:23:48,089 - INFO - Avg. fwd time: 9.7332 / Avg. bwd time: 19.1837 / Avg. batch time: 550.4917 (ms) / GPU bubble ratio: 57.98%
[rank1]:2025-11-06 00:23:48,141 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.4255e-01
[rank1]:2025-11-06 00:23:48,141 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2330  memory: 14.66GiB(30.86%)  tps: 6,811  tflops: 51.88  mfu: 16.63%
[rank3]:2025-11-06 00:23:48,148 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7616e-01
[rank3]:2025-11-06 00:23:48,151 - INFO -  step: 1050  loss:  0.2802  grad_norm:  0.2330  memory: 28.29GiB(59.55%)  tps: 6,812  tflops: 51.88  mfu: 16.63%
[rank2]:2025-11-06 00:24:10,544 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3807e+00
[rank0]:2025-11-06 00:24:10,560 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9914e+00
[rank1]:2025-11-06 00:24:10,544 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1288e+00
[rank3]:2025-11-06 00:24:10,560 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2938e+00
[rank3]:2025-11-06 00:24:35,660 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2734e+00
[rank2]:2025-11-06 00:24:35,648 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6341e+00
[rank0]:2025-11-06 00:24:35,652 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5947e+00
[rank1]:2025-11-06 00:24:35,653 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4339e+00
[rank2]:2025-11-06 00:24:58,181 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7282e+00
[rank0]:2025-11-06 00:24:58,197 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2988e+00
[rank1]:2025-11-06 00:24:58,182 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3223e+00
[rank3]:2025-11-06 00:24:58,197 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0237e+00
[rank3]:2025-11-06 00:25:23,325 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9490e-01
[rank2]:2025-11-06 00:25:23,313 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2730e-01
[rank0]:2025-11-06 00:25:23,317 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8569e+00
[rank1]:2025-11-06 00:25:23,318 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3363e+00
[rank0]:2025-11-06 00:25:43,570 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:25:45,554 - INFO - Avg. fwd time: 11.5462 / Avg. bwd time: 42.1075 / Avg. batch time: 488.8995 (ms) / GPU bubble ratio: 12.21%
[rank2]:2025-11-06 00:25:45,607 - INFO - Avg. fwd time: 7.6504 / Avg. bwd time: 15.2763 / Avg. batch time: 516.5827 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-11-06 00:25:45,642 - INFO - Avg. fwd time: 8.7726 / Avg. bwd time: 16.5372 / Avg. batch time: 579.6315 (ms) / GPU bubble ratio: 65.07%
[rank1]:2025-11-06 00:25:45,667 - INFO - Avg. fwd time: 9.7389 / Avg. bwd time: 19.1372 / Avg. batch time: 550.2395 (ms) / GPU bubble ratio: 58.02%
[rank1]:2025-11-06 00:25:45,840 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5899e+00
[rank1]:2025-11-06 00:25:45,840 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2204  memory: 14.66GiB(30.86%)  tps: 6,960  tflops: 53.01  mfu: 16.99%
[rank3]:2025-11-06 00:25:45,856 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.1737e-01
[rank3]:2025-11-06 00:25:45,861 - INFO -  step: 1100  loss:  0.2417  grad_norm:  0.2204  memory: 28.29GiB(59.55%)  tps: 6,960  tflops: 53.01  mfu: 16.99%
[rank2]:2025-11-06 00:25:45,840 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.1350e-01
[rank2]:2025-11-06 00:25:45,840 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2204  memory: 11.83GiB(24.89%)  tps: 6,960  tflops: 53.01  mfu: 16.99%
[rank0]:2025-11-06 00:25:45,855 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1744e+00
[rank0]:2025-11-06 00:25:45,856 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2204  memory: 16.57GiB(34.88%)  tps: 6,959  tflops: 53.00  mfu: 16.99%
[rank0]:2025-11-06 00:25:45,919 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0025_stage0_step1100.svg
[rank1]:2025-11-06 00:25:45,915 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0025_stage1_step1100.svg
[rank2]:2025-11-06 00:25:45,915 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0025_stage2_step1100.svg
[rank3]:2025-11-06 00:25:46,010 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0025_real_step1100_rank3.svg
[rank3]:> Batch Time: 605.34 ms, GPU Bubble Ratio: 67.24%, 56.72%, 65.85%, 27.21%
[rank3]:2025-11-06 00:25:46,054 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0025_stage3_step1100.svg
[rank3]:2025-11-06 00:26:11,492 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9690e-01
[rank2]:2025-11-06 00:26:11,480 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9494e-01
[rank0]:2025-11-06 00:26:11,484 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4278e+00
[rank1]:2025-11-06 00:26:11,485 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3581e-01
[rank2]:2025-11-06 00:26:34,063 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7725e-01
[rank0]:2025-11-06 00:26:34,078 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8521e+00
[rank1]:2025-11-06 00:26:34,063 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2868e+00
[rank3]:2025-11-06 00:26:34,078 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.6975e-01
[rank0]:2025-11-06 00:26:59,327 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6684e+00
[rank1]:2025-11-06 00:26:59,328 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2980e-01
[rank3]:2025-11-06 00:26:59,335 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4532e-01
[rank2]:2025-11-06 00:26:59,324 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9338e-01
[rank2]:2025-11-06 00:27:21,942 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8948e+00
[rank1]:2025-11-06 00:27:21,942 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6822e-01
[rank3]:2025-11-06 00:27:21,958 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5799e+00
[rank0]:2025-11-06 00:27:21,958 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1849e-01
[rank0]:2025-11-06 00:27:44,769 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:27:46,997 - INFO - Avg. fwd time: 11.5481 / Avg. bwd time: 42.1209 / Avg. batch time: 489.0292 (ms) / GPU bubble ratio: 12.20%
[rank2]:2025-11-06 00:27:47,072 - INFO - Avg. fwd time: 7.6518 / Avg. bwd time: 15.2720 / Avg. batch time: 516.7204 (ms) / GPU bubble ratio: 64.51%
[rank0]:2025-11-06 00:27:47,030 - INFO - Avg. fwd time: 8.7846 / Avg. bwd time: 16.5002 / Avg. batch time: 579.7430 (ms) / GPU bubble ratio: 65.11%
[rank1]:2025-11-06 00:27:47,111 - INFO - Avg. fwd time: 9.7418 / Avg. bwd time: 19.1284 / Avg. batch time: 550.3691 (ms) / GPU bubble ratio: 58.04%
[rank2]:2025-11-06 00:27:47,278 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2817e-01
[rank2]:2025-11-06 00:27:47,278 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2029  memory: 11.83GiB(24.89%)  tps: 6,746  tflops: 51.38  mfu: 16.47%
[rank0]:2025-11-06 00:27:47,282 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5641e-01
[rank0]:2025-11-06 00:27:47,282 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2029  memory: 16.57GiB(34.88%)  tps: 6,746  tflops: 51.38  mfu: 16.47%
[rank1]:2025-11-06 00:27:47,283 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4973e-01
[rank1]:2025-11-06 00:27:47,284 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2029  memory: 14.66GiB(30.86%)  tps: 6,746  tflops: 51.38  mfu: 16.47%
[rank3]:2025-11-06 00:27:47,290 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.7566e-01
[rank3]:2025-11-06 00:27:47,294 - INFO -  step: 1150  loss:  0.2426  grad_norm:  0.2029  memory: 28.29GiB(59.55%)  tps: 6,746  tflops: 51.38  mfu: 16.47%
[rank2]:2025-11-06 00:28:09,947 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.1010e-01
[rank0]:2025-11-06 00:28:09,962 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8186e-01
[rank1]:2025-11-06 00:28:09,947 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.1486e-01
[rank3]:2025-11-06 00:28:09,963 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3066e+00
[rank3]:2025-11-06 00:28:35,267 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4003e-01
[rank2]:2025-11-06 00:28:35,255 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9618e-01
[rank0]:2025-11-06 00:28:35,259 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0747e+00
[rank1]:2025-11-06 00:28:35,260 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3017e-01
[rank1]:2025-11-06 00:28:57,879 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6590e+00
[rank3]:2025-11-06 00:28:57,894 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.9473e-01
[rank2]:2025-11-06 00:28:57,879 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.5262e-01
[rank0]:2025-11-06 00:28:57,894 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2589e+00
[rank2]:2025-11-06 00:29:23,259 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0046e-01
[rank0]:2025-11-06 00:29:23,263 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8173e-01
[rank1]:2025-11-06 00:29:23,264 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3323e-01
[rank3]:2025-11-06 00:29:23,271 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.5390e-01
[rank0]:2025-11-06 00:29:43,638 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:29:45,879 - INFO - Avg. fwd time: 11.5552 / Avg. bwd time: 42.1119 / Avg. batch time: 489.0160 (ms) / GPU bubble ratio: 12.20%
[rank2]:2025-11-06 00:29:45,902 - INFO - Avg. fwd time: 7.6584 / Avg. bwd time: 15.2357 / Avg. batch time: 516.6599 (ms) / GPU bubble ratio: 64.55%
[rank1]:2025-11-06 00:29:45,927 - INFO - Avg. fwd time: 9.7508 / Avg. bwd time: 19.0763 / Avg. batch time: 550.2542 (ms) / GPU bubble ratio: 58.09%
[rank3]:2025-11-06 00:29:45,979 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9773e-01
[rank3]:2025-11-06 00:29:45,982 - INFO -  step: 1200  loss:  0.2423  grad_norm:  0.1928  memory: 28.29GiB(59.55%)  tps: 6,902  tflops: 52.57  mfu: 16.85%
[rank3]:2025-11-06 00:29:45,983 - INFO -  final step: 1200  loss:  0.2423  grad_norm:  0.1928  tps: 7,121  tflops: 54.24  mfu: 16.33%
[rank3]:2025-11-06 00:29:45,983 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 00:29:45,964 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2727e-01
[rank2]:2025-11-06 00:29:45,964 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1928  memory: 11.83GiB(24.89%)  tps: 6,902  tflops: 52.57  mfu: 16.85%
[rank2]:2025-11-06 00:29:45,965 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1928  tps: 7,117  tflops: 54.20  mfu: 16.26%
[rank2]:2025-11-06 00:29:45,965 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 00:29:45,965 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-06 00:29:45,964 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.0562e-01
[rank1]:2025-11-06 00:29:45,964 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1928  memory: 14.66GiB(30.86%)  tps: 6,903  tflops: 52.57  mfu: 16.85%
[rank1]:2025-11-06 00:29:45,964 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1928  tps: 7,117  tflops: 54.21  mfu: 16.26%
[rank1]:2025-11-06 00:29:45,964 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 00:29:45,965 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-06 00:29:45,954 - INFO - Avg. fwd time: 8.7904 / Avg. bwd time: 16.4666 / Avg. batch time: 579.5959 (ms) / GPU bubble ratio: 65.14%
[rank0]:2025-11-06 00:29:45,979 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3235e+00
[rank0]:2025-11-06 00:29:45,980 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1928  memory: 16.57GiB(34.88%)  tps: 6,902  tflops: 52.56  mfu: 16.85%
[rank0]:2025-11-06 00:29:45,980 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1928  tps: 7,117  tflops: 54.21  mfu: 16.27%
[rank0]:2025-11-06 00:29:45,980 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 00:29:45,981 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-06 00:29:45,984 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-06 00:29:48,221 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank2/251106_0029_stage2_final1200.svg
[rank1]:2025-11-06 00:29:48,220 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank1/251106_0029_stage1_final1200.svg
[rank0]:2025-11-06 00:29:48,154 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-06 00:29:48,221 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank0/251106_0029_stage0_final1200.svg
[rank3]:2025-11-06 00:29:48,313 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0029_real_final1200_rank3.svg
[rank3]:> Batch Time: 596.84 ms, GPU Bubble Ratio: 66.85%, 56.16%, 65.45%, 26.96%
[rank2]:2025-11-06 00:29:48,437 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/frozen_params_histogram/251106_0029_rank2_stage2.svg
[rank2]:	> Counts Sum: 1512, Total Sum: 4140 (36.52%), Ratio(%) per element: [48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-06 00:29:48,437 - INFO - Destroying the purge thread.
[rank1]:2025-11-06 00:29:48,375 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/frozen_params_histogram/251106_0029_rank1_stage1.svg
[rank1]:	> Counts Sum: 1989, Total Sum: 5175 (38.43%), Ratio(%) per element: [48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 47.82, 47.82, 47.82, 47.82, 47.82, 47.82, 47.82, 47.82, 47.82, 46.95, 46.95, 46.95, 46.95, 46.95, 46.95, 46.95, 46.95, 46.95, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-06 00:29:48,375 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 00:29:48,442 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/frozen_params_histogram/251106_0029_rank0_stage0.svg
[rank0]:	> Counts Sum: 2952, Total Sum: 4255 (69.38%), Ratio(%) per element: [0.0, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-06 00:29:48,442 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-06 00:29:48,463 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/pipeline_schedule/251106_0029_thry_final1200_rank3.svg
[rank3]:> Batch Time: 304.18 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-06 00:29:48,512 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/freeze_ratio_history/rank3/251106_0029_stage3_final1200.svg
[rank3]:2025-11-06 00:29:48,655 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85/frozen_params_histogram/251106_0029_rank3_stage3.svg
[rank3]:	> Counts Sum: 1026, Total Sum: 3335 (30.76%), Ratio(%) per element: [49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-06 00:29:48,656 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-11-06 00:29:48,784 - INFO - Process group destroyed
[rank1]:2025-11-06 00:29:48,761 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 23-24, summary, console lines 373-386
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.30067
[rank3]:wandb:               final/avg_loss 0.24233
[rank3]:wandb:             final/avg_mfu(%) 16.33085
[rank3]:wandb:             final/avg_tflops 54.2382
[rank3]:wandb:    final/avg_throughput(tps) 7121.41338
[rank3]:wandb:              final/grad_norm 0.19277
[rank3]:wandb:               final/max_loss 0.24233
[rank3]:wandb:                    grad_norm 0.19277
[rank3]:wandb: loss_metrics/global_avg_loss 0.24233
[rank3]:wandb: loss_metrics/global_max_loss 0.24233
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_GPipe_auto_dm1_th0.03_p85 at: https://wandb.ai/orangingq/torchtitan/runs/tgppw2z4
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1_th0.03_p85/20251105-2341/wandb/run-20251105_234149-tgppw2z4/logs
[rank3]:2025-11-06 00:29:49,736 - INFO - Process group destroyed
[rank0]:2025-11-06 00:29:50,442 - INFO - Training completed
[rank0]:2025-11-06 00:29:50,442 - INFO - Destroying the purge thread.
[rank0]:2025-11-06 00:29:50,771 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.6', 'layers.5', 'layers.7', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.1', 'layers.0', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.15', 'layers.13', 'layers.14', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_GPipe_auto_dm1_th0.03_p85
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_GPipe_auto_dm1_th0.03_p85
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_GPipe_auto_dm1_th0.03_p85
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1_th0.03_p85
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1_th0.03_p85
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_GPipe_auto_dm1_th0.03_p85
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_GPipe_auto_dm1_th0.03_p85
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_GPipe_auto_dm1_th0.03_p85
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.03
[rank3]:		- percentile: 85
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
