
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 05. (ìˆ˜) 06:17:59 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_GPipe_timelyauto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-05 06:18:05,355 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-11-05 06:18:05,355 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 06:18:05,612 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-11-05 06:18:05,526 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-05 06:18:05,592 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-05 06:18:05,595 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-05 06:18:05,605 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 06:18:05,607 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-05 06:18:05,716 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-05 06:18:05,719 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 06:18:05,804 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-05 06:18:05,807 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 06:18:05,812 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-05 06:18:06,348 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-05 06:18:06,799 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-11-05 06:18:09,694 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-05 06:18:09,734 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 06:18:09,761 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-05 06:18:09,761 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-05 06:18:09,987 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-05 06:18:09,935 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 06:18:09,935 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-05 06:18:09,936 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-05 06:18:10,137 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-05 06:18:10,176 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 06:18:10,178 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-05 06:18:10,201 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-05 06:18:10,201 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-05 06:18:10,377 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 06:18:10,377 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 06:18:10,378 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-05 06:18:10,352 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 06:18:10,393 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 06:18:10,420 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-05 06:18:10,421 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-05 06:18:10,595 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 06:18:10,595 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-05 06:18:10,596 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run basawrb8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_GPipe_timelyauto_dm1/20251105-0618/wandb/run-20251105_061810-basawrb8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/basawrb8
[rank3]:2025-11-05 06:18:11,754 - INFO - WandB logging enabled
[rank3]:2025-11-05 06:18:11,755 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-05 06:18:11,795 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 06:18:11,826 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-05 06:18:11,827 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-05 06:18:12,024 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_GPipe_timelyauto_dm1
[rank0]:2025-11-05 06:18:12,024 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 06:18:12,025 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-05 06:18:12,025 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-05 06:18:12,024 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-05 06:18:12,024 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-05 06:18:12,008 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 06:18:12,009 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-05 06:18:12,010 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-05 06:18:12,024 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 06:18:14,189 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-05 06:18:14,190 - INFO - Finished loading the checkpoint in 2.16 seconds.
[rank0]:2025-11-05 06:18:14,190 - INFO - Training starts at step 1
[rank2]:2025-11-05 06:18:17,331 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8870  memory:  9.99GiB(21.03%)  tps: 2,362  tflops: 17.99  mfu: 5.77%
[rank2]:2025-11-05 06:18:17,331 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-05 06:18:17,335 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8870  memory: 12.38GiB(26.05%)  tps: 2,156  tflops: 16.42  mfu: 5.26%
[rank1]:2025-11-05 06:18:17,335 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 06:18:17,372 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8870  memory: 12.80GiB(26.95%)  tps: 2,277  tflops: 17.34  mfu: 5.56%
[rank0]:2025-11-05 06:18:17,373 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-05 06:18:17,342 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8870  memory: 24.19GiB(50.91%)  tps: 2,955  tflops: 22.51  mfu: 7.21%
[rank3]:2025-11-05 06:18:17,342 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 06:20:19,554 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 06:20:21,800 - INFO - Avg. fwd time: 11.2490 / Avg. bwd time: 44.6924 / Avg. batch time: 507.4575 (ms) / GPU bubble ratio: 11.81%
[rank2]:2025-11-05 06:20:21,876 - INFO - Avg. fwd time: 7.1302 / Avg. bwd time: 18.7691 / Avg. batch time: 539.3705 (ms) / GPU bubble ratio: 61.59%
[rank0]:2025-11-05 06:20:21,923 - INFO - Avg. fwd time: 7.8248 / Avg. bwd time: 23.3905 / Avg. batch time: 615.9042 (ms) / GPU bubble ratio: 59.45%
[rank1]:2025-11-05 06:20:21,916 - INFO - Avg. fwd time: 9.0624 / Avg. bwd time: 23.9156 / Avg. batch time: 578.8748 (ms) / GPU bubble ratio: 54.42%
[rank2]:2025-11-05 06:20:22,098 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3400  memory: 11.81GiB(24.85%)  tps: 6,435  tflops: 49.01  mfu: 15.71%
[rank1]:2025-11-05 06:20:22,102 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3400  memory: 14.64GiB(30.82%)  tps: 6,435  tflops: 49.01  mfu: 15.71%
[rank3]:2025-11-05 06:20:22,110 - INFO -  step: 50  loss:  9.2040  grad_norm: 15.3400  memory: 26.98GiB(56.79%)  tps: 6,435  tflops: 49.01  mfu: 15.71%
[rank0]:2025-11-05 06:20:22,112 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3400  memory: 16.57GiB(34.88%)  tps: 6,436  tflops: 49.02  mfu: 15.71%
[rank3]:2025-11-05 06:20:47,697 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-05 06:21:13,099 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank2]:2025-11-05 06:21:13,472 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,414 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-05 06:21:13,467 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,485 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,472 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,485 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,496 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,505 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,515 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 06:21:13,491 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 06:21:13,507 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 06:21:13,544 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,483 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,507 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,524 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,553 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,498 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,524 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,560 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 06:21:13,580 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 06:21:13,665 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,596 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,643 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:13,680 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,706 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,745 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 06:21:13,704 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 06:21:13,747 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,683 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,723 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,765 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 06:21:13,787 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 06:21:13,808 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 06:21:47,332 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-05 06:21:47,531 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0621_max_batch_time.svg
[rank3]:> Batch Time: 549.25 ms, GPU Bubble Ratio: 54.05%, 51.64%, 61.99%, 17.44%
[rank3]:2025-11-05 06:21:47,675 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0621_min_batch_time.svg
[rank3]:> Batch Time: 320.24 ms, GPU Bubble Ratio: 80.42%, 50.97%, 61.43%, 14.95%
[rank3]:2025-11-05 06:21:47,831 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0621_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 370.16 ms, GPU Bubble Ratio: 44.95%, 35.91%, 46.47%, 12.94%
[rank3]:2025-11-05 06:21:47,832 - INFO - 	> Batch Time: 370.16 ms (Average Freeze Ratio: 0.34, Time Reduction Rate: 0.33)
[rank0]:2025-11-05 06:22:02,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:22:04,133 - INFO - Avg. fwd time: 8.1627 / Avg. bwd time: 16.8652 / Avg. batch time: 559.6170 (ms) / GPU bubble ratio: 64.22%
[rank3]:2025-11-05 06:22:04,317 - INFO - Avg. fwd time: 11.9729 / Avg. bwd time: 38.6751 / Avg. batch time: 464.9421 (ms) / GPU bubble ratio: 12.85%
[rank1]:2025-11-05 06:22:04,405 - INFO - Avg. fwd time: 9.6053 / Avg. bwd time: 20.2143 / Avg. batch time: 529.7187 (ms) / GPU bubble ratio: 54.97%
[rank2]:2025-11-05 06:22:04,356 - INFO - Avg. fwd time: 7.5701 / Avg. bwd time: 15.8744 / Avg. batch time: 494.5191 (ms) / GPU bubble ratio: 62.07%
[rank0]:2025-11-05 06:22:04,503 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.02/0.05, [MB5] 0.15/0.45, [MB6] 0.18/0.55, [MB7] 0.33/1.00
[rank0]:2025-11-05 06:22:04,504 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 8,001  tflops: 60.93  mfu: 19.53%
[rank1]:2025-11-05 06:22:04,503 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.03/0.10, [MB4] 0.03/0.09, [MB5] 0.02/0.07, [MB6] 0.27/0.82, [MB7] 0.33/1.00
[rank1]:2025-11-05 06:22:04,504 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 8,000  tflops: 60.93  mfu: 19.53%
[rank2]:2025-11-05 06:22:04,490 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-05 06:22:04,502 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 8,000  tflops: 60.93  mfu: 19.53%
[rank3]:2025-11-05 06:22:04,491 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.33/1.00, [MB3] 0.20/0.60, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-05 06:22:04,503 - INFO -  step: 100  loss:  4.7652  grad_norm:  0.0000  memory: 31.43GiB(66.17%)  tps: 8,001  tflops: 60.93  mfu: 19.53%
[rank0]:2025-11-05 06:22:04,561 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0622_stage0_step100.svg
[rank1]:2025-11-05 06:22:04,561 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0622_stage1_step100.svg
[rank2]:2025-11-05 06:22:04,559 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0622_stage2_step100.svg
[rank3]:2025-11-05 06:22:04,636 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0622_real_step100_rank3.svg
[rank3]:> Batch Time: 406.50 ms, GPU Bubble Ratio: 82.24%, 57.56%, 66.47%, 28.86%
[rank3]:2025-11-05 06:22:04,676 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0622_stage3_step100.svg
[rank0]:2025-11-05 06:23:58,557 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 06:24:00,781 - INFO - Avg. fwd time: 7.6848 / Avg. bwd time: 15.0768 / Avg. batch time: 495.1629 (ms) / GPU bubble ratio: 63.23%
[rank3]:2025-11-05 06:24:00,762 - INFO - Avg. fwd time: 11.9212 / Avg. bwd time: 38.9666 / Avg. batch time: 466.8233 (ms) / GPU bubble ratio: 12.79%
[rank0]:2025-11-05 06:24:00,826 - INFO - Avg. fwd time: 8.2689 / Avg. bwd time: 16.5250 / Avg. batch time: 558.5363 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-11-05 06:24:00,857 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.03/0.05, [MB5] 0.30/0.45, [MB6] 0.37/0.55, [MB7] 0.67/1.00
[rank0]:2025-11-05 06:24:00,857 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.4789  memory: 16.87GiB(35.50%)  tps: 7,041  tflops: 53.62  mfu: 17.19%
[rank2]:2025-11-05 06:24:00,840 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-05 06:24:00,841 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.4789  memory: 12.12GiB(25.51%)  tps: 7,042  tflops: 53.63  mfu: 17.19%
[rank1]:2025-11-05 06:24:00,802 - INFO - Avg. fwd time: 9.7563 / Avg. bwd time: 19.1081 / Avg. batch time: 529.0816 (ms) / GPU bubble ratio: 56.36%
[rank1]:2025-11-05 06:24:00,843 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.07/0.10, [MB4] 0.06/0.09, [MB5] 0.05/0.07, [MB6] 0.55/0.82, [MB7] 0.67/1.00
[rank1]:2025-11-05 06:24:00,843 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.4789  memory: 15.11GiB(31.80%)  tps: 7,041  tflops: 53.63  mfu: 17.19%
[rank3]:2025-11-05 06:24:00,853 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.67/1.00, [MB3] 0.40/0.60, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-05 06:24:00,856 - INFO -  step: 150  loss:  2.8111  grad_norm: 19.4789  memory: 31.43GiB(66.17%)  tps: 7,041  tflops: 53.62  mfu: 17.19%
[rank0]:2025-11-05 06:25:35,737 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:25:37,100 - INFO - Avg. fwd time: 8.4030 / Avg. bwd time: 15.0151 / Avg. batch time: 539.0367 (ms) / GPU bubble ratio: 65.24%
[rank3]:2025-11-05 06:25:37,260 - INFO - Avg. fwd time: 12.1540 / Avg. bwd time: 36.8531 / Avg. batch time: 451.7438 (ms) / GPU bubble ratio: 13.21%
[rank2]:2025-11-05 06:25:37,311 - INFO - Avg. fwd time: 7.8399 / Avg. bwd time: 14.0365 / Avg. batch time: 478.7561 (ms) / GPU bubble ratio: 63.44%
[rank1]:2025-11-05 06:25:37,350 - INFO - Avg. fwd time: 9.9511 / Avg. bwd time: 17.7356 / Avg. batch time: 511.1939 (ms) / GPU bubble ratio: 56.67%
[rank3]:2025-11-05 06:25:37,453 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-05 06:25:37,456 - INFO -  step: 200  loss:  0.4847  grad_norm:  0.0797  memory: 31.86GiB(67.07%)  tps: 8,480  tflops: 64.59  mfu: 20.70%
[rank0]:2025-11-05 06:25:37,453 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.05/0.05, [MB5] 0.45/0.45, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-05 06:25:37,454 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0797  memory: 16.87GiB(35.50%)  tps: 8,481  tflops: 64.59  mfu: 20.70%
[rank2]:2025-11-05 06:25:37,452 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 06:25:37,453 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0797  memory: 12.18GiB(25.63%)  tps: 8,479  tflops: 64.58  mfu: 20.70%
[rank2]:2025-11-05 06:25:37,506 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0625_stage2_step200.svg
[rank1]:2025-11-05 06:25:37,454 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.10/0.10, [MB4] 0.09/0.09, [MB5] 0.07/0.07, [MB6] 0.82/0.82, [MB7] 1.00/1.00
[rank1]:2025-11-05 06:25:37,455 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0797  memory: 15.11GiB(31.80%)  tps: 8,479  tflops: 64.58  mfu: 20.70%
[rank1]:2025-11-05 06:25:37,505 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0625_stage1_step200.svg
[rank0]:2025-11-05 06:25:37,505 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0625_stage0_step200.svg
[rank3]:2025-11-05 06:25:37,597 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0625_real_step200_rank3.svg
[rank3]:> Batch Time: 415.25 ms, GPU Bubble Ratio: 76.17%, 57.83%, 65.52%, 29.52%
[rank3]:2025-11-05 06:25:37,641 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0625_stage3_step200.svg
[rank0]:2025-11-05 06:26:59,251 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:27:00,536 - INFO - Avg. fwd time: 8.5326 / Avg. bwd time: 11.8720 / Avg. batch time: 510.6567 (ms) / GPU bubble ratio: 68.03%
[rank3]:2025-11-05 06:27:00,716 - INFO - Avg. fwd time: 12.5190 / Avg. bwd time: 33.7099 / Avg. batch time: 429.4868 (ms) / GPU bubble ratio: 13.89%
[rank2]:2025-11-05 06:27:00,753 - INFO - Avg. fwd time: 8.0216 / Avg. bwd time: 12.8375 / Avg. batch time: 455.2053 (ms) / GPU bubble ratio: 63.34%
[rank1]:2025-11-05 06:27:00,801 - INFO - Avg. fwd time: 10.1680 / Avg. bwd time: 16.2556 / Avg. batch time: 486.0761 (ms) / GPU bubble ratio: 56.51%
[rank3]:2025-11-05 06:27:00,884 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-05 06:27:00,896 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.05/0.05, [MB5] 0.45/0.45, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-05 06:27:00,896 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,818  tflops: 74.77  mfu: 23.97%
[rank2]:2025-11-05 06:27:00,883 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 06:27:00,894 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,818  tflops: 74.77  mfu: 23.97%
[rank1]:2025-11-05 06:27:00,896 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.10/0.10, [MB4] 0.09/0.09, [MB5] 0.07/0.07, [MB6] 0.82/0.82, [MB7] 1.00/1.00
[rank1]:2025-11-05 06:27:00,897 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,818  tflops: 74.77  mfu: 23.97%
[rank3]:2025-11-05 06:27:00,896 - INFO -  step: 250  loss:  0.5374  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,818  tflops: 74.78  mfu: 23.97%
[rank0]:2025-11-05 06:28:22,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 06:28:24,255 - INFO - Avg. fwd time: 8.1400 / Avg. bwd time: 12.0574 / Avg. batch time: 439.6979 (ms) / GPU bubble ratio: 63.25%
[rank2]:2025-11-05 06:28:24,259 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-11-05 06:28:24,240 - INFO - Avg. fwd time: 12.7577 / Avg. bwd time: 31.6508 / Avg. batch time: 414.9061 (ms) / GPU bubble ratio: 14.37%
[rank3]:2025-11-05 06:28:24,255 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-05 06:28:24,281 - INFO -  step: 300  loss:  0.4892  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,825  tflops: 74.83  mfu: 23.98%
[rank0]:2025-11-05 06:28:24,278 - INFO - Avg. fwd time: 8.6148 / Avg. bwd time: 9.7948 / Avg. batch time: 491.9572 (ms) / GPU bubble ratio: 70.06%
[rank0]:2025-11-05 06:28:24,281 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.05/0.05, [MB5] 0.45/0.45, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-05 06:28:24,281 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,824  tflops: 74.82  mfu: 23.98%
[rank0]:2025-11-05 06:28:24,329 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0628_stage0_step300.svg
[rank2]:2025-11-05 06:28:24,279 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,824  tflops: 74.82  mfu: 23.98%
[rank2]:2025-11-05 06:28:24,329 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0628_stage2_step300.svg
[rank1]:2025-11-05 06:28:24,272 - INFO - Avg. fwd time: 10.3107 / Avg. bwd time: 15.2767 / Avg. batch time: 469.5318 (ms) / GPU bubble ratio: 56.40%
[rank1]:2025-11-05 06:28:24,276 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.10/0.10, [MB4] 0.09/0.09, [MB5] 0.07/0.07, [MB6] 0.82/0.82, [MB7] 1.00/1.00
[rank1]:2025-11-05 06:28:24,279 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,825  tflops: 74.83  mfu: 23.98%
[rank1]:2025-11-05 06:28:24,328 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0628_stage1_step300.svg
[rank3]:2025-11-05 06:28:24,415 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0628_real_step300_rank3.svg
[rank3]:> Batch Time: 404.00 ms, GPU Bubble Ratio: 82.16%, 57.09%, 66.16%, 28.89%
[rank3]:2025-11-05 06:28:24,456 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0628_stage3_step300.svg
[rank0]:2025-11-05 06:29:46,233 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:29:47,519 - INFO - Avg. fwd time: 8.6663 / Avg. bwd time: 8.5175 / Avg. batch time: 480.6074 (ms) / GPU bubble ratio: 71.40%
[rank3]:2025-11-05 06:29:47,700 - INFO - Avg. fwd time: 12.9074 / Avg. bwd time: 30.3916 / Avg. batch time: 406.0176 (ms) / GPU bubble ratio: 14.69%
[rank2]:2025-11-05 06:29:47,738 - INFO - Avg. fwd time: 8.2133 / Avg. bwd time: 11.5781 / Avg. batch time: 430.3089 (ms) / GPU bubble ratio: 63.21%
[rank2]:2025-11-05 06:29:47,875 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,800  tflops: 74.64  mfu: 23.92%
[rank1]:2025-11-05 06:29:47,785 - INFO - Avg. fwd time: 10.3997 / Avg. bwd time: 14.6772 / Avg. batch time: 459.5080 (ms) / GPU bubble ratio: 56.34%
[rank1]:2025-11-05 06:29:47,877 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,799  tflops: 74.63  mfu: 23.92%
[rank3]:2025-11-05 06:29:47,877 - INFO -  step: 350  loss:  0.5379  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,800  tflops: 74.64  mfu: 23.92%
[rank0]:2025-11-05 06:29:47,877 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,800  tflops: 74.64  mfu: 23.92%
[rank0]:2025-11-05 06:31:09,750 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:31:11,064 - INFO - Avg. fwd time: 8.7116 / Avg. bwd time: 7.3928 / Avg. batch time: 470.5611 (ms) / GPU bubble ratio: 72.62%
[rank2]:2025-11-05 06:31:11,288 - INFO - Avg. fwd time: 8.2777 / Avg. bwd time: 11.1564 / Avg. batch time: 421.9900 (ms) / GPU bubble ratio: 63.16%
[rank3]:2025-11-05 06:31:11,249 - INFO - Avg. fwd time: 13.0397 / Avg. bwd time: 29.2845 / Avg. batch time: 398.2101 (ms) / GPU bubble ratio: 14.97%
[rank1]:2025-11-05 06:31:11,336 - INFO - Avg. fwd time: 10.4782 / Avg. bwd time: 14.1493 / Avg. batch time: 450.6291 (ms) / GPU bubble ratio: 56.28%
[rank0]:2025-11-05 06:31:11,432 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,804  tflops: 74.67  mfu: 23.93%
[rank1]:2025-11-05 06:31:11,432 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,804  tflops: 74.67  mfu: 23.93%
[rank1]:2025-11-05 06:31:11,483 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0631_stage1_step400.svg
[rank2]:2025-11-05 06:31:11,430 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,804  tflops: 74.67  mfu: 23.93%
[rank2]:2025-11-05 06:31:11,483 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0631_stage2_step400.svg
[rank3]:2025-11-05 06:31:11,431 - INFO -  step: 400  loss:  0.4985  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,805  tflops: 74.67  mfu: 23.93%
[rank0]:2025-11-05 06:31:11,483 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0631_stage0_step400.svg
[rank3]:2025-11-05 06:31:11,566 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0631_real_step400_rank3.svg
[rank3]:> Batch Time: 404.75 ms, GPU Bubble Ratio: 82.19%, 57.16%, 66.22%, 29.05%
[rank3]:2025-11-05 06:31:11,612 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0631_stage3_step400.svg
[rank3]:2025-11-05 06:31:20,216 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 06:31:20,382 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 06:31:20,371 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 06:31:20,383 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 06:32:33,307 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:32:34,976 - INFO - Avg. fwd time: 8.7465 / Avg. bwd time: 6.5305 / Avg. batch time: 462.9077 (ms) / GPU bubble ratio: 73.60%
[rank0]:2025-11-05 06:32:34,979 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,805  tflops: 74.68  mfu: 23.94%
[rank1]:2025-11-05 06:32:34,969 - INFO - Avg. fwd time: 10.5380 / Avg. bwd time: 13.7445 / Avg. batch time: 443.8690 (ms) / GPU bubble ratio: 56.23%
[rank1]:2025-11-05 06:32:34,977 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,806  tflops: 74.68  mfu: 23.94%
[rank3]:2025-11-05 06:32:34,935 - INFO - Avg. fwd time: 13.1408 / Avg. bwd time: 28.4348 / Avg. batch time: 392.2146 (ms) / GPU bubble ratio: 15.20%
[rank3]:2025-11-05 06:32:34,978 - INFO -  step: 450  loss:  0.5383  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,805  tflops: 74.68  mfu: 23.94%
[rank2]:2025-11-05 06:32:34,951 - INFO - Avg. fwd time: 8.3268 / Avg. bwd time: 10.8330 / Avg. batch time: 415.6574 (ms) / GPU bubble ratio: 63.12%
[rank2]:2025-11-05 06:32:34,977 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,805  tflops: 74.68  mfu: 23.94%
[rank0]:2025-11-05 06:33:56,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:33:58,237 - INFO - Avg. fwd time: 8.7701 / Avg. bwd time: 5.9370 / Avg. batch time: 457.6564 (ms) / GPU bubble ratio: 74.29%
[rank2]:2025-11-05 06:33:58,462 - INFO - Avg. fwd time: 8.3612 / Avg. bwd time: 10.6108 / Avg. batch time: 411.3177 (ms) / GPU bubble ratio: 63.10%
[rank3]:2025-11-05 06:33:58,423 - INFO - Avg. fwd time: 13.2128 / Avg. bwd time: 27.8553 / Avg. batch time: 388.1491 (ms) / GPU bubble ratio: 15.36%
[rank1]:2025-11-05 06:33:58,510 - INFO - Avg. fwd time: 10.5798 / Avg. bwd time: 13.4662 / Avg. batch time: 439.2348 (ms) / GPU bubble ratio: 56.20%
[rank2]:2025-11-05 06:33:58,603 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,796  tflops: 74.61  mfu: 23.91%
[rank3]:2025-11-05 06:33:58,604 - INFO -  step: 500  loss:  0.5267  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,796  tflops: 74.61  mfu: 23.91%
[rank1]:2025-11-05 06:33:58,605 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,796  tflops: 74.61  mfu: 23.91%
[rank0]:2025-11-05 06:33:58,605 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,796  tflops: 74.61  mfu: 23.91%
[rank0]:2025-11-05 06:33:58,653 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0633_stage0_step500.svg
[rank2]:2025-11-05 06:33:58,652 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0633_stage2_step500.svg
[rank1]:2025-11-05 06:33:58,652 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0633_stage1_step500.svg
[rank3]:2025-11-05 06:33:58,740 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0633_real_step500_rank3.svg
[rank3]:> Batch Time: 405.50 ms, GPU Bubble Ratio: 82.22%, 57.23%, 66.27%, 29.02%
[rank3]:2025-11-05 06:33:58,782 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0633_stage3_step500.svg
[rank0]:2025-11-05 06:35:20,684 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:35:21,986 - INFO - Avg. fwd time: 8.7927 / Avg. bwd time: 5.3679 / Avg. batch time: 452.6625 (ms) / GPU bubble ratio: 74.97%
[rank2]:2025-11-05 06:35:22,208 - INFO - Avg. fwd time: 8.3943 / Avg. bwd time: 10.3980 / Avg. batch time: 407.1991 (ms) / GPU bubble ratio: 63.08%
[rank3]:2025-11-05 06:35:22,170 - INFO - Avg. fwd time: 13.2812 / Avg. bwd time: 27.2996 / Avg. batch time: 384.2478 (ms) / GPU bubble ratio: 15.51%
[rank1]:2025-11-05 06:35:22,255 - INFO - Avg. fwd time: 10.6192 / Avg. bwd time: 13.1995 / Avg. batch time: 434.8324 (ms) / GPU bubble ratio: 56.18%
[rank0]:2025-11-05 06:35:22,349 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,782  tflops: 74.50  mfu: 23.88%
[rank1]:2025-11-05 06:35:22,349 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,782  tflops: 74.50  mfu: 23.88%
[rank2]:2025-11-05 06:35:22,347 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,782  tflops: 74.50  mfu: 23.88%
[rank3]:2025-11-05 06:35:22,348 - INFO -  step: 550  loss:  0.5962  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,782  tflops: 74.50  mfu: 23.88%
[rank0]:2025-11-05 06:36:44,208 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:36:45,915 - INFO - Avg. fwd time: 8.8120 / Avg. bwd time: 4.8984 / Avg. batch time: 448.4948 (ms) / GPU bubble ratio: 75.54%
[rank0]:2025-11-05 06:36:45,918 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank2]:2025-11-05 06:36:45,889 - INFO - Avg. fwd time: 8.4216 / Avg. bwd time: 10.2224 / Avg. batch time: 403.7498 (ms) / GPU bubble ratio: 63.06%
[rank2]:2025-11-05 06:36:45,916 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank1]:2025-11-05 06:36:45,907 - INFO - Avg. fwd time: 10.6525 / Avg. bwd time: 12.9794 / Avg. batch time: 431.1514 (ms) / GPU bubble ratio: 56.15%
[rank1]:2025-11-05 06:36:45,916 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank3]:2025-11-05 06:36:45,872 - INFO - Avg. fwd time: 13.3378 / Avg. bwd time: 26.8399 / Avg. batch time: 381.0180 (ms) / GPU bubble ratio: 15.64%
[rank3]:2025-11-05 06:36:45,918 - INFO -  step: 600  loss:  0.4997  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank0]:2025-11-05 06:36:45,966 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0636_stage0_step600.svg
[rank2]:2025-11-05 06:36:45,967 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0636_stage2_step600.svg
[rank1]:2025-11-05 06:36:45,966 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0636_stage1_step600.svg
[rank3]:2025-11-05 06:36:46,053 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0636_real_step600_rank3.svg
[rank3]:> Batch Time: 405.75 ms, GPU Bubble Ratio: 82.21%, 57.23%, 66.27%, 28.91%
[rank3]:2025-11-05 06:36:46,096 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0636_stage3_step600.svg
[rank0]:2025-11-05 06:38:07,924 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:38:09,213 - INFO - Avg. fwd time: 8.8256 / Avg. bwd time: 4.5568 / Avg. batch time: 445.4924 (ms) / GPU bubble ratio: 75.97%
[rank2]:2025-11-05 06:38:09,435 - INFO - Avg. fwd time: 8.4413 / Avg. bwd time: 10.0945 / Avg. batch time: 401.2722 (ms) / GPU bubble ratio: 63.05%
[rank3]:2025-11-05 06:38:09,397 - INFO - Avg. fwd time: 13.3787 / Avg. bwd time: 26.5048 / Avg. batch time: 378.6616 (ms) / GPU bubble ratio: 15.74%
[rank1]:2025-11-05 06:38:09,482 - INFO - Avg. fwd time: 10.6764 / Avg. bwd time: 12.8193 / Avg. batch time: 428.5040 (ms) / GPU bubble ratio: 56.13%
[rank1]:2025-11-05 06:38:09,571 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,793  tflops: 74.58  mfu: 23.90%
[rank0]:2025-11-05 06:38:09,571 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,793  tflops: 74.58  mfu: 23.91%
[rank2]:2025-11-05 06:38:09,569 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,793  tflops: 74.58  mfu: 23.91%
[rank3]:2025-11-05 06:38:09,571 - INFO -  step: 650  loss:  0.5490  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,793  tflops: 74.59  mfu: 23.91%
[rank0]:2025-11-05 06:39:31,184 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:39:32,498 - INFO - Avg. fwd time: 8.8388 / Avg. bwd time: 4.2140 / Avg. batch time: 442.3439 (ms) / GPU bubble ratio: 76.39%
[rank2]:2025-11-05 06:39:32,723 - INFO - Avg. fwd time: 8.4606 / Avg. bwd time: 9.9653 / Avg. batch time: 398.6532 (ms) / GPU bubble ratio: 63.02%
[rank3]:2025-11-05 06:39:32,685 - INFO - Avg. fwd time: 13.4166 / Avg. bwd time: 26.1608 / Avg. batch time: 376.2078 (ms) / GPU bubble ratio: 15.84%
[rank1]:2025-11-05 06:39:32,772 - INFO - Avg. fwd time: 10.6992 / Avg. bwd time: 12.6572 / Avg. batch time: 425.7124 (ms) / GPU bubble ratio: 56.11%
[rank0]:2025-11-05 06:39:32,864 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,835  tflops: 74.91  mfu: 24.01%
[rank3]:2025-11-05 06:39:32,863 - INFO -  step: 700  loss:  0.4965  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,835  tflops: 74.91  mfu: 24.01%
[rank1]:2025-11-05 06:39:32,864 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,835  tflops: 74.91  mfu: 24.01%
[rank2]:2025-11-05 06:39:32,862 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,835  tflops: 74.91  mfu: 24.01%
[rank2]:2025-11-05 06:39:32,915 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0639_stage2_step700.svg
[rank0]:2025-11-05 06:39:32,915 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0639_stage0_step700.svg
[rank1]:2025-11-05 06:39:32,914 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0639_stage1_step700.svg
[rank3]:2025-11-05 06:39:33,002 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0639_real_step700_rank3.svg
[rank3]:> Batch Time: 404.50 ms, GPU Bubble Ratio: 82.20%, 57.23%, 66.24%, 29.16%
[rank3]:2025-11-05 06:39:33,046 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0639_stage3_step700.svg
[rank0]:2025-11-05 06:40:54,711 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 06:40:56,368 - INFO - Avg. fwd time: 8.4772 / Avg. bwd time: 9.8541 / Avg. batch time: 396.4595 (ms) / GPU bubble ratio: 63.01%
[rank3]:2025-11-05 06:40:56,349 - INFO - Avg. fwd time: 13.4498 / Avg. bwd time: 25.8673 / Avg. batch time: 374.1213 (ms) / GPU bubble ratio: 15.93%
[rank3]:2025-11-05 06:40:56,398 - INFO -  step: 750  loss:  0.5904  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank1]:2025-11-05 06:40:56,387 - INFO - Avg. fwd time: 10.7184 / Avg. bwd time: 12.5178 / Avg. batch time: 423.3715 (ms) / GPU bubble ratio: 56.09%
[rank1]:2025-11-05 06:40:56,397 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank2]:2025-11-05 06:40:56,397 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank0]:2025-11-05 06:40:56,396 - INFO - Avg. fwd time: 8.8501 / Avg. bwd time: 3.9191 / Avg. batch time: 439.6974 (ms) / GPU bubble ratio: 76.77%
[rank0]:2025-11-05 06:40:56,399 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank0]:2025-11-05 06:42:18,129 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:42:19,449 - INFO - Avg. fwd time: 8.8587 / Avg. bwd time: 3.6974 / Avg. batch time: 437.6827 (ms) / GPU bubble ratio: 77.05%
[rank2]:2025-11-05 06:42:19,675 - INFO - Avg. fwd time: 8.4897 / Avg. bwd time: 9.7708 / Avg. batch time: 394.7869 (ms) / GPU bubble ratio: 63.00%
[rank3]:2025-11-05 06:42:19,637 - INFO - Avg. fwd time: 13.4751 / Avg. bwd time: 25.6468 / Avg. batch time: 372.5574 (ms) / GPU bubble ratio: 15.99%
[rank1]:2025-11-05 06:42:19,725 - INFO - Avg. fwd time: 10.7337 / Avg. bwd time: 12.4133 / Avg. batch time: 421.5879 (ms) / GPU bubble ratio: 56.08%
[rank3]:2025-11-05 06:42:19,815 - INFO -  step: 800  loss:  0.5015  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,821  tflops: 74.80  mfu: 23.97%
[rank1]:2025-11-05 06:42:19,816 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,820  tflops: 74.79  mfu: 23.97%
[rank2]:2025-11-05 06:42:19,814 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,821  tflops: 74.80  mfu: 23.97%
[rank2]:2025-11-05 06:42:19,868 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0642_stage2_step800.svg
[rank0]:2025-11-05 06:42:19,816 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,821  tflops: 74.80  mfu: 23.97%
[rank0]:2025-11-05 06:42:19,867 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0642_stage0_step800.svg
[rank1]:2025-11-05 06:42:19,867 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0642_stage1_step800.svg
[rank3]:2025-11-05 06:42:19,952 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0642_real_step800_rank3.svg
[rank3]:> Batch Time: 404.00 ms, GPU Bubble Ratio: 82.19%, 57.10%, 66.16%, 29.02%
[rank3]:2025-11-05 06:42:19,998 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0642_stage3_step800.svg
[rank3]:2025-11-05 06:42:37,730 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 06:42:37,897 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 06:42:37,885 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 06:42:37,897 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 06:43:41,695 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:43:42,986 - INFO - Avg. fwd time: 8.8676 / Avg. bwd time: 3.4685 / Avg. batch time: 435.6675 (ms) / GPU bubble ratio: 77.35%
[rank2]:2025-11-05 06:43:43,209 - INFO - Avg. fwd time: 8.5028 / Avg. bwd time: 9.6849 / Avg. batch time: 393.1263 (ms) / GPU bubble ratio: 62.99%
[rank3]:2025-11-05 06:43:43,171 - INFO - Avg. fwd time: 13.5022 / Avg. bwd time: 25.4225 / Avg. batch time: 370.9793 (ms) / GPU bubble ratio: 16.06%
[rank1]:2025-11-05 06:43:43,256 - INFO - Avg. fwd time: 10.7491 / Avg. bwd time: 12.3055 / Avg. batch time: 419.8112 (ms) / GPU bubble ratio: 56.07%
[rank1]:2025-11-05 06:43:43,348 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank0]:2025-11-05 06:43:43,349 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank2]:2025-11-05 06:43:43,346 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank3]:2025-11-05 06:43:43,347 - INFO -  step: 850  loss:  0.5406  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,807  tflops: 74.69  mfu: 23.94%
[rank0]:2025-11-05 06:45:05,243 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 06:45:06,926 - INFO - Avg. fwd time: 8.5146 / Avg. bwd time: 9.6092 / Avg. batch time: 391.6498 (ms) / GPU bubble ratio: 62.98%
[rank3]:2025-11-05 06:45:06,908 - INFO - Avg. fwd time: 13.5269 / Avg. bwd time: 25.2257 / Avg. batch time: 369.6014 (ms) / GPU bubble ratio: 16.12%
[rank1]:2025-11-05 06:45:06,945 - INFO - Avg. fwd time: 10.7636 / Avg. bwd time: 12.2107 / Avg. batch time: 418.2363 (ms) / GPU bubble ratio: 56.05%
[rank1]:2025-11-05 06:45:06,956 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,798  tflops: 74.62  mfu: 23.92%
[rank0]:2025-11-05 06:45:06,955 - INFO - Avg. fwd time: 8.8758 / Avg. bwd time: 3.2663 / Avg. batch time: 433.8841 (ms) / GPU bubble ratio: 77.61%
[rank0]:2025-11-05 06:45:06,958 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,798  tflops: 74.62  mfu: 23.92%
[rank2]:2025-11-05 06:45:06,956 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,798  tflops: 74.62  mfu: 23.92%
[rank2]:2025-11-05 06:45:07,004 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0645_stage2_step900.svg
[rank3]:2025-11-05 06:45:06,957 - INFO -  step: 900  loss:  0.4766  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,798  tflops: 74.62  mfu: 23.92%
[rank1]:2025-11-05 06:45:07,004 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0645_stage1_step900.svg
[rank0]:2025-11-05 06:45:07,004 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0645_stage0_step900.svg
[rank3]:2025-11-05 06:45:07,093 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0645_real_step900_rank3.svg
[rank3]:> Batch Time: 405.50 ms, GPU Bubble Ratio: 82.22%, 57.24%, 66.25%, 28.92%
[rank3]:2025-11-05 06:45:07,133 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0645_stage3_step900.svg
[rank0]:2025-11-05 06:46:28,994 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:46:30,296 - INFO - Avg. fwd time: 8.8823 / Avg. bwd time: 3.1109 / Avg. batch time: 432.5329 (ms) / GPU bubble ratio: 77.82%
[rank2]:2025-11-05 06:46:30,516 - INFO - Avg. fwd time: 8.5237 / Avg. bwd time: 9.5510 / Avg. batch time: 390.5359 (ms) / GPU bubble ratio: 62.97%
[rank3]:2025-11-05 06:46:30,479 - INFO - Avg. fwd time: 13.5458 / Avg. bwd time: 25.0740 / Avg. batch time: 368.5387 (ms) / GPU bubble ratio: 16.17%
[rank1]:2025-11-05 06:46:30,563 - INFO - Avg. fwd time: 10.7748 / Avg. bwd time: 12.1379 / Avg. batch time: 417.0454 (ms) / GPU bubble ratio: 56.05%
[rank1]:2025-11-05 06:46:30,653 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,788  tflops: 74.55  mfu: 23.89%
[rank0]:2025-11-05 06:46:30,653 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,788  tflops: 74.55  mfu: 23.89%
[rank2]:2025-11-05 06:46:30,651 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,788  tflops: 74.55  mfu: 23.89%
[rank3]:2025-11-05 06:46:30,652 - INFO -  step: 950  loss:  0.5623  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,788  tflops: 74.55  mfu: 23.89%
[rank0]:2025-11-05 06:47:52,312 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:47:53,631 - INFO - Avg. fwd time: 8.8887 / Avg. bwd time: 2.9472 / Avg. batch time: 431.0178 (ms) / GPU bubble ratio: 78.03%
[rank2]:2025-11-05 06:47:53,858 - INFO - Avg. fwd time: 8.5329 / Avg. bwd time: 9.4895 / Avg. batch time: 389.2718 (ms) / GPU bubble ratio: 62.96%
[rank3]:2025-11-05 06:47:53,820 - INFO - Avg. fwd time: 13.5634 / Avg. bwd time: 24.9091 / Avg. batch time: 367.3581 (ms) / GPU bubble ratio: 16.22%
[rank1]:2025-11-05 06:47:53,907 - INFO - Avg. fwd time: 10.7860 / Avg. bwd time: 12.0605 / Avg. batch time: 415.6991 (ms) / GPU bubble ratio: 56.03%
[rank0]:2025-11-05 06:47:53,996 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,829  tflops: 74.86  mfu: 23.99%
[rank2]:2025-11-05 06:47:53,994 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,829  tflops: 74.86  mfu: 23.99%
[rank2]:2025-11-05 06:47:54,044 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0647_stage2_step1000.svg
[rank3]:2025-11-05 06:47:53,996 - INFO -  step: 1000  loss:  0.5314  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,829  tflops: 74.86  mfu: 23.99%
[rank1]:2025-11-05 06:47:53,996 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,829  tflops: 74.86  mfu: 23.99%
[rank1]:2025-11-05 06:47:54,043 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0647_stage1_step1000.svg
[rank0]:2025-11-05 06:47:54,043 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0647_stage0_step1000.svg
[rank3]:2025-11-05 06:47:54,132 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0647_real_step1000_rank3.svg
[rank3]:> Batch Time: 403.75 ms, GPU Bubble Ratio: 82.22%, 57.15%, 66.17%, 29.17%
[rank3]:2025-11-05 06:47:54,175 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0647_stage3_step1000.svg
[rank0]:2025-11-05 06:49:15,770 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 06:49:17,432 - INFO - Avg. fwd time: 8.5412 / Avg. bwd time: 9.4339 / Avg. batch time: 388.1586 (ms) / GPU bubble ratio: 62.95%
[rank2]:2025-11-05 06:49:17,464 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,814  tflops: 74.75  mfu: 23.96%
[rank3]:2025-11-05 06:49:17,413 - INFO - Avg. fwd time: 13.5793 / Avg. bwd time: 24.7603 / Avg. batch time: 366.2942 (ms) / GPU bubble ratio: 16.26%
[rank3]:2025-11-05 06:49:17,465 - INFO -  step: 1050  loss:  0.6036  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,815  tflops: 74.75  mfu: 23.96%
[rank1]:2025-11-05 06:49:17,453 - INFO - Avg. fwd time: 10.7963 / Avg. bwd time: 11.9906 / Avg. batch time: 414.5139 (ms) / GPU bubble ratio: 56.02%
[rank1]:2025-11-05 06:49:17,464 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,815  tflops: 74.75  mfu: 23.96%
[rank0]:2025-11-05 06:49:17,463 - INFO - Avg. fwd time: 8.8944 / Avg. bwd time: 2.8000 / Avg. batch time: 429.6807 (ms) / GPU bubble ratio: 78.23%
[rank0]:2025-11-05 06:49:17,466 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,814  tflops: 74.75  mfu: 23.96%
[rank0]:2025-11-05 06:50:39,162 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:50:40,483 - INFO - Avg. fwd time: 8.8988 / Avg. bwd time: 2.6850 / Avg. batch time: 428.6245 (ms) / GPU bubble ratio: 78.38%
[rank3]:2025-11-05 06:50:40,672 - INFO - Avg. fwd time: 13.5921 / Avg. bwd time: 24.6450 / Avg. batch time: 365.4731 (ms) / GPU bubble ratio: 16.30%
[rank2]:2025-11-05 06:50:40,710 - INFO - Avg. fwd time: 8.5476 / Avg. bwd time: 9.3907 / Avg. batch time: 387.2785 (ms) / GPU bubble ratio: 62.94%
[rank1]:2025-11-05 06:50:40,760 - INFO - Avg. fwd time: 10.8045 / Avg. bwd time: 11.9365 / Avg. batch time: 413.5773 (ms) / GPU bubble ratio: 56.01%
[rank0]:2025-11-05 06:50:40,847 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,825  tflops: 74.83  mfu: 23.98%
[rank2]:2025-11-05 06:50:40,845 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,825  tflops: 74.83  mfu: 23.98%
[rank2]:2025-11-05 06:50:40,895 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0650_stage2_step1100.svg
[rank1]:2025-11-05 06:50:40,847 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,825  tflops: 74.83  mfu: 23.98%
[rank1]:2025-11-05 06:50:40,894 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0650_stage1_step1100.svg
[rank3]:2025-11-05 06:50:40,846 - INFO -  step: 1100  loss:  0.5296  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,825  tflops: 74.83  mfu: 23.98%
[rank0]:2025-11-05 06:50:40,894 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0650_stage0_step1100.svg
[rank3]:2025-11-05 06:50:40,983 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0650_real_step1100_rank3.svg
[rank3]:> Batch Time: 403.50 ms, GPU Bubble Ratio: 82.14%, 57.04%, 66.13%, 28.97%
[rank3]:2025-11-05 06:50:41,025 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0650_stage3_step1100.svg
[rank0]:2025-11-05 06:52:02,762 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 06:52:04,059 - INFO - Avg. fwd time: 8.9038 / Avg. bwd time: 2.5622 / Avg. batch time: 427.5448 (ms) / GPU bubble ratio: 78.55%
[rank2]:2025-11-05 06:52:04,281 - INFO - Avg. fwd time: 8.5546 / Avg. bwd time: 9.3446 / Avg. batch time: 386.3871 (ms) / GPU bubble ratio: 62.94%
[rank3]:2025-11-05 06:52:04,244 - INFO - Avg. fwd time: 13.6067 / Avg. bwd time: 24.5244 / Avg. batch time: 364.6229 (ms) / GPU bubble ratio: 16.34%
[rank1]:2025-11-05 06:52:04,329 - INFO - Avg. fwd time: 10.8133 / Avg. bwd time: 11.8787 / Avg. batch time: 412.6255 (ms) / GPU bubble ratio: 56.00%
[rank2]:2025-11-05 06:52:04,413 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank3]:2025-11-05 06:52:04,414 - INFO -  step: 1150  loss:  0.5611  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank0]:2025-11-05 06:52:04,415 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank1]:2025-11-05 06:52:04,415 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,803  tflops: 74.66  mfu: 23.93%
[rank0]:2025-11-05 06:53:26,187 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-05 06:53:27,900 - INFO - Avg. fwd time: 10.8220 / Avg. bwd time: 11.8259 / Avg. batch time: 411.7413 (ms) / GPU bubble ratio: 56.00%
[rank1]:2025-11-05 06:53:27,912 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank1]:2025-11-05 06:53:27,912 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0000  tps: 9,669  tflops: 73.64  mfu: 22.29%
[rank1]:2025-11-05 06:53:27,912 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-05 06:53:27,913 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-05 06:53:27,878 - INFO - Avg. fwd time: 8.5612 / Avg. bwd time: 9.3026 / Avg. batch time: 385.5569 (ms) / GPU bubble ratio: 62.93%
[rank2]:2025-11-05 06:53:27,912 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 12.18GiB(25.63%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank2]:2025-11-05 06:53:27,912 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0000  tps: 9,672  tflops: 73.66  mfu: 22.31%
[rank2]:2025-11-05 06:53:27,912 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-05 06:53:27,913 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-05 06:53:27,859 - INFO - Avg. fwd time: 13.6200 / Avg. bwd time: 24.4147 / Avg. batch time: 363.8503 (ms) / GPU bubble ratio: 16.37%
[rank3]:2025-11-05 06:53:27,913 - INFO -  step: 1200  loss:  0.5308  grad_norm:  0.0000  memory: 31.86GiB(67.07%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank3]:2025-11-05 06:53:27,914 - INFO -  final step: 1200  loss:  0.5308  grad_norm:  0.0000  tps: 9,678  tflops: 73.71  mfu: 22.37%
[rank3]:2025-11-05 06:53:27,914 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-05 06:53:27,915 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-05 06:53:27,911 - INFO - Avg. fwd time: 8.9084 / Avg. bwd time: 2.4502 / Avg. batch time: 426.5450 (ms) / GPU bubble ratio: 78.70%
[rank0]:2025-11-05 06:53:27,914 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 16.87GiB(35.50%)  tps: 9,811  tflops: 74.72  mfu: 23.95%
[rank0]:2025-11-05 06:53:27,914 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.0000  tps: 9,671  tflops: 73.65  mfu: 22.30%
[rank0]:2025-11-05 06:53:27,914 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-05 06:53:27,914 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-05 06:53:29,878 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-05 06:53:29,939 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251105_0653_stage0_final1200.svg
[rank1]:2025-11-05 06:53:29,939 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251105_0653_stage1_final1200.svg
[rank2]:2025-11-05 06:53:29,939 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251105_0653_stage2_final1200.svg
[rank3]:2025-11-05 06:53:30,024 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0653_real_final1200_rank3.svg
[rank3]:> Batch Time: 405.75 ms, GPU Bubble Ratio: 82.27%, 57.32%, 66.32%, 29.14%
[rank1]:2025-11-05 06:53:30,090 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/frozen_params_histogram/251105_0653_rank1_stage1.svg
[rank1]:	> Counts Sum: 1194920, Total Sum: 1627200 (73.43%), Ratio(%) per element: [73.89, 73.45, 74.11, 73.56, 73.0, 73.0, 73.78, 74.33, 72.56, 73.0, 73.67, 72.67, 72.45, 73.45, 72.56, 73.56, 73.89, 73.34, 72.23, 74.44, 73.56, 74.22, 73.11, 71.23, 73.11, 72.67, 74.55, 72.78, 74.55, 74.22, 73.67, 72.56, 74.55, 73.23, 73.78, 74.55, 72.67, 73.78, 72.23, 74.0, 73.45, 73.11, 73.56, 74.0, 74.22]
[rank1]:2025-11-05 06:53:30,091 - INFO - Destroying the purge thread.
[rank2]:2025-11-05 06:53:30,094 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/frozen_params_histogram/251105_0653_rank2_stage2.svg
[rank2]:	> Counts Sum: 1124160, Total Sum: 1301760 (86.36%), Ratio(%) per element: [86.17, 86.28, 85.95, 86.17, 86.06, 86.17, 86.17, 85.95, 86.28, 86.39, 86.39, 86.28, 86.28, 86.28, 86.39, 86.17, 86.17, 86.17, 86.61, 86.17, 86.94, 86.72, 86.28, 86.72, 86.61, 86.5, 86.39, 86.39, 86.61, 86.5, 86.39, 86.5, 86.28, 86.39, 86.61, 86.39]
[rank2]:2025-11-05 06:53:30,094 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 06:53:30,096 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/frozen_params_histogram/251105_0653_rank0_stage0.svg
[rank0]:	> Counts Sum: 987880, Total Sum: 1337920 (73.84%), Ratio(%) per element: [74.44, 74.11, 72.01, 73.0, 74.22, 73.45, 73.78, 72.12, 72.34, 74.22, 74.55, 73.56, 73.0, 74.77, 73.56, 73.67, 73.34, 73.78, 71.68, 73.45, 73.78, 73.78, 73.45, 74.33, 73.67, 74.22, 74.22, 74.66, 75.0, 74.44, 72.45, 75.22, 74.55, 75.44, 75.88, 73.78, 73.89]
[rank0]:2025-11-05 06:53:30,096 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-05 06:53:30,161 - INFO - Process group destroyed
[rank3]:2025-11-05 06:53:30,167 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/pipeline_schedule/251105_0653_thry_final1200_rank3.svg
[rank3]:> Batch Time: 350.72 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-05 06:53:30,211 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251105_0653_stage3_final1200.svg
[rank3]:2025-11-05 06:53:30,343 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1/frozen_params_histogram/251105_0653_rank3_stage3.svg
[rank3]:	> Counts Sum: 335240, Total Sum: 1048640 (31.97%), Ratio(%) per element: [30.08, 31.19, 28.87, 29.42, 29.64, 30.19, 30.3, 31.19, 30.3, 29.97, 30.3, 29.97, 30.42, 30.86, 29.75, 30.64, 30.97, 30.42, 34.29, 36.39, 35.28, 34.51, 35.5, 34.73, 34.29, 34.29, 34.18, 34.62, 34.4]
[rank3]:2025-11-05 06:53:30,344 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-11-05 06:53:30,604 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 23-24, summary, console lines 283-295
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.69286
[rank3]:wandb:               final/avg_loss 0.53076
[rank3]:wandb:             final/avg_mfu(%) 22.36806
[rank3]:wandb:             final/avg_tflops 73.71206
[rank3]:wandb:    final/avg_throughput(tps) 9678.30885
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.53076
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.53076
[rank3]:wandb: loss_metrics/global_max_loss 0.53076
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_GPipe_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/basawrb8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_GPipe_timelyauto_dm1/20251105-0618/wandb/run-20251105_061810-basawrb8/logs
[rank3]:2025-11-05 06:53:31,688 - INFO - Process group destroyed
[rank0]:2025-11-05 06:53:32,097 - INFO - Training completed
[rank0]:2025-11-05 06:53:32,097 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 06:53:32,189 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.5', 'layers.8', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'layers.1', 'layers.3', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.9', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'output', 'norm', 'layers.14', 'layers.15', 'layers.13'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_GPipe_timelyauto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
