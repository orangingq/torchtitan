
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 05. (ìˆ˜) 03:38:25 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_GPipe_auto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-05 03:38:31,439 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 03:38:31,439 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-11-05 03:38:31,601 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-05 03:38:31,579 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-11-05 03:38:31,660 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-05 03:38:31,665 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-05 03:38:31,667 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 03:38:31,669 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-05 03:38:31,663 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-05 03:38:31,851 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 03:38:31,854 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-05 03:38:31,830 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-05 03:38:31,832 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 03:38:32,147 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-05 03:38:32,545 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-05 03:38:35,267 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-05 03:38:35,418 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 03:38:35,417 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-05 03:38:35,464 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 03:38:35,465 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-05 03:38:35,491 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-05 03:38:35,491 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-05 03:38:35,465 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 03:38:35,490 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-05 03:38:35,490 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-05 03:38:35,549 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-05 03:38:35,587 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 03:38:35,615 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-05 03:38:35,615 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-05 03:38:35,676 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 03:38:35,676 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 03:38:35,677 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-05 03:38:35,668 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 03:38:35,668 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-05 03:38:35,668 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-05 03:38:35,787 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 03:38:35,787 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-05 03:38:35,788 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 3tril4nr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1/20251105-0338/wandb/run-20251105_033836-3tril4nr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/3tril4nr
[rank3]:2025-11-05 03:38:37,656 - INFO - WandB logging enabled
[rank3]:2025-11-05 03:38:37,658 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-05 03:38:37,699 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 03:38:37,728 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-05 03:38:37,729 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-05 03:38:37,920 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_GPipe_auto_dm1
[rank0]:2025-11-05 03:38:37,920 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 03:38:37,921 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-11-05 03:38:37,920 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-05 03:38:37,920 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-05 03:38:37,903 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 03:38:37,904 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-05 03:38:37,904 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-05 03:38:37,920 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 03:38:43,605 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-05 03:38:43,605 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-05 03:38:46,826 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-05 03:38:46,826 - INFO - Finished loading the checkpoint in 3.22 seconds.
[rank0]:2025-11-05 03:38:46,826 - INFO - Training starts at step 1
[rank0]:2025-11-05 03:38:49,936 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8871  memory: 12.80GiB(26.95%)  tps: 1,132  tflops: 8.62  mfu: 2.76%
[rank0]:2025-11-05 03:38:49,936 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-05 03:38:49,902 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8871  memory: 12.38GiB(26.05%)  tps: 1,145  tflops: 8.72  mfu: 2.79%
[rank1]:2025-11-05 03:38:49,902 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-05 03:38:49,911 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8871  memory: 24.19GiB(50.91%)  tps: 1,342  tflops: 10.22  mfu: 3.28%
[rank3]:2025-11-05 03:38:49,911 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-05 03:38:49,901 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8871  memory:  9.99GiB(21.03%)  tps: 1,135  tflops: 8.64  mfu: 2.77%
[rank2]:2025-11-05 03:38:49,901 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 03:40:51,236 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 03:40:53,475 - INFO - Avg. fwd time: 11.1774 / Avg. bwd time: 44.2109 / Avg. batch time: 502.9704 (ms) / GPU bubble ratio: 11.90%
[rank0]:2025-11-05 03:40:53,596 - INFO - Avg. fwd time: 7.8023 / Avg. bwd time: 23.3628 / Avg. batch time: 611.0467 (ms) / GPU bubble ratio: 59.20%
[rank2]:2025-11-05 03:40:53,550 - INFO - Avg. fwd time: 7.1150 / Avg. bwd time: 18.7219 / Avg. batch time: 534.8030 (ms) / GPU bubble ratio: 61.35%
[rank1]:2025-11-05 03:40:53,589 - INFO - Avg. fwd time: 9.0042 / Avg. bwd time: 23.8046 / Avg. batch time: 574.1378 (ms) / GPU bubble ratio: 54.28%
[rank0]:2025-11-05 03:40:53,785 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4949  memory: 16.57GiB(34.88%)  tps: 6,482  tflops: 49.37  mfu: 15.82%
[rank2]:2025-11-05 03:40:53,770 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4949  memory: 11.81GiB(24.85%)  tps: 6,481  tflops: 49.36  mfu: 15.82%
[rank1]:2025-11-05 03:40:53,774 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4949  memory: 14.64GiB(30.82%)  tps: 6,481  tflops: 49.36  mfu: 15.82%
[rank3]:2025-11-05 03:40:53,782 - INFO -  step: 50  loss:  9.1994  grad_norm: 15.4949  memory: 26.98GiB(56.79%)  tps: 6,481  tflops: 49.36  mfu: 15.82%
[rank0]:2025-11-05 03:41:19,389 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-05 03:41:19,386 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-05 03:41:19,386 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-05 03:41:19,386 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-05 03:41:44,909 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 7.4943e+00
[rank2]:2025-11-05 03:41:44,894 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.8194e+00
[rank3]:2025-11-05 03:41:44,905 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8102e+00
[rank1]:2025-11-05 03:41:44,898 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.3911e+00
[rank2]:2025-11-05 03:42:08,497 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9762e+00
[rank1]:2025-11-05 03:42:08,502 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.0991e+00
[rank3]:2025-11-05 03:42:08,502 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9596e+00
[rank0]:2025-11-05 03:42:08,509 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.7566e+00
[rank3]:2025-11-05 03:42:34,051 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.8108e+00
[rank1]:2025-11-05 03:42:34,044 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.0948e+00
[rank2]:2025-11-05 03:42:34,039 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4534e+00
[rank0]:2025-11-05 03:42:34,055 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.8389e+01
[rank0]:2025-11-05 03:42:54,602 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 03:42:56,596 - INFO - Avg. fwd time: 11.3387 / Avg. bwd time: 43.5228 / Avg. batch time: 498.6612 (ms) / GPU bubble ratio: 11.99%
[rank2]:2025-11-05 03:42:56,657 - INFO - Avg. fwd time: 7.2030 / Avg. bwd time: 18.1944 / Avg. batch time: 529.4470 (ms) / GPU bubble ratio: 61.62%
[rank0]:2025-11-05 03:42:56,732 - INFO - Avg. fwd time: 7.8695 / Avg. bwd time: 22.9526 / Avg. batch time: 604.0282 (ms) / GPU bubble ratio: 59.18%
[rank1]:2025-11-05 03:42:56,744 - INFO - Avg. fwd time: 9.1137 / Avg. bwd time: 23.3617 / Avg. batch time: 567.9413 (ms) / GPU bubble ratio: 54.26%
[rank2]:2025-11-05 03:42:56,909 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1876e+00
[rank2]:2025-11-05 03:42:56,910 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.2115  memory: 11.83GiB(24.89%)  tps: 6,653  tflops: 50.67  mfu: 16.24%
[rank0]:2025-11-05 03:42:56,933 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7870e+00
[rank0]:2025-11-05 03:42:56,933 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.2115  memory: 16.57GiB(34.88%)  tps: 6,652  tflops: 50.66  mfu: 16.24%
[rank1]:2025-11-05 03:42:56,913 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0000e+00
[rank1]:2025-11-05 03:42:56,914 - INFO -  step: 100  loss: -4.0000  grad_norm: 22.2115  memory: 14.66GiB(30.86%)  tps: 6,653  tflops: 50.67  mfu: 16.24%
[rank3]:2025-11-05 03:42:56,925 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2901e+00
[rank3]:2025-11-05 03:42:56,928 - INFO -  step: 100  loss:  3.0340  grad_norm: 22.2115  memory: 28.29GiB(59.55%)  tps: 6,652  tflops: 50.67  mfu: 16.24%
[rank2]:2025-11-05 03:42:57,037 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0342_stage2_step100.svg
[rank0]:2025-11-05 03:42:57,040 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0342_stage0_step100.svg
[rank1]:2025-11-05 03:42:57,037 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0342_stage1_step100.svg
[rank3]:2025-11-05 03:42:57,136 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0342_real_step100_rank3.svg
[rank3]:> Batch Time: 560.52 ms, GPU Bubble Ratio: 58.43%, 62.86%, 72.54%, 26.63%
[rank3]:2025-11-05 03:42:57,180 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0342_stage3_step100.svg
[rank2]:2025-11-05 03:43:22,657 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8808e-01
[rank0]:2025-11-05 03:43:22,673 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.3398e+00
[rank3]:2025-11-05 03:43:22,668 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4482e+00
[rank1]:2025-11-05 03:43:22,661 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2686e+00
[rank2]:2025-11-05 03:43:45,563 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.9511e+00
[rank0]:2025-11-05 03:43:45,586 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4491e+01
[rank3]:2025-11-05 03:43:45,578 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7841e+00
[rank1]:2025-11-05 03:43:45,566 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0043e+01
[rank1]:2025-11-05 03:44:10,361 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6561e+00
[rank2]:2025-11-05 03:44:10,373 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4922e-01
[rank0]:2025-11-05 03:44:10,381 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.2479e+00
[rank3]:2025-11-05 03:44:10,384 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3273e+00
[rank2]:2025-11-05 03:44:33,243 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1533e+00
[rank3]:2025-11-05 03:44:33,258 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8880e+00
[rank0]:2025-11-05 03:44:33,266 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9540e-01
[rank1]:2025-11-05 03:44:33,246 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.8465e-01
[rank0]:2025-11-05 03:44:55,423 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 03:44:57,805 - INFO - Avg. fwd time: 11.4189 / Avg. bwd time: 43.1104 / Avg. batch time: 495.9738 (ms) / GPU bubble ratio: 12.04%
[rank1]:2025-11-05 03:44:57,849 - INFO - Avg. fwd time: 9.4625 / Avg. bwd time: 20.9244 / Avg. batch time: 561.6035 (ms) / GPU bubble ratio: 56.71%
[rank2]:2025-11-05 03:44:57,830 - INFO - Avg. fwd time: 7.3440 / Avg. bwd time: 17.2516 / Avg. batch time: 525.8132 (ms) / GPU bubble ratio: 62.58%
[rank2]:2025-11-05 03:44:57,892 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0076e+00
[rank2]:2025-11-05 03:44:57,893 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.8500  memory: 11.83GiB(24.89%)  tps: 6,771  tflops: 51.57  mfu: 16.53%
[rank3]:2025-11-05 03:44:57,904 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7549e+00
[rank3]:2025-11-05 03:44:57,907 - INFO -  step: 150  loss:  0.4879  grad_norm:  5.8500  memory: 28.29GiB(59.55%)  tps: 6,772  tflops: 51.57  mfu: 16.53%
[rank0]:2025-11-05 03:44:57,871 - INFO - Avg. fwd time: 8.0214 / Avg. bwd time: 21.8778 / Avg. batch time: 596.5010 (ms) / GPU bubble ratio: 59.90%
[rank0]:2025-11-05 03:44:57,896 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.6548e+00
[rank0]:2025-11-05 03:44:57,896 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.8500  memory: 16.57GiB(34.88%)  tps: 6,772  tflops: 51.58  mfu: 16.53%
[rank1]:2025-11-05 03:44:57,881 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.8934e+00
[rank1]:2025-11-05 03:44:57,881 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.8500  memory: 14.66GiB(30.86%)  tps: 6,772  tflops: 51.58  mfu: 16.53%
[rank3]:2025-11-05 03:45:20,844 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9224e+00
[rank2]:2025-11-05 03:45:20,828 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1102e+00
[rank0]:2025-11-05 03:45:20,851 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5313e+00
[rank1]:2025-11-05 03:45:20,832 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2761e+00
[rank1]:2025-11-05 03:45:45,496 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2351e+01
[rank3]:2025-11-05 03:45:45,520 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8830e+00
[rank2]:2025-11-05 03:45:45,508 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4819e+00
[rank0]:2025-11-05 03:45:45,512 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7573e+01
[rank1]:2025-11-05 03:46:08,039 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0285e-01
[rank3]:2025-11-05 03:46:08,054 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3197e-01
[rank2]:2025-11-05 03:46:08,039 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2630e-01
[rank0]:2025-11-05 03:46:08,054 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3610e-01
[rank1]:2025-11-05 03:46:32,748 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.1713e-01
[rank3]:2025-11-05 03:46:32,771 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1799e-01
[rank0]:2025-11-05 03:46:32,763 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.3745e-01
[rank2]:2025-11-05 03:46:32,759 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9232e-01
[rank0]:2025-11-05 03:46:53,006 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 03:46:54,955 - INFO - Avg. fwd time: 11.4681 / Avg. bwd time: 42.7953 / Avg. batch time: 493.8323 (ms) / GPU bubble ratio: 12.09%
[rank0]:2025-11-05 03:46:55,040 - INFO - Avg. fwd time: 8.1856 / Avg. bwd time: 20.7214 / Avg. batch time: 590.6098 (ms) / GPU bubble ratio: 60.84%
[rank2]:2025-11-05 03:46:55,012 - INFO - Avg. fwd time: 7.4397 / Avg. bwd time: 16.6296 / Avg. batch time: 522.9196 (ms) / GPU bubble ratio: 63.18%
[rank1]:2025-11-05 03:46:55,064 - INFO - Avg. fwd time: 9.6959 / Avg. bwd time: 19.2796 / Avg. batch time: 556.9225 (ms) / GPU bubble ratio: 58.38%
[rank0]:2025-11-05 03:46:55,268 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2684e-01
[rank0]:2025-11-05 03:46:55,268 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2249  memory: 16.57GiB(34.88%)  tps: 6,980  tflops: 53.16  mfu: 17.04%
[rank0]:2025-11-05 03:46:55,268 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-05 03:46:55,268 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.7434e-01
[rank3]:2025-11-05 03:46:55,271 - INFO -  step: 200  loss:  0.2478  grad_norm:  0.2249  memory: 28.29GiB(59.55%)  tps: 6,980  tflops: 53.16  mfu: 17.04%
[rank3]:2025-11-05 03:46:55,271 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-05 03:46:55,252 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.7709e-01
[rank2]:2025-11-05 03:46:55,253 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2249  memory: 11.83GiB(24.89%)  tps: 6,980  tflops: 53.16  mfu: 17.04%
[rank2]:2025-11-05 03:46:55,253 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-05 03:46:55,252 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3892e-01
[rank1]:2025-11-05 03:46:55,253 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2249  memory: 14.66GiB(30.86%)  tps: 6,980  tflops: 53.16  mfu: 17.04%
[rank1]:2025-11-05 03:46:55,253 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-05 03:47:17,788 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 18,189
[rank1]:2025-11-05 03:47:17,802 - INFO - validate step: 200  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 18,165
[rank0]:2025-11-05 03:47:17,879 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0347_stage0_step200.svg
[rank3]:2025-11-05 03:47:17,817 - INFO - validate step: 200  loss:  0.4473  memory: 28.29GiB(59.55%)  tps: 18,169
[rank2]:2025-11-05 03:47:17,823 - INFO - validate step: 200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 18,148
[rank2]:2025-11-05 03:47:17,880 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0347_stage2_step200.svg
[rank1]:2025-11-05 03:47:17,880 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0347_stage1_step200.svg
[rank3]:2025-11-05 03:47:17,978 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0347_real_step200_rank3.svg
[rank3]:> Batch Time: 591.84 ms, GPU Bubble Ratio: 66.54%, 67.90%, 65.06%, 25.32%
[rank3]:2025-11-05 03:47:18,023 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0347_stage3_step200.svg
[rank0]:2025-11-05 03:47:42,698 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4803e+00
[rank3]:2025-11-05 03:47:42,706 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3157e-01
[rank2]:2025-11-05 03:47:42,694 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3853e-02
[rank1]:2025-11-05 03:47:42,683 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0068e-01
[rank1]:2025-11-05 03:48:05,204 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1385e-01
[rank0]:2025-11-05 03:48:05,220 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2508e-01
[rank2]:2025-11-05 03:48:05,204 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.7757e-01
[rank3]:2025-11-05 03:48:05,220 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0374e-01
[rank1]:2025-11-05 03:48:29,907 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2007e-01
[rank0]:2025-11-05 03:48:29,922 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7885e-01
[rank2]:2025-11-05 03:48:29,919 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2420e-02
[rank3]:2025-11-05 03:48:29,931 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9154e-01
[rank1]:2025-11-05 03:48:52,450 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3879e+00
[rank0]:2025-11-05 03:48:52,466 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5195e+00
[rank2]:2025-11-05 03:48:52,450 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.6605e-01
[rank3]:2025-11-05 03:48:52,466 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3235e-01
[rank0]:2025-11-05 03:49:14,678 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-05 03:49:16,858 - INFO - Avg. fwd time: 11.4881 / Avg. bwd time: 42.6868 / Avg. batch time: 493.1127 (ms) / GPU bubble ratio: 12.11%
[rank0]:2025-11-05 03:49:16,881 - INFO - Avg. fwd time: 8.3383 / Avg. bwd time: 19.6598 / Avg. batch time: 587.1173 (ms) / GPU bubble ratio: 61.85%
[rank2]:2025-11-05 03:49:16,933 - INFO - Avg. fwd time: 7.4891 / Avg. bwd time: 16.3221 / Avg. batch time: 521.9195 (ms) / GPU bubble ratio: 63.50%
[rank1]:2025-11-05 03:49:16,911 - INFO - Avg. fwd time: 9.8805 / Avg. bwd time: 17.9881 / Avg. batch time: 554.5308 (ms) / GPU bubble ratio: 59.80%
[rank0]:2025-11-05 03:49:17,138 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0253e+00
[rank0]:2025-11-05 03:49:17,139 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2409  memory: 16.57GiB(34.88%)  tps: 6,864  tflops: 52.28  mfu: 16.76%
[rank2]:2025-11-05 03:49:17,135 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2980e-02
[rank2]:2025-11-05 03:49:17,136 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2409  memory: 11.83GiB(24.89%)  tps: 6,866  tflops: 52.29  mfu: 16.76%
[rank3]:2025-11-05 03:49:17,146 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1961e-01
[rank3]:2025-11-05 03:49:17,150 - INFO -  step: 250  loss:  0.2553  grad_norm:  0.2409  memory: 28.29GiB(59.55%)  tps: 6,865  tflops: 52.28  mfu: 16.76%
[rank1]:2025-11-05 03:49:17,123 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.7064e-01
[rank1]:2025-11-05 03:49:17,123 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2409  memory: 14.66GiB(30.86%)  tps: 6,866  tflops: 52.29  mfu: 16.76%
[rank0]:2025-11-05 03:49:39,657 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8800e-01
[rank2]:2025-11-05 03:49:39,642 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.9907e-01
[rank3]:2025-11-05 03:49:39,658 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0680e+00
[rank1]:2025-11-05 03:49:39,642 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.9780e-01
[rank0]:2025-11-05 03:50:04,406 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7704e-01
[rank2]:2025-11-05 03:50:04,403 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2565e-02
[rank3]:2025-11-05 03:50:04,414 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6909e-01
[rank1]:2025-11-05 03:50:04,391 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0147e-01
[rank0]:2025-11-05 03:50:26,939 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6576e+00
[rank2]:2025-11-05 03:50:26,924 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8933e+00
[rank1]:2025-11-05 03:50:26,923 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4100e+00
[rank3]:2025-11-05 03:50:26,939 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8287e+00
[rank1]:2025-11-05 03:50:51,606 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1972e+00
[rank3]:2025-11-05 03:50:51,629 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3621e-01
[rank0]:2025-11-05 03:50:51,621 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4670e+00
[rank2]:2025-11-05 03:50:51,618 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1681e-01
[rank0]:2025-11-05 03:51:11,829 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 03:51:14,042 - INFO - Avg. fwd time: 11.5104 / Avg. bwd time: 42.5109 / Avg. batch time: 491.8764 (ms) / GPU bubble ratio: 12.14%
[rank0]:2025-11-05 03:51:14,102 - INFO - Avg. fwd time: 8.4365 / Avg. bwd time: 18.9695 / Avg. batch time: 583.8481 (ms) / GPU bubble ratio: 62.45%
[rank2]:2025-11-05 03:51:14,060 - INFO - Avg. fwd time: 7.5410 / Avg. bwd time: 15.9894 / Avg. batch time: 520.2736 (ms) / GPU bubble ratio: 63.82%
[rank2]:2025-11-05 03:51:14,112 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.8971e-01
[rank2]:2025-11-05 03:51:14,113 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1488  memory: 11.83GiB(24.89%)  tps: 7,003  tflops: 53.34  mfu: 17.10%
[rank1]:2025-11-05 03:51:14,080 - INFO - Avg. fwd time: 9.9989 / Avg. bwd time: 17.1471 / Avg. batch time: 551.9785 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-11-05 03:51:14,112 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.6141e-01
[rank1]:2025-11-05 03:51:14,113 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1488  memory: 14.66GiB(30.86%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank3]:2025-11-05 03:51:14,128 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6680e-01
[rank3]:2025-11-05 03:51:14,131 - INFO -  step: 300  loss:  0.2363  grad_norm:  0.1488  memory: 28.29GiB(59.55%)  tps: 7,003  tflops: 53.34  mfu: 17.09%
[rank0]:2025-11-05 03:51:14,128 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1135e+00
[rank0]:2025-11-05 03:51:14,128 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1488  memory: 16.57GiB(34.88%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank0]:2025-11-05 03:51:14,181 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0351_stage0_step300.svg
[rank2]:2025-11-05 03:51:14,182 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0351_stage2_step300.svg
[rank1]:2025-11-05 03:51:14,184 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0351_stage1_step300.svg
[rank3]:2025-11-05 03:51:14,274 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0351_real_step300_rank3.svg
[rank3]:> Batch Time: 545.33 ms, GPU Bubble Ratio: 63.71%, 65.18%, 71.66%, 24.99%
[rank3]:2025-11-05 03:51:14,317 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0351_stage3_step300.svg
[rank1]:2025-11-05 03:51:38,893 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.6784e-01
[rank0]:2025-11-05 03:51:38,908 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4527e-01
[rank2]:2025-11-05 03:51:38,905 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7386e-02
[rank3]:2025-11-05 03:51:38,916 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1051e-01
[rank2]:2025-11-05 03:52:01,379 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.7712e-01
[rank1]:2025-11-05 03:52:01,379 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.1720e-01
[rank3]:2025-11-05 03:52:01,394 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0034e+00
[rank0]:2025-11-05 03:52:01,394 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5297e+00
[rank0]:2025-11-05 03:52:26,087 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5574e+00
[rank2]:2025-11-05 03:52:26,084 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8181e-02
[rank1]:2025-11-05 03:52:26,072 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4975e+00
[rank3]:2025-11-05 03:52:26,095 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9787e-01
[rank2]:2025-11-05 03:52:48,544 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0539e-01
[rank1]:2025-11-05 03:52:48,544 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3109e-01
[rank3]:2025-11-05 03:52:48,559 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9530e-01
[rank0]:2025-11-05 03:52:48,559 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1705e-01
[rank0]:2025-11-05 03:53:10,701 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-05 03:53:12,926 - INFO - Avg. fwd time: 10.0705 / Avg. bwd time: 16.6284 / Avg. batch time: 551.2158 (ms) / GPU bubble ratio: 61.25%
[rank3]:2025-11-05 03:53:12,872 - INFO - Avg. fwd time: 11.5194 / Avg. bwd time: 42.4832 / Avg. batch time: 491.7227 (ms) / GPU bubble ratio: 12.14%
[rank0]:2025-11-05 03:53:12,895 - INFO - Avg. fwd time: 8.4973 / Avg. bwd time: 18.5436 / Avg. batch time: 582.6462 (ms) / GPU bubble ratio: 62.87%
[rank2]:2025-11-05 03:53:12,948 - INFO - Avg. fwd time: 7.5529 / Avg. bwd time: 15.9145 / Avg. batch time: 520.0712 (ms) / GPU bubble ratio: 63.90%
[rank0]:2025-11-05 03:53:13,151 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.9914e-01
[rank0]:2025-11-05 03:53:13,151 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1752  memory: 16.57GiB(34.88%)  tps: 6,883  tflops: 52.42  mfu: 16.80%
[rank2]:2025-11-05 03:53:13,147 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2116e-01
[rank2]:2025-11-05 03:53:13,148 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1752  memory: 11.83GiB(24.89%)  tps: 6,882  tflops: 52.41  mfu: 16.80%
[rank1]:2025-11-05 03:53:13,135 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6182e+00
[rank1]:2025-11-05 03:53:13,136 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1752  memory: 14.66GiB(30.86%)  tps: 6,883  tflops: 52.42  mfu: 16.80%
[rank3]:2025-11-05 03:53:13,159 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1490e-01
[rank3]:2025-11-05 03:53:13,162 - INFO -  step: 350  loss:  0.2430  grad_norm:  0.1752  memory: 28.29GiB(59.55%)  tps: 6,882  tflops: 52.42  mfu: 16.80%
[rank0]:2025-11-05 03:53:35,597 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2795e+00
[rank2]:2025-11-05 03:53:35,581 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.9755e-01
[rank1]:2025-11-05 03:53:35,581 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3265e-01
[rank3]:2025-11-05 03:53:35,597 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9188e-01
[rank2]:2025-11-05 03:54:00,161 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4233e-01
[rank1]:2025-11-05 03:54:00,149 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9444e+00
[rank3]:2025-11-05 03:54:00,172 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0145e-01
[rank0]:2025-11-05 03:54:00,164 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1430e+00
[rank1]:2025-11-05 03:54:22,614 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8441e-01
[rank3]:2025-11-05 03:54:22,630 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2701e+00
[rank0]:2025-11-05 03:54:22,630 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.9382e-01
[rank2]:2025-11-05 03:54:22,614 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0533e-01
[rank1]:2025-11-05 03:54:47,224 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9118e+00
[rank3]:2025-11-05 03:54:47,247 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7869e-01
[rank0]:2025-11-05 03:54:47,239 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6141e+00
[rank2]:2025-11-05 03:54:47,235 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3447e-01
[rank0]:2025-11-05 03:55:07,434 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 03:55:09,388 - INFO - Avg. fwd time: 11.5311 / Avg. bwd time: 42.3773 / Avg. batch time: 490.9644 (ms) / GPU bubble ratio: 12.16%
[rank2]:2025-11-05 03:55:09,445 - INFO - Avg. fwd time: 7.5750 / Avg. bwd time: 15.7635 / Avg. batch time: 519.1077 (ms) / GPU bubble ratio: 64.03%
[rank0]:2025-11-05 03:55:09,473 - INFO - Avg. fwd time: 8.5482 / Avg. bwd time: 18.1672 / Avg. batch time: 580.7939 (ms) / GPU bubble ratio: 63.20%
[rank1]:2025-11-05 03:55:09,495 - INFO - Avg. fwd time: 10.1319 / Avg. bwd time: 16.1695 / Avg. batch time: 549.7561 (ms) / GPU bubble ratio: 61.73%
[rank1]:2025-11-05 03:55:09,681 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1206e+00
[rank1]:2025-11-05 03:55:09,681 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2406  memory: 14.66GiB(30.86%)  tps: 7,029  tflops: 53.53  mfu: 17.16%
[rank1]:2025-11-05 03:55:09,681 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-05 03:55:09,696 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3059e+00
[rank3]:2025-11-05 03:55:09,699 - INFO -  step: 400  loss:  0.2428  grad_norm:  0.2406  memory: 28.29GiB(59.55%)  tps: 7,030  tflops: 53.54  mfu: 17.16%
[rank3]:2025-11-05 03:55:09,700 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-05 03:55:09,696 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5906e+00
[rank0]:2025-11-05 03:55:09,697 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2406  memory: 16.57GiB(34.88%)  tps: 7,029  tflops: 53.53  mfu: 17.16%
[rank0]:2025-11-05 03:55:09,697 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-05 03:55:09,681 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9959e+00
[rank2]:2025-11-05 03:55:09,681 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2406  memory: 11.83GiB(24.89%)  tps: 7,030  tflops: 53.54  mfu: 17.16%
[rank2]:2025-11-05 03:55:09,681 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-05 03:55:29,859 - INFO - validate step: 400  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,316
[rank1]:2025-11-05 03:55:29,875 - INFO - validate step: 400  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,284
[rank3]:2025-11-05 03:55:29,885 - INFO - validate step: 400  loss:  0.4423  memory: 28.29GiB(59.55%)  tps: 20,293
[rank0]:2025-11-05 03:55:29,951 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0355_stage0_step400.svg
[rank2]:2025-11-05 03:55:29,895 - INFO - validate step: 400  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,264
[rank2]:2025-11-05 03:55:29,951 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0355_stage2_step400.svg
[rank1]:2025-11-05 03:55:29,953 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0355_stage1_step400.svg
[rank3]:2025-11-05 03:55:30,040 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0355_real_step400_rank3.svg
[rank3]:> Batch Time: 548.32 ms, GPU Bubble Ratio: 63.93%, 65.42%, 71.86%, 25.09%
[rank3]:2025-11-05 03:55:30,087 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0355_stage3_step400.svg
[rank3]:2025-11-05 03:55:42,778 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 03:55:42,991 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 03:55:43,004 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 03:55:43,022 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 03:55:54,685 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9682e+00
[rank2]:2025-11-05 03:55:54,681 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3002e-02
[rank1]:2025-11-05 03:55:54,670 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0388e+00
[rank3]:2025-11-05 03:55:54,693 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3039e-01
[rank2]:2025-11-05 03:56:17,133 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.8847e-01
[rank0]:2025-11-05 03:56:17,148 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6078e+00
[rank1]:2025-11-05 03:56:17,133 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3415e+00
[rank3]:2025-11-05 03:56:17,148 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.8548e-01
[rank1]:2025-11-05 03:56:41,781 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5936e-01
[rank3]:2025-11-05 03:56:41,804 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6481e-01
[rank0]:2025-11-05 03:56:41,796 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2256e+00
[rank2]:2025-11-05 03:56:41,792 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8636e-02
[rank2]:2025-11-05 03:57:04,286 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6642e+00
[rank0]:2025-11-05 03:57:04,301 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0103e+00
[rank1]:2025-11-05 03:57:04,286 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.8298e-01
[rank3]:2025-11-05 03:57:04,301 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7590e+00
[rank0]:2025-11-05 03:57:26,512 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-05 03:57:28,919 - INFO - Avg. fwd time: 7.5786 / Avg. bwd time: 15.7357 / Avg. batch time: 519.2051 (ms) / GPU bubble ratio: 64.08%
[rank1]:2025-11-05 03:57:28,939 - INFO - Avg. fwd time: 10.1802 / Avg. bwd time: 15.8189 / Avg. batch time: 549.4771 (ms) / GPU bubble ratio: 62.15%
[rank1]:2025-11-05 03:57:28,972 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.6360e-01
[rank1]:2025-11-05 03:57:28,973 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1768  memory: 14.66GiB(30.86%)  tps: 6,878  tflops: 52.39  mfu: 16.79%
[rank3]:2025-11-05 03:57:28,892 - INFO - Avg. fwd time: 11.5360 / Avg. bwd time: 42.3853 / Avg. batch time: 491.0697 (ms) / GPU bubble ratio: 12.16%
[rank2]:2025-11-05 03:57:28,984 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0181e-01
[rank2]:2025-11-05 03:57:28,984 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1768  memory: 11.83GiB(24.89%)  tps: 6,879  tflops: 52.39  mfu: 16.79%
[rank0]:2025-11-05 03:57:28,962 - INFO - Avg. fwd time: 8.5874 / Avg. bwd time: 17.8796 / Avg. batch time: 580.2176 (ms) / GPU bubble ratio: 63.51%
[rank0]:2025-11-05 03:57:28,988 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5173e+00
[rank0]:2025-11-05 03:57:28,988 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1768  memory: 16.57GiB(34.88%)  tps: 6,877  tflops: 52.37  mfu: 16.79%
[rank3]:2025-11-05 03:57:28,995 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.5237e-01
[rank3]:2025-11-05 03:57:28,998 - INFO -  step: 450  loss:  0.2411  grad_norm:  0.1768  memory: 28.29GiB(59.55%)  tps: 6,878  tflops: 52.38  mfu: 16.79%
[rank1]:2025-11-05 03:57:51,590 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4310e+00
[rank3]:2025-11-05 03:57:51,606 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6414e+00
[rank2]:2025-11-05 03:57:51,590 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.9653e+00
[rank0]:2025-11-05 03:57:51,606 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7932e+00
[rank0]:2025-11-05 03:58:16,382 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6530e+00
[rank2]:2025-11-05 03:58:16,378 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4369e-01
[rank1]:2025-11-05 03:58:16,367 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.6639e-01
[rank3]:2025-11-05 03:58:16,390 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7496e-01
[rank0]:2025-11-05 03:58:38,903 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5503e+00
[rank2]:2025-11-05 03:58:38,888 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1392e-01
[rank1]:2025-11-05 03:58:38,888 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0900e-01
[rank3]:2025-11-05 03:58:38,903 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6373e-01
[rank1]:2025-11-05 03:59:03,597 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1313e+00
[rank3]:2025-11-05 03:59:03,620 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1459e+00
[rank0]:2025-11-05 03:59:03,612 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6221e+00
[rank2]:2025-11-05 03:59:03,608 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2113e-01
[rank0]:2025-11-05 03:59:23,897 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 03:59:25,875 - INFO - Avg. fwd time: 11.5477 / Avg. bwd time: 42.3357 / Avg. batch time: 490.7626 (ms) / GPU bubble ratio: 12.16%
[rank0]:2025-11-05 03:59:25,966 - INFO - Avg. fwd time: 8.6151 / Avg. bwd time: 17.6822 / Avg. batch time: 579.3073 (ms) / GPU bubble ratio: 63.68%
[rank2]:2025-11-05 03:59:25,936 - INFO - Avg. fwd time: 7.5959 / Avg. bwd time: 15.6265 / Avg. batch time: 518.7562 (ms) / GPU bubble ratio: 64.19%
[rank1]:2025-11-05 03:59:25,990 - INFO - Avg. fwd time: 10.2143 / Avg. bwd time: 15.5787 / Avg. batch time: 548.7716 (ms) / GPU bubble ratio: 62.40%
[rank2]:2025-11-05 03:59:26,176 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6016e+00
[rank2]:2025-11-05 03:59:26,176 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2466  memory: 11.83GiB(24.89%)  tps: 6,990  tflops: 53.24  mfu: 17.06%
[rank1]:2025-11-05 03:59:26,176 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2024e+00
[rank1]:2025-11-05 03:59:26,176 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2466  memory: 14.66GiB(30.86%)  tps: 6,990  tflops: 53.23  mfu: 17.06%
[rank3]:2025-11-05 03:59:26,192 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9996e+00
[rank3]:2025-11-05 03:59:26,195 - INFO -  step: 500  loss:  0.2648  grad_norm:  0.2466  memory: 28.29GiB(59.55%)  tps: 6,990  tflops: 53.24  mfu: 17.06%
[rank0]:2025-11-05 03:59:26,191 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2398e+00
[rank0]:2025-11-05 03:59:26,192 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2466  memory: 16.57GiB(34.88%)  tps: 6,990  tflops: 53.23  mfu: 17.06%
[rank0]:2025-11-05 03:59:26,247 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0359_stage0_step500.svg
[rank2]:2025-11-05 03:59:26,246 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0359_stage2_step500.svg
[rank1]:2025-11-05 03:59:26,251 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0359_stage1_step500.svg
[rank3]:2025-11-05 03:59:26,339 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0359_real_step500_rank3.svg
[rank3]:> Batch Time: 592.84 ms, GPU Bubble Ratio: 66.63%, 67.98%, 65.14%, 25.60%
[rank3]:2025-11-05 03:59:26,382 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0359_stage3_step500.svg
[rank1]:2025-11-05 03:59:51,055 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0981e+00
[rank3]:2025-11-05 03:59:51,079 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1386e-01
[rank0]:2025-11-05 03:59:51,071 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5016e+00
[rank2]:2025-11-05 03:59:51,067 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4347e-02
[rank1]:2025-11-05 04:00:13,608 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1161e+00
[rank0]:2025-11-05 04:00:13,623 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7710e+00
[rank2]:2025-11-05 04:00:13,608 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7296e+00
[rank3]:2025-11-05 04:00:13,623 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5003e+00
[rank0]:2025-11-05 04:00:38,375 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5819e-01
[rank2]:2025-11-05 04:00:38,371 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4053e-02
[rank1]:2025-11-05 04:00:38,360 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1092e-01
[rank3]:2025-11-05 04:00:38,383 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2684e-01
[rank0]:2025-11-05 04:01:00,902 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3859e+00
[rank2]:2025-11-05 04:01:00,887 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4818e+00
[rank1]:2025-11-05 04:01:00,886 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.2990e-01
[rank3]:2025-11-05 04:01:00,902 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1711e+00
[rank0]:2025-11-05 04:01:23,195 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-05 04:01:25,409 - INFO - Avg. fwd time: 11.5484 / Avg. bwd time: 42.3388 / Avg. batch time: 490.7904 (ms) / GPU bubble ratio: 12.16%
[rank0]:2025-11-05 04:01:25,430 - INFO - Avg. fwd time: 8.6427 / Avg. bwd time: 17.4931 / Avg. batch time: 578.8649 (ms) / GPU bubble ratio: 63.88%
[rank1]:2025-11-05 04:01:25,463 - INFO - Avg. fwd time: 10.2475 / Avg. bwd time: 15.3487 / Avg. batch time: 548.5235 (ms) / GPU bubble ratio: 62.67%
[rank2]:2025-11-05 04:01:25,483 - INFO - Avg. fwd time: 7.6034 / Avg. bwd time: 15.5818 / Avg. batch time: 518.7548 (ms) / GPU bubble ratio: 64.24%
[rank1]:2025-11-05 04:01:25,670 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1630e+00
[rank1]:2025-11-05 04:01:25,671 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2141  memory: 14.66GiB(30.86%)  tps: 6,856  tflops: 52.21  mfu: 16.74%
[rank3]:2025-11-05 04:01:25,693 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5077e-01
[rank3]:2025-11-05 04:01:25,697 - INFO -  step: 550  loss:  0.3057  grad_norm:  0.2141  memory: 28.29GiB(59.55%)  tps: 6,855  tflops: 52.21  mfu: 16.73%
[rank0]:2025-11-05 04:01:25,685 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5210e+00
[rank0]:2025-11-05 04:01:25,686 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2141  memory: 16.57GiB(34.88%)  tps: 6,856  tflops: 52.21  mfu: 16.74%
[rank2]:2025-11-05 04:01:25,681 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1431e-01
[rank2]:2025-11-05 04:01:25,682 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2141  memory: 11.83GiB(24.89%)  tps: 6,855  tflops: 52.21  mfu: 16.73%
[rank0]:2025-11-05 04:01:48,268 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4974e+00
[rank2]:2025-11-05 04:01:48,253 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0255e+00
[rank1]:2025-11-05 04:01:48,253 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3419e-01
[rank3]:2025-11-05 04:01:48,269 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.5307e-01
[rank2]:2025-11-05 04:02:13,025 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8258e-01
[rank1]:2025-11-05 04:02:13,013 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0554e+00
[rank3]:2025-11-05 04:02:13,036 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.3380e-01
[rank0]:2025-11-05 04:02:13,028 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3431e+00
[rank1]:2025-11-05 04:02:35,587 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6102e+00
[rank3]:2025-11-05 04:02:35,602 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0485e+00
[rank0]:2025-11-05 04:02:35,602 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7738e+00
[rank2]:2025-11-05 04:02:35,586 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.0485e+00
[rank0]:2025-11-05 04:03:00,356 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5781e+00
[rank2]:2025-11-05 04:03:00,352 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8632e-01
[rank1]:2025-11-05 04:03:00,341 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0508e+00
[rank3]:2025-11-05 04:03:00,364 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.1189e-01
[rank0]:2025-11-05 04:03:20,627 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:03:22,841 - INFO - Avg. fwd time: 11.5566 / Avg. bwd time: 42.2910 / Avg. batch time: 490.4724 (ms) / GPU bubble ratio: 12.17%
[rank0]:2025-11-05 04:03:22,905 - INFO - Avg. fwd time: 8.6649 / Avg. bwd time: 17.3376 / Avg. batch time: 578.0602 (ms) / GPU bubble ratio: 64.01%
[rank2]:2025-11-05 04:03:22,860 - INFO - Avg. fwd time: 7.6198 / Avg. bwd time: 15.4797 / Avg. batch time: 518.3070 (ms) / GPU bubble ratio: 64.35%
[rank2]:2025-11-05 04:03:22,915 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5291e+00
[rank2]:2025-11-05 04:03:22,916 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1747  memory: 11.83GiB(24.89%)  tps: 6,988  tflops: 53.22  mfu: 17.06%
[rank2]:2025-11-05 04:03:22,916 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-05 04:03:22,881 - INFO - Avg. fwd time: 10.2751 / Avg. bwd time: 15.1602 / Avg. batch time: 547.8768 (ms) / GPU bubble ratio: 62.86%
[rank1]:2025-11-05 04:03:22,915 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7478e+00
[rank1]:2025-11-05 04:03:22,915 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1747  memory: 14.66GiB(30.86%)  tps: 6,987  tflops: 53.22  mfu: 17.06%
[rank1]:2025-11-05 04:03:22,915 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-05 04:03:22,930 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2299e+00
[rank3]:2025-11-05 04:03:22,934 - INFO -  step: 600  loss:  0.2311  grad_norm:  0.1747  memory: 28.29GiB(59.55%)  tps: 6,988  tflops: 53.22  mfu: 17.06%
[rank3]:2025-11-05 04:03:22,934 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-05 04:03:22,930 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2522e+00
[rank0]:2025-11-05 04:03:22,931 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1747  memory: 16.57GiB(34.88%)  tps: 6,987  tflops: 53.22  mfu: 17.06%
[rank0]:2025-11-05 04:03:22,931 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-05 04:03:42,923 - INFO - validate step: 600  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,488
[rank2]:2025-11-05 04:03:42,957 - INFO - validate step: 600  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,438
[rank1]:2025-11-05 04:03:42,941 - INFO - validate step: 600  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,454
[rank3]:2025-11-05 04:03:42,950 - INFO - validate step: 600  loss:  0.4397  memory: 28.29GiB(59.55%)  tps: 20,465
[rank0]:2025-11-05 04:03:43,010 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0403_stage0_step600.svg
[rank2]:2025-11-05 04:03:43,011 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0403_stage2_step600.svg
[rank1]:2025-11-05 04:03:43,012 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0403_stage1_step600.svg
[rank3]:2025-11-05 04:03:43,104 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0403_real_step600_rank3.svg
[rank3]:> Batch Time: 545.84 ms, GPU Bubble Ratio: 63.73%, 65.13%, 71.67%, 24.84%
[rank3]:2025-11-05 04:03:43,149 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0403_stage3_step600.svg
[rank1]:2025-11-05 04:04:07,804 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8695e-01
[rank3]:2025-11-05 04:04:07,828 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8985e-01
[rank0]:2025-11-05 04:04:07,820 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7343e-01
[rank2]:2025-11-05 04:04:07,816 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6018e-02
[rank2]:2025-11-05 04:04:30,411 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.1166e-01
[rank1]:2025-11-05 04:04:30,411 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5290e+00
[rank3]:2025-11-05 04:04:30,426 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8234e-01
[rank0]:2025-11-05 04:04:30,426 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5818e+00
[rank0]:2025-11-05 04:04:55,226 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2774e-01
[rank2]:2025-11-05 04:04:55,223 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2732e-02
[rank1]:2025-11-05 04:04:55,211 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.9966e-01
[rank3]:2025-11-05 04:04:55,234 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1033e-01
[rank2]:2025-11-05 04:05:17,774 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0959e+00
[rank1]:2025-11-05 04:05:17,773 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0980e+00
[rank3]:2025-11-05 04:05:17,789 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4713e+00
[rank0]:2025-11-05 04:05:17,789 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8818e+00
[rank0]:2025-11-05 04:05:40,100 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 04:05:42,308 - INFO - Avg. fwd time: 8.6812 / Avg. bwd time: 17.2243 / Avg. batch time: 578.0167 (ms) / GPU bubble ratio: 64.15%
[rank1]:2025-11-05 04:05:42,340 - INFO - Avg. fwd time: 10.2955 / Avg. bwd time: 15.0229 / Avg. batch time: 547.9492 (ms) / GPU bubble ratio: 63.04%
[rank3]:2025-11-05 04:05:42,286 - INFO - Avg. fwd time: 11.5615 / Avg. bwd time: 42.3114 / Avg. batch time: 490.6741 (ms) / GPU bubble ratio: 12.17%
[rank2]:2025-11-05 04:05:42,362 - INFO - Avg. fwd time: 7.6213 / Avg. bwd time: 15.4759 / Avg. batch time: 518.5258 (ms) / GPU bubble ratio: 64.36%
[rank1]:2025-11-05 04:05:42,548 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8801e+00
[rank1]:2025-11-05 04:05:42,549 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1755  memory: 14.66GiB(30.86%)  tps: 6,849  tflops: 52.16  mfu: 16.72%
[rank3]:2025-11-05 04:05:42,571 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6358e-01
[rank0]:2025-11-05 04:05:42,563 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2968e-01
[rank0]:2025-11-05 04:05:42,564 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1755  memory: 16.57GiB(34.88%)  tps: 6,847  tflops: 52.15  mfu: 16.71%
[rank2]:2025-11-05 04:05:42,560 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7697e-02
[rank2]:2025-11-05 04:05:42,560 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1755  memory: 11.83GiB(24.89%)  tps: 6,849  tflops: 52.17  mfu: 16.72%
[rank3]:2025-11-05 04:05:42,574 - INFO -  step: 650  loss:  0.2393  grad_norm:  0.1755  memory: 28.29GiB(59.55%)  tps: 6,848  tflops: 52.16  mfu: 16.72%
[rank2]:2025-11-05 04:06:05,136 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3237e-01
[rank1]:2025-11-05 04:06:05,136 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.8055e-01
[rank3]:2025-11-05 04:06:05,151 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.2867e-01
[rank0]:2025-11-05 04:06:05,151 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0480e-01
[rank1]:2025-11-05 04:06:29,821 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1711e-01
[rank0]:2025-11-05 04:06:29,837 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.3846e-01
[rank2]:2025-11-05 04:06:29,833 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9121e-02
[rank3]:2025-11-05 04:06:29,845 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9483e-01
[rank1]:2025-11-05 04:06:52,324 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5341e+00
[rank3]:2025-11-05 04:06:52,339 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0442e+00
[rank0]:2025-11-05 04:06:52,339 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8489e+00
[rank2]:2025-11-05 04:06:52,324 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.0880e-01
[rank1]:2025-11-05 04:07:17,044 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6840e+00
[rank3]:2025-11-05 04:07:17,067 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9963e-01
[rank0]:2025-11-05 04:07:17,059 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0838e+00
[rank2]:2025-11-05 04:07:17,056 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0588e-02
[rank0]:2025-11-05 04:07:37,783 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:07:39,741 - INFO - Avg. fwd time: 11.5667 / Avg. bwd time: 42.2781 / Avg. batch time: 490.4770 (ms) / GPU bubble ratio: 12.18%
[rank0]:2025-11-05 04:07:39,827 - INFO - Avg. fwd time: 8.7155 / Avg. bwd time: 17.1401 / Avg. batch time: 577.5540 (ms) / GPU bubble ratio: 64.19%
[rank2]:2025-11-05 04:07:39,799 - INFO - Avg. fwd time: 7.6292 / Avg. bwd time: 15.4231 / Avg. batch time: 518.2511 (ms) / GPU bubble ratio: 64.42%
[rank1]:2025-11-05 04:07:39,850 - INFO - Avg. fwd time: 10.3143 / Avg. bwd time: 14.8832 / Avg. batch time: 547.5245 (ms) / GPU bubble ratio: 63.18%
[rank0]:2025-11-05 04:07:40,043 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1179e-01
[rank0]:2025-11-05 04:07:40,044 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1718  memory: 16.57GiB(34.88%)  tps: 6,973  tflops: 53.11  mfu: 17.02%
[rank2]:2025-11-05 04:07:40,028 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.0777e-01
[rank2]:2025-11-05 04:07:40,029 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1718  memory: 11.83GiB(24.89%)  tps: 6,974  tflops: 53.11  mfu: 17.02%
[rank1]:2025-11-05 04:07:40,028 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.5843e-01
[rank1]:2025-11-05 04:07:40,028 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1718  memory: 14.66GiB(30.86%)  tps: 6,973  tflops: 53.11  mfu: 17.02%
[rank1]:2025-11-05 04:07:40,102 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0407_stage1_step700.svg
[rank3]:2025-11-05 04:07:40,044 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0349e-01
[rank3]:2025-11-05 04:07:40,047 - INFO -  step: 700  loss:  0.2221  grad_norm:  0.1718  memory: 28.29GiB(59.55%)  tps: 6,974  tflops: 53.11  mfu: 17.02%
[rank0]:2025-11-05 04:07:40,100 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0407_stage0_step700.svg
[rank2]:2025-11-05 04:07:40,100 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0407_stage2_step700.svg
[rank3]:2025-11-05 04:07:40,191 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0407_real_step700_rank3.svg
[rank3]:> Batch Time: 551.32 ms, GPU Bubble Ratio: 64.11%, 65.61%, 72.04%, 25.51%
[rank3]:2025-11-05 04:07:40,237 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0407_stage3_step700.svg
[rank1]:2025-11-05 04:08:04,807 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.6244e-01
[rank3]:2025-11-05 04:08:04,831 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4332e-01
[rank0]:2025-11-05 04:08:04,823 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0234e+00
[rank2]:2025-11-05 04:08:04,819 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0635e-02
[rank1]:2025-11-05 04:08:27,283 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7359e+00
[rank3]:2025-11-05 04:08:27,298 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5885e+00
[rank0]:2025-11-05 04:08:27,298 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.8317e-01
[rank2]:2025-11-05 04:08:27,283 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4075e+00
[rank1]:2025-11-05 04:08:51,890 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0219e+00
[rank3]:2025-11-05 04:08:51,913 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0210e-01
[rank0]:2025-11-05 04:08:51,905 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0568e+00
[rank2]:2025-11-05 04:08:51,901 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1329e-01
[rank1]:2025-11-05 04:09:14,319 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5844e+00
[rank3]:2025-11-05 04:09:14,335 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4482e+00
[rank0]:2025-11-05 04:09:14,335 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6571e-01
[rank2]:2025-11-05 04:09:14,319 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5891e+00
[rank0]:2025-11-05 04:09:36,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:09:38,882 - INFO - Avg. fwd time: 11.5645 / Avg. bwd time: 42.2818 / Avg. batch time: 490.5094 (ms) / GPU bubble ratio: 12.18%
[rank2]:2025-11-05 04:09:38,910 - INFO - Avg. fwd time: 7.6275 / Avg. bwd time: 15.4292 / Avg. batch time: 518.3044 (ms) / GPU bubble ratio: 64.41%
[rank1]:2025-11-05 04:09:38,931 - INFO - Avg. fwd time: 10.3293 / Avg. bwd time: 14.7615 / Avg. batch time: 547.4474 (ms) / GPU bubble ratio: 63.33%
[rank1]:2025-11-05 04:09:38,966 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.1605e-01
[rank1]:2025-11-05 04:09:38,966 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1721  memory: 14.66GiB(30.86%)  tps: 6,888  tflops: 52.46  mfu: 16.81%
[rank3]:2025-11-05 04:09:38,989 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0841e-01
[rank3]:2025-11-05 04:09:38,992 - INFO -  step: 750  loss:  0.2766  grad_norm:  0.1721  memory: 28.29GiB(59.55%)  tps: 6,887  tflops: 52.46  mfu: 16.81%
[rank0]:2025-11-05 04:09:38,956 - INFO - Avg. fwd time: 8.7403 / Avg. bwd time: 17.0534 / Avg. batch time: 577.4116 (ms) / GPU bubble ratio: 64.26%
[rank0]:2025-11-05 04:09:38,981 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2608e-01
[rank0]:2025-11-05 04:09:38,982 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1721  memory: 16.57GiB(34.88%)  tps: 6,888  tflops: 52.46  mfu: 16.81%
[rank2]:2025-11-05 04:09:38,977 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.7736e-02
[rank2]:2025-11-05 04:09:38,978 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1721  memory: 11.83GiB(24.89%)  tps: 6,887  tflops: 52.45  mfu: 16.81%
[rank1]:2025-11-05 04:10:01,405 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6874e+00
[rank0]:2025-11-05 04:10:01,420 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4953e+00
[rank2]:2025-11-05 04:10:01,405 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2877e+00
[rank3]:2025-11-05 04:10:01,420 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0085e+00
[rank1]:2025-11-05 04:10:26,002 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4061e+00
[rank3]:2025-11-05 04:10:26,026 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7223e-01
[rank0]:2025-11-05 04:10:26,017 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2735e+00
[rank2]:2025-11-05 04:10:26,014 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4013e-01
[rank2]:2025-11-05 04:10:48,483 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.0011e-01
[rank0]:2025-11-05 04:10:48,498 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2058e+00
[rank1]:2025-11-05 04:10:48,483 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.7728e-01
[rank3]:2025-11-05 04:10:48,498 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6274e-01
[rank2]:2025-11-05 04:11:13,159 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4142e-02
[rank0]:2025-11-05 04:11:13,163 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.2417e-01
[rank3]:2025-11-05 04:11:13,171 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8449e-01
[rank1]:2025-11-05 04:11:13,148 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5591e-01
[rank0]:2025-11-05 04:11:33,371 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:11:35,348 - INFO - Avg. fwd time: 11.5681 / Avg. bwd time: 42.2418 / Avg. batch time: 490.2134 (ms) / GPU bubble ratio: 12.19%
[rank2]:2025-11-05 04:11:35,406 - INFO - Avg. fwd time: 7.6349 / Avg. bwd time: 15.3774 / Avg. batch time: 517.9372 (ms) / GPU bubble ratio: 64.46%
[rank0]:2025-11-05 04:11:35,434 - INFO - Avg. fwd time: 8.7472 / Avg. bwd time: 16.9763 / Avg. batch time: 576.8591 (ms) / GPU bubble ratio: 64.33%
[rank1]:2025-11-05 04:11:35,456 - INFO - Avg. fwd time: 10.3410 / Avg. bwd time: 14.6707 / Avg. batch time: 546.9824 (ms) / GPU bubble ratio: 63.42%
[rank1]:2025-11-05 04:11:35,637 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1238e+00
[rank1]:2025-11-05 04:11:35,637 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1892  memory: 14.66GiB(30.86%)  tps: 7,021  tflops: 53.48  mfu: 17.14%
[rank1]:2025-11-05 04:11:35,637 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-05 04:11:35,652 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3765e+00
[rank2]:2025-11-05 04:11:35,637 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6462e+00
[rank2]:2025-11-05 04:11:35,637 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1892  memory: 11.83GiB(24.89%)  tps: 7,022  tflops: 53.48  mfu: 17.14%
[rank2]:2025-11-05 04:11:35,637 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-05 04:11:35,652 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9613e+00
[rank0]:2025-11-05 04:11:35,653 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1892  memory: 16.57GiB(34.88%)  tps: 7,021  tflops: 53.48  mfu: 17.14%
[rank0]:2025-11-05 04:11:35,653 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-05 04:11:35,656 - INFO -  step: 800  loss:  0.2291  grad_norm:  0.1892  memory: 28.29GiB(59.55%)  tps: 7,022  tflops: 53.48  mfu: 17.14%
[rank3]:2025-11-05 04:11:35,656 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-05 04:11:55,615 - INFO - validate step: 800  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,519
[rank1]:2025-11-05 04:11:55,630 - INFO - validate step: 800  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,488
[rank3]:2025-11-05 04:11:55,642 - INFO - validate step: 800  loss:  0.4374  memory: 28.29GiB(59.55%)  tps: 20,496
[rank2]:2025-11-05 04:11:55,651 - INFO - validate step: 800  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,466
[rank2]:2025-11-05 04:11:55,708 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0411_stage2_step800.svg
[rank0]:2025-11-05 04:11:55,708 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0411_stage0_step800.svg
[rank1]:2025-11-05 04:11:55,710 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0411_stage1_step800.svg
[rank3]:2025-11-05 04:11:55,797 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0411_real_step800_rank3.svg
[rank3]:> Batch Time: 591.32 ms, GPU Bubble Ratio: 66.63%, 67.95%, 65.11%, 25.49%
[rank3]:2025-11-05 04:11:55,845 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0411_stage3_step800.svg
[rank2]:2025-11-05 04:12:20,535 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6203e-02
[rank0]:2025-11-05 04:12:20,539 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8483e-01
[rank1]:2025-11-05 04:12:20,524 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.4332e-01
[rank3]:2025-11-05 04:12:20,547 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5632e-01
[rank3]:2025-11-05 04:12:21,943 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 04:12:22,205 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 04:12:22,191 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 04:12:22,223 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 04:12:43,057 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1046e+00
[rank0]:2025-11-05 04:12:43,072 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1728e+00
[rank1]:2025-11-05 04:12:43,057 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0929e+00
[rank3]:2025-11-05 04:12:43,072 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1792e+00
[rank1]:2025-11-05 04:13:07,773 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7155e-01
[rank2]:2025-11-05 04:13:07,784 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1963e-02
[rank0]:2025-11-05 04:13:07,788 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2122e-01
[rank3]:2025-11-05 04:13:07,796 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3984e-01
[rank2]:2025-11-05 04:13:30,315 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0121e+00
[rank0]:2025-11-05 04:13:30,330 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8704e-01
[rank1]:2025-11-05 04:13:30,315 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7097e+00
[rank3]:2025-11-05 04:13:30,330 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2486e+00
[rank0]:2025-11-05 04:13:52,590 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 04:13:54,804 - INFO - Avg. fwd time: 8.7552 / Avg. bwd time: 16.8972 / Avg. batch time: 576.7191 (ms) / GPU bubble ratio: 64.42%
[rank3]:2025-11-05 04:13:54,783 - INFO - Avg. fwd time: 11.5712 / Avg. bwd time: 42.2453 / Avg. batch time: 490.2628 (ms) / GPU bubble ratio: 12.18%
[rank1]:2025-11-05 04:13:54,837 - INFO - Avg. fwd time: 10.3538 / Avg. bwd time: 14.5773 / Avg. batch time: 546.9296 (ms) / GPU bubble ratio: 63.53%
[rank2]:2025-11-05 04:13:54,857 - INFO - Avg. fwd time: 7.6370 / Avg. bwd time: 15.3634 / Avg. batch time: 517.9850 (ms) / GPU bubble ratio: 64.48%
[rank2]:2025-11-05 04:13:55,054 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9805e-01
[rank2]:2025-11-05 04:13:55,054 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2098  memory: 11.83GiB(24.89%)  tps: 6,861  tflops: 52.25  mfu: 16.75%
[rank0]:2025-11-05 04:13:55,057 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3755e+00
[rank0]:2025-11-05 04:13:55,058 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2098  memory: 16.57GiB(34.88%)  tps: 6,859  tflops: 52.24  mfu: 16.74%
[rank1]:2025-11-05 04:13:55,042 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1192e+00
[rank1]:2025-11-05 04:13:55,043 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2098  memory: 14.66GiB(30.86%)  tps: 6,860  tflops: 52.25  mfu: 16.75%
[rank3]:2025-11-05 04:13:55,066 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9897e-01
[rank3]:2025-11-05 04:13:55,069 - INFO -  step: 850  loss:  0.2337  grad_norm:  0.2098  memory: 28.29GiB(59.55%)  tps: 6,860  tflops: 52.24  mfu: 16.74%
[rank2]:2025-11-05 04:14:17,669 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0438e-01
[rank0]:2025-11-05 04:14:17,684 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4917e+00
[rank1]:2025-11-05 04:14:17,669 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4607e+00
[rank3]:2025-11-05 04:14:17,684 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.0778e-01
[rank1]:2025-11-05 04:14:42,479 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7002e-01
[rank3]:2025-11-05 04:14:42,502 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2285e-01
[rank2]:2025-11-05 04:14:42,491 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2298e-01
[rank0]:2025-11-05 04:14:42,494 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.2192e-01
[rank0]:2025-11-05 04:15:05,068 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2766e+00
[rank1]:2025-11-05 04:15:05,053 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1599e+00
[rank3]:2025-11-05 04:15:05,069 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1792e+00
[rank2]:2025-11-05 04:15:05,053 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2511e+00
[rank3]:2025-11-05 04:15:29,879 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7452e-01
[rank2]:2025-11-05 04:15:29,868 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3624e-02
[rank0]:2025-11-05 04:15:29,871 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.9281e-01
[rank1]:2025-11-05 04:15:29,856 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9737e-01
[rank0]:2025-11-05 04:15:50,173 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:15:52,390 - INFO - Avg. fwd time: 11.5803 / Avg. bwd time: 42.2205 / Avg. batch time: 490.1328 (ms) / GPU bubble ratio: 12.19%
[rank2]:2025-11-05 04:15:52,411 - INFO - Avg. fwd time: 7.6459 / Avg. bwd time: 15.3076 / Avg. batch time: 517.7827 (ms) / GPU bubble ratio: 64.54%
[rank0]:2025-11-05 04:15:52,458 - INFO - Avg. fwd time: 8.7628 / Avg. bwd time: 16.8280 / Avg. batch time: 576.3565 (ms) / GPU bubble ratio: 64.48%
[rank1]:2025-11-05 04:15:52,433 - INFO - Avg. fwd time: 10.3659 / Avg. bwd time: 14.4956 / Avg. batch time: 546.6418 (ms) / GPU bubble ratio: 63.62%
[rank1]:2025-11-05 04:15:52,468 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6717e-01
[rank1]:2025-11-05 04:15:52,468 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1941  memory: 14.66GiB(30.86%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank3]:2025-11-05 04:15:52,483 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3263e+00
[rank3]:2025-11-05 04:15:52,486 - INFO -  step: 900  loss:  0.2040  grad_norm:  0.1941  memory: 28.29GiB(59.55%)  tps: 6,977  tflops: 53.14  mfu: 17.03%
[rank2]:2025-11-05 04:15:52,468 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.8128e-01
[rank2]:2025-11-05 04:15:52,468 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1941  memory: 11.83GiB(24.89%)  tps: 6,977  tflops: 53.14  mfu: 17.03%
[rank0]:2025-11-05 04:15:52,483 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2308e+00
[rank0]:2025-11-05 04:15:52,484 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1941  memory: 16.57GiB(34.88%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank0]:2025-11-05 04:15:52,536 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0415_stage0_step900.svg
[rank1]:2025-11-05 04:15:52,538 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0415_stage1_step900.svg
[rank2]:2025-11-05 04:15:52,536 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0415_stage2_step900.svg
[rank3]:2025-11-05 04:15:52,630 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0415_real_step900_rank3.svg
[rank3]:> Batch Time: 547.84 ms, GPU Bubble Ratio: 63.88%, 65.28%, 71.79%, 25.14%
[rank3]:2025-11-05 04:15:52,673 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0415_stage3_step900.svg
[rank2]:2025-11-05 04:16:17,424 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4491e-01
[rank3]:2025-11-05 04:16:17,436 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.9457e-01
[rank0]:2025-11-05 04:16:17,428 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4164e+00
[rank1]:2025-11-05 04:16:17,413 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4100e+00
[rank0]:2025-11-05 04:16:40,020 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6059e-01
[rank1]:2025-11-05 04:16:40,004 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1148e+00
[rank2]:2025-11-05 04:16:40,004 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.0298e-01
[rank3]:2025-11-05 04:16:40,020 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.7793e-01
[rank0]:2025-11-05 04:17:04,833 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8115e-01
[rank1]:2025-11-05 04:17:04,818 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1654e-01
[rank2]:2025-11-05 04:17:04,829 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6482e-02
[rank3]:2025-11-05 04:17:04,841 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2684e-01
[rank0]:2025-11-05 04:17:27,384 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0932e+00
[rank1]:2025-11-05 04:17:27,368 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9929e-01
[rank2]:2025-11-05 04:17:27,368 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2086e-01
[rank3]:2025-11-05 04:17:27,384 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.7987e-01
[rank0]:2025-11-05 04:17:49,687 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 04:17:51,915 - INFO - Avg. fwd time: 8.7687 / Avg. bwd time: 16.7749 / Avg. batch time: 576.4258 (ms) / GPU bubble ratio: 64.55%
[rank2]:2025-11-05 04:17:51,965 - INFO - Avg. fwd time: 7.6457 / Avg. bwd time: 15.3128 / Avg. batch time: 517.9790 (ms) / GPU bubble ratio: 64.54%
[rank3]:2025-11-05 04:17:51,893 - INFO - Avg. fwd time: 11.5831 / Avg. bwd time: 42.2399 / Avg. batch time: 490.3098 (ms) / GPU bubble ratio: 12.18%
[rank1]:2025-11-05 04:17:51,946 - INFO - Avg. fwd time: 10.3753 / Avg. bwd time: 14.4324 / Avg. batch time: 546.7696 (ms) / GPU bubble ratio: 63.70%
[rank2]:2025-11-05 04:17:52,160 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0784e-02
[rank2]:2025-11-05 04:17:52,161 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2542  memory: 11.83GiB(24.89%)  tps: 6,844  tflops: 52.13  mfu: 16.71%
[rank0]:2025-11-05 04:17:52,164 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2864e-01
[rank0]:2025-11-05 04:17:52,164 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2542  memory: 16.57GiB(34.88%)  tps: 6,845  tflops: 52.13  mfu: 16.71%
[rank1]:2025-11-05 04:17:52,148 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.7262e-01
[rank1]:2025-11-05 04:17:52,149 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2542  memory: 14.66GiB(30.86%)  tps: 6,845  tflops: 52.13  mfu: 16.71%
[rank3]:2025-11-05 04:17:52,172 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2880e-01
[rank3]:2025-11-05 04:17:52,175 - INFO -  step: 950  loss:  0.2502  grad_norm:  0.2542  memory: 28.29GiB(59.55%)  tps: 6,844  tflops: 52.13  mfu: 16.71%
[rank1]:2025-11-05 04:18:14,766 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3998e+00
[rank3]:2025-11-05 04:18:14,781 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.6067e-01
[rank2]:2025-11-05 04:18:14,766 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0680e+00
[rank0]:2025-11-05 04:18:14,781 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3298e+00
[rank0]:2025-11-05 04:18:39,586 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0784e+00
[rank1]:2025-11-05 04:18:39,571 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4666e+00
[rank3]:2025-11-05 04:18:39,594 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4976e-01
[rank2]:2025-11-05 04:18:39,582 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9149e-02
[rank2]:2025-11-05 04:19:02,163 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1079e+00
[rank0]:2025-11-05 04:19:02,178 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4618e+00
[rank1]:2025-11-05 04:19:02,163 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7407e+00
[rank3]:2025-11-05 04:19:02,178 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3461e-01
[rank2]:2025-11-05 04:19:27,001 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8919e-01
[rank0]:2025-11-05 04:19:27,005 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3855e+00
[rank1]:2025-11-05 04:19:26,989 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8024e+00
[rank3]:2025-11-05 04:19:27,013 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1869e-01
[rank0]:2025-11-05 04:19:47,302 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:19:49,301 - INFO - Avg. fwd time: 11.5888 / Avg. bwd time: 42.2338 / Avg. batch time: 490.3034 (ms) / GPU bubble ratio: 12.18%
[rank0]:2025-11-05 04:19:49,389 - INFO - Avg. fwd time: 8.7748 / Avg. bwd time: 16.7192 / Avg. batch time: 576.2437 (ms) / GPU bubble ratio: 64.61%
[rank2]:2025-11-05 04:19:49,361 - INFO - Avg. fwd time: 7.6503 / Avg. bwd time: 15.2854 / Avg. batch time: 517.9291 (ms) / GPU bubble ratio: 64.57%
[rank1]:2025-11-05 04:19:49,415 - INFO - Avg. fwd time: 10.3853 / Avg. bwd time: 14.3659 / Avg. batch time: 546.6476 (ms) / GPU bubble ratio: 63.78%
[rank1]:2025-11-05 04:19:49,586 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2071e+00
[rank1]:2025-11-05 04:19:49,586 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1609  memory: 14.66GiB(30.86%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank1]:2025-11-05 04:19:49,587 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-05 04:19:49,586 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3304e+00
[rank2]:2025-11-05 04:19:49,586 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1609  memory: 11.83GiB(24.89%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank2]:2025-11-05 04:19:49,586 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-05 04:19:49,602 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.1839e-01
[rank3]:2025-11-05 04:19:49,605 - INFO -  step: 1000  loss:  0.2408  grad_norm:  0.1609  memory: 28.29GiB(59.55%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank3]:2025-11-05 04:19:49,605 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-05 04:19:49,601 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3791e+00
[rank0]:2025-11-05 04:19:49,602 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1609  memory: 16.57GiB(34.88%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank0]:2025-11-05 04:19:49,602 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-05 04:20:09,669 - INFO - validate step: 1000  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,411
[rank1]:2025-11-05 04:20:09,685 - INFO - validate step: 1000  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,380
[rank2]:2025-11-05 04:20:09,704 - INFO - validate step: 1000  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,360
[rank2]:2025-11-05 04:20:09,757 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0420_stage2_step1000.svg
[rank3]:2025-11-05 04:20:09,697 - INFO - validate step: 1000  loss:  0.4390  memory: 28.29GiB(59.55%)  tps: 20,387
[rank0]:2025-11-05 04:20:09,756 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0420_stage0_step1000.svg
[rank1]:2025-11-05 04:20:09,758 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0420_stage1_step1000.svg
[rank3]:2025-11-05 04:20:09,849 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0420_real_step1000_rank3.svg
[rank3]:> Batch Time: 552.35 ms, GPU Bubble Ratio: 64.18%, 65.61%, 72.05%, 24.87%
[rank3]:2025-11-05 04:20:09,893 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0420_stage3_step1000.svg
[rank0]:2025-11-05 04:20:34,617 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0207e+00
[rank1]:2025-11-05 04:20:34,601 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0672e-01
[rank2]:2025-11-05 04:20:34,613 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6088e-02
[rank3]:2025-11-05 04:20:34,625 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1979e-01
[rank0]:2025-11-05 04:20:57,238 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5649e-01
[rank1]:2025-11-05 04:20:57,223 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2746e+00
[rank2]:2025-11-05 04:20:57,223 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2098e+00
[rank3]:2025-11-05 04:20:57,238 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5154e+00
[rank0]:2025-11-05 04:21:22,021 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.1992e-01
[rank1]:2025-11-05 04:21:22,006 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.4878e-01
[rank2]:2025-11-05 04:21:22,017 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2559e-01
[rank3]:2025-11-05 04:21:22,029 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8933e-01
[rank0]:2025-11-05 04:21:44,630 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6631e-01
[rank1]:2025-11-05 04:21:44,615 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9172e-01
[rank2]:2025-11-05 04:21:44,615 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4755e-01
[rank3]:2025-11-05 04:21:44,631 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3336e+00
[rank0]:2025-11-05 04:22:06,969 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-05 04:22:09,394 - INFO - Avg. fwd time: 11.5884 / Avg. bwd time: 42.2628 / Avg. batch time: 490.5307 (ms) / GPU bubble ratio: 12.17%
[rank0]:2025-11-05 04:22:09,473 - INFO - Avg. fwd time: 8.7803 / Avg. bwd time: 16.6693 / Avg. batch time: 576.3820 (ms) / GPU bubble ratio: 64.68%
[rank1]:2025-11-05 04:22:09,447 - INFO - Avg. fwd time: 10.3948 / Avg. bwd time: 14.3068 / Avg. batch time: 546.8393 (ms) / GPU bubble ratio: 63.86%
[rank1]:2025-11-05 04:22:09,483 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4732e+00
[rank1]:2025-11-05 04:22:09,483 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1993  memory: 14.66GiB(30.86%)  tps: 6,838  tflops: 52.08  mfu: 16.69%
[rank2]:2025-11-05 04:22:09,424 - INFO - Avg. fwd time: 7.6489 / Avg. bwd time: 15.2987 / Avg. batch time: 518.1828 (ms) / GPU bubble ratio: 64.57%
[rank2]:2025-11-05 04:22:09,495 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2124e-02
[rank2]:2025-11-05 04:22:09,495 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1993  memory: 11.83GiB(24.89%)  tps: 6,839  tflops: 52.08  mfu: 16.69%
[rank3]:2025-11-05 04:22:09,506 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6572e-01
[rank3]:2025-11-05 04:22:09,509 - INFO -  step: 1050  loss:  0.2846  grad_norm:  0.1993  memory: 28.29GiB(59.55%)  tps: 6,837  tflops: 52.08  mfu: 16.69%
[rank0]:2025-11-05 04:22:09,498 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0996e+00
[rank0]:2025-11-05 04:22:09,499 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1993  memory: 16.57GiB(34.88%)  tps: 6,836  tflops: 52.07  mfu: 16.69%
[rank0]:2025-11-05 04:22:32,093 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8229e+00
[rank2]:2025-11-05 04:22:32,078 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3276e+00
[rank1]:2025-11-05 04:22:32,078 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8715e+00
[rank3]:2025-11-05 04:22:32,093 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0083e+00
[rank1]:2025-11-05 04:22:56,859 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9561e+00
[rank3]:2025-11-05 04:22:56,883 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9551e-01
[rank2]:2025-11-05 04:22:56,871 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6113e-01
[rank0]:2025-11-05 04:22:56,875 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0134e+00
[rank3]:2025-11-05 04:23:19,520 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.8901e-01
[rank2]:2025-11-05 04:23:19,504 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3812e+00
[rank0]:2025-11-05 04:23:19,520 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2771e+00
[rank1]:2025-11-05 04:23:19,504 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8876e+00
[rank0]:2025-11-05 04:23:44,315 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0182e+00
[rank2]:2025-11-05 04:23:44,311 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.7810e-02
[rank1]:2025-11-05 04:23:44,300 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4222e+00
[rank3]:2025-11-05 04:23:44,323 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2645e-01
[rank0]:2025-11-05 04:24:04,644 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:24:06,638 - INFO - Avg. fwd time: 11.5908 / Avg. bwd time: 42.2517 / Avg. batch time: 490.4594 (ms) / GPU bubble ratio: 12.18%
[rank0]:2025-11-05 04:24:06,725 - INFO - Avg. fwd time: 8.7854 / Avg. bwd time: 16.6303 / Avg. batch time: 576.1779 (ms) / GPU bubble ratio: 64.71%
[rank2]:2025-11-05 04:24:06,696 - INFO - Avg. fwd time: 7.6541 / Avg. bwd time: 15.2678 / Avg. batch time: 518.0687 (ms) / GPU bubble ratio: 64.60%
[rank1]:2025-11-05 04:24:06,750 - INFO - Avg. fwd time: 10.4019 / Avg. bwd time: 14.2604 / Avg. batch time: 546.6749 (ms) / GPU bubble ratio: 63.91%
[rank0]:2025-11-05 04:24:06,947 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2711e+00
[rank0]:2025-11-05 04:24:06,947 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1980  memory: 16.57GiB(34.88%)  tps: 6,975  tflops: 53.12  mfu: 17.03%
[rank2]:2025-11-05 04:24:06,931 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.6523e-01
[rank2]:2025-11-05 04:24:06,932 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1980  memory: 11.83GiB(24.89%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank1]:2025-11-05 04:24:06,931 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2115e+00
[rank1]:2025-11-05 04:24:06,932 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1980  memory: 14.66GiB(30.86%)  tps: 6,975  tflops: 53.12  mfu: 17.03%
[rank3]:2025-11-05 04:24:06,947 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.6120e-01
[rank3]:2025-11-05 04:24:06,950 - INFO -  step: 1100  loss:  0.2454  grad_norm:  0.1980  memory: 28.29GiB(59.55%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank0]:2025-11-05 04:24:07,005 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0424_stage0_step1100.svg
[rank2]:2025-11-05 04:24:07,002 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0424_stage2_step1100.svg
[rank1]:2025-11-05 04:24:07,004 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0424_stage1_step1100.svg
[rank3]:2025-11-05 04:24:07,094 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0424_real_step1100_rank3.svg
[rank3]:> Batch Time: 595.36 ms, GPU Bubble Ratio: 66.73%, 68.07%, 65.27%, 25.82%
[rank3]:2025-11-05 04:24:07,138 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0424_stage3_step1100.svg
[rank2]:2025-11-05 04:24:31,887 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0979e-01
[rank1]:2025-11-05 04:24:31,876 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5144e+00
[rank3]:2025-11-05 04:24:31,899 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5346e-01
[rank0]:2025-11-05 04:24:31,891 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.8585e-01
[rank3]:2025-11-05 04:24:54,449 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.0738e-01
[rank0]:2025-11-05 04:24:54,449 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1628e+00
[rank2]:2025-11-05 04:24:54,434 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.3266e-01
[rank1]:2025-11-05 04:24:54,434 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0107e+00
[rank1]:2025-11-05 04:25:19,150 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6923e-01
[rank3]:2025-11-05 04:25:19,173 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4850e-01
[rank2]:2025-11-05 04:25:19,161 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2823e-02
[rank0]:2025-11-05 04:25:19,165 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2347e-01
[rank2]:2025-11-05 04:25:41,664 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9570e+00
[rank0]:2025-11-05 04:25:41,679 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1137e+00
[rank1]:2025-11-05 04:25:41,664 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0406e+00
[rank3]:2025-11-05 04:25:41,679 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5979e+00
[rank0]:2025-11-05 04:26:03,910 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 04:26:06,115 - INFO - Avg. fwd time: 8.7902 / Avg. bwd time: 16.5880 / Avg. batch time: 576.1149 (ms) / GPU bubble ratio: 64.76%
[rank3]:2025-11-05 04:26:06,092 - INFO - Avg. fwd time: 11.5926 / Avg. bwd time: 42.2544 / Avg. batch time: 490.4944 (ms) / GPU bubble ratio: 12.18%
[rank2]:2025-11-05 04:26:06,167 - INFO - Avg. fwd time: 7.6548 / Avg. bwd time: 15.2626 / Avg. batch time: 518.1067 (ms) / GPU bubble ratio: 64.61%
[rank1]:2025-11-05 04:26:06,145 - INFO - Avg. fwd time: 10.4086 / Avg. bwd time: 14.2100 / Avg. batch time: 546.6575 (ms) / GPU bubble ratio: 63.97%
[rank2]:2025-11-05 04:26:06,358 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2485e-01
[rank2]:2025-11-05 04:26:06,359 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1697  memory: 11.83GiB(24.89%)  tps: 6,859  tflops: 52.24  mfu: 16.74%
[rank0]:2025-11-05 04:26:06,362 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1004e-01
[rank0]:2025-11-05 04:26:06,363 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1697  memory: 16.57GiB(34.88%)  tps: 6,860  tflops: 52.25  mfu: 16.75%
[rank1]:2025-11-05 04:26:06,347 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9489e-01
[rank1]:2025-11-05 04:26:06,347 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1697  memory: 14.66GiB(30.86%)  tps: 6,860  tflops: 52.25  mfu: 16.75%
[rank3]:2025-11-05 04:26:06,370 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2554e-01
[rank3]:2025-11-05 04:26:06,374 - INFO -  step: 1150  loss:  0.2461  grad_norm:  0.1697  memory: 28.29GiB(59.55%)  tps: 6,860  tflops: 52.25  mfu: 16.75%
[rank1]:2025-11-05 04:26:28,848 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.4507e-01
[rank3]:2025-11-05 04:26:28,863 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5725e+00
[rank2]:2025-11-05 04:26:28,848 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2206e+00
[rank0]:2025-11-05 04:26:28,863 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2028e-01
[rank2]:2025-11-05 04:26:53,508 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2582e-02
[rank0]:2025-11-05 04:26:53,512 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1479e-01
[rank1]:2025-11-05 04:26:53,497 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0384e+00
[rank3]:2025-11-05 04:26:53,520 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3106e-01
[rank2]:2025-11-05 04:27:15,931 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.5227e-01
[rank0]:2025-11-05 04:27:15,946 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1479e-01
[rank1]:2025-11-05 04:27:15,931 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5155e+00
[rank3]:2025-11-05 04:27:15,946 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.0601e-01
[rank2]:2025-11-05 04:27:40,585 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4760e-02
[rank1]:2025-11-05 04:27:40,574 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7196e-01
[rank0]:2025-11-05 04:27:40,589 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1171e+00
[rank3]:2025-11-05 04:27:40,597 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8612e-01
[rank0]:2025-11-05 04:28:00,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 04:28:03,012 - INFO - Avg. fwd time: 11.5956 / Avg. bwd time: 42.2214 / Avg. batch time: 490.2519 (ms) / GPU bubble ratio: 12.18%
[rank2]:2025-11-05 04:28:03,034 - INFO - Avg. fwd time: 7.6603 / Avg. bwd time: 15.2243 / Avg. batch time: 517.8133 (ms) / GPU bubble ratio: 64.64%
[rank1]:2025-11-05 04:28:03,058 - INFO - Avg. fwd time: 10.4143 / Avg. bwd time: 14.1633 / Avg. batch time: 546.3132 (ms) / GPU bubble ratio: 64.01%
[rank0]:2025-11-05 04:28:03,084 - INFO - Avg. fwd time: 8.7939 / Avg. bwd time: 16.5491 / Avg. batch time: 575.7278 (ms) / GPU bubble ratio: 64.78%
[rank3]:2025-11-05 04:28:03,109 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.9533e-01
[rank3]:2025-11-05 04:28:03,113 - INFO -  step: 1200  loss:  0.2464  grad_norm:  0.1875  memory: 28.29GiB(59.55%)  tps: 7,017  tflops: 53.45  mfu: 17.13%
[rank2]:2025-11-05 04:28:03,094 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.9348e-01
[rank2]:2025-11-05 04:28:03,095 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1875  memory: 11.83GiB(24.89%)  tps: 7,018  tflops: 53.45  mfu: 17.13%
[rank2]:2025-11-05 04:28:03,095 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1875  tps: 7,149  tflops: 54.45  mfu: 16.27%
[rank2]:2025-11-05 04:28:03,095 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-05 04:28:03,094 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7798e-01
[rank1]:2025-11-05 04:28:03,095 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1875  memory: 14.66GiB(30.86%)  tps: 7,017  tflops: 53.44  mfu: 17.13%
[rank1]:2025-11-05 04:28:03,095 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1875  tps: 7,149  tflops: 54.45  mfu: 16.27%
[rank1]:2025-11-05 04:28:03,095 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-05 04:28:03,109 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2888e-01
[rank0]:2025-11-05 04:28:03,110 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1875  memory: 16.57GiB(34.88%)  tps: 7,017  tflops: 53.44  mfu: 17.13%
[rank0]:2025-11-05 04:28:03,110 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1875  tps: 7,149  tflops: 54.44  mfu: 16.27%
[rank0]:2025-11-05 04:28:03,110 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-05 04:28:03,113 - INFO -  final step: 1200  loss:  0.2464  grad_norm:  0.1875  tps: 7,154  tflops: 54.49  mfu: 16.29%
[rank3]:2025-11-05 04:28:03,114 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-05 04:28:23,160 - INFO - validate step: 1200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,413
[rank2]:2025-11-05 04:28:23,161 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-05 04:28:23,162 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-05 04:28:23,140 - INFO - validate step: 1200  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,435
[rank1]:2025-11-05 04:28:23,140 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-05 04:28:23,141 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-05 04:28:23,124 - INFO - validate step: 1200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,466
[rank0]:2025-11-05 04:28:23,125 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-05 04:28:23,125 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-05 04:28:23,150 - INFO - validate step: 1200  loss:  0.4395  memory: 28.29GiB(59.55%)  tps: 20,444
[rank3]:2025-11-05 04:28:23,152 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-05 04:28:23,154 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-05 04:28:25,218 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank1/251105_0428_stage1_final1200.svg
[rank0]:2025-11-05 04:28:25,150 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-11-05 04:28:25,216 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank0/251105_0428_stage0_final1200.svg
[rank2]:2025-11-05 04:28:25,217 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank2/251105_0428_stage2_final1200.svg
[rank3]:2025-11-05 04:28:25,308 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0428_real_final1200_rank3.svg
[rank3]:> Batch Time: 589.34 ms, GPU Bubble Ratio: 66.45%, 67.80%, 65.03%, 25.94%
[rank2]:2025-11-05 04:28:25,374 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/frozen_params_histogram/251105_0428_rank2_stage2.svg
[rank2]:	> Counts Sum: 1512, Total Sum: 4140 (36.52%), Ratio(%) per element: [48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 48.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-05 04:28:25,374 - INFO - Destroying the purge thread.
[rank1]:2025-11-05 04:28:25,368 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/frozen_params_histogram/251105_0428_rank1_stage1.svg
[rank1]:	> Counts Sum: 3960, Total Sum: 5175 (76.52%), Ratio(%) per element: [96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-05 04:28:25,368 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 04:28:25,372 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/frozen_params_histogram/251105_0428_rank0_stage0.svg
[rank0]:	> Counts Sum: 2925, Total Sum: 4255 (68.74%), Ratio(%) per element: [0.0, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 97.39, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 93.04, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 92.17, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-05 04:28:25,372 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-05 04:28:25,420 - INFO - Process group destroyed
[rank1]:2025-11-05 04:28:25,464 - INFO - Process group destroyed
[rank3]:2025-11-05 04:28:25,455 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/pipeline_schedule/251105_0428_thry_final1200_rank3.svg
[rank3]:> Batch Time: 314.95 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-05 04:28:25,502 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/freeze_ratio_history/rank3/251105_0428_stage3_final1200.svg
[rank3]:2025-11-05 04:28:25,640 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1/frozen_params_histogram/251105_0428_rank3_stage3.svg
[rank3]:	> Counts Sum: 1026, Total Sum: 3335 (30.76%), Ratio(%) per element: [49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 49.56, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-05 04:28:25,641 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 24-24, summary, console lines 388-398
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.29003
[rank3]:wandb:               final/avg_loss 0.2464
[rank3]:wandb:             final/avg_mfu(%) 16.28661
[rank3]:wandb:             final/avg_tflops 54.49013
[rank3]:wandb:    final/avg_throughput(tps) 7154.49108
[rank3]:wandb:              final/grad_norm 0.18753
[rank3]:wandb:               final/max_loss 0.2464
[rank3]:wandb:                    grad_norm 0.18753
[rank3]:wandb: loss_metrics/global_avg_loss 0.2464
[rank3]:wandb: loss_metrics/global_max_loss 0.2464
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/3tril4nr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1/20251105-0338/wandb/run-20251105_033836-3tril4nr/logs
[rank3]:2025-11-05 04:28:26,925 - INFO - Process group destroyed
[rank0]:2025-11-05 04:28:27,372 - INFO - Training completed
[rank0]:2025-11-05 04:28:27,373 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 04:28:27,419 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.2', 'layers.3', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.6', 'layers.5', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'layers.14', 'layers.13', 'output'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_GPipe_auto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
