
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 07. (ê¸ˆ) 06:31:25 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1107_Interleaved1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-07 06:31:31,197 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank2]:2025-11-07 06:31:31,198 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:2025-11-07 06:31:31,355 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank1]:2025-11-07 06:31:31,444 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-07 06:31:31,446 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-07 06:31:31,426 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-07 06:31:31,429 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 06:31:31,435 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:2025-11-07 06:31:31,563 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-07 06:31:31,565 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 06:31:31,614 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-07 06:31:31,616 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 06:31:31,621 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-07 06:31:32,044 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-07 06:31:32,461 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-07 06:31:35,240 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-07 06:31:35,372 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-07 06:31:35,406 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 06:31:35,407 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-07 06:31:35,428 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-07 06:31:35,440 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-07 06:31:35,441 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-07 06:31:35,449 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 06:31:35,450 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-07 06:31:35,469 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-07 06:31:35,481 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-07 06:31:35,483 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-07 06:31:35,612 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-07 06:31:35,612 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-07 06:31:35,613 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-07 06:31:35,658 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 06:31:35,659 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-07 06:31:35,659 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-07 06:31:35,763 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-07 06:31:35,802 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-07 06:31:35,831 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-07 06:31:35,844 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-07 06:31:35,845 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-07 06:31:36,011 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-07 06:31:36,012 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-07 06:31:36,012 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ytte9ece
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1107_Interleaved1F1B_timelyapf_dm1/20251107-0631/wandb/run-20251107_063136-ytte9ece
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1107_Interleaved1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ytte9ece
[rank3]:2025-11-07 06:31:37,681 - INFO - WandB logging enabled
[rank3]:2025-11-07 06:31:37,682 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-07 06:31:37,721 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 06:31:37,750 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-07 06:31:37,763 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-07 06:31:37,765 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-07 06:31:37,957 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-07 06:31:37,957 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-07 06:31:37,939 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 06:31:37,940 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-07 06:31:37,941 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-07 06:31:37,956 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 06:31:37,957 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1107_Interleaved1F1B_timelyapf_dm1
[rank0]:2025-11-07 06:31:37,957 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 06:31:37,958 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-07 06:31:37,958 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-07 06:31:40,142 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-07 06:31:40,142 - INFO - Finished loading the checkpoint in 2.18 seconds.
[rank0]:2025-11-07 06:31:40,142 - INFO - Training starts at step 1
[rank1]:2025-11-07 06:31:43,461 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8887  memory:  9.58GiB(20.17%)  tps: 2,034  tflops: 15.49  mfu: 4.97%
[rank1]:2025-11-07 06:31:43,461 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-07 06:31:43,466 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8887  memory: 15.04GiB(31.66%)  tps: 2,853  tflops: 21.73  mfu: 6.97%
[rank3]:2025-11-07 06:31:43,466 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-07 06:31:43,453 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8887  memory:  6.31GiB(13.29%)  tps: 2,142  tflops: 16.31  mfu: 5.23%
[rank2]:2025-11-07 06:31:43,454 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-07 06:31:43,494 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8887  memory: 10.96GiB(23.08%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank0]:2025-11-07 06:31:43,494 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-07 06:33:52,839 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 06:33:55,198 - INFO - Avg. fwd time: 6.7227 / Avg. bwd time: 21.8541 / Avg. batch time: 565.6892 (ms) / GPU bubble ratio: 19.17%
[rank2]:2025-11-07 06:33:55,257 - INFO - Avg. fwd time: 3.9628 / Avg. bwd time: 10.0424 / Avg. batch time: 598.2335 (ms) / GPU bubble ratio: 62.54%
[rank0]:2025-11-07 06:33:55,277 - INFO - Avg. fwd time: 4.1037 / Avg. bwd time: 11.9855 / Avg. batch time: 650.3837 (ms) / GPU bubble ratio: 60.42%
[rank1]:2025-11-07 06:33:55,355 - INFO - Avg. fwd time: 4.8664 / Avg. bwd time: 12.2263 / Avg. batch time: 627.6198 (ms) / GPU bubble ratio: 56.43%
[rank3]:2025-11-07 06:33:55,534 - INFO -  step: 50  loss:  9.2106  grad_norm: 15.6729  memory: 18.46GiB(38.86%)  tps: 6,079  tflops: 46.30  mfu: 14.84%
[rank2]:2025-11-07 06:33:55,522 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.6729  memory:  8.11GiB(17.07%)  tps: 6,079  tflops: 46.30  mfu: 14.84%
[rank1]:2025-11-07 06:33:55,525 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.6729  memory: 11.85GiB(24.93%)  tps: 6,079  tflops: 46.30  mfu: 14.84%
[rank0]:2025-11-07 06:33:55,536 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.6729  memory: 14.71GiB(30.97%)  tps: 6,080  tflops: 46.31  mfu: 14.84%
[rank3]:2025-11-07 06:34:22,535 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-07 06:34:49,365 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-07 06:34:49,674 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-07 06:34:49,735 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,744 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,753 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,762 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,755 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,771 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,744 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,759 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,777 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,752 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,767 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,775 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,795 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,813 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,834 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,785 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,803 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,823 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,843 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,796 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,811 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,832 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,874 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,785 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,805 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,825 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,890 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,922 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,955 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,963 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,969 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,904 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,911 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,955 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,970 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,899 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,931 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,961 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,969 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,889 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,912 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,961 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,980 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,982 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,989 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:34:49,996 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,979 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,985 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:49,992 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:50,002 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:50,013 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 06:34:50,025 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,981 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,987 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:49,999 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:50,006 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 06:34:50,018 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,985 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:49,993 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:50,001 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:50,005 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:50,019 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:50,034 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 06:34:50,046 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 06:35:28,935 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-07 06:35:29,244 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0635_max_batch_time.svg
[rank3]:> Batch Time: 526.46 ms, GPU Bubble Ratio: 50.74%, 47.78%, 57.24%, 12.17%
[rank3]:2025-11-07 06:35:29,485 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0635_min_batch_time.svg
[rank3]:> Batch Time: 322.71 ms, GPU Bubble Ratio: 68.35%, 47.94%, 56.50%, 10.49%
[rank3]:2025-11-07 06:35:29,748 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0635_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 351.67 ms, GPU Bubble Ratio: 37.58%, 32.54%, 42.73%, 8.92%
[rank3]:2025-11-07 06:35:29,748 - INFO - 	> Batch Time: 351.67 ms (Average Freeze Ratio: 0.39, Time Reduction Rate: 0.33)
[rank0]:2025-11-07 06:35:48,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 06:35:50,718 - INFO - Avg. fwd time: 7.0529 / Avg. bwd time: 19.0726 / Avg. batch time: 530.2428 (ms) / GPU bubble ratio: 21.17%
[rank0]:2025-11-07 06:35:50,695 - INFO - Avg. fwd time: 4.2932 / Avg. bwd time: 9.4716 / Avg. batch time: 607.2990 (ms) / GPU bubble ratio: 63.73%
[rank2]:2025-11-07 06:35:50,749 - INFO - Avg. fwd time: 4.1671 / Avg. bwd time: 8.7244 / Avg. batch time: 562.3383 (ms) / GPU bubble ratio: 63.32%
[rank1]:2025-11-07 06:35:50,762 - INFO - Avg. fwd time: 5.1229 / Avg. bwd time: 10.4886 / Avg. batch time: 588.5614 (ms) / GPU bubble ratio: 57.56%
[rank2]:2025-11-07 06:35:50,963 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.29/0.86, [MB6] 0.21/0.62, [MB7] 0.33/1.00
[rank2]:2025-11-07 06:35:50,964 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7750  memory:  9.05GiB(19.05%)  tps: 7,096  tflops: 54.05  mfu: 17.32%
[rank3]:2025-11-07 06:35:50,987 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB0] 0.33/1.00, [MB1] 0.26/0.78, [MB2] 0.33/1.00, [MB3] 0.00/0.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.21/0.62
[rank3]:2025-11-07 06:35:50,989 - INFO -  step: 100  loss:  4.3438  grad_norm:  2.7750  memory: 21.41GiB(45.07%)  tps: 7,095  tflops: 54.04  mfu: 17.32%
[rank0]:2025-11-07 06:35:50,963 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.08/0.24, [MB4] 0.04/0.13, [MB5] 0.33/1.00, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-11-07 06:35:50,964 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7750  memory: 16.61GiB(34.96%)  tps: 7,097  tflops: 54.05  mfu: 17.32%
[rank0]:2025-11-07 06:35:51,048 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0635_stage0_step100.svg
[rank1]:2025-11-07 06:35:50,963 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-07 06:35:50,964 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7750  memory: 12.98GiB(27.32%)  tps: 7,096  tflops: 54.05  mfu: 17.32%
[rank1]:2025-11-07 06:35:51,046 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0635_stage1_step100.svg
[rank2]:2025-11-07 06:35:51,046 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0635_stage2_step100.svg
[rank0]:2025-11-07 06:35:51,086 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0635_stage4_step100.svg
[rank1]:2025-11-07 06:35:51,084 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0635_stage5_step100.svg
[rank2]:2025-11-07 06:35:51,084 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0635_stage6_step100.svg
[rank3]:2025-11-07 06:35:51,227 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0635_real_step100_rank3.svg
[rank3]:> Batch Time: 511.00 ms, GPU Bubble Ratio: 70.93%, 61.03%, 65.14%, 35.55%
[rank3]:2025-11-07 06:35:51,269 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0635_stage3_step100.svg
[rank3]:2025-11-07 06:35:51,306 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0635_stage7_step100.svg
[rank0]:2025-11-07 06:37:44,350 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 06:37:46,542 - INFO - Avg. fwd time: 7.1792 / Avg. bwd time: 17.8284 / Avg. batch time: 514.6875 (ms) / GPU bubble ratio: 22.26%
[rank0]:2025-11-07 06:37:46,603 - INFO - Avg. fwd time: 4.3252 / Avg. bwd time: 9.3287 / Avg. batch time: 589.3689 (ms) / GPU bubble ratio: 62.93%
[rank2]:2025-11-07 06:37:46,565 - INFO - Avg. fwd time: 4.2257 / Avg. bwd time: 8.5622 / Avg. batch time: 546.6214 (ms) / GPU bubble ratio: 62.57%
[rank1]:2025-11-07 06:37:46,583 - INFO - Avg. fwd time: 5.1820 / Avg. bwd time: 10.0136 / Avg. batch time: 571.0113 (ms) / GPU bubble ratio: 57.42%
[rank3]:2025-11-07 06:37:46,626 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.52/0.78, [MB2] 0.67/1.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.41/0.62
[rank3]:2025-11-07 06:37:46,629 - INFO -  step: 150  loss:  1.9689  grad_norm: 18.5813  memory: 21.90GiB(46.10%)  tps: 7,084  tflops: 53.95  mfu: 17.29%
[rank0]:2025-11-07 06:37:46,660 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.16/0.24, [MB4] 0.08/0.13, [MB5] 0.67/1.00, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-11-07 06:37:46,660 - INFO -  step: 150  loss: -4.0000  grad_norm: 18.5813  memory: 16.98GiB(35.74%)  tps: 7,081  tflops: 53.93  mfu: 17.28%
[rank2]:2025-11-07 06:37:46,632 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.58/0.86, [MB6] 0.41/0.62, [MB7] 0.67/1.00
[rank2]:2025-11-07 06:37:46,632 - INFO -  step: 150  loss: -4.0000  grad_norm: 18.5813  memory:  9.40GiB(19.79%)  tps: 7,082  tflops: 53.94  mfu: 17.29%
[rank1]:2025-11-07 06:37:46,630 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-07 06:37:46,631 - INFO -  step: 150  loss: -4.0000  grad_norm: 18.5813  memory: 13.60GiB(28.63%)  tps: 7,082  tflops: 53.94  mfu: 17.29%
[rank0]:2025-11-07 06:39:34,276 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 06:39:36,148 - INFO - Avg. fwd time: 4.3720 / Avg. bwd time: 8.9441 / Avg. batch time: 576.7391 (ms) / GPU bubble ratio: 63.06%
[rank2]:2025-11-07 06:39:36,183 - INFO - Avg. fwd time: 4.2824 / Avg. bwd time: 8.2540 / Avg. batch time: 536.1464 (ms) / GPU bubble ratio: 62.59%
[rank3]:2025-11-07 06:39:36,156 - INFO - Avg. fwd time: 7.2978 / Avg. bwd time: 16.9553 / Avg. batch time: 504.7193 (ms) / GPU bubble ratio: 23.12%
[rank1]:2025-11-07 06:39:36,229 - INFO - Avg. fwd time: 5.2456 / Avg. bwd time: 9.5872 / Avg. batch time: 559.2851 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-11-07 06:39:36,393 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.78/0.78, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.62/0.62
[rank3]:2025-11-07 06:39:36,397 - INFO -  step: 200  loss:  0.6817  grad_norm:  0.1289  memory: 21.90GiB(46.10%)  tps: 7,463  tflops: 56.84  mfu: 18.22%
[rank0]:2025-11-07 06:39:36,400 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.24, [MB4] 0.13/0.13, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-07 06:39:36,400 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1289  memory: 16.98GiB(35.74%)  tps: 7,465  tflops: 56.85  mfu: 18.22%
[rank0]:2025-11-07 06:39:36,458 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0639_stage0_step200.svg
[rank2]:2025-11-07 06:39:36,400 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.86/0.86, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank2]:2025-11-07 06:39:36,400 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1289  memory:  9.40GiB(19.79%)  tps: 7,463  tflops: 56.84  mfu: 18.22%
[rank2]:2025-11-07 06:39:36,457 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0639_stage2_step200.svg
[rank1]:2025-11-07 06:39:36,402 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 06:39:36,402 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1289  memory: 13.60GiB(28.63%)  tps: 7,463  tflops: 56.84  mfu: 18.22%
[rank1]:2025-11-07 06:39:36,457 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0639_stage1_step200.svg
[rank0]:2025-11-07 06:39:36,501 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0639_stage4_step200.svg
[rank2]:2025-11-07 06:39:36,499 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0639_stage6_step200.svg
[rank1]:2025-11-07 06:39:36,498 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0639_stage5_step200.svg
[rank3]:2025-11-07 06:39:36,656 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0639_real_step200_rank3.svg
[rank3]:> Batch Time: 516.08 ms, GPU Bubble Ratio: 64.73%, 59.04%, 64.38%, 35.60%
[rank3]:2025-11-07 06:39:36,699 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0639_stage3_step200.svg
[rank3]:2025-11-07 06:39:36,740 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0639_stage7_step200.svg
[rank0]:2025-11-07 06:41:20,387 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 06:41:22,204 - INFO - Avg. fwd time: 4.4082 / Avg. bwd time: 8.0262 / Avg. batch time: 563.7082 (ms) / GPU bubble ratio: 64.71%
[rank3]:2025-11-07 06:41:22,227 - INFO - Avg. fwd time: 7.4055 / Avg. bwd time: 16.1280 / Avg. batch time: 495.5595 (ms) / GPU bubble ratio: 24.02%
[rank1]:2025-11-07 06:41:22,271 - INFO - Avg. fwd time: 5.3232 / Avg. bwd time: 9.0317 / Avg. batch time: 548.1587 (ms) / GPU bubble ratio: 58.10%
[rank2]:2025-11-07 06:41:22,255 - INFO - Avg. fwd time: 4.3444 / Avg. bwd time: 7.9152 / Avg. batch time: 526.4306 (ms) / GPU bubble ratio: 62.74%
[rank3]:2025-11-07 06:41:22,457 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.78/0.78, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.62/0.62
[rank3]:2025-11-07 06:41:22,460 - INFO -  step: 250  loss:  0.3102  grad_norm:  0.1110  memory: 21.90GiB(46.10%)  tps: 7,724  tflops: 58.83  mfu: 18.85%
[rank0]:2025-11-07 06:41:22,462 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.24, [MB4] 0.13/0.13, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-07 06:41:22,463 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1110  memory: 16.98GiB(35.74%)  tps: 7,724  tflops: 58.83  mfu: 18.85%
[rank1]:2025-11-07 06:41:22,463 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 06:41:22,463 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1110  memory: 13.60GiB(28.63%)  tps: 7,724  tflops: 58.83  mfu: 18.85%
[rank2]:2025-11-07 06:41:22,462 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.86/0.86, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank2]:2025-11-07 06:41:22,463 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1110  memory:  9.40GiB(19.79%)  tps: 7,724  tflops: 58.83  mfu: 18.85%
[rank0]:2025-11-07 06:43:06,526 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 06:43:08,644 - INFO - Avg. fwd time: 7.4733 / Avg. bwd time: 15.6135 / Avg. batch time: 489.9377 (ms) / GPU bubble ratio: 24.60%
[rank2]:2025-11-07 06:43:08,664 - INFO - Avg. fwd time: 4.3852 / Avg. bwd time: 7.6956 / Avg. batch time: 520.2465 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-11-07 06:43:08,681 - INFO - Avg. fwd time: 5.3729 / Avg. bwd time: 8.6633 / Avg. batch time: 541.0452 (ms) / GPU bubble ratio: 58.49%
[rank3]:2025-11-07 06:43:08,734 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.78/0.78, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.62/0.62
[rank3]:2025-11-07 06:43:08,736 - INFO -  step: 300  loss:  0.2580  grad_norm:  0.1039  memory: 21.90GiB(46.10%)  tps: 7,708  tflops: 58.71  mfu: 18.82%
[rank0]:2025-11-07 06:43:08,692 - INFO - Avg. fwd time: 4.4310 / Avg. bwd time: 7.4069 / Avg. batch time: 555.3284 (ms) / GPU bubble ratio: 65.89%
[rank0]:2025-11-07 06:43:08,710 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.24/0.24, [MB4] 0.13/0.13, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-07 06:43:08,710 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1039  memory: 16.98GiB(35.74%)  tps: 7,710  tflops: 58.72  mfu: 18.82%
[rank2]:2025-11-07 06:43:08,710 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.86/0.86, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank2]:2025-11-07 06:43:08,710 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1039  memory:  9.40GiB(19.79%)  tps: 7,710  tflops: 58.72  mfu: 18.82%
[rank1]:2025-11-07 06:43:08,710 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 06:43:08,710 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1039  memory: 13.60GiB(28.63%)  tps: 7,710  tflops: 58.72  mfu: 18.82%
[rank0]:2025-11-07 06:43:08,801 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0643_stage0_step300.svg
[rank0]:2025-11-07 06:43:08,842 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0643_stage4_step300.svg
[rank2]:2025-11-07 06:43:08,815 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0643_stage2_step300.svg
[rank2]:2025-11-07 06:43:08,856 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0643_stage6_step300.svg
[rank1]:2025-11-07 06:43:08,815 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0643_stage1_step300.svg
[rank1]:2025-11-07 06:43:08,856 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0643_stage5_step300.svg
[rank3]:2025-11-07 06:43:08,969 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0643_real_step300_rank3.svg
[rank3]:> Batch Time: 518.00 ms, GPU Bubble Ratio: 72.21%, 61.25%, 65.20%, 34.43%
[rank3]:2025-11-07 06:43:09,011 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0643_stage3_step300.svg
[rank3]:2025-11-07 06:43:09,051 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0643_stage7_step300.svg
[rank0]:2025-11-07 06:44:51,934 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 06:44:53,781 - INFO - Avg. fwd time: 7.5209 / Avg. bwd time: 15.2523 / Avg. batch time: 485.8545 (ms) / GPU bubble ratio: 25.00%
[rank0]:2025-11-07 06:44:53,756 - INFO - Avg. fwd time: 4.4427 / Avg. bwd time: 7.0450 / Avg. batch time: 549.6756 (ms) / GPU bubble ratio: 66.56%
[rank1]:2025-11-07 06:44:53,826 - INFO - Avg. fwd time: 5.4058 / Avg. bwd time: 8.4369 / Avg. batch time: 536.1698 (ms) / GPU bubble ratio: 58.69%
[rank2]:2025-11-07 06:44:53,809 - INFO - Avg. fwd time: 4.4104 / Avg. bwd time: 7.5588 / Avg. batch time: 515.9447 (ms) / GPU bubble ratio: 62.88%
[rank1]:2025-11-07 06:44:54,017 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0928  memory: 13.60GiB(28.63%)  tps: 7,779  tflops: 59.25  mfu: 18.99%
[rank2]:2025-11-07 06:44:54,016 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0928  memory:  9.40GiB(19.79%)  tps: 7,779  tflops: 59.25  mfu: 18.99%
[rank3]:2025-11-07 06:44:54,013 - INFO -  step: 350  loss:  0.2611  grad_norm:  0.0928  memory: 21.90GiB(46.10%)  tps: 7,781  tflops: 59.27  mfu: 19.00%
[rank0]:2025-11-07 06:44:54,016 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0928  memory: 16.98GiB(35.74%)  tps: 7,779  tflops: 59.25  mfu: 18.99%
[rank0]:2025-11-07 06:46:37,793 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 06:46:39,647 - INFO - Avg. fwd time: 4.4522 / Avg. bwd time: 6.7305 / Avg. batch time: 544.9865 (ms) / GPU bubble ratio: 67.17%
[rank3]:2025-11-07 06:46:39,676 - INFO - Avg. fwd time: 7.5563 / Avg. bwd time: 14.9674 / Avg. batch time: 482.6843 (ms) / GPU bubble ratio: 25.34%
[rank1]:2025-11-07 06:46:39,716 - INFO - Avg. fwd time: 5.4347 / Avg. bwd time: 8.2366 / Avg. batch time: 532.1725 (ms) / GPU bubble ratio: 58.90%
[rank2]:2025-11-07 06:46:39,702 - INFO - Avg. fwd time: 4.4326 / Avg. bwd time: 7.4391 / Avg. batch time: 512.4509 (ms) / GPU bubble ratio: 62.93%
[rank0]:2025-11-07 06:46:39,916 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1080  memory: 16.98GiB(35.74%)  tps: 7,736  tflops: 58.92  mfu: 18.88%
[rank3]:2025-11-07 06:46:39,916 - INFO -  step: 400  loss:  0.2586  grad_norm:  0.1080  memory: 21.90GiB(46.10%)  tps: 7,736  tflops: 58.92  mfu: 18.88%
[rank1]:2025-11-07 06:46:39,916 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1080  memory: 13.60GiB(28.63%)  tps: 7,736  tflops: 58.92  mfu: 18.88%
[rank1]:2025-11-07 06:46:39,970 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0646_stage1_step400.svg
[rank2]:2025-11-07 06:46:39,916 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1080  memory:  9.40GiB(19.79%)  tps: 7,736  tflops: 58.92  mfu: 18.88%
[rank2]:2025-11-07 06:46:39,970 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0646_stage2_step400.svg
[rank0]:2025-11-07 06:46:39,970 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0646_stage0_step400.svg
[rank0]:2025-11-07 06:46:40,014 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0646_stage4_step400.svg
[rank1]:2025-11-07 06:46:40,015 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0646_stage5_step400.svg
[rank2]:2025-11-07 06:46:40,015 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0646_stage6_step400.svg
[rank3]:2025-11-07 06:46:40,152 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0646_real_step400_rank3.svg
[rank3]:> Batch Time: 512.50 ms, GPU Bubble Ratio: 71.39%, 60.75%, 64.86%, 35.21%
[rank3]:2025-11-07 06:46:40,199 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0646_stage3_step400.svg
[rank3]:2025-11-07 06:46:40,242 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0646_stage7_step400.svg
[rank3]:2025-11-07 06:46:50,943 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-07 06:46:51,149 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-07 06:46:51,158 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 06:46:51,157 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 06:48:23,546 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-07 06:48:25,623 - INFO - Avg. fwd time: 4.4498 / Avg. bwd time: 7.3472 / Avg. batch time: 509.7027 (ms) / GPU bubble ratio: 62.97%
[rank0]:2025-11-07 06:48:25,654 - INFO - Avg. fwd time: 4.4627 / Avg. bwd time: 6.4725 / Avg. batch time: 541.3302 (ms) / GPU bubble ratio: 67.68%
[rank3]:2025-11-07 06:48:25,602 - INFO - Avg. fwd time: 7.5854 / Avg. bwd time: 14.7387 / Avg. batch time: 480.0719 (ms) / GPU bubble ratio: 25.60%
[rank3]:2025-11-07 06:48:25,672 - INFO -  step: 450  loss:  0.2545  grad_norm:  0.1036  memory: 21.90GiB(46.10%)  tps: 7,746  tflops: 59.00  mfu: 18.91%
[rank1]:2025-11-07 06:48:25,642 - INFO - Avg. fwd time: 5.4565 / Avg. bwd time: 8.0835 / Avg. batch time: 529.0386 (ms) / GPU bubble ratio: 59.05%
[rank1]:2025-11-07 06:48:25,672 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1036  memory: 13.60GiB(28.63%)  tps: 7,746  tflops: 59.00  mfu: 18.91%
[rank2]:2025-11-07 06:48:25,672 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1036  memory:  9.40GiB(19.79%)  tps: 7,746  tflops: 59.00  mfu: 18.91%
[rank0]:2025-11-07 06:48:25,672 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1036  memory: 16.98GiB(35.74%)  tps: 7,746  tflops: 59.00  mfu: 18.91%
[rank0]:2025-11-07 06:50:09,308 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 06:50:11,166 - INFO - Avg. fwd time: 4.4692 / Avg. bwd time: 6.2946 / Avg. batch time: 538.8697 (ms) / GPU bubble ratio: 68.04%
[rank3]:2025-11-07 06:50:11,194 - INFO - Avg. fwd time: 7.6064 / Avg. bwd time: 14.5865 / Avg. batch time: 478.4247 (ms) / GPU bubble ratio: 25.78%
[rank1]:2025-11-07 06:50:11,236 - INFO - Avg. fwd time: 5.4716 / Avg. bwd time: 7.9776 / Avg. batch time: 526.9413 (ms) / GPU bubble ratio: 59.16%
[rank2]:2025-11-07 06:50:11,226 - INFO - Avg. fwd time: 4.4622 / Avg. bwd time: 7.2841 / Avg. batch time: 507.8719 (ms) / GPU bubble ratio: 62.99%
[rank3]:2025-11-07 06:50:11,431 - INFO -  step: 500  loss:  0.2783  grad_norm:  0.1144  memory: 21.90GiB(46.10%)  tps: 7,746  tflops: 59.00  mfu: 18.91%
[rank1]:2025-11-07 06:50:11,432 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1144  memory: 13.60GiB(28.63%)  tps: 7,746  tflops: 58.99  mfu: 18.91%
[rank2]:2025-11-07 06:50:11,432 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1144  memory:  9.40GiB(19.79%)  tps: 7,746  tflops: 58.99  mfu: 18.91%
[rank0]:2025-11-07 06:50:11,432 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1144  memory: 16.98GiB(35.74%)  tps: 7,746  tflops: 58.99  mfu: 18.91%
[rank0]:2025-11-07 06:50:11,483 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0650_stage0_step500.svg
[rank1]:2025-11-07 06:50:11,482 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0650_stage1_step500.svg
[rank1]:2025-11-07 06:50:11,523 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0650_stage5_step500.svg
[rank2]:2025-11-07 06:50:11,483 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0650_stage2_step500.svg
[rank2]:2025-11-07 06:50:11,523 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0650_stage6_step500.svg
[rank0]:2025-11-07 06:50:11,525 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0650_stage4_step500.svg
[rank3]:2025-11-07 06:50:11,667 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0650_real_step500_rank3.svg
[rank3]:> Batch Time: 507.50 ms, GPU Bubble Ratio: 71.83%, 60.31%, 64.56%, 35.82%
[rank3]:2025-11-07 06:50:11,708 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0650_stage3_step500.svg
[rank3]:2025-11-07 06:50:11,747 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0650_stage7_step500.svg
[rank0]:2025-11-07 06:51:55,327 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 06:51:57,195 - INFO - Avg. fwd time: 4.4754 / Avg. bwd time: 6.1263 / Avg. batch time: 536.5081 (ms) / GPU bubble ratio: 68.38%
[rank3]:2025-11-07 06:51:57,221 - INFO - Avg. fwd time: 7.6272 / Avg. bwd time: 14.4330 / Avg. batch time: 476.7556 (ms) / GPU bubble ratio: 25.97%
[rank1]:2025-11-07 06:51:57,264 - INFO - Avg. fwd time: 5.4860 / Avg. bwd time: 7.8770 / Avg. batch time: 524.9268 (ms) / GPU bubble ratio: 59.27%
[rank2]:2025-11-07 06:51:57,252 - INFO - Avg. fwd time: 4.4738 / Avg. bwd time: 7.2226 / Avg. batch time: 506.1120 (ms) / GPU bubble ratio: 63.02%
[rank0]:2025-11-07 06:51:57,454 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1176  memory: 16.98GiB(35.74%)  tps: 7,727  tflops: 58.85  mfu: 18.86%
[rank1]:2025-11-07 06:51:57,454 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1176  memory: 13.60GiB(28.63%)  tps: 7,727  tflops: 58.85  mfu: 18.86%
[rank2]:2025-11-07 06:51:57,454 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1176  memory:  9.40GiB(19.79%)  tps: 7,727  tflops: 58.85  mfu: 18.86%
[rank3]:2025-11-07 06:51:57,477 - INFO -  step: 550  loss:  0.3254  grad_norm:  0.1176  memory: 21.90GiB(46.10%)  tps: 7,725  tflops: 58.84  mfu: 18.86%
[rank0]:2025-11-07 06:53:41,023 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 06:53:43,152 - INFO - Avg. fwd time: 4.4833 / Avg. bwd time: 7.1721 / Avg. batch time: 504.6493 (ms) / GPU bubble ratio: 63.05%
[rank0]:2025-11-07 06:53:43,186 - INFO - Avg. fwd time: 4.4827 / Avg. bwd time: 5.9719 / Avg. batch time: 534.5534 (ms) / GPU bubble ratio: 68.71%
[rank0]:2025-11-07 06:53:43,204 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0966  memory: 16.98GiB(35.74%)  tps: 7,747  tflops: 59.00  mfu: 18.91%
[rank3]:2025-11-07 06:53:43,130 - INFO - Avg. fwd time: 7.6434 / Avg. bwd time: 14.3144 / Avg. batch time: 475.4481 (ms) / GPU bubble ratio: 26.11%
[rank1]:2025-11-07 06:53:43,172 - INFO - Avg. fwd time: 5.4974 / Avg. bwd time: 7.7934 / Avg. batch time: 523.2560 (ms) / GPU bubble ratio: 59.36%
[rank1]:2025-11-07 06:53:43,204 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0966  memory: 13.60GiB(28.63%)  tps: 7,747  tflops: 59.00  mfu: 18.91%
[rank2]:2025-11-07 06:53:43,204 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0966  memory:  9.40GiB(19.79%)  tps: 7,747  tflops: 59.00  mfu: 18.91%
[rank0]:2025-11-07 06:53:43,282 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0653_stage0_step600.svg
[rank3]:2025-11-07 06:53:43,230 - INFO -  step: 600  loss:  0.2422  grad_norm:  0.0966  memory: 21.90GiB(46.10%)  tps: 7,747  tflops: 59.00  mfu: 18.91%
[rank1]:2025-11-07 06:53:43,280 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0653_stage1_step600.svg
[rank1]:2025-11-07 06:53:43,321 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0653_stage5_step600.svg
[rank2]:2025-11-07 06:53:43,280 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0653_stage2_step600.svg
[rank2]:2025-11-07 06:53:43,321 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0653_stage6_step600.svg
[rank0]:2025-11-07 06:53:43,325 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0653_stage4_step600.svg
[rank3]:2025-11-07 06:53:43,467 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0653_real_step600_rank3.svg
[rank3]:> Batch Time: 515.00 ms, GPU Bubble Ratio: 71.80%, 60.94%, 65.10%, 34.93%
[rank3]:2025-11-07 06:53:43,511 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0653_stage3_step600.svg
[rank3]:2025-11-07 06:53:43,552 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0653_stage7_step600.svg
[rank0]:2025-11-07 06:55:27,076 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 06:55:28,932 - INFO - Avg. fwd time: 4.4890 / Avg. bwd time: 5.8576 / Avg. batch time: 533.1404 (ms) / GPU bubble ratio: 68.95%
[rank2]:2025-11-07 06:55:28,991 - INFO - Avg. fwd time: 4.4905 / Avg. bwd time: 7.1354 / Avg. batch time: 503.5994 (ms) / GPU bubble ratio: 63.06%
[rank3]:2025-11-07 06:55:28,961 - INFO - Avg. fwd time: 7.6550 / Avg. bwd time: 14.2252 / Avg. batch time: 474.4340 (ms) / GPU bubble ratio: 26.21%
[rank1]:2025-11-07 06:55:29,003 - INFO - Avg. fwd time: 5.5060 / Avg. bwd time: 7.7327 / Avg. batch time: 522.0523 (ms) / GPU bubble ratio: 59.43%
[rank1]:2025-11-07 06:55:29,192 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1150  memory: 13.60GiB(28.63%)  tps: 7,729  tflops: 58.87  mfu: 18.87%
[rank2]:2025-11-07 06:55:29,192 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1150  memory:  9.40GiB(19.79%)  tps: 7,729  tflops: 58.87  mfu: 18.87%
[rank3]:2025-11-07 06:55:29,218 - INFO -  step: 650  loss:  0.2557  grad_norm:  0.1150  memory: 21.90GiB(46.10%)  tps: 7,729  tflops: 58.87  mfu: 18.87%
[rank0]:2025-11-07 06:55:29,192 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1150  memory: 16.98GiB(35.74%)  tps: 7,729  tflops: 58.87  mfu: 18.87%
[rank0]:2025-11-07 06:57:12,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 06:57:14,115 - INFO - Avg. fwd time: 4.4930 / Avg. bwd time: 5.7519 / Avg. batch time: 531.4962 (ms) / GPU bubble ratio: 69.16%
[rank3]:2025-11-07 06:57:14,144 - INFO - Avg. fwd time: 7.6665 / Avg. bwd time: 14.1234 / Avg. batch time: 473.2644 (ms) / GPU bubble ratio: 26.33%
[rank1]:2025-11-07 06:57:14,185 - INFO - Avg. fwd time: 5.5140 / Avg. bwd time: 7.6711 / Avg. batch time: 520.6195 (ms) / GPU bubble ratio: 59.48%
[rank2]:2025-11-07 06:57:14,174 - INFO - Avg. fwd time: 4.4970 / Avg. bwd time: 7.0978 / Avg. batch time: 502.3211 (ms) / GPU bubble ratio: 63.07%
[rank0]:2025-11-07 06:57:14,376 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1025  memory: 16.98GiB(35.74%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank3]:2025-11-07 06:57:14,403 - INFO -  step: 700  loss:  0.2339  grad_norm:  0.1025  memory: 21.90GiB(46.10%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank1]:2025-11-07 06:57:14,376 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1025  memory: 13.60GiB(28.63%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank2]:2025-11-07 06:57:14,376 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1025  memory:  9.40GiB(19.79%)  tps: 7,788  tflops: 59.32  mfu: 19.01%
[rank0]:2025-11-07 06:57:14,455 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0657_stage0_step700.svg
[rank1]:2025-11-07 06:57:14,455 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0657_stage1_step700.svg
[rank1]:2025-11-07 06:57:14,498 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0657_stage5_step700.svg
[rank2]:2025-11-07 06:57:14,455 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0657_stage2_step700.svg
[rank2]:2025-11-07 06:57:14,499 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0657_stage6_step700.svg
[rank0]:2025-11-07 06:57:14,499 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0657_stage4_step700.svg
[rank3]:2025-11-07 06:57:14,636 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0657_real_step700_rank3.svg
[rank3]:> Batch Time: 512.50 ms, GPU Bubble Ratio: 72.32%, 60.89%, 64.90%, 35.21%
[rank3]:2025-11-07 06:57:14,682 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0657_stage3_step700.svg
[rank3]:2025-11-07 06:57:14,723 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0657_stage7_step700.svg
[rank0]:2025-11-07 06:58:58,287 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 06:59:00,341 - INFO - Avg. fwd time: 7.6755 / Avg. bwd time: 14.0493 / Avg. batch time: 472.4450 (ms) / GPU bubble ratio: 26.43%
[rank1]:2025-11-07 06:59:00,386 - INFO - Avg. fwd time: 5.5203 / Avg. bwd time: 7.6180 / Avg. batch time: 519.6384 (ms) / GPU bubble ratio: 59.55%
[rank2]:2025-11-07 06:59:00,365 - INFO - Avg. fwd time: 4.5024 / Avg. bwd time: 7.0656 / Avg. batch time: 501.4718 (ms) / GPU bubble ratio: 63.09%
[rank0]:2025-11-07 06:59:00,401 - INFO - Avg. fwd time: 4.4964 / Avg. bwd time: 5.6608 / Avg. batch time: 530.3347 (ms) / GPU bubble ratio: 69.36%
[rank3]:2025-11-07 06:59:00,416 - INFO -  step: 750  loss:  0.2951  grad_norm:  0.1054  memory: 21.90GiB(46.10%)  tps: 7,727  tflops: 58.85  mfu: 18.86%
[rank0]:2025-11-07 06:59:00,419 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1054  memory: 16.98GiB(35.74%)  tps: 7,725  tflops: 58.84  mfu: 18.86%
[rank1]:2025-11-07 06:59:00,419 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1054  memory: 13.60GiB(28.63%)  tps: 7,725  tflops: 58.84  mfu: 18.86%
[rank2]:2025-11-07 06:59:00,419 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1054  memory:  9.40GiB(19.79%)  tps: 7,725  tflops: 58.84  mfu: 18.86%
[rank0]:2025-11-07 07:00:43,696 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 07:00:45,579 - INFO - Avg. fwd time: 7.6828 / Avg. bwd time: 13.9894 / Avg. batch time: 471.7588 (ms) / GPU bubble ratio: 26.50%
[rank0]:2025-11-07 07:00:45,553 - INFO - Avg. fwd time: 4.4981 / Avg. bwd time: 5.5986 / Avg. batch time: 529.3294 (ms) / GPU bubble ratio: 69.48%
[rank2]:2025-11-07 07:00:45,611 - INFO - Avg. fwd time: 4.5063 / Avg. bwd time: 7.0416 / Avg. batch time: 500.7044 (ms) / GPU bubble ratio: 63.10%
[rank1]:2025-11-07 07:00:45,624 - INFO - Avg. fwd time: 5.5256 / Avg. bwd time: 7.5783 / Avg. batch time: 518.7704 (ms) / GPU bubble ratio: 59.58%
[rank1]:2025-11-07 07:00:45,812 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1150  memory: 13.60GiB(28.63%)  tps: 7,773  tflops: 59.20  mfu: 18.97%
[rank2]:2025-11-07 07:00:45,812 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1150  memory:  9.40GiB(19.79%)  tps: 7,773  tflops: 59.20  mfu: 18.97%
[rank3]:2025-11-07 07:00:45,809 - INFO -  step: 800  loss:  0.2438  grad_norm:  0.1150  memory: 21.90GiB(46.10%)  tps: 7,773  tflops: 59.20  mfu: 18.97%
[rank0]:2025-11-07 07:00:45,812 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1150  memory: 16.98GiB(35.74%)  tps: 7,773  tflops: 59.20  mfu: 18.97%
[rank0]:2025-11-07 07:00:45,865 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0700_stage0_step800.svg
[rank1]:2025-11-07 07:00:45,865 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0700_stage1_step800.svg
[rank1]:2025-11-07 07:00:45,910 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0700_stage5_step800.svg
[rank2]:2025-11-07 07:00:45,865 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0700_stage2_step800.svg
[rank2]:2025-11-07 07:00:45,910 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0700_stage6_step800.svg
[rank0]:2025-11-07 07:00:45,910 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0700_stage4_step800.svg
[rank3]:2025-11-07 07:00:46,051 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0700_real_step800_rank3.svg
[rank3]:> Batch Time: 513.50 ms, GPU Bubble Ratio: 71.08%, 60.95%, 65.00%, 34.99%
[rank3]:2025-11-07 07:00:46,098 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0700_stage3_step800.svg
[rank3]:2025-11-07 07:00:46,142 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0700_stage7_step800.svg
[rank3]:2025-11-07 07:01:08,799 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 07:01:09,011 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-07 07:01:09,011 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-07 07:01:09,003 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 07:02:29,738 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 07:02:31,610 - INFO - Avg. fwd time: 4.5002 / Avg. bwd time: 5.5274 / Avg. batch time: 528.4160 (ms) / GPU bubble ratio: 69.64%
[rank2]:2025-11-07 07:02:31,672 - INFO - Avg. fwd time: 4.5108 / Avg. bwd time: 7.0169 / Avg. batch time: 500.0371 (ms) / GPU bubble ratio: 63.11%
[rank3]:2025-11-07 07:02:31,640 - INFO - Avg. fwd time: 7.6914 / Avg. bwd time: 13.9296 / Avg. batch time: 471.1104 (ms) / GPU bubble ratio: 26.57%
[rank1]:2025-11-07 07:02:31,683 - INFO - Avg. fwd time: 5.5313 / Avg. bwd time: 7.5373 / Avg. batch time: 517.9993 (ms) / GPU bubble ratio: 59.63%
[rank2]:2025-11-07 07:02:31,870 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1184  memory:  9.40GiB(19.79%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank3]:2025-11-07 07:02:31,899 - INFO -  step: 850  loss:  0.2490  grad_norm:  0.1184  memory: 21.90GiB(46.10%)  tps: 7,722  tflops: 58.81  mfu: 18.85%
[rank0]:2025-11-07 07:02:31,870 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1184  memory: 16.98GiB(35.74%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank1]:2025-11-07 07:02:31,870 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1184  memory: 13.60GiB(28.63%)  tps: 7,724  tflops: 58.83  mfu: 18.86%
[rank0]:2025-11-07 07:04:15,007 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 07:04:17,109 - INFO - Avg. fwd time: 4.5156 / Avg. bwd time: 6.9947 / Avg. batch time: 499.2977 (ms) / GPU bubble ratio: 63.12%
[rank3]:2025-11-07 07:04:17,084 - INFO - Avg. fwd time: 7.7001 / Avg. bwd time: 13.8701 / Avg. batch time: 470.4450 (ms) / GPU bubble ratio: 26.64%
[rank0]:2025-11-07 07:04:17,147 - INFO - Avg. fwd time: 4.5032 / Avg. bwd time: 5.4653 / Avg. batch time: 527.4658 (ms) / GPU bubble ratio: 69.76%
[rank0]:2025-11-07 07:04:17,165 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0969  memory: 16.98GiB(35.74%)  tps: 7,780  tflops: 59.25  mfu: 18.99%
[rank1]:2025-11-07 07:04:17,131 - INFO - Avg. fwd time: 5.5367 / Avg. bwd time: 7.5014 / Avg. batch time: 517.1713 (ms) / GPU bubble ratio: 59.66%
[rank1]:2025-11-07 07:04:17,166 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0969  memory: 13.60GiB(28.63%)  tps: 7,780  tflops: 59.25  mfu: 18.99%
[rank2]:2025-11-07 07:04:17,167 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0969  memory:  9.40GiB(19.79%)  tps: 7,780  tflops: 59.25  mfu: 18.99%
[rank2]:2025-11-07 07:04:17,220 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0704_stage2_step900.svg
[rank3]:2025-11-07 07:04:17,165 - INFO -  step: 900  loss:  0.2193  grad_norm:  0.0969  memory: 21.90GiB(46.10%)  tps: 7,782  tflops: 59.27  mfu: 19.00%
[rank0]:2025-11-07 07:04:17,215 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0704_stage0_step900.svg
[rank0]:2025-11-07 07:04:17,255 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0704_stage4_step900.svg
[rank1]:2025-11-07 07:04:17,217 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0704_stage1_step900.svg
[rank1]:2025-11-07 07:04:17,259 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0704_stage5_step900.svg
[rank2]:2025-11-07 07:04:17,264 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0704_stage6_step900.svg
[rank3]:2025-11-07 07:04:17,403 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0704_real_step900_rank3.svg
[rank3]:> Batch Time: 511.00 ms, GPU Bubble Ratio: 71.75%, 60.69%, 64.82%, 35.44%
[rank3]:2025-11-07 07:04:17,445 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0704_stage3_step900.svg
[rank3]:2025-11-07 07:04:17,485 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0704_stage7_step900.svg
[rank0]:2025-11-07 07:06:01,141 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 07:06:03,022 - INFO - Avg. fwd time: 4.5040 / Avg. bwd time: 5.4259 / Avg. batch time: 526.8764 (ms) / GPU bubble ratio: 69.85%
[rank3]:2025-11-07 07:06:03,052 - INFO - Avg. fwd time: 7.7067 / Avg. bwd time: 13.8290 / Avg. batch time: 470.0241 (ms) / GPU bubble ratio: 26.69%
[rank1]:2025-11-07 07:06:03,096 - INFO - Avg. fwd time: 5.5403 / Avg. bwd time: 7.4737 / Avg. batch time: 516.6770 (ms) / GPU bubble ratio: 59.70%
[rank2]:2025-11-07 07:06:03,084 - INFO - Avg. fwd time: 4.5185 / Avg. bwd time: 6.9776 / Avg. batch time: 498.8736 (ms) / GPU bubble ratio: 63.13%
[rank2]:2025-11-07 07:06:03,280 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1005  memory:  9.40GiB(19.79%)  tps: 7,720  tflops: 58.80  mfu: 18.85%
[rank0]:2025-11-07 07:06:03,281 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1005  memory: 16.98GiB(35.74%)  tps: 7,720  tflops: 58.80  mfu: 18.85%
[rank1]:2025-11-07 07:06:03,281 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1005  memory: 13.60GiB(28.63%)  tps: 7,720  tflops: 58.80  mfu: 18.85%
[rank3]:2025-11-07 07:06:03,310 - INFO -  step: 950  loss:  0.2703  grad_norm:  0.1005  memory: 21.90GiB(46.10%)  tps: 7,718  tflops: 58.78  mfu: 18.84%
[rank0]:2025-11-07 07:07:47,218 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-07 07:07:49,129 - INFO - Avg. fwd time: 4.5047 / Avg. bwd time: 5.3836 / Avg. batch time: 526.2913 (ms) / GPU bubble ratio: 69.94%
[rank1]:2025-11-07 07:07:49,203 - INFO - Avg. fwd time: 5.5443 / Avg. bwd time: 7.4446 / Avg. batch time: 516.1934 (ms) / GPU bubble ratio: 59.74%
[rank2]:2025-11-07 07:07:49,192 - INFO - Avg. fwd time: 4.5214 / Avg. bwd time: 6.9602 / Avg. batch time: 498.4634 (ms) / GPU bubble ratio: 63.15%
[rank3]:2025-11-07 07:07:49,161 - INFO - Avg. fwd time: 7.7127 / Avg. bwd time: 13.7922 / Avg. batch time: 469.6730 (ms) / GPU bubble ratio: 26.74%
[rank1]:2025-11-07 07:07:49,392 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0993  memory: 13.60GiB(28.63%)  tps: 7,720  tflops: 58.80  mfu: 18.85%
[rank2]:2025-11-07 07:07:49,392 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0993  memory:  9.40GiB(19.79%)  tps: 7,720  tflops: 58.80  mfu: 18.85%
[rank3]:2025-11-07 07:07:49,420 - INFO -  step: 1000  loss:  0.2644  grad_norm:  0.0993  memory: 21.90GiB(46.10%)  tps: 7,720  tflops: 58.80  mfu: 18.85%
[rank0]:2025-11-07 07:07:49,392 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0993  memory: 16.98GiB(35.74%)  tps: 7,720  tflops: 58.80  mfu: 18.85%
[rank0]:2025-11-07 07:07:49,470 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0707_stage0_step1000.svg
[rank1]:2025-11-07 07:07:49,469 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0707_stage1_step1000.svg
[rank2]:2025-11-07 07:07:49,469 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0707_stage2_step1000.svg
[rank2]:2025-11-07 07:07:49,510 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0707_stage6_step1000.svg
[rank0]:2025-11-07 07:07:49,511 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0707_stage4_step1000.svg
[rank1]:2025-11-07 07:07:49,510 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0707_stage5_step1000.svg
[rank3]:2025-11-07 07:07:49,655 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0707_real_step1000_rank3.svg
[rank3]:> Batch Time: 516.50 ms, GPU Bubble Ratio: 71.43%, 61.14%, 65.23%, 35.29%
[rank3]:2025-11-07 07:07:49,698 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0707_stage3_step1000.svg
[rank3]:2025-11-07 07:07:49,739 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0707_stage7_step1000.svg
[rank0]:2025-11-07 07:09:32,700 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-07 07:09:34,776 - INFO - Avg. fwd time: 7.7194 / Avg. bwd time: 13.7461 / Avg. batch time: 469.1345 (ms) / GPU bubble ratio: 26.79%
[rank1]:2025-11-07 07:09:34,827 - INFO - Avg. fwd time: 5.5480 / Avg. bwd time: 7.4184 / Avg. batch time: 515.5792 (ms) / GPU bubble ratio: 59.76%
[rank2]:2025-11-07 07:09:34,803 - INFO - Avg. fwd time: 4.5244 / Avg. bwd time: 6.9439 / Avg. batch time: 497.9136 (ms) / GPU bubble ratio: 63.15%
[rank3]:2025-11-07 07:09:34,861 - INFO -  step: 1050  loss:  0.3026  grad_norm:  0.1221  memory: 21.90GiB(46.10%)  tps: 7,769  tflops: 59.17  mfu: 18.97%
[rank0]:2025-11-07 07:09:34,845 - INFO - Avg. fwd time: 4.5061 / Avg. bwd time: 5.3419 / Avg. batch time: 525.5887 (ms) / GPU bubble ratio: 70.02%
[rank0]:2025-11-07 07:09:34,863 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1221  memory: 16.98GiB(35.74%)  tps: 7,767  tflops: 59.16  mfu: 18.96%
[rank1]:2025-11-07 07:09:34,863 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1221  memory: 13.60GiB(28.63%)  tps: 7,767  tflops: 59.16  mfu: 18.96%
[rank2]:2025-11-07 07:09:34,863 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1221  memory:  9.40GiB(19.79%)  tps: 7,767  tflops: 59.16  mfu: 18.96%
[rank0]:2025-11-07 07:11:18,284 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 07:11:20,217 - INFO - Avg. fwd time: 7.7239 / Avg. bwd time: 13.7128 / Avg. batch time: 468.7660 (ms) / GPU bubble ratio: 26.83%
[rank0]:2025-11-07 07:11:20,186 - INFO - Avg. fwd time: 4.5073 / Avg. bwd time: 5.3098 / Avg. batch time: 525.0476 (ms) / GPU bubble ratio: 70.08%
[rank2]:2025-11-07 07:11:20,247 - INFO - Avg. fwd time: 4.5272 / Avg. bwd time: 6.9310 / Avg. batch time: 497.4944 (ms) / GPU bubble ratio: 63.15%
[rank1]:2025-11-07 07:11:20,258 - INFO - Avg. fwd time: 5.5510 / Avg. bwd time: 7.3979 / Avg. batch time: 515.1081 (ms) / GPU bubble ratio: 59.78%
[rank0]:2025-11-07 07:11:20,445 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1094  memory: 16.98GiB(35.74%)  tps: 7,759  tflops: 59.09  mfu: 18.94%
[rank2]:2025-11-07 07:11:20,445 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1094  memory:  9.40GiB(19.79%)  tps: 7,759  tflops: 59.09  mfu: 18.94%
[rank1]:2025-11-07 07:11:20,445 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1094  memory: 13.60GiB(28.63%)  tps: 7,759  tflops: 59.09  mfu: 18.94%
[rank3]:2025-11-07 07:11:20,471 - INFO -  step: 1100  loss:  0.2632  grad_norm:  0.1094  memory: 21.90GiB(46.10%)  tps: 7,757  tflops: 59.08  mfu: 18.94%
[rank0]:2025-11-07 07:11:20,522 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0711_stage0_step1100.svg
[rank0]:2025-11-07 07:11:20,567 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0711_stage4_step1100.svg
[rank2]:2025-11-07 07:11:20,521 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0711_stage2_step1100.svg
[rank2]:2025-11-07 07:11:20,562 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0711_stage6_step1100.svg
[rank1]:2025-11-07 07:11:20,521 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0711_stage1_step1100.svg
[rank1]:2025-11-07 07:11:20,562 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0711_stage5_step1100.svg
[rank3]:2025-11-07 07:11:20,705 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0711_real_step1100_rank3.svg
[rank3]:> Batch Time: 509.75 ms, GPU Bubble Ratio: 71.60%, 60.60%, 64.72%, 35.61%
[rank3]:2025-11-07 07:11:20,748 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0711_stage3_step1100.svg
[rank3]:2025-11-07 07:11:20,789 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0711_stage7_step1100.svg
[rank0]:2025-11-07 07:13:04,214 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-07 07:13:06,060 - INFO - Avg. fwd time: 4.5083 / Avg. bwd time: 5.2761 / Avg. batch time: 524.5568 (ms) / GPU bubble ratio: 70.16%
[rank3]:2025-11-07 07:13:06,092 - INFO - Avg. fwd time: 7.7282 / Avg. bwd time: 13.6806 / Avg. batch time: 468.4132 (ms) / GPU bubble ratio: 26.87%
[rank1]:2025-11-07 07:13:06,131 - INFO - Avg. fwd time: 5.5540 / Avg. bwd time: 7.3760 / Avg. batch time: 514.6927 (ms) / GPU bubble ratio: 59.81%
[rank2]:2025-11-07 07:13:06,123 - INFO - Avg. fwd time: 4.5296 / Avg. bwd time: 6.9179 / Avg. batch time: 497.1343 (ms) / GPU bubble ratio: 63.16%
[rank0]:2025-11-07 07:13:06,315 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0970  memory: 16.98GiB(35.74%)  tps: 7,738  tflops: 58.93  mfu: 18.89%
[rank3]:2025-11-07 07:13:06,315 - INFO -  step: 1150  loss:  0.2609  grad_norm:  0.0970  memory: 21.90GiB(46.10%)  tps: 7,740  tflops: 58.95  mfu: 18.89%
[rank1]:2025-11-07 07:13:06,315 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0970  memory: 13.60GiB(28.63%)  tps: 7,738  tflops: 58.93  mfu: 18.89%
[rank2]:2025-11-07 07:13:06,315 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0970  memory:  9.40GiB(19.79%)  tps: 7,738  tflops: 58.93  mfu: 18.89%
[rank0]:2025-11-07 07:14:49,784 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 07:14:51,909 - INFO - Avg. fwd time: 7.7314 / Avg. bwd time: 13.6511 / Avg. batch time: 468.0821 (ms) / GPU bubble ratio: 26.91%
[rank2]:2025-11-07 07:14:51,938 - INFO - Avg. fwd time: 4.5319 / Avg. bwd time: 6.9054 / Avg. batch time: 496.7542 (ms) / GPU bubble ratio: 63.16%
[rank1]:2025-11-07 07:14:51,964 - INFO - Avg. fwd time: 5.5565 / Avg. bwd time: 7.3556 / Avg. batch time: 514.2627 (ms) / GPU bubble ratio: 59.83%
[rank1]:2025-11-07 07:14:52,002 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1083  memory: 13.60GiB(28.63%)  tps: 7,751  tflops: 59.04  mfu: 18.92%
[rank1]:2025-11-07 07:14:52,002 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1083  tps: 7,887  tflops: 60.07  mfu: 18.03%
[rank1]:2025-11-07 07:14:52,002 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-07 07:14:52,003 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-07 07:14:51,983 - INFO - Avg. fwd time: 4.5099 / Avg. bwd time: 5.2393 / Avg. batch time: 524.0602 (ms) / GPU bubble ratio: 70.23%
[rank0]:2025-11-07 07:14:52,002 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1083  memory: 16.98GiB(35.74%)  tps: 7,751  tflops: 59.04  mfu: 18.92%
[rank0]:2025-11-07 07:14:52,002 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1083  tps: 7,887  tflops: 60.07  mfu: 18.03%
[rank0]:2025-11-07 07:14:52,002 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-07 07:14:52,002 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-07 07:14:52,027 - INFO -  step: 1200  loss:  0.2650  grad_norm:  0.1083  memory: 21.90GiB(46.10%)  tps: 7,749  tflops: 59.02  mfu: 18.92%
[rank3]:2025-11-07 07:14:52,028 - INFO -  final step: 1200  loss:  0.2650  grad_norm:  0.1083  tps: 7,894  tflops: 60.12  mfu: 18.11%
[rank3]:2025-11-07 07:14:52,028 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-07 07:14:52,029 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-07 07:14:52,002 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1083  memory:  9.40GiB(19.79%)  tps: 7,751  tflops: 59.04  mfu: 18.92%
[rank2]:2025-11-07 07:14:52,002 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1083  tps: 7,888  tflops: 60.08  mfu: 18.04%
[rank2]:2025-11-07 07:14:52,002 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-07 07:14:52,003 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-07 07:14:53,953 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-07 07:14:54,030 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0714_stage0_final1200.svg
[rank2]:2025-11-07 07:14:54,030 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0714_stage2_final1200.svg
[rank1]:2025-11-07 07:14:54,029 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0714_stage1_final1200.svg
[rank0]:2025-11-07 07:14:54,141 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank0_stage0.svg
[rank0]:	> Counts Sum: 455920, Total Sum: 687040 (66.36%), Ratio(%) per element: [66.03, 66.48, 66.26, 66.26, 66.26, 65.7, 66.59, 65.48, 66.7, 67.03, 66.03, 67.14, 66.26, 66.59, 65.92, 65.15, 66.15, 67.47, 67.25]
[rank2]:2025-11-07 07:14:54,142 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank2_stage2.svg
[rank2]:	> Counts Sum: 369120, Total Sum: 650880 (56.71%), Ratio(%) per element: [57.3, 56.96, 54.97, 56.85, 56.96, 56.96, 56.74, 57.07, 56.74, 55.42, 56.85, 55.64, 57.19, 56.63, 56.52, 56.96, 57.07, 57.85]
[rank2]:2025-11-07 07:14:54,188 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0714_stage6_final1200.svg
[rank1]:2025-11-07 07:14:54,167 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank1_stage1.svg
[rank1]:	> Counts Sum: 495360, Total Sum: 976320 (50.74%), Ratio(%) per element: [50.22, 50.66, 51.1, 50.55, 50.88, 50.55, 50.44, 51.43, 50.88, 50.11, 50.44, 50.55, 50.33, 50.66, 50.88, 50.77, 51.32, 51.21, 50.77, 50.55, 50.99, 50.55, 50.66, 50.88, 50.44, 51.1, 50.88]
[rank0]:2025-11-07 07:14:54,184 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0714_stage4_final1200.svg
[rank3]:2025-11-07 07:14:54,217 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0714_real_final1200_rank3.svg
[rank3]:> Batch Time: 514.50 ms, GPU Bubble Ratio: 71.88%, 60.98%, 65.06%, 35.08%
[rank2]:2025-11-07 07:14:54,295 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank2_stage6.svg
[rank2]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.17, 86.28, 86.17, 86.39, 86.28, 86.06, 86.17, 86.83, 86.94, 86.28, 86.17, 86.17, 86.17, 86.39, 86.28, 86.39, 86.28, 86.94]
[rank2]:2025-11-07 07:14:54,295 - INFO - Destroying the purge thread.
[rank1]:2025-11-07 07:14:54,214 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0714_stage5_final1200.svg
[rank0]:2025-11-07 07:14:54,283 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank0_stage4.svg
[rank0]:	> Counts Sum: 622120, Total Sum: 650880 (95.58%), Ratio(%) per element: [94.91, 94.46, 95.02, 95.46, 94.91, 94.57, 94.46, 98.23, 97.34, 95.35, 94.8, 94.8, 95.02, 95.68, 94.13, 95.02, 98.11, 98.11]
[rank0]:2025-11-07 07:14:54,283 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-07 07:14:54,366 - INFO - Process group destroyed
[rank1]:2025-11-07 07:14:54,319 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank1_stage5.svg
[rank1]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.39, 86.39, 86.17, 86.28, 86.28, 86.39, 86.28, 86.94, 86.39, 86.39, 86.39, 86.28, 86.28, 86.06, 86.5, 86.28, 86.28, 86.39]
[rank1]:2025-11-07 07:14:54,319 - INFO - Destroying the purge thread.
[rank3]:2025-11-07 07:14:54,457 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251107_0714_thry_final1200_rank3.svg
[rank3]:> Batch Time: 319.84 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-07 07:14:54,502 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0714_stage3_final1200.svg
[rank3]:2025-11-07 07:14:54,607 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank3_stage3.svg
[rank3]:	> Counts Sum: 145640, Total Sum: 650880 (22.38%), Ratio(%) per element: [20.13, 21.23, 21.46, 20.35, 21.9, 21.9, 20.79, 26.99, 27.1, 21.01, 20.24, 21.57, 19.8, 22.56, 20.68, 21.12, 29.75, 24.11]
[rank3]:2025-11-07 07:14:54,649 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0714_stage7_final1200.svg
[rank3]:2025-11-07 07:14:54,727 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251107_0714_rank3_stage7.svg
[rank3]:	> Counts Sum: 90640, Total Sum: 397760 (22.79%), Ratio(%) per element: [19.91, 20.35, 20.46, 20.9, 20.79, 20.9, 20.68, 26.88, 28.76, 30.97, 20.02]
[rank3]:2025-11-07 07:14:54,727 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-11-07 07:14:54,831 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 24-24, summary, console lines 310-320
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.07541
[rank3]:wandb:               final/avg_loss 0.26501
[rank3]:wandb:             final/avg_mfu(%) 18.10939
[rank3]:wandb:             final/avg_tflops 60.12493
[rank3]:wandb:    final/avg_throughput(tps) 7894.33472
[rank3]:wandb:              final/grad_norm 0.10827
[rank3]:wandb:               final/max_loss 0.26501
[rank3]:wandb:                    grad_norm 0.10827
[rank3]:wandb: loss_metrics/global_avg_loss 0.26501
[rank3]:wandb: loss_metrics/global_max_loss 0.26501
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1107_Interleaved1F1B_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ytte9ece
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1107_Interleaved1F1B_timelyapf_dm1/20251107-0631/wandb/run-20251107_063136-ytte9ece/logs
[rank3]:2025-11-07 07:14:55,847 - INFO - Process group destroyed
[rank0]:2025-11-07 07:14:56,283 - INFO - Training completed
[rank0]:2025-11-07 07:14:56,284 - INFO - Destroying the purge thread.
[rank0]:2025-11-07 07:14:56,374 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'norm', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1107_Interleaved1F1B_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1107_Interleaved1F1B_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1107_Interleaved1F1B_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1107_Interleaved1F1B_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1107_Interleaved1F1B_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1107_Interleaved1F1B_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1107_Interleaved1F1B_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1107_Interleaved1F1B_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
